{"hands_on_practices": [{"introduction": "The evolution of the amniotic egg hinged on solving a critical physical trade-off: allowing sufficient gas exchange for the embryo while preventing lethal water loss. This exercise puts you in the role of a biophysicist to model the eggshell as a porous barrier. By applying Fick’s first law of diffusion, you will derive from first principles an expression for the total gas conductance of the shell, linking microscopic features like pore density and shape to this vital macroscopic property [@problem_id:2572439]. This practice builds a foundational understanding of how physical laws govern biological function.", "problem": "In the evolutionary transition to the amniotic egg, the eggshell must simultaneously limit water loss and permit sufficient gas exchange for the embryo. Consider an idealized amniote eggshell modeled as a planar slab of thickness $L$ perforated by straight, non-interacting pores whose mean geometric radius is $r$, with a uniform areal pore density $n$ (pores per unit surface area). Let the mean diffusive path length through the pore be longer than $L$ due to meandering, quantified by a tortuosity factor $\\tau$ defined as the ratio of the mean path length to the shell thickness, so that the effective path length is $\\tau L$ with $\\tau \\geq 1$. Assume the gas of interest has a binary molecular diffusivity in air equal to $D$, constant in space and time.\n\nDefine the whole-shell effective molar conductance $G$ by the linear relation $\\dot{N} = G\\,\\Delta C$, where $\\dot{N}$ is the total molar flux across the entire shell (moles per unit time) and $\\Delta C$ is the difference in molar concentration of the diffusing gas between the inside and outside of the egg. Take the total external shell surface area to be $A_s$, and assume isothermal, steady-state diffusion with no chemical reaction or convection.\n\nUsing only well-tested physical principles appropriate to diffusion in porous media and defensible geometric idealizations of the pores, derive a closed-form expression for $G$ in terms of $n$, $\\tau$, $D$, $r$, $L$, and $A_s$. Clearly state all modeling assumptions you make, including how tortuosity enters the derivation. Express $G$ in the International System of Units (SI), noting that under the definition given, $G$ has units of $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$. Provide your final answer as a single symbolic expression. Do not include any units inside the final boxed answer.", "solution": "The problem as stated is scientifically grounded, self-contained, and well-posed. It is based on the established principles of diffusion in porous media and provides sufficient, consistent information for a formal derivation. We shall proceed with the solution.\n\nThe problem requires the derivation of an expression for the whole-shell effective molar conductance, $G$, for gas diffusion through an amniotic eggshell. The derivation must be based on fundamental physical principles. The governing principle for steady-state molecular diffusion is Fick's first law.\n\nFick's first law states that the molar flux density, $J$ (moles per unit area per unit time), is proportional to the negative of the concentration gradient. In one dimension, this is expressed as:\n$$\nJ = -D \\frac{dC}{dx}\n$$\nwhere $D$ is the molecular diffusivity of the gas and a constant, and $\\frac{dC}{dx}$ is the gradient of the molar concentration $C$.\n\nWe first consider the diffusion through a single, idealized pore. The problem models the pores as cylindrical channels. The system is at steady-state, which implies that the concentration profile along the diffusion path does not change with time. For a one-dimensional diffusion path of length $L_{eff}$ with fixed concentrations at the boundaries, the concentration gradient is constant. The magnitude of this gradient can be approximated as:\n$$\n\\left| \\frac{dC}{dx} \\right| = \\frac{\\Delta C}{L_{eff}}\n$$\nwhere $\\Delta C$ is the magnitude of the concentration difference between the inside and outside of the shell.\n\nThe problem specifies that the mean diffusive path length is not the shell thickness $L$, but an effective path length $L_{eff}$ that accounts for the meandering nature of the pore. This is quantified by the tortuosity factor $\\tau$, defined as the ratio of the mean path length to the shell thickness. Therefore, we have:\n$$\nL_{eff} = \\tau L\n$$\nSubstituting this into the expression for the gradient gives:\n$$\n\\left| \\frac{dC}{dx} \\right| = \\frac{\\Delta C}{\\tau L}\n$$\nThe magnitude of the molar flux density through a pore is then:\n$$\nJ_{pore} = D \\left| \\frac{dC}{dx} \\right| = D \\frac{\\Delta C}{\\tau L}\n$$\nThe total molar flux, or flow rate, through a single pore, $\\dot{N}_{pore}$, is the product of the flux density $J_{pore}$ and the cross-sectional area of the pore, $A_{pore}$. The pores are modeled as having a mean geometric radius $r$, so the cross-sectional area of one pore is:\n$$\nA_{pore} = \\pi r^2\n$$\nThus, the molar flux through one pore is:\n$$\n\\dot{N}_{pore} = J_{pore} \\cdot A_{pore} = \\left(D \\frac{\\Delta C}{\\tau L}\\right) (\\pi r^2)\n$$\nNext, we must determine the total molar flux, $\\dot{N}$, across the entire shell surface. The problem states a uniform areal pore density of $n$ (pores per unit surface area) and a total external shell surface area of $A_s$. The total number of pores, $N_{total}$, is therefore the product of the pore density and the total surface area:\n$$\nN_{total} = n A_s\n$$\nThe problem states that the pores are non-interacting, which allows us to calculate the total flux by simply multiplying the flux per pore by the total number of pores. This is a crucial assumption that neglects the potential overlap of diffusion fields near the pore openings. Under this assumption, the total molar flux is:\n$$\n\\dot{N} = N_{total} \\cdot \\dot{N}_{pore} = (n A_s) \\left(D \\frac{\\Delta C}{\\tau L} \\pi r^2\\right)\n$$\nRearranging the terms for clarity, we have:\n$$\n\\dot{N} = \\left(\\frac{\\pi n D r^2 A_s}{\\tau L}\\right) \\Delta C\n$$\nThe problem defines the whole-shell effective molar conductance, $G$, through the linear relation:\n$$\n\\dot{N} = G \\Delta C\n$$\nBy direct comparison of our derived expression for $\\dot{N}$ with the given definition, we can identify the expression for $G$:\n$$\nG = \\frac{\\pi n D r^2 A_s}{\\tau L}\n$$\nThis expression for $G$ is in terms of the specified parameters: $n$, $\\tau$, $D$, $r$, $L$, and $A_s$.\n\nFinally, as a check of consistency, we verify the physical units of our derived expression for $G$. The SI units of the parameters are:\n- $D$ (diffusivity): $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$\n- $r$ (radius): $\\mathrm{m}$\n- $n$ (areal density): $\\mathrm{m}^{-2}$\n- $A_s$ (area): $\\mathrm{m}^2$\n- $L$ (thickness): $\\mathrm{m}$\n- $\\tau$ (tortuosity): dimensionless\n\nThe units of $G$ are therefore:\n$$\n[G] = \\frac{[\\pi] [n] [D] [r^2] [A_s]}{[\\tau] [L]} = \\frac{(1) (\\mathrm{m}^{-2}) (\\mathrm{m}^2\\,\\mathrm{s}^{-1}) (\\mathrm{m}^2) (\\mathrm{m}^2)}{(1) (\\mathrm{m})} = \\frac{\\mathrm{m}^4\\,\\mathrm{s}^{-1}}{\\mathrm{m}} = \\mathrm{m}^3\\,\\mathrm{s}^{-1}\n$$\nThis result is consistent with the units for $G$ specified in the problem statement, which are derived from its definition $G = \\dot{N} / \\Delta C$, where $\\dot{N}$ is in $\\mathrm{mol}\\,\\mathrm{s}^{-1}$ and $\\Delta C$ is in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$. This confirms the physical and dimensional correctness of our derivation. The derived expression is the required closed-form solution.", "answer": "$$\n\\boxed{\\frac{\\pi n D r^2 A_s}{\\tau L}}\n$$", "id": "2572439"}, {"introduction": "A biophysical model is a powerful hypothesis, but its parameters must be testable to be scientifically useful. Building upon the diffusion model of the eggshell, this next practice challenges you to investigate a deeper question: can the physical properties of the pores, such as their number ($N$) and length ($\\ell$), be uniquely determined from feasible experimental measurements? You will use the formal framework of parameter identifiability and the Fisher Information Matrix to explore how different measurements (water loss and oxygen consumption) can either disentangle or confound model parameters [@problem_id:2572472]. This exercise provides critical insight into the relationship between theoretical models and experimental design.", "problem": "Consider an amniotic egg whose calcareous shell contains $N$ approximately cylindrical pores of radius $r$ and length $\\,\\ell\\,$ (equal to shell thickness). Assume steady-state, diffusion-limited gas transport through air-filled pores with no significant convective flow. Let $D_{w}$ and $D_{O_{2}}$ denote the binary diffusivities of water vapor and oxygen in air at the egg’s temperature, respectively. Let $\\Delta C_{w}$ and $\\Delta C_{O_{2}}$ denote the mean concentration differences (inside minus outside, in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$) for water vapor and oxygen across the shell, respectively, over a time interval during which measurements are taken. Assume $\\Delta C_{w}$ is known from ambient relative humidity and internal saturation, and $\\Delta C_{O_{2}}$ is known from direct micro-sensor measurements of internal oxygen concentration. The molar mass of water is $M_{w}$.\n\nYou measure two quantities over the same interval:\n1. The mass-loss rate of the egg, $\\dot{m}_{w}$, attributable entirely to water vapor diffusion through the shell.\n2. The oxygen consumption rate of the embryo, $\\dot{n}_{O_{2}}$ (in $\\mathrm{mol}\\,\\mathrm{s}^{-1}$), which equals the net oxygen flux into the egg through the shell at steady state.\n\nAdopt the following modeling base grounded in Fick’s law of diffusion: for a single pore of cross-sectional area $A=\\pi r^{2}$ and length $\\,\\ell\\,$, the steady flux for species $k$ with diffusivity $D_{k}$ under a mean concentration difference $\\Delta C_{k}$ is proportional to $D_{k} A \\Delta C_{k}/\\ell$. For $N$ identical pores in parallel, total flux scales linearly with $N$. Thus, the model predictions for the expected molar fluxes (in $\\mathrm{mol}\\,\\mathrm{s}^{-1}$) are\n$$\n\\mu_{w}(N,\\ell)=\\frac{\\dot{m}_{w}}{M_{w}} \\approx \\frac{N\\,D_{w}\\,\\pi r^{2}}{\\ell}\\,\\Delta C_{w}, \n\\qquad \n\\mu_{O_{2}}(N,\\ell)=\\dot{n}_{O_{2}} \\approx \\frac{N\\,D_{O_{2}}\\,\\pi r^{2}}{\\ell}\\,\\Delta C_{O_{2}}.\n$$\nAssume that the measurements $\\dot{m}_{w}$ and $\\dot{n}_{O_{2}}$ are corrupted by independent, zero-mean Gaussian noise with known variances $\\sigma_{w}^{2}$ and $\\sigma_{O_{2}}^{2}$, respectively.\n\nTasks:\n1. Write the observation model in the form $\\mathbf{y}=\\boldsymbol{\\mu}(\\boldsymbol{\\theta})+\\boldsymbol{\\varepsilon}$, where $\\boldsymbol{\\theta}=(N,\\ell)^{\\top}$, $\\mathbf{y}=\\left(\\dot{m}_{w}/M_{w},\\,\\dot{n}_{O_{2}}\\right)^{\\top}$, and $\\boldsymbol{\\varepsilon}$ is the noise vector. Identify all factors considered known.\n2. Using the Gaussian noise assumption, derive symbolically the Fisher Information Matrix (FIM) for $\\boldsymbol{\\theta}$ and compute its determinant in terms of $N$, $\\ell$, $r$, $D_{w}$, $D_{O_{2}}$, $\\Delta C_{w}$, $\\Delta C_{O_{2}}$, $\\sigma_{w}^{2}$, and $\\sigma_{O_{2}}^{2}$. Based on the determinant, state whether $N$ and $\\ell$ are locally identifiable from these two measurements.\n3. If $N$ and $\\ell$ are not both identifiable, determine the structurally identifiable combination $\\psi(\\boldsymbol{\\theta})$ that is estimable from these data alone and express it in closed form using the water measurement and known constants only. Provide your final answer as a single symbolic expression for $\\psi(\\boldsymbol{\\theta})$. No numerical evaluation is required, and you do not need to report units in the final expression.", "solution": "The problem statement must first be subjected to rigorous validation to ensure it is scientifically sound, well-posed, and objective.\n\nStep 1: Extracted Givens.\n- Parameters to be estimated: $\\boldsymbol{\\theta}=(N,\\ell)^{\\top}$, where $N$ is the number of pores and $\\ell$ is the pore length.\n- Known constants and variables: pore radius $r$, shell thickness $\\ell$ (also a parameter), diffusivities $D_{w}$ and $D_{O_{2}}$, concentration differences $\\Delta C_{w}$ and $\\Delta C_{O_{2}}$, and molar mass of water $M_{w}$.\n- Measurements: mass-loss rate $\\dot{m}_{w}$ and oxygen consumption rate $\\dot{n}_{O_{2}}$.\n- Measurement noise: independent, zero-mean Gaussian noise with known variances $\\sigma_{w}^{2}$ for $\\dot{m}_{w}$ and $\\sigma_{O_{2}}^{2}$ for $\\dot{n}_{O_{2}}$.\n- Model equations for mean molar fluxes:\n$$\n\\mu_{w}(N,\\ell) = \\frac{\\dot{m}_{w}}{M_{w}} \\approx \\frac{N\\,D_{w}\\,\\pi r^{2}}{\\ell}\\,\\Delta C_{w}\n$$\n$$\n\\mu_{O_{2}}(N,\\ell) = \\dot{n}_{O_{2}} \\approx \\frac{N\\,D_{O_{2}}\\,\\pi r^{2}}{\\ell}\\,\\Delta C_{O_{2}}\n$$\n- Observation vector definition: $\\mathbf{y}=\\left(\\dot{m}_{w}/M_{w},\\,\\dot{n}_{O_{2}}\\right)^{\\top}$.\n\nStep 2: Validation Using Extracted Givens.\n- **Scientifically Grounded**: The model is based on Fick's first law of diffusion, a fundamental principle of transport phenomena. The application to gas exchange in an amniotic egg is a standard and well-established problem in quantitative biology and biophysics. The problem is scientifically valid.\n- **Well-Posed**: The problem presents a clear set of tasks for parameter identifiability analysis, a standard procedure in systems modeling. The question is structured logically.\n- **Objective**: The problem is stated in precise, quantitative terms. There is no subjective or ambiguous language.\n\nThe problem does not exhibit any of the enumerated flaws. It is not scientifically unsound, non-formalizable, incomplete, unrealistic, ill-posed, or outside scientific verifiability. The model is a simplification, as all models are, but it is a valid simplification for the purpose of this analysis.\n\nStep 3: Verdict and Action.\nThe problem is valid. I will proceed with the solution.\n\nThe solution is organized according to the three tasks presented.\n\nTask 1: Observation Model Formulation\nThe problem requires writing the observation model in the form $\\mathbf{y}=\\boldsymbol{\\mu}(\\boldsymbol{\\theta})+\\boldsymbol{\\varepsilon}$.\nThe vector of unknown parameters is $\\boldsymbol{\\theta} = \\begin{pmatrix} N \\\\ \\ell \\end{pmatrix}$.\nThe observation vector is defined as $\\mathbf{y} = \\begin{pmatrix} y_{1} \\\\ y_{2} \\end{pmatrix} = \\begin{pmatrix} \\dot{m}_{w}/M_{w} \\\\ \\dot{n}_{O_{2}} \\end{pmatrix}$.\nThe vector of mean model predictions $\\boldsymbol{\\mu}(\\boldsymbol{\\theta})$ has components:\n$$\n\\mu_{1}(\\boldsymbol{\\theta}) = \\mu_{w}(N, \\ell) = \\frac{N D_{w} \\pi r^{2}}{\\ell} \\Delta C_{w}\n$$\n$$\n\\mu_{2}(\\boldsymbol{\\theta}) = \\mu_{O_{2}}(N, \\ell) = \\frac{N D_{O_{2}} \\pi r^{2}}{\\ell} \\Delta C_{O_{2}}\n$$\nBoth components share a common structural dependence on the parameters $N$ and $\\ell$ through the ratio $N/\\ell$. Let us define constant terms for clarity: $K_{w} = D_{w} \\pi r^{2} \\Delta C_{w}$ and $K_{O_{2}} = D_{O_{2}} \\pi r^{2} \\Delta C_{O_{2}}$. Then,\n$$\n\\boldsymbol{\\mu}(\\boldsymbol{\\theta}) = \\frac{N}{\\ell} \\begin{pmatrix} K_{w} \\\\ K_{O_{2}} \\end{pmatrix}\n$$\nThe noise vector $\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{1} \\\\ \\varepsilon_{2} \\end{pmatrix}$ represents the deviation of the measurements from the model predictions. The noise is Gaussian with zero mean, $E[\\boldsymbol{\\varepsilon}] = \\mathbf{0}$. The measurement noises are independent. The variance of the first component of $\\mathbf{y}$, $y_{1} = \\dot{m}_{w}/M_{w}$, is $\\text{Var}(y_{1}) = \\text{Var}(\\dot{m}_{w}/M_{w}) = (1/M_{w}^{2})\\text{Var}(\\dot{m}_{w}) = \\sigma_{w}^{2}/M_{w}^{2}$. The variance of the second component, $y_2=\\dot{n}_{O_2}$, is given as $\\text{Var}(y_{2}) = \\sigma_{O_{2}}^{2}$.\nThe covariance matrix of the noise vector $\\boldsymbol{\\varepsilon}$ is therefore diagonal:\n$$\n\\mathbf{\\Sigma} = \\begin{pmatrix} \\sigma_{w}^{2}/M_{w}^{2} & 0 \\\\ 0 & \\sigma_{O_{2}}^{2} \\end{pmatrix}\n$$\nThe factors considered known are the constants $r, M_{w}, D_{w}, D_{O_{2}}, \\Delta C_{w}, \\Delta C_{O_{2}}$ and the noise variances $\\sigma_{w}^{2}, \\sigma_{O_{2}}^{2}$. The quantities $\\dot{m}_{w}$ and $\\dot{n}_{O_{2}}$ are the measured data.\n\nTask 2: Fisher Information Matrix and Identifiability\nThe Fisher Information Matrix (FIM), denoted $\\mathcal{I}(\\boldsymbol{\\theta})$, for a model with independent Gaussian noise is given by $\\mathcal{I}(\\boldsymbol{\\theta}) = J^{\\top} \\mathbf{\\Sigma}^{-1} J$, where $J$ is the Jacobian matrix of the model predictions with respect to the parameters.\nThe Jacobian $J$ has elements $J_{ij} = \\partial \\mu_{i} / \\partial \\theta_{j}$. Here, $\\boldsymbol{\\theta} = (\\theta_{1}, \\theta_{2})^{\\top} = (N, \\ell)^{\\top}$.\nThe partial derivatives are:\n$$\n\\frac{\\partial \\mu_{1}}{\\partial N} = \\frac{K_{w}}{\\ell} \\quad ; \\quad \\frac{\\partial \\mu_{1}}{\\partial \\ell} = -\\frac{N K_{w}}{\\ell^{2}}\n$$\n$$\n\\frac{\\partial \\mu_{2}}{\\partial N} = \\frac{K_{O_{2}}}{\\ell} \\quad ; \\quad \\frac{\\partial \\mu_{2}}{\\partial \\ell} = -\\frac{N K_{O_{2}}}{\\ell^{2}}\n$$\nThe Jacobian matrix is:\n$$\nJ = \\begin{pmatrix} K_{w}/\\ell & -N K_{w}/\\ell^{2} \\\\ K_{O_{2}}/\\ell & -N K_{O_{2}}/\\ell^{2} \\end{pmatrix}\n$$\nThe inverse of the covariance matrix is:\n$$\n\\mathbf{\\Sigma}^{-1} = \\begin{pmatrix} M_{w}^{2}/\\sigma_{w}^{2} & 0 \\\\ 0 & 1/\\sigma_{O_{2}}^{2} \\end{pmatrix}\n$$\nWe compute the FIM, $\\mathcal{I} = J^{\\top} \\mathbf{\\Sigma}^{-1} J$:\n$$\nJ^{\\top} \\mathbf{\\Sigma}^{-1} = \\begin{pmatrix} K_{w}/\\ell & K_{O_{2}}/\\ell \\\\ -N K_{w}/\\ell^{2} & -N K_{O_{2}}/\\ell^{2} \\end{pmatrix} \\begin{pmatrix} M_{w}^{2}/\\sigma_{w}^{2} & 0 \\\\ 0 & 1/\\sigma_{O_{2}}^{2} \\end{pmatrix} = \\begin{pmatrix} (K_{w}/\\ell)(M_{w}^{2}/\\sigma_{w}^{2}) & (K_{O_{2}}/\\ell)(1/\\sigma_{O_{2}}^{2}) \\\\ (-N K_{w}/\\ell^{2})(M_{w}^{2}/\\sigma_{w}^{2}) & (-N K_{O_{2}}/\\ell^{2})(1/\\sigma_{O_{2}}^{2}) \\end{pmatrix}\n$$\n$$\n\\mathcal{I} = (J^{\\top} \\mathbf{\\Sigma}^{-1}) J = \\begin{pmatrix} (K_{w}/\\ell)(M_{w}^{2}/\\sigma_{w}^{2}) & (K_{O_{2}}/\\ell)(1/\\sigma_{O_{2}}^{2}) \\\\ (-N K_{w}/\\ell^{2})(M_{w}^{2}/\\sigma_{w}^{2}) & (-N K_{O_{2}}/\\ell^{2})(1/\\sigma_{O_{2}}^{2}) \\end{pmatrix} \\begin{pmatrix} K_{w}/\\ell & -N K_{w}/\\ell^{2} \\\\ K_{O_{2}}/\\ell & -N K_{O_{2}}/\\ell^{2} \\end{pmatrix}\n$$\nLet us compute the elements of $\\mathcal{I} = \\begin{pmatrix} \\mathcal{I}_{NN} & \\mathcal{I}_{N\\ell} \\\\ \\mathcal{I}_{\\ell N} & \\mathcal{I}_{\\ell\\ell} \\end{pmatrix}$.\n$$\n\\mathcal{I}_{NN} = \\frac{1}{\\ell^{2}} \\left( \\frac{K_{w}^{2} M_{w}^{2}}{\\sigma_{w}^{2}} + \\frac{K_{O_{2}}^{2}}{\\sigma_{O_{2}}^{2}} \\right)\n$$\n$$\n\\mathcal{I}_{N\\ell} = \\mathcal{I}_{\\ell N} = -\\frac{N}{\\ell^{3}} \\left( \\frac{K_{w}^{2} M_{w}^{2}}{\\sigma_{w}^{2}} + \\frac{K_{O_{2}}^{2}}{\\sigma_{O_{2}}^{2}} \\right)\n$$\n$$\n\\mathcal{I}_{\\ell\\ell} = \\frac{N^{2}}{\\ell^{4}} \\left( \\frac{K_{w}^{2} M_{w}^{2}}{\\sigma_{w}^{2}} + \\frac{K_{O_{2}}^{2}}{\\sigma_{O_{2}}^{2}} \\right)\n$$\nNow, we compute the determinant of the FIM:\n$$\n\\det(\\mathcal{I}) = \\mathcal{I}_{NN}\\mathcal{I}_{\\ell\\ell} - \\mathcal{I}_{N\\ell}^{2}\n$$\n$$\n\\det(\\mathcal{I}) = \\left[ \\frac{1}{\\ell^{2}} \\left( \\dots \\right) \\right] \\left[ \\frac{N^{2}}{\\ell^{4}} \\left( \\dots \\right) \\right] - \\left[ -\\frac{N}{\\ell^{3}} \\left( \\dots \\right) \\right]^{2}\n$$\n$$\n\\det(\\mathcal{I}) = \\frac{N^{2}}{\\ell^{6}} \\left( \\frac{K_{w}^{2} M_{w}^{2}}{\\sigma_{w}^{2}} + \\frac{K_{O_{2}}^{2}}{\\sigma_{O_{2}}^{2}} \\right)^{2} - \\frac{N^{2}}{\\ell^{6}} \\left( \\frac{K_{w}^{2} M_{w}^{2}}{\\sigma_{w}^{2}} + \\frac{K_{O_{2}}^{2}}{\\sigma_{O_{2}}^{2}} \\right)^{2} = 0\n$$\nSince the determinant of the Fisher Information Matrix is identically zero, the matrix is singular. A singular FIM indicates that the parameters $N$ and $\\ell$ are not locally identifiable from the two given measurements. The columns of the Jacobian matrix are linearly dependent, which means that changes in $N$ and $\\ell$ cannot be distinguished. Specifically, the second column of $J$ is a multiple of the first column: $\\text{col}_{2}(J) = (-N/\\ell) \\times \\text{col}_{1}(J)$.\n\nTask 3: Structurally Identifiable Combination\nThe non-identifiability arises because both model equations, $\\mu_{w}$ and $\\mu_{O_2}$, depend on the parameters $N$ and $\\ell$ only through the ratio $\\psi(\\boldsymbol{\\theta}) = N/\\ell$. Any pair of parameters $(c N, c \\ell)$ for a scaling factor $c > 0$ will produce the same model output as the pair $(N, \\ell)$, because the ratio $(c N)/(c \\ell) = N/\\ell$ is invariant. Therefore, we can only estimate the combined parameter $\\psi = N/\\ell$, but not $N$ and $\\ell$ individually. This combination $\\psi(\\boldsymbol{\\theta}) = N/\\ell$ is structurally identifiable.\n\nThe problem asks for this combination to be expressed using the water measurement and known constants. We use the model for water vapor flux:\n$$\n\\frac{\\dot{m}_{w}}{M_{w}} \\approx \\frac{N\\,D_{w}\\,\\pi r^{2}}{\\ell}\\,\\Delta C_{w}\n$$\nThis equation relates the measurement $\\dot{m}_{w}$ to the identifiable parameter combination $N/\\ell$. We can rearrange this equation to solve for $N/\\ell$:\n$$\n\\frac{N}{\\ell} \\approx \\frac{\\dot{m}_{w}}{M_{w}} \\frac{1}{D_{w} \\pi r^{2} \\Delta C_{w}}\n$$\nThis expression represents the best estimate of the identifiable combination $\\psi(\\boldsymbol{\\theta}) = N/\\ell$ that can be obtained from the water measurement. This is the required closed-form expression. The proper expression should be provided in the final answer box. Substituting the full expressions for the constants $K_w$ and $K_{O_2}$ into the determinant confirms it is zero, and the reason is the structural dependence on $N/\\ell$.\n\nFinal expression is thus derived from the water flux equation.\n$$\n\\psi(\\boldsymbol{\\theta}) = \\frac{N}{\\ell} = \\frac{\\dot{m}_{w}}{M_{w} D_{w} \\pi r^{2} \\Delta C_{w}}\n$$\nThis provides the estimable value of the parameter combination from the given data.", "answer": "$$\n\\boxed{\\frac{\\dot{m}_{w}}{M_{w} D_{w} \\pi r^{2} \\Delta C_{w}}}\n$$", "id": "2572472"}, {"introduction": "Having explored the physics of the amniotic egg's function, we now turn to its formation. The evolution of novel structures like the amnion and chorion is a question of developmental biology, which today can be investigated with powerful genomic tools. This practice simulates the analysis of single-cell RNA-sequencing data to computationally reconstruct the differentiation pathways that give rise to these extraembryonic membranes [@problem_id:2572391]. By implementing a step-by-step algorithm involving graph-based pseudotime and probabilistic evidence fusion, you will gain hands-on experience with the quantitative methods at the heart of modern evolutionary and developmental biology.", "problem": "A key evolutionary innovation of amniotes is the emergence of extraembryonic membranes, including the amnion and chorion. In comparative zoology and botany, and particularly in the study of the evolution of the amniotic egg, single-cell Ribonucleic Acid sequencing (scRNA-seq) provides a quantitative snapshot of gene expression states that reflect lineage-specific regulatory programs. This problem asks you to formalize lineage trajectory reconstruction into amnion versus chorion from a small, synthetic scRNA-seq dataset using a graph-based pseudotime and a probabilistic fusion of graph and marker evidence, and to validate predictions with partial fate mapping labels. The problem is fully self-contained and purely mathematical: you will implement the specified computations on given numeric arrays and report prediction accuracies.\n\nAssume the following foundational base:\n- According to the Central Dogma of molecular biology, gene expression levels of messenger Ribonucleic Acid reflect the activity of gene regulatory programs. Cells differentiate along continuous trajectories in gene expression space.\n- A $k$-nearest neighbor graph approximates the low-dimensional manifold of gene expression states. Shortest-path geodesic distances along this graph approximate developmental distances.\n- Marker genes enriched in a lineage provide statistical evidence of fate bias; a Bayesian fusion of independent evidences can be approximated by summing log-odds.\n\nDefine the following for a given test case:\n- Let there be $C$ cells and $G$ genes, with expression matrix $X \\in \\mathbb{R}^{C \\times G}$.\n- Let $A \\subset \\{0,\\dots,G-1\\}$ be the index set of amnion markers and $B \\subset \\{0,\\dots,G-1\\}$ be the index set of chorion markers.\n- Let $E \\subset \\{0,\\dots,C-1\\} \\times \\{0,\\dots,C-1\\}$ be an undirected, unweighted edge set defining a graph on cells; if $(i,j) \\in E$ then there is an edge of weight $1$ connecting $i$ and $j$.\n- Let $r \\in \\{0,\\dots,C-1\\}$ be the root (progenitor) cell index, $t_A \\in \\{0,\\dots,C-1\\}$ the amnion tip index, and $t_C \\in \\{0,\\dots,C-1\\}$ the chorion tip index.\n- Let $L$ be a partial fate map, a function on a subset of cell indices giving labels $1$ for amnion and $0$ for chorion.\n\nYou must implement the following steps to compute a posterior amnion probability $\\hat{p}_i$ for each cell $i$, and validate on labeled cells:\n1. Build an undirected graph with adjacency from $E$. Compute shortest-path distances $d(r,i)$ from the root $r$ to each cell $i$ using breadth-first search. Define pseudotime $s_i = d(r,i) / \\max_j d(r,j)$ for all $i$ with finite distance. Also compute $d(t_A,i)$ and $d(t_C,i)$ for all $i$.\n2. Define a graph-based branch probability toward amnion using a softmax over negative distances:\n$$\np^{\\mathrm{graph}}_i = \\frac{\\exp(-\\beta\\, d(t_A,i))}{\\exp(-\\beta\\, d(t_A,i)) + \\exp(-\\beta\\, d(t_C,i))},\n$$\nwith $\\beta = 1$.\n3. Standardize each gene across cells by a $z$-score with a small numerical stabilizer $\\varepsilon$:\n$$\n\\mu_g = \\frac{1}{C} \\sum_{i=0}^{C-1} X_{i,g}, \\quad\n\\sigma_g = \\sqrt{\\frac{1}{C} \\sum_{i=0}^{C-1} (X_{i,g} - \\mu_g)^2 + \\varepsilon}, \\quad\nZ_{i,g} = \\frac{X_{i,g} - \\mu_g}{\\sigma_g},\n$$\nwith $\\varepsilon = 10^{-6}$.\n4. Compute amnion and chorion marker scores per cell as averages of standardized expression:\n$$\nm^{A}_i = \\frac{1}{|A|} \\sum_{g \\in A} Z_{i,g}, \\quad\nm^{C}_i = \\frac{1}{|B|} \\sum_{g \\in B} Z_{i,g}.\n$$\n5. Map marker evidence to a probability via a logistic function with slope parameter $\\alpha = 1$:\n$$\np^{\\mathrm{mark}}_i = \\sigma\\big(\\alpha \\,(m^{A}_i - m^{C}_i)\\big) = \\frac{1}{1 + \\exp\\big(-\\alpha \\,(m^{A}_i - m^{C}_i)\\big)}.\n$$\n6. Combine independent evidences by summing log-odds (a product-of-experts approximation) to obtain the posterior amnion probability:\n$$\n\\ell^{\\mathrm{graph}}_i = \\log\\frac{p^{\\mathrm{graph}}_i}{1 - p^{\\mathrm{graph}}_i}, \\quad\n\\ell^{\\mathrm{mark}}_i = \\log\\frac{p^{\\mathrm{mark}}_i}{1 - p^{\\mathrm{mark}}_i}, \\quad\n\\hat{p}_i = \\sigma\\big(\\ell^{\\mathrm{graph}}_i + \\ell^{\\mathrm{mark}}_i\\big).\n$$\n7. Predict amnion if $\\hat{p}_i \\ge 0.5$ and chorion otherwise. Let $\\widehat{y}_i \\in \\{0,1\\}$ be the predicted label. On labeled cells $i \\in \\mathrm{dom}(L)$, compute the accuracy\n$$\n\\mathrm{Acc} = \\frac{1}{|\\mathrm{dom}(L)|} \\sum_{i \\in \\mathrm{dom}(L)} \\mathbb{I}[\\widehat{y}_i = L(i)],\n$$\nwhere $\\mathbb{I}[\\cdot]$ is the indicator function. Report this accuracy as a real number in $[0,1]$.\n\nAll quantities are unitless. Angles are not used. The final result for each test case must be rounded to exactly three decimal places.\n\nTest suite:\n- Case $1$ (happy path):\n  - $C = 7$, $G = 4$.\n  - Expression:\n  $$\n  X^{(1)} =\n  \\begin{bmatrix}\n  2 & 2 & 2 & 2\\\\\n  3 & 3 & 2 & 2\\\\\n  4 & 4 & 1 & 1\\\\\n  5 & 5 & 1 & 1\\\\\n  2 & 2 & 3 & 3\\\\\n  1 & 1 & 4 & 4\\\\\n  1 & 1 & 5 & 5\n  \\end{bmatrix}\n  $$\n  - Markers: $A^{(1)} = [0,1]$, $B^{(1)} = [2,3]$.\n  - Graph edges:\n  $$\n  E^{(1)} = \\{(0,1),(1,2),(2,3),(0,4),(4,5),(5,6)\\}.\n  $$\n  - Root and tips: $r^{(1)} = 0$, $t_A^{(1)} = 3$, $t_C^{(1)} = 6$.\n  - Labeled cells:\n  $$\n  L^{(1)} = \\{3 \\mapsto 1,\\; 6 \\mapsto 0,\\; 2 \\mapsto 1,\\; 5 \\mapsto 0\\}.\n  $$\n- Case $2$ (boundary condition with balanced branches and mixed markers):\n  - $C = 5$, $G = 4$.\n  - Expression:\n  $\n  X^{(2)} =\n  \\begin{bmatrix}\n  2 & 2 & 2 & 2\\\\\n  3 & 3 & 2 & 2\\\\\n  4 & 3 & 2 & 2\\\\\n  2 & 2 & 3 & 3\\\\\n  2 & 2 & 4 & 3\n  \\end{bmatrix}\n  $\n  - Markers: $A^{(2)} = [0,1]$, $B^{(2)} = [2,3]$.\n  - Graph edges:\n  $\n  E^{(2)} = \\{(0,1),(1,2),(0,3),(3,4)\\}.\n  $\n  - Root and tips: $r^{(2)} = 0$, $t_A^{(2)} = 2$, $t_C^{(2)} = 4$.\n  - Labeled cells:\n  $\n  L^{(2)} = \\{2 \\mapsto 1,\\; 4 \\mapsto 0\\}.\n  $\n- Case $3$ (edge case with ambiguous early marker signal but asymmetric branch lengths):\n  - $C = 6$, $G = 4$.\n  - Expression:\n  $\n  X^{(3)} =\n  \\begin{bmatrix}\n  2 & 2 & 2 & 2\\\\\n  3 & 3 & 3 & 3\\\\\n  5 & 4 & 2 & 2\\\\\n  2 & 2 & 3 & 3\\\\\n  1 & 1 & 4 & 4\\\\\n  1 & 1 & 5 & 5\n  \\end{bmatrix}\n  $\n  - Markers: $A^{(3)} = [0,1]$, $B^{(3)} = [2,3]$.\n  - Graph edges:\n  $\n  E^{(3)} = \\{(0,1),(1,2),(0,3),(3,4),(4,5)\\}.\n  $\n  - Root and tips: $r^{(3)} = 0$, $t_A^{(3)} = 2$, $t_C^{(3)} = 5$.\n  - Labeled cells:\n  $\n  L^{(3)} = \\{2 \\mapsto 1,\\; 5 \\mapsto 0,\\; 1 \\mapsto 1\\}.\n  $\n\nYour program must implement the above definitions exactly and use $\\varepsilon = 10^{-6}$, $\\alpha = 1$, and $\\beta = 1$. The required final output format is a single line containing a Python-style list with the accuracies for cases $1$, $2$, and $3$, rounded to three decimal places, as:\n\"[a1,a2,a3]\".", "solution": "The problem statement is critically evaluated and determined to be valid. It is scientifically grounded in established principles of computational biology, well-posed with a clear, deterministic algorithmic structure, and expressed in objective, mathematical language. It is a self-contained computational problem with all necessary data and parameters provided. There are no identifiable flaws such as scientific unsoundness, ambiguity, or contradiction.\n\nThe solution proceeds by implementing the specified multi-step procedure to analyze synthetic single-cell gene expression data. The objective is to reconstruct a bifurcating lineage trajectory, assign cells to either an amnion or chorion fate, and calculate the prediction accuracy against a provided partial truth set.\n\nThe implementation is structured as follows:\n\n1.  **Graph Representation and Distance Calculation**: An undirected graph is constructed from the given edge set $E$ using an adjacency list representation. Shortest-path distances from the root ($r$), amnion tip ($t_A$), and chorion tip ($t_C$) to all other cells are computed. As the graph is unweighted, Breadth-First Search (BFS) is the appropriate algorithm for this task. A BFS implementation utilizing a queue computes the distances $d(r,i)$, $d(t_A,i)$, and $d(t_C,i)$ for each cell $i$.\n\n2.  **Graph-Based Branch Probability**: The distances to the two lineage tips, $t_A$ and $t_C$, are used to define a cell's bias toward the amnion branch. The graph-based probability, $p^{\\mathrm{graph}}_i$, is calculated using the softmax function on the negative distances, with the specified parameter $\\beta=1$:\n    $$\n    p^{\\mathrm{graph}}_i = \\frac{\\exp(-\\beta\\, d(t_A,i))}{\\exp(-\\beta\\, d(t_A,i)) + \\exp(-\\beta\\, d(t_C,i))}\n    $$\n    This value reflects a cell's relative geodesic proximity to the amnion tip versus the chorion tip within the developmental manifold approximated by the graph.\n\n3.  **Gene Expression Standardization**: The raw gene expression matrix $X$ is standardized to account for differences in measurement scale across genes. For each gene $g$, its expression values across all cells $C$ are converted to $Z$-scores. The population mean $\\mu_g$ and population standard deviation $\\sigma_g$ are calculated. A small stabilizer $\\varepsilon = 10^{-6}$ is added to the variance before taking the square root to prevent division by zero for genes with no variation. The standardized expression $Z_{i,g}$ for cell $i$ and gene $g$ is:\n    $$\n    Z_{i,g} = \\frac{X_{i,g} - \\mu_g}{\\sigma_g}\n    $$\n\n4.  **Marker-Based Score and Probability**: Evidence from marker gene expression is quantified. For each cell $i$, an amnion score $m^A_i$ and a chorion score $m^C_i$ are computed by averaging the standardized expression levels of the respective marker genes defined by index sets $A$ and $B$.\n    $$\n    m^{A}_i = \\frac{1}{|A|} \\sum_{g \\in A} Z_{i,g}, \\quad\n    m^{C}_i = \\frac{1}{|B|} \\sum_{g \\in B} Z_{i,g}.\n    $$\n    The difference between these scores, $m^A_i - m^C_i$, represents the net marker evidence for the amnion fate. This score is transformed into a probability, $p^{\\mathrm{mark}}_i$, using the logistic (sigmoid) function $\\sigma(\\cdot)$ with parameter $\\alpha=1$:\n    $$\n    p^{\\mathrm{mark}}_i = \\sigma\\big(\\alpha \\,(m^{A}_i - m^{C}_i)\\big)\n    $$\n\n5.  **Evidence Fusion**: The graph-based evidence and marker-based evidence are assumed to be independent and are fused probabilistically. This is achieved by summing their log-odds (logits), which is equivalent to a product of experts in probability space. The logit transformation for a probability $p$ is $\\ell = \\log(p / (1-p))$. The total log-odds is the sum of the individual log-odds:\n    $$\n    \\ell^{\\mathrm{total}}_i = \\ell^{\\mathrm{graph}}_i + \\ell^{\\mathrm{mark}}_i\n    $$\n    The final posterior probability of a cell belonging to the amnion lineage, $\\hat{p}_i$, is obtained by transforming the total log-odds back to a probability using the sigmoid function:\n    $$\n    \\hat{p}_i = \\sigma(\\ell^{\\mathrm{total}}_i)\n    $$\n    For numerical stability, probabilities are clipped to a small distance from $0$ and $1$ before applying the logit function.\n\n6.  **Prediction and Accuracy Assessment**: A final fate prediction $\\widehat{y}_i$ is made for each cell. If the posterior amnion probability $\\hat{p}_i$ is greater than or equal to $0.5$, the cell is classified as amnion ($\\widehat{y}_i=1$); otherwise, it is classified as chorion ($\\widehat{y}_i=0$). The performance of this classification is evaluated by computing the accuracy on the subset of cells for which true fate labels are provided in the map $L$. The accuracy is the fraction of correctly predicted labels:\n    $$\n    \\mathrm{Acc} = \\frac{1}{|\\mathrm{dom}(L)|} \\sum_{i \\in \\mathrm{dom}(L)} \\mathbb{I}[\\widehat{y}_i = L(i)]\n    $$\n    The final accuracy for each test case is reported, rounded to three decimal places.", "answer": "```python\nimport numpy as np\nfrom collections import deque\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and compute results.\n    \"\"\"\n    \n    # Case 1 (happy path)\n    X1 = np.array([\n        [2, 2, 2, 2], [3, 3, 2, 2], [4, 4, 1, 1], [5, 5, 1, 1],\n        [2, 2, 3, 3], [1, 1, 4, 4], [1, 1, 5, 5]\n    ], dtype=float)\n    A1, B1 = [0, 1], [2, 3]\n    E1 = {(0, 1), (1, 2), (2, 3), (0, 4), (4, 5), (5, 6)}\n    r1, t_A1, t_C1 = 0, 3, 6\n    L1 = {3: 1, 6: 0, 2: 1, 5: 0}\n    \n    # Case 2 (boundary condition with balanced branches and mixed markers)\n    X2 = np.array([\n        [2, 2, 2, 2], [3, 3, 2, 2], [4, 3, 2, 2],\n        [2, 2, 3, 3], [2, 2, 4, 3]\n    ], dtype=float)\n    A2, B2 = [0, 1], [2, 3]\n    E2 = {(0, 1), (1, 2), (0, 3), (3, 4)}\n    r2, t_A2, t_C2 = 0, 2, 4\n    L2 = {2: 1, 4: 0}\n    \n    # Case 3 (edge case with ambiguous early marker signal but asymmetric branch lengths)\n    X3 = np.array([\n        [2, 2, 2, 2], [3, 3, 3, 3], [5, 4, 2, 2],\n        [2, 2, 3, 3], [1, 1, 4, 4], [1, 1, 5, 5]\n    ], dtype=float)\n    A3, B3 = [0, 1], [2, 3]\n    E3 = {(0, 1), (1, 2), (0, 3), (3, 4), (4, 5)}\n    r3, t_A3, t_C3 = 0, 2, 5\n    L3 = {2: 1, 5: 0, 1: 1}\n\n    test_cases = [\n        (X1, A1, B1, E1, r1, t_A1, t_C1, L1),\n        (X2, A2, B2, E2, r2, t_A2, t_C2, L2),\n        (X3, A3, B3, E3, r3, t_A3, t_C3, L3)\n    ]\n\n    results = []\n    for case in test_cases:\n        accuracy = solve_case(*case)\n        results.append(accuracy)\n\n    # Format the final output string as specified.\n    print(f\"[{','.join([f'{r:.3f}' for r in results])}]\")\n\ndef sigmoid(x):\n    \"\"\"Computes the sigmoid function.\"\"\"\n    return 1 / (1 + np.exp(-x))\n\ndef solve_case(X, A, B, E, r, t_A, t_C, L):\n    \"\"\"\n    Solves a single test case according to the problem description.\n    \"\"\"\n    C, G = X.shape\n\n    # Step 1: Build graph and compute shortest-path distances using BFS\n    adj = {i: [] for i in range(C)}\n    for u, v in E:\n        adj[u].append(v)\n        adj[v].append(u)\n\n    def bfs(start_node):\n        q = deque([(start_node, 0)])\n        dists = {i: float('inf') for i in range(C)}\n        if start_node in dists:\n            dists[start_node] = 0\n        \n        visited = {start_node}\n        while q:\n            u, d = q.popleft()\n            for v in adj.get(u, []):\n                if v not in visited:\n                    visited.add(v)\n                    dists[v] = d + 1\n                    q.append((v, d + 1))\n        return np.array([dists[i] for i in range(C)])\n\n    dist_A = bfs(t_A)\n    dist_C = bfs(t_C)\n    \n    # Step 2: Define graph-based branch probability\n    beta = 1.0\n    exp_neg_dist_A = np.exp(-beta * dist_A)\n    exp_neg_dist_C = np.exp(-beta * dist_C)\n    p_graph = exp_neg_dist_A / (exp_neg_dist_A + exp_neg_dist_C)\n\n    # Step 3: Standardize gene expression (z-score)\n    epsilon = 1e-6\n    mu_g = X.mean(axis=0)\n    # Using np.var is equivalent to np.mean((X - mu_g)**2, axis=0)\n    sigma_g = np.sqrt(np.var(X, axis=0) + epsilon)\n    Z = (X - mu_g) / sigma_g\n\n    # Step 4: Compute marker scores\n    m_A = Z[:, A].mean(axis=1) if len(A) > 0 else np.zeros(C)\n    m_C = Z[:, B].mean(axis=1) if len(B) > 0 else np.zeros(C)\n\n    # Step 5: Map marker evidence to a probability\n    alpha = 1.0\n    p_mark = sigmoid(alpha * (m_A - m_C))\n\n    # Step 6: Combine independent evidences by summing log-odds\n    # Clip for numerical stability if probabilities are close to 0 or 1.\n    p_graph_c = np.clip(p_graph, 1e-15, 1 - 1e-15)\n    p_mark_c = np.clip(p_mark, 1e-15, 1 - 1e-15)\n\n    # logit(p) = log(p/(1-p)) = log(p) - log(1-p)\n    # np.log1p(x) computes log(1+x) accurately for small x.\n    # So, np.log(1-p) is np.log1p(-p).\n    l_graph = np.log(p_graph_c) - np.log1p(-p_graph_c)\n    l_mark = np.log(p_mark_c) - np.log1p(-p_mark_c)\n    \n    p_hat = sigmoid(l_graph + l_mark)\n\n    # Step 7: Predict and compute accuracy\n    predictions = (p_hat >= 0.5).astype(int)\n    \n    labeled_indices = list(L.keys())\n    if not labeled_indices:\n        return 1.0\n\n    true_labels = np.array([L[i] for i in labeled_indices])\n    predicted_labels = predictions[labeled_indices]\n    \n    accuracy = np.mean(predicted_labels == true_labels)\n    \n    return accuracy\n\nif __name__ == '__main__':\n    solve()\n\n```", "id": "2572391"}]}