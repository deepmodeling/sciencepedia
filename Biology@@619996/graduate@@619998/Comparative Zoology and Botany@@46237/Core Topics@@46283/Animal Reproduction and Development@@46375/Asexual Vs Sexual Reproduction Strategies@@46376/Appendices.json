{"hands_on_practices": [{"introduction": "The persistence of sexual reproduction is a central enigma in evolutionary biology, primarily due to the \"twofold cost of males.\" This foundational exercise guides you through a first-principles derivation of this cost, contrasting the population growth rates of asexual and sexual lineages. By formalizing this concept with Malthusian parameters [@problem_id:2547512], you will quantify the powerful demographic advantage of asexual reproduction and appreciate the magnitude of the evolutionary benefits that sex must provide to overcome it.", "problem": "In a comparative zoology and botany context, consider two obligately reproducing populations: an obligate asexual lineage and an obligate sexual lineage. Assume large population sizes, density-independent demography, and continuous time. For both strategies, assume equal female per-capita fecundity $b$ defined as the instantaneous rate at which an adult female produces newborns (zygotes or clonal offspring), and equal female per-capita mortality $d$. In the sexual lineage, assume Fisher’s principle yields an equal primary sex ratio so that a fraction $1/2$ of newborns are daughters, and only daughters contribute to the next generation’s pool of reproducing females. In the asexual lineage, assume all offspring are daughters (clonal females). Ignore juvenile stages and maturation delays by interpreting $b$ and $d$ as effective rates for the reproducing female class.\n\nUsing the definition of the Malthusian parameter as the instantaneous per-capita exponential growth rate of the reproducing female population, derive from first principles the ratio of the asexual Malthusian parameter to the sexual Malthusian parameter in terms of $b$ and $d$. Your derivation must start from the definitions of per-capita birth and death processes for females and should justify any sex-ratio factor. Express your final answer as a single closed-form analytic expression in terms of $b$ and $d$. No rounding is required. Do not include units in your final answer.", "solution": "The problem requires the derivation of the ratio of the Malthusian parameter for an obligate asexual lineage to that of an obligate sexual lineage. The Malthusian parameter, which we denote as $r$, is defined as the instantaneous per-capita exponential growth rate of the reproducing female population.\n\nLet $N(t)$ represent the number of reproducing females at time $t$. The dynamics of this population, under the assumption of density independence, are described by the differential equation:\n$$\n\\frac{dN}{dt} = r N\n$$\nThe parameter $r$ is the net result of per-capita births and deaths. Specifically, it is the per-capita birth rate of females, $b_f$, minus the per-capita death rate of females, $d_f$.\n$$\nr = b_f - d_f\n$$\nWe will now apply this fundamental principle to each lineage described in the problem statement.\n\nFirst, consider the **obligate asexual lineage**. Let its Malthusian parameter be $r_a$. The per-capita fecundity of a female is given as $b$. In this lineage, all offspring are clonal females. Therefore, the rate at which a single female produces new females is exactly $b$. Thus, the per-capita birth rate of females for the asexual population, $b_{f, a}$, is:\n$$\nb_{f, a} = b\n$$\nThe per-capita mortality rate for females is given as $d$. Hence, $d_{f, a} = d$.\nThe Malthusian parameter for the asexual lineage, $r_a$, is therefore:\n$$\nr_a = b_{f, a} - d_{f, a} = b - d\n$$\n\nNext, consider the **obligate sexual lineage**. Let its Malthusian parameter be $r_s$. The per-capita fecundity of a female is again given as $b$. However, the problem states that for this lineage, an equal primary sex ratio is maintained, meaning only a fraction of $1/2$ of the newborns are daughters. The growth of the female population depends exclusively on the production of new females. Consequently, the effective per-capita birth rate of females, $b_{f, s}$, is the total fecundity rate $b$ multiplied by the fraction of female offspring, which is $1/2$.\n$$\nb_{f, s} = b \\times \\frac{1}{2} = \\frac{b}{2}\n$$\nThis halving of the effective female birth rate is the mathematical representation of the \"twofold cost of sex,\" where reproductive resources are allocated to producing males who do not directly contribute to the number of reproducing individuals in the next generation. The per-capita mortality rate for females is the same as in the asexual case, $d_{f, s} = d$.\nThe Malthusian parameter for the sexual lineage, $r_s$, is therefore:\n$$\nr_s = b_{f, s} - d_{f, s} = \\frac{b}{2} - d\n$$\n\nFinally, we must compute the ratio of the asexual Malthusian parameter to the sexual Malthusian parameter, $\\frac{r_a}{r_s}$. Using the expressions derived above:\n$$\n\\frac{r_a}{r_s} = \\frac{b - d}{\\frac{b}{2} - d}\n$$\nTo simplify this expression into the required closed-form, we multiply the numerator and the denominator by $2$:\n$$\n\\frac{r_a}{r_s} = \\frac{2(b - d)}{2 \\left(\\frac{b}{2} - d\\right)} = \\frac{2(b - d)}{b - 2d}\n$$\nThis is the final analytical expression for the ratio requested.", "answer": "$$\\boxed{\\frac{2(b - d)}{b - 2d}}$$", "id": "2547512"}, {"introduction": "Beyond the demographic cost of producing males, sexual reproduction can carry genetic costs. This practice explores the concept of \"segregation load,\" demonstrating how the mechanics of Mendelian genetics can impose a fitness cost by breaking apart advantageous heterozygous genotypes. By solving this problem [@problem_id:2547339], you will see how asexual reproduction can \"freeze\" an optimal genotype, conferring a direct fitness advantage over sexual competitors that continually produce less-fit homozygous offspring through segregation.", "problem": "A diploid species (animal or plant) carries a single biallelic locus with alleles $A$ and $a$. Viability selection acts only at this locus and exhibits symmetric heterozygote advantage (overdominance): genotypic viabilities are $w_{\\mathrm{AA}}=1-s$, $w_{\\mathrm{Aa}}=1$, and $w_{\\mathrm{aa}}=1-s$, where $0 < s < 1$. Consider two reproductive strategies:\n\n- Sexual: Random mating with Mendelian segregation. Assume a very large population, discrete generations, no mutation, and that the sexual population has reached its deterministic equilibrium allele frequency under these conditions. Define the mean viability (mean fitness) of the sexual population at equilibrium as $\\bar{w}_{\\mathrm{sex}}$.\n- Asexual: An asexual lineage originates from a single heterozygous parent and reproduces clonally such that the heterozygous genotype $Aa$ is perpetuated exactly each generation. Define its constant viability as $w_{\\mathrm{asex}}$.\n\nAssume there are no other costs or benefits associated with sexual or asexual reproduction beyond the genotypic viabilities defined above. Let the heterozygote advantage be $s=0.1$. Define the fitness difference $D$ as $D=w_{\\mathrm{asex}}-\\bar{w}_{\\mathrm{sex}}$. Compute $D$ for $s=0.1$ and express your final answer as a decimal number with no units. No rounding instruction is needed because the answer is exact.", "solution": "The problem requires the computation of a fitness difference, $D$, between an asexual lineage and a sexual population at equilibrium. The definition is given as $D = w_{\\mathrm{asex}} - \\bar{w}_{\\mathrm{sex}}$. We will proceed by first validating the problem statement and then solving it by calculating the two terms, $w_{\\mathrm{asex}}$ and $\\bar{w}_{\\mathrm{sex}}$, separately.\n\nFirst, a validation of the problem statement.\nThe givens are:\n- A diploid species with a single biallelic locus, alleles $A$ and $a$.\n- Genotypic viabilities (fitnesses): $w_{\\mathrm{AA}}=1-s$, $w_{\\mathrm{Aa}}=1$, $w_{\\mathrm{aa}}=1-s$.\n- The selection coefficient $s$ is bounded: $0<s<1$.\n- A sexual population is at its deterministic equilibrium allele frequency. Its mean viability is $\\bar{w}_{\\mathrm{sex}}$.\n- An asexual lineage originates from a heterozygous ($Aa$) parent and reproduces clonally. Its constant viability is $w_{\\mathrm{asex}}$.\n- There are no other costs associated with reproduction modes.\n- The specific value of the selection coefficient is $s=0.1$.\n- The fitness difference is $D = w_{\\mathrm{asex}}-\\bar{w}_{\\mathrm{sex}}$.\n\nThe problem is scientifically grounded, as it uses the standard population genetics model of viability selection with symmetric overdominance. The assumptions of a large population, random mating, and discrete generations are appropriate for a deterministic analysis leading to a stable equilibrium. The problem is well-posed, objective, and contains all necessary information to derive a unique solution. The model is a valid, though simplified, representation of evolutionary dynamics. Therefore, the problem is valid and a solution can be sought.\n\nThe first step is to determine the viability of the asexual lineage, $w_{\\mathrm{asex}}$. The problem states that this lineage originates from a single heterozygous parent ($Aa$) and reproduces clonally. This means that all offspring are genetically identical to the parent, having the genotype $Aa$. The viability of this lineage is therefore constant and equal to the viability of the $Aa$ genotype.\n$$w_{\\mathrm{asex}} = w_{\\mathrm{Aa}} = 1$$\n\nThe second step is to determine the mean viability of the sexual population at equilibrium, $\\bar{w}_{\\mathrm{sex}}$. This requires finding the equilibrium allele frequencies. Let $p$ be the frequency of the allele $A$ and $q$ be the frequency of the allele $a$, with the constraint that $p+q=1$. In a very large, randomly mating population, the genotype frequencies at the zygote stage are given by the Hardy-Weinberg proportions: $p^2$ for $AA$, $2pq$ for $Aa$, and $q^2$ for $aa$.\n\nThe mean viability of the population, $\\bar{w}$, is the average of the genotypic viabilities weighted by their frequencies:\n$$\\bar{w} = p^2 w_{\\mathrm{AA}} + 2pq w_{\\mathrm{Aa}} + q^2 w_{\\mathrm{aa}}$$\nSubstituting the given viability values:\n$$\\bar{w} = p^2(1-s) + 2pq(1) + q^2(1-s)$$\nThis can be simplified using the identity $(p+q)^2 = p^2 + 2pq + q^2 = 1$:\n$$\\bar{w} = p^2 - sp^2 + 2pq + q^2 - sq^2 = (p^2 + 2pq + q^2) - s(p^2 + q^2) = 1 - s(p^2 + q^2)$$\n\nTo find the equilibrium, we must find the allele frequency $p$ for which the frequency does not change from one generation to the next. The frequency of allele $A$ in the next generation, $p'$, is the frequency of $A$ alleles in the population after selection has occurred:\n$$p' = \\frac{\\text{frequency of } A \\text{ alleles after selection}}{\\text{sum of frequencies of all alleles after selection}} = \\frac{p^2 w_{\\mathrm{AA}} + pq w_{\\mathrm{Aa}}}{\\bar{w}}$$\n$$p' = \\frac{p^2(1-s) + pq}{\\bar{w}}$$\nAt equilibrium, $p' = p$, which is denoted by $\\hat{p}$. So, we must solve $\\hat{p} = \\frac{\\hat{p}^2(1-s) + \\hat{p}\\hat{q}}{\\bar{w}}$. For the non-trivial polymorphic equilibrium where $\\hat{p} \\neq 0$ and $\\hat{p} \\neq 1$, we can divide by $\\hat{p}$:\n$$\\bar{w} = \\hat{p}(1-s) + \\hat{q}$$\nSubstituting $\\bar{w} = 1 - s(\\hat{p}^2 + \\hat{q}^2)$ and $\\hat{q} = 1 - \\hat{p}$:\n$$1 - s(\\hat{p}^2 + (1-\\hat{p})^2) = \\hat{p}(1-s) + (1-\\hat{p})$$\n$$1 - s(2\\hat{p}^2 - 2\\hat{p} + 1) = \\hat{p} - s\\hat{p} + 1 - \\hat{p} = 1 - s\\hat{p}$$\n$$-s(2\\hat{p}^2 - 2\\hat{p} + 1) = -s\\hat{p}$$\nSince $s \\in (0,1)$, we can divide by $-s$:\n$$2\\hat{p}^2 - 2\\hat{p} + 1 = \\hat{p}$$\n$$2\\hat{p}^2 - 3\\hat{p} + 1 = 0$$\nThis is a quadratic equation which factors as $(2\\hat{p}-1)(\\hat{p}-1) = 0$. The solutions are $\\hat{p}=1$ and $\\hat{p}=1/2$. The solution $\\hat{p}=1$ represents a monomorphic population fixed for the $A$ allele, which is an unstable equilibrium under heterozygote advantage. The stable polymorphic equilibrium is:\n$$\\hat{p} = \\frac{1}{2}$$\nConsequently, the equilibrium frequency of the $a$ allele is $\\hat{q} = 1 - \\hat{p} = 1/2$.\n\nThis result is standard for symmetric overdominance. Now, we can calculate the mean viability of the sexual population at this equilibrium, $\\bar{w}_{\\mathrm{sex}}$:\n$$\\bar{w}_{\\mathrm{sex}} = 1 - s\\left(\\left(\\frac{1}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2\\right)$$\n$$\\bar{w}_{\\mathrm{sex}} = 1 - s\\left(\\frac{1}{4} + \\frac{1}{4}\\right) = 1 - s\\left(\\frac{1}{2}\\right) = 1 - \\frac{s}{2}$$\nThis mean fitness is lower than the fitness of the heterozygote ($w_{Aa}=1$) because sexual reproduction (through Mendelian segregation) continuously produces offspring with less-fit homozygous genotypes ($AA$ and $aa$). This reduction in mean fitness is often called the \"segregation load\".\n\nFinally, we compute the fitness difference $D$:\n$$D = w_{\\mathrm{asex}} - \\bar{w}_{\\mathrm{sex}} = 1 - \\left(1 - \\frac{s}{2}\\right)$$\n$$D = \\frac{s}{2}$$\nThe problem provides a specific value for the selection coefficient, $s=0.1$. We substitute this value to obtain the final numerical answer:\n$$D = \\frac{0.1}{2} = 0.05$$\nThis value represents the fitness advantage of the asexual clone over the sexual population at equilibrium, under the specified conditions. It is precisely the segregation load incurred by the sexual population.", "answer": "$$\\boxed{0.05}$$", "id": "2547339"}, {"introduction": "After quantifying the significant costs of sex, we turn to a major hypothesis for its evolutionary maintenance: the Red Queen hypothesis. This advanced computational exercise moves beyond static analytical models into the realm of dynamic simulation, allowing you to explore how coevolution with parasites can favor sexual reproduction. You will implement a model of host-parasite interaction and use time-series analysis to test for the characteristic signatures of Red Queen dynamics, such as cyclical frequencies and phase lags [@problem_id:2547486], developing key skills in translating theory into a testable computational framework.", "problem": "You are given a conceptual framework for host–parasite coevolution under negative frequency-dependent selection that is commonly invoked to explain the advantage of sexual reproduction under the Red Queen hypothesis. Consider a host species with $2$ haploid genotypes, labeled $A$ and $B$, with the frequency of genotype $A$ at discrete time $t$ denoted by $x_t \\in (0,1)$, and the frequency of genotype $B$ given by $1 - x_t$. There are $2$ parasite strains specialized to each host genotype, with the prevalence of the strain specialized to $A$ denoted by $y_{A,t} \\in (0,1)$ and that specialized to $B$ denoted by $y_{B,t} = 1 - y_{A,t}$. All quantities are dimensionless frequencies and prevalences.\n\nFundamental population-genetic dynamics are defined by the discrete-time replicator equation for selection. If the relative fitnesses of the host genotypes at time $t$ are $w_{A,t}$ and $w_{B,t}$, then the change in host genotype frequency is governed by\n$$\nx_{t+1} \\;=\\; \\frac{x_t \\, w_{A,t}}{x_t \\, w_{A,t} + (1 - x_t) \\, w_{B,t}}.\n$$\nAssume the parasite exerts negative frequency-dependent selection via genotype-specific fitness depressions of magnitude $s \\ge 0$ proportional to the matching parasite prevalence:\n$$\nw_{A,t} \\;=\\; 1 - s\\, y_{A,t}, \\qquad w_{B,t} \\;=\\; 1 - s\\, y_{B,t}.\n$$\nAssume parasite prevalence adapts to host composition with a linear tracking rule that introduces a lag:\n$$\ny_{A,t+1} \\;=\\; y_{A,t} \\;+\\; \\gamma \\, (x_t - y_{A,t}), \\qquad \\gamma \\in [0,1],\n$$\nand $y_{B,t} = 1 - y_{A,t}$.\n\nFrom these definitions, a well-tested small-selection approximation to the replicator update yields\n$$\nx_{t+1} - x_t \\;\\approx\\; s \\, x_t \\, (1 - x_t) \\, \\big(y_{B,t} - y_{A,t}\\big),\n$$\nwhich implies a linear relationship between a transformed frequency change and the parasite differential $\\big(y_{B,t} - y_{A,t}\\big)$. This provides a principled route to estimating $s$ from time series using regression.\n\nYour task is to write a complete program that, for each of the specified test cases below, will:\n- Simulate the host–parasite time series $\\{x_t, y_{A,t}\\}_{t=0}^{T-1}$ using the equations above for given parameters $(T, s, \\gamma, x_0, y_{A,0})$.\n- Infer whether cyclic dynamics consistent with the Red Queen hypothesis occur in the simulated data, using only the simulated time series and not the known parameter values.\n- Estimate the selection strength $s$ from the simulated time series using a regression based on the small-selection approximation.\n\nDefinition of “consistent with Red Queen” for this problem:\n- There must be a dominant oscillatory component in $x_t$ at a nonzero frequency. Formalize this by computing the discrete Fourier transform (Discrete Fourier Transform (DFT)) power spectrum of the mean-centered host series over a trailing analysis window, identifying the largest nonzero-frequency peak with period $P$ (in time steps), and requiring that the ratio of this peak’s power to the median power over all nonzero frequencies exceed a threshold $\\rho^\\star$.\n- There must be a host-leads-parasite phase relationship consistent with antagonistic coevolution: compute the cross-correlation between $x_t$ and $y_{A,t}$ over the analysis window as a function of a nonnegative integer lag $\\ell$, and identify the lag $\\ell^\\star \\in \\{1,2,\\dots,\\lfloor P \\rfloor - 1\\}$ that maximizes the correlation between $x_t$ and $y_{A,t+\\ell}$. Compute the phase fraction $\\phi = \\ell^\\star / P$ and require $|\\phi - 1/4| \\le \\delta^\\star$.\n- The regression-based estimate of $s$ must be positive and exceed a minimal detectable value $s^\\star$.\n\nEstimation of $s$:\n- For each $t$ in the analysis window, define the transformed response\n$$\nr_t \\;=\\; \\frac{x_{t+1} - x_t}{x_t \\, (1 - x_t)},\n$$\nand the predictor\n$$\nz_t \\;=\\; y_{B,t} - y_{A,t} \\;=\\; 1 - 2 y_{A,t}.\n$$\nEstimate $s$ by ordinary least squares in the linear model $r_t = s \\, z_t + \\varepsilon_t$, that is\n$$\n\\hat{s} \\;=\\; \\frac{\\sum_t z_t \\, r_t}{\\sum_t z_t^2},\n$$\ncomputed over $t$ in the analysis window for which $x_t \\in [\\epsilon, 1 - \\epsilon]$ with a small $\\epsilon$ to avoid division by values close to $0$.\n\nAnalysis window and thresholds:\n- Use the trailing window consisting of the last $3/4$ of the time series, that is the time indices $t \\in \\{\\lfloor T/4 \\rfloor, \\dots, T-1\\}$.\n- Use the threshold values $\\rho^\\star = 2.0$, $\\delta^\\star = 0.2$, and $s^\\star = 0.05$.\n- Use $\\epsilon = 10^{-6}$ for numerical stability.\n\nTest suite:\n- Case $1$: $(T, s, \\gamma, x_0, y_{A,0}) = (256, 0.6, 0.2, 0.55, 0.45)$.\n- Case $2$: $(T, s, \\gamma, x_0, y_{A,0}) = (256, 0.0, 0.3, 0.52, 0.50)$.\n- Case $3$: $(T, s, \\gamma, x_0, y_{A,0}) = (256, 0.2, 0.25, 0.60, 0.40)$.\n- Case $4$: $(T, s, \\gamma, x_0, y_{A,0}) = (256, 0.5, 0.0, 0.50, 0.50)$.\n\nOutput specification:\n- For each case, output a $2$-element list $[b, \\hat{s}]$ where $b$ is a boolean indicating whether Red Queen-consistent cycles are inferred under the decision rule above, and $\\hat{s}$ is the estimated selection strength rounded to three decimal places (as a numeric float). Aggregate the $4$ case results into a single list in order.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[[True,0.603],[False,0.000],[True,0.198],[False,0.000]]\"). Do not print any other text.\n\nAll quantities are dimensionless; no physical units or angles are involved. The computation must use only the given update equations and analysis rules, without reference to external data.", "solution": "The problem presents a well-defined computational task based on a standard model of host-parasite coevolution under negative frequency-dependent selection, a cornerstone of the Red Queen hypothesis. The problem is scientifically grounded, mathematically complete, and algorithmically specified. It is therefore valid.\n\nThe task is to simulate the coevolutionary dynamics and then analyze the resulting time series to test for signatures of Red Queen dynamics and to estimate the strength of selection, $s$. The solution proceeds in two main stages: simulation and analysis.\n\n**1. Simulation of Host-Parasite Dynamics**\n\nThe system state at any discrete time step $t$ is described by the host genotype frequency $x_t$ (for genotype $A$) and the parasite prevalence $y_{A,t}$ (for the strain adapted to $A$). The initial state $(x_0, y_{A,0})$ is given, along with parameters for the total simulation time $T$, selection strength $s$, and parasite tracking rate $\\gamma$.\n\nThe time series $\\{x_t\\}_{t=0}^{T-1}$ and $\\{y_{A,t}\\}_{t=0}^{T-1}$ are generated iteratively. For each time step $t$ from $0$ to $T-2$, we compute the state at time $t+1$:\n\nFirst, we define the frequency of host genotype $B$ as $1 - x_t$ and the prevalence of the parasite strain adapted to $B$ as $y_{B,t} = 1 - y_{A,t}$.\n\nThe relative fitnesses of the host genotypes are determined by the prevalence of the matching parasite strain, subject to a selection coefficient $s$:\n$$\nw_{A,t} = 1 - s \\cdot y_{A,t}\n$$\n$$\nw_{B,t} = 1 - s \\cdot (1 - y_{A,t})\n$$\n\nThe frequency of host genotype $A$ at the next time step, $x_{t+1}$, is calculated using the discrete-time replicator equation, which describes how genotype frequencies change under selection. The new frequency is the old frequency multiplied by its relative fitness, normalized by the mean fitness of the population $\\bar{w}_t$:\n$$\n\\bar{w}_t = x_t \\, w_{A,t} + (1 - x_t) \\, w_{B,t}\n$$\n$$\nx_{t+1} = \\frac{x_t \\, w_{A,t}}{\\bar{w}_t}\n$$\n\nConcurrently, the parasite prevalence adapts to the host genotype frequencies. The prevalence of the parasite strain adapted to host $A$ at the next time step, $y_{A,t+1}$, is updated according to a linear tracking rule with a lag parameter $\\gamma$:\n$$\ny_{A,t+1} = y_{A,t} + \\gamma \\, (x_t - y_{A,t})\n$$\nThis process is repeated for $T-1$ steps to generate the full time series.\n\n**2. Time Series Analysis**\n\nThe analysis is performed on a trailing window of the simulated data, defined for time indices $t \\in \\{\\lfloor T/4 \\rfloor, \\dots, T-1\\}$. Let $N_w = T - \\lfloor T/4 \\rfloor$ be the length of this analysis window. The inference of Red Queen dynamics is based on three specific criteria.\n\n**Condition 1: Dominant Oscillatory Component**\nThis condition verifies that the host dynamics exhibit sustained oscillations, a hallmark of Red Queen coevolution.\n- The host frequency time series over the analysis window, $x_w = \\{x_t\\}_{t=\\lfloor T/4 \\rfloor}^{T-1}$, is first mean-centered.\n- The power spectrum of this mean-centered series is computed using the real-valued Discrete Fourier Transform (DFT). The power is the squared magnitude of the DFT coefficients.\n- We identify the peak power among all non-zero frequencies. Let the period corresponding to this peak frequency be $P$.\n- The ratio $\\rho$ of this peak power to the median power of all non-zero frequencies is calculated.\n- The condition is met if $\\rho > \\rho^\\star$, where $\\rho^\\star = 2.0$. This ensures the peak is significant and not just a random fluctuation.\n\n**Condition 2: Host-Leads-Parasite Phase Relationship**\nAntagonistic coevolution predicts that changes in the host population should be followed by adaptive changes in the parasite population. This implies a specific phase lag.\n- This condition is checked only if Condition 1 is met and a period $P \\ge 2$ is found.\n- We calculate the Pearson correlation coefficient between the host series $x_t$ and a time-advanced parasite series $y_{A,t+\\ell}$ for integer lags $\\ell$ in the range $\\{1, 2, \\dots, \\lfloor P \\rfloor-1\\}$. For a given $\\ell$, the correlation is computed over the overlapping portion of the analysis window.\n- The lag $\\ell^\\star$ that maximizes this correlation is identified.\n- A phase fraction is calculated as $\\phi = \\ell^\\star / P$. The Red Queen hypothesis predicts a quarter-period lag ($\\phi \\approx 1/4$).\n- The condition is met if $|\\phi - 1/4| \\le \\delta^\\star$, where $\\delta^\\star = 0.2$.\n\n**Condition 3: Positive Selection Estimate**\nThe entire dynamic is predicated on selection being active ($s > 0$). We estimate $s$ from the data and verify it is sufficiently large.\n- The estimation uses the provided small-selection approximation: $x_{t+1} - x_t \\approx s \\, x_t(1-x_t)(y_{B,t} - y_{A,t})$.\n- This can be rearranged into a linear regression model through the origin: $r_t = s \\, z_t$, where the response variable is $r_t = \\frac{x_{t+1} - x_t}{x_t(1 - x_t)}$ and the predictor is $z_t = y_{B,t} - y_{A,t} = 1 - 2y_{A,t}$.\n- The ordinary least squares (OLS) estimate for $s$ is $\\hat{s} = \\frac{\\sum z_t r_t}{\\sum z_t^2}$.\n- The sums are calculated over the analysis window (from $t = \\lfloor T/4 \\rfloor$ to $T-2$), excluding points where $x_t$ is too close to $0$ or $1$ (i.e., $x_t \\notin [\\epsilon, 1-\\epsilon]$ for $\\epsilon = 10^{-6}$) to ensure numerical stability.\n- If the denominator $\\sum z_t^2$ is zero, which implies no variation in the predictor, $\\hat{s}$ is taken to be $0$.\n- The condition is met if $\\hat{s} > s^\\star$, where $s^\\star = 0.05$.\n\nFinally, the dynamics for a given test case are classified as \"consistent with Red Queen\" if and only if all three conditions are satisfied. The program then reports this boolean outcome along with the estimated selection strength $\\hat{s}$, rounded to three decimal places.", "answer": "```python\nimport numpy as np\nfrom scipy import fft\n\ndef solve():\n    \"\"\"\n    Solves the host-parasite coevolution problem for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        (256, 0.6, 0.2, 0.55, 0.45),\n        (256, 0.0, 0.3, 0.52, 0.50),\n        (256, 0.2, 0.25, 0.60, 0.40),\n        (256, 0.5, 0.0, 0.50, 0.50),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = analyze_case(*params)\n        results.append(result)\n\n    # Format the output string as per the specification\n    final_strings = []\n    for res in results:\n        bool_str = str(res[0])\n        # Ensure float is formatted with 3 decimal places\n        float_str = f\"{res[1]:.3f}\"\n        final_strings.append(f\"[{bool_str},{float_str}]\")\n    \n    print(f\"[{','.join(final_strings)}]\")\n\ndef analyze_case(T, s, gamma, x0, yA0):\n    \"\"\"\n    Runs the simulation and analysis for a single test case.\n\n    Args:\n        T (int): Total number of time steps.\n        s (float): Selection strength.\n        gamma (float): Parasite tracking rate.\n        x0 (float): Initial host genotype frequency.\n        yA0 (float): Initial parasite prevalence.\n\n    Returns:\n        list: A list [b, s_hat] where b is a boolean indicating Red Queen\n              consistency and s_hat is the estimated selection strength.\n    \"\"\"\n    # Define thresholds and constants\n    rho_star = 2.0\n    delta_star = 0.2\n    s_star = 0.05\n    epsilon = 1e-6\n\n    # 1. Simulation\n    x = np.zeros(T)\n    yA = np.zeros(T)\n    x[0], yA[0] = x0, yA0\n\n    for t in range(T - 1):\n        yB_t = 1.0 - yA[t]\n        wA_t = 1.0 - s * yA[t]\n        wB_t = 1.0 - s * yB_t\n        \n        mean_fitness = x[t] * wA_t + (1.0 - x[t]) * wB_t\n        \n        if mean_fitness > 0:\n            x[t+1] = (x[t] * wA_t) / mean_fitness\n        else: # Should not happen with given constraints but good practice.\n            x[t+1] = x[t]\n\n        yA[t+1] = yA[t] + gamma * (x[t] - yA[t])\n    \n    # 2. Analysis\n    t_start = T // 4\n    analysis_window_len = T - t_start\n    x_w = x[t_start:]\n    yA_w = yA[t_start:]\n\n    # Condition 1: Oscillation\n    cond1 = False\n    P = 0.0\n    x_w_centered = x_w - np.mean(x_w)\n    \n    power_spectrum = np.abs(fft.rfft(x_w_centered))**2\n    freqs = fft.rfftfreq(analysis_window_len)\n    \n    power_nonzero = power_spectrum[1:]\n    freqs_nonzero = freqs[1:]\n    \n    median_power = np.median(power_nonzero) if len(power_nonzero) > 0 else 0.0\n\n    if median_power > 1e-9: # Use a small tolerance instead of zero\n        peak_power_idx_nz = np.argmax(power_nonzero)\n        peak_power = power_nonzero[peak_power_idx_nz]\n        rho = peak_power / median_power\n        if rho > rho_star:\n            cond1 = True\n            peak_freq = freqs_nonzero[peak_power_idx_nz]\n            if peak_freq > 0:\n                P = 1.0 / peak_freq\n    \n    # Condition 2: Phase\n    cond2 = False\n    if cond1 and P >= 2.0:\n        lag_max = int(np.floor(P)) - 1\n        lags = range(1, lag_max + 1)\n        if lags:\n            corrs = []\n            for l in lags:\n                # Correlate x_w(t) with yA_w(t+l)\n                # Slices must be of length > 1 to compute correlation\n                if len(x_w) - l > 1:\n                    corr_matrix = np.corrcoef(x_w[:-l], yA_w[l:])\n                    corrs.append(corr_matrix[0, 1])\n            \n            if corrs:\n                best_lag_idx = np.argmax(corrs)\n                l_star = lags[best_lag_idx]\n                phi = l_star / P\n                if abs(phi - 0.25) <= delta_star:\n                    cond2 = True\n\n    # Condition 3: Selection estimate\n    sum_zr = 0.0\n    sum_z_sq = 0.0\n    \n    for t in range(t_start, T - 1):\n        if epsilon <= x[t] <= 1.0 - epsilon:\n            r_t = (x[t+1] - x[t]) / (x[t] * (1.0 - x[t]))\n            z_t = 1.0 - 2.0 * yA[t]\n            sum_zr += z_t * r_t\n            sum_z_sq += z_t**2\n\n    s_hat = 0.0\n    if sum_z_sq > 1e-9: # Use a small tolerance\n        s_hat = sum_zr / sum_z_sq\n    \n    cond3 = s_hat > s_star\n        \n    is_red_queen = cond1 and cond2 and cond3\n    \n    return [is_red_queen, s_hat]\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2547486"}]}