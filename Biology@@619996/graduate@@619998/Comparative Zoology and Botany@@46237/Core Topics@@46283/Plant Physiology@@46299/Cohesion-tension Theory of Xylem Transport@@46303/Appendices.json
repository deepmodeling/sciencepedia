{"hands_on_practices": [{"introduction": "The journey of water to the top of a tall tree begins with a fundamental challenge: gravity. Before any water can be lost to transpiration, the plant must support the weight of the water column in its xylem, creating a baseline tension that must be overcome. This exercise [@problem_id:2555396] provides a hands-on way to quantify that gravitational cost, translating tree height directly into a pressure value using the principles of hydrostatic equilibrium. By calculating the gravitational component of water potential, $\\Psi_g$, you will gain a tangible appreciation for the magnitude of the forces involved and set the stage for understanding the much larger tensions generated by transpiration.", "problem": "A central prediction of the cohesion–tension theory is that water ascends in the xylem under negative pressure (tension), and that the gravitational component of water potential increases with elevation, thereby imposing an added pressure difference that must be balanced by tension generated by transpiration. Consider a straight, water-filled xylem pathway from the soil surface at the base of a tree to leaves at height $H = 35$ m. Assume the water column is static with respect to vertical acceleration (quasi-steady), the fluid is incompressible, and temperature effects on density are negligible. Starting from hydrostatic equilibrium $\\frac{dP}{dz} = -\\rho g$ and the definition of water potential as energy per unit volume (with units of pressure), derive the gravitational contribution to the water potential difference between base and leaves as a function of elevation difference. Then compute its magnitude for $H = 35$ m using $\\rho = 1.00 \\times 10^{3}$ kg m$^{-3}$ and $g = 9.81$ m s$^{-2}$, and express the final numerical result in megapascal (MPa). Round your numerical result to four significant figures.\n\nFinally, interpret the magnitude you obtain relative to measured midday leaf water potentials in well-watered temperate trees (approximately $-1.0$ to $-2.5$ MPa) and in arid-adapted shrubs (approximately $-3.0$ to $-6.0$ MPa), explaining the relative contribution of gravity to the total tension required by the cohesion–tension mechanism. Your final reported answer must be only the computed numerical value in MPa.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on the established principles of fluid statics and the cohesion-tension theory of water transport in plants. All necessary constants and conditions are provided, and no contradictions exist. The problem is therefore valid for solution.\n\nWe begin by formalizing the concept of water potential, $\\Psi$, which is defined as the potential energy of water per unit volume. For the purpose of this problem, we consider the two most relevant components: the pressure potential, $\\Psi_p$, which is equivalent to the hydrostatic pressure $P$, and the gravitational potential, $\\Psi_g$. The total water potential at an elevation $z$ is thus given by the sum:\n$$ \\Psi(z) = \\Psi_p(z) + \\Psi_g(z) $$\nThe gravitational potential energy of a mass $m$ of water at height $z$ is $U_g = mgz$. The corresponding potential per unit volume $V$ is $\\frac{U_g}{V} = \\frac{m}{V} g z$. Recognizing that density $\\rho = \\frac{m}{V}$, the gravitational potential in units of pressure is:\n$$ \\Psi_g(z) = \\rho g z $$\nwhere $g$ is the acceleration due to gravity.\n\nThe problem states that the water column is in hydrostatic equilibrium, which is described by the differential equation:\n$$ \\frac{dP}{dz} = -\\rho g $$\nThis equation indicates that hydrostatic pressure $P$ decreases linearly with increasing height $z$.\n\nThe first task is to derive the gravitational contribution to the water potential difference between the base of the tree (let's define as $z_1 = 0$) and the leaves at height $H$ (at $z_2 = H = 35$ m). This contribution is simply the difference in the gravitational potential term, $\\Delta\\Psi_g$, between these two elevations.\n$$ \\Delta\\Psi_g = \\Psi_g(z_2) - \\Psi_g(z_1) $$\nSubstituting the expression for $\\Psi_g(z)$, we have:\n$$ \\Delta\\Psi_g = \\rho g z_2 - \\rho g z_1 = \\rho g H - \\rho g (0) = \\rho g H $$\nThis is the analytical expression for the gravitational contribution to the water potential difference. It represents the potential energy per unit volume required to lift the water to height $H$ against gravity.\n\nNext, we compute the numerical magnitude of this contribution using the provided values: water density $\\rho = 1.00 \\times 10^{3}$ kg m$^{-3}$, gravitational acceleration $g = 9.81$ m s$^{-2}$, and height $H = 35$ m.\n$$ \\Delta\\Psi_g = (1.00 \\times 10^{3} \\, \\text{kg m}^{-3}) \\times (9.81 \\, \\text{m s}^{-2}) \\times (35 \\, \\text{m}) $$\nThe calculation yields:\n$$ \\Delta\\Psi_g = 343350 \\, \\text{kg m}^{-1} \\text{s}^{-2} $$\nThe unit kg m$^{-1}$ s$^{-2}$ is equivalent to the Pascal (Pa), the standard unit of pressure.\n$$ \\Delta\\Psi_g = 343350 \\, \\text{Pa} $$\nTo express this result in megapascals (MPa), we use the conversion $1$ MPa $= 10^6$ Pa.\n$$ \\Delta\\Psi_g = \\frac{343350}{10^6} \\, \\text{MPa} = 0.343350 \\, \\text{MPa} $$\nThe problem requires rounding this numerical result to four significant figures. The fifth significant figure is a $5$, so we round the fourth digit up.\n$$ \\Delta\\Psi_g \\approx 0.3434 \\, \\text{MPa} $$\n\nFinally, we interpret this magnitude. The value $\\Delta\\Psi_g \\approx +0.3434$ MPa represents the \"cost\" of lifting water against gravity to a height of $35$ m. Within the framework of the cohesion-tension theory, the total water potential generally decreases from soil to leaf to drive water flow. The total leaf water potential, $\\Psi_{\\text{leaf}}$, is the sum of its components: $\\Psi_{\\text{leaf}} = \\Psi_{p, \\text{leaf}} + \\Psi_{g, \\text{leaf}}$. The gravitational component at the leaf is $\\Psi_{g, \\text{leaf}} = \\rho g H = +0.3434$ MPa. The pressure component, $\\Psi_{p, \\text{leaf}}$, is the tension, which is negative.\nFor a well-watered temperate tree with a typical midday $\\Psi_{\\text{leaf}}$ of approximately $-1.5$ MPa, the tension required is:\n$$ \\Psi_{p, \\text{leaf}} = \\Psi_{\\text{leaf}} - \\Psi_{g, \\text{leaf}} \\approx -1.5 \\, \\text{MPa} - 0.3434 \\, \\text{MPa} \\approx -1.84 \\, \\text{MPa} $$\nIn this case, the gravitational potential constitutes a significant portion of the total water potential budget. The tension must be sufficiently negative to overcome both the gravitational potential and other factors like the water potential of the soil and frictional resistances. For arid-adapted shrubs, which generate much lower leaf water potentials (e.g., $-4.5$ MPa) to extract water from dry soil, the required tension would be $\\Psi_{p, \\text{leaf}} \\approx -4.5 \\, \\text{MPa} - 0.3434 \\, \\text{MPa} \\approx -4.84 \\, \\text{MPa}$. Although the relative contribution of gravity is smaller in such cases, it remains an ineluctable physical barrier that must be surmounted by the tension generated via transpiration. Therefore, our calculated value of $0.3434$ MPa quantifies a fundamental constraint imposed by gravity on the height of vascular plants.", "answer": "$$\\boxed{0.3434}$$", "id": "2555396"}, {"introduction": "Sustaining the immense negative pressures required to lift water is a remarkable feat of natural engineering, as the water column is metastable and vulnerable to \"air-seeding,\" where gas enters the conduit and breaks the chain, causing an embolism. This practice [@problem_id:2555348] dives into the microscopic world of pit membranes, the critical structures that prevent such catastrophic failures. By applying the Young-Laplace equation, derived from the physics of surface tension, you will calculate the impressive pressure barrier a single nanoscale pore can provide, revealing how plants safely manage life under extreme tension.", "problem": "In the cohesion–tension framework for xylem transport, air seeding into a water-filled conduit is opposed by the capillary pressure across the air–water interface (meniscus) spanning nanoscale pores in pit membranes. Consider a single cylindrical pore of radius $r$ that opens between an embolized (gas) conduit and an adjacent water-filled conduit. The air–water surface tension is $\\gamma$ at temperature $T$, and the static contact angle (measured through the liquid) at the hydrophilic pit membrane is $\\theta$. Under quasi-static conditions, the meniscus adopts a shape of constant mean curvature and pins at the pore rim.\n\nStarting from interfacial thermodynamics and mechanical equilibrium of a curved interface, namely from the differential balance between pressure–volume work and surface free energy for a virtual displacement of the meniscus, derive an expression for the pressure difference across the interface (gas minus liquid), $\\Delta P$, in terms of $\\gamma$, $r$, and $\\theta$, using only the geometry of a spherical cap in a circular pore. Then, using $r=50 \\text{ nm}$, $\\gamma=0.072 \\text{ N m}^{-1}$, and $\\theta=0^{\\circ}$, evaluate the magnitude of $\\Delta P$.\n\nExpress your final answer in megapascals and round to two significant figures.", "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. We will proceed to derive the expression for the pressure difference across the interface and then evaluate its magnitude.\n\nThe problem requires a derivation from the principle of virtual work, relating the pressure-volume work to the change in interfacial free energy. We consider a system composed of a gas phase and a liquid (water) phase, separated by an interface forming a meniscus within a cylindrical pore of radius $r$. The meniscus is a spherical cap. The contact line of the three phases (gas, liquid, solid) is pinned at the pore rim, a circle of radius $r$. The contact angle, $\\theta$, is defined at this contact line. $\\Delta P$ is the pressure difference $P_{\\text{gas}} - P_{\\text{liquid}}$.\n\nLet us consider a virtual displacement of the liquid-gas interface. The most convenient virtual displacement for this problem is an infinitesimal translation $dz$ of the fluid along the axis of the cylindrical pore. This displacement causes the three-phase contact line to move along the solid wall of the pore.\n\nThe first law of thermodynamics for a system at constant temperature, undergoing a reversible process, can be expressed in terms of the Helmholtz free energy, $F = U - TS$. The differential change is $dF = -P dV + \\sum_i \\gamma_i dA_i$, where the second term represents the change in surface free energy. For a multi-phase system in mechanical equilibrium, the total change in Helmholtz free energy for a virtual displacement must be zero, $dF_{\\text{total}} = 0$.\n\nThe total free energy of our system is the sum of the bulk and interfacial energies:\n$F_{\\text{total}} = F_{\\text{liquid}} + F_{\\text{gas}} + F_{\\text{interface}}$\nFor a virtual displacement, the change is:\n$dF_{\\text{total}} = dF_{\\text{liquid}} + dF_{\\text{gas}} + dF_{\\text{interface}} = 0$\n\nThe work terms for the bulk phases are $dF_{\\text{liquid}} = -P_{\\text{liquid}} dV_{\\text{liquid}}$ and $dF_{\\text{gas}} = -P_{\\text{gas}} dV_{\\text{gas}}$. In our virtual displacement $dz$, the volume of the liquid increases by $dV_{\\text{liquid}} = \\pi r^2 dz$, and the volume of the gas decreases by the same amount, so $dV_{\\text{gas}} = -\\pi r^2 dz$.\nThe total change in the bulk free energy is:\n$dF_{\\text{bulk}} = -P_{\\text{liquid}}(\\pi r^2 dz) - P_{\\text{gas}}(-\\pi r^2 dz) = (P_{\\text{gas}} - P_{\\text{liquid}})\\pi r^2 dz = \\Delta P \\pi r^2 dz$.\n\nThe interfacial free energy has three components, corresponding to the solid-gas, solid-liquid, and liquid-gas interfaces. Let their respective surface tensions be $\\gamma_{sg}$, $\\gamma_{sl}$, and $\\gamma_{lg}$ (denoted as $\\gamma$ in the problem).\n$F_{\\text{interface}} = \\gamma_{sg} A_{sg} + \\gamma_{sl} A_{sl} + \\gamma A_{lg}$.\nDuring the displacement $dz$, the liquid-gas interface of area $A_{lg}$ is translated, so its area does not change to first order, $dA_{lg}=0$. However, the area of the solid-liquid interface increases as it advances along the pore wall: $dA_{sl} = 2\\pi r dz$. Correspondingly, the area of the solid-gas interface decreases: $dA_{sg} = -2\\pi r dz$.\nThe change in interfacial free energy is:\n$dF_{\\text{interface}} = \\gamma_{sg} (-2\\pi r dz) + \\gamma_{sl} (2\\pi r dz) = (\\gamma_{sl} - \\gamma_{sg}) 2\\pi r dz$.\n\nAt equilibrium, the total free energy change is zero:\n$dF_{\\text{total}} = \\Delta P \\pi r^2 dz + (\\gamma_{sl} - \\gamma_{sg}) 2\\pi r dz = 0$.\n$\\Delta P \\pi r^2 = -(\\gamma_{sl} - \\gamma_{sg}) 2\\pi r = (\\gamma_{sg} - \\gamma_{sl}) 2\\pi r$.\n\nThe term $(\\gamma_{sg} - \\gamma_{sl})$ is related to the liquid-gas surface tension $\\gamma$ and the contact angle $\\theta$ by the Young-Dupré equation for the equilibrium contact line:\n$\\gamma_{sg} = \\gamma_{sl} + \\gamma \\cos\\theta$.\nTherefore, $\\gamma_{sg} - \\gamma_{sl} = \\gamma \\cos\\theta$.\n\nSubstituting this into our equilibrium condition gives:\n$\\Delta P \\pi r^2 = (\\gamma \\cos\\theta) 2\\pi r$.\n\nSolving for $\\Delta P = P_{\\text{gas}} - P_{\\text{liquid}}$, we obtain the desired expression:\n$$\n\\Delta P = \\frac{2\\gamma \\cos\\theta}{r}\n$$\nThis is the required expression, which is a specific form of the Young-Laplace equation for a spherical meniscus in a cylindrical capillary.\n\nNow, we evaluate the magnitude of $\\Delta P$ using the given values:\nPore radius, $r = 50 \\ \\text{nm} = 50 \\times 10^{-9} \\ \\text{m}$.\nAir-water surface tension, $\\gamma = 0.072 \\ \\text{N m}^{-1}$.\nContact angle, $\\theta = 0^\\circ$.\n\nSubstituting these values into the derived formula:\n$\\Delta P = \\frac{2 \\times (0.072 \\ \\text{N m}^{-1}) \\times \\cos(0^\\circ)}{50 \\times 10^{-9} \\ \\text{m}}$.\nSince $\\cos(0^\\circ) = 1$:\n$\\Delta P = \\frac{2 \\times 0.072}{50 \\times 10^{-9}} \\ \\frac{\\text{N}}{\\text{m}^2}$.\nThe unit $\\text{N m}^{-2}$ is equivalent to the Pascal ($\\text{Pa}$).\n$\\Delta P = \\frac{0.144}{50 \\times 10^{-9}} \\ \\text{Pa} = \\frac{0.144}{5 \\times 10^{-8}} \\ \\text{Pa} = 0.0288 \\times 10^8 \\ \\text{Pa} = 2.88 \\times 10^6 \\ \\text{Pa}$.\n\nThe problem requires the answer to be expressed in megapascals ($\\text{MPa}$), where $1 \\ \\text{MPa} = 10^6 \\ \\text{Pa}$.\n$\\Delta P = 2.88 \\ \\text{MPa}$.\n\nFinally, we must round the result to two significant figures.\n$\\Delta P \\approx 2.9 \\ \\text{MPa}$.\n\nThis positive pressure difference represents the pressure that must be applied to the gas phase relative to the liquid phase to force air through the pore, a phenomenon known as air seeding. It is also equal to the magnitude of the tension (negative pressure) that the water column can sustain before cavitation occurs via air seeding from an adjacent gas-filled conduit.", "answer": "$$\\boxed{2.9}$$", "id": "2555348"}, {"introduction": "Our understanding of plant water transport culminates in the ability to build predictive models that link physiology to the environment. This final, integrative practice [@problem_id:2555401] challenges you to construct a mechanistic model of the entire Soil-Plant-Atmosphere Continuum (SPAC). You will combine hydraulic principles, including the temperature-dependent viscosity of water and xylem vulnerability to embolism, with a model of atmospheric demand. This exercise simulates the dynamic balance between what the atmosphere demands and what the plant's hydraulic system can supply, providing a powerful demonstration of how physiology and physics together determine a plant's real-world performance.", "problem": "Construct a minimal mechanistic model of transpiration-driven xylem flow grounded in the cohesion-tension framework. Your model must combine gas-phase diffusion from the leaf to atmosphere and liquid-phase flow through the plant hydraulic pathway, while accounting for xylem vulnerability to tension. The model must predict the realized steady-state mass flow rate of water through the plant, expressed as a molar rate of water loss. You must implement a program that computes this predicted realized flow for a small test suite of cases specified below. The program must use the following principles and design constraints.\n\nFundamental base and model assumptions:\n- Gas-phase diffusion (leaf-to-air): By Fickian diffusion in dilute gas under quasi-steady conditions, the molar transpiration rate $E_{\\text{mol}}$ (in $\\mathrm{mol \\ s^{-1}}$) from a leaf of area $A_{\\ell}$ with stomatal conductance to water vapor $g_{\\mathrm{sw}}$ (in $\\mathrm{mol \\ m^{-2} \\ s^{-1}}$) is proportional to the vapor mole fraction difference, which for a prescribed Vapor Pressure Deficit (VPD) can be approximated by the ratio $\\Delta c \\approx D / P_{\\text{atm}}$, where $D$ is the Vapor Pressure Deficit and $P_{\\text{atm}}$ is atmospheric pressure. Thus, \n  $$E_{\\text{mol}} = g_{\\mathrm{sw}} \\, A_{\\ell} \\, \\frac{D}{P_{\\text{atm}}}.$$\n  Here $D$ must be converted to Pascals if provided in kilopascals, with $1 \\ \\mathrm{kPa} = 1000 \\ \\mathrm{Pa}$. The atmospheric pressure is taken as $P_{\\text{atm}} = 101325 \\ \\mathrm{Pa}$.\n- Continuity (liquid-gas equivalence of flux): The mass flow rate $F$ (in $\\mathrm{kg \\ s^{-1}}$) through the xylem equals the molar transpiration rate multiplied by the molar mass of water $M_{\\mathrm{w}}$, with $M_{\\mathrm{w}} = 0.01801528 \\ \\mathrm{kg \\ mol^{-1}}$. Hence,\n  $$F_{\\text{demand}} = M_{\\mathrm{w}} \\, E_{\\text{mol}}.$$\n- Liquid-phase flow (xylem hydraulics): Under steady conditions, Darcy’s law (Ohm’s law analogy) gives\n  $$F = K_{\\text{tot}}(\\psi_{\\ell}, T)\\, \\bigl(\\psi_{\\text{soil}} - \\psi_{\\ell}\\bigr),$$\n  where $K_{\\text{tot}}$ is the total hydraulic conductance (in $\\mathrm{kg \\ s^{-1} \\ MPa^{-1}}$), $\\psi_{\\text{soil}}$ is the soil water potential (in $\\mathrm{MPa}$), and $\\psi_{\\ell}$ is the leaf water potential (in $\\mathrm{MPa}$). The total conductance is the series combination of a root pathway with reference conductance $K_{\\text{root,ref}}$ and a stem pathway with maximum reference conductance $K_{\\text{stem,max,ref}}$ reduced by a vulnerability function. For series elements,\n  $$K_{\\text{tot}}^{-1} = K_{\\text{root}}^{-1} + K_{\\text{stem}}^{-1},$$\n  with temperature-adjusted conductances\n  $$K_{\\text{root}}(T) = K_{\\text{root,ref}} \\, \\frac{\\mu(T_{\\text{ref}})}{\\mu(T)}, \\quad K_{\\text{stem,max}}(T) = K_{\\text{stem,max,ref}} \\, \\frac{\\mu(T_{\\text{ref}})}{\\mu(T)},$$\n  where $\\mu(T)$ is the dynamic viscosity of water (in $\\mathrm{Pa \\ s}$) and $T_{\\text{ref}} = 298.15 \\ \\mathrm{K}$ (that is, $25 \\ ^{\\circ}\\mathrm{C}$). Use the empirical relation\n  $$\\mu(T) = A \\, 10^{\\frac{B}{T - C}}, \\quad A = 2.414 \\times 10^{-5} \\ \\mathrm{Pa \\ s}, \\ B = 247.8 \\ \\mathrm{K}, \\ C = 140 \\ \\mathrm{K},$$\n  with $T$ in Kelvin. The xylem vulnerability to tension is represented by a logistic function for relative conductivity\n  $$k_{\\text{rel}}(\\psi) = \\frac{1}{1 + \\exp\\bigl(-S\\,(\\psi - P_{50})\\bigr)},$$\n  where $P_{50}$ (in $\\mathrm{MPa}$) is the water potential at $50\\%$ loss of conductivity and $S$ (in $\\mathrm{MPa^{-1}}$) is the slope. The stem conductance at leaf potential $\\psi_{\\ell}$ is\n  $$K_{\\text{stem}}(\\psi_{\\ell}, T) = K_{\\text{stem,max}}(T) \\, k_{\\text{rel}}(\\psi_{\\ell}).$$\n- Realized steady state: Define the hydraulic supply function\n  $$H(\\psi_{\\ell}; T) = K_{\\text{tot}}(\\psi_{\\ell}, T)\\, \\bigl(\\psi_{\\text{soil}} - \\psi_{\\ell}\\bigr), \\quad \\psi_{\\ell} \\le \\psi_{\\text{soil}}.$$\n  The realized steady-state flow is determined as follows.\n  1. Compute $F_{\\text{demand}}$ from gas diffusion and continuity.\n  2. Compute the maximum hydraulic supply $H_{\\max}(T) = \\max_{\\psi_{\\ell} \\in [\\psi_{\\min}, \\psi_{\\text{soil}}]} H(\\psi_{\\ell}; T)$ over a prescribed potential window $[\\psi_{\\min}, \\psi_{\\text{soil}}]$ with $\\psi_{\\min} = -10 \\ \\mathrm{MPa}$.\n  3. If $F_{\\text{demand}} \\le H_{\\max}(T)$, then there exists at least one $\\psi_{\\ell}^{\\star}$ such that $H(\\psi_{\\ell}^{\\star}; T) = F_{\\text{demand}}$. Select the solution with the smallest tension magnitude (that is, the solution closest to $\\psi_{\\text{soil}}$), and set $F_{\\text{real}} = F_{\\text{demand}}$.\n  4. If $F_{\\text{demand}} > H_{\\max}(T)$, the plant is hydraulically supply-limited; set $F_{\\text{real}} = H_{\\max}(T)$ at the maximizing $\\psi_{\\ell}$.\n\nNumerical and algorithmic requirements:\n- Temperature $T$ must be provided in degrees Celsius and converted to Kelvin by $T[\\mathrm{K}] = T[^{\\circ}\\mathrm{C}] + 273.15$.\n- Use $P_{\\text{atm}} = 101325 \\ \\mathrm{Pa}$, and $M_{\\mathrm{w}} = 0.01801528 \\ \\mathrm{kg \\ mol^{-1}}$.\n- For the hydraulic search, evaluate $H(\\psi_{\\ell}; T)$ on a uniform grid of at least $10001$ points spanning $[\\psi_{\\min}, \\psi_{\\text{soil}}]$ to locate $H_{\\max}$ and to bracket the near-soil solution when $F_{\\text{demand}} \\le H_{\\max}(T)$. Use linear interpolation between adjacent grid points to refine $\\psi_{\\ell}^{\\star}$ if needed.\n\nOutput specification:\n- For each test case, report the realized molar flow rate of water $E_{\\text{real}}$ in $\\mathrm{mmol \\ s^{-1}}$, where $E_{\\text{real}} = 1000 \\, F_{\\text{real}} / M_{\\mathrm{w}}$.\n- Express each result as a floating-point number rounded to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[x1,x2,x3]\").\n\nTest suite:\nImplement your program to compute the outputs for the following five test cases. Each tuple lists ($D_{\\mathrm{kPa}}$, $T_{^{\\circ}\\mathrm{C}}$, $A_{\\ell}$, $g_{\\mathrm{sw}}$, $\\psi_{\\text{soil}}$, $K_{\\text{root,ref}}$, $K_{\\text{stem,max,ref}}$, $P_{50}$, $S$) in that order, with units ($\\mathrm{kPa}, ^{\\circ}\\mathrm{C}, \\mathrm{m^{2}}, \\mathrm{mol \\ m^{-2} \\ s^{-1}}, \\mathrm{MPa}, \\mathrm{kg \\ s^{-1} \\ MPa^{-1}}, \\mathrm{kg \\ s^{-1} \\ MPa^{-1}}, \\mathrm{MPa}, \\mathrm{MPa^{-1}})$.\n- Case $1$ (moderate demand, well hydrated, high conductance): $(1.5, 25.0, 1.5, 0.2, -0.2, 0.0012, 0.0013, -2.0, 3.0)$.\n- Case $2$ (high demand, dry soil, low conductance; supply-limited expected): $(4.0, 25.0, 1.5, 0.2, -0.8, 0.00012, 0.00012, -1.5, 4.0)$.\n- Case $3$ (zero demand boundary): $(0.0, 30.0, 2.0, 0.3, -0.5, 0.0005, 0.0010, -2.0, 3.0)$.\n- Case $4$ (temperature effect on viscosity relative to Case $2$): $(4.0, 45.0, 1.5, 0.2, -0.8, 0.00012, 0.00012, -1.5, 4.0)$.\n- Case $5$ (very dry soil near vulnerability threshold): $(1.0, 25.0, 1.0, 0.15, -2.0, 0.0005, 0.0008, -1.8, 5.0)$.\n\nProgramming task:\n- Implement the model exactly as specified.\n- Hard-code the test suite in the program and compute the realized molar flow rates in $\\mathrm{mmol \\ s^{-1}}$, rounded to six decimal places.\n- Produce a single-line output with the five results in the required list format.", "solution": "The problem as stated is scientifically grounded, well-posed, and provides a complete set of parameters and a clear algorithmic procedure. It represents a valid, albeit simplified, mechanistic model of plant water transport based on the established cohesion-tension theory. There are no contradictions, ambiguities, or factual errors. Therefore, we may proceed with the derivation and implementation of the solution.\n\nThe core of the problem is to determine the steady-state water flow through a plant by finding the intersection of atmospheric demand and hydraulic supply. The system is governed by the leaf water potential, $\\psi_{\\ell}$, which couples the liquid and vapor phases of transport. The realized flow, $F_{\\text{real}}$, is the lesser of the atmospherically determined demand, $F_{\\text{demand}}$, and the maximum possible flow the plant's hydraulic system can supply, $H_{\\max}$.\n\nThe solution is constructed step-by-step as follows:\n\nFirst, we calculate the atmospheric evaporative demand. The molar transpiration rate, $E_{\\text{mol}}$, is given by a Fickian diffusion model:\n$$E_{\\text{mol}} = g_{\\mathrm{sw}} \\, A_{\\ell} \\, \\frac{D}{P_{\\text{atm}}}$$\nwhere $g_{\\mathrm{sw}}$ is the stomatal conductance, $A_{\\ell}$ is the leaf area, $D$ is the vapor pressure deficit, and $P_{\\text{atm}}$ is the atmospheric pressure. Note that $D$ must be converted from $\\mathrm{kPa}$ to $\\mathrm{Pa}$ by multiplying by $1000$. The atmospheric pressure is taken as a constant, $P_{\\text{atm}} = 101325 \\ \\mathrm{Pa}$.\nBy the principle of mass continuity, the mass flow rate demanded by the atmosphere, $F_{\\text{demand}}$, must equal the molar rate multiplied by the molar mass of water, $M_{\\mathrm{w}} = 0.01801528 \\ \\mathrm{kg \\ mol^{-1}}$:\n$$F_{\\text{demand}} = M_{\\mathrm{w}} \\, E_{\\text{mol}}$$\n\nSecond, we define the hydraulic supply function, $H(\\psi_{\\ell}; T)$. This function describes the maximum water flow rate the plant can sustain for a given leaf water potential, $\\psi_{\\ell}$, at temperature $T$. It is based on a Darcy-type law, analogous to Ohm's law:\n$$H(\\psi_{\\ell}; T) = K_{\\text{tot}}(\\psi_{\\ell}, T) \\, (\\psi_{\\text{soil}} - \\psi_{\\ell})$$\nThe driving force is the water potential difference between the soil, $\\psi_{\\text{soil}}$, and the leaf, $\\psi_{\\ell}$. The total hydraulic conductance, $K_{\\text{tot}}$, is itself a function of $\\psi_{\\ell}$ and temperature $T$. The plant hydraulic pathway is modeled as two conductances in series: the root conductance, $K_{\\text{root}}$, and the stem conductance, $K_{\\text{stem}}$. Thus, the total conductance is given by:\n$$K_{\\text{tot}}^{-1} = K_{\\text{root}}^{-1} + K_{\\text{stem}}^{-1} \\quad \\implies \\quad K_{\\text{tot}} = \\frac{K_{\\text{root}} \\, K_{\\text{stem}}}{K_{\\text{root}} + K_{\\text{stem}}}$$\nThe conductances are corrected for the temperature-dependent viscosity of water, $\\mu(T)$. The empirical formula for viscosity is:\n$$\\mu(T) = A \\cdot 10^{\\frac{B}{T - C}}$$\nwith constants $A = 2.414 \\times 10^{-5} \\ \\mathrm{Pa \\ s}$, $B = 247.8 \\ \\mathrm{K}$, and $C = 140 \\ \\mathrm{K}$. Temperatures must be in Kelvin ($T[\\mathrm{K}] = T[^{\\circ}\\mathrm{C}] + 273.15$). The conductances are adjusted relative to their reference values at $T_{\\text{ref}} = 298.15 \\ \\mathrm{K}$:\n$$K_{\\text{root}}(T) = K_{\\text{root,ref}} \\, \\frac{\\mu(T_{\\text{ref}})}{\\mu(T)}$$\n$$K_{\\text{stem,max}}(T) = K_{\\text{stem,max,ref}} \\, \\frac{\\mu(T_{\\text{ref}})}{\\mu(T)}$$\nThe critical feature of the model is xylem vulnerability to embolism, where conductance is lost under high tension (negative water potential). This is incorporated into the stem conductance via a relative conductivity function, $k_{\\text{rel}}(\\psi_{\\ell})$:\n$$K_{\\text{stem}}(\\psi_{\\ell}, T) = K_{\\text{stem,max}}(T) \\, k_{\\text{rel}}(\\psi_{\\ell})$$\nThe function $k_{\\text{rel}}$ is a logistic curve:\n$$k_{\\text{rel}}(\\psi_{\\ell}) = \\frac{1}{1 + \\exp\\bigl(-S\\,(\\psi_{\\ell} - P_{50})\\bigr)}$$\nwhere $P_{50}$ is the potential at $50\\%$ loss of conductivity and $S$ controls the steepness of the vulnerability curve. The root conductance is assumed to be invulnerable in this model.\n\nThird, we find the maximum possible hydraulic supply, $H_{\\max}(T)$. The supply function $H(\\psi_{\\ell}; T)$ typically has a single maximum. At $\\psi_{\\ell} = \\psi_{\\text{soil}}$, the flow is zero. As $\\psi_{\\ell}$ becomes more negative, the driving force $(\\psi_{\\text{soil}} - \\psi_{\\ell})$ increases, raising the flow. However, as $\\psi_{\\ell}$ drops further, $k_{\\text{rel}}(\\psi_{\\ell})$ decreases due to embolism, which in turn reduces $K_{\\text{tot}}$ and eventually causes the flow $H$ to decrease. We must find the maximum of this function, $H_{\\max}(T)$, by evaluating $H(\\psi_{\\ell}; T)$ over a specified range of leaf potentials, from $\\psi_{\\min} = -10 \\ \\mathrm{MPa}$ to $\\psi_{\\text{soil}}$. This is accomplished numerically by discretizing the interval $[\\psi_{\\min}, \\psi_{\\text{soil}}]$ into a fine grid of at least $10001$ points and finding the maximum value of $H$ on this grid.\n\nFourth, we determine the realized steady-state mass flow, $F_{\\text{real}}$.\n- If the atmospheric demand is greater than the plant's maximum capacity ($F_{\\text{demand}} > H_{\\max}$), the flow is supply-limited. The plant cannot meet the demand, and the realized flow is constrained to the maximum possible rate: $F_{\\text{real}} = H_{\\max}$.\n- If the atmospheric demand is less than or equal to the maximum capacity ($F_{\\text{demand}} \\le H_{\\max}$), the plant can sustain the required flow. The system equilibrates at a leaf water potential $\\psi_{\\ell}^{\\star}$ where supply equals demand. The realized flow is thus determined by the atmosphere: $F_{\\text{real}} = F_{\\text{demand}}$.\n\nFinally, the realized mass flow rate, $F_{\\text{real}}$ (in $\\mathrm{kg \\ s^{-1}}$), is converted to the required output format: a molar flow rate, $E_{\\text{real}}$, in units of millimoles per second ($\\mathrm{mmol \\ s^{-1}}$).\n$$E_{\\text{real}} = \\frac{F_{\\text{real}}}{M_{\\mathrm{w}}} \\times 1000$$\nThe program will implement this logic for each of the five test cases provided, rounding the final result to six decimal places.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    It computes the realized molar flow rate for each case and prints the results\n    in the specified format.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (D_kPa, T_C, A_l, g_sw, psi_soil, K_root_ref, K_stem_max_ref, P50, S)\n    # Units: (kPa, °C, m^2, mol m^-2 s^-1, MPa, kg s^-1 MPa^-1, kg s^-1 MPa^-1, MPa, MPa^-1)\n    test_cases = [\n        (1.5, 25.0, 1.5, 0.2, -0.2, 0.0012, 0.0013, -2.0, 3.0),\n        (4.0, 25.0, 1.5, 0.2, -0.8, 0.00012, 0.00012, -1.5, 4.0),\n        (0.0, 30.0, 2.0, 0.3, -0.5, 0.0005, 0.0010, -2.0, 3.0),\n        (4.0, 45.0, 1.5, 0.2, -0.8, 0.00012, 0.00012, -1.5, 4.0),\n        (1.0, 25.0, 1.0, 0.15, -2.0, 0.0005, 0.0008, -1.8, 5.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        realized_flow = calculate_realized_flow(case)\n        results.append(f\"{realized_flow:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_realized_flow(params):\n    \"\"\"\n    Computes the realized steady-state molar flow rate of water for a single set of parameters.\n    \"\"\"\n    # Unpack parameters\n    D_kPa, T_C, A_l, g_sw, psi_soil, K_root_ref, K_stem_max_ref, P50, S = params\n\n    # --- Constants ---\n    P_ATM = 101325.0         # Atmospheric pressure (Pa)\n    M_W = 0.01801528         # Molar mass of water (kg/mol)\n    T_REF = 298.15           # Reference temperature (K)\n    VISC_A = 2.414e-5        # Viscosity parameter A (Pa s)\n    VISC_B = 247.8           # Viscosity parameter B (K)\n    VISC_C = 140.0           # Viscosity parameter C (K)\n    PSI_MIN = -10.0          # Minimum leaf water potential for search (MPa)\n    N_POINTS = 10001         # Number of grid points for hydraulic supply curve\n\n    # --- Step 1: Unit conversions and temperature-dependent calculations ---\n    D_Pa = D_kPa * 1000.0\n    T_K = T_C + 273.15\n\n    # Viscosity of water function\n    def mu(T_in_K):\n        return VISC_A * 10**(VISC_B / (T_in_K - VISC_C))\n\n    # Calculate viscosity correction factor\n    viscosity_correction = mu(T_REF) / mu(T_K)\n    \n    # Adjust conductances for temperature\n    K_root_T = K_root_ref * viscosity_correction\n    K_stem_max_T = K_stem_max_ref * viscosity_correction\n\n    # --- Step 2: Calculate atmospheric demand flow rate (F_demand) ---\n    E_mol = g_sw * A_l * D_Pa / P_ATM\n    F_demand = M_W * E_mol\n    \n    # --- Step 3: Define hydraulic supply function H(psi_l) and find its maximum ---\n    \n    # Relative conductivity function (vulnerability curve)\n    def k_rel(psi):\n        return 1.0 / (1.0 + np.exp(-S * (psi - P50)))\n    \n    # Generate grid for leaf water potential psi_l\n    psi_l_grid = np.linspace(PSI_MIN, psi_soil, N_POINTS)\n    \n    # Calculate H(psi_l) across the grid using vectorized operations with numpy\n    k_rel_values = k_rel(psi_l_grid)\n    K_stem_T_values = K_stem_max_T * k_rel_values\n    \n    # Calculate total conductance using the robust form for series conductances\n    # This form, K_tot = (K1 * K2) / (K1 + K2), avoids explicit inversion.\n    denominator = K_root_T + K_stem_T_values\n    K_tot_values = np.divide(K_root_T * K_stem_T_values, denominator, \n                             out=np.zeros_like(denominator), where=denominator != 0)\n\n    # Calculate hydraulic supply H(psi_l)\n    H_values = K_tot_values * (psi_soil - psi_l_grid)\n    \n    # Find the maximum hydraulic supply\n    H_max = np.max(H_values)\n\n    # --- Step 4: Determine the realized mass flow rate (F_real) ---\n    if F_demand > H_max:\n        F_real = H_max  # Supply-limited case\n    else:\n        F_real = F_demand  # Demand-limited case\n\n    # --- Step 5: Convert F_real to molar flow rate in mmol/s and return ---\n    E_real = 1000.0 * F_real / M_W\n    \n    return E_real\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "2555401"}]}