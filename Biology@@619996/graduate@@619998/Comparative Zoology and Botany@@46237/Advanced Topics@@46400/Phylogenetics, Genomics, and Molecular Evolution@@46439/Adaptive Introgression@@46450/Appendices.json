{"hands_on_practices": [{"introduction": "A primary task in studying introgression is its statistical detection from genomic data. The four-taxon $D$-statistic, or ABBA-BABA test, is a cornerstone method for identifying gene flow that bypasses the species phylogeny. This exercise [@problem_id:2544491] provides hands-on practice not only in calculating this fundamental statistic but also in applying the block-jackknife technique to robustly assess its statistical significance, a critical step that accounts for linkage among sites in the genome.", "problem": "A four-taxon test for adaptive introgression is conducted using genome-wide biallelic Single Nucleotide Polymorphisms (SNPs) arranged into non-overlapping physical blocks to account for linkage. The taxa are arranged as $\\left(P_{1},P_{2},P_{3};O\\right)$, where $O$ is an outgroup. Under the null hypothesis of no introgression and only Incomplete Lineage Sorting (ILS), the expected counts of the site-patterns $\\mathrm{ABBA}$ and $\\mathrm{BABA}$ are equal. The D-statistic quantifies asymmetry in these counts. The genome is partitioned into $B=50$ equal-length blocks for block-resampling.\n\nAcross the full dataset, the total counts are $\\mathrm{ABBA}=320$ and $\\mathrm{BABA}=280$. The delete-one block-jackknife (leaving out one block at a time) is performed to assess uncertainty. Let $\\hat{D}_{(-b)}$ denote the D-statistic computed from the data with block $b$ removed, and let $\\bar{D}_{\\mathrm{LOO}}=\\frac{1}{B}\\sum_{b=1}^{B}\\hat{D}_{(-b)}$ be the mean of the leave-one-out estimates. From the $B=50$ leave-one-out replicates, the sum of squared deviations is observed to be\n$$\n\\sum_{b=1}^{B}\\left(\\hat{D}_{(-b)}-\\bar{D}_{\\mathrm{LOO}}\\right)^{2}=2.296\\times 10^{-4}.\n$$\n\nUsing only fundamental definitions underlying the $\\mathrm{ABBA}$–$\\mathrm{BABA}$ framework and the delete-one jackknife, do the following:\n- Derive the expression for the genome-wide D-statistic from the total counts and compute its value.\n- Starting from the definition of the delete-one jackknife variance estimator, derive the estimator in terms of $B$ and the leave-one-out deviations, then compute the jackknife standard error and the corresponding $Z$-score for testing the null hypothesis that $D=0$.\n\nReport your final answer as a row matrix $\\left[D,\\;Z\\right]$, where both entries are rounded to four significant figures and expressed as pure decimals (no units).", "solution": "First, we compute the genome-wide D-statistic, $\\hat{D}$. This statistic quantifies the asymmetry between the counts of $\\mathrm{ABBA}$ and $\\mathrm{BABA}$ site patterns. Let $n_{\\mathrm{ABBA}}$ and $n_{\\mathrm{BABA}}$ be the total counts of these patterns. The D-statistic is defined as:\n$$\n\\hat{D} = \\frac{n_{\\mathrm{ABBA}} - n_{\\mathrm{BABA}}}{n_{\\mathrm{ABBA}} + n_{\\mathrm{BABA}}}\n$$\nUsing the provided counts, $n_{\\mathrm{ABBA}} = 320$ and $n_{\\mathrm{BABA}} = 280$:\n$$\n\\hat{D} = \\frac{320 - 280}{320 + 280} = \\frac{40}{600} = \\frac{1}{15} \\approx 0.066667\n$$\nNext, we estimate the uncertainty using the delete-one block jackknife. The delete-one jackknife variance estimator, $\\widehat{\\mathrm{Var}}_{J}(\\hat{D})$, is given by:\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{B-1}{B} \\sum_{b=1}^{B} (\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}})^2\n$$\nwhere $B$ is the number of blocks, $\\hat{D}_{(-b)}$ is the statistic with block $b$ omitted, and $\\bar{D}_{\\mathrm{LOO}}$ is the mean of the leave-one-out estimates. We are given $B=50$ and the sum of squared deviations $\\sum_{b=1}^{B}\\left(\\hat{D}_{(-b)}-\\bar{D}_{\\mathrm{LOO}}\\right)^{2}=2.296\\times 10^{-4}$.\nSubstituting these values:\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{50-1}{50} (2.296 \\times 10^{-4}) = \\frac{49}{50} (2.296 \\times 10^{-4}) = 0.98 \\times 2.296 \\times 10^{-4} = 2.25008 \\times 10^{-4}\n$$\nThe jackknife standard error, $\\mathrm{SE}_J(\\hat{D})$, is the square root of the variance:\n$$\n\\mathrm{SE}_J(\\hat{D}) = \\sqrt{\\widehat{\\mathrm{Var}}_{J}(\\hat{D})} = \\sqrt{2.25008 \\times 10^{-4}} \\approx 0.01500027\n$$\nFinally, we calculate the $Z$-score for testing the null hypothesis $H_0: D=0$. The $Z$-score is the ratio of the estimated statistic to its standard error:\n$$\nZ = \\frac{\\hat{D} - D_{H_0}}{\\mathrm{SE}_J(\\hat{D})} = \\frac{\\hat{D}}{\\mathrm{SE}_J(\\hat{D})}\n$$\nUsing the computed values for $\\hat{D}$ and $\\mathrm{SE}_J(\\hat{D})$:\n$$\nZ = \\frac{1/15}{0.01500027} \\approx \\frac{0.066666...}{0.01500027} \\approx 4.44439\n$$\nThe problem requires the final answer to be reported as a row matrix $[D, Z]$ with both values rounded to four significant figures.\n$D = 0.066666... \\approx 0.06667$\n$Z = 4.44439... \\approx 4.444$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.06667 & 4.444\n\\end{pmatrix}\n}\n$$", "id": "2544491"}, {"introduction": "Once an advantageous allele has introgressed into a new population, its subsequent fate is governed by the principles of population genetics. This practice [@problem_id:2544560] challenges you to derive the deterministic trajectory of such an allele from first principles, starting with the continuous-time replicator dynamics. By solving for the allele frequency $p(t)$, you will gain a foundational understanding of the logistic growth pattern that characterizes the spread of an adaptive trait.", "problem": "An introgressed allele $A$ conferring high-altitude tolerance has entered two distinct taxa through adaptive introgression: a montane mammal and an alpine grass. After a brief hybridization pulse at time $t=0$, the allele is present in the recipient population at frequency $p_{0} \\in (0,1)$. Thereafter, the population is large, randomly mating, and closed (no migration), so that genetic drift and further gene flow are negligible. Assume that selection acts additively on Malthusian fitness in continuous time: each copy of allele $A$ contributes an additive increase $s>0$ to the per-capita growth rate, so that genotype Malthusian fitnesses are $r_{AA}=2s$, $r_{Aa}=s$, and $r_{aa}=0$. Assume Hardy–Weinberg genotype proportions at each instant due to random mating and that the continuous-time deterministic selection dynamics apply.\n\nUsing only these assumptions and the definition of the continuous-time selection (replicator) dynamics for genotype frequencies—namely that genotype frequency $x_{i}$ changes according to $\\dot{x}_{i}=x_{i}(r_{i}-\\bar{r})$, where $\\bar{r}$ is the mean Malthusian fitness—derive from first principles the expected allele frequency trajectory $p(t)$ for $t \\ge 0$ with initial condition $p(0)=p_{0}$. Then, define the time to half-fixation $t_{1/2}$ as the time at which $p(t)=\\frac{1}{2}$, and determine $t_{1/2}$ in terms of $s$ and $p_{0}$. Treat time $t$ in units of generations and $s$ as a per-generation Malthusian selection coefficient. Provide your final answers as closed-form analytic expressions for $p(t)$ and $t_{1/2}$. No numerical rounding is required.", "solution": "The task is to derive the trajectory of the allele frequency $p(t)$ from first principles. The frequency of allele $A$, denoted by $p$, is related to the genotype frequencies under the assumption of Hardy-Weinberg proportions:\n$$\nx_{AA} = p^2 \\quad , \\quad x_{Aa} = 2p(1-p) \\quad , \\quad x_{aa} = (1-p)^2\n$$\nThe mean Malthusian fitness of the population, $\\bar{r}$, is the average of the genotype fitnesses ($r_{AA}=2s$, $r_{Aa}=s$, $r_{aa}=0$) weighted by their frequencies:\n$$\n\\bar{r} = x_{AA}r_{AA} + x_{Aa}r_{Aa} + x_{aa}r_{aa} = p^2(2s) + 2p(1-p)(s) + (1-p)^2(0) = 2sp\n$$\nThe rate of change of the allele frequency, $\\dot{p}$, can be derived from the genotype frequency dynamics, $\\dot{x}_{i}=x_{i}(r_{i}-\\bar{r})$. Using the relation $p = x_{AA} + \\frac{1}{2}x_{Aa}$:\n$$\n\\dot{p} = \\frac{dp}{dt} = \\dot{x}_{AA} + \\frac{1}{2}\\dot{x}_{Aa} = x_{AA}(r_{AA} - \\bar{r}) + \\frac{1}{2}x_{Aa}(r_{Aa} - \\bar{r})\n$$\nSubstituting the expressions for frequencies, fitnesses, and mean fitness:\n$$\n\\dot{p} = p^2(2s - 2sp) + \\frac{1}{2}[2p(1-p)](s - 2sp)\n$$\nFactoring out common terms gives:\n$$\n\\dot{p} = 2sp^2(1-p) + sp(1-p)(1-2p) = sp(1-p)[2p + (1-2p)] = sp(1-p)\n$$\nThis is the logistic differential equation for allele frequency. To solve it, we separate variables:\n$$\n\\frac{dp}{p(1-p)} = s \\, dt\n$$\nIntegrating both sides (using partial fraction expansion for the left side, $\\frac{1}{p(1-p)} = \\frac{1}{p} + \\frac{1}{1-p}$):\n$$\n\\int \\left(\\frac{1}{p} + \\frac{1}{1-p}\\right) dp = \\int s \\, dt \\implies \\ln(p) - \\ln(1-p) = st + K\n$$\nwhere $K$ is the integration constant. This can be written as $\\ln\\left(\\frac{p}{1-p}\\right) = st + K$. Applying the initial condition $p(0)=p_0$:\n$$\nK = \\ln\\left(\\frac{p_0}{1-p_0}\\right)\n$$\nSubstituting $K$ back and solving for $p(t)$:\n$$\n\\ln\\left(\\frac{p(t)}{1-p(t)}\\right) = st + \\ln\\left(\\frac{p_0}{1-p_0}\\right)\n$$\n$$\n\\frac{p(t)}{1-p(t)} = \\frac{p_0}{1-p_0}\\exp(st)\n$$\nSolving for $p(t)$ yields the logistic growth curve:\n$$\np(t) = \\frac{\\frac{p_0}{1-p_0}\\exp(st)}{1 + \\frac{p_0}{1-p_0}\\exp(st)} = \\frac{p_0 \\exp(st)}{(1-p_0) + p_0 \\exp(st)}\n$$\nThis is the first required result.\n\nNext, we find the time to half-fixation, $t_{1/2}$, where $p(t_{1/2}) = 1/2$.\n$$\n\\frac{1}{2} = \\frac{p_0 \\exp(st_{1/2})}{(1-p_0) + p_0 \\exp(st_{1/2})}\n$$\nCross-multiplying and rearranging:\n$$\n(1-p_0) + p_0 \\exp(st_{1/2}) = 2 p_0 \\exp(st_{1/2})\n$$\n$$\n1-p_0 = p_0 \\exp(st_{1/2})\n$$\n$$\n\\exp(st_{1/2}) = \\frac{1-p_0}{p_0}\n$$\nFinally, solving for $t_{1/2}$:\n$$\nt_{1/2} = \\frac{1}{s}\\ln\\left(\\frac{1-p_0}{p_0}\\right)\n$$\nThis completes the derivation.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{p_0 \\exp(st)}{(1-p_0) + p_0 \\exp(st)} & \\frac{1}{s}\\ln\\left(\\frac{1-p_0}{p_0}\\right)\n\\end{pmatrix}\n}\n$$", "id": "2544560"}, {"introduction": "Introgression leaves tangible footprints in the genome in the form of contiguous ancestry tracts, the lengths of which hold valuable information about the history of admixture and selection. This problem [@problem_id:2688969] guides you through modeling the distribution of these tracts, beginning with the neutral expectation that tract lengths follow an exponential distribution. You will then extend this model to incorporate how positive selection acting on introgressed variants can skew this distribution, providing a more sophisticated framework for interpreting empirical data.", "problem": "Consider a single-pulse admixture model in which a donor population contributed ancestry to a recipient population exactly $T$ generations ago. Assume a continuous genome with genetic map measured in Morgans, a uniform per-generation crossover rate $r$ per Morgan per generation, independent recombination across generations, and no gene conversion. Focus on a single chromosome in a present-day sampled haplotype descended from the admixture event.\n\nPart A (neutral tracts): Using only the following foundational facts: (i) crossovers along the genome in a single meiosis form a spatial Poisson process with rate $r$ per Morgan; (ii) across $T$ generations along a lineage, superposition of independent Poisson processes yields another Poisson process whose rate is the sum of the individual rates; and (iii) the distances between successive points in a Poisson process are independent and identically distributed exponential random variables, derive the distribution of the length $L$ of a contiguous donor-ancestry tract observed today under neutrality. Explicitly identify the probability density function of $L$ and its mean as functions of $r$ and $T$.\n\nPart B (selection favoring longer tracts): Now suppose there is selection that favors introgressed tracts in a way that increases the relative weight of longer tracts. Specifically, assume that along any tract of length $L$ (in Morgans), the number $K$ of introgressed donor-specific beneficial sites is Poisson with mean $\\mu L$, where $\\mu$ is the density (per Morgan) of such sites. Each beneficial site that remains introgressed and is carried by the haplotype multiplies fitness by a factor $(1+s)$ independently, with $s &gt; 0$, and fitness effects are multiplicative across sites. Assume that, at the time of sampling, the probability of sampling a haplotype is proportional to its expected multiplicative fitness with respect to these sites. Under the additional assumption that $rT &gt; \\mu \\ln(1+s)$ (so that the resulting distribution is normalizable), derive the reweighted tract-length density and compute its mean in closed form.\n\nAnswer specification: Provide as your final answer a single closed-form analytic expression for the mean tract length under the selection model in Part B as a function of $r$, $T$, $\\mu$, and $s$. Do not include any units in your final answer. No numerical rounding is required.", "solution": "**Part A: Neutral Tract Length Distribution**\n\nWe model the process of tract breakup by crossovers. In any given generation, crossovers along a chromosome occur as a Poisson process with rate $r$ per Morgan. Over $T$ generations, the total set of crossover breakpoints that could disrupt an ancestral tract is the superposition of $T$ independent Poisson processes. The resulting cumulative process is also a Poisson process with a rate, $\\lambda_0$, equal to the sum of the individual rates:\n$$\n\\lambda_0 = \\sum_{i=1}^{T} r = rT\n$$\nThe length of a contiguous donor ancestry tract, $L$, is the distance from an arbitrary starting point to the first breakpoint from this cumulative process. The distance between events in a Poisson process follows an exponential distribution with a rate parameter equal to the rate of the process.\n\nTherefore, the length $L$ of a neutral donor tract is an exponential random variable with rate $\\lambda_0 = rT$. Its probability density function (PDF), $p_{neutral}(L)$, is:\n$$\np_{neutral}(L) = \\lambda_0 \\exp(-\\lambda_0 L) = rT \\exp(-rT L), \\quad \\text{for } L \\ge 0\n$$\nThe mean of an exponential distribution with rate $\\lambda_0$ is $1/\\lambda_0$. Thus, the mean neutral tract length is:\n$$\nE[L]_{neutral} = \\frac{1}{\\lambda_0} = \\frac{1}{rT}\n$$\n\n**Part B: Tract Length Distribution under Selection**\n\nSelection modifies the observed distribution of tract lengths by favoring the survival of haplotypes carrying longer tracts, which are more likely to contain beneficial alleles. The problem states that the probability of sampling a haplotype is proportional to a weighting factor $W(L)$ that represents its fitness. The number of beneficial sites $K$ on a tract of length $L$ is Poisson distributed, $K \\sim \\text{Poisson}(\\mu L)$. The fitness contribution of the tract is $(1+s)^K$.\n\nThe problem states the sampling probability is proportional to the *expected* multiplicative fitness and provides the constraint $rT > \\mu \\ln(1+s)$. This guides the interpretation of the weighting function. Using the approximation that the fitness effect is based on the *expected* number of beneficial sites on a tract of length $L$ (i.e., $E[K|L] = \\mu L$), the weighting function becomes:\n$$\nW(L) = (1+s)^{E[K|L]} = (1+s)^{\\mu L} = \\exp(\\ln((1+s)^{\\mu L})) = \\exp(\\mu L \\ln(1+s))\n$$\nThe reweighted, unnormalized probability density for tract length, $p'_{sel}(L)$, is the product of the neutral density and this fitness weight:\n$$\np'_{sel}(L) \\propto p_{neutral}(L) \\times W(L) \\propto \\exp(-rT L) \\times \\exp(\\mu L \\ln(1+s))\n$$\n$$\np'_{sel}(L) \\propto \\exp(-(rT - \\mu \\ln(1+s)) L)\n$$\nThis is the kernel of an exponential distribution. We define the new rate parameter under selection, $\\lambda_{sel}$, as:\n$$\n\\lambda_{sel} = rT - \\mu \\ln(1+s)\n$$\nThe given condition $rT > \\mu \\ln(1+s)$ ensures that $\\lambda_{sel} > 0$, making the distribution normalizable. The full probability density function under selection is $p_{sel}(L) = \\lambda_{sel} \\exp(-\\lambda_{sel} L)$.\n\nThe mean of this new exponential distribution is the reciprocal of its rate parameter. Therefore, the mean tract length under selection, $E[L]_{sel}$, is:\n$$\nE[L]_{sel} = \\frac{1}{\\lambda_{sel}} = \\frac{1}{rT - \\mu \\ln(1+s)}\n$$\nThis is the final required expression.", "answer": "$$\n\\boxed{\\frac{1}{rT - \\mu \\ln(1+s)}}\n$$", "id": "2688969"}]}