{"hands_on_practices": [{"introduction": "The ability to design rigorous experiments is the cornerstone of developmental biology. This exercise challenges you to think like an experimentalist by evaluating a classic bead implantation experiment designed to test the function of a key signaling molecule. By critically assessing experimental design, predicting outcomes, and devising a quantitative scoring scheme, you will engage with the foundational logic used to uncover the principles of limb patterning, specifically the role of Fibroblast Growth Factor (FGF) in specifying the proximodistal axis [@problem_id:2569569].", "problem": "You are tasked with designing and evaluating a proximal bead implantation experiment in a chick forelimb bud to test whether ectopic Fibroblast Growth Factor (FGF) signaling re-specifies proximodistal identities of endochondral elements. Choose the single best option that simultaneously (i) specifies a scientifically rigorous and feasible experimental design, including developmental stage, bead material, ligand concentration, placement, and controls; (ii) makes mechanistically grounded predictions about alterations in endochondral element identities and associated molecular markers; and (iii) proposes a quantitative, reproducible, dimensionless scoring scheme that integrates morphological and molecular readouts, incorporates normalization and replication, and can be analyzed statistically. Assume standard resources for vertebrate limb development are available (e.g., chick embryos, whole-mount in situ hybridization, Alcian Blue cartilage staining), and that routine lab practice (e.g., anesthesia, sterile bead handling) is followed.\n\nOptions:\n\nA. Experimental design: Use chick forelimb buds at Hamburger–Hamilton (HH) stage $19$–$20$. Prepare heparin acrylic beads of diameter $150$–$200\\,\\mu\\mathrm{m}$ soaked in recombinant FGF8b at $1\\,\\mu\\mathrm{g}/\\mu\\mathrm{L}$ in phosphate-buffered saline with $0.1\\%$ bovine serum albumin (BSA) for $30\\,\\mathrm{min}$. Control beads are soaked in the vehicle containing $0.1\\%$ BSA. Implant one FGF bead into the proximal third of the anterior mesenchyme, approximately $100$–$200\\,\\mu\\mathrm{m}$ from the limb–flank junction and just beneath the ectoderm, avoiding the apical ectodermal ridge. Implant a vehicle bead at an equivalent site in the contralateral limb and include a sham-operated group. Allow development until HH stage $35$–$36$, fix, perform Alcian Blue staining for cartilage, and probe for *Meis1/2* and *Hoxa13* by in situ hybridization on matched-stage embryos. Predicted outcomes: Ectopic proximal FGF yields distalization of identities: reduction or loss of stylopod (e.g., humerus), proximal appearance or duplication of zeugopod-like and/or autopod-like elements (e.g., radius/ulna-like rods or extra digit-like condensations), proximal expansion of *Hoxa13* and reduction of *Meis1/2* proximally. Control beads do not alter pattern. Quantitative scoring: Define a Proximodistal Distalization Index, $\\mathrm{PDDI}$, per experimental limb as a weighted, normalized composite of morphological and molecular shifts relative to the contralateral control. Let $L_s^{\\mathrm{exp}}$ and $L_s^{\\mathrm{contra}}$ be stylopod lengths; $N_z^{\\mathrm{exp}}$ and $N_z^{\\mathrm{contra}}$ be counts of zeugopod elements identifiable by morphology (normally $2$); $N_d^{\\mathrm{exp}}$ and $N_d^{\\mathrm{contra}}$ be digit counts (normally $\\geq 3$ at HH $35$); $p_{\\mathrm{Hox13}}$ and $p_{\\mathrm{Meis2}}$ be the fractional proximodistal positions (from girdle to distal tip mapped to $[0,1]$) of the proximal boundaries of Hoxa13 and Meis2 expression domains. Compute features $x_1 = 1 - \\frac{L_s^{\\mathrm{exp}}}{L_s^{\\mathrm{contra}}}$, $x_2 = \\frac{N_z^{\\mathrm{exp}} - N_z^{\\mathrm{contra}}}{\\max(1, N_z^{\\mathrm{contra}})}$, $x_3 = \\frac{N_d^{\\mathrm{exp}} - N_d^{\\mathrm{contra}}}{\\max(1, N_d^{\\mathrm{contra}})}$, $x_4 = p_{\\mathrm{Hox13}}^{\\mathrm{exp}} - p_{\\mathrm{Hox13}}^{\\mathrm{contra}}$, $x_5 = p_{\\mathrm{Meis2}}^{\\mathrm{contra}} - p_{\\mathrm{Meis2}}^{\\mathrm{exp}}$. Convert each $x_i$ to a $z$-score within batch using control limbs to center and scale, then set $\\mathrm{PDDI} = \\sum_{i=1}^{5} w_i z(x_i)$ with $w_i = \\frac{1}{5}$ unless pre-validated weights are justified. Use $n \\geq 10$ embryos per group, blinded scoring, preregistered exclusion criteria, and two-sided significance testing at $\\alpha = 0.05$.\n\nB. Experimental design: Use chick forelimb buds at HH stage $28$. Prepare polystyrene beads soaked in FGF8b at $0.01\\,\\mu\\mathrm{g}/\\mu\\mathrm{L}$ for $5\\,\\mathrm{min}$ without carrier protein. Implant on the dorsal ectoderm overlying the distal third of the limb, centered above the apical ectodermal ridge. Controls are omitted to avoid contralateral bias. Predicted outcomes: Mirror-image anterior–posterior duplications of digits due to activation of Sonic hedgehog and posterior identity. Quantitative scoring: Define an Anterior–Posterior Mirror Index, $\\mathrm{APMI} = \\frac{N_{\\mathrm{post}}^{\\mathrm{mirror}}}{N_d}$, where $N_{\\mathrm{post}}^{\\mathrm{mirror}}$ is the count of duplicated posterior digits and $N_d$ is digit count. Statistical analysis is descriptive only, with $n = 3$ embryos.\n\nC. Experimental design: Use chick forelimb buds at HH stage $20$. Prepare heparin beads co-soaked in FGF8b at $1\\,\\mu\\mathrm{g}/\\mu\\mathrm{L}$ and retinoic acid at $10\\,\\mu\\mathrm{M}$ to “balance” signals. Implant one mixed bead proximally at the limb–flank junction. Controls use beads soaked in auxin at $10\\,\\mu\\mathrm{M}$. Predicted outcomes: Proximalization with enlargement of stylopod and reduction of digits due to enhanced FGF signaling. Quantitative scoring: Assign an ordinal Proximalization Score from $0$ (no change) to $3$ (complete proximalization) based on observer impression of element identities, averaged across $n = 4$ embryos without contralateral normalization.\n\nD. Experimental design: Use chick forelimb buds at HH stage $19$. Prepare agarose beads of diameter $500\\,\\mu\\mathrm{m}$ soaked in FGF8b at $100\\,\\mu\\mathrm{g}/\\mu\\mathrm{L}$ for $120\\,\\mathrm{min}$. Implant three beads in a row along the proximal limb circumference, contacting the AER. Controls are unoperated embryos only. Predicted outcomes: Loss of cartilage due to widespread apoptosis and necrosis; no specific identity changes are expected. Quantitative scoring: Compute the Percentage Cartilage Loss, $\\mathrm{PCL} = 100 \\times \\left(1 - \\frac{A_{\\mathrm{Alcian}}^{\\mathrm{exp}}}{A_{\\mathrm{Alcian}}^{\\mathrm{unop}}}\\right)$, where $A_{\\mathrm{Alcian}}$ is the total Alcian Blue area per limb. Report means with no variance estimates at $n = 5$.\n\nWhich option best satisfies the criteria?", "solution": "The problem statement itself must first be subjected to rigorous validation before any attempt at a solution.\n\n**Problem Statement Validation**\n\nStep 1: Extracted Givens\n- **System:** Chick forelimb bud.\n- **Hypothesis:** To test if ectopic Fibroblast Growth Factor (FGF) signaling re-specifies proximodistal (PD) identities of endochondral elements.\n- **Experimental Method:** Proximal bead implantation.\n- **Task:** To select the single best option from a provided list based on three criteria: (i) rigorous and feasible experimental design, (ii) mechanistically grounded predictions, and (iii) a quantitative, reproducible scoring scheme amenable to statistical analysis.\n- **Assumed Conditions:** Availability of standard laboratory resources and adherence to routine procedures for vertebrate embryology.\n\nStep 2: Validation of Givens\nThe problem presented is a task in evaluating experimental design within the field of evolutionary developmental biology, specifically focusing on the well-studied system of vertebrate limb patterning.\n- **Scientific Grounding:** The core hypothesis—that FGF signaling plays a crucial role in specifying distal identities in the developing limb—is a cornerstone of modern developmental biology. The \"Progress Zone\" model and subsequent \"two-signal\" models (proximal Retinoic Acid vs. distal FGF) provide the theoretical framework. The proposed experimental method, bead implantation of growth factors, is a classic and powerful technique that has been used to elucidate these very mechanisms. The question is therefore firmly grounded in established scientific principles.\n- **Well-Posedness:** The problem is structured as a constrained optimization problem: to find the \"best\" option according to a clear, itemized list of objective criteria. This structure permits a unique and defensible solution.\n- **Objectivity and Clarity:** The language used is precise, employing standard terminology of the field (e.g., Hamburger–Hamilton staging, endochondral elements, *Hoxa13*). The criteria for evaluation are objective measures of experimental quality. There is no ambiguity or subjective content in the problem statement itself.\n\nStep 3: Verdict\nThe problem statement is **VALID**. It is scientifically sound, well-posed, and objective. It presents a non-trivial task that requires expert knowledge of experimental design in developmental biology. We may proceed to the analysis of the options.\n\n**Solution and Evaluation of Options**\n\nThe task is to evaluate four proposed experimental designs against the established principles of scientific investigation. The central biological principle being tested is the role of FGF signaling as a determinant of distal limb identity. According to prevailing models, the apical ectodermal ridge (AER) is the source of a distal FGF signal that acts on the underlying mesenchyme. Placing an ectopic source of FGF in the proximal limb bud is therefore predicted to impose a distal identity on cells that would normally form proximal structures. A rigorous experiment must be designed to test this prediction unambiguously.\n\n**Analysis of Option A**\n\n- **(i) Experimental Design:** The proposed design is exceptionally rigorous.\n    - **Stage:** Hamburger–Hamilton (HH) stage $19$–$20$ is the correct time point. At this stage, the limb bud is actively growing and patterning, and the mesenchymal cells are competent to respond to signaling cues.\n    - **Bead and Ligand:** Heparin acrylic beads are the standard for delivering FGFs, which are heparin-binding proteins, allowing for controlled, local release. A concentration of $1\\,\\mu\\mathrm{g}/\\mu\\mathrm{L}$ for FGF8b is within the effective range reported in the literature. The use of phosphate-buffered saline (PBS) with $0.1\\%$ bovine serum albumin (BSA) as a carrier is standard practice to ensure ligand stability and prevent non-specific adhesion.\n    - **Placement:** Implantation into the proximal mesenchyme, avoiding the AER, is the precise location required to test the hypothesis of re-specifying proximal tissue.\n    - **Controls:** The inclusion of a vehicle bead in the contralateral limb, a sham-operated group, and the inherent comparison to the unoperated state constitutes a complete and robust set of controls. This design effectively isolates the effect of the FGF ligand from the physical trauma of surgery and the presence of the bead itself.\n- **(ii) Predicted Outcomes:** The predictions are mechanistically sound and directly follow from the known function of FGF in limb development.\n    - **Morphology:** Ectopic proximal FGF should disrupt the formation of proximal elements (stylopod, i.e., humerus) and induce the formation of more distal elements (zeugopod/autopod, i.e., radius/ulna/digits). This is the canonical \"distalization\" phenotype.\n    - **Molecular Markers:** The prediction that the expression domain of the distal marker *Hoxa13* will expand proximally, while the domain of the proximal marker *Meis1/2* will be reduced or shifted distally, is the correct molecular signature of this transformation.\n- **(iii) Quantitative Scoring:** The proposed quantitative scheme is exemplary.\n    - **Metrics:** The Proximodistal Distalization Index, $\\mathrm{PDDI}$, is a composite score that integrates both morphological ($L_s, N_z, N_d$) and molecular ($p_{\\mathrm{Hox13}}, p_{\\mathrm{Meis2}}$) readouts. This provides a comprehensive and multifaceted assessment of the phenotype.\n    - **Normalization and Statistics:** Each metric is formulated as a dimensionless ratio or difference relative to the contralateral control, which is essential for minimizing inter-embryo variability. The use of z-scores to combine disparate metrics into a single index is a valid approach. The proposal specifies an adequate sample size ($n \\geq 10$), blinded scoring, preregistered criteria, and proper statistical testing. This represents the gold standard for quantitative biology. The formulae for $x_1$ through $x_5$ are logical and well-defined. Note the correct formulation for $x_5 = p_{\\mathrm{Meis2}}^{\\mathrm{contra}} - p_{\\mathrm{Meis2}}^{\\mathrm{exp}}$, which ensures a positive value corresponds to distalization (proximal boundary of Meis2 expression moves distally).\n- **Verdict:** This option describes a state-of-the-art experiment that is rigorous, well-controlled, and quantitatively sophisticated. It perfectly addresses the scientific question. **Correct.**\n\n**Analysis of Option B**\n\n- **(i) Experimental Design:** This design is fundamentally flawed.\n    - **Stage:** HH stage $28$ is far too late for a patterning experiment. The main skeletal elements are already specified and beginning to differentiate. The tissue is no longer plastic.\n    - **Placement:** The bead is placed distally, near the endogenous FGF source (AER), and on the ectoderm, not in the mesenchyme. This experiment does not test the re-specification of *proximal* identity.\n    - **Ligand/Controls:** Polystyrene beads are suboptimal for FGF delivery. The ligand concentration is low. Most critically, the omission of controls is scientifically unacceptable and renders any result uninterpretable. The justification given (\"avoid contralateral bias\") is nonsense.\n- **(ii) Predicted Outcomes:** The prediction of anterior-posterior (AP) duplications concerns a different developmental axis. While FGF signaling is linked to AP patterning via maintenance of the Zone of Polarizing Activity (ZPA), this experiment is not designed to test the proximodistal hypothesis stated in the problem.\n- **(iii) Quantitative Scoring:** The proposed index (APMI) measures an AP phenotype, not a PD phenotype. The analysis is \"descriptive only\" with a trivial sample size ($n=3$), which is inadequate.\n- **Verdict:** This option is incoherent. It fails to test the stated hypothesis, uses incorrect methodology, and lacks scientific rigor. **Incorrect.**\n\n**Analysis of Option C**\n\n- **(i) Experimental Design:** This design is confounded and unscientific.\n    - **Ligand:** Co-applying FGF8b and Retinoic Acid (RA) introduces a severe confound. RA is a known *proximalizing* agent. Applying antagonist signals simultaneously makes the results impossible to interpret in the context of testing the effect of FGF alone.\n    - **Controls:** The use of auxin, a plant hormone, as a control in a vertebrate system is absurd. The proper control is a vehicle solution. This demonstrates a fundamental lack of understanding of experimental design.\n- **(ii) Predicted Outcomes:** The prediction of \"proximalization... due to enhanced FGF signaling\" is scientifically backward. FGF is a distalizing signal. This prediction contradicts established principles.\n- **(iii) Quantitative Scoring:** The use of a subjective, ordinal \"impression\" score is non-quantitative and prone to bias. The sample size ($n=4$) is too small, and the lack of normalization makes the data unreliable.\n- **Verdict:** This option is a catalog of errors, from a confounded design and nonsensical controls to factually incorrect predictions and subjective analysis. **Incorrect.**\n\n**Analysis of Option D**\n\n- **(i) Experimental Design:** This design is overtly destructive.\n    - **Bead Size/Concentration:** A bead of diameter $500\\,\\mu\\mathrm{m}$ is gigantic relative to an HH $19$ limb bud and will cause massive physical damage. A FGF8b concentration of $100\\,\\mu\\mathrm{g}/\\mu\\mathrm{L}$ is $100$-fold higher than typical experimental concentrations and is well into the cytotoxic range for many growth factors.\n    - **Placement:** Using three such beads is extreme overkill.\n    - **Controls:** \"Unoperated embryos only\" is an insufficient control. It fails to account for surgical artefacts.\n- **(ii) Predicted Outcomes:** The prediction of \"widespread apoptosis and necrosis\" is a likely outcome of such a brutish experiment. However, an experiment that simply causes massive cell death does not, and cannot, test a hypothesis about subtle changes in cell fate and skeletal patterning. The experiment is designed to produce an artifact, not a meaningful result.\n- **(iii) Quantitative Scoring:** The proposed metric, Percentage Cartilage Loss, measures tissue destruction, not re-specification of identity. It is the wrong readout for the problem's hypothesis. The proposed analysis is statistically weak.\n- **Verdict:** This option describes a crude experiment that would yield uninterpretable, non-specific damage, completely failing to address the scientific question. **Incorrect.**\n\n**Conclusion**\n\nOption A is the only proposal that describes a scientifically valid, rigorous, and well-designed experiment. It demonstrates a sophisticated understanding of developmental biology, experimental control, and quantitative analysis. Options B, C, and D are replete with fundamental errors in design, logic, and methodology, rendering them useless for testing the stated hypothesis. Therefore, Option A is unequivocally the single best option.", "answer": "$$\\boxed{A}$$", "id": "2569569"}, {"introduction": "Beyond identifying key genes, a central goal of evo-devo is to create quantitative models that predict how changes in developmental processes lead to changes in morphology. This practice focuses on modeling programmed cell death (apoptosis), the process responsible for sculpting digits by removing interdigital tissue. You will use a standard exponential decay model to calculate how a small delay in the onset of apoptosis can affect the final amount of interdigital webbing, honing your ability to translate biological principles into a predictive mathematical framework [@problem_id:2569545].", "problem": "In vertebrate limb development, interdigital mesenchyme is removed via programmed cell death driven by Bone Morphogenetic Protein (BMP) signaling, which can be modeled as a first-order decay in the number of viable cells. Let $t$ denote the elapsed time since the onset of apoptosis, and let the viable cell number be given by the exponential decay $N(t)=N_0 \\exp(-\\kappa t)$, where $N_0$ is the viable cell number at the moment apoptosis begins and $\\kappa$ is a constant rate parameter. Assume that the predicted interdigital webbing area at a fixed developmental endpoint $T$ is directly proportional to the surviving viable cell number at that time due to approximately uniform cell density and thickness, so that $A(T)=\\alpha N(t)$ for some proportionality constant $\\alpha$ and elapsed time since onset $t$. Baseline apoptosis begins at an onset time $t_0$ after limb bud initiation, and the developmental endpoint satisfies $T>t_0$. Consider a perturbation that delays apoptosis onset by a factor of $1.10$, so the perturbed onset time is $t_0^{\\prime}=1.10\\,t_0$, with the same rate constant $\\kappa$, and the same endpoint $T$ satisfying $T>t_0^{\\prime}$. Using only these assumptions and the exponential decay model, derive the closed-form analytic expression for the ratio of predicted webbing area at $T$ under the delayed-onset condition to the baseline condition, $A^{\\prime}(T)/A(T)$, in terms of $\\kappa$ and $t_0$. Provide your final answer as a single closed-form analytic expression. No rounding is required, and no units are needed in the final expression.", "solution": "The problem statement presents a quantitative model of apoptosis in interdigital mesenchyme and asks for the derivation of a ratio of outcomes under two different conditions. First, a critical validation of the problem is required.\n\nThe givens are:\n1.  Viable cell number $N(t)$ follows a first-order decay model: $N(t)=N_0 \\exp(-\\kappa t)$, where $t$ is the elapsed time since apoptosis onset.\n2.  $N_0$ is the initial viable cell number at the start of apoptosis.\n3.  $\\kappa$ is a constant rate parameter.\n4.  Predicted webbing area at a developmental endpoint $T$, denoted $A(T)$, is directly proportional to the surviving cell number: $A(T)=\\alpha N(t)$, where $\\alpha$ is a constant of proportionality and $t$ is the elapsed time.\n5.  Baseline condition: Apoptosis begins at an onset time $t_0$. The endpoint $T$ satisfies $T > t_0$.\n6.  Perturbed condition: Apoptosis onset is delayed, with the new onset time being $t_0^{\\prime}=1.10\\,t_0$. The rate constant $\\kappa$ and endpoint $T$ remain unchanged. The new condition $T > t_0^{\\prime}$ holds.\n7.  The objective is to find the ratio of the perturbed area to the baseline area, $\\frac{A^{\\prime}(T)}{A(T)}$, expressed in terms of $\\kappa$ and $t_0$.\n\nThe problem is scientifically grounded, using a standard exponential decay model for a biological process. It is well-posed, providing all necessary information and a clear objective. The language is objective and the parameters are consistent. The slightly ambiguous notation $A(T)=\\alpha N(t)$ is clarified by the context, which dictates that the elapsed time $t$ must be calculated relative to the relevant onset time and the common endpoint $T$. Therefore, the problem is deemed valid and a solution can be derived.\n\nLet us define the absolute time scale, denoted by $\\tau$, beginning at an arbitrary origin such as limb bud initiation.\nThe baseline onset of apoptosis occurs at $\\tau = t_0$.\nThe perturbed onset of apoptosis occurs at $\\tau = t_0^{\\prime} = 1.10 t_0$.\nThe process is evaluated at a single, fixed developmental endpoint, $\\tau = T$.\n\nFor the baseline condition, the duration of apoptosis, which is the elapsed time from onset to the endpoint $T$, is given by $\\Delta t_{base} = T - t_0$.\nThe number of viable cells at time $T$ is determined by substituting this elapsed time into the decay model:\n$$N_{base}(T) = N_0 \\exp(-\\kappa(T - t_0))$$\nThe predicted webbing area is proportional to this cell number:\n$$A(T) = \\alpha N_{base}(T) = \\alpha N_0 \\exp(-\\kappa(T - t_0))$$\n\nFor the perturbed condition, the onset of apoptosis is delayed to $t_0^{\\prime}$. The duration of apoptosis up to the same endpoint $T$ is now $\\Delta t_{pert} = T - t_0^{\\prime} = T - 1.10 t_0$.\nThe number of viable cells at time $T$ under this perturbation is:\n$$N_{pert}(T) = N_0 \\exp(-\\kappa(T - 1.10 t_0))$$\nThe corresponding webbing area is:\n$$A^{\\prime}(T) = \\alpha N_{pert}(T) = \\alpha N_0 \\exp(-\\kappa(T - 1.10 t_0))$$\n\nThe problem requires the calculation of the ratio $\\frac{A^{\\prime}(T)}{A(T)}$. We construct this ratio using the expressions derived above:\n$$\\frac{A^{\\prime}(T)}{A(T)} = \\frac{\\alpha N_0 \\exp(-\\kappa(T - 1.10 t_0))}{\\alpha N_0 \\exp(-\\kappa(T - t_0))}$$\nThe proportionality constant $\\alpha$ and the initial cell number $N_0$ are common to both numerator and denominator, and thus cancel:\n$$\\frac{A^{\\prime}(T)}{A(T)} = \\frac{\\exp(-\\kappa(T - 1.10 t_0))}{\\exp(-\\kappa(T - t_0))}$$\nUsing the property of exponents, $\\frac{\\exp(a)}{\\exp(b)} = \\exp(a-b)$, we can simplify the expression:\n$$\\frac{A^{\\prime}(T)}{A(T)} = \\exp\\left( (-\\kappa(T - 1.10 t_0)) - (-\\kappa(T - t_0)) \\right)$$\nDistributing the terms inside the exponent:\n$$\\frac{A^{\\prime}(T)}{A(T)} = \\exp\\left( -\\kappa T + 1.10 \\kappa t_0 + \\kappa T - \\kappa t_0 \\right)$$\nThe terms involving the endpoint $T$, specifically $-\\kappa T$ and $+\\kappa T$, cancel each other out. This demonstrates that the ratio is independent of the specific endpoint $T$, provided $T$ is greater than both onset times. The expression simplifies to:\n$$\\frac{A^{\\prime}(T)}{A(T)} = \\exp\\left( 1.10 \\kappa t_0 - \\kappa t_0 \\right)$$\nFactoring out the term $\\kappa t_0$:\n$$\\frac{A^{\\prime}(T)}{A(T)} = \\exp\\left( (1.10 - 1) \\kappa t_0 \\right)$$\nThis yields the final closed-form analytic expression for the ratio:\n$$\\frac{A^{\\prime}(T)}{A(T)} = \\exp(0.10 \\kappa t_0)$$\nThis result is physically sensible. Delaying the onset of apoptosis reduces the time available for cell death to occur, leading to a higher number of surviving cells and thus a larger webbing area. Since $\\kappa > 0$ and $t_0 > 0$, the exponent $0.10 \\kappa t_0$ is positive, making the ratio greater than $1$, which is consistent with this physical reasoning.", "answer": "$$\\boxed{\\exp(0.10 \\kappa t_0)}$$", "id": "2569545"}, {"introduction": "Modern evo-devo leverages the power of genomics to understand the molecular basis of evolutionary change on a grand scale. This computational practice simulates a comparative transcriptomics study, a state-of-the-art approach to pinpointing the genetic drivers of morphological divergence. By analyzing synthetic gene expression data from bat and mouse limbs, you will apply a standard bioinformatics workflow—including calculating differential expression and performing statistical enrichment tests—to identify gene modules potentially responsible for the evolution of the bat wing [@problem_id:2569639].", "problem": "You are given simplified, synthetic single-cell messenger ribonucleic acid (mRNA) abundance summaries for autopod cells from bat and mouse, partitioned into distal versus proximal groups. From a principle-based perspective grounded in the Central Dogma of Molecular Biology (DNA to RNA to protein) and the empirical observation that differences in mRNA abundance across anatomical regions can reflect differential gene activity, model digit elongation-associated programs as distal-upregulated modules. You must, for each species, compute distal bias using the log base two fold-change, select the top genes as a module, derive a conserved module as the intersection across species, derive a divergent module as the bat-specific set difference, and then assess statistical significance of enrichment of these modules in provided gene sets using the one-sided hypergeometric test (sampling without replacement). Use a small positive pseudocount to avoid division by zero.\n\nCore definitions and assumptions to use:\n- For each species $s$ and gene $g$, define the distal bias as the log base two fold-change $L_{s}(g) = \\log_{2}\\left(\\dfrac{\\mu_{\\text{distal},s}(g) + \\epsilon}{\\mu_{\\text{proximal},s}(g) + \\epsilon}\\right)$, where $\\mu_{\\text{distal},s}(g)$ and $\\mu_{\\text{proximal},s}(g)$ are mean mRNA abundances for distal and proximal cell groups, respectively, and $\\epsilon$ is a small positive pseudocount.\n- Select the top $k$ genes with the largest positive $L_{s}(g)$ to form the distal-upregulated module $M_{s}$ for species $s$.\n- Define the conserved module $M_{\\text{cons}} = M_{\\text{bat}} \\cap M_{\\text{mouse}}$ and the divergent bat module $M_{\\text{div,bat}} = M_{\\text{bat}} \\setminus M_{\\text{mouse}}$.\n- Gene set enrichment is assessed using the hypergeometric distribution: given a universe $U$ with size $N = |U|$, a gene set $G \\subseteq U$ with $K = |G|$, a module $M \\subseteq U$ with $n = |M|$, and an observed overlap size $x = |M \\cap G|$, compute the one-sided $p$-value $p = \\Pr[X \\ge x]$ where $X \\sim \\text{Hypergeometric}(N, K, n)$. Use the survival function to avoid underflow. Report $p = 1$ when $n = 0$.\n\nParameters that are fixed across all test cases:\n- Pseudocount $\\epsilon = 10^{-3}$.\n- Significance threshold $\\alpha = 0.05$.\n- All logarithms are base $2$.\n- Report all $p$-values rounded to six decimal places as floating point numbers.\n\nYour program must implement the above procedure for the following test suite. In every case, use the gene order provided to align vectors.\n\nTest case $1$ (happy path with clear conservation):\n- Universe $U_{1}$ in order: [SHH, FGF8, BMP2, SOX9, COL2A1, HOXD13, IGF1, GREM1, GLI3, RUNX2, PTCH1, IHH].\n- Bat proximal means $\\mu_{\\text{prox},\\text{bat},1}$: [$2$, $1$, $4$, $5$, $6$, $0.5$, $1$, $0.5$, $2$, $3$, $4$, $2$].\n- Bat distal means $\\mu_{\\text{dist},\\text{bat},1}$: [$12$, $10$, $3$, $4$, $5$, $8$, $7$, $6$, $3$, $2$, $4.5$, $1.8$].\n- Mouse proximal means $\\mu_{\\text{prox},\\text{mouse},1}$: [$2$, $1$, $4$, $5$, $6$, $0.5$, $0.8$, $0.5$, $1$, $3$, $4$, $2$].\n- Mouse distal means $\\mu_{\\text{dist},\\text{mouse},1}$: [$11$, $9$, $3$, $4$, $5$, $7$, $6$, $1.5$, $5$, $2$, $4.3$, $1.9$].\n- Top selection size $k_{1} = 5$.\n- Elongation gene set $G_{\\text{elong},1} = \\{\\text{FGF8}, \\text{HOXD13}, \\text{IGF1}, \\text{GREM1}, \\text{SHH}\\}$.\n- Comparison gene set $G_{\\text{comp},1} = \\{\\text{SOX9}, \\text{COL2A1}, \\text{RUNX2}, \\text{IHH}\\}$.\n- Tasks: compute the $p$-value for enrichment of $M_{\\text{cons}}$ in $G_{\\text{elong},1}$ and the $p$-value for enrichment of $M_{\\text{div,bat}}$ in $G_{\\text{comp},1}$.\n\nTest case $2$ (boundary with no overlap and empty divergence):\n- Universe $U_{2}$ in order: [SHH, FGF8, BMP2, SOX9, COL2A1, HOXD13, IGF1, GREM1, GLI3, RUNX2, PTCH1, IHH].\n- Bat proximal means $\\mu_{\\text{prox},\\text{bat},2}$: [$4$, $3$, $3$, $2$, $2$, $2$, $3$, $2$, $2$, $1$, $3$, $1$].\n- Bat distal means $\\mu_{\\text{dist},\\text{bat},2}$: [$3.5$, $2.4$, $10$, $8$, $9$, $1.3$, $2.5$, $1.5$, $2.2$, $6$, $3.3$, $5$].\n- Mouse proximal means $\\mu_{\\text{prox},\\text{mouse},2}$: [$4$, $3$, $3$, $2$, $2$, $2$, $3$, $2$, $2$, $1$, $3$, $1$].\n- Mouse distal means $\\mu_{\\text{dist},\\text{mouse},2}$: [$3.5$, $2.4$, $11$, $9$, $8.5$, $1.3$, $2.2$, $1.7$, $2.2$, $6.2$, $3.3$, $5.3$].\n- Top selection size $k_{2} = 5$.\n- Elongation gene set $G_{\\text{elong},2} = \\{\\text{FGF8}, \\text{HOXD13}, \\text{IGF1}, \\text{GREM1}, \\text{SHH}\\}$.\n- Comparison gene set $G_{\\text{comp},2} = \\{\\text{SOX9}, \\text{COL2A1}, \\text{RUNX2}, \\text{IHH}\\}$.\n- Tasks: compute the $p$-value for enrichment of $M_{\\text{cons}}$ in $G_{\\text{elong},2}$ and the $p$-value for enrichment of $M_{\\text{div,bat}}$ in $G_{\\text{comp},2}$.\n\nTest case $3$ (edge with maximal conservation in a small universe):\n- Universe $U_{3}$ in order: [FGF8, HOXD13, IGF1, GREM1, SHH, GLI3, BMP2].\n- Bat proximal means $\\mu_{\\text{prox},\\text{bat},3}$: [$1$, $0.5$, $1$, $0.5$, $2$, $2$, $3$].\n- Bat distal means $\\mu_{\\text{dist},\\text{bat},3}$: [$8$, $7$, $6$, $5$, $2.5$, $1.8$, $2.5$].\n- Mouse proximal means $\\mu_{\\text{prox},\\text{mouse},3}$: [$1$, $0.5$, $1$, $0.5$, $2$, $2$, $3$].\n- Mouse distal means $\\mu_{\\text{dist},\\text{mouse},3}$: [$8$, $7$, $6$, $5$, $2.3$, $1.9$, $2.6$].\n- Top selection size $k_{3} = 4$.\n- Elongation gene set $G_{\\text{elong},3} = \\{\\text{FGF8}, \\text{HOXD13}, \\text{IGF1}, \\text{GREM1}\\}$.\n- Comparison gene set $G_{\\text{comp},3} = \\{\\text{BMP2}, \\text{GLI3}\\}$.\n- Tasks: compute the $p$-value for enrichment of $M_{\\text{cons}}$ in $G_{\\text{elong},3}$ and the $p$-value for enrichment of $M_{\\text{div,bat}}$ in $G_{\\text{comp},3}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case contributes a two-element list in the order [$p_{\\text{cons}}$, $p_{\\text{div,bat}}$], with each $p$ rounded to six decimal places. For example, the output should look like [[p11,p12],[p21,p22],[p31,p32]] with each $p$ shown to six decimals and no extra spaces.", "solution": "The problem has been subjected to rigorous validation.\n\nStep 1: Extracted Givens\nThe problem provides the following definitions, parameters, and data sets for three test cases.\n\nCore definitions:\n- Distal bias: $L_{s}(g) = \\log_{2}\\left(\\dfrac{\\mu_{\\text{distal},s}(g) + \\epsilon}{\\mu_{\\text{proximal},s}(g) + \\epsilon}\\right)$ for species $s$ and gene $g$.\n- Distal-upregulated module: $M_{s}$ is the set of top $k$ genes with the largest positive distal bias $L_{s}(g)$.\n- Conserved module: $M_{\\text{cons}} = M_{\\text{bat}} \\cap M_{\\text{mouse}}$.\n- Divergent bat module: $M_{\\text{div,bat}} = M_{\\text{bat}} \\setminus M_{\\text{mouse}}$.\n- Hypergeometric $p$-value: The one-sided probability $\\Pr[X \\ge x]$ from a hypergeometric distribution $X \\sim \\text{Hypergeometric}(N, K, n)$, where $N$ is the universe size, $K$ is the gene set size, $n$ is the module size, and $x$ is the overlap size. A special case is given: if $n=0$, then $p=1$.\n\nFixed parameters:\n- Pseudocount $\\epsilon = 10^{-3}$.\n- Significance threshold $\\alpha = 0.05$.\n- Logarithm base is $2$.\n- All $p$-values are to be rounded to six decimal places.\n\nTest Case 1:\n- Universe $U_1$: [SHH, FGF8, BMP2, SOX9, COL2A1, HOXD13, IGF1, GREM1, GLI3, RUNX2, PTCH1, IHH].\n- Bat proximal means $\\mu_{\\text{prox},\\text{bat},1}$: [$2$, $1$, $4$, $5$, $6$, $0.5$, $1$, $0.5$, $2$, $3$, $4$, $2$].\n- Bat distal means $\\mu_{\\text{dist},\\text{bat},1}$: [$12$, $10$, $3$, $4$, $5$, $8$, $7$, $6$, $3$, $2$, $4.5$, $1.8$].\n- Mouse proximal means $\\mu_{\\text{prox},\\text{mouse},1}$: [$2$, $1$, $4$, $5$, $6$, $0.5$, $0.8$, $0.5$, $1$, $3$, $4$, $2$].\n- Mouse distal means $\\mu_{\\text{dist},\\text{mouse},1}$: [$11$, $9$, $3$, $4$, $5$, $7$, $6$, $1.5$, $5$, $2$, $4.3$, $1.9$].\n- Top selection size $k_1 = 5$.\n- Gene sets: $G_{\\text{elong},1} = \\{\\text{FGF8}, \\text{HOXD13}, \\text{IGF1}, \\text{GREM1}, \\text{SHH}\\}$, $G_{\\text{comp},1} = \\{\\text{SOX9}, \\text{COL2A1}, \\text{RUNX2}, \\text{IHH}\\}$.\n- Tasks: Compute $p$-values for $M_{\\text{cons}}$ in $G_{\\text{elong},1}$ and $M_{\\text{div,bat}}$ in $G_{\\text{comp},1}$.\n\nTest Case 2:\n- Universe $U_2$: [SHH, FGF8, BMP2, SOX9, COL2A1, HOXD13, IGF1, GREM1, GLI3, RUNX2, PTCH1, IHH].\n- Bat proximal means $\\mu_{\\text{prox},\\text{bat},2}$: [$4$, $3$, $3$, $2$, $2$, $2$, $3$, $2$, $2$, $1$, $3$, $1$].\n- Bat distal means $\\mu_{\\text{dist},\\text{bat},2}$: [$3.5$, $2.4$, $10$, $8$, $9$, $1.3$, $2.5$, $1.5$, $2.2$, $6$, $3.3$, $5$].\n- Mouse proximal means $\\mu_{\\text{prox},\\text{mouse},2}$: [$4$, $3$, $3$, $2$, $2$, $2$, $3$, $2$, $2$, $1$, $3$, $1$].\n- Mouse distal means $\\mu_{\\text{dist},\\text{mouse},2}$: [$3.5$, $2.4$, $11$, $9$, $8.5$, $1.3$, $2.2$, $1.7$, $2.2$, $6.2$, $3.3$, $5.3$].\n- Top selection size $k_2 = 5$.\n- Gene sets: $G_{\\text{elong},2} = \\{\\text{FGF8}, \\text{HOXD13}, \\text{IGF1}, \\text{GREM1}, \\text{SHH}\\}$, $G_{\\text{comp},2} = \\{\\text{SOX9}, \\text{COL2A1}, \\text{RUNX2}, \\text{IHH}\\}$.\n- Tasks: Compute $p$-values for $M_{\\text{cons}}$ in $G_{\\text{elong},2}$ and $M_{\\text{div,bat}}$ in $G_{\\text{comp},2}$.\n\nTest Case 3:\n- Universe $U_3$: [FGF8, HOXD13, IGF1, GREM1, SHH, GLI3, BMP2].\n- Bat proximal means $\\mu_{\\text{prox},\\text{bat},3}$: [$1$, $0.5$, $1$, $0.5$, $2$, $2$, $3$].\n- Bat distal means $\\mu_{\\text{dist},\\text{bat},3}$: [$8$, $7$, $6$, $5$, $2.5$, $1.8$, $2.5$].\n- Mouse proximal means $\\mu_{\\text{prox},\\text{mouse},3}$: [$1$, $0.5$, $1$, $0.5$, $2$, $2$, $3$].\n- Mouse distal means $\\mu_{\\text{dist},\\text{mouse},3}$: [$8$, $7$, $6$, $5$, $2.3$, $1.9$, $2.6$].\n- Top selection size $k_3 = 4$.\n- Gene sets: $G_{\\text{elong},3} = \\{\\text{FGF8}, \\text{HOXD13}, \\text{IGF1}, \\text{GREM1}\\}$, $G_{\\text{comp},3} = \\{\\text{BMP2}, \\text{GLI3}\\}$.\n- Tasks: Compute $p$-values for $M_{\\text{cons}}$ in $G_{\\text{elong},3}$ and $M_{\\text{div,bat}}$ in $G_{\\text{comp},3}$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is evaluated against the specified criteria:\n- **Scientifically Grounded and Objective**: The problem is a simplified but standard bioinformatics workflow. The concepts of log fold-change for differential expression, module definition, and hypergeometric testing for gene set enrichment are fundamental and widely used in genomics and molecular biology. The problem is based on objective, quantitative procedures.\n- **Well-Posed**: The problem is structured as a precise algorithm. All necessary data, parameters, and definitions are provided. The instructions are unambiguous, ensuring a unique and stable solution can be computed. Edge cases, such as division by zero (addressed by pseudocount $\\epsilon$) and empty modules (addressed by the rule $p=1$ for $n=0$), are explicitly handled.\n- **Completeness and Consistency**: The problem is self-contained. The data sets are complete for each test case, and there are no internal contradictions.\n\nStep 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and complete. It is therefore **valid**. A solution will be provided.\n\nThe general procedure is to execute the defined computational pipeline for each test case. This involves:\n1. For each species (bat and mouse), compute the distal bias $L_s(g)$ for all genes in the given universe.\n2. Filter for genes with positive $L_s(g)$, sort them in descending order, and select the top $k$ genes to form the species-specific modules $M_{\\text{bat}}$ and $M_{\\text{mouse}}$.\n3. Derive the conserved module $M_{\\text{cons}}$ and divergent module $M_{\\text{div,bat}}$ using set intersection and difference, respectively.\n4. For each required enrichment test, compute the corresponding $p$-value using the one-sided hypergeometric test survival function.\n\nThe hypergeometric test parameters are:\n- $N$: The total number of genes in the universe $U$.\n- $K$: The number of genes in the gene set of interest $G$ (the \"successes\" in the population).\n- $n$: The number of genes in the module $M$ being tested (the \"draws\").\n- $x$: The number of genes in the intersection of the module and the gene set, $x = |M \\cap G|$ (the \"observed successes\").\n\nThe $p$-value is $p = \\Pr[X \\ge x]$, calculated as the survival function of the hypergeometric distribution for a random variable $X \\sim \\text{Hypergeometric}(N, K, n)$. This is equivalent to summing the probabilities $\\Pr[X=i]$ for $i$ from $x$ to $\\min(n, K)$.\n\nNow, we apply this procedure to each test case.\n\nTest Case 1:\n- Universe size $N_1 = 12$, selection size $k_1 = 5$, pseudocount $\\epsilon = 0.001$.\n- Bat module $M_{\\text{bat},1}$: We compute $L_{\\text{bat},1}(g)$ for all genes. The top $5$ genes with positive bias are: $\\{\\text{HOXD13}, \\text{GREM1}, \\text{FGF8}, \\text{IGF1}, \\text{SHH}\\}$.\n- Mouse module $M_{\\text{mouse},1}$: We compute $L_{\\text{mouse},1}(g)$ for all genes. The top $5$ genes with positive bias are: $\\{\\text{HOXD13}, \\text{FGF8}, \\text{IGF1}, \\text{SHH}, \\text{GLI3}\\}$.\n- Conserved module $M_{\\text{cons},1} = M_{\\text{bat},1} \\cap M_{\\text{mouse},1} = \\{\\text{SHH}, \\text{FGF8}, \\text{HOXD13}, \\text{IGF1}\\}$.\n- Divergent module $M_{\\text{div,bat},1} = M_{\\text{bat},1} \\setminus M_{\\text{mouse},1} = \\{\\text{GREM1}\\}$.\n- P-value for $M_{\\text{cons},1}$ vs $G_{\\text{elong},1}$:\n  - $N_1 = 12$. $K_1 = |G_{\\text{elong},1}| = 5$. $n_1 = |M_{\\text{cons},1}| = 4$.\n  - Overlap $x_1 = |M_{\\text{cons},1} \\cap G_{\\text{elong},1}| = |\\{\\text{SHH, FGF8, HOXD13, IGF1}\\}| = 4$.\n  - $p_{\\text{cons},1} = \\Pr[X \\ge 4]$ for $X \\sim \\text{Hypergeometric}(12, 5, 4)$. $p = \\frac{\\binom{5}{4}\\binom{7}{0}}{\\binom{12}{4}} = \\frac{5}{495} \\approx 0.010101$.\n- P-value for $M_{\\text{div,bat},1}$ vs $G_{\\text{comp},1}$:\n  - $N_1 = 12$. $K_2 = |G_{\\text{comp},1}| = 4$. $n_2 = |M_{\\text{div,bat},1}| = 1$.\n  - Overlap $x_2 = |M_{\\text{div,bat},1} \\cap G_{\\text{comp},1}| = |\\{\\text{GREM1}\\} \\cap \\{\\text{SOX9}, \\text{COL2A1}, \\text{RUNX2}, \\text{IHH}\\}| = 0$.\n  - $p_{\\text{div},1} = \\Pr[X \\ge 0]$ for $X \\sim \\text{Hypergeometric}(12, 4, 1)$. This probability is necessarily $1$.\n\nTest Case 2:\n- Universe size $N_2 = 12$, selection size $k_2 = 5$, pseudocount $\\epsilon = 0.001$.\n- Bat module $M_{\\text{bat},2}$: The top $5$ genes with positive bias are $\\{\\text{RUNX2}, \\text{IHH}, \\text{COL2A1}, \\text{SOX9}, \\text{BMP2}\\}$.\n- Mouse module $M_{\\text{mouse},2}$: The top $5$ genes with positive bias are $\\{\\text{RUNX2}, \\text{IHH}, \\text{SOX9}, \\text{COL2A1}, \\text{BMP2}\\}$.\n- Conserved module $M_{\\text{cons},2} = M_{\\text{bat},2} \\cap M_{\\text{mouse},2} = \\{\\text{RUNX2}, \\text{IHH}, \\text{COL2A1}, \\text{SOX9}, \\text{BMP2}\\}$.\n- Divergent module $M_{\\text{div,bat},2} = M_{\\text{bat},2} \\setminus M_{\\text{mouse},2} = \\emptyset$.\n- P-value for $M_{\\text{cons},2}$ vs $G_{\\text{elong},2}$:\n  - $N_2 = 12$. $K_1 = |G_{\\text{elong},2}| = 5$. $n_1 = |M_{\\text{cons},2}| = 5$.\n  - Overlap $x_1 = |M_{\\text{cons},2} \\cap G_{\\text{elong},2}| = 0$.\n  - $p_{\\text{cons},2} = \\Pr[X \\ge 0]$ for $X \\sim \\text{Hypergeometric}(12, 5, 5)$. This probability is $1$.\n- P-value for $M_{\\text{div,bat},2}$ vs $G_{\\text{comp},2}$:\n  - $n_2 = |M_{\\text{div,bat},2}| = 0$. As per the problem definition, if module size is $0$, the $p$-value is $1$.\n\nTest Case 3:\n- Universe size $N_3 = 7$, selection size $k_3 = 4$, pseudocount $\\epsilon = 0.001$.\n- Bat module $M_{\\text{bat},3}$: The top $4$ genes with positive bias are $\\{\\text{HOXD13}, \\text{GREM1}, \\text{FGF8}, \\text{IGF1}\\}$.\n- Mouse module $M_{\\text{mouse},3}$: The top $4$ genes with positive bias are $\\{\\text{HOXD13}, \\text{GREM1}, \\text{FGF8}, \\text{IGF1}\\}$.\n- Conserved module $M_{\\text{cons},3} = M_{\\text{bat},3} \\cap M_{\\text{mouse},3} = \\{\\text{HOXD13}, \\text{GREM1}, \\text{FGF8}, \\text{IGF1}\\}$.\n- Divergent module $M_{\\text{div,bat},3} = M_{\\text{bat},3} \\setminus M_{\\text{mouse},3} = \\emptyset$.\n- P-value for $M_{\\text{cons},3}$ vs $G_{\\text{elong},3}$:\n  - $N_3 = 7$. $K_1 = |G_{\\text{elong},3}| = 4$. $n_1 = |M_{\\text{cons},3}| = 4$.\n  - Overlap $x_1 = |M_{\\text{cons},3} \\cap G_{\\text{elong},3}| = 4$.\n  - $p_{\\text{cons},3} = \\Pr[X \\ge 4]$ for $X \\sim \\text{Hypergeometric}(7, 4, 4)$. $p = \\frac{\\binom{4}{4}\\binom{3}{0}}{\\binom{7}{4}} = \\frac{1}{35} \\approx 0.028571$.\n- P-value for $M_{\\text{div,bat},3}$ vs $G_{\\text{comp},3}$:\n  - $n_2 = |M_{\\text{div,bat},3}| = 0$. The $p$-value is $1$.\n\nSummary of calculated results:\n- Test Case 1: $p_{\\text{cons}} \\approx 0.010101$, $p_{\\text{div,bat}} = 1.000000$.\n- Test Case 2: $p_{\\text{cons}} = 1.000000$, $p_{\\text{div,bat}} = 1.000000$.\n- Test Case 3: $p_{\\text{cons}} \\approx 0.028571$, $p_{\\text{div,bat}} = 1.000000$.\nThese results will be formatted as required in the final answer.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import hypergeom\n\ndef solve():\n    \"\"\"\n    Solves the bioinformatics problem for a suite of test cases.\n    \"\"\"\n    \n    # Define the fixed parameters for all test cases.\n    epsilon = 1e-3\n\n    test_cases = [\n        {\n            \"U\": ['SHH', 'FGF8', 'BMP2', 'SOX9', 'COL2A1', 'HOXD13', 'IGF1', 'GREM1', 'GLI3', 'RUNX2', 'PTCH1', 'IHH'],\n            \"mu_prox_bat\": np.array([2, 1, 4, 5, 6, 0.5, 1, 0.5, 2, 3, 4, 2]),\n            \"mu_dist_bat\": np.array([12, 10, 3, 4, 5, 8, 7, 6, 3, 2, 4.5, 1.8]),\n            \"mu_prox_mouse\": np.array([2, 1, 4, 5, 6, 0.5, 0.8, 0.5, 1, 3, 4, 2]),\n            \"mu_dist_mouse\": np.array([11, 9, 3, 4, 5, 7, 6, 1.5, 5, 2, 4.3, 1.9]),\n            \"k\": 5,\n            \"G_elong\": {'FGF8', 'HOXD13', 'IGF1', 'GREM1', 'SHH'},\n            \"G_comp\": {'SOX9', 'COL2A1', 'RUNX2', 'IHH'}\n        },\n        {\n            \"U\": ['SHH', 'FGF8', 'BMP2', 'SOX9', 'COL2A1', 'HOXD13', 'IGF1', 'GREM1', 'GLI3', 'RUNX2', 'PTCH1', 'IHH'],\n            \"mu_prox_bat\": np.array([4, 3, 3, 2, 2, 2, 3, 2, 2, 1, 3, 1]),\n            \"mu_dist_bat\": np.array([3.5, 2.4, 10, 8, 9, 1.3, 2.5, 1.5, 2.2, 6, 3.3, 5]),\n            \"mu_prox_mouse\": np.array([4, 3, 3, 2, 2, 2, 3, 2, 2, 1, 3, 1]),\n            \"mu_dist_mouse\": np.array([3.5, 2.4, 11, 9, 8.5, 1.3, 2.2, 1.7, 2.2, 6.2, 3.3, 5.3]),\n            \"k\": 5,\n            \"G_elong\": {'FGF8', 'HOXD13', 'IGF1', 'GREM1', 'SHH'},\n            \"G_comp\": {'SOX9', 'COL2A1', 'RUNX2', 'IHH'}\n        },\n        {\n            \"U\": ['FGF8', 'HOXD13', 'IGF1', 'GREM1', 'SHH', 'GLI3', 'BMP2'],\n            \"mu_prox_bat\": np.array([1, 0.5, 1, 0.5, 2, 2, 3]),\n            \"mu_dist_bat\": np.array([8, 7, 6, 5, 2.5, 1.8, 2.5]),\n            \"mu_prox_mouse\": np.array([1, 0.5, 1, 0.5, 2, 2, 3]),\n            \"mu_dist_mouse\": np.array([8, 7, 6, 5, 2.3, 1.9, 2.6]),\n            \"k\": 4,\n            \"G_elong\": {'FGF8', 'HOXD13', 'IGF1', 'GREM1'},\n            \"G_comp\": {'BMP2', 'GLI3'}\n        }\n    ]\n\n    all_results = []\n\n    def get_module(U, mu_prox, mu_dist, k, epsilon):\n        \"\"\"\n        Calculates the distal-upregulated module for a single species.\n        \"\"\"\n        log_fc = np.log2((mu_dist + epsilon) / (mu_prox + epsilon))\n        \n        # Filter for positive log fold-changes\n        positive_indices = np.where(log_fc > 0)[0]\n        \n        if len(positive_indices) == 0:\n            return set()\n            \n        # Get LFCs and corresponding gene names for positive ones\n        positive_lfc = log_fc[positive_indices]\n        positive_genes = np.array(U)[positive_indices]\n        \n        # Sort by LFC descending\n        sorted_indices = np.argsort(positive_lfc)[::-1]\n        \n        # Select top k genes\n        top_k = min(k, len(sorted_indices))\n        module_genes = positive_genes[sorted_indices][:top_k]\n        \n        return set(module_genes)\n\n    def calculate_p_value(M_module, G_geneset, U_universe):\n        \"\"\"\n        Calculates the one-sided hypergeometric p-value for enrichment.\n        \"\"\"\n        N = len(U_universe)\n        K = len(G_geneset)\n        n = len(M_module)\n        \n        # Per problem statement, if module size is 0, p-value is 1.\n        if n == 0:\n            return 1.0\n            \n        x = len(M_module.intersection(G_geneset))\n        \n        # Using the survival function (sf), Pr[X >= x] is sf(x-1).\n        # sf(k, M, n, N) -- k=successes, M=pop size, n=type I objects, N=draws\n        # scipy.stats.hypergeom(M, n, N) where M=total, n=successes in pop, N=draws\n        # so M=N, n=K, N=n from problem notation\n        p_val = hypergeom.sf(x - 1, N, K, n)\n        \n        return p_val\n\n    for case in test_cases:\n        U = case[\"U\"]\n        k = case[\"k\"]\n        \n        # Step 1 & 2: Get species-specific modules\n        M_bat = get_module(U, case[\"mu_prox_bat\"], case[\"mu_dist_bat\"], k, epsilon)\n        M_mouse = get_module(U, case[\"mu_prox_mouse\"], case[\"mu_dist_mouse\"], k, epsilon)\n        \n        # Step 3: Derive conserved and divergent modules\n        M_cons = M_bat.intersection(M_mouse)\n        M_div_bat = M_bat.difference(M_mouse)\n\n        # Step 4: Perform enrichment analysis\n        p_cons = calculate_p_value(M_cons, case[\"G_elong\"], U)\n        p_div_bat = calculate_p_value(M_div_bat, case[\"G_comp\"], U)\n        \n        all_results.append([p_cons, p_div_bat])\n\n    # Final print statement in the exact required format.\n    # e.g., [[p11,p12],[p21,p22],[p31,p32]] with 6 decimal places.\n    formatted_results = [f\"[{p[0]:.6f},{p[1]:.6f}]\" for p in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2569639"}]}