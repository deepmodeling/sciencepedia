{"hands_on_practices": [{"introduction": "The Hardy-Weinberg principle serves as the fundamental null model in population genetics, describing a state of equilibrium where allele and genotype frequencies remain constant in the absence of evolutionary forces. This practice applies this crucial concept to an empirical dataset, tasking you with a foundational skill in population genetic analysis. By processing raw genotype counts to perform a $\\chi^2$ goodness-of-fit test, you will learn to statistically evaluate whether a population is evolving, which is the essential first step before investigating the specific mechanisms at play [@problem_id:2588582].", "problem": "A bi-allelic, codominant nuclear locus $\\mathcal{L}$ with alleles $A$ and $a$ was genotyped in a diploid, outcrossing, wind-pollinated angiosperm sampled from a single focal population embedded in a metapopulation with ongoing gene flow. The observed genotype counts in a random sample of $N=84$ individuals are $n_{AA}=59$, $n_{Aa}=23$, and $n_{aa}=2$. Assume no null alleles, no genotyping error, and that the population can be evaluated for Hardy–Weinberg equilibrium (HWE).\n\nStarting only from core definitions of allele frequencies, genotype frequencies under HWE, and the Pearson's $\\chi^2$ goodness-of-fit framework, do the following:\n- Compute the sample allele frequencies for $A$ and $a$.\n- Using those allele frequencies, write down the expected HWE genotype proportions and the corresponding expected genotype counts.\n- To test HWE with one degree of freedom, pool the two homozygote classes into a single “homozygotes” category and compare “heterozygotes” versus “homozygotes.” Compute the Yates continuity-corrected $\\chi^2$ test statistic appropriate for a two-category goodness-of-fit assessment with estimated expectations.\n\nReport only the value of the Yates continuity-corrected $\\chi^2$ test statistic. Round your answer to four significant figures. Do not report intermediate values. No units are required for the final answer.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n-   Locus type: Bi-allelic, codominant nuclear locus $\\mathcal{L}$ with alleles $A$ and $a$.\n-   Sampled organism: Diploid, outcrossing, wind-pollinated angiosperm.\n-   Population context: A single focal population within a metapopulation experiencing gene flow.\n-   Sample size: $N = 84$ individuals.\n-   Observed genotype counts: $n_{AA} = 59$, $n_{Aa} = 23$, $n_{aa} = 2$.\n-   Assumptions: No null alleles, no genotyping error.\n-   Task: Evaluate for Hardy–Weinberg equilibrium (HWE).\n-   Methodology specified:\n    1.  Compute sample allele frequencies for $A$ and $a$.\n    2.  Compute expected HWE genotype proportions and counts from these allele frequencies.\n    3.  Pool homozygote classes ($AA$ and $aa$) into a \"homozygotes\" category to compare against the \"heterozygotes\" category.\n    4.  Compute the Yates continuity-corrected $\\chi^2$ test statistic for a two-category goodness-of-fit test with one degree of freedom.\n-   Output requirement: Report the final value of the Yates continuity-corrected $\\chi^2$ statistic, rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, employing standard concepts and methodologies from population genetics, namely allele and genotype frequency calculation, the Hardy–Weinberg principle, and the Pearson $\\chi^2$ goodness-of-fit test. The data are self-contained and consistent, as the sum of genotype counts equals the total sample size ($59 + 23 + 2 = 84$). The language is objective and precise. The instructions for pooling categories and applying the Yates correction make the problem well-posed, leading to a unique solution. The scenario is biologically realistic. The problem is valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\nThe solution proceeds by following the specified methodology.\n\nFirst, we compute the frequencies of alleles $A$ and $a$ from the sample genotype counts. Let $p$ be the frequency of allele $A$ and $q$ be the frequency of allele $a$. The total number of alleles in the sample of $N$ diploid individuals is $2N$.\n\nThe total number of $A$ alleles is given by $2n_{AA} + n_{Aa}$. The total number of $a$ alleles is given by $2n_{aa} + n_{Aa}$.\nThe total sample size is $N = n_{AA} + n_{Aa} + n_{aa} = 59 + 23 + 2 = 84$.\nThe total number of alleles is $2N = 2 \\times 84 = 168$.\n\nThe frequency of allele $A$, denoted $p$, is:\n$$p = \\frac{2n_{AA} + n_{Aa}}{2N} = \\frac{2(59) + 23}{168} = \\frac{118 + 23}{168} = \\frac{141}{168}$$\nThe frequency of allele $a$, denoted $q$, is:\n$$q = \\frac{2n_{aa} + n_{Aa}}{2N} = \\frac{2(2) + 23}{168} = \\frac{4 + 23}{168} = \\frac{27}{168}$$\nAs a check, $p + q = \\frac{141}{168} + \\frac{27}{168} = \\frac{168}{168} = 1$. The frequencies are correct. For calculation, we simplify these fractions: $p = \\frac{47}{56}$ and $q = \\frac{9}{56}$.\n\nNext, we establish the observed and expected counts for the two categories specified: \"homozygotes\" and \"heterozygotes\".\n\nThe observed count of homozygotes is the sum of the counts for genotypes $AA$ and $aa$:\n$$O_{hom} = n_{AA} + n_{aa} = 59 + 2 = 61$$\nThe observed count of heterozygotes is the count for genotype $Aa$:\n$$O_{het} = n_{Aa} = 23$$\nThe sum of observed counts is $O_{hom} + O_{het} = 61 + 23 = 84$, which is the total sample size $N$.\n\nUnder the hypothesis of Hardy–Weinberg equilibrium, the expected frequencies of the homozygote and heterozygote categories are $p^2 + q^2$ and $2pq$, respectively. The expected counts are these frequencies multiplied by the total sample size $N$.\n\nThe expected count of homozygotes is:\n$$E_{hom} = N(p^2 + q^2) = 84 \\left( \\left(\\frac{47}{56}\\right)^2 + \\left(\\frac{9}{56}\\right)^2 \\right) = 84 \\left( \\frac{2209}{3136} + \\frac{81}{3136} \\right) = 84 \\left( \\frac{2290}{3136} \\right)$$\nSince $3136 = 56^2$ and $84 = 1.5 \\times 56$, we have:\n$$E_{hom} = \\frac{84 \\times 2290}{56 \\times 56} = \\frac{1.5 \\times 2290}{56} = \\frac{3435}{56}$$\n\nThe expected count of heterozygotes is:\n$$E_{het} = N(2pq) = 84 \\left( 2 \\cdot \\frac{47}{56} \\cdot \\frac{9}{56} \\right) = 84 \\left( \\frac{846}{3136} \\right)$$\n$$E_{het} = \\frac{84 \\times 846}{56 \\times 56} = \\frac{1.5 \\times 846}{56} = \\frac{1269}{56}$$\nAs a check, $E_{hom} + E_{het} = \\frac{3435}{56} + \\frac{1269}{56} = \\frac{4704}{56} = 84 = N$. The expected counts are correct.\n\nFinally, we compute the Yates continuity-corrected $\\chi^2$ statistic ($\\chi^2_{Yates}$) for the two categories. The formula is:\n$$\\chi^2_{Yates} = \\sum_{i} \\frac{(|O_i - E_i| - 0.5)^2}{E_i}$$\nFor our two categories, this is:\n$$\\chi^2_{Yates} = \\frac{(|O_{hom} - E_{hom}| - 0.5)^2}{E_{hom}} + \\frac{(|O_{het} - E_{het}| - 0.5)^2}{E_{het}}$$\nWe compute the difference $|O - E|$:\n$$|O_{hom} - E_{hom}| = \\left| 61 - \\frac{3435}{56} \\right| = \\left| \\frac{61 \\times 56 - 3435}{56} \\right| = \\left| \\frac{3416 - 3435}{56} \\right| = \\left| -\\frac{19}{56} \\right| = \\frac{19}{56}$$\nThe magnitude of the difference for the heterozygote category must be the same:\n$$|O_{het} - E_{het}| = \\left| 23 - \\frac{1269}{56} \\right| = \\left| \\frac{23 \\times 56 - 1269}{56} \\right| = \\left| \\frac{1288 - 1269}{56} \\right| = \\left| \\frac{19}{56} \\right| = \\frac{19}{56}$$\nThe numerator for each term in the $\\chi^2$ sum is $(|O - E| - 0.5)^2$:\n$$\\left( \\frac{19}{56} - 0.5 \\right)^2 = \\left( \\frac{19}{56} - \\frac{28}{56} \\right)^2 = \\left( -\\frac{9}{56} \\right)^2 = \\frac{81}{3136}$$\nNow we assemble the $\\chi^2$ statistic:\n$$\\chi^2_{Yates} = \\frac{81/3136}{3435/56} + \\frac{81/3136}{1269/56}$$\n$$\\chi^2_{Yates} = \\frac{81}{3136} \\left( \\frac{56}{3435} + \\frac{56}{1269} \\right) = \\frac{81 \\times 56}{3136} \\left( \\frac{1}{3435} + \\frac{1}{1269} \\right)$$\nSince $3136 = 56^2$:\n$$\\chi^2_{Yates} = \\frac{81}{56} \\left( \\frac{1269 + 3435}{3435 \\times 1269} \\right) = \\frac{81}{56} \\left( \\frac{4704}{4359015} \\right)$$\nRecognizing that $4704 = 84 \\times 56$:\n$$\\chi^2_{Yates} = \\frac{81}{56} \\frac{84 \\times 56}{4359015} = \\frac{81 \\times 84}{4359015} = \\frac{6804}{4359015}$$\nPerforming the division gives the numerical value:\n$$\\chi^2_{Yates} \\approx 0.0015609503$$\nRounding to four significant figures, we obtain $0.001561$.", "answer": "$$\\boxed{0.001561}$$", "id": "2588582"}, {"introduction": "Natural selection is a primary driver of evolution, causing predictable changes in allele frequencies based on differential fitness. This exercise guides you through a classic model of negative frequency-dependent selection, a powerful mechanism where a rare allele has a fitness advantage. By deriving the conditions that lead to a protected polymorphism and solving for the stable equilibrium frequency, you will build an analytical understanding of how selection can actively maintain genetic diversity within a population [@problem_id:2588599].", "problem": "In a comparative zoology and botany context, consider two alternative heritable color morphs, allele $A$ and allele $a$, expressed in a haploid organism. Assume selection arises from negative frequency-dependent interactions that are comparable across animal prey with bird predators (search images) and flowering plants with pollinators (novelty preference). Specifically, suppose that the absolute Wrightian fitnesses of $A$ and $a$ are linear functions of the current frequency $p$ of $A$ in the population:\n$$\nw_{A}(p) \\equiv 1 - \\alpha p, \\quad w_{a}(p) \\equiv 1 - \\beta (1 - p),\n$$\nwhere $\\alpha > 0$ and $\\beta > 0$ parameterize how strongly each morph’s fitness declines with its own frequency due to recognition or exploitation by interacting species. Assume discrete, non-overlapping generations, haploid inheritance, random mating (or random union of gametes), and no mutation, no migration (no gene flow), and no genetic drift (deterministic dynamics with effectively infinite population size). Let $p_{t}$ denote the frequency of $A$ at generation $t$.\n\nUsing only core definitions of Wrightian fitness, mean fitness, and the standard haploid selection recursion that relates $p_{t+1}$ to $p_{t}$ via relative fitness, do the following:\n\n1. Derive the deterministic recursion for $p_{t+1}$ as a function of $p_{t}$, $w_{A}(p_{t})$, and $w_{a}(p_{t})$, making explicit the mean fitness $\\bar{w}(p_{t})$.\n\n2. Using the definition that a protected polymorphism occurs if each allele increases in frequency when rare, derive necessary and sufficient conditions on $\\alpha$ and $\\beta$ for a protected polymorphism.\n\n3. Solve for the internal equilibrium allele frequency $p^{\\ast} \\in (0,1)$ in terms of $\\alpha$ and $\\beta$ and justify its local stability under the deterministic dynamics you derived.\n\nExpress your final answer as a single closed-form algebraic expression for the stable internal equilibrium allele frequency $p^{\\ast}$, with no units. If you perform any approximations, they must be exact algebraic simplifications; no numerical rounding is required.", "solution": "The problem statement is subjected to validation and is found to be valid. It is a well-posed, scientifically grounded problem in theoretical population genetics, free of contradiction, ambiguity, or factual error. It presents a standard model of negative frequency-dependent selection. We may proceed with the solution.\n\nThe problem requires a three-part derivation concerning the dynamics of two alleles, $A$ and $a$, in a haploid population under selection. Let $p$ be the frequency of allele $A$, and $1-p$ be the frequency of allele $a$. The absolute Wrightian fitnesses are given as frequency-dependent functions:\n$$\nw_{A}(p) = 1 - \\alpha p\n$$\n$$\nw_{a}(p) = 1 - \\beta (1 - p)\n$$\nwhere the parameters $\\alpha$ and $\\beta$ are positive constants, $\\alpha > 0$ and $\\beta > 0$. The analysis assumes discrete generations, an effectively infinite population size, and the absence of mutation and migration.\n\n1. Derivation of the recursion for $p_{t+1}$.\n\nIn a haploid population, the frequency of an allele in the subsequent generation ($t+1$) is determined by its frequency in the current generation ($t$) and its relative fitness. The frequency of allele $A$ in generation $t+1$, denoted $p_{t+1}$, is the proportion of $A$ alleles among all alleles in the gene pool after selection. This is given by the frequency of $A$ in generation $t$, $p_t$, multiplied by its absolute fitness, $w_{A}(p_{t})$, divided by the mean fitness of the population, $\\bar{w}(p_{t})$.\n\nThe mean fitness, $\\bar{w}(p_{t})$, is the weighted average of the fitnesses of the two alleles, where the weights are their frequencies:\n$$\n\\bar{w}(p_{t}) = p_{t} w_{A}(p_{t}) + (1 - p_{t}) w_{a}(p_{t})\n$$\nSubstituting the given fitness functions:\n$$\n\\bar{w}(p_{t}) = p_{t}(1 - \\alpha p_{t}) + (1 - p_{t})(1 - \\beta (1 - p_{t}))\n$$\nThis expression represents the average fitness of an individual in the population at generation $t$.\n\nThe recursion for $p_{t+1}$ is therefore:\n$$\np_{t+1} = \\frac{p_{t} w_{A}(p_{t})}{\\bar{w}(p_{t})}\n$$\nSubstituting the explicit forms for the fitness functions, the complete recursion is:\n$$\np_{t+1} = \\frac{p_{t}(1 - \\alpha p_{t})}{p_{t}(1 - \\alpha p_{t}) + (1 - p_{t})(1 - \\beta(1-p_{t}))}\n$$\nThis is the required deterministic recursion for the allele frequency.\n\n2. Conditions for a protected polymorphism.\n\nA protected polymorphism is a state where both alleles are maintained in the population because each allele can increase in frequency when it is rare. This requires two conditions to be met simultaneously:\n(i) Allele $A$ must increase in frequency when it is rare (i.e., as $p \\to 0$).\n(ii) Allele $a$ must increase in frequency when it is rare (i.e., as $p \\to 1$).\n\nAllele $A$ will increase in frequency if individuals carrying it have a higher fitness than the population average, i.e., if $w_{A}(p) > \\bar{w}(p)$. Substituting the definition of $\\bar{w}(p)$, this is equivalent to $w_{A}(p) > p w_{A}(p) + (1-p) w_{a}(p)$, which simplifies to $w_{A}(p) > w_{a}(p)$ (for $p \\in [0, 1)$).\n\nFor condition (i), we evaluate this inequality as $p \\to 0$:\n$$\nw_{A}(0) > w_{a}(0)\n$$\nUsing the given fitness functions:\n$$\nw_{A}(0) = 1 - \\alpha(0) = 1\n$$\n$$\nw_{a}(0) = 1 - \\beta(1-0) = 1 - \\beta\n$$\nThe condition becomes $1 > 1 - \\beta$, which simplifies to $\\beta > 0$.\n\nFor condition (ii), allele $a$ must increase in frequency when rare. This means its frequency, $1-p$, must increase when $1-p \\to 0$, which is equivalent to $p \\to 1$. This occurs if individuals with allele $a$ have higher fitness than the population average, $w_{a}(p) > \\bar{w}(p)$, which is equivalent to $w_{a}(p) > w_{A}(p)$. We evaluate this at $p \\to 1$:\n$$\nw_{a}(1) > w_{A}(1)\n$$\nUsing the fitness functions:\n$$\nw_{a}(1) = 1 - \\beta(1-1) = 1\n$$\n$$\nw_{A}(1) = 1 - \\alpha(1) = 1 - \\alpha\n$$\nThe condition becomes $1 > 1 - \\alpha$, which simplifies to $\\alpha > 0$.\n\nThe problem statement provides $\\alpha > 0$ and $\\beta > 0$ as givens. However, a complete description of the parameter space must also ensure that the model is biologically sensible. Absolute fitness cannot be negative. Thus, we must enforce $w_{A}(p) \\ge 0$ and $w_{a}(p) \\ge 0$ for all $p \\in [0,1]$.\nThe function $w_{A}(p) = 1 - \\alpha p$ is monotonically decreasing with $p$. Its minimum value on the interval $[0,1]$ is at $p=1$, where $w_{A}(1) = 1 - \\alpha$. The constraint $w_{A}(1) \\ge 0$ implies $1 - \\alpha \\ge 0$, or $\\alpha \\le 1$.\nThe function $w_{a}(p) = 1 - \\beta(1-p)$ is monotonically increasing with $p$. Its minimum value on $[0,1]$ is at $p=0$, where $w_{a}(0) = 1 - \\beta$. The constraint $w_{a}(0) \\ge 0$ implies $1 - \\beta \\ge 0$, or $\\beta \\le 1$.\n\nTherefore, the necessary and sufficient conditions on the parameters $\\alpha$ and $\\beta$ for a biologically meaningful protected polymorphism are that both alleles invade when rare ($\\alpha > 0, \\beta > 0$) and fitness remains non-negative ($ \\alpha \\le 1, \\beta \\le 1$). The combined conditions are $0 < \\alpha \\le 1$ and $0 < \\beta \\le 1$.\n\n3. Internal equilibrium and its stability.\n\nAn equilibrium frequency, $p^{\\ast}$, is a value of $p$ for which the allele frequency does not change from one generation to the next, i.e., $p_{t+1} = p_{t} = p^{\\ast}$. The frequencies $p=0$ and $p=1$ are always trivial equilibria. We seek an internal equilibrium, where $0 < p^{\\ast} < 1$.\nFor such an equilibrium, the recursion $p^{\\ast} = \\frac{p^{\\ast} w_{A}(p^{\\ast})}{\\bar{w}(p^{\\ast})}$ must hold. Since $p^{\\ast} \\ne 0$, we can divide by it to get $1 = \\frac{w_{A}(p^{\\ast})}{\\bar{w}(p^{\\ast})}$, which implies $\\bar{w}(p^{\\ast}) = w_{A}(p^{\\ast})$.\nSubstituting the definition of $\\bar{w}(p^{\\ast})$ gives $p^{\\ast}w_{A}(p^{\\ast}) + (1-p^{\\ast})w_{a}(p^{\\ast}) = w_{A}(p^{\\ast})$.\nThis simplifies to $(1-p^{\\ast})w_{a}(p^{\\ast}) = (1-p^{\\ast})w_{A}(p^{\\ast})$. Since $p^{\\ast} \\ne 1$, we can divide by $(1-p^{\\ast})$ to obtain the general condition for an internal selecton equilibrium:\n$$\nw_{A}(p^{\\ast}) = w_{a}(p^{\\ast})\n$$\nAt this frequency, the fitnesses of the two alleles are equal. Substituting the given functions:\n$$\n1 - \\alpha p^{\\ast} = 1 - \\beta(1 - p^{\\ast})\n$$\n$$\n-\\alpha p^{\\ast} = -\\beta(1 - p^{\\ast})\n$$\n$$\n\\alpha p^{\\ast} = \\beta - \\beta p^{\\ast}\n$$\n$$\n\\alpha p^{\\ast} + \\beta p^{\\ast} = \\beta\n$$\n$$\np^{\\ast}(\\alpha + \\beta) = \\beta\n$$\nSince $\\alpha > 0$ and $\\beta > 0$, $(\\alpha + \\beta)$ is non-zero, and we can solve for $p^{\\ast}$:\n$$\np^{\\ast} = \\frac{\\beta}{\\alpha + \\beta}\n$$\nThis is the unique internal equilibrium frequency. For $\\alpha > 0$ and $\\beta > 0$, it is clear that $0 < p^{\\ast} < 1$.\n\nTo justify the stability of this equilibrium, we examine the change in allele frequency, $\\Delta p = p_{t+1} - p_t$. The sign of $\\Delta p$ is determined by the sign of $w_A(p) - w_a(p)$. Let's analyze this difference:\n$$\ng(p) = w_{A}(p) - w_{a}(p) = (1 - \\alpha p) - (1 - \\beta(1-p)) = \\beta - (\\alpha + \\beta)p\n$$\nThe allele frequency $p$ will increase if $g(p) > 0$ and decrease if $g(p) < 0$.\n- If $p < p^{\\ast} = \\frac{\\beta}{\\alpha+\\beta}$, then $(\\alpha+\\beta)p < \\beta$, so $g(p) = \\beta - (\\alpha+\\beta)p > 0$. Thus, $p$ will increase towards $p^{\\ast}$.\n- If $p > p^{\\ast} = \\frac{\\beta}{\\alpha+\\beta}$, then $(\\alpha+\\beta)p > \\beta$, so $g(p) = \\beta - (\\alpha+\\beta)p < 0$. Thus, $p$ will decrease towards $p^{\\ast}$.\n\nBecause the allele frequency always moves towards $p^{\\ast}$ from any other starting frequency in $(0,1)$, the equilibrium $p^{\\ast}$ is locally stable. In fact, this analysis demonstrates global stability within the interval $(0,1)$. This is the expected outcome for a system with negative frequency-dependent selection, where the rare allele always has a fitness advantage, driving the population to a balanced intermediate frequency.", "answer": "$$\n\\boxed{\\frac{\\beta}{\\alpha + \\beta}}\n$$", "id": "2588599"}, {"introduction": "Allele frequencies in any finite population are subject to random sampling effects, a pervasive evolutionary process known as genetic drift. This computational challenge allows you to directly explore the stochastic nature of drift by building a simulation of the foundational Wright-Fisher model. By deriving the theoretical expectations for the change in variance over time and comparing these predictions to your simulation output, you will gain a robust, quantitative intuition for how population size governs the random loss of genetic variation [@problem_id:2588608].", "problem": "You are asked to connect fundamental population-genetic definitions to algorithmic validation by deriving and implementing a neutral drift benchmark that links the discrete-generation Wright–Fisher process and its continuous-time diffusion approximation. Work in the standard, neutral, diploid Wright–Fisher setting with constant population size.\n\nUse only the following fundamental base:\n- Discrete-generation neutrality and random genetic drift: in a diploid population of size $N$, there are $2N$ gene copies. Under neutrality and random mating without selection, mutation, or migration, the allele frequency $p_{t}$ at generation $t$ evolves by sampling $X_{t+1} \\sim \\mathrm{Binomial}(2N, p_{t})$ and setting $p_{t+1} = X_{t+1}/(2N)$.\n- Law of total expectation and law of total variance.\n- Diffusion approximation for neutral Wright–Fisher dynamics: in the large-$N$ limit, $p(t)$ solves a stochastic differential equation (SDE) with infinitesimal variance proportional to $p(t) \\left(1 - p(t)\\right)/(2N)$; from this, derive the ordinary differential equation for the second moment and thus for the variance.\n\nTasks to complete:\n1. From the above base, derive the discrete-time recursions for the mean and variance of $p_{t}$ under neutrality, and solve them in closed form. State the resulting expressions for $\\mathbb{E}[p_{t}]$ and $\\mathrm{Var}(p_{t})$ as functions of $t$, $N$, and $p_{0}$.\n2. From the diffusion approximation base, derive the continuous-time equation for $\\mathrm{Var}(p(t))$ and solve it in closed form as a function of $t$, $N$, and $p_{0}$. State the resulting expression.\n3. Design a minimal simulation to quantify stochastic allele frequency paths under drift and to validate the diffusion result against the discrete-generation prediction. For each parameter set, simulate $R$ independent replicate paths of length $T$ generations of the neutral Wright–Fisher process starting from $p_{0}$, and compute across replicates at each generation $t \\in \\{1,\\dots,T\\}$:\n   - the sample mean $\\widehat{m}(t)$,\n   - the sample variance $\\widehat{v}(t)$.\n   Then compute the following three scalar summary diagnostics:\n   - $E_{\\mathrm{mean}} = \\max_{1 \\le t \\le T} \\left| \\widehat{m}(t) - p_{0} \\right|$,\n   - $E_{\\mathrm{disc}} = \\max_{1 \\le t \\le T} \\left| \\widehat{v}(t) - v_{\\mathrm{disc}}(t) \\right|$, where $v_{\\mathrm{disc}}(t)$ is your closed-form discrete-time variance from Task $1$,\n   - $E_{\\mathrm{diff}} = \\left| v_{\\mathrm{diff}}(T) - v_{\\mathrm{disc}}(T) \\right|$, where $v_{\\mathrm{diff}}(t)$ is your closed-form diffusion variance from Task $2$.\n4. Determinism requirement: use a fixed pseudorandom seed to make results reproducible.\n5. All probabilities and frequencies must be expressed as decimals in $[0,1]$.\n\nTest suite and acceptance thresholds:\nImplement your program to run the following three parameter sets. Each set is given as a tuple $(N, T, p_{0}, R, \\varepsilon_{\\mathrm{mean}}, \\varepsilon_{\\mathrm{var}}, \\tau)$, where $\\varepsilon_{\\mathrm{mean}}$ and $\\varepsilon_{\\mathrm{var}}$ are acceptance thresholds for $E_{\\mathrm{mean}}$ and $E_{\\mathrm{disc}}$, respectively, and $\\tau$ is the acceptance threshold for $E_{\\mathrm{diff}}$ at time $T$.\n- Case A (large population, moderate time, intermediate frequency): $(N, T, p_{0}, R, \\varepsilon_{\\mathrm{mean}}, \\varepsilon_{\\mathrm{var}}, \\tau) = ($$1000$$, $$50$$, $$0.3$$, $$12000$$, $$0.005$$, $$0.001$$, $$1 \\times 10^{-4}$$)$.\n- Case B (small population, moderate time, symmetric frequency): $(N, T, p_{0}, R, \\varepsilon_{\\mathrm{mean}}, \\varepsilon_{\\mathrm{var}}, \\tau) = ($$20$$, $$50$$, $$0.5$$, $$20000$$, $$0.01$$, $$0.01$$, $$0.005$$)$.\n- Case C (moderate population, long time, rare allele): $(N, T, p_{0}, R, \\varepsilon_{\\mathrm{mean}}, \\varepsilon_{\\mathrm{var}}, \\tau) = ($$100$$, $$200$$, $$0.01$$, $$15000$$, $$0.005$$, $$0.001$$, $$1 \\times 10^{-4}$$)$.\n\nProgram requirements:\n- Implement the simulation and the two closed-form predictions you derived.\n- For each case, compute the three diagnostics $E_{\\mathrm{mean}}$, $E_{\\mathrm{disc}}$, and $E_{\\mathrm{diff}}$, and then return a single boolean per case indicating whether all three criteria are simultaneously satisfied:\n  - $E_{\\mathrm{mean}} \\le \\varepsilon_{\\mathrm{mean}}$,\n  - $E_{\\mathrm{disc}} \\le \\varepsilon_{\\mathrm{var}}$,\n  - $E_{\\mathrm{diff}} \\le \\tau$.\n- Use a fixed seed for the pseudorandom number generator.\n- Final output format: Your program should produce a single line of output containing the three booleans for Cases A, B, and C, as a comma-separated list enclosed in square brackets (for example, `[True, False, True]`). No additional text should be printed.\n\nNo physical units are involved. All outputs must be booleans. Angles are not used. Express all probabilities and frequencies as decimals in $[0,1]$.", "solution": "The problem statement is a valid, well-posed exercise in theoretical and computational population genetics. It requires the derivation of fundamental results for the Wright-Fisher model of genetic drift and their validation through stochastic simulation. The problem is scientifically sound, internally consistent, and contains all necessary information to proceed.\n\nI will now provide the step-by-step derivations and a description of the simulation design as required.\n\n**Task 1: Discrete-Time Wright–Fisher Model Analysis**\n\nWe are given a diploid population of constant size $N$. The allele frequency $p_t$ at generation $t$ evolves according to the rule $p_{t+1} = X_{t+1}/(2N)$, where the number of 'A' alleles in the next generation, $X_{t+1}$, is drawn from a binomial distribution $X_{t+1} \\sim \\mathrm{Binomial}(2N, p_t)$. The process starts from a fixed initial frequency $p_0$.\n\n**Derivation of the Mean Allele Frequency $\\mathbb{E}[p_t]$**\n\nWe use the law of total expectation: $\\mathbb{E}[p_{t+1}] = \\mathbb{E}[\\mathbb{E}[p_{t+1} | p_t]]$.\nFirst, we find the conditional expectation of $p_{t+1}$ given $p_t$.\n$$\n\\mathbb{E}[p_{t+1} | p_t] = \\mathbb{E}\\left[\\frac{X_{t+1}}{2N} \\bigg| p_t\\right] = \\frac{1}{2N} \\mathbb{E}[X_{t+1} | p_t]\n$$\nThe expectation of a binomial random variable $\\mathrm{Binomial}(n, p)$ is $np$. Here, $n=2N$ and the probability is $p_t$.\n$$\n\\mathbb{E}[X_{t+1} | p_t] = (2N) p_t\n$$\nSubstituting this into the expression for $\\mathbb{E}[p_{t+1} | p_t]$:\n$$\n\\mathbb{E}[p_{t+1} | p_t] = \\frac{1}{2N} (2N p_t) = p_t\n$$\nNow, applying the outer expectation:\n$$\n\\mathbb{E}[p_{t+1}] = \\mathbb{E}[p_t]\n$$\nThis is a simple recurrence relation. By induction, and using the initial condition $\\mathbb{E}[p_0] = p_0$ (since $p_0$ is a given constant), we find that the mean allele frequency is constant over time.\n$$\n\\mathbb{E}[p_t] = p_0\n$$\n\n**Derivation of the Variance of Allele Frequency $\\mathrm{Var}(p_t)$**\n\nWe use the law of total variance: $\\mathrm{Var}(p_{t+1}) = \\mathbb{E}[\\mathrm{Var}(p_{t+1} | p_t)] + \\mathrm{Var}(\\mathbb{E}[p_{t+1} | p_t])$.\nFrom our previous derivation, we know $\\mathbb{E}[p_{t+1} | p_t] = p_t$. The second term is therefore $\\mathrm{Var}(p_t)$.\nFor the first term, we need the conditional variance $\\mathrm{Var}(p_{t+1} | p_t)$. The variance of a binomial random variable $\\mathrm{Binomial}(n, p)$ is $np(1-p)$.\n$$\n\\mathrm{Var}(p_{t+1} | p_t) = \\mathrm{Var}\\left(\\frac{X_{t+1}}{2N} \\bigg| p_t\\right) = \\frac{1}{(2N)^2} \\mathrm{Var}(X_{t+1} | p_t) = \\frac{2N p_t(1-p_t)}{4N^2} = \\frac{p_t(1-p_t)}{2N}\n$$\nNow, we take the expectation of this conditional variance over the distribution of $p_t$:\n$$\n\\mathbb{E}[\\mathrm{Var}(p_{t+1} | p_t)] = \\mathbb{E}\\left[\\frac{p_t(1-p_t)}{2N}\\right] = \\frac{1}{2N}\\left(\\mathbb{E}[p_t] - \\mathbb{E}[p_t^2]\\right)\n$$\nWe know $\\mathbb{E}[p_t] = p_0$ and $\\mathbb{E}[p_t^2] = \\mathrm{Var}(p_t) + (\\mathbb{E}[p_t])^2 = \\mathrm{Var}(p_t) + p_0^2$. Substituting these in:\n$$\n\\mathbb{E}[\\mathrm{Var}(p_{t+1} | p_t)] = \\frac{1}{2N}\\left(p_0 - (\\mathrm{Var}(p_t) + p_0^2)\\right) = \\frac{p_0(1-p_0) - \\mathrm{Var}(p_t)}{2N}\n$$\nCombining both parts in the law of total variance, we obtain a recurrence for $v_t = \\mathrm{Var}(p_t)$:\n$$\nv_{t+1} = \\frac{p_0(1-p_0) - v_t}{2N} + v_t = \\left(1 - \\frac{1}{2N}\\right)v_t + \\frac{p_0(1-p_0)}{2N}\n$$\nThis is a linear first-order recurrence relation with initial condition $v_0 = \\mathrm{Var}(p_0) = 0$. The solution is found by observing that the fixed point is $v^* = p_0(1-p_0)$. The deviation from the fixed point decays geometrically: $v_{t+1} - v^* = (1 - 1/(2N))(v_t - v^*)$. Unrolling the recursion gives $v_t - v^* = (1-1/(2N))^t(v_0 - v^*)$.\nWith $v_0=0$, this gives $v_t = v^*(1 - (1-1/(2N))^t)$.\nThe closed-form solution for the discrete-time variance is:\n$$\nv_{\\mathrm{disc}}(t) = p_0(1-p_0)\\left[1 - \\left(1 - \\frac{1}{2N}\\right)^t\\right]\n$$\n\n**Task 2: Diffusion Approximation Analysis**\n\nThe continuous-time diffusion approximation for the Wright-Fisher process is described by a stochastic differential equation (SDE) where the infinitesimal variance is given as $\\sigma^2(p) = p(1-p)/(2N)$, and the infinitesimal drift is $\\mu(p)=0$. To find the evolution of the variance, we first find the dynamics of the second moment, $m_2(t) = \\mathbb{E}[p(t)^2]$, using the corresponding forward Kolmogorov equation. For any smooth function $f(p)$, its expectation $\\mathbb{E}[f(p(t))]$ evolves as:\n$$\n\\frac{d}{dt}\\mathbb{E}[f(p)] = \\mathbb{E}\\left[\\mu(p) \\frac{\\partial f}{\\partial p} + \\frac{1}{2}\\sigma^2(p) \\frac{\\partial^2 f}{\\partial p^2}\\right]\n$$\nLet's choose $f(p) = p^2$. Then $\\frac{\\partial f}{\\partial p}=2p$ and $\\frac{\\partial^2 f}{\\partial p^2}=2$.\n$$\n\\frac{d}{dt}\\mathbb{E}[p^2] = \\mathbb{E}\\left[0 \\cdot (2p) + \\frac{1}{2}\\frac{p(1-p)}{2N} \\cdot 2\\right] = \\mathbb{E}\\left[\\frac{p(1-p)}{2N}\\right] = \\frac{1}{2N}\\left(\\mathbb{E}[p] - \\mathbb{E}[p^2]\\right)\n$$\nAs in the discrete case, $\\mathbb{E}[p(t)] = p_0$. Letting $m_2(t) = \\mathbb{E}[p(t)^2]$, we have the ordinary differential equation:\n$$\n\\frac{dm_2}{dt} = \\frac{1}{2N}(p_0 - m_2)\n$$\nThis is a linear first-order ODE, which can be rearranged to $\\frac{dm_2}{dt} + \\frac{1}{2N}m_2 = \\frac{p_0}{2N}$. The solution, subject to the initial condition $m_2(0) = \\mathbb{E}[p_0^2] = p_0^2$, is:\n$$\nm_2(t) = p_0 - p_0(1-p_0)e^{-t/(2N)}\n$$\nThe variance, $v_{\\mathrm{diff}}(t) = \\mathrm{Var}(p(t))$, is then found by:\n$$\nv_{\\mathrm{diff}}(t) = \\mathbb{E}[p(t)^2] - (\\mathbb{E}[p(t)])^2 = m_2(t) - p_0^2\n$$\n$$\nv_{\\mathrm{diff}}(t) = \\left(p_0 - p_0(1-p_0)e^{-t/(2N)}\\right) - p_0^2 = p_0(1-p_0) - p_0(1-p_0)e^{-t/(2N)}\n$$\nThis gives the closed-form solution for the variance under the diffusion approximation:\n$$\nv_{\\mathrm{diff}}(t) = p_0(1-p_0)\\left(1 - e^{-t/(2N)}\\right)\n$$\n\n**Task 3: Simulation and Validation Logic**\n\nThe implementation will follow a direct simulation of the discrete process. For each test case $(N, T, p_0, R, ...)$, we execute the following steps:\n1.  **Reproducibility**: A fixed seed is set for the pseudorandom number generator to ensure the results are deterministic.\n2.  **Simulation**: $R$ independent population paths are simulated for $T$ generations. An array of size $(R, T+1)$ is initialized, with the first column set to $p_0$. Then, for each generation $t$ from $0$ to $T-1$, the allele counts for generation $t+1$ for all $R$ replicates are drawn simultaneously from a binomial distribution, $\\mathrm{Binomial}(2N, \\mathbf{p}_t)$, where $\\mathbf{p}_t$ is the vector of frequencies at time $t$ for all replicates. The frequencies are then updated. This vectorized approach is computationally efficient.\n3.  **Analysis**: After the simulation, theoretical and sample statistics are computed.\n    -   The theoretical variance predictions, $v_{\\mathrm{disc}}(t)$ and $v_{\\mathrm{diff}}(t)$, are calculated for all $t \\in \\{0, \\dots, T\\}$ using the derived formulae.\n    -   The sample mean $\\widehat{m}(t)$ and sample variance $\\widehat{v}(t)$ are calculated across the $R$ replicates for each time step.\n4.  **Diagnostics**: Three error metrics are computed.\n    -   $E_{\\mathrm{mean}} = \\max_{1 \\le t \\le T} \\left| \\widehat{m}(t) - p_{0} \\right|$: measures the maximum deviation of the empirical mean from the theoretical constant mean. This confirms the unbiasedness of the drift process.\n    -   $E_{\\mathrm{disc}} = \\max_{1 \\le t \\le T} \\left| \\widehat{v}(t) - v_{\\mathrm{disc}}(t) \\right|$: measures the maximum deviation of the empirical variance from the exact discrete theory. This validates the simulation's accuracy.\n    -   $E_{\\mathrm{diff}} = \\left| v_{\\mathrm{diff}}(T) - v_{\\mathrm{disc}}(T) \\right|$: measures the approximation error of the diffusion model relative to the discrete model at the final generation. This is a purely theoretical comparison.\n5.  **Validation**: For each test case, the computed metrics are tested against the provided thresholds: $E_{\\mathrm{mean}} \\le \\varepsilon_{\\mathrm{mean}}$, $E_{\\mathrm{disc}} \\le \\varepsilon_{\\mathrm{var}}$, and $E_{\\mathrm{diff}} \\le \\tau$. The final result for the case is `True` if all three inequalities hold, and `False` otherwise.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, simulates, and validates the neutral Wright-Fisher process\n    against its discrete and continuous theoretical predictions.\n    \"\"\"\n    \n    # Set a fixed seed for the pseudorandom number generator for reproducibility.\n    # The problem requires this for deterministic output.\n    np.random.seed(42)\n\n    # Test suite from the problem statement.\n    # Each tuple contains:\n    # (N, T, p0, R, eps_mean, eps_var, tau)\n    # N: diploid population size\n    # T: number of generations\n    # p0: initial allele frequency\n    # R: number of replicate simulations\n    # eps_mean: acceptance threshold for E_mean\n    # eps_var: acceptance threshold for E_disc\n    # tau: acceptance threshold for E_diff\n    test_cases = [\n        # Case A: large population, moderate time, intermediate frequency\n        (1000, 50, 0.3, 12000, 0.005, 0.001, 1e-4),\n        # Case B: small population, moderate time, symmetric frequency\n        (20, 50, 0.5, 20000, 0.01, 0.01, 0.005),\n        # Case C: moderate population, long time, rare allele\n        (100, 200, 0.01, 15000, 0.005, 0.001, 1e-4),\n    ]\n\n    # This list will store the boolean result (True/False) for each test case.\n    results = []\n\n    for case in test_cases:\n        N, T, p0, R, eps_mean, eps_var, tau = case\n\n        # --- 1. Simulation of the discrete Wright-Fisher process ---\n        \n        # Array to store allele frequency paths for R replicates over T+1 time points (0 to T)\n        paths = np.zeros((R, T + 1))\n        # Set initial frequency for all replicates\n        paths[:, 0] = p0\n\n        # Run the simulation for T generations\n        for t in range(T):\n            # Get current frequencies for all R replicates\n            current_p = paths[:, t]\n            \n            # For each replicate, draw the number of alleles for the next generation\n            # from a binomial distribution. This is done in a vectorized manner for efficiency.\n            num_alleles = np.random.binomial(2 * N, current_p)\n            \n            # Calculate and store the new frequencies for the next generation\n            paths[:, t + 1] = num_alleles / (2 * N)\n\n        # --- 2. Calculation of theoretical predictions and sample statistics ---\n\n        # Time vector from t=0 to t=T\n        t_vec = np.arange(T + 1)\n\n        # Theoretical variance for the discrete-generation model (v_disc)\n        # v_disc(t) = p0*(1-p0) * (1 - (1 - 1/(2N))^t)\n        v_disc = p0 * (1.0 - p0) * (1.0 - (1.0 - 1.0 / (2.0 * N))**t_vec)\n\n        # Theoretical variance for the continuous-time diffusion approximation (v_diff)\n        # v_diff(t) = p0*(1-p0) * (1 - exp(-t/(2N)))\n        v_diff = p0 * (1.0 - p0) * (1.0 - np.exp(-t_vec / (2.0 * N)))\n\n        # Sample mean of allele frequency across replicates at each time point\n        m_hat = np.mean(paths, axis=0)\n        \n        # Sample variance of allele frequency across replicates at each time point.\n        # ddof=0 calculates the population variance (MLE), which is appropriate\n        # for comparison against a theoretical population parameter with large R.\n        v_hat = np.var(paths, axis=0, ddof=0)\n        \n        # --- 3. Computation of diagnostic error metrics ---\n\n        # E_mean: Max deviation of sample mean from theoretical mean (p0) for t>0.\n        E_mean = np.max(np.abs(m_hat[1:] - p0))\n        \n        # E_disc: Max deviation of sample variance from discrete theory for t>0.\n        E_disc = np.max(np.abs(v_hat[1:] - v_disc[1:]))\n\n        # E_diff: Theoretical deviation between diffusion and discrete models at T.\n        E_diff = np.abs(v_diff[T] - v_disc[T])\n\n        # --- 4. Validation against acceptance thresholds ---\n        \n        # A case is valid if and only if all three error metrics are within their thresholds.\n        is_valid = (E_mean = eps_mean) and \\\n                   (E_disc = eps_var) and \\\n                   (E_diff = tau)\n        \n        results.append(is_valid)\n\n    # Final print statement in the exact required format.\n    # The output is a list of booleans, one for each test case.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2588608"}]}