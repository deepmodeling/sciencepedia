{"hands_on_practices": [{"introduction": "A hallmark of adaptive radiation is an early burst of speciation that slows as ecological niches are filled. This exercise asks you to explore the quantitative models used to detect such \"diversification slowdowns\" from phylogenetic trees [@problem_id:2544830]. By analyzing how errors in time calibration affect inferred speciation rates, you will gain a crucial understanding of the robustness of macroevolutionary conclusions and the importance of sensitivity analysis in comparative methods.", "problem": "Hawaiian silverswords are often modeled as an adaptive radiation with an initially high speciation rate that declines through time. Consider a dated, fully sampled crown-group phylogeny of the silversword alliance with crown age $T$ and $N$ extant species. Assume diversification follows a non-homogeneous pure-birth (Yule) process with a time-dependent speciation rate $\\lambda(t) = \\lambda_{0}\\, e^{-b t}$, where $\\lambda_{0}  0$ and $b \\ge 0$, and extinction is negligible on the time scale of interest. Suppose the phylogeny has been time-calibrated under a relaxed molecular clock using one or more calibrations, but there is a uniform multiplicative calibration error such that all true branching times $t$ have been scaled to $t' = s\\, t$ with a constant factor $s  0$ (e.g., overestimating crown age if $s  1$). You perform inference by fitting the same functional form to the calibrated tree, obtaining maximum likelihood estimates (MLEs) $\\hat{\\lambda}_{0}(s)$ and $\\hat{b}(s)$ from the calibrated data. You also compute the Pybus and Harvey $\\gamma$ statistic to test for slowdowns, and you examine the dimensionless product $b T$ that governs the fraction of the exponential decline realized by the crown age.\n\nWhich option correctly summarizes the sensitivity of inferred slowdowns to the calibration factor $s$ under these assumptions, including the implications for the Lineages-Through-Time (LTT) shape, the Pybus and Harvey $\\gamma$ statistic, and a concrete numerical check for $s = 1.2$ given $\\hat{\\lambda}_{0}(1) = 1.5\\, \\text{Myr}^{-1}$, $\\hat{b}(1) = 0.25\\, \\text{Myr}^{-1}$, and $T = 5\\, \\text{Myr}$?\n\nA. Under uniform multiplicative scaling of time by $s$, the fitted rate function transforms as $\\hat{\\lambda}_{0}(s) = \\hat{\\lambda}_{0}(1)/s$ and $\\hat{b}(s) = \\hat{b}(1)/s$, preserving the LTT shape up to a rescaling of the time axis. The Pybus and Harvey $\\gamma$ statistic is invariant to uniform time scaling. The product $b T$ is invariant when both $b$ and $T$ are measured on the calibrated scale. For $s = 1.2$, $\\hat{\\lambda}_{0}(1.2) = 1.25\\, \\text{Myr}^{-1}$ and $\\hat{b}(1.2) = 0.2083\\, \\text{Myr}^{-1}$.\n\nB. Under uniform multiplicative scaling of time by $s$, the fitted rate function transforms as $\\hat{\\lambda}_{0}(s) = s\\, \\hat{\\lambda}_{0}(1)$ and $\\hat{b}(s) = s\\, \\hat{b}(1)$, preserving the LTT shape. The Pybus and Harvey $\\gamma$ statistic is unchanged. The product $b T$ increases by a factor of $s^{2}$. For $s = 1.2$, $\\hat{\\lambda}_{0}(1.2) = 1.8\\, \\text{Myr}^{-1}$ and $\\hat{b}(1.2) = 0.3\\, \\text{Myr}^{-1}$.\n\nC. Under uniform multiplicative scaling of time by $s$, the fitted rate function transforms as $\\hat{\\lambda}_{0}(s) = \\hat{\\lambda}_{0}(1)/s$ and $\\hat{b}(s) = \\hat{b}(1)$, so initial rates decrease but slowdowns per unit time are invariant. The Pybus and Harvey $\\gamma$ statistic becomes more negative as $s$ increases. The product $b T$ increases linearly with $s$. For $s = 1.2$, $\\hat{\\lambda}_{0}(1.2) = 1.25\\, \\text{Myr}^{-1}$ and $\\hat{b}(1.2) = 0.25\\, \\text{Myr}^{-1}$.\n\nD. Under uniform multiplicative scaling of time by $s$, the fitted rate function transforms as $\\hat{\\lambda}_{0}(s) = \\hat{\\lambda}_{0}(1)$ and $\\hat{b}(s) = \\hat{b}(1)/s$, so slowdowns weaken but the initial rate is unaffected. The Pybus and Harvey $\\gamma$ statistic is invariant. The product $b T$ decreases linearly with $s$. For $s = 1.2$, $\\hat{\\lambda}_{0}(1.2) = 1.5\\, \\text{Myr}^{-1}$ and $\\hat{b}(1.2) = 0.2083\\, \\text{Myr}^{-1}$.", "solution": "The problem statement will first be subjected to critical validation.\n\n### Step 1: Extract Givens\n- **Diversification Model**: Non-homogeneous pure-birth (Yule) process. Extinction is negligible.\n- **Speciation Rate Function**: $\\lambda(t) = \\lambda_{0}\\, e^{-b t}$, where $t$ is time from the crown-group origin, $\\lambda_{0}  0$ is the initial speciation rate, and $b \\ge 0$ is the exponential slowdown parameter.\n- **Phylogeny Data**: A dated, fully sampled crown-group phylogeny with crown age $T$ and $N$ extant species.\n- **Calibration Error**: A uniform multiplicative scaling error exists. True branching times $t$ are observed as calibrated times $t' = s\\, t$, where $s  0$ is a constant scaling factor. The true crown age is $T$, and the calibrated crown age is $T' = sT$.\n- **Inference Procedure**: The same functional form for the rate, $\\lambda'(t') = \\lambda'_{0}\\, e^{-b' t'}$, is fitted to the calibrated data $\\{t'_i\\}$ to obtain maximum likelihood estimates (MLEs) $\\hat{\\lambda}_{0}(s)$ and $\\hat{b}(s)$.\n- **Analysis Metrics**:\n    1. The Pybus and Harvey $\\gamma$ statistic.\n    2. The dimensionless product $bT$.\n- **Numerical Values for Check**:\n    - Scaling factor: $s = 1.2$.\n    - Inferred parameters for the true tree ($s=1$): $\\hat{\\lambda}_{0}(1) = 1.5\\, \\text{Myr}^{-1}$ and $\\hat{b}(1) = 0.25\\, \\text{Myr}^{-1}$.\n    - True crown age: $T = 5\\, \\text{Myr}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem presented is a theoretical exercise in statistical phylogenetics, a sub-discipline of computational biology.\n- **Scientifically Grounded**: The problem is based on established models of macroevolution (time-dependent pure-birth process), standard statistical methods (maximum likelihood estimation), and a common tool for analyzing diversification patterns (the Pybus and Harvey $\\gamma$ statistic). The issue of calibration uncertainty is a real and critical topic in molecular dating studies. The model $\\lambda(t) = \\lambda_{0}\\, e^{-b t}$ is frequently used to represent adaptive radiations where speciation rates decline as ecological niches are filled.\n- **Well-Posed**: The problem is clearly defined. It specifies the model, the data transformation (time scaling), and the quantities to be analyzed. It asks for a definitive conclusion about the sensitivity of inferred parameters and statistics to this transformation. A unique analytical solution can be derived.\n- **Objective**: The problem is stated using precise, formal language common to the field. It is free from ambiguity and subjective elements.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is a well-formulated, scientifically relevant question concerning the properties of macroevolutionary models. I will proceed with the derivation of the solution.\n\n### Derivation of Solution\n\nThe fundamental principle governing the transformation of rates is the invariance of the number of events. The expected number of speciation events in a small true time interval $[t, t+dt]$ is proportional to $\\lambda(t)dt$. In the calibrated time frame, this interval corresponds to $[t', t'+dt'] = [st, s(t+dt)]$, and the expected number of events is proportional to $\\lambda'(t')dt'$. Since these must describe the same event count, we have:\n$$ \\lambda(t) dt \\propto \\lambda'(t') dt' $$\nWith $t' = st$, we have $dt' = s\\,dt$. Substituting this into the equivalence gives:\n$$ \\lambda(t) dt = \\lambda'(st) (s\\,dt) $$\n$$ \\lambda(t) = s \\lambda'(st) $$\nThis equation provides the general transformation between the true rate function $\\lambda(t)$ and the rate function $\\lambda'(t')$ inferred from time-scaled data.\n\nNow, we apply this general rule to the specific exponential model given: $\\lambda(t) = \\lambda_{0} e^{-bt}$ and $\\lambda'(t') = \\lambda'_{0} e^{-b't'}$. Note that $\\lambda_{0}, b$ represent the true parameters (or MLEs on the true tree, $\\hat{\\lambda}_{0}(1), \\hat{b}(1)$), while $\\lambda'_{0}, b'$ represent the parameters inferred from the scaled tree (i.e., $\\hat{\\lambda}_{0}(s), \\hat{b}(s)$).\nSubstituting the functional forms into the transformation rule:\n$$ \\lambda_{0} e^{-bt} = s \\left( \\lambda'_{0} e^{-b'(st)} \\right) $$\n$$ \\lambda_{0} e^{-bt} = (s \\lambda'_{0}) e^{-(sb')t} $$\nFor this equality to hold for all times $t$, the coefficients of the constant and exponential terms on both sides must be equal. This yields two equations:\n1. $\\lambda_{0} = s \\lambda'_{0} \\implies \\lambda'_{0} = \\frac{\\lambda_{0}}{s}$\n2. $b = sb' \\implies b' = \\frac{b}{s}$\n\nIn the notation of the problem, this translates to:\n$$ \\hat{\\lambda}_{0}(s) = \\frac{\\hat{\\lambda}_{0}(1)}{s} \\quad \\text{and} \\quad \\hat{b}(s) = \\frac{\\hat{b}(1)}{s} $$\nThis result is intuitive: if time is stretched by a factor $s$, rates, which are measured per unit of time (e.g., $\\text{Myr}^{-1}$), must decrease by the same factor $s$.\n\nNext, we analyze the consequences for the specified metrics.\n\n**1. Lineages-Through-Time (LTT) Shape:**\nThe expected number of lineages $E[N(t)]$ at time $t$ in a pure-birth process is given by $E[N(t)] = 2 \\exp(\\int_0^t \\lambda(\\tau) d\\tau)$. The LTT plot shows $\\ln(E[N(t)])$ vs. $t$.\nFor the true tree, the curve is defined by $y(t) = \\ln(E[N(t)]) = \\ln(2) + \\int_0^t \\lambda_0 e^{-b\\tau} d\\tau$.\nFor the calibrated tree, the curve is defined by $y'(t') = \\ln(E[N(t')]) = \\ln(2) + \\int_0^{t'} \\lambda'_0 e^{-b'\\tau'} d\\tau'$.\nSubstituting the transformed parameters $\\lambda'_{0} = \\lambda_{0}/s$ and $b' = b/s$:\n$$ y'(t') = \\ln(2) + \\int_0^{t'} \\frac{\\lambda_0}{s} e^{-(b/s)\\tau'} d\\tau' = \\ln(2) + \\frac{\\lambda_0/s}{b/s} \\left[1 - e^{-(b/s)\\tau'}\\right] = \\ln(2) + \\frac{\\lambda_0}{b} \\left[1 - e^{-bt'/s}\\right] $$\nNow, let's evaluate this at the scaled time $t' = st$:\n$$ y'(st) = \\ln(2) + \\frac{\\lambda_0}{b} \\left[1 - e^{-b(st)/s}\\right] = \\ln(2) + \\frac{\\lambda_0}{b} \\left[1 - e^{-bt}\\right] $$\nThis integral is precisely the one defining the true LTT curve. Thus, $y'(st) = y(t)$. This means the LTT plot for the scaled data is a simple horizontal stretch by a factor of $s$ of the LTT plot for the true data. The shape is preserved under this rescaling.\n\n**2. Pybus and Harvey $\\gamma$ Statistic:**\nThe $\\gamma$ statistic is a test for a constant-rate diversification process. It measures the relative placement of node ages within a phylogeny between the crown age ($T$) and the present. A uniform scaling of all time points, $t'_i = s t_i$, scales the crown age to $T' = sT$ but preserves the relative positions of all nodes. For instance, the ratio of any two node ages $t'_i / t'_j = (st_i)/(st_j) = t_i/t_j$ is invariant. Similarly, the position of any node relative to the total tree depth is invariant: $t'_i / T' = (st_i)/(sT) = t_i/T$. Since the $\\gamma$ statistic is constructed from these relative temporal positions, it is invariant to a uniform scaling of the time axis.\n\n**3. The Dimensionless Product $bT$:**\nThis product indicates the total magnitude of the rate decline over the history of the clade. The question asks about this product when both quantities are measured on the calibrated scale. The inferred slowdown parameter on the calibrated scale is $\\hat{b}(s)$, and the crown age on this scale is $T' = sT$. The product is therefore $\\hat{b}(s) T'$.\nUsing our derived transformation for $\\hat{b}(s)$ and the given transformation for $T$:\n$$ \\hat{b}(s) T' = \\left( \\frac{\\hat{b}(1)}{s} \\right) (sT) = \\hat{b}(1)T $$\nThe product is invariant. This means that although stretching time makes the slowdown *rate* ($b$) appear smaller, this is exactly compensated by the longer time interval ($T'$) over which the slowdown occurs, such that the total proportional drop in speciation rate, $e^{-bT}$, is correctly estimated regardless of the calibration error $s$.\n\n**4. Numerical Check:**\nGiven $s = 1.2$, $\\hat{\\lambda}_{0}(1) = 1.5\\, \\text{Myr}^{-1}$, and $\\hat{b}(1) = 0.25\\, \\text{Myr}^{-1}$.\nWe calculate the inferred parameters on the calibrated tree:\n$$ \\hat{\\lambda}_{0}(1.2) = \\frac{\\hat{\\lambda}_{0}(1)}{s} = \\frac{1.5}{1.2} = \\frac{15}{12} = \\frac{5}{4} = 1.25\\, \\text{Myr}^{-1} $$\n$$ \\hat{b}(1.2) = \\frac{\\hat{b}(1)}{s} = \\frac{0.25}{1.2} = \\frac{1/4}{6/5} = \\frac{1}{4} \\times \\frac{5}{6} = \\frac{5}{24} \\approx 0.208333...\\, \\text{Myr}^{-1} $$\nThe value is $\\hat{b}(1.2) = 0.2083\\, \\text{Myr}^{-1}$ when rounded to four decimal places.\n\n### Evaluation of Options\n\n**A. Under uniform multiplicative scaling of time by $s$, the fitted rate function transforms as $\\hat{\\lambda}_{0}(s) = \\hat{\\lambda}_{0}(1)/s$ and $\\hat{b}(s) = \\hat{b}(1)/s$, preserving the LTT shape up to a rescaling of the time axis. The Pybus and Harvey $\\gamma$ statistic is invariant to uniform time scaling. The product $b T$ is invariant when both $b$ and $T$ are measured on the calibrated scale. For $s = 1.2$, $\\hat{\\lambda}_{0}(1.2) = 1.25\\, \\text{Myr}^{-1}$ and $\\hat{b}(1.2) = 0.2083\\, \\text{Myr}^{-1}$.**\n- This option correctly states the transformation rules for $\\hat{\\lambda}_{0}$ and $\\hat{b}$.\n- It correctly describes the effect on the LTT plot shape.\n- It correctly states that the $\\gamma$ statistic is invariant.\n- It correctly states that the product $\\hat{b}(s)T'$ is invariant.\n- Its numerical calculations are correct.\n- Verdict: **Correct**.\n\n**B. Under uniform multiplicative scaling of time by $s$, the fitted rate function transforms as $\\hat{\\lambda}_{0}(s) = s\\, \\hat{\\lambda}_{0}(1)$ and $\\hat{b}(s) = s\\, \\hat{b}(1)$, preserving the LTT shape. The Pybus and Harvey $\\gamma$ statistic is unchanged. The product $b T$ increases by a factor of $s^{2}$. For $s = 1.2$, $\\hat{\\lambda}_{0}(1.2) = 1.8\\, \\text{Myr}^{-1}$ and $\\hat{b}(1.2) = 0.3\\, \\text{Myr}^{-1}$.**\n- The transformation rules for the parameters are incorrect. Rates must scale as $1/s$, not $s$.\n- The statement about the product $bT$ is incorrect; it is invariant, not increasing by $s^2$.\n- Verdict: **Incorrect**.\n\n**C. Under uniform multiplicative scaling of time by $s$, the fitted rate function transforms as $\\hat{\\lambda}_{0}(s) = \\hat{\\lambda}_{0}(1)/s$ and $\\hat{b}(s) = \\hat{b}(1)$, so initial rates decrease but slowdowns per unit time are invariant. The Pybus and Harvey $\\gamma$ statistic becomes more negative as $s$ increases. The product $b T$ increases linearly with $s$. For $s = 1.2$, $\\hat{\\lambda}_{0}(1.2) = 1.25\\, \\text{Myr}^{-1}$ and $\\hat{b}(1.2) = 0.25\\, \\text{Myr}^{-1}$.**\n- The transformation rule for $\\hat{b}(s)$ is incorrect; it should scale as $1/s$.\n- The statement about the $\\gamma$ statistic is incorrect; it is invariant.\n- The statement about the product $bT$ is incorrect; it is invariant, not increasing with $s$.\n- Verdict: **Incorrect**.\n\n**D. Under uniform multiplicative scaling of time by $s$, the fitted rate function transforms as $\\hat{\\lambda}_{0}(s) = \\hat{\\lambda}_{0}(1)$ and $\\hat{b}(s) = \\hat{b}(1)/s$, so slowdowns weaken but the initial rate is unaffected. The Pybus and Harvey $\\gamma$ statistic is invariant. The product $b T$ decreases linearly with $s$. For $s = 1.2$, $\\hat{\\lambda}_{0}(1.2) = 1.5\\, \\text{Myr}^{-1}$ and $\\hat{b}(1.2) = 0.2083\\, \\text{Myr}^{-1}$.**\n- The transformation rule for $\\hat{\\lambda}_{0}(s)$ is incorrect; it should scale as $1/s$.\n- The statement about the product $bT$ is incorrect; it is invariant.\n- Verdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2544830"}, {"introduction": "Beyond the proliferation of species, adaptive radiations are defined by the evolution of phenotypic diversity to exploit new ecological opportunities, often leading to convergence. This exercise challenges you to translate the qualitative concept of convergence into a formal statistical test [@problem_id:2544884]. By deriving a decision criterion based on the distance between species in a multidimensional trait space, you will practice using stochastic models of evolution to create rigorous, quantitative null hypotheses.", "problem": "A research team studying adaptive radiation in both cichlid fishes and Hawaiian silverswords has assembled a shared morphospace comprising $k$ continuous, homologous functional traits (e.g., feeding mechanics in cichlids and leaf–stem architecture in silverswords) represented for each taxon by a vector $\\mathbf{X} \\in \\mathbb{R}^k$. To test for cross-radiation convergence between a focal cichlid species and a focal silversword species, the team adopts the following generative null model: each lineage evolves independently from the same initial trait state at the time of their respective radiation’s origin, with trait evolution following multivariate Brownian motion (BM), that is, a $k$-variate Wiener process with rate matrix $\\mathbf{R}$ that is symmetric positive definite and constant through time. Let the elapsed evolutionary times be $t_1$ for the focal cichlid lineage and $t_2$ for the focal silversword lineage since their respective radiation origins. Under this null, the difference in trait vectors is $\\boldsymbol{\\Delta} = \\mathbf{X}_1 - \\mathbf{X}_2$ at the present.\n\nUsing only core properties of Brownian motion and the multivariate normal distribution, and without invoking any prepackaged test statistics, derive a one-sided decision criterion at significance level $\\alpha \\in (0,1)$ that declares the pair “convergent” precisely when a suitably standardized distance in morphospace is unusually small relative to the null. Your derivation must:\n- Identify the null distribution of a quadratic form in $\\boldsymbol{\\Delta}$ that appropriately accounts for the evolutionary rate matrix $\\mathbf{R}$ and the total elapsed time $t_1 + t_2$.\n- From this distribution, construct the level-$\\alpha$ lower-tail critical value that defines an acceptance region for declaring “convergence.”\n\nReport, as your final result, a single closed-form analytic expression for the threshold $T_{\\alpha}(k,\\mathbf{R},t_1,t_2)$ such that the decision rule takes the form “declare convergence if and only if a specified quadratic form in $\\boldsymbol{\\Delta}$ is less than or equal to $T_{\\alpha}(k,\\mathbf{R},t_1,t_2)$.” Your answer must be a single mathematical expression and must not include any units. If you express the result in terms of a quantile function, define it unambiguously in your reasoning. No numerical evaluation or rounding is required.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard scenario in quantitative evolutionary biology that can be formalized and solved using established principles of stochastic processes and multivariate statistics. The premises are consistent and sufficient for deriving the required decision criterion. Therefore, a full solution is warranted.\n\nThe null model posits that the trait vectors for the focal cichlid species, $\\mathbf{X}_1$, and the focal silversword species, $\\mathbf{X}_2$, evolve independently according to a multivariate Brownian motion (BM) process. Both lineages start from a common ancestral trait vector, $\\mathbf{X}_0$, at the origin of their respective radiations. The BM process is characterized by a $k$-dimensional rate matrix $\\mathbf{R}$, which is symmetric and positive definite.\n\nUnder the BM model, the trait vector $\\mathbf{X}(t)$ at time $t$ follows a multivariate normal distribution. For the cichlid lineage, with an elapsed time of $t_1$, its trait vector $\\mathbf{X}_1$ is distributed as:\n$$ \\mathbf{X}_1 \\sim \\mathcal{N}(\\mathbf{X}_0, t_1\\mathbf{R}) $$\nSimilarly, for the silversword lineage, with an elapsed time of $t_2$, its trait vector $\\mathbf{X}_2$ is distributed as:\n$$ \\mathbf{X}_2 \\sim \\mathcal{N}(\\mathbf{X}_0, t_2\\mathbf{R}) $$\nThe evolution of the two lineages is stipulated to be independent.\n\nWe are interested in the difference vector $\\boldsymbol{\\Delta} = \\mathbf{X}_1 - \\mathbf{X}_2$. As a linear combination of independent multivariate normal vectors, $\\boldsymbol{\\Delta}$ is also multivariate normal. We determine its parameters under the null hypothesis.\nThe expected value of the difference is:\n$$ E[\\boldsymbol{\\Delta}] = E[\\mathbf{X}_1 - \\mathbf{X}_2] = E[\\mathbf{X}_1] - E[\\mathbf{X}_2] = \\mathbf{X}_0 - \\mathbf{X}_0 = \\mathbf{0} $$\nDue to the independence of the two evolutionary paths, the covariance matrix of the difference is the sum of their individual covariance matrices:\n$$ \\text{Var}(\\boldsymbol{\\Delta}) = \\text{Var}(\\mathbf{X}_1) + \\text{Var}(\\mathbf{X}_2) = t_1\\mathbf{R} + t_2\\mathbf{R} = (t_1 + t_2)\\mathbf{R} $$\nLet $\\boldsymbol{\\Sigma}_{\\boldsymbol{\\Delta}} = (t_1 + t_2)\\mathbf{R}$. Since $t_1  0$, $t_2  0$, and $\\mathbf{R}$ is symmetric positive definite, $\\boldsymbol{\\Sigma}_{\\boldsymbol{\\Delta}}$ is also symmetric positive definite. Thus, the distribution of the trait difference vector under the null hypothesis is:\n$$ \\boldsymbol{\\Delta} \\sim \\mathcal{N}(\\mathbf{0}, (t_1 + t_2)\\mathbf{R}) $$\n\nThe problem requires constructing a decision rule based on a \"suitably standardized distance\" being \"unusually small\". In the context of a multivariate normal distribution $\\mathcal{N}(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$, the standard way to measure the squared distance of a vector $\\mathbf{y}$ from its mean is the Mahalanobis distance, $(\\mathbf{y} - \\boldsymbol{\\mu})^T \\boldsymbol{\\Sigma}^{-1} (\\mathbf{y} - \\boldsymbol{\\mu})$.\nFor our vector $\\boldsymbol{\\Delta}$ with mean $\\mathbf{0}$ and covariance $\\boldsymbol{\\Sigma}_{\\boldsymbol{\\Delta}}$, this quadratic form is $\\boldsymbol{\\Delta}^T \\boldsymbol{\\Sigma}_{\\boldsymbol{\\Delta}}^{-1} \\boldsymbol{\\Delta}$. A core property of the multivariate normal distribution is that this very quadratic form follows a chi-squared distribution with degrees of freedom equal to the dimension of the vector, which is $k$.\n\nLet us define the test statistic $Q$ as this standardized quadratic form:\n$$ Q = \\boldsymbol{\\Delta}^T \\boldsymbol{\\Sigma}_{\\boldsymbol{\\Delta}}^{-1} \\boldsymbol{\\Delta} = \\boldsymbol{\\Delta}^T [(t_1 + t_2)\\mathbf{R}]^{-1} \\boldsymbol{\\Delta} $$\nUsing properties of matrix inverses, this simplifies to:\n$$ Q = \\frac{1}{t_1 + t_2} \\boldsymbol{\\Delta}^T \\mathbf{R}^{-1} \\boldsymbol{\\Delta} $$\nUnder the null hypothesis, this statistic follows a chi-squared distribution with $k$ degrees of freedom:\n$$ Q \\sim \\chi^2_k $$\nThis distribution is pivotal as its form does not depend on the specific parameters $\\mathbf{R}$, $t_1$, or $t_2$.\n\nThe decision to declare \"convergence\" is made when the observed phenotypes are closer together than expected by chance, which corresponds to an \"unusually small\" value of the distance. This translates to a lower-tail test on the distribution of our test statistic $Q$. At a significance level of $\\alpha \\in (0,1)$, we seek a critical value $C$ such that the probability of observing a value of $Q$ less than or equal to $C$ is $\\alpha$, given that the null hypothesis is true.\n$$ P(Q \\le C) = \\alpha $$\nThis critical value $C$ is, by definition, the $\\alpha$-quantile of the $\\chi^2_k$ distribution. Let $F_{\\chi^2_k}$ denote the cumulative distribution function (CDF) of the chi-squared distribution with $k$ degrees of freedom. The quantile function, or inverse CDF, $F^{-1}_{\\chi^2_k}(p)$, gives the value $x$ such that $P(X \\le x) = p$ for a random variable $X \\sim \\chi^2_k$.\nTherefore, our critical value is $C = F^{-1}_{\\chi^2_k}(\\alpha)$.\n\nThe decision rule is to declare convergence if the observed value of $Q$ is less than or equal to this critical value:\n$$ \\frac{1}{t_1 + t_2} \\boldsymbol{\\Delta}^T \\mathbf{R}^{-1} \\boldsymbol{\\Delta} \\le F^{-1}_{\\chi^2_k}(\\alpha) $$\nThe problem asks for a threshold $T_{\\alpha}(k,\\mathbf{R},t_1,t_2)$ for a specified quadratic form in $\\boldsymbol{\\Delta}$. A natural choice for this specified quadratic form is the quantity $S = \\boldsymbol{\\Delta}^T \\mathbf{R}^{-1} \\boldsymbol{\\Delta}$, which represents the squared distance between the trait vectors, scaled by the inverse of the evolutionary rate matrix. Rearranging the inequality to solve for this quadratic form yields:\n$$ \\boldsymbol{\\Delta}^T \\mathbf{R}^{-1} \\boldsymbol{\\Delta} \\le (t_1 + t_2) F^{-1}_{\\chi^2_k}(\\alpha) $$\nThus, the \"specified quadratic form\" is $\\boldsymbol{\\Delta}^T \\mathbf{R}^{-1} \\boldsymbol{\\Delta}$ and the threshold $T_{\\alpha}$ is the right-hand side of this inequality. This threshold defines the boundary of the acceptance region for declaring convergence.\n\nThe final expression for the threshold is a function of the total evolutionary time, $t_1 + t_2$, and the critical value from the $\\chi^2_k$ distribution at significance level $\\alpha$.", "answer": "$$\\boxed{(t_1+t_2)F^{-1}_{\\chi^2_k}(\\alpha)}$$", "id": "2544884"}, {"introduction": "A comprehensive assessment of adaptive radiation requires synthesizing evidence from both the rate of lineage proliferation and the pace of phenotypic evolution. This capstone practice guides you through the process of building an integrated statistical test that accomplishes exactly that [@problem_id:2544879]. You will construct a composite index from standardized rates and derive a decision threshold, providing a powerful framework for formally classifying clades and unifying the core themes of macroevolution.", "problem": "In comparative zoology and botany, a clade is often deemed an adaptive radiation when it exhibits both unusually rapid lineage diversification and unusually rapid phenotypic evolution relative to comparable clades of similar age and ecological opportunity. Consider a decision rule that integrates these two axes. Let the net lineage diversification rate be denoted by $r$ as inferred under a birth–death process (with speciation rate $\\lambda$ and extinction rate $\\mu$, net rate $r=\\lambda-\\mu$), and let the macroevolutionary rate of phenotypic evolution be denoted by $\\sigma^{2}$ as inferred under a Brownian Motion (BM) model for continuous traits. To enable cross-clade comparison while controlling for clade age and sampling effects, suppose we standardize both rates against an empirically constructed null reference set of comparable clades (matched by age, environment, and data completeness), yielding standardized scores\n$$\nz_{r}=\\frac{\\hat{r}-\\mu_{r}}{s_{r}},\\qquad z_{\\sigma}=\\frac{\\widehat{\\sigma^{2}}-\\mu_{\\sigma}}{s_{\\sigma}},\n$$\nwhere $(\\mu_{r},s_{r})$ and $(\\mu_{\\sigma},s_{\\sigma})$ are the empirical null means and standard deviations of $\\hat{r}$ and $\\widehat{\\sigma^{2}}$, respectively. Assume that under the null hypothesis of no adaptive radiation, the vector $\\mathbf{z}=(z_{r},z_{\\sigma})^{\\top}$ is approximately bivariate normal with mean $\\mathbf{0}$, unit marginal variances, and correlation $\\rho$ arising from shared ecological drivers.\n\nDefine a composite index\n$$\nS=w_{1}z_{r}+w_{2}z_{\\sigma},\n$$\nwith nonnegative weights $w_{1}$ and $w_{2}$ reflecting the relative evidential contribution of diversification and phenotypic rates. You must derive, from first principles and the assumptions stated above, a one-sided decision threshold $T^{\\ast}$ such that classifying a clade as an adaptive radiation when $ST^{\\ast}$ controls the type I error at level $\\alpha$.\n\nThen, interpret how you would calibrate $(w_{1},w_{2})$ and $\\rho$ on empirical datasets anchored by known adaptive radiations, such as Lake Malawi cichlid fishes and Hawaiian silverswords, together with non-radiating sister clades sampled to define the null. Your calibration description should be principled and compatible with the assumptions used to derive the decision rule, but the only quantity you must report numerically is the threshold $T^{\\ast}$ for the following parameterization:\n- target type I error level $\\alpha=0.01$,\n- weights $w_{1}=0.7$ and $w_{2}=0.3$ chosen by cross-validation to maximize separation between known radiations (including Lake Malawi cichlids and Hawaiian silverswords) and matched non-radiating clades,\n- null correlation $\\rho=0.2$ estimated from the matched null panel.\n\nReport the numerical value of $T^{\\ast}$ rounded to four significant figures. No units are required.", "solution": "The problem posed is a valid and well-posed question in statistical phylogenetics. It is scientifically grounded, objective, and contains all necessary information for a rigorous derivation and numerical calculation. I will now proceed with the solution.\n\nThe objective is to derive a decision threshold $T^{\\ast}$ for a composite index $S$ used to identify adaptive radiations. The decision rule is to classify a clade as an adaptive radiation if its score $S$ exceeds $T^{\\ast}$. This threshold must be determined such that the probability of a false positive classification (a Type I error) is controlled at a specified significance level $\\alpha$.\n\nFirst, we formalize the statistical model under the null hypothesis, $H_0$, which states that a given clade is not an adaptive radiation. The problem specifies that the standardized scores for diversification rate, $z_{r}$, and phenotypic evolution rate, $z_{\\sigma}$, are jointly distributed as a bivariate normal. The vector of scores $\\mathbf{z} = (z_{r}, z_{\\sigma})^{\\top}$ follows:\n$$\n\\mathbf{z} \\sim \\mathcal{N}_{2}(\\mathbf{\\mu}_{0}, \\mathbf{\\Sigma})\n$$\nwhere the mean vector under the null hypothesis is $\\mathbf{\\mu}_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$, and the covariance matrix is\n$$\n\\mathbf{\\Sigma} = \\begin{pmatrix} \\text{Var}(z_r)  \\text{Cov}(z_r, z_\\sigma) \\\\ \\text{Cov}(z_r, z_\\sigma)  \\text{Var}(z_\\sigma) \\end{pmatrix} = \\begin{pmatrix} 1  \\rho \\\\ \\rho  1 \\end{pmatrix}\n$$\nThe marginal variances are $1$ by definition of the standardization (z-scores), and $\\rho$ is the correlation between the scores arising from shared background factors.\n\nThe composite index $S$ is defined as a linear combination of these scores:\n$$\nS = w_{1}z_{r} + w_{2}z_{\\sigma}\n$$\nwhere $w_{1}$ and $w_{2}$ are non-negative weights. Since $S$ is a linear combination of normally distributed random variables, $S$ itself is normally distributed. To define its distribution, we must find its expectation $E[S]$ and variance $\\text{Var}(S)$ under $H_0$.\n\nThe expectation of $S$ is:\n$$\nE[S] = E[w_{1}z_{r} + w_{2}z_{\\sigma}] = w_{1}E[z_{r}] + w_{2}E[z_{\\sigma}] = w_{1}(0) + w_{2}(0) = 0\n$$\nThe variance of $S$ is given by the general formula for the variance of a linear combination of two correlated random variables, $\\text{Var}(aX + bY) = a^2\\text{Var}(X) + b^2\\text{Var}(Y) + 2ab\\text{Cov}(X,Y)$:\n$$\n\\text{Var}(S) = \\text{Var}(w_{1}z_{r} + w_{2}z_{\\sigma}) = w_{1}^{2}\\text{Var}(z_{r}) + w_{2}^{2}\\text{Var}(z_{\\sigma}) + 2w_{1}w_{2}\\text{Cov}(z_{r}, z_{\\sigma})\n$$\nSubstituting the known values for the variances and covariance:\n$$\n\\text{Var}(S) = w_{1}^{2}(1) + w_{2}^{2}(1) + 2w_{1}w_{2}\\rho = w_{1}^{2} + w_{2}^{2} + 2w_{1}w_{2}\\rho\n$$\nLet us denote this variance as $\\sigma_S^2$. Thus, under the null hypothesis, the distribution of the score is $S \\sim \\mathcal{N}(0, \\sigma_S^2)$.\n\nThe Type I error rate, $\\alpha$, is the probability of rejecting $H_0$ when it is true. The decision rule is to reject $H_0$ if $S  T^{\\ast}$. Therefore, we must have:\n$$\nP(S  T^{\\ast} | H_0) = \\alpha\n$$\nTo solve for $T^{\\ast}$, we standardize the random variable $S$. Let $Z = \\frac{S - E[S]}{\\sqrt{\\text{Var}(S)}} = \\frac{S}{\\sigma_S}$. The variable $Z$ follows the standard normal distribution, $Z \\sim \\mathcal{N}(0, 1)$. The inequality becomes:\n$$\nP\\left(\\frac{S}{\\sigma_S}  \\frac{T^{\\ast}}{\\sigma_S}\\right) = P\\left(Z  \\frac{T^{\\ast}}{\\sigma_S}\\right) = \\alpha\n$$\nLet $z_{\\alpha}$ be the upper $\\alpha$-quantile of the standard normal distribution, which is defined by $P(Z  z_{\\alpha}) = \\alpha$. By comparing the two expressions, we find:\n$$\n\\frac{T^{\\ast}}{\\sigma_S} = z_{\\alpha}\n$$\nSolving for the threshold $T^{\\ast}$ yields the general expression:\n$$\nT^{\\ast} = z_{\\alpha} \\sigma_S = z_{\\alpha} \\sqrt{w_{1}^{2} + w_{2}^{2} + 2w_{1}w_{2}\\rho}\n$$\nThis is the analytical derivation of the decision threshold.\n\nThe problem also requires an interpretation of the calibration of the model parameters.\n- **Calibration of $\\rho$**: The correlation $\\rho$ under the null hypothesis is estimated from an empirical reference set of clades known *not* to be adaptive radiations but matched for confounding factors like age and environment. For each clade in this \"null panel,\" the rates $\\hat{r}$ and $\\widehat{\\sigma^{2}}$ would be estimated. These would be used to calculate the panel-wide means $(\\mu_r, \\mu_\\sigma)$ and standard deviations $(s_r, s_\\sigma)$. Then, for each clade in the panel, the standardized scores $(z_r, z_\\sigma)$ are computed. The sample Pearson correlation coefficient of these pairs of scores across the entire null panel provides the estimate for $\\rho$.\n- **Calibration of $(w_1, w_2)$**: The weights $(w_1, w_2)$ are calibrated using a supervised classification framework. A curated dataset is assembled containing two classes of clades: confirmed adaptive radiations (e.g., Lake Malawi cichlids, Hawaiian silverswords) as the positive set, and non-radiating clades as the negative set. For all clades, the scores $z_r$ and $z_\\sigma$ are computed. The task is to find the weights $(w_1, w_2)$ for the linear combination $S = w_1 z_r + w_2 z_\\sigma$ that best discriminates between the two classes. This can be achieved using methods like Linear Discriminant Analysis (LDA), which finds the linear projection that maximizes the separation between the class means relative to their variance. Alternatively, one could test a grid of candidate weights (e.g., under the constraint $w_1+w_2=1$), and select the weights that maximize a performance metric like the Area Under the Receiver Operating Characteristic Curve (AUC). The use of cross-validation is critical to ensure the resulting weights generalize well to new data and are not overfitted to the training set.\n\nFinally, we must compute the numerical value for $T^{\\ast}$ given the specified parameters:\n- Type I error level: $\\alpha = 0.01$\n- Weights: $w_{1} = 0.7$, $w_{2} = 0.3$\n- Null correlation: $\\rho = 0.2$\n\nFirst, we determine the value of $z_{\\alpha} = z_{0.01}$. This is the $99^{th}$ percentile of the standard normal distribution. Consulting statistical tables or a computational tool gives:\n$$\nz_{0.01} \\approx 2.3263\n$$\nNext, we calculate the variance of the composite score, $\\sigma_S^2$:\n$$\n\\sigma_S^2 = w_{1}^{2} + w_{2}^{2} + 2w_{1}w_{2}\\rho = (0.7)^{2} + (0.3)^{2} + 2(0.7)(0.3)(0.2)\n$$\n$$\n\\sigma_S^2 = 0.49 + 0.09 + 2(0.042) = 0.58 + 0.084 = 0.664\n$$\nThe standard deviation is therefore:\n$$\n\\sigma_S = \\sqrt{0.664} \\approx 0.81486\n$$\nNow, we compute the threshold $T^{\\ast}$:\n$$\nT^{\\ast} = z_{0.01} \\times \\sigma_S \\approx 2.3263 \\times 0.81486 \\approx 1.89598\n$$\nRounding this result to four significant figures, as required, gives the final numerical value for the decision threshold.\n$$\nT^{\\ast} = 1.896\n$$", "answer": "$$\n\\boxed{1.896}\n$$", "id": "2544879"}]}