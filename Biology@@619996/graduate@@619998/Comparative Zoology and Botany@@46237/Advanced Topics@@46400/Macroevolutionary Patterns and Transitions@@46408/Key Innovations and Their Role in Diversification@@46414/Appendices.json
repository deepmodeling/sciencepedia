{"hands_on_practices": [{"introduction": "The constant-rate birth-death (CRBD) model is a cornerstone of modern macroevolution, providing a framework to quantify diversification. It operates on two key parameters: the per-lineage speciation rate ($\\lambda$) and the extinction rate ($\\mu$). This exercise [@problem_id:2584173] provides a practical application of these concepts by calculating the net diversification rate, $r = \\lambda - \\mu$, to compare the evolutionary success of C3 and C4 grasses. Importantly, it also prompts a deeper reflection on how the stochastic nature of birth and death events can lead to a wide variance in outcomes, a crucial concept not captured by the expected rate alone.", "problem": "In comparative botany, the evolution of the C4 photosynthetic pathway is often treated as a key innovation that may alter macroevolutionary rates. Consider a constant-rate birth–death process for clade diversification, where the per-lineage speciation rate is denoted by $\\lambda$ and the per-lineage extinction rate by $\\mu$. For a clade starting with $N_{0}$ lineages at time $t=0$, assume the standard birth–death framework in which the expected number of lineages at time $t$ is determined by the balance between per-lineage births and deaths.\n\nDefine the net diversification rate as $r=\\lambda-\\mu$. The expected net diversification advantage of one clade type over another is the difference in their net diversification rates. You are given the following constant rates (in $\\mathrm{Myr}^{-1}$, where $\\mathrm{Myr}$ denotes million years): $\\lambda_{\\mathrm{C4}}=0.4$, $\\mu_{\\mathrm{C4}}=0.05$, $\\lambda_{\\mathrm{C3}}=0.25$, and $\\mu_{\\mathrm{C3}}=0.1$. Under the assumptions above, compute the expected net diversification advantage of C4 over C3, and express your result in $\\mathrm{Myr}^{-1}$. Provide only the numerical value without units in the final answer box. No rounding is necessary.\n\nIn addition, briefly discuss, using the birth–death process framework, why equal values of $r$ across clades can still lead to large variation in realized clade sizes over time due to stochasticity, and identify at least one quantity that captures such uncertainty. Your discussion does not affect the numerical answer.", "solution": "The problem requires the calculation of the net diversification advantage between two types of clades (C4 and C3) and a discussion of stochasticity in the birth–death process framework. The problem is well-posed and grounded in established principles of macroevolutionary modeling.\n\nThe analysis is based on a constant-rate birth–death process, where $\\lambda$ represents the per-lineage speciation rate and $\\mu$ represents the per-lineage extinction rate. The net diversification rate, $r$, is defined as the difference between these rates:\n$$r = \\lambda - \\mu$$\nThis parameter, $r$, determines the expected rate of change in the number of lineages over time.\n\nThe problem provides the following constant rates, with units of $\\mathrm{Myr}^{-1}$:\nFor the C4 clade:\n$\\lambda_{\\mathrm{C4}} = 0.4$\n$\\mu_{\\mathrm{C4}} = 0.05$\n\nFor the C3 clade:\n$\\lambda_{\\mathrm{C3}} = 0.25$\n$\\mu_{\\mathrm{C3}} = 0.1$\n\nFirst, we compute the net diversification rate for the C4 clade, which we denote as $r_{\\mathrm{C4}}$. Using the provided values:\n$$r_{\\mathrm{C4}} = \\lambda_{\\mathrm{C4}} - \\mu_{\\mathrm{C4}} = 0.4 - 0.05 = 0.35$$\nThe unit for this rate is $\\mathrm{Myr}^{-1}$.\n\nNext, we perform the same calculation for the C3 clade to find its net diversification rate, $r_{\\mathrm{C3}}$:\n$$r_{\\mathrm{C3}} = \\lambda_{\\mathrm{C3}} - \\mu_{\\mathrm{C3}} = 0.25 - 0.1 = 0.15$$\nThe unit for this rate is also $\\mathrm{Myr}^{-1}$.\n\nThe problem defines the expected net diversification advantage of C4 over C3 as the difference between their respective net diversification rates. Let this advantage be denoted by $\\Delta r$. We calculate it as follows:\n$$\\Delta r = r_{\\mathrm{C4}} - r_{\\mathrm{C3}}$$\nSubstituting the values we have computed:\n$$\\Delta r = 0.35 - 0.15 = 0.2$$\nThe resulting net diversification advantage is $0.2 \\, \\mathrm{Myr}^{-1}$.\n\nFor the second part of the question, we must discuss why equal values of $r$ can result in large variations in realized clade sizes. This is a direct consequence of the stochastic nature of the birth–death process. The number of lineages at time $t$, $N(t)$, is a random variable, not a deterministic quantity. The net diversification rate $r$ determines only the expected number of lineages, which for an initial number of lineages $N_0$ at $t=0$ is given by:\n$$E[N(t)] = N_0 \\exp(rt)$$\nHowever, any single evolutionary history (a realization of the process) can and will deviate from this mean trajectory. Two clades with the same parameters, and thus the same $r$, can have dramatically different outcomes due to chance. One might experience a series of early speciation events and radiate extensively, while the other might suffer early extinctions and proceed towards annihilation.\n\nA quantity that captures the uncertainty inherent in this process is the variance of the number of lineages, $\\mathrm{Var}[N(t)]$. For a process starting from a single lineage ($N_0=1$), the variance is:\n$$\\mathrm{Var}[N(t)] = \\frac{\\lambda+\\mu}{\\lambda-\\mu} \\exp(rt) (\\exp(rt) - 1)$$\nThis equation shows that the variance depends not only on the net diversification rate $r=\\lambda-\\mu$, but also on the turnover rate, which is the sum of the rates $\\lambda+\\mu$. Thus, two clades can have the same net diversification rate $r$ but different turnover rates. A clade with a higher turnover rate will experience greater stochasticity, meaning a wider range of possible outcomes for its size $N(t)$. Therefore, the turnover rate, $\\lambda+\\mu$, is a key parameter that captures the level of stochastic uncertainty in diversification dynamics beyond the expectation governed by $r$. Another such quantity is the probability of ultimate extinction for a lineage, $\\frac{\\mu}{\\lambda}$, which is non-zero even for a positive diversification rate $r>0$ (when $\\lambda>\\mu$). This highlights the persistent risk of extinction inherent in the stochastic model.", "answer": "$$\\boxed{0.2}$$", "id": "2584173"}, {"introduction": "While rates like $\\lambda$ describe the long-term propensity for speciation, understanding macroevolution also requires thinking about the timing of events. Under the pure-birth (Yule) process, a simplified birth-death model where $\\mu=0$, the time between speciation events is a random variable. This problem [@problem_id:2584181] challenges you to derive, from first principles, the expected waiting time until the next speciation occurs in a clade of a given size $N$. This practice builds crucial intuition about the tempo of diversification, revealing how the process naturally accelerates as a clade grows larger.", "problem": "A plant clade acquires a key floral innovation that is hypothesized to elevate its speciation rate relative to its ancestors. After the innovation, diversification is modeled as a pure-birth Yule process, in which each extant lineage independently gives rise to a new lineage (speciation) according to a Poisson process with constant per-lineage rate $\\lambda$ (events per million years). Suppose the post-innovation rate is estimated as $\\lambda = 0.3\\,\\mathrm{Myr}^{-1}$, and at the present there are $N$ extant lineages descended from the innovation-bearing ancestor.\n\nUsing only the fundamental properties of Poisson processes and exponential waiting times, derive from first principles the expected waiting time from now until the next speciation event occurs anywhere in this clade. Express your final answer in million years (Myr) as a simplified algebraic expression in $N$, and do not round.", "solution": "The problem statement is assessed to be valid. It is a well-posed, scientifically grounded problem in mathematical biology that requires the application of fundamental principles of stochastic processes, specifically the properties of Poisson and exponential distributions.\n\nLet us begin the derivation from first principles.\n\nThe problem states that there are $N$ extant lineages in a clade. Speciation for each lineage is an independent process that occurs at a constant per-lineage rate $\\lambda$. This is modeled as a Poisson process.\n\nA fundamental property of a Poisson process with rate $r$ is that the waiting time until the next event follows an exponential distribution with the same rate parameter $r$. The probability density function (PDF) of such a process is $f(t) = r e^{-rt}$ for $t \\ge 0$, and its expected value is $E[T] = \\frac{1}{r}$.\n\nLet $T_i$ be the random variable representing the waiting time until the next speciation event for lineage $i$, where $i \\in \\{1, 2, \\dots, N\\}$. Since each lineage speciates according to a Poisson process with rate $\\lambda$, each $T_i$ is an independent and identically distributed (i.i.d.) random variable following an exponential distribution with rate $\\lambda$.\n$$T_i \\sim \\text{Exponential}(\\lambda)$$\nThe survival function for each $T_i$, which is the probability that the waiting time is greater than some time $t$, is given by:\n$$P(T_i > t) = \\exp(-\\lambda t)$$\nThis is equivalent to the probability of observing zero speciation events for lineage $i$ in the time interval $[0, t]$.\n\nThe problem asks for the expected waiting time until the *next* speciation event occurs *anywhere in the clade*. Let this waiting time be represented by the random variable $T_{clade}$. This event corresponds to the *first* speciation event among all $N$ lineages. Therefore, $T_{clade}$ is the minimum of the individual waiting times $T_1, T_2, \\dots, T_N$.\n$$T_{clade} = \\min(T_1, T_2, \\dots, T_N)$$\nTo find the distribution of $T_{clade}$, we first derive its survival function, $P(T_{clade} > t)$. The event $T_{clade} > t$ occurs if and only if the waiting time for *every* lineage is greater than $t$. This means $T_1 > t$ AND $T_2 > t$ AND ... AND $T_N > t$.\n$$P(T_{clade} > t) = P(T_1 > t, T_2 > t, \\dots, T_N > t)$$\nBecause the speciation processes for each lineage are independent, the joint probability is the product of the individual probabilities:\n$$P(T_{clade} > t) = \\prod_{i=1}^{N} P(T_i > t)$$\nSince all $T_i$ are identically distributed, $P(T_i > t) = \\exp(-\\lambda t)$ for all $i$. Substituting this into the product gives:\n$$P(T_{clade} > t) = \\prod_{i=1}^{N} \\exp(-\\lambda t) = (\\exp(-\\lambda t))^N = \\exp(-N \\lambda t)$$\nThis expression, $P(T_{clade} > t) = \\exp(-(N\\lambda)t)$, is the survival function of an exponential distribution with a rate parameter equal to $N\\lambda$. This demonstrates the property that the minimum of $N$ i.i.d. exponential random variables with rate $\\lambda$ is itself an exponential random variable with rate $N\\lambda$. The combined process of speciation for the entire clade is a Poisson process with a total rate $\\lambda_{clade} = N\\lambda$.\n\nThe expected value, or mean, of an exponential distribution with rate parameter $r$ is $\\frac{1}{r}$. Therefore, the expected waiting time until the next speciation event in the clade is:\n$$E[T_{clade}] = \\frac{1}{N\\lambda}$$\nThe problem provides the per-lineage speciation rate $\\lambda = 0.3\\,\\mathrm{Myr}^{-1}$. We are asked for an algebraic expression in $N$. Substituting the value of $\\lambda$:\n$$E[T_{clade}] = \\frac{1}{N \\cdot 0.3}$$\nTo present this as a simplified algebraic expression, we can write $0.3$ as the fraction $\\frac{3}{10}$:\n$$E[T_{clade}] = \\frac{1}{N \\left(\\frac{3}{10}\\right)} = \\frac{10}{3N}$$\nThe units of this expression are million years (Myr), as the rate $\\lambda$ was given in units of $\\mathrm{Myr}^{-1}$. This is the required result derived from first principles.", "answer": "$$\\boxed{\\frac{10}{3N}}$$", "id": "2584181"}, {"introduction": "After mastering the mechanics of birth-death models, a central task in comparative biology is to use empirical data to test competing evolutionary hypotheses. For instance, did a key innovation truly trigger a shift in diversification rates, or is a simpler, constant-rate model sufficient to explain the data? This exercise [@problem_id:2584203] places you in the role of a practicing phylogeneticist, using the outputs of a Bayesian analysis—the marginal log-likelihoods—to select the best model. By calculating and interpreting a Bayes factor, you will learn how to quantitatively weigh the evidence for a diversification-rate shift, a fundamental skill for contemporary macroevolutionary research.", "problem": "A macroevolutionary study of a large angiosperm clade evaluates whether a putative key innovation (e.g., the origin of floral nectar spurs) is associated with a single shift in diversification rate. Two nested birth–death models are compared using Bayesian model comparison with equal prior odds: model $\\mathcal{M}_{0}$ assumes a constant diversification rate across the phylogeny (no shift), and model $\\mathcal{M}_{1}$ allows a single diversification rate shift coincident with the inferred origin of the key innovation. Marginal likelihoods (model evidences) are estimated via a thermodynamic integration procedure and summarized as log-evidences: $\\log \\mathcal{Z}_{1} = -1234.5$ for $\\mathcal{M}_{1}$ and $\\log \\mathcal{Z}_{0} = -1240.9$ for $\\mathcal{M}_{0}$. Using first-principles Bayesian model comparison starting from the definition of marginal likelihood and the definition of the Bayes factor as a ratio of model evidences, compute the Bayes factor in favor of $\\mathcal{M}_{1}$ relative to $\\mathcal{M}_{0}$. Then, based on widely used interpretive conventions in Bayesian model selection, briefly state whether the evidence for a single diversification rate shift associated with the key innovation is weak, moderate, strong, or decisive. Report the Bayes factor as a dimensionless ratio rounded to three significant figures.", "solution": "The problem requires the computation and interpretation of a Bayes factor to compare two competing macroevolutionary models, $\\mathcal{M}_{1}$ and $\\mathcal{M}_{0}$, based on their provided log-evidences. We proceed from the fundamental principles of Bayesian model comparison.\n\nLet $D$ denote the observed data, in this case, the phylogenetic tree and any associated character data. The posterior probability of a model $\\mathcal{M}_{i}$ is given by Bayes' theorem:\n$$P(\\mathcal{M}_{i}|D) = \\frac{P(D|\\mathcal{M}_{i}) P(\\mathcal{M}_{i})}{P(D)}$$\nwhere $P(D|\\mathcal{M}_{i})$ is the marginal likelihood or model evidence, $P(\\mathcal{M}_{i})$ is the prior probability of the model, and $P(D)$ is a normalizing constant.\n\nTo compare two models, $\\mathcal{M}_{1}$ and $\\mathcal{M}_{0}$, we examine the ratio of their posterior probabilities, known as the posterior odds:\n$$\\frac{P(\\mathcal{M}_{1}|D)}{P(\\mathcal{M}_{0}|D)} = \\frac{P(D|\\mathcal{M}_{1})}{P(D|\\mathcal{M}_{0})} \\times \\frac{P(\\mathcal{M}_{1})}{P(\\mathcal{M}_{0})}$$\nThis relationship can be stated as: Posterior Odds = Bayes Factor $\\times$ Prior Odds.\n\nThe Bayes factor, denoted $B_{10}$, is the ratio of the marginal likelihoods:\n$$B_{10} = \\frac{P(D|\\mathcal{M}_{1})}{P(D|\\mathcal{M}_{0})}$$\nThe problem provides the model evidences in the notation $\\mathcal{Z}_{i}$, where $\\mathcal{Z}_{i} \\equiv P(D|\\mathcal{M}_{i})$. Thus, the Bayes factor in favor of $\\mathcal{M}_{1}$ over $\\mathcal{M}_{0}$ is:\n$$B_{10} = \\frac{\\mathcal{Z}_{1}}{\\mathcal{Z}_{0}}$$\nThe problem supplies the log-evidences, $\\log \\mathcal{Z}_{1}$ and $\\log \\mathcal{Z}_{0}$. In the context of Bayesian statistics and methods like thermodynamic integration, the notation '$\\log$' conventionally refers to the natural logarithm, $\\ln$. We will proceed under this standard and necessary assumption.\n\nTo compute $B_{10}$, we first take the natural logarithm of the expression:\n$$\\ln(B_{10}) = \\ln\\left(\\frac{\\mathcal{Z}_{1}}{\\mathcal{Z}_{0}}\\right) = \\ln(\\mathcal{Z}_{1}) - \\ln(\\mathcal{Z}_{0})$$\nThe provided values are $\\ln(\\mathcal{Z}_{1}) = -1234.5$ and $\\ln(\\mathcal{Z}_{0}) = -1240.9$. Substituting these values into the equation:\n$$\\ln(B_{10}) = -1234.5 - (-1240.9) = -1234.5 + 1240.9 = 6.4$$\nTo find the Bayes factor $B_{10}$, we exponentiate the result:\n$$B_{10} = \\exp(\\ln(B_{10})) = \\exp(6.4)$$\nCalculating the numerical value:\n$$B_{10} \\approx 601.845$$\nThe problem requires the answer to be rounded to three significant figures.\n$$B_{10} \\approx 602$$\nThe Bayes factor is a dimensionless ratio. A value of $B_{10} \\approx 602$ indicates that the observed data are approximately $602$ times more probable under model $\\mathcal{M}_{1}$ (with a rate shift) than under model $\\mathcal{M}_{0}$ (with a constant rate).\n\nFor interpretation, we use established conventions, such as the scale proposed by Kass and Raftery (1995). On this scale, a Bayes factor $B_{10} > 150$ is considered to provide \"very strong\" or \"decisive\" evidence in favor of model $\\mathcal{M}_{1}$. Since our calculated value is $B_{10} \\approx 602$, which is substantially greater than $150$, the evidence for a single diversification rate shift associated with the key innovation is decisive. An alternative view using the quantity $2\\ln(B_{10})$ yields $2 \\times 6.4 = 12.8$. A value greater than $10$ on this scale is also considered decisive evidence, confirming our conclusion.", "answer": "$$\\boxed{602}$$", "id": "2584203"}]}