{"hands_on_practices": [{"introduction": "To move beyond a qualitative sense of homology and homoplasy, we need quantitative tools for evaluating character evolution. This first exercise introduces the fundamental indices used in parsimony analysis to measure how well a character fits a given phylogenetic tree, providing a numerical basis for assessing the level of homoplasy. By working through a concrete example [@problem_id:2553250], you will calculate the Consistency Index ($CI$) and Retention Index ($RI$), two key metrics for interpreting the evolutionary signal contained within a single character.", "problem": "You are given an unrooted bifurcating phylogenetic tree on four taxa with topology $((A,B),(C,D))$. Consider a single unordered, non-additive, binary morphological character with observed states: $A:0$, $B:1$, $C:1$, $D:0$. External evidence independently polarizes the character so that state $0$ is ancestral (plesiomorphic) and state $1$ is derived (apomorphic). Using the principle of Maximum Parsimony (MP), compute the following parsimony indices for this single character on the specified tree: the minimum possible number of steps for this character on any tree $m$, the number of steps on the given tree $s$, the Consistency Index (CI), and the Retention Index (RI). Then, interpret these values to explain the homoplasy signal: state clearly whether the observed similarity of the derived state between $B$ and $C$ represents homology or homoplasy on this tree, and, given the polarity, what kind of homoplasy is implied by the mapping.\n\nProvide exact values; no rounding is required. Express the final answer as the ordered quadruple $\\left(m, s, CI, RI\\right)$.", "solution": "We begin from the core definitions in phylogenetic systematics. A character is a heritable trait with discrete character states. Character polarity identifies which state is ancestral (plesiomorphic) and which is derived (apomorphic), typically established by external evidence such as outgroup comparison. Under Maximum Parsimony (MP), the optimal mapping of a character onto a fixed tree minimizes the number of inferred state changes (steps). The minimum number of steps possible for a character across all trees, denoted $m$, is determined by the character’s distribution alone, not by any particular topology. For unordered characters with $r$ observed states, the well-known lower bound is $m = r - 1$. The number of steps on a given tree, denoted $s$, is the minimum count of changes needed to reconcile the observed states with that tree, obtained by algorithms such as the Fitch algorithm. To quantify fit and homoplasy, the Consistency Index (CI) is defined as $CI = \\frac{m}{s}$, and the Retention Index (RI) is defined as $RI = \\frac{g - s}{g - m}$, where $g$ is the maximum possible number of steps for the character across all trees consistent with the observed tip states.\n\nStep 1: Determine $m$ from the character distribution.\nThe character is binary with two observed states, $0$ and $1$; hence $r = 2$, and the general lower bound for unordered characters gives\n$$\nm = r - 1 = 2 - 1 = 1.\n$$\n\nStep 2: Compute $s$ on the specified tree $((A,B),(C,D))$ using the Fitch set method.\nAssign tip states: $A:0$, $B:1$, $C:1$, $D:0$. For the internal node joining $A$ and $B$, the descendant sets are $\\{0\\}$ and $\\{1\\}$; their intersection is empty, so the node set becomes $\\{0,1\\}$ and we incur $1$ step. Similarly, for the internal node joining $C$ and $D$, the descendant sets are $\\{1\\}$ and $\\{0\\}$; the intersection is empty, we assign $\\{0,1\\}$ and incur another $1$ step. For the central edge connecting the two internal nodes, the sets are $\\{0,1\\}$ and $\\{0,1\\}$; the intersection is nonempty, so no additional step is required. Therefore,\n$$\ns = 1 + 1 + 0 = 2.\n$$\n\nStep 3: Compute $CI$.\nBy definition,\n$$\nCI = \\frac{m}{s} = \\frac{1}{2}.\n$$\n\nStep 4: Determine $g$ and compute $RI$.\nFor a binary unordered character with observed counts $n_{0}$ and $n_{1}$ of states $0$ and $1$ among $n$ taxa, the maximum parsimony steps across all trees equals\n$$\ng = \\min\\{n_{0}, n_{1}\\},\n$$\nbecause, at most, the number of steps can be forced to equal the number of instances of the minority state when arranged to maximize changes (and this bound is attainable on appropriate trees). Here, $n_{0} = 2$ and $n_{1} = 2$, so\n$$\ng = \\min\\{2,2\\} = 2.\n$$\nThe Retention Index (RI) is defined as\n$$\nRI = \\frac{g - s}{g - m} = \\frac{2 - 2}{2 - 1} = 0.\n$$\n\nStep 5: Interpret the homoplasy signal with polarity.\nWith state $0$ polarized as ancestral and state $1$ as derived, the mapping of this character onto the given tree requires $s = 2$ changes, exceeding the minimum $m = 1$. Because $CI = \\frac{1}{2} < 1$ and $RI = 0$, the character exhibits homoplasy on this topology, and, relative to its homoplasy potential, it retains none of the expected synapomorphic signal (a zero Retention Index). Specifically, on this tree, the two occurrences of state $1$ in $B$ and $C$ are not explained by a single homologous origin uniting them as sister lineages; instead, the polarized mapping implies either two independent gains of the derived state (convergent evolution, a form of analogy) or a gain followed by a reversal elsewhere. Either explanation constitutes homoplasy, and the value $RI = 0$ indicates that the character displays the maximum number of steps it can possibly have given its distribution ($g = 2$), leaving no retained synapomorphy for the derived state on this topology.\n\nIn summary, the computed indices are\n$$\nm = 1,\\quad s = 2,\\quad CI = \\frac{1}{2},\\quad RI = 0,\n$$\nand the character is homoplastic on the specified tree, with the polarization indicating a scenario of convergence or reversal rather than a single homologous apomorphy.", "answer": "$$\\boxed{\\begin{pmatrix}1 & 2 & \\frac{1}{2} & 0\\end{pmatrix}}$$", "id": "2553250"}, {"introduction": "A single parsimony score can often correspond to multiple, equally parsimonious evolutionary histories, creating ambiguity in our reconstructions. This practice explores two classic methods, Accelerated Transformation (ACCTRAN) and Delayed Transformation (DELTRAN), for resolving this ambiguity [@problem_id:2553246]. You will see how different optimization criteria can lead to vastly different narratives of evolution—one favoring reversals and the other parallel gains—highlighting how assumptions shape our interpretation of homology versus analogy even when the data and tree are fixed.", "problem": "A single unordered binary morphological character $X$ with states $0$ and $1$ is scored for $6$ ingroup taxa $\\{A,B,C,D,E,F\\}$ and a single outgroup $O$. The rooted ingroup topology (rooted at the node joining the ingroup to $O$) is\n$$\n\\bigl(((A,B),C),(D,(E,F))\\bigr),\n$$\nand the observed tip states are\n$$\nX(A)=1,\\quad X(B)=0,\\quad X(C)=1,\\quad X(D)=0,\\quad X(E)=0,\\quad X(F)=0.\n$$\nThe outgroup is fixed to the ancestral (polar) state $X(O)=0$, so that gains are transitions $0\\to 1$ and reversals are transitions $1\\to 0$. Assume standard maximum parsimony with unordered character change costs (all changes count equally) and use the following conceptual bases:\n- Definition of maximum parsimony reconstruction for characters on a tree as minimizing the total number of state changes across edges.\n- The Fitch algorithm for unordered characters: at each internal node, the state set is the intersection of child sets if nonempty, otherwise the union, and each union event contributes exactly one step to the parsimony score.\n- Character polarity is fixed by the outgroup state $0$, but the up-pass resolution of ambiguous internal state sets can differ under alternative step-optimization strategies.\n\nTwo classical optimization conventions for placing the minimal number of changes on branches are considered:\n- Accelerated transformation (ACCTRAN): resolve ambiguities by placing changes as early (closer to the root) as possible, which tends to minimize parallel gains and increase reversals.\n- Delayed transformation (DELTRAN): resolve ambiguities by placing changes as late (closer to the tips) as possible, which tends to minimize reversals and increase parallel gains.\n\nUsing only these principles, determine how many gains ($0\\to 1$) and reversals ($1\\to 0$) are inferred under ACCTRAN and under DELTRAN for this dataset, and infer whether the state $1$ in taxa $A$ and $C$ is treated as homologous (single origin in their most recent common ancestor) or as analogous (homoplastic via independent origins) under each optimization. Choose the single option that is fully correct.\n\nA. Under ACCTRAN there are $1$ gain and $1$ reversal; under DELTRAN there are $2$ gains and $0$ reversals; $A$ and $C$ share homologous state $1$ under ACCTRAN but analogous (homoplastic) state $1$ under DELTRAN.\n\nB. Under ACCTRAN there are $2$ gains and $0$ reversals; under DELTRAN there are $1$ gain and $1$ reversal; $A$ and $C$ share analogous state $1$ under ACCTRAN but homologous state $1$ under DELTRAN.\n\nC. Both ACCTRAN and DELTRAN yield $1$ gain and $0$ reversals because the outgroup fixes polarity; the state $1$ in $A$ and $C$ is homologous under both.\n\nD. Under ACCTRAN there are $1$ gain and $0$ reversals; under DELTRAN there are $0$ gains and $2$ reversals; the state $1$ in $A$ and $C$ is analogous under both.", "solution": "**Derivation**\n\nThe primary task is to determine the most parsimonious reconstructions of character evolution on the given topology and to compare the results under ACCTRAN and DELTRAN optimizations.\n\nFirst, we establish the nodal relationships and label the internal nodes of the tree for clarity. The topology, rooted by the outgroup $O$, is:\n$N_R = \\text{MRCA}(O, \\text{Ingroup})$\n$N_1 = \\text{MRCA}(A,B,C,D,E,F)$\n$N_2 = \\text{MRCA}(A,B,C)$\n$N_3 = \\text{MRCA}(A,B)$\n$N_4 = \\text{MRCA}(D,E,F)$\n$N_5 = \\text{MRCA}(E,F)$\n\nThe states at the tips are: $X(A)=1, X(B)=0, X(C)=1, X(D)=0, X(E)=0, X(F)=0$, and $X(O)=0$.\n\n**1. Parsimony Score Calculation (Fitch's Algorithm, Down-pass)**\n\nWe calculate the minimum number of character state changes (the parsimony score or length, $L$) required to explain the observed distribution of states. This is done via a post-order traversal (down-pass) of the tree, assigning a set of possible states to each internal node.\n- At $N_3 = \\text{MRCA}(A,B)$: State sets are $\\{1\\}$ for $A$ and $\\{0\\}$ for $B$. Their intersection is empty. The union is $\\{0,1\\}$. This step adds $1$ to the score. $S(N_3) = \\{0,1\\}$, $L \\gets 1$.\n- At $N_5 = \\text{MRCA}(E,F)$: State sets are $\\{0\\}$ for $E$ and $\\{0\\}$ for $F$. Their intersection is $\\{0\\}$. $S(N_5) = \\{0\\}$.\n- At $N_2 = \\text{MRCA}(N_3,C)$: State sets are $S(N_3)=\\{0,1\\}$ and $S(C)=\\{1\\}$. Their intersection is $\\{1\\}$. $S(N_2) = \\{1\\}$.\n- At $N_4 = \\text{MRCA}(D,N_5)$: State sets are $S(D)=\\{0\\}$ and $S(N_5)=\\{0\\}$. Their intersection is $\\{0\\}$. $S(N_4) = \\{0\\}$.\n- At $N_1 = \\text{MRCA}(N_2,N_4)$: State sets are $S(N_2)=\\{1\\}$ and $S(N_4)=\\{0\\}$. Their intersection is empty. The union is $\\{0,1\\}$. This step adds another $1$ to the score. $S(N_1) = \\{0,1\\}$, $L \\gets 1+1=2$.\n- At the root $N_R = \\text{MRCA}(O, N_1)$: State sets are $S(O)=\\{0\\}$ and $S(N_1)=\\{0,1\\}$. Their intersection is $\\{0\\}$. $S(N_R) = \\{0\\}$.\n\nThe total parsimony score for this character on this tree is $L=2$. This means a minimum of $2$ state changes are required. The existence of multiple nodes where the down-pass required a union operation (here, $N_3$ and $N_1$) indicates ambiguity in an unordered parsimony framework, leading to multiple Most Parsimonious Reconstructions (MPRs). ACCTRAN and DELTRAN are two alternative conventions for resolving this ambiguity.\n\n**2. ACCTRAN (Accelerated Transformation) Optimization**\n\nACCTRAN resolves ambiguity by favoring transformations earlier (closer to the root) on the tree. This tends to create single origins followed by reversals, rather than multiple parallel origins.\n- The root state is $0$.\n- Following the principle of placing changes early, a single gain ($0 \\to 1$) is hypothesized on the branch leading to $N_2 = \\text{MRCA}(A,B,C)$, as this is the earliest point that can explain the states in that clade. Thus, $X(N_2)=1$.\n- The state $1$ is inherited by $C$ and by $N_3 = \\text{MRCA}(A,B)$. So, $X(N_3)=1$.\n- Taxon $A$ inherits state $1$.\n- Taxon $B$ has state $0$. This requires a reversal ($1 \\to 0$) on the branch leading to $B$.\n- The clade $(D,(E,F))$ retains the ancestral state $0$ throughout.\n- Under this reconstruction:\n  - There is $1$ gain ($0 \\to 1$) on the branch leading to $N_2$.\n  - There is $1$ reversal ($1 \\to 0$) on the branch leading to $B$.\n- The total number of steps is $1+1=2$, which is consistent with the parsimony score.\n- **Homology**: The state $1$ in taxa $A$ and $C$ is derived from their most recent common ancestor, $N_2$, which is reconstructed with state $1$. The state is therefore inferred to be **homologous** under ACCTRAN.\n\n**3. DELTRAN (Delayed Transformation) Optimization**\n\nDELTRAN resolves ambiguity by favoring transformations later (closer to the tips) on the tree. This tends to minimize reversals at the expense of inferring parallel gains (homoplasy).\n- The root state is $0$.\n- To delay changes, the ancestral state $0$ is assumed to be retained as far down the tree as possible.\n- The nodes $N_1$, $N_2$, and $N_3$ are all reconstructed with state $0$.\n- The observed state $1$ in taxon $A$ is explained by a gain ($0 \\to 1$) on the terminal branch leading to $A$.\n- The observed state $1$ in taxon $C$ is explained by a separate, independent gain ($0 \\to 1$) on the terminal branch leading to $C$.\n- All other taxa have state $0$, which is consistent with their ancestors having state $0$. No reversals are necessary.\n- Under this reconstruction:\n  - There are $2$ gains ($0 \\to 1$): one on the branch to $A$ and one on the branch to $C$.\n  - There are $0$ reversals.\n- The total number of steps is $2+0=2$, also consistent with the parsimony score.\n- **Homology**: The state $1$ in taxa $A$ and $C$ arose independently. Their most recent common ancestor, $N_2$, is reconstructed with state $0$. The state is therefore inferred to be **analogous (homoplastic)** under DELTRAN.\n\n**Option-by-Option Analysis**\n\n- **A. Under ACCTRAN there are $1$ gain and $1$ reversal; under DELTRAN there are $2$ gains and $0$ reversals; $A$ and $C$ share homologous state $1$ under ACCTRAN but analogous (homoplastic) state $1$ under DELTRAN.**\n  - This statement precisely matches the derived results for both ACCTRAN and DELTRAN, including the number of gains/reversals and the resulting homology assessment.\n  - **Verdict: Correct.**\n\n- **B. Under ACCTRAN there are $2$ gains and $0$ reversals; under DELTRAN there are $1$ gain and $1$ reversal; $A$ and $C$ share analogous state $1$ under ACCTRAN but homologous state $1$ under DELTRAN.**\n  - This option incorrectly swaps the results of the ACCTRAN and DELTRAN optimizations.\n  - **Verdict: Incorrect.**\n\n- **C. Both ACCTRAN and DELTRAN yield $1$ gain and $0$ reversals because the outgroup fixes polarity; the state $1$ in $A$ and $C$ is homologous under both.**\n  - This is incorrect on multiple counts. The parsimony score is $2$, not $1$. ACCTRAN and DELTRAN give different results precisely because there is ambiguity, which is not eliminated by outgroup polarization.\n  - **Verdict: Incorrect.**\n\n- **D. Under ACCTRAN there are $1$ gain and $0$ reversals; under DELTRAN there are $0$ gains and $2$ reversals; the state $1$ in $A$ and $C$ is analogous under both.**\n  - The stated number of changes for ACCTRAN ($1$ gain, $0$ reversals) totals $1$ step, which contradicts the parsimony score of $2$. The stated DELTRAN result ($0$ gains, $2$ reversals) is nonsensical given the ancestral state is $0$.\n  - **Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2553246"}, {"introduction": "Real-world morphological datasets often contain complexities that challenge simple evolutionary models, such as characters that are logically dependent on one another. This final practice tackles the critical and common issue of inapplicable data (e.g., petal color in a plant that lacks petals) and asks you to evaluate different modern coding and analysis strategies [@problem_id:2553206]. By comparing naive approaches with sophisticated methods in both parsimony and likelihood frameworks, you will learn how to properly model character dependencies to avoid inferring spurious homologies and biologically nonsensical evolutionary events.", "problem": "You are given a discrete morphological dataset for four angiosperm taxa $T_1$, $T_2$, $T_3$, and $T_4$ on two characters: petal presence ($P$) and petal color ($C$). Observations are: $P(T_1)=1$, $P(T_2)=1$, $P(T_3)=0$, $P(T_4)=0$; for color, $C(T_1)=\\text{blue}$, $C(T_2)=\\text{red}$, and color is logically inapplicable for apetalous taxa ($T_3$ and $T_4$). Assume an unrooted tree topology $((T_1,T_2),(T_3,T_4))$ and standard assumptions for discrete character analysis, namely: (i) in parsimony, the minimum number of changes is computed by set intersection and union down a tree, with missing data treated as wildcards; (ii) in likelihood, the Markov $M_k$ model (Mk) with equal rates across states is the baseline for unordered discrete characters.\n\nFundamental definitions you may use:\n- A character state is a discrete, heritable condition of a trait; a state is applicable only when the precursor structure exists. \n- Homology is similarity due to shared ancestry; homoplasy is similarity due to convergence, parallelism, or reversal.\n- An inapplicable entry is not missing information but a logically undefined state given the absence of the relevant structure.\n- In equal-weights parsimony, the step count for a character is the minimum number of state changes across the tree.\n- In a continuous-time Markov chain under $M_k$, the state space, its instantaneous rate matrix $Q$, and any structural zeros in $Q$ determine which transitions can occur and therefore which changes contribute to the likelihood.\n\nYour goal is to choose a coding and analysis strategy for $C$ that avoids spurious homoplasy by ensuring that inferences about $C$ are made only on those branches where $P=1$, and to justify this choice against a strategy that treats inapplicables as missing data. Consider that the conceptually correct domain restriction for $C$ is the induced subtree $T\\mid_{P=1}$ on which $C$ is defined, and that counting or inferring changes for $C$ outside $T\\mid_{P=1}$ would be biologically meaningless.\n\nSelect all options that best satisfy these requirements.\n\nA. Reductive hierarchical coding: code $P$ as a binary character with states $0/1$, code $C$ only for taxa with $P=1$, using a dedicated inapplicable token “$-$” for taxa with $P=0$; analyze under inapplicable-aware equal-weights parsimony that restricts optimization of $C$ to the induced subtree $T\\mid_{P=1}$, so that steps for $C$ are counted only within that subtree.\n\nB. Treat inapplicables for $C$ as missing data “$?$” and analyze under standard equal-weights parsimony; the missing states will float to minimize steps and thus remove bias.\n\nC. Collapse $P$ and $C$ into a single unordered multistate character with states $0=\\text{absent}$, $1=\\text{blue}$, $2=\\text{red}$, analyzed under equal-weights parsimony without any transition constraints.\n\nD. Exclude $C$ from the matrix entirely for all taxa when any inapplicable entries are present, to avoid biased inference.\n\nE. Model dependency under a Bayesian $M_k$-type likelihood by expanding the state space to encode a gating variable for $P$ and color states for $C$, implement structural zeros in the instantaneous rate matrix $Q$ that forbid color transitions when $P=0$ (and allow them only when $P=1$), thereby restricting contributions of $C$ to the likelihood on $T\\mid_{P=1}$, with inapplicable observations treated as structural impossibilities rather than missing data.\n\nYour answer should be justified based on the above foundational definitions, focusing on why the chosen method(s) prevent counting or inferring changes for $C$ on branches where $P=0$, and why treating inapplicables as missing data fails to enforce this domain restriction. Multiple selections may be correct.", "solution": "The problem requires the identification of appropriate methods for coding and analyzing a dependent morphological character, where the dependent character ($C$, petal color) is only applicable if the primary character ($P$, petal presence) is in a specific state ($P=1$). The central objective is to prevent biologically nonsensical inferences, such as changes in petal color occurring on branches of the phylogenetic tree where petals are absent ($P=0$). This amounts to restricting the analysis of character $C$ to the induced subtree, denoted $T\\mid_{P=1}$, where petals are present.\n\nFirst, let us analyze the provided data and tree topology.\nThe taxa are $T_1, T_2, T_3, T_4$.\nThe unrooted tree is $((T_1,T_2),(T_3,T_4))$. This topology consists of two clades, $(T_1, T_2)$ and $(T_3, T_4)$, connected by a central edge.\nThe data for petal presence ($P$) are $P(T_1)=1, P(T_2)=1, P(T_3)=0, P(T_4)=0$.\nThe data for petal color ($C$) are $C(T_1)=\\text{blue}, C(T_2)=\\text{red}$, and inapplicable for $T_3$ and $T_4$.\n\nUnder a parsimony criterion, the evolution of character $P$ is reconstructed unequivocally on this tree. The ancestor of $(T_1, T_2)$ must have had state $P=1$, and the ancestor of $(T_3, T_4)$ must have had state $P=0$. The single change in character $P$ occurs on the central branch connecting these two ancestral nodes. Consequently, the induced subtree $T\\mid_{P=1}$ where character $C$ is applicable consists of taxa $T_1$, $T_2$, and the branch connecting them to their common ancestor. The goal is to find a method that analyzes changes in $C$ exclusively on this subtree.\n\nWe shall now evaluate each proposed option.\n\n**A. Reductive hierarchical coding: code $P$ as a binary character with states $0/1$, code $C$ only for taxa with $P=1$, using a dedicated inapplicable token “$-$” for taxa with $P=0$; analyze under inapplicable-aware equal-weights parsimony that restricts optimization of $C$ to the induced subtree $T\\mid_{P=1}$, so that steps for $C$ are counted only within that subtree.**\n\nThis option describes the \"reductive coding\" method coupled with a specialized parsimony algorithm. The characters are kept separate. Character $P$ is coded as $\\{0, 1\\}$. Character $C$ is coded as $\\{\\text{blue}, \\text{red}\\}$ for $T_1$ and $T_2$, and a special symbol '$-$' for $T_3$ and $T_4$ to denote inapplicability. The crucial part is the analysis: \"inapplicable-aware ... parsimony.\" This class of algorithms (e.g., the one proposed by Maddison in 1993) operates in two passes. First, it optimizes the primary character ($P$) over the entire tree. Second, it identifies the subtrees where the dependent character ($C$) is applicable (in this case, the subtree where $P=1$ is reconstructed). Finally, it optimizes character $C$ *only* within this restricted subtree.\n\nIn our specific case, the algorithm identifies $T\\mid_{P=1}$ as the clade containing $T_1$ and $T_2$. Within this clade, $T_1$ has state `blue` and $T_2$ has state `red`. This requires a minimum of one step (a change from `blue` to `red` or vice versa). No steps for $C$ are counted or even considered on the part of the tree leading to $T_3$ and $T_4$, as $P=0$ is reconstructed there. This method directly and correctly enforces the logical dependency, avoiding any spurious inference of color evolution in apetalous lineages. It perfectly aligns with the problem's stated goal.\n\nVerdict: **Correct**.\n\n**B. Treat inapplicables for $C$ as missing data “$?$” and analyze under standard equal-weights parsimony; the missing states will float to minimize steps and thus remove bias.**\n\nThis option proposes conflating logical inapplicability (`-`) with epistemic uncertainty (`?`). Under standard parsimony (e.g., the Fitch algorithm), a `?` is treated as a wildcard, meaning the taxon can be assigned any possible state (`blue` or `red` in this case) if that assignment minimizes the total number of steps for the character on the tree.\n\nLet us trace the consequence. The states for $C$ would be $C(T_1)=\\{\\text{blue}\\}$, $C(T_2)=\\{\\text{red}\\}$, $C(T_3)=\\{\\text{blue}, \\text{red}\\}$, $C(T_4)=\\{\\text{blue}, \\text{red}\\}$. The parsimony algorithm seeks a global minimum for steps. One such minimum-step ($1$ step) reconstruction would assign state `blue` to the ancestor of the entire tree, and by extension assign state `blue` to taxa $T_3$ and $T_4$. This reconstruction postulates a single change (`blue` $\\rightarrow$ `red`) on the branch leading to $T_2$. While the step count might seem reasonable, the underlying state assignments are biologically nonsensical. It implies that the apetalous taxa $T_3$ and $T_4$ have an attribute of `blue` petals, which they do not possess. This creates a spurious hypothesis of homology for \"blue petals\" between $T_1$ and the apetalous taxa $T_3$ and $T_4$. The claim that this \"removes bias\" is false; it actively introduces a bias by making biologically impossible claims to minimize a cost function that is blind to the logical dependency.\n\nVerdict: **Incorrect**.\n\n**C. Collapse $P$ and $C$ into a single unordered multistate character with states $0=\\text{absent}$, $1=\\text{blue}$, $2=\\text{red}$, analyzed under equal-weights parsimony without any transition constraints.**\n\nThis describes \"composite coding.\" The states of $P$ and $C$ are combined into a single character. For our data, the states are $T_1 \\rightarrow 1$ (blue), $T_2 \\rightarrow 2$ (red), $T_3 \\rightarrow 0$ (absent), $T_4 \\rightarrow 0$ (absent). The analysis is under equal-weights parsimony for an unordered character. This implies that the cost of any state change is equal, i.e., the cost of $0 \\leftrightarrow 1$ equals the cost of $0 \\leftrightarrow 2$ equals the cost of $1 \\leftrightarrow 2$, all being $1$ step.\n\nThis model is biologically flawed because it equates fundamentally different evolutionary events. The transition $0 \\rightarrow 1$ represents the *gain* of a complex structure (petals, which are blue). The transition $1 \\rightarrow 2$ represents a *modification* of that existing structure (change in pigment from blue to red). It is highly implausible that these events have equal evolutionary costs or probabilities. An unordered model allows for nonsensical pathways, such as a direct transformation from blue petals to red petals via a loss and regain of the petals themselves (e.g., $1 \\rightarrow 0 \\rightarrow 2$), if it minimizes the global step count. Such a model fails to respect the hierarchical nature of the characters. A more appropriate, but not proposed, composite coding scheme would use an ordered or partially ordered model with a step matrix to assign different costs to different transitions, but that is not what this option describes.\n\nVerdict: **Incorrect**.\n\n**D. Exclude $C$ from the matrix entirely for all taxa when any inapplicable entries are present, to avoid biased inference.**\n\nThis option proposes to discard the character $C$ altogether. While this strategy successfully avoids making incorrect inferences about the evolution of character $C$, it does so by making no inference at all. Character $C$ contains valid phylogenetic information: the difference in color state differentiates taxa $T_1$ and $T_2$. Discarding the character means losing this information and reducing the power of the phylogenetic analysis. The goal of scientific methodology is to analyze available data correctly, not to discard it preemptively due to methodological challenges, especially when valid methods exist to handle such challenges.\n\nVerdict: **Incorrect**.\n\n**E. Model dependency under a Bayesian $M_k$-type likelihood by expanding the state space to encode a gating variable for $P$ and color states for $C$, implement structural zeros in the instantaneous rate matrix $Q$ that forbid color transitions when $P=0$ (and allow them only when $P=1$), thereby restricting contributions of $C$ to the likelihood on $T\\mid_{P=1}$, with inapplicable observations treated as structural impossibilities rather than missing data.**\n\nThis option describes the correct way to handle character dependency in a probabilistic framework (Maximum Likelihood or Bayesian Inference). The method involves creating a composite state space, for example, with states $S_0 = \\{\\text{petals absent}\\}$, $S_1 = \\{\\text{petals present, blue}\\}$, $S_2 = \\{\\text{petals present, red}\\}$. The crucial element is the construction of the instantaneous rate matrix, $Q$. By implementing \"structural zeros,\" we set the rates of impossible transitions to $0$. For example, a direct transition from blue to red ($S_1 \\leftrightarrow S_2$) is allowed, representing a change in color. Transitions from absent to present ($S_0 \\leftrightarrow S_1$ or $S_0 \\leftrightarrow S_2$) are also allowed, representing the gain/loss of the structure. The model's structure intrinsically forbids a \"color change\" from occurring in the \"absent\" state because no such states exist in the state space.\n\nFor a taxon with inapplicable data (e.g., $T_3$), the observation is not treated as \"missing,\" where all states $S_0, S_1, S_2$ would be equally probable a priori. Instead, it is treated as a \"structural impossibility\" for states $S_1$ and $S_2$. The likelihood of the data for taxon $T_3$ is $1.0$ for state $S_0$ and $0.0$ for states $S_1$ and $S_2$. This enforces the domain restriction within the likelihood calculation. The contribution of color evolution to the total likelihood of the tree is thus confined to branches where the model infers the presence of petals ($P=1$). This is the probabilistic analogue of the method in Option A and represents a rigorous, model-based solution.\n\nVerdict: **Correct**.\n\nIn conclusion, both Option A and Option E provide theoretically sound and practically implemented solutions to the problem of inapplicable data. Option A is the correct approach within the parsimony framework, and Option E is the correct approach within the probabilistic (likelihood/Bayesian) framework. Both methods correctly formalize the biological dependency and avoid the pitfalls of the alternative, flawed methods described in Options B, C, and D. Therefore, both are correct answers.", "answer": "$$\\boxed{AE}$$", "id": "2553206"}]}