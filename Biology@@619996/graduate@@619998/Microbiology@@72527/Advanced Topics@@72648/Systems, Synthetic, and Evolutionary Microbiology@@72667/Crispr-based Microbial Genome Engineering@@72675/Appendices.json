{"hands_on_practices": [{"introduction": "Effective genome engineering begins with choosing the right tool for the job. In this exercise, you'll step into the role of a microbial geneticist to compare two of the most powerful CRISPR nucleases, $\\text{SpCas9}$ and $\\text{Cas12a}$. By analyzing their distinct Protospacer Adjacent Motif (PAM) requirements in the context of genomes with different base compositions, you will learn to quantitatively predict which nuclease offers a higher density of targetable sites [@problem_id:2484582]. This practice is crucial for developing the strategic thinking needed to design efficient editing experiments tailored to a specific organism's unique genomic landscape.", "problem": "A microbial geneticist must choose between Streptococcus pyogenes Cas9 (SpCas9) and Cas12a (also known as Cpf1) for genome engineering in two bacteria. SpCas9 requires a protospacer adjacent motif (PAM) of the form NGG that lies $3^{\\prime}$ of the protospacer on the non-target strand and generates predominantly blunt double-strand breaks close to the PAM. Cas12a requires a PAM of the form TTTV (V denotes A, C, or G) that lies $5^{\\prime}$ of the protospacer on the non-target strand and generates staggered double-strand breaks distal to the PAM. For transcriptional repression by catalytically inactivated nucleases (CRISPR interference), a well-tested observation in bacteria is that deactivated SpCas9 (dSpCas9) yields stronger repression when the guide RNA targets the non-template (coding) strand, whereas deactivated Cas12a (dCas12a) yields stronger repression when the guide RNA targets the template strand. Assume standard bacterial transcription in which RNA polymerase reads the template strand $3^{\\prime}\\to 5^{\\prime}$ to synthesize RNA $5^{\\prime}\\to 3^{\\prime}$.\n\nTwo microbes are under consideration:\n- Microbe X has genomic guanine-cytosine content $g_X = 0.70$ (that is, $70\\%$ guanine-cytosine).\n- Microbe Y has genomic guanine-cytosine content $g_Y = 0.30$.\n\nFor approximating PAM availability genome-wide, use the following independence model for base composition: at any genomic position, the probability of base G is $p(\\mathrm{G}) = g/2$, the probability of base C is $p(\\mathrm{C}) = g/2$, the probability of base A is $p(\\mathrm{A}) = (1-g)/2$, and the probability of base T is $p(\\mathrm{T}) = (1-g)/2$, with bases occurring independently between positions on a strand. Under this model, the per-position probability of an NGG PAM on a given strand can be approximated by $p(\\mathrm{NGG}) \\approx p(\\mathrm{G})^{2}$, and the per-position probability of a TTTV PAM by $p(\\mathrm{TTTV}) \\approx p(\\mathrm{T})^{3}\\,[1 - p(\\mathrm{T})]$.\n\nThe geneticist has two tasks in each microbe:\n- Task 1: Create small gene knockouts by making double-strand breaks within $\\pm 50~\\mathrm{bp}$ around start codons across many genes, prioritizing high genome-wide PAM density near these sites.\n- Task 2: Repress an essential gene by CRISPR interference, choosing the guide orientation (template versus non-template strand) to maximize repression.\n\nWhich of the following combined choices best follows from the PAM requirements, strand biases, and the base-composition model?\n\nA. Use SpCas9 for Microbe X and Cas12a for Microbe Y to maximize PAM availability for Task $1$. For Task $2$, design dSpCas9 guides on the non-template strand and dCas12a guides on the template strand.\n\nB. Use Cas12a for Microbe X and SpCas9 for Microbe Y to maximize PAM availability for Task $1$. For Task $2$, design both dSpCas9 and dCas12a guides on the non-template strand.\n\nC. Use SpCas9 for both microbes because NGG is frequent due to the degenerate N. For Task $2$, strand choice is irrelevant for both dSpCas9 and dCas12a.\n\nD. Use Cas12a for both microbes because TTTV permits three options at V. For Task $2$, design both dSpCas9 and dCas12a guides on the template strand.\n\nE. Use SpCas9 for Microbe X and Cas12a for Microbe Y for Task $1$, but for Task $2$, design dSpCas9 guides on the template strand and dCas12a guides on the non-template strand to align the PAM-proximal side with RNA polymerase approach.", "solution": "The problem statement must first be validated for scientific and logical integrity.\n\nStep 1: Extract Givens\n- Nuclease 1: Streptococcus pyogenes Cas9 ($\\text{SpCas9}$)\n    - Protospacer Adjacent Motif (PAM): $\\text{NGG}$, located $3^{\\prime}$ of the protospacer on the non-target strand.\n    - Action: Generates blunt double-strand breaks (DSBs) near the PAM.\n    - CRISPR interference (d$\\text{SpCas9}$): Stronger repression when the guide RNA targets the non-template (coding) strand.\n- Nuclease 2: $\\text{Cas12a}$ (also known as $\\text{Cpf1}$)\n    - PAM: $\\text{TTTV}$ (where $\\text{V}$ is $\\text{A}$, $\\text{C}$, or $\\text{G}$), located $5^{\\prime}$ of the protospacer on the non-target strand.\n    - Action: Generates staggered DSBs distal to the PAM.\n    - CRISPR interference (d$\\text{Cas12a}$): Stronger repression when the guide RNA targets the template strand.\n- Transcription: RNA polymerase reads the template strand $3^{\\prime}\\to 5^{\\prime}$ to synthesize RNA $5^{\\prime}\\to 3^{\\prime}$.\n- Microbe X: Genomic guanine-cytosine (GC) content $g_X = 0.70$.\n- Microbe Y: Genomic GC content $g_Y = 0.30$.\n- Base Composition Model: At any position, base probabilities are $p(\\mathrm{G}) = g/2$, $p(\\mathrm{C}) = g/2$, $p(\\mathrm{A}) = (1-g)/2$, and $p(\\mathrm{T}) = (1-g)/2$. Bases are independent.\n- PAM Probability Approximations:\n    - $p(\\mathrm{NGG}) \\approx p(\\mathrm{G})^{2}$\n    - $p(\\mathrm{TTTV}) \\approx p(\\mathrm{T})^{3}\\,[1 - p(\\mathrm{T})]$\n- Task 1: Create gene knockouts, prioritizing high genome-wide PAM density.\n- Task 2: Repress an essential gene using CRISPR interference, maximizing repression.\n\nStep 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The properties described for $\\text{SpCas9}$ and $\\text{Cas12a}$ (PAM sequences, PAM locations, cut type, and CRISPRi strand bias) are consistent with established findings in the field of molecular biology and genome engineering. The GC content values for the microbes are realistic.\n- **Well-Posedness**: The problem provides a clear objective (identify the best strategy) and sufficient quantitative information (GC content, probability models) to reach a determinate solution.\n- **Consistency**: The provided probability models are internally consistent. The formula for $p(\\text{NGG})$ is $p(\\text{N})p(\\text{G})p(\\text{G}) = 1 \\cdot p(\\text{G}) \\cdot p(\\text{G}) = p(\\text{G})^2$, which matches the provided approximation $p(\\text{NGG}) \\approx p(\\text{G})^2$. The formula for $p(\\text{TTTV})$ is $p(\\text{T})p(\\text{T})p(\\text{T})p(\\text{V}) = p(\\text{T})^3 (p(\\text{A})+p(\\text{C})+p(\\text{G})) = p(\\text{T})^3 (1-p(\\text{T}))$, which also matches the provided approximation. The use of '$\\approx$' is acceptable as it reflects that this is a simplified model of a complex biological reality. The problem is free of contradictions.\n- **Objectivity**: The problem is stated using precise, objective language and quantitative data. No subjective claims are made.\n\nStep 3: Verdict and Action\nThe problem statement is scientifically sound, well-posed, internally consistent, and objective. It is valid. I will proceed with the solution.\n\nThe problem requires a two-part analysis: first, determining the optimal nuclease for knockouts (Task $1$) based on PAM density, and second, identifying the correct strand targeting strategy for CRISPR interference (Task $2$) based on the given rules.\n\n**Analysis for Task 1: PAM Density**\n\nWe must calculate and compare the probabilities of finding an $\\text{SpCas9}$ PAM ($\\text{NGG}$) versus a $\\text{Cas12a}$ PAM ($\\text{TTTV}$) in each microbe's genome.\n\nFor Microbe X, the GC content is $g_X = 0.70$.\nThe probabilities for each base are:\n- $p_X(\\mathrm{G}) = g_X/2 = 0.70/2 = 0.35$\n- $p_X(\\mathrm{T}) = (1-g_X)/2 = (1-0.70)/2 = 0.30/2 = 0.15$\n\nThe PAM probabilities for Microbe X are:\n- For $\\text{SpCas9}$: $p_X(\\mathrm{NGG}) \\approx (p_X(\\mathrm{G}))^2 = (0.35)^2 = 0.1225$\n- For $\\text{Cas12a}$: $p_X(\\mathrm{TTTV}) \\approx (p_X(\\mathrm{T}))^3 (1-p_X(\\mathrm{T})) = (0.15)^3 (1-0.15) = 0.003375 \\times 0.85 = 0.00286875$\n\nComparing the probabilities for Microbe X: $0.1225 > 0.00286875$. Therefore, $\\text{SpCas9}$ provides a significantly higher PAM density in Microbe X.\n\nFor Microbe Y, the GC content is $g_Y = 0.30$.\nThe probabilities for each base are:\n- $p_Y(\\mathrm{G}) = g_Y/2 = 0.30/2 = 0.15$\n- $p_Y(\\mathrm{T}) = (1-g_Y)/2 = (1-0.30)/2 = 0.70/2 = 0.35$\n\nThe PAM probabilities for Microbe Y are:\n- For $\\text{SpCas9}$: $p_Y(\\mathrm{NGG}) \\approx (p_Y(\\mathrm{G}))^2 = (0.15)^2 = 0.0225$\n- For $\\text{Cas12a}$: $p_Y(\\mathrm{TTTV}) \\approx (p_Y(\\mathrm{T}))^3 (1-p_Y(\\mathrm{T})) = (0.35)^3 (1-0.35) = 0.042875 \\times 0.65 = 0.02786875$\n\nComparing the probabilities for Microbe Y: $0.02786875 > 0.0225$. Therefore, $\\text{Cas12a}$ provides a higher PAM density in Microbe Y.\n\nConclusion for Task $1$: To maximize PAM availability for gene knockouts, the geneticist should use $\\text{SpCas9}$ for Microbe X and $\\text{Cas12a}$ for Microbe Y.\n\n**Analysis for Task 2: CRISPR Interference**\n\nThis part of the problem does not require calculation but a direct application of the rules stated in the premise.\n- For d$\\text{SpCas9}$: The problem states it \"yields stronger repression when the guide RNA targets the non-template (coding) strand\".\n- For d$\\text{Cas12a}$: The problem states it \"yields stronger repression when the guide RNA targets the template strand\".\n\nConclusion for Task $2$: To maximize repression, d$\\text{SpCas9}$ guides must be designed to target the non-template strand, and d$\\text{Cas12a}$ guides must be designed to target the template strand.\n\n**Combined Strategy**\nCombining the conclusions for both tasks, the optimal strategy is:\n1.  For Task $1$, use $\\text{SpCas9}$ in Microbe X and $\\text{Cas12a}$ in Microbe Y.\n2.  For Task $2$, when using d$\\text{SpCas9}$, target the non-template strand. When using d$\\text{Cas12a}$, target the template strand.\n\n**Evaluation of Options**\n\nA. Use $\\text{SpCas9}$ for Microbe X and $\\text{Cas12a}$ for Microbe Y to maximize PAM availability for Task $1$. For Task $2$, design d$\\text{SpCas9}$ guides on the non-template strand and d$\\text{Cas12a}$ guides on the template strand.\n- The choice of nucleases for Task $1$ ($\\text{SpCas9}$ for X, $\\text{Cas12a}$ for Y) matches our quantitative analysis.\n- The strand targeting rules for Task $2$ (d$\\text{SpCas9}$ on non-template, d$\\text{Cas12a}$ on template) match the premises of the problem.\n- Verdict: **Correct**.\n\nB. Use $\\text{Cas12a}$ for Microbe X and $\\text{SpCas9}$ for Microbe Y to maximize PAM availability for Task $1$. For Task $2$, design both d$\\text{SpCas9}$ and d$\\text{Cas12a}$ guides on the non-template strand.\n- The choice of nucleases for Task $1$ is the opposite of what our analysis showed.\n- The strand targeting for d$\\text{Cas12a}$ is incorrect according to the problem statement.\n- Verdict: **Incorrect**.\n\nC. Use $\\text{SpCas9}$ for both microbes because $\\text{NGG}$ is frequent due to the degenerate N. For Task $2$, strand choice is irrelevant for both d$\\text{SpCas9}$ and d$\\text{Cas12a}$.\n- The choice to use $\\text{SpCas9}$ for Microbe Y is suboptimal, as our calculations showed $\\text{Cas12a}$ has a higher PAM density there. The qualitative reasoning is insufficient.\n- The claim that strand choice is irrelevant for Task $2$ directly contradicts the problem's premises.\n- Verdict: **Incorrect**.\n\nD. Use $\\text{Cas12a}$ for both microbes because $\\text{TTTV}$ permits three options at V. For Task $2$, design both d$\\text{SpCas9}$ and d$\\text{Cas12a}$ guides on the template strand.\n- The choice to use $\\text{Cas12a}$ for Microbe X is suboptimal, as $\\text{SpCas9}$ has a much higher PAM density.\n- The strand targeting for d$\\text{SpCas9}$ is incorrect according to the problem statement.\n- Verdict: **Incorrect**.\n\nE. Use $\\text{SpCas9}$ for Microbe X and $\\text{Cas12a}$ for Microbe Y for Task $1$, but for Task $2$, design d$\\text{SpCas9}$ guides on the template strand and d$\\text{Cas12a}$ guides on the non-template strand to align the PAM-proximal side with RNA polymerase approach.\n- The choice of nucleases for Task $1$ is correct.\n- The strand targeting rules for Task $2$ are the exact opposite of what the problem provides as \"a well-tested observation\". One must follow the premises, not theoretical justifications that contradict them.\n- Verdict: **Incorrect**.\n\nBased on a systematic application of the provided model and rules, only option A is fully consistent with the analysis.", "answer": "$$\\boxed{A}$$", "id": "2484582"}, {"introduction": "After performing a genome editing experiment, a key challenge is confirming that the edit was successful, especially if it occurs at a low frequency. This problem tackles the critical issue of experimental design by asking you to determine the minimum sequencing depth, $n$, needed to detect a rare allele present at frequency $f$ with a desired level of confidence, $1-\\beta$ [@problem_id:2484660]. By applying a binomial detection model, you will derive a fundamental formula that balances experimental cost against statistical power, an essential trade-off in modern genomics research.", "problem": "A microbial population of engineered bacteria is subjected to Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR)-based editing to introduce a specific single-nucleotide change. Following editing and outgrowth, you perform next-generation sequencing (NGS) to assess whether the edit is present in the population. Assume the following biologically and statistically grounded conditions hold:\n- Each sequencing read independently samples a single genome from the population and reports the true allele without error because the edited allele is uniquely identifiable by a diagnostic variant-specific sequence context and high-fidelity chemistry.\n- The true fraction of genomes carrying the edit is $f$, with $0 < f < 1$.\n- You will declare the edit “detected” if at least one read among $n$ total reads contains the edited allele.\n- You require that the probability of detecting the edit is at least $1-\\beta$, where $0 < \\beta < 1$ quantifies the tolerated probability of failing to detect the edit when it is present at frequency $f$.\n\nUsing a binomial detection model based on independent Bernoulli sampling from the population, derive from first principles an exact, closed-form expression for the minimal integer read depth required to satisfy the detection criterion as a function of $f$ and $\\beta$. Express your final answer as a symbolic expression in terms of $f$ and $\\beta$ using the natural logarithm function, and give the minimal integer read count (no units are required in the final boxed expression). Do not approximate unless justified, and do not provide an inequality as your final result.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- The true fraction of genomes carrying a specific edit is $f$, where $0 < f < 1$.\n- A total of $n$ sequencing reads are generated.\n- Each read independently samples a single genome from the population.\n- The sequencing process reports the true allele without error.\n- The edit is considered \"detected\" if at least one read among the $n$ total reads contains the edited allele.\n- The required probability of detecting the edit must be at least $1-\\beta$.\n- $\\beta$ is the tolerated probability of failing to detect the edit, where $0 < \\beta < 1$.\n- The detection model is based on independent Bernoulli sampling leading to a binomial distribution.\n- The objective is to derive an exact, closed-form expression for the minimal integer read depth, $n$, as a function of $f$ and $\\beta$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard application of probability theory to experimental design in genomics, specifically for determining the required sequencing depth to detect a variant. The assumptions, such as independent sampling and a binomial model, are standard and appropriate for this context. The problem provides all necessary information and contains no contradictions, ambiguities, or factual errors.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\nThe problem requires determining the minimal number of sequencing reads, $n$, to detect a genetic edit present at a frequency $f$ with a specified confidence level. Let each sequencing read be an independent Bernoulli trial. The outcome of a single trial is a \"success\" if the read contains the edited allele and a \"failure\" otherwise.\n\nThe probability of success in a single trial is given by the true fraction of edited genomes in the population, which is $f$.\nThe probability of failure in a single trial is therefore $1-f$.\n\nLet $X$ be the random variable representing the number of reads containing the edited allele out of a total of $n$ reads. Since the reads are independent samples, $X$ follows a binomial distribution with parameters $n$ (number of trials) and $f$ (probability of success). We write this as $X \\sim \\text{Binomial}(n, f)$. The probability mass function is given by:\n$$P(X=k) = \\binom{n}{k} f^{k} (1-f)^{n-k}$$\nfor $k \\in \\{0, 1, 2, \\ldots, n\\}$.\n\nAccording to the problem, the edit is \"detected\" if at least one read contains the edited allele. This corresponds to the event $X \\ge 1$. The probability of this event is $P(X \\ge 1)$.\n\nThe problem requires that this probability of detection be at least $1-\\beta$:\n$$P(X \\ge 1) \\ge 1-\\beta$$\n\nIt is more convenient to work with the complementary event, which is the failure to detect the edit. This occurs if and only if zero reads contain the edited allele, corresponding to the event $X=0$. The relationship between the two events is:\n$$P(X \\ge 1) = 1 - P(X=0)$$\n\nSubstituting this into our requirement inequality:\n$$1 - P(X=0) \\ge 1-\\beta$$\nSubtracting $1$ from both sides gives:\n$$-P(X=0) \\ge -\\beta$$\nMultiplying by $-1$ reverses the inequality:\n$$P(X=0) \\le \\beta$$\n\nThis inequality states that the probability of failing to detect the edit must be no greater than the tolerated failure probability, $\\beta$.\n\nWe can now calculate $P(X=0)$ using the binomial probability mass function:\n$$P(X=0) = \\binom{n}{0} f^{0} (1-f)^{n-0} = (1) \\cdot (1) \\cdot (1-f)^{n} = (1-f)^{n}$$\n\nSubstituting this expression back into the inequality gives:\n$$(1-f)^{n} \\le \\beta$$\n\nTo solve for $n$, we take the natural logarithm of both sides. Since both $1-f$ and $\\beta$ are strictly between $0$ and $1$ (given $0 < f < 1$ and $0 < \\beta < 1$), their natural logarithms are well-defined and negative.\n$$\\ln\\left((1-f)^{n}\\right) \\le \\ln(\\beta)$$\nUsing the logarithm power rule, $\\ln(a^{b}) = b \\ln(a)$:\n$$n \\ln(1-f) \\le \\ln(\\beta)$$\n\nTo isolate $n$, we must divide by $\\ln(1-f)$. As established, $\\ln(1-f)$ is a negative number. Dividing an inequality by a negative number reverses the direction of the inequality sign.\n$$n \\ge \\frac{\\ln(\\beta)}{\\ln(1-f)}$$\n\nThis expression provides the lower bound for the number of reads $n$. The problem asks for the *minimal integer* read depth that satisfies this condition. If the right-hand side is not an integer, say $n \\ge C$, then the smallest integer $n$ satisfying this is $\\lfloor C \\rfloor + 1$ if $C$ is not an integer, and $C$ if $C$ is an integer. This is precisely the definition of the ceiling function, $\\lceil C \\rceil$.\n\nTherefore, the minimal integer number of reads required, $n_{\\text{min}}$, is the ceiling of the derived expression.\n$$n_{\\text{min}} = \\left\\lceil \\frac{\\ln(\\beta)}{\\ln(1-f)} \\right\\rceil$$\nThis is the final, exact, closed-form expression for the minimal integer read depth required to satisfy the detection criterion.", "answer": "$$\\boxed{\\left\\lceil \\frac{\\ln(\\beta)}{\\ln(1-f)} \\right\\rceil}$$", "id": "2484660"}, {"introduction": "Once you have collected sequencing data from your editing experiment, the next step is to rigorously quantify the outcome. This exercise guides you through the statistical foundation of analyzing pooled sequencing results by deriving the maximum likelihood estimator (MLE) for an editing efficiency, $p$ [@problem_id:2484587]. You will also construct a confidence interval for your estimate, learning how to not only report the most likely success rate but also to communicate the statistical uncertainty surrounding it, which is the hallmark of robust scientific reporting.", "problem": "A pooled editing experiment is performed to quantify the efficiency of Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR)-based genome editing in a bacterial population. After editing, an amplicon is sequenced by next-generation sequencing, producing $n$ independent reads, each of which can be classified as either edited or unedited at the target locus. Assume each read arises from an independent and identical Bernoulli trial with success probability $p$, where a success is an edited read. Under these assumptions, the count of edited reads $K$ follows a binomial distribution with parameters $n$ and $p$.\n\nStarting from the definition of the binomial likelihood for $K=k$ under parameter $p$, derive:\n- the maximum likelihood estimator $\\hat{p}$ of $p$,\n- the large-sample two-sided $(1-\\alpha)$ confidence interval for $p$ obtained by inverting the asymptotic normal approximation of the maximum likelihood estimator using the Fisher information.\n\nThen, for the dataset with $k=312$ edited reads out of $n=1000$ total reads, compute the numerical value of $\\hat{p}$ and the endpoints of the $95\\%$ confidence interval, taking $z_{1-\\alpha/2}=1.96$ for $\\alpha=0.05$. Express all probabilities as decimals. Round your final numerical results to four significant figures. In your final numerical answer, report the triplet $\\left(\\hat{p},\\text{lower},\\text{upper}\\right)$ in that order.", "solution": "The problem statement is first subjected to validation.\n\n**Step 1: Extract Givens**\n- The number of independent reads is $n$.\n- Each read is an independent and identical Bernoulli trial.\n- The probability of a success (an edited read) is $p$.\n- The count of edited reads, $K$, follows a binomial distribution: $K \\sim \\text{Binomial}(n, p)$.\n- A specific dataset is given with $k=312$ edited reads out of $n=1000$ total reads.\n- We must derive the maximum likelihood estimator (MLE) $\\hat{p}$ of $p$.\n- We must derive the large-sample two-sided $(1-\\alpha)$ confidence interval for $p$ by inverting the asymptotic normal approximation of the MLE using the Fisher information.\n- We must compute the numerical value of $\\hat{p}$ and the $95\\%$ confidence interval for the given dataset.\n- The confidence level is $95\\%$, so $1-\\alpha = 0.95$, which corresponds to $\\alpha=0.05$.\n- The standard normal quantile is given as $z_{1-\\alpha/2} = 1.96$.\n- Final numerical results must be rounded to four significant figures.\n- The final numerical answer must be reported as a triplet $(\\hat{p}, \\text{lower bound}, \\text{upper bound})$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, using a standard statistical model (Binomial distribution) for a common application in genomics (quantifying next-generation sequencing results). The problem is well-posed, objective, and self-contained, providing all necessary information for the required derivations and calculations. It does not violate any fundamental principles, is not based on false premises, and contains no ambiguities or contradictions. The data provided ($n=1000$, $k=312$) are realistic for the described experimental context. The problem requires standard, non-trivial derivations from the field of mathematical statistics.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be provided.\n\nThe probability mass function for a binomial random variable $K$ with parameters $n$ and $p$ is given by $P(K=k | n, p) = \\binom{n}{k} p^k (1-p)^{n-k}$. For a fixed observation $k$, this function, viewed as a function of the parameter $p$, is the likelihood function $L(p|k)$.\n$$L(p|k) = \\binom{n}{k} p^k (1-p)^{n-k}$$\nTo find the maximum likelihood estimator (MLE) $\\hat{p}$, we maximize $L(p|k)$ with respect to $p$. It is computationally simpler to maximize the log-likelihood function, $\\ell(p|k) = \\ln L(p|k)$, as the logarithm is a monotonic function.\n$$\\ell(p|k) = \\ln\\left(\\binom{n}{k}\\right) + k\\ln(p) + (n-k)\\ln(1-p)$$\nWe find the maximum by taking the first derivative of $\\ell(p|k)$ with respect to $p$ and setting it to zero.\n$$\\frac{d\\ell}{dp} = \\frac{k}{p} - \\frac{n-k}{1-p}$$\nSetting this derivative to zero to find the critical point $\\hat{p}$:\n$$\\frac{k}{\\hat{p}} - \\frac{n-k}{1-\\hat{p}} = 0 \\implies \\frac{k}{\\hat{p}} = \\frac{n-k}{1-\\hat{p}}$$\n$$k(1-\\hat{p}) = \\hat{p}(n-k)$$\n$$k - k\\hat{p} = n\\hat{p} - k\\hat{p}$$\n$$k = n\\hat{p}$$\nThis yields the maximum likelihood estimator for $p$:\n$$\\hat{p} = \\frac{k}{n}$$\nTo confirm this is a maximum, we examine the second derivative:\n$$\\frac{d^2\\ell}{dp^2} = -\\frac{k}{p^2} - \\frac{n-k}{(1-p)^2}$$\nSince $k$ and $n$ are non-negative counts with $0 \\le k \\le n$, and $p \\in (0, 1)$, this second derivative is always negative. Thus, the log-likelihood function is concave, and $\\hat{p} = k/n$ is indeed the unique maximum likelihood estimator.\n\nNext, we derive the large-sample confidence interval for $p$. According to the theory of maximum likelihood estimation, for a large sample size $n$, the MLE $\\hat{p}$ is asymptotically normally distributed with a mean equal to the true parameter $p$ and variance equal to the inverse of the Fisher information, $I(p)^{-1}$.\n$$\\hat{p} \\xrightarrow{d} N\\left(p, \\frac{1}{I(p)}\\right)$$\nThe Fisher information $I(p)$ for a sample of size $n$ from a Bernoulli distribution is $I(p) = n I_1(p)$, where $I_1(p)$ is the information from a single trial. It can be calculated as $I(p) = -E\\left[\\frac{d^2\\ell}{dp^2}\\right]$.\n$$I(p) = -E\\left[-\\frac{K}{p^2} - \\frac{n-K}{(1-p)^2}\\right] = E\\left[\\frac{K}{p^2}\\right] + E\\left[\\frac{n-K}{(1-p)^2}\\right]$$\nUsing the linearity of expectation and the fact that $E[K] = np$:\n$$I(p) = \\frac{E[K]}{p^2} + \\frac{n-E[K]}{(1-p)^2} = \\frac{np}{p^2} + \\frac{n-np}{(1-p)^2} = \\frac{n}{p} + \\frac{n(1-p)}{(1-p)^2} = \\frac{n}{p} + \\frac{n}{1-p}$$\n$$I(p) = n\\left(\\frac{1-p+p}{p(1-p)}\\right) = \\frac{n}{p(1-p)}$$\nThe asymptotic variance of $\\hat{p}$ is therefore $\\text{Var}(\\hat{p}) \\approx \\frac{1}{I(p)} = \\frac{p(1-p)}{n}$. The standard error of $\\hat{p}$ is $\\text{SE}(\\hat{p}) = \\sqrt{\\frac{p(1-p)}{n}}$.\nThe standardized statistic (pivotal quantity) is approximately standard normal for large $n$:\n$$\\frac{\\hat{p}-p}{\\text{SE}(\\hat{p})} \\approx N(0,1)$$\nTo construct a confidence interval, we must estimate the standard error since it depends on the unknown parameter $p$. We substitute the MLE $\\hat{p}$ for $p$, which gives the estimated standard error, $\\widehat{\\text{SE}}(\\hat{p}) = \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}$.\nThe $(1-\\alpha)$ two-sided confidence interval is centered at $\\hat{p}$ with a margin of error determined by the standard normal quantile $z_{1-\\alpha/2}$:\n$$\\hat{p} \\pm z_{1-\\alpha/2} \\widehat{\\text{SE}}(\\hat{p})$$\nSubstituting the expression for the estimated standard error, the confidence interval for $p$ is:\n$$\\left[ \\hat{p} - z_{1-\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}, \\quad \\hat{p} + z_{1-\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} \\right]$$\n\nNow, we apply these results to the given dataset: $k=312$, $n=1000$, and for a $95\\%$ confidence interval, $1-\\alpha=0.95$, so $\\alpha=0.05$ and $z_{1-\\alpha/2} = z_{0.975} = 1.96$.\n\nFirst, calculate the MLE $\\hat{p}$:\n$$\\hat{p} = \\frac{k}{n} = \\frac{312}{1000} = 0.312$$\nNext, calculate the estimated standard error $\\widehat{\\text{SE}}(\\hat{p})$:\n$$\\widehat{\\text{SE}}(\\hat{p}) = \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} = \\sqrt{\\frac{0.312(1-0.312)}{1000}} = \\sqrt{\\frac{0.312 \\times 0.688}{1000}} = \\sqrt{\\frac{0.214656}{1000}} = \\sqrt{0.000214656} \\approx 0.01465114$$\nThe margin of error (ME) is:\n$$ME = z_{0.975} \\times \\widehat{\\text{SE}}(\\hat{p}) = 1.96 \\times 0.01465114 \\approx 0.02871624$$\nThe endpoints of the $95\\%$ confidence interval are:\nLower bound: $\\hat{p} - ME = 0.312 - 0.02871624 \\approx 0.28328376$\nUpper bound: $\\hat{p} + ME = 0.312 + 0.02871624 \\approx 0.34071624$\n\nRounding these results to four significant figures:\n$\\hat{p} = 0.3120$\nLower bound $= 0.2833$\nUpper bound $= 0.3407$\nThe final triplet is $(0.3120, 0.2833, 0.3407)$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3120 & 0.2833 & 0.3407 \\end{pmatrix}}\n$$", "id": "2484587"}]}