{"hands_on_practices": [{"introduction": "Before embarking on complex genetic engineering, a metabolic engineer must first determine what is theoretically possible. This exercise will guide you through the application of fundamental conservation laws—specifically, the conservation of atoms and reducing equivalents—to evaluate the feasibility of different metabolic routes. By mastering stoichiometric balancing, you will learn to calculate the maximum theoretical yield of a bioproduct, providing a vital benchmark for assessing the efficiency of any engineered strain [@problem_id:2506619].", "problem": "A bioprocess engineer is evaluating anaerobic production of $n$-butanol $(\\text{C}_4\\text{H}_{10}\\text{O})$ from glucose $(\\text{C}_6\\text{H}_{12}\\text{O}_6)$ in an aqueous medium with no external electron acceptor and negligible biomass formation. Byproducts are restricted to carbon dioxide $(\\text{CO}_2)$, water $(\\text{H}_2\\text{O})$, and dihydrogen $(\\text{H}_2)$. The system must obey conservation of atoms and total reducing equivalents (electrons). Treat dihydrogen as carrying $2$ reducing equivalents per mole, and treat water and carbon dioxide as having zero net reducing equivalents. All species are neutral, so charge balance is implicitly satisfied.\n\nYou are given $3$ candidate overall routes:\n- Route A: $\\text{C}_6\\text{H}_{12}\\text{O}_6 \\rightarrow \\text{C}_4\\text{H}_{10}\\text{O} + 2\\,\\text{CO}_2 + \\text{H}_2\\text{O}$.\n- Route B: $\\text{C}_6\\text{H}_{12}\\text{O}_6 \\rightarrow \\text{C}_4\\text{H}_{10}\\text{O} + \\text{CO}_2 + 2\\,\\text{H}_2$.\n- Route C: $\\text{C}_6\\text{H}_{12}\\text{O}_6 \\rightarrow \\text{C}_4\\text{H}_{10}\\text{O} + 3\\,\\text{CO} + 2\\,\\text{H}_2\\text{O}$.\n\nTasks:\n1. Using atom mapping, test each route for conservation of carbon, hydrogen, and oxygen atoms, and for conservation of total reducing equivalents. Eliminate routes that violate any conservation law.\n2. For the admissible byproduct set $\\{\\text{CO}_2, \\text{H}_2\\text{O}, \\text{H}_2\\}$, consider the general overall reaction\n$$\\text{C}_6\\text{H}_{12}\\text{O}_6 \\rightarrow \\nu_{b}\\,\\text{C}_4\\text{H}_{10}\\text{O} + \\nu_{c}\\,\\text{CO}_2 + \\nu_{h}\\,\\text{H}_2\\text{O} + \\nu_{H_2}\\,\\text{H}_2,$$\nwith unknown nonnegative stoichiometric coefficients $\\nu_{b}, \\nu_{c}, \\nu_{h}, \\nu_{H_2} \\ge 0$. Derive elemental balances for carbon, hydrogen, and oxygen, and an overall redox balance based on conservation of reducing equivalents. Using these constraints, determine the maximum possible molar yield $\\nu_{b}^{\\max}$ of $n$-butanol (in mol per mol glucose).\n3. Compute the corresponding maximum mass yield $Y_{P/S}^{\\max}$ in grams of $n$-butanol per gram of glucose using the atomic weights $M(\\text{C})=12.01$, $M(\\text{H})=1.008$, $M(\\text{O})=16.00$ (units: grams per mole). Express your final numerical answer as grams of $n$-butanol per gram of glucose, rounded to $4$ significant figures.\n\nYour final reported answer must be the single value of $Y_{P/S}^{\\max}$ as specified in task $3$.", "solution": "The problem statement has been evaluated and is determined to be valid. It is a scientifically grounded, self-contained, and well-posed problem in metabolic stoichiometry and thermodynamics, requiring the application of fundamental conservation laws. The premise, constraints, and objectives are clearly defined. I shall now proceed with a systematic solution.\n\nThe solution is structured into three parts as per the problem tasks.\n\nFirst, I will validate the three candidate reaction routes by examining the conservation of atoms (Carbon, Hydrogen, Oxygen) and reducing equivalents. The degree of reduction, $\\gamma$, for a molecule $\\text{C}_a\\text{H}_b\\text{O}_c\\text{N}_d$ is given by $\\gamma = 4a + b - 2c - 3d$. For the species in this problem, all are uncharged and contain no nitrogen, so the formula simplifies. The total number of available electrons, which we term reducing equivalents (RE), for one mole of a substance is its degree of reduction.\nFor the substrate, glucose ($\\text{C}_6\\text{H}_{12}\\text{O}_6$): $\\gamma_{\\text{glucose}} = 4(6) + 12 - 2(6) = 24$.\nFor the product, $n$-butanol ($\\text{C}_4\\text{H}_{10}\\text{O}$): $\\gamma_{\\text{butanol}} = 4(4) + 10 - 2(1) = 24$.\nThe problem defines the RE for the byproducts:\n$\\text{CO}_2$: $\\gamma_{\\text{CO}_2} = 0$. This is consistent with the formula: $4(1) - 2(2) = 0$.\n$\\text{H}_2\\text{O}$: $\\gamma_{\\text{H}_2\\text{O}} = 0$. This is consistent with the formula: $2 - 2(1) = 0$.\n$\\text{H}_2$: $\\gamma_{\\text{H}_2} = 2$. This is consistent with the formula: $2$.\n\nRoute A: $\\text{C}_6\\text{H}_{12}\\text{O}_6 \\rightarrow \\text{C}_4\\text{H}_{10}\\text{O} + 2\\,\\text{CO}_2 + \\text{H}_2\\text{O}$\n- Carbon (C) balance: $6 \\rightarrow 4 + 2(1) = 6$. The balance is satisfied.\n- Hydrogen (H) balance: $12 \\rightarrow 10 + 2(1) = 12$. The balance is satisfied.\n- Oxygen (O) balance: $6 \\rightarrow 1 + 2(2) + 1 = 6$. The balance is satisfied.\n- Reducing Equivalent (RE) balance: $24 \\rightarrow 1(24) + 2(0) + 1(0) = 24$. The balance is satisfied.\nConclusion: Route A is valid as it satisfies all conservation laws.\n\nRoute B: $\\text{C}_6\\text{H}_{12}\\text{O}_6 \\rightarrow \\text{C}_4\\text{H}_{10}\\text{O} + \\text{CO}_2 + 2\\,\\text{H}_2$\n- Carbon (C) balance: $6 \\rightarrow 4 + 1 = 5$. The balance is violated.\nConclusion: Route B is invalid due to failure to conserve carbon atoms. There is no need to check further.\n\nRoute C: $\\text{C}_6\\text{H}_{12}\\text{O}_6 \\rightarrow \\text{C}_4\\text{H}_{10}\\text{O} + 3\\,\\text{CO} + 2\\,\\text{H}_2\\text{O}$\n- Carbon (C) balance: $6 \\rightarrow 4 + 3(1) = 7$. The balance is violated.\nConclusion: Route C is invalid due to failure to conserve carbon atoms. The presence of carbon monoxide ($\\text{CO}$), a byproduct not specified in the admissible set for the main problem, also makes this route inconsistent with the subsequent analysis. Furthermore, the problem statement does not provide the reducing equivalents for $\\text{CO}$, making a full validation impossible even if it were atomically balanced.\n\nSecond, I will determine the maximum possible molar yield of $n$-butanol, $\\nu_{b}^{\\max}$. The general stoichiometric equation is:\n$$1\\,\\text{C}_6\\text{H}_{12}\\text{O}_6 \\rightarrow \\nu_{b}\\,\\text{C}_4\\text{H}_{10}\\text{O} + \\nu_{c}\\,\\text{CO}_2 + \\nu_{h}\\,\\text{H}_2\\text{O} + \\nu_{H_2}\\,\\text{H}_2$$\nWe establish the system of linear equations from the atom balances, based on $1$ mole of glucose consumed.\n- C balance: $6 = 4\\nu_{b} + \\nu_{c}$  (1)\n- H balance: $12 = 10\\nu_{b} + 2\\nu_{h} + 2\\nu_{H_2}$  (2)\n- O balance: $6 = \\nu_{b} + 2\\nu_{c} + \\nu_{h}$  (3)\n\nThe redox balance ($24 = 24\\nu_{b} + 2\\nu_{H_2}$) is a linear combination of the atom balances ($4 \\times \\text{C} + \\text{H} - 2 \\times \\text{O}$) and is therefore redundant. We must solve the system of three equations for the four unknown stoichiometric coefficients, which are constrained to be non-negative: $\\nu_{b} \\ge 0$, $\\nu_{c} \\ge 0$, $\\nu_{h} \\ge 0$, $\\nu_{H_2} \\ge 0$.\n\nWe express $\\nu_{c}$, $\\nu_{h}$, and $\\nu_{H_2}$ as functions of $\\nu_{b}$ to find the feasible range for the butanol yield.\nFrom (1):\n$$\\nu_{c} = 6 - 4\\nu_{b}$$\nSubstitute this into (3):\n$6 = \\nu_{b} + 2(6 - 4\\nu_{b}) + \\nu_{h}$\n$6 = \\nu_{b} + 12 - 8\\nu_{b} + \\nu_{h}$\n$6 = 12 - 7\\nu_{b} + \\nu_{h} \\implies \\nu_{h} = 7\\nu_{b} - 6$\n\nSubstitute $\\nu_{h}$ into the simplified H balance equation (2), which is $6 = 5\\nu_{b} + \\nu_{h} + \\nu_{H_2}$:\n$6 = 5\\nu_{b} + (7\\nu_{b} - 6) + \\nu_{H_2}$\n$6 = 12\\nu_{b} - 6 + \\nu_{H_2} \\implies \\nu_{H_2} = 12 - 12\\nu_{b}$\n\nNow apply the non-negativity constraints:\n1. $\\nu_{b} \\ge 0$ (given)\n2. $\\nu_{c} \\ge 0 \\implies 6 - 4\\nu_{b} \\ge 0 \\implies 4\\nu_{b} \\le 6 \\implies \\nu_{b} \\le \\frac{3}{2}$\n3. $\\nu_{h} \\ge 0 \\implies 7\\nu_{b} - 6 \\ge 0 \\implies 7\\nu_{b} \\ge 6 \\implies \\nu_{b} \\ge \\frac{6}{7}$\n4. $\\nu_{H_2} \\ge 0 \\implies 12 - 12\\nu_{b} \\ge 0 \\implies 12\\nu_{b} \\le 12 \\implies \\nu_{b} \\le 1$\n\nCombining these inequalities, we find the feasible range for $\\nu_{b}$:\n$$\\frac{6}{7} \\le \\nu_{b} \\le 1$$\nThe objective is to maximize $\\nu_{b}$. The maximum value within this feasible range is $\\nu_{b}^{\\max} = 1$.\n\nThird, I will compute the maximum mass yield, $Y_{P/S}^{\\max}$. First, calculate the molar masses ($M$) using the provided atomic weights: $M(\\text{C})=12.01\\,\\text{g/mol}$, $M(\\text{H})=1.008\\,\\text{g/mol}$, $M(\\text{O})=16.00\\,\\text{g/mol}$.\nMolar mass of glucose, $M_{\\text{glucose}}$ ($\\text{C}_6\\text{H}_{12}\\text{O}_6$):\n$$M_{\\text{glucose}} = 6 \\times 12.01 + 12 \\times 1.008 + 6 \\times 16.00 = 72.06 + 12.096 + 96.00 = 180.156\\,\\text{g/mol}$$\nMolar mass of $n$-butanol, $M_{\\text{butanol}}$ ($\\text{C}_4\\text{H}_{10}\\text{O}$):\n$$M_{\\text{butanol}} = 4 \\times 12.01 + 10 \\times 1.008 + 1 \\times 16.00 = 48.04 + 10.080 + 16.00 = 74.120\\,\\text{g/mol}$$\nThe maximum mass yield is given by the formula:\n$$Y_{P/S}^{\\max} = \\nu_{b}^{\\max} \\frac{M_{\\text{butanol}}}{M_{\\text{glucose}}}$$\nSubstituting the values:\n$$Y_{P/S}^{\\max} = 1 \\times \\frac{74.120}{180.156} \\approx 0.4114134\\,\\text{g/g}$$\nRounding to $4$ significant figures as required, the result is $0.4114$.", "answer": "$$\n\\boxed{0.4114}\n$$", "id": "2506619"}, {"introduction": "While stoichiometry defines the theoretical limits of a pathway, kinetics dictates its actual rate of production. This practice bridges the gap between theory and reality by applying the Michaelis-Menten model to analyze a multi-step biosynthetic pathway. You will use enzyme-specific parameters such as total enzyme abundance ($E_t$), catalytic turnover ($k_{\\text{cat}}$), and the Michaelis constant ($K_M$) to calculate the flux capacity of each step, ultimately identifying the rate-limiting bottleneck that constrains overall pathway performance [@problem_id:2506550].", "problem": "An engineered bacterium is constructed to produce a target molecule through a strictly linear, four-step pathway. Each step is catalyzed by a single-substrate enzyme with no allosteric regulation and negligible product inhibition under the operating conditions. The cell is in a steady physiological state with measured intracellular substrate concentrations for the substrate of each step, and each enzyme follows the classical Michaelis–Menten mechanism under the quasi-steady-state assumption for the enzyme–substrate complex. Assume that the total enzyme reported is catalytically competent, that each step is effectively irreversible, and that the specific flux of the pathway at steady state cannot exceed the slowest step’s attainable rate under the given conditions. The enzyme total abundances are reported per gram dry weight (gDW), where gDW stands for gram dry weight.\n\nFor steps $i \\in \\{1,2,3,4\\}$ the following parameters are measured:\n- Step 1: total enzyme abundance $E_{t,1} = 0.030~\\mu\\text{mol}~\\text{gDW}^{-1}$, catalytic turnover $k_{\\text{cat},1} = 120~\\text{s}^{-1}$, Michaelis constant $K_{M,1} = 0.20~\\text{mM}$, substrate concentration $S_{1} = 1.00~\\text{mM}$.\n- Step 2: total enzyme abundance $E_{t,2} = 0.015~\\mu\\text{mol}~\\text{gDW}^{-1}$, catalytic turnover $k_{\\text{cat},2} = 200~\\text{s}^{-1}$, Michaelis constant $K_{M,2} = 0.050~\\text{mM}$, substrate concentration $S_{2} = 0.100~\\text{mM}$.\n- Step 3: total enzyme abundance $E_{t,3} = 0.040~\\mu\\text{mol}~\\text{gDW}^{-1}$, catalytic turnover $k_{\\text{cat},3} = 50~\\text{s}^{-1}$, Michaelis constant $K_{M,3} = 0.50~\\text{mM}$, substrate concentration $S_{3} = 0.250~\\text{mM}$.\n- Step 4: total enzyme abundance $E_{t,4} = 0.010~\\mu\\text{mol}~\\text{gDW}^{-1}$, catalytic turnover $k_{\\text{cat},4} = 500~\\text{s}^{-1}$, Michaelis constant $K_{M,4} = 0.20~\\text{mM}$, substrate concentration $S_{4} = 1.00~\\text{mM}$.\n\nUsing only fundamental definitions of Michaelis–Menten kinetics and steady-state pathway throughput constraints derived from mass conservation, compute the enzyme-limited maximal specific pathway flux under these conditions, expressed in $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$. Round your answer to three significant figures. You may not assume any additional parameters beyond those stated, and you must justify the units used from first principles as part of your derivation in the solution. Although you should reason about which step constrains throughput, report only the numerical value of the maximal specific flux in the units requested.", "solution": "We start from the classical single-substrate Michaelis–Menten mechanism with the quasi-steady-state assumption for the enzyme–substrate complex. For a single step with total enzyme concentration $E_{t}$ and substrate concentration $S$, the reaction rate per volume is\n\n$$\nr \\;=\\; \\frac{V_{\\max} S}{K_{M} + S} \\quad \\text{with} \\quad V_{\\max} \\;=\\; k_{\\text{cat}} E,\n$$\n\nwhere $E$ is the enzyme concentration per volume. In metabolic engineering, it is common to report enzyme abundance per gram dry weight (gDW), not per volume. Let $E_{t}$ (units $\\text{mol}~\\text{gDW}^{-1}$) denote the total enzyme abundance per gDW. Let $\\rho$ be the biomass density in $\\text{gDW}~\\text{L}^{-1}$. Then the volumetric enzyme concentration is $E = E_{t}\\,\\rho$ (units $\\text{mol}~\\text{L}^{-1}$). Thus the volumetric rate becomes\n\n$$\nr \\;=\\; k_{\\text{cat}} (E_{t}\\rho)\\, \\frac{S}{K_{M} + S}.\n$$\n\nThe specific flux per gDW, denoted $J$ (units $\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}$), is obtained by converting the volumetric rate to a per-gDW basis via division by $\\rho$:\n\n$$\nJ \\;=\\; \\frac{r}{\\rho} \\;=\\; k_{\\text{cat}} E_{t}\\, \\frac{S}{K_{M} + S}.\n$$\n\nTherefore, when $E_{t}$ is given per gDW and $S$, $K_{M}$ are given as concentrations in the same units, the specific rate per gDW is directly\n\n$$\nJ \\;=\\; k_{\\text{cat}} E_{t}\\, \\frac{S}{K_{M} + S}.\n$$\n\nThe units are consistent: $k_{\\text{cat}}$ has units $\\text{s}^{-1}$, $E_{t}$ has units $\\text{mol}~\\text{gDW}^{-1}$, and the saturation term $\\frac{S}{K_{M}+S}$ is dimensionless, so $J$ has units $\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}$. Conversion to $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$ is then done by multiplying by $3.6 \\times 10^{3}$.\n\nFor a strictly linear pathway at steady state with no accumulation of intermediates and each step operating independently under the same flux, the attainable pathway flux cannot exceed the capacity of any individual step under the prevailing substrate concentrations. Therefore, the enzyme-limited maximal specific pathway flux is the minimum of the step capacities:\n\n$$\nJ_{\\text{max}} \\;=\\; \\min_{i \\in \\{1,2,3,4\\}} \\left\\{ k_{\\text{cat},i} E_{t,i}\\, \\frac{S_{i}}{K_{M,i} + S_{i}} \\right\\}.\n$$\n\n\nWe compute each step capacity $J_{i}$ in $\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}$, then convert to $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$.\n\nStep 1:\n\n$$\nV_{\\max,1} \\;=\\; k_{\\text{cat},1} E_{t,1} \\;=\\; 120~\\text{s}^{-1} \\times 0.030~\\mu\\text{mol}~\\text{gDW}^{-1} \\;=\\; 3.6~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n\n$$\n\\frac{S_{1}}{K_{M,1}+S_{1}} \\;=\\; \\frac{1.00}{0.20+1.00} \\;=\\; \\frac{1.00}{1.20} \\;=\\; \\frac{5}{6}.\n$$\n\n\n$$\nJ_{1} \\;=\\; 3.6 \\times \\frac{5}{6} \\;=\\; 3.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\nConvert to $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$:\n\n$$\n3.0~\\mu\\text{mol}~\\text{s}^{-1} \\times \\frac{1~\\text{mmol}}{1000~\\mu\\text{mol}} \\times 3600~\\text{s}~\\text{h}^{-1} \\;=\\; 10.8~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\n\n\nStep 2:\n\n$$\nV_{\\max,2} \\;=\\; 200 \\times 0.015 \\;=\\; 3.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n\n$$\n\\frac{S_{2}}{K_{M,2}+S_{2}} \\;=\\; \\frac{0.100}{0.050+0.100} \\;=\\; \\frac{0.100}{0.150} \\;=\\; \\frac{2}{3}.\n$$\n\n\n$$\nJ_{2} \\;=\\; 3.0 \\times \\frac{2}{3} \\;=\\; 2.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1} \\;\\Rightarrow\\; 2.0 \\times \\frac{1}{1000} \\times 3600 \\;=\\; 7.2~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\n\n\nStep 3:\n\n$$\nV_{\\max,3} \\;=\\; 50 \\times 0.040 \\;=\\; 2.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n\n$$\n\\frac{S_{3}}{K_{M,3}+S_{3}} \\;=\\; \\frac{0.250}{0.50+0.250} \\;=\\; \\frac{0.250}{0.750} \\;=\\; \\frac{1}{3}.\n$$\n\n\n$$\nJ_{3} \\;=\\; 2.0 \\times \\frac{1}{3} \\;=\\; \\frac{2}{3}~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\nConvert:\n\n$$\n\\frac{2}{3}~\\mu\\text{mol}~\\text{s}^{-1} \\times \\frac{1}{1000}~\\text{mmol}~\\mu\\text{mol}^{-1} \\times 3600~\\text{s}~\\text{h}^{-1} \\;=\\; \\frac{2}{3} \\times 3.6~\\text{mmol}~\\text{h}^{-1} \\;=\\; 2.4~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\n\n\nStep 4:\n\n$$\nV_{\\max,4} \\;=\\; 500 \\times 0.010 \\;=\\; 5.0~\\mu\\text{mol}~\\text{gDW}^{-}^{-1}.\n$$\n\n\n$$\n\\frac{S_{4}}{K_{M,4}+S_{4}} \\;=\\; \\frac{1.00}{0.20+1.00} \\;=\\; \\frac{5}{6}.\n$$\n\n\n$$\nJ_{4} \\;=\\; 5.0 \\times \\frac{5}{6} \\;=\\; \\frac{25}{6}~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\nConvert:\n\n$$\n\\frac{25}{6}~\\mu\\text{mol}~\\text{s}^{-1} \\times \\frac{3600~\\text{s}~\\text{h}^{-1}}{1000~\\mu\\text{mol}~\\text{mmol}^{-1}} \\;=\\; 15.0~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\n\n\nCollecting the step capacities in $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$:\n\n$$\nJ_{1} = 10.8,\\quad J_{2} = 7.2,\\quad J_{3} = 2.4,\\quad J_{4} = 15.0.\n$$\n\nThe enzyme-limited maximal specific pathway flux is\n\n$$\nJ_{\\text{max}} \\;=\\; \\min\\{10.8,\\, 7.2,\\, 2.4,\\, 15.0\\} \\;=\\; 2.4~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\n\n\nRounding to three significant figures yields $2.40~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$. By inspection of the capacities, the constraining step under these conditions is step $3$. As required, we report only the numerical value in the requested units.", "answer": "$$\\boxed{2.40}$$", "id": "2506550"}, {"introduction": "Modern metabolic engineering treats the cell as an integrated system, not a collection of linear pathways. This computational exercise introduces you to Flux Balance Analysis (FBA), a cornerstone of systems biology, which allows for the prediction of metabolic flux distributions across an entire network. By optimizing for different biological objectives and using Flux Variability Analysis (FVA) to explore alternate optima, you will gain hands-on experience with the in silico tools used to design and analyze metabolically engineered organisms on a genome-scale [@problem_id:2506613].", "problem": "A metabolic network for microbial bioproduction is modeled using steady-state mass conservation (stoichiometric mass balance) and linear optimization. The foundational base is mass balance at steady state and flux bounds: every internal metabolite has no net accumulation, so the flux vector $\\mathbf{v} \\in \\mathbb{R}^n$ must satisfy $S \\mathbf{v} = \\mathbf{0}$, where $S \\in \\mathbb{R}^{m \\times n}$ is the stoichiometric matrix, and each reaction flux $v_i$ is constrained by lower and upper bounds. This base, together with linear objective functions, underlies Flux Balance Analysis (FBA). Alternate optima are characterized using Flux Variability Analysis (FVA), which computes allowable ranges of individual fluxes while maintaining the optimal objective value within a small tolerance. Your program must implement these principles to compare optimal solutions under different objectives and to quantify alternate optima via FVA.\n\nNetwork specification. Internal metabolites are $\\{\\text{Glc}, \\text{Pyr}, \\text{ATP}, \\text{O2}, \\text{CO2}, \\text{Lac}\\}$. Reactions (all irreversible) and their flux indices are:\n- $v_1$: glucose uptake, $\\text{Glc}_e \\rightarrow \\text{Glc}$, index $0$.\n- $v_2$: glycolysis, $\\text{Glc} \\rightarrow 2\\,\\text{Pyr} + 2\\,\\text{ATP}$, index $1$.\n- $v_3$: respiration A, $\\text{Pyr} + 2.5\\,\\text{O2} \\rightarrow 3\\,\\text{CO2} + 12.5\\,\\text{ATP}$, index $2$.\n- $v_{10}$: respiration B (duplicate of respiration A), $\\text{Pyr} + 2.5\\,\\text{O2} \\rightarrow 3\\,\\text{CO2} + 12.5\\,\\text{ATP}$, index $3$.\n- $v_4$: fermentation A, $\\text{Pyr} \\rightarrow \\text{Lac}$, index $4$.\n- $v_{11}$: fermentation B (duplicate of fermentation A), $\\text{Pyr} \\rightarrow \\text{Lac}$, index $5$.\n- $v_5$: adenosine triphosphate (ATP) hydrolysis demand, $\\text{ATP} \\rightarrow \\varnothing$, index $6$.\n- $v_6$: biomass formation (sink), $2\\,\\text{Pyr} + 10\\,\\text{ATP} \\rightarrow \\varnothing$, index $7$.\n- $v_7$: oxygen uptake, $\\text{O2}_e \\rightarrow \\text{O2}$, index $8$.\n- $v_8$: carbon dioxide export, $\\text{CO2} \\rightarrow \\varnothing$, index $9$.\n- $v_9$: lactate export, $\\text{Lac} \\rightarrow \\varnothing$, index $10$.\n\nSteady-state stoichiometric mass balances $S \\mathbf{v} = \\mathbf{0}$ for the internal metabolites, written as linear equations, are:\n- Glc: $+1\\,v_1 - 1\\,v_2 = 0$.\n- Pyr: $+2\\,v_2 - 1\\,v_3 - 1\\,v_{10} - 1\\,v_4 - 1\\,v_{11} - 2\\,v_6 = 0$.\n- ATP: $+2\\,v_2 + 12.5\\,v_3 + 12.5\\,v_{10} - 1\\,v_5 - 10\\,v_6 = 0$.\n- O2: $+1\\,v_7 - 2.5\\,v_3 - 2.5\\,v_{10} = 0$.\n- CO2: $+3\\,v_3 + 3\\,v_{10} - 1\\,v_8 = 0$.\n- Lac: $+1\\,v_4 + 1\\,v_{11} - 1\\,v_9 = 0$.\n\nFlux bounds. All reactions are irreversible with lower bounds $0$. Exchange reactions have finite upper bounds as follows:\n- $0 \\le v_1 \\le G_{\\max}$ for glucose uptake.\n- $0 \\le v_7 \\le O_{\\max}$ for oxygen uptake.\n- All other reactions have upper bounds $+\\infty$.\n\nObjectives. You must compute the following, each formulated as a linear program:\n1. Biomass maximization: maximize $v_6$.\n2. ATP yield maximization: maximize $v_5$.\n3. Minimal total flux at maximal growth: first find the maximal biomass $v_6^\\star$ from objective (1), then minimize the total flux $\\sum_{i=1}^{n} |v_i|$ subject to $S \\mathbf{v} = \\mathbf{0}$, bounds as above, and $v_6 \\ge v_6^\\star - \\epsilon$. Because all reactions are irreversible, $|v_i| = v_i$, so the objective reduces to minimizing $\\sum_{i=1}^{n} v_i$.\n\nFlux Variability Analysis (FVA). For each objective above, after obtaining the optimal objective value $z^\\star$, characterize alternate optima by computing, for each target flux $v_j$ in the set $\\{v_3, v_{10}, v_4, v_{11}\\}$, the minimum and maximum feasible values of $v_j$ subject to $S \\mathbf{v} = \\mathbf{0}$, bounds, and the constraint that the objective remains optimal within tolerance $\\epsilon$. Implement this by adding the inequality $-c^\\top \\mathbf{v} \\le -z^\\star + \\epsilon$ when the objective is to maximize $c^\\top \\mathbf{v}$. For the minimal total flux objective, add both $v_6 \\ge v_6^\\star - \\epsilon$ and $\\sum_{i=1}^{n} v_i \\le T^\\star + \\epsilon$, where $T^\\star$ is the minimal total flux found under that constraint.\n\nNumerical tolerance and units. Use tolerance $\\epsilon = 10^{-7}$. Express all fluxes in millimoles per gram dry weight per hour, that is, in $\\text{mmol}\\,\\text{gDW}^{-1}\\,\\text{h}^{-1}$. Round all reported numbers to six decimal places.\n\nTest suite. Solve the above for the following parameter sets $(G_{\\max}, O_{\\max})$:\n- Case $1$: $(G_{\\max}, O_{\\max}) = (10, 100)$.\n- Case $2$: $(G_{\\max}, O_{\\max}) = (10, 8)$.\n- Case $3$: $(G_{\\max}, O_{\\max}) = (10, 0)$.\n\nRequired final output format. Your program should produce a single line of output containing a single list that concatenates, for each case in order, the following values in this exact order:\n- Biomass optimum $v_6^\\star$.\n- ATP optimum $v_5^\\star$.\n- Minimal total flux $T^\\star$ at $v_6 \\ge v_6^\\star - \\epsilon$.\n- FVA under biomass optimum: $[v_3^{\\min}, v_3^{\\max}, v_{10}^{\\min}, v_{10}^{\\max}, v_4^{\\min}, v_4^{\\max}, v_{11}^{\\min}, v_{11}^{\\max}]$.\n- FVA under ATP optimum: the same eight values in the same order.\n- FVA under minimal total flux optimum: the same eight values in the same order.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,\\dots]$), with each number rounded to six decimals as specified. No other text should be printed.", "solution": "The problem statement has been subjected to rigorous review and is determined to be **valid**. It presents a standard exercise in computational systems biology, specifically Flux Balance Analysis (FBA) and Flux Variability Analysis (FVA), applied to a simplified metabolic network. The problem is self-contained, mathematically well-posed, and scientifically grounded in the principle of mass conservation at steady state. The presence of duplicate reaction pathways ($v_3/v_{10}$ and $v_4/v_{11}$) is not a flaw but a deliberate construction to create alternate optima, a common phenomenon in metabolic networks, the characterization of which is the central purpose of FVA.\n\nThe solution proceeds by a systematic application of linear programming (LP). The metabolic network's state is described by a flux vector $\\mathbf{v} \\in \\mathbb{R}^{11}$, where $\\mathbf{v} = [v_0, v_1, \\dots, v_{10}]^\\top$. The indices $0, \\dots, 10$ correspond to the reactions $v_1, v_2, v_3, v_{10}, v_4, v_{11}, v_5, v_6, v_7, v_8, v_9$ as specified in the problem.\n\nThe core of the model is the steady-state mass balance equation, $S \\mathbf{v} = \\mathbf{0}$, where $S \\in \\mathbb{R}^{6 \\times 11}$ is the stoichiometric matrix. The rows of $S$ correspond to the internal metabolites $\\{\\text{Glc}, \\text{Pyr}, \\text{ATP}, \\text{O2}, \\text{CO2}, \\text{Lac}\\}$, and its columns correspond to the fluxes $v_0, \\dots, v_{10}$. Based on the provided stoichiometric equations, the matrix $S$ is:\n$$\nS = \\begin{pmatrix}\n 1 & -1 &    0 &    0 &    0 &    0 &   0 &   0 &   0 &   0 &   0 \\\\\n 0 &  2 &   -1 &   -1 &   -1 &   -1 &   0 &  -2 &   0 &   0 &   0 \\\\\n 0 &  2 & 12.5 & 12.5 &    0 &    0 &  -1 & -10 &   0 &   0 &   0 \\\\\n 0 &  0 & -2.5 & -2.5 &    0 &    0 &   0 &   0 &   1 &   0 &   0 \\\\\n 0 &  0 &    3 &    3 &    0 &    0 &   0 &   0 &   0 &  -1 &   0 \\\\\n 0 &  0 &    0 &    0 &    1 &    1 &   0 &   0 &   0 &   0 &  -1\n\\end{pmatrix}\n$$\nThe system of linear equations is thus $S\\mathbf{v} = \\mathbf{0}$, where $\\mathbf{0}$ is the zero vector in $\\mathbb{R}^6$.\n\nEach flux $v_i$ is constrained by lower and upper bounds, $l_i \\le v_i \\le u_i$. All reactions are irreversible, so $l_i = 0$ for all $i \\in \\{0, \\dots, 10\\}$. The upper bounds are:\n- $v_0 \\le G_{\\max}$\n- $v_8 \\le O_{\\max}$\n- $v_i \\le +\\infty$ for all other fluxes.\n\nEach task is formulated as a distinct LP problem. Since standard LP solvers perform minimization, maximizing an objective function $c^\\top \\mathbf{v}$ is achieved by minimizing $-c^\\top \\mathbf{v}$.\n\n1.  **Biomass Maximization**: The objective is to maximize the biomass formation flux, $v_6$ (index 7). The objective function to minimize is $c^\\top \\mathbf{v}$ where $c = [0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0]^\\top$. The optimal value is $v_6^\\star = - \\min(c^\\top \\mathbf{v})$.\n\n2.  **ATP Yield Maximization**: The objective is to maximize the ATP hydrolysis flux, $v_5$ (index 6). The objective function to minimize is $c^\\top \\mathbf{v}$ where $c = [0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0]^\\top$. The optimal value is $v_5^\\star = - \\min(c^\\top \\mathbf{v})$.\n\n3.  **Minimal Total Flux at Maximal Growth**: This is a two-step optimization.\n    a. First, the maximal biomass flux, $v_6^\\star$, is determined as in objective (1).\n    b. Second, a new LP is solved to minimize the total flux, $\\sum_{i=0}^{10} v_i$. This corresponds to an objective vector $c = [1, 1, \\dots, 1]^\\top$. A constraint is added to ensure biomass production is near-optimal: $v_6 \\ge v_6^\\star - \\epsilon$. The optimal value is $T^\\star = \\min(\\sum v_i)$.\n\n**Flux Variability Analysis (FVA)** is performed for each of the three optimal states found above. For a given optimal objective value $z^\\star$, an additional constraint is added to the LP problem to enforce that the objective value remains near-optimal. Then, for each target flux $v_j$ (from the set of fluxes with indices $\\{2, 3, 4, 5\\}$ corresponding to reactions $v_3, v_{10}, v_4, v_{11}$), we find its minimum and maximum possible values by solving two LPs.\n\n-   **FVA for Biomass Optimum**: The constraint $v_6 \\ge v_6^\\star - \\epsilon$ is added.\n-   **FVA for ATP Optimum**: The constraint $v_5 \\ge v_5^\\star - \\epsilon$ is added.\n-   **FVA for Minimal Total Flux**: Two constraints are added: $v_6 \\ge v_6^\\star - \\epsilon$ and $\\sum_{i=0}^{10} v_i \\le T^\\star + \\epsilon$.\n\nFor each of these constrained systems, we iterate through the target fluxes $v_j$, setting the objective to first minimize $v_j$ and then maximize $v_j$ (i.e., minimize $-v_j$) to find the allowable flux range $[v_j^{\\min}, v_j^{\\max}]$.\n\nThe entire procedure is implemented algorithmically for each test case using the `scipy.optimize.linprog` function, which provides a robust solver for such LP problems. All numerical results are rounded to six decimal places as required.", "answer": "[4.000000,170.000000,204.000000,0.000000,8.000000,0.000000,8.000000,0.000000,0.000000,0.000000,0.000000,0.000000,8.000000,0.000000,8.000000,0.000000,0.000000,0.000000,0.000000,4.000000,4.000000,4.000000,4.000000,0.000000,0.000000,0.000000,0.000000,3.333333,48.888889,122.222222,0.000000,6.666667,0.000000,6.666667,0.000000,6.666667,0.000000,6.666667,0.000000,3.200000,0.000000,3.200000,0.000000,13.600000,0.000000,13.600000,3.333333,3.333333,3.333333,3.333333,3.333333,3.333333,3.333333,3.333333,0.000000,20.000000,70.000000,0.000000,0.000000,0.000000,0.000000,0.000000,20.000000,0.000000,20.000000,0.000000,0.000000,0.000000,0.000000,0.000000,20.000000,0.000000,20.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,10.000000,10.000000]", "id": "2506613"}]}