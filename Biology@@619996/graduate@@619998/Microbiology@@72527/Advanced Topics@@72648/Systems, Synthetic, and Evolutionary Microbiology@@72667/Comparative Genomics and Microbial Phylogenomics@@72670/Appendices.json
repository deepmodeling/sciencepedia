{"hands_on_practices": [{"introduction": "This exercise connects the abstract concept of Phred quality scores to the tangible outcome of false positive variant calls in a comparative genomics study. By deriving the expected number of false positives from first principles, you will develop a quantitative intuition for why stringent quality filtering is essential in phylogenomics. This practice is fundamental for critically evaluating the reliability of genomic datasets and understanding the statistical foundation of variant discovery pipelines.", "problem": "A comparative microbial phylogenomics study aims to identify single-nucleotide variants (SNVs) across $N$ clonal bacterial isolates with a shared core genome alignment of length $L$ base pairs, using next-generation sequencing (NGS) reads. Each site in each isolate is covered by exactly $D$ independent reads whose base calls are filtered by a minimum Phred quality score threshold $Q_{\\mathrm{th}}$. Assume perfect mapping, no genuine biological variation (the isolates are truly identical), and that sequencing errors at retained bases are independent across reads and isolates with per-base error probability $p_{\\mathrm{err}}$ determined by the Phred transformation $Q=-10\\log_{10}(p_{\\mathrm{err}})$. A naive site-level variant discovery procedure flags a site as variable if at least one read in at least one isolate reports a base different from the (true) reference base at that site.\n\nStarting from the definition of the Phred quality score and basic probability rules, derive the expected number of false positive variant sites $E_{\\mathrm{FP}}(Q_{\\mathrm{th}})$ as a function of $L$, $N$, $D$, and $p_{\\mathrm{err}}(Q_{\\mathrm{th}})$, and then simplify it in the small-error limit appropriate for stringent filtering, where $N D\\,p_{\\mathrm{err}}(Q_{\\mathrm{th}})\\ll 1$. Using this result, compute the ratio\n$$\nR \\equiv \\frac{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=20)}{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=30)}\n$$\nunder the same $L$, $N$, and $D$. Provide your final answer for $R$ as a single number (dimensionless). Do not round.", "solution": "The problem statement is first subjected to methodical validation.\n\nGivens are extracted verbatim:\n- $N$: number of clonal bacterial isolates.\n- $L$: length of the core genome alignment in base pairs.\n- $D$: number of independent reads covering each site in each isolate.\n- $Q_{\\mathrm{th}}$: a minimum Phred quality score threshold.\n- Assumption: perfect mapping.\n- Assumption: no genuine biological variation (isolates are truly identical).\n- Assumption: sequencing errors at retained bases are independent across reads and isolates.\n- $p_{\\mathrm{err}}$: per-base error probability.\n- Definition: Phred score $Q = -10\\log_{10}(p_{\\mathrm{err}})$.\n- Variant discovery rule: a site is flagged as variable if at least one read in at least one isolate reports a base different from the true reference base.\n- Task 1: Derive the expected number of false positive variant sites $E_{\\mathrm{FP}}(Q_{\\mathrm{th}})$ as a function of $L$, $N$, $D$, and $p_{\\mathrm{err}}(Q_{\\mathrm{th}})$.\n- Task 2: Simplify this expression in the small-error limit where $N D p_{\\mathrm{err}}(Q_{\\mathrm{th}}) \\ll 1$.\n- Task 3: Compute the ratio $R \\equiv \\frac{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=20)}{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=30)}$ using the simplified result.\n\nValidation Verdict:\nThe problem is valid. It is scientifically grounded in the principles of genomics and bioinformatics, specifically the statistical modeling of sequencing errors. The concepts of Phred scores, single-nucleotide variants, and false positive rates are standard in the field. The problem is well-posed, with all necessary parameters and assumptions clearly defined to construct a probabilistic model. The language is objective and precise. The assumptions, such as constant read depth and absence of true variation, are common idealizations used to establish a baseline error model. The problem is a non-trivial application of probability theory and requires logical derivation, not mere recitation of facts.\n\nSolution Derivation:\nWe begin by formalizing the per-base error probability, $p_{\\mathrm{err}}$, as a function of the Phred quality score threshold, $Q_{\\mathrm{th}}$. The problem defines $Q = -10\\log_{10}(p_{\\mathrm{err}})$. Solving for $p_{\\mathrm{err}}$ yields:\n$$\n\\log_{10}(p_{\\mathrm{err}}) = -\\frac{Q}{10}\n$$\n$$\np_{\\mathrm{err}}(Q) = 10^{-Q/10}\n$$\nFor a given threshold $Q_{\\mathrm{th}}$, we denote the error probability as $p_{\\mathrm{err}} \\equiv p_{\\mathrm{err}}(Q_{\\mathrm{th}})$. From the problem statement, all retained bases are assumed to have this error probability.\n\nThe probability of a single base call being correct (i.e., not an error) is $1 - p_{\\mathrm{err}}$.\nConsider a single genomic site. This site is covered by $D$ reads in each of the $N$ isolates, for a total of $N \\times D$ reads. The problem states that sequencing errors are independent across reads and isolates.\n\nA site is flagged as a false positive variant if at least one of the $N \\times D$ reads covering that site reports an erroneous base. It is simpler to calculate the probability of the complementary event: that the site is *not* flagged as a variant. This occurs if and only if all $N \\times D$ reads covering that site are correct.\n\nThe probability that all $N \\times D$ reads are correct, due to their independence, is the product of their individual probabilities of being correct:\n$$\nP(\\text{no error at site}) = (1 - p_{\\mathrm{err}})^{N D}\n$$\nThe probability that a site is flagged as a false positive, $P_{\\mathrm{FP}}$, is therefore:\n$$\nP_{\\mathrm{FP}} = 1 - P(\\text{no error at site}) = 1 - (1 - p_{\\mathrm{err}})^{N D}\n$$\nThe total number of false positive sites, a random variable, is the sum of Bernoulli trials over the $L$ sites in the alignment. Assuming errors are independent across sites, the expected number of false positive sites, $E_{\\mathrm{FP}}$, is the total number of sites $L$ multiplied by the probability of a single site being a false positive:\n$$\nE_{\\mathrm{FP}}(Q_{\\mathrm{th}}) = L \\cdot P_{\\mathrm{FP}} = L \\left(1 - (1 - p_{\\mathrm{err}}(Q_{\\mathrm{th}}))^{N D}\\right)\n$$\nThis is the complete expression for the expected number of false positives.\n\nNext, we simplify this expression in the small-error limit, where $N D p_{\\mathrm{err}} \\ll 1$. This condition allows us to use the first-order binomial approximation, $(1-x)^k \\approx 1 - kx$ for $|kx| \\ll 1$. Here, we identify $x = p_{\\mathrm{err}}$ and $k = N D$. The given condition $ND p_{\\mathrm{err}} \\ll 1$ ensures the validity of this approximation.\nApplying this to our expression for $P_{\\mathrm{FP}}$:\n$$\n(1 - p_{\\mathrm{err}})^{N D} \\approx 1 - N D p_{\\mathrm{err}}\n$$\nSubstituting this back into the formula for $E_{\\mathrm{FP}}$:\n$$\nE_{\\mathrm{FP}}(Q_{\\mathrm{th}}) \\approx L (1 - (1 - N D p_{\\mathrm{err}}(Q_{\\mathrm{th}}))) = L (1 - 1 + N D p_{\\mathrm{err}}(Q_{\\mathrm{th}})) = L N D p_{\\mathrm{err}}(Q_{\\mathrm{th}})\n$$\nThis simplified result states that the expected number of false positives is approximately the total number of sequenced bases ($L \\times N \\times D$) multiplied by the error rate per base.\n\nThe problem instructs us to use this simplified result to compute the ratio $R \\equiv \\frac{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=20)}{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=30)}$.\nUsing the approximation, we have:\n$$\nR = \\frac{L N D p_{\\mathrm{err}}(Q_{\\mathrm{th}}=20)}{L N D p_{\\mathrm{err}}(Q_{\\mathrm{th}}=30)}\n$$\nThe terms $L$, $N$, and $D$ cancel, leaving:\n$$\nR = \\frac{p_{\\mathrm{err}}(20)}{p_{\\mathrm{err}}(30)}\n$$\nWe now calculate the specific error probabilities for $Q=20$ and $Q=30$:\nFor $Q_{\\mathrm{th}} = 20$:\n$$\np_{\\mathrm{err}}(20) = 10^{-20/10} = 10^{-2} = 0.01\n$$\nFor $Q_{\\mathrm{th}} = 30$:\n$$\np_{\\mathrm{err}}(30) = 10^{-30/10} = 10^{-3} = 0.001\n$$\nSubstituting these values into the expression for $R$:\n$$\nR = \\frac{10^{-2}}{10^{-3}} = 10^{-2 - (-3)} = 10^1 = 10\n$$\nThe instruction to use the simplified model is crucial, as it renders the ratio independent of the parameters $L$, $N$, and $D$, yielding a single numerical answer. The ratio indicates that a quality threshold of $Q=20$ is expected to produce $10$ times more false positive variant sites than a threshold of $Q=30$, under the assumptions of this model.", "answer": "$$\n\\boxed{10}\n$$", "id": "2483725"}, {"introduction": "Moving from raw reads to assembled genomes, this problem tackles a central challenge in metagenomics: data incompleteness. You will model how the estimated completeness of Metagenome-Assembled Genomes (MAGs) directly impacts the accuracy of core genome estimation, a foundational step in many comparative analyses. This exercise highlights the importance of accounting for data quality metrics when interpreting high-level biological patterns like pan-genomes and provides a framework for developing more robust analysis strategies.", "problem": "You are performing a pan-genome analysis of two bacterial Metagenome-Assembled Genomes (MAGs). Each MAG has an estimated completeness of $0.90$ and contamination of $0.05$. Assume the following foundational model, which reflects widely used operational definitions in metagenome binning and gene presence–absence analyses:\n\n- A MAG’s completeness $c$ approximates, for any given single-copy gene truly present in that genome, the probability that this gene is recovered and correctly binned, so the per-gene false-negative (miss) probability is $1-c$.\n- Contamination consists of genes not belonging to the true target genome; it can generate false-positive gene presence calls but, under a strict orthology-aware scoring, it does not “rescue” a true gene that is missing from the bin. Thus, contamination does not reduce the false-absence probability for a true single-copy gene.\n- Across MAGs, gene recovery events are independent, and all core genes are truly present once per genome.\n- In the pan-genome, a strict core set is defined as the set of genes scored present in all genomes under consideration.\n\nUnder this model:\n\n1) Derive, in terms of $c$ and the number of genomes $n$, the expected fraction of true single-copy core genes that are falsely excluded from the strict core due to incomplete recovery. Then evaluate this expression for $n=2$ and $c=0.90$.\n\n2) Propose mathematically explicit filtering criteria to control false core-gene exclusion, expressed in terms of $c$, $n$, and a user-specified tolerance $\\epsilon$ for the expected fraction of true core genes that are lost under the strict-core definition. Provide a closed-form condition on the minimum completeness $c_{\\min}$ required to ensure the expected strict-core loss is at most $\\epsilon$, and state a complementary “soft-core” relaxation expressed via a binomial tail on the number of allowed missing genomes $m$.\n\nReport as your final answer only the numerical value for the expected false exclusion rate from part (1), expressed as a decimal fraction and rounded to three significant figures. Do not include any units or a percent sign in the final answer.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Number of Metagenome-Assembled Genomes (MAGs): $n$. For part (1), specifically $n=2$.\n- Estimated completeness per MAG: $c = 0.90$.\n- Estimated contamination per MAG: $0.05$.\n- Model definition of completeness $c$: The probability that a single-copy gene truly present in a genome is recovered.\n- False-negative (miss) probability for a true gene: $1-c$.\n- Contamination does not reduce the false-absence probability for a true gene.\n- Gene recovery events across MAGs are independent.\n- All core genes are truly present once per genome.\n- Definition of strict core set: The set of genes scored as present in all $n$ genomes under consideration.\n- Task 1: Derive the expected fraction of true single-copy core genes falsely excluded from the strict core, in terms of $c$ and $n$. Evaluate for $n=2$ and $c=0.90$.\n- Task 2: Propose filtering criteria to control false core-gene exclusion. This involves deriving a minimum completeness $c_{\\min}$ given a tolerance $\\epsilon$, and proposing a \"soft-core\" relaxation based on a binomial tail probability.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It formalizes a common challenge in computational biology—the effect of data incompleteness on comparative genomic inferences like core genome estimation. The model, while a simplification, is based on standard operational definitions used in metagenomics (e.g., CheckM outputs). The assumptions of independence and the definition of completeness are standard for first-order approximations. The questions are mathematically precise and can be solved using fundamental principles of probability theory. The problem contains no scientific fallacies, contradictions, or ambiguities. The value for contamination is extraneous to the specific questions posed about true core genes, but its presence does not invalidate the problem; it merely requires the solver to correctly identify the relevant information.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Part 1: Derivation and Evaluation of False Exclusion Rate**\n\nLet us consider a single true core gene. According to the problem statement, this gene is, by definition, present in the true genome of each of the $n$ MAGs.\n\nThe probability that this gene is successfully recovered in a single MAG is given by the completeness, $c$.\nThe probability that this gene is *not* recovered (a false negative) in a single MAG is $1-c$.\n\nA gene is included in the \"strict core set\" only if it is successfully recovered in *all* $n$ MAGs. Since the recovery events are stipulated to be independent across MAGs, the probability, $P_{\\text{core}}$, that a true core gene is correctly identified as part of the strict core is the product of the individual recovery probabilities:\n$$P_{\\text{core}} = \\prod_{i=1}^{n} c_i$$\nAssuming, as the problem implies, a uniform completeness $c$ across all MAGs, this simplifies to:\n$$P_{\\text{core}} = c^n$$\n\nThe problem asks for the expected fraction of true core genes that are falsely excluded. This is equivalent to the probability that a single true core gene is *not* included in the observed strict core set. This event occurs if the gene is missed in at least one MAG. The probability of this event, $P_{\\text{exclude}}$, is the complement of being included in the core set:\n$$P_{\\text{exclude}} = 1 - P_{\\text{core}}$$\nSubstituting the expression for $P_{\\text{core}}$, we obtain the general formula for the expected fraction of falsely excluded true core genes:\n$$P_{\\text{exclude}}(n, c) = 1 - c^n$$\n\nThis is the general derivation in terms of $c$ and $n$.\nNow, we must evaluate this expression for the given values: $n=2$ and $c=0.90$.\n$$P_{\\text{exclude}}(2, 0.90) = 1 - (0.90)^2$$\n$$P_{\\text{exclude}}(2, 0.90) = 1 - 0.81$$\n$$P_{\\text{exclude}}(2, 0.90) = 0.19$$\nThus, with two MAGs of $90\\%$ completeness, one expects to falsely lose $19\\%$ of the true core genome simply due to stochastic non-recovery. Rounding to three significant figures gives $0.190$.\n\n**Part 2: Filtering Criteria**\n\nFirst, we address the condition on minimum completeness, $c_{\\min}$. We are given a user-specified tolerance $\\epsilon$ for the maximum acceptable fraction of lost true core genes. The condition is:\n$$P_{\\text{exclude}} \\le \\epsilon$$\nSubstituting our derived expression:\n$$1 - c^n \\le \\epsilon$$\nTo find the minimum completeness $c_{\\min}$ that satisfies this for a given $n$ and $\\epsilon$, we solve the inequality for $c$:\n$$1 - \\epsilon \\le c^n$$\n$$c \\ge (1 - \\epsilon)^{1/n}$$\nTherefore, the closed-form condition on the minimum completeness is:\n$$c_{\\min} = (1 - \\epsilon)^{1/n}$$\nAny set of $n$ genomes must have an average completeness of at least this value to meet the tolerance $\\epsilon$ under the strict-core definition.\n\nSecond, we propose a \"soft-core\" relaxation. Instead of requiring a gene to be present in all $n$ MAGs, we can define a soft core as the set of genes present in at least $n-m$ MAGs, where $m$ is the maximum number of allowed misses.\n\nLet $X$ be a random variable representing the number of MAGs (out of $n$) in which a true core gene is successfully recovered. Under the problem's assumptions (independent trials, constant probability of success), $X$ follows a binomial distribution with parameters $n$ (number of trials) and $c$ (probability of success):\n$$X \\sim B(n, c)$$\nThe probability mass function is given by $P(X=k) = \\binom{n}{k} c^k (1-c)^{n-k}$.\n\nA true core gene is falsely excluded from this \"soft core\" if it is recovered in fewer than $n-m$ MAGs. The probability of this event, $P_{\\text{soft\\_exclude}}$, is the sum of probabilities of being found in $0, 1, \\dots, n-m-1$ MAGs. This is the left tail of the binomial distribution:\n$$P_{\\text{soft\\_exclude}} = P(X < n-m) = \\sum_{k=0}^{n-m-1} P(X=k)$$\n$$P_{\\text{soft\\_exclude}} = \\sum_{k=0}^{n-m-1} \\binom{n}{k} c^k (1-c)^{n-k}$$\nThe filtering criterion is to choose a relaxation parameter $m$ such that the expected loss is within the tolerance $\\epsilon$:\n$$\\sum_{k=0}^{n-m-1} \\binom{n}{k} c^k (1-c)^{n-k} \\le \\epsilon$$\nThis provides a mathematically explicit method to relax the strict core definition, controlling the false exclusion rate by allowing a specific number of misses, $m$, based on the number of genomes $n$, their completeness $c$, and the desired error tolerance $\\epsilon$.", "answer": "$$\\boxed{0.190}$$", "id": "2483716"}, {"introduction": "This final practice integrates several key skills in phylogenomics into a single, coherent workflow. Starting with a gene presence-absence matrix—a common output of pan-genome analysis—you will infer evolutionary relationships using a distance-based method and then quantitatively compare your resulting tree to a reference phylogeny. This exercise demonstrates how different types of genomic data can be used to reconstruct evolutionary history and introduces a standard metric for assessing topological congruence between trees.", "problem": "A set of four bacterial genomes $S_{1}, S_{2}, S_{3}, S_{4}$ have been analyzed for accessory gene content across six gene families $f_{1}, f_{2}, f_{3}, f_{4}, f_{5}, f_{6}$. The accessory gene presence ($1$) or absence ($0$) vectors are:\n- $S_{1}: (1,1,0,0,1,0)$\n- $S_{2}: (1,1,0,0,1,1)$\n- $S_{3}: (0,0,1,1,0,1)$\n- $S_{4}: (0,0,1,1,1,1)$\n\nStarting from first principles in comparative genomics and phylogenomics, do the following:\n1. Using the definition of the Hamming distance as the number of positions at which two binary vectors differ, compute the pairwise accessory gene content distances $d(S_{i}, S_{j})$ for all unordered pairs $\\{i,j\\} \\subset \\{1,2,3,4\\}$.\n2. From the resulting distance matrix, infer an unrooted phylogeny using the neighbor-joining (NJ) algorithm (Neighbor-Joining (NJ) should be interpreted in its standard sense from distance-based phylogenetics). Clearly state the resulting unrooted topology on the labeled leaves $S_{1}, S_{2}, S_{3}, S_{4}$.\n3. A reference core genome single-nucleotide polymorphism (SNP) maximum likelihood (ML) tree on the same taxa is given by the unrooted Newick topology $$((S_{1},S_{3}),(S_{2},S_{4})).$$ Treating both trees as unrooted and fully resolved on the same leaf set, compute the Robinson–Foulds (RF) distance (Robinson–Foulds (RF) distance is the number of nontrivial bipartitions present in one tree but not the other, summed over both trees).\n\nReport the RF distance as an exact integer with no units. No rounding is required.", "solution": "The problem is divided into three parts which must be addressed in sequence. First, we compute a distance matrix based on accessory gene content. Second, we infer a phylogeny from this matrix using the Neighbor-Joining algorithm. Third, we compare the inferred phylogeny to a reference phylogeny using the Robinson-Foulds distance. The problem is well-posed and scientifically grounded in the principles of comparative genomics and phylogenomics.\n\nThe set of four bacterial genomes is $S = \\{S_{1}, S_{2}, S_{3}, S_{4}\\}$. The accessory gene content is represented by binary vectors of length $6$, where $1$ denotes presence and $0$ denotes absence. The vectors are:\n$v_{1} = (1,1,0,0,1,0)$ for genome $S_{1}$\n$v_{2} = (1,1,0,0,1,1)$ for genome $S_{2}$\n$v_{3} = (0,0,1,1,0,1)$ for genome $S_{3}$\n$v_{4} = (0,0,1,1,1,1)$ for genome $S_{4}$\n\nPart 1: Pairwise Distance Calculation\nThe problem specifies the use of the Hamming distance, $d(S_{i}, S_{j})$, which is the number of positions at which the corresponding vectors $v_{i}$ and $v_{j}$ differ. We compute this for all $\\binom{4}{2} = 6$ unordered pairs of genomes.\n\n$d(S_{1}, S_{2})$: Compare $v_1=(1,1,0,0,1,0)$ and $v_2=(1,1,0,0,1,1)$. They differ only in the $6^{th}$ position. Thus, $d(S_{1}, S_{2}) = 1$.\n\n$d(S_{1}, S_{3})$: Compare $v_1=(1,1,0,0,1,0)$ and $v_3=(0,0,1,1,0,1)$. They differ in positions $1, 2, 3, 4, 5, 6$. Thus, $d(S_{1}, S_{3}) = 6$.\n\n$d(S_{1}, S_{4})$: Compare $v_1=(1,1,0,0,1,0)$ and $v_4=(0,0,1,1,1,1)$. They differ in positions $1, 2, 3, 4, 6$. Thus, $d(S_{1}, S_{4}) = 5$.\n\n$d(S_{2}, S_{3})$: Compare $v_2=(1,1,0,0,1,1)$ and $v_3=(0,0,1,1,0,1)$. They differ in positions $1, 2, 3, 4, 5$. Thus, $d(S_{2}, S_{3}) = 5$.\n\n$d(S_{2}, S_{4})$: Compare $v_2=(1,1,0,0,1,1)$ and $v_4=(0,0,1,1,1,1)$. They differ in positions $1, 2, 3, 4$. Thus, $d(S_{2}, S_{4}) = 4$.\n\n$d(S_{3}, S_{4})$: Compare $v_3=(0,0,1,1,0,1)$ and $v_4=(0,0,1,1,1,1)$. They differ only in the $5^{th}$ position. Thus, $d(S_{3}, S_{4}) = 1$.\n\nThis yields the symmetric distance matrix $D$:\n$$\nD = \\begin{pmatrix}\n0 & 1 & 6 & 5 \\\\\n1 & 0 & 5 & 4 \\\\\n6 & 5 & 0 & 1 \\\\\n5 & 4 & 1 & 0\n\\end{pmatrix}\n$$\nwhere rows and columns are indexed by $S_1, S_2, S_3, S_4$.\n\nPart 2: Neighbor-Joining (NJ) Tree Inference\nThe NJ algorithm aims to find pairs of taxa that are neighbors in the tree. It iteratively joins the closest neighbors based on a rate-corrected distance criterion. For a set of $n$ taxa, the algorithm proceeds as follows.\nFirst, for each taxon $i$, we compute its net divergence, $r_i$, from all other taxa: $r_i = \\sum_{k=1}^{n} d(S_i, S_k)$.\nFor our case with $n=4$:\n$r_{1} = d(S_{1}, S_{2}) + d(S_{1}, S_{3}) + d(S_{1}, S_{4}) = 1 + 6 + 5 = 12$\n$r_{2} = d(S_{2}, S_{1}) + d(S_{2}, S_{3}) + d(S_{2}, S_{4}) = 1 + 5 + 4 = 10$\n$r_{3} = d(S_{3}, S_{1}) + d(S_{3}, S_{2}) + d(S_{3}, S_{4}) = 6 + 5 + 1 = 12$\n$r_{4} = d(S_{4}, S_{1}) + d(S_{4}, S_{2}) + d(S_{4}, S_{3}) = 5 + 4 + 1 = 10$\n\nNext, we compute the NJ matrix $Q$, where $Q_{ij} = (n-2)d(S_i, S_j) - r_i - r_j$. For $n=4$, this becomes $Q_{ij} = 2d(S_i, S_j) - r_i - r_j$. The algorithm identifies the pair $(i, j)$ that minimizes $Q_{ij}$.\n$Q_{12} = 2d(S_{1}, S_{2}) - r_{1} - r_{2} = 2(1) - 12 - 10 = -20$\n$Q_{13} = 2d(S_{1}, S_{3}) - r_{1} - r_{3} = 2(6) - 12 - 12 = -12$\n$Q_{14} = 2d(S_{1}, S_{4}) - r_{1} - r_{4} = 2(5) - 12 - 10 = -12$\n$Q_{23} = 2d(S_{2}, S_{3}) - r_{2} - r_{3} = 2(5) - 10 - 12 = -12$\n$Q_{24} = 2d(S_{2}, S_{4}) - r_{2} - r_{4} = 2(4) - 10 - 10 = -12$\n$Q_{34} = 2d(S_{3}, S_{4}) - r_{3} - r_{4} = 2(1) - 12 - 10 = -20$\n\nThe minimum value in the $Q$ matrix is $-20$, which corresponds to pairs $(S_1, S_2)$ and $(S_3, S_4)$. In the standard NJ algorithm, any of the pairs that yield the minimum $Q$ value can be chosen to be joined. The algorithm selects such a pair, say $(S_1, S_2)$, as the first set of neighbors. For an unrooted tree of $4$ taxa, once one pair of neighbors is identified, the topology is fully determined. If $S_1$ and $S_2$ are neighbors, then $S_3$ and $S_4$ must also be neighbors, forming the other branch of the unrooted tree. The same conclusion is reached if we first select the pair $(S_3, S_4)$. Therefore, the Neighbor-Joining algorithm infers a topology where $S_1$ is clustered with $S_2$, and $S_3$ is clustered with $S_4$.\nThe resulting unrooted topology, let us call it $T_{NJ}$, can be written in Newick format as $((S_1,S_2),(S_3,S_4))$.\n\nPart 3: Robinson–Foulds (RF) Distance Calculation\nWe are asked to compute the RF distance between the inferred tree $T_{NJ}$ and the given reference tree, $T_{Ref}$.\n$T_{NJ}$ topology: $((S_1,S_2),(S_3,S_4))$\n$T_{Ref}$ topology: $((S_1,S_3),(S_2,S_4))$\n\nThe RF distance measures the dissimilarity between two phylogenetic trees on the same set of leaves. It is defined as the number of nontrivial bipartitions (or splits) of the leaves that are found in one tree but not the other. For a fully resolved (bifurcating) unrooted tree with $n$ leaves, there are $n-3$ internal edges, and each internal edge corresponds to one nontrivial bipartition of the leaves.\n\nIn our case, $n=4$, so each tree has $n-3 = 4-3 = 1$ internal edge and thus defines exactly one nontrivial bipartition.\nLet's identify the bipartition for each tree.\nFor $T_{NJ} = ((S_1,S_2),(S_3,S_4))$, removing the single internal edge separates the leaves into two sets: $\\{S_1, S_2\\}$ and $\\{S_3, S_4\\}$. The bipartition is $\\{\\{S_1, S_2\\}, \\{S_3, S_4\\}\\}$. Let's denote the set of bipartitions for $T_{NJ}$ as $B(T_{NJ})$. So, $B(T_{NJ}) = \\{\\{\\{S_1, S_2\\}, \\{S_3, S_4\\}\\}\\}$.\n\nFor $T_{Ref} = ((S_1,S_3),(S_2,S_4))$, removing the single internal edge separates the leaves into two sets: $\\{S_1, S_3\\}$ and $\\{S_2, S_4\\}$. The bipartition is $\\{\\{S_1, S_3\\}, \\{S_2, S_4\\}\\}$. Let's denote the set of bipartitions for $T_{Ref}$ as $B(T_{Ref})$. So, $B(T_{Ref}) = \\{\\{\\{S_1, S_3\\}, \\{S_2, S_4\\}\\}\\}$.\n\nThe RF distance is the size of the symmetric difference of these two sets of bipartitions:\n$d_{RF}(T_{NJ}, T_{Ref}) = |B(T_{NJ}) \\setminus B(T_{Ref})| + |B(T_{Ref}) \\setminus B(T_{NJ})|$.\n\nThe bipartition $\\{\\{S_1, S_2\\}, \\{S_3, S_4\\}\\}$ from $T_{NJ}$ is not present in $T_{Ref}$. So, $|B(T_{NJ}) \\setminus B(T_{Ref})| = 1$.\nThe bipartition $\\{\\{S_1, S_3\\}, \\{S_2, S_4\\}\\}$ from $T_{Ref}$ is not present in $T_{NJ}$. So, $|B(T_{Ref}) \\setminus B(T_{NJ})| = 1$.\n\nThe RF distance is the sum of these counts: $d_{RF} = 1 + 1 = 2$.", "answer": "$$\\boxed{2}$$", "id": "2483707"}]}