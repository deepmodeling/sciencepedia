{"hands_on_practices": [{"introduction": "Before we can model complex signaling networks, we must first understand the stage on which communication occurs: the biofilm's extracellular matrix. This dense, porous network of Extracellular Polymeric Substances (EPS) is not an empty volume, but a crowded environment that impedes the movement of signaling molecules. This exercise [@problem_id:2481843] challenges you to derive, from first principles, how the physical structure of the EPS modifies Fickian diffusion, leading to the crucial concept of an effective diffusion coefficient, $D_{\\text{eff}}$.", "problem": "In a hydrated bacterial biofilm, extracellular polymeric substances (EPS) create a porous, water-filled network through which small signaling molecules diffuse to mediate cell-cell communication. Consider a homogeneous, isotropic, steady-state, reaction-free slab of biofilm of thickness $L$, with average concentration $C(x)$ varying only along the $x$-direction. Within the water-filled pore space, the local flux obeys Fick’s first law with a molecular diffusivity $D$ that is spatially uniform in the fluid-filled pores and negligibly small in the polymer phase. Let the pore space be characterized by two geometric descriptors: the porosity $\\varepsilon$ (void fraction available to diffusion) and a geometric tortuosity $\\lambda := L_{e}/L \\geq 1$, where $L_{e}$ is the average arc-length of a diffusive streamline connecting the two faces separated by $L$.\n\nStarting exclusively from Fick’s first law at the pore scale and the geometric definitions of $\\varepsilon$ and $\\lambda$, derive a homogenized, one-dimensional constitutive relation of the form $J_{x}=-D_{\\text{eff}}\\,\\partial C/\\partial x$ that relates the area-averaged flux $J_{x}$ across the full cross-section (including both pore and polymer) to the macroscopic concentration gradient. Express $D_{\\text{eff}}$ explicitly in terms of $D$, $\\varepsilon$, and $\\lambda$, and interpret physically how $\\varepsilon$ and $\\lambda$ modify $D$.\n\nThen, introduce a single, dimensionless tortuosity factor $\\tau$ that aggregates the microstructural penalties of porosity and tortuosity so that $D_{\\text{eff}}$ can be written in the compact form $D_{\\text{eff}}=D/\\tau$. Finally, for a signaling molecule with $D=5\\times 10^{-6}$ cm$^{2}$/s in water and an EPS network characterized by $\\tau=3$, compute the numerical value of $D_{\\text{eff}}$. Express your final numerical estimate in centimeters squared per second and round your answer to two significant figures.", "solution": "The problem presented is a standard exercise in the homogenization of transport properties in porous media, a fundamental topic in chemical engineering and biophysics. It is scientifically grounded, well-posed, and contains all necessary information for a unique solution. Therefore, we proceed with the derivation and calculation.\n\nThe first task is to derive a one-dimensional constitutive relation for the area-averaged mass flux, $J_x$, in terms of an effective diffusivity, $D_{\\text{eff}}$. We begin from first principles as dictated.\n\nThe local flux of signaling molecules within the water-filled pore space is governed by Fick's first law. The flux is a vector quantity, $\\vec{j}$, related to the local concentration gradient, $\\nabla C$:\n$$\n\\vec{j} = -D \\nabla C\n$$\nThis law is valid only within the pores, where the diffusivity is $D$. In the polymer phase, the diffusivity is negligible, so the flux is zero.\n\nThe macroscopic flux, $J_x$, is the component of the flux vector in the $x$-direction, averaged over the total cross-sectional area, $A$, which includes both the pore space and the polymer matrix.\nLet $\\dot{N}$ be the total molar flow rate (moles per time) passing through a cross-section of the biofilm. The macroscopic flux is defined as:\n$$\nJ_x = \\frac{\\dot{N}}{A}\n$$\nThe flow can only occur through the pore area, $A_p$. The porosity, $\\varepsilon$, is defined as the fraction of the total area that is available for diffusion, so $A_p = \\varepsilon A$. The flux is not uniform across the pore cross-section and is not necessarily aligned with the $x$-axis. The total flow rate $\\dot{N}$ is the integral of the normal component of the local flux vector over the pore area. However, under the simplifying assumptions provided, we can use an argument based on average quantities.\n\nLet us consider the flux along an average, representative streamline. The flux along this tortuous path, of coordinate $s$, is $J_s$. According to Fick's law:\n$$\nJ_s = -D \\frac{dC}{ds}\n$$\nFor a steady-state condition across the slab of thickness $L$, there is a constant concentration difference $\\Delta C$ between the faces. The average gradient along the tortuous path of length $L_e$ is $\\frac{\\Delta C}{L_e}$. Thus, the average flux along the path is:\n$$\nJ_s \\approx -D \\frac{\\Delta C}{L_e}\n$$\nThe total molar flow rate, $\\dot{N}$, is the product of this flux along the streamline, $J_s$, and the total area of the pores through which this flux passes, $A_p$:\n$$\n\\dot{N} = J_s A_p = \\left(-D \\frac{\\Delta C}{L_e}\\right) (\\varepsilon A)\n$$\nWe substitute this expression for $\\dot{N}$ back into the definition of the macroscopic flux $J_x$:\n$$\nJ_x = \\frac{\\dot{N}}{A} = \\frac{1}{A} \\left(-D \\varepsilon A \\frac{\\Delta C}{L_e}\\right) = -D \\varepsilon \\frac{\\Delta C}{L_e}\n$$\nTo relate this expression to the desired form, we must express $\\Delta C$ and $L_e$ in terms of macroscopic variables. The macroscopic concentration gradient, $\\frac{\\partial C}{\\partial x}$, over the thickness $L$ is, on average, $\\frac{\\Delta C}{L}$. Therefore, we write $\\Delta C = L \\frac{\\partial C}{\\partial x}$. The geometric tortuosity, $\\lambda$, is given as $\\lambda = \\frac{L_e}{L}$, which means the effective path length is $L_e = \\lambda L$.\n\nSubstituting these two relations into the expression for $J_x$:\n$$\nJ_x = -D \\varepsilon \\frac{L \\frac{\\partial C}{\\partial x}}{\\lambda L} = - \\left(\\frac{D \\varepsilon}{\\lambda}\\right) \\frac{\\partial C}{\\partial x}\n$$\nThis equation is the homogenized, one-dimensional constitutive relation. By comparing it to the target form $J_x = -D_{\\text{eff}} \\frac{\\partial C}{\\partial x}$, we identify the effective diffusivity:\n$$\nD_{\\text{eff}} = \\frac{D \\varepsilon}{\\lambda}\n$$\nThe physical interpretation of this result is straightforward. The effective diffusivity $D_{\\text{eff}}$ is reduced compared to the molecular diffusivity $D$ by two factors:\n$1$. Porosity, $\\varepsilon$: This factor, with $0 < \\varepsilon \\leq 1$, accounts for the reduction in the cross-sectional area available for diffusion. The flux is directly proportional to the available area, hence the direct proportionality to $\\varepsilon$.\n$2$. Tortuosity, $\\lambda$: This factor, with $\\lambda \\geq 1$, accounts for the increased length of the diffusion path. For a fixed concentration drop, a longer path results in a smaller concentration gradient, which is the driving force for diffusion. The flux is thus inversely proportional to the path length, hence the inverse proportionality to $\\lambda$.\n\nNext, we are asked to introduce a single dimensionless tortuosity factor, $\\tau$, that aggregates these microstructural penalties, such that $D_{\\text{eff}} = \\frac{D}{\\tau}$. We equate our derived expression for $D_{\\text{eff}}$ with this compact form:\n$$\n\\frac{D \\varepsilon}{\\lambda} = \\frac{D}{\\tau}\n$$\nSolving for $\\tau$ gives:\n$$\n\\tau = \\frac{\\lambda}{\\varepsilon}\n$$\nThis combined factor $\\tau$ correctly captures that the porous medium becomes more obstructive to diffusion (i.e., $\\tau$ increases) as the path becomes more tortuous (larger $\\lambda$) or as the void fraction becomes smaller (smaller $\\varepsilon$).\n\nFinally, we must compute the numerical value of $D_{\\text{eff}}$ given the values $D = 5 \\times 10^{-6}$ cm$^{2}$/s and $\\tau = 3$.\nUsing the compact form for the effective diffusivity:\n$$\nD_{\\text{eff}} = \\frac{D}{\\tau} = \\frac{5 \\times 10^{-6} \\text{ cm}^2/\\text{s}}{3}\n$$\n$$\nD_{\\text{eff}} = \\frac{5}{3} \\times 10^{-6} \\text{ cm}^2/\\text{s} \\approx 1.666... \\times 10^{-6} \\text{ cm}^2/\\text{s}\n$$\nThe problem requires the answer to be rounded to two significant figures.\n$$\nD_{\\text{eff}} \\approx 1.7 \\times 10^{-6} \\text{ cm}^2/\\text{s}\n$$\nThis is the final numerical value for the effective diffusivity of the signaling molecule in the specified biofilm EPS network.", "answer": "$$\\boxed{1.7 \\times 10^{-6}}$$", "id": "2481843"}, {"introduction": "A signal's journey through the biofilm matrix is a race against time. In addition to physical obstruction, many autoinducers, such as acyl-homoserine lactones (AHLs), are chemically unstable and degrade over time. This practice [@problem_id:2481839] explores the critical interplay between diffusion and signal decay. By solving a steady-state reaction-diffusion model, you will derive the characteristic communication length, a fundamental parameter that quantifies how far a signal can travel before it is effectively lost, thereby defining its spatial range of influence.", "problem": "In alkaline biofilm microenvironments, acyl-homoserine lactone (AHL) quorum-sensing signals undergo base-catalyzed lactonolysis that can be modeled as first-order hydrolysis. Consider two AHLs, denoted AHL-A and AHL-B, with experimentally reported hydrolysis half-lives at pH $8.0$ of $t_{1/2,\\mathrm{A}} = 0.80$ hours and $t_{1/2,\\mathrm{B}} = 5.0$ hours, respectively. Assume the hydrolysis follows first-order kinetics and that the diffusive transport within the hydrated biofilm matrix is well-approximated as one-dimensional with constant diffusion coefficients $D_{\\mathrm{A}} = 1.2 \\times 10^{-10}$ $\\mathrm{m^{2}\\ s^{-1}}$ and $D_{\\mathrm{B}} = 0.8 \\times 10^{-10}$ $\\mathrm{m^{2}\\ s^{-1}}$ for AHL-A and AHL-B, respectively.\n\nTasks:\n1) Starting from the definition of half-life for a first-order process, compute the fraction of each AHL remaining after $t = 2.0$ hours in a well-mixed volume, expressed as $f_{\\mathrm{A}}(2.0\\ \\mathrm{h})$ and $f_{\\mathrm{B}}(2.0\\ \\mathrm{h})$.\n\n2) Starting from the steady-state reaction-diffusion balance for a one-dimensional concentration field $c(x)$ with first-order loss, namely $D \\,\\frac{d^{2}c}{dx^{2}} - k\\,c = 0$, with boundary conditions $c(0) = c_{0}$ and $c(x)$ bounded as $x \\to \\infty$, derive the characteristic communication length $L$ defined as the distance $x$ at which $c(x)$ has decayed to $c_{0}/\\exp(1)$, in terms of the diffusion coefficient $D$ and the first-order rate constant $k$.\n\n3) Using your result for $L$, compute the ratio $L_{\\mathrm{A}}/L_{\\mathrm{B}}$ for the two AHLs at pH $8.0$ using the given $D$ values and the $k$ values inferred from the reported half-lives. Report this ratio as your single numerical answer. Round your final answer to four significant figures. The final reported ratio is dimensionless.\n\nIn your reasoning, explain how the computed fractions and length scales inform the expected communication range of these signals in alkaline biofilms, but report only the ratio $L_{\\mathrm{A}}/L_{\\mathrm{B}}$ as your final answer.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Process: First-order hydrolysis of acyl-homoserine lactones (AHLs) in an alkaline biofilm.\n- Signal AHL-A:\n  - Half-life: $t_{1/2,\\mathrm{A}} = 0.80$ hours at pH $8.0$.\n  - Diffusion coefficient: $D_{\\mathrm{A}} = 1.2 \\times 10^{-10}$ $\\mathrm{m^{2}\\ s^{-1}}$.\n- Signal AHL-B:\n  - Half-life: $t_{1/2,\\mathrm{B}} = 5.0$ hours at pH $8.0$.\n  - Diffusion coefficient: $D_{\\mathrm{B}} = 0.8 \\times 10^{-10}$ $\\mathrm{m^{2}\\ s^{-1}}$.\n- Reaction-Diffusion Model: One-dimensional, steady-state equation is $D \\,\\frac{d^{2}c}{dx^{2}} - k\\,c = 0$.\n- Boundary Conditions: $c(0) = c_{0}$ and $c(x)$ remains bounded as $x \\to \\infty$.\n- Definition: Characteristic communication length $L$ is the distance $x$ where $c(x) = c_{0}/\\exp(1)$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is scientifically sound. It models a well-established biological phenomenon—quorum sensing in biofilms—using standard principles of chemical kinetics (first-order decay) and mass transport (Fickian diffusion). The reaction-diffusion equation provided is the correct one-dimensional, steady-state representation for a species undergoing first-order decay.\n- **Well-Posedness**: The problem is well-posed. The physical parameters are provided, the governing equation and boundary conditions are specified, and the tasks are clearly defined, leading to a unique and stable solution.\n- **Objectivity**: The problem is stated using objective, quantitative language without ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a standard exercise in biophysical chemistry and chemical reaction engineering, grounded in correct physical and mathematical principles. The solution process may proceed.\n\nThe solution is developed in three parts as requested.\n\n**Part 1: Fraction of AHL remaining after a specified time**\n\nFor a first-order process, the concentration $C(t)$ of a substance at time $t$ is given by the rate law:\n$$C(t) = C(0) \\exp(-kt)$$\nwhere $C(0)$ is the initial concentration and $k$ is the first-order rate constant. The half-life, $t_{1/2}$, is the time required for the concentration to decrease to half of its initial value, $C(t_{1/2}) = C(0)/2$. Substituting this into the rate law gives:\n$$\\frac{C(0)}{2} = C(0) \\exp(-k t_{1/2})$$\n$$\\frac{1}{2} = \\exp(-k t_{1/2})$$\nTaking the natural logarithm of both sides yields:\n$$\\ln\\left(\\frac{1}{2}\\right) = -k t_{1/2}$$\n$$-\\ln(2) = -k t_{1/2}$$\nThus, the relationship between the rate constant and half-life for a first-order process is:\n$$k = \\frac{\\ln(2)}{t_{1/2}}$$\nThe fraction of AHL remaining, $f(t)$, is the ratio $C(t)/C(0)$:\n$$f(t) = \\frac{C(t)}{C(0)} = \\exp(-kt)$$\nSubstituting the expression for $k$:\n$$f(t) = \\exp\\left(-\\frac{\\ln(2)}{t_{1/2}}t\\right) = \\exp\\left(\\ln\\left(2^{-t/t_{1/2}}\\right)\\right) = 2^{-t/t_{1/2}}$$\nWe compute this fraction for each AHL at $t = 2.0$ hours.\n\nFor AHL-A, with $t_{1/2,\\mathrm{A}} = 0.80$ hours:\n$$f_{\\mathrm{A}}(2.0\\ \\mathrm{h}) = 2^{-2.0/0.80} = 2^{-2.5} \\approx 0.1768$$\nFor AHL-B, with $t_{1/2,\\mathrm{B}} = 5.0$ hours:\n$$f_{\\mathrm{B}}(2.0\\ \\mathrm{h}) = 2^{-2.0/5.0} = 2^{-0.4} \\approx 0.7579$$\nThese values indicate that AHL-A degrades significantly faster than AHL-B in a well-mixed environment.\n\n**Part 2: Derivation of the characteristic communication length $L$**\n\nWe must solve the steady-state reaction-diffusion equation for the concentration profile $c(x)$:\n$$D \\frac{d^{2}c}{dx^{2}} - kc = 0$$\nThis is a second-order, linear, homogeneous ordinary differential equation with constant coefficients. The characteristic equation is:\n$$Dr^2 - k = 0$$\nThe roots are $r = \\pm\\sqrt{k/D}$. The general solution is therefore:\n$$c(x) = A_{1} \\exp\\left(\\sqrt{\\frac{k}{D}}x\\right) + A_{2} \\exp\\left(-\\sqrt{\\frac{k}{D}}x\\right)$$\nwhere $A_1$ and $A_2$ are constants determined by the boundary conditions.\nThe first boundary condition is $c(0) = c_0$:\n$$c_0 = A_{1}\\exp(0) + A_{2}\\exp(0) = A_1 + A_2$$\nThe second boundary condition is that $c(x)$ must be bounded as $x \\to \\infty$. The term $\\exp\\left(\\sqrt{\\frac{k}{D}}x\\right)$ grows without bound as $x \\to \\infty$. To satisfy the boundary condition, its coefficient must be zero, so $A_1 = 0$.\nFrom the first condition, we then have $A_2 = c_0$. The specific solution for the concentration profile is:\n$$c(x) = c_0 \\exp\\left(-\\sqrt{\\frac{k}{D}}x\\right)$$\nThe characteristic communication length $L$ is defined as the distance $x$ at which the concentration has decayed to $c_0/\\exp(1)$. We set $x=L$ and $c(L) = c_0 \\exp(-1)$:\n$$c_0 \\exp(-1) = c_0 \\exp\\left(-\\sqrt{\\frac{k}{D}}L\\right)$$\nEquating the exponents:\n$$-1 = -\\sqrt{\\frac{k}{D}}L$$\nSolving for $L$ gives the expression for the characteristic length:\n$$L = \\frac{1}{\\sqrt{k/D}} = \\sqrt{\\frac{D}{k}}$$\nThis length scale represents the distance over which a signaling molecule can diffuse before it is effectively removed by reaction.\n\n**Part 3: Calculation of the ratio of characteristic lengths $L_{\\mathrm{A}}/L_{\\mathrm{B}}$**\n\nUsing the derived expression for $L$, the ratio $L_{\\mathrm{A}}/L_{\\mathrm{B}}$ is:\n$$\\frac{L_{\\mathrm{A}}}{L_{\\mathrm{B}}} = \\frac{\\sqrt{D_{\\mathrm{A}}/k_{\\mathrm{A}}}}{\\sqrt{D_{\\mathrm{B}}/k_{\\mathrm{B}}}} = \\sqrt{\\frac{D_{\\mathrm{A}}}{k_{\\mathrm{A}}} \\cdot \\frac{k_{\\mathrm{B}}}{D_{\\mathrm{B}}}} = \\sqrt{\\left(\\frac{D_{\\mathrm{A}}}{D_{\\mathrm{B}}}\\right)\\left(\\frac{k_{\\mathrm{B}}}{k_{\\mathrm{A}}}\\right)}$$\nWe substitute the relationship $k = \\ln(2)/t_{1/2}$ into the ratio of the rate constants:\n$$\\frac{k_{\\mathrm{B}}}{k_{\\mathrm{A}}} = \\frac{\\ln(2)/t_{1/2,\\mathrm{B}}}{\\ln(2)/t_{1/2,\\mathrm{A}}} = \\frac{t_{1/2,\\mathrm{A}}}{t_{1/2,\\mathrm{B}}}$$\nThe expression for the ratio of lengths becomes:\n$$\\frac{L_{\\mathrm{A}}}{L_{\\mathrm{B}}} = \\sqrt{\\left(\\frac{D_{\\mathrm{A}}}{D_{\\mathrm{B}}}\\right)\\left(\\frac{t_{1/2,\\mathrm{A}}}{t_{1/2,\\mathrm{B}}}\\right)}$$\nNow, we substitute the given numerical values:\n$D_{\\mathrm{A}} = 1.2 \\times 10^{-10}$ $\\mathrm{m^{2}\\ s^{-1}}$\n$D_{\\mathrm{B}} = 0.8 \\times 10^{-10}$ $\\mathrm{m^{2}\\ s^{-1}}$\n$t_{1/2,\\mathrm{A}} = 0.80$ hours\n$t_{1/2,\\mathrm{B}} = 5.0$ hours\n\nThe units for $D$ and $t_{1/2}$ cancel in the ratios, so no conversion is necessary.\n$$\\frac{D_{\\mathrm{A}}}{D_{\\mathrm{B}}} = \\frac{1.2 \\times 10^{-10}}{0.8 \\times 10^{-10}} = \\frac{1.2}{0.8} = 1.5$$\n$$\\frac{t_{1/2,\\mathrm{A}}}{t_{1/2,\\mathrm{B}}} = \\frac{0.80}{5.0} = 0.16$$\nSubstituting these values into the expression for the ratio of lengths:\n$$\\frac{L_{\\mathrm{A}}}{L_{\\mathrm{B}}} = \\sqrt{1.5 \\times 0.16} = \\sqrt{0.24}$$\nCalculating the numerical value and rounding to four significant figures:\n$$\\frac{L_{\\mathrm{A}}}{L_{\\mathrm{B}}} \\approx 0.4898979... \\approx 0.4899$$\nThe ratio being less than $1$ indicates that the characteristic communication length for AHL-A is significantly shorter than for AHL-B. This is a direct consequence of the much faster hydrolysis of AHL-A (a shorter half-life), which outweighs its slightly faster diffusion. Therefore, in an alkaline biofilm, AHL-A acts as a short-range signal, while AHL-B is capable of mediating communication over longer distances.", "answer": "$$\\boxed{0.4899}$$", "id": "2481839"}, {"introduction": "Having explored the fundamental physics of diffusion and decay, we now advance to a systems-level challenge: predicting emergent spatial patterns from the interplay of signal production, transport, and cellular response. This final practice [@problem_id:2481788] asks you to construct and implement a computational model of a synthetic microbial consortium. By numerically solving the reaction-diffusion equation and coupling it to a non-linear genetic circuit, you will investigate how a simple sender-receiver system can generate complex spatial structures like stripes, a classic example of biologically-driven pattern formation.", "problem": "Construct a principled, first-principles model of spatial stripe formation in a one-dimensional biofilm comprised of a sender strain producing an autoinducer and a receiver strain responding to the autoinducer. Use the following fundamental base: Fick’s law of diffusion, linear first-order decay, and Hill-type transcriptional regulation.\n\nA sender band occupies the central region of a one-dimensional domain, producing an autoinducer that diffuses and degrades. The receiver cells are present throughout the domain. Let the spatial domain be $x \\in [-L,L]$, with reflective (zero-flux) boundaries at $x=-L$ and $x=L$. The steady-state concentration $A(x)$ of the autoinducer satisfies the mass balance implied by Fick’s law and linear decay with a spatially localized source:\n- Fick’s law: the diffusive flux is $J(x) = -D \\,\\frac{dA}{dx}$.\n- Conservation at steady state: $\\frac{d}{dx} J(x) - \\mu A(x) + q\\, s(x) = 0$.\n- Combining these, the steady-state partial differential equation is\n$$\n0 = D \\frac{d^2 A}{dx^2} - \\mu A(x) + q \\, s(x),\n$$\nwith Neumann boundary conditions\n$$\n\\left.\\frac{dA}{dx}\\right|_{x=-L} = 0, \\quad \\left.\\frac{dA}{dx}\\right|_{x=+L} = 0.\n$$\nHere $D$ is the diffusion coefficient, $\\mu$ is the first-order decay rate, $q$ is the uniform production rate within the sender band, and $s(x)$ is the sender occupancy function\n$$\ns(x) = \\begin{cases}\n1  \\text{if } |x| \\le \\frac{w}{2},\\\\\n0  \\text{if } |x| > \\frac{w}{2},\n\\end{cases}\n$$\nwhere $w$ is the sender band width. All quantities are nondimensional.\n\nThe receiver strain reports “on” when a band-pass condition is satisfied via two opposing Hill modules, an activation module and a repression module:\n- Activation Hill function $H_{\\text{on}}(A) = \\dfrac{A^{n_{\\text{on}}}}{K_{\\text{on}}^{n_{\\text{on}}} + A^{n_{\\text{on}}}}$,\n- Repression Hill function $H_{\\text{off}}(A) = \\dfrac{A^{n_{\\text{off}}}}{K_{\\text{off}}^{n_{\\text{off}}} + A^{n_{\\text{off}}}}$.\nDefine the receiver to be “on” at a position $x$ if and only if both $H_{\\text{on}}(A(x)) \\ge \\tau$ and $H_{\\text{off}}(A(x)) \\le \\tau$ hold simultaneously, with the decision threshold $\\tau = \\frac{1}{2}$. Equivalently, this imposes a band-pass window on $A(x)$ around $K_{\\text{on}}$ and $K_{\\text{off}}$.\n\nDefine a “stripe” as a contiguous interval of positions where the receiver is “on” and which lies entirely in the receiver-only region $\\{x: |x| > \\frac{w}{2}\\}$ (that is, exclude the sender-occupied band). The final quantity to compute for each parameter set is the integer number of such disjoint contiguous intervals.\n\nAlgorithmic requirements:\n- Discretize the domain $[-L,L]$ into $N$ uniformly spaced grid points with $N$ odd (to include $x=0$ exactly). You must use $N=2001$. Let the grid spacing be $\\Delta x = \\dfrac{2L}{N-1}$.\n- Discretize the steady-state equation using second-order central differences in the interior and one-sided second-order Neumann boundary stencils at the boundaries. For interior grid index $i$,\n$$\nD \\frac{A_{i-1} - 2 A_i + A_{i+1}}{\\Delta x^2} - \\mu A_i + q\\, s_i = 0.\n$$\nFor the boundary indices $i=0$ and $i=N-1$, enforce zero-flux $\\left.\\frac{dA}{dx}\\right|=0$ via a standard ghost-point elimination, resulting in\n$$\nD \\frac{2(A_{1} - A_{0})}{\\Delta x^2} - \\mu A_{0} + q\\, s_{0} = 0,\\quad\nD \\frac{2(A_{N-2} - A_{N-1})}{\\Delta x^2} - \\mu A_{N-1} + q\\, s_{N-1} = 0.\n$$\n- Assemble the resulting linear system and solve for the steady-state vector $\\mathbf{A}$ of size $N$.\n- Evaluate $H_{\\text{on}}(A_i)$ and $H_{\\text{off}}(A_i)$ for each grid point, and declare the receiver “on” at grid point $i$ if $H_{\\text{on}}(A_i) \\ge \\frac{1}{2}$ and $H_{\\text{off}}(A_i) \\le \\frac{1}{2}$ and $|x_i| > \\frac{w}{2}$.\n- Count the number of disjoint contiguous segments of grid points satisfying the “on” condition. A segment is a maximal set of consecutive indices for which the condition holds; count each such maximal set as one stripe.\n\nAll variables and parameters are nondimensional.\n\nTest suite:\nProvide results for the following four parameter sets (each line lists $(D,\\mu,L,w,q,K_{\\text{on}},K_{\\text{off}},n_{\\text{on}},n_{\\text{off}})$):\n- Case $1$: $(1.0,\\,1.0,\\,10.0,\\,2.0,\\,1.0,\\,0.2,\\,0.6,\\,2.0,\\,2.0)$.\n- Case $2$: $(1.0,\\,1.0,\\,10.0,\\,2.0,\\,0.1,\\,0.2,\\,0.6,\\,2.0,\\,2.0)$.\n- Case $3$: $(1.0,\\,1.0,\\,10.0,\\,2.0,\\,1.0,\\,1.2,\\,2.0,\\,2.0,\\,2.0)$.\n- Case $4$: $(0.5,\\,1.0,\\,10.0,\\,2.0,\\,1.0,\\,0.2,\\,0.6,\\,2.0,\\,2.0)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$), where $r_j$ is the integer number of stripes detected for test case $j$.\n\nDeliverables:\n- A single, complete, runnable program that constructs the finite-difference system, solves for $A(x)$, evaluates the receiver “on” mask, counts stripes, and prints the results for the four test cases in the exact required format, with no extra text or whitespace.", "solution": "The problem statement has been rigorously validated and is determined to be sound. It is scientifically grounded in established principles of reaction-diffusion systems and molecular biology, is mathematically well-posed, and is specified with sufficient, unambiguous detail to permit a unique, verifiable solution. The problem is free of logical contradictions, factual errors, or subjective claims. Therefore, a complete solution is warranted.\n\nThe problem requires the determination of the number of spatial stripes formed by a receiver microbial strain in response to a diffusible autoinducer molecule, $A$. The system is modeled in one spatial dimension, $x$, over the domain $x \\in [-L, L]$.\n\nThe core of the model is the steady-state reaction-diffusion equation for the autoinducer concentration, $A(x)$:\n$$\nD \\frac{d^2 A}{dx^2} - \\mu A(x) + q \\, s(x) = 0\n$$\nThis equation represents a balance between diffusion (first term, from Fick's law), first-order decay (second term), and production (third term). Here, $D$ is the diffusion coefficient, $\\mu$ is the decay rate constant, and $q$ is the production rate. The production occurs only within a central band of sender cells of width $w$, as described by the source function:\n$$\ns(x) = \\begin{cases}\n1  \\text{if } |x| \\le \\frac{w}{2},\\\\\n0  \\text{if } |x| > \\frac{w}{2}.\n\\end{cases}\n$$\nThe domain is closed, with zero-flux (Neumann) boundary conditions, reflecting that no autoinducer can leave the system:\n$$\n\\left.\\frac{dA}{dx}\\right|_{x=-L} = 0, \\quad \\left.\\frac{dA}{dx}\\right|_{x=+L} = 0.\n$$\nTo solve this boundary value problem numerically, we discretize the spatial domain. The interval $[-L, L]$ is divided into $N = 2001$ uniformly spaced grid points, $x_i = -L + i \\cdot \\Delta x$ for $i \\in \\{0, 1, \\dots, N-1\\}$, where the grid spacing is $\\Delta x = \\frac{2L}{N-1}$. The concentration at these points is denoted by $A_i = A(x_i)$.\n\nThe differential equation is approximated using finite differences. For an interior grid point $i$ (where $1 \\le i \\le N-2$), a second-order central difference stencil is used for the second derivative:\n$$\n\\left.\\frac{d^2 A}{dx^2}\\right|_{x_i} \\approx \\frac{A_{i-1} - 2 A_i + A_{i+1}}{\\Delta x^2}.\n$$\nSubstituting this into the governing equation yields a linear algebraic equation for each interior point:\n$$\nD \\frac{A_{i-1} - 2 A_i + A_{i+1}}{\\Delta x^2} - \\mu A_i + q s_i = 0.\n$$\nFor the boundary points $i=0$ and $i=N-1$, the zero-flux condition is enforced using the specified second-order accurate stencils, which arise from eliminating a \"ghost point\" outside the domain:\nFor $i=0$:\n$$\nD \\frac{2(A_1 - A_0)}{\\Delta x^2} - \\mu A_0 + q s_0 = 0.\n$$\nFor $i=N-1$:\n$$\nD \\frac{2(A_{N-2} - A_{N-1})}{\\Delta x^2} - \\mu A_{N-1} + q s_{N-1} = 0.\n$$\nThis set of $N$ linear equations can be expressed in matrix form, $\\mathbf{M} \\mathbf{A} = \\mathbf{b}$, where $\\mathbf{A} = [A_0, A_1, \\dots, A_{N-1}]^T$ is the vector of unknown concentrations, $\\mathbf{M}$ is an $N \\times N$ matrix of coefficients, and $\\mathbf{b}$ is an $N \\times 1$ source vector.\n\nBy rearranging the discretized equations, we can construct the matrix $\\mathbf{M}$ and vector $\\mathbf{b}$:\nThe general form of the $i$-th equation is:\n$$\n\\left(\\frac{D}{\\Delta x^2}\\right) A_{i-1} - \\left(\\frac{2D}{\\Delta x^2} + \\mu\\right) A_i + \\left(\\frac{D}{\\Delta x^2}\\right) A_{i+1} = -q s_i, \\quad \\text{for } 1 \\le i \\le N-2.\n$$\nThe boundary equations are:\n$$\n-\\left(\\frac{2D}{\\Delta x^2} + \\mu\\right) A_0 + \\left(\\frac{2D}{\\Delta x^2}\\right) A_1 = -q s_0, \\quad \\text{for } i=0.\n$$\n$$\n\\left(\\frac{2D}{\\Delta x^2}\\right) A_{N-2} - \\left(\\frac{2D}{\\Delta x^2} + \\mu\\right) A_{N-1} = -q s_{N-1}, \\quad \\text{for } i=N-1.\n$$\nFrom these expressions, the tridiagonal matrix $\\mathbf{M}$ has the following non-zero elements:\n- Main diagonal: $M_{i,i} = -(\\frac{2D}{\\Delta x^2} + \\mu)$ for all $i \\in \\{0, \\dots, N-1\\}$.\n- Upper diagonal: $M_{i,i+1} = \\frac{D}{\\Delta x^2}$ for $i \\in \\{1, \\dots, N-2\\}$, with a special boundary term $M_{0,1} = \\frac{2D}{\\Delta x^2}$.\n- Lower diagonal: $M_{i,i-1} = \\frac{D}{\\Delta x^2}$ for $i \\in \\{1, \\dots, N-2\\}$, with a special boundary term $M_{N-1,N-2} = \\frac{2D}{\\Delta x^2}$.\nThe source vector $\\mathbf{b}$ has elements $b_i = -q s_i$, where $s_i = 1$ if $|x_i| \\le \\frac{w}{2}$ and $s_i = 0$ otherwise. The system $\\mathbf{M} \\mathbf{A} = \\mathbf{b}$ is solved for the vector $\\mathbf{A}$ using a standard linear solver.\n\nOnce the steady-state concentration profile $\\mathbf{A}$ is obtained, we determine the response of the receiver strain. A receiver is \"on\" at position $x_i$ if two conditions are met simultaneously: $H_{\\text{on}}(A_i) \\ge \\frac{1}{2}$ and $H_{\\text{off}}(A_i) \\le \\frac{1}{2}$. The Hill function threshold condition with $\\tau = \\frac{1}{2}$ simplifies significantly. For an activating Hill function $H_{\\text{on}}(A) = \\frac{A^{n_{\\text{on}}}}{K_{\\text{on}}^{n_{\\text{on}}} + A^{n_{\\text{on}}}}$, the condition $H_{\\text{on}}(A) \\ge \\frac{1}{2}$ is equivalent to $A \\ge K_{\\text{on}}$. Similarly, for a repressing Hill function used here in an \"off\" logic $H_{\\text{off}}(A) = \\frac{A^{n_{\\text{off}}}}{K_{\\text{off}}^{n_{\\text{off}}} + A^{n_{\\text{off}}}}$, the condition $H_{\\text{off}}(A) \\le \\frac{1}{2}$ is equivalent to $A \\le K_{\\text{off}}$. Thus, the receiver is \"on\" if and only if the concentration $A_i$ falls within the band-pass window $[K_{\\text{on}}, K_{\\text{off}}]$. The specific values of the Hill coefficients $n_{\\text{on}}$ and $n_{\\text{off}}$ do not influence the thresholds, only the steepness of the response.\n\nA \"stripe\" is defined as a contiguous region where the receiver is \"on\" *and* which is located outside the sender band, i.e., where $|x_i| > \\frac{w}{2}$. To count the number of stripes, we first construct a boolean mask for the grid points, which is true if $K_{\\text{on}} \\le A_i \\le K_{\\text{off}}$ and $|x_i| > \\frac{w}{2}$. Then, we count the number of disjoint, contiguous blocks of true values in this mask. This is algorithmically achieved by finding the number of times the mask transitions from false to true along the spatial axis. By padding the mask with an initial false value, this count can be robustly computed by summing the occurrences where the difference between consecutive elements is $1$.\n\nThis procedure is applied to each parameter set provided in the test suite to compute the final integer count of stripes.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D reaction-diffusion problem for biofilm stripe formation\n    for a given set of test cases.\n    \"\"\"\n    # Test cases: (D, mu, L, w, q, K_on, K_off, n_on, n_off)\n    test_cases = [\n        (1.0, 1.0, 10.0, 2.0, 1.0, 0.2, 0.6, 2.0, 2.0),\n        (1.0, 1.0, 10.0, 2.0, 0.1, 0.2, 0.6, 2.0, 2.0),\n        (1.0, 1.0, 10.0, 2.0, 1.0, 1.2, 2.0, 2.0, 2.0),\n        (0.5, 1.0, 10.0, 2.0, 1.0, 0.2, 0.6, 2.0, 2.0),\n    ]\n\n    results = []\n    \n    # Numerical parameters specified in the problem\n    N = 2001\n\n    for case in test_cases:\n        D, mu, L, w, q, K_on, K_off, n_on, n_off = case\n\n        # 1. Discretize the domain\n        x = np.linspace(-L, L, N)\n        dx = 2.0 * L / (N - 1.0)\n\n        # 2. Construct the linear system M*A = b\n        M = np.zeros((N, N))\n        \n        # Coefficients from finite difference stencil\n        dx2 = dx * dx\n        alpha_interior = D / dx2\n        alpha_boundary = 2.0 * D / dx2\n        diag_main = -(alpha_boundary + mu)\n\n        # Fill the matrix M\n        # Main diagonal\n        np.fill_diagonal(M, diag_main)\n        \n        # Upper and lower diagonals for interior points\n        np.fill_diagonal(M[1:], alpha_interior, wrap=False)  # Lower diagonal\n        np.fill_diagonal(M[:, 1:], alpha_interior, wrap=False)  # Upper diagonal\n        \n        # Correct boundary condition terms\n        M[0, 1] = alpha_boundary\n        M[N - 1, N - 2] = alpha_boundary\n        \n        # Construct the source vector b\n        s = np.zeros(N)\n        s[np.abs(x) = w / 2.0] = 1.0\n        b = -q * s\n\n        # 3. Solve the linear system for the concentration profile A\n        A = np.linalg.solve(M, b)\n\n        # 4. Determine receiver state and identify stripes\n        # The condition H_on(A) = 1/2 and H_off(A) = 1/2 with tau=1/2\n        # simplifies to K_on = A = K_off.\n        is_on_concentration = (A = K_on)  (A = K_off)\n        \n        # A stripe must be in the receiver-only region\n        is_in_receiver_region = np.abs(x)  w / 2.0\n        \n        # Combine conditions to get the final \"on\" mask for stripes\n        is_stripe_point = is_on_concentration  is_in_receiver_region\n\n        # 5. Count the number of disjoint contiguous segments (stripes)\n        # Pad with False at the beginning to correctly count stripes starting at index 0.\n        padded_mask = np.insert(is_stripe_point, 0, False)\n        # A transition from False to True (0 to 1) marks the start of a stripe.\n        # The number of such transitions is the number of stripes.\n        stripe_starts = np.diff(padded_mask.astype(np.int8)) == 1\n        num_stripes = np.sum(stripe_starts)\n        \n        results.append(num_stripes)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2481788"}]}