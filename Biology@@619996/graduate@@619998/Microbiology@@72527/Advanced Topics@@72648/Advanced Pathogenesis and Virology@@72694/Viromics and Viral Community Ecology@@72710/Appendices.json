{"hands_on_practices": [{"introduction": "To understand the ecological impact of viruses, we must first grasp the fundamental dynamics of their interactions with hosts. Mathematical models provide a powerful framework for this, allowing us to distill complex biological processes into a set of core principles. This exercise [@problem_id:2545274] invites you to analyze a classic Lotka-Volterra-type model for a lytic virus and its host, exploring concepts like logistic growth, mass-action kinetics, and the conditions that permit stable coexistence. Mastering this type of equilibrium analysis is a foundational skill for predicting the long-term behavior of microbial communities.", "problem": "A lytic virus infects a single bacterial host in a well-mixed batch microcosm with no immigration. The susceptible host density is denoted by $S(t)$ (cells mL$^{-1}$) and the free virus density by $V(t)$ (particles mL$^{-1}$). Assume the following processes, each grounded in standard population ecology and infection kinetics:\n\n- Host cells reproduce logistically due to finite resources with intrinsic rate $r$ (time$^{-1}$) and carrying capacity $K$ (cells mL$^{-1}$).\n- Virus adsorption to hosts follows mass-action with adsorption rate constant $\\phi$ (mL particle$^{-1}$ time$^{-1}$), instantly removing infected host cells from the susceptible pool.\n- Each successful infection yields, after a short latent period negligible at the population timescale considered, an average burst of $\\beta$ new free virions (dimensionless).\n- Free virions are lost at per-capita rate $m$ (time$^{-1}$) due to decay and irreversible loss processes.\n\nUnder these assumptions, the host-virus dynamics are modeled by the system\n$$\n\\dot{S} \\;=\\; r\\,S\\!\\left(1-\\frac{S}{K}\\right) \\;-\\; \\phi\\,S\\,V,\\qquad\n\\dot{V} \\;=\\; \\beta\\,\\phi\\,S\\,V \\;-\\; m\\,V,\n$$\nwith initial conditions $S(0)\\ge 0$, $V(0)\\ge 0$, and parameters $r>0$, $K>0$, $\\phi>0$, $\\beta>0$, $m>0$.\n\nStarting from the definitions of logistic growth, mass-action infection, burst production, and virion loss, do the following:\n\n1. Derive all biologically feasible equilibria $(S^{\\ast},V^{\\ast})$ with $S^{\\ast}\\ge 0$ and $V^{\\ast}\\ge 0$.\n2. Identify the explicit coexistence equilibrium $(S^{\\ast},V^{\\ast})$ with $S^{\\ast}>0$ and $V^{\\ast}>0$, and determine the parameter regime under which this equilibrium exists.\n3. Using linearization and invasion reasoning grounded in the Jacobian of the system, justify which parameter regime yields coexistence versus viral extinction.\n\nYour final submitted answer must be a single closed-form symbolic expression for the coexistence host density $S^{\\ast}$ in terms of $r$, $K$, $\\phi$, $\\beta$, and $m$. Do not include units in your boxed final answer. Host density $S$ is measured in cells mL$^{-1}$, but only the symbolic expression is to be submitted.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Susceptible host density: $S(t)$ (cells mL$^{-1}$)\n- Free virus density: $V(t)$ (particles mL$^{-1}$)\n- Host intrinsic growth rate: $r > 0$ (time$^{-1}$)\n- Host carrying capacity: $K > 0$ (cells mL$^{-1}$)\n- Virus adsorption rate constant: $\\phi > 0$ (mL particle$^{-1}$ time$^{-1}$)\n- Viral burst size: $\\beta > 0$ (dimensionless)\n- Virion loss rate: $m > 0$ (time$^{-1}$)\n- System of differential equations:\n$$\n\\dot{S} \\;=\\; r\\,S\\!\\left(1-\\frac{S}{K}\\right) \\;-\\; \\phi\\,S\\,V\n$$\n$$\n\\dot{V} \\;=\\; \\beta\\,\\phi\\,S\\,V \\;-\\; m\\,V\n$$\n- Initial conditions: $S(0) \\ge 0$, $V(0) \\ge 0$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The model is a standard predator-prey system with logistic growth for the prey (hosts) and a linear functional response for the predator (viruses). This is a foundational model in mathematical ecology and virology. All assumptions (mass-action, logistic growth) are standard and scientifically sound for modeling such systems at the population level. The problem is firmly based on established principles.\n- **Well-Posed:** The problem is well-posed. It asks for the equilibria and stability analysis of a well-defined system of ordinary differential equations. The existence and uniqueness of solutions are guaranteed under these conditions.\n- **Objective:** The problem is stated in precise mathematical language, free of subjective or ambiguous terminology.\n\n- **Flaw Checklist:**\n  1.  **Scientific or Factual Unsoundness:** None. The model is a correct representation of the stated ecological processes.\n  2.  **Non-Formalizable or Irrelevant:** None. The problem is a formal mathematical exercise directly relevant to the topic of viral ecology.\n  3.  **Incomplete or Contradictory Setup:** None. All parameters and equations are provided and are mutually consistent.\n  4.  **Unrealistic or Infeasible:** None. The assumptions are standard simplifications and do not violate physical laws.\n  5.  **Ill-Posed or Poorly Structured:** None. The problem has a clear structure and a well-defined path to a unique answer.\n  6.  **Pseudo-Profound, Trivial, or Tautological:** None. The analysis requires correct application of dynamical systems theory and is not trivial.\n  7.  **Outside Scientific Verifiability:** None. The model is verifiable and falsifiable in principle.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A rigorous solution will be provided.\n\n**Solution Derivation**\n\nThe problem requires a systematic analysis of the provided host-virus dynamical system. We seek the equilibrium points and the conditions for their existence and stability.\n\n**1. Derivation of Equilibria**\n\nAn equilibrium point $(S^{\\ast}, V^{\\ast})$ is a state where the population densities do not change over time, meaning $\\dot{S} = 0$ and $\\dot{V} = 0$. The system of equations for the equilibria is:\n$$\nrS^{\\ast}\\left(1 - \\frac{S^{\\ast}}{K}\\right) - \\phi S^{\\ast}V^{\\ast} = 0 \\label{eq:1}\\tag{1}\n$$\n$$\n\\beta\\phi S^{\\ast}V^{\\ast} - mV^{\\ast} = 0 \\label{eq:2}\\tag{2}\n$$\nWe can factor these equations to analyze the conditions:\n$$\nS^{\\ast} \\left[ r\\left(1 - \\frac{S^{\\ast}}{K}\\right) - \\phi V^{\\ast} \\right] = 0 \\label{eq:3}\\tag{3}\n$$\n$$\nV^{\\ast} (\\beta\\phi S^{\\ast} - m) = 0 \\label{eq:4}\\tag{4}\n$$\nFrom equation $(\\ref{eq:4})$, we have two possibilities for an equilibrium: either $V^{\\ast} = 0$ or $\\beta\\phi S^{\\ast} - m = 0$.\n\n**Case 1: Virus-free equilibrium ($V^{\\ast} = 0$)**\nSubstituting $V^{\\ast}=0$ into equation $(\\ref{eq:3})$ yields:\n$$\nS^{\\ast} \\left[ r\\left(1 - \\frac{S^{\\ast}}{K}\\right) \\right] = 0\n$$\nThis gives two possible solutions for $S^{\\ast}$: either $S^{\\ast}=0$ or $r(1 - S^{\\ast}/K) = 0$, which implies $S^{\\ast}=K$ (since $r>0$).\nThis case yields two biologically feasible equilibria:\n- The **trivial equilibrium**: $(S^{\\ast}, V^{\\ast}) = (0, 0)$. This represents the extinction of both populations.\n- The **virus-free equilibrium**: $(S^{\\ast}, V^{\\ast}) = (K, 0)$. This represents the host population at its carrying capacity in the absence of the virus.\n\n**Case 2: Coexistence equilibrium ($V^{\\ast} > 0$)**\nFor $V^{\\ast}$ to be nonzero, the second factor in equation $(\\ref{eq:4})$ must be zero:\n$$\n\\beta\\phi S^{\\ast} - m = 0\n$$\nSolving for $S^{\\ast}$, we obtain the host density at the coexistence equilibrium:\n$$\nS^{\\ast} = \\frac{m}{\\beta\\phi}\n$$\nSince all parameters $m$, $\\beta$, and $\\phi$ are defined as positive, $S^{\\ast}$ is always positive. We can substitute this value of $S^{\\ast}$ into equation $(\\ref{eq:3})$. Since we assume coexistence, we must have $S^{\\ast} > 0$, so we can divide by $S^{\\ast}$:\n$$\nr\\left(1 - \\frac{S^{\\ast}}{K}\\right) - \\phi V^{\\ast} = 0\n$$\nNow, we solve for the virus density $V^{\\ast}$:\n$$\n\\phi V^{\\ast} = r\\left(1 - \\frac{S^{\\ast}}{K}\\right)\n$$\n$$\nV^{\\ast} = \\frac{r}{\\phi}\\left(1 - \\frac{S^{\\ast}}{K}\\right)\n$$\nSubstituting the expression for $S^{\\ast} = m/(\\beta\\phi)$:\n$$\nV^{\\ast} = \\frac{r}{\\phi}\\left(1 - \\frac{m}{\\beta\\phi K}\\right)\n$$\nThus, the **coexistence equilibrium** is $(S^{\\ast}, V^{\\ast}) = \\left(\\frac{m}{\\beta\\phi}, \\frac{r}{\\phi}\\left(1 - \\frac{m}{\\beta\\phi K}\\right)\\right)$.\n\n**2. Existence Condition for the Coexistence Equilibrium**\n\nFor this coexistence equilibrium to be biologically feasible, both densities must be positive: $S^{\\ast} > 0$ and $V^{\\ast} > 0$.\n- The condition $S^{\\ast} = m/(\\beta\\phi) > 0$ is always met since $m, \\beta, \\phi > 0$.\n- The condition $V^{\\ast} > 0$ requires that:\n$$\n\\frac{r}{\\phi}\\left(1 - \\frac{m}{\\beta\\phi K}\\right) > 0\n$$\nSince $r > 0$ and $\\phi > 0$, this simplifies to:\n$$\n1 - \\frac{m}{\\beta\\phi K} > 0\n$$\n$$\n1 > \\frac{m}{\\beta\\phi K}\n$$\n$$\n\\beta\\phi K > m\n$$\nThis inequality is the necessary and sufficient condition for the existence of the coexistence equilibrium.\n\n**3. Justification via Linearization and Invasion Analysis**\n\nThe transition from viral extinction to coexistence is determined by the stability of the virus-free equilibrium $(K, 0)$. A virus population can establish itself in the host population (i.e., coexist) if and only if it can invade a stable, uninfected host population at its carrying capacity. This corresponds to the virus-free equilibrium $(K, 0)$ being unstable to the introduction of the virus.\n\nWe analyze the stability by linearizing the system around the equilibrium $(K, 0)$. The Jacobian matrix of the system is:\n$$\nJ(S, V) = \\begin{pmatrix} \\frac{\\partial \\dot{S}}{\\partial S} & \\frac{\\partial \\dot{S}}{\\partial V} \\\\ \\frac{\\partial \\dot{V}}{\\partial S} & \\frac{\\partial \\dot{V}}{\\partial V} \\end{pmatrix} = \\begin{pmatrix} r - \\frac{2rS}{K} - \\phi V & -\\phi S \\\\ \\beta\\phi V & \\beta\\phi S - m \\end{pmatrix}\n$$\nEvaluating this matrix at the virus-free equilibrium $(S^{\\ast}, V^{\\ast}) = (K, 0)$:\n$$\nJ(K, 0) = \\begin{pmatrix} r - \\frac{2rK}{K} - \\phi(0) & -\\phi K \\\\ \\beta\\phi (0) & \\beta\\phi K - m \\end{pmatrix} = \\begin{pmatrix} -r & -\\phi K \\\\ 0 & \\beta\\phi K - m \\end{pmatrix}\n$$\nThis is an upper triangular matrix, so its eigenvalues are the diagonal entries:\n$$\n\\lambda_1 = -r\n$$\n$$\n\\lambda_2 = \\beta\\phi K - m\n$$\nFor the equilibrium $(K, 0)$ to be stable, all eigenvalues must have negative real parts.\n- $\\lambda_1 = -r$ is always negative, since $r > 0$. This indicates that the host population is stable at its carrying capacity in the S-direction (in the absence of V).\n- The stability with respect to the introduction of viruses depends on the sign of $\\lambda_2$.\n\nIf $\\lambda_2 < 0$, i.e., $\\beta\\phi K - m < 0 \\iff \\beta\\phi K < m$, then both eigenvalues are negative. The equilibrium $(K, 0)$ is stable. Any small introduction of viruses will decay to zero. This is the **viral extinction** regime.\n\nIf $\\lambda_2 > 0$, i.e., $\\beta\\phi K - m > 0 \\iff \\beta\\phi K > m$, then one eigenvalue is positive. The equilibrium $(K, 0)$ is a saddle point and is unstable. A small introduction of viruses will lead to exponential growth of the virus population, causing the system to move away from the virus-free state. This is the condition for a successful viral invasion, which leads to the **coexistence** state.\n\nThis stability analysis confirms that the parameter regime for coexistence is precisely $\\beta\\phi K > m$, which is the same condition derived for the biological feasibility ($V^{\\ast} > 0$) of the coexistence equilibrium.\n\nThe problem asks for the symbolic expression for the coexistence host density $S^{\\ast}$. From our derivation in part 1:\n$$\nS^{\\ast} = \\frac{m}{\\beta\\phi}\n$$\nThis expression gives the host density required to sustain a stable virus population.", "answer": "$$\\boxed{\\frac{m}{\\beta\\phi}}$$", "id": "2545274"}, {"introduction": "While theoretical models describe idealized systems, real-world viromics requires grappling with the imperfections of experimental data. A common challenge is the presence of contaminating host DNA in a viral metagenome, which can bias downstream analyses if not properly accounted for. This practice [@problem_id:2545298] challenges you to build a probabilistic model of a host-depletion workflow, using the concepts of true positive rate ($\\rho$) and false positive rate ($\\alpha$) to derive the expected amount of residual contamination. This exercise is vital for developing a rigorous, quantitative intuition for quality control in bioinformatics and for appreciating how experimental parameters influence data integrity.", "problem": "In a viral metagenomics (viromics) host-depletion workflow, sequencing reads from a mixed community contain a nonzero fraction of host-derived reads. Suppose a library contains a total of $N$ reads, of which a true fraction $p \\in (0,1)$ are host-derived and a true fraction $1-p$ are non-host (viral or microbial) reads. A host reference mapping step has true positive rate (TPR) $\\rho \\in (0,1)$ for host reads, meaning each true host read is removed independently with probability $\\rho$ and retained with probability $1-\\rho$. The classifier also exhibits a false positive rate (FPR) $\\alpha \\in (0,1)$ on non-host reads, meaning each non-host read is removed independently with probability $\\alpha$ and retained with probability $1-\\alpha$. Assume read-level outcomes are independent given $(p,\\rho,\\alpha)$, and that all parameters are fixed across replicate libraries prepared under identical conditions.\n\nDefine $H_{\\mathrm{res}}$ as the number of residual true host reads after removal and $V_{\\mathrm{res}}$ as the number of residual non-host reads after removal. The residual host proportion among retained reads is\n$$\nR \\equiv \\frac{H_{\\mathrm{res}}}{H_{\\mathrm{res}}+V_{\\mathrm{res}}}\n$$\nwhenever $H_{\\mathrm{res}}+V_{\\mathrm{res}} \\geq 1$; assume $N$ is sufficiently large that the event $H_{\\mathrm{res}}+V_{\\mathrm{res}}=0$ is negligible.\n\nStarting only from probabilistic independence of reads and the definitions of TPR and FPR, derive from first principles:\n\n- the expected residual host proportion $\\mathbb{E}[R]$ as a closed-form expression in terms of $p$, $\\rho$, and $\\alpha$;\n- the leading-order (large $N$) asymptotic variance $\\operatorname{Var}(R)$ across replicate libraries, as a closed-form expression in terms of $N$, $p$, $\\rho$, and $\\alpha$.\n\nProvide your final answer as a row matrix containing, in order, the expression for $\\mathbb{E}[R]$ and the expression for $\\operatorname{Var}(R)$. No numerical evaluation is required, and no units are needed.", "solution": "The problem is subjected to validation and is determined to be a valid, well-posed problem in applied probability theory. It is scientifically grounded in the context of viral metagenomics, is objective, and contains sufficient information for a unique solution. We may proceed with the derivation.\n\nThe problem asks for the expected value and asymptotic variance of the residual host proportion, $R$, defined as $R = \\frac{H_{\\mathrm{res}}}{H_{\\mathrm{res}}+V_{\\mathrm{res}}}$, where $H_{\\mathrm{res}}$ is the number of residual true host reads and $V_{\\mathrm{res}}$ is the number of residual non-host reads after a filtering step.\n\nLet us begin by formalizing the probabilistic model. The total number of initial sequencing reads is $N$. Each read is processed independently. For any single read, we can classify its origin and its fate after the filtering step.\n\nA read is a true host read with probability $p$. Given it is a host read, it is retained with probability $1-\\rho$. Therefore, the unconditional probability that a randomly selected read is a host read and is retained is $p_H = p(1-\\rho)$.\n\nA read is a true non-host read with probability $1-p$. Given it is a non-host read, it is retained with probability $1-\\alpha$. Therefore, the unconditional probability that a randomly selected read is a non-host read and is retained is $p_V = (1-p)(1-\\alpha)$.\n\nLet $H_{\\mathrm{res}}$ be the number of retained host reads and $V_{\\mathrm{res}}$ be the number of retained non-host reads. Let $N_{\\mathrm{rem}}$ be the number of removed reads. The counts $(H_{\\mathrm{res}}, V_{\\mathrm{res}}, N_{\\mathrm{rem}})$ for the $N$ independent reads follow a multinomial distribution:\n$$\n(H_{\\mathrm{res}}, V_{\\mathrm{res}}, N_{\\mathrm{rem}}) \\sim \\text{Multinomial}(N; p_H, p_V, 1 - p_H - p_V)\n$$\nThe total number of retained reads is $N_{\\mathrm{res}} = H_{\\mathrm{res}} + V_{\\mathrm{res}}$. The random variable $N_{\\mathrm{res}}$ follows a binomial distribution, as it is the sum of counts of two categories from a multinomial distribution. The probability of any given read being retained is $p_{\\mathrm{ret}} = p_H + p_V$. Thus,\n$$\nN_{\\mathrm{res}} \\sim \\text{Binomial}(N, p_{\\mathrm{ret}})\n$$\nwhere $p_{\\mathrm{ret}} = p(1-\\rho) + (1-p)(1-\\alpha)$.\n\nFirst, we derive the expected residual host proportion, $\\mathbb{E}[R]$. We are interested in $\\mathbb{E}\\left[\\frac{H_{\\mathrm{res}}}{H_{\\mathrm{res}}+V_{\\mathrm{res}}}\\right] = \\mathbb{E}\\left[\\frac{H_{\\mathrm{res}}}{N_{\\mathrm{res}}}\\right]$. We utilize the law of total expectation: $\\mathbb{E}[R] = \\mathbb{E}[\\mathbb{E}[R | N_{\\mathrm{res}}]]$.\n\nConsider the conditional distribution of $H_{\\mathrm{res}}$ given the total number of retained reads, $N_{\\mathrm{res}}$. Let $N_{\\mathrm{res}} = n_{\\mathrm{res}}$, where $n_{\\mathrm{res}} \\ge 1$. For each of these $n_{\\mathrm{res}}$ retained reads, we can find the conditional probability that it is a host read. This is given by Bayes' theorem:\n$$\n\\pi \\equiv P(\\text{read is host} | \\text{read is retained}) = \\frac{P(\\text{host and retained})}{P(\\text{retained})} = \\frac{p_H}{p_H+p_V}\n$$\nGiven $N_{\\mathrm{res}} = n_{\\mathrm{res}}$, the number of host reads among them, $H_{\\mathrm{res}}$, is the number of \"successes\" in $n_{\\mathrm{res}}$ independent Bernoulli trials, where a success is \"the retained read is host\" with probability $\\pi$. Therefore, the conditional distribution of $H_{\\mathrm{res}}$ is binomial:\n$$\nH_{\\mathrm{res}} | N_{\\mathrm{res}} = n_{\\mathrm{res}} \\sim \\text{Binomial}(n_{\\mathrm{res}}, \\pi)\n$$\nThe conditional expectation of the ratio $R$ is then:\n$$\n\\mathbb{E}[R | N_{\\mathrm{res}} = n_{\\mathrm{res}}] = \\mathbb{E}\\left[\\frac{H_{\\mathrm{res}}}{n_{\\mathrm{res}}} | N_{\\mathrm{res}} = n_{\\mathrm{res}}\\right] = \\frac{1}{n_{\\mathrm{res}}} \\mathbb{E}[H_{\\mathrm{res}} | N_{\\mathrm{res}} = n_{\\mathrm{res}}] = \\frac{n_{\\mathrm{res}}\\pi}{n_{\\mathrm{res}}} = \\pi\n$$\nThis result is valid for any $n_{\\mathrm{res}} \\ge 1$. Since the problem statement allows us to neglect the event $N_{\\mathrm{res}}=0$, we can state that $\\mathbb{E}[R|N_{\\mathrm{res}}] = \\pi$.\nNow, applying the law of total expectation:\n$$\n\\mathbb{E}[R] = \\mathbb{E}[\\mathbb{E}[R | N_{\\mathrm{res}}]] = \\mathbb{E}[\\pi] = \\pi\n$$\nsince $\\pi$ is a constant determined by the parameters $p, \\rho, \\alpha$. Substituting the expressions for $p_H$ and $p_V$:\n$$\n\\mathbb{E}[R] = \\frac{p(1-\\rho)}{p(1-\\rho) + (1-p)(1-\\alpha)}\n$$\nThis is the exact expression for the expected residual host proportion.\n\nSecond, we derive the leading-order asymptotic variance, $\\operatorname{Var}(R)$, for large $N$. We use the law of total variance:\n$$\n\\operatorname{Var}(R) = \\mathbb{E}[\\operatorname{Var}(R | N_{\\mathrm{res}})] + \\operatorname{Var}(\\mathbb{E}[R | N_{\\mathrm{res}}])\n$$\nWe have already shown that $\\mathbb{E}[R | N_{\\mathrm{res}}] = \\pi$, which is a constant. The variance of a constant is zero, so $\\operatorname{Var}(\\mathbb{E}[R | N_{\\mathrm{res}}]) = 0$. The expression simplifies to:\n$$\n\\operatorname{Var}(R) = \\mathbb{E}[\\operatorname{Var}(R | N_{\\mathrm{res}})]\n$$\nThe conditional variance of $R$ is:\n$$\n\\operatorname{Var}(R | N_{\\mathrm{res}} = n_{\\mathrm{res}}) = \\operatorname{Var}\\left(\\frac{H_{\\mathrm{res}}}{n_{\\mathrm{res}}} | N_{\\mathrm{res}} = n_{\\mathrm{res}}\\right) = \\frac{1}{n_{\\mathrm{res}}^2} \\operatorname{Var}(H_{\\mathrm{res}} | N_{\\mathrm{res}} = n_{\\mathrm{res}})\n$$\nUsing the variance of a binomial distribution, $\\operatorname{Var}(X) = n'p'(1-p')$:\n$$\n\\operatorname{Var}(H_{\\mathrm{res}} | N_{\\mathrm{res}} = n_{\\mathrm{res}}) = n_{\\mathrm{res}}\\pi(1-\\pi)\n$$\nSo, the conditional variance of $R$ is:\n$$\n\\operatorname{Var}(R | N_{\\mathrm{res}} = n_{\\mathrm{res}}) = \\frac{n_{\\mathrm{res}}\\pi(1-\\pi)}{n_{\\mathrm{res}}^2} = \\frac{\\pi(1-\\pi)}{n_{\\mathrm{res}}}\n$$\nNow, we must take the expectation of this quantity over the distribution of $N_{\\mathrm{res}}$:\n$$\n\\operatorname{Var}(R) = \\mathbb{E}\\left[\\frac{\\pi(1-\\pi)}{N_{\\mathrm{res}}}\\right] = \\pi(1-\\pi) \\mathbb{E}\\left[\\frac{1}{N_{\\mathrm{res}}}\\right]\n$$\nTo find the leading-order term for large $N$, we need an approximation for $\\mathbb{E}[1/N_{\\mathrm{res}}]$. The random variable $N_{\\mathrm{res}} \\sim \\text{Binomial}(N, p_{\\mathrm{ret}})$ has mean $\\mathbb{E}[N_{\\mathrm{res}}] = N p_{\\mathrm{ret}}$. For large $N$, $N_{\\mathrm{res}}$ is concentrated around its mean. A Taylor expansion of $f(x)=1/x$ around $\\mu = \\mathbb{E}[N_{\\mathrm{res}}]$ yields $\\mathbb{E}[1/N_{\\mathrm{res}}] \\approx 1/\\mu + \\mathcal{O}(N^{-2})$. The leading-order term is sufficient for the asymptotic variance:\n$$\n\\mathbb{E}\\left[\\frac{1}{N_{\\mathrm{res}}}\\right] \\approx \\frac{1}{\\mathbb{E}[N_{\\mathrm{res}}]} = \\frac{1}{N p_{\\mathrm{ret}}}\n$$\nSubstituting this into the expression for variance:\n$$\n\\operatorname{Var}(R) \\approx \\pi(1-\\pi) \\frac{1}{N p_{\\mathrm{ret}}}\n$$\nNow, we substitute the expressions for $\\pi$, $1-\\pi$, and $p_{\\mathrm{ret}}$:\n$$\n\\pi = \\frac{p(1-\\rho)}{p_{\\mathrm{ret}}} \\quad \\text{and} \\quad 1-\\pi = \\frac{(1-p)(1-\\alpha)}{p_{\\mathrm{ret}}}\n$$\n$$\n\\operatorname{Var}(R) \\approx \\frac{1}{N p_{\\mathrm{ret}}} \\left(\\frac{p(1-\\rho)}{p_{\\mathrm{ret}}}\\right) \\left(\\frac{(1-p)(1-\\alpha)}{p_{\\mathrm{ret}}}\\right) = \\frac{p(1-p)(1-\\rho)(1-\\alpha)}{N p_{\\mathrm{ret}}^3}\n$$\nFinally, substituting $p_{\\mathrm{ret}} = p(1-\\rho) + (1-p)(1-\\alpha)$:\n$$\n\\operatorname{Var}(R) \\approx \\frac{p(1-p)(1-\\rho)(1-\\alpha)}{N \\left(p(1-\\rho) + (1-p)(1-\\alpha)\\right)^3}\n$$\nThis is the required leading-order asymptotic variance.\n\nThe two requested expressions are collected.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{p(1-\\rho)}{p(1-\\rho) + (1-p)(1-\\alpha)} & \\frac{p(1-p)(1-\\rho)(1-\\alpha)}{N (p(1-\\rho) + (1-p)(1-\\alpha))^{3}} \\end{pmatrix}}\n$$", "id": "2545298"}, {"introduction": "After collecting and cleaning sequencing data, the final step is to analyze the viral community structure, often by comparing samples. Viral community profiles from sequencing are inherently compositional, meaning the data represents relative, not absolute, abundances, which makes many standard statistical methods inappropriate. This hands-on problem [@problem_id:2545257] introduces the correct framework for this challenge, guiding you through the centered log-ratio (clr) transformation to properly calculate the distance between two communities. Engaging with this practice will equip you with the essential tools of compositional data analysis, ensuring your ecological conclusions are statistically robust and meaningful.", "problem": "A marine viromics study profiles viral community composition from two seawater samples collected at different depths. Sequencing read counts assigned to five viral families are reported. Because gene-centric counts are compositional, they carry only relative information constrained by a constant-sum operation. To perform ordination that respects compositional geometry, you must transform the data into a Euclidean space using the centered log-ratio (clr) transformation and interpret the resulting distances.\n\nUsing only foundational principles of compositional data analysis and without invoking ad hoc normalizations, apply the centered log-ratio (clr) transformation to each sample and compute the Euclidean distance between the two clr-transformed samples (the Aitchison distance). Use the natural logarithm. Then, interpret this distance as the aggregate discrepancy in log-ratios relevant for ordination by Principal Component Analysis (PCA). Report only the numerical value of the clr-space Euclidean distance.\n\nData (read counts):\n- Sample A: Myoviridae $=$ $1200$, Podoviridae $=$ $300$, Siphoviridae $=$ $150$, Microviridae $=$ $90$, Mimiviridae $=$ $60$.\n- Sample B: Myoviridae $=$ $800$, Podoviridae $=$ $600$, Siphoviridae $=$ $100$, Microviridae $=$ $80$, Mimiviridae $=$ $20$.\n\nCompute the Euclidean distance in clr space between Sample A and Sample B using the natural logarithm, and provide your final answer rounded to $4$ significant figures. Do not include units.", "solution": "The problem requires the computation of the Aitchison distance between two viral community compositions, represented as vectors of read counts. This distance is defined as the Euclidean distance between the centered log-ratio (clr) transformed compositions. The problem is well-posed and scientifically sound, as compositional data analysis is the correct framework for this type of data.\n\nLet the compositions for Sample A and Sample B be denoted by the vectors $\\mathbf{x}$ and $\\mathbf{y}$, respectively. Each composition has $D=5$ parts, corresponding to the five viral families.\nThe given data are:\n$$ \\mathbf{x} = (x_1, x_2, x_3, x_4, x_5) = (1200, 300, 150, 90, 60) $$\n$$ \\mathbf{y} = (y_1, y_2, y_3, y_4, y_5) = (800, 600, 100, 80, 20) $$\n\nThe centered log-ratio (clr) transformation maps a composition $\\mathbf{z} = (z_1, \\dots, z_D)$ from the simplex to a $D$-dimensional real vector space. The $i$-th component of the transformed vector, $\\text{clr}(\\mathbf{z})$, is given by:\n$$ \\text{clr}(\\mathbf{z})_i = \\ln\\left(\\frac{z_i}{g(\\mathbf{z})}\\right) = \\ln(z_i) - \\ln(g(\\mathbf{z})) $$\nwhere $g(\\mathbf{z})$ is the geometric mean of the components of $\\mathbf{z}$:\n$$ g(\\mathbf{z}) = \\left( \\prod_{j=1}^{D} z_j \\right)^{1/D} $$\nThe term $\\ln(g(\\mathbf{z}))$ can be computed as the arithmetic mean of the log-transformed components:\n$$ \\ln(g(\\mathbf{z})) = \\frac{1}{D} \\sum_{j=1}^{D} \\ln(z_j) $$\n\nFirst, we compute the clr transformation for Sample A ($\\mathbf{x}$).\nThe log-transformed components are:\n$$ \\ln(x_1) = \\ln(1200) \\approx 7.090077 $$\n$$ \\ln(x_2) = \\ln(300) \\approx 5.703782 $$\n$$ \\ln(x_3) = \\ln(150) \\approx 5.010635 $$\n$$ \\ln(x_4) = \\ln(90) \\approx 4.499810 $$\n$$ \\ln(x_5) = \\ln(60) \\approx 4.094345 $$\nThe mean of these log-values is:\n$$ \\ln(g(\\mathbf{x})) = \\frac{1}{5} (7.090077 + 5.703782 + 5.010635 + 4.499810 + 4.094345) \\approx \\frac{26.398649}{5} \\approx 5.279730 $$\nThe clr-transformed vector $\\text{clr}(\\mathbf{x})$ is:\n$$ \\text{clr}(\\mathbf{x})_1 = 7.090077 - 5.279730 = 1.810347 $$\n$$ \\text{clr}(\\mathbf{x})_2 = 5.703782 - 5.279730 = 0.424052 $$\n$$ \\text{clr}(\\mathbf{x})_3 = 5.010635 - 5.279730 = -0.269095 $$\n$$ \\text{clr}(\\mathbf{x})_4 = 4.499810 - 5.279730 = -0.779920 $$\n$$ \\text{clr}(\\mathbf{x})_5 = 4.094345 - 5.279730 = -1.185385 $$\n\nNext, we compute the clr transformation for Sample B ($\\mathbf{y}$).\nThe log-transformed components are:\n$$ \\ln(y_1) = \\ln(800) \\approx 6.684612 $$\n$$ \\ln(y_2) = \\ln(600) \\approx 6.396930 $$\n$$ \\ln(y_3) = \\ln(100) \\approx 4.605170 $$\n$$ \\ln(y_4) = \\ln(80) \\approx 4.382027 $$\n$$ \\ln(y_5) = \\ln(20) \\approx 2.995732 $$\nThe mean of these log-values is:\n$$ \\ln(g(\\mathbf{y})) = \\frac{1}{5} (6.684612 + 6.396930 + 4.605170 + 4.382027 + 2.995732) \\approx \\frac{25.064471}{5} \\approx 5.012894 $$\nThe clr-transformed vector $\\text{clr}(\\mathbf{y})$ is:\n$$ \\text{clr}(\\mathbf{y})_1 = 6.684612 - 5.012894 = 1.671718 $$\n$$ \\text{clr}(\\mathbf{y})_2 = 6.396930 - 5.012894 = 1.384036 $$\n$$ \\text{clr}(\\mathbf{y})_3 = 4.605170 - 5.012894 = -0.407724 $$\n$$ \\text{clr}(\\mathbf{y})_4 = 4.382027 - 5.012894 = -0.630867 $$\n$$ \\text{clr}(\\mathbf{y})_5 = 2.995732 - 5.012894 = -2.017162 $$\n\nThe Aitchison distance, $d_A(\\mathbf{x}, \\mathbf{y})$, is the Euclidean distance between $\\text{clr}(\\mathbf{x})$ and $\\text{clr}(\\mathbf{y})$:\n$$ d_A(\\mathbf{x}, \\mathbf{y}) = \\sqrt{ \\sum_{i=1}^{D} (\\text{clr}(\\mathbf{x})_i - \\text{clr}(\\mathbf{y})_i)^2 } $$\nWe compute the squared differences for each component:\n$$ (1.810347 - 1.671718)^2 = (0.138629)^2 \\approx 0.019218 $$\n$$ (0.424052 - 1.384036)^2 = (-0.959984)^2 \\approx 0.921569 $$\n$$ (-0.269095 - (-0.407724))^2 = (0.138629)^2 \\approx 0.019218 $$\n$$ (-0.779920 - (-0.630867))^2 = (-0.149053)^2 \\approx 0.022217 $$\n$$ (-1.185385 - (-2.017162))^2 = (0.831777)^2 \\approx 0.691853 $$\nThe sum of these squared differences is:\n$$ d_A(\\mathbf{x}, \\mathbf{y})^2 \\approx 0.019218 + 0.921569 + 0.019218 + 0.022217 + 0.691853 = 1.674075 $$\nThe Aitchison distance is the square root of this sum:\n$$ d_A(\\mathbf{x}, \\mathbf{y}) = \\sqrt{1.674075} \\approx 1.2938599 $$\nThis distance is a single-value summary of the total dissimilarity between the relative abundance structures of the two viral communities. In the context of Principal Component Analysis (PCA) on clr-transformed data, this distance represents the separation of the two samples in the full Euclidean space, the variance of which is partitioned by the principal components. A larger distance indicates a greater overall difference in the log-ratios of component abundances, signifying more substantial compositional change between the samples.\n\nRounding the result to $4$ significant figures provides the final answer.\n$$ 1.2938599 \\approx 1.294 $$", "answer": "$$\\boxed{1.294}$$", "id": "2545257"}]}