{"hands_on_practices": [{"introduction": "A key advantage of messenger RNA (mRNA) vaccines is their ability to act as a transient factory for antigen production directly within our cells. To rationally design and optimize these vaccines, it is crucial to model the dynamics of this process. This practice challenges you to apply principles of chemical kinetics to build a two-compartment model describing mRNA decay and subsequent protein translation, allowing you to predict how antigen levels change over time and when they reach their peak concentration [@problem_id:2469082]. Mastering this quantitative approach is fundamental for understanding the relationship between mRNA stability, translation efficiency, and the resulting magnitude and duration of the immune response.", "problem": "A lipid nanoparticle-delivered messenger ribonucleic acid (mRNA) vaccine encodes a subunit antigen that is translated in the cytosol and then degraded. Assume the intracellular mRNA amount is $M(t)$ and the intracellular antigen (protein) amount is $P(t)$. Starting from the central dogma of molecular biology (templated translation of mRNA to protein) and first-order kinetics for both mRNA decay and protein decay, construct a minimal two-compartment expression model in which mRNA decays with a first-order rate constant $k_m$, protein is translated from mRNA with a rate constant $k_t$ proportional to $M(t)$, and protein decays with a first-order rate constant $k_p$. Use this model to derive an analytic expression for $P(t)$ with initial conditions $M(0)=M_0$ and $P(0)=0$, assuming $k_m \\neq k_p$. Then, using the derived $P(t)$, determine the time-to-peak antigen amount (the time $t_{\\mathrm{peak}}$ at which $P(t)$ attains its maximum).\n\nFor a realistic mRNA vaccine scenario, use $M_0=2.0\\times 10^5$ molecules per cell, $k_m=0.35\\ \\mathrm{h}^{-1}$, $k_p=0.05\\ \\mathrm{h}^{-1}$, and $k_t=120\\ \\mathrm{h}^{-1}$. Express your final answer as the numerical value of $t_{\\mathrm{peak}}$ in hours. Round your answer to four significant figures.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Intracellular mRNA amount: $M(t)$\n- Intracellular antigen (protein) amount: $P(t)$\n- mRNA first-order decay rate constant: $k_m$\n- Protein translation rate constant proportional to $M(t)$: $k_t$\n- Protein first-order decay rate constant: $k_p$\n- Initial conditions: $M(0) = M_0$ and $P(0) = 0$\n- Constraint: $k_m \\neq k_p$\n- Specific parameters for numerical calculation: $M_0 = 2.0 \\times 10^{5}$ molecules/cell, $k_m = 0.35 \\ \\mathrm{h}^{-1}$, $k_p = 0.05 \\ \\mathrm{h}^{-1}$, $k_t = 120 \\ \\mathrm{h}^{-1}$.\n- Objectives:\n  1. Derive an analytic expression for $P(t)$.\n  2. Determine the time to peak antigen amount, $t_{\\mathrm{peak}}$.\n  3. Provide a numerical value for $t_{\\mathrm{peak}}$ rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed for validity.\n- **Scientifically Grounded**: The problem describes a simplified kinetic model of gene expression, which is a fundamental concept in molecular biology and pharmacology. The use of first-order kinetics is a standard and appropriate approximation for modeling mRNA and protein turnover. The model is a classic two-compartment system, scientifically sound and realistic.\n- **Well-Posed**: The problem is formulated as a system of linear first-order ordinary differential equations with specified initial conditions. All necessary parameters are provided, and the constraint $k_m \\neq k_p$ ensures a non-degenerate, unique solution. The objectives are clear and mathematically tractable.\n- **Objective**: The problem is stated in precise, quantitative, and objective language, free of ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. It is scientifically grounded, well-posed, and objective. There are no flaws. We proceed to the solution.\n\nThe kinetics of mRNA and protein concentration are described by a system of two coupled ordinary differential equations.\n\nFirst, we establish the equation for the amount of mRNA, $M(t)$. The problem states that mRNA decays with a first-order rate constant $k_m$. This gives the differential equation:\n$$\n\\frac{dM(t)}{dt} = -k_m M(t)\n$$\nThis is a standard exponential decay process. With the initial condition $M(0) = M_0$, the solution is found by separation of variables or by inspection:\n$$\nM(t) = M_0 \\exp(-k_m t)\n$$\nNext, we establish the equation for the amount of protein, $P(t)$. Protein is translated from mRNA at a rate proportional to $M(t)$ with rate constant $k_t$, and it decays with a first-order rate constant $k_p$. The rate of change of $P(t)$ is therefore the rate of production minus the rate of degradation:\n$$\n\\frac{dP(t)}{dt} = k_t M(t) - k_p P(t)\n$$\nSubstitute the expression for $M(t)$ into this equation:\n$$\n\\frac{dP(t)}{dt} = k_t M_0 \\exp(-k_m t) - k_p P(t)\n$$\nThis is a linear first-order ordinary differential equation. We can write it in the standard form $\\frac{dy}{dx} + P(x)y = Q(x)$:\n$$\n\\frac{dP(t)}{dt} + k_p P(t) = k_t M_0 \\exp(-k_m t)\n$$\nTo solve this, we use the method of integrating factors. The integrating factor $I(t)$ is given by:\n$$\nI(t) = \\exp\\left(\\int k_p dt\\right) = \\exp(k_p t)\n$$\nMultiplying the differential equation by $I(t)$ gives:\n$$\n\\exp(k_p t) \\frac{dP(t)}{dt} + k_p \\exp(k_p t) P(t) = k_t M_0 \\exp(-k_m t) \\exp(k_p t)\n$$\nThe left-hand side is the derivative of the product $P(t) I(t)$:\n$$\n\\frac{d}{dt} \\left[ P(t) \\exp(k_p t) \\right] = k_t M_0 \\exp((k_p - k_m)t)\n$$\nWe integrate both sides with respect to time $t$:\n$$\nP(t) \\exp(k_p t) = \\int k_t M_0 \\exp((k_p - k_m)t) dt\n$$\nSince $k_m \\neq k_p$, the term $k_p - k_m$ is non-zero. The integral is:\n$$\nP(t) \\exp(k_p t) = \\frac{k_t M_0}{k_p - k_m} \\exp((k_p - k_m)t) + C\n$$\nwhere $C$ is the constant of integration. To find $P(t)$, we divide by $\\exp(k_p t)$:\n$$\nP(t) = \\frac{k_t M_0}{k_p - k_m} \\exp(-k_m t) + C \\exp(-k_p t)\n$$\nWe apply the initial condition $P(0) = 0$ to determine $C$:\n$$\nP(0) = 0 = \\frac{k_t M_0}{k_p - k_m} \\exp(0) + C \\exp(0)\n$$\n$$\n0 = \\frac{k_t M_0}{k_p - k_m} + C\n$$\n$$\nC = -\\frac{k_t M_0}{k_p - k_m}\n$$\nSubstituting $C$ back into the expression for $P(t)$, we obtain the analytic solution:\n$$\nP(t) = \\frac{k_t M_0}{k_p - k_m} \\exp(-k_m t) - \\frac{k_t M_0}{k_p - k_m} \\exp(-k_p t)\n$$\n$$\nP(t) = \\frac{k_t M_0}{k_p - k_m} \\left( \\exp(-k_m t) - \\exp(-k_p t) \\right)\n$$\nThis is the required analytical expression for the amount of protein over time.\n\nTo find the time at which the antigen amount is at its maximum, $t_{\\mathrm{peak}}$, we must find the time at which the rate of change of $P(t)$ is zero. That is, we set $\\frac{dP(t)}{dt} = 0$.\nFrom the differential equation for $P(t)$, we have:\n$$\n\\frac{dP(t)}{dt} = k_t M(t) - k_p P(t) = k_t M_0 \\exp(-k_m t) - k_p P(t)\n$$\nSetting $\\frac{dP(t)}{dt}=0$ at $t = t_{\\mathrm{peak}}$:\n$$\nk_t M_0 \\exp(-k_m t_{\\mathrm{peak}}) = k_p P(t_{\\mathrm{peak}})\n$$\nSubstitute the expression for $P(t_{\\mathrm{peak}})$:\n$$\nk_t M_0 \\exp(-k_m t_{\\mathrm{peak}}) = k_p \\left[ \\frac{k_t M_0}{k_p - k_m} \\left( \\exp(-k_m t_{\\mathrm{peak}}) - \\exp(-k_p t_{\\mathrm{peak}}) \\right) \\right]\n$$\nWe can cancel the term $k_t M_0$ (since $k_t>0, M_0>0$):\n$$\n\\exp(-k_m t_{\\mathrm{peak}}) = \\frac{k_p}{k_p - k_m} \\left( \\exp(-k_m t_{\\mathrm{peak}}) - \\exp(-k_p t_{\\mathrm{peak}}) \\right)\n$$\n$$\n(k_p - k_m) \\exp(-k_m t_{\\mathrm{peak}}) = k_p \\exp(-k_m t_{\\mathrm{peak}}) - k_p \\exp(-k_p t_{\\mathrm{peak}})\n$$\n$$\nk_p \\exp(-k_m t_{\\mathrm{peak}}) - k_m \\exp(-k_m t_{\\mathrm{peak}}) = k_p \\exp(-k_m t_{\\mathrm{peak}}) - k_p \\exp(-k_p t_{\\mathrm{peak}})\n$$\n$$\n-k_m \\exp(-k_m t_{\\mathrm{peak}}) = -k_p \\exp(-k_p t_{\\mathrm{peak}})\n$$\n$$\nk_m \\exp(-k_m t_{\\mathrm{peak}}) = k_p \\exp(-k_p t_{\\mathrm{peak}})\n$$\nNow, we solve for $t_{\\mathrm{peak}}$:\n$$\n\\frac{k_m}{k_p} = \\frac{\\exp(-k_p t_{\\mathrm{peak}})}{\\exp(-k_m t_{\\mathrm{peak}})} = \\exp((-k_p - (-k_m)) t_{\\mathrm{peak}}) = \\exp((k_m - k_p) t_{\\mathrm{peak}})\n$$\nTake the natural logarithm of both sides:\n$$\n\\ln\\left(\\frac{k_m}{k_p}\\right) = (k_m - k_p) t_{\\mathrm{peak}}\n$$\nFinally, we isolate $t_{\\mathrm{peak}}$:\n$$\nt_{\\mathrm{peak}} = \\frac{\\ln\\left(\\frac{k_m}{k_p}\\right)}{k_m - k_p}\n$$\nThis is the symbolic expression for the time-to-peak.\n\nNow, we substitute the given numerical values: $k_m = 0.35 \\ \\mathrm{h}^{-1}$ and $k_p = 0.05 \\ \\mathrm{h}^{-1}$.\n$$\nt_{\\mathrm{peak}} = \\frac{\\ln\\left(\\frac{0.35}{0.05}\\right)}{0.35 - 0.05} \\ \\mathrm{h}\n$$\n$$\nt_{\\mathrm{peak}} = \\frac{\\ln(7)}{0.30} \\ \\mathrm{h}\n$$\nUsing a calculator for the value of $\\ln(7)$:\n$$\n\\ln(7) \\approx 1.9459101\n$$\n$$\nt_{\\mathrm{peak}} \\approx \\frac{1.9459101}{0.30} \\ \\mathrm{h} \\approx 6.486367 \\ \\mathrm{h}\n$$\nRounding the result to four significant figures, as required by the problem statement:\n$$\nt_{\\mathrm{peak}} \\approx 6.486 \\ \\mathrm{h}\n$$\nThe parameters $M_0$ and $k_t$ affect the magnitude of the peak protein amount, $P(t_{\\mathrm{peak}})$, but they do not influence the time at which this peak occurs, $t_{\\mathrm{peak}}$.", "answer": "$$\n\\boxed{6.486}\n$$", "id": "2469082"}, {"introduction": "Once an antigen is synthesized within a cell, its fate determines the type of immune response it will elicit. The cellular location of the antigen—whether it remains in the cytosol or is directed into the secretory pathway—is a critical design choice that vaccinologists must make. This exercise asks you to analyze the immunological consequences of this decision by applying foundational principles of antigen processing and presentation via Major Histocompatibility Complex (MHC) Class I and Class II pathways [@problem_id:2469000]. By comparing these two scenarios, you will gain a deeper appreciation for how vaccine design directly steers the immune system towards generating cytotoxic $\\text{CD8}^+$ T cell responses versus helper $\\text{CD4}^+$ T cell responses.", "problem": "A research team compares two messenger ribonucleic acid (mRNA) vaccine constructs encoding the same viral glycoprotein antigen. Construct X encodes a cytosolic form of the antigen lacking any signal peptide or transmembrane anchor, so translation occurs on free ribosomes and the protein remains in the cytosol. Construct Y encodes the antigen with an amino-terminal signal peptide that drives co-translational translocation into the endoplasmic reticulum (ER) lumen and secretion; the antigen bears native N-linked glycosylation motifs and is secreted as a soluble protein. Both constructs are formulated in identical ionizable lipid nanoparticles and co-administered with a Toll-like receptor (TLR) agonist to ensure comparable dendritic cell (DC) maturation.\n\nUsing only the following foundational principles:\n- The Central Dogma of Molecular Biology (DNA to RNA to protein), including that secretory pathway proteins bear signal peptides that direct ribosome docking to the ER and co-translational import into the ER lumen, whereas cytosolic proteins are translated on free ribosomes and remain in the cytosol.\n- Major Histocompatibility Complex (MHC) Class I presentation is classically loaded in the ER with peptides generated primarily by cytosolic proteasomes and transported by Transporter Associated with Antigen Processing (TAP); MHC Class I is optimized for presenting endogenously synthesized (intracellular) antigens to cytotoxic Cluster of Differentiation 8 (CD8) T cells.\n- MHC Class II presentation is classically loaded in late endosomes/lysosomes after exogenous antigen uptake and proteolysis; MHC Class II is optimized for presenting extracellular antigens to helper Cluster of Differentiation 4 (CD4) T cells. Cross-presentation denotes the ability of specialized DCs to present exogenous antigens on MHC Class I via cytosolic or vacuolar routes.\n- Endoplasmic reticulum-associated degradation (ERAD) can retrotranslocate some misfolded ER lumenal proteins to the cytosol for proteasomal degradation, potentially feeding the MHC Class I pathway, but this is substrate- and context-dependent.\n- Adjuvants that activate pattern-recognition receptors (for example, TLR agonists) promote DC maturation and can enhance cross-presentation but do not fundamentally change which cellular compartment first receives the newly synthesized antigen.\n\nWhich option best predicts the dominant antigen processing and presentation pathways engaged by the two constructs and, as a consequence, which construct is expected to elicit the stronger primary CD8 T cell response in vivo?\n\nA. Construct X will predominantly undergo proteasomal degradation in the cytosol, feed peptides via TAP into the ER, and be efficiently presented on MHC Class I, with limited direct access to MHC Class II unless released or transferred to other cells; Construct Y will largely enter endolysosomal compartments after secretion and uptake, favoring MHC Class II presentation, with MHC Class I arising mainly through cross-presentation or occasional ERAD. Therefore, Construct X will favor stronger CD8 responses.\n\nB. Both constructs enter the same MHC Class I pathway with equal efficiency because all peptides are ultimately loaded in the ER; CD8 responses will be equivalent, and the presence or absence of a signal peptide has no impact on presentation.\n\nC. Construct Y will outcompete Construct X for MHC Class I because peptides can be loaded directly onto MHC Class I in the ER from the secreted antigen without proteasomal processing or TAP; therefore, Construct Y will generate stronger CD8 responses.\n\nD. Construct X will be poorly presented on MHC Class I because cytosolic proteasomes destroy most epitopes before loading, whereas Construct Y, after secretion and uptake, will be cross-presented so efficiently on MHC Class I by mature DCs that it will surpass direct presentation; therefore, Construct Y will generate stronger CD8 responses.\n\nE. Construct Y will dominate both MHC Class I and MHC Class II because glycosylation in the ER protects epitopes from degradation and enables peptide editing in the ER to favor MHC Class I loading; hence, Construct Y will generate stronger CD8 responses than Construct X regardless of adjuvant choice.", "solution": "The problem statement will be validated before any attempt at a solution.\n\n### Step 1: Extract Givens\n- **Vaccine Constructs:** Two messenger ribonucleic acid (mRNA) constructs, labeled Construct X and Construct Y, encode the same viral glycoprotein antigen.\n- **Construct X:**\n    - Encodes a cytosolic form of the antigen.\n    - Lacks a signal peptide and transmembrane anchor.\n    - Translation occurs on free ribosomes.\n    - Protein product remains in the cytosol.\n- **Construct Y:**\n    - Encodes a secreted form of the antigen.\n    - Contains an amino-terminal signal peptide.\n    - Undergoes co-translational translocation into the endoplasmic reticulum (ER) lumen.\n    - Bears native N-linked glycosylation motifs.\n    - Is secreted as a soluble protein.\n- **Formulation and Adjuvant:**\n    - Both constructs are formulated in identical ionizable lipid nanoparticles.\n    - Both are co-administered with a Toll-like receptor (TLR) agonist.\n    - The adjuvant ensures comparable dendritic cell (DC) maturation.\n- **Foundational Principles:**\n    1.  **Central Dogma & Protein Trafficking:** Secretory proteins possess signal peptides for ER import; cytosolic proteins are translated on free ribosomes and stay in the cytosol.\n    2.  **MHC Class I Pathway:** Loaded in the ER with peptides from cytosolic proteasomal degradation, transported by the Transporter Associated with Antigen Processing (TAP). Optimized for presenting endogenous antigens to cytotoxic Cluster of Differentiation 8 (CD8) T cells.\n    3.  **MHC Class II Pathway:** Loaded in endosomes/lysosomes with peptides from exogenous, endocytosed antigens. Optimized for presenting extracellular antigens to helper Cluster of Differentiation 4 (CD4) T cells. Cross-presentation is the loading of exogenous antigens onto MHC Class I.\n    4.  **ERAD Pathway:** Endoplasmic reticulum-associated degradation can retrotranslocate some misfolded ER proteins to the cytosol for proteasomal degradation, potentially contributing to the MHC Class I pathway. This is specified as substrate- and context-dependent.\n    5.  **Adjuvant Function:** TLR agonists promote DC maturation and can enhance cross-presentation but do not alter the initial cellular location of antigen synthesis.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a comparison between two well-defined mRNA vaccine strategies, targeting the resulting antigen to either the cytosol (Construct X) or the secretory pathway (Construct Y). The question asks for a prediction of the immunological outcome based on a provided set of foundational principles from molecular cell biology and immunology.\n\n- **Scientifically Grounded:** The problem statement is based on established and fundamental principles of protein synthesis, cellular trafficking, and antigen presentation by MHC Class I and MHC Class II molecules. There are no factual errors or pseudoscientific claims.\n- **Well-Posed:** The problem provides a clear, self-contained scenario with two distinct initial conditions (X vs. Y) and asks for a logical deduction about the dominant pathways and consequent CD8 T cell response. The provided principles are sufficient to derive a unique, reasoned answer.\n- **Objective:** The problem is stated in precise, unbiased technical language.\n\nThe problem does not violate any of the invalidity criteria. It is a valid, well-formulated scientific problem.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will now be derived.\n\n### Derivation of Solution\nThe question requires a prediction of the dominant antigen presentation pathways for each construct and the resulting strength of the primary CD8 T cell response. The strength of a primary CD8 T cell response is directly related to the efficiency of antigen presentation on MHC Class I molecules.\n\n1.  **Analysis of Construct X:** The mRNA is translated on free ribosomes, producing the antigen directly in the cytosol. According to the foundational principles, cytosolic proteins are the canonical substrate for the MHC Class I presentation pathway. The protein will be ubiquitinated, degraded by the proteasome into peptide fragments, and these peptides will be transported into the ER by TAP. Inside the ER, the peptides are loaded onto nascent MHC Class I molecules, which then traffic to the cell surface to present the antigen to CD8 T cells. This is the direct, classical, and \"optimized\" pathway for endogenous antigens. Its access to the MHC Class II pathway is not direct and would require unconventional events, such as cell death and subsequent phagocytosis by another DC.\n\n2.  **Analysis of Construct Y:** The mRNA is translated on ER-bound ribosomes, and the protein is co-translationally imported into the ER lumen, glycosylated, and then secreted from the cell. As a secreted, extracellular protein, its primary route of interaction with the immune system is through uptake by antigen-presenting cells (APCs), such as DCs, from the extracellular environment. According to the principles, such exogenous antigens are processed in the endolysosomal pathway and loaded onto MHC Class II molecules for presentation to CD4 T cells. This is the canonical pathway for extracellular antigens.\n    For this antigen to be presented on MHC Class I, it must access the cytosolic processing machinery. The principles mention two such routes:\n    - **Cross-presentation:** The secreted protein is taken up by a specialized DC, and the antigen is somehow transported from the endosome into the cytosol, where it can be degraded by the proteasome and its peptides loaded onto MHC Class I. The problem states the adjuvant enhances this, but it remains an indirect pathway compared to direct cytosolic synthesis.\n    - **ERAD:** Within the originally transfected cell, a fraction of the newly synthesized protein in the ER lumen may be misfolded and targeted for ERAD. This involves retro-translocation into the cytosol, where it is degraded by the proteasome, thus feeding peptides into the MHC Class I pathway. The problem statement explicitly qualifies this route as \"substrate- and context-dependent,\" implying it is not a universally efficient or primary pathway.\n\n3.  **Comparison and Conclusion:** Construct X utilizes the direct and most efficient pathway for loading MHC Class I molecules by delivering the antigen straight into the cytosol. Construct Y primarily engages the MHC Class II pathway. Its access to the MHC Class I pathway is indirect, relying on the secondary processes of cross-presentation or ERAD. Therefore, the quantity of peptide-MHC Class I complexes generated from Construct X is expected to be significantly higher than that from Construct Y in a primary response. Consequently, Construct X is predicted to elicit a stronger primary CD8 T cell response.\n\n### Option-by-Option Analysis\n\n**A. Construct X will predominantly undergo proteasomal degradation in the cytosol, feed peptides via TAP into the ER, and be efficiently presented on MHC Class I, with limited direct access to MHC Class II unless released or transferred to other cells; Construct Y will largely enter endolysosomal compartments after secretion and uptake, favoring MHC Class II presentation, with MHC Class I arising mainly through cross-presentation or occasional ERAD. Therefore, Construct X will favor stronger CD8 responses.**\nThis option correctly describes the fate of the cytosolic antigen from Construct X, identifying the direct MHC Class I pathway as dominant. It also correctly describes the fate of the secreted antigen from Construct Y, identifying the MHC Class II pathway as primary and the indirect routes (cross-presentation, ERAD) as the source for MHC Class I presentation. The conclusion that Construct X will favor stronger CD8 responses is the logical outcome of this analysis.\n**Verdict: Correct.**\n\n**B. Both constructs enter the same MHC Class I pathway with equal efficiency because all peptides are ultimately loaded in the ER; CD8 responses will be equivalent, and the presence or absence of a signal peptide has no impact on presentation.**\nThis statement is fundamentally flawed. The initial compartmentalization of the antigen (cytosol vs. secretory pathway) dictates the pathway and efficiency of peptide generation and delivery to the ER. The direct cytosolic route of X and the indirect routes of Y are not equivalent in efficiency. The presence of a signal peptide has a profound impact on the presentation pathway.\n**Verdict: Incorrect.**\n\n**C. Construct Y will outcompete Construct X for MHC Class I because peptides can be loaded directly onto MHC Class I in the ER from the secreted antigen without proteasomal processing or TAP; therefore, Construct Y will generate stronger CD8 responses.**\nThis contradicts the provided foundational principles. Loading of MHC Class I requires peptides, which are classically generated in the cytosol by the proteasome and transported into the ER via TAP. Intact proteins or their fragments within the ER lumen do not directly load onto MHC Class I.\n**Verdict: Incorrect.**\n\n**D. Construct X will be poorly presented on MHC Class I because cytosolic proteasomes destroy most epitopes before loading, whereas Construct Y, after secretion and uptake, will be cross-presented so efficiently on mature DCs that it will surpass direct presentation; therefore, Construct Y will generate stronger CD8 responses.**\nThe premise that proteasomes \"destroy\" epitopes is incorrect; their function is to *generate* the peptide epitopes for MHC Class I. While cross-presentation is an important mechanism, the claim that it is so efficient as to surpass direct presentation is a strong assertion that is not supported by general immunological principles or the information given. The direct pathway is described as \"optimized\" for this function.\n**Verdict: Incorrect.**\n\n**E. Construct Y will dominate both MHC Class I and MHC Class II because glycosylation in the ER protects epitopes from degradation and enables peptide editing in the ER to favor MHC Class I loading; hence, Construct Y will generate stronger CD8 responses than Construct X regardless of adjuvant choice.**\nThis statement misinterprets several processes. Glycosylation's role is complex and does not guarantee epitope protection. More importantly, peptide editing in the ER (by enzymes like ERAP) acts on peptides that have already been transported into the ER via TAP. It does not provide a mechanism for the luminal protein from Construct Y to be processed into peptides and loaded onto MHC Class I. The reasoning is flawed.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2469000"}, {"introduction": "The ultimate goal of a vaccine is to protect an entire population, not just a single individual. Human populations are genetically diverse, especially in the Human Leukocyte Antigen (HLA) genes that govern antigen presentation. This advanced practice moves from cellular immunology to computational population immunology, tasking you with developing an algorithm to estimate a vaccine's predicted population coverage [@problem_id:2469070]. By integrating peptide-HLA binding predictions with real-world allele frequency data under the Hardy–Weinberg Equilibrium assumption, you will learn the quantitative methods used at the forefront of modern, epitope-based vaccine design to ensure a new vaccine is effective for the broadest possible audience.", "problem": "You are designing an algorithm to estimate predicted population coverage for epitope-based vaccines in an advanced context involving subunit or messenger ribonucleic acid (mRNA) antigen design. The goal is to quantify the probability that at least one peptide from a specified set is presented by at least one Human Leukocyte Antigen (HLA) locus in a randomly sampled individual from a target population. Your computation must integrate peptide–HLA binding predictions and allele frequency data across loci.\n\nUse only the following foundational bases:\n- The basic axioms of probability, including the law of total probability, independence, and the complement rule.\n- The Hardy–Weinberg Equilibrium (HWE) for genotype probabilities at a locus from allele frequencies.\n- The standard assumption of independence across distinct HLA loci.\n- An independence model in which, within a locus, the two alleles in a diploid genotype contribute independent opportunities for presentation given their per-allele presentation probabilities.\n- For multiple peptides, independence across peptides when computing the probability that none are presented by a given allele.\n\nDefinitions to use:\n- Let the set of loci be $\\mathcal{L}$.\n- For each locus $\\ell \\in \\mathcal{L}$, let the allele set be $\\mathcal{A}_{\\ell}$ with per-allele frequencies $\\{f_{a}\\}_{a \\in \\mathcal{A}_{\\ell}}$ satisfying $\\sum_{a \\in \\mathcal{A}_{\\ell}} f_{a} = 1$ and $f_{a} \\ge 0$.\n- Assume HWE for each locus so that the genotype probability for a homozygote $(a/a)$ is $f_{a}^{2}$ and for a heterozygote $(a_{i}/a_{j})$ with $i \\ne j$ is $2 f_{a_{i}} f_{a_{j}}$.\n- Let the peptide set be $S$, and let $b_{p,a} \\in [0,1]$ be the per-allele probability that peptide $p \\in S$ is presented by allele $a$.\n- For each allele $a$, the probability that none of the peptides in $S$ are presented is $q_{a}(S) = \\prod_{p \\in S} (1 - b_{p,a})$.\n- For a diploid genotype $(a_{i}, a_{j})$ at locus $\\ell$, the probability that at least one peptide in $S$ is presented at that locus is $1 - q_{a_{i}}(S)\\,q_{a_{j}}(S)$.\n- The population-averaged locus-level presentation probability is obtained by averaging the genotype-level probability over the HWE genotype distribution at that locus.\n- Assuming independence across loci, the overall population coverage for the set $S$ across all loci is the probability that at least one locus presents at least one peptide in $S$.\n\nYour task is to implement a program that computes the overall coverage for each of the following test cases. You must treat any missing $b_{p,a}$ as $0$. There are $4$ test cases. For each test case, compute the overall population coverage as a float rounded to exactly $6$ decimal places.\n\nTest suite:\n\n- Test case $1$ (multi-locus, multi-peptide, general case):\n  - Loci and allele frequencies:\n    - Locus A: alleles A*01:01 with $f = 0.3$, A*02:01 with $f = 0.5$, A*03:01 with $f = 0.2$.\n    - Locus B: alleles B*07:02 with $f = 0.6$, B*08:01 with $f = 0.4$.\n  - Peptide set $S = \\{p_{1}, p_{2}\\}$ with per-allele binding probabilities $b_{p,a}$:\n    - For locus A:\n      - $b_{p_{1},\\mathrm{A*01:01}} = 0.7$, $b_{p_{2},\\mathrm{A*01:01}} = 0.2$.\n      - $b_{p_{1},\\mathrm{A*02:01}} = 0.1$, $b_{p_{2},\\mathrm{A*02:01}} = 0.6$.\n      - $b_{p_{1},\\mathrm{A*03:01}} = 0.0$, $b_{p_{2},\\mathrm{A*03:01}} = 0.1$.\n    - For locus B:\n      - $b_{p_{1},\\mathrm{B*07:02}} = 0.3$, $b_{p_{2},\\mathrm{B*07:02}} = 0.4$.\n      - $b_{p_{1},\\mathrm{B*08:01}} = 0.8$, $b_{p_{2},\\mathrm{B*08:01}} = 0.2$.\n\n- Test case $2$ (single locus, monomorphic boundary with a zero-frequency allele included):\n  - Locus and allele frequencies:\n    - Locus A: alleles A*01:01 with $f = 1.0$, A*02:01 with $f = 0.0$.\n  - Peptide set $S = \\{p_{3}\\}$:\n    - $b_{p_{3},\\mathrm{A*01:01}} = 0.5$.\n    - $b_{p_{3},\\mathrm{A*02:01}} = 0.0$.\n\n- Test case $3$ (two loci, one monomorphic locus dominates coverage):\n  - Loci and allele frequencies:\n    - Locus A: alleles A1 with $f = 0.5$, A2 with $f = 0.5$.\n    - Locus B: allele B1 with $f = 1.0$.\n  - Peptide set $S = \\{p_{4}, p_{5}\\}$:\n    - $b_{p_{4},\\mathrm{A1}} = 0.0$, $b_{p_{5},\\mathrm{A1}} = 0.0$.\n    - $b_{p_{4},\\mathrm{A2}} = 0.0$, $b_{p_{5},\\mathrm{A2}} = 0.0$.\n    - $b_{p_{4},\\mathrm{B1}} = 0.9$, $b_{p_{5},\\mathrm{B1}} = 0.0$.\n\n- Test case $4$ (rare high-binding allele and moderate binder at another locus):\n  - Loci and allele frequencies:\n    - Locus A: alleles A1 with $f = 0.01$, A2 with $f = 0.99$.\n    - Locus B: alleles B1 with $f = 0.5$, B2 with $f = 0.5$.\n  - Peptide set $S = \\{p_{6}\\}$:\n    - $b_{p_{6},\\mathrm{A1}} = 1.0$, $b_{p_{6},\\mathrm{A2}} = 0.0$, $b_{p_{6},\\mathrm{B1}} = 0.2$, $b_{p_{6},\\mathrm{B2}} = 0.0$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of test cases $1$ through $4$, for example, $\\big[r_1,r_2,r_3,r_4\\big]$.\n- Each $r_{i}$ must be rounded to exactly $6$ decimal places.", "solution": "The problem is assessed to be valid. It is scientifically sound, well-posed, and based on established principles of population genetics and immunology. All necessary data and definitions are provided for a unique solution.\n\nThe objective is to compute the overall population coverage, $C_{total}$, defined as the probability that a randomly selected individual from a population presents at least one peptide from a given set $S$ on at least one Human Leukocyte Antigen (HLA) locus from a set $\\mathcal{L}$.\n\nThe solution is derived from first principles as follows. The overall coverage $C_{total}$ is the complement of the event that an individual fails to present any peptide from $S$ at any locus in $\\mathcal{L}$. Let $E$ be the event of presentation at any locus, and $E^c$ be the event of failure at all loci. Then, $C_{total} = P(E) = 1 - P(E^c)$.\n\nThe problem specifies that presentation events at distinct HLA loci are statistically independent. Therefore, the probability of failure at all loci is the product of the probabilities of failure at each individual locus. Let $Q_{\\ell}$ be the probability of failure to present any peptide from $S$ at locus $\\ell \\in \\mathcal{L}$. The total probability of failure is:\n$$\nP(E^c) = \\prod_{\\ell \\in \\mathcal{L}} Q_{\\ell}\n$$\nThus, the overall coverage is:\n$$\nC_{total} = 1 - \\prod_{\\ell \\in \\mathcal{L}} Q_{\\ell}\n$$\nThe core of the problem is to determine the population-averaged locus-level failure probability, $Q_{\\ell}$. This is calculated by considering all possible diploid genotypes at locus $\\ell$ and their frequencies, as determined by the Hardy-Weinberg Equilibrium (HWE) principle.\n\nLet $\\mathcal{A}_{\\ell}$ be the set of alleles at locus $\\ell$, with corresponding frequencies $\\{f_{a}\\}_{a \\in \\mathcal{A}_{\\ell}}$. According to HWE, the frequency of a homozygous genotype $(a/a)$ is $f_{a}^{2}$, and the frequency of a heterozygous genotype $(a_i/a_j)$ for $a_i \\neq a_j$ is $2 f_{a_i} f_{a_j}$.\n\nFirst, we define the probability that a single allele $a$ fails to present any peptide from the set $S$. The problem states that the per-allele presentation probability for a peptide $p$ by an allele $a$ is $b_{p,a}$. Assuming independence across peptides, the probability that allele $a$ fails to present peptide $p$ is $(1 - b_{p,a})$. The probability that allele $a$ fails to present *any* peptide from $S$ is given by $q_a(S)$:\n$$\nq_{a}(S) = \\prod_{p \\in S} (1 - b_{p,a})\n$$\nNext, consider an individual with a diploid genotype $(a_i, a_j)$ at locus $\\ell$. The problem assumes that the two alleles contribute independently to presentation. Therefore, the probability that this entire genotype fails to present any peptide from $S$ is the product of the failure probabilities of each constituent allele:\n$$\nP(\\text{failure} \\mid \\text{genotype } (a_i, a_j)) = q_{a_i}(S) \\, q_{a_j}(S)\n$$\nTo find the population-averaged failure probability $Q_{\\ell}$, we sum the genotype-level failure probabilities over all possible genotypes, weighted by their HWE frequencies. This is an application of the law of total probability.\n$$\nQ_{\\ell} = \\sum_{a_i \\in \\mathcal{A}_{\\ell}} \\sum_{a_j \\in \\mathcal{A}_{\\ell}} P(\\text{genotype } (a_i, a_j)) \\cdot q_{a_i}(S) \\, q_{a_j}(S)\n$$\nBy partitioning the sum into homozygous ($i=j$) and heterozygous ($i \\neq j$) terms, we get:\n$$\nQ_{\\ell} = \\sum_{i} f_{a_i}^2 \\cdot q_{a_i}(S)^2 + \\sum_{i < j} 2 f_{a_i} f_{a_j} \\cdot q_{a_i}(S) \\, q_{a_j}(S)\n$$\nThis expression is the expansion of a squared sum:\n$$\nQ_{\\ell} = \\left( \\sum_{a \\in \\mathcal{A}_{\\ell}} f_{a} \\, q_{a}(S) \\right)^2\n$$\nLet $\\bar{q}_{\\ell} = \\sum_{a \\in \\mathcal{A}_{\\ell}} f_{a} \\, q_{a}(S)$ be the allele-frequency-weighted average of the per-allele failure probabilities at locus $\\ell$. Then, $Q_{\\ell} = (\\bar{q}_{\\ell})^2$. This elegant result implies that the probability of locus-level failure in a diploid organism under HWE is the square of the average haploid (single-allele) failure probability in the population.\n\nCombining these results, the final formula for overall population coverage is:\n$$\nC_{total} = 1 - \\prod_{\\ell \\in \\mathcal{L}} \\left( \\sum_{a \\in \\mathcal{A}_{\\ell}} f_{a} \\prod_{p \\in S} (1 - b_{p,a}) \\right)^2\n$$\nThe computational algorithm proceeds as follows for each test case:\n$1$. For each locus $\\ell$, compute the average per-allele failure probability $\\bar{q}_{\\ell}$.\n    a. For each allele $a \\in \\mathcal{A}_{\\ell}$, calculate its failure probability $q_{a}(S)$ by taking the product of $(1 - b_{p,a})$ over all peptides $p \\in S$. Any missing $b_{p,a}$ is treated as $0$.\n    b. Compute $\\bar{q}_{\\ell}$ by summing $f_{a} \\cdot q_{a}(S)$ over all alleles $a \\in \\mathcal{A}_{\\ell}$.\n$2$. For each locus $\\ell$, calculate the locus-level failure probability $Q_{\\ell} = (\\bar{q}_{\\ell})^2$.\n$3$. Compute the total failure probability $Q_{total}$ by multiplying all $Q_{\\ell}$ values.\n$4$. The final coverage is $C_{total} = 1 - Q_{total}$.\n$5$. The result is then rounded to $6$ decimal places as required.\nThis procedure is implemented for each of the provided test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the predicted population coverage for epitope-based vaccines\n    for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"peptides\": [\"p1\", \"p2\"],\n            \"loci\": [\n                {\n                    \"name\": \"A\",\n                    \"alleles\": {\"A*01:01\": 0.3, \"A*02:01\": 0.5, \"A*03:01\": 0.2},\n                    \"bindings\": {\n                        \"p1\": {\"A*01:01\": 0.7, \"A*02:01\": 0.1, \"A*03:01\": 0.0},\n                        \"p2\": {\"A*01:01\": 0.2, \"A*02:01\": 0.6, \"A*03:01\": 0.1},\n                    },\n                },\n                {\n                    \"name\": \"B\",\n                    \"alleles\": {\"B*07:02\": 0.6, \"B*08:01\": 0.4},\n                    \"bindings\": {\n                        \"p1\": {\"B*07:02\": 0.3, \"B*08:01\": 0.8},\n                        \"p2\": {\"B*07:02\": 0.4, \"B*08:01\": 0.2},\n                    },\n                },\n            ],\n        },\n        {\n            \"peptides\": [\"p3\"],\n            \"loci\": [\n                {\n                    \"name\": \"A\",\n                    \"alleles\": {\"A*01:01\": 1.0, \"A*02:01\": 0.0},\n                    \"bindings\": {\"p3\": {\"A*01:01\": 0.5, \"A*02:01\": 0.0}},\n                }\n            ],\n        },\n        {\n            \"peptides\": [\"p4\", \"p5\"],\n            \"loci\": [\n                {\n                    \"name\": \"A\",\n                    \"alleles\": {\"A1\": 0.5, \"A2\": 0.5},\n                    \"bindings\": {\n                        \"p4\": {\"A1\": 0.0, \"A2\": 0.0},\n                        \"p5\": {\"A1\": 0.0, \"A2\": 0.0},\n                    },\n                },\n                {\n                    \"name\": \"B\",\n                    \"alleles\": {\"B1\": 1.0},\n                    \"bindings\": {\"p4\": {\"B1\": 0.9}, \"p5\": {\"B1\": 0.0}},\n                },\n            ],\n        },\n        {\n            \"peptides\": [\"p6\"],\n            \"loci\": [\n                {\n                    \"name\": \"A\",\n                    \"alleles\": {\"A1\": 0.01, \"A2\": 0.99},\n                    \"bindings\": {\"p6\": {\"A1\": 1.0, \"A2\": 0.0}},\n                },\n                {\n                    \"name\": \"B\",\n                    \"alleles\": {\"B1\": 0.5, \"B2\": 0.5},\n                    \"bindings\": {\"p6\": {\"B1\": 0.2}}, # Missing b_p6,B2 is treated as 0\n                },\n            ],\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        locus_failure_probabilities = []\n        \n        for locus_data in case[\"loci\"]:\n            peptides = case[\"peptides\"]\n            alleles = locus_data[\"alleles\"]\n            bindings = locus_data.get(\"bindings\", {})\n\n            # Calculate the population-averaged per-allele failure probability, q_bar_l\n            avg_allele_failure_prob = 0.0\n            \n            for allele_name, allele_freq in alleles.items():\n                # Calculate the per-allele probability of non-presentation, q_a(S)\n                per_allele_failure_prob = 1.0\n                for peptide in peptides:\n                    binding_prob = bindings.get(peptide, {}).get(allele_name, 0.0)\n                    per_allele_failure_prob *= (1.0 - binding_prob)\n                \n                avg_allele_failure_prob += allele_freq * per_allele_failure_prob\n            \n            # The locus-level failure probability Q_l is (q_bar_l)^2\n            locus_failure_prob = avg_allele_failure_prob ** 2\n            locus_failure_probabilities.append(locus_failure_prob)\n            \n        # Total failure probability is the product of locus-level failure probabilities\n        total_failure_prob = np.prod(locus_failure_probabilities)\n        \n        # Overall coverage is 1 - total failure probability\n        coverage = 1.0 - total_failure_prob\n        results.append(coverage)\n        \n    # Format the output string as required\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2469070"}]}