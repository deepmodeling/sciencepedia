{"hands_on_practices": [{"introduction": "Before we can analyze a genome, we must first assemble it from millions of short sequencing reads. A fundamental question is whether our sequencing effort was sufficient to cover the entire genome. This exercise explores the relationship between sequencing depth, or coverage ($C$), and genome completeness using the classic Lander-Waterman model, providing a quantitative framework to estimate how much of a genome is expected to be left uncovered [@problem_id:2495881]. Mastering this calculation is key to planning effective sequencing projects and interpreting the completeness of the resulting assemblies.", "problem": "A metagenome-assembled genome (MAG) recovered from a complex community is estimated to have a haploid genome size of $G=5\\times 10^{6}$ base pairs (bp). A sequencing run produced $N=5\\times 10^{7}$ independent shotgun reads, each of length $L=150$ bp, derived from a single-cell genomics workflow where amplification biases are assumed negligible for the purposes of this calculation. Assume an idealized uniform random shotgun model: reads start uniformly at random across the circularized genome, read starts are independent, and edge effects are negligible because $L \\ll G$.\n\nStarting only from (i) the definition that sequencing depth (also called coverage) is the total number of sequenced bases divided by the genome size, and (ii) the assumption that each base’s coverage count arises from many independent, rare trials, derive the expected fraction of bases that remain uncovered in the assembled MAG. Then, compute:\n\n- The average coverage $C$.\n- The expected fraction of the genome that is uncovered under the idealized Poisson model for base-wise coverage.\n\nExpress the expected uncovered fraction as a decimal or an exact expression. Report both values as dimensionless quantities. Do not round unless it is necessary to represent constants not expressible in exact form.", "solution": "The problem will first be subject to rigorous validation. Only upon confirmation of its validity will a solution be attempted.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe givens are extracted verbatim from the problem statement:\n- Haploid genome size: $G=5\\times 10^{6}$ bp\n- Total number of shotgun reads: $N=5\\times 10^{7}$\n- Read length: $L=150$ bp\n- Assumption 1: Sequencing run is from a single-cell genomics workflow where amplification biases are assumed negligible.\n- Assumption 2: An idealized uniform random shotgun model is assumed.\n- Assumption 3: Reads start uniformly at random across the circularized genome.\n- Assumption 4: Read starts are independent.\n- Assumption 5: Edge effects are negligible because $L \\ll G$.\n- Task 1: Starting from the definition of sequencing depth and the assumption of many independent, rare trials, derive the expected fraction of bases that remain uncovered.\n- Task 2: Compute the average coverage $C$.\n- Task 3: Compute the expected fraction of the genome that is uncovered under the idealized Poisson model for base-wise coverage.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the established criteria:\n- **Scientifically Grounded**: The problem is a direct application of the Lander-Waterman model, a foundational concept in genomics and bioinformatics used to describe sequencing coverage. The assumptions, such as uniform random distribution of reads and a Poisson model for coverage depth, are standard idealizations in this context. The numerical values provided for genome size ($G$), read count ($N$), and read length ($L$) are within realistic bounds for modern sequencing experiments.\n- **Well-Posed**: The problem is clearly stated and provides all necessary parameters and assumptions to derive and calculate the requested quantities. A unique, stable, and meaningful solution exists.\n- **Objective**: The problem is formulated with precise, scientific language, free of subjectivity or ambiguity.\n\nThe problem does not violate any criteria for invalidity. It is scientifically sound, self-contained, and objective. The condition $L \\ll G$ ($150 \\ll 5 \\times 10^6$) holds, justifying the stated assumption of negligible edge effects.\n\n**Step 3: Verdict and Action**\n\nThe problem is deemed **valid**. A complete, reasoned solution will now be provided.\n\n### Solution Derivation\n\nThe problem requires a derivation of the expected fraction of uncovered bases from first principles and then a calculation of this fraction and the average coverage.\n\nFirst, we address the definition and calculation of the average coverage, denoted by $C$. The problem statement defines sequencing depth (coverage) as the total number of sequenced bases divided by the genome size.\n\nThe total number of bases sequenced is the product of the number of reads, $N$, and the length of each read, $L$.\n$$\n\\text{Total bases sequenced} = N \\times L\n$$\n\nThe genome size is given as $G$. Thus, the average coverage $C$ is:\n$$\nC = \\frac{N \\times L}{G}\n$$\n\nNext, we derive the expected fraction of the genome that remains uncovered. The derivation must start from the premise of \"many independent, rare trials,\" which is the classical foundation for the Poisson distribution.\n\nConsider a single, arbitrary base in the genome. We wish to find the probability that this base is not covered by any of the $N$ sequenced reads.\n\nA single read of length $L$ covers a specific base if the read's starting position falls within a genomic window of length $L$ that ends at the base in question. Given a circular genome of size $G$ and the assumption of uniform random read start positions, the probability $p$ that a single, randomly chosen read covers this specific base is the ratio of the length of this target window to the total genome size:\n$$\np = \\frac{L}{G}\n$$\n\nSince the reads are independent, the event of being covered by one read is independent of being covered by another. The probability that a single read does *not* cover the specific base is therefore $1-p$.\n$$\n1-p = 1 - \\frac{L}{G}\n$$\n\nThere are $N$ independent reads in total. The probability that *none* of these $N$ reads cover the specific base is the product of the individual probabilities for each read:\n$$\nP(\\text{base is uncovered}) = (1 - p)^N = \\left(1 - \\frac{L}{G}\\right)^N\n$$\n\nThis expression gives the exact probability under a binomial framework, where each of the $N$ reads is a Bernoulli trial. The problem, however, directs us to use the \"many independent, rare trials\" assumption, which leads to the Poisson approximation. In our context, the number of trials $N$ is very large ($5 \\times 10^7$), and the probability of success $p$ is very small ($p = 150 / (5 \\times 10^6) = 3 \\times 10^{-5}$), which are the precise conditions under which the binomial distribution converges to a Poisson distribution.\n\nLet the random variable $K$ be the number of times a base is covered. $K$ follows a binomial distribution $B(N, p)$. The expected value of $K$, denoted $\\lambda$, is:\n$$\n\\lambda = N \\times p = N \\frac{L}{G}\n$$\nThis parameter $\\lambda$ is identical to our previously defined average coverage $C$.\n$$\n\\lambda = C\n$$\n\nThe probability mass function for a binomial distribution $B(N, p)$ can be approximated by a Poisson distribution with mean $\\lambda = Np$ when $N$ is large and $p$ is small. The probability of observing $k$ events in a Poisson distribution is:\n$$\nP(K=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}\n$$\n\nWe are interested in the case where a base is uncovered, which corresponds to $k=0$.\n$$\nP(K=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\frac{1 \\cdot \\exp(-\\lambda)}{1} = \\exp(-\\lambda)\n$$\nSubstituting $\\lambda = C$, the probability that a base is uncovered is $\\exp(-C)$. This can also be shown formally by taking the limit of the binomial probability as $N \\to \\infty$:\n$$\n\\lim_{N \\to \\infty} \\left(1 - \\frac{L}{G}\\right)^N = \\lim_{N \\to \\infty} \\left(1 - \\frac{C}{N}\\right)^N = \\exp(-C)\n$$\nDue to the assumption of uniform read distribution, the probability of any single base being uncovered is the same for all bases. Therefore, the expected fraction of the entire genome that is uncovered is also $\\exp(-C)$.\n\nNow, we perform the calculations using the provided values.\n\n1.  **Calculate Average Coverage ($C$)**\n    Given: $G=5\\times 10^{6}$, $N=5\\times 10^{7}$, $L=150$.\n    $$\n    C = \\frac{N \\times L}{G} = \\frac{(5 \\times 10^7) \\times 150}{5 \\times 10^6}\n    $$\n    $$\n    C = \\left(\\frac{5 \\times 10^7}{5 \\times 10^6}\\right) \\times 150 = 10 \\times 150 = 1500\n    $$\n    The average coverage is $1500$. This is a dimensionless quantity, often written as $1500$X.\n\n2.  **Calculate Expected Uncovered Fraction**\n    The expected fraction of the genome that is uncovered is given by $\\exp(-C)$.\n    $$\n    \\text{Uncovered Fraction} = \\exp(-1500)\n    $$\n    This value is an exact expression. It is an exceedingly small positive number, representing a scenario where the genome is sequenced to such a depth that the probability of any base being missed is almost zero. Expressing it in decimal form is impractical and unnecessary.\n\nThe two requested quantities are the average coverage $C$ and the expected uncovered fraction $\\exp(-C)$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 1500 & \\exp(-1500) \\end{pmatrix}}\n$$", "id": "2495881"}, {"introduction": "Once a Metagenome-Assembled Genome (MAG) or Single-Cell Amplified Genome (SAG) is constructed, its quality must be rigorously assessed. This practice introduces the field-standard method for this evaluation: using a set of conserved, single-copy marker genes to estimate the genome's completeness ($\\hat{c}$) and contamination ($\\hat{t}$) levels [@problem_id:2495840]. By working through the calculation of these critical metrics, you will gain a deeper understanding of how we measure the quality of genomes recovered from uncultivated microbes and the statistical confidence of these estimates.", "problem": "A metagenome-assembled genome (MAG) is evaluated for quality using a lineage-specific set of single-copy marker genes. Suppose the expected number of single-copy marker genes for this lineage is $m = 120$. In a particular MAG, $u = 92$ distinct markers are detected (counting each marker at most once), and $d = 6$ of the detected markers are found to be duplicated, where each such duplication corresponds to exactly one additional copy beyond the expected single copy (that is, each of these $d$ markers has total copy number $2$).\n\nUsing only the foundational definitions that (i) completeness is the fraction of expected single-copy markers present and (ii) contamination is the fraction of extra copies of single-copy markers relative to the expected number, derive estimators $\\hat{c}$ for completeness and $\\hat{t}$ for contamination in terms of $m$, $u$, and the number of extra copies. Then evaluate these estimators for the values $m = 120$, $u = 92$, and the number of extra copies equal to $d = 6$. In your derivation, start from the definitions and justify each step in forming the estimators. Briefly discuss, from first principles, how the finite size $m$ of the marker set and the low count of duplications would affect confidence in these estimates under a simple sampling model of marker detection.\n\nReport your final numerical values for $\\hat{c}$ and $\\hat{t}$ as decimals rounded to four significant figures. Do not report units or percentages. Present the final numerical answer as a row vector $\\bigl[\\hat{c}, \\hat{t}\\bigr]$.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains sufficient information for a unique solution. We shall proceed with the derivation and analysis as requested.\n\nThe task is to derive estimators for completeness ($\\hat{c}$) and contamination ($\\hat{t}$) based on a provided set of definitions and parameters, evaluate them numerically, and discuss the statistical confidence in these estimates. The given parameters are: the expected number of single-copy marker genes, $m = 120$; the number of unique markers detected, $u = 92$; and the number of markers found with exactly one additional copy, $d = 6$.\n\nFirst, we derive the estimator for completeness, $\\hat{c}$. The definition provided is \"completeness is the fraction of expected single-copy markers present\". The total number of expected single-copy markers is $m$. The number of these markers that are present (i.e., detected) in the Metagenome-Assembled Genome (MAG) is given as $u$. Therefore, the estimator $\\hat{c}$ is the ratio of the number of unique markers found to the total number of markers in the lineage-specific set.\n$$\n\\hat{c} = \\frac{u}{m}\n$$\nThis estimator represents the proportion of the reference marker gene set that was successfully recovered in the MAG.\n\nSecond, we derive the estimator for contamination, $\\hat{t}$. The definition is \"contamination is the fraction of extra copies of single-copy markers relative to the expected number\". The problem states that there are $d$ duplicated markers, each with \"exactly one additional copy\". Thus, the total number of \"extra copies\" is equal to $d$. The definition specifies that this fraction is \"relative to the expected number\". The only relevant \"expected number\" defined in the problem is $m$, the size of the marker gene set. Consequently, the estimator $\\hat{t}$ is the ratio of the number of extra copies to the total number of expected marker genes.\n$$\n\\hat{t} = \\frac{d}{m}\n$$\nThis formulation measures the level of duplication-based contamination normalized by the size of the genome proxy, which is the marker set.\n\nWe now substitute the given numerical values into these estimators. The parameters are $m = 120$, $u = 92$, and $d = 6$.\nFor completeness, $\\hat{c}$:\n$$\n\\hat{c} = \\frac{92}{120} = \\frac{23}{30} = 0.7666\\overline{6}\n$$\nRounding to four significant figures, the value is $\\hat{c} \\approx 0.7667$.\n\nFor contamination, $\\hat{t}$:\n$$\n\\hat{t} = \\frac{6}{120} = \\frac{1}{20} = 0.05\n$$\nExpressed with four significant figures, this value is $0.05000$.\n\nFinally, we discuss the confidence in these estimates from first principles. The values $\\hat{c}$ and $\\hat{t}$ are point estimates derived from a sample and are subject to statistical error.\n\nThe confidence in the completeness estimate $\\hat{c}$ is determined by the size of the marker set, $m$. We can model the observation of each marker gene as an independent Bernoulli trial, where the probability of success (detection) is the true completeness, $p_c$. The number of detected markers, $u$, thus follows a binomial distribution, $u \\sim \\text{Binomial}(m, p_c)$. The estimator $\\hat{c} = u/m$ is the standard sample proportion. The uncertainty of this estimate, quantified by its standard error, is $\\text{SE}(\\hat{c}) = \\sqrt{\\frac{p_c(1-p_c)}{m}}$, which is estimated as $\\sqrt{\\frac{\\hat{c}(1-\\hat{c})}{m}}$. The standard error is inversely proportional to the square root of the sample size, $\\sqrt{m}$. For $m=120$, the marker set size is finite and introduces a tangible, though not excessive, degree of uncertainty. A larger $m$ would yield a smaller standard error and thus a narrower confidence interval, signifying higher confidence.\n\nThe confidence in the contamination estimate $\\hat{t}$ is severely impacted by the low count of observed duplication events, $d=6$. The occurrence of duplications can be modeled as a rare event, and thus the count $d$ can be treated as an observation from a Poisson distribution with an unknown true mean rate $\\lambda$. The contamination estimate is $\\hat{t} = d/m$. The primary source of uncertainty in $\\hat{t}$ is the stochasticity of the count $d$. For small integer counts, the Poisson distribution is highly skewed, and the confidence interval for its mean is wide relative to the observed value. For an observation of $d=6$, the $95\\%$ confidence interval for the true mean number of duplicates is approximately $[2.2, 13.1]$. This large uncertainty in the underlying count of extra copies propagates directly to the contamination estimate $\\hat{t}$, resulting in a very wide confidence interval. Consequently, an estimate of contamination based on a small number of duplication events is considered to have low statistical confidence.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.7667 & 0.05000 \\end{pmatrix}}\n$$", "id": "2495840"}, {"introduction": "While marker gene analysis is powerful, its core assumption—that all markers are single-copy—is not always true for every organism. This exercise tackles a common real-world complication where multi-copy genes, like those for ribosomal RNA, can artificially inflate contamination estimates [@problem_id:2495922]. You will practice an advanced technique that uses relative sequencing coverage to estimate gene copy number and adjust the contamination score, learning a crucial skill for refining the quality assessment of your genomic data.", "problem": "A single-cell amplified genome (SAG) recovered from an uncultivated bacterium was evaluated with a single-copy marker framework commonly used for metagenome-assembled genomes (MAGs). Such frameworks infer contamination by quantifying extra copies of genes expected to be present once per genome and normalizing by the size of the marker set. A well-tested observation from shotgun sequencing is that, under uniform sampling and absent locus-specific biases, read depth (coverage) is proportional to underlying DNA copy number. Ribosomal RNA (rRNA) operons are among the few bacterial loci that are frequently multi-copy, so inclusion of rRNA genes in a single-copy marker set can inflate apparent contamination.\n\nConsider a marker set of size $S = 57$ loci, which (erroneously for this taxon) includes the $16\\mathrm{S}$, $23\\mathrm{S}$, and $5\\mathrm{S}$ rRNA genes as single-copy markers. For the SAG in question, the following were measured:\n- Number of unique marker genes observed (presence irrespective of copy number): $U = 50$.\n- Total number of marker gene instances observed (counting duplicates): $T = 60$.\n- Median coverage across a panel of confidently single-copy housekeeping genes: $m_{c} = 21$.\n- Median coverages for the three rRNA genes: $m_{16\\mathrm{S}} = 66$, $m_{23\\mathrm{S}} = 62$, $m_{5\\mathrm{S}} = 59$.\n\nAssume the following fundamental bases:\n- Contamination inferred from single-copy markers arises from extra copies beyond one, and its magnitude is proportional to the total count of such extras normalized by the marker set size.\n- For a locus class with copy number $c$, its expected coverage scales as $c$ times the coverage of truly single-copy loci, so the copy number can be estimated as the nearest integer to the ratio of class-specific coverage to single-copy coverage.\n\nUsing these bases, derive an adjustment procedure that:\n- Estimates the rRNA operon copy number $\\hat{c}$ from coverage by rounding the ratio of the median rRNA coverage to $m_{c}$ to the nearest integer.\n- Subtracts the expected extra counts due solely to multi-copy rRNA genes from the total duplicate count before normalizing by $S$.\n\nApply this procedure to the data above to compute the adjusted contamination estimate as a decimal fraction. Round your final answer to four significant figures and report it as a pure number without a percent sign.", "solution": "The problem posed is a calculation in quantitative genomics, specifically requiring the adjustment of a contamination estimate for a single-cell amplified genome (SAG). The problem is scientifically grounded and well-posed, providing all necessary data and a clear, logical procedure for its resolution. I will now execute this procedure.\n\nFirst, we must formally state the given parameters from the problem:\n- The size of the marker gene set, $S = 57$.\n- The number of unique marker genes detected, $U = 50$.\n- The total number of marker gene instances detected, counting all copies, $T = 60$.\n- The median coverage of a set of confirmed single-copy genes, $m_{c} = 21$.\n- The median coverages for the three specific ribosomal RNA (rRNA) genes erroneously included as single-copy markers: $m_{16\\mathrm{S}} = 66$, $m_{23\\mathrm{S}} = 62$, and $m_{5\\mathrm{S}} = 59$.\n\nContamination is typically quantified by the number of duplicate marker genes observed, normalized by the size of the marker set. The total number of observed duplicates, which we denote as $D_{obs}$, is the difference between the total instances found and the number of unique genes.\n$$D_{obs} = T - U = 60 - 50 = 10$$\nThis observed count includes duplicates from true contamination and apparent duplicates from multi-copy genes native to the organism. The task is to correct for the latter.\n\nThe adjustment procedure begins with estimating the copy number of the rRNA operon, $\\hat{c}$. The basis for this estimation is the principle that sequencing coverage is proportional to the copy number of the underlying DNA sequence. We must first determine a representative coverage for the rRNA genes. The problem specifies using the median of the three measured rRNA gene coverages. Let this be $m_{rRNA, med}$.\n$$m_{rRNA, med} = \\operatorname{median}(\\{59, 62, 66\\}) = 62$$\nThe copy number $\\hat{c}$ is then estimated by finding the nearest integer to the ratio of this median rRNA coverage to the baseline single-copy coverage, $m_c$.\n$$\\hat{c} = \\operatorname{round}\\left(\\frac{m_{rRNA, med}}{m_c}\\right) = \\operatorname{round}\\left(\\frac{62}{21}\\right) \\approx \\operatorname{round}(2.95238) = 3$$\nThis result indicates that the rRNA genes in this organism are present in approximately $3$ copies.\n\nNext, we calculate the number of duplicate gene counts that are expected from these multi-copy rRNA genes. The marker set includes $3$ rRNA genes, each erroneously assumed to be single-copy. With an estimated copy number of $\\hat{c}=3$, each of these genes is expected to have $\\hat{c} - 1$ extra copies, or duplicates.\nThe number of duplicates contributed by each rRNA gene is:\n$$d_{per\\_rRNA} = \\hat{c} - 1 = 3 - 1 = 2$$\nSince there are $3$ such rRNA loci in the marker set ($16\\mathrm{S}$, $23\\mathrm{S}$, $5\\mathrm{S}$), the total number of expected duplicates originating from them, $D_{rRNA}$, is:\n$$D_{rRNA} = 3 \\times d_{per\\_rRNA} = 3 \\times 2 = 6$$\n\nNow, we can compute the adjusted number of duplicates, $D_{adj}$. This is achieved by subtracting the number of duplicates attributed to the multi-copy rRNA genes from the total number of observed duplicates. The remainder represents the duplicates more likely to have arisen from true genomic contamination.\n$$D_{adj} = D_{obs} - D_{rRNA} = 10 - 6 = 4$$\n\nFinally, the adjusted contamination estimate, $C_{adj}$, is calculated by normalizing this adjusted duplicate count by the total size of the marker set, $S$. This conforms to the definition of contamination provided.\n$$C_{adj} = \\frac{D_{adj}}{S} = \\frac{4}{57}$$\nTo fulfill the requirements of the problem, this fraction must be expressed as a decimal rounded to four significant figures.\n$$C_{adj} = \\frac{4}{57} \\approx 0.070175438...$$\nRounding this value to four significant figures gives:\n$$C_{adj} \\approx 0.07018$$\nThis is the final adjusted contamination estimate.", "answer": "$$\\boxed{0.07018}$$", "id": "2495922"}]}