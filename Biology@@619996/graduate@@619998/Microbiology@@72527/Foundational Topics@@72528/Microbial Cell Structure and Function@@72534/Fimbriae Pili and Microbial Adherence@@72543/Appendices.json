{"hands_on_practices": [{"introduction": "To quantitatively describe microbial adherence, we must start with the most fundamental interaction: the reversible binding of a single adhesin to a host receptor. This first practice guides you through the derivation of the foundational equation that governs this process at equilibrium from mass-action principles. Mastering this derivation is essential, as the resulting binding isotherm represents the cornerstone upon which more complex models of infection and therapy are built [@problem_id:2493686].", "problem": "A bacterium expressing fimbrial adhesins approaches a host epithelial surface presenting a single class of monovalent receptors. Each adhesin binds at most one receptor and each receptor binds at most one adhesin. Assume a dilute system with no steric hindrance or cooperativity, and that the ligand concentration is large enough that its free concentration is not significantly depleted by binding. Let $[R]$ denote the concentration of free receptors, $[L]$ the concentration of free adhesins in the fluid phase, $[RL]$ the concentration of receptor–ligand complexes, and $R_T$ the total receptor concentration, so that $R_T = [R] + [RL]$. The binding reaction is $R + L \\rightleftharpoons RL$ with an association rate constant $k_{\\text{on}}$ and a dissociation rate constant $k_{\\text{off}}$. Use mass-action kinetics and the definition of the dissociation constant (K_D) to derive an explicit closed-form expression for the fractional receptor occupancy $\\theta = [RL]/R_T$ as a function of $[L]$ and the dissociation constant (K_D), defined as $K_D = k_{\\text{off}}/k_{\\text{on}}$. Then, analyze the limiting behavior of $\\theta$ for $[L] \\ll K_D$ and for $[L] \\gg K_D$, stating the leading-order expressions and interpreting them in the context of microbial adherence. Express your final result for $\\theta$ as a dimensionless analytic expression. No numerical rounding is required.", "solution": "The problem as stated is a valid, well-posed exercise in fundamental biophysical chemistry, specifically the application of mass-action kinetics to a simple receptor-ligand binding equilibrium. It is scientifically grounded, internally consistent, and contains all necessary information for its resolution. I will now proceed with the derivation and analysis.\n\nThe objective is to derive an expression for the fractional receptor occupancy, $\\theta$, for a monovalent receptor-ligand interaction at equilibrium and to analyze its behavior in limiting conditions. The system is described by the reversible reaction between a free receptor, $R$, and a free adhesin (ligand), $L$, to form a receptor-ligand complex, $RL$:\n$$\nR + L \\rightleftharpoons RL\n$$\nThe forward reaction (association) is characterized by the rate constant $k_{\\text{on}}$, and the reverse reaction (dissociation) is characterized by the rate constant $k_{\\text{off}}$.\n\nAccording to the principle of mass-action kinetics, the rate of association, $v_{\\text{on}}$, is proportional to the product of the concentrations of the free reactants:\n$$\nv_{\\text{on}} = k_{\\text{on}} [R] [L]\n$$\nThe rate of dissociation, $v_{\\text{off}}$, is proportional to the concentration of the complex:\n$$\nv_{\\text{off}} = k_{\\text{off}} [RL]\n$$\nAt chemical equilibrium, the net rate of reaction is zero, which means the rate of association equals the rate of dissociation:\n$$\nv_{\\text{on}} = v_{\\text{off}}\n$$\n$$\nk_{\\text{on}} [R] [L] = k_{\\text{off}} [RL]\n$$\nThe problem defines the dissociation constant, $K_D$, as the ratio of the dissociation and association rate constants, $K_D = k_{\\text{off}}/k_{\\text{on}}$. We can rearrange the equilibrium condition to express this relationship:\n$$\n\\frac{k_{\\text{off}}}{k_{\\text{on}}} = \\frac{[R] [L]}{[RL]}\n$$\nTherefore, at equilibrium, the dissociation constant is given by:\n$$\nK_D = \\frac{[R] [L]}{[RL]}\n$$\nThis equation establishes the fundamental relationship between the concentrations of all species at equilibrium. Our goal is to find an expression for the fractional occupancy, $\\theta = [RL]/R_T$, as a function of only $[L]$ and $K_D$.\n\nTo achieve this, we must eliminate $[R]$ and $[RL]$ in favor of $\\theta$, $R_T$, $[L]$, and $K_D$. We are given the mass balance equation for the total receptor concentration, $R_T$:\n$$\nR_T = [R] + [RL]\n$$\nFrom this, we can express the concentration of free receptors, $[R]$, as:\n$$\n[R] = R_T - [RL]\n$$\nNow, we substitute this expression for $[R]$ into the equilibrium equation for $K_D$:\n$$\nK_D = \\frac{(R_T - [RL]) [L]}{[RL]}\n$$\nWe now have an equation that relates $[RL]$ to $R_T$, $[L]$, and $K_D$. We must solve this equation for $[RL]$.\n$$\nK_D [RL] = (R_T - [RL]) [L] = R_T [L] - [RL] [L]\n$$\nTo solve for $[RL]$, we gather all terms containing $[RL]$ on one side of the equation:\n$$\nK_D [RL] + [RL] [L] = R_T [L]\n$$\nFactoring out $[RL]$ yields:\n$$\n[RL] (K_D + [L]) = R_T [L]\n$$\nIsolating $[RL]$ gives the concentration of the receptor-ligand complex:\n$$\n[RL] = \\frac{R_T [L]}{K_D + [L]}\n$$\nThe final step is to compute the fractional receptor occupancy, $\\theta$, which is defined as the ratio of the concentration of occupied receptors to the total concentration of receptors:\n$$\n\\theta = \\frac{[RL]}{R_T}\n$$\nSubstituting our expression for $[RL]$ into this definition, we obtain:\n$$\n\\theta = \\frac{1}{R_T} \\left( \\frac{R_T [L]}{K_D + [L]} \\right) = \\frac{[L]}{K_D + [L]}\n$$\nThis is the required closed-form expression for the fractional receptor occupancy. It is a form of the Langmuir isotherm or Michaelis-Menten equation, fundamental in surface science and enzyme kinetics, respectively. The expression is dimensionless, as $[L]$ and $K_D$ have the same units of concentration.\n\nNext, we analyze the limiting behavior of $\\theta$.\n\nCase 1: Low ligand concentration, $[L] \\ll K_D$.\nIn this regime, the concentration of free adhesin is much smaller than the dissociation constant. In the denominator of the expression for $\\theta$, the term $[L]$ is negligible compared to $K_D$. Thus, we can approximate the denominator as:\n$$\nK_D + [L] \\approx K_D\n$$\nThe fractional occupancy then becomes:\n$$\n\\theta \\approx \\frac{[L]}{K_D}\n$$\nInterpretation: When the concentration of bacterial adhesins is low, the fractional occupancy of host receptors is directly proportional to the adhesin concentration. The binding is inefficient, and the extent of adherence increases linearly with the availability of free adhesins. This means that doubling the adhesin concentration will approximately double the number of bound receptors.\n\nCase 2: High ligand concentration, $[L] \\gg K_D$.\nIn this regime, the concentration of free adhesin is much larger than the dissociation constant. In the denominator, the term $K_D$ is negligible compared to $[L]$:\n$$\nK_D + [L] \\approx [L]\n$$\nThe fractional occupancy then approaches its maximum value:\n$$\n\\theta \\approx \\frac{[L]}{[L]} = 1\n$$\nInterpretation: When the concentration of bacterial adhesins is very high, the host receptors become saturated. The fractional occupancy approaches $1$, meaning nearly all available receptors are bound. At this point, microbial adherence is maximal and is limited by the density of receptors on the host surface ($R_T$), not by the concentration of adhesins. Further increases in adhesin concentration will not lead to a significant increase in receptor-bound bacteria. This saturation effect is a critical concept in understanding dose-response relationships in microbial pathogenesis.", "answer": "$$\n\\boxed{\\frac{[L]}{K_D + [L]}}\n$$", "id": "2493686"}, {"introduction": "Real biological systems are rarely simple, and a key strategy for fighting infection involves disrupting pathogen-host interactions. This practice moves from simple equilibrium to a scenario of competitive inhibition, a core principle behind anti-adhesion therapies. By calculating the concentration of a soluble inhibitor required to significantly reduce bacterial binding, you will apply the principles of mass-action kinetics to a practical, therapeutically relevant problem [@problem_id:2493698].", "problem": "A uropathogenic Escherichia coli expressing Type 1 fimbriae binds to host mannose receptors via the FimH adhesin. Consider a single FimH binding site that can exist in one of three states at equilibrium: free, bound to a surface mannose receptor, or bound to a soluble monovalent mannoside inhibitor. The system is well-mixed at the scale of the molecular capture zone near the host surface, and the law of mass action applies. Adhesion strength is proportional to the fraction of FimH sites that are receptor-bound in equilibrium. The bacterium approaches a planar host surface presenting mannose receptors with surface density $\\sigma_{R}$ and an effective capture depth $z_{\\mathrm{eff}}$ set by the molecular reach of the FimH–mannose interaction; within this capture layer, receptors act as an effective three-dimensional concentration. You are given:\n- Receptor surface density $\\sigma_{R} = 800\\,\\mu\\mathrm{m}^{-2}$,\n- Effective capture depth $z_{\\mathrm{eff}} = 7.0\\,\\mathrm{nm}$,\n- Equilibrium dissociation constant for FimH binding to immobilized mannose $K_{D}^{R} = 5.0\\,\\mu\\mathrm{M}$,\n- Equilibrium dissociation constant for FimH binding to the soluble mannoside inhibitor $K_{D}^{I} = 30\\,\\mathrm{nM}$,\n- Avogadro’s constant $N_{A} = 6.022\\times 10^{23}\\,\\mathrm{mol}^{-1}$.\n\nUsing only equilibrium statistical occupancy and mass-action reasoning, determine the inhibitor concentration $\\left[I\\right]$ required to reduce the equilibrium fraction of receptor-bound FimH (and thus adhesion) to $0.1$ times its value in the absence of inhibitor. Express the final concentration in micromolar and round your answer to three significant figures.", "solution": "The problem requires an analysis of a competitive binding equilibrium. Let the FimH binding site be denoted by $H$, the surface-immobilized mannose receptor by $R$, and the soluble mannoside inhibitor by $I$. The system is governed by two simultaneous equilibria:\n\n$1$. Binding of FimH to the surface receptor:\n$$H + R \\rightleftharpoons HR$$\nThis interaction is characterized by the equilibrium dissociation constant $K_{D}^{R}$:\n$$K_{D}^{R} = \\frac{[H][R]}{[HR]}$$\n\n$2$. Binding of FimH to the soluble inhibitor:\n$$H + I \\rightleftharpoons HI$$\nThis interaction is characterized by the equilibrium dissociation constant $K_{D}^{I}$:\n$$K_{D}^{I} = \\frac{[H][I]}{[HI]}$$\n\nThe total concentration of FimH binding sites, $[H]_{\\text{total}}$, is the sum of the concentrations of the three possible states: free ($[H]$), receptor-bound ($[HR]$), and inhibitor-bound ($[HI]$).\n$$[H]_{\\text{total}} = [H] + [HR] + [HI]$$\n\nThe fraction of FimH sites bound to receptors, $\\theta_{R}$, is defined as the ratio of the concentration of receptor-bound sites to the total concentration of sites.\n$$\\theta_{R} = \\frac{[HR]}{[H]_{\\text{total}}}$$\n\nWe can express $[HR]$ and $[HI]$ in terms of the free FimH concentration $[H]$ using the dissociation constants:\n$$[HR] = \\frac{[H][R]}{K_{D}^{R}}$$\n$$[HI] = \\frac{[H][I]}{K_{D}^{I}}$$\n\nSubstituting these expressions into the equation for $[H]_{\\text{total}}$ gives:\n$$[H]_{\\text{total}} = [H] + \\frac{[H][R]}{K_{D}^{R}} + \\frac{[H][I]}{K_{D}^{I}} = [H] \\left( 1 + \\frac{[R]}{K_{D}^{R}} + \\frac{[I]}{K_{D}^{I}} \\right)$$\n\nNow, we can write the expression for $\\theta_{R}$:\n$$\\theta_{R} = \\frac{\\frac{[H][R]}{K_{D}^{R}}}{[H] \\left( 1 + \\frac{[R]}{K_{D}^{R}} + \\frac{[I]}{K_{D}^{I}} \\right)} = \\frac{\\frac{[R]}{K_{D}^{R}}}{1 + \\frac{[R]}{K_{D}^{R}} + \\frac{[I]}{K_{D}^{I}}}$$\n\nIn the absence of the inhibitor, the inhibitor concentration $[I]$ is zero, and the fraction of receptor-bound sites, which we denote as $\\theta_{R,0}$, is given by:\n$$\\theta_{R,0} = \\frac{\\frac{[R]}{K_{D}^{R}}}{1 + \\frac{[R]}{K_{D}^{R}}}$$\n\nThe problem requires us to find the inhibitor concentration $[I]$ that reduces the fraction of receptor-bound sites to $0.1$ times its value in the absence of inhibitor. This condition is stated as:\n$$\\theta_{R} = 0.1 \\times \\theta_{R,0}$$\n\nSubstituting the expressions for $\\theta_{R}$ and $\\theta_{R,0}$:\n$$\\frac{\\frac{[R]}{K_{D}^{R}}}{1 + \\frac{[R]}{K_{D}^{R}} + \\frac{[I]}{K_{D}^{I}}} = 0.1 \\times \\frac{\\frac{[R]}{K_{D}^{R}}}{1 + \\frac{[R]}{K_{D}^{R}}}$$\n\nSince the effective receptor concentration $[R]$ is not zero, the term $\\frac{[R]}{K_{D}^{R}}$ can be cancelled from the numerators of both sides:\n$$\\frac{1}{1 + \\frac{[R]}{K_{D}^{R}} + \\frac{[I]}{K_{D}^{I}}} = \\frac{0.1}{1 + \\frac{[R]}{K_{D}^{R}}}$$\n\nWe can now solve for $[I]$. Taking the reciprocal of both sides yields:\n$$1 + \\frac{[R]}{K_{D}^{R}} + \\frac{[I]}{K_{D}^{I}} = \\frac{1}{0.1} \\left( 1 + \\frac{[R]}{K_{D}^{R}} \\right) = 10 \\left( 1 + \\frac{[R]}{K_{D}^{R}} \\right)$$\n$$1 + \\frac{[R]}{K_{D}^{R}} + \\frac{[I]}{K_{D}^{I}} = 10 + 10 \\frac{[R]}{K_{D}^{R}}$$\n\nIsolating the term containing $[I]$:\n$$\\frac{[I]}{K_{D}^{I}} = (10 - 1) + (10 - 1) \\frac{[R]}{K_{D}^{R}} = 9 + 9 \\frac{[R]}{K_{D}^{R}} = 9 \\left( 1 + \\frac{[R]}{K_{D}^{R}} \\right)$$\n\nThis gives the final analytical expression for the required inhibitor concentration:\n$$[I] = 9 K_{D}^{I} \\left( 1 + \\frac{[R]}{K_{D}^{R}} \\right)$$\n\nTo proceed with the numerical calculation, we must first determine the effective three-dimensional concentration of receptors, $[R]$. The receptors are confined to a surface with density $\\sigma_{R}$, but they interact with FimH within a volume defined by the effective capture depth $z_{\\text{eff}}$. The molar concentration $[R]$ is the number of moles of receptors per effective volume. For a surface area $A$, the number of receptor molecules is $\\sigma_{R} A$, and the effective volume is $A z_{\\text{eff}}$. The molar concentration is therefore:\n$$[R] = \\frac{\\text{moles}}{\\text{volume}} = \\frac{(\\text{number of molecules}) / N_{A}}{\\text{volume}} = \\frac{(\\sigma_{R} A) / N_{A}}{A z_{\\text{eff}}} = \\frac{\\sigma_{R}}{N_{A} z_{\\text{eff}}}$$\n\nWe are given the following values:\n$\\sigma_{R} = 800\\,\\mu\\mathrm{m}^{-2} = 800 \\times (10^{-6}\\,\\text{m})^{-2} = 8 \\times 10^{14}\\,\\text{m}^{-2}$\n$z_{\\text{eff}} = 7.0\\,\\text{nm} = 7.0 \\times 10^{-9}\\,\\text{m}$\n$N_{A} = 6.022\\times 10^{23}\\,\\mathrm{mol}^{-1}$\n$K_{D}^{R} = 5.0\\,\\mu\\mathrm{M} = 5.0 \\times 10^{-6}\\,\\mathrm{M}$\n$K_{D}^{I} = 30\\,\\text{nM} = 30 \\times 10^{-9}\\,\\mathrm{M} = 3.0 \\times 10^{-8}\\,\\mathrm{M}$\n\nFirst, we calculate $[R]$ in SI units (mol/m³):\n$$[R] = \\frac{8 \\times 10^{14}\\,\\text{m}^{-2}}{(6.022 \\times 10^{23}\\,\\mathrm{mol}^{-1})(7.0 \\times 10^{-9}\\,\\text{m})} \\approx 0.18978\\,\\mathrm{mol} \\cdot \\mathrm{m}^{-3}$$\n\nTo convert this to molarity ($\\mathrm{M}$, or $\\mathrm{mol} \\cdot \\mathrm{L}^{-1}$), we use the conversion factor $1\\,\\mathrm{m}^{3} = 1000\\,\\mathrm{L}$:\n$$[R] = 0.18978\\,\\frac{\\mathrm{mol}}{\\mathrm{m}^{3}} \\times \\frac{1\\,\\mathrm{m}^{3}}{1000\\,\\mathrm{L}} \\approx 1.8978 \\times 10^{-4}\\,\\mathrm{M}$$\n\nNow we can substitute the numerical values into the expression for $[I]$:\n$$[I] = 9 \\times (3.0 \\times 10^{-8}\\,\\mathrm{M}) \\left( 1 + \\frac{1.8978 \\times 10^{-4}\\,\\mathrm{M}}{5.0 \\times 10^{-6}\\,\\mathrm{M}} \\right)$$\n$$[I] = 2.7 \\times 10^{-7}\\,\\mathrm{M} \\left( 1 + 37.956 \\right)$$\n$$[I] = 2.7 \\times 10^{-7}\\,\\mathrm{M} \\left( 38.956 \\right)$$\n$$[I] \\approx 1.0518 \\times 10^{-5}\\,\\mathrm{M}$$\n\nThe problem requires the answer in micromolar ($\\mu\\mathrm{M}$) and rounded to three significant figures.\n$$[I] \\approx 10.518\\,\\mu\\mathrm{M}$$\nRounding to three significant figures gives:\n$$[I] = 10.5\\,\\mu\\mathrm{M}$$\nThis is the concentration of the soluble inhibitor required to reduce adhesion to $10\\%$ of its initial value.", "answer": "$$\\boxed{10.5}$$", "id": "2493698"}, {"introduction": "The fate of a bacterial population in a host is determined not by adhesion alone, but by a dynamic interplay of binding, detachment, and physiological processes like fluid flow and drug clearance. This capstone practice challenges you to integrate these elements into a dynamic computational model to simulate bacterial clearance from the urinary tract. This exercise exemplifies a systems biology approach, connecting molecular-level kinetics with whole-organism physiology to make quantitative predictions about infection outcomes [@problem_id:2493636].", "problem": "You are tasked with writing a program that simulates time-dependent microbial adherence and predicts the time to clearance for uropathogenic bacteria in the urinary bladder under anti-adhesin dosing and urinary flow. The model must be rooted in fundamental kinetic and transport principles in microbiology and biophysics, specifically: reversible adhesion mediated by fimbrial adhesins and pili to urothelial receptors, competitive inhibition of adhesins by an anti-adhesin ligand, and well-mixed bladder transport due to urinary inflow and outflow. The goal is to quantify how the interplay of receptor occupancy, detachment under shear, and washout of planktonic cells collectively influences bacterial clearance.\n\nMechanistic base to use:\n- Reversible binding of fimbrial adhesins to host receptors follows mass action at the population level: transitions between free (planktonic) and bound (adherent) bacteria are governed by an association process and a dissociation process, each represented as a first-order process in the corresponding population.\n- Competitive inhibition (anti-adhesin) reduces the effective association of adhesins with host receptors via receptor occupancy of adhesins by inhibitor at quasi-equilibrium. Let the inhibitor concentration be $I(t)$ and its inhibition constant be $K_{i}$. The fractional occupancy of adhesins by inhibitor is given by the well-tested receptor occupancy relation $ \\theta_{I}(t) = \\dfrac{I(t)}{K_{i} + I(t)}$, and the fraction of unblocked adhesins is $1 - \\theta_{I}(t)$.\n- Detachment is increased by shear resulting from urinary flow. Assume that the effective detachment rate increases linearly with the instantaneous urinary volumetric flow rate $Q(t)$ with proportionality constant $\\alpha$.\n- The bladder is modeled as a continuously stirred tank (well-mixed compartment) of volume $V$ with inflow and outflow both equal to $Q(t)$ at each instant, so that any solute (including the inhibitor) experiences dilution and washout with characteristic rate $Q(t)/V$. The inflowing urine can carry the inhibitor at a time-dependent inflow concentration $C_{\\mathrm{in}}(t)$, which depends on the dosing regimen and pharmacokinetics upstream of the bladder. For a well-mixed tank with inflow concentration $C_{\\mathrm{in}}(t)$ and outflow equal to the tank concentration, the time evolution of the in-tank concentration $I(t)$ obeys standard mass balance for a continuously stirred tank.\n\nYou must use the following state variables and parameters:\n- $B_{b}(t)$: number of bound (adherent) bacteria at time $t$.\n- $B_{f}(t)$: number of free (planktonic) bacteria at time $t$.\n- $I(t)$: anti-adhesin concentration in urine at time $t$ (in $\\mu$M).\n- $k_{\\mathrm{on},0}$: baseline association rate constant (in $\\mathrm{min}^{-1}$).\n- $k_{\\mathrm{off},0}$: baseline dissociation rate constant (in $\\mathrm{min}^{-1}$).\n- $\\alpha$: proportionality constant linking flow to detachment (in $(\\mathrm{mL}/\\mathrm{min})^{-1}$).\n- $K_{i}$: inhibition constant for the anti-adhesin (in $\\mu$M).\n- $Q(t)$: urinary flow rate (in $\\mathrm{mL}/\\mathrm{min}$).\n- $V$: bladder volume (in $\\mathrm{mL}$).\n- $C_{\\mathrm{in}}(t)$: inflow anti-adhesin concentration (in $\\mu$M).\n- $N_{\\mathrm{th}}$: clearance threshold in bacterial count (dimensionless, cells).\n\nModeling requirements to implement:\n- Let the effective association rate be $k_{\\mathrm{on}}(t) = k_{\\mathrm{on},0}\\,\\bigl(1 - \\theta_{I}(t)\\bigr)$ where $\\theta_{I}(t) = \\dfrac{I(t)}{K_{i} + I(t)}$.\n- Let the effective dissociation rate be $k_{\\mathrm{off}}(t) = k_{\\mathrm{off},0}\\,\\bigl(1 + \\alpha\\,Q(t)\\bigr)$.\n- Let the washout rate constant for free bacteria be $w(t) = \\dfrac{Q(t)}{V}$, assuming well-mixed washout of planktonic cells.\n- Use population balance for bound and free bacteria consistent with reversible adhesion and washout of free cells in a well-mixed bladder.\n- The inhibitor concentration dynamics in the bladder must follow the continuously stirred tank mass balance with inflow concentration $C_{\\mathrm{in}}(t)$ and outflow equal to the in-tank concentration under flow $Q(t)$.\n\nSimulation requirements:\n- Integrate the Ordinary Differential Equations (ODEs) using a fixed time step $\\Delta t$ (in $\\mathrm{min}$) with a stable explicit scheme. Ensure non-negativity by clamping any state that would become negative to zero at each step.\n- Define clearance as the earliest time $t$ for which $B_{b}(t) < N_{\\mathrm{th}}$ and $B_{f}(t) < N_{\\mathrm{th}}$. If this does not occur within the simulation horizon $T_{\\max}$, report no clearance for that test case.\n- Express the final time to clearance in hours, rounded to three decimal places. If no clearance within $T_{\\max}$, report the sentinel value $-1.0$ exactly (not rounded to three decimals).\n\nPiecewise-constant profiles:\n- The flow $Q(t)$ and the inflow inhibitor concentration $C_{\\mathrm{in}}(t)$ are specified as default baseline values with a set of closed-open intervals $[t_{\\mathrm{start}}, t_{\\mathrm{end}})$ during which they take specific values. Outside the listed intervals, $Q(t)$ equals its baseline $Q_{0}$, and $C_{\\mathrm{in}}(t)$ equals $0$.\n\nTest suite:\nImplement your program to compute the time to clearance for each of the following test cases. All times are in minutes unless specified otherwise.\n\n- Shared constants unless otherwise stated: $V = 400 \\mathrm{~mL}$, $N_{\\mathrm{th}} = 1$, $\\Delta t = 0.1 \\mathrm{~min}$.\n\n- Test case 1 (happy path, moderate dosing with voiding spikes):\n  - $B_{b}(0) = 2 \\times 10^{6}$, $B_{f}(0) = 1 \\times 10^{6}$.\n  - $k_{\\mathrm{on},0} = 0.01 \\mathrm{~min}^{-1}$, $k_{\\mathrm{off},0} = 0.004 \\mathrm{~min}^{-1}$, $\\alpha = 0.1 \\mathrm{~(\\mathrm{mL}/\\mathrm{min})}^{-1}$, $K_{i} = 10 \\mathrm{~\\mu M}$.\n  - $Q_{0} = 1 \\mathrm{~mL/min}$ and spikes: [60, 62) -> 15; [120, 122) -> 15; [180, 182) -> 15 (all in $\\mathrm{mL}/\\mathrm{min}$).\n  - $C_{\\mathrm{in}}(t)$ segments (in $\\mu$M): [0, 60) -> 100; [180, 240) -> 50; otherwise 0.\n  - $T_{\\max} = 300 \\mathrm{~min}$.\n\n- Test case 2 (boundary: no anti-adhesin, low flow, likely no clearance):\n  - $B_{b}(0) = 2 \\times 10^{6}$, $B_{f}(0) = 1 \\times 10^{6}$.\n  - $k_{\\mathrm{on},0} = 0.01 \\mathrm{~min}^{-1}$, $k_{\\mathrm{off},0} = 0.004 \\mathrm{~min}^{-1}$, $\\alpha = 0.1 \\mathrm{~(\\mathrm{mL}/\\mathrm{min})}^{-1}$, $K_{i} = 10 \\mathrm{~\\mu M}$.\n  - $Q_{0} = 1 \\mathrm{~mL/min}$; no spikes.\n  - $C_{\\mathrm{in}}(t)$: no dosing (identically 0).\n  - $T_{\\max} = 300 \\mathrm{~min}$.\n\n- Test case 3 (edge: sustained high flow without dosing):\n  - $B_{b}(0) = 2 \\times 10^{6}$, $B_{f}(0) = 1 \\times 10^{6}$.\n  - $k_{\\mathrm{on},0} = 0.01 \\mathrm{~min}^{-1}$, $k_{\\mathrm{off},0} = 0.004 \\mathrm{~min}^{-1}$, $\\alpha = 0.1 \\mathrm{~(\\mathrm{mL}/\\mathrm{min})}^{-1}$, $K_{i} = 10 \\mathrm{~\\mu M}$.\n  - $Q_{0} = 5 \\mathrm{~mL/min}$; no spikes.\n  - $C_{\\mathrm{in}}(t)$: no dosing (identically 0).\n  - $T_{\\max} = 300 \\mathrm{~min}$.\n\n- Test case 4 (strong inhibition with low flow):\n  - $B_{b}(0) = 2 \\times 10^{6}$, $B_{f}(0) = 1 \\times 10^{6}$.\n  - $k_{\\mathrm{on},0} = 0.01 \\mathrm{~min}^{-1}$, $k_{\\mathrm{off},0} = 0.004 \\mathrm{~min}^{-1}$, $\\alpha = 0.1 \\mathrm{~(\\mathrm{mL}/\\mathrm{min})}^{-1}$, $K_{i} = 2 \\mathrm{~\\mu M}$.\n  - $Q_{0} = 0.5 \\mathrm{~mL/min}$; no spikes.\n  - $C_{\\mathrm{in}}(t)$ segments (in $\\mu$M): [0, 300) -> 200.\n  - $T_{\\max} = 300 \\mathrm{~min}$.\n\nAngle and unit specifications:\n- Use minutes for internal simulation time and convert the reported times to hours.\n- All flows must be treated in $\\mathrm{mL}/\\mathrm{min}$, concentrations in $\\mu$M, and bacterial counts as dimensionless counts.\n- The program must output the time to clearance for each test case in hours, rounded to three decimal places, except when no clearance occurs within $T_{\\max}$, in which case the output must be the literal $-1.0$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, e.g., $[t_{1},t_{2},t_{3},t_{4}]$, where each $t_{i}$ adheres to the rounding and sentinel rule above.", "solution": "The problem as stated is subjected to rigorous validation and is deemed valid. It is scientifically grounded in established principles of chemical kinetics, biotransport phenomena, and pharmacodynamics. The model is based on mass-action kinetics for reversible bacterial adhesion, competitive inhibition of fimbrial adhesins, and a continuously stirred tank reactor (CSTR) model for the urinary bladder. These are standard and appropriate formalisms for the biological system in question. The problem is well-posed, providing a complete set of parameters, initial conditions, and a clear objective, allowing for the construction of a unique numerical solution. The only minor ambiguity, the initial inhibitor concentration $I(0)$, is resolved by the standard convention that $I(0) = 0$ in the absence of pre-existing drug, which is a reasonable assumption. The problem is objective, free of contradictions, and computationally tractable.\n\nThe system dynamics are described by a set of coupled ordinary differential equations (ODEs). Let $B_b(t)$ be the population of bound bacteria, $B_f(t)$ be the population of free (planktonic) bacteria, and $I(t)$ be the concentration of the anti-adhesin inhibitor.\n\nThe population balance for bound bacteria, $B_b(t)$, is governed by the rate of association of free bacteria and the rate of dissociation of bound bacteria.\nThe rate of association is proportional to the free bacterial population, $B_f(t)$, with an effective rate constant $k_{\\mathrm{on}}(t)$.\nThe rate of dissociation is proportional to the bound bacterial population, $B_b(t)$, with an effective rate constant $k_{\\mathrm{off}}(t)$.\nThus, the differential equation for $B_b(t)$ is:\n$$\n\\frac{dB_b}{dt} = k_{\\mathrm{on}}(t) B_f(t) - k_{\\mathrm{off}}(t) B_b(t)\n$$\n\nThe population balance for free bacteria, $B_f(t)$, includes terms for association, dissociation, and washout from the bladder. The association term is a loss, the dissociation term is a gain, and washout is a loss proportional to $B_f(t)$ with a rate constant $w(t)$.\n$$\n\\frac{dB_f}{dt} = k_{\\mathrm{off}}(t) B_b(t) - k_{\\mathrm{on}}(t) B_f(t) - w(t) B_f(t)\n$$\n\nThe concentration of the inhibitor, $I(t)$, in the well-mixed bladder of constant volume $V$ is described by the standard CSTR mass balance equation. The rate of change of inhibitor mass is the rate of inflow minus the rate of outflow.\n$$\n\\frac{d(I(t)V)}{dt} = C_{\\mathrm{in}}(t) Q(t) - I(t) Q(t)\n$$\nSince the volume $V$ is constant, this simplifies to:\n$$\n\\frac{dI}{dt} = \\frac{Q(t)}{V} \\left(C_{\\mathrm{in}}(t) - I(t)\\right) = w(t) \\left(C_{\\mathrm{in}}(t) - I(t)\\right)\n$$\n\nThe rate constants are defined as follows:\nThe effective association rate, $k_{\\mathrm{on}}(t)$, is reduced by the inhibitor. The fraction of adhesins blocked by the inhibitor at quasi-equilibrium is $\\theta_{I}(t) = \\frac{I(t)}{K_{i} + I(t)}$. The effective association rate constant is therefore:\n$$\nk_{\\mathrm{on}}(t) = k_{\\mathrm{on},0} \\left(1 - \\theta_{I}(t)\\right) = k_{\\mathrm{on},0} \\left(1 - \\frac{I(t)}{K_{i} + I(t)}\\right) = k_{\\mathrm{on},0} \\frac{K_{i}}{K_{i} + I(t)}\n$$\nThe effective dissociation rate, $k_{\\mathrm{off}}(t)$, is enhanced by shear stress from urinary flow $Q(t)$. This is modeled as a linear increase from a baseline rate $k_{\\mathrm{off},0}$:\n$$\nk_{\\mathrm{off}}(t) = k_{\\mathrm{off},0} (1 + \\alpha Q(t))\n$$\nThe washout rate for free bacteria and inhibitor is given by:\n$$\nw(t) = \\frac{Q(t)}{V}\n$$\nThe functions $Q(t)$ and $C_{\\mathrm{in}}(t)$ are given as piecewise-constant functions of time.\n\nTo solve this system of ODEs numerically, we employ the explicit Forward Euler method with a fixed time step $\\Delta t$. Let the state at time $t_n = n \\Delta t$ be $(B_{b,n}, B_{f,n}, I_n)$. The state at the next time step $t_{n+1}$ is computed as:\n$$\nB_{b,n+1} = B_{b,n} + \\Delta t \\left( k_{\\mathrm{on}}(t_n) B_{f,n} - k_{\\mathrm{off}}(t_n) B_{b,n} \\right)\n$$\n$$\nB_{f,n+1} = B_{f,n} + \\Delta t \\left( k_{\\mathrm{off}}(t_n) B_{b,n} - k_{\\mathrm{on}}(t_n) B_{f,n} - w(t_n) B_{f,n} \\right)\n$$\n$$\nI_{n+1} = I_{n} + \\Delta t \\left( w(t_n) (C_{\\mathrm{in}}(t_n) - I_n) \\right)\n$$\nAt each step, the values of $Q(t_n)$ and $C_{\\mathrm{in}}(t_n)$ are determined from their respective piecewise definitions.\nAs specified, to ensure physical non-negativity, any state variable that becomes negative after an update step is clamped to zero: $B_{b,n+1} = \\max(0, B_{b,n+1})$, $B_{f,n+1} = \\max(0, B_{f,n+1})$, and $I_{n+1} = \\max(0, I_{n+1})$.\n\nThe simulation proceeds from $t=0$ up to $T_{\\max}$. At each time step $t_{n+1}$, we check the clearance condition: $B_{b,n+1} < N_{\\mathrm{th}}$ and $B_{f,n+1} < N_{\\mathrm{th}}$. The time to clearance is the first time $t_{n+1}$ for which this condition is met. This time, in minutes, is then converted to hours. If the condition is not met by $T_{\\max}$, no clearance is reported, represented by the value $-1.0$.\n\nThis structured numerical approach correctly implements the specified model and provides a robust method for computing the time to clearance for the given test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and compute time to clearance for each.\n    \"\"\"\n\n    # Shared constants\n    V = 400.0   # mL\n    N_th = 1.0  # cells\n    dt = 0.1    # min\n\n    test_cases = [\n        {\n            \"name\": \"Test Case 1\",\n            \"Bb0\": 2e6, \"Bf0\": 1e6,\n            \"k_on0\": 0.01, \"k_off0\": 0.004, \"alpha\": 0.1, \"Ki\": 10.0,\n            \"Q0\": 1.0, \"Q_intervals\": [(60.0, 62.0, 15.0), (120.0, 122.0, 15.0), (180.0, 182.0, 15.0)],\n            \"C_in0\": 0.0, \"C_in_intervals\": [(0.0, 60.0, 100.0), (180.0, 240.0, 50.0)],\n            \"T_max\": 300.0, \"V\": V, \"N_th\": N_th, \"dt\": dt\n        },\n        {\n            \"name\": \"Test Case 2\",\n            \"Bb0\": 2e6, \"Bf0\": 1e6,\n            \"k_on0\": 0.01, \"k_off0\": 0.004, \"alpha\": 0.1, \"Ki\": 10.0,\n            \"Q0\": 1.0, \"Q_intervals\": [],\n            \"C_in0\": 0.0, \"C_in_intervals\": [],\n            \"T_max\": 300.0, \"V\": V, \"N_th\": N_th, \"dt\": dt\n        },\n        {\n            \"name\": \"Test Case 3\",\n            \"Bb0\": 2e6, \"Bf0\": 1e6,\n            \"k_on0\": 0.01, \"k_off0\": 0.004, \"alpha\": 0.1, \"Ki\": 10.0,\n            \"Q0\": 5.0, \"Q_intervals\": [],\n            \"C_in0\": 0.0, \"C_in_intervals\": [],\n            \"T_max\": 300.0, \"V\": V, \"N_th\": N_th, \"dt\": dt\n        },\n        {\n            \"name\": \"Test Case 4\",\n            \"Bb0\": 2e6, \"Bf0\": 1e6,\n            \"k_on0\": 0.01, \"k_off0\": 0.004, \"alpha\": 0.1, \"Ki\": 2.0,\n            \"Q0\": 0.5, \"Q_intervals\": [],\n            \"C_in0\": 0.0, \"C_in_intervals\": [(0.0, 300.0, 200.0)],\n            \"T_max\": 300.0, \"V\": V, \"N_th\": N_th, \"dt\": dt\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        clearance_time_hr = run_simulation(case)\n        results.append(clearance_time_hr)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef get_piecewise_value(t, intervals, default_value):\n    \"\"\"\n    Returns the value of a piecewise-constant function at time t.\n    intervals is a list of tuples (t_start, t_end, value).\n    \"\"\"\n    for start, end, value in intervals:\n        if start <= t < end:\n            return value\n    return default_value\n\ndef run_simulation(params):\n    \"\"\"\n    Runs a single simulation for a given set of parameters.\n    \"\"\"\n    # Unpack parameters\n    Bb0, Bf0 = params['Bb0'], params['Bf0']\n    k_on0, k_off0, alpha, Ki = params['k_on0'], params['k_off0'], params['alpha'], params['Ki']\n    V, Q0, Q_intervals = params['V'], params['Q0'], params['Q_intervals']\n    C_in0, C_in_intervals = params['C_in0'], params['C_in_intervals']\n    N_th, dt, T_max = params['N_th'], params['dt'], params['T_max']\n\n    # Initial conditions\n    Bb = float(Bb0)\n    Bf = float(Bf0)\n    I = 0.0 # Initial inhibitor concentration is zero\n\n    num_steps = int(T_max / dt)\n\n    for step in range(num_steps):\n        t = step * dt\n\n        # Get time-dependent values\n        Q_t = get_piecewise_value(t, Q_intervals, Q0)\n        C_in_t = get_piecewise_value(t, C_in_intervals, C_in0)\n\n        # Calculate rate constants for the current step\n        # using the state from the beginning of the interval\n        k_on_t = k_on0 * Ki / (Ki + I)\n        k_off_t = k_off0 * (1.0 + alpha * Q_t)\n        w_t = Q_t / V\n\n        # Calculate derivatives\n        dBb_dt = k_on_t * Bf - k_off_t * Bb\n        dBf_dt = k_off_t * Bb - k_on_t * Bf - w_t * Bf\n        dI_dt = w_t * (C_in_t - I)\n\n        # Update state variables using Forward Euler\n        Bb_next = Bb + dt * dBb_dt\n        Bf_next = Bf + dt * dBf_dt\n        I_next = I + dt * dI_dt\n        \n        # Clamp to ensure non-negativity\n        Bb = max(0.0, Bb_next)\n        Bf = max(0.0, Bf_next)\n        I = max(0.0, I_next)\n\n        # Check for clearance condition after the step\n        current_time = (step + 1) * dt\n        if Bb < N_th and Bf < N_th:\n            clearance_time_hr = round(current_time / 60.0, 3)\n            return clearance_time_hr\n\n    return -1.0\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2493636"}]}