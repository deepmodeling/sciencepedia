{"hands_on_practices": [{"introduction": "To quantitatively understand chemotaxis, we must first model the core signaling pathway that processes environmental information. This practice focuses on the crucial phosphorelay system involving the kinase CheA, the response regulator CheY, and the phosphatase CheZ. By applying the principles of mass-action and enzyme kinetics, you will derive the steady-state concentration of the key signaling molecule, phosphorylated CheY (CheY-P), demonstrating how a balance of phosphorylation and dephosphorylation establishes the cell's internal state. [@problem_id:2493997]", "problem": "Escherichia coli chemotaxis regulates flagellar motor bias through the phosphorylation state of the response regulator protein CheY. In a homogeneous environment, assume a well-mixed single-cell volume where the total CheY concentration is fixed at $Y_T$. Define $Y_P$ as the steady-state concentration of phosphorylated CheY (CheY-P), and $Y = Y_T - Y_P$ as the unphosphorylated CheY concentration.\n\nCheA is a histidine kinase whose kinase activity is modulated by receptor inputs. Model the phosphorylation of CheY as a first-order process with an effective phosphorylation rate constant $k_{\\mathrm{ph}} a$, where $k_{\\mathrm{ph}}$ is a base rate constant and $a \\in [0,1]$ is the dimensionless CheA activity. Thus, the phosphorylation flux is $J_{\\mathrm{ph}} = k_{\\mathrm{ph}} a (Y_T - Y_P)$.\n\nCheZ is a dedicated phosphatase for CheY-P and operates as an enzyme. Let the total CheZ concentration be $Z_T$, and let the CheZ-catalyzed dephosphorylation of CheY-P proceed via the standard enzyme scheme with association and dissociation rate constants $k_1$ and $k_{-1}$ and catalytic turnover $k_{\\mathrm{cat}}$, producing a Michaelis-Menten constant $K_M = (k_{-1} + k_{\\mathrm{cat}})/k_1$. Starting from mass-action kinetics for the elementary enzyme steps and using the quasi-steady-state approximation for the enzyme-substrate complex, derive the Michaelis-Menten (MM) form for the CheZ-catalyzed dephosphorylation flux of CheY-P, $J_{\\mathrm{dephos}}$, in terms of $k_{\\mathrm{cat}}$, $K_M$, $Z_T$, and $Y_P$.\n\nThen, by imposing the steady-state condition that the net production of CheY-P is zero, derive a closed-form analytical expression for the steady-state $Y_P$ as a function of the parameters $a$, $Y_T$, $Z_T$, $k_{\\mathrm{ph}}$, $k_{\\mathrm{cat}}$, and $K_M$. Express your final answer as a single simplified expression in terms of these parameters only. Do not include units in your final expression. If you introduce any intermediate variables, eliminate them in the final expression so that only $a$, $Y_T$, $Z_T$, $k_{\\mathrm{ph}}$, $k_{\\mathrm{cat}}$, and $K_M$ appear. Provide the principal biologically admissible branch (nonnegative and not exceeding $Y_T$) of the solution.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a standard model of a core biochemical circuit in bacterial chemotaxis and requests a rigorous derivation of a steady-state concentration. The premises are consistent and sufficient for a unique, physically meaningful solution. We will proceed with the derivation.\n\nThe problem requires two sequential derivations. First, we must derive the Michaelis-Menten (MM) form for the dephosphorylation flux, $J_{\\mathrm{dephos}}$. Second, using this result, we must derive the steady-state concentration of phosphorylated CheY, $Y_P$.\n\nPart 1: Derivation of the dephosphorylation flux $J_{\\mathrm{dephos}}$.\n\nThe dephosphorylation of CheY-P (the substrate, $S$) is catalyzed by the phosphatase CheZ (the enzyme, $E$). The process forms an enzyme-substrate complex ($ES$) and releases unphosphorylated CheY ($P$) and inorganic phosphate. The elementary steps are given by the mass-action kinetic scheme:\n$$ E + S \\xrightarrow{k_1} ES $$\n$$ ES \\xrightarrow{k_{-1}} E + S $$\n$$ ES \\xrightarrow{k_{\\mathrm{cat}}} E + P $$\nThe concentrations are $[S] = Y_P$, $[E] = [CheZ]$, $[E]_T = Z_T$. The concentration of the enzyme-substrate complex is $[ES]$.\n\nThe rate of change of the enzyme-substrate complex concentration is given by:\n$$ \\frac{d[ES]}{dt} = k_1 [E][S] - k_{-1}[ES] - k_{\\mathrm{cat}}[ES] $$\nConservation of total enzyme concentration $Z_T$ dictates that $[E] = Z_T - [ES]$. Substituting this into the rate equation gives:\n$$ \\frac{d[ES]}{dt} = k_1 (Z_T - [ES])Y_P - (k_{-1} + k_{\\mathrm{cat}})[ES] $$\nThe problem specifies the use of the quasi-steady-state approximation (QSSA), which assumes that the concentration of the intermediate complex $[ES]$ changes much more slowly than the substrate and product concentrations, such that $\\frac{d[ES]}{dt} \\approx 0$. Applying this approximation:\n$$ k_1 (Z_T - [ES])Y_P = (k_{-1} + k_{\\mathrm{cat}})[ES] $$\nWe now solve for the steady-state concentration of the complex, $[ES]$:\n$$ k_1 Z_T Y_P - k_1 [ES] Y_P = (k_{-1} + k_{\\mathrm{cat}})[ES] $$\n$$ k_1 Z_T Y_P = (k_1 Y_P + k_{-1} + k_{\\mathrm{cat}})[ES] $$\n$$ [ES] = \\frac{k_1 Z_T Y_P}{k_1 Y_P + k_{-1} + k_{\\mathrm{cat}}} $$\nTo arrive at the familiar MM form, we divide the numerator and denominator by $k_1$:\n$$ [ES] = \\frac{Z_T Y_P}{Y_P + \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}} $$\nThe problem defines the Michaelis constant as $K_M = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}$. Substituting this definition yields:\n$$ [ES] = \\frac{Z_T Y_P}{Y_P + K_M} $$\nThe dephosphorylation flux, $J_{\\mathrm{dephos}}$, is the rate of product formation, which is $J_{\\mathrm{dephos}} = k_{\\mathrm{cat}}[ES]$. Thus:\n$$ J_{\\mathrm{dephos}} = \\frac{k_{\\mathrm{cat}} Z_T Y_P}{K_M + Y_P} $$\nThis is the required Michaelis-Menten form for the dephosphorylation flux.\n\nPart 2: Derivation of the steady-state concentration $Y_P$.\n\nAt steady state, the production rate of CheY-P must equal its removal rate. The phosphorylation flux is given as $J_{\\mathrm{ph}} = k_{\\mathrm{ph}} a (Y_T - Y_P)$. Setting $J_{\\mathrm{ph}} = J_{\\mathrm{dephos}}$:\n$$ k_{\\mathrm{ph}} a (Y_T - Y_P) = \\frac{k_{\\mathrm{cat}} Z_T Y_P}{K_M + Y_P} $$\nTo solve for $Y_P$, we rearrange this equation into a polynomial form.\n$$ k_{\\mathrm{ph}} a (Y_T - Y_P)(K_M + Y_P) = k_{\\mathrm{cat}} Z_T Y_P $$\nExpanding the left side:\n$$ k_{\\mathrm{ph}} a (Y_T K_M + Y_T Y_P - K_M Y_P - Y_P^2) = k_{\\mathrm{cat}} Z_T Y_P $$\nGrouping terms by powers of $Y_P$:\n$$ -k_{\\mathrm{ph}} a Y_P^2 + (k_{\\mathrm{ph}} a Y_T - k_{\\mathrm{ph}} a K_M - k_{\\mathrm{cat}} Z_T) Y_P + k_{\\mathrm{ph}} a Y_T K_M = 0 $$\nTo obtain a standard quadratic form $AY_P^2 + BY_P + C = 0$ with a positive leading coefficient, we multiply the entire equation by $-1$:\n$$ k_{\\mathrm{ph}} a Y_P^2 + (k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a K_M - k_{\\mathrm{ph}} a Y_T) Y_P - k_{\\mathrm{ph}} a Y_T K_M = 0 $$\nThe coefficients of this quadratic equation are:\n$$ A = k_{\\mathrm{ph}} a $$\n$$ B = k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a K_M - k_{\\mathrm{ph}} a Y_T $$\n$$ C = -k_{\\mathrm{ph}} a Y_T K_M $$\nThe solution for $Y_P$ is given by the quadratic formula:\n$$ Y_P = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A} $$\nWe must select the physically admissible root. All parameters ($k_{\\mathrm{ph}}, a, Y_T, K_M, k_{\\mathrm{cat}}, Z_T$) are non-negative. Therefore, $A \\ge 0$ and $C \\le 0$. The product of the two roots is $Y_{P,1}Y_{P,2} = C/A = -Y_T K_M \\le 0$. This implies one root is non-negative and the other is non-positive. Since $Y_P$ represents a concentration, it must be non-negative. Thus, we must select the non-negative root.\n\nThe discriminant is $\\Delta = B^2 - 4AC = B^2 - 4(k_{\\mathrm{ph}}a)(-k_{\\mathrm{ph}} a Y_T K_M) = B^2 + 4(k_{\\mathrm{ph}} a)^2 Y_T K_M$. Since $4AC \\le 0$, we have $\\Delta \\ge B^2$, which implies $\\sqrt{\\Delta} \\ge |B|$.\nThe root with the `+` sign is $\\frac{-B + \\sqrt{\\Delta}}{2A}$. Its numerator is greater than or equal to $-B + |B|$, which is always non-negative.\nThe root with the `-` sign is $\\frac{-B - \\sqrt{\\Delta}}{2A}$. Its numerator is less than or equal to $-B - |B|$, which is always non-positive.\nTherefore, the unique non-negative, biologically admissible solution is the one with the `+` sign.\nSubstituting the expressions for $A$, $B$, and $C$:\n$$ Y_P = \\frac{-(k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a K_M - k_{\\mathrm{ph}} a Y_T) + \\sqrt{(k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a K_M - k_{\\mathrm{ph}} a Y_T)^2 - 4(k_{\\mathrm{ph}} a)(-k_{\\mathrm{ph}} a Y_T K_M)}}{2 k_{\\mathrm{ph}} a} $$\nSimplifying the expression under the square root:\n$$ Y_P = \\frac{-(k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a (K_M - Y_T)) + \\sqrt{(k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a (K_M - Y_T))^2 + 4(k_{\\mathrm{ph}} a)^2 Y_T K_M}}{2 k_{\\mathrm{ph}} a} $$\nThis expression represents the steady-state concentration $Y_P$ in terms of the specified parameters. A graphical analysis of the rate balance equation confirms that this solution lies in the interval $[0, Y_T]$, satisfying the physical constraints.", "answer": "$$\n\\boxed{\\frac{-(k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a (K_M - Y_T)) + \\sqrt{(k_{\\mathrm{cat}} Z_T + k_{\\mathrm{ph}} a (K_M - Y_T))^2 + 4(k_{\\mathrm{ph}} a)^2 Y_T K_M}}{2 k_{\\mathrm{ph}} a}}\n$$", "id": "2493997"}, {"introduction": "With a model for the CheY-P signal in hand, we now explore how this biochemical signal controls the physical output of the flagellar motor. This exercise uses a powerful yet elegant two-state statistical mechanics model to connect the concentration of CheY-P to the motor's rotational bias. You will see how the binding of CheY-P shifts the free-energy landscape of the motor's switch complex, thereby dictating the probability of clockwise versus counterclockwise rotation. [@problem_id:2494011]", "problem": "A chemotactic rotary motor in a bacterium such as Escherichia coli toggles between two conformational states that drive clockwise (CW) and counterclockwise (CCW) rotation. Consider a two-state equilibrium model in which the CW and CCW basins have Gibbs free energies $G_{\\mathrm{CW}}$ and $G_{\\mathrm{CCW}}$, respectively. Assume the system is at thermal equilibrium at temperature $T$, so that the state occupancies follow the Boltzmann distribution with inverse thermal energy $\\beta = 1/(k_{B} T)$, where $k_{B}$ is the Boltzmann constant. Define the free-energy difference as $\\Delta G \\equiv G_{\\mathrm{CCW}} - G_{\\mathrm{CW}}$, and suppose that phosphorylation of the response regulator CheY (phosphorylated CheY, CheY-P) shifts this free-energy difference approximately linearly with the CheY-P concentration due to binding, such that\n$$\n\\Delta G = E_{0} + \\gamma \\,[\\text{CheY-P}],\n$$\nwhere $E_{0}$ is the baseline offset at zero CheY-P and $\\gamma$ is a sensitivity coefficient.\n\nFrom single-motor switching experiments, a global fit (with energies expressed in units of thermal energy so that $\\beta = 1$) yields the parameters $E_{0} = -2.70$ and $\\gamma = 0.90 \\,\\mu\\text{M}^{-1}$. In a cell with a steady-state CheY-P concentration of $[\\text{CheY-P}] = 3.50 \\,\\mu\\text{M}$ at the same temperature, use the two-state equilibrium framework to determine the CW bias, defined as the long-time fraction of time the motor spends in the CW state.\n\nDerive your expression for the CW bias $B$ starting from the Boltzmann distribution, then evaluate it numerically with the given parameters. Round your final numerical answer to $4$ significant figures. Report the result as a pure number (no units). Angle units are not relevant to this problem.", "solution": "The problem is first subjected to rigorous validation.\n\n**Step 1: Extract Givens**\n-   Model: A two-state equilibrium model for a chemotactic rotary motor (CW and CCW states).\n-   State Energies: Gibbs free energies $G_{\\mathrm{CW}}$ and $G_{\\mathrm{CCW}}$.\n-   System Temperature: $T$.\n-   Inverse Thermal Energy: $\\beta = 1/(k_{B} T)$, where $k_{B}$ is the Boltzmann constant.\n-   Free-Energy Difference: $\\Delta G \\equiv G_{\\mathrm{CCW}} - G_{\\mathrm{CW}}$.\n-   Dependence of $\\Delta G$ on CheY-P concentration: $\\Delta G = E_{0} + \\gamma \\,[\\text{CheY-P}]$.\n-   Given Parameters: The problem states that energies are expressed in units of thermal energy, meaning we are given the dimensionless quantities $\\beta E_{0} = -2.70$ and $\\beta \\gamma = 0.90 \\,\\mu\\text{M}^{-1}$.\n-   Steady-State Concentration: $[\\text{CheY-P}] = 3.50 \\,\\mu\\text{M}$.\n-   Objective: Determine the CW bias, defined as the long-time fraction of time the motor spends in the CW state.\n-   Numerical Precision: Round the final answer to $4$ significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding:** The problem is based on the well-established Monod-Wyman-Changeux (MWC) model as applied to the bacterial flagellar motor switch. This is a canonical model in quantitative biology and biophysics. The linear approximation for the free energy shift due to ligand binding is standard. The parameters are physically realistic. The problem is scientifically sound.\n-   **Well-Posedness:** The problem provides all necessary definitions, equations, and parameter values to uniquely determine the CW bias. It is self-contained and unambiguous.\n-   **Objectivity:** The problem is stated in precise, objective language without subjective or non-scientific content.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\nThe derivation proceeds from the fundamental principles of statistical mechanics. For a system in thermal equilibrium at temperature $T$, the probability $P_i$ of occupying a state $i$ with energy $G_i$ is given by the Boltzmann distribution:\n$$\nP_i = \\frac{\\exp(-\\beta G_i)}{Z}\n$$\nwhere $\\beta = 1/(k_{B}T)$ is the inverse thermal energy and $Z$ is the partition function, which is the sum of the Boltzmann factors over all possible states. For this two-state system (CW and CCW), the partition function is:\n$$\nZ = \\exp(-\\beta G_{\\mathrm{CW}}) + \\exp(-\\beta G_{\\mathrm{CCW}})\n$$\nThe CW bias, denoted $B$, is defined as the long-time fraction of time the motor spends in the CW state. For an ergodic system at equilibrium, this is equivalent to the probability of finding the motor in the CW state, $P_{\\mathrm{CW}}$. Therefore,\n$$\nB = P_{\\mathrm{CW}} = \\frac{\\exp(-\\beta G_{\\mathrm{CW}})}{Z} = \\frac{\\exp(-\\beta G_{\\mathrm{CW}})}{\\exp(-\\beta G_{\\mathrm{CW}}) + \\exp(-\\beta G_{\\mathrm{CCW}})}\n$$\nTo express this in terms of the free-energy difference $\\Delta G = G_{\\mathrm{CCW}} - G_{\\mathrm{CW}}$, we can divide the numerator and denominator by $\\exp(-\\beta G_{\\mathrm{CW}})$:\n$$\nB = \\frac{1}{1 + \\frac{\\exp(-\\beta G_{\\mathrm{CCW}})}{\\exp(-\\beta G_{\\mathrm{CW}})}} = \\frac{1}{1 + \\exp(-\\beta (G_{\\mathrm{CCW}} - G_{\\mathrm{CW}}))} = \\frac{1}{1 + \\exp(-\\beta \\Delta G)}\n$$\nAlternatively, multiplying the numerator and denominator by $\\exp(\\beta \\Delta G)$ yields an equivalent and often more convenient form:\n$$\nB = \\frac{\\exp(\\beta \\Delta G)}{1 + \\exp(\\beta \\Delta G)}\n$$\nThe problem specifies the dependence of $\\Delta G$ on the concentration of phosphorylated CheY, $[\\text{CheY-P}]$, as:\n$$\n\\Delta G = E_{0} + \\gamma \\,[\\text{CheY-P}]\n$$\nWe are interested in the dimensionless quantity $\\beta \\Delta G$:\n$$\n\\beta \\Delta G = \\beta E_{0} + \\beta \\gamma \\,[\\text{CheY-P}]\n$$\nThe problem provides the values of the dimensionless parameters directly: $\\beta E_{0} = -2.70$ and $\\beta \\gamma = 0.90 \\,\\mu\\text{M}^{-1}$. We are also given the concentration $[\\text{CheY-P}] = 3.50 \\,\\mu\\text{M}$.\n\nWe can now compute the value of $\\beta \\Delta G$:\n$$\n\\beta \\Delta G = -2.70 + (0.90 \\,\\mu\\text{M}^{-1}) \\times (3.50 \\,\\mu\\text{M})\n$$\n$$\n\\beta \\Delta G = -2.70 + (0.90 \\times 3.50)\n$$\n$$\n\\beta \\Delta G = -2.70 + 3.15\n$$\n$$\n\\beta \\Delta G = 0.45\n$$\nThis dimensionless energy difference is positive, indicating that the CCW state has a higher free energy than the CW state under these conditions, thus favoring the CW state.\n\nNow, we substitute this value into the expression for the CW bias $B$:\n$$\nB = \\frac{\\exp(0.45)}{1 + \\exp(0.45)}\n$$\nEvaluating the exponential term:\n$$\n\\exp(0.45) \\approx 1.568312\n$$\nSubstituting this numerical value back into the expression for $B$:\n$$\nB \\approx \\frac{1.568312}{1 + 1.568312} = \\frac{1.568312}{2.568312} \\approx 0.6106339\n$$\nThe problem requires the answer to be rounded to $4$ significant figures.\n$$\nB \\approx 0.6106\n$$\nThis result is the CW bias of the motor.", "answer": "$$\n\\boxed{0.6106}\n$$", "id": "2494011"}, {"introduction": "The theoretical models we've explored rely on biophysical parameters such as energy offsets, cooperativity, and kinetic rates. This final practice bridges the gap between theory and experiment by tackling the challenge of parameter inference from data. By implementing a maximum likelihood estimation based on a continuous-time Markov model of motor switching, you will learn a fundamental technique in quantitative biology for extracting meaningful parameter values from time-series observations. [@problem_id:2494022]", "problem": "You are given a physical and statistical modeling task grounded in bacterial flagellar motor switching. A single flagellar motor alternates between clockwise (CW) and counterclockwise (CCW) rotation. Model the switching as a continuous-time, two-state Markov process with concentration-dependent transition rates. Let the rate to switch from CCW to CW be denoted by $k_{\\mathrm{CW}}([Y])$ and the rate to switch from CW to CCW be denoted by $k_{\\mathrm{CCW}}([Y])$, where $[Y]$ is the concentration of phosphorylated CheY (CheY-P). Assume the following foundational principles and definitions apply: the process is a time-homogeneous continuous-time Markov chain (CTMC), and dwell times in a state are exponentially distributed with parameter equal to the outgoing rate from that state. The ratio of the transition rates is related to an effective energy function $\\Delta G([Y])$ by the formula $k_{\\mathrm{CW}}([Y]) / k_{\\mathrm{CCW}}([Y]) = e^{-\\Delta G([Y])}$. Assume a thermodynamic ansatz for this energy function of the form $\\Delta G([Y]) = \\Delta G_b + n \\ln([Y]/[Y]_0)$, where $[Y]_0 = 1\\,\\mu\\text{M}$ is a reference concentration, $n$ is a dimensionless cooperativity parameter, and $\\Delta G_b$ is a dimensionless baseline energy offset expressed in units of Boltzmann constant times absolute temperature ($k_B T$). Finally, assume that the sum of transition rates is independent of concentration, namely $k_{\\mathrm{CW}}([Y]) + k_{\\mathrm{CCW}}([Y]) = k_{\\mathrm{sum}}$, where $k_{\\mathrm{sum}}$ is a constant with units $(\\mathrm{s}^{-1})$.\n\nYour program must infer the parameters $n$, $\\Delta G_b$, and $k_{\\mathrm{sum}}$ by maximum likelihood, using only the sufficient statistics of single-motor time series under fixed $[Y]$: for each condition $i$ with concentration $[Y]_i$, you are provided the total time spent in CW, $T_{\\mathrm{CW},i}$ (in $\\mathrm{s}$), the total time spent in CCW, $T_{\\mathrm{CCW},i}$ (in $\\mathrm{s}$), the number of observed transitions from CW to CCW, $N_{\\mathrm{CW}\\to\\mathrm{CCW},i}$, and the number of observed transitions from CCW to CW, $N_{\\mathrm{CCW}\\to\\mathrm{CW},i}$. You should derive the likelihood from first principles starting from the exponential dwell time model and the CTMC structure, incorporating the constraints given above, and then maximize it over the parameters $(n,\\Delta G_b,k_{\\mathrm{sum}})$.\n\nUse natural logarithms for all $\\ln(\\cdot)$ expressions. Concentrations $[Y]$ are given in micromolar ($\\mu\\text{M}$). Time is in seconds ($\\mathrm{s}$). Report $k_{\\mathrm{sum}}$ in $(\\mathrm{s}^{-1})$. Report $n$ and $\\Delta G_b$ as dimensionless quantities. Your program must output the maximum likelihood estimates rounded to three decimal places.\n\nTest Suite. Fit the model separately to each of the following three datasets. Each dataset contains several concentration conditions; for each condition, the tuple gives $([Y], N_{\\mathrm{CW}\\to\\mathrm{CCW}}, T_{\\mathrm{CW}}, N_{\\mathrm{CCW}\\to\\mathrm{CW}}, T_{\\mathrm{CCW}})$, where $[Y]$ is in $\\mu\\text{M}$ and times are in $\\mathrm{s}$.\n\n- Dataset A:\n  - $([1.5], 61, 362.4, 61, 37.6)$\n  - $([3.0], 169, 151.0, 169, 249.0)$\n  - $([6.0], 25, 14.6, 25, 385.4)$\n\n- Dataset B:\n  - $([1.0], 82, 277.95, 82, 22.05)$\n  - $([2.0], 257, 206.91, 257, 93.09)$\n  - $([4.0], 244, 84.9, 244, 215.1)$\n\n- Dataset C:\n  - $([0.5], 5, 492.3, 5, 7.7)$\n  - $([1.0], 75, 250.0, 75, 250.0)$\n  - $([2.0], 5, 7.7, 5, 492.3)$\n\nYour program should fit $(n,\\Delta G_b,k_{\\mathrm{sum}})$ independently for Dataset A, independently for Dataset B, and independently for Dataset C. The required final output format is a single line containing a flat list with nine numbers in the following order: $n_{\\mathrm{A}}, \\Delta G_{b,\\mathrm{A}}, k_{\\mathrm{sum},\\mathrm{A}}, n_{\\mathrm{B}}, \\Delta G_{b,\\mathrm{B}}, k_{\\mathrm{sum},\\mathrm{B}}, n_{\\mathrm{C}}, \\Delta G_{b,\\mathrm{C}}, k_{\\mathrm{sum},\\mathrm{C}}$, each rounded to three decimal places. For example, an acceptable format is like $[1.234,-0.567,3.890,2.468,-1.357,4.680,5.000,0.000,0.600]$. Ensure your program produces exactly one line with the results as a comma-separated list enclosed in square brackets, with no extra spaces.\n\nExpress $k_{\\mathrm{sum}}$ in $(\\mathrm{s}^{-1})$, rounded to three decimals. Express $n$ and $\\Delta G_b$ as dimensionless numbers, rounded to three decimals.", "solution": "The problem requires finding the maximum likelihood estimates for the parameters of a biophysical model of bacterial flagellar motor switching. The model is a two-state, continuous-time Markov chain describing transitions between a counter-clockwise (CCW) and a clockwise (CW) state.\n\nFirst, the problem statement must be validated.\n**Step 1: Extract Givens**\n- **Model**: Two-state (CCW, CW) continuous-time Markov chain (CTMC).\n- **Transition Rates**:\n    - CCW to CW: $k_{\\mathrm{CW}}([Y])$\n    - CW to CCW: $k_{\\mathrm{CCW}}([Y])$\n    - $[Y]$ is the concentration of CheY-P in $\\mu\\text{M}$.\n- **Assumptions & Constraints**:\n    1.  Dwell times are exponentially distributed. Dwell time in CCW is $\\sim\\mathrm{Exp}(k_{\\mathrm{CW}}([Y]))$. Dwell time in CW is $\\sim\\mathrm{Exp}(k_{\\mathrm{CCW}}([Y]))$.\n    2.  The sum of rates is constant: $k_{\\mathrm{CW}}([Y]) + k_{\\mathrm{CCW}}([Y]) = k_{\\mathrm{sum}}$.\n    3.  A thermodynamic ansatz for the free energy difference (in units of $k_B T$): $\\Delta G([Y]) = \\Delta G_b + n \\ln([Y]/[Y]_0)$, where $[Y]_0 = 1\\,\\mu\\text{M}$.\n    4.  The model specifies that the rate ratio is $k_{\\mathrm{CW}}([Y]) / k_{\\mathrm{CCW}}([Y]) = e^{-\\Delta G([Y])}$.\n- **Data (Sufficient Statistics)**: For each concentration $[Y]_i$, the following are provided:\n    - $T_{\\mathrm{CW},i}$: total time in CW state (s).\n    - $T_{\\mathrm{CCW},i}$: total time in CCW state (s).\n    - $N_{\\mathrm{CW}\\to\\mathrm{CCW},i}$: number of transitions from CW to CCW.\n    - $N_{\\mathrm{CCW}\\to\\mathrm{CW},i}$: number of transitions from CCW to CW.\n- **Task**: For three separate datasets (A, B, C), infer the parameters $(n, \\Delta G_b, k_{\\mathrm{sum}})$ by maximum likelihood estimation.\n- **Output**: Report the nine estimated parameters ($n$, $\\Delta G_b$, $k_{\\mathrm{sum}}$ for each dataset), rounded to three decimal places, in a specific flat list format.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically sound. It describes a standard, well-established framework for modeling stochastic two-state systems, widely applied in biophysics and specifically in the study of bacterial chemotaxis. The provided data (sufficient statistics for a CTMC) are precisely what is needed to formulate the likelihood function. The problem is well-posed, objective, and contains no internal contradictions or ambiguities. It is a non-trivial statistical inference task requiring numerical optimization.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Derivation of the Likelihood Function**\nFor a two-state CTMC, the likelihood of observing $N_{\\mathrm{CCW}\\to\\mathrm{CW}}$ transitions out of the CCW state over a total time $T_{\\mathrm{CCW}}$, and $N_{\\mathrm{CW}\\to\\mathrm{CCW}}$ transitions out of the CW state over a total time $T_{\\mathrm{CW}}$, is the product of the likelihoods for two independent Poisson processes. The likelihood for a single experimental condition $i$ at concentration $[Y]_i$ is:\n$$L_i(k_{\\mathrm{CW},i}, k_{\\mathrm{CCW},i}) = \\left( k_{\\mathrm{CW},i}^{N_{\\mathrm{CCW}\\to\\mathrm{CW},i}} e^{-k_{\\mathrm{CW},i} T_{\\mathrm{CCW},i}} \\right) \\left( k_{\\mathrm{CCW},i}^{N_{\\mathrm{CW}\\to\\mathrm{CCW},i}} e^{-k_{\\mathrm{CCW},i} T_{\\mathrm{CW},i}} \\right)$$\nThe problem gives data where $N_{\\mathrm{CCW}\\to\\mathrm{CW},i} = N_{\\mathrm{CW}\\to\\mathrm{CCW},i}$. Let's denote this count by $N_i$. The log-likelihood for condition $i$ is:\n$$\\ell_i(k_{\\mathrm{CW},i}, k_{\\mathrm{CCW},i}) = N_i \\ln(k_{\\mathrm{CW},i}) - k_{\\mathrm{CW},i} T_{\\mathrm{CCW},i} + N_i \\ln(k_{\\mathrm{CCW},i}) - k_{\\mathrm{CCW},i} T_{\\mathrm{CW},i}$$\nThe total log-likelihood for a dataset is $\\ell = \\sum_i \\ell_i$.\n\n**Parameterizing the Rates**\nWe must express the rates $k_{\\mathrm{CW},i}$ and $k_{\\mathrm{CCW},i}$ in terms of the fundamental parameters $(n, \\Delta G_b, k_{\\mathrm{sum}})$.\nThe model specifies that the rates are related by the equations: $k_{\\mathrm{CW}}([Y]) / k_{\\mathrm{CCW}}([Y]) = e^{-\\Delta G([Y])}$ and $k_{\\mathrm{CW}}([Y]) + k_{\\mathrm{CCW}}([Y]) = k_{\\mathrm{sum}}$.\nwhere $\\Delta G_i = \\Delta G_b + n \\ln([Y]_i)$ since $[Y]_0=1$.\n\nSolving this system for the rates yields:\n$$k_{\\mathrm{CW}}([Y]_i) = \\frac{k_{\\mathrm{sum}}}{1 + e^{\\Delta G_i}} = \\frac{k_{\\mathrm{sum}}}{1 + e^{\\Delta G_b + n \\ln[Y]_i}}$$\n$$k_{\\mathrm{CCW}}([Y]_i) = \\frac{k_{\\mathrm{sum}} e^{\\Delta G_i}}{1 + e^{\\Delta G_i}} = \\frac{k_{\\mathrm{sum}} e^{\\Delta G_b + n \\ln[Y]_i}}{1 + e^{\\Delta G_b + n \\ln[Y]_i}}$$\nThese can also be written as $k_{\\mathrm{CCW},i} = k_{\\mathrm{sum}} - k_{\\mathrm{CW},i}$.\n\n**Maximum Likelihood Estimation**\nThe goal is to find the parameters $\\theta = (n, \\Delta G_b, k_{\\mathrm{sum}})$ that maximize the total log-likelihood $\\ell(\\theta) = \\sum_i \\ell_i(\\theta)$. This is a numerical optimization problem. We will implement a function for the negative log-likelihood and use a numerical minimizer from the `scipy.optimize` library to find the optimal parameters.\n\nThe negative log-likelihood function to be minimized is:\n$$\\mathcal{L}(\\theta) = -\\ell(\\theta) = -\\sum_{i} \\left[ N_i \\ln(k_{\\mathrm{CW},i}) - k_{\\mathrm{CW},i} T_{\\mathrm{CCW},i} + N_i \\ln(k_{\\mathrm{CCW},i}) - k_{\\mathrm{CCW},i} T_{\\mathrm{CW},i} \\right]$$\nwhere $k_{\\mathrm{CW},i}$ and $k_{\\mathrm{CCW},i}$ are functions of $\\theta$ and $[Y_i]$ as defined above.\n\n**Optimization Strategy**\nFor each dataset, we will:\n1.  Define the negative log-likelihood function that takes a parameter vector `(n, delta_gb, k_sum)` and the dataset as input.\n2.  Provide a good initial guess for the parameters to the optimizer. An initial guess can be obtained by a simplified linear regression approach. The model implies $\\ln(T_{\\mathrm{CW},i}/T_{\\mathrm{CCW},i}) \\approx -\\Delta G_b - n \\ln([Y]_i)$. A linear fit of $\\ln(T_{\\mathrm{CW},i}/T_{\\mathrm{CCW},i})$ versus $\\ln([Y]_i)$ yields initial estimates for $n$ and $\\Delta G_b$. An initial guess for $k_{\\mathrm{sum}}$ is the average of the empirical sum of rates, $\\frac{1}{M}\\sum_i (N_i/T_{\\mathrm{CW},i} + N_i/T_{\\mathrm{CCW},i})$.\n3.  Use `scipy.optimize.minimize` with a suitable algorithm (e.g., L-BFGS-B, which allows for bounds like $k_{\\mathrm{sum}} > 0$) to find the parameter values that minimize the negative log-likelihood.\n4.  The results will be collected and formatted as required.\n\nThis procedure is carried out independently for each of the three datasets.", "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves for the maximum likelihood estimates of a bacterial flagellar motor\n    switching model for three separate datasets.\n    \"\"\"\n    \n    # Define the three datasets\n    # Format: ([Y], N_cw_ccw, T_cw, N_ccw_cw, T_ccw)\n    # Note: N_cw_ccw and N_ccw_cw are identical in the problem, denoted as N.\n    dataset_a = [\n        (1.5, 61, 362.4, 61, 37.6),\n        (3.0, 169, 151.0, 169, 249.0),\n        (6.0, 25, 14.6, 25, 385.4)\n    ]\n\n    dataset_b = [\n        (1.0, 82, 277.95, 82, 22.05),\n        (2.0, 257, 206.91, 257, 93.09),\n        (4.0, 244, 84.9, 244, 215.1)\n    ]\n\n    dataset_c = [\n        (0.5, 5, 492.3, 5, 7.7),\n        (1.0, 75, 250.0, 75, 250.0),\n        (2.0, 5, 7.7, 5, 492.3)\n    ]\n\n    datasets = [dataset_a, dataset_b, dataset_c]\n    all_results = []\n\n    for data in datasets:\n        \n        # Prepare data for fitting\n        # Unpack the list of tuples for easier access\n        Y, _, T_cw, N, T_ccw = zip(*data)\n        fit_data = {\n            'Y': np.array(Y),\n            'N': np.array(N),\n            'T_cw': np.array(T_cw),\n            'T_ccw': np.array(T_ccw)\n        }\n\n        # Define the negative log-likelihood function\n        def neg_log_likelihood(params, data_dict):\n            n, delta_gb, k_sum = params\n            \n            # Unpack data\n            Y_vals = data_dict['Y']\n            N_vals = data_dict['N']\n            T_cw_vals = data_dict['T_cw']\n            T_ccw_vals = data_dict['T_ccw']\n\n            # Calculate model-predicted rates for each condition\n            delta_g = delta_gb + n * np.log(Y_vals)\n            \n            # To avoid overflow in exp(delta_g), we use a stable formulation\n            # k_cw = k_sum / (1 + exp(delta_g))\n            # k_ccw = k_sum / (1 + exp(-delta_g))\n            k_cw = k_sum / (1.0 + np.exp(delta_g))\n            k_ccw = k_sum - k_cw\n            \n            # Check for invalid values which can occur during optimization\n            if np.any(k_cw <= 0) or np.any(k_ccw <= 0):\n                return np.inf\n\n            # Calculate the log-likelihood for each data point\n            log_L_i = (\n                N_vals * np.log(k_cw) - k_cw * T_ccw_vals +\n                N_vals * np.log(k_ccw) - k_ccw * T_cw_vals\n            )\n\n            # Total negative log-likelihood\n            return -np.sum(log_L_i)\n\n        # Generate a good initial guess (p0) for the optimizer\n        log_Y = np.log(fit_data['Y'])\n        # Handle cases where T_ccw is very small to avoid division by zero\n        # Add a small epsilon if needed, though not required for these datasets\n        log_ratio_T = np.log(fit_data['T_cw'] / fit_data['T_ccw'])\n        \n        # Linear fit: log_ratio_T = -n*log_Y - delta_gb\n        # slope = -n, intercept = -delta_gb\n        m, c = np.polyfit(log_Y, log_ratio_T, 1)\n        n0 = -m\n        delta_gb0 = -c\n\n        # Initial guess for k_sum from empirical rates\n        k_sum_empirical = (fit_data['N'] / fit_data['T_ccw']) + (fit_data['N'] / fit_data['T_cw'])\n        k_sum0 = np.mean(k_sum_empirical)\n        \n        p0 = [n0, delta_gb0, k_sum0]\n\n        # Define bounds for the parameters (k_sum must be positive)\n        bounds = [(-np.inf, np.inf), (-np.inf, np.inf), (1e-9, np.inf)]\n        \n        # Perform the minimization\n        result = optimize.minimize(neg_log_likelihood, p0, args=(fit_data,), \n                                   method='L-BFGS-B', bounds=bounds)\n        \n        n_fit, delta_gb_fit, k_sum_fit = result.x\n        \n        # Append results rounded to three decimal places\n        all_results.extend([\n            round(n_fit, 3),\n            round(delta_gb_fit, 3),\n            round(k_sum_fit, 3)\n        ])\n\n    # Format the final output string\n    output_str = f\"[{','.join(map(str, all_results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2494022"}]}