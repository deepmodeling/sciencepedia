{"hands_on_practices": [{"introduction": "Our exploration begins with mucosal immunity, a critical first line of defense where the humoral response is paramount. This exercise [@problem_id:2501248] models the transport of Immunoglobulin A (IgA) across epithelial barriers, a core process in protecting surfaces like the gut and airways. By applying the principles of saturable, receptor-mediated transport, which are analogous to Michaelis-Menten kinetics in enzymology, you can quantitatively assess how cytokine stimulation enhances this crucial antibody secretion pathway.", "problem": "In the mucosal epithelium, polymeric Immunoglobulin A (pIgA) secreted by plasma cells binds the polymeric immunoglobulin receptor (pIgR) on the basolateral surface of epithelial cells and undergoes transcytosis to the lumen, contributing to humoral immunity. It is empirically well established that pIgR-mediated transcytosis of pIgA is a saturable, receptor-limited process that follows the same steady-state assumptions as enzyme-mediated saturable transport. Assume that the half-saturation parameter is constant under the conditions below and denote it by $K_{m}$, that the maximal transport capacity is $V_{\\max}$, and that the substrate is the basolateral concentration of polymeric Immunoglobulin A, $[p\\mathrm{IgA}]$.\n\nConsider the following baseline and cytokine-stimulated conditions:\n- Baseline parameters: $[p\\mathrm{IgA}]_{0}=0.30\\,\\mu\\mathrm{M}$, $V_{\\max,0}=0.90$ (arbitrary flux units), and $K_{m}=0.15\\,\\mu\\mathrm{M}$.\n- Stimulated parameters: T helper cell activity increases plasma cell output so that $[p\\mathrm{IgA}]$ rises threefold to $[p\\mathrm{IgA}]_{1}=0.90\\,\\mu\\mathrm{M}$, and interferon-gamma increases pIgR expression so that $V_{\\max}$ increases by a factor of $1.6$ to $V_{\\max,1}=1.44$; $K_{m}$ remains unchanged.\n\nUsing a standard steady-state saturable transport framework appropriate for receptor-mediated transcytosis, compute the fold-change (new-to-old ratio) in secreted Immunoglobulin A flux from baseline to the stimulated condition, expressed as a dimensionless decimal. Round your answer to four significant figures.", "solution": "The problem statement must first be validated for scientific soundness, consistency, and objectivity.\n\n**Step 1: Extracted Givens**\n- The transport process is described as receptor-mediated, saturable, and following steady-state assumptions analogous to enzyme kinetics.\n- The transport flux, $J$, is a function of the maximal transport capacity, $V_{\\max}$, the substrate concentration, $[p\\mathrm{IgA}]$, and the half-saturation parameter, $K_{m}$.\n- Baseline parameters:\n  - $[p\\mathrm{IgA}]_{0} = 0.30\\,\\mu\\mathrm{M}$\n  - $V_{\\max,0} = 0.90$ (arbitrary flux units)\n  - $K_{m} = 0.15\\,\\mu\\mathrm{M}$\n- Stimulated parameters:\n  - $[p\\mathrm{IgA}]_{1} = 0.90\\,\\mu\\mathrm{M}$\n  - $V_{\\max,1} = 1.44$ (arbitrary flux units)\n  - $K_{m}$ is unchanged, so $K_{m} = 0.15\\,\\mu\\mathrm{M}$.\n- Task: Compute the fold-change in flux, defined as the ratio of the stimulated flux to the baseline flux, rounded to four significant figures.\n\n**Step 2: Validation**\n- **Scientifically Grounded:** The problem describes pIgA transcytosis via pIgR, a fundamental process in mucosal immunity. Modeling this saturable, receptor-limited process with Michaelis-Menten kinetics is a standard and valid approach in quantitative biology and biophysics. The stated effects of T helper cells and interferon-gamma are consistent with established immunological principles.\n- **Well-Posed:** The problem provides all necessary parameters and a clear objective. The relationships between variables are defined, allowing for the calculation of a unique solution.\n- **Objective:** The problem is stated using precise, quantitative language, free of subjectivity or ambiguity.\n- **Flaws Check:** The problem does not violate any of the specified criteria for invalidity. It is self-contained, consistent, scientifically sound, and formalizable. The values provided are consistent with the multiplicative factors described (e.g., $0.90\\,\\mu\\mathrm{M} = 3 \\times 0.30\\,\\mu\\mathrm{M}$ and $1.44 = 1.6 \\times 0.90$).\n\n**Step 3: Verdict**\nThe problem is valid. A solution will be provided.\n\nThe transport process is described as following the steady-state assumptions of enzyme-mediated saturable transport. This directs the use of the Michaelis-Menten equation to model the flux, $J$, of polymeric Immunoglobulin A (pIgA). The equation is:\n$$J = \\frac{V_{\\max} [p\\mathrm{IgA}]}{K_{m} + [p\\mathrm{IgA}]}$$\nwhere $J$ represents the transport flux, $V_{\\max}$ is the maximal transport capacity, $[p\\mathrm{IgA}]$ is the concentration of the substrate (pIgA), and $K_{m}$ is the half-saturation constant.\n\nFirst, we calculate the flux under baseline conditions, denoted as $J_{0}$, using the provided baseline parameters: $[p\\mathrm{IgA}]_{0}=0.30\\,\\mu\\mathrm{M}$, $V_{\\max,0}=0.90$ arbitrary units, and $K_{m}=0.15\\,\\mu\\mathrm{M}$.\n$$J_{0} = \\frac{V_{\\max,0} [p\\mathrm{IgA}]_{0}}{K_{m} + [p\\mathrm{IgA}]_{0}}$$\nSubstituting the numerical values:\n$$J_{0} = \\frac{(0.90)(0.30)}{0.15 + 0.30} = \\frac{0.27}{0.45} = 0.60$$\nThe baseline flux is $J_{0} = 0.60$ in arbitrary flux units.\n\nNext, we calculate the flux under stimulated conditions, denoted as $J_{1}$, using the stimulated parameters: $[p\\mathrm{IgA}]_{1}=0.90\\,\\mu\\mathrm{M}$, $V_{\\max,1}=1.44$ arbitrary units, and the unchanged $K_{m}=0.15\\,\\mu\\mathrm{M}$.\n$$J_{1} = \\frac{V_{\\max,1} [p\\mathrm{IgA}]_{1}}{K_{m} + [p\\mathrm{IgA}]_{1}}$$\nSubstituting the numerical values:\n$$J_{1} = \\frac{(1.44)(0.90)}{0.15 + 0.90} = \\frac{1.296}{1.05}$$\nThis fraction evaluates to approximately $1.2342857...$ arbitrary flux units.\n\nThe problem requires the computation of the fold-change in flux, which is the ratio of the stimulated flux to the baseline flux, $\\frac{J_{1}}{J_{0}}$.\n$$\\text{Fold-change} = \\frac{J_{1}}{J_{0}} = \\frac{\\frac{1.296}{1.05}}{0.60} = \\frac{1.296}{1.05 \\times 0.60} = \\frac{1.296}{0.63}$$\nTo compute this precisely, we can use fractional arithmetic:\n$$\\frac{J_{1}}{J_{0}} = \\frac{\\frac{(1.44)(0.90)}{1.05}}{\\frac{(0.90)(0.30)}{0.45}} = \\frac{1.44 \\times 0.90 \\times 0.45}{1.05 \\times 0.90 \\times 0.30} = \\frac{1.44 \\times 0.45}{1.05 \\times 0.30} = \\frac{0.648}{0.315}$$\n$$\\frac{0.648}{0.315} = \\frac{648}{315}$$\nBoth numerator and denominator are divisible by $9$: $648 = 9 \\times 72$ and $315 = 9 \\times 35$.\n$$\\frac{J_{1}}{J_{0}} = \\frac{72}{35}$$\nConverting this exact fraction to a decimal gives:\n$$\\frac{72}{35} \\approx 2.0571428...$$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $2.057$. The fifth significant figure is $1$, so we round down.\nThe fold-change is $2.057$.", "answer": "$$\\boxed{2.057}$$", "id": "2501248"}, {"introduction": "We now shift our focus to the heart of cell-mediated immunity: the T cell's extraordinary ability to distinguish foreign peptides from self-peptides. This practice [@problem_id:2501321] invites you to derive the celebrated kinetic proofreading model from first principles, providing a mechanistic explanation for the high fidelity of T-cell receptor (TCR) recognition. This exercise demonstrates how a cascade of simple biochemical steps can powerfully amplify subtle differences in ligand-receptor interaction times into a definitive activation or rejection signal.", "problem": "A T cell receptor (TCR) in the cell-mediated arm of the adaptive immune system distinguishes peptides presented by major histocompatibility complex (MHC) molecules through a kinetic proofreading cascade. In a simplified kinetic proofreading model, once a ligand binds, the receptor-ligand complex attempts to traverse a sequence of $n$ irreversible biochemical steps, each occurring with constant rate $k$. The ligand dissociates stochastically with constant rate $1/\\tau$, where $\\tau$ is the mean dwell time of the receptor-ligand complex. Activation is triggered only if all $n$ steps are completed before dissociation; if dissociation occurs at any intermediate step, the attempt fails and the process resets.\n\nConsider two ligands, $L_1$ and $L_2$, that differ only in their dwell times $\\tau_1$ and $\\tau_2$, with $\\tau_1 > \\tau_2$, and that engage the same T cell receptor under identical cellular conditions (same $n$ and $k$). Using as a starting point only the properties of exponential waiting-time processes and the memoryless property of Poisson processes, derive from first principles the activation probability $P_{\\mathrm{act}}(\\tau)$ for a ligand with dwell time $\\tau$, and then compute the ratio\n$$\nR(n,k,\\tau_1,\\tau_2) \\equiv \\frac{P_{\\mathrm{act}}(\\tau_1)}{P_{\\mathrm{act}}(\\tau_2)}.\n$$\nExpress your final result as a single closed-form analytic expression in terms of $n$, $k$, $\\tau_1$, and $\\tau_2$. State, based on your expression, how increasing $n$ modulates specificity between $L_1$ and $L_2$. Report the final ratio as a dimensionless expression. No rounding is required.", "solution": "The problem as stated will be validated against criteria of scientific soundness and logical consistency before any attempt at a solution is made.\n\nFirst, we extract the given information verbatim.\n- A model for T cell receptor (TCR) activation is described as a kinetic proofreading cascade.\n- A receptor-ligand complex must traverse a sequence of $n$ irreversible biochemical steps.\n- Each step occurs with a constant rate $k$.\n- The ligand dissociates with a constant rate $1/\\tau$, where $\\tau$ is the mean dwell time.\n- Activation occurs only if all $n$ steps are completed before dissociation.\n- Two ligands, $L_1$ and $L_2$, engage the same TCR under identical conditions (same $n$ and $k$).\n- The ligands differ only in their dwell times, $\\tau_1$ and $\\tau_2$, with the explicit condition $\\tau_1 > \\tau_2$.\n- The task is to derive the activation probability $P_{\\mathrm{act}}(\\tau)$ from first principles, then compute the ratio $R(n,k,\\tau_1,\\tau_2) \\equiv \\frac{P_{\\mathrm{act}}(\\tau_1)}{P_{\\mathrm{act}}(\\tau_2)}$.\n- The derivation must start from the properties of exponential waiting-time processes and the memoryless property of Poisson processes.\n- The final result for the ratio must be a single closed-form analytic expression.\n- An explanation of how $n$ modulates specificity is also required.\n\nThe problem is scientifically grounded. The kinetic proofreading model is a canonical and well-established theoretical framework in immunology used to explain the high specificity of T-cell activation. The model is well-posed, providing all necessary parameters ($n$, $k$, $\\tau_1$, $\\tau_2$) and a clear objective. It is expressed in precise, objective language and does not contain any scientific falsehoods, contradictions, or ambiguities. The problem is therefore deemed valid and a solution may be pursued.\n\nThe process of activation involves a competition between two independent stochastic processes: the successful completion of a biochemical step and the dissociation of the ligand.\nLet us consider the state of the receptor-ligand complex at any of the intermediate stages, before all $n$ steps are complete. The complex can undergo one of two mutually exclusive events:\n$1$. It can proceed to the next biochemical step. This is a Poisson process occurring with rate $k$.\n$2$. The ligand can dissociate from the receptor. This is also a Poisson process occurring with rate $1/\\tau$.\n\nBecause these two processes are independent, the time until the *next* event occurs (either a step forward or a dissociation) is governed by an exponential distribution with a total rate equal to the sum of the individual rates, $k_{\\mathrm{total}} = k + 1/\\tau$.\n\nThe memoryless property of Poisson processes is crucial here. The probability that the next event is a forward step, rather than a dissociation, depends only on the relative rates of these two competing processes. This probability, let us call it $p_{\\mathrm{step}}$, is given by the ratio of the rate of the forward step to the total rate of all possible events:\n$$\np_{\\mathrm{step}} = \\frac{k}{k + 1/\\tau}\n$$\nThis can be rewritten by multiplying the numerator and denominator by $\\tau$:\n$$\np_{\\mathrm{step}} = \\frac{k\\tau}{k\\tau + 1}\n$$\nFor the T cell to become activated, the complex must successfully complete not just one, but all $n$ biochemical steps in sequence without dissociating. Since each step is an independent probabilistic trial (due to the memoryless nature of the underlying processes), the total probability of activation, $P_{\\mathrm{act}}(\\tau)$, is the probability of one successful step, $p_{\\mathrm{step}}$, raised to the power of the number of steps, $n$.\n$$\nP_{\\mathrm{act}}(\\tau) = (p_{\\mathrm{step}})^n = \\left( \\frac{k\\tau}{k\\tau + 1} \\right)^n\n$$\nThis expression provides the activation probability for a ligand with a given mean dwell time $\\tau$.\n\nWe are now required to compute the ratio $R(n,k,\\tau_1,\\tau_2)$ for two ligands, $L_1$ and $L_2$, with dwell times $\\tau_1$ and $\\tau_2$, respectively.\nThe activation probabilities for each ligand are:\n$$\nP_{\\mathrm{act}}(\\tau_1) = \\left( \\frac{k\\tau_1}{k\\tau_1 + 1} \\right)^n\n$$\n$$\nP_{\\mathrm{act}}(\\tau_2) = \\left( \\frac{k\\tau_2}{k\\tau_2 + 1} \\right)^n\n$$\nThe ratio $R$ is defined as their quotient:\n$$\nR(n,k,\\tau_1,\\tau_2) = \\frac{P_{\\mathrm{act}}(\\tau_1)}{P_{\\mathrm{act}}(\\tau_2)} = \\frac{\\left( \\frac{k\\tau_1}{k\\tau_1 + 1} \\right)^n}{\\left( \\frac{k\\tau_2}{k\\tau_2 + 1} \\right)^n}\n$$\nWe can combine the terms under a single exponent:\n$$\nR = \\left( \\frac{k\\tau_1}{k\\tau_1 + 1} \\cdot \\frac{k\\tau_2 + 1}{k\\tau_2} \\right)^n\n$$\nThe rate constant $k$ cancels from the numerator and denominator of the fraction being multiplied, leading to the final closed-form expression:\n$$\nR = \\left( \\frac{\\tau_1(k\\tau_2 + 1)}{\\tau_2(k\\tau_1 + 1)} \\right)^n\n$$\nThis expression is dimensionless, as required.\n\nFinally, we are asked to analyze how increasing the number of proofreading steps, $n$, modulates the specificity of the response. Specificity in this context is the ability of the system to preferentially respond to ligand $L_1$ over $L_2$. This is quantified by the ratio $R$. A larger value of $R$ signifies greater specificity for $L_1$.\n\nLet us examine the base of the exponent in the expression for $R$:\n$$\nB = \\frac{\\tau_1(k\\tau_2 + 1)}{\\tau_2(k\\tau_1 + 1)}\n$$\nWe are given that $\\tau_1 > \\tau_2$. We can check if $B > 1$:\n$$\n\\frac{\\tau_1(k\\tau_2 + 1)}{\\tau_2(k\\tau_1 + 1)} > 1\n$$\n$$\n\\tau_1(k\\tau_2 + 1) > \\tau_2(k\\tau_1 + 1)\n$$\n$$\nk\\tau_1\\tau_2 + \\tau_1 > k\\tau_1\\tau_2 + \\tau_2\n$$\n$$\n\\tau_1 > \\tau_2\n$$\nThis inequality is true according to the problem statement. Therefore, the base $B$ of the power is strictly greater than $1$. Since $R = B^n$ and $B > 1$, the ratio $R$ is an exponentially increasing function of $n$.\n\nThis means that increasing the number of proofreading steps, $n$, amplifies the difference in activation probabilities between the ligand with a longer dwell time ($\\tau_1$) and the one with a shorter dwell time ($\\tau_2$). Even a small difference in the base $B$ (i.e., a small difference in dwell times) can be magnified into a very large difference in activation outcome by increasing $n$. Thus, increasing $n$ enhances the specificity of T-cell discrimination.", "answer": "$$\n\\boxed{\\left( \\frac{\\tau_1 (k \\tau_2 + 1)}{\\tau_2 (k \\tau_1 + 1)} \\right)^{n}}\n$$", "id": "2501321"}, {"introduction": "Finally, we adopt a systems-level perspective to understand how the immune system orchestrates the balance between humoral and cell-mediated responses. In this problem [@problem_id:2501263], you will analyze a dynamical systems model of T helper cell differentiation, representing the central regulatory switch that directs this fundamental choice. By computing the steady states of this network and analyzing their stability, you will gain insight into how different cytokine environments can program the immune system to favor either cell-killing (Th1) or antibody-producing (Th2) phenotypes.", "problem": "You are to formalize and analyze a minimal dynamical systems model for reciprocal differentiation of T helper (Th) subsets under cytokine influence, focusing on humoral and cell-mediated responses. Consider two state variables: the normalized Th1 transcription factor level $x$ and the normalized Th2 transcription factor level $y$. Let Interleukin (IL)-$12$ be the exogenous cytokine input that promotes Th1, and Interleukin (IL)-$4$ be the exogenous cytokine input that promotes Th2. Assume the following:\n\n1. Fundamental base: Under the Central Dogma and receptor-ligand signaling principles, cytokine-stimulated transcriptional activity increases monotonically with cytokine concentration and saturates due to limited receptor occupancy. Degradation and dilution of transcription factors follow first-order kinetics. Each lineage exerts linear cross-inhibition on the other lineage’s transcription factor.\n\n2. Model structure: With the above assumptions, the system is modeled as\n$$\n\\dot{x} = F_{12}([\\mathrm{IL}\\text{-}12]) - g\\,x - h\\,y, \\quad \n\\dot{y} = F_{4}([\\mathrm{IL}\\text{-}4]) - g'\\,y - h'\\,x,\n$$\nwhere $g>0$ and $g'>0$ are first-order loss rates, and $h \\ge 0$, $h' \\ge 0$ are cross-inhibition strengths.\n\n3. Cytokine-response functions: Let the production functions be Hill-type saturating responses derived from receptor occupancy,\n$$\nF_{12}(z) = V_{\\max,x}\\,\\frac{z^{n_x}}{K_x^{n_x}+z^{n_x}}, \\quad \nF_{4}(z) = V_{\\max,y}\\,\\frac{z^{n_y}}{K_y^{n_y}+z^{n_y}},\n$$\nwith $V_{\\max,x}>0$, $V_{\\max,y}>0$, $K_x>0$, $K_y>0$, $n_x \\ge 1$, and $n_y \\ge 1$. The cytokine concentrations $[\\mathrm{IL}\\text{-}12]$ and $[\\mathrm{IL}\\text{-}4]$ are given in $\\mathrm{ng}\\,\\mathrm{mL}^{-1}$. The states $x$ and $y$ are dimensionless normalized levels.\n\nTasks:\n\nA. For each specified parameter set (test case), compute the unique steady state $(x^\\ast, y^\\ast)$ by solving $\\dot{x}=0$ and $\\dot{y}=0$:\n$$\n\\begin{bmatrix}\ng & h\\\\\nh' & g'\n\\end{bmatrix}\n\\begin{bmatrix}\nx^\\ast\\\\\ny^\\ast\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nF_{12}([\\mathrm{IL}\\text{-}12])\\\\\nF_{4}([\\mathrm{IL}\\text{-}4])\n\\end{bmatrix},\n$$\nprovided the determinant $\\Delta = g\\,g' - h\\,h'$ is nonzero.\n\nB. Determine linear stability of the steady state by analyzing the Jacobian\n$$\nJ =\n\\begin{bmatrix}\n-g & -h\\\\\n-h' & -g'\n\\end{bmatrix}.\n$$\nBased on linear systems theory, the equilibrium is asymptotically stable if and only if both eigenvalues of $J$ have negative real parts, which is equivalent to the conditions $g>0$, $g'>0$, and $\\Delta = g\\,g' - h\\,h' > 0$.\n\nC. Classify the steady-state outcome using the rule:\n- Return class code $1$ (Th1-dominant) if $x^\\ast - y^\\ast > \\delta$,\n- Return class code $2$ (Th2-dominant) if $y^\\ast - x^\\ast > \\delta$,\n- Return class code $0$ (balanced) otherwise,\nwith decision threshold $\\delta = 0.05$ (dimensionless).\n\nNumerical reporting requirements:\n- Report $x^\\ast$ and $y^\\ast$ as floating-point numbers rounded to six decimal places (dimensionless).\n- Report stability as a boolean: $True$ if stable, $False$ otherwise.\n- Report the class code as an integer in $\\{0,1,2\\}$.\n- Angles are not used. No percentages are used.\n\nTest suite:\nFor each test case, parameters are given as an ordered tuple\n$$ ([\\mathrm{IL}\\text{-}12],\\,[\\mathrm{IL}\\text{-}4],\\,g,\\,g',\\,h,\\,h',\\,V_{\\max,x},\\,V_{\\max,y},\\,K_x,\\,K_y,\\,n_x,\\,n_y) $$\nwith cytokines in $\\mathrm{ng}\\,\\mathrm{mL}^{-1}$ and all other parameters dimensionless, except $K_x$ and $K_y$ which have the same unit as cytokine concentrations. Use the following six cases:\n- Case $1$: $(2.0,\\,2.0,\\,1.0,\\,1.0,\\,0.2,\\,0.2,\\,1.0,\\,1.0,\\,2.0,\\,2.0,\\,2,\\,2)$\n- Case $2$: $(5.0,\\,1.0,\\,1.0,\\,1.0,\\,0.2,\\,0.2,\\,1.0,\\,1.0,\\,2.0,\\,2.0,\\,2,\\,2)$\n- Case $3$: $(1.0,\\,5.0,\\,1.0,\\,1.0,\\,0.2,\\,0.2,\\,1.0,\\,1.0,\\,2.0,\\,2.0,\\,2,\\,2)$\n- Case $4$: $(5.0,\\,5.0,\\,1.0,\\,1.0,\\,0.2,\\,0.2,\\,1.2,\\,1.0,\\,2.0,\\,2.0,\\,2,\\,2)$\n- Case $5$: $(5.0,\\,5.0,\\,0.5,\\,0.5,\\,0.499,\\,0.4999,\\,1.0,\\,1.0,\\,2.0,\\,2.0,\\,2,\\,2)$\n- Case $6$: $(2.0,\\,2.0,\\,0.5,\\,0.5,\\,0.6,\\,0.6,\\,1.0,\\,1.0,\\,2.0,\\,2.0,\\,2,\\,2)$\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each entry corresponds to one test case, in the same order as above, and must be a list of the form $[x^\\ast,y^\\ast,\\text{is\\_stable},\\text{class\\_code}]$. For example, the overall structure must look like\n$[[x^\\ast_1,y^\\ast_1,\\text{is\\_stable}_1,\\text{class\\_code}_1],[x^\\ast_2,y^\\ast_2,\\text{is\\_stable}_2,\\text{class\\_code}_2],\\dots]$,\nwith $x^\\ast_i$ and $y^\\ast_i$ rounded to six decimal places, $\\text{is\\_stable}_i \\in \\{\\text{True},\\text{False}\\}$, and $\\text{class\\_code}_i \\in \\{0,1,2\\}$.", "solution": "The problem statement is subjected to rigorous validation before a solution is attempted.\n\n### Step 1: Extract Givens\nThe provided information is as follows:\n\n- **State Variables**: Normalized Th1 transcription factor level $x$; normalized Th2 transcription factor level $y$.\n- **Exogenous Inputs**: Interleukin (IL)-$12$ concentration, $[\\mathrm{IL}\\text{-}12]$; Interleukin (IL)-$4$ concentration, $[\\mathrm{IL}\\text{-}4]$.\n- **Dynamical System Model**:\n$$\n\\dot{x} = F_{12}([\\mathrm{IL}\\text{-}12]) - g\\,x - h\\,y \\\\\n\\dot{y} = F_{4}([\\mathrm{IL}\\text{-}4]) - g'\\,y - h'\\,x\n$$\n- **Parameters**: First-order loss rates $g>0$ and $g'>0$; cross-inhibition strengths $h \\ge 0$ and $h' \\ge 0$.\n- **Cytokine-Response Functions (Hill-type)**:\n$$\nF_{12}(z) = V_{\\max,x}\\,\\frac{z^{n_x}}{K_x^{n_x}+z^{n_x}} \\\\\nF_{4}(z) = V_{\\max,y}\\,\\frac{z^{n_y}}{K_y^{n_y}+z^{n_y}}\n$$\n- **Hill Function Parameters**: $V_{\\max,x}>0$, $V_{\\max,y}>0$, $K_x>0$, $K_y>0$, $n_x \\ge 1$, $n_y \\ge 1$.\n- **Steady State Equation**: for a steady state $(x^\\ast, y^\\ast)$, where $\\dot{x}=0$ and $\\dot{y}=0$:\n$$\n\\begin{bmatrix}\ng & h\\\\\nh' & g'\n\\end{bmatrix}\n\\begin{bmatrix}\nx^\\ast\\\\\ny^\\ast\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nF_{12}([\\mathrm{IL}\\text{-}12])\\\\\nF_{4}([\\mathrm{IL}\\text{-}4])\n\\end{bmatrix}\n$$\n- **Condition for Unique Solution**: The determinant of the coefficient matrix, $\\Delta = g\\,g' - h\\,h'$, must be nonzero.\n- **Stability Analysis**: The Jacobian matrix of the system is:\n$$\nJ =\n\\begin{bmatrix}\n-g & -h\\\\\n-h' & -g'\n\\end{bmatrix}\n$$\nThe equilibrium is asymptotically stable if and only if $g>0$, $g'>0$, and $\\Delta = g\\,g' - h\\,h' > 0$.\n- **Classification Rule**:\n  - Class $1$ (Th1-dominant) if $x^\\ast - y^\\ast > \\delta$.\n  - Class $2$ (Th2-dominant) if $y^\\ast - x^\\ast > \\delta$.\n  - Class $0$ (balanced) otherwise.\n- **Decision Threshold**: $\\delta = 0.05$.\n- **Test Cases**: Six parameter sets are given as tuples $([\\mathrm{IL}\\text{-}12],\\,[\\mathrm{IL}\\text{-}4],\\,g,\\,g',\\,h,\\,h',\\,V_{\\max,x},\\,V_{\\max,y},\\,K_x,\\,K_y,\\,n_x,\\,n_y)$:\n  1. $(2.0,\\,2.0,\\,1.0,\\,1.0,\\,0.2,\\,0.2,\\,1.0,\\,1.0,\\,2.0,\\,2.0,\\,2,\\,2)$\n  2. $(5.0,\\,1.0,\\,1.0,\\,1.0,\\,0.2,\\,0.2,\\,1.0,\\,1.0,\\,2.0,\\,2.0,\\,2,\\,2)$\n  3. $(1.0,\\,5.0,\\,1.0,\\,1.0,\\,0.2,\\,0.2,\\,1.0,\\,1.0,\\,2.0,\\,2.0,\\,2,\\,2)$\n  4. $(5.0,\\,5.0,\\,1.0,\\,1.0,\\,0.2,\\,0.2,\\,1.2,\\,1.0,\\,2.0,\\,2.0,\\,2,\\,2)$\n  5. $(5.0,\\,5.0,\\,0.5,\\,0.5,\\,0.499,\\,0.4999,\\,1.0,\\,1.0,\\,2.0,\\,2.0,\\,2,\\,2)$\n  6. $(2.0,\\,2.0,\\,0.5,\\,0.5,\\,0.6,\\,0.6,\\,1.0,\\,1.0,\\,2.0,\\,2.0,\\,2,\\,2)$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the required criteria.\n\n- **Scientifically Grounded**: The model is a standard representation of a genetic switch, using ordinary differential equations with Michaelis-Menten or Hill-type kinetics for production and first-order kinetics for degradation. This is a common and valid simplification in systems biology to study network motifs. The concepts of cross-inhibition, cytokine signaling, and transcriptional regulation are fundamental to immunology. The problem is scientifically sound.\n- **Well-Posed**: The problem is specified with mathematical precision. The system of equations is defined, the tasks are clear (solve a linear system, check stability conditions, apply a classification rule), and all parameters are provided for each case. The condition for the existence of a unique steady-state solution ($\\Delta \\neq 0$) is explicitly stated.\n- **Objective**: The problem is formulated in objective, technical language. The classification is based on a quantitative rule, not subjective interpretation.\n- **Completeness and Consistency**: The problem is self-contained. All equations, parameters, and analysis criteria are provided. The derivation of the steady-state equation from the dynamical system is correct. The stability conditions are standard Routh-Hurwitz criteria for a $2 \\times 2$ linear system. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid as it is scientifically grounded, well-posed, objective, and self-contained. A solution will be constructed.\n\n### Solution\nThe task is to find the unique steady state of the provided linear system, analyze its stability, and classify the outcome for six different parameter sets. The methodology is as follows.\n\nFirst, for each test case, we compute the constant production terms, which are the outputs of the cytokine-response functions. Let $S_x = F_{12}([\\mathrm{IL}\\text{-}12])$ and $S_y = F_{4}([\\mathrm{IL}\\text{-}4])$. These are calculated using the given Hill functions:\n$$\nS_x = V_{\\max,x}\\,\\frac{[\\mathrm{IL}\\text{-}12]^{n_x}}{K_x^{n_x}+[\\mathrm{IL}\\text{-}12]^{n_x}} \\\\\nS_y = V_{\\max,y}\\,\\frac{[\\mathrm{IL}\\text{-}4]^{n_y}}{K_y^{n_y}+[\\mathrm{IL}\\text{-}4]^{n_y}}\n$$\n\nSecond, we solve the system of linear equations for the steady state $(x^\\ast, y^\\ast)$:\n$$\n\\begin{align*}\ng\\,x^\\ast + h\\,y^\\ast &= S_x \\\\\nh'\\,x^\\ast + g'\\,y^\\ast &= S_y\n\\end{align*}\n$$\nThe determinant of the coefficient matrix is $\\Delta = g\\,g' - h\\,h'$. Provided that $\\Delta \\neq 0$, the system has a unique solution given by Cramer's rule or by matrix inversion:\n$$\n\\begin{bmatrix}\nx^\\ast\\\\\ny^\\ast\n\\end{bmatrix}\n=\n\\frac{1}{\\Delta}\n\\begin{bmatrix}\ng' & -h\\\\\n-h' & g\n\\end{bmatrix}\n\\begin{bmatrix}\nS_x\\\\\nS_y\n\\end{bmatrix}\n$$\nThis gives the explicit solutions:\n$$\nx^\\ast = \\frac{g'\\,S_x - h\\,S_y}{\\Delta} \\\\\ny^\\ast = \\frac{g\\,S_y - h'\\,S_x}{\\Delta}\n$$\nThe values of $x^\\ast$ and $y^\\ast$ must be rounded to six decimal places as required.\n\nThird, we assess the stability of this steady state. According to the problem statement, the equilibrium is asymptotically stable if and only if three conditions are met: $g > 0$, $g' > 0$, and $\\Delta > 0$. We will verify these for each case and report a boolean value. $g > 0$ and $g' > 0$ are given as constraints on the parameters, so the critical condition to check is $\\Delta > 0$.\n\nFinally, we classify the steady-state outcome based on the difference between the computed state variables and the threshold $\\delta = 0.05$:\n- If $x^\\ast - y^\\ast > 0.05$, the outcome is Th1-dominant (class code $1$).\n- If $y^\\ast - x^\\ast > 0.05$, the outcome is Th2-dominant (class code $2$).\n- Otherwise, i.e., if $|x^\\ast - y^\\ast| \\le 0.05$, the outcome is balanced (class code $0$).\n\nThis four-step procedure—calculate forcing terms, solve for steady state, check stability, and classify outcome—is implemented for each of the six test cases provided. The results are then formatted into the required output structure.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the steady state, stability, and class of a T helper cell\n    differentiation model for a given set of test cases.\n    \"\"\"\n    \n    # Test suite:\n    # (IL12, IL4, g, gp, h, hp, Vmax_x, Vmax_y, Kx, Ky, nx, ny)\n    test_cases = [\n        (2.0, 2.0, 1.0, 1.0, 0.2, 0.2, 1.0, 1.0, 2.0, 2.0, 2, 2),\n        (5.0, 1.0, 1.0, 1.0, 0.2, 0.2, 1.0, 1.0, 2.0, 2.0, 2, 2),\n        (1.0, 5.0, 1.0, 1.0, 0.2, 0.2, 1.0, 1.0, 2.0, 2.0, 2, 2),\n        (5.0, 5.0, 1.0, 1.0, 0.2, 0.2, 1.2, 1.0, 2.0, 2.0, 2, 2),\n        (5.0, 5.0, 0.5, 0.5, 0.499, 0.4999, 1.0, 1.0, 2.0, 2.0, 2, 2),\n        (2.0, 2.0, 0.5, 0.5, 0.6, 0.6, 1.0, 1.0, 2.0, 2.0, 2, 2),\n    ]\n\n    results = []\n    delta = 0.05\n\n    for case in test_cases:\n        il12, il4, g, gp, h, hp, vmax_x, vmax_y, kx, ky, nx, ny = case\n\n        # 1. Calculate forcing terms (cytokine response functions)\n        s_x = vmax_x * (il12**nx) / (kx**nx + il12**nx)\n        s_y = vmax_y * (il4**ny) / (ky**ny + il4**ny)\n        \n        # 2. Solve for the steady state (x*, y*)\n        # The system is:\n        # g*x + h*y = s_x\n        # h'*x + g'*y = s_y\n        \n        # Determinant of the coefficient matrix\n        determinant = g * gp - h * hp\n        \n        # Assuming determinant is non-zero as per problem statement\n        if determinant == 0:\n            # This case should not occur based on problem description,\n            # but as a safeguard, we would flag it as an issue.\n            # For this problem, we proceed assuming determinant != 0.\n            pass\n\n        x_star = (gp * s_x - h * s_y) / determinant\n        y_star = (g * s_y - hp * s_x) / determinant\n        \n        # 3. Determine linear stability\n        # Stable if g > 0, g' > 0, and determinant > 0\n        is_stable = (g > 0) and (gp > 0) and (determinant > 0)\n        \n        # 4. Classify the steady-state outcome\n        class_code = 0  # Balanced by default\n        if x_star - y_star > delta:\n            class_code = 1  # Th1-dominant\n        elif y_star - x_star > delta:\n            class_code = 2  # Th2-dominant\n\n        # Round numerical results to six decimal places\n        x_star_rounded = round(x_star, 6)\n        y_star_rounded = round(y_star, 6)\n\n        results.append([x_star_rounded, y_star_rounded, is_stable, class_code])\n\n    # Final print statement in the exact required format.\n    # str(results) produces a string with spaces, e.g., '[[...], [...]]'\n    # .replace(\" \", \"\") produces the required compact format.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "2501263"}]}