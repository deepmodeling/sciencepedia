{"hands_on_practices": [{"introduction": "The Beer-Lambert law, $A = \\varepsilon c l$, is the cornerstone of quantitative UV-visible spectroscopy. This first practice moves beyond simple application by challenging you to derive this crucial relationship from the fundamental principles of light attenuation through an absorbing medium [@problem_id:2615517]. This foundational exercise solidifies your understanding of the physical basis of the law, clarifies the origin of its parameters, and reinforces the importance of dimensional analysis in achieving accurate concentration measurements.", "problem": "A single-component biomolecular chromophore is analyzed by Ultraviolet–visible (UV–vis) absorption spectroscopy in a buffered aqueous solution using a quartz cuvette. The measured decadic absorbance is $A=0.75$ at a wavelength where the analyte has a tabulated molar decadic extinction coefficient $\\varepsilon=15{,}000\\ \\mathrm{L\\,mol^{-1}\\,cm^{-1}}$. The cuvette path length is $l=0.5\\ \\mathrm{cm}$. Assume monochromatic light, negligible scattering, no fluorescence or phosphorescence re-absorption, spatially uniform concentration, and that solvent and baseline contributions have been properly compensated by a matched reference.\n\nStarting from the fundamental definition of decadic absorbance $A\\equiv -\\log_{10}\\!\\left(I/I_{0}\\right)$ and an exponential attenuation model in which the attenuation coefficient is proportional to the number density of chromophores and to the optical path length under the stated linear-response conditions, derive the linear relation between $A$ and the solute concentration $c$, then determine $c$ from the given data. Explicitly track units to ensure dimensional consistency.\n\nExpress the final concentration in $\\mathrm{mol\\,L^{-1}}$ and round your answer to two significant figures. In addition, briefly comment on how the reported significant figures are constrained by the input data and on why the units chosen for $\\varepsilon$ and $l$ produce a concentration in $\\mathrm{mol\\,L^{-1}}$.", "solution": "The problem requires the derivation of the linear relationship between absorbance $A$ and concentration $c$, known as the Beer-Lambert law, from fundamental principles, followed by the calculation of the concentration from the given experimental data.\n\nFirst, we derive the Beer-Lambert law. The attenuation of light intensity $I$ through an absorbing medium is described by a differential equation. Consider a beam of monochromatic light passing through a cuvette. The change in intensity, $dI$, over an infinitesimal path length $dx$ is proportional to the intensity $I(x)$ at that position and to the number density of the absorbing chromophores, $N$ (molecules per unit volume).\n$$dI = - \\sigma N I(x) dx$$\nHere, $\\sigma$ is the molecular absorption cross-section, a proportionality constant with units of area per molecule (e.g., $\\mathrm{cm^2}$). The negative sign indicates that intensity decreases with distance. The number density $N$ must be related to the molar concentration $c$, which is given in units of $\\mathrm{mol\\,L^{-1}}$. To ensure dimensional consistency, we must convert units. Given that $1 \\ \\mathrm{L} = 1000 \\ \\mathrm{cm^3}$, the concentration in $\\mathrm{mol\\,cm^{-3}}$ is $\\frac{c}{1000}$. The number density $N$ in molecules per $\\mathrm{cm^3}$ is then this value multiplied by Avogadro's number, $N_A$:\n$$N \\left[\\frac{\\mathrm{molecules}}{\\mathrm{cm^3}}\\right] = c \\left[\\frac{\\mathrm{mol}}{\\mathrm{L}}\\right] \\times \\frac{1 \\ \\mathrm{L}}{1000 \\ \\mathrm{cm^3}} \\times N_A \\left[\\frac{\\mathrm{molecules}}{\\mathrm{mol}}\\right] = \\frac{c N_A}{1000}$$\nSubstituting this expression for $N$ into the differential equation yields:\n$$\\frac{dI}{I} = - \\sigma \\left(\\frac{c N_A}{1000}\\right) dx$$\nTo find the total attenuation across the entire path length of the cuvette, $l$, we integrate this equation from $x=0$ (where intensity is $I_0$) to $x=l$ (where intensity is $I$). The concentration $c$ is assumed to be spatially uniform.\n$$\\int_{I_0}^{I} \\frac{dI'}{I'} = - \\int_{0}^{l} \\frac{\\sigma c N_A}{1000} dx'$$\nExecution of the integration gives:\n$$\\ln(I) - \\ln(I_0) = - \\left(\\frac{\\sigma c N_A}{1000}\\right) l$$\n$$\\ln\\left(\\frac{I}{I_0}\\right) = - \\left(\\frac{\\sigma c N_A}{1000}\\right) l$$\nThis exponential attenuation model must be related to the definition of decadic absorbance, $A$:\n$$A \\equiv -\\log_{10}\\left(\\frac{I}{I_0}\\right)$$\nUsing the logarithmic identity $\\log_{10}(x) = \\frac{\\ln(x)}{\\ln(10)}$, we can write:\n$$A = -\\frac{\\ln(I/I_0)}{\\ln(10)} = -\\frac{1}{\\ln(10)} \\left[ - \\left(\\frac{\\sigma c N_A}{1000}\\right) l \\right]$$\n$$A = \\left(\\frac{\\sigma N_A}{1000 \\ln(10)}\\right) c l$$\nThis result demonstrates the linear relationship between absorbance $A$ and concentration $c$. The term in parentheses is defined as the molar decadic extinction coefficient, $\\varepsilon$:\n$$\\varepsilon \\equiv \\frac{\\sigma N_A}{1000 \\ln(10)}$$\nThis allows the linear relation to be written in its compact and conventional form, the Beer-Lambert law:\n$$A = \\varepsilon c l$$\nHaving derived this relation, we now proceed to calculate the concentration $c$ by rearranging the formula and substituting the provided values.\n$$c = \\frac{A}{\\varepsilon l}$$\nThe given parameters are:\n-   Absorbance $A = 0.75$ (dimensionless)\n-   Molar decadic extinction coefficient $\\varepsilon = 15{,}000 \\ \\mathrm{L\\,mol^{-1}\\,cm^{-1}}$\n-   Path length $l = 0.5 \\ \\mathrm{cm}$\n\nSubstituting these values:\n$$c = \\frac{0.75}{(15000 \\ \\mathrm{L\\,mol^{-1}\\,cm^{-1}}) \\times (0.5 \\ \\mathrm{cm})}$$\nThe product in the denominator is:\n$$\\varepsilon l = (1.5 \\times 10^4 \\ \\mathrm{L\\,mol^{-1}\\,cm^{-1}}) \\times (0.5 \\ \\mathrm{cm}) = 7500 \\ \\mathrm{L\\,mol^{-1}} = 7.5 \\times 10^3 \\ \\mathrm{L\\,mol^{-1}}$$\nThe concentration is therefore:\n$$c = \\frac{0.75}{7.5 \\times 10^3 \\ \\mathrm{L\\,mol^{-1}}} = \\frac{7.5 \\times 10^{-1}}{7.5 \\times 10^3} \\ \\mathrm{mol\\,L^{-1}} = 1.0 \\times 10^{-4} \\ \\mathrm{mol\\,L^{-1}}$$\nThe problem statement requires the answer to be expressed with two significant figures. The calculated value $1.0 \\times 10^{-4}$ is already in this form.\n\nFinally, a comment on significant figures and units is required.\nThe precision of the final answer is constrained by the precision of the input data. The absorbance $A=0.75$ possesses two significant figures. The path length $l=0.5 \\ \\mathrm{cm}$, as written, has only one significant figure, and the extinction coefficient $\\varepsilon=15{,}000 \\ \\mathrm{L\\,mol^{-1}\\,cm^{-1}}$ has an ambiguous number of significant figures. Strict application of propagation of uncertainty rules would limit the result to one significant figure from $l$. However, we are explicitly instructed to round to two significant figures. This instruction supersedes the standard rule and implies that the input quantities, especially $l$ and $\\varepsilon$, are to be treated as having at least two significant figures (i.e., $l=0.50 \\ \\mathrm{cm}$ and $\\varepsilon=1.5 \\times 10^4 \\ \\mathrm{L\\,mol^{-1}\\,cm^{-1}}$). With this understanding, the precision is limited by the absorbance measurement, $A=0.75$, and the result is correctly given with two significant figures.\n\nThe dimensional consistency is a critical aspect of the calculation. The units assigned to the molar extinction coefficient, $\\varepsilon$, are specifically chosen for practical convenience in chemical analysis. The relationship is $c = A / (\\varepsilon l)$. Since absorbance $A$ is a dimensionless quantity, the units of concentration $c$ are the reciprocal of the units of the product $\\varepsilon l$:\n$$\\text{Units of } c = \\frac{1}{\\text{Units of } \\varepsilon \\times \\text{Units of } l} = \\frac{1}{(\\mathrm{L\\,mol^{-1}\\,cm^{-1}}) \\times (\\mathrm{cm})} = \\frac{1}{\\mathrm{L\\,mol^{-1}}} = \\mathrm{mol\\,L^{-1}}$$\nThus, the use of $\\mathrm{L\\,mol^{-1}\\,cm^{-1}}$ for $\\varepsilon$ and $\\mathrm{cm}$ for $l$ directly yields a concentration in $\\mathrm{mol\\,L^{-1}}$ (molarity), which is the standard unit for concentration in chemistry, without requiring any intermediate unit conversions.", "answer": "$$\n\\boxed{1.0 \\times 10^{-4}}\n$$", "id": "2615517"}, {"introduction": "Ideal conditions are rare in a research setting, and biochemical samples are often turbid due to suspended particles, causing light scattering that interferes with true absorbance readings. This exercise introduces a classic method for tackling this issue by modeling the scattering background using the Rayleigh scattering approximation, where apparent absorbance is proportional to $\\lambda^{-4}$ [@problem_id:2615486]. By applying this physical model, you will learn how to estimate and subtract the scattering contribution, a vital skill for obtaining accurate protein concentration data from unclarified lysates.", "problem": "A researcher attempts to determine protein concentration in a turbid lysate by measuring ultraviolet–visible absorbance at $280$ nanometers using a $1.00$ centimeter path-length cuvette. The sample exhibits an optical density (optical density, OD) of $0.200$ at $600$ nanometers, which is assumed to arise entirely from light scattering by suspended particles. Assume that the scattering baseline can be modeled as proportional to $\\lambda^{-4}$ over the wavelength range of interest, where $\\lambda$ is the wavelength. The protein absorbance at $280$ nanometers follows the Beer–Lambert law with a mass extinction coefficient $\\varepsilon_{280} = 1.00$ milliliter milligram$^{-1}$ centimeter$^{-1}$. Neglect any non-scattering background absorbance at $280$ nanometers from nonprotein solutes.\n\nIf one naively estimates the protein concentration from the measured absorbance at $280$ nanometers without any baseline correction, the result is biased by an additive error equal to the apparent absorbance from scattering divided by $\\varepsilon_{280}$ and the path length. Using only the information above and first principles, compute the magnitude of the overestimation in protein concentration due solely to scattering. Round your answer to three significant figures and express it in milligrams per milliliter.", "solution": "The total measured absorbance, $A_{\\text{total}}(\\lambda)$, is the sum of the true absorbance from the protein, $A_{\\text{prot}}(\\lambda)$, and the apparent absorbance from light scattering, $A_{\\text{scat}}(\\lambda)$:\n$$A_{\\text{total}}(\\lambda) = A_{\\text{prot}}(\\lambda) + A_{\\text{scat}}(\\lambda)$$\nThe overestimation in concentration, $\\Delta c$, results from including the scattering contribution in the Beer-Lambert law calculation. It is given by:\n$$\\Delta c = \\frac{A_{\\text{scat}}(280)}{\\varepsilon_{280} l}$$\nwhere $\\varepsilon_{280}$ is the mass extinction coefficient at 280 nm and $l$ is the path length.\n\nWe must first find the value of $A_{\\text{scat}}(280)$. The problem states that scattering absorbance follows a $\\lambda^{-4}$ relationship:\n$$A_{\\text{scat}}(\\lambda) = k \\lambda^{-4}$$\nwhere $k$ is a proportionality constant. We are given that the absorbance at $600$ nm is entirely due to scattering, so $A_{\\text{scat}}(600) = 0.200$. We can use this to find the scattering absorbance at $280$ nm by setting up a ratio:\n$$\\frac{A_{\\text{scat}}(280)}{A_{\\text{scat}}(600)} = \\frac{k (280)^{-4}}{k (600)^{-4}} = \\left(\\frac{600}{280}\\right)^4$$\nSolving for $A_{\\text{scat}}(280)$:\n$$A_{\\text{scat}}(280) = A_{\\text{scat}}(600) \\times \\left(\\frac{600}{280}\\right)^4 = 0.200 \\times \\left(\\frac{15}{7}\\right)^4$$\nNow, substitute this into the expression for the concentration overestimation, using the given values $l = 1.00 \\text{ cm}$ and $\\varepsilon_{280} = 1.00 \\text{ mL mg}^{-1} \\text{cm}^{-1}$:\n$$\\Delta c = \\frac{0.200 \\times \\left(\\frac{15}{7}\\right)^4}{1.00 \\times 1.00} \\frac{\\text{mg}}{\\text{mL}}$$\nPerforming the calculation:\n$$\\Delta c = 0.200 \\times \\frac{15^4}{7^4} = 0.200 \\times \\frac{50625}{2401} = \\frac{10125}{2401} \\approx 4.21699... \\frac{\\text{mg}}{\\text{mL}}$$\nRounding the result to three significant figures, as required:\n$$\\Delta c \\approx 4.22 \\text{ mg/mL}$$", "answer": "$$\\boxed{4.22}$$", "id": "2615486"}, {"introduction": "Biological systems are complex mixtures, and it is common for several biomolecules with overlapping spectra to be present in a single sample. This advanced practice challenges you to move beyond single-analyte systems and deconvolve a mixture of three nucleotides using multi-wavelength absorbance data [@problem_id:2615466]. You will apply the principle of absorbance additivity and formulate the problem in matrix form, solving for the unknown concentrations using weighted least squares to account for measurement noise. This exercise provides hands-on experience with a powerful chemometric approach essential for analyzing complex spectroscopic datasets.", "problem": "You are given a multi-wavelength ultraviolet–visible (UV–Vis) absorbance dataset collected for mixtures of three nucleotides in aqueous solution, measured in a cuvette with a specified optical path length. The mixture obeys the Beer–Lambert law and the absorbance is subject to additive, independent Gaussian noise at each wavelength. Your task is to compute the maximum likelihood estimates of the three nucleotide concentrations from the overlapping spectra using the principle of least squares.\n\nUse the following fundamental base to derive your method:\n- Beer–Lambert law: for each wavelength $\\lambda$, the absorbance $A(\\lambda)$ satisfies $A(\\lambda) = b \\sum_{i=1}^{3} \\varepsilon_i(\\lambda)\\, c_i + \\eta(\\lambda)$ where $b$ is the path length, $\\varepsilon_i(\\lambda)$ are the molar decadic absorption coefficients (extinction coefficients) of the three species, $c_i$ are the concentrations, and $\\eta(\\lambda)$ is the additive noise.\n- The noise at each wavelength is modeled as independent Gaussian with zero mean and known standard deviation $\\sigma(\\lambda)$, so that the joint likelihood of absorbance measurements across wavelengths is maximized by the weighted least squares estimator.\n\nFormulate the estimation as a linear inverse problem at the set of measured wavelengths by stacking equations into a matrix form. Let the measurement vector be $y \\in \\mathbb{R}^{m}$ containing the measured absorbances at $m$ wavelengths, the design matrix $X \\in \\mathbb{R}^{m \\times 3}$ with entries $X_{j,i} = b\\,\\varepsilon_i(\\lambda_j)$, and the unknown concentration vector $c \\in \\mathbb{R}^{3}$. Assume the noise vector has covariance matrix $\\Sigma = \\mathrm{diag}(\\sigma(\\lambda_1)^2,\\dots,\\sigma(\\lambda_m)^2)$. Derive an estimator for $c$ from first principles by minimizing the appropriate quadratic form implied by the Gaussian model and Beer–Lambert law. Implement this estimator algorithmically in a numerically stable way.\n\nPhysical units and output requirements:\n- Extinction coefficients $\\varepsilon$ are given in $\\mathrm{M}^{-1}\\,\\mathrm{cm}^{-1}$.\n- Path length $b$ is given in $\\mathrm{cm}$.\n- Absorbance $A$ is unitless.\n- Concentrations $c_i$ must be reported in micromolar ($\\mu\\mathrm{M}$), rounded to three decimal places.\n- All angles, if any, are not applicable here.\n- Express any fraction as a decimal number.\n\nTest Suite (for each test case, use the provided parameters exactly; do not generate any random values):\n- Test case 1 (happy path, overdetermined, moderate noise):\n  - Wavelengths $\\Lambda_1 = [240, 260, 270, 280]\\,\\mathrm{nm}$.\n  - Path length $b_1 = 1.0\\,\\mathrm{cm}$.\n  - Extinction matrix $\\varepsilon_1(\\lambda)$ rows corresponding to $\\Lambda_1$ (each row is $[\\varepsilon_1, \\varepsilon_2, \\varepsilon_3]$ in $\\mathrm{M}^{-1}\\,\\mathrm{cm}^{-1}$):\n    - $\\lambda=240\\,\\mathrm{nm}$: $[12000, 9000, 10500]$,\n    - $\\lambda=260\\,\\mathrm{nm}$: $[15400, 7400, 11500]$,\n    - $\\lambda=270\\,\\mathrm{nm}$: $[14000, 6000, 12000]$,\n    - $\\lambda=280\\,\\mathrm{nm}$: $[10000, 3500, 7600]$.\n  - Measured absorbances $y_1 = [0.097, 0.1048, 0.098, 0.0677]$.\n  - Noise standard deviations $\\sigma_1 = [0.002, 0.002, 0.003, 0.002]$.\n- Test case 2 (exactly determined, low noise):\n  - Wavelengths $\\Lambda_2 = [250, 260, 280]\\,\\mathrm{nm}$.\n  - Path length $b_2 = 1.0\\,\\mathrm{cm}$.\n  - Extinction matrix rows:\n    - $\\lambda=250\\,\\mathrm{nm}$: $[13000, 8500, 11000]$,\n    - $\\lambda=260\\,\\mathrm{nm}$: $[15400, 7400, 11500]$,\n    - $\\lambda=280\\,\\mathrm{nm}$: $[10000, 3500, 7600]$.\n  - Measured absorbances $y_2 = [0.1845, 0.2123, 0.1377]$.\n  - Noise standard deviations $\\sigma_2 = [0.001, 0.001, 0.001]$.\n- Test case 3 (overdetermined, heterogeneous noise, different path length):\n  - Wavelengths $\\Lambda_3 = [240, 250, 260, 270, 280]\\,\\mathrm{nm}$.\n  - Path length $b_3 = 0.5\\,\\mathrm{cm}$.\n  - Extinction matrix rows:\n    - $\\lambda=240\\,\\mathrm{nm}$: $[12000, 9000, 10500]$,\n    - $\\lambda=250\\,\\mathrm{nm}$: $[13000, 8500, 11000]$,\n    - $\\lambda=260\\,\\mathrm{nm}$: $[15400, 7400, 11500]$,\n    - $\\lambda=270\\,\\mathrm{nm}$: $[14000, 6000, 12000]$,\n    - $\\lambda=280\\,\\mathrm{nm}$: $[10000, 3500, 7600]$.\n  - Measured absorbances $y_3 = [0.0802, 0.079, 0.0798, 0.074, 0.0464]$.\n  - Noise standard deviations $\\sigma_3 = [0.0015, 0.0025, 0.001, 0.002, 0.0015]$.\n- Test case 4 (ill-conditioned spectral overlap, mild noise):\n  - Wavelengths $\\Lambda_4 = [255, 257, 259, 261, 263, 280]\\,\\mathrm{nm}$.\n  - Path length $b_4 = 1.0\\,\\mathrm{cm}$.\n  - Extinction matrix rows:\n    - $\\lambda=255\\,\\mathrm{nm}$: $[15000, 7400, 11200]$,\n    - $\\lambda=257\\,\\mathrm{nm}$: $[15100, 7450, 11300]$,\n    - $\\lambda=259\\,\\mathrm{nm}$: $[15300, 7350, 11400]$,\n    - $\\lambda=261\\,\\mathrm{nm}$: $[15500, 7500, 11550]$,\n    - $\\lambda=263\\,\\mathrm{nm}$: $[15600, 7425, 11600]$,\n    - $\\lambda=280\\,\\mathrm{nm}$: $[10000, 3500, 7600]$.\n  - Measured absorbances $y_4 = [0.0338, 0.03375, 0.03405, 0.03485, 0.034425, 0.0212]$.\n  - Noise standard deviations $\\sigma_4 = [0.0005, 0.0005, 0.0005, 0.0005, 0.0005, 0.0005]$.\n\nYour program must:\n- Implement the estimator derived from the fundamental base, using a numerically stable method to solve the linear system when the problem is overdetermined or ill-conditioned.\n- For each test case, compute the estimated concentrations and convert them to micromolar by multiplying by $10^{6}$.\n- Round each estimated concentration to three decimal places.\n- Produce a single line of output containing the results as a comma-separated list of lists in the order of the test cases, for example [[c_{1,1},c_{1,2},c_{1,3}], [c_{2,1},c_{2,2},c_{2,3}], [c_{3,1},c_{3,2},c_{3,3}], [c_{4,1},c_{4,2},c_{4,3}]], where $c_{k,i}$ is the rounded value of species $i$ for test case $k$, in $\\mu\\mathrm{M}$.", "solution": "The problem requires the determination of concentrations of three nucleotides from a multi-wavelength UV-Vis absorbance dataset. This is a classic deconvolution problem governed by the Beer-Lambert law, which is linear with respect to concentration. We are tasked with deriving the maximum likelihood estimator for the concentrations and implementing it numerically.\n\nThe foundation is the Beer-Lambert law. For a mixture of $N$ species, the total absorbance $A$ at a specific wavelength $\\lambda$ is the sum of the absorbances of each species. For the given problem with $N=3$ species, this is:\n$$\nA(\\lambda) = \\sum_{i=1}^{3} A_i(\\lambda) = \\sum_{i=1}^{3} \\varepsilon_i(\\lambda) b c_i\n$$\nwhere $\\varepsilon_i(\\lambda)$ is the molar decadic absorption coefficient of species $i$ at wavelength $\\lambda$, $b$ is the optical path length, and $c_i$ is the molar concentration of species $i$.\n\nThe measurements are subject to noise. The measured absorbance at wavelength $\\lambda_j$ is modeled as:\n$$\ny_j = A(\\lambda_j) + \\eta_j = b \\sum_{i=1}^{3} \\varepsilon_i(\\lambda_j) c_i + \\eta_j\n$$\nwhere $y_j$ is the measured absorbance and $\\eta_j$ is the additive noise term at wavelength $\\lambda_j$. We have a set of $m$ such measurements at different wavelengths $\\lambda_1, \\dots, \\lambda_m$. This system of $m$ linear equations can be expressed in matrix form:\n$$\n\\mathbf{y} = \\mathbf{X}\\mathbf{c} + \\boldsymbol{\\eta}\n$$\nHere:\n- $\\mathbf{y} \\in \\mathbb{R}^{m}$ is the vector of measured absorbances, with elements $y_j$.\n- $\\mathbf{c} \\in \\mathbb{R}^{3}$ is the vector of unknown concentrations, with elements $c_i$.\n- $\\mathbf{X} \\in \\mathbb{R}^{m \\times 3}$ is the design matrix, whose elements are given by $X_{ji} = b \\cdot \\varepsilon_i(\\lambda_j)$. Each column of $\\mathbf{X}$ represents the absorbance spectrum of a pure component at unit concentration, scaled by the path length.\n- $\\boldsymbol{\\eta} \\in \\mathbb{R}^{m}$ is the vector of noise terms.\n\nThe problem states that the noise terms $\\eta_j$ are independent and drawn from a Gaussian distribution with zero mean and known standard deviation $\\sigma_j = \\sigma(\\lambda_j)$. Therefore, the noise vector $\\boldsymbol{\\eta}$ follows a multivariate normal distribution with mean vector $\\mathbf{0}$ and a diagonal covariance matrix $\\mathbf{\\Sigma}$:\n$$\n\\boldsymbol{\\eta} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{\\Sigma}), \\quad \\text{where} \\quad \\mathbf{\\Sigma} = \\mathrm{diag}(\\sigma_1^2, \\sigma_2^2, \\dots, \\sigma_m^2)\n$$\nConsequently, the measurement vector $\\mathbf{y}$ also follows a multivariate normal distribution:\n$$\n\\mathbf{y} \\sim \\mathcal{N}(\\mathbf{X}\\mathbf{c}, \\mathbf{\\Sigma})\n$$\nThe probability density function for $\\mathbf{y}$ given $\\mathbf{c}$ is:\n$$\np(\\mathbf{y} | \\mathbf{c}) = \\frac{1}{(2\\pi)^{m/2} \\det(\\mathbf{\\Sigma})^{1/2}} \\exp\\left(-\\frac{1}{2} (\\mathbf{y} - \\mathbf{X}\\mathbf{c})^T \\mathbf{\\Sigma}^{-1} (\\mathbf{y} - \\mathbf{X}\\mathbf{c})\\right)\n$$\nThe maximum likelihood estimate (MLE) of $\\mathbf{c}$, denoted $\\hat{\\mathbf{c}}$, is the value of $\\mathbf{c}$ that maximizes this likelihood function $L(\\mathbf{c}|\\mathbf{y}) = p(\\mathbf{y}|\\mathbf{c})$. Maximizing the likelihood is equivalent to minimizing the negative log-likelihood. The negative log-likelihood, ignoring terms constant with respect to $\\mathbf{c}$, is proportional to the quadratic form in the exponent:\n$$\n\\chi^2(\\mathbf{c}) = (\\mathbf{y} - \\mathbf{X}\\mathbf{c})^T \\mathbf{\\Sigma}^{-1} (\\mathbf{y} - \\mathbf{X}\\mathbf{c})\n$$\nThis is the objective function for the method of Weighted Least Squares (WLS). The weighting matrix is $\\mathbf{W} = \\mathbf{\\Sigma}^{-1}$, which is a diagonal matrix with elements $W_{jj} = 1/\\sigma_j^2$. The measurements with smaller variance (less noise) are given higher weight.\n\nTo find the estimator $\\hat{\\mathbf{c}}$ that minimizes $\\chi^2(\\mathbf{c})$, we differentiate with respect to $\\mathbf{c}$ and set the gradient to zero:\n$$\n\\frac{\\partial \\chi^2}{\\partial \\mathbf{c}} = \\frac{\\partial}{\\partial \\mathbf{c}} (\\mathbf{y}^T \\mathbf{W} \\mathbf{y} - 2\\mathbf{y}^T \\mathbf{W} \\mathbf{X} \\mathbf{c} + \\mathbf{c}^T \\mathbf{X}^T \\mathbf{W} \\mathbf{X} \\mathbf{c}) = -2\\mathbf{X}^T \\mathbf{W} \\mathbf{y} + 2\\mathbf{X}^T \\mathbf{W} \\mathbf{X} \\mathbf{c} = \\mathbf{0}\n$$\nThis yields the normal equations for WLS:\n$$\n(\\mathbf{X}^T \\mathbf{W} \\mathbf{X}) \\hat{\\mathbf{c}} = \\mathbf{X}^T \\mathbf{W} \\mathbf{y}\n$$\nThe formal solution for $\\hat{\\mathbf{c}}$ is:\n$$\n\\hat{\\mathbf{c}} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbf{y}\n$$\nFor numerical stability, especially when the matrix $\\mathbf{X}^T \\mathbf{W} \\mathbf{X}$ is ill-conditioned (as in Test Case 4), direct computation and inversion are avoided. A more robust method involves transforming the problem into an unweighted (ordinary) least squares (OLS) problem. Let $\\mathbf{W}^{1/2}$ be a diagonal matrix with entries $(\\mathbf{W}^{1/2})_{jj} = 1/\\sigma_j$. We can rewrite the objective function:\n$$\n\\chi^2(\\mathbf{c}) = (\\mathbf{y} - \\mathbf{X}\\mathbf{c})^T (\\mathbf{W}^{1/2})^T \\mathbf{W}^{1/2} (\\mathbf{y} - \\mathbf{X}\\mathbf{c}) = (\\mathbf{W}^{1/2}(\\mathbf{y} - \\mathbf{X}\\mathbf{c}))^T (\\mathbf{W}^{1/2}(\\mathbf{y} - \\mathbf{X}\\mathbf{c})) = \\| \\mathbf{y}' - \\mathbf{X}'\\mathbf{c} \\|_2^2\n$$\nwhere $\\mathbf{y}' = \\mathbf{W}^{1/2}\\mathbf{y}$ and $\\mathbf{X}' = \\mathbf{W}^{1/2}\\mathbf{X}$. This is a standard OLS problem, which seeks to find the vector $\\mathbf{c}$ that minimizes the Euclidean norm of the residual vector $\\mathbf{y}' - \\mathbf{X}'\\mathbf{c}$.\n\nThis OLS problem is best solved using methods such as QR decomposition or Singular Value Decomposition (SVD) of the matrix $\\mathbf{X}'$. These methods are numerically stable and are implemented in standard linear algebra libraries. We will use the `numpy.linalg.lstsq` function, which employs an SVD-based approach, to solve for $\\hat{\\mathbf{c}}$.\n\nThe algorithmic steps for each test case are as follows:\n1.  Construct the matrix of extinction coefficients, $\\boldsymbol{\\varepsilon}$, the vector of measured absorbances, $\\mathbf{y}$, and the vector of noise standard deviations, $\\boldsymbol{\\sigma}$.\n2.  Using the path length $b$, construct the design matrix $\\mathbf{X} = b \\cdot \\boldsymbol{\\varepsilon}$.\n3.  Weight the equations by the inverse of the noise standard deviations. Create the transformed matrix $\\mathbf{X}'$ and vector $\\mathbf{y}'$:\n    $$\n    X'_{ji} = X_{ji} / \\sigma_j\n    $$\n    $$\n    y'_{j} = y_j / \\sigma_j\n    $$\n4.  Solve the ordinary least squares problem for $\\hat{\\mathbf{c}}$: $\\mathrm{argmin}_{\\mathbf{c}} \\| \\mathbf{y}' - \\mathbf{X}'\\mathbf{c} \\|_2^2$.\n5.  The resulting concentrations $\\hat{\\mathbf{c}}$ are in units of Molarity ($\\mathrm{M}$), as the extinction coefficients are in $\\mathrm{M}^{-1}\\,\\mathrm{cm}^{-1}$. Convert these to micromolar ($\\mu\\mathrm{M}$) by multiplying by $10^6$.\n6.  Round the final concentrations to three decimal places as required.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for nucleotide concentrations using weighted least squares from UV-Vis data.\n    \"\"\"\n    test_cases = [\n        {\n            \"b\": 1.0,  # cm\n            \"epsilon\": np.array([\n                [12000, 9000, 10500],\n                [15400, 7400, 11500],\n                [14000, 6000, 12000],\n                [10000, 3500, 7600]\n            ]),  # M^-1 cm^-1\n            \"y\": np.array([0.097, 0.1048, 0.098, 0.0677]),\n            \"sigma\": np.array([0.002, 0.002, 0.003, 0.002])\n        },\n        {\n            \"b\": 1.0,\n            \"epsilon\": np.array([\n                [13000, 8500, 11000],\n                [15400, 7400, 11500],\n                [10000, 3500, 7600]\n            ]),\n            \"y\": np.array([0.1845, 0.2123, 0.1377]),\n            \"sigma\": np.array([0.001, 0.001, 0.001])\n        },\n        {\n            \"b\": 0.5,\n            \"epsilon\": np.array([\n                [12000, 9000, 10500],\n                [13000, 8500, 11000],\n                [15400, 7400, 11500],\n                [14000, 6000, 12000],\n                [10000, 3500, 7600]\n            ]),\n            \"y\": np.array([0.0802, 0.079, 0.0798, 0.074, 0.0464]),\n            \"sigma\": np.array([0.0015, 0.0025, 0.001, 0.002, 0.0015])\n        },\n        {\n            \"b\": 1.0,\n            \"epsilon\": np.array([\n                [15000, 7400, 11200],\n                [15100, 7450, 11300],\n                [15300, 7350, 11400],\n                [15500, 7500, 11550],\n                [15600, 7425, 11600],\n                [10000, 3500, 7600]\n            ]),\n            \"y\": np.array([0.0338, 0.03375, 0.03405, 0.03485, 0.034425, 0.0212]),\n            \"sigma\": np.array([0.0005, 0.0005, 0.0005, 0.0005, 0.0005, 0.0005])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        b = case[\"b\"]\n        epsilon_matrix = case[\"epsilon\"]\n        y_measured = case[\"y\"]\n        sigma_noise = case[\"sigma\"]\n\n        # 1. Construct the design matrix X\n        X = b * epsilon_matrix\n\n        # 2. Transform to an Ordinary Least Squares problem by weighting\n        #    X' = W^(1/2) * X, y' = W^(1/2) * y\n        #    where W^(1/2) is diagonal with entries 1/sigma_j\n        \n        # In numpy, this is equivalent to element-wise division.\n        # sigma_noise[:, np.newaxis] broadcasts the (m,1) vector to (m,3) for element-wise division\n        X_prime = X / sigma_noise[:, np.newaxis]\n        y_prime = y_measured / sigma_noise\n\n        # 3. Solve the least squares problem for c using a numerically stable method (SVD-based)\n        #    np.linalg.lstsq solves argmin_c ||y' - X'c||_2\n        c_molar, _, _, _ = np.linalg.lstsq(X_prime, y_prime, rcond=None)\n\n        # 4. Convert concentrations from Molar (M) to micromolar (uM)\n        c_micromolar = c_molar * 1e6\n\n        # 5. Round to three decimal places\n        c_rounded = np.round(c_micromolar, 3)\n        \n        results.append(c_rounded.tolist())\n\n    # Format the final output string as a list of lists without spaces\n    list_of_strings = []\n    for res_list in results:\n        str_list = ','.join(map(str, res_list))\n        list_of_strings.append(f'[{str_list}]')\n    \n    final_output_string = f\"[{','.join(list_of_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "2615466"}]}