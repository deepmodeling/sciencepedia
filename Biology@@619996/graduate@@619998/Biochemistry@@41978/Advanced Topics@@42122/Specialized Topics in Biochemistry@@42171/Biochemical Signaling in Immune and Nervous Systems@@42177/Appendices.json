{"hands_on_practices": [{"introduction": "Understanding how drugs compete with native ligands is a cornerstone of pharmacology and neurobiology. This practice challenges you to derive the fractional occupancy of a receptor from first principles, using the law of mass action to describe a competitive equilibrium between an agonist and an antagonist. Successfully completing this derivation solidifies your understanding of dissociation constants and provides the mathematical foundation for analyzing dose-response relationships in complex biological environments. [@problem_id:2545440]", "problem": "A synaptic G protein-coupled receptor (GPCR) on a neuron has a single orthosteric binding site that can bind either the endogenous neurotransmitter $L_1$ (agonist) or a synthetic competitor $L_2$ (antagonist), but not both simultaneously. Assume the system is at equilibrium, follows the law of mass action, and that $[L_1]$ and $[L_2]$ denote the free equilibrium concentrations of the ligands in the extracellular space. Let $K_{d1}$ and $K_{d2}$ be the equilibrium dissociation constants for $L_1$ and $L_2$ binding to the receptor, respectively. Define the total receptor concentration as $[R_{\\text{tot}}]$ and the receptor–ligand complex concentrations as $[RL_1]$ and $[RL_2]$.\n\nStarting only from the definitions of the equilibrium dissociation constants and conservation of receptor mass, derive the fractional occupancy of the receptor by $L_1$, denoted $f_1$, as a closed-form analytic expression in terms of $[L_1]$, $[L_2]$, $K_{d1}$, and $K_{d2}$. Provide your final answer as a single expression for $f_1$. No numerical evaluation or rounding is required.", "solution": "The problem statement has been evaluated and is found to be valid. It is a scientifically grounded, well-posed, and objective problem describing a classic case of competitive ligand binding, a fundamental concept in biochemistry and an elementary application of the law of mass action. We may proceed with the derivation.\n\nThe objective is to derive the fractional occupancy of the receptor by the ligand $L_1$, which is denoted $f_1$. This is defined as the ratio of the concentration of receptor-ligand-$1$ complex, $[RL_1]$, to the total concentration of receptors, $[R_{\\text{tot}}]$.\n$$f_1 = \\frac{[RL_1]}{[R_{\\text{tot}}]}$$\nThe total receptor concentration is the sum of the concentrations of free (unbound) receptors, $[R]$, and receptors bound to each of the two ligands:\n$$[R_{\\text{tot}}] = [R] + [RL_1] + [RL_2]$$\nThe system is at equilibrium, so the interactions are governed by the equilibrium dissociation constants. For the binding of $L_1$ and $L_2$, these are defined as:\n$$K_{d1} = \\frac{[R][L_1]}{[RL_1]}$$\n$$K_{d2} = \\frac{[R][L_2]}{[RL_2]}$$\nwhere $[L_1]$ and $[L_2]$ are the free concentrations of the respective ligands.\n\nTo derive an expression for $f_1$, we must express all concentrations in the receptor mass balance equation in terms of a single variable. It is most efficient to express them in terms of $[RL_1]$, as this term appears in the numerator of the definition of $f_1$.\n\nFrom the definition of $K_{d1}$, we can express the concentration of free receptor, $[R]$, as:\n$$[R] = \\frac{K_{d1}[RL_1]}{[L_1]}$$\nNext, we express the concentration of the receptor-ligand-$2$ complex, $[RL_2]$, in terms of $[RL_1]$. From the definition of $K_{d2}$, we have $[RL_2] = \\frac{[R][L_2]}{K_{d2}}$. Substituting the expression for $[R]$ derived above gives:\n$$[RL_2] = \\left(\\frac{K_{d1}[RL_1]}{[L_1]}\\right)\\frac{[L_2]}{K_{d2}} = [RL_1]\\left(\\frac{K_{d1}[L_2]}{K_{d2}[L_1]}\\right)$$\nNow we substitute the expressions for $[R]$ and $[RL_2]$ into the equation for the conservation of total receptor mass:\n$$[R_{\\text{tot}}] = \\frac{K_{d1}[RL_1]}{[L_1]} + [RL_1] + [RL_1]\\left(\\frac{K_{d1}[L_2]}{K_{d2}[L_1]}\\right)$$\nWe factor out the common term $[RL_1]$ from the right-hand side of the equation:\n$$[R_{\\text{tot}}] = [RL_1] \\left( 1 + \\frac{K_{d1}}{[L_1]} + \\frac{K_{d1}[L_2]}{K_{d2}[L_1]} \\right)$$\nNow, we can find the fractional occupancy $f_1$ by taking the ratio of $[RL_1]$ to $[R_{\\text{tot}}]$:\n$$f_1 = \\frac{[RL_1]}{[R_{\\text{tot}}]} = \\frac{[RL_1]}{[RL_1] \\left( 1 + \\frac{K_{d1}}{[L_1]} + \\frac{K_{d1}[L_2]}{K_{d2}[L_1]} \\right)}$$\nThe term $[RL_1]$ cancels, leaving:\n$$f_1 = \\frac{1}{1 + \\frac{K_{d1}}{[L_1]} + \\frac{K_{d1}[L_2]}{K_{d2}[L_1]}}$$\nTo simplify this expression and eliminate the compound fractions, we multiply the numerator and the denominator by $[L_1]$:\n$$f_1 = \\frac{[L_1]}{[L_1] \\left( 1 + \\frac{K_{d1}}{[L_1]} + \\frac{K_{d1}[L_2]}{K_{d2}[L_1]} \\right)} = \\frac{[L_1]}{[L_1] + K_{d1} + \\frac{K_{d1}[L_2]}{K_{d2}}}$$\nThis expression is correct, but it is conventional to group the terms related to the antagonist $L_2$. We can factor the term $K_{d1}$ in the denominator to achieve the standard form:\n$$f_1 = \\frac{[L_1]}{[L_1] + K_{d1}\\left(1 + \\frac{[L_2]}{K_{d2}}\\right)}$$\nThis is the final, closed-form analytic expression for the fractional occupancy of the receptor by the ligand $L_1$ in the presence of a competitive antagonist $L_2$. This equation is a form of the Gaddum equation, which describes competitive antagonism.", "answer": "$$\\boxed{\\frac{[L_1]}{[L_1] + K_{d1}\\left(1 + \\frac{[L_2]}{K_{d2}}\\right)}}$$", "id": "2545440"}, {"introduction": "While equilibrium describes the final state of ligand binding, the speed at which this state is reached is equally critical for signaling dynamics. This exercise models the kinetic response of immune receptors on microglia to a sudden exposure to a ligand, a common event during an inflammatory response in the nervous system. By deriving the time course of receptor-ligand complex formation, you will gain hands-on experience with mass-action kinetics and learn how to predict the timescale of cellular activation. [@problem_id:2545449]", "problem": "A well-stirred hippocampal slice preparation is rapidly perfused at time $t=0$ with a constant concentration step of the complement fragment ligand $C5a$ to a maintained bath concentration $L_0$. Microglial cells express the complement component $5a$ receptor $1$ (C5aR1), and ligand binding follows mass-action kinetics in the extracellular volume. Let $R(t)$ denote the concentration of unbound receptor, $C(t)$ the concentration of receptor–ligand complex, and $R_{\\mathrm{tot}}$ the total receptor concentration on the cell surface, with the conservation relation $R_{\\mathrm{tot}} = R(t) + C(t)$. The ligand concentration is clamped at $L(t) = L_0$ for all $t \\ge 0$ by fast perfusion. Binding and unbinding are characterized by an association rate constant $k_{\\mathrm{on}}$ and dissociation rate constant $k_{\\mathrm{off}}$. Assume that diffusion is fast enough to maintain spatial homogeneity, and that prior to $t=0$ there is no ligand present and no complex ($C(0)=0$).\n\nStarting only from mass-action kinetics and receptor conservation, determine the time $t_{0.90}$ required for the complex concentration $C(t)$ to reach $0.90$ of its equilibrium value after the step to $L_0$. Use the parameter values $k_{\\mathrm{on}} = 2.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}$, $k_{\\mathrm{off}} = 1.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}$, $R_{\\mathrm{tot}} = 1.0 \\times 10^{-10}\\ \\mathrm{M}$, and $L_0 = 5.0 \\times 10^{-9}\\ \\mathrm{M}$. \n\nRound your final numerical result to $3$ significant figures. Express your final answer in seconds ($\\mathrm{s}$). Your final answer must be a single real number.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is based on the fundamental principles of mass-action kinetics and describes a standard biochemical experiment. All necessary information is provided, and there are no contradictions or ambiguities. I will proceed with the solution.\n\nThe formation of the receptor-ligand complex, $C(t)$, is governed by the law of mass action. The rate of change of the complex concentration, $\\frac{dC}{dt}$, is the difference between the rate of association and the rate of dissociation. The association rate is proportional to the concentrations of the unbound ligand, $L(t)$, and unbound receptors, $R(t)$, with the association rate constant $k_{\\mathrm{on}}$. The dissociation rate is proportional to the concentration of the complex, $C(t)$, with the dissociation rate constant $k_{\\mathrm{off}}$.\nThis gives the differential equation:\n$$\n\\frac{dC}{dt} = k_{\\mathrm{on}} L(t) R(t) - k_{\\mathrm{off}} C(t)\n$$\nThe problem states that the ligand concentration is maintained at a constant value, $L_0$, for all times $t \\ge 0$. So, $L(t) = L_0$. The total receptor concentration, $R_{\\mathrm{tot}}$, is constant and is given by the conservation relation $R_{\\mathrm{tot}} = R(t) + C(t)$. We can express the unbound receptor concentration as $R(t) = R_{\\mathrm{tot}} - C(t)$. Substituting these into the rate equation yields:\n$$\n\\frac{dC}{dt} = k_{\\mathrm{on}} L_0 (R_{\\mathrm{tot}} - C(t)) - k_{\\mathrm{off}} C(t)\n$$\nThis is a first-order linear ordinary differential equation. We can rearrange the terms to group the factors of $C(t)$:\n$$\n\\frac{dC}{dt} = k_{\\mathrm{on}} L_0 R_{\\mathrm{tot}} - (k_{\\mathrm{on}} L_0 + k_{\\mathrm{off}}) C(t)\n$$\nTo solve this equation, we can define an observed rate constant, $k_{\\mathrm{obs}}$, as:\n$$\nk_{\\mathrm{obs}} = k_{\\mathrm{on}} L_0 + k_{\\mathrm{off}}\n$$\nThe differential equation then becomes:\n$$\n\\frac{dC}{dt} = k_{\\mathrm{on}} L_0 R_{\\mathrm{tot}} - k_{\\mathrm{obs}} C(t)\n$$\nThis equation describes the approach to equilibrium. At equilibrium ($t \\to \\infty$), the concentration of the complex is constant, so $\\frac{dC}{dt} = 0$. Let $C_{\\mathrm{eq}}$ be the equilibrium concentration of the complex.\n$$\n0 = k_{\\mathrm{on}} L_0 R_{\\mathrm{tot}} - k_{\\mathrm{obs}} C_{\\mathrm{eq}}\n$$\nSolving for $C_{\\mathrm{eq}}$ gives:\n$$\nC_{\\mathrm{eq}} = \\frac{k_{\\mathrm{on}} L_0 R_{\\mathrm{tot}}}{k_{\\mathrm{obs}}} = \\frac{k_{\\mathrm{on}} L_0 R_{\\mathrm{tot}}}{k_{\\mathrm{on}} L_0 + k_{\\mathrm{off}}}\n$$\nThe differential equation can now be written in terms of $C_{\\mathrm{eq}}$:\n$$\n\\frac{dC}{dt} = k_{\\mathrm{obs}} C_{\\mathrm{eq}} - k_{\\mathrm{obs}} C(t) = k_{\\mathrm{obs}}(C_{\\mathrm{eq}} - C(t))\n$$\nThis is a separable differential equation:\n$$\n\\frac{dC}{C_{\\mathrm{eq}} - C} = k_{\\mathrm{obs}} dt\n$$\nWe integrate both sides. The left side is integrated from the initial concentration $C(0)=0$ to $C(t)$, and the right side from time $t=0$ to $t$:\n$$\n\\int_{0}^{C(t)} \\frac{dC'}{C_{\\mathrm{eq}} - C'} = \\int_{0}^{t} k_{\\mathrm{obs}} dt'\n$$\nThe integral on the left is $-\\ln(C_{\\mathrm{eq}} - C') \\Big|_{0}^{C(t)}$.\n$$\n-\\ln(C_{\\mathrm{eq}} - C(t)) - (-\\ln(C_{\\mathrm{eq}} - 0)) = k_{\\mathrm{obs}} t\n$$\n$$\n-\\ln(C_{\\mathrm{eq}} - C(t)) + \\ln(C_{\\mathrm{eq}}) = k_{\\mathrm{obs}} t\n$$\n$$\n\\ln\\left(\\frac{C_{\\mathrm{eq}}}{C_{\\mathrm{eq}} - C(t)}\\right) = k_{\\mathrm{obs}} t\n$$\nSolving for $C(t)$:\n$$\n\\frac{C_{\\mathrm{eq}}}{C_{\\mathrm{eq}} - C(t)} = \\exp(k_{\\mathrm{obs}} t)\n$$\n$$\nC_{\\mathrm{eq}} - C(t) = C_{\\mathrm{eq}} \\exp(-k_{\\mathrm{obs}} t)\n$$\n$$\nC(t) = C_{\\mathrm{eq}} (1 - \\exp(-k_{\\mathrm{obs}} t))\n$$\nWe need to find the time $t_{0.90}$ at which the complex concentration reaches $0.90$ of its equilibrium value. That is, $C(t_{0.90}) = 0.90 C_{\\mathrm{eq}}$.\n$$\n0.90 C_{\\mathrm{eq}} = C_{\\mathrm{eq}} (1 - \\exp(-k_{\\mathrm{obs}} t_{0.90}))\n$$\nDividing by $C_{\\mathrm{eq}}$ (which is non-zero), we get:\n$$\n0.90 = 1 - \\exp(-k_{\\mathrm{obs}} t_{0.90})\n$$\n$$\n\\exp(-k_{\\mathrm{obs}} t_{0.90}) = 1 - 0.90 = 0.10\n$$\nTaking the natural logarithm of both sides:\n$$\n-k_{\\mathrm{obs}} t_{0.90} = \\ln(0.10) = \\ln(10^{-1}) = -\\ln(10)\n$$\nTherefore, the time $t_{0.90}$ is given by:\n$$\nt_{0.90} = \\frac{\\ln(10)}{k_{\\mathrm{obs}}} = \\frac{\\ln(10)}{k_{\\mathrm{on}} L_0 + k_{\\mathrm{off}}}\n$$\nNow we substitute the given numerical values:\n$k_{\\mathrm{on}} = 2.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}$\n$k_{\\mathrm{off}} = 1.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}$\n$L_0 = 5.0 \\times 10^{-9}\\ \\mathrm{M}$\n\nFirst, calculate the observed rate constant $k_{\\mathrm{obs}}$:\n$$\nk_{\\mathrm{obs}} = (2.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}) \\times (5.0 \\times 10^{-9}\\ \\mathrm{M}) + (1.0 \\times 10^{-2}\\ \\mathrm{s}^{-1})\n$$\n$$\nk_{\\mathrm{obs}} = (10.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}) + (1.0 \\times 10^{-2}\\ \\mathrm{s}^{-1})\n$$\n$$\nk_{\\mathrm{obs}} = (1.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}) + (1.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}) = 2.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}\n$$\nNow, calculate $t_{0.90}$:\n$$\nt_{0.90} = \\frac{\\ln(10)}{2.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}} \\approx \\frac{2.302585}{2.0 \\times 10^{-2}}\\ \\mathrm{s}\n$$\n$$\nt_{0.90} \\approx 115.12925\\ \\mathrm{s}\n$$\nThe problem requires rounding the final result to $3$ significant figures.\n$$\nt_{0.90} \\approx 115\\ \\mathrm{s}\n$$\nThis is the time required for the complex concentration to reach $90\\%$ of its final equilibrium value. The total receptor concentration $R_{\\mathrm{tot}}$ was not required for this specific calculation, as the time to reach a fraction of equilibrium depends only on the observed rate constant $k_{\\mathrm{obs}}$ which is independent of $R_{\\mathrm{tot}}$.", "answer": "$$ \\boxed{115} $$", "id": "2545449"}, {"introduction": "Signaling pathways do not just relay information; they actively process it, a concept best explored through a systems biology lens. This computational practice models the entire NF-$\\kappa$B network—a master regulator of immunity—as a linear system to investigate how it decodes time-varying inflammatory signals. By determining the optimal input frequency for gene expression, you will engage with the principles of frequency-dependent signal processing and appreciate how cells can function as biological filters to elicit specific responses. [@problem_id:2545424]", "problem": "You are given a principled, mechanistic model of how oscillatory Tumor Necrosis Factor (TNF) inputs are decoded by the Nuclear Factor kappa-light-chain-enhancer of activated B cells (NF-$\\kappa$B) signaling network and then drive expression of a short-lived target messenger ribonucleic acid (mRNA). The model is posed as a linear time-invariant system derived by linearizing the biochemical kinetics around a basal steady state. The input $u(t)$ is a square wave with amplitude $U_{\\max}$, frequency $f$ (in $1/\\mathrm{h}$), and duty cycle $\\delta \\in (0,1)$, switching between $0$ and $U_{\\max}$ every period $T = 1/f$ with an “on” duration $T_{\\mathrm{on}} = \\delta T$ and an “off” duration $T_{\\mathrm{off}} = (1-\\delta) T$. The state vector is $x(t) = [s(t), n(t), i(t), m(t)]^\\top$, where $s(t)$ represents a filtered receptor/IKK activation, $n(t)$ is nuclear NF-$\\kappa$B, $i(t)$ is the dominant I$\\kappa$B inhibitor, and $m(t)$ is mRNA of a target gene. The dynamics are\n$$\n\\frac{d}{dt}\n\\begin{bmatrix}\ns \\\\ n \\\\ i \\\\ m\n\\end{bmatrix}\n=\nA\n\\begin{bmatrix}\ns \\\\ n \\\\ i \\\\ m\n\\end{bmatrix}\n+\nb\\,u(t),\n\\quad\nA =\n\\begin{bmatrix}\n-\\frac{1}{\\tau_s} & 0 & 0 & 0 \\\\\nk_{as} & -k_{dn} & -k_{in} & 0 \\\\\n0 & k_{ai} & -k_{di} & 0 \\\\\n0 & \\alpha & 0 & -\\gamma\n\\end{bmatrix},\n\\quad\nb =\n\\begin{bmatrix}\n\\frac{1}{\\tau_s} \\\\ 0 \\\\ 0 \\\\ 0\n\\end{bmatrix}.\n$$\nAll rate constants are nonnegative and measured in $1/\\mathrm{h}$ (or $1/\\mathrm{h}$-consistent units), and time is measured in $\\mathrm{h}$. The initial condition is $x(0) = 0$.\n\nThe observable is the time-averaged mRNA over one period at the periodic steady state,\n$$\n\\overline{m}(f;\\delta) = \\frac{1}{T}\\int_{t^\\star}^{t^\\star+T} m(t)\\,dt,\n$$\nwhere $t^\\star$ is any time once the system has reached the unique periodic orbit induced by $u(t)$. Because the system is linear and asymptotically stable, this steady periodic solution exists and is unique for fixed $(f,\\delta)$, and $\\overline{m}(f;\\delta)$ is well defined.\n\nYour task is to write a program that, for each specified test case, searches over a given discrete grid of candidate frequencies and returns the frequency $f^\\star$ (in $1/\\mathrm{h}$) that maximizes $\\overline{m}(f;\\delta)$. To ensure reproducibility and computability without numerical transients, you must compute $\\overline{m}(f;\\delta)$ directly from the periodic steady state implied by the piecewise-constant input over a period, without simulating multiple periods.\n\nFundamental base to use:\n- Linearization of biochemical reaction networks around a steady state yields linear time-invariant dynamics for small perturbations, $\\dot{x} = A x + b u$, with $A$ Hurwitz (all eigenvalues have negative real part) for a stable network.\n- For constant inputs over an interval, the solution is $x(t) = e^{A t} x(0) + \\int_0^t e^{A (t-\\tau)} b\\,u\\, d\\tau$.\n- The time average over an interval can be computed by integrating the exact solution, using standard properties of the matrix exponential and its integrals.\n\nYou must implement the following computational approach in your program:\n1. For a given $f$ and $\\delta$, define $T = 1/f$, $T_{\\mathrm{on}} = \\delta T$, $T_{\\mathrm{off}} = (1-\\delta) T$, $u_{\\mathrm{on}} = U_{\\max}$, and $u_{\\mathrm{off}} = 0$.\n2. Let $\\Phi_{\\mathrm{on}} = e^{A T_{\\mathrm{on}}}$, $\\Phi_{\\mathrm{off}} = e^{A T_{\\mathrm{off}}}$, and $I$ be the identity. Define $K_{\\mathrm{on}} = A^{-1}(\\Phi_{\\mathrm{on}} - I)b\\,u_{\\mathrm{on}}$ and $K_{\\mathrm{off}} = A^{-1}(\\Phi_{\\mathrm{off}} - I)b\\,u_{\\mathrm{off}}$.\n3. The stroboscopic map over one full period is $x_{k+1} = \\Phi_{\\mathrm{off}}(\\Phi_{\\mathrm{on}} x_k + K_{\\mathrm{on}}) + K_{\\mathrm{off}}$. The steady periodic state at the start of the “on” phase, $x^\\star$, satisfies\n$$\n\\left(I - \\Phi_{\\mathrm{off}}\\Phi_{\\mathrm{on}}\\right) x^\\star = \\Phi_{\\mathrm{off}} K_{\\mathrm{on}} + K_{\\mathrm{off}}.\n$$\nSolve this linear system for $x^\\star$.\n4. The integral of $m(t)$ over the “on” and “off” segments, given initial states $x^\\star$ and $x^1 = \\Phi_{\\mathrm{on}} x^\\star + K_{\\mathrm{on}}$, is computed exactly. Let $c = [0,0,0,1]^\\top$ select $m(t) = c^\\top x(t)$. For a segment of duration $\\Delta$ with constant input $u$, initial state $x_0$, and matrix exponential $\\Phi(\\Delta) = e^{A \\Delta}$, the integral is\n$$\n\\int_0^\\Delta m(t)\\, dt\n=\nc^\\top A^{-1} \\left(\\Phi(\\Delta)-I\\right) x_0\n+\nc^\\top \\left(A^{-2}\\left(\\Phi(\\Delta)-I\\right) - A^{-1}\\Delta\\right) b\\,u.\n$$\nUse this for the “on” and “off” segments, sum, and divide by $T$ to obtain $\\overline{m}(f;\\delta)$.\n5. Over the provided discrete frequency grid, determine $f^\\star$ that maximizes $\\overline{m}(f;\\delta)$. If multiple frequencies achieve the same maximum within a tolerance $\\varepsilon = 10^{-9}$, choose the smallest $f$ among them.\n6. Report $f^\\star$ in $1/\\mathrm{h}$ rounded to exactly $3$ decimals.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., “[result1,result2,result3]”).\n\nTest Suite:\nFor each case, use the provided parameter set and candidate frequency grid. All parameters are in $1/\\mathrm{h}$ (for rates) and $\\mathrm{h}$ for times, with $U_{\\max}$ dimensionless.\n\n- Case $1$ (balanced feedback, moderate mRNA lifetime, “happy path”):\n  - $\\tau_s = 0.05$, $k_{as} = 3.0$, $k_{dn} = 0.7$, $k_{in} = 1.5$, $k_{ai} = 1.0$, $k_{di} = 0.5$, $\\alpha = 1.0$, $\\gamma = 2.0$, $U_{\\max} = 1.0$, $\\delta = 0.5$.\n  - Frequency grid $\\mathcal{F}_1 = [0.05, 0.08, 0.10, 0.15, 0.20, 0.30, 0.50, 0.80, 1.00, 1.50, 2.00]$.\n- Case $2$ (very short-lived gene product, high degradation):\n  - $\\tau_s = 0.05$, $k_{as} = 3.0$, $k_{dn} = 0.7$, $k_{in} = 1.5$, $k_{ai} = 1.0$, $k_{di} = 0.5$, $\\alpha = 1.0$, $\\gamma = 10.0$, $U_{\\max} = 1.0$, $\\delta = 0.5$.\n  - Frequency grid $\\mathcal{F}_2 = [0.05, 0.08, 0.10, 0.15, 0.20, 0.30, 0.50, 0.80, 1.00, 1.50, 2.00]$.\n- Case $3$ (slow inhibitor turnover and low duty cycle, boundary sensitivity):\n  - $\\tau_s = 0.05$, $k_{as} = 3.0$, $k_{dn} = 0.7$, $k_{in} = 1.2$, $k_{ai} = 1.0$, $k_{di} = 0.2$, $\\alpha = 1.0$, $\\gamma = 3.0$, $U_{\\max} = 1.0$, $\\delta = 0.1$.\n  - Frequency grid $\\mathcal{F}_3 = [0.05, 0.08, 0.10, 0.15, 0.20, 0.30, 0.50, 0.80, 1.00, 1.50, 2.00]$.\n\nFinal Output Format:\n- Your program must output a single line containing a list of the three maximizing frequencies $[f^\\star_1,f^\\star_2,f^\\star_3]$ corresponding to the three cases above, in $1/\\mathrm{h}$, each rounded to exactly $3$ decimals, with no additional text.", "solution": "The problem as stated is valid. It is scientifically sound, resting on the established principles of linear time-invariant (LTI) systems theory as applied to a linearized model of a biochemical network. The problem is well-posed, providing all necessary definitions, parameters, and a clear computational objective. It is also objective and free from ambiguity. I will therefore proceed with a solution.\n\nThe objective is to find the frequency $f^\\star$ from a discrete set $\\mathcal{F}$ that maximizes the steady-state time-averaged mRNA concentration, $\\overline{m}(f;\\delta)$, for a given set of system parameters. The system dynamics are described by an LTI model:\n$$\n\\frac{d x(t)}{dt} = A x(t) + b u(t)\n$$\nwhere $x(t) \\in \\mathbb{R}^4$ is the state vector, $u(t)$ is the periodic square-wave input, and the matrices $A$ and $b$ are defined by the given biochemical parameters. The observable is the mRNA level, given by $m(t) = c^\\top x(t)$ with the selector vector $c = [0, 0, 0, 1]^\\top$.\n\nThe core of the task is to compute $\\overline{m}(f;\\delta)$ for each candidate frequency $f \\in \\mathcal{F}$. This requires determining the unique periodic steady-state trajectory of the system under the forcing $u(t)$. The provided computational strategy avoids numerical simulation and calculates this value analytically. We follow the prescribed steps.\n\nFirst, for a given frequency $f$ and duty cycle $\\delta$, we define the period $T = 1/f$, the \"on\" duration $T_{\\mathrm{on}} = \\delta T$ with input $u_{\\mathrm{on}} = U_{\\max}$, and the \"off\" duration $T_{\\mathrm{off}} = (1-\\delta) T$ with input $u_{\\mathrm{off}} = 0$.\n\nSecond, we find the periodic orbit. The solution to the LTI system over an interval of length $\\Delta t$ with constant input $u$ and initial state $x(t_0)$ is:\n$$\nx(t_0 + \\Delta t) = e^{A \\Delta t} x(t_0) + \\int_{0}^{\\Delta t} e^{A(\\Delta t - \\tau)} b u \\, d\\tau = e^{A \\Delta t} x(t_0) + A^{-1}(e^{A \\Delta t} - I) b u\n$$\nLet $x^\\star$ be the state at the beginning of an \"on\" pulse in the periodic steady state. The state at the end of the \"on\" pulse is:\n$$\nx^1 = e^{A T_{\\mathrm{on}}} x^\\star + A^{-1}(e^{A T_{\\mathrm{on}}} - I) b u_{\\mathrm{on}}\n$$\nThe state at the end of the subsequent \"off\" pulse, which due to periodicity must be $x^\\star$ again, is:\n$$\nx^\\star = e^{A T_{\\mathrm{off}}} x^1 + A^{-1}(e^{A T_{\\mathrm{off}}} - I) b u_{\\mathrm{off}}\n$$\nSince $u_{\\mathrm{off}} = 0$, the second term vanishes. Substituting the expression for $x^1$ gives:\n$$\nx^\\star = e^{A T_{\\mathrm{off}}} \\left( e^{A T_{\\mathrm{on}}} x^\\star + A^{-1}(e^{A T_{\\mathrm{on}}} - I) b u_{\\mathrm{on}} \\right)\n$$\nWe define the state transition matrices $\\Phi_{\\mathrm{on}} = e^{A T_{\\mathrm{on}}}$ and $\\Phi_{\\mathrm{off}} = e^{A T_{\\mathrm{off}}}$, and the convolution integral terms $K_{\\mathrm{on}} = A^{-1}(\\Phi_{\\mathrm{on}} - I) b u_{\\mathrm{on}}$ and $K_{\\mathrm{off}} = 0$. The equation becomes:\n$$\nx^\\star = \\Phi_{\\mathrm{off}} ( \\Phi_{\\mathrm{on}} x^\\star + K_{\\mathrm{on}} ) = \\Phi_{\\mathrm{off}} \\Phi_{\\mathrm{on}} x^\\star + \\Phi_{\\mathrm{off}} K_{\\mathrm{on}}\n$$\nRearranging to solve for $x^\\star$:\n$$\n(I - \\Phi_{\\mathrm{off}} \\Phi_{\\mathrm{on}}) x^\\star = \\Phi_{\\mathrm{off}} K_{\\mathrm{on}}\n$$\nSince matrix exponentiation with the same matrix commutes, $\\Phi_{\\mathrm{off}} \\Phi_{\\mathrm{on}} = e^{A T_{\\mathrm{off}}} e^{A T_{\\mathrm{on}}} = e^{A(T_{\\mathrm{off}} + T_{\\mathrm{on}})} = e^{A T}$. The matrix $A$ is Hurwitz for the given parameters (all eigenvalues have negative real part), which guarantees that all eigenvalues of $e^{A T}$ have magnitude less than $1$. Therefore, the matrix $(I - e^{A T})$ is invertible, and a unique solution $x^\\star$ exists. We solve this $4 \\times 4$ linear system for $x^\\star$.\n\nThird, we calculate the time-averaged mRNA. The target quantity is $\\overline{m} = \\frac{1}{T} \\int_{t^\\star}^{t^\\star+T} m(t) dt$, evaluated on the periodic orbit. This integral is split into two parts corresponding to the on and off segments:\n$$\n\\int_0^T m(t) dt = \\int_0^{T_{\\mathrm{on}}} m(t) dt + \\int_{T_{\\mathrm{on}}}^{T} m(t) dt\n$$\nThe integral of the output $m(t)=c^\\top x(t)$ over a generic interval $[0, \\Delta]$ with constant input $u$ and initial state $x_0$ is given by the formula:\n$$\n\\int_0^{\\Delta} m(t)\\, dt = c^\\top \\int_0^{\\Delta} x(t)\\, dt = c^\\top \\left[ A^{-1}(\\Phi(\\Delta)-I)x_0 + \\left(A^{-2}(\\Phi(\\Delta)-I) - A^{-1}\\Delta\\right)bu \\right]\n$$\nwhere $\\Phi(\\Delta) = e^{A \\Delta}$. We apply this formula to each segment:\n-   **On-segment**: Here, $\\Delta = T_{\\mathrm{on}}$, the initial state is $x_0 = x^\\star$, and the input is $u = u_{\\mathrm{on}}$.\n    $$\n    \\text{Int}_{\\mathrm{on}} = c^\\top \\left[ A^{-1}(\\Phi_{\\mathrm{on}}-I)x^\\star + \\left(A^{-2}(\\Phi_{\\mathrm{on}}-I) - A^{-1}T_{\\mathrm{on}}\\right)bu_{\\mathrm{on}} \\right]\n    $$\n-   **Off-segment**: Here, $\\Delta = T_{\\mathrm{off}}$, the initial state is $x_0 = x^1 = \\Phi_{\\mathrm{on}} x^\\star + K_{\\mathrm{on}}$, and the input is $u = u_{\\mathrm{off}} = 0$, which simplifies the formula.\n    $$\n    \\text{Int}_{\\mathrm{off}} = c^\\top \\left[ A^{-1}(\\Phi_{\\mathrm{off}}-I)x^1 \\right]\n    $$\nThe total time-averaged mRNA is then:\n$$\n\\overline{m}(f;\\delta) = \\frac{1}{T} (\\text{Int}_{\\mathrm{on}} + \\text{Int}_{\\mathrm{off}})\n$$\n\nFourth, we perform the optimization over the frequency grid. The procedure outlined in the steps above is implemented as a function that takes frequency $f$ and system parameters as input and returns $\\overline{m}(f;\\delta)$. This function is called for every frequency in the provided grid $\\mathcal{F}_k$ for each test case $k$. We find the maximum value of $\\overline{m}$, which we denote $\\overline{m}_{\\max}$. We then identify all frequencies $\\{f_i\\} \\subseteq \\mathcal{F}_k$ for which $\\overline{m}(f_i; \\delta) \\ge \\overline{m}_{\\max} - \\varepsilon$, where $\\varepsilon=10^{-9}$ is the specified tolerance. The solution $f^\\star$ is the minimum frequency in this set, $\\min\\{f_i\\}$.\n\nThe final implementation encapsulates this logic in a Python script, utilizing `numpy` for linear algebra and `scipy.linalg.expm` for computing the matrix exponential, as required. The results for the three test cases are then collected and formatted as specified.", "answer": "$$ \\boxed{[0.300,0.500,0.800]} $$", "id": "2545424"}]}