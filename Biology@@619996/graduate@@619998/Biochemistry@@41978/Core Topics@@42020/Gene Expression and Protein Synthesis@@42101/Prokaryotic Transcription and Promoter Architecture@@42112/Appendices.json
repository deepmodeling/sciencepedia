{"hands_on_practices": [{"introduction": "The initiation of prokaryotic transcription is contingent upon the formation of the RNA Polymerase (RNAP) holoenzyme, an assembly of the core polymerase and a specificity-conferring sigma factor. This foundational exercise applies the principles of bimolecular binding equilibrium to a biologically relevant scenario. By calculating the concentration of active holoenzyme from the total concentrations of its components and their binding affinity, you will develop a quantitative intuition for the availability of the core transcriptional machinery, a critical parameter governing global gene expression [@problem_id:2590276].", "id": "2590276", "problem": "In a bacterium, the core RNA polymerase (RNAP) must bind a sigma factor to form the holoenzyme that recognizes the canonical minus-ten and minus-thirty-five promoter elements. Consider the reversible, one-to-one binding of core RNA polymerase and a single sigma factor species, which at steady state is governed by thermodynamic equilibrium. Let the binding reaction be core RNAP plus sigma factor forming holoenzyme. You are given the following parameters measured under cytosol-mimicking conditions at a fixed temperature:\n- Total core RNA polymerase concentration $R_{\\mathrm{tot}} = 2.5\\,\\mu\\text{M}$.\n- Total sigma factor concentration $S_{\\mathrm{tot}} = 1.3\\,\\mu\\text{M}$.\n- Dissociation constant for sigma-core binding $K_{d} = 0.08\\,\\mu\\text{M}$.\n\nAssume:\n- A one-to-one stoichiometry between core RNA polymerase and sigma factor.\n- No other binding partners (for example, no anti-sigma factors or promoter sequestration of holoenzyme).\n- Uniform mixing and thermodynamic equilibrium.\n\nCompute the fraction of total RNA polymerase present as holoenzyme at steady state. Express your final answer as a dimensionless decimal and round to four significant figures. Do not include any units in your final answer.", "solution": "The problem as stated describes a classic bimolecular binding equilibrium, a fundamental concept in biochemistry and physical chemistry. A validation of its premises is the mandatory first step.\n\nThe givens are explicitly stated:\n- The total concentration of core RNA polymerase, $R_{\\mathrm{tot}} = 2.5\\,\\mu\\text{M}$.\n- The total concentration of the sigma factor, $S_{\\mathrm{tot}} = 1.3\\,\\mu\\text{M}$.\n- The dissociation constant for the binding interaction, $K_{d} = 0.08\\,\\mu\\text{M}$.\nThe reaction is assumed to be a reversible one-to-one binding at thermodynamic equilibrium, with no other interacting species.\n\nThe problem is scientifically sound, resting on the well-established law of mass action. The numerical values provided for concentrations and the dissociation constant are biologically plausible for a prokaryotic system like *E. coli*. The problem is well-posed; it provides a complete set of parameters to determine a unique, physically meaningful solution for the equilibrium concentrations. The language is objective and unambiguous. Thus, the problem is deemed valid, and I shall proceed to derive the solution.\n\nThe binding reaction can be represented as:\n$$\n\\text{R} + \\text{S} \\rightleftharpoons \\text{H}\n$$\nwhere $\\text{R}$ is the free core RNA polymerase, $\\text{S}$ is the free sigma factor, and $\\text{H}$ is the holoenzyme complex.\n\nThe dissociation constant, $K_d$, is defined by the equilibrium concentrations of the species:\n$$\nK_d = \\frac{[\\text{R}][\\text{S}]}{[\\text{H}]}\n$$\nHere, $[\\text{R}]$, $[\\text{S}]$, and $[\\text{H}]$ represent the molar concentrations at equilibrium.\n\nThe total concentrations, $R_{\\mathrm{tot}}$ and $S_{\\mathrm{tot}}$, are conserved. The mass balance equations are:\n$$\nR_{\\mathrm{tot}} = [\\text{R}] + [\\text{H}]\n$$\n$$\nS_{\\mathrm{tot}} = [\\text{S}] + [\\text{H}]\n$$\nFrom these conservation laws, we can express the concentrations of the free species in terms of the holoenzyme concentration, $[\\text{H}]$:\n$$\n[\\text{R}] = R_{\\mathrm{tot}} - [\\text{H}]\n$$\n$$\n[\\text{S}] = S_{\\mathrm{tot}} - [\\text{H}]\n$$\nLet us denote the unknown equilibrium concentration of the holoenzyme as $x$, so that $x = [\\text{H}]$. Substituting these expressions into the definition of $K_d$:\n$$\nK_d = \\frac{(R_{\\mathrm{tot}} - x)(S_{\\mathrm{tot}} - x)}{x}\n$$\nTo solve for $x$, this equation must be rearranged into a standard quadratic form, $ax^2 + bx + c = 0$.\n$$\nK_d x = R_{\\mathrm{tot}}S_{\\mathrm{tot}} - R_{\\mathrm{tot}}x - S_{\\mathrm{tot}}x + x^2\n$$\n$$\nx^2 - (R_{\\mathrm{tot}} + S_{\\mathrm{tot}} + K_d)x + R_{\\mathrm{tot}}S_{\\mathrm{tot}} = 0\n$$\nThe solution for $x$ is given by the quadratic formula:\n$$\nx = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}\n$$\nFor our equation, the coefficients are $a=1$, $b = -(R_{\\mathrm{tot}} + S_{\\mathrm{tot}} + K_d)$, and $c = R_{\\mathrm{tot}}S_{\\mathrm{tot}}$.\nSubstituting these into the formula gives:\n$$\nx = \\frac{(R_{\\mathrm{tot}} + S_{\\mathrm{tot}} + K_d) \\pm \\sqrt{(R_{\\mathrm{tot}} + S_{\\mathrm{tot}} + K_d)^2 - 4R_{\\mathrm{tot}}S_{\\mathrm{tot}}}}{2}\n$$\nWe now insert the given numerical values: $R_{\\mathrm{tot}} = 2.5$, $S_{\\mathrm{tot}} = 1.3$, and $K_d = 0.08$. All concentrations are in units of $\\mu\\text{M}$.\nFirst, we compute the aggregate terms:\n$$\nR_{\\mathrm{tot}} + S_{\\mathrm{tot}} + K_d = 2.5 + 1.3 + 0.08 = 3.88\n$$\n$$\nR_{\\mathrm{tot}}S_{\\mathrm{tot}} = 2.5 \\times 1.3 = 3.25\n$$\nSubstituting these values into the solution for $x$:\n$$\nx = \\frac{3.88 \\pm \\sqrt{(3.88)^2 - 4(1)(3.25)}}{2}\n$$\n$$\nx = \\frac{3.88 \\pm \\sqrt{15.0544 - 13.0}}{2}\n$$\n$$\nx = \\frac{3.88 \\pm \\sqrt{2.0544}}{2}\n$$\nThe square root is approximately $\\sqrt{2.0544} \\approx 1.4333178$. This leads to two mathematical solutions for $x$:\n$$\nx_1 = \\frac{3.88 + 1.4333178}{2} = \\frac{5.3133178}{2} \\approx 2.6567\n$$\n$$\nx_2 = \\frac{3.88 - 1.4333178}{2} = \\frac{2.4466822}{2} \\approx 1.2233\n$$\nA physically meaningful solution must satisfy the constraints imposed by mass conservation. The concentration of the complex, $x$, cannot exceed the total concentration of any of its components. Therefore, $x \\le R_{\\mathrm{tot}}$ and $x \\le S_{\\mathrm{tot}}$. The more stringent condition is $x \\le S_{\\mathrm{tot}}$, or $x \\le 1.3\\,\\mu\\text{M}$.\n\nThe solution $x_1 \\approx 2.6567\\,\\mu\\text{M}$ is not physically possible as it exceeds both $R_{\\mathrm{tot}}$ and $S_{\\mathrm{tot}}$.\nThe solution $x_2 \\approx 1.2233\\,\\mu\\text{M}$ is physically valid as it is less than both $R_{\\mathrm{tot}}$ and $S_{\\mathrm{tot}}$.\nThus, the equilibrium concentration of the holoenzyme is $[\\text{H}] \\approx 1.2233411\\,\\mu\\text{M}$.\n\nThe question asks for the fraction of total RNA polymerase present as holoenzyme. This fraction, $f_H$, is the ratio of the holoenzyme concentration to the total core RNA polymerase concentration:\n$$\nf_H = \\frac{[\\text{H}]}{R_{\\mathrm{tot}}}\n$$\nSubstituting the values:\n$$\nf_H = \\frac{1.2233411}{2.5} \\approx 0.48933644\n$$\nRounding to four significant figures as required, the fraction is $0.4893$.", "answer": "$$\n\\boxed{0.4893}\n$$"}, {"introduction": "Once formed, the RNAP holoenzyme must locate and bind to specific promoter sequences on the DNA. This practice explores the quantitative relationship between a promoter's DNA sequence and its resulting gene expression level. You will use a Position Weight Matrix (PWM), a powerful bioinformatic tool, to score promoter sequences and translate this score into a biophysical binding affinity ($K_d$) and, ultimately, a predicted transcriptional output using a thermodynamic occupancy model. This exercise is central to understanding how sequence variations tune gene expression and is a cornerstone of synthetic promoter design [@problem_id:2590264].", "id": "2590264", "problem": "A promoter recognized by the primary bacterial sigma factor has a well-characterized hexameric element. You are given a Position Weight Matrix (PWM) that encodes position-specific nucleotide probabilities for this hexamer and a background nucleotide distribution. The PWM is specified as position-specific probabilities $\\{p_{i,b}\\}$, where $i \\in \\{1,\\dots,6\\}$ indexes the position and $b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}$ indexes the base. The background frequencies are $\\{q_b\\}$. The PWM and background are:\n- Background frequencies: $q_{\\mathrm{A}}=0.3$, $q_{\\mathrm{C}}=0.2$, $q_{\\mathrm{G}}=0.2$, $q_{\\mathrm{T}}=0.3$.\n- Position $1$: $\\mathrm{A}:0.1$, $\\mathrm{C}:0.1$, $\\mathrm{G}:0.1$, $\\mathrm{T}:0.7$.\n- Position $2$: $\\mathrm{A}:0.1$, $\\mathrm{C}:0.1$, $\\mathrm{G}:0.1$, $\\mathrm{T}:0.7$.\n- Position $3$: $\\mathrm{A}:0.15$, $\\mathrm{C}:0.1$, $\\mathrm{G}:0.6$, $\\mathrm{T}:0.15$.\n- Position $4$: $\\mathrm{A}:0.6$, $\\mathrm{C}:0.2$, $\\mathrm{G}:0.1$, $\\mathrm{T}:0.1$.\n- Position $5$: $\\mathrm{A}:0.1$, $\\mathrm{C}:0.6$, $\\mathrm{G}:0.2$, $\\mathrm{T}:0.1$.\n- Position $6$: $\\mathrm{A}:0.6$, $\\mathrm{C}:0.1$, $\\mathrm{G}:0.1$, $\\mathrm{T}:0.2$.\n\nAssume the PWM is to be scored using the natural-log likelihood ratio for a sequence $s$ as $S(s)=\\sum_{i=1}^{6}\\ln\\!\\big(p_{i,s_i}/q_{s_i}\\big)$, where $s_i$ is the base at position $i$, and that, at thermodynamic equilibrium, the binding free energy of RNA polymerase (RNAP) to the site is proportional to the negative of this score with proportionality constant equal to Boltzmann’s constant times absolute temperature $k_{\\mathrm{B}}T$. Consider a wild-type hexamer $s_{\\mathrm{WT}}=\\mathrm{TTGACA}$ and a variant $s_{\\mathrm{var}}=\\mathrm{TCTACA}$ in the same promoter.\n\nLet the wild-type dissociation constant be $K_d^{\\mathrm{WT}}=10\\,\\mathrm{nM}$ and the free concentration of RNA polymerase (RNAP) holoenzyme be $[R]=50\\,\\mathrm{nM}$. Using a standard thermodynamic occupancy model in which the probability that RNAP is promoter-bound is $P_{\\mathrm{bound}}=[R]/(K_d+[R])$, and assuming the transcription initiation rate is proportional to $P_{\\mathrm{bound}}$, compute the predicted change in $K_d$ for the variant relative to wild type and use it to estimate the fold-change in initiation rate for the variant relative to the wild type.\n\nReport only the fold-change in initiation rate for the variant relative to the wild type as a unitless decimal rounded to three significant figures. Use natural logarithms and express any intermediate energies symbolically in terms of $k_{\\mathrm{B}}T$ if needed, but the final reported value must be numeric and unitless as specified. Do not include any units in your final reported value.", "solution": "The problem requires the computation of the fold-change in the transcription initiation rate for a variant promoter sequence relative to a wild-type sequence. This change is determined by the change in the binding affinity of RNA polymerase (RNAP) to the promoter, which in turn is related to the sequence score calculated from a Position Weight Matrix (PWM). The problem is scientifically grounded and well-posed, providing all necessary information. We proceed with the solution.\n\nThe problem states that the score $S$ for a hexameric sequence $s = s_1s_2s_3s_4s_5s_6$ is given by the log-likelihood ratio:\n$$\nS(s) = \\sum_{i=1}^{6} \\ln\\left(\\frac{p_{i,s_i}}{q_{s_i}}\\right)\n$$\nwhere $p_{i,s_i}$ is the probability of observing base $s_i$ at position $i$ in the promoter motif, and $q_{s_i}$ is the background frequency of base $s_i$.\n\nThe binding free energy $\\Delta G$ is stated to be proportional to the negative of this score, with a proportionality constant of $k_{\\mathrm{B}}T$. This establishes the relationship:\n$$\n\\Delta G = -k_{\\mathrm{B}}T \\cdot S(s)\n$$\nThe standard thermodynamic relationship between the binding free energy and the dissociation constant $K_d$ is:\n$$\n\\Delta G = k_{\\mathrm{B}}T \\ln(K_d / C^{\\circ})\n$$\nwhere $C^{\\circ}$ is the standard state concentration, which we can set to $1\\,\\mathrm{M}$ or any other constant value. Since we will be working with differences in energy and ratios of constants, this term will cancel. For simplicity in notation, we absorb it and write $\\Delta G \\propto k_{\\mathrm{B}}T \\ln(K_d)$.\n\nThe change in binding free energy for the variant ($s_{\\mathrm{var}}$) relative to the wild-type ($s_{\\mathrm{WT}}$) is denoted $\\Delta \\Delta G$:\n$$\n\\Delta \\Delta G = \\Delta G^{\\mathrm{var}} - \\Delta G^{\\mathrm{WT}}\n$$\nUsing the two relationships for $\\Delta G$, we can express $\\Delta \\Delta G$ in two ways:\n$$\n\\Delta \\Delta G = \\left(-k_{\\mathrm{B}}T S(s_{\\mathrm{var}})\\right) - \\left(-k_{\\mathrm{B}}T S(s_{\\mathrm{WT}})\\right) = -k_{\\mathrm{B}}T \\left(S(s_{\\mathrm{var}}) - S(s_{\\mathrm{WT}})\\right)\n$$\n$$\n\\Delta \\Delta G = k_{\\mathrm{B}}T \\ln(K_d^{\\mathrm{var}}) - k_{\\mathrm{B}}T \\ln(K_d^{\\mathrm{WT}}) = k_{\\mathrm{B}}T \\ln\\left(\\frac{K_d^{\\mathrm{var}}}{K_d^{\\mathrm{WT}}}\\right)\n$$\nEquating these two expressions allows us to determine the change in the dissociation constant from the change in the sequence score:\n$$\nk_{\\mathrm{B}}T \\ln\\left(\\frac{K_d^{\\mathrm{var}}}{K_d^{\\mathrm{WT}}}\\right) = -k_{\\mathrm{B}}T \\left(S(s_{\\mathrm{var}}) - S(s_{\\mathrm{WT}})\\right)\n$$\n$$\n\\ln\\left(\\frac{K_d^{\\mathrm{var}}}{K_d^{\\mathrm{WT}}}\\right) = S(s_{\\mathrm{WT}}) - S(s_{\\mathrm{var}})\n$$\n$$\n\\frac{K_d^{\\mathrm{var}}}{K_d^{\\mathrm{WT}}} = \\exp\\left(S(s_{\\mathrm{WT}}) - S(s_{\\mathrm{var}})\\right)\n$$\nThe wild-type sequence is $s_{\\mathrm{WT}} = \\mathrm{TTGACA}$ and the variant is $s_{\\mathrm{var}} = \\mathrm{TCTACA}$. The sequences differ at position $i=2$ ($s_{2,\\mathrm{WT}}=\\mathrm{T}$, $s_{2,\\mathrm{var}}=\\mathrm{C}$) and position $i=3$ ($s_{3,\\mathrm{WT}}=\\mathrm{G}$, $s_{3,\\mathrm{var}}=\\mathrm{T}$). All other positions are identical. The difference in scores is therefore:\n$$\nS(s_{\\mathrm{WT}}) - S(s_{\\mathrm{var}}) = \\left[ \\ln\\left(\\frac{p_{2,\\mathrm{T}}}{q_{\\mathrm{T}}}\\right) + \\ln\\left(\\frac{p_{3,\\mathrm{G}}}{q_{\\mathrm{G}}}\\right) \\right] - \\left[ \\ln\\left(\\frac{p_{2,\\mathrm{C}}}{q_{\\mathrm{C}}}\\right) + \\ln\\left(\\frac{p_{3,\\mathrm{T}}}{q_{\\mathrm{T}}}\\right) \\right]\n$$\nSubstituting this into the expression for the ratio of dissociation constants:\n$$\n\\frac{K_d^{\\mathrm{var}}}{K_d^{\\mathrm{WT}}} = \\exp\\left( \\ln\\left(\\frac{p_{2,\\mathrm{T}}}{q_{\\mathrm{T}}}\\right) + \\ln\\left(\\frac{p_{3,\\mathrm{G}}}{q_{\\mathrm{G}}}\\right) - \\ln\\left(\\frac{p_{2,\\mathrm{C}}}{q_{\\mathrm{C}}}\\right) - \\ln\\left(\\frac{p_{3,\\mathrm{T}}}{q_{\\mathrm{T}}}\\right) \\right) = \\frac{ \\left(\\frac{p_{2,\\mathrm{T}}}{q_{\\mathrm{T}}}\\right) \\left(\\frac{p_{3,\\mathrm{G}}}{q_{\\mathrm{G}}}\\right) }{ \\left(\\frac{p_{2,\\mathrm{C}}}{q_{\\mathrm{C}}}\\right) \\left(\\frac{p_{3,\\mathrm{T}}}{q_{\\mathrm{T}}}\\right) }\n$$\nWe now substitute the given probability values:\n- Background: $q_{\\mathrm{T}}=0.3$, $q_{\\mathrm{G}}=0.2$, $q_{\\mathrm{C}}=0.2$.\n- Position $2$: $p_{2,\\mathrm{T}}=0.7$, $p_{2,\\mathrm{C}}=0.1$.\n- Position $3$: $p_{3,\\mathrm{G}}=0.6$, $p_{3,\\mathrm{T}}=0.15$.\nThe individual likelihood ratios are:\n$$\n\\frac{p_{2,\\mathrm{T}}}{q_{\\mathrm{T}}} = \\frac{0.7}{0.3} = \\frac{7}{3} \\quad, \\quad \\frac{p_{3,\\mathrm{G}}}{q_{\\mathrm{G}}} = \\frac{0.6}{0.2} = 3\n$$\n$$\n\\frac{p_{2,\\mathrm{C}}}{q_{\\mathrm{C}}} = \\frac{0.1}{0.2} = \\frac{1}{2} \\quad, \\quad \\frac{p_{3,\\mathrm{T}}}{q_{\\mathrm{T}}} = \\frac{0.15}{0.3} = \\frac{1}{2}\n$$\nThe ratio of dissociation constants is:\n$$\n\\frac{K_d^{\\mathrm{var}}}{K_d^{\\mathrm{WT}}} = \\frac{\\left(\\frac{7}{3}\\right)(3)}{\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right)} = \\frac{7}{\\frac{1}{4}} = 28\n$$\nGiven $K_d^{\\mathrm{WT}}=10\\,\\mathrm{nM}$, we find $K_d^{\\mathrm{var}}$:\n$$\nK_d^{\\mathrm{var}} = 28 \\times K_d^{\\mathrm{WT}} = 28 \\times 10\\,\\mathrm{nM} = 280\\,\\mathrm{nM}\n$$\nThe transcription initiation rate is assumed to be proportional to the promoter occupancy, $P_{\\mathrm{bound}}$. The occupancy is given by the thermodynamic model:\n$$\nP_{\\mathrm{bound}} = \\frac{[R]}{K_d + [R]}\n$$\nwhere $[R]=50\\,\\mathrm{nM}$ is the free concentration of RNAP. The fold-change in the initiation rate is the ratio of the occupancies:\n$$\n\\text{Fold-change} = \\frac{\\text{Rate}_{\\mathrm{var}}}{\\text{Rate}_{\\mathrm{WT}}} = \\frac{P_{\\mathrm{bound}}^{\\mathrm{var}}}{P_{\\mathrm{bound}}^{\\mathrm{WT}}} = \\frac{[R]/(K_d^{\\mathrm{var}} + [R])}{[R]/(K_d^{\\mathrm{WT}} + [R])} = \\frac{K_d^{\\mathrm{WT}} + [R]}{K_d^{\\mathrm{var}} + [R]}\n$$\nSubstituting the numerical values:\n$$\nP_{\\mathrm{bound}}^{\\mathrm{WT}} = \\frac{50\\,\\mathrm{nM}}{10\\,\\mathrm{nM} + 50\\,\\mathrm{nM}} = \\frac{50}{60} = \\frac{5}{6}\n$$\n$$\nP_{\\mathrm{bound}}^{\\mathrm{var}} = \\frac{50\\,\\mathrm{nM}}{280\\,\\mathrm{nM} + 50\\,\\mathrm{nM}} = \\frac{50}{330} = \\frac{5}{33}\n$$\nThe fold-change is the ratio of these probabilities:\n$$\n\\text{Fold-change} = \\frac{P_{\\mathrm{bound}}^{\\mathrm{var}}}{P_{\\mathrm{bound}}^{\\mathrm{WT}}} = \\frac{5/33}{5/6} = \\frac{5}{33} \\times \\frac{6}{5} = \\frac{6}{33} = \\frac{2}{11}\n$$\nAs a decimal, this is approximately $0.181818...$. Rounding to three significant figures, the result is $0.182$.", "answer": "$$\n\\boxed{0.182}\n$$"}, {"introduction": "The architecture of a promoter involves more than just the sequence of its consensus elements; their precise three-dimensional arrangement is also critical for function. This exercise delves into the phenomenon of helical phasing, where the transcriptional activity is modulated by the spacer length separating protein binding sites on the DNA helix. By fitting a sinusoidal model to hypothetical experimental data, you will practice a common research task: extracting fundamental biophysical parameters, such as the DNA helical repeat, from functional measurements. This problem highlights the importance of promoter geometry and connects theoretical models with practical data analysis skills [@problem_id:2590199].", "id": "2590199", "problem": "A transcription activator bound upstream of a bacterial promoter often stimulates recruitment of RNA Polymerase by direct protein–protein contact. In deoxyribonucleic acid (DNA), the B-form helix rotates approximately once every $R$ base pairs per turn, so increasing the center-to-center spacer length $L$ between the activator site and the contacted surface of RNA Polymerase rotates their relative orientation by an angle proportional to $L/R$. Under conditions where this rotational alignment dominates the contact geometry and other effects vary slowly with $L$, the steady-state transcriptional output (for example, a normalized activity) can be approximated as a sinusoidal function of $L$ with an unknown baseline, unknown amplitude, an unknown helical repeat $R$ (in base pairs per turn), and an unknown phase offset $\\phi$ (in radians). Your task is to estimate $R$ and $\\phi$ from given datasets of activity versus spacer length.\n\nStarting from fundamental facts:\n- The Central Dogma of molecular biology establishes the chain of information flow as DNA to ribonucleic acid (RNA) to protein, and transcription initiation is the primary regulated step in prokaryotes.\n- B-form DNA is a right-handed helix with a nearly constant repeat (helical pitch) per turn under physiological conditions, leading to a periodic rotational alignment as the spacer length $L$ changes by single base pairs.\n\nGiven these facts, you must:\n- Treat activity as a function that is periodic in $L$ with unknown period $R$ and unknown phase $\\phi$, with a slowly varying offset captured as a constant baseline and a scaling captured as an amplitude.\n- Use only the provided discrete measurements to infer $R$ (in base pairs per turn) and $\\phi$ (in radians), without assuming any fixed value for $R$ or $\\phi$ a priori.\n\nProgram requirements:\n- For each dataset, estimate the helical repeat $R$ (in base pairs per turn) and the phase offset $\\phi$ (in radians).\n- Report $\\phi$ wrapped to the interval $(-\\pi,\\pi]$.\n- Round both $R$ and $\\phi$ to three decimal places in the final output.\n- Because $R$ carries physical units, explicitly report $R$ in base pairs per turn (bp/turn), and report $\\phi$ in radians.\n- The final program output must be a single line containing a comma-separated list of three items, one per dataset, each item being a two-element list $[R,\\phi]$. The entire line must be enclosed in square brackets, with no extra whitespace. Example format: $[[r_1,\\phi_1],[r_2,\\phi_2],[r_3,\\phi_3]]$.\n- Angles are to be treated and reported in radians.\n\nTest suite (use these datasets exactly as given):\n\nDataset $1$ (happy path; wide coverage across more than one cycle, moderate amplitude):\n- Spacer lengths (in base pairs): $L_1 = [12,13,14,15,16,17,18,19,20,21,22,23]$.\n- Measured activities (dimensionless): $A_1 = [1.71961524,1.5,1.2,0.9,0.68038476,0.6,0.68038476,0.9,1.2,1.5,1.71961524,1.8]$.\n\nDataset $2$ (boundary condition; strong modulation, includes values near the baseline and a broad span of $L$):\n- Spacer lengths (in base pairs): $L_2 = [11,12,13,14,15,16,17,18,19,20,21,22]$.\n- Measured activities (dimensionless): $A_2 = [1.77942286,1.9,1.77942286,1.45,1.0,0.55,0.22057714,0.1,0.22057714,0.55,1.0,1.45]$.\n\nDataset $3$ (edge case; short $L$ range, low amplitude):\n- Spacer lengths (in base pairs): $L_3 = [14,15,16,17,18]$.\n- Measured activities (dimensionless): $A_3 = [0.925,1.0,1.075,1.12990381,1.15]$.\n\nAnswer specification:\n- Your program must infer the two parameters for each dataset and produce a single-line output containing a list of three items, where each item is the list $[R,\\phi]$ with $R$ in base pairs per turn (bp/turn) and $\\phi$ in radians, both rounded to three decimal places. For example, the printed line should look like $[[12.000,0.524],[12.000,0.000],[12.000,3.142]]$ if those were the computed values. The actual values must be computed by your program from the provided data.", "solution": "The user has presented a problem of parameter estimation from experimental data, grounded in the biophysics of prokaryotic gene regulation. Before proceeding, a rigorous validation is required.\n\n**Problem Validation**\n\n1.  **Extracted Givens**:\n    *   **Phenomenon**: Transcriptional activity is modulated by the spacer length $L$ between a transcription activator binding site and RNA Polymerase.\n    *   **Physical Basis**: The modulation arises from the helical nature of B-form DNA, which has a helical repeat of $R$ base pairs per turn.\n    *   **Mathematical Model**: The activity $A$ is approximated by the function $A(L) = C + B \\cos\\left(\\frac{2\\pi}{R}L + \\phi\\right)$.\n    *   **Unknown Parameters**: The baseline $C$, amplitude $B$, helical repeat $R$, and phase offset $\\phi$ are all unknown.\n    *   **Objective**: Estimate $R$ (in bp/turn) and $\\phi$ (in radians) from provided datasets.\n    *   **Data**: Three datasets of discrete measurements $(L_i, A_i)$ are provided.\n    *   **Output Constraints**: For each dataset, report $[R, \\phi]$ with both values rounded to three decimal places. The phase $\\phi$ must be in the interval $(-\\pi, \\pi]$. The final output is a list of these pairs.\n\n2.  **Validation Verdict**:\n    *   **Scientific Grounding**: The problem is scientifically sound. The premise of helical phasing affecting protein-protein interactions on DNA is a well-established concept in molecular biology. The use of a sinusoidal model is a standard and valid first-order approximation for this phenomenon.\n    *   **Well-Posedness**: The task is a well-posed parameter estimation problem. It requires fitting a non-linear model to data, for which standard numerical methods exist. The potential difficulty in accurately estimating parameters from limited data (as in Dataset $3$) reflects a real-world scientific challenge, not a flaw in the problem statement.\n    *   **Objectivity**: The problem is stated in precise, objective language and is free from subjective or non-scientific content.\n\nAll criteria for a valid scientific problem are met. The problem is deemed **valid**.\n\n**Solution Derivation**\n\nThe problem is to determine the parameters of the model\n$$ A(L) = C + B \\cos\\left(\\frac{2\\pi}{R}L + \\phi\\right) $$\nthat best fit the provided data pairs $(L_i, A_i)$. This is a non-linear least squares optimization problem. A naive search in the four-dimensional parameter space $(C, B, R, \\phi)$ can be unstable. A more robust method is to separate the linear and non-linear components of the model.\n\nUsing the trigonometric identity $\\cos(x+y) = \\cos(x)\\cos(y) - \\sin(x)\\sin(y)$, we can rewrite the model. Let the angular frequency be $\\omega = 2\\pi/R$. The model becomes:\n$$ A(L) = C + B (\\cos(\\omega L)\\cos(\\phi) - \\sin(\\omega L)\\sin(\\phi)) $$\nThis can be expressed as a linear combination of basis functions for a fixed $\\omega$:\n$$ A(L) = C + B_1 \\cos(\\omega L) + B_2 \\sin(\\omega L) $$\nwhere the linear parameters are $C$, $B_1 = B \\cos(\\phi)$, and $B_2 = -B \\sin(\\phi)$.\n\nFor any given value of the non-linear parameter $R$ (and thus $\\omega$), the problem reduces to a linear least squares fit. We can find the optimal parameters $C$, $B_1$, and $B_2$ that minimize the sum of squared residuals (SSR) for that specific $R$. The SSR is given by:\n$$ \\text{SSR}(R) = \\sum_{i=1}^{N} \\left( A_i - \\left( \\hat{C} + \\hat{B}_1 \\cos\\left(\\frac{2\\pi}{R}L_i\\right) + \\hat{B}_2 \\sin\\left(\\frac{2\\pi}{R}L_i\\right) \\right) \\right)^2 $$\nwhere $(\\hat{C}, \\hat{B}_1, \\hat{B}_2)$ are the solutions to the linear least squares problem for the given $R$.\n\nThis transforms the multi-dimensional optimization into a more manageable one-dimensional search for the optimal helical repeat, $R^*$, that minimizes $\\text{SSR}(R)$. The search for $R^*$ will be conducted over a physically plausible range. The helical repeat of B-form DNA under physiological conditions is typically near $10.5$ bp/turn. Therefore, a search interval of $R \\in [8.0, 14.0]$ bp/turn is appropriate. We will employ a numerical optimization routine to find the $R$ value within this interval that minimizes the SSR.\n\nThe overall algorithm is as follows:\n1.  Define an objective function that takes a candidate value for $R$, the spacer lengths $L$, and the activities $A$.\n2.  Inside this function:\n    a.  Calculate $\\omega = 2\\pi/R$.\n    b.  Construct the design matrix $\\mathbf{X}$ for the linear model, where the columns are $1$, $\\cos(\\omega L_i)$, and $\\sin(\\omega L_i)$.\n    c.  Solve the linear system $\\mathbf{X}\\boldsymbol{\\beta} = \\mathbf{A}$ for the parameter vector $\\boldsymbol{\\beta} = [C, B_1, B_2]^T$ using a standard least squares solver.\n    d.  Return the sum of squared residuals from this fit.\n3.  Use a scalar minimization algorithm to find the optimal $R^*$ that minimizes this objective function, bounded by the interval $[8.0, 14.0]$.\n4.  With the optimal $R^*$, perform one final linear least squares fit to obtain the optimal coefficients $\\hat{C}$, $\\hat{B}_1$, and $\\hat{B}_2$.\n5.  Recover the phase offset $\\phi$ from the linear coefficients. From their definitions, we have $\\hat{B}_1 = B \\cos(\\phi)$ and $\\hat{B}_2 = -B \\sin(\\phi)$. The phase $\\phi$ can be robustly computed using the two-argument arctangent function:\n    $$ \\phi^* = \\mathrm{atan2}(-\\hat{B}_2, \\hat{B}_1) $$\n    This function correctly resolves the quadrant and returns a value in the required interval $(-\\pi, \\pi]$.\n6.  The final parameters $R^*$ and $\\phi^*$ are then rounded to three decimal places as required. This procedure is applied independently to each of the three datasets provided.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves the parameter estimation problem for three datasets of transcriptional activity.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"L\": np.array([12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]),\n            \"A\": np.array([1.71961524, 1.5, 1.2, 0.9, 0.68038476, 0.6, 0.68038476, 0.9, 1.2, 1.5, 1.71961524, 1.8]),\n        },\n        {\n            \"L\": np.array([11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]),\n            \"A\": np.array([1.77942286, 1.9, 1.77942286, 1.45, 1.0, 0.55, 0.22057714, 0.1, 0.22057714, 0.55, 1.0, 1.45]),\n        },\n        {\n            \"L\": np.array([14, 15, 16, 17, 18]),\n            \"A\": np.array([0.925, 1.0, 1.075, 1.12990381, 1.15]),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        L_data, A_data = case[\"L\"], case[\"A\"]\n        \n        # Estimate parameters R (helical repeat) and phi (phase offset)\n        R_est, phi_est = estimate_params(L_data, A_data)\n        \n        results.append([round(R_est, 3), round(phi_est, 3)])\n        \n    # Format and print the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef estimate_params(L, A):\n    \"\"\"\n    Estimates the helical repeat (R) and phase (phi) from activity data.\n\n    This function implements a variable projection-like method. It separates the\n    non-linear parameter R from the linear parameters of the model. It then\n    performs a 1D optimization for R.\n\n    Args:\n        L (np.array): Array of spacer lengths.\n        A (np.array): Array of measured activities.\n\n    Returns:\n        tuple[float, float]: A tuple containing the estimated R and phi.\n    \"\"\"\n\n    def objective_function(R, L_data, A_data):\n        \"\"\"\n        Objective function to be minimized. It calculates the sum of squared\n        residuals for a given R after optimizing the linear parameters.\n        \"\"\"\n        if R <= 0:\n            return np.inf\n            \n        omega = 2 * np.pi / R\n        \n        # Design matrix for the linear part of the model: A = C + B1*cos(wL) + B2*sin(wL)\n        X = np.vstack([np.ones_like(L_data), np.cos(omega * L_data), np.sin(omega * L_data)]).T\n        \n        # Solve the linear least-squares problem for the coefficients [C, B1, B2]\n        # beta, residuals, rank, s = np.linalg.lstsq(...)\n        # The second return value `residuals` is the sum of squared residuals.\n        _, ssr, _, _ = np.linalg.lstsq(X, A_data, rcond=None)\n        \n        # If the fit is exact, ssr is an empty array.\n        if ssr.size == 0:\n            return 0.0\n        \n        return ssr[0]\n\n    # Perform a bounded 1D minimization to find the optimal R.\n    # The bounds [8, 14] are based on physical knowledge of B-DNA.\n    res = minimize_scalar(\n        objective_function,\n        bounds=(8.0, 14.0),\n        args=(L, A),\n        method='bounded'\n    )\n    \n    R_opt = res.x\n    \n    # With the optimal R, calculate the linear parameters one last time.\n    omega_opt = 2 * np.pi / R_opt\n    X_opt = np.vstack([np.ones_like(L), np.cos(omega_opt * L), np.sin(omega_opt * L)]).T\n    \n    beta_opt, _, _, _ = np.linalg.lstsq(X_opt, A, rcond=None)\n    C_opt, B1_opt, B2_opt = beta_opt\n    \n    # Recover phase phi from B1 = B*cos(phi) and B2 = -B*sin(phi)\n    # phi = atan2(-B2, B1) correctly handles quadrants and gives range (-pi, pi]\n    phi_opt = np.arctan2(-B2_opt, B1_opt)\n    \n    return R_opt, phi_opt\n\nsolve()\n```"}]}