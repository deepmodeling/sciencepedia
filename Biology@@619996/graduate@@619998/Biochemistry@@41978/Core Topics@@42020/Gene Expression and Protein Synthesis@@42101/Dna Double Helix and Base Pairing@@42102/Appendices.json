{"hands_on_practices": [{"introduction": "This first exercise grounds our study in the fundamental geometry of the B-DNA helix. By relating the average local parameters of rise and twist to the global helical pitch, you will derive a key structural property from first principles. [@problem_id:2557046] This practice reinforces the idealized helical model and develops skills in applying basic geometric reasoning to a complex biopolymer.", "problem": "A right-handed helical polymer is defined geometrically by a constant angular rotation per monomeric step and a constant axial translation per step. In the context of B-form deoxyribonucleic acid (B-DNA), an averaged polymer model is appropriate in which each base-pair step rotates by an average twist angle and translates by an average rise along the helical axis. Starting from the fundamental geometric definition of the pitch of a helix as the axial advance associated with a full rotation of $2\\pi$ radians, derive an expression for the helical pitch $P$ of B-DNA in terms of the average twist per base-pair step $\\langle \\Delta \\varphi \\rangle$ and the average rise per step $\\langle \\Delta z \\rangle$, without invoking any specialized formulas beyond these definitions. \n\nThen, using an average twist of $34.3^{\\circ}$ per base-pair step and an average axial rise $\\langle \\Delta z \\rangle = 0.3400\\,\\text{nm}$ for B-DNA under aqueous, near-physiological conditions, compute the numerical value of the helical pitch. Express the final pitch in nanometers and round your answer to four significant figures. You may use the identity $2\\pi\\,\\text{radians} = 360^{\\circ}$ for angle conversion as needed.", "solution": "The problem requires the derivation of an expression for the helical pitch, $P$, of B-DNA, followed by a numerical calculation based on provided average structural parameters. The problem is well-posed and scientifically sound, permitting a direct solution based on the fundamental definitions.\n\nWe begin from the definitions provided. The B-DNA polymer is modeled as a helix where each base-pair step is associated with an average axial translation, or rise, $\\langle \\Delta z \\rangle$, and an average angular rotation, or twist, $\\langle \\Delta \\varphi \\rangle$. The helical pitch, $P$, is defined as the total axial distance advanced along the helical axis during one complete revolution of $360^{\\circ}$ or $2\\pi$ radians.\n\nTo derive the expression for $P$, we must first determine the number of base-pair steps required to complete one full turn. Let us denote this number as $N_{bp/turn}$. This is a dimensionless quantity given by the ratio of the total angle in a full turn ($360^{\\circ}$) to the average twist angle per base-pair step ($\\langle \\Delta \\varphi \\rangle$):\n$$\nN_{bp/turn} = \\frac{360^{\\circ}}{\\langle \\Delta \\varphi \\rangle}\n$$\nThe total axial advance for one full turn, which is by definition the pitch $P$, is the product of the number of steps per turn, $N_{bp/turn}$, and the axial rise per step, $\\langle \\Delta z \\rangle$.\n$$\nP = N_{bp/turn} \\times \\langle \\Delta z \\rangle\n$$\nSubstituting the expression for $N_{bp/turn}$ into this equation, we obtain the general expression for the helical pitch in terms of the average step parameters:\n$$\nP = \\left( \\frac{360^{\\circ}}{\\langle \\Delta \\varphi \\rangle} \\right) \\langle \\Delta z \\rangle\n$$\nThis expression is derived solely from the fundamental geometric definitions as required.\n\nNow, we proceed to the numerical calculation. The problem provides the following averaged values for B-DNA in aqueous solution:\nAverage twist per base-pair step: $\\langle \\Delta \\varphi \\rangle = 34.3^{\\circ}$\nAverage axial rise per base-pair step: $\\langle \\Delta z \\rangle = 0.3400\\,\\text{nm}$\n\nFirst, we compute the number of base pairs per helical turn, $N_{bp/turn}$:\n$$\nN_{bp/turn} = \\frac{360^{\\circ}}{34.3^{\\circ}} \\approx 10.49562682\n$$\nNext, we calculate the pitch, $P$, using the derived formula:\n$$\nP = N_{bp/turn} \\times \\langle \\Delta z \\rangle \\approx 10.49562682 \\times 0.3400\\,\\text{nm}\n$$\n$$\nP \\approx 3.568513119\\,\\text{nm}\n$$\nThe problem explicitly instructs that the final answer be rounded to four significant figures. The first four significant figures are $3$, $5$, $6$, and $8$. The fifth significant digit is $5$, which requires rounding up the fourth digit.\n$$\nP \\approx 3.569\\,\\text{nm}\n$$\nThis is the final numerical value for the helical pitch of B-DNA under the specified conditions.", "answer": "$$\n\\boxed{3.569}\n$$", "id": "2557046"}, {"introduction": "We now transition from the static geometry of DNA to the thermodynamic principles governing its stability. This problem challenges you to derive the relationship between duplex melting temperature ($T_m$) and concentration, a cornerstone of van't Hoff analysis for bimolecular systems. [@problem_id:2557043] By working through this derivation, you will learn how to extract the standard enthalpy change ($\\Delta H^{\\circ}$) of duplex formation from experimental data, providing a quantitative measure of DNA stability.", "problem": "A non-self-complementary Deoxyribonucleic Acid (DNA) duplex is formed by hybridizing two distinct complementary strands, denoted $S$ and $S'$, in equimolar amounts at a total single-strand concentration $C_t$ (sum of $[S]$ and $[S']$). Assume a two-state transition $S + S' \\rightleftharpoons D$ with standard thermodynamic parameters $\\Delta H^{\\circ}$ and $\\Delta S^{\\circ}$ for the association reaction, constant pressure, and ionic strength fixed so that $\\Delta H^{\\circ}$ and $\\Delta S^{\\circ}$ are temperature independent over the transition range. The melting temperature $T_m$ is defined as the temperature at which half of all strands are base-paired in duplex.\n\nStarting only from (i) the law of mass action for the equilibrium constant $K = \\dfrac{[D]}{[S][S']}$, (ii) mass balance at the melting midpoint, and (iii) the van’t Hoff relation $\\dfrac{d \\ln K}{d(1/T)} = -\\dfrac{\\Delta H^{\\circ}}{R}$, derive a linear relationship between $1/T_m$ and $\\ln C_t$ for this bimolecular duplex formation. Identify the slope in terms of $\\Delta H^{\\circ}$.\n\nExperimentally, a linear regression of $1/T_m$ (in $\\mathrm{K}^{-1}$) versus $\\ln C_t$ (with $C_t$ in $\\mathrm{M}$) yields a slope $m = -2.00 \\times 10^{-5}\\ \\mathrm{K}^{-1}$. Using your derived relationship, compute the standard van’t Hoff enthalpy change $\\Delta H^{\\circ}$ for duplex formation. Express the final value in $\\mathrm{kJ\\ mol^{-1}}$, include the appropriate sign, and round your answer to $3$ significant figures.", "solution": "The problem as stated is scientifically grounded, self-contained, and well-posed. It is based on fundamental principles of chemical thermodynamics and their application to the biophysical chemistry of nucleic acids. The problem is valid and permits a rigorous solution.\n\nThe problem asks for the derivation of a linear relationship between the reciprocal of the melting temperature, $1/T_m$, and the natural logarithm of the total strand concentration, $\\ln C_t$, for the formation of a non-self-complementary DNA duplex. It then requires the calculation of the standard enthalpy change, $\\Delta H^{\\circ}$, from experimental data.\n\nThe association reaction for two distinct complementary strands, $S$ and $S'$, to form a duplex, $D$, is given by the equilibrium:\n$$S + S' \\rightleftharpoons D$$\nThe equilibrium constant, $K$, for this association reaction is defined by the law of mass action as:\n$$K = \\frac{[D]}{[S][S']}$$\nwhere $[S]$, $[S']$, and $[D]$ are the molar concentrations of the single strands and the duplex at equilibrium, respectively.\n\nThe total concentration of each type of strand is defined by mass balance. Since the strands are added in equimolar amounts, the initial total concentration of each is $C_t/2$. Thus:\n$$[S]_{total} = [S] + [D] = \\frac{C_t}{2}$$\n$$[S']_{total} = [S'] + [D] = \\frac{C_t}{2}$$\nFrom these two equations, it is clear that at any point in the equilibrium, the concentrations of the free single strands are equal: $[S] = [S']$.\n\nThe melting temperature, $T_m$, is defined as the temperature at which half of the total strands are incorporated into duplexes. The total concentration of strands, considered as monomeric units, is $C_t$. The concentration of strands within duplexes is $2[D]$. At $T = T_m$, the fraction of strands in duplex form is $1/2$.\n$$\\frac{2[D]}{C_t} = \\frac{1}{2}$$\nFrom this condition, the concentration of duplex at the melting temperature is:\n$$[D] = \\frac{C_t}{4}$$\nWe can now determine the concentrations of the free single strands at $T = T_m$ using the mass balance equation:\n$$[S] = [S]_{total} - [D] = \\frac{C_t}{2} - \\frac{C_t}{4} = \\frac{C_t}{4}$$\nAnd since $[S] = [S']$:\n$$[S'] = \\frac{C_t}{4}$$\nNow, we can express the equilibrium constant at the melting temperature, $K(T_m)$, in terms of the total concentration $C_t$:\n$$K(T_m) = \\frac{[D]}{[S][S']} = \\frac{C_t/4}{(C_t/4)(C_t/4)} = \\frac{1}{C_t/4} = \\frac{4}{C_t}$$\nThis equation establishes a relationship between the equilibrium constant and the total strand concentration, which is valid specifically at the melting temperature $T_m$ corresponding to that concentration.\n\nTo relate $T_m$ to $C_t$, we use the van't Hoff relation. The integrated form of the van't Hoff equation relates the equilibrium constant $K$ to the temperature $T$, assuming $\\Delta H^{\\circ}$ and $\\Delta S^{\\circ}$ are constant:\n$$\\ln K = -\\frac{\\Delta H^{\\circ}}{RT} + \\frac{\\Delta S^{\\circ}}{R}$$\nThis equation holds at any temperature, including $T_m$. The problem requires starting from the differential form, which is:\n$$\\frac{d \\ln K}{d(1/T)} = -\\frac{\\Delta H^{\\circ}}{R}$$\nWe have established that at the melting temperature, $K(T_m) = 4/C_t$. Taking the natural logarithm gives:\n$$\\ln K(T_m) = \\ln(4) - \\ln(C_t)$$\nSince $T_m$ is a function of $C_t$, we may differentiate this expression. Let us consider infinitesimal changes in $C_t$ and the corresponding changes in $T_m$. Differentiating the expression for $\\ln K(T_m)$ yields:\n$$d(\\ln K) = -d(\\ln C_t)$$\nFrom the van't Hoff equation, an infinitesimal change in temperature $d(1/T_m)$ corresponds to a change in the equilibrium constant $d(\\ln K)$ as:\n$$d(\\ln K) = -\\frac{\\Delta H^{\\circ}}{R} d(1/T_m)$$\nEquating the two expressions for $d(\\ln K)$:\n$$-d(\\ln C_t) = -\\frac{\\Delta H^{\\circ}}{R} d(1/T_m)$$\nRearranging this differential equation gives the derivative of $1/T_m$ with respect to $\\ln C_t$:\n$$\\frac{d(1/T_m)}{d(\\ln C_t)} = \\frac{R}{\\Delta H^{\\circ}}$$\nThis result shows that a plot of $1/T_m$ versus $\\ln C_t$ is linear, and its slope, $m$, is given by:\n$$m = \\frac{R}{\\Delta H^{\\circ}}$$\nThis is the derived linear relationship and the identification of the slope.\n\nThe second part of the problem requires calculating $\\Delta H^{\\circ}$ using the experimentally determined slope $m = -2.00 \\times 10^{-5}\\ \\mathrm{K}^{-1}$. The ideal gas constant is $R = 8.314\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$.\nFrom the slope expression, we solve for $\\Delta H^{\\circ}$:\n$$\\Delta H^{\\circ} = \\frac{R}{m}$$\nSubstituting the given values:\n$$\\Delta H^{\\circ} = \\frac{8.314\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}}{-2.00 \\times 10^{-5}\\ \\mathrm{K}^{-1}}$$\n$$\\Delta H^{\\circ} = -415700\\ \\mathrm{J\\ mol^{-1}}$$\nThe result is negative, which is expected as duplex formation is an exothermic process driven by the formation of hydrogen bonds and base stacking interactions.\nThe problem requires the answer in units of $\\mathrm{kJ\\ mol^{-1}}$ and rounded to $3$ significant figures.\n$$\\Delta H^{\\circ} = -415700\\ \\mathrm{J\\ mol^{-1}} \\times \\frac{1\\ \\mathrm{kJ}}{1000\\ \\mathrm{J}} = -415.7\\ \\mathrm{kJ\\ mol^{-1}}$$\nRounding to three significant figures, we get:\n$$\\Delta H^{\\circ} \\approx -416\\ \\mathrm{kJ\\ mol^{-1}}$$\nThis completes the required calculation.", "answer": "$$ \\boxed{-416} $$", "id": "2557043"}, {"introduction": "Our final practice moves to the cutting edge of computational biophysics to explore the dynamic behavior of the DNA helix at a microscopic level. This exercise introduces Markov state models (MSMs) as a powerful framework to analyze molecular dynamics simulations and predict kinetic observables. [@problem_id:2557089] By implementing the steps to calculate the imino proton exchange rate from a given model, you will gain practical insight into how computational methods connect atomic-scale fluctuations to experimentally measurable processes like base-pair \"breathing.\"", "problem": "You are given a set of physically plausible Markov state model (MSM) specifications representing molecular dynamics (MD) coarse-grained microstates of a single deoxyribonucleic acid (DNA) base pair that can interconvert between closed and open conformations. The opening exposes the imino proton to solvent, enabling exchange. Your task is to compute the equilibrium population of the open macrostate and the predicted imino proton exchange rate for each MSM using first principles of Markov processes and the Linderstrøm–Lang two-step exchange mechanism. All required outputs are dimensionless or in per-second units as specified, and the final program must output a single line containing the results for all test cases.\n\nFundamental bases and definitions to be used:\n- A discrete-time MSM at lag time $\\tau$ is defined by a row-stochastic transition matrix $T(\\tau)$ obtained from a continuous-time generator (rate) matrix $K$ through $T(\\tau) = \\exp(\\tau K)$, where $\\exp$ denotes the matrix exponential. The generator $K$ has off-diagonal elements $K_{ij} \\ge 0$ for $i \\ne j$ and diagonal elements $K_{ii} = -\\sum_{j \\ne i} K_{ij}$.\n- The stationary distribution $\\boldsymbol{\\pi}$ satisfies $\\boldsymbol{\\pi}^\\top T(\\tau) = \\boldsymbol{\\pi}^\\top$ and $\\sum_i \\pi_i = 1$. When $K$ satisfies detailed balance with respect to energies $E_i$ (in units of thermal energy $k_\\mathrm{B}T$), then $\\pi_i \\propto \\exp(-E_i)$.\n- Coarse-graining to two macrostates, closed $\\mathcal{C}$ and open $\\mathcal{O}$, defines equilibrium populations $p_\\mathcal{C} = \\sum_{i \\in \\mathcal{C}} \\pi_i$ and $p_\\mathcal{O} = \\sum_{i \\in \\mathcal{O}} \\pi_i$. The macrostate transition probabilities at lag time $\\tau$ are defined by stationary-distribution-weighted averages:\n$$\nP_{\\mathcal{C}\\to \\mathcal{O}}(\\tau) = \\frac{1}{p_\\mathcal{C}} \\sum_{i \\in \\mathcal{C}} \\pi_i \\sum_{j \\in \\mathcal{O}} T_{ij}(\\tau), \\quad\nP_{\\mathcal{O}\\to \\mathcal{C}}(\\tau) = \\frac{1}{p_\\mathcal{O}} \\sum_{i \\in \\mathcal{O}} \\pi_i \\sum_{j \\in \\mathcal{C}} T_{ij}(\\tau).\n$$\n- Assume that the coarse-grained two-state dynamics is well described by a continuous-time two-state process with opening and closing rate constants $k_\\mathrm{op}$ and $k_\\mathrm{cl}$ (in $\\mathrm{s}^{-1}$), respectively, that reproduces the macrostate transition probabilities at lag time $\\tau$.\n- The Linderstrøm–Lang two-step exchange model for imino proton exchange posits that exchange occurs only from the open state with an intrinsic chemical rate $k_\\mathrm{ch}$ (in $\\mathrm{s}^{-1}$). The observable exchange rate constant $k_\\mathrm{ex}$ (in $\\mathrm{s}^{-1}$) emerges from coupling of opening/closing with the chemical step.\n\nYour tasks:\n1. For each test case, construct the continuous-time generator $K$ from given microstate energies and symmetric connectivity with base attempt rates $a_{ij}$ as follows. For every undirected edge $(i,j)$ with base rate $a_{ij}$:\n   - Set $K_{ij} = a_{ij}\\,\\exp\\!\\left( -\\frac{E_j - E_i}{2} \\right)$ and $K_{ji} = a_{ij}\\,\\exp\\!\\left( -\\frac{E_i - E_j}{2} \\right)$ to enforce detailed balance with respect to $E_i$.\n   - Set $K_{ii} = -\\sum_{j\\ne i} K_{ij}$ for each $i$.\n2. Compute $T(\\tau) = \\exp(\\tau K)$, then compute the stationary distribution $\\boldsymbol{\\pi}$ from $T(\\tau)$.\n3. Compute the equilibrium open population $p_\\mathcal{O}$.\n4. Compute the macrostate transition probabilities $P_{\\mathcal{C}\\to \\mathcal{O}}(\\tau)$ and $P_{\\mathcal{O}\\to \\mathcal{C}}(\\tau)$ using the stationary-distribution-weighted definitions above.\n5. Infer $k_\\mathrm{op}$ and $k_\\mathrm{cl}$ (in $\\mathrm{s}^{-1}$) of the effective continuous-time two-state process that exactly reproduces the macrostate transition probabilities at lag time $\\tau$.\n6. Using the Linderstrøm–Lang two-step mechanism, compute the predicted imino proton exchange rate $k_\\mathrm{ex}$ (in $\\mathrm{s}^{-1}$) from the obtained $k_\\mathrm{op}$, $k_\\mathrm{cl}$, and the provided $k_\\mathrm{ch}$.\n\nExpress $p_\\mathcal{O}$ as a dimensionless fraction, and $k_\\mathrm{op}$ and $k_\\mathrm{ex}$ in $\\mathrm{s}^{-1}$. Round all reported numbers to six decimal places.\n\nTest suite (all cases have microstates labeled $0,1,2,3,4$, with closed macrostate $\\mathcal{C}=\\{0,1,2\\}$ and open macrostate $\\mathcal{O}=\\{3,4\\}$; time lag $\\tau$ is in seconds; energies $E_i$ are in units of $k_\\mathrm{B}T$; base rates $a_{ij}$ are in $\\mathrm{s}^{-1}$):\n\n- Case A (rare opening, exchange-limited by closing; expected Exchange Regime $\\mathrm{EX2}$):\n  - Energies: $[\\,0.0,\\; 0.2,\\; 0.3,\\; 4.0,\\; 4.1\\,]$.\n  - Undirected edges with base attempt rates $a_{ij}$:\n    - Within $\\mathcal{C}$: $(0,1):\\, 2.0\\times 10^{6}$; $(1,2):\\, 1.5\\times 10^{6}$; $(0,2):\\, 5.0\\times 10^{5}$.\n    - Within $\\mathcal{O}$: $(3,4):\\, 5.0\\times 10^{5}$.\n    - Between $\\mathcal{C}$ and $\\mathcal{O}$: $(2,3):\\, 2.0\\times 10^{2}$.\n  - Lag time: $\\tau = 1.0\\times 10^{-6}$.\n  - Intrinsic chemical exchange rate: $k_\\mathrm{ch} = 1.0\\times 10^{1}$.\n\n- Case B (moderate opening, chemistry-limited; expected Exchange Regime $\\mathrm{EX1}$):\n  - Energies: $[\\,0.0,\\; 0.2,\\; 0.3,\\; 2.0,\\; 2.2\\,]$.\n  - Undirected edges with base attempt rates $a_{ij}$:\n    - Within $\\mathcal{C}$: $(0,1):\\, 2.0\\times 10^{6}$; $(1,2):\\, 1.5\\times 10^{6}$; $(0,2):\\, 5.0\\times 10^{5}$.\n    - Within $\\mathcal{O}$: $(3,4):\\, 8.0\\times 10^{5}$.\n    - Between $\\mathcal{C}$ and $\\mathcal{O}$: $(2,3):\\, 1.0\\times 10^{3}$.\n  - Lag time: $\\tau = 1.0\\times 10^{-6}$.\n  - Intrinsic chemical exchange rate: $k_\\mathrm{ch} = 1.0\\times 10^{5}$.\n\n- Case C (extremely rare opening; expected Exchange Regime $\\mathrm{EX2}$):\n  - Energies: $[\\,0.0,\\; 0.2,\\; 0.3,\\; 7.0,\\; 7.2\\,]$.\n  - Undirected edges with base attempt rates $a_{ij}$:\n    - Within $\\mathcal{C}$: $(0,1):\\, 2.0\\times 10^{6}$; $(1,2):\\, 1.5\\times 10^{6}$; $(0,2):\\, 5.0\\times 10^{5}$.\n    - Within $\\mathcal{O}$: $(3,4):\\, 3.0\\times 10^{5}$.\n    - Between $\\mathcal{C}$ and $\\mathcal{O}$: $(2,3):\\, 5.0\\times 10^{1}$.\n  - Lag time: $\\tau = 1.0\\times 10^{-6}$.\n  - Intrinsic chemical exchange rate: $k_\\mathrm{ch} = 1.0$.\n\nRequired final output format:\n- Your program should produce a single line of output containing a list of results, one per test case, where each result is itself a list of three numbers in the order $[\\,p_\\mathcal{O},\\; k_\\mathrm{op},\\; k_\\mathrm{ex}\\,]$.\n- All numbers must be rounded to six decimal places.\n- The entire output must appear on a single line in the exact format:\n  - Example structure (illustrative only): $[[0.012345,1.234567,0.123456],[\\dots],[\\dots]]$.\n\nNo additional text or formatting should be printed.\n\nYour program must implement the construction of $K$, computation of $T(\\tau)$, evaluation of $\\boldsymbol{\\pi}$, coarse-graining, inference of $k_\\mathrm{op}$ and $k_\\mathrm{cl}$ consistent with a continuous-time two-state reduction, and finally the calculation of $k_\\mathrm{ex}$, all from first principles as described above. All rates must be reported in $\\mathrm{s}^{-1}$ and $p_\\mathcal{O}$ is dimensionless. Angles are not involved. Do not use percentage signs; if any fractional quantities are needed, they must be dimensionless decimal fractions.", "solution": "The problem statement has been critically examined and is determined to be valid. It is a well-posed, scientifically grounded problem in the field of biophysical chemistry, requiring the application of first principles of Markov state models and chemical kinetics. All necessary data and definitions are provided, and there are no internal contradictions or logical fallacies. We will now proceed with a complete, reasoned solution.\n\nThe solution follows a systematic, six-step procedure for each test case, as delineated in the problem statement. The microstates are indexed from $0$ to $4$, with the closed macrostate $\\mathcal{C}$ comprising microstates $\\{0, 1, 2\\}$ and the open macrostate $\\mathcal{O}$ comprising microstates $\\{3, 4\\}$.\n\nStep 1: Construction of the Continuous-Time Generator Matrix $K$\n\nThe generator matrix $K$, also known as the rate matrix, governs the continuous-time Markov process. Its off-diagonal elements $K_{ij}$ ($i \\ne j$) represent the rate of transition from state $i$ to state $j$. The diagonal elements $K_{ii}$ represent the total rate of exit from state $i$, given by $K_{ii} = -\\sum_{j \\ne i} K_{ij}$.\n\nThe problem specifies the construction of $K$ from the microstate energies $E_i$ (in units of thermal energy $k_\\mathrm{B}T$) and base attempt rates $a_{ij}$ (in $\\mathrm{s}^{-1}$) for each connected pair of states $(i,j)$. This construction is designed to satisfy the principle of detailed balance. For each undirected edge $(i,j)$ with base rate $a_{ij}$, the corresponding elements of $K$ are:\n$$\nK_{ij} = a_{ij}\\,\\exp\\!\\left( -\\frac{E_j - E_i}{2} \\right)\n$$\n$$\nK_{ji} = a_{ij}\\,\\exp\\!\\left( -\\frac{E_i - E_j}{2} \\right)\n$$\nAll other off-diagonal elements $K_{ij}$ for which no edge is specified are zero. After all off-diagonal elements are populated, the diagonal elements are calculated as $K_{ii} = -\\sum_{j \\ne i} K_{ij}$. This construction ensures that the system, if left to evolve, will reach an equilibrium state consistent with Boltzmann statistics.\n\nStep 2: Computation of the Stationary Distribution $\\boldsymbol{\\pi}$ and Transition Matrix $T(\\tau)$\n\nThe stationary distribution $\\boldsymbol{\\pi} = (\\pi_0, \\pi_1, \\dots, \\pi_4)$ gives the equilibrium probability of occupying each microstate. Because the generator $K$ is constructed to obey detailed balance with respect to the energies $E_i$, the stationary distribution is the Boltzmann distribution. The probability $\\pi_i$ of being in state $i$ is proportional to $\\exp(-E_i)$. By enforcing the normalization condition $\\sum_i \\pi_i = 1$, we obtain:\n$$\n\\pi_i = \\frac{\\exp(-E_i)}{\\sum_{j} \\exp(-E_j)}\n$$\nThis direct calculation from energies is more robust and fundamental than numerically computing the leading eigenvector of the transition matrix.\n\nThe discrete-time transition matrix $T(\\tau)$ describes the probabilities of transition between states over a finite lag time $\\tau$. It is related to the generator $K$ via the matrix exponential:\n$$\nT(\\tau) = \\exp(\\tau K)\n$$\nwhere $\\tau$ is the given lag time. This will be computed numerically.\n\nStep 3: Computation of the Equilibrium Open Population $p_\\mathcal{O}$\n\nThe system is coarse-grained into two macrostates: closed ($\\mathcal{C}$) and open ($\\mathcal{O}$). The equilibrium population of the open macrostate, $p_\\mathcal{O}$, is the sum of the stationary probabilities of all microstates belonging to $\\mathcal{O}$. Similarly, the population of the closed macrostate is $p_\\mathcal{C}$.\n$$\np_\\mathcal{O} = \\sum_{i \\in \\mathcal{O}} \\pi_i = \\sum_{i=3}^{4} \\pi_i\n$$\n$$\np_\\mathcal{C} = \\sum_{i \\in \\mathcal{C}} \\pi_i = \\sum_{i=0}^{2} \\pi_i = 1 - p_\\mathcal{O}\n$$\n$p_\\mathcal{O}$ is a key observable, representing the fraction of time the base pair spends in a conformation susceptible to proton exchange.\n\nStep 4: Computation of Macrostate Transition Probabilities\n\nThe macrostate transition probabilities, $P_{\\mathcal{C}\\to \\mathcal{O}}(\\tau)$ and $P_{\\mathcal{O}\\to \\mathcal{C}}(\\tau)$, quantify the likelihood of switching between the closed and open macrostates over the lag time $\\tau$, given the system is at equilibrium. They are calculated using the stationary-distribution-weighted formulas provided:\n$$\nP_{\\mathcal{C}\\to \\mathcal{O}}(\\tau) = \\frac{1}{p_\\mathcal{C}} \\sum_{i \\in \\mathcal{C}} \\pi_i \\sum_{j \\in \\mathcal{O}} T_{ij}(\\tau) = \\frac{\\sum_{i=0}^{2} \\sum_{j=3}^{4} \\pi_i T_{ij}(\\tau)}{p_\\mathcal{C}}\n$$\n$$\nP_{\\mathcal{O}\\to \\mathcal{C}}(\\tau) = \\frac{1}{p_\\mathcal{O}} \\sum_{i \\in \\mathcal{O}} \\pi_i \\sum_{j \\in \\mathcal{C}} T_{ij}(\\tau) = \\frac{\\sum_{i=3}^{4} \\sum_{j=0}^{2} \\pi_i T_{ij}(\\tau)}{p_\\mathcal{O}}\n$$\nA consequence of detailed balance is that the total equilibrium flux between the macrostates is equal in both directions, which implies the relation $p_\\mathcal{C} P_{\\mathcal{C}\\to \\mathcal{O}}(\\tau) = p_\\mathcal{O} P_{\\mathcal{O}\\to \\mathcal{C}}(\\tau)$. This serves as a useful consistency check.\n\nStep 5: Inference of Effective Two-State Rate Constants $k_\\mathrm{op}$ and $k_\\mathrm{cl}$\n\nThe complex multi-state dynamics are projected onto a simple two-state continuous-time Markov process: $\\mathcal{C} \\underset{k_\\mathrm{cl}}{\\stackrel{k_\\mathrm{op}}{\\rightleftharpoons}} \\mathcal{O}$. The rates $k_\\mathrm{op}$ and $k_\\mathrm{cl}$ are inferred by requiring that this simple model reproduces the macrostate transition probabilities calculated in Step 4. For a two-state continuous process, the probability of transitioning from $\\mathcal{C}$ to $\\mathcal{O}$ in time $\\tau$ is given by:\n$$\nP_{\\mathcal{C}\\to \\mathcal{O}}(\\tau) = p_\\mathcal{O} \\left(1 - \\exp\\left(-(k_\\mathrm{op} + k_\\mathrm{cl})\\tau\\right)\\right)\n$$\nSolving for the sum of rates $S = k_\\mathrm{op} + k_\\mathrm{cl}$ yields:\n$$\nS = k_\\mathrm{op} + k_\\mathrm{cl} = -\\frac{1}{\\tau} \\ln\\left(1 - \\frac{P_{\\mathcal{C}\\to \\mathcal{O}}(\\tau)}{p_\\mathcal{O}}\\right)\n$$\nAt the macrostate level, detailed balance requires $p_\\mathcal{C} k_\\mathrm{op} = p_\\mathcal{O} k_\\mathrm{cl}$. Using this relation along with the expression for their sum $S$, we can solve for the individual rates:\n$$\nk_\\mathrm{op} = S \\cdot p_\\mathcal{O} \\quad \\text{and} \\quad k_\\mathrm{cl} = S \\cdot p_\\mathcal{C}\n$$\nThese equations provide the effective opening and closing rates in units of $\\mathrm{s}^{-1}$.\n\nStep 6: Computation of the Predicted Imino Proton Exchange Rate $k_\\mathrm{ex}$\n\nThe final step is to predict the experimentally observable imino proton exchange rate, $k_\\mathrm{ex}$, using the Linderstrøm-Lang two-step model. This model assumes that exchange can only happen from the open state with an intrinsic chemical rate $k_\\mathrm{ch}$. The kinetic scheme is:\n$$\n\\text{Closed} \\underset{k_\\mathrm{cl}}{\\stackrel{k_\\mathrm{op}}{\\rightleftharpoons}} \\text{Open} \\xrightarrow{k_\\mathrm{ch}} \\text{Exchanged}\n$$\nApplying the steady-state approximation to the transient 'Open' intermediate, we derive the expression for the observable exchange rate constant $k_\\mathrm{ex}$:\n$$\nk_\\mathrm{ex} = \\frac{k_\\mathrm{op} k_\\mathrm{ch}}{k_\\mathrm{cl} + k_\\mathrm{ch}}\n$$\nThis formula couples the conformational dynamics ($k_\\mathrm{op}$, $k_\\mathrm{cl}$) with the chemical reaction step ($k_\\mathrm{ch}$). We can distinguish two limiting regimes:\n-   EX2 regime ($k_\\mathrm{cl} \\gg k_\\mathrm{ch}$): $k_\\mathrm{ex} \\approx k_\\mathrm{op} (k_\\mathrm{ch}/k_\\mathrm{cl}) = K_\\mathrm{eq} k_\\mathrm{ch} = (p_\\mathcal{O}/p_\\mathcal{C}) k_\\mathrm{ch}$, where exchange is limited by the opening-closing equilibrium.\n-   EX1 regime ($k_\\mathrm{cl} \\ll k_\\mathrm{ch}$): $k_\\mathrm{ex} \\approx k_\\mathrm{op}$, where every opening event leads to successful exchange, and the overall rate is limited by the opening rate.\n\nBy implementing these six steps for each provided test case, we can compute the required quantities: $p_\\mathcal{O}$, $k_\\mathrm{op}$, and $k_\\mathrm{ex}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all specified test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"energies\": np.array([0.0, 0.2, 0.3, 4.0, 4.1]),\n            \"edges\": [\n                (0, 1, 2.0e6), (1, 2, 1.5e6), (0, 2, 5.0e5),  # Within C\n                (3, 4, 5.0e5),                               # Within O\n                (2, 3, 2.0e2)                                # Between C and O\n            ],\n            \"lag_time\": 1.0e-6,\n            \"k_ch\": 1.0e1\n        },\n        {\n            \"name\": \"Case B\",\n            \"energies\": np.array([0.0, 0.2, 0.3, 2.0, 2.2]),\n            \"edges\": [\n                (0, 1, 2.0e6), (1, 2, 1.5e6), (0, 2, 5.0e5),  # Within C\n                (3, 4, 8.0e5),                               # Within O\n                (2, 3, 1.0e3)                                # Between C and O\n            ],\n            \"lag_time\": 1.0e-6,\n            \"k_ch\": 1.0e5\n        },\n        {\n            \"name\": \"Case C\",\n            \"energies\": np.array([0.0, 0.2, 0.3, 7.0, 7.2]),\n            \"edges\": [\n                (0, 1, 2.0e6), (1, 2, 1.5e6), (0, 2, 5.0e5),  # Within C\n                (3, 4, 3.0e5),                               # Within O\n                (2, 3, 5.0e1)                                # Between C and O\n            ],\n            \"lag_time\": 1.0e-6,\n            \"k_ch\": 1.0\n        }\n    ]\n\n    # Common parameters for all cases\n    num_states = 5\n    closed_states = [0, 1, 2]\n    open_states = [3, 4]\n\n    results = []\n    for case in test_cases:\n        energies = case[\"energies\"]\n        edges = case[\"edges\"]\n        tau = case[\"lag_time\"]\n        k_ch = case[\"k_ch\"]\n\n        # Step 1: Construct the generator matrix K\n        K = np.zeros((num_states, num_states))\n        for i, j, a_ij in edges:\n            delta_E = energies[j] - energies[i]\n            K[i, j] = a_ij * np.exp(-delta_E / 2.0)\n            K[j, i] = a_ij * np.exp(delta_E / 2.0)\n        \n        for i in range(num_states):\n            K[i, i] = -np.sum(K[i, :])\n\n        # Step 2: Compute stationary distribution pi and transition matrix T(tau)\n        boltzmann_factors = np.exp(-energies)\n        partition_func = np.sum(boltzmann_factors)\n        pi = boltzmann_factors / partition_func\n        \n        T_tau = expm(K * tau)\n\n        # Step 3: Compute equilibrium open population p_O\n        p_O = np.sum(pi[open_states])\n        p_C = 1.0 - p_O\n\n        # Step 4: Compute macrostate transition probabilities\n        flux_C_to_O = 0.0\n        for i in closed_states:\n            for j in open_states:\n                flux_C_to_O += pi[i] * T_tau[i, j]\n        \n        # Guard against division by zero if a macrostate is unpopulated\n        if p_C > 0:\n            P_C_to_O_tau = flux_C_to_O / p_C\n        else:\n            P_C_to_O_tau = 0.0\n\n        # Step 5: Infer rate constants k_op and k_cl\n        # The argument to log must be positive.\n        # This requires P_C_to_O_tau  p_O.\n        # This is guaranteed by the physics of the model as long as states are connected\n        # and populations are non-zero.\n        if p_O > 0 and (1.0 - P_C_to_O_tau / p_O) > 0:\n            sum_of_rates = - (1.0 / tau) * np.log(1.0 - P_C_to_O_tau / p_O)\n        else: # Handle limit cases if necessary\n            sum_of_rates = 0.0\n            \n        k_op = sum_of_rates * p_O\n        k_cl = sum_of_rates * p_C\n\n        # Step 6: Compute exchange rate k_ex\n        if (k_cl + k_ch) > 0:\n            k_ex = (k_op * k_ch) / (k_cl + k_ch)\n        else:\n            k_ex = 0.0\n            \n        results.append([p_O, k_op, k_ex])\n\n    # Format the final output string as required\n    results_str = [f\"[{r[0]:.6f},{r[1]:.6f},{r[2]:.6f}]\" for r in results]\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```", "id": "2557089"}]}