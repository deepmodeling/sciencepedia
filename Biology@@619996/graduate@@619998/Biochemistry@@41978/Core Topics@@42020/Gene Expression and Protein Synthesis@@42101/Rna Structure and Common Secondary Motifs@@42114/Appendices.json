{"hands_on_practices": [{"introduction": "The stability of any RNA structure is fundamentally governed by the principles of thermodynamics. To build robust models for RNA folding, we must first understand the energetic contributions of its most basic components, the base pairs. This practice [@problem_id:2603623] provides a hands-on calculation of the free energy penalty for substituting a canonical Watson-Crick G-C pair with a G-U wobble pair, grounding the abstract concept of structural stability in concrete thermodynamic terms.", "problem": "In ribonucleic acid (RNA) helices, guanine–cytosine (GC) Watson–Crick pairs present three complementary hydrogen bonds, whereas guanine–uracil (GU) wobble pairs present two hydrogen bonds with slightly altered geometry. Using hydrogen-bond donor and acceptor patterns, argue from first principles why GU wobble pairs can still be accommodated in an A-form helix, and then compute the expected free energy penalty of a single isolated GU wobble pair relative to a GC pair in the same helix under the following physically motivated assumptions.\n\nBase your reasoning on these general, widely accepted principles:\n- Complementary donor–acceptor matching allows formation of specific hydrogen bonds when geometric constraints permit orbital overlap and favorable electrostatics.\n- The Gibbs free energy change for forming interactions is given by $\\Delta G = \\Delta H - T \\Delta S$, and for approximately independent contributions, free energies are additive.\n- In a regular A-form RNA helix, hydrogen bonds and stacking interactions are the dominant local stabilizing forces.\n\nUse the model and parameters below:\n1. Each canonical hydrogen bond in a regular A-form environment has an enthalpy and entropy contribution of $\\Delta h_{\\mathrm{HB}} = -1.9$ kcal mol$^{-1}$ and $\\Delta s_{\\mathrm{HB}} = -2.4$ cal mol$^{-1}$ K$^{-1}$, respectively. Assume additivity over bonds for the intrinsic base-pairing contribution.\n2. A GC pair forms $3$ canonical hydrogen bonds.\n3. A GU wobble pair forms $2$ hydrogen bonds. One of these has canonical-like geometry and uses the same $\\Delta h_{\\mathrm{HB}}$ and $\\Delta s_{\\mathrm{HB}}$ as above. The second is weakened by suboptimal donor–acceptor alignment: its enthalpy contribution is scaled by a factor $\\alpha = 0.80$ and its entropy magnitude is scaled by a factor $\\beta = 0.90$ relative to the canonical values (i.e., $\\Delta h = \\alpha \\Delta h_{\\mathrm{HB}}$ and $\\Delta s = \\beta \\Delta s_{\\mathrm{HB}}$ for that bond).\n4. Because the GU wobble perturbs base stacking and leaves one minor-groove acceptor less optimally satisfied, assign a context-averaged stacking penalty $\\delta_{\\mathrm{stack}} = +0.60$ kcal mol$^{-1}$ and a solvation penalty $\\delta_{\\mathrm{solv}} = +0.25$ kcal mol$^{-1}$ to the GU pair relative to GC. Take the GC pair as the zero reference for these penalties.\n5. Compute at temperature $T = 310$ K. When multiplying $T$ by entropies given in cal mol$^{-1}$ K$^{-1}$, convert to kcal mol$^{-1}$ as appropriate.\n\nTasks:\n- First, in one or two sentences, justify qualitatively, using donor/acceptor patterns and helical geometry, why GU wobble pairs can be tolerated in helices despite their non-Watson–Crick geometry.\n- Then, using the above quantitative model, compute the free energy penalty $\\Delta\\Delta G$ (defined as $\\Delta G_{\\mathrm{GU}} - \\Delta G_{\\mathrm{GC}}$) for replacing one GC pair by a GU wobble pair in the same helical context.\n\nExpress the final penalty in kilocalories per mole and round your answer to four significant figures.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard biophysical chemistry calculation based on a simplified but consistent thermodynamic model of RNA base pairing. All required parameters are provided, and the objective is clearly defined. The premises are consistent with established principles of nucleic acid structure and thermodynamics. Therefore, the problem is deemed valid and a solution will be provided.\n\nFirst, the qualitative justification for the accommodation of a guanine–uracil ($GU$) wobble pair in an $A$-form helix is addressed. In a standard Watson–Crick pair, hydrogen bond donors on one base align with acceptors on the other. For a $GU$ pair, this canonical alignment is not possible. However, a lateral displacement (a \"wobble\") of the bases within the helical plane allows for the formation of two alternative hydrogen bonds: one between the guanine $O6$ (acceptor) and the uracil $N3$ proton (donor), and another between the guanine $N1$ proton (donor) and the uracil $O2$ (acceptor). This arrangement results in a base pair geometry where the $C1'$—$C1'$ distance across the pair is similar enough to that of a canonical Watson–Crick pair to be incorporated into the regular sugar-phosphate backbone of an $A$-form helix with only minor local distortions.\n\nNext, the quantitative calculation of the free energy penalty, $\\Delta\\Delta G = \\Delta G_{\\mathrm{GU}} - \\Delta G_{\\mathrm{GC}}$, is performed. The Gibbs free energy for the formation of a base pair is given by $\\Delta G = \\Delta H - T \\Delta S$. We will calculate the total free energy contribution for a guanine–cytosine ($GC$) pair and a $GU$ wobble pair based on the provided model.\n\nThe free energy of the $GC$ reference pair, $\\Delta G_{\\mathrm{GC}}$, is calculated. A $GC$ pair forms $3$ canonical hydrogen bonds. The model assumes additivity and no other penalties for the reference pair.\nThe enthalpy contribution is $\\Delta H_{\\mathrm{GC}} = 3 \\times \\Delta h_{\\mathrm{HB}}$.\nThe entropy contribution is $\\Delta S_{\\mathrm{GC}} = 3 \\times \\Delta s_{\\mathrm{HB}}$.\nThus, the free energy for the $GC$ pair is:\n$$ \\Delta G_{\\mathrm{GC}} = \\Delta H_{\\mathrm{GC}} - T \\Delta S_{\\mathrm{GC}} = 3 \\Delta h_{\\mathrm{HB}} - T (3 \\Delta s_{\\mathrm{HB}}) = 3(\\Delta h_{\\mathrm{HB}} - T \\Delta s_{\\mathrm{HB}}) $$\n\nThe free energy of the $GU$ wobble pair, $\\Delta G_{\\mathrm{GU}}$, is now calculated. A $GU$ pair forms $2$ hydrogen bonds and incurs additional penalties.\nOne hydrogen bond is canonical, contributing $\\Delta h_{\\mathrm{HB}}$ to enthalpy and $\\Delta s_{\\mathrm{HB}}$ to entropy.\nThe second hydrogen bond is weakened. Its enthalpy contribution is $\\alpha \\Delta h_{\\mathrm{HB}}$ and its entropy contribution is $\\beta \\Delta s_{\\mathrm{HB}}$.\nThe total hydrogen bond enthalpy for the $GU$ pair is $\\Delta H_{\\mathrm{HB, GU}} = \\Delta h_{\\mathrm{HB}} + \\alpha \\Delta h_{\\mathrm{HB}} = (1 + \\alpha) \\Delta h_{\\mathrm{HB}}$.\nThe total hydrogen bond entropy is $\\Delta S_{\\mathrm{HB, GU}} = \\Delta s_{\\mathrm{HB}} + \\beta \\Delta s_{\\mathrm{HB}} = (1 + \\beta) \\Delta s_{\\mathrm{HB}}$.\nThe free energy from hydrogen bonding in the $GU$ pair is:\n$$ \\Delta G_{\\mathrm{HB, GU}} = (1 + \\alpha) \\Delta h_{\\mathrm{HB}} - T(1 + \\beta) \\Delta s_{\\mathrm{HB}} $$\nAdditionally, the $GU$ pair has a stacking penalty $\\delta_{\\mathrm{stack}}$ and a solvation penalty $\\delta_{\\mathrm{solv}}$.\nThe total free energy for the $GU$ pair is therefore:\n$$ \\Delta G_{\\mathrm{GU}} = \\Delta G_{\\mathrm{HB, GU}} + \\delta_{\\mathrm{stack}} + \\delta_{\\mathrm{solv}} = (1 + \\alpha) \\Delta h_{\\mathrm{HB}} - T(1 + \\beta) \\Delta s_{\\mathrm{HB}} + \\delta_{\\mathrm{stack}} + \\delta_{\\mathrm{solv}} $$\n\nThe free energy penalty $\\Delta\\Delta G$ is the difference $\\Delta G_{\\mathrm{GU}} - \\Delta G_{\\mathrm{GC}}$:\n$$ \\Delta\\Delta G = [(1 + \\alpha) \\Delta h_{\\mathrm{HB}} - T(1 + \\beta) \\Delta s_{\\mathrm{HB}} + \\delta_{\\mathrm{stack}} + \\delta_{\\mathrm{solv}}] - [3(\\Delta h_{\\mathrm{HB}} - T \\Delta s_{\\mathrm{HB}})] $$\nGrouping terms by $\\Delta h_{\\mathrm{HB}}$ and $\\Delta s_{\\mathrm{HB}}$:\n$$ \\Delta\\Delta G = (1 + \\alpha - 3) \\Delta h_{\\mathrm{HB}} - T(1 + \\beta - 3) \\Delta s_{\\mathrm{HB}} + \\delta_{\\mathrm{stack}} + \\delta_{\\mathrm{solv}} $$\n$$ \\Delta\\Delta G = (\\alpha - 2) \\Delta h_{\\mathrm{HB}} - T(\\beta - 2) \\Delta s_{\\mathrm{HB}} + \\delta_{\\mathrm{stack}} + \\delta_{\\mathrm{solv}} $$\n\nNow, substitute the given numerical values into this expression.\nThe parameters are:\n$\\Delta h_{\\mathrm{HB}} = -1.9$ kcal mol$^{-1}$\n$\\Delta s_{\\mathrm{HB}} = -2.4$ cal mol$^{-1}$ K$^{-1} = -0.0024$ kcal mol$^{-1}$ K$^{-1}$\n$\\alpha = 0.80$\n$\\beta = 0.90$\n$T = 310$ K\n$\\delta_{\\mathrm{stack}} = +0.60$ kcal mol$^{-1}$\n$\\delta_{\\mathrm{solv}} = +0.25$ kcal mol$^{-1}$\n\nSubstituting these values:\n$$ \\Delta\\Delta G = (0.80 - 2) \\times (-1.9 \\text{ kcal mol}^{-1}) - (310 \\text{ K}) \\times (0.90 - 2) \\times (-0.0024 \\text{ kcal mol}^{-1} \\text{ K}^{-1}) + 0.60 \\text{ kcal mol}^{-1} + 0.25 \\text{ kcal mol}^{-1} $$\n$$ \\Delta\\Delta G = (-1.20) \\times (-1.9) - (310) \\times (-1.10) \\times (-0.0024) + 0.85 \\text{ kcal mol}^{-1} $$\n$$ \\Delta\\Delta G = 2.28 - (310 \\times 1.10 \\times 0.0024) + 0.85 \\text{ kcal mol}^{-1} $$\n$$ \\Delta\\Delta G = 2.28 - 0.8184 + 0.85 \\text{ kcal mol}^{-1} $$\n$$ \\Delta\\Delta G = 3.13 - 0.8184 \\text{ kcal mol}^{-1} $$\n$$ \\Delta\\Delta G = 2.3116 \\text{ kcal mol}^{-1} $$\n\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\Delta\\Delta G \\approx 2.312 \\text{ kcal mol}^{-1} $$\nThis positive value indicates, as expected, that replacing a $GC$ pair with a $GU$ wobble pair is thermodynamically unfavorable, resulting in a destabilization of the helix.", "answer": "$$\\boxed{2.312}$$", "id": "2603623"}, {"introduction": "While base pairs form the foundation, the overall three-dimensional architecture of an RNA helix is defined by the precise geometric relationships between successive pairs. This exercise [@problem_id:2603677] delves into the standard biophysical parameterization of helical structure, guiding you to calculate a global property—curvature—from a set of local base-step parameters. This practice bridges the gap between the 2D representation of a secondary structure and its actual shape in 3D space.", "problem": "A short double-stranded ribonucleic acid (RNA) duplex of four base pairs is described by three sequential base steps. In the base-pair step description, each step is parameterized by rotation angles and translations in the local base-pair frame: twist (rotation about the local $z$-axis), roll (rotation about the local $x$-axis), and slide (translation along the local $x$- or $y$-in-plane axis; here take it along the local $y$-axis by convention), together with rise (translation along the local $z$-axis). Consider the following experimentally plausible parameters for the three steps of an A-form-like RNA segment:\n- Step $1$: twist $= 33^{\\circ}$, roll $= 6^{\\circ}$, slide $= -1.4\\,\\text{\\AA}$, rise $= 2.8\\,\\text{\\AA}$.\n- Step $2$: twist $= 31^{\\circ}$, roll $= 2^{\\circ}$, slide $= -1.6\\,\\text{\\AA}$, rise $= 2.8\\,\\text{\\AA}$.\n- Step $3$: twist $= 34^{\\circ}$, roll $= 5^{\\circ}$, slide $= -1.5\\,\\text{\\AA}$, rise $= 2.8\\,\\text{\\AA}$.\n\nWork from first principles using the standard biophysical definitions of base-step parameters and small-angle rigid-body kinematics for nucleic acids:\n- The local base-pair frame has axes $(x,y,z)$ with $z$ approximately along the helical axis, $x$ the roll axis, and $y$ the tilt axis; roll is a rotation about $x$, twist is a rotation about $z$.\n- Assume shift and tilt are negligible for all steps, and treat the roll angles as small so that the cumulative bending of the helical axis over multiple steps can be obtained by vectorially summing the stepwise bend contributions in the plane perpendicular to the initial $z$-axis, with each step’s bend direction rotated by the cumulative twist of the preceding steps.\n- Treat each step’s helical arc length between successive base-pair origins as the magnitude of its in-frame translation vector, i.e., the Euclidean norm of its slide and rise components.\n\nDefine the net bending angle of the three-step segment, $\\Theta$, as the magnitude of the vector sum of the stepwise bending contributions, and define the total helical arc length, $L$, as the sum of the three step translation magnitudes. The curvature of the segment is then $\\,\\kappa = \\Theta/L\\,$.\n\nCompute $\\kappa$ for the given segment using the above definitions and assumptions. Express the final result in inverse ångströms, and round your answer to four significant figures.", "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in the principles of nucleic acid structure, well-posed with all necessary information and clear definitions, and objective in its formulation. It presents a standard, albeit simplified, biophysical calculation that does not violate any fundamental principles.\n\nThe objective is to compute the curvature, $\\kappa$, of a three-step ribonucleic acid (RNA) segment. The curvature is defined as the ratio of the net bending angle, $\\Theta$, to the total helical arc length, $L$.\n$$\n\\kappa = \\frac{\\Theta}{L}\n$$\nWe will compute $L$ and $\\Theta$ separately based on the provided parameters and definitions.\n\nThe given parameters for the three base-pair steps are:\nStep $1$: Twist $\\Omega_1 = 33^{\\circ}$, Roll $\\rho_1 = 6^{\\circ}$, Slide $D_{y,1} = -1.4\\,\\text{\\AA}$, Rise $D_{z,1} = 2.8\\,\\text{\\AA}$.\nStep $2$: Twist $\\Omega_2 = 31^{\\circ}$, Roll $\\rho_2 = 2^{\\circ}$, Slide $D_{y,2} = -1.6\\,\\text{\\AA}$, Rise $D_{z,2} = 2.8\\,\\text{\\AA}$.\nStep $3$: Twist $\\Omega_3 = 34^{\\circ}$, Roll $\\rho_3 = 5^{\\circ}$, Slide $D_{y,3} = -1.5\\,\\text{\\AA}$, Rise $D_{z,3} = 2.8\\,\\text{\\AA}$.\nIt is assumed that shift ($D_x$) and tilt ($\\tau$) are negligible for all steps.\n\nFirst, we calculate the total helical arc length, $L$.\nThe problem defines the helical arc length for a single step, $l_i$, as the Euclidean norm of its slide and rise components. Since shift ($D_{x,i}$) is zero, this is:\n$$\nl_i = \\sqrt{D_{y,i}^2 + D_{z,i}^2}\n$$\nFor each of the three steps:\n$l_1 = \\sqrt{(-1.4)^2 + (2.8)^2} = \\sqrt{1.96 + 7.84} = \\sqrt{9.80}\\,\\text{\\AA}$\n$l_2 = \\sqrt{(-1.6)^2 + (2.8)^2} = \\sqrt{2.56 + 7.84} = \\sqrt{10.40}\\,\\text{\\AA}$\n$l_3 = \\sqrt{(-1.5)^2 + (2.8)^2} = \\sqrt{2.25 + 7.84} = \\sqrt{10.09}\\,\\text{\\AA}$\n\nThe total helical arc length, $L$, is the sum of the individual step lengths:\n$$\nL = l_1 + l_2 + l_3 = \\sqrt{9.80} + \\sqrt{10.40} + \\sqrt{10.09}\\,\\text{\\AA}\n$$\nNumerically, $L \\approx 3.130495 + 3.224903 + 3.176476 \\approx 9.531874\\,\\text{\\AA}$. We shall retain precision for intermediate calculations.\n\nNext, we calculate the net bending angle, $\\Theta$.\nThe problem specifies that the cumulative bending is the vectorial sum of the stepwise bend contributions, where the contribution from each step is its roll angle, $\\rho_i$. The direction of each bend vector is rotated by the cumulative twist of the preceding steps. We can model this as a sum of two-dimensional vectors in a plane perpendicular to the initial helical axis.\nLet the bend contribution from step $i$ be a vector $\\vec{b}_i$ with magnitude $\\rho_i$. We align the direction of the first bend vector, $\\vec{b}_1$, with the $x$-axis of a global coordinate system.\nThe vector for step $1$ has magnitude $\\rho_1$ and is at an angle of $0$.\nThe vector for step $2$ has magnitude $\\rho_2$ and is rotated by the twist of the previous step, $\\Omega_1$.\nThe vector for step $3$ has magnitude $\\rho_3$ and is rotated by the cumulative twist of the previous steps, $\\Omega_1 + \\Omega_2$.\n\nThe total bend vector, $\\vec{B}$, is the sum $\\vec{B} = \\vec{b}_1 + \\vec{b}_2 + \\vec{b}_3$. Its components, $B_x$ and $B_y$, are:\n$$\nB_x = \\rho_1 \\cos(0) + \\rho_2 \\cos(\\Omega_1) + \\rho_3 \\cos(\\Omega_1 + \\Omega_2)\n$$\n$$\nB_y = \\rho_1 \\sin(0) + \\rho_2 \\sin(\\Omega_1) + \\rho_3 \\sin(\\Omega_1 + \\Omega_2)\n$$\nSubstituting the given values:\n$\\rho_1 = 6^{\\circ}$, $\\rho_2 = 2^{\\circ}$, $\\rho_3 = 5^{\\circ}$\n$\\Omega_1 = 33^{\\circ}$\n$\\Omega_1 + \\Omega_2 = 33^{\\circ} + 31^{\\circ} = 64^{\\circ}$\n\nThe components are calculated, keeping the magnitudes in degrees for now:\n$B_x = 6^{\\circ} + 2^{\\circ} \\cos(33^{\\circ}) + 5^{\\circ} \\cos(64^{\\circ})$\n$B_y = 2^{\\circ} \\sin(33^{\\circ}) + 5^{\\circ} \\sin(64^{\\circ})$\n\nUsing the trigonometric values: $\\cos(33^{\\circ}) \\approx 0.83867$, $\\sin(33^{\\circ}) \\approx 0.54464$, $\\cos(64^{\\circ}) \\approx 0.43837$, $\\sin(64^{\\circ}) \\approx 0.89879$.\n$B_x \\approx 6 + 2 \\times (0.83867) + 5 \\times (0.43837) \\approx 6 + 1.67734 + 2.19185 = 9.86919^{\\circ}$\n$B_y \\approx 2 \\times (0.54464) + 5 \\times (0.89879) \\approx 1.08928 + 4.49395 = 5.58323^{\\circ}$\n\nThe net bending angle, $\\Theta$, is the magnitude of the total bend vector $\\vec{B}$:\n$$\n\\Theta = |\\vec{B}| = \\sqrt{B_x^2 + B_y^2}\n$$\n$\\Theta \\approx \\sqrt{(9.86919^{\\circ})^2 + (5.58323^{\\circ})^2} \\approx \\sqrt{97.4009 + 31.1725}\\,\\text{deg} \\approx \\sqrt{128.5734}\\,\\text{deg} \\approx 11.339^{\\circ}$\n\nFor the curvature formula $\\kappa = \\Theta/L$ to be dimensionally correct (with units of inverse length), the angle $\\Theta$ must be expressed in radians. We convert $\\Theta$ from degrees to radians:\n$$\n\\Theta_{\\text{rad}} = \\Theta_{\\text{deg}} \\times \\frac{\\pi}{180}\n$$\n$\\Theta_{\\text{rad}} \\approx 11.339 \\times \\frac{\\pi}{180} \\approx 0.19790 \\text{ radians}$\n\nFinally, we compute the curvature $\\kappa$:\n$$\n\\kappa = \\frac{\\Theta_{\\text{rad}}}{L} \\approx \\frac{0.19790}{9.531874\\,\\text{\\AA}} \\approx 0.0207620\\,\\text{\\AA}^{-1}\n$$\nThe problem requires the result to be rounded to four significant figures.\n$\\kappa \\approx 0.02076\\,\\text{\\AA}^{-1}$.", "answer": "$$\n\\boxed{0.02076}\n$$", "id": "2603677"}, {"introduction": "Having explored the energetic and geometric building blocks of RNA, we can now address the grand challenge of predicting a molecule's secondary structure from its primary sequence. This problem [@problem_id:2603667] guides you through a foundational dynamic programming algorithm to determine the Minimum Free Energy (MFE) structure based on a thermodynamic nearest-neighbor model. This exercise synthesizes the principles of base pairing energies and structural motifs into a powerful computational framework.", "problem": "You are given a toy, but thermodynamically grounded, nearest-neighbor model for RNA secondary structure formation. The goal is to compute the Minimum Free Energy (MFE) structure of a short RNA using Dynamic Programming (DP), by explicitly filling the relevant entries of the DP arrays and reconstructing the lowest-energy secondary structure. Begin from the following foundational principles and constraints, which reflect well-tested biophysical facts: secondary structures are pseudoknot-free, the free energy is additive over independent structural elements, the nearest-neighbor approximation applies to stacked helices, external loops have zero free energy, and hairpin loops have a size-dependent penalty and a minimum loop length.\n\nThe RNA sequence is $5^{\\prime}$–$GCAUGCUGC$–$3^{\\prime}$ of length $n=9$, indexed from $i=1$ at the $5^{\\prime}$ end to $i=9$ at the $3^{\\prime}$ end. Allowed Watson–Crick and wobble base pairs are $\\{ \\mathrm{G}\\!-\\!\\mathrm{C}, \\mathrm{C}\\!-\\!\\mathrm{G}, \\mathrm{A}\\!-\\!\\mathrm{U}, \\mathrm{U}\\!-\\!\\mathrm{A}, \\mathrm{G}\\!-\\!\\mathrm{U}, \\mathrm{U}\\!-\\!\\mathrm{G} \\}$.\n\nUse the following energy parameters (energies in $\\mathrm{kcal/mol}$):\n- Base-pair formation energies: $\\Delta G(\\mathrm{G}\\!-\\!\\mathrm{C})=-3.00$, $\\Delta G(\\mathrm{C}\\!-\\!\\mathrm{G})=-3.00$, $\\Delta G(\\mathrm{A}\\!-\\!\\mathrm{U})=-2.00$, $\\Delta G(\\mathrm{U}\\!-\\!\\mathrm{A})=-2.00$, $\\Delta G(\\mathrm{G}\\!-\\!\\mathrm{U})=-1.00$, $\\Delta G(\\mathrm{U}\\!-\\!\\mathrm{G})=-1.00$.\n- Stacking bonus for any adjacent stacked pair (i.e., $(i,j)$ stacked on $(i+1,j-1)$): $\\Delta G_{\\text{stack}}=-0.50$ per stack.\n- Hairpin loop penalty when a base pair $(i,j)$ closes a hairpin with $L=j-i-1$ unpaired nucleotides: $\\Delta G_{\\text{hairpin}}(L)=+3.00+0.20\\,L$.\n- Minimum hairpin loop length: $L_{\\min}=3$. Any hairpin with $L<3$ is forbidden (treat as infinite energy).\n- External loops and unpaired nucleotides contribute $0$ free energy; multi-branch loops and internal loops (including bulges) are disallowed in this exercise. Consequently, if $(i,j)$ pairs and there are any additional pairs inside $(i,j)$, they must form a contiguous stack $(i,j)$, $(i+1,j-1)$, $(i+2,j-2)$, $\\dots$, terminating in a valid hairpin loop of length $L \\geq L_{\\min}$.\n- Pseudoknots are forbidden.\n\nDefine $V(i,j)$ as the minimal free energy for the subsequence $i,\\dots,j$ under the constraint that $i$ is paired to $j$. Define $W(i,j)$ as the minimal free energy for the subsequence $i,\\dots,j$ without constraints. Starting only from the principles above (thermodynamic additivity, nearest-neighbor stacking, hairpin penalties, minimum loop length, and no pseudoknots), derive the appropriate DP recurrences for $V(i,j)$ and $W(i,j)$, state base cases, and compute the entries necessary to obtain $W(1,9)$ and reconstruct the corresponding MFE secondary structure. Clearly indicate which base pairs are present in the MFE structure you reconstruct.\n\nWhat is the final MFE value $W(1,9)$ in $\\mathrm{kcal/mol}$ for this sequence under the stated model? Round your final answer to three significant figures and express it in $\\mathrm{kcal/mol}$.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It presents a simplified but valid thermodynamic nearest-neighbor model for RNA secondary structure prediction. The task is to apply dynamic programming to find the minimum free energy (MFE) structure for a given RNA sequence under the specified energy rules. The problem is valid.\n\nThe core of the problem is to derive and apply the correct dynamic programming recurrences for the given energy model. Let the RNA sequence be $S$, with length $n=9$. The nucleotides are indexed from $i=1$ to $n=9$. We are given $S = 5^{\\prime}\\!-\\!GCAUGCUGC\\!-\\!3^{\\prime}$.\n\nLet $W(i,j)$ be the minimum free energy for the subsequence $S_i \\dots S_j$.\nLet $V(i,j)$ be the minimum free energy for the subsequence $S_i \\dots S_j$, under the constraint that nucleotides $S_i$ and $S_j$ form a base pair.\n\nFirst, we establish the recurrence for $V(i,j)$. A pair $(i,j)$ can either close a hairpin loop or stack upon an adjacent inner pair $(i+1, j-1)$. The problem states that other types of internal loops (bulges, multiple branches) are disallowed.\nIf $(S_i, S_j)$ is not an allowed base pair, then $V(i,j) = \\infty$.\nIf $(S_i, S_j)$ is an allowed pair, the energy $V(i,j)$ is the sum of the base-pair formation energy, $\\Delta G_{bp}(S_i, S_j)$, and the minimum energy of the enclosed loop. The loop can be:\n1.  A hairpin loop: This is only possible if its length $L = j-i-1$ is at least the minimum length $L_{\\min}=3$. The energy contribution is $\\Delta G_{\\text{hairpin}}(L) = 3.00 + 0.20\\,L$. Let this energy term be $E_H$.\n2.  A stacked pair: The pair $(i,j)$ stacks on $(i+1, j-1)$. The energy contribution is the stacking bonus $\\Delta G_{\\text{stack}}$ plus the energy of the structure closed by $(i+1, j-1)$, which is $V(i+1, j-1)$. Let this energy term be $E_S$.\n\nThis leads to the recurrence for $V(i,j)$:\nIf $(S_i, S_j)$ is not an allowed pair or if $j-i-1 < 0$: $V(i,j) = \\infty$.\nOtherwise:\n$$\nV(i,j) = \\Delta G_{bp}(S_i, S_j) + \\min\\left( E_{\\text{hairpin}}(j-i-1), \\quad V(i+1, j-1) + \\Delta G_{\\text{stack}} \\right)\n$$\nwhere $E_{\\text{hairpin}}(L) = 3.00 + 0.20\\,L$ if $L \\geq 3$, and $E_{\\text{hairpin}}(L) = \\infty$ if $L < 3$.\n\nNext, we establish the recurrence for $W(i,j)$. An optimal structure for the subsequence $S_i \\dots S_j$ is found by considering all possibilities for the nucleotide $S_j$:\n1.  $S_j$ is unpaired. The free energy is that of the remaining subsequence, $W(i, j-1)$. The unpaired nucleotide contributes $0$ energy.\n2.  $S_j$ forms a base pair with a nucleotide $S_k$ where $i \\le k < j$. Due to the pseudoknot-free constraint, the structure is partitioned into the part enclosed by the pair $(k,j)$ (with energy $V(k,j)$) and the part outside it, from $S_i$ to $S_{k-1}$ (with energy $W(i,k-1)$). We must minimize over all possible partners $k$.\n\nThis yields the recurrence for $W(i,j)$:\n$$\nW(i,j) = \\min\\left( W(i, j-1), \\quad \\min_{i \\leq k < j} \\{ W(i,k-1) + V(k,j) \\} \\right)\n$$\n\nThe base cases for the DP are:\n$W(i,j) = 0$ for $i > j$.\n$W(i,i) = 0$ for all $i \\in [1, n]$.\nFor computation, we initialize $V(i,j) = \\infty$ for all $i,j$.\n\nThe DP algorithm proceeds by filling the matrices $V$ and $W$ for increasing subsequence length $d=j-i$, from $d=1$ to $n-1=8$.\n\nThe given energy parameters are:\n$\\Delta G_{bp}(\\mathrm{G‐C}) = \\Delta G_{bp}(\\mathrm{C‐G}) = -3.00$, $\\Delta G_{bp}(\\mathrm{A‐U}) = \\Delta G_{bp}(\\mathrm{U‐A}) = -2.00$, $\\Delta G_{bp}(\\mathrm{G‐U}) = \\Delta G_{bp}(\\mathrm{U‐G}) = -1.00$.\n$\\Delta G_{\\text{stack}} = -0.50$.\n$L_{\\min} = 3$.\n\nWe compute the necessary matrix entries for the sequence $S = G_1C_2A_3U_4G_5C_6U_7G_8C_9$.\nNote that for $d = j-i < 4$, the hairpin constraint $j-i-1 \\ge 3$ is not met, so $V(i,j)$ will be infinite unless it can form a stack. A stack requires a non-infinite inner $V$ term, so finite $V(i,j)$ values only appear for $d \\ge 4$. For $d=0,1,2,3$, $W(i,i+d)=0$.\n\nFor $d=4$ ($L=3$): Substructure must be a hairpin.\n$V(3,7)$: $A_3-U_7$ pair. $E_H = \\Delta G_{bp}(A,U) + (3.00 + 0.20 \\times 3) = -2.00 + 3.60 = 1.60$.\n$V(4,8)$: $U_4-G_8$ pair. $E_H = \\Delta G_{bp}(U,G) + 3.60 = -1.00 + 3.60 = 2.60$.\n$V(5,9)$: $G_5-C_9$ pair. $E_H = \\Delta G_{bp}(G,C) + 3.60 = -3.00 + 3.60 = 0.60$.\nOther $V(i,i+4)$ are $\\infty$ as pairs are not allowed.\nThe corresponding $W(i,i+4)$ values are $\\min(0, V) = 0$ as all $V$ values are positive. For example, $W(3,7) = \\min(W(3,6), V(3,7)+W(3,2)) = \\min(0, 1.60+0)=0$.\n\nFor $d=5$ ($L=4$): Substructure must be a hairpin.\n$V(1,6)$: $G_1-C_6$ pair. $E_H = \\Delta G_{bp}(G,C) + (3.00 + 0.20 \\times 4) = -3.00 + 3.80 = 0.80$.\n$V(1,6)=0.80$.\nOther $V(i,i+5)$ are $\\infty$. All $W(i,i+5)=0$.\n\nFor $d=6$ ($L=5$): Stacks become possible.\n$V(2,8)$: $C_2-G_8$ pair.\n$E_H = \\Delta G_{bp}(C,G) + (3.00 + 0.20 \\times 5) = -3.00 + 4.00 = 1.00$.\n$E_S = \\Delta G_{bp}(C,G) + \\Delta G_{\\text{stack}} + V(3,7) = -3.00 - 0.50 + 1.60 = -1.90$.\n$V(2,8) = \\min(1.00, -1.90) = -1.90$.\nThis is the first negative energy value. It corresponds to pair $(2,8)$ stacking on $(3,7)$, which closes a hairpin.\n$W(2,8) = \\min(W(2,7), V(2,8)+W(2,1), \\dots) = \\min(0, -1.90+0) = -1.90$.\n\nFor $d=7$ ($L=6$):\n$V(1,8)$ involves $G_1-G_8$ (not a pair), $V(2,9)$ involves $C_2-C_9$ (not a pair).\n$W(1,8) = \\min(W(1,7), V(2,8)+W(1,1), \\dots) = \\min(0, -1.90+0) = -1.90$. The MFE for $S_1 \\dots S_8$ involves leaving $S_1$ unpaired and forming the optimal structure on $S_2 \\dots S_8$.\n$W(2,9) = \\min(W(2,8), \\dots) = \\min(-1.90, V(5,9)+W(2,4)=0.60, \\dots) = -1.90$. The MFE for $S_2 \\dots S_9$ involves leaving $S_9$ unpaired.\n\nFor $d=8$ ($L=7$):\n$V(1,9)$: $G_1-C_9$ pair.\n$E_H = \\Delta G_{bp}(G,C) + (3.00 + 0.20 \\times 7) = -3.00 + 4.40 = 1.40$.\n$E_S = \\Delta G_{bp}(G,C) + \\Delta G_{\\text{stack}} + V(2,8) = -3.00 - 0.50 + (-1.90) = -5.40$.\n$V(1,9) = \\min(1.40, -5.40) = -5.40$.\n\nFinally, we compute the MFE for the entire sequence, $W(1,9)$:\n$W(1,9) = \\min\\left( W(1,8), \\min_{1 \\leq k < 9} \\{W(1,k-1) + V(k,9)\\} \\right)$.\n$W(1,8) = -1.90$.\nThe minimization over $k$ includes:\n$k=1: W(1,0) + V(1,9) = 0 + (-5.40) = -5.40$.\n$k=5: W(1,4) + V(5,9) = 0 + 0.60 = 0.60$.\nOther terms for $k$ yield pairs with distance $j-k < 4$ or non-canonical pairs leading to $V(k,9)=\\infty$.\nThe minimum is thus $\\min(-1.90, -5.40, 0.60) = -5.40$.\n\nThe minimum free energy is $W(1,9) = -5.40 \\, \\mathrm{kcal/mol}$.\n\nTo reconstruct the structure, we backtrack the DP calculation.\n- $W(1,9) = -5.40$ came from $V(1,9)$, implying the pair $(1,9)$ is formed.\n- $V(1,9) = -5.40$ came from the stacking term $E_S$, implying the pair $(1,9)$ stacks on $(2,8)$. The pair $(2,8)$ is formed.\n- $V(2,8) = -1.90$ came from the stacking term $E_S$, implying the pair $(2,8)$ stacks on $(3,7)$. The pair $(3,7)$ is formed.\n- $V(3,7) = 1.60$ came from the hairpin term $E_H$, implying the pair $(3,7)$ closes a hairpin loop containing nucleotides $S_4, S_5, S_6$.\n\nThe MFE structure is a single stem-loop, with a stem of three base pairs: $(1,9)$, $(2,8)$, and $(3,7)$, and a hairpin loop of three nucleotides.\nThe pairs are $G_1-C_9$, $C_2-G_8$, and $A_3-U_7$.\n\nThe final MFE value is $-5.40$, which is already expressed to three significant figures.", "answer": "$$\\boxed{-5.40}$$", "id": "2603667"}]}