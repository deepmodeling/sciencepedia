{"hands_on_practices": [{"introduction": "Understanding the direction of metabolic reactions requires calculating the Gibbs free energy change, $\\Delta G$, under physiological conditions. This exercise [@problem_id:2549748] challenges you to go beyond standard-state calculations by accounting for the complex speciation of nucleotides due to magnesium ($\\text{Mg}^{2+}$) binding in the cytosol. By deriving the reaction's free energy from first principles, including the use of binding polynomials, you will gain a deeper appreciation for how the cellular environment modulates the thermodynamic potential of key metabolic reactions like that catalyzed by adenylate kinase.", "problem": "Adenylate kinase in the cytosol catalyzes the reaction that interconverts adenosine diphosphate (ADP) with adenosine triphosphate (ATP) and adenosine monophosphate (AMP):\n$$\n2\\,\\mathrm{ADP} \\rightleftharpoons \\mathrm{ATP} + \\mathrm{AMP}.\n$$\nIn a well-buffered mammalian cell at temperature $T = 310\\ \\mathrm{K}$ and pH $= 7.20$, the free magnesium ion $\\mathrm{Mg}^{2+}$ is maintained at a constant concentration $[\\mathrm{Mg}^{2+}] = 0.50\\ \\mathrm{mM}$ by cytosolic chelators, and magnesium binding to each nucleotide is fast and at equilibrium. Treat the one-to-one magnesium binding reactions\n$$\n\\mathrm{ATP}^{4-} + \\mathrm{Mg}^{2+} \\rightleftharpoons \\mathrm{MgATP}^{2-},\\quad\n\\mathrm{ADP}^{3-} + \\mathrm{Mg}^{2+} \\rightleftharpoons \\mathrm{MgADP}^{-},\\quad\n\\mathrm{AMP}^{2-} + \\mathrm{Mg}^{2+} \\rightleftharpoons \\mathrm{MgAMP}^{0}\n$$\nas independent equilibria with association constants\n$$\nK_{\\mathrm{ATP}} = 1.0 \\times 10^{4}\\ \\mathrm{M}^{-1},\\quad\nK_{\\mathrm{ADP}} = 2.0 \\times 10^{3}\\ \\mathrm{M}^{-1},\\quad\nK_{\\mathrm{AMP}} = 3.2 \\times 10^{1}\\ \\mathrm{M}^{-1}.\n$$\nAssume that ionic-strength effects on activities are negligible in the apparent, magnesium-buffered description below, so that the activity of each total nucleotide equals its molar concentration. The transformed standard Gibbs energy change for the metal-free biochemical reaction at pH $= 7.20$ and $T = 310\\ \\mathrm{K}$ is\n$$\n\\Delta G^{\\circ}_{0} = +1.00\\ \\mathrm{kJ\\ mol}^{-1}.\n$$\nIn the cytosol, the measured total nucleotide concentrations (free plus magnesium-bound) are\n$$\n[\\mathrm{ATP}]_{\\mathrm{tot}} = 3.20\\ \\mathrm{mM},\\quad [\\mathrm{ADP}]_{\\mathrm{tot}} = 0.80\\ \\mathrm{mM},\\quad [\\mathrm{AMP}]_{\\mathrm{tot}} = 0.10\\ \\mathrm{mM}.\n$$\nStarting from the definition of chemical potential and mass action, and explicitly accounting for coupling to $\\mathrm{Mg}^{2+}$ through binding polynomials at fixed $[\\mathrm{Mg}^{2+}]$, derive an expression for the reaction Gibbs energy $\\Delta G$ in terms of $\\Delta G^{\\circ}_{0}$, $T$, the gas constant $R$, $[\\mathrm{Mg}^{2+}]$, the binding constants $K_{i}$, and the total nucleotide concentrations. Then evaluate $\\Delta G$ numerically under the given conditions. Use $R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$ and express the final value of $\\Delta G$ in $\\mathrm{kJ\\ mol^{-1}}$. Round your answer to four significant figures.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and an objective problem in biochemical thermodynamics. All required data are provided, and there are no inconsistencies. The solution proceeds.\n\nThe reaction Gibbs energy, $\\Delta G$, quantifies the spontaneity of the adenylate kinase reaction under the specified cellular conditions.\n$$\n2\\,\\mathrm{ADP} \\rightleftharpoons \\mathrm{ATP} + \\mathrm{AMP}\n$$\nThis reaction is coupled to magnesium binding equilibria. The overall Gibbs energy change is independent of the specific chemical species used to describe the state, provided the description is complete. The problem provides the standard transformed Gibbs energy change, $\\Delta G^{\\circ}_{0}$, for the reaction involving the metal-free species at pH $7.20$ and $T = 310\\ \\mathrm{K}$:\n$$\n2\\,\\mathrm{ADP}_{\\text{free}} \\rightleftharpoons \\mathrm{ATP}_{\\text{free}} + \\mathrm{AMP}_{\\text{free}}\n$$\nFor this reaction, the Gibbs energy change $\\Delta G$ under any set of concentrations is given by:\n$$\n\\Delta G = \\Delta G^{\\circ}_{0} + RT \\ln \\left( \\frac{[\\mathrm{ATP}_{\\text{free}}][\\mathrm{AMP}_{\\text{free}}]}{[\\mathrm{ADP}_{\\text{free}}]^{2}} \\right)\n$$\nwhere $R$ is the gas constant, $T$ is the absolute temperature, and concentrations are treated as activities.\n\nTo evaluate $\\Delta G$, we must relate the concentrations of the free nucleotide species ($[\\mathrm{ATP}_{\\text{free}}]$, $[\\mathrm{ADP}_{\\text{free}}]$, $[\\mathrm{AMP}_{\\text{free}}]$) to the given total concentrations ($[\\mathrm{ATP}]_{\\mathrm{tot}}$, $[\\mathrm{ADP}]_{\\mathrm{tot}}$, $[\\mathrm{AMP}]_{\\mathrm{tot}}$). This relationship is governed by the magnesium binding equilibria.\n\nFor any nucleotide species $N$, where $N$ can be $\\mathrm{ATP}$, $\\mathrm{ADP}$, or $\\mathrm{AMP}$, the total concentration is the sum of the free species and the magnesium-bound complex:\n$$\n[N]_{\\mathrm{tot}} = [N_{\\text{free}}] + [\\mathrm{Mg}N]\n$$\nThe one-to-one binding is described by an association constant, $K_{N}$:\n$$\nK_{N} = \\frac{[\\mathrm{Mg}N]}{[N_{\\text{free}}][\\mathrm{Mg}^{2+}]}\n$$\nFrom this, the concentration of the bound form is $[\\mathrm{Mg}N] = K_{N} [N_{\\text{free}}][\\mathrm{Mg}^{2+}]$. Substituting this into the expression for the total concentration gives:\n$$\n[N]_{\\mathrm{tot}} = [N_{\\text{free}}] + K_{N} [N_{\\text{free}}][\\mathrm{Mg}^{2+}] = [N_{\\text{free}}] (1 + K_{N} [\\mathrm{Mg}^{2+}])\n$$\nThe term $(1 + K_{N} [\\mathrm{Mg}^{2+}])$ is the binding polynomial for species $N$ at a fixed $[\\mathrm{Mg}^{2+}]$. Let us denote this polynomial as $P_{N}$.\n$$\nP_{N} = 1 + K_{N} [\\mathrm{Mg}^{2+}]\n$$\nWe can now express the concentration of the free species in terms of the total concentration:\n$$\n[N_{\\text{free}}] = \\frac{[N]_{\\mathrm{tot}}}{P_{N}} = \\frac{[N]_{\\mathrm{tot}}}{1 + K_{N} [\\mathrm{Mg}^{2+}]}\n$$\nThis holds for $\\mathrm{ATP}$, $\\mathrm{ADP}$, and $\\mathrm{AMP}$. Substituting these expressions back into the equation for $\\Delta G$:\n$$\n\\Delta G = \\Delta G^{\\circ}_{0} + RT \\ln \\left( \\frac{ \\left( \\frac{[\\mathrm{ATP}]_{\\mathrm{tot}}}{P_{\\mathrm{ATP}}} \\right) \\left( \\frac{[\\mathrm{AMP}]_{\\mathrm{tot}}}{P_{\\mathrm{AMP}}} \\right) }{ \\left( \\frac{[\\mathrm{ADP}]_{\\mathrm{tot}}}{P_{\\mathrm{ADP}}} \\right)^2 } \\right)\n$$\nUsing the properties of logarithms, we can separate the terms involving total concentrations and the binding polynomials:\n$$\n\\Delta G = \\Delta G^{\\circ}_{0} + RT \\ln \\left( \\frac{[\\mathrm{ATP}]_{\\mathrm{tot}}[\\mathrm{AMP}]_{\\mathrm{tot}}}{[\\mathrm{ADP}]_{\\mathrm{tot}}^{2}} \\right) + RT \\ln \\left( \\frac{P_{\\mathrm{ADP}}^2}{P_{\\mathrm{ATP}}P_{\\mathrm{AMP}}} \\right)\n$$\nThis equation is the derived expression for the reaction Gibbs energy. The term $\\frac{[\\mathrm{ATP}]_{\\mathrm{tot}}[\\mathrm{AMP}]_{\\mathrm{tot}}}{[\\mathrm{ADP}]_{\\mathrm{tot}}^{2}}$ is the apparent reaction quotient, $Q'_{\\mathrm{tot}}$. The term involving the binding polynomials corrects the standard state Gibbs energy for the effect of the fixed free magnesium concentration.\n\nThe expression can be written as:\n$$\n\\Delta G = \\Delta G^{\\circ}_{0} + RT \\ln(Q'_{\\mathrm{tot}}) + RT \\ln \\left( \\frac{(1 + K_{\\mathrm{ADP}} [\\mathrm{Mg}^{2+}])^{2}}{(1 + K_{\\mathrm{ATP}} [\\mathrm{Mg}^{2+}]) (1 + K_{\\mathrm{AMP}} [\\mathrm{Mg}^{2+}])} \\right)\n$$\nThis completes the derivation. Now, we evaluate $\\Delta G$ numerically.\n\nThe given values are:\n$T = 310\\ \\mathrm{K}$\n$R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$\n$\\Delta G^{\\circ}_{0} = +1.00\\ \\mathrm{kJ\\ mol}^{-1} = 1000\\ \\mathrm{J\\ mol}^{-1}$\n$[\\mathrm{Mg}^{2+}] = 0.50\\ \\mathrm{mM} = 5.0 \\times 10^{-4}\\ \\mathrm{M}$\n$K_{\\mathrm{ATP}} = 1.0 \\times 10^{4}\\ \\mathrm{M}^{-1}$\n$K_{\\mathrm{ADP}} = 2.0 \\times 10^{3}\\ \\mathrm{M}^{-1}$\n$K_{\\mathrm{AMP}} = 3.2 \\times 10^{1}\\ \\mathrm{M}^{-1}$\n$[\\mathrm{ATP}]_{\\mathrm{tot}} = 3.20\\ \\mathrm{mM} = 3.20 \\times 10^{-3}\\ \\mathrm{M}$\n$[\\mathrm{ADP}]_{\\mathrm{tot}} = 0.80\\ \\mathrm{mM} = 0.80 \\times 10^{-3}\\ \\mathrm{M}$\n$[\\mathrm{AMP}]_{\\mathrm{tot}} = 0.10\\ \\mathrm{mM} = 0.10 \\times 10^{-3}\\ \\mathrm{M}$\n\nFirst, calculate the binding polynomials $P_N$:\n$P_{\\mathrm{ATP}} = 1 + K_{\\mathrm{ATP}} [\\mathrm{Mg}^{2+}] = 1 + (1.0 \\times 10^{4}\\ \\mathrm{M}^{-1})(5.0 \\times 10^{-4}\\ \\mathrm{M}) = 1 + 5.0 = 6.0$\n$P_{\\mathrm{ADP}} = 1 + K_{\\mathrm{ADP}} [\\mathrm{Mg}^{2+}] = 1 + (2.0 \\times 10^{3}\\ \\mathrm{M}^{-1})(5.0 \\times 10^{-4}\\ \\mathrm{M}) = 1 + 1.0 = 2.0$\n$P_{\\mathrm{AMP}} = 1 + K_{\\mathrm{AMP}} [\\mathrm{Mg}^{2+}] = 1 + (3.2 \\times 10^{1}\\ \\mathrm{M}^{-1})(5.0 \\times 10^{-4}\\ \\mathrm{M}) = 1 + 0.016 = 1.016$\n\nNext, calculate the apparent reaction quotient $Q'_{\\mathrm{tot}}$:\n$$\nQ'_{\\mathrm{tot}} = \\frac{[\\mathrm{ATP}]_{\\mathrm{tot}}[\\mathrm{AMP}]_{\\mathrm{tot}}}{[\\mathrm{ADP}]_{\\mathrm{tot}}^{2}} = \\frac{(3.20 \\times 10^{-3}\\ \\mathrm{M})(0.10 \\times 10^{-3}\\ \\mathrm{M})}{(0.80 \\times 10^{-3}\\ \\mathrm{M})^2} = \\frac{3.20 \\times 0.10}{0.80^2} = \\frac{0.320}{0.640} = 0.5\n$$\nThe product $RT$ is:\n$$\nRT = (8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}})(310\\ \\mathrm{K}) \\approx 2577.483\\ \\mathrm{J\\ mol}^{-1}\n$$\nNow, substitute the values into the full expression for $\\Delta G$:\n$$\n\\Delta G = 1000\\ \\mathrm{J\\ mol}^{-1} + RT \\ln(0.5) + RT \\ln \\left( \\frac{2.0^2}{6.0 \\times 1.016} \\right)\n$$\n$$\n\\Delta G = 1000\\ \\mathrm{J\\ mol}^{-1} + (2577.483\\ \\mathrm{J\\ mol}^{-1}) \\ln(0.5) + (2577.483\\ \\mathrm{J\\ mol}^{-1}) \\ln \\left( \\frac{4}{6.096} \\right)\n$$\nWe can combine the logarithmic terms:\n$$\n\\Delta G = 1000\\ \\mathrm{J\\ mol}^{-1} + (2577.483\\ \\mathrm{J\\ mol}^{-1}) \\ln \\left( 0.5 \\times \\frac{4}{6.096} \\right)\n$$\n$$\n\\Delta G = 1000\\ \\mathrm{J\\ mol}^{-1} + (2577.483\\ \\mathrm{J\\ mol}^{-1}) \\ln \\left( \\frac{2}{6.096} \\right)\n$$\n$$\n\\Delta G \\approx 1000\\ \\mathrm{J\\ mol}^{-1} + (2577.483\\ \\mathrm{J\\ mol}^{-1}) \\ln(0.3280839895)\n$$\n$$\n\\Delta G \\approx 1000\\ \\mathrm{J\\ mol}^{-1} + (2577.483\\ \\mathrm{J\\ mol}^{-1}) (-1.114559)\n$$\n$$\n\\Delta G \\approx 1000\\ \\mathrm{J\\ mol}^{-1} - 2872.68\\ \\mathrm{J\\ mol}^{-1} = -1872.68\\ \\mathrm{J\\ mol}^{-1}\n$$\nThe problem requires the answer in $\\mathrm{kJ\\ mol}^{-1}$ rounded to four significant figures.\n$$\n\\Delta G = -1.87268\\ \\mathrm{kJ\\ mol}^{-1}\n$$\nRounding to four significant figures, we get:\n$$\n\\Delta G = -1.873\\ \\mathrm{kJ\\ mol}^{-1}\n$$\nThe negative value indicates that under the given cytosolic conditions, the adenylate kinase reaction is spontaneous in the direction of $\\mathrm{ATP}$ and $\\mathrm{AMP}$ formation from $\\mathrm{ADP}$.", "answer": "$$\\boxed{-1.873}$$", "id": "2549748"}, {"introduction": "Cellular processes are driven by the movement of molecules and ions through a crowded and spatially inhomogeneous environment. This exercise [@problem_id:2549764] guides you to build a model of solute transport from the ground up, starting with the full expression for the electrochemical potential. You will derive the relationship between the chemical potential gradient and molar flux, leading to an approximation of the Nernst–Planck equation, and apply it to understand how concentration, charge, and non-ideal solution behavior collectively drive transport.", "problem": "Consider a single solute species $X$ in a one-dimensional (1D) inhomogeneous cellular environment at temperature $T$, where both the concentration $c(x)$, the activity coefficient $\\gamma(x)$ (to account for non-ideality due to crowding), and the electrical potential $\\psi(x)$ may vary with position $x$. The solute has integer valence $z$ (positive for cations, negative for anions, and zero for neutral solutes). Use the following universally accepted bases:\n- The chemical potential $\\mu$ of a species is the partial molar Gibbs free energy.\n- For an ideal dilute solution, the entropy of mixing leads to a logarithmic dependence of the chemical potential on concentration; non-ideality can be captured via an activity coefficient factor.\n- The reversible work to move a charge $q$ through an electrical potential difference is $q \\Delta \\psi$.\n- In linear irreversible thermodynamics near local equilibrium, the molar flux $J$ of a solute in 1D is proportional to the gradient of its chemical potential, with proportionality determined by a mobility that, for dilute solutions, relates to the diffusion coefficient.\n\nYour tasks are:\n1) Starting from the above bases, and without appealing to any shortcut formula, derive the spatial dependence $\\mu_X(x)$ for a solute $X$ in a dilute aqueous medium with spatially varying $c(x)$, $\\gamma(x)$, and $\\psi(x)$, including the contribution of electrostatic work for a species of valence $z$. Clearly indicate every term, its origin, and its physical dimension.\n2) From your expression in task $1$, derive an explicit expression for the chemical potential difference $\\Delta \\mu_X = \\mu_X(x_2) - \\mu_X(x_1)$ between two positions $x_1$ and $x_2$ in terms of $T$, $z$, $c(x_1)$, $c(x_2)$, $\\gamma(x_1)$, $\\gamma(x_2)$, $\\psi(x_1)$, and $\\psi(x_2)$, using a common standard state so that any standard-state contribution cancels in the difference.\n3) Using the framework of linear irreversible thermodynamics for a dilute solute, and restricting to small gradients around an average state, show that the 1D steady-state molar flux $J$ can be approximated by combining the definition of the chemical potential gradient with Fickian diffusion. Concretely, argue that for a segment of length $L = x_2 - x_1$ with linear profiles and small relative variations, one may linearize about the arithmetic means $c_{\\mathrm{avg}} = \\tfrac{1}{2}[c(x_1) + c(x_2)]$ and $\\gamma_{\\mathrm{avg}} = \\tfrac{1}{2}[\\gamma(x_1) + \\gamma(x_2)]$ to obtain an approximation of the form\n$$\nJ \\approx -\\frac{D\\,c_{\\mathrm{avg}}}{R T}\\,\\frac{\\Delta \\mu_X}{L}\n$$\nor, equivalently, an expression written in terms of finite differences that agrees with the Nernst–Planck form to first order in the gradients. Here $D$ is the diffusion coefficient of the solute, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n4) Implement a program that evaluates, for each provided test case, both the chemical potential difference $\\Delta \\mu_X$ and the approximate steady-state molar flux $J$ using your derived expressions. Use the International System of Units (SI) consistently, with the following conventions and constants:\n- Temperatures must be in kelvin $[\\mathrm{K}]$.\n- Electrical potentials must be in volts $[\\mathrm{V}]$.\n- Concentrations must be in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n- Lengths must be in meters $[\\mathrm{m}]$.\n- Diffusion coefficients must be in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n- The universal gas constant is $R = 8.31446261815324\\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n- The Faraday constant is $F = 96485.33212\\ \\mathrm{C}\\,\\mathrm{mol}^{-1}$.\n- The standard concentration $c^0$ is the same at $x_1$ and $x_2$ and cancels in $\\Delta \\mu_X$.\n- For numerical convenience, you may use the linearization\n$$\n\\frac{\\partial \\mu_X}{\\partial x}\\bigg|_{\\mathrm{avg}} \\approx R T\\left(\\frac{1}{c_{\\mathrm{avg}}}\\frac{\\Delta c}{L} + \\frac{1}{\\gamma_{\\mathrm{avg}}}\\frac{\\Delta \\gamma}{L} \\right) + z F \\frac{\\Delta \\psi}{L}\n$$\nand then $J \\approx -\\dfrac{D\\,c_{\\mathrm{avg}}}{R T}\\,\\dfrac{\\partial \\mu_X}{\\partial x}\\big|_{\\mathrm{avg}}$, where $\\Delta c = c(x_2)-c(x_1)$, $\\Delta \\gamma = \\gamma(x_2)-\\gamma(x_1)$, and $\\Delta \\psi = \\psi(x_2)-\\psi(x_1)$.\n- Conversion aids: $1\\ \\mathrm{mM} = 1\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $1\\ \\mathrm{mV} = 10^{-3}\\ \\mathrm{V}$, $1\\ \\mu\\mathrm{m} = 10^{-6}\\ \\mathrm{m}$.\n\nTest suite (each case specifies $(z, T, c(x_1), c(x_2), \\gamma(x_1), \\gamma(x_2), \\psi(x_1), \\psi(x_2), L, D)$ with units):\n- Case A (happy path, monovalent cation, opposing gradients): $z = +1$, $T = 310\\ \\mathrm{K}$, $c(x_1) = 5\\ \\mathrm{mM}$, $c(x_2) = 50\\ \\mathrm{mM}$, $\\gamma(x_1) = 1.0$, $\\gamma(x_2) = 0.85$, $\\psi(x_1) = 0\\ \\mathrm{mV}$, $\\psi(x_2) = -80\\ \\mathrm{mV}$, $L = 10\\ \\mu\\mathrm{m}$, $D = 1.5\\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n- Case B (near Nernst balance): $z = +1$, $T = 310\\ \\mathrm{K}$, $c(x_1) = 5\\ \\mathrm{mM}$, $c(x_2) = 100\\ \\mathrm{mM}$, $\\gamma(x_1) = 1.0$, $\\gamma(x_2) = 1.0$, $\\psi(x_1) = 0\\ \\mathrm{mV}$, $\\psi(x_2) = -80\\ \\mathrm{mV}$, $L = 10\\ \\mu\\mathrm{m}$, $D = 1.5\\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n- Case C (neutral solute with strong crowding gradient): $z = 0$, $T = 298\\ \\mathrm{K}$, $c(x_1) = 2\\ \\mathrm{mM}$, $c(x_2) = 10\\ \\mathrm{mM}$, $\\gamma(x_1) = 0.6$, $\\gamma(x_2) = 0.3$, $\\psi(x_1) = 0\\ \\mathrm{mV}$, $\\psi(x_2) = 0\\ \\mathrm{mV}$, $L = 5\\ \\mu\\mathrm{m}$, $D = 5\\times 10^{-10}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n- Case D (anion with reversed gradients): $z = -1$, $T = 310\\ \\mathrm{K}$, $c(x_1) = 60\\ \\mathrm{mM}$, $c(x_2) = 10\\ \\mathrm{mM}$, $\\gamma(x_1) = 0.9$, $\\gamma(x_2) = 1.0$, $\\psi(x_1) = -50\\ \\mathrm{mV}$, $\\psi(x_2) = 0\\ \\mathrm{mV}$, $L = 2\\ \\mu\\mathrm{m}$, $D = 1\\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n- Case E (small gradients, divalent cation): $z = +2$, $T = 300\\ \\mathrm{K}$, $c(x_1) = 10\\ \\mathrm{mM}$, $c(x_2) = 10.1\\ \\mathrm{mM}$, $\\gamma(x_1) = 1.0$, $\\gamma(x_2) = 0.99$, $\\psi(x_1) = 0\\ \\mathrm{mV}$, $\\psi(x_2) = 1\\ \\mathrm{mV}$, $L = 100\\ \\mu\\mathrm{m}$, $D = 1\\times 10^{-10}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$.\n\nProgramming and output requirements:\n- For each test case, compute two quantities: (i) the chemical potential difference $\\Delta \\mu_X$ in $\\mathrm{J}\\,\\mathrm{mol}^{-1}$, and (ii) the approximate steady-state molar flux $J$ in $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ using the linearized expression described above.\n- Express both $\\Delta \\mu_X$ and $J$ in SI units as specified above.\n- Your program should produce a single line of output containing the results as a comma-separated list of two-element lists, enclosed in square brackets. Each number must be written in scientific notation with six significant figures, and there must be no spaces anywhere in the line. For example, a valid output with two fictitious results would look like: $[[1.23457\\mathrm{e}{+03},-6.54321\\mathrm{e}{-04}],[9.87654\\mathrm{e}{+00},1.00000\\mathrm{e}{-02}]]$.", "solution": "The problem presented is a standard, well-posed exercise in biophysical chemistry. It is scientifically sound, internally consistent, and contains all necessary information for a complete solution. We shall proceed with the derivation and subsequent calculation.\n\n### Task 1: Derivation of the Electrochemical Potential $\\mu_X(x)$\n\nThe total driving force for the transport of a charged species in a solution is given by its electrochemical potential, which is the partial molar Gibbs free energy under the given conditions. We construct this quantity, denoted here by $\\mu_X(x)$, from fundamental principles. The subscript $X$ denotes the solute species, and the dependence on position $x$ indicates an inhomogeneous system.\n\nThe electrochemical potential is the sum of three distinct contributions: a standard state component, a concentration-dependent component arising from the entropy of mixing (corrected for non-ideality), and an electrical component.\n\n1.  **Standard Chemical Potential ($\\mu^0$)**: This is a reference term, representing the chemical potential of the solute $X$ under standard conditions, typically defined as a standard concentration $c^0$ (e.g., $1\\ \\mathrm{mol}\\,\\mathrm{L}^{-1}$ or $1\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$) at a given temperature and pressure. By definition, this term is independent of position. Its physical dimension is energy per mole, $[\\mathrm{J}\\,\\mathrm{mol}^{-1}]$.\n\n2.  **Concentration and Activity Contribution**: For an ideal dilute solution, the chemical potential's dependence on concentration $c(x)$ is given by the term $R T \\ln(c(x)/c^0)$, where $R$ is the universal gas constant and $T$ is the absolute temperature. This term has its origin in the statistical mechanics of mixing (entropy of mixing). To account for non-ideal interactions in a real solution, such as molecular crowding in a cellular environment, the concentration $c(x)$ is replaced by the chemical activity $a(x) = \\gamma(x) c(x)$. Here, $\\gamma(x)$ is the dimensionless activity coefficient, which itself may vary with position. The contribution to the chemical potential is therefore $R T \\ln(a(x)/a^0) = R T \\ln(\\gamma(x) c(x)/c^0)$, assuming the standard state is defined at unit activity and concentration $c^0$ where $\\gamma=1$. This term has dimensions of energy per mole, $[\\mathrm{J}\\,\\mathrm{mol}^{-1}]$.\n\n3.  **Electrical Potential Contribution**: If the solute $X$ carries an electric charge, work is done when it moves through an electric field. The molar charge of the solute is $q = zF$, where $z$ is the dimensionless integer valence and $F$ is the Faraday constant (the magnitude of charge per mole of electrons). The work required to move one mole of this solute from a reference point of zero potential to a point $x$ with electrical potential $\\psi(x)$ is $W_{\\text{elec}} = z F \\psi(x)$. This work represents a change in the molar Gibbs free energy. This term has dimensions of charge per mole multiplied by energy per charge, $[\\mathrm{C}\\,\\mathrm{mol}^{-1}] \\times [\\mathrm{V}] = [\\mathrm{J}\\,\\mathrm{mol}^{-1}]$.\n\nCombining these three components, the complete position-dependent electrochemical potential of species $X$ is:\n$$\n\\mu_X(x) = \\mu^0 + R T \\ln\\left(\\frac{\\gamma(x) c(x)}{c^0}\\right) + z F \\psi(x)\n$$\nHereafter, we follow the common convention in biophysics of referring to this full expression as the \"chemical potential,\" as it represents the total potential energy driving chemical processes, including transport.\n\n### Task 2: Derivation of the Chemical Potential Difference $\\Delta \\mu_X$\n\nWe seek the difference in chemical potential, $\\Delta \\mu_X$, between two points, $x_1$ and $x_2$. We apply the expression derived in Task 1 at each point:\n$$\n\\mu_X(x_1) = \\mu^0 + R T \\ln\\left(\\frac{\\gamma(x_1) c(x_1)}{c^0}\\right) + z F \\psi(x_1)\n$$\n$$\n\\mu_X(x_2) = \\mu^0 + R T \\ln\\left(\\frac{\\gamma(x_2) c(x_2)}{c^0}\\right) + z F \\psi(x_2)\n$$\nThe difference is $\\Delta \\mu_X = \\mu_X(x_2) - \\mu_X(x_1)$. Upon subtraction, the standard chemical potential $\\mu^0$ and the standard concentration $c^0$ are eliminated, as they are constants independent of position.\n$$\n\\Delta \\mu_X = \\left[ \\mu^0 + R T \\ln\\left(\\frac{\\gamma_2 c_2}{c^0}\\right) + z F \\psi_2 \\right] - \\left[ \\mu^0 + R T \\ln\\left(\\frac{\\gamma_1 c_1}{c^0}\\right) + z F \\psi_1 \\right]\n$$\n$$\n\\Delta \\mu_X = R T \\left[ \\ln\\left(\\frac{\\gamma_2 c_2}{c^0}\\right) - \\ln\\left(\\frac{\\gamma_1 c_1}{c^0}\\right) \\right] + z F (\\psi_2 - \\psi_1)\n$$\nUsing the property of logarithms $\\ln(a) - \\ln(b) = \\ln(a/b)$, we obtain the final expression:\n$$\n\\Delta \\mu_X = R T \\ln\\left(\\frac{\\gamma(x_2) c(x_2)}{\\gamma(x_1) c(x_1)}\\right) + z F (\\psi(x_2) - \\psi(x_1))\n$$\nThis equation gives the change in molar Gibbs free energy for moving the solute from $x_1$ to $x_2$.\n\n### Task 3: Derivation of the Approximate Molar Flux $J$\n\nIn the framework of linear irreversible thermodynamics, the molar flux $J$ of a species is proportional to the negative gradient of its chemical potential, which acts as the thermodynamic driving force.\n$$\nJ = -M \\frac{\\partial \\mu_X}{\\partial x}\n$$\nHere, $M$ is a a positive-definite mobility coefficient. To relate $M$ to the diffusion coefficient $D$, we consider the simplified case of an ideal, uncharged solute in the absence of an electric field and activity gradients ($\\gamma=1, z=0, \\psi=0$). In this case, $\\mu_X(x) = \\mu^0 + RT\\ln(c(x)/c^0)$, and its gradient is $\\frac{\\partial \\mu_X}{\\partial x} = \\frac{RT}{c(x)} \\frac{\\partial c(x)}{\\partial x}$. The flux becomes:\n$$\nJ = -M \\left( \\frac{RT}{c(x)} \\right) \\frac{\\partial c(x)}{\\partial x}\n$$\nThis expression must be identical to Fick's first law of diffusion, $J = -D \\frac{\\partial c(x)}{\\partial x}$. By comparing the two expressions, we identify the relationship between mobility and the diffusion coefficient, known as the Nernst-Einstein relation:\n$$\nD = M \\frac{RT}{c(x)} \\quad \\implies \\quad M = \\frac{D c(x)}{RT}\n$$\nSubstituting this mobility back into the general flux equation, we get the fundamental Nernst-Planck equation:\n$$\nJ = -\\frac{D c(x)}{RT} \\frac{\\partial \\mu_X}{\\partial x}\n$$\nFor a finite segment of length $L = x_2 - x_1$ with small gradients, we can make an approximation. The continuous variable $c(x)$ in the mobility pre-factor can be replaced by its arithmetic mean, $c_{\\mathrm{avg}} = \\frac{1}{2}[c(x_1) + c(x_2)]$. The gradient $\\frac{\\partial \\mu_X}{\\partial x}$ can be approximated by the finite difference ratio $\\frac{\\Delta \\mu_X}{L} = \\frac{\\mu_X(x_2) - \\mu_X(x_1)}{x_2 - x_1}$. Combining these approximations yields the desired form:\n$$\nJ \\approx -\\frac{D c_{\\mathrm{avg}}}{RT} \\frac{\\Delta \\mu_X}{L}\n$$\nThis form connects the net flux over a small region to the overall chemical potential difference across it. It is equivalent to a first-order finite difference approximation of the full Nernst-Planck equation. To see this, one can expand the gradient $\\frac{\\partial \\mu_X}{\\partial x}$ and then linearize the resulting expression by replacing continuous variables with their average values and derivatives with finite differences, which yields the expression provided in the problem for numerical computation. This confirms the consistency of the approach.\n\n### Task 4: Numerical Implementation\n\nThe program below will implement the derived formulas. For the chemical potential difference $\\Delta \\mu_X$, we will use the exact expression from Task 2. For the flux $J$, we will strictly follow the specified numerical recipe, which uses a linearized approximation for the chemical potential gradient. All parameters will be converted to and handled in SI units.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating chemical potential difference and molar flux\n    for a solute in an inhomogeneous cellular environment.\n    \"\"\"\n    # Universal constants in SI units\n    R = 8.31446261815324  # J mol^-1 K^-1\n    F = 96485.33212       # C mol^-1\n\n    # Test suite from the problem statement.\n    # Each case: (z, T, c1, c2, g1, g2, psi1, psi2, L, D)\n    # Units are converted to SI upon definition.\n    # 1 mM = 1 mol m^-3\n    # 1 mV = 1e-3 V\n    # 1 um = 1e-6 m\n    test_cases = [\n        # Case A\n        (1, 310.0, 5.0, 50.0, 1.0, 0.85, 0.0, -80.0e-3, 10.0e-6, 1.5e-9),\n        # Case B\n        (1, 310.0, 5.0, 100.0, 1.0, 1.0, 0.0, -80.0e-3, 10.0e-6, 1.5e-9),\n        # Case C\n        (0, 298.0, 2.0, 10.0, 0.6, 0.3, 0.0, 0.0, 5.0e-6, 5.0e-10),\n        # Case D\n        (-1, 310.0, 60.0, 10.0, 0.9, 1.0, -50.0e-3, 0.0, 2.0e-6, 1.0e-9),\n        # Case E\n        (2, 300.0, 10.0, 10.1, 1.0, 0.99, 0.0, 1.0e-3, 100.0e-6, 1.0e-10),\n    ]\n\n    results = []\n    for case in test_cases:\n        z, T, c1, c2, g1, g2, psi1, psi2, L, D = case\n\n        # Task 2: Calculate Chemical Potential Difference (delta_mu) in J/mol\n        # delta_mu = R*T*ln((g2*c2)/(g1*c1)) + z*F*(psi2 - psi1)\n        # We must guard against non-positive arguments to log\n        log_arg = (g2 * c2) / (g1 * c1)\n        if log_arg <= 0:\n            # This is not expected for the given test cases but is good practice.\n            # In a real scenario, this would imply an invalid physical state or error.\n            # We can skip or handle it, here we assume it won't happen.\n            pass\n        \n        term_conc = R * T * np.log(log_arg)\n        term_elec = z * F * (psi2 - psi1)\n        delta_mu = term_conc + term_elec\n\n        # Task 4: Calculate Approximate Molar Flux (J) in mol m^-2 s^-1\n        # Using the specified linearization for the gradient\n        # J_approx = - (D * c_avg / (R*T)) * (dmu_dx)_avg\n        # (dmu_dx)_avg = R*T*( (1/c_avg)*(dc/L) + (1/g_avg)*(dg/L) ) + z*F*(dpsi/L)\n        \n        # Calculate intermediate values\n        dc = c2 - c1\n        dg = g2 - g1\n        dpsi = psi2 - psi1\n        \n        c_avg = (c1 + c2) / 2.0\n        g_avg = (g1 + g2) / 2.0\n        \n        # Handle potential division by zero if averages are zero, although not expected here.\n        if c_avg == 0 or g_avg == 0:\n             # This physical situation is ill-defined for this model.\n             # We assume it does not occur in the test cases.\n             dmu_dx_avg = np.nan # Or other error value\n        else:\n            term1 = (R * T / c_avg) * (dc / L)\n            term2 = (R * T / g_avg) * (dg / L)\n            term3 = z * F * (dpsi / L)\n            dmu_dx_avg = term1 + term2 + term3\n\n        J_approx = - (D * c_avg / (R * T)) * dmu_dx_avg\n        \n        results.append((delta_mu, J_approx))\n\n    # Format output according to the problem specification\n    # [[val1,val2],[val3,val4],...], scientific notation with 6 significant figures (e.g., X.YYYYYe+ZZ)\n    results_str = [f\"[{dmu:.5e},{j:.5e}]\" for dmu, j in results]\n    final_output = f\"[{','.join(results_str)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2549764"}, {"introduction": "The textbook view of metabolism often assumes enzymes and metabolites diffuse freely in a well-mixed cellular soup, but this is far from reality. In this practice [@problem_id:2549731], you will explore the concept of metabolite channeling, where enzymes form complexes to enhance efficiency by creating high local concentrations of intermediates. By building and analyzing a kinetically and thermodynamically consistent model, you will gain insight into how cellular architecture directly manipulates chemical potentials to control metabolic flux.", "problem": "Consider a minimal open cellular pathway in which a substrate $S$ is reversibly converted to an intermediate $I$ by enzyme $E_1$, and $I$ is reversibly converted to product $P$ by enzyme $E_2$. The pathway can form a metabolic complex that channels a fraction of $I$ between $E_1$ and $E_2$. You will model the steady-state flux and step affinities using only standard definitions from chemical thermodynamics and mass-action kinetics, with an explicit representation of channeling that preserves thermodynamic consistency.\n\nAssumptions and base facts to use:\n- The chemical potential of a species $X$ at temperature $T$ is $\\mu_X = \\mu_X^\\circ + R T \\ln a_X$, where $R$ is the universal gas constant and $a_X$ is the activity of $X$. For this problem, take $R = 8.314462618\\ \\text{J mol}^{-1}\\ \\text{K}^{-1}$ and $T = 310.15\\ \\text{K}$. Activities are dimensionless, numerically equal to concentrations in $\\text{mol L}^{-1}$ relative to the reference concentration $1\\ \\text{mol L}^{-1}$.\n- Each elementary step follows reversible mass-action kinetics near steady state:\n  - Step $1$ ($S \\rightleftharpoons I$): $v_1 = k_{1f}\\, a_S - k_{1r}\\, a_I$.\n  - Step $2$ ($I \\rightleftharpoons P$): $v_2 = F\\,\\big(k_{2f}\\, a_I - k_{2r}\\, a_P\\big)$.\n- The dimensionless factor $F$ represents the effect of metabolite channeling within the $E_1$–$E_2$ complex and is defined to preserve microscopic reversibility by scaling both the forward and reverse kinetic capacities of step $2$ equally. Specifically, $F = 1 + \\chi\\,(\\gamma - 1)$, where $\\chi \\in [0,1]$ is the channeling fraction and $\\gamma \\ge 1$ quantifies the local activity enhancement experienced by the intermediate within the channel relative to bulk. This construction ensures that the equilibrium constant of the overall pathway is unchanged by channeling.\n- The standard free energy differences of the steps are related to the equilibrium constants via well-tested thermodynamic relationships. For step $i \\in \\{1,2\\}$, the standard affinity is $\\Delta \\mu_i^\\circ = - R T \\ln K_i$ with $K_i = k_{if}/k_{ir}$.\n- The step affinities under the given conditions are defined as\n  - $\\Delta \\mu_1 = \\mu_I - \\mu_S = \\Delta \\mu_1^\\circ + R T \\ln \\left(\\dfrac{a_I}{a_S}\\right)$,\n  - $\\Delta \\mu_2 = \\mu_P - \\mu_I = \\Delta \\mu_2^\\circ + R T \\ln \\left(\\dfrac{a_P}{a_I}\\right)$.\n- The system is open with chemostatted $S$ and $P$ at fixed activities $a_S$ and $a_P$. The intermediate $I$ reaches a steady state that satisfies $v_1 = v_2$.\n- To report a flux with physical units, use the reference concentration $c_{\\text{ref}} = 1\\ \\text{mol L}^{-1}$ so that $J = c_{\\text{ref}}\\, v_1 = c_{\\text{ref}}\\, v_2$ has units $\\text{mol L}^{-1}\\ \\text{s}^{-1}$. Use $c_{\\text{ref}} = 1$ in computations.\n\nTasks:\n- Starting from the given assumptions and base facts only, derive expressions needed to compute:\n  - the steady-state activity $a_I$ by enforcing $v_1 = v_2$,\n  - the net steady-state flux $J$ in $\\text{mol L}^{-1}\\ \\text{s}^{-1}$,\n  - the step affinities $\\Delta \\mu_1$ and $\\Delta \\mu_2$ in $\\text{J mol}^{-1}$.\n- Implement these computations in a program and evaluate them for the test suite below.\n\nTest suite (each tuple is $(k_{1f}, k_{1r}, k_{2f}, k_{2r}, a_S, a_P, \\chi, \\gamma)$ with rate constants in $\\text{s}^{-1}$ and activities dimensionless):\n- Case A (baseline, no channeling): $(10.0, 1.0, 8.0, 0.8, 0.5, 0.05, 0.0, 1.0)$.\n- Case B (moderate channeling): $(10.0, 1.0, 8.0, 0.8, 0.5, 0.05, 0.6, 5.0)$.\n- Case C (strong channeling): $(10.0, 1.0, 8.0, 0.8, 0.5, 0.05, 1.0, 10.0)$.\n- Case D (near-equilibrium overall, thermodynamically consistent): $(2.0, 2.0, 3.0, 3.0, 0.2, 0.22, 0.5, 3.0)$.\n\nNumerical and output requirements:\n- Express the net steady-state flux $J$ in $\\text{mol L}^{-1}\\ \\text{s}^{-1}$.\n- Express $\\Delta \\mu_1$ and $\\Delta \\mu_2$ in $\\text{J mol}^{-1}$.\n- For each test case, round each of the three results to $6$ decimal places.\n- Final output format: Your program should produce a single line of output containing a comma-separated flat list of all results in the order $[J_A, \\Delta\\mu_{1,A}, \\Delta\\mu_{2,A}, J_B, \\Delta\\mu_{1,B}, \\Delta\\mu_{2,B}, J_C, \\Delta\\mu_{1,C}, \\Delta\\mu_{2,C}, J_D, \\Delta\\mu_{1,D}, \\Delta\\mu_{2,D}]$, enclosed in square brackets (e.g., $[r_1,r_2,\\dots]$).", "solution": "The problem statement is valid. It is scientifically grounded, well-posed, objective, and provides all necessary information for a unique solution. The model is based on standard principles of chemical thermodynamics and mass-action kinetics, and the formulation for metabolic channeling is constructed to be thermodynamically consistent. We proceed with the derivations.\n\nThe objective is to derive expressions for the steady-state activity of the intermediate ($a_I$), the net steady-state flux ($J$), and the step affinities ($\\Delta \\mu_1$, $\\Delta \\mu_2$), and then to compute their values for a given set of test cases.\n\nFirst, we derive the expression for the steady-state activity of the intermediate, $a_I$. The system is assumed to be at a steady state where the concentration of the intermediate $I$ is constant. This requires that the net rate of its formation from substrate $S$ equals the net rate of its conversion to product $P$. This condition is expressed by the equality of the net velocities of the two steps: $v_1 = v_2$.\n\nUsing the provided rate laws based on mass-action kinetics:\n$$\nv_1 = k_{1f}\\, a_S - k_{1r}\\, a_I\n$$\n$$\nv_2 = F\\,\\big(k_{2f}\\, a_I - k_{2r}\\, a_P\\big)\n$$\nWe set $v_1 = v_2$ to enforce the steady-state condition:\n$$\nk_{1f}\\, a_S - k_{1r}\\, a_I = F\\,\\big(k_{2f}\\, a_I - k_{2r}\\, a_P\\big)\n$$\nThis is a linear equation with respect to the unknown variable $a_I$. We rearrange the terms to solve for $a_I$:\n$$\nk_{1f}\\, a_S - k_{1r}\\, a_I = F\\,k_{2f}\\, a_I - F\\,k_{2r}\\, a_P\n$$\n$$\nk_{1f}\\, a_S + F\\,k_{2r}\\, a_P = k_{1r}\\, a_I + F\\,k_{2f}\\, a_I\n$$\n$$\nk_{1f}\\, a_S + F\\,k_{2r}\\, a_P = a_I (k_{1r} + F\\,k_{2f})\n$$\nIsolating $a_I$ gives the final expression for its steady-state activity:\n$$\na_I = \\frac{k_{1f}\\, a_S + F\\,k_{2r}\\, a_P}{k_{1r} + F\\,k_{2f}}\n$$\nwhere the channeling factor $F$ is defined as $F = 1 + \\chi\\,(\\gamma - 1)$.\n\nSecond, we determine the net steady-state flux, $J$. The problem defines the flux as $J = c_{\\text{ref}}\\, v_{ss}$, where $v_{ss}$ is the steady-state velocity ($v_{ss} = v_1 = v_2$) and $c_{\\text{ref}} = 1\\ \\text{mol L}^{-1}$. Thus, the numerical value of $J$ in units of $\\text{mol L}^{-1}\\ \\text{s}^{-1}$ is equal to $v_{ss}$. We can compute this using the expression for $v_1$ and the derived value of $a_I$:\n$$\nJ = k_{1f}\\, a_S - k_{1r}\\, a_I\n$$\nSubstituting the expression for $a_I$ into this equation provides a more comprehensive form for $J$ that depends only on the external parameters of the system:\n$$\nJ = \\frac{F\\,(k_{1f}\\, k_{2f}\\, a_S - k_{1r}\\, k_{2r}\\, a_P)}{k_{1r} + F\\,k_{2f}}\n$$\nThis form correctly shows that the flux is zero at overall equilibrium, when $k_{1f}\\, k_{2f}\\, a_S = k_{1r}\\, k_{2r}\\, a_P$.\n\nThird, we formulate the expressions for the step affinities, $\\Delta \\mu_1$ and $\\Delta \\mu_2$. These are defined as the change in chemical potential for each step:\n$$\n\\Delta \\mu_1 = \\mu_I - \\mu_S = \\Delta \\mu_1^\\circ + R T \\ln \\left(\\frac{a_I}{a_S}\\right)\n$$\n$$\n\\Delta \\mu_2 = \\mu_P - \\mu_I = \\Delta \\mu_2^\\circ + R T \\ln \\left(\\frac{a_P}{a_I}\\right)\n$$\nThe standard affinities, $\\Delta \\mu_1^\\circ$ and $\\Delta \\mu_2^\\circ$, are calculated from the equilibrium constants of the steps, $K_i = k_{if}/k_{ir}$:\n$$\n\\Delta \\mu_1^\\circ = - R T \\ln K_1 = - R T \\ln \\left(\\frac{k_{1f}}{k_{1r}}\\right)\n$$\n$$\n\\Delta \\mu_2^\\circ = - R T \\ln K_2 = - R T \\ln \\left(\\frac{k_{2f}}{k_{2r}}\\right)\n$$\nWith the steady-state $a_I$ calculated, we can compute $\\Delta \\mu_1$ and $\\Delta \\mu_2$ using these formulas.\n\nThe computations will use the provided physical constants: the universal gas constant $R = 8.314462618\\ \\text{J mol}^{-1}\\ \\text{K}^{-1}$ and the temperature $T = 310.15\\ \\text{K}$. Based on these derivations, a program can be implemented to evaluate the required quantities for each test case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the metabolic pathway problem by deriving and calculating steady-state\n    flux and step affinities for given test cases.\n    \"\"\"\n    # Define constants as per the problem statement.\n    R = 8.314462618  # Universal gas constant in J mol^-1 K^-1\n    T = 310.15       # Temperature in K\n    RT = R * T\n\n    # Test suite: (k_1f, k_1r, k_2f, k_2r, a_S, a_P, chi, gamma)\n    test_cases = [\n        # Case A (baseline, no channeling)\n        (10.0, 1.0, 8.0, 0.8, 0.5, 0.05, 0.0, 1.0),\n        # Case B (moderate channeling)\n        (10.0, 1.0, 8.0, 0.8, 0.5, 0.05, 0.6, 5.0),\n        # Case C (strong channeling)\n        (10.0, 1.0, 8.0, 0.8, 0.5, 0.05, 1.0, 10.0),\n        # Case D (near-equilibrium overall, thermodynamically consistent)\n        (2.0, 2.0, 3.0, 3.0, 0.2, 0.22, 0.5, 3.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        k1f, k1r, k2f, k2r, aS, aP, chi, gamma = case\n\n        # 1. Calculate the channeling factor F\n        F = 1.0 + chi * (gamma - 1.0)\n\n        # 2. Calculate the steady-state activity of the intermediate, a_I\n        # a_I = (k1f * aS + F * k2r * aP) / (k1r + F * k2f)\n        numerator_aI = k1f * aS + F * k2r * aP\n        denominator_aI = k1r + F * k2f\n        aI = numerator_aI / denominator_aI\n\n        # 3. Calculate the net steady-state flux, J\n        # Since c_ref = 1, J is numerically equal to the steady-state rate v_ss.\n        # We use v1 = k1f * aS - k1r * aI.\n        J = k1f * aS - k1r * aI\n\n        # 4. Calculate the step affinities, dmu_1 and dmu_2\n        # A. Calculate standard affinities\n        # Add a small epsilon to avoid log(0) if a rate constant is zero, though not in these cases.\n        epsilon = 1e-15\n        K1 = k1f / (k1r + epsilon)\n        K2 = k2f / (k2r + epsilon)\n        dmu1_0 = -RT * np.log(K1)\n        dmu2_0 = -RT * np.log(K2)\n\n        # B. Calculate affinities under given conditions\n        # Avoid log(0) if activities are zero.\n        dmu1 = dmu1_0 + RT * np.log((aI + epsilon) / (aS + epsilon))\n        dmu2 = dmu2_0 + RT * np.log((aP + epsilon) / (aI + epsilon))\n\n        # 5. Round results to 6 decimal places and store them.\n        rounded_J = round(J, 6)\n        rounded_dmu1 = round(dmu1, 6)\n        rounded_dmu2 = round(dmu2, 6)\n        \n        results.extend([rounded_J, rounded_dmu1, rounded_dmu2])\n\n    # 6. Format and print the final output string.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2549731"}]}