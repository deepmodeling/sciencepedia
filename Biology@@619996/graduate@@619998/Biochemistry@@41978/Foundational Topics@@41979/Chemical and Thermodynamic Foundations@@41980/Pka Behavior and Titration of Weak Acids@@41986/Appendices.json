{"hands_on_practices": [{"introduction": "Understanding buffer behavior begins with a rigorous application of fundamental chemical principles. While the Henderson-Hasselbalch equation is a powerful shortcut, its validity rests on specific approximations. This exercise challenges you to derive the pH of a buffer solution from first principles—mass balance, charge balance, and equilibrium definitions—to build a robust understanding that applies even when common assumptions fail [@problem_id:2587753].", "problem": "An aqueous buffer is prepared at temperature $T = 298~\\mathrm{K}$ by dissolving a monoprotic weak acid $\\mathrm{HA}$ and its sodium salt $\\mathrm{NaA}$ to give formal (analytical) concentrations $F_{\\mathrm{HA}} = 0.100~\\mathrm{M}$ and $F_{\\mathrm{A^{-}}} = 0.050~\\mathrm{M}$, respectively, in a final volume that can be taken as unchanged by mixing. The acid dissociation constant $K_{a}$ of $\\mathrm{HA}$ at $T = 298~\\mathrm{K}$ corresponds to $pK_{a} = 5.00$, with $K_{a} = 10^{-pK_{a}}$. Assume ideal solution behavior (activity coefficients equal to $1$ for all ionic species) and that sodium ions do not undergo hydrolysis. The ionic product of water is $K_{w} = 1.0 \\times 10^{-14}$. \n\nStarting only from the definitions of the acid dissociation equilibrium constant, the electroneutrality (charge balance) condition, the total mass balance for the acid moiety, and the definition of acidity $pH = -\\log_{10}\\left[ \\mathrm{H^{+}} \\right]$, determine the equilibrium $pH$ of the solution. Justify any approximations you make by checking their self-consistency against the scales set by $F_{\\mathrm{HA}}$, $F_{\\mathrm{A^{-}}}$, and $K_{w}$. Report the final $pH$ as a pure number (no unit), rounded to three significant figures.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard scenario in aqueous equilibrium chemistry. All necessary data are provided, and the premises are consistent with fundamental chemical principles. Therefore, the problem is valid, and a solution can be formulated.\n\nThe task is to determine the equilibrium $pH$ of a buffer solution prepared from a weak acid $\\mathrm{HA}$ and its conjugate base salt $\\mathrm{NaA}$. We must start from fundamental principles as specified.\n\nThe chemical species present in the aqueous solution are $\\mathrm{H}^{+}$, $\\mathrm{OH}^{-}$, $\\mathrm{Na}^{+}$, $\\mathrm{HA}$, and $\\mathrm{A}^{-}$. Their concentrations are governed by the following equilibria and conservation laws.\n\n1.  **Acid Dissociation Equilibrium**: The dissociation of the weak acid $\\mathrm{HA}$ is described by its acid dissociation constant, $K_a$.\n    $$K_a = \\frac{[\\mathrm{H}^{+}][\\mathrm{A}^{-}]}{[\\mathrm{HA}]}$$\n    Given $pK_a = 5.00$, the constant is $K_a = 10^{-5.00}$.\n\n2.  **Water Autoionization**: The dissociation of water establishes an equilibrium between hydronium and hydroxide ions.\n    $$K_w = [\\mathrm{H}^{+}][\\mathrm{OH}^{-}]$$\n    At $T = 298~\\mathrm{K}$, $K_w = 1.0 \\times 10^{-14}$.\n\n3.  **Mass Balance**: The total concentration of the acid moiety (species containing 'A') is the sum of the initial formal concentrations, $F_{\\mathrm{HA}}$ and $F_{\\mathrm{A^{-}}}$.\n    $$[\\mathrm{HA}] + [\\mathrm{A}^{-}] = F_{\\mathrm{HA}} + F_{\\mathrm{A^{-}}}$$\n    Here, $F_{\\mathrm{HA}} = 0.100~\\mathrm{M}$ and $F_{\\mathrm{A^{-}}} = 0.050~\\mathrm{M}$.\n\n4.  **Electroneutrality (Charge Balance)**: The solution as a whole must be electrically neutral. The sum of the concentrations of positive ions must equal the sum of the concentrations of negative ions. The sodium salt $\\mathrm{NaA}$ is a strong electrolyte and dissociates completely, thus $[\\mathrm{Na}^{+}] = F_{\\mathrm{A^{-}}}$.\n    $$[\\mathrm{Na}^{+}] + [\\mathrm{H}^{+}] = [\\mathrm{A}^{-}] + [\\mathrm{OH}^{-}]$$\n    Substituting for $[\\mathrm{Na}^{+}]$, we have:\n    $$F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] = [\\mathrm{A}^{-}] + [\\mathrm{OH}^{-}]$$\n\nThese four equations form a complete system to determine the five unknown concentrations. We seek to find $[\\mathrm{H}^{+}]$.\n\nFrom the charge balance equation, we can express the equilibrium concentration of the conjugate base, $[\\mathrm{A}^{-}]$:\n$$[\\mathrm{A}^{-}] = F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}]$$\nUsing the water autoionization equilibrium, we replace $[\\mathrm{OH}^{-}]$ with $\\frac{K_w}{[\\mathrm{H}^{+}]}$:\n$$[\\mathrm{A}^{-}] = F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] - \\frac{K_w}{[\\mathrm{H}^{+}]}$$\nFrom the mass balance equation, we express the equilibrium concentration of the weak acid, $[\\mathrm{HA}]$:\n$$[\\mathrm{HA}] = (F_{\\mathrm{HA}} + F_{\\mathrm{A^{-}}}) - [\\mathrm{A}^{-}]$$\nSubstituting the expression for $[\\mathrm{A}^{-}]$:\n$$[\\mathrm{HA}] = (F_{\\mathrm{HA}} + F_{\\mathrm{A^{-}}}) - \\left(F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] - \\frac{K_w}{[\\mathrm{H}^{+}]}\\right) = F_{\\mathrm{HA}} - [\\mathrm{H}^{+}] + \\frac{K_w}{[\\mathrm{H}^{+}]}$$\nNow, we substitute these exact expressions for $[\\mathrm{HA}]$ and $[\\mathrm{A}^{-}]$ into the acid dissociation equilibrium equation:\n$$K_a = \\frac{[\\mathrm{H}^{+}] \\left(F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] - \\frac{K_w}{[\\mathrm{H}^{+}]}\\right)}{F_{\\mathrm{HA}} - [\\mathrm{H}^{+}] + \\frac{K_w}{[\\mathrm{H}^{+}]}}$$\nThis equation is exact but forms a cubic polynomial in $[\\mathrm{H}^{+}]$. We can solve it, but it is standard practice to use justified approximations for buffer systems.\n\nThe problem requires justification of any approximations. The solution is a buffer with a $pK_a = 5.00$. Therefore, we expect the $pH$ to be close to $5$, meaning $[\\mathrm{H}^{+}] \\approx 10^{-5}~\\mathrm{M}$ and $[\\mathrm{OH}^{-}] = K_w / [\\mathrm{H}^{+}] \\approx 10^{-9}~\\mathrm{M}$. We compare these values to the formal concentrations $F_{\\mathrm{HA}} = 0.100~\\mathrm{M}$ and $F_{\\mathrm{A^{-}}} = 0.050~\\mathrm{M}$.\nWe observe that $[\\mathrm{H}^{+}] \\ll F_{\\mathrm{HA}}$, $[\\mathrm{H}^{+}] \\ll F_{\\mathrm{A^{-}}}$, $[\\mathrm{OH}^{-}] \\ll F_{\\mathrm{HA}}$, and $[\\mathrm{OH}^{-}] \\ll F_{\\mathrm{A^{-}}}$.\nThis suggests that the terms $[\\mathrm{H}^{+}]$ and $[\\mathrm{OH}^{-}]$ are negligible compared to $F_{\\mathrm{HA}}$ and $F_{\\mathrm{A^{-}}}$ in the expressions for the equilibrium concentrations $[\\mathrm{HA}]$ and $[\\mathrm{A}^{-}]$.\n\nLet us apply this approximation:\n$$[\\mathrm{A}^{-}] = F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}] \\approx F_{\\mathrm{A^{-}}}$$\n$$[\\mathrm{HA}] = F_{\\mathrm{HA}} - [\\mathrm{H}^{+}] + \\frac{K_w}{[\\mathrm{H}^{+}]} \\approx F_{\\mathrm{HA}}$$\nThis approximation is valid if the extent of dissociation of $\\mathrm{HA}$ and hydrolysis of $\\mathrm{A}^{-}$ is small compared to their initial formal concentrations.\nSubstituting these approximations into the $K_a$ expression gives the simplified relation:\n$$K_a \\approx \\frac{[\\mathrm{H}^{+}]F_{\\mathrm{A^{-}}}}{F_{\\mathrm{HA}}}$$\nSolving for $[\\mathrm{H}^{+}]$:\n$$[\\mathrm{H}^{+}] \\approx K_a \\frac{F_{\\mathrm{HA}}}{F_{\\mathrm{A^{-}}}}$$\nWe substitute the given values:\n$$[\\mathrm{H}^{+}] \\approx (10^{-5.00}) \\times \\frac{0.100}{0.050} = (1.00 \\times 10^{-5}) \\times 2.00 = 2.00 \\times 10^{-5}~\\mathrm{M}$$\nNow, we perform the self-consistency check for the approximations. Using our calculated value $[\\mathrm{H}^{+}] \\approx 2.00 \\times 10^{-5}~\\mathrm{M}$:\n$$[\\mathrm{OH}^{-}] = \\frac{K_w}{[\\mathrm{H}^{+}]} = \\frac{1.0 \\times 10^{-14}}{2.00 \\times 10^{-5}} = 5.0 \\times 10^{-10}~\\mathrm{M}$$\nWe check the fractional error in the approximation for $[\\mathrm{A}^{-}]$:\nThe term we neglected relative to $F_{\\mathrm{A^{-}}}$ is $([\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}])$.\n$$\\frac{|[\\mathrm{H}^{+}]-[\\mathrm{OH}^{-}]|}{F_{\\mathrm{A^{-}}}}=\\frac{|2.00 \\times 10^{-5} - 5.0 \\times 10^{-10}|}{0.050} \\approx \\frac{2.00 \\times 10^{-5}}{0.050} = 4.0 \\times 10^{-4}$$\nThis corresponds to a relative error of $0.04 \\%$.\nWe check the fractional error in the approximation for $[\\mathrm{HA}]$:\nThe term we neglected relative to $F_{\\mathrm{HA}}$ is also $([\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}])$, but it appears as $([\\mathrm{H}^{+}] - K_w/[\\mathrm{H}^{+}])$ with a negative sign.\n$$\\frac{|-([\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}])|}{F_{\\mathrm{HA}}}=\\frac{|-(2.00 \\times 10^{-5} - 5.0 \\times 10^{-10})|}{0.100} \\approx \\frac{2.00 \\times 10^{-5}}{0.100} = 2.0 \\times 10^{-4}$$\nThis corresponds to a relative error of $0.02 \\%$.\nBoth errors are very small, confirming that the approximations $[\\mathrm{A}^{-}] \\approx F_{\\mathrm{A^{-}}}$ and $[\\mathrm{HA}] \\approx F_{\\mathrm{HA}}$ are justified for the required precision.\n\nWith the value of $[\\mathrm{H}^{+}]$ validated, we can now calculate the $pH$:\n$$pH = -\\log_{10}([\\mathrm{H}^{+}]) = -\\log_{10}(2.00 \\times 10^{-5})$$\n$$pH = -(\\log_{10}(2.00) + \\log_{10}(10^{-5})) = 5.00 - \\log_{10}(2.00)$$\nUsing a calculator, $\\log_{10}(2.00) \\approx 0.30103$.\n$$pH \\approx 5.00 - 0.30103 = 4.69897$$\nThe problem requires the answer to be rounded to three significant figures.\n$$pH \\approx 4.70$$\nThis final result is consistent with our initial assessment and has been derived strictly from the given principles, with all approximations rigorously justified.", "answer": "$$\\boxed{4.70}$$", "id": "2587753"}, {"introduction": "Biomolecules often possess multiple ionizable groups, making their acid-base behavior more complex than that of simple monoprotic acids. This practice extends our analysis to a diprotic system, simulating a scenario common in biochemistry like the titration of an amino acid. By finding the pH at key titration points, you will directly connect features of the titration curve to the underlying microscopic $pK_a$ values that characterize the molecule [@problem_id:2587709].", "problem": "A diprotic weak acid denoted $\\mathrm{H_2A}$ is titrated with a strong base $\\mathrm{NaOH}$ in water at $25\\,^{\\circ}\\mathrm{C}$. The aqueous medium is dilute and of low ionic strength, and you may assume ideal behavior of all solutes, full dissociation of strong electrolytes, and that the autoionization of water contributes negligibly to proton balance in the pH ranges of interest. The stepwise acid dissociation constants of $\\mathrm{H_2A}$ are specified by the negative base-$10$ logarithms $pK_{a1}$ and $pK_{a2}$, with $pK_{a1} = 3.8649$ and $pK_{a2} = 7.2146$. The initial solution contains $25.00\\,\\mathrm{mL}$ of $\\mathrm{H_2A}$ at a concentration of $0.01000\\,\\mathrm{M}$, titrated with $0.1000\\,\\mathrm{M}$ $\\mathrm{NaOH}$. The separation $pK_{a2} - pK_{a1}$ is sufficiently large to treat the two deprotonation steps as well separated in the buffer regions.\n\nUsing only the fundamental definitions of stepwise acid dissociation equilibria, conservation of mass, electroneutrality, and the stoichiometry of the titration reaction, determine the pH at the first half-equivalence point and at the second half-equivalence point of this titration. Justify any approximations you invoke from first principles. Express your final numerical results as a row matrix $\\big[ \\mathrm{pH}_{1/2,1} \\ \\mathrm{pH}_{1/2,2} \\big]$, where $\\mathrm{pH}_{1/2,1}$ is the pH at the first half-equivalence point and $\\mathrm{pH}_{1/2,2}$ is the pH at the second half-equivalence point. Round your answers to four significant figures. Do not include units in your final reported row matrix.", "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n-   System: Titration of a diprotic weak acid, $\\mathrm{H_2A}$, with a strong base, $\\mathrm{NaOH}$.\n-   Solvent: Water at a temperature of $25\\,^{\\circ}\\mathrm{C}$.\n-   Initial acid volume: $V_{\\mathrm{H_2A}} = 25.00\\,\\mathrm{mL}$.\n-   Initial acid concentration: $[\\mathrm{H_2A}]_{0} = 0.01000\\,\\mathrm{M}$.\n-   Titrant concentration: $[\\mathrm{NaOH}] = 0.1000\\,\\mathrm{M}$.\n-   Acid dissociation constants: $pK_{a1} = 3.8649$, $pK_{a2} = 7.2146$.\n-   Assumptions: Ideal behavior of solutes, full dissociation of strong electrolytes, negligible autoionization of water, and that the two deprotonation steps are well separated due to the large difference $pK_{a2} - pK_{a1}$.\n-   Objective: Determine the $\\mathrm{pH}$ at the first and second half-equivalence points, denoted $\\mathrm{pH}_{1/2,1}$ and $\\mathrm{pH}_{1/2,2}$, respectively.\n-   Required format: A row matrix $[\\mathrm{pH}_{1/2,1} \\ \\mathrm{pH}_{1/2,2}]$ with results rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem describes a standard chemical titration, a fundamental and well-understood process in analytical chemistry and biochemistry. The provided $pK_a$ values, concentrations, and volumes are physically and chemically realistic.\n-   **Well-Posed**: The problem is well-posed. All necessary information to calculate the $\\mathrm{pH}$ at the specified points is provided. The conditions are sufficient to determine a unique solution.\n-   **Objective**: The problem is stated in precise, quantitative terms, free from ambiguity or subjective interpretation.\n\nThe problem does not violate any criteria for validity. It is scientifically sound, complete, and stated objectively.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A solution will be formulated based on fundamental principles.\n\nThe diprotic acid $\\mathrm{H_2A}$ dissociates in water in two steps, governed by two distinct equilibrium constants, $K_{a1}$ and $K_{a2}$.\n\nThe first dissociation step is:\n$$ \\mathrm{H_2A} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{HA^-} + \\mathrm{H_3O^+} $$\nwith the acid dissociation constant $K_{a1}$ defined as:\n$$ K_{a1} = \\frac{[\\mathrm{HA^-}][\\mathrm{H_3O^+}]}{[\\mathrm{H_2A}]} $$\nThe value of $K_{a1}$ is derived from the given $pK_{a1}$: $K_{a1} = 10^{-pK_{a1}} = 10^{-3.8649}$.\n\nThe second dissociation step is:\n$$ \\mathrm{HA^-} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{A^{2-}} + \\mathrm{H_3O^+} $$\nwith the acid dissociation constant $K_{a2}$ defined as:\n$$ K_{a2} = \\frac{[\\mathrm{A^{2-}}][\\mathrm{H_3O^+}]}{[\\mathrm{HA^-}]} $$\nThe value of $K_{a2}$ is derived from the given $pK_{a2}$: $K_{a2} = 10^{-pK_{a2}} = 10^{-7.2146}$.\n\nThe problem explicitly states that $pK_{a2} - pK_{a1} = 7.2146 - 3.8649 = 3.3497$, which is greater than $3$. This large separation justifies treating the two titration regions independently.\n\n**Determination of pH at the First Half-Equivalence Point ($\\mathrm{pH}_{1/2,1}$)**\n\nThe first half-equivalence point is defined as the point in the titration where exactly half of the initial moles of $\\mathrm{H_2A}$ have been neutralized by the strong base $\\mathrm{NaOH}$. The neutralization reaction is:\n$$ \\mathrm{H_2A} + \\mathrm{OH^-} \\to \\mathrm{HA^-} + \\mathrm{H_2O} $$\nSince a strong base is used, this reaction proceeds essentially to completion. At the first half-equivalence point, the moles of added $\\mathrm{OH^-}$ are equal to one-half of the initial moles of $\\mathrm{H_2A}$. Stoichiometrically, this means that the concentration of the remaining acid, $[\\mathrm{H_2A}]$, is equal to the concentration of the conjugate base formed, $[\\mathrm{HA^-}]$.\n$$ [\\mathrm{H_2A}] = [\\mathrm{HA^-}] $$\nThis approximation is valid because the system is in the first buffer region, where the pH is low enough such that the second dissociation ($\\mathrm{HA^-} \\to \\mathrm{A^{2-}}$) is suppressed, and the pH is far from $7$, justifying the neglect of water autoionization as per the problem statement.\n\nTo find the $\\mathrm{pH}$, one must rearrange the expression for $K_{a1}$:\n$$ [\\mathrm{H_3O^+}] = K_{a1} \\frac{[\\mathrm{H_2A}]}{[\\mathrm{HA^-}]} $$\nTaking the negative base-$10$ logarithm of both sides gives the Henderson-Hasselbalch equation:\n$$ -\\log_{10}([\\mathrm{H_3O^+}]) = -\\log_{10}(K_{a1}) - \\log_{10}\\left(\\frac{[\\mathrm{H_2A}]}{[\\mathrm{HA^-}]}\\right) $$\n$$ \\mathrm{pH} = pK_{a1} + \\log_{10}\\left(\\frac{[\\mathrm{HA^-}]}{[\\mathrm{H_2A}]}\\right) $$\nApplying the condition at the first half-equivalence point, $[\\mathrm{H_2A}] = [\\mathrm{HA^-}]$, the logarithmic term becomes $\\log_{10}(1) = 0$.\nThus, the $\\mathrm{pH}$ at the first half-equivalence point is equal to $pK_{a1}$.\n$$ \\mathrm{pH}_{1/2,1} = pK_{a1} = 3.8649 $$\n\n**Determination of pH at the Second Half-Equivalence Point ($\\mathrm{pH}_{1/2,2}$)**\n\nThe second half-equivalence point is reached when $1.5$ equivalents of base have been added. The first equivalent converts all $\\mathrm{H_2A}$ to $\\mathrm{HA^-}$. The next half-equivalent converts half of the $\\mathrm{HA^-}$ to its conjugate base, $\\mathrm{A^{2-}}$. The relevant reaction is:\n$$ \\mathrm{HA^-} + \\mathrm{OH^-} \\to \\mathrm{A^{2-}} + \\mathrm{H_2O} $$\nAt this point, the concentration of the remaining acid species, $[\\mathrm{HA^-}]$, is equal to the concentration of the conjugate base formed, $[\\mathrm{A^{2-}}]$.\n$$ [\\mathrm{HA^-}] = [\\mathrm{A^{2-}}] $$\nThis condition is valid because the system is in the second buffer region. The large separation of $pK_a$ values ensures that the concentration of the fully protonated species, $\\mathrm{H_2A}$, is negligible. This can be verified from the $K_{a1}$ equilibrium: at a $\\mathrm{pH} \\approx pK_{a2}$, the ratio $$\\frac{[\\mathrm{H_2A}]}{[\\mathrm{HA^-}]} = \\frac{[\\mathrm{H_3O^+}]}{K_{a1}} \\approx \\frac{10^{-7.2}}{10^{-3.9}} \\approx 10^{-3.3} \\ll 1$$.\n\nTo find the $\\mathrm{pH}$, we use the expression for $K_{a2}$:\n$$ [\\mathrm{H_3O^+}] = K_{a2} \\frac{[\\mathrm{HA^-}]}{[\\mathrm{A^{2-}}]} $$\nTaking the negative base-$10$ logarithm of both sides gives the Henderson-Hasselbalch equation for the second buffer system:\n$$ \\mathrm{pH} = pK_{a2} + \\log_{10}\\left(\\frac{[\\mathrm{A^{2-}}]}{[\\mathrm{HA^-}]}\\right) $$\nApplying the condition at the second half-equivalence point, $[\\mathrm{HA^-}] = [\\mathrm{A^{2-}}]$, the logarithmic term becomes $\\log_{10}(1) = 0$.\nThus, the $\\mathrm{pH}$ at the second half-equivalence point is equal to $pK_{a2}$.\n$$ \\mathrm{pH}_{1/2,2} = pK_{a2} = 7.2146 $$\n\n**Final Calculation and Formatting**\n\nThe calculated $\\mathrm{pH}$ values are $\\mathrm{pH}_{1/2,1} = 3.8649$ and $\\mathrm{pH}_{1/2,2} = 7.2146$. The problem requires the answers to be rounded to four significant figures.\n-   Rounding $3.8649$ to four significant figures yields $3.865$.\n-   Rounding $7.2146$ to four significant figures yields $7.215$.\n\nThe final result is presented as a row matrix.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.865 & 7.215\n\\end{pmatrix}\n}\n$$", "id": "2587709"}, {"introduction": "In the intricate environment of a protein, the $pK_a$ of a residue is often modulated by its neighbors, a phenomenon known as $pK_a$ coupling. This advanced practice moves from analytical solutions to computational biophysics, tasking you with building a statistical mechanical model to describe such a system. By performing a global fit of simulated spectroscopic data, you will learn how to disentangle overlapping $pK_a$ values and quantify the energetic cooperativity between interacting sites, a skill central to modern enzymology and protein engineering [@problem_id:2587737].", "problem": "You are tasked with designing and analyzing a titration experiment to disentangle overlapping acid dissociation constants, denoted as pKa, of two nearby titratable residues that may interact. The experiment uses two independent spectroscopic probes whose signals depend on the microstate of protonation of the two residues. Your program must simulate titration curves for specified parameter sets and then perform a global nonlinear least-squares fit to recover the $pK_a$ values and an interaction parameter from the combined probe data. The problem must be addressed from first principles of acid-base equilibrium and mass-action, and the program must implement the derived equations without using shortcut formulas.\n\nBegin from the following base facts only:\n- The acid dissociation constant is defined by $$K_a = \\frac{[A^-][H^+]}{[HA]}$$, and $pK_a = -\\log_{10} K_a$.\n- For a fixed hydrogen ion activity, $[\\mathrm{H}^+]$, the relative propensity to deprotonate a site is governed by mass action.\n- The spectroscopic signal is the population-weighted average of microstate-specific signals.\n\nModel the two residues as a coupled two-site acid-base system with four microstates: both protonated, residue $\\mathrm{A}$ deprotonated only, residue $\\mathrm{B}$ deprotonated only, and both deprotonated. Let the microscopic $pK_a$ values be $pK_{a,\\mathrm{A}}$ and $pK_{a,\\mathrm{B}}$, and let $c$ be a dimensionless cooperativity factor such that the statistical weight of the doubly deprotonated state is multiplied by $c$ relative to the case of no coupling ($c = 1$ corresponds to independent sites; $c > 1$ indicates positive cooperativity; $c  1$ indicates negative cooperativity). Let pH be the solution acidity, treated as a unitless quantity.\n\nFor each spectroscopic probe $j \\in \\{1,2\\}$, define fixed, known microstate-specific signals $s^{(j)}_{00}$, $s^{(j)}_{10}$, $s^{(j)}_{01}$, $s^{(j)}_{11}$ corresponding to the four microstates: $(00)$ both protonated, $(10)$ only $\\mathrm{A}$ deprotonated, $(01)$ only $\\mathrm{B}$ deprotonated, and $(11)$ both deprotonated. The observed signal at a given pH is the population-weighted average of these microstate signals.\n\nYour program must:\n- Use the mass-action model to compute microstate weights as functions of pH, $pK_{a,\\mathrm{A}}$, $pK_{a,\\mathrm{B}}$, and $c$, normalize them to populations, and use them to compute probe signals as population-weighted averages.\n- Generate synthetic titration data at a specified set of pH values with known parameters by evaluating the forward model, without adding noise.\n- Perform a global nonlinear least-squares fit across both probes and all pH points to estimate $pK_{a,\\mathrm{A}}$, $pK_{a,\\mathrm{B}}$, and $c$ simultaneously from the combined data. Implement parameter bounds such that $pK_{a,\\mathrm{A}}$ and $pK_{a,\\mathrm{B}}$ remain within $[3,11]$ and $c$ remains within $[10^{-2},10^{2}]$.\n- Return the estimated parameters for each test case.\n\nUse the following fixed microstate-specific signals (arbitrary units) for the two probes, which are known to the fitting model:\n- Probe $\\#1$: $s^{(1)}_{00} = 0.20$, $s^{(1)}_{10} = 1.00$, $s^{(1)}_{01} = 0.25$, $s^{(1)}_{11} = 1.05$.\n- Probe $\\#2$: $s^{(2)}_{00} = 0.30$, $s^{(2)}_{10} = 0.35$, $s^{(2)}_{01} = 1.10$, $s^{(2)}_{11} = 1.15$.\n\nUse the following pH grid (unitless) for all cases:\n- pH points: $[4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0, 9.5, 10.0]$.\n\nTest Suite:\nEach test case specifies true $(pK_{a,\\mathrm{A}}, pK_{a,\\mathrm{B}}, c)$. Simulate the data using these true parameters, then fit to recover them.\n- Case $1$ (distinct, independent): $(6.50, 8.20, 1.00)$.\n- Case $2$ (overlapping, independent): $(6.90, 7.00, 1.00)$.\n- Case $3$ (moderate positive cooperativity): $(6.80, 7.20, 5.00)$.\n- Case $4$ (negative cooperativity): $(6.80, 7.20, 0.20)$.\n\nAnswer format and units:\n- Report $pK_{a,\\mathrm{A}}$ and $pK_{a,\\mathrm{B}}$ as unitless numbers rounded to two decimal places.\n- Report $c$ as a unitless number rounded to two decimal places.\n- If your fit internally labels the sites differently, sort the reported $pK_a$ values in ascending order before output; report the same fitted $c$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list of lists, enclosed in square brackets. Each inner list must contain three floats $[pK_{a,\\min}, pK_{a,\\max}, c]$ for that case. For example, a valid output for two cases would look like: $[[6.50,7.80,1.00],[6.90,7.00,1.00]]$.\n\nYour program must be a complete, runnable program that produces exactly one line in the specified format and nothing else.", "solution": "The problem presented is a well-posed exercise in biophysical chemistry, requiring the derivation and application of a statistical thermodynamic model for coupled equilibria. It is based on sound scientific principles and is free of logical or factual inconsistencies. Therefore, we shall proceed with a complete solution.\n\nThe system consists of two titratable sites, $\\mathrm{A}$ and $\\mathrm{B}$, which can exist in one of four protonation microstates: $M_{00}$ (both sites protonated, $HA-HB$), $M_{10}$ (site $\\mathrm{A}$ deprotonated, $A^{-}-HB$), $M_{01}$ (site $\\mathrm{B}$ deprotonated, $HA-B^{-}$), and $M_{11}$ (both sites deprotonated, $A^{-}-B^{-}$). The objective is to determine the intrinsic acid dissociation constants, $pK_{a,\\mathrm{A}}$ and $pK_{a,\\mathrm{B}}$, and a parameter $c$ quantifying their interaction, from spectroscopic titration data.\n\nWe begin from first principles of mass-action. The microscopic acid dissociation equilibria are:\n$$\n\\mathrm{HA} \\rightleftharpoons \\mathrm{A}^{-} + \\mathrm{H}^{+} \\quad \\text{with} \\quad K_a = \\frac{[A^{-}][H^{+}]}{[HA]}\n$$\nFrom this, we define $pK_a = -\\log_{10} K_a$ and use the definition of $\\mathrm{pH} = -\\log_{10} [\\mathrm{H}^{+}]$. Note that pH is treated as a unitless quantity as specified.\n\nTo model the system, we define statistical weights for each of the four microstates relative to the fully protonated state, $M_{00}$, whose weight is set to unity by convention, $w_{00} = 1$.\n\nThe equilibrium between $M_{00}$ and $M_{10}$ is $M_{00} \\rightleftharpoons M_{10} + H^{+}$. The equilibrium constant is the microscopic constant for site $\\mathrm{A}$, $K_{a,\\mathrm{A}}$.\n$$\nK_{a,\\mathrm{A}} = \\frac{[M_{10}][H^{+}]}{[M_{00}]} \\implies \\frac{[M_{10}]}{[M_{00}]} = \\frac{K_{a,\\mathrm{A}}}{[H^{+}]} = 10^{-pK_{a,\\mathrm{A}}} \\cdot 10^{\\mathrm{pH}} = 10^{\\mathrm{pH} - pK_{a,\\mathrm{A}}}\n$$\nThe statistical weight of $M_{10}$ is therefore $w_{10} = 10^{\\mathrm{pH} - pK_{a,\\mathrm{A}}}$.\nBy identical logic for site $\\mathrm{B}$, the statistical weight of $M_{01}$ is $w_{01} = 10^{\\mathrm{pH} - pK_{a,\\mathrm{B}}}$.\n\nFor the doubly deprotonated state, $M_{11}$, we consider the overall equilibrium $M_{00} \\rightleftharpoons M_{11} + 2H^{+}$. The statistical weight $w_{11}$ is given by $[M_{11}]/[M_{00}]$. In the absence of coupling ($c = 1$), the sites titrate independently. The thermodynamic path from $M_{00}$ to $M_{11}$ involves two proton dissociations with constants $K_{a,\\mathrm{A}}$ and $K_{a,\\mathrm{B}}$, leading to $w_{11, uncoupled} = \\frac{K_{a,\\mathrm{A}}K_{a,\\mathrm{B}}}{[H^{+}]^2} = 10^{2\\cdot\\mathrm{pH} - pK_{a,\\mathrm{A}} - pK_{a,\\mathrm{B}}}$.\nThe problem introduces a cooperativity factor, $c$, which modifies the statistical weight of the $M_{11}$ state. This factor directly accounts for the interaction energy between the sites. Thus, the weight of the doubly deprotonated state is:\n$$\nw_{11} = c \\cdot w_{11, uncoupled} = c \\cdot 10^{2 \\cdot \\mathrm{pH} - pK_{a,\\mathrm{A}} - pK_{a,\\mathrm{B}}}\n$$\nA value of $c > 1$ denotes positive cooperativity (deprotonation of one site facilitates deprotonation of the other), while $c  1$ denotes negative cooperativity.\n\nThe set of statistical weights is:\n$w_{00} = 1$\n$w_{10} = 10^{\\mathrm{pH} - pK_{a,\\mathrm{A}}}$\n$w_{01} = 10^{\\mathrm{pH} - pK_{a,\\mathrm{B}}}$\n$w_{11} = c \\cdot 10^{2 \\cdot \\mathrm{pH} - pK_{a,\\mathrm{A}} - pK_{a,\\mathrm{B}}}$\n\nThe probability, or population, of each microstate is its weight divided by the sum of all weights, which is the partition function $Z$:\n$$\nZ(\\mathrm{pH}; pK_{a,\\mathrm{A}}, pK_{a,\\mathrm{B}}, c) = w_{00} + w_{10} + w_{01} + w_{11}\n$$\nThe populations are:\n$P_{00} = w_{00}/Z$, $P_{10} = w_{10}/Z$, $P_{01} = w_{01}/Z$, $P_{11} = w_{11}/Z$.\n\nThe observed signal for each spectroscopic probe $j \\in \\{1, 2\\}$ is the population-weighted average of the signals from each of the four microstates ($s^{(j)}_{00}, s^{(j)}_{10}, s^{(j)}_{01}, s^{(j)}_{11}$):\n$$\nS^{(j)}(\\mathrm{pH}) = P_{00} s^{(j)}_{00} + P_{10} s^{(j)}_{10} + P_{01} s^{(j)}_{01} + P_{11} s^{(j)}_{11}\n$$\nThis equation constitutes the forward model, which predicts the spectroscopic signal at any pH for a given set of parameters $\\theta = (pK_{a,\\mathrm{A}}, pK_{a,\\mathrm{B}}, c)$.\n\nTo recover the parameters from experimental data, we perform a global nonlinear least-squares fit. The goal is to find the parameter set $\\theta_{fit}$ that minimizes the sum of squared residuals (SSR) between the synthetic data ($S^{(j)}_{data}$) and the model's predictions ($S^{(j)}_{model}$) across both probes and all pH points:\n$$\n\\text{SSR}(\\theta) = \\sum_{j=1}^{2} \\sum_{i} \\left[ S^{(j)}_{data}(\\mathrm{pH}_i) - S^{(j)}_{model}(\\mathrm{pH}_i; \\theta) \\right]^2\n$$\nThis optimization will be performed numerically using the Levenberg-Marquardt algorithm, as implemented in the `scipy.optimize.least_squares` library function. Parameter bounds are imposed as specified: $pK_a \\in [3, 11]$ and $c \\in [10^{-2}, 10^2]$.\n\nThe procedure for each test case is as follows:\n$1$. Generate synthetic titration data for both probes across the given pH grid using the forward model with the true parameters.\n$2$. Define a residual function that computes the difference between the synthetic data and the model prediction for a given set of trial parameters.\n$3$. Execute the numerical optimization to find the parameters that minimize the sum of the squares of these residuals.\n$4$. The resulting fitted $pK_a$ values must be sorted in ascending order to ensure a unique representation, as the model is symmetric with respect to the exchange of site labels $\\mathrm{A}$ and $\\mathrm{B}$. The final parameters are then reported with the required precision.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting coupled pKa values from simulated spectroscopic data.\n    \"\"\"\n\n    # --- Fixed parameters from the problem statement ---\n\n    # Microstate-specific signals for Probe 1 and Probe 2\n    # s_j_ik where j is probe index (0-indexed) and ik is microstate (00, 10, 01, 11)\n    # Microstates: 00 (H-H), 10 (A- - H), 01 (H - B-), 11 (A- - B-)\n    S_MICROSTATE = np.array([\n        [0.20, 1.00, 0.25, 1.05],  # Probe 1 signals\n        [0.30, 0.35, 1.10, 1.15]   # Probe 2 signals\n    ])\n    S00, S10, S01, S11 = S_MICROSTATE[:, 0], S_MICROSTATE[:, 1], S_MICROSTATE[:, 2], S_MICROSTATE[:, 3]\n\n    # pH grid for the titration\n    PH_GRID = np.array([4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0, 9.5, 10.0])\n\n    # Test cases: (pKa_A, pKa_B, c)\n    test_cases = [\n        (6.50, 8.20, 1.00),\n        (6.90, 7.00, 1.00),\n        (6.80, 7.20, 5.00),\n        (6.80, 7.20, 0.20),\n    ]\n\n    def forward_model(ph_values, pka_a, pka_b, c):\n        \"\"\"\n        Calculates the theoretical spectroscopic signal for both probes.\n        \n        Args:\n            ph_values (np.ndarray): Array of pH values.\n            pka_a (float): Microscopic pKa of site A.\n            pka_b (float): Microscopic pKa of site B.\n            c (float): Cooperativity factor.\n\n        Returns:\n            np.ndarray: A (2, N) array where N is the number of pH points.\n                        Row 0 is the signal for Probe 1, Row 1 for Probe 2.\n        \"\"\"\n        # Calculate statistical weights for each microstate at each pH\n        exp_ph_pkaa = 10**(ph_values - pka_a)\n        exp_ph_pkab = 10**(ph_values - pka_b)\n\n        w00 = np.ones_like(ph_values)\n        w10 = exp_ph_pkaa\n        w01 = exp_ph_pkab\n        w11 = c * exp_ph_pkaa * exp_ph_pkab\n        \n        # Partition function (sum of weights)\n        Z = w00 + w10 + w01 + w11\n\n        # Calculate population of each microstate\n        p00 = w00 / Z\n        p10 = w10 / Z\n        p01 = w01 / Z\n        p11 = w11 / Z\n\n        # Calculate predicted signal as population-weighted average\n        # S00, S10, S01, S11 are (2,) arrays (for each probe), broadcasting works\n        signal_p1 = p00 * S00[0] + p10 * S10[0] + p01 * S01[0] + p11 * S11[0]\n        signal_p2 = p00 * S00[1] + p10 * S10[1] + p01 * S01[1] + p11 * S11[1]\n\n        return np.array([signal_p1, signal_p2])\n\n    results = []\n    for case in test_cases:\n        pka_a_true, pka_b_true, c_true = case\n\n        # 1. Generate synthetic data using the true parameters\n        synthetic_data = forward_model(PH_GRID, pka_a_true, pka_b_true, c_true)\n\n        # 2. Define the residual function for the least-squares fitting\n        def residuals(params, ph_grid, data):\n            \"\"\"\n            Calculates the residuals between the model and the data.\n            `params` is a list/tuple: [pka_a, pka_b, c].\n            `data` is the (2, N) array of synthetic measurements.\n            \"\"\"\n            pka_a_fit, pka_b_fit, c_fit = params\n            model_prediction = forward_model(ph_grid, pka_a_fit, pka_b_fit, c_fit)\n            # Flatten the residuals for both probes into a single array\n            return (model_prediction - data).flatten()\n\n        # 3. Perform the nonlinear least-squares fit\n        initial_guess = [7.0, 7.0, 1.0] # A reasonable starting point\n        # Bounds: pKa in [3, 11], c in [0.01, 100]\n        bounds = ([3.0, 3.0, 1e-2], [11.0, 11.0, 1e2])\n        \n        fit_result = least_squares(\n            residuals,\n            initial_guess,\n            bounds=bounds,\n            args=(PH_GRID, synthetic_data),\n            method='trf' # Trust Region Reflective algorithm, good for bounds\n        )\n        \n        # 4. Extract, sort, and format the fitted parameters\n        pka_a_fit, pka_b_fit, c_fit = fit_result.x\n        \n        # Sort pKa values in ascending order\n        pka_sorted = sorted([pka_a_fit, pka_b_fit])\n        \n        # Round to two decimal places\n        pka1_rounded = round(pka_sorted[0], 2)\n        pka2_rounded = round(pka_sorted[1], 2)\n        c_rounded = round(c_fit, 2)\n        \n        results.append([pka1_rounded, pka2_rounded, c_rounded])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2587737"}]}