{"hands_on_practices": [{"introduction": "The ability of optogenetic tools to control neuronal activity stems from their function as light-gated ion channels that alter the membrane's relative permeability to different ions. To understand this process quantitatively, we can apply the Goldman–Hodgkin–Katz (GHK) equation, a foundational model in cellular biophysics that predicts the membrane potential based on ion concentrations and permeabilities. This practice challenges you to calculate the change in a neuron's resting membrane potential upon activation of a hypothetical cation channel, providing a first-principles understanding of optogenetic depolarization [@problem_id:2589124].", "problem": "A mammalian neuron at physiological temperature expresses a light-gated, nonselective cation channel used in optogenetics. Upon illumination, the channel increases the effective membrane permeabilities of sodium and potassium without affecting chloride. Assume steady state and that the membrane satisfies the constant-field approximation underlying the Goldman–Hodgkin–Katz (GHK) framework. Intracellular and extracellular ion activities can be approximated by their concentrations.\n\nBaseline conditions (dark):\n- Temperature: $T = 310\\,\\mathrm{K}$.\n- Extracellular concentrations: $[\\mathrm{Na}^{+}]_{o} = 145\\,\\mathrm{mM}$, $[\\mathrm{K}^{+}]_{o} = 5\\,\\mathrm{mM}$, $[\\mathrm{Cl}^{-}]_{o} = 110\\,\\mathrm{mM}$.\n- Intracellular concentrations: $[\\mathrm{Na}^{+}]_{i} = 12\\,\\mathrm{mM}$, $[\\mathrm{K}^{+}]_{i} = 140\\,\\mathrm{mM}$, $[\\mathrm{Cl}^{-}]_{i} = 4\\,\\mathrm{mM}$.\n- Relative permeabilities: $P_{\\mathrm{K}} : P_{\\mathrm{Na}} : P_{\\mathrm{Cl}} = 1.00 : 0.040 : 0.45$.\n\nIlluminated conditions (light):\n- The light-activated conductance scales $P_{\\mathrm{Na}}$ by a factor $f_{\\mathrm{Na}} = 5.0$ and scales $P_{\\mathrm{K}}$ by a factor $f_{\\mathrm{K}} = 1.5$. Permeability to chloride is unchanged.\n\nUsing first principles that lead to the Goldman–Hodgkin–Katz (GHK) voltage equation under steady-state zero net current and the constant-field approximation, compute the resting membrane potential in the dark and in the light, then determine the shift $\\Delta V_{m} = V_{m,\\mathrm{light}} - V_{m,\\mathrm{dark}}$ caused by illumination. Use the universal gas constant $R$, Faraday’s constant $F$, and the given $T$ symbolically until the final numerical evaluation.\n\nExpress your final answer as a single number in $\\mathrm{mV}$, where a positive value indicates a depolarizing shift. Round your answer to three significant figures.", "solution": "The problem requires the calculation of the resting membrane potential of a neuron under two conditions—dark and illuminated—and the resulting shift in potential. The analysis is governed by the principles of membrane biophysics, specifically under the constant-field assumption, which leads to the Goldman–Hodgkin–Katz (GHK) voltage equation.\n\nFirst, the given parameters must be validated. The problem provides a self-contained, scientifically grounded set of conditions. Ion concentrations are within physiological ranges for a mammalian neuron, and the concept of optogenetic modulation of channel permeability is a standard technique in neuroscience. The problem is well-posed and objective, with all necessary data provided. Therefore, the problem is valid, and we may proceed with the solution.\n\nThe GHK voltage equation provides the steady-state membrane potential $V_m$ when the net transmembrane current is zero. For the ionic species involved ($\\mathrm{Na}^+$, $\\mathrm{K}^+$, and $\\mathrm{Cl}^-$), the equation is:\n$$V_m = \\frac{RT}{F} \\ln \\left( \\frac{P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{o} + P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{o} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_{i}}{P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{i} + P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{i} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_{o}} \\right)$$\nHere, $R$ is the universal gas constant, $T$ is the absolute temperature, and $F$ is Faraday's constant. $P_X$ and $[X]$ denote the membrane permeability and concentration of ion $X$, respectively, with subscripts $o$ for extracellular and $i$ for intracellular.\n\nWe will first calculate the resting potential in the dark, $V_{m,\\mathrm{dark}}$, and then in the light, $V_{m,\\mathrm{light}}$.\n\n**Step 1: Calculation of Membrane Potential in the Dark ($V_{m,\\mathrm{dark}}$)**\n\nThe provided baseline relative permeabilities are $P_{\\mathrm{K}} : P_{\\mathrm{Na}} : P_{\\mathrm{Cl}} = 1.00 : 0.040 : 0.45$. We can work with these relative values, as any common scaling factor would cancel in the fraction inside the logarithm. Let's denote the permeabilities in the dark state with a 'dark' subscript. We set $P_{\\mathrm{K,dark}} = 1.00$, $P_{\\mathrm{Na,dark}} = 0.040$, and $P_{\\mathrm{Cl,dark}} = 0.45$.\n\nThe ion concentrations are given as:\n- $[\\mathrm{Na}^{+}]_{o} = 145\\,\\mathrm{mM}$\n- $[\\mathrm{K}^{+}]_{o} = 5\\,\\mathrm{mM}$\n- $[\\mathrm{Cl}^{-}]_{o} = 110\\,\\mathrm{mM}$\n- $[\\mathrm{Na}^{+}]_{i} = 12\\,\\mathrm{mM}$\n- $[\\mathrm{K}^{+}]_{i} = 140\\,\\mathrm{mM}$\n- $[\\mathrm{Cl}^{-}]_{i} = 4\\,\\mathrm{mM}$\n\nLet's compute the numerator, $N_{\\mathrm{dark}}$, and denominator, $D_{\\mathrm{dark}}$, of the argument of the logarithm for the dark state.\n$$N_{\\mathrm{dark}} = P_{\\mathrm{Na,dark}}[\\mathrm{Na}^{+}]_{o} + P_{\\mathrm{K,dark}}[\\mathrm{K}^{+}]_{o} + P_{\\mathrm{Cl,dark}}[\\mathrm{Cl}^{-}]_{i}$$\n$$N_{\\mathrm{dark}} = (0.040)(145) + (1.00)(5) + (0.45)(4) = 5.8 + 5.0 + 1.8 = 12.6$$\n$$D_{\\mathrm{dark}} = P_{\\mathrm{Na,dark}}[\\mathrm{Na}^{+}]_{i} + P_{\\mathrm{K,dark}}[\\mathrm{K}^{+}]_{i} + P_{\\mathrm{Cl,dark}}[\\mathrm{Cl}^{-}]_{o}$$\n$$D_{\\mathrm{dark}} = (0.040)(12) + (1.00)(140) + (0.45)(110) = 0.48 + 140.0 + 49.5 = 189.98$$\n\nThe resting membrane potential in the dark is thus:\n$$V_{m,\\mathrm{dark}} = \\frac{RT}{F} \\ln \\left( \\frac{12.6}{189.98} \\right)$$\n\n**Step 2: Calculation of Membrane Potential in the Light ($V_{m,\\mathrm{light}}$)**\n\nUpon illumination, the permeabilities for sodium and potassium are scaled by factors $f_{\\mathrm{Na}} = 5.0$ and $f_{\\mathrm{K}} = 1.5$, respectively. The chloride permeability is unchanged.\nThe new permeabilities, denoted with a 'light' subscript, are:\n$$P_{\\mathrm{Na,light}} = f_{\\mathrm{Na}} \\times P_{\\mathrm{Na,dark}} = 5.0 \\times 0.040 = 0.20$$\n$$P_{\\mathrm{K,light}} = f_{\\mathrm{K}} \\times P_{\\mathrm{K,dark}} = 1.5 \\times 1.00 = 1.5$$\n$$P_{\\mathrm{Cl,light}} = P_{\\mathrm{Cl,dark}} = 0.45$$\n\nUsing these new permeability values, we compute the numerator, $N_{\\mathrm{light}}$, and denominator, $D_{\\mathrm{light}}$, for the illuminated state.\n$$N_{\\mathrm{light}} = P_{\\mathrm{Na,light}}[\\mathrm{Na}^{+}]_{o} + P_{\\mathrm{K,light}}[\\mathrm{K}^{+}]_{o} + P_{\\mathrm{Cl,light}}[\\mathrm{Cl}^{-}]_{i}$$\n$$N_{\\mathrm{light}} = (0.20)(145) + (1.5)(5) + (0.45)(4) = 29.0 + 7.5 + 1.8 = 38.3$$\n$$D_{\\mathrm{light}} = P_{\\mathrm{Na,light}}[\\mathrm{Na}^{+}]_{i} + P_{\\mathrm{K,light}}[\\mathrm{K}^{+}]_{i} + P_{\\mathrm{Cl,light}}[\\mathrm{Cl}^{-}]_{o}$$\n$$D_{\\mathrm{light}} = (0.20)(12) + (1.5)(140) + (0.45)(110) = 2.4 + 210.0 + 49.5 = 261.9$$\n\nThe membrane potential in the light is:\n$$V_{m,\\mathrm{light}} = \\frac{RT}{F} \\ln \\left( \\frac{38.3}{261.9} \\right)$$\n\n**Step 3: Calculation of the Potential Shift ($\\Delta V_m$)**\n\nThe shift in membrane potential is the difference between the potential in the light and in the dark:\n$$\\Delta V_{m} = V_{m,\\mathrm{light}} - V_{m,\\mathrm{dark}}$$\n$$\\Delta V_{m} = \\frac{RT}{F} \\ln \\left( \\frac{38.3}{261.9} \\right) - \\frac{RT}{F} \\ln \\left( \\frac{12.6}{189.98} \\right)$$\nUsing the logarithmic identity $\\ln(a) - \\ln(b) = \\ln(a/b)$, we get:\n$$\\Delta V_{m} = \\frac{RT}{F} \\ln \\left( \\frac{38.3 / 261.9}{12.6 / 189.98} \\right) = \\frac{RT}{F} \\ln \\left( \\frac{38.3 \\times 189.98}{261.9 \\times 12.6} \\right)$$\n\n**Step 4: Numerical Evaluation**\n\nWe now substitute the numerical values for the constants and temperature to find the final answer. The temperature is given as $T = 310\\,\\mathrm{K}$. The physical constants are $R \\approx 8.3145 \\, \\mathrm{J} \\cdot \\mathrm{mol}^{-1} \\cdot \\mathrm{K}^{-1}$ and $F \\approx 96485.3 \\, \\mathrm{C} \\cdot \\mathrm{mol}^{-1}$. The pre-factor $\\frac{RT}{F}$ is the thermal voltage.\n$$\\frac{RT}{F} \\approx \\frac{(8.3145\\,\\mathrm{J} \\cdot \\mathrm{mol}^{-1} \\cdot \\mathrm{K}^{-1})(310\\,\\mathrm{K})}{96485.3\\,\\mathrm{C} \\cdot \\mathrm{mol}^{-1}} \\approx 0.02671\\,\\mathrm{V} = 26.71\\,\\mathrm{mV}$$\nNow, we evaluate the argument of the logarithm:\n$$\\frac{38.3 \\times 189.98}{261.9 \\times 12.6} = \\frac{7276.234}{3300.94} \\approx 2.20429$$\nFinally, we compute $\\Delta V_m$:\n$$\\Delta V_{m} \\approx (26.71\\,\\mathrm{mV}) \\times \\ln(2.20429) \\approx (26.71\\,\\mathrm{mV}) \\times 0.79040 \\approx 21.115\\,\\mathrm{mV}$$\nRounding the result to three significant figures, we obtain $21.1\\,\\mathrm{mV}$. The positive sign indicates that the membrane depolarizes upon illumination, as expected from the substantial relative increase in sodium permeability.", "answer": "$$\\boxed{21.1}$$", "id": "2589124"}, {"introduction": "Effective experimental design requires choosing the right tool for the job, and this is especially true when selecting an optogenetic inhibitor. The choice between an ion pump and an ion channel for neuronal silencing involves subtle but critical biophysical considerations beyond simple hyperpolarization, including interactions with endogenous ion gradients and the long-term stability of the inhibitory effect. This problem asks you to analyze and compare a light-driven chloride pump and a proton pump, forcing you to weigh their predicted hyperpolarization against their potential for creating confounding secondary effects, a key skill for designing robust experiments [@problem_id:2589067].", "problem": "A neuroscientist must choose an optogenetic pump to inhibit a cortical pyramidal neuron under current-clamp. Two light-driven electrogenic pumps are available: a light-driven chloride pump (actively transports chloride ions into the cytosol upon illumination) and a light-driven proton pump (actively transports protons out of the cytosol upon illumination). At baseline, the neuron has resting membrane potential $V_m = -65\\,\\mathrm{mV}$ and chloride equilibrium potential $E_{\\text{Cl}} = -70\\,\\mathrm{mV}$. The extracellular and intracellular acidities are $\\text{pH}_o = 7.4$ and $\\text{pH}_i = 7.2$, respectively, at temperature $T = 37^\\circ \\text{C}$. The neuron’s input resistance is $R_{\\text{in}} = 150\\ \\text{M}\\Omega$. Under the same irradiance, both pumps deliver the same steady outward positive membrane current magnitude $I_{\\text{pump}} = 100\\ \\text{pA}$ (chloride pump current corresponds to inward movement of negative charge; proton pump current corresponds to outward movement of positive charge).\n\nUsing only fundamental definitions, decide which pump will produce more robust and predictable hyperpolarization during a $200\\ \\text{ms}$ light pulse. Your justification must include:\n- Calculation of the initial electrochemical driving forces (at $V_m$) for passive fluxes of chloride and protons using equilibrium potentials.\n- Calculation of the expected steady-state hyperpolarization amplitude during illumination from the imposed pump current and the membrane input resistance.\n- A brief mechanistic argument about how the relationship between $V_m$ and each ion’s equilibrium potential will impact the sustainability and predictability of the hyperpolarization over the pulse duration.\n\nChoose the single best option.\n\nA. Choose the chloride pump. Because $V_m - E_{\\text{Cl}} = +5\\ \\text{mV}$ at rest, chloride influx is favored and will strongly hyperpolarize the cell. The steady hyperpolarization is limited to about $5\\ \\text{mV}$ by the small driving force, which is optimal and prevents over-inhibition.\n\nB. Choose the proton pump. The proton equilibrium potential at these $\\text{pH}$ values yields a large magnitude driving force at rest, but the pump does not require it to operate. With $I_{\\text{pump}} = 100\\ \\text{pA}$ and $R_{\\text{in}} = 150\\ \\text{M}\\Omega$, the expected hyperpolarization is about $15\\ \\text{mV}$. In contrast, a chloride pump will face counteracting passive chloride efflux once $V_m$ moves below $E_{\\text{Cl}}$ and will accumulate intracellular chloride over the pulse, undermining sustained inhibition.\n\nC. Both pumps are equivalent. Because $I_{\\text{pump}} = 100\\ \\text{pA}$ and $R_{\\text{in}} = 150\\ \\text{M}\\Omega$, both give exactly the same sustained hyperpolarization of $15\\ \\text{mV}$; the initial electrochemical driving forces are irrelevant, and long-term ionic consequences are negligible on the timescale of the pulse.\n\nD. Choose the chloride pump. Because $E_{\\text{Cl}}$ is more negative than $V_m$, the membrane will be driven precisely to $E_{\\text{Cl}}$ (about a $5\\ \\text{mV}$ hyperpolarization). A proton pump would depolarize the neuron because the proton equilibrium potential is less negative than $V_m$.", "solution": "The problem asks for an evaluation of two optogenetic inhibitory pumps, a chloride pump and a proton pump, to determine which provides more robust and predictable hyperpolarization of a neuron. The validity of the problem statement must be established first.\n\n### Step 1: Extract Givens\n- **Neuron type**: Cortical pyramidal neuron\n- **Experimental condition**: Current-clamp\n- **Tool 1**: Light-driven chloride pump (transports $\\text{Cl}^-$ into the cytosol).\n- **Tool 2**: Light-driven proton pump (transports $\\text{H}^+$ out of the cytosol).\n- **Resting membrane potential**: $V_m = -65\\,\\mathrm{mV}$\n- **Chloride equilibrium potential**: $E_{\\text{Cl}} = -70\\,\\mathrm{mV}$\n- **Extracellular pH**: $\\text{pH}_o = 7.4$\n- **Intracellular pH**: $\\text{pH}_i = 7.2$\n- **Temperature**: $T = 37^\\circ \\text{C}$\n- **Input resistance**: $R_{\\text{in}} = 150\\ \\text{M}\\Omega$\n- **Pump current**: $I_{\\text{pump}} = 100\\ \\text{pA}$ (outward positive current for both pumps).\n- **Pulse duration**: $200\\ \\text{ms}$\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is well-grounded in fundamental principles of cellular neurophysiology and biophysics, including membrane potential, Nernst potentials, Ohm's law for membranes, and the action of ion pumps. The tools described, optogenetic chloride and proton pumps (e.g., Halorhodopsin and Archaerhodopsin, respectively), are standard in modern neuroscience. All provided parameters ($V_m$, $E_{\\text{Cl}}$, pH, $R_{\\text{in}}$, $I_{\\text{pump}}$) are physiologically realistic.\n- **Well-Posedness**: The problem provides all necessary information to perform the required calculations and draw a conclusion. The question is specific and an answer can be derived logically from the given data.\n- **Objectivity**: The language is precise and quantitative, free of subjective or ambiguous terminology.\n\n### Step 3: Verdict and Action\nThe problem statement is scientifically sound, self-contained, and well-posed. It is therefore **valid**. I will proceed with the solution.\n\nThe solution requires three components as per the prompt.\n\n**1. Calculation of Initial Electrochemical Driving Forces**\n\nThe electrochemical driving force for an ion is given by the difference between the membrane potential ($V_m$) and the ion's equilibrium potential ($E_{\\text{ion}}$), i.e., $V_m - E_{\\text{ion}}$.\n\n- **Chloride ($\\text{Cl}^-$)**:\nThe chloride equilibrium potential is given as $E_{\\text{Cl}} = -70\\,\\mathrm{mV}$.\nThe driving force for passive $\\text{Cl}^-$ flux at rest is:\n$$V_m - E_{\\text{Cl}} = (-65\\,\\mathrm{mV}) - (-70\\,\\mathrm{mV}) = +5\\,\\mathrm{mV}$$\nA positive driving force on a negative ion ($\\text{Cl}^-$) results in a passive influx of the ion, which is a hyperpolarizing current.\n\n- **Protons ($\\text{H}^+$)**:\nThe proton equilibrium potential, $E_{\\text{H}}$, must be calculated using the Nernst equation:\n$$E_{\\text{H}} = \\frac{RT}{zF} \\ln\\left(\\frac{[\\text{H}^+]_o}{[\\text{H}^+]_i}\\right)$$\nHere, the charge of a proton is $z=+1$. The gas constant is $R \\approx 8.314\\ \\text{J}\\cdot\\text{mol}^{-1}\\cdot\\text{K}^{-1}$, Faraday's constant is $F \\approx 96485\\ \\text{C}\\cdot\\text{mol}^{-1}$, and the temperature is $T = 37 + 273.15 = 310.15\\ \\text{K}$. The term $\\frac{RT}{F}$ is approximately $26.7\\,\\mathrm{mV}$.\nConcentrations are derived from pH: $[\\text{H}^+] = 10^{-\\text{pH}}$.\n$[\\text{H}^+]_o = 10^{-7.4}\\ \\text{M}$ and $[\\text{H}^+]_i = 10^{-7.2}\\ \\text{M}$.\nThe ratio is $\\frac{[\\text{H}^+]_o}{[\\text{H}^+]_i} = \\frac{10^{-7.4}}{10^{-7.2}} = 10^{-0.2}$.\nUsing the base-10 logarithm form, $E_{\\text{ion}} = \\frac{2.303 RT}{zF} \\log_{10}\\left(\\frac{[\\text{ion}]_o}{[\\text{ion}]_i}\\right)$, where $\\frac{2.303 RT}{F} \\approx 61.5\\,\\mathrm{mV}$ at $37^\\circ \\text{C}$:\n$$E_{\\text{H}} = (61.5\\,\\mathrm{mV}) \\log_{10}(10^{-0.2}) = (61.5\\,\\mathrm{mV})(-0.2) = -12.3\\,\\mathrm{mV}$$\nThe driving force for passive $\\text{H}^+$ flux at rest is:\n$$V_m - E_{\\text{H}} = (-65\\,\\mathrm{mV}) - (-12.3\\,\\mathrm{mV}) = -52.7\\,\\mathrm{mV}$$\nA negative driving force on a positive ion ($\\text{H}^+$) results in a passive influx of the ion, which is a depolarizing current.\n\n**2. Calculation of Expected Steady-State Hyperpolarization**\n\nBoth pumps are described as current sources delivering a steady outward positive current of $I_{\\text{pump}} = 100\\ \\text{pA}$. An outward current hyperpolarizes the neuron. Based on Ohm's law applied to the whole cell, the change in membrane potential ($\\Delta V_m$) is the product of the injected current and the input resistance ($R_{\\text{in}}$).\n$$ \\Delta V_m = I_{\\text{pump}} \\times R_{\\text{in}} $$\nGiven $I_{\\text{pump}} = 100\\ \\text{pA} = 100 \\times 10^{-12}\\ \\text{A}$ and $R_{\\text{in}} = 150\\ \\text{M}\\Omega = 150 \\times 10^6\\ \\Omega$:\n$$ \\Delta V_m = (100 \\times 10^{-12}\\ \\text{A}) \\times (150 \\times 10^6\\ \\Omega) = 15000 \\times 10^{-6}\\ \\text{V} = 15\\ \\text{mV} $$\nThis is a hyperpolarization, so the new steady-state membrane potential, $V_{\\text{ss}}$, is expected to be:\n$$ V_{\\text{ss}} = V_m - \\Delta V_m = -65\\,\\mathrm{mV} - 15\\,\\mathrm{mV} = -80\\,\\mathrm{mV} $$\nThis calculation assumes the pump acts as an ideal current source and that $R_{\\text{in}}$ remains unchanged.\n\n**3. Mechanistic Argument for Robustness and Predictability**\n\nThe key to this problem lies in understanding how the passive flux of the pumped ion interacts with the active transport. This determines the robustness (sustainability) and predictability of the inhibition.\n\n- **Chloride Pump**: The pump actively moves $\\text{Cl}^-$ ions into the cell. The predicted hyperpolarization would take the membrane potential to $V_{\\text{ss}} = -80\\,\\mathrm{mV}$. The chloride equilibrium potential is $E_{\\text{Cl}} = -70\\,\\mathrm{mV}$. Once the membrane potential becomes more negative than $E_{\\text{Cl}}$, the driving force for passive $\\text{Cl}^-$ flux, $V_m - E_{\\text{Cl}}$, becomes negative. For the negatively charged $\\text{Cl}^-$, this negative driving force will cause a passive **efflux** (outward movement of $\\text{Cl}^-$). This passive efflux constitutes an inward current, which is depolarizing and directly counteracts the hyperpolarizing effect of the pump. The presence of this shunting current means the actual hyperpolarization will be smaller than the predicted $15\\,\\mathrm{mV}$. Furthermore, the active influx of $\\text{Cl}^-$ increases its intracellular concentration, $[\\text{Cl}^-]_i$. According to the Nernst equation for $\\text{Cl}^-$ ($z=-1$), an increase in $[\\text{Cl}^-]_i$ makes $E_{\\text{Cl}}$ less negative (depolarizes it). This phenomenon, known as rundown of the inhibitory potential, reduces the effectiveness of the pump over the duration of the stimulus and makes the level of inhibition unstable and unpredictable.\n\n- **Proton Pump**: The pump actively moves $\\text{H}^+$ ions out of the cell. This is an outward current that hyperpolarizes the membrane towards the same target of $V_{\\text{ss}} = -80\\,\\mathrm{mV}$. The proton equilibrium potential is $E_{\\text{H}} = -12.3\\,\\mathrm{mV}$. The driving force for passive $\\text{H}^+$ flux, $V_m - E_{\\text{H}}$, is already negative at rest ($-52.7\\,\\mathrm{mV}$) and becomes even more negative ($-67.7\\,\\mathrm{mV}$) at the hyperpolarized potential. This large negative driving force favors a passive influx of $\\text{H}^+$, a depolarizing current that, like in the chloride case, opposes the pump. However, two crucial factors distinguish the proton pump:\n    1.  The resting membrane has extremely low permeability to protons ($g_{\\text{H}} \\approx 0$). Therefore, the counteracting passive current, $I_{\\text{passive,H}} = g_{\\text{H}}(V_m - E_{\\text{H}})$, is negligible, even with a large driving force.\n    2.  Intracellular and extracellular spaces are heavily buffered against pH changes. The removal of protons by the pump is rapidly compensated by protons released from intracellular buffers. Consequently, the intracellular proton concentration $[\\text{H}^+]_i$ and thus $E_{\\text{H}}$ remain essentially constant during a short $200\\ \\text{ms}$ pulse.\nBecause of these two factors, the proton pump acts as a nearly ideal current source. Its effect is not significantly counteracted by passive fluxes or by changes in its own reversal potential. The resulting hyperpolarization will be very close to the predicted $15\\,\\mathrm{mV}$ and will be stable throughout the light pulse.\n\n**Conclusion**: The proton pump will produce more robust and predictable hyperpolarization.\n\n### Option-by-Option Analysis\n\n- **A. Choose the chloride pump. Because $V_m - E_{\\text{Cl}} = +5\\ \\text{mV}$ at rest, chloride influx is favored and will strongly hyperpolarize the cell. The steady hyperpolarization is limited to about $5\\ \\text{mV}$ by the small driving force, which is optimal and prevents over-inhibition.**\n  - This statement incorrectly applies the logic of a channel (a conductance) to a pump (a current source). A pump's current is not primarily determined by the electrochemical driving force. If it were a channel, it would clamp the voltage near $E_{\\text{Cl}}$, causing a $\\approx 5\\,\\mathrm{mV}$ hyperpolarization. But a $100\\ \\text{pA}$ pump current causes a much larger hyperpolarization, as calculated.\n  - **Verdict: Incorrect.**\n\n- **B. Choose the proton pump. The proton equilibrium potential at these pH values yields a large magnitude driving force at rest, but the pump does not require it to operate. With $I_{\\text{pump}} = 100\\ \\text{pA}$ and $R_{\\text{in}} = 150\\ \\text{M}\\Omega$, the expected hyperpolarization is about $15\\ \\text{mV}$. In contrast, a chloride pump will face counteracting passive chloride efflux once $V_m$ moves below $E_{\\text{Cl}}$ and will accumulate intracellular chloride over the pulse, undermining sustained inhibition.**\n  - This option correctly identifies the proton pump as the better choice. It correctly states that pumps are active transporters. It correctly calculates the expected hyperpolarization based on Ohm's law. Most importantly, it correctly identifies the two major flaws of the chloride pump in this context: the creation of a counteracting passive flux by driving $V_m$ past $E_{\\text{Cl}}$, and the rundown of inhibition due to ion accumulation. This aligns perfectly with our derivation.\n  - **Verdict: Correct.**\n\n- **C. Both pumps are equivalent. Because $I_{\\text{pump}} = 100\\ \\text{pA}$ and $R_{\\text{in}} = 150\\ \\text{M}\\Omega$, both give exactly the same sustained hyperpolarization of $15\\ \\text{mV}$; the initial electrochemical driving forces are irrelevant, and long-term ionic consequences are negligible on the timescale of the pulse.**\n  - This statement is an oversimplification. It ignores the crucial secondary effects related to the specific ion being transported. As analyzed, the equivalence does not hold because the chloride pump's action is actively opposed by passive fluxes and ionic accumulation, while the proton pump's is not, to any significant degree. The assertion that ionic consequences are negligible is incorrect for chloride on this timescale.\n  - **Verdict: Incorrect.**\n\n- **D. Choose the chloride pump. Because $E_{\\text{Cl}}$ is more negative than $V_m$, the membrane will be driven precisely to $E_{\\text{Cl}}$ (about a $5\\ \\text{mV}$ hyperpolarization). A proton pump would depolarize the neuron because the proton equilibrium potential is less negative than $V_m$.**\n  - This option contains two fundamental errors. First, as in option A, it confuses a pump with a channel; a pump does not clamp the voltage at the ion's equilibrium potential. Second, it incorrectly claims a proton pump would depolarize the neuron. The pump actively moves positive charge *out*, which is by definition a hyperpolarizing outward current, regardless of the value of $E_{\\text{H}}$.\n  - **Verdict: Incorrect.**", "answer": "$$\\boxed{B}$$", "id": "2589067"}, {"introduction": "Beyond controlling a single neuron, optogenetics is often used for long-term manipulation of neural circuits, where the stimulation protocol itself becomes a critical design parameter. A key challenge is to deliver enough light to achieve the desired level of neural modulation without causing tissue damage from excessive heating. This computational practice guides you through a realistic optimization problem: finding a stimulation frequency and duty cycle that maximizes opsin activation while keeping the temperature increase within a safe limit, reflecting the trade-offs inherent in designing effective and safe *in vivo* experiments [@problem_id:2589134].", "problem": "A laboratory uses optogenetic stimulation to drive ionic photocurrent in neurons expressing a light-gated ion channel (opsin). The light is delivered as a periodic square wave with frequency $f$ (in $\\mathrm{Hz}$) and duty cycle $D$ (dimensionless decimal fraction of the period that is light-on). The irradiance during the light-on phase is a fixed amplitude $P$ (in $\\mathrm{W/mm^2}$), and it is $0$ during the light-off phase. The opsin photocurrent fraction is modeled by a two-state gating variable $O(t)$ that relaxes exponentially toward $1$ with time constant $\\tau_{\\mathrm{on}}$ (in $\\mathrm{s}$) during illumination and toward $0$ with time constant $\\tau_{\\mathrm{off}}$ (in $\\mathrm{s}$) in the dark. The tissue heating is modeled as a lumped first-order linear system for the temperature rise $\\Delta T(t)$ (in ${}^\\circ\\mathrm{C}$) above baseline with thermal time constant $\\tau_{\\mathrm{th}}$ (in $\\mathrm{s}$) driven by absorbed optical power density; the heating drive is proportional to irradiance with proportionality constant $\\beta$ (in ${}^\\circ\\mathrm{C}\\, \\mathrm{s}^{-1} \\, (\\mathrm{W/mm^2})^{-1}$). Assume the light amplitude $P$ is high enough that the opsin illumination dynamics are governed by the given $\\tau_{\\mathrm{on}}$ and $\\tau_{\\mathrm{off}}$ for this $P$.\n\nFundamental base:\n- Photocurrent gating dynamics follow first-order linear differential equations: during light-on $dO/dt = (1 - O)/\\tau_{\\mathrm{on}}$ and during light-off $dO/dt = -O/\\tau_{\\mathrm{off}}$, with $O(t)$ constrained to $[0,1]$.\n- Lumped thermal dynamics follow the linear differential equation $d\\Delta T/dt = -\\Delta T/\\tau_{\\mathrm{th}} + \\beta\\, u(t)$, where $u(t)$ equals $P$ during light-on and $0$ during light-off.\n\nYour task is to write a program that, for each test case below, searches a predefined grid of candidate pulsing strategies and returns a strategy that simultaneously:\n- keeps the steady-periodic peak temperature rise strictly below $1\\,{}^\\circ\\mathrm{C}$, and\n- achieves at least $0.7$ of the maximal photocurrent on average over one full cycle (i.e., the time-average of $O(t)$ over the cycle is greater than or equal to $0.7$).\n\nRequirements:\n1. For a given pair $(f, D)$, treat the stimulation as a periodic square wave with period $T_{\\mathrm{cyc}} = 1/f$, light-on duration $T_{\\mathrm{on}} = D/f$, and light-off duration $T_{\\mathrm{off}} = (1 - D)/f$.\n2. Determine the unique steady-periodic solution for $O(t)$ across cycles implied by the piecewise linear dynamics. From this periodic solution, compute the exact time-average of $O(t)$ over one period. Interpret this average as the average photocurrent fraction relative to the saturated maximal current.\n3. Determine the unique steady-periodic solution for $\\Delta T(t)$ across cycles implied by the piecewise linear thermal dynamics. From this periodic solution, compute the peak temperature rise within the cycle (the maximum of $\\Delta T(t)$ over one period).\n4. Feasibility criteria: average photocurrent fraction greater than or equal to $0.7$ and peak temperature rise strictly less than $1\\,{}^\\circ\\mathrm{C}$.\n5. Candidate grid: frequencies $f \\in \\{5, 10, 20, 40, 80\\}$ (in $\\mathrm{Hz}$) and duty cycles $D \\in \\{0.05, 0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.45, 0.50\\}$ (dimensionless decimal fractions).\n6. Selection rule if feasible strategies exist: choose the strategy with the smallest $D$; if multiple share that $D$, choose the one with the smallest $f$. If no feasible strategy exists, report infeasibility.\n7. Output, for each test case, a list with four entries: $[D, f, \\Delta T_{\\mathrm{peak}}, \\overline{O}]$, where $D$ is dimensionless, $f$ is in $\\mathrm{Hz}$, $\\Delta T_{\\mathrm{peak}}$ is in ${}^\\circ\\mathrm{C}$, and $\\overline{O}$ is dimensionless. Express $D$ to three decimal places, $f$ to one decimal place, $\\Delta T_{\\mathrm{peak}}$ to four decimal places, and $\\overline{O}$ to four decimal places. If infeasible, output $[-1.0,-1.0,-1.0,-1.0]$.\n8. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the four-entry list for one test case in the same order as below.\n\nTest suite (all times in $\\mathrm{s}$, irradiance in $\\mathrm{W/mm^2}$):\n- Case A (happy path): $\\tau_{\\mathrm{on}} = 0.005$, $\\tau_{\\mathrm{off}} = 0.015$, $P = 0.010$, $\\tau_{\\mathrm{th}} = 1.0$, $\\beta = 50.0$.\n- Case B (slower off-kinetics, moderate heating): $\\tau_{\\mathrm{on}} = 0.010$, $\\tau_{\\mathrm{off}} = 0.100$, $P = 0.015$, $\\tau_{\\mathrm{th}} = 0.8$, $\\beta = 40.0$.\n- Case C (fast opsin, higher irradiance): $\\tau_{\\mathrm{on}} = 0.003$, $\\tau_{\\mathrm{off}} = 0.008$, $P = 0.030$, $\\tau_{\\mathrm{th}} = 1.2$, $\\beta = 40.0$.\n- Case D (very slow activation, stringent thermal limit): $\\tau_{\\mathrm{on}} = 0.030$, $\\tau_{\\mathrm{off}} = 0.200$, $P = 0.080$, $\\tau_{\\mathrm{th}} = 1.5$, $\\beta = 40.0$.\n\nAngle units are not used. Ensure all numeric answers obey their specified units and rounding.", "solution": "The problem presented is a well-posed, scientifically grounded exercise in analyzing the steady-periodic response of two coupled first-order linear systems driven by a common square-wave input. The models for optogenetic channel gating and lumped-parameter tissue heating are standard representations in biophysics and bioengineering. All parameters, constraints, and objectives are clearly defined, permitting a rigorous and unique solution. The problem is therefore valid.\n\nThe task is to find an optimal stimulation strategy, defined by a frequency $f$ and duty cycle $D$, from a specified grid of candidates. The optimal strategy must satisfy two criteria simultaneously: the peak steady-periodic temperature rise $\\Delta T_{\\mathrm{peak}}$ must be strictly less than $1\\,{}^\\circ\\mathrm{C}$, and the time-averaged opsin activation $\\overline{O}$ must be at least $0.7$. The selection rule requires choosing the feasible strategy with the smallest $D$, and among those, the one with the smallest $f$.\n\nTo solve this, we must first derive analytical expressions for $\\Delta T_{\\mathrm{peak}}$ and $\\overline{O}$ as functions of the stimulation parameters $(f, D)$ and the system's physical parameters.\n\nLet the period of the stimulation be $T_{\\mathrm{cyc}} = 1/f$. The duration of the light-on phase is $T_{\\mathrm{on}} = D \\cdot T_{\\mathrm{cyc}} = D/f$, and the light-off phase is $T_{\\mathrm{off}} = (1-D) \\cdot T_{\\mathrm{cyc}} = (1-D)/f$.\n\n**1. Opsin Photocurrent Gating, $O(t)$**\n\nThe gating variable $O(t)$ is governed by two linear ordinary differential equations (ODEs):\n- Light-on ($0 \\le t < T_{\\mathrm{on}}$): $\\frac{dO}{dt} = \\frac{1-O}{\\tau_{\\mathrm{on}}}$\n- Light-off ($0 \\le t' < T_{\\mathrm{off}}$, where $t' = t - T_{\\mathrm{on}}$): $\\frac{dO}{dt'} = -\\frac{O}{\\tau_{\\mathrm{off}}}$\n\nIn the steady-periodic state, $O(t)$ oscillates between a minimum value $O_{\\mathrm{min}}$ at the start of the light-on phase and a maximum value $O_{\\mathrm{max}}$ at the end. Solving the ODEs and applying the periodicity condition, $O(T_{\\mathrm{cyc}}) = O(0) = O_{\\mathrm{min}}$, yields expressions for these bounds:\n$$O_{\\mathrm{max}} = 1 - (1 - O_{\\mathrm{min}}) e^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{on}}}$$\n$$O_{\\mathrm{min}} = O_{\\mathrm{max}} e^{-T_{\\mathrm{off}}/\\tau_{\\mathrm{off}}}$$\nSolving this system for $O_{\\mathrm{min}}$ and $O_{\\mathrm{max}}$ gives:\n$$O_{\\mathrm{max}} = \\frac{1 - e^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{on}}}}{1 - e^{-(T_{\\mathrm{on}}/\\tau_{\\mathrm{on}} + T_{\\mathrm{off}}/\\tau_{\\mathrm{off}})}}$$\n$$O_{\\mathrm{min}} = O_{\\mathrm{max}} e^{-T_{\\mathrm{off}}/\\tau_{\\mathrm{off}}}$$\n\nThe time-average of $O(t)$ over one cycle, $\\overline{O}$, is calculated by integrating the solutions to the ODEs over their respective intervals:\n$$\\overline{O} = \\frac{1}{T_{\\mathrm{cyc}}} \\left( \\int_0^{T_{\\mathrm{on}}} O(t) dt + \\int_{T_{\\mathrm{on}}}^{T_{\\mathrm{cyc}}} O(t) dt \\right)$$\nA straightforward method using the ODEs directly is to note that $\\int O dt = \\int (1 - \\tau_{\\mathrm{on}} \\frac{dO}{dt}) dt = t - \\tau_{\\mathrm{on}}O$ during the 'on' phase and $\\int O dt = \\int (-\\tau_{\\mathrm{off}} \\frac{dO}{dt}) dt = -\\tau_{\\mathrm{off}}O$ during the 'off' phase. This yields:\n$$T_{\\mathrm{cyc}}\\overline{O} = \\left[t - \\tau_{\\mathrm{on}}O(t)\\right]_0^{T_{\\mathrm{on}}} + \\left[-\\tau_{\\mathrm{off}}O(t)\\right]_{T_{\\mathrm{on}}}^{T_{\\mathrm{cyc}}} = (T_{\\mathrm{on}} - \\tau_{\\mathrm{on}}(O_{\\mathrm{max}}-O_{\\mathrm{min}})) + (-\\tau_{\\mathrm{off}}(O_{\\mathrm{min}}-O_{\\mathrm{max}}))$$\n$$\\overline{O} = \\frac{T_{\\mathrm{on}} + (\\tau_{\\mathrm{off}} - \\tau_{\\mathrm{on}})(O_{\\mathrm{max}} - O_{\\mathrm{min}})}{T_{\\mathrm{cyc}}} = D + f(\\tau_{\\mathrm{off}} - \\tau_{\\mathrm{on}})(O_{\\mathrm{max}} - O_{\\mathrm{min}})$$\n\n**2. Tissue Heating, $\\Delta T(t)$**\n\nThe temperature rise $\\Delta T(t)$ is governed by the ODE:\n$$\\frac{d\\Delta T}{dt} = -\\frac{\\Delta T}{\\tau_{\\mathrm{th}}} + \\beta u(t)$$\nwhere the driving term $u(t)$ is $P$ during light-on and $0$ during light-off. In the steady-periodic state, $\\Delta T(t)$ oscillates between a minimum $\\Delta T_{\\mathrm{min}}$ and a maximum $\\Delta T_{\\mathrm{peak}}$. The temperature increases during the light-on phase, reaching its peak $\\Delta T_{\\mathrm{peak}}$ at $t=T_{\\mathrm{on}}$. It then cools during the light-off phase.\n\nSolving the ODEs for the two phases and imposing periodicity gives:\n$$\\Delta T_{\\mathrm{peak}} = \\Delta T_{\\infty,\\mathrm{on}} + (\\Delta T_{\\mathrm{min}} - \\Delta T_{\\infty,\\mathrm{on}})e^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{th}}},\\quad \\text{where } \\Delta T_{\\infty,\\mathrm{on}} = \\beta P \\tau_{\\mathrm{th}}$$\n$$\\Delta T_{\\mathrm{min}} = \\Delta T_{\\mathrm{peak}} e^{-T_{\\mathrm{off}}/\\tau_{\\mathrm{th}}}$$\nSolving this system for $\\Delta T_{\\mathrm{peak}}$ gives the peak temperature rise in the cycle:\n$$\\Delta T_{\\mathrm{peak}} = \\frac{\\beta P \\tau_{\\mathrm{th}} (1 - e^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{th}}})}{1 - e^{-T_{\\mathrm{cyc}}/\\tau_{\\mathrm{th}}}}$$\n\n**3. Search and Selection Algorithm**\n\nFor each test case, we iterate through the candidate grid. To satisfy the selection rule (\"smallest $D$, then smallest $f$\"), the search is ordered lexicographically. We iterate through $D \\in \\{0.05, 0.10, \\ldots, 0.50\\}$, and for each $D$, we iterate through $f \\in \\{5, 10, 20, 40, 80\\}$.\n\nFor each pair $(D, f)$:\n1. Calculate $T_{\\mathrm{on}} = D/f$ and $T_{\\mathrm{cyc}} = 1/f$.\n2. Compute $\\overline{O}$ using the derived formula.\n3. Compute $\\Delta T_{\\mathrm{peak}}$ using its derived formula.\n4. Check if the feasibility criteria are met: $\\overline{O} \\ge 0.7$ and $\\Delta T_{\\mathrm{peak}} < 1.0$.\n\nThe first pair $(D, f)$ that satisfies both criteria is the optimal solution for that test case. Its corresponding metrics are recorded, and the search for that case terminates. If the entire grid is searched without finding a feasible solution, the case is reported as infeasible.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the optogenetic stimulation problem for a suite of test cases.\n    \"\"\"\n    \n    # Test suite parameters\n    # (tau_on, tau_off, P, tau_th, beta)\n    test_cases = {\n        \"Case A\": (0.005, 0.015, 0.010, 1.0, 50.0),\n        \"Case B\": (0.010, 0.100, 0.015, 0.8, 40.0),\n        \"Case C\": (0.003, 0.008, 0.030, 1.2, 40.0),\n        \"Case D\": (0.030, 0.200, 0.080, 1.5, 40.0),\n    }\n\n    # Candidate grid for pulsing strategies\n    frequencies_hz = [5.0, 10.0, 20.0, 40.0, 80.0]\n    duty_cycles = [0.05, 0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.45, 0.50]\n    \n    # Constraints\n    O_AVG_TARGET = 0.7\n    T_PEAK_LIMIT = 1.0\n\n    all_results = []\n\n    for case_name, params in test_cases.items():\n        tau_on, tau_off, P, tau_th, beta = params\n        \n        found_feasible = False\n        best_result = [-1.0, -1.0, -1.0, -1.0]\n\n        # Iterate through D then f to find the optimal solution first per the selection rule\n        for D in duty_cycles:\n            for f in frequencies_hz:\n                # Calculate time durations\n                T_cyc = 1.0 / f\n                T_on = D / f\n                T_off = (1.0 - D) / f\n\n                # --- 1. Opsin gating calculation ---\n                exp_on = np.exp(-T_on / tau_on)\n                exp_off = np.exp(-T_off / tau_off)\n                \n                # Denominator for O_max\n                denom_O = 1.0 - exp_on * exp_off\n                if abs(denom_O)  1e-12: # Avoid division by zero, though unlikely\n                    continue\n\n                O_max = (1.0 - exp_on) / denom_O\n                O_min = O_max * exp_off\n                \n                O_avg = D + f * (tau_off - tau_on) * (O_max - O_min)\n\n                # --- 2. Thermal calculation ---\n                exp_th_on = np.exp(-T_on / tau_th)\n                exp_th_cyc = np.exp(-T_cyc / tau_th)\n\n                # Denominator for T_peak\n                denom_T = 1.0 - exp_th_cyc\n                if abs(denom_T)  1e-12: # Avoid division by zero\n                    continue\n                \n                T_peak = (beta * P * tau_th * (1.0 - exp_th_on)) / denom_T\n\n                # --- 3. Feasibility Check ---\n                if O_avg >= O_AVG_TARGET and T_peak  T_PEAK_LIMIT:\n                    best_result = [\n                        float(f\"{D:.3f}\"),\n                        float(f\"{f:.1f}\"),\n                        float(f\"{T_peak:.4f}\"),\n                        float(f\"{O_avg:.4f}\")\n                    ]\n                    found_feasible = True\n                    break # Found smallest f for this D, move to next case\n            \n            if found_feasible:\n                break # Found smallest D, we are done with this case\n        \n        all_results.append(best_result)\n\n    # Format the final output string as a list of lists.\n    # str(list) automatically adds spaces, so we build the string manually.\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]},{r[2]},{r[3]}]\" for r in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2589134"}]}