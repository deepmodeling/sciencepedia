{"hands_on_practices": [{"introduction": "The enduring changes in behavior that characterize addiction are rooted in long-lasting physical modifications at the level of the synapse. This exercise provides a quantitative window into how drug-evoked synaptic plasticity alters a neuron's response to the excitatory neurotransmitter glutamate. By modeling the electrical currents flowing through AMPA and NMDA receptors, you will explore how changing the ratio of these receptors—a key substrate of learning and memory—affects the strength and timing of synaptic transmission [@problem_id:2605797].", "problem": "A nucleus accumbens medium spiny neuron exhibits drug-evoked synaptic plasticity that alters receptor composition at glutamatergic synapses. Consider the macroscopic excitatory postsynaptic current (EPSC) generated by co-activation of alpha-amino-3-hydroxy-5-methyl-4-isoxazolepropionic acid receptor (AMPAR) and N-methyl-D-aspartate receptor (NMDAR) conductances by an impulse-like glutamate transient. Model the AMPAR component as $$I_{\\mathrm{A}}(t,V)=g_{\\mathrm{A},0}\\,s_{\\mathrm{A}}(t)\\,(V-E_{\\mathrm{A}}),$$ where $$s_{\\mathrm{A}}(t)=\\exp\\!\\left(-\\frac{t}{\\tau_{\\mathrm{A}}}\\right),\\quad E_{\\mathrm{A}}=0\\,\\mathrm{mV},$$ and the NMDAR component as $$I_{\\mathrm{N}}(t,V)=g_{\\mathrm{N},0}\\,s_{\\mathrm{N}}(t)\\,B(V)\\,(V-E_{\\mathrm{N}}),$$ where $$s_{\\mathrm{N}}(t)=\\exp\\!\\left(-\\frac{t}{\\tau_{\\mathrm{N}}}\\right),\\quad E_{\\mathrm{N}}=0\\,\\mathrm{mV},$$ and the magnesium block factor is the well-tested form $$B(V)=\\frac{1}{1+\\dfrac{[\\mathrm{Mg}^{2+}]}{3.57}\\,\\exp(-0.062\\,V)},$$ with $$[\\mathrm{Mg}^{2+}]=1\\,\\mathrm{mM}.$$ The total EPSC is $$I_{\\mathrm{tot}}(t,V)=I_{\\mathrm{A}}(t,V)+I_{\\mathrm{N}}(t,V).$$ Let the decay time constants be $$\\tau_{\\mathrm{A}}=5\\,\\mathrm{ms},\\quad \\tau_{\\mathrm{N}}=100\\,\\mathrm{ms}.$$\n\nDefine the AMPA/NMDA ratio $$R$$ operationally as the ratio of the absolute value of the peak AMPAR-mediated current at $$V=-70\\,\\mathrm{mV}$$ to the absolute value of the NMDAR-mediated current at $$V=+40\\,\\mathrm{mV}$$ evaluated at $$t=50\\,\\mathrm{ms}$$ after stimulation (each component pharmacologically isolated for measurement). In a baseline condition, $$R_{\\mathrm{pre}}=0.40,$$ and after an intervention that promotes insertion of calcium-permeable AMPARs (CP-AMPARs), $$R_{\\mathrm{post}}=1.20.$$\n\nTask 1. Starting from the definitions above and using only general physical principles such as Ohm’s law for ionic currents and exponential relaxation for channel kinetics, derive an expression for how increasing $$R$$ from $$R_{\\mathrm{pre}}$$ to $$R_{\\mathrm{post}}$$ changes (i) the peak amplitude of $$I_{\\mathrm{tot}}(t,V)$$ at $$V=-70\\,\\mathrm{mV}$$ and (ii) the effective weighted decay constant at $$V=-70\\,\\mathrm{mV}$$ defined by the amplitude-weighted mean $$\\tau_{\\mathrm{w}}(V)$$ of the two exponential components at the moment of peak, $$\\tau_{\\mathrm{w}}(V)=\\dfrac{A_{\\mathrm{A}}(V)\\,\\tau_{\\mathrm{A}}+A_{\\mathrm{N}}(V)\\,\\tau_{\\mathrm{N}}}{A_{\\mathrm{A}}(V)+A_{\\mathrm{N}}(V)},$$ where $$A_{\\mathrm{A}}(V)$$ and $$A_{\\mathrm{N}}(V)$$ are the instantaneous amplitudes of the AMPAR and NMDAR components at $$t=0^{+}.$$ Express your results in terms of $$R,$$ $$\\tau_{\\mathrm{A}},$$ $$\\tau_{\\mathrm{N}},$$ $$B(V),$$ and driving forces. State any approximations you make and justify them physiologically.\n\nTask 2. After the intervention, you pharmacologically isolate AMPAR-mediated currents and measure the following steady-state current–voltage data points: at $$V=-70\\,\\mathrm{mV},\\ I=-180\\,\\mathrm{pA};$$ at $$V=-40\\,\\mathrm{mV},\\ I=-120\\,\\mathrm{pA};$$ at $$V=0\\,\\mathrm{mV},\\ I=0\\,\\mathrm{pA};$$ and at $$V=+40\\,\\mathrm{mV},\\ I=+25\\,\\mathrm{pA}.$$ Assume the AMPAR reversal potential is $$E_{\\mathrm{A}}=0\\,\\mathrm{mV}.$$ Define the rectification index as the ratio of absolute chord conductances at $$V=-70\\,\\mathrm{mV}$$ and $$V=+40\\,\\mathrm{mV},$$ $$\\mathrm{RI}=\\dfrac{|I(-70)|/|{-}70-E_{\\mathrm{A}}|}{|I(+40)|/|{+}40-E_{\\mathrm{A}}|}.$$ Compute $$\\mathrm{RI}$$ from the given data.\n\nReport only the value of $$\\mathrm{RI}$$ as your final answer, unitless, rounded to four significant figures.", "solution": "The problem statement is subjected to rigorous validation before a solution is attempted.\n\nStep 1: Extract Givens.\nThe provided information is as follows:\nAMPAR current: $I_{\\mathrm{A}}(t,V)=g_{\\mathrm{A},0}\\,s_{\\mathrm{A}}(t)\\,(V-E_{\\mathrm{A}})$\nAMPAR kinetics: $s_{\\mathrm{A}}(t)=\\exp\\!\\left(-\\frac{t}{\\tau_{\\mathrm{A}}}\\right)$\nAMPAR reversal potential: $E_{\\mathrm{A}}=0\\,\\mathrm{mV}$\nAMPAR decay time constant: $\\tau_{\\mathrm{A}}=5\\,\\mathrm{ms}$\n\nNMDAR current: $I_{\\mathrm{N}}(t,V)=g_{\\mathrm{N},0}\\,s_{\\mathrm{N}}(t)\\,B(V)\\,(V-E_{\\mathrm{N}})$\nNMDAR kinetics: $s_{\\mathrm{N}}(t)=\\exp\\!\\left(-\\frac{t}{\\tau_{\\mathrm{N}}}\\right)$\nNMDAR reversal potential: $E_{\\mathrm{N}}=0\\,\\mathrm{mV}$\nNMDAR decay time constant: $\\tau_{\\mathrm{N}}=100\\,\\mathrm{ms}$\nMagnesium block factor: $B(V)=\\frac{1}{1+\\dfrac{[\\mathrm{Mg}^{2+}]}{3.57}\\,\\exp(-0.062\\,V)}$\nMagnesium concentration: $[\\mathrm{Mg}^{2+}]=1\\,\\mathrm{mM}$\nThe constant $3.57$ has units of $\\mathrm{mM}$, and $0.062$ has units of $\\mathrm{mV}^{-1}$.\n\nTotal current: $I_{\\mathrm{tot}}(t,V)=I_{\\mathrm{A}}(t,V)+I_{\\mathrm{N}}(t,V)$\n\nAMPA/NMDA Ratio definition: $R = \\frac{|I_{\\mathrm{A, peak}} \\text{ at } V=-70\\,\\mathrm{mV}|}{|I_{\\mathrm{N}} \\text{ at } V=+40\\,\\mathrm{mV}, t=50\\,\\mathrm{ms}|}$\nBaseline ratio: $R_{\\mathrm{pre}}=0.40$\nPost-intervention ratio: $R_{\\mathrm{post}}=1.20$\n\nTask 1 definitions:\nPeak amplitude of $I_{\\mathrm{tot}}(t,V)$ at $V=-70\\,\\mathrm{mV}$.\nEffective weighted decay constant: $\\tau_{\\mathrm{w}}(V)=\\dfrac{A_{\\mathrm{A}}(V)\\,\\tau_{\\mathrm{A}}+A_{\\mathrm{N}}(V)\\,\\tau_{\\mathrm{N}}}{A_{\\mathrm{A}}(V)+A_{\\mathrm{N}}(V)}$, where $A_{\\mathrm{A}}(V)$ and $A_{\\mathrm{N}}(V)$ are instantaneous amplitudes at $t=0^{+}$.\n\nTask 2 data (post-intervention, pharmacologically isolated AMPAR current):\nAt $V=-70\\,\\mathrm{mV}$, $I=-180\\,\\mathrm{pA}$\nAt $V=-40\\,\\mathrm{mV}$, $I=-120\\,\\mathrm{pA}$\nAt $V=0\\,\\mathrm{mV}$, $I=0\\,\\mathrm{pA}$\nAt $V=+40\\,\\mathrm{mV}$, $I=+25\\,\\mathrm{pA}$\n\nTask 2 definition:\nRectification Index: $\\mathrm{RI}=\\dfrac{|I(-70)|/|{-}70-E_{\\mathrm{A}}|}{|I(+40)|/|{+}40-E_{\\mathrm{A}}|}$\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded. The models for AMPAR and NMDAR currents, including the voltage-dependent magnesium block, are standard, empirically-verified representations used in computational neuroscience and synaptic physiology. The parameter values ($\\tau_{\\mathrm{A}}$, $\\tau_{\\mathrm{N}}$, $[\\mathrm{Mg}^{2+}]$) are physiologically realistic. The concept of the AMPA/NMDA ratio and its modulation by synaptic plasticity, including the insertion of CP-AMPARs which exhibit inward rectification, is a cornerstone of modern neuroscience. The problem is well-posed, providing all necessary definitions and data for both the derivation in Task 1 and the calculation in Task 2. The tasks are objective and free of ambiguity. The problem is self-contained and internally consistent.\n\nStep 3: Verdict and Action.\nThe problem is valid. A complete solution will now be provided.\n\nThe solution is presented in two parts, corresponding to the two tasks.\n\nTask 1: Derivation of Changes in EPSC Properties\n\nThe central assumption, based on the problem's description of an \"intervention that promotes insertion of calcium-permeable AMPARs,\" is that the change in the AMPA/NMDA ratio $R$ is due to a change in the maximal AMPAR conductance, $g_{\\mathrm{A},0}$, while the maximal NMDAR conductance, $g_{\\mathrm{N},0}$, remains constant.\n\nFirst, we formalize the relationship between the experimental ratio $R$ and the biophysical parameters. By definition:\n$$R = \\frac{|I_{\\mathrm{A, peak}}(-70\\,\\mathrm{mV})|}{|I_{\\mathrm{N}}(t=50\\,\\mathrm{ms}, V=+40\\,\\mathrm{mV})|}$$\nThe peak AMPAR current occurs at $t=0^{+}$ due to the exponential decay model.\n$$|I_{\\mathrm{A, peak}}(-70\\,\\mathrm{mV})| = |I_{\\mathrm{A}}(0, -70)| = |g_{\\mathrm{A},0} \\exp(-0) (-70 - 0)| = 70\\,g_{\\mathrm{A},0}$$\nThe NMDAR current at the specified point is:\n$$|I_{\\mathrm{N}}(50, 40)| = |g_{\\mathrm{N},0} \\exp(-50/\\tau_{\\mathrm{N}}) B(40) (40 - 0)| = 40\\,g_{\\mathrm{N},0} B(40) \\exp(-50/\\tau_{\\mathrm{N}})$$\nSubstituting these into the definition of $R$:\n$$R = \\frac{70\\,g_{\\mathrm{A},0}}{40\\,g_{\\mathrm{N},0} B(40) \\exp(-50/\\tau_{\\mathrm{N}})}$$\nWe can define a ratio of the peak conductances $\\gamma = g_{\\mathrm{A},0} / g_{\\mathrm{N},0}$. The equation above shows that $\\gamma$ is directly proportional to $R$.\n$$\\gamma = \\frac{g_{\\mathrm{A},0}}{g_{\\mathrm{N},0}} = R \\cdot \\left( \\frac{40 B(40) \\exp(-50/\\tau_{\\mathrm{N}})}{70} \\right) = \\frac{R}{K}$$\nwhere $K$ is a constant defined as:\n$$K = \\frac{70}{40 B(40) \\exp(-50/\\tau_{\\mathrm{N}})} = \\frac{7}{4 B(40) \\exp(-1/2)}$$\n\n(i) Change in the peak amplitude of $I_{\\mathrm{tot}}(t,V)$ at $V=-70\\,\\mathrm{mV}$.\nThe total current is $I_{\\mathrm{tot}}(t, -70) = I_{\\mathrm{A}}(t, -70) + I_{\\mathrm{N}}(t, -70)$. Both components are described by decaying exponentials starting at $t=0$ and have the same sign (inward current). Therefore, the peak magnitude of the total current occurs at $t=0^{+}$.\n$$I_{\\mathrm{peak}} = I_{\\mathrm{tot}}(0, -70) = g_{\\mathrm{A},0}(-70) + g_{\\mathrm{N},0} B(-70) (-70)$$\nThe peak amplitude is the absolute value:\n$$A_{\\mathrm{tot}}(-70) = |I_{\\mathrm{peak}}| = 70 (g_{\\mathrm{A},0} + g_{\\mathrm{N},0} B(-70))$$\nWe express this amplitude using the conductance ratio $\\gamma = g_{\\mathrm{A},0}/g_{\\mathrm{N},0}$:\n$$A_{\\mathrm{tot}}(-70) = 70 g_{\\mathrm{N},0} (\\gamma + B(-70))$$\nSubstituting $\\gamma = R/K$:\n$$A_{\\mathrm{tot}}(-70) = 70 g_{\\mathrm{N},0} \\left(\\frac{R}{K} + B(-70)\\right)$$\nTo quantify how the amplitude changes as $R$ goes from $R_{\\mathrm{pre}}$ to $R_{\\mathrm{post}}$, we compute the ratio of the post- and pre-intervention amplitudes. Since $g_{\\mathrm{N},0}$ is constant, it cancels out.\n$$\\frac{A_{\\mathrm{tot, post}}}{A_{\\mathrm{tot, pre}}} = \\frac{70 g_{\\mathrm{N},0} \\left(\\frac{R_{\\mathrm{post}}}{K} + B(-70)\\right)}{70 g_{\\mathrm{N},0} \\left(\\frac{R_{\\mathrm{pre}}}{K} + B(-70)\\right)} = \\frac{R_{\\mathrm{post}} + K B(-70)}{R_{\\mathrm{pre}} + K B(-70)}$$\nThis expression shows how the total peak current amplitude at $V=-70\\,\\mathrm{mV}$ scales with the AMPA/NMDA ratio $R$.\n\n(ii) Change in the effective weighted decay constant $\\tau_{\\mathrm{w}}(-70)$.\nThe definition is $\\tau_{\\mathrm{w}}(V)=\\dfrac{A_{\\mathrm{A}}(V)\\,\\tau_{\\mathrm{A}}+A_{\\mathrm{N}}(V)\\,\\tau_{\\mathrm{N}}}{A_{\\mathrm{A}}(V)+A_{\\mathrm{N}}(V)}$.\nAt $V=-70\\,\\mathrm{mV}$, the component amplitudes at $t=0^{+}$ are:\n$$A_{\\mathrm{A}}(-70) = |I_{\\mathrm{A}}(0, -70)| = 70 g_{\\mathrm{A},0}$$\n$$A_{\\mathrm{N}}(-70) = |I_{\\mathrm{N}}(0, -70)| = 70 g_{\\mathrm{N},0} B(-70)$$\nSubstituting these into the definition of $\\tau_{\\mathrm{w}}$:\n$$\\tau_{\\mathrm{w}}(-70) = \\frac{(70 g_{\\mathrm{A},0})\\tau_{\\mathrm{A}} + (70 g_{\\mathrm{N},0} B(-70))\\tau_{\\mathrm{N}}}{(70 g_{\\mathrm{A},0}) + (70 g_{\\mathrm{N},0} B(-70))}$$\nDividing the numerator and denominator by $70 g_{\\mathrm{N},0}$:\n$$\\tau_{\\mathrm{w}}(-70) = \\frac{(g_{\\mathrm{A},0}/g_{\\mathrm{N},0})\\tau_{\\mathrm{A}} + B(-70)\\tau_{\\mathrm{N}}}{(g_{\\mathrm{A},0}/g_{\\mathrm{N},0}) + B(-70)} = \\frac{\\gamma \\tau_{\\mathrm{A}} + B(-70)\\tau_{\\mathrm{N}}}{\\gamma + B(-70)}$$\nSubstituting $\\gamma = R/K$, we obtain the expression for the weighted time constant as a function of $R$:\n$$\\tau_{\\mathrm{w}}(R) = \\frac{\\frac{R}{K} \\tau_{\\mathrm{A}} + B(-70)\\tau_{\\mathrm{N}}}{\\frac{R}{K} + B(-70)} = \\frac{R \\tau_{\\mathrm{A}} + K B(-70)\\tau_{\\mathrm{N}}}{R + K B(-70)}$$\nThis expression describes how the effective decay kinetics change with $R$. Since $\\tau_{\\mathrm{A}}  \\tau_{\\mathrm{N}}$, an increase in $R$ (and thus $\\gamma$) increases the weight of the faster AMPA component, leading to a decrease in the overall weighted time constant $\\tau_{\\mathrm{w}}$.\n\nTask 2: Calculation of the Rectification Index\n\nThe Rectification Index ($\\mathrm{RI}$) is computed for the post-intervention AMPAR-mediated current using the provided data and definition. The reversal potential is $E_{\\mathrm{A}}=0\\,\\mathrm{mV}$. The definition is:\n$$\\mathrm{RI}=\\frac{\\text{chord conductance at } -70\\,\\mathrm{mV}}{\\text{chord conductance at } +40\\,\\mathrm{mV}} = \\frac{|I(-70)|/|-70 - E_{\\mathrm{A}}|}{|I(+40)|/|+40 - E_{\\mathrm{A}}|}$$\nThe data provided for the post-intervention state are:\n$I(-70) = -180\\,\\mathrm{pA}$\n$I(+40) = +25\\,\\mathrm{pA}$\n\nSubstituting these values into the formula:\n$$\\mathrm{RI} = \\frac{|-180\\,\\mathrm{pA}| / |-70 - 0\\,\\mathrm{mV}|}{|+25\\,\\mathrm{pA}| / |+40 - 0\\,\\mathrm{mV}|}$$\nThe units of $\\mathrm{pA/mV}$ (conductance) cancel out.\n$$\\mathrm{RI} = \\frac{180/70}{25/40} = \\frac{18/7}{5/8}$$\n$$\\mathrm{RI} = \\frac{18}{7} \\times \\frac{8}{5} = \\frac{144}{35}$$\nConverting to a decimal value:\n$$\\mathrm{RI} = 4.1142857...$$\nRounding to four significant figures as required by the problem statement:\n$$\\mathrm{RI} \\approx 4.114$$\nThis value, being significantly greater than $1$, indicates strong inward rectification, consistent with the described insertion of calcium-permeable AMPARs which typically lack the GluA2 subunit.", "answer": "$$\\boxed{4.114}$$", "id": "2605797"}, {"introduction": "The powerful effects of many addictive drugs converge on a common mechanism: the elevation of extracellular dopamine concentration in the brain's reward centers. However, how they achieve this can differ profoundly, leading to distinct subjective and neurobiological effects. This exercise uses a dynamical systems model to compare two key pharmacological actions: the blockage of the dopamine transporter (DAT) versus the induction of dopamine efflux, also known as reverse transport [@problem_id:2605788]. Analyzing this system reveals how these two manipulations create unique kinetic signatures for both baseline and phasic dopamine signals.", "problem": "A synaptic microdomain is modeled with two state variables: extracellular dopamine concentration $D(t)$ and presynaptic cytosolic dopamine concentration $C(t)$. On the time scale of tens of seconds, vesicular synthesis is slow and vesicular loading is approximately first order in $C$. The net dopamine balance follows conservation of mass and saturable transporter kinetics. Consider the following generic mass-action framework, where all fluxes are nonnegative functions of their arguments and parameters are constant in time:\n\n- Extracellular balance:\n$$\\frac{dD}{dt} \\;=\\; R_{\\mathrm{tonic}} \\;+\\; R_{\\mathrm{phasic}}(t) \\;+\\; J_{\\mathrm{rev}}(C) \\;-\\; J_{\\mathrm{DAT\\_in}}(D;I) \\;-\\; k_{\\mathrm{ext}}\\,D.$$\n\n- Cytosolic balance:\n$$\\frac{dC}{dt} \\;=\\; S \\;-\\; L\\,C \\;-\\; J_{\\mathrm{rev}}(C) \\;+\\; J_{\\mathrm{DAT\\_in}}(D;I).$$\n\nHere $R_{\\mathrm{tonic}}$ is constant tonic vesicular release, $R_{\\mathrm{phasic}}(t)$ is a brief presynaptic burst, $k_{\\mathrm{ext}}$ is first-order extracellular loss (diffusion/enzymatic), $S$ is slow synthesis, and $L$ is a first-order vesicular loading term. Dopamine transporter (DAT)-mediated inward uptake is modeled by Michaelis–Menten kinetics with competitive inhibition:\n$$J_{\\mathrm{DAT\\_in}}(D;I) \\;=\\; \\frac{V_{\\max}\\,D}{K_m\\left(1+\\frac{I}{K_i}\\right)+D},$$\nwhere $I$ is the inhibitor concentration and $K_i$ its inhibition constant. Carrier-mediated reverse transport (efflux) is represented as an outward flux from cytosol to extracellular space:\n$$J_{\\mathrm{rev}}(C) \\;=\\; \\frac{V_{\\mathrm{rev}}\\,C}{K_{\\mathrm{rev}}+C},$$\nwith $V_{\\mathrm{rev}}=0$ in the absence of reverse transport.\n\nTwo experimental manipulations are applied separately:\n\n- Condition $\\mathcal{A}$ (competitive DAT inhibition): $I0$ and $V_{\\mathrm{rev}}=0$.\n- Condition $\\mathcal{B}$ (reverse transport): $I=0$ and $V_{\\mathrm{rev}}0$.\n\nAssume $R_{\\mathrm{phasic}}(t)$ is a short pulse that momentarily increases release without directly changing transporter parameters, and that vesicular release amplitude depends on vesicular filling via $C$ only through the term $R_{\\mathrm{tonic}}+R_{\\mathrm{phasic}}(t)$, whose maximal achievable magnitude decreases if $C$ is chronically depleted.\n\nWhich option best compares the kinetic consequences of Condition $\\mathcal{A}$ versus Condition $\\mathcal{B}$ on both the steady state and the response to a small phasic pulse, using a phase-plane argument based on nullclines and local stability?\n\nA. Under Condition $\\mathcal{A}$, the $D$-nullcline $dD/dt=0$ shifts upward monotonically with no change in topology, yielding a unique stable fixed point with increased $D^\\ast$; the local slope $\\partial(\\dot D)/\\partial D$ at the fixed point becomes less negative, so phasic peaks are larger and decays are slower. Under Condition $\\mathcal{B}$, the added source term $J_{\\mathrm{rev}}(C)$ elevates the $D$-nullcline and, when coupled to the $C$-nullcline, can eliminate the low-$D$ fixed point and create a new high-$D$ attractor with reduced $C^\\ast$; the elevated baseline compresses the relative phasic increment and can reduce evoked amplitude by depleting vesicular filling, with trajectories relaxing along a qualitatively altered vector field.\n\nB. Both conditions simply increase the steady-state $D^\\ast$ without changing the number or stability of fixed points; in each case the phase-plane linearization shows a more negative $\\partial(\\dot D)/\\partial D$, so phasic peaks are smaller and decays are faster.\n\nC. Condition $\\mathcal{A}$ lowers $D^\\ast$ by reducing transporter capacity and therefore shortens phasic decay, whereas Condition $\\mathcal{B}$ lowers both $D^\\ast$ and phasic peak amplitude by diverting dopamine into the cytosol; the phase-plane shows a downward shift of the $D$-nullcline in both cases with no coupling to $C$.\n\nD. Under Condition $\\mathcal{A}$, increasing the apparent Michaelis constant $K_m\\left(1+\\frac{I}{K_i}\\right)$ speeds extracellular clearance and thus decreases both the baseline $D^\\ast$ and the area under phasic transients; under Condition $\\mathcal{B}$, $V_{\\mathrm{rev}}0$ does not alter the steady state because uptake and efflux cancel at equilibrium, so phasic responses are unchanged in the phase plane.", "solution": "The task is to analyze a two-variable dynamical system modeling dopamine concentrations under two different pharmacological conditions, and to evaluate which of the provided options offers the best comparison of their kinetic consequences using phase-plane analysis.\n\nThe system is defined by the following ordinary differential equations:\n$$ \\frac{dD}{dt} = \\dot{D} = R_{\\mathrm{tonic}} + R_{\\mathrm{phasic}}(t) + J_{\\mathrm{rev}}(C) - J_{\\mathrm{DAT\\_in}}(D;I) - k_{\\mathrm{ext}}\\,D $$\n$$ \\fracdC}{dt} = \\dot{C} = S - L\\,C - J_{\\mathrm{rev}}(C) + J_{\\mathrm{DAT\\_in}}(D;I) $$\nwhere $D$ is the extracellular and $C$ is the cytosolic dopamine concentration. The flux terms are given by:\n$$ J_{\\mathrm{DAT\\_in}}(D;I) = \\frac{V_{\\max}\\,D}{K_m\\left(1+\\frac{I}{K_i}\\right)+D} $$\n$$ J_{\\mathrm{rev}}(C) = \\frac{V_{\\mathrm{rev}}\\,C}{K_{\\mathrm{rev}}+C} $$\n\nFirst, I must validate the problem statement. The problem provides a well-defined system of ordinary differential equations based on standard biophysical and pharmacological principles (mass-action kinetics, Michaelis-Menten transporters, competitive inhibition). The parameters are physically meaningful, and the questions posed are standard for the analysis of such dynamical systems. The problem is scientifically grounded, well-posed, and objective. It is valid for analysis.\n\nWe will analyze the system by examining its nullclines, which are the curves in the $(D, C)$ phase plane where $\\dot{D}=0$ or $\\dot{C}=0$. Fixed points $(D^\\ast, C^\\ast)$ of the system are the intersections of these nullclines, found by setting $\\dot{D}=0$ and $\\dot{C}=0$ with $R_{\\mathrm{phasic}}(t) = 0$.\n\nA crucial property of any fixed point can be found by summing the two steady-state equations:\n$(\\dot{D}=0) + (\\dot{C}=0) \\implies (R_{\\mathrm{tonic}} - k_{\\mathrm{ext}}D^\\ast) + (S - LC^\\ast) = 0$.\nThis gives a linear relationship that must hold for any fixed point:\n$$ LC^\\ast = R_{\\mathrm{tonic}} + S - k_{\\mathrm{ext}}D^\\ast \\quad \\text{or} \\quad C^\\ast = \\frac{R_{\\mathrm{tonic}}+S}{L} - \\frac{k_{\\mathrm{ext}}}{L}D^\\ast $$\nThis equation shows that the steady-state cytosolic concentration $C^\\ast$ is a linearly decreasing function of the steady-state extracellular concentration $D^\\ast$.\n\nNow we analyze the two conditions relative to a baseline state where $I=0$ and $V_{\\mathrm{rev}}=0$.\n\n**Condition $\\mathcal{A}$ (Competitive DAT Inhibition): $I  0, V_{\\mathrm{rev}} = 0$.**\nThe equations become:\n$$ \\dot{D} = R_{\\mathrm{tonic}} - \\frac{V_{\\max}\\,D}{K_m(1+I/K_i)+D} - k_{\\mathrm{ext}}\\,D $$\n$$ \\dot{C} = S - L\\,C + \\frac{V_{\\max}\\,D}{K_m(1+I/K_i)+D} $$\n1.  **Steady State**: For this condition, the $D$-nullcline ($\\dot{D}=0$) does not depend on $C$. It is defined by $R_{\\mathrm{tonic}} = J_{\\mathrm{DAT\\_in}}(D;I) + k_{\\mathrm{ext}}D$. The competitive inhibitor increases the apparent Michaelis constant to $K_m' = K_m(1+I/K_i)$. This reduces the uptake flux $J_{\\mathrm{DAT\\_in}}$ for any given $D$. To maintain the steady-state balance where total influx ($R_{\\mathrm{tonic}}$) equals total efflux ($J_{\\mathrm{DAT\\_in}} + k_{\\mathrm{ext}}D$), the extracellular concentration $D^\\ast$ must increase. Thus, Condition $\\mathcal{A}$ leads to an increase in $D^\\ast$. From the linear relationship between $C^\\ast$ and $D^\\ast$, an increase in $D^\\ast$ must cause a decrease in $C^\\ast$. The system maintains a unique, stable fixed point. If the phase plane is plotted with $D$ on the vertical axis, the $D$-nullcline is a horizontal line that shifts upward.\n2.  **Phasic Response**: The stability of the system with respect to $D$ is governed by the partial derivative $\\partial \\dot{D}/\\partial D$ evaluated at the fixed point. $\\partial \\dot{D}/\\partial D = -\\partial J_{\\mathrm{DAT\\_in}}/\\partial D - k_{\\mathrm{ext}}$. By reducing the efficacy of the transporter, the inhibitor makes the slope $\\partial J_{\\mathrm{DAT\\_in}}/\\partial D$ smaller (less steep). Consequently, $\\partial \\dot{D}/\\partial D$ becomes less negative (i.e., closer to $0$). A less negative eigenvalue corresponds to a longer time constant for relaxation. This means that following a phasic release pulse ($R_{\\mathrm{phasic}}$), the decay of dopamine will be slower, and the peak concentration will be higher and more prolonged.\n\n**Condition $\\mathcal{B}$ (Reverse Transport): $I = 0, V_{\\mathrm{rev}}  0$.**\nThe equations are now fully coupled:\n$$ \\dot{D} = R_{\\mathrmtonic}} + \\frac{V_{\\mathrm{rev}}\\,C}{K_{\\mathrm{rev}}+C} - \\frac{V_{\\max}\\,D}{K_m+D} - k_{\\mathrm{ext}}\\,D $$\n$$ \\dot{C} = S - L\\,C - \\frac{V_{\\mathrm{rev}}\\,C}{K_{\\mathrm{rev}}+C} + \\frac{V_{\\max}\\,D}{K_m+D} $$\n1.  **Steady State**: The term $J_{\\mathrm{rev}}(C)$ acts as a new, $C$-dependent source of extracellular dopamine. To satisfy the $D$-nullcline equation, $R_{\\mathrm{tonic}} + J_{\\mathrm{rev}}(C^\\ast) = J_{\\mathrm{DAT\\_in}}(D^\\ast) + k_{\\mathrm{ext}}D^\\ast$, the total clearance at steady state must balance a larger influx compared to baseline. Because the total clearance function is monotonic in $D$, this requires that $D^\\ast$ must increase. Again, via the linear fixed-point relation, an increase in $D^\\ast$ implies a decrease in $C^\\ast$. The decrease in $C^\\ast$ signifies a depletion of presynaptic dopamine stores.\n2.  **Topology and Bifurcations**: The option mentions the possibility of eliminating a low-$D$ fixed point and creating a high-$D$ attractor, which implies a bifurcation leading to bistability. A rigorous analysis of the nullcline slopes shows that the slope of the $D$-nullcline is always greater than the slope of the $C$-nullcline for all $(D,C)$ in the positive quadrant, provided physically reasonable parameters ($L0, k_{\\mathrm{ext}}0$). This proves that the nullclines can intersect at most once. Therefore, for the model as given, a unique fixed point is guaranteed, and the claimed bifurcation does not occur. This part of the description in option A is a known feature of amphetamine action (the class of drugs that cause reverse transport) but is captured only by more complex models, for instance those including autoreceptor feedback. The given model is an oversimplification in this regard.\n3.  **Phasic Response**: The increase in baseline $D^\\ast$ means that any fixed-amplitude phasic release pulse will represent a smaller *relative* increase over the baseline, which is what \"compresses the relative phasic increment\" means. Furthermore, the problem states that the magnitude of phasic release depends on vesicular filling, which relates to $C$. Since Condition $\\mathcal{B}$ lowers the steady-state cytosolic concentration $C^\\ast$, it will lead to \"depleting vesicular filling\", thereby reducing the amplitude of evoked phasic release. The introduction of the $J_{\\mathrm{rev}}(C)$ term fundamentally changes the form of the nullclines and thus the geometry of the flow in the phase plane, so trajectories indeed relax along a \"qualitatively altered vector field.\"\n\n**Evaluation of Options:**\n\n*   **A**: The description of Condition $\\mathcal{A}$ is entirely accurate. The description of Condition $\\mathcal{B}$ correctly identifies the elevation of the $D$-nullcline, the resulting decrease in $C^\\ast$, the compression of relative phasic signals, the reduction of evoked release via depletion, and the qualitative alteration of the vector field. It incorrectly claims the model can exhibit bistability. However, this claim correctly describes the real-world phenomenon that Condition $\\mathcal{B}$ is meant to model.\n*   **B**: Claims both conditions lead to a *more negative* $\\partial(\\dot D)/\\partial D$. This is incorrect for Condition $\\mathcal{A}$, where it becomes less negative. Therefore, this option is incorrect.\n*   **C**: Claims Condition $\\mathcal{A}$ *lowers* $D^\\ast$. This is fundamentally incorrect; blocking dopamine clearance must raise its concentration. Therefore, this option is incorrect.\n*   **D**: Claims Condition $\\mathcal{A}$ *speeds* clearance and thus *decreases* $D^\\ast$. This is incorrect. It also claims Condition $\\mathcal{B}$ does not alter the steady state, which is also incorrect. Therefore, this option is incorrect.\n\n**Conclusion:**\n\nOptions B, C, and D contain fundamental errors in their analysis of the system's dynamics. Option A provides a description that is accurate in almost all details for both conditions. Its only inaccuracy is attributing a property (bistability) to this specific simplified model that the model does not possess, although this property is a key feature of the real pharmacological phenomenon being modeled. Among the given choices, Option A is overwhelmingly the best and most insightful description of the comparative kinetics. A discerning scientist understands the limitations of a model while appreciating a description that captures the essential real-world phenomenology.\n\nFinal verdict on Option A: **Correct**.\nFinal verdict on Option B: **Incorrect**.\nFinal verdict on Option C: **Incorrect**.\nFinal verdict on Option D: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2605788"}, {"introduction": "The brain's reward system excels at learning to predict future rewards, not just react to them. This hands-on computational exercise asks you to implement the temporal-difference (TD) learning algorithm, a foundational model that formalizes how reward prediction errors—thought to be signaled by phasic dopamine—drive learning. By simulating this process, you will directly observe the transfer of value from a primary reward to a predictive cue, providing a powerful algorithmic framework for understanding reinforcement and craving [@problem_id:2605752].", "problem": "Write a program that models phasic dopaminergic responses during a deterministic cue-reward task with variable cue-to-reward delays, in order to demonstrate transfer of the response from reward delivery to cue onset as value estimates converge. Use a discrete-time, episodic setting with the following fundamental bases and assumptions, which are widely accepted in reinforcement learning models of mesolimbic dopamine system function in the physiology of reward circuitry and addiction:\n\n- The phasic dopaminergic signal is proportional to the instantaneous discrepancy between successive estimates of the expected discounted sum of future primary rewards plus any received primary reward at that moment.\n- Trials are independent episodes. Each trial consists of a brief predictive cue at time step $0$ followed by a fixed delay of $D$ seconds before delivery of a nonnegative primary reward of magnitude $R$. Time is discretized into steps of $1$ second, so the delay in steps equals $D$.\n- The agent maintains a table of scalar state values for each within-trial time step after the cue and before reward. The pre-cue baseline state has a fixed value of $0$ and is not updated. After reward delivery, the terminal state has a value of $0$.\n- The agent uses a constant learning rate $\\alpha$ and a constant discount factor $\\gamma$ across trials. Within each trial, the agent updates the value at each within-trial state sequentially by moving a fraction $\\alpha$ of the discrepancy described above toward reducing that discrepancy, using one-step bootstrapping. Across trials, these estimates converge for deterministic tasks.\n- Define the model-predicted phasic dopaminergic response at cue onset in a given trial as the discrepancy computed on the state transition from the pre-cue baseline (fixed value $0$) to the first post-cue state. Define the model-predicted phasic dopaminergic response at reward delivery as the discrepancy computed on the transition from the last pre-reward state to the terminal state upon primary reward delivery. If the delay is $0$ seconds, treat the episode as a single baseline-to-terminal transition at the time of cue-reward coincidence; in that boundary case, report the same discrepancy as both cue-aligned and reward-aligned responses.\n\nImplement the simulation exactly as specified above and compute, for each parameter set in the test suite below, the following four quantities:\n- the cue-aligned response on trial $1$,\n- the reward-aligned response on trial $1$,\n- the cue-aligned response on the last trial,\n- the reward-aligned response on the last trial.\n\nAll responses are unitless (arbitrary units). Round each reported float to three decimals. The time step is $1$ second; delays $D$ are provided in seconds. There are no angles.\n\nTest suite (each tuple is $(\\gamma,\\alpha,R,D,T)$):\n- Case A (happy path): $\\gamma=0.95$, $\\alpha=0.20$, $R=1.0$, $D=3$, $T=200$.\n- Case B (long delay, slow learning): $\\gamma=0.99$, $\\alpha=0.10$, $R=1.0$, $D=10$, $T=400$.\n- Case C (immediate reward boundary): $\\gamma=0.95$, $\\alpha=0.30$, $R=1.0$, $D=0$, $T=100$.\n- Case D (heavy discounting): $\\gamma=0.50$, $\\alpha=0.20$, $R=1.0$, $D=4$, $T=200$.\n\nYour program should produce a single line of output containing the results for all cases as a comma-separated list of lists, with no spaces, in this exact format:\n[[cue1_caseA,reward1_caseA,cuelast_caseA,rewardlast_caseA],[cue1_caseB,reward1_caseB,cuelast_caseB,rewardlast_caseB],[cue1_caseC,reward1_caseC,cuelast_caseC,rewardlast_caseC],[cue1_caseD,reward1_caseD,cuelast_caseD,rewardlast_caseD]]", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Model Principle:** The phasic dopaminergic signal is proportional to the temporal difference (TD) error: the discrepancy between successive estimates of expected future reward, plus any immediate reward.\n- **Task Structure:** Discrete-time, episodic. Each trial involves a cue at time step $0$, a delay of $D$ seconds, and a primary reward $R \\ge 0$ at time step $D$. Time steps are $1$ second.\n- **State Values:**\n    - Pre-cue baseline state value is fixed at $V_{pre-cue} = 0$.\n    - Terminal state value (post-reward) is fixed at $V_{terminal} = 0$.\n    - Values for within-trial states $s_0, s_1, \\dots, s_{D-1}$ are learned. Let their values be $V_0, V_1, \\dots, V_{D-1}$.\n    - Initial values for all learnable states are $0$.\n- **Learning Parameters:** Constant learning rate $\\alpha$, constant discount factor $\\gamma$.\n- **Update Rule:** Value updates use one-step bootstrapping: $V(s) \\leftarrow V(s) + \\alpha \\cdot (\\text{discrepancy})$. Updates are sequential for each state within a trial. Based on standard TD learning, this is interpreted as a batch update at the end of each trial, where for each state $s_t$, $V_t$ is updated using the TD error $\\delta_t$.\n- **Response Definitions:**\n    - Cue-aligned response: TD error on the transition from pre-cue state to the first post-cue state ($s_0$).\n    - Reward-aligned response: TD error on the transition from the last pre-reward state ($s_{D-1}$) to the terminal state.\n- **Boundary Case ($D=0$):**\n    - The task is a single transition from pre-cue baseline to the terminal state.\n    - The reward $R$ is delivered at cue time.\n    - The cue-aligned and reward-aligned responses are identical and equal to the TD error of this single transition.\n- **Input Parameters:** A set of tuples $(\\gamma, \\alpha, R, D, T)$, where $T$ is the total number of trials.\n- **Required Output:** For each parameter set, a list of four quantities: [cue response trial $1$, reward response trial $1$, cue response trial $T$, reward response trial $T$], with each value rounded to three decimals.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed against the validation criteria.\n\n- **Scientifically Grounded:** The problem is a direct implementation of the temporal difference (TD) model of dopamine function, a foundational concept in computational neuroscience and reinforcement learning. This model, proposed by Schultz, Dayan, and Montague, posits that phasic dopamine activity encodes a reward prediction error (RPE), which drives learning. The specified mechanics are a standard formulation of TD(0) learning in an episodic, deterministic Pavlovian conditioning paradigm. It is scientifically sound.\n- **Well-Posed:** The problem is well-posed. The dynamics of the system (the value updates) are clearly defined by a set of difference equations. The initial conditions are specified ($V_t=0$ for all learnable states at trial $1$). The parameters are provided. For a deterministic task with $\\gamma  1$ and a constant positive learning rate, the value estimates are guaranteed to converge to a unique, stable solution. The quantities to be computed are precisely defined.\n- **Objective:** The problem is stated in objective, mathematical language, free of subjective or ambiguous terminology.\n- **Completeness and Consistency:** The problem provides all necessary information: the model equations, initial/boundary conditions, learning parameters, and a full description of the simulation procedure. The special case for $D=0$ is explicitly and consistently defined. There are no contradictions.\n- **Feasibility:** The parameter values given in the test suite are physically and computationally reasonable. The simulation is computationally tractable.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a canonical exercise in computational modeling of neural reward systems. A solution will be provided.\n\n**Principle-Based Solution**\n\nThe problem requires simulating a Temporal Difference (TD) learning agent to model phasic dopamine responses. The core scientific principle is that dopamine neurons signal a reward prediction error (RPE), which is the difference between an actual outcome and its prediction. This RPE is used to update predictions for future events.\n\n**1. Formalization of the TD Model**\nLet $V_t^{(k)}$ be the value of being in state $s_t$ at the beginning of trial $k$, where $t \\in \\{0, 1, \\dots, D-1\\}$ corresponds to the time in seconds elapsed since the cue. The initial state values are $V_t^{(1)} = 0$ for all $t$. The pre-cue and terminal state values are fixed: $V_{pre-cue} = 0$ and $V_{terminal} = 0$.\n\nThe one-step TD error, $\\delta_t$, for a transition from state $s_t$ to $s_{t+1}$ with immediate reward $r_{t+1}$ is:\n$$ \\delta_t = r_{t+1} + \\gamma V(s_{t+1}) - V(s_t) $$\nIn this specific task, reward is only delivered at the end. Let the values at the beginning of a trial $k$ be the vector $\\mathbf{V}^{(k)} = [V_0^{(k)}, V_1^{(k)}, \\dots, V_{D-1}^{(k)}]$.\n\nThe TD errors for each state transition within trial $k$ are:\n- For transitions between delay states, $s_t \\to s_{t+1}$ where $t \\in \\{0, 1, \\dots, D-2\\}$:\n$$ \\delta_t^{(k)} = (r=0) + \\gamma V_{t+1}^{(k)} - V_t^{(k)} $$\n- For the final transition from the last delay state $s_{D-1}$ to the terminal state:\n$$ \\delta_{D-1}^{(k)} = R + \\gamma V_{terminal} - V_{D-1}^{(k)} = R - V_{D-1}^{(k)} $$\n\nThese errors are then used to update the state values for the next trial, $k+1$:\n$$ V_t^{(k+1)} = V_t^{(k)} + \\alpha \\delta_t^{(k)} \\quad \\text{for } t \\in \\{0, 1, \\dots, D-1\\} $$\n\n**2. Phasic Dopaminergic Responses**\nThe problem defines the model's \"dopamine responses\" as specific TD errors.\n- **Cue-aligned response:** This is the TD error on the transition from the fixed-value pre-cue state ($V_{pre-cue}=0$) to the first post-cue state $s_0$.\n$$ \\delta_{cue}^{(k)} = (r=0) + \\gamma V_0^{(k)} - V_{pre-cue} = \\gamma V_0^{(k)} $$\n- **Reward-aligned response:** This is the TD error on the transition from the last pre-reward state $s_{D-1}$ to the terminal state, which is simply $\\delta_{D-1}^{(k)}$.\n$$ \\delta_{reward}^{(k)} = R + \\gamma V_{terminal} - V_{D-1}^{(k)} = R - V_{D-1}^{(k)} $$\n\n**3. Convergence Analysis**\nAs the number of trials $k \\to \\infty$, the values converge to a steady state $\\mathbf{V}^*$ where the updates are zero ($\\delta_t^* = 0$).\nFor $t \\in \\{0, 1, \\dots, D-2\\}$, $\\delta_t^* = \\gamma V_{t+1}^* - V_t^* = 0 \\implies V_t^* = \\gamma V_{t+1}^*$.\nFor $t = D-1$, $\\delta_{D-1}^* = R - V_{D-1}^* = 0 \\implies V_{D-1}^* = R$.\nBy backward induction, the converged value for any state $s_t$ is the discounted value of the future reward $R$:\n$$ V_t^* = \\gamma^{D-1-t} R $$\nThe converged responses are thus:\n- $\\delta_{cue}^* = \\gamma V_0^* = \\gamma (\\gamma^{D-1}R) = \\gamma^D R$\n- $\\delta_{reward}^* = R - V_{D-1}^* = R - R = 0$\nThis result demonstrates the characteristic transfer of the prediction error signal from the time of reward to the time of the earliest predictive cue.\n\n**4. Boundary Case ($D=0$)**\nWhen the delay $D=0$, the cue and reward are simultaneous. The event is a single transition from the pre-cue state to the terminal state. There are no intermediate states $s_t$ to learn values for. The TD error for this single transition is:\n$$ \\delta = R + \\gamma V_{terminal} - V_{pre-cue} = R + \\gamma(0) - 0 = R $$\nThe problem stipulates that this single error value, $R$, is reported for both the cue- and reward-aligned responses for all trials, as no learning occurs.\n\n**5. Algorithm Implementation**\nThe simulation is implemented as follows:\n1. For each test case $(\\gamma, \\alpha, R, D, T)$, first check if $D=0$. If so, the result is $[R, R, R, R]$.\n2. If $D  0$, initialize a NumPy array `V` of size $D$ with zeros. This represents the state values $V_t^{(1)}$.\n3. Calculate the trial $1$ responses: $\\delta_{cue}^{(1)} = \\gamma V_0^{(1)}$ and $\\delta_{reward}^{(1)} = R - V_{D-1}^{(1)}$.\n4. Loop for $T-1$ iterations to simulate the updates from trial $1$ to trial $T-1$. In each iteration:\n    a. Calculate a vector of TD errors, `td_errors`, using the current value vector `V`.\n    b. Update the value vector: `V = V + alpha * td_errors`.\n5. After the loop, `V` contains the values for the start of trial $T$, i.e., $V_t^{(T)}$.\n6. Calculate the last trial responses: $\\delta_{cue}^{(T)} = \\gamma V_0^{(T)}$ and $\\delta_{reward}^{(T)} = R - V_{D-1}^{(T)}$.\n7. Collect the four computed responses, round them to three decimal places, and format the output as specified.\nThis procedure correctly computes the evolution of the value function and associated prediction errors across trials.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        (0.95, 0.20, 1.0, 3, 200),  # Case A\n        (0.99, 0.10, 1.0, 10, 400), # Case B\n        (0.95, 0.30, 1.0, 0, 100),  # Case C\n        (0.50, 0.20, 1.0, 4, 200),  # Case D\n    ]\n\n    all_results = []\n    for params in test_cases:\n        result = simulate_td_learning(*params)\n        formatted_result = f\"[{','.join(f'{x:.3f}' for x in result)}]\"\n        all_results.append(formatted_result)\n\n    print(f\"[{','.join(all_results)}]\")\n\n\ndef simulate_td_learning(gamma, alpha, R, D, T):\n    \"\"\"\n    Simulates a deterministic cue-reward task using a temporal difference (TD) model.\n\n    Args:\n        gamma (float): Discount factor.\n        alpha (float): Learning rate.\n        R (float): Reward magnitude.\n        D (int): Delay in time steps (seconds) from cue to reward.\n        T (int): Total number of trials.\n\n    Returns:\n        list: A list of four floats: [cue_response_trial_1, reward_response_trial_1,\n               cue_response_last_trial, reward_response_last_trial].\n    \"\"\"\n    # Handle the boundary case where D=0 (immediate reward)\n    if D == 0:\n        # No learning occurs as there are no intermediate states.\n        # The TD error is R for the single transition from pre-cue to terminal.\n        # This error is reported for both cue and reward response on all trials.\n        return [R, R, R, R]\n\n    # Initialize state values V_t for t=0..D-1 for the first trial (k=1).\n    # V_t^(1) = 0 for all t.\n    V = np.zeros(D, dtype=float)\n\n    # --- Calculate responses for Trial 1 ---\n    # Cue response is the TD error for pre-cue - s_0 transition: delta_cue = gamma * V_0 - V_precue\n    cue_response_trial_1 = gamma * V[0]\n    # Reward response is the TD error for s_{D-1} - terminal transition: delta_reward = R - V_{D-1}\n    reward_response_trial_1 = R - V[D-1]\n\n    # --- Simulate T trials to find values at the start of the last trial (T) ---\n    # We need to perform T-1 updates to get from the values for trial 1 to trial T.\n    for _ in range(T - 1):\n        td_errors = np.zeros(D, dtype=float)\n\n        # Calculate TD errors for transitions s_t - s_{t+1} for t=0..D-2\n        # delta_t = gamma * V_{t+1} - V_t\n        if D  1:\n            td_errors[:-1] = gamma * V[1:] - V[:-1]\n\n        # Calculate TD error for transition s_{D-1} - terminal\n        # delta_{D-1} = R - V_{D-1}\n        td_errors[-1] = R - V[-1]\n\n        # Update all state values for the next trial\n        # V_t^(k+1) = V_t^(k) + alpha * delta_t^(k)\n        V += alpha * td_errors\n\n    # At this point, V contains the values for the start of trial T.\n    \n    # --- Calculate responses for the last trial (T) ---\n    cue_response_last_trial = gamma * V[0]\n    reward_response_last_trial = R - V[-1]\n\n    return [\n        cue_response_trial_1,\n        reward_response_trial_1,\n        cue_response_last_trial,\n        reward_response_last_trial,\n    ]\n\nsolve()\n```", "id": "2605752"}]}