{"hands_on_practices": [{"introduction": "The rhythmic output of a Central Pattern Generator often originates from the intrinsic properties of its constituent neurons. This exercise delves into the mechanics of a single pacemaker neuron, a fundamental building block for rhythmogenesis. By modeling the slow, opposing dynamics of a calcium current and a calcium-activated potassium current, you will derive the principles governing burst duration and frequency, providing a computational foundation for understanding how ion channel properties translate into cellular-level oscillations [@problem_id:2556980].", "problem": "Consider a single pacemaker neuron in a central pattern generator for locomotion in which bursts arise from the interaction of a voltage-dependent calcium current ($I_{\\mathrm{Ca}}$) and a calcium-activated potassium current ($I_{\\mathrm{KCa}}$) under a standard fast-slow decomposition. Assume the following widely used coarse-grained description for intracellular free calcium concentration $[{\\mathrm{Ca}}]$ (denote $c$ for brevity) as the slow variable. During the active (spiking) phase, the average calcium influx through $I_{\\mathrm{Ca}}$ drives $c$ toward an upper quasi-steady level $c_{\\mathrm{hi}}$, while during the silent (non-spiking) phase, pumps and exchangers drive $c$ toward a lower quasi-steady level $c_{\\mathrm{lo}}$. Under first-order buffering and clearance, the slow dynamics are\n$$\n\\frac{dc}{dt} =\n\\begin{cases}\n\\dfrac{c_{\\mathrm{hi}} - c}{\\tau_{\\mathrm{Ca}}}  \\text{(active phase)}, \\\\\n\\dfrac{c_{\\mathrm{lo}} - c}{\\tau_{\\mathrm{Ca}}}  \\text{(silent phase)},\n\\end{cases}\n$$\nwhere $\\tau_{\\mathrm{Ca}}$ is the effective calcium time constant. The calcium-activated potassium current $I_{\\mathrm{KCa}}$ monotonically increases with $c$ and terminates the active phase when $c$ crosses an upper threshold $c_{\\mathrm{off}}$, while silence ends and spiking resumes when $c$ decays below a lower threshold $c_{\\mathrm{on}}$. Assume constant thresholds satisfying $c_{\\mathrm{lo}}  c_{\\mathrm{on}}  c_{\\mathrm{off}}  c_{\\mathrm{hi}}$, and that each burst cycle begins at $c = c_{\\mathrm{on}}$ and ends the active phase at $c = c_{\\mathrm{off}}$, then ends the silent phase when $c$ returns to $c = c_{\\mathrm{on}}$. You may assume time-scale separation so that the fast voltage dynamics switch instantaneously at the thresholds, and the slow evolution of $c$ is well described by the first-order linear ordinary differential equations above.\n\nTask: Derive from first principles the expressions for the active-phase duration $T_{\\mathrm{on}}$ and silent-phase duration $T_{\\mathrm{off}}$ in terms of $\\tau_{\\mathrm{Ca}}$, $c_{\\mathrm{hi}}$, $c_{\\mathrm{lo}}$, $c_{\\mathrm{on}}$, and $c_{\\mathrm{off}}$. Then, using those expressions, write a program that computes the burst period $T = T_{\\mathrm{on}} + T_{\\mathrm{off}}$ (expressed in milliseconds) and the duty cycle $D = T_{\\mathrm{on}} / T$ (dimensionless decimal fraction) for a baseline $\\tau_{\\mathrm{Ca}}$ and for a buffered condition in which $\\tau_{\\mathrm{Ca}}$ is reduced by half. Report times in milliseconds and duty cycle as a decimal fraction. No angles are involved.\n\nFor each test case below, compute and return a list of four values: $[T_{\\text{base}}, D_{\\text{base}}, T_{\\text{buf}}, D_{\\text{buf}}]$, where $T_{\\text{base}}$ and $D_{\\text{base}}$ are the period and duty cycle for the baseline $\\tau_{\\mathrm{Ca}}$, and $T_{\\text{buf}}$ and $D_{\\text{buf}}$ are the period and duty cycle when buffering halves the time constant to $\\tau_{\\mathrm{Ca}}/2$. All time quantities must be expressed in milliseconds and rounded to $6$ decimal places; duty cycle values must be rounded to $6$ decimal places.\n\nUse the following test suite of parameter sets, each defined as a tuple $(\\tau_{\\mathrm{Ca}}, c_{\\mathrm{hi}}, c_{\\mathrm{lo}}, c_{\\mathrm{on}}, c_{\\mathrm{off}})$ with concentrations in micromolar and $\\tau_{\\mathrm{Ca}}$ in milliseconds:\n- Test $1$: $(200.0, 1.0, 0.05, 0.2, 0.8)$\n- Test $2$: $(150.0, 0.9, 0.1, 0.2, 0.7)$\n- Test $3$: $(100.0, 1.2, 0.0, 0.55, 0.6)$\n- Test $4$: $(250.0, 1.0, 0.02, 0.03, 0.9)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to a test case and is itself a list of four numbers in the order $[T_{\\text{base}}, D_{\\text{base}}, T_{\\text{buf}}, D_{\\text{buf}}]$. For example, the printed output should look like:\n$[[\\dots],[\\dots],[\\dots],[\\dots]]$\n\nAssumptions and constraints to respect in your derivation and implementation:\n- Use only the fundamental definition of the solution to first-order linear ordinary differential equations and the monotonicity of $I_{\\mathrm{KCa}}$ in $c$.\n- Do not introduce any phenomenological shortcuts beyond those implied by the model above.\n- Ensure all logarithms are well-defined by respecting $c_{\\mathrm{lo}}  c_{\\mathrm{on}}  c_{\\mathrm{off}}  c_{\\mathrm{hi}}$ in every test case.", "solution": "The problem statement has been subjected to rigorous validation. All provided information, including the differential equations for the calcium concentration $c$, the definitions of the thresholds $c_{\\mathrm{on}}$ and $c_{\\mathrm{off}}$, the parameter inequality $c_{\\mathrm{lo}}  c_{\\mathrm{on}}  c_{\\mathrm{off}}  c_{\\mathrm{hi}}$, and the test parameters, is self-contained, scientifically grounded in established biophysical modeling principles (fast-slow decomposition), and mathematically well-posed. The problem is free of contradictions, ambiguities, and non-formalizable elements. Therefore, the problem is deemed valid and a complete solution will be derived.\n\nThe task is to derive expressions for the active-phase duration $T_{\\mathrm{on}}$ and silent-phase duration $T_{\\mathrm{off}}$ from first principles.\n\nDerivation for Active-Phase Duration, $T_{\\mathrm{on}}$:\nDuring the active phase, the dynamics of the intracellular calcium concentration $c$ are governed by the first-order linear ordinary differential equation:\n$$\n\\frac{dc}{dt} = \\frac{c_{\\mathrm{hi}} - c}{\\tau_{\\mathrm{Ca}}}\n$$\nThis equation is separable. We rearrange the terms to integrate:\n$$\n\\int \\frac{1}{c_{\\mathrm{hi}} - c} , dc = \\int \\frac{1}{\\tau_{\\mathrm{Ca}}} , dt\n$$\nThe integration yields:\n$$\n-\\ln|c_{\\mathrm{hi}} - c| = \\frac{t}{\\tau_{\\mathrm{Ca}}} + K\n$$\nwhere $K$ is the constant of integration. Given the biophysical constraint $c  c_{\\mathrm{hi}}$ during the charging phase, the absolute value is unnecessary, so $|c_{\\mathrm{hi}} - c| = c_{\\mathrm{hi}} - c$. Rearranging for $c(t)$, we obtain the general solution:\n$$\n\\ln(c_{\\mathrm{hi}} - c) = -\\frac{t}{\\tau_{\\mathrm{Ca}}} - K\n$$\n$$\nc_{\\mathrm{hi}} - c = e^{-K} e^{-t/\\tau_{\\mathrm{Ca}}}\n$$\n$$\nc(t) = c_{\\mathrm{hi}} - A e^{-t/\\tau_{\\mathrm{Ca}}}\n$$\nwhere $A = e^{-K}$ is a new constant determined by the initial condition. The active phase begins at time $t=0$ when the calcium concentration is at the lower threshold, $c(0) = c_{\\mathrm{on}}$. Substituting this condition:\n$$\nc_{\\mathrm{on}} = c_{\\mathrm{hi}} - A e^{0} \\implies A = c_{\\mathrm{hi}} - c_{\\mathrm{on}}\n$$\nThus, the specific solution for the active phase is:\n$$\nc(t) = c_{\\mathrm{hi}} - (c_{\\mathrm{hi}} - c_{\\mathrm{on}}) e^{-t/\\tau_{\\mathrm{Ca}}}\n$$\nThe active phase terminates when the concentration reaches the upper threshold, $c(T_{\\mathrm{on}}) = c_{\\mathrm{off}}$. We solve for the duration $T_{\\mathrm{on}}$:\n$$\nc_{\\mathrm{off}} = c_{\\mathrm{hi}} - (c_{\\mathrm{hi}} - c_{\\mathrm{on}}) e^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{Ca}}}\n$$\n$$\n(c_{\\mathrm{hi}} - c_{\\mathrm{on}}) e^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{Ca}}} = c_{\\mathrm{hi}} - c_{\\mathrm{off}}\n$$\n$$\ne^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{Ca}}} = \\frac{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}\n$$\nTaking the natural logarithm of both sides:\n$$\n-\\frac{T_{\\mathrm{on}}}{\\tau_{\\mathrm{Ca}}} = \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}\\right)\n$$\nThe final expression for the active-phase duration is:\n$$\nT_{\\mathrm{on}} = -\\tau_{\\mathrm{Ca}} \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}\\right) = \\tau_{\\mathrm{Ca}} \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right)\n$$\nThe condition $c_{\\mathrm{on}}  c_{\\mathrm{off}}  c_{\\mathrm{hi}}$ ensures that the argument of the logarithm is greater than $1$, so $T_{\\mathrm{on}}$ is positive.\n\nDerivation for Silent-Phase Duration, $T_{\\mathrm{off}}$:\nDuring the silent phase, the governing equation for $c$ is:\n$$\n\\frac{dc}{dt} = \\frac{c_{\\mathrm{lo}} - c}{\\tau_{\\mathrm{Ca}}}\n$$\nThe structure of this equation is identical to that of the active phase. The general solution is therefore:\n$$\nc(t) = c_{\\mathrm{lo}} - B e^{-t/\\tau_{\\mathrm{Ca}}}\n$$\nwhere $B$ is a constant. The silent phase begins at time $t=0$ (we reset the clock for this phase) when the calcium concentration is at the upper threshold, $c(0) = c_{\\mathrm{off}}$. Substituting this initial condition:\n$$\nc_{\\mathrm{off}} = c_{\\mathrm{lo}} - B e^{0} \\implies B = c_{\\mathrm{lo}} - c_{\\mathrm{off}}\n$$\nThe specific solution for the silent phase is:\n$$\nc(t) = c_{\\mathrm{lo}} - (c_{\\mathrm{lo}} - c_{\\mathrm{off}}) e^{-t/\\tau_{\\mathrm{Ca}}} = c_{\\mathrm{lo}} + (c_{\\mathrm{off}} - c_{\\mathrm{lo}}) e^{-t/\\tau_{\\mathrm{Ca}}}\n$$\nThe silent phase terminates when the concentration decays back to the lower threshold, $c(T_{\\mathrm{off}}) = c_{\\mathrm{on}}$. We solve for the duration $T_{\\mathrm{off}}$:\n$$\nc_{\\mathrm{on}} = c_{\\mathrm{lo}} + (c_{\\mathrm{off}} - c_{\\mathrm{lo}}) e^{-T_{\\mathrm{off}}/\\tau_{\\mathrm{Ca}}}\n$$\n$$\nc_{\\mathrm{on}} - c_{\\mathrm{lo}} = (c_{\\mathrm{off}} - c_{\\mathrm{lo}}) e^{-T_{\\mathrm{off}}/\\tau_{\\mathrm{Ca}}}\n$$\n$$\ne^{-T_{\\mathrm{off}}/\\tau_{\\mathrm{Ca}}} = \\frac{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}\n$$\nTaking the natural logarithm of both sides:\n$$\n-\\frac{T_{\\mathrm{off}}}{\\tau_{\\mathrm{Ca}}} = \\ln\\left(\\frac{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}\\right)\n$$\nThe final expression for the silent-phase duration is:\n$$\nT_{\\mathrm{off}} = -\\tau_{\\mathrm{Ca}} \\ln\\left(\\frac{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}\\right) = \\tau_{\\mathrm{Ca}} \\ln\\left(\\frac{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}\\right)\n$$\nThe condition $c_{\\mathrm{lo}}  c_{\\mathrm{on}}  c_{\\mathrm{off}}$ ensures that the argument of the logarithm is greater than $1$, so $T_{\\mathrm{off}}$ is positive.\n\nCalculation of Burst Period ($T$) and Duty Cycle ($D$):\nThe total burst period $T$ is the sum of the active and silent phase durations:\n$$\nT = T_{\\mathrm{on}} + T_{\\mathrm{off}} = \\tau_{\\mathrm{Ca}} \\left[ \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right) + \\ln\\left(\\frac{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}\\right) \\right]\n$$\nThe duty cycle $D$ is the fraction of the period spent in the active phase:\n$$\nD = \\frac{T_{\\mathrm{on}}}{T} = \\frac{\\tau_{\\mathrm{Ca}} \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right)}{\\tau_{\\mathrm{Ca}} \\left[ \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right) + \\ln\\left(\\frac{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}\\right) \\right]}\n$$\nThe parameter $\\tau_{\\mathrm{Ca}}$ cancels, indicating that the duty cycle is independent of the calcium time constant and depends only on the concentration levels:\n$$\nD = \\frac{\\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right)}{\\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right) + \\ln\\left(\\frac{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}\\right)}\n$$\nFor the buffered condition, the time constant becomes $\\tau'_{\\mathrm{Ca}} = \\tau_{\\mathrm{Ca}}/2$. The new period $T_{\\text{buf}}$ will be half of the baseline period $T_{\\text{base}}$, since $T_{\\mathrm{on}}$ and $T_{\\mathrm{off}}$ are both directly proportional to $\\tau_{\\mathrm{Ca}}$. The new duty cycle $D_{\\text{buf}}$ will be identical to the baseline duty cycle $D_{\\text{base}}$, as it is independent of $\\tau_{\\mathrm{Ca}}$.\n\nThese derived formulae are implemented in the following program to compute the required values for the given test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the pacemaker neuron problem for a given set of test cases.\n    Derives burst period and duty cycle from first principles.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (tau_Ca, c_hi, c_lo, c_on, c_off)\n    test_cases = [\n        (200.0, 1.0, 0.05, 0.2, 0.8),\n        (150.0, 0.9, 0.1, 0.2, 0.7),\n        (100.0, 1.2, 0.0, 0.55, 0.6),\n        (250.0, 1.0, 0.02, 0.03, 0.9),\n    ]\n\n    # This function calculates the results for a single parameter set.\n    def calculate_metrics(tau_ca, c_hi, c_lo, c_on, c_off):\n        \"\"\"\n        Calculates and returns the list [T_base, D_base, T_buf, D_buf].\n        \n        Args:\n            tau_ca (float): Baseline calcium time constant in ms.\n            c_hi (float): Upper quasi-steady state concentration level.\n            c_lo (float): Lower quasi-steady state concentration level.\n            c_on (float): Lower threshold for spiking initiation.\n            c_off (float): Upper threshold for spiking termination.\n\n        Returns:\n            list: A list of four floats [T_base, D_base, T_buf, D_buf]\n                  rounded to 6 decimal places.\n        \"\"\"\n        # --- Baseline Calculation ---\n        # Active-phase duration\n        numerator_on = c_hi - c_on\n        denominator_on = c_hi - c_off\n        T_on_base = tau_ca * np.log(numerator_on / denominator_on)\n        \n        # Silent-phase duration\n        numerator_off = c_off - c_lo\n        denominator_off = c_on - c_lo\n        T_off_base = tau_ca * np.log(numerator_off / denominator_off)\n        \n        # Total period\n        T_base = T_on_base + T_off_base\n        \n        # Duty cycle\n        D_base = T_on_base / T_base\n        \n        # --- Buffered Condition Calculation ---\n        # In the buffered condition, tau_ca is halved.\n        # Since T is directly proportional to tau_ca, T_buf is half of T_base.\n        T_buf = T_base / 2.0\n        \n        # The duty cycle D is independent of tau_ca, so it remains unchanged.\n        D_buf = D_base\n        \n        # Return the results rounded to 6 decimal places as required.\n        return [\n            round(T_base, 6),\n            round(D_base, 6),\n            round(T_buf, 6),\n            round(D_buf, 6)\n        ]\n\n    results = []\n    # Process each test case\n    for case in test_cases:\n        tau_ca, c_hi, c_lo, c_on, c_off = case\n        \n        # Validate that the concentration thresholds are ordered correctly to prevent\n        # math domain errors (e.g., log of a non-positive number).\n        if not (c_lo  c_on  c_off  c_hi):\n             raise ValueError(f\"Invalid threshold ordering in case: {case}\")\n             \n        result = calculate_metrics(tau_ca, c_hi, c_lo, c_on, c_off)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2556980"}, {"introduction": "Moving from single cells to simple circuits, the half-center oscillator, formed by two mutually inhibiting neurons, is a canonical model for generating alternating motor patterns. This practice explores how the emergent properties of this minimal network depend critically on the biophysical nature of its synapses. You will analyze and compare how shunting inhibition, which primarily increases membrane conductance, versus hyperpolarizing inhibition, which drives the membrane potential to more negative values, differentially shape the CPG's oscillation amplitude and frequency [@problem_id:2556964].", "problem": "A pair of identical single-compartment neurons forms a reciprocal inhibitory half-center oscillator, a minimal model of a locomotor Central Pattern Generator (CPG). Each neuron obeys the passive membrane equation with ohmic synapses:\n$$C\\,\\frac{dV}{dt}=-g_L\\,(V-E_L)-g_{\\mathrm{inh}}(t)\\,\\big(V-E_{\\mathrm{rev}}\\big)+I_{\\mathrm{app}},$$\nwhere $C$ is the membrane capacitance, $g_L$ is the leak conductance with reversal $E_L$, $g_{\\mathrm{inh}}(t)$ is the inhibitory synaptic conductance that is high during the partner’s active phase and zero otherwise, $E_{\\mathrm{rev}}$ is the inhibitory synaptic reversal potential, and $I_{\\mathrm{app}}$ is a constant depolarizing drive representing tonic excitation from brainstem. When a neuron is not inhibited, its effective depolarized steady voltage under $I_{\\mathrm{app}}$ alone is $E_{\\mathrm{eff}}^{\\mathrm{exc}}$, and it emits a burst once it crosses a fixed spike threshold $V_{\\mathrm{th}}$. Assume that the active-phase duration is identical across conditions and that the inter-burst interval is dominated by the time the previously inhibited neuron takes to rise from its trough voltage up to $V_{\\mathrm{th}}$ after inhibition turns off.\n\nConsider two cases for the inhibitory synapse:\n- Shunting inhibition: $E_{\\mathrm{rev}}^{\\mathrm{sh}}=E_L$ (reversal near rest).\n- Hyperpolarizing inhibition: $E_{\\mathrm{rev}}^{\\mathrm{hyp}}\\ll E_L$ (reversal far below rest).\n\nUse the following physiologically plausible parameters for both neurons:\n- $C=100$ pF, $g_L=10$ nS, $E_L=-65$ mV.\n- During inhibition, $g_{\\mathrm{inh}}=50$ nS.\n- Depolarizing drive chosen such that under excitation alone $E_{\\mathrm{eff}}^{\\mathrm{exc}}=-45$ mV, with spike threshold $V_{\\mathrm{th}}=-50$ mV and typical peak during the active phase $V_{\\mathrm{peak}}=-40$ mV.\n- For hyperpolarizing inhibition, take $E_{\\mathrm{rev}}^{\\mathrm{hyp}}=-80$ mV; for shunting inhibition, $E_{\\mathrm{rev}}^{\\mathrm{sh}}=E_L=-65$ mV.\n\nStarting from the membrane equation and basic resistor–capacitor dynamics (no additional “shortcut” formulas), reason about the steady voltage reached during inhibition and the time course of the voltage after release from inhibition. Then determine, relative to hyperpolarizing inhibition, how shunting inhibition affects both the oscillation amplitude (here, take amplitude as $V_{\\mathrm{peak}}-V_{\\mathrm{trough}}$ per cycle for a given neuron) and the oscillation frequency.\n\nWhich option best describes the effect of shunting inhibition compared to hyperpolarizing inhibition in this CPG?\n\nA. Smaller oscillation amplitude and higher oscillation frequency, because shunting primarily increases total conductance (reducing input resistance and effective time constants) without producing a large hyperpolarizing shift, shortening the rise to threshold after release.\n\nB. Larger oscillation amplitude and lower oscillation frequency, because inhibition is strongest near rest for shunting synapses, driving larger excursions and slower escape from inhibition.\n\nC. Similar amplitude and frequency, because both forms add the same $g_{\\mathrm{inh}}$ during inhibition, so the dynamics are effectively unchanged.\n\nD. Smaller oscillation amplitude and lower oscillation frequency, because higher conductance during shunting slows the membrane’s voltage dynamics and prolongs the inter-burst interval.\n\nE. Larger oscillation amplitude and higher oscillation frequency, because shunting inhibition acts divisively on excitatory drive, amplifying burst peaks while speeding the rhythm.", "solution": "The problem statement will first be subjected to a rigorous validation procedure.\n\n### Step 1: Extract Givens\nThe explicit givens from the problem statement are:\n- The governing differential equation for the membrane potential $V$ of a single neuron:\n$$C\\,\\frac{dV}{dt}=-g_L\\,(V-E_L)-g_{\\mathrm{inh}}(t)\\,\\big(V-E_{\\mathrm{rev}}\\big)+I_{\\mathrm{app}}$$\n- Parameters for the neuron:\n  - Membrane capacitance, $C = 100 \\text{ pF}$\n  - Leak conductance, $g_L = 10 \\text{ nS}$\n  - Leak reversal potential, $E_L = -65 \\text{ mV}$\n  - Inhibitory synaptic conductance during inhibition, $g_{\\mathrm{inh}} = 50 \\text{ nS}$\n  - Constant applied current, $I_{\\mathrm{app}}$\n- Operational states and thresholds:\n  - Effective steady-state voltage under excitation alone ($g_{\\mathrm{inh}}=0$), $E_{\\mathrm{eff}}^{\\mathrm{exc}} = -45 \\text{ mV}$\n  - Spike threshold, $V_{\\mathrm{th}} = -50 \\text{ mV}$\n  - Peak voltage during the active phase, $V_{\\mathrm{peak}} = -40 \\text{ mV}$\n- Cases for inhibitory synaptic reversal potential, $E_{\\mathrm{rev}}$:\n  - Shunting inhibition: $E_{\\mathrm{rev}}^{\\mathrm{sh}} = E_L = -65 \\text{ mV}$\n  - Hyperpolarizing inhibition: $E_{\\mathrm{rev}}^{\\mathrm{hyp}} = -80 \\text{ mV}$\n- Assumptions for analysis:\n  - Active-phase duration is identical across conditions.\n  - The inter-burst interval is dominated by the time for the membrane potential to rise from its trough, $V_{\\mathrm{trough}}$, to the threshold, $V_{\\mathrm{th}}$, after inhibition is released.\n- Definitions for comparison:\n  - Oscillation amplitude is defined as $V_{\\mathrm{peak}} - V_{\\mathrm{trough}}$.\n  - Oscillation frequency, $f$, is inversely related to the period, which is primarily determined by the inter-burst interval.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded**: The problem uses the standard passive membrane model with synaptic currents, a fundamental tool in computational neuroscience and biophysics. The concept of a half-center oscillator built from reciprocal inhibition is a classic and valid model for central pattern generators. All parameters are within physiologically plausible ranges. The distinction between shunting and hyperpolarizing inhibition is a core concept in synaptic physiology.\n- **Well-Posed**: The problem is clearly defined. It provides all necessary parameters and a single governing equation. The question asks for a comparative analysis of two well-defined scenarios (shunting vs. hyperpolarizing inhibition) based on derivable quantities (amplitude and frequency). A unique solution can be derived from the provided information.\n- **Objective**: The problem is stated in precise, quantitative, and objective language. It is free of ambiguity, subjective claims, or non-scientific metaphors.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a standard, well-posed problem in theoretical neuroscience that is grounded in established biophysical principles. An analytical solution can be derived. Proceeding to solution derivation.\n\n### Solution Derivation\n\nThe analysis proceeds in three stages:\n1.  Determine the constant applied current $I_{\\mathrm{app}}$.\n2.  Calculate the trough voltage $V_{\\mathrm{trough}}$ during the inhibitory phase for both shunting and hyperpolarizing cases.\n3.  Calculate the rise time from $V_{\\mathrm{trough}}$ to $V_{\\mathrm{th}}$ after inhibition release for both cases.\n4.  Compare the resulting oscillation amplitudes and frequencies.\n\n**1. Calculation of the Applied Current, $I_{\\mathrm{app}}$**\n\nThe problem states that when the neuron is under excitation alone ($g_{\\mathrm{inh}} = 0$), its potential settles at a steady-state value $E_{\\mathrm{eff}}^{\\mathrm{exc}} = -45 \\text{ mV}$. At steady state, $\\frac{dV}{dt} = 0$. The membrane equation becomes:\n$$0 = -g_L (E_{\\mathrm{eff}}^{\\mathrm{exc}} - E_L) + I_{\\mathrm{app}}$$\nSolving for $I_{\\mathrm{app}}$:\n$$I_{\\mathrm{app}} = g_L (E_{\\mathrm{eff}}^{\\mathrm{exc}} - E_L)$$\nSubstituting the given values:\n$$I_{\\mathrm{app}} = (10 \\times 10^{-9} \\text{ S}) \\times (-45 \\times 10^{-3} \\text{ V} - (-65 \\times 10^{-3} \\text{ V}))$$\n$$I_{\\mathrm{app}} = (10 \\times 10^{-9} \\text{ S}) \\times (20 \\times 10^{-3} \\text{ V}) = 200 \\times 10^{-12} \\text{ A} = 200 \\text{ pA}$$\nThis constant depolarizing current $I_{\\mathrm{app}}=200 \\text{ pA}$ is present in all conditions.\n\n**2. Calculation of the Trough Voltage, $V_{\\mathrm{trough}}$**\n\nDuring the inhibitory phase, the neuron is held below threshold. Its voltage settles to a steady-state trough value, $V_{\\mathrm{trough}}$. Here, $g_{\\mathrm{inh}} = 50 \\text{ nS}$ and $\\frac{dV}{dt} = 0$. The membrane equation is:\n$$0 = -g_L(V_{\\mathrm{trough}}-E_L)-g_{\\mathrm{inh}}(V_{\\mathrm{trough}}-E_{\\mathrm{rev}})+I_{\\mathrm{app}}$$\nSolving for $V_{\\mathrm{trough}}$:\n$$V_{\\mathrm{trough}}(g_L + g_{\\mathrm{inh}}) = g_L E_L + g_{\\mathrm{inh}} E_{\\mathrm{rev}} + I_{\\mathrm{app}}$$\n$$V_{\\mathrm{trough}} = \\frac{g_L E_L + g_{\\mathrm{inh}} E_{\\mathrm{rev}} + I_{\\mathrm{app}}}{g_L + g_{\\mathrm{inh}}}$$\n\n- **Case 1: Hyperpolarizing inhibition** ($E_{\\mathrm{rev}}^{\\mathrm{hyp}} = -80 \\text{ mV}$)\n$$V_{\\mathrm{trough}}^{\\mathrm{hyp}} = \\frac{(10 \\text{ nS})(-65 \\text{ mV}) + (50 \\text{ nS})(-80 \\text{ mV}) + 200 \\text{ pA}}{10 \\text{ nS} + 50 \\text{ nS}}$$\n$$V_{\\mathrm{trough}}^{\\mathrm{hyp}} = \\frac{-650 - 4000 + 200}{60} \\text{ mV} = \\frac{-4450}{60} \\text{ mV} \\approx -74.17 \\text{ mV}$$\n\n- **Case 2: Shunting inhibition** ($E_{\\mathrm{rev}}^{\\mathrm{sh}} = -65 \\text{ mV}$)\n$$V_{\\mathrm{trough}}^{\\mathrm{sh}} = \\frac{(10 \\text{ nS})(-65 \\text{ mV}) + (50 \\text{ nS})(-65 \\text{ mV}) + 200 \\text{ pA}}{10 \\text{ nS} + 50 \\text{ nS}}$$\n$$V_{\\mathrm{trough}}^{\\mathrm{sh}} = \\frac{(60 \\text{ nS})(-65 \\text{ mV}) + 200 \\text{ pA}}{60 \\text{ nS}} = -65 \\text{ mV} + \\frac{200 \\text{ pA}}{60 \\text{ nS}} = -65 + \\frac{20}{6} \\text{ mV}$$\n$$V_{\\mathrm{trough}}^{\\mathrm{sh}} = -65 + 3.33... \\text{ mV} \\approx -61.67 \\text{ mV}$$\n\n**Comparison of Oscillation Amplitudes**\n\nAmplitude is defined as $A = V_{\\mathrm{peak}} - V_{\\mathrm{trough}}$. Given $V_{\\mathrm{peak}} = -40 \\text{ mV}$:\n- Amplitude with hyperpolarizing inhibition: $A^{\\mathrm{hyp}} = -40 \\text{ mV} - (-74.17 \\text{ mV}) = 34.17 \\text{ mV}$\n- Amplitude with shunting inhibition: $A^{\\mathrm{sh}} = -40 \\text{ mV} - (-61.67 \\text{ mV}) = 21.67 \\text{ mV}$\n\nClearly, $A^{\\mathrm{sh}}  A^{\\mathrm{hyp}}$. Shunting inhibition produces a **smaller oscillation amplitude**.\n\n**3. Calculation of the Inter-burst Interval (Rise Time)**\n\nAfter inhibition is released, $g_{\\mathrm{inh}} = 0$. The neuron's voltage evolves according to:\n$$C\\,\\frac{dV}{dt}=-g_L\\,(V-E_L) + I_{\\mathrm{app}} = -g_L (V - (E_L + I_{\\mathrm{app}}/g_L))$$\nWe recognize the term in the parenthesis as $E_{\\mathrm{eff}}^{\\mathrm{exc}} = -45 \\text{ mV}$. So,\n$$C\\,\\frac{dV}{dt}=-g_L\\,(V-E_{\\mathrm{eff}}^{\\mathrm{exc}})$$\nThis is a first-order linear ordinary differential equation with time constant $\\tau_m = C/g_L$.\n$$\\tau_m = \\frac{100 \\text{ pF}}{10 \\text{ nS}} = \\frac{100 \\times 10^{-12} \\text{ F}}{10 \\times 10^{-9} \\text{ S}} = 10 \\times 10^{-3} \\text{ s} = 10 \\text{ ms}$$\nThe solution is $V(t) = E_{\\mathrm{eff}}^{\\mathrm{exc}} + (V(0) - E_{\\mathrm{eff}}^{\\mathrm{exc}}) e^{-t/\\tau_m}$.\nWe need to find the time $t_{\\mathrm{rise}}$ to go from the initial voltage $V(0) = V_{\\mathrm{trough}}$ to the final voltage $V(t_{\\mathrm{rise}}) = V_{\\mathrm{th}}$.\n$$V_{\\mathrm{th}} = E_{\\mathrm{eff}}^{\\mathrm{exc}} + (V_{\\mathrm{trough}} - E_{\\mathrm{eff}}^{\\mathrm{exc}}) e^{-t_{\\mathrm{rise}}/\\tau_m}$$\n$$\\frac{V_{\\mathrm{th}} - E_{\\mathrm{eff}}^{\\mathrm{exc}}}{V_{\\mathrm{trough}} - E_{\\mathrm{eff}}^{\\mathrm{exc}}} = e^{-t_{\\mathrm{rise}}/\\tau_m}$$\n$$t_{\\mathrm{rise}} = -\\tau_m \\ln{\\left(\\frac{V_{\\mathrm{th}} - E_{\\mathrm{eff}}^{\\mathrm{exc}}}{V_{\\mathrm{trough}} - E_{\\mathrm{eff}}^{\\mathrm{exc}}}\\right)} = \\tau_m \\ln{\\left(\\frac{V_{\\mathrm{trough}} - E_{\\mathrm{eff}}^{\\mathrm{exc}}}{V_{\\mathrm{th}} - E_{\\mathrm{eff}}^{\\mathrm{exc}}}\\right)}$$\nThe denominator is constant: $V_{\\mathrm{th}} - E_{\\mathrm{eff}}^{\\mathrm{exc}} = -50 \\text{ mV} - (-45 \\text{ mV}) = -5 \\text{ mV}$.\n\n- **Case 1: Hyperpolarizing inhibition**\n$$t_{\\mathrm{rise}}^{\\mathrm{hyp}} = (10 \\text{ ms}) \\ln{\\left(\\frac{-74.17 - (-45)}{-5}\\right)} = (10 \\text{ ms}) \\ln{\\left(\\frac{-29.17}{-5}\\right)} \\approx 10 \\ln(5.834) \\approx 17.6 \\text{ ms}$$\n\n- **Case 2: Shunting inhibition**\n$$t_{\\mathrm{rise}}^{\\mathrm{sh}} = (10 \\text{ ms}) \\ln{\\left(\\frac{-61.67 - (-45)}{-5}\\right)} = (10 \\text{ ms}) \\ln{\\left(\\frac{-16.67}{-5}\\right)} \\approx 10 \\ln(3.334) \\approx 12.0 \\text{ ms}$$\n\n**Comparison of Oscillation Frequencies**\n\nThe oscillation period is $T = t_{\\mathrm{active}} + t_{\\mathrm{rise}}$. The problem states $t_{\\mathrm{active}}$ is constant. Our calculation shows $t_{\\mathrm{rise}}^{\\mathrm{sh}}  t_{\\mathrm{rise}}^{\\mathrm{hyp}}$.\nTherefore, the total period for shunting inhibition is shorter than for hyperpolarizing inhibition: $T^{\\mathrm{sh}}  T^{\\mathrm{hyp}}$.\nSince frequency $f = 1/T$, it follows that $f^{\\mathrm{sh}}  f^{\\mathrm{hyp}}$. Shunting inhibition produces a **higher oscillation frequency**.\n\n### Summary and Evaluation of Options\n\nCompared to hyperpolarizing inhibition, shunting inhibition results in a **smaller amplitude** and a **higher frequency**.\n\nNow, we evaluate each option:\n\n**A. Smaller oscillation amplitude and higher oscillation frequency, because shunting primarily increases total conductance (reducing input resistance and effective time constants) without producing a large hyperpolarizing shift, shortening the rise to threshold after release.**\n- `Smaller oscillation amplitude`: Correct.\n- `higher oscillation frequency`: Correct.\n- `Reasoning`: The reasoning is entirely correct. Shunting inhibition increases the total conductance $g_L+g_{inh}$, which clamps the voltage near $E_{\\mathrm{rev}}^{\\mathrm{sh}}$, preventing a deep hyperpolarization. This \"trough\" voltage is thus higher (less negative) and closer to the spike threshold $V_{\\mathrm{th}}$. Consequently, the time required to reach threshold upon release from inhibition is shorter, leading to a faster rhythm. The smaller voltage difference between peak and trough results in a smaller amplitude.\n- **Verdict: Correct.**\n\n**B. Larger oscillation amplitude and lower oscillation frequency, because inhibition is strongest near rest for shunting synapses, driving larger excursions and slower escape from inhibition.**\n- `Larger oscillation amplitude`: Incorrect. The amplitude is smaller.\n- `lower oscillation frequency`: Incorrect. The frequency is higher.\n- `Reasoning`: The reasoning is flawed. Clamping the voltage near rest (as shunting does) *prevents* large excursions, it does not drive them.\n- **Verdict: Incorrect.**\n\n**C. Similar amplitude and frequency, because both forms add the same $g_{\\mathrm{inh}}$ during inhibition, so the dynamics are effectively unchanged.**\n- `Similar amplitude and frequency`: Incorrect.\n- `Reasoning`: This is a fundamental error. While $g_{\\mathrm{inh}}$ is the same, the synaptic reversal potential $E_{\\mathrm{rev}}$ is different, which profoundly changes the synaptic current $I_{\\mathrm{syn}} = g_{\\mathrm{inh}}(V - E_{\\mathrm{rev}})$ and thus the steady-state voltage during inhibition.\n- **Verdict: Incorrect.**\n\n**D. Smaller oscillation amplitude and lower oscillation frequency, because higher conductance during shunting slows the membrane’s voltage dynamics and prolongs the inter-burst interval.**\n- `Smaller oscillation amplitude`: Correct.\n- `lower oscillation frequency`: Incorrect. The frequency is higher.\n- `Reasoning`: The reasoning is incorrect. A higher conductance $g$ leads to a smaller membrane time constant $\\tau = C/g$, which means the membrane voltage changes *faster*, not slower.\n- **Verdict: Incorrect.**\n\n**E. Larger oscillation amplitude and higher oscillation frequency, because shunting inhibition acts divisively on excitatory drive, amplifying burst peaks while speeding the rhythm.**\n- `Larger oscillation amplitude`: Incorrect.\n- `higher oscillation frequency`: Correct.\n- `Reasoning`: The reasoning about \"amplifying burst peaks\" is false. Inhibition, by definition, counteracts excitation; it does not amplify peaks. The amplitude is reduced.\n- **Verdict: Incorrect.**\n\nOnly option A is fully consistent with the derived results and provides a correct physical explanation.", "answer": "$$\\boxed{A}$$", "id": "2556964"}, {"introduction": "Biological synapses are not static links; their efficacy changes dynamically with neuronal activity. This advanced practice introduces short-term synaptic depression as a crucial mechanism for robust CPG function, particularly for burst termination. By constructing and simulating a half-center oscillator with depressing synapses, you will gain hands-on experience with how this activity-dependent mechanism provides an elegant, self-regulating solution for controlling burst duration and stabilizing the overall network rhythm [@problem_id:2557001].", "problem": "You are to construct and analyze a symmetric half-center oscillator composed of two reciprocally inhibiting neuronal units connected by synapses that exhibit short-term synaptic depression. Your task is to start from mechanistic, conservation-based principles of synaptic resource dynamics and first-order low-pass neuronal rate dynamics, derive a closed system of ordinary differential equations, simulate it numerically, and quantify how short-term synaptic depression controls burst termination and the interburst interval.\n\nFundamental bases to be used:\n- Conservation of synaptic resources: a finite resource pool that recovers toward its maximum and is depleted by presynaptic activity.\n- First-order low-pass neuronal rate dynamics that relax toward a static input-output nonlinearity of net synaptic input.\n- Sigmoidal firing rate nonlinearity for the static input-output function.\n\nModeling requirements:\n1. Consider two identical neuronal units indexed by $i \\in \\{1,2\\}$ with presynaptic partner $j \\neq i$. Let $r_i(t)$ denote the firing rate of unit $i$ in $\\mathrm{s}^{-1}$, and let $x_i(t)$ denote the fraction of available synaptic resources at the inhibitory synapse from unit $i$ to its partner. Let $u \\in [0,1]$ be the constant utilization fraction per unit presynaptic activity (dimensionless). The total available resource is normalized to $1$.\n\n2. Begin from the following principles to derive the synaptic resource dynamics:\n   - Resources recover toward $1$ with a time constant $\\tau_{\\mathrm{rec}}$ (in $\\mathrm{s}$), contributing a term $(1 - x_i)/\\tau_{\\mathrm{rec}}$.\n   - Resources are depleted proportionally to instantaneous presynaptic activity and currently available resource, contributing a term proportional to $u \\, x_i \\, r_i$.\n   Combine these principles into a single differential equation for $x_i(t)$.\n\n3. For the neuronal output dynamics, use a first-order relaxation toward a static nonlinearity $F(h_i)$ with time constant $\\tau_r$ (in $\\mathrm{s}$):\n   $$\\tau_r \\, \\frac{d r_i}{dt} = - r_i + F\\!\\left(h_i\\right).$$\n   The input $h_i$ is the difference between a constant tonic drive $I_0$ (dimensionless) and synaptic inhibition arriving from the other unit. The effective inhibitory output from unit $j$ must be proportional to the product of utilization, available resources, and presynaptic rate, giving an effective inhibitory drive $y_j(t)$ that should be derived from the principles in item 2. Express $h_i$ accordingly as $h_i = I_0 - w \\, y_j$, with $w  0$ a dimensionless inhibitory coupling strength.\n\n4. For the static input-output nonlinearity, use a sigmoidal firing rate function with saturation at $r_{\\max}$:\n   $$F(h) = \\frac{r_{\\max}}{1 + \\exp\\!\\left(-a \\, (h - \\theta)\\right)},$$\n   where $a  0$ is the slope parameter (dimensionless) and $\\theta$ is the threshold (dimensionless).\n\n5. Simulation and measurements:\n   - Integrate the model numerically using a fixed time step $\\Delta t$ and forward Euler method for a total duration $T_{\\mathrm{sim}}$ (both in $\\mathrm{s}$). Use initial conditions that break symmetry minimally (for example, slightly different initial firing rates).\n   - Define the activity difference $\\Delta(t) = r_1(t) - r_2(t)$. A burst of unit $1$ begins when $\\Delta(t)$ crosses from negative to positive (up-crossing), and ends when it crosses from positive to negative (down-crossing). By symmetry, the same applies with roles reversed for unit $2$.\n   - Interburst interval (IBI) for unit $1$ is defined as the time between consecutive up-crossings of $\\Delta(t)$. Report the mean IBI over the last few cycles after discarding an initial transient. The IBI must be reported in $\\mathrm{s}$ as a floating-point number rounded to three decimal places.\n   - Burst termination is driven by depression at the active synapse. At each crossing of $\\Delta(t)$, record the value of $x_k(t^-)$ at the neuron $k$ that is currently active just before the sign change, where $t^-$ denotes the time immediately before the crossing. Average these recorded values over the same cycles used for IBI, and report the mean $x$ at termination rounded to three decimal places (dimensionless).\n   - If the system does not exhibit alternating bursts (for example, fewer than two up-crossings of $\\Delta(t)$ after transient), report both the IBI and the mean $x$ at termination as $0.0$.\n\n6. Use the following fixed parameters unless varied in the test cases:\n   - $r_{\\max} = 100 \\ \\mathrm{s}^{-1}$, $a = 4.0$, $\\theta = 1.0$, $I_0 = 1.3$, $w = 3.0$.\n   - $\\tau_r = 0.02 \\ \\mathrm{s}$, $\\Delta t = 0.001 \\ \\mathrm{s}$, $T_{\\mathrm{sim}} = 20.0 \\ \\mathrm{s}$.\n   - Initial conditions: $r_1(0) = 2.0 \\ \\mathrm{s}^{-1}$, $r_2(0) = 1.0 \\ \\mathrm{s}^{-1}$, $x_1(0) = x_2(0) = 1.0$.\n\n7. Test suite:\n   For each test case, vary $(\\tau_{\\mathrm{rec}}, u)$ as specified, using the fixed parameters above. For each case, simulate and produce a pair of outputs: the mean interburst interval in $\\mathrm{s}$ and the mean $x$ at termination (dimensionless), both rounded to three decimal places. The test cases are:\n   - Case A (happy path): $\\tau_{\\mathrm{rec}} = 0.5 \\ \\mathrm{s}$, $u = 0.5$.\n   - Case B (slow recovery): $\\tau_{\\mathrm{rec}} = 1.5 \\ \\mathrm{s}$, $u = 0.5$.\n   - Case C (weaker, faster dynamics): $\\tau_{\\mathrm{rec}} = 0.3 \\ \\mathrm{s}$, $u = 0.3$.\n   - Case D (no depression edge case): $\\tau_{\\mathrm{rec}} = 0.5 \\ \\mathrm{s}$, $u = 0.0$.\n\nFinal output format:\nYour program should produce a single line of output containing a list of four items, one per test case, where each item is itself a two-element list of floats in the order [mean_IBI_in_seconds, mean_x_at_termination]. The output must be printed exactly as a comma-separated list enclosed in square brackets, for example:\n[[ibi_A,xterm_A],[ibi_B,xterm_B],[ibi_C,xterm_C],[ibi_D,xterm_D]]\nAll times must be in $\\mathrm{s}$ and rounded to three decimal places with standard rounding rules. If alternating bursts are not detected for a case, print [0.0,0.0] for that case.", "solution": "The problem statement is a valid exercise in computational neuroscience. It is scientifically grounded in established principles of neuronal and synaptic dynamics, well-posed with all necessary equations and parameters defined, and objective in its formulation. We will proceed by first deriving the complete system of differential equations, then describing the numerical simulation and analysis a-priori, and finally executing the simulation for the specified test cases.\n\n**1. Derivation of the Model Equations**\n\nThe system consists of two identical, reciprocally inhibitory neuronal units, indexed by $i \\in \\{1, 2\\}$, with the presynaptic partner of unit $i$ denoted by $j \\neq i$. The state of the system is described by four variables: the firing rates $r_1(t)$ and $r_2(t)$, and the fractions of available synaptic resources $x_1(t)$ and $x_2(t)$.\n\n**Synaptic Resource Dynamics:**\nThe dynamics of the available synaptic resource fraction, $x_i(t)$, for neuron $i$ are governed by two competing processes: recovery and depletion.\n-   Recovery: The resource pool replenishes towards its maximum normalized value of $1$. This is modeled as a first-order process with time constant $\\tau_{\\mathrm{rec}}$, contributing a term $\\frac{1 - x_i(t)}{\\tau_{\\mathrm{rec}}}$.\n-   Depletion: Resources are consumed by presynaptic activity. The rate of consumption is proportional to the presynaptic firing rate $r_i(t)$, the amount of available resources $x_i(t)$, and the utilization factor $u$. This contributes a term $-u \\, x_i(t) \\, r_i(t)$.\n\nCombining these gives the differential equation for the synaptic resource fraction:\n$$\n\\frac{dx_i}{dt} = \\frac{1 - x_i}{\\tau_{\\mathrm{rec}}} - u \\, x_i \\, r_i\n$$\nThis equation holds for $i=1$ and $i=2$.\n\n**Neuronal Firing Rate Dynamics:**\nThe firing rate of each neuron, $r_i(t)$, relaxes towards a value determined by its net input, $h_i(t)$. This is modeled as a first-order low-pass filter with a time constant $\\tau_r$:\n$$\n\\tau_r \\frac{dr_i}{dt} = -r_i + F(h_i)\n$$\nwhere $F(h_i)$ is the static input-output function.\n\nThe net input $h_i$ to neuron $i$ is the sum of a constant external drive $I_0$ and the synaptic inhibition from neuron $j$. The problem specifies that the effective inhibitory drive from neuron $j$, let us call it $I_{syn, j}$, is proportional to the product of utilization $u$, available resources $x_j$, and presynaptic rate $r_j$. Thus, $I_{syn, j}(t) = u \\, x_j(t) \\, r_j(t)$. The total input to neuron $i$ is then:\n$$\nh_i(t) = I_0 - w \\, I_{syn, j}(t) = I_0 - w \\, u \\, x_j(t) \\, r_j(t)\n$$\nwhere $w$ is the dimensionless synaptic coupling strength.\n\nThe static input-output function $F(h)$ is given as a sigmoidal function:\n$$\nF(h) = \\frac{r_{\\max}}{1 + \\exp(-a(h - \\theta))}\n$$\nwhere $r_{\\max}$ is the maximum firing rate, $a$ is the slope, and $\\theta$ is the threshold.\n\n**Complete System of Ordinary Differential Equations (ODEs):**\nThe full model is a system of four coupled nonlinear ODEs describing the evolution of $(r_1, r_2, x_1, x_2)$:\n$$\n\\frac{dr_1}{dt} = \\frac{1}{\\tau_r} \\left( -r_1 + \\frac{r_{\\max}}{1 + \\exp(-a(I_0 - w \\, u \\, x_2 \\, r_2 - \\theta))} \\right)\n$$\n$$\n\\frac{dr_2}{dt} = \\frac{1}{\\tau_r} \\left( -r_2 + \\frac{r_{\\max}}{1 + \\exp(-a(I_0 - w \\, u \\, x_1 \\, r_1 - \\theta))} \\right)\n$$\n$$\n\\frac{dx_1}{dt} = \\frac{1 - x_1}{\\tau_{\\mathrm{rec}}} - u \\, x_1 \\, r_1\n$$\n$$\n\\frac{dx_2}{dt} = \\frac{1 - x_2}{\\tau_{\\mathrm{rec}}} - u \\, x_2 \\, r_2\n$$\n\n**2. Numerical Simulation and Analysis**\n\nWe will integrate this system using the forward Euler method with a fixed time step $\\Delta t$. For a generic state variable $y(t)$ with dynamics $\\frac{dy}{dt} = f(y, t)$, the update rule is:\n$$\ny(t + \\Delta t) = y(t) + \\Delta t \\cdot f(y(t), t)\n$$\nThis rule is applied at each time step for all four state variables. To ensure physical constraints are met, the firing rates $r_i$ will be clipped at $0$ (i.e., $r_i = \\max(0, r_i)$) and resource fractions $x_i$ will be clipped to the interval $[0, 1]$ after each update step.\n\nThe simulation runs for a total duration $T_{\\mathrm{sim}}$. The initial conditions are set to break the symmetry and initiate oscillations: $r_1(0) = 2.0 \\ \\mathrm{s}^{-1}$, $r_2(0) = 1.0 \\ \\mathrm{s}^{-1}$, and $x_1(0) = x_2(0) = 1.0$.\n\nAfter the simulation, we analyze the resulting time series to compute the required metrics. An initial transient period covering the first half of the simulation ($t \\in [0, T_{\\mathrm{sim}}/2]$) is discarded to ensure measurements are taken from the steady-state oscillatory behavior.\n\n-   **Activity Difference:** We compute $\\Delta(t) = r_1(t) - r_2(t)$.\n-   **Event Detection:** We identify all time points where $\\Delta(t)$ crosses zero. A crossing occurs between time steps $t_k = k \\Delta t$ and $t_{k+1}$ if $\\Delta(t_k) \\cdot \\Delta(t_{k+1})  0$.\n    -   An **up-crossing** (start of a burst for unit $1$) occurs if $\\Delta(t_k)  0$ and $\\Delta(t_{k+1}) \\geq 0$.\n    -   A **down-crossing** (end of a burst for unit $1$) occurs if $\\Delta(t_k)  0$ and $\\Delta(t_{k+1}) \\leq 0$.\n-   **Interburst Interval (IBI):** We find all up-crossing times $t_{up}$ that occur after the transient period. The IBIs are the time differences between consecutive up-crossings. The mean of these IBIs is computed. If fewer than two up-crossings are found in the analysis window, no IBI can be calculated, and the mean IBI is reported as $0.0$.\n-   **Synaptic Resource at Termination ($x_{\\mathrm{term}}$):** At each zero-crossing time $t_k$ after the transient, we record the resource level of the neuron that was just active. The value at $t_k^- \\approx t_k$ is used.\n    -   If $\\Delta(t_k)  0$ (a down-crossing), unit $1$ was active. We record $x_1(t_k)$.\n    -   If $\\Delta(t_k)  0$ (an up-crossing), unit $2$ was active. We record $x_2(t_k)$.\n    The mean of these recorded resource values is computed. If no crossings occur in the analysis window, the mean value is reported as $0.0$.\n\nThe special case where $u=0$ (Case D) corresponds to uncoupled neurons. In this scenario, the inhibitory term $w \\, u \\, x_j \\, r_j$ is zero, and both neurons will independently converge to a stable steady state given by $r^* = F(I_0)$. No oscillations will occur, so $\\Delta(t)$ will not cross zero. This correctly yields an IBI and $x_{\\mathrm{term}}$ of $0.0$.\n\nThe described procedure is implemented for each test case to produce the final results.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print results.\n    \"\"\"\n\n    # Fixed parameters as specified in the problem statement.\n    r_max = 100.0  # s^-1\n    a = 4.0      # dimensionless\n    theta = 1.0  # dimensionless\n    I_0 = 1.3    # dimensionless\n    w = 3.0      # dimensionless\n    tau_r = 0.02   # s\n    dt = 0.001   # s\n    T_sim = 20.0   # s\n\n    # Initial conditions.\n    r1_0 = 2.0  # s^-1\n    r2_0 = 1.0  # s^-1\n    x1_0 = 1.0  # dimensionless\n    x2_0 = 1.0  # dimensionless\n\n    # Test cases: (tau_rec, u)\n    test_cases = [\n        (0.5, 0.5),  # Case A\n        (1.5, 0.5),  # Case B\n        (0.3, 0.3),  # Case C\n        (0.5, 0.0),  # Case D\n    ]\n\n    all_results = []\n\n    for tau_rec, u in test_cases:\n        # Number of time steps\n        num_steps = int(T_sim / dt)\n        \n        # State variable arrays\n        r1 = np.zeros(num_steps)\n        r2 = np.zeros(num_steps)\n        x1 = np.zeros(num_steps)\n        x2 = np.zeros(num_steps)\n        t = np.linspace(0, T_sim, num_steps)\n\n        # Set initial conditions\n        r1[0] = r1_0\n        r2[0] = r2_0\n        x1[0] = x1_0\n        x2[0] = x2_0\n\n        # Static sigmoidal nonlinearity F(h)\n        def F(h):\n            return r_max / (1.0 + np.exp(-a * (h - theta)))\n\n        # Forward Euler integration loop\n        for k in range(num_steps - 1):\n            # Calculate inputs to each neuron\n            h1 = I_0 - w * u * x2[k] * r2[k]\n            h2 = I_0 - w * u * x1[k] * r1[k]\n\n            # Calculate derivatives\n            dr1_dt = (-r1[k] + F(h1)) / tau_r\n            dr2_dt = (-r2[k] + F(h2)) / tau_r\n            dx1_dt = (1.0 - x1[k]) / tau_rec - u * x1[k] * r1[k]\n            dx2_dt = (1.0 - x2[k]) / tau_rec - u * x2[k] * r2[k]\n\n            # Update state variables\n            r1[k+1] = r1[k] + dt * dr1_dt\n            r2[k+1] = r2[k] + dt * dr2_dt\n            x1[k+1] = x1[k] + dt * dx1_dt\n            x2[k+1] = x2[k] + dt * dx2_dt\n\n            # Apply physical constraints (clipping)\n            r1[k+1] = max(0.0, r1[k+1])\n            r2[k+1] = max(0.0, r2[k+1])\n            x1[k+1] = np.clip(x1[k+1], 0.0, 1.0)\n            x2[k+1] = np.clip(x2[k+1], 0.0, 1.0)\n\n        # Analysis of results\n        delta = r1 - r2\n        \n        # Find all zero-crossings\n        # np.diff(np.sign(delta)) is non-zero at crossings\n        crossings_indices = np.where(np.diff(np.sign(delta)))[0]\n\n        # Define transient discard time\n        analysis_start_time = T_sim / 2.0\n        \n        # Find up-crossings (delta changes from - to +)\n        # This means delta[k]  0 and delta[k+1]  0\n        up_crossing_indices = crossings_indices[delta[crossings_indices]  0]\n        up_crossing_times = t[up_crossing_indices]\n\n        # Filter events after transient period\n        valid_up_crossing_times = up_crossing_times[up_crossing_times  analysis_start_time]\n\n        # Calculate mean IBI\n        if len(valid_up_crossing_times) = 2:\n            ibis = np.diff(valid_up_crossing_times)\n            mean_ibi = np.mean(ibis)\n        else:\n            mean_ibi = 0.0\n\n        # Calculate mean x at termination\n        term_x_values = []\n        valid_crossings_indices = crossings_indices[t[crossings_indices]  analysis_start_time]\n\n        for idx in valid_crossings_indices:\n            # If delta[idx]  0, it means the crossing is from + to -, so neuron 1 was active\n            if delta[idx]  0:\n                term_x_values.append(x1[idx])\n            # If delta[idx]  0, it means the crossing is from - to +, so neuron 2 was active\n            else:\n                term_x_values.append(x2[idx])\n\n        if term_x_values:\n            mean_x_term = np.mean(term_x_values)\n        else:\n            mean_x_term = 0.0\n\n        #\n        # A special check for the case of no oscillations at all\n        # If fewer than 2 total up-crossings, it is non-oscillatory.\n        if len(up_crossing_times)  2:\n            mean_ibi = 0.0\n            mean_x_term = 0.0\n\n        all_results.append([round(mean_ibi, 3), round(mean_x_term, 3)])\n\n    # Format final output as a list of lists\n    output_str = \"[\" + \",\".join([f\"[{ibi},{x}]\" for ibi, x in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2557001"}]}