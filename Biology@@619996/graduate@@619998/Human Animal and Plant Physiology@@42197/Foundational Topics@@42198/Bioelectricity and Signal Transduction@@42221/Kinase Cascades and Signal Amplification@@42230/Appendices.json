{"hands_on_practices": [{"introduction": "We begin our exploration with a fascinating and counter-intuitive phenomenon observed in cancer therapy: paradoxical activation. While we expect an inhibitor to suppress a signaling pathway, under certain conditions involving feedback loops, a kinase inhibitor can actually increase the activity of its downstream target [@problem_id:2576903]. This practice will guide you through a steady-state analysis to derive the precise mathematical conditions under which this paradoxical effect occurs, demonstrating how systems-level analysis can uncover logic that is not apparent from studying isolated components.", "problem": "Consider a minimal coarse-grained steady-state model of the Rapidly Accelerated Fibrosarcoma (RAF)–Mitogen-Activated Protein Kinase/Extracellular signal-Regulated Kinase Kinase (MEK)–Extracellular signal-Regulated Kinase (ERK) mitogen-activated protein kinase (MAPK) cascade in mammalian cells with ERK-mediated negative feedback to RAF. Assume:\n\n- In the absence of feedback, RAF drives MEK at an input strength $R_{0}$. ERK imposes negative feedback on this input with sensitivity $a>0$, so that the effective RAF drive is scaled by a factor $1/\\bigl(1 + a E\\bigr)$, where $E$ is the steady-state ERK activity.\n- A MEK inhibitor at fractional level $i \\in [0,1]$ has two effects:\n  1) It reduces MEK catalytic throughput multiplicatively by a factor $g(i)$ with $g(0)=1$ and $g'(0)=-\\gamma<0$ (take $g(i)=1-\\gamma i$ near $i=0$ with $\\gamma>0$).\n  2) It attenuates the ERK-to-RAF feedback arm by a fraction $\\phi(i)$ with $\\phi(0)=0$ and $\\phi'(0)=\\eta>0$ (take $\\phi(i)=\\eta i$ near $i=0$), so the feedback factor becomes $1 + a\\bigl(1-\\phi(i)\\bigr)E$.\n- Downstream of MEK, the ERK response is locally linear in the effective MEK drive with gain $k>0$, so that at steady state\n$$\nE \\;=\\; k \\,\\frac{g(i)\\,R_{0}}{1 + a\\bigl(1-\\phi(i)\\bigr)E}\\,.\n$$\n\nThis setup embodies the idea that a MEK inhibitor both weakens MEK throughput and relieves the transmission of ERK negative feedback to RAF. A paradoxical activation scenario is defined here as an initial increase of ERK activity with small increases in inhibitor, i.e., $\\left.\\frac{dE}{di}\\right|_{i=0}>0$.\n\nStarting from this model and fundamental steady-state balance, do the following:\n\n1) Compute the drug-free steady-state ERK activity $E_{0}$ at $i=0$ in terms of $a$, $k$, and $R_{0}$.\n\n2) Using implicit differentiation about $i=0$, derive the condition on $\\eta$ and $\\gamma$ (and the other parameters) under which paradoxical activation occurs, i.e., $\\left.\\frac{dE}{di}\\right|_{i=0}>0$.\n\n3) Express the critical feedback-attenuation slope $\\eta_{\\mathrm{crit}}$ (the boundary value of $\\eta$ for which $\\left.\\frac{dE}{di}\\right|_{i=0}=0$) as a single closed-form analytic expression in $a$, $k$, $R_{0}$, and $\\gamma$ only. Your final answer must be this single analytic expression (dimensionless). Do not provide an inequality. Do not include units.", "solution": "The steady-state ERK activity, denoted by $E$, is governed by the algebraic equation:\n$$\nE \\;=\\; k \\,\\frac{g(i)\\,R_{0}}{1 + a\\bigl(1-\\phi(i)\\bigr)E}\n$$\nwhere $i$ is the inhibitor level. All parameters $a$, $k$, $R_{0}$, $\\gamma$, and $\\eta$ are positive constants.\n\n1. Computation of the drug-free steady-state ERK activity $E_{0}$.\n\nWe are asked to find the steady-state ERK activity $E_{0}$ at an inhibitor level of $i = 0$. At $i=0$, the problem provides the conditions $g(0) = 1$ and $\\phi(0) = 0$. Substituting these values into the governing equation gives:\n$$\nE_{0} \\;=\\; k \\,\\frac{g(0)\\,R_{0}}{1 + a\\bigl(1-\\phi(0)\\bigr)E_{0}} \\;=\\; k \\,\\frac{(1)R_{0}}{1 + a(1-0)E_{0}} \\;=\\; \\frac{kR_{0}}{1+aE_{0}}\n$$\nThis equation can be rearranged into a quadratic equation for $E_{0}$:\n$$\nE_{0} (1 + aE_{0}) = kR_{0}\n$$\n$$\naE_{0}^2 + E_{0} - kR_{0} = 0\n$$\nWe solve this equation for $E_{0}$ using the quadratic formula:\n$$\nE_{0} = \\frac{-1 \\pm \\sqrt{1^2 - 4(a)(-kR_{0})}}{2a} = \\frac{-1 \\pm \\sqrt{1 + 4akR_{0}}}{2a}\n$$\nSince ERK activity $E_{0}$ must be a non-negative physical quantity, and given that $a > 0$, $k > 0$, and $R_{0} > 0$, the term under the square root $\\sqrt{1+4akR_{0}}$ is strictly greater than $1$. To ensure $E_{0} > 0$, we must select the positive root. Thus, the drug-free steady-state ERK activity is:\n$$\nE_{0} = \\frac{-1 + \\sqrt{1 + 4akR_{0}}}{2a}\n$$\n\n2. Derivation of the condition for paradoxical activation.\n\nParadoxical activation is defined as an initial increase in $E$ for a small increase in $i$, which mathematically corresponds to the condition $\\left.\\frac{dE}{di}\\right|_{i=0} > 0$. To find this derivative, we use implicit differentiation on the governing steady-state equation. First, we rewrite the equation by clearing the denominator:\n$$\nE \\left[1 + a\\bigl(1-\\phi(i)\\bigr)E\\right] - k g(i) R_{0} = 0\n$$\nLet this expression be $F(E, i) = 0$. We differentiate $F(E, i)$ with respect to $i$, treating $E$ as a function of $i$:\n$$\n\\frac{d}{di} \\left( E + aE^2 - a\\phi(i)E^2 - k g(i) R_{0} \\right) = 0\n$$\nApplying the product and chain rules yields:\n$$\n\\frac{dE}{di} + 2aE\\frac{dE}{di} - \\left[ a\\phi'(i)E^2 + a\\phi(i) \\cdot 2E\\frac{dE}{di} \\right] - k g'(i) R_{0} = 0\n$$\nWe collect terms involving $\\frac{dE}{di}$:\n$$\n\\frac{dE}{di} \\left( 1 + 2aE - 2aE\\phi(i) \\right) = aE^2\\phi'(i) + kR_{0}g'(i)\n$$\nSolving for $\\frac{dE}{di}$:\n$$\n\\frac{dE}{di} = \\frac{aE^2\\phi'(i) + kR_{0}g'(i)}{1 + 2aE - 2aE\\phi(i)}\n$$\nWe now evaluate this derivative at $i=0$. At this point, we have $E=E_{0}$, and from the problem statement, $\\phi(0)=0$, $\\phi'(0)=\\eta$, and $g'(0)=-\\gamma$. Substituting these into the expression:\n$$\n\\left.\\frac{dE}{di}\\right|_{i=0} = \\frac{aE_{0}^2\\phi'(0) + kR_{0}g'(0)}{1 + 2aE_{0} - 2aE_{0}\\phi(0)} = \\frac{aE_{0}^2(\\eta) + kR_{0}(-\\gamma)}{1 + 2aE_{0} - 2aE_{0}(0)} = \\frac{a\\eta E_{0}^2 - k\\gamma R_{0}}{1 + 2aE_{0}}\n$$\nThe condition for paradoxical activation, $\\left.\\frac{dE}{di}\\right|_{i=0} > 0$, requires the numerator to be positive, as the denominator $1 + 2aE_{0}$ is strictly positive for $a>0$ and $E_0 > 0$. Therefore, the condition is:\n$$\na\\eta E_{0}^2 - k\\gamma R_{0} > 0 \\quad \\implies \\quad \\eta > \\frac{k\\gamma R_{0}}{a E_{0}^2}\n$$\n\n3. Expression for the critical feedback-attenuation slope $\\eta_{\\mathrm{crit}}$.\n\nThe critical slope $\\eta_{\\mathrm{crit}}$ is the boundary value of $\\eta$ for which the paradoxical activation effect begins, i.e., where $\\left.\\frac{dE}{di}\\right|_{i=0}=0$. From the previous step, this occurs when the numerator is zero:\n$$\na\\eta_{\\mathrm{crit}} E_{0}^2 - k\\gamma R_{0} = 0\n$$\nSolving for $\\eta_{\\mathrm{crit}}$ gives:\n$$\n\\eta_{\\mathrm{crit}} = \\frac{k\\gamma R_{0}}{a E_{0}^2}\n$$\nTo express this in terms of the fundamental parameters $a$, $k$, $R_{0}$, and $\\gamma$ only, we must eliminate $E_0$. We use the relation derived in part 1 from the quadratic equation for $E_{0}$: $kR_{0} = aE_{0}^2 + E_{0}$. Substituting this into the expression for $\\eta_{\\mathrm{crit}}$:\n$$\n\\eta_{\\mathrm{crit}} = \\frac{\\gamma (aE_{0}^2 + E_{0})}{a E_{0}^2} = \\gamma \\left( \\frac{aE_{0}^2}{aE_{0}^2} + \\frac{E_{0}}{aE_{0}^2} \\right) = \\gamma \\left( 1 + \\frac{1}{aE_{0}} \\right)\n$$\nNow we substitute the full expression for $E_{0}$:\n$$\naE_{0} = a \\left( \\frac{-1 + \\sqrt{1 + 4akR_{0}}}{2a} \\right) = \\frac{-1 + \\sqrt{1 + 4akR_{0}}}{2}\n$$\nTherefore, its reciprocal is:\n$$\n\\frac{1}{aE_{0}} = \\frac{2}{-1 + \\sqrt{1 + 4akR_{0}}}\n$$\nSubstituting this into the equation for $\\eta_{\\mathrm{crit}}$:\n$$\n\\eta_{\\mathrm{crit}} = \\gamma \\left( 1 + \\frac{2}{-1 + \\sqrt{1 + 4akR_{0}}} \\right)\n$$\nTo write this as a single fraction, we find a common denominator:\n$$\n\\eta_{\\mathrm{crit}} = \\gamma \\left( \\frac{-1 + \\sqrt{1 + 4akR_{0}} + 2}{-1 + \\sqrt{1 + 4akR_{0}}} \\right) = \\gamma \\left( \\frac{1 + \\sqrt{1 + 4akR_{0}}}{-1 + \\sqrt{1 + 4akR_{0}}} \\right)\n$$\nThis is the final closed-form expression for the critical slope. It is dimensionless, as required.", "answer": "$$\\boxed{\\gamma \\frac{1 + \\sqrt{1 + 4akR_{0}}}{\\sqrt{1 + 4akR_{0}} - 1}}$$", "id": "2576903"}, {"introduction": "Having examined a complex steady-state behavior, we now turn our attention to the dynamics of signal propagation. A cell's response is not just about *if* a pathway activates, but also *how quickly* it does so. This exercise models a two-tier kinase cascade and uses the powerful technique of linearization to analyze its temporal response to a small change in input signal [@problem_id:2576939]. By calculating the characteristic time of activation, you will develop a quantitative understanding of how the architecture of a cascade shapes its dynamic signature.", "problem": "A two-tier kinase cascade, inspired by the Mitogen-Activated Protein Kinase (MAPK) signaling architecture, is modeled at the level of active fractions by mass-action activation and first-order deactivation. Let the active fractions be $x_{1}(t)$ and $x_{2}(t)$ for Tier $1$ and Tier $2$, respectively, and let $u(t)$ denote the dimensionless activity of an upstream receptor. The dynamics are\n$$\n\\frac{d x_{1}}{d t} \\;=\\; k_{a1}\\,u(t)\\,\\big(1 - x_{1}\\big)\\;-\\;k_{d1}\\,x_{1},\n\\qquad\n\\frac{d x_{2}}{d t} \\;=\\; k_{a2}\\,x_{1}\\,\\big(1 - x_{2}\\big)\\;-\\;k_{d2}\\,x_{2}.\n$$\nAssume the following physiologically plausible parameter values are constant: $k_{a1} = \\frac{6}{5}\\,\\text{s}^{-1}$, $k_{d1} = \\frac{3}{10}\\,\\text{s}^{-1}$, $k_{a2} = \\frac{4}{5}\\,\\text{s}^{-1}$, $k_{d2} = \\frac{1}{5}\\,\\text{s}^{-1}$. The input is a small step: for $t < 0$, $u(t) = u_{0}$ with $u_{0} = \\frac{1}{2}$; at $t = 0^{+}$, $u(t)$ jumps to $u_{0} + \\Delta u$ and remains there, with $\\Delta u = \\frac{1}{20}$. Let the system be at the pre-step steady state for $t < 0$.\n\nUsing linearization about the pre-step steady state and assuming $\\Delta u$ is sufficiently small for the linear approximation to be valid, analytically derive the step response of $x_{2}(t)$ to the input change. Then compute the time $t_{90}$ at which $x_{2}(t)$ reaches $0.9$ of its new steady state value after the step. Express $t_{90}$ in seconds and round your answer to three significant figures.", "solution": "**1. Pre-step Steady State**\nFirst, we calculate the steady-state values of $x_1$ and $x_2$ for the constant input $u(t) = u_0 = \\frac{1}{2}$. At steady state, $\\frac{dx_1}{dt} = 0$ and $\\frac{dx_2}{dt} = 0$. Let the steady-state values be $x_{1,ss}$ and $x_{2,ss}$.\n\nFor $x_1$:\n$$\nk_{a1}\\,u_0\\,(1 - x_{1,ss}) - k_{d1}\\,x_{1,ss} = 0\n$$\n$$\nx_{1,ss} = \\frac{k_{a1}\\,u_0}{k_{a1}\\,u_0 + k_{d1}}\n$$\nSubstituting the given values:\n$$\nx_{1,ss} = \\frac{(\\frac{6}{5})(\\frac{1}{2})}{(\\frac{6}{5})(\\frac{1}{2}) + \\frac{3}{10}} = \\frac{\\frac{3}{5}}{\\frac{3}{5} + \\frac{3}{10}} = \\frac{\\frac{6}{10}}{\\frac{9}{10}} = \\frac{6}{9} = \\frac{2}{3}\n$$\n\nFor $x_2$, with $x_1 = x_{1,ss}$:\n$$\nk_{a2}\\,x_{1,ss}\\,(1 - x_{2,ss}) - k_{d2}\\,x_{2,ss} = 0\n$$\n$$\nx_{2,ss} = \\frac{k_{a2}\\,x_{1,ss}}{k_{a2}\\,x_{1,ss} + k_{d2}}\n$$\nSubstituting the values:\n$$\nx_{2,ss} = \\frac{(\\frac{4}{5})(\\frac{2}{3})}{(\\frac{4}{5})(\\frac{2}{3}) + \\frac{1}{5}} = \\frac{\\frac{8}{15}}{\\frac{8}{15} + \\frac{3}{15}} = \\frac{\\frac{8}{15}}{\\frac{11}{15}} = \\frac{8}{11}\n$$\nThe pre-step steady state is $(x_{1,ss}, x_{2,ss}) = (\\frac{2}{3}, \\frac{8}{11})$.\n\n**2. Linearization**\nWe linearize the system around the steady state $(x_{1,ss}, x_{2,ss}, u_0)$. Let $\\delta x_1 = x_1 - x_{1,ss}$, $\\delta x_2 = x_2 - x_{2,ss}$, and $\\delta u = u - u_0$. The linearized system is $\\frac{d}{dt}\\delta\\mathbf{x} = A \\delta\\mathbf{x} + B \\delta u$, where $A$ is the Jacobian matrix and $B$ is the input matrix, evaluated at the steady state.\n$$\n\\frac{d}{dt} \\begin{pmatrix} \\delta x_1 \\\\ \\delta x_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial x_1} & \\frac{\\partial f_1}{\\partial x_2} \\\\ \\frac{\\partial f_2}{\\partial x_1} & \\frac{\\partial f_2}{\\partial x_2} \\end{pmatrix}_{ss} \\begin{pmatrix} \\delta x_1 \\\\ \\delta x_2 \\end{pmatrix} + \\begin{pmatrix} \\frac{\\partial f_1}{\\partial u} \\\\ \\frac{\\partial f_2}{\\partial u} \\end{pmatrix}_{ss} \\delta u\n$$\nThe partial derivatives are:\n$\\frac{\\partial f_1}{\\partial x_1} = -k_{a1}u - k_{d1}$\n$\\frac{\\partial f_1}{\\partial x_2} = 0$\n$\\frac{\\partial f_2}{\\partial x_1} = k_{a2}(1 - x_2)$\n$\\frac{\\partial f_2}{\\partial x_2} = -k_{a2}x_1 - k_{d2}$\n$\\frac{\\partial f_1}{\\partial u} = k_{a1}(1 - x_1)$\n$\\frac{\\partial f_2}{\\partial u} = 0$\n\nEvaluating at $(x_{1,ss}, x_{2,ss}, u_0) = (\\frac{2}{3}, \\frac{8}{11}, \\frac{1}{2})$:\n$a_{11} = -k_{a1}u_0 - k_{d1} = -(\\frac{6}{5})(\\frac{1}{2}) - \\frac{3}{10} = -\\frac{3}{5} - \\frac{3}{10} = -\\frac{9}{10}$\n$a_{12} = 0$\n$a_{21} = k_{a2}(1 - x_{2,ss}) = \\frac{4}{5}(1 - \\frac{8}{11}) = \\frac{4}{5}(\\frac{3}{11}) = \\frac{12}{55}$\n$a_{22} = -k_{a2}x_{1,ss} - k_{d2} = -(\\frac{4}{5})(\\frac{2}{3}) - \\frac{1}{5} = -\\frac{8}{15} - \\frac{3}{15} = -\\frac{11}{15}$\n$b_1 = k_{a1}(1 - x_{1,ss}) = \\frac{6}{5}(1 - \\frac{2}{3}) = \\frac{6}{5}(\\frac{1}{3}) = \\frac{2}{5}$\n$b_2 = 0$\n\nThe linearized system is:\n$$\n\\frac{d}{dt} \\begin{pmatrix} \\delta x_1 \\\\ \\delta x_2 \\end{pmatrix} = \\begin{pmatrix} -\\frac{9}{10} & 0 \\\\ \\frac{12}{55} & -\\frac{11}{15} \\end{pmatrix} \\begin{pmatrix} \\delta x_1 \\\\ \\delta x_2 \\end{pmatrix} + \\begin{pmatrix} \\frac{2}{5} \\\\ 0 \\end{pmatrix} \\delta u\n$$\n\n**3. Step Response**\nFor $t \\geq 0$, the input is a step change $\\delta u(t) = \\Delta u = \\frac{1}{20}$. The system starts from rest, so $\\delta x_1(0) = 0$ and $\\delta x_2(0) = 0$.\n\nThe ODE for $\\delta x_1$ is $\\frac{d\\delta x_1}{dt} = a_{11} \\delta x_1 + b_1 \\Delta u$. The solution is $\\delta x_1(t) = \\delta x_{1, \\text{new\\_ss}}(1 - e^{a_{11}t})$, where the new steady-state deviation is $\\delta x_{1, \\text{new\\_ss}} = -\\frac{b_1}{a_{11}}\\Delta u$.\n\nThe ODE for $\\delta x_2$ is $\\frac{d\\delta x_2}{dt} = a_{22} \\delta x_2 + a_{21} \\delta x_1(t)$.\nThis is a cascaded first-order system. The response $\\delta x_2(t)$ to a step input, given the triangular structure of matrix $A$ (with $a_{11} \\ne a_{22}$), is a standard result:\n$$\n\\delta x_2(t) = \\delta x_{2, \\text{new\\_ss}} \\left( 1 - \\frac{a_{11}}{a_{11}-a_{22}} e^{a_{22}t} + \\frac{a_{22}}{a_{11}-a_{22}} e^{a_{11}t} \\right)\n$$\nwhere $\\delta x_{2, \\text{new\\_ss}} = -\\frac{a_{21}}{a_{22}}\\delta x_{1, \\text{new\\_ss}} = \\frac{a_{21}b_1}{a_{11}a_{22}}\\Delta u$.\n\n**4. Calculation of $t_{90}$**\nThe time $t_{90}$ is when the response $\\delta x_2(t)$ reaches $90\\%$ of its final value $\\delta x_{2, \\text{new\\_ss}}$.\n$$\n\\delta x_2(t_{90}) = 0.9 \\cdot \\delta x_{2, \\text{new\\_ss}}\n$$\nSubstituting into the response equation:\n$$\n0.9 = 1 - \\frac{a_{11}}{a_{11}-a_{22}} e^{a_{22}t_{90}} + \\frac{a_{22}}{a_{11}-a_{22}} e^{a_{11}t_{90}}\n$$\nRearranging gives:\n$$\n0.1 = \\frac{a_{11}}{a_{11}-a_{22}} e^{a_{22}t_{90}} - \\frac{a_{22}}{a_{11}-a_{22}} e^{a_{11}t_{90}}\n$$\nWe need the coefficients.\n$a_{11} = -\\frac{9}{10}$ and $a_{22} = -\\frac{11}{15}$.\n$a_{11}-a_{22} = -\\frac{9}{10} - (-\\frac{11}{15}) = -\\frac{27}{30} + \\frac{22}{30} = -\\frac{5}{30} = -\\frac{1}{6}$.\n$\\frac{a_{11}}{a_{11}-a_{22}} = \\frac{-9/10}{-1/6} = \\frac{54}{10} = 5.4$.\n$\\frac{a_{22}}{a_{11}-a_{22}} = \\frac{-11/15}{-1/6} = \\frac{66}{15} = \\frac{22}{5} = 4.4$.\n\nSubstituting these into the equation for $t_{90}$ (letting $t=t_{90}$):\n$$\n0.1 = 5.4 \\exp\\left(-\\frac{11}{15}t\\right) - 4.4 \\exp\\left(-\\frac{9}{10}t\\right)\n$$\nThis is a transcendental equation that must be solved numerically. Let $h(t) = 5.4 \\exp(-\\frac{11}{15}t) - 4.4 \\exp(-\\frac{9}{10}t)$. We seek $t$ such that $h(t) = 0.1$.\nA numerical solver or trial and error can be used. For $t=4.82$, $h(4.82) \\approx 0.1003$. For $t=4.83$, $h(4.83) \\approx 0.0994$. The value is extremely close to $t=4.82$.\nRounding to three significant figures, we get $t_{90} = 4.82\\,\\text{s}$.", "answer": "$$\n\\boxed{4.82}\n$$", "id": "2576939"}, {"introduction": "Our final practice moves beyond the deterministic world, where all cells are assumed to be identical, and into the stochastic realm of biological reality. In any cell population, the abundance of key signaling proteins varies from cell to cell, a phenomenon known as heterogeneity, leading to diverse responses even under a uniform stimulus. This computational exercise tasks you with building a stochastic model to connect the intrinsic variability in kinase levels to an observable, population-level outcome—the fraction of activated cells [@problem_id:2576915]. By fitting the model to hypothetical data, you will infer the degree of protein expression noise required to explain the observed heterogeneity, a core task in quantitative systems biology.", "problem": "You are tasked with formulating and solving a mechanistic stochastic model for cell-to-cell heterogeneity in activation of a kinase cascade under a fixed extracellular stimulus. The aim is to infer the coefficient of variation of kinase abundance that is required to reproduce a given observed fraction of activated cells. You must implement a program that, for a provided test suite, returns the inferred coefficients of variation for each case as a list of floating-point numbers.\n\nModeling assumptions and foundations:\n- Under the central dogma of molecular biology and classical birth–death kinetics for protein synthesis and degradation, a protein copy number at steady state is well described by a gamma family of distributions when transcriptional bursting is present. Specifically, let the abundance of kinase tier $i$, denoted $K_i$, be modeled as a gamma random variable with shape parameter $\\alpha$ and scale parameter $\\beta_i$, giving mean $\\mu_i = \\alpha \\beta_i$ and variance $\\sigma_i^2 = \\alpha \\beta_i^2$. The coefficient of variation (CV) for each kinase is then $\\mathrm{CV} = \\sigma_i / \\mu_i = 1/\\sqrt{\\alpha}$, which is shared across tiers when extrinsic noise dominates.\n- By the law of mass action and the Michaelis–Menten (MM) form for enzyme-mediated phosphorylation in the low substrate regime, the instantaneous phosphorylation flux through tier $i$ is proportional to the product of applied stimulus $S$ and active kinase abundance $K_i$. Assuming the downstream module behaves as an ultrasensitive switch, activation of tier $i$ occurs when $K_i \\ge T_i(S)$, where $T_i(S) = \\Theta_i / S$ and $\\Theta_i$ is a biochemical threshold (at unit stimulus) that encapsulates dephosphorylation and downstream demand.\n- The kinase cascade of $n$ independent tiers is considered activated only if each tier meets its activation condition. For independent tiers, the fraction of activated cells equals the probability that all $n$ inequalities $K_i \\ge T_i(S)$ hold simultaneously, which by independence is the product over tiers of their individual tail probabilities.\n\nMathematical specification:\n- For tier $i$, let $K_i \\sim \\mathrm{Gamma}(\\alpha, \\beta_i)$ with mean fixed to $\\mu_i$ and common shape $\\alpha > 0$. Hence $\\beta_i = \\mu_i / \\alpha$.\n- Let the activation threshold for tier $i$ under stimulus $S$ be $T_i(S) = \\Theta_i / S$ with $\\Theta_i > 0$ and $S > 0$.\n- The probability that a single tier is active is $p_i(\\alpha; S, \\Theta_i, \\mu_i) = \\mathbb{P}(K_i \\ge T_i(S)) = 1 - F_{\\mathrm{Gamma}}\\!\\left(T_i(S); \\alpha, \\beta_i\\right)$, where $F_{\\mathrm{Gamma}}(\\cdot;\\alpha,\\beta)$ is the cumulative distribution function (CDF) of the gamma distribution with shape $\\alpha$ and scale $\\beta$.\n- The model-predicted active fraction for $n$ tiers is\n$$\nP_{\\mathrm{model}}(\\alpha; S, \\{\\Theta_i\\}, \\{\\mu_i\\}) = \\prod_{i=1}^{n} \\left[ 1 - F_{\\mathrm{Gamma}}\\!\\left(\\frac{\\Theta_i}{S}; \\alpha, \\frac{\\mu_i}{\\alpha} \\right) \\right].\n$$\n- The observed active fraction is denoted $p_{\\mathrm{obs}} \\in (0,1)$. The inference task is to find the coefficient of variation $\\mathrm{CV} = 1/\\sqrt{\\alpha}$ that matches $p_{\\mathrm{obs}}$ as closely as possible. In numerical terms, this is the positive $\\alpha$ that minimizes the squared error\n$$\nE(\\alpha) = \\left( P_{\\mathrm{model}}(\\alpha; S, \\{\\Theta_i\\}, \\{\\mu_i\\}) - p_{\\mathrm{obs}} \\right)^2.\n$$\n\nProgramming task:\n- Write a program that, for each provided test case, computes the coefficient of variation $\\mathrm{CV} = 1/\\sqrt{\\alpha^\\star}$, where $\\alpha^\\star = \\arg\\min_{\\alpha > 0} E(\\alpha)$.\n- Numerical details:\n  - Treat $\\alpha$ as a continuous positive parameter. To ensure numerical stability, you may reparameterize with $x = \\log \\alpha$ and minimize $E(e^x)$ over a bounded interval of $x$.\n  - Use a reliable implementation of the gamma cumulative distribution function and a bounded scalar minimizer for $E(\\alpha)$.\n- Report the final answers as decimals (dimensionless). Do not use a percent sign.\n\nTest suite:\n- Case A (two independent tiers, moderate activation):\n  - Stimulus $S = 1.0$.\n  - Means $\\{\\mu_i\\} = [4000.0, 2500.0]$ in molecules per cell.\n  - Thresholds at unit stimulus $\\{\\Theta_i\\} = [2200.0, 1800.0]$ in molecules.\n  - Observed active fraction $p_{\\mathrm{obs}} = 0.55$.\n- Case B (three independent tiers, stringent activation):\n  - Stimulus $S = 0.8$.\n  - Means $\\{\\mu_i\\} = [3000.0, 2000.0, 1500.0]$ in molecules per cell.\n  - Thresholds at unit stimulus $\\{\\Theta_i\\} = [2600.0, 1800.0, 1400.0]$ in molecules.\n  - Observed active fraction $p_{\\mathrm{obs}} = 0.10$.\n- Case C (two independent tiers, strong stimulus):\n  - Stimulus $S = 1.5$.\n  - Means $\\{\\mu_i\\} = [2500.0, 2500.0]$ in molecules per cell.\n  - Thresholds at unit stimulus $\\{\\Theta_i\\} = [1600.0, 1500.0]$ in molecules.\n  - Observed active fraction $p_{\\mathrm{obs}} = 0.90$.\n- Case D (single tier, moderate threshold):\n  - Stimulus $S = 1.0$.\n  - Means $\\{\\mu_i\\} = [1200.0]$ in molecules per cell.\n  - Thresholds at unit stimulus $\\{\\Theta_i\\} = [1000.0]$ in molecules.\n  - Observed active fraction $p_{\\mathrm{obs}} = 0.30$.\n\nRequired output format:\n- Your program should produce a single line of output containing the inferred coefficients of variation for the cases A through D, in that order, as a comma-separated list enclosed in square brackets, for example: \"[0.123456,0.234567,0.345678,0.456789]\".", "solution": "The core of the problem is to find the value of the gamma distribution shape parameter, $\\alpha$, that minimizes the squared error between a model-predicted probability and an observed value. The coefficient of variation is then computed as $\\mathrm{CV} = 1/\\sqrt{\\alpha}$.\n\nThe model prediction, $P_{\\mathrm{model}}(\\alpha)$, is given by:\n$$P_{\\mathrm{model}}(\\alpha) = \\prod_{i=1}^{n} p_i(\\alpha)$$\nwhere $p_i(\\alpha)$ is the probability that the $i$-th tier is active. This probability is the survival function (SF) of the gamma distribution:\n$$p_i(\\alpha) = \\mathrm{SF}_{\\mathrm{Gamma}}\\left(T_i; a=\\alpha, \\mathrm{scale}=\\beta_i\\right)$$\nHere, the threshold is $T_i = \\Theta_i/S$, the shape parameter is $a=\\alpha$, and the scale parameter is $\\beta_i = \\mu_i/\\alpha$. This can be computed using a scientific library's implementation of the gamma survival function.\n\nThe optimization task is $\\alpha^\\star = \\arg\\min_{\\alpha > 0} (P_{\\mathrm{model}}(\\alpha) - p_{\\mathrm{obs}})^2$. As suggested, we can reparameterize with $x = \\log \\alpha$ to transform the domain from $\\alpha \\in (0, \\infty)$ to $x \\in (-\\infty, \\infty)$. The objective function for the numerical solver becomes:\n$$f(x) = \\left( P_{\\mathrm{model}}(e^x) - p_{\\mathrm{obs}} \\right)^2$$\nA bounded scalar minimizer can be used to find the minimum of $f(x)$ over a plausible range for $x$.\n\nThe algorithm is as follows for each test case:\n1.  Define the error function `error_squared(log_alpha, ...)` which computes $(P_{\\mathrm{model}}(e^{\\log\\alpha}) - p_{\\mathrm{obs}})^2$.\n2.  Use a numerical optimizer to find the value of `log_alpha` that minimizes this function over a bounded interval. To ensure robustness, especially in cases where the error function may be non-monotonic, the search can be split into negative and positive intervals for `log_alpha`, with the best result being chosen.\n3.  Calculate the optimal shape parameter $\\alpha^\\star = e^{\\log\\alpha^\\star}$.\n4.  Compute the final result: $\\mathrm{CV} = 1 / \\sqrt{\\alpha^\\star}$.\n5.  Collect the results for all cases and format the output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import gamma\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Formulates and solves a mechanistic stochastic model for cell-to-cell heterogeneity\n    in kinase cascade activation to infer the coefficient of variation of kinase abundance.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (two independent tiers, moderate activation)\n        {\n            \"S\": 1.0,\n            \"mus\": [4000.0, 2500.0],\n            \"Thetas\": [2200.0, 1800.0],\n            \"p_obs\": 0.55\n        },\n        # Case B (three independent tiers, stringent activation)\n        {\n            \"S\": 0.8,\n            \"mus\": [3000.0, 2000.0, 1500.0],\n            \"Thetas\": [2600.0, 1800.0, 1400.0],\n            \"p_obs\": 0.10\n        },\n        # Case C (two independent tiers, strong stimulus)\n        {\n            \"S\": 1.5,\n            \"mus\": [2500.0, 2500.0],\n            \"Thetas\": [1600.0, 1500.0],\n            \"p_obs\": 0.90\n        },\n        # Case D (single tier, moderate threshold)\n        {\n            \"S\": 1.0,\n            \"mus\": [1200.0],\n            \"Thetas\": [1000.0],\n            \"p_obs\": 0.30\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        s_val, mus, thetas, p_obs = case[\"S\"], case[\"mus\"], case[\"Thetas\"], case[\"p_obs\"]\n\n        def p_model(alpha, s, mu_list, theta_list):\n            \"\"\"Calculates the model-predicted active fraction for a given alpha.\"\"\"\n            if alpha = 1e-9:\n                return 1.0\n            \n            p_total = 1.0\n            for mu, theta in zip(mu_list, theta_list):\n                threshold = theta / s\n                scale = mu / alpha\n                # The survival function P(K >= T) for K ~ Gamma(alpha, scale)\n                p_tier = gamma.sf(threshold, a=alpha, scale=scale)\n                p_total *= p_tier\n            return p_total\n\n        def error_squared(log_alpha, s, mu_list, theta_list, p_observed):\n            \"\"\"Objective function to minimize: squared error.\"\"\"\n            alpha = np.exp(log_alpha)\n            p_pred = p_model(alpha, s, mu_list, theta_list)\n            return (p_pred - p_observed)**2\n\n        # To robustly find the global minimum, especially for U-shaped error functions,\n        # we split the search domain for log(alpha) and compare the results.\n        # This handles cases with a unique minimum or two distinct roots.\n        args = (s_val, mus, thetas, p_obs)\n        \n        # Search over log(alpha)  0 (i.e., alpha  1, high CV)\n        res1 = minimize_scalar(error_squared, args=args, bounds=(-10, 0), method='bounded')\n        \n        # Search over log(alpha) > 0 (i.e., alpha > 1, low CV)\n        res2 = minimize_scalar(error_squared, args=args, bounds=(0, 10), method='bounded')\n\n        # Select the result from the interval that yielded the smaller error\n        if res1.fun  res2.fun:\n            optimal_log_alpha = res1.x\n        else:\n            optimal_log_alpha = res2.x\n            \n        optimal_alpha = np.exp(optimal_log_alpha)\n        \n        # Coefficient of Variation is 1/sqrt(alpha)\n        cv = 1.0 / np.sqrt(optimal_alpha)\n        results.append(cv)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2576915"}]}