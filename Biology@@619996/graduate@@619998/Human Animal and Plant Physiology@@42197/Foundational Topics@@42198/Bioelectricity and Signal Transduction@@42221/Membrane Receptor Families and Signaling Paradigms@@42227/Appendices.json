{"hands_on_practices": [{"introduction": "Understanding any receptor-mediated process begins with quantifying the initial binding event between a ligand and its receptor. This foundational exercise guides you through deriving the essential relationship between ligand concentration and fractional receptor occupancy from the first principles of mass-action kinetics. Mastering this derivation and its application provides the core mathematical tool for interpreting dose-response relationships and understanding the prerequisite for signal activation.", "problem": "A single-compartment mammalian cell expresses a family of G protein-coupled receptors (GPCRs) with total receptor number per cell $R_T = 5 \\times 10^{4}$. A monovalent ligand binds to a single site on each receptor with dissociation constant $K_d = 20\\,\\mathrm{nM}$. The cell is bathed in a well-stirred extracellular medium that acts as a large reservoir at fixed bulk ligand concentration $[L]$, so that ligand depletion by binding to the receptors on one cell is negligible. Assume equilibrium, one-to-one noncooperative binding, and that downstream signaling scales with the fraction of receptors occupied up to pathway-specific thresholds.\n\nStarting only from the definition of the dissociation constant for the equilibrium reaction $\\mathrm{R} + \\mathrm{L} \\rightleftharpoons \\mathrm{RL}$ and the conservation of receptor number, derive an expression for the fractional receptor occupancy as a function of $[L]$ and $K_d$. Then, evaluate the fractional occupancy at $[L] = 5\\,\\mathrm{nM}$, $[L] = 20\\,\\mathrm{nM}$, and $[L] = 100\\,\\mathrm{nM}$. Finally, briefly interpret how these occupancies relate to possible downstream signaling thresholds and receptor reserve in GPCR pathways, without introducing any additional phenomenological formulas.\n\nReport the three fractional occupancies, in the order corresponding to $[L] = 5\\,\\mathrm{nM}$, $20\\,\\mathrm{nM}$, and $100\\,\\mathrm{nM}$, as unitless decimal fractions. Round each to four significant figures.", "solution": "The problem requires the derivation of an expression for fractional receptor occupancy. Let us begin from first principles.\n\nThe binding of a ligand $\\mathrm{L}$ to a receptor $\\mathrm{R}$ to form a complex $\\mathrm{RL}$ is described by the reversible reaction:\n$$\n\\mathrm{R} + \\mathrm{L} \\rightleftharpoons \\mathrm{RL}\n$$\nAt equilibrium, the rates of the forward and reverse reactions are equal. The dissociation constant, $K_d$, is defined by the ratio of the concentrations of the species at equilibrium:\n$$\nK_d = \\frac{[\\mathrm{R}][\\mathrm{L}]}{[\\mathrm{RL}]} \\quad (1)\n$$\nwhere $[\\mathrm{R}]$ is the concentration of free receptors, $[\\mathrm{L}]$ is the concentration of free ligand, and $[\\mathrm{RL}]$ is the concentration of ligand-receptor complexes.\n\nThe problem states the conservation of total receptors. Let the total concentration of receptors be $[R_T]$. This total concentration is the sum of the concentration of free receptors and the concentration of receptors bound to ligand:\n$$\n[R_T] = [\\mathrm{R}] + [\\mathrm{RL}] \\quad (2)\n$$\nFrom this conservation law, we can express the concentration of free receptors as:\n$$\n[\\mathrm{R}] = [R_T] - [\\mathrm{RL}] \\quad (3)\n$$\nSubstituting equation $(3)$ into the definition of the dissociation constant, equation $(1)$, we obtain:\n$$\nK_d = \\frac{([R_T] - [\\mathrm{RL}])[\\mathrm{L}]}{[\\mathrm{RL}]}\n$$\nOur goal is to derive an expression for the fractional receptor occupancy, $\\theta$, which is defined as the fraction of total receptors that are bound to ligand:\n$$\n\\theta = \\frac{[\\mathrm{RL}]}{[R_T]} \\quad (4)\n$$\nTo find this, we must first solve the expression for $K_d$ for the quantity $[\\mathrm{RL}]$.\n$$\nK_d [\\mathrm{RL}] = ([R_T] - [\\mathrm{RL}])[\\mathrm{L}]\n$$\n$$\nK_d [\\mathrm{RL}] = [R_T][\\mathrm{L}] - [\\mathrm{RL}][\\mathrm{L}]\n$$\n$$\nK_d [\\mathrm{RL}] + [\\mathrm{RL}][\\mathrm{L}] = [R_T][\\mathrm{L}]\n$$\n$$\n[\\mathrm{RL}] (K_d + [\\mathrm{L}]) = [R_T][\\mathrm{L}]\n$$\n$$\n[\\mathrm{RL}] = \\frac{[R_T][\\mathrm{L}]}{K_d + [\\mathrm{L}]} \\quad (5)\n$$\nNow, to find the fractional occupancy $\\theta$, we divide both sides of equation $(5)$ by $[R_T]$ as per definition $(4)$:\n$$\n\\theta = \\frac{[\\mathrm{RL}]}{[R_T]} = \\frac{1}{[R_T]} \\left( \\frac{[R_T][\\mathrm{L}]}{K_d + [\\mathrm{L}]} \\right)\n$$\nThis simplifies to the final derived expression for fractional occupancy, also known as the Hill-Langmuir equation for non-cooperative binding:\n$$\n\\theta = \\frac{[\\mathrm{L}]}{K_d + [\\mathrm{L}]}\n$$\nNote that the fractional occupancy $\\theta$ is independent of the total receptor number, $R_T$, a value which was given as $5 \\times 10^{4}$ but is not required for this part of the calculation.\n\nNext, we evaluate $\\theta$ for the given values. The dissociation constant is $K_d = 20\\,\\mathrm{nM}$.\n\nCase 1: Ligand concentration $[L] = 5\\,\\mathrm{nM}$.\n$$\n\\theta_1 = \\frac{5\\,\\mathrm{nM}}{20\\,\\mathrm{nM} + 5\\,\\mathrm{nM}} = \\frac{5}{25} = 0.2\n$$\nRounded to four significant figures, this is $0.2000$.\n\nCase 2: Ligand concentration $[L] = 20\\,\\mathrm{nM}$.\n$$\n\\theta_2 = \\frac{20\\,\\mathrm{nM}}{20\\,\\mathrm{nM} + 20\\,\\mathrm{nM}} = \\frac{20}{40} = 0.5\n$$\nThis result is expected, as the dissociation constant $K_d$ is defined as the ligand concentration at which half of the receptors are occupied. Rounded to four significant figures, this is $0.5000$.\n\nCase 3: Ligand concentration $[L] = 100\\,\\mathrm{nM}$.\n$$\n\\theta_3 = \\frac{100\\,\\mathrm{nM}}{20\\,\\mathrm{nM} + 100\\,\\mathrm{nM}} = \\frac{100}{120} = \\frac{5}{6} \\approx 0.833333...\n$$\nRounded to four significant figures, this is $0.8333$.\n\nFinally, we are asked to interpret these results in the context of signaling thresholds and receptor reserve.\nThe fractional occupancy values of $0.2000$, $0.5000$, and $0.8333$ represent the fraction of the total $5 \\times 10^{4}$ receptors that are active at each ligand concentration. Downstream signaling is initiated by these active receptors.\nA minimal fractional occupancy, or threshold, may be required to trigger a measurable cellular response. For example, if a pathway's threshold is $\\theta > 0.25$, a ligand concentration of $5\\,\\mathrm{nM}$ ($\\theta=0.2000$) would be insufficient to elicit a response, whereas $20\\,\\mathrm{nM}$ ($\\theta=0.5000$) would be sufficient.\nThe concept of \"receptor reserve\" or \"spare receptors\" relates to the observation that in many GPCR systems, a maximal biological response is achieved at a fractional occupancy significantly less than $1$. For instance, if this cell system were to exhibit its maximal response at $[L] = 20\\,\\mathrm{nM}$ (where $\\theta = 0.5000$), it would imply that only $50\\%$ of the total receptors need to be activated. The remaining $50\\%$ of unoccupied or redundant receptors constitute the receptor reserve. This reserve allows the cell to be highly sensitive, producing a maximal effect at a ligand concentration far below that required for receptor saturation. Conversely, if a maximal response required a high ligand concentration, such as $[L] = 100\\,\\mathrm{nM}$ or greater, this would indicate a small or negligible receptor reserve, where the signaling response is more directly proportional to the total number of occupied receptors. Without experimental data on the cellular response, we can only state these as possibilities conditioned on the relationship between occupancy and response.", "answer": "$$\\boxed{\\begin{pmatrix} 0.2000 & 0.5000 & 0.8333 \\end{pmatrix}}$$", "id": "2581941"}, {"introduction": "Receptor occupancy alone does not tell the whole story of cellular response; the ligand's intrinsic ability to induce a conformational change and the system's downstream amplification capacity are equally critical. This problem builds upon the concept of occupancy [@problem_id:2581941] by introducing the pharmacological concepts of intrinsic efficacy and receptor reserve. By working through this scenario, you will uncover the important paradigm of how a system's architecture can allow a ligand classified as a \"partial agonist\" to nonetheless elicit a maximal physiological response.", "problem": "In a physiological tissue expressing a single class of membrane receptors, the graded response to an agonist is normalized so that the maximal attainable system response equals $1$. Let the fractional receptor occupancy be given by the classic mass-action relation $\\theta = \\frac{[A]}{[A] + K_{d}}$, where $[A]$ is agonist concentration and $K_{d}$ is the dissociation constant. Define the stimulus generated by the agonist as proportional to the product of its intrinsic efficacy $\\epsilon$ and the fractional occupancy $\\theta$. The tissue possesses a receptor reserve: a full agonist (intrinsic efficacy $\\epsilon = 1$) elicits the maximal system response when only a fraction $f_{\\mathrm{req}}$ of receptors are occupied. The receptor reserve fraction is $0.6$, meaning only $1 - 0.6 = 0.4$ of receptors must be occupied by a full agonist to achieve the maximal system response.\n\nA test ligand is a partial agonist with intrinsic efficacy $\\epsilon = 0.4$ and dissociation constant $K_{d} = 50 \\ \\mathrm{nM}$. Working from first principles of receptor occupancy and the definition of receptor reserve stated above, determine the maximal response this partial agonist can achieve relative to the full agonistâ€™s maximal system response, when concentration $[A]$ is allowed to vary over all positive values.\n\nExpress your final answer as a unitless decimal ratio and round to four significant figures.", "solution": "The relationship between agonist binding and tissue response can be modeled by a two-step process: the generation of a stimulus, followed by the transduction of that stimulus into a measurable response.\n\nLet $S$ be the stimulus generated by an agonist. According to the problem statement, the stimulus is proportional to the product of the agonist's intrinsic efficacy, $\\epsilon$, and the fractional receptor occupancy, $\\theta$. We can express this relationship as:\n$$S = k \\epsilon \\theta$$\nwhere $k$ is a constant of proportionality that accounts for factors such as total receptor density.\n\nLet $R$ be the normalized system response, which is a function of the stimulus, $R = f(S)$. The function $f(S)$ is a monotonically increasing function, with $f(0) = 0$ and a maximum value of $1$.\n\nWe are given that a full agonist, with $\\epsilon_{\\text{full}} = 1$, elicits the maximal system response, $R=1$, when the fractional occupancy is $\\theta = f_{\\mathrm{req}} = 0.4$. This information allows us to determine the minimum stimulus required to achieve the maximal response. Let us denote this threshold stimulus as $S_{\\text{req}}$.\n$$S_{\\text{req}} = k \\cdot \\epsilon_{\\text{full}} \\cdot f_{\\mathrm{req}} = k \\cdot (1) \\cdot (0.4) = 0.4k$$\nThe properties of the stimulus-response function $f(S)$ are such that for any stimulus $S \\geq S_{\\text{req}}$, the response is maximal, i.e., $f(S) = 1$.\n\nNext, we analyze the test ligand, which is a partial agonist with an intrinsic efficacy of $\\epsilon_{\\text{p}} = 0.4$. We need to determine the maximal response, $R_{\\text{p,max}}$, that this ligand can produce. The maximal response occurs at the maximal possible stimulus, $S_{\\text{p,max}}$, that the ligand can generate.\n\nThe maximal stimulus is achieved when the concentration of the agonist, $[A]$, is saturating ($[A] \\to \\infty$). At saturating concentrations, the fractional receptor occupancy, $\\theta$, approaches its maximum value of $1$.\n$$\\theta_{\\text{max}} = \\lim_{[A]\\to\\infty} \\frac{[A]}{[A] + K_{d}} = 1$$\nNote that this maximal occupancy does not depend on the value of the dissociation constant, $K_{d}$. Therefore, the given value of $K_{d, \\text{p}} = 50 \\ \\mathrm{nM}$ is not required to find the maximal response.\n\nThe maximal stimulus producible by the partial agonist is:\n$$S_{\\text{p,max}} = k \\cdot \\epsilon_{\\text{p}} \\cdot \\theta_{\\text{max}} = k \\cdot (0.4) \\cdot (1) = 0.4k$$\n\nNow, we compare the maximal stimulus from the partial agonist, $S_{\\text{p,max}}$, with the stimulus required for a maximal system response, $S_{\\text{req}}$.\n$$S_{\\text{p,max}} = 0.4k$$\n$$S_{\\text{req}} = 0.4k$$\nWe find that $S_{\\text{p,max}} = S_{\\text{req}}$.\n\nThe maximal response of the partial agonist is the response generated by its maximal stimulus:\n$$R_{\\text{p,max}} = f(S_{\\text{p,max}})$$\nSince $S_{\\text{p,max}} = S_{\\text{req}}$, and we know that any stimulus equal to or greater than $S_{\\text{req}}$ produces the maximal system response of $1$, it follows that:\n$$R_{\\text{p,max}} = f(S_{\\text{req}}) = 1$$\nThis result demonstrates that in a system with a significant receptor reserve, a ligand that is classified as a partial agonist (based on its intrinsic efficacy $\\epsilon < 1$) can still function as a full agonist, capable of eliciting the maximal possible tissue response.\n\nThe problem asks for the maximal response of the partial agonist relative to the full agonist's maximal system response. The maximal system response is normalized to $1$. The calculated maximal response for the partial agonist is also $1$. The ratio is therefore:\n$$\\text{Ratio} = \\frac{R_{\\text{p,max}}}{R_{\\text{max\\_sys}}} = \\frac{1}{1} = 1$$\n\nAs required, we express this answer as a decimal ratio rounded to four significant figures.", "answer": "$$\\boxed{1.000}$$", "id": "2581932"}, {"introduction": "While classical models offer deterministic descriptions of signaling, cellular processes are fundamentally stochastic, especially when key molecules are present in low numbers. This advanced computational practice challenges you to move from population averages to the noisy reality of single-cell signaling by building a simulation. You will investigate how the spatial clustering of receptors can suppress noise and enhance the fidelity of information transmission, applying powerful metrics from information theory to quantify how effectively a cell deciphers signals from its environment.", "problem": "You are asked to formalize and simulate a minimal stochastic model of receptor-mediated kinase activation to examine how clustering reduces noise and to quantify information transmission. Start from the following fundamental definitions and assumptions grounded in ligand-receptor binding and stochastic sampling.\n\nFundamental base:\n- For a cell with $N_R$ identical receptors, partitioned into clusters of size $m$, the number of clusters is $N_c = N_R / m$ (assume $m$ divides $N_R$ exactly).\n- At a ligand concentration $L$ and dissociation constant $K_d$, the equilibrium receptor occupancy probability is $p(L) = \\dfrac{L}{L + K_d}$, assuming independent binding.\n- Within a cluster of $m$ receptors, the number of bound receptors $X$ is $X \\sim \\mathrm{Binomial}(m, p)$, so the empirical mean occupancy is $\\bar{X} = X / m$ with $\\mathbb{E}[\\bar{X}] = p$ and $\\mathrm{Var}(\\bar{X}) = \\dfrac{p (1-p)}{m}$.\n- Downstream kinase activation is modeled as a per-cluster threshold detector on a noisy average occupancy: for each cluster, define $Y = \\mathbf{1}\\{\\bar{X} + \\eta \\ge \\theta\\}$, where $\\eta \\sim \\mathcal{N}(0, \\sigma^2)$ is independent additive intrinsic noise and $\\theta$ is a fixed threshold. The total kinase activation count per cell is $K = \\sum_{c=1}^{N_c} Y_c$.\n- The input variable $L$ will be treated as a discrete random variable taking values in a finite set with equal prior probability. The output variable is the discrete kinase count $K \\in \\{0,1,\\dots,N_c\\}$.\n\nYour program must implement the following specification.\n\nModel parameters to use:\n- Total receptors per cell: $N_R = 100$.\n- Cluster sizes to test (these define the test suite): $m \\in \\{1, 5, 10, 20, 100\\}$, so $N_c \\in \\{100, 20, 10, 5, 1\\}$ respectively.\n- Ligand dissociation constant: $K_d = 1.0$.\n- Ligand concentrations to encode the input: $\\mathcal{L} = \\{0.1, 1.0, 10.0\\}$, each with equal prior probability $1/3$.\n- Threshold: $\\theta = 0.5$.\n- Intrinsic per-cluster noise standard deviation: $\\sigma = 0.1$.\n- Number of independently simulated cells per ligand value: $N_{\\text{cells}} = 20000$.\n- Random number generator seed: set a fixed seed equal to $123$ to ensure reproducibility.\n\nTasks the program must perform for each cluster size $m$ in the test suite:\n1) Simulation of kinase counts. For each $L \\in \\mathcal{L}$, compute $p(L) = \\dfrac{L}{L + K_d}$. For each of the $N_c$ clusters and for each of the $N_{\\text{cells}}$ simulated cells, sample $X \\sim \\mathrm{Binomial}(m, p(L))$, compute $\\bar{X} = X/m$, add intrinsic noise $\\eta \\sim \\mathcal{N}(0, \\sigma^2)$, threshold to obtain $Y = \\mathbf{1}\\{\\bar{X} + \\eta \\ge \\theta\\}$, and sum across clusters to obtain $K \\in \\{0,\\dots,N_c\\}$ for that simulated cell. This induces an empirical conditional distribution $P(K \\mid L)$ for each $L$ and an unconditional distribution $P(K)$ under the uniform prior over $L$.\n2) Noise quantification. At the middle ligand $L = 1.0$ (that is, the value for which $p(L) = 0.5$), compute the coefficient of variation $\\mathrm{CV} = \\dfrac{\\sqrt{\\mathrm{Var}(K \\mid L = 1.0)}}{\\mathbb{E}[K \\mid L = 1.0]}$. Report this as a dimensionless quantity rounded to four decimal places. If $\\mathbb{E}[K \\mid L = 1.0] = 0$, define $\\mathrm{CV} = 0$ by convention.\n3) Information transmission metric. Use Mutual Information (MI) to quantify the information transmitted from the discrete input $L \\in \\mathcal{L}$ to the discrete output $K$. Compute the Shannon mutual information in bits, defined by\n$$\nI(L;K) = \\sum_{l \\in \\mathcal{L}} \\sum_{k=0}^{N_c} P(l,k)\\, \\log_2 \\left( \\frac{P(l,k)}{P(l)\\, P(k)} \\right),\n$$\nwhere $P(l,k)$ is the joint distribution estimated from simulation and $P(l) = 1/3$ is the prior over the three ligand values. To avoid zero-probability issues in finite sampling, use Laplace smoothing with a pseudo-count $\\alpha = 1$: if $n(l,k)$ are the raw joint counts over all simulated cells, compute $n_\\alpha(l,k) = n(l,k) + \\alpha$ and normalize to obtain $P_\\alpha(l,k) = \\dfrac{n_\\alpha(l,k)}{\\sum_{l,k} n_\\alpha(l,k)}$. Use $P_\\alpha(l,k)$ in place of $P(l,k)$ and the corresponding marginals $P_\\alpha(l)$ and $P_\\alpha(k)$ when evaluating $I(L;K)$. Report $I(L;K)$ in bits, rounded to four decimal places.\n4) Output format. Your program should produce a single line of output containing the results for the five test cases as a comma-separated list enclosed in square brackets. Each test case result must itself be a list of the form $[m, I\\_\\text{bits}, \\mathrm{CV}]$, where $m$ is the cluster size as an integer, $I\\_\\text{bits}$ is the mutual information in bits as a float rounded to four decimal places, and $\\mathrm{CV}$ is the coefficient of variation at $L = 1.0$ as a float rounded to four decimal places. For example, a result with two test cases would look like $[[m\\_1,I\\_1,\\mathrm{CV}\\_1],[m\\_2,I\\_2,\\mathrm{CV}\\_2]]$; in your case, include all five specified $m$ values in increasing order.\n\nScientific realism and rationale to guide your implementation:\n- The binomial sampling of receptor occupancy per cluster formalizes independent binding and the law of large numbers: the variance of $\\bar{X}$ scales as $1/m$, so larger clusters reduce upstream sampling noise.\n- The intrinsic noise $\\eta$ models downstream biochemical variability and ensures a non-degenerate threshold response.\n- Summing cluster-level threshold outputs models a stereotyped kinase activation count, and computing the coefficient of variation operationalizes noise at a fixed input.\n- Mutual information in bits is a principled metric of information transmission in signaling, grounded in information theory, and is computed directly from the empirical joint distribution with smoothing to mitigate finite-sample artifacts.\n\nAngle units are not involved. No physical units are required for the outputs: $I(L;K)$ must be reported in bits, and $\\mathrm{CV}$ is dimensionless. Ensure all reported numerical results are rounded to four decimal places as specified.", "solution": "The problem requires the formalization and simulation of a stochastic model for receptor-mediated kinase activation. We will analyze how receptor clustering influences signaling noise and information transmission. The solution involves three main stages: (1) simulating the kinase activation counts based on the provided biophysical model, (2) quantifying the output noise using the coefficient of variation (CV), and (3) quantifying the information transmitted from ligand input to kinase output using mutual information (MI).\n\n**1. Model Formalization and Simulation**\n\nThe system consists of a cell with a total of $N_R = 100$ receptors. These receptors are organized into $N_c$ clusters, each of size $m$, such that $N_c = N_R / m$. The test cases correspond to $m \\in \\{1, 5, 10, 20, 100\\}$.\n\nThe input to the system is the ligand concentration, $L$, which is a discrete random variable from the set $\\mathcal{L} = \\{0.1, 1.0, 10.0\\}$, with a uniform prior probability $P(l) = 1/3$ for each $l \\in \\mathcal{L}$. The binding of a ligand to a receptor is an independent stochastic event. The probability of a single receptor being occupied (bound) at equilibrium is given by the Hill-Langmuir equation:\n$$\np(L) = \\frac{L}{L + K_d}\n$$\nwhere the dissociation constant is given as $K_d = 1.0$.\n\nWithin a single cluster of size $m$, the number of bound receptors, $X$, follows a binomial distribution, as it represents the sum of $m$ independent Bernoulli trials, each with success probability $p(L)$:\n$$\nX \\sim \\mathrm{Binomial}(m, p(L))\n$$\nThe empirical mean occupancy for the cluster is $\\bar{X} = X/m$. According to the law of large numbers, as $m$ increases, the variance of this mean, $\\mathrm{Var}(\\bar{X}) = p(L)(1-p(L))/m$, decreases. This represents the reduction of upstream sampling noise through receptor clustering.\n\nA cluster becomes activated if its noisy mean occupancy, $\\bar{X} + \\eta$, surpasses a fixed threshold $\\theta = 0.5$. The term $\\eta$ represents intrinsic downstream noise, modeled as a Gaussian random variable with mean $0$ and variance $\\sigma^2$, where $\\sigma = 0.1$. The activation of a single cluster, $Y_c$, is thus a binary event:\n$$\nY_c = \\mathbf{1}\\{\\bar{X_c} + \\eta_c \\ge \\theta\\}\n$$\nwhere $\\mathbf{1}\\{\\cdot\\}$ is the indicator function.\n\nThe total kinase activation count for the cell, $K$, is the sum of activations across all $N_c$ clusters, which are assumed to be independent:\n$$\nK = \\sum_{c=1}^{N_c} Y_c\n$$\nThe possible values for $K$ range from $0$ to $N_c$.\n\nThe simulation proceeds by iterating through each cluster size $m$. For each $m$, and for each ligand concentration $L \\in \\mathcal{L}$, we simulate $N_{\\text{cells}} = 20000$ independent cells. For each simulated cell, we perform $N_c$ cluster-level simulations to calculate the total kinase count $K$. This process generates empirical conditional probability distributions $P(K|L)$, which are stored as a joint count matrix $n(l,k)$. A fixed random seed of $123$ is used to ensure reproducibility.\n\n**2. Noise Quantification: Coefficient of Variation (CV)**\n\nTo quantify signaling noise, we compute the coefficient of variation (CV) of the kinase count $K$ at a fixed input ligand concentration of $L = 1.0$. The CV is a standardized, dimensionless measure of dispersion, defined as the ratio of the standard deviation to the mean:\n$$\n\\mathrm{CV}_K = \\frac{\\sigma_K}{\\mu_K} = \\frac{\\sqrt{\\mathrm{Var}(K \\mid L=1.0)}}{\\mathbb{E}[K \\mid L=1.0]}\n$$\nThe mean $\\mathbb{E}[K \\mid L=1.0]$ and variance $\\mathrm{Var}(K \\mid L=1.0)$ are estimated using the sample mean and sample variance of the $N_{\\text{cells}}$ simulated values of $K$ obtained for $L=1.0$. The choice of $L=1.0$ is significant because it corresponds to $p(L=1.0) = 1.0 / (1.0 + 1.0) = 0.5$, the point where the binomial sampling variance is maximized. By convention, if the mean kinase count is zero, the CV is defined to be zero.\n\n**3. Information Transmission: Mutual Information (MI)**\n\nTo quantify how much information the output kinase count $K$ provides about the input ligand concentration $L$, we use the Shannon mutual information, $I(L;K)$. It is defined as:\n$$\nI(L;K) = \\sum_{l \\in \\mathcal{L}} \\sum_{k=0}^{N_c} P(l,k) \\log_2 \\left( \\frac{P(l,k)}{P(l)P(k)} \\right)\n$$\nwhere $P(l,k)$ is the joint probability distribution of $L$ and $K$, and $P(l)$ and $P(k)$ are the respective marginal distributions. The result is measured in bits.\n\nDue to the finite number of simulations ($N_{\\text{total}} = |\\mathcal{L}| \\times N_{\\text{cells}} = 3 \\times 20000$), some $(l,k)$ pairs may have zero counts, leading to problematic zero probabilities and undefined logarithms. To mitigate this finite-sampling artifact and reduce bias, we employ Laplace smoothing (or the add-one rule). We add a pseudocount of $\\alpha = 1$ to every entry in the raw joint count matrix $n(l,k)$:\n$$\nn_\\alpha(l,k) = n(l,k) + \\alpha\n$$\nThe smoothed joint probability distribution $P_\\alpha(l,k)$ is then calculated by normalizing these smoothed counts:\n$$\nP_\\alpha(l,k) = \\frac{n_\\alpha(l,k)}{\\sum_{l' \\in \\mathcal{L}} \\sum_{k'=0}^{N_c} n_\\alpha(l',k')}\n$$\nFrom this smoothed joint distribution, we compute the smoothed marginals $P_\\alpha(l) = \\sum_k P_\\alpha(l,k)$ and $P_\\alpha(k) = \\sum_l P_\\alpha(l,k)$. These smoothed distributions are then substituted into the mutual information formula for the final calculation:\n$$\nI(L;K) = \\sum_{l \\in \\mathcal{L}} \\sum_{k=0}^{N_c} P_\\alpha(l,k) \\log_2 \\left( \\frac{P_\\alpha(l,k)}{P_\\alpha(l)P_\\alpha(k)} \\right)\n$$\nThis procedure provides a robust estimate of the information transmitted by the signaling system for each configuration of cluster size $m$. The final computed values for the CV and MI are rounded to four decimal places as required.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Formalizes and simulates a stochastic model of receptor-mediated kinase activation\n    to examine the effects of clustering on noise and information transmission.\n    \"\"\"\n    # Define the test cases and model parameters from the problem statement.\n    NR = 100\n    m_values = [1, 5, 10, 20, 100]\n    Kd = 1.0\n    L_values = np.array([0.1, 1.0, 10.0])\n    theta = 0.5\n    sigma = 0.1\n    N_cells = 20000\n    seed = 123\n    alpha = 1.0  # Laplace smoothing pseudo-count\n\n    # Initialize the random number generator with a fixed seed for reproducibility.\n    rng = np.random.default_rng(seed)\n    \n    overall_results = []\n\n    for m in m_values:\n        Nc = NR // m\n        \n        # This matrix will store the raw counts n(l, k).\n        # Dimensions are (number of ligand values) x (max kinase count + 1).\n        joint_counts = np.zeros((len(L_values), Nc + 1))\n        \n        # This will store the kinase counts K for L=1.0 to calculate the CV.\n        K_at_L1 = None\n\n        for l_idx, L in enumerate(L_values):\n            # 1) Simulation of kinase counts.\n            # Calculate receptor occupancy probability.\n            p = L / (L + Kd)\n            \n            # Vectorized simulation for all cells and clusters for the current L.\n            # X: number of bound receptors per cluster. Shape: (N_cells, Nc).\n            X = rng.binomial(m, p, size=(N_cells, Nc))\n            \n            # x_bar: mean occupancy per cluster.\n            x_bar = X / m\n            \n            # eta: intrinsic noise per cluster.\n            eta = rng.normal(0, sigma, size=(N_cells, Nc))\n            \n            # Y: cluster activation indicator (1 if active, 0 otherwise).\n            Y = (x_bar + eta >= theta).astype(int)\n            \n            # K: total kinase activation count per cell. Shape: (N_cells,).\n            K_per_cell = np.sum(Y, axis=1)\n            \n            # If current ligand is L=1.0, save the K counts for CV calculation.\n            if L == 1.0:\n                K_at_L1 = K_per_cell.copy()\n            \n            # Tally the simulation results into the joint count matrix.\n            # np.bincount efficiently creates a histogram of the integer counts.\n            counts = np.bincount(K_per_cell, minlength=Nc + 1)\n            joint_counts[l_idx, :] = counts\n\n        # 2) Noise quantification (CV).\n        if K_at_L1 is None:\n            # This case should not be reached with the given L_values.\n            cv = 0.0\n        else:\n            mean_K = np.mean(K_at_L1)\n            # By convention, if mean is 0, CV is 0.\n            if mean_K == 0:\n                cv = 0.0\n            else:\n                var_K = np.var(K_at_L1)\n                cv = np.sqrt(var_K) / mean_K\n        \n        # 3) Information transmission metric (MI).\n        # Apply Laplace smoothing to the raw counts.\n        smoothed_counts = joint_counts + alpha\n        \n        # Calculate the smoothed joint and marginal probability distributions.\n        total_smoothed_counts = np.sum(smoothed_counts)\n        P_lk = smoothed_counts / total_smoothed_counts\n        \n        # Marginals are calculated from the smoothed joint distribution.\n        P_l = np.sum(P_lk, axis=1, keepdims=True)\n        P_k = np.sum(P_lk, axis=0, keepdims=True)\n        \n        # MI calculation. With smoothing, P_lk, P_l, P_k are all > 0, so log2 is safe.\n        term_inside_log = P_lk / (P_l * P_k)\n        log_term = np.log2(term_inside_log)\n        mi_bits = np.sum(P_lk * log_term)\n        \n        # Format the result string for the current cluster size m.\n        result_str = f\"[{m},{mi_bits:.4f},{cv:.4f}]\"\n        overall_results.append(result_str)\n\n    # Final print statement in the exact required format.\n    final_output_str = f\"[{','.join(overall_results)}]\"\n    print(final_output_str)\n\nsolve()\n```", "id": "2581921"}]}