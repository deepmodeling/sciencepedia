{"hands_on_practices": [{"introduction": "Mastering transport phenomena begins with a firm grasp of the fundamental principles. This first practice challenges you to derive the expression for membrane permeability ($P$) from Fick's first law, linking it to the solute’s in-membrane diffusivity ($D_m$) and its partitioning behavior ($K$). By working from first principles, you will solidify your understanding of how these microscopic properties give rise to the macroscopic transport behavior observed in physiological systems [@problem_id:2568709].", "id": "2568709", "problem": "A neutral small solute $X$ diffuses at steady state across a planar lipid membrane that separates two well-stirred aqueous compartments. The membrane has thickness $L_{m}$ and an in-membrane diffusivity $D_{m}$. At each water–membrane interface, rapid local equilibrium holds with a membrane–water partition coefficient $K$, defined as the ratio of the solute’s concentration just inside the membrane to its concentration just outside in water at the same interface. Assume no chemical reactions, no electrical potentials, and negligible unstirred aqueous boundary-layer resistances, so that the aqueous bulk concentrations can be taken as the interfacial aqueous concentrations. Let the one-dimensional coordinate $x$ run normal to the membrane, from side $1$ (at $x=0$) to side $2$ (at $x=L_{m}$), and take flux positive from side $1$ to side $2$.\n\nStarting only from Fick’s first law of diffusion in one dimension and the partition equilibrium at the interfaces, derive in your solution an expression for the membrane permeability $P$ in terms of $K$, $D_{m}$, and $L_{m}$ under the stated assumptions. Then evaluate $P$ numerically and compute the steady-state diffusive flux $J$ from side $1$ to side $2$ for the following data:\n- Partition coefficient: $K=10$.\n- In-membrane diffusivity: $D_{m}=1.0\\times 10^{-10}\\ \\mathrm{m^{2}\\, s^{-1}}$.\n- Membrane thickness: $L_{m}=5.0\\ \\mathrm{nm}$.\n- Aqueous bulk concentrations: $C_{1}=1.0\\times 10^{-2}\\ \\mathrm{mol\\, m^{-3}}$ on side $1$ and $C_{2}=1.0\\times 10^{-3}\\ \\mathrm{mol\\, m^{-3}}$ on side $2$.\n\nRound your final numerical results to four significant figures. Express $P$ in $\\mathrm{m\\, s^{-1}}$ and $J$ in $\\mathrm{mol\\, m^{-2}\\, s^{-1}}$. Provide your final answer as two numbers in the order $P$ then $J$.", "solution": "The problem posed is subject to validation. All givens are extracted verbatim: a neutral small solute $X$ diffuses at steady state across a planar lipid membrane of thickness $L_{m}$ and in-membrane diffusivity $D_{m}$. The membrane separates two well-stirred aqueous compartments. At each water–membrane interface ($x=0$ and $x=L_{m}$), rapid local equilibrium holds with a partition coefficient $K = C_{m}/C_{w}$. Assumptions are: no chemical reactions, no electrical potentials, and negligible unstirred aqueous boundary-layer resistances. The one-dimensional coordinate $x$ is normal to the membrane. The bulk aqueous concentrations are $C_{1}$ on side $1$ ($x=0$) and $C_{2}$ on side $2$ ($x=L_{m}$).\n\nThe specified data are:\n- Partition coefficient: $K=10$.\n- In-membrane diffusivity: $D_{m}=1.0\\times 10^{-10}\\ \\mathrm{m^{2}\\, s^{-1}}$.\n- Membrane thickness: $L_{m}=5.0\\ \\mathrm{nm}$.\n- Aqueous bulk concentrations: $C_{1}=1.0\\times 10^{-2}\\ \\mathrm{mol\\, m^{-3}}$ and $C_{2}=1.0\\times 10^{-3}\\ \\mathrm{mol\\, m^{-3}}$.\n\nThe problem asks for a derivation of the membrane permeability $P$ from first principles, followed by a numerical evaluation of $P$ and the steady-state flux $J$.\n\nThe problem is scientifically grounded, being a standard application of Fick's law of diffusion to membrane transport, a fundamental topic in biophysics and physiology. It is well-posed, providing all necessary information and consistent assumptions for a unique solution. The language is objective and precise. The numerical values provided are physically realistic for a biological membrane system. Therefore, the problem is deemed valid and a solution will be constructed.\n\nWe begin with Fick's first law of diffusion in one dimension, which governs the flux $J$ of the solute within the membrane:\n$$J = -D_{m} \\frac{dC_{m}(x)}{dx}$$\nHere, $C_{m}(x)$ is the concentration of the solute within the membrane at position $x$. At steady state, the flux $J$ must be constant for all $x$ within the membrane ($0 < x < L_{m}$). Since $D_{m}$ is also given as a constant, the concentration gradient $\\frac{dC_{m}(x)}{dx}$ must be constant as well. This implies a linear concentration profile for the solute across the membrane.\n\nWe can integrate the equation across the membrane's thickness, from $x=0$ to $x=L_{m}$:\n$$J \\int_{0}^{L_{m}} dx = -D_{m} \\int_{C_{m}(0)}^{C_{m}(L_{m})} dC_{m}$$\nThis yields:\n$$J L_{m} = -D_{m} [C_{m}(L_{m}) - C_{m}(0)]$$\nRearranging for the flux $J$:\n$$J = \\frac{D_{m}}{L_{m}} [C_{m}(0) - C_{m}(L_{m})]$$\nThe problem states that there is rapid local equilibrium at the two water-membrane interfaces. This equilibrium is described by the partition coefficient $K$, defined as $K = C_{m}/C_{w}$. Thus, the concentrations just inside the membrane, $C_{m}(0)$ and $C_{m}(L_{m})$, are related to the concentrations just outside in the aqueous phase, $C_{w,1}$ and $C_{w,2}$:\n$$C_{m}(0) = K \\cdot C_{w,1}$$\n$$C_{m}(L_{m}) = K \\cdot C_{w,2}$$\nA crucial assumption is the absence of significant unstirred boundary layers in the aqueous phases. This allows us to equate the interfacial aqueous concentrations with the bulk aqueous concentrations $C_{1}$ and $C_{2}$:\n$$C_{w,1} = C_{1}$$\n$$C_{w,2} = C_{2}$$\nSubstituting these relations into the expressions for the intramembrane concentrations gives:\n$$C_{m}(0) = K \\cdot C_{1}$$\n$$C_{m}(L_{m}) = K \\cdot C_{2}$$\nNow, we substitute these expressions back into the equation for the flux $J$:\n$$J = \\frac{D_{m}}{L_{m}} (K \\cdot C_{1} - K \\cdot C_{2}) = \\frac{K D_{m}}{L_{m}} (C_{1} - C_{2})$$\nThe permeability of the membrane, $P$, is phenomenologically defined as the proportionality constant relating the flux to the difference in bulk aqueous concentrations:\n$$J = P (C_{1} - C_{2})$$\nBy comparing this definition with the derived expression for $J$, we identify the analytical expression for the permeability $P$:\n$$P = \\frac{K D_{m}}{L_{m}}$$\nThis completes the required derivation.\n\nNext, we evaluate $P$ numerically. The given values are $K=10$, $D_{m}=1.0\\times 10^{-10}\\ \\mathrm{m^{2}\\, s^{-1}}$, and $L_{m}=5.0\\ \\mathrm{nm}$. We must ensure dimensional consistency. The thickness $L_{m}$ must be converted to meters:\n$$L_{m} = 5.0\\ \\mathrm{nm} = 5.0 \\times 10^{-9}\\ \\mathrm{m}$$\nSubstituting the numerical values into the expression for $P$:\n$$P = \\frac{(10) \\cdot (1.0 \\times 10^{-10}\\ \\mathrm{m^{2}\\, s^{-1}})}{5.0 \\times 10^{-9}\\ \\mathrm{m}} = \\frac{1.0 \\times 10^{-9}}{5.0 \\times 10^{-9}}\\ \\mathrm{m\\, s^{-1}} = 0.2\\ \\mathrm{m\\, s^{-1}}$$\nThe problem requires the result to be rounded to four significant figures. Thus, $P = 2.000 \\times 10^{-1}\\ \\mathrm{m\\, s^{-1}}$.\n\nFinally, we compute the steady-state diffusive flux $J$ using the relation $J = P (C_{1} - C_{2})$. The bulk concentrations are $C_{1}=1.0\\times 10^{-2}\\ \\mathrm{mol\\, m^{-3}}$ and $C_{2}=1.0\\times 10^{-3}\\ \\mathrm{mol\\, m^{-3}}$.\nThe concentration difference is:\n$$\\Delta C = C_{1} - C_{2} = (1.0 \\times 10^{-2} - 1.0 \\times 10^{-3})\\ \\mathrm{mol\\, m^{-3}}$$\n$$\\Delta C = (1.0 \\times 10^{-2} - 0.1 \\times 10^{-2})\\ \\mathrm{mol\\, m^{-3}} = 0.9 \\times 10^{-2}\\ \\mathrm{mol\\, m^{-3}} = 9.0 \\times 10^{-3}\\ \\mathrm{mol\\, m^{-3}}$$\nNow we calculate the flux $J$, using the exact value of $P$ for intermediary calculation to maintain precision:\n$$J = (0.2\\ \\mathrm{m\\, s^{-1}}) \\cdot (9.0 \\times 10^{-3}\\ \\mathrm{mol\\, m^{-3}}) = 1.8 \\times 10^{-3}\\ \\mathrm{mol\\, m^{-2}\\, s^{-1}}$$\nRounding this result to four significant figures as instructed:\n$$J = 1.800 \\times 10^{-3}\\ \\mathrm{mol\\, m^{-2}\\, s^{-1}}$$\nThe final numerical answers are $P = 2.000 \\times 10^{-1}\\ \\mathrm{m\\, s^{-1}}$ and $J = 1.800 \\times 10^{-3}\\ \\mathrm{mol\\, m^{-2}\\, s^{-1}}$.", "answer": "$$\\boxed{\\begin{pmatrix} 2.000 \\times 10^{-1} & 1.800 \\times 10^{-3} \\end{pmatrix}}$$"}, {"introduction": "Biological systems are rarely as simple as a single, isolated membrane. This exercise introduces a more realistic scenario by considering an unstirred layer (UL) of fluid adjacent to a cell, a common feature that adds another barrier to solute transport. You will explore how resistances to diffusion add in series, deriving a composite permeability for the UL-membrane system and analyzing when the UL becomes the rate-limiting step for uptake [@problem_id:2568678].", "id": "2568678", "problem": "A small, nonreactive solute moves from a well-mixed bulk aqueous phase toward a cell across a quiescent Unstirred Layer (UL) of thickness $\\delta$ that abuts the plasma membrane. The solute’s diffusion in the UL is isotropic with aqueous diffusion coefficient $D$, and transport is one-dimensional and steady with no accumulation in any compartment. The membrane itself presents an intrinsic permeability $P_{m}$ for the solute (arising from partitioning into the lipid and diffusion across the bilayer), and the bulk and cytosolic concentrations are held fixed at $c_{b}$ and $c_{i}$, respectively.\n\nStarting only from Fick’s first law of diffusion in one dimension, $J=-D\\,\\partial c/\\partial x$, and the definition of permeability as the proportionality between steady flux and the driving concentration difference across a barrier, do the following:\n\n1) Derive the permeability of the Unstirred Layer (UL), $P_{\\mathrm{UL}}$, in terms of $D$ and $\\delta$.\n\n2) Using steady-state flux continuity across the UL and the membrane, derive the expression for the composite permeability $P_{\\mathrm{tot}}$ of the UL and membrane acting in series. Based on this expression, state the condition (as an inequality involving $P_{m}$ and $P_{\\mathrm{UL}}$) under which the UL limits the overall flux relative to the membrane.\n\nThen evaluate $P_{\\mathrm{UL}}$ numerically for the parameter values $\\delta = 100\\ \\mu\\mathrm{m}$ and $D = 1 \\times 10^{-9}\\ \\mathrm{m^{2}/s}$. Express the final $P_{\\mathrm{UL}}$ in $\\mathrm{cm/s}$ and round to three significant figures. Report only the numerical value of $P_{\\mathrm{UL}}$ in the requested units as your final answer.", "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information for a complete derivation and numerical calculation. It is a standard problem in transport biophysics. We shall proceed with the solution.\n\nThe system consists of three compartments in series: a well-mixed bulk phase with solute concentration $c_{b}$, a quiescent Unstirred Layer (UL) of thickness $\\delta$, and a cell with a fixed internal concentration $c_{i}$. Transport of the solute is one-dimensional and at steady state. Let the coordinate $x$ be normal to the membrane, with $x=0$ at the interface between the bulk solution and the UL, and $x=\\delta$ at the interface between the UL and the outer surface of the plasma membrane. The concentration at $x=0$ is that of the bulk phase, $c(0) = c_{b}$. The concentration at the outer surface of the membrane, at $x=\\delta$, we denote as $c_{m,o}$.\n\nFirst, we derive the permeability of the Unstirred Layer, $P_{\\mathrm{UL}}$.\nThe transport across the UL is governed by Fick's first law in one dimension:\n$$J = -D \\frac{dc}{dx}$$\nwhere $J$ is the molar flux and $D$ is the diffusion coefficient. The problem states that the system is at steady state, which means the flux $J$ must be constant for all values of $x$ within the UL. Consequently, the concentration gradient $\\frac{dc}{dx}$ must also be constant. This implies that the concentration profile $c(x)$ across the UL is linear.\n\nThe constant gradient can therefore be written as the total concentration difference across the layer divided by its thickness:\n$$\\frac{dc}{dx} = \\frac{c(\\delta) - c(0)}{\\delta - 0} = \\frac{c_{m,o} - c_{b}}{\\delta}$$\nSubstituting this expression for the gradient into Fick's law gives the flux across the UL, which we denote $J_{\\mathrm{UL}}$:\n$$J_{\\mathrm{UL}} = -D \\left( \\frac{c_{m,o} - c_{b}}{\\delta} \\right) = \\frac{D}{\\delta} (c_{b} - c_{m,o})$$\nThe problem defines permeability, $P$, through the relation $J = P \\Delta c$, where $\\Delta c$ is the concentration difference across the barrier. For the UL, the flux is $J_{\\mathrm{UL}}$ and the concentration difference is $\\Delta c_{\\mathrm{UL}} = c_b - c_{m,o}$. Thus, we can write:\n$$J_{\\mathrm{UL}} = P_{\\mathrm{UL}}(c_b - c_{m,o})$$\nBy comparing the two expressions for $J_{\\mathrm{UL}}$, we can directly identify the permeability of the Unstirred Layer:\n$$P_{\\mathrm{UL}} = \\frac{D}{\\delta}$$\nThis completes the first part of the problem.\n\nSecond, we derive the composite permeability, $P_{\\mathrm{tot}}$, for the UL and the membrane in series.\nThe flux across the membrane, $J_m$, is given by its intrinsic permeability, $P_m$, and the concentration difference across it. This difference is between the outer surface concentration, $c_{m,o}$, and the fixed cytosolic concentration, $c_i$:\n$$J_m = P_m (c_{m,o} - c_i)$$\nAt steady state, the flux must be continuous throughout the system, meaning the flux across the UL must equal the flux across the membrane, and this common flux is the total flux, $J$. So, $J = J_{\\mathrm{UL}} = J_m$.\nWe now have a system of two equations involving the unknown intermediate concentration $c_{m,o}$:\n$$J = P_{\\mathrm{UL}}(c_b - c_{m,o})$$\n$$J = P_m(c_{m,o} - c_i)$$\nWe can rearrange these equations to express the concentration drops across each barrier in terms of the flux:\n$$c_b - c_{m,o} = \\frac{J}{P_{\\mathrm{UL}}}$$\n$$c_{m,o} - c_i = \\frac{J}{P_m}$$\nAdding these two equations eliminates $c_{m,o}$ and gives the total concentration drop across the entire system, $c_b - c_i$:\n$$(c_b - c_{m,o}) + (c_{m,o} - c_i) = \\frac{J}{P_{\\mathrm{UL}}} + \\frac{J}{P_m}$$\n$$c_b - c_i = J \\left( \\frac{1}{P_{\\mathrm{UL}}} + \\frac{1}{P_m} \\right)$$\nThe overall flux $J$ is related to the total permeability, $P_{\\mathrm{tot}}$, and the total concentration difference, $c_b - c_i$, by the definitional relationship $J = P_{\\mathrm{tot}}(c_b - c_i)$. Comparing this with our derived expression for $J$, we find the relationship for the total permeability:\n$$\\frac{1}{P_{\\mathrm{tot}}} = \\frac{1}{P_{\\mathrm{UL}}} + \\frac{1}{P_m}$$\nThis demonstrates that the resistances to transport ($R = 1/P$) for barriers in series are additive: $R_{\\mathrm{tot}} = R_{\\mathrm{UL}} + R_m$. The composite permeability is explicitly $P_{\\mathrm{tot}} = \\frac{P_{\\mathrm{UL}}P_m}{P_{\\mathrm{UL}} + P_m}$.\n\nThe Unstirred Layer limits the overall flux when its resistance to transport, $R_{\\mathrm{UL}} = 1/P_{\\mathrm{UL}}$, is the dominant contribution to the total resistance. This occurs when its resistance is greater than the membrane's resistance, $R_m = 1/P_m$. Therefore, the condition for the UL being the flux-limiting barrier is:\n$$R_{\\mathrm{UL}} > R_m$$\nSubstituting the permeability definitions, we have:\n$$\\frac{1}{P_{\\mathrm{UL}}} > \\frac{1}{P_m}$$\nSince permeabilities are positive quantities, this inequality is equivalent to:\n$$P_m > P_{\\mathrm{UL}}$$\nThis is the condition under which the Unstirred Layer limits the overall flux. Intuitively, if the membrane is highly permeable ($P_m$ is large), the bottleneck becomes the rate at which the solute can diffuse through the UL to reach the membrane.\n\nFinally, we perform the numerical evaluation of $P_{\\mathrm{UL}}$.\nThe problem provides the parameters $D = 1 \\times 10^{-9}\\ \\mathrm{m^2/s}$ and $\\delta = 100\\ \\mu\\mathrm{m}$. We use the derived formula $P_{\\mathrm{UL}} = D/\\delta$. It is imperative to work with consistent units. We will convert all quantities to SI units (meters and seconds).\nThe thickness $\\delta$ is given as $100\\ \\mu\\mathrm{m}$:\n$$\\delta = 100\\ \\mu\\mathrm{m} = 100 \\times 10^{-6}\\ \\mathrm{m} = 1 \\times 10^{-4}\\ \\mathrm{m}$$\nNow, we calculate $P_{\\mathrm{UL}}$:\n$$P_{\\mathrm{UL}} = \\frac{D}{\\delta} = \\frac{1 \\times 10^{-9}\\ \\mathrm{m^2/s}}{1 \\times 10^{-4}\\ \\mathrm{m}} = 1 \\times 10^{-5}\\ \\mathrm{m/s}$$\nThe problem requires the final answer to be in units of $\\mathrm{cm/s}$. We perform the unit conversion, noting that $1\\ \\mathrm{m} = 100\\ \\mathrm{cm}$:\n$$P_{\\mathrm{UL}} = (1 \\times 10^{-5}\\ \\mathrm{m/s}) \\times \\left(\\frac{100\\ \\mathrm{cm}}{1\\ \\mathrm{m}}\\right) = 1 \\times 10^{-3}\\ \\mathrm{cm/s}$$\nThis numerical value is $0.001$. The problem specifies that the answer must be rounded to three significant figures. To express $0.001$ with three significant figures, we write it as $0.00100$.", "answer": "$$\\boxed{0.00100}$$"}, {"introduction": "While analytical solutions provide deep insight, predicting the dynamic behavior of complex systems often requires computational methods. This advanced practice bridges theory and application by guiding you through the design of a finite difference simulation for diffusion across a permeable membrane. You will translate the continuous physics of Fick's laws and interface flux into a discrete numerical algorithm, tackling crucial concepts like stability and model validation against an analytical steady state [@problem_id:2568763].", "id": "2568763", "problem": "You are to design and implement an explicit finite difference method to solve the one-dimensional Fickian diffusion equation with a permeable membrane at an internal interface. The governing equation in each homogeneous region is the diffusion equation $\\partial C / \\partial t = D \\, \\partial^2 C / \\partial x^2$, where $C(x,t)$ is concentration and $D$ is the diffusion coefficient. The interface at $x=0$ is a thin membrane with permeability $P$, modeled by a constitutive boundary condition in terms of a flux that is proportional to the concentration jump across the membrane. The physical situation is two semi-domains of equal length, the left domain $x \\in [-L_{\\mathrm{left}}, 0]$ and the right domain $x \\in [0, L_{\\mathrm{right}}]$, with the same diffusion coefficient $D$ in both domains. Impose constant Dirichlet boundary concentrations $C(-L_{\\mathrm{left}}, t) = C_A$ and $C(L_{\\mathrm{right}}, t) = C_B$ for all time $t$. Assume $D$ and $P$ are constant and positive.\n\nYour task is to:\n- Start from Fick's First Law and mass conservation to derive a consistent interface condition at $x=0$ that couples the two domains through the membrane permeability $P$, and derive a finite difference update for an explicit time-stepping scheme on a uniform grid of spacing $\\Delta x$ that respects conservation at the interface. Your derivation must be grounded in discretized balances and consistent approximations of fluxes at cell faces, without assuming any pre-existing discrete interface formula.\n- Analyze stability of the explicit scheme using a principle-based argument. In particular, justify the commonly cited interior stability condition $\\Delta t \\le (\\Delta x)^2 / (2 D)$ in one dimension, and reason about how the membrane exchange term modifies or adds to the stability requirements for the interface nodes.\n\nNumerical experiment specification:\n- Use $D = 1.0 \\times 10^{-9}$ m$^2$/s, $L_{\\mathrm{left}} = 5.0 \\times 10^{-5}$ m, $L_{\\mathrm{right}} = 5.0 \\times 10^{-5}$ m, $\\Delta x = 1.0 \\times 10^{-6}$ m, $C_A = 1.0$ mol/m$^3$, $C_B = 0.0$ mol/m$^3$, and final simulation time $T_{\\mathrm{end}} = 5.0$ s. Initialize $C(x,0)$ to any bounded profile consistent with the boundary data that is not already the steady state.\n- Implement an explicit time-stepping algorithm that remains numerically stable. The time step $\\Delta t$ used in your code must satisfy conditions that ensure stability in all three test cases below; you must determine such a choice based on your stability analysis. You must not use any implicit method or stabilization beyond obeying your derived explicit stability requirements.\n\nAnalytical steady state for validation:\n- For the steady state, each region satisfies $\\partial^2 C / \\partial x^2 = 0$, with constant flux and a membrane flux proportional to the jump at $x=0$. From these principles, there is a unique steady linear profile in each region. Use this to construct the analytical steady-state concentration profile $C^\\ast(x)$ in both domains as a function of $D$, $P$, $L_{\\mathrm{left}}$, $L_{\\mathrm{right}}$, $C_A$, and $C_B$.\n\nTest suite:\n- Three cases differ only by membrane permeability $P$:\n  1. Case A (moderate permeability): $P = 1.0 \\times 10^{-5}$ m/s.\n  2. Case B (low permeability): $P = 1.0 \\times 10^{-7}$ m/s.\n  3. Case C (high permeability): $P = 1.0 \\times 10^{-3}$ m/s.\n- For each case, simulate until $T_{\\mathrm{end}}$ using your explicit, stable scheme, then compute the maximum absolute deviation between your numerical concentration at the final time and the analytical steady-state concentration over the discrete grid points in both domains. Denote these deviations by $E_A$, $E_B$, and $E_C$ respectively.\n\nUnits and numerical format:\n- All physical quantities are in SI units. Report each deviation $E$ in mol/m$^3$ as a real number rounded to $6$ decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order of the cases, i.e., $[E_A,E_B,E_C]$.\n\nConstraints and reminders:\n- The derivation must originate from Fick's First Law and conservation, without assuming any pre-assembled discrete interface stencil.\n- The stability analysis must argue from first principles and justify why $\\Delta t \\le (\\Delta x)^2 / (2 D)$ is necessary for interior nodes, and what additional restriction is required due to the membrane term at the interface to maintain stability of the explicit update.\n- Ensure scientific realism throughout and do not invent unphysical parameter values.\n\nYour implementation must be a complete, runnable program that produces the required single-line output for the above test suite. No user input is permitted.", "solution": "The problem statement is submitted for validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n\n- **Governing Equation**: $\\partial C / \\partial t = D \\, \\partial^2 C / \\partial x^2$ in each domain.\n- **Domains**: Left: $x \\in [-L_{\\mathrm{left}}, 0]$. Right: $x \\in [0, L_{\\mathrm{right}}]$.\n- **Diffusion Coefficient**: $D$, constant and positive, same in both domains.\n- **Interface**: A thin membrane at $x=0$ with permeability $P > 0$.\n- **Interface Flux Condition**: Flux is proportional to the concentration jump, $J_{\\text{mem}} = P(C(0^-, t) - C(0^+, t))$.\n- **Boundary Conditions**: $C(-L_{\\mathrm{left}}, t) = C_A$ and $C(L_{\\mathrm{right}}, t) = C_B$ (constant Dirichlet).\n- **Grid**: Uniform spacing $\\Delta x$.\n- **Numerical Method**: Explicit finite difference method.\n- **Initial Condition**: $C(x,0)$ is a bounded profile consistent with boundary data, not equal to the steady state.\n- **Numerical Parameters**: $D = 1.0 \\times 10^{-9}$ m$^2$/s, $L_{\\mathrm{left}} = 5.0 \\times 10^{-5}$ m, $L_{\\mathrm{right}} = 5.0 \\times 10^{-5}$ m, $\\Delta x = 1.0 \\times 10^{-6}$ m, $C_A = 1.0$ mol/m$^3$, $C_B = 0.0$ mol/m$^3$, $T_{\\mathrm{end}} = 5.0$ s.\n- **Test Cases (Permeability)**:\n    1. Case A: $P = 1.0 \\times 10^{-5}$ m/s.\n    2. Case B: $P = 1.0 \\times 10^{-7}$ m/s.\n    3. Case C: $P = 1.0 \\times 10^{-3}$ m/s.\n- **Task**:\n    1. Derive the finite difference update for the interface from first principles (Fick's law and mass conservation).\n    2. Analyze the stability of the explicit scheme for both interior and interface nodes.\n    3. Derive the analytical steady-state solution $C^\\ast(x)$.\n    4. Implement the scheme and compute the maximum absolute deviation $E$ between the numerical solution at $T_{\\mathrm{end}}$ and the analytical steady state for each case.\n- **Output Format**: A single line `[E_A,E_B,E_C]` with values rounded to $6$ decimal places.\n\n### Step 2: Validate Using Extracted Givens\n\n- **Scientifically Grounded**: The problem describes Fickian diffusion across a permeable barrier, a fundamental process in transport phenomena relevant to fields like cell physiology and chemical engineering. It is firmly based on established physical laws.\n- **Well-Posed**: The problem is a well-posed initial-boundary value problem for a parabolic partial differential equation. The givens are sufficient to construct a unique, stable, and meaningful solution.\n- **Objective**: The problem is stated in precise, quantitative terms. No subjective or opinion-based claims are present.\n- **Completeness and Consistency**: The problem provides all necessary parameters, boundary conditions, and a clear description of the physical model. There are no contradictions.\n- **Realism**: The provided numerical values for $D$, $L$, and $P$ are physically plausible for molecular diffusion in biological contexts.\n\nAll validation criteria are met. The problem is devoid of flaws.\n\n### Verdict and Action\n\nThe problem is valid. I will proceed with the derivation and solution.\n\n---\n\n### Derivation of the Finite Difference Scheme\n\nThe domain is discretized using a uniform grid. Due to the concentration discontinuity at the membrane, we define two sets of concentration arrays. Let the left domain $x \\in [-L_{\\mathrm{left}}, 0]$ be discretized by nodes $x_j = -L_{\\mathrm{left}} + j\\Delta x$ for $j=0, 1, \\dots, M$, where $M = L_{\\mathrm{left}}/\\Delta x$. The concentration at these nodes is $C_{L,j}$. The a node is located at the interface, $x_M=0$. Similarly, the right domain $x \\in [0, L_{\\mathrm{right}}]$ is discretized by nodes $x_k = k\\Delta x$ for $k=0, 1, \\dots, N$, where $N = L_{\\mathrm{right}}/\\Delta x$. The concentration is $C_{R,k}$. The node $x_0=0$ is at the interface. Thus, we have two concentration values at the physical location $x=0$: $C_{L,M}$ representing $C(0^-, t)$ and $C_{R,0}$ representing $C(0^+, t)$.\n\n**Interior Nodes:**\nFor interior nodes not adjacent to the interface, the standard central difference approximation to the one-dimensional diffusion equation is used. For a node $j$ in the left domain ($1 \\le j \\le M-1$) or a node $k$ in the right domain ($1 \\le k \\le N-1$), the semi-discretized equation is:\n$$\n\\frac{dC_i}{dt} = D \\frac{C_{i+1} - 2C_i + C_{i-1}}{(\\Delta x)^2}\n$$\nwhere $i$ is the generic index. Applying an explicit forward Euler time-stepping method with time step $\\Delta t$, we get the update rule:\n$$\nC_i^{n+1} = C_i^n + \\frac{D \\Delta t}{(\\Delta x)^2} (C_{i+1}^n - 2C_i^n + C_{i-1}^n)\n$$\nwhere the superscript $n$ denotes the time level $t_n = n\\Delta t$.\n\n**Interface Nodes:**\nThe update rule for the interface nodes $C_{L,M}$ and $C_{R,0}$ is derived from mass conservation.\nConsider a control volume for the node $C_{L,M}$ extending from $x_M - \\Delta x/2$ to $x_M = 0$. Its volume is $\\Delta x/2$. The rate of change of mass within this volume is $(\\Delta x/2) \\, dC_{L,M}/dt$. This change is balanced by the net flux into the volume. The flux at the left face ($x = x_M - \\Delta x/2$) is the diffusive flux $J_{\\text{diff}}$, and the flux at the right face ($x=0$) is the membrane flux $J_{\\text{mem}}$.\n$$\n\\frac{\\Delta x}{2} \\frac{dC_{L,M}}{dt} = J_{\\text{diff}}(x_M - \\Delta x/2) - J_{\\text{mem}}(0)\n$$\nWe approximate the fluxes using Fick's First Law, $J = -D \\, \\partial C/\\partial x$, and the given membrane constitutive relation:\n- $J_{\\text{diff}}(x_M - \\Delta x/2) \\approx -D \\frac{C_{L,M} - C_{L,M-1}}{\\Delta x}$\n- $J_{\\text{mem}}(0) = P(C_{L,M} - C_{R,0})$\nSubstituting these into the balance equation gives:\n$$\n\\frac{\\Delta x}{2} \\frac{dC_{L,M}}{dt} = -D \\frac{C_{L,M} - C_{L,M-1}}{\\Delta x} - P(C_{L,M} - C_{R,0})\n$$\n$$\n\\frac{dC_{L,M}}{dt} = \\frac{2D}{(\\Delta x)^2} (C_{L,M-1} - C_{L,M}) - \\frac{2P}{\\Delta x}(C_{L,M} - C_{R,0})\n$$\nAnalogously, for the node $C_{R,0}$, we consider a control volume from $x=0$ to $x = \\Delta x/2$. The mass balance is:\n$$\n\\frac{\\Delta x}{2} \\frac{dC_{R,0}}{dt} = J_{\\text{mem}}(0) - J_{\\text{diff}}(\\Delta x/2)\n$$\nThe fluxes are:\n- $J_{\\text{mem}}(0) = P(C_{L,M} - C_{R,0})$\n- $J_{\\text{diff}}(\\Delta x/2) \\approx -D \\frac{C_{R,1} - C_{R,0}}{\\Delta x}$\nSubstituting these gives:\n$$\n\\frac{\\Delta x}{2} \\frac{dC_{R,0}}{dt} = P(C_{L,M} - C_{R,0}) - \\left(-D \\frac{C_{R,1} - C_{R,0}}{\\Delta x}\\right)\n$$\n$$\n\\frac{dC_{R,0}}{dt} = \\frac{2P}{\\Delta x}(C_{L,M} - C_{R,0}) + \\frac{2D}{(\\Delta x)^2}(C_{R,1} - C_{R,0})\n$$\nApplying the forward Euler scheme to these semi-discretized equations yields the explicit update rules for the interface nodes.\n\n### Stability Analysis\n\nFor an explicit scheme to be stable, the updated concentration at a node must be a convex combination of the concentrations at neighboring nodes from the previous time step. This requires all coefficients in the update stencil to be non-negative.\n\n**Interior Nodes:**\nThe update rule is $C_i^{n+1} = r C_{i-1}^n + (1-2r)C_i^n + r C_{i+1}^n$, where $r = D\\Delta t/(\\Delta x)^2$. Since $r > 0$, stability requires the coefficient of $C_i^n$ to be non-negative:\n$$\n1 - 2r \\ge 0 \\implies r \\le \\frac{1}{2}\n$$\nThis yields the standard Courant-Friedrichs-Lewy (CFL) condition for one-dimensional diffusion:\n$$\n\\Delta t \\le \\frac{(\\Delta x)^2}{2D}\n$$\n\n**Interface Nodes:**\nLet's analyze the update for $C_{L,M}^{n+1}$:\n$$\nC_{L,M}^{n+1} = C_{L,M}^n + \\Delta t \\left[ \\frac{2D}{(\\Delta x)^2} (C_{L,M-1}^n - C_{L,M}^n) - \\frac{2P}{\\Delta x}(C_{L,M}^n - C_{R,0}^n) \\right]\n$$\nRearranging terms:\n$$\nC_{L,M}^{n+1} = \\left(\\frac{2D\\Delta t}{(\\Delta x)^2}\\right)C_{L,M-1}^n + \\left(1 - \\frac{2D\\Delta t}{(\\Delta x)^2} - \\frac{2P\\Delta t}{\\Delta x}\\right)C_{L,M}^n + \\left(\\frac{2P\\Delta t}{\\Delta x}\\right)C_{R,0}^n\n$$\nThe coefficients of $C_{L,M-1}^n$ and $C_{R,0}^n$ are positive. For stability, the coefficient of $C_{L,M}^n$ must be non-negative:\n$$\n1 - \\frac{2D\\Delta t}{(\\Delta x)^2} - \\frac{2P\\Delta t}{\\Delta x} \\ge 0 \\implies 1 \\ge \\Delta t \\left( \\frac{2D}{(\\Delta x)^2} + \\frac{2P}{\\Delta x} \\right)\n$$\n$$\n\\Delta t \\le \\frac{1}{\\frac{2D}{(\\Delta x)^2} + \\frac{2P}{\\Delta x}} = \\frac{(\\Delta x)^2}{2D + 2P\\Delta x}\n$$\nAn identical analysis for the $C_{R,0}$ node yields the same condition. As $P > 0$ and $\\Delta x > 0$, the term $2P\\Delta x$ is positive, making this condition more restrictive than the interior node condition. Therefore, the overall stability of the scheme is governed by the interface nodes:\n$$\n\\Delta t_{\\text{stable}} \\le \\frac{(\\Delta x)^2}{2D + 2P\\Delta x}\n$$\n\n### Analytical Steady-State Solution\n\nIn steady state, $\\partial C/\\partial t = 0$, so the governing equation simplifies to $d^2C/dx^2 = 0$. This implies that the concentration profile $C^\\ast(x)$ is linear in each domain.\n- Left domain ($x \\in [-L_{\\mathrm{left}}, 0]$): $C_{\\text{left}}^\\ast(x) = a x + b_L$.\n- Right domain ($x \\in [0, L_{\\mathrm{right}}]$): $C_{\\text{right}}^\\ast(x) = a x + b_R$.\nThe diffusion coefficient $D$ is constant throughout both bulk domains, so the flux $J^\\ast = -D(dC/dx)$ must be constant everywhere except at the membrane. In steady-state with no sources or sinks, the flux must be constant throughout the entire system, including across the membrane. This means the slope $a=-J^\\ast/D$ must be the same in both regions.\n\nWe have a system of four equations for the four unknowns $a, b_L, b_R, J^\\ast$:\n1. $C_{\\text{left}}^\\ast(-L_{\\mathrm{left}}) = C_A \\implies -a L_{\\mathrm{left}} + b_L = C_A$\n2. $C_{\\text{right}}^\\ast(L_{\\mathrm{right}}) = C_B \\implies a L_{\\mathrm{right}} + b_R = C_B$\n3. $J^\\ast = -Da$\n4. $J^\\ast = P (C_{\\text{left}}^\\ast(0) - C_{\\text{right}}^\\ast(0)) = P(b_L - b_R)$\n\nFrom (3) and (4): $-Da = P(b_L - b_R)$.\nFrom (1) and (2): $b_L = C_A + a L_{\\mathrm{left}}$ and $b_R = C_B - a L_{\\mathrm{right}}$.\nSubstituting $b_L$ and $b_R$ into the flux equation:\n$-Da = P((C_A + a L_{\\mathrm{left}}) - (C_B - a L_{\\mathrm{right}}))$\n$-Da = P(C_A - C_B) + Pa(L_{\\mathrm{left}} + L_{\\mathrm{right}})$\n$-a(D + P(L_{\\mathrm{left}} + L_{\\mathrm{right}})) = P(C_A - C_B)$. This is incorrect.\nLet us retry the substitution:\n$(C_A + a L_{\\mathrm{left}}) - (C_B - a L_{\\mathrm{right}}) = - \\frac{D}{P} a$\n$C_A - C_B + a(L_{\\mathrm{left}} + L_{\\mathrm{right}}) = - \\frac{D}{P} a$\n$C_A - C_B = -a \\left( L_{\\mathrm{left}} + L_{\\mathrm{right}} + \\frac{D}{P} \\right)$\nSolving for the slope $a$:\n$$\na = - \\frac{C_A - C_B}{L_{\\mathrm{left}} + L_{\\mathrm{right}} + D/P}\n$$\nWith $a$ determined, the intercepts are:\n$$\nb_L = C_A + a L_{\\mathrm{left}}\n$$\n$$\nb_R = C_B - a L_{\\mathrm{right}}\n$$\nThese expressions define the unique analytical steady-state solution $C^\\ast(x)$.\n\n### Numerical Implementation\n\nFor the simulation, the most restrictive stability condition, corresponding to the highest permeability $P_C = 1.0 \\times 10^{-3}$ m/s, must be used to select $\\Delta t$.\n$\\Delta t_{\\text{max}} = \\frac{(1.0 \\times 10^{-6})^2}{2(1.0 \\times 10^{-9}) + 2(1.0 \\times 10^{-3})(1.0 \\times 10^{-6})} = \\frac{10^{-12}}{2 \\times 10^{-9} + 2 \\times 10^{-9}} = 0.25 \\times 10^{-3} \\text{ s}$.\nA value of $\\Delta t=2.0 \\times 10^{-4}$ s is chosen to safely satisfy this condition for all test cases. The initial condition is a linear profile between $C_A$ and $C_B$ across the entire domain $[-L_{\\text{left}}, L_{\\text{right}}]$, which is not a steady state for any finite $P$. The simulation is run until $T_{\\text{end}}=5.0$ s. The maximum absolute difference between the final numerical profile and the analytical steady-state profile is computed over all grid points.", "answer": "```python\nimport numpy as np\nfrom math import ceil\n\ndef solve():\n    \"\"\"\n    Solves the 1D diffusion equation with a permeable membrane,\n    calculates deviations from steady state for three test cases,\n    and prints the results in the required format.\n    \"\"\"\n    #\n    # --- Problem Parameters ---\n    #\n    D = 1.0e-9  # Diffusion coefficient (m^2/s)\n    L_left = 5.0e-5  # Left domain length (m)\n    L_right = 5.0e-5  # Right domain length (m)\n    dx = 1.0e-6  # Spatial step (m)\n    C_A = 1.0  # Left boundary concentration (mol/m^3)\n    C_B = 0.0  # Right boundary concentration (mol/m^3)\n    T_end = 5.0  # Final simulation time (s)\n\n    # Test cases for permeability (m/s)\n    permeabilities = {\n        'A': 1.0e-5,  # Moderate permeability\n        'B': 1.0e-7,  # Low permeability\n        'C': 1.0e-3,  # High permeability\n    }\n\n    #\n    # --- Discretization and Stability ---\n    #\n    M = int(round(L_left / dx))  # Number of segments in left domain\n    N = int(round(L_right / dx)) # Number of segments in right domain\n\n    # Determine stable time step based on the most restrictive case (highest P)\n    P_max = max(permeabilities.values())\n    dt_max_stable = dx**2 / (2 * D + 2 * P_max * dx)\n    \n    # Use a time step with a safety factor\n    safety_factor = 0.95\n    dt = safety_factor * dt_max_stable\n    \n    num_steps = ceil(T_end / dt)\n\n    #\n    # --- Analytical Steady-State Solution ---\n    #\n    def get_analytical_solution(P):\n        \"\"\"Computes the analytical steady-state solution for a given permeability P.\"\"\"\n        # Calculate slope 'a' and intercepts 'b_L', 'b_R'\n        a = -(C_A - C_B) / (L_left + L_right + D / P)\n        b_L = C_A + a * L_left\n        b_R = C_B - a * L_right\n\n        # Grid coordinates\n        x_L = np.linspace(-L_left, 0, M + 1)\n        x_R = np.linspace(0, L_right, N + 1)\n\n        # Concentration profiles\n        C_L_analytical = a * x_L + b_L\n        C_R_analytical = a * x_R + b_R\n        \n        return C_L_analytical, C_R_analytical\n\n    #\n    # --- Simulation and Error Calculation ---\n    #\n    devs = []\n    \n    # Sort cases to ensure specified order [E_A, E_B, E_C]\n    case_order = ['A', 'B', 'C']\n    \n    for case_key in case_order:\n        P = permeabilities[case_key]\n\n        #\n        # --- Initialization ---\n        #\n        # Unified grid for initial condition\n        x_total = np.linspace(-L_left, L_right, M + N + 1)\n        C_initial = C_B + (C_A - C_B) * (L_right - x_total) / (L_left + L_right)\n        \n        # Split into left and right domain arrays\n        C_L = C_initial[:M+1].copy()\n        C_R = C_initial[M:].copy()\n        \n        # --- Time-stepping Loop ---\n        #\n        r_D = D * dt / dx**2\n        r_P = P * dt / dx\n\n        C_L_new = np.copy(C_L)\n        C_R_new = np.copy(C_R)\n        \n        for step in range(num_steps):\n            # Apply fixed boundary conditions\n            C_L_new[0] = C_A\n            C_R_new[N] = C_B\n            \n            # Update interior nodes (vectorized)\n            # Left domain: indices 1 to M-1\n            C_L_new[1:M] = C_L[1:M] + r_D * (C_L[2:M+1] + C_L[0:M-1] - 2 * C_L[1:M])\n\n            # Right domain: indices 1 to N-1\n            C_R_new[1:N] = C_R[1:N] + r_D * (C_R[2:N+1] + C_R[0:N-1] - 2 * C_R[1:N])\n            \n            # Update interface nodes (at x=0)\n            # C_L[M] is at x=0^-\n            C_L_new[M] = C_L[M] + 2 * r_D * (C_L[M-1] - C_L[M]) - 2 * r_P * (C_L[M] - C_R[0])\n            \n            # C_R[0] is at x=0^+\n            C_R_new[0] = C_R[0] + 2 * r_D * (C_R[1] - C_R[0]) + 2 * r_P * (C_L[M] - C_R[0])\n            \n            # Swap buffers for next iteration\n            C_L, C_L_new = C_L_new, C_L\n            C_R, C_R_new = C_R_new, C_R\n\n        #\n        # --- Deviation Calculation ---\n        #\n        C_L_analytical, C_R_analytical = get_analytical_solution(P)\n        \n        # Calculate absolute deviations for both domains\n        dev_L = np.abs(C_L - C_L_analytical)\n        dev_R = np.abs(C_R - C_R_analytical)\n        \n        # Find the maximum deviation across all grid points\n        max_dev = max(np.max(dev_L), np.max(dev_R))\n        devs.append(max_dev)\n\n    #\n    # --- Final Output ---\n    #\n    # Format results to 6 decimal places as required\n    formatted_results = [f\"{d:.6f}\" for d in devs]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solver\nsolve()\n```"}]}