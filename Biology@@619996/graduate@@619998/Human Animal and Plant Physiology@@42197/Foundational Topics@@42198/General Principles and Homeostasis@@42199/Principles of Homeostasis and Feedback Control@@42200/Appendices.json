{"hands_on_practices": [{"introduction": "The baroreflex is a cornerstone of short-term blood pressure regulation, acting as a rapid negative feedback system. To understand its effectiveness, we can model it using the principles of control theory. This practice [@problem_id:2600386] guides you through the process of deriving a closed-loop transfer function for a simplified cardiovascular system, allowing you to quantify how effectively a proportional controller can buffer arterial pressure against hemodynamic disturbances.", "problem": "A single-compartment arterial tree with arterial compliance $C_{a}$ and total peripheral (vascular) resistance $R_{v}$ is supplied by the heart. Let arterial pressure be $P_{a}(t)$, cardiac inflow be $Q_{h}(t)$, and outflow be $Q_{\\text{out}}(t)$. Assume venous pressure is constant and incorporated into the operating point. The fundamental hemodynamic balance is conservation of arterial volume: $C_{a}\\,\\frac{dP_{a}}{dt} = Q_{h} - Q_{\\text{out}}$, with $Q_{\\text{out}} = \\frac{P_{a}}{R_{v}}$ in small-signal form about a steady state. The heartâ€™s cardiac output is the product of heart rate (HR) and stroke volume (SV), so for small fractional deviations, the fractional change in cardiac output is the sum of the fractional changes in HR and SV.\n\nA baroreflex proportional controller senses arterial pressure and acts through two effector pathways: heart rate and contractility. Let $P_{a}^{\\ast}$, $R_{v}^{\\ast}$, and $Q_{h}^{\\ast}$ denote the steady-state values satisfying $Q_{h}^{\\ast} = \\frac{P_{a}^{\\ast}}{R_{v}^{\\ast}}$. Define normalized small-signal deviations $p(t) \\equiv \\frac{\\delta P_{a}(t)}{P_{a}^{\\ast}}$, $r(t) \\equiv \\frac{\\delta R_{v}(t)}{R_{v}^{\\ast}}$, and $q(t) \\equiv \\frac{\\delta Q_{h}(t)}{Q_{h}^{\\ast}}$. The controller computes a control signal $u(t)$ from the sensed normalized pressure as $u(t) = -K_{p}\\,p(t)$, where $K_{p} > 0$ is the proportional gain. The two effector pathways map this control signal to fractional changes in cardiac output additively: the heart rate pathway contributes $G_{h}\\,u(t)$ to $q(t)$, and the contractility pathway contributes $G_{c}\\,u(t)$ to $q(t)$, so that $q(t) = \\left(G_{h}+G_{c}\\right)u(t)$.\n\nStarting from the conservation law and these definitions, linearize about the steady state and derive the closed-loop transfer function $T_{pr}(s) \\equiv \\frac{P(s)}{R(s)}$ from the Laplace transform of the vascular resistance disturbance $r(t)$ to the Laplace transform of the normalized arterial pressure $p(t)$, where $P(s) = \\mathcal{L}\\{p(t)\\}$ and $R(s) = \\mathcal{L}\\{r(t)\\}$. Express your final answer as a single algebraic expression in terms of $s$, $\\tau_{a} \\equiv C_{a} R_{v}^{\\ast}$, $K_{p}$, $G_{h}$, and $G_{c}$. Use zero initial conditions and treat $p(t)$, $q(t)$, and $r(t)$ as dimensionless by construction. No numerical evaluation is required. The final answer must be a single closed-form analytic expression.", "solution": "The problem requires the derivation of the closed-loop transfer function from a disturbance in vascular resistance to the resulting change in arterial pressure, within the framework of a linearized model of the cardiovascular system with baroreflex control.\n\nFirst, we perform a validation of the problem statement.\n\nStep 1: Extract Givens.\n-   System model: Single-compartment arterial tree.\n-   Variables: Arterial compliance $C_{a}$, total peripheral resistance $R_{v}$, arterial pressure $P_{a}(t)$, cardiac inflow $Q_{h}(t)$, and outflow $Q_{\\text{out}}(t)$.\n-   Governing equation (conservation of arterial volume): $C_{a}\\,\\frac{dP_{a}}{dt} = Q_{h} - Q_{\\text{out}}$.\n-   Outflow definition: $Q_{\\text{out}} = \\frac{P_{a}}{R_{v}}$.\n-   Steady-state values: $P_{a}^{\\ast}$, $R_{v}^{\\ast}$, $Q_{h}^{\\ast}$.\n-   Steady-state condition: $Q_{h}^{\\ast} = \\frac{P_{a}^{\\ast}}{R_{v}^{\\ast}}$.\n-   Normalized small-signal deviations: $p(t) \\equiv \\frac{\\delta P_{a}(t)}{P_{a}^{\\ast}}$, $r(t) \\equiv \\frac{\\delta R_{v}(t)}{R_{v}^{\\ast}}$, $q(t) \\equiv \\frac{\\delta Q_{h}(t)}{Q_{h}^{\\ast}}$.\n-   Controller law (proportional control): $u(t) = -K_{p}\\,p(t)$, with gain $K_{p} > 0$.\n-   Effector response: $q(t) = \\left(G_{h}+G_{c}\\right)u(t)$.\n-   Time constant definition: $\\tau_{a} \\equiv C_{a} R_{v}^{\\ast}$.\n-   Objective: Derive the closed-loop transfer function $T_{pr}(s) \\equiv \\frac{P(s)}{R(s)}$, where $P(s)=\\mathcal{L}\\{p(t)\\}$ and $R(s)=\\mathcal{L}\\{r(t)\\}$.\n-   Conditions: Zero initial conditions.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, utilizing a simplified but standard `Windkessel` model for arterial dynamics. The concepts of baroreflex, proportional control, and linearization are fundamental in physiological modeling and control theory. The problem is well-posed, providing a complete and consistent set of equations and definitions necessary to derive the requested transfer function. The language is objective and precise. There are no violations of scientific principles, logical inconsistencies, or ambiguities.\n\nStep 3: Verdict and Action.\nThe problem is valid. The solution will proceed.\n\nThe derivation begins with the fundamental conservation law and involves linearizing the system around its steady-state operating point. We express all variables as a sum of their steady-state value and a small time-varying perturbation:\n$P_{a}(t) = P_{a}^{\\ast} + \\delta P_{a}(t)$\n$Q_{h}(t) = Q_{h}^{\\ast} + \\delta Q_{h}(t)$\n$R_{v}(t) = R_{v}^{\\ast} + \\delta R_{v}(t)$\n\nThe outflow $Q_{\\text{out}}(t) = \\frac{P_{a}(t)}{R_{v}(t)}$ is a nonlinear function of two variables. We linearize it using a first-order Taylor series expansion around the steady state $(P_{a}^{\\ast}, R_{v}^{\\ast})$:\n$$Q_{\\text{out}}(t) \\approx \\frac{P_{a}^{\\ast}}{R_{v}^{\\ast}} + \\left.\\frac{\\partial Q_{\\text{out}}}{\\partial P_{a}}\\right|_{*} \\delta P_{a}(t) + \\left.\\frac{\\partial Q_{\\text{out}}}{\\partial R_{v}}\\right|_{*} \\delta R_{v}(t)$$\nThe partial derivatives evaluated at the steady state are:\n$\\left.\\frac{\\partial Q_{\\text{out}}}{\\partial P_{a}}\\right|_{*} = \\frac{1}{R_{v}^{\\ast}}$\n$\\left.\\frac{\\partial Q_{\\text{out}}}{\\partial R_{v}}\\right|_{*} = -\\frac{P_{a}^{\\ast}}{(R_{v}^{\\ast})^2}$\nThe steady-state term $\\frac{P_{a}^{\\ast}}{R_{v}^{\\ast}}$ is equal to $Q_{h}^{\\ast}$. Thus, the perturbation in outflow, $\\delta Q_{\\text{out}}(t) = Q_{\\text{out}}(t) - Q_{h}^{\\ast}$, is:\n$$\\delta Q_{\\text{out}}(t) \\approx \\frac{1}{R_{v}^{\\ast}}\\delta P_{a}(t) - \\frac{P_{a}^{\\ast}}{(R_{v}^{\\ast})^2}\\delta R_{v}(t)$$\n\nNext, we substitute the perturbed variables into the conservation law:\n$$C_{a}\\,\\frac{d}{dt}(P_{a}^{\\ast} + \\delta P_{a}(t)) = (Q_{h}^{\\ast} + \\delta Q_{h}(t)) - (Q_{h}^{\\ast} + \\delta Q_{\\text{out}}(t))$$\nSince $P_{a}^{\\ast}$ and $Q_{h}^{\\ast}$ are constants, the equation simplifies to the dynamics of the perturbations:\n$$C_{a}\\,\\frac{d(\\delta P_{a})}{dt} = \\delta Q_{h} - \\delta Q_{\\text{out}}$$\nSubstituting the linearized expression for $\\delta Q_{\\text{out}}$:\n$$C_{a}\\,\\frac{d(\\delta P_{a})}{dt} = \\delta Q_{h}(t) - \\left( \\frac{1}{R_{v}^{\\ast}}\\delta P_{a}(t) - \\frac{P_{a}^{\\ast}}{(R_{v}^{\\ast})^2}\\delta R_{v}(t) \\right)$$\n$$C_{a}\\,\\frac{d(\\delta P_{a})}{dt} = \\delta Q_{h}(t) - \\frac{1}{R_{v}^{\\ast}}\\delta P_{a}(t) + \\frac{P_{a}^{\\ast}}{(R_{v}^{\\ast})^2}\\delta R_{v}(t)$$\n\nNow, we introduce the normalized dimensionless variables: $\\delta P_{a} = P_{a}^{\\ast}p$, $\\delta Q_{h} = Q_{h}^{\\ast}q$, and $\\delta R_{v} = R_{v}^{\\ast}r$.\n$$C_{a}\\,\\frac{d(P_{a}^{\\ast}p)}{dt} = Q_{h}^{\\ast}q - \\frac{1}{R_{v}^{\\ast}}(P_{a}^{\\ast}p) + \\frac{P_{a}^{\\ast}}{(R_{v}^{\\ast})^2}(R_{v}^{\\ast}r)$$\n$$C_{a}P_{a}^{\\ast}\\,\\frac{dp}{dt} = Q_{h}^{\\ast}q - \\frac{P_{a}^{\\ast}}{R_{v}^{\\ast}}p + \\frac{P_{a}^{\\ast}}{R_{v}^{\\ast}}r$$\nUsing the steady-state relation $Q_{h}^{\\ast} = \\frac{P_{a}^{\\ast}}{R_{v}^{\\ast}}$, we can simplify:\n$$C_{a}P_{a}^{\\ast}\\,\\frac{dp}{dt} = \\frac{P_{a}^{\\ast}}{R_{v}^{\\ast}}q - \\frac{P_{a}^{\\ast}}{R_{v}^{\\ast}}p + \\frac{P_{a}^{\\ast}}{R_{v}^{\\ast}}r$$\nDividing the entire equation by $P_{a}^{\\ast}$ yields:\n$$C_{a}\\,\\frac{dp}{dt} = \\frac{1}{R_{v}^{\\ast}}(q - p + r)$$\nMultiplying by $R_{v}^{\\ast}$ and substituting the definition $\\tau_{a} = C_{a} R_{v}^{\\ast}$:\n$$\\tau_{a}\\,\\frac{dp}{dt} = q - p + r$$\nRearranging this gives the open-loop dynamics of the system in normalized variables:\n$$\\tau_{a}\\,\\frac{dp}{dt} + p(t) = q(t) + r(t)$$\n\nNext, we incorporate the closed-loop baroreflex control. The controller senses the normalized pressure deviation $p(t)$ and generates a control signal $u(t) = -K_{p}\\,p(t)$. This signal actuates changes in cardiac output via two pathways, resulting in a fractional change $q(t) = (G_{h} + G_{c})u(t)$. Substituting the expression for $u(t)$:\n$$q(t) = -(G_{h} + G_{c})K_{p}\\,p(t)$$\nNow, we substitute this control law for $q(t)$ back into the system's dynamic equation:\n$$\\tau_{a}\\,\\frac{dp}{dt} + p(t) = -(G_{h} + G_{c})K_{p}\\,p(t) + r(t)$$\nWe group all terms involving $p(t)$ on the left-hand side:\n$$\\tau_{a}\\,\\frac{dp}{dt} + p(t) + (G_{h} + G_{c})K_{p}\\,p(t) = r(t)$$\n$$\\tau_{a}\\,\\frac{dp}{dt} + \\left[1 + K_{p}(G_{h} + G_{c})\\right]p(t) = r(t)$$\n\nTo find the transfer function $T_{pr}(s) = \\frac{P(s)}{R(s)}$, we take the Laplace transform of this differential equation, assuming zero initial conditions. Let $P(s) = \\mathcal{L}\\{p(t)\\}$ and $R(s) = \\mathcal{L}\\{r(t)\\}$. Using the differentiation property $\\mathcal{L}\\{\\frac{dp}{dt}\\} = sP(s)$:\n$$\\tau_{a}sP(s) + \\left[1 + K_{p}(G_{h} + G_{c})\\right]P(s) = R(s)$$\nFactoring out $P(s)$:\n$$P(s)\\left(\\tau_{a}s + 1 + K_{p}(G_{h} + G_{c})\\right) = R(s)$$\nFinally, we solve for the ratio $\\frac{P(s)}{R(s)}$ to obtain the desired closed-loop transfer function:\n$$T_{pr}(s) = \\frac{P(s)}{R(s)} = \\frac{1}{\\tau_{a}s + 1 + K_{p}(G_{h} + G_{c})}$$\nThis expression represents a first-order low-pass filter, where the negative feedback from the baroreflex increases the denominator's constant term, thereby reducing the steady-state gain and decreasing the system's effective time constant, which signifies a faster and more robust response to disturbances.", "answer": "$$\n\\boxed{\\frac{1}{\\tau_{a}s + 1 + K_{p}\\left(G_{h} + G_{c}\\right)}}\n$$", "id": "2600386"}, {"introduction": "While proportional control can reduce errors, it often cannot eliminate them completely, leaving a residual steady-state error. Many physiological systems, like glucose regulation, demonstrate a remarkable ability to return precisely to a setpoint. This exercise [@problem_id:2600364] explores the power of integral control, a strategy where the controller accumulates past errors to drive the steady-state error to exactly zero, demonstrating how robust homeostasis is achieved in the face of sustained disturbances.", "problem": "A minimal, physiologically plausible closed-loop model of plasma glucose homeostasis considers a single well-mixed compartment for plasma glucose and an islet beta-cell controller implementing integral action on the glucose error. Let $G(t)$ denote plasma glucose concentration and let $D$ denote a sustained hepatic glucose production disturbance (a constant-rate input). The glucose mass balance is postulated as\n$$\n\\frac{dG}{dt} \\;=\\; D \\;-\\; k_{g}\\,G(t) \\;-\\; k_{i}\\,I(t),\n$$\nwhere $k_{g} \\gt 0$ is the insulin-independent glucose removal coefficient, $k_{i} \\gt 0$ is the insulin-dependent glucose removal gain, and $I(t)$ is an effective insulin action signal that linearly augments glucose removal.\n\nAssume the beta-cell secretes insulin with basal tone and pure integral action on the glucose tracking error relative to a defended setpoint $G_{\\mathrm{set}} \\gt 0$. Introduce the controller state $Z(t)$, defined by\n$$\n\\frac{dZ}{dt} \\;=\\; G(t) \\;-\\; G_{\\mathrm{set}},\n$$\nand suppose the effective insulin action is the affine map\n$$\nI(t) \\;=\\; I_{b} \\;+\\; k_{c}\\,Z(t),\n$$\nwith $I_{b} \\ge 0$ the basal insulin action and $k_{c} \\gt 0$ the controller gain. Assume no saturation of $I(t)$ and that for any constant $D$ the closed-loop admits a unique, stable steady state.\n\nDefine the steady-state sensitivity of plasma glucose to the sustained hepatic glucose production disturbance as\n$$\nS \\;=\\; \\frac{\\partial G_{\\mathrm{ss}}}{\\partial D},\n$$\nwhere $G_{\\mathrm{ss}}$ is the steady-state value of $G(t)$ attained for a constant $D$ after transients vanish. Compute $S$ under the model above. Express the final result in minutes. If a numerical approximation were required, you would be instructed to round to a given number of significant figures; here, provide the exact value.", "solution": "The problem requires the computation of the steady-state sensitivity of plasma glucose, $G_{\\mathrm{ss}}$, to a sustained hepatic glucose production disturbance, $D$. This sensitivity is defined as $S = \\frac{\\partial G_{\\mathrm{ss}}}{\\partial D}$.\n\nThe model is described by a system of two coupled ordinary differential equations:\n$$\n\\frac{dG}{dt} \\;=\\; D \\;-\\; k_{g}\\,G(t) \\;-\\; k_{i}\\,I(t)\n$$\n$$\n\\frac{dZ}{dt} \\;=\\; G(t) \\;-\\; G_{\\mathrm{set}}\n$$\nwhere the effective insulin action $I(t)$ is given by the algebraic relation:\n$$\nI(t) \\;=\\; I_{b} \\;+\\; k_{c}\\,Z(t)\n$$\nThe parameters $k_{g}$, $k_{i}$, $k_{c}$, $G_{\\mathrm{set}}$, and $I_{b}$ are positive or non-negative constants, and $D$ is a constant disturbance.\n\nTo find the steady-state value of the plasma glucose concentration, $G_{\\mathrm{ss}}$, we must find the equilibrium point of the system. The steady state is defined by the condition that all time derivatives are equal to zero.\n$$\n\\frac{dG}{dt}\\bigg|_{\\mathrm{ss}} = 0\n$$\n$$\n\\frac{dZ}{dt}\\bigg|_{\\mathrm{ss}} = 0\n$$\n\nLet us analyze the second equation first, as it directly governs the relationship between the steady-state glucose level and its setpoint. Setting the time derivative of the controller state $Z(t)$ to zero gives:\n$$\n\\frac{dZ}{dt}\\bigg|_{\\mathrm{ss}} = G_{\\mathrm{ss}} - G_{\\mathrm{set}} = 0\n$$\nThis equation immediately implies that the steady-state glucose concentration must be equal to the setpoint:\n$$\nG_{\\mathrm{ss}} = G_{\\mathrm{set}}\n$$\nThis result is a fundamental property of systems incorporating pure integral control. The controller, described by the state $Z(t)$ which is the integral of the error $G(t) - G_{\\mathrm{set}}$, will continue to adjust its output until the error is driven to zero at steady state. The system cannot be at equilibrium unless the input to the integrator, $G(t) - G_{\\mathrm{set}}$, is zero.\n\nThe problem defines the sensitivity $S$ as the partial derivative of the steady-state glucose concentration $G_{\\mathrm{ss}}$ with respect to the disturbance $D$:\n$$\nS = \\frac{\\partial G_{\\mathrm{ss}}}{\\partial D}\n$$\nSince we have found that $G_{\\mathrm{ss}} = G_{\\mathrm{set}}$, we can substitute this into the expression for $S$:\n$$\nS = \\frac{\\partial (G_{\\mathrm{set}})}{\\partial D}\n$$\nThe glucose setpoint, $G_{\\mathrm{set}}$, is a fixed parameter of the model. It represents an intrinsic, defended physiological value and does not depend on the external disturbance $D$. Therefore, the derivative of a constant with respect to the variable $D$ is zero.\n$$\nS = 0\n$$\nThis result signifies perfect rejection of the constant disturbance $D$. The integral controller ensures that, regardless of the magnitude of the sustained glucose production $D$ (within the system's non-saturating limits, as assumed), the steady-state plasma glucose level will always return precisely to its setpoint $G_{\\mathrm{set}}$. The other system variables, specifically the controller state $Z_{\\mathrm{ss}}$ and the insulin action $I_{\\mathrm{ss}}$, will adjust to compensate for the disturbance.\n\nTo verify consistency, we can examine the first differential equation at steady state:\n$$\n0 = D - k_{g}\\,G_{\\mathrm{ss}} - k_{i}\\,I_{\\mathrm{ss}}\n$$\nSubstituting $G_{\\mathrm{ss}} = G_{\\mathrm{set}}$, we can solve for the steady-state insulin action required to balance the system:\n$$\nI_{\\mathrm{ss}} = \\frac{D - k_{g}\\,G_{\\mathrm{set}}}{k_{i}}\n$$\nThis shows that $I_{\\mathrm{ss}}$ does indeed depend on $D$. The controller state $Z_{\\mathrm{ss}}$ must also adjust accordingly:\n$$\nI_{\\mathrm{ss}} = I_{b} + k_{c}\\,Z_{\\mathrm{ss}} \\implies Z_{\\mathrm{ss}} = \\frac{I_{\\mathrm{ss}} - I_{b}}{k_{c}} = \\frac{1}{k_{c}}\\left( \\frac{D - k_{g}\\,G_{\\mathrm{set}}}{k_{i}} - I_{b} \\right)\n$$\nThus, the system finds a unique and stable steady state where $Z_{\\mathrm{ss}}$ and $I_{\\mathrm{ss}}$ vary with $D$, but $G_{\\mathrm{ss}}$ remains fixed at $G_{\\mathrm{set}}$. The sensitivity of $G_{\\mathrm{ss}}$ to $D$ is therefore exactly zero. The problem asks for the answer in minutes. Since the value is zero, the units do not change the result. The sensitivity is $0$ minutes.", "answer": "$$\n\\boxed{0}\n$$", "id": "2600364"}, {"introduction": "A critical challenge in physiological control is the presence of time delays, which arise from hormone transport, nerve conduction, and other biological processes. These delays can destabilize an otherwise stable system, leading to pathological oscillations. In this final practice [@problem_id:2600350], you will analyze a model of respiratory control to determine the precise conditions under which feedback gains and inherent delays can induce instability, providing a quantitative link between system parameters and oscillatory behaviors like Cheyne-Stokes respiration.", "problem": "A simplified closed-loop model of respiratory homeostasis couples chemoreflex control to alveolar gas dynamics near a resting steady state. Let $x(t)$ denote the deviation of arterial carbon dioxide partial pressure $P_{\\mathrm{CO_2}}$ from its steady-state value (in $\\mathrm{mmHg}$), $y(t)$ the deviation of arterial oxygen partial pressure $P_{\\mathrm{O_2}}$ from its steady-state value (in $\\mathrm{mmHg}$), and $v(t)$ the deviation of alveolar ventilation from its steady-state value (in $\\mathrm{L\\,min}^{-1}$). Assume that small deviations around steady state are governed by first-order alveolar-blood dynamics with time constants $\\tau_{\\mathrm{C}}$ and $\\tau_{\\mathrm{O}}$ and steady-state gains $k_{\\mathrm{C}}$ and $k_{\\mathrm{O}}$:\n$$\n\\tau_{\\mathrm{C}}\\,\\frac{d x}{d t} \\;=\\; -\\,x \\;-\\; k_{\\mathrm{C}}\\,v, \n\\qquad \n\\tau_{\\mathrm{O}}\\,\\frac{d y}{d t} \\;=\\; -\\,y \\;+\\; k_{\\mathrm{O}}\\,v,\n$$\nwhere $k_{\\mathrm{C}} \\gt 0$ captures the decrease in $P_{\\mathrm{CO_2}}$ with increased ventilation and $k_{\\mathrm{O}} \\gt 0$ captures the increase in $P_{\\mathrm{O_2}}$ with increased ventilation. The chemoreflex controller adjusts ventilation proportionally to a delayed linear combination of blood gas deviations:\n$$\nv(t) \\;=\\; K\\big(\\alpha\\,x(t-T) \\;-\\; \\beta\\,y(t-T)\\big),\n$$\nwhere $K$ is the controller gain (units $\\mathrm{L\\,min}^{-1}\\,\\mathrm{mmHg}^{-1}$), $\\alpha \\gt 0$ and $\\beta \\gt 0$ weight the sensitivities to $P_{\\mathrm{CO_2}}$ and $P_{\\mathrm{O_2}}$, respectively, and $T$ is an overall transport and neural delay. Angular frequency must be treated in radians per second.\n\n1. Linearize the closed-loop system in the Laplace domain about the steady state and obtain the characteristic equation governing small-signal stability in terms of $\\tau_{\\mathrm{C}}$, $\\tau_{\\mathrm{O}}$, $k_{\\mathrm{C}}$, $k_{\\mathrm{O}}$, $\\alpha$, $\\beta$, $K$, and $T$.\n2. Under the simplifying assumption $\\tau_{\\mathrm{C}}=\\tau_{\\mathrm{O}}=\\tau$, derive the marginal (Hopf) oscillation conditions in terms of the angular frequency $\\omega$ and the parameters, and obtain an analytic expression for the smallest gain $K_{\\mathrm{crit}}$ that produces sustained oscillations as a function of $\\omega$ and the given physiological parameters.\n3. Using the numerical values $\\tau = 20\\,\\mathrm{s}$, $T = 4\\,\\mathrm{s}$, $k_{\\mathrm{C}} = 10\\,\\mathrm{mmHg}/(\\mathrm{L\\,min}^{-1})$, $k_{\\mathrm{O}} = 12\\,\\mathrm{mmHg}/(\\mathrm{L\\,min}^{-1})$, $\\alpha = 0.8$, and $\\beta = 0.2$, compute $K_{\\mathrm{crit}}$ by selecting the smallest positive angular frequency $\\omega$ that satisfies the phase condition for marginal oscillations. Round your final $K_{\\mathrm{crit}}$ to three significant figures. Express the final gain in $\\mathrm{L\\,min}^{-1}\\,\\mathrm{mmHg}^{-1}$.", "solution": "The problem statement is a valid exercise in linear systems analysis applied to physiological control. It is self-contained, scientifically grounded in established modeling principles for respiratory control, and well-posed. We shall proceed with the derivation.\n\nThe system is described by the following equations:\n$$ \\tau_{\\mathrm{C}}\\,\\frac{d x}{d t} \\;=\\; -\\,x \\;-\\; k_{\\mathrm{C}}\\,v $$\n$$ \\tau_{\\mathrm{O}}\\,\\frac{d y}{d t} \\;=\\; -\\,y \\;+\\; k_{\\mathrm{O}}\\,v $$\n$$ v(t) \\;=\\; K\\big(\\alpha\\,x(t-T) \\;-\\; \\beta\\,y(t-T)\\big) $$\n\n**Part 1: Characteristic Equation**\n\nTo linearize the system in the Laplace domain, we take the Laplace transform of each equation. Let $X(s)$, $Y(s)$, and $V(s)$ be the Laplace transforms of $x(t)$, $y(t)$, and $v(t)$, respectively. Assuming zero initial conditions, as we are analyzing stability about the zero steady state, the derivative property $\\mathcal{L}\\{\\frac{df}{dt}\\} = sF(s)$ and the time-delay property $\\mathcal{L}\\{f(t-T)\\} = e^{-sT}F(s)$ are applied.\n\nThe first two equations transform to:\n$$ \\tau_{\\mathrm{C}} s X(s) = -X(s) - k_{\\mathrm{C}} V(s) \\implies (\\tau_{\\mathrm{C}} s + 1) X(s) = -k_{\\mathrm{C}} V(s) $$\n$$ \\tau_{\\mathrm{O}} s Y(s) = -Y(s) + k_{\\mathrm{O}} V(s) \\implies (\\tau_{\\mathrm{O}} s + 1) Y(s) = k_{\\mathrm{O}} V(s) $$\nFrom these, we express $X(s)$ and $Y(s)$ in terms of $V(s)$:\n$$ X(s) = -\\frac{k_{\\mathrm{C}}}{\\tau_{\\mathrm{C}} s + 1} V(s) $$\n$$ Y(s) = \\frac{k_{\\mathrm{O}}}{\\tau_{\\mathrm{O}} s + 1} V(s) $$\nThe controller equation transforms to:\n$$ V(s) = K \\left( \\alpha \\mathcal{L}\\{x(t-T)\\} - \\beta \\mathcal{L}\\{y(t-T)\\} \\right) = K \\left( \\alpha e^{-sT} X(s) - \\beta e^{-sT} Y(s) \\right) $$\n$$ V(s) = K e^{-sT} \\left( \\alpha X(s) - \\beta Y(s) \\right) $$\nSubstituting the expressions for $X(s)$ and $Y(s)$ into the controller equation yields:\n$$ V(s) = K e^{-sT} \\left( \\alpha \\left( -\\frac{k_{\\mathrm{C}}}{\\tau_{\\mathrm{C}} s + 1} \\right) - \\beta \\left( \\frac{k_{\\mathrm{O}}}{\\tau_{\\mathrm{O}} s + 1} \\right) \\right) V(s) $$\nFor a non-trivial solution where $V(s) \\neq 0$, we can divide by $V(s)$ to obtain the characteristic equation of the closed-loop system:\n$$ 1 = -K e^{-sT} \\left( \\frac{\\alpha k_{\\mathrm{C}}}{\\tau_{\\mathrm{C}} s + 1} + \\frac{\\beta k_{\\mathrm{O}}}{\\tau_{\\mathrm{O}} s + 1} \\right) $$\nRearranging gives the final form of the characteristic equation:\n$$ 1 + K e^{-sT} \\left( \\frac{\\alpha k_{\\mathrm{C}}}{\\tau_{\\mathrm{C}} s + 1} + \\frac{\\beta k_{\\mathrm{O}}}{\\tau_{\\mathrm{O}} s + 1} \\right) = 0 $$\n\n**Part 2: Marginal Oscillation Conditions**\n\nWe introduce the simplifying assumption $\\tau_{\\mathrm{C}} = \\tau_{\\mathrm{O}} = \\tau$. The characteristic equation becomes:\n$$ 1 + K e^{-sT} \\left( \\frac{\\alpha k_{\\mathrm{C}} + \\beta k_{\\mathrm{O}}}{\\tau s + 1} \\right) = 0 $$\nFor marginal stability, the system may exhibit sustained oscillations. This occurs when the characteristic equation has a pair of purely imaginary roots, $s = j\\omega$, where $\\omega$ is the angular frequency of oscillation. Substituting $s = j\\omega$:\n$$ 1 + K e^{-j\\omega T} \\frac{\\alpha k_{\\mathrm{C}} + \\beta k_{\\mathrm{O}}}{j\\omega\\tau + 1} = 0 $$\nLet $C = \\alpha k_{\\mathrm{C}} + \\beta k_{\\mathrm{O}}$. The equation is rearranged to:\n$$ j\\omega\\tau + 1 = -K C e^{-j\\omega T} $$\nTo find the conditions on $\\omega$ and $K$, we can equate the magnitudes and arguments of both sides.\nThe magnitude condition is:\n$$ |j\\omega\\tau + 1| = |-K C e^{-j\\omega T}| \\implies \\sqrt{(\\omega\\tau)^{2} + 1^{2}} = K C |e^{-j\\omega T}| = K C $$\nThis gives the gain condition, which expresses the required gain $K$ as a function of the frequency $\\omega$:\n$$ K(\\omega) = \\frac{\\sqrt{1 + (\\omega\\tau)^{2}}}{C} = \\frac{\\sqrt{1 + (\\omega\\tau)^{2}}}{\\alpha k_{\\mathrm{C}} + \\beta k_{\\mathrm{O}}} $$\nThe argument (phase) condition is:\n$$ \\arg(j\\omega\\tau + 1) = \\arg(-K C e^{-j\\omega T}) $$\n$$ \\arctan(\\omega\\tau) = \\arg(-1) + \\arg(K) + \\arg(C) + \\arg(e^{-j\\omega T}) $$\nSince $K > 0$ and $C > 0$, their arguments are $0$. Taking the principal value for $\\arg(-1)$ as $\\pi$, we get:\n$$ \\arctan(\\omega\\tau) = \\pi - \\omega T + 2n\\pi, \\quad n \\in \\mathbb{Z} $$\nThe smallest positive frequency $\\omega$ will correspond to $n=0$:\n$$ \\arctan(\\omega\\tau) + \\omega T = \\pi $$\nThis is the phase condition. An equivalent form is $\\tan(\\omega T) = -\\omega\\tau$, which is found by equating the real and imaginary parts after applying Euler's formula $e^{-j\\omega T} = \\cos(\\omega T) - j\\sin(\\omega T)$.\nThe smallest gain $K_{\\mathrm{crit}}$ that produces oscillations is found by using the smallest positive frequency $\\omega$ that satisfies the phase condition in the gain equation. The requested expression for $K_{\\mathrm{crit}}$ as a function of $\\omega$ is the gain condition itself.\n\n**Part 3: Numerical Computation**\n\nWe are given the following numerical values:\n$\\tau = 20\\,\\mathrm{s}$, $T = 4\\,\\mathrm{s}$, $k_{\\mathrm{C}} = 10\\,\\mathrm{mmHg}/(\\mathrm{L\\,min}^{-1})$, $k_{\\mathrm{O}} = 12\\,\\mathrm{mmHg}/(\\mathrm{L\\,min}^{-1})$, $\\alpha = 0.8$, and $\\beta = 0.2$.\n\nFirst, we find the smallest positive root $\\omega$ from the phase condition:\n$$ \\arctan(\\omega\\tau) + \\omega T = \\pi \\implies \\arctan(20\\omega) + 4\\omega = \\pi $$\nThis transcendental equation must be solved numerically. Let $f(\\omega) = \\arctan(20\\omega) + 4\\omega - \\pi$. We seek the root of $f(\\omega)=0$ for $\\omega > 0$. Since $f'(\\omega) = \\frac{20}{1+(20\\omega)^2} + 4 > 0$ for all real $\\omega$, the function is strictly increasing, and there is at most one real root.\nAt $\\omega=0$, $f(0) = -\\pi < 0$. At $\\omega = \\pi/4 \\approx 0.785$, $f(\\pi/4) = \\arctan(5\\pi) + \\pi - \\pi = \\arctan(5\\pi) > 0$. Thus, a unique positive root exists.\nNumerical root-finding (e.g., Newton's method or bisection) yields:\n$$ \\omega \\approx 0.4221\\,\\mathrm{rad\\,s}^{-1} $$\nNext, we compute the constant $C$:\n$$ C = \\alpha k_{\\mathrm{C}} + \\beta k_{\\mathrm{O}} = (0.8)(10) + (0.2)(12) = 8 + 2.4 = 10.4\\,\\mathrm{mmHg}/(\\mathrm{L\\,min}^{-1}) $$\nFinally, we compute $K_{\\mathrm{crit}}$ using the gain condition with the found value of $\\omega$:\n$$ K_{\\mathrm{crit}} = \\frac{\\sqrt{1 + (\\omega\\tau)^{2}}}{C} = \\frac{\\sqrt{1 + (0.4221 \\times 20)^{2}}}{10.4} = \\frac{\\sqrt{1 + (8.442)^{2}}}{10.4} $$\n$$ K_{\\mathrm{crit}} = \\frac{\\sqrt{1 + 71.267364}}{10.4} = \\frac{\\sqrt{72.267364}}{10.4} \\approx \\frac{8.50102}{10.4} \\approx 0.817406\\,\\mathrm{L\\,min}^{-1}\\,\\mathrm{mmHg}^{-1} $$\nRounding to three significant figures, the critical gain is:\n$$ K_{\\mathrm{crit}} \\approx 0.817\\,\\mathrm{L\\,min}^{-1}\\,\\mathrm{mmHg}^{-1} $$", "answer": "$$\n\\boxed{0.817}\n$$", "id": "2600350"}]}