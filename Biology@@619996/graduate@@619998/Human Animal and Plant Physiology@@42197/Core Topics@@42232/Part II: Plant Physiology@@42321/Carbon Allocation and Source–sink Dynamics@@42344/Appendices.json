{"hands_on_practices": [{"introduction": "Understanding carbon allocation begins at the source. This practice applies the fundamental principle of mass conservation to a photosynthesizing leaf operating at a steady state, a core concept in plant physiology [@problem_id:2554154]. By accounting for the primary fluxes of carbon—gross photosynthetic fixation, respiratory losses, and local storage as starch—you will calculate the maximum rate at which sucrose can be exported to the rest of the plant. This exercise is essential for mastering the basics of carbon budgeting at the organ level, a foundational skill for analyzing whole-plant source-sink dynamics.", "problem": "A photosynthesizing leaf operates at steady state under saturating light, such that its non-structural carbon pool does not change measurably over the time window considered. The gross photosynthetic carbon fixation rate is $A = 20 \\text{ } \\mu\\text{mol CO}_2\\text{ m}^{-2}\\text{ s}^{-1}$, the concurrent mitochondrial leaf respiration in the light is $R_l = 2 \\text{ } \\mu\\text{mol CO}_2\\text{ m}^{-2}\\text{ s}^{-1}$, and the rate of starch synthesis is $S = 4 \\text{ } \\mu\\text{mol C m}^{-2}\\text{ s}^{-1}$. Assume that all other carbon sinks within the leaf are negligible, that one molecule of carbon dioxide ($\\text{CO}_2$) contributes one mole equivalent of carbon to assimilates, and that sucrose has the chemical formula $\\text{C}_{12}\\text{H}_{22}\\text{O}_{11}$.\n\nUsing only conservation of mass for carbon and molecular stoichiometry, compute the maximum steady-state sucrose export rate through the phloem, expressed in $\\mu\\text{mol sucrose m}^{-2}\\text{ s}^{-1}$. Round your answer to four significant figures.", "solution": "The problem as stated is scientifically grounded, self-contained, and well-posed. It requires the application of the principle of mass conservation to a biological system at steady state, which is a standard and valid approach in physiology. We will proceed with the solution.\n\nThe fundamental principle governing this system is the conservation of mass for carbon. The problem specifies that the leaf operates at a steady state, meaning the size of the non-structural carbon pool is constant. This implies that the total rate of carbon influx into this pool must equal the total rate of carbon efflux from it.\n\nLet us define the fluxes in terms of moles of carbon per unit leaf area per unit time, specifically in units of $\\mu\\text{mol C m}^{-2} \\text{s}^{-1}$.\n\nThe primary source of carbon is gross photosynthesis, with a rate denoted by $A$. The problem gives this rate as $A = 20 \\text{ } \\mu\\text{mol CO}_2\\text{ m}^{-2}\\text{ s}^{-1}$. According to the provided stoichiometry, one molecule of $\\text{CO}_2$ provides one atom of carbon. Therefore, the carbon influx rate is:\n$$A_C = 20 \\, \\mu\\text{mol C m}^{-2} \\text{s}^{-1}$$\n\nThe fixed carbon is allocated to several sinks. The problem identifies three:\n$1$. Mitochondrial respiration in the light, $R_l$. This process releases $\\text{CO}_2$, representing a loss of fixed carbon. The rate is given as $R_l = 2 \\text{ } \\mu\\text{mol CO}_2\\text{ m}^{-2}\\text{ s}^{-1}$. This corresponds to a carbon efflux rate of:\n$$R_{l,C} = 2 \\, \\mu\\text{mol C m}^{-2} \\text{s}^{-1}$$\n$2$. Starch synthesis, $S$. This is a storage sink within the leaf. The rate is given directly in carbon units:\n$$S = 4 \\, \\mu\\text{mol C m}^{-2} \\text{s}^{-1}$$\n$3$. Sucrose export through the phloem. Let us denote the rate of carbon exported in this form as $E_C$, in units of $\\mu\\text{mol C m}^{-2} \\text{s}^{-1}$. This is the quantity which we must first determine.\n\nThe problem states that all other carbon sinks are negligible. The steady-state mass balance equation for carbon is therefore:\n$$(\\text{Rate of Carbon Influx}) = (\\text{Rate of Carbon Efflux})$$\n$$A_C = R_{l,C} + S + E_C$$\n\nWe can now solve for the carbon export rate, $E_C$:\n$$E_C = A_C - R_{l,C} - S$$\nSubstituting the given numerical values:\n$$E_C = 20 \\, \\frac{\\mu\\text{mol C}}{\\text{m}^2 \\cdot \\text{s}} - 2 \\, \\frac{\\mu\\text{mol C}}{\\text{m}^2 \\cdot \\text{s}} - 4 \\, \\frac{\\mu\\text{mol C}}{\\text{m}^2 \\cdot \\text{s}}$$\n$$E_C = 14 \\, \\frac{\\mu\\text{mol C}}{\\text{m}^2 \\cdot \\text{s}}$$\nThis result represents the rate at which carbon atoms are exported from the leaf. The problem, however, asks for the rate of sucrose export, let's call it $E_{sucrose}$, in units of $\\mu\\text{mol sucrose m}^{-2} \\text{s}^{-1}$.\n\nTo perform this conversion, we use the stoichiometry of a sucrose molecule, which has the chemical formula $\\text{C}_{12}\\text{H}_{22}\\text{O}_{11}$. This formula indicates that one mole of sucrose contains $12$ moles of carbon atoms. The relationship between the molar flux of sucrose and the molar flux of carbon contained within it is:\n$$E_C = 12 \\times E_{sucrose}$$\nWe must rearrange this equation to solve for the rate of sucrose export:\n$$E_{sucrose} = \\frac{E_C}{12}$$\nSubstituting the value we calculated for $E_C$:\n$$E_{sucrose} = \\frac{14 \\, \\frac{\\mu\\text{mol C}}{\\text{m}^2 \\cdot \\text{s}}}{12 \\, \\frac{\\mu\\text{mol C}}{\\mu\\text{mol sucrose}}}$$\n$$E_{sucrose} = \\frac{14}{12} \\, \\frac{\\mu\\text{mol sucrose}}{\\text{m}^2 \\cdot \\text{s}} = \\frac{7}{6} \\, \\frac{\\mu\\text{mol sucrose}}{\\text{m}^2 \\cdot \\text{s}}$$\nExecuting the division, we obtain:\n$$E_{sucrose} \\approx 1.1666... \\, \\frac{\\mu\\text{mol sucrose}}{\\text{m}^2 \\cdot \\text{s}}$$\nThe problem requires the answer to be rounded to four significant figures. Rounding the result gives:\n$$E_{sucrose} \\approx 1.167 \\, \\frac{\\mu\\text{mol sucrose}}{\\text{m}^2 \\cdot \\text{s}}$$\nThis is the maximum possible export rate under the specified steady-state conditions, as all other fluxes are fixed.", "answer": "$$\\boxed{1.167}$$", "id": "2554154"}, {"introduction": "Once carbon is exported from a source leaf, it is partitioned among various competing sink organs. This exercise explores the principles of sink competition using a classic kinetic framework based on Michaelis-Menten enzyme kinetics [@problem_id:2554143]. You will derive how a fixed supply of sucrose is divided between two sinks with different maximum uptake capacities ($V_{\\max}$) but identical affinities (same Michaelis constant, $K_m$), demonstrating a fundamental rule of resource allocation. This practice provides a clear, quantitative link between the biochemical properties of membrane transporters and the emergent pattern of carbon distribution at the whole-plant level.", "problem": "A photosynthesizing source leaf exports sucrose into the phloem at a fixed steady rate of $12 \\, \\text{nmol s}^{-1}$. Two sink organs, sink $A$ and sink $B$, draw from the same phloem stream. Each sink’s sucrose uptake is mediated by membrane transporters that follow Michaelis–Menten kinetics with the same affinity (same $K_{m}$), and the phloem sucrose concentration experienced by both sinks is the same at steady state. The maximum uptake capacities (maximum velocities at saturating concentration) are $V_{\\max,A}=5 \\, \\text{nmol s}^{-1}$ for sink $A$ and $V_{\\max,B}=10 \\, \\text{nmol s}^{-1}$ for sink $B$. Assume that the source supply is below the sum of the two capacities so that neither sink is saturated and a steady-state phloem concentration is established that is common to both sinks.\n\nUsing only the following foundational bases:\n- Transporter-mediated uptake follows Michaelis–Menten kinetics: for sink $i$, the sucrose influx $J_{i}$ satisfies $J_{i}=V_{\\max,i}\\,\\dfrac{C}{K_{m}+C}$ when exposed to an external sucrose concentration $C$.\n- Conservation of mass at steady state requires that the sum of sink influxes equals the fixed source export.\n\nDerive from these bases how the fixed export is partitioned between the two sinks under the stated conditions, and compute each sink’s steady sucrose influx. Express each sink’s influx in $\\text{nmol s}^{-1}$. Give exact values; do not round. Provide your final answer as a row matrix in the order $(\\text{sink }A,\\ \\text{sink }B)$ with no units in the matrix.", "solution": "The problem statement must first be rigorously validated for its scientific and logical integrity before any attempt is made to derive a solution.\n\nStep 1: Extraction of Givens.\nThe problem provides the following explicit data and conditions:\n-   A fixed steady-state source export rate of sucrose into the phloem, $S = 12 \\, \\text{nmol s}^{-1}$.\n-   Two sink organs, sink $A$ and sink $B$.\n-   Maximum sucrose uptake capacity for sink $A$: $V_{\\max,A} = 5 \\, \\text{nmol s}^{-1}$.\n-   Maximum sucrose uptake capacity for sink $B$: $V_{\\max,B} = 10 \\, \\text{nmol s}^{-1}$.\n-   The sucrose uptake for each sink $i$, denoted as $J_i$, follows Michaelis–Menten kinetics: $J_{i} = V_{\\max,i} \\frac{C}{K_{m} + C}$, where $C$ is the sucrose concentration.\n-   The Michaelis constant, $K_m$, is the same for both sinks: $K_{m,A} = K_{m,B} = K_m$.\n-   The phloem sucrose concentration, $C$, experienced by both sinks is the same at steady state.\n-   The system is at steady state, meaning the total influx to the sinks equals the source export: $J_A + J_B = S$.\n-   The source supply is below the combined maximum capacities of the sinks: $S < V_{\\max,A} + V_{\\max,B}$.\n\nStep 2: Validation.\nThe problem is scientifically grounded, employing the well-established Michaelis–Menten model for transporter kinetics and the fundamental principle of mass conservation (continuity equation at steady state). These are standard concepts in quantitative biology, particularly in modeling source-sink dynamics in plants. The problem is well-posed; it provides sufficient information to determine the unknowns ($J_A$ and $J_B$). The condition $S < V_{\\max,A} + V_{\\max,B}$ is explicitly stated and is consistent with the numerical values given ($12 < 5 + 10$, which is $12 < 15$). This ensures the system operates in a non-saturating regime where concentration $C$ is a key determinant, which is consistent with the setup. The language is objective and precise. There are no contradictions, ambiguities, or scientifically unsound premises.\n\nStep 3: Verdict.\nThe problem is deemed valid. A solution will be derived.\n\nThe derivation proceeds from the foundational principles given. The sucrose influx into sink $A$, $J_A$, and sink $B$, $J_B$, are described by their respective Michaelis–Menten equations:\n$$J_A = V_{\\max,A} \\frac{C}{K_m + C}$$\n$$J_B = V_{\\max,B} \\frac{C}{K_m + C}$$\nIt is critical to observe that the term $\\frac{C}{K_m + C}$, which represents the fractional saturation of the transporters, is identical for both sinks. This is because both sinks are exposed to the same phloem sucrose concentration $C$ and possess transporters with the same Michaelis constant $K_m$.\n\nThis shared dependency allows for the direct determination of the partitioning ratio between the two sinks. By dividing the equation for $J_A$ by the equation for $J_B$, we obtain:\n$$\\frac{J_A}{J_B} = \\frac{V_{\\max,A} \\frac{C}{K_m + C}}{V_{\\max,B} \\frac{C}{K_m + C}}$$\nThe term $\\frac{C}{K_m + C}$ cancels, yielding a simple relationship between the influxes and the maximum capacities:\n$$\\frac{J_A}{J_B} = \\frac{V_{\\max,A}}{V_{\\max,B}}$$\nThis result demonstrates that under these conditions, the total substrate supply is partitioned between the competing sinks in direct proportion to their maximum uptake capacities. This is a fundamental principle of resource competition between sinks with identical transporter affinities.\n\nWe now have a system of two linear equations for the two unknown variables, $J_A$ and $J_B$:\n1.  Conservation of mass: $J_A + J_B = S$\n2.  Partitioning ratio: $J_A = J_B \\left( \\frac{V_{\\max,A}}{V_{\\max,B}} \\right)$\n\nSubstitute the second equation into the first:\n$$J_B \\left( \\frac{V_{\\max,A}}{V_{\\max,B}} \\right) + J_B = S$$\nFactor out $J_B$:\n$$J_B \\left( \\frac{V_{\\max,A}}{V_{\\max,B}} + 1 \\right) = S$$\n$$J_B \\left( \\frac{V_{\\max,A} + V_{\\max,B}}{V_{\\max,B}} \\right) = S$$\nSolving for $J_B$ gives:\n$$J_B = S \\left( \\frac{V_{\\max,B}}{V_{\\max,A} + V_{\\max,B}} \\right)$$\nSimilarly, by expressing $J_B$ in terms of $J_A$ ($J_B = J_A \\frac{V_{\\max,B}}{V_{\\max,A}}$) and substituting into the conservation equation, we find the expression for $J_A$:\n$$J_A + J_A \\left( \\frac{V_{\\max,B}}{V_{\\max,A}} \\right) = S$$\n$$J_A \\left( 1 + \\frac{V_{\\max,B}}{V_{\\max,A}} \\right) = S$$\n$$J_A \\left( \\frac{V_{\\max,A} + V_{\\max,B}}{V_{\\max,A}} \\right) = S$$\nSolving for $J_A$ gives:\n$$J_A = S \\left( \\frac{V_{\\max,A}}{V_{\\max,A} + V_{\\max,B}} \\right)$$\nThese analytical expressions show that each sink's share of the total flux $S$ is equivalent to its fractional contribution to the total maximum uptake capacity.\n\nNow, we substitute the provided numerical values:\n$S = 12 \\, \\text{nmol s}^{-1}$\n$V_{\\max,A} = 5 \\, \\text{nmol s}^{-1}$\n$V_{\\max,B} = 10 \\, \\text{nmol s}^{-1}$\n\nThe total maximum capacity is $V_{\\max,A} + V_{\\max,B} = 5 + 10 = 15 \\, \\text{nmol s}^{-1}$.\n\nThe influx for sink $A$ is:\n$$J_A = 12 \\left( \\frac{5}{15} \\right) = 12 \\left( \\frac{1}{3} \\right) = 4 \\, \\text{nmol s}^{-1}$$\nThe influx for sink $B$ is:\n$$J_B = 12 \\left( \\frac{10}{15} \\right) = 12 \\left( \\frac{2}{3} \\right) = 8 \\, \\text{nmol s}^{-1}$$\n\nTo verify, the sum of these influxes is $J_A + J_B = 4 + 8 = 12 \\, \\text{nmol s}^{-1}$, which correctly equals the source supply $S$. The derived values are the exact steady-state influxes for each sink.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4 & 8\n\\end{pmatrix}\n}\n$$", "id": "2554143"}, {"introduction": "The ultimate test of a physiological model is its ability to explain real-world data. This advanced computational exercise takes you from theoretical calculations to the practical application of model fitting and validation [@problem_id:2554157]. You will implement a dynamic model of carbon allocation, estimate its key parameters by fitting it to time-series data using a nonlinear least-squares method, and critically assess whether those parameters are uniquely identifiable. This practice provides hands-on experience with the essential tools and concepts of modern quantitative biology, preparing you to build, test, and interpret complex models of physiological systems.", "problem": "You are given a simplified, physiologically grounded source–sink carbon allocation model for a plant with two structural organs (leaves and roots) and a single well-mixed pool of Non-Structural Carbohydrates (NSC). The goal is to estimate the allocation transfer coefficients that govern the flow of carbon from the NSC pool to each structural organ, by fitting model predictions to provided time series of organ biomass and NSC concentrations. You must implement a program that solves a constrained weighted least-squares problem to estimate the parameters, and then assess local structural identifiability via the rank and conditioning of the sensitivity (Jacobian) matrix at the optimum.\n\nModel and assumptions grounded in conservation of mass:\n- Let $L_t$ and $R_t$ denote leaf and root structural biomass (in $\\text{g}$) at day index $t$.\n- Let $N_t$ denote the mass of NSC (in $\\text{g}$) at day index $t$.\n- Let $A_t$ denote the net assimilation of NSC (in $\\text{g/day}$) input during day $t$.\n- Allocation from the NSC pool to structural biomass is modeled by first-order transfer with constant coefficients $k_L$ and $k_R$ (in $\\text{day}^{-1}$) over the time window of interest.\n- Time advances in one-day steps with forward-Euler mass balance, with no explicit maintenance or loss terms other than allocation:\n  $$\n  \\begin{aligned}\n  L_{t+1} &= L_t + k_L N_t, \\\\\n  R_{t+1} &= R_t + k_R N_t, \\\\\n  N_{t+1} &= N_t + A_t - (k_L + k_R)N_t.\n  \\end{aligned}\n  $$\n- The observed whole-plant NSC concentration $C_t$ (in $\\text{mg/g}$) is related to the model states by\n  $$\n  C_t = 1000 \\cdot \\frac{N_t}{L_t + R_t}.\n  $$\n- Observations are provided at discrete times $t = 0, 1, \\dots, T$, with a known assimilation series $\\{A_t\\}_{t=0}^{T-1}$ and known initial conditions $L_0$, $R_0$, $N_0$.\n\nParameter estimation problem:\n- The unknown parameters are $k_L$ and $k_R$, constrained to the interval $[0,1] \\text{ day}^{-1}$.\n- Let $\\widehat{L}_t(k_L,k_R)$, $\\widehat{R}_t(k_L,k_R)$, and $\\widehat{C}_t(k_L,k_R)$ denote model predictions.\n- Given observed series $\\{L_t^{\\text{obs}}\\}$, $\\{R_t^{\\text{obs}}\\}$, $\\{C_t^{\\text{obs}}\\}$ and positive scaling constants $s_L$ (in $\\text{g}$), $s_R$ (in $\\text{g}$), $s_C$ (in $\\text{mg/g}$), define a dimensionless residual vector by stacking across time\n  $$\n  \\mathbf{r}(k_L,k_R) = \\left[ \\frac{\\widehat{L}_t - L_t^{\\text{obs}}}{s_L}, \\frac{\\widehat{R}_t - R_t^{\\text{obs}}}{s_R}, \\frac{\\widehat{C}_t - C_t^{\\text{obs}}}{s_C} \\right]_{t=0}^{T}.\n  $$\n- Estimate $(k_L,k_R)$ by minimizing the weighted sum of squares $J(k_L,k_R) = \\|\\mathbf{r}(k_L,k_R)\\|_2^2$ subject to $0 \\le k_L \\le 1$ and $0 \\le k_R \\le 1$.\n\nIdentifiability assessment:\n- Let $\\mathbf{J}$ denote the Jacobian (sensitivity) matrix of $\\mathbf{r}$ with respect to $(k_L,k_R)$, evaluated at the estimated parameters. Local structural identifiability is indicated if $\\operatorname{rank}(\\mathbf{J}) = 2$ and the condition number $\\kappa(\\mathbf{J})$ is below a specified threshold. Use the singular value decomposition to estimate rank and condition number, and declare the parameter pair locally identifiable if and only if the estimated rank equals $2$ and $\\kappa(\\mathbf{J}) < 10^8$.\n\nNumerical units and outputs:\n- The transfer coefficients $k_L$ and $k_R$ must be reported in $\\text{day}^{-1}$.\n- The Root Mean Square Error (RMSE) must be computed from the dimensionless residuals and reported as a dimensionless float.\n- The identifiability decision must be a boolean.\n- Angles are not used. No percentages are used.\n\nYour program must solve three test cases. For each, compute and report $[k_L, k_R, \\text{RMSE}, \\text{Identifiable}]$, where $k_L$ and $k_R$ are in $\\text{day}^{-1}$, RMSE is the dimensionless root mean square of the stacked residuals, and Identifiable is a boolean. Round each floating-point number to six decimal places in the final output.\n\nTest Suite:\n- Case 1 (informative, well-conditioned):\n  - Assimilation series ($\\text{g/day}$) over days $t=0,\\dots,6$: $A = [1.2, 1.5, 1.3, 1.1, 1.4, 1.0, 0.8]$.\n  - Initial conditions: $L_0 = 5.0 \\text{ g}$, $R_0 = 5.0 \\text{ g}$, $N_0 = 1.0 \\text{ g}$.\n  - Observations: Use the model above with the true parameters $k_L^{\\star} = 0.08 \\text{ day}^{-1}$ and $k_R^{\\star} = 0.04 \\text{ day}^{-1}$ to generate $\\{L_t^{\\text{obs}}\\}$, $\\{R_t^{\\text{obs}}\\}$, and $\\{C_t^{\\text{obs}}\\}$ for $t=0,\\dots,7$; no additional noise is added.\n  - Scaling constants: $s_L = 1.0 \\text{ g}$, $s_R = 1.0 \\text{ g}$, $s_C = 10.0 \\text{ mg/g}$.\n  - Expectation: near-recovery of $k_L^{\\star}$ and $k_R^{\\star}$, small RMSE, identifiable true.\n\n- Case 2 (insufficient observables for separation of flows):\n  - Same $A$, $L_0$, $R_0$, $N_0$, and generated observations as in Case 1.\n  - Scaling constants: $s_L = +\\infty$ (implemented as weight $0$), $s_R = +\\infty$ (implemented as weight $0$), $s_C = 10.0 \\text{ mg/g}$. That is, only $\\{C_t^{\\text{obs}}\\}$ contributes to the residual.\n  - Expectation: objective depends on $k_L + k_R$ only, hence local non-identifiability; algorithm will return one of infinitely many solutions (for example, symmetric values near $0.06$ and $0.06$), and identifiability false.\n\n- Case 3 (no NSC available, no assimilation):\n  - Assimilation series: $A = [0.0, 0.0, 0.0, 0.0]$ (days $t=0,\\dots,3$).\n  - Initial conditions: $L_0 = 4.0 \\text{ g}$, $R_0 = 6.0 \\text{ g}$, $N_0 = 0.0 \\text{ g}$.\n  - Observations: With $N_0=0 \\text{ g}$ and $A_t=0 \\text{ g/day}$ for all $t$, the model predicts constant $L_t$, $R_t$, and $C_t=0 \\text{ mg/g}$; use these as $\\{L_t^{\\text{obs}}\\}$, $\\{R_t^{\\text{obs}}\\}$, and $\\{C_t^{\\text{obs}}\\}$ for $t=0,\\dots,4$.\n  - Scaling constants: $s_L = 1.0 \\text{ g}$, $s_R = 1.0 \\text{ g}$, $s_C = 1.0 \\text{ mg/g}$.\n  - Expectation: residuals are independent of $(k_L,k_R)$, so identifiability false; optimizer will likely return the initial guess.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a list in the form $[k_L, k_R, \\text{RMSE}, \\text{Identifiable}]$, with $k_L$ and $k_R$ in $\\text{day}^{-1}$, RMSE dimensionless, and Identifiable a boolean. Example format (not actual numbers): [[0.080000,0.040000,0.000000,True],[0.060000,0.060000,0.001234,False],[0.050000,0.050000,0.000000,False]].\n\nImplementation notes:\n- Use a constrained nonlinear least squares solver to minimize $J(k_L,k_R)$ with bounds $[0,1]$ $\\text{day}^{-1}$ on each parameter.\n- Compute RMSE as the square root of the mean of squared dimensionless residuals across all times and observables included by the scaling constants.\n- Determine the Jacobian at the optimum numerically and assess local identifiability by rank and condition number with the threshold $\\kappa(\\mathbf{J}) < 10^8$.", "solution": "The problem requires the estimation of carbon allocation parameters, $k_L$ and $k_R$, in a simplified plant physiology model. The estimation is to be performed by fitting the model to synthetic data using a constrained weighted nonlinear least-squares approach. Subsequently, a local structural identifiability analysis must be conducted on the estimated parameters using the Jacobian matrix.\n\nThe model describes the dynamics of leaf biomass ($L_t$), root biomass ($R_t$), and non-structural carbohydrate (NSC) mass ($N_t$) over discrete time steps. The system of equations is given by a forward-Euler approximation:\n$$\n\\begin{aligned}\nL_{t+1} &= L_t + k_L N_t \\\\\nR_{t+1} &= R_t + k_R N_t \\\\\nN_{t+1} &= N_t + A_t - (k_L + k_R)N_t\n\\end{aligned}\n$$\nHere, $A_t$ is the daily net assimilation. The observable NSC concentration, $C_t$, is related to the state variables by:\n$$\nC_t = 1000 \\cdot \\frac{N_t}{L_t + R_t}\n$$\n\nThe solution proceeds in several logical steps for each test case:\n1.  **Data Generation**: For each test case, a set of \"observed\" time series data $\\{L_t^{\\text{obs}}\\}$, $\\{R_t^{\\text{obs}}\\}$, and $\\{C_t^{\\text{obs}}\\}$ is generated by simulating the model equations using the specified \"true\" parameters (or representative parameters, in cases of ambiguity) and initial conditions. This provides a ground truth against which the estimation algorithm is tested.\n\n2.  **Parameter Estimation**: The core of the problem is to find the parameters $(k_L, k_R)$ that minimize the sum of squared weighted residuals, $J(k_L, k_R)$. The residual vector $\\mathbf{r}$ is composed of the normalized differences between model predictions and the generated observations.\n    $$\n    J(k_L,k_R) = \\sum_{t=0}^{T} \\left[ \\left(\\frac{\\widehat{L}_t - L_t^{\\text{obs}}}{s_L}\\right)^2 + \\left(\\frac{\\widehat{R}_t - R_t^{\\text{obs}}}{s_R}\\right)^2 + \\left(\\frac{\\widehat{C}_t - C_t^{\\text{obs}}}{s_C}\\right)^2 \\right]\n    $$\n    This is a nonlinear least-squares problem, which is solved numerically. The `scipy.optimize.least_squares` function is well-suited for this task, as it can efficiently minimize the sum of squares of a vector-valued function and handle the box constraints $0 \\le k_L, k_R \\le 1$. An initial guess for the parameters, such as $(k_L, k_R) = (0.05, 0.05)$, is required to start the iterative optimization process. Note that infinite scaling constants $s_L, s_R$ are handled by excluding the corresponding terms from the residual vector, effectively assigning them zero weight in the objective function.\n\n3.  **RMSE Calculation**: Upon finding the optimal parameters $(k_L^*, k_R^*)$, the Root Mean Square Error (RMSE) is calculated. It is defined as the square root of the mean of the squared dimensionless residuals. If $J^*$ is the minimized sum of squares and $M$ is the total number of residual entries (summed over all time points and included observables), the RMSE is given by:\n    $$\n    \\text{RMSE} = \\sqrt{\\frac{J^*}{M}}\n    $$\n\n4.  **Local Structural Identifiability Analysis**: This analysis assesses whether the parameters can be uniquely determined from the given data and model structure, at least locally around the estimated optimum. It relies on the sensitivity (Jacobian) matrix, $\\mathbf{J}$, which contains the partial derivatives of the residual vector with respect to each parameter, evaluated at the optimal parameter values.\n    $$\n    \\mathbf{J}_{ij} = \\frac{\\partial r_i}{\\partial p_j} \\bigg|_{(k_L^*, k_R^*)}\n    $$\n    The `scipy.optimize.least_squares` function conveniently provides a numerical approximation of this matrix.\n    - **Rank**: A necessary condition for local identifiability of $n$ parameters is that the Jacobian matrix has full column rank (i.e., $\\operatorname{rank}(\\mathbf{J}) = n$). In this problem, with two parameters $(k_L, k_R)$, we require $\\operatorname{rank}(\\mathbf{J}) = 2$. This means the parameters have linearly independent effects on the model output. The rank is computed robustly using the Singular Value Decomposition (SVD).\n    - **Condition Number**: If the rank condition is met, the condition number $\\kappa(\\mathbf{J})$ provides a measure of the sensitivity of the solution to small changes in the data. It is the ratio of the largest to the smallest singular value of $\\mathbf{J}$. A very large condition number indicates that the problem is ill-conditioned, meaning that even small amounts of noise in the data could lead to large changes in the estimated parameters. The problem specifies a threshold of $10^8$.\n\n    A parameter pair is declared locally identifiable if and only if $\\operatorname{rank}(\\mathbf{J}) = 2$ and $\\kappa(\\mathbf{J}) < 10^8$.\n\nThe implementation will process each of the three specified test cases according to this methodology, calculating the optimal parameters, RMSE, and the identifiability status, and format the results as required.\n- **Case 1**: With all three observables weighted, the model parameters have distinct effects on the outputs, leading to a well-conditioned Jacobian and successful parameter recovery.\n- **Case 2**: By observing only the NSC concentration $C_t$, we lose the ability to distinguish the individual contributions of $k_L$ and $k_R$ to growth. The NSC dynamics depend only on their sum, $k_L + k_R$. Consequently, the columns of the Jacobian become linearly dependent, its rank drops to $1$, and the parameters are non-identifiable.\n- **Case 3**: With zero initial NSC and zero assimilation, no growth occurs. The model outputs become constant and independent of $k_L$ and $k_R$. The residuals are identically zero for any parameter values, rendering the Jacobian a matrix of zeros. Its rank is $0$, and the parameters are non-identifiable. The optimizer will simply return its initial guess.", "answer": "[[0.080000, 0.040000, 0.000000, True], [0.060000, 0.060000, 0.000000, False], [0.050000, 0.050000, 0.000000, False]]", "id": "2554157"}]}