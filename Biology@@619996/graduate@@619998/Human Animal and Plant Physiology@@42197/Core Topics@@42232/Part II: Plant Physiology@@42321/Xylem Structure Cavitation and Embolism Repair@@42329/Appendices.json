{"hands_on_practices": [{"introduction": "To understand how plants withstand the enormous tensions required for water transport, we must first examine the microscopic structures that prevent catastrophic failure. This practice delves into the physics of air-seeding at the inter-vessel pit membranes, the primary points of failure. By applying the Young-Laplace relation [@problem_id:2624082], you will calculate the critical pore size needed to prevent emboli from spreading at a given xylem tension and explore how the surface chemistry (wettability) of the pit membrane is a crucial determinant of cavitation resistance.", "problem": "A bordered pit membrane in angiosperm xylem can be idealized as a thin sheet perforated by circular pores of radius $r$ that separate an air-filled conduit (at approximately atmospheric pressure) from a water-filled conduit under negative pressure (tension). Assume the water–air interface inside a pore is quasi-static, gravity is negligible at the pore scale, and the interface conforms to the equilibrium contact angle $\\theta$ of xylem sap on the pit-wall material. Take the xylem water pressure to be $P_{\\text{liquid}}=P_{\\text{atm}}-|T|$, where $|T|$ is the magnitude of xylem tension relative to atmospheric pressure, and the air pressure to be $P_{\\text{air}}\\approx P_{\\text{atm}}$.\n\nStarting from the Young–Laplace relation that links the pressure difference across a curved interface to surface tension and curvature, and using the definition of contact angle for a cylindrical capillary, derive the condition for the minimum pore radius $r_{\\min}$ that prevents air entry (air-seeding) at a given xylem tension $|T|$. Then evaluate $r_{\\min}$ numerically for two materials with identical surface tension of sap but different wettability:\n- a highly hydrophilic cellulose-like wall with $\\theta_{1}=20^{\\circ}$,\n- a nominally mildly hydrophobic wall whose effective in situ sap contact angle is reduced by surfactants to $\\theta_{2}=80^{\\circ}$.\n\nUse a physiologically plausible sap surface tension $\\gamma=0.050~\\text{N}\\,\\text{m}^{-1}$ and a xylem tension magnitude $|T|=0.80\\times 10^{6}~\\text{Pa}$. Treat the pore as a circular cylindrical capillary. Express both $r_{\\min}$ values in nanometers and round your answers to three significant figures. Angles are given in degrees, and you should use degrees for any trigonometric evaluation. The final answer must be the pair $\\big(r_{\\min}(\\theta_{1}),\\,r_{\\min}(\\theta_{2})\\big)$ reported in nanometers.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nStep 1: Extract Givens\n- System: A bordered pit membrane in angiosperm xylem, modeled as a thin sheet with circular pores of radius $r$.\n- Pores separate an air-filled conduit from a water-filled conduit.\n- Air pressure: $P_{\\text{air}} \\approx P_{\\text{atm}}$.\n- Water pressure: $P_{\\text{liquid}} = P_{\\text{atm}} - |T|$, where $|T|$ is the xylem tension magnitude.\n- Assumptions: The water-air interface is quasi-static, gravity is negligible, the interface has an equilibrium contact angle $\\theta$.\n- Governing Principle: Young-Laplace relation.\n- Task 1: Derive the condition for the minimum pore radius $r_{\\min}$ that prevents air entry at a given tension $|T|$.\n- Task 2: Evaluate $r_{\\min}$ numerically for two cases.\n- Case 1: Hydrophilic wall, $\\theta_{1} = 20^{\\circ}$.\n- Case 2: Mildly hydrophobic wall, $\\theta_{2} = 80^{\\circ}$.\n- Constants:\n  - Surface tension of sap: $\\gamma = 0.050~\\text{N}\\,\\text{m}^{-1}$.\n  - Xylem tension magnitude: $|T| = 0.80 \\times 10^{6}~\\text{Pa}$.\n- Pore geometry: Circular cylindrical capillary.\n- Output requirements: Report the pair of values for $r_{\\min}$ in nanometers, rounded to three significant figures.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. It presents a standard biophysical model of cavitation by air-seeding in plant xylem, a well-established phenomenon. The use of the Young-Laplace equation is the correct physical principle for describing the pressure difference across a curved liquid interface. The problem is well-posed, providing all necessary parameters and a clear objective. The data values for surface tension and xylem tension are physiologically realistic. The language is objective and precise. However, the terminology \"minimum pore radius $r_{\\min}$ that prevents air entry\" is imprecise. A smaller pore radius provides greater resistance to air entry. Thus, for a given tension $|T|$, there is a *maximum* pore radius above which air-seeding will occur. Any radius smaller than this critical value will also prevent air entry. This \"minimum radius\" must be interpreted as the critical radius at the threshold of failure. This terminological flaw is a minor ambiguity common in the literature and does not render the problem invalid, as a single, physically meaningful interpretation exists. The problem is therefore deemed valid.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\nThe pressure difference, $\\Delta P$, across a curved interface between two fluids is given by the Young-Laplace equation. For a spherical interface with a single radius of curvature $R_{curve}$, this relation is:\n$$ \\Delta P = \\frac{2\\gamma}{R_{curve}} $$\nwhere $\\gamma$ is the surface tension of the liquid. The pressure difference is defined as the pressure in the concave phase (air) minus the pressure in the convex phase (water).\n$$ \\Delta P = P_{\\text{air}} - P_{\\text{liquid}} $$\nUsing the given pressure expressions:\n$$ \\Delta P = P_{\\text{atm}} - (P_{\\text{atm}} - |T|) = |T| $$\nThus, the magnitude of the xylem tension is balanced by the capillary pressure:\n$$ |T| = \\frac{2\\gamma}{R_{curve}} $$\nThe pore is modeled as a circular cylinder of radius $r$. The water-air meniscus inside the pore is a spherical cap. From geometric considerations, the radius of the pore, $r$, is related to the radius of curvature of the meniscus, $R_{curve}$, and the contact angle, $\\theta$, by:\n$$ r = R_{curve} \\cos(\\theta) $$\nThis relation assumes the contact angle is measured through the liquid phase. Rearranging for $R_{curve}$:\n$$ R_{curve} = \\frac{r}{\\cos(\\theta)} $$\nSubstituting this expression for $R_{curve}$ into the pressure balance equation gives the relationship between the tension, pore radius, and material properties:\n$$ |T| = \\frac{2\\gamma \\cos(\\theta)}{r} $$\nAir-seeding occurs when the applied tension $|T|$ exceeds the maximum pressure the meniscus can sustain. For a given pore of radius $r$, stability is maintained as long as $|T| \\le \\frac{2\\gamma \\cos(\\theta)}{r}$. The critical condition for air-seeding is the equality, which defines the maximum radius, $r_c$, that can withstand a given tension $|T|$. As noted in the validation, the problem refers to this as $r_{\\min}$, which we interpret as this critical radius:\n$$ r_{c} = \\frac{2\\gamma \\cos(\\theta)}{|T|} $$\nAny pore with $r > r_{c}$ will cavitate at this tension. We now evaluate this expression for the two given cases.\n\nThe provided parameters are:\n$\\gamma = 0.050~\\text{N}\\,\\text{m}^{-1}$\n$|T| = 0.80 \\times 10^{6}~\\text{Pa} = 0.80 \\times 10^{6}~\\text{N}\\,\\text{m}^{-2}$\n\nCase 1: Hydrophilic wall with $\\theta_{1} = 20^{\\circ}$.\nThe critical radius, which we denote $r_1$, is:\n$$ r_{1} = \\frac{2 \\times (0.050~\\text{N}\\,\\text{m}^{-1}) \\times \\cos(20^{\\circ})}{0.80 \\times 10^{6}~\\text{N}\\,\\text{m}^{-2}} $$\n$$ r_{1} = \\frac{0.10 \\times \\cos(20^{\\circ})}{0.80 \\times 10^{6}}~\\text{m} $$\nUsing $\\cos(20^{\\circ}) \\approx 0.9396926$:\n$$ r_{1} \\approx \\frac{0.10 \\times 0.9396926}{0.80 \\times 10^{6}}~\\text{m} \\approx \\frac{0.09396926}{0.80 \\times 10^{6}}~\\text{m} \\approx 1.1746 \\times 10^{-7}~\\text{m} $$\nTo express this in nanometers, we multiply by $10^{9}$:\n$$ r_{1} \\approx 1.1746 \\times 10^{-7}~\\text{m} \\times (10^{9}~\\text{nm}\\,\\text{m}^{-1}) = 117.46~\\text{nm} $$\nRounding to three significant figures, we get $r_{1} = 117~\\text{nm}$.\n\nCase 2: Mildly hydrophobic wall with $\\theta_{2} = 80^{\\circ}$.\nThe critical radius, $r_2$, is:\n$$ r_{2} = \\frac{2 \\times (0.050~\\text{N}\\,\\text{m}^{-1}) \\times \\cos(80^{\\circ})}{0.80 \\times 10^{6}~\\text{N}\\,\\text{m}^{-2}} $$\n$$ r_{2} = \\frac{0.10 \\times \\cos(80^{\\circ})}{0.80 \\times 10^{6}}~\\text{m} $$\nUsing $\\cos(80^{\\circ}) \\approx 0.173648$:\n$$ r_{2} \\approx \\frac{0.10 \\times 0.173648}{0.80 \\times 10^{6}}~\\text{m} \\approx \\frac{0.0173648}{0.80 \\times 10^{6}}~\\text{m} \\approx 2.1706 \\times 10^{-8}~\\text{m} $$\nTo express this in nanometers:\n$$ r_{2} \\approx 2.1706 \\times 10^{-8}~\\text{m} \\times (10^{9}~\\text{nm}\\,\\text{m}^{-1}) = 21.706~\\text{nm} $$\nRounding to three significant figures, we get $r_{2} = 21.7~\\text{nm}$.\n\nThe results show that a hydrophilic pit membrane ($\\theta_1 = 20^{\\circ}$) can have much larger pores than a less wettable one ($\\theta_2 = 80^{\\circ}$) while providing the same protection against cavitation at a given water tension. This demonstrates the functional advantage of the highly hydrophilic nature of the cellulose and pectin matrix of pit membranes.", "answer": "$$\\boxed{(117, 21.7)}$$", "id": "2624082"}, {"introduction": "While cavitation begins at a microscopic pore, its consequences are felt at the scale of the whole plant. This exercise models the entire plant's water transport system as an electrical circuit analog, where hydraulic resistances of different organs add up in series. By solving this problem [@problem_id:2624050], you will quantify how the embolism of a fraction of xylem conduits in the stem increases the total plant hydraulic resistance, thereby calculating the greater water potential difference ($\\Delta \\Psi$) required to sustain a given transpiration flux.", "problem": "A transpiring angiosperm sapling can be represented as a linear hydraulic network composed of three segments in series: roots, stem, and leaves. At steady state, under negligible internal storage-capacitance and constant sap flux viscosity, the mass flux of water is proportional to the driving water potential difference between the soil-root interface and the leaf apoplast. Define the hydraulic conductance of each segment $i \\in \\{\\text{root}, \\text{stem}, \\text{leaf}\\}$ as $K_{i}$ (units: $\\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$), and let the whole-plant conductance be $K_{\\text{plant}}$. Cavitation events create gas emboli that disable a fraction of xylem conduits. In the stem, conduits can be idealized as identical pipes in parallel; when a fraction $f$ is embolized, the functional parallel network size is reduced by a factor of $(1-f)$, and the effective stem conductance is reduced in proportion to $(1-f)$. Assume embolism does not alter conduit geometry of the remaining functional conduits.\n\nGiven the following data at midday steady state:\n- Root segment baseline conductance $K_{\\text{root},0} = 2.0 \\times 10^{-4}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$.\n- Stem segment baseline conductance $K_{\\text{stem},0} = 3.0 \\times 10^{-4}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$.\n- Leaf segment baseline conductance $K_{\\text{leaf},0} = 1.2 \\times 10^{-4}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$.\n- Fraction of embolized stem conduits $f = 0.50$.\n- Steady transpiration mass flux $E = 1.0 \\times 10^{-5}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$.\n\nWork from first principles appropriate to plant hydraulics (linear flow–potential proportionality; definition of conductance and resistance; series combination of hydraulic resistances; scaling of parallel-network conductance with the number of functional conduits) to:\n1. Derive an expression for the leaf-to-root water potential difference $\\Delta \\Psi$ (taken as the magnitude of the potential drop from soil-root interface to leaf apoplast) required to sustain the flux $E$ in terms of $E$, $K_{\\text{root},0}$, $K_{\\text{stem},0}$, $K_{\\text{leaf},0}$, and $f$.\n2. Evaluate $\\Delta \\Psi$ using the given numerical values.\n\nExpress the final answer for $\\Delta \\Psi$ in megapascal (MPa) and round your answer to four significant figures. Report $\\Delta \\Psi$ as a positive quantity.", "solution": "The problem is found to be valid. It is scientifically grounded in the principles of plant hydraulics, is well-posed with sufficient and consistent data, and is formulated objectively. The solution proceeds.\n\nThe relationship between steady-state mass flux ($E$), hydraulic conductance ($K$), and the water potential difference driving the flow ($\\Delta \\Psi$) is analogous to Ohm's law:\n$$E = K \\Delta \\Psi$$\nIt is often more convenient to work with hydraulic resistance, $R$, defined as the inverse of conductance:\n$$R = \\frac{1}{K}$$\nThe flow equation can then be written as:\n$$\\Delta \\Psi = E \\times R$$\nThe problem states that the sapling's hydraulic pathway consists of three segments—roots, stem, and leaves—arranged in series. For components in series, their total resistance is the sum of the individual resistances. Therefore, the total plant resistance, $R_{\\text{plant}}$, is:\n$$R_{\\text{plant}} = R_{\\text{root}} + R_{\\text{stem}} + R_{\\text{leaf}}$$\nThe total water potential difference, $\\Delta \\Psi$, across the plant from the soil-root interface to the leaf apoplast is given by the product of the total flux, $E$, and the total plant resistance, $R_{\\text{plant}}$:\n$$\\Delta \\Psi = E \\times R_{\\text{plant}} = E (R_{\\text{root}} + R_{\\text{stem}} + R_{\\text{leaf}})$$\nNext, we must determine the resistance of each segment. The root and leaf segments are stated to be unaffected by embolism, so their conductances are equal to their baseline values, $K_{\\text{root},0}$ and $K_{\\text{leaf},0}$, respectively. Their resistances are:\n$$R_{\\text{root}} = \\frac{1}{K_{\\text{root},0}}$$\n$$R_{\\text{leaf}} = \\frac{1}{K_{\\text{leaf},0}}$$\nFor the stem segment, a fraction $f$ of the xylem conduits is embolized. The problem specifies that the effective stem conductance, $K_{\\text{stem}}$, is reduced in proportion to the remaining functional fraction of conduits, $(1-f)$. Thus, the effective stem conductance is:\n$$K_{\\text{stem}} = K_{\\text{stem},0} (1-f)$$\nThe resistance of the embolized stem segment is therefore:\n$$R_{\\text{stem}} = \\frac{1}{K_{\\text{stem}}} = \\frac{1}{K_{\\text{stem},0}(1-f)}$$\nSubstituting the expressions for individual resistances into the equation for total plant resistance gives:\n$$R_{\\text{plant}} = \\frac{1}{K_{\\text{root},0}} + \\frac{1}{K_{\\text{stem},0}(1-f)} + \\frac{1}{K_{\\text{leaf},0}}$$\nThis leads to the first required result, which is the analytical expression for the total water potential difference, $\\Delta \\Psi$:\n$$\\Delta \\Psi = E \\left( \\frac{1}{K_{\\text{root},0}} + \\frac{1}{K_{\\text{stem},0}(1-f)} + \\frac{1}{K_{\\text{leaf},0}} \\right)$$\nThis completes the first part of the task.\n\nFor the second part, we must evaluate $\\Delta \\Psi$ using the given numerical values:\n- $E = 1.0 \\times 10^{-5}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$\n- $K_{\\text{root},0} = 2.0 \\times 10^{-4}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$\n- $K_{\\text{stem},0} = 3.0 \\times 10^{-4}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$\n- $K_{\\text{leaf},0} = 1.2 \\times 10^{-4}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$\n- $f = 0.50$\n\nFirst, we calculate the individual segment resistances in units of $\\mathrm{MPa}\\,\\mathrm{s}\\,\\mathrm{kg}^{-1}$:\n$$R_{\\text{root}} = \\frac{1}{K_{\\text{root},0}} = \\frac{1}{2.0 \\times 10^{-4}} = 5.0 \\times 10^{3}\\ \\mathrm{MPa}\\,\\mathrm{s}\\,\\mathrm{kg}^{-1}$$\n$$R_{\\text{leaf}} = \\frac{1}{K_{\\text{leaf},0}} = \\frac{1}{1.2 \\times 10^{-4}} = \\frac{10}{12} \\times 10^{4} = \\frac{5}{6} \\times 10^{4} \\approx 8.333 \\times 10^{3}\\ \\mathrm{MPa}\\,\\mathrm{s}\\,\\mathrm{kg}^{-1}$$\nThe effective conductance of the stem is:\n$$K_{\\text{stem}} = K_{\\text{stem},0}(1-f) = (3.0 \\times 10^{-4})(1 - 0.50) = (3.0 \\times 10^{-4})(0.50) = 1.5 \\times 10^{-4}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{MPa}^{-1}$$\nThe resistance of the stem is:\n$$R_{\\text{stem}} = \\frac{1}{K_{\\text{stem}}} = \\frac{1}{1.5 \\times 10^{-4}} = \\frac{10}{15} \\times 10^{4} = \\frac{2}{3} \\times 10^{4} \\approx 6.667 \\times 10^{3}\\ \\mathrm{MPa}\\,\\mathrm{s}\\,\\mathrm{kg}^{-1}$$\nNow, we sum the individual resistances to find the total plant resistance, $R_{\\text{plant}}$:\n$$R_{\\text{plant}} = R_{\\text{root}} + R_{\\text{stem}} + R_{\\text{leaf}} = \\left(\\frac{1}{2.0 \\times 10^{-4}} + \\frac{1}{1.5 \\times 10^{-4}} + \\frac{1}{1.2 \\times 10^{-4}}\\right)$$\n$$R_{\\text{plant}} = 10^{4} \\left( \\frac{1}{2.0} + \\frac{1}{1.5} + \\frac{1}{1.2} \\right) = 10^{4} \\left( \\frac{3}{6} + \\frac{4}{6} + \\frac{5}{6} \\right) = 10^{4} \\left( \\frac{3+4+5}{6} \\right) = 10^{4} \\left( \\frac{12}{6} \\right) = 2.0 \\times 10^{4}\\ \\mathrm{MPa}\\,\\mathrm{s}\\,\\mathrm{kg}^{-1}$$\nFinally, we calculate the water potential difference $\\Delta \\Psi$:\n$$\\Delta \\Psi = E \\times R_{\\text{plant}} = (1.0 \\times 10^{-5}\\ \\mathrm{kg}\\,\\mathrm{s}^{-1}) \\times (2.0 \\times 10^{4}\\ \\mathrm{MPa}\\,\\mathrm{s}\\,\\mathrm{kg}^{-1})$$\n$$\\Delta \\Psi = 2.0 \\times 10^{-1}\\ \\mathrm{MPa} = 0.2\\ \\mathrm{MPa}$$\nThe problem requires the answer to be rounded to four significant figures. Thus, $\\Delta \\Psi = 0.2000\\ \\mathrm{MPa}$. In standard scientific notation, this is $2.000 \\times 10^{-1}\\ \\mathrm{MPa}$.", "answer": "$$\\boxed{2.000 \\times 10^{-1}}$$", "id": "2624050"}, {"introduction": "The transition from a fully functional to a fully embolized xylem is not instantaneous but occurs progressively as xylem pressure becomes more negative. This relationship is captured by a vulnerability curve, a cornerstone of plant hydraulic research. This hands-on data analysis task [@problem_id:2624104] requires you to fit a standard logistic model to experimental data, a fundamental skill for quantifying xylem safety. You will estimate key parameters like the $P_{50}$ (the pressure causing $50\\%$ loss of conductivity) and their uncertainty, translating raw measurements into meaningful physiological traits.", "problem": "You are modeling the vulnerability of xylem hydraulic conductivity to cavitation in plants. The Percent Loss of Conductivity (PLC) is defined as the fractional reduction in hydraulic conductivity relative to a maximum, expressed in percent. A common phenomenological representation of xylem vulnerability is a logistic curve that relates PLC to xylem pressure (water potential), motivated by the cohesion–tension framework in which increasingly negative pressure increases cavitation probability. Assume independent, identically distributed Gaussian measurement errors on PLC at each measured pressure. You are to estimate model parameters and their uncertainties by maximum likelihood from provided pressure–PLC data.\n\nFundamental base:\n- Under the cohesion–tension concept, xylem sap is under negative pressure and cavitation reduces conductivity. The vulnerability curve is empirically well captured by a sigmoidal function of pressure. We adopt the two-parameter logistic form\n$$\n\\mathrm{PLC}(P;a,P_{50}) \\;=\\; \\frac{100}{1+\\exp\\!\\big(a\\,(P-P_{50})\\big)} \\, ,\n$$\nwhere $P$ is pressure (water potential), $a$ is a positive slope parameter, and $P_{50}$ is the pressure at which $\\mathrm{PLC}=50$. Pressures $P$ and $P_{50}$ must be expressed in megapascals (MPa), $a$ must be expressed in $\\mathrm{MPa}^{-1}$, and $\\mathrm{PLC}$ is a percentage in the range $[0,100]$.\n- Measurement model: for observed data $\\{(P_i,y_i)\\}_{i=1}^n$, assume $y_i = \\mathrm{PLC}(P_i;a,P_{50}) + \\varepsilon_i$ with $\\varepsilon_i \\overset{\\text{i.i.d.}}{\\sim} \\mathcal{N}(0,\\sigma^2)$, where $\\sigma$ is an unknown standard deviation in PLC percentage points.\n\nEstimation task:\n- Use maximum likelihood to estimate $\\hat{a}$, $\\widehat{P}_{50}$, and $\\hat{\\sigma}$. Under the Gaussian error model, the maximum likelihood estimates of $a$ and $P_{50}$ coincide with the nonlinear least-squares minimizers of the sum of squared residuals, and the maximum likelihood estimate of $\\sigma^2$ is $\\widehat{\\sigma}^2 = \\mathrm{SSR}/n$, where $\\mathrm{SSR}=\\sum_{i=1}^n \\big(y_i-\\mathrm{PLC}(P_i;\\hat{a},\\widehat{P}_{50})\\big)^2$.\n- Estimate the parameter uncertainty (standard errors) using the observed Fisher information for the Gaussian model, which yields the covariance matrix\n$$\n\\widehat{\\mathrm{Cov}}(\\hat{\\theta}) \\;=\\; \\widehat{\\sigma}^2 \\, \\big(J^\\top J\\big)^{-1} \\, ,\n$$\nwhere $\\theta=(a,P_{50})^\\top$ and $J$ is the $n\\times 2$ Jacobian matrix with entries $J_{i,1}=\\frac{\\partial \\mathrm{PLC}(P_i;a,P_{50})}{\\partial a}$ and $J_{i,2}=\\frac{\\partial \\mathrm{PLC}(P_i;a,P_{50})}{\\partial P_{50}}$ evaluated at $(\\hat{a},\\widehat{P}_{50})$. Report standard errors as the square roots of the diagonal entries of $\\widehat{\\mathrm{Cov}}(\\hat{\\theta})$.\n\nAnalytical derivatives required for constructing $J$:\n- Let $E_i = \\exp\\!\\big(a\\,(P_i-P_{50})\\big)$ and $D_i = \\big(1+E_i\\big)^2$. Then\n$$\n\\frac{\\partial \\mathrm{PLC}(P_i;a,P_{50})}{\\partial a} \\;=\\; -\\,100 \\,\\frac{(P_i-P_{50})\\,E_i}{D_i} \\, , \\qquad\n\\frac{\\partial \\mathrm{PLC}(P_i;a,P_{50})}{\\partial P_{50}} \\;=\\; 100 \\,\\frac{a\\,E_i}{D_i} \\, .\n$$\n\nData and units:\n- Use the following test suite of datasets. In all cases, $P$ and $P_{50}$ are in $\\mathrm{MPa}$ and $a$ is in $\\mathrm{MPa}^{-1}$. The observed $\\mathrm{PLC}$ values are in percentage points. Each dataset is a list of pairs $\\big(P_i,y_i\\big)$.\n\n- Test case $1$ (typical vulnerability):\n  - $P = [-0.5,\\,-1.0,\\,-1.5,\\,-2.0,\\,-2.5,\\,-3.0,\\,-3.5]$\n  - $\\mathrm{PLC}_{\\text{obs}} = [8.5,\\,17.1,\\,30.2,\\,50.7,\\,69.4,\\,82.3,\\,91.2]$\n\n- Test case $2$ (shallow slope):\n  - $P = [-0.2,\\,-1.0,\\,-2.0,\\,-3.0,\\,-4.0,\\,-5.0,\\,-6.0]$\n  - $\\mathrm{PLC}_{\\text{obs}} = [16.1,\\,22.6,\\,35.7,\\,49.2,\\,65.0,\\,77.6,\\,86.4]$\n\n- Test case $3$ (steep slope near $P_{50}$):\n  - $P = [-0.5,\\,-1.0,\\,-1.2,\\,-1.5,\\,-1.8,\\,-2.0,\\,-2.5]$\n  - $\\mathrm{PLC}_{\\text{obs}} = [2.2,\\,11.4,\\,24.6,\\,49.1,\\,77.3,\\,88.6,\\,97.8]$\n\nComputational and output requirements:\n- Implement maximum likelihood estimation for each dataset under the Gaussian error model as specified above. Use a numerically stable nonlinear least-squares routine with reasonable bounds enforcing $a>0$.\n- For each test case, compute and report the list $[\\hat{a},\\,\\widehat{P}_{50},\\,\\mathrm{SE}(\\hat{a}),\\,\\mathrm{SE}(\\widehat{P}_{50}),\\,\\hat{\\sigma}]$, where $\\mathrm{SE}(\\cdot)$ are standard errors derived from $\\widehat{\\mathrm{Cov}}(\\hat{\\theta})$ and $\\hat{\\sigma}$ is the maximum likelihood estimate in PLC percentage points.\n- Round all reported floats to $3$ decimals. Interpret $a$ in $\\mathrm{MPa}^{-1}$, $P_{50}$ in $\\mathrm{MPa}$, and $\\hat{\\sigma}$ in PLC percentage points.\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated Python-style list of lists, for example: $[[x_{11},x_{12},x_{13},x_{14},x_{15}],[x_{21},x_{22},x_{23},x_{24},x_{25}],[x_{31},x_{32},x_{33},x_{34},x_{35}]]$, where each $x_{ij}$ is a float rounded to $3$ decimals as specified above.", "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded, well-posed, objective, and provides all necessary information for a unique solution. The task is a standard problem in statistical modeling and data analysis, specifically non-linear regression, applied to a well-established phenomenological model in plant physiology.\n\nThe objective is to estimate the parameters of a logistic model for xylem vulnerability to cavitation-induced hydraulic failure. The Percent Loss of Conductivity, $\\mathrm{PLC}$, is modeled as a function of xylem pressure $P$ (in $\\mathrm{MPa}$) using the following equation:\n$$\n\\mathrm{PLC}(P; a, P_{50}) = \\frac{100}{1 + \\exp\\big(a(P - P_{50})\\big)}\n$$\nHere, $a$ is a slope parameter (in $\\mathrm{MPa}^{-1}$) that quantifies the vulnerability to a pressure change, and $P_{50}$ is the pressure at which $50\\%$ of conductivity is lost. We are given observational data sets $\\{(P_i, y_i)\\}_{i=1}^n$, where $y_i$ are the measured $\\mathrm{PLC}$ values.\n\nThe statistical model assumes that the observations $y_i$ are the true model values corrupted by independent and identically distributed Gaussian noise:\n$$\ny_i = \\mathrm{PLC}(P_i; a, P_{50}) + \\varepsilon_i, \\quad \\text{where} \\quad \\varepsilon_i \\overset{\\text{i.i.d.}}{\\sim} \\mathcal{N}(0, \\sigma^2)\n$$\nUnder this assumption, the maximum likelihood estimation (MLE) of the parameters $(a, P_{50})$ is equivalent to minimizing the Sum of Squared Residuals (SSR):\n$$\n\\mathrm{SSR}(a, P_{50}) = \\sum_{i=1}^n \\big(y_i - \\mathrm{PLC}(P_i; a, P_{50})\\big)^2\n$$\nThis is a non-linear least-squares (NLLS) problem. The MLE for the variance of the error, $\\sigma^2$, is given by $\\hat{\\sigma}^2 = \\mathrm{SSR}(\\hat{a}, \\widehat{P}_{50})/n$, where $(\\hat{a}, \\widehat{P}_{50})$ are the NLLS estimates and $n$ is the number of data points.\n\nThe uncertainty of the parameter estimates $(\\hat{a}, \\widehat{P}_{50})$ is characterized by their standard errors. These are derived from the estimated covariance matrix, which, based on the theory of maximum likelihood, is the inverse of the observed Fisher information matrix. For the specified Gaussian model, this simplifies to:\n$$\n\\widehat{\\mathrm{Cov}}(\\hat{\\theta}) = \\hat{\\sigma}^2 (J^\\top J)^{-1}\n$$\nwhere $\\hat{\\theta} = (\\hat{a}, \\widehat{P}_{50})^\\top$, and $J$ is the $n \\times 2$ Jacobian matrix of the model function with respect to the parameters, evaluated at the MLEs. The entries of the Jacobian matrix are given by the partial derivatives:\n$$\nJ_{i,1} = \\frac{\\partial \\mathrm{PLC}(P_i; a, P_{50})}{\\partial a} \\quad \\text{and} \\quad J_{i,2} = \\frac{\\partial \\mathrm{PLC}(P_i; a, P_{50})}{\\partial P_{50}}\n$$\nThe problem provides the analytical form of these derivatives, which are essential for a stable and accurate computation of the Jacobian:\n$$\n\\frac{\\partial \\mathrm{PLC}}{\\partial a} = -100 \\frac{(P_i-P_{50})E_i}{(1+E_i)^2}, \\quad \\frac{\\partial \\mathrm{PLC}}{\\partial P_{50}} = 100 \\frac{a E_i}{(1+E_i)^2}\n$$\nwhere $E_i = \\exp(a(P_i - P_{50}))$. The standard errors, $\\mathrm{SE}(\\hat{a})$ and $\\mathrm{SE}(\\widehat{P}_{50})$, are the square roots of the diagonal elements of the covariance matrix $\\widehat{\\mathrm{Cov}}(\\hat{\\theta})$.\n\nThe solution is implemented in Python using the `scipy.optimize.least_squares` function, which is designed for such NLLS problems. The implementation proceeds as follows for each dataset:\n1.  **Initial Guess Generation**: A robust initial guess for the parameters is crucial for the convergence of the NLLS algorithm. We estimate an initial $P_{50}$ by finding the pressure $P_i$ in the dataset for which the observed $\\mathrm{PLC}$ value $y_i$ is closest to $50$. The initial slope parameter $a$ is then estimated from the local slope of the data around this point, using the relationship $a \\approx -(\\Delta y / \\Delta P) / 25$ evaluated at $P=P_{50}$.\n2.  **Non-Linear Least-Squares Optimization**: `least_squares` is called to find the parameter values $(\\hat{a}, \\widehat{P}_{50})$ that minimize the sum of squared residuals. The function is supplied with the analytical Jacobian to improve performance and accuracy. A lower bound of $a > 0$ is enforced as required by the model's physical interpretation.\n3.  **Estimation of $\\sigma$**: After obtaining the optimal parameters, the sum of squared residuals $\\mathrm{SSR}$ is calculated. The MLE of $\\sigma$ is then computed as $\\hat{\\sigma} = \\sqrt{\\mathrm{SSR}/n}$.\n4.  **Uncertainty Quantification**: The Jacobian matrix $J$ at the solution is provided by the `least_squares` routine. The covariance matrix is calculated using the formula $\\widehat{\\mathrm{Cov}}(\\hat{\\theta}) = \\hat{\\sigma}^2 (J^\\top J)^{-1}$. The standard errors are then extracted as the square roots of the diagonal entries of this matrix.\n5.  **Result Aggregation**: The computed estimates $[\\hat{a}, \\widehat{P}_{50}, \\mathrm{SE}(\\hat{a}), \\mathrm{SE}(\\widehat{P}_{50}), \\hat{\\sigma}]$ are rounded to three decimal places and collected for final output.\n\nThis procedure is applied systematically to all three provided test cases, yielding the required parameter estimates and their uncertainties.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Performs Maximum Likelihood Estimation for xylem vulnerability curve parameters.\n    The problem is solved by non-linear least squares, as it is equivalent to MLE\n    for a model with additive Gaussian errors.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Test case 1 (typical vulnerability)\",\n            \"P\": np.array([-0.5, -1.0, -1.5, -2.0, -2.5, -3.0, -3.5]),\n            \"PLC_obs\": np.array([8.5, 17.1, 30.2, 50.7, 69.4, 82.3, 91.2])\n        },\n        {\n            \"name\": \"Test case 2 (shallow slope)\",\n            \"P\": np.array([-0.2, -1.0, -2.0, -3.0, -4.0, -5.0, -6.0]),\n            \"PLC_obs\": np.array([16.1, 22.6, 35.7, 49.2, 65.0, 77.6, 86.4])\n        },\n        {\n            \"name\": \"Test case 3 (steep slope near P50)\",\n            \"P\": np.array([-0.5, -1.0, -1.2, -1.5, -1.8, -2.0, -2.5]),\n            \"PLC_obs\": np.array([2.2, 11.4, 24.6, 49.1, 77.3, 88.6, 97.8])\n        }\n    ]\n\n    all_results = []\n\n    # Model function for Percent Loss of Conductivity (PLC)\n    def plc_model(params, P):\n        a, P50 = params\n        return 100.0 / (1.0 + np.exp(a * (P - P50)))\n\n    # Function to compute the vector of residuals\n    def residuals(params, P, y):\n        return plc_model(params, P) - y\n\n    # Function to compute the Jacobian matrix of the model function\n    def jacobian(params, P, y):\n        a, P50 = params\n        E = np.exp(a * (P - P50))\n        D = (1.0 + E)**2\n        \n        # Partial derivative with respect to 'a'\n        jac_a = -100.0 * (P - P50) * E / D\n        # Partial derivative with respect to 'P50'\n        jac_p50 = 100.0 * a * E / D\n        \n        # The jacobian of the residuals is the same as for the model\n        return np.array([jac_a, jac_p50]).T\n\n    for case in test_cases:\n        P_obs = case[\"P\"]\n        y_obs = case[\"PLC_obs\"]\n        n = len(P_obs)\n\n        # ---- Generate robust initial guesses for parameters ----\n        # Initial guess for P50: pressure where observed PLC is closest to 50\n        p50_idx = np.abs(y_obs - 50.0).argmin()\n        p50_0 = P_obs[p50_idx]\n        \n        # Initial guess for 'a' from the slope around P50\n        # a is related to the derivative at P50: d(PLC)/dP = -25*a\n        a_0 = 2.0  # Default reasonable guess\n        if 0 < p50_idx < n - 1:\n            # Use centered difference for slope\n            dy_dp = (y_obs[p50_idx + 1] - y_obs[p50_idx - 1]) / (P_obs[p50_idx + 1] - P_obs[p50_idx - 1])\n            # Ensure slope is negative, as expected\n            if dy_dp < 0:\n                a_0 = -dy_dp / 25.0\n        \n        if a_0 <= 0: # Fallback if calculation fails or gives non-positive result\n            a_0 = 2.0\n\n        initial_params = [a_0, p50_0]\n\n        # Define bounds for parameters: a > 0\n        bounds = ([1e-9, -np.inf], [np.inf, np.inf])\n\n        # ---- Perform non-linear least squares optimization ----\n        fit_result = least_squares(\n            residuals,\n            initial_params,\n            jac=jacobian,\n            bounds=bounds,\n            args=(P_obs, y_obs),\n            method='trf'\n        )\n        \n        a_hat, p50_hat = fit_result.x\n\n        # ---- Calculate parameter uncertainties ----\n        # Sum of Squared Residuals (SSR)\n        ssr = np.sum(fit_result.fun**2)\n        \n        # Maximum Likelihood Estimate for sigma\n        sigma_hat = np.sqrt(ssr / n)\n        \n        # Jacobian at the solution\n        J = fit_result.jac\n        \n        # Covariance matrix from observed Fisher Information\n        # Cov = sigma_hat^2 * (J^T J)^-1\n        try:\n            cov_matrix = (sigma_hat**2) * np.linalg.inv(J.T @ J)\n            se_a = np.sqrt(cov_matrix[0, 0])\n            se_p50 = np.sqrt(cov_matrix[1, 1])\n        except np.linalg.LinAlgError:\n            # Handle cases where Jacobian is singular\n            se_a, se_p50 = np.nan, np.nan\n        \n        # ---- Collect and format results ----\n        case_results = [a_hat, p50_hat, se_a, se_p50, sigma_hat]\n        rounded_results = [round(v, 3) for v in case_results]\n        all_results.append(rounded_results)\n\n    # Final print statement in the exact required format.\n    print(f\"{all_results}\")\n\nsolve()\n```", "id": "2624104"}]}