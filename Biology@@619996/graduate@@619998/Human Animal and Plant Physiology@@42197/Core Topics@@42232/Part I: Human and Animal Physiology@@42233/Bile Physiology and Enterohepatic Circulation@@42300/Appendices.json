{"hands_on_practices": [{"introduction": "The journey of a bile acid begins in the liver with its synthesis from cholesterol. This first exercise provides a practical starting point by connecting fundamental biochemistry to organ-level physiology [@problem_id:2550957]. By applying the principles of mass conservation and stoichiometry, you will translate a given rate of cholesterol input into the corresponding rate of bile acid synthesis, a crucial parameter for understanding the overall dynamics of enterohepatic circulation.", "problem": "A human subject is studied at steady state, where the liver receives a net hepatic cholesterol input of $1.0\\,\\mathrm{g\\,day^{-1}}$. Tracer flux analysis indicates a fractional conversion of incoming cholesterol to bile acids (BA) of $0.50$ by mass using an operational definition in which investigators quantify the daily mass of bile acid products attributable to the cholesterol input and report this as a fraction of the cholesterol mass flux. Assume this fractional conversion reflects the mass of bile acids synthesized per unit mass of incoming cholesterol and neglect small mass differences arising from hydroxylation and conjugation. The average molecular weight of the synthesized bile acids is $408\\,\\mathrm{g\\,mol^{-1}}$. Using conservation of mass and the definition of the mole, compute the synthesis rate of bile acids in $\\mathrm{mmol\\,day^{-1}}$. Round your final answer to three significant figures and express it in $\\mathrm{mmol\\,day^{-1}}$.", "solution": "The problem will first be subjected to rigorous validation to ascertain its scientific and logical integrity.\n\nHere are the givens extracted from the problem statement:\n1.  Net hepatic cholesterol input rate, $\\dot{m}_{chol} = 1.0\\,\\mathrm{g\\,day^{-1}}$.\n2.  Fractional conversion of cholesterol to bile acids (BA) by mass, $f_{conv} = 0.50$.\n3.  Assumption: Neglect mass differences from chemical modification (hydroxylation and conjugation). This is explicitly stated.\n4.  Average molecular weight of synthesized bile acids, $M_{BA} = 408\\,\\mathrm{g\\,mol^{-1}}$.\n5.  Required output: Synthesis rate of bile acids in $\\mathrm{mmol\\,day^{-1}}$, rounded to three significant figures.\n\nThe problem is evaluated against the validation criteria.\n- **Scientific Grounding**: The problem is anchored in the fundamental physiological process of bile acid synthesis from cholesterol in the liver, a core component of enterohepatic circulation. The provided numerical values—daily cholesterol flux, conversion fraction, and bile acid molecular weight—are physiologically plausible.\n- **Well-Posedness**: The problem provides all necessary data and a clear objective. The relationship between mass flux, mass fraction, molecular weight, and molar flux is well-defined.\n- **Objectivity**: The problem is stated in precise, quantitative terms, free from subjective or ambiguous language. The \"operational definition\" of fractional conversion and the explicit instruction to neglect mass changes from chemical reactions remove any ambiguity in the calculation.\n\nThe problem does not violate any fundamental principles, is not incomplete or contradictory, and is not trivial. It is a direct application of mass conservation and stoichiometric principles to a biological system. Therefore, the problem is deemed **valid**.\n\nThe solution proceeds as follows.\n\nLet $\\dot{m}_{chol}$ represent the mass rate of cholesterol input to the liver.\nLet $f_{conv}$ be the fractional conversion of cholesterol mass to bile acid mass.\nLet $\\dot{m}_{BA}$ be the mass synthesis rate of bile acids.\nLet $M_{BA}$ be the average molecular weight of the bile acids.\nLet $\\dot{n}_{BA}$ be the molar synthesis rate of bile acids.\n\nFrom the problem statement, we have:\n$\\dot{m}_{chol} = 1.0\\,\\mathrm{g\\,day^{-1}}$\n$f_{conv} = 0.50$\n$M_{BA} = 408\\,\\mathrm{g\\,mol^{-1}}$\n\nThe problem states that the fractional conversion $f_{conv}$ relates the mass of cholesterol input to the mass of bile acid product. The instruction to neglect mass changes due to chemical reactions allows us to apply this fraction directly. Thus, the mass synthesis rate of bile acids, $\\dot{m}_{BA}$, is the product of the cholesterol input rate and the conversion fraction:\n\n$$ \\dot{m}_{BA} = \\dot{m}_{chol} \\times f_{conv} $$\n\nSubstituting the given values:\n\n$$ \\dot{m}_{BA} = (1.0\\,\\mathrm{g\\,day^{-1}}) \\times 0.50 = 0.50\\,\\mathrm{g\\,day^{-1}} $$\n\nThe next step is to convert this mass synthesis rate into a molar synthesis rate, $\\dot{n}_{BA}$. The relationship between mass ($m$), number of moles ($n$), and molecular weight ($M$) is given by the fundamental definition of the mole: $n = \\frac{m}{M}$. Applying this to rates:\n\n$$ \\dot{n}_{BA} = \\frac{\\dot{m}_{BA}}{M_{BA}} $$\n\nSubstituting the calculated mass rate and the given molecular weight:\n\n$$ \\dot{n}_{BA} = \\frac{0.50\\,\\mathrm{g\\,day^{-1}}}{408\\,\\mathrm{g\\,mol^{-1}}} \\approx 0.00122549\\,\\mathrm{mol\\,day^{-1}} $$\n\nThe problem requires the answer in units of millimoles per day ($\\mathrm{mmol\\,day^{-1}}$). We use the conversion factor $1\\,\\mathrm{mol} = 1000\\,\\mathrm{mmol}$.\n\n$$ \\dot{n}_{BA} = 0.00122549\\,\\mathrm{mol\\,day^{-1}} \\times \\frac{1000\\,\\mathrm{mmol}}{1\\,\\mathrm{mol}} \\approx 1.22549\\,\\mathrm{mmol\\,day^{-1}} $$\n\nFinally, the problem requires the answer to be rounded to three significant figures.\n\n$$ \\dot{n}_{BA} \\approx 1.23\\,\\mathrm{mmol\\,day^{-1}} $$\n\nThis is the final calculated synthesis rate of bile acids.", "answer": "$$\\boxed{1.23}$$", "id": "2550957"}, {"introduction": "Moving beyond synthesis, we now consider the entire collection of bile acids in the body as a single, dynamic pool. This practice introduces the concept of a single-compartment kinetic model to quantify the overall efficiency of the enterohepatic circulation [@problem_id:2550858]. You will derive and calculate essential parameters like the fractional turnover rate ($k$) and mean residence time ($\\mathrm{MRT}$), which provide powerful insights into how effectively the body conserves its bile acid supply.", "problem": "A mammalian model is used to study bile acid enterohepatic circulation at steady state. The bile acid pool size, measured by isotope dilution, is $3$ mmol. Daily fecal bile acid excretion, which represents the only route of irreversible loss from the body, is $0.3$ mmol $\\mathrm{day}^{-1}$. Assume the following: (i) the system is at steady state so that synthesis equals irreversible loss, (ii) the bile acid pool behaves as a single well-mixed compartment with first-order loss kinetics, and (iii) gallbladder storage and postprandial cycling occur rapidly relative to the timescale of days, so that daily-averaged rates are appropriate.\n\nUsing only the fundamental steady-state mass balance and the definition that the fractional turnover rate is the fraction of the pool irreversibly lost per unit time, derive from first principles expressions for the fractional turnover rate $k$ and the mean residence time $\\mathrm{MRT}$ of bile acids in the body. Then compute their numerical values given the data above. Express $k$ in $\\mathrm{day}^{-1}$ and $\\mathrm{MRT}$ in days. Round both numbers to three significant figures.\n\nFinally, based on your computed $k$ and $\\mathrm{MRT}$, explain what these values imply about the efficiency of enterohepatic recycling in this scenario.\n\nReport your final numerical answers as two values in the order $k$, $\\mathrm{MRT}$.", "solution": "The problem is first validated and is found to be scientifically grounded, well-posed, and objective. The provided information is sufficient and consistent for a unique solution.\n\nWe begin by establishing a mathematical model based on the principles outlined in the problem statement. Let $P(t)$ represent the total amount of bile acid in the enterohepatic circulation at time $t$, with units of mmol. Let $S$ be the rate of synthesis of new bile acids by the liver, and $L$ be the rate of irreversible loss through fecal excretion. Both $S$ and $L$ have units of mmol $\\mathrm{day}^{-1}$.\n\nThe fundamental principle of mass balance states that the rate of change of the bile acid pool is equal to the rate of input minus the rate of output. This can be expressed as a differential equation:\n$$\n\\frac{dP(t)}{dt} = S - \\text{Loss Rate}\n$$\nThe problem states that the system exhibits first-order loss kinetics. This means the loss rate is directly proportional to the amount of substance present in the pool. We can write this as:\n$$\n\\text{Loss Rate} = k P(t)\n$$\nwhere $k$ is the first-order rate constant, known as the fractional turnover rate, with units of $\\mathrm{day}^{-1}$. Substituting this into the mass balance equation gives:\n$$\n\\frac{dP(t)}{dt} = S - k P(t)\n$$\nThe system is assumed to be at steady state. At steady state, the size of the bile acid pool is constant, which we denote as $P_0$. Therefore, the time derivative of the pool size is zero:\n$$\n\\frac{dP(t)}{dt} = 0\n$$\nApplying this condition to our differential equation yields:\n$$\n0 = S - k P_0 \\implies S = k P_0\n$$\nAnother condition of the steady state is that the rate of synthesis must equal the rate of irreversible loss:\n$$\nS = L\n$$\nBy combining these two steady-state relations, we obtain an expression for the total loss rate in terms of the pool size and the rate constant:\n$$\nL = k P_0\n$$\nFrom this, we can derive the expression for the fractional turnover rate, $k$, from first principles:\n$$\nk = \\frac{L}{P_0}\n$$\nThis result is consistent with the definition provided in the problem statement, which describes $k$ as the fraction of the pool ($P_0$) that is irreversibly lost ($L$) per unit time.\n\nNext, we derive the expression for the mean residence time, $\\mathrm{MRT}$. For a single-compartment system at steady state with first-order elimination, the $\\mathrm{MRT}$ is defined as the average time a molecule spends in the compartment before being eliminated. This can be calculated from fundamental principles as the ratio of the total amount of substance in the compartment at steady state to the rate of exit from the compartment.\n$$\n\\mathrm{MRT} = \\frac{\\text{Amount in compartment}}{\\text{Exit rate}} = \\frac{P_0}{L}\n$$\nUsing our previously derived relationship $k = L/P_0$, we can also express the $\\mathrm{MRT}$ as the reciprocal of the fractional turnover rate:\n$$\n\\mathrm{MRT} = \\frac{P_0}{L} = \\frac{P_0}{(k P_0)} = \\frac{1}{k}\n$$\n\nNow, we compute the numerical values using the given data:\n- Bile acid pool size, $P_0 = 3$ mmol.\n- Daily fecal bile acid excretion, $L = 0.3$ mmol $\\mathrm{day}^{-1}$.\n\nThe fractional turnover rate $k$ is:\n$$\nk = \\frac{L}{P_0} = \\frac{0.3 \\, \\mathrm{mmol} \\cdot \\mathrm{day}^{-1}}{3 \\, \\mathrm{mmol}} = 0.1 \\, \\mathrm{day}^{-1}\n$$\nRounding to three significant figures, we get $k = 0.100 \\, \\mathrm{day}^{-1}$.\n\nThe mean residence time $\\mathrm{MRT}$ is:\n$$\n\\mathrm{MRT} = \\frac{P_0}{L} = \\frac{3 \\, \\mathrm{mmol}}{0.3 \\, \\mathrm{mmol} \\cdot \\mathrm{day}^{-1}} = 10 \\, \\mathrm{days}\n$$\nRounding to three significant figures, we get $\\mathrm{MRT} = 10.0 \\, \\mathrm{days}$.\n\nFinally, we analyze the physiological implications of these values. A fractional turnover rate of $k = 0.100 \\, \\mathrm{day}^{-1}$ signifies that only $10\\%$ of the total bile acid pool is lost and needs to be replaced by de novo synthesis each day. Consequently, the remaining $90\\%$ of the bile acid pool that participates in daily turnover is conserved. The mean residence time of $\\mathrm{MRT} = 10.0 \\, \\mathrm{days}$ indicates that an average bile acid molecule is retained within the body for $10$ days before being excreted. Given that the bile acid pool may cycle multiple times per day (e.g., $4-12$ times), a long $\\mathrm{MRT}$ of $10.0$ days implies that each bile acid molecule undergoes numerous cycles of secretion into the intestine and subsequent reabsorption back to the liver. Together, a low fractional turnover rate and a long mean residence time are quantitative indicators of a highly efficient enterohepatic recycling mechanism. This conservation is crucial, as the synthesis of bile acids from cholesterol is a metabolically expensive process. The system is designed to minimize loss and maximize reuse.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.100 & 10.0\n\\end{pmatrix}\n}\n$$", "id": "2550858"}, {"introduction": "Our final practice takes a significant step from steady-state analysis to dynamic modeling, simulating the physiological events following a meal. This advanced exercise guides you in constructing a two-compartment model from first principles, representing the movement of bile acids between the intestine and the liver [@problem_id:2550912]. By setting up and solving a system of ordinary differential equations, you will gain hands-on experience in predicting how changes in transporter function dynamically alter bile acid concentrations in the portal vein.", "problem": "A physiologist proposes a minimal two-compartment representation of enterohepatic bile acid recirculation to study the effect of reducing Organic Solute Transporter alpha/beta (OSTα/β) function on portal venous bile acid concentration following a meal. The two compartments are the intestinal lumen and the liver, with first-order exchange of bile acids between them. The model should be derived from conservation of mass and the assumption of first-order processes for transport and clearance, without invoking any pre-derived bile acid kinetics formulas.\n\nBase assumptions to use:\n- Conservation of mass applies to each compartment, with inflows and outflows summed to give the time derivative of the compartmental amount.\n- Transport processes are first-order with respect to the source compartment amount.\n- The time course begins immediately after a meal, modeled as an instantaneous bolus of bile acids delivered to the intestinal lumen.\n- Portal venous concentration at any time is proportional to the instantaneous absorption flux from the intestinal lumen into the portal circulation divided by portal blood flow, assuming rapid mixing in the portal vein.\n\nDefine:\n- Intestinal luminal bile acid amount $A_{\\mathrm{int}}(t)$ in $\\mu\\mathrm{mol}$.\n- Hepatic (liver) bile acid amount $A_{\\mathrm{liv}}(t)$ in $\\mu\\mathrm{mol}$.\n- First-order absorption rate constant $k_{\\mathrm{abs}}$ in $\\mathrm{min}^{-1}$ for movement from the intestinal lumen toward the liver, representing the overall enterocyte trans-epithelial process that is limited by OSTα/β at the basolateral membrane.\n- First-order secretion rate constant $k_{\\mathrm{sec}}$ in $\\mathrm{min}^{-1}$ for movement from the liver back to the intestinal lumen (excretion into bile and delivery to the intestine).\n- First-order hepatic clearance rate constant $k_{\\mathrm{cl}}$ in $\\mathrm{min}^{-1}$ representing net removal of bile acids from the hepatic compartment to the systemic circulation or irreversible loss during the simulated window.\n- Portal venous volumetric blood flow $Q_{\\mathrm{port}}$ in $\\mathrm{L}\\,\\mathrm{min}^{-1}$.\n- Initial conditions at $t=0$ minutes: $A_{\\mathrm{int}}(0)=M_{\\mathrm{meal}}$ and $A_{\\mathrm{liv}}(0)=0$, where $M_{\\mathrm{meal}}$ is the bile acid bolus delivered to the lumen in $\\mu\\mathrm{mol}$.\n- The instantaneous portal concentration is defined as $C_{\\mathrm{port}}(t)=J_{\\mathrm{abs}}(t)/Q_{\\mathrm{port}}$ in $\\mu\\mathrm{mol}\\,\\mathrm{L}^{-1}$, where $J_{\\mathrm{abs}}(t)$ is the absorption flux from the intestinal lumen to the portal circulation.\n- A fractional reduction factor $r$ with $0<r\\le 1$ scales $k_{\\mathrm{abs}}$ to model reduced OSTα/β activity, such that the reduced-activity absorption constant is $k_{\\mathrm{abs,red}}=r\\,k_{\\mathrm{abs}}$. For a fifty percent reduction, $r=0.5$.\n\nTasks:\n1. From conservation of mass and first-order kinetics, write the system of ordinary differential equations for $A_{\\mathrm{int}}(t)$ and $A_{\\mathrm{liv}}(t)$ and the expression for the absorption flux $J_{\\mathrm{abs}}(t)$.\n2. Using the derived system, simulate the time courses for both baseline ($r=1$) and reduced OSTα/β ($r=0.5$), starting at $t=0$ minutes and ending at $t=T_{\\mathrm{end}}$ minutes, for each parameter set in the test suite below. Use the same initial conditions for both scenarios for a given test case.\n3. For each test case, compute the peak (maximum over time) portal venous concentration $C_{\\mathrm{port}}(t)$ for the baseline and reduced scenarios. Report, for each test case, the ratio $\\rho=\\max_t C_{\\mathrm{port,red}}(t)\\,/\\,\\max_t C_{\\mathrm{port,base}}(t)$ as a unitless decimal.\n4. Numerical requirements:\n   - Use minutes for time, $\\mu\\mathrm{mol}$ for amounts, and $\\mathrm{L}\\,\\mathrm{min}^{-1}$ for flows. The output ratios are unitless.\n   - Simulate on a uniform or adaptive time grid dense enough to resolve peaks accurately over the interval $[0,\\,T_{\\mathrm{end}}]$ minutes.\n   - Round each reported ratio to $6$ decimal places.\n\nTest suite (each case is a tuple $\\left(M_{\\mathrm{meal}},k_{\\mathrm{abs}},k_{\\mathrm{sec}},k_{\\mathrm{cl}},Q_{\\mathrm{port}},T_{\\mathrm{end}},r\\right)$):\n- Case $1$: $\\left(3000,\\,0.25,\\,0.08,\\,0.03,\\,1.2,\\,240,\\,0.5\\right)$\n- Case $2$: $\\left(3000,\\,1.0,\\,0.02,\\,0.05,\\,1.2,\\,120,\\,0.5\\right)$\n- Case $3$ (no recirculation boundary): $\\left(3000,\\,0.4,\\,0.0,\\,0.1,\\,1.2,\\,120,\\,0.5\\right)$\n- Case $4$ (high recirculation): $\\left(3000,\\,0.15,\\,0.2,\\,0.02,\\,1.2,\\,300,\\,0.5\\right)$\n- Case $5$ (lower portal flow): $\\left(3000,\\,0.25,\\,0.08,\\,0.03,\\,0.6,\\,240,\\,0.5\\right)$\n\nYour program must:\n- Implement the derived model for both baseline and reduced cases for each parameter set.\n- Compute the ratio $\\rho$ for each case, rounded to $6$ decimal places.\n- Produce a single line of output containing the ratios as a comma-separated list enclosed in square brackets, in the order of the test suite, for example $[0.500000,0.492000,\\dots]$.", "solution": "The problem statement has been rigorously validated and found to be scientifically grounded, well-posed, and objective. It presents a standard compartmental modeling task in physiology, free of contradictions or ambiguities. We proceed with the derivation and solution.\n\nThe core of the problem is to construct and analyze a two-compartment model for enterohepatic circulation of bile acids based on the principle of conservation of mass and first-order kinetics.\n\n**1. Derivation of the Mathematical Model**\n\nWe are given two compartments: the intestinal lumen, with bile acid amount $A_{\\mathrm{int}}(t)$, and the liver, with bile acid amount $A_{\\mathrm{liv}}(t)$. The dynamics are governed by a system of linear first-order ordinary differential equations (ODEs).\n\nThe rate of change of the amount of substance in a compartment is the sum of all influx rates minus the sum of all efflux rates.\n\nFor the intestinal lumen compartment, $A_{\\mathrm{int}}(t)$:\n- **Influx:** Secretion from the liver. This is a first-order process with respect to the hepatic amount $A_{\\mathrm{liv}}(t)$, with rate constant $k_{\\mathrm{sec}}$. The flux is $+k_{\\mathrm{sec}} A_{\\mathrm{liv}}(t)$.\n- **Efflux:** Absorption into the portal circulation, directed towards the liver. This is a first-order process with respect to the intestinal amount $A_{\\mathrm{int}}(t)$, with rate constant $k_{\\mathrm{abs}}$. The flux is $-k_{\\mathrm{abs}} A_{\\mathrm{int}}(t)$.\n\nThe conservation of mass equation for the intestinal compartment is therefore:\n$$\n\\frac{d A_{\\mathrm{int}}(t)}{dt} = k_{\\mathrm{sec}} A_{\\mathrm{liv}}(t) - k_{\\mathrm{abs}} A_{\\mathrm{int}}(t)\n$$\n\nFor the hepatic compartment, $A_{\\mathrm{liv}}(t)$:\n- **Influx:** Absorption from the intestinal lumen. The flux is $+k_{\\mathrm{abs}} A_{\\mathrm{int}}(t)$.\n- **Efflux 1:** Secretion back to the intestinal lumen. The flux is $-k_{\\mathrm{sec}} A_{\\mathrm{liv}}(t)$.\n- **Efflux 2:** Hepatic clearance (e.g., to systemic circulation). This is a first-order process with respect to the hepatic amount $A_{\\mathrm{liv}}(t)$, with rate constant $k_{\\mathrm{cl}}$. The flux is $-k_{\\mathrm{cl}} A_{\\mathrm{liv}}(t)$.\n\nThe conservation of mass equation for the hepatic compartment is:\n$$\n\\frac{d A_{\\mathrm{liv}}(t)}{dt} = k_{\\mathrm{abs}} A_{\\mathrm{int}}(t) - k_{\\mathrm{sec}} A_{\\mathrm{liv}}(t) - k_{\\mathrm{cl}} A_{\\mathrm{liv}}(t) = k_{\\mathrm{abs}} A_{\\mathrm{int}}(t) - (k_{\\mathrm{sec}} + k_{\\mathrm{cl}}) A_{\\mathrm{liv}}(t)\n$$\n\nThis constitutes the system of ODEs. In matrix form, with state vector $\\mathbf{A}(t) = \\begin{pmatrix} A_{\\mathrm{int}}(t) \\\\ A_{\\mathrm{liv}}(t) \\end{pmatrix}$:\n$$\n\\frac{d\\mathbf{A}(t)}{dt} = \\begin{pmatrix} -k_{\\mathrm{abs}} & k_{\\mathrm{sec}} \\\\ k_{\\mathrm{abs}} & -(k_{\\mathrm{sec}} + k_{\\mathrm{cl}}) \\end{pmatrix} \\mathbf{A}(t)\n$$\nThe initial conditions at time $t=0$ are given as an instantaneous bolus $M_{\\mathrm{meal}}$ in the intestine and zero bile acids in the liver:\n$$\n\\mathbf{A}(0) = \\begin{pmatrix} A_{\\mathrm{int}}(0) \\\\ A_{\\mathrm{liv}}(0) \\end{pmatrix} = \\begin{pmatrix} M_{\\mathrm{meal}} \\\\ 0 \\end{pmatrix}\n$$\nThe problem defines the absorption flux, $J_{\\mathrm{abs}}(t)$, as the rate of movement from the intestinal lumen to the portal circulation. Based on our model construction, this is:\n$$\nJ_{\\mathrm{abs}}(t) = k_{\\mathrm{abs}} A_{\\mathrm{int}}(t)\n$$\nThe portal venous concentration, $C_{\\mathrm{port}}(t)$, is this flux divided by the portal blood flow, $Q_{\\mathrm{port}}$:\n$$\nC_{\\mathrm{port}}(t) = \\frac{J_{\\mathrm{abs}}(t)}{Q_{\\mathrm{port}}} = \\frac{k_{\\mathrm{abs}} A_{\\mathrm{int}}(t)}{Q_{\\mathrm{port}}}\n$$\nThis completes the formal derivation of the model as required by the first task.\n\n**2. Method of Solution**\n\nThe objective is to compute the ratio $\\rho = \\max_t C_{\\mathrm{port,red}}(t) / \\max_t C_{\\mathrm{port,base}}(t)$. This requires simulating the system for two scenarios for each test case:\n1.  **Baseline Scenario:** Using the given absorption rate constant $k_{\\mathrm{abs}}$.\n2.  **Reduced Scenario:** Using a reduced absorption rate constant $k_{\\mathrm{abs,red}} = r \\cdot k_{\\mathrm{abs}}$.\n\nFor each scenario, the procedure is as follows:\n1.  Define the system of ODEs with the appropriate value for the absorption rate constant ($k_{\\mathrm{abs}}$ for baseline, $k_{\\mathrm{abs,red}}$ for reduced). All other parameters ($M_{\\mathrm{meal}}, k_{\\mathrm{sec}}, k_{\\mathrm{cl}}, Q_{\\mathrm{port}}$) remain the same.\n2.  Solve the initial value problem numerically over the time interval $[0, T_{\\mathrm{end}}]$. High-quality numerical integrators, such as those provided by the `scipy.integrate` library, are suitable. We specify a dense output to allow for accurate peak finding.\n3.  From the numerical solution for $A_{\\mathrm{int}}(t)$, calculate the corresponding portal concentration time course, $C_{\\mathrm{port}}(t)$. Note that the leading $k_{\\mathrm{abs}}$ factor in the expression for $C_{\\mathrm{port}}(t)$ must also be either $k_{\\mathrm{abs}}$ or $k_{\\mathrm{abs,red}}$, consistent with the scenario being simulated.\n4.  Determine the maximum value of $C_{\\mathrm{port}}(t)$ over the simulation interval $[0, T_{\\mathrm{end}}]$. This is achieved by evaluating the solution on a sufficiently fine time grid.\n5.  After obtaining the peak concentrations for both baseline ($\\max_t C_{\\mathrm{port,base}}$) and reduced ($\\max_t C_{\\mathrm{port,red}}$) scenarios, calculate their ratio $\\rho$.\n6.  The final ratio is rounded to $6$ decimal places as specified.\n\nThis procedure is systematically applied to each parameter set provided in the test suite. The implementation will be encapsulated in a program that automates these steps.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the bile acid recirculation problem for a suite of test cases.\n    \"\"\"\n\n    # Test suite: (M_meal, k_abs, k_sec, k_cl, Q_port, T_end, r)\n    test_cases = [\n        (3000.0, 0.25, 0.08, 0.03, 1.2, 240.0, 0.5),\n        (3000.0, 1.0, 0.02, 0.05, 1.2, 120.0, 0.5),\n        (3000.0, 0.4, 0.0, 0.1, 1.2, 120.0, 0.5),\n        (3000.0, 0.15, 0.2, 0.02, 1.2, 300.0, 0.5),\n        (3000.0, 0.25, 0.08, 0.03, 0.6, 240.0, 0.5)\n    ]\n\n    results = []\n\n    def run_simulation(M_meal, k_abs, k_sec, k_cl, Q_port, T_end):\n        \"\"\"\n        Simulates the two-compartment model and returns the peak portal concentration.\n\n        Args:\n            M_meal (float): Initial bile acid bolus in the lumen (umol).\n            k_abs (float): Absorption rate constant (min^-1).\n            k_sec (float): Secretion rate constant (min^-1).\n            k_cl (float): Hepatic clearance rate constant (min^-1).\n            Q_port (float): Portal venous blood flow (L/min).\n            T_end (float): End time of the simulation (min).\n\n        Returns:\n            float: The peak portal venous bile acid concentration (umol/L).\n        \"\"\"\n        \n        # System of ODEs for the compartment model\n        def ode_system(t, y, k_abs_val, k_sec_val, k_cl_val):\n            A_int, A_liv = y\n            dA_int_dt = -k_abs_val * A_int + k_sec_val * A_liv\n            dA_liv_dt = k_abs_val * A_int - (k_sec_val + k_cl_val) * A_liv\n            return [dA_int_dt, dA_liv_dt]\n\n        # Initial conditions\n        y0 = [M_meal, 0.0]\n        # Time span for the integration\n        t_span = [0.0, T_end]\n\n        # Solve the ODE system with high accuracy\n        sol = solve_ivp(\n            ode_system, \n            t_span, \n            y0, \n            args=(k_abs, k_sec, k_cl),\n            dense_output=True,\n            rtol=1e-9,  # Relative tolerance\n            atol=1e-9   # Absolute tolerance\n        )\n        \n        # In the special case of no recirculation (k_sec=0), the peak is at t=0.\n        # Otherwise, evaluate on a fine grid to find the peak accurately.\n        # Analytically, the peak of C_port occurs when its derivative is zero.\n        # This simplifies to dA_int/dt = 0 when k_sec != 0.\n        # For k_sec=0, A_int(t) is purely exponential decay, so max is at t=0.\n        if k_sec == 0.0:\n            t_eval = np.array([0.0])\n            y_eval = sol.sol(t_eval)\n        else:\n             # Evaluate the solution on a fine time grid to find the peak concentration\n            t_eval = np.linspace(t_span[0], t_span[1], 2000)\n            y_eval = sol.sol(t_eval)\n            \n        A_int_t = y_eval[0, :]\n        \n        # Calculate portal concentration time course\n        # C_port(t) = (k_abs * A_int(t)) / Q_port\n        C_port_t = (k_abs * A_int_t) / Q_port\n        \n        # Find and return the peak concentration\n        return np.max(C_port_t)\n\n    for case in test_cases:\n        M_meal, k_abs_base, k_sec, k_cl, Q_port, T_end, r = case\n        \n        # Reduced absorption rate constant\n        k_abs_red = r * k_abs_base\n\n        # Run baseline simulation\n        peak_conc_base = run_simulation(M_meal, k_abs_base, k_sec, k_cl, Q_port, T_end)\n        \n        # Run reduced OSTalpha/beta function simulation\n        peak_conc_red = run_simulation(M_meal, k_abs_red, k_sec, k_cl, Q_port, T_end)\n        \n        # Calculate the ratio rho\n        # Handle division by zero case, though not expected with these parameters\n        if peak_conc_base == 0:\n            rho = 0.0 if peak_conc_red == 0 else float('inf')\n        else:\n            rho = peak_conc_red / peak_conc_base\n            \n        results.append(rho)\n        \n    # Format results to 6 decimal places and create the output string\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2550912"}]}