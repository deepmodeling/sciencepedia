{"hands_on_practices": [{"introduction": "A cornerstone of electrocardiogram (ECG) interpretation is the ability to quantify the heart's mean electrical orientation in the frontal plane. This practice focuses on calculating the Mean Electrical Axis (MEA) from the net deflections in leads I and aVF. Mastering this calculation provides a foundational understanding of how the two-dimensional projections of the heart's three-dimensional electrical activity are captured and used for diagnosis, such as identifying abnormal ventricular depolarization pathways [@problem_id:2615350].", "problem": "A standard 12-lead electrocardiogram (electrocardiogram (ECG)) is recorded at paper speed $25\\,\\mathrm{mm\\,s^{-1}}$ and calibration $10\\,\\mathrm{mm\\,mV^{-1}}$. In the frontal plane, you extract net QRS deflections (algebraic R amplitude minus the sum of the absolute Q and S amplitudes) from the limb leads as follows:\n\n- Lead I: peak amplitudes relative to the isoelectric baseline are $Q = 1.0\\,\\mathrm{mm}$ below baseline, $R = 11.0\\,\\mathrm{mm}$ above baseline, and $S = 2.0\\,\\mathrm{mm}$ below baseline.\n- Lead aVF (augmented voltage foot): peak amplitudes relative to the isoelectric baseline are $Q = 0.0\\,\\mathrm{mm}$, $R = 3.0\\,\\mathrm{mm}$ above baseline, and $S = 10.0\\,\\mathrm{mm}$ below baseline.\n\nTreat the mean frontal-plane QRS electrical axis (mean electrical axis (MEA)) as a fixed vector during the QRS interval whose projections onto the lead axes generate the measured net QRS deflections. Assume equal gain and linear response across leads so that relative amplitudes are preserved between leads I and aVF. Use the conventional hexaxial reference in which lead I is aligned with $0^\\circ$ and lead aVF with $+90^\\circ$, with angles increasing counterclockwise.\n\nTasks:\n1. Compute the MEA in the frontal plane in degrees by inferring the vector orientation from the measured net deflections in lead I and lead aVF. State the sign (positive or negative) of the angle according to the stated convention.\n2. Using commonly accepted thresholds, classify the axis as one of: normal (between $-30^\\circ$ and $+90^\\circ$), left axis deviation (between $-30^\\circ$ and $-90^\\circ$), or right axis deviation (between $+90^\\circ$ and $+180^\\circ$). If the angle falls outside these ranges, note it as extreme axis deviation.\n\nExpress the MEA in degrees. Round your numerical angle to four significant figures. For grading, report only the MEA angle as your final numeric answer.", "solution": "The problem requires the calculation and classification of the mean frontal-plane QRS electrical axis (MEA) from electrocardiogram (ECG) data.\n\nFirst, we must validate the problem statement.\nThe givens are:\n- Paper speed: $25\\,\\mathrm{mm\\,s^{-1}}$\n- Calibration: $10\\,\\mathrm{mm\\,mV^{-1}}$\n- Lead I deflections: $Q = 1.0\\,\\mathrm{mm}$, $R = 11.0\\,\\mathrm{mm}$, $S = 2.0\\,\\mathrm{mm}$\n- Lead aVF deflections: $Q = 0.0\\,\\mathrm{mm}$, $R = 3.0\\,\\mathrm{mm}$, $S = 10.0\\,\\mathrm{mm}$\n- Definition of net QRS deflection: Algebraic R-wave amplitude minus the sum of the absolute Q-wave and S-wave amplitudes.\n- Coordinate system: Lead I axis at $0^\\circ$, Lead aVF axis at $+90^\\circ$.\n- Task: Compute MEA in degrees and classify it.\n- Precision: Round final angle to four significant figures.\n\nThe problem is scientifically grounded, as it describes the standard vectorcardiographic approach to determining the heart's electrical axis. The provided values are physiologically plausible. The problem is well-posed, self-contained, and provides all necessary information to compute a unique solution for the angle. The information on paper speed and calibration, while not required for calculating the angle (which depends only on the ratio of deflections), does not create a contradiction and is standard contextual data for an ECG recording. Therefore, the problem is deemed valid.\n\nWe proceed to the solution.\n\nStep 1: Calculate the net QRS deflection for each lead. The net deflection, let us denote it by $V_{net}$, is given by the formula based on the amplitudes of the $Q$, $R$, and $S$ waves:\n$$V_{net} = R_{amp} - (|Q_{amp}| + |S_{amp}|)$$\nThe amplitudes are given in millimeters ($mm$).\n\nFor Lead I:\nThe amplitudes are $R_I = 11.0\\,\\mathrm{mm}$, $Q_I = 1.0\\,\\mathrm{mm}$, and $S_I = 2.0\\,\\mathrm{mm}$.\nThe net deflection in Lead I, $V_I$, is:\n$$V_I = 11.0 - (1.0 + 2.0) = 11.0 - 3.0 = 8.0\\,\\mathrm{mm}$$\n\nFor Lead aVF:\nThe amplitudes are $R_{aVF} = 3.0\\,\\mathrm{mm}$, $Q_{aVF} = 0.0\\,\\mathrm{mm}$, and $S_{aVF} = 10.0\\,\\mathrm{mm}$.\nThe net deflection in Lead aVF, $V_{aVF}$, is:\n$$V_{aVF} = 3.0 - (0.0 + 10.0) = 3.0 - 10.0 = -7.0\\,\\mathrm{mm}$$\n\nStep 2: Determine the components of the MEA vector.\nThe problem states that the MEA can be treated as a vector whose projections onto the lead axes correspond to the net deflections. The conventional hexaxial reference system places the Lead I axis at $0^\\circ$ and the Lead aVF axis at $+90^\\circ$. This configuration establishes a standard two-dimensional Cartesian coordinate system where the x-component of the MEA vector is the net deflection in Lead I, and the y-component is the net deflection in Lead aVF.\nLet the MEA vector be $\\vec{M}$ with components $(M_x, M_y)$.\n$$M_x = V_I = 8.0$$\n$$M_y = V_{aVF} = -7.0$$\nThe components are unitless in this context as we are only concerned with their ratio to find the angle. The units of millimeters cancel out.\n\nStep 3: Calculate the angle of the MEA vector.\nThe angle $\\theta$ of a vector with components $(M_x, M_y)$ is found using the arctangent function. The angle is measured counterclockwise from the positive x-axis (the Lead I axis).\n$$\\theta = \\arctan\\left(\\frac{M_y}{M_x}\\right)$$\nSubstituting the component values:\n$$\\theta = \\arctan\\left(\\frac{-7.0}{8.0}\\right) = \\arctan(-0.875)$$\nThe calculation must be performed in degrees:\n$$\\theta \\approx -41.185925...^\\circ$$\nThe problem requires rounding to four significant figures.\n$$\\theta \\approx -41.19^\\circ$$\nThe vector has a positive x-component and a negative y-component, placing it in the fourth quadrant, which is consistent with the negative angle calculated.\n\nStep 4: Classify the calculated axis.\nThe clinically accepted ranges for axis classification are provided:\n- Normal axis: $-30^\\circ \\le \\theta \\le +90^\\circ$\n- Left axis deviation (LAD): $-90^\\circ \\le \\theta < -30^\\circ$\n- Right axis deviation (RAD): $+90^\\circ < \\theta \\le +180^\\circ$\n- Extreme axis deviation: outside the above ranges (i.e., $-180^\\circ \\le \\theta < -90^\\circ$)\n\nThe calculated MEA is $\\theta \\approx -41.19^\\circ$. This value satisfies the condition $-90^\\circ \\le -41.19^\\circ < -30^\\circ$.\nTherefore, the electrical axis is classified as Left Axis Deviation (LAD).\n\nThe problem asks for only the numerical angle in degrees as the final answer.", "answer": "$$\\boxed{-41.19}$$", "id": "2615350"}, {"introduction": "Beyond pattern recognition, a true expert must understand the ECG from first principles. This exercise challenges you to analyze the consequences of a common technical error—a limb electrode swap—by deriving its effects from the fundamental definitions of the ECG leads. This practice is invaluable for developing robust problem-solving skills, as it demonstrates how to diagnose and troubleshoot measurement artifacts that can dangerously mimic or mask severe cardiac pathology [@problem_id:2615374].", "problem": "A three-electrode limb system records the frontal-plane electrocardiogram. Let the instantaneous potentials at the right arm, left arm, and left leg electrodes be denoted by $V_{R}(t)$, $V_{L}(t)$, and $V_{F}(t)$, respectively. The standard limb leads are defined by the potential differences $L_{I}(t) = V_{L}(t) - V_{R}(t)$, $L_{II}(t) = V_{F}(t) - V_{R}(t)$, and $L_{III}(t) = V_{F}(t) - V_{L}(t)$, and the augmented leads are defined using the Wilson central terminal $V_{W}(t) = \\left(V_{R}(t)+V_{L}(t)+V_{F}(t)\\right)/3$ by $aVR(t) = V_{R}(t) - V_{W}(t)$, $aVL(t) = V_{L}(t) - V_{W}(t)$, and $aVF(t) = V_{F}(t) - V_{W}(t)$. Assume that the mean QRS vector in the frontal plane has constant magnitude $A > 0$ and true axis $\\theta$ (in degrees), measured with $0^{\\circ}$ along the positive direction of Lead $I$ and $+90^{\\circ}$ directed inferiorly. Under the usual linear vector model for the frontal plane, the projections of the mean QRS onto the three standard limb-lead axes are $L_{I} = A \\cos(\\theta)$, $L_{II} = A \\cos(\\theta - 60^{\\circ})$, and $L_{III} = A \\cos(\\theta - 120^{\\circ})$, consistent with Einthoven’s law.\nNow suppose that the right arm and left leg electrodes are accidentally interchanged at the skin (right arm electrode is placed on the left leg location and left leg electrode is placed on the right arm location), while the left arm electrode remains correctly placed. An interpreter, unaware of the swap, uses the measured $L_{I}$ and $aVF$ from this misconnected recording to infer the mean frontal QRS axis by the conventional Cartesian method that treats the $L_{I}$ and $aVF$ measurements as proportional to the horizontal and vertical components of the mean QRS vector, respectively, and determines the axis as the corresponding polar angle.\nUsing only the core definitions above and the assumption that the Wilson central terminal is the average of the three limb potentials, first derive the algebraic effect of the right arm–left leg swap on the measured limb and augmented leads in terms of the true $L_{I}$ and $L_{II}$. Then, for a heart with true frontal-plane mean QRS axis $\\theta = 30^{\\circ}$ and arbitrary $A>0$, compute the single numerical value of the apparent mean frontal QRS axis (in degrees) that the interpreter would report from the misconnected $L_{I}$ and $aVF$. Use the conventional principal value in the interval $[-180^{\\circ}, 180^{\\circ})$. Express your final answer in degrees. \nIn your derivation, identify the major diagnostic pitfalls that could arise from this specific electrode swap when interpreting rhythm and axis from the misconnected tracing. The final answer must be the single angle value only.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It describes a physically realistic scenario of electrode misplacement in electrocardiography and provides all necessary formal definitions to derive a unique solution. The problem is valid.\n\nThe core of the problem is to determine the quantitative effect of an electrode swap on the measured electrocardiogram (ECG) leads and the resulting misinterpretation of the cardiac axis. Let the true, physiological potentials at the right arm, left arm, and left leg be $V_{R}$, $V_{L}$, and $V_{F}$, respectively. The problem statement indicates a swap of the right arm (RA) and left leg (LL) electrodes. This means the potential measured by the ECG machine at its RA input terminal is actually $V_{F}$, and the potential at its LL input terminal is actually $V_{R}$. The left arm (LA) electrode is correctly placed.\n\nLet the measured potentials at the machine's input terminals be denoted by a prime:\n$V'_{R} = V_{F}$\n$V'_{L} = V_{L}$\n$V'_{F} = V_{R}$\n\nThe machine calculates the standard and augmented leads based on these swapped input potentials. We derive the expressions for these measured leads (denoted with a prime) in terms of the true leads.\n\nThe true standard limb leads are defined as:\n$L_{I} = V_{L} - V_{R}$\n$L_{II} = V_{F} - V_{R}$\n$L_{III} = V_{F} - V_{L}$\nFrom these definitions, Einthoven's Law, $L_{I} + L_{III} = L_{II}$, follows directly. We can express $L_{III}$ as $L_{III} = L_{II} - L_{I}$.\n\nThe measured standard leads are:\n$L'_{I} = V'_{L} - V'_{R} = V_{L} - V_{F} = -(V_{F} - V_{L}) = -L_{III}$.\nUsing Einthoven's Law, this becomes $L'_{I} = -(L_{II} - L_{I}) = L_{I} - L_{II}$.\n$L'_{II} = V'_{F} - V'_{R} = V_{R} - V_{F} = -(V_{F} - V_{R}) = -L_{II}$.\n$L'_{III} = V'_{F} - V'_{L} = V_{R} - V_{L} = -(V_{L} - V_{R}) = -L_{I}$.\n\nNext, we derive the expressions for the measured augmented leads. First, we examine the Wilson central terminal, defined as $V_{W} = \\frac{1}{3}(V_{R} + V_{L} + V_{F})$. The machine calculates a measured central terminal $V'_{W}$:\n$V'_{W} = \\frac{1}{3}(V'_{R} + V'_{L} + V'_{F}) = \\frac{1}{3}(V_{F} + V_{L} + V_{R}) = V_{W}$.\nThe Wilson central terminal is invariant under any permutation of the limb potentials.\n\nThe true augmented leads are:\n$aVR = V_{R} - V_{W}$\n$aVL = V_{L} - V_{W}$\n$aVF = V_{F} - V_{W}$\n\nThe measured augmented leads are:\n$aVR' = V'_{R} - V'_{W} = V_{F} - V_{W} = aVF$.\n$aVL' = V'_{L} - V'_{W} = V_{L} - V_{W} = aVL$.\n$aVF' = V'_{F} - V'_{W} = V_{R} - V_{W} = aVR$.\nThis swap of the RA and LL electrodes results in the measured leads $aVR'$ and $aVF'$ being swapped versions of the true $aVF$ and $aVR$, while $aVL$ is unaffected.\n\nThe problem states that an interpreter, unaware of the swap, uses the measured $L'_{I}$ and $aVF'$ to determine the mean QRS axis. The interpreter treats $L'_{I}$ as the horizontal component ($x$-axis) and $aVF'$ as the vertical component ($y$-axis) of the cardiac vector. To compute the apparent axis, we must express $L'_{I}$ and $aVF'$ in terms of the true fundamental leads $L_{I}$ and $L_{II}$.\n\nWe already have $L'_{I} = L_{I} - L_{II}$.\nFor $aVF'$, we have $aVF' = aVR$. We must express the true $aVR$ in terms of $L_I$ and $L_{II}$ using the provided definition of $V_W$.\n$aVR = V_{R} - V_{W} = V_{R} - \\frac{1}{3}(V_{R} + V_{L} + V_{F})$\nTo express $V_{L}$ and $V_{F}$ in terms of $L_{I}$, $L_{II}$, and $V_R$, we use:\n$V_{L} = L_{I} + V_{R}$\n$V_{F} = L_{II} + V_{R}$\nSubstituting these into the expression for $aVR$:\n$aVR = V_{R} - \\frac{1}{3}(V_{R} + (L_{I} + V_{R}) + (L_{II} + V_{R}))$\n$aVR = V_{R} - \\frac{1}{3}(3V_{R} + L_{I} + L_{II}) = V_{R} - V_{R} - \\frac{1}{3}(L_{I} + L_{II})$\n$aVR = -\\frac{1}{3}(L_{I} + L_{II})$\n\nSo, the vector components used by the interpreter are proportional to:\nHorizontal component: $x \\propto L'_{I} = L_{I} - L_{II}$\nVertical component: $y \\propto aVF' = aVR = -\\frac{1}{3}(L_{I} + L_{II})$\n\nNow, we compute these values for a true mean QRS axis $\\theta = 30^{\\circ}$. The projections onto the standard limb lead axes are given by:\n$L_{I} = A \\cos(\\theta) = A \\cos(30^{\\circ}) = A \\frac{\\sqrt{3}}{2}$\n$L_{II} = A \\cos(\\theta - 60^{\\circ}) = A \\cos(30^{\\circ} - 60^{\\circ}) = A \\cos(-30^{\\circ}) = A \\frac{\\sqrt{3}}{2}$\n\nSubstituting these into our expressions for the measured components:\n$x \\propto L'_{I} = A \\frac{\\sqrt{3}}{2} - A \\frac{\\sqrt{3}}{2} = 0$\n$y \\propto aVF' = -\\frac{1}{3}\\left(A \\frac{\\sqrt{3}}{2} + A \\frac{\\sqrt{3}}{2}\\right) = -\\frac{1}{3}(A\\sqrt{3}) = -A\\frac{\\sqrt{3}}{3}$\n\nThe interpreter determines the apparent axis $\\theta_{app}$ as the polar angle corresponding to the vector $(x, y)$. The vector has a horizontal component of $0$ and a vertical component that is negative (since $A>0$). In the standard frontal plane ECG axis system, the horizontal axis corresponds to lead I ($0^{\\circ}$) and the vertical axis corresponds to lead aVF ($+90^{\\circ}$ is directed inferiorly). A positive value on the $aVF$ axis corresponds to a downward direction. Our calculated vertical component $y$ is negative, which means the vector component points upward. A vector with a zero horizontal component and an upward vertical component points directly along the negative aVF axis. The direction of the negative aVF axis is $+90^{\\circ} - 180^{\\circ} = -90^{\\circ}$.\n\nThus, the apparent mean frontal QRS axis is $-90^{\\circ}$.\n\nThe diagnostic pitfalls arising from this error are severe. A true normal axis of $+30^{\\circ}$ is misinterpreted as an extreme axis deviation of $-90^{\\circ}$. More dangerously, this specific swap can mimic a completed inferior myocardial infarction. A normal heart with a $+30^{\\circ}$ axis has positive QRS complexes in leads II, III, and aVF. From our derivation, the measured leads are $L'_{II} = -L_{II}$, $L'_{III} = -L_{I}$, and $aVF' = aVR$. For a normal axis, true $L_I$ and $L_{II}$ are positive, and true $aVR$ is negative. Therefore, the interpreter sees negative QRS complexes in the leads labeled 'II', 'III', and 'aVF'. This pattern is the classic signature for inferior infarction. Furthermore, the true $aVF$ is positive, but it is recorded in the 'aVR' channel ($aVR' = aVF$). An upright P-wave and QRS complex in the lead labeled 'aVR' is a highly specific clue for this electrode reversal (or dextrocardia), and its presence should immediately trigger a check of electrode placement. Ignoring this clue leads to profound diagnostic error.", "answer": "$$\\boxed{-90}$$", "id": "2615374"}, {"introduction": "This advanced practice moves from deterministic calculation to the realm of probabilistic clinical reasoning, tackling one of the most critical challenges in electrocardiography: the differential diagnosis of wide complex tachycardia. You will construct a diagnostic classifier for distinguishing Ventricular Tachycardia (VT) from Supraventricular Tachycardia (SVT) with aberrancy using a Bayesian framework. This exercise builds skill in synthesizing multiple diagnostic criteria using likelihood ratios to arrive at a quantitative, evidence-based posterior probability, reflecting the sophisticated thinking required in modern clinical electrophysiology [@problem_id:2615327].", "problem": "You are to design and implement a principled binary classifier that differentiates Supraventricular Tachycardia with aberrancy (SVT) from Ventricular Tachycardia (VT) on the surface Electrocardiogram (ECG), using Likelihood Ratios (LRs) for a set of diagnostically relevant criteria. The classifier must be justified from first principles using Bayes' theorem in odds form and the assumption of conditional independence of criteria given the diagnosis. The program must compute the posterior probability of VT and then apply a probability threshold to provide a decision rule.\n\nFundamental base to be used:\n- Bayes' theorem in odds form: if $H$ is the hypothesis of Ventricular Tachycardia (VT) and $E$ is the observed evidence, then the posterior odds satisfy\n$$\n\\text{odds}(H \\mid E) = \\text{odds}(H) \\times \\prod_{i=1}^{n} \\text{LR}_{i},\n$$\nwhere $\\text{odds}(H) = \\dfrac{P(H)}{1 - P(H)}$, and $\\text{LR}_{i}$ is the likelihood ratio for the $i$-th criterion. Posterior probability is recovered from odds by\n$$\nP(H \\mid E) = \\dfrac{\\text{odds}(H \\mid E)}{1 + \\text{odds}(H \\mid E)}.\n$$\n- Likelihood ratio definition: for a binary criterion, $\\text{LR}_{+} = \\dfrac{\\text{Sensitivity}}{1-\\text{Specificity}}$ when the feature is present, and $\\text{LR}_{-} = \\dfrac{1-\\text{Sensitivity}}{\\text{Specificity}}$ when the feature is absent. In this task, you will use provided $\\text{LR}_{+}$ and $\\text{LR}_{-}$ values that are plausible and consistent with the clinical literature.\n\nAssumptions and design constraints:\n- Use the naive conditional independence assumption for the criteria given the true rhythm (SVT versus VT).\n- Treat the following criteria as binary features with quantified likelihood ratios. For each criterion, use $\\text{LR}_{+}$ if present and $\\text{LR}_{-}$ if absent:\n  - Atrioventricular dissociation present: $\\text{LR}_{+} = 20.0$, $\\text{LR}_{-} = 0.7$.\n  - Capture or fusion beats present: $\\text{LR}_{+} = 15.0$, $\\text{LR}_{-} = 0.85$.\n  - Precordial QRS concordance present: $\\text{LR}_{+} = 18.0$, $\\text{LR}_{-} = 0.9$.\n  - Initial R wave in lead aVR present: $\\text{LR}_{+} = 13.0$, $\\text{LR}_{-} = 0.8$.\n  - Extreme frontal plane axis (between $-180$ and $-90$ degrees inclusive) present: $\\text{LR}_{+} = 9.0$, $\\text{LR}_{-} = 0.6$. Angles must be interpreted in degrees.\n  - Very wide QRS duration (at least $160$ milliseconds) present: $\\text{LR}_{+} = 4.0$, $\\text{LR}_{-} = 0.8$. Durations must be interpreted in milliseconds.\n  - History of structural heart disease present: $\\text{LR}_{+} = 2.5$, $\\text{LR}_{-} = 0.7$.\n- Prior probability of VT, $P(\\text{VT})$, is provided per case as a decimal between $0$ and $1$ (exclusive).\n- Classification rule: classify as VT if $P(\\text{VT} \\mid \\text{evidence}) \\ge 0.5$; otherwise classify as SVT with aberrancy. This threshold corresponds to posterior odds at least $1$.\n\nFeature extraction rules to be implemented:\n- The extreme axis feature is present if the frontal plane axis $\\theta$ satisfies $\\theta \\in [-180,-90]$ degrees; otherwise the feature is absent. Angles are in degrees.\n- The very wide QRS feature is present if the QRS duration $d$ satisfies $d \\ge 160$ milliseconds; otherwise the feature is absent.\n\nComputational requirements:\n- Implement the odds update multiplicatively using the provided likelihood ratios. For numerical stability, it is acceptable to perform computations in the log-odds domain by summing $\\log(\\text{LR}_{i})$ and then mapping back via the logistic transform $P = 1/(1 + e^{-\\log\\text{odds}})$.\n- For each test case, compute the posterior probability $P(\\text{VT} \\mid \\text{evidence})$ and round to three decimal places for reporting.\n\nTest suite:\nEach test case is a tuple with the following ordered fields:\n$(P(\\text{VT}), \\text{QRS duration in ms}, \\text{axis in degrees}, \\text{AV dissociation}, \\text{capture/fusion}, \\text{precordial concordance}, \\text{initial R in aVR}, \\text{structural heart disease})$ where the last five entries are booleans.\n\nProvide results for the following cases in the order listed:\n- Case A: $(0.5, 180, -120, \\text{True}, \\text{False}, \\text{True}, \\text{True}, \\text{True})$.\n- Case B: $(0.5, 130, 30, \\text{False}, \\text{False}, \\text{False}, \\text{False}, \\text{False})$.\n- Case C: $(0.2, 170, -100, \\text{False}, \\text{False}, \\text{False}, \\text{True}, \\text{True})$.\n- Case D: $(0.8, 140, -60, \\text{False}, \\text{False}, \\text{False}, \\text{False}, \\text{True})$.\n- Case E: $(0.5, 160, -90, \\text{False}, \\text{False}, \\text{False}, \\text{False}, \\text{False})$.\n- Case F: $(0.01, 180, -150, \\text{True}, \\text{True}, \\text{False}, \\text{True}, \\text{False})$.\n\nRequired final output format:\n- Your program should produce a single line of output containing a comma-separated list enclosed in square brackets, where each element is the posterior probability of VT for the corresponding case, each rounded to three decimal places, in the order A through F. For example, the output should look like $[0.500,0.750,0.250, \\dots]$ with exactly three digits after the decimal point.", "solution": "The problem statement has been subjected to rigorous validation and is found to be valid. It is scientifically grounded in the principles of Bayesian inference and its application to medical diagnostics—specifically, electrocardiogram interpretation. The problem is well-posed, providing all necessary data, parameters, definitions, and a clear objective. There are no contradictions, ambiguities, or factual inaccuracies. The task is to implement a Naive Bayes classifier to distinguish Ventricular Tachycardia (VT) from Supraventricular Tachycardia (SVT) with aberrancy based on a set of predefined electrocardiographic and clinical criteria.\n\nThe theoretical foundation of the classifier is Bayes' theorem, expressed in odds form. Let $H$ be the hypothesis that the rhythm is VT. Let $E$ represent the collected evidence, which consists of a set of $n$ findings or criteria, $E = \\{e_1, e_2, \\dots, e_n\\}$. The posterior odds of VT given the evidence is related to the prior odds by the product of the likelihood ratios for each piece of evidence:\n$$\n\\text{odds}(H \\mid E) = \\text{odds}(H) \\times \\prod_{i=1}^{n} \\text{LR}(e_i)\n$$\nThis formulation relies on the crucial assumption that the criteria $e_i$ are conditionally independent given the true diagnosis $H$. The prior odds are calculated from the prior probability $P(H)$, which is the estimated prevalence of VT in the relevant patient population, given as $\\text{odds}(H) = \\frac{P(H)}{1 - P(H)}$.\n\nEach criterion $e_i$ is a binary feature, being either present or absent. The likelihood ratio, $\\text{LR}(e_i)$, takes one of two values: $\\text{LR}_{i,+}$ if the $i$-th feature is present, or $\\text{LR}_{i,-}$ if it is absent. The values for $\\text{LR}_{i,+}$ and $\\text{LR}_{i,-}$ for each of the $n=7$ criteria are provided and fixed:\n1.  Atrioventricular (AV) dissociation: $\\text{LR}_{+} = 20.0$, $\\text{LR}_{-} = 0.7$.\n2.  Capture or fusion beats: $\\text{LR}_{+} = 15.0$, $\\text{LR}_{-} = 0.85$.\n3.  Precordial QRS concordance: $\\text{LR}_{+} = 18.0$, $\\text{LR}_{-} = 0.9$.\n4.  Initial R wave in lead aVR: $\\text{LR}_{+} = 13.0$, $\\text{LR}_{-} = 0.8$.\n5.  Extreme frontal plane axis: $\\text{LR}_{+} = 9.0$, $\\text{LR}_{-} = 0.6$. This feature is present if the electrical axis $\\theta$ is in the range $[-180, -90]$ degrees.\n6.  Very wide QRS duration: $\\text{LR}_{+} = 4.0$, $\\text{LR}_{-} = 0.8$. This feature is present if the QRS duration $d \\ge 160$ milliseconds.\n7.  History of structural heart disease (SHD): $\\text{LR}_{+} = 2.5$, $\\text{LR}_{-} = 0.7$.\n\nOnce the posterior odds, $\\text{odds}(H \\mid E)$, are computed, they are converted back to a posterior probability using the logistic function:\n$$\nP(H \\mid E) = \\frac{\\text{odds}(H \\mid E)}{1 + \\text{odds}(H \\mid E)}\n$$\nFor numerical stability with very large or small odds, calculations may be performed in the log-odds domain, where multiplications become additions: $\\log(\\text{odds}_{\\text{posterior}}) = \\log(\\text{odds}_{\\text{prior}}) + \\sum_{i} \\log(\\text{LR}_i)$. The final probability is then recovered as $P(H \\mid E) = (1 + \\exp(-\\log(\\text{odds}_{\\text{posterior}})))^{-1}$. For the given parameters, standard floating-point arithmetic is sufficient.\n\nThe algorithm to be implemented for each test case is as follows:\n1.  Receive the input tuple, which includes the prior probability of VT, $P(\\text{VT})$, and the values for the seven diagnostic criteria.\n2.  Calculate the prior odds: $\\text{odds}_{\\text{prior}} = P(\\text{VT}) / (1 - P(\\text{VT}))$.\n3.  Initialize a total likelihood ratio multiplier, $L$, to $1.0$.\n4.  For each of the seven criteria, determine if the feature is present or absent based on the input data and the specified rules (for QRS duration and axis).\n5.  Multiply $L$ by the corresponding $\\text{LR}_{+}$ or $\\text{LR}_{-}$ for that criterion.\n6.  Calculate the posterior odds: $\\text{odds}_{\\text{posterior}} = \\text{odds}_{\\text{prior}} \\times L$.\n7.  Calculate the final posterior probability: $P(\\text{VT} \\mid E) = \\text{odds}_{\\text{posterior}} / (1 + \\text{odds}_{\\text{posterior}})$.\n8.  The result for each case is this probability, which must be reported rounded to three decimal places.\n\nAs an illustrative example, we compute the result for Case A:\n- Input: $(P(\\text{VT})=0.5, \\text{QRS}=180, \\text{axis}=-120, \\text{AV diss}=\\text{True}, \\text{cap/fus}=\\text{False}, \\text{concord}=\\text{True}, \\text{R in aVR}=\\text{True}, \\text{SHD}=\\text{True})$.\n- Prior odds: $\\text{odds}_{\\text{prior}} = 0.5 / (1-0.5) = 1.0$.\n- Feature evaluation and LR selection:\n    - QRS duration $180 \\ge 160$: present, $\\text{LR} = 4.0$.\n    - Axis $-120 \\in [-180, -90]$: present, $\\text{LR} = 9.0$.\n    - AV dissociation: present, $\\text{LR} = 20.0$.\n    - Capture/fusion: absent, $\\text{LR} = 0.85$.\n    - Precordial concordance: present, $\\text{LR} = 18.0$.\n    - Initial R in aVR: present, $\\text{LR} = 13.0$.\n    - Structural heart disease: present, $\\text{LR} = 2.5$.\n- Total LR product: $L = 4.0 \\times 9.0 \\times 20.0 \\times 0.85 \\times 18.0 \\times 13.0 \\times 2.5 = 358020$.\n- Posterior odds: $\\text{odds}_{\\text{posterior}} = 1.0 \\times 358020 = 358020$.\n- Posterior probability: $P(\\text{VT} \\mid E) = 358020 / (1 + 358020) \\approx 0.9999972...$.\n- Rounded to three decimal places, the result is $1.000$.\n\nThis procedure is repeated for all specified test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a Naive Bayes classifier to compute the posterior probability of\n    Ventricular Tachycardia (VT) based on ECG and clinical criteria.\n    \"\"\"\n\n    # Define Likelihood Ratios (LR+, LR-) for each criterion pointing towards VT.\n    likelihood_ratios = {\n        'av_dissociation': (20.0, 0.7),\n        'capture_fusion': (15.0, 0.85),\n        'precordial_concordance': (18.0, 0.9),\n        'initial_r_in_avr': (13.0, 0.8),\n        'extreme_axis': (9.0, 0.6),\n        'wide_qrs': (4.0, 0.8),\n        'structural_heart_disease': (2.5, 0.7)\n    }\n\n    # Define the test cases from the problem statement.\n    # Format: (P(VT), QRS_ms, axis_deg, AV_diss, cap/fus, concord, r_avr, shd)\n    test_cases = [\n        # Case A\n        (0.5, 180, -120, True, False, True, True, True),\n        # Case B\n        (0.5, 130, 30, False, False, False, False, False),\n        # Case C\n        (0.2, 170, -100, False, False, False, True, True),\n        # Case D\n        (0.8, 140, -60, False, False, False, False, True),\n        # Case E\n        (0.5, 160, -90, False, False, False, False, False),\n        # Case F\n        (0.01, 180, -150, True, True, False, True, False)\n    ]\n\n    results = []\n    for case in test_cases:\n        p_vt_prior, qrs_duration, axis, av_diss, cap_fus, concordance, r_avr, shd = case\n\n        # Step 1: Calculate prior odds of VT\n        # We must handle the edge case of P(VT)=1, although problem says exclusive of 0 and 1.\n        if p_vt_prior == 1.0:\n            prior_odds = np.inf\n        else:\n            prior_odds = p_vt_prior / (1.0 - p_vt_prior)\n\n        # Step 2: Calculate the total likelihood ratio product\n        total_lr = 1.0\n\n        # Very wide QRS (>= 160 ms)\n        lr_plus, lr_minus = likelihood_ratios['wide_qrs']\n        total_lr *= lr_plus if qrs_duration >= 160 else lr_minus\n\n        # Extreme frontal plane axis ([-180, -90] degrees)\n        lr_plus, lr_minus = likelihood_ratios['extreme_axis']\n        total_lr *= lr_plus if -180 = axis = -90 else lr_minus\n        \n        # Atrioventricular dissociation\n        lr_plus, lr_minus = likelihood_ratios['av_dissociation']\n        total_lr *= lr_plus if av_diss else lr_minus\n\n        # Capture or fusion beats\n        lr_plus, lr_minus = likelihood_ratios['capture_fusion']\n        total_lr *= lr_plus if cap_fus else lr_minus\n\n        # Precordial QRS concordance\n        lr_plus, lr_minus = likelihood_ratios['precordial_concordance']\n        total_lr *= lr_plus if concordance else lr_minus\n\n        # Initial R wave in lead aVR\n        lr_plus, lr_minus = likelihood_ratios['initial_r_in_avr']\n        total_lr *= lr_plus if r_avr else lr_minus\n\n        # History of structural heart disease\n        lr_plus, lr_minus = likelihood_ratios['structural_heart_disease']\n        total_lr *= lr_plus if shd else lr_minus\n\n        # Step 3: Calculate posterior odds\n        posterior_odds = prior_odds * total_lr\n\n        # Step 4: Convert posterior odds to posterior probability\n        if np.isinf(posterior_odds):\n            posterior_prob = 1.0\n        else:\n            posterior_prob = posterior_odds / (1.0 + posterior_odds)\n            \n        results.append(posterior_prob)\n\n    # Final print statement in the exact required format.\n    # Each probability is formatted to exactly three decimal places.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2615327"}]}