{"hands_on_practices": [{"introduction": "The defining characteristic of an action potential is its rapid rise and slower fall. This sequence is a direct consequence of the different kinetic properties of voltage-gated sodium and potassium channels. This exercise delves into the mathematical core of the Hodgkin-Huxley model to quantify these differences, asking you to calculate and compare the activation speeds and steady-state probabilities for $\\text{Na}^+$ and $\\text{K}^+$ channels at a key depolarized potential. [@problem_id:2622741]", "problem": "A classical description of voltage-gated sodium and potassium channel activation in excitable membranes models each activation gate as a two-state Markov process with a closed state and an open state. For a given membrane potential $V$, the voltage-dependent forward rate $\\alpha_{x}(V)$ governs transitions from the closed to the open state and the backward rate $\\beta_{x}(V)$ governs transitions from the open to the closed state, for $x \\in \\{m,n\\}$, where $m$ indexes the activation gate of the sodium channel and $n$ indexes the activation gate of the potassium channel. Starting from this two-state kinetics framework and using only fundamental definitions of steady state and relaxation dynamics for a homogeneous first-order process, derive the steady-state open probability $x_{\\infty}(V)$ and the relaxation time constant $\\tau_{x}(V)$ in terms of $\\alpha_{x}(V)$ and $\\beta_{x}(V)$. Then, using the empirically established Hodgkin–Huxley rate functions (valid at approximately $6.3\\,^{\\circ}\\mathrm{C}$) with $V$ in $\\mathrm{mV}$ and all rates in $\\mathrm{ms}^{-1}$,\n\n$$\n\\alpha_{m}(V) = 0.1\\,\\frac{V+40}{1-\\exp\\!\\left(-\\frac{V+40}{10}\\right)},\\quad\n\\beta_{m}(V) = 4\\,\\exp\\!\\left(-\\frac{V+65}{18}\\right),\n$$\n\n\n$$\n\\alpha_{n}(V) = 0.01\\,\\frac{V+55}{1-\\exp\\!\\left(-\\frac{V+55}{10}\\right)},\\quad\n\\beta_{n}(V) = 0.125\\,\\exp\\!\\left(-\\frac{V+65}{80}\\right),\n$$\n\nevaluate $m_{\\infty}(V)$, $\\tau_{m}(V)$, $n_{\\infty}(V)$, and $\\tau_{n}(V)$ at $V=-30\\,\\mathrm{mV}$, and interpret which gate is closer to its steady state and which gate relaxes faster at this voltage.\n\nFor your final reportable quantity, compute the dimensionless ratio\n\n$$\nr=\\frac{\\tau_{n}(V)}{\\tau_{m}(V)}\n$$\n\nat $V=-30\\,\\mathrm{mV}$. Round your final answer for $r$ to four significant figures and express it as a pure number without units.", "solution": "The problem statement undergoes validation.\n\nStep 1: Extract Givens\n- A voltage-gated ion channel activation gate is modeled as a two-state Markov process with a closed state and an open state.\n- The forward rate constant (closed to open) is $\\alpha_{x}(V)$.\n- The backward rate constant (open to closed) is $\\beta_{x}(V)$.\n- The index $x \\in \\{m,n\\}$, where $m$ denotes the sodium channel activation gate and $n$ denotes the potassium channel activation gate.\n- The system kinetics are described by a homogeneous first-order process.\n- The tasks are:\n    1.  Derive the steady-state open probability $x_{\\infty}(V)$ and the relaxation time constant $\\tau_{x}(V)$ in terms of $\\alpha_{x}(V)$ and $\\beta_{x}(V)$.\n    2.  Use the empirically established Hodgkin–Huxley rate functions at $6.3\\,^{\\circ}\\mathrm{C}$:\n        $$\n        \\alpha_{m}(V) = 0.1\\,\\frac{V+40}{1-\\exp\\!\\left(-\\frac{V+40}{10}\\right)},\\quad\n        \\beta_{m}(V) = 4\\,\\exp\\!\\left(-\\frac{V+65}{18}\\right)\n        $$\n        $$\n        \\alpha_{n}(V) = 0.01\\,\\frac{V+55}{1-\\exp\\!\\left(-\\frac{V+55}{10}\\right)},\\quad\n        \\beta_{n}(V) = 0.125\\,\\exp\\!\\left(-\\frac{V+65}{80}\\right)\n        $$\n        where $V$ is in $\\mathrm{mV}$ and rates are in $\\mathrm{ms}^{-1}$.\n    3.  Evaluate $m_{\\infty}(V)$, $\\tau_{m}(V)$, $n_{\\infty}(V)$, and $\\tau_{n}(V)$ at $V=-30\\,\\mathrm{mV}$.\n    4.  Interpret which gate is closer to its steady state and which gate relaxes faster at this voltage.\n    5.  Compute the dimensionless ratio $r=\\frac{\\tau_{n}(V)}{\\tau_{m}(V)}$ at $V=-30\\,\\mathrm{mV}$, rounded to four significant figures.\n\nStep 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on the Nobel Prize-winning Hodgkin–Huxley model, a foundational concept in neurophysiology and biophysics. The mathematical framework of first-order kinetics and the specific rate equations are standard and factually correct.\n- **Well-Posed:** The problem provides all necessary information and equations to perform the required derivations and calculations. It requests a unique numerical answer that is stable with respect to the inputs.\n- **Objective:** The language is technical and precise, free from subjectivity or bias.\n- **Completeness and Consistency:** The problem is self-contained. The provided equations and constants are consistent with the literature. The voltage value $V=-30\\,\\mathrm{mV}$ does not cause any singularities in the rate functions.\n- **Other Flaws:** The problem does not violate any other validation criteria. It is a standard, solvable problem in quantitative biology.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\nThe first step is to derive the general expressions for the steady-state open probability, $x_{\\infty}(V)$, and the relaxation time constant, $\\tau_{x}(V)$. Let $x(t)$ be the probability of a gate being in the open state at time $t$. The probability of it being in the closed state is then $1-x(t)$. The rate of change of the open probability, $\\frac{dx}{dt}$, is given by the rate of gates opening from the closed state minus the rate of gates closing from the open state.\nThis is expressed by the following linear first-order ordinary differential equation:\n$$\n\\frac{dx}{dt} = \\alpha_{x}(V) (1-x) - \\beta_{x}(V) x\n$$\nThis equation describes the relaxation of the variable $x$ to its steady-state value for a given constant membrane potential $V$.\n\nTo find the steady-state open probability, $x_{\\infty}(V)$, we set the system at equilibrium, which means $\\frac{dx}{dt} = 0$:\n$$\n\\alpha_{x}(V) (1-x_{\\infty}) - \\beta_{x}(V) x_{\\infty} = 0\n$$\n$$\n\\alpha_{x}(V) - \\alpha_{x}(V) x_{\\infty} - \\beta_{x}(V) x_{\\infty} = 0\n$$\n$$\n\\alpha_{x}(V) = (\\alpha_{x}(V) + \\beta_{x}(V)) x_{\\infty}\n$$\nSolving for $x_{\\infty}$ yields:\n$$\nx_{\\infty}(V) = \\frac{\\alpha_{x}(V)}{\\alpha_{x}(V) + \\beta_{x}(V)}\n$$\n\nTo find the relaxation time constant, $\\tau_{x}(V)$, we rearrange the original differential equation into the standard form for relaxation dynamics, $\\frac{dy}{dt} = -\\frac{y - y_{\\infty}}{\\tau}$.\n$$\n\\frac{dx}{dt} = \\alpha_{x}(V) - (\\alpha_{x}(V) + \\beta_{x}(V))x\n$$\n$$\n\\frac{dx}{dt} = -(\\alpha_{x}(V) + \\beta_{x}(V)) \\left( x - \\frac{\\alpha_{x}(V)}{\\alpha_{x}(V) + \\beta_{x}(V)} \\right)\n$$\nRecognizing that the term in the parentheses is $x - x_{\\infty}(V)$, we have:\n$$\n\\frac{dx}{dt} = -\\frac{x - x_{\\infty}(V)}{\\frac{1}{\\alpha_{x}(V) + \\beta_{x}(V)}}\n$$\nBy comparing this with the standard form, we identify the time constant $\\tau_{x}(V)$ as:\n$$\n\\tau_{x}(V) = \\frac{1}{\\alpha_{x}(V) + \\beta_{x}(V)}\n$$\nThese are the required general expressions.\n\nNext, we evaluate these quantities for the sodium ($m$) and potassium ($n$) gates at the specified membrane potential, $V = -30\\,\\mathrm{mV}$.\nFirst, calculate the rate constants at $V = -30\\,\\mathrm{mV}$.\n\nFor the sodium activation gate ($m$):\n$$\n\\alpha_{m}(-30) = 0.1 \\cdot \\frac{-30+40}{1-\\exp\\left(-\\frac{-30+40}{10}\\right)} = \\frac{1}{1-\\exp(-1)} \\approx 1.581977\\,\\mathrm{ms}^{-1}\n$$\n$$\n\\beta_{m}(-30) = 4 \\cdot \\exp\\left(-\\frac{-30+65}{18}\\right) = 4 \\cdot \\exp\\left(-\\frac{35}{18}\\right) \\approx 0.572361\\,\\mathrm{ms}^{-1}\n$$\nNow, we can compute $m_{\\infty}(-30)$ and $\\tau_{m}(-30)$:\n$$\nm_{\\infty}(-30) = \\frac{\\alpha_{m}(-30)}{\\alpha_{m}(-30) + \\beta_{m}(-30)} \\approx \\frac{1.581977}{1.581977 + 0.572361} \\approx \\frac{1.581977}{2.154338} \\approx 0.734321\n$$\n$$\n\\tau_{m}(-30) = \\frac{1}{\\alpha_{m}(-30) + \\beta_{m}(-30)} \\approx \\frac{1}{2.154338} \\approx 0.464182\\,\\mathrm{ms}\n$$\n\nFor the potassium activation gate ($n$):\n$$\n\\alpha_{n}(-30) = 0.01 \\cdot \\frac{-30+55}{1-\\exp\\left(-\\frac{-30+55}{10}\\right)} = \\frac{0.25}{1-\\exp(-2.5)} \\approx 0.272361\\,\\mathrm{ms}^{-1}\n$$\n$$\n\\beta_{n}(-30) = 0.125 \\cdot \\exp\\left(-\\frac{-30+65}{80}\\right) = 0.125 \\cdot \\exp\\left(-\\frac{35}{80}\\right) = 0.125 \\cdot \\exp(-0.4375) \\approx 0.080704\\,\\mathrm{ms}^{-1}\n$$\nNow, we compute $n_{\\infty}(-30)$ and $\\tau_{n}(-30)$:\n$$\nn_{\\infty}(-30) = \\frac{\\alpha_{n}(-30)}{\\alpha_{n}(-30) + \\beta_{n}(-30)} \\approx \\frac{0.272361}{0.272361 + 0.080704} \\approx \\frac{0.272361}{0.353065} \\approx 0.771428\n$$\n$$\n\\tau_{n}(-30) = \\frac{1}{\\alpha_{n}(-30) + \\beta_{n}(-30)} \\approx \\frac{1}{0.353065} \\approx 2.83235\\,\\mathrm{ms}\n$$\n\nInterpretation:\nThe relaxation time constant indicates how quickly the gate population reaches its new steady state after a voltage change. A smaller $\\tau$ signifies faster relaxation. Comparing $\\tau_{m}(-30) \\approx 0.46\\,\\mathrm{ms}$ and $\\tau_{n}(-30) \\approx 2.83\\,\\mathrm{ms}$, it is clear that $\\tau_{m} \\ll \\tau_{n}$. Therefore, the sodium activation gate ($m$) relaxes significantly faster than the potassium activation gate ($n$) at $V=-30\\,\\mathrm{mV}$. This is a crucial feature for the generation of an action potential, where rapid sodium channel activation is followed by slower potassium channel activation.\n\nThe question \"which gate is closer to its steady state\" is ill-posed if interpreted literally, as any system held at a constant voltage for sufficient time is, by definition, at its steady state. A more meaningful interpretation is to ask which gate population is more completely shifted towards the fully open (probability $1$) or fully closed (probability $0$) state. At $V=-30\\,\\mathrm{mV}$, $m_{\\infty} \\approx 0.73$ and $n_{\\infty} \\approx 0.77$. Both gates are substantially open. The potassium gate's open probability ($0.77$) is slightly closer to $1$ than the sodium gate's ($0.73$).\n\nFinally, we compute the required dimensionless ratio $r$:\n$$\nr = \\frac{\\tau_{n}(V)}{\\tau_{m}(V)} \\bigg|_{V=-30\\,\\mathrm{mV}} = \\frac{1 / (\\alpha_{n} + \\beta_{n})}{1 / (\\alpha_{m} + \\beta_{m})} = \\frac{\\alpha_{m}(-30) + \\beta_{m}(-30)}{\\alpha_{n}(-30) + \\beta_{n}(-30)}\n$$\nUsing the sums calculated previously:\n$$\nr \\approx \\frac{2.154338}{0.353065} \\approx 6.10186\n$$\nRounding to four significant figures, the ratio is $6.102$.\nThis confirms that the potassium activation gate is more than $6$ times slower to respond to voltage changes than the sodium activation gate at this potential.", "answer": "$$\\boxed{6.102}$$", "id": "2622741"}, {"introduction": "To validate models like the one explored above, electrophysiologists must experimentally isolate the currents produced by different channel populations. This practice places you in the role of an experimental designer, tasked with selecting the right pharmacological tools and concentrations to achieve clean current separation. By working through the quantitative effects of blockers like tetrodotoxin (TTX) and tetraethylammonium (TEA), you will develop an intuition for the practical art and science of voltage-clamp pharmacology. [@problem_id:2622800]", "problem": "You are designing voltage-clamp experiments to pharmacologically isolate fast inward sodium ion ($\\text{Na}^+$) currents and delayed outward potassium ion ($\\text{K}^+$) currents in a mammalian cortical neuron at room temperature. The base external solution contains cadmium ion ($\\text{Cd}^{2+}$) at $0.2\\,\\mathrm{mM}$ to suppress voltage-gated calcium ion channels, and all series resistance and leak corrections are handled equivalently across conditions. Assume the following channel composition and ligand-binding characteristics, and that binding follows a single-site occupancy model with Hill coefficient $n = 1$:\n- Sodium ion channels: a tetrodotoxin (TTX)-sensitive pool constituting $95\\%$ of the peak $\\text{Na}^+$ conductance with dissociation constant $K_d^{\\mathrm{TTX,\\,sens}} = 5\\,\\mathrm{nM}$, and a tetrodotoxin-resistant pool (e.g., Nav$1.5$-like) constituting $5\\%$ with $K_d^{\\mathrm{TTX,\\,res}} = 10\\,\\mu\\mathrm{M}$.\n- Potassium ion channels: three populations making up the total peak delayed $\\text{K}^+$ conductance under the depolarizing steps of interest: Kv$2.1$-like ($60\\%$) with tetraethylammonium (TEA) dissociation constant $K_d^{\\mathrm{TEA},\\,\\mathrm{Kv2.1}} = 3\\,\\mathrm{mM}$; Kv$1$-like ($25\\%$) with $K_d^{\\mathrm{TEA},\\,\\mathrm{Kv1}} = 0.3\\,\\mathrm{mM}$; large-conductance calcium-activated potassium (BK) channels ($15\\%$) with $K_d^{\\mathrm{TEA},\\,\\mathrm{BK}} = 0.2\\,\\mathrm{mM}$. Assume BK activation under your voltage steps is sufficient to contribute this fraction in the absence of block.\n- Off-target actions: within the concentration ranges below, assume TTX does not block $\\text{K}^+$ channels and TEA does not block $\\text{Na}^+$ channels.\n\nYou may rapidly switch external perfusates. You will run two sets of recordings:\n- To isolate inward $\\text{Na}^+$ currents ($I_{\\mathrm{Na}}$), you will block outward $\\text{K}^+$ currents with TEA and record $I_{\\mathrm{Na}}$ in the absence of TTX.\n- To isolate outward $\\text{K}^+$ currents ($I_{\\mathrm{K}}$), you will block $\\text{Na}^+$ currents with TTX and record $I_{\\mathrm{K}}$ in the absence of TEA.\n\nDefine the fractional occupancy by a blocker at concentration $[L]$ as $f_{\\mathrm{bound}} = \\dfrac{[L]}{[L] + K_d}$. For a channel population that constitutes a weight $w$ of the total, the residual fraction of that population’s current under block is $(1 - f_{\\mathrm{bound}})$, so the weighted residual contribution is $w\\,(1 - f_{\\mathrm{bound}})$. The total residual interfering current is the sum over relevant populations.\n\nYour experimental performance criteria are:\n- During $I_{\\mathrm{Na}}$ isolation with TEA, the residual $\\text{K}^+$ current contaminating the inward trace must be less than $10\\%$ of the control total delayed $\\text{K}^+$ current amplitude under the same voltage step.\n- During $I_{\\mathrm{K}}$ isolation with TTX, the residual $\\text{Na}^+$ current contaminating the outward trace must be less than $2\\%$ of the control total peak $\\text{Na}^+$ current amplitude under the same voltage step.\n\nPractical constraints:\n- External TEA is limited to at most $30\\,\\mathrm{mM}$ to preserve osmolarity and minimize non-specific effects.\n- External TTX may be used up to $30\\,\\mu\\mathrm{M}$.\n\nWhich of the following paired-protocols (first bullet isolates $I_{\\mathrm{Na}}$, second bullet isolates $I_{\\mathrm{K}}$) best satisfies the criteria on the basis of the stated binding affinities and assumptions?\n\nA. \n- $I_{\\mathrm{Na}}$: Apply external TEA at $20\\,\\mathrm{mM}$; record inward currents without TTX.\n- $I_{\\mathrm{K}}$: Wash out TEA fully; apply external TTX at $0.3\\,\\mu\\mathrm{M}$; record outward currents.\n\nB.\n- $I_{\\mathrm{Na}}$: Apply external TTX at $0.3\\,\\mu\\mathrm{M}$; record inward currents.\n- $I_{\\mathrm{K}}$: Add external TEA at $20\\,\\mathrm{mM}$ on top of TTX; record outward currents.\n\nC.\n- $I_{\\mathrm{Na}}$: Apply external TEA at $3\\,\\mathrm{mM}$; record inward currents without TTX.\n- $I_{\\mathrm{K}}$: Wash out TEA; apply external TTX at $10\\,\\mathrm{nM}$; record outward currents.\n\nD.\n- $I_{\\mathrm{Na}}$: Apply external TEA at $20\\,\\mathrm{mM}$; record inward currents without TTX.\n- $I_{\\mathrm{K}}$: Wash out TEA fully; apply external TTX at $20\\,\\mu\\mathrm{M}$; record outward currents.\n\nE.\n- $I_{\\mathrm{Na}}$: Apply external TEA at $30\\,\\mathrm{mM}$; record inward currents without TTX.\n- $I_{\\mathrm{K}}$: Keep TEA present; add external TTX at $1\\,\\mu\\mathrm{M}$; record outward currents.\n\nSelect the single best option.", "solution": "The problem statement has been rigorously validated and is found to be scientifically sound, well-posed, and self-consistent. All necessary data and definitions for a quantitative analysis are provided. We may therefore proceed with the solution.\n\nThe fundamental principle governing the action of the blockers is the law of mass action for a single-site binding model, where the Hill coefficient is given as $n = 1$. The fractional occupancy, $f_{\\mathrm{bound}}$, of a channel population by a ligand (blocker) at concentration $[L]$ with a dissociation constant $K_d$ is given by:\n$$f_{\\mathrm{bound}} = \\frac{[L]}{[L] + K_d}$$\nThe fraction of current remaining for that population, $f_{\\mathrm{residual}}$, is therefore:\n$$f_{\\mathrm{residual}} = 1 - f_{\\mathrm{bound}} = 1 - \\frac{[L]}{[L] + K_d} = \\frac{K_d}{[L] + K_d}$$\nThe total residual current, expressed as a fraction of the original total current, is the weighted sum of the residual fractions of all contributing channel populations.\n$$f_{\\mathrm{res-total}} = \\sum_i w_i \\cdot f_{\\mathrm{residual}, i} = \\sum_i w_i \\left( \\frac{K_{d,i}}{[L] + K_{d,i}} \\right)$$\nwhere $w_i$ is the fractional contribution of population $i$ to the total current.\n\nThe problem defines two performance criteria:\n1.  For $I_{\\mathrm{Na}}$ isolation (using TEA to block $I_{\\mathrm{K}}$): The total residual $\\text{K}^+$ current, $I_{\\mathrm{K,res}}$, must be less than $10\\%$ of the control total $\\text{K}^+$ current.\n    $$f_{\\mathrm{res-K}} = \\frac{I_{\\mathrm{K,res}}}{I_{\\mathrm{K,control}}} < 0.10$$\n2.  For $I_{\\mathrm{K}}$ isolation (using TTX to block $I_{\\mathrm{Na}}$): The total residual $\\text{Na}^+$ current, $I_{\\mathrm{Na,res}}$, must be less than $2\\%$ of the control total $\\text{Na}^+$ current.\n    $$f_{\\mathrm{res-Na}} = \\frac{I_{\\mathrm{Na,res}}}{I_{\\mathrm{Na,control}}} < 0.02$$\n\nWe are given the following parameters:\n-   $\\text{Na}^+$ channels:\n    -   TTX-sensitive: $w_{\\mathrm{Na,sens}} = 0.95$, $K_d^{\\mathrm{TTX,\\,sens}} = 5\\,\\mathrm{nM}$\n    -   TTX-resistant: $w_{\\mathrm{Na,res}} = 0.05$, $K_d^{\\mathrm{TTX,\\,res}} = 10\\,\\mu\\mathrm{M}$\n-   $\\text{K}^+$ channels:\n    -   Kv$2.1$-like: $w_{\\mathrm{K,Kv2.1}} = 0.60$, $K_d^{\\mathrm{TEA},\\,\\mathrm{Kv2.1}} = 3\\,\\mathrm{mM}$\n    -   Kv$1$-like: $w_{\\mathrm{K,Kv1}} = 0.25$, $K_d^{\\mathrm{TEA},\\,\\mathrm{Kv1}} = 0.3\\,\\mathrm{mM}$\n    -   BK: $w_{\\mathrm{K,BK}} = 0.15$, $K_d^{\\mathrm{TEA},\\,\\mathrm{BK}} = 0.2\\,\\mathrm{mM}$\n\nWe will now evaluate each option.\n\n**Option A:**\n-   **$I_{\\mathrm{Na}}$ isolation with $[\\mathrm{TEA}] = 20\\,\\mathrm{mM}$**:\n    We calculate the fractional residual $\\text{K}^+$ current:\n    $$f_{\\mathrm{res-K}} = 0.60 \\left(\\frac{3\\,\\mathrm{mM}}{20\\,\\mathrm{mM} + 3\\,\\mathrm{mM}}\\right) + 0.25 \\left(\\frac{0.3\\,\\mathrm{mM}}{20\\,\\mathrm{mM} + 0.3\\,\\mathrm{mM}}\\right) + 0.15 \\left(\\frac{0.2\\,\\mathrm{mM}}{20\\,\\mathrm{mM} + 0.2\\,\\mathrm{mM}}\\right)$$\n    $$f_{\\mathrm{res-K}} = 0.60 \\left(\\frac{3}{23}\\right) + 0.25 \\left(\\frac{0.3}{20.3}\\right) + 0.15 \\left(\\frac{0.2}{20.2}\\right)$$\n    $$f_{\\mathrm{res-K}} \\approx 0.60(0.1304) + 0.25(0.0148) + 0.15(0.0099) \\approx 0.0782 + 0.0037 + 0.0015 = 0.0834$$\n    The residual $\\text{K}^+$ current is approximately $8.34\\%$. This satisfies the criterion of being less than $10\\%$.\n-   **$I_{\\mathrm{K}}$ isolation with $[\\mathrm{TTX}] = 0.3\\,\\mu\\mathrm{M} = 300\\,\\mathrm{nM}$**:\n    We calculate the fractional residual $\\text{Na}^+$ current:\n    $$f_{\\mathrm{res-Na}} = 0.95 \\left(\\frac{5\\,\\mathrm{nM}}{300\\,\\mathrm{nM} + 5\\,\\mathrm{nM}}\\right) + 0.05 \\left(\\frac{10\\,\\mu\\mathrm{M}}{0.3\\,\\mu\\mathrm{M} + 10\\,\\mu\\mathrm{M}}\\right)$$\n    $$f_{\\mathrm{res-Na}} = 0.95 \\left(\\frac{5}{305}\\right) + 0.05 \\left(\\frac{10}{10.3}\\right)$$\n    $$f_{\\mathrm{res-Na}} \\approx 0.95(0.0164) + 0.05(0.9709) \\approx 0.0156 + 0.0485 = 0.0641$$\n    The residual $\\text{Na}^+$ current is approximately $6.41\\%$. This does not satisfy the criterion of being less than $2\\%$.\n**Verdict for A:** Incorrect. The protocol fails to adequately isolate $I_{\\mathrm{K}}$.\n\n**Option B:**\n-   **$I_{\\mathrm{Na}}$ isolation with $[\\mathrm{TTX}] = 0.3\\,\\mu\\mathrm{M}$**:\n    The problem statement defines the protocol for isolating $I_{\\mathrm{Na}}$ as blocking $I_{\\mathrm{K}}$ with TEA. This option proposes to apply TTX, a $\\text{Na}^+$ channel blocker, to isolate $\\text{Na}^+$ currents. This is a logical contradiction and represents a fundamentally flawed experimental design. One cannot measure a current by first blocking it. The protocol is nonsensical for the stated objective.\n**Verdict for B:** Incorrect. The proposed experimental method is invalid.\n\n**Option C:**\n-   **$I_{\\mathrm{Na}}$ isolation with $[\\mathrm{TEA}] = 3\\,\\mathrm{mM}$**:\n    We calculate the fractional residual $\\text{K}^+$ current:\n    $$f_{\\mathrm{res-K}} = 0.60 \\left(\\frac{3\\,\\mathrm{mM}}{3\\,\\mathrm{mM} + 3\\,\\mathrm{mM}}\\right) + 0.25 \\left(\\frac{0.3\\,\\mathrm{mM}}{3\\,\\mathrm{mM} + 0.3\\,\\mathrm{mM}}\\right) + 0.15 \\left(\\frac{0.2\\,\\mathrm{mM}}{3\\,\\mathrm{mM} + 0.2\\,\\mathrm{mM}}\\right)$$\n    $$f_{\\mathrm{res-K}} = 0.60 \\left(\\frac{3}{6}\\right) + 0.25 \\left(\\frac{0.3}{3.3}\\right) + 0.15 \\left(\\frac{0.2}{3.2}\\right)$$\n    $$f_{\\mathrm{res-K}} \\approx 0.60(0.5) + 0.25(0.0909) + 0.15(0.0625) = 0.30 + 0.0227 + 0.0094 = 0.3321$$\n    The residual $\\text{K}^+$ current is approximately $33.2\\%$. This does not satisfy the criterion of being less than $10\\%$. We need not evaluate the second part of the protocol.\n**Verdict for C:** Incorrect. The protocol fails to adequately isolate $I_{\\mathrm{Na}}$.\n\n**Option D:**\n-   **$I_{\\mathrm{Na}}$ isolation with $[\\mathrm{TEA}] = 20\\,\\mathrm{mM}$**:\n    This is identical to the first part of Option A. As calculated previously, the residual $\\text{K}^+$ current is approximately $8.34\\%$, which is less than the $10\\%$ criterion. This part of the protocol is successful.\n-   **$I_{\\mathrm{K}}$ isolation with $[\\mathrm{TTX}] = 20\\,\\mu\\mathrm{M}$**:\n    We calculate the fractional residual $\\text{Na}^+$ current:\n    $$f_{\\mathrm{res-Na}} = 0.95 \\left(\\frac{5\\,\\mathrm{nM}}{20000\\,\\mathrm{nM} + 5\\,\\mathrm{nM}}\\right) + 0.05 \\left(\\frac{10\\,\\mu\\mathrm{M}}{20\\,\\mu\\mathrm{M} + 10\\,\\mu\\mathrm{M}}\\right)$$\n    $$f_{\\mathrm{res-Na}} = 0.95 \\left(\\frac{0.005\\,\\mu\\mathrm{M}}{20\\,\\mu\\mathrm{M} + 0.005\\,\\mu\\mathrm{M}}\\right) + 0.05 \\left(\\frac{10}{30}\\right)$$\n    $$f_{\\mathrm{res-Na}} = 0.95 \\left(\\frac{0.005}{20.005}\\right) + 0.05 \\left(\\frac{1}{3}\\right)$$\n    $$f_{\\mathrm{res-Na}} \\approx 0.95(0.00025) + 0.05(0.3333) \\approx 0.00024 + 0.01667 = 0.01691$$\n    The residual $\\text{Na}^+$ current is approximately $1.69\\%$. This satisfies the criterion of being less than $2\\%$.\n**Verdict for D:** Correct. Both parts of this paired protocol satisfy the specified performance criteria.\n\n**Option E:**\n-   **$I_{\\mathrm{K}}$ isolation**: The protocol states \"Keep TEA present; add external TTX...\". This contradicts the general experimental design laid out in the problem statement: \"To isolate outward $\\text{K}^+$ currents ($I_{\\mathrm{K}}$), you will block $\\text{Na}^+$ currents with TTX and record $I_{\\mathrm{K}}$ **in the absence of TEA**.\" Furthermore, applying TEA would block the very $\\text{K}^+$ current one intends to measure. This represents a flawed experimental logic, similar to the issue in Option B.\n**Verdict for E:** Incorrect. The proposed experimental method violates the problem's own procedural rules and is logically unsound for the stated goal.\n\nIn summary, Options B and E describe invalid experimental procedures. Options A and C fail to meet the quantitative performance criteria. Only Option D proposes a logically sound protocol where both steps successfully meet the required criteria for current isolation. Therefore, it is the single best option.", "answer": "$$\\boxed{D}$$", "id": "2622800"}, {"introduction": "We now move from analyzing components to synthesizing the whole system. This capstone practice challenges you to build a computational model of an excitable neuron based on the Hodgkin-Huxley equations. By simulating an action potential and then performing a 'virtual experiment' where you reduce potassium conductance, you will see firsthand how a specific molecular parameter ($g_{\\text{K}}$) shapes emergent physiological events like action potential duration and afterhyperpolarization. [@problem_id:2622681]", "problem": "You are to implement a deterministic single-compartment excitable membrane model that captures the biophysics of voltage-gated sodium and potassium channels using the classical Hodgkin–Huxley formalism. Your goal is to quantify, from first principles, how a $30\\%$ reduction in potassium maximal conductance $g_{\\text{K}}$ alters two spike metrics: action potential width at half-maximum and afterhyperpolarization amplitude.\n\nFundamental base and definitions:\n- The membrane obeys charge conservation: $C \\, dV/dt = - I_{\\text{ion}}(V, m, h, n) + I_{\\text{inj}}(t)$, where $C$ is membrane capacitance per unit area, $V$ is membrane potential, $m, h, n$ are gating variables, $I_{\\text{ion}}$ is the total ionic current, and $I_{\\text{inj}}$ is externally injected current.\n- The ionic current is the sum of sodium, potassium, and leak currents: $I_{\\text{ion}} = g_{\\text{Na}} m^{3} h \\, (V - E_{\\text{Na}}) + g_{\\text{K}} n^{4} \\, (V - E_{\\text{K}}) + g_{\\text{L}} (V - E_{\\text{L}})$.\n- The gating variables follow first-order kinetics: $dx/dt = \\alpha_{x}(V) \\, (1 - x) - \\beta_{x}(V) \\, x$ for $x \\in \\{m, h, n\\}$.\n- Use the canonical Hodgkin–Huxley voltage-dependent rate functions with $V$ in millivolts:\n  \n$$\n  \\alpha_{m}(V) = \\frac{0.1 \\, (V + 40)}{1 - e^{-(V+40)/10}}, \\quad \\beta_{m}(V) = 4 \\, e^{-(V+65)/18},\n  $$\n\n  \n$$\n  \\alpha_{h}(V) = 0.07 \\, e^{-(V+65)/20}, \\quad \\beta_{h}(V) = \\frac{1}{1 + e^{-(V+35)/10}},\n  $$\n\n  \n$$\n  \\alpha_{n}(V) = \\frac{0.01 \\, (V + 55)}{1 - e^{-(V+55)/10}}, \\quad \\beta_{n}(V) = 0.125 \\, e^{-(V+65)/80}.\n  $$\n\n- Use parameters: $C = 1\\,\\mu\\mathrm{F/cm^{2}}$, $g_{\\text{Na}} = 120\\,\\mathrm{mS/cm^{2}}$, $g_{\\text{K}} = 36\\,\\mathrm{mS/cm^{2}}$, $g_{\\text{L}} = 0.3\\,\\mathrm{mS/cm^{2}}$, $E_{\\text{Na}} = 50\\,\\mathrm{mV}$, $E_{\\text{K}} = -77\\,\\mathrm{mV}$, $E_{\\text{L}} = -54.4\\,\\mathrm{mV}$. Initialize $V(0) = -65\\,\\mathrm{mV}$ and set $m(0), h(0), n(0)$ to their steady-state values at $V(0)$.\n- Inject a square current $I_{\\text{inj}}(t) = I_{0}$ for $t_{\\text{on}} \\le t < t_{\\text{off}}$ and $I_{\\text{inj}}(t) = 0$ otherwise. Integrate with a fixed time step using a numerically stable explicit method; it is acceptable to use forward Euler with a sufficiently small step.\n\nMetric definitions to compute for any simulated trace $V(t)$:\n- Pre-stimulus baseline $V_{\\text{rest}}$: the average of $V(t)$ over the pre-stimulus interval $[0, t_{\\text{on}})$.\n- Spike detection: identify the first local maximum $V_{\\text{peak}}$ in $[t_{\\text{on}}, t_{\\text{off}})$ that satisfies both $V_{\\text{peak}} \\ge V_{\\text{rest}} + 20\\,\\mathrm{mV}$ and $V_{\\text{peak}} \\ge 0\\,\\mathrm{mV}$. If no such peak exists, define the spike width as $0\\,\\mathrm{ms}$ and the afterhyperpolarization amplitude as $0\\,\\mathrm{mV}$.\n- Action potential half-width: let $A = V_{\\text{peak}} - V_{\\text{rest}}$ and $V_{1/2} = V_{\\text{rest}} + A/2$. Define the width as the time difference between the upward and downward crossings of $V_{1/2}$ around the first detected spike, obtained by linear interpolation between time steps bracketing each crossing. Report in $\\mathrm{ms}$.\n- Afterhyperpolarization amplitude: in the interval $[t_{\\text{peak}}, \\min(T, t_{\\text{off}} + 20\\,\\mathrm{ms}))$, where $t_{\\text{peak}}$ is the time of the first spike peak and $T$ is the total simulation time, compute $V_{\\min}$, the minimum of $V(t)$. Define the afterhyperpolarization amplitude as $\\max(0, V_{\\text{rest}} - V_{\\min})$. Report in $\\mathrm{mV}$.\n\nTask:\n- For each parameter set in the test suite below, run two simulations: baseline and reduced $g_{\\text{K}}$. The reduced condition sets $g_{\\text{K,red}} = 0.70 \\times g_{\\text{K}}$. All other parameters remain identical.\n- For each parameter set, compute the change in metrics due to reduced $g_{\\text{K}}$: $\\Delta \\text{width} = \\text{width}_{\\text{red}} - \\text{width}_{\\text{base}}$ in $\\mathrm{ms}$, and $\\Delta \\text{AHP} = \\text{AHP}_{\\text{red}} - \\text{AHP}_{\\text{base}}$ in $\\mathrm{mV}$.\n\nRequired numerical details:\n- Use a fixed time step of $\\Delta t = 0.01\\,\\mathrm{ms}$.\n- Angles are not involved.\n- Express action potential width in $\\mathrm{ms}$ and afterhyperpolarization amplitude in $\\mathrm{mV}$. Output these as floating-point numbers.\n\nTest suite (each tuple $(I_{0}, t_{\\text{on}}, t_{\\text{off}}, T)$ uses units ($\\mu\\text{A}/\\text{cm}^2$, ms, ms, ms)):\n- Case $1$: $(10.0, 10.0, 40.0, 100.0)$.\n- Case $2$: $(6.5, 10.0, 20.0, 80.0)$.\n- Case $3$: $(3.0, 10.0, 40.0, 100.0)$.\n- Case $4$: $(8.0, 10.0, 90.0, 120.0)$.\n\nFinal output specification:\n- Your program must produce a single line containing a list of four elements, one per test case, where each element is a two-element list $[\\Delta \\text{width}, \\Delta \\text{AHP}]$.\n- Each floating-point number must be rounded to $5$ decimal places.\n- The exact output format is a single line: $[[dw_{1},d\\!ahp_{1}],[dw_{2},d\\!ahp_{2}],[dw_{3},d\\!ahp_{3}],[dw_{4},d\\!ahp_{4}]]$, where $dw_{k}$ is in $\\mathrm{ms}$ and $d\\!ahp_{k}$ is in $\\mathrm{mV}$.", "solution": "The model is based on the conservation of charge for a membrane capacitor in parallel with ionic conductances. The membrane equation is $C \\, dV/dt = - I_{\\text{ion}} + I_{\\text{inj}}$, where the total ionic current $I_{\\text{ion}}$ is the sum of sodium, potassium, and leak currents: $I_{\\text{Na}} = g_{\\text{Na}} m^{3} h \\, (V - E_{\\text{Na}})$, $I_{\\text{K}} = g_{\\text{K}} n^{4} \\, (V - E_{\\text{K}})$, and $I_{\\text{L}} = g_{\\text{L}} (V - E_{\\text{L}})$. The gating variables $m, h, n$ evolve according to first-order kinetics with voltage-dependent rates $\\alpha_{x}(V)$ and $\\beta_{x}(V)$, so that $dx/dt = \\alpha_{x}(V)(1 - x) - \\beta_{x}(V) x$. These laws form the fundamental base because they arise from conductance-based models validated experimentally in the squid giant axon and widely used in animal physiology.\n\nPrincipled reasoning about the effect of reducing $g_{\\text{K}}$ by $30\\%$:\n- During the upstroke of the action potential, $I_{\\text{Na}}$ dominates as $m$ rapidly activates and $h$ slowly inactivates. The potassium activation variable $n$ increases with some delay. Near the peak and repolarization phase, the outward current $I_{\\text{K}} = g_{\\text{K}} n^{4} (V - E_{\\text{K}})$ becomes the primary repolarizing force (with $V - E_{\\text{K}} > 0$). Reducing $g_{\\text{K}}$ directly reduces $I_{\\text{K}}$ at any given $V$ and $n$, thereby slowing repolarization.\n- A simplified linear analysis of the falling phase, neglecting changes in $m$ and $h$ and assuming $n$ varies slowly, yields approximately\n  \n$$\n  \\frac{dV}{dt} \\approx - \\frac{1}{C} \\left[g_{\\text{K}} n^{4} + g_{\\text{L}} \\right](V - V^{*}),\n  $$\n\n  where $V^{*}$ is an effective quasi-steady potential. The dominant time constant of repolarization is\n  \n$$\n  \\tau_{\\text{fall}} \\approx \\frac{C}{g_{\\text{K}} n^{4} + g_{\\text{L}}}.\n  $$\n\n  Reducing $g_{\\text{K}}$ by a factor $0.70$ increases $\\tau_{\\text{fall}}$, broadening the spike. In the limit $g_{\\text{K}} n^{4} \\gg g_{\\text{L}}$, the scaling is $\\tau_{\\text{fall}} \\propto 1/g_{\\text{K}}$, so the width is expected to increase by a factor close to $1/0.70 \\approx 1.428$ for the repolarization contribution.\n- The afterhyperpolarization reflects the net outward current after the spike peak. A larger $g_{\\text{K}}$ drives $V$ closer to $E_{\\text{K}}$ and can transiently undershoot $V_{\\text{rest}}$. Reducing $g_{\\text{K}}$ reduces the magnitude and integral of $I_{\\text{K}}$ during the post-spike period, thereby decreasing the depth of the afterhyperpolarization. Thus, $\\Delta \\text{AHP}$ is expected to be negative (reduced AHP amplitude).\n\nAlgorithmic design:\n1. Initialize $V(0) = -65\\,\\mathrm{mV}$. For each gate $x \\in \\{m,h,n\\}$, compute $x(0) = \\alpha_{x}(V(0))/(\\alpha_{x}(V(0)) + \\beta_{x}(V(0)))$.\n2. For each test case, define $I_{\\text{inj}}(t) = I_{0}$ for $t \\in [t_{\\text{on}}, t_{\\text{off}})$ and $0$ otherwise. Integrate the system using a forward Euler step $\\Delta t = 0.01\\,\\mathrm{ms}$:\n   \n$$\n   V_{k+1} = V_{k} + \\Delta t \\, \\frac{-I_{\\text{ion}}(V_{k}, m_{k}, h_{k}, n_{k}) + I_{\\text{inj}}(t_{k})}{C}.\n   $$\n\n   \n$$\n   x_{k+1} = x_{k} + \\Delta t \\left[\\alpha_{x}(V_{k}) (1 - x_{k}) - \\beta_{x}(V_{k}) x_{k}\\right].\n   $$\n\n   Compute two simulations per case: baseline $g_{\\text{K}}$ and reduced $g_{\\text{K,red}} = 0.70 \\, g_{\\text{K}}$.\n3. For each simulated voltage trace:\n   - Compute $V_{\\text{rest}}$ as the mean of $V(t)$ over $[0, t_{\\text{on}})$.\n   - Detect the first spike peak in $[t_{\\text{on}}, t_{\\text{off}})$ that satisfies $V_{\\text{peak}} \\ge V_{\\text{rest}} + 20\\,\\mathrm{mV}$ and $V_{\\text{peak}} \\ge 0\\,\\mathrm{mV}$, using local maxima. If none, set width $= 0\\,\\mathrm{ms}$ and AHP amplitude $= 0\\,\\mathrm{mV}$.\n   - If a spike is found, compute $A = V_{\\text{peak}} - V_{\\text{rest}}$, $V_{1/2} = V_{\\text{rest}} + A/2$. Find the upward and downward crossings around the peak by locating the time steps immediately bracketing $V_{1/2}$ and linearly interpolating to obtain precise crossing times. The width is the difference of these times, in $\\mathrm{ms}$.\n   - For AHP, in the window $[t_{\\text{peak}}, \\min(T, t_{\\text{off}} + 20\\,\\mathrm{ms}))$, compute $V_{\\min}$. The afterhyperpolarization amplitude is $\\max(0, V_{\\text{rest}} - V_{\\min})$, reported in $\\mathrm{mV}$.\n4. For each test case, compute $\\Delta \\text{width} = \\text{width}_{\\text{red}} - \\text{width}_{\\text{base}}$ and $\\Delta \\text{AHP} = \\text{AHP}_{\\text{red}} - \\text{AHP}_{\\text{base}}$. Round each to $5$ decimal places.\n5. Aggregate results for all test cases into a single list $[[dw_{1}, d\\!ahp_{1}], \\ldots, [dw_{4}, d\\!ahp_{4}]]$ and print it as the only line of output.\n\nExpected qualitative outcomes based on the above principles:\n- $\\Delta \\text{width} > 0$ when a spike is present, because reduced $g_{\\text{K}}$ slows repolarization.\n- $\\Delta \\text{AHP} < 0$ (a less negative trough relative to rest), because reduced $g_{\\text{K}}$ weakens the outward current that drives the membrane below rest.\n- In subthreshold cases (no spike under both conditions), both changes are $0$.\n\nThe program implements these steps precisely and produces the requested numeric outputs in the specified format and units.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef hh_rates(V):\n    \"\"\"\n    Hodgkin-Huxley rate functions with safe handling near singularities.\n    V in mV (float or numpy array).\n    Returns alpha_m, beta_m, alpha_h, beta_h, alpha_n, beta_n.\n    \"\"\"\n    # Use elementwise operations; support scalar floats by wrapping with np.array if needed\n    V = np.array(V, dtype=float)\n\n    def alpha_m(v):\n        x = v + 40.0\n        # Handle small x to avoid 0/0; limit is 1.0\n        out = np.where(np.abs(x) < 1e-7, 1.0, 0.1 * x / (1.0 - np.exp(-x / 10.0)))\n        return out\n\n    def beta_m(v):\n        return 4.0 * np.exp(-(v + 65.0) / 18.0)\n\n    def alpha_h(v):\n        return 0.07 * np.exp(-(v + 65.0) / 20.0)\n\n    def beta_h(v):\n        return 1.0 / (1.0 + np.exp(-(v + 35.0) / 10.0))\n\n    def alpha_n(v):\n        x = v + 55.0\n        # Handle small x to avoid 0/0; limit is 0.1\n        out = np.where(np.abs(x) < 1e-7, 0.1, 0.01 * x / (1.0 - np.exp(-x / 10.0)))\n        return out\n\n    def beta_n(v):\n        return 0.125 * np.exp(-(v + 65.0) / 80.0)\n\n    return alpha_m(V), beta_m(V), alpha_h(V), beta_h(V), alpha_n(V), beta_n(V)\n\ndef simulate_hh(I0, t_on, t_off, T, dt=0.01, gK_scale=1.0):\n    \"\"\"\n    Simulate the HH model with a square current injection.\n    I0 in uA/cm^2, times in ms, dt in ms, total simulation time T in ms.\n    gK_scale scales the maximal potassium conductance (e.g., 1.0 baseline, 0.70 reduced).\n    Returns time array t (ms) and voltage trace V (mV).\n    \"\"\"\n    # Parameters\n    C = 1.0  # uF/cm^2\n    gNa = 120.0  # mS/cm^2\n    gK = 36.0 * gK_scale  # mS/cm^2\n    gL = 0.3  # mS/cm^2\n    ENa = 50.0  # mV\n    EK = -77.0  # mV\n    EL = -54.4  # mV\n\n    n_steps = int(np.round(T / dt)) + 1\n    t = np.linspace(0.0, T, n_steps)\n\n    V = np.empty(n_steps, dtype=float)\n    m = np.empty(n_steps, dtype=float)\n    h = np.empty(n_steps, dtype=float)\n    n = np.empty(n_steps, dtype=float)\n\n    # Initial conditions at rest\n    V0 = -65.0\n    am, bm, ah, bh, an, bn = hh_rates(V0)\n    m0 = am / (am + bm)\n    h0 = ah / (ah + bh)\n    n0 = an / (an + bn)\n\n    V[0] = V0\n    m[0] = m0\n    h[0] = h0\n    n[0] = n0\n\n    # Time stepping\n    for k in range(n_steps - 1):\n        tk = t[k]\n        Iinj = I0 if (tk >= t_on and tk < t_off) else 0.0\n\n        # Currents\n        INa = gNa * (m[k] ** 3) * h[k] * (V[k] - ENa)\n        IK = gK * (n[k] ** 4) * (V[k] - EK)\n        IL = gL * (V[k] - EL)\n        Iion = INa + IK + IL\n\n        dVdt = (-Iion + Iinj) / C\n\n        # Gating kinetics\n        am, bm, ah, bh, an, bn = hh_rates(V[k])\n        dmdt = am * (1.0 - m[k]) - bm * m[k]\n        dhdt = ah * (1.0 - h[k]) - bh * h[k]\n        dndt = an * (1.0 - n[k]) - bn * n[k]\n\n        # Euler update\n        V[k + 1] = V[k] + dt * dVdt\n        m[k + 1] = m[k] + dt * dmdt\n        h[k + 1] = h[k] + dt * dhdt\n        n[k + 1] = n[k] + dt * dndt\n\n        # Clamp gates to [0,1] for numerical robustness\n        if m[k + 1] < 0.0:\n            m[k + 1] = 0.0\n        elif m[k + 1] > 1.0:\n            m[k + 1] = 1.0\n        if h[k + 1] < 0.0:\n            h[k + 1] = 0.0\n        elif h[k + 1] > 1.0:\n            h[k + 1] = 1.0\n        if n[k + 1] < 0.0:\n            n[k + 1] = 0.0\n        elif n[k + 1] > 1.0:\n            n[k + 1] = 1.0\n\n    return t, V\n\ndef find_first_spike_metrics(t, V, t_on, t_off):\n    \"\"\"\n    Compute Vrest, first spike half-width, and AHP amplitude for the trace.\n    - Vrest: mean V over [0, t_on)\n    - Spike: first local maximum in [t_on, t_off) exceeding both Vrest+20 mV and 0 mV.\n    - Half-width: time between upward and downward crossings of V_half = Vrest + 0.5*(Vpeak - Vrest).\n    - AHP amplitude: max(0, Vrest - Vmin) over [t_peak, min(T, t_off + 20 ms))\n    Returns (width_ms, AHP_mV).\n    \"\"\"\n    # Pre-stimulus baseline\n    pre_idx = np.where(t < t_on)[0]\n    if pre_idx.size == 0:\n        Vrest = V[0]\n    else:\n        Vrest = float(np.mean(V[pre_idx]))\n\n    # Define search window within stimulus\n    stim_idx = np.where((t >= t_on) & (t < t_off))[0]\n    if stim_idx.size < 3:\n        return 0.0, 0.0\n\n    # Thresholds\n    thresh_abs = 0.0\n    thresh_rel = Vrest + 20.0\n\n    # Find local maxima indices in stimulus window\n    # Exclude the endpoints to allow i-1 and i+1 access\n    idx_candidates = stim_idx[1:-1]\n    peaks = []\n    for i in idx_candidates:\n        if V[i] > V[i - 1] and V[i] > V[i + 1]:\n            if V[i] >= thresh_abs and V[i] >= thresh_rel:\n                peaks.append(i)\n    if len(peaks) == 0:\n        return 0.0, 0.0\n\n    peak_idx = peaks[0]\n    Vpeak = V[peak_idx]\n    tpeak = t[peak_idx]\n\n    # Compute half-width\n    A = Vpeak - Vrest\n    if A <= 0:\n        return 0.0, 0.0\n    Vhalf = Vrest + 0.5 * A\n\n    # Upward crossing: search backward from peak to find last index where V <= Vhalf\n    up_idx_low = None\n    for i in range(peak_idx - 1, 0, -1):\n        if V[i] <= Vhalf and V[i + 1] > Vhalf:\n            up_idx_low = i\n            break\n    if up_idx_low is None:\n        width_ms = 0.0\n    else:\n        # Linear interpolation between (t[i], V[i]) and (t[i+1], V[i+1])\n        t1, v1 = t[up_idx_low], V[up_idx_low]\n        t2, v2 = t[up_idx_low + 1], V[up_idx_low + 1]\n        if v2 == v1:\n            t_up = t1\n        else:\n            t_up = t1 + (Vhalf - v1) * (t2 - t1) / (v2 - v1)\n\n        # Downward crossing: search forward from peak\n        down_idx_low = None\n        for j in range(peak_idx, len(V) - 1):\n            if V[j] >= Vhalf and V[j + 1] < Vhalf:\n                down_idx_low = j\n                break\n        if down_idx_low is None:\n            width_ms = 0.0\n        else:\n            t1, v1 = t[down_idx_low], V[down_idx_low]\n            t2, v2 = t[down_idx_low + 1], V[down_idx_low + 1]\n            if v2 == v1:\n                t_down = t2\n            else:\n                t_down = t1 + (Vhalf - v1) * (t2 - t1) / (v2 - v1)\n            width_ms = max(0.0, float(t_down - t_up))\n\n    # AHP amplitude within [tpeak, min(T, t_off + 20 ms))\n    T = t[-1]\n    ahp_end = min(T, t_off + 20.0)\n    ahp_idx = np.where((t >= tpeak) & (t < ahp_end))[0]\n    if ahp_idx.size == 0:\n        AHP = 0.0\n    else:\n        Vmin = float(np.min(V[ahp_idx]))\n        AHP = max(0.0, Vrest - Vmin)\n\n    return width_ms, AHP\n\ndef run_case(I0, t_on, t_off, T):\n    # Baseline\n    t_b, V_b = simulate_hh(I0, t_on, t_off, T, dt=0.01, gK_scale=1.0)\n    w_b, ahp_b = find_first_spike_metrics(t_b, V_b, t_on, t_off)\n    # Reduced gK (30% reduction -> scale 0.70)\n    t_r, V_r = simulate_hh(I0, t_on, t_off, T, dt=0.01, gK_scale=0.70)\n    w_r, ahp_r = find_first_spike_metrics(t_r, V_r, t_on, t_off)\n    return w_r - w_b, ahp_r - ahp_b\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (I0 (uA/cm^2), t_on (ms), t_off (ms), T (ms))\n    test_cases = [\n        (10.0, 10.0, 40.0, 100.0),\n        (6.5, 10.0, 20.0, 80.0),\n        (3.0, 10.0, 40.0, 100.0),\n        (8.0, 10.0, 90.0, 120.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        dw, dahp = run_case(*case)\n        # Round to 5 decimal places as required\n        dw = float(np.round(dw, 5))\n        dahp = float(np.round(dahp, 5))\n        results.append([dw, dahp])\n\n    # Final print statement in the exact required format.\n    # Single-line output: list of four [dw, dAHP] elements.\n    def fmt_pair(p):\n        # Ensure 5 decimal places formatting\n        return f\"[{p[0]:.5f},{p[1]:.5f}]\"\n\n    print(f\"[{','.join(fmt_pair(p) for p in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2622681"}]}