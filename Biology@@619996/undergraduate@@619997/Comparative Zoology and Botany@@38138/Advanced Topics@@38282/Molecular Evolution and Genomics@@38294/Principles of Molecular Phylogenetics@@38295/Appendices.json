{"hands_on_practices": [{"introduction": "The principle of maximum parsimony is a cornerstone of phylogenetic inference, guiding us to prefer the evolutionary tree that requires the fewest changes. However, not all genetic variation contributes equally to this analysis; some sites in an alignment are constant, while others vary in ways that do not help distinguish between competing tree topologies. This foundational exercise [@problem_id:1771230] will help you learn to sift through a DNA alignment and identify which sites are 'phylogenetically informative'â€”the very sites that provide the evidence needed to resolve evolutionary relationships.", "problem": "A molecular biologist is investigating the evolutionary relationships among four recently discovered species of extremophilic archaea, labeled Species 1 through 4. To construct a phylogenetic tree using the principle of maximum parsimony, the biologist has sequenced and aligned a 10 base-pair segment from a homologous gene locus associated with thermal stress tolerance. The resulting alignment is shown below, with sites numbered 1 through 10.\n\n```\nSite:      1 2 3 4 5 6 7 8 9 10\nSpecies 1: A C G T A G T C G C\nSpecies 2: A C G T A G C T G G\nSpecies 3: A T A T C G T T G G\nSpecies 4: A C A T C G T C G C\n```\n\nBased on this alignment, determine the total number of sites that are phylogenetically informative for a maximum parsimony analysis.", "solution": "In maximum parsimony for nucleotide characters, a site is phylogenetically informative if and only if there are at least two different character states present and at least two of those states are each represented in at least two taxa. With four taxa, the only informative pattern is a $2$-$2$ distribution of states; patterns $4$-$0$, $3$-$1$, $2$-$1$-$1$, and $1$-$1$-$1$-$1$ are not informative.\n\nEvaluate each site (Species 1 through 4 in order):\n\n- Site $1$: $A,A,A,A \\Rightarrow 4$-$0$ (not informative).\n- Site $2$: $C,C,T,C \\Rightarrow 3$-$1$ (not informative).\n- Site $3$: $G,G,A,A \\Rightarrow 2$-$2$ (informative).\n- Site $4$: $T,T,T,T \\Rightarrow 4$-$0$ (not informative).\n- Site $5$: $A,A,C,C \\Rightarrow 2$-$2$ (informative).\n- Site $6$: $G,G,G,G \\Rightarrow 4$-$0$ (not informative).\n- Site $7$: $T,C,T,T \\Rightarrow 3$-$1$ (not informative).\n- Site $8$: $C,T,T,C \\Rightarrow 2$-$2$ (informative).\n- Site $9$: $G,G,G,G \\Rightarrow 4$-$0$ (not informative).\n- Site $10$: $C,G,G,C \\Rightarrow 2$-$2$ (informative).\n\nThe informative sites are $3,5,8,10$, giving a total of $4$ phylogenetically informative sites.", "answer": "$$\\boxed{4}$$", "id": "1771230"}, {"introduction": "Once we can identify phylogenetically informative characters, the next step is to use them to evaluate competing hypotheses about evolutionary history, which are represented by different tree topologies. Parsimony provides a clear optimality criterion: the best tree is the one that minimizes the total number of required evolutionary changes. In this practice [@problem_id:1771201], you will apply this principle directly by calculating the 'parsimony score' for a character on two different hypothetical trees, giving you hands-on experience in how phylogeneticists quantitatively compare and select the most plausible evolutionary scenarios.", "problem": "An entomologist is studying the evolutionary relationships among five species of hymenopterans: *Apis volans*, *Bombus saltans*, *Formica currens*, *Vespa rex*, and *Solenopsis ignis*. The study focuses on a single morphological trait: the structure of the occipital ridge, which can be either \"pronounced\" (represented by state 1) or \"reduced\" (represented by state 0). The observed states for the five extant species are as follows:\n\n- *Apis volans*: reduced (0)\n- *Bombus saltans*: reduced (0)\n- *Formica currens*: pronounced (1)\n- *Vespa rex*: pronounced (1)\n- *Solenopsis ignis*: reduced (0)\n\nTwo competing hypotheses for the phylogenetic relationships among these species have been proposed. The relationships are described using a nested parenthetical notation, where each pair of parentheses encloses a monophyletic group.\n\n- **Hypothesis A:** `((Apis volans, Bombus saltans), (Formica currens, (Vespa rex, Solenopsis ignis)))`\n- **Hypothesis B:** `((Apis volans, Solenopsis ignis), (Bombus saltans, (Formica currens, Vespa rex)))`\n\nAssuming that the evolution of this trait follows the principle of maximum parsimony, one hypothesis will be preferred over the other if it requires fewer evolutionary changes (i.e., transitions between state 0 and state 1) to explain the observed character states.\n\nCalculate the absolute difference between the minimum number of evolutionary changes required by Hypothesis A and the minimum number of evolutionary changes required by Hypothesis B.", "solution": "Let each taxon be coded by its observed binary state: $A=\\{0\\}$ for Apis volans, $B=\\{0\\}$ for Bombus saltans, $F=\\{1\\}$ for Formica currens, $V=\\{1\\}$ for Vespa rex, and $S=\\{0\\}$ for Solenopsis ignis. Under the Fitch parsimony algorithm for an unordered binary character, for any internal node with child state sets $X$ and $Y$, the node state set is $X \\cap Y$ if $X \\cap Y \\neq \\varnothing$ (no increase in the count), and is $X \\cup Y$ with an increment of $1$ in the parsimony count if $X \\cap Y = \\varnothing$.\n\nFor Hypothesis A, $((A,B),(F,(V,S)))$, compute bottom-up. Initialize $c_{A}=0$.\nFor the clade $(A,B)$:\n$$\nS_{AB}=S_{A}\\cap S_{B}=\\{0\\}\\cap\\{0\\}=\\{0\\},\\quad c_{A}\\leftarrow c_{A}+0.\n$$\nFor the clade $(V,S)$:\n$$\nS_{VS}=S_{V}\\cap S_{S}=\\{1\\}\\cap\\{0\\}=\\varnothing \\;\\Rightarrow\\; S_{VS}=\\{1\\}\\cup\\{0\\}=\\{0,1\\},\\quad c_{A}\\leftarrow c_{A}+1.\n$$\nFor the clade $(F,(V,S))$:\n$$\nS_{FVS}=S_{F}\\cap S_{VS}=\\{1\\}\\cap\\{0,1\\}=\\{1\\},\\quad c_{A}\\leftarrow c_{A}+0.\n$$\nAt the root combining $(A,B)$ and $(F,(V,S))$:\n$$\nS_{\\text{root}}=S_{AB}\\cap S_{FVS}=\\{0\\}\\cap\\{1\\}=\\varnothing \\;\\Rightarrow\\; S_{\\text{root}}=\\{0,1\\},\\quad c_{A}\\leftarrow c_{A}+1.\n$$\nThus the minimum number of changes for Hypothesis A is $c_{A}=2$.\n\nFor Hypothesis B, $((A,S),(B,(F,V)))$, compute bottom-up. Initialize $c_{B}=0$.\nFor the clade $(A,S)$:\n$$\nS_{AS}=S_{A}\\cap S_{S}=\\{0\\}\\cap\\{0\\}=\\{0\\},\\quad c_{B}\\leftarrow c_{B}+0.\n$$\nFor the clade $(F,V)$:\n$$\nS_{FV}=S_{F}\\cap S_{V}=\\{1\\}\\cap\\{1\\}=\\{1\\},\\quad c_{B}\\leftarrow c_{B}+0.\n$$\nFor the clade $(B,(F,V))$:\n$$\nS_{BFV}=S_{B}\\cap S_{FV}=\\{0\\}\\cap\\{1\\}=\\varnothing \\;\\Rightarrow\\; S_{BFV}=\\{0,1\\},\\quad c_{B}\\leftarrow c_{B}+1.\n$$\nAt the root combining $(A,S)$ and $(B,(F,V))$:\n$$\nS_{\\text{root}}=S_{AS}\\cap S_{BFV}=\\{0\\}\\cap\\{0,1\\}=\\{0\\},\\quad c_{B}\\leftarrow c_{B}+0.\n$$\nThus the minimum number of changes for Hypothesis B is $c_{B}=1$.\n\nThe required absolute difference is\n$$\n|c_{A}-c_{B}|=\\left|2-1\\right|=1.\n$$", "answer": "$$\\boxed{1}$$", "id": "1771201"}, {"introduction": "While character-based methods like parsimony evaluate trees site by site, distance-based methods take a different approach by first summarizing all genetic differences between pairs of species into a single distance matrix. The Neighbor-Joining (NJ) algorithm is a powerful and widely used technique that efficiently constructs a tree from such a matrix. This exercise [@problem_id:1771208] demystifies the NJ algorithm by guiding you through its first crucial, iterative step, providing a clear window into how a table of evolutionary distances is transformed into a branched tree diagram.", "problem": "A team of botanists is studying the evolutionary relationships among five recently discovered species of sunflowers. They have sequenced a specific gene from each species and calculated a pairwise genetic distance matrix, which quantifies the divergence between each pair. The species are *Helianthus arcanus* (HA), *Helianthus borealis* (HB), *Helianthus campestris* (HC), *Helianthus deserticola* (HD), and *Helianthus elegans* (HE).\n\nThe botanists decide to construct a phylogenetic tree using the Neighbor-Joining (NJ) algorithm. Your task is to perform the very first step of this algorithm to determine which two species are the first to be grouped together and form a new internal node.\n\nThe genetic distance matrix, where values represent a unitless measure of genetic divergence, is given below:\n\n|        | HA | HB | HC | HD | HE |\n| :----: | :-: | :-: | :-: | :-: | :-: |\n| **HA** | 0  | 5  | 4  | 7  | 6  |\n| **HB** | 5  | 0  | 7  | 10 | 9  |\n| **HC** | 4  | 7  | 0  | 7  | 6  |\n| **HD** | 7  | 10 | 7  | 0  | 5  |\n| **HE** | 6  | 9  | 6  | 5  | 0  |\n\nBased on this matrix, which of the following statements correctly describes the outcome of the first joining step of the Neighbor-Joining algorithm?\n\nA. The pair (*H. deserticola*, *H. elegans*) is joined. The new distances from this node are: 4 to *H. arcanus*, 7 to *H. borealis*, and 4 to *H. campestris*.\n\nB. The pair (*H. arcanus*, *H. borealis*) is joined. The new distances from this node are: 3 to *H. campestris*, 6 to *H. deserticola*, and 5 to *H. elegans*.\n\nC. The pair (*H. arcanus*, *H. campestris*) is joined. The new distances from this node are: 4 to *H. borealis*, 5 to *H. deserticola*, and 4 to *H. elegans*.\n\nD. The pair (*H. deserticola*, *H. elegans*) is joined. The new distances from this node are: 3 to *H. arcanus*, 2 to *H. borealis*, and 3 to *H. campestris*.\n\nE. The pair (*H. campestris*, *H. deserticola*) is joined. The new distances from this node are: 5.5 to *H. arcanus*, 8 to *H. borealis*, and 4 to *H. elegans*.", "solution": "To perform the first step of the Neighbor-Joining (NJ) algorithm with taxa $\\{\\mathrm{HA}, \\mathrm{HB}, \\mathrm{HC}, \\mathrm{HD}, \\mathrm{HE}\\}$ and distance matrix $d(i,j)$, compute the row sums $r_{i}=\\sum_{k} d(i,k)$ and the $Q$-matrix entries\n$$\nQ(i,j)=(n-2)\\,d(i,j)-r_{i}-r_{j},\n$$\nwhere $n=5$.\n\nFirst compute the row sums:\n$$\n\\begin{aligned}\nr_{\\mathrm{HA}}&=d(\\mathrm{HA},\\mathrm{HB})+d(\\mathrm{HA},\\mathrm{HC})+d(\\mathrm{HA},\\mathrm{HD})+d(\\mathrm{HA},\\mathrm{HE})=5+4+7+6=22,\\\\\nr_{\\mathrm{HB}}&=5+7+10+9=31,\\\\\nr_{\\mathrm{HC}}&=4+7+7+6=24,\\\\\nr_{\\mathrm{HD}}&=7+10+7+5=29,\\\\\nr_{\\mathrm{HE}}&=6+9+6+5=26.\n\\end{aligned}\n$$\nWith $n-2=3$, compute the $Q$-values:\n$$\n\\begin{aligned}\nQ(\\mathrm{HA},\\mathrm{HB})&=3\\cdot 5-22-31=15-53=-38,\\\\\nQ(\\mathrm{HA},\\mathrm{HC})&=3\\cdot 4-22-24=12-46=-34,\\\\\nQ(\\mathrm{HA},\\mathrm{HD})&=3\\cdot 7-22-29=21-51=-30,\\\\\nQ(\\mathrm{HA},\\mathrm{HE})&=3\\cdot 6-22-26=18-48=-30,\\\\\nQ(\\mathrm{HB},\\mathrm{HC})&=3\\cdot 7-31-24=21-55=-34,\\\\\nQ(\\mathrm{HB},\\mathrm{HD})&=3\\cdot 10-31-29=30-60=-30,\\\\\nQ(\\mathrm{HB},\\mathrm{HE})&=3\\cdot 9-31-26=27-57=-30,\\\\\nQ(\\mathrm{HC},\\mathrm{HD})&=3\\cdot 7-24-29=21-53=-32,\\\\\nQ(\\mathrm{HC},\\mathrm{HE})&=3\\cdot 6-24-26=18-50=-32,\\\\\nQ(\\mathrm{HD},\\mathrm{HE})&=3\\cdot 5-29-26=15-55=-40.\n\\end{aligned}\n$$\nThe minimum $Q$ is $Q(\\mathrm{HD},\\mathrm{HE})=-40$, so the first joined pair is $(\\mathrm{HD},\\mathrm{HE})$.\n\nThe NJ reduction gives the distances from the new node $U$ joining $\\mathrm{HD}$ and $\\mathrm{HE}$ to any remaining taxon $k$ by\n$$\nd(U,k)=\\frac{d(\\mathrm{HD},k)+d(\\mathrm{HE},k)-d(\\mathrm{HD},\\mathrm{HE})}{2}.\n$$\nCompute these for $k\\in\\{\\mathrm{HA},\\mathrm{HB},\\mathrm{HC}\\}$ using $d(\\mathrm{HD},\\mathrm{HE})=5$:\n$$\n\\begin{aligned}\nd(U,\\mathrm{HA})&=\\frac{d(\\mathrm{HD},\\mathrm{HA})+d(\\mathrm{HE},\\mathrm{HA})-d(\\mathrm{HD},\\mathrm{HE})}{2}=\\frac{7+6-5}{2}=4,\\\\\nd(U,\\mathrm{HB})&=\\frac{10+9-5}{2}=7,\\\\\nd(U,\\mathrm{HC})&=\\frac{7+6-5}{2}=4.\n\\end{aligned}\n$$\nThus the first join is $(\\mathrm{HD},\\mathrm{HE})$ with new distances $4$ to $\\mathrm{HA}$, $7$ to $\\mathrm{HB}$, and $4$ to $\\mathrm{HC}$, which matches option A.", "answer": "$$\\boxed{A}$$", "id": "1771208"}]}