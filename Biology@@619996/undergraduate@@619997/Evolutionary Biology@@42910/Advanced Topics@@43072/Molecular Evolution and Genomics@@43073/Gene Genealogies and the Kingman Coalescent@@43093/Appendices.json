{"hands_on_practices": [{"introduction": "Understanding gene genealogies begins with a simple question: looking back in time, how long do we have to wait until any two lineages in our sample find a common ancestor? This exercise [@problem_id:1931569] provides a hands-on approach to calculating this fundamental quantity, the expected time to the first coalescent event. By applying the core principles of the Kingman coalescent to a realistic scenario, you will develop the foundational skill needed to analyze the timescale of evolutionary history.", "problem": "A population geneticist is investigating the recent evolutionary history of a pathogenic bacterium using genomic data. The bacteria are maintained in a large, controlled laboratory environment, and their population dynamics can be approximated by the Wright-Fisher model for haploid organisms. The effective population size, $N_e$, is estimated to be a constant $5.0 \\times 10^7$.\n\nFrom this population, the geneticist obtains the complete DNA sequence of a non-recombining gene from a sample of $n = 25$ individual bacteria. Using coalescent theory, she wishes to determine the expected time scale for the earliest ancestral event in her sample.\n\nCalculate the expected number of generations, looking backwards in time, until the first coalescent event occurs among the sampled gene lineages. Express your answer in generations, rounded to three significant figures.", "solution": "We model the sample genealogy using the standard coalescent for a haploid Wright-Fisher population with constant effective size $N_{e}$. When there are $k$ ancestral lineages, the probability that any particular pair coalesces in the immediately preceding generation is $1/N_{e}$ (haploid), and there are $\\binom{k}{2}$ distinct pairs. For large $N_{e}$, the probability of multiple coalescences in the same generation is negligible, so the waiting time to the next coalescent event is approximately geometric with parameter\n$$\np_{k} \\approx \\frac{\\binom{k}{2}}{N_{e}},\n$$\nwhich is well-approximated by an exponential with rate\n$$\n\\lambda_{k} = \\frac{\\binom{k}{2}}{N_{e}}.\n$$\nThus, the expected waiting time (in generations) until the next coalescent event, given $k$ lineages, is\n$$\n\\mathbb{E}[T_{k}] = \\frac{1}{\\lambda_{k}} = \\frac{N_{e}}{\\binom{k}{2}}.\n$$\nFor the earliest ancestral event in a sample of size $n=25$, we set $k=n$:\n$$\n\\mathbb{E}[T_{\\text{first}}] = \\frac{N_{e}}{\\binom{25}{2}} = \\frac{5.0 \\times 10^{7}}{\\frac{25 \\cdot 24}{2}} = \\frac{5.0 \\times 10^{7}}{300}.\n$$\nCarrying out the division and rounding to three significant figures gives\n$$\n\\mathbb{E}[T_{\\text{first}}] = 1.67 \\times 10^{5}.\n$$\nThis is the expected number of generations back to the first coalescent event among the $25$ sampled lineages.", "answer": "$$\\boxed{1.67 \\times 10^{5}}$$", "id": "1931569"}, {"introduction": "While the timing of coalescent events is crucial, the *order* in which lineages merge is what determines the shape, or topology, of a gene genealogy. This engaging thought experiment [@problem_id:1931613] abstracts the coalescent process to its combinatorial core, asking you to determine the probability of forming a specific, symmetric tree shape. This practice will sharpen your intuition about the stochastic nature of coalescence and reveal why certain ancestral relationships are more probable than others.", "problem": "Consider a fully-connected distributed network of four server nodes, labeled N1, N2, N3, and N4. Each node initially possesses a unique, independent ancestral data block. The system undergoes a stochastic pairwise synchronization process to ensure data consistency. At each step of the process, a single pair of nodes with distinct data histories is chosen at random, and their data blocks are merged. After this event, they are treated as a single entity with a shared data history. For example, if N1 and N2 merge, they form a new entity (N1,N2), and the system now effectively contains three distinct data lineages: (N1,N2), N3, and N4. The process continues until all nodes trace their data back to a single common ancestral block, forming a complete genealogical history.\n\nAny pair of distinct data lineages present at any given time is equally likely to be selected for the next merge event.\n\nA genealogical history is defined as \"perfectly symmetric\" if the four initial nodes form two pairs, these two pairs merge independently, and then the two resulting ancestral lineages merge. For example, a history where N1 and N2 merge, and N3 and N4 merge, and then the resulting entities (N1,N2) and (N3,N4) merge, is perfectly symmetric.\n\nDetermine the exact probability that the randomly generated genealogical history for this system of four nodes will be perfectly symmetric. Express your final answer as a fraction in simplest form.", "solution": "The problem asks for the probability of obtaining a perfectly symmetric genealogical topology for a sample of $n=4$ lineages under a random merging process, which is equivalent to the standard Kingman coalescent model. Let the four initial lineages be L1, L2, L3, and L4, corresponding to the nodes N1, N2, N3, and N4.\n\nThe process of generating the genealogy involves a sequence of three merging (coalescent) events:\n1.  The number of lineages is reduced from 4 to 3.\n2.  The number of lineages is reduced from 3 to 2.\n3.  The number of lineages is reduced from 2 to 1, reaching the Most Recent Common Ancestor (MRCA).\n\nThe topology of the genealogy is determined by the sequence of these merging events. At each step, any pair of existing lineages is equally likely to be the next to merge.\n\n**Step 1: First Merging Event (4 lineages -> 3 lineages)**\n\nInitially, there are $k=4$ lineages. The number of distinct pairs of lineages is given by the binomial coefficient:\n$$ \\binom{4}{2} = \\frac{4 \\times 3}{2} = 6 $$\nThese pairs are {L1,L2}, {L1,L3}, {L1,L4}, {L2,L3}, {L2,L4}, {L3,L4}.\nThe process starts when one of these 6 pairs merges. Since all pairs are equally likely to be the *first* to merge, the choice of the first pair does not constrain the final topology shape yet. By symmetry, we can analyze the process by assuming any specific pair merges first without loss of generality. Let's assume the first pair to merge is {L1, L2}. After this event, the system contains $k=3$ lineages: {(L1,L2), L3, L4}.\n\n**Step 2: Second Merging Event (3 lineages -> 2 lineages)**\n\nThe system now has 3 lineages. Let's label them A = (L1,L2), B = L3, and C = L4. The number of distinct pairs available for the next merge is:\n$$ \\binom{3}{2} = \\frac{3 \\times 2}{2} = 3 $$\nThe possible pairs are {A, B}, {A, C}, and {B, C}. Substituting the original lineage labels, these correspond to the pairs:\n1.  {(L1,L2), L3}\n2.  {(L1,L2), L4}\n3.  {L3, L4}\n\nThe problem defines a \"perfectly symmetric\" topology. For the final topology to be symmetric, the four initial lineages must be partitioned into two pairs that merge independently first. Since we assumed {L1, L2} merged in the first step, a symmetric topology requires that the two remaining independent lineages, {L3, L4}, must merge in the second step.\n\nSo, out of the three equally likely outcomes for the second merge event, only one outcome—the merging of {L3, L4}—leads to a symmetric topology. The other two outcomes, where L3 or L4 merges with the ancestral lineage (L1,L2), would result in an asymmetric, or \"unbalanced,\" topology (e.g., (((L1,L2),L3),L4)).\n\nThe probability of the second merge being the specific pair {L3, L4} is:\n$$ P(\\text{second merge is {L3,L4}}) = \\frac{\\text{Number of symmetric-forming outcomes}}{\\text{Total number of outcomes}} = \\frac{1}{3} $$\n\n**Step 3: Third Merging Event (2 lineages -> 1 lineage)**\n\nIf the second event was the merge of {L3, L4}, the system is left with $k=2$ lineages: {(L1,L2), (L3,L4)}. There is only one possible pair to merge:\n$$ \\binom{2}{2} = 1 $$\nThis final merge will occur with probability 1, completing the perfectly symmetric genealogy ((L1,L2),(L3,L4)).\n\n**Conclusion**\n\nThe overall probability of obtaining a symmetric topology is determined entirely by the probability of making the correct choice at the second merging event. The first event can be any pair, and the third event is deterministic once two lineages remain. The critical junction is the transition from 3 to 2 lineages, where only one of the three possible events leads to the desired symmetric structure.\n\nTherefore, the total probability is the probability calculated in Step 2.\n$$ P(\\text{symmetric topology}) = \\frac{1}{3} $$\nThis result is independent of which pair merged first, due to the symmetry of the process. For any choice of the first pair, there is always exactly one choice for the second pair (out of three possibilities) that will result in a symmetric topology.", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "1931613"}, {"introduction": "The true power of the coalescent model lies in its ability to predict patterns of genetic variation we can actually observe in DNA sequences. This problem [@problem_id:1931620] builds a bridge between the theoretical gene tree and real data by exploring the connection between branch lengths and mutation frequencies. By calculating the probability of observing a 'singleton' mutation, you will learn how the structure of a genealogy directly shapes the site frequency spectrum, a key summary of genetic diversity.", "problem": "In population genetics, the Kingman coalescent is a model that describes the gene genealogy (ancestral tree) of a sample of gene copies from a population. We consider a sample of $n$ gene lineages from a large, stable population evolving neutrally. Mutations are assumed to occur according to an infinite-sites model, meaning each new mutation appears at a unique genomic site.\n\nA mutation that appears on a branch of the genealogy will be inherited by all sampled lineages that descend from that branch. A mutation is classified by its frequency in the sample. For instance, a 'singleton' is a mutation found in exactly one lineage, a 'doubleton' in two, and so on.\n\nA key result from coalescent theory states that the expected total length of all branches that are ancestral to exactly $j$ sampled lineages, denoted $E[L_j]$, is inversely proportional to $j$. Specifically, in standard coalescent time units, $E[L_j] = \\frac{2}{j}$ for $j = 1, 2, ..., n-1$.\n\nGiven a sample of $n=10$ gene lineages, what is the theoretical probability that a randomly chosen mutation from this sample is a singleton? Express your final answer as a fraction in simplest form.", "solution": "The problem asks for the probability that a randomly chosen mutation in a sample of size $n=10$ is a singleton.\nUnder the infinite-sites model of mutation, the number of mutations that accumulate on a branch of a gene genealogy is proportional to the length of that branch. Therefore, the probability that a randomly chosen mutation has a certain property (like being a singleton) is equal to the ratio of the total expected length of branches where such a mutation could arise, to the total expected length of the entire gene genealogy.\n\nLet $L_j$ be the total length of all branches in the genealogy that are ancestral to exactly $j$ of the sampled lineages.\nA singleton mutation is one that is found in exactly one lineage. For a mutation to be a singleton, it must occur on a branch that is ancestral to exactly one sample. Thus, singletons correspond to mutations on branches of type $L_1$.\nThe total set of observed mutations (also known as segregating sites) in the sample corresponds to mutations that occurred anywhere on the tree, affecting $j$ lineages where $j$ can range from $1$ to $n-1$. A mutation affecting all $n$ lineages would have occurred before the most recent common ancestor of the sample and would not be a polymorphic site *within* the sample.\nThe total length of the genealogy, $L_{total}$, is therefore the sum of the lengths of all branches ancestral to $j=1, 2, ..., n-1$ lineages:\n$$L_{total} = \\sum_{j=1}^{n-1} L_j$$\nThe probability of a random mutation being a singleton, $P(\\text{singleton})$, can be expressed as the ratio of expected branch lengths:\n$$P(\\text{singleton}) = \\frac{E[L_1]}{E[L_{total}]}$$\nThe problem provides the formula for the expected total length of branches ancestral to $j$ lineages:\n$$E[L_j] = \\frac{2}{j}$$\nUsing this formula, the numerator is the expected length for $j=1$:\n$$E[L_1] = \\frac{2}{1} = 2$$\nThe denominator is the expected total length of the tree, which is the sum of the expected lengths for all possible values of $j$:\n$$E[L_{total}] = \\sum_{j=1}^{n-1} E[L_j] = \\sum_{j=1}^{n-1} \\frac{2}{j} = 2 \\sum_{j=1}^{n-1} \\frac{1}{j}$$\nThe sum $\\sum_{j=1}^{k} \\frac{1}{j}$ is known as the $k$-th harmonic number, denoted $H_k$. So, $E[L_{total}] = 2 H_{n-1}$.\n\nNow we can write the probability in a general form for a sample of size $n$:\n$$P(\\text{singleton}) = \\frac{E[L_1]}{E[L_{total}]} = \\frac{2}{2 H_{n-1}} = \\frac{1}{H_{n-1}}$$\nThe problem specifies a sample size of $n=10$. We therefore need to calculate $H_9$:\n$$H_9 = \\sum_{j=1}^{9} \\frac{1}{j} = 1 + \\frac{1}{2} + \\frac{1}{3} + \\frac{1}{4} + \\frac{1}{5} + \\frac{1}{6} + \\frac{1}{7} + \\frac{1}{8} + \\frac{1}{9}$$\nTo sum these fractions, we find a common denominator, which is the least common multiple of the integers from 1 to 9. The prime factorization of the denominators' integers are: $2=2$, $3=3$, $4=2^2$, $5=5$, $6=2 \\cdot 3$, $7=7$, $8=2^3$, $9=3^2$. The least common multiple is $2^3 \\cdot 3^2 \\cdot 5 \\cdot 7 = 8 \\cdot 9 \\cdot 5 \\cdot 7 = 2520$.\nNow we express each term with this denominator:\n$$H_9 = \\frac{2520}{2520} + \\frac{1260}{2520} + \\frac{840}{2520} + \\frac{630}{2520} + \\frac{504}{2520} + \\frac{420}{2520} + \\frac{360}{2520} + \\frac{315}{2520} + \\frac{280}{2520}$$\nSumming the numerators:\n$2520 + 1260 + 840 + 630 + 504 + 420 + 360 + 315 + 280 = 7129$.\nSo, $H_9 = \\frac{7129}{2520}$. This fraction is in simplest form as 7129 is not divisible by 2, 3, 5, or 7.\nFinally, we can calculate the probability:\n$$P(\\text{singleton}) = \\frac{1}{H_9} = \\frac{1}{\\frac{7129}{2520}} = \\frac{2520}{7129}$$\nThis is the final answer, a fraction in simplest form.", "answer": "$$\\boxed{\\frac{2520}{7129}}$$", "id": "1931620"}]}