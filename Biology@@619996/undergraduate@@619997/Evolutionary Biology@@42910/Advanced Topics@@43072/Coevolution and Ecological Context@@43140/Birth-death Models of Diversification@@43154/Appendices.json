{"hands_on_practices": [{"introduction": "A fundamental, yet sometimes counterintuitive, aspect of macroevolution is the role of chance. Even when environmental conditions are favorable for a clade's growth, with speciation rates exceeding extinction rates, stochastic events can lead to the entire lineage's demise, especially when it is young and consists of few species. This exercise explores this core principle by asking you to calculate the ultimate probability of extinction for a new lineage, providing a quantitative grasp of the inherent risks in the diversification process [@problem_id:1911784].", "problem": "A team of evolutionary biologists is investigating the long-term fate of a new clade. The clade originates from a single founding species that colonizes a pristine, isolated continent. To model its diversification, they employ a simple continuous-time birth-death model.\n\nIn this model, the following rules apply:\n1.  The process starts with a single species at time $t=0$.\n2.  Each species present on the continent has a constant per-capita rate of speciation, $\\lambda$. Speciation is an event where one species splits into two distinct species.\n3.  Each species also has a constant per-capita rate of extinction, $\\mu$.\n4.  If there are $N$ species present at any given time, the total rate of speciation for the entire clade is $N\\lambda$, and the total rate of extinction is $N\\mu$.\n5.  The evolutionary fates of separate species are independent of one another.\n\nThe biologists are analyzing a scenario where environmental conditions are favorable for diversification, meaning the speciation rate is strictly greater than the extinction rate ($\\lambda > \\mu$). Even under these favorable conditions, it is possible for the entire clade to go extinct due to stochastic events, especially when the number of species is small.\n\nCalculate the probability that this entire clade, which starts from a single founding species, will eventually go extinct. Express your answer as a closed-form analytic expression in terms of $\\lambda$ and $\\mu$.", "solution": "Let $q$ denote the probability that the clade eventually goes extinct when starting from a single species. Consider a small time interval of length $\\mathrm{d}t$. In this interval, three disjoint events can occur for the single species:\n- With probability $\\lambda\\,\\mathrm{d}t + o(\\mathrm{d}t)$, a speciation event occurs, producing two descendant species. By the branching and independence assumptions, the two descendant lineages go extinct independently, so the extinction probability given this event is $q^{2}$.\n- With probability $\\mu\\,\\mathrm{d}t + o(\\mathrm{d}t)$, the species goes extinct, and thus the clade goes extinct with probability $1$.\n- With probability $1 - (\\lambda + \\mu)\\,\\mathrm{d}t + o(\\mathrm{d}t)$, no event occurs, and the extinction probability remains $q$.\n\nApplying the law of total probability and retaining terms to first order in $\\mathrm{d}t$ gives\n$$\nq \\,=\\, \\lambda\\,\\mathrm{d}t\\, q^{2} \\;+\\; \\mu\\,\\mathrm{d}t \\cdot 1 \\;+\\; \\bigl(1 - (\\lambda + \\mu)\\,\\mathrm{d}t\\bigr)\\, q \\;+\\; o(\\mathrm{d}t).\n$$\nSubtract $q$ from both sides, divide by $\\mathrm{d}t$, and take the limit as $\\mathrm{d}t \\to 0$ to obtain\n$$\n0 \\,=\\, \\lambda\\,(q^{2} - q) \\;+\\; \\mu\\,(1 - q).\n$$\nRearranging yields the quadratic equation\n$$\n\\lambda q^{2} - (\\lambda + \\mu) q + \\mu \\,=\\, 0.\n$$\nThis factors as\n$$\n(\\lambda q - \\mu)(q - 1) \\,=\\, 0,\n$$\nso the candidate solutions are $q = \\mu/\\lambda$ and $q = 1$. The extinction probability is the smallest root in $[0,1]$ consistent with the process. For a supercritical process with $\\lambda > \\mu$, we have $\\mu/\\lambda < 1$, and the extinction probability is\n$$\nq \\,=\\, \\frac{\\mu}{\\lambda}.\n$$\n(For completeness, when $\\lambda \\leq \\mu$, the only admissible root is $q = 1$.) Under the stated assumption $\\lambda > \\mu$, the required extinction probability is $\\mu/\\lambda$.", "answer": "$$\\boxed{\\frac{\\mu}{\\lambda}}$$", "id": "1911784"}, {"introduction": "Moving from pure theory to empirical science, we must confront the fact that multiple processes could explain the evolutionary history recorded in a phylogenetic tree. How do we choose between competing hypotheses, such as diversification proceeding at a constant rate versus a rate that slows as diversity increases? This practice introduces you to a powerful method for model selection, the Akaike Information Criterion (AIC), which allows us to quantitatively compare different birth-death models and determine which one provides the most parsimonious explanation for the observed data [@problem_id:1911781].", "problem": "An evolutionary biologist is investigating the diversification dynamics of a clade of deep-sea corals using a time-calibrated molecular phylogeny. To test competing hypotheses about the macroevolutionary processes at play, the biologist fits two different stochastic birth-death models to the branching times observed in the phylogeny.\n\nThe first model is a Constant-Rate Birth-Death (CR-BD) model. This model posits that the rate of speciation ($\\lambda$) and the rate of extinction ($\\mu$) are constant through time and across all lineages. As it estimates two parameters ($\\lambda$ and $\\mu$), this model has $k=2$ free parameters. After numerical optimization, the maximum log-likelihood for this model was found to be $\\ln(L_{\\text{CR-BD}}) = -152.8$.\n\nThe second model is a Diversity-Dependent Speciation (DDS) model. This model assumes that the extinction rate ($\\mu$) is constant, but the speciation rate declines linearly as the number of contemporary lineages, $N$, increases. The speciation rate is given by $\\lambda(N) = \\lambda_0 - \\alpha N$, where $\\lambda_0$ is the initial speciation rate and $\\alpha$ quantifies the strength of the diversity-dependence. This model has three free parameters ($\\lambda_0$, $\\alpha$, and $\\mu$), so $k=3$. The maximum log-likelihood for the DDS model was found to be $\\ln(L_{\\text{DDS}}) = -149.5$.\n\nTo compare the explanatory power of these two models while penalizing for the increased complexity of the DDS model, the biologist uses a model selection approach based on the Akaike Information Criterion (AIC). The AIC for a model is calculated using the formula:\n$$ \\text{AIC} = 2k - 2\\ln(L) $$\nwhere $k$ is the number of free parameters in the model and $\\ln(L)$ is the maximized log-likelihood. A lower AIC value indicates a better-fitting model.\n\nThe relative support for each model in a set can be expressed as an Akaike weight, $w_i$. To calculate this for a model $i$ from a set of $R$ candidate models, one first computes the difference between its AIC value and the minimum AIC value in the set: $\\Delta_i = \\text{AIC}_i - \\text{AIC}_{\\text{min}}$. The Akaike weight for model $i$ is then given by:\n$$ w_i = \\frac{\\exp(-\\frac{1}{2}\\Delta_i)}{\\sum_{j=1}^{R} \\exp(-\\frac{1}{2}\\Delta_j)} $$\nThe Akaike weight $w_i$ can be interpreted as the probability that model $i$ is the best model in the set, given the data.\n\nUsing the information provided, calculate the Akaike weight for the Diversity-Dependent Speciation (DDS) model. Round your final answer to three significant figures.", "solution": "We need to compare two models using the Akaike Information Criterion. By definition,\n$$ \\text{AIC} = 2k - 2\\ln(L). $$\n\nFor the CR-BD model with $k=2$ and $\\ln(L_{\\text{CR-BD}})=-152.8$,\n$$ \\text{AIC}_{\\text{CR-BD}} = 2\\cdot 2 - 2(-152.8) = 4 + 305.6 = 309.6. $$\n\nFor the DDS model with $k=3$ and $\\ln(L_{\\text{DDS}})=-149.5$,\n$$ \\text{AIC}_{\\text{DDS}} = 2\\cdot 3 - 2(-149.5) = 6 + 299.0 = 305.0. $$\n\nThe minimum AIC is $\\text{AIC}_{\\text{min}}=305.0$ (DDS). The AIC differences are\n$$ \\Delta_{\\text{DDS}} = 305.0 - 305.0 = 0, \\quad \\Delta_{\\text{CR-BD}} = 309.6 - 305.0 = 4.6. $$\n\nWith $R=2$ models, the Akaike weight of the DDS model is\n$$ w_{\\text{DDS}} = \\frac{\\exp\\!\\left(-\\frac{1}{2}\\Delta_{\\text{DDS}}\\right)}{\\exp\\!\\left(-\\frac{1}{2}\\Delta_{\\text{DDS}}\\right) + \\exp\\!\\left(-\\frac{1}{2}\\Delta_{\\text{CR-BD}}\\right)} = \\frac{1}{1 + \\exp\\!\\left(-\\frac{1}{2}\\cdot 4.6\\right)} = \\frac{1}{1 + \\exp(-2.3)}. $$\n\nNumerically, $\\exp(-2.3) \\approx 0.1002588435$, hence\n$$ w_{\\text{DDS}} \\approx \\frac{1}{1 + 0.1002588435} \\approx 0.908877. $$\n\nRounding to three significant figures gives $0.909$.", "answer": "$$\\boxed{0.909}$$", "id": "1911781"}, {"introduction": "After selecting the best-fitting model from a set of candidates, a crucial final step is to ask: is this model actually a good representation of reality? A model can be the \"best\" of a bad lot without truly capturing the dynamics that generated the data. This exercise demonstrates how to perform a goodness-of-fit test using computer simulations, a powerful technique to generate a null distribution and assess whether an observed feature of our data, such as tree imbalance, is statistically surprising under our chosen model [@problem_id:1911791].", "problem": "An evolutionary biologist is investigating the diversification dynamics of a particular clade comprising 10 extant species. A phylogenetic tree representing their evolutionary relationships has been reconstructed. The biologist wishes to assess whether the observed tree's shape is consistent with a simple model of constant-rate diversification (a birth-death process).\n\nTo do this, a specific measure of tree imbalance is calculated for the observed tree. This \"aggregate imbalance score\" is computed as follows: for each of the 9 internal nodes (branching points) of the tree, one calculates the absolute difference between the number of terminal species (tips) in the two subclades descending from that node. The aggregate imbalance score for the entire tree is the sum of these absolute differences over all internal nodes.\n\nThe partition of species at each of the 9 internal nodes for the observed empirical tree is given by the following pairs, where each pair $(N_L, N_R)$ represents the number of species in the left and right descending subclades, respectively:\n\n(1, 9), (1, 8), (1, 7), (1, 6), (1, 5), (1, 4), (1, 3), (1, 2), (1, 1)\n\nTo determine if the observed tree's imbalance is unusual, the biologist's research group ran a large number of simulations. They generated 2000 distinct phylogenetic trees, each with 10 species, assuming the constant-rate birth-death model that they hypothesize governs the clade's evolution. For each of these 2000 simulated trees, they calculated the same aggregate imbalance score. Their analysis revealed that 82 of these simulated trees had an aggregate imbalance score greater than or equal to the score calculated from the observed empirical tree.\n\nBased on this information, calculate the statistical p-value. The p-value represents the probability of observing a tree as imbalanced as, or more imbalanced than, the empirical tree, under the null hypothesis that the clade evolved according to the simulated constant-rate birth-death process. Express your answer as a decimal rounded to three significant figures.", "solution": "Define the aggregate imbalance score for a rooted binary tree with 9 internal nodes as\n$$\nS=\\sum_{j=1}^{9}\\left|N_{L,j}-N_{R,j}\\right|,\n$$\nwhere $N_{L,j}$ and $N_{R,j}$ are the numbers of tips in the left and right descendant subclades at internal node $j$. For the observed tree, the given pairs are $(1,9),(1,8),(1,7),(1,6),(1,5),(1,4),(1,3),(1,2),(1,1)$, so the absolute differences are $8,7,6,5,4,3,2,1,0$, which sum to\n$$\nS_{\\text{obs}}=8+7+6+5+4+3+2+1+0=36.\n$$\nTo assess significance under the null hypothesis (constant-rate birth-death process), use a Monte Carlo p-value based on simulated trees. If $M$ simulated trees are generated and $k$ of them have $S^{(i)}\\geq S_{\\text{obs}}$, then the Monte Carlo estimate of the upper-tail p-value is\n$$\n\\hat{p}=\\frac{k}{M}.\n$$\nHere, $M=2000$ and $k=82$, so\n$$\n\\hat{p}=\\frac{82}{2000}=\\frac{41}{1000}=0.041.\n$$\nRounded to three significant figures, this is $0.0410$.", "answer": "$$\\boxed{0.0410}$$", "id": "1911791"}]}