{"hands_on_practices": [{"introduction": "Bootstrap analysis is fundamentally a measure of the consistency of the phylogenetic signal within your data. This first practice explores a core principle: what happens to our confidence in a tree when we add more data that tells a congruent evolutionary story? By considering this hypothetical scenario ([@problem_id:1912092]), you will develop a clear intuition for why longer alignments with consistent signal generally lead to more robust and highly supported phylogenetic conclusions.", "problem": "An evolutionary biology student is studying the phylogenetic relationships among a group of insect species. They start with a multiple sequence alignment of a specific gene, with a total length of $L$ characters (sites). From this alignment, they infer a phylogenetic tree and assess the statistical robustness of its internal branches using a standard non-parametric bootstrap procedure. This procedure involves generating many resampled datasets (pseudo-replicates) by sampling the columns of the original alignment with replacement, and the bootstrap support for a given branch is the percentage of times that branch is recovered in the trees built from the pseudo-replicates.\n\nThe student then sequences a second, different gene from the same set of species. This new gene alignment also has a length of $L$ characters. When analyzed independently, the second gene yields a phylogenetic tree with the exact same branching order (topology) as the tree from the first gene. The student decides to combine the two alignments into a single, concatenated alignment of total length $2L$. They then re-run the bootstrap analysis on this new, larger alignment.\n\nAssuming the phylogenetic signal in the second gene is perfectly congruent with the first (as suggested by them producing the same tree topology), which of the following outcomes is the most likely effect on the bootstrap support values for the branches of the inferred tree?\n\nA. The bootstrap support values will, on average, significantly increase.\n\nB. The bootstrap support values will, on average, significantly decrease.\n\nC. The bootstrap support values will remain, on average, approximately the same.\n\nD. Some bootstrap support values will increase while others will decrease, with no clear average trend.\n\nE. The bootstrap support values will all tend to converge towards 50%.", "solution": "We model the non-parametric bootstrap for a given internal branch as follows. Consider a branch $b$ that is recovered by the inference method from the original alignment of length $L$. For each site $i$, define a random variable $Y_{i}$ representing the per-site evidence in favor of branch $b$ against the nearest competing alternative. Under the assumption that the two genes are independent and have perfectly congruent phylogenetic signal (they yield the same topology), the sites can be regarded as independent and identically distributed draws from a common sitewise evidence distribution with mean $\\mu = \\mathbb{E}[Y_{i}]$ and variance $\\sigma^{2} = \\operatorname{Var}(Y_{i})$, where $\\mu > 0$ for branches that are truly supported by the data-generating process. \n\nFor an alignment of $n$ sites, define the total evidence\n$$\nT_{n} = \\sum_{i=1}^{n} Y_{i}.\n$$\nThen $\\mathbb{E}[T_{n}] = n \\mu$ and $\\operatorname{Var}(T_{n}) = n \\sigma^{2}$. A standard large-sample approximation connects the probability that the inference procedure recovers branch $b$ in a dataset of size $n$ to the event $T_{n} > 0$, yielding that the recovery probability is approximately\n$$\nP_{n} \\approx \\mathbb{P}(T_{n} > 0).\n$$\nBy the central limit theorem, \n$$\n\\frac{T_{n} - n \\mu}{\\sigma \\sqrt{n}} \\xrightarrow{d} \\mathcal{N}(0,1),\n$$\nso for large $n$,\n$$\n\\mathbb{P}(T_{n} > 0) = \\mathbb{P}\\!\\left(\\frac{T_{n} - n \\mu}{\\sigma \\sqrt{n}} > \\frac{-n \\mu}{\\sigma \\sqrt{n}}\\right) \\approx \\Phi\\!\\left(\\frac{\\mu \\sqrt{n}}{\\sigma}\\right),\n$$\nwhere $\\Phi$ is the standard normal cumulative distribution function. Since $\\mu > 0$, the argument $\\mu \\sqrt{n}/\\sigma$ increases with $n$, implying that $\\mathbb{P}(T_{n} > 0)$ is an increasing function of $n$ and approaches $1$ as $n \\to \\infty$. \n\nThe non-parametric bootstrap proportion for branch $b$ is an estimate of the probability that $b$ is recovered in replicate datasets of the same size generated by resampling sites with replacement from the empirical distribution. Thus, when the alignment length increases from $L$ to $2L$, and the second gene provides perfectly congruent signal (so $\\mu$ and $\\sigma^{2}$ per site remain the same while $n$ doubles), the signal-to-noise ratio increases from $\\mu \\sqrt{L}/\\sigma$ to $\\mu \\sqrt{2L}/\\sigma$. Consequently, the recovery probability increases:\n$$\n\\Phi\\!\\left(\\frac{\\mu \\sqrt{2L}}{\\sigma}\\right) > \\Phi\\!\\left(\\frac{\\mu \\sqrt{L}}{\\sigma}\\right).\n$$\nTherefore, the expected bootstrap support values for branches that are supported by the true signal will, on average, increase when concatenating two congruent genes of equal length.\n\nA complementary Bernoulli simplification yields the same conclusion. Suppose each site supports branch $b$ with probability $p$ and conflicts with probability $q = 1 - p$, with $p > \\frac{1}{2}$. Let $S_{n} \\sim \\mathrm{Binomial}(n, p)$ be the number of supporting sites. A crude decision rule recovers $b$ when $S_{n} > \\frac{n}{2}$. Then\n$$\n\\mathbb{P}\\!\\left(S_{n} \\le \\frac{n}{2}\\right) \\le \\exp\\!\\left(-n D\\!\\left(\\frac{1}{2} \\,\\|\\, p\\right)\\right),\n$$\nwhere $D(\\cdot \\,\\|\\, \\cdot)$ is the Kullback–Leibler divergence. This upper bound decreases exponentially in $n$, so the recovery probability increases with $n$. Doubling $n$ from $L$ to $2L$ increases the probability that the branch is recovered, aligning with higher bootstrap proportions. \n\nBecause the second gene’s topology is identical to the first (perfect congruence), the added sites contribute consistent signal without introducing conflict, so the average effect across branches is an increase in bootstrap support. Therefore, the most likely outcome is that the bootstrap support values will, on average, significantly increase.", "answer": "$$\\boxed{A}$$", "id": "1912092"}, {"introduction": "Real-world datasets are rarely perfect; they often contain a mixture of strong, clear signals and noisy, conflicting information. This practice presents a classic diagnostic challenge: interpreting a tree where a recent branching event is strongly supported, but a deeper one is weak ([@problem_id:1912038]). Working through this problem will sharpen your ability to infer the underlying data patterns, distinguishing between regions of your alignment that provide consistent evidence and those that suggest alternative evolutionary histories.", "problem": "An evolutionary biologist is studying the phylogenetic relationships among four species, designated A, B, C, and D, using a Deoxyribonucleic Acid (DNA) sequence alignment consisting of 1000 nucleotide sites. A phylogenetic analysis using the maximum likelihood method recovers a single best-fit tree with the topology (A, (B, (C, D))). To assess the statistical confidence in this tree structure, a bootstrap analysis with 1000 replicates is performed. The results show that the node defining the clade (C, D) has a bootstrap support value of 98%, while the node defining the clade (B, (C, D)) has a bootstrap support value of only 55%.\n\nWhich of the following character patterns in the underlying 1000-site DNA alignment provides the most plausible data-driven explanation for this specific combination of high and low bootstrap support values?\n\nA. The vast majority of the 1000 sites are identical across all four species, with informative phylogenetic signal present at only a handful of sites.\n\nB. There is a large number of phylogenetically informative sites that unambiguously support the (C, D) clade, and a separate, large number of informative sites that unambiguously support the (B, (C, D)) clade.\n\nC. There is a strong and consistent phylogenetic signal for the (C, D) clade across many sites. However, for the placement of taxon B, the remaining informative sites show nearly equal support for two conflicting hypotheses: B grouping with (C, D), and B grouping with A.\n\nD. The branch leading to taxon B is extremely long compared to the others, indicating a rapid rate of evolution. This has caused a large number of unique mutations in B that are phylogenetically uninformative for this four-taxon problem and thus do not contribute to resolving its position.\n\nE. All phylogenetically informative sites in the alignment are congruent and support the topology (A, (B, (C, D))), but the total number of such informative sites is very small.", "solution": "We interpret nonparametric bootstrap support as the proportion of resampled alignments (columns resampled with replacement from the original $1000$ sites) that recover a given clade under the same inference method. Thus, a value of $0.98$ for the clade $(C,D)$ indicates that in approximately $0.98 \\times 1000$ replicates the analysis recovered $(C,D)$, which requires many sites to contain a consistent, low-conflict signal for the split separating $\\{C,D\\}$ from $\\{A,B\\}$. Conversely, a value of $0.55$ for the clade $(B,(C,D))$ indicates that only about $0.55 \\times 1000$ replicates recovered that grouping; hence, there is weak overall support for the placement of $B$ relative to $A$ and the $(C,D)$ clade, implying either limited information or substantial conflicting signal among sites about whether $B$ groups with $(C,D)$ or with $A$.\n\nFor four taxa, a site is phylogenetically informative if it supports one of the three possible splits. The high support for $(C,D)$ implies many informative sites consistently supporting the split $\\{C,D\\}|\\{A,B\\}$. The low support for $(B,(C,D))$ implies that, conditional on the strong $(C,D)$ signal, the remaining informative sites relevant to placing $B$ exhibit near-balanced support between the two alternatives: $B$ with $(C,D)$ versus $B$ with $A$. If the latter supports are nearly equal, bootstrap resamples will fluctuate around a proportion near one-half, consistent with $0.55$.\n\nEvaluate the options against these implications:\n- Option A posits that only a handful of sites are informative. With so few informative sites, bootstrap resampling would frequently omit them, typically producing uniformly low support for all internal nodes. Obtaining $0.98$ for $(C,D)$ would be unlikely under this pattern, so A is implausible.\n- Option B posits a large number of informative sites unambiguously supporting both $(C,D)$ and $(B,(C,D))$. That would produce high support for both nodes, contradicting the observed $0.55$, so B is implausible.\n- Option C posits strong, consistent signal for $(C,D)$ across many sites, and nearly equal support for the two conflicting placements of $B$. This directly explains high support for $(C,D)$ and low, near-half support for $(B,(C,D))$, matching the observed $0.98$ and $0.55$. This is the most plausible data pattern.\n- Option D posits many autapomorphies on the $B$ branch that are uninformative. While this could reduce information about $B$’s placement, uninformative changes do not generate conflicting support; they merely dilute signal. In a purely low-information scenario for $B$, bootstrap support would tend toward about one-half among the two alternatives conditional on $(C,D)$, but this option does not posit the strong, consistent $(C,D)$ signal nor the explicit near-equal conflict needed to explain $0.55$ as opposed to a more diffuse outcome. It is less precise than C as a data-pattern explanation.\n- Option E posits few but fully congruent informative sites supporting the entire topology. With very few such sites, bootstrap resampling would tend to yield low support for both internal nodes, not a split of $0.98$ versus $0.55$, so E is implausible.\n\nTherefore, the character pattern most consistent with the observed bootstrap values is the one in Option C.", "answer": "$$\\boxed{C}$$", "id": "1912038"}, {"introduction": "Having learned to conceptually diagnose conflicting signals, our final practice offers a quantitative method to pinpoint the source of this conflict. This exercise guides you through a procedure to calculate a \"Site Conflict Score\" by dissecting the composition of individual bootstrap replicates ([@problem_id:1912106]). This hands-on calculation simulates a powerful data-exploration technique used by evolutionary biologists to understand precisely why certain nodes in a phylogeny receive low support, turning a vague sense of uncertainty into a specific, testable hypothesis about the data.", "problem": "An evolutionary biologist is investigating the phylogenetic relationships among three closely related species, A, B, and C, using a fourth species, D, as an outgroup. A preliminary phylogenetic analysis of a 10-site nucleotide alignment produced a tree where the clade grouping species A and B together, represented by the ingroup topology ((A,B),C), received a low bootstrap support value. This suggests the presence of conflicting signals within the alignment data.\n\nTo identify which specific sites in the alignment are contributing to this conflict, the biologist performs a detailed analysis of the bootstrap replicates. The results of a 10-replicate bootstrap procedure are summarized in the table below. Each replicate dataset was generated by sampling 10 sites with replacement from the original 10-site alignment. For each replicate, the inferred relationship among the ingroup taxa is listed.\n\n| Replicate ($k$) | Sampled Site Indices | Inferred Ingroup Topology |\n|:---:|:---|:---|\n| 1 | {1, 5, 8, 2, 9, 1, 10, 1, 6, 3} | ((A,B),C) |\n| 2 | {5, 6, 7, 5, 5, 8, 1, 9, 10, 5} | ((A,C),B) |\n| 3 | {8, 9, 10, 1, 2, 8, 9, 5, 8, 9} | ((B,C),A) |\n| 4 | {1, 2, 3, 4, 1, 2, 8, 5, 9, 6} | ((A,B),C) |\n| 5 | {7, 7, 6, 5, 10, 10, 9, 8, 1, 1} | ((B,C),A) |\n| 6 | {5, 6, 7, 8, 9, 10, 5, 6, 7, 1} | ((A,C),B) |\n| 7 | {1, 1, 2, 3, 4, 4, 5, 8, 5, 9} | ((A,B),C) |\n| 8 | {10, 9, 8, 7, 6, 5, 4, 3, 2, 1} | ((A,B),C) |\n| 9 | {10, 10, 8, 7, 7, 7, 5, 5, 1, 2} | ((A,C),B) |\n| 10| {9, 8, 5, 6, 7, 1, 2, 3, 4, 10} | ((B,C),A) |\n\nTo quantify the conflicting signal from each site, a \"Site Conflict Score\" ($S_i$) for each original site $i$ (where $i \\in \\{1, 2, ..., 10\\}$) is defined. Let $T_{AB}$ be the set of replicate indices that support the topology ((A,B),C), and let $T_{\\neg AB}$ be the set of replicate indices supporting any other conflicting topology. For a given site $i$, let $N_{i,k}$ be the number of times site $i$ appears in the $k$-th replicate's list of sampled indices. The average count of site $i$ in replicates supporting the target clade is $\\bar{N}_{i, AB} = \\frac{1}{|T_{AB}|} \\sum_{k \\in T_{AB}} N_{i,k}$, and the average count in replicates supporting conflicting clades is $\\bar{N}_{i, \\neg AB} = \\frac{1}{|T_{\\neg AB}|} \\sum_{k \\in T_{\\neg AB}} N_{i,k}$.\n\nThe Site Conflict Score is defined as $S_i = \\bar{N}_{i, \\neg AB} - \\bar{N}_{i, AB}$. A higher positive score indicates that a site is more frequently sampled in replicates that contradict the ((A,B),C) grouping.\n\nCalculate the Site Conflict Score, $S_5$, for site 5. Round your final answer to three significant figures.", "solution": "We identify the replicate sets by their inferred ingroup topology. From the table, $T_{AB}=\\{1,4,7,8\\}$ supports $((A,B),C)$ and $T_{\\neg AB}=\\{2,3,5,6,9,10\\}$ supports the conflicting topologies. For site $i=5$, compute $N_{5,k}$, the number of times site $5$ appears in replicate $k$:\n$N_{5,1}=1$, $N_{5,2}=4$, $N_{5,3}=1$, $N_{5,4}=1$, $N_{5,5}=1$, $N_{5,6}=2$, $N_{5,7}=2$, $N_{5,8}=1$, $N_{5,9}=2$, $N_{5,10}=1$.\n\nThe average count in the supporting set is\n$$\n\\bar{N}_{5,AB}=\\frac{1}{|T_{AB}|}\\sum_{k\\in T_{AB}}N_{5,k}=\\frac{1}{4}(N_{5,1}+N_{5,4}+N_{5,7}+N_{5,8})=\\frac{1}{4}(1+1+2+1)=\\frac{5}{4}.\n$$\nThe average count in the conflicting set is\n$$\n\\bar{N}_{5,\\neg AB}=\\frac{1}{|T_{\\neg AB}|}\\sum_{k\\in T_{\\neg AB}}N_{5,k}=\\frac{1}{6}(N_{5,2}+N_{5,3}+N_{5,5}+N_{5,6}+N_{5,9}+N_{5,10})=\\frac{1}{6}(4+1+1+2+2+1)=\\frac{11}{6}.\n$$\nTherefore the Site Conflict Score is\n$$\nS_{5}=\\bar{N}_{5,\\neg AB}-\\bar{N}_{5,AB}=\\frac{11}{6}-\\frac{5}{4}=\\frac{22-15}{12}=\\frac{7}{12}\\approx 0.583333\\ldots\n$$\nRounded to three significant figures, this is $0.583$.", "answer": "$$\\boxed{0.583}$$", "id": "1912106"}]}