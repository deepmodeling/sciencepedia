{"hands_on_practices": [{"introduction": "A core task in Bayesian phylogenetics is to translate the output of a Markov Chain Monte Carlo (MCMC) simulation into meaningful measures of confidence. The MCMC process samples thousands of possible trees, and their frequency in the sample reflects their probability. This exercise will guide you through the fundamental practice of calculating the posterior probability of a clade—a group of species descended from a common ancestor—by determining how often it appears in the MCMC sample. [@problem_id:1911287]", "problem": "An evolutionary biologist is investigating the phylogenetic relationships among three newly discovered species of extremophilic archaea, designated Species A, Species B, and Species C. To infer their evolutionary history, she analyzes their ribosomal RNA gene sequences using a Bayesian inference framework. The analysis involves a Markov Chain Monte Carlo (MCMC) simulation, which samples phylogenetic trees from the posterior probability distribution.\n\nAfter the MCMC simulation converges, a total of 3,000 trees are retained from the posterior distribution. The summary of the sampled tree topologies is as follows:\n- The topology where Species A and Species B are each other's closest relatives, represented as `((A,B),C)`, appears 2,150 times.\n- The topology where Species A and Species C are each other's closest relatives, represented as `((A,C),B)`, appears 600 times.\n- The topology where Species B and Species C are each other's closest relatives, represented as `((B,C),A)`, appears 250 times.\n\nBased on this MCMC sample, what is the posterior probability of the clade that includes Species A and Species B, but excludes Species C? Express your answer as a decimal rounded to three significant figures.", "solution": "In Bayesian phylogenetic inference using MCMC, the posterior probability of a clade is estimated by its frequency among the sampled posterior trees. For the clade containing Species A and Species B and excluding Species C, this clade is present exactly in the topology $((A,B),C)$. The MCMC sample contains $2150$ instances of this topology out of a total of $3000$ trees. Therefore, the estimated posterior probability is\n$$\np(\\text{clade }\\{A,B\\})=\\frac{2150}{3000}=\\frac{43}{60}.\n$$\nConverting to a decimal and rounding to three significant figures,\n$$\n\\frac{43}{60}=0.716\\overline{6}\\approx 0.717.\n$$", "answer": "$$\\boxed{0.717}$$", "id": "1911287"}, {"introduction": "Before you can confidently interpret your phylogenetic results, you must ensure your MCMC simulation has converged on a stable posterior distribution. A critical step in any robust analysis is to perform multiple independent runs and verify that they yield consistent results. This practice explores a powerful and standard graphical method for diagnosing convergence, allowing you to visually assess whether two runs agree on the posterior probabilities for all clades. [@problem_id:1911269]", "problem": "An evolutionary biologist is investigating the phylogenetic relationships among a newly discovered group of extremophilic bacteria. To do this, they have collected DNA sequence data and are using a Bayesian inference approach. The analysis involves a computational method called a Markov Chain Monte Carlo (MCMC) simulation to explore the vast space of possible phylogenetic trees and their associated parameters. To ensure the results are robust, the biologist runs two completely independent MCMC simulations starting from different random trees. Each run generates a large sample of trees, from which the posterior probability of each distinct clade (a group consisting of an ancestor and all its descendants) can be estimated.\n\nBefore combining the results from the two runs to make a final conclusion about the bacterial relationships, the biologist must verify that the two simulations have converged on the same posterior distribution. A failure to converge would suggest that the MCMC search was incomplete, and the results are not reliable.\n\nWhich of the following graphical methods provides the most direct and comprehensive assessment of whether the posterior probability estimates for all clades are consistent between the two independent runs?\n\nA. Plotting the logarithm of the likelihood score against the generation number for each of the two runs and visually inspecting if both plots reach a stable plateau.\n\nB. Creating a single histogram of the branch lengths sampled from the combined posterior distribution of trees from both runs.\n\nC. Generating a scatter plot where each point corresponds to a specific clade, with its x-coordinate being the posterior probability from the first run and its y-coordinate being the posterior probability from the second run.\n\nD. Constructing the consensus tree from each run separately and checking if the topologies are identical.", "solution": "We seek a graphical method that directly and comprehensively assesses whether posterior probability estimates for all clades are consistent between two independent MCMC runs. Let the set of all distinct clades observed across both runs be indexed by $i$, and let $p_{i}^{(1)}$ and $p_{i}^{(2)}$ denote the estimated posterior probabilities of clade $i$ from runs 1 and 2, respectively. Convergence in the sense of producing the same posterior distribution across runs implies $p_{i}^{(1)} \\approx p_{i}^{(2)}$ for all $i$. A graphical method that plots the pairs $\\left(p_{i}^{(1)},p_{i}^{(2)}\\right)$ directly tests this equality; points should fall near the line $y=x$ if the runs agree for all clades, and deviations immediately reveal inconsistencies.\n\nEvaluating the options:\n- Option A (trace of the logarithm of the likelihood versus generation): A stable plateau indicates apparent stationarity within each chain, but equal or stable likelihoods do not guarantee that the two runs have sampled the same posterior over tree space or that clade posterior probabilities match. It is indirect and not comprehensive for clade-wise agreement.\n- Option B (single histogram of combined branch lengths): Combining runs masks between-run differences and does not address clade posterior probabilities. It is neither a cross-run comparison nor clade-focused.\n- Option C (scatter plot of clade posterior probabilities from the two runs): For each clade $i$, plotting $\\left(p_{i}^{(1)},p_{i}^{(2)}\\right)$ directly evaluates agreement across all clades. Points near $y=x$ indicate consistency; outliers identify specific clades with discrepancies. Clades present in only one run can be represented with a zero in the other run, preserving comprehensiveness.\n- Option D (compare consensus topologies): Identical consensus topologies can occur even when many clade probabilities differ substantially, because consensus trees threshold support and discard quantitative differences. This method is not sufficiently sensitive or comprehensive.\n\nTherefore, the scatter plot of clade posterior probabilities across runs (Option C) provides the most direct and comprehensive assessment of agreement.", "answer": "$$\\boxed{C}$$", "id": "1911269"}, {"introduction": "Beyond simply reconstructing evolutionary trees, the Bayesian framework provides a powerful way to test competing evolutionary hypotheses, which are often formulated as distinct statistical models. This exercise demonstrates how to perform model selection by calculating a Bayes factor from the marginal likelihoods of two different molecular clock models. Learning to use Bayes factors will enable you to quantitatively assess the evidence and make informed conclusions about the evolutionary processes that have shaped life's history. [@problem_id:1911261]", "problem": "An evolutionary biologist is investigating the tempo of molecular evolution in a newly discovered clade of extremophilic archaea. Using DNA sequences from a conserved gene, the biologist aims to compare two competing models for the rate of evolution across the phylogeny. The first model, a strict molecular clock ($M_S$), hypothesizes that the rate of nucleotide substitution is constant across all branches of the evolutionary tree. The second model, an uncorrelated relaxed clock ($M_R$), posits that each branch has its own evolutionary rate drawn independently from a shared underlying distribution.\n\nTo formally compare these two models in a Bayesian framework, the biologist calculates the marginal likelihood of the data under each model using a computationally intensive method. The analysis yields a marginal log-likelihood for the strict clock model, $\\ln[P(\\text{Data}|M_S)] = -15,820.5$, and a marginal log-likelihood for the relaxed clock model, $\\ln[P(\\text{Data}|M_R)] = -15,808.5$.\n\nYour task is twofold:\n1.  Calculate the value of $2\\ln(BF_{RS})$, where $BF_{RS}$ is the Bayes factor comparing the relaxed clock model ($M_R$) to the strict clock model ($M_S$).\n2.  Based on your calculation and the standard interpretation scale provided below for the value of $2\\ln(BF)$, determine the strength of evidence supporting the preferred model.\n\n**Interpretation Scale for $2\\ln(BF)$:**\n- $0 < 2\\ln(BF) \\leq 2$: Evidence is not worth more than a bare mention.\n- $2 < 2\\ln(BF) \\leq 6$: Positive evidence.\n- $6 < 2\\ln(BF) \\leq 10$: Strong evidence.\n- $2\\ln(BF) > 10$: Very strong evidence.\n\nSelect the option that correctly provides the calculated value and the corresponding interpretation.\n\nA. $24$; Strong evidence.\n\nB. $12$; Positive evidence.\n\nC. $-24$; Evidence strongly favors the strict clock model.\n\nD. $24$; Very strong evidence.\n\nE. $12$; Very strong evidence.", "solution": "Define the Bayes factor comparing the relaxed clock model to the strict clock model as\n$$\nBF_{RS}=\\frac{P(\\text{Data}\\mid M_{R})}{P(\\text{Data}\\mid M_{S})}.\n$$\nTaking natural logarithms gives\n$$\n\\ln(BF_{RS})=\\ln\\!\\big[P(\\text{Data}\\mid M_{R})\\big]-\\ln\\!\\big[P(\\text{Data}\\mid M_{S})\\big].\n$$\nUsing the given marginal log-likelihoods,\n$$\n\\ln(BF_{RS})=\\left(-15808.5\\right)-\\left(-15820.5\\right)=12.\n$$\nTherefore,\n$$\n2\\ln(BF_{RS})=2\\times 12=24.\n$$\nSince $2\\ln(BF_{RS})=24$ and the interpretation scale states that values greater than $10$ indicate very strong evidence, the data provide very strong evidence in favor of the relaxed clock model $M_{R}$ over the strict clock model $M_{S}$. The correct option is the one reporting $24$ and very strong evidence.", "answer": "$$\\boxed{D}$$", "id": "1911261"}]}