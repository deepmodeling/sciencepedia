{"hands_on_practices": [{"introduction": "Theoretical concepts in phylogenetics are best understood through application. This first exercise explores a foundational principle of maximum likelihood analysis: the importance of model selection. We will use a hypothetical scenario to examine what happens when the chosen model of evolution, in this case, the simple Jukes-Cantor model, does not match the actual evolutionary process of the DNA sequence, which is a common challenge with real biological data. This practice highlights how model misspecification can introduce systematic errors into our evolutionary inferences, particularly in the estimation of branch lengths [@problem_id:1946228].", "problem": "A researcher is conducting a phylogenetic analysis on a group of closely related insect species. They have sequenced a segment of a mitochondrial gene, which is known from prior studies to evolve with a strong substitution bias: transitions (substitutions between purines, A↔G, or between pyrimidines, C↔T) occur at a much higher rate than transversions (substitutions between a purine and a pyrimidine).\n\nFor the analysis, the researcher uses a maximum likelihood method based on the Jukes-Cantor (JC69) model of nucleotide evolution. The JC69 model is the simplest substitution model, and it is founded on the core assumption that every type of nucleotide substitution occurs with the exact same probability and rate.\n\nGiven this significant mismatch between the known evolutionary process of the gene and the simplifying assumptions of the selected model, which of the following statements best describes the most likely systematic error that will affect the branch lengths of the inferred phylogenetic tree?\n\nA. The branch lengths will be systematically overestimated, especially for longer branches, as the model overcorrects for the apparent high frequency of changes.\n\nB. The branch lengths will be systematically underestimated, especially for longer branches, because the model fails to adequately correct for multiple unobserved substitutions (saturation) that occur due to the high transition rate.\n\nC. The choice of substitution model will primarily alter the branching order (topology) of the tree and will have a negligible, non-systematic effect on the estimated branch lengths.\n\nD. The model mismatch will not introduce any systematic error into the branch length estimations, although it may decrease the statistical support (e.g., bootstrap values) for certain nodes in the tree.\n\nE. The branch lengths will be accurate for parts of the sequence that have undergone transversions but will be underestimated for parts that have undergone transitions, leading to an internally inconsistent estimate of time.", "solution": "We proceed by explicitly stating the model assumption, the likelihood-based distance mapping under the Jukes-Cantor model, and how a strong transition bias alters the relationship between the observed fraction of differences and the true expected number of substitutions, thereby inducing a systematic error in branch length estimation.\n\n1) Under the JC69 model, all substitutions have the same instantaneous rate. With rate parameter $\\alpha$ for any off-diagonal entry, the transition probabilities over time $t$ are\n$$\nP_{ii}(t)=\\frac{1}{4}+\\frac{3}{4}\\exp\\!\\left(-4\\alpha t\\right),\\qquad\nP_{ij}(t)=\\frac{1}{4}-\\frac{1}{4}\\exp\\!\\left(-4\\alpha t\\right)\\quad(i\\neq j).\n$$\nAggregating across sites and nucleotides under stationarity, the expected observed fraction of differences $p$ after time $t$ is\n$$\np_{\\text{JC}}(t)=\\frac{3}{4}\\left(1-\\exp\\!\\left(-4\\alpha t\\right)\\right).\n$$\nInverting this monotone relationship gives the JC69 correction (expected substitutions per site, i.e., branch length in JC units):\n$$\nd_{\\text{JC}}(p)=-\\frac{3}{4}\\ln\\!\\left(1-\\frac{4}{3}p\\right).\n$$\n\n2) The biological process described has a strong transition bias: transitions occur at a much higher rate than transversions. In more realistic models that accommodate this (e.g., K80/HKY), transitions accumulate faster and undergo multiple hits sooner. As divergence increases, multiple unobserved substitutions (especially recurrent transitions and back transitions) increasingly mask true changes, depressing the observable $p$ below what would be expected under an equal-rates process at the same true expected number of substitutions.\n\nFormally, let $d_{\\text{true}}$ denote the true expected substitutions per site under a transition-biased process, and let $p_{\\text{bias}}(d_{\\text{true}})$ be the observable fraction of differences produced by that process. Because transitions saturate more rapidly, for sufficiently large $d_{\\text{true}}$ one has\n$$\np_{\\text{bias}}(d_{\\text{true}})<p_{\\text{JC}}(d_{\\text{true}}).\n$$\nSince $d_{\\text{JC}}(p)$ is strictly increasing in $p$, feeding the depressed $p_{\\text{bias}}$ into the JC correction yields\n$$\n\\widehat{d}_{\\text{JC}}=d_{\\text{JC}}\\!\\left(p_{\\text{bias}}(d_{\\text{true}})\\right)\n<\nd_{\\text{JC}}\\!\\left(p_{\\text{JC}}(d_{\\text{true}})\\right)\n=\nd_{\\text{true}}.\n$$\nThus, branch lengths estimated under JC for data generated by a strongly transition-biased process will be systematically underestimated. The magnitude of the underestimation increases with divergence, because multiple unobserved substitutions (saturation) are more frequent on longer branches.\n\n3) Evaluating the options:\n- A is incorrect: overestimation would require the model to overcorrect for multiple hits; here it undercorrects because excess transitions cause more hidden changes than JC anticipates.\n- B is correct: branch lengths are systematically underestimated, especially for longer branches, due to inadequate correction for multiple unobserved substitutions driven by the high transition rate.\n- C is incorrect: while model choice can affect topology, the dominant systematic effect discussed here is on branch length estimation.\n- D is incorrect: the model mismatch does introduce systematic bias in branch lengths.\n- E is misleading: ML under JC does not yield internally partitioned time estimates by change type; the global branch length will be biased downward overall rather than accurate for transversions but not for transitions.\n\nTherefore, the best description of the systematic error is underestimation of branch lengths, especially for longer branches.", "answer": "$$\\boxed{B}$$", "id": "1946228"}, {"introduction": "Having established that the choice of model is critical, we now explore a scenario where maximum likelihood's sophistication truly shines. This thought experiment delves into the classic problem of long-branch attraction, a notorious pitfall that can cause simpler methods like maximum parsimony to infer an incorrect tree. By comparing the expected outcomes of both methods, you'll gain an appreciation for why the statistical framework of ML, which can account for varying evolutionary rates across a tree, is often more robust and reliable for untangling complex evolutionary histories [@problem_id:1946247].", "problem": "An evolutionary biologist is studying the phylogenetic relationships among four extant species: A, B, C, and D. For the sake of this problem, assume the true evolutionary history is represented by the unrooted topology `((A,B),(C,D))`, where A and B are sister species, and C and D are sister species. The molecular data reveals an unusual evolutionary pattern: the lineages leading to species A and C have experienced a greatly accelerated rate of nucleotide substitution compared to the lineages leading to species B and D, which have evolved much more slowly.\n\nThe biologist aligns a DNA sequence from a homologous gene for all four species. The analysis of phylogenetically informative sites in the alignment reveals two main patterns:\n1.  **Class 1 sites**: At these sites, species A and B share one nucleotide, while species C and D share a different nucleotide (e.g., A=G, B=G, C=T, D=T). These sites support the true topology.\n2.  **Class 2 sites**: At these sites, species A and C share one nucleotide, while species B and D share a different nucleotide (e.g., A=A, C=A, B=C, D=C). These sites are the result of convergent or parallel substitutions on the fast-evolving branches.\n\nDue to the high substitution rate on the long branches leading to A and C, the number of Class 2 sites is significantly greater than the number of Class 1 sites.\n\nThe biologist decides to reconstruct the phylogeny using two different methods: maximum parsimony (MP) and maximum likelihood (ML). The ML analysis employs a substitution model that appropriately accounts for unequal rates of evolution across different branches of the tree. Given this scenario, which of the following outcomes is the most probable?\n\nA. MP will favor the topology `((A,C),(B,D))`, while ML will favor the topology `((A,B),(C,D))`.\n\nB. MP will favor the topology `((A,B),(C,D))`, while ML will favor the topology `((A,C),(B,D))`.\n\nC. Both MP and ML will favor the true topology `((A,B),(C,D))`.\n\nD. Both MP and ML will favor the incorrect topology `((A,C),(B,D))`.\n\nE. Both MP and ML will be unable to resolve the relationships, resulting in an unresolved polytomy.", "solution": "We denote the true unrooted topology as $T_{\\text{true}}=((A,B),(C,D))$. The data contain two parsimony-informative site classes:\n- Class 1: $A$ and $B$ share one nucleotide while $C$ and $D$ share a different nucleotide; these support $T_{\\text{true}}$.\n- Class 2: $A$ and $C$ share one nucleotide while $B$ and $D$ share a different nucleotide; these arise from convergent or parallel substitutions on the long branches to $A$ and $C$.\n\nLet $n_{1}$ be the number of Class 1 sites and $n_{2}$ be the number of Class 2 sites, with $n_{2} \\gg n_{1}$ because of the greatly accelerated rates on the $A$ and $C$ lineages.\n\nMaximum parsimony analysis proceeds by minimizing the total number of changes across all sites for each candidate topology. For a four-taxon, two-state parsimony-informative site, the topology that groups together the two taxa sharing the same state requires $1$ step on that site, whereas each of the two alternative unrooted topologies requires $2$ steps (homoplasy). Therefore:\n- For a Class 1 site, $((A,B),(C,D))$ requires $1$ step; $((A,C),(B,D))$ and $((A,D),(B,C))$ each require $2$ steps.\n- For a Class 2 site, $((A,C),(B,D))$ requires $1$ step; $((A,B),(C,D))$ and $((A,D),(B,C))$ each require $2$ steps.\n\nSumming over sites, the total parsimony scores are\n$$\nS\\big(((A,B),(C,D))\\big)=n_{1}\\cdot 1+n_{2}\\cdot 2,\n$$\n$$\nS\\big(((A,C),(B,D))\\big)=n_{1}\\cdot 2+n_{2}\\cdot 1,\n$$\n$$\nS\\big(((A,D),(B,C))\\big)=n_{1}\\cdot 2+n_{2}\\cdot 2.\n$$\nComparing the first two,\n$$\nS\\big(((A,C),(B,D))\\big)<S\\big(((A,B),(C,D))\\big)\\quad \\Longleftrightarrow \\quad n_{1}\\cdot 2+n_{2}\\cdot 1<n_{1}\\cdot 1+n_{2}\\cdot 2 \\quad \\Longleftrightarrow \\quad n_{2}>n_{1},\n$$\nwhich holds by assumption. Hence maximum parsimony will favor the incorrect long-branch-attracted topology $((A,C),(B,D))$. This is the classical long-branch attraction (Felsenstein zone) result: MP is statistically inconsistent under such conditions.\n\nMaximum likelihood analysis under a substitution model that appropriately accounts for unequal rates across branches evaluates, for each topology, the likelihood as the product over sites of the probabilities of the observed site patterns given the tree and its branch lengths. Here, the data-generating process has long branches leading to $A$ and $C$ and short branches leading to $B$ and $D$ on the true topology $((A,B),(C,D))$. A model that allows branch-specific rates (equivalently, free branch lengths) matches this process. Under such a correctly specified model, ML is statistically consistent: as sequence length grows, the topology maximizing the likelihood converges to the true topology. Intuitively, although many Class 2 sites exhibit $A$–$C$ matches, the model assigns these patterns higher probability as convergent events on two long, non-sister branches on $((A,B),(C,D))$ than as shared ancestry on $((A,C),(B,D))$ when all site patterns (including Class 1 and others) and the overall distribution implied by the long and short branches are considered jointly. Consequently, ML down-weights homoplastic matches between long branches and recovers the true grouping.\n\nTherefore, maximum parsimony will favor $((A,C),(B,D))$ while maximum likelihood with an appropriate branch-heterogeneous model will favor $((A,B),(C,D))$.", "answer": "$$\\boxed{A}$$", "id": "1946247"}, {"introduction": "The final output of a phylogenetic analysis is a tree, but the story doesn't end there. The overall likelihood score for a tree is the sum of contributions from every site in your sequence alignment, and not all sites tell the same story. This final practice moves from inference to diagnostics, showing how to use per-site log-likelihood scores to pinpoint which specific characters in your data are the source of conflict between competing hypotheses. This is a powerful, practical technique for understanding the nuances of the phylogenetic signal within your dataset [@problem_id:1946225].", "problem": "A team of evolutionary biologists is investigating the phylogenetic relationships among four newly discovered species of thermophilic bacteria, provisionally named *Species A*, *Species B*, *Species C*, and *Species D*. They have collected DNA sequence data from a crucial gene involved in heat shock response, resulting in a 10-site alignment. Analysis using the Maximum Likelihood (ML) method has yielded high statistical support for two conflicting hypotheses regarding their evolutionary branching pattern. The two competing tree topologies, represented in Newick format, are:\n\n- **Hypothesis 1:** `((Species A, Species B), (Species C, Species D));`\n- **Hypothesis 2:** `((Species A, Species C), (Species B, Species D));`\n\nTo resolve this conflict, the researchers calculated the per-site log-likelihood scores for the alignment given each of the two tree topologies. These scores, which represent the log-probability of observing the data at a single site given a specific tree and model of evolution, are presented in the table below. A higher (less negative) log-likelihood score indicates a better fit of the tree to the data at that site.\n\n| Site Index | Log-Likelihood for Hypothesis 1 | Log-Likelihood for Hypothesis 2 |\n|:----------:|:-------------------------------:|:-------------------------------:|\n|      1     |             -3.15             |             -3.15             |\n|      2     |             -4.82             |             -2.91             |\n|      3     |             -3.50             |             -4.95             |\n|      4     |             -5.11             |             -3.04             |\n|      5     |             -2.88             |             -4.76             |\n|      6     |             -5.20             |             -5.15             |\n|      7     |             -4.67             |             -2.55             |\n|      8     |             -3.01             |             -4.89             |\n|      9     |             -5.50             |             -3.23             |\n|     10     |             -3.12             |             -3.18             |\n\nYou are tasked with identifying the specific sites in the gene sequence that provide strong support for Hypothesis 2 over Hypothesis 1. A site is considered to provide \"strong support\" for Hypothesis 2 if its log-likelihood score for Hypothesis 2 is greater than its log-likelihood score for Hypothesis 1 by at least 1.8.\n\nWhich of the following sets of site indices represents all sites that provide strong support for Hypothesis 2?\n\nA. Sites 3, 5, 8\n\nB. Sites 2, 4, 7\n\nC. Sites 2, 4, 7, 9\n\nD. Sites 2, 7, 9\n\nE. Sites 2, 4, 6, 7, 9\n\nF. Site 4", "solution": "Define, for each site index $i$, the log-likelihood difference in favor of Hypothesis 2 as $\\Delta_{i}=\\ell_{2,i}-\\ell_{1,i}$, where $\\ell_{2,i}$ and $\\ell_{1,i}$ are the per-site log-likelihoods under Hypothesis 2 and Hypothesis 1, respectively. A site provides strong support for Hypothesis 2 if and only if $\\Delta_{i}\\geq 1.8$.\n\nCompute $\\Delta_{i}$ for each site using the table:\nSite $1$: $\\Delta_{1}=(-3.15)-(-3.15)=0.00<1.8$.\nSite $2$: $\\Delta_{2}=(-2.91)-(-4.82)=1.91\\geq 1.8$.\nSite $3$: $\\Delta_{3}=(-4.95)-(-3.50)=-1.45<1.8$.\nSite $4$: $\\Delta_{4}=(-3.04)-(-5.11)=2.07\\geq 1.8$.\nSite $5$: $\\Delta_{5}=(-4.76)-(-2.88)=-1.88<1.8$.\nSite $6$: $\\Delta_{6}=(-5.15)-(-5.20)=0.05<1.8$.\nSite $7$: $\\Delta_{7}=(-2.55)-(-4.67)=2.12\\geq 1.8$.\nSite $8$: $\\Delta_{8}=(-4.89)-(-3.01)=-1.88<1.8$.\nSite $9$: $\\Delta_{9}=(-3.23)-(-5.50)=2.27\\geq 1.8$.\nSite $10$: $\\Delta_{10}=(-3.18)-(-3.12)=-0.06<1.8$.\n\nTherefore, the sites with $\\Delta_{i}\\geq 1.8$ are $2,4,7,9$, which corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "1946225"}]}