{"hands_on_practices": [{"introduction": "Our first practice exercise introduces the core logic of maximum parsimony, a method that seeks the simplest evolutionary scenario by minimizing the number of trait changes on a phylogenetic tree. By calculating the parsimony score for a hypothetical group of insects, you will learn the foundational steps of tracing a character's history back in time. This exercise provides a solid entry point for understanding how ancestral states are inferred using the principle of simplicity. [@problem_id:1908137]", "problem": "An evolutionary biologist is studying the evolution of larval behavior in a group of fictitious insects. The evolutionary relationships (phylogeny) among five extant species are described as follows: *Glimmerwing* and *Shadowspinner* are sister species (they share a most recent common ancestor). This pair's closest relative is the species *Stonemantle*. A different pair of sister species, *Sunstreaker* and *Duskdiver*, form a separate distinct clade. The clade containing *Glimmerwing*, *Shadowspinner*, and *Stonemantle* and the clade containing *Sunstreaker* and *Duskdiver* are themselves sister groups, originating from the single common ancestor of all five species.\n\nA key trait under investigation is the feeding behavior of larvae, which can be one of two states: 'feeder' (larvae actively consume food) or 'non-feeder' (larvae develop entirely on yolk reserves from the egg). The observed states in the five living species are:\n- *Glimmerwing*: Feeder\n- *Shadowspinner*: Feeder\n- *Stonemantle*: Non-feeder\n- *Sunstreaker*: Feeder\n- *Duskdiver*: Non-feeder\n\nAssuming the common ancestor of all five species was a 'non-feeder', determine the minimum number of evolutionary changes (i.e., transitions between 'feeder' and 'non-feeder' states) required to explain this distribution of traits on the phylogeny. This value is known as the total parsimony score.", "solution": "Let the two larval states be denoted by symbols $F$ (feeder) and $N$ (non-feeder). Abbreviate the five species as follows: $G$ = Glimmerwing $(F)$, $H$ = Shadowspinner $(F)$, $T$ = Stonemantle $(N)$, $U$ = Sunstreaker $(F)$, $D$ = Duskdiver $(N)$. The phylogeny is $(((G,H),T),(U,D))$, with root $R$ being the common ancestor of all five species. Define internal nodes: $X$ as the most recent common ancestor of $G$ and $H$, $A$ as the ancestor of $X$ and $T$, and $B$ as the ancestor of $U$ and $D$.\n\nUse the Fitch parsimony algorithm. For each node $v$, let $S_{v}$ be the set of possible states minimizing changes in the subtree rooted at $v$.\n\nLeaf sets:\n$$\nS_{G}=\\{F\\},\\quad S_{H}=\\{F\\},\\quad S_{T}=\\{N\\},\\quad S_{U}=\\{F\\},\\quad S_{D}=\\{N\\}.\n$$\n\nCompute internal-node sets bottom-up:\n- For $X$ (children $G$ and $H$), $S_{X}=S_{G}\\cap S_{H}=\\{F\\}$ (no change added).\n- For $A$ (children $X$ and $T$), $S_{A}=S_{X}\\cap S_{T}=\\emptyset$, so set $S_{A}=S_{X}\\cup S_{T}=\\{F,N\\}$ and add $1$ change.\n- For $B$ (children $U$ and $D$), $S_{B}=S_{U}\\cap S_{D}=\\emptyset$, so set $S_{B}=S_{U}\\cup S_{D}=\\{F,N\\}$ and add $1$ change.\n- For the root $R$ (children $A$ and $B$), $S_{R}=S_{A}\\cap S_{B}=\\{F,N\\}$ (no additional change).\n\nThus, the minimal number of changes with an unspecified root is $1+1=2$. Now incorporate the given root state: the ancestor of all five species was $N$. Since $N\\in S_{R}$, we assign $R=N$ without incurring any extra change.\n\nAssign states top-down to realize the minimum:\n- Choose $A=N$ and $B=N$ because $N\\in S_{A}$ and $N\\in S_{B}$, avoiding extra changes on branches $R\\to A$ and $R\\to B$.\n- In clade $A$: $A=N$ to $X=\\{F\\}$ requires one change $N\\to F$; $A=N$ to $T=N$ requires no change; $X=F$ to $G=F$ and $H=F$ require no changes.\n- In clade $B$: $B=N$ to $U=F$ requires one change $N\\to F$; $B=N$ to $D=N$ requires no change.\n\nTherefore, the total parsimony score is $1+1=2$, which is the minimum compatible with the observed tip states and the specified non-feeding root.", "answer": "$$\\boxed{2}$$", "id": "1908137"}, {"introduction": "Evolution is not always a one-way street; traits can be lost just as they are gained. This exercise demonstrates how parsimony can be used to uncover more complex evolutionary histories, such as a \"reversal\" to an ancestral state. By mapping the evolution of reproductive modes in salamanders, you'll see how a seemingly inconsistent trait distribution can be explained by the most parsimonious scenario, revealing a fascinating twist in the evolutionary narrative. [@problem_id:1908182]", "problem": "A group of related salamander species is studied to understand the evolution of their reproductive modes. The ancestral condition for this entire group is known to be a life cycle that includes an aquatic larval stage. Some species have evolved direct development, where the young hatch as miniature adults, bypassing the larval stage entirely.\n\nYou are given the observed reproductive mode for six species (one outgroup, O, and five ingroup species A, B, C, D, and E) and their phylogenetic relationships.\n\n**Observed Traits:**\n- Species O (Outgroup): Aquatic larvae\n- Species A: Direct development\n- Species B: Aquatic larvae\n- Species C: Direct development\n- Species D: Direct development\n- Species E: Direct development\n\n**Phylogenetic Relationships:**\nThe relationships are described as follows: Sister species A and B form a clade. This clade is, in turn, sister to species C. This larger clade of (A, B, C) is sister to species D. This entire clade of (A, B, C, D) is sister to species E. Finally, species O is the outgroup to the entire ingroup (A, B, C, D, E).\n\nUsing the principle of maximum parsimony (i.e., preferring the explanation that requires the minimum number of evolutionary changes), determine the most likely evolutionary history for this trait. Which of the following statements correctly describes this history?\n\nA. 2 changes; a reversal from direct development to aquatic larvae occurred in the lineage leading to species B.\n\nB. 2 changes; direct development evolved independently in the lineage to E and the lineage leading to the ancestor of (A, B, C, D).\n\nC. 3 changes; direct development evolved once, and was subsequently lost in the lineages leading to species O and species B.\n\nD. 3 changes; direct development evolved independently in three separate lineages.\n\nE. 1 change; direct development evolved once, and species B represents an error in observation.", "solution": "Let the ancestral state and the outgroup state be aquatic larvae, encoded as $0$, and direct development be encoded as $1$. The observed tip states are: $A=1$, $B=0$, $C=1$, $D=1$, $E=1$, and outgroup $O=0$. The ingroup topology is the pectinate tree with $(((((A,B),C),D),E))$, with $O$ as outgroup to the ingroup root.\n\nApply the Fitch parsimony algorithm bottom-up using state sets:\n- At the leaves: $S(A)=\\{1\\}$, $S(B)=\\{0\\}$, $S(C)=\\{1\\}$, $S(D)=\\{1\\}$, $S(E)=\\{1\\}$, $S(O)=\\{0\\}$.\n- Node $(A,B)$: $S(AB)=S(A)\\cap S(B)=\\emptyset$, so $S(AB)=S(A)\\cup S(B)=\\{0,1\\}$ and this adds $1$ change.\n- Node $(AB,C)$: $S(ABC)=S(AB)\\cap S(C)=\\{1\\}$, adds $0$ changes.\n- Node $(ABC,D)$: $S(ABCD)=S(ABC)\\cap S(D)=\\{1\\}$, adds $0$ changes.\n- Node $(ABCD,E)$ (ingroup root): $S(ABCDE)=S(ABCD)\\cap S(E)=\\{1\\}$, adds $0$ changes.\n- Root with outgroup: $S(\\text{root})=S(ABCDE)\\cap S(O)=\\emptyset$, so take union $\\{0,1\\}$ and add $1$ change.\n\nThus the minimum number of changes is $1+1=2$. A top-down assignment consistent with minimizing changes takes the ingroup root state as $1$ (since $S(ABCDE)=\\{1\\}$), propagating $1$ down internal branches to $ABC$ and to $AB$. At node $AB$ (which had $S(AB)=\\{0,1\\}$), choose state $1$ to avoid an extra change on the internal branch. Then the only discrepancy at the tips is on branch $B$, which requires a single change $1 \\to 0$ (a reversal to aquatic larvae). The other change is the single origin $0 \\to 1$ on the branch leading from the overall ancestor (shared with $O$ at state $0$) to the ingroup root.\n\nThis yields the history: one gain of direct development at the base of the ingroup and one reversal to aquatic larvae in lineage $B$, i.e., $2$ changes with a reversal in $B$, which matches option A.", "answer": "$$\\boxed{A}$$", "id": "1908182"}, {"introduction": "While parsimony provides the simplest explanation, it treats all evolutionary changes as equally likely. Maximum likelihood (ML) offers a more nuanced, probabilistic approach by incorporating a model of how evolution happens. In this final practice, you will analyze the same dataset using both parsimony and ML, allowing you to directly compare their underlying assumptions and resulting inferences about the ancestral state of a dog's herding instinct. This comparison highlights the strengths of different reconstruction methods and introduces the power of statistical modeling in evolutionary biology. [@problem_id:1908136]", "problem": "An evolutionary biologist is studying the evolution of behavior in domestic dogs. A simplified phylogenetic tree of four specific breeds is constructed based on genomic data. The tree consists of two primary clades which share a single common ancestor, representing the root of this domestic dog phylogeny. The first clade contains the German Shepherd and the Border Collie. The second clade contains the Pug and the Beagle.\n\nThe biologist is interested in reconstructing the ancestral state of the 'herding instinct', a complex behavioral trait. This trait is categorized as being in one of two discrete states for each breed: Herding (H) or Non-herding (N). The observed states for the four breeds are:\n- German Shepherd: H\n- Border Collie: H\n- Pug: N\n- Beagle: N\n\nIt is known that the progenitor of all domestic dogs, the wolf, is classified as Non-herding (N) for this specific trait category. You are tasked with reconstructing the state of this trait at the root of the domestic dog phylogeny using two different computational methods.\n\n**Part 1: Parsimony Analysis**\nApply the principle of maximum parsimony to this phylogeny and trait data. Determine the minimum number of evolutionary changes (i.e., from H to N or N to H) required to explain the observed distribution of the herding instinct.\n\n**Part 2: Maximum Likelihood Analysis**\nFor a maximum likelihood analysis, a simple, non-symmetrical model of trait evolution is proposed. The model assumes that on any given branch of the phylogeny, the probability of the trait changing from Herding to Non-herding (a loss event) is $p_{\\text{H}\\to\\text{N}} = 0.3$, and the probability of it changing from Non-herding to Herding (a gain event) is $p_{\\text{N}\\to\\text{H}} = 0.1$. Consequently, the probability of the state remaining Herding is $p_{\\text{H}\\to\\text{H}} = 0.7$, and the probability of it remaining Non-herding is $p_{\\text{N}\\to\\text{N}} = 0.9$. These probabilities are assumed to be uniform across all branches of the phylogeny.\n\nCalculate the ratio of the likelihood that the root ancestor had the Herding trait to the likelihood that it had the Non-herding trait, defined as $R = \\frac{L(\\text{root state = H})}{L(\\text{root state = N})}$.\n\nYour task is to provide the minimum number of changes from Part 1, and the numerical value of the ratio $R$ from Part 2. Round the value of $R$ to four significant figures.", "solution": "Parsimony analysis: The four-tip rooted tree consists of two cherries: clade A with German Shepherd and Border Collie, both observed as $H$, and clade B with Pug and Beagle, both observed as $N$. Using the Fitch parsimony procedure, assign sets at the leaves: $\\{H\\}$ for both members of clade A and $\\{N\\}$ for both members of clade B. At the internal nodes subtending each cherry, intersections are non-empty, giving $\\{H\\}$ at the ancestor of clade A and $\\{N\\}$ at the ancestor of clade B. At the root, the intersection of $\\{H\\}$ and $\\{N\\}$ is empty, so one change is required along the single edge separating the $H$ and $N$ subtrees. Therefore, the minimum number of changes explaining the observed distribution is $1$.\n\nMaximum likelihood analysis: Each branch has the same transition probabilities\n$$\np_{\\text{H}\\to\\text{H}}=0.7,\\quad p_{\\text{H}\\to\\text{N}}=0.3,\\quad p_{\\text{N}\\to\\text{H}}=0.1,\\quad p_{\\text{N}\\to\\text{N}}=0.9.\n$$\nFor clade A (two $H$ leaves), the conditional likelihood of the subtree given the clade ancestorâ€™s state $i\\in\\{H,N\\}$ is\n$$\nf_{A}(H)=(p_{\\text{H}\\to\\text{H}})^{2}=0.7^{2}=0.49,\\qquad f_{A}(N)=(p_{\\text{N}\\to\\text{H}})^{2}=0.1^{2}=0.01.\n$$\nFor clade B (two $N$ leaves), the conditional likelihoods are\n$$\nf_{B}(H)=(p_{\\text{H}\\to\\text{N}})^{2}=0.3^{2}=0.09,\\qquad f_{B}(N)=(p_{\\text{N}\\to\\text{N}})^{2}=0.9^{2}=0.81.\n$$\nLet $L(H)$ denote the likelihood of the observed tip states given that the root is $H$, and $L(N)$ for root $N$. Summing over the unknown states at the two internal clade ancestors yields\n$$\ng_{A}(H)=p_{\\text{H}\\to\\text{H}}\\,f_{A}(H)+p_{\\text{H}\\to\\text{N}}\\,f_{A}(N)=0.7\\cdot 0.49+0.3\\cdot 0.01=0.346,\n$$\n$$\ng_{B}(H)=p_{\\text{H}\\to\\text{H}}\\,f_{B}(H)+p_{\\text{H}\\to\\text{N}}\\,f_{B}(N)=0.7\\cdot 0.09+0.3\\cdot 0.81=0.306,\n$$\nso\n$$\nL(H)=g_{A}(H)\\,g_{B}(H)=0.346\\cdot 0.306=0.105876.\n$$\nSimilarly,\n$$\ng_{A}(N)=p_{\\text{N}\\to\\text{H}}\\,f_{A}(H)+p_{\\text{N}\\to\\text{N}}\\,f_{A}(N)=0.1\\cdot 0.49+0.9\\cdot 0.01=0.058,\n$$\n$$\ng_{B}(N)=p_{\\text{N}\\to\\text{H}}\\,f_{B}(H)+p_{\\text{N}\\to\\text{N}}\\,f_{B}(N)=0.1\\cdot 0.09+0.9\\cdot 0.81=0.738,\n$$\nso\n$$\nL(N)=g_{A}(N)\\,g_{B}(N)=0.058\\cdot 0.738=0.042804.\n$$\nThe requested ratio is\n$$\nR=\\frac{L(\\text{root state}=H)}{L(\\text{root state}=N)}=\\frac{0.105876}{0.042804}\\approx 2.474,\n$$\nrounded to four significant figures.\n\nThus, the minimum number of changes under parsimony is $1$, and the likelihood ratio $R$ is approximately $2.474$.", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 2.474 \\end{pmatrix}}$$", "id": "1908136"}]}