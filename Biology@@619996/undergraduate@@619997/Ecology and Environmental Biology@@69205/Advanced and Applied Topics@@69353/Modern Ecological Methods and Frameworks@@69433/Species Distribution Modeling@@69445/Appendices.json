{"hands_on_practices": [{"introduction": "Before we can build a reliable species distribution model, we must ensure our environmental predictors are not redundant. Redundant or highly correlated variables can cause a problem known as multicollinearity, which can destabilize model parameters and make it difficult to interpret the independent effect of each variable. This exercise guides you through a critical data pre-processing step: using the Variance Inflation Factor ($VIF$) to systematically identify and remove correlated variables, a crucial technique for building more robust and interpretable models. [@problem_id:1882322]", "problem": "An ecologist is developing a Species Distribution Model (SDM) for a rare alpine plant species. To avoid issues with multicollinearity, the ecologist decides to pre-process a set of four potential climatic predictor variables using a stepwise selection procedure based on the Variance Inflation Factor (VIF). The initial set of variables is:\n- $V_1$: Mean Annual Temperature\n- $V_2$: Total Annual Precipitation\n- $V_3$: Annual Temperature Range\n- $V_4$: Altitude\n\nThe VIF for a predictor variable $V_j$ is calculated as $VIF_j = \\frac{1}{1 - R^2_j}$, where $R^2_j$ is the coefficient of determination from a linear regression of $V_j$ against all other predictor variables in the current set.\n\nThe selection procedure is as follows:\n1. Calculate the VIF for all variables in the current set.\n2. Identify the variable with the highest VIF.\n3. If this highest VIF is greater than a threshold of 5.0, remove that variable from the set.\n4. Repeat the process with the remaining variables until all variables in the set have a VIF less than or equal to 5.0.\n\nThe following data from the linear regression analyses are available:\n\n**Round 1 (Set: {$V_1, V_2, V_3, V_4$}):**\n- Regression of $V_1$ on {$V_2, V_3, V_4$}: $R^2_1 = 0.980$\n- Regression of $V_2$ on {$V_1, V_3, V_4$}: $R^2_2 = 0.600$\n- Regression of $V_3$ on {$V_1, V_2, V_4$}: $R^2_3 = 0.750$\n- Regression of $V_4$ on {$V_1, V_2, V_3$}: $R^2_4 = 0.970$\n\nAfter removing the variable with the highest VIF from Round 1, the analysis is repeated.\n\n**Round 2 (Remaining variables):**\nLet the remaining variables be denoted as a new set. The coefficients of determination for this new set are:\n- Regression of $V_2$ on {$V_3, V_4$}: $R^2_2 = 0.450$\n- Regression of $V_3$ on {$V_2, V_4$}: $R^2_3 = 0.300$\n- Regression of $V_4$ on {$V_2, V_3$}: $R^2_4 = 0.820$\n\nAfter removing the variable with the highest VIF from Round 2, the analysis is repeated on the final pair of variables.\n\n**Round 3 (Final pair):**\n- The coefficient of determination for the regression between the two remaining variables is 0.200.\n\nBased on this stepwise procedure, which set of variables should be retained for the final model?\n\nA. {$V_1, V_2$}\n\nB. {$V_2, V_3$}\n\nC. {$V_2, V_4$}\n\nD. {$V_1, V_3, V_4$}\n\nE. {$V_2, V_3, V_4$}", "solution": "The problem asks us to perform a stepwise variable selection using the Variance Inflation Factor (VIF) with a removal threshold of 5.0. The VIF for a variable $V_j$ is given by $VIF_j = \\frac{1}{1 - R^2_j}$.\n\n**Round 1: Initial set {$V_1, V_2, V_3, V_4$}**\n\nFirst, we calculate the VIF for each of the four initial variables using the provided $R^2$ values.\n\nFor $V_1$:\n$VIF_1 = \\frac{1}{1 - R^2_1} = \\frac{1}{1 - 0.980} = \\frac{1}{0.020} = 50.0$\n\nFor $V_2$:\n$VIF_2 = \\frac{1}{1 - R^2_2} = \\frac{1}{1 - 0.600} = \\frac{1}{0.400} = 2.5$\n\nFor $V_3$:\n$VIF_3 = \\frac{1}{1 - R^2_3} = \\frac{1}{1 - 0.750} = \\frac{1}{0.250} = 4.0$\n\nFor $V_4$:\n$VIF_4 = \\frac{1}{1 - R^2_4} = \\frac{1}{1 - 0.970} = \\frac{1}{0.030} \\approx 33.33$\n\nThe calculated VIF values are: $VIF_1 = 50.0$, $VIF_2 = 2.5$, $VIF_3 = 4.0$, and $VIF_4 \\approx 33.33$.\n\nAccording to the procedure, we identify the variable with the highest VIF. This is $V_1$, with $VIF_1 = 50.0$.\nWe then compare this value to the threshold of 5.0. Since $50.0 > 5.0$, we must remove variable $V_1$.\n\nThe set of remaining variables for the next round is {$V_2, V_3, V_4$}.\n\n**Round 2: Set {$V_2, V_3, V_4$}**\n\nNow we repeat the process for the remaining variables using the $R^2$ values provided for Round 2. Note that the problem statement for Round 2 is self-contained and does not require us to know which variable was removed, but our step-by-step derivation has identified it as $V_1$, so the new regressions are for $V_2$ on {$V_3, V_4$}, $V_3$ on {$V_2, V_4$}, and $V_4$ on {$V_2, V_3$}.\n\nFor $V_2$:\n$VIF_2 = \\frac{1}{1 - R^2_2} = \\frac{1}{1 - 0.450} = \\frac{1}{0.550} \\approx 1.82$\n\nFor $V_3$:\n$VIF_3 = \\frac{1}{1 - R^2_3} = \\frac{1}{1 - 0.300} = \\frac{1}{0.700} \\approx 1.43$\n\nFor $V_4$:\n$VIF_4 = \\frac{1}{1 - R^2_4} = \\frac{1}{1 - 0.820} = \\frac{1}{0.180} \\approx 5.56$\n\nThe new VIF values are: $VIF_2 \\approx 1.82$, $VIF_3 \\approx 1.43$, and $VIF_4 \\approx 5.56$.\n\nThe variable with the highest VIF in this set is $V_4$, with $VIF_4 \\approx 5.56$.\nWe compare this to the threshold: $5.56 > 5.0$. Therefore, we must remove variable $V_4$.\n\nThe set of remaining variables is {$V_2, V_3$}.\n\n**Round 3: Set {$V_2, V_3$}**\n\nFinally, we analyze the last remaining pair of variables, {$V_2, V_3$}. When there are only two variables, the VIF is the same for both. The $R^2$ for the regression of $V_2$ on $V_3$ is the same as the $R^2$ for the regression of $V_3$ on $V_2$. The problem states this value is 0.200.\n\nThe VIF for both remaining variables is:\n$VIF_{final} = \\frac{1}{1 - 0.200} = \\frac{1}{0.800} = 1.25$\n\nWe check if this VIF value is greater than the threshold of 5.0. Since $1.25 \\le 5.0$, the condition for removal is not met. The stepwise procedure stops.\n\nThe final set of variables to be retained for the model is {$V_2, V_3$}. This corresponds to option B.", "answer": "$$\\boxed{B}$$", "id": "1882322"}, {"introduction": "The ecological characteristics of a species profoundly influence how we model its distribution. In this practice, we will explore the mathematical consequences of modeling a habitat 'specialist' versus a 'generalist', using a Gaussian response curve to represent their environmental niches. By analyzing the rate of change of the probability function, you will develop an intuition for how a species' niche breadth translates into the model's predictive sharpness, illuminating why specialists often yield more distinct predictions. [@problem_id:1882305]", "problem": "An ecologist is developing Species Distribution Models (SDMs) for two hypothetical beetle species to understand how their presence relates to soil acidity. The ecologist hypothesizes that the probability of finding each species at a given site is primarily determined by the site's soil pH.\n\n- Species S is a \"specialist,\" known to thrive only in a narrow range of acidic soils.\n- Species G is a \"generalist,\" tolerant of a much wider range of soil pH values.\n\nBased on extensive field data, the ecologist models the probability of presence, $P(x)$, as a function of soil pH, denoted by the variable $x$. For both species, the probability follows a Gaussian response curve:\n$$P(x) = \\exp\\left(-\\frac{(x - x_{opt})^2}{2\\sigma^2}\\right)$$\nIn this model, $x_{opt}$ represents the optimal soil pH where the species is most likely to be found, and the parameter $\\sigma$ quantifies the breadth of the species' niche. A smaller $\\sigma$ indicates a specialist, while a larger $\\sigma$ indicates a generalist.\n\nThe model parameters are determined as follows:\n- For both species, the optimal pH is $x_{opt} = 5.5$.\n- For the specialist Species S, the niche breadth parameter is $\\sigma_S = 0.4$.\n- For the generalist Species G, the niche breadth parameter is $\\sigma_G = 2.0$.\n\nThe \"predictive sharpness\" of an SDM for a given environmental condition can be related to how rapidly the probability of presence changes in response to changes in that environment. A model with a higher maximum rate of change (a steeper gradient) is considered to have stronger predictive power, as small differences in the environment lead to large, clear changes in the predicted probability.\n\nCalculate the ratio of the maximum possible rate of change of presence probability for the specialist species S to that of the generalist species G. That is, compute the value of the ratio $\\frac{\\max|dP_S/dx|}{\\max|dP_G/dx|}$. Your answer should be a single real number.", "solution": "For a given species with parameters $x_{opt}$ and $\\sigma$, the probability of presence is\n$$\nP(x)=\\exp\\!\\left(-\\frac{(x-x_{opt})^{2}}{2\\sigma^{2}}\\right).\n$$\nDifferentiate with respect to $x$ using the chain rule. Let\n$$\nE(x)=-\\frac{(x-x_{opt})^{2}}{2\\sigma^{2}},\n$$\nso that $P(x)=\\exp(E(x))$ and\n$$\n\\frac{dP}{dx}=\\exp(E(x))\\frac{dE}{dx}.\n$$\nCompute\n$$\n\\frac{dE}{dx}=-\\frac{1}{2\\sigma^{2}}\\cdot 2(x-x_{opt})=-\\frac{x-x_{opt}}{\\sigma^{2}},\n$$\nhence\n$$\n\\frac{dP}{dx}=-\\frac{x-x_{opt}}{\\sigma^{2}}\\exp\\!\\left(-\\frac{(x-x_{opt})^{2}}{2\\sigma^{2}}\\right).\n$$\nThe absolute rate of change is\n$$\n\\left|\\frac{dP}{dx}\\right|=\\frac{|x-x_{opt}|}{\\sigma^{2}}\\exp\\!\\left(-\\frac{(x-x_{opt})^{2}}{2\\sigma^{2}}\\right).\n$$\nLet $y=|x-x_{opt}|$ with $y\\ge 0$ and define\n$$\nf(y)=\\frac{y}{\\sigma^{2}}\\exp\\!\\left(-\\frac{y^{2}}{2\\sigma^{2}}\\right).\n$$\nTo maximize $f$, differentiate:\n$$\nf'(y)=\\frac{1}{\\sigma^{2}}\\exp\\!\\left(-\\frac{y^{2}}{2\\sigma^{2}}\\right)+\\frac{y}{\\sigma^{2}}\\exp\\!\\left(-\\frac{y^{2}}{2\\sigma^{2}}\\right)\\left(-\\frac{y}{\\sigma^{2}}\\right)\n=\\exp\\!\\left(-\\frac{y^{2}}{2\\sigma^{2}}\\right)\\left(\\frac{1}{\\sigma^{2}}-\\frac{y^{2}}{\\sigma^{4}}\\right).\n$$\nSet $f'(y)=0$ to find critical points:\n$$\n\\frac{1}{\\sigma^{2}}-\\frac{y^{2}}{\\sigma^{4}}=0\\quad\\Longrightarrow\\quad y^{2}=\\sigma^{2}\\quad\\Longrightarrow\\quad y=\\sigma.\n$$\nSince $f(0)=0$ and $f(y)\\to 0$ as $y\\to\\infty$, the critical point at $y=\\sigma$ gives the global maximum. The maximum absolute slope is therefore\n$$\n\\max\\left|\\frac{dP}{dx}\\right|=f(\\sigma)=\\frac{\\sigma}{\\sigma^{2}}\\exp\\!\\left(-\\frac{\\sigma^{2}}{2\\sigma^{2}}\\right)=\\frac{1}{\\sigma}\\exp\\!\\left(-\\frac{1}{2}\\right).\n$$\nFor species S and G with $\\sigma_{S}$ and $\\sigma_{G}$, respectively,\n$$\n\\frac{\\max|dP_{S}/dx|}{\\max|dP_{G}/dx|}=\\frac{\\exp(-1/2)/\\sigma_{S}}{\\exp(-1/2)/\\sigma_{G}}=\\frac{\\sigma_{G}}{\\sigma_{S}}.\n$$\nSubstituting $\\sigma_{S}=0.4$ and $\\sigma_{G}=2.0$ gives\n$$\n\\frac{\\max|dP_{S}/dx|}{\\max|dP_{G}/dx|}=\\frac{2.0}{0.4}=5.\n$$", "answer": "$$\\boxed{5}$$", "id": "1882305"}, {"introduction": "A model is only as good as its predictive performance, which we must rigorously quantify. This final practice puts you in the realistic scenario of modeling a rare species with limited data, where robust evaluation is paramount. You will learn to calculate and interpret two of the most widely used metrics in the field: the Area Under the Curve (AUC) and the True Skill Statistic (TSS), gaining essential skills for validating your own species distribution models. [@problem_id:1882368]", "problem": "An ecologist is developing a Species Distribution Model (SDM) for a newly discovered and critically rare deep-sea coral, *Corallium profundum*. The species has only been observed at nine distinct locations. Due to this extremely small sample size, the ecologist is concerned about model overfitting and chooses a leave-one-out cross-validation approach for model evaluation.\n\nIn this procedure, for each of the nine presence points, a model is trained on the other eight points and then used to predict the habitat suitability (a value from 0 to 1) for the single point that was left out. The predicted habitat suitability scores for the nine presence points are:\n{0.99, 0.98, 0.96, 0.94, 0.90, 0.85, 0.81, 0.75, 0.70}\n\nTo evaluate the model's ability to distinguish suitable from unsuitable habitat, the model also predicts suitability for 1000 random 'background' points, which represent the range of environmental conditions in the study area. The evaluation will use two metrics: the Area Under the Curve (AUC) of the Receiver Operating Characteristic (ROC) curve and the True Skill Statistic (TSS).\n\nFor the AUC calculation, the following data is available. It shows, for each of the nine presence point scores, how many of the 1000 background points had a lower predicted suitability score.\n- For a score of 0.99, 995 background points scored lower.\n- For a score of 0.98, 980 background points scored lower.\n- For a score of 0.96, 960 background points scored lower.\n- For a score of 0.94, 930 background points scored lower.\n- For a score of 0.90, 890 background points scored lower.\n- For a score of 0.85, 840 background points scored lower.\n- For a score of 0.81, 785 background points scored lower.\n- For a score of 0.75, 700 background points scored lower.\n- For a score of 0.70, 670 background points scored lower.\n\nThe AUC can be calculated as the average proportion of background points that have a lower score than a given presence point.\n\nFor the TSS calculation, the continuous suitability scores must be converted to binary predictions (presence/absence) using a threshold. The ecologist uses a threshold of $T = 0.80$. Any location with a score greater than 0.80 is predicted as 'presence', and any location with a score less than or equal to 0.80 is predicted as 'absence'. From the model predictions on the 1000 background points, it was found that 220 of them had a suitability score greater than 0.80.\n\nThe TSS is calculated as: $TSS = \\text{Sensitivity} + \\text{Specificity} - 1$.\n- Sensitivity (or True Positive Rate) is the proportion of actual presence sites correctly predicted as presence.\n- Specificity (or True Negative Rate) is the proportion of actual absence (background) sites correctly predicted as absence.\n\nBased on the data provided, calculate the values for AUC and TSS. Round both final values to three significant figures. Which of the following statements is correct?\n\nA. The AUC is 0.861 and the TSS is 0.558.\n\nB. The AUC is 0.861 and the TSS is 0.635.\n\nC. The AUC is 0.775 and the TSS is 0.558.\n\nD. The AUC is 0.900 and the TSS is 0.778.\n\nE. The AUC is 0.850 and the TSS is 0.780.", "solution": "The goal is to calculate two model performance metrics, the Area Under the Curve (AUC) and the True Skill Statistic (TSS), based on the provided species distribution model outputs.\n\n**Step 1: Calculate the Area Under the Curve (AUC)**\n\nThe problem states that the AUC can be calculated as the average proportion of background points that have a lower score than a given presence point. We have 9 presence points and 1000 background points.\n\nFor each of the 9 presence point scores, we are given the number of background points with a lower score. We first find the proportion for each presence point and then average these proportions.\n\nThe proportions are:\n- For the score of 0.99: $995 / 1000 = 0.995$\n- For the score of 0.98: $980 / 1000 = 0.980$\n- For the score of 0.96: $960 / 1000 = 0.960$\n- For the score of 0.94: $930 / 1000 = 0.930$\n- For the score of 0.90: $890 / 1000 = 0.890$\n- For the score of 0.85: $840 / 1000 = 0.840$\n- For the score of 0.81: $785 / 1000 = 0.785$\n- For the score of 0.75: $700 / 1000 = 0.700$\n- For the score of 0.70: $670 / 1000 = 0.670$\n\nNow, we calculate the average of these proportions:\n$$ \\text{AUC} = \\frac{0.995 + 0.980 + 0.960 + 0.930 + 0.890 + 0.840 + 0.785 + 0.700 + 0.670}{9} $$\nThe sum of the proportions is:\n$$ \\text{Sum} = 7.750 $$\nThe average is:\n$$ \\text{AUC} = \\frac{7.750}{9} \\approx 0.86111... $$\nRounding to three significant figures, we get $\\text{AUC} = 0.861$.\n\n**Step 2: Calculate the True Skill Statistic (TSS)**\n\nThe TSS calculation requires classifying the continuous predictions into binary outcomes (presence/absence) using the given threshold of $T = 0.80$.\n$TSS = \\text{Sensitivity} + \\text{Specificity} - 1$.\n\nFirst, we need to build a confusion matrix by determining the number of True Positives (TP), False Negatives (FN), True Negatives (TN), and False Positives (FP).\n\n**Analysis of Presence Data:**\nWe have 9 actual presence sites with the following scores: {0.99, 0.98, 0.96, 0.94, 0.90, 0.85, 0.81, 0.75, 0.70}.\n- A site is predicted as 'presence' if its score is $> 0.80$.\n- A site is predicted as 'absence' if its score is $\\le 0.80$.\n\nThe scores greater than 0.80 are {0.99, 0.98, 0.96, 0.94, 0.90, 0.85, 0.81}. There are 7 such scores. These are the True Positives (TP).\n$$ \\text{TP} = 7 $$\nThe scores less than or equal to 0.80 are {0.75, 0.70}. There are 2 such scores. These are the False Negatives (FN), i.e., actual presences incorrectly predicted as absences.\n$$ \\text{FN} = 2 $$\nThe total number of actual presence sites is $N_{presence} = TP + FN = 7 + 2 = 9$.\n\n**Analysis of Background (Absence) Data:**\nWe have 1000 background points, which we treat as absences for this evaluation.\n- The problem states that 220 of the background points had a suitability score greater than 0.80. These are actual absences incorrectly predicted as presences, so they are False Positives (FP).\n$$ \\text{FP} = 220 $$\n- The remaining background points must have a score less than or equal to 0.80. These are correctly predicted as absences, so they are True Negatives (TN).\n$$ \\text{TN} = 1000 - \\text{FP} = 1000 - 220 = 780 $$\nThe total number of actual absence sites is $N_{absence} = FP + TN = 220 + 780 = 1000$.\n\n**Step 3: Calculate Sensitivity, Specificity, and TSS**\n\n- **Sensitivity** (True Positive Rate) = $\\frac{\\text{TP}}{N_{presence}} = \\frac{7}{9}$\n- **Specificity** (True Negative Rate) = $\\frac{\\text{TN}}{N_{absence}} = \\frac{780}{1000} = 0.78$\n\nNow, we can calculate the TSS:\n$$ \\text{TSS} = \\text{Sensitivity} + \\text{Specificity} - 1 $$\n$$ \\text{TSS} = \\frac{7}{9} + 0.78 - 1 $$\n$$ \\text{TSS} \\approx 0.7777... + 0.78 - 1 = 1.5577... - 1 = 0.5577... $$\nRounding to three significant figures, we get $\\text{TSS} = 0.558$.\n\n**Conclusion**\n\nThe calculated values are $\\text{AUC} \\approx 0.861$ and $\\text{TSS} \\approx 0.558$. Comparing these with the given options, we find that option A matches our results.\n- A. The AUC is 0.861 and the TSS is 0.558.\n- B. The AUC is 0.861 and the TSS is 0.635.\n- C. The AUC is 0.775 and the TSS is 0.558.\n- D. The AUC is 0.900 and the TSS is 0.778.\n- E. The AUC is 0.850 and the TSS is 0.780.\n\nThe correct option is A.", "answer": "$$\\boxed{A}$$", "id": "1882368"}]}