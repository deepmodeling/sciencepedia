{"hands_on_practices": [{"introduction": "This first practice brings to life the fundamental process of machine \"learning\": using historical data to train a predictive model. You will step into the role of a fisheries scientist and use the method of ordinary least squares to discover the mathematical relationship between sea surface temperature and fish population size. This exercise is invaluable for understanding how a model's predictive parameters are derived directly from empirical data, forming the bedrock of data-driven environmental science. [@problem_id:1861433]", "problem": "A fisheries management team is developing a simple predictive model for the population size of a key commercial fish species. They hypothesize a linear relationship between the average spring Sea Surface Temperature (SST) and the subsequent season's fish population. The proposed model is a simple linear regression of the form $P = \\beta_0 + \\beta_1 T$, where $P$ is the fish population size in millions, and $T$ is the SST in degrees Celsius.\n\nTo train this model, the team uses a historical dataset spanning $n=20$ years. For a linear model $y = \\hat{\\beta}_0 + \\hat{\\beta}_1 x$ trained on $n$ data pairs $(x_i, y_i)$, the ordinary least squares estimates for the coefficients are given by:\n$$ \\hat{\\beta}_1 = \\frac{n(\\sum x_i y_i) - (\\sum x_i)(\\sum y_i)}{n(\\sum x_i^2) - (\\sum x_i)^2} $$\n$$ \\hat{\\beta}_0 = \\bar{y} - \\hat{\\beta}_1 \\bar{x} $$\nwhere $\\bar{x}$ and $\\bar{y}$ are the sample means of $x$ and $y$, respectively. In this context, the temperature $T$ is the independent variable ($x$) and the population size $P$ is the dependent variable ($y$).\n\nThe summary statistics calculated from the 20-year dataset are as follows:\n- Sum of temperatures: $\\sum T_i = 285.0 \\text{ C}$\n- Sum of populations: $\\sum P_i = 61.2 \\text{ million}$\n- Sum of squared temperatures: $\\sum T_i^2 = 4110.5 \\text{ C}^2$\n- Sum of the products of temperature and population: $\\sum (T_i P_i) = 897.0 \\text{ million} \\cdot \\text{C}$\n- Number of data points: $n = 20$\n\nUsing this trained model, predict the fish population for the next season, for which the forecasted average spring SST is $T_{\\text{new}} = 15.5$ degrees Celsius.\n\nExpress your answer for the predicted population in millions of fish. Round your final answer to three significant figures.", "solution": "We use the ordinary least squares formulas for the simple linear regression $P=\\hat{\\beta}_{0}+\\hat{\\beta}_{1}T$ with $n=20$, $x\\equiv T$, and $y\\equiv P$:\n$$\n\\hat{\\beta}_{1}=\\frac{n\\left(\\sum x_{i}y_{i}\\right)-\\left(\\sum x_{i}\\right)\\left(\\sum y_{i}\\right)}{n\\left(\\sum x_{i}^{2}\\right)-\\left(\\sum x_{i}\\right)^{2}},\\qquad\n\\hat{\\beta}_{0}=\\bar{y}-\\hat{\\beta}_{1}\\bar{x},\n$$\nwhere $\\bar{x}=\\frac{1}{n}\\sum x_{i}$ and $\\bar{y}=\\frac{1}{n}\\sum y_{i}$.\n\nInsert the provided summary statistics:\n- $n=20$,\n- $\\sum T_{i}=285.0$,\n- $\\sum P_{i}=61.2$,\n- $\\sum T_{i}^{2}=4110.5$,\n- $\\sum T_{i}P_{i}=897.0$.\n\nCompute the denominator and numerator for $\\hat{\\beta}_{1}$:\n$$\nD=n\\left(\\sum T_{i}^{2}\\right)-\\left(\\sum T_{i}\\right)^{2}=20\\cdot 4110.5-285.0^{2}=82210.0-81225.0=985.0,\n$$\n$$\nN=n\\left(\\sum T_{i}P_{i}\\right)-\\left(\\sum T_{i}\\right)\\left(\\sum P_{i}\\right)=20\\cdot 897.0-285.0\\cdot 61.2=17940.0-17442.0=498.0.\n$$\nHence\n$$\n\\hat{\\beta}_{1}=\\frac{498}{985}.\n$$\nCompute the sample means:\n$$\n\\bar{x}=\\frac{\\sum T_{i}}{n}=\\frac{285.0}{20}=14.25,\\qquad\n\\bar{y}=\\frac{\\sum P_{i}}{n}=\\frac{61.2}{20}=3.06.\n$$\nThen\n$$\n\\hat{\\beta}_{0}=\\bar{y}-\\hat{\\beta}_{1}\\bar{x}=3.06-\\frac{498}{985}\\cdot 14.25.\n$$\n\nFor the forecasted temperature $T_{\\text{new}}=15.5$, the predicted population is\n$$\n\\hat{P}(T_{\\text{new}})=\\hat{\\beta}_{0}+\\hat{\\beta}_{1}T_{\\text{new}}.\n$$\nUsing the identity $\\hat{\\beta}_{0}=\\bar{y}-\\hat{\\beta}_{1}\\bar{x}$, equivalently\n$$\n\\hat{P}(T_{\\text{new}})=\\bar{y}+\\hat{\\beta}_{1}\\left(T_{\\text{new}}-\\bar{x}\\right)\n=3.06+\\frac{498}{985}\\left(15.5-14.25\\right)\n=3.06+\\frac{498}{985}\\cdot 1.25.\n$$\nCompute the exact fraction:\n$$\n\\frac{498}{985}\\cdot 1.25=\\frac{498}{985}\\cdot \\frac{5}{4}=\\frac{622.5}{985}=\\frac{1245}{1970}=\\frac{249}{394}.\n$$\nThus\n$$\n\\hat{P}(15.5)=3.06+\\frac{249}{394}\\approx 3.691979695\\ldots\n$$\nRounded to three significant figures, the predicted population (in millions) is $3.69$.", "answer": "$$\\boxed{3.69}$$", "id": "1861433"}, {"introduction": "We now shift gears from predicting continuous numbers (regression) to identifying distinct categories (classification), a common task in biodiversity monitoring. In this problem, you will evaluate the performance of a sophisticated model designed to identify individual zebras from photographs—a cutting-edge technique in non-invasive conservation. By calculating the F1-score, you will learn why simple accuracy is often not enough and how to use more robust metrics that are essential when dealing with the imbalanced datasets frequently encountered in ecological research. [@problem_id:1861421]", "problem": "A conservation research team is conducting a non-invasive population study of Grévy's zebras, an endangered species known for its unique stripe patterns. Instead of physically capturing and tagging animals, the team is using a machine learning model to identify individual zebras from photographs. They have trained a Convolutional Neural Network (CNN), a type of deep learning model specialized for image analysis, to perform this identification.\n\nTo evaluate the model's performance, the team focuses on its ability to correctly identify one specific, well-documented zebra named \"Nyota\". They use a test dataset of 2500 photographs. Within this dataset, 100 images are confirmed to be of Nyota, while the remaining 2400 images are of other zebras.\n\nWhen the CNN processes this test dataset, its performance on the task of identifying Nyota is as follows:\n- The model correctly identifies an image as being of Nyota for 85 of the 100 actual Nyota images.\n- The model incorrectly identifies an image as being of Nyota for 24 of the 2400 images of other zebras.\n\nUsing this information, calculate the F1-score for the model's classification of the \"Nyota\" class. The F1-score is a measure of a test's accuracy that considers both precision and recall. Express your answer as a decimal rounded to three significant figures.", "solution": "Define the confusion matrix counts for the class \"Nyota\": true positives $\\text{TP}=85$, false negatives $\\text{FN}=100-85=15$, and false positives $\\text{FP}=24$.\n\nPrecision and recall are defined as\n$$P=\\frac{\\text{TP}}{\\text{TP}+\\text{FP}}, \\quad R=\\frac{\\text{TP}}{\\text{TP}+\\text{FN}}.$$\nThe F1-score is the harmonic mean of precision and recall:\n$$F_{1}=\\frac{2PR}{P+R}=\\frac{2 \\cdot \\frac{\\text{TP}}{\\text{TP}+\\text{FP}} \\cdot \\frac{\\text{TP}}{\\text{TP}+\\text{FN}}}{\\frac{\\text{TP}}{\\text{TP}+\\text{FP}}+\\frac{\\text{TP}}{\\text{TP}+\\text{FN}}}.$$\nMultiplying numerator and denominator by $(\\text{TP}+\\text{FP})(\\text{TP}+\\text{FN})$ gives\n$$F_{1}=\\frac{2 \\cdot \\text{TP}^{2}}{\\text{TP}(\\text{TP}+\\text{FN})+\\text{TP}(\\text{TP}+\\text{FP})}=\\frac{2 \\cdot \\text{TP}^{2}}{2\\text{TP}^{2}+\\text{TP}\\cdot \\text{FP}+\\text{TP}\\cdot \\text{FN}}=\\frac{2 \\cdot \\text{TP}}{2 \\cdot \\text{TP}+\\text{FP}+\\text{FN}}.$$\nSubstitute the given counts:\n$$F_{1}=\\frac{2 \\cdot 85}{2 \\cdot 85+24+15}=\\frac{170}{209}\\approx 0.813397\\ldots$$\nRounded to three significant figures, the F1-score is $0.813$.", "answer": "$$\\boxed{0.813}$$", "id": "1861421"}, {"introduction": "Our final challenge synthesizes several concepts into a powerful, multi-layered ecological simulation. We will model a classic trophic cascade by linking a predator's \"landscape of fear\" to herbivore foraging patterns and subsequent vegetation growth. This exercise demonstrates how individual mathematical models, some of which could be informed by machine learning, can be chained together into a composite framework to predict the dynamics of an entire ecosystem. You will apply this model to forecast the recovery of an aspen grove, gaining insight into the predictive power of integrated environmental modeling. [@problem_id:1861427]", "problem": "A team of conservation ecologists is modeling the spatial recovery of aspen groves in a mountainous national park following the reintroduction of wolves, a keystone predator. They hypothesize that vegetation recovery is driven by a \"landscape of fear,\" where elk, the primary herbivores, alter their foraging behavior to avoid areas with high predation risk.\n\nThe ecologists have developed a predictive model for the change in the Normalized Difference Vegetation Index (NDVI), a satellite-derived measure of vegetation health, over a one-year period. The model is defined for any location $(x, y)$ in the park, where coordinates are given in kilometers.\n\nThe model consists of three interconnected components:\n\n1.  **Predation Risk:** The predation risk, $R(x, y)$, at a location is determined by its proximity to two major wolf den sites, $D_1 = (2.0, 4.0)$ and $D_2 = (10.0, 6.0)$. The total risk is the sum of the risks from each den. The risk from a single den $i$ is modeled by a Gaussian function:\n    $$R_i(x, y) = A \\exp\\left( - \\frac{(x-x_i)^2 + (y-y_i)^2}{2\\sigma^2} \\right)$$\n    where the risk amplitude is $A = 0.80$ (dimensionless) and the spatial scale of risk is $\\sigma = 3.0$ km.\n\n2.  **Elk Foraging Intensity:** The elk foraging intensity, $F(x, y)$, is assumed to be inversely related to the total predation risk. The relationship is given by:\n    $$F(x, y) = \\frac{F_{\\text{max}}}{1 + \\beta R(x,y)}$$\n    where the maximum foraging intensity in a risk-free area is $F_{\\text{max}} = 0.50$ (a dimensionless index) and the elk's sensitivity to risk is $\\beta = 2.5$ (dimensionless).\n\n3.  **Vegetation Dynamics:** The NDVI at a location after one year, $\\text{NDVI}_{\\text{final}}$, is predicted from the initial NDVI, $\\text{NDVI}_{\\text{initial}}$, using the following discrete-time model which combines logistic growth with foraging pressure:\n    $$\\text{NDVI}_{\\text{final}} = \\text{NDVI}_{\\text{initial}} + r \\cdot \\text{NDVI}_{\\text{initial}} \\left(1 - \\frac{\\text{NDVI}_{\\text{initial}}}{K}\\right) - c \\cdot F(x, y)$$\n    The intrinsic aspen growth rate parameter is $r = 0.20$ yr$^{-1}$, the carrying capacity NDVI is $K = 0.85$ (dimensionless), and the foraging impact coefficient is $c = 0.15$ (dimensionless). The time step is one year, thus rates are applied over this period.\n\nConsider a specific aspen grove located at $P_0 = (5.0, 8.0)$, which has an initial NDVI of $\\text{NDVI}_{\\text{initial}} = 0.45$. Using the composite model and parameters provided, predict the NDVI for this grove after one year.\n\nReport your answer as a dimensionless value, rounded to three significant figures.", "solution": "We compute the predation risk at $P_{0}=(5.0,8.0)$ from the two dens $D_{1}=(2.0,4.0)$ and $D_{2}=(10.0,6.0)$ using\n$$\nR_{i}(x,y)=A\\exp\\left(-\\frac{(x-x_{i})^{2}+(y-y_{i})^{2}}{2\\sigma^{2}}\\right),\n$$\nwith $A=0.80$ and $\\sigma=3.0$. The squared distances are\n$$\n(5-2)^{2}+(8-4)^{2}=3^{2}+4^{2}=25,\\qquad (5-10)^{2}+(8-6)^{2}=(-5)^{2}+2^{2}=25+4=29.\n$$\nThus\n$$\nR(P_{0})=A\\left[\\exp\\!\\left(-\\frac{25}{2\\sigma^{2}}\\right)+\\exp\\!\\left(-\\frac{29}{2\\sigma^{2}}\\right)\\right]\n=0.80\\left[\\exp\\!\\left(-\\frac{25}{18}\\right)+\\exp\\!\\left(-\\frac{29}{18}\\right)\\right].\n$$\nNumerically,\n$$\n\\exp\\!\\left(-\\frac{25}{18}\\right)\\approx 0.249352,\\qquad \\exp\\!\\left(-\\frac{29}{18}\\right)\\approx 0.199666,\n$$\nso\n$$\nR(P_{0})\\approx 0.80\\,(0.249352+0.199666)=0.359214.\n$$\n\nElk foraging intensity is\n$$\nF(P_{0})=\\frac{F_{\\text{max}}}{1+\\beta R(P_{0})}=\\frac{0.50}{1+2.5\\times 0.359214}\\approx \\frac{0.50}{1.898036}\\approx 0.263420.\n$$\n\nVegetation dynamics over one year are given by\n$$\n\\text{NDVI}_{\\text{final}}=\\text{NDVI}_{\\text{initial}}+r\\,\\text{NDVI}_{\\text{initial}}\\left(1-\\frac{\\text{NDVI}_{\\text{initial}}}{K}\\right)-c\\,F(P_{0}).\n$$\nWith $\\text{NDVI}_{\\text{initial}}=0.45$, $r=0.20$, $K=0.85$, and $c=0.15$, note that $\\text{NDVI}_{\\text{initial}}/K=(0.45)/(0.85)=9/17$, so\n$$\nr\\,\\text{NDVI}_{\\text{initial}}\\left(1-\\frac{\\text{NDVI}_{\\text{initial}}}{K}\\right)\n=\\frac{1}{5}\\cdot\\frac{9}{20}\\left(1-\\frac{9}{17}\\right)\n=\\frac{1}{5}\\cdot\\frac{9}{20}\\cdot\\frac{8}{17}\n=\\frac{18}{425}\\approx 0.0423529.\n$$\nThe foraging loss term is\n$$\nc\\,F(P_{0})=0.15\\times 0.263420\\approx 0.039513.\n$$\nTherefore,\n$$\n\\text{NDVI}_{\\text{final}}\\approx 0.45+0.0423529-0.039513=0.452840.\n$$\nRounded to three significant figures, the predicted NDVI after one year is $0.453$.", "answer": "$$\\boxed{0.453}$$", "id": "1861427"}]}