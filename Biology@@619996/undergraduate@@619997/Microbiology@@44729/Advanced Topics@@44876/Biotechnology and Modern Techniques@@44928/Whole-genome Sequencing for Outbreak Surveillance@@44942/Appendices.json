{"hands_on_practices": [{"introduction": "Whole-genome sequencing is the bedrock of modern outbreak surveillance, but raw data is not perfect. This exercise simulates a crucial first step in any bioinformatic pipeline: filtering potential genetic variants to separate true mutations from sequencing errors. Mastering this process is essential for ensuring that the genetic distances used to reconstruct transmission events are accurate and reliable. [@problem_id:2105558]", "problem": "A microbiologist is analyzing Whole-Genome Sequencing (WGS) data to investigate a hospital-acquired infection outbreak. A comparison between an isolate from a patient and an environmental sample has produced a raw list of 310 potential Single Nucleotide Polymorphisms (SNPs). To ensure only high-quality variants are considered for phylogenetic analysis, a standard filtering protocol is applied.\n\nThe filtering criteria for a SNP to be considered valid are:\n1.  **Quality Score (QUAL):** A Phred-scaled quality score greater than 50.\n2.  **Read Depth (DP):** A read depth of at least 20 and no more than 200.\n3.  **Allele Frequency (AF):** An allele frequency greater than 0.90 for the variant allele.\n\nAn analysis of the 310 raw SNPs provides the following counts for SNPs that fail one or more of these criteria:\n*   Set Q: 60 SNPs have a QUAL score of 50 or less.\n*   Set D: 45 SNPs have a DP outside the acceptable range [20, 200].\n*   Set A: 55 SNPs have an AF of 0.90 or less.\n*   Intersection $Q \\cap D$: 15 SNPs fail both the QUAL and DP criteria.\n*   Intersection $Q \\cap A$: 20 SNPs fail both the QUAL and AF criteria.\n*   Intersection $D \\cap A$: 12 SNPs fail both the DP and AF criteria.\n*   Intersection $Q \\cap D \\cap A$: 7 SNPs fail all three criteria.\n\nCalculate the number of SNPs that pass all three filtering criteria and are thus considered high-confidence variants. Provide the final answer as an integer.", "solution": "Let $N_{\\text{total}}$ denote the total number of raw SNPs and let $Q$, $D$, and $A$ be the sets of SNPs failing the QUAL, DP, and AF criteria, respectively. The number of SNPs that fail at least one criterion is the cardinality of the union $Q \\cup D \\cup A$, given by the principle of inclusion-exclusion:\n$$\n|Q \\cup D \\cup A| = |Q| + |D| + |A| - |Q \\cap D| - |Q \\cap A| - |D \\cap A| + |Q \\cap D \\cap A|.\n$$\nSubstituting the given values:\n$$\n|Q \\cup D \\cup A| = 60 + 45 + 55 - 15 - 20 - 12 + 7 = 120.\n$$\nThe number of SNPs that pass all three criteria equals the total minus those failing at least one:\n$$\nN_{\\text{pass}} = N_{\\text{total}} - |Q \\cup D \\cup A| = 310 - 120 = 190.\n$$", "answer": "$$\\boxed{190}$$", "id": "2105558"}, {"introduction": "Once high-quality variants are identified, we must interpret them in the context of bacterial evolution. This problem addresses the critical challenge of Horizontal Gene Transfer (HGT), where large DNA segments are exchanged between bacteria, potentially masking the true evolutionary relationship based on clonal descent. By learning to distinguish the slowly evolving \"clonal frame\" from regions affected by HGT, you can calculate a more accurate genetic distance for tracing person-to-person transmission. [@problem_id:2105590]", "problem": "During a public health investigation of a foodborne illness outbreak, epidemiologists use Whole-Genome Sequencing (WGS) to trace the transmission of a suspected pathogen, a highly recombinogenic bacterial species. Genomes are sequenced from isolates collected from two different patients, Patient 1 and Patient 2.\n\nAfter aligning the two genome sequences, a total aligned genome length of $L_{total} = 4.50 \\times 10^6$ base pairs is established. A simple pairwise comparison reveals a total of $N_{total} = 215$ Single Nucleotide Polymorphisms (SNPs) between the two isolates.\n\nFurther bioinformatic analysis suggests that a single, large-scale Horizontal Gene Transfer (HGT) event has occurred in the lineage leading to one of the isolates after their most recent common ancestor. A contiguous genomic region of length $L_{HGT} = 6.00 \\times 10^4$ base pairs is identified as the transferred segment. Within this specific region, there are $N_{HGT} = 185$ SNPs. The remainder of the genome, known as the \"clonal frame,\" is assumed to have evolved vertically through binary fission and point mutations.\n\nTo quantify the impact of this HGT event on the estimation of evolutionary distance, calculate the ratio of the naive pairwise nucleotide divergence to the corrected clonal nucleotide divergence. The naive divergence, $d_{naive}$, is calculated using all SNPs across the entire genome. The corrected clonal divergence, $d_{clonal}$, is calculated using only the SNPs found within the clonal frame.\n\nCalculate the ratio $\\frac{d_{naive}}{d_{clonal}}$ and round your final answer to three significant figures.", "solution": "We are given the total aligned genome length $L_{total} = 4.50 \\times 10^{6}$, total SNPs $N_{total} = 215$, an HGT segment length $L_{HGT} = 6.00 \\times 10^{4}$ with $N_{HGT} = 185$ SNPs. The clonal frame excludes the HGT region.\n\nDefine the naive divergence as the total SNP density across the whole genome:\n$$\nd_{naive} = \\frac{N_{total}}{L_{total}}.\n$$\nDefine the clonal divergence as the SNP density in the clonal frame only. The clonal length and clonal SNP count are\n$$\nL_{clonal} = L_{total} - L_{HGT}, \\quad N_{clonal} = N_{total} - N_{HGT}.\n$$\nThus,\n$$\nd_{clonal} = \\frac{N_{clonal}}{L_{clonal}}.\n$$\nThe requested ratio is\n$$\n\\frac{d_{naive}}{d_{clonal}} = \\frac{\\frac{N_{total}}{L_{total}}}{\\frac{N_{clonal}}{L_{clonal}}} = \\frac{N_{total} L_{clonal}}{N_{clonal} L_{total}}.\n$$\nSubstitute the given values:\n$$\nL_{clonal} = 4.50 \\times 10^{6} - 6.00 \\times 10^{4} = 4.44 \\times 10^{6}, \\quad N_{clonal} = 215 - 185 = 30.\n$$\nHence,\n$$\n\\frac{d_{naive}}{d_{clonal}} = \\frac{215 \\times \\left(4.44 \\times 10^{6}\\right)}{30 \\times \\left(4.50 \\times 10^{6}\\right)} = \\frac{215}{30} \\cdot \\frac{4.44}{4.50}.\n$$\nSimplify exactly:\n$$\n\\frac{215}{30} = \\frac{43}{6}, \\quad \\frac{4.44}{4.50} = \\frac{444}{450} = \\frac{74}{75},\n$$\nso\n$$\n\\frac{d_{naive}}{d_{clonal}} = \\frac{43}{6} \\cdot \\frac{74}{75} = \\frac{1591}{225} \\approx 7.071\\overline{1}.\n$$\nRounded to three significant figures, this is $7.07$.", "answer": "$$\\boxed{7.07}$$", "id": "2105590"}, {"introduction": "In the real world, genomic data is most powerful when combined with traditional epidemiological information. This practice challenges you to think like a true genomic epidemiologist by integrating genetic relatedness with patient location and symptom onset data. You will use a quantitative model to identify a probable \"missing link\" in a transmission chain, demonstrating how synthesizing diverse datasets can solve complex outbreak puzzles. [@problem_id:2105596]", "problem": "An investigation is underway at a hospital to understand the transmission dynamics of a bacterial outbreak. Whole-Genome Sequencing (WGS) has been performed on isolates from all known infected patients. The genetic relatedness between any two isolates is quantified by the number of Single Nucleotide Polymorphism (SNP) differences between their genomes.\n\nInvestigators are focusing on two particular patients, Case K1 and Case K2, who are suspected to be part of the same transmission chain. However, the genetic distance between their isolates is larger than expected for a direct transmission event, suggesting the existence of one or more unobserved intermediary patients. Four other patients (P1, P2, P3, and P4), who were in the hospital during the same period but were not initially considered part of this specific chain, are now being evaluated as potential intermediaries.\n\nTo identify the most likely intermediary linking K1 and K2, a \"Transmission Plausibility Score\" (TPS) is calculated for each potential intermediary patient (PI). The patient with the highest TPS is considered the most probable missing link. The TPS is defined as the product of a genetic score and an epidemiological score:\n\n$TPS(PI) = S_{genetic}(PI) \\times S_{epid}(PI)$\n\nThe genetic score, $S_{genetic}(PI)$, measures how well the intermediary's genome fits on the path between K1 and K2. It is given by:\n$$S_{genetic}(PI) = \\frac{1}{1 + |(\\text{SNP(K1, PI)} + \\text{SNP(PI, K2)}) - \\text{SNP(K1, K2)}|}$$\nwhere $\\text{SNP(A, B)}$ is the SNP distance between patient A and patient B.\n\nThe epidemiological score, $S_{epid}(PI)$, determines if a transmission pathway through the intermediary is possible based on location and timing. It is defined as:\n$$S_{epid}(PI) = L(\\text{K1, PI}) \\times L(\\text{PI, K2})$$\nThe term $L(\\text{A, B})$ represents a plausible transmission link from patient A to patient B. $L(\\text{A, B}) = 1$ if both of the following conditions are met, and $L(\\text{A, B}) = 0$ otherwise:\n1.  **Temporal-Spatial Overlap**: Patient A and Patient B were located in the same ward for at least one full day.\n2.  **Causal Directionality**: The symptom onset day of patient B is strictly later than the symptom onset day of patient A.\n\nThe relevant data are provided below.\n\n**Table 1: SNP Distance Matrix**\n| | K1 | K2 | P1 | P2 | P3 | P4 |\n|:---:|:---:|:---:|:---:|:---:|:---:|:---:|\n| **K1**| 0 | 12 | 5 | 8 | 13 | 4 |\n| **K2**| 12 | 0 | 7 | 4 | 6 | 9 |\n| **P1**| 5 | 7 | 0 | 6 | 9 | 3 |\n| **P2**| 8 | 4 | 6 | 0 | 10 | 7 |\n| **P3**| 13 | 6 | 9 | 10 | 0 | 11|\n| **P4**| 4 | 9 | 3 | 7 | 11 | 0 |\n\n**Table 2: Patient Epidemiological Data**\n| Patient | Symptom Onset Day | Ward Stay |\n|:---:|:---:|:---|\n| **K1**| 5 | Ward A (Day 1 - 8) |\n| **K2**| 20 | Ward C (Day 18 - 25) |\n| **P1**| 12 | Ward A (Day 7 - 10), Ward C (Day 17 - 21) |\n| **P2**| 10 | Ward B (Day 6 - 12), Ward D (Day 12 - 16) |\n| **P3**| 14 | Ward A (Day 6 - 12), Ward C (Day 15 - 20) |\n| **P4**| 9 | Ward A (Day 2 - 6) |\n\nBased on the highest Transmission Plausibility Score, which patient is the most likely unobserved intermediary linking Case K1 and Case K2?\n\nA. P1\n\nB. P2\n\nC. P3\n\nD. P4", "solution": "We are to compute, for each potential intermediary $PI \\in \\{P1,P2,P3,P4\\}$, the Transmission Plausibility Score\n$$\nTPS(PI) = S_{genetic}(PI) \\times S_{epid}(PI),\n$$\nwhere\n$$\nS_{genetic}(PI) = \\frac{1}{1 + |(\\text{SNP(K1, PI)} + \\text{SNP(PI, K2)}) - \\text{SNP(K1, K2)}|}\n$$\nand\n$$\nS_{epid}(PI) = L(\\text{K1, PI}) \\times L(\\text{PI, K2}).\n$$\nThe link indicator $L(\\text{A, B})$ equals $1$ if and only if both conditions hold: (i) A and B share the same ward with at least one full day overlap, and (ii) onset day of B is strictly later than onset day of A; otherwise $L(\\text{A, B})=0$. We use the ward intervals and onset days from Table 2 and SNP distances from Table 1.\n\nFirst, compute $S_{epid}$ by evaluating $L(\\text{K1, PI})$ and $L(\\text{PI, K2})$.\n\nFor $PI = P1$:\n- $L(\\text{K1, P1})$: K1 is in Ward A on $[1,8]$, P1 is in Ward A on $[7,10]$. The overlap is $[7,8]$, which contains at least one full day. Onset times satisfy $12 > 5$. Hence $L(\\text{K1, P1})=1$.\n- $L(\\text{P1, K2})$: P1 is in Ward C on $[17,21]$, K2 is in Ward C on $[18,25]$. The overlap is $[18,21]$, which contains at least one full day. Onset times satisfy $20 > 12$. Hence $L(\\text{P1, K2})=1$.\nTherefore $S_{epid}(P1) = 1 \\times 1 = 1$.\n\nFor $PI = P2$:\n- $L(\\text{K1, P2})$: K1 is in Ward A; P2 is in Wards B and D only, so there is no same-ward overlap. Hence $L(\\text{K1, P2})=0$.\n- $L(\\text{P2, K2})$: K2 is in Ward C; P2 not in Ward C. Hence $L(\\text{P2, K2})=0$.\nTherefore $S_{epid}(P2) = 0 \\times 0 = 0$.\n\nFor $PI = P3$:\n- $L(\\text{K1, P3})$: K1 in Ward A on $[1,8]$, P3 in Ward A on $[6,12]$. The overlap is $[6,8]$, at least one full day, and $14 > 5$. Hence $L(\\text{K1, P3})=1$.\n- $L(\\text{P3, K2})$: P3 in Ward C on $[15,20]$, K2 in Ward C on $[18,25]$. The overlap is $[18,20]$, at least one full day, and $20 > 14$. Hence $L(\\text{P3, K2})=1$.\nTherefore $S_{epid}(P3) = 1 \\times 1 = 1$.\n\nFor $PI = P4$:\n- $L(\\text{K1, P4})$: K1 in Ward A on $[1,8]$, P4 in Ward A on $[2,6]$. The overlap is $[2,6]$, at least one full day, and $9 > 5$. Hence $L(\\text{K1, P4})=1$.\n- $L(\\text{P4, K2})$: P4 only in Ward A; K2 only in Ward C. No same-ward overlap, so $L(\\text{P4, K2})=0$.\nTherefore $S_{epid}(P4) = 1 \\times 0 = 0$.\n\nNext, compute $S_{genetic}$ for each $PI$ using SNP distances from Table 1, noting $\\text{SNP(K1, K2)} = 12$.\n\nFor $PI = P1$:\n$$\n\\text{SNP(K1, P1)} = 5,\\quad \\text{SNP(P1, K2)} = 7,\\quad 5 + 7 = 12.\n$$\nThus\n$$\nS_{genetic}(P1) = \\frac{1}{1 + |12 - 12|} = \\frac{1}{1 + 0} = 1.\n$$\n\nFor $PI = P2$:\n$$\n\\text{SNP(K1, P2)} = 8,\\quad \\text{SNP(P2, K2)} = 4,\\quad 8 + 4 = 12.\n$$\nThus\n$$\nS_{genetic}(P2) = \\frac{1}{1 + |12 - 12|} = 1.\n$$\n\nFor $PI = P3$:\n$$\n\\text{SNP(K1, P3)} = 13,\\quad \\text{SNP(P3, K2)} = 6,\\quad 13 + 6 = 19.\n$$\nThus\n$$\nS_{genetic}(P3) = \\frac{1}{1 + |19 - 12|} = \\frac{1}{1 + 7} = \\frac{1}{8}.\n$$\n\nFor $PI = P4$:\n$$\n\\text{SNP(K1, P4)} = 4,\\quad \\text{SNP(P4, K2)} = 9,\\quad 4 + 9 = 13.\n$$\nThus\n$$\nS_{genetic}(P4) = \\frac{1}{1 + |13 - 12|} = \\frac{1}{1 + 1} = \\frac{1}{2}.\n$$\n\nFinally, compute $TPS$:\n- $TPS(P1) = S_{genetic}(P1) \\times S_{epid}(P1) = 1 \\times 1 = 1$.\n- $TPS(P2) = 1 \\times 0 = 0$.\n- $TPS(P3) = \\frac{1}{8} \\times 1 = \\frac{1}{8}$.\n- $TPS(P4) = \\frac{1}{2} \\times 0 = 0$.\n\nThe highest Transmission Plausibility Score is for $P1$. Therefore, the most likely intermediary is option A.", "answer": "$$\\boxed{A}$$", "id": "2105596"}]}