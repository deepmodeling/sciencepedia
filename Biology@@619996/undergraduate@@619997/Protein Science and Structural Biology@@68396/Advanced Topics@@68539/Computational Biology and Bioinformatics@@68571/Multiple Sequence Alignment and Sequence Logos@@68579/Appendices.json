{"hands_on_practices": [{"introduction": "A key step in analyzing a Multiple Sequence Alignment (MSA) is to quantify the degree of conservation at each position. Shannon entropy provides a powerful mathematical framework for this, measuring the uncertainty or variability within a column of the alignment. This exercise [@problem_id:2121514] provides a foundational, hands-on calculation of Shannon entropy for a single column, helping you build an intuitive understanding of how this value reflects amino acid diversity.", "problem": "A researcher is studying the conservation of a critical active site residue in a family of homologous enzymes. They have constructed a Multiple Sequence Alignment (MSA) from 20 related protein sequences. At a specific column in this alignment, which corresponds to the active site residue, they observe the following distribution of amino acids: 12 sequences have Glutamate (E), 6 have Aspartate (D), and 2 have Alanine (A). No other amino acid types are present at this position.\n\nTo quantify the variability at this position, the researcher decides to calculate the Shannon entropy, $H$. The Shannon entropy for a given position in an alignment is defined by the formula:\n$$H = -\\sum_{i=1}^{k} p_i \\log_2(p_i)$$\nwhere $k$ is the number of distinct amino acid types present at the position, and $p_i$ is the frequency of the $i$-th amino acid type.\n\nCalculate the Shannon entropy for this specific column in the alignment. Express your answer in bits, rounded to three significant figures.", "solution": "There are $N=20$ sequences. The observed counts at the column are: $12$ E, $6$ D, and $2$ A, so the empirical probabilities are\n$$p_{E}=\\frac{12}{20}=\\frac{3}{5}=0.6,\\quad p_{D}=\\frac{6}{20}=\\frac{3}{10}=0.3,\\quad p_{A}=\\frac{2}{20}=\\frac{1}{10}=0.1.$$\nThe Shannon entropy in bits is\n$$H=-\\sum_{i} p_{i}\\log_{2}(p_{i})= -\\left(0.6\\log_{2}(0.6)+0.3\\log_{2}(0.3)+0.1\\log_{2}(0.1)\\right).$$\nUsing $\\log_{2}(x)=\\frac{\\ln x}{\\ln 2}$ to evaluate numerically,\n$$\\log_{2}(0.6)\\approx -0.736965594,\\quad \\log_{2}(0.3)\\approx -1.736965594,\\quad \\log_{2}(0.1)\\approx -3.321928095.$$\nThus,\n$$H\\approx -\\left[0.6(-0.736965594)+0.3(-1.736965594)+0.1(-3.321928095)\\right] \\approx 1.295461844.$$\nRounding to three significant figures gives $H\\approx 1.30$ bits.", "answer": "$$\\boxed{1.30}$$", "id": "2121514"}, {"introduction": "While the most frequent residue often defines the consensus sequence, this simple \"majority rule\" approach can overlook important biochemical similarities between amino acids. More sophisticated methods use substitution matrices to find a consensus residue that is most compatible with all residues observed at a position. This practice [@problem_id:2121462] explores a thought-provoking scenario where the biochemically-informed consensus residue is not the most common one, highlighting the importance of incorporating evolutionary and structural information into sequence analysis.", "problem": "In bioinformatics, a consensus sequence is derived from a Multiple Sequence Alignment (MSA) to represent the most common residues at each position. While often determined by a simple majority, more sophisticated methods use scoring matrices to account for the biochemical similarity of amino acids.\n\nAn analyst is studying a crucial active site position in an MSA containing 20 sequences of a particular enzyme family. The amino acids observed at this position are:\nL, L, L, L, L, L, P, L, L, L, P, L, L, L, L, P, L, P, L, L\n\nA scoring-based method is used to determine the consensus residue. The consensus amino acid for the position is defined as the amino acid `X` that maximizes the total alignment score. The total score for a candidate residue `X` is calculated by summing the substitution scores `S(X, Y)` for every observed residue `Y` in the column. The candidate residues to be tested are Isoleucine (I), Leucine (L), Proline (P), and Valine (V).\n\nThe relevant substitution scores `S(Candidate, Observed)` are given in the table below:\n\n| | Observed: L | Observed: P |\n| :--- | :---: | :---: |\n| **Candidate: I** | 4 | -1 |\n| **Candidate: L** | 4 | -4 |\n| **Candidate: P** | -4 | 7 |\n| **Candidate: V** | 2 | -2 |\n\nBased on this scoring method, which of the following amino acids is the consensus residue for this position?\n\nA) I\n\nB) L\n\nC) P\n\nD) V", "solution": "We are given a multiple sequence alignment column with observed residues consisting only of leucine and proline. Counting from the list, there are $16$ occurrences of L and $4$ occurrences of P. Denote these counts by $n_{L}=16$ and $n_{P}=4$.\n\nFor a candidate residue $X$, the total alignment score is defined as\n$$\nT(X)=\\sum_{\\text{observed }Y} S(X,Y)=n_{L}\\,S(X,L)+n_{P}\\,S(X,P).\n$$\nUsing the provided substitution scores, compute for each candidate:\n\nFor $X=\\text{I}$:\n$$\nT(\\text{I})=n_{L}\\,S(\\text{I},\\text{L})+n_{P}\\,S(\\text{I},\\text{P})=16\\cdot 4+4\\cdot(-1)=64-4=60.\n$$\n\nFor $X=\\text{L}$:\n$$\nT(\\text{L})=n_{L}\\,S(\\text{L},\\text{L})+n_{P}\\,S(\\text{L},\\text{P})=16\\cdot 4+4\\cdot(-4)=64-16=48.\n$$\n\nFor $X=\\text{P}$:\n$$\nT(\\text{P})=n_{L}\\,S(\\text{P},\\text{L})+n_{P}\\,S(\\text{P},\\text{P})=16\\cdot(-4)+4\\cdot 7=-64+28=-36.\n$$\n\nFor $X=\\text{V}$:\n$$\nT(\\text{V})=n_{L}\\,S(\\text{V},\\text{L})+n_{P}\\,S(\\text{V},\\text{P})=16\\cdot 2+4\\cdot(-2)=32-8=24.\n$$\n\nThe maximum total score is $60$, attained by $X=\\text{I}$. Therefore, the consensus residue under this scoring method corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "2121462"}, {"introduction": "The ultimate goal of analyzing a motif, like a DNA-binding site, is often to understand its function and even design new variants. However, a simple consensus sequence derived from an MSA is sometimes non-functional, as it may not capture subtle but critical sequence features. This advanced problem [@problem_id:2121521] challenges you to move beyond simple consensus generation by using information content to design a \"Functionally Weighted Consensus Sequence,\" demonstrating how quantitative analysis can lead to more successful experimental hypotheses.", "problem": "A team of biochemists is studying a novel DNA-binding transcription factor. Through a high-throughput screening experiment, they have identified 100 different 8-base-pair DNA sequences to which this factor binds. A Multiple Sequence Alignment (MSA) of these sequences was performed to identify the preferred binding site.\n\nFrom the MSA, the base frequencies at each of the 8 positions were calculated and are presented in the table below:\n\n| Position | Frequency of A | Frequency of C | Frequency of G | Frequency of T |\n|:--------:|:--------------:|:--------------:|:--------------:|:--------------:|\n|     1    |      0.05      |      0.85      |      0.05      |      0.05      |\n|     2    |      0.90      |      0.02      |      0.05      |      0.03      |\n|     3    |      0.01      |      0.01      |      0.97      |      0.01      |\n|     4    |      0.40      |      0.25      |      0.25      |      0.10      |\n|     5    |      0.10      |      0.20      |      0.30      |      0.40      |\n|     6    |      0.95      |      0.02      |      0.01      |      0.02      |\n|     7    |      0.05      |      0.90      |      0.03      |      0.02      |\n|     8    |      0.10      |      0.05      |      0.80      |      0.05      |\n\nA \"simple consensus\" sequence was constructed by choosing the most frequent base at each position. However, when this simple consensus sequence was synthesized and tested in a binding assay, it failed to show any significant affinity for the transcription factor.\n\nThe lead scientist hypothesizes that positions with low sequence conservation (i.e., high variability) might require a non-dominant base for structural reasons or to avoid a negative interaction. To test this, you are tasked with designing a \"Functionally Weighted Consensus Sequence\" based on the following rules:\n\n1.  For each position $i$ (from 1 to 8), calculate the information content $R_i$. The information content is given by the formula $R_i = \\log_2(4) - H_i$, where $H_i$ is the Shannon entropy at that position.\n2.  The Shannon entropy is calculated as $H_i = -\\sum_{b \\in \\{A,C,G,T\\}} p_{i,b} \\log_2(p_{i,b})$, where $p_{i,b}$ is the frequency of base $b$ at position $i$. For this calculation, use the convention that $p \\log_2(p) = 0$ if $p=0$.\n3.  For each position $i$:\n    a. If the information content $R_i$ is greater than or equal to a threshold of $1.0$ bit, select the most frequent base.\n    b. If the information content $R_i$ is less than $1.0$ bit, select the *second* most frequent base.\n4.  If there is a tie for the most frequent or second most frequent base, select the base that comes first in alphabetical order (A, then C, then G, then T).\n\nDetermine the 8-base-pair Functionally Weighted Consensus Sequence.", "solution": "We are given base frequencies $p_{i,b}$ at each position $i \\in \\{1,\\dots,8\\}$ for $b \\in \\{A,C,G,T\\}$. For each position, compute the Shannon entropy\n$$\nH_{i}=-\\sum_{b \\in \\{A,C,G,T\\}} p_{i,b}\\log_{2}\\left(p_{i,b}\\right),\n$$\nwith the convention that $p\\log_{2}(p)=0$ if $p=0$, and the information content\n$$\nR_{i}=\\log_{2}(4)-H_{i}=2-H_{i}.\n$$\nSelection rule: if $R_{i}\\geq 1.0$ bit, choose the most frequent base; if $R_{i}<1.0$ bit, choose the second most frequent base; break ties alphabetically (A, then C, then G, then T).\n\nPosition $1$: $p=(0.05,0.85,0.05,0.05)$.\n$$\nH_{1}=-\\big(0.05\\log_{2}0.05+0.85\\log_{2}0.85+0.05\\log_{2}0.05+0.05\\log_{2}0.05\\big)\\approx 0.8476,\n$$\nso $R_{1}=2-0.8476\\approx 1.1524\\geq 1$. Choose the most frequent base: $C$.\n\nPosition $2$: $p=(0.90,0.02,0.05,0.03)$.\n$$\nH_{2}\\approx -\\big(0.90\\log_{2}0.90+0.02\\log_{2}0.02+0.05\\log_{2}0.05+0.03\\log_{2}0.03\\big)\\approx 0.6175,\n$$\nso $R_{2}\\approx 1.3825\\geq 1$. Choose the most frequent base: $A$.\n\nPosition $3$: $p=(0.01,0.01,0.97,0.01)$.\n$$\nH_{3}\\approx -\\big(0.01\\log_{2}0.01+0.01\\log_{2}0.01+0.97\\log_{2}0.97+0.01\\log_{2}0.01\\big)\\approx 0.2417,\n$$\nso $R_{3}\\approx 1.7583\\geq 1$. Choose the most frequent base: $G$.\n\nPosition $4$: $p=(0.40,0.25,0.25,0.10)$.\n$$\nH_{4}= -\\big(0.40\\log_{2}0.40+0.25\\log_{2}0.25+0.25\\log_{2}0.25+0.10\\log_{2}0.10\\big)\\approx 1.8610,\n$$\nso $R_{4}\\approx 0.1390<1$. Choose the second most frequent base. The top frequencies are $0.40$ for $A$ (most) and $0.25$ for $C$ and $G$ (second, tie). Break the tie alphabetically, so choose $C$.\n\nPosition $5$: $p=(0.10,0.20,0.30,0.40)$.\n$$\nH_{5}= -\\big(0.10\\log_{2}0.10+0.20\\log_{2}0.20+0.30\\log_{2}0.30+0.40\\log_{2}0.40\\big)\\approx 1.8464,\n$$\nso $R_{5}\\approx 0.1536<1$. Choose the second most frequent base. The ranking is $0.40$ (most, $T$), $0.30$ (second, $G$), $0.20$ ($C$), $0.10$ ($A$). Choose $G$.\n\nPosition $6$: $p=(0.95,0.02,0.01,0.02)$.\n$$\nH_{6}\\approx -\\big(0.95\\log_{2}0.95+0.02\\log_{2}0.02+0.01\\log_{2}0.01+0.02\\log_{2}0.02\\big)\\approx 0.3616,\n$$\nso $R_{6}\\approx 1.6384\\geq 1$. Choose the most frequent base: $A$.\n\nPosition $7$: $p=(0.05,0.90,0.03,0.02)$.\n$$\nH_{7}\\approx -\\big(0.05\\log_{2}0.05+0.90\\log_{2}0.90+0.03\\log_{2}0.03+0.02\\log_{2}0.02\\big)\\approx 0.6175,\n$$\nso $R_{7}\\approx 1.3825\\geq 1$. Choose the most frequent base: $C$.\n\nPosition $8$: $p=(0.10,0.05,0.80,0.05)$.\n$$\nH_{8}= -\\big(0.10\\log_{2}0.10+0.05\\log_{2}0.05+0.80\\log_{2}0.80+0.05\\log_{2}0.05\\big)\\approx 1.0219,\n$$\nso $R_{8}\\approx 0.9781<1$. Choose the second most frequent base. The ranking is $0.80$ (most, $G$), $0.10$ (second, $A$), $0.05$ ($C$ and $T$). Choose $A$.\n\nCollecting choices by position gives the Functionally Weighted Consensus Sequence: $C,A,G,C,G,A,C,A$, i.e., $CAGCGACA$.", "answer": "$$\\boxed{CAGCGACA}$$", "id": "2121521"}]}