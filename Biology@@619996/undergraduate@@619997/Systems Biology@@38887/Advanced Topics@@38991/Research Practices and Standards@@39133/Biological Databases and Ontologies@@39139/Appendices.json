{"hands_on_practices": [{"introduction": "Ontologies like the Gene Ontology (GO) are more than just controlled vocabularies; they are powerful tools that structure biological knowledge as a directed acyclic graph ($DAG$). This exercise provides hands-on practice in navigating this hierarchical structure to compute a distance metric between two terms. Mastering this skill is fundamental to understanding how computational tools quantify the functional relationships between genes and proteins based on their annotations [@problem_id:1419513].", "problem": "The Gene Ontology (GO) provides a structured, computable representation of our knowledge about the functions of genes and proteins. It is organized as a directed acyclic graph (DAG), where each term represents a biological concept, and directed edges represent relationships such as 'is_a' or 'part_of' from a more specific term (child) to a more general term (parent).\n\nConsider the following simplified subset of the GO 'biological process' ontology, where the parent(s) of each term are listed. The term 'biological_process' (GO:0008150) is the root of this hierarchy and has no parents.\n\n*   **Term (ID): Parents**\n*   'cellular_process' (GO:0009987): {'biological_process'}\n*   'metabolic_process' (GO:0008152): {'biological_process'}\n*   'cellular_component_organization' (GO:0016043): {'cellular_process'}\n*   'catabolic_process' (GO:0009056): {'cellular_process', 'metabolic_process'}\n*   'organelle_organization' (GO:0007031): {'cellular_component_organization'}\n*   'autophagy' (GO:0006914): {'catabolic_process'}\n*   'organelle_fission' (GO:0044594): {'organelle_organization'}\n*   'selective_autophagy' (GO:0043936): {'autophagy'}\n*   'mitochondrial_fission' (GO:0000266): {'organelle_fission'}\n*   'mitophagy' (GO:0000422): {'selective_autophagy'}\n\nFor any two terms in the ontology, we can define a path between them that traverses up the hierarchy to a common ancestor and back down. The \"shortest path length\" between two terms is defined as the sum of the number of edges on the path from the first term up to their Most Specific Common Ancestor (MSCA), and the number of edges on the path from the second term up to the same MSCA.\n\nThe Most Specific Common Ancestor (MSCA) is the common ancestor between two terms that has the greatest depth. The \"depth\" of a term is the number of edges in the longest possible path from the root ('biological_process') to that term.\n\nCalculate the shortest path length between 'mitophagy' (GO:0000422) and 'mitochondrial_fission' (GO:0000266) based on the provided ontology structure.", "solution": "We first list the parent relations as upward edges (from child to parent). For each queried term, we enumerate its ancestors by following parents repeatedly up to the root.\n\nAncestors of mitophagy (GO:0000422):\nmitophagy → selective_autophagy → autophagy → catabolic_process → {cellular_process, metabolic_process} → biological_process.\nHence the ancestor set is $\\{\\text{mitophagy}, \\text{selective\\_autophagy}, \\text{autophagy}, \\text{catabolic\\_process}, \\text{cellular\\_process}, \\text{metabolic\\_process}, \\text{biological\\_process}\\}$.\n\nAncestors of mitochondrial_fission (GO:0000266):\nmitochondrial_fission → organelle_fission → organelle_organization → cellular_component_organization → cellular_process → biological_process.\nHence the ancestor set is $\\{\\text{mitochondrial\\_fission}, \\text{organelle\\_fission}, \\text{organelle\\_organization}, \\text{cellular\\_component\\_organization}, \\text{cellular\\_process}, \\text{biological\\_process}\\}$.\n\nThe common ancestors are $\\{\\text{cellular\\_process}, \\text{biological\\_process}\\}$. To identify the Most Specific Common Ancestor (MSCA), we compare their depths, defined as the number of edges in the longest path from the root $\\text{biological\\_process}$ to the term. We have:\n- $\\text{depth}(\\text{biological\\_process}) = 0$.\n- $\\text{depth}(\\text{cellular\\_process}) = 1$.\n\nTherefore, the MSCA is $\\text{cellular\\_process}$.\n\nThe shortest path length is defined as the sum of the number of edges from each term up to the MSCA. Compute these upward distances:\n- From mitophagy to cellular_process: mitophagy → selective_autophagy (1) → autophagy (2) → catabolic_process (3) → cellular_process (4), giving $4$ edges.\n- From mitochondrial_fission to cellular_process: mitochondrial_fission → organelle_fission (1) → organelle_organization (2) → cellular_component_organization (3) → cellular_process (4), giving $4$ edges.\n\nSumming these gives the shortest path length:\n$$4 + 4 = 8.$$", "answer": "$$\\boxed{8}$$", "id": "1419513"}, {"introduction": "Pathway enrichment analysis is a cornerstone technique for interpreting high-throughput 'omics data, but its results are only as reliable as the underlying databases. This practice delves into a common and often confusing scenario: why two premier pathway databases, KEGG and Reactome, can produce different top-ranked pathways from the same gene list. By working through this, you will gain critical insight into how a database's curation philosophy and structural granularity directly influence analytical outcomes [@problem_id:1419489].", "problem": "A systems biology student is analyzing a list of differentially expressed genes obtained from a human cell culture experiment after treatment with a novel pharmaceutical compound. To understand the functional implications, the student performs a pathway enrichment analysis on this gene list using two different, widely-used databases: the Kyoto Encyclopedia of Genes and Genomes (KEGG) and the Reactome database.\n\nThe analysis using the KEGG database identifies \"Metabolism of xenobiotics by cytochrome P450\" as the most significantly enriched pathway. In contrast, the analysis using the Reactome database reports \"Phase I - Functionalization of compounds\" as the top hit. Both results are statistically significant and biologically plausible, as \"Phase I - Functionalization\" is a known part of xenobiotic metabolism. The student is puzzled by why the two analyses, run on the identical gene list, would highlight pathways with different names and conceptual scopes as the top result.\n\nWhich of the following statements provides the most accurate and fundamental explanation for this observation?\n\nA. Reactome pathways are organized in a fine-grained, hierarchical manner, representing specific molecular events, whereas KEGG pathways are curated as broader, more generalized reference maps. The observed difference arises because the student's gene list is most significantly concentrated in the specific sub-process that Reactome isolates as a distinct pathway.\n\nB. The KEGG database is updated on a different, less frequent schedule than the Reactome database, meaning its pathway definitions are likely older and do not reflect the most current understanding of xenobiotic metabolism.\n\nC. The underlying statistical tests used for enrichment are fundamentally different; KEGG analysis tools typically use a one-tailed Fisher's exact test, while Reactome tools default to a binomial test, leading to different pathway rankings.\n\nD. The discrepancy is due to the core focus of each database; KEGG is primarily designed for metabolic pathways, while Reactome is optimized for cell signaling and cell cycle processes, leading to different pathway annotations for the same genes.\n\nE. The Reactome database contains a significantly larger number of total annotated human genes than the KEGG database, which changes the background gene set and consequently alters the calculation of enrichment scores for all pathways.", "solution": "We are asked to explain why two enrichment analyses on the same gene list, using KEGG and Reactome, return different top pathway names with different conceptual scopes, even though both are statistically significant and biologically consistent with xenobiotic metabolism.\n\nStep 1: Identify what enrichment analysis depends on.\n- Over-representation analysis evaluates whether the input gene list is statistically overrepresented in predefined gene sets. The outcome depends crucially on the definitions and boundaries of those gene sets in the reference database.\n- Therefore, differences in pathway definitions, granularity, and hierarchy across databases can produce different top-ranking terms for the same biological signal.\n\nStep 2: Characterize KEGG pathway curation.\n- KEGG curates pathways as broad, reference maps that bundle together multiple sub-processes and components into comprehensive diagrams. For xenobiotic metabolism, KEGG maps typically include Phase I (functionalization via cytochrome P450), Phase II (conjugation), and sometimes associated transport and downstream routes in an integrated map.\n- Hence, a KEGG top hit like \"Metabolism of xenobiotics by cytochrome P450\" reflects a broad pathway that encompasses several sub-processes.\n\nStep 3: Characterize Reactome pathway curation.\n- Reactome is event-based and explicitly hierarchical. It organizes biology into a fine-grained hierarchy of pathways, sub-pathways, and reactions with parent-child relationships.\n- As part of xenobiotic metabolism, Reactome distinguishes specific sub-processes such as \"Phase I - Functionalization of compounds\" as distinct child pathways under broader parents.\n\nStep 4: Infer the cause of the observed difference.\n- If the gene list is particularly enriched for Phase I enzymes (for example, specific cytochrome P450s and associated reductases), Reactome will rank the specific sub-process \"Phase I - Functionalization of compounds\" as the top hit due to its fine-grained pathway definitions.\n- KEGG, because it aggregates related sub-processes into a single broader map, will highlight the encompassing xenobiotic metabolism pathway, such as \"Metabolism of xenobiotics by cytochrome P450.\"\n- Thus, both results point to the same underlying biology, but the naming and scope differ because of the databases’ distinct curation philosophies and levels of granularity.\n\nStep 5: Evaluate alternative explanations (options B–E).\n- B (update schedule differences) is not a fundamental nor generally accurate explanation; both databases are actively maintained, and the observed difference aligns with curation granularity rather than currency.\n- C (different statistical tests) is not inherently true for KEGG versus Reactome; both are commonly analyzed via over-representation tests (e.g., Fisher’s exact test) depending on the tool. The core discrepancy here arises from pathway definitions, not necessarily from different default tests.\n- D (different core focus: metabolism versus signaling) does not explain the case, because both databases include metabolism comprehensively; Reactome’s top hit is a metabolic sub-process, not a signaling term.\n- E (different background gene universes) can influence p-values but does not fundamentally explain why conceptually different pathway names with nested scopes emerge as top hits; the presented pair specifically reflects hierarchical versus broad curation.\n\nConclusion: The most accurate and fundamental explanation is that Reactome’s fine-grained, hierarchical, event-based curation isolates specific sub-processes as distinct pathways, whereas KEGG aggregates broader processes into reference maps. The gene list is most concentrated in the Phase I sub-process, producing the observed difference in top pathway names.\n\nTherefore, the correct choice is A.", "answer": "$$\\boxed{A}$$", "id": "1419489"}, {"introduction": "A frequent challenge in genomics, especially for newly sequenced organisms, is assigning functions to hypothetical proteins when automated tools provide conflicting annotations. This advanced practice simulates a real-world bioinformatics problem, tasking you with building a quantitative framework to resolve such a conflict. You will learn to integrate disparate lines of evidence—sequence homology, protein domain architecture, and gene co-expression—into a single, weighted score to make a more confident and defensible functional assignment [@problem_id:1419495].", "problem": "A team of computational biologists is working on the metabolic reconstruction of a newly sequenced extremophilic archaeon, *Thermovibrio syntheticus*. They have identified a critical gap in the pantothenate biosynthesis pathway, specifically the reaction that converts L-aspartate into β-alanine. A single hypothetical protein, encoded by gene `TS_1337`, is the prime candidate for this missing function. However, two major biological databases provide conflicting predictions for the enzyme's identity.\n\n- The Kyoto Encyclopedia of Genes and Genomes (KEGG) annotation pipeline suggests `TS_1337` encodes an **Aspartate 1-decarboxylase (PanD)**, with Enzyme Commission (EC) number 4.1.1.11.\n- The Reactome database annotation suggests `TS_1337` encodes a **Glutamate decarboxylase (GAD)**, with EC number 4.1.1.15, which is known to have promiscuous activity on L-aspartate in some related organisms.\n\nTo resolve this conflict, you must apply a quantitative evidence integration framework. The integrated evidence score, $S$, for each candidate enzyme (PanD and GAD) is calculated using the following weighted formula:\n$$S = 0.4 \\times S_{\\text{homology}} + 0.3 \\times S_{\\text{domain}} + 0.3 \\times S_{\\text{coexpression}}$$\n\nYou are provided with the following pieces of bioinformatics data:\n\n1.  **Homology Evidence ($S_{\\text{homology}}$):** A BLASTp search of the TS_1337 protein sequence against a curated reference database was performed. The bit-score of a protein's own sequence aligned against itself is 580.\n    - The highest bit-score alignment to a verified PanD protein is 450.\n    - The highest bit-score alignment to a verified GAD protein is 310.\n    The homology score is defined as the ratio of the candidate's bit-score to the self-alignment bit-score: $S_{\\text{homology}} = \\frac{\\text{bit-score}}{\\text{self-score}}$.\n\n2.  **Protein Domain Evidence ($S_{\\text{domain}}$):** The protein sequence of TS_1337 was analyzed with InterProScan, and its constituent domains were compared against the canonical domains for the PanD and GAD enzyme families.\n    - Domains identified in the TS_1337 protein: {IPR002047, IPR001633, IPR036858}\n    - Canonical domains for the PanD family: {IPR002047, IPR001633, IPR020846}\n    - Canonical domains for the GAD family: {IPR002047, IPR019866}\n    The domain score is defined by the Jaccard similarity index between the set of domains in TS_1337 ($A$) and the set of canonical domains for the candidate family ($B$): $S_{\\text{domain}} = \\frac{|A \\cap B|}{|A \\cup B|}$.\n\n3.  **Gene Co-expression Evidence ($S_{\\text{coexpression}}$):** Analysis of transcriptomic data identified 10 other genes that are highly co-expressed with `TS_1337`. Their functions were annotated via their pathway involvement.\n    - 6 of the co-expressed genes belong to the \"Pantothenate and CoA biosynthesis\" pathway (KEGG map: ko00770).\n    - 2 of the co-expressed genes belong to the \"Glutamate metabolism\" pathway (KEGG map: ko00250).\n    - 2 of the co-expressed genes could not be functionally characterized.\n    The PanD enzyme is a canonical member of the ko00770 pathway, while the GAD enzyme is a canonical member of the ko00250 pathway. The co-expression score for a candidate is the fraction of *characterized* co-expressed genes that belong to the candidate's primary metabolic pathway.\n\nYour task is to calculate the total evidence scores for both PanD and GAD. Then, to quantify the confidence in the better annotation, calculate the ratio of the total score for the more likely candidate to the total score for the less likely candidate.\n\nCalculate this confidence ratio. Round your final answer to three significant figures.", "solution": "The integrated evidence score is defined as\n$$S=0.4\\,S_{\\text{homology}}+0.3\\,S_{\\text{domain}}+0.3\\,S_{\\text{coexpression}},$$\nwith $S_{\\text{homology}}=\\frac{\\text{bit-score}}{\\text{self-score}}$, $S_{\\text{domain}}=\\frac{|A\\cap B|}{|A\\cup B|}$, and $S_{\\text{coexpression}}$ equal to the fraction of characterized co-expressed genes in the candidate’s primary pathway.\n\nHomology evidence:\n- Self bit-score is $580$.\n- PanD best hit bit-score $450$ gives $S_{\\text{homology}}^{\\text{PanD}}=\\frac{450}{580}=\\frac{45}{58}$.\n- GAD best hit bit-score $310$ gives $S_{\\text{homology}}^{\\text{GAD}}=\\frac{310}{580}=\\frac{31}{58}$.\n\nDomain evidence:\n- TS\\_1337 domains $A=\\{\\text{IPR002047},\\text{IPR001633},\\text{IPR036858}\\}$.\n- PanD canonical $B_{\\text{PanD}}=\\{\\text{IPR002047},\\text{IPR001633},\\text{IPR020846}\\}$ yields $|A\\cap B_{\\text{PanD}}|=2$, $|A\\cup B_{\\text{PanD}}|=4$, so $S_{\\text{domain}}^{\\text{PanD}}=\\frac{2}{4}=\\frac{1}{2}$.\n- GAD canonical $B_{\\text{GAD}}=\\{\\text{IPR002047},\\text{IPR019866}\\}$ yields $|A\\cap B_{\\text{GAD}}|=1$, $|A\\cup B_{\\text{GAD}}|=4$, so $S_{\\text{domain}}^{\\text{GAD}}=\\frac{1}{4}$.\n\nCo-expression evidence:\n- Of 10 co-expressed genes, 2 are uncharacterized, so $8$ are characterized.\n- PanD pathway genes: $6$, hence $S_{\\text{coexpression}}^{\\text{PanD}}=\\frac{6}{8}=\\frac{3}{4}$.\n- GAD pathway genes: $2$, hence $S_{\\text{coexpression}}^{\\text{GAD}}=\\frac{2}{8}=\\frac{1}{4}$.\n\nCompute the total scores using $0.4=\\frac{2}{5}$ and $0.3=\\frac{3}{10}$:\n$$S^{\\text{PanD}}=\\frac{2}{5}\\cdot\\frac{45}{58}+\\frac{3}{10}\\cdot\\frac{1}{2}+\\frac{3}{10}\\cdot\\frac{3}{4}\n=\\frac{9}{29}+\\frac{3}{20}+\\frac{9}{40}\n=\\frac{795}{1160}=\\frac{159}{232},$$\n$$S^{\\text{GAD}}=\\frac{2}{5}\\cdot\\frac{31}{58}+\\frac{3}{10}\\cdot\\frac{1}{4}+\\frac{3}{10}\\cdot\\frac{1}{4}\n=\\frac{31}{145}+\\frac{3}{20}\n=\\frac{211}{580}.$$\n\nSince $S^{\\text{PanD}}>S^{\\text{GAD}}$, PanD is more likely. The confidence ratio is\n$$\\text{Ratio}=\\frac{S^{\\text{PanD}}}{S^{\\text{GAD}}}\n=\\frac{\\frac{159}{232}}{\\frac{211}{580}}\n=\\frac{159\\cdot 580}{232\\cdot 211}\n=\\frac{23055}{12238}\\approx 1.883886.$$\n\nRounded to three significant figures, the ratio is $1.88$.", "answer": "$$\\boxed{1.88}$$", "id": "1419495"}]}