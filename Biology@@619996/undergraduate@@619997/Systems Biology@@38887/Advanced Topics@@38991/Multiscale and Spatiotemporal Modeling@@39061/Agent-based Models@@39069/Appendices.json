{"hands_on_practices": [{"introduction": "Agent-based models (ABMs) come to life through the interactions of simple agents following specific rules. This first exercise invites you to become the simulation engine. By manually tracing the interactions of predators and prey on a grid, you will gain a concrete, step-by-step understanding of how local rules for movement, interaction, and state changes give rise to the system's overall dynamics [@problem_id:1415680]. This practice builds a foundational intuition for how ABMs operate at their most granular level.", "problem": "Consider a simplified Agent-Based Model (ABM) for a predator-prey ecosystem on a 3x3 grid. The grid cells are identified by coordinates (row, column), where rows and columns are indexed from 0 to 2.\n\nThe grid contains three types of entities: predators (X), prey (P), and special 'refuge' cells (R).\n\n**System Rules:**\n1.  **Grid:** A 3x3 grid. The cell (1,1) is a designated 'refuge' cell.\n2.  **Adjacency and Priority:** All interactions and movements consider the 8 adjacent cells (including diagonals). When an agent needs to choose among multiple valid adjacent cells, it does so following a fixed priority order: North, Northeast, East, Southeast, South, Southwest, West, Northwest. For a cell at (r, c), these directions correspond to (r-1, c), (r-1, c+1), (r, c+1), (r+1, c+1), (r+1, c), (r+1, c-1), (r, c-1), and (r-1, c-1), respectively.\n3.  **Time Steps:** The simulation proceeds in discrete time steps, starting from $t=0$. The events within each time step occur in this specific sequence: (i) Predator Phase, (ii) Prey Phase, (iii) End-of-Step Phase.\n\n**Agent Rules:**\n\n**Predators (X):**\n*   **Energy:** Each predator has an energy level, $E$.\n*   **Energy Loss:** At the start of the Predator Phase, each predator loses 4 energy units.\n*   **Movement and Predation:** The predator scans its adjacent cells in the priority order.\n    *   If it finds a cell occupied by a prey that is *not* a refuge cell, it moves to that cell, consumes the prey (the prey is removed from the simulation), and gains 8 energy units. The predator's turn then ends.\n    *   If the only adjacent prey are in refuge cells, it cannot predate them and continues its scan for other options. A predator cannot move onto a cell occupied by a prey if that cell is a refuge.\n    *   If no accessible prey are found in adjacent cells, the predator moves to the first available *empty* adjacent cell according to the priority order.\n*   **Starvation:** If a predator's energy is $E \\le 0$ at the end of a time step, it is removed from the grid.\n*   **Reproduction:** There are no predator reproduction rules in this specific model.\n\n**Prey (P):**\n*   **Age:** Each prey has an age counter, $A$, which starts at 0.\n*   **Reproduction:** During the Prey Phase, if a prey's age is $A \\ge 1$, it reproduces. It creates a new prey (offspring) in the first available *empty* adjacent cell according to the priority order. The parent's age resets to $A=0$, and the new offspring starts with age $A=0$. The parent agent does not move during the time step in which it reproduces.\n*   **Movement:** If a prey does not reproduce in a time step, it moves to the first available *empty* adjacent cell according to the priority order.\n*   **Refuge Immunity:** Prey located in a refuge cell cannot be consumed by predators.\n\n**End-of-Step Phase:**\n*   The age of every prey agent on the grid is incremented by 1.\n\n**Initial State (t=0):**\n*   One predator is located at (1,2) with an initial energy of $E=10$.\n*   One prey is located at (0,1) with an initial age of $A=0$.\n*   A second prey is located at (2,1) with an initial age of $A=0$.\n\nStarting from this initial state, simulate the system. What is the total number of prey agents on the grid at the end of time step $t=2$?", "solution": "We label the refuge at $(1,1)$, the predator at $(1,2)$ with energy $E=10$, and two prey at $(0,1)$ and $(2,1)$, each with age $A=0$ at $t=0$. The 8-neighborhood priority order is North $(r-1,c)$, Northeast $(r-1,c+1)$, East $(r,c+1)$, Southeast $(r+1,c+1)$, South $(r+1,c)$, Southwest $(r+1,c-1)$, West $(r,c-1)$, Northwest $(r-1,c-1)$, ignoring out-of-bounds cells. At each time step, we perform Predator Phase (including the $-4$ energy at its start and predation/movement), then Prey Phase (reproduce if $A\\geq 1$ else move), then End-of-Step Phase (increment every preyâ€™s age by $1$ and check predator starvation at the end of the time step).\n\nTime step $t=0$.\nPredator Phase: Predator at $(1,2)$ loses $4$ energy, so $E=10-4=6$. It scans in order: $(0,2)$ (empty), $(0,3)$ (out), $(1,3)$ (out), $(2,3)$ (out), $(2,2)$ (empty), $(2,1)$ (prey, not refuge), so it moves to $(2,1)$, consumes the prey there, and gains $8$ energy, giving $E=6+8=14$. The prey at $(2,1)$ is removed.\nPrey Phase: The remaining prey at $(0,1)$ has $A=0  1$, so it does not reproduce; it moves to its first empty adjacent cell in priority order. From $(0,1)$, valid candidates are $(0,2)$, $(1,2)$, $(1,1)$, $(1,0)$, $(0,0)$; the first is $(0,2)$, which is empty, so it moves to $(0,2)$.\nEnd-of-Step: Increment ages of all prey by $1$. The prey at $(0,2)$ becomes $A=1$. Predator has $E=14 > 0$, so it remains.\n\nState after $t=0$: Predator at $(2,1)$ with $E=14$; one prey at $(0,2)$ with $A=1$.\n\nTime step $t=1$.\nPredator Phase: Predator at $(2,1)$ loses $4$ energy, so $E=14-4=10$. It scans: $(1,1)$ (refuge, empty), $(1,2)$ (empty), $(2,2)$ (empty), others out or empty; there is no adjacent prey, so it moves to the first empty adjacent cell, which is $(1,1)$. Energy stays $E=10$.\nPrey Phase: The prey at $(0,2)$ has $A=1 \\ge 1$, so it reproduces into the first empty adjacent cell. From $(0,2)$, valid candidates in order are $(1,2)$, $(1,1)$, $(0,1)$. $(1,2)$ is empty, so place offspring at $(1,2)$ with $A=0$; the parent remains at $(0,2)$ and resets to $A=0$.\nEnd-of-Step: Increment ages: parent at $(0,2)$ becomes $A=1$, offspring at $(1,2)$ becomes $A=1$. Predator has $E=10 > 0$.\n\nState after $t=1$: Predator at $(1,1)$ with $E=10$; two prey: $(0,2)$ with $A=1$ and $(1,2)$ with $A=1$.\n\nTime step $t=2$.\nPredator Phase: Predator at $(1,1)$ loses $4$ energy, so $E=10-4=6$. It scans: $(0,1)$ (empty), $(0,2)$ (prey, not refuge), so it moves to $(0,2)$, consumes that prey, and gains $8$ energy to $E=6+8=14$. The prey at $(0,2)$ is removed; the prey at $(1,2)$ remains.\nPrey Phase: The remaining prey at $(1,2)$ has $A=1 \\ge 1$ and reproduces. From $(1,2)$ the valid adjacent cells in order are $(0,2)$, $(2,2)$, $(2,1)$, $(1,1)$, $(0,1)$. $(0,2)$ is occupied by the predator, so skip; $(2,2)$ is empty, so create an offspring at $(2,2)$ with $A=0$, and reset the parent at $(1,2)$ to $A=0$ without moving.\nEnd-of-Step: Increment ages of all prey by $1$: parent at $(1,2)$ becomes $A=1$, offspring at $(2,2)$ becomes $A=1$. Predator has $E=14 > 0$.\n\nAt the end of time step $t=2$, there are exactly $2$ prey agents on the grid.", "answer": "$$\\boxed{2}$$", "id": "1415680"}, {"introduction": "A key feature of many biological systems is inherent randomness, or stochasticity. This exercise moves beyond deterministic rules to explore how we can model and quantify the effects of chance. You will use the principles of probability to analyze a simple model of genetic drift, a fundamental evolutionary process [@problem_id:1415652]. Calculating the probability of a specific outcome in the next generation will demonstrate how ABMs can capture the probabilistic nature of population dynamics.", "problem": "In a synthetic biology laboratory, a simple agent-based model is used to study genetic drift in a controlled population of bacteria. The population size is maintained at a constant number, $N=10$, across generations. The bacteria are genetically engineered to express one of two mutually exclusive alleles for a fluorescent protein: a Green Fluorescent Protein (GFP), which we can label as allele 'G', or a Red Fluorescent Protein (RFP), labeled as allele 'R'. These alleles are selectively neutral, providing no survival or reproductive advantage.\n\nAt the start of the simulation (generation 0), the population consists of exactly $N_G = 3$ bacteria with allele 'G' and $N_R = 7$ bacteria with allele 'R'.\n\nThe population for the next generation (generation 1) is created by performing $N$ independent sampling events from the generation 0 population. Each sampling event consists of randomly selecting a single bacterium from the generation 0 population *with replacement* and creating a perfect copy of it for the new generation.\n\nCalculate the probability that the number of bacteria with allele 'G' in generation 1 is identical to the number of bacteria with allele 'G' in generation 0. Round your final answer to three significant figures.", "solution": "The setup corresponds to sampling with replacement from a finite population where each of the $N$ draws independently yields allele $G$ with probability equal to its initial frequency. Let $N$ be the total number of bacteria per generation and let $N_{G}$ and $N_{R}$ be the counts of alleles $G$ and $R$ in generation $0$, respectively. The probability of selecting a $G$ bacterium in any single draw is\n$$\np=\\frac{N_{G}}{N}, \\quad 1-p=\\frac{N_{R}}{N}.\n$$\nSince the next generation is formed by $N$ independent draws with replacement, the number of $G$ alleles in generation $1$, denoted $X$, follows a binomial distribution with parameters $N$ and $p$. Therefore, for any $k \\in \\{0,1,\\dots,N\\}$,\n$$\n\\Pr(X=k)=\\binom{N}{k}p^{k}(1-p)^{N-k}.\n$$\nWe are asked for the probability that generation $1$ has exactly the same number of $G$ alleles as generation $0$, i.e., $k=N_{G}$. Substituting $N=10$, $N_{G}=3$, and $N_{R}=7$ gives\n$$\n\\Pr(X=3)=\\binom{10}{3}\\left(\\frac{3}{10}\\right)^{3}\\left(\\frac{7}{10}\\right)^{7}.\n$$\nCompute each factor:\n$$\n\\binom{10}{3}=120,\\quad \\left(\\frac{3}{10}\\right)^{3}=\\frac{27}{1000}=0.027,\\quad \\left(\\frac{7}{10}\\right)^{7}=\\frac{7^{7}}{10^{7}}=\\frac{823543}{10000000}=0.0823543.\n$$\nThus\n$$\n\\Pr(X=3)=120 \\times 0.027 \\times 0.0823543=0.266827932.\n$$\nRounding to three significant figures yields\n$$\n0.267.\n$$", "answer": "$$\\boxed{0.267}$$", "id": "1415652"}, {"introduction": "While running simulations step-by-step is insightful, the real power of modeling is in predicting long-term, emergent behavior. This final practice challenges you to think analytically, connecting the microscopic rules governing individual agents to a macroscopic property of the entire population [@problem_id:1415649]. By deriving the steady-state growth factor, $\\lambda$, for an age-structured population, you will learn how mathematical analysis can reveal the ultimate fate of a system without simulating every single agent interaction.", "problem": "Consider an Agent-Based Model (ABM) used to simulate the population dynamics of a synthetic microorganism in a bioreactor. The state of each agent is defined by its internal age counter, $a$, which is a non-negative integer representing the number of time steps since its creation. The simulation proceeds in discrete time steps.\n\nAt the beginning of each time step, every agent of age $a$ is subject to one of three mutually exclusive events:\n1.  **Death**: The agent dies and is removed from the simulation. This occurs with a probability $P_{\\text{death}}(a)$.\n2.  **Division**: The agent is removed and replaced by two new daughter agents, both of age $a=0$. This occurs with a probability $P_{\\text{div}}(a)$.\n3.  **Survival**: The agent survives to the next time step, at which point its age will be $a+1$. this occurs with probability $P_{\\text{surv}}(a) = 1 - P_{\\text{death}}(a) - P_{\\text{div}}(a)$.\n\nFor this particular model, the event probabilities are defined as follows:\n- The death probability is constant for all ages due to a baseline metabolic load: $P_{\\text{death}}(a) = \\delta$.\n- Division is an engineered behavior that is triggered only at a specific maturity age $A$, which is a positive integer. The probability of division at this age is $p_{div}$. For all other ages, the division probability is zero. Formally, $P_{\\text{div}}(a) = p_{div}$ if $a=A$, and $P_{\\text{div}}(a)=0$ if $a \\neq A$.\n\nThe parameters $\\delta$ and $p_{div}$ are positive constants, and their sum is less than one: $\\delta + p_{div}  1$.\n\nAfter the simulation runs for a long time, the population settles into a state of steady exponential growth, where the total number of agents $N(t)$ at time $t$ grows by a constant factor $\\lambda$ at each time step, i.e., $N(t+1) = \\lambda N(t)$. This implies that the population has reached a stable age distribution.\n\nYour task is to determine the long-term population growth factor $\\lambda$. Express your answer as a single closed-form analytic expression in terms of the parameters $A$, $p_{div}$, and $\\delta$.", "solution": "Let $N_a(t)$ be the number of agents of age $a$ at time step $t$. The total population is $N(t) = \\sum_{a=0}^{\\infty} N_a(t)$.\nThe problem states that after a long time, the population reaches a stable age distribution and grows exponentially with a factor $\\lambda$. This means that the number of agents of any specific age $a$ also grows by the same factor in each time step, i.e., $N_a(t+1) = \\lambda N_a(t)$.\nThis allows us to express the number of agents of age $a$ at time $t$ as $N_a(t) = k_a \\lambda^t$, where $k_a$ represents the constant proportion of agents of age $a$ in the stable, growing population.\n\nThe dynamics of the population can be described by a set of difference equations. An agent of age $a$ (for $a \\ge 1$) at time $t+1$ must have been an agent of age $a-1$ at time $t$ that survived without dividing. The number of agents of age $a$ (for $a \\ge 1$) at time $t+1$ is given by:\n$$N_a(t+1) = N_{a-1}(t) \\times P_{\\text{surv}}(a-1)$$\nSubstituting $N_a(t) = k_a \\lambda^t$, we get:\n$$k_a \\lambda^{t+1} = k_{a-1} \\lambda^t \\times P_{\\text{surv}}(a-1)$$\nDividing by $\\lambda^t$, we find a recurrence relation for the coefficients $k_a$:\n$$\\lambda k_a = k_{a-1} P_{\\text{surv}}(a-1) \\implies k_a = \\frac{k_{a-1}}{\\lambda} P_{\\text{surv}}(a-1)$$\nWe can solve this recurrence relation by expressing $k_a$ in terms of $k_0$:\n$$k_a = k_0 \\lambda^{-a} \\prod_{i=0}^{a-1} P_{\\text{surv}}(i)$$\n\nNow we must consider the specific forms of the probabilities.\n$P_{\\text{death}}(a) = \\delta$\n$P_{\\text{div}}(a) = p_{div}$ for $a=A$ and $0$ otherwise.\nTherefore, the survival probability $P_{\\text{surv}}(a) = 1 - P_{\\text{death}}(a) - P_{\\text{div}}(a)$ is:\n- $P_{\\text{surv}}(a) = 1 - \\delta$ for $a \\neq A$.\n- $P_{\\text{surv}}(A) = 1 - \\delta - p_{div}$.\n\nWe need to evaluate the product $\\prod_{i=0}^{A-1} P_{\\text{surv}}(i)$ to find $k_A$. Since $A$ is a positive integer, the index $i$ in this product runs from $0$ to $A-1$. In this range, $i \\neq A$, so $P_{\\text{surv}}(i) = 1 - \\delta$ for all terms in the product.\n$$\\prod_{i=0}^{A-1} P_{\\text{surv}}(i) = \\prod_{i=0}^{A-1} (1 - \\delta) = (1 - \\delta)^A$$\nNow we can write the expression for $k_A$:\n$$k_A = k_0 \\lambda^{-A} (1-\\delta)^A$$\n\nNext, we establish the equation for the creation of new agents (age 0). New agents are created by the division of existing agents. An agent of age $a$ undergoing division produces two new agents of age 0. The number of new agents at time $t+1$ is the sum of offspring from all age groups at time $t$:\n$$N_0(t+1) = \\sum_{a=0}^{\\infty} 2 \\times N_a(t) \\times P_{\\text{div}}(a)$$\nSince $P_{\\text{div}}(a)$ is non-zero only for $a=A$, the sum simplifies to a single term:\n$$N_0(t+1) = 2 \\times N_A(t) \\times P_{\\text{div}}(A) = 2 N_A(t) p_{div}$$\nSubstitute the stable growth form $N_a(t) = k_a \\lambda^t$:\n$$k_0 \\lambda^{t+1} = 2 (k_A \\lambda^t) p_{div}$$\nDividing by $\\lambda^t$ gives the characteristic equation that relates the different age groups at steady growth:\n$$\\lambda k_0 = 2 k_A p_{div}$$\nThis equation is also known as the Euler-Lotka equation for this system. It states that the growth-adjusted number of new agents is determined by the number of reproducing agents and their fertility.\n\nTo solve for $\\lambda$, we substitute the expression for $k_A$ in terms of $k_0$ into this characteristic equation:\n$$\\lambda k_0 = 2 \\left( k_0 \\lambda^{-A} (1-\\delta)^A \\right) p_{div}$$\nSince $k_0$ must be non-zero for a non-extinct population, we can divide both sides by $k_0$:\n$$\\lambda = 2 p_{div} \\lambda^{-A} (1-\\delta)^A$$\nNow, we solve for $\\lambda$. Multiply both sides by $\\lambda^A$:\n$$\\lambda \\cdot \\lambda^A = 2 p_{div} (1-\\delta)^A$$\n$$\\lambda^{A+1} = 2 p_{div} (1-\\delta)^A$$\nFinally, take the $(A+1)$-th root of both sides to get the expression for the long-term growth factor $\\lambda$:\n$$\\lambda = \\left[ 2 p_{div} (1-\\delta)^A \\right]^{\\frac{1}{A+1}}$$", "answer": "$$\\boxed{\\left(2 p_{div} (1-\\delta)^{A}\\right)^{\\frac{1}{A+1}}}$$", "id": "1415649"}]}