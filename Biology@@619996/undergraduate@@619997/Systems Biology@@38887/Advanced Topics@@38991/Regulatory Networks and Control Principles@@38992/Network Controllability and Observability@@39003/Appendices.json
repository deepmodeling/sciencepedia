{"hands_on_practices": [{"introduction": "The ability to steer a biological system to a desired state is a cornerstone of synthetic biology and therapeutics. This first practice problem introduces the fundamental concept of network controllability. We will analyze a simple, linear gene-regulatory cascade to determine if manipulating an upstream element is sufficient to control the entire system, providing a hands-on application of the fundamental Kalman rank condition for controllability [@problem_id:1451352].", "problem": "In synthetic biology, engineers design gene regulatory networks to perform specific tasks. Consider a simple synthetic cascade built in a cell, consisting of two genes, which produce proteins B and C respectively. The concentration of protein B, denoted by $x_B(t)$, is controlled by an external chemical inducer whose concentration we can manipulate over time, represented by the input function $u(t)$. The production rate of protein B is directly proportional to this input. Protein B, in turn, acts as a transcriptional activator for the gene producing protein C, whose concentration is denoted by $x_C(t)$. The production rate of protein C is proportional to the concentration of protein B. Both proteins are subject to natural degradation, with rates proportional to their own concentrations.\n\nThe dynamics of the system can be modeled by the following set of linear ordinary differential equations:\n$$\n\\frac{dx_B}{dt} = k_1 u(t) - \\gamma_B x_B(t)\n$$\n$$\n\\frac{dx_C}{dt} = k_2 x_B(t) - \\gamma_C x_C(t)\n$$\n\nHere, $x_B(t)$ and $x_C(t)$ are the concentrations of proteins B and C. The parameters $k_1$ and $k_2$ are positive constants representing the strength of the input and the activation of C by B, respectively. The parameters $\\gamma_B > 0$ and $\\gamma_C > 0$ are the degradation rate constants for proteins B and C.\n\nThe system is defined as \"fully controllable\" if it is possible to drive the state of the system, represented by the vector of concentrations $(x_B, x_C)$, from any arbitrary initial state $(x_{B,0}, x_{C,0})$ to any arbitrary final state $(x_{B,f}, x_{C,f})$ in a finite amount of time by appropriately choosing the input function $u(t)$.\n\nUnder what condition is this two-protein system fully controllable?\n\nA. The system is always fully controllable, as long as all defined parameters ($k_1, k_2, \\gamma_B, \\gamma_C$) are positive.\n\nB. The system is never fully controllable because the external input $u(t)$ only directly influences the concentration of protein B.\n\nC. The system is fully controllable only if the degradation rates are identical, i.e., $\\gamma_B = \\gamma_C$.\n\nD. The system is fully controllable only if the activation strength $k_2$ is greater than the degradation rate $\\gamma_B$.\n\nE. The system is fully controllable only if the degradation rates are different, i.e., $\\gamma_B \\neq \\gamma_C$.", "solution": "We rewrite the system in standard linear state-space form. Let the state vector be $x(t) = \\begin{pmatrix} x_{B}(t) \\\\ x_{C}(t) \\end{pmatrix}$. Then the given dynamics\n$$\n\\frac{dx_{B}}{dt} = k_{1} u(t) - \\gamma_{B} x_{B}(t), \\qquad \\frac{dx_{C}}{dt} = k_{2} x_{B}(t) - \\gamma_{C} x_{C}(t)\n$$\ncan be written as\n$$\n\\dot{x}(t) = A x(t) + B u(t),\n$$\nwith\n$$\nA = \\begin{pmatrix} -\\gamma_{B} & 0 \\\\ k_{2} & -\\gamma_{C} \\end{pmatrix}, \\qquad B = \\begin{pmatrix} k_{1} \\\\ 0 \\end{pmatrix}.\n$$\nFor a single-input linear time-invariant system, the Kalman controllability condition states that the system is fully controllable if and only if the controllability matrix\n$$\n\\mathcal{C} = \\begin{pmatrix} B & AB \\end{pmatrix}\n$$\nhas full rank equal to the state dimension (here, rank $2$). We compute\n$$\nAB = A B = \\begin{pmatrix} -\\gamma_{B} & 0 \\\\ k_{2} & -\\gamma_{C} \\end{pmatrix} \\begin{pmatrix} k_{1} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -\\gamma_{B} k_{1} \\\\ k_{2} k_{1} \\end{pmatrix}.\n$$\nThus,\n$$\n\\mathcal{C} = \\begin{pmatrix} k_{1} & -\\gamma_{B} k_{1} \\\\ 0 & k_{2} k_{1} \\end{pmatrix}.\n$$\nThe rank of $\\mathcal{C}$ equals $2$ if and only if its determinant is nonzero. The determinant is\n$$\n\\det(\\mathcal{C}) = k_{1} \\cdot (k_{2} k_{1}) - (-\\gamma_{B} k_{1}) \\cdot 0 = k_{1}^{2} k_{2}.\n$$\nTherefore, the system is fully controllable if and only if $k_{1} \\neq 0$ and $k_{2} \\neq 0$. Given the problem assumption that $k_{1} > 0$ and $k_{2} > 0$, the determinant is strictly positive, and the system is fully controllable regardless of the values of $\\gamma_{B}$ and $\\gamma_{C}$. Hence the correct choice is that the system is always fully controllable under the stated positivity of parameters.", "answer": "$$\\boxed{A}$$", "id": "1451352"}, {"introduction": "Controllability is not always an all-or-nothing property; sometimes, we can only influence a specific portion of a network. This exercise explores the idea of the controllable subspace by presenting a system composed of two independent pathways with a single, localized input [@problem_id:1451372]. By calculating the dimension of this subspace, you will gain a more nuanced understanding of how network structure dictates the reach of our control.", "problem": "In systems biology, a common problem is to determine whether the state of a biological system can be fully controlled by external inputs. Consider a simplified model of two independent signaling pathways within a cell. The first pathway involves the concentrations of two proteins, $x_1(t)$ and $x_2(t)$, and the second pathway involves the concentrations of two other proteins, $x_3(t)$ and $x_4(t)$. The entire system's state is described by the vector $\\mathbf{x}(t) = [x_1(t), x_2(t), x_3(t), x_4(t)]^T$.\n\nThe dynamics of these protein concentrations are modeled by the following set of coupled linear ordinary differential equations:\n$$\n\\begin{aligned}\n\\frac{dx_1}{dt} &= -x_1 + x_2 + u(t) \\\\\n\\frac{dx_2}{dt} &= -x_1 - x_2 \\\\\n\\frac{dx_3}{dt} &= -x_3 \\\\\n\\frac{dx_4}{dt} &= x_3 - x_4\n\\end{aligned}\n$$\nHere, $u(t)$ represents an external control signal, such as the introduction of a drug, that directly influences the concentration of protein $x_1$. The system is classified as \"fully controllable\" if it is possible to drive the system from any initial state to any desired final state in finite time by manipulating the control input $u(t)$. The set of all states that can be reached from the origin is known as the controllable subspace.\n\nDetermine the dimension of the controllable subspace for this system. Your answer should be a single integer.", "solution": "We model the system in state-space form $\\dot{\\mathbf{x}} = A \\mathbf{x} + B u$, where $\\mathbf{x} = [x_{1}, x_{2}, x_{3}, x_{4}]^{T}$. From the given differential equations,\n$$\nA = \\begin{bmatrix}\n-1 & 1 & 0 & 0 \\\\\n-1 & -1 & 0 & 0 \\\\\n0 & 0 & -1 & 0 \\\\\n0 & 0 & 1 & -1\n\\end{bmatrix}, \\quad\nB = \\begin{bmatrix}\n1 \\\\ 0 \\\\ 0 \\\\ 0\n\\end{bmatrix}.\n$$\nThe controllable subspace is the span of the columns of the Kalman controllability matrix $\\mathcal{C} = [B, AB, A^{2}B, A^{3}B]$. We compute these columns explicitly.\n\nFirst, compute $AB$:\n$$\nAB = A B = A \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\text{first column of } A = \\begin{bmatrix} -1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{bmatrix}.\n$$\nNext, compute $A^{2}B = A(AB)$:\n$$\nA^{2}B = A \\begin{bmatrix} -1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix}\n-1 \\cdot (-1) + 1 \\cdot (-1) \\\\\n-1 \\cdot (-1) + (-1) \\cdot (-1) \\\\\n0 \\\\\n0\n\\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 2 \\\\ 0 \\\\ 0 \\end{bmatrix}.\n$$\nThen compute $A^{3}B = A(A^{2}B)$:\n$$\nA^{3}B = A \\begin{bmatrix} 0 \\\\ 2 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix}\n-1 \\cdot 0 + 1 \\cdot 2 \\\\\n-1 \\cdot 0 + (-1) \\cdot 2 \\\\\n0 \\\\\n0\n\\end{bmatrix} = \\begin{bmatrix} 2 \\\\ -2 \\\\ 0 \\\\ 0 \\end{bmatrix}.\n$$\nThus,\n$$\n\\mathcal{C} = \\begin{bmatrix}\n1 & -1 & 0 & 2 \\\\\n0 & -1 & 2 & -2 \\\\\n0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0\n\\end{bmatrix}.\n$$\nAll columns of $\\mathcal{C}$ have zeros in the last two entries because $A$ is block diagonal between $\\{x_{1}, x_{2}\\}$ and $\\{x_{3}, x_{4}\\}$ and $B$ acts only on $x_{1}$. Therefore, the rank of $\\mathcal{C}$ is at most $2$. To determine the exact rank, observe that the first and third columns,\n$$\n\\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix} \\quad \\text{and} \\quad \\begin{bmatrix} 0 \\\\ 2 \\\\ 0 \\\\ 0 \\end{bmatrix},\n$$\nare linearly independent. Hence $\\operatorname{rank}(\\mathcal{C}) = 2$. By the definition of the controllable subspace as the span of the columns of $\\mathcal{C}$, its dimension is $2$.", "answer": "$$\\boxed{2}$$", "id": "1451372"}, {"introduction": "Alongside controlling a system, we often need to understand its internal state by measuring its outputsâ€”a concept known as observability. This problem delves into a fascinating subtlety: a system that appears observable based on its wiring diagram can become unobservable due to specific \"parameter cancellations\" among its reaction rates. By analyzing a coherent feed-forward loop, a common biological network motif, you will discover the precise mathematical condition that can render internal states hidden from an external observer [@problem_id:1451365].", "problem": "In systems biology, understanding which components of a cellular network can be inferred from measurements of other components is a fundamental problem of observability. Consider a simplified linear model of a three-protein signaling module, P1, P2, and P3, whose concentration deviations from steady state are represented by the state variables $x_1(t)$, $x_2(t)$, and $x_3(t)$, respectively.\n\nThe proteins interact in a network motif known as a coherent feed-forward loop: P1 influences both P2 and P3, and P2 also influences P3. The dynamics of the system can be described by the following system of linear ordinary differential equations:\n$$\n\\begin{aligned}\n\\dot{x}_1 &= -k_1 x_1 \\\\\n\\dot{x}_2 &= k_{21} x_1 - k_2 x_2 \\\\\n\\dot{x}_3 &= k_{31} x_1 + k_{32} x_2 - k_3 x_3\n\\end{aligned}\n$$\nHere, $k_1, k_2, k_3$ are positive constants representing the first-order degradation or inactivation rates of P1, P2, and P3, respectively. The positive constants $k_{21}, k_{31}, k_{32}$ represent the strengths of the regulatory interactions. This can be written in state-space form as $\\dot{\\mathbf{x}} = A\\mathbf{x}$.\n\nAssume an experimental setup allows for the continuous measurement of the concentration of protein P3, such that the system output is given by $y = x_3$. For a generic choice of non-zero kinetic parameters, the system is structurally observable. However, for certain specific relationships between the parameters, a phenomenon known as parameter cancellation can occur, rendering the system unobservable.\n\nWhich of the following conditions on the kinetic parameters causes the system to become unobservable?\n\nA. $k_{31}(k_1 - k_2) = k_{32}k_{21}$\n\nB. $k_{31}(k_1 + k_2) = k_{32}k_{21}$\n\nC. $k_{21}(k_2 - k_3) = k_{31}k_{32}$\n\nD. $k_1 k_{21} + k_2 k_{32} = k_3 k_{31}$\n\nE. $k_{31} = k_{32} + k_{21}$", "solution": "We write the system in state-space form $\\dot{\\mathbf{x}} = A \\mathbf{x}$ with output $y = C \\mathbf{x}$, where\n$$\nA = \\begin{pmatrix}\n-k_{1} & 0 & 0 \\\\\nk_{21} & -k_{2} & 0 \\\\\nk_{31} & k_{32} & -k_{3}\n\\end{pmatrix}, \\quad\nC = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix}.\n$$\nThe pair $(A,C)$ is observable if and only if the observability matrix has full rank. For a $3$-state SISO system, the observability matrix is\n$$\n\\mathcal{O} = \\begin{pmatrix}\nC \\\\\nC A \\\\\nC A^{2}\n\\end{pmatrix}.\n$$\nWe compute each block explicitly:\n- The first block is $C = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix}$.\n- The second block is $C A$, which equals the third row of $A$:\n$$\nC A = \\begin{pmatrix} k_{31} & k_{32} & -k_{3} \\end{pmatrix}.\n$$\n- The third block is $C A^{2} = (C A) A$. We calculate $A^2$:\n$$ A^2 = \\begin{pmatrix}\n-k_1 & 0 & 0 \\\\\nk_{21} & -k_2 & 0 \\\\\nk_{31} & k_{32} & -k_3\n\\end{pmatrix} \\begin{pmatrix}\n-k_1 & 0 & 0 \\\\\nk_{21} & -k_2 & 0 \\\\\nk_{31} & k_{32} & -k_3\n\\end{pmatrix} = \\begin{pmatrix}\nk_1^2 & 0 & 0 \\\\\n-k_{21}(k_1+k_2) & k_2^2 & 0 \\\\\nk_{32}k_{21}-k_{31}(k_1+k_3) & -k_{32}(k_2+k_3) & k_3^2\n\\end{pmatrix}\n$$\nSo the third row of $A^2$ is\n$$\nC A^{2} = \\begin{pmatrix}\nk_{32} k_{21} - k_{31} (k_{1} + k_{3}) & -k_{32} (k_{2} + k_{3}) & k_{3}^{2}\n\\end{pmatrix}.\n$$\nThus\n$$\n\\mathcal{O} =\n\\begin{pmatrix}\n0 & 0 & 1 \\\\\nk_{31} & k_{32} & -k_{3} \\\\\nk_{32} k_{21} - k_{31} (k_{1} + k_{3}) & -k_{32} (k_{2} + k_{3}) & k_{3}^{2}\n\\end{pmatrix}.\n$$\nThe system is unobservable exactly when $\\det(\\mathcal{O}) = 0$. Expanding the determinant along the first row (whose first two entries are zero) yields\n$$\n\\det(\\mathcal{O}) = \\det\n\\begin{pmatrix}\nk_{31} & k_{32} \\\\\nk_{32} k_{21} - k_{31} (k_{1} + k_{3}) & -k_{32} (k_{2} + k_{3})\n\\end{pmatrix}.\n$$\nCompute this $2 \\times 2$ determinant:\n$$\n\\det(\\mathcal{O}) = k_{31} \\bigl(-k_{32} (k_{2} + k_{3})\\bigr) - k_{32} \\bigl(k_{32} k_{21} - k_{31} (k_{1} + k_{3})\\bigr).\n$$\nSimplifying,\n$$\n\\det(\\mathcal{O}) = -k_{31} k_{32} (k_{2} + k_{3}) - k_{32}^{2} k_{21} + k_{32} k_{31} (k_{1} + k_{3})\n= k_{31} k_{32} (k_{1} - k_{2}) - k_{32}^{2} k_{21}.\n$$\nFactor out $k_{32}$:\n$$\n\\det(\\mathcal{O}) = k_{32} \\bigl( k_{31} (k_{1} - k_{2}) - k_{32} k_{21} \\bigr).\n$$\nFor generic non-zero kinetic parameters, $k_{32} \\neq 0$, so unobservability arises precisely when the bracketed factor vanishes:\n$$\nk_{31} (k_{1} - k_{2}) - k_{32} k_{21} = 0 \\quad \\Longleftrightarrow \\quad k_{31} (k_{1} - k_{2}) = k_{32} k_{21}.\n$$\nThis matches option A. The calculation in the original solution for $CA^2$ was correct, but I've added a more explicit derivation to be safe, which I will not include in the final output to maintain minimality. The original solution is correct. None of the other listed relations cause the determinant to vanish generically.", "answer": "$$\\boxed{A}$$", "id": "1451365"}]}