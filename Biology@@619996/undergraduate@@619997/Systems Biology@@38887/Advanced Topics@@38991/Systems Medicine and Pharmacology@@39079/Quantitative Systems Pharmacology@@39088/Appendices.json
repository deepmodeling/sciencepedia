{"hands_on_practices": [{"introduction": "The interaction between a drug and its target is the cornerstone of pharmacology. While simple models often assume the drug concentration is unaffected by binding, this is not always true, especially when receptor concentrations are high or binding affinity is strong. This exercise [@problem_id:2813040] challenges you to derive and apply a more rigorous binding model from first principles, accounting for ligand depletion to accurately calculate receptor occupancy.", "problem": "A steroid hormone binds to its cognate nuclear receptor (NR) in the nucleus according to a single-site reversible binding equilibrium. Let the total nuclear receptor concentration be $R_{T} = 10\\ \\text{nM}$ and the dissociation constant (defined as $K_{d} = \\frac{[R][L]}{[RL]}$) be $K_{d} = 5\\ \\text{nM}$. A ligand is added to the nucleus to a known total concentration $L_{T}$, and ligand depletion by binding to the receptor cannot be a priori neglected. Starting from the law of mass action, the definition of $K_{d}$, and conservation of mass for both receptor and ligand, do the following:\n\n1. Derive an analytical expression for the receptor occupancy fraction $f(L_{T})$, defined as $f(L_{T}) = \\frac{[RL]}{R_{T}}$, as a function of $R_{T}$, $K_{d}$, and $L_{T}$, without assuming that free ligand equals total ligand.\n\n2. Using your expression, calculate the receptor occupancy for $L_{T} = 1\\ \\text{nM}$, $L_{T} = 5\\ \\text{nM}$, and $L_{T} = 50\\ \\text{nM}$.\n\n3. Assume that the transcriptional output $T(L_{T})$ is proportional to occupancy with negligible basal activity, that is, $T(L_{T}) = \\alpha\\, f(L_{T})$ for some proportionality constant $\\alpha$ (arbitrary units), so that the maximal transcriptional output is $T_{\\max} = \\alpha$. Using your derived $f(L_{T})$, write $T(L_{T})$ up to the constant $\\alpha$ and infer the qualitative shape of the transcriptional response as a function of $L_{T}$.\n\n4. Under this model, determine the total ligand concentration $L_{T}^{(0.8)}$ that yields $T(L_{T}^{(0.8)}) = 0.8\\, T_{\\max}$. Express your final answer for $L_{T}^{(0.8)}$ in $\\text{nM}$ and round your answer to three significant figures.", "solution": "The problem statement is scientifically grounded, well-posed, and complete. It describes a standard reversible binding equilibrium with ligand depletion, a common and important case in quantitative pharmacology and systems biology. We will proceed with the derivation and calculation as requested.\n\nThe binding of a ligand $L$ to a receptor $R$ is described by the reversible reaction:\n$$ R + L \\rightleftharpoons RL $$\nThe system is governed by three fundamental relationships at equilibrium.\n\nThe dissociation constant, $K_{d}$, is defined as:\n$$ K_{d} = \\frac{[R][L]}{[RL]} $$\nwhere $[R]$, $[L]$, and $[RL]$ are the equilibrium concentrations of the free receptor, free ligand, and receptor-ligand complex, respectively.\n\nThe conservation of mass for the receptor is:\n$$ R_{T} = [R] + [RL] $$\nwhere $R_{T}$ is the total receptor concentration.\n\nThe conservation of mass for the ligand is:\n$$ L_{T} = [L] + [RL] $$\nwhere $L_{T}$ is the total ligand concentration. The problem specifies that $[L]$ is not necessarily equal to $L_{T}$, which is the correct approach when ligand depletion by binding is significant.\n\nPart $1$: Derivation of the receptor occupancy fraction $f(L_{T})$.\n\nOur goal is to find an expression for the receptor occupancy fraction, $f(L_{T}) = \\frac{[RL]}{R_{T}}$, in terms of the known quantities $R_{T}$, $L_{T}$, and $K_{d}$. To do this, we must first find an expression for $[RL]$.\n\nFrom the mass conservation equations, we express the free concentrations in terms of the complex concentration $[RL]$:\n$$ [R] = R_{T} - [RL] $$\n$$ [L] = L_{T} - [RL] $$\nSubstituting these expressions into the definition of $K_{d}$:\n$$ K_{d} = \\frac{(R_{T} - [RL])(L_{T} - [RL])}{[RL]} $$\nWe must now solve this equation for $[RL]$. Rearranging the equation gives:\n$$ K_{d}[RL] = (R_{T} - [RL])(L_{T} - [RL]) $$\n$$ K_{d}[RL] = R_{T}L_{T} - R_{T}[RL] - L_{T}[RL] + [RL]^2 $$\nGrouping all terms on one side yields a quadratic equation for $[RL]$:\n$$ [RL]^2 - (R_{T} + L_{T} + K_{d})[RL] + R_{T}L_{T} = 0 $$\nThis is a standard quadratic equation of the form $ax^2 + bx + c = 0$, with $x = [RL]$, $a = 1$, $b = -(R_{T} + L_{T} + K_{d})$, and $c = R_{T}L_{T}$. The solution is given by the quadratic formula:\n$$ [RL] = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} $$\n$$ [RL] = \\frac{(R_{T} + L_{T} + K_{d}) \\pm \\sqrt{(R_{T} + L_{T} + K_{d})^2 - 4R_{T}L_{T}}}{2} $$\nWe must select the physically meaningful root. The concentration of the complex $[RL]$ cannot exceed the total concentration of either the receptor ($R_{T}$) or the ligand ($L_{T}$). The positive root would yield a value for $[RL]$ that is greater than $R_{T} + L_{T}$, which is a physical impossibility. Therefore, we must choose the negative root.\n$$ [RL] = \\frac{(R_{T} + L_{T} + K_{d}) - \\sqrt{(R_{T} + L_{T} + K_{d})^2 - 4R_{T}L_{T}}}{2} $$\nThe receptor occupancy fraction, $f(L_{T})$, is obtained by dividing $[RL]$ by $R_{T}$:\n$$ f(L_{T}) = \\frac{[RL]}{R_{T}} = \\frac{(R_{T} + L_{T} + K_{d}) - \\sqrt{(R_{T} + L_{T} + K_{d})^2 - 4R_{T}L_{T}}}{2R_{T}} $$\nThis is the required analytical expression.\n\nPart $2$: Calculation of receptor occupancy.\n\nWe are given $R_{T} = 10\\ \\text{nM}$ and $K_{d} = 5\\ \\text{nM}$. We use the derived expression for $f(L_{T})$ to calculate the occupancy for three different total ligand concentrations.\n\nFor $L_{T} = 1\\ \\text{nM}$:\n$$ f(1) = \\frac{(10 + 1 + 5) - \\sqrt{(10 + 1 + 5)^2 - 4(10)(1)}}{2(10)} $$\n$$ f(1) = \\frac{16 - \\sqrt{16^2 - 40}}{20} = \\frac{16 - \\sqrt{256 - 40}}{20} = \\frac{16 - \\sqrt{216}}{20} $$\n$$ f(1) = \\frac{16 - 6\\sqrt{6}}{20} = \\frac{8 - 3\\sqrt{6}}{10} \\approx 0.0652 $$\n\nFor $L_{T} = 5\\ \\text{nM}$:\n$$ f(5) = \\frac{(10 + 5 + 5) - \\sqrt{(10 + 5 + 5)^2 - 4(10)(5)}}{2(10)} $$\n$$ f(5) = \\frac{20 - \\sqrt{20^2 - 200}}{20} = \\frac{20 - \\sqrt{400 - 200}}{20} = \\frac{20 - \\sqrt{200}}{20} $$\n$$ f(5) = \\frac{20 - 10\\sqrt{2}}{20} = 1 - \\frac{\\sqrt{2}}{2} \\approx 0.293 $$\n\nFor $L_{T} = 50\\ \\text{nM}$:\n$$ f(50) = \\frac{(10 + 50 + 5) - \\sqrt{(10 + 50 + 5)^2 - 4(10)(50)}}{2(10)} $$\n$$ f(50) = \\frac{65 - \\sqrt{65^2 - 2000}}{20} = \\frac{65 - \\sqrt{4225 - 2000}}{20} = \\frac{65 - \\sqrt{2225}}{20} $$\n$$ f(50) = \\frac{65 - 5\\sqrt{89}}{20} = \\frac{13 - \\sqrt{89}}{4} \\approx 0.892 $$\n\nPart $3$: Qualitative shape of the transcriptional response.\n\nThe transcriptional output $T(L_{T})$ is given as proportional to the occupancy fraction $f(L_{T})$, with $T(L_{T}) = \\alpha\\, f(L_{T})$. The maximal output is $T_{\\max} = \\alpha$. The shape of the transcriptional response curve as a function of $L_{T}$ is therefore identical to the shape of the occupancy curve $f(L_{T})$, scaled vertically by the constant $\\alpha$.\nBased on the expression for $f(L_{T})$:\n- When $L_{T} = 0$, then $[RL] = 0$, so $f(0) = 0$. The response starts at zero.\n- As $L_{T}$ increases, $[RL]$ increases. A simple analysis of the derivative $\\frac{df}{dL_{T}}$ shows it is always positive, so the function is monotonically increasing.\n- As $L_{T} \\to \\infty$, the receptor becomes saturated. In this limit, $[RL] \\to R_{T}$, which means $f(L_{T}) \\to 1$.\nTherefore, the transcriptional response $T(L_{T})$ starts at $0$, increases monotonically with $L_{T}$, and asymptotically approaches a maximum value, $T_{\\max} = \\alpha$. The shape is a saturating, hyperbolic-like curve, characteristic of a dose-response relationship governed by the law of mass action.\n\nPart $4$: Calculation of $L_{T}^{(0.8)}$.\n\nWe need to find the total ligand concentration, $L_{T}^{(0.8)}$, that results in a transcriptional output equal to $80\\%$ of the maximum.\n$$ T(L_{T}^{(0.8)}) = 0.8\\, T_{\\max} $$\nSubstituting the definitions for $T(L_{T})$ and $T_{\\max}$:\n$$ \\alpha\\, f(L_{T}^{(0.8)}) = 0.8\\, \\alpha $$\nThis simplifies to finding the ligand concentration for which the receptor occupancy is $0.8$:\n$$ f(L_{T}^{(0.8)}) = 0.8 $$\nBy definition, $f(L_{T}) = \\frac{[RL]}{R_{T}}$. So we have:\n$$ \\frac{[RL]}{R_{T}} = 0.8 \\implies [RL] = 0.8\\, R_{T} $$\nUsing the given value $R_{T} = 10\\ \\text{nM}$:\n$$ [RL] = 0.8 \\times 10\\ \\text{nM} = 8\\ \\text{nM} $$\nNow we must find the total ligand concentration $L_{T}$ that produces this equilibrium concentration of the complex. We can work backward using the fundamental equations.\nFirst, find the free receptor concentration $[R]$:\n$$ [R] = R_{T} - [RL] = 10\\ \\text{nM} - 8\\ \\text{nM} = 2\\ \\text{nM} $$\nNext, use the definition of $K_{d}$ to find the free ligand concentration $[L]$:\n$$ K_{d} = \\frac{[R][L]}{[RL]} \\implies [L] = \\frac{K_{d}[RL]}{[R]} $$\nUsing $K_{d} = 5\\ \\text{nM}$:\n$$ [L] = \\frac{(5\\ \\text{nM})(8\\ \\text{nM})}{2\\ \\text{nM}} = 20\\ \\text{nM} $$\nFinally, use the mass balance equation for the ligand to find the total ligand concentration $L_{T}$:\n$$ L_{T} = [L] + [RL] $$\n$$ L_{T}^{(0.8)} = 20\\ \\text{nM} + 8\\ \\text{nM} = 28\\ \\text{nM} $$\nThe problem requires the answer to be rounded to three significant figures, which is $28.0\\ \\text{nM}$.", "answer": "$$\n\\boxed{28.0}\n$$", "id": "2813040"}, {"introduction": "Understanding target occupancy is only the first step; we must then connect it to a biological response. The Hill equation is a powerful tool for modeling the often-cooperative and saturable nature of physiological dose-response relationships. In this practice [@problem_id:2859953], you will use the Hill function to quantify how changes in the concentration of a metabolite affect a key cellular process, providing insight into the dynamics of biological signaling.", "problem": "In the context of mucosal immune regulation in Inflammatory Bowel Disease (IBD), consider the short-chain fatty acid (SCFA) butyrate, a microbial metabolite known to enhance the differentiation of forkhead box P3 (Foxp3) regulatory T cells (Tregs) through histone deacetylase (HDAC) inhibition. Assume that the steady-state rate of Foxp3 induction in naive CD4 T cells depends on the butyrate concentration via a cooperative, saturable response characterized by a half-maximal effective concentration ($EC_{50}$) and Hill coefficient ($n$), with a constant maximal induction capacity under the conditions considered.\n\nSuppose a dietary fiber intervention increases the colonic butyrate concentration from $0.2\\ \\mathrm{mM}$ to $1.0\\ \\mathrm{mM}$. The pharmacodynamic sensitivity parameters of the Treg induction response to butyrate are $EC_{50}=0.5\\ \\mathrm{mM}$ and Hill coefficient $n=2$. Assuming that non-butyrate effects remain unchanged and that the maximal Treg induction capacity is constant, compute the fold-change in the normalized Foxp3 induction effect when butyrate rises from $0.2\\ \\mathrm{mM}$ to $1.0\\ \\mathrm{mM}$.\n\nExpress your final answer as a single dimensionless number. Provide the result as an exact fraction in simplest terms with no units.", "solution": "We begin from the standard pharmacodynamic representation of a cooperative, saturable response to a ligand, modeled by a Hill-type function. For a ligand concentration $[B]$ (here, butyrate), the normalized effect on an output $E([B])$ that saturates at a maximal capacity $E_{\\max}$ is given by\n$$\nE([B]) \\;=\\; E_{\\max}\\,\\frac{[B]^{n}}{EC_{50}^{n} + [B]^{n}},\n$$\nwhere $EC_{50}$ is the half-maximal effective concentration and $n$ is the Hill coefficient capturing cooperativity. This representation follows from equilibrium occupancy principles generalized for cooperative binding and downstream signaling amplification, which are well established for pharmacodynamic dose-response behaviors.\n\nWe are asked to compute the fold-change in the normalized induction effect when the butyrate concentration increases from $[B]_{1} = 0.2\\ \\mathrm{mM}$ to $[B]_{2} = 1.0\\ \\mathrm{mM}$, given $EC_{50} = 0.5\\ \\mathrm{mM}$ and $n=2$. The fold-change $F$ is defined as\n$$\nF \\;=\\; \\frac{E([B]_{2})}{E([B]_{1})}.\n$$\nUsing the Hill form above, we substitute and note that $E_{\\max}$ cancels:\n$$\nF \\;=\\; \\frac{E_{\\max}\\,\\frac{[B]_{2}^{n}}{EC_{50}^{n} + [B]_{2}^{n}}}{E_{\\max}\\,\\frac{[B]_{1}^{n}}{EC_{50}^{n} + [B]_{1}^{n}}}\n\\;=\\; \\frac{\\frac{[B]_{2}^{n}}{EC_{50}^{n} + [B]_{2}^{n}}}{\\frac{[B]_{1}^{n}}{EC_{50}^{n} + [B]_{1}^{n}}}\n\\;=\\; \\frac{[B]_{2}^{n}}{EC_{50}^{n} + [B]_{2}^{n}} \\cdot \\frac{EC_{50}^{n} + [B]_{1}^{n}}{[B]_{1}^{n}}.\n$$\nNow substitute $n=2$, $[B]_{2} = 1.0\\ \\mathrm{mM}$, $[B]_{1} = 0.2\\ \\mathrm{mM}$, and $EC_{50} = 0.5\\ \\mathrm{mM}$:\n$$\n[B]_{2}^{2} = (1.0)^{2} = 1,\\quad [B]_{1}^{2} = (0.2)^{2} = 0.04,\\quad EC_{50}^{2} = (0.5)^{2} = 0.25.\n$$\nTherefore,\n$$\nF \\;=\\; \\frac{1}{0.25 + 1} \\cdot \\frac{0.25 + 0.04}{0.04}\n\\;=\\; \\frac{1}{1.25} \\cdot \\frac{0.29}{0.04}.\n$$\nConvert the decimal quantities to exact rational numbers:\n$$\n1.25 \\;=\\; \\frac{5}{4},\\quad 0.29 \\;=\\; \\frac{29}{100},\\quad 0.04 \\;=\\; \\frac{4}{100}.\n$$\nHence,\n$$\nF \\;=\\; \\frac{1}{\\frac{5}{4}} \\cdot \\frac{\\frac{29}{100}}{\\frac{4}{100}}\n\\;=\\; \\frac{4}{5} \\cdot \\frac{29}{4}\n\\;=\\; \\frac{29}{5}.\n$$\nThus, the fold-change in the normalized Foxp3 induction effect is the exact fraction $29/5$.", "answer": "$$\\boxed{\\frac{29}{5}}$$", "id": "2859953"}, {"introduction": "Quantitative models are only as good as the parameters that define them, which must be estimated from experimental data. This hands-on practice [@problem_id:2961642] guides you through the essential process of fitting a dose-response model to measurements using nonlinear regression. By determining key parameters like the half-maximal effective concentration ($EC_{50}$) and their confidence intervals, you will learn how to translate raw data into actionable pharmacological insights.", "problem": "You are studying the Epidermal Growth Factor (EGF)-activated Ras-Mitogen-Activated Protein Kinase (Ras-MAPK) signaling cascade by measuring the steady-state fraction of phosphorylated extracellular signal-regulated kinase (ERK) as a function of extracellular ligand concentration. Assume the following foundational base that is routinely used for receptor-mediated signaling with cooperative activation: (i) receptor-ligand binding follows the law of mass action, (ii) the signaling output at steady state is a monotonic function of the fraction of occupied or activated receptor and its downstream cooperative steps, and (iii) measurement noise across doses is independent, identically distributed, Gaussian with constant variance. Under these assumptions, a cooperative activation model consistent with the fraction of activated Ras and the ensuing ERK phosphorylation maps ligand concentration $c$ to a response $y(c)$ using a saturable, monotonic, and cooperative function with four parameters: a basal response $B$ (unitless fraction), a maximal response $T$ (unitless fraction), a half-maximal effective concentration $EC_{50}$ (in nM), and a Hill coefficient $n$ (unitless, $n>0$). The parameter $EC_{50}$ is defined as the concentration $c$ at which the response is halfway between $B$ and $T$. Nonlinear regression under Gaussian noise implies that the maximum likelihood estimates of the parameters minimize the sum of squared residuals.\n\nTask: For each dataset below, fit a cooperative activation model consistent with points (i)–(iii) and with parameters $(B,T,EC_{50},n)$ to the provided dose-response data by nonlinear least squares. Then, using the asymptotic normal approximation of the parameter estimates, compute a two-sided $0.95$ confidence interval for $EC_{50}$ from the estimated parameter covariance (use a Student $t$ distribution quantile with degrees of freedom equal to the number of data points minus the number of parameters). The final results must be reported in nanomolar (nM).\n\nDatasets (each response is the steady-state fraction of phosphorylated ERK, unitless):\n\n- Dataset A (EGF in a canonical epithelial line; “happy path” with broad coverage)\n  - Concentrations in nM: $0$, $0.1$, $0.3$, $1$, $3$, $10$, $30$.\n  - Responses (unitless): $0.050$, $0.077$, $0.130$, $0.328$, $0.605$, $0.843$, $0.911$.\n\n- Dataset B (Nerve Growth Factor-like cooperative regime in a Ras-dependent context)\n  - Concentrations in nM: $0$, $0.01$, $0.03$, $0.1$, $0.3$, $1$, $3$, $10$.\n  - Responses (unitless): $0.020$, $0.0208$, $0.0272$, $0.096$, $0.380$, $0.694$, $0.739$, $0.743$.\n\n- Dataset C (mutant with shallow dose sensitivity; incomplete saturation within tested range)\n  - Concentrations in nM: $0$, $1$, $3$, $10$, $30$, $100$.\n  - Responses (unitless): $0.100$, $0.157$, $0.203$, $0.295$, $0.382$, $0.484$.\n\n- Dataset D (near-zero basal response; broader dynamic range and higher $EC_{50}$)\n  - Concentrations in nM: $0$, $5$, $10$, $30$, $50$, $100$, $300$.\n  - Responses (unitless): $0.000$, $0.033$, $0.086$, $0.314$, $0.503$, $0.743$, $0.930$.\n\nRequirements and constraints for fitting:\n- Use a four-parameter cooperative activation model with parameters $(B,T,EC_{50},n)$ such that $0 \\le B \\le T \\le 1$, $EC_{50} > 0$ in nM, and $n \\in (0,5]$.\n- Use nonlinear least squares to estimate all four parameters simultaneously.\n- Use the Jacobian-based asymptotic covariance of the parameter estimates to compute the standard error of $EC_{50}$, and form a two-sided $0.95$ confidence interval using a Student $t$ quantile with degrees of freedom $N-4$, where $N$ is the number of data points in the dataset.\n- Express $EC_{50}$ and its confidence interval bounds in nM as floating-point numbers.\n- Round all reported numeric outputs to $4$ significant figures.\n\nTest suite and expected output:\n- The program must process all four datasets A–D as a fixed test suite.\n- For each dataset, compute and return a triple containing the estimated $EC_{50}$ (in nM) and the lower and upper bounds of its two-sided $0.95$ confidence interval (in nM), each rounded to $4$ significant figures.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each dataset’s triple enclosed in its own bracket and ordered as $[A,B,C,D]$. For example, the format must be exactly like $[[a\\_1,a\\_2,a\\_3],[b\\_1,b\\_2,b\\_3],[c\\_1,c\\_2,c\\_3],[d\\_1,d\\_2,d\\_3]]$, where each $a\\_i$, $b\\_i$, $c\\_i$, $d\\_i$ is a floating-point number in nM rounded to $4$ significant figures. No additional text may be printed.", "solution": "We connect the biological mechanism of the Ras-Mitogen-Activated Protein Kinase (Ras-MAPK) cascade to a cooperative dose-response model using first principles. The receptor-ligand interaction is governed by the law of mass action: the fraction of occupied receptors increases monotonically with ligand concentration $c$. Downstream recruitment and activation steps in Ras-MAPK can manifest cooperativity, effectively yielding a response that depends on $c$ through a sigmoidal transformation with an exponent $n$. At steady state, a minimal and widely used mapping consistent with these principles is a saturable, monotonic function with parameters for basal activity $B$, maximal activity $T$, a half-maximal concentration $EC_{50}$, and a Hill coefficient $n$ controlling apparent cooperativity. The half-maximal effective concentration $EC_{50}$ is defined by the condition that the response is halfway between $B$ and $T$.\n\nFrom the statistical perspective, assume independent, identically distributed Gaussian noise with constant variance across concentrations; then the maximum likelihood estimates of parameters minimize the sum of squared residuals. Therefore, nonlinear least squares is an appropriate estimator. Let the model be denoted as\n$$\ny(c; \\theta) \\equiv B + (T - B)\\,\\frac{c^{n}}{EC_{50}^{n} + c^{n}},\n$$\nwith parameter vector $\\theta = (B, T, EC_{50}, n)$. The constraints $0 \\le B \\le T \\le 1$, $EC_{50} > 0$, and $n \\in (0,5]$ enforce biological realism (responses are fractions, concentrations are positive, and cooperativity is finite and positive).\n\nGiven data $\\{(c_i, y_i)\\}_{i=1}^{N}$, the nonlinear least-squares estimator solves\n$$\n\\hat{\\theta} = \\arg\\min_{\\theta} \\sum_{i=1}^{N} \\left[y_i - y(c_i;\\theta)\\right]^2.\n$$\nUnder standard regularity conditions, $\\hat{\\theta}$ is asymptotically normal with covariance approximated by the inverse of the observed Fisher information. The Gauss–Newton approximation yields\n$$\n\\widehat{\\mathrm{Cov}}(\\hat{\\theta}) \\approx s^2 \\left(J^\\top J\\right)^{-1},\n$$\nwhere $J$ is the Jacobian matrix with entries\n$$\nJ_{i,k} = \\frac{\\partial y(c_i;\\theta)}{\\partial \\theta_k}\\Bigg|_{\\theta=\\hat{\\theta}},\n$$\nand $s^2$ is the residual variance estimator\n$$\ns^2 = \\frac{1}{N - p} \\sum_{i=1}^{N} \\left[y_i - y(c_i;\\hat{\\theta})\\right]^2,\n$$\nwith $p=4$ the number of parameters. Many software implementations of nonlinear least squares, including trust-region reflective algorithms, compute an estimate of $\\left(J^\\top J\\right)^{-1}$ and scale it by $s^2$ to produce an estimate of the parameter covariance matrix.\n\nTo compute a two-sided $0.95$ confidence interval for $EC_{50}$, extract the variance estimate of the $EC_{50}$ component, $\\widehat{\\mathrm{Var}}(\\widehat{EC_{50}})$, as the corresponding diagonal entry of the covariance matrix. The standard error is\n$$\n\\mathrm{SE}(\\widehat{EC_{50}}) = \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{EC_{50}})}.\n$$\nWith degrees of freedom $\\nu = N - p$, the two-sided confidence interval at level $0.95$ is\n$$\n\\widehat{EC_{50}} \\pm t_{1 - \\alpha/2,\\,\\nu}\\ \\mathrm{SE}(\\widehat{EC_{50}}),\n$$\nwhere $\\alpha = 1 - 0.95 = 0.05$, and $t_{1 - \\alpha/2,\\,\\nu}$ is the $(1 - \\alpha/2)$ quantile of the Student $t$ distribution with $\\nu$ degrees of freedom.\n\nAlgorithmic plan for each dataset:\n1. Assemble the vectors of concentrations $c_i$ (in nM) and responses $y_i$ (unitless).\n2. Fit the four-parameter model $y(c;\\theta)$ by nonlinear least squares with bound constraints $0 \\le B \\le 1$, $0 \\le T \\le 1$, $EC_{50} \\in (0, \\infty)$, and $n \\in (0,5]$. An effective initialization is $B$ at the minimum observed response, $T$ at the maximum observed response, $EC_{50}$ at the median of the positive concentrations, and $n$ at $1$.\n3. Obtain the Jacobian-based parameter covariance matrix and compute the standard error of $\\widehat{EC_{50}}$.\n4. With $\\nu = N - 4$, compute $t_{1 - 0.025,\\,\\nu}$ and form the two-sided $0.95$ confidence interval for $EC_{50}$.\n5. Express the point estimate and interval bounds in nM and round each to $4$ significant figures.\n6. Output a single line with four triples in order $[A,B,C,D]$ using the format $[[a_1,a_2,a_3],[b_1,b_2,b_3],[c_1,c_2,c_3],[d_1,d_2,d_3]]$ where, for each dataset, the triple is $[\\widehat{EC_{50}}, \\mathrm{CI}_{\\mathrm{low}}, \\mathrm{CI}_{\\mathrm{high}}]$.\n\nThe provided datasets cover complementary regimes important for Ras-MAPK signaling inference: a typical sigmoidal response with good dynamic range, a highly cooperative regime with sub-nanomolar sensitivity, a shallow slope with incomplete saturation that challenges identifiability, and a near-zero basal regime spanning over two orders of magnitude in concentration. The nonlinear regression with bounds and asymptotic covariance computation together produce scientifically meaningful $EC_{50}$ estimates with confidence intervals, all in nanomolar units, suitable for comparing signaling sensitivities across conditions.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\nfrom scipy.stats import t as student_t\n\ndef hill_response(c, B, T, EC50, n):\n    # Cooperative activation model, c in nM, responses unitless\n    # Ensure safe power for zero concentration: c**n is 0 when c=0 and n>0\n    return B + (T - B) * (np.power(c, n)) / (np.power(EC50, n) + np.power(c, n))\n\ndef fit_hill_and_ci(c, y):\n    c = np.asarray(c, dtype=float)\n    y = np.asarray(y, dtype=float)\n\n    # Initial guesses\n    B0 = float(np.clip(np.min(y), 0.0, 1.0))\n    T0 = float(np.clip(np.max(y), 0.0, 1.0))\n    # Avoid EC50 initialization at 0 due to zero concentrations; use median of positive concentrations\n    positive_c = c[c > 0]\n    EC500 = float(np.median(positive_c)) if positive_c.size > 0 else 1.0\n    n0 = 1.0\n\n    p0 = [B0, T0, EC500, n0]\n\n    # Bounds: 0 <= B <= 1, 0 <= T <= 1, EC50 in (1e-12, 1e9], n in (1e-6, 5]\n    # Also enforce B <= T by using independent bounds and relying on optimizer; data typically ensure B<=T.\n    lower_bounds = [0.0, 0.0, 1e-12, 1e-6]\n    upper_bounds = [1.0, 1.0, 1e9, 5.0]\n\n    # Fit\n    popt, pcov = curve_fit(\n        hill_response, c, y,\n        p0=p0, bounds=(lower_bounds, upper_bounds),\n        method='trf', max_nfev=10000\n    )\n\n    # Degrees of freedom\n    N = y.size\n    p = 4\n    dof = max(N - p, 1)\n\n    # curve_fit with absolute_sigma=False scales pcov by reduced chi^2 internally,\n    # but we will keep it as provided (already scaled) for standard errors.\n    # Extract standard error for EC50\n    se = np.sqrt(np.diag(pcov))\n    se_ec50 = float(se[2])\n\n    ec50_hat = float(popt[2])\n\n    # Two-sided 95% CI using Student t\n    alpha = 0.05\n    tcrit = float(student_t.ppf(1 - alpha/2.0, dof))\n    ci_low = ec50_hat - tcrit * se_ec50\n    ci_high = ec50_hat + tcrit * se_ec50\n\n    # Enforce positivity for CI bounds (biologically EC50 > 0)\n    ci_low = max(ci_low, 0.0)\n\n    return ec50_hat, ci_low, ci_high\n\ndef round_sig(x, sig=4):\n    if x == 0 or not np.isfinite(x):\n        return \"0\"\n    # Use general format with specified significant digits\n    return f\"{x:.{sig}g}\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Dataset A\n    c_A = np.array([0.0, 0.1, 0.3, 1.0, 3.0, 10.0, 30.0], dtype=float)\n    y_A = np.array([0.050, 0.077, 0.130, 0.328, 0.605, 0.843, 0.911], dtype=float)\n\n    # Dataset B\n    c_B = np.array([0.0, 0.01, 0.03, 0.1, 0.3, 1.0, 3.0, 10.0], dtype=float)\n    y_B = np.array([0.020, 0.0208, 0.0272, 0.096, 0.380, 0.694, 0.739, 0.743], dtype=float)\n\n    # Dataset C\n    c_C = np.array([0.0, 1.0, 3.0, 10.0, 30.0, 100.0], dtype=float)\n    y_C = np.array([0.100, 0.157, 0.203, 0.295, 0.382, 0.484], dtype=float)\n\n    # Dataset D\n    c_D = np.array([0.0, 5.0, 10.0, 30.0, 50.0, 100.0, 300.0], dtype=float)\n    y_D = np.array([0.000, 0.033, 0.086, 0.314, 0.503, 0.743, 0.930], dtype=float)\n\n    test_cases = [\n        (c_A, y_A),\n        (c_B, y_B),\n        (c_C, y_C),\n        (c_D, y_D),\n    ]\n\n    results = []\n    for c, y in test_cases:\n        ec50_hat, ci_low, ci_high = fit_hill_and_ci(c, y)\n        # Round to 4 significant figures as strings\n        results.append([round_sig(ec50_hat, 4), round_sig(ci_low, 4), round_sig(ci_high, 4)])\n\n    # Final print statement in the exact required format.\n    # Ensure single-line, nested list with comma-separated values.\n    formatted = \"[\" + \",\".join(\"[\" + \",\".join(map(str, triple)) + \"]\" for triple in results) + \"]\"\n    print(formatted)\n\nsolve()\n```", "id": "2961642"}]}