{"hands_on_practices": [{"introduction": "To begin our exploration of Topological Data Analysis, we must first understand how topological structures are built from raw data. This first practice focuses on the fundamental process of constructing a Vietoris-Rips filtration, which systematically builds a shape from a point cloud by connecting points that are close to each other. By working through a concrete example of a peptide structure [@problem_id:1475179], you will calculate the precise moment a significant feature—a loop, or 1-cycle—is \"born,\" providing a hands-on intuition for how TDA detects underlying shapes in data.", "problem": "In systems biology, Topological Data Analysis (TDA) provides a powerful framework for analyzing the 'shape' of complex biological data. One common application is to study the conformation of proteins by representing them as a point cloud of their alpha-carbon atoms. The Vietoris-Rips complex is then constructed on this point cloud to capture its topological features at different spatial scales.\n\nThe Vietoris-Rips complex, $VR(\\epsilon)$, on a set of points is a simplicial complex where:\n1. The vertices are the points themselves.\n2. An edge connects any two points if their Euclidean distance is less than or equal to a distance parameter $\\epsilon$.\n3. A triangle (or 2-simplex) is formed by three points if all three pairwise distances are less than or equal to $\\epsilon$.\n4. Higher-dimensional simplices (e.g., tetrahedra) are formed analogously.\n\nAs $\\epsilon$ increases, more connections are formed, and the topology of the complex changes. A key event is the appearance of a 'hole' or a 1-cycle, which is a closed loop of edges that is not the boundary of any set of triangles within the complex at that $\\epsilon$.\n\nConsider a small peptide fragment whose structure is approximated by the 3D coordinates of its five alpha-carbons, $P_1$ through $P_5$, given in Angstroms (Å):\n$P_1 = (0.0, 5.0, 0.1)$\n$P_2 = (4.0, 2.0, -0.2)$\n$P_3 = (3.0, -3.0, 0.3)$\n$P_4 = (-3.0, -3.0, -0.1)$\n$P_5 = (-4.0, 2.0, 0.2)$\n\nDetermine the smallest distance threshold $\\epsilon$ at which the first non-trivial 1-cycle appears in the Vietoris-Rips filtration of this point cloud. Express your answer in Angstroms (Å), rounded to three significant figures.", "solution": "We seek the smallest threshold $\\epsilon$ at which a non-trivial $1$-cycle (a loop of edges not filled by any $2$-simplices) first appears in the Vietoris–Rips filtration built on the five points $P_{1},\\dots,P_{5}$. In a Vietoris–Rips complex $VR(\\epsilon)$, an edge $\\{i,j\\}$ is present if the Euclidean distance $d_{ij}$ between $P_{i}$ and $P_{j}$ satisfies $d_{ij} \\leq \\epsilon$, and a triangle on $\\{i,j,k\\}$ is present if all three pairwise distances are $\\leq \\epsilon$.\n\nThe given coordinates are:\n$P_{1}=(0.0,5.0,0.1)$, $P_{2}=(4.0,2.0,-0.2)$, $P_{3}=(3.0,-3.0,0.3)$, $P_{4}=(-3.0,-3.0,-0.1)$, $P_{5}=(-4.0,2.0,0.2)$.\n\nFirst compute the Euclidean distances. Using $d_{ij}^{2}=(\\Delta x)^{2}+(\\Delta y)^{2}+(\\Delta z)^{2}$, we obtain the five “perimeter” edges (taking the natural cyclic order $1\\to 2\\to 3\\to 4\\to 5\\to 1$ suggested by the coordinates):\n$$\n\\begin{aligned}\nd_{12}^{2}&=4^{2}+3^{2}+0.3^{2}=16+9+0.09=25.09,\\quad &d_{12}=\\sqrt{25.09},\\\\\nd_{23}^{2}&=1^{2}+5^{2}+0.5^{2}=1+25+0.25=26.25,\\quad &d_{23}=\\sqrt{26.25},\\\\\nd_{34}^{2}&=6^{2}+0^{2}+0.4^{2}=36+0+0.16=36.16,\\quad &d_{34}=\\sqrt{36.16},\\\\\nd_{45}^{2}&=1^{2}+5^{2}+0.3^{2}=1+25+0.09=26.09,\\quad &d_{45}=\\sqrt{26.09},\\\\\nd_{51}^{2}&=4^{2}+3^{2}+0.1^{2}=16+9+0.01=25.01,\\quad &d_{51}=\\sqrt{25.01}.\n\\end{aligned}\n$$\nThe non-adjacent “diagonal” distances are:\n$$\n\\begin{aligned}\nd_{13}^{2}&=3^{2}+8^{2}+0.2^{2}=9+64+0.04=73.04,\\\\\nd_{24}^{2}&=7^{2}+5^{2}+0.1^{2}=49+25+0.01=74.01,\\\\\nd_{35}^{2}&=7^{2}+5^{2}+0.1^{2}=49+25+0.01=74.01,\\\\\nd_{41}^{2}&=3^{2}+8^{2}+0.2^{2}=9+64+0.04=73.04,\\\\\nd_{52}^{2}&=8^{2}+0^{2}+0.4^{2}=64+0+0.16=64.16.\n\\end{aligned}\n$$\n\nA $1$-cycle first appears when all five perimeter edges are present while no set of triangles fills the loop. The perimeter edges all exist when $\\epsilon$ reaches the largest of $\\{d_{12},d_{23},d_{34},d_{45},d_{51}\\}$, which is $d_{34}=\\sqrt{36.16}$. At $\\epsilon=d_{34}$, check for triangles: any triangle among three consecutive vertices, such as $\\{1,2,3\\}$, requires the corresponding diagonal (e.g., $d_{13}$) to also satisfy the threshold. However, all diagonals satisfy $d_{ij}>\\sqrt{64.16}$ for the shortest one and even larger for the others, and in particular $d_{13},d_{24},d_{35},d_{41},d_{52}>\\sqrt{36.16}$. Therefore, at $\\epsilon=\\sqrt{36.16}$ no triangles are present, so the loop formed by the five perimeter edges is not filled and constitutes a non-trivial $1$-cycle.\n\nHence, the smallest threshold at which the first non-trivial $1$-cycle appears is $\\epsilon=\\sqrt{36.16}$, whose decimal value rounded to three significant figures is $6.01$ in angstroms.", "answer": "$$\\boxed{6.01}$$", "id": "1475179"}, {"introduction": "Once topological features like loops are identified, we need a way to quantify their importance and represent them for further analysis; this is achieved through persistence diagrams, which record the \"birth\" and \"death\" of each feature. However, these diagrams can be difficult to work with directly. This exercise [@problem_id:1475107] demonstrates how to transform the information from a persistence diagram into a persistence landscape, a more stable and functional representation that is amenable to statistical comparison and machine learning.", "problem": "A systems biologist is studying the conformational changes of a large enzyme using a computational method based on Topological Data Analysis (TDA). The analysis represents the protein's structure as a point cloud in 3D space and tracks the appearance and disappearance of tunnels (topological features of dimension 1, or $H_1$) as the structure fluctuates over time. The \"lifetime\" of each tunnel is recorded in a persistence diagram.\n\nA persistence diagram is a set of points $p = (b, d)$ in a 2D plane, where $b$ is the \"birth time\" and $d$ is the \"death time\" of a feature, with $d > b$. From this diagram, one can construct a set of functions called the persistence landscape.\n\nFor each point $p = (b, d)$ in the diagram, a corresponding \"tent\" function, $f_p(x)$, is defined as:\n$$f_p(x) = \\max(0, \\min(x-b, d-x))$$\nThis function is a triangle with base on the interval $[b, d]$ on the x-axis, and its peak is at $x = \\frac{b+d}{2}$ with height $\\frac{d-b}{2}$.\n\nThe first persistence landscape function, denoted $\\lambda_1(x)$, is then defined as the pointwise maximum of all such tent functions:\n$$\\lambda_1(x) = \\max_{p} \\{ f_p(x) \\}$$\nwhere the maximum is taken over all points $p$ in the persistence diagram.\n\nSuppose the analysis of the enzyme yields a simple persistence diagram for the $H_1$ features containing just two points: $p_1 = (1, 7)$ and $p_2 = (4, 8)$. Which of the following statements best describes the shape of the resulting first persistence landscape function, $\\lambda_1(x)$?\n\nA. A single triangular peak.\n\nB. Two distinct, non-overlapping triangular peaks.\n\nC. A shape with two peaks, one a global maximum and one a local maximum.\n\nD. A trapezoidal shape with a flat top (a plateau).\n\nE. A shape with a single peak that is wider than the base of either individual tent function.", "solution": "We model the two tent functions from the given persistence diagram points. For a point $p=(b,d)$, the tent function is $f_{p}(x)=\\max\\left(0,\\min(x-b,d-x)\\right)$, which is triangular on $[b,d]$ with peak at $x=(b+d)/2$ of height $(d-b)/2$.\n\nFor $p_{1}=(1,7)$, the base is $[1,7]$, peak at $x=(1+7)/2=4$, height $(7-1)/2=3$. Thus\n$$\nf_{1}(x)=\\begin{cases}\n0, & x\\leq 1,\\\\\nx-1, & 1\\leq x\\leq 4,\\\\\n7-x, & 4\\leq x\\leq 7,\\\\\n0, & x\\geq 7.\n\\end{cases}\n$$\nFor $p_{2}=(4,8)$, the base is $[4,8]$, peak at $x=(4+8)/2=6$, height $(8-4)/2=2$. Thus\n$$\nf_{2}(x)=\\begin{cases}\n0, & x\\leq 4,\\\\\nx-4, & 4\\leq x\\leq 6,\\\\\n8-x, & 6\\leq x\\leq 8,\\\\\n0, & x\\geq 8.\n\\end{cases}\n$$\n\nThe first persistence landscape is $\\lambda_{1}(x)=\\max\\{f_{1}(x),f_{2}(x)\\}$. On $[1,4]$, only $f_{1}$ is nonzero and increases linearly to $3$ at $x=4$. On $[4,7]$, both are nonzero. The intersection point in this overlap solves\n$$\n7-x=x-4 \\quad\\Rightarrow\\quad 2x=11 \\quad\\Rightarrow\\quad x=\\frac{11}{2},\n$$\nwith common value $f_{1}=f_{2}=7-\\frac{11}{2}=\\frac{3}{2}$. Therefore, on $[4,\\frac{11}{2}]$, $f_{1}>f_{2}$ so $\\lambda_{1}$ decreases from $3$ to $\\frac{3}{2}$, and on $[\\frac{11}{2},6]$, $f_{2}>f_{1}$ so $\\lambda_{1}$ increases from $\\frac{3}{2}$ to $2$ at $x=6$. On $[6,8]$, $f_{2}$ dominates and decreases to $0$ at $x=8$.\n\nThus $\\lambda_{1}(x)$ has two peaks: a global maximum of height $3$ at $x=4$ and a smaller local maximum of height $2$ at $x=6$, separated by a local minimum at $x=\\frac{11}{2}$. This corresponds to a shape with two peaks, one global and one local.", "answer": "$$\\boxed{C}$$", "id": "1475107"}, {"introduction": "The final and most crucial step in any data-driven discovery is to assess the statistical significance of your findings. After detecting a persistent topological feature, how can we be confident it represents a true biological signal rather than random noise? This problem [@problem_id:1475171] introduces you to a powerful method—the permutation test—to calculate a $p$-value for an observed topological feature, grounding your TDA results in rigorous statistical validation.", "problem": "A systems biologist is investigating the cell cycle in a novel fungal species. They conduct a time-series transcriptomics experiment, measuring the expression levels of $N$ genes at $M$ equally spaced time points. The resulting data can be represented as a matrix $E$ of size $N \\times M$, where the entry $E_{ij}$ corresponds to the expression of gene $i$ at time point $j$. Each of the $M$ columns of this matrix is a vector representing the state of the system at a specific time.\n\nTo analyze the overall structure of the process, the biologist first reduces the dimensionality of the data. They treat each of the $M$ columns of $E$ as a point in an $N$-dimensional space and use Principal Component Analysis (PCA) to project these $M$ points into a 3-dimensional space. On this resulting 3D point cloud, they perform Topological Data Analysis (TDA) by constructing a Vietoris-Rips filtration. The analysis reveals a single, highly prominent 1-dimensional topological feature (a \"loop\"). The persistence of this feature, which is the difference between its 'death' and 'birth' scales in the filtration, is measured to be $P_{obs}$.\n\nThe biologist hypothesizes that this loop is a statistically significant signature of the periodic cell cycle, rather than an artifact of random noise. To test this hypothesis, a permutation-based statistical test is performed. The test involves generating $K$ surrogate datasets by permuting the original data. For each of the $K$ surrogate datasets, the exact same analysis pipeline (PCA followed by TDA) is applied, and the maximum persistence of any 1-dimensional feature is recorded. Let the set of these maximum persistence values from the $K$ surrogate datasets be $\\{P_1, P_2, \\dots, P_K\\}$.\n\nAssuming the permutation scheme is correctly designed to break the temporal ordering of the data while preserving its other statistical properties, provide the formula for the one-sided p-value. This p-value represents the probability of observing a loop with persistence at least as large as $P_{obs}$ under the null hypothesis that no true temporal structure exists. In your formula, use the notation $N(C)$ to denote the number of elements in the set $\\{P_k\\}_{k=1}^K$ that satisfy a condition $C$. For instance, the number of persistence values in the set greater than some value $\\alpha$ would be written as $N(P_k > \\alpha)$. To prevent a p-value of zero in the case that no surrogate persistence exceeds the observed one, a standard pseudocount of 1 should be added to both the numerator and the denominator of the proportion.", "solution": "We formalize the hypothesis test as follows. Define the test statistic to be the maximum 1-dimensional persistence produced by the analysis pipeline. Let the observed statistic be $T_{obs} = P_{obs}$. For each of the $K$ surrogate datasets generated under the null hypothesis, compute the same statistic to obtain $\\{P_{k}\\}_{k=1}^{K}$, where each $P_{k}$ is the maximum 1-dimensional persistence from the $k$-th surrogate.\n\nThe one-sided p-value for testing whether the observed loop persistence is at least as large as expected under the null is given by the empirical exceedance probability, with a pseudocount of 1 in both numerator and denominator to avoid a p-value of zero and to reflect inclusion of the observed dataset as one of the possible permutations. Using the notation $N(C)$ to denote the count of elements in $\\{P_{k}\\}_{k=1}^{K}$ that satisfy condition $C$, the p-value is\n$$\np = \\frac{1 + N\\!\\left(P_{k} \\ge P_{obs}\\right)}{K + 1}.\n$$\nThis counts all surrogate statistics at least as large as the observed one (handling ties via $\\ge$), adds a pseudocount of 1 to the numerator, and normalizes by the total number of datasets including the observed one, $K+1$.", "answer": "$$\\boxed{\\frac{1 + N\\!\\left(P_{k} \\ge P_{obs}\\right)}{K + 1}}$$", "id": "1475171"}]}