{"hands_on_practices": [{"introduction": "The foundation of single-cell systems biology rests on understanding the quantitative principles that govern molecular populations within a cell. The number of molecules for any given protein is not static but results from a dynamic balance between production and removal. This first practice exercise [@problem_id:1466140] invites you to apply a fundamental model of gene expression, where you'll calculate the expected protein abundance at steady state by relating the synthesis rate, $k_s$, to the degradation rate, $\\gamma_p$. Mastering this simple yet powerful relationship is the first step toward building more complex models of cellular behavior.", "problem": "In the field of synthetic biology, a researcher is studying a single-cell organism that has been engineered to produce a specific protein. The production and degradation of this protein can be described by a simple stochastic model. New protein molecules are synthesized at a constant average rate, $k_s$. Each existing protein molecule has a constant probability per unit time of being degraded, described by a first-order rate constant, $\\gamma_p$.\n\nExperimental measurements for this system have determined the following parameters:\n- The average synthesis rate, $k_s$, is 120 molecules per minute.\n- The degradation rate constant, $\\gamma_p$, is 3.0 per hour.\n\nAssuming the system has reached a statistical steady state, calculate the expected (average) number of protein molecules present in a single cell.", "solution": "Let $N(t)$ denote the protein copy number and let $n(t) = \\mathbb{E}[N(t)]$ be its mean. For a zero-order synthesis at rate $k_{s}$ (independent of $N$) and first-order degradation with per-molecule rate constant $\\gamma_{p}$, the mean obeys the linear ordinary differential equation\n$$\n\\frac{dn}{dt} = k_{s} - \\gamma_{p}\\,n.\n$$\nAt statistical steady state, $\\frac{dn}{dt} = 0$, so\n$$\n0 = k_{s} - \\gamma_{p}\\,n_{\\text{ss}} \\quad \\Rightarrow \\quad n_{\\text{ss}} = \\frac{k_{s}}{\\gamma_{p}}.\n$$\n\nTo evaluate $n_{\\text{ss}}$ using the given parameters, we must use consistent time units. Converting $\\gamma_{p} = 3.0 \\text{ per hour}$ to per minute gives\n$$\n\\gamma_{p} = \\frac{3}{60} \\text{ per minute} = \\frac{1}{20} \\text{ per minute}.\n$$\nWith $k_{s} = 120 \\text{ molecules per minute}$, the steady-state mean is\n$$\nn_{\\text{ss}} = \\frac{120}{\\frac{1}{20}} = 120 \\times 20 = 2400.\n$$\nThus, the expected number of protein molecules at steady state is $2400$.", "answer": "$$\\boxed{2400}$$", "id": "1466140"}, {"introduction": "While understanding individual genes is crucial, biological functions emerge from the coordinated action of many genes working together in pathways. A key task in single-cell analysis is to summarize the expression of a functionally related gene set into a single \"activity score\" for each cell. In this exercise [@problem_id:1466136], you will implement a common method for calculating such a score, which involves log-transforming, centering, and aggregating expression values. This hands-on calculation demonstrates how we can move from high-dimensional gene expression data to a more interpretable, systems-level view of cellular states.", "problem": "A systems biologist is analyzing a small single-cell RNA sequencing (scRNA-seq) dataset to understand metabolic heterogeneity. The dataset contains expression counts for several genes across four different cells. The biologist wants to quantify the activity of a specific metabolic pathway, which we'll call \"Metabolic Pathway X,\" within each cell by calculating a pathway activity score.\n\nThe expression count data, $E_{gc}$, for gene $g$ in cell $c$ is given in the table below:\n\n| Gene   | Cell1 | Cell2 | Cell3 | Cell4 |\n|:-------|:------|:------|:------|:------|\n| GCK    | 12    | 10    | 50    | 15    |\n| PFK    | 8     | 9     | 35    | 6     |\n| PKM    | 24    | 28    | 70    | 20    |\n| ACTB   | 150   | 155   | 145   | 160   |\n\nMetabolic Pathway X is defined by the set of genes {GCK, PFK, PKM}. The gene ACTB is a housekeeping gene and is not part of this pathway.\n\nThe pathway activity score, $S_c$, for a given cell $c$ is calculated using the following three-step procedure:\n1. For each gene $g$ and cell $c$, a log-transformed expression value, $X_{gc}$, is calculated from the raw expression count $E_{gc}$ using the formula $X_{gc} = \\ln(E_{gc} + 1)$.\n2. For each gene $g$ belonging to Metabolic Pathway X, its mean log-transformed expression, $\\mu_g$, is calculated by taking the arithmetic average of $X_{gc}$ across all four cells.\n3. The pathway activity score for a specific cell, say cell $c^*$, is then computed as the arithmetic mean of the centered log-expression values for that cell. That is, it is the average of the differences $(X_{gc^*} - \\mu_g)$ for all genes $g$ that are part of Metabolic Pathway X.\n\nUsing this procedure, calculate the pathway activity score for Cell3. Round your final answer to four significant figures.", "solution": "We are given raw expression counts $E_{gc}$ and a three-step procedure to compute the pathway activity score for Cell3 for Metabolic Pathway X with genes $\\{ \\text{GCK}, \\text{PFK}, \\text{PKM} \\}$.\n\nStep 1: For each gene $g$ and cell $c$, compute $X_{gc} = \\ln(E_{gc} + 1)$.\nFor the three genes across the four cells:\n- GCK: $X_{\\text{GCK},\\text{Cell1}} = \\ln(13)$, $X_{\\text{GCK},\\text{Cell2}} = \\ln(11)$, $X_{\\text{GCK},\\text{Cell3}} = \\ln(51)$, $X_{\\text{GCK},\\text{Cell4}} = \\ln(16)$.\n- PFK: $X_{\\text{PFK},\\text{Cell1}} = \\ln(9)$, $X_{\\text{PFK},\\text{Cell2}} = \\ln(10)$, $X_{\\text{PFK},\\text{Cell3}} = \\ln(36)$, $X_{\\text{PFK},\\text{Cell4}} = \\ln(7)$.\n- PKM: $X_{\\text{PKM},\\text{Cell1}} = \\ln(25)$, $X_{\\text{PKM},\\text{Cell2}} = \\ln(29)$, $X_{\\text{PKM},\\text{Cell3}} = \\ln(71)$, $X_{\\text{PKM},\\text{Cell4}} = \\ln(21)$.\n\nNumerical values (natural logarithms):\n$\\ln(13)=2.564949357$, $\\ln(11)=2.397895273$, $\\ln(51)=3.931825633$, $\\ln(16)=2.772588722$;\n$\\ln(9)=2.197224577$, $\\ln(10)=2.302585093$, $\\ln(36)=3.583518938$, $\\ln(7)=1.945910149$;\n$\\ln(25)=3.218875825$, $\\ln(29)=3.367295830$, $\\ln(71)=4.262679877$, $\\ln(21)=3.044522438$.\n\nStep 2: For each pathway gene $g$, compute its mean log-expression across all cells:\n$$\n\\mu_{\\text{GCK}}=\\frac{\\ln(13)+\\ln(11)+\\ln(51)+\\ln(16)}{4}=\\frac{11.667258985}{4}=2.916814746,\n$$\n$$\n\\mu_{\\text{PFK}}=\\frac{\\ln(9)+\\ln(10)+\\ln(36)+\\ln(7)}{4}=\\frac{10.029238758}{4}=2.507309689,\n$$\n$$\n\\mu_{\\text{PKM}}=\\frac{\\ln(25)+\\ln(29)+\\ln(71)+\\ln(21)}{4}=\\frac{13.893373970}{4}=3.473343492.\n$$\n\nStep 3: Compute the pathway activity score for Cell3 as the mean of centered log-expressions over pathway genes:\n$$\nS_{\\text{Cell3}}=\\frac{1}{3}\\left[\\left(X_{\\text{GCK},3}-\\mu_{\\text{GCK}}\\right)+\\left(X_{\\text{PFK},3}-\\mu_{\\text{PFK}}\\right)+\\left(X_{\\text{PKM},3}-\\mu_{\\text{PKM}}\\right)\\right].\n$$\nSubstituting Cell3 values $X_{\\text{GCK},3}=\\ln(51)=3.931825633$, $X_{\\text{PFK},3}=\\ln(36)=3.583518938$, $X_{\\text{PKM},3}=\\ln(71)=4.262679877$, we get the centered terms:\n$$\n3.931825633-2.916814746=1.015010886,\\quad\n3.583518938-2.507309689=1.076209249,\\quad\n4.262679877-3.473343492=0.789336385.\n$$\nTherefore,\n$$\nS_{\\text{Cell3}}=\\frac{1}{3}\\left(1.015010886+1.076209249+0.789336385\\right)=\\frac{2.880556520}{3}=0.960185507.\n$$\nRounding to four significant figures gives $0.9602$.", "answer": "$$\\boxed{0.9602}$$", "id": "1466136"}, {"introduction": "Single-cell RNA-sequencing data is notoriously sparse, meaning many genes with low expression may go undetected in a given cell. While data imputation algorithms aim to correct for this by \"filling in\" these missing values, they can also introduce artificial patterns. This practice problem [@problem_id:1466146] provides a striking, hands-on demonstration of this risk by guiding you through a simplified imputation process. By performing the calculation, you will see how an algorithm can create a statistically significant correlation between two genes that were not originally related, highlighting the critical importance of understanding potential artifacts introduced during data analysis.", "problem": "In single-cell RNA-sequencing (scRNA-seq), the expression level of thousands of genes is measured across thousands of individual cells. A common issue with this technology is the phenomenon of \"dropouts,\" where a gene that is actually expressed in a cell is not detected, resulting in a zero count in the final data matrix. These technical artifacts can complicate downstream analyses, such as determining relationships between genes.\n\nTo address this, bioinformaticians often use imputation algorithms to estimate the missing values. However, these methods can sometimes introduce new, artificial relationships that were not present in the original biological system.\n\nConsider a simplified scRNA-seq experiment measuring the expression of two genes, Gene A and Gene B, across four cells: Cell 1, Cell 2, Cell 3, and Cell 4. Due to dropouts, the observed expression matrix is as follows:\n\n| | Gene A | Gene B |\n| :--- | :---: | :---: |\n| **Cell 1** | 10 | 0 |\n| **Cell 2** | 10 | 10 |\n| **Cell 3** | 0 | 1 |\n| **Cell 4**| 1 | 10 |\n\nYou are tasked with applying a simple imputation algorithm to this matrix. The algorithm is a simplified version of k-Nearest Neighbors (k-NN) imputation with $k=1$. For each zero entry in the matrix, the algorithm proceeds as follows:\n1. Identify the single nearest neighbor to the cell containing the zero. The distance between cells is the standard Euclidean distance calculated using their observed expression vectors (i.e., the corresponding row in the table).\n2. Replace the zero with that gene's expression value from the identified nearest neighbor cell.\n\nThis imputation is performed for all zero entries to produce a dense, imputed matrix. After completing the imputation, calculate the Pearson correlation coefficient between the expression of Gene A and Gene B.\n\nRound your final answer to three significant figures.", "solution": "Let the observed expression vectors for the four cells be\n$$\nx_{1}=(10,0),\\quad x_{2}=(10,10),\\quad x_{3}=(0,1),\\quad x_{4}=(1,10).\n$$\nThe Euclidean distance between cells $i$ and $j$ is\n$$\nd(x_{i},x_{j})=\\sqrt{(A_{i}-A_{j})^{2}+(B_{i}-B_{j})^{2}}.\n$$\n\nFor Cell 1 (has a zero in Gene B), compute distances:\n$$\nd(x_{1},x_{2})=\\sqrt{(10-10)^{2}+(0-10)^{2}}=10,\\quad\nd(x_{1},x_{3})=\\sqrt{(10-0)^{2}+(0-1)^{2}}=\\sqrt{101},\\quad\nd(x_{1},x_{4})=\\sqrt{(10-1)^{2}+(0-10)^{2}}=\\sqrt{181}.\n$$\nThe nearest neighbor is Cell 2. Impute $B_{1}\\leftarrow B_{2}=10$.\n\nFor Cell 3 (has a zero in Gene A), compute distances:\n$$\nd(x_{3},x_{1})=\\sqrt{(0-10)^{2}+(1-0)^{2}}=\\sqrt{101},\\quad\nd(x_{3},x_{2})=\\sqrt{(0-10)^{2}+(1-10)^{2}}=\\sqrt{181},\\quad\nd(x_{3},x_{4})=\\sqrt{(0-1)^{2}+(1-10)^{2}}=\\sqrt{82}.\n$$\nThe nearest neighbor is Cell 4. Impute $A_{3}\\leftarrow A_{4}=1$.\n\nThus the imputed matrix is\n$$\n(A,B)=\\bigl[(10,10),\\ (10,10),\\ (1,1),\\ (1,10)\\bigr].\n$$\n\nLet the vectors be\n$$\n\\mathbf{a}=(10,10,1,1),\\quad \\mathbf{b}=(10,10,1,10).\n$$\nThe Pearson correlation is\n$$\nr=\\frac{\\sum_{i=1}^{4}(a_{i}-\\bar{a})(b_{i}-\\bar{b})}{\\sqrt{\\sum_{i=1}^{4}(a_{i}-\\bar{a})^{2}}\\;\\sqrt{\\sum_{i=1}^{4}(b_{i}-\\bar{b})^{2}}},\n$$\nwith means\n$$\n\\bar{a}=\\frac{10+10+1+1}{4}=\\frac{22}{4}=5.5,\\quad\n\\bar{b}=\\frac{10+10+1+10}{4}=\\frac{31}{4}=7.75.\n$$\nCompute the sums:\n$$\n\\sum(a_{i}-\\bar{a})(b_{i}-\\bar{b})=(4.5)(2.25)+(4.5)(2.25)+(-4.5)(-6.75)+(-4.5)(2.25)=40.5,\n$$\n$$\n\\sum(a_{i}-\\bar{a})^{2}=4\\cdot(4.5)^{2}=81,\\quad\n\\sum(b_{i}-\\bar{b})^{2}=3\\cdot(2.25)^{2}+(-6.75)^{2}=60.75.\n$$\nTherefore,\n$$\nr=\\frac{40.5}{\\sqrt{81\\cdot 60.75}}=\\frac{40.5}{9\\sqrt{60.75}}.\n$$\nNote that $60.75=\\frac{243}{4}$, so\n$$\n\\sqrt{81\\cdot 60.75}=\\sqrt{\\frac{81\\cdot 243}{4}}=\\frac{81\\sqrt{3}}{2},\\quad\nr=\\frac{81/2}{81\\sqrt{3}/2}=\\frac{1}{\\sqrt{3}}.\n$$\nRounding to three significant figures gives $0.577$.", "answer": "$$\\boxed{0.577}$$", "id": "1466146"}]}