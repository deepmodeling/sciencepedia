{"hands_on_practices": [{"introduction": "Before we can map the complex journeys of cells, we must ensure we are comparing them on a level playing field. Single-cell sequencing experiments often yield different amounts of data per cell, a technical variation known as 'library size'. This exercise demonstrates the critical importance of data normalization, a foundational step that corrects for these technical differences, allowing for scientifically sound comparisons of gene expression and accurate placement of cells in pseudotime. [@problem_id:1475523]", "problem": "In the field of systems biology, single-cell RNA-sequencing (scRNA-seq) is a powerful technology used to measure the gene expression profiles of thousands of individual cells. A common application of scRNA-seq is trajectory inference, which aims to computationally order cells along a continuous biological process, such as cellular differentiation, by analyzing their gene expression patterns. This ordering creates a \"pseudotime\" axis representing the progression of the process.\n\nAn investigator has collected scRNA-seq data from a population of cells undergoing differentiation. From this population, they have isolated two specific cells, Cell A and Cell B. The raw data for these cells consists of counts of unique molecular identifiers (UMIs) for each gene, which are proportional to the number of messenger RNA molecules originally present. The total number of UMIs counted in a cell is known as its \"library size\" and can vary significantly between cells due to technical factors.\n\nThe differentiation process is known to be governed by two key marker genes:\n1.  `Gene_Start`: This gene is highly expressed at the beginning of the differentiation process and its expression gradually decreases as cells mature.\n2.  `Gene_End`: This gene is expressed at low levels initially, and its expression gradually increases as cells reach the end of the differentiation process.\n\nThe raw UMI count data for the two cells is as follows:\n\n*   **Cell A**:\n    *   Total library size (total UMI counts): 2,000\n    *   UMI count for `Gene_Start`: 200\n    *   UMI count for `Gene_End`: 10\n\n*   **Cell B**:\n    *   Total library size (total UMI counts): 10,000\n    *   UMI count for `Gene_Start`: 500\n    *   UMI count for `Gene_End`: 200\n\nBased on these data and the known roles of the marker genes, what is the most scientifically sound conclusion about the relative positions of Cell A and Cell B along the differentiation trajectory?\n\nA. Cell A is at an earlier stage in the differentiation process than Cell B.\n\nB. Cell B is at an earlier stage in the differentiation process than Cell A.\n\nC. The data are inconclusive because Cell B has higher raw counts for both marker genes, presenting a contradictory biological signal.\n\nD. Both cells are likely in a stable, terminally differentiated state, as their expression profiles cannot be ordered in a meaningful way.\n\nE. The library size for Cell A is too small compared to Cell B to draw any reliable conclusions.", "solution": "To compare gene expression across cells with differing library sizes, use library-size normalization. The relevant principle is to compare the proportion of UMIs for each gene within each cell, defined as\n$$\np_{g,c}=\\frac{\\text{UMI count of gene }g\\text{ in cell }c}{\\text{total UMI count (library size) of cell }c}.\n$$\nCompute normalized expression for Cell A:\n$$\np_{\\text{Gene\\_Start},A}=\\frac{200}{2000}=\\frac{1}{10},\\quad p_{\\text{Gene\\_End},A}=\\frac{10}{2000}=\\frac{1}{200}.\n$$\nCompute normalized expression for Cell B:\n$$\np_{\\text{Gene\\_Start},B}=\\frac{500}{10000}=\\frac{1}{20},\\quad p_{\\text{Gene\\_End},B}=\\frac{200}{10000}=\\frac{1}{50}.\n$$\nCompare the normalized values:\n$$\np_{\\text{Gene\\_Start},A}=\\frac{1}{10}>\\frac{1}{20}=p_{\\text{Gene\\_Start},B},\\quad p_{\\text{Gene\\_End},A}=\\frac{1}{200}<\\frac{1}{50}=p_{\\text{Gene\\_End},B}.\n$$\nInterpretation using the stated marker behavior: higher relative expression of Gene_Start and lower relative expression of Gene_End indicates an earlier pseudotime position, whereas lower Gene_Start and higher Gene_End indicates a later pseudotime position. Therefore, Cell A is earlier along the differentiation trajectory than Cell B.\n\nThis rules out the alternatives that raw counts are contradictory (normalization resolves them), that both cells are terminal (the opposing marker trends indicate progression), or that Cell Aâ€™s library size precludes inference (proportions are interpretable).", "answer": "$$\\boxed{A}$$", "id": "1475523"}, {"introduction": "Once data is normalized, a crucial decision is selecting which genes to include in the analysis. The genes that best separate cells into distinct, stable types are not always the same ones that best describe the continuous, dynamic transitions between them. This practice explores this key conceptual challenge, highlighting how choosing genes optimized for clustering can inadvertently bias your analysis and mask the subtle genetic changes that drive the very process you want to model. [@problem_id:1475517]", "problem": "A developmental biologist is studying the differentiation of a specific type of progenitor cell into two distinct mature cell types, Type A and Type B, using single-cell RNA sequencing (scRNA-seq). The biologist first performs a standard analysis pipeline. They identify a set of highly variable genes (HVGs) across all sequenced cells. These are genes with the largest cell-to-cell expression variation. Using these HVGs, they successfully perform dimensionality reduction and clustering, clearly identifying three distinct cell populations: the initial Progenitor cells, mature Type A cells, and mature Type B cells.\n\nSatisfied with the clustering, the biologist decides to model the continuous differentiation process using trajectory inference, a computational method for ordering cells along a developmental path to create a \"pseudotime\" axis. For this step, they choose to use the exact same set of HVGs that was so effective for defining the discrete cell clusters.\n\nWhat is the most significant conceptual flaw in this analytical approach?\n\nA. The resulting pseudotime will be inverted, causing the trajectory to incorrectly show mature cells de-differentiating into progenitors.\n\nB. Using only a subset of genes like HVGs will introduce too much noise, making it computationally impossible to construct a stable trajectory.\n\nC. The analysis will be biased towards genes that distinguish the final, stable cell states, potentially failing to capture the dynamic expression of key regulatory genes that drive the transitions between states.\n\nD. This method will inevitably force the data into a single, unbranched linear trajectory, even if the underlying biological process involves a branching differentiation event.", "solution": "We begin by clarifying the role of highly variable genes (HVGs) in scRNA-seq analysis. HVGs are selected to maximize variance across all cells, which is a strategy well suited for identifying discrete cell populations via dimensionality reduction and clustering, because the genes with the largest between-cluster variance often include markers that distinguish stable end states.\n\nTrajectory inference, however, aims to reconstruct a continuous developmental path and assign pseudotime reflecting transcriptional progression. The gene set optimal for this task should emphasize genes whose expression varies smoothly along the developmental continuum, including transient regulators and transcription factors that change during state transitions. Such genes may not rank as globally highly variable across all cells, because their expression changes can be modest in amplitude or confined to subsets of cells (e.g., intermediate states), and thus they may be underrepresented or excluded by a global HVG filter designed for cluster separation.\n\nConsequently, reusing the same HVGs optimized for discrete clustering introduces a conceptual bias: the feature space is dominated by genes that best separate terminal states (Type A versus Type B), not those that define the transitional dynamics from Progenitor to mature states. This can lead to a trajectory that reflects static differences rather than the true progression, potentially missing or distorting the ordering and the regulatory genes driving transitions.\n\nWe now evaluate the options:\n- Option A is incorrect because pseudotime orientation is arbitrary and can be set by choosing a root; inversion is not a systematic consequence of HVG selection.\n- Option B is incorrect because using HVGs typically improves signal-to-noise for structure discovery; it does not make trajectory inference computationally impossible.\n- Option C correctly identifies the main conceptual flaw: bias toward genes distinguishing final states at the expense of capturing dynamic, transitional regulation.\n- Option D is incorrect because many trajectory inference methods can represent branching; the choice of HVGs does not inherently force a linear trajectory.\n\nTherefore, the most significant conceptual flaw is captured by Option C.", "answer": "$$\\boxed{C}$$", "id": "1475517"}, {"introduction": "Trajectory inference algorithms construct a \"map\" of cellular development, but like any map, it can sometimes contain errors, such as illogical shortcuts. This practice introduces you to a powerful quality control concept: programmatically identifying and pruning artifactual connections in the trajectory graph. By calculating a \"Neighborhood Inconsistency Score,\" you will gain hands-on experience in quantitatively evaluating the reliability of the inferred path, a vital skill for ensuring your biological conclusions are built on a robust computational foundation. [@problem_id:1475469]", "problem": "In the field of single-cell transcriptomics, trajectory inference aims to reconstruct the developmental paths of cells from a static snapshot of gene expression data. A common approach involves constructing a k-Nearest Neighbors (k-NN) graph, where each cell is a node and edges connect cells with similar expression profiles. From this graph, a \"pseudotime\" value is computed for each cell, ordering them along a developmental trajectory. A critical challenge arises when a suboptimal choice of parameters, such as the number of neighbors $k$, creates artifactual \"short-circuit\" edges that incorrectly link early-stage progenitor cells directly to late-stage terminal cells, bypassing intermediate states.\n\nTo identify and prune such artifacts, a quantitative metric is needed. Consider a \"Neighborhood Inconsistency Score\" (NIS) for any given edge $(u, v)$ in the cell graph. The principle is that for a valid edge, the pseudotime of cell $v$ should be consistent with the pseudotimes of cell $u$'s other neighbors, and vice-versa.\n\nThe NIS is defined as follows: For an edge $(u, v)$, let $P_i$ be the pre-computed pseudotime of cell $i$. Let $N'(u)$ be the set of neighbors of $u$ excluding $v$, and $N'(v)$ be the set of neighbors of $v$ excluding $u$. Let $\\langle P \\rangle_{N'}$ and $\\sigma_{N'}$ denote the mean and standard deviation of pseudotimes within a given neighborhood set, respectively. The NIS is then given by the formula:\n\n$$ \\text{NIS}(u, v) = \\frac{1}{2} \\left( \\frac{|P_v - \\langle P \\rangle_{N'(u)}|}{\\sigma_{N'(u)}} + \\frac{|P_u - \\langle P \\rangle_{N'(v)}|}{\\sigma_{N'(v)}} \\right) $$\n\nYou are tasked with evaluating a suspicious edge connecting a progenitor cell, $c_A$, to a terminally differentiated cell, $c_B$. The relevant pre-computed values are:\n\n- Pseudotime of cell $c_A$: $P_A = 0.05$\n- Pseudotime of cell $c_B$: $P_B = 0.95$\n- For the neighborhood of $c_A$ (excluding $c_B$): $\\langle P \\rangle_{N'(A)} = 0.08$ and $\\sigma_{N'(A)} = 0.030$\n- For the neighborhood of $c_B$ (excluding $c_A$): $\\langle P \\rangle_{N'(B)} = 0.91$ and $\\sigma_{N'(B)} = 0.040$\n\nCalculate the Neighborhood Inconsistency Score for the edge $(c_A, c_B)$. Round your final answer to three significant figures.", "solution": "We use the given definition of the Neighborhood Inconsistency Score:\n$$\n\\text{NIS}(u, v) = \\frac{1}{2} \\left( \\frac{|P_v - \\langle P \\rangle_{N'(u)}|}{\\sigma_{N'(u)}} + \\frac{|P_u - \\langle P \\rangle_{N'(v)}|}{\\sigma_{N'(v)}} \\right).\n$$\nFor the edge with $u=c_{A}$ and $v=c_{B}$, substitute the provided values:\n- $P_{A} = 0.05$, $P_{B} = 0.95$,\n- $\\langle P \\rangle_{N'(A)} = 0.08$, $\\sigma_{N'(A)} = 0.030$,\n- $\\langle P \\rangle_{N'(B)} = 0.91$, $\\sigma_{N'(B)} = 0.040$.\n\nCompute each standardized deviation term:\n$$\n\\frac{|P_{B} - \\langle P \\rangle_{N'(A)}|}{\\sigma_{N'(A)}} = \\frac{|0.95 - 0.08|}{0.030} = \\frac{0.87}{0.030} = 29,\n$$\n$$\n\\frac{|P_{A} - \\langle P \\rangle_{N'(B)}|}{\\sigma_{N'(B)}} = \\frac{|0.05 - 0.91|}{0.040} = \\frac{0.86}{0.040} = 21.5.\n$$\nAverage the two terms to obtain the NIS:\n$$\n\\text{NIS}(c_{A}, c_{B}) = \\frac{1}{2}\\left(29 + 21.5\\right) = \\frac{50.5}{2} = 25.25.\n$$\nRounding to three significant figures gives $25.3$.", "answer": "$$\\boxed{25.3}$$", "id": "1475469"}]}