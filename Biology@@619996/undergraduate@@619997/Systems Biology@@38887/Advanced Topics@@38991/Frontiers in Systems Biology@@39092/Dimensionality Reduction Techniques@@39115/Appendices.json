{"hands_on_practices": [{"introduction": "Principal Component Analysis (PCA) does more than just visualize data; it can be used to distill complex information into meaningful, quantitative metrics. This exercise demonstrates how to translate the abstract mathematical output of PCA into a practical biological tool. By calculating a \"metagene score\" from PC loadings, you will learn how to summarize the coordinated activity of an entire pathway into a single, interpretable value, a common and powerful technique in systems biology. [@problem_id:1428922]", "problem": "In systems biology, Principal Component Analysis (PCA) is a powerful technique for reducing the dimensionality of large datasets, such as gene expression profiles from cancer patients. A common application is to derive a \"metagene score\" that summarizes the activity of a biological pathway.\n\nA researcher is studying a specific metabolic pathway in cancer cells that involves four key genes: Gene A, Gene B, Gene C, and Gene D. They perform PCA on a large gene expression dataset and find that the first principal component (PC1) strongly correlates with the overall activity of this pathway. They decide to use the loadings of PC1 as weights to create a pathway activity score for new samples.\n\nThe PC1 loadings for the four genes are as follows:\n- Gene A: 0.65\n- Gene B: 0.55\n- Gene C: -0.40\n- Gene D: 0.30\n\nA new tumor sample is analyzed, and the standardized expression values (z-scores) for these four genes are measured:\n- Gene A: 2.20\n- Gene B: 1.80\n- Gene C: 1.50\n- Gene D: -1.10\n\nThe pathway activity score for this new sample is calculated as the sum of the products of each gene's expression value and its corresponding PC1 loading. Calculate the pathway activity score for this new tumor sample. Round your final answer to three significant figures.", "solution": "The problem asks us to calculate a \"pathway activity score\" for a new tumor sample. The score is defined as the sum of the products of each gene's standardized expression value and its corresponding Principal Component 1 (PC1) loading. This is equivalent to calculating the dot product of the expression vector and the loading vector.\n\nLet the vector of PC1 loadings be $\\mathbf{w}$ and the vector of gene expression values be $\\mathbf{g}$.\nThe loading vector $\\mathbf{w}$ for Genes A, B, C, and D is given as:\n$$ \\mathbf{w} = \\begin{pmatrix} 0.65 \\\\ 0.55 \\\\ -0.40 \\\\ 0.30 \\end{pmatrix} $$\n\nThe gene expression vector $\\mathbf{g}$ for the new sample is given as:\n$$ \\mathbf{g} = \\begin{pmatrix} 2.20 \\\\ 1.80 \\\\ 1.50 \\\\ -1.10 \\end{pmatrix} $$\n\nThe pathway activity score, $S$, is calculated as the dot product $\\mathbf{w} \\cdot \\mathbf{g}$:\n$$ S = \\sum_{i=1}^{4} w_i g_i = w_A g_A + w_B g_B + w_C g_C + w_D g_D $$\n\nNow, we substitute the given numerical values into this formula:\n$$ S = (0.65)(2.20) + (0.55)(1.80) + (-0.40)(1.50) + (0.30)(-1.10) $$\n\nWe calculate each product term by term:\n- For Gene A: $0.65 \\times 2.20 = 1.43$\n- For Gene B: $0.55 \\times 1.80 = 0.99$\n- For Gene C: $-0.40 \\times 1.50 = -0.60$\n- For Gene D: $0.30 \\times -1.10 = -0.33$\n\nNow, we sum these products to get the final score:\n$$ S = 1.43 + 0.99 - 0.60 - 0.33 $$\n$$ S = 2.42 - 0.60 - 0.33 $$\n$$ S = 1.82 - 0.33 $$\n$$ S = 1.49 $$\n\nThe problem asks for the answer to be rounded to three significant figures. The calculated value $1.49$ already has three significant figures.\n\nTherefore, the pathway activity score is 1.49.", "answer": "$$\\boxed{1.49}$$", "id": "1428922"}, {"introduction": "Choosing the right analytical tool is as important as the analysis itself. This practice challenges you to think critically about the fundamental assumptions of different dimensionality reduction methods. By comparing the outputs of linear PCA and non-linear t-SNE on cell cycle data, you will explore why a method's mathematical properties can determine whether it accurately reveals or unfortunately distorts the true underlying biological structure. [@problem_id:1428903]", "problem": "A systems biology student is analyzing a high-dimensional dataset of gene expression profiles from a large population of unsynchronized, continuously dividing cells. The goal is to visualize the progression of the cells through the cell cycle. Each data point represents the expression levels of thousands of genes in a single cell. The student applies two different dimensionality reduction techniques to project the data into two dimensions for visualization: Principal Component Analysis (PCA) and t-Distributed Stochastic Neighbor Embedding (t-SNE).\n\nThe resulting PCA plot shows the cells arranged in a broad arc or parabolic shape, where cells appear to start at one end of the arc and finish at the other. The t-SNE plot, however, shows the cells arranged in a distinct closed loop or circle.\n\nGiven your understanding of these algorithms and the biological process, which of the following statements provides the most accurate interpretation of these results?\n\nA. The PCA plot is more reliable. By maximizing the captured variance in its first two components, it correctly shows that the start and end of the cell cycle are the points of maximum transcriptional difference. The circular shape in the t-SNE plot is likely an artifact of the algorithm's tendency to create artificial clusters.\n\nB. The t-SNE plot is misleading. It forces a local structure that may not exist globally, suggesting a cyclical process where there might not be one. The PCA plot correctly reflects the dominant linear trend of differentiation and gene expression change across the cell population's most variable states.\n\nC. The t-SNE plot provides a more faithful representation of the underlying biology. The cell cycle is a continuous, cyclical process where cells at the end of mitosis are transcriptionally similar to cells just entering the G1 phase. PCA, as a linear projection method, is fundamentally unable to represent this \"wrap-around\" structure and instead \"unrolls\" the cycle into a linear path, artificially separating the start and end points.\n\nD. The difference in the plots indicates that the dataset is extremely noisy. PCA is more robust to noise and provides a smoothed, average trajectory. The t-SNE algorithm is overly sensitive to noise, causing it to incorrectly connect unrelated points into a closed loop.\n\nE. Both plots suggest that the cells are not actually cycling but are instead following a terminal differentiation pathway. The arc in the PCA plot represents this pathway, and the circular t-SNE plot is an artifact caused by the algorithm misinterpreting the start and end states as being similar.", "solution": "The core of this problem lies in understanding the fundamental difference between Principal Component Analysis (PCA), a linear dimensionality reduction technique, and t-Distributed Stochastic Neighbor Embedding (t-SNE), a non-linear one, in the context of a cyclical biological process.\n\nLet's analyze the nature of the data and the algorithms. The data comes from cells progressing through the cell cycle (G1 -> S -> G2 -> M -> G1 ...). This is a continuous and cyclical process. If we imagine the gene expression state of a cell as a point in a very high-dimensional space, the path traced by a cell as it progresses through the cycle would form a closed loop. This is because the gene expression profile of a cell at the end of mitosis (M phase) is very similar to that of a cell at the beginning of the subsequent interphase (G1 phase).\n\nNow, let's consider how each algorithm would project this high-dimensional loop into two dimensions.\n\n1.  **Principal Component Analysis (PCA):** PCA aims to find the orthogonal axes (principal components) that capture the maximum amount of variance in the data. For a dataset arranged in a high-dimensional loop, the first principal component (PC1) will likely be a line that cuts across the diameter of the loop, as this represents the direction of greatest variance. The second principal component (PC2), being orthogonal to the first, will capture the next largest amount of variance, which would correspond to the \"width\" of the loop. When you plot the data points along these two axes (PC1 vs. PC2), the circular structure is projected into a parabolic or U-shaped arc. The points at the beginning of the cycle (e.g., early G1) and the end of the cycle (e.g., late M) are transcriptionally very similar and should be close together. However, PCA projects them to opposite ends of the arc because it is constrained to a linear \"unrolling\" of the primary axis of variance. It creates artificial start and end points.\n\n2.  **t-Distributed Stochastic Neighbor Embedding (t-SNE):** t-SNE is a non-linear technique designed to preserve local neighborhood information. It calculates the probability that two points are neighbors in the high-dimensional space and tries to create a low-dimensional embedding where these probabilities are preserved. Because a cell in late M phase is a close neighbor of a cell in early G1 phase in the high-dimensional gene expression space, t-SNE will try to place them close together in the 2D plot. This focus on preserving local neighborhoods allows t-SNE to correctly identify and display the closed-loop topology of the cell cycle.\n\nNow we can evaluate the given options:\n\n*   **A:** This is incorrect. While PCA does maximize variance, this is its mathematical objective, not a guarantee of a more \"reliable\" or biologically faithful visualization. In this case, maximizing variance distorts the cyclical topology. The t-SNE plot is not creating an artificial cluster but revealing the true neighborhood relationships that PCA misses.\n*   **B:** This is incorrect. The t-SNE plot is not misleading; it is correctly capturing the local structure inherent in a cyclical process. The \"linear trend\" shown by PCA is an artifact of its linear projection.\n*   **C:** This is the correct interpretation. It accurately identifies the cell cycle as a cyclical process where the end state resembles the start state. It correctly attributes the failure of PCA to its linear nature, which forces it to \"unroll\" the cycle, and correctly identifies that t-SNE's ability to preserve local neighborhood structure allows it to represent the true cyclical topology.\n*   **D:** This is incorrect. While noise can affect both algorithms, the fundamental difference in the shape of the output (arc vs. loop) is a direct consequence of their differing mathematical foundations (linear vs. non-linear), not a differential response to noise.\n*   **E:** This is incorrect. It misinterprets the data based on the artifact produced by PCA. The problem statement specifies the cells are \"continuously dividing,\" implying a cycle, not a terminal pathway. The t-SNE plot, which is better suited for this type of data, confirms the cyclical nature.\n\nTherefore, the t-SNE plot is the more appropriate visualization for this dataset, and the discrepancy arises from the inability of a linear method like PCA to model a non-linear, cyclical data manifold.", "answer": "$$\\boxed{C}$$", "id": "1428903"}, {"introduction": "Observing a pattern in your data, such as a separation between different experimental groups, is an exciting first step in discovery. However, rigorous science demands that we ask: is this pattern real, or could it have arisen by random chance? This advanced practice bridges the gap between exploratory analysis and statistical inference, demonstrating how a permutation test can be used to calculate a p-value and formally assess the statistical significance of a separation observed in a PCA. [@problem_id:1428911]", "problem": "In a pilot systems biology study, researchers measure the expression levels of two genes (Gene 1, Gene 2) in six individuals. Three individuals are from a healthy cohort (H) and three have been diagnosed with a specific disease (D). The expression data, given as (Gene 1, Gene 2) pairs, is recorded as follows:\n- Healthy individuals: H1=(1, 5), H2=(2, 5), H3=(1, 4)\n- Diseased individuals: D1=(5, 1), D2=(5, 2), D3=(4, 1)\n\nTo explore the primary axis of variation in the data, a Principal Component Analysis (PCA) is performed. First, the data for each gene is centered by subtracting the mean expression level across all six individuals. Then, the first principal component (PC1) is determined. PC1 is the normalized eigenvector of the sample covariance matrix corresponding to the largest eigenvalue. The centered data for all six individuals are then projected onto PC1 to obtain a single score for each individual.\n\nA separation metric, $\\Delta$, is defined as the absolute difference between the mean PC1 score of the diseased group and the mean PC1 score of the healthy group. To evaluate if the observed separation is statistically significant, a p-value must be calculated. The p-value is defined as the proportion of all possible assignments of three 'diseased' labels to the six individuals that result in a separation metric $\\Delta$ greater than or equal to the metric $\\Delta_{obs}$ obtained from the original H/D labels.\n\nCalculate this p-value. Round your final answer to three significant figures.", "solution": "The problem asks for a p-value to assess the statistical significance of the separation between healthy and diseased groups along the first principal component (PC1). This requires performing a PCA and then a permutation test.\n\n**Step 1: Organize the data and calculate the means**\nThe data matrix $X$ (samples $\\times$ genes) is:\n$$\nX = \\begin{pmatrix}\n1 & 5 \\\\\n2 & 5 \\\\\n1 & 4 \\\\\n5 & 1 \\\\\n5 & 2 \\\\\n4 & 1\n\\end{pmatrix}\n$$\nThe mean for each gene (column) is calculated across all six individuals:\nMean of Gene 1: $\\mu_1 = \\frac{1+2+1+5+5+4}{6} = \\frac{18}{6} = 3$\nMean of Gene 2: $\\mu_2 = \\frac{5+5+4+1+2+1}{6} = \\frac{18}{6} = 3$\n\n**Step 2: Center the data**\nSubtract the mean vector $(\\mu_1, \\mu_2) = (3, 3)$ from each row of $X$ to get the centered data matrix $X_c$:\n$$\nX_c = \\begin{pmatrix}\n1-3 & 5-3 \\\\\n2-3 & 5-3 \\\\\n1-3 & 4-3 \\\\\n5-3 & 1-3 \\\\\n5-3 & 2-3 \\\\\n4-3 & 1-3\n\\end{pmatrix} = \\begin{pmatrix}\n-2 & 2 \\\\\n-1 & 2 \\\\\n-2 & 1 \\\\\n2 & -2 \\\\\n2 & -1 \\\\\n1 & -2\n\\end{pmatrix}\n$$\n\n**Step 3: Calculate the sample covariance matrix**\nThe sample covariance matrix $C$ is given by $C = \\frac{1}{n-1} X_c^T X_c$, where $n=6$.\n$$\nC = \\frac{1}{5} \\begin{pmatrix} -2 & -1 & -2 & 2 & 2 & 1 \\\\ 2 & 2 & 1 & -2 & -1 & -2 \\end{pmatrix} \\begin{pmatrix}\n-2 & 2 \\\\\n-1 & 2 \\\\\n-2 & 1 \\\\\n2 & -2 \\\\\n2 & -1 \\\\\n1 & -2\n\\end{pmatrix}\n$$\nThe elements of the covariance matrix are:\n$C_{11} = \\frac{1}{5} ((-2)^2 + (-1)^2 + (-2)^2 + 2^2 + 2^2 + 1^2) = \\frac{1}{5}(4+1+4+4+4+1) = \\frac{18}{5} = 3.6$\n$C_{22} = \\frac{1}{5} (2^2 + 2^2 + 1^2 + (-2)^2 + (-1)^2 + (-2)^2) = \\frac{1}{5}(4+4+1+4+1+4) = \\frac{18}{5} = 3.6$\n$C_{12} = C_{21} = \\frac{1}{5} ((-2)(2) + (-1)(2) + (-2)(1) + (2)(-2) + (2)(-1) + (1)(-2)) = \\frac{1}{5}(-4-2-2-4-2-2) = \\frac{-16}{5} = -3.2$\nSo, the covariance matrix is:\n$$\nC = \\begin{pmatrix} 3.6 & -3.2 \\\\ -3.2 & 3.6 \\end{pmatrix}\n$$\n\n**Step 4: Find the eigenvalues and the first principal component (PC1)**\nTo find the eigenvalues $\\lambda$, we solve the characteristic equation $\\det(C - \\lambda I) = 0$:\n$$\n(3.6 - \\lambda)(3.6 - \\lambda) - (-3.2)(-3.2) = 0\n$$\n$$\n(3.6 - \\lambda)^2 = (3.2)^2 = 10.24\n$$\n$$\n3.6 - \\lambda = \\pm 3.2\n$$\nThe two eigenvalues are $\\lambda_1 = 3.6 + 3.2 = 6.8$ and $\\lambda_2 = 3.6 - 3.2 = 0.4$.\nThe first principal component (PC1) is the eigenvector associated with the largest eigenvalue, $\\lambda_1=6.8$. Let the eigenvector be $v_1 = (v_{11}, v_{12})^T$.\n$$\n(C - \\lambda_1 I)v_1 = 0 \\implies \\begin{pmatrix} 3.6-6.8 & -3.2 \\\\ -3.2 & 3.6-6.8 \\end{pmatrix} \\begin{pmatrix} v_{11} \\\\ v_{12} \\end{pmatrix} = \\begin{pmatrix} -3.2 & -3.2 \\\\ -3.2 & -3.2 \\end{pmatrix} \\begin{pmatrix} v_{11} \\\\ v_{12} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThis gives the equation $-3.2 v_{11} - 3.2 v_{12} = 0$, which simplifies to $v_{11} = -v_{12}$.\nAn unnormalized eigenvector is $(1, -1)^T$. To normalize it, we divide by its magnitude $\\sqrt{1^2 + (-1)^2} = \\sqrt{2}$.\nSo, the first principal component is $w_1 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$.\n\n**Step 5: Project the centered data onto PC1**\nThe PC1 scores for each individual are calculated by projecting their centered data vectors onto $w_1$: Score $= X_c \\cdot w_1$.\n- Score H1: $(-2, 2) \\cdot \\frac{1}{\\sqrt{2}}(1, -1) = \\frac{1}{\\sqrt{2}}(-2 - 2) = -4/\\sqrt{2}$\n- Score H2: $(-1, 2) \\cdot \\frac{1}{\\sqrt{2}}(1, -1) = \\frac{1}{\\sqrt{2}}(-1 - 2) = -3/\\sqrt{2}$\n- Score H3: $(-2, 1) \\cdot \\frac{1}{\\sqrt{2}}(1, -1) = \\frac{1}{\\sqrt{2}}(-2 - 1) = -3/\\sqrt{2}$\n- Score D1: $(2, -2) \\cdot \\frac{1}{\\sqrt{2}}(1, -1) = \\frac{1}{\\sqrt{2}}(2 + 2) = 4/\\sqrt{2}$\n- Score D2: $(2, -1) \\cdot \\frac{1}{\\sqrt{2}}(1, -1) = \\frac{1}{\\sqrt{2}}(2 + 1) = 3/\\sqrt{2}$\n- Score D3: $(1, -2) \\cdot \\frac{1}{\\sqrt{2}}(1, -1) = \\frac{1}{\\sqrt{2}}(1 + 2) = 3/\\sqrt{2}$\nThe set of six PC1 scores is: $\\{-4/\\sqrt{2}, -3/\\sqrt{2}, -3/\\sqrt{2}, 4/\\sqrt{2}, 3/\\sqrt{2}, 3/\\sqrt{2}\\}$.\n\n**Step 6: Calculate the observed separation metric $\\Delta_{obs}$**\n- Mean score for Healthy group (H1, H2, H3): $\\mu_H = \\frac{1}{3} (-4/\\sqrt{2} - 3/\\sqrt{2} - 3/\\sqrt{2}) = \\frac{-10}{3\\sqrt{2}}$\n- Mean score for Diseased group (D1, D2, D3): $\\mu_D = \\frac{1}{3} (4/\\sqrt{2} + 3/\\sqrt{2} + 3/\\sqrt{2}) = \\frac{10}{3\\sqrt{2}}$\nThe observed separation metric is $\\Delta_{obs} = |\\mu_D - \\mu_H| = |\\frac{10}{3\\sqrt{2}} - (\\frac{-10}{3\\sqrt{2}})| = \\frac{20}{3\\sqrt{2}}$.\n\n**Step 7: Perform the permutation test**\nThe null hypothesis is that the labels are random. We need to find the proportion of label permutations that give a separation metric $\\Delta_{perm} \\ge \\Delta_{obs}$. The total number of ways to assign 3 'D' labels to 6 individuals is $\\binom{6}{3} = \\frac{6 \\times 5 \\times 4}{3 \\times 2 \\times 1} = 20$.\n\nThe PC1 scores are fixed; we only permute their labels. Let's work with the scores simplified by multiplying by $\\sqrt{2}$: $S = \\{-4, -3, -3, 3, 3, 4\\}$. The total sum of these scores is 0.\nFor any partition of $S$ into two groups of three, $G_1$ and $G_2$, their sums will be $S_1$ and $S_2 = -S_1$.\nThe separation metric for this partition is $\\Delta_{perm} = |\\frac{S_2/3}{\\sqrt{2}} - \\frac{S_1/3}{\\sqrt{2}}| = |\\frac{-S_1 - S_1}{3\\sqrt{2}}| = \\frac{2|S_1|}{3\\sqrt{2}}$.\nOur observed separation was $\\Delta_{obs} = \\frac{20}{3\\sqrt{2}}$, which corresponds to $|S_1| = 10$.\n\nWe need to find the number of partitions (out of 20) where the sum of one group's scores has an absolute value $|S_1| \\ge 10$.\nLet's list the possible sums of three scores chosen from $S = \\{-4, -3, -3, 3, 3, 4\\}$.\nWe want to find combinations of 3 elements whose sum is $\\le -10$ or $\\ge 10$.\nLet's analyze the extreme possibilities:\n- To get the most negative sum, we choose the three smallest scores: $\\{-4, -3, -3\\}$. The sum is $-10$. This gives $|S_1|=10$. This combination corresponds to the original labeling.\n- To get the most positive sum, we choose the three largest scores: $\\{3, 3, 4\\}$. The sum is $10$. This gives $|S_1|=10$. This combination is the complement of the first one.\n\nAny other combination of three scores will result in a sum between -10 and 10. For example:\n- $\\{-4, -3, 3\\}$ has sum -4, so $|S_1|=4 < 10$.\n- $\\{-3, -3, 4\\}$ has sum -2, so $|S_1|=2 < 10$.\n\nThus, there are only two combinations (permutations of labels) that result in a separation metric equal to the observed one:\n1.  Group 1 scores $\\{-4, -3, -3\\}$ and Group 2 scores $\\{3, 3, 4\\}$. $|S_1|=10$.\n2.  Group 1 scores $\\{3, 3, 4\\}$ and Group 2 scores $\\{-4, -3, -3\\}$. $|S_1|=10$.\n\nNo combination results in a separation metric strictly greater than the observed one.\nThe number of label assignments yielding $\\Delta_{perm} \\ge \\Delta_{obs}$ is 2.\n\n**Step 8: Calculate the p-value**\nThe p-value is the number of \"successful\" permutations divided by the total number of permutations.\n$$\np = \\frac{\\text{Number of permutations with } |S_1| \\ge 10}{\\text{Total number of permutations}} = \\frac{2}{20} = 0.1\n$$\n\n**Step 9: Round the final answer**\nThe problem asks for the answer rounded to three significant figures.\n$p = 0.100$.", "answer": "$$\\boxed{0.100}$$", "id": "1428911"}]}