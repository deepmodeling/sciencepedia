{"hands_on_practices": [{"introduction": "Data from different experiments or measurement techniques often come in different units and ranges. Before these diverse datasets can be meaningfully compared or integrated into a model, they must be brought to a common scale. This first exercise [@problem_id:1425867] provides hands-on practice with one of the most fundamental scaling techniques, Min-Max scaling, by asking you to transform a small dataset of protein abundance values into a specific numerical range.", "problem": "In a systems biology experiment, the abundance of a specific protein is measured at five consecutive time points following a stimulus. The recorded abundance values, in arbitrary fluorescence units, are collected into a vector $x = [5, 10, 20, 25, 90]$. Before incorporating this data into a larger computational model, it is necessary to normalize it. You are tasked with performing min-max scaling to transform the data into the standardized range of $[-1, 1]$.\n\nThe general formula for min-max scaling a data point $x_i$ from an original dataset with minimum value $x_{\\min}$ and maximum value $x_{\\max}$ to a new range $[a, b]$ is:\n\n$$x'_{i} = a + \\frac{(x_i - x_{\\min})(b - a)}{x_{\\max} - x_{\\min}}$$\n\nCalculate the new vector $x'$ containing the scaled abundance values. Express your answer as a row vector of five exact fractions.", "solution": "We are given the data vector $x=[5, 10, 20, 25, 90]$ and asked to apply min-max scaling to the range $[-1, 1]$. The min-max formula is\n$$\nx'_{i} = a + \\frac{(x_i - x_{\\min})(b - a)}{x_{\\max} - x_{\\min}},\n$$\nwith $a=-1$, $b=1$, $x_{\\min}=5$, and $x_{\\max}=90$. Substituting these into the formula gives\n$$\nx'_{i} = -1 + \\frac{(x_i - 5)(1 - (-1))}{90 - 5} = -1 + \\frac{2(x_i - 5)}{85}.\n$$\nWe now compute each scaled value exactly:\n- For $x_{1}=5$: $x'_{1} = -1 + \\frac{2(5-5)}{85} = -1 + 0 = \\frac{-1}{1}$.\n- For $x_{2}=10$: $x'_{2} = -1 + \\frac{2(10-5)}{85} = -1 + \\frac{10}{85} = -1 + \\frac{2}{17} = \\frac{-15}{17}$.\n- For $x_{3}=20$: $x'_{3} = -1 + \\frac{2(20-5)}{85} = -1 + \\frac{30}{85} = -1 + \\frac{6}{17} = \\frac{-11}{17}$.\n- For $x_{4}=25$: $x'_{4} = -1 + \\frac{2(25-5)}{85} = -1 + \\frac{40}{85} = -1 + \\frac{8}{17} = \\frac{-9}{17}$.\n- For $x_{5}=90$: $x'_{5} = -1 + \\frac{2(90-5)}{85} = -1 + \\frac{170}{85} = -1 + 2 = \\frac{1}{1}$.\n\nThus, the scaled vector as exact fractions is\n$$\n\\begin{pmatrix}\n\\frac{-1}{1}  \\frac{-15}{17}  \\frac{-11}{17}  \\frac{-9}{17}  \\frac{1}{1}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{-1}{1}  \\frac{-15}{17}  \\frac{-11}{17}  \\frac{-9}{17}  \\frac{1}{1}\\end{pmatrix}}$$", "id": "1425867"}, {"introduction": "Normalization is a powerful tool, but it rests on critical assumptions about your data. If these assumptions are not met, normalization can introduce artifacts that are more misleading than the original technical noise. This practice problem [@problem_id:1425895] presents a cautionary case study where an apparently stable reference gene is, in fact, affected by the experimental treatment. By working through the calculation, you will see firsthand how an inappropriate normalization choice can create the illusion of a biological effect where none exists, reinforcing the need for careful validation of reference controls.", "problem": "A molecular biologist is investigating the effect of a new drug on a human cancer cell line. The goal is to determine if the drug alters the expression of a target gene, \"Gene X\". The experiment consists of two groups of cell cultures: a \"Control\" group that receives a placebo and a \"Treatment\" group that receives the drug.\n\nTo quantify gene expression, the biologist measures the abundance of messenger RNA (mRNA) transcripts for Gene X. As a standard practice for data normalization, the biologist also measures the expression of a gene believed to be a stable \"reference gene,\" called \"Gene R,\" which is not expected to change its expression level in response to the drug.\n\nAfter the experiment, the biologist obtains the following raw mRNA transcript counts (in arbitrary units) for three biological replicates in each group:\n\n| Group     | Replicate | Gene X (counts) | Gene R (counts) |\n|-----------|-----------|-----------------|-----------------|\n| Control   | 1         | 1260            | 310             |\n| Control   | 2         | 1240            | 290             |\n| Control   | 3         | 1250            | 300             |\n| Treatment | 1         | 1275            | 615             |\n| Treatment | 2         | 1225            | 585             |\n| Treatment | 3         | 1250            | 600             |\n\nThe normalization procedure chosen by the biologist is as follows:\n1. For each group (Control and Treatment), calculate the average expression level for both Gene X and Gene R across the three replicates.\n2. For each group, calculate the \"normalized expression\" of Gene X by dividing its average expression by the average expression of the reference Gene R.\n\nFinally, to determine the effect of the drug, the biologist calculates the fold-change by taking the ratio of the normalized expression of Gene X in the Treatment group to that in the Control group.\n\nBased on the data provided and the specified normalization procedure, calculate the apparent fold-change for Gene X. Report your answer as a single numerical value, rounded to three significant figures.", "solution": "The goal is to calculate the apparent fold-change of Gene X's expression, defined as the ratio of its normalized expression in the Treatment group to its normalized expression in the Control group.\n\nFirst, we calculate the average expression for each gene in each group.\n\nFor the Control group:\nThe raw counts for Gene X are 1260, 1240, and 1250.\nThe average expression of Gene X in the Control group, $\\langle X_{ctrl} \\rangle$, is:\n$$ \\langle X_{ctrl} \\rangle = \\frac{1260 + 1240 + 1250}{3} = \\frac{3750}{3} = 1250 $$\nThe raw counts for Gene R are 310, 290, and 300.\nThe average expression of Gene R in the Control group, $\\langle R_{ctrl} \\rangle$, is:\n$$ \\langle R_{ctrl} \\rangle = \\frac{310 + 290 + 300}{3} = \\frac{900}{3} = 300 $$\n\nFor the Treatment group:\nThe raw counts for Gene X are 1275, 1225, and 1250.\nThe average expression of Gene X in the Treatment group, $\\langle X_{treat} \\rangle$, is:\n$$ \\langle X_{treat} \\rangle = \\frac{1275 + 1225 + 1250}{3} = \\frac{3750}{3} = 1250 $$\nThe raw counts for Gene R are 615, 585, and 600.\nThe average expression of Gene R in the Treatment group, $\\langle R_{treat} \\rangle$, is:\n$$ \\langle R_{treat} \\rangle = \\frac{615 + 585 + 600}{3} = \\frac{1800}{3} = 600 $$\n\nNext, we perform the normalization for each group as specified. The normalized expression, $X_{norm}$, is calculated by dividing the average expression of Gene X by the average expression of Gene R.\n\nFor the Control group, the normalized expression of Gene X, $X_{norm, ctrl}$, is:\n$$ X_{norm, ctrl} = \\frac{\\langle X_{ctrl} \\rangle}{\\langle R_{ctrl} \\rangle} = \\frac{1250}{300} = \\frac{12.5}{3} \\approx 4.1667 $$\n\nFor the Treatment group, the normalized expression of Gene X, $X_{norm, treat}$, is:\n$$ X_{norm, treat} = \\frac{\\langle X_{treat} \\rangle}{\\langle R_{treat} \\rangle} = \\frac{1250}{600} = \\frac{12.5}{6} \\approx 2.0833 $$\n\nFinally, we calculate the apparent fold-change, which is the ratio of the normalized expression in the Treatment group to that in the Control group.\n\n$$ \\text{Fold-Change} = \\frac{X_{norm, treat}}{X_{norm, ctrl}} = \\frac{1250 / 600}{1250 / 300} = \\frac{1250}{600} \\times \\frac{300}{1250} = \\frac{300}{600} = 0.5 $$\n\nThe problem asks for the answer to be rounded to three significant figures.\n\n$$ \\text{Fold-Change} = 0.500 $$\n\nThis result suggests that the drug causes a 50% reduction in the expression of Gene X. However, a direct inspection of the raw data shows that the average expression of Gene X is identical in both groups (1250 units). The apparent change is an artifact created by the normalization procedure, because the \"reference\" Gene R was not stable and its expression doubled in the treatment group.", "answer": "$$\\boxed{0.500}$$", "id": "1425895"}, {"introduction": "Standard normalization methods work well when a key assumption holds: that most genes are not differentially expressed between conditions. But what happens in experiments, like a CRISPR screen targeting a master regulator, that cause widespread, asymmetric changes in the transcriptome? This advanced problem [@problem_id:1425901] challenges you to step into the role of a bioinformatician faced with such a scenario. You will use mathematical modeling to derive a correction that disentangles the true biological signal from the artifacts created by a naive normalization method, a crucial skill for analyzing complex systems-level data.", "problem": "In a single-cell genomics experiment utilizing Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR) technology, a researcher investigates the function of a master transcription factor. Two populations of cells are analyzed via single-cell Ribonucleic acid (RNA) sequencing: a control population (C) and a population perturbed by the knockdown of the transcription factor (P).\n\nThe transcriptome of these cells can be modeled as comprising two mutually exclusive sets of genes: a set of \"housekeeping\" genes ($\\mathcal{G}_H$), whose expression is unaffected by the perturbation, and a set of \"regulated\" genes ($\\mathcal{G}_R$), whose expression is directly controlled by the targeted transcription factor. The knockdown is assumed to uniformly suppress the expression of all regulated genes by a true biological suppression factor $\\alpha$, where $0  \\alpha  1$. The expression of housekeeping genes remains unchanged.\n\nLet $U_{H,T}$ and $U_{R,T}$ be the true total number of mRNA molecules from housekeeping and regulated genes, respectively, within a cell of type $T \\in \\{C, P\\}$. Let $N_T = U_{H,T} + U_{R,T}$ be the total mRNA content of a cell. The experiment is designed such that the technical sequencing efficiency is identical for both control and perturbed cell populations.\n\nA bioinformatician on the project, employing a naive normalization method called Total Count Normalization (TCN), first calculates the total number of sequencing reads (total counts, $K_T$) for each cell type. They then normalize the data by dividing the reads of any given gene by the total counts for that cell type. Using this TCN-normalized data, they compute the average fold-change for the set of *regulated* genes, reporting an observed fold-change value of $F_{obs}$.\n\nFrom the control cell data, it is determined that the reads from housekeeping genes constitute a fraction $\\rho_H$ of the total reads. That is, if $K_{H,C}$ and $K_{R,C}$ are the total reads from housekeeping and regulated genes in the control sample, then $\\rho_H = K_{H,C} / (K_{H,C} + K_{R,C})$.\n\nYour task is to correct for the flawed TCN analysis. Derive a symbolic expression for the true biological suppression factor $\\alpha$ in terms of the reported value $F_{obs}$ and the measured fraction $\\rho_H$.", "solution": "We denote by $U_{H,T}$ and $U_{R,T}$ the true mRNA totals from housekeeping and regulated genes, respectively, in condition $T \\in \\{C, P\\}$, with $N_{T} = U_{H,T} + U_{R,T}$. Housekeeping expression is unchanged by the perturbation, so $U_{H,P} = U_{H,C}$. Regulated genes are uniformly suppressed by the biological factor $\\alpha$, so $U_{R,P} = \\alpha U_{R,C}$ with $0  \\alpha  1$.\n\nIdentical technical sequencing efficiency across conditions implies that read counts are proportional to true molecule counts with the same proportionality constant for both conditions. There exists $\\kappa  0$ such that for each class $X \\in \\{H,R\\}$ and condition $T \\in \\{C, P\\}$,\n$$\nK_{X,T} = \\kappa U_{X,T}, \\quad K_{T} = K_{H,T} + K_{R,T} = \\kappa N_{T}.\n$$\nTotal Count Normalization (TCN) divides each gene’s reads by the total reads $K_{T}$ of its sample. For any regulated gene $g$, with true counts $u_{g,T}$ and reads $k_{g,T} = \\kappa u_{g,T}$, its TCN-normalized value is\n$$\ny_{g,T} = \\frac{k_{g,T}}{K_{T}} = \\frac{\\kappa u_{g,T}}{\\kappa N_{T}} = \\frac{u_{g,T}}{N_{T}}.\n$$\nUnder the perturbation, $u_{g,P} = \\alpha u_{g,C}$ for all regulated genes $g \\in \\mathcal{G}_{R}$. Hence the TCN fold-change for any regulated gene is\n$$\n\\frac{y_{g,P}}{y_{g,C}} = \\frac{\\alpha u_{g,C}/N_{P}}{u_{g,C}/N_{C}} = \\alpha \\frac{N_{C}}{N_{P}}.\n$$\nSince this ratio is the same for all regulated genes, the reported average fold-change over regulated genes is\n$$\nF_{obs} = \\alpha \\frac{N_{C}}{N_{P}}.\n$$\n\nNext, express $N_{P}/N_{C}$ in terms of $\\rho_{H}$. From the control sample,\n$$\n\\rho_{H} = \\frac{K_{H,C}}{K_{H,C} + K_{R,C}} = \\frac{\\kappa U_{H,C}}{\\kappa (U_{H,C} + U_{R,C})} = \\frac{U_{H,C}}{N_{C}}.\n$$\nThus $U_{H,C} = \\rho_{H} N_{C}$ and $U_{R,C} = (1 - \\rho_{H}) N_{C}$. Using the perturbation model,\n$$\nN_{P} = U_{H,P} + U_{R,P} = U_{H,C} + \\alpha U_{R,C} = \\rho_{H} N_{C} + \\alpha (1 - \\rho_{H}) N_{C} = \\bigl[\\rho_{H} + \\alpha (1 - \\rho_{H})\\bigr] N_{C}.\n$$\nTherefore,\n$$\n\\frac{N_{C}}{N_{P}} = \\frac{1}{\\rho_{H} + \\alpha (1 - \\rho_{H})}.\n$$\nSubstituting into the expression for $F_{obs}$ gives\n$$\nF_{obs} = \\frac{\\alpha}{\\rho_{H} + \\alpha (1 - \\rho_{H})}.\n$$\nSolve this algebraically for $\\alpha$:\n$$\nF_{obs}\\bigl[\\rho_{H} + \\alpha (1 - \\rho_{H})\\bigr] = \\alpha,\n$$\n$$\nF_{obs}\\rho_{H} + F_{obs}\\alpha (1 - \\rho_{H}) = \\alpha,\n$$\n$$\n\\alpha \\bigl[1 - F_{obs}(1 - \\rho_{H})\\bigr] = F_{obs}\\rho_{H},\n$$\n$$\n\\alpha = \\frac{F_{obs}\\rho_{H}}{1 - F_{obs}(1 - \\rho_{H})}.\n$$\nThis expresses the true biological suppression factor in terms of the observed TCN-based fold-change and the housekeeping fraction measured in controls.", "answer": "$$\\boxed{\\frac{F_{obs}\\rho_{H}}{1 - F_{obs}(1 - \\rho_{H})}}$$", "id": "1425901"}]}