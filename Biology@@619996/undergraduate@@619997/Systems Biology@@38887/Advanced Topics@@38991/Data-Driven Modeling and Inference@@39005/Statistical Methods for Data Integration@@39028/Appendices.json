{"hands_on_practices": [{"introduction": "In systems biology, it is common to investigate a biological question, such as identifying protein-protein interactions, using multiple experimental techniques. Each method has its own biases and may produce a different list of results. This practice focuses on a fundamental task in data integration: quantitatively comparing these lists to assess their level of agreement. By calculating common set-based similarity metrics like the Jaccard index and the Sørensen-Dice coefficient, you will learn how to move beyond qualitative comparisons and apply rigorous standards to evaluate and integrate data from different experimental sources [@problem_id:1467781].", "problem": "In a systems biology experiment, a researcher aims to identify the protein interaction partners for a specific target protein, let's call it \"p53\". Two independent, high-throughput experimental techniques were used. The first technique is a Yeast Two-Hybrid (Y2H) screen, which identified a list of 120 potential interacting proteins. The second technique is Co-immunoprecipitation followed by mass spectrometry (Co-IP-MS), which identified a list of 85 potential interacting proteins. Upon comparing the two lists, it was found that 25 proteins were common to both experimental results.\n\nTo quantify the level of agreement, or concordance, between these two experimental methods, calculate two standard similarity metrics:\n1. The Jaccard index, defined as the size of the intersection divided by the size of the union of the two sets.\n2. The Sørensen-Dice coefficient, defined as twice the size of the intersection divided by the sum of the sizes of the two sets.\n\nProvide the calculated values for the Jaccard index and the Sørensen-Dice coefficient, in that order. Round your final answers to three significant figures.", "solution": "Let $A$ be the set of proteins identified by Y2H and $B$ be the set identified by Co-IP-MS. The given sizes are $|A|=120$, $|B|=85$, and $|A \\cap B|=25$.\n\nBy the principle of inclusion-exclusion, the size of the union is\n$$\n|A \\cup B| = |A| + |B| - |A \\cap B| = 120 + 85 - 25 = 180.\n$$\n\nThe Jaccard index $J$ is defined as\n$$\nJ = \\frac{|A \\cap B|}{|A \\cup B|} = \\frac{25}{180} = \\frac{5}{36} \\approx 0.138888\\ldots,\n$$\nwhich rounds to three significant figures as $0.139$.\n\nThe Sørensen-Dice coefficient $D$ is defined as\n$$\nD = \\frac{2|A \\cap B|}{|A| + |B|} = \\frac{2 \\times 25}{120 + 85} = \\frac{50}{205} = \\frac{10}{41} \\approx 0.243902\\ldots,\n$$\nwhich rounds to three significant figures as $0.244$.\n\nTherefore, in the order requested (Jaccard index, Sørensen-Dice coefficient), the values are $0.139$ and $0.244$.", "answer": "$$\\boxed{\\begin{pmatrix}0.139 & 0.244\\end{pmatrix}}$$", "id": "1467781"}, {"introduction": "A core goal of systems biology is to build quantitative models that explain how molecular components influence the behavior of the entire system. This exercise introduces multiple linear regression, a foundational statistical method for achieving this goal. You will use hypothetical expression data for enzymes in a metabolic pathway to predict the abundance of the final product, learning how to estimate the model coefficients ($\\beta_i$) that quantify the impact of each component on the outcome [@problem_id:1467795]. This practice is a key step towards building predictive, mechanistic models from 'omics' data.", "problem": "A systems biologist is investigating the biosynthesis of a key metabolite, 'Luminol-X', in a bioluminescent bacterium. The synthesis is believed to follow a simple two-step enzymatic pathway, where a precursor is converted to an intermediate by Enzyme E1, and the intermediate is then converted to Luminol-X by Enzyme E2.\n\nTo quantify the relationship between enzyme levels and metabolite production, the biologist collects data from $n=10$ independent bacterial cultures. For each culture $i$, they measure the gene expression levels of Enzyme E1 (denoted as $x_{1i}$) and Enzyme E2 (denoted as $x_{2i}$), as well as the final abundance of Luminol-X (denoted as $y_i$). Gene expression is measured in 'Relative Expression Units' and metabolite abundance is measured in 'Relative Abundance Units (RAU)'.\n\nThe biologist proposes to model the metabolite abundance using a multiple linear regression model of the form:\n$$y_i = \\beta_0 + \\beta_1 x_{1i} + \\beta_2 x_{2i} + \\epsilon_i$$\nwhere $\\beta_0, \\beta_1, \\beta_2$ are the regression coefficients and $\\epsilon_i$ represents the random error.\n\nThe summary statistics calculated from the experimental data are as follows:\n- Number of samples, $n = 10$\n- Sums of variables:\n    - $\\sum_{i=1}^{n} x_{1i} = 55.0$\n    - $\\sum_{i=1}^{n} x_{2i} = 55.0$\n    - $\\sum_{i=1}^{n} y_{i} = 328.0$\n- Sums of squares:\n    - $\\sum_{i=1}^{n} x_{1i}^2 = 385.0$\n    - $\\sum_{i=1}^{n} x_{2i}^2 = 385.0$\n- Sums of cross-products:\n    - $\\sum_{i=1}^{n} x_{1i} x_{2i} = 336.0$\n    - $\\sum_{i=1}^{n} x_{1i} y_{i} = 2059.0$\n    - $\\sum_{i=1}^{n} x_{2i} y_{i} = 2110.0$\n\nUsing the method of ordinary least squares, calculate the value of the regression coefficient $\\beta_1$, which represents the 'effect' of Enzyme E1 expression on the abundance of Luminol-X. Express your answer rounded to three significant figures. The units of the coefficient will be `RAU / Relative Expression Unit`.", "solution": "We model the response by the multiple linear regression\n$$y_{i}=\\beta_{0}+\\beta_{1}x_{1i}+\\beta_{2}x_{2i}+\\epsilon_{i}.$$\nThe ordinary least squares estimator satisfies the normal equations\n$$(X^{\\top}X)\\hat{\\beta}=X^{\\top}y,$$\nwhere $X$ has columns consisting of a column of ones, $x_{1}$, and $x_{2}$. The slope coefficients can equivalently be obtained by centering the variables and solving\n$$\\begin{pmatrix}S_{11} & S_{12} \\\\ S_{12} & S_{22}\\end{pmatrix}\\begin{pmatrix}\\hat{\\beta}_{1} \\\\ \\hat{\\beta}_{2}\\end{pmatrix}=\\begin{pmatrix}S_{1y} \\\\ S_{2y}\\end{pmatrix},$$\nwhere\n$$\\bar{x}_{1}=\\frac{\\sum x_{1i}}{n},\\quad \\bar{x}_{2}=\\frac{\\sum x_{2i}}{n},\\quad \\bar{y}=\\frac{\\sum y_{i}}{n},$$\n$$S_{11}=\\sum x_{1i}^{2}-n\\bar{x}_{1}^{2},\\quad S_{22}=\\sum x_{2i}^{2}-n\\bar{x}_{2}^{2},\\quad S_{12}=\\sum x_{1i}x_{2i}-n\\bar{x}_{1}\\bar{x}_{2},$$\n$$S_{1y}=\\sum x_{1i}y_{i}-n\\bar{x}_{1}\\bar{y},\\quad S_{2y}=\\sum x_{2i}y_{i}-n\\bar{x}_{2}\\bar{y}.$$\nFrom the given data, compute the means:\n$$\\bar{x}_{1}=\\frac{55.0}{10}=5.5,\\quad \\bar{x}_{2}=\\frac{55.0}{10}=5.5,\\quad \\bar{y}=\\frac{328.0}{10}=32.8.$$\nCompute the centered sums:\n$$S_{11}=385.0-10\\cdot(5.5)^{2}=385.0-302.5=82.5,$$\n$$S_{22}=385.0-10\\cdot(5.5)^{2}=82.5,$$\n$$S_{12}=336.0-10\\cdot(5.5)(5.5)=336.0-302.5=33.5,$$\n$$S_{1y}=2059.0-10\\cdot(5.5)(32.8)=2059.0-1804.0=255.0,$$\n$$S_{2y}=2110.0-10\\cdot(5.5)(32.8)=2110.0-1804.0=306.0.$$\nSolve for $\\hat{\\beta}_{1}$ using Cramer’s rule:\n$$\\hat{\\beta}_{1}=\\frac{S_{22}S_{1y}-S_{12}S_{2y}}{S_{11}S_{22}-S_{12}^{2}}=\\frac{(82.5)(255.0)-(33.5)(306.0)}{(82.5)(82.5)-(33.5)^{2}}.$$\nEvaluate the numerator and denominator:\n$$(82.5)(255.0)=21037.5,\\quad (33.5)(306.0)=10251.0,$$\n$$(82.5)(82.5)=6806.25,\\quad (33.5)^{2}=1122.25,$$\nso\n$$\\hat{\\beta}_{1}=\\frac{21037.5-10251.0}{6806.25-1122.25}=\\frac{10786.5}{5684}=1.89769595\\ldots$$\nRounded to three significant figures, the coefficient is $1.90$ in units of RAU per Relative Expression Unit.", "answer": "$$\\boxed{1.90}$$", "id": "1467795"}, {"introduction": "Bulk tissue measurements provide a powerful yet averaged view of molecular processes, masking the distinct contributions of the diverse cell types within. This advanced practice explores a cutting-edge solution: using a single-cell multi-omic reference atlas to deconvolve the bulk signal. You will leverage the output of a hypothetical integrative Non-Negative Matrix Factorization (iNMF) analysis to define cell-type specific signatures and then solve a linear mixing problem to estimate the cellular composition of a bulk sample [@problem_id:1467785]. This exercise demonstrates a powerful workflow for integrating data across different biological scales to uncover hidden cellular heterogeneity.", "problem": "In systems biology, deconvolving the cellular composition of heterogeneous bulk tissue samples is a fundamental challenge. A powerful approach involves leveraging single-cell multi-omic reference atlases.\n\nA researcher has generated a reference atlas from a small tissue biopsy using a technique that jointly profiles the transcriptome and chromatin accessibility of the same single cells. A computational analysis using an integrative Non-Negative Matrix Factorization (iNMF) was performed on this single-cell data. The iNMF algorithm factorizes the single-cell RNA-sequencing (scRNA-seq) expression matrix and the single-cell Assay for Transposase-Accessible Chromatin using sequencing (scATAC-seq) accessibility matrix into a shared cell-factor matrix, $H$, and modality-specific feature-factor matrices.\n\nThe analysis identified $K=3$ latent factors, which were determined to correspond to the three primary cell types present: Neurons (Factor 1), Astrocytes (Factor 2), and Microglia (Factor 3). The resulting cell-factor matrix, $H \\in \\mathbb{R}_{\\ge 0}^{3 \\times 6}$, provides the loading of each of the $C=6$ single cells onto these three factors. It is given by:\n$$\nH = \\begin{pmatrix}\n9 & 8 & 1 & 1 & 2 & 1 \\\\\n1 & 1 & 8 & 9 & 1 & 2 \\\\\n1 & 2 & 1 & 1 & 8 & 9\n\\end{pmatrix}\n$$\nwhere rows correspond to Factors 1, 2, and 3, and columns correspond to cells $c_1$ through $c_6$.\n\nThe corresponding raw scRNA-seq gene expression count matrix, $X_{RNA} \\in \\mathbb{R}_{\\ge 0}^{4 \\times 6}$, for $G=4$ genes is:\n$$\nX_{RNA} = \\begin{pmatrix}\n10 & 12 & 1 & 2 & 1 & 1 \\\\\n15 & 14 & 2 & 1 & 2 & 2 \\\\\n1 & 1 & 20 & 22 & 3 & 2 \\\\\n2 & 1 & 1 & 2 & 18 & 16\n\\end{pmatrix}\n$$\nwhere rows correspond to genes $g_1, g_2, g_3, g_4$ and columns correspond to the same six cells.\n\nSeparately, a bulk proteomics measurement was performed on a larger tissue sample from the same source. The abundance vector for $Q=2$ proteins, $y_{prot}$, was measured as:\n$$\ny_{prot} = \\begin{pmatrix} 6.1 \\\\ 6.15 \\end{pmatrix}\n$$\nIt is known that Protein 1 is the product of Gene 1, and Protein 2 is the product of Gene 4.\n\nYour task is to use the single-cell reference data to deconvolve the bulk proteomics sample. Assume the following:\n1.  Each single cell belongs to the cell type (factor) for which its loading in the matrix $H$ is maximal.\n2.  The protein signature of a cell type is the average gene expression of the corresponding genes, calculated across all single cells belonging to that type.\n3.  The bulk proteomics vector is a linear combination of the cell-type protein signatures, weighted by their respective proportions in the bulk sample. Let these proportions be $p_N, p_A, p_M$ for Neurons, Astrocytes, and Microglia, respectively, where $p_N+p_A+p_M=1$.\n\nCalculate the proportion of Astrocyte cells ($p_A$) in the bulk tissue sample. Express your answer as a decimal rounded to three significant figures.", "solution": "The iNMF cell-factor matrix $H$ assigns each cell to the factor with maximal loading:\n- For $c_{1}$: $(9,1,1)$, so Neuron.\n- For $c_{2}$: $(8,1,2)$, so Neuron.\n- For $c_{3}$: $(1,8,1)$, so Astrocyte.\n- For $c_{4}$: $(1,9,1)$, so Astrocyte.\n- For $c_{5}$: $(2,1,8)$, so Microglia.\n- For $c_{6}$: $(1,2,9)$, so Microglia.\n\nThus, Neurons: $\\{c_{1},c_{2}\\}$, Astrocytes: $\\{c_{3},c_{4}\\}$, Microglia: $\\{c_{5},c_{6}\\}$.\n\nThe protein signature of each cell type is the average expression of the corresponding genes across its cells. Protein 1 corresponds to Gene 1 (row 1 of $X_{RNA}$), and Protein 2 corresponds to Gene 4 (row 4 of $X_{RNA}$). From\n$$\nX_{RNA}=\\begin{pmatrix}\n10 & 12 & 1 & 2 & 1 & 1 \\\\\n15 & 14 & 2 & 1 & 2 & 2 \\\\\n1 & 1 & 20 & 22 & 3 & 2 \\\\\n2 & 1 & 1 & 2 & 18 & 16\n\\end{pmatrix},\n$$\nwe compute, for each cell type:\n\n- Neurons ($c_{1},c_{2}$): Gene 1 average $=\\frac{10+12}{2}=11$, Gene 4 average $=\\frac{2+1}{2}=1.5$. Thus $s_{N}=\\begin{pmatrix}11\\\\1.5\\end{pmatrix}$.\n- Astrocytes ($c_{3},c_{4}$): Gene 1 average $=\\frac{1+2}{2}=1.5$, Gene 4 average $=\\frac{1+2}{2}=1.5$. Thus $s_{A}=\\begin{pmatrix}1.5\\\\1.5\\end{pmatrix}$.\n- Microglia ($c_{5},c_{6}$): Gene 1 average $=\\frac{1+1}{2}=1$, Gene 4 average $=\\frac{18+16}{2}=17$. Thus $s_{M}=\\begin{pmatrix}1\\\\17\\end{pmatrix}$.\n\nLet the bulk proteomics vector be $y_{prot}=\\begin{pmatrix}6.1\\\\6.15\\end{pmatrix}$. The linear mixing model with proportions $p_{N},p_{A},p_{M}$ and $p_{N}+p_{A}+p_{M}=1$ is\n$$\n\\begin{pmatrix}6.1\\\\6.15\\end{pmatrix}\n= p_{N}\\begin{pmatrix}11\\\\1.5\\end{pmatrix}\n+ p_{A}\\begin{pmatrix}1.5\\\\1.5\\end{pmatrix}\n+ p_{M}\\begin{pmatrix}1\\\\17\\end{pmatrix}.\n$$\nComponent-wise, this yields\n$$\n11p_{N}+1.5p_{A}+1p_{M}=6.1,\\qquad 1.5p_{N}+1.5p_{A}+17p_{M}=6.15,\\qquad p_{N}+p_{A}+p_{M}=1.\n$$\nUse $p_{A}=1-p_{N}-p_{M}$ and substitute into the first two equations:\n$$\n11p_{N}+1.5(1-p_{N}-p_{M})+p_{M}=6.1 \\;\\Rightarrow\\; 9.5p_{N}-0.5p_{M}=4.6,\n$$\n$$\n1.5p_{N}+1.5(1-p_{N}-p_{M})+17p_{M}=6.15 \\;\\Rightarrow\\; 15.5p_{M}=4.65 \\;\\Rightarrow\\; p_{M}=\\frac{4.65}{15.5}=\\frac{93}{310}=0.3.\n$$\nThen from $9.5p_{N}-0.5p_{M}=4.6$,\n$$\n9.5p_{N}-0.5\\cdot 0.3=4.6 \\;\\Rightarrow\\; 9.5p_{N}=4.75 \\;\\Rightarrow\\; p_{N}=\\frac{4.75}{9.5}=0.5.\n$$\nFinally,\n$$\np_{A}=1-p_{N}-p_{M}=1-0.5-0.3=0.2.\n$$\nRounded to three significant figures, $p_{A}=0.200$.", "answer": "$$\\boxed{0.200}$$", "id": "1467785"}]}