{"hands_on_practices": [{"introduction": "Getting hands-on with data often begins with cleaning and preprocessing. This first practice [@problem_id:1437187] introduces gene-wise mean imputation, one of the most straightforward methods for handling missing values in a dataset. By calculating the replacement for a missing gene expression value, you will master a fundamental technique used to create a complete data matrix before applying more complex statistical analyses.", "problem": "A research group is studying the transcriptional response of human cells to a novel therapeutic compound. They measured the expression levels of five key signaling genes (labeled G1, G2, G3, G4, G5) across four replicate cell cultures (labeled S1, S2, S3, S4). The data, represented as normalized expression units, are organized in a matrix where rows correspond to genes and columns correspond to replicates.\n\nDue to a smudge on the microarray slide, the expression value for gene G3 in replicate S3 could not be read. The recorded dataset is as follows, with 'X' denoting the missing value:\n\n- **G1:** [2.15, 2.30, 2.25, 2.18]\n- **G2:** [0.88, 0.95, 0.91, 1.02]\n- **G3:** [1.54, 1.71, X, 1.60]\n- **G4:** [3.40, 3.11, 3.25, 3.32]\n- **G5:** [0.45, 0.39, 0.41, 0.44]\n\nTo complete the dataset before further statistical analysis, the team decides to employ a basic data imputation technique. Your task is to calculate the value of 'X' using gene-wise mean imputation. This technique involves replacing the missing value for a specific gene with the arithmetic mean of the observed expression values for that same gene from all other replicates.\n\nCalculate the imputed expression value for gene G3 in replicate S3. Round your final answer to three significant figures.", "solution": "We use gene-wise mean imputation: replace the missing value by the arithmetic mean of the observed values for the same gene. For gene G3, the observed expression values are $1.54$, $1.71$, and $1.60$ across the available replicates.\n\nThe imputed value $X$ is computed as\n$$\nX=\\frac{1}{3}\\left(1.54+1.71+1.60\\right).\n$$\nFirst sum the observed values:\n$$\n1.54+1.71=3.25,\\quad 3.25+1.60=4.85.\n$$\nDivide by the number of observed values:\n$$\nX=\\frac{4.85}{3}=1.616\\overline{6}.\n$$\nRounding to three significant figures gives\n$$\nX\\approx 1.62.\n$$", "answer": "$$\\boxed{1.62}$$", "id": "1437187"}, {"introduction": "A powerful method applied in the wrong context can lead to flawed conclusions. This exercise [@problem_id:1437171] moves beyond simple calculation to critical thinking, asking you to evaluate the biological appropriateness of mean imputation for microbiome count data. Understanding why a seemingly simple fix can be scientifically nonsensical is a key step toward becoming a discerning data analyst in systems biology.", "problem": "A team of microbial ecologists is studying the impact of agricultural practices on soil health. They collect soil samples from two locations: an undisturbed primary forest and an adjacent commercial farm that has been under cultivation for 50 years. They perform 16S rRNA gene sequencing to profile the bacterial communities, resulting in a table of counts for various Operational Taxonomic Units (OTUs), which are proxies for different bacterial species. A small excerpt of their data is shown below, where each cell contains the number of sequence reads assigned to an OTU in a given sample.\n\n| OTU ID | Sample F1 (Forest) | Sample F2 (Forest) | Sample A1 (Farm) | Sample A2 (Farm) |\n|---|---|---|---|---|\n| OTU-734 | 2105 | 1892 | 12 | 0 |\n| OTU-12 | 15 | 21 | 988 | 1104 |\n| OTU-98 | 0 | `NA` | 55 | 67 |\n\nDuring data processing, they notice a missing value (`NA`) for OTU-98 in Sample F2, likely due to a technical error during the sequencing library preparation for that specific data point. A junior data analyst proposes using mean imputation to handle this missing value. This method involves replacing the `NA` with the arithmetic mean of the counts for that OTU across all other samples where the count is known.\n\nWhich of the following statements provides the most significant biological justification for why this simple mean imputation approach is inappropriate for this type of microbiome count data?\n\nA. The calculated mean may not be an integer, which is inconsistent with data that represents counts of discrete items like sequence reads.\n\nB. This imputation method artificially reduces the total variance in the abundance of OTU-98, which can invalidate the assumptions of subsequent statistical tests like t-tests or Analysis of Variance (ANOVA).\n\nC. In a real-world dataset with thousands of OTUs and hundreds of samples, calculating the mean for each OTU with missing data is a computationally intensive and inefficient process.\n\nD. The presence or absence of a microbial species is a critical biological signal; imputing a non-zero mean could falsely suggest the presence of a species that was truly absent from the sample, thereby fabricating a key piece of ecological information.\n\nE. The method incorrectly assumes that the abundance of OTU-98 in Sample F2 is statistically independent of the abundances of OTU-734 and OTU-12 in that same sample.", "solution": "Define the count for a given OTU $i$ in sample $j$ as $x_{ij}$. For OTU-98 across the four samples $\\{F1, F2, A1, A2\\}$, the observed vector is $(x_{i,F1}, x_{i,F2}, x_{i,A1}, x_{i,A2}) = (0, \\text{NA}, 55, 67)$. The junior analyst proposes mean imputation across the observed entries for that OTU:\n$$\n\\tilde{x}_{i,F2} = \\frac{1}{n_{\\text{obs}}} \\sum_{j \\in \\{F1,A1,A2\\}} x_{ij} = \\frac{0 + 55 + 67}{3} = \\frac{122}{3}.\n$$\nUnder presence or absence interpretation, define the presence indicator $I_{ij} = \\mathbf{1}\\{x_{ij} > 0\\}$. Before imputation, the unknown presence in $F2$ cannot be inferred; after mean imputation, the imputed value satisfies $\\tilde{x}_{i,F2} = \\frac{122}{3} > 0$, which forces $I_{i,F2} = 1$ and thereby asserts presence of OTU-98 in the forest sample $F2$.\n\nFrom a biological standpoint in microbiome ecology, the presence or absence of an OTU is a critical ecological signal, often used to infer habitat specificity, niche partitioning, and community turnover between environments. Here, OTU-98 is absent in $F1$ (a forest sample) with $x_{i,F1} = 0$, and present in farm samples with $x_{i,A1}, x_{i,A2} > 0$. Mean imputation uses information from ecologically distinct samples (farms) to assign a positive value to a forest sample with missing data, fabricating a non-zero abundance and, hence, a presence call in $F2$ that may not be biologically real. This directly alters the binary ecological signal $I_{i,F2}$, potentially reversing or obscuring habitat-associated patterns such as forest-specific absence versus farm-specific presence.\n\nOther options are less compelling as the most significant biological justification: non-integer imputed values (Option A) are not biologically critical because downstream analyses commonly use normalized or transformed abundances where non-integer values are routine; variance reduction (Option B) is a valid statistical concern but is not primarily a biological justification; computational cost (Option C) is not a substantive issue; and assuming independence across OTUs within a sample (Option E) is not a requirement of the mean imputation proposed and does not capture the main biological flaw. Therefore, the strongest biological justification is that mean imputation can fabricate presence where the species may truly be absent, corrupting key ecological inferences.\n\nThus, the correct choice is D.", "answer": "$$\\boxed{D}$$", "id": "1437171"}, {"introduction": "In real-world research, there is often no single \"correct\" way to handle missing data; instead, we must assess how our choices impact the final conclusions. This practice [@problem_id:1437170] guides you through a sensitivity analysis, comparing the results of a simple mean imputation with a more sophisticated method, k-Nearest Neighbors (k-NN). By quantifying the difference in outcomes, you'll gain practical experience in evaluating the robustness of your analytical pipeline.", "problem": "In a systems biology experiment investigating the cellular response to a new drug, a researcher measured the expression levels of five genes (A, B, C, D, E) across three control samples (C1, C2, C3) and three treated samples (T1, T2, T3). The resulting dataset contains some missing values, denoted by `NA`.\n\n| Gene | C1   | C2   | C3   | T1   | T2   | T3   |\n|:----:|:----:|:----:|:----:|:----:|:----:|:----:|\n| A    | 2.0  | 3.0  | 2.5  | 6.0  | 5.0  | 5.5  |\n| B    | 8.0  | 9.0  | 7.0  | 3.0  | NA   | 4.0  |\n| C    | 4.0  | 5.0  | 6.0  | 4.5  | 5.5  | 5.0  |\n| D    | 10.0 | 11.0 | NA   | 10.5 | 9.5  | 10.0 |\n| E    | 1.0  | 2.0  | 3.0  | 8.0  | 9.0  | NA   |\n\nTo assess the impact of missing data on the conclusions, you must compare two imputation strategies: mean imputation and k-Nearest Neighbors (k-NN) imputation.\n\n1.  **Mean Imputation**: For a given gene, any `NA` value is replaced by the arithmetic mean of the observed expression values for that gene across all other samples.\n2.  **k-Nearest Neighbors (k-NN) Imputation**: For this problem, use `k=1`. To impute a missing value for a gene, first identify its \"nearest neighbor\". The distance between two genes is defined as the Euclidean distance between their expression vectors, calculated *only* over the set of samples where both genes have observed values. The gene with the smallest distance is the nearest neighbor. If there is a tie for the nearest neighbor, select the gene that comes first in alphabetical order. The `NA` is then replaced by the expression value of this nearest neighbor in the sample corresponding to the `NA`.\n\nAfter imputation, a gene is classified as Significantly Differentially Expressed (SDE) if its Differential Expression Score (DES) exceeds a threshold. The DES is defined as the absolute difference between the mean expression in the treated group and the mean expression in the control group:\n$$\n\\text{DES} = |\\text{mean}(\\text{Treated}) - \\text{mean}(\\text{Control})|\n$$\nA gene is considered SDE if its $\\text{DES} > 3.7$.\n\nYour task is to calculate the Jaccard distance between the set of SDE genes identified using mean imputation ($S_{\\text{mean}}$) and the set of SDE genes identified using 1-NN imputation ($S_{\\text{1-NN}}$). The Jaccard distance is defined as:\n$$\nD_J(S_{\\text{mean}}, S_{\\text{1-NN}}) = 1 - \\frac{|S_{\\text{mean}} \\cap S_{\\text{1-NN}}|}{|S_{\\text{mean}} \\cup S_{\\text{1-NN}}|}\n$$\nExpress your final answer as a decimal rounded to three significant figures.", "solution": "We denote the control samples as $C1, C2, C3$ and the treated samples as $T1, T2, T3$. There are three missing values: $B(T2)$, $D(C3)$, and $E(T3)$.\n\nMean imputation:\nFor each affected gene, replace the missing value with the mean of its observed entries across all samples.\n\n- Gene $B$: observed values are $8.0, 9.0, 7.0, 3.0, 4.0$, so\n$$\n\\overline{B}_{\\text{obs}}=\\frac{8+9+7+3+4}{5}=\\frac{31}{5}=6.2,\\quad B(T2)\\leftarrow 6.2.\n$$\n- Gene $D$: observed values are $10.0, 11.0, 10.5, 9.5, 10.0$, so\n$$\n\\overline{D}_{\\text{obs}}=\\frac{10+11+10.5+9.5+10}{5}=\\frac{51}{5}=10.2,\\quad D(C3)\\leftarrow 10.2.\n$$\n- Gene $E$: observed values are $1.0, 2.0, 3.0, 8.0, 9.0$, so\n$$\n\\overline{E}_{\\text{obs}}=\\frac{1+2+3+8+9}{5}=\\frac{23}{5}=4.6,\\quad E(T3)\\leftarrow 4.6.\n$$\n\nCompute DES for each gene with mean imputation. For a gene $G$, with control mean $\\overline{G}_{C}$ and treated mean $\\overline{G}_{T}$,\n$$\n\\text{DES}(G)=|\\overline{G}_{T}-\\overline{G}_{C}|.\n$$\n- $A$: $\\overline{A}_{C}=\\frac{2.0+3.0+2.5}{3}=2.5$, $\\overline{A}_{T}=\\frac{6.0+5.0+5.5}{3}=5.5$, so $\\text{DES}(A)=|5.5-2.5|=3.0$.\n- $B$: $\\overline{B}_{C}=\\frac{8+9+7}{3}=8$, $\\overline{B}_{T}=\\frac{3.0+6.2+4.0}{3}=\\frac{13.2}{3}=4.4$, so $\\text{DES}(B)=|4.4-8|=3.6$.\n- $C$: $\\overline{C}_{C}=\\frac{4+5+6}{3}=5$, $\\overline{C}_{T}=\\frac{4.5+5.5+5.0}{3}=5$, so $\\text{DES}(C)=0$.\n- $D$: $\\overline{D}_{C}=\\frac{10.0+11.0+10.2}{3}=\\frac{31.2}{3}=10.4$, $\\overline{D}_{T}=\\frac{10.5+9.5+10.0}{3}=10$, so $\\text{DES}(D)=|10-10.4|=0.4$.\n- $E$: $\\overline{E}_{C}=\\frac{1+2+3}{3}=2$, $\\overline{E}_{T}=\\frac{8+9+4.6}{3}=\\frac{21.6}{3}=7.2$, so $\\text{DES}(E)=|7.2-2|=5.2$.\n\nWith threshold $3.7$, the SDE genes are those with $\\text{DES}>3.7$. Hence under mean imputation,\n$$\nS_{\\text{mean}}=\\{E\\}.\n$$\n\n1-NN imputation (with $k=1$):\nFor a gene with a missing value, identify its nearest neighbor by Euclidean distance over the intersection of observed samples. For genes $X$ and $Y$, using the set $S$ of samples where both are observed,\n$$\nd(X,Y)=\\sqrt{\\sum_{s\\in S}(x_{s}-y_{s})^{2}},\n$$\nand we compare using $d^{2}(X,Y)$.\n\n- For $B$ (missing at $T2$):\n    - $d^{2}(B,A)$ over $\\{C1,C2,C3,T1,T3\\}$:\n    $$\n    (8-2)^{2}+(9-3)^{2}+(7-2.5)^{2}+(3-6)^{2}+(4-5.5)^{2}=36+36+20.25+9+2.25=103.5.\n    $$\n    - $d^{2}(B,C)$ over $\\{C1,C2,C3,T1,T3\\}$:\n    $$\n    (8-4)^{2}+(9-5)^{2}+(7-6)^{2}+(3-4.5)^{2}+(4-5)^{2}=16+16+1+2.25+1=36.25.\n    $$\n    - $d^{2}(B,D)$ over $\\{C1,C2,T1,T3\\}$:\n    $$\n    (8-10)^{2}+(9-11)^{2}+(3-10.5)^{2}+(4-10)^{2}=4+4+56.25+36=100.25.\n    $$\n    - $d^{2}(B,E)$ over $\\{C1,C2,C3,T1\\}$:\n    $$\n    (8-1)^{2}+(9-2)^{2}+(7-3)^{2}+(3-8)^{2}=49+49+16+25=139.\n    $$\n    The minimum is $36.25$ with neighbor $C$, so $B(T2)\\leftarrow C(T2)=5.5$.\n\n- For $D$ (missing at $C3$):\n    - $d^{2}(D,A)$ over $\\{C1,C2,T1,T2,T3\\}$:\n    $$\n    (10-2)^{2}+(11-3)^{2}+(10.5-6)^{2}+(9.5-5)^{2}+(10-5.5)^{2}=64+64+20.25+20.25+20.25=188.75.\n    $$\n    - $d^{2}(D,B)$ over $\\{C1,C2,T1,T3\\}$:\n    $$\n    (10-8)^{2}+(11-9)^{2}+(10.5-3)^{2}+(10-4)^{2}=4+4+56.25+36=100.25.\n    $$\n    - $d^{2}(D,C)$ over $\\{C1,C2,T1,T2,T3\\}$:\n    $$\n    (10-4)^{2}+(11-5)^{2}+(10.5-4.5)^{2}+(9.5-5.5)^{2}+(10-5)^{2}=36+36+36+16+25=149.\n    $$\n    - $d^{2}(D,E)$ over $\\{C1,C2,T1,T2\\}$:\n    $$\n    (10-1)^{2}+(11-2)^{2}+(10.5-8)^{2}+(9.5-9)^{2}=81+81+6.25+0.25=168.5.\n    $$\n    The minimum is $100.25$ with neighbor $B$, so $D(C3)\\leftarrow B(C3)=7.0$.\n\n- For $E$ (missing at $T3$):\n    - $d^{2}(E,A)$ over $\\{C1,C2,C3,T1,T2\\}$:\n    $$\n    (1-2)^{2}+(2-3)^{2}+(3-2.5)^{2}+(8-6)^{2}+(9-5)^{2}=1+1+0.25+4+16=22.25.\n    $$\n    - $d^{2}(E,B)$ over $\\{C1,C2,C3,T1\\}$:\n    $$\n    (1-8)^{2}+(2-9)^{2}+(3-7)^{2}+(8-3)^{2}=49+49+16+25=139.\n    $$\n    - $d^{2}(E,C)$ over $\\{C1,C2,C3,T1,T2\\}$:\n    $$\n    (1-4)^{2}+(2-5)^{2}+(3-6)^{2}+(8-4.5)^{2}+(9-5.5)^{2}=9+9+9+12.25+12.25=51.5.\n    $$\n    - $d^{2}(E,D)$ over $\\{C1,C2,T1,T2\\}$:\n    $$\n    (1-10)^{2}+(2-11)^{2}+(8-10.5)^{2}+(9-9.5)^{2}=81+81+6.25+0.25=168.5.\n    $$\n    The minimum is $22.25$ with neighbor $A$, so $E(T3)\\leftarrow A(T3)=5.5$.\n\nCompute DES for each gene with 1-NN imputation:\n- $A$: unchanged, $\\overline{A}_{C}=2.5$, $\\overline{A}_{T}=5.5$, $\\text{DES}(A)=3.0$.\n- $B$: $\\overline{B}_{C}=8$, $\\overline{B}_{T}=\\frac{3.0+5.5+4.0}{3}=\\frac{12.5}{3}$, so\n$$\n\\text{DES}(B)=\\left|\\frac{12.5}{3}-8\\right|=\\left|\\,\\frac{12.5-24}{3}\\,\\right|=\\frac{11.5}{3}\\approx 3.833\\ldots\n$$\n- $C$: $\\text{DES}(C)=0$.\n- $D$: $\\overline{D}_{C}=\\frac{10+11+7}{3}=\\frac{28}{3}$, $\\overline{D}_{T}=10$, so\n$$\n\\text{DES}(D)=\\left|10-\\frac{28}{3}\\right|=\\frac{2}{3}\\approx 0.666\\ldots\n$$\n- $E$: $\\overline{E}_{C}=2$, $\\overline{E}_{T}=\\frac{8+9+5.5}{3}=\\frac{22.5}{3}=7.5$, so $\\text{DES}(E)=|7.5-2|=5.5$.\n\nWith threshold $3.7$, the SDE genes under 1-NN are\n$$\nS_{\\text{1-NN}}=\\{B,E\\}.\n$$\n\nJaccard distance:\n$$\nS_{\\textěrm{mean}}=\\{E\\},\\quad S_{\\text{1-NN}}=\\{B,E\\},\\quad |S_{\\text{mean}}\\cap S_{\\text{1-NN}}|=1,\\quad |S_{\\text{mean}}\\cup S_{\\text{1-NN}}|=2.\n$$\nTherefore,\n$$\nD_{J}=1-\\frac{|S_{\\text{mean}}\\cap S_{\\text{1-NN}}|}{|S_{\\text{mean}}\\cup S_{\\text{1-NN}}|}=1-\\frac{1}{2}=\\frac{1}{2}=0.5.\n$$\nRounded to three significant figures, this is $0.500$.", "answer": "$$\\boxed{0.500}$$", "id": "1437170"}]}