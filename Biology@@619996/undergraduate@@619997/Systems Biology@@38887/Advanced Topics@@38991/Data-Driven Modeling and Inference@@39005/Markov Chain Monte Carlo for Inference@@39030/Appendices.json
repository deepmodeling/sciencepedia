{"hands_on_practices": [{"introduction": "Before we can interpret the results of a complex MCMC simulation, we must first understand its fundamental engine: the Metropolis-Hastings acceptance rule. This exercise puts you in the driver's seat for a single step of the algorithm, asking you to calculate the probability of accepting a proposed new parameter value. By working through this calculation, you will gain a concrete feel for how MCMC uses your data and model to decide where to explore in the parameter landscape [@problem_id:1444253].", "problem": "A systems biologist is studying a simple enzymatic reaction where a substrate protein, S, is phosphorylated by a kinase to produce a product, P. The reaction is modeled as a first-order kinetic process. The concentration of the phosphorylated product, $[P](t)$, at time $t$ is described by the equation:\n$$[P](t) = [S]_0 (1 - \\exp(-kt))$$\nwhere $[S]_0$ is the initial concentration of the substrate S, and $k$ is the phosphorylation rate constant. The biologist aims to estimate the value of $k$ from experimental data using a Bayesian inference approach, specifically the Metropolis-Hastings Markov Chain Monte Carlo (MCMC) algorithm.\n\nThe experiment was performed with an initial substrate concentration of $[S]_0 = 1.0 \\, \\mu\\text{M}$. The concentration of the product P was measured at three different time points, yielding the following dataset:\n- At $t_1 = 1.0$ min, the measured concentration is $[P]_1 = 0.25 \\, \\mu\\text{M}$.\n- At $t_2 = 2.0$ min, the measured concentration is $[P]_2 = 0.45 \\, \\mu\\text{M}$.\n- At $t_3 = 5.0$ min, the measured concentration is $[P]_3 = 0.70 \\, \\mu\\text{M}$.\n\nThe measurement errors are assumed to be independent and to follow a Gaussian distribution with a mean of zero and a known standard deviation of $\\sigma = 0.05 \\, \\mu\\text{M}$. For the Bayesian analysis, a uniform prior distribution is chosen for the rate constant $k$ over the interval $[0, 1.0 \\, \\text{min}^{-1}]$.\n\nDuring one step of the MCMC simulation, the current state of the chain is $k_{current} = 0.30 \\, \\text{min}^{-1}$. A new candidate state is proposed, $k_{prop} = 0.35 \\, \\text{min}^{-1}$. Calculate the Metropolis-Hastings acceptance probability, $\\alpha$, for this proposed move. Round your final answer to three significant figures.", "solution": "We model the observations using independent Gaussian errors with known standard deviation $\\sigma$, so the likelihood for a given $k$ is\n$$\nL(k) = \\prod_{i=1}^{3} \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\!\\left(-\\frac{\\left([P]_{i}-[P](t_{i};k)\\right)^{2}}{2\\sigma^{2}}\\right),\n$$\nwhere $[P](t;k) = [S]_{0}\\left(1-\\exp(-kt)\\right)$. The prior for $k$ is uniform on $[0,1]$, and both $k_{current}=0.30$ and $k_{prop}=0.35$ lie in this interval, so the prior ratio is $1$. Assuming a symmetric proposal (so the proposal density ratio is $1$), the Metropolis-Hastings acceptance probability is\n$$\n\\alpha = \\min\\!\\left(1,\\frac{L(k_{prop})}{L(k_{current})}\\right)\n= \\min\\!\\left(1,\\exp\\!\\left(-\\frac{\\sum_{i=1}^{3}\\left(r_{prop,i}^{2}-r_{curr,i}^{2}\\right)}{2\\sigma^{2}}\\right)\\right),\n$$\nwith residuals $r_{(\\cdot),i} = [P]_{i}-[P](t_{i};k_{(\\cdot)})$.\n\nUsing $[S]_{0}=1.0$, $\\sigma=0.05$, times $t_{1}=1.0$, $t_{2}=2.0$, $t_{3}=5.0$, and observations $[P]_{1}=0.25$, $[P]_{2}=0.45$, $[P]_{3}=0.70$, compute model predictions:\n- For $k_{current}=0.30$:\n$$\n[P](1;0.30)=1-\\exp(-0.30)=0.2591817793,\\quad\n[P](2;0.30)=1-\\exp(-0.60)=0.4511883639,\\quad\n[P](5;0.30)=1-\\exp(-1.50)=0.7768698399.\n$$\nResiduals and squares:\n$$\nr_{curr,1}=0.25-0.2591817793=-0.0091817793,\\quad r_{curr,1}^{2}\\approx 0.0000843051,\n$$\n$$\nr_{curr,2}=0.45-0.4511883639=-0.0011883639,\\quad r_{curr,2}^{2}\\approx 0.00000141221,\n$$\n$$\nr_{curr,3}=0.70-0.7768698399=-0.0768698399,\\quad r_{curr,3}^{2}\\approx 0.00590897229,\n$$\nso\n$$\n\\mathrm{SSE}_{current}=\\sum r_{curr,i}^{2}\\approx 0.00599468957.\n$$\n\n- For $k_{prop}=0.35$:\n$$\n[P](1;0.35)=1-\\exp(-0.35)=0.2953119103,\\quad\n[P](2;0.35)=1-\\exp(-0.70)=0.5034146962,\\quad\n[P](5;0.35)=1-\\exp(-1.75)=0.8262260565.\n$$\nResiduals and squares:\n$$\nr_{prop,1}=0.25-0.2953119103=-0.0453119103,\\quad r_{prop,1}^{2}\\approx 0.00205316922,\n$$\n$$\nr_{prop,2}=0.45-0.5034146962=-0.0534146962,\\quad r_{prop,2}^{2}\\approx 0.00285312977,\n$$\n$$\nr_{prop,3}=0.70-0.8262260565=-0.1262260565,\\quad r_{prop,3}^{2}\\approx 0.01593301734,\n$$\nso\n$$\n\\mathrm{SSE}_{prop}=\\sum r_{prop,i}^{2}\\approx 0.02083931633.\n$$\n\nThus\n$$\n\\Delta \\mathrm{SSE}=\\mathrm{SSE}_{prop}-\\mathrm{SSE}_{current}\\approx 0.01484462676,\\quad\n2\\sigma^{2}=2\\cdot(0.05)^{2}=0.005,\n$$\nand the likelihood ratio is\n$$\n\\frac{L(k_{prop})}{L(k_{current})}=\\exp\\!\\left(-\\frac{\\Delta \\mathrm{SSE}}{2\\sigma^{2}}\\right)\n=\\exp\\!\\left(-\\frac{0.01484462676}{0.005}\\right)=\\exp(-2.96892535)\\approx 0.0514.\n$$\nTherefore,\n$$\n\\alpha=\\min(1,0.0514)=0.0514,\n$$\nto three significant figures.", "answer": "$$\\boxed{0.0514}$$", "id": "1444253"}, {"introduction": "An MCMC simulation's efficiency hinges on how it explores the parameter space, a behavior controlled by the 'proposal distribution'. If the proposed steps are too small, the sampler moves too slowly; if they are too large, most are rejected, and the sampler gets stuck. This exercise simulates the practical task of tuning this distribution by analyzing the acceptance rates from several pilot runs to find the 'Goldilocks' setting for efficient inference [@problem_id:1444206].", "problem": "A systems biology researcher is investigating the movement of a specific motor protein along a microtubule, which can be modeled as one-dimensional diffusion. The mean squared displacement (MSD) of the protein is related to its diffusion coefficient, $D$, and the time lag, $\\tau$, by the equation $\\langle (\\Delta x)^2 \\rangle = 2D\\tau$. To estimate the value of $D$ from a set of experimental measurements, the researcher uses a Bayesian inference framework with a Markov Chain Monte Carlo (MCMC) algorithm.\n\nThe core of their MCMC method, a Metropolis-Hastings sampler, involves proposing a new candidate value for the diffusion coefficient, $D_{new}$, based on the current value in the chain, $D_{current}$. The proposal is drawn from a normal distribution centered at the current value, such that $D_{new} \\sim \\mathcal{N}(D_{current}, \\sigma_{prop}^2)$. The parameter $\\sigma_{prop}$ is the standard deviation of this proposal distribution, often called the proposal width.\n\nThe efficiency of the MCMC simulation is highly sensitive to the choice of $\\sigma_{prop}$. A very small $\\sigma_{prop}$ leads to high acceptance rates but slow exploration of the parameter space, while a very large $\\sigma_{prop}$ leads to most proposals being rejected, causing the chain to get stuck. To find a suitable value, the researcher conducts five short pilot simulations, each using a different $\\sigma_{prop}$. For each simulation, consisting of 10,000 proposed steps, the number of accepted steps is recorded.\n\n| Trial Run | Proposal Width, $\\sigma_{prop}$ (in $\\mu\\text{m}^2/\\text{s}$) | Total Proposals | Accepted Steps |\n| :---: | :---: | :---: | :---: |\n| 1 | 0.001 | 10,000 | 9,850 |\n| 2 | 0.020 | 10,000 | 7,120 |\n| 3 | 0.050 | 10,000 | 4,450 |\n| 4 | 0.200 | 10,000 | 1,510 |\n| 5 | 1.000 | 10,000 | 220 |\n\nFor MCMC sampling of a one-dimensional parameter like $D$, an acceptance rate in the range of 40% to 50% is generally considered optimal for ensuring both sufficient exploration of the parameter space and a reasonable number of accepted steps. Based on this guideline and the data from the trial runs, which of the following proposal widths is the most appropriate for the researcher to use in the main, longer MCMC simulation?\n\nA. 0.001 $\\mu\\text{m}^2/\\text{s}$\n\nB. 0.020 $\\mu\\text{m}^2/\\text{s}$\n\nC. 0.050 $\\mu\\text{m}^2/\\text{s}$\n\nD. 0.200 $\\mu\\text{m}^2/\\text{s}$\n\nE. 1.000 $\\mu\\text{m}^2/\\text{s}$", "solution": "We are to select the proposal width $\\sigma_{prop}$ that yields an acceptance rate within the generally optimal interval for one-dimensional Metropolis-Hastings sampling, which is stated as between $0.40$ and $0.50$.\n\nDefine the acceptance rate for each trial as\n$$\nr \\equiv \\frac{\\text{accepted steps}}{\\text{total proposals}}.\n$$\nUsing the provided data (each with total proposals equal to $10{,}000$), compute:\n- Trial 1: $r_{1} = \\frac{9850}{10000} = 0.985$.\n- Trial 2: $r_{2} = \\frac{7120}{10000} = 0.712$.\n- Trial 3: $r_{3} = \\frac{4450}{10000} = 0.445$.\n- Trial 4: $r_{4} = \\frac{1510}{10000} = 0.151$.\n- Trial 5: $r_{5} = \\frac{220}{10000} = 0.022$.\n\nLet the target interval be\n$$\nI = [0.40, 0.50].\n$$\nWe compare each $r_{k}$ with $I$:\n$$\nr_{1} \\notin I,\\quad r_{2} \\notin I,\\quad r_{3} \\in I,\\quad r_{4} \\notin I,\\quad r_{5} \\notin I.\n$$\nOnly Trial 3, with $\\sigma_{prop} = 0.050\\,\\mu\\text{m}^{2}\\!/\\text{s}$, achieves an acceptance rate within the desired range. Therefore, the most appropriate choice among the options is the proposal width from Trial 3.\n\nThis selection is consistent with the guideline to balance exploration and acceptance in a one-dimensional Metropolis-Hastings sampler.", "answer": "$$\\boxed{C}$$", "id": "1444206"}, {"introduction": "Once an MCMC simulation has successfully generated a posterior distribution, our work is not over; we must critique our model. The posterior predictive check is a powerful method for this, where we ask: 'Could my model, with its inferred parameters, generate data that looks like my actual data?' In this practice, you will use parameter samples from a posterior to simulate new growth curves and compare them against the original observations, providing a direct visual test of your model's adequacy [@problem_id:1444232].", "problem": "A systems biologist is studying the growth dynamics of a bacterial culture. The population size, $N(t)$, measured in thousands of cells, is hypothesized to follow a logistic growth model. The analytical solution to the logistic differential equation is given by:\n$$N(t) = \\frac{K N_0}{N_0 + (K - N_0) \\exp(-rt)}$$\nwhere $t$ is the time in hours, $N_0$ is the initial population size, $r$ is the intrinsic growth rate (in units of $\\text{hour}^{-1}$), and $K$ is the carrying capacity of the environment (in thousands of cells).\n\nThe experiment was started with an initial population of $N_0 = 10$ thousand cells. The population size was measured at several time points, yielding the following experimental data:\n\n| Time, $t$ (hours) | Population, $N(t)$ (thousands of cells) |\n|:-----------------:|:---------------------------------------:|\n| 10                | 70                                      |\n| 20                | 260                                     |\n| 30                | 510                                     |\n| 40                | 580                                     |\n\nTo infer the model parameters $r$ and $K$, the biologist performed a Bayesian analysis using a Markov Chain Monte Carlo (MCMC) algorithm. This process generated a posterior distribution representing the plausible values for $r$ and $K$ given the data. Below are three representative samples drawn from this MCMC posterior distribution:\n\n*   Sample 1: $(r_1, K_1) = (0.19 \\text{ hour}^{-1}, 610 \\text{ thousand cells})$\n*   Sample 2: $(r_2, K_2) = (0.21 \\text{ hour}^{-1}, 590 \\text{ thousand cells})$\n*   Sample 3: $(r_3, K_3) = (0.22 \\text{ hour}^{-1}, 580 \\text{ thousand cells})$\n\nYour task is to perform a posterior predictive check. This involves using the parameter samples from the posterior to simulate new growth curves and comparing them to the original experimental data. Based on your analysis, which of the following statements provides the most accurate assessment of the logistic growth model's adequacy for this dataset?\n\nA. The model provides a good fit. The observed data points are systematically captured within the range of trajectories simulated from the posterior distribution. This indicates that the model is flexible enough to explain the data, and the inferred parameters are consistent with the observations.\nB. The model is systematically biased and thus a poor fit. For instance, at $t=20$ hours, all simulated trajectories predict a population size greater than the observed data point of 260. This consistent discrepancy suggests the model cannot fully replicate the observed dynamics.\nC. The model is overfitting the data. The fact that the trajectory from Sample 1 almost perfectly matches the data points indicates that the MCMC procedure has found a single 'best' solution, ignoring the true uncertainty in the system.\nD. The posterior parameter samples are too varied, making the model non-predictive. The wide spread of the simulated trajectories indicates that the parameters $r$ and $K$ are not well-constrained by the data, and therefore the model cannot be used for reliable predictions.", "solution": "We are given the logistic solution\n$$\nN(t)=\\frac{K N_{0}}{N_{0}+(K-N_{0})\\exp(-r t)},\n$$\nwith $N_{0}=10$. For each posterior sample $(r_{i},K_{i})$, define the predictive trajectory\n$$\nN_{i}(t)=\\frac{K_{i} N_{0}}{N_{0}+(K_{i}-N_{0})\\exp(-r_{i} t)}.\n$$\nWe will compute $N_{i}(t)$ at $t\\in\\{10,20,30,40\\}$ and compare with the observed data $\\{70,260,510,580\\}$.\n\nSample 1: $(r_{1},K_{1})=(0.19,610)$.\nHere $K_{1}-N_{0}=600$ and $K_{1}N_{0}=6100$, so\n$$\nN_{1}(t)=\\frac{6100}{10+600\\exp(-0.19 t)}.\n$$\n- At $t=10$: $\\exp(-0.19\\cdot 10)=\\exp(-1.9)\\approx 0.149568$, denominator $\\approx 10+600\\cdot 0.149568=99.7408$, hence $N_{1}(10)\\approx 6100/99.7408\\approx 61.1$.\n- At $t=20$: $\\exp(-3.8)\\approx 0.022371$, denominator $\\approx 10+600\\cdot 0.022371=23.4226$, hence $N_{1}(20)\\approx 6100/23.4226\\approx 260.3$.\n- At $t=30$: $\\exp(-5.7)\\approx 0.003331$, denominator $\\approx 10+600\\cdot 0.003331=11.9986$, hence $N_{1}(30)\\approx 6100/11.9986\\approx 508.4$.\n- At $t=40$: $\\exp(-7.6)\\approx 0.000498$, denominator $\\approx 10+600\\cdot 0.000498=10.2988$, hence $N_{1}(40)\\approx 6100/10.2988\\approx 592.8$.\n\nSample 2: $(r_{2},K_{2})=(0.21,590)$.\nHere $K_{2}-N_{0}=580$ and $K_{2}N_{0}=5900$, so\n$$\nN_{2}(t)=\\frac{5900}{10+580\\exp(-0.21 t)}.\n$$\n- At $t=10$: $\\exp(-2.1)\\approx 0.122456$, denominator $\\approx 10+580\\cdot 0.122456=81.024$, hence $N_{2}(10)\\approx 5900/81.024\\approx 72.8$.\n- At $t=20$: $\\exp(-4.2)\\approx 0.014996$, denominator $\\approx 10+580\\cdot 0.014996=18.6977$, hence $N_{2}(20)\\approx 5900/18.6977\\approx 315.6$.\n- At $t=30$: $\\exp(-6.3)\\approx 0.001829$, denominator $\\approx 10+580\\cdot 0.001829=11.0608$, hence $N_{2}(30)\\approx 5900/11.0608\\approx 533.5$.\n- At $t=40$: $\\exp(-8.4)\\approx 0.000225$, denominator $\\approx 10+580\\cdot 0.000225=10.1305$, hence $N_{2}(40)\\approx 5900/10.1305\\approx 582.3$.\n\nSample 3: $(r_{3},K_{3})=(0.22,580)$.\nHere $K_{3}-N_{0}=570$ and $K_{3}N_{0}=5800$, so\n$$\nN_{3}(t)=\\frac{5800}{10+570\\exp(-0.22 t)}.\n$$\n- At $t=10$: $\\exp(-2.2)\\approx 0.110803$, denominator $\\approx 10+570\\cdot 0.110803=73.1577$, hence $N_{3}(10)\\approx 5800/73.1577\\approx 79.3$.\n- At $t=20$: $\\exp(-4.4)\\approx 0.012277$, denominator $\\approx 10+570\\cdot 0.012277=17.000$, hence $N_{3}(20)\\approx 5800/17.000\\approx 341.2$.\n- At $t=30$: $\\exp(-6.6)\\approx 0.001365$, denominator $\\approx 10+570\\cdot 0.001365=10.778$, hence $N_{3}(30)\\approx 5800/10.778\\approx 538.1$.\n- At $t=40$: $\\exp(-8.8)\\approx 0.000151$, denominator $\\approx 10+570\\cdot 0.000151=10.0859$, hence $N_{3}(40)\\approx 5800/10.0859\\approx 575.1$.\n\nComparison to observed data $(70,260,510,580)$ at $(10,20,30,40)$ hours:\n- At $t=10$: predictions are approximately $61.1$, $72.8$, $79.3$; the observed $70$ lies within this range.\n- At $t=20$: predictions are approximately $260.3$, $315.6$, $341.2$; the observed $260$ is at the lower edge, effectively within the range.\n- At $t=30$: predictions are approximately $508.4$, $533.5$, $538.1$; the observed $510$ lies within this range.\n- At $t=40$: predictions are approximately $592.8$, $582.3$, $575.1$; the observed $580$ lies within this range.\n\nTherefore, the posterior predictive trajectories based on the provided samples form an envelope that contains the observed data points across all time points. This supports the conclusion that the logistic model is adequate and captures the observed dynamics without systematic bias, without overfitting, and with a reasonably constrained posterior. Among the given statements, this corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "1444232"}]}