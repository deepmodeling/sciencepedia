{"hands_on_practices": [{"introduction": "The foundation of the Stochastic Simulation Algorithm (SSA) lies in the concept of the reaction propensity, which represents the instantaneous probability rate of a specific reaction occurring. This first exercise provides a concrete starting point for understanding this core idea. By calculating the total propensity for a simple gene expression model involving mRNA production and degradation, you will practice computing the essential quantity that determines how long the system will wait before the next event happens [@problem_id:1468248].", "problem": "Consider a simplified stochastic model for the expression of a single gene within a cell. The model focuses on the number of molecules of a specific messenger RNA (mRNA), denoted by $M$. Two reactions govern the dynamics of the mRNA population:\n\n1.  **Transcription**: An mRNA molecule is produced. This is a zeroth-order reaction of the form $\\emptyset \\rightarrow M$, which occurs with a constant propensity.\n2.  **Degradation**: An existing mRNA molecule is degraded. This is a first-order reaction of the form $M \\rightarrow \\emptyset$, with a stochastic rate constant.\n\nThe propensity of a reaction represents its instantaneous probability rate. At a particular moment, the state of the system is defined by the number of mRNA molecules, $n_M$.\n\nGiven the following parameters:\n- Constant production propensity: $k_p = 10.5 \\text{ s}^{-1}$\n- Degradation rate constant: $k_d = 0.12 \\text{ s}^{-1}$\n- Current number of mRNA molecules: $n_M = 150$\n\nCalculate the total propensity, $a_0$, of the system at this moment. The total propensity is a key quantity in stochastic simulation algorithms as it determines the time until the next reaction event. Express your answer in units of $\\text{s}^{-1}$, rounded to three significant figures.", "solution": "In the stochastic chemical kinetics framework (Gillespie), the propensity of each reaction is the instantaneous rate at which it occurs given the current state.\n\n- For the zeroth-order transcription reaction $\\emptyset \\rightarrow M$, the propensity is constant:\n$$\na_{\\text{prod}} = k_{p}.\n$$\n\n- For the first-order degradation reaction $M \\rightarrow \\emptyset$, the propensity is proportional to the current molecule count:\n$$\na_{\\text{deg}} = k_{d}\\, n_{M}.\n$$\n\nThe total propensity is the sum of all reaction propensities:\n$$\na_{0} = a_{\\text{prod}} + a_{\\text{deg}} = k_{p} + k_{d}\\, n_{M}.\n$$\n\nSubstituting the given values $k_{p} = 10.5\\,\\text{s}^{-1}$, $k_{d} = 0.12\\,\\text{s}^{-1}$, and $n_{M} = 150$, we obtain\n$$\na_{0} = 10.5 + 0.12 \\times 150 = 10.5 + 18.0 = 28.5.\n$$\n\nThus, the total propensity is $28.5\\,\\text{s}^{-1}$, which to three significant figures is $28.5$.", "answer": "$$\\boxed{28.5}$$", "id": "1468248"}, {"introduction": "Once we know when the next reaction will occur, we must determine which one it will be. This practice explores the second key principle of the SSA: reaction selection. In a scenario with two competing enzymes catalyzing the same type of modification, you will see how the individual propensity of a reaction, relative to the total propensity, directly translates into the probability of that reaction being chosen as the next event in the system's evolution [@problem_id:1468285].", "problem": "A cell contains a signaling protein $P$ that can be activated through phosphorylation. This phosphorylation can be catalyzed by two distinct enzymes, Kinase A ($K_A$) and Kinase B ($K_B$). The system is well-mixed and can be modeled by the following two elementary chemical reactions:\n\n1.  $P + K_A \\xrightarrow{c_A} P^* + K_A$\n2.  $P + K_B \\xrightarrow{c_B} P^* + K_B$\n\nHere, $P^*$ represents the phosphorylated (active) form of the protein. The reactions proceed with second-order rate constants $c_A$ and $c_B$, respectively. These constants encapsulate information about the reaction rate per pair of reactant molecules.\n\nAt a particular instant, the system contains $n_P$ molecules of the substrate protein $P$, $n_A$ molecules of Kinase A, and $n_B$ molecules of Kinase B.\n\nAssuming a stochastic description of these reactions, determine the probability that the very next reaction to occur in the system is the phosphorylation of a molecule of $P$ by a molecule of $K_A$. Express your answer as a symbolic expression in terms of $c_A$, $c_B$, $n_A$, and $n_B$.", "solution": "We adopt the stochastic chemical kinetics (Gillespie) framework. For an elementary bimolecular reaction between two distinct species $X$ and $Y$ with second-order rate constant $c$, the propensity function is the product of $c$ and the number of distinct reactant pairs, which is $n_{X}n_{Y}$. Therefore, the propensities of the two reaction channels are\n$$\na_{A}=c_{A}\\,n_{P}\\,n_{A},\\qquad a_{B}=c_{B}\\,n_{P}\\,n_{B}.\n$$\nThe total propensity is\n$$\na_{0}=a_{A}+a_{B}=c_{A}\\,n_{P}\\,n_{A}+c_{B}\\,n_{P}\\,n_{B}.\n$$\nBy the Gillespie theory, the probability that the next reaction to occur is a given channel equals that channelâ€™s propensity divided by the total propensity. Hence, the probability that the next reaction is phosphorylation by $K_{A}$ is\n$$\n\\frac{a_{A}}{a_{0}}=\\frac{c_{A}\\,n_{P}\\,n_{A}}{c_{A}\\,n_{P}\\,n_{A}+c_{B}\\,n_{P}\\,n_{B}}.\n$$\nFactoring out $n_{P}$ from numerator and denominator (assuming $n_{P}>0$ so that a reaction can occur) yields\n$$\n\\frac{c_{A}\\,n_{A}}{c_{A}\\,n_{A}+c_{B}\\,n_{B}}.\n$$\nThis expression depends only on $c_{A}$, $c_{B}$, $n_{A}$, and $n_{B}$, as required.", "answer": "$$\\boxed{\\frac{c_{A}n_{A}}{c_{A}n_{A}+c_{B}n_{B}}}$$", "id": "1468285"}, {"introduction": "This final practice moves from the mechanics of the algorithm to its powerful application in revealing complex biological phenomena. By analyzing the collected results from thousands of independent simulations of a gene regulatory circuit, you will learn to interpret statistical patterns that emerge from stochasticity. The tell-tale bimodal distribution observed in this hypothetical scenario is a classic signature of bistability, a critical systems-level property where a network can exist in one of two distinct stable states [@problem_id:1468228].", "problem": "A computational biologist is studying a simple model of a genetic switch. In this model, a single gene can exist in either an inactive state, $G_{off}$, or an active state, $G_{on}$. When the gene is in the active state, it produces a protein, $P$. This protein acts as a transcription factor that promotes its own production by binding to the gene's promoter region and facilitating the switch from the inactive to the active state. The protein $P$ also degrades over time. The system is described by the following set of reactions:\n\n1.  $G_{off} \\xrightarrow{k_{on}} G_{on}$ (Basal activation)\n2.  $G_{on} \\xrightarrow{k_{off}} G_{off}$ (Inactivation)\n3.  $G_{on} \\xrightarrow{k_{p}} G_{on} + P$ (Protein synthesis)\n4.  $P \\xrightarrow{\\gamma} \\emptyset$ (Protein degradation)\n5.  $G_{off} + 2P \\xrightarrow{k_{fb}} G_{on} + 2P$ (Cooperative positive feedback activation)\n\nTo understand the system's long-term behavior, the biologist performs a computer simulation using a stochastic algorithm. The simulation is initialized with the gene in the $G_{off}$ state and zero molecules of protein $P$. A total of 10,000 independent simulation runs are executed. Each run is simulated for a sufficiently long time to ensure the system reaches a statistical steady state.\n\nAt the final time point of each of the 10,000 runs, the number of molecules of protein $P$ is recorded. When a histogram is plotted using these 10,000 data points, a striking feature is observed: the distribution is not a single bell-shaped curve. Instead, it shows two distinct and well-separated peaks. One peak is centered at a very low number of $P$ molecules, while the other is centered at a much higher number of $P$ molecules. There are very few simulation runs that result in a number of molecules that falls in the region between these two peaks.\n\nBased on this observation from the stochastic simulations, what is the most likely conclusion about the steady-state behavior of this gene regulatory network?\n\nA. The system exhibits bistability, meaning it has two distinct stable steady states: one with a low protein count and one with a high protein count. The histogram reflects the probability of finding the system in the vicinity of either of these states.\n\nB. The simulations were not run for a long enough time. If the simulations were extended, the two peaks would eventually merge into a single peak, representing the true, unique steady state of the system.\n\nC. The two peaks are an artifact of simulation noise. A more accurate simulation method would eliminate this noise and reveal a single, well-defined steady-state value for the protein count.\n\nD. The deterministic model of the system, based on ordinary differential equations, must be incorrect, as it can only predict a single value for the steady-state protein concentration.\n\nE. The emergence of two peaks is a direct consequence of the initial conditions. To observe a single steady state, the simulations should have been initialized with an average number of protein molecules, rather than zero.", "solution": "We analyze the qualitative steady-state behavior implied by the reactions and the stochastic observation. The network contains cooperative positive feedback via $G_{off}+2P \\xrightarrow{k_{fb}} G_{on}+2P$, which yields an activation rate that increases with $P$ in a nonlinear, sigmoidal fashion. This is a canonical mechanism for bistability.\n\nTo formalize this, consider deterministic mean-field equations for the average protein level and promoter activity. Let $p(t)$ denote the mean protein abundance and let $g(t)$ be the probability (or fraction of a large cell population) that the gene is in the active state $G_{on}$. The gene switching rates are:\n- Activation rate from $G_{off}$ to $G_{on}$: $a(p)$, which includes basal activation and positive feedback. With cooperativity of order $2$, $a(p)$ is an increasing function of $p$ that grows approximately as a Hill function with coefficient $2$. A convenient parametrization is\n$$\na(p)=k_{on}+k_{fb}\\,h(p),\n$$\nwhere $h(p)$ is an increasing function of $p$ with $h(0)=0$ and $h(p)\\sim p^{2}$ for moderate $p$ (e.g., $h(p)=\\frac{p^{2}}{K^{2}+p^{2}}$ up to a multiplicative factor), and the inactivation rate is $k_{off}$.\n- Promoter occupancy dynamics obey\n$$\n\\frac{dg}{dt}=a(p)\\,(1-g)-k_{off}\\,g.\n$$\nAt quasi-steady state of the fast promoter (or exactly at steady state),\n$$\ng^{*}(p)=\\frac{a(p)}{a(p)+k_{off}}=\\frac{k_{on}+k_{fb}\\,h(p)}{k_{on}+k_{off}+k_{fb}\\,h(p)}.\n$$\n\nProtein dynamics follow from synthesis in the active state and degradation:\n$$\n\\frac{dp}{dt}=k_{p}\\,g(t)-\\gamma\\,p.\n$$\nAt steady state, substituting $g^{*}(p)$ gives the fixed-point condition\n$$\np^{*}=\\frac{k_{p}}{\\gamma}\\,g^{*}(p^{*})=\\frac{k_{p}}{\\gamma}\\,\\frac{k_{on}+k_{fb}\\,h(p^{*})}{k_{on}+k_{off}+k_{fb}\\,h(p^{*})}.\n$$\nBecause $h(p)$ is sigmoidal with effective Hill coefficient $2$, the right-hand side is an increasing, saturating, sigmoidal function of $p^{*}$. Graphically, the intersections of this curve with the identity line $p^{*}$ can be one or three. For sufficiently strong feedback (large $k_{fb}$ relative to $k_{off}$ and with suitable $k_{p}/\\gamma$ and $K$), there are three intersections: two stable fixed points $p^{*}_{low}$ and $p^{*}_{high}$ separated by one unstable fixed point $p^{*}_{mid}$. Stability follows from the sign of the derivative of the net production minus degradation,\n$$\nf(p)=k_{p}\\,g^{*}(p)-\\gamma p,\\quad f'(p^{*})0 \\text{ for stability},\n$$\nand sigmoidal $g^{*}(p)$ typically yields $f'(p^{*}_{low})0$, $f'(p^{*}_{mid})>0$, and $f'(p^{*}_{high})0$.\n\nIn the stochastic setting, the stationary distribution $P_{ss}(p)$ concentrates near stable fixed points and is suppressed near unstable points. More formally, in a weak-noise approximation one can write $P_{ss}(p)\\propto \\exp(-U(p)/\\epsilon)$, where $U(p)$ is an effective potential with minima at the stable fixed points; this produces a bimodal distribution with two peaks near $p^{*}_{low}$ and $p^{*}_{high}$ and a valley near $p^{*}_{mid}$. The observed histogram with two well-separated peaks and very few samples in between is precisely the hallmark of bistability.\n\nWe now assess the options:\n- A: Consistent with the above analysis; cooperative positive feedback supports two stable steady states, and the stochastic steady state is bimodal across the two basins of attraction. This matches the observed two peaks.\n- B: If there were a unique steady state, the stationary distribution would be unimodal; increasing simulation time does not merge two genuine peaks into one at stationarity. Thus this is not supported.\n- C: Simulation noise broadens distributions but does not robustly create two distinct, well-separated peaks systematically across 10,000 long runs. The bimodality reflects underlying dynamics, not a numerical artifact.\n- D: Deterministic ODE models with positive feedback and cooperativity can exhibit multiple steady states; claiming they can only predict a single steady state is incorrect.\n- E: The stationary distribution at long times is independent of initial conditions. Starting from zero does not explain persistent bimodality at steady state.\n\nTherefore, the most likely conclusion is bistability as stated in option A.", "answer": "$$\\boxed{A}$$", "id": "1468228"}]}