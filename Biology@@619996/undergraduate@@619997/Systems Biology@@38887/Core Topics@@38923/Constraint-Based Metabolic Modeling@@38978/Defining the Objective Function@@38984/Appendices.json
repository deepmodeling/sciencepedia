{"hands_on_practices": [{"introduction": "To predict how a cell might behave, we first need to mathematically define its primary goal, which for many microorganisms is to grow and divide. This exercise guides you through the fundamental process of constructing a \"biomass objective function,\" a cornerstone of metabolic modeling representing the complete recipe of biochemical precursors needed to create new cell mass [@problem_id:2038523]. Mastering this calculation allows you to translate biological composition into a quantifiable objective for computational analysis like Flux Balance Analysis (FBA).", "problem": "In the field of synthetic biology, Flux Balance Analysis (FBA) is a powerful computational method used to predict metabolic flux distributions in a genome-scale model of an organism. A critical component of FBA is the \"biomass objective function,\" a pseudo-reaction that represents the stoichiometric requirements for synthesizing all cellular components to produce 1 gram of dry weight (gDW).\n\nConsider a hypothetical microorganism, *Artificium aedificator*, whose biomass has been simplified for modeling purposes. The dry weight of this organism is composed of three classes of macromolecules: Structurin (S), Energin (E), and Informatin (I). The composition of 1 gram of its dry weight is as follows:\n- 0.600 g of Structurin (S)\n- 0.300 g of Energin (E)\n- 0.100 g of Informatin (I)\n\nThese macromolecules are synthesized from three precursor metabolites: a generic Amino Acid (AA), a generic Nucleotide (NT), and a generic Fatty Acid (FA). The synthesis reactions for the macromolecules are given by the following stoichiometries:\n- Synthesis of Structurin: $8 \\text{ AA} + 2 \\text{ FA} \\longrightarrow 1 \\text{ S}$\n- Synthesis of Energin: $10 \\text{ FA} \\longrightarrow 1 \\text{ E}$\n- Synthesis of Informatin: $12 \\text{ NT} \\longrightarrow 1 \\text{ I}$\n\nThe molar masses of the precursors and macromolecules have been determined as:\n- Molar Mass of AA: $0.110 \\text{ g/mmol}$\n- Molar Mass of NT: $0.330 \\text{ g/mmol}$\n- Molar Mass of FA: $0.280 \\text{ g/mmol}$\n- Molar Mass of S: $1.440 \\text{ g/mmol}$\n- Molar Mass of E: $2.800 \\text{ g/mmol}$\n- Molar Mass of I: $3.960 \\text{ g/mmol}$\n\nWhich of the following stoichiometric equations correctly represents the biomass objective function for producing 1 gram of dry weight (gDW) of *A. aedificator*?\n\nA. $\\frac{10}{3} \\text{ AA} + \\frac{10}{33} \\text{ NT} + \\frac{40}{21} \\text{ FA} \\longrightarrow 1 \\text{ gDW}$\n\nB. $\\frac{24}{5} \\text{ AA} + \\frac{6}{5} \\text{ NT} + \\frac{21}{5} \\text{ FA} \\longrightarrow 1 \\text{ gDW}$\n\nC. $8 \\text{ AA} + 12 \\text{ NT} + 12 \\text{ FA} \\longrightarrow 1 \\text{ gDW}$\n\nD. $\\frac{10}{3} \\text{ AA} + \\frac{10}{33} \\text{ NT} + \\frac{92}{21} \\text{ FA} \\longrightarrow 1 \\text{ gDW}$", "solution": "Goal: Derive the biomass objective function coefficients (in mmol per gDW) for AA, NT, and FA such that their combination produces exactly 1 gDW of biomass composed of 0.600 g S, 0.300 g E, and 0.100 g I, consistent with macromolecule synthesis stoichiometries and molar masses.\n\n1) Convert macromolecular mass fractions to moles (mmol) using $n = \\frac{m}{M}$ with given masses (in g) and molar masses (in g/mmol):\n$$\nn_{S} = \\frac{0.600}{1.440} = \\frac{600}{1440} = \\frac{5}{12} \\text{ mmol},\\quad\nn_{E} = \\frac{0.300}{2.800} = \\frac{300}{2800} = \\frac{3}{28} \\text{ mmol},\\quad\nn_{I} = \\frac{0.100}{3.960} = \\frac{100}{3960} = \\frac{5}{198} \\text{ mmol}.\n$$\n\n2) Use synthesis stoichiometries to compute precursor requirements per 1 gDW:\n- Structurin: $8\\,\\text{AA} + 2\\,\\text{FA} \\longrightarrow 1\\,\\text{S}$. For $n_{S} = \\frac{5}{12}$ mmol S:\n$$\n\\text{AA from S}: 8\\,n_{S} = 8 \\cdot \\frac{5}{12} = \\frac{10}{3} \\text{ mmol},\\quad\n\\text{FA from S}: 2\\,n_{S} = 2 \\cdot \\frac{5}{12} = \\frac{5}{6} \\text{ mmol}.\n$$\n- Energin: $10\\,\\text{FA} \\longrightarrow 1\\,\\text{E}$. For $n_{E} = \\frac{3}{28}$ mmol E:\n$$\n\\text{FA from E}: 10\\,n_{E} = 10 \\cdot \\frac{3}{28} = \\frac{15}{14} \\text{ mmol}.\n$$\n- Informatin: $12\\,\\text{NT} \\longrightarrow 1\\,\\text{I}$. For $n_{I} = \\frac{5}{198}$ mmol I:\n$$\n\\text{NT from I}: 12\\,n_{I} = 12 \\cdot \\frac{5}{198} = \\frac{60}{198} = \\frac{10}{33} \\text{ mmol}.\n$$\n\n3) Sum precursor demands across macromolecules:\n$$\nn_{\\text{AA}} = \\frac{10}{3},\\quad\nn_{\\text{NT}} = \\frac{10}{33},\\quad\nn_{\\text{FA}} = \\frac{5}{6} + \\frac{15}{14} = \\frac{35}{42} + \\frac{45}{42} = \\frac{80}{42} = \\frac{40}{21}.\n$$\n\n4) Biomass objective function (per 1 gDW) therefore is:\n$$\n\\frac{10}{3}\\,\\text{AA} + \\frac{10}{33}\\,\\text{NT} + \\frac{40}{21}\\,\\text{FA} \\longrightarrow 1\\,\\text{gDW}.\n$$\n\n5) Mass consistency check using precursor molar masses $M_{\\text{AA}} = 0.110$, $M_{\\text{NT}} = 0.330$, $M_{\\text{FA}} = 0.280$ g/mmol:\n$$\nm_{\\text{AA}} = \\frac{10}{3} \\cdot 0.110 = \\frac{1.1}{3} \\text{ g},\\quad\nm_{\\text{NT}} = \\frac{10}{33} \\cdot 0.330 = \\frac{3.3}{33} = 0.100 \\text{ g},\\quad\nm_{\\text{FA}} = \\frac{40}{21} \\cdot 0.280 = \\frac{11.2}{21} \\text{ g}.\n$$\nSumming gives\n$$\n\\frac{1.1}{3} + 0.100 + \\frac{11.2}{21} = 0.366\\overline{6} + 0.100 + 0.533\\overline{3} = 1.000 \\text{ g},\n$$\nconfirming the correct 1 gDW. This matches option A.", "answer": "$$\\boxed{A}$$", "id": "2038523"}, {"introduction": "A key task in systems biology is to create models that accurately reflect reality, but how do we measure accuracy? We need an objective function that quantifies the mismatch between a model's predictions and experimental data. This practice demonstrates how to calculate the weighted sum of squared errors, a standard method for evaluating a model's \"goodness-of-fit\" by properly combining data from different types of experiments into a single, comprehensive score [@problem_id:1427249].", "problem": "A systems biologist is developing a mathematical model for a cellular signaling pathway. In this pathway, an external signal triggers the phosphorylation of a protein, let's call it `P`. The phosphorylated form of this protein, `pP`, then acts as a transcription factor to increase the expression of a specific gene, `G`. The model, described by a set of parameters $\\theta$, aims to predict the concentration of `pP` and the relative abundance of mRNA from gene `G` over time.\n\nTo validate the model and find the best parameters, the biologist has collected two different types of experimental data:\n1.  **Phosphoproteomics Data**: Measurements of the concentration of `pP`.\n    -   At time $t_1 = 10 \\text{ min}$, the measured concentration of `pP` is $45.2 \\text{ nM}$, with a measurement standard deviation of $\\sigma_1 = 3.5 \\text{ nM}$.\n    -   At time $t_2 = 20 \\text{ min}$, the measured concentration of `pP` is $88.9 \\text{ nM}$, with a measurement standard deviation of $\\sigma_2 = 6.1 \\text{ nM}$.\n2.  **Gene Expression Data**: Measurements of the relative abundance of mRNA from gene `G` using Quantitative Polymerase Chain Reaction (qPCR).\n    -   At time $t_3 = 60 \\text{ min}$, the measured relative abundance of `G`-mRNA is $8.2$ units, with a measurement standard deviation of $\\sigma_3 = 0.7$ units.\n\nThe biologist is testing a specific parameter set, $\\theta_0$. With this set of parameters, the model gives the following predictions:\n-   Predicted `pP` concentration at $t_1 = 10 \\text{ min}$ is $41.8 \\text{ nM}$.\n-   Predicted `pP` concentration at $t_2 = 20 \\text{ min}$ is $95.3 \\text{ nM}$.\n-   Predicted `G`-mRNA relative abundance at $t_3 = 60 \\text{ min}$ is $9.4$ units.\n\nTo quantify how well the parameter set $\\theta_0$ explains the data, you need to calculate an objective function. Calculate the value of the total weighted sum of squared errors between the experimental data and the model's predictions. Assume the standard statistical practice where the weight for each squared error term is the inverse of the variance of the corresponding experimental measurement. The final answer is a dimensionless quantity. Round your final answer to three significant figures.", "solution": "The goal is to compute the value of an objective function, specifically the weighted sum of squared errors (often denoted as $\\chi^2$), which quantifies the discrepancy between experimental measurements and model predictions for a given set of parameters.\n\nThe general formula for the weighted sum of squared errors is:\n$$ \\chi^2 = \\sum_{i=1}^{N} w_i (y_i^{\\text{exp}} - y_i^{\\text{model}})^2 $$\nwhere $N$ is the total number of data points, $y_i^{\\text{exp}}$ is the $i$-th experimental measurement, $y_i^{\\text{model}}$ is the corresponding model prediction, and $w_i$ is the weight for the $i$-th data point.\n\nThe problem states that the weight for each term is the inverse of the variance of the corresponding measurement. The variance, $\\sigma_i^2$, is the square of the standard deviation, $\\sigma_i$. Therefore, the weight $w_i$ is given by $w_i = \\frac{1}{\\sigma_i^2}$.\n\nSubstituting this into the general formula gives the specific objective function to be calculated:\n$$ \\chi^2 = \\sum_{i=1}^{N} \\frac{(y_i^{\\text{exp}} - y_i^{\\text{model}})^2}{\\sigma_i^2} $$\n\nWe have three experimental data points, so $N=3$. Let's identify the values for each data point from the problem statement.\n\n**Data Point 1: `pP` concentration at $t_1 = 10$ min**\n-   Experimental measurement: $y_1^{\\text{exp}} = 45.2 \\text{ nM}$\n-   Model prediction: $y_1^{\\text{model}} = 41.8 \\text{ nM}$\n-   Standard deviation: $\\sigma_1 = 3.5 \\text{ nM}$\n\n**Data Point 2: `pP` concentration at $t_2 = 20$ min**\n-   Experimental measurement: $y_2^{\\text{exp}} = 88.9 \\text{ nM}$\n-   Model prediction: $y_2^{\\text{model}} = 95.3 \\text{ nM}$\n-   Standard deviation: $\\sigma_2 = 6.1 \\text{ nM}$\n\n**Data Point 3: `G`-mRNA abundance at $t_3 = 60$ min**\n-   Experimental measurement: $y_3^{\\text{exp}} = 8.2 \\text{ units}$\n-   Model prediction: $y_3^{\\text{model}} = 9.4 \\text{ units}$\n-   Standard deviation: $\\sigma_3 = 0.7 \\text{ units}$\n\nNow we can calculate the contribution of each data point to the total $\\chi^2$ value.\n\n**Term 1:**\n$$ \\frac{(y_1^{\\text{exp}} - y_1^{\\text{model}})^2}{\\sigma_1^2} = \\frac{(45.2 - 41.8)^2}{(3.5)^2} = \\frac{(3.4)^2}{12.25} = \\frac{11.56}{12.25} \\approx 0.943673 $$\n\n**Term 2:**\n$$ \\frac{(y_2^{\\text{exp}} - y_2^{\\text{model}})^2}{\\sigma_2^2} = \\frac{(88.9 - 95.3)^2}{(6.1)^2} = \\frac{(-6.4)^2}{37.21} = \\frac{40.96}{37.21} \\approx 1.099435 $$\n\n**Term 3:**\n$$ \\frac{(y_3^{\\text{exp}} - y_3^{\\text{model}})^2}{\\sigma_3^2} = \\frac{(8.2 - 9.4)^2}{(0.7)^2} = \\frac{(-1.2)^2}{0.49} = \\frac{1.44}{0.49} \\approx 2.938775 $$\n\nThe total weighted sum of squared errors is the sum of these three terms:\n$$ \\chi^2 = 0.943673 + 1.099435 + 2.938775 = 4.981883 $$\n\nThe problem asks for the answer to be rounded to three significant figures.\nThe calculated value is $4.981883$. The first three significant figures are 4, 9, and 8. The next digit is 1, which is less than 5, so we round down.\n\nTherefore, the final answer is $4.98$.", "answer": "$$\\boxed{4.98}$$", "id": "1427249"}, {"introduction": "Objective functions are not just for describing what a system does, but for determining how to make it do what we want. In bio-engineering and ecology, a common goal is to maximize the yield from a biological population, whether it's a protein from a bioreactor or fish from a lake. This problem challenges you to derive the objective function for total yield in a dynamic system, a crucial step before any optimization can be performed, bridging the gap between a dynamic model and a practical optimization goal [@problem_id:1427311].", "problem": "A bio-engineering team is designing an optimized batch fermentation process for producing a recombinant protein using a strain of genetically engineered yeast. The growth of the yeast population inside the bioreactor can be modeled by logistic dynamics.\n\nThe biomass concentration, denoted by $X(t)$ in units of grams per liter (g/L), as a function of time $t$ in hours (h), is described by the differential equation:\n$$\n\\frac{dX}{dt} = \\mu X(t) \\left(1 - \\frac{X(t)}{K}\\right)\n$$\nwhere $\\mu$ is the maximum specific growth rate (in $h^{-1}$) and $K$ is the carrying capacity of the bioreactor environment (in g/L).\n\nTo collect the protein product, the team implements a continuous harvesting strategy. Culture is removed from the reactor at a rate, $H(t)$, that is directly proportional to the current biomass concentration:\n$$\nH(t) = h X(t)\n$$\nHere, $h$ is the constant harvesting effort coefficient (in $h^{-1}$). The bioreactor is operated for a fixed time period of $T$ hours, starting with an initial biomass concentration of $X(0) = X_0$.\n\nFor the next stage of optimization, which involves finding the value of $h$ that maximizes the total yield, the team first needs a mathematical model of the process outcome. Your task is to derive the objective function for this optimization problem. Specifically, derive a closed-form analytical expression for the total harvested biomass, $Y$, over the entire operational period from $t=0$ to $t=T$. This expression should be a function of the harvesting effort coefficient $h$ and the known system parameters $\\mu, K, T,$ and $X_0$. For your derivation, assume that the growth rate always exceeds the harvesting effort, i.e., $\\mu > h > 0$.", "solution": "The biomass grows logistically and is continuously harvested proportionally to its current concentration. Therefore, the biomass concentration inside the reactor satisfies the logistic growth with proportional harvesting:\n$$\n\\frac{dX}{dt}=\\mu X\\left(1-\\frac{X}{K}\\right)-hX=(\\mu-h)X-\\frac{\\mu}{K}X^{2}.\n$$\nDefine the positive constants $r\\equiv\\mu-h$ and $a\\equiv\\mu/K$. The differential equation becomes\n$$\n\\frac{dX}{dt}=rX-aX^{2}.\n$$\nSeparate variables and use partial fractions:\n$$\n\\int\\frac{dX}{X(r-aX)}=\\int dt,\n$$\n$$\n\\frac{1}{X(r-aX)}=\\frac{A}{X}+\\frac{B}{r-aX},\\quad 1=A(r-aX)+BX.\n$$\nMatching coefficients gives $Ar=1$ and $B=Aa$, hence $A=\\frac{1}{r}$ and $B=\\frac{a}{r}$. Thus,\n$$\n\\int\\left(\\frac{1}{r}\\frac{1}{X}+\\frac{a}{r}\\frac{1}{r-aX}\\right)dX=\\int dt,\n$$\n$$\n\\frac{1}{r}\\ln X-\\frac{1}{r}\\ln(r-aX)=t+C,\n$$\nwhere $\\int\\frac{1}{r-aX}\\,dX=-\\frac{1}{a}\\ln(r-aX)$ was used. Combine the logarithms and exponentiate:\n$$\n\\frac{1}{r}\\ln\\!\\left(\\frac{X}{r-aX}\\right)=t+C\\;\\;\\Longrightarrow\\;\\;\\frac{X}{r-aX}=C_{1}\\exp(rt).\n$$\nSolve for $X(t)$:\n$$\nX=C_{1}r\\exp(rt)-C_{1}a\\exp(rt)X\\;\\;\\Longrightarrow\\;\\;X\\bigl(1+C_{1}a\\exp(rt)\\bigr)=C_{1}r\\exp(rt),\n$$\n$$\nX(t)=\\frac{C_{1}r\\exp(rt)}{1+C_{1}a\\exp(rt)}=\\frac{r/a}{1+C\\exp(-rt)},\n$$\nwhere $C\\equiv\\frac{1}{C_{1}a}$. Impose the initial condition $X(0)=X_{0}$:\n$$\nX_{0}=\\frac{r/a}{1+C}\\;\\;\\Longrightarrow\\;\\;C=\\frac{r}{aX_{0}}-1=\\frac{K_{\\text{eff}}}{X_{0}}-1,\n$$\nwith the effective carrying capacity $K_{\\text{eff}}\\equiv\\frac{r}{a}=\\frac{(\\mu-h)K}{\\mu}$. Hence\n$$\nX(t)=\\frac{K_{\\text{eff}}}{1+\\left(\\frac{K_{\\text{eff}}-X_{0}}{X_{0}}\\right)\\exp(-rt)}.\n$$\nThe total harvested biomass over $[0,T]$ is\n$$\nY=\\int_{0}^{T}H(t)\\,dt=\\int_{0}^{T}hX(t)\\,dt=h\\frac{r}{a}\\int_{0}^{T}\\frac{dt}{1+C\\exp(-rt)}.\n$$\nEvaluate the integral by writing $\\frac{1}{1+C\\exp(-rt)}=\\frac{\\exp(rt)}{\\exp(rt)+C}$ and substituting $y=\\exp(rt)$, so $dy=r\\exp(rt)\\,dt$ and $dt=\\frac{dy}{ry}$:\n$$\n\\int_{0}^{T}\\frac{dt}{1+C\\exp(-rt)}=\\int_{0}^{T}\\frac{\\exp(rt)}{\\exp(rt)+C}\\,dt=\\frac{1}{r}\\int_{y=1}^{y=\\exp(rT)}\\frac{1}{y+C}\\,dy\n=\\frac{1}{r}\\left[\\ln(y+C)\\right]_{1}^{\\exp(rT)}=\\frac{1}{r}\\left(\\ln\\bigl(\\exp(rT)+C\\bigr)-\\ln(1+C)\\right).\n$$\nTherefore,\n$$\nY=h\\frac{r}{a}\\cdot\\frac{1}{r}\\left(\\ln\\bigl(\\exp(rT)+C\\bigr)-\\ln(1+C)\\right)=\\frac{h}{a}\\left(\\ln\\bigl(\\exp(rT)+C\\bigr)-\\ln(1+C)\\right).\n$$\nUse $a=\\mu/K$, $r=\\mu-h$, and $C=\\frac{K_{\\text{eff}}-X_{0}}{X_{0}}$ with $K_{\\text{eff}}=\\frac{(\\mu-h)K}{\\mu}$. Then $1+C=\\frac{K_{\\text{eff}}}{X_{0}}$ and\n$$\n\\ln\\bigl(\\exp(rT)+C\\bigr)-\\ln(1+C)=\\ln\\left(\\frac{X_{0}\\exp(rT)+K_{\\text{eff}}-X_{0}}{K_{\\text{eff}}}\\right)\n=\\ln\\left(1+\\frac{X_{0}\\bigl(\\exp(rT)-1\\bigr)}{K_{\\text{eff}}}\\right).\n$$\nSubstitute $K_{\\text{eff}}=\\frac{rK}{\\mu}$ and $a=\\mu/K$ to obtain\n$$\nY=\\frac{hK}{\\mu}\\ln\\left(1+\\frac{\\mu X_{0}}{(\\mu-h)K}\\bigl(\\exp\\bigl((\\mu-h)T\\bigr)-1\\bigr)\\right),\n$$\nwhich is a closed-form expression for the total harvested biomass as a function of $h$ and the known parameters.", "answer": "$$\\boxed{\\frac{hK}{\\mu}\\ln\\!\\left(1+\\frac{\\mu X_{0}}{(\\mu-h)K}\\left(\\exp\\!\\bigl((\\mu-h)T\\bigr)-1\\right)\\right)}$$", "id": "1427311"}]}