{"hands_on_practices": [{"introduction": "The foundation of analyzing metabolic networks is translating complex biochemical reactions into a precise mathematical language. This first exercise provides essential practice in this core skill by asking you to represent a well-known metabolic process, anaerobic glycolysis, as a stoichiometric vector. Mastering this conversion [@problem_id:1445968] is the first step toward building and understanding the large-scale stoichiometric matrices used in systems biology.", "problem": "In systems biology, metabolic pathways are mathematically represented using stoichiometric matrices. Each column in such a matrix is a vector representing a single reaction, with entries corresponding to the stoichiometric coefficients of the metabolites involved.\n\nConsider the overall reaction of anaerobic glycolysis in muscle cells, a process that provides rapid energy. In this pathway, one molecule of glucose is anaerobically converted into two molecules of lactate. This conversion is coupled with energy production, resulting in the net synthesis of two molecules of Adenosine Triphosphate (ATP) from two molecules of Adenosine Diphosphate (ADP) and two molecules of inorganic phosphate (Pi).\n\nYour task is to determine the stoichiometric vector for this overall reaction. This vector should list the coefficients for the following metabolites in the specified order:\n1. Glucose\n2. ATP\n3. ADP\n4. Pi\n5. Lactate\n\nAdhere to the standard convention where the stoichiometric coefficients of reactants are negative and the coefficients of products are positive. Express your final answer as a single row matrix.", "solution": "The stoichiometric vector represents the overall reaction by assigning a coefficient $\\nu_{i}$ to each metabolite $X_{i}$ in a reaction written in the canonical form $\\sum_{i} \\nu_{i} X_{i} = 0$, with the convention that reactants have negative coefficients and products have positive coefficients.\n\nThe stated overall anaerobic glycolysis in muscle cells is: one glucose is converted to two lactate, with the net synthesis of two ATP from two ADP and two inorganic phosphate (Pi). Writing the reaction explicitly,\n$$\\text{Glucose} + 2\\,\\text{ADP} + 2\\,\\text{Pi} \\longrightarrow 2\\,\\text{Lactate} + 2\\,\\text{ATP}.$$\n\nApplying the sign convention:\n- Glucose is a reactant consumed: coefficient $-1$.\n- ATP is produced: coefficient $+2$.\n- ADP is consumed: coefficient $-2$.\n- Pi is consumed: coefficient $-2$.\n- Lactate is produced: coefficient $+2$.\n\nArranging these coefficients in the specified order [Glucose, ATP, ADP, Pi, Lactate] yields the stoichiometric row vector\n$$\\begin{pmatrix} -1  2  -2  -2  2 \\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}-1  2  -2  -2  2\\end{pmatrix}}$$", "id": "1445968"}, {"introduction": "Flux Balance Analysis (FBA) often seeks to maximize cellular growth, which is mathematically represented by a special \"biomass objective function.\" This practice guides you through the construction of such a function for a hypothetical organism, starting from its basic macromolecular composition. This exercise [@problem_id:1445985] is invaluable as it demystifies the biomass reaction, showing how it serves as a metabolic \"parts list\" that connects the synthesis of proteins, lipids, and other components to the consumption of energy and precursors.", "problem": "A hypothetical bacterium, *Metabolicus simplicius*, is studied for its efficiency in producing biomass. Its dry biomass is composed of several macromolecules, but for a simplified model, we will only consider its protein and lipid content. The dry biomass is found to be 50.0% protein and 20.0% lipid by mass.\n\nTo construct a model of biomass synthesis, the following assumptions are made:\n1.  All proteins can be represented by a single repeating monomer, the amino acid Alanine (molar mass $M_{Ala} = 89.09 \\text{ g/mol}$).\n2.  All lipids can be represented by a single repeating monomer, the fatty acid Palmitic Acid (molar mass $M_{PA} = 256.42 \\text{ g/mol}$).\n3.  The energy cost, in terms of Adenosine Triphosphate (ATP), for synthesizing these monomers from central metabolic precursors is:\n    - 5 molecules of ATP per molecule of Alanine synthesized.\n    - 40 molecules of ATP per molecule of Palmitic Acid synthesized.\n4.  The energy cost for polymerization (assembling monomers into macromolecules) is:\n    - 4 molecules of ATP per peptide bond formed (to link amino acids into proteins).\n    - 2 molecules of ATP per molecule of Palmitic Acid incorporated into a lipid structure.\n5.  For the large polymers involved, assume that the number of peptide bonds required to form the protein mass is equal to the number of Alanine monomers.\n\nBased on this model, calculate the total number of moles of ATP required for the synthesis of 1.00 gram of the bacterium's dry biomass. Express your final answer in units of moles of ATP per gram of biomass, rounded to three significant figures.", "solution": "We model 1.00 g of dry biomass as containing a protein mass fraction of 0.500 and a lipid mass fraction of 0.200. Thus the masses contributing to ATP demand are\n$$\nm_{\\text{prot}}=0.500 \\text{ g}, \\quad m_{\\text{lip}}=0.200 \\text{ g}.\n$$\nUsing the given monomer representations and molar masses, the corresponding moles of monomers are\n$$\nn_{\\text{Ala}}=\\frac{m_{\\text{prot}}}{M_{\\text{Ala}}}=\\frac{0.500}{89.09} \\text{ mol}, \\qquad\nn_{\\text{PA}}=\\frac{m_{\\text{lip}}}{M_{\\text{PA}}}=\\frac{0.200}{256.42} \\text{ mol}.\n$$\nThe ATP cost per alanine incorporated into protein equals the sum of monomer synthesis and polymerization costs. By assumption, the number of peptide bonds equals the number of alanine monomers, so\n$$\n\\text{ATP per Ala} = 5 + 4 = 9,\n$$\ngiving\n$$\nn_{\\text{ATP,prot}} = 9\\,n_{\\text{Ala}} = 9\\left(\\frac{0.500}{89.09}\\right) \\text{ mol}.\n$$\nSimilarly, for lipid, the ATP cost per palmitate incorporated equals\n$$\n\\text{ATP per PA} = 40 + 2 = 42,\n$$\ngiving\n$$\nn_{\\text{ATP,lip}} = 42\\,n_{\\text{PA}} = 42\\left(\\frac{0.200}{256.42}\\right) \\text{ mol}.\n$$\nThe total ATP required for synthesizing 1.00 g of the modeled biomass is\n$$\nn_{\\text{ATP,tot}} = n_{\\text{ATP,prot}} + n_{\\text{ATP,lip}} \n= 9\\left(\\frac{0.500}{89.09}\\right) + 42\\left(\\frac{0.200}{256.42}\\right) \\text{ mol}.\n$$\nEvaluating numerically,\n$$\nn_{\\text{Ala}} \\approx \\frac{0.500}{89.09} \\approx 5.6123\\times 10^{-3} \\text{ mol}, \\quad\nn_{\\text{ATP,prot}} \\approx 9 \\times 5.6123\\times 10^{-3} = 5.05107\\times 10^{-2} \\text{ mol},\n$$\n$$\nn_{\\text{PA}} \\approx \\frac{0.200}{256.42} \\approx 7.7997\\times 10^{-4} \\text{ mol}, \\quad\nn_{\\text{ATP,lip}} \\approx 42 \\times 7.7997\\times 10^{-4} = 3.27587568\\times 10^{-2} \\text{ mol}.\n$$\nTherefore,\n$$\nn_{\\text{ATP,tot}} \\approx 5.05107\\times 10^{-2} + 3.27587568\\times 10^{-2}\n= 8.32694568\\times 10^{-2} \\text{ mol}.\n$$\nSince this is for 1.00 g of biomass, the result is in moles of ATP per gram of biomass. Rounding to three significant figures gives\n$$\n0.0833.\n$$", "answer": "$$\\boxed{0.0833}$$", "id": "1445985"}, {"introduction": "With an understanding of how to represent reactions and objectives, you can now analyze a complete, functional metabolic system. This problem challenges you to model a simplified energy production pathway, incorporating realistic biological constraints such as resource limitations and metabolic inefficiencies like a \"leaky\" membrane. By systematically calculating the maximum ATP production under different conditions [@problem_id:2404803], you will directly apply the principles of constraint-based modeling to predict how cellular performance adapts to both internal and external pressures.", "problem": "A minimal, mass-balanced stoichiometric model is used to quantify the effect of passive proton diffusion (a leaky membrane) on adenosine triphosphate (ATP) production capacity. Consider a single lumped proton pool on the outer side of the inner membrane (periplasmic/intermembrane space) represented by the metabolite $H_p$. Reducing equivalents are represented by an abstract metabolite $Red$. All fluxes must be treated as steady-state in the sense of $S v = 0$ for the tracked metabolites. The following reactions are defined:\n- Reducing equivalent supply: $R_{in}: \\ \\emptyset \\rightarrow Red$ with flux $v_{in}$ and bound $0 \\le v_{in} \\le R_{max}$.\n- Electron transport chain proton pump: $R_{pump}: \\ Red \\rightarrow \\emptyset + s \\ H_p$ with flux $v_{pump}$ and bound $0 \\le v_{pump} \\le U_{pump}$. Here $s$ is the number of protons pumped per unit of reducing equivalent consumed.\n- ATP synthase: $R_{ATP}: \\ p \\ H_p \\rightarrow \\emptyset$ with flux $v_{ATP}$ and bound $0 \\le v_{ATP}  \\infty$. Here $p$ is the number of protons required per ATP synthesized, and $v_{ATP}$ directly equals the ATP production rate.\n- Proton leak: $R_{leak}: \\ H_p \\rightarrow \\emptyset$ with flux $v_{leak}$ fixed to a specified constant $L$ (that is, $v_{leak} = L$). This models passive proton diffusion that dissipates the proton motive force.\n\nLet the vector of decision variables be $v = [v_{in}, v_{pump}, v_{ATP}, v_{leak}, v_{sink}]^\\top$, where $v_{sink} \\ge 0$ allows any unused reducing equivalents to be drained ($Red \\rightarrow \\emptyset$) to satisfy $Red$ balance. The steady-state mass balances for $Red$ and $H_p$ are:\n- $Red$: $v_{in} - v_{pump} - v_{sink} = 0$.\n- $H_p$: $s \\ v_{pump} - p \\ v_{ATP} - v_{leak} = 0$.\n\nAll fluxes are in millimoles per gram dry weight per hour, that is, in $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{h}^{-1}$, and all parameters $R_{max}$, $U_{pump}$, $s$, $p$, $L$ are nonnegative real numbers with the following meanings:\n- $R_{max}$: upper bound on reducing equivalent supply $v_{in}$.\n- $U_{pump}$: upper bound on the electron transport chain pumping flux $v_{pump}$.\n- $s$: protons pumped per unit $Red$ consumed.\n- $p$: protons consumed per ATP synthesized.\n- $L$: fixed proton leak flux $v_{leak}$.\n\nTask: For each parameter set below, compute the maximum feasible ATP production rate $v_{ATP}^\\star$ that satisfies the above constraints. If no steady-state solution exists (the constraints are infeasible), return $-1.0$.\n\nYou must use only the stated model, steady-state balances, and bounds. Express each result as a real number in $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{h}^{-1}$ rounded to six decimal places.\n\nTest suite (each case is $(R_{max}, U_{pump}, s, p, L)$):\n1. $(10, 8, 10, 4, 0)$\n2. $(10, 8, 10, 4, 10)$\n3. $(10, 8, 10, 4, 85)$\n4. $(5, 100, 10, 4, 10)$\n5. $(12, 12, 10, 3.67, 0)$\n\nFinal output format: Your program should produce a single line of output containing the five results as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,x_3,x_4,x_5]$, where each $x_i$ is rounded to six decimal places as specified.", "solution": "The problem presented is a constrained optimization task, which can be formalized as a linear programming problem. The objective is to determine the maximum production rate of adenosine triphosphate, $v_{ATP}$, subject to a set of stoichiometric and capacity constraints within a simplified metabolic model.\n\nThe system is defined by the following variables and constraints:\n\n**Decision Variables:** The flux vector is $v = [v_{in}, v_{pump}, v_{ATP}, v_{leak}, v_{sink}]^\\top$.\n\n**Steady-State Mass Balances:**\n1. For reducing equivalents, $Red$: $v_{in} - v_{pump} - v_{sink} = 0$.\n2. For protons, $H_p$: $s \\cdot v_{pump} - p \\cdot v_{ATP} - v_{leak} = 0$.\n\n**Flux Bounds and Conditions:**\n3. $0 \\le v_{in} \\le R_{max}$\n4. $0 \\le v_{pump} \\le U_{pump}$\n5. $0 \\le v_{ATP}  \\infty$\n6. $v_{leak} = L$\n7. $v_{sink} \\ge 0$\n\nThe task is to maximize the objective function $f(v) = v_{ATP}$.\n\nWe shall solve this problem analytically by reducing the system of constraints.\n\nFrom balance (1) and constraint (7), we deduce $v_{sink} = v_{in} - v_{pump} \\ge 0$, which implies an important coupling: $v_{in} \\ge v_{pump}$. Combining this with constraint (3), we find that $v_{pump} \\le v_{in} \\le R_{max}$, which establishes an upper bound on the pumping flux: $v_{pump} \\le R_{max}$.\n\nFrom balance (2) and condition (6), we express $v_{ATP}$ as a function of $v_{pump}$:\n$p \\cdot v_{ATP} = s \\cdot v_{pump} - v_{leak} = s \\cdot v_{pump} - L$.\nFor a physically meaningful problem where ATP synthesis requires proton motive force, the parameter $p$ (protons per ATP) must be strictly positive, i.e., $p  0$. This condition holds for all test cases provided. Under this necessary assumption, we can write:\n$$v_{ATP} = \\frac{s \\cdot v_{pump} - L}{p}$$\n\nThe objective is to maximize $v_{ATP}$. Since the parameters $s$ and $p$ are positive constants, maximizing $v_{ATP}$ is equivalent to maximizing the flux $v_{pump}$. The problem is thus reduced to finding the maximum feasible value of $v_{pump}$.\n\nLet us consolidate all constraints on $v_{pump}$:\na. From constraint (4), $0 \\le v_{pump} \\le U_{pump}$.\nb. As derived from constraints (1), (3) and (7), $v_{pump} \\le R_{max}$.\nc. From constraint (5), $v_{ATP} \\ge 0$, which implies $\\frac{s \\cdot v_{pump} - L}{p} \\ge 0$. With $p0$ and $s0$ (as is the case for a functional pump), this simplifies to $s \\cdot v_{pump} - L \\ge 0$, or $v_{pump} \\ge \\frac{L}{s}$.\n\nCombining these, the feasible range for $v_{pump}$ is:\n$$ \\frac{L}{s} \\le v_{pump} \\le \\min(U_{pump}, R_{max}) $$\n\nFor a feasible steady-state solution to exist, this interval must be non-empty. This requires the lower bound to be less than or equal to the upper bound:\n$$ \\frac{L}{s} \\le \\min(U_{pump}, R_{max}) $$\n\nIf this condition is violated, the constraints are contradictory, rendering the system infeasible. In this case, no steady-state solution exists, and the specified output is $-1.0$.\n\nIf the condition is met, a feasible set of fluxes exists. To maximize $v_{pump}$ (and consequently $v_{ATP}$), we must select the highest value from its feasible range. Let this optimal flux be $v_{pump}^\\star$:\n$$ v_{pump}^\\star = \\min(U_{pump}, R_{max}) $$\nThis value represents the effective maximum flux through the proton pump, which is bottlenecked by either the availability of reducing equivalents (limited by $R_{max}$) or the intrinsic capacity of the pump itself (limited by $U_{pump}$).\n\nThe maximum ATP production rate, $v_{ATP}^\\star$, is then calculated by substituting $v_{pump}^\\star$ into the derived expression for $v_{ATP}$:\n$$ v_{ATP}^\\star = \\frac{s \\cdot v_{pump}^\\star - L}{p} = \\frac{s \\cdot \\min(U_{pump}, R_{max}) - L}{p} $$\nThis final expression provides a direct method for calculating the required value for each parameter set.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum feasible ATP production rate for a series of metabolic models.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (R_max, U_pump, s, p, L)\n    test_cases = [\n        (10, 8, 10, 4, 0),\n        (10, 8, 10, 4, 10),\n        (10, 8, 10, 4, 85),\n        (5, 100, 10, 4, 10),\n        (12, 12, 10, 3.67, 0),\n    ]\n\n    results = []\n    for case in test_cases:\n        R_max, U_pump, s, p, L = case\n\n        # The maximum possible flux through the pump is limited by the supply of\n        # reducing equivalents (R_max) and the pump's own capacity (U_pump).\n        v_pump_effective_max = min(R_max, U_pump)\n\n        # For ATP synthesis to be non-negative (v_ATP = 0), the proton pumping\n        # rate must be sufficient to overcome the passive proton leak (L).\n        # The condition is s * v_pump - L = 0.\n        # This gives a minimum required v_pump.\n        # We must handle the case s=0 to avoid division by zero.\n        # If s=0 and L0, the condition can never be met, so it's infeasible.\n        # If s=0 and L=0, the condition becomes 0 = 0, and v_pump_min_req is 0.\n        if s == 0:\n            if L  0:\n                # Infeasible if pump doesn't work but there is a leak\n                v_pump_min_req = float('inf')\n            else:\n                # No leak, no pumping needed to overcome it\n                v_pump_min_req = 0.0\n        else:\n            v_pump_min_req = L / s\n\n        # A steady-state solution is feasible only if the maximum possible pump flux\n        # is greater than or equal to the minimum required pump flux.\n        if v_pump_effective_max = v_pump_min_req:\n            # If feasible, we maximize v_ATP by maximizing v_pump.\n            # The optimal v_pump is its effective maximum value.\n            v_pump_star = v_pump_effective_max\n            \n            # The parameter p must be  0 for ATP synthesis to be well-defined.\n            # The problem context and test cases imply p  0.\n            if p  0:\n                v_atp_star = (s * v_pump_star - L) / p\n            else:\n                # If p=0, ATP can be produced 'for free'.\n                # If s*v_pump_star - L == 0, v_ATP is not constrained.\n                # If s*v_pump_star - L != 0, it's a contradiction.\n                # This case represents a poorly defined model, but we can treat v_ATP as 0\n                # or infeasible. Problem statement implies p  0.\n                v_atp_star = -1.0 # Fallback for malformed problem not in tests.\n            \n            results.append(v_atp_star)\n        else:\n            # If the constraints cannot be simultaneously satisfied, the system is infeasible.\n            results.append(-1.0)\n    \n    # Format results to six decimal places as specified.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2404803"}]}