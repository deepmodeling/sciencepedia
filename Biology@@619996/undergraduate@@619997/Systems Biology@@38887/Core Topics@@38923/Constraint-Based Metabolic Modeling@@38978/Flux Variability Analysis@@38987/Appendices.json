{"hands_on_practices": [{"introduction": "Let's start with the fundamentals of Flux Variability Analysis (FVA) by examining the simplest possible metabolic structure: a linear pathway. This exercise [@problem_id:1434665] will help you build intuition for how the steady-state assumption directly constrains reaction fluxes. By analyzing this basic case, you will see how stoichiometric coupling in an unbranched pathway leads to identical flux variability ranges for all reactions involved.", "problem": "A bioengineered microorganism is designed to produce a specialty chemical, 'P', through a simplified linear metabolic pathway. The pathway starts with the uptake of a nutrient, 'Substrate_in' ($S_{in}$), from the environment at a rate $v_{uptake}$. This substrate is then converted into an intermediate 'S' at a rate $v_1$, which is subsequently converted into the final product 'P' at a rate $v_2$. The pathway can be represented as:\n\n$S_{in} \\xrightarrow{v_{uptake}} S_0 \\xrightarrow{v_1} S_1 \\xrightarrow{v_2} P$\n\nThe analysis of this system is based on the following well-established biophysical principles and constraints:\n1. The system operates at a steady state, meaning the concentrations of the internal metabolites ($S_0$ and $S_1$) remain constant over time.\n2. All reactions are considered irreversible, implying that all fluxes ($v_{uptake}$, $v_1$, $v_2$) are non-negative values.\n3. The nutrient uptake is limited by the cell's transport capacity, constraining the uptake flux to the range $0 \\le v_{uptake} \\le V_{max}$.\n\nThe microorganism is cultured under conditions where its metabolic state is optimized for high yield. Specifically, we are only considering states where the production rate of P, given by the flux $v_2$, is maintained at a level of at least 90% of its absolute theoretical maximum.\n\nLet the set of all possible values for flux $v_1$ that satisfy these conditions be described by the interval $R_1 = [v_{1,min}, v_{1,max}]$, and the corresponding set for flux $v_2$ be $R_2 = [v_{2,min}, v_{2,max}]$. Which of the following statements correctly describes the relationship between these two intervals?\n\nA. $R_1$ is identical to $R_2$.\n\nB. $R_1$ is a wider interval that strictly contains $R_2$ (i.e., $R_2 \\subset R_1$ and $R_2 \\neq R_1$).\n\nC. $R_2$ is a wider interval that strictly contains $R_1$ (i.e., $R_1 \\subset R_2$ and $R_1 \\neq R_2$).\n\nD. $R_1$ and $R_2$ are non-overlapping intervals.\n\nE. The relationship depends on the specific kinetic properties of the enzymes involved, which are not provided.", "solution": "At steady state, the internal metabolite balances impose equalities of the fluxes along the linear pathway. For metabolite $S_{0}$,\n$$\n\\frac{d[S_{0}]}{dt}=v_{uptake}-v_{1}=0 \\;\\;\\Rightarrow\\;\\; v_{1}=v_{uptake}.\n$$\nFor metabolite $S_{1}$,\n$$\n\\frac{d[S_{1}]}{dt}=v_{1}-v_{2}=0 \\;\\;\\Rightarrow\\;\\; v_{2}=v_{1}.\n$$\nTherefore,\n$$\nv_{uptake}=v_{1}=v_{2}.\n$$\n\nIrreversibility implies non-negativity of all fluxes, and the uptake capacity imposes $0\\leq v_{uptake}\\leq V_{max}$. Using $v_{uptake}=v_{1}=v_{2}$, it follows that\n$$\n0\\leq v_{1}\\leq V_{max},\\quad 0\\leq v_{2}\\leq V_{max}.\n$$\n\nThe absolute theoretical maximum of $v_{2}$ under these constraints is\n$$\nv_{2,\\max}=V_{max}.\n$$\nRestricting to high-yield states with $v_{2}\\geq \\frac{9}{10}V_{max}$ yields\n$$\nR_{2}=\\left[\\frac{9}{10}V_{max},\\,V_{max}\\right].\n$$\nSince $v_{1}=v_{2}$ for every feasible steady state in this linear pathway, the admissible values of $v_{1}$ under the same high-yield requirement are identical:\n$$\nR_{1}=\\left[\\frac{9}{10}V_{max},\\,V_{max}\\right]=R_{2}.\n$$\n\nHence, $R_{1}$ is identical to $R_{2}$.", "answer": "$$\\boxed{A}$$", "id": "1434665"}, {"introduction": "Metabolic networks are remarkably flexible, capable of rerouting fluxes through different pathways in response to changing environmental conditions. This practice problem [@problem_id:1434684] explores this concept by asking you to apply FVA to a simplified network under both aerobic and anaerobic conditions. You will calculate how the feasible flux range for a key reaction changes when an alternative pathway becomes available, providing a quantitative look at metabolic adaptability.", "problem": "A simplified model of a bacterium's central metabolism is being studied to understand its metabolic flexibility. The model consists of two internal metabolites, pyruvate (pyr) and acetyl-CoA (accoa), and a 'Biomass' product. The organism consumes external glucose (glc_ext) as its sole carbon source. The reactions in the network are defined by the following stoichiometry:\n\n*   **R1 (Glucose Uptake):** $1 \\text{ glc\\_ext} \\rightarrow 2 \\text{ pyr}$\n*   **R2 (Pyruvate Dehydrogenase, PDH):** $1 \\text{ pyr} \\rightarrow 1 \\text{ accoa}$\n*   **R3 (Pyruvate Formate-Lyase, PFL):** $1 \\text{ pyr} \\rightarrow 1 \\text{ accoa}$ (This is a simplified representation of an alternative anaerobic pathway)\n*   **R4 (Respiration):** $1 \\text{ accoa} \\rightarrow$ (This reaction represents the complete oxidation of acetyl-CoA via the TCA cycle and respiratory chain)\n*   **R5 (Biomass Synthesis):** $3 \\text{ pyr} + 2 \\text{ accoa} \\rightarrow 1 \\text{ Biomass}$\n\nThe system is analyzed under the assumption of steady-state, meaning the concentration of internal metabolites (pyr, accoa) does not change over time. All reaction fluxes are considered irreversible (flux ≥ 0). The glucose uptake flux (for reaction R1) is fixed at 10 mmol/(gDW·h). To ensure viability, the biomass synthesis flux (for reaction R5) must be at least 1 mmol/(gDW·h).\n\nYou are tasked with performing a Flux Variability Analysis (FVA) on this model. FVA is a computational method used to find the full range of possible values for each reaction flux that are consistent with the given constraints.\n\nCalculate the minimum and maximum possible steady-state flux for the Pyruvate Dehydrogenase (PDH) reaction (R2) under two distinct environmental conditions:\n\n1.  **Condition A (Fully Aerobic):** The cell uses aerobic respiration. In this state, the PFL enzyme (R3) is completely inactive (`flux_R3 = 0`), while the respiration pathway (R4) is active.\n2.  **Condition B (Strictly Anaerobic):** The cell cannot use aerobic respiration. In this state, the respiration pathway (R4) is completely inactive (`flux_R4 = 0`), while the PFL enzyme (R3) is active.\n\nYour answer should consist of four exact integer values: the minimum and maximum PDH flux for Condition A, and the minimum and maximum PDH flux for Condition B. All flux values should be considered in units of mmol/(gDW·h). Present these four values in a 2x2 matrix, where the first row corresponds to the [min, max] range for Condition A, and the second row corresponds to the [min, max] range for Condition B.", "solution": "Let the irreversible fluxes be denoted by $v_{1}$ through $v_{5}$ corresponding to reactions R1 through R5, respectively. The fixed uptake is $v_{1}=10$, and the biomass constraint is $v_{5}\\geq 1$. Steady-state of internal metabolites imposes mass balances.\n\nFor pyruvate, production from R1 and consumption by R2, R3, and R5 gives\n$$\n2v_{1}-v_{2}-v_{3}-3v_{5}=0 \\quad \\Rightarrow \\quad v_{2}+v_{3}+3v_{5}=20.\n$$\nFor acetyl-CoA, production by R2 and R3 and consumption by R4 and R5 gives\n$$\nv_{2}+v_{3}-v_{4}-2v_{5}=0 \\quad \\Rightarrow \\quad v_{4}=v_{2}+v_{3}-2v_{5}.\n$$\nAll fluxes satisfy $v_{i}\\geq 0$.\n\nCondition A imposes $v_{3}=0$ and allows $v_{4}\\geq 0$. The pyruvate balance becomes\n$$\nv_{2}+3v_{5}=20 \\quad \\Rightarrow \\quad v_{2}=20-3v_{5}.\n$$\nThe acetyl-CoA constraint yields\n$$\nv_{4}=v_{2}-2v_{5}=20-5v_{5}\\geq 0 \\quad \\Rightarrow \\quad v_{5}\\leq 4.\n$$\nTogether with $v_{5}\\geq 1$ and $v_{2}\\geq 0$ (which implies $v_{5}\\leq \\frac{20}{3}$), the feasible range for $v_{5}$ is $1\\leq v_{5}\\leq 4$. Hence\n$$\nv_{2}^{\\min}=20-3\\cdot 4=8,\\qquad v_{2}^{\\max}=20-3\\cdot 1=17.\n$$\n\nCondition B imposes $v_{4}=0$ and allows $v_{3}\\geq 0$. The acetyl-CoA balance gives\n$$\nv_{2}+v_{3}=2v_{5}.\n$$\nCombining with the pyruvate balance $v_{2}+v_{3}+3v_{5}=20$ yields\n$$\n2v_{5}+3v_{5}=20 \\quad \\Rightarrow \\quad v_{5}=4,\n$$\nwhich satisfies $v_{5}\\geq 1$. Then $v_{2}+v_{3}=8$ with $v_{2}\\geq 0$ and $v_{3}\\geq 0$, so $v_{2}$ can vary freely between $0$ and $8$:\n$$\nv_{2}^{\\min}=0,\\qquad v_{2}^{\\max}=8.\n$$\n\nTherefore, the PDH (R2) flux ranges are [min, max] equal to $[8,17]$ for Condition A and $[0,8]$ for Condition B, reported as a $2\\times 2$ matrix with rows corresponding to the two conditions.", "answer": "$$\\boxed{\\begin{pmatrix} 8 & 17 \\\\ 0 & 8 \\end{pmatrix}}$$", "id": "1434684"}, {"introduction": "Beyond calculating the flux range for a single reaction, FVA can be used as a powerful tool to probe the structural relationships within an entire metabolic network. This advanced problem [@problem_id:1434682] challenges you to think like a computational biologist and design an algorithm to identify all \"directionally coupled\" reaction pairs. Successfully designing this procedure requires a deep understanding of the logic behind FVA and how to formulate specific biological questions as linear programming problems.", "problem": "In constraint-based modeling of metabolic networks, the system is described by a stoichiometric matrix $S$ of size $m \\times n$, where $m$ is the number of metabolites and $n$ is the number of reactions. A vector of reaction fluxes, $\\mathbf{v} = (v_1, v_2, ..., v_n)^T$, represents the state of the network. Under the steady-state assumption, the net production of each metabolite is zero, leading to the constraint $S\\mathbf{v} = 0$. Each flux $v_k$ is further constrained by lower and upper bounds, $\\mathbf{v}_{lb} \\le \\mathbf{v} \\le \\mathbf{v}_{ub}$. For irreversible reactions, the lower bound is zero.\n\nFlux Variability Analysis (FVA) is a computational technique used to explore the range of feasible fluxes for each reaction under a given set of constraints.\n\nWe define a \"directionally coupled\" pair of irreversible reactions $(v_i, v_j)$ as a pair where a positive flux through reaction $i$ necessitates a positive flux through reaction $j$. More formally, for any feasible flux vector $\\mathbf{v}$, if $v_i > 0$, then it must also be that $v_j > 0$.\n\nYour task is to design a computational procedure, based on the principles of FVA, to systematically identify all such directionally coupled pairs of irreversible reactions in a given network. Below are several proposed algorithms. Select the one that correctly identifies all directionally coupled pairs $(v_i, v_j)$.\n\nA. Run a standard FVA by first solving for the maximum value of a primary biological objective (e.g., biomass production) and then finding the minimum and maximum flux for each reaction subject to the constraint that the objective value is at least 90% of its maximum. A pair $(v_i, v_j)$ is directionally coupled if the minimum fluxes from this analysis, $v_i^{\\min}$ and $v_j^{\\min}$, are both greater than zero.\n\nB. Generate a large set of random, feasible flux vectors that satisfy $S\\mathbf{v}=0$ and the flux bounds. For each pair of irreversible reactions $(v_i, v_j)$, calculate the Pearson correlation coefficient of their fluxes across all the sampled vectors. Identify pairs as directionally coupled if their correlation coefficient is greater than a high threshold (e.g., 0.99).\n\nC. For each pair of irreversible reactions $(v_i, v_j)$, add a temporary constraint that forces a small positive flux through the first reaction ($v_i \\ge \\epsilon$, where $\\epsilon$ is a small positive constant). Then, solve the linear programming problem to find the minimum possible flux through the second reaction, $v_j$. If the resulting minimum value for $v_j$ is greater than zero, the pair $(v_i, v_j)$ is directionally coupled.\n\nD. For each pair of irreversible reactions $(v_i, v_j)$, add a temporary constraint that forces the flux through the second reaction to be zero ($v_j = 0$). Then, solve the linear programming problem to find the maximum possible flux through the first reaction, $v_i$. If the resulting maximum value for $v_i$ is greater than zero, the pair $(v_i, v_j)$ is directionally coupled.\n\nE. For each pair of irreversible reactions $(v_i, v_j)$, add the temporary constraint $v_i = v_j$ to the system. Then check if a feasible solution still exists (e.g., by maximizing any arbitrary flux and checking if the maximum is greater than zero). If a feasible solution exists, the pair is directionally coupled.", "solution": "Let $\\mathcal{F}$ denote the feasible flux polyhedron\n$$\n\\mathcal{F}=\\{\\mathbf{v}\\in \\mathbb{R}^{n}\\,:\\,S\\mathbf{v}=0,\\ \\mathbf{v}_{lb}\\le \\mathbf{v}\\le \\mathbf{v}_{ub}\\},\n$$\nwith irreversibility encoded by $v_{k}\\ge 0$ for irreversible reactions. A pair of irreversible reactions $(v_{i},v_{j})$ is directionally coupled if and only if\n$$\n\\forall\\,\\mathbf{v}\\in\\mathcal{F},\\ v_{i}>0 \\Rightarrow v_{j}>0.\n$$\nThis is equivalent to the nonexistence of any feasible $\\mathbf{v}\\in\\mathcal{F}$ with\n$$\nv_{i}>0\\ \\text{and}\\ v_{j}=0.\n$$\nEquivalently, this is characterized by the optimal value of the linear program\n$$\n\\max\\{v_{i}:\\ \\mathbf{v}\\in\\mathcal{F},\\ v_{j}=0\\},\n$$\nwhich must equal $0$ for directional coupling to hold. If the optimum were greater than $0$, then there exists a feasible $\\mathbf{v}$ with $v_{i}>0$ and $v_{j}=0$, violating the implication.\n\nNow consider the proposed algorithms:\n\n- Option A restricts to a suboptimality-constrained subset of $\\mathcal{F}$ based on a primary objective. Directional coupling is defined over the entire feasible set $\\mathcal{F}$, not merely the near-optimal slice. Hence $v_{i}^{\\min}>0$ and $v_{j}^{\\min}>0$ under a $90\\%$-optimality constraint is neither necessary nor sufficient for the implication to hold over all of $\\mathcal{F}$. Therefore A is incorrect.\n\n- Option B uses correlations across random samples. A high Pearson correlation is not logically equivalent to the implication $v_{i}>0 \\Rightarrow v_{j}>0$ and can produce both false positives and false negatives, especially since sampling cannot exhaust $\\mathcal{F}$. Therefore B is incorrect.\n\n- Option C proposes, for each pair $(v_{i},v_{j})$, adding $v_{i}\\ge \\epsilon$ with $\\epsilon>0$ and solving\n$$\n\\min\\{v_{j}:\\ \\mathbf{v}\\in\\mathcal{F},\\ v_{i}\\ge \\epsilon\\}.\n$$\nIf the minimum is greater than $0$, then no feasible $\\mathbf{v}$ satisfies $v_{i}\\ge \\epsilon$ and $v_{j}=0$. If there existed any $\\mathbf{v}\\in\\mathcal{F}$ with $v_{i}'>0$ and $v_{j}'=0$, then choosing any $\\epsilon$ with $0<\\epsilon\\le v_{i}'$ would yield an optimal value of $0$ for the above minimization. Thus, if for some strictly positive $\\epsilon$ the minimum is strictly positive, it precludes the existence of any feasible $\\mathbf{v}$ with $v_{i}>0$ and $v_{j}=0$, establishing the implication. Practically, one chooses $\\epsilon$ as a small positive constant consistent with numerical tolerances. Hence C correctly operationalizes the implication with linear programming and identifies all directionally coupled pairs.\n\n- Option D sets $v_{j}=0$ and maximizes $v_{i}$. As shown above, the correct logical test is that the optimal value must be $0$ for coupling to hold. However, D declares the pair coupled if the maximum is greater than zero, which is the negation of the required condition. Therefore D is incorrect.\n\n- Option E enforces $v_{i}=v_{j}$, which is a much stronger constraint than $v_{i}>0 \\Rightarrow v_{j}>0$ and is neither necessary nor sufficient for directional coupling. Therefore E is incorrect.\n\nThus, among the listed procedures, only Option C correctly identifies all directionally coupled pairs using an FVA-based LP test aligned with the logical definition.", "answer": "$$\\boxed{C}$$", "id": "1434682"}]}