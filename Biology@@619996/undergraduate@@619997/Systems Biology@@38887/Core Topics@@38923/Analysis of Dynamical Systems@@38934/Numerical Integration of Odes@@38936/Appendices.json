{"hands_on_practices": [{"introduction": "This first exercise will guide you through the fundamental process of simulating a biological system. We will apply the forward Euler method, the most straightforward numerical integration technique, to a simple two-step metabolic pathway. This practice will help you translate a system of Ordinary Differential Equations (ODEs) into a step-by-step computational algorithm, a core skill in systems biology [@problem_id:1455809].", "problem": "A simple metabolic pathway in a cell involves the conversion of substrate A into an intermediate B, which is then converted into a final product C. The dynamics of the concentrations of A and B, denoted as $S_A(t)$ and $S_B(t)$ respectively, can be modeled by a system of Ordinary Differential Equations (ODEs):\n$$\n\\frac{dS_A}{dt} = -k_1 S_A\n$$\n$$\n\\frac{dS_B}{dt} = k_1 S_A - k_2 S_B\n$$\nThe rate constants for the reactions are given as $k_1 = 0.5\\ \\text{s}^{-1}$ and $k_2 = 0.2\\ \\text{s}^{-1}$. At time $t=0$, the initial concentrations are $S_A(0) = 100.0\\ \\mu\\text{M}$ and $S_B(0) = 0.0\\ \\mu\\text{M}$.\n\nUsing the forward Euler method with a fixed time step of $\\Delta t = 0.1\\ \\text{s}$, calculate the approximate concentrations of substrate A and substrate B at time $t = 0.2\\ \\text{s}$.\n\nProvide your answers for $S_A(0.2)$ and $S_B(0.2)$ in this order. Express your final answer in $\\mu\\text{M}$, rounded to three significant figures.", "solution": "We are asked to approximate $S_{A}(t)$ and $S_{B}(t)$ at $t=0.2$ using the forward Euler method with time step $\\Delta t=0.1$. The ODE system is\n$$\n\\frac{dS_{A}}{dt}=-k_{1}S_{A}, \\quad \\frac{dS_{B}}{dt}=k_{1}S_{A}-k_{2}S_{B},\n$$\nwith $k_{1}=0.5$, $k_{2}=0.2$, and initial conditions $S_{A}(0)=100.0$, $S_{B}(0)=0.0$.\n\nThe forward Euler updates are\n$$\nS_{A}^{n+1}=S_{A}^{n}+\\Delta t\\left(-k_{1}S_{A}^{n}\\right)=S_{A}^{n}\\left(1-k_{1}\\Delta t\\right),\n$$\n$$\nS_{B}^{n+1}=S_{B}^{n}+\\Delta t\\left(k_{1}S_{A}^{n}-k_{2}S_{B}^{n}\\right),\n$$\nwhere $S_{A}^{n}\\approx S_{A}(n\\Delta t)$ and $S_{B}^{n}\\approx S_{B}(n\\Delta t)$.\n\nCompute the factor for $S_{A}$:\n$$\n1-k_{1}\\Delta t=1-0.5\\cdot 0.1=0.95.\n$$\n\nStep from $t=0$ to $t=0.1$:\n$$\nS_{A}^{1}=S_{A}^{0}\\cdot 0.95=100.0\\cdot 0.95=95.0,\n$$\n$$\nS_{B}^{1}=S_{B}^{0}+\\Delta t\\left(k_{1}S_{A}^{0}-k_{2}S_{B}^{0}\\right)=0.0+0.1\\left(0.5\\cdot 100.0-0.2\\cdot 0.0\\right)=0.1\\cdot 50.0=5.0.\n$$\n\nStep from $t=0.1$ to $t=0.2$:\n$$\nS_{A}^{2}=S_{A}^{1}\\cdot 0.95=95.0\\cdot 0.95=90.25,\n$$\n$$\nS_{B}^{2}=S_{B}^{1}+\\Delta t\\left(k_{1}S_{A}^{1}-k_{2}S_{B}^{1}\\right)=5.0+0.1\\left(0.5\\cdot 95.0-0.2\\cdot 5.0\\right).\n$$\nCompute the bracket:\n$$\n0.5\\cdot 95.0=47.5,\\quad 0.2\\cdot 5.0=1.0,\\quad 47.5-1.0=46.5,\n$$\nso\n$$\nS_{B}^{2}=5.0+0.1\\cdot 46.5=5.0+4.65=9.65.\n$$\n\nThus $S_{A}(0.2)\\approx 90.25$ and $S_{B}(0.2)\\approx 9.65$. Rounding to three significant figures gives $S_{A}(0.2)=90.3$ and $S_{B}(0.2)=9.65$.", "answer": "$$\\boxed{\\begin{pmatrix}90.3 & 9.65\\end{pmatrix}}$$", "id": "1455809"}, {"introduction": "Now that you have seen how to apply the forward Euler method, it is time to explore its limitations. The choice of the time step, $\\Delta t$, is not just a matter of desired accuracy; it is critical for ensuring the stability of the solution. This problem asks you to determine the maximum stable time step for a simple degradation model, introducing you to the essential concept of numerical stability and why an improperly chosen step size can lead to physically impossible results [@problem_id:1455787].", "problem": "A systems biologist is modeling the degradation of a particular protein, \"Suppressor-Y,\" within a cell after the application of a drug that completely halts new protein synthesis. The concentration of Suppressor-Y, denoted by $C(t)$, is found to decrease according to the first-order ordinary differential equation (ODE):\n$$\n\\frac{dC}{dt} = -kC\n$$\nwhere the degradation rate constant is $k = 5.0 \\, \\text{s}^{-1}$.\n\nTo simulate this process numerically, the biologist decides to use the forward Euler method. The stability of a numerical method is crucial, as an unstable method can produce solutions that oscillate with increasing amplitude or grow exponentially, which is physically nonsensical for a degradation process. The forward Euler method is only stable for this type of problem if the time step, $h$, is chosen to be sufficiently small.\n\nDetermine the maximum value of the time step $h$ for which the forward Euler method is numerically stable when applied to this model. Express your answer in seconds.", "solution": "We consider the linear ODE $\\frac{dC}{dt}=-kC$ with $k>0$. Applying the forward Euler method to $C^{\\prime}(t)=f(C)$ gives the update\n$$\nC_{n+1}=C_{n}+h f(C_{n})=C_{n}-hk\\,C_{n}=(1-hk)\\,C_{n}.\n$$\nFor linear test equations $y^{\\prime}=\\lambda y$, the forward Euler method is absolutely stable when the amplification factor satisfies\n$$\n|1+h\\lambda|<1.\n$$\nHere $\\lambda=-k$, so the stability condition becomes\n$$\n|1-hk|<1.\n$$\nThis inequality is equivalent to the double inequality\n$$\n-1<1-hk<1.\n$$\nFrom the right inequality $1-hk<1$, we obtain $-hk<0$, and since $k>0$, this implies $h>0$. From the left inequality $-1<1-hk$, we get $-2<-hk$, which upon multiplying by $-1$ yields $2>hk$, i.e., $hk<2$. Combining both gives\n$$\n0<hk<2 \\quad \\Longrightarrow \\quad 0<h<\\frac{2}{k}.\n$$\nThus the maximum stable time step is $h_{\\max}=\\frac{2}{k}$. Substituting $k=5.0\\,\\text{s}^{-1}$ gives\n$$\nh_{\\max}=\\frac{2}{5.0}=\\frac{2}{5}=0.4 \\text{ s}.\n$$\nSince the answer must be expressed as the numerical value in seconds, the maximum stable time step is $0.4$.", "answer": "$$\\boxed{0.4}$$", "id": "1455787"}, {"introduction": "Biological systems are often characterized by processes that occur on vastly different timescales, from milliseconds to hours. Such systems are termed \"stiff\" and pose a significant challenge for numerical solvers. This practice will have you confront a stiff system representing a reversible reaction where one rate is much faster than the other. By using the forward Euler method with a seemingly reasonable time step, you will witness the dramatic failure of the method, providing a powerful illustration of why stiffness demands more sophisticated numerical approaches [@problem_id:1455796].", "problem": "In a simplified model of a cellular signaling pathway, a protein `A` can be reversibly converted to its active form `B`. This process can be described by the elementary reaction:\n$$ A \\underset{k_r}{\\stackrel{k_f}{\\rightleftharpoons}} B $$\nThe rate of change of the concentrations of `A` and `B`, denoted as $C_A(t)$ and $C_B(t)$ respectively, are governed by the following system of coupled Ordinary Differential Equations (ODEs):\n$$ \\frac{dC_A}{dt} = -k_f C_A + k_r C_B $$\n$$ \\frac{dC_B}{dt} = k_f C_A - k_r C_B $$\nSuppose the forward rate constant $k_f = 100.0 \\text{ s}^{-1}$ and the reverse rate constant $k_r = 1.0 \\text{ s}^{-1}$. At time $t=0$, the initial concentrations are $C_A(0) = 1.00 \\text{ \\mu M}$ and $C_B(0) = 0.00 \\text{ \\mu M}$.\n\nYour task is to approximate the concentration of protein `B` at time $t = 0.06 \\text{ s}$ by applying the forward Euler method. Use a fixed time step of $h = 0.03 \\text{ s}$.\n\nExpress your final answer for the concentration of `B` in micromolars ($\\mu M$), rounded to three significant figures.", "solution": "We model the reversible conversion with the coupled ODEs\n$$\n\\frac{dC_{A}}{dt}=-k_{f}C_{A}+k_{r}C_{B}, \\qquad \\frac{dC_{B}}{dt}=k_{f}C_{A}-k_{r}C_{B},\n$$\nwith initial conditions $C_{A}(0)=1.00$ and $C_{B}(0)=0.00$, and parameters $k_{f}=100.0$ and $k_{r}=1.0$. The forward Euler method with fixed step size $h=0.03$ updates as\n$$\nC_{A}^{n+1}=C_{A}^{n}+h\\left(-k_{f}C_{A}^{n}+k_{r}C_{B}^{n}\\right), \\qquad\nC_{B}^{n+1}=C_{B}^{n}+h\\left(k_{f}C_{A}^{n}-k_{r}C_{B}^{n}\\right).\n$$\nWe take two steps to reach $t=0.06$.\n\nStep 1 (from $t=0$ to $t=0.03$): Using $C_{A}^{0}=1.00$, $C_{B}^{0}=0.00$,\n$$\n\\left.\\frac{dC_{A}}{dt}\\right|_{0}=-k_{f}C_{A}^{0}+k_{r}C_{B}^{0}=-100.0\\cdot 1.00+1.0\\cdot 0.00=-100.0,\n$$\n$$\n\\left.\\frac{dC_{B}}{dt}\\right|_{0}=k_{f}C_{A}^{0}-k_{r}C_{B}^{0}=100.0\\cdot 1.00-1.0\\cdot 0.00=100.0.\n$$\nThus,\n$$\nC_{A}^{1}=1.00+0.03\\cdot(-100.0)=1.00-3.00=-2.00,\n$$\n$$\nC_{B}^{1}=0.00+0.03\\cdot(100.0)=3.00.\n$$\n\nStep 2 (from $t=0.03$ to $t=0.06$): Using $C_{A}^{1}=-2.00$, $C_{B}^{1}=3.00$,\n$$\n\\left.\\frac{dC_{A}}{dt}\\right|_{1}=-k_{f}C_{A}^{1}+k_{r}C_{B}^{1}=-100.0\\cdot(-2.00)+1.0\\cdot 3.00=203.0,\n$$\n$$\n\\left.\\frac{dC_{B}}{dt}\\right|_{1}=k_{f}C_{A}^{1}-k_{r}C_{B}^{1}=100.0\\cdot(-2.00)-1.0\\cdot 3.00=-203.0.\n$$\nThus,\n$$\nC_{A}^{2}=-2.00+0.03\\cdot 203.0=-2.00+6.09=4.09,\n$$\n$$\nC_{B}^{2}=3.00+0.03\\cdot(-203.0)=3.00-6.09=-3.09.\n$$\nTherefore, the forward Euler approximation at $t=0.06$ gives $C_{B}(0.06)\\approx -3.09$. Rounded to three significant figures, the value is $-3.09$.", "answer": "$$\\boxed{-3.09}$$", "id": "1455796"}]}