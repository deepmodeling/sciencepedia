{"hands_on_practices": [{"introduction": "This first practice problem places you in the role of a systems biologist evaluating competing hypotheses. You are given a small protein-protein interaction network and two different proposals for its community structure. Your task is to use the modularity score, $Q$, as a quantitative tool to determine which partition better represents the network's underlying organization. This exercise provides the foundational skill of calculating and comparing modularity to assess hypotheses about network structure [@problem_id:1452201].", "problem": "In systems biology, networks are often used to model interactions between biological entities. One common type is a Protein-Protein Interaction (PPI) network, where nodes represent proteins and edges represent physical interactions between them. A key task is to identify \"communities\" or \"modules\" within these networks, which often correspond to protein complexes or functional pathways. The quality of a particular community structure, or partition, can be quantified using a metric called modularity, denoted by $Q$. A higher modularity score indicates a better partition, where connections are dense within communities but sparse between them.\n\nConsider a small PPI network consisting of 8 proteins, labeled P1 through P8. The interactions (edges) are as follows:\n(P1, P2), (P1, P3), (P2, P3), (P2, P4), (P3, P4), (P4, P5), (P5, P6), (P5, P7), (P6, P7), (P6, P8), (P7, P8).\n\nTwo competing hypotheses suggest different ways to partition this network into two functional modules.\n- **Partition A**: Community 1 = {P1, P2, P3, P4}, Community 2 = {P5, P6, P7, P8}\n- **Partition B**: Community 1 = {P1, P2, P3}, Community 2 = {P4, P5, P6, P7, P8}\n\nThe modularity $Q$ for a given partition is calculated using the formula:\n$$Q = \\sum_{c=1}^{N_c} \\left[ \\frac{L_c}{m} - \\left( \\frac{D_c}{2m} \\right)^2 \\right]$$\nwhere:\n- $N_c$ is the total number of communities.\n- $m$ is the total number of edges in the network.\n- $L_c$ is the number of edges with both ends inside community $c$.\n- $D_c$ is the sum of the degrees of all nodes in community $c$. (The degree of a node is the number of edges connected to it).\n\nCalculate the modularity scores, $Q_A$ for Partition A and $Q_B$ for Partition B. Which of the following options correctly reports these values?\n\nA. $Q_A = \\frac{9}{22}$, $Q_B = \\frac{34}{121}$\n\nB. $Q_A = \\frac{34}{121}$, $Q_B = \\frac{9}{22}$\n\nC. $Q_A = \\frac{7}{22}$, $Q_B = \\frac{23}{121}$\n\nD. $Q_A = \\frac{45}{121}$, $Q_B = \\frac{34}{121}$\n\nE. $Q_A = \\frac{9}{22}$, $Q_B = \\frac{9}{22}$", "solution": "We enumerate the network and compute modularity exactly.\n\nThe network has edges\n(P1,P2), (P1,P3), (P2,P3), (P2,P4), (P3,P4), (P4,P5), (P5,P6), (P5,P7), (P6,P7), (P6,P8), (P7,P8),\nso the total number of edges is $m=11$.\n\nNode degrees are:\n$\\deg(P1)=2$, $\\deg(P2)=3$, $\\deg(P3)=3$, $\\deg(P4)=3$, $\\deg(P5)=3$, $\\deg(P6)=3$, $\\deg(P7)=3$, $\\deg(P8)=2$,\nwhich sum to $22=2m$, confirming $m=11$.\n\nThe modularity for a partition is\n$$Q=\\sum_{c=1}^{N_{c}}\\left[\\frac{L_{c}}{m}-\\left(\\frac{D_{c}}{2m}\\right)^{2}\\right]$$,\nwhere $L_{c}$ is the number of internal edges in community $c$ and $D_{c}$ is the sum of degrees of nodes in community $c$.\n\nPartition A: Community 1 $=\\{P1,P2,P3,P4\\}$, Community 2 $=\\{P5,P6,P7,P8\\}$.\n- For Community 1, internal edges are $(P1,P2),(P1,P3),(P2,P3),(P2,P4),(P3,P4)$, hence $L_{1}=5$. The degree sum is $D_{1}=\\deg(P1)+\\deg(P2)+\\deg(P3)+\\deg(P4)=2+3+3+3=11$.\n- For Community 2, internal edges are $(P5,P6),(P5,P7),(P6,P7),(P6,P8),(P7,P8)$, hence $L_{2}=5$. The degree sum is $D_{2}=\\deg(P5)+\\deg(P6)+\\deg(P7)+\\deg(P8)=3+3+3+2=11$.\n\nThus,\n$$Q_{A}=\\left[\\frac{5}{11}-\\left(\\frac{11}{22}\\right)^{2}\\right]+\\left[\\frac{5}{11}-\\left(\\frac{11}{22}\\right)^{2}\\right] =2\\left[\\frac{5}{11}-\\frac{1}{4}\\right] =2\\left[\\frac{20}{44}-\\frac{11}{44}\\right] =2\\cdot\\frac{9}{44} =\\frac{9}{22}$$.\n\nPartition B: Community 1 $=\\{P1,P2,P3\\}$, Community 2 $=\\{P4,P5,P6,P7,P8\\}$.\n- For Community 1, internal edges are $(P1,P2),(P1,P3),(P2,P3)$, hence $L_{1}=3$. The degree sum is $D_{1}=\\deg(P1)+\\deg(P2)+\\deg(P3)=2+3+3=8$.\n- For Community 2, internal edges are $(P4,P5),(P5,P6),(P5,P7),(P6,P7),(P6,P8),(P7,P8)$, hence $L_{2}=6$. The degree sum is $D_{2}=\\deg(P4)+\\deg(P5)+\\deg(P6)+\\deg(P7)+\\deg(P8)=3+3+3+3+2=14$.\n\nThus,\n$$Q_{B}=\\left[\\frac{3}{11}-\\left(\\frac{8}{22}\\right)^{2}\\right]+\\left[\\frac{6}{11}-\\left(\\frac{14}{22}\\right)^{2}\\right] =\\left[\\frac{3}{11}-\\frac{16}{121}\\right]+\\left[\\frac{6}{11}-\\frac{49}{121}\\right] =\\left[\\frac{33}{121}-\\frac{16}{121}\\right]+\\left[\\frac{66}{121}-\\frac{49}{121}\\right] =\\frac{17}{121}+\\frac{17}{121} =\\frac{34}{121}$$.\n\nComparing with the options, $Q_{A}=\\frac{9}{22}$ and $Q_{B}=\\frac{34}{121}$ corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "1452201"}, {"introduction": "Having learned to calculate modularity, let's now build a deeper intuition for what the formula truly represents. This exercise uses a controlled thought experiment: you begin with a perfectly modular network and then introduce a single edge that connects two distinct communities. By calculating the precise change in modularity, $\\Delta Q$, you will observe firsthand how the metric penalizes connections that bridge communities, reinforcing its function as a measure of network division quality [@problem_id:1452200].", "problem": "In the study of systems biology, protein-protein interaction networks are often analyzed for modular structures, which can correspond to functional complexes. Consider a simplified model of such a network consisting of 9 proteins, which are partitioned into two distinct communities, $C_1$ and $C_2$.\n\n- Community $C_1$ contains 4 proteins. The interactions are such that every protein in $C_1$ is connected to every other protein in $C_1$, forming a fully connected subgraph (a 4-clique).\n- Community $C_2$ contains the remaining 5 proteins. Similarly, this community forms a 5-clique.\n- Initially, there are no interactions (edges) between any protein in $C_1$ and any protein in $C_2$.\n\nThe modularity, $Q$, of a network partition is a measure of its quality. It is given by the formula:\n$$Q = \\sum_{c} \\left[ \\frac{L_c}{m} - \\left(\\frac{K_c}{2m}\\right)^2 \\right]$$\nwhere the sum is over all communities $c$ in the partition. In this formula:\n- $m$ is the total number of edges in the entire network.\n- $L_c$ is the number of edges with both ends inside community $c$.\n- $K_c$ is the sum of the degrees of all nodes belonging to community $c$.\n\nNow, suppose a new interaction is detected, corresponding to the addition of a single edge between one protein in $C_1$ and one protein in $C_2$. The community assignments of all proteins remain unchanged.\n\nCalculate the change in modularity, $\\Delta Q = Q_{final} - Q_{initial}$, resulting from the addition of this single inter-community edge. Round your final answer to three significant figures.", "solution": "We first compute the initial quantities for the given partition.\n\nFor community $C_{1}$ (a $4$-clique), the number of internal edges is $L_{1} = \\binom{4}{2} = 6$. Each node has internal degree $3$, so the sum of degrees in $C_{1}$ is $K_{1} = 4 \\cdot 3 = 12$.\n\nFor community $C_{2}$ (a $5$-clique), the number of internal edges is $L_{2} = \\binom{5}{2} = 10$. Each node has internal degree $4$, so the sum of degrees in $C_{2}$ is $K_{2} = 5 \\cdot 4 = 20$.\n\nInitially, there are no inter-community edges, so the total number of edges is\n$$m_{\\text{initial}} = L_{1} + L_{2} = 6 + 10 = 16$$,\nand the total degree sum check is $K_{1} + K_{2} = 12 + 20 = 32 = 2 m_{\\text{initial}}$.\n\nThe initial modularity is\n$$Q_{\\text{initial}} = \\left[\\frac{L_{1}}{m_{\\text{initial}}} - \\left(\\frac{K_{1}}{2 m_{\\text{initial}}}\\right)^{2}\\right] + \\left[\\frac{L_{2}}{m_{\\text{initial}}} - \\left(\\frac{K_{2}}{2 m_{\\text{initial}}}\\right)^{2}\\right] = \\left[\\frac{6}{16} - \\left(\\frac{12}{32}\\right)^{2}\\right] + \\left[\\frac{10}{16} - \\left(\\frac{20}{32}\\right)^{2}\\right].$$\nCompute each term:\n$$\\frac{6}{16} = \\frac{3}{8}, \\quad \\left(\\frac{12}{32}\\right)^{2} = \\left(\\frac{3}{8}\\right)^{2} = \\frac{9}{64}, \\quad \\frac{10}{16} = \\frac{5}{8}, \\quad \\left(\\frac{20}{32}\\right)^{2} = \\left(\\frac{5}{8}\\right)^{2} = \\frac{25}{64}.$$\nThus\n$$Q_{\\text{initial}} = \\left(\\frac{3}{8} - \\frac{9}{64}\\right) + \\left(\\frac{5}{8} - \\frac{25}{64}\\right) = \\left(\\frac{24}{64} - \\frac{9}{64}\\right) + \\left(\\frac{40}{64} - \\frac{25}{64}\\right) = \\frac{15}{64} + \\frac{15}{64} = \\frac{30}{64} = \\frac{15}{32}.$$\n\nNow add one inter-community edge between a node in $C_{1}$ and a node in $C_{2}$. Internal edges remain unchanged: $L_{1}' = 6$, $L_{2}' = 10$. The total number of edges increases by one:\n$$m_{\\text{final}} = 16 + 1 = 17.$$\nThe sum of degrees in each community increases by one due to the new inter-community edge:\n$$K_{1}' = 12 + 1 = 13, \\quad K_{2}' = 20 + 1 = 21$$,\nand indeed $K_{1}' + K_{2}' = 34 = 2 m_{\\text{final}}$.\n\nThe final modularity is\n$$Q_{\\text{final}} = \\left[\\frac{L_{1}'}{m_{\\text{final}}} - \\left(\\frac{K_{1}'}{2 m_{\\text{final}}}\\right)^{2}\\right] + \\left[\\frac{L_{2}'}{m_{\\text{final}}} - \\left(\\frac{K_{2}'}{2 m_{\\text{final}}}\\right)^{2}\\right] = \\left[\\frac{6}{17} - \\left(\\frac{13}{34}\\right)^{2}\\right] + \\left[\\frac{10}{17} - \\left(\\frac{21}{34}\\right)^{2}\\right].$$\nCombine terms:\n$$\\frac{6}{17} + \\frac{10}{17} = \\frac{16}{17}, \\quad \\left(\\frac{13}{34}\\right)^{2} + \\left(\\frac{21}{34}\\right)^{2} = \\frac{169 + 441}{1156} = \\frac{610}{1156}.$$\nSince $\\frac{16}{17} = \\frac{1088}{1156}$, we have\n$$Q_{\\text{final}} = \\frac{1088}{1156} - \\frac{610}{1156} = \\frac{478}{1156} = \\frac{239}{578}.$$\n\nTherefore, the change in modularity is\n$$\\Delta Q = Q_{\\text{final}} - Q_{\\text{initial}} = \\frac{239}{578} - \\frac{15}{32}.$$\nWith common denominator $9248$ (since $578 = 2 \\cdot 17^{2}$ and $32 = 2^{5}$), this is\n$$\\Delta Q = \\frac{239 \\cdot 16}{9248} - \\frac{15 \\cdot 289}{9248} = \\frac{3824 - 4335}{9248} = -\\frac{511}{9248}.$$\nNumerically, to three significant figures,\n$$\\Delta Q \\approx -0.0553.$$", "answer": "$$\\boxed{-0.0553}$$", "id": "1452200"}, {"introduction": "After identifying a network's community structure, a deeper analysis involves characterizing the roles of individual nodes. Some nodes are central to their own community, while others act as crucial bridges between modules. This problem introduces the *participation coefficient*, a powerful metric for distinguishing \"provincial\" hubs (which are central to one module) from \"connector\" hubs (which link multiple modules), allowing you to classify a protein's function based on its interaction patterns [@problem_id:1452179].", "problem": "In systems biology, cellular functions are often carried out by groups of interacting proteins, which can be modeled as a Protein-Protein Interaction (PPI) network. These networks frequently exhibit a modular structure, where densely connected proteins form communities, or modules, that perform specific biological functions. The role of a protein can be characterized by its pattern of connections.\n\nConsider a small, hypothetical PPI network consisting of 10 proteins: P1, P2, P3, P4, P5, P6, P7, P8, P9, and P10. An analysis has partitioned this network into two distinct functional modules:\n-   Module A: {P1, P2, P3, P4, P5}\n-   Module B: {P6, P7, P8, P9, P10}\n\nThe observed interactions, which are considered undirected, are as follows:\n-   P1 interacts with P2, P3, P4, P6, P7.\n-   P2 interacts with P3, P5.\n-   P3 interacts with P4.\n-   P4 interacts with P5.\n-   P6 interacts with P7, P10.\n-   P7 interacts with P8.\n-   P8 interacts with P9.\n-   P9 interacts with P10.\n\nTo quantify whether a protein primarily interacts within its own module or acts as a bridge between different modules, one can calculate its *participation coefficient*, $P_i$. The participation coefficient for a protein $i$ is defined by the formula:\n$$P_i = 1 - \\sum_{s=1}^{N_M} \\left( \\frac{k_{is}}{k_i} \\right)^2$$\nwhere $k_i$ is the total number of interactions of protein $i$ (its degree), $N_M$ is the total number of modules in the network, and $k_{is}$ is the number of interactions of protein $i$ with proteins in module $s$.\n\nThe protein P1 is a hub due to its relatively high number of connections. To determine whether it functions as a \"provincial\" hub (mostly interacting within its own module) or a \"connector\" hub (linking different modules), calculate the participation coefficient for protein P1.\n\nProvide your answer as a decimal rounded to three significant figures.", "solution": "We have two modules, so set $N_{M}=2$, with module $A=\\{P1,P2,P3,P4,P5\\}$ and module $B=\\{P6,P7,P8,P9,P10\\}$. For protein $P1$, the observed interactions are with $P2,P3,P4,P6,P7$, hence its total degree is\n$$k_{1}=5$$.\nInteractions within module $A$ are with $P2,P3,P4$, so\n$$k_{1A}=3$$,\nand interactions with module $B$ are with $P6,P7$, so\n$$k_{1B}=2$$.\nUsing the participation coefficient definition\n$$P_{1}=1-\\sum_{s=1}^{N_{M}}\\left(\\frac{k_{1s}}{k_{1}}\\right)^{2}=1-\\left[\\left(\\frac{k_{1A}}{k_{1}}\\right)^{2}+\\left(\\frac{k_{1B}}{k_{1}}\\right)^{2}\\right]$$,\nwe substitute the values to obtain\n$$P_{1}=1-\\left[\\left(\\frac{3}{5}\\right)^{2}+\\left(\\frac{2}{5}\\right)^{2}\\right]=1-\\left(\\frac{9}{25}+\\frac{4}{25}\\right)=1-\\frac{13}{25}=\\frac{12}{25}$$.\nConverting to decimal and rounding to three significant figures gives $0.480$.", "answer": "$$\\boxed{0.480}$$", "id": "1452179"}]}