{"hands_on_practices": [{"introduction": "Let's begin by exploring a common and intuitive network motif: a central hub connected to several peripheral nodes. This exercise uses the biologically relevant example of a kinase and its substrates to form a 'star' graph. By calculating three fundamental centrality measures—degree, betweenness, and closeness—for this simple network, we can see how different mathematical definitions of importance can converge to identify the same, unambiguously central protein [@problem_id:1450877]. This serves as a perfect baseline for understanding what centrality aims to capture.", "problem": "In the study of cellular signaling, protein interaction networks are often used to model how information is processed. Consider a simplified signaling motif centered around a specific kinase protein, which we will label as node `K`. This kinase can phosphorylate four distinct substrate proteins, which we will label as nodes `S1`, `S2`, `S3`, and `S4`. An interaction (an edge in the network) exists only if the kinase phosphorylates a substrate. There are no interactions between the substrate proteins themselves. For the purpose of network analysis, these interactions are considered as undirected edges. The network thus consists of five nodes in total (`K`, `S1`, `S2`, `S3`, `S4`).\n\nYour task is to identify the single protein (node) in this network that simultaneously possesses the maximum value for all three of the following centrality measures: degree centrality, betweenness centrality, and closeness centrality.\n\nWhich node satisfies this condition?\n\nA. K\n\nB. S1\n\nC. S2\n\nD. S3\n\nE. A definitive answer cannot be determined from the information provided.", "solution": "Model the signaling motif as an undirected, unweighted star graph $G=(V,E)$ with $V=\\{K,S_{1},S_{2},S_{3},S_{4}\\}$, where $K$ is connected to each $S_{i}$ and there are no edges among the $S_{i}$. The number of nodes is $n=5$.\n\nDegree centrality: For a node $v$, define degree centrality as\n$$\nC_{D}(v)=\\frac{\\deg(v)}{n-1}.\n$$\nCompute degrees: $\\deg(K)=4$ and $\\deg(S_{i})=1$ for each $i\\in\\{1,2,3,4\\}$. Hence\n$$\nC_{D}(K)=\\frac{4}{4}=1,\\quad C_{D}(S_{i})=\\frac{1}{4}.\n$$\nThus $K$ uniquely maximizes degree centrality.\n\nBetweenness centrality: For a node $v$, define\n$$\nC_{B}(v)=\\sum_{\\substack{s\\neq v\\neq t\\\\ st}}\\frac{\\sigma_{st}(v)}{\\sigma_{st}},\n$$\nwhere $\\sigma_{st}$ is the number of shortest paths between $s$ and $t$, and $\\sigma_{st}(v)$ is the number of those paths that pass through $v$. In a star, the only nontrivial pairs are the unordered pairs of distinct leaves; their count is\n$$\n\\binom{4}{2}=6.\n$$\nFor each such pair, the unique shortest path goes through $K$, so for $K$ each term contributes $1$, giving $C_{B}(K)=6$ (or the corresponding normalized maximum). For any leaf $S_{i}$, no shortest path between two other nodes passes through $S_{i}$ (paths between leaves go through $K$, and pairs involving $S_{i}$ as an endpoint are excluded), so $C_{B}(S_{i})=0$. Therefore $K$ uniquely maximizes betweenness centrality.\n\nCloseness centrality: For a node $v$, define\n$$\nC_{C}(v)=\\frac{n-1}{\\sum_{u\\neq v} d(v,u)},\n$$\nwhere $d(v,u)$ is the shortest-path distance. For $K$, $d(K,S_{i})=1$ for all $i$, so\n$$\n\\sum_{u\\neq K} d(K,u)=1+1+1+1=4,\\quad C_{C}(K)=\\frac{4}{4}=1.\n$$\nFor a leaf, say $S_{1}$, distances are $d(S_{1},K)=1$ and $d(S_{1},S_{j})=2$ for $j\\in\\{2,3,4\\}$, hence\n$$\n\\sum_{u\\neq S_{1}} d(S_{1},u)=1+2+2+2=7,\\quad C_{C}(S_{1})=\\frac{4}{7}.\n$$\nThus every leaf has closeness centrality $\\frac{4}{7}$, strictly less than $1=C_{C}(K)$, so $K$ uniquely maximizes closeness centrality.\n\nSince node $K$ uniquely attains the maximum in degree centrality, betweenness centrality, and closeness centrality, the node satisfying the condition is $K$.", "answer": "$$\\boxed{A}$$", "id": "1450877"}, {"introduction": "While some networks have a single, obvious hub, most biological networks are more complex. This practice presents a network where the most connected protein is not the most critical for connecting distant parts of the network [@problem_id:1450881]. This scenario is designed to highlight the crucial difference between degree centrality, which measures local connectivity, and betweenness centrality, which quantifies a node's role as a 'bridge' in global communication pathways. Understanding this distinction is key to correctly interpreting network data.", "problem": "Consider a simplified model of a protein-protein interaction network composed of seven proteins, labeled $P_1$ through $P_7$. The interactions (edges) between them are given by the following set of pairs:\n$$ \\{ (P_1, P_2), (P_2, P_3), (P_3, P_1), (P_3, P_4), (P_4, P_5), (P_5, P_6), (P_6, P_7), (P_7, P_5) \\} $$\nFor this network, determine the protein with the highest degree centrality and the protein with the highest betweenness centrality.\n\nYour answer should be a pair of protein labels, presented as a row matrix. The first element should be the label of the protein with the highest degree centrality, and the second element should be the label of the protein with the highest betweenness centrality. If there is a tie for the highest degree centrality, select the protein with the lower numerical index (e.g., choose $P_3$ over $P_5$).", "solution": "The solution requires calculating two centrality measures for each protein in the network: degree centrality and betweenness centrality.\n\n**Step 1: Calculate Degree Centrality**\n\nDegree centrality of a node (protein) in an undirected network is simply the number of edges connected to it. We can count the occurrences of each protein label in the given edge list.\n\n- **$P_1$**: Appears in $(P_1, P_2)$ and $(P_3, P_1)$. Degree($P_1$) = 2.\n- **$P_2$**: Appears in $(P_1, P_2)$ and $(P_2, P_3)$. Degree($P_2$) = 2.\n- **$P_3$**: Appears in $(P_2, P_3)$, $(P_3, P_1)$, and $(P_3, P_4)$. Degree($P_3$) = 3.\n- **$P_4$**: Appears in $(P_3, P_4)$ and $(P_4, P_5)$. Degree($P_4$) = 2.\n- **$P_5$**: Appears in $(P_4, P_5)$, $(P_5, P_6)$, and $(P_7, P_5)$. Degree($P_5$) = 3.\n- **$P_6$**: Appears in $(P_5, P_6)$ and $(P_6, P_7)$. Degree($P_6$) = 2.\n- **$P_7$**: Appears in $(P_6, P_7)$ and $(P_7, P_5)$. Degree($P_7$) = 2.\n\nThe degrees are:\n$d(P_1)=2$, $d(P_2)=2$, $d(P_3)=3$, $d(P_4)=2$, $d(P_5)=3$, $d(P_6)=2$, $d(P_7)=2$.\n\nThe highest degree is 3, which is shared by $P_3$ and $P_5$. According to the problem's tie-breaking rule, we select the protein with the lower numerical index. Therefore, the protein with the highest degree centrality is $P_3$.\n\n**Step 2: Calculate Betweenness Centrality**\n\nThe un-normalized betweenness centrality $C_B(v)$ of a node $v$ is the sum of the fraction of all-pairs shortest paths that pass through $v$:\n$$ C_B(v) = \\sum_{s \\neq v \\neq t} \\frac{\\sigma_{st}(v)}{\\sigma_{st}} $$\nwhere $\\sigma_{st}$ is the number of shortest paths between nodes $s$ and $t$, and $\\sigma_{st}(v)$ is the number of those paths that pass through $v$.\n\nThe network structure consists of two triangles, $\\{P_1, P_2, P_3\\}$ and $\\{P_5, P_6, P_7\\}$, connected by a bridge path $P_3-P_4-P_5$. Let's call the set of nodes in the first module $M_1 = \\{P_1, P_2, P_3\\}$ and in the second module $M_2 = \\{P_5, P_6, P_7\\}$. The node $P_4$ acts as the sole connector between the modules via $P_3$ and $P_5$.\n\n- **For nodes $P_1, P_2, P_6, P_7$:** These nodes are on the periphery of the network. Any shortest path between two other nodes will not pass through them. For example, the shortest path between $P_2$ and $P_4$ is $P_2-P_3-P_4$, which bypasses $P_1$. Thus, their betweenness centrality is 0.\n$C_B(P_1) = 0$, $C_B(P_2) = 0$, $C_B(P_6) = 0$, $C_B(P_7) = 0$.\n\n- **For node $P_4$:** This node lies on every shortest path between any node in $M_1$ and any node in $M_2$. There are $3 \\times 3 = 9$ such pairs of nodes. For each pair, the shortest path is unique. For example, the shortest path from $P_1$ to $P_6$ is $P_1-P_3-P_4-P_5-P_6$. $P_4$ contributes 1 to the betweenness sum for each of these 9 paths.\n$C_B(P_4) = 9$.\n\n- **For node $P_3$:** This node acts as a gateway for $P_1$ and $P_2$ to the rest of the network. Any shortest path from $\\{P_1, P_2\\}$ to $\\{P_4, P_5, P_6, P_7\\}$ must pass through $P_3$.\nNumber of nodes in $\\{P_1, P_2\\}$ is 2.\nNumber of nodes in $\\{P_4, P_5, P_6, P_7\\}$ is 4.\nThe number of such unique shortest paths is $2 \\times 4 = 8$. For each of these, $P_3$ lies on the path. For example, the path from $P_1$ to $P_7$ is $P_1-P_3-P_4-P_5-P_7$.\n$C_B(P_3) = 8$.\n\n- **For node $P_5$:** By symmetry with $P_3$, this node is the gateway for $P_6$ and $P_7$ to the rest of the network. Any shortest path from $\\{P_6, P_7\\}$ to $\\{P_1, P_2, P_3, P_4\\}$ must pass through $P_5$.\nNumber of nodes in $\\{P_6, P_7\\}$ is 2.\nNumber of nodes in $\\{P_1, P_2, P_3, P_4\\}$ is 4.\nThe number of such unique shortest paths is $2 \\times 4 = 8$.\n$C_B(P_5) = 8$.\n\nThe betweenness centralities are:\n$C_B(P_1)=0$, $C_B(P_2)=0$, $C_B(P_3)=8$, $C_B(P_4)=9$, $C_B(P_5)=8$, $C_B(P_6)=0$, $C_B(P_7)=0$.\n\nThe highest betweenness centrality is 9, which belongs to node $P_4$.\n\n**Step 3: Final Answer**\n\n- The protein with the highest degree centrality is $P_3$.\n- The protein with the highest betweenness centrality is $P_4$.\n\nThe final answer is the pair $(P_3, P_4)$.", "answer": "$$ \\boxed{ \\begin{pmatrix} P_3  P_4 \\end{pmatrix} } $$", "id": "1450881"}, {"introduction": "Standard centrality metrics provide a powerful starting point, but they can sometimes be blunt instruments. This advanced problem moves beyond simple application and asks you to think critically about the limitations of a metric like betweenness centrality [@problem_id:1450865]. By engaging with a hypothetical scenario that introduces a novel index to account for path redundancy, you will learn to appreciate how new metrics can be designed to probe more nuanced biological questions, such as identifying the most fragile points in a network.", "problem": "In systems biology, network analysis of protein-protein interaction (PPI) maps is crucial for identifying key proteins. A common metric is betweenness centrality, $C_B(v)$, which quantifies how often a protein $v$ lies on a shortest communication path between other proteins. It is defined as:\n$$C_B(v) = \\sum_{s \\neq v \\neq t} \\frac{\\sigma_{st}(v)}{\\sigma_{st}}$$\nwhere the sum is over all ordered pairs of distinct proteins $(s, t)$, $\\sigma_{st}$ is the total number of shortest paths between $s$ and $t$, and $\\sigma_{st}(v)$ is the number of those shortest paths that pass through $v$. Proteins are treated as nodes and interactions as unweighted, undirected edges. Note that for an undirected graph, the sum is often taken over unordered pairs $s  t$, which differs by a factor of 2. For this problem, we will use the formulation given above, summing over all ordered pairs.\n\nWhile a high $C_B$ value indicates importance, it can be a blunt instrument. Two proteins might have identical $C_B$ values but vastly different roles as single points of failure. To distinguish them, we introduce a novel metric, the Path Brittleness Index (PBI). The PBI of a protein $v$, denoted $PBI(v)$, is designed to more heavily weight contributions from paths for which $v$ is an unavoidable bottleneck. It is defined as:\n$$PBI(v) = \\sum_{s \\neq v \\neq t} \\frac{\\sigma_{st}(v)}{(\\sigma_{st})^2}$$\nConsider two proteins in a large PPI network, $P_A$ and $P_B$, which have been found to have identical standard betweenness centrality values: $C_B(P_A) = C_B(P_B) = 3.0$. A detailed analysis of the shortest path structure reveals the following:\n\n- The betweenness centrality of $P_A$ arises from its role in mediating paths for two specific pairs of proteins, $\\{s_1, t_1\\}$ and $\\{s_2, t_2\\}$.\n- For the pair $\\{s_1, t_1\\}$, there is only one shortest path between them, and it passes through $P_A$. Thus, $\\sigma_{s_1t_1} = 1$ and $\\sigma_{s_1t_1}(P_A) = 1$.\n- For the pair $\\{s_2, t_2\\}$, there are two distinct shortest paths between them, one of which passes through $P_A$. Thus, $\\sigma_{s_2t_2} = 2$ and $\\sigma_{s_2t_2}(P_A) = 1$.\n\n- The betweenness centrality of $P_B$ arises from its role in mediating paths for three specific pairs of proteins, $\\{s_3, t_3\\}$, $\\{s_4, t_4\\}$, and $\\{s_5, t_5\\}$.\n- For the pair $\\{s_3, t_3\\}$, there are three shortest paths, one of which passes through $P_B$. Thus, $\\sigma_{s_3t_3} = 3$ and $\\sigma_{s_3t_3}(P_B) = 1$.\n- For the pair $\\{s_4, t_4\\}$, there are three shortest paths, two of which pass through $P_B$. Thus, $\\sigma_{s_4t_4} = 3$ and $\\sigma_{s_4t_4}(P_B) = 2$.\n- For the pair $\\{s_5, t_5\\}$, there are four shortest paths, two of which pass through $P_B$. Thus, $\\sigma_{s_5t_5} = 4$ and $\\sigma_{s_5t_5}(P_B) = 2$.\n\nFor all other pairs of proteins in the network, the number of shortest paths passing through either $P_A$ or $P_B$ is zero.\n\nBased on this information, calculate the ratio $\\frac{PBI(P_A)}{PBI(P_B)}$ to determine which protein is more critical according to this new measure. A higher PBI indicates greater brittleness and thus, higher criticality. Round your final answer to four significant figures.", "solution": "We use the Path Brittleness Index definition over ordered pairs:\n$$PBI(v) = \\sum_{s \\neq v \\neq t} \\frac{\\sigma_{st}(v)}{\\left(\\sigma_{st}\\right)^{2}}.$$\nFor an undirected graph, each unordered pair contributes twice (once for each direction). This factor of $2$ applies uniformly to both $PBI(P_A)$ and $PBI(P_B)$, so the ratio $\\frac{PBI(P_A)}{PBI(P_B)}$ is invariant to whether we count ordered or unordered pairs. We will compute using ordered pairs as specified.\n\nFor $P_A$, contributions come only from $\\{s_{1},t_{1}\\}$ and $\\{s_{2},t_{2}\\}$:\n- For $\\{s_{1},t_{1}\\}$, $\\sigma_{s_{1}t_{1}} = 1$ and $\\sigma_{s_{1}t_{1}}(P_A) = 1$. The contribution from each of the two ordered pairs is $\\frac{1}{1^{2}} = 1$, for a total contribution of $2$.\n- For $\\{s_{2},t_{2}\\}$, $\\sigma_{s_{2}t_{2}} = 2$ and $\\sigma_{s_{2}t_{2}}(P_A) = 1$. The total contribution from both ordered pairs is $2 \\times \\frac{1}{2^2} = \\frac{1}{2}$.\nTherefore,\n$$PBI(P_A) = 2 + \\frac{1}{2} = \\frac{5}{2}.$$\n\nFor $P_B$, contributions come only from $\\{s_{3},t_{3}\\}$, $\\{s_{4},t_{4}\\}$, and $\\{s_{5},t_{5}\\}$:\n- For $\\{s_{3},t_{3}\\}$, $\\sigma_{s_{3}t_{3}} = 3$ and $\\sigma_{s_{3}t_{3}}(P_B) = 1$. The total contribution from both ordered pairs is $2 \\times \\frac{1}{3^2} = \\frac{2}{9}$.\n- For $\\{s_{4},t_{4}\\}$, $\\sigma_{s_{4}t_{4}} = 3$ and $\\sigma_{s_{4}t_{4}}(P_B) = 2$. The total contribution from both ordered pairs is $2 \\times \\frac{2}{3^2} = \\frac{4}{9}$.\n- For $\\{s_{5},t_{5}\\}$, $\\sigma_{s_{5}t_{5}} = 4$ and $\\sigma_{s_{5}t_5}(P_B) = 2$. The total contribution from both ordered pairs is $2 \\times \\frac{2}{4^2} = \\frac{1}{4}$.\nTherefore,\n$$PBI(P_B) = \\frac{2}{9} + \\frac{4}{9} + \\frac{1}{4} = \\frac{6}{9} + \\frac{1}{4} = \\frac{2}{3} + \\frac{1}{4} = \\frac{11}{12}.$$\n\nThe ratio is\n$$\\frac{PBI(P_A)}{PBI(P_B)} = \\frac{\\frac{5}{2}}{\\frac{11}{12}} = \\frac{5}{2} \\cdot \\frac{12}{11} = \\frac{30}{11} \\approx 2.727272\\ldots.$$\nRounding to four significant figures gives $2.727$.", "answer": "$$\\boxed{2.727}$$", "id": "1450865"}]}