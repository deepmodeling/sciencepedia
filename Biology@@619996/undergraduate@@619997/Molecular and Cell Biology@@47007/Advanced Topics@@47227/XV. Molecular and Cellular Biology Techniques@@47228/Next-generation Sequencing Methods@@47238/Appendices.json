{"hands_on_practices": [{"introduction": "The foundation of any high-quality genomics study is the accuracy of its raw sequencing data. Next-Generation Sequencing platforms report this accuracy on a per-base level using the Phred quality score, or $Q$ score. This exercise will help you translate the logarithmic Phred scale into a tangible error probability, a crucial first step in data quality control [@problem_id:2326400].", "problem": "In bioinformatics, Next-Generation Sequencing (NGS) technologies generate vast amounts of DNA sequence data. A crucial part of this process is assessing the quality of each base call (i.e., identifying whether a base is an A, C, G, or T). The Phred quality score, denoted by $Q$, is a widely used metric that quantifies the probability of an incorrect base call. This score is defined by the formula:\n$$Q = -10 \\log_{10}(P)$$\nwhere $P$ is the probability that the base call is incorrect.\n\nA common quality threshold used in sequencing analysis is a Phred score of 30, often referred to as $Q30$. If a specific base in a DNA sequence is assigned a Phred quality score of $Q=30$, what is the corresponding probability that this base call is an error? Express your answer as a decimal.", "solution": "The problem provides the relationship between the Phred quality score, $Q$, and the probability of an incorrect base call, $P$. The formula given is:\n$$Q = -10 \\log_{10}(P)$$\n\nWe are given a Phred score of $Q=30$ and asked to find the corresponding error probability, $P$. To do this, we need to rearrange the formula to solve for $P$.\n\nFirst, we substitute the given value of $Q$ into the equation:\n$$30 = -10 \\log_{10}(P)$$\n\nNext, we isolate the logarithm term. We can do this by dividing both sides of the equation by $-10$:\n$$\\frac{30}{-10} = \\log_{10}(P)$$\n$$-3 = \\log_{10}(P)$$\n\nNow, to solve for $P$, we need to convert this logarithmic equation into its equivalent exponential form. The definition of a base-10 logarithm is that if $y = \\log_{10}(x)$, then $x = 10^y$. Applying this to our equation, where $y = -3$ and $x = P$, we get:\n$$P = 10^{-3}$$\n\nFinally, we express this value as a decimal.\n$$P = \\frac{1}{10^{3}} = \\frac{1}{1000} = 0.001$$\n\nThus, a Phred quality score of $Q30$ corresponds to a 1 in 1000 chance of an incorrect base call, or an error probability of $0.001$.", "answer": "$$\\boxed{0.001}$$", "id": "2326400"}, {"introduction": "Beyond the quality of individual bases, the overall health of a sequencing library is critical for reliable results. In techniques like ChIP-seq, insufficient starting material can lead to over-amplification of a few DNA fragments, creating a \"low-complexity\" library with many PCR duplicates. This practice demonstrates how to calculate and interpret the PCR duplication rate, a key metric for diagnosing issues in the experimental workflow [@problem_id:2326389].", "problem": "In molecular biology, Chromatin Immunoprecipitation followed by sequencing (ChIP-seq) is a powerful method used to identify the binding sites of DNA-associated proteins. The process involves isolating specific protein-DNA complexes, and the captured DNA is then prepared into a sequencing library. A critical step in library preparation is Polymerase Chain Reaction (PCR) amplification, which generates enough material for Next-Generation Sequencing (NGS).\n\nThe initial amount of unique DNA fragments captured during immunoprecipitation determines the \"complexity\" of the library. If the initial immunoprecipitation yields a very small amount of DNA, the library will have low complexity. Consequently, the PCR step will excessively amplify the few starting fragments, leading to a high proportion of identical reads in the final sequencing data. These identical reads are known as \"PCR duplicates\" and are computationally removed before downstream analysis, as they do not represent independent biological events.\n\nA researcher performs two ChIP-seq experiments.\n- **Library A** is prepared from a control sample with an adequate amount of immunoprecipitated DNA. Sequencing of this library produced a total of $5.00 \\times 10^7$ reads. After a standard deduplication procedure, $4.25 \\times 10^7$ unique reads remained.\n- **Library B** is prepared from an experimental sample where the researcher suspects the immunoprecipitation step yielded a suboptimal, low amount of DNA. Sequencing of this library produced a total of $6.00 \\times 10^7$ reads. After deduplication, only $1.80 \\times 10^7$ unique reads remained.\n\nThe PCR duplication rate is a key quality metric, defined as the fraction of the total reads that are identified as PCR duplicates. To quantify how much worse the library quality is for the experimental sample, calculate the ratio of the PCR duplication rate of Library B to the PCR duplication rate of Library A. Report your answer as a single real number, rounded to two significant figures.", "solution": "The PCR duplication rate for a library with total reads $T$ and unique reads $U$ is defined as\n$$r=\\frac{T-U}{T}=1-\\frac{U}{T}.$$\n\nFor Library A, with $T_{A}=5.00 \\times 10^{7}$ and $U_{A}=4.25 \\times 10^{7}$,\n$$r_{A}=1-\\frac{U_{A}}{T_{A}}=1-\\frac{4.25 \\times 10^{7}}{5.00 \\times 10^{7}}=1-0.85=0.15.$$\n\nFor Library B, with $T_{B}=6.00 \\times 10^{7}$ and $U_{B}=1.80 \\times 10^{7}$,\n$$r_{B}=1-\\frac{U_{B}}{T_{B}}=1-\\frac{1.80 \\times 10^{7}}{6.00 \\times 10^{7}}=1-0.30=0.70.$$\n\nThe ratio of duplication rates is\n$$\\frac{r_{B}}{r_{A}}=\\frac{0.70}{0.15}=\\frac{70}{15}=\\frac{14}{3}\\approx 4.666\\ldots,$$\nwhich, rounded to two significant figures, is $4.7$.", "answer": "$$\\boxed{4.7}$$", "id": "2326389"}, {"introduction": "Perhaps one of the most critical challenges in any large-scale sequencing project is ensuring sample integrity and preventing cross-contamination. This exercise puts you in the role of a data detective, using known genetic variations—Single Nucleotide Polymorphisms (SNPs)—as unique fingerprints. You will learn how to analyze sequencing reads at informative SNP loci to detect and quantify the level of contamination from an unintended source, a vital skill for ensuring the validity of genomic data [@problem_id:2326372].", "problem": "A genomics research facility is conducting Whole-Genome Sequencing (WGS), a comprehensive method for analyzing entire genomes. A technician prepares a DNA library from a sample provided by a primary subject, denoted as Subject P. However, there is a concern that during sample handling, a small amount of DNA from another individual, Subject C, may have been accidentally introduced, leading to cross-contamination. Fortunately, both Subject P and Subject C have previously been genotyped for a set of known Single Nucleotide Polymorphisms (SNPs), which are variations at a single position in a DNA sequence.\n\nAfter sequencing the potentially contaminated sample, the resulting reads are aligned to the human reference genome. The read counts for specific alleles at four different SNP loci are recorded. The table below provides the known genotypes for Subject P and Subject C, along with the sequencing read counts observed at each locus from the mixed sample.\n\n| Locus ID | Genotype of Subject P | Genotype of Subject C | Allele 1 Read Count | Allele 2 Read Count |\n| :--- | :--- | :--- | :--- | :--- |\n| rs1801133 | G/G | A/A | G: 212 | A: 24 |\n| rs429358 | T/T | C/C | T: 185 | C: 20 |\n| rs7412 | C/T | C/C | C: 245 | T: 81 |\n| rs121912631| A/A | G/G | A: 251 | G: 28 |\n\nYour task is to determine the extent of the contamination. Calculate the proportion of sequencing reads in the sample that originates from the contaminating individual, Subject C. Base your calculation only on the loci that are unambiguously informative for distinguishing between the two subjects. Express your final answer as a decimal, rounded to three significant figures.", "solution": "Let $f$ denote the proportion of sequencing reads originating from the contaminant (Subject C). For any SNP where Subject P and Subject C are homozygous for different alleles, the contaminant-specific allele is unique to Subject C, and the expected fraction of reads carrying that allele equals $f$ (assuming negligible sequencing error and no allele-specific bias). If at such a locus the total read count is $n$ and the contaminant-allele count is $y$, then $y \\sim \\text{Binomial}(n,f)$ and the maximum-likelihood estimate is $\\hat{f}=\\frac{y}{n}$. Across multiple independent informative loci, the joint MLE is the ratio of the sum of contaminant-allele counts to the sum of total counts:\n$$\n\\hat{f}=\\frac{\\sum_{i} y_{i}}{\\sum_{i} n_{i}}.\n$$\n\nIdentify unambiguously informative loci as those where P and C are homozygous for different alleles:\n- rs1801133: P G/G, C A/A; counts: G: 212, A: 24. Here $y_{1}=24$, $n_{1}=212+24=236$.\n- rs429358: P T/T, C C/C; counts: T: 185, C: 20. Here $y_{2}=20$, $n_{2}=185+20=205$.\n- rs121912631: P A/A, C G/G; counts: A: 251, G: 28. Here $y_{3}=28$, $n_{3}=251+28=279$.\n\nThe locus rs7412 (P C/T, C C/C; counts C: 245, T: 81) is not unambiguously informative because both individuals share allele C; therefore it is excluded per the instruction to use only unambiguously informative loci.\n\nSum the informative counts:\n$$\n\\sum_{i} y_{i}=24+20+28=72,\\quad \\sum_{i} n_{i}=236+205+279=720.\n$$\nThus,\n$$\n\\hat{f}=\\frac{72}{720}=0.1.\n$$\n\nRounded to three significant figures, the contamination proportion is $0.100$.", "answer": "$$\\boxed{0.100}$$", "id": "2326372"}]}