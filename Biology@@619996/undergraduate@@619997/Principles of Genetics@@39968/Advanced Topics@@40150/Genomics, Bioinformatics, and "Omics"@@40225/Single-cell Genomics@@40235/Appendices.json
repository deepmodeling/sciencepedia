{"hands_on_practices": [{"introduction": "Single-cell RNA sequencing experiments generate massive datasets, but a crucial first step is to ensure data quality. Not every data point corresponds to a healthy, intact cell; many represent \"empty droplets\" containing only stray background noise. This exercise focuses on the fundamental task of quality control, guiding you to use simple but powerful metrics like UMI and gene counts to distinguish high-quality cellular data from low-quality noise, a critical skill for any analysis [@problem_id:1520761].", "problem": "In a typical droplet-based single-cell RNA sequencing (scRNA-seq) experiment, a suspension of cells is partitioned into millions of tiny oil droplets. Each droplet is designed to contain a single cell and a single microbead. Each bead is covered with millions of copies of a unique DNA sequence, known as a \"barcode,\" which allows all RNA molecules from a single droplet to be tagged and later traced back to their origin. Furthermore, each captured RNA molecule is tagged with a Unique Molecular Identifier (UMI), a short random sequence that allows researchers to count the absolute number of original RNA transcripts, preventing overcounting due to amplification during the sequencing process.\n\nA critical challenge in analyzing scRNA-seq data is distinguishing between droplets that successfully captured a viable cell and \"empty droplets\" that failed to capture a cell but may contain small amounts of ambient RNA from lysed cells in the initial suspension.\n\nA researcher performs an scRNA-seq experiment and obtains a data summary for four representative barcodes. For each barcode, the analysis pipeline reports the total number of UMIs counted and the total number of distinct genes detected from those UMIs. The summary is as follows:\n\n*   **Barcode GATC:** A total of 12,540 UMIs were detected, corresponding to 3,150 distinct genes.\n*   **Barcode CCTA:** A total of 9,880 UMIs were detected, corresponding to 2,890 distinct genes.\n*   **Barcode TGAN:** A total of 150 UMIs were detected, corresponding to 85 distinct genes.\n*   **Barcode AGCT:** A total of 11,060 UMIs were detected, corresponding to 3,010 distinct genes.\n\nBased on this information, which barcode most likely represents an empty droplet?\n\nA. GATC\n\nB. CCTA\n\nC. TGAN\n\nD. AGCT", "solution": "We denote by $U$ the total number of unique molecular identifiers (UMIs) detected for a barcode and by $G$ the total number of distinct genes observed from those UMIs. In droplet-based scRNA-seq, a droplet containing a viable single cell typically exhibits a high $U$ and a high $G$, reflecting the cellular RNA content. In contrast, an empty droplet predominantly captures low and sparse ambient RNA, leading to much smaller $U$ and $G$. This is the central principle used by knee/inflection methods and ambient-RNA-aware tests: droplets with orders-of-magnitude lower $U$ and correspondingly low $G$ are classified as empty.\n\nApplying this criterion to the four barcodes:\n- GATC: $U=12540$, $G=3150$\n- CCTA: $U=9880$, $G=2890$\n- TGAN: $U=150$, $G=85$\n- AGCT: $U=11060$, $G=3010$\n\nThe three barcodes GATC, CCTA, and AGCT have large $U$ on the order of $10^{4}$ and large $G$ on the order of $10^{3}$, consistent with droplets containing single cells. The barcode TGAN has $U=150$ and $G=85$, which are orders of magnitude smaller than the others and characteristic of ambient background. Therefore, TGAN most likely represents an empty droplet.", "answer": "$$\\boxed{C}$$", "id": "1520761"}, {"introduction": "Once we have a clean dataset of high-quality cells, the next challenge is to uncover the biological stories hidden within. This practice introduces one of the most powerful visualization tools in single-cell genomics: Uniform Manifold Approximation and Projection (UMAP). You will learn how to interpret these plots, where thousands of cells are organized based on their gene expression similarity, and how overlaying specific gene activity can reveal \"marker genes\" that define distinct cell types [@problem_id:1520807].", "problem": "A team of developmental biologists is studying a tissue sample from a mouse embryo using single-cell RNA sequencing (scRNA-seq), a technique that measures the gene expression profile of thousands of individual cells. After processing the data, they use a dimensionality reduction algorithm called Uniform Manifold Approximation and Projection (UMAP) to visualize the data. In the resulting UMAP plot, each point represents a single cell, and cells with similar overall gene expression patterns are positioned close to one another.\n\nThis analysis identifies five distinct clusters of cells, which are hypothesized to represent different cell types present in the embryonic tissue. To characterize these clusters, a researcher overlays the expression level of a specific gene, *Fgf8*, onto the UMAP plot. They observe that the cells in one of the five clusters show uniformly high expression of *Fgf8*, while the cells in the other four clusters show little to no expression of this gene.\n\nBased solely on this observation, what is the most accurate scientific conclusion?\n\nA. *Fgf8* is a marker gene for the cell population represented by the high-expression cluster.\n\nB. The protein encoded by *Fgf8* is the most critical protein for the survival of all cells in the tissue.\n\nC. The expression of *Fgf8* is the direct cause for the formation of that specific cell cluster during the UMAP analysis.\n\nD. The UMAP visualization is flawed, as functionally important genes like *Fgf8* are expected to be expressed in all cell types.\n\nE. Every cell within the high-expression cluster transcribes the *Fgf8* gene at the exact same rate.", "solution": "1. Establish the data type and visualization principle: Single-cell RNA sequencing measures per-cell transcript abundances across many genes, generating a high-dimensional expression matrix. Dimensionality reduction methods such as UMAP embed cells in a low-dimensional space so that cells with similar global transcriptomic profiles are positioned near each other. Thus, clusters in UMAP reflect similarity in overall gene expression patterns, not necessarily the action of any single gene.\n\n2. Interpret the overlay of a single gene’s expression: Overlaying the expression of a specific gene across the UMAP indicates where that gene is relatively enriched. The observation given is that one cluster shows uniformly high expression of Fgf8, while four other clusters show little to no expression. This indicates that Fgf8 expression is specifically associated with the cells in that cluster within the dataset.\n\n3. Define the concept of a marker gene: A marker gene is operationally defined as a gene whose expression is specific to, or substantially enriched in, a particular cell population relative to others, enabling identification of that population. The observation that Fgf8 is high in one cluster and low or absent in others is consistent with Fgf8 serving as a marker for that population in this dataset.\n\n4. Evaluate alternative interpretations against the principles:\n- Against B: From transcript abundance patterns alone, one cannot conclude anything about the protein’s criticality for survival of all cells. Moreover, the gene is minimally expressed in four clusters, arguing against a universal survival role inferred from this dataset.\n- Against C: UMAP is an unsupervised method based on global expression similarity; while Fgf8 contributes to the overall profile, it is not justified to claim that its expression is the direct cause of the cluster formation.\n- Against D: The expectation that functionally important genes must be expressed in all cell types is incorrect; many genes have restricted, lineage- or state-specific expression. The visualization is not flawed on this basis.\n- Against E: A “uniformly high” appearance on a color scale does not imply identical transcription rates across all cells; scRNA-seq data are noisy and typically visualizations use thresholds or continuous scales that can mask cell-to-cell variability.\n\n5. Conclusion: The most accurate conclusion based solely on the observation is that Fgf8 can be used as a marker gene for the cell population represented by the high-expression cluster in this analysis, aligning with option A.", "answer": "$$\\boxed{A}$$", "id": "1520807"}, {"introduction": "Beyond simply identifying cell types, a primary goal of many single-cell studies is to understand how cells change in response to stimuli, such as a drug treatment. This requires comparing gene expression between groups, a task that demands statistical rigor. This final practice challenges the common impulse to use simple statistical tests, forcing a deeper consideration of the unique properties of single-cell data and revealing why specialized methods are essential for drawing valid scientific conclusions [@problem_id:1520754].", "problem": "A team of immunologists is investigating the effect of a novel drug, 'Immunomodulin', on the cellular composition of the spleen. They use single-cell RNA sequencing (scRNA-seq) to compare splenocytes from two groups of mice: one group treated with Immunomodulin and a control group treated with a placebo. After data processing, computational analysis identifies several distinct cell clusters. The team focuses on a specific cluster identified as 'Follicular Helper T cells' (Tfh).\n\nTheir goal is to identify genes that are differentially expressed within the Tfh cell cluster between the treated and control groups. A junior analyst proposes a straightforward approach: for each gene, calculate the average expression count across all Tfh cells in the treated group and compare it to the average expression count across all Tfh cells in the control group using a standard two-sample t-test.\n\nHowever, a senior bioinformatician immediately points out that this approach is statistically inappropriate for scRNA-seq data. Which of the following statements provides the most fundamental and critical statistical reason why simply comparing the mean expression counts with a t-test is invalid for this type of data?\n\nA. The process of dissociating the spleen tissue into single cells introduces significant mechanical stress, leading to random gene expression artifacts that cannot be modeled by a t-test.\n\nB. The total number of cells captured in the Tfh cluster might be different between the treated and control groups, violating the equal sample size assumption of the t-test.\n\nC. The expression data for any given gene within a cluster are not normally distributed; they are discrete counts characterized by a high proportion of zero values and high variance (overdispersion), which violates the core assumptions of the t-test.\n\nD. The computational algorithm used to assign cells to the 'Follicular Helper T cells' cluster might have misclassified some cells, introducing noise from other cell types into the analysis.\n\nE. The sequencing experiments for the treated and control groups were run on different days, introducing a technical batch effect that confounds the comparison of mean expression values.", "solution": "We formalize the junior analyst’s proposal as follows: for each gene, within the Tfh cluster, let the treated group observations be $X_{1j}$ for $j=1,\\dots,n_{1}$ and the control group observations be $X_{2k}$ for $k=1,\\dots,n_{2}$, where each $X$ is the expression count per cell. The intended hypothesis test is\n$$\nH_{0}:\\mu_{1}=\\mu_{2} \\quad \\text{versus} \\quad H_{A}:\\mu_{1}\\neq\\mu_{2},\n$$\nimplemented via a two-sample $t$-test with test statistic of the Welch form\n$$\nt=\\frac{\\bar{X}_{1}-\\bar{X}_{2}}{\\sqrt{\\frac{s_{1}^{2}}{n_{1}}+\\frac{s_{2}^{2}}{n_{2}}}},\n$$\nwhere $\\bar{X}_{i}$ and $s_{i}^{2}$ are the sample mean and variance in group $i$.\n\nThe two-sample $t$-test (standard or Welch) relies critically on distributional assumptions: observations within each group are independent and identically distributed with approximately normal errors and continuous support, and the sampling distribution of the standardized mean difference follows a $t$-distribution under $H_{0}$. Welch’s version relaxes the equal-variance assumption but still requires approximate normality of group means based on underlying data that are not severely non-normal, particularly not highly discrete with point masses and strong mean-variance coupling.\n\nFor scRNA-seq counts, for any given gene within a cell type, the data $X_{ij}$ are discrete nonnegative integers with a high proportion of zeros due to biological sparsity and technical dropouts, and they exhibit overdispersion, i.e.,\n$$\n\\operatorname{Var}(X_{ij}) \\gg \\mathbb{E}[X_{ij}],\n$$\nrelative to a Poisson baseline, often requiring negative binomial or zero-inflated models. This distribution is far from normal and has heteroskedasticity driven by the mean-variance relationship inherent to counts. Consequently, the core distributional assumptions of the two-sample $t$-test (normality and suitable error structure for the $t$-reference) are violated for raw scRNA-seq count data, making a simple comparison of means via a $t$-test statistically invalid.\n\nAddressing the distractors: unequal sample sizes (B) do not invalidate Welch’s $t$-test; batch effects (E), misclassification (D), and dissociation artifacts (A) are important practical concerns but are not the fundamental distributional reason that renders a $t$-test on raw counts inappropriate. The most critical and fundamental reason is the non-normal, zero-inflated, overdispersed, discrete nature of scRNA-seq counts, captured by option C.", "answer": "$$\\boxed{C}$$", "id": "1520754"}]}