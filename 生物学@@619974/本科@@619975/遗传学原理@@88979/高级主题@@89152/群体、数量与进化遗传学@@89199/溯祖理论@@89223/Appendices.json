{"hands_on_practices": [{"introduction": "在我们深入研究溯祖理论的数学模型之前，首先建立一个关于其核心概念——谱系树——的直观理解是至关重要的。这个练习将引导你完成一个思想实验，在一个预先设定的家谱上追溯等位基因的祖先。通过这个实践，你将学会如何解读溯祖树，并准确地找出任何给定样本子集的“最近公共祖先”（MRCA），为你后续理解更复杂的概率计算打下坚实的基础 [@problem_id:1477288]。", "problem": "在种群遗传学领域，溯祖过程通过向后追溯一个个体样本的祖先来描述它们之间的谱系关系。考虑从单一群体中抽取的五个基因等位基因样本，分别标记为 A、B、C、D 和 E。这些等位基因的一个特定谱系历史（一个溯祖树）已经被确定，其溯祖事件序列如下。每个事件的时间以距离现在的世代数来衡量。\n\n1.  在时间 $T_1$ 时，等位基因 A 和 B 合并成一个共同的祖先谱系。\n2.  在时间 $T_2$ 时，等位基因 C 和 D 合并成另一个共同的祖先谱系。\n3.  在时间 $T_3$ 时，{A, B} 的祖先谱系和等位基因 E 合并。\n4.  在时间 $T_4$ 时，{A, B, E} 的祖先谱系和 {C, D} 的祖先谱系合并。\n\n对于这个特定的实现，事件发生的时间是严格有序的：$0 < T_1 < T_2 < T_3 < T_4$。在时间 $T_4$ 发生的最终合并代表了全部五个等位基因样本的最近共同祖先 (MRCA)。\n\n你的任务是确定这些等位基因的一个特定子集 {A, C, E} 的 MRCA 年龄。用给定的时间参数 $T_1, T_2, T_3,$ 和 $T_4$ 来表示你的答案。", "solution": "根据定义，一个抽样等位基因子集的 MRCA 时间是指，当向后追溯时间时，该子集中所有等位基因的祖先谱系首次合并成单一谱系的那个最近的时间点。\n\n追溯子集 $\\{A,C,E\\}$ 的祖先谱系在给定溯祖事件中的变化：\n- 对于 $0 < t < T_{1}$，该子集存续的祖先谱系为 $\\{A,C,E\\}$。\n- 在 $t = T_{1}$ 时，$A$ 与 $B$ 合并形成 $\\{A,B\\}$；对于该子集，由于 $B$ 不在子集内，其不同祖先谱系的数量没有改变。子集的谱系仍然是 $\\{\\{A\\},\\{C\\},\\{E\\}\\}$，由 $\\{\\{A,B\\},\\{C\\},\\{E\\}\\}$ 代表。\n- 在 $t = T_{2}$ 时，$C$ 与 $D$ 合并形成 $\\{C,D\\}$；同样，这没有减少子集的祖先谱系数量。子集的谱系现在由 $\\{\\{A,B\\},\\{C,D\\},\\{E\\}\\}$ 代表。\n- 在 $t = T_{3}$ 时，$\\{A,B\\}$ 与 $E$ 合并，因此在子集内，$A$ 和 $E$ 现在共享一个共同祖先。这将子集的存续谱系从三个减少到两个：$\\{\\{A,B,E\\},\\{C,D\\}\\}$。\n- 在 $t = T_{4}$ 时，$\\{A,B,E\\}$ 与 $\\{C,D\\}$ 合并，因此 $A$、$C$ 和 $E$ 首次全部共享一个单一的祖先谱系。根据子集 MRCA 时间的定义，这就是所要求的时间。\n\n因此，$\\{A,C,E\\}$ 的 MRCA 年龄是\n$$T_{\\text{MRCA}}^{\\{A,C,E\\}}=T_{4}.$$", "answer": "$$\\boxed{T_{4}}$$", "id": "1477288"}, {"introduction": "理解了溯祖树的静态结构后，下一步是探索其形成的动态规则。这个练习聚焦于标准溯祖模型的一个核心假设：在任何时间点，任意一对现存的谱系都有相同的机会首先发生合并。通过计算一个看似简单但意义深远的概率，你将能更好地把握溯祖过程的随机性，并理解为何谱系树的拓扑结构和分支长度是概率性的 [@problem_id:1477306]。", "problem": "一位群体遗传学家正在使用一个简化的群体动态模型来研究一个物种的祖先。在这个模型中，群体大小被假设为长期恒定且数量庞大。这位遗传学家从四个标记为 A、B、C 和 D 的不同个体中收集了DNA，并向过去追溯它们的遗传历史。这些个体中的每一个都代表一个独特的遗传谱系。\n\n一个“合并事件”被定义为过去某个时刻，两个不同的谱系追溯到一个共同的最近共同祖先（MRCA）。该模型的基本假设是，当回溯时间时，任何一对现存的谱系都是下一个发生合并的等可能对象。\n\n给定四个谱系（A、B、C 和 D）的初始样本，第一个发生的合并事件恰好是合并谱系 A 和 B 的确切概率是多少？\n\n请用最简分数表示你的答案。", "solution": "问题要求计算在四个谱系（A、B、C 和 D）的样本中，特定的一对谱系（A, B）最先发生合并的概率。\n\n问题中陈述的核心原则是，任何一对现存的谱系都是下一个发生合并的等可能对象。因此，要解决这个问题，我们需要确定可能发生合并的总共有多少对，然后计算我们感兴趣的特定结果与这个总数的比率。\n\n首先，我们确定样本中的谱系总数，即 $n=4$。一个合并事件涉及恰好两个谱系的合并。所以，我们的任务是计算从集合 {A, B, C, D} 中可以形成多少个不同的谱系对。这是一个组合问题，具体来说是从4个项目中选择2个。\n\n从 $n$ 个项目中选择 $k$ 个项目的方法数由二项式系数 $\\binom{n}{k}$ 给出，计算公式为：\n$$ \\binom{n}{k} = \\frac{n!}{k!(n-k)!} $$\n在我们的例子中，$n=4$ 且 $k=2$。所以，第一次合并事件可能发生的总对数为：\n$$ \\binom{4}{2} = \\frac{4!}{2!(4-2)!} = \\frac{4!}{2!2!} = \\frac{4 \\times 3 \\times 2 \\times 1}{(2 \\times 1)(2 \\times 1)} = \\frac{24}{4} = 6 $$\n这6个可能的对是：(A, B)，(A, C)，(A, D)，(B, C)，(B, D) 和 (C, D)。\n\n根据模型的假设，这6个可能的合并事件中的每一个作为第一个发生的事件都是等可能的。这6对的集合代表了第一次合并事件所有可能结果的整个样本空间。\n\n我们感兴趣的特定事件是谱系 A 和 B 的合并。这只对应于可能结果中的一个：对 (A, B)。\n\n特定事件的概率是“有利结果”的数量与“所有可能结果”的总数之比。\n有利结果的数量（A 和 B 合并）= 1。\n可能结果的总数（任何一对合并）= 6。\n\n因此，概率 $P$ 是：\n$$ P(\\text{A and B coalesce first}) = \\frac{\\text{Number of favorable outcomes}}{\\text{Total number of possible outcomes}} = \\frac{1}{6} $$\n答案要求以最简分数的形式给出，而 $\\frac{1}{6}$ 已经是了。", "answer": "$$\\boxed{\\frac{1}{6}}$$", "id": "1477306"}, {"introduction": "现在，我们将把之前关于谱系结构和合并概率的知识结合起来，推导溯祖理论中一个最著名且最有用的结果。这个综合性练习要求你计算一个基因样本到达其“最近公共祖先”所需的总期望时间（TMRCA）。这个强大的公式将样本量（$n$）和群体大小（$N$）与深层的演化时间联系起来，完美地展示了溯祖理论如何从微观的遗传抽样过程，推断出宏观的演化历史尺度 [@problem_id:1477323]。", "problem": "在群体遗传学中，Wright-Fisher模型为理解遗传漂变提供了一个简化的数学框架。考虑一个由$N$个个体组成的、大小恒定的二倍体物种的稳定、隔离群体。这意味着在每一代中，该群体的基因库中任何特定基因都有$2N$个拷贝。在这个群体中，我们从当前代中抽取$n$个基因拷贝（其中$2 \\le n \\le 2N$），并希望向后追溯它们的祖先。所有谱系最终都会追溯到一个单一的祖先基因拷贝。我们感兴趣的是这$n$个基因样本的预期最近共同祖先时间（TMRCA）。\n\n假设遵循Wright-Fisher模型的原理，即每一代的整个基因库都是通过从上一代基因库中有放回地抽样形成的，请为这$n$个抽样基因拷贝的预期TMRCA推导出一个闭式解析表达式。请以世代为单位，用群体大小$N$和样本大小$n$的函数来表示你的答案。", "solution": "该问题要求解一个大小为$N$的二倍体群体中$n$个基因拷贝样本的预期最近共同祖先时间（TMRCA）。根据Wright-Fisher模型，群体中总共有$2N$个基因拷贝。我们可以向后追溯这$n$个样本的谱系。\n\n我们用$k$表示在过去的某一特定世代中不同祖先谱系的数量。最初，在抽样时，我们有$k=n$个不同的谱系。随着时间回溯，这些谱系会合并（即找到共同的祖先）。当所有谱系都合并成一个单一祖先时，即当$k=1$时，这个过程就完成了。到达MRCA的总时间是谱系数量从$n$降到$n-1$、从$n-1$降到$n-2$……一直到从2降到1的各阶段等待时间之和。\n\n让我们考虑当存在$k$个不同谱系时的系统。任意两个特定谱系在其紧邻的上一代找到共同祖先的概率，就是它们都从同一个亲本基因拷贝而来的概率。在一个有$2N$个基因拷贝的群体中，这个概率是$\\frac{1}{2N}$。\n\n当我们有$k$个谱系时，有$\\binom{k}{2}$对不同的谱系可能发生合并。在上一代中发生单个合并事件的概率是谱系对的数量乘以单个谱系对发生合并的概率。我们假设当$N$很大时，在单一代中发生多于一个合并事件的概率可以忽略不计。\n所以，当有$k$个谱系时，发生合并事件的概率是：\n$$P_k = \\binom{k}{2} \\frac{1}{2N} = \\frac{k(k-1)}{2} \\frac{1}{2N} = \\frac{k(k-1)}{4N}$$\n\n等待一个合并事件发生的时间（即谱系数量从$k$降到$k-1$的时间）遵循一个成功概率为$P_k$的几何分布。此时间间隔的预期等待时间$E[T_k]$是成功概率的倒数：\n$$E[T_k] = \\frac{1}{P_k} = \\frac{4N}{k(k-1)}$$\n\n到达MRCA的总预期时间$E[T_{\\text{total}}]$是每个时间间隔的预期等待时间之和，此时谱系数量从$n$减少到$2$。我们从$k=n$累加到$k=2$。\n$$E[T_{\\text{total}}] = \\sum_{k=2}^{n} E[T_k] = \\sum_{k=2}^{n} \\frac{4N}{k(k-1)}$$\n我们可以从求和中提出常数$4N$：\n$$E[T_{\\text{total}}] = 4N \\sum_{k=2}^{n} \\frac{1}{k(k-1)}$$\n为了计算这个和，我们对求和项使用部分分式分解：\n$$\\frac{1}{k(k-1)} = \\frac{A}{k} + \\frac{B}{k-1}$$\n两边乘以$k(k-1)$得到$1 = A(k-1) + Bk$。\n如果我们设$k=1$，得到$1 = B(1) \\implies B=1$。\n如果我们设$k=0$，得到$1 = A(-1) \\implies A=-1$。\n所以，分解式为：\n$$\\frac{1}{k(k-1)} = \\frac{1}{k-1} - \\frac{1}{k}$$\n现在我们把这个结果代回到我们的求和中。这个和变成了一个裂项级数：\n$$E[T_{\\text{total}}] = 4N \\sum_{k=2}^{n} \\left(\\frac{1}{k-1} - \\frac{1}{k}\\right)$$\n我们把求和的各项展开：\n当$k=2$时：$\\frac{1}{1} - \\frac{1}{2}$\n当$k=3$时：$\\frac{1}{2} - \\frac{1}{3}$\n当$k=4$时：$\\frac{1}{3} - \\frac{1}{4}$\n...\n当$k=n$时：$\\frac{1}{n-1} - \\frac{1}{n}$\n\n将这些项相加，所有的中间项都抵消了：\n$$\\sum_{k=2}^{n} \\left(\\frac{1}{k-1} - \\frac{1}{k}\\right) = \\left(1 - \\frac{1}{2}\\right) + \\left(\\frac{1}{2} - \\frac{1}{3}\\right) + \\left(\\frac{1}{3} - \\frac{1}{4}\\right) + \\dots + \\left(\\frac{1}{n-1} - \\frac{1}{n}\\right) = 1 - \\frac{1}{n}$$\n将这个结果代回到总预期时间的表达式中：\n$$E[T_{\\text{total}}] = 4N \\left(1 - \\frac{1}{n}\\right)$$\n这就是以世代为单位的预期TMRCA的闭式解析表达式。", "answer": "$$\\boxed{4N\\left(1 - \\frac{1}{n}\\right)}$$", "id": "1477323"}]}