{"hands_on_practices": [{"introduction": "这项练习模拟了分析单细胞数据时最初也最关键的一步：质量控制。在提出生物学问题之前，我们必须确保我们的数据代表了真实的细胞，而不仅仅是技术伪影。这个实践将帮助你理解，像检测到的基因数量和RNA分子总数这样的简单指标，如何成为区分高质量细胞数据和背景噪音的有力工具。[@problem_id:1520761]", "problem": "在一个典型的基于液滴的单细胞RNA测序（scRNA-seq）实验中，细胞悬液被分配到数百万个微小的油滴中。每个液滴被设计为包含一个单细胞和一个微珠。每个微珠表面都覆盖着数百万个拷贝的独特DNA序列，称为“条形码”（barcode），这使得来自单个液滴的所有RNA分子都能被标记，并随后追溯到其来源。此外，每个捕获的RNA分子都会被一个独特的分子标识符（UMI）标记，这是一个短的随机序列，使研究人员能够计算原始RNA转录本的绝对数量，从而防止因测序过程中的扩增而导致的重复计数。\n\n分析scRNA-seq数据时的一个关键挑战是，要区分成功捕获了一个活细胞的液滴和未能捕获细胞但可能含有来自初始悬液中裂解细胞的少量环境RNA的“空液滴”。\n\n一位研究人员进行了一项scRNA-seq实验，并获得了四个代表性条形码的数据摘要。对于每个条形码，分析流程报告了计数的UMI总数以及从这些UMI中检测到的不同基因的总数。摘要如下：\n\n*   **条形码 GATC：** 共检测到12,540个UMI，对应3,150个不同的基因。\n*   **条形码 CCTA：** 共检测到9,880个UMI，对应2,890个不同的基因。\n*   **条形码 TGAN：** 共检测到150个UMI，对应85个不同的基因。\n*   **条形码 AGCT：** 共检测到11,060个UMI，对应3,010个不同的基因。\n\n根据这些信息，哪个条形码最有可能代表一个空液滴？\n\nA. GATC\n\nB. CCTA\n\nC. TGAN\n\nD. AGCT", "solution": "我们用 $U$ 表示为一个条形码检测到的独特分子标识符（UMI）的总数，用 $G$ 表示从这些UMI中观察到的不同基因的总数。在基于液滴的scRNA-seq中，包含一个活的单细胞的液滴通常表现出高的 $U$ 和高的 $G$，这反映了细胞内的RNA含量。相比之下，一个空液滴主要捕获低丰度且稀疏的环境RNA，导致 $U$ 和 $G$ 的值要小得多。这是拐点（knee/inflection）方法和环境RNA感知测试所使用的核心原则：$U$ 值低了几个数量级且相应地 $G$ 值也低的液滴被分类为空液滴。\n\n将此标准应用于这四个条形码：\n- GATC: $U=12540$, $G=3150$\n- CCTA: $U=9880$, $G=2890$\n- TGAN: $U=150$, $G=85$\n- AGCT: $U=11060$, $G=3010$\n\nGATC、CCTA和AGCT这三个条形码具有数量级为 $10^{4}$ 的大 $U$ 值和数量级为 $10^{3}$ 的大 $G$ 值，这与包含单细胞的液滴相符。条形码TGAN的 $U=150$，$G=85$，这些值比其他条形码小了几个数量级，是环境背景的典型特征。因此，TGAN最有可能代表一个空液滴。", "answer": "$$\\boxed{C}$$", "id": "1520761"}, {"introduction": "一旦我们获得了高质量细胞的干净数据集，下一个激动人心的挑战就是识别它们的类型。这项练习介绍了单细胞分析的一块基石：使用像UMAP这样的降维图来可视化细胞间的关系，并通过“标记基因”来识别细胞群体。通过完成这个实践，你将学会如何解读这些关键的可视化图形，并将基因的表达模式与细胞的身份联系起来。[@problem_id:1520807]", "problem": "一个发育生物学家团队正在使用单细胞RNA测序（scRNA-seq）技术研究来自小鼠胚胎的组织样本，该技术可以测量数千个单个细胞的基因表达谱。处理数据后，他们使用一种名为均匀流形逼近与投影（UMAP）的降维算法来可视化数据。在生成的UMAP图中，每个点代表一个单细胞，而具有相似整体基因表达模式的细胞在位置上彼此靠近。\n\n该分析识别出五个不同的细胞簇，这些细胞簇被推测代表了胚胎组织中存在的不同细胞类型。为了表征这些细胞簇，一位研究人员将特定基因 *Fgf8* 的表达水平叠加到UMAP图上。他们观察到，五个簇中的一个簇的细胞显示出 *Fgf8* 的一致性高表达，而其他四个簇的细胞则几乎不表达该基因。\n\n仅基于这一观察，最准确的科学结论是什么？\n\nA. *Fgf8* 是高表达簇所代表的细胞群体的标记基因。\n\nB. 由 *Fgf8* 编码的蛋白质是组织中所有细胞生存最关键的蛋白质。\n\nC. *Fgf8* 的表达是UMAP分析过程中该特定细胞簇形成的直接原因。\n\nD. UMAP可视化存在缺陷，因为像 *Fgf8* 这样的功能重要基因预计会在所有细胞类型中表达。\n\nE. 高表达簇内的每个细胞都以完全相同的速率转录 *Fgf8* 基因。", "solution": "1. 确定数据类型和可视化原理：单细胞RNA测序测量每个细胞中许多基因的转录本丰度，生成一个高维表达矩阵。像UMAP这样的降维方法将细胞嵌入低维空间，使得具有相似全局转录组谱的细胞在位置上彼此靠近。因此，UMAP中的簇反映了整体基因表达模式的相似性，而不必然是任何单个基因作用的结果。\n\n2. 解释单个基因表达的叠加图：将特定基因的表达叠加到UMAP图上，可以显示该基因在哪些区域相对富集。给出的观察结果是，一个簇显示出Fgf8的一致性高表达，而其他四个簇几乎不表达。这表明在该数据集中，Fgf8的表达与该簇中的细胞存在特异性关联。\n\n3. 定义标记基因的概念：标记基因在操作上被定义为一个其表达相对于其他细胞群体而言，在某一特定细胞群体中具有特异性或显著富集的基因，从而能够识别该群体。观察到Fgf8在一个簇中高表达，而在其他簇中低表达或不表达，这与Fgf8在该数据集中作为该细胞群体的标记基因的论断是一致的。\n\n4. 根据原理评估其他解释：\n- 反对B：仅从转录本丰度模式无法得出任何关于该蛋白质对所有细胞生存至关重要的结论。此外，该基因在四个簇中表达极少，这反驳了从该数据集推断出的其具有普遍生存作用的观点。\n- 反对C：UMAP是一种基于全局表达相似性的无监督方法；虽然Fgf8对整体表达谱有贡献，但声称其表达是细胞簇形成的直接原因是不合理的。\n- 反对D：认为功能重要的基因必须在所有细胞类型中表达的期望是错误的；许多基因具有受限的、谱系或状态特异性的表达。基于此，该可视化并无缺陷。\n- 反对E：在色标上“一致性高”的表观现象并不意味着所有细胞的转录速率完全相同；scRNA-seq数据具有噪声，并且可视化通常使用阈值或连续标度，这可能会掩盖细胞间的变异性。\n\n5. 结论：仅基于该观察得出的最准确结论是，Fgf8可被用作本次分析中高表达簇所代表的细胞群体的标记基因，这与选项A一致。", "answer": "$$\\boxed{A}$$", "id": "1520807"}, {"introduction": "单细胞基因组学的一个主要应用是比较细胞状态的变化，例如在健康与患病组织之间，或在治疗前后。一个直观的方法可能是简单地比较基因的平均表达量，但这可能导致错误的结论。这项练习深入探讨了单细胞RNA测序（scRNA-seq）数据的独特统计性质，解释了为何像 $t$ 检验这样的常规统计方法不适用，从而强调了使用专门生物信息学工具的必要性。[@problem_id:1520754]", "problem": "一个免疫学家团队正在研究一种名为“Immunomodulin”的新型药物对脾脏细胞组成的影响。他们使用单细胞RNA测序 (scRNA-seq) 技术，比较了两组小鼠的脾细胞：一组使用Immunomodulin治疗，另一组为对照组，使用安慰剂治疗。数据处理后，计算分析识别出了几个不同的细胞簇。该团队专注于一个被鉴定为“滤泡辅助T细胞”（Tfh）的特定细胞簇。\n\n他们的目标是鉴定在Tfh细胞簇内，治疗组与对照组之间差异表达的基因。一位初级分析师提出了一个直接的方法：对每个基因，计算其在治疗组所有Tfh细胞中的平均表达计数，并使用标准的双样本t检验，将其与对照组所有Tfh细胞中的平均表达计数进行比较。\n\n然而，一位资深生物信息学家立即指出，这种方法在统计学上对于scRNA-seq数据是不合适的。下列哪个陈述提供了最根本和关键的统计学原因，解释了为什么仅通过t检验比较平均表达计数对于这类数据是无效的？\n\nA. 将脾脏组织解离成单细胞的过程会引入显著的机械应力，导致随机的基因表达假象，而这些假象无法通过t检验进行建模。\n\nB. 在Tfh细胞簇中捕获的细胞总数在治疗组和对照组之间可能不同，这违反了t检验的等样本量假设。\n\nC. 在某个细胞簇内，任何给定基因的表达数据都不是正态分布的；它们是离散的计数值，其特征是零值比例高和方差大（过离散），这违反了t检验的核心假设。\n\nD. 用于将细胞分配到“滤泡辅助T细胞”簇的计算算法可能错误分类了一些细胞，从而将其他细胞类型的噪音引入了分析中。\n\nE. 治疗组和对照组的测序实验是在不同日期进行的，这引入了技术性的批次效应，混淆了平均表达值的比较。", "solution": "我们将这位初级分析师的提议形式化如下：对于Tfh细胞簇内的每个基因，设治疗组的观测值为 $X_{1j}$（其中 $j=1,\\dots,n_{1}$），对照组的观测值为 $X_{2k}$（其中 $k=1,\\dots,n_{2}$），这里的每个 $X$ 代表每个细胞的表达计数。其意图是进行如下的假设检验：\n$$\nH_{0}:\\mu_{1}=\\mu_{2} \\quad \\text{versus} \\quad H_{A}:\\mu_{1}\\neq\\mu_{2},\n$$\n该检验通过双样本t检验实现，其检验统计量为Welch形式：\n$$\nt=\\frac{\\bar{X}_{1}-\\bar{X}_{2}}{\\sqrt{\\frac{s_{1}^{2}}{n_{1}}+\\frac{s_{2}^{2}}{n_{2}}}},\n$$\n其中 $\\bar{X}_{i}$ 和 $s_{i}^{2}$ 分别是第 $i$ 组的样本均值和方差。\n\n双样本t检验（无论是标准t检验还是Welch t检验）都严重依赖于分布假设：即每个组内的观测值是独立同分布的，具有近似正态的误差和连续的支撑集，并且在零假设 $H_{0}$ 下，标准化均值差异的抽样分布服从t分布。Welch t检验放宽了等方差的假设，但仍然要求组均值具有近似正态性，而这要求基础数据不能严重偏离正态分布，尤其不能是具有点质量和强均值-方差耦合的高度离散数据。\n\n对于scRNA-seq计数数据，在某种细胞类型中，任何给定基因的数据 $X_{ij}$ 都是离散的非负整数，由于生物学上的稀疏性和技术上的脱扣（dropout）现象，数据中含有高比例的零值，并且表现出过离散（overdispersion），即\n$$\n\\operatorname{Var}(X_{ij}) \\gg \\mathbb{E}[X_{ij}],\n$$\n相对于泊松基线而言。这通常需要使用负二项模型或零膨胀模型来处理。这种分布远非正态分布，并且由于计数数据固有的均值-方差关系而具有异方差性。因此，对于原始的scRNA-seq计数数据，双样本t检验的核心分布假设（正态性和适用于t参考分布的误差结构）被违反了，这使得通过t检验简单比较均值在统计学上是无效的。\n\n分析其他干扰选项：样本量不等（B）并不会使Welch t检验失效；批次效应（E）、错误分类（D）和解离假象（A）都是重要的实际问题，但它们不是导致t检验不适用于原始计数数据的根本性分布原因。最关键和根本的原因是scRNA-seq计数数据的非正态、零膨胀、过离散和离散的性质，这在选项C中得到了概括。", "answer": "$$\\boxed{C}$$", "id": "1520754"}]}