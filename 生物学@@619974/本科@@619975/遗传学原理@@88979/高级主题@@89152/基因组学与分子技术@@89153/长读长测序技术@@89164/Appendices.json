{"hands_on_practices": [{"introduction": "衡量基因组组装质量的一个关键指标是其连续性，通常用 $N50$ 值来量化。这个练习将让你亲手计算 $N50$ 值，并利用它来理解短读长和长读长测序技术在产出结果上的根本差异。通过解决这个问题 [@problem_id:1501367]，你将掌握长读长测序在生成更完整基因组图谱方面的主要优势。", "problem": "一个分子生物学家团队正在研究一种新发现的真菌物种的基因组。该基因组的大小估计约为20兆碱基（Mb）。为创建一个参考基因组，他们采用了两种不同的脱氧核糖核酸（DNA）测序和组装流程，得到了两个不同的草图组装，他们将其标记为组装A和组装B。\n\n基因组组装的质量通常通过其连续性来衡量，而连续性可以使用N50统计量来量化。N50被定义为这样一个最小的重叠群（contig）长度，即长度等于或大于该值的所有重叠群的序列总长度至少占整个组装基因组序列总长度的一半。在这些计算中，假设1兆碱基（Mb）= 1,000千碱基（kb）。\n\n两个组装的内容如下：\n- **组装A** 包括：5个100 kb的重叠群，10个80 kb的重叠群，20个60 kb的重叠群，150个50 kb的重叠群，100个40 kb的重叠群，以及300个20 kb的重叠群。\n- **组装B** 包括：一个7 Mb的重叠群，一个5 Mb的重叠群，一个3 Mb的重叠群，一个2 Mb的重叠群，一个1 Mb的重叠群，以及四个0.5 Mb的重叠群。\n\n基于对这两个组装的分析，以下关于所使用的测序技术的陈述中，哪一个是最准确的结论？\n\nA. 组装A很可能是使用长读长测序生成的，因为它有更多的重叠群，这表明对基因组的覆盖更全面。\n\nB. 组装A很可能是使用长读长测序生成的，因为它的N50值较小，这是长读长测序较高错误率的特征。\n\nC. 组装B很可能是使用长读长测序生成的，因为较大的N50值表示更好的组装连续性，这是使用更长的读长来跨越重复区域的一个主要优势。\n\nD. 组装B很可能是使用长读长测序生成的，因为它的组装总大小恰好是20 Mb，与估计值完全匹配。\n\nE. 仅凭这些数据无法确定测序技术；还需要关于读长错误率的信息。", "solution": "这个问题的目标是比较两个基因组组装，计算它们各自的N50值，并利用这些信息推断每个组装可能使用了哪种测序技术（长读长测序 vs. 短读长测序）。\n\n首先，我们必须计算每个组装的总大小，以验证它们具有可比性，并为N50计算找到中点。\n\n对于组装A，总大小是其所有重叠群长度的总和：\n组装A总大小 = (5 * 100 kb) + (10 * 80 kb) + (20 * 60 kb) + (150 * 50 kb) + (100 * 40 kb) + (300 * 20 kb)\n组装A总大小 = 500 kb + 800 kb + 1,200 kb + 7,500 kb + 4,000 kb + 6,000 kb\n组装A总大小 = 20,000 kb = 20 Mb。\n\n对于组装B，总大小是：\n组装B总大小 = (1 * 7 Mb) + (1 * 5 Mb) + (1 * 3 Mb) + (1 * 2 Mb) + (1 * 1 Mb) + (4 * 0.5 Mb)\n组装B总大小 = 7 Mb + 5 Mb + 3 Mb + 2 Mb + 1 Mb + 2 Mb\n组装B总大小 = 20 Mb。\n\n两个组装的总大小均为20 Mb。为了计算N50，我们需要找到一个重叠群长度，使得长度等于或大于该值的所有重叠群的累积大小达到组装总大小的50%，即 0.5 * 20 Mb = 10 Mb。\n\n现在，我们来计算组装A的N50。我们需要以千碱基（kb）为单位进行计算。目标累积大小是10,000 kb。我们将重叠群按大小降序排列，并计算其总长度的累积和：\n1. 100 kb的重叠群：5 * 100 kb = 500 kb。累积和 = 500 kb。\n2. 80 kb的重叠群：10 * 80 kb = 800 kb。累积和 = 500 kb + 800 kb = 1,300 kb。\n3. 60 kb的重叠群：20 * 60 kb = 1,200 kb。累积和 = 1,300 kb + 1,200 kb = 2,500 kb。\n4. 50 kb的重叠群：150 * 50 kb = 7,500 kb。累积和 = 2,500 kb + 7,500 kb = 10,000 kb。\n\n累积和在包含所有50 kb的重叠群后恰好达到10,000 kb。根据定义，N50是这个集合中最小的重叠群长度，因此组装A的N50是50 kb。\n\n接下来，我们计算组装B的N50。目标累积大小是10 Mb。我们将重叠群按大小降序排列，并计算其长度的累积和：\n1. 7 Mb的重叠群：1 * 7 Mb = 7 Mb。累积和 = 7 Mb。\n2. 5 Mb的重叠群：1 * 5 Mb = 5 Mb。累积和 = 7 Mb + 5 Mb = 12 Mb。\n\n累积和（12 Mb）在包含5 Mb的重叠群后超过了10 Mb的目标。因此，组装B的N50是这个重叠群的长度，即5 Mb。\n\n现在我们比较这两个组装。\n- 组装A: N50 = 50 kb = 0.05 Mb\n- 组装B: N50 = 5 Mb\n\n组装B的N50是组装A的N50的100倍。更高的N50值表示组装的连续性更好，碎片化程度更低。长读长测序技术（例如，PacBio、Oxford Nanopore）产生非常长的读长，可以跨越基因组的重复或复杂区域。这些区域很难用短读长（例如，Illumina）进行组装，会导致组装中断，产生大量较小的重叠群。因此，长读长技术通常能产生连续性更高、N50值更大的组装结果。组装B具有高达5 Mb的N50值，这是长读长组装的典型特征。组装A具有高度碎片化的性质和低至50 kb的N50值，这是短读长组装的典型特征。\n\n最后，我们来评估给出的选项：\nA: 错误。更多的重叠群数量表示一个更碎片化、质量更低的组装，这是短读长技术而非长读长技术的典型特征。\nB: 错误。较小的N50值表示一个更碎片化的组装，这不是一个成功的长读长组装项目的特征。长读长的主要优势是获得高的N50值。\nC: 正确。与组装A（50 kb）相比，组装B的N50值（5 Mb）要大得多。这种卓越的连续性是长读长测序技术的标志性成就，该技术擅长解决那些通常会导致由短读长构建的组装发生碎片的重复基因组元件。\nD: 错误。两个组装的总大小都是20 Mb，所以这不是它们之间的区别特征。\nE: 错误。虽然错误率等其他指标对于全面了解组装质量很重要，但N50的差异如此之大，并且是读长长度的直接后果，因此它可以作为判断所用测序技术的一个非常强有力的主要指标。\n\n因此，最准确的结论是，组装B很可能是使用长读长测序生成的。", "answer": "$$\\boxed{C}$$", "id": "1501367"}, {"introduction": "完成环状DNA分子（如质粒）的组装是一个独特的挑战，因为标准的线性组装算法难以确定其拓扑结构。这个思想实验巧妙地展示了单个长读长如何解决这个问题。通过“读穿”环化连接点，长读长在比对到线性参考序列时会产生一种独特的“分裂比对”信号，从而同时验证序列的准确性和分子的环状结构 [@problem_id:1501345]。这项练习有助于你形象地理解长读长测序的一项独特能力。", "problem": "一名研究人员正在研究一种新型细菌，并使用计算方法组装了其基因组。组装结果包含一个推定的环状质粒，总长度为15,000个碱基对（bp）。为了验证组装结果并确认该质粒确实是环状的，研究人员对该细菌的遗传物质进行了长读长测序。获得了一条长度约为15,000 bp的单条高质量读长，该读长似乎跨越了整个质粒分子。\n\n组装好的15,000 bp质粒序列被用作线性参考序列。该参考序列只是将环状序列从一个任意的核苷酸（指定为位置1）开始“展开”成线性，并在位置15,000结束。这条长读长是从环状质粒生成的线性核苷酸序列，它也有一个起始点，但这个起始点是随机的，不一定与参考序列的位置1相对应。\n\n当这条长读长通过计算比对到线性参考序列上时，以下哪种描述最能体现能证实该质粒环状特性的预期比对模式？\n\nA. 这条15,000 bp的读长连续地比对，从参考序列的位置1开始，并精确地在位置15,000结束。\n\nB. 该读长在可视化时被分为两段。读长的起始部分比对到参考序列末端附近的一个区域，而读长的末端部分则比对到参考序列起始部分附近的一个区域。\n\nC. 该读长比对到参考序列的正中间，使得参考序列的开头和结尾两端各有大约7,500 bp未被比对上。\n\nD. 该读长从参考序列的位置1比对到位置15,000，但在其中心部分显示出一个大的缺失，表明有一个片段丢失了。\n\nE. 该读长比对到参考序列上，但读长的一个大的中心部分相对于参考序列是反转的。", "solution": "设环状质粒的总长度为 $L=15000$ 个碱基对。环状分子的线性参考序列是通过在位置 $L$ 和 $1$ 之间选择一个任意切点，然后将环状序列从位置 $1$ 到位置 $L$ 列出而得到的。从环状质粒产生的单条长读长始于环上的一个随机位置；将这个起始点表示为相对于线性参考序列的偏移量 $s$，其中 $s\\in\\{1,\\dots,L\\}$。\n\n因为该读长跨越了整个环，其序列等于从位置 $s$ 开始并连续延伸 $L$ 个碱基的环状序列。在线性参考序列的坐标中，这意味着读长的前缀对应于区间 $[s,L]$，而读长的后缀对应于区间 $[1,s-1]$。当比对到线性化的参考序列时，这会在参考序列的人为断点处产生一个分裂比对：读长的起始部分比对到参考序列的末端附近（接近位置 $L$），而读长的末端部分比对到参考序列的起始部分附近（接近位置 $1$）。\n\n只有在 $s=1$ 的特殊情况下，读长才会从线性参考序列的位置 $1$ 连续比对到位置 $L$；对于一个随机的起始点来说，这不是普遍预期的结果。因此：\n- 选项A只会在 $s=1$ 时发生，这是一个特例，而不是环状分子的典型模式。\n- 选项B符合预期的跨参考序列两端的分裂比对，这是由于环绕环状起点造成的，也是证实环状特性的标志。\n- 选项C描述了一个内部比对块，其两侧是未比对区域，而不是环状特性的环绕特征。\n- 选项D表明是缺失，而不是环状环绕。\n- 选项E表明是反转，而不是环状环绕。\n\n因此，证实环状特性的比对模式是分裂比对，即读长的起始部分映射到参考序列的末端附近，其末端部分映射到起始部分附近，这对应于选项B。", "answer": "$$\\boxed{B}$$", "id": "1501345"}, {"introduction": "在基因组学中，一种强大的策略是“混合组装”，它结合了短读长的高精度和长读长的跨度优势。这个问题模拟了“脚手架搭建”（scaffolding）的过程——利用长读长来连接和定向已经预先组装好的高质量短读长重叠群（contigs）。通过进行一项概率计算 [@problem_id:1501370]，你将学会从定量的角度来规划测序实验，以确保成功填补序列间的空隙。", "problem": "在一个针对一种新型极端嗜古菌的从头基因组组装项目中，使用短读长测序的初步分析已经生成了一组高质量的重叠群。为了将这些重叠群排列成一个完整的染色体，一位生物信息学家采用了长读长测序技术。\n\n考虑两个特定的重叠群，重叠群 A 和重叠群 B，据信它们在基因组中是相邻的。根据其他证据，已知它们之间被一个长度为 $L_g = 12,000$ 碱基对 (bp) 的连续间隙所分隔。\n\n为了桥接这个间隙，研究人员使用 Pacific Biosciences (PacBio) 仪器进行长读长测序，该仪器生成长度恒为 $L_r = 15,000$ bp 的读长。总数据集在整个基因组上提供了 $C = 5\\text{x}$ 的平均测序覆盖度。\n\n“桥接读长”被定义为完全跨越重叠群 A 和重叠群 B 之间间隙的单个长读长。要实现这一点，一个读长的起始点必须位于一个能确保该读长覆盖整个 $L_g$ 间隙区域的位置。假设长读长的起始位置在整个基因组中是随机分布的，并且成功桥接间隙的读长数量可以被建模为一个服从泊松分布的随机变量。\n\n计算在该测序实验中，为这个特定间隙获得至少一个桥接读长的概率。请以保留四位有效数字的小数形式给出你的答案。", "solution": "设基因组长度为 $G$，长读长的总数为 $N$。平均覆盖度的定义为\n$$\nC=\\frac{N L_{r}}{G}\\quad\\Rightarrow\\quad N=\\frac{C G}{L_{r}}.\n$$\n一个长度为 $L_{r}$ 的读长，如果其起始位置落在一个长度为 $L_{r}-L_{g}$ 的窗口内，从而确保该读长完全覆盖整个间隙，那么它将桥接一个长度为 $L_{g}$ 的间隙。在起始位置均匀分布于整个基因组的情况下，任意一个给定读长成为桥接读长的概率是\n$$\np=\\frac{L_{r}-L_{g}}{G}.\n$$\n那么，桥接读长的期望数是\n$$\n\\lambda=N p=\\frac{C G}{L_{r}}\\cdot\\frac{L_{r}-L_{g}}{G}=C\\,\\frac{L_{r}-L_{g}}{L_{r}}.\n$$\n在泊松模型下，获得至少一个桥接读长的概率为\n$$\nP(\\text{at least one})=1-\\exp(-\\lambda).\n$$\n代入 $C=5$，$L_{r}=15000$ 和 $L_{g}=12000$，\n$$\n\\lambda=5\\left(1-\\frac{12000}{15000}\\right)=5\\cdot 0.2=1,\n$$\n所以\n$$\nP=1-\\exp(-1)\\approx 0.6321\\ \\text{（保留四位有效数字）}.\n$$", "answer": "$$\\boxed{0.6321}$$", "id": "1501370"}]}