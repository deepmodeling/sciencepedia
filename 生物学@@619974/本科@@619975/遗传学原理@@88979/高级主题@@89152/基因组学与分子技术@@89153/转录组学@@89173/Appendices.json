{"hands_on_practices": [{"introduction": "在进行任何复杂的生物信息学分析之前，一个稳健的实验设计是得出可靠科学结论的基石。这个练习旨在强调一个在研究中常见但极其关键的概念：生物学重复的重要性。通过分析一个有缺陷的实验方案，你将学会区分处理效应和个体间的自然生物学变异，这是解释任何基因表达数据的第一步 [@problem_id:1530882]。", "problem": "一名本科研究员正在研究一种名为“Energene”的新型膳食补充剂对小鼠骨骼肌基因表达的影响。其目标是鉴定可能与增强肌肉恢复有关的基因。该研究员设计了一个实验，使用了两只小鼠：一只小鼠被喂以标准饮食（对照组），另一只在相同饮食的基础上添加Energene补充剂，喂养两周（处理组）。\n\n两周后，研究人员从两只小鼠身上采集肌肉组织，并提取信使RNA (mRNA)。研究员使用基因芯片来比较处理组小鼠与对照组小鼠的基因表达谱。结果显示，与对照组小鼠相比，喂食Energene的小鼠中有317个基因的上调倍数至少为三倍。基于这单次实验，该研究员热情地向其导师报告，称Energene引起了肌肉基因表达的巨大而广泛的改变。\n\n下列哪项陈述指出了该实验设计和研究员结论中最关键和最根本的缺陷？\n\nA. 研究员本应使用更现代、更灵敏的技术，如RNA测序（RNA-seq），而非基因芯片，因为众所周知基因芯片具有更高的背景噪音。\n\nB. 实验缺乏技术重复；研究员本应将每只小鼠的mRNA样本在至少两个独立的基因芯片上运行，以确保测量的可重复性。\n\nC. 三倍的差异倍数变化阈值设定得过高；本应使用更常规的1.5或2.0倍的较低阈值，以避免错过重要但微小的基因表达变化。\n\nD. 实验缺乏生物学重复，因此无法确定观察到的基因表达差异是由于Energene补充剂引起的，还是仅仅源于两只个体小鼠之间的自然生物学变异。\n\nE. 两周的处理周期太短，不足以观察到有意义的生理变化，实验应至少进行六周，以便观察长期适应。", "solution": "目标：推断Energene是否引起骨骼肌基因表达的变化。要将差异表达进行处理的因果归因，实验设计必须能够估计生物学变异性，并对基因进行统计检验。\n\n定义组样本量 $n_{\\text{treated}}=1$ 和 $n_{\\text{control}}=1$。对于每个基因的标准双样本比较，需要计算一个检验统计量，例如双样本$t$统计量：\n$$\nt \\;=\\; \\frac{\\bar{x}_{\\text{treated}}-\\bar{x}_{\\text{control}}}{s_{p}\\,\\sqrt{\\frac{1}{n_{\\text{treated}}}+\\frac{1}{n_{\\text{control}}}}}\n$$\n其中，$s_{p}^{2}$ 是合并组内方差，根据每组内的生物学重复进行估计。当 $n_{\\text{treated}}=1$ 和 $n_{\\text{control}}=1$ 时，组内自由度为零：\n$$\n\\text{df} \\;=\\; n_{\\text{treated}} + n_{\\text{control}} - 2 \\;=\\; 0,\n$$\n因此 $s_{p}^{2}$ 未定义，无法执行有效的推断检验。所以，无法区分处理效应与自然的个体间变异。这使得“Energene引起了巨大而广泛的改变”这一结论无效，因为观察到的倍数变化可能源于两只个体小鼠之间固有的生物学差异，而非补充剂的作用。\n\n此外，基因芯片研究涉及对 $G$ 个基因（此处为数百至数千个）进行检验。没有生物学重复，就无法估计基因层面的统计量分布，也无法在多重检验中控制假发现率。即使是完美的测量技术也无法弥补生物学重复的缺失。\n\n选项评估：\n- A（技术选择）解决了灵敏度和噪音问题，但没有解决在没有生物学重复的情况下无法将差异归因于处理的问题；将基因芯片换成RNA-seq，每组的样本量 $n=1$ 仍未改变。\n- B（技术重复）仅评估测量的可重复性；它们不增加用于生物学变异的样本量 $n$。上述分母中的方差仍然缺乏对生物学变异性的有效估计。\n- C（差异倍数变化阈值）涉及阈值选择，这是次要问题；核心缺陷在于缺乏任何推断依据，而不是特定的差异倍数变化阈值。\n- E（处理时长）可能会影响效应量，但没有解决在每组 $n=1$ 的情况下无法提出因果声明的根本问题。\n\n因此，最关键和最根本的缺陷是缺乏生物学重复，这使得无法区分处理效应和自然生物学变异，并排除了有效的统计推断。因此，D是正确的。", "answer": "$$\\boxed{D}$$", "id": "1530882"}, {"introduction": "转录组学实验通常会产生海量数据，涵盖数万个基因的表达变化，因此有效的可视化方法至关重要。本练习将向你介绍一种在差异表达分析中广泛使用的强大工具——火山图。通过理解火山图的构建原理，你将学会如何同时评估基因表达变化的幅度（倍数变化）和统计显著性（$p$ 值），从而快速筛选出最值得关注的候选基因 [@problem_id:1530942]。", "problem": "一个遗传学家团队正在研究细胞对一种新的抗病毒药物的反应。他们进行了一项核糖核酸测序（RNA-seq）实验，以比较用药处理过的人类细胞与未处理的对照细胞中的基因表达水平。该分析为超过20,000个基因生成了一个庞大的数据集。对于每个基因，该团队计算了两个关键指标：\n\n1.  **倍数变化（Fold Change）**：基因在处理细胞中的表达水平与在对照细胞中表达水平的比率。\n2.  **p值（p-value）**：观测到的表达变化的统计显著性。\n\n主要目标是生成一个单一、全面的可视化图表，使他们能够快速识别那些既表现出大幅度表达变化（无论是上调还是下调）又具有高度统计显著性的基因。下列哪种数据可视化方法最适合这项特定任务？\n\nA. 火山图（Volcano Plot）\n\nB. 条形图（Bar Chart）\n\nC. 热图（Heatmap）\n\nD. p值与倍数变化的散点图（Scatter Plot of p-value versus Fold Change）\n\nE. 箱形图（Box Plot）", "solution": "任务是在单个图表中为许多基因同时可视化差异表达的幅度和其统计显著性。设每个基因的倍数变化为 $\\mathrm{FC} = \\frac{\\text{expression}_{\\text{treated}}}{\\text{expression}_{\\text{control}}}$，其相关的显著性为 $p$ 值，记作 $p$。\n\n直接绘制 $\\mathrm{FC}$ 的图会有一个不对称的尺度：上调导致 $\\mathrm{FC} > 1$，而下调导致 $0 < \\mathrm{FC} < 1$。为了使效应大小对称，并使等幅度的上调和下调具有可比性，使用了对数转换：$x = \\log_{2}(\\mathrm{FC})$，这样 $x > 0$ 表示上调，$x < 0$ 表示下调，而 $|x|$ 代表变化的幅度。\n\n对于统计显著性，小的 $p$ 值在负对数尺度上更容易解释，$y = -\\log_{10}(p)$，这是一种单调转换，将更显著的结果映射到更大的 $y$ 值。这种方法可以展开小的 $p$ 值，从而能够在视觉上区分出高度显著的基因。\n\n火山图的定义是，将每个基因作为一个点绘制在以下坐标上：\n$$\nx = \\log_{2}(\\mathrm{FC}), \\quad y = -\\log_{10}(p).\n$$\n具有大 $|x|$ 和大 $y$ 的基因很容易被识别为强烈差异表达且高度显著的基因。常用的决策阈值通过在 $x = \\pm \\log_{2}(\\tau_{\\mathrm{FC}})$ 处绘制垂线（其中 $\\tau_{\\mathrm{FC}}$ 是选定的倍数变化幅度阈值）和在 $y = -\\log_{10}(\\alpha)$ 处绘制水平线（其中 $\\alpha$ 是显著性水平）来可视化，这直接将平面划分为感兴趣的区域。\n\n比较各个选项：\n- 火山图明确使用 $x = \\log_{2}(\\mathrm{FC})$ 和 $y = -\\log_{10}(p)$，这是完成此项任务的标准、信息量最大的可视化方法。\n- 条形图不适用于超过 $2 \\times 10^{4}$ 个基因，并且不能同时编码每个基因的显著性和效应大小。\n- 热图用于显示跨样本或聚类的表达模式，而不是在二维中显示每个基因的效应大小和显著性的组合关系。\n- 一个普通的p值与倍数变化的散点图，若不进行对数转换，则无法使效应大小对称，并且会将小的p值压缩到零附近，使其信息量不如火山图。\n- 箱形图总结了分布情况，无法同时显示每个基因的效应大小和显著性。\n\n因此，最合适的可视化方法是火山图。", "answer": "$$\\boxed{A}$$", "id": "1530942"}, {"introduction": "转录组学的魅力不仅在于量化基因的“开关”状态，更在于揭示基因表达调控的精细过程，例如可变剪接。本练习将引导你超越简单的基因计数，深入探索可变剪接分析。你将通过一个具体的案例，利用来自 RNA 测序的连接跨越读数（junction-spanning reads）来亲手计算“剪接包含百分比”（Percent Spliced In, PSI）这一关键指标，从而量化药物处理对特定外显子剪接模式的影响 [@problem_id:1530879]。", "problem": "一个分子遗传学研究小组正在一个人类细胞系中研究一种新药对一个名为 *Splicing Factor Kinase 1* (SFK1) 的基因的选择性剪接的影响。他们专注于一个特定的“盒式外显子”，即外显子5，它位于两个组成型表达的外显子——外显子4和外显子6之间。在成熟的信使RNA (mRNA) 中，外显子5的存在与否会改变最终生成的SFK1蛋白质的功能。为了对此进行量化，研究人员对来自一个对照组（未经处理）的三个生物学重复样本和来自一个治疗组（药物处理）的三个生物学重复样本，进行了一项核糖核酸测序 (RNA-seq) 实验。\n\n他们从RNA-seq数据中计数“跨剪接点读数”，这些读数是覆盖了两个外显子之间边界的测序片段。这些计数被用来确定剪接结果：\n-   `I_1`：跨越外显子4和外显子5之间连接处的读数数量。\n-   `I_2`：跨越外显子5和外显子6之间连接处的读数数量。\n-   `S`：跨越外显子4和外显子6之间“跳跃”连接处的读数数量，代表外显子5被排除。\n\n外显子5的相对包含水平使用一个名为“剪接包含百分比”(Percent Spliced In, PSI)的指标来量化。对于单个样本，PSI值的计算方法是支持包含的读数与支持包含或排除的总读数之比。支持包含的读数数量取为`I_1`和`I_2`的平均值。因此，公式为：\n$$ \\text{PSI} = \\frac{(I_1 + I_2)/2}{(I_1 + I_2)/2 + S} $$\n\n六个样本的原始剪接点读数计数如下：\n\n**对照组：**\n-   重复样本 C1：$I_1 = 52$, $I_2 = 48$, $S = 105$\n-   重复样本 C2：$I_1 = 61$, $I_2 = 55$, $S = 117$\n-   重复样本 C3：$I_1 = 49$, $I_2 = 53$, $S = 98$\n\n**治疗组：**\n-   重复样本 T1：$I_1 = 130$, $I_2 = 124$, $S = 42$\n-   重复样本 T2：$I_1 = 145$, $I_2 = 139$, $S = 49$\n-   重复样本 T3：$I_1 = 138$, $I_2 = 132$, $S = 45$\n\n计算平均剪接的变化，定义为 $\\Delta\\text{PSI} = \\text{PSI}_{\\text{treatment\\_avg}} - \\text{PSI}_{\\text{control\\_avg}}$。报告你的答案，以小数形式表示并四舍五入到三位有效数字。", "solution": "单个样本的PSI定义为\n$$\n\\text{PSI}=\\frac{(I_{1}+I_{2})/2}{(I_{1}+I_{2})/2+S}\n$$。\n分子和分母同乘以$2$得到等价形式\n$$\n\\text{PSI}=\\frac{I_{1}+I_{2}}{I_{1}+I_{2}+2S}\n$$。\n\n计算每个重复样本的PSI。\n\n对照组：\n- C1：$I_{1}+I_{2}=52+48=100$, $2S=210$, 所以\n$$\n\\text{PSI}_{\\text{C1}}=\\frac{100}{100+210}=\\frac{100}{310}=\\frac{10}{31}\\approx 0.3225806451612903\n$$。\n- C2：$I_{1}+I_{2}=61+55=116$, $2S=234$, 所以\n$$\n\\text{PSI}_{\\text{C2}}=\\frac{116}{116+234}=\\frac{116}{350}=\\frac{58}{175}\\approx 0.3314285714285714\n$$。\n- C3：$I_{1}+I_{2}=49+53=102$, $2S=196$, 所以\n$$\n\\text{PSI}_{\\text{C3}}=\\frac{102}{102+196}=\\frac{102}{298}=\\frac{51}{149}\\approx 0.3422818791946309\n$$。\n对照组平均PSI：\n$$\n\\text{PSI}_{\\text{control\\_avg}}=\\frac{\\text{PSI}_{\\text{C1}}+\\text{PSI}_{\\text{C2}}+\\text{PSI}_{\\text{C3}}}{3}\\approx \\frac{0.3225806451612903+0.3314285714285714+0.3422818791946309}{3}\\approx 0.3320970319281642\n$$。\n\n治疗组：\n- T1：$I_{1}+I_{2}=130+124=254$, $2S=84$, 所以\n$$\n\\text{PSI}_{\\text{T1}}=\\frac{254}{254+84}=\\frac{254}{338}=\\frac{127}{169}\\approx 0.7514792899408284\n$$。\n- T2：$I_{1}+I_{2}=145+139=284$, $2S=98$, 所以\n$$\n\\text{PSI}_{\\text{T2}}=\\frac{284}{284+98}=\\frac{284}{382}=\\frac{142}{191}\\approx 0.7434554973821989\n$$。\n- T3：$I_{1}+I_{2}=138+132=270$, $2S=90$, 所以\n$$\n\\text{PSI}_{\\text{T3}}=\\frac{270}{270+90}=\\frac{270}{360}=\\frac{3}{4}=0.75\n$$。\n治疗组平均PSI：\n$$\n\\text{PSI}_{\\text{treatment\\_avg}}=\\frac{\\text{PSI}_{\\text{T1}}+\\text{PSI}_{\\text{T2}}+\\text{PSI}_{\\text{T3}}}{3}\\approx \\frac{0.7514792899408284+0.7434554973821989+0.75}{3}\\approx 0.7483115957743424\n$$。\n\n计算变化量：\n$$\n\\Delta \\text{PSI}=\\text{PSI}_{\\text{treatment\\_avg}}-\\text{PSI}_{\\text{control\\_avg}}\\approx 0.7483115957743424-0.3320970319281642\\approx 0.4162145638461782\n$$。\n四舍五入到三位有效数字：\n$$\n\\Delta \\text{PSI}\\approx 0.416\n$$。", "answer": "$$\\boxed{0.416}$$", "id": "1530879"}]}