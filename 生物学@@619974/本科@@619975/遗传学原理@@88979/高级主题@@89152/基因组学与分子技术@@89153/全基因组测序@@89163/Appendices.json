{"hands_on_practices": [{"introduction": "任何全基因组测序项目的第一步都是确保生成足够的数据量。测序覆盖深度（coverage depth）是一个基本指标，它量化了基因组中每个碱基被平均测序的次数。通过解决这个问题，你将掌握覆盖深度的基本计算方法，这对于规划测序实验和评估数据集的质量至关重要 [@problem_id:1534614]。", "problem": "一个遗传学家团队正在进行一个全基因组鸟枪法测序项目，以组装一种新发现的嗜极植物的基因组。测序仪器生成了大量的短DNA读段数据集。经过过滤和质量控制后，产生的序列数据总量为150吉碱基（Gb）。根据初步的细胞学和流式细胞术分析，该植物的单倍体基因组估计大小为5吉碱基（Gb）。\n\n计算该测序项目达到的平均覆盖深度。", "solution": "平均覆盖深度（也称为倍数覆盖率）定义为测序的总碱基数除以单倍体基因组的大小。设 $C$ 表示覆盖深度，$B$ 表示测序的总碱基数，$G$ 表示单倍体基因组大小。那么\n$$\nC=\\frac{B}{G}.\n$$\n当 $B=150\\,\\text{Gb}$ 且 $G=5\\,\\text{Gb}$ 时，代入可得\n$$\nC=\\frac{150\\,\\text{Gb}}{5\\,\\text{Gb}}=30.\n$$\n吉碱基单位相互抵消，得到一个无量纲的倍数覆盖率。因此，平均覆盖深度为 $30$x。", "answer": "$$\\boxed{30}$$", "id": "1534614"}, {"introduction": "在投入计算资源进行基因组组装之前，对原始测序读数进行质量控制是至关重要的一步。K-mer分析是一种强大的、无需组装的质控技术，它通过检查短 DNA 子序列（k-mers）的频率分布来揭示数据集的重要特性，如基因组大小、重复性和污染情况。这项练习将挑战你解读 k-mer 频率直方图，这是一项诊断样品污染等常见实验问题的关键技能 [@problem_id:1534597]。", "problem": "一位基因组学研究人员正在对一份液体培养物进行全基因组测序（WGS）实验，该培养物被推定含有一种纯菌株的霍乱弧菌（*Vibrio cholerae*）。在进行基因组组装之前，作为初步的质量控制步骤，研究人员对原始测序读长（raw sequencing reads）进行了 k-mer 分析。在此次分析中，使用的 k-mer 长度为 21。\n\n该分析生成了一个频率直方图，其中 x 轴代表特定 21-mer 序列在数据集中出现的次数（其频率），y 轴代表具有该频率的不同 21-mer 的数量。直方图显示出两个清晰、独立且近似钟形的峰。第一个主峰的中心位于频率约为 30 的位置，第二个更高的峰的中心位于频率约为 90 的位置。此外，在频率为 1 的位置还有一个小得多且非常尖锐的峰，它对应于测序错误，但在本次分析中可以忽略。\n\n假设存在的任何细菌的基因组都具有相似的大小和复杂性，以下哪个陈述为这些观察结果提供了最合理的解释？\n\nA. 霍乱弧菌（*Vibrio cholerae*）的基因组包含一个庞大的重复元件家族，这些元件在整个基因组中平均以三个拷贝的形式存在。\n\nB. 该培养物被一种噬菌体（一种感染细菌的病毒）污染，且噬菌体颗粒的丰度是霍乱弧菌（*Vibrio cholerae*）细胞丰度的三倍。\n\nC. 测序过程存在缺陷，来自 DNA 正链的读长测序深度为 30x，而来自反链的读长测序深度为 90x。\n\nD. 该培养物被另一种细菌污染，且污染菌种的丰度大约是霍乱弧菌（*Vibrio cholerae*）丰度的三分之一。\n\nE. 该培养物被另一种细菌污染，且霍乱弧菌（*Vibrio cholerae*）的丰度大约是污染菌种丰度的三分之一。", "solution": "k-mer 直方图为每个 k-mer 绘制了其在读长数据集中的计数（x 轴）与具有该计数的不同 k-mer 的数量（y 轴）之间的关系。对于一个被均匀测序的单一、非冗余基因组，唯一 k-mer 的计数分布在平均覆盖度周围呈近似钟形。如果一个 k-mer 在基因组中以拷贝数 $r$ 出现，其期望计数将乘以 $r$，从而在 $rC$ 附近产生一个峰，其中 $C$ 是唯一序列的平均覆盖度。\n\n对于混合基因组，每个基因组 $i$ 都会在平均 k-mer 计数 $\\mu_{i}$ 处贡献其自身的峰，该计数值与其测序覆盖度成正比。设 $B$ 为测序的总碱基数，$f_{i}$ 为源自基因组 $i$ 的碱基比例，$G_{i}$ 为基因组大小。基因组 $i$ 的平均深度（因此也是唯一 k-mer 的平均 21-mer 计数）为\n$$\n\\mu_{i} = \\frac{B f_{i}}{G_{i}}.\n$$\n因此，对于两个基因组 $1$ 和 $2$，\n$$\n\\frac{\\mu_{2}}{\\mu_{1}} = \\frac{f_{2} G_{1}}{f_{1} G_{2}}.\n$$\n根据题目中任何存在的细菌基因组都具有相似大小和复杂性的假设，我们取 $G_{1} \\approx G_{2}$，这得出\n$$\n\\frac{\\mu_{2}}{\\mu_{1}} \\approx \\frac{f_{2}}{f_{1}}.\n$$\n观察到的位于约 $30$ 和 $90$ 的峰意味着\n$$\n\\frac{90}{30} \\approx 3 \\quad \\Rightarrow \\quad \\frac{f_{\\text{higher}}}{f_{\\text{lower}}} \\approx 3,\n$$\n即，一种细菌的丰度大约是另一种的三倍。\n\n此外，对于每个物种，其峰下的面积（贡献的不同 21-mer 的总数）与基因组大小和复杂性成比例；在 $G_{1} \\approx G_{2}$ 的情况下，峰面积是相似的。因为对于给定的均值 $\\mu$，k-mer 计数的方差约等于 $\\mu$（类泊松抽样），所以具有较大 $\\mu$ 的分布更窄（标准差为 $\\sqrt{\\mu}$），因此在面积相似的情况下，其峰显得更高。因此，位于 $90$ 处较高的峰对应于丰度更高的物种。\n\n现在评估各个选项：\n\n- A: 三拷贝重复序列会为重复的 k-mer 在 $3C$ 附近产生一个次峰，但唯一部分仍会在 $C$ 处产生一个主峰。要使 $3C$ 处的峰比 $C$ 处的峰更高，大部分不同的 21-mer 必须来自三拷贝重复序列，这对于典型的细菌基因组来说是不太可能的，并且通常还会在其他倍数上产生额外的峰。这比混合物种的解释更不合理。\n\n- B: 噬菌体的基因组要小得多，不符合针对细菌的“相似大小和复杂性”的假设。颗粒丰度的三倍差异并不会直接在 k-mer 直方图中产生观察到的两个类似细菌的主峰；噬菌体贡献的独特 k-mer 会少得多，使其不太可能产生一个能与细菌相媲美的主峰。\n\n- C: 以不同的深度对正链和反链进行测序不会产生两个独立的 k-mer 覆盖度峰，因为 k-mer 计数通常会汇总两条链的计数（并且通常会对反向互补链进行规范化处理）。链特异性的深度不平衡不会将 k-mer 直方图在不同倍数上分裂成两个独立的峰。\n\n- D 和 E: 两种基因组大小相似的细菌的混合物自然会产生两个峰，其平均计数与它们的相对丰度成正比。比率 $90/30 \\approx 3$ 表明存在三倍的丰度差异，而位于 $90$ 处较高的峰必定是丰度更高的物种。在一个本应是霍乱弧菌纯菌株的培养物中，最可能的情况是霍乱弧菌仍然是主要成分，而污染物的丰度大约是其三分之一。这直接对应于陈述 D。\n\n因此，与直方图、峰位置所暗示的丰度比以及基因组大小相似的假设相符的最合理解释是 D。", "answer": "$$\\boxed{D}$$", "id": "1534597"}, {"introduction": "基因组组装不仅仅是拼接 DNA 序列，它还能揭示基因组的结构和变异。在基于图的组装方法中，杂合位点通常会在图中形成被称为“气泡”的结构，即两条平行的路径代表了来自父本和母本的不同等位基因。通过解决这个练习，你将学习如何将生物信息学中的抽象图形结构与具体的生物学测量（物种的杂合度）联系起来，从而深入理解基因组变异 [@problem_id:1534647]。", "problem": "一个遗传学家团队正在对一个新发现的二倍体昆虫物种进行全基因组测序。他们使用短读长测序技术，并采用k-mer大小为61的de Bruijn图算法来组装基因组。在生成的组装图中，他们观察到大量的“气泡”结构。一个简单气泡被定义为图中局部的一个分叉点，该点分裂成两条平行的contig路径，随后又汇合回单一路径。通过人工检查以及与一个近缘物种的比对，该团队确认这些简单气泡中的绝大多数是由杂合单核苷酸多态性（SNPs）引起的，其中气泡中的两条路径仅相差一个碱基。\n\n最终的组装统计报告显示，组装基因组总长度为310兆碱基对（Mbp），contig N50为92千碱基（kb）。图分析工具识别出总共2,150,000个此类简单的单核苷酸气泡。\n\n假设这些简单气泡中的每一个都对应一个独特的杂合SNP位点，请计算该昆虫基因组的估计平均杂合度。请以每千碱基的SNP数（SNPs/kb）为单位表示您的答案，并四舍五入到三位有效数字。", "solution": "题目告诉我们，de Bruijn组装图中的简单气泡对应于杂合SNP位点。设这类位点的数量为 $N$，组装基因组的长度（以碱基对为单位）为 $L$。每碱基对的杂合度为 $r_{\\mathrm{bp}} = \\frac{N}{L}$，而每千碱基的杂合度则通过乘以 $10^{3}$ 得到：\n$$\nr_{\\mathrm{kb}} = \\frac{N}{L} \\times 10^{3}.\n$$\n根据题目，有 $N = 2{,}150{,}000 = 2.15 \\times 10^{6}$ 和 $L = 310 \\text{ Mbp} = 310 \\times 10^{6} \\text{ bp} = 3.10 \\times 10^{8} \\text{ bp}$。代入公式得，\n$$\nr_{\\mathrm{kb}} = \\frac{2.15 \\times 10^{6}}{3.10 \\times 10^{8}} \\times 10^{3} = \\left(\\frac{2.15}{3.10}\\right) \\times 10^{-2} \\times 10^{3} = \\left(\\frac{2.15}{3.10}\\right) \\times 10^{1}.\n$$\n计算该比率：\n$$\n\\frac{2.15}{3.10} = 0.693548\\ldots,\n$$\n所以\n$$\nr_{\\mathrm{kb}} = 0.693548\\ldots \\times 10^{1} = 6.93548\\ldots.\n$$\n四舍五入到三位有效数字，得到每千碱基 $6.94$ 个SNP。", "answer": "$$\\boxed{6.94}$$", "id": "1534647"}]}