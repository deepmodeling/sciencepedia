{"hands_on_practices": [{"introduction": "在微生物组研究中，一项基本任务是量化两个微生物群落之间的差异程度。这个概念被称为 β 多样性（beta diversity），它帮助我们理解不同个体、不同身体部位或不同健康状况下的微生物群落构成有何不同。本练习将让你亲手实践一项核心技能：使用一个广泛应用的指标——Bray-Curtis 相异度（Bray-Curtis dissimilarity）来比较两个简化的肠道微生物组样本，从而具体感受如何将复杂的群落数据转化为一个有意义的差异值。[@problem_id:2098820]", "problem": "人类微生物组计划 (HMP) 的研究人员研究人体内部和表面的微生物群落的组成。比较这些群落的一个关键方法是计算β多样性，它量化了两个群落在物种组成和丰度方面的差异程度。\n\n一位分析师正在比较来自两个受试者的简化肠道微生物组数据：受试者A生活在现代城市环境中，受试者B来自一个偏远的非工业化社区。数据包含了通过测序获得的五种代表性细菌物种的计数。\n\n| 细菌物种 | 受试者A (计数) | 受试者B (计数) |\n| :--- | :--- | :--- |\n| *Bacteroides thetaiotaomicron* | 420 | 110 |\n| *Prevotella copri* | 80 | 350 |\n| *Faecalibacterium prausnitzii* | 300 | 380 |\n| *Bifidobacterium adolescentis* | 250 | 60 |\n| *Eubacterium rectale* | 150 | 200 |\n\n为量化这两个肠道微生物组之间的差异，该分析师使用了Bray-Curtis相异指数。两个样本 $i$ 和 $j$ 之间的Bray-Curtis相异度 $BC_{ij}$ 的计算公式如下：\n\n$$BC_{ij} = \\frac{\\sum_{k=1}^{S} |y_{ik} - y_{jk}|}{\\sum_{k=1}^{S} (y_{ik} + y_{jk})}$$\n\n其中，$S$是物种总数，$y_{ik}$和$y_{jk}$分别代表物种$k$在样本$i$和$j$中的计数。$BC_{ij}$的值范围从0（完全相同的群落）到1（完全不同且没有共享物种的群落）。\n\n根据所提供的数据，计算受试者A和受试者B肠道微生物组之间的Bray-Curtis相异度。将您的最终答案四舍五入到三位有效数字。", "solution": "我们使用Bray-Curtis相异度公式：\n$$BC_{ij}=\\frac{\\sum_{k=1}^{S}|y_{ik}-y_{jk}|}{\\sum_{k=1}^{S}(y_{ik}+y_{jk})}.$$\n这里，$S=5$，计数数据来自受试者A和B。\n\n计算分子 $\\sum_{k=1}^{5}|y_{Ak}-y_{Bk}|$：\n$$|420-110|=310,\\quad |80-350|=270,\\quad |300-380|=80,\\quad |250-60|=190,\\quad |150-200|=50.$$\n因此，\n$$\\sum_{k=1}^{5}|y_{Ak}-y_{Bk}|=310+270+80+190+50=900.$$\n\n计算分母 $\\sum_{k=1}^{5}(y_{Ak}+y_{Bk})$：\n$$(420+110)=530,\\quad (80+350)=430,\\quad (300+380)=680,\\quad (250+60)=310,\\quad (150+200)=350,$$\n所以\n$$\\sum_{k=1}^{5}(y_{Ak}+y_{Bk})=530+430+680+310+350=2300.$$\n\n因此，\n$$BC_{AB}=\\frac{900}{2300}=\\frac{9}{23}\\approx 0.391304\\ldots.$$\n四舍五入到三位有效数字得到$0.391$。", "answer": "$$\\boxed{0.391}$$", "id": "2098820"}, {"introduction": "仅仅知道两个微生物群落的物种构成不同是不够的，我们更关心这种差异是否会导致功能上的不同。本练习将引导你探索功能冗余（functional redundancy）这一关键生态学概念，即不同的微生物物种可以执行相似的代谢功能。通过在一个假设情景中同时计算物种组成的相异度（$BC$）和代谢通路的功能相似度（$FPS$），你将亲身体会到一个深刻的现象：两个在物种上看似“天差地别”的群落，其整体功能可能“殊途同归”。[@problem_id:2098789]", "problem": "在一项受人类微生物组计划 (Human Microbiome Project, HMP) 启发的项目中，一位研究人员正在研究肠道微生物组中的功能冗余概念。两名健康受试者（受试者1和受试者2）提供了用于宏基因组学分析的粪便样本。该分析得出了五种最优势细菌物种的相对丰度，以及每个物种能够执行的关键代谢途径的目录。\n\n这两个样本的物种组成（相对丰度，以百分比表示）如下：\n- **样本1:** 物种A (40%)、物种B (40%)、物种E (20%)\n- **样本2:** 物种C (40%)、物种D (40%)、物种E (20%)\n请注意，物种A、B、C和D分别是各自样本所特有的，而物种E是共享的。\n\n每个物种的功能潜力（编码的代谢途径）为：\n- **物种A:** 途径P1\n- **物种B:** 途径P2\n- **物种C:** 途径P1\n- **物种D:** 途径P2\n- **物种E:** 途径P3\n\n为了量化这两个微生物群落之间的差异，研究人员使用了两个指标：\n\n1.  **Bray-Curtis相异度 ($BC$):** 一种衡量物种差异的指标，根据物种丰度数据计算。其计算公式为：\n    $$BC = 1 - \\frac{2 \\sum_{i} \\min(S_{1i}, S_{2i})}{\\sum_{i} (S_{1i} + S_{2i})}$$\n    其中$S_{1i}$和$S_{2i}$分别是物种$i$在样本1和样本2中的相对丰度。求和范围是至少存在于一个样本中的所有物种。\n\n2.  **功能潜力相似度 ($FPS$):** 一种衡量功能重叠的指标，定义为每个群落中存在的独有代谢途径集合的Jaccard相似度。其计算公式为：\n    $$FPS = \\frac{|P_1 \\cap P_2|}{|P_1 \\cup P_2|}$$\n    其中$P_1$和$P_2$分别是样本1和样本2中存在的独有途径的集合。$|...|$表示集合中元素的数量。\n\n计算这对样本的Bray-Curtis相异度 ($BC$) 和功能潜力相似度 ($FPS$)。将你的答案以一对数值（先是$BC$，然后是$FPS$）的形式报告，并保留两位有效数字。", "solution": "我们将相对丰度表示为小数。对于样本1：物种A的$S_{1A}=0.40$，物种B的$S_{1B}=0.40$，物种E的$S_{1E}=0.20$，缺失物种的丰度为零。对于样本2：物种C的$S_{2C}=0.40$，物种D的$S_{2D}=0.40$，物种E的$S_{2E}=0.20$，缺失物种的丰度为零。\n\nBray-Curtis相异度定义为\n$$\nBC = 1 - \\frac{2 \\sum_{i} \\min(S_{1i}, S_{2i})}{\\sum_{i} (S_{1i} + S_{2i})}.\n$$\n对物种A、B、C、D、E求和：\n- $\\min(S_{1A},S_{2A})=\\min(0.40,0)=0$,\n- $\\min(S_{1B},S_{2B})=\\min(0.40,0)=0$,\n- $\\min(S_{1C},S_{2C})=\\min(0,0.40)=0$,\n- $\\min(S_{1D},S_{2D})=\\min(0,0.40)=0$,\n- $\\min(S_{1E},S_{2E})=\\min(0.20,0.20)=0.20$.\n因此 $\\sum_{i}\\min(S_{1i},S_{2i})=0.20$。\n\n对于分母，\n- $(S_{1A}+S_{2A})=0.40$,\n- $(S_{1B}+S_{2B})=0.40$,\n- $(S_{1C}+S_{2C})=0.40$,\n- $(S_{1D}+S_{2D})=0.40$,\n- $(S_{1E}+S_{2E})=0.40$,\n所以 $\\sum_{i}(S_{1i}+S_{2i})=2.00$。\n\n因此，\n$$\nBC = 1 - \\frac{2 \\times 0.20}{2.00} = 1 - 0.20 = 0.80.\n$$\n\n对于功能潜力相似度（途径集合的Jaccard相似度），定义\n$$\nP_{1}=\\{P1,P2,P3\\}, \\quad P_{2}=\\{P1,P2,P3\\}\n$$\n因为在样本1中，物种A贡献了$P1$，物种B贡献了$P2$，物种E贡献了$P3$；而在样本2中，物种C贡献了$P1$，物种D贡献了$P2$，物种E贡献了$P3$。\n\n因此 $|P_{1}\\cap P_{2}|=3$ 且 $|P_{1}\\cup P_{2}|=3$，得到\n$$\nFPS = \\frac{|P_{1}\\cap P_{2}|}{|P_{1}\\cup P_{2}|} = \\frac{3}{3} = 1.0.\n$$\n\n保留两位有效数字，结果为$BC=0.80$和$FPS=1.0$。", "answer": "$$\\boxed{(0.80, 1.0)}$$", "id": "2098789"}, {"introduction": "微生物组分析的最终目标之一是利用这些数据来解决实际的生物学和医学问题。本练习将你置于一个临床研究的前沿场景，探讨粪菌移植（Fecal Microbiota Transplant, FMT）这一新兴疗法的成功因素。你将扮演一名研究者，利用相关性分析来检验一个重要的假设：供体与受体之间初始的微生物组差异（$D_{pre}$）是否与移植的成功率（$E_s$）相关，从而学习如何将微生物组度量标准应用于假设检验和科学发现。[@problem_id:2098799]", "problem": "在临床微生物学领域，粪菌移植（Fecal Microbiota Transplant，FMT）是一种新兴疗法，用于治疗与肠道菌群失调相关的疾病，例如复发性*艰难梭菌*（*Clostridioides difficile*）感染。然而，FMT的成功率差异很大。一种假说认为，当受体治疗前的微生物组与供体的微生物组差异显著时，供体微生物组在受体体内的“定植”会更成功，因为这为新微生物的定居提供了更多的可用生态位。\n\n一个研究小组对六对患者-供体进行了研究以验证这一假说。对于每一对，他们量化了两个关键指标：\n1.  **治疗前贝塔多样性 ($D_{pre}$)**：该指标衡量FMT操作前供体和受体肠道微生物组之间的组成差异性。它使用布雷-柯蒂斯（Bray-Curtis）相异性指数计算，得出的值在0（微生物组相同）和1（微生物组完全不同，没有共享物种）之间。\n2.  **定植成功率 ($E_s$)**：这是一个归一化分数，范围从0到1，用于量化FMT后受体的微生物组与供体微生物组的相似程度。分数为0表示没有定植，而分数为1表示完美定植，即受体的微生物组特征已完全转变为与供体一致。\n\n从六对配对中收集的数据如下所示：\n\n| 患者-供体对 | 治疗前贝塔多样性 ($D_{pre}$) | 定植成功率 ($E_s$) |\n|:---:|:---:|:---:|\n| 1 | 0.58 | 0.50 |\n| 2 | 0.65 | 0.48 |\n| 3 | 0.78 | 0.75 |\n| 4 | 0.85 | 0.72 |\n| 5 | 0.92 | 0.90 |\n| 6 | 0.95 | 0.85 |\n\n为检验所提出的假说，请计算治疗前贝塔多样性 ($D_{pre}$) 与定植成功率 ($E_s$) 之间的皮尔逊相关系数 ($r$)。将您的最终答案四舍五入至三位有效数字。", "solution": "目标是计算两个变量之间的皮尔逊相关系数 $r$：治疗前贝塔多样性（我们记为 $x$）和定植成功率（我们记为 $y$）。$n=6$ 对配对的数据如下：\n$x = \\{0.58, 0.65, 0.78, 0.85, 0.92, 0.95\\}$\n$y = \\{0.50, 0.48, 0.75, 0.72, 0.90, 0.85\\}$\n\n皮尔逊相关系数的公式是：\n$$r = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^{n} (x_i - \\bar{x})^2 \\sum_{i=1}^{n} (y_i - \\bar{y})^2}}$$\n计算时使用了一个计算上更稳定的公式，该公式依赖于平方和与交叉乘积和：\n$$r = \\frac{S_{xy}}{\\sqrt{S_{xx} S_{yy}}}$$\n其中\n$S_{xx} = \\sum x_i^2 - \\frac{(\\sum x_i)^2}{n}$\n$S_{yy} = \\sum y_i^2 - \\frac{(\\sum y_i)^2}{n}$\n$S_{xy} = \\sum x_i y_i - \\frac{(\\sum x_i)(\\sum y_i)}{n}$\n\n首先，我们根据数据计算所需的总和。\n\n**第1步：计算每个变量的总和。**\n$$ \\sum x_i = 0.58 + 0.65 + 0.78 + 0.85 + 0.92 + 0.95 = 4.73 $$\n$$ \\sum y_i = 0.50 + 0.48 + 0.75 + 0.72 + 0.90 + 0.85 = 4.20 $$\n\n**第2步：计算每个变量的平方和。**\n$$ \\sum x_i^2 = (0.58)^2 + (0.65)^2 + (0.78)^2 + (0.85)^2 + (0.92)^2 + (0.95)^2 $$\n$$ \\sum x_i^2 = 0.3364 + 0.4225 + 0.6084 + 0.7225 + 0.8464 + 0.9025 = 3.8387 $$\n$$ \\sum y_i^2 = (0.50)^2 + (0.48)^2 + (0.75)^2 + (0.72)^2 + (0.90)^2 + (0.85)^2 $$\n$$ \\sum y_i^2 = 0.25 + 0.2304 + 0.5625 + 0.5184 + 0.81 + 0.7225 = 3.0938 $$\n\n**第3步：计算交叉乘积的和。**\n$$ \\sum x_i y_i = (0.58)(0.50) + (0.65)(0.48) + (0.78)(0.75) + (0.85)(0.72) + (0.92)(0.90) + (0.95)(0.85) $$\n$$ \\sum x_i y_i = 0.29 + 0.312 + 0.585 + 0.612 + 0.828 + 0.8075 = 3.4345 $$\n\n**第4步：计算 $S_{xx}$、$S_{yy}$ 和 $S_{xy}$。**\n数据对的数量为 $n=6$。\n$$ S_{xx} = \\sum x_i^2 - \\frac{(\\sum x_i)^2}{n} = 3.8387 - \\frac{(4.73)^2}{6} = 3.8387 - \\frac{22.3729}{6} = 3.8387 - 3.7288166... = 0.1098833... $$\n$$ S_{yy} = \\sum y_i^2 - \\frac{(\\sum y_i)^2}{n} = 3.0938 - \\frac{(4.20)^2}{6} = 3.0938 - \\frac{17.64}{6} = 3.0938 - 2.94 = 0.1538 $$\n$$ S_{xy} = \\sum x_i y_i - \\frac{(\\sum x_i)(\\sum y_i)}{n} = 3.4345 - \\frac{(4.73)(4.20)}{6} = 3.4345 - \\frac{19.866}{6} = 3.4345 - 3.311 = 0.1235 $$\n\n**第5步：计算皮尔逊相关系数 $r$。**\n$$ r = \\frac{S_{xy}}{\\sqrt{S_{xx} S_{yy}}} = \\frac{0.1235}{\\sqrt{(0.1098833...)(0.1538)}} $$\n$$ r = \\frac{0.1235}{\\sqrt{0.016899...}} = \\frac{0.1235}{0.129997...} \\approx 0.950016... $$\n\n**第6步：对最终答案进行四舍五入。**\n问题要求将最终答案四舍五入至三位有效数字。\n$$ r \\approx 0.950 $$\n强正相关（$r \\approx 0.950$）支持了以下假说：在FMT中，供体与受体微生物组之间更大的初始差异性与更高的定植成功率相关。", "answer": "$$\\boxed{0.950}$$", "id": "2098799"}]}