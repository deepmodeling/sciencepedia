{"hands_on_practices": [{"introduction": "在我们比较病原体基因组时，测序和分析流程的原始输出通常包含许多潜在的遗传差异。然而，并非所有这些差异都是生物学上真实的；许多可能是测序过程的产物或数据比对中的错误。第一个实践将指导您完成一个基本质量控制步骤：筛选单核苷酸多态性（SNPs），以从噪音中分离出高可信度的变异，这是任何可靠暴发调查的关键第一步。[@problem_id:2105558]", "problem": "一位微生物学家正在分析全基因组测序（WGS）数据，以调查一起医院获得性感染暴发事件。将来自一名患者的分离株与一份环境样本进行比较，得出了一个包含310个潜在单核苷酸多态性（SNP）的原始列表。为确保只有高质量的变异被用于系统发育分析，我们采用了一套标准的筛选流程。\n\n一个SNP被视为有效的筛选标准如下：\n1.  **质量分数（QUAL）：** Phred质量分数大于50。\n2.  **测序深度（DP）：** 测序深度至少为20，且不超过200。\n3.  **等位基因频率（AF）：** 变异等位基因的等位基因频率大于0.90。\n\n对这310个原始SNP的分析显示，不满足一个或多个标准的SNP计数如下：\n*   集合Q：60个SNP的QUAL分数小于或等于50。\n*   集合D：45个SNP的DP在可接受范围[20, 200]之外。\n*   集合A：55个SNP的AF小于或等于0.90。\n*   交集 $Q \\cap D$：15个SNP同时不满足QUAL和DP标准。\n*   交集 $Q \\cap A$：20个SNP同时不满足QUAL和AF标准。\n*   交集 $D \\cap A$：12个SNP同时不满足DP和AF标准。\n*   交集 $Q \\cap D \\cap A$：7个SNP三个标准都不满足。\n\n计算通过所有三个筛选标准，从而被视为高置信度变异的SNP数量。请以整数形式提供最终答案。", "solution": "设 $N_{\\text{total}}$ 表示原始SNP的总数，设 $Q$、$D$ 和 $A$ 分别为不满足QUAL、DP和AF标准的SNP集合。不满足至少一个标准的SNP数量即为并集 $Q \\cup D \\cup A$ 的基数，根据容斥原理计算如下：\n$$\n|Q \\cup D \\cup A| = |Q| + |D| + |A| - |Q \\cap D| - |Q \\cap A| - |D \\cap A| + |Q \\cap D \\cap A|.\n$$\n代入给定值：\n$$\n|Q \\cup D \\cup A| = 60 + 45 + 55 - 15 - 20 - 12 + 7 = 120.\n$$\n通过所有三个标准的SNP数量等于SNP总数减去至少不满足一个标准的SNP数量：\n$$\nN_{\\text{pass}} = N_{\\text{total}} - |Q \\cup D \\cup A| = 310 - 120 = 190.\n$$", "answer": "$$\\boxed{190}$$", "id": "2105558"}, {"introduction": "在识别出一组高质量的 SNPs 后，下一个挑战是正确解释它们的进化意义，尤其是在能够通过水平基因转移（HGT）交换 DNA 的细菌中。天真地将所有 SNPs 等同对待会严重扭曲我们对两个分离株亲缘关系远近的理解。本练习演示了如何区分核心的“克隆框架”进化和水平基因转移的扭曲效应，从而更准确地估计病原体之间的真实进化距离。[@problem_id:2105590]", "problem": "在一次食源性疾病暴发的公共卫生调查中，流行病学家使用全基因组测序(WGS)来追踪一种疑似病原体的传播，该病原体是一种高度重组的细菌物种。从两名不同患者（患者1和患者2）收集的分离株中对基因组进行测序。\n\n在比对两个基因组序列后，确定了总比对基因组长度为 $L_{total} = 4.50 \\times 10^6$ 个碱基对。简单的两两比较显示，两个分离株之间总共有 $N_{total} = 215$ 个单核苷酸多态性(SNPs)。\n\n进一步的生物信息学分析表明，在两个分离株的最近共同祖先之后，导致其中一个分离株的谱系中发生了一次大规模的水平基因转移(HGT)事件。一个长度为 $L_{HGT} = 6.00 \\times 10^4$ 个碱基对的连续基因组区域被确定为转移的片段。在这个特定区域内，有 $N_{HGT} = 185$ 个SNPs。基因组的其余部分，被称为“克隆框架”，被假定为通过二分裂和点突变进行垂直进化。\n\n为了量化这次HGT事件对进化距离估计的影响，请计算朴素成对核苷酸差异度与校正后克隆核苷酸差异度的比率。朴素差异度 $d_{naive}$ 是使用整个基因组中的所有SNPs计算的。校正后克隆差异度 $d_{clonal}$ 仅使用在克隆框架内发现的SNPs计算。\n\n计算比率 $\\frac{d_{naive}}{d_{clonal}}$ 并将最终答案四舍五入到三位有效数字。", "solution": "我们已知总比对基因组长度 $L_{total} = 4.50 \\times 10^{6}$，总SNPs数 $N_{total} = 215$，一个HGT片段长度 $L_{HGT} = 6.00 \\times 10^{4}$，其中包含 $N_{HGT} = 185$ 个SNPs。克隆框架不包括HGT区域。\n\n将朴素差异度定义为整个基因组的总SNP密度：\n$$\nd_{naive} = \\frac{N_{total}}{L_{total}}.\n$$\n将克隆差异度定义为仅在克隆框架中的SNP密度。克隆长度和克隆SNP数量为\n$$\nL_{clonal} = L_{total} - L_{HGT}, \\quad N_{clonal} = N_{total} - N_{HGT}.\n$$\n因此，\n$$\nd_{clonal} = \\frac{N_{clonal}}{L_{clonal}}.\n$$\n所求的比率为\n$$\n\\frac{d_{naive}}{d_{clonal}} = \\frac{\\frac{N_{total}}{L_{total}}}{\\frac{N_{clonal}}{L_{clonal}}} = \\frac{N_{total} L_{clonal}}{N_{clonal} L_{total}}.\n$$\n代入给定值：\n$$\nL_{clonal} = 4.50 \\times 10^{6} - 6.00 \\times 10^{4} = 4.44 \\times 10^{6}, \\quad N_{clonal} = 215 - 185 = 30.\n$$\n因此，\n$$\n\\frac{d_{naive}}{d_{clonal}} = \\frac{215 \\times \\left(4.44 \\times 10^{6}\\right)}{30 \\times \\left(4.50 \\times 10^{6}\\right)} = \\frac{215}{30} \\cdot \\frac{4.44}{4.50}.\n$$\n精确简化：\n$$\n\\frac{215}{30} = \\frac{43}{6}, \\quad \\frac{4.44}{4.50} = \\frac{444}{450} = \\frac{74}{75},\n$$\n所以\n$$\n\\frac{d_{naive}}{d_{clonal}} = \\frac{43}{6} \\cdot \\frac{74}{75} = \\frac{1591}{225} \\approx 7.071\\overline{1}.\n$$\n四舍五入到三位有效数字，结果为 $7.07$。", "answer": "$$\\boxed{7.07}$$", "id": "2105590"}, {"introduction": "基因组监测的最终目标是为公共卫生提供可操作的见解。当基因组数据与传统的流行病学数据（如患者位置和症状发作时间）相结合时，这一目标能最有效地实现。这最后一个实践模拟了一次真实的医院暴发调查，您将使用一个定量模型来结合 SNPs 距离和患者数据，以查明传播链中一个可能的“缺失环节”。[@problem_id:2105596]", "problem": "一家医院正在进行一项调查，以了解一次细菌性暴发的传播动态。医院已对所有已知感染患者的分离株进行了全基因组测序 (WGS)。任意两个分离株之间的遗传相关性通过其基因组之间的单核苷酸多态性 (SNP) 差异数量来量化。\n\n调查人员正重点关注两名特定患者——病例 K1 和病例 K2，他们被怀疑属于同一传播链。然而，他们分离株之间的遗传距离比直接传播事件所预期的要大，这表明存在一个或多个未被观察到的中间患者。另外四名同期住院但最初未被认为是该特定传播链一部分的患者（P1、P2、P3 和 P4），现在正作为潜在的中间患者接受评估。\n\n为了识别连接K1和K2的最可能中间患者，研究人员为每个潜在中间患者 (PI) 计算了一个“传播合理性评分”(TPS)。TPS最高的患者被认为是最可能的缺失环节。TPS被定义为遗传学评分和流行病学评分的乘积：\n\n$TPS(PI) = S_{genetic}(PI) \\times S_{epid}(PI)$\n\n遗传学评分 $S_{genetic}(PI)$ 衡量了中间患者的基因组在K1和K2之间路径上的吻合程度。它由以下公式给出：\n$$S_{genetic}(PI) = \\frac{1}{1 + |(\\text{SNP(K1, PI)} + \\text{SNP(PI, K2)}) - \\text{SNP(K1, K2)}|}$$\n其中 $\\text{SNP(A, B)}$ 是患者A和患者B之间的SNP距离。\n\n流行病学评分 $S_{epid}(PI)$ 根据位置和时间确定通过该中间患者的传播路径是否可能。它被定义为：\n$$S_{epid}(PI) = L(\\text{K1, PI}) \\times L(\\text{PI, K2})$$\n项 $L(\\text{A, B})$ 代表从患者A到患者B的一条合理传播链路。如果以下两个条件均满足，则 $L(\\text{A, B}) = 1$，否则 $L(\\text{A, B}) = 0$：\n1.  **时空重叠**：患者A和患者B在同一病房停留至少一整天。\n2.  **因果方向性**：患者B的症状出现日严格晚于患者A的症状出现日。\n\n相关数据如下。\n\n**表1：SNP距离矩阵**\n| | K1 | K2 | P1 | P2 | P3 | P4 |\n|:---:|:---:|:---:|:---:|:---:|:---:|:---:|\n| **K1**| 0 | 12 | 5 | 8 | 13 | 4 |\n| **K2**| 12 | 0 | 7 | 4 | 6 | 9 |\n| **P1**| 5 | 7 | 0 | 6 | 9 | 3 |\n| **P2**| 8 | 4 | 6 | 0 | 10 | 7 |\n| **P3**| 13 | 6 | 9 | 10 | 0 | 11|\n| **P4**| 4 | 9 | 3 | 7 | 11 | 0 |\n\n**表2：患者流行病学数据**\n| 患者 | 症状出现日 | 住院病房及时间 |\n|:---:|:---:|:---|\n| **K1**| 5 | A病房 (第1 - 8天) |\n| **K2**| 20 | C病房 (第18 - 25天) |\n| **P1**| 12 | A病房 (第7 - 10天), C病房 (第17 - 21天) |\n| **P2**| 10 | B病房 (第6 - 12天), D病房 (第12 - 16天) |\n| **P3**| 14 | A病房 (第6 - 12天), C病房 (第15 - 20天) |\n| **P4**| 9 | A病房 (第2 - 6天) |\n\n根据最高的传播合理性评分，哪位患者是连接病例K1和病例K2最可能的未被观察到的中间患者？\n\nA. P1\n\nB. P2\n\nC. P3\n\nD. P4", "solution": "我们需要为每个潜在中间患者 $PI \\in \\{P1,P2,P3,P4\\}$ 计算传播合理性评分\n$$\nTPS(PI) = S_{genetic}(PI) \\times S_{epid}(PI),\n$$\n其中\n$$\nS_{genetic}(PI) = \\frac{1}{1 + |(\\text{SNP(K1, PI)} + \\text{SNP(PI, K2)}) - \\text{SNP(K1, K2)}|}\n$$\n以及\n$$\nS_{epid}(PI) = L(\\text{K1, PI}) \\times L(\\text{PI, K2}).\n$$\n连接指标 $L(\\text{A, B})$ 等于1当且仅当以下两个条件均成立：(i) A和B在同一病房有至少一整天的重叠，以及 (ii) B的症状出现日严格晚于A的症状出现日；否则 $L(\\text{A, B})=0$。我们使用表2中的病房停留区间和症状出现日，以及表1中的SNP距离。\n\n首先，通过评估 $L(\\text{K1, PI})$ 和 $L(\\text{PI, K2})$ 来计算 $S_{epid}$。\n\n对于 $PI = P1$：\n- $L(\\text{K1, P1})$：K1于第 $[1,8]$ 天在A病房，P1于第 $[7,10]$ 天在A病房。重叠时间为 $[7,8]$，包含至少一整天。症状出现时间满足 $12 > 5$。因此 $L(\\text{K1, P1})=1$。\n- $L(\\text{P1, K2})$：P1于第 $[17,21]$ 天在C病房，K2于第 $[18,25]$ 天在C病房。重叠时间为 $[18,21]$，包含至少一整天。症状出现时间满足 $20 > 12$。因此 $L(\\text{P1, K2})=1$。\n所以 $S_{epid}(P1) = 1 \\times 1 = 1$。\n\n对于 $PI = P2$：\n- $L(\\text{K1, P2})$：K1在A病房；P2仅在B病房和D病房，因此没有同病房重叠。因此 $L(\\text{K1, P2})=0$。\n- $L(\\text{P2, K2})$：K2在C病房；P2不在C病房。因此 $L(\\text{P2, K2})=0$。\n所以 $S_{epid}(P2) = 0 \\times 0 = 0$。\n\n对于 $PI = P3$：\n- $L(\\text{K1, P3})$：K1于第 $[1,8]$ 天在A病房，P3于第 $[6,12]$ 天在A病房。重叠时间为 $[6,8]$，包含至少一整天，且 $14 > 5$。因此 $L(\\text{K1, P3})=1$。\n- $L(\\text{P3, K2})$：P3于第 $[15,20]$ 天在C病房，K2于第 $[18,25]$ 天在C病房。重叠时间为 $[18,20]$，包含至少一整天，且 $20 > 14$。因此 $L(\\text{P3, K2})=1$。\n所以 $S_{epid}(P3) = 1 \\times 1 = 1$。\n\n对于 $PI = P4$：\n- $L(\\text{K1, P4})$：K1于第 $[1,8]$ 天在A病房，P4于第 $[2,6]$ 天在A病房。重叠时间为 $[2,6]$，包含至少一整天，且 $9 > 5$。因此 $L(\\text{K1, P4})=1$。\n- $L(\\text{P4, K2})$：P4仅在A病房；K2仅在C病房。没有同病房重叠，所以 $L(\\text{P4, K2})=0$。\n所以 $S_{epid}(P4) = 1 \\times 0 = 0$。\n\n接下来，使用表1中的SNP距离为每个$PI$计算$S_{genetic}$，注意 $\\text{SNP(K1, K2)} = 12$。\n\n对于 $PI = P1$：\n$$\n\\text{SNP(K1, P1)} = 5,\\quad \\text{SNP(P1, K2)} = 7,\\quad 5 + 7 = 12.\n$$\n因此\n$$\nS_{genetic}(P1) = \\frac{1}{1 + |12 - 12|} = \\frac{1}{1 + 0} = 1.\n$$\n\n对于 $PI = P2$：\n$$\n\\text{SNP(K1, P2)} = 8,\\quad \\text{SNP(P2, K2)} = 4,\\quad 8 + 4 = 12.\n$$\n因此\n$$\nS_{genetic}(P2) = \\frac{1}{1 + |12 - 12|} = 1.\n$$\n\n对于 $PI = P3$：\n$$\n\\text{SNP(K1, P3)} = 13,\\quad \\text{SNP(P3, K2)} = 6,\\quad 13 + 6 = 19.\n$$\n因此\n$$\nS_{genetic}(P3) = \\frac{1}{1 + |19 - 12|} = \\frac{1}{1 + 7} = \\frac{1}{8}.\n$$\n\n对于 $PI = P4$：\n$$\n\\text{SNP(K1, P4)} = 4,\\quad \\text{SNP(P4, K2)} = 9,\\quad 4 + 9 = 13.\n$$\n因此\n$$\nS_{genetic}(P4) = \\frac{1}{1 + |13 - 12|} = \\frac{1}{1 + 1} = \\frac{1}{2}.\n$$\n\n最后，计算 $TPS$：\n- $TPS(P1) = S_{genetic}(P1) \\times S_{epid}(P1) = 1 \\times 1 = 1$。\n- $TPS(P2) = 1 \\times 0 = 0$。\n- $TPS(P3) = \\frac{1}{8} \\times 1 = \\frac{1}{8}$。\n- $TPS(P4) = \\frac{1}{2} \\times 0 = 0$。\n\n最高的传播合理性评分属于$P1$。因此，最可能的中间患者是选项A。", "answer": "$$\\boxed{A}$$", "id": "2105596"}]}