{"hands_on_practices": [{"introduction": "合成生物学的一个核心目标是指导细胞群落形成预先设定的空间图案。本练习将探讨一个基本策略：细胞如何通过感知来自相反方向的两种信号梯度来确定自身位置。通过将这些输入信号与一个基因“与门”（AND gate）逻辑相结合，我们可以精确地控制特定区域内基因的表达，从而创造出像发光环这样的复杂图案 [@problem_id:2069368]。这个实践将帮助你掌握利用梯度和逻辑门进行空间编程的基础。", "problem": "一个合成生物学家团队正在设计一个细菌菌落，以在圆形培养皿上形成特定的空间图案。该菌落生长成一个半径为 $R$ 的均匀圆形圆盘。目标是通过让细菌仅在特定的环形区域内表达绿色荧光蛋白 (GFP) 来创建一个发光环。\n\nGFP 的表达由一个遗传“与”门控制，这意味着只有当两个条件同时满足时，GFP 基因才会被转录。这些条件取决于两种不同分子的局部浓度：一种是内部信号分子 `A`，另一种是外部营养物质 `N`。\n\n1.  **分子 A**：该分子由细菌产生，并从菌落中心向外扩散。其在距离菌落中心径向距离为 $r$ 处的稳态浓度 $C_A(r)$ 由以下线性函数建模：\n    $$C_A(r) = C_{A,0} \\left(1 - \\frac{r}{R}\\right)$$\n    其中 $C_{A,0}$ 是中心（$r=0$）处的浓度。GFP 表达的第一个条件是 `A` 的局部浓度必须超过一个阈值 $K_A$。\n\n2.  **营养物质 N**：这种营养物质由菌落边缘的生长培养基提供，并向内扩散，沿途被细胞消耗。其稳态浓度 $C_N(r)$ 由以下线性函数建模：\n    $$C_N(r) = C_{N,0} \\frac{r}{R}$$\n    其中 $C_{N,0}$ 是边缘（$r=R$）处的浓度。GFP 表达的第二个条件是 `N` 的局部浓度必须超过一个阈值 $K_N$。\n\n激活阈值被定义为最大浓度的分数：$K_A = \\alpha C_{A,0}$ 和 $K_N = \\beta C_{N,0}$，其中 $\\alpha$ 和 $\\beta$ 是无量纲常数，满足 $0 < \\alpha < 1$ 和 $0 < \\beta < 1$。\n\n假设条件 $\\alpha + \\beta < 1$ 成立，这确保了荧光环可以形成。请确定发光环宽度 $\\Delta r$ 的解析表达式。用菌落半径 $R$ 以及无量纲参数 $\\alpha$ 和 $\\beta$ 来表示你的答案。", "solution": "GFP 仅在两个条件同时满足的地方表达：分子 A 的局部浓度超过其阈值，且营养物质 N 的局部浓度超过其阈值。我们使用给定的稳态分布和阈值，按以下步骤进行。\n\n对于分子 A，其浓度分布为 $C_{A}(r) = C_{A,0}\\left(1 - \\frac{r}{R}\\right)$，阈值为 $K_{A} = \\alpha C_{A,0}$，且 $0 < \\alpha < 1$。条件 $C_{A}(r) > K_{A}$ 变为\n$$\nC_{A,0}\\left(1 - \\frac{r}{R}\\right) > \\alpha C_{A,0}.\n$$\n假设 $C_{A,0} > 0$，两边同时除以 $C_{A,0}$ 得到\n$$\n1 - \\frac{r}{R} > \\alpha \\quad \\Rightarrow \\quad \\frac{r}{R} < 1 - \\alpha \\quad \\Rightarrow \\quad r < (1 - \\alpha)R.\n$$\n\n对于营养物质 N，其浓度分布为 $C_{N}(r) = C_{N,0}\\frac{r}{R}$，阈值为 $K_{N} = \\beta C_{N,0}$，且 $0 < \\beta < 1$。条件 $C_{N}(r) > K_{N}$ 变为\n$$\nC_{N,0}\\frac{r}{R} > \\beta C_{N,0}.\n$$\n假设 $C_{N,0} > 0$，两边同时除以 $C_{N,0}$ 得到\n$$\n\\frac{r}{R} > \\beta \\quad \\Rightarrow \\quad r > \\beta R.\n$$\n\n“与”门要求两个条件同时成立，因此 GFP 表达的允许径向区域是\n$$\n\\beta R < r < (1 - \\alpha)R.\n$$\n当且仅当 $\\alpha + \\beta < 1$ 时（如题所设），该区间非空。发光环的宽度是外半径与内半径之差：\n$$\n\\Delta r = (1 - \\alpha)R - \\beta R = (1 - \\alpha - \\beta)R.\n$$\n因此，环宽度的解析表达式为 $\\Delta r = (1 - \\alpha - \\beta)R$。", "answer": "$$\\boxed{(1 - \\alpha - \\beta) R}$$", "id": "2069368"}, {"introduction": "除了简单的图案，我们还能让细胞群落执行计算任务吗？本练习将向你展示如何利用一个常见的基因线路基序——非相干前馈环（incoherent feed-forward loop, IFFL）——来实现复杂的邻里逻辑 [@problem_id:2069394]。通过设计一个能够产生“带通”（band-pass）响应的电路，细胞可以根据其邻居的状态执行“异或”（XOR）运算，这是构建生物计算设备和复杂自组织系统的重要一步。", "problem": "合成生物学家旨在通过设计处理局部信息的基因回路，来工程化细胞群体的集体行为。考虑一个由工程化细胞组成的一维细丝，其被设计为一个简单的细胞自动机（CA），其中每个细胞在下一个时间步的状态由其直接邻居的当前状态决定。\n\n细胞的状态由其荧光定义：开启（荧光）或关闭（非荧光）。一个细胞的回路被设计用来为其下一状态实现一种“异或”（XOR）逻辑规则：当且仅当其两个邻居中恰好有一个当前处于开启状态时，该细胞才会开启。这种行为是通过对输入信号的“带通”响应来实现的。\n\n一个开启状态的细胞会发出信号，其邻居细胞可以检测到该信号。给定细胞内的总输入信号浓度 $S$ 与其当前处于开启状态的邻居数量成正比。细胞在稳态下的荧光输出水平 $Y$ 由一个非相干前馈环路电路控制，其模型由以下响应函数给出：\n\n$$Y(S) = \\alpha \\frac{\\frac{S}{K_{A}}}{1 + \\frac{S}{K_{A}}} \\cdot \\frac{1}{1 + \\frac{S}{K_{R}}}$$\n\n此处，$S$ 是非负的输入信号浓度。参数 $\\alpha$、$K_A$ 和 $K_R$ 是正实数常量，分别代表最大可能输出、激活阈值常数和抑制阈值常数。\n\n为了正确实现XOR逻辑，当信号 $S$ 对应于恰好一个开启状态的邻居时，输出 $Y$ 必须达到最大值。确定使输出 $Y(S)$ 最大化的特定信号浓度 $S_{\\text{opt}}$。用 $K_A$ 和 $K_R$ 的符号表达式来表示你的答案。", "solution": "问题要求找到使细胞输出函数 $Y(S)$ 最大化的信号浓度 $S_{\\text{opt}}$。给定的函数是：\n$$Y(S) = \\alpha \\frac{\\frac{S}{K_{A}}}{1 + \\frac{S}{K_{A}}} \\cdot \\frac{1}{1 + \\frac{S}{K_{R}}}$$\n首先，我们可以对这个表达式进行代数化简。\n$$Y(S) = \\alpha \\left( \\frac{\\frac{S}{K_{A}}}{\\frac{K_{A}+S}{K_{A}}} \\right) \\left( \\frac{1}{\\frac{K_{R}+S}{K_{R}}} \\right)$$\n$$Y(S) = \\alpha \\left( \\frac{S}{K_{A}+S} \\right) \\left( \\frac{K_{R}}{K_{R}+S} \\right)$$\n$$Y(S) = \\alpha K_{R} \\frac{S}{(S+K_{A})(S+K_{R})}$$\n为了找到使 $Y(S)$ 最大化的 $S$ 值，我们需要求 $Y(S)$ 关于 $S$ 的导数，并令其为零。$\\alpha K_R$ 项是一个正常数，因此在寻找最大值位置时可以忽略它。我们来关注函数中依赖于 $S$ 的部分：\n$$f(S) = \\frac{S}{(S+K_{A})(S+K_{R})} = \\frac{S}{S^{2} + (K_{A}+K_{R})S + K_{A}K_{R}}$$\n我们将使用求导的商法则，该法则指出，对于函数 $f(S) = u(S)/v(S)$，其导数为 $f'(S) = (u'v - uv')/v^2$。\n这里，$u(S) = S$ 且 $v(S) = S^2 + (K_A+K_R)S + K_A K_R$。\n\n$u(S)$ 和 $v(S)$ 的导数是：\n$$u'(S) = 1$$\n$$v'(S) = 2S + K_{A}+K_{R}$$\n\n现在，我们可以计算导数 $f'(S)$ 的分子部分：\n$$u'v - uv' = (1)(S^{2} + (K_{A}+K_{R})S + K_{A}K_{R}) - (S)(2S + K_{A}+K_{R})$$\n展开各项：\n$$= S^{2} + K_{A}S + K_{R}S + K_{A}K_{R} - 2S^{2} - K_{A}S - K_{R}S$$\n合并同类项，我们看到 $K_A S$ 和 $K_R S$ 被消掉了：\n$$= S^{2} - 2S^{2} + K_{A}K_{R}$$\n$$= -S^{2} + K_{A}K_{R}$$\n完整的导数是：\n$$\\frac{dY}{dS} = \\alpha K_{R} \\frac{-S^{2} + K_{A}K_{R}}{((S+K_{A})(S+K_{R}))^{2}}$$\n为了求最大值，我们令导数为零。一个分数为零，当且仅当其分子为零，且分母不为零。由于 $S$、$K_A$ 和 $K_R$ 都是正数，分母恒为正。\n$$-S^{2} + K_{A}K_{R} = 0$$\n$$S^{2} = K_{A}K_{R}$$\n解出 $S$，我们得到两个可能的解：$S = \\sqrt{K_A K_R}$ 和 $S = -\\sqrt{K_A K_R}$。因为 $S$ 代表信号浓度，它必须是一个非负量。因此，我们舍弃负根。\n最优信号浓度 $S_{\\text{opt}}$ 是：\n$$S_{opt} = \\sqrt{K_{A}K_{R}}$$\n为了确认这是一个最大值，我们可以检查二阶导数的符号或分析一阶导数。$\\frac{dY}{dS}$ 的分母恒为正。分子 $-S^{2} + K_{A}K_{R}$ 在 $S  \\sqrt{K_A K_R}$ 时为正，在 $S > \\sqrt{K_A K_R}$ 时为负。这意味着 $Y(S)$ 在 $S_{\\text{opt}}$ 之前是递增的，在 $S_{\\text{opt}}$ 之后是递减的，这证实了 $S_{\\text{opt}}$ 确实是一个局部最大值点。由于 $Y(0)=0$ 并且当 $S \\to \\infty$ 时 $Y(S) \\to 0$，所以这是 $S > 0$ 范围内的全局最大值。", "answer": "$$\\boxed{\\sqrt{K_{A} K_{R}}}$$", "id": "2069394"}, {"introduction": "静态图案是第一步，而动态可控的图案则开启了更多可能性。本练习引入了“记忆”的概念，即细胞如何利用双稳态基因开关来维持一个特定的状态。你将学习如何通过结合具有记忆功能的基因开关与局部扩散信号和全局擦除信号，来设计一个不仅能形成、还能主动擦除和重写的空间图案系统 [@problem_id:2069384]。这使得我们从设计静态图案，迈向了构建动态、可控的生物材料。", "problem": "一个合成生物学研究团队正在设计一个系统，用于在工程细菌的一维菌落中创建可重写的空间图案。每个细菌都配备了一个由两种相互抑制的蛋白质 `U` 和 `V` 控制的基因拨动开关。当蛋白质 `U` 的浓度高而 `V` 的浓度低时，细胞被定义为处于“ON”状态。相反，当蛋白质 `V` 的浓度高而 `U` 的浓度低时，细胞处于“OFF”状态。\n\n“ON”状态的细胞被设计为产生一种可扩散的信号分子 `S`。这种分子可以触发相邻的“OFF”状态细胞切换到“ON”状态，从而使得一旦由瞬时局部刺激引发的图案变得稳定并能自我传播。为了使图案可重写，可以向系统中引入一种全局化学物质 `B`，通过迫使所有“ON”状态的细胞切换到“OFF”状态来擦除图案。\n\n拨动开关的动力学通过一个简化模型来近似，该模型假设具有非常高的协同性，其中生产速率表现为阶跃函数：\n- 如果 `V` 的浓度（表示为$[V]$）小于抑制阈值$K_V$，则 `U` 的生产速率为$P_U = \\alpha_U$。否则，$P_U = 0$。\n- 如果 `U` 的浓度（表示为$[U]$）小于抑制阈值$K_U$，则 `V` 的生产速率为$P_V = \\alpha_V$。否则，$P_V = 0$。\n\n外部的分子影响蛋白质的降解速率：\n- 全局擦除剂 `B` 在均匀浓度$b$下，会增强蛋白质 `U` 的降解。`U` 的总降解速率为$(\\delta_U + k_B b)$，其中$\\delta_U$是基础降解速率，$k_B$是有效性常数。\n- 局部信号分子 `S` 在局部浓度$s$下，会增强蛋白质 `V` 的降解。`V` 的总降解速率为$(\\delta_V + k_S s)$，其中$\\delta_V$是基础降解速率，$k_S$是一个常数。\n\n在稳态下，蛋白质的浓度是恒定的，这意味着其生产速率等于其降解速率。例如，对于蛋白质 `U`，有$P_U - (\\delta_U + k_B b)[U] = 0$。\n\n考虑一个稳定的、已建立的图案，其中一排“ON”状态的细胞与“OFF”状态的细胞相邻。位于“ON”区域最边缘的一个细胞自身处于“ON”状态，并从其唯一的“ON”状态邻居那里接收到浓度恒为$s = s_0$的信号分子。\n\n确定必须全局施加的擦除剂分子的最小浓度$b_{\\text{crit}}$，以迫使这个边界上的“ON”状态细胞切换到“OFF”状态，从而引发整个图案的崩溃。请将您的答案表示为关于给定参数$\\alpha_U, \\alpha_V, K_U, K_V, \\delta_U, \\delta_V, k_B, k_S$和$s_0$的单一闭式解析表达式。", "solution": "我们使用阶跃函数生产和受外部分子影响的线性降解来模拟高协同性的拨动开关。令$[U]$和$[V]$表示稳态浓度。在稳态下，每种蛋白质的生产速率等于降解速率：\n$$\nP_{U} - (\\delta_{U} + k_{B} b)[U] = 0, \\qquad P_{V} - (\\delta_{V} + k_{S} s)[V] = 0.\n$$\n\n在一个“ON”状态的细胞中，$[V]  K_{V}$，因此$P_{U} = \\alpha_{U}$；同时$[U] \\ge K_{U}$，因此$P_{V} = 0$。当$P_{V} = 0$且V只有降解过程时，稳态为$[V] = 0$，这确实自洽地满足了$[V]  K_{V}$。因此，在均匀的擦除剂水平$b$下，“ON”状态下U的稳态浓度是\n$$\n[U]_{\\text{ON}} = \\frac{\\alpha_{U}}{\\delta_{U} + k_{B} b}.\n$$\n为了使“ON”状态自洽，我们必须有$[U]_{\\text{ON}} \\ge K_{U}$。破坏“ON”状态的最小擦除剂水平$b_{\\text{crit}}$可以通过在阈值处设置等式来获得，\n$$\n\\frac{\\alpha_{U}}{\\delta_{U} + k_{B} b_{crit}} = K_{U},\n$$\n这给出\n$$\n\\alpha_{U} = K_{U}(\\delta_{U} + k_{B} b_{crit}) \\quad \\Longrightarrow \\quad b_{crit} = \\frac{\\alpha_{U}}{k_{B} K_{U}} - \\frac{\\delta_{U}}{k_{B}}.\n$$\n\n一旦$b > b_{\\text{crit}}$，我们有$[U]  K_{U}$，这会开启V的生产，$P_{V} = \\alpha_{V}$。在边界细胞中，局部信号为$s = s_0$，所以在$P_{V} = \\alpha_{V}$条件下V的稳态是\n$$\n[V]_{\\text{ON}\\to\\text{OFF}} = \\frac{\\alpha_{V}}{\\delta_{V} + k_{S} s_{0}}.\n$$\n为了让细胞完全切换到“OFF”状态（以便此后$P_{U} = 0$），我们需要$[V] \\ge K_{V}$来抑制U，即\n$$\n\\frac{\\alpha_{V}}{\\delta_{V} + k_{S} s_{0}} \\ge K_{V}.\n$$\n这个条件与$b$无关，它确保一旦$b$超过$b_{\\text{crit}}$，V浓度的上升足以抑制U并完成向“OFF”状态的切换。在此条件下，引发崩溃的最小擦除剂水平恰好是上面推导出的阈值$b_{\\text{crit}}$。对$s_{0}$的依赖性仅通过“OFF”状态的可行性进入，而不影响$b_{\\text{crit}}$本身的数值。\n\n因此，只要满足$\\alpha_{V}/(\\delta_{V} + k_{S} s_{0}) \\ge K_{V}$以确保边界处可以达到“OFF”状态，那么翻转边界“ON”细胞所需的最小擦除剂浓度为\n$$\nb_{\\text{crit}} = \\frac{\\alpha_{U}}{k_{B} K_{U}} - \\frac{\\delta_{U}}{k_{B}}.\n$$", "answer": "$$\\boxed{\\frac{\\alpha_{U}}{k_{B} K_{U}} - \\frac{\\delta_{U}}{k_{B}}}$$", "id": "2069384"}]}