{"hands_on_practices": [{"introduction": "合成生物学面临的首要挑战之一是确保来自一个生物体的基因在另一个生物体中良好表达。这通常归结为密码子使用偏好性，即生物体对编码相同氨基酸的不同密码子存在偏好。本练习介绍了一种简单而有效的方法，用于评估基因与宿主生物的兼容性，让您通过计算密码子优化分数（COS）来指导基因设计。[@problem_id:2047899]", "problem": "一个合成生物学家团队正致力于在一种新型细菌宿主 *Synthetica rapidus* 中表达一种小分子非天然多肽。为了优化蛋白质产量，他们的目标是合成一个能良好适应宿主翻译机制的基因序列。一种预测表达水平的简单方法是根据宿主的密码子使用偏好性计算一个分数。\n\n你的任务是基于此方法评估一个候选核糖核酸（RNA）序列。该预测分数被称为密码子优化分数（Codon Optimization Score, COS），其定义为序列中所有密码子相对适应度值的几何平均值。\n\n特定密码子 $i$ 的相对适应度 $w_i$ 计算方式为，其使用频率与编码相同氨基酸的最常用同义密码子的使用频率之比：\n$$w_i = \\frac{f_i}{f_{\\text{max}}}$$\n其中 $f_i$ 是密码子 $i$ 的频率，$f_{\\text{max}}$ 是该氨基酸最常用密码子的频率。\n\n那么，一个包含 $L$ 个密码子的序列的密码子优化分数（COS）为：\n$$ \\text{COS} = \\left( \\prod_{i=1}^{L} w_i \\right)^{1/L} $$\n\n给定候选RNA序列 $\\text{5'-UCGCUACCG-3'}$ 以及下方 *Synthetica rapidus* 的密码子使用表（频率以每千个密码子中的出现次数给出），请计算该序列的COS。将最终答案四舍五入至三位有效数字。\n\n** *Synthetica rapidus* 密码子使用表（部分）**\n\n| 氨基酸      | 密码子 | 频率 (/1000) |\n|-------------|-------|-------------------|\n| 亮氨酸 (Leu)| UUA   | 7.7               |\n|             | UUG   | 12.9              |\n|             | CUU   | 19.6              |\n|             | CUC   | 19.5              |\n|             | CUA   | 7.2               |\n|             | CUG   | 39.6              |\n| 脯氨酸 (Pro)| CCU   | 17.5              |\n|             | CCC   | 19.9              |\n|             | CCA   | 17.0              |\n|             | CCG   | 6.9               |\n| 丝氨酸 (Ser) | UCU   | 15.2              |\n|             | UCC   | 17.6              |\n|             | UCA   | 12.1              |\n|             | UCG   | 4.4               |\n|             | AGU   | 12.2              |\n|             | AGC   | 19.5              |", "solution": "该序列长度为九个核苷酸，因此编码三个密码子：$\\text{UCG}$、$\\text{CUA}$ 和 $\\text{CCG}$。它们分别对应丝氨酸（Ser）、亮氨酸（Leu）和脯氨酸（Pro）。\n\n根据定义，密码子 $i$ 相对于其氨基酸的相对适应度为 $w_{i} = \\frac{f_{i}}{f_{\\text{max}}}$。使用所提供的表格：\n\n- 对于丝氨酸：可用密码子及其频率为 $UCU:15.2$、$UCC:17.6$、$UCA:12.1$、$UCG:4.4$、$AGU:12.2$、$AGC:19.5$。最大频率为 $f_{\\text{max}}=19.5$（对应密码子 $AGC$）。因此，\n$$\nw_{UCG} = \\frac{4.4}{19.5} = \\frac{44}{195}.\n$$\n\n- 对于亮氨酸：密码子及其频率为 $UUA:7.7$、$UUG:12.9$、$CUU:19.6$、$CUC:19.5$、$CUA:7.2$、$CUG:39.6$。最大频率为 $f_{\\text{max}}=39.6$（对应密码子 $CUG$）。因此，\n$$\nw_{CUA} = \\frac{7.2}{39.6} = \\frac{72}{396} = \\frac{2}{11}.\n$$\n\n- 对于脯氨酸：密码子及其频率为 $CCU:17.5$、$CCC:19.9$、$CCA:17.0$、$CCG:6.9$。最大频率为 $f_{\\text{max}}=19.9$（对应密码子 $CCC$）。因此，\n$$\nw_{CCG} = \\frac{6.9}{19.9} = \\frac{69}{199}.\n$$\n\n对于 $L=3$ 个密码子，其密码子优化分数（COS）是几何平均值：\n$$\n\\text{COS} = \\left( \\prod_{i=1}^{3} w_{i} \\right)^{\\frac{1}{3}} = \\left( \\frac{44}{195} \\cdot \\frac{2}{11} \\cdot \\frac{69}{199} \\right)^{\\frac{1}{3}}.\n$$\n将乘积项相乘并化简：\n$$\n\\frac{44 \\cdot 2 \\cdot 69}{195 \\cdot 11 \\cdot 199} = \\frac{6072}{426855} = \\frac{2024}{142285} = \\frac{184}{12935}.\n$$\n因此，\n$$\n\\text{COS} = \\left( \\frac{184}{12935} \\right)^{\\frac{1}{3}}.\n$$\n为求得数值，首先将分数表示为小数/科学记数法形式：\n$$\n\\frac{184}{12935} \\approx 0.014224971 \\approx 1.4224971 \\times 10^{-2}.\n$$\n使用性质 $(ab)^{\\frac{1}{3}} = a^{\\frac{1}{3}} b^{\\frac{1}{3}}$：\n$$\n\\text{COS} = \\left(1.4224971\\right)^{\\frac{1}{3}} \\cdot 10^{-\\frac{2}{3}}.\n$$\n数值计算上，$\\left(1.4224971\\right)^{\\frac{1}{3}} \\approx 1.12465$ 且 $10^{-\\frac{2}{3}} \\approx 0.215443$，得出\n$$\n\\text{COS} \\approx 1.12465 \\times 0.215443 \\approx 0.242298.\n$$\n四舍五入至三位有效数字，得到 $0.242$。", "answer": "$$\\boxed{0.242}$$", "id": "2047899"}, {"introduction": "当预测模型能够指导我们的工程设计时，其威力才能最大化。本实践将从简单地为序列评分，推进到使用模型系统地探索突变效应。您将使用位置权重矩阵（PWM）对一个启动子序列进行“计算机模拟”的突变扫描，这是一种预测DNA变化如何影响生物活性的基石模型。[@problem_id:2047881]", "problem": "在合成生物学中，预测模型常用于在实验室合成遗传元件（如启动子）之前，估算其强度。一种常见的用于评估启动子强度的简单模型是位置权重矩阵 (PWM)。该模型根据每个位置上各个核苷酸（A、C、G、T）的贡献，为脱氧核糖核酸 (DNA) 序列指定一个分数。启动子的总预测活性 $S$ 是其序列中每个位置上碱基分数的总和。\n\n一位生物工程师正在研究一个 5 个碱基对 (bp) 的野生型 (WT) 启动子序列：$\\text{5'-GATCA-3'}$。他们使用以下 PWM 来预测启动子活性，其中的分数是无单位的。\n\n**位置权重矩阵 (PWM)**\n\n| 碱基 | 位置 1 | 位置 2 | 位置 3 | 位置 4 | 位置 5 |\n| :--- | :---: |:---: |:---: |:---: |:---: |\n| A    | 0.1   | -1.5  | 0.8   | -1.2  | 0.5   |\n| C    | -0.5  | 0.5   | -0.8  | 1.0   | 0.1   |\n| G    | 1.2   | -1.0  | -0.5  | -0.5  | -1.0  |\n| T    | -1.0  | 1.5   | 0.4   | 0.5   | 1.2   |\n\n该工程师决定进行一次*计算机模拟*突变扫描，以寻找可能提高启动子强度的突变。这包括在野生型序列中系统地创建每个可能的单碱基替换，并计算由此产生的活性变化 $\\Delta S = S_{\\text{mutant}} - S_{\\text{WT}}$。\n\n你的任务是找出导致预测活性*增加*最大的单碱基替换。这个最大的正 $\\Delta S$ 值是多少？\n\n将你的最终答案四舍五入到两位有效数字。", "solution": "位置权重矩阵 (PWM) 模型通过对各个位置上碱基的贡献求和，为序列指定一个总分 $S$：\n$$\nS=\\sum_{i=1}^{5} w_{i}(b_{i}),\n$$\n其中 $w_{i}(b_{i})$ 是碱基 $b_{i}$ 在位置 $i$ 的 PWM 分数。对于位置 $i$ 处从野生型碱基 $b_{\\text{WT}}$ 到突变型碱基 $b_{\\text{mut}}$ 的单碱基替换，其活性变化为\n$$\n\\Delta S=S_{\\text{mutant}}-S_{\\text{WT}}=w_{i}(b_{\\text{mut}})-w_{i}(b_{\\text{WT}}),\n$$\n因为所有其他位置都保持不变。\n\n野生型序列是 $\\text{5'-GATCA-3'}$，因此位置 1 到 5 的碱基分别是 G、A、T、C、A。使用 PWM：\n\n- 位置 1（野生型 G，分数为 $1.2$）：可能的突变体 A、C、T\n$$\n\\Delta S(A)=0.1-1.2=-1.1,\\quad \\Delta S(C)=-0.5-1.2=-1.7,\\quad \\Delta S(T)=-1.0-1.2=-2.2.\n$$\n位置 1 的最大值为 $-1.1$（没有增加）。\n\n- 位置 2（野生型 A，分数为 $-1.5$）：可能的突变体 C、G、T\n$$\n\\Delta S(C)=0.5-(-1.5)=2.0,\\quad \\Delta S(G)=-1.0-(-1.5)=0.5,\\quad \\Delta S(T)=1.5-(-1.5)=3.0.\n$$\n位置 2 的最大值为 $3.0$（有增加）。\n\n- 位置 3（野生型 T，分数为 $0.4$）：可能的突变体 A、C、G\n$$\n\\Delta S(A)=0.8-0.4=0.4,\\quad \\Delta S(C)=-0.8-0.4=-1.2,\\quad \\Delta S(G)=-0.5-0.4=-0.9.\n$$\n位置 3 的最大值为 $0.4$（有增加）。\n\n- 位置 4（野生型 C，分数为 $1.0$）：可能的突变体 A、G、T\n$$\n\\Delta S(A)=-1.2-1.0=-2.2,\\quad \\Delta S(G)=-0.5-1.0=-1.5,\\quad \\Delta S(T)=0.5-1.0=-0.5.\n$$\n位置 4 的最大值为 $-0.5$（没有增加）。\n\n- 位置 5（野生型 A，分数为 $0.5$）：可能的突变体 C、G、T\n$$\n\\Delta S(C)=0.1-0.5=-0.4,\\quad \\Delta S(G)=-1.0-0.5=-1.5,\\quad \\Delta S(T)=1.2-0.5=0.7.\n$$\n位置 5 的最大值为 $0.7$（有增加）。\n\n在所有位置中，最大的正 $\\Delta S$ 是 $3.0$，来自位置 2 处 $A \\to T$ 的替换。四舍五入到两位有效数字，结果为 $3.0$。", "answer": "$$\\boxed{3.0}$$", "id": "2047881"}, {"introduction": "一个预测模型的优劣取决于我们衡量其性能的能力，尤其是在寻找像高活性酶这样的罕见事件时。在这种情况下，简单的准确率可能具有欺骗性。本练习将挑战您超越准确率，使用更稳健的指标，如精确率（precision）、召回率（recall）和$F_1$分数，来评估一个分类器在真实的、非平衡数据集中的有效性。[@problem_id:2047917]", "problem": "一个合成生物学实验室正在使用机器学习模型来筛选一个大型的、由计算生成的酶变体库。其主要目标是高效地识别具有极高催化活性的稀有变体，这些变体的实验验证成本高昂且耗时。\n\n为了评估该模型的预测能力，研究人员在一个包含 20,000 个独特酶变体的库上对其进行了测试。在这个测试集中，根据先前的详尽分析已知，确切地有 150 个变体是“高活性”（正类），其余变体是“低活性”（负类）。\n\n当该分类模型应用于此测试库时，它产生了以下结果：\n- 它正确识别了 120 个高活性变体。\n- 它将 300 个低活性变体错误地分类为高活性。\n\n简单的准确率可能是一个具有误导性的性能指标，尤其是在存在如此严重的类别不平衡的情况下。一个更稳健的指标是正类的 F1-score。F1-score 定义为精确率（Precision）和召回率（Recall）的调和平均数。精确率是预测为正例的样本中实际为正例的比例，而召回率是所有实际正例中被正确识别的比例。\n\n根据模型在测试库上的表现，计算“高活性”类的 F1-score。将您的答案以无量纲的小数值形式报告，并四舍五入到三位有效数字。", "solution": "我们已知实际正例的总数和模型的分类结果。定义以下标准量：\n- 真正例 (True positives): $TP=120$。\n- 假正例 (False positives): $FP=300$。\n- 实际正例 (Actual positives): $P=150$，因此假负例 (false negatives) $FN=P-TP=150-120=30$。\n\n正类的精确率定义为\n$$\\text{Precision}=\\frac{TP}{TP+FP}=\\frac{120}{120+300}=\\frac{120}{420}=\\frac{2}{7}.$$\n\n正类的召回率定义为\n$$\\text{Recall}=\\frac{TP}{TP+FN}=\\frac{120}{120+30}=\\frac{120}{150}=\\frac{4}{5}.$$\n\nF1-score 是精确率和召回率的调和平均数：\n$$F_{1}=\\frac{2\\cdot \\text{Precision}\\cdot \\text{Recall}}{\\text{Precision}+\\text{Recall}}=\\frac{2\\cdot \\frac{2}{7}\\cdot \\frac{4}{5}}{\\frac{2}{7}+\\frac{4}{5}}.$$\n\n明确地计算分子和分母：\n$$\\text{Numerator}=2\\cdot \\frac{2}{7}\\cdot \\frac{4}{5}=\\frac{16}{35},\\quad \\text{Denominator}=\\frac{2}{7}+\\frac{4}{5}=\\frac{10}{35}+\\frac{28}{35}=\\frac{38}{35}.$$\n\n因此，\n$$F_{1}=\\frac{\\frac{16}{35}}{\\frac{38}{35}}=\\frac{16}{38}=\\frac{8}{19}.$$\n\n作为小数，并四舍五入到三位有效数字，\n$$\\frac{8}{19}\\approx 0.4210526\\ldots \\rightarrow 0.421.$$", "answer": "$$\\boxed{0.421}$$", "id": "2047917"}]}