{"hands_on_practices": [{"introduction": "在我们运用人工智能优化一个生物系统之前，首先必须理解问题的规模。这项练习将引导你计算一个典型的蛋白质工程“设计空间”的大小——即所有可能变体的总数。这个看似简单的计算将直观地展示为什么穷举搜索（exhaustive search）在合成生物学中往往是不可行的，并强调了开发像人工智能这样的智能搜索策略的必要性 [@problem_id:2018103]。", "problem": "一家合成生物学初创公司正在使用一个人工智能（AI）平台来设计一种用于生物成像应用的新型荧光蛋白。起始点是一种由100个氨基酸组成的单链野生型蛋白质。AI模型预测，通过引入恰好两个点突变，可以使该蛋白质的荧光最大化。点突变的定义是，将单个位置的氨基酸变为任何其他一种标准氨基酸。假设有20种标准的蛋白质氨基酸，请计算AI必须探索的总设计空间大小。这对应于与野生型序列相比，恰好有两个氨基酸不同的独特蛋白质变体的总数。", "solution": "我们必须计算所有与野生型在恰好两个位置上不同的蛋白质变体。\n\n- 序列中有 $100$ 个位置。选择恰好两个不同的位置进行突变是一个组合问题，因为这两个位置的顺序无关紧要。根据组合公式，选择这些位置的方法数是\n$$\n\\binom{100}{2}.\n$$\n\n- 对于每个选定的位置，原始氨基酸必须被更改为另一种不同的氨基酸。由于有 $20$ 种标准氨基酸，每个位置有 $20-1=19$ 种可能的替换。这两个位置上的选择是独立的，因此对于一对固定的位置，有\n$$\n19 \\times 19 = 19^{2}\n$$\n种替换选择。\n\n- 根据计数中的乘法原理，具有恰好两个突变的总变体数是\n$$\nN=\\binom{100}{2} \\times 19^{2}.\n$$", "answer": "$$\\boxed{\\binom{100}{2}\\times 19^{2}}$$", "id": "2018103"}, {"introduction": "人工智能本身并不知道何为“好”的生物设计；我们必须为其提供一个精确的数学目标，这便是“目标函数”（objective function）。这项实践将让你体验如何构建并优化这样一个函数，以在期望的产出（例如蛋白质产量）与实际的成本（例如昂贵的诱导剂）之间找到最佳平衡点。掌握这一技能对于在真实的生物铸造厂（bio-foundry）中进行资源有效的设计至关重要 [@problem_id:2018121]。", "problem": "在一个现代化的生物铸造厂中，一个人工智能（AI）代理的任务是优化一种治疗性蛋白质的生产。这种蛋白质在细菌培养物中的合成由一种特定的化学物质诱导，而已知最终的蛋白质产量$Y$作为诱导剂浓度$[I]$的函数，遵循一个饱和模型。该关系由以下方程描述：\n$$Y([I]) = \\frac{Y_{\\text{max}} [I]}{K + [I]}$$\n其中$Y_{\\text{max}}$是可能的最大蛋白质产量，$K$是饱和常数，代表产量达到其最大值一半时的诱导剂浓度。\n\n诱导剂是昂贵的，其成本与所用浓度成正比。为了平衡高产量带来的收益与诱导剂的成本，AI使用一个效用函数$U([I])$，并旨在将其最大化：\n$$U([I]) = Y([I]) - \\lambda [I]$$\n这里，$\\lambda$是一个正常数，代表诱导剂的边际成本，并被归一化为与产量相同的单位。假设系统参数满足$\\frac{Y_{\\text{max}}}{\\lambda} > K$，这确保了使用非零量的诱导剂是有益的。\n\n您的任务是确定AI为最大化该效用函数应选择的最优诱导剂浓度$[I]_{\\text{opt}}$。请用一个包含$Y_{\\text{max}}$、$K$和$\\lambda$的符号表达式给出您的答案。", "solution": "我们要对$[I] \\geq 0$最大化效用函数$U([I]) = Y([I]) - \\lambda [I]$，其中$Y([I]) = \\dfrac{Y_{\\text{max}}[I]}{K + [I]}$且$\\lambda > 0$，$K > 0$，$Y_{\\text{max}} > 0$。由于$U$对于$[I] > -K$是可微的，且可行域为$[I] \\geq 0$，我们使用一阶最优性条件并验证二阶条件。\n\n首先使用商法则计算$Y([I])$的导数。令$g([I]) = Y_{\\text{max}}[I]$和$h([I]) = K + [I]$。那么$g'([I]) = Y_{\\text{max}}$和$h'([I]) = 1$，商法则给出\n$$\n\\frac{dY}{d[I]} = \\frac{g'([I])h([I]) - g([I])h'([I])}{h([I])^{2}} = \\frac{Y_{\\text{max}}(K + [I]) - Y_{\\text{max}}[I]}{(K + [I])^{2}} = \\frac{Y_{\\text{max}}K}{(K + [I])^{2}}.\n$$\n因此，\n$$\n\\frac{dU}{d[I]} = \\frac{dY}{d[I]} - \\lambda = \\frac{Y_{\\text{max}}K}{(K + [I])^{2}} - \\lambda.\n$$\n将导数设为零以获得一阶条件：\n$$\n\\frac{Y_{\\text{max}}K}{(K + [I])^{2}} - \\lambda = 0 \\quad \\Longrightarrow \\quad (K + [I])^{2} = \\frac{Y_{\\text{max}}K}{\\lambda}.\n$$\n取正平方根（因为对于$[I] \\geq 0$有$K + [I] > 0$），\n$$\nK + [I] = \\sqrt{\\frac{Y_{\\text{max}}K}{\\lambda}} \\quad \\Longrightarrow \\quad [I]_{\\text{opt}} = \\sqrt{\\frac{Y_{\\text{max}}K}{\\lambda}} - K.\n$$\n为确认这是一个最大值，计算二阶导数：\n$$\n\\frac{d^{2}U}{d[I]^{2}} = \\frac{d}{d[I]}\\left(\\frac{Y_{\\text{max}}K}{(K + [I])^{2}}\\right) = -\\frac{2Y_{\\text{max}}K}{(K + [I])^{3}} < 0 \\quad \\text{for} \\quad [I] \\geq 0,\n$$\n这确保了$U$在$[I]$上是严格凹的，并且临界点是其定义域上的全局最大值，除非它位于$[I] \\geq 0$之外。假设$\\dfrac{Y_{\\text{max}}}{\\lambda} > K$意味着\n$$\n\\frac{Y_{\\text{max}}K}{\\lambda} > K^{2} \\quad \\Longrightarrow \\quad \\sqrt{\\frac{Y_{\\text{max}}K}{\\lambda}} > K \\quad \\Longrightarrow \\quad [I]_{\\text{opt}} > 0,\n$$\n因此最优解是内部解且是可行的。因此，最优诱导剂浓度为\n$$\n[I]_{\\text{opt}} = \\sqrt{\\frac{Y_{\\text{max}}K}{\\lambda}} - K.\n$$", "answer": "$$\\boxed{\\sqrt{\\frac{Y_{\\text{max}}K}{\\lambda}}-K}$$", "id": "2018121"}, {"introduction": "人工智能驱动实验的最终力量在于它能帮助我们高效地学习和理解复杂的生物系统。这项高级练习将让你扮演一名实验设计者的角色，运用因果推理（causal reasoning）的原则来规划最有效的基因扰动实验。你的目标是设计一个能够明确区分两种相互竞争的生物学假说的最小实验集，从而以最少的实验次数获取最多的信息，完美体现了“设计-构建-测试-学习”循环的精髓 [@problem_id:2018119]。", "problem": "在合成生物学领域，一个研究团队设计了一种细菌菌株来生产一种有价值的治疗性化合物。该生产途径的最终限速步骤由基因A编码的酶$P_A$催化。观察到，当细胞暴露于外部诱导剂分子时，表示为$F$的总途径通量会显著增加。该诱导剂会激活一个主调节蛋白（MR）。然而，MR控制通量$F$的精确机制尚不清楚。现已提出两种相互竞争的假说：\n\n**假说H1（转录级联）：**被激活的MR直接与基因A的启动子结合，增加其转录。由此导致的蛋白质$P_A$浓度的增加是观察到通量$F$增加的唯一原因。\n\n**假说H2（代谢变构）：**基因A以恒定的组成型水平表达，产生基础量的$P_A$。而被激活的MR则直接增加另一个基因——基因B的转录。基因B的蛋白质产物$P_B$是一种酶，可合成一种小分子代谢物M。该代谢物M随后作为$P_A$酶的变构激活剂，增加其催化活性，从而增加通量$F$。在此模型中，$P_A$的浓度在诱导后不发生改变。\n\n您的任务是设计一个实验方案，以确定哪个假说是正确的。您拥有以下实验能力：\n1.  控制诱导剂分子的存在与否。\n2.  通过CRISPR干扰（CRISPRi）创建靶向基因敲低的菌株，这能有效沉默特定基因的转录（例如，“CRISPRi-A”菌株的基因A被沉默）。\n3.  通过一个强效的、不受调控的启动子创建基因的组成型过表达（OE）菌株，从而使其蛋白质产物浓度高且恒定（例如，“OE-A”菌株持续产生高水平的$P_A$）。\n\n要明确区分模型H1和模型H2，所需的**最小实验条件集**是什么？一个“实验条件”被定义为特定菌株和诱导剂状态的独特组合。唯一可用的测量是最终的途径通量$F$。如果两组条件的数量相同，则最小集是需要最少独特基因改造菌株的那一组。\n\nA.  在三种条件下测量通量：1) 有诱导剂的野生型，2) 有诱导剂的CRISPRi-A菌株，3) 有诱导剂的CRISPRi-B菌株。\n\nB.  在两种条件下测量通量：1) 有诱导剂的野生型，2) 有诱导剂的CRISPRi-B菌株。\n\nC.  在三种条件下测量通量：1) 无诱导剂的野生型，2) 有诱导剂的野生型，3) 有诱导剂的CRISPRi-A菌株。\n\nD.  在两种条件下测量通量：1) 无诱导剂的OE-A菌株，2) 无诱导剂的OE-B菌株。\n\nE.  在两种条件下测量通量：1) 无诱导剂的野生型，2) 有诱导剂的OE-A菌株。", "solution": "这个问题的核心是应用因果推理来确定哪组扰动可以揭示真实的底层网络结构。如果一个扰动对两种假说能导出不同的预测结果，那么它就是有信息量的。目标是找到包含这类有信息量实验的最小集合。\n\n首先，让我们为每个假说形式化其因果路径。设`Inducer`为输入，$F$为输出。`txn(X)`表示基因X的转录，$[P_X]$是蛋白质X的浓度，`act(P_A)`是蛋白质$P_A$的活性。\n\n**假说H1（转录级联）：**\n因果链是：\n`Inducer` → `MR` → `txn(A)` → $[P_A]$ → $F$\n在此模型中，基因B是无关的。\n\n**假说H2（代谢变构）：**\n存在两个并行过程。基因A是组成型表达的，而基因B是被诱导的。\n`Constitutive Promoter` → `txn(A)` → $[P_A]$\n`Inducer` → `MR` → `txn(B)` → $[P_B]$ → [Metabolite $M$] $\\rightsquigarrow$ `act(P_A)`\n通量是$P_A$浓度和活性的函数：$F = f([P_A], \\text{act}(P_A))$。箭头$\\rightsquigarrow$代表变构激活。\n\n题目陈述已确认了基线行为，即向野生型（WT）菌株中添加诱导剂会增加通量。\n*   (WT, 无诱导剂) → 低通量\n*   (WT, 有诱导剂) → 高通量\n\n现在，我们评估选项中提出的扰动，看它们是否能区分H1和H2。如果一个实验对一个假说预测的通量是“高”，而对另一个假说是“低”，那么这个实验就是有区分度的。\n\n**关键扰动分析：**\n\n1.  **CRISPRi-A（基因A敲低）：**这会沉默`txn(A)`。\n    *   在H1中，`txn(A)`位于主因果路径上。沉默它会打破这个链条，导致低$[P_A]$，因此即使有诱导剂，通量也是**低通量**。\n    *   在H2中，`txn(A)`是产生任何$P_A$蛋白所必需的。沉默它将导致没有$P_A$，因此无论诱导剂或激活剂$M$是否存在，通量都是**低通量**。\n    *   **结论：** CRISPRi-A**没有信息量**来区分H1和H2，因为它在两种情况下都会导致低通量。\n\n2.  **CRISPRi-B（基因B敲低）：**这会沉默`txn(B)`。\n    *   在H1中，基因B不属于该途径。此扰动没有效果。在有诱导剂的情况下，通量将是**高通量**。\n    *   在H2中，`txn(B)`对于产生激活剂$M$至关重要。沉默它会打破诱导途径。$P_A$的活性将保持在其基础的低水平。通量将是**低通量**。\n    *   **结论：** CRISPRi-B（有诱导剂）是**有信息量的**。\n\n3.  **OE-A（A的过表达）：**这将$[P_A]$设定在一个高的恒定水平，绕过了其天然启动子。考虑在没有诱导剂的情况下进行此实验。\n    *   在H1中，高$[P_A]$直接导致**高通量**。这绕过了对诱导剂和MR的需求。\n    *   在H2中，这会产生高浓度的$P_A$，但由于没有诱导剂，变构激活剂$M$不会产生。$P_A$酶保持在其低活性状态。通量将是**低通量**。\n    *   **结论：** OE-A（无诱导剂）是**有信息量的**。\n\n4.  **OE-B（B的过表达）：**这将$[P_B]$设定在一个高的恒定水平。考虑在没有诱导剂的情况下进行此实验。\n    *   在H1中，这对`MR` → 基因A途径没有影响。没有诱导剂，基因A不转录，所以通量保持**低通量**。\n    *   在H2中，过表达$P_B$会导致高水平的激活剂$M$。这个$M$会激活组成型表达的$P_A$，导致**高通量**。这绕过了对诱导剂的需求。\n    *   **结论：** OE-B（无诱导剂）是**有信息量的**。\n\n现在我们根据充分性和最小性来评估给定的选项。\n\n*   **A. {(WT, 诱导剂), (CRISPRi-A, 诱导剂), (CRISPRi-B, 诱导剂)}:** 这个集合有3个条件。它包含了无信息量的CRISPRi-A实验。虽然与(WT, 诱导剂)对照组相比，CRISPRi-B实验是有信息量的，但该集合不是最小的，因为它包含了一个不必要的实验。\n\n*   **B. {(WT, 诱导剂), (CRISPRi-B, 诱导剂)}:** 这个集合有2个条件。\n    *   H1预测：(高通量, 高通量)\n    *   H2预测：(高通量, 低通量)\n    *   结果是可区分的。这个集合是充分的。它需要2个条件和1个改造菌株（CRISPRi-B）。\n\n*   **C. {(WT, 无诱导剂), (WT, 诱导剂), (CRISPRi-A, 诱导剂)}:** 这个集合有3个条件。它包含了基线实验和无信息量的CRISPRi-A实验。它不能区分H1和H2。\n\n*   **D. {(OE-A, 无诱导剂), (OE-B, 无诱导剂)}:** 这个集合有2个条件。\n    *   H1预测：(高通量, 低通量)\n    *   H2预测：(低通量, 高通量)\n    *   结果是可区分的。这个集合是充分的。它需要2个条件和2个改造菌株（OE-A和OE-B）。\n\n*   **E. {(WT, 无诱导剂), (OE-A, 诱导剂)}:** 这个集合有2个条件。让我们分析(OE-A, 诱导剂)这个实验。\n    *   在H1中，诱导剂引起`txn(A)`，同时OE-A也制造$P_A$。结果是**高通量**。\n    *   在H2中，诱导剂制造激活剂$M$，而OE-A提供高水平的$P_A$。$M$激活$P_A$。结果是**高通量**。\n    *   这个实验没有信息量。该集合无法区分。\n\n**最终比较与选择：**\n我们剩下选项B和D。两者都充分，并且都需要2个实验条件。\n*   集合B需要2个条件和1个改造菌株。\n*   集合D需要2个条件和2个改造菌株。\n\n问题陈述了一个平局决胜规则：“如果两组条件的数量相同，则最小集是需要最少独特基因改造菌株的那一组。”\n\n根据这条规则，集合B优于集合D，因为它除了野生型之外只需要创建一个新菌株（CRISPRi-B），而集合D需要两个新菌株（OE-A和OE-B）。\n\n因此，最小的实验条件集由选项B给出。", "answer": "$$\\boxed{B}$$", "id": "2018119"}]}