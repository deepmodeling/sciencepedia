{"hands_on_practices": [{"introduction": "要掌握DNA数据存储，第一步是理解数字信息如何转化为物理上的DNA分子。本练习将引导你完成一项核心计算，即将一个给定大小的数字文件，根据特定的编码效率，转换为所需的DNA碱基总数，并估算用现代测序技术读取这些信息所需的时间。通过这个实践，你将掌握评估DNA数据存储系统性能的基本参数，例如信息密度和读取速度。[@problem_id:2031335]", "problem": "在一个开发下一代数据存储解决方案的合成生物学实验室中，研究人员正在将数字信息编码到脱氧核糖核酸 (DNA) 链中。一个大小为 100 千字节 (kB) 的数字文件使用一种新颖的压缩算法进行编码，该算法实现了 1.5 比特每核苷酸碱基的信息密度（或编码效率）。编码后的 DNA 随后使用高通量测序仪进行读取。该测序仪的处理速率为每分钟 $1.00 \\times 10^6$ 个碱基。\n\n为便于本题计算，假设 1 千字节 (kB) 等于 1024 字节，且 1 字节等于 8 比特。\n\n计算测序仪对包含在 100 kB 文件中的信息进行一次完整读取所需的最短时间（以秒为单位）。将最终答案四舍五入到三位有效数字。", "solution": "我们首先使用给定的定义将文件大小转换为比特。设 $B$ 为总比特数：\n$$\nB = 100 \\times 1024 \\times 8 = 819200 \\text{ bits}.\n$$\n在编码效率为 $1.5$ 比特每碱基的情况下，所需的核苷酸碱基数量为\n$$\nN = \\frac{B}{1.5} = \\frac{819200}{1.5} = 546133.\\overline{3} \\text{ bases}.\n$$\n由于碱基是离散的，能够编码该文件的最小整数碱基数量为\n$$\nN_{\\text{min}} = \\lceil N \\rceil = 546134 \\text{ bases}.\n$$\n测序仪的处理速率为 $r = 1.00 \\times 10^{6}$ 碱基/分钟，因此所需时间（以分钟为单位）为\n$$\nt_{\\text{min}} = \\frac{N_{\\text{min}}}{r} = \\frac{546134}{1.00 \\times 10^{6}} \\text{ min}.\n$$\n转换为秒，\n$$\nt = 60 \\times t_{\\text{min}} = 60 \\times \\frac{546134}{1.00 \\times 10^{6}} = 32.76804 \\text{ s}.\n$$\n四舍五入到三位有效数字，得到 $32.8$。", "answer": "$$\\boxed{32.8}$$", "id": "2031335"}, {"introduction": "DNA的合成与测序过程并非完美无瑕，会引入各种错误，这对于数据存储的可靠性是致命的。为了解决这一问题，我们必须引入纠错码，其中最直观的方法之一就是冗余。本练习模拟了一个真实情景：你将利用三重冗余和“少数服从多数”的原则，从几条含有错误的DNA测序读段中，重建出最有可能的原始数据序列，并识别出发生的错误类型。[@problem_id:2031328]", "problem": "在合成生物学领域，脱氧核糖核酸 (DNA) 正在被探索作为一种高密度、长期的信息存储介质。一种确保数据在DNA合成或测序过程中免受错误影响、保持完整性的常见策略是使用冗余。\n\n考虑一个简单的纠错方案，其中一小段数据被编码为一段4个碱基的DNA序列，并以一式三份的方式进行合成。在数据读取期间，所有三个物理副本都会被测序。然后通过多数投票共识来重建原始序列：对于序列中的每个位置，在三个副本中至少出现两次的碱基被假定为原始的、正确的碱基。\n\n一位工程师正在尝试读取一段长度为4个碱基的数据片段。获得的三个测序读数如下：\n- 读数1：`GATC`\n- 读数2：`GTTC`\n- 读数3：`GTTC`\n\nDNA合成或测序中的单碱基错误通常分为以下几类：\n- **替换**：一个碱基被替换为另一个不同的碱基（例如，`A` 变为 `G`）。\n- **插入**：在序列中加入一个额外的碱基（例如，`GTC` 变为 `GTAC`）。\n- **缺失**：从序列中移除一个碱基（例如，`GTC` 变为 `GC`）。\n\n根据提供的读数和多数投票共识方法，确定最可能的原始序列，并指出那个不一致的读数中发生了哪种类型的错误。\n\nA) 原始序列：`GTTC`；错误类型：替换\n\nB) 原始序列：`GATC`；错误类型：替换\n\nC) 原始序列：`GATC`；错误类型：缺失\n\nD) 原始序列：`GTTC`；错误类型：插入\n\nE) 原始序列：`GTAC`；错误类型：替换", "solution": "我们将三个读数记作长度为$4$的序列：\n- $R_{1}=\\text{GATC}$\n- $R_{2}=\\text{GTTC}$\n- $R_{3}=\\text{GTTC}$\n\n使用多数投票共识，对于每个位置$i\\in\\{1,2,3,4\\}$，共识碱基$C_{i}$被定义为$\\{R_{1,i},R_{2,i},R_{3,i}\\}$的众数。\n\n计算每个位置的多数碱基：\n- 位置 $i=1$: $\\{G,G,G\\}\\Rightarrow C_{1}=G$。\n- 位置 $i=2$: $\\{A,T,T\\}\\Rightarrow C_{2}=T$。\n- 位置 $i=3$: $\\{T,T,T\\}\\Rightarrow C_{3}=T$。\n- 位置 $i=4$: $\\{C,C,C\\}\\Rightarrow C_{4}=C$。\n\n因此，共识（最可能的原始）序列是$\\text{GTTC}$。\n\n接下来，识别不一致读数中的错误类型。将每个读数与共识序列进行比较：\n- $R_{2}=\\text{GTTC}$ 完全匹配。\n- $R_{3}=\\text{GTTC}$ 完全匹配。\n- $R_{1}=\\text{GATC}$ 仅在位置$2$上与共识序列不同（共识序列为$T$，而$R_{1}$中为$A$），且长度没有变化。\n\n在固定位置上单个碱基的差异且长度不变，这对应于一次替换。插入或缺失会改变比对并通常会改变长度，而在此处并未观察到这种情况。\n\n因此，正确的选项是：原始序列 $\\text{GTTC}$；错误类型：替换，即选项A。", "answer": "$$\\boxed{A}$$", "id": "2031328"}, {"introduction": "在实际的DNA数据存储系统中，数据被分割成数百万条短DNA链，测序后得到的是一堆杂乱无章的读段。如何将这些碎片“拼”回原始文件，是数据恢复过程中的一个核心计算挑战。本练习向你介绍一种强大的生物信息学技术——k-mer频率分析，其中k-mer是指长度为$k$的DNA子序列。你将通过计算k-mer谱之间的距离，来判断一个测序读段最可能来源于哪个原始数据文件，从而完成数据分类的第一步。[@problem_id:2031320]", "problem": "在合成生物学领域，DNA 正被探索作为一种高密度、长期的信息存储介质。信息被编码到合成DNA寡核苷酸（oligos）的序列中。为了检索数据，需要对这些寡核苷酸进行测序，但这个过程会产生数百万个称为读段（reads）的简短、无序且易出错的片段。一个根本性的挑战是将这些读段聚类回它们原始来源的寡核苷酸。\n\n考虑一个简化情景，其中两个数据文件被编码成两个不同的长源序列 `S1` 和 `S2`。对一个给定的读段 `R` 进行聚类的一种常用技术是，将其 k-mer 频率谱与源序列的频率谱进行比较。k-mer 是一个长度为 `k` 的子串。一个序列的 k-mer 频率谱是一个映射，它统计了该序列中每个可能的 k-mer 的出现次数。\n\n两个源序列如下所示：\n- `S1 = ATGCGATACG`\n- `S2 = TACTGCTAGC`\n\n在测序过程中，获得了一个读段 `R`：\n- `R = TGCAATAC`\n\n你的任务是确定读段 `R` 最有可能源自于哪个源序列。为此，你将使用 `k=3` 的 k-mer 长度。两个 k-mer 频率谱 `P_A` 和 `P_B` 之间的距离定义为曼哈顿距离：\n$$D(P_A, P_B) = \\sum_{i} |P_A(k_i) - P_B(k_i)|$$\n其中，求和遍及所有在序列 A 或 B 中至少出现一次的唯一 k-mer `k_i`。`P_A(k_i)` 是 k-mer `k_i` 在序列 A 中的计数（如果 `k_i` 未在 A 中出现，则为零）。\n\n设 `P_1`、`P_2` 和 `P_R` 分别为 `S1`、`S2` 和 `R` 的 3-mer 频率谱。计算距离 `D_1 = D(P_R, P_1)` 和 `D_2 = D(P_R, P_2)`。\n\n计算比率 `D_2 / D_1`。将最终答案四舍五入到三位有效数字。", "solution": "我们使用 k-mer 长度 $k=3$。对于一个长度为 $L$ 的序列，有 $L-k+1$ 个重叠的 3-mer。\n\n计算 3-mer 及其计数：\n\n对于 $S1=\\text{ATGCGATACG}$ ($L=10$)：\n3-mer：ATG, TGC, GCG, CGA, GAT, ATA, TAC, ACG。每个出现一次。\n因此，对于这八个 3-mer，$P_{1}(\\text{ATG})=\\cdots=P_{1}(\\text{ACG})=1$，对于其他 3-mer 则为零。\n\n对于 $S2=\\text{TACTGCTAGC}$ ($L=10$)：\n3-mer：TAC, ACT, CTG, TGC, GCT, CTA, TAG, AGC。每个出现一次。\n因此，对于这八个 3-mer，$P_{2}(\\text{TAC})=\\cdots=P_{2}(\\text{AGC})=1$，对于其他 3-mer 则为零。\n\n对于 $R=\\text{TGCAATAC}$ ($L=8$)：\n3-mer：TGC, GCA, CAA, AAT, ATA, TAC。每个出现一次。\n因此，对于这六个 3-mer，$P_{R}(\\text{TGC})=\\cdots=P_{R}(\\text{TAC})=1$，对于其他 3-mer 则为零。\n\n谱 $P_{A}$ 和 $P_{B}$ 之间的曼哈顿距离是\n$$\nD(P_{A},P_{B})=\\sum_{k\\in U}|P_{A}(k)-P_{B}(k)|,\n$$\n其中 $U$ 是在 $A$ 或 $B$ 中至少出现一次的 3-mer 的集合。\n\n与 $S1$ 的距离：\n设 $U_{1}$ 为 $R$ 和 $S1$ 中 3-mer 的并集：\n$U_{1}=\\{\\text{TGC},\\text{GCA},\\text{CAA},\\text{AAT},\\text{ATA},\\text{TAC},\\text{ATG},\\text{GCG},\\text{CGA},\\text{GAT},\\text{ACG}\\}$。\n逐项绝对差：对于 TGC、ATA、TAC，$|\\!P_{R}-P_{1}\\!|$ 为 $0$，对于列出的其他八个为 $1$。\n因此\n$$\nD_{1}=D(P_{R},P_{1})=8.\n$$\n\n与 $S2$ 的距离：\n设 $U_{2}$ 为 $R$ 和 $S2$ 中 3-mer 的并集：\n$U_{2}=\\{\\text{TGC},\\text{GCA},\\text{CAA},\\text{AAT},\\text{ATA},\\text{TAC},\\text{ACT},\\text{CTG},\\text{GCT},\\text{CTA},\\text{TAG},\\text{AGC}\\}$。\n逐项绝对差：对于 TGC 和 TAC，$|\\!P_{R}-P_{2}\\!|$ 为 $0$，对于列出的其余十个为 $1$。\n因此\n$$\nD_{2}=D(P_{R},P_{2})=10.\n$$\n\n因此，所求的比率为\n$$\n\\frac{D_{2}}{D_{1}}=\\frac{10}{8}=1.25,\n$$\n保留三位有效数字为 $1.25$。", "answer": "$$\\boxed{1.25}$$", "id": "2031320"}]}