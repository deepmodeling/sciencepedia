{"hands_on_practices": [{"introduction": "生物计数器最基本的操作是状态转换，例如将一个比特从 $0$ 翻转到 $1$。本练习模拟了驱动这种转换的底层基因表达动力学。通过求解报告蛋白达到阈值浓度所需的时间，我们可以定量地了解这些基因开关的速度和行为，这对于理解任何合成电路的时间性能至关重要。[@problem_id:2022490]", "problem": "一位合成生物学家正在构建一个基因开关，这是在细胞内创建生物计数器的一个基本组成部分。该计数器中一个比特位的状态由报告蛋白的浓度表示。当比特位为“0”时，该蛋白质的基因被完全抑制。当比特位翻转为“1”时，抑制被解除，基因开始表达。\n\n考虑该“翻转”过程的一个简化模型。在时间 $t < 0$ 时，系统处于“0”状态，因此报告蛋白的信使RNA (mRNA) 和报告蛋白本身的浓度均为零。在 $t = 0$ 时，引入一个诱导分子，该分子瞬间完全解除了抑制。基因开始被转录，然后被翻译。\n\n对于 $t \\ge 0$，该系统的动力学可以通过以下过程建模：\n1.  mRNA的浓度 $M(t)$ 以恒定速率 $\\alpha_M$ 产生，并以一级速率常数 $\\delta_M$ 降解。\n2.  报告蛋白的浓度 $P(t)$ 从mRNA翻译而来，其速率与 $M(t)$ 成正比，速率常数为 $\\alpha_P$，并以一级速率常数 $\\delta_P$ 降解。\n\n为了简化分析，假设mRNA和蛋白质的降解速率常数相等：$\\delta_M = \\delta_P = \\delta$。\n\n当蛋白质浓度 $P(t)$ 达到其最终、长期稳态值的一半时，认为该比特位成功地从“0”翻转到了“1”。确定该翻转发生所需时间 $T$ 的解析表达式，用给定的参数表示。", "solution": "该问题要求解当蛋白质浓度 $P(t)$ 达到其稳态值一半时的时间 $T$。我们首先需要通过求解描述该模型的微分方程组来找到 $P(t)$ 的表达式。\n\n微分方程组由下式给出：\n1.  mRNA动力学：$\\frac{dM}{dt} = \\alpha_M - \\delta M$\n2.  蛋白质动力学：$\\frac{dP}{dt} = \\alpha_P M - \\delta P$\n\n初始条件为 $M(0) = 0$ 和 $P(0) = 0$。\n\n首先，我们求解mRNA浓度 $M(t)$ 的微分方程。这是一个一阶线性常微分方程。\n$$ \\frac{dM}{dt} + \\delta M = \\alpha_M $$\n可以使用积分因子 $e^{\\int \\delta dt} = e^{\\delta t}$ 来找到解。\n$$ \\frac{d}{dt}(M e^{\\delta t}) = \\alpha_M e^{\\delta t} $$\n对 $t$ 积分：\n$$ M(t) e^{\\delta t} = \\int \\alpha_M e^{\\delta t} dt = \\frac{\\alpha_M}{\\delta} e^{\\delta t} + C_1 $$\n其中 $C_1$ 是积分常数。\n解出 $M(t)$：\n$$ M(t) = \\frac{\\alpha_M}{\\delta} + C_1 e^{-\\delta t} $$\n使用初始条件 $M(0) = 0$：\n$$ 0 = \\frac{\\alpha_M}{\\delta} + C_1 e^0 \\implies C_1 = -\\frac{\\alpha_M}{\\delta} $$\n因此，mRNA浓度随时间变化的函数是：\n$$ M(t) = \\frac{\\alpha_M}{\\delta} (1 - e^{-\\delta t}) $$\n\n接下来，我们通过代入 $M(t)$ 的表达式来求解蛋白质浓度 $P(t)$ 的微分方程：\n$$ \\frac{dP}{dt} + \\delta P = \\alpha_P M(t) = \\alpha_P \\frac{\\alpha_M}{\\delta} (1 - e^{-\\delta t}) $$\n这又是另一个一阶线性常微分方程。积分因子同样是 $e^{\\delta t}$。\n$$ \\frac{d}{dt}(P e^{\\delta t}) = \\alpha_P \\frac{\\alpha_M}{\\delta} (1 - e^{-\\delta t}) e^{\\delta t} = \\frac{\\alpha_P \\alpha_M}{\\delta} (e^{\\delta t} - 1) $$\n对 $t$ 积分：\n$$ P(t) e^{\\delta t} = \\int \\frac{\\alpha_P \\alpha_M}{\\delta} (e^{\\delta t} - 1) dt = \\frac{\\alpha_P \\alpha_M}{\\delta} \\left(\\frac{1}{\\delta}e^{\\delta t} - t\\right) + C_2 $$\n其中 $C_2$ 是积分常数。\n解出 $P(t)$：\n$$ P(t) = \\frac{\\alpha_P \\alpha_M}{\\delta^2} - \\frac{\\alpha_P \\alpha_M}{\\delta} t e^{-\\delta t} + C_2 e^{-\\delta t} $$\n使用初始条件 $P(0)=0$：\n$$ 0 = \\frac{\\alpha_P \\alpha_M}{\\delta^2} - 0 + C_2 e^0 \\implies C_2 = -\\frac{\\alpha_P \\alpha_M}{\\delta^2} $$\n将 $C_2$ 代回 $P(t)$ 的表达式中：\n$$ P(t) = \\frac{\\alpha_P \\alpha_M}{\\delta^2} - \\frac{\\alpha_P \\alpha_M}{\\delta} t e^{-\\delta t} - \\frac{\\alpha_P \\alpha_M}{\\delta^2} e^{-\\delta t} $$\n提取公因式，得到 $P(t)$ 的最终表达式：\n$$ P(t) = \\frac{\\alpha_P \\alpha_M}{\\delta^2} \\left( 1 - e^{-\\delta t} - \\delta t e^{-\\delta t} \\right) $$\n\n现在，我们必须求出稳态蛋白质浓度 $P_{ss}$。这是 $P(t)$ 在 $t \\to \\infty$ 时的极限。\n$$ P_{ss} = \\lim_{t \\to \\infty} P(t) = \\lim_{t \\to \\infty} \\frac{\\alpha_P \\alpha_M}{\\delta^2} \\left( 1 - e^{-\\delta t} - \\delta t e^{-\\delta t} \\right) $$\n由于 $\\delta > 0$，当 $t \\to \\infty$ 时，$e^{-\\delta t}$ 和 $t e^{-\\delta t}$ 都趋近于0。\n$$ P_{ss} = \\frac{\\alpha_P \\alpha_M}{\\delta^2} $$\n\n题目将翻转时间 $T$ 定义为满足 $P(T) = \\frac{1}{2} P_{ss}$ 的时间。\n$$ \\frac{\\alpha_P \\alpha_M}{\\delta^2} \\left( 1 - e^{-\\delta T} - \\delta T e^{-\\delta T} \\right) = \\frac{1}{2} \\frac{\\alpha_P \\alpha_M}{\\delta^2} $$\n两边消去项 $\\frac{\\alpha_P \\alpha_M}{\\delta^2}$：\n$$ 1 - e^{-\\delta T} - \\delta T e^{-\\delta T} = \\frac{1}{2} $$\n$$ \\frac{1}{2} = e^{-\\delta T} (1 + \\delta T) $$\n这是一个关于 $T$ 的超越方程。令 $x = \\delta T$。方程变为：\n$$ (1+x)e^{-x} = \\frac{1}{2} \\implies 1+x = \\frac{1}{2} e^x $$\n为了求解 $x$，我们使用兰伯特W函数，其定义为方程 $W(z)e^{W(z)} = z$ 的解。我们需要将我们的方程变换成这种形式。\n$$ -(1+x) = -\\frac{1}{2}e^x $$\n乘以 $e^{-1}$：\n$$ -(1+x)e^{-1} = -\\frac{1}{2}e^{x-1} $$\n令 $y = -(1+x)$。则 $x = -1-y$。代入得：\n$$ y e^{-1} = -\\frac{1}{2}e^{(-1-y)-1} = -\\frac{1}{2}e^{-y-2} $$\n$$ y e^{y} = -\\frac{1}{2}e^{-2}e^{-1} = -\\frac{e^{-1}}{2} $$\n所以我们有 $y e^y = z$，其中 $z = -\\frac{1}{2e}$。\n这意味着 $y = W(-\\frac{1}{2e})$，其中 $W$ 是兰伯特W函数。\n对于自变量 $z \\in [-1/e, 0)$，兰伯特W函数有两个实数分支：主分支 $W_0(z)$（值域为 $[-1, \\infty)$）和下分支 $W_{-1}(z)$（值域为 $(-\\infty, -1]$）。\n我们的自变量是 $z = -1/(2e) \\approx -0.184$，它位于这个区间内。\n由于 $x = \\delta T > 0$，我们有 $y = -(1+x) < -1$。\n因此，我们必须选择 $W_{-1}$ 分支，因为它的值域是 $(-\\infty, -1]$。\n所以，$y = W_{-1}(-\\frac{1}{2e})$。\n现在我们求解 $T$：\n$$ x = -1-y = -1 - W_{-1}\\left(-\\frac{1}{2e}\\right) $$\n$$ \\delta T = -1 - W_{-1}\\left(-\\frac{1}{2e}\\right) $$\n$$ T = \\frac{1}{\\delta} \\left[ -1 - W_{-1}\\left(-\\frac{1}{2e}\\right) \\right] $$\n这就是翻转时间 $T$ 的最终解析表达式。", "answer": "$$\\boxed{\\frac{1}{\\delta}\\left(-1 - W_{-1}\\left(-\\frac{1}{2e}\\right)\\right)}$$", "id": "2022490"}, {"introduction": "除了简单的瞬时转换，许多生物计数器还需要永久记录过去发生的事件。这个问题探讨了一个“故障安全”基因电路，该电路在检测到特定信号后，利用位点特异性重组酶来不可逆地关闭一个过程。这个练习展示了DNA修饰如何作为一种强大的记忆机制，这是设计用于记录细胞历史的计数器的核心原则。[@problem_id:2022438]", "problem": "一个合成生物学研究团队正在*大肠杆菌*（*E. coli*）中设计一个细菌“故障安全”系统。该系统旨在响应一种特定的化学诱导剂 `Y`，从而产生一种有价值的酶，此处以绿色荧光蛋白（GFP）为模型。然而，为了防止在由另一种化学物质 `X` 标记的污染事件中发生意外生产，该系统一旦暴露于 `X`，就必须被永久关闭。\n\n实现这一逻辑的基因回路构建如下：\n\n1.  **污染传感器模块**：化学物质 `X` 的存在会诱导启动子 `P_X`，从而产生位点特异性重组酶蛋白 `Rec`。\n2.  **生产诱导模块**：化学物质 `Y` 的存在会诱导启动子 `P_Y`，从而产生激活蛋白 `Act_Y`。\n3.  **记忆与抑制模块**：一个强组成型启动子 `P_const` 位于一个编码抑制蛋白 `Inh` 的DNA序列的上游。在 `P_const` 和 `Inh` 基因之间，有一个强的转录终止子序列 `Term`，其两侧是 `Rec` 识别位点。重组酶 `Rec` 可以识别这些位点并从DNA中不可逆地切除 `Term` 序列。抑制蛋白 `Inh` 通过与输出启动子 `P_out` 结合并阻止其激活来发挥作用。\n4.  **输出模块**：GFP的基因被置于输出启动子 `P_out` 的控制之下。该启动子仅在激活蛋白 `Act_Y` 与之结合时才被激活。如果抑制蛋白 `Inh` 同时也结合到 `P_out` 上，则这种激活将被完全阻断。\n\n在您的分析中，请作如下假设：\n- 所有启动子都是“严谨的”，意味着在它们的非激活状态下没有表达（无泄露表达）。\n- `P_const` 始终处于激活状态，但只要 `Term` 序列存在，转录就会被完全阻断。\n- `Rec` 重组酶的作用在其产生时是瞬时且不可逆的。为了关闭 `P_out`，`Inh` 的后续产生及其与 `P_out` 的结合也被认为是瞬时的。\n- 从一个完全激活且未受抑制的 `P_out` 启动子产生GFP的速率是一个常数 `\\alpha`。\n- GFP的降解和稀释速率与其当前浓度 `[GFP]` 成正比，速率常数为 `\\gamma`。因此，当启动子开启时，GFP的浓度根据 `d[GFP]/dt = \\alpha - \\gamma[GFP]` 演变；当启动子关闭时，根据 `d[GFP]/dt = - \\gamma[GFP]` 演变。\n\n实验在 `t=0` 时开始，此时细菌培养物中不含GFP，因此 `[GFP](0) = 0`。应用以下实验方案：\n- 从 `t=0` 到 `t=T`，培养物仅暴露于化学物质 `Y`。\n- 从 `t=T` 到 `t=2T`，将化学物质 `X` 添加到培养物中，因此 `X` 和 `Y` 同时存在。\n- 在 `t=2T` 时，两种化学物质都被完全洗掉。\n\n确定在时间 `t = 3T` 时的GFP浓度 `[GFP]`。您的答案应为一个以 `\\alpha`、`\\gamma` 和 `T` 表示的闭式表达式。", "solution": "解释回路逻辑和时序：\n- 对于 $0 \\leq t < T$，只有 $Y$ 存在，因此 $P_{Y}$ 产生 $Act\\_Y$，$P\\_{out}$ 被激活（由于 $Term$ 存在并阻断了 $Inh$ 的表达，所以未受抑制），GFP被产生。控制常微分方程为 $d[GFP]/dt=\\alpha-\\gamma[GFP]$，初始条件为 $[GFP](0)=0$。\n- 在 $t=T$ 时，加入 $X$。$P_{X}$ 驱动 $Rec$ 的产生，后者瞬间切除 $Term$。这解除了对 `P_const` 的阻断，`Inh` 得以产生并与 `P_out` 结合，立即且不可逆地将其关闭。因此，对于 $t \\geq T$，$P\\_{out}$ 保持关闭状态，即使在 $t=2T$ 时洗涤后也是如此，因为 `Inh` 是组成型产生的。对于 $t \\geq T$，控制常微分方程为 $d[GFP]/dt=-\\gamma[GFP]$，并满足连续性条件 $[GFP](T^{-})=[GFP](T^{+})$。\n\n在 $[0,T)$ 上求解：\n满足 $G(0)=0$ 的线性常微分方程 $dG/dt=\\alpha-\\gamma G$ 的解为\n$$\nG(t)=\\frac{\\alpha}{\\gamma}\\left(1-\\exp(-\\gamma t)\\right).\n$$\n因此，\n$$\nG(T)=\\frac{\\alpha}{\\gamma}\\left(1-\\exp(-\\gamma T)\\right).\n$$\n\n在 $[T,3T]$ 上求解：\n在启动子关闭的情况下，方程 $dG/dt=-\\gamma G$ 和上述初始条件 $G(T)$ 给出\n$$\nG(t)=G(T)\\exp\\!\\left(-\\gamma(t-T)\\right).\n$$\n在 $t=3T$ 处求值，\n$$\nG(3T)=\\frac{\\alpha}{\\gamma}\\left(1-\\exp(-\\gamma T)\\right)\\exp(-2\\gamma T)\n=\\frac{\\alpha}{\\gamma}\\left(\\exp(-2\\gamma T)-\\exp(-3\\gamma T)\\right).\n$$\n这里用到了 $\\left(1-\\exp(-\\gamma T)\\right)\\exp(-2\\gamma T)=\\exp(-2\\gamma T)-\\exp(-3\\gamma T)$。\n\n因此，在时间 $t=3T$ 时的GFP浓度即为所述的以 $\\alpha$、$\\gamma$ 和 $T$ 表示的表达式。", "answer": "$$\\boxed{\\frac{\\alpha}{\\gamma}\\left(\\exp(-2\\gamma T)-\\exp(-3\\gamma T)\\right)}$$", "id": "2022438"}, {"introduction": "为了计算超过一个事件，我们需要构建具有多个不同状态的系统。这个高级问题挑战你分析一个由嵌套的可翻转DNA片段构成的复杂计数器——一种“俄罗斯套娃”结构。通过确定由两种不同重组酶驱动的独特状态转换，你将探索DNA作为记录事件序列的可写媒介所具有的惊人能力，从而拓展细胞计算的边界。[@problem_id:2022417]", "problem": "一位合成生物学家正在设计一个生物事件计数器，该计数器使用DNA作为存储介质。该系统由四个不同的、可翻转的DNA片段组成，从最内层到最外层依次标记为1到4。每个片段的方向可以被一种特定的重组酶翻转。现有两种类型的重组酶：Cre，它专一作用于`loxP`位点；Flp，它作用于`FRT`位点。两侧为`loxP`位点的片段被称为“Cre单元”，而两侧为`FRT`位点的片段被称为“Flp单元”。\n\n这些片段以嵌套的“俄罗斯套娃”结构排列：片段2包含片段1，片段3包含片段2，片段4包含片段3。计数器的状态由这四个片段相对于主染色体（外部参考系）的方向向量定义。例如，一个状态可能是（正向，反向，正向，正向）。已经确定，当一个片段被其对应的重组酶翻转时，其内部嵌套的所有片段也会相对于外部参考系发生翻转。一次给定重组酶（例如Cre）的脉冲将同时翻转作为该重组酶靶标的每一个片段（例如所有Cre单元）。\n\n在这个特定设计中，最内层的片段（1）和最外层的片段（4）被指定为Cre单元。两个中间的片段（2和3）被指定为Flp单元。计数器从一个初始状态开始，此时所有四个片段都处于正向。一个“事件”包括施加一次Cre或Flp重组酶的脉冲。\n\n在任何状态（包括初始状态）重复之前，此计数器可以记录的唯一连续事件的最大数量 $N$ 是多少？", "solution": "令每个片段的方向由 $x_{i} \\in \\{0,1\\}$ 编码，其中 $i \\in \\{1,2,3,4\\}$，$x_{i}=0$ 表示相对于外部参考系为正向，$x_{i}=1$ 表示反向。初始状态为 $x^{(0)}=(0,0,0,0)$。\n\n一次给定重组酶的脉冲会翻转其靶向片段，并且根据嵌套结构，也会翻转任何靶向片段内包含的所有片段。因此，对于一次靶向集合 $T \\subset \\{1,2,3,4\\}$ 的脉冲，其对 $x_{i}$ 的净效应是加上（模2）片段 $i$ 的被靶向祖先片段数量的奇偶性，即：\n$$\nx_{i} \\mapsto x_{i} + m_{i}(T) \\quad \\text{with} \\quad m_{i}(T) = \\left(\\sum_{j \\in T,\\, j \\ge i} 1\\right) \\bmod 2.\n$$\n因此，一次脉冲是在 $\\mathbb{Z}_{2}^{4}$ 中的一次平移 $x \\mapsto x + m(T)$，其中 $m(T)=(m_{1}(T),m_{2}(T),m_{3}(T),m_{4}(T))$。\n\n在此设计中，Cre 靶向 $T_{C}=\\{1,4\\}$，Flp 靶向 $T_{F}=\\{2,3\\}$。计算掩码：\n\n- 对于 Cre，$T_{C}=\\{1,4\\}$:\n  - $m_{1}(T_{C}) = (1+1) \\bmod 2 = 0$，\n  - $m_{2}(T_{C}) = 1 \\bmod 2 = 1$ (只有片段4被计入)，\n  - $m_{3}(T_{C}) = 1 \\bmod 2 = 1$，\n  - $m_{4}(T_{C}) = 1 \\bmod 2 = 1$。\n  因此，\n  $$\n  m^{C}=(0,1,1,1),\n  $$\n  即，一次Cre脉冲将 $(s_{1},s_{2},s_{3},s_{4})$ 映射为 $(s_{1},-s_{2},-s_{3},-s_{4})$。\n\n- 对于 Flp，$T_{F}=\\{2,3\\}$:\n  - $m_{1}(T_{F}) = (1+1) \\bmod 2 = 0$,\n  - $m_{2}(T_{F}) = (1+1) \\bmod 2 = 0$,\n  - $m_{3}(T_{F}) = 1 \\bmod 2 = 1$,\n  - $m_{4}(T_{F}) = 0$.\n  因此，\n  $$\n  m^{F}=(0,0,1,0),\n  $$\n  即，一次Flp脉冲将 $(s_{1},s_{2},s_{3},s_{4})$ 映射为 $(s_{1},s_{2},-s_{3},s_{4})$。\n\n因此，从 $x^{(0)}=(0,0,0,0)$ 出发，可达状态的集合是仿射集\n$$\n\\{\\,x^{(0)} + a\\,m^{C} + b\\,m^{F} \\;:\\; a,b \\in \\{0,1\\}\\,\\},\n$$\n因为每次脉冲是在 $\\mathbb{Z}_{2}^{4}$ 中加上 $m^{C}$ 或 $m^{F}$，且这些运算是可交换的。由于 $m^{C}$ 和 $m^{F}$ 在 $\\mathbb{Z}_{2}$ 上是线性无关的，因此恰好有 $2^{2}=4$ 个不同的可达状态。因此，最多可以访问4个唯一的状态（包括初始状态）。\n\n一次事件是一次脉冲；为避免重复任何状态（包括初始状态），最多可以通过3次事件访问所有4个不同的状态。例如，应用Flp、Cre、Flp序列可以获得四个不同的状态；任何第四次事件都将重复一个先前访问过的状态。因此，在任何状态重复之前，可以记录的唯一连续事件的最大数量是\n$$\nN=4-1=3.\n$$", "answer": "$$\\boxed{3}$$", "id": "2022417"}]}