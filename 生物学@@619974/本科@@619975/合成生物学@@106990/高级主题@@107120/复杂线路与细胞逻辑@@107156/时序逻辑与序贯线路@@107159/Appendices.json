{"hands_on_practices": [{"introduction": "本练习旨在将细胞内的基因线路视为一个有限状态机，这是理解时序逻辑电路的基础。通过追踪一个三稳态记忆模块在一系列化学信号输入下的状态变迁，你将实践顺序处理事件并确定系统最终状态的核心技能。这一思想实验阐明了细胞如何通过离散的内部状态来“记忆”和响应过去事件的序列 [@problem_id:2073892]。", "problem": "一个合成生物学研究团队正在一个细菌内部设计一种基因时序电路。该电路被称为“三稳态记忆模块”，被设计用于响应一系列化学输入信号。电路的状态决定了细菌会产生哪种蛋白质（如果有的话）。该模块可以存在于以下三种离散状态之一：\n\n1.  **OFF**：基线状态，在此状态下不产生特定的输出蛋白质。模块在初始创建时始终处于此状态。\n2.  **PRIMED**：由一个初始信号触发的中间状态。在此状态下，细胞会产生一种瞬时的、非功能性的标记肽，但不会产生最终的输出蛋白质。\n3.  **ON**：完全激活状态，在此状态下，细胞会稳定地产生一种所需的功能性蛋白质（例如，一种酶或一个荧光标记物）。\n\n这些状态之间的转换受向细胞环境中添加三种不同的、不相互作用的化学信号所控制。电路一次处理一个信号，其状态转换是基于当前状态和当前输入信号的确定性过程。逻辑如下：\n\n*   **从 OFF 状态的转换：**\n    *   输入 `Signal-X` 会导致转换到 `PRIMED` 状态。\n    *   输入 `Signal-Y` 或 `Reset-Z` 不会引起变化，状态保持为 `OFF`。\n\n*   **从 PRIMED 状态的转换：**\n    *   输入 `Signal-Y` 会导致转换到 `ON` 状态。\n    *   输入 `Signal-X` 不会引起变化，状态保持为 `PRIMED`。\n    *   输入 `Reset-Z` 会导致转换到 `OFF` 状态。\n\n*   **从 ON 状态的转换：**\n    *   输入 `Reset-Z` 会导致转换到 `OFF` 状态。\n    *   输入 `Signal-X` 或 `Signal-Y` 不会引起变化，状态保持为 `ON`。\n\n制备了一份含有该电路的新的细菌培养物，这意味着所有电路最初都处于 `OFF` 状态。然后向该培养物按指定顺序逐个施加以下信号序列：\n\n`Signal-X`, `Signal-X`, `Signal-Y`, `Reset-Z`, `Signal-X`, `Signal-Y`\n\n在处理完这一整个信号序列后，三稳态记忆模块的最终状态是什么？\n\nA. OFF\n\nB. PRIMED\n\nC. ON\n\nD. 状态在 PRIMED 和 ON 之间振荡。\n\nE. 在不知道信号浓度的情况下，无法确定最终状态。", "solution": "我们将该模块建模为一个初始状态为 OFF 的确定性有限状态机。允许的状态转换如下：\n- 从 OFF：Signal-X 导致转换到 PRIMED；Signal-Y 或 Reset-Z 不导致变化（保持 OFF）。\n- 从 PRIMED：Signal-Y 导致转换到 ON；Signal-X 不导致变化（保持 PRIMED）；Reset-Z 导致转换到 OFF。\n- 从 ON：Reset-Z 导致转换到 OFF；Signal-X 或 Signal-Y 不导致变化（保持 ON）。\n\n从 OFF 状态开始，按顺序处理给定的序列。\n\n1) 输入：Signal-X，当前状态：OFF。根据从 OFF 状态的规则，Signal-X 使得下一状态为 PRIMED。\n状态变为 PRIMED。\n\n2) 输入：Signal-X，当前状态：PRIMED。根据从 PRIMED 状态的规则，Signal-X 不引起变化。\n状态保持为 PRIMED。\n\n3) 输入：Signal-Y，当前状态：PRIMED。根据从 PRIMED 状态的规则，Signal-Y 使得下一状态为 ON。\n状态变为 ON。\n\n4) 输入：Reset-Z，当前状态：ON。根据从 ON 状态的规则，Reset-Z 使得下一状态为 OFF。\n状态变为 OFF。\n\n5) 输入：Signal-X，当前状态：OFF。根据从 OFF 状态的规则，Signal-X 使得下一状态为 PRIMED。\n状态变为 PRIMED。\n\n6) 输入：Signal-Y，当前状态：PRIMED。根据从 PRIMED 状态的规则，Signal-Y 使得下一状态为 ON。\n状态变为 ON。\n\n因此，在处理完整个序列后，最终状态是 ON，对应于选项 C。转换是确定性的，并且不依赖于浓度，所以最终状态是唯一确定的。", "answer": "$$\\boxed{C}$$", "id": "2073892"}, {"introduction": "在生物电路中，除了逻辑关系，事件发生的 *时序* 也至关重要。这个练习通过一个经典的基因“拨动开关”模型，揭示了“竞争条件”这一关键概念，即两个同时启动的过程，其最终结果取决于哪一个率先完成。分析这个场景有助于理解动力学参数（如蛋白质合成和折叠的速率）如何决定细胞命运，并强调了在设计可预测的生物系统时考虑时序动态的重要性 [@problem_id:2073919]。", "problem": "一位合成生物学家在一种细菌中设计了一个遗传“决策”电路。该电路被设计用于在两种可能的状态中选择一种，这两种状态分别由两种荧光蛋白中的一种表达来表示：绿色荧光蛋白 (GFP) 或红色荧光蛋白 (RFP)。\n\n该电路由两个操纵子组成，排列成相互抑制的“拨动开关”结构：\n1.  **绿色操纵子 (Operon Green)**：包含 GFP 基因和一种阻遏蛋白 Repressor-R 的基因。该操纵子的表达由启动子-G (Promoter-G) 控制。\n2.  **红色操纵子 (Operon Red)**：包含 RFP 基因和一种阻遏蛋白 Repressor-G 的基因。该操纵子的表达由启动子-R (Promoter-R) 控制。\n\n阻遏蛋白的功能如下：\n-   由绿色操纵子产生的 Repressor-R 会结合并失活启动子-R (Promoter-R)。\n-   由红色操纵子产生的 Repressor-G 会结合并失活启动子-G (Promoter-G)。\n\n启动子-G (Promoter-G) 和启动子-R (Promoter-R) 最初都处于“关闭”状态，但被设计为通过添加相同的外部化学诱导剂 Signal-I 来激活。一旦将 Signal-I 添加到细胞培养物中，两个启动子会同时被激活，从而引发两个操纵子之间的“竞赛”。\n\n我们将每个通路的“锁定时间”定义为：从添加 Signal-I 开始，到该通路的阻遏蛋白达到足以完全且不可逆地关闭一个相对启动子分子的浓度时所经过的总时间。由于密码子使用和蛋白质折叠动力学的差异，每个通路的这些时间是不同的。\n\n-   绿色通路（产生足够的 Repressor-R）的锁定时间为 $T_{Green} = 18.5$ 分钟。\n-   红色通路（产生足够的 Repressor-G）的锁定时间为 $T_{Red} = 16.0$ 分钟。\n\n如果在包含该电路的相同细胞培养物生长过程中，在时间 $t=0$ 时引入 Signal-I，那么细胞稳定、长期的可观察荧光状态将会是什么？\n\nA) 细胞将只表达 GFP 并呈现绿色。\n\nB) 细胞将只表达 RFP 并呈现红色。\n\nC) 细胞将同时表达 GFP 和 RFP，呈现黄色/橙色。\n\nD) 细胞将不会表达任何一种荧光蛋白。\n\nE) 结果不可预测；培养物将包含绿色细胞和红色细胞的随机混合。", "solution": "将 $T_{Green}$ 定义为从 $t=0$（添加 Signal-I）开始，直到绿色操纵子 (Operon Green) 产生足够的 Repressor-R 来关闭启动子-R (Promoter-R) 所需的时间；将 $T_{Red}$ 定义为红色操纵子 (Operon Red) 产生足够的 Repressor-G 来关闭启动子-G (Promoter-G) 所需的相应时间。根据设计，两个启动子在 $t=0$ 时被同时激活，开始各自阻遏蛋白的产生。\n\n对于一个相互抑制的拨动开关，其关键原理是：一旦某个阻遏蛋白首先达到其阈值浓度，它就会结合相对的启动子并将其关闭。这会终止相对阻遏蛋白的进一步产生，从而加强最初的获胜方，并建立一个一个操纵子开启而另一个关闭的稳定吸收态。因此，结果由锁定时间之间的不等关系决定：\n$$\n\\text{若 } T_{Red} < T_{Green} \\text{，则 Repressor-G 首先关闭 Promoter-G } \\Rightarrow \\text{Promoter-G 关闭，红色状态开启。}\n$$\n$$\n\\text{若 } T_{Green} < T_{Red} \\text{，则 Repressor-R 首先关闭 Promoter-R } \\Rightarrow \\text{Promoter-R 关闭，绿色状态开启。}\n$$\n\n根据给定的值，我们有 $T_{Red} < T_{Green}$。因此，红色通路首先锁定，Repressor-G 在 Repressor-R 达到其自身阈值之前就关闭了 Promoter-G，系统最终稳定在表达 RFP 而 GFP 被沉默的红色状态。由于培养物由在相同确定性时间条件下的相同细胞组成，因此在整个培养物中，稳定、长期的可观察状态将是单一的红色。", "answer": "$$\\boxed{B}$$", "id": "2073919"}, {"introduction": "这个高级练习将我们从定性分析带入定量设计的领域，挑战你分析一个实现复杂时间逻辑的合成电路。该电路的功能类似于一个时间“带通滤波器”，仅对持续时间在特定窗口 $[T_{min}, T_{max}]$ 内的输入信号产生响应，这要求你运用微分方程来精确描述蛋白质浓度随时间变化的动态过程。解决这个问题将展示如何通过调整电路的生化参数（如生产速率 $\\alpha$ 和降解速率 $\\delta$）来精确调控其时间响应行为 [@problem_id:2073941]。", "problem": "一个合成基因线路被设计用作时间带通滤波器，它仅对特定持续时间的输入信号产生响应。该线路的结构如下：\n\n输入信号被建模为一个持续时间为 $d_{in}$ 的化学诱导物 `S` 的方波脉冲，它同时启动激活蛋白 `A` 和阻遏蛋白 `R` 的产生。它们的浓度（记为 $[A]$ 和 $[R]$）的动态变化由以下一阶微分方程控制：\n$$ \\frac{d[A]}{dt} = \\alpha_A S(t) - \\delta_A [A] $$\n$$ \\frac{d[R]}{dt} = \\alpha_R S(t) - \\delta_R [R] $$\n其中，当 $0 \\le t \\le d_{in}$ 时，$S(t) = 1$，否则 $S(t) = 0$。参数 $\\alpha_A$ 和 $\\alpha_R$ 是最大生产速率，$\\delta_A$ 和 $\\delta_R$ 是一阶降解速率。在 $t=0$ 时，两种蛋白质的浓度均为零。\n\n仅当激活蛋白的浓度高于激活阈值 ($[A](t) > K_A$) 且阻遏蛋白的浓度低于阻遏阈值 ($[R](t) < K_R$) 时，该线路在时间 $t$ 产生荧光输出蛋白 `Y`。该线路被设计为激活蛋白比阻遏蛋白更稳定，即 $\\delta_A < \\delta_R$。只要关于 $[A]$ 和 $[R]$ 的条件得到满足，输出就可以在输入脉冲期间或之后产生。\n\n该滤波器的工作窗口由能导致产生一定量输出 `Y` 的输入持续时间范围 $[T_{min}, T_{max}]$ 定义。\n- $T_{min}$ 是使激活蛋白 `A` 的峰值浓度恰好达到阈值 $K_A$ 所需的最小输入持续时间。\n- $T_{max}$ 是产生输出的机会消失时的输入持续时间。这个临界点发生在以下情况：对于脉冲结束时的浓度 $[A](T_{max})$ 和 $[R](T_{max})$，其随后的衰减过程导致激活蛋白浓度降至 $K_A$ 以下的瞬间与阻遏蛋白浓度降至 $K_R$ 以下的瞬间完全相同。\n\n假设所有的生产速率和阈值常数均被设定为满足 $0 < K_A \\delta_A < \\alpha_A$ 和 $0 < K_R \\delta_R < \\alpha_R$。该线路的一个关键特性是能够通过改变阻遏蛋白的生产速率 $\\alpha_R$ 来调节其性质。\n\n确定使得时间滤波窗口完全关闭（即 $T_{max} = T_{min}$）时 $\\alpha_R$ 的具体值。请用 $\\alpha_A, \\delta_A, \\delta_R, K_A,$ 和 $K_R$ 将您的答案表示为一个符号表达式。", "solution": "在输入脉冲期间，当 $0 \\leq t \\leq d$ 时 $S(t)=1$，动力学方程\n$$\\frac{d[A]}{dt}=\\alpha_A-\\delta_A [A],\\qquad \\frac{d[R]}{dt}=\\alpha_R-\\delta_R [R],\\qquad [A](0)=[R](0)=0$$\n的解为\n$$[A](t)=\\frac{\\alpha_A}{\\delta_A}\\left(1-\\exp(-\\delta_A t)\\right),\\qquad [R](t)=\\frac{\\alpha_R}{\\delta_R}\\left(1-\\exp(-\\delta_R t)\\right)。$$\n因此，在持续时间为 $d$ 的脉冲结束时，浓度为\n$$A_d=[A](d)=\\frac{\\alpha_A}{\\delta_A}\\left(1-\\exp(-\\delta_A d)\\right),\\qquad R_d=[R](d)=\\frac{\\alpha_R}{\\delta_R}\\left(1-\\exp(-\\delta_R d)\\right)。$$\n脉冲结束后（$t>d$），两种物质均发生衰减：\n$$[A](t)=A_d\\,\\exp(-\\delta_A(t-d)),\\qquad [R](t)=R_d\\,\\exp(-\\delta_R(t-d))。$$\n\n根据定义，$T_{min}$ 是使激活蛋白峰值浓度恰好达到 $K_A$ 的最小持续时间。由于 $[A](t)$ 在脉冲期间单调增加然后衰减，因此对于固定的 $d$，其峰值出现在 $t=d$。因此，$T_{min}$ 满足\n$$A_{T_{min}}=K_A\\quad\\Longrightarrow\\quad \\frac{\\alpha_A}{\\delta_A}\\left(1-\\exp(-\\delta_A T_{min})\\right)=K_A,$$\n可得\n$$\\exp(-\\delta_A T_{min})=1-\\frac{K_A\\delta_A}{\\alpha_A},\\qquad T_{min}=\\frac{1}{\\delta_A}\\ln\\!\\left(\\frac{\\alpha_A}{\\alpha_A-K_A\\delta_A}\\right)。$$\n\n对于 $T_{max}$，定义 $t_A$ 和 $t_R$ 为脉冲后 $[A]$ 和 $[R]$ 分别穿过其阈值的时间。根据脉冲后的衰减方程，\n$$t_A-d=\\frac{1}{\\delta_A}\\ln\\!\\left(\\frac{A_d}{K_A}\\right),\\qquad t_R-d=\\frac{1}{\\delta_R}\\ln\\!\\left(\\frac{R_d}{K_R}\\right)。$$\n在 $T_{max}$ 时，当这两个穿越时间点重合时，产生输出的机会消失：\n$$\\frac{1}{\\delta_A}\\ln\\!\\left(\\frac{A_d}{K_A}\\right)=\\frac{1}{\\delta_R}\\ln\\!\\left(\\frac{R_d}{K_R}\\right)\\quad\\text{with }d=T_{max}。$$\n\n我们现在施加窗口关闭条件 $T_{max}=T_{min}$。当 $d=T_{min}$ 时，根据定义有 $A_d=K_A$，因此\n$$\\frac{1}{\\delta_A}\\ln\\!\\left(\\frac{A_d}{K_A}\\right)=\\frac{1}{\\delta_A}\\ln(1)=0,$$\n这迫使\n$$\\frac{1}{\\delta_R}\\ln\\!\\left(\\frac{R_d}{K_R}\\right)=0\\quad\\Longrightarrow\\quad R_d=K_R。$$\n因此，在 $d=T_{min}$ 时，阻遏蛋白在脉冲结束时的浓度必须满足\n$$\\frac{\\alpha_R}{\\delta_R}\\left(1-\\exp(-\\delta_R T_{min})\\right)=K_R,$$\n由此解出 $\\alpha_R$ 为\n$$\\alpha_R=\\frac{\\delta_R K_R}{1-\\exp(-\\delta_R T_{min})}.$$\n将 $T_{min}=\\frac{1}{\\delta_A}\\ln\\!\\left(\\frac{\\alpha_A}{\\alpha_A-K_A\\delta_A}\\right)$ 代入可得\n$$\\exp(-\\delta_R T_{min})=\\exp\\!\\left(-\\frac{\\delta_R}{\\delta_A}\\ln\\!\\left(\\frac{\\alpha_A}{\\alpha_A-K_A\\delta_A}\\right)\\right)=\\left(\\frac{\\alpha_A-K_A\\delta_A}{\\alpha_A}\\right)^{\\delta_R/\\delta_A}。$$\n因此，时间窗口关闭时的阻遏蛋白生产速率为\n$$\\alpha_R=\\frac{\\delta_R K_R}{1-\\left(\\frac{\\alpha_A-K_A\\delta_A}{\\alpha_A}\\right)^{\\delta_R/\\delta_A}}=\\frac{\\delta_R K_R}{1-\\left(1-\\frac{K_A\\delta_A}{\\alpha_A}\\right)^{\\delta_R/\\delta_A}}。$$\n该表达式符合 $0<K_A\\delta_A<\\alpha_A$ 的假设（这确保了 $T_{min}>0$ 且指数的底数在 $(0,1)$ 区间内），并给出一个正的有限值 $\\alpha_R$。", "answer": "$$\\boxed{\\frac{\\delta_R K_R}{1-\\left(1-\\frac{K_A \\delta_A}{\\alpha_A}\\right)^{\\delta_R/\\delta_A}}}$$", "id": "2073941"}]}