{"hands_on_practices": [{"introduction": "在设计下一代测序 (NGS) 实验时，一个核心问题是：“我需要多少测序数据？” 测序深度或覆盖度 ($coverage$) 是回答这个问题的关键指标，它代表基因组中每个碱基被独立测序读取的平均次数。本练习将通过一个实际场景，引导你使用泊松分布 ($Poisson\\,distribution$) 模型来探索平均覆盖度与测序“盲点”（即零覆盖区域）之间的定量关系。理解这一点对于确保实验能够以足够的成本效益完整地捕获目标序列至关重要。[@problem_id:2045416]", "problem": "一个合成生物学研究团队正在验证一个定制构建的细菌人工染色体 (BAC) 的序列。他们进行了一项二代测序 (NGS) 实验，并获得了一组短DNA读段。他们实验的关键参数如下：\n\n- BAC基因组的总长度 $L$ 为 200 千碱基对 (kbp)。\n- 生成的读段总数 $N$ 为 9,200。\n- 每个读段的平均长度 $R$ 为 100 碱基对 (bp)。\n\n假设读段在BAC基因组上随机且均匀分布，那么某个特定碱基被恰好 $k$ 个读段覆盖的概率 $P(k)$ 可以用泊松分布来建模：$P(k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$，其中 $\\lambda$ 是整个基因组的平均覆盖深度。\n\n基于这些信息，计算BAC基因组中期望覆盖深度为零 (即未被测序) 的理论比例。将您的答案以小数形式表示，并四舍五入到三位有效数字。", "solution": "我们用均值 (平均深度) 为 $\\lambda$ 的泊松分布来为每个碱基的覆盖情况建模。在读段随机、均匀放置的情况下，平均深度等于测序的总碱基数除以基因组长度：\n$$\n\\lambda = \\frac{N R}{L}\n$$\n已知 $N=9200$，$R=100$ bp，以及 $L=200\\,\\text{kbp}=200000$ bp，\n$$\n\\lambda = \\frac{9200 \\cdot 100}{200000} = \\frac{920000}{200000} = 4.6\n$$\n对于泊松模型，一个碱基覆盖深度为零的概率是：\n$$\nP(0) = \\exp(-\\lambda) = \\exp(-4.6)\n$$\n数值计算结果为：\n$$\n\\exp(-4.6) \\approx 0.0100518 \\approx 0.0101 \\text{ (three significant figures)}\n$$\n因此，BAC基因组中期望覆盖深度为零的理论比例是 $0.0101$。", "answer": "$$\\boxed{0.0101}$$", "id": "2045416"}, {"introduction": "获得了测序数据后，我们如何评估其可靠性？Phred质量分数 ($Phred\\,quality\\,score$) 为我们提供了一个强有力的工具，它以对数形式量化了每次碱基识别的错误概率。这个练习将让你亲手计算如何从给定的Phred分数反推出单个碱基的错误率，并进一步评估在一个合成基因的全长序列中出现至少一个错误的概率。通过这个实践，你将能更直观地理解测序质量分数在确保合成生物学构建模块序列准确性中的实际意义。[@problem_id:2045434]", "problem": "在一个合成生物学项目中，一位研究人员构建了一个总长度为 $L = 500$ 碱基对的短合成基因。为了验证该序列，他们使用了一个新一代测序（NGS）平台。该特定基因片段的测序输出报告显示，每个碱基的Phred质量分数均为 $Q = 40$。\n\nPhred质量分数 $Q$ 是衡量自动DNA测序所生成的核碱基识别质量的一种指标。它由以下公式定义：\n$$Q = -10 \\log_{10}(P_e)$$\n其中 $P_e$ 是相应碱基检出不正确的概率。\n\n假设每个碱基位置的测序错误是独立事件，计算在整个500碱基对的基因序列中发现至少一个不正确碱基检出的概率。\n\n将最终答案四舍五入至四位有效数字。", "solution": "我们给定一个长度为 $L=500$ 个碱基的基因，并且每个碱基具有一致的Phred质量分数 $Q=40$。Phred的定义为：\n$$Q=-10\\log_{10}(P_{e})$$\n所以每个碱基的错误概率是：\n$$P_{e}=10^{-Q/10}$$\n代入 $Q=40$ 得到：\n$$P_{e}=10^{-4}$$\n\n假设各碱基之间是独立的，所有 $L$ 个碱基都被正确检出（即零错误）的概率是：\n$$(1-P_{e})^{L}$$\n因此，序列中至少有一个不正确碱基检出的概率是：\n$$P(\\text{at least one error})=1-(1-P_{e})^{L}$$\n代入 $P_{e}=10^{-4}$ 和 $L=500$：\n$$P=1-(1-10^{-4})^{500}$$\n\n为了进行数值计算，我们将其写作：\n$$(1-10^{-4})^{500}=\\exp\\!\\left(500\\,\\ln(1-10^{-4})\\right)$$\n在 $x=10^{-4}$ 处使用级数 $\\ln(1-x)=-x-\\frac{x^{2}}{2}-\\frac{x^{3}}{3}-\\cdots$，\n$$\\ln(1-10^{-4})\\approx-10^{-4}-\\frac{10^{-8}}{2}-\\frac{10^{-12}}{3}=-0.000100005000000333\\ldots$$\n因此：\n$$500\\,\\ln(1-10^{-4})\\approx-0.050002500000166\\ldots$$\n并且：\n$$(1-10^{-4})^{500}\\approx\\exp(-0.0500025)\\approx 0.951227046\\ldots$$\n所以，\n$$P=1-(1-10^{-4})^{500}\\approx 0.048772953\\ldots$$\n四舍五入到四位有效数字后为 $0.04877$。", "answer": "$$\\boxed{0.04877}$$", "id": "2045434"}, {"introduction": "即使我们拥有高覆盖度和高质量的测序读长，将这些短片段完美地拼接成完整序列也并非易事，尤其是在面对重复序列时。这是短读长测序技术的一个固有挑战。本练习模拟了一个在合成生物学中常见的情景：确定质粒中串联重复序列的精确拷贝数。通过解决这个问题，你将揭示读长 ($L$)、重复单元长度 ($r$) 和可明确解析的重复次数 ($N$) 之间的根本性数学约束，从而深刻理解为何基因组中的重复区域是序列组装的主要障碍。[@problem_id:2045444]", "problem": "一家合成生物学公司的一位生物信息学家正在为一个定制质粒的质量控制流程提供咨询。这些质粒带有一个可变的遗传条形码，该条形码由一个特定DNA序列 `R'` 的 $N$ 次串联重复区域构成。这个重复单元 `R'` 的长度为40个碱基对（bp）。在质粒构建完成后，需要确定拷贝数 $N$ 的确切值。整个串联重复区域的两侧由已知的独有序列环绕。\n\n质量控制将使用一种短读长测序技术进行，该技术产生的读长具有恒定长度 $L = 150$ bp。然后，将使用一个标准的基于 de Bruijn 图的组装算法，根据这些读长重建完整的质粒序列。\n\n只有当拷贝数 $N$ 的确切值能够从最终的组装图中被明确确定时，该条形码区域的组装才被认为是“已解析”的。考虑到短读长测序的局限性，该组装过程能保证解析的序列 `R'` 的最大整数串联拷贝数 $N_{\\max}$ 是多少？", "solution": "设重复单元的长度为 $r=40$，读长为 $L=150$。在一个由独有序列环绕的完美串联重复的基于 de Bruijn 图的组装中，只有当至少有一条读长能够跨越左侧的独有序列，穿过所有 $N$ 个重复拷贝，并进入右侧的独有序列时，拷贝数 $N$ 才能被明确地解析。如果没有这样的跨越读长，重复序列在图中会坍缩，其多重性会变得不明确。\n\n如果总重复长度为 $T=Nr$，那么一条长度为 $L$ 的读长只有在它能覆盖重复序列的所有 $T$ 个碱基，并且仍然包含来自两侧独有序列的至少各一个碱基时，才能跨越两侧。将读长中包含的最少侧翼碱基总数记为 $2$（每侧一个碱基），保证可解析的充分必要条件是：\n$$\nL \\ge Nr + 2\n$$\n求解 $N$ 可得：\n$$\nN \\le \\frac{L-2}{r}\n$$\n因为 $N$ 必须是整数，所以可保证解析的最大拷贝数是：\n$$\nN_{\\max}=\\left\\lfloor \\frac{L-2}{r} \\right\\rfloor\n$$\n代入 $L=150$ 和 $r=40$：\n$$\nN_{\\max}=\\left\\lfloor \\frac{150-2}{40} \\right\\rfloor=\\left\\lfloor \\frac{148}{40} \\right\\rfloor=\\left\\lfloor 3.7 \\right\\rfloor=3\n$$\n因此，最多可以保证解析 $3$ 个串联重复拷贝；$4$ 个或更多拷贝则无法保证被解析，因为没有任何读长能够跨越整个重复阵列并连接两侧的独有序列。", "answer": "$$\\boxed{3}$$", "id": "2045444"}]}