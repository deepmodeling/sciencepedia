{"hands_on_practices": [{"introduction": "FASTA是生物信息学中最基本和应用最广泛的序列文件格式。这个练习将指导你根据合成生物学中的一个常见场景——订购合成DNA片段——来亲手构建一个符合规范的FASTA文件，掌握其头部和序列部分的关键格式要求。这是处理任何序列数据工作的基本功。[@problem_id:2068080]", "problem": "一名合成生物学学生正在大肠杆菌（*E. coli*）中设计一个新的基因回路。作为该回路的一部分，该学生需要订购一个定制设计的、长度为80个碱基对的合成启动子。合成脱氧核糖核酸（DNA）的公司要求订单以FASTA格式提交。\n\n公司规定FASTA的标题行必须遵循以下结构：`>GeneID|Designer|TargetOrganism`。\n对于此特定订单，所需信息如下：\n*   GeneID: `pMod_v1`\n*   Designer: `A.Lovelace`\n*   TargetOrganism: `E.coli`\n\n该启动子的80个碱基对DNA序列为：\n`5'-AGCTTCAAGTTGATTGGAGCGGTCACAGGTTTGCGACGGTATCAGGCTAGAGTCACCTGATTAACATGGAGATTACGCG-3'`\n\n序列数据本身必须根据标准的生物信息学惯例进行格式化。这意味着序列在标题行之后另起一个新行开始，且文本行不应超过80个字符。对于长度超过常规行长60个字符的序列，通常会换行至后续行。\n\n以下哪个选项代表了此合成启动子的正确格式化的FASTA提交文件？\n\nA.\n```\n>pMod_v1,A.Lovelace,E.coli\nAGCTTCAAGTTGATTGGAGCGGTCACAGGTTTGCGACGGTATCAGGCTAGAGTCACCTGATTAACATGGAGATTACGCG\n```\n\nB.\n```\nAGCTTCAAGTTGATTGGAGCGGTCACAGGTTTGCGACGGTATCAGGCTAGAGTCACCTG\nATTAACATGGAGATTACGCG\n```\n\nC.\n```\n>pMod_v1|A.Lovelace|E.coliAGCTTCAAGTTGATTGGAGCGGTCACAGGTTTGCGACGGTATCAGGCTAGAGTCACCTGATTAACATGGAGATTACGCG\n```\n\nD.\n```\n>pMod_v1|A.Lovelace|E.coli\nAGCTTCAAGTTGATTGGAGCGGTCACAGGTTTGCGACGGTATCAGGCTAGAGTCACCTGATTAACATGGAGATTACGCG\n```\n\nE.\n```\n>pMod_v1|A.Lovelace|E.coli\nAGCTTCAAGTTGATTGGAGCGGTCACAGGTTTGCGACGGTATCAGGCTAGAGTCACCTG\nATTAACATGGAGATTACGCG\n```", "solution": "我们从题目描述中确定所需的FASTA格式化规则：\n- 标题行必须是以“>”开头的单行，并格式化为“>GeneID|Designer|TargetOrganism”。\n- 序列必须在标题行之后另起新行开始。\n- 每行不得超过80个字符；长度超过60个字符的序列通常会换行，常见的做法是每行60个字符。\n\n给定GeneID为 pMod_v1，Designer为 A.Lovelace，TargetOrganism为 E.coli，正确的标题行应为：\n>pMod_v1|A.Lovelace|E.coli\n\n评估各个选项：\n- A选项使用了逗号而非竖线，因此不正确。\n- B选项缺少必需的FASTA标题行，因此不正确。\n- C选项将序列与标题行放在同一行，违反了序列应另起新行的规则；不正确。\n- D选项有正确的标题行，并将整个序列放在下一行。虽然这没有超过80个字符的限制，通常也是可以接受的，但题目强调了对于超过60个字符的序列，通常在60个字符处进行换行的惯例。\n- E选项有正确的标题行，并将80个碱基的序列换行显示在两行上，第一行为常规的60个字符长度，剩余的20个字符在下一行，这符合标准的生物信息学惯例。\n\n因此，正确格式化的FASTA提交文件是选项E。", "answer": "$$\\boxed{E}$$", "id": "2068080"}, {"introduction": "从简单的FASTA格式进阶，GenBank文件提供了更丰富的注释信息，例如基因位置、功能和翻译产物。然而，数据的丰富性也带来了出错的可能性，因此验证注释的准确性是一项重要的技能。本练习将带你扮演一位生物信息学家的角色，通过计算一个编码序列（CDS）的长度并将其与注释的蛋白质长度进行比对，来发现潜在的注释错误。[@problem_id:2068087]", "problem": "一位生物信息学家正在对新提交的基因组注释进行质量控制检查。他们怀疑一个 GenBank 文件中某个特定基因条目存在错误。该基因的编码序列 (CDS) 特征描述如下：\n\n`CDS             complement(join(1201..1350,1501..1602,1820..1984))`\n\n与此 `CDS` 特征相关联的 `/translation` 限定符提供了一个长为 140 个氨基酸的氨基酸序列。\n\n根据 GenBank 格式约定：\n- 数字 `a..b` 表示从碱基 `a` 到碱基 `b`（含）的连续核苷酸序列。这样一个片段的长度是 `b - a + 1`。\n- `join(loc1, loc2, ...)` 表示 `CDS` 是由按指定顺序连接的每个位置的核苷酸序列构成的。这些连接起来的片段在剪接后形成信使 RNA (mRNA)。\n- `complement(...)` 表示该基因位于 DNA 的互补链上。在计算编码区总长度时，此信息不会改变所涉及的总碱基对数。\n- 根据定义，`CDS` 包括终止密码子的编码区。翻译过程将每个 3 碱基的密码子转换为一个氨基酸，但最后的终止密码子本身*不会*被翻译成氨基酸，也不是最终蛋白质链的一部分。\n\n您的任务是确定根据给定的 `CDS` 位置字符串应该产生的蛋白质的正确长度（以氨基酸数量表示）。", "solution": "CDS 的位置由 complement(join(1201..1350,1501..1602,1820..1984)) 给出。总编码长度是三个片段长度之和，每个片段的长度计算为 $b-a+1$。\n\n对于第一个片段 $1201..1350$，长度是\n$$\nL_{1}=1350-1201+1=150.\n$$\n对于第二个片段 $1501..1602$，长度是\n$$\nL_{2}=1602-1501+1=102.\n$$\n对于第三个片段 $1820..1984$，长度是\n$$\nL_{3}=1984-1820+1=165.\n$$\nCDS 的总长度是\n$$\nL=L_{1}+L_{2}+L_{3}=150+102+165=417.\n$$\n`complement` 的指示不改变核苷酸的总数。一个 CDS 包含终止密码子，翻译过程每个密码子使用 $3$ 个核苷酸。因此，密码子的总数是\n$$\nN_{\\text{codons}}=\\frac{L}{3}=\\frac{417}{3}=139.\n$$\n由于终止密码子不被翻译成氨基酸，因此最终蛋白质的长度（以氨基酸计）是\n$$\nN_{\\text{aa}}=N_{\\text{codons}}-1=139-1=138.\n$$\n因此，所提供的 $140$ 个氨基酸的翻译长度与 CDS 坐标不一致。", "answer": "$$\\boxed{138}$$", "id": "2068087"}, {"introduction": "掌握了序列文件的读写和验证后，我们可以挑战一项合成生物学中的核心任务：计算机模拟克隆（*in silico* cloning）。这个练习模拟了将一个基因插入质粒载体的过程，这不仅要求你拼接DNA序列，更重要的是，你需要系统地更新GenBank文件中所有受影响的特征（features）坐标。准确地完成这一步对于维护设计和实验记录的完整性至关重要。[@problem_id:2068076]", "problem": "在一个合成生物学项目中，研究人员需要在实验室进行实验之前，计算模拟将一个基因插入到质粒载体中。该过程涉及编辑载体的 GenBank 文件，以包含新基因的序列和特征。\n\n给定两个文件：\n1.  `pVector.gb`：一个 5000 碱基对 (bp) 的环状质粒的 GenBank 文件。其 FEATURES 表包含几个注释区域。为了克隆，它包含一个定义为 `misc_feature 2501..2506` 的特定特征，其限定符为 `/label=\"CloningSite\"`。你可以假设没有其他注释特征与该位点重叠。\n2.  `myGene.fa`：一个 FASTA (Fast-All) 格式的文件，包含一个目标基因的 DNA 序列。该文件中的序列长度为 1500 bp。\n\n任务是生成一个代表重组质粒的新 GenBank 文件。这通过从 `pVector.gb` 中切除 \"CloningSite\"（`2501..2506`）处的 6 bp 序列，并在此位置插入来自 `myGene.fa` 的 1500 bp 序列来实现。\n\n以下哪个算法流程正确描述了生成有效的新重组质粒 GenBank 文件的所有必要步骤？\n\nA. 解析两个输入文件，以提取它们的序列和载体的特征表。通过用 1500 bp 的基因序列替换 6 bp 的 \"CloningSite\" 序列，构建新的、更长的 DNA 序列。更新 `LOCUS` 行中的总长度。在特征表中，移除 \"CloningSite\" 特征，为插入的基因添加一个新特征，并对于所有完全位于插入点下游的特征，将其起始和终止坐标按序列长度的净变化量（`1500 - 6 = 1494`）进行平移。最后，将更新后的组件组装成一个新的 GenBank 文件。\n\nB. 解析两个输入文件。通过用基因序列替换 \"CloningSite\" 序列来构建新的 DNA 序列。用新的总长度更新 `LOCUS` 行。在特征表中，移除 \"CloningSite\" 特征，并在插入位置为该基因添加一个新特征。不修改任何其他现有特征的坐标。将这些组件组装成一个新的 GenBank 文件。\n\nC. 解析两个输入文件。通过用基因序列替换 \"CloningSite\" 序列来构建新的 DNA 序列。不修改 `LOCUS` 行中指定的总长度。在特征表中，移除 \"CloningSite\" 特征，为插入的基因添加一个新特征，并正确平移所有下游特征的坐标。将这些组件组装成一个新的 GenBank 文件。\n\nD. 解析两个输入文件。通过将 1500 bp 的基因序列附加到原始 5000 bp 载体序列的末尾来构建新的 DNA 序列。将 `LOCUS` 行中的总长度更新为 6500 bp。在特征表中，为位于 `5001..6500` 位置的基因添加一个新特征。将这些组件组装成一个新的 GenBank 文件。\n\nE. 解析两个输入文件。通过用基因序列替换 \"CloningSite\" 序列来构建新的 DNA 序列。用新的总长度更新 `LOCUS` 行。在特征表中，移除 \"CloningSite\" 特征，为插入的基因添加一个新特征，并对于所有完全位于插入点下游的特征，将其起始和终止坐标按插入基因的全长（1500）进行平移。将更新后的组件组装成一个新的 GenBank 文件。", "solution": "我们将此编辑过程形式化为对以 GenBank 格式表示的带注释环状 DNA 序列的坐标变换。\n\n设原始质粒长度为 $L_{\\text{old}}$，删除片段长度为 $L_{\\text{del}}$，插入基因长度为 $L_{\\text{ins}}$。净长度变化为 $\\Delta L = L_{\\text{ins}} - L_{\\text{del}}$，新的总长度为 $L_{\\text{new}} = L_{\\text{old}} + \\Delta L$。根据给定值，$L_{\\text{old}}=5000$，$L_{\\text{del}}=6$，$L_{\\text{ins}}=1500$，因此 $\\Delta L = 1494$ 且 $L_{\\text{new}}=6494$。\n\n在原始载体中，通过坐标 $a..b$ 定义插入区间，其中 $a=2501$ 且 $b=2506$，并（如题所述）假设没有其他注释特征与 $[a,b]$ 重叠。通过将原始载体序列中位于 $[a,b]$ 的子序列替换为来自 FASTA 文件的完整基因序列，构建新序列，从而产生一个长度为 $L_{\\text{new}}$ 的连续序列。更新 LOCUS 行以反映 $L_{\\text{new}}$ 并保持环状拓扑。\n\n对于特征坐标的更新，应用原位替换编辑的标准坐标平移规则：\n- 移除注释了被切除区间的特征（此处指具有识别克隆位点的键和限定符的特征）。\n- 为插入的基因添加一个新特征，它在新坐标系中占据 $[a, a + L_{\\text{ins}} - 1]$ 的位置。\n- 对于任何完全位于上游的现有特征，即其两个端点都 $\\leq a - 1$ 的特征，其坐标保持不变。\n- 对于任何完全位于下游的现有特征，即其两个端点都 $\\geq b + 1$ 的特征，将其起始和终止坐标都平移 $\\Delta L$。\n- 对于与 $[a,b]$ 重叠的特征，需要进行适当的分割或调整，但题目说明没有重叠，因此这种情况不会发生。\n\n最后，通过组装更新后的 LOCUS 行、包含前述移除、插入和坐标平移的 FEATURES 表，以及更新后的 ORIGIN 序列，来重建一个有效的 GenBank 记录。\n\n根据这些必要步骤评估每个选项：\n- 选项 A 指出，通过用 1500 bp 的基因序列替换 6 bp 的“CloningSite”序列来构建新序列，更新 LOCUS 长度，移除克隆位点特征，添加基因特征，并将所有下游特征按净变化量 $\\Delta L = 1500 - 6 = 1494$ 进行平移，然后组装一个新的 GenBank 文件。这与正确的坐标变换和元数据更新相符。\n- 选项 B 的错误在于没有平移下游特征的坐标，这将导致注释不正确。\n- 选项 C 的错误在于没有更新 LOCUS 的总长度，该长度在序列修改后必须变为 $L_{\\text{new}}$。\n- 选项 D 错误地进行了附加操作而非替换，这与在克隆位点进行切除和替换的规定相矛盾。\n- 选项 E 将下游特征平移了 $L_{\\text{ins}}$ 而不是 $\\Delta L$，忽略了 $L_{\\text{del}}$ 的删除，从而导致下游特征的位置错误。\n\n因此，唯一正确的流程是选项 A。", "answer": "$$\\boxed{A}$$", "id": "2068076"}]}