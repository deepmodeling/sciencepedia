{"hands_on_practices": [{"introduction": "在基于免疫荧光的超分辨率方法 (如STORM) 中，我们定位的是荧光分子，而非目标蛋白本身。本练习通过一个简化的几何模型，来量化由一抗和二抗组成的标记链所引入的“连接误差” (linkage error)。通过计算这种误差的最大值，你将对定位精确度的一个基本物理限制有更具体的认识。[@problem_id:2339944]", "problem": "在超分辨率成像，如随机光学重建显微镜（Stochastic Optical Reconstruction Microscopy, STORM）中，精确定位目标蛋白通常采用间接免疫荧光法。该方法使用一种与目标蛋白结合的一抗，以及一种携带荧光分子（荧光团）并与一抗结合的二抗。此技术中一个重要的误差来源是“连接误差”，即由抗体链的尺寸所造成的荧光团与实际目标蛋白之间的物理距离。\n\n请考虑此情景的一个简化模型。一位研究人员正在对嵌入平坦细胞膜中的特定蛋白进行成像。该蛋白在膜上的真实位置可以视为一个单点。一个一抗，模型为一个有效长度为 $L_1 = 7.0$ nm 的刚性杆，与该蛋白结合。对于这种特定的蛋白-抗体相互作用，一抗被约束为完全垂直于细胞膜表面，并从细胞向外延伸。\n\n一个二抗，模型为第二个有效长度为 $L_2 = 16.0$ nm 的刚性杆，连接在一抗的自由端。一个荧光团位于此二抗的最末端。二抗可以围绕其在一抗上的连接点自由转动。然而，细胞表面覆盖着一层致密的糖萼，这阻止了荧光团靠近细胞膜。这就产生了一个“禁区”，使得荧光团从细胞膜表面垂直测量的最小可能高度为 $h_{min} = 15.0$ nm。\n\n最终的二维STORM图像中的连接误差对应于荧光团相对于蛋白真实位置在细胞膜平面上的投影距离。请计算在给定条件下此连接误差的最大可能值。用纳米（nm）表示您的答案，并将最终答案四舍五入到三位有效数字。", "solution": "该问题要求解荧光团与目标蛋白真实位置之间可能的最大投影横向距离。这个距离就是二维图像中的连接误差。\n\n我们建立一个坐标系来为该问题建模。设平坦的细胞膜为 $xy$-平面，设目标蛋白的真实位置在原点 $P = (0, 0, 0)$。\n\n一抗被描述为一个长度为 $L_1$ 且垂直于膜的刚性杆。它从蛋白位置 $(0, 0, 0)$ 沿 $z$ 轴正方向延伸。因此，二抗与一抗的连接点坐标为 $B = (0, 0, L_1)$。\n\n二抗是一个长度为 $L_2$ 的刚性杆，可围绕点 $B$ 自由转动。荧光团位于此二抗的末端。设荧光团的坐标为 $F = (x, y, z)$。荧光团 $F$ 与其转动点 $B$ 之间的距离始终等于 $L_2$。利用三维空间中的距离公式，我们可以写出荧光团必须位于的球面方程：\n$$(x - 0)^2 + (y - 0)^2 + (z - L_1)^2 = L_2^2$$\n$$x^2 + y^2 + (z - L_1)^2 = L_2^2$$\n\n连接误差是荧光团在 $xy$-平面上到原点的投影距离。这个横向距离 $d_{lat}$ 由 $d_{lat} = \\sqrt{x^2 + y^2}$ 给出。我们要求出 $d_{lat}$ 的最大可能值。\n\n根据球面方程，我们可以将横向距离的平方表示为：\n$$d_{lat}^2 = x^2 + y^2 = L_2^2 - (z - L_1)^2$$\n为使 $d_{lat}$ 最大化，我们必须使 $d_{lat}^2$ 最大化。\n当 $(z - L_1)^2$ 项最小时，即可达到最大化。\n\n问题陈述了对荧光团位置的约束：其离膜高度 $z$ 不能小于 $h_{min}$。因此，我们有约束条件 $z \\ge h_{min}$。\n\n我们来分析在约束条件 $z \\ge h_{min}$ 下的函数 $f(z) = (z - L_1)^2$。函数 $f(z)$ 是一个开口向上、顶点（最小值）在 $z = L_1$ 的抛物线。\n我们已知以下数值：\n$L_1 = 7.0$ nm\n$L_2 = 16.0$ nm\n$h_{min} = 15.0$ nm\n\n对 $z$ 的约束条件是 $z \\ge 15.0$ nm。函数 $(z - L_1)^2 = (z - 7.0)^2$ 的最小值出现在 $z = 7.0$ nm 处。然而，该值不在 $z$ 的允许定义域内，因为 $7.0 < 15.0$。对于 $z > 7.0$ 的值，函数 $(z - 7.0)^2$ 是严格递增的。因此，在允许的定义域 $z \\ge 15.0$ nm 内，该函数在 $z$ 的最低可能值处取得最小值。\n\n$z$ 的最小允许值为 $h_{min}$。因此，要最小化 $(z - L_1)^2$ 从而最大化 $d_{lat}^2$，我们必须设 $z = h_{min}$。\n\n将 $z = h_{min}$ 代入最大横向距离平方的表达式中：\n$$d_{lat, max}^2 = L_2^2 - (h_{min} - L_1)^2$$\n现在，我们可以代入给定的数值：\n$$d_{lat, max}^2 = (16.0)^2 - (15.0 - 7.0)^2$$\n$$d_{lat, max}^2 = 256 - (8.0)^2$$\n$$d_{lat, max}^2 = 256 - 64$$\n$$d_{lat, max}^2 = 192$$\n\n现在，我们取平方根来求最大横向距离：\n$$d_{lat, max} = \\sqrt{192} \\text{ nm}$$\n为了简化根式，我们可以分解 192：$192 = 64 \\times 3$。\n$$d_{lat, max} = \\sqrt{64 \\times 3} = 8\\sqrt{3} \\text{ nm}$$\n\n最后，我们需要提供一个四舍五入到三位有效数字的数值答案。\n$$d_{lat, max} \\approx 8 \\times 1.73205... \\text{ nm}$$\n$$d_{lat, max} \\approx 13.8564... \\text{ nm}$$\n四舍五入到三位有效数字，我们得到 $13.9$ nm。", "answer": "$$\\boxed{13.9}$$", "id": "2339944"}, {"introduction": "单分子定位显微镜的成像过程需要数分钟乃至更长时间，这使得系统对微小的机械漂移非常敏感。本练习模拟了在成像过程中样品台发生匀速线性漂移的场景，要求你计算这种漂移对一个完美圆形结构最终成像形状的影响。这个计算将清晰地揭示一个时间维度的伪影 (漂移) 如何转化为空间维度的变形 (图像失真)，从而加深你对SMLM图像构建过程的理解。[@problem_id:2339918]", "problem": "在单分子定位显微技术 (SMLM) 中，通过计算组合数千个单个荧光分子的精确位置，重建出一幅高分辨率图像。这些定位信息是在一个长的采集周期内逐帧收集的。\n\n考虑一个SMLM实验，旨在对一个生物结构进行成像，该结构实际上是一个完美的空心圆，半径为 $R_0 = 150$ 纳米 (nm)。该圆位于xy平面内。在 $T_{total} = 20$ 分钟的整个采集时间内，样品台经历了一个恒定、稳定的漂移。该漂移仅沿x轴正方向发生，速度为 $v = 2.5$ 纳米/秒。\n\n假设荧光团均匀分布在圆的圆周上，并且它们的定位在整个采集时间内是均匀采样的。最终重建的图像是从 $t=0$ 到 $t=T_{total}$ 记录的所有定位的集合。确定最终重建图像中表观结构的总宽度（沿x轴的最大范围）和总高度（沿y轴的最大范围）。以行矩阵的形式给出宽度和高度的答案，顺序为先宽后高。数值单位必须是纳米。", "solution": "我们将静止时的真实结构建模为xy平面上一个半径为 $R_{0}$ 的圆，其参数化表示为\n$$\n(x_{0}(\\theta),y_{0}(\\theta))=(R_{0}\\cos\\theta,\\;R_{0}\\sin\\theta),\\quad \\theta\\in[0,2\\pi).\n$$\n沿x轴正方向以速度 $v$ 随时间 $t$ 发生的恒定样品台漂移，会给x坐标增加一个平移量 $v t$，而y坐标保持不变。因此，在时间 $t\\in[0,T_{\\text{total}}]$ 记录的每个定位出现在\n$$\nx(\\theta,t)=R_{0}\\cos\\theta+v t,\\qquad y(\\theta,t)=R_{0}\\sin\\theta.\n$$\n因为定位在时间和圆周上都是均匀采样的，所以最终重建的图像是这些点在 $\\theta\\in[0,2\\pi)$ 和 $t\\in[0,T_{\\text{total}}]$ 上的并集。\n\n为了求出沿x轴的总范围，计算 $x(\\theta,t)$ 可能的最小值和最大值：\n- 由于 $\\cos\\theta\\in[-1,1]$ 且 $t\\in[0,T_{\\text{total}}]$，\n$$\nx_{\\min}=\\min_{\\theta,t}\\left(R_{0}\\cos\\theta+v t\\right)=(-R_{0})+0=-R_{0},\n$$\n$$\nx_{\\max}=\\max_{\\theta,t}\\left(R_{0}\\cos\\theta+v t\\right)=(+R_{0})+v T_{\\text{total}}.\n$$\n因此，总宽度为\n$$\nW=x_{\\max}-x_{\\min}=\\left(R_{0}+v T_{\\text{total}}\\right)-(-R_{0})=v T_{\\text{total}}+2R_{0}.\n$$\n\n为了求出沿y轴的总范围，注意到 $y(\\theta,t)=R_{0}\\sin\\theta$ 与 $t$ 无关，且 $\\sin\\theta\\in[-1,1]$，所以\n$$\ny_{\\min}=-R_{0},\\qquad y_{\\max}=+R_{0},\n$$\n总高度为\n$$\nH=y_{\\max}-y_{\\min}=2R_{0}.\n$$\n\n现在代入给定的数值。将采集时间转换为秒：\n$$\nT_{\\text{total}}=20\\ \\text{minutes}=20\\times 60\\ \\text{s}=1200\\ \\text{s}.\n$$\n计算总漂移距离 $L$：\n$$\nL=v T_{\\text{total}}=(2.5\\ \\text{nm/s})(1200\\ \\text{s})=3000\\ \\text{nm}.\n$$\n已知 $R_{0}=150\\ \\text{nm}$，\n$$\nW=L+2R_{0}=3000+2\\times 150=3300\\ \\text{nm},\\qquad H=2R_{0}=2\\times 150=300\\ \\text{nm}.\n$$\n\n因此，最终重建图像的宽度为 $3300$ nm，高度为 $300$ nm。", "answer": "$$\\boxed{\\begin{pmatrix} 3300 & 300 \\end{pmatrix}}$$", "id": "2339918"}, {"introduction": "获得一张超分辨率图像只是第一步，更关键的问题是：图像中的分子排布模式是源于真实的生物学结构，还是仅仅是随机分布的结果？本练习将指导你使用一种真实的空间统计学方法 (Ripley's K函数的简化版) 来量化蛋白质的聚集程度。通过计算“空间聚集指数” ($S(r)$)，你将学会一种从定位点云中提取定量生物学信息的强大技能。[@problem_id:2339948]", "problem": "细胞生物学中的一个核心挑战是确定通过超分辨率显微技术观察到的细胞膜上蛋白质的空间排布，是代表了真实的生物学组织结构，还是仅仅是随机偶然的结果。您作为一名生物物理分析师，任务是利用通过随机光学重建显微技术（Stochastic Optical Reconstruction Microscopy, STORM）获得的数据，来量化蛋白质的聚集程度。\n\n一位生物学家向您提供了一个数据集，包含了细胞膜上一个 $100 \\text{ nm} \\times 100 \\text{ nm}$ 的方形感兴趣区域（ROI）内的蛋白质定位信息。在一个简化的测试案例中，解析出了四个定位点，它们对应着四个独立的蛋白质分子。它们的二维坐标 $(x, y)$（以纳米为单位）如下：\nP1: $(20, 20)$\nP2: $(30, 20)$\nP3: $(70, 80)$\nP4: $(80, 80)$\n\n为了区分聚集模式与空间随机模式，您将计算在特定长度尺度 $r$ 下的“空间聚集指数”（Spatial Aggregation Index, SAI），记作 $S(r)$。$S(r)$ 的正值表明在该尺度上存在聚集。该指数通过以下步骤计算：\n\n1.  首先，计算函数 $K(r)$，其定义如下：\n    $$K(r) = \\frac{A}{N(N-1)} \\sum_{i=1}^{N} \\sum_{j \\neq i}^{N} \\mathbb{I}(d_{ij} \\le r)$$\n    其中 $A$ 是 ROI 的面积，$N$ 是蛋白质定位点的总数，$d_{ij}$是定位点 $i$ 和定位点 $j$ 之间的欧几里得距离，而 $\\mathbb{I}(\\cdot)$ 是指示函数，如果括号内的条件为真，其值为1，否则为0。双重求和遍历所有不同的有序点对。\n\n2.  接下来，将 $K(r)$ 归一化以获得长度尺度函数 $L(r)$：\n    $$L(r) = \\sqrt{\\frac{K(r)}{\\pi}}$$\n    对于完全随机的点分布，$L(r)$ 的期望值等于 $r$。\n\n3.  最后，空间聚集指数 $S(r)$ 通过计算 $L(r)$ 相对于随机情况的偏差得到：\n    $$S(r) = L(r) - r$$\n\n您的任务是，对于给定的这四个蛋白质定位点，在半径 $r = 15 \\text{ nm}$ 的条件下，计算空间聚集指数 $S(r)$ 的值。\n\n请用 nm 作答，结果四舍五入至三位有效数字。", "solution": "我们已知 ROI 的边长为 $100$ nm，所以面积是 $A = 100 \\times 100 = 10000$ nm$^{2}$。点的数量为 $N=4$。点 $i$ 和点 $j$ 之间的欧几里得距离为 $d_{ij} = \\sqrt{(x_{i}-x_{j})^{2} + (y_{i}-y_{j})^{2}}$。在半径 $r = 15$ nm 时，我们必须对所有 $i \\neq j$ 的有序点对计算指示函数 $\\mathbb{I}(d_{ij} \\le r)$ 的值。\n\n计算相关距离：\n- $d_{12} = d_{21} = \\sqrt{(20-30)^{2} + (20-20)^{2}} = 10 \\le 15$。\n- $d_{34} = d_{43} = \\sqrt{(70-80)^{2} + (80-80)^{2}} = 10 \\le 15$。\n- 所有其他点对间距离都大于 $15$ nm：\n  $d_{13} = d_{31} = \\sqrt{(20-70)^{2} + (20-80)^{2}} = \\sqrt{6100} > 15$,\n  $d_{14} = d_{41} = \\sqrt{(20-80)^{2} + (20-80)^{2}} = \\sqrt{7200} > 15$,\n  $d_{23} = d_{32} = \\sqrt{(30-70)^{2} + (20-80)^{2}} = \\sqrt{5200} > 15$,\n  $d_{24} = d_{42} = \\sqrt{(30-80)^{2} + (20-80)^{2}} = \\sqrt{6100} > 15$。\n\n因此，指示函数的双重求和的值为4。根据定义\n$$\nK(r) = \\frac{A}{N(N-1)} \\sum_{i=1}^{N} \\sum_{j \\neq i}^{N} \\mathbb{I}(d_{ij} \\le r),\n$$\n我们得到\n$$\nK(15) = \\frac{10000}{4 \\cdot 3} \\times 4 = \\frac{10000}{3}。\n$$\n接着，\n$$\nL(15) = \\sqrt{\\frac{K(15)}{\\pi}} = \\sqrt{\\frac{10000}{3\\pi}} = \\frac{100}{\\sqrt{3\\pi}}。\n$$\n最后，空间聚集指数为\n$$\nS(15) = L(15) - 15 = \\frac{100}{\\sqrt{3\\pi}} - 15。\n$$\n在数值上，仅在最后一步使用 $\\pi$ 来计算小数近似值，\n$$\n\\frac{100}{\\sqrt{3\\pi}} \\approx 32.585,\n\\quad\nS(15) \\approx 32.585 - 15 = 17.585,\n$$\n保留三位有效数字后为 $17.6$ nm。", "answer": "$$\\boxed{17.6}$$", "id": "2339948"}]}