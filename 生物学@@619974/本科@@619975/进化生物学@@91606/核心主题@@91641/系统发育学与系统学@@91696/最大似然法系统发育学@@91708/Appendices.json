{"hands_on_practices": [{"introduction": "在系统发育学中，不同的重建方法可能对同一数据集得出相互矛盾的结论。这个练习探讨了一个经典场景，即“长枝吸引”（Long-Branch Attraction），它可能误导简约法等方法。通过这个思想实验，我们将理解为什么最大似然法，当使用能解释不同谱系演化速率差异的恰当模型时，能够更准确地推断真实的演化关系。[@problem_id:1946247]", "problem": "一位进化生物学家正在研究四个现存物种 A、B、C 和 D 之间的系统发育关系。为简化问题，假设真实的进化历史由无根拓扑 `((A,B),(C,D))` 表示，其中 A 和 B 是姐妹种，C 和 D 是姐妹种。分子数据显示了一种不寻常的进化模式：与进化速度慢得多的物种 B 和 D 的谱系相比，导致物种 A 和 C 的谱系经历了显著加速的核苷酸替换速率。\n\n该生物学家对这四个物种的一个同源基因的 DNA 序列进行了比对。对序列比对中系统发育信息位点的分析揭示了两种主要模式：\n1.  **第1类位点**：在这些位点，物种 A 和 B 共享一种核苷酸，而物种 C 和 D 共享另一种不同的核苷酸（例如，A=G, B=G, C=T, D=T）。这些位点支持真实的拓扑结构。\n2.  **第2类位点**：在这些位点，物种 A 和 C 共享一种核苷酸，而物种 B 和 D 共享另一种不同的核苷酸（例如，A=A, C=A, B=C, D=C）。这些位点是在快速进化的分支上发生趋同或平行替换的结果。\n\n由于导致 A 和 C 的长分支上替换速率很高，第2类位点的数量显著多于第1类位点的数量。\n\n该生物学家决定使用两种不同的方法重建系统发育树：最大简约法 (MP) 和最大似然法 (ML)。ML 分析采用了一个替换模型，该模型能恰当地处理树上不同分支间不均等的进化速率。在此情景下，以下哪种结果最有可能发生？\n\nA. MP 将偏好拓扑 `((A,C),(B,D))`，而 ML 将偏好拓扑 `((A,B),(C,D))`。\n\nB. MP 将偏好拓扑 `((A,B),(C,D))`，而 ML 将偏好拓扑 `((A,C),(B,D))`。\n\nC. MP 和 ML 都将偏好真实的拓扑 `((A,B),(C,D))`。\n\nD. MP 和 ML 都将偏好错误的拓扑 `((A,C),(B,D))`。\n\nE. MP 和 ML 都将无法解析这些关系，导致一个未解析的多分支（polytomy）。", "solution": "我们将真实的无根拓扑表示为 $T_{\\text{true}}=((A,B),(C,D))$。数据包含两类简约信息位点：\n- 第1类：$A$ 和 $B$ 共享一种核苷酸，而 $C$ 和 $D$ 共享另一种不同的核苷酸；这些位点支持 $T_{\\text{true}}$。\n- 第2类：$A$ 和 $C$ 共享一种核苷酸，而 $B$ 和 $D$ 共享另一种不同的核苷酸；这些位点是由通向 $A$ 和 $C$ 的长分支上的趋同或平行替换产生的。\n\n设 $n_{1}$ 为第1类位点的数量，$n_{2}$ 为第2类位点的数量，由于 $A$ 和 $C$ 谱系上显著加速的速率，有 $n_{2} \\gg n_{1}$。\n\n最大简约法分析的流程是，对于每个候选拓扑，最小化所有位点上的总变化数。对于一个四分类单元、两种状态的简约信息位点，将共享相同状态的两个分类单元组合在一起的拓扑在该位点上需要 $1$ 步，而另外两种替代的无根拓扑各需要 $2$ 步（同塑性）。因此：\n- 对于第1类位点，拓扑 $((A,B),(C,D))$ 需要 $1$ 步；拓扑 $((A,C),(B,D))$ 和 $((A,D),(B,C))$ 各需要 $2$ 步。\n- 对于第2类位点，拓扑 $((A,C),(B,D))$ 需要 $1$ 步；拓扑 $((A,B),(C,D))$ 和 $((A,D),(B,C))$ 各需要 $2$ 步。\n\n对所有位点求和，总简约分数是\n$$\nS\\big(((A,B),(C,D))\\big)=n_{1}\\cdot 1+n_{2}\\cdot 2,\n$$\n$$\nS\\big(((A,C),(B,D))\\big)=n_{1}\\cdot 2+n_{2}\\cdot 1,\n$$\n$$\nS\\big(((A,D),(B,C))\\big)=n_{1}\\cdot 2+n_{2}\\cdot 2.\n$$\n比较前两个分数，\n$$\nS\\big(((A,C),(B,D))\\big)<S\\big(((A,B),(C,D))\\big)\\quad \\Longleftrightarrow \\quad n_{1}\\cdot 2+n_{2}\\cdot 1<n_{1}\\cdot 1+n_{2}\\cdot 2 \\quad \\Longleftrightarrow \\quad n_{2}>n_{1},\n$$\n根据假设，此不等式成立。因此，最大简约法将偏好错误的、由长分支吸引导致的拓扑 $((A,C),(B,D))$。这就是经典的长分支吸引（Felsenstein 区）结果：在这种条件下，MP 法是统计不一致的。\n\n在使用能够恰当处理不同分支间不均等速率的替换模型时，最大似然法分析会为每个拓扑评估其似然值。该似然值是在给定系统发育树及其枝长的情况下，观察到位点模式的概率在所有位点上的乘积。在此，数据生成过程是在真实拓扑 $((A,B),(C,D))$ 上，有通向 $A$ 和 $C$ 的长分支，以及通向 $B$ 和 $D$ 的短分支。一个允许分支特定速率（等同于自由枝长）的模型与此过程相匹配。在这种被正确定规的模型下，ML 法是统计一致的：随着序列长度的增加，使似然值最大化的拓扑会收敛于真实的拓扑。直观地说，尽管许多第2类位点表现出 $A$–$C$ 匹配，但当综合考虑所有位点模式（包括第1类及其他）以及由长短枝所暗示的总体分布时，该模型会将这些模式归因于在 $((A,B),(C,D))$ 拓扑上两个非姐妹的长分支上发生趋同事件的概率，高于将其归因于在 $((A,C),(B,D))$ 拓扑上共享祖先的概率。因此，ML 法会降低长分支之间同塑性匹配的权重，并恢复出正确的分组。\n\n因此，最大简约法将偏好 $((A,C),(B,D))$，而使用恰当的分支异质性模型的最大似然法将偏好 $((A,B),(C,D))$。", "answer": "$$\\boxed{A}$$", "id": "1946247"}, {"introduction": "系统发育树的枝长（branch length）并非抽象概念，而是根据序列间的差异直接计算得出的演化距离。此练习将引导您完成一个具体的计算，量化一个常见的序列比对错误——将一个非同源但表面相似的序列片段错误地比对——如何影响枝长的估计。通过这个实践，您可以亲身体会到输入数据的质量对系统发育分析结果准确性的关键影响。[@problem_id:1946190]", "problem": "一位进化生物学家正在使用一个总长度为 $L=2500$ 碱基对 (bp) 的基因序列，为三个物种（A、B 和 C）构建一个系统发育树。公认的进化关系是，物种 B 和 C 是姐妹群，A 是外群。该分析方法涉及估算每对物种之间的进化距离，然后计算无根树的外部支的长度。\n\n任意两条序列之间的进化距离 $v$（定义为每个位点的期望替换数）是根据差异位点比例 $p$，使用 Jukes-Cantor (JC69) 模型估算得出的：\n$$v = -\\frac{3}{4} \\ln(1 - \\frac{4}{3}p)$$\n其中 $\\ln$ 是自然对数。对于这个三分类单元树，通向物种 C 的外部支的长度，记为 $v_C$，由以下公式给出：\n$$v_C = \\frac{1}{2}(v_{AC} + v_{BC} - v_{AB})$$\n其中 $v_{AB}$、$v_{AC}$ 和 $v_{BC}$ 是物种 A、B 和 C 之间的两两距离。\n\n这三个物种的基因比对大部分是简单明了的。在一个 $2480$ bp 的区域内，观察到的差异数为：$D'_{AB} = 248$，$D'_{AC} = 248$，$D'_{BC} = 124$。然而，一个 $N=20$ bp 的小片段难以进行比对。生物学家考虑了该片段的两种可能的比对情景。\n\n**情景1（正确比对）：** 该比对使用了真实的同源片段。\n- 来自 A 的片段：`AAAAAAAAAAAAAAAAAAAA`\n- 来自 B 的片段：`AAAAAAAAAAAAAAAAAAGG`\n- 来自 C 的片段：`AAAAAAAAAAAAAAAAAAAA`\n\n**情景2（错误比对）：** 由于一个软件错误优先考虑序列相似性而不考虑同源性，来自物种 C 的一个非同源片段被错误地比对。该片段被认为是趋同进化的结果，使其表面上与外群 A 中的序列相似。\n- 来自 A 的片段：`AAAAAAAAAAAAAAAAAAAA`\n- 来自 B 的片段：`AAAAAAAAAAAAAAAAAAGG`\n- 来自 C 的片段：`AAAAAAAAAATTTTTTTTTT`\n\n这个比对错误被怀疑会人为地夸大通向物种 C 的支上估算的进化速率。为了量化这种影响，请计算在正确比对（$v_{C,corr}$）和错误比对（$v_{C,mis}$）下物种 C 的支长。你的任务是计算膨胀因子，其定义为比率 $\\frac{v_{C,mis}}{v_{C,corr}}$。\n\n将你的最终答案四舍五入到三位有效数字。", "solution": "我们使用 JC69 距离估算器 $v= -\\frac{3}{4}\\ln\\!\\bigl(1-\\frac{4}{3}p\\bigr)$ 以及，对于三分类单元无根树，到物种 C 的外部支长度：\n$$\nv_{C}=\\frac{1}{2}\\left(v_{AC}+v_{BC}-v_{AB}\\right).\n$$\n记 $s_{XY}=1-\\frac{4}{3}p_{XY}$，则 $v_{XY}=-\\frac{3}{4}\\ln s_{XY}$。那么\n$$\nv_{C}=\\frac{1}{2}\\left(-\\frac{3}{4}\\ln s_{AC}-\\frac{3}{4}\\ln s_{BC}+\\frac{3}{4}\\ln s_{AB}\\right)\n=-\\frac{3}{8}\\ln\\!\\left(\\frac{s_{AC}s_{BC}}{s_{AB}}\\right).\n$$\n\n来自 $2480$ bp 区域的数据：$D'_{AB}=248$，$D'_{AC}=248$，$D'_{BC}=124$。\n对于 $20$ bp 的片段：\n\n情景1（正确）：\n- 片段差异：$d_{AB}=2$，$d_{AC}=0$，$d_{BC}=2$。\n- 总差异数（在 $L=2500$ 中）：$D_{AB}=250$，$D_{AC}=248$，$D_{BC}=126$。\n- 比例：$p_{AB}=\\frac{250}{2500}=\\frac{1}{10}$，$p_{AC}=\\frac{248}{2500}=\\frac{62}{625}$，$p_{BC}=\\frac{126}{2500}=\\frac{63}{1250}$。\n- 因此\n$$\ns_{AB}=1-\\frac{4}{3}\\cdot\\frac{1}{10}=\\frac{13}{15},\\quad\ns_{AC}=1-\\frac{4}{3}\\cdot\\frac{62}{625}=\\frac{1627}{1875},\\quad\ns_{BC}=1-\\frac{4}{3}\\cdot\\frac{63}{1250}=\\frac{583}{625}.\n$$\n所以\n$$\nv_{C,\\mathrm{corr}}=-\\frac{3}{8}\\ln\\!\\left(\\frac{\\frac{1627}{1875}\\cdot\\frac{583}{625}}{\\frac{13}{15}}\\right)\n=-\\frac{3}{8}\\ln\\!\\left(\\frac{1627\\cdot 583\\cdot 15}{1875\\cdot 625\\cdot 13}\\right)\n=-\\frac{3}{8}\\ln\\!\\left(\\frac{14{,}228{,}115}{15{,}234{,}375}\\right).\n$$\n数值上，$v_{C,\\mathrm{corr}}\\approx 2.56253\\times 10^{-2}$。\n\n情景2（错误比对）：\n- 片段差异：$d_{AB}=2$，$d_{AC}=10$，$d_{BC}=10$。\n- 总差异数：$D_{AB}=250$，$D_{AC}=258$，$D_{BC}=134$。\n- 比例：$p_{AB}=\\frac{1}{10}$，$p_{AC}=\\frac{258}{2500}=\\frac{129}{1250}$，$p_{BC}=\\frac{134}{2500}=\\frac{67}{1250}$。\n- 因此\n$$\ns_{AB}=\\frac{13}{15},\\quad\ns_{AC}=1-\\frac{4}{3}\\cdot\\frac{129}{1250}=\\frac{539}{625},\\quad\ns_{BC}=1-\\frac{4}{3}\\cdot\\frac{67}{1250}=\\frac{1741}{1875}.\n$$\n所以\n$$\nv_{C,\\mathrm{mis}}=-\\frac{3}{8}\\ln\\!\\left(\\frac{\\frac{539}{625}\\cdot\\frac{1741}{1875}}{\\frac{13}{15}}\\right)\n=-\\frac{3}{8}\\ln\\!\\left(\\frac{539\\cdot 1741\\cdot 15}{625\\cdot 1875\\cdot 13}\\right)\n=-\\frac{3}{8}\\ln\\!\\left(\\frac{14{,}075{,}985}{15{,}234{,}375}\\right).\n$$\n数值上，$v_{C,\\mathrm{mis}}\\approx 2.96565\\times 10^{-2}$。\n\n膨胀因子是\n$$\n\\frac{v_{C,\\mathrm{mis}}}{v_{C,\\mathrm{corr}}}\n=\\frac{-\\frac{3}{8}\\ln\\!\\left(\\frac{14{,}075{,}985}{15{,}234{,}375}\\right)}{-\\frac{3}{8}\\ln\\!\\left(\\frac{14{,}228{,}115}{15{,}234{,}375}\\right)}\n=\\frac{\\ln\\!\\left(\\frac{14{,}075{,}985}{15{,}234{,}375}\\right)}{\\ln\\!\\left(\\frac{14{,}228{,}115}{15{,}234{,}375}\\right)}\n\\approx 1.15731.\n$$\n四舍五入到三位有效数字，膨胀因子是 $1.16$。", "answer": "$$\\boxed{1.16}$$", "id": "1946190"}, {"introduction": "通常，一个系统发育树的总似然值概括了整个序列比对对该拓扑结构的支持度，但它可能掩盖了数据内部的冲突信号。这个练习介绍了一种强大的诊断技术：分析每个位点的对数似然值（per-site log-likelihood scores）。您将学习如何通过比较不同拓扑假说下的位点似然值，来精确识别出序列中哪些特定位点是导致系统发育冲突的关键所在。[@problem_id:1946225]", "problem": "一个进化生物学家团队正在研究四种新发现的嗜热细菌的系统发育关系，这些物种被暂时命名为*物种A*、*物种B*、*物种C*和*物种D*。他们从一个与热休克反应有关的关键基因中收集了DNA序列数据，得到了一个包含10个位点的序列比对。使用最大似然法（ML）进行的分析为关于它们进化分支模式的两个相互矛盾的假说提供了高度的统计支持。这两个竞争的树拓扑结构以Newick格式表示如下：\n\n- **假说1：** `((Species A, Species B), (Species C, Species D));`\n- **假说2：** `((Species A, Species C), (Species B, Species D));`\n\n为了解决这一冲突，研究人员计算了在给定两种树拓扑结构的情况下，该序列比对的每个位点的对数似然得分。这些得分代表在给定的树和进化模型下，在单个位点上观测到该数据的对数概率，如下表所示。一个更高（负得更少）的对数似然得分表示该树在那个位点上对数据的拟合更好。\n\n| 位点索引 | 假说1的对数似然 | 假说2的对数似然 |\n|:----------:|:-------------------------------:|:-------------------------------:|\n|      1     |             -3.15             |             -3.15             |\n|      2     |             -4.82             |             -2.91             |\n|      3     |             -3.50             |             -4.95             |\n|      4     |             -5.11             |             -3.04             |\n|      5     |             -2.88             |             -4.76             |\n|      6     |             -5.20             |             -5.15             |\n|      7     |             -4.67             |             -2.55             |\n|      8     |             -3.01             |             -4.89             |\n|      9     |             -5.50             |             -3.23             |\n|     10     |             -3.12             |             -3.18             |\n\n你的任务是找出基因序列中为假说2（相对于假说1）提供强支持的特定位点。如果一个位点对假说2的对数似然得分比其对假说1的对数似然得分大至少1.8，则认为该位点为假说2提供了“强支持”。\n\n以下哪组位点索引代表了所有为假说2提供强支持的位点？\n\nA. 位点 3, 5, 8\n\nB. 位点 2, 4, 7\n\nC. 位点 2, 4, 7, 9\n\nD. 位点 2, 7, 9\n\nE. 位点 2, 4, 6, 7, 9\n\nF. 位点 4", "solution": "对于每个位点索引$i$，将支持假说2的对数似然差异定义为 $\\Delta_{i}=\\ell_{2,i}-\\ell_{1,i}$，其中 $\\ell_{2,i}$ 和 $\\ell_{1,i}$ 分别是假说2和假说1下的每个位点的对数似然值。一个位点为假说2提供强支持，当且仅当 $\\Delta_{i}\\geq 1.8$。\n\n使用表格计算每个位点的 $\\Delta_{i}$：\n位点 $1$: $\\Delta_{1}=(-3.15)-(-3.15)=0.00<1.8$。\n位点 $2$: $\\Delta_{2}=(-2.91)-(-4.82)=1.91\\geq 1.8$。\n位点 $3$: $\\Delta_{3}=(-4.95)-(-3.50)=-1.45<1.8$。\n位点 $4$: $\\Delta_{4}=(-3.04)-(-5.11)=2.07\\geq 1.8$。\n位点 $5$: $\\Delta_{5}=(-4.76)-(-2.88)=-1.88<1.8$。\n位点 $6$: $\\Delta_{6}=(-5.15)-(-5.20)=0.05<1.8$。\n位点 $7$: $\\Delta_{7}=(-2.55)-(-4.67)=2.12\\geq 1.8$。\n位点 $8$: $\\Delta_{8}=(-4.89)-(-3.01)=-1.88<1.8$。\n位点 $9$: $\\Delta_{9}=(-3.23)-(-5.50)=2.27\\geq 1.8$。\n位点 $10$: $\\Delta_{10}=(-3.18)-(-3.12)=-0.06<1.8$。\n\n因此，$\\Delta_{i}\\geq 1.8$ 的位点是 $2,4,7,9$，这对应于选项C。", "answer": "$$\\boxed{C}$$", "id": "1946225"}]}