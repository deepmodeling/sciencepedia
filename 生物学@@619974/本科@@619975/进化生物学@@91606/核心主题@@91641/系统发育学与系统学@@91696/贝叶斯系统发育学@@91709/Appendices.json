{"hands_on_practices": [{"introduction": "贝叶斯系统发育分析的输出不是单个“正确”的树，而是从后验概率分布中抽样得到的大量树的集合。对任何特定分支（进化枝）的支持度，可以通过它在这个样本集合中出现的频率来直接估计。这个练习让你通过一个简单的计算，亲手实践这一核心概念，巩固你对后验概率的理解。[@problem_id:1911287]", "problem": "一位进化生物学家正在研究三种新发现的嗜极古菌（指定为物种A、物种B和物种C）之间的系统发育关系。为推断它们的进化历史，她使用贝叶斯推断框架分析了它们的核糖体RNA基因序列。该分析涉及马尔可夫链蒙特卡洛（MCMC）模拟，该模拟从后验概率分布中对系统发育树进行抽样。\n\n在MCMC模拟收敛后，从后验分布中总共保留了3,000棵树。抽样得到的树拓扑结构总结如下：\n- 物种A和物种B互为最近亲属的拓扑结构，表示为 `((A,B),C)`，出现了2,150次。\n- 物种A和物种C互为最近亲属的拓扑结构，表示为 `((A,C),B)`，出现了600次。\n- 物种B和物种C互为最近亲属的拓扑结构，表示为 `((B,C),A)`，出现了250次。\n\n基于此MCMC样本，包含物种A和物种B但不包含物种C的分支的后验概率是多少？将您的答案表示为四舍五入到三位有效数字的小数。", "solution": "在采用MCMC的贝叶斯系统发育推断中，一个分支的后验概率是通过其在所抽样的后验树集合中的频率来估计的。对于包含物种A和物种B但不包含物种C的分支，该分支仅存在于拓扑结构 `((A,B),C)` 中。MCMC样本在总共 3000 棵树中包含了 2150 个此拓扑结构的实例。因此，估计的后验概率为\n$$\np(\\text{clade }\\{A,B\\})=\\frac{2150}{3000}=\\frac{43}{60}.\n$$\n转换为小数并四舍五入到三位有效数字，\n$$\n\\frac{43}{60}=0.716\\overline{6}\\approx 0.717.\n$$", "answer": "$$\\boxed{0.717}$$", "id": "1911287"}, {"introduction": "马尔可夫链蒙特卡洛（MCMC）模拟需要运行足够长的时间，以充分探索所有可能的树形构成的广阔“树空间”。这个思想实验展示了当运行时间过短时会发生什么：MCMC 链可能会“卡”在不同的局部最优区域，从而导致相互矛盾且不可靠的结果。理解这个问题是进行稳健系统发育分析的第一步。[@problem_id:1911230]", "problem": "生物学家 Dr. Evelyn Reed 正在利用DNA序列研究一组新发现的深海细菌之间的进化关系。她采用了一种被称为贝叶斯系统发育推断的方法。该方法使用一种强大的模拟技术，即马尔可夫链蒙特卡洛（MCMC）算法，来探索所有可能进化树的广阔“空间”。其目标是估计不同物种分组（称为演化支）的后验概率。一个演化支的后验概率是一种统计置信度的度量，表示该组中的物种共享一个共同祖先，且该共同祖先排除了数据集中所有其他物种的概率。\n\nDr. Reed 对她的数据集进行了两次独立的分析。两次运行的进化模型设置和输入数据完全相同。\n\n- **运行 1：** 她运行了 MCMC 模拟，持续时间相对较短，为 50,000 代。结果表明，物种A和物种B形成一个演化支，其后验概率为0.99。\n\n- **运行 2：** 她进行了第二次独立的 MCMC 模拟，同样持续 50,000 代。这次运行得到了一个截然不同的结果：它表明物种B和物种C形成一个演化支，后验概率为0.97，而 (A, B) 演化支的后验概率现在仅为0.05。\n\n假设她的数据文件中没有软件缺陷或错误，以下哪个陈述为这两次短时 MCMC 运行之间出现矛盾结果提供了最可能的解释？\n\nA. 贝叶斯推断是一种内在不可复现的方法，无论运行时间多长，不同的分析总是会产生根本不同的结果。\nB. Dr. Reed 选择的进化模型对于这类细菌来说根本不正确，导致算法在每次运行时都产生任意、随机的输出。\nC. 两次运行中的 MCMC 链都太短，未能达到收敛。它们很可能陷入了树空间中不同的“局部最优”（相对好但非全局最优的树所在的区域），导致对后验分布的估计不准确且相互矛盾。\nD. 由于高频率的水平基因转移，演化支的概念对于细菌不具有生物学意义，这使得整个系统发育分析无效，并导致不稳定的结果。\nE. 两次运行中的一次肯定经历了随机硬件故障，例如计算机内存中的比特翻转，从而损坏了那次特定的分析。", "solution": "贝叶斯系统发育推断的目标是树的后验分布，记为 $p(T \\mid D, M)$，其中 $T$ 是树，$D$ 是序列数据，$M$ 是进化模型。一个演化支 $c$ 的后验概率是\n$$\np(c \\mid D, M) \\equiv \\sum_{T} p(T \\mid D, M) I_{c}(T),\n$$\n其中，如果演化支 $c$ 出现在树 $T$ 中，则 $I_{c}(T)=1$，否则 $I_{c}(T)=0$。\n\n在实践中，一个MCMC采样器会生成一个马尔可夫链 $\\{T_{t}\\}_{t=1}^{N}$，其目标是使其具有平稳分布 $p(T \\mid D, M)$。对于一个大小为 $N$ 的老化期后样本，演化支后验概率的经验估计量是\n$$\n\\hat{p}_{N}(c) = \\frac{1}{N} \\sum_{t=1}^{N} I_{c}(T_{t}).\n$$\n在标准的遍历性条件下，并在所有后验模式间经过充分混合并收敛到平稳分布后，大数定律意味着\n$$\n\\hat{p}_{N}(c) \\xrightarrow[N \\to \\infty]{\\text{a.s.}} p(c \\mid D, M).\n$$\n然而，如果马尔可夫链没有收敛到平稳分布或混合不充分（例如，它仍局限于树空间的一个子集），那么样本 $\\{T_{t}\\}$ 就不能代表 $p(T \\mid D, M)$。在这种情况下，经验频率 $\\hat{p}_{N}(c)$ 实际上是在估计一个局限于链所探索的区域 $\\mathcal{R}_{i}$ 的条件分布：\n$$\n\\hat{p}_{N}(c) \\approx \\sum_{T \\in \\mathcal{R}_{i}} p(T \\mid T \\in \\mathcal{R}_{i}, D, M) I_{c}(T),\n$$\n而不是全局后验分布 $p(T \\mid D, M)$。如果后验分布是多峰的，不同的独立短时运行可能会局限于不同的高后验概率区域 $\\mathcal{R}_{1}$ 和 $\\mathcal{R}_{2}$（在树空间中通常非正式地称为局部最优）。这会产生高但相互矛盾的经验演化支概率，例如一次运行中 $\\hat{p}_{N}(A,B) \\approx 0.99$，而另一次运行中 $\\hat{p}_{N}(B,C) \\approx 0.97$ 且 $\\hat{p}_{N}(A,B) \\approx 0.05$，尽管真实的 $p(c \\mid D, M)$ 是唯一的。\n\n因此，最可能的解释是，两次 $N=50,000$ 代的运行都太短，未能达到收敛和充分混合，导致每条链从不同的后验模式中采样，并产生了误导性的、相互不一致的演化支后验概率估计。\n\n其他选项的可能性较小：在收敛且混合良好的链的极限情况下，贝叶斯推断是可复现的（与A矛盾）；一个指定错误的模型（B）可能导致后验概率有偏差，但通常不会导致独立的短时运行产生截然相反的高置信度演化支，除非与不收敛问题复合作用；像水平基因转移（D）这样的生物学复杂性可能会影响树模型的适宜性，但不能像不收敛那样直接地从机理上解释两次相同的短时 MCMC 运行之间的具体矛盾；相对于众所周知的 MCMC 收敛问题，随机硬件故障（E）是一个极不可能的解释。\n\n因此，正确的选择是，马尔可夫链太短，陷入了树空间的不同区域，从而导致了相互矛盾的后验估计。", "answer": "$$\\boxed{C}$$", "id": "1911230"}, {"introduction": "接续前一个练习提出的问题，本实践旨在回答一个关键问题：“我们如何判断 MCMC 运行是否已经收敛？” 这个练习将向你介绍一种标准且强大的图形化诊断方法——比较两次独立运行中各进化枝后验概率的散点图。通过这个练习，你将学会如何直观地评估贝叶斯推断结果的可靠性与可重复性。[@problem_id:1911269]", "problem": "一位进化生物学家正在研究一组新发现的嗜极细菌的系统发育关系。为此，他们收集了DNA序列数据，并采用贝叶斯推断方法。该分析涉及一种称为马尔可夫链蒙特卡罗（MCMC）模拟的计算方法，用以探索广阔的可能系统发育树空间及其相关参数。为确保结果的稳健性，该生物学家从不同的随机树开始，进行了两次完全独立的MCMC模拟。每次模拟都会生成大量的树样本，从中可以估计出每个不同分支（由一个祖先及其所有后代组成的群体）的后验概率。\n\n在合并两次模拟的结果以得出关于细菌关系的最终结论之前，该生物学家必须验证两次模拟是否已经收敛到相同的后验分布。如果未能收敛，则表明MCMC搜索不完整，其结果不可靠。\n\n以下哪种图形化方法最直接、最全面地评估了两次独立模拟中所有分支的后验概率估计值是否一致？\n\nA. 绘制两次模拟中每一次的似然得分对数与迭代次数的关系图，并目视检查两条曲线是否都达到了稳定平台期。\nB. 对两次模拟合并后的树的后验分布中采样的分支长度，创建一个单一的直方图。\nC. 生成一个散点图，其中每个点对应一个特定的分支，其x坐标为第一次模拟得出的后验概率，y坐标为第二次模拟得出的后验概率。\nD. 分别为每次模拟构建一致树，并检查它们的拓扑结构是否相同。", "solution": "我们需要寻找一种图形化方法，能够直接且全面地评估两次独立的MCMC模拟中所有分支的后验概率估计值是否一致。设两次模拟中观察到的所有不同分支的集合由 $i$ 索引，并设 $p_{i}^{(1)}$ 和 $p_{i}^{(2)}$ 分别表示分支 $i$ 在模拟1和模拟2中估计的后验概率。在两次模拟产生相同后验分布的意义上，收敛意味着对于所有的 $i$ 都有 $p_{i}^{(1)} \\approx p_{i}^{(2)}$。一种绘制配对 $\\left(p_{i}^{(1)},p_{i}^{(2)}\\right)$ 的图形化方法能直接检验这种相等性；如果两次模拟对所有分支都达成一致，那么这些点应该落在直线 $y=x$ 附近，任何偏离都会立即揭示不一致性。\n\n评估各个选项：\n- 选项A（似然得分对数与迭代次数的轨迹图）：一个稳定的平台期表明每条链内部表现出平稳性，但相等或稳定的似然值并不能保证两次模拟在树空间上采样了相同的后验分布，也不能保证分支的后验概率相匹配。对于分支层面的一致性评估，该方法是间接且不全面的。\n- 选项B（合并的分支长度的单一直方图）：合并模拟结果会掩盖模拟间的差异，并且没有解决分支后验概率的问题。它既不是跨模拟的比较，也不是以分支为中心的。\n- 选项C（两次模拟的分支后验概率的散点图）：对于每个分支 $i$，绘制 $\\left(p_{i}^{(1)},p_{i}^{(2)}\\right)$ 可以直接评估所有分支的一致性。靠近 $y=x$ 的点表示一致性；离群点则识别出存在差异的特定分支。仅在一次模拟中出现的分支可以在另一次模拟中用零表示，从而保持了全面性。\n- 选项D（比较一致树拓扑结构）：即使许多分支的概率存在显著差异，也可能出现相同的一致树拓扑结构，因为一致树设定了支持度的阈值并舍弃了定量的差异。这种方法不够敏感，也不够全面。\n\n因此，跨模拟的分支后验概率散点图（选项C）提供了最直接、最全面的一致性评估。", "answer": "$$\\boxed{C}$$", "id": "1911269"}]}