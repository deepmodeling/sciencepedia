{"hands_on_practices": [{"introduction": "当不同的数据集（例如形态学数据和分子序列）指向不同的演化历史时，我们如何客观地衡量它们之间的分歧程度？本练习将介绍鲁宾逊-福尔兹（Robinson-Foulds, RF）距离，这是一种量化两个系统发育树拓扑结构差异的基本指标。通过计算这一距离，你将学会将树分解为其核心构件——二分划分（bipartitions），并亲身体验如何衡量系统发育中的冲突 [@problem_id:1976067]。", "problem": "一位进化生物学家为一组六个假设的昆虫物种（标记为 A、B、C、D、E 和 F）构建了两棵系统发育树。第一棵树基于形态特征，而第二棵树基于一组同源基因序列。这些无根树的拓扑结构以 Newick 格式表示如下：\n\n基于形态学的树：`((A,B),(C,(D,(E,F))));`\n基于分子的树：`(((A,F),B),C,(D,E));`\n\n该生物学家希望使用对称差异距离（也称为 Robinson-Foulds (RF)距离）来量化这两种进化关系假说之间的冲突。该距离通过比较每棵树所蕴含的二分划分（也称作分支）集合来计算。二分划分是通过概念上“切割”树的任意内部枝而形成的，这将末端分类单元的集合划分为两个非空且不相交的子集。RF 距离是存在于一棵树中但不存在于另一棵树中的非平凡二分划分的总数。一个非平凡二分划分是指其两个子集均至少包含两个分类单元的划分。\n\n计算基于形态学的树和基于分子的树之间的 Robinson-Foulds 距离。", "solution": "令分类单元集合为 $X=\\{A,B,C,D,E,F\\}$。对于一个包含 $|X|=6$ 个分类单元的无根完全解析（二叉）树，非平凡二分划分（内部边）的数量为 $|X|-3=3$。Robinson-Foulds 距离是两棵树的分支集合的对称差的大小：\n$$\nd_{\\mathrm{RF}}(T_{1},T_{2})=\\left|S(T_{1})\\triangle S(T_{2})\\right|=\\left|S(T_{1})\\right|+\\left|S(T_{2})\\right|-2\\left|S(T_{1})\\cap S(T_{2})\\right|.\n$$\n\n通过切割内部边来识别每棵树的三个非平凡二分划分。\n\n对于基于形态学的树 $((A,B),(C,(D,(E,F))));$，其内部边产生以下划分：\n$$\nS_{\\mathrm{morph}}=\\Big\\{\\{A,B\\}\\mid\\{C,D,E,F\\},\\ \\{E,F\\}\\mid\\{A,B,C,D\\},\\ \\{D,E,F\\}\\mid\\{A,B,C\\}\\Big\\}.\n$$\n\n对于基于分子的树 $(((A,F),B),C,(D,E));$，其内部边产生以下划分：\n$$\nS_{\\mathrm{mol}}=\\Big\\{\\{D,E\\}\\mid\\{A,B,C,F\\},\\ \\{A,B,F\\}\\mid\\{C,D,E\\},\\ \\{A,F\\}\\mid\\{B,C,D,E\\}\\Big\\}.\n$$\n\n将二分划分视为无序的（即每个划分都等于其补集），$S_{\\mathrm{morph}}$ 中的三个划分均不与 $S_{\\mathrm{mol}}$ 中的任何划分匹配，因此\n$$\n\\left|S_{\\mathrm{morph}}\\cap S_{\\mathrm{mol}}\\right|=0.\n$$\n因此，\n$$\nd_{\\mathrm{RF}}=\\left|S_{\\mathrm{morph}}\\right|+\\left|S_{\\mathrm{mol}}\\right|-2\\cdot 0=3+3=6.\n$$", "answer": "$$\\boxed{6}$$", "id": "1976067"}, {"introduction": "演化生物学家常常需要综合来自多个小型系统发育研究的信息，而这些研究可能只包含了部分感兴趣的物种。本练习模拟了构建“超树”（supertree）时面临的挑战，要求你评估两个候选超树中哪一个能更好地代表多个源树所提出的亲缘关系。通过计算“拓扑冲突分数”（Topological Conflict Score），你将练习识别分支（clades）并评估一个更宏大的演化假说与现有系统发育证据的兼容程度 [@problem_id:1976071]。", "problem": "一位系统分类学家正在研究一个包含六种昆虫（标记为 A、B、C、D、X 和 Y）的进化枝内的进化关系。该分析基于先前为这些物种的子集发表的四个较小的源系统发育树 S1、S2、S3 和 S4。这些源树的拓扑结构使用括号（Newick）表示法在下面给出，其中一对 `(t1, t2)` 表示物种 t1 和 t2 是姐妹分类单元。\n\n-   **S1**: (A, (B, C))\n-   **S2**: (C, (D, X))\n-   **S3**: (B, (D, Y))\n-   **S4**: (X, Y)\n\n由于这些源树之间存在冲突信号，不同的超树构建算法产生了不一致的结果。为了评估潜在的解决方案，该系统分类学家为全部六个物种提出了两个候选超树 T_alpha 和 T_beta：\n\n-   **T_alpha**: (A, (B, (C, (D, (X, Y)))))\n-   **T_beta**: (D, ((A, (B, C)), (X, Y)))\n\n为了量化每个候选超树对源数据的容纳程度，定义了一个名为拓扑冲突得分（Topological Conflict Score, TCS）的指标。给定候选超树的 TCS 是源系统发育树中，在该候选超树中**不**被表示为单系群的进化枝的总数。如果一个类群包含一个共同祖先及其所有后代，则该类群被认为是单系的。\n\n计算 T_alpha 和 T_beta 的拓扑冲突得分。以下哪个选项正确报告了得分对 (TCS_alpha, TCS_beta)？\n\nA. (2, 2)\n\nB. (3, 2)\n\nC. (2, 3)\n\nD. (3, 3)\n\nE. (4, 2)", "solution": "题目要求我们计算两个候选超树 T_alpha 和 T_beta 的拓扑冲突得分（TCS）。TCS 是源树中那些在候选树中非单系的进化枝的数量。\n\n首先，让我们明确地识别出四个源树所包含的进化枝。进化枝是树中由一个共同祖先及其所有后代组成的任何群体。在Newick格式 `(t1, t2)` 中，群体 `{t1, t2}` 形成一个进化枝。在 `(t3, (t1, t2))` 中，`{t1, t2}` 和 `{t1, t2, t3}` 都是进化枝。对于这个问题，我们只考虑每个源树所断言的最小非平凡进化枝。\n\n-   从 **S1: (A, (B, C))**，断言的进化枝是 `{B, C}`。\n-   从 **S2: (C, (D, X))**，断言的进化枝是 `{D, X}`。\n-   从 **S3: (B, (D, Y))**，断言的进化枝是 `{D, Y}`。\n-   从 **S4: (X, Y)**，断言的进化枝是 `{X, Y}`。\n\n所以我们需要检查四个源进化枝：`{B, C}`、`{D, X}`、`{D, Y}` 和 `{X, Y}`。\n\n接下来，我们评估 T_alpha: `(A, (B, (C, (D, (X, Y)))))`。我们将检查每个源进化枝在该树中是否是单系的。\n\n1.  **`{B, C}` 在 T_alpha 中是单系群吗？**\n    在 T_alpha 中，B 和 C 的最近共同祖先（MRCA）的节点也包括 D、X 和 Y 作为后代。这个祖先的全部后代集合是 `{B, C, D, X, Y}`。由于这个集合不等于 `{B, C}`，该群体不是单系的（它是并系的）。这是一个冲突。**冲突计数 = 1。**\n\n2.  **`{D, X}` 在 T_alpha 中是单系群吗？**\n    D 和 X 的 MRCA 的节点也包括 Y。这个祖先的后代是 `{D, X, Y}`。这不等于 `{D, X}`。该群体不是单系的。这是一个冲突。**冲突计数 = 2。**\n\n3.  **`{D, Y}` 在 T_alpha 中是单系群吗？**\n    D 和 Y 的 MRCA 的节点也包括 X。这个祖先的后代是 `{D, X, Y}`。这不等于 `{D, Y}`。该群体不是单系的。这是一个冲突。**冲突计数 = 3。**\n\n4.  **`{X, Y}` 在 T_alpha 中是单系群吗？**\n    X 和 Y 的 MRCA 只有 X 和 Y 作为其后代。因此，群体 `{X, Y}` 在 T_alpha 中是单系的。这不是一个冲突。\n\nT_alpha 的总拓扑冲突得分是 `TCS_alpha = 1 + 1 + 1 + 0 = 3`。\n\n现在，我们评估 T_beta: `(D, ((A, (B, C)), (X, Y)))`。\n\n1.  **`{B, C}` 在 T_beta 中是单系群吗？**\n    B 和 C 的 MRCA 只有 B 和 C 作为其后代。群体 `{B, C}` 是单系的。这不是一个冲突。**冲突计数 = 0。**\n\n2.  **`{D, X}` 在 T_beta 中是单系群吗？**\n    D 和 X 的 MRCA 是整棵树的根。其后代是 `{D, A, B, C, X, Y}`。这不等于 `{D, X}`。该群体不是单系的（它是多系的）。这是一个冲突。**冲突计数 = 1。**\n\n3.  **`{D, Y}` 在 T_beta 中是单系群吗？**\n    D 和 Y 的 MRCA 也是整棵树的根。其后代是 `{D, A, B, C, X, Y}`。这不等于 `{D, Y}`。该群体不是单系的。这是一个冲突。**冲突计数 = 2。**\n\n4.  **`{X, Y}` 在 T_beta 中是单系群吗？**\n    X 和 Y 的 MRCA 只有 X 和 Y 作为其后代。群体 `{X, Y}` 是单系的。这不是一个冲突。\n\nT_beta 的总拓扑冲突得分是 `TCS_beta = 0 + 1 + 1 + 0 = 2`。\n\n得分对 (TCS_alpha, TCS_beta) = (3, 2)。这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1976071"}, {"introduction": "在系统发育基因组学时代，压倒性的统计支持（如100%的自展支持率）有时可能具有误导性，其背后可能只是一小部分但影响力极大的基因组数据的驱动。这项高级练习挑战你深入探究一个强支持节点的“引擎盖之下”，使用指标来区分广泛一致的信号和集中的、可能是人为假象的信号。你将计算一个“系统发育信号强度”比率，以诊断一个假设数据集中支持度的本质，这是现代演化分析中的一项关键技能 [@problem_id:1976074]。", "problem": "在系统发育基因组学领域，对许多基因的串联分析有时可以产生一个物种树，其节点具有100%的自举支持率，这表明了完全的确定性。然而，这种高支持率有时可能是一种假象，即少数具有非常强且一致信号的基因压倒了基因组大部分区域存在的更为复杂和冲突的信号。\n\n一个研究团队正在使用一个包含1000个遗传位点的数据集，研究四个分类单元（A, B, C, D）之间的关系。标准的串联最大似然分析得出了拓扑结构 $T_1 = ((A,B),(C,D))$，其中将(A,B)演化支与(C,D)演化支分开的中心二分获得了100%的自举支持率。为了探究这种强支持率的来源，研究人员根据估计的进化速率，将这1000个位点划分为两个集合：一个“快速进化”集和一个“缓慢进化”集。然后，他们分析了这四个分类单元三种可能的二分拓扑结构的支持情况：$T_1 = ((A,B),(C,D))$，$T_2 = ((A,C),(B,D))$ 和 $T_3 = ((A,D),(B,C))$。\n\n他们的分析数据总结如下：\n\n**集合 F (快速进化的位点):**\n- 位点总数: 20\n- 比对位点总数: 50,000\n- 支持 $T_1$ 的基因树数量: 19\n- 支持 $T_2$ 的基因树数量: 1\n- 支持 $T_3$ 的基因树数量: 0\n- 支持 $T_1$ 的位点数量: 45,000\n- 支持 $T_2$ 的位点数量: 3,000\n- 支持 $T_3$ 的位点数量: 2,000\n\n**集合 S (缓慢进化的位点):**\n- 位点总数: 980\n- 比对位点总数: 1,200,000\n- 支持 $T_1$ 的基因树数量: 382\n- 支持 $T_2$ 的基因树数量: 343\n- 支持 $T_3$ 的基因树数量: 255\n- 支持 $T_1$ 的位点数量: 400,000\n- 支持 $T_2$ 的位点数量: 420,000\n- 支持 $T_3$ 的位点数量: 380,000\n\n为了量化单个基因的影响，该团队定义了一个名为系统发育信号强度（Phylogenetic Signal Strength, PSS）的指标。对于给定的位点集和特定的拓扑结构 $T_i$，PSS被定义为支持 $T_i$ 的比对位点总数与支持 $T_i$ 的基因树总数的比值。\n$$ \\text{PSS}(\\text{Set}, T_i) = \\frac{\\text{Number of sites in Set supporting } T_i}{\\text{Number of gene trees in Set supporting } T_i} $$\n计算快速进化集中主要拓扑结构 $T_1$ 的PSS与缓慢进化集中相同拓扑结构 $T_1$ 的PSS之比。该比值 $R = \\frac{\\text{PSS}(\\text{Set F}, T_1)}{\\text{PSS}(\\text{Set S}, T_1)}$，衡量了与缓慢进化集相比，快速进化集中一个典型的支持基因对 $T_1$ 的系统发育信号要强多少。\n\n将您的最终答案四舍五入到三位有效数字。", "solution": "我们已知对于一个集合和拓扑结构 $T_{i}$，其系统发育信号强度（PSS）指标为\n$$\n\\text{PSS}(\\text{Set}, T_{i}) = \\frac{\\text{Number of sites in Set supporting } T_{i}}{\\text{Number of gene trees in Set supporting } T_{i}}.\n$$\n对于集合 F（快速进化）中的拓扑结构 $T_{1}$，支持的位点数为 $45000$，支持的基因树数量为 $19$，因此\n$$\n\\text{PSS}(\\text{Set F}, T_{1}) = \\frac{45000}{19}.\n$$\n对于集合 S（缓慢进化）中的拓扑结构 $T_{1}$，支持的位点数为 $400000$，支持的基因树数量为 $382$，因此\n$$\n\\text{PSS}(\\text{Set S}, T_{1}) = \\frac{400000}{382}.\n$$\n所求的比值为\n$$\nR = \\frac{\\text{PSS}(\\text{Set F}, T_{1})}{\\text{PSS}(\\text{Set S}, T_{1})} = \\frac{\\frac{45000}{19}}{\\frac{400000}{382}} = \\frac{45000}{19}\\cdot\\frac{382}{400000} = \\frac{45000\\cdot 382}{19\\cdot 400000}.\n$$\n将分子和分母同除以 $1000$ 进行化简：\n$$\nR = \\frac{45\\cdot 382}{19\\cdot 400}.\n$$\n将 $382$ 分解为 $2\\cdot 191$，并与 $400$ 约掉公因数 $2$：\n$$\nR = \\frac{45\\cdot 191}{19\\cdot 200} = \\frac{8595}{3800} = \\frac{1719}{760}.\n$$\n计算小数值并四舍五入到三位有效数字：\n$$\nR \\approx 2.261842\\dots \\approx 2.26 \\text{ (三位有效数字)}.\n$$", "answer": "$$\\boxed{2.26}$$", "id": "1976074"}]}