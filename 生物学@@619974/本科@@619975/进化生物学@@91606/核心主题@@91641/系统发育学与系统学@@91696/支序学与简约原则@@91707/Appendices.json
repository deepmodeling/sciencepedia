{"hands_on_practices": [{"introduction": "为了重建进化历史，我们必须首先学会从数据中区分有意义的信号和噪音。本练习侧重于一个基本概念：简约性信息位点(parsimony-informative site)。你将学习如何从基因比对中识别出哪些性状位点能为支持某个系统发育树而非其他树提供必要的证据，这是任何简约性分析中至关重要的第一步。[@problem_id:1769429]", "problem": "一位生物学家正在研究四种穴居昆虫（分别命名为物种W、X、Y和Z）之间的进化关系。为了构建系统发育树，她对一个核基因的同源片段进行了序列比对。前五个变异位点的脱氧核糖核酸（DNA）序列比对结果如下所示。\n\n```\n              位点\n分类单元      1 2 3 4 5\n-----------------------\n物种 W:       G A T G C\n物种 X:       G C C T C\n物种 Y:       G A T A T\n物种 Z:       G A C G C\n```\n\n在采用最大简约法原则的系统发育分析中，一个性状位点只有在它能为部分分类单元的分组（并排除其他分类单元）提供证据时，才被认为是简约信息位点。根据这一原则，请确定以下哪个核苷酸位点是简约信息位点。\n\nA. 位点 1\n\nB. 位点 2\n\nC. 位点 3\n\nD. 位点 4\n\nE. 位点 5", "solution": "在最大简约法中，如果一个位点上至少有两种不同的核苷酸，且每种都至少出现在两个分类单元中，那么该位点就是简约信息位点。等价地说，在一个四分类单元的比对中，信息模式是两种核苷酸呈 $2{:}2$ 的分布；$3{:}1$ 模式或恒定不变的模式则不是信息位点。\n\n逐一评估每个位点，计算核苷酸在物种 W、X、Y 和 Z 中出现的次数：\n\n- 位点 1：W = G, X = G, Y = G, Z = G。计数：$G:4$。恒定；非信息位点。\n- 位点 2：W = A, X = C, Y = A, Z = A。计数：$A:3, C:1$。属于 $3{:}1$ 模式；非信息位点。\n- 位点 3：W = T, X = C, Y = T, Z = C。计数：$T:2, C:2$。属于 $2{:}2$ 模式，有两种状态且每种至少出现两次；是简约信息位点。\n- 位点 4：W = G, X = T, Y = A, Z = G。计数：$G:2, T:1, A:1$。只有一种状态出现两次；非信息位点。\n- 位点 5：W = C, X = C, Y = T, Z = C。计数：$C:3, T:1$。属于 $3{:}1$ 模式；非信息位点。\n\n因此，只有位点 3 是简约信息位点，对应于选项 C。", "answer": "$$\\boxed{C}$$", "id": "1769429"}, {"introduction": "当我们有了一个关于进化关系的假说——以分支图的形式呈现时——我们如何用数据来检验其有效性？简约性原则提供了一个明确的标准：最好的树是需要最少进化改变的树。本练习将引导你计算一个给定树的总“简约性得分”(parsimony score)，这是比较和评估竞争性系统发育假说的一项基本技能。[@problem_id:1914297]", "problem": "一位演化生物学家正在研究三种新发现的嗜极细菌物种（指定为物种A、物种B和物种C）之间的关系。一个相关的、已被充分了解的物种 *Thermus outgroupus* 被用作外群来为系统发育树定根。该生物学家收集了三个二元遗传性状的数据。对于每个性状，状态“0”是祖先状态（在 *T. outgroupus* 中观察到），状态“1”是衍生状态。数据总结在下表中：\n\n| 分类单元            | 性状 1 (细胞壁脂质) | 性状 2 (热休克基因) | 性状 3 (鞭毛蛋白) |\n|---------------------|-------------------------------|-------------------------------|---------------------------------|\n| *T. outgroupus*     | 0                             | 0                             | 0                               |\n| *物种 A*         | 0                             | 1                             | 1                               |\n| *物种 B*         | 1                             | 1                             | 0                               |\n| *物种 C*         | 1                             | 1                             | 1                               |\n\n一位同事提出了一个系统发育假说，其中物种C是包含物种A和物种B的支系（clade）的姐妹群（sister taxon）。使用标准的括号表示法，并包括外群，这种关系表示为 `(T. outgroupus, (物种C, (物种A, 物种B)))`。\n\n您的任务是使用简约性原则（principle of parsimony）来评估这一特定假说。计算将所有三个性状映射到这个提出的分支图（cladogram）上所需的演化性状状态变化的最小总数（也称为树长或简约性得分）。以单个整数形式提供您的答案。", "solution": "我们在提出的有根拓扑结构 $(\\textit{T. outgroupus},(\\text{物种C},(\\text{物种A},\\text{物种B})))$ 上应用简约性（Fitch）算法。设 $Y$ 是连接物种A和物种B的节点，$X$ 是连接物种C与 $Y$ 的节点，$R$ 是连接 $\\textit{T. outgroupus}$ 与 $X$ 的根节点。在每个内部节点，如果子节点的状态集合相交，我们取其交集并增加 $0$ 步；如果它们不相交，我们取其并集并增加 $1$ 步。叶节点集合是观察到的状态 $\\{0\\}$ 或 $\\{1\\}$。\n\n性状 1（状态：$\\textit{T. outgroupus}=0$, A$=0$, B$=1$, C$=1$）：\n- 在 $Y$ 节点：$S_{A}=\\{0\\}$，$S_{B}=\\{1\\}$，所以 $S_{Y}=S_{A}\\cap S_{B}=\\varnothing$，因此 $S_{Y}=\\{0,1\\}$ 并增加 $1$ 步。\n- 在 $X$ 节点：$S_{C}=\\{1\\}$，$S_{Y}=\\{0,1\\}$，所以 $S_{X}=S_{C}\\cap S_{Y}=\\{1\\}$ 并增加 $0$ 步。\n- 在 $R$ 节点：$S_{T}=\\{0\\}$，$S_{X}=\\{1\\}$，所以 $S_{R}=S_{T}\\cap S_{X}=\\varnothing$，因此 $S_{R}=\\{0,1\\}$ 并增加 $1$ 步。\n性状 1 的总步数：$2$。\n\n性状 2（状态：$\\textit{T. outgroupus}=0$, A$=1$, B$=1$, C$=1$）：\n- 在 $Y$ 节点：$S_{A}=\\{1\\}$，$S_{B}=\\{1\\}$，所以 $S_{Y}=\\{1\\}$ 并增加 $0$ 步。\n- 在 $X$ 节点：$S_{C}=\\{1\\}$，$S_{Y}=\\{1\\}$，所以 $S_{X}=\\{1\\}$ 并增加 $0$ 步。\n- 在 $R$ 节点：$S_{T}=\\{0\\}$，$S_{X}=\\{1\\}$，交集为空，所以 $S_{R}=\\{0,1\\}$ 并增加 $1$ 步。\n性状 2 的总步数：$1$。\n\n性状 3（状态：$\\textit{T. outgroupus}=0$, A$=1$, B$=0$, C$=1$）：\n- 在 $Y$ 节点：$S_{A}=\\{1\\}$，$S_{B}=\\{0\\}$，所以 $S_{Y}=\\varnothing$，因此 $S_{Y}=\\{0,1\\}$ 并增加 $1$ 步。\n- 在 $X$ 节点：$S_{C}=\\{1\\}$，$S_{Y}=\\{0,1\\}$，所以 $S_{X}=\\{1\\}$ 并增加 $0$ 步。\n- 在 $R$ 节点：$S_{T}=\\{0\\}$，$S_{X}=\\{1\\}$，交集为空，所以 $S_{R}=\\{0,1\\}$ 并增加 $1$ 步。\n性状 3 的总步数：$2$。\n\n将所有三个性状的步数相加，最小总变化数为 $2+1+2=5$。", "answer": "$$\\boxed{5}$$", "id": "1914297"}, {"introduction": "标准的简约性分析假设所有的进化改变都是等同的，但分子生物学告诉我们这并非总是如此。例如，转换（嘌呤到嘌呤的替换，如 $A \\leftrightarrow G$）通常比颠换（嘌呤到嘧啶的替换）更频繁。这个进阶问题介绍了加权简约性(weighted parsimony)，它允许我们融入这种生物学上的现实性。你将应用Sankoff算法，使用一个成本矩阵来计算树的得分，从而洞察更复杂的系统发育方法。[@problem_id:1914244]", "problem": "一位演化生物学家正在研究三种新发现的极端环境古菌的系统发育关系，这三种古菌初步命名为 Alpha 物种、Beta 物种和 Gamma 物种。该分析聚焦于编码一种关键代谢酶的基因内的单个核苷酸位点。根据其他基因组数据构建的系统发育树显示，Alpha 物种和 Beta 物种是姐妹群，而 Gamma 物种是它们的外群。在这三个物种的特定位点上观察到的脱氧核糖核酸（DNA）碱基如下：\n- Alpha 物种：腺嘌呤 (A)\n- Beta 物种：鸟嘌呤 (G)\n- Gamma 物种：胞嘧啶 (C)\n\n为了评估该性状分布在树上的演化代价，使用了一种加权简约法。核苷酸替换的代价取决于它是转换还是颠换。嘌呤是 A 和 G；嘧啶是 C 和 T。转换是两种嘌呤之间（A ↔ G）或两种嘧啶之间的替换。颠换是嘌呤和嘧啶之间的替换。替换代价方案如下：\n- 无变化的代价为 0。\n- 转换的代价为 1。\n- 颠换的代价为 2。\n\n使用 Sankoff 算法（一种用于祖先状态重建的动态规划方法），计算该单个核苷酸位点在整个无根树上的最小总代价（简约分数）。该树可以表示为 `((Alpha, Beta), Gamma)`。您的计算应确定树根处的最小分数。", "solution": "使用 Sankoff 算法，对于每个节点 $v$ 和每个核苷酸状态 $s \\in \\{A,G,C,T\\}$，将 $S_{v}(s)$ 定义为当节点 $v$ 被赋予状态 $s$ 时，其下方子树的最小代价。对于一个观察到状态为 $y$ 的叶节点，$S_{\\text{leaf}}(s)=0$ 如果 $s=y$，否则在最小化过程中被支配；对于一个拥有子节点 $u_{1}$ 和 $u_{2}$ 的内部节点 $v$，其递推关系为\n$$\nS_{v}(s)=\\sum_{i=1}^{2}\\min_{t\\in\\{A,G,C,T\\}}\\left[S_{u_{i}}(t)+w(s,t)\\right],\n$$\n其中，如果 $x=y$，$w(x,y)=0$；如果 $x$ 和 $y$ 是一个转换对（在 $\\{A,G\\}$ 内或在 $\\{C,T\\}$ 内），则 $w(x,y)=1$；在其他情况下（颠换），$w(x,y)=2$。\n\n设树的根节点为连接 $((\\text{Alpha},\\text{Beta}),\\text{Gamma})$ 的内部节点。首先计算连接 Alpha（状态 $A$）和 Beta（状态 $G$）的内部节点 $u$ 处的代价向量。由于叶节点是固定的，对于任何 $s$：\n$$\nS_{u}(s)=w(s,A)+w(s,G).\n$$\n对每个 $s$ 进行评估：\n$$\nS_{u}(A)=w(A,A)+w(A,G)=0+1=1,\\quad S_{u}(G)=w(G,A)+w(G,G)=1+0=1,\n$$\n$$\nS_{u}(C)=w(C,A)+w(C,G)=2+2=4,\\quad S_{u}(T)=w(T,A)+w(T,G)=2+2=4.\n$$\n\n现在，在根节点 $v$ 处将 $u$ 与 Gamma（状态 $C$）结合。对于每个 $s$：\n$$\nS_{v}(s)=\\min_{t\\in\\{A,G,C,T\\}}\\left[S_{u}(t)+w(s,t)\\right]+w(s,C).\n$$\n计算每个 $S_{v}(s)$：\n\n1) 对于 $s=A$，\n$$\n\\min_{t}\\left[S_{u}(t)+w(A,t)\\right]=\\min\\{1+0,\\,1+1,\\,4+2,\\,4+2\\}=1,\\quad w(A,C)=2,\n$$\n因此 $S_{v}(A)=1+2=3$。\n\n2) 对于 $s=G$，\n$$\n\\min_{t}\\left[S_{u}(t)+w(G,t)\\right]=\\min\\{1+1,\\,1+0,\\,4+2,\\,4+2\\}=1,\\quad w(G,C)=2,\n$$\n因此 $S_{v}(G)=1+2=3$。\n\n3) 对于 $s=C$，\n$$\n\\min_{t}\\left[S_{u}(t)+w(C,t)\\right]=\\min\\{1+2,\\,1+2,\\,4+0,\\,4+1\\}=3,\\quad w(C,C)=0,\n$$\n因此 $S_{v}(C)=3+0=3$。\n\n4) 对于 $s=T$，\n$$\n\\min_{t}\\left[S_{u}(t)+w(T,t)\\right]=\\min\\{1+2,\\,1+2,\\,4+1,\\,4+0\\}=3,\\quad w(T,C)=1,\n$$\n因此 $S_{v}(T)=3+1=4$。\n\n该位点上无根树的简约分数是所有根状态下的最小值：\n$$\n\\min_{s\\in\\{A,G,C,T\\}}S_{v}(s)=\\min\\{3,3,3,4\\}=3.\n$$", "answer": "$$\\boxed{3}$$", "id": "1914244"}]}