{"hands_on_practices": [{"introduction": "定向选择的速率在很大程度上取决于性状的可遗传性。本练习将引导你使用经典的育种者方程 ($R = h^2S$) 来预测种群对选择压力的响应。通过一个关于气候变化如何影响高山野花的实际案例，你将首先从方差组分中计算窄义遗传力 ($h^2$)，然后预测下一代的平均开花时间 [@problem_id:1918949]。", "problem": "一个生态研究团队正在研究一种高山野花 *Campanula alpina* 对气候变化的进化响应。他们感兴趣的性状是开花时间，以春分后的天数来衡量。在某一年（第0代）研究的一个大种群中，所有个体的平均开花时间为75.0天。然而，由于异常迅速的融雪和随后的夏季干旱，只有在该季节较早开花的植物才能成功繁殖。发现这些成功繁殖个体的平均开花时间为68.0天。\n\n对该种群进行了数量遗传学分析，以了解该性状的遗传方式。该研究确定了开花时间表型方差的以下组成部分：加性遗传方差（$V_A$）为12.0天$^2$，显性遗传方差（$V_D$）为8.0天$^2$，环境方差（$V_E$）为10.0天$^2$。您可以假设由上位性互作引起的方差可以忽略不计。\n\n根据这些数据，预测繁殖植物后代（F1代）的平均开花时间。答案以天为单位表示，并四舍五入至三位有效数字。", "solution": "我们被要求预测选择后后代的平均开花时间。在数量遗传学中，由于选择导致的一代内种群平均值的变化由育种家方程给出：\n$$\nR = h^{2} S,\n$$\n其中$R$是选择响应（亲代到子代平均值的变化），$h^{2}$是狭义遗传力，$S$是选择差，定义为被选择亲本的平均值与原始种群的平均值之差。\n\n首先，计算总表型方差$V_{P}$，假设上位性互作可以忽略不计：\n$$\nV_{P} = V_{A} + V_{D} + V_{E}。\n$$\n根据给定的值，可得\n$$\nV_{P} = 12.0 + 8.0 + 10.0 = 30.0 \\text{ days}^{2}。\n$$\n\n狭义遗传力是\n$$\nh^{2} = \\frac{V_{A}}{V_{P}} = \\frac{12.0}{30.0} = 0.4。\n$$\n\n选择差$S$是\n$$\nS = \\bar{z}_{\\text{selected}} - \\bar{z}_{\\text{original}} = 68.0 - 75.0 = -7.0 \\text{ days}。\n$$\n\n应用育种家方程求选择响应：\n$$\nR = h^{2} S = 0.4 \\times (-7.0) = -2.8 \\text{ days}。\n$$\n\n预测的后代平均值是原始平均值加上选择响应：\n$$\n\\bar{z}_{\\text{offspring}} = \\bar{z}_{\\text{original}} + R = 75.0 + (-2.8) = 72.2 \\text{ days}。\n$$\n\n四舍五入到三位有效数字，得到 $72.2$。", "answer": "$$\\boxed{72.2}$$", "id": "1918949"}, {"introduction": "生物体的演化不仅在于改变其固定的性状，还在于改变其对环境的响应方式，即表型可塑性。本练习将挑战你对表型可塑性本身的演化进行建模，这一过程通过“反应规范”来描述。你将分析在一个植物种群适应新环境梯度时，选择如何塑造其线性反应规范 ($R(W) = a + bW$) 的参数 [@problem_id:1918938]。", "problem": "一个植物物种*Florivaria adaptabilis*的种群在一个新的山坡上定殖。这个山坡具有连续的线性土壤水分有效性（SWA）梯度，该梯度以‘水文单位’量化。这些植物被发现沿着这个梯度均匀分布，其SWA值范围为 $W_{min} = 10$ 水文单位到 $W_{max} = 50$ 水文单位。\n\n为响应水分有效性，这些植物在根冠质量比（一个由$R$表示的无量纲量）上表现出表型可塑性。对于任何给定的基因型，这种可塑性响应是线性的，可以用一个反应规范方程来描述：$R(W) = a + bW$，其中$W$是SWA。参数$a$代表基线根冠比，而$b$是反应规范的斜率，它量化了该性状对SWA变化的敏感度。\n\n为使适应度最大化的最优根冠比，记为$\\theta(W)$，也随SWA线性变化：$\\theta(W) = \\alpha + \\beta W$。在环境$W$中，表型为$R$的个体植物的适应度是其与最优值偏差的高斯函数：$f(R, W) = \\exp\\left(-\\frac{(R - \\theta(W))^2}{2\\gamma^2}\\right)$，其中$\\gamma^2$是一个决定稳定性选择强度的常数。\n\n创始种群到达时，其平均基线比率为$\\bar{a}_0 = 3.5$，平均斜率为$\\bar{b}_0 = 0.0$。最优反应规范由参数$\\alpha = 4.0$和$\\beta = -0.05$ (水文单位)$^{-1}$定义。选择强度由$\\gamma^2 = 10.0$表征。\n\n该种群中反应规范参数（$a, b$）的加性遗传方差-协方差矩阵由下式给出：\n$$\nG = \\begin{pmatrix} G_{aa} & G_{ab} \\\\ G_{ab} & G_{bb} \\end{pmatrix} = \\begin{pmatrix} 0.20 & -0.005 \\\\ -0.005 & 0.001 \\end{pmatrix}\n$$\n其中$G_{aa}$的单位是(无量纲)$^2$，$G_{ab}$的单位是(水文单位)$^{-1}$，$G_{bb}$的单位是(水文单位)$^{-2}$。\n\n假设该种群在这个新环境中经历了一代选择，计算反应规范平均斜率的预测变化量 $\\Delta \\bar{b}$。请用(水文单位)$^{-1}$表示你的答案，并四舍五入到四位有效数字。", "solution": "我们将反应规范建模为 $R(W)=a+bW$，将最优值建模为 $\\theta(W)=\\alpha+\\beta W$。适应度是围绕最优值的高斯稳定性选择：\n$$\nf(R,W)=\\exp\\left(-\\frac{(R-\\theta(W))^{2}}{2\\gamma^{2}}\\right)。\n$$\n使用单代的Lande方程，\n$$\n\\Delta \\bar{\\boldsymbol{z}}=G\\,\\boldsymbol{\\beta},\n$$\n其中 $\\bar{\\boldsymbol{z}}=(\\bar{a},\\bar{b})^{\\top}$ 且 $\\boldsymbol{\\beta}=\\nabla_{\\boldsymbol{z}}\\ln \\bar{w}$ 是选择梯度。在一阶近似下，当环境$W$在$[W_{\\min},W_{\\max}]$上均匀分布时，$\\boldsymbol{\\beta}$的分量可以计算为在当前平均参数下，个体对数适应度导数在$W$上的期望值：\n$$\n\\frac{\\partial \\ln f}{\\partial a}=-\\frac{1}{\\gamma^{2}}(R-\\theta),\\qquad\n\\frac{\\partial \\ln f}{\\partial b}=-\\frac{1}{\\gamma^{2}}(R-\\theta)\\,W。\n$$\n定义在$W$处的不匹配度为\n$$\nD(W)=(a+bW)-(\\alpha+\\beta W)。\n$$\n在当前平均值$(\\bar{a}_{0},\\bar{b}_{0})=(3.5,0.0)$和参数$(\\alpha,\\beta)=(4.0,-0.05)$下，这变为\n$$\nD(W)=(\\bar{a}_{0}-\\alpha)+(\\bar{b}_{0}-\\beta)W=-0.5+0.05\\,W。\n$$\n因此，\n$$\n\\beta_{a}=-\\frac{1}{\\gamma^{2}}\\,\\mathbb{E}[D(W)],\\qquad\n\\beta_{b}=-\\frac{1}{\\gamma^{2}}\\,\\mathbb{E}[W\\,D(W)],\n$$\n其中$W$在$[10,50]$上均匀分布。使用\n$$\n\\mathbb{E}[W]=\\frac{W_{\\min}+W_{\\max}}{2}=30,\\qquad\n\\mathbb{E}[W^{2}]=\\frac{W_{\\min}^{2}+W_{\\min}W_{\\max}+W_{\\max}^{2}}{3}=\\frac{3100}{3},\n$$\n我们得到\n$$\n\\mathbb{E}[D(W)]=-0.5+0.05\\,\\mathbb{E}[W]=-0.5+0.05\\cdot 30=1,\n$$\n$$\n\\mathbb{E}[W\\,D(W)]=\\mathbb{E}[-0.5\\,W+0.05\\,W^{2}]=-0.5\\cdot 30+0.05\\cdot \\frac{3100}{3}=\\frac{110}{3}。\n$$\n当$\\gamma^{2}=10$时，\n$$\n\\beta_{a}=-\\frac{1}{10}\\cdot 1=-0.1,\\qquad\n\\beta_{b}=-\\frac{1}{10}\\cdot \\frac{110}{3}=-\\frac{11}{3}。\n$$\n应用$\\Delta \\bar{b}=G_{ab}\\beta_{a}+G_{bb}\\beta_{b}$，并代入$G_{ab}=-0.005$和$G_{bb}=0.001$，\n$$\n\\Delta \\bar{b}=(-0.005)(-0.1)+0.001\\left(-\\frac{11}{3}\\right)=0.0005-\\frac{0.011}{3}\\approx -0.0031666667。\n$$\n四舍五入到四位有效数字，得到\n$$\n\\Delta \\bar{b}\\approx -0.003167。\n$$", "answer": "$$\\boxed{-0.003167}$$", "id": "1918938"}, {"introduction": "演化过程本身也可以被选择塑造。本练习将带你探索一个更为深刻的概念：突变率，作为一种可演化的性状，受到权衡的制约。通过一个病原体适应的简化模型，你将分析适应性收益和有害突变负荷之间的权衡，并预测在新的选择压力（如抗病毒药物）下，最优突变率将如何演变 [@problem_id:1918968]。", "problem": "在病原体与其宿主免疫系统之间的协同进化军备竞赛中，病原体的突变率是一个关键的、可演化的性状。抗原编码区的高突变率可以加速免疫逃逸变体的产生，但它也增加了损害适应度的有害突变负荷。\n\n考虑一个简化模型，用于描述病原体谱系的长期马尔萨斯适应度 $m$ 如何作为其主要抗原基因中局部无量纲突变率 $u$ 的函数。适应度函数由下式给出：\n\n$$m(u) = A \\frac{u}{u + k} - B u$$\n\n此处，$A$、$B$ 和 $k$ 是正常数。项 $A \\frac{u}{u+k}$ 代表了适应带来的适应度收益，该收益在高突变率下会饱和。项 $-Bu$ 代表了因有害突变积累（突变负荷）而产生的适应度成本。我们假设参数使得一个能将 $m(u)$ 最大化的最佳非零突变率 $u_{opt} > 0$ 存在，并且病原体种群已经达到了这个速率。\n\n现在，引入了一种新的抗病毒药物。这种药物不直接致命，但改变了演化格局。它加强了对免疫逃逸的选择压力，将最大适应收益 $A$ 增加了 $\\alpha > 1$ 倍。同时，该药物有轻微破坏病原体复制机制稳定性的副作用，从而将突变负荷因子 $B$ 增加了 $\\beta > 1$ 倍。饱和常数 $k$ 不受影响。\n\n引入药物后，病原体种群经过多代演化，达到了一个与新参数相对应的新最佳突变率 $u'_{opt}$。\n\n计算病原体马尔萨斯适应度的总变化量 $\\Delta m = m_{final} - m_{initial}$。此处，$m_{initial}$ 是在初始最佳速率 $u_{opt}$（用药前）下的适应度，而 $m_{final}$ 是在新最佳速率 $u'_{opt}$（引入药物很久之后）下的适应度。你的答案应该是一个用初始参数 $A$、$B$、$k$ 以及因子 $\\alpha$ 和 $\\beta$ 表示的单一解析表达式。", "solution": "我们对 $m(u)=A \\frac{u}{u+k}-B u$ 关于 $u$ 求最大值，其中 $A$、$B$ 和 $k$ 为固定的正常数。\n\n计算一阶导数：\n$$\n\\frac{d m}{d u} \\;=\\; A \\frac{d}{d u}\\left(\\frac{u}{u+k}\\right) - B \\;=\\; A \\frac{k}{(u+k)^{2}} - B.\n$$\n令导数为零以求驻点：\n$$\nA \\frac{k}{(u+k)^{2}} - B \\;=\\; 0 \\;\\;\\Longrightarrow\\;\\; \\frac{A k}{(u+k)^{2}}=B \\;\\;\\Longrightarrow\\;\\; u+k=\\sqrt{\\frac{A k}{B}}.\n$$\n因此，最佳突变率为\n$$\nu_{opt}=\\sqrt{\\frac{A k}{B}}-k.\n$$\n二阶导数为\n$$\n\\frac{d^{2} m}{d u^{2}} \\;=\\; -\\frac{2 A k}{(u+k)^{3}} \\;<\\; 0,\n$$\n所以该驻点是一个极大值点。将 $u_{opt}$ 代回 $m(u)$ 以计算最大适应度。令 $s=u_{opt}+k=\\sqrt{\\frac{A k}{B}}$，则 $u_{opt}=s-k$。那么\n$$\nm_{initial}=A \\frac{s-k}{s}-B(s-k)=A - \\frac{A k}{s} - B s + B k.\n$$\n使用 $\\frac{A k}{s}=\\sqrt{A k B}$ 和 $B s=\\sqrt{A k B}$，我们得到\n$$\nm_{initial}=A - 2 \\sqrt{A k B} + B k.\n$$\n\n用药后，参数变为 $A'=\\alpha A$，$B'=\\beta B$，$k$ 保持不变。重复同样的求最大值过程，得到新的最佳速率 $u'_{opt}=\\sqrt{\\frac{\\alpha A k}{\\beta B}}-k$ 以及相应的最大适应度\n$$\nm_{final}=\\alpha A - 2 \\sqrt{\\alpha \\beta A B k} + \\beta B k.\n$$\n\n因此，马尔萨斯适应度的总变化量为\n$$\n\\Delta m \\;=\\; m_{final}-m_{initial} \\;=\\; \\left(\\alpha A - 2 \\sqrt{\\alpha \\beta A B k} + \\beta B k\\right) - \\left(A - 2 \\sqrt{A B k} + B k\\right).\n$$\n合并同类项以获得闭式表达式\n$$\n\\Delta m \\;=\\; (\\alpha - 1) A + (\\beta - 1) B k + 2 \\sqrt{A B k}\\,\\bigl(1 - \\sqrt{\\alpha \\beta}\\bigr).\n$$\n该表达式完全由 $A$、$B$、$k$、$\\alpha$ 和 $\\beta$ 表示，符合题目要求。", "answer": "$$\\boxed{(\\alpha - 1) A + (\\beta - 1) B k + 2 \\sqrt{A B k}\\left(1 - \\sqrt{\\alpha \\beta}\\right)}$$", "id": "1918968"}]}