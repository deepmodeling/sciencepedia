{"hands_on_practices": [{"introduction": "理解一个选择模式最直观的方法之一就是想象一个受控的实验。这个练习将我们置于一个经典的进化生物学实验场景中，任务是从表型分布上直接识别出选择压力的类型。通过分析这个假设的果蝇育种实验 [@problem_id:1928569]，你可以掌握分裂性选择最核心的操作性定义：对两个极端表型的偏好以及对中间表型的淘汰。", "problem": "一位演化生物学家正在对果蝇（*Drosophila melanogaster*）进行一项长期的实验演化研究。实验始于一个庞大且遗传多样的种群，其中腹部刚毛数（一种数量性状）呈正态分布。在每一代中，这位生物学家都实施严格的人工选择方案。当一代中所有的果蝇都成熟后，记录它们的刚毛数。刚毛数最高的顶部15%的果蝇和刚毛数最低的底部15%的果蝇被分离出来，并允许繁殖以产生下一代。刚毛数处于中间的70%的果蝇则被从种群中剔除，不对后代的基因库做出贡献。\n\n这一实验程序是某种特定自然选择模式的直接且受控的应用。下列哪个术语最能描述施加于该果蝇种群的选择压力？\n\nA. 稳定性选择\n\nB. 定向选择\n\nC. 分裂性选择\n\nD. 负频率依赖性选择\n\nE. 平衡选择", "solution": "设$z$表示单只果蝇的腹部刚毛数（一个数量性状）。该方案选择分布的顶部$0.15$（最大的$z$值）和底部$0.15$（最小的$z$值），同时移除中间的$0.70$。设$t_{\\mathrm{L}}$和$t_{\\mathrm{H}}$为下、上阈值，使得$P(z \\le t_{\\mathrm{L}})=0.15$且$P(z \\ge t_{\\mathrm{H}})=0.15$。因此，施加于整个表型的相对适应度函数$w(z)$为\n$$\nw(z)=\n\\begin{cases}\n1, & z \\le t_{\\mathrm{L}} \\\\\n0, & t_{\\mathrm{L}}< z < t_{\\mathrm{H}} \\\\\n1, & z \\ge t_{\\mathrm{H}}.\n\\end{cases}\n$$\n该函数在$z$上呈U形：具有极端表型（低刚毛数和高刚毛数）的个体被偏好，而中间表型则不被偏好。根据定义，这是分裂性（多样化）选择，它增加了表型方差，并且偏好两个极端胜过中间类型。\n\n排除其他选项：\n- 稳定性选择会有一个倒U形的$w(z)$，偏好中间类型并剔除极端类型，这与本实验设计相反。\n- 定向选择会有一个单调的$w(z)$，只偏好一个极端（高或低），而不是两者皆偏好。\n- 负频率依赖性选择要求适应度依赖于性状频率；在此，适应度是通过固定的表型阈值指定的，而不是通过稀有度。\n- 平衡选择是一个更广泛的类别，通过杂合子优势、频率依赖性或波动选择等机制来维持变异；此处的具体模式明确是分裂性选择。\n\n因此，施加的选择压力是分裂性选择。", "answer": "$$\\boxed{C}$$", "id": "1928569"}, {"introduction": "在理解了分裂性选择的概念之后，下一步是量化它对种群遗传构成的具体影响。本练习构建了一个植物种群在具有双峰资源环境下的生存模型，将抽象的选择压力转化为具体的等位基因频率变化。通过计算这个场景下存活后代的基因频率 [@problem_id:1919462]，你将实践如何运用群体遗传学的基本原理来预测进化轨迹。", "problem": "一种假设的植物物种 *Bimodalus synchronica* 栖息在一个山谷中，该山谷每年经历两个短暂而分明的雨季。这种双峰式的资源可利用性对该植物的萌发时间施加了强烈的分裂选择。该萌发时间由一个具有两个共显性等位基因的单一基因控制，即 E（早）和 L（晚）。\n\n三种可能基因型的萌发时间如下：\n-   **EE**：在时间 $t_1$ 萌发。\n-   **LL**：在时间 $t_2$ 萌发。\n-   **EL**：在中间时间 $t_{EL} = \\frac{1}{2}(t_1 + t_2)$ 萌发。\n\n幼苗存活至繁殖年龄的概率是其萌发时间 $t$ 的函数，该概率可作为适应度的一个度量。这个存活概率 $S(t)$ 由以下函数建模，该函数具有与两个雨季相对应的峰值：\n$$S(t) = S_0 \\left( \\exp\\left( -\\frac{(t-t_1)^2}{2\\sigma^2} \\right) + \\exp\\left( -\\frac{(t-t_2)^2}{2\\sigma^2} \\right) \\right)$$\n其中，$S_0$ 是一个归一化常数，$t_1=30$ 天和 $t_2=150$ 天是与雨季中心相对应的最佳萌发时间，$\\sigma=40$ 天表征了每个季节有利条件的持续时间。\n\n考虑一个大的、随机交配的 *Bimodalus synchronica* 种群。在一个世代的开始（即在合子库中），E 等位基因的频率为 $p_0 = 0.4$。计算在该世代中存活下来并进行繁殖的植物种群中 E 等位基因的频率。将您的最终答案四舍五入到四位有效数字。", "solution": "设 $p_{0}$ 为等位基因 E 的初始频率，$q_{0}=1-p_{0}$ 为等位基因 L 的频率。在随机交配下，合子基因型频率为 $f_{EE}=p_{0}^{2}$、$f_{EL}=2p_{0}q_{0}$ 和 $f_{LL}=q_{0}^{2}$。\n\n萌发时间为 $t$ 的基因型的生存力（存活到繁殖）为 $S(t)$。对于 $t_{1}=30$、$t_{2}=150$、$\\sigma=40$ 以及 $t_{EL}=\\frac{1}{2}(t_{1}+t_{2})=90$，我们计算：\n$$\nS(t_{1})=S_{0}\\left(\\exp\\left(0\\right)+\\exp\\left(-\\frac{(t_{2}-t_{1})^{2}}{2\\sigma^{2}}\\right)\\right)\n=S_{0}\\left(1+\\exp\\left(-\\frac{120^{2}}{2\\cdot 40^{2}}\\right)\\right)\n=S_{0}\\left(1+\\exp\\left(-\\frac{9}{2}\\right)\\right),\n$$\n$$\nS(t_{2})=S_{0}\\left(\\exp\\left(-\\frac{(t_{2}-t_{1})^{2}}{2\\sigma^{2}}\\right)+\\exp\\left(0\\right)\\right)\n=S_{0}\\left(1+\\exp\\left(-\\frac{9}{2}\\right)\\right),\n$$\n$$\nS(t_{EL})=S_{0}\\left(\\exp\\left(-\\frac{(t_{EL}-t_{1})^{2}}{2\\sigma^{2}}\\right)+\\exp\\left(-\\frac{(t_{EL}-t_{2})^{2}}{2\\sigma^{2}}\\right)\\right)\n=2S_{0}\\exp\\left(-\\frac{60^{2}}{2\\cdot 40^{2}}\\right)\n=2S_{0}\\exp\\left(-\\frac{9}{8}\\right).\n$$\n因此，生存力（与适应度成正比）为\n$$\nw_{EE}=w_{LL}=S_{0}\\left(1+\\exp\\left(-\\frac{9}{2}\\right)\\right),\\quad\nw_{EL}=2S_{0}\\exp\\left(-\\frac{9}{8}\\right).\n$$\n经过生存力选择后，存活者中等位基因 E 的频率为\n$$\np_{1}=\\frac{p_{0}^{2}w_{EE}+p_{0}q_{0}w_{EL}}{p_{0}^{2}w_{EE}+2p_{0}q_{0}w_{EL}+q_{0}^{2}w_{LL}}.\n$$\n由于 $S_{0}$ 是一个公因子，因此可以消去。使用 $w_{EE}=w_{LL}$ 并定义\n$$\nh=\\frac{w_{EL}}{w_{EE}}=\\frac{2\\exp\\left(-\\frac{9}{8}\\right)}{1+\\exp\\left(-\\frac{9}{2}\\right)},\n$$\n我们重写为\n$$\np_{1}=\\frac{p_{0}^{2}+p_{0}q_{0}h}{(p_{0}^{2}+q_{0}^{2})+2p_{0}q_{0}h}.\n$$\n当 $p_{0}=0.4$ 且 $q_{0}=0.6$ 时，\n$$\np_{1}=\\frac{0.16+0.24h}{0.52+0.48h},\\quad\nh=\\frac{2\\exp\\left(-\\frac{9}{8}\\right)}{1+\\exp\\left(-\\frac{9}{2}\\right)}.\n$$\n数值上，$\\exp\\left(-\\frac{9}{2}\\right)\\approx 0.01110899654$ 且 $\\exp\\left(-\\frac{9}{8}\\right)\\approx 0.32465246736$，因此\n$$\nh\\approx \\frac{2\\cdot 0.32465246736}{1+0.01110899654}\\approx 0.6421710586,\n$$\n所以\n$$\np_{1}\\approx \\frac{0.16+0.24\\cdot 0.6421710586}{0.52+0.48\\cdot 0.6421710586}\\approx \\frac{0.3141210541}{0.8282421081}\\approx 0.37926236.\n$$\n四舍五入到四位有效数字，得到 $0.3793$。", "answer": "$$\\boxed{0.3793}$$", "id": "1919462"}, {"introduction": "进化常常是不同选择压力之间权衡与冲突的结果，例如生存与繁殖之间的斗争。这个问题引导我们进入一个更高级的建模实践，探索性选择和自然选择之间的相互作用如何共同塑造一个求偶信号策略。通过分析这个模型 [@problem_id:1919458]，你将学习如何使用数学工具来确定一个系统从稳定选择转向分裂选择的关键“临界点”，深入理解进化动态的复杂性。", "problem": "在一种假设的具有求偶场行为的鸟类中，雄性通过产生一种由声音信号和视觉信号两个组分构成的复合信号来争夺配偶。雄性在声音信号上的投入表示为 $x$，在视觉信号上的投入表示为 $y$。由于生理上的权衡关系，任何雄性的信号总投入都受到一个固定的能量预算 $E$ 的限制，即 $x+y=E$。因此，雄性的信号策略由其在 $[0, E]$ 区间内对 $x$ 的选择所决定。$x=E/2$ 的策略被称为“泛化者”策略，而 $x=0$ 或 $x=E$ 的策略被称为“特化者”策略。\n\n雄性的总体繁殖成功率（适应度）取决于两个因素：其交配成功率和其随后的存活率。\n\n1.  **交配成功率**：该物种的雌性表现出一种“分离式”择偶规则，这意味着她们会不成比例地被那些在任一信号组分上表现得特别突出的雄性所吸引。这种行为偏好导致雄性的交配成功率 $W_{\\text{mate}}$ 与其信号投入的平方和成正比。这可以建模为 $W_{\\text{mate}}(x, y) = k_m (x^2 + y^2)$，其中 $k_m$ 是一个正常数。\n\n2.  **存活成本**：信号传递中的极端特化在生理上代价高昂，会带来生存惩罚。雄性在繁殖季节后的存活概率 $W_{\\text{surv}}$ 对泛化者来说是最高的，而对特化者则会降低。这可以用一个以泛化者策略为中心的高斯函数来建模：$W_{\\text{surv}}(x) = \\exp\\left( - \\frac{(x - E/2)^2}{2\\sigma^2} \\right)$。参数 $\\sigma > 0$ 代表生理上可行策略的广度；较大的 $\\sigma$ 表示针对特化者的生存选择压力较弱。\n\n雄性的总相对适应度 $W(x)$ 是其交配成功率和存活概率的乘积。当适应度景观偏爱特化者而非泛化者时，就会发生分裂选择，这意味着泛化者策略 ($x=E/2$) 对应于适应度的一个局部极小值。这种情况出现在当存活成本的稳定效应与雌性选择的多样化效应相比很弱时。\n\n确定无量纲比率 $\\sigma/E$ 的临界值，在该值下，总体选择压力从稳定选择（偏爱泛化者）过渡到分裂选择（偏爱特化者）。", "solution": "能量预算约束意味着 $y=E-x$，因此交配成功率为\n$$\nW_{\\text{mate}}(x)=k_{m}\\left(x^{2}+(E-x)^{2}\\right)=k_{m} f(x),\n$$\n其中\n$$\nf(x)=x^{2}+(E-x)^{2}=2x^{2}-2Ex+E^{2}.\n$$\n存活概率为\n$$\nW_{\\text{surv}}(x)=\\exp\\!\\left(-\\frac{(x-E/2)^{2}}{2\\sigma^{2}}\\right)=\\exp\\!\\big(g(x)\\big),\n$$\n其中\n$$\ng(x)=-\\frac{(x-E/2)^{2}}{2\\sigma^{2}}.\n$$\n因此总适应度为\n$$\nW(x)=k_{m} f(x)\\exp\\!\\big(g(x)\\big).\n$$\n为了确定 $x^{*}=E/2$ 是一个局部极大值（稳定选择）还是一个局部极小值（分裂选择），我们需要计算在 $x^{*}$ 处的曲率。考虑对数适应度 $L(x)=\\ln W(x)=\\ln k_{m}+\\ln f(x)+g(x)$。那么\n$$\nL'(x)=\\frac{f'(x)}{f(x)}+g'(x),\\qquad L''(x)=\\frac{f''(x)}{f(x)}-\\left(\\frac{f'(x)}{f(x)}\\right)^{2}+g''(x).\n$$\n计算导数：\n$$\nf'(x)=4x-2E,\\quad f''(x)=4,\\quad g'(x)=-\\frac{x-E/2}{\\sigma^{2}},\\quad g''(x)=-\\frac{1}{\\sigma^{2}}.\n$$\n在 $x^{*}=E/2$ 处，\n$$\nf'(E/2)=0,\\quad f(E/2)=\\frac{E^{2}}{2},\\quad g'(E/2)=0,\n$$\n所以 $L'(E/2)=0$ 并且\n$$\nL''(E/2)=\\frac{f''(E/2)}{f(E/2)}+g''(E/2)=\\frac{4}{E^{2}/2}-\\frac{1}{\\sigma^{2}}=\\frac{8}{E^{2}}-\\frac{1}{\\sigma^{2}}.\n$$\n因为当 $L'(x^{*})=0$ 时，有 $W''(x^{*})=W(x^{*})L''(x^{*})$，所以 $W''(E/2)$ 的符号与 $L''(E/2)$ 的符号相同。从稳定选择到分裂选择的过渡发生在 $W''(E/2)=0$ 时，即，\n$$\n\\frac{8}{E^{2}}-\\frac{1}{\\sigma^{2}}=0\\;\\;\\Longrightarrow\\;\\;\\sigma^{2}=\\frac{E^{2}}{8}\\;\\;\\Longrightarrow\\;\\;\\frac{\\sigma}{E}=\\frac{1}{2\\sqrt{2}}.\n$$", "answer": "$$\\boxed{\\frac{1}{2\\sqrt{2}}}$$", "id": "1919458"}]}