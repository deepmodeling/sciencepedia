{"hands_on_practices": [{"introduction": "在构建位点频率谱（Site Frequency Spectrum, SFS）之前，我们必须掌握最基本的一步：如何为单个遗传变异位点计算其在样本中的频率。这个练习将指导你如何根据测序得到的基因型数据（例如，纯合祖先型、杂合型和纯合衍生型）计算衍生等位基因的计数（$k$）。掌握这一技能是正确构建和解释任何“展开”SFS（unfolded SFS）的基础。[@problem_id:1975020]", "problem": "一个进化生物学家团队正在研究一个偏远的墨西哥钝口螈（*Ambystoma mexicanum*）种群的遗传变异。他们正在构建一个位点频率谱（SFS），这是一种等位基因频率的分布，以了解该种群的动态历史。对于一个特定的遗传位点，他们分析了一个由120个二倍体个体组成的样本。在该位点内的一个特定单核苷酸多态性（SNP）上，他们鉴定出了一个祖先等位基因和一个较新的衍生等位基因。\n\n他们对此SNP的基因分型结果如下：\n- 105个个体为祖先等位基因纯合子。\n- 13个个体为杂合子。\n- 2个个体为衍生等位基因纯合子。\n\n为了将此SNP放入SFS的正确类别中，生物学家需要确定其衍生等位基因计数。在这个抽样种群中，这个特定SNP的衍生等位基因计数（用 $k$ 表示）是多少？", "solution": "在一个二倍体样本中，每个个体在一个位点上贡献两个等位基因。衍生等位基因计数（用 $k$ 表示）是所有抽样染色体中衍生等位基因的总数。对于基因型计数，其计算公式为\n$$\nk = 2 \\times n_{DD} + 1 \\times n_{AD} + 0 \\times n_{AA},\n$$\n其中，$n_{DD}$ 是衍生纯合子的数量，$n_{AD}$ 是杂合子的数量，而 $n_{AA}$ 是祖先纯合子的数量。\n\n代入给定的计数 $n_{DD}=2$，$n_{AD}=13$ 和 $n_{AA}=105$，\n$$\nk = 2 \\times 2 + 1 \\times 13 + 0 \\times 105 = 4 + 13 + 0 = 17.\n$$\n\n作为一致性检查，个体总数为 $105 + 13 + 2 = 120$，与样本量相符。", "answer": "$$\\boxed{17}$$", "id": "1975020"}, {"introduction": "在实际研究中，确定哪个等位基因是祖先型可能非常困难，甚至无法实现。这个练习介绍了一种重要的解决方案：构建“折叠”位点频率谱（folded SFS）。通过关注样本中频率较低的“次要等位基因”（minor allele），而不是衍生等位基因，我们可以绕过确定祖先状态的难题，同时仍然有效地概括群体的遗传变异。[@problem_id:1974998]", "problem": "一位群体遗传学家正在研究一个新测序的鳞足螺（*Chrysomallon squamiferum*）种群，该种群发现于一个深海热液喷口附近。该分析的重点是构建一个位点频率谱（Site Frequency Spectrum, SFS），这是根据测序个体的样本得出的等位基因频率分布。研究人员收集了10个二倍体个体的样本。\n\n在群体遗传学中，当某个特定遗传位点的等位基因的祖先状态未知时，会构建一个“折叠”的 SFS。折叠 SFS 追踪的不是衍生（突变）等位基因的频率，而是*次要*等位基因（样本中两种等位基因中较不常见的一种）的频率。在样本中鉴定出了一个特定的单核苷酸多态性（Single Nucleotide Polymorphism, SNP）。在该位点上，在15条被抽样的染色体上观察到一种等位基因，而另一种等位基因则存在于其余的染色体上。\n\n为了构建该种群的折叠 SFS，这个特定的遗传变异应该被记录的计数是多少？", "solution": "问题要求的是在一个折叠位点频率谱（SFS）中，针对一个特定的遗传变异应使用的计数。\n\n首先，我们确定抽样的染色体总数，用 $n$ 表示。题中说明抽样了10个二倍体个体。由于二倍体生物有两套染色体，所以染色体总数是个体数的两倍。\n$$n = 10 \\text{ 个体} \\times 2 \\frac{\\text{染色体}}{\\text{个体}} = 20 \\text{ 条染色体}$$\n\n接下来，我们得到了关于一个特定单核苷酸多态性（SNP）的信息。在这个位点上，有两个等位基因。我们称之为等位基因1和等位基因2。\n等位基因1的计数，我们称之为 $i$，给定为15。\n$$i = 15$$\n等位基因2的计数必须是染色体总数减去等位基因1的计数。\n$$\\text{等位基因2的计数} = n - i = 20 - 15 = 5$$\n\n一个折叠 SFS 记录的是次要等位基因的计数，即在样本中出现频率较低的那个等位基因。为了找到次要等位基因的计数，我们需要比较两个等位基因的计数，并取较小的值。\n这两个等位基因的计数分别是15和5。\n\n因此，次要等位基因的计数是这两个值的最小值：\n$$\\text{次要等位基因计数} = \\min(15, 5)$$\n$$\\text{次要等位基因计数} = 5$$\n\n因此，对于这个特定的 SNP，应该在折叠 SFS 中记录的计数是5。这意味着该变异将贡献给折叠 SFS 直方图的第5个区间。", "answer": "$$\\boxed{5}$$", "id": "1974998"}, {"introduction": "构建SFS本身不是最终目的，其真正的价值在于它能帮助我们量化和解释群体中的遗传变异。这个练习将展示如何利用一个已知的SFS来计算一个核心的群体遗传学统计量——核苷酸多样性（$\\pi$）。通过这个实践，你将学会如何将SFS数据转化为对群体变异水平的有意义的度量，这是理解进化过程的关键一步。[@problem_id:1975013]", "problem": "在一项对深海热泉管虫 *Riftia pachyptila* 的种群遗传学研究中，一位研究人员对来自4个二倍体个体的样本中的一个特定基因区域进行了测序。对比对后的脱氧核糖核酸（DNA）序列的分析被用于构建一个位点频率谱（Site Frequency Spectrum, SFS），该谱是多态性位点上衍生（非祖先）等位基因计数的分布。\n\n分析揭示了样本的以下多态性数据：\n- 有五个位点是“单例变异”(singletons)，意味着衍生等位基因在样本中仅在一条染色体上被观察到。\n- 有三个位点是“双例变异”(doubletons)，其中衍生等位基因在两条染色体上被观察到。\n- 有一个位点是“三例变异”(tripleton)，其中衍生等位基因在三条染色体上被观察到。\n- 在测序区域内没有发现其他多态性位点。\n\n基于这些信息，计算核苷酸多样性，用 $\\pi$ 表示。核苷酸多样性定义为从样本中随机抽取的任意两个序列之间的平均核苷酸差异数。\n\n将您的答案表示为保留三位有效数字的小数。", "solution": "我们有一个包含4个二倍体个体的样本，这对应于 $n=8$ 个染色体拷贝。设 $n$ 表示抽样的染色体数量。核苷酸多样性 $\\pi$ 是在整个测序区域内，从样本中随机选择的两条序列之间的成对核苷酸差异的平均数。\n\n对于一个衍生等位基因计数为 $i$（祖先等位基因计数为 $n-i$）的双等位基因位点，在所有 $\\binom{n}{2}$ 对染色体中，存在差异的对数为 $i(n-i)$。因此，这样一个位点对随机选择的两条序列间预期差异数的贡献是\n$$\n\\frac{i(n-i)}{\\binom{n}{2}}。\n$$\n\n给定衍生等位基因计数为 $i$ 时的位点频率谱（SFS）计数 $S_{i}$，整个区域的成对差异总平均数为\n$$\n\\pi=\\sum_{i=1}^{n-1} S_{i}\\,\\frac{i(n-i)}{\\binom{n}{2}}。\n$$\n\n在这里，$n=8$，观察到的计数为 $S_{1}=5$（单例变异），$S_{2}=3$（双例变异），$S_{3}=1$（三例变异），以及在其他情况下 $S_{i}=0$。计算 $\\binom{8}{2}=28$。各项贡献如下：\n- 单例变异：$5\\times \\frac{1\\cdot(8-1)}{28}=5\\times \\frac{7}{28}=\\frac{35}{28}$。\n- 双例变异：$3\\times \\frac{2\\cdot(8-2)}{28}=3\\times \\frac{12}{28}=\\frac{36}{28}$。\n- 三例变异：$1\\times \\frac{3\\cdot(8-3)}{28}=1\\times \\frac{15}{28}=\\frac{15}{28}$。\n\n将这些贡献相加得到\n$$\n\\pi=\\frac{35+36+15}{28}=\\frac{86}{28}=\\frac{43}{14}。\n$$\n\n转换为小数并保留三位有效数字，得到\n$$\n\\pi\\approx 3.07。\n$$", "answer": "$$\\boxed{3.07}$$", "id": "1975013"}]}