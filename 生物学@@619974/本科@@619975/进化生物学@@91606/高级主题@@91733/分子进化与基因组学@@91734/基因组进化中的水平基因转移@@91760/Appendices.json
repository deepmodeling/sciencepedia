{"hands_on_practices": [{"introduction": "该练习探讨了演化生物学中的一个根本性冲突：基因树与物种树之间的不一致性。通过分析一个涉及 `luxZ` 基因的假想情景，你将学习水平基因转移如何造成与生物体真实演化历史不同的系统发育模式[@problem_id:1938644]。这项练习旨在培养你批判性解读系统发育数据并识别HGT强大影响的能力。", "problem": "想象有三种细菌，分别被指定为 *Bacillus exemplar A*、*Bacillus exemplar B* 和 *Bacillus exemplar C*。使用高度保守的基因（例如 16S 核糖体 RNA (rRNA) 的基因）进行的全面基因组分析已经可靠地确定，物种 A 和 B 是姐妹群，这意味着它们彼此间的共同祖先比它们任何一个与物种 C 的共同祖先都要晚近。因此，已确立的进化关系，即物种树，为 ((A,B),C)。\n\n另一项独立研究聚焦于一个单一基因 `luxZ`，该基因编码一种酶，能使细菌在特定底物存在时发出荧光。已知该基因位于质粒上，质粒是一种小型的环状 DNA，可以通过称为水平基因转移 (HGT) 的过程在细菌细胞之间转移。基因测序显示，物种 B 和物种 C 拥有的 `luxZ` 基因具有 99.8% 的核苷酸序列同一性，而物种 A 则完全缺乏 `luxZ` 基因。\n\n一位研究人员构建了两棵不同的系统发育树：一棵使用 16S rRNA 基因序列，另一棵仅使用 `luxZ` 基因序列。以下哪个陈述最准确地预测了此分析的结果，并提供了最科学合理的进化解释？\n\nA. 16S rRNA 树会将 A 和 B 聚为一类，而 `luxZ` 树会将 B 和 C 聚为一类。这种差异的最佳解释是 `luxZ` 基因从 C 的谱系水平转移到了 B 的谱系。\n\nB. 将 B 和 C 聚为一类的 `luxZ` 基因树反映了物种的真实进化历史。16S rRNA 基因必定经历了一次不寻常的进化事件，使得 A 和 B 看起来关系密切。\n\nC. 数据表明，物种 B 是一个杂交生物体，由一个祖先 A 细胞和一个祖先 C 细胞融合而成，因此从两个谱系都继承了基因。\n\nD. 16S rRNA 树是正确的。B 和 C 中 `luxZ` 基因的高度相似性是趋同进化的结果，即两个物种为适应相似环境而独立进化出几乎相同的基因序列。\n\nE. 产生了 A 和 B 的祖先物种拥有 `luxZ` 基因。随后物种 A 丢失了该基因，而物种 B 中的基因由于强烈的纯化选择，与物种 C 中的基因保持一致。", "solution": "我们被告知，根据保守的、垂直遗传的基因（如 16S rRNA）构建的可靠物种树是 ((A,B),C)，这意味着 A 和 B 是姐妹群。一个独立的基因座，即质粒携带的基因 $luxZ$，存在于 B 和 C 中，其序列同一性为 0.998，但在 A 中缺失。构建了两棵基因树：一棵来自 16S rRNA，另一棵来自 $luxZ$。我们必须预测可能的拓扑结构，并对任何不一致之处提供最科学合理的解释。\n\n原则 1：像 16S rRNA 这样的核心看家基因通常反映垂直遗传，并且高度保守，这些基因座的水平基因转移 (HGT) 很罕见。因此，16S rRNA 树预期会重建物种树 ((A,B),C)。\n\n原则 2：质粒上的基因经常通过 HGT 在细菌谱系间转移。 B 和 C 的 $luxZ$ 基因之间极高的核苷酸序列同一性 (0.998) 表明该基因序列拥有非常晚近的共同祖先，与通过长期垂直遗传和纯化选择来解释相比，用 B 和 C 之间近期的 HGT 来解释要简约得多。\n\n对 16S rRNA 树的预测：它会将 A 和 B 聚为一类，与 ((A,B),C) 一致。\n\n对 $luxZ$ 基因树的预测：由于 B 和 C 共享几乎相同的质粒携带 $luxZ$ 序列，而 A 缺乏 $luxZ$，因此仅使用 $luxZ$ 的树会将 B 和 C 聚为一类。\n\n解释评估：\n- HGT 解释：B 和 C 之间（根据给定数据，转移方向不确定）发生的一次近期 $luxZ$ 基因 HGT 事件，可以解释 B 和 C 中近乎相同的序列以及 A 中的缺失。这产生了一棵与物种树不一致的基因树，这是 HGT 影响移动基因的一个经典特征。\n- 排除趋同进化：趋同进化在整个基因上产生几乎相同的核苷酸序列（同一性 0.998）是极其不可能的；趋同进化通常影响一部分位点的氨基酸，而不会产生全基因范围内近乎相同的核苷酸序列。\n- 排除将 $luxZ$ 树视为物种树：质粒基因座不是物种关系的可靠标记，尤其是在其高度可移动的情况下；此外，16S rRNA 是物种水平系统发育的标准，并且更不易发生 HGT。\n- 排除杂交生物体融合：通过全细胞融合实现的细菌“杂交”并非标准解释；细菌的基因流动通常是通过特定基因座的 HGT 实现的，而不是整个基因组的融合。核心基因仍然将 A 与 B 归为一类，这与广泛杂交所预期的基因组嵌合体现状相反。\n- 排除 AB 共同祖先拥有 $luxZ$、A 中丢失、B 和 C 中保留严格一致性的假说：这需要多个假设（祖先拥有该基因、在 A 中丢失、以及在两个谱系中都存在极其受限的进化，从而在足以让 A 和 B 从 C 分化出来的时间跨度内保持近乎一致）。B 和 C 之间的近乎一致性强烈表明该序列具有晚近的共同历史，而这最好用 HGT 来解释。\n\n因此，正确的预测和解释是：16S rRNA 树将 A 和 B 列为姐妹群，而 $luxZ$ 树将 B 和 C 聚为一类，这种差异最好通过 B 和 C 之间 $luxZ$ 的 HGT 来解释。在所提供的选项中，选项 A 最准确地捕捉了这一结果和解释（需要注意的是，尽管从给定信息中无法严格确定转移的确切方向，但 HGT 的解释是正确的，并且是该选项的核心要点）。", "answer": "$$\\boxed{A}$$", "id": "1938644"}, {"introduction": "在水平基因转移概念的基础上，本练习将介绍一个强大的生物信息学检测工具：密码子使用偏好。每个物种都有一套特征性的密码子使用“方言”；一个从远亲那里获得的基因，常常会因其不同的“方言”而暴露其外来起源[@problem_id:1938590]。通过为假想的 `xtrA` 基因计算密码子使用非相似性指数 (Codon Usage Dissimilarity Index, CUDI)，你将亲身体验用于识别近期转移基因的定量方法。", "problem": "在基因组学领域，密码子使用偏好性分析是研究基因组进化的一个强大工具。遗传密码是简并的，这意味着大多数氨基酸由不止一个三核苷酸密码子编码。然而，生物体通常表现出对使用某个同义密码子而非其他同义密码子的偏好或“偏性”。这种偏好性是基因组的一个特征性标志。当一个基因通过水平基因转移（HGT）从不同物种获得时，其密码子使用模式可能与其新宿主基因组的模式形成鲜明对比，从而暴露其外来来源。\n\n一位进化生物学家正在研究一种新发现的细菌 *Exiguobacterium analyticum* 的基因组。该基因组包含一个名为 `xtrA` 的基因，该基因赋予对一种新型抗生素的抗性。为了调查该基因的来源，这位生物学家决定将其密码子使用情况与整个 *E. analyticum* 基因组的平均密码子使用情况进行比较。\n\n量化这种差异的一个简单方法是计算密码子使用差异指数（CUDI）。对于本问题，CUDI 定义为：对于选定的一组氨基酸，将目标基因中每个密码子的相对频率与宿主基因组中其相应相对频率之间的绝对差值，对所有密码子求和。对于给定的氨基酸，其密码子组的相对频率之和必须为1。\n\n现提供两种氨基酸，Leucine 和 Arginine 的相对密码子使用频率。\n\n对于氨基酸 Leucine (Leu)，由密码子 CUU, CUC, CUA, CUG, UUA 和 UUG 编码，其相对频率如下：\n- *E. analyticum* 基因组平均值：CUU (0.08), CUC (0.12), CUA (0.04), CUG (0.52), UUA (0.06), UUG (0.18)\n- `xtrA` 基因：CUU (0.25), CUC (0.25), CUA (0.15), CUG (0.10), UUA (0.15), UUG (0.10)\n\n对于氨基酸 Arginine (Arg)，由密码子 CGU, CGC, CGA, CGG, AGA 和 AGG 编码，其相对频率如下：\n- *E.analyticum* 基因组平均值：CGU (0.21), CGC (0.24), CGA (0.05), CGG (0.08), AGA (0.22), AGG (0.20)\n- `xtrA` 基因：CGU (0.06), CGC (0.04), CGA (0.25), CGG (0.25), AGA (0.20), AGG (0.20)\n\n请仅使用为 Leucine 和 Arginine 提供的数据，计算 `xtrA` 基因相对于 *E. analyticum* 基因组的密码子使用差异指数（CUDI）。CUDI 是一个无量纲的量。请将您的最终答案四舍五入到三位有效数字。", "solution": "根据定义，一个基因与一个宿主基因组之间，仅限于选定的一组氨基酸的密码子使用差异指数（CUDI）为\n$$\n\\mathrm{CUDI}=\\sum_{a}\\sum_{c\\in C(a)}\\left|f_{\\mathrm{gene}}(a,c)-f_{\\mathrm{genome}}(a,c)\\right|,\n$$\n其中，对于每个氨基酸 $a$，其密码子集 $C(a)$ 的相对频率对于基因和基因组的总和都为 $1$。\n\n首先，验证所提供的每种氨基酸的归一化。\n\n对于 Leucine (Leu)，基因组：\n$$\n0.08+0.12+0.04+0.52+0.06+0.18=1.00,\n$$\n基因：\n$$\n0.25+0.25+0.15+0.10+0.15+0.10=1.00.\n$$\n\n对于 Arginine (Arg)，基因组：\n$$\n0.21+0.24+0.05+0.08+0.22+0.20=1.00,\n$$\n基因：\n$$\n0.06+0.04+0.25+0.25+0.20+0.20=1.00.\n$$\n\n计算每种氨基酸的绝对差值并求和。\n\n对于 Leucine：\n$$\n|0.25-0.08|+|0.25-0.12|+|0.15-0.04|+|0.10-0.52|+|0.15-0.06|+|0.10-0.18|\n$$\n$$\n=0.17+0.13+0.11+0.42+0.09+0.08=1.00.\n$$\n\n对于 Arginine：\n$$\n|0.06-0.21|+|0.04-0.24|+|0.25-0.05|+|0.25-0.08|+|0.20-0.22|+|0.20-0.20|\n$$\n$$\n=0.15+0.20+0.20+0.17+0.02+0.00=0.74.\n$$\n\n因此，仅限于 Leucine 和 Arginine，\n$$\n\\mathrm{CUDI}=1.00+0.74=1.74.\n$$\n\n四舍五入到三位有效数字，结果是 $1.74$（无量纲）。", "answer": "$$\\boxed{1.74}$$", "id": "1938590"}, {"introduction": "当一个基因存在于某个物种中，却在其近亲中缺失时，我们如何判断它是近期获得的，还是从祖先那里遗传下来后又丢失的？这个高级练习将介绍一种形式化的统计方法，通过比较相互竞争的演化假说的似然性来回答这个问题。通过将连续时间马尔可夫模型应用于 `xenR` 基因，你将学习如何运用概率推理来定量评估基因演化的不同情景，这是现代比较基因组学的一项核心技能[@problem_id:1938660]。", "problem": "在比较基因组学领域，区分单个谱系通过水平基因转移（HGT）获得的基因与一个祖先基因在多个相关谱系中丢失的情形，是一个基本的挑战。考虑一个新发现的基因 `xenR`，该基因能赋予对一种罕见抗生素的抗性。该基因存在于细菌 *Escherichia coli* K-12 的基因组中，但在其近亲 *Escherichia coli* O157:H7 和更远的外群 *Salmonella enterica* 中明显缺失。\n\n一项系统发育分析确定了这三种细菌的进化关系和分支长度（单位为每位点预期替换数），其有根树结构如下所示：`((E. coli K-12: 0.04, E. coli O157:H7: 0.05): 0.12, S. enterica: 0.18);`。这对应于：\n- 指向 *E. coli* K-12（拥有该基因）的末端分支，长度为 $t_A = 0.04$。\n- 指向 *E. coli* O157:H7（缺少该基因）的末端分支，长度为 $t_B = 0.05$。\n- 连接两种 *E. coli* 菌株的共同祖先与其各自末端分支的内部一支，长度为 $t_{AB} = 0.12$。\n- 指向 *S. enterica*（缺少该基因）的末端分支，长度为 $t_C = 0.18$。\n\n基因存在/缺失的演化被建模为一个连续时间马尔可夫过程。在长度为 $t$ 的分支上，一个基因被获得的概率是 $P(0 \\to 1) = 1 - \\exp(-\\lambda_G t)$，其丢失的概率是 $P(1 \\to 0) = 1 - \\exp(-\\lambda_L t)$。因此，没有获得的概率是 $P(0 \\to 0) = \\exp(-\\lambda_G t)$，没有丢失（即保留）的概率是 $P(1 \\to 1) = \\exp(-\\lambda_L t)$。全基因组分析估计，通过HGT的基因获得速率为 $\\lambda_G = 0.01$ 事件/单位分支长度，基因丢失速率为 $\\lambda_L = 0.65$ 事件/单位分支长度。\n\n你的任务是比较关于 `xenR` 基因观察分布的两个竞争性假设：\n- **假设 $H_1$ (HGT)：** 该基因在所有三种细菌的共同祖先中不存在。它是在指向 *E. coli* K-12 的末端分支上通过一次HGT事件获得的。\n- **假设 $H_2$ (祖先丢失)：** 该基因在所有三种细菌的共同祖先中存在。它随后在指向 *E. coli* O157:H7 和 *S. enterica* 的分支上独立地丢失了。\n\n计算似然比 $R = \\frac{L(H_1)}{L(H_2)}$，其中一个假设的似然 $L$ 是在该假设定义的祖先状态条件下，树上每个分支发生所需状态转换的概率的乘积。将你的最终答案四舍五入到三位有效数字。", "solution": "给定一个有根树，其分支长度为 $t_{A}=0.04$、$t_{B}=0.05$、$t_{AB}=0.12$ 和 $t_{C}=0.18$，以及一个用于基因存在/缺失的连续时间马尔可夫过程，其获得速率为 $\\lambda_{G}=0.01$，丢失速率为 $\\lambda_{L}=0.65$。沿长度为 $t$ 的分支的转换概率为：\n- 获得：$P(0 \\to 1)=1-\\exp(-\\lambda_{G}t)$，\n- 未获得：$P(0 \\to 0)=\\exp(-\\lambda_{G}t)$，\n- 丢失：$P(1 \\to 0)=1-\\exp(-\\lambda_{L}t)$，\n- 保留：$P(1 \\to 1)=\\exp(-\\lambda_{L}t)$。\n\n在假设 $H_{1}$ (HGT)下，根状态为 $0$，在分支 $t_{A}$ 上发生一次获得事件，所有其他分支都保持缺失状态。所需的转换及其概率为：\n- 根 $\\to$ AB (长度 $t_{AB}$): $0 \\to 0$，概率为 $\\exp(-\\lambda_{G} t_{AB})$，\n- AB $\\to$ A (长度 $t_{A}$): $0 \\to 1$，概率为 $1-\\exp(-\\lambda_{G} t_{A})$，\n- AB $\\to$ B (长度 $t_{B}$): $0 \\to 0$，概率为 $\\exp(-\\lambda_{G} t_{B})$，\n- 根 $\\to$ C (长度 $t_{C}$): $0 \\to 0$，概率为 $\\exp(-\\lambda_{G} t_{C})$。\n\n因此，\n$$\nL(H_{1})=\\exp\\!\\big(-\\lambda_{G}(t_{AB}+t_{B}+t_{C})\\big)\\,\\big(1-\\exp(-\\lambda_{G}t_{A})\\big).\n$$\n代入数值，\n$$\nL(H_{1})=\\exp\\!\\big(-0.01\\times(0.12+0.05+0.18)\\big)\\,\\big(1-\\exp(-0.01\\times 0.04)\\big)\n=\\exp(-0.0035)\\,\\big(1-\\exp(-0.0004)\\big).\n$$\n数值上，$\\exp(-0.0035)\\approx 0.996506118$ 且 $1-\\exp(-0.0004)\\approx 0.000399920011$，所以\n$$\nL(H_{1})\\approx 0.996506118 \\times 0.000399920011 \\approx 3.985227373\\times 10^{-4}.\n$$\n\n在假设 $H_{2}$ (祖先丢失)下，根状态为 $1$，基因在分支 $t_{AB}$ 和 $t_{A}$ 上被保留，并在分支 $t_{B}$ 和 $t_{C}$ 上独立地丢失。所需的转换及其概率为：\n- 根 $\\to$ AB (长度 $t_{AB}$): $1 \\to 1$，概率为 $\\exp(-\\lambda_{L} t_{AB})$，\n- AB $\\to$ A (长度 $t_{A}$): $1 \\to 1$，概率为 $\\exp(-\\lambda_{L} t_{A})$，\n- AB $\\to$ B (长度 $t_{B}$): $1 \\to 0$，概率为 $1-\\exp(-\\lambda_{L} t_{B})$，\n- 根 $\\to$ C (长度 $t_{C}$): $1 \\to 0$，概率为 $1-\\exp(-\\lambda_{L} t_{C})$。\n\n因此，\n$$\nL(H_{2})=\\exp\\!\\big(-\\lambda_{L}(t_{AB}+t_{A})\\big)\\,\\big(1-\\exp(-\\lambda_{L} t_{B})\\big)\\,\\big(1-\\exp(-\\lambda_{L} t_{C})\\big).\n$$\n代入数值，\n$$\nL(H_{2})=\\exp\\!\\big(-0.65\\times(0.12+0.04)\\big)\\,\\big(1-\\exp(-0.65\\times 0.05)\\big)\\,\\big(1-\\exp(-0.65\\times 0.18)\\big)\n=\\exp(-0.104)\\,\\big(1-\\exp(-0.0325)\\big)\\,\\big(1-\\exp(-0.117)\\big).\n$$\n数值上，$\\exp(-0.104)\\approx 0.901225301$，$1-\\exp(-0.0325)\\approx 0.0319775485$，以及 $1-\\exp(-0.117)\\approx 0.1104158$，所以\n$$\nL(H_{2})\\approx 0.901225301 \\times 0.0319775485 \\times 0.1104158 \\approx 3.18207041\\times 10^{-3}.\n$$\n\n似然比为\n$$\nR=\\frac{L(H_{1})}{L(H_{2})}\\approx \\frac{3.985227373\\times 10^{-4}}{3.18207041\\times 10^{-3}}\\approx 0.12524.\n$$\n四舍五入到三位有效数字，\n$$\nR\\approx 0.125.\n$$", "answer": "$$\\boxed{0.125}$$", "id": "1938660"}]}