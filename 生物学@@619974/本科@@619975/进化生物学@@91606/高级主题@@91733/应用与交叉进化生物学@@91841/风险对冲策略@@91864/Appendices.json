{"hands_on_practices": [{"introduction": "为什么演化会偏爱一个平均回报并非最高的策略？本练习通过比较一个波动环境中的两种繁殖策略，来探讨风险规避的核心概念。通过计算长期适应度，你将发现为什么当种群增长是跨代乘积过程时，几何平均数（geometric mean）而非算术平均数（arithmetic mean），才是决定生存的关键指标 [@problem_id:1911518]。", "problem": "一种假设的一年生植物物种 *Semen aleatorius*，生存在一个在“湿润”和“干燥”年份间可预测地波动的环境中，每种年份类型发生的概率均为50%。该植物是雌雄异株的，意味着其个体非雄即雌。亲本植株可以控制其产生种子的性别比。其子代的繁殖成效（以每个子代产生的存活孙代数量来衡量）取决于它们成熟年份的环境条件，具体如下：\n\n*   在**湿润年份**：雄性子代平均产生0.5个孙代。雌性子代平均产生2.0个孙代。\n*   在**干燥年份**：雄性子代平均产生5.0个孙代。雌性子代平均产生1.0个孙代。\n\n我们将比较亲本植株可以采用的两种不同繁殖策略：\n\n*   **策略A（“算术平均值最大化者”）:** 该策略只产生在湿润和干燥两种年份中具有更高算术平均繁殖成效的性别。\n*   **策略B（“风险对冲者”）:** 该策略产生相同数量的雄性和雌性子代（性别比为1:1）。\n\n在进化生物学中，一个谱系在波动环境中的长期适应度最好通过其跨代繁殖产出的几何平均值来衡量，而不是算术平均值，因为种群增长是一个乘法过程。\n\n计算策略B的长期适应度与策略A的长期适应度之比。将你的最终答案四舍五入到三位有效数字。", "solution": "设任何一代的环境为湿润的概率为 $0.5$，为干燥的概率为 $0.5$。设雄性子代的孙代产量为 $m_{W}=0.5$ 和 $m_{D}=5.0$，雌性子代的孙代产量为 $f_{W}=2.0$ 和 $f_{D}=1.0$。\n\n策略A只产生在不同环境中具有较高算术平均值的性别。计算算术平均值：\n$$\n\\bar{m}=\\frac{m_{W}+m_{D}}{2}=\\frac{0.5+5.0}{2}=2.75,\\quad\n\\bar{f}=\\frac{f_{W}+f_{D}}{2}=\\frac{2.0+1.0}{2}=1.5.\n$$\n由于 $\\bar{m}>\\bar{f}$，策略A只产生雄性子代。在湿润和干燥年份下，每代的繁殖倍率分别为\n$$\ng_{W}^{A}=m_{W}=0.5,\\quad g_{D}^{A}=m_{D}=5.0.\n$$\n由于环境等概率发生且种群增长是跨代累乘的，长期适应度是其几何平均值：\n$$\nG_{A}=\\sqrt{g_{W}^{A}g_{D}^{A}}=\\sqrt{0.5\\cdot 5.0}=\\sqrt{2.5}.\n$$\n\n策略B产生1:1的性别比。在给定的环境中，每个子代的期望孙代数是雄性和雌性产量的平均值：\n$$\ng_{W}^{B}=\\frac{m_{W}+f_{W}}{2}=\\frac{0.5+2.0}{2}=1.25,\\quad\ng_{D}^{B}=\\frac{m_{D}+f_{D}}{2}=\\frac{5.0+1.0}{2}=3.0.\n$$\n因此，长期适应度为\n$$\nG_{B}=\\sqrt{g_{W}^{B}g_{D}^{B}}=\\sqrt{1.25\\cdot 3.0}=\\sqrt{3.75}.\n$$\n\n所求的长期适应度之比为\n$$\nR=\\frac{G_{B}}{G_{A}}=\\frac{\\sqrt{3.75}}{\\sqrt{2.5}}=\\sqrt{\\frac{3.75}{2.5}}=\\sqrt{1.5}\\approx 1.224744871\\ldots\n$$\n四舍五入到三位有效数字，结果为 $1.22$。", "answer": "$$\\boxed{1.22}$$", "id": "1911518"}, {"introduction": "从种子到昆虫，许多生物在不可预测的环境中都面临着“何时行动”的关键决策。这个问题模拟了一个经典的风险规避场景：在提早萌发以获得高回报和推迟萌发以确保安全之间进行权衡。你将运用微积分来推导“急进型”与“谨慎型”个体的最佳比例，以最大化种群的长期适应度，从而揭示演化如何精确地进行风险管理 [@problem_id:1911548]。", "problem": "一种沙漠一年生植物进化出了一种风险对冲策略，以应对不可预测的环境。在任何一年，降雨模式可以是两种类型之一。“好”年，出现的概率为 $p$，雨季开始得早，生长周期长。“坏”年，出现的概率为 $1-p$，开始时会有一场短暂的、欺骗性的“假”雨，随后是致命的旱期，然后真正的雨季才姗姗来迟。\n\n该植物种群由两种遗传决定的、具有不同萌发策略的表型组成：\n1.  **“急切”萌发者**：这些种子在最初有水分迹象时就萌发。在“好”年，它们充分利用漫长的生长季节，产生大量的后代种子，数量为 $W_E$。在“坏”年，它们在假雨期间萌发，在能够繁殖之前就死亡，产生的种子数量为 0。\n2.  **“谨慎”萌发者**：这些种子需要更持续的湿润期才会萌发，导致它们开始生长的时间较晚。在“好”年，它们错过了生长季节的初期，产生中等数量的后代种子，数量为 $W_C$。在“坏”年，它们谨慎的策略使其能够忽略假雨，仅在真正的、较晚的雨季开始时才萌发，同样产生 $W_C$ 数量的种子。\n\n假设 $W_E > W_C > 0$。种群的长期成功取决于其跨年度几何平均适应度的最大化。考虑一个多态性种群，其中比例为 $x$ 的种子是“急切”萌发者，其余比例为 $1-x$ 的种子是“谨慎”萌发者。找出“急切”萌发者的最优比例 $x^*$，以最大化种群的长期几何平均适应度。假设环境参数使得一个稳定的多态性平衡（$0 < x^* < 1$）是最优解。请用 $p$、$W_E$ 和 $W_C$ 表示你的答案，给出一个封闭形式的解析表达式。", "solution": "设 $x$ 为“急切”萌发者种子的比例，$1-x$ 为“谨慎”萌发者种子的比例。在“好”年，人均繁殖产量为\n$$\nf_{G}(x) = x W_{E} + (1-x) W_{C} = W_{C} + x\\left(W_{E} - W_{C}\\right),\n$$\n在“坏”年，人均繁殖产量为\n$$\nf_{B}(x) = x \\cdot 0 + (1-x) W_{C} = (1-x) W_{C}.\n$$\n长期几何平均适应度通过最大化期望对数适应度来实现\n$$\nL(x) = p \\ln\\!\\left(f_{G}(x)\\right) + (1-p) \\ln\\!\\left(f_{B}(x)\\right).\n$$\n计算导数：\n$$\nL'(x) = p \\frac{f_{G}'(x)}{f_{G}(x)} + (1-p) \\frac{f_{B}'(x)}{f_{B}(x)}.\n$$\n使用 $f_{G}'(x) = W_{E} - W_{C}$ 和 $f_{B}'(x) = - W_{C}$ 可得\n$$\nL'(x) = p \\frac{W_{E} - W_{C}}{W_{C} + x\\left(W_{E} - W_{C}\\right)} - (1-p) \\frac{W_{C}}{(1-x) W_{C}}.\n$$\n令 $L'(x)=0$ 以求最优解：\n$$\np \\frac{W_{E} - W_{C}}{W_{C} + x\\left(W_{E} - W_{C}\\right)} = (1-p) \\frac{1}{1-x}.\n$$\n交叉相乘并利用 $W_{C}>0$ 进行化简，得到\n$$\np \\left(W_{E} - W_{C}\\right) (1-x) = (1-p)\\left(W_{C} + x\\left(W_{E} - W_{C}\\right)\\right).\n$$\n展开并合并同类项得到\n$$\n\\left(p W_{E} - W_{C}\\right) - \\left(W_{E} - W_{C}\\right) x = 0,\n$$\n因此最优比例是\n$$\nx^{*} = \\frac{p W_{E} - W_{C}}{W_{E} - W_{C}}.\n$$\n凹性得到保证，因为\n$$\nL''(x) = - p \\frac{\\left(W_{E} - W_{C}\\right)^{2}}{\\left(f_{G}(x)\\right)^{2}} - (1-p) \\frac{W_{C}^{2}}{\\left(f_{B}(x)\\right)^{2}} < 0,\n$$\n所以 $x^{*}$ 唯一地最大化了几何平均适应度。在所述的稳定多态性最优解的假设下，当 $p > W_{C}/W_{E}$ 且 $p < 1$ 时，$0 < x^{*} < 1$ 成立，这与 $W_{E} > W_{C} > 0$ 一致。", "answer": "$$\\boxed{\\frac{p W_{E} - W_{C}}{W_{E} - W_{C}}}$$", "id": "1911548"}, {"introduction": "风险规避原则的应用已经超越了自然生态系统，延伸至医学等领域。这个进阶问题模拟了肿瘤细胞群如何利用类似策略——维持增殖细胞和休眠细胞的混合——来对抗化疗。通过寻找休眠细胞的最佳比例，你不仅能练习建模技巧，还能深入理解癌症的演化韧性及其治疗为何充满挑战 [@problem_id:1911521]。", "problem": "一个肿瘤细胞群体表现出一种风险对冲策略以在化疗中存活。该群体由两种不同但可相互转换的表型组成：快速分裂、对药物敏感的增殖细胞（P细胞）和不分裂、对药物具有抗性的静止细胞（Q细胞）。\n\n细胞群体的动态在离散时间周期中进行建模。在每个周期开始时，群体会多样化，使得总细胞中比例为 $x$ 的部分采取静止表型，而剩余比例 $(1-x)$ 的部分采取增殖表型。\n\n在一个周期内，P细胞的数量乘以一个生长因子 $R > 1$。Q细胞不分裂，因此其数量实际上乘以因子 1。在此生长阶段之后，会发生一个随机的环境事件：以固定的概率 $p$ 进行化疗。\n\n如果进行化疗，所有P细胞都将被消灭（存活率为0）。Q细胞由于具有抗性，完全不受影响（存活率为1）。如果不进行化疗（概率为 $1-p$），两种表型的细胞都能存活下来，没有额外的死亡。\n\n由比例 $x$ 定义的给定策略的进化适应度，由该群体的长期几何平均增长率决定。你的任务是确定最佳的静止细胞比例 $x^*$，以使这个长期适应度最大化。\n\n以下哪个表达式用化疗概率 $p$ 和增殖生长因子 $R$ 正确地描述了最佳比例 $x^*$？\n\nA. $x^* = p$\n\nB. $x^* = \\frac{p}{R-1}$\n\nC. 如果 $p > 1 - \\frac{1}{R}$，则 $x^* = 1$；如果 $p \\le 1 - \\frac{1}{R}$，则 $x^*= \\frac{pR}{R-1}$\n\nD. $x^* = 1 - p$\n\nE. $x^* = \\frac{p(R-1)}{R}$\n\nF. $x^* = pR$", "solution": "令 $x \\in [0,1]$ 为每个周期选择的静止（Q）细胞的比例。在一个周期开始时，$(1-x)$ 的细胞是增殖（P）细胞， $x$ 是静止细胞。生长后，P细胞数量乘以 $R>1$，Q细胞数量乘以 $1$，所以在环境事件发生前，总数是 $R(1-x)N + xN$，其中 $N$ 是周期开始时种群数量。\n\n如果发生化疗（概率为 $p$），所有P细胞被消灭，只有Q细胞存活，产生的倍增因子为 $M_{\\text{chemo}}=x$。如果没有发生化疗（概率为 $1-p$），两种类型的细胞都存活，产生的倍增因子为 $M_{\\text{no chemo}}=x+R(1-x)=R-(R-1)x$。\n\n长期适应度是几何平均增长因子，因此我们最大化期望对数增长\n$$\nG(x)=p\\,\\ln(x)+(1-p)\\,\\ln\\!\\big(R-(R-1)x\\big),\n$$\n定义域为 $x \\in (0,1]$ （注意，因为 $R>1$，对于 $x \\in [0,1]$，有 $R-(R-1)x \\geq 1$）。\n\n计算导数并令其为零，以求得内部最优点：\n$$\nG'(x)=\\frac{p}{x}-(1-p)\\,\\frac{R-1}{R-(R-1)x}=0.\n$$\n解出 $x$ 可得\n$$\n\\frac{p}{x}=\\frac{(1-p)(R-1)}{R-(R-1)x}\n\\;\\;\\Longrightarrow\\;\\;\np\\big(R-(R-1)x\\big)=x(1-p)(R-1),\n$$\n$$\npR=p(R-1)x+x(1-p)(R-1)=x(R-1)\\big(p+1-p\\big)=x(R-1),\n$$\n$$\nx^{*}=\\frac{pR}{R-1}.\n$$\n二阶导数\n$$\nG''(x)=-\\frac{p}{x^{2}}-(1-p)\\,\\frac{(R-1)^{2}}{\\big(R-(R-1)x\\big)^{2}}<0\n$$\n表明 $G$ 是一个严格凹函数，因此最大值点要么是这个位于 $[0,1]$ 区间内的临界点，要么是一个边界点。条件 $x^{*}\\leq 1$ 为\n$$\n\\frac{pR}{R-1}\\leq 1\n\\;\\;\\Longleftrightarrow\\;\\;\np\\leq \\frac{R-1}{R}=1-\\frac{1}{R}.\n$$\n因此，\n- 如果 $p \\leq 1-\\frac{1}{R}$，内部最优点 $x^{*}=\\frac{pR}{R-1}$ 位于 $[0,1]$ 区间内，是最佳解。\n- 如果 $p>1-\\frac{1}{R}$，内部临界点超过1，因此最优点在边界 $x^{*}=1$ 处。\n\n这与选项C相符。", "answer": "$$\\boxed{C}$$", "id": "1911521"}]}