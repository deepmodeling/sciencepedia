{"hands_on_practices": [{"introduction": "选择梯度是量化遗传学中的一个关键工具，它将生态学数据与进化预测联系起来。本练习提供了一个直接的实践机会，让您能够根据实际的摘要统计数据计算选择梯度。通过处理性状与相对适应度之间的协方差（covariance）以及性状的方差（variance），您将练习在线性选择梯度的经验研究中使用的基本定义。", "problem": "一位田野生物学家正在研究一个高山野花种群，以了解其对气候变暖的演化响应。其中一个关键的适应性状是开花时间，以从春季开始到第一朵花开放的天数来衡量。在为期五年的研究期间，这位生物学家严谨细致地记录了数百株个体植物的开花时间以及它们产生的可存活种子总数。根据这些数据，他们通过将每株植物的种子数除以当年整个种群的平均种子数，计算出每株植物的相对适合度。\n\n随后的统计分析揭示了两个关键的种群参数。首先，开花时间的表型方差为12.0平方天。其次，开花时间与相对适合度之间的协方差被确定为-2.40天。\n\n利用这些信息，计算该植物种群开花时间的线性选择梯度（$\\beta$）。答案以天⁻¹为单位表示，并四舍五入至三位有效数字。", "solution": "令 $z$ 表示开花时间，$w$ 表示相对适合度（无量纲）。根据 Lande–Arnold 框架，选择差为 $S=\\operatorname{Cov}(z,w)$，表型方差为 $P=\\operatorname{Var}(z)$。线性选择梯度由下式给出：\n$$\n\\beta = P^{-1} S.\n$$\n对于单个性状，该公式简化为\n$$\n\\beta = \\frac{\\operatorname{Cov}(z,w)}{\\operatorname{Var}(z)}.\n$$\n代入给定值，\n$$\n\\beta = \\frac{-2.40}{12.0} = -0.200,\n$$\n其单位为天⁻¹，因为 $\\operatorname{Cov}(z,w)$ 的单位是天，而 $\\operatorname{Var}(z)$ 的单位是平方天。四舍五入至三位有效数字，其值为 $-0.200$。", "answer": "$$\\boxed{-0.200}$$", "id": "1961577"}, {"introduction": "理解选择梯度衡量的是什么——以及它不能衡量什么——对于正确解读至关重要。这个思想实验探讨了一个分裂选择（disruptive selection）的场景，在这种情况下，如果孤立地解释线性选择梯度，可能会产生误导。通过思考一个非线性的适应度景观，您将深化对线性梯度 $\\beta$ 为何特异性地量化定向选择，而可能无法捕捉自然选择全貌的理解。", "problem": "一位演化生物学家正在研究一个使用放电器官放电（Electric Organ Discharges, EODs）进行交流的弱电鱼种群。研究关注的表型是EOD的主导频率 $f$。该种群的平均EOD频率为 $\\bar{f}$。当地的生态环境对这一性状施加了强烈的分裂选择（disruptive selection）：EOD频率接近平均值的鱼会遭受同种个体的信号干扰，导致交配成功率降低和被捕食率增高。因此，频率远高于或远低于 $\\bar{f}$ 的鱼具有更高的相对适应度。频率表型 $f$ 与相对适应度 $w(f)$ 之间的关系可以用一个在 $f = \\bar{f}$ 处取得最小值的对称U形函数很好地描述。\n\n一位研究人员由于其设备的探测带宽限制，只能在以种群平均值为中心的狭窄对称频率范围内对鱼进行取样和测量，具体来说，就是满足 $|f - \\bar{f}| \\le \\Delta f$ 的个体，其中 $\\Delta f$ 为某个小的常数。研究人员根据这个有偏的表型样本及其相关的适应度，计算了标准化线性选择梯度 $\\beta$。该梯度在形式上是标准化性状与相对适应度之间的协方差，等价于相对适应度对性状值进行线性回归所得的最佳拟合线的斜率。\n\n假设研究人员的样本在这个狭窄的观察窗口内是种群的完美代表，那么下列哪个陈述最能描述他们将计算出的线性选择梯度 $\\beta$ 的值？\n\nA. 显著为正 ($\\beta > 0$)\n\nB. 显著为负 ($\\beta < 0$)\n\nC. 约等于零 ($\\beta \\approx 0$)\n\nD. 不确定；其符号取决于取样窗口的确切宽度 $2\\Delta f$。\n\nE. 无定义，因为潜在的适应度-表型关系是非线性的。", "solution": "令 $x \\equiv f - \\bar{f}$ 表示与平均值的偏差，并假设研究人员只观察 $|x| \\le \\Delta f$ 的个体。适应度函数是对称的U形函数，在 $x=0$ 处有最小值，因此 $w(x)$ 是一个偶函数，满足 $w(-x)=w(x)$ 且 $w^{\\prime}(0)=0$。在 $x=0$ 附近进行泰勒展开得到\n$$\nw(x) \\;=\\; c_{0} \\;+\\; c_{2} x^{2} \\;+\\; c_{4} x^{4} \\;+\\; \\cdots,\n$$\n不含奇次幂项。\n\n标准化线性选择梯度 $\\beta$ 是相对适应度对标准化性状进行线性回归得到的斜率。将标准化性状写作 $z=(x-\\mu_{x})/\\sigma_{x}$ （其中期望是在 $|x|\\le \\Delta f$ 的样本上计算的），回归斜率为\n$$\n\\beta \\;=\\; \\frac{\\operatorname{Cov}(z,w)}{\\operatorname{Var}(z)} \\;=\\; \\operatorname{Cov}(z,w),\n$$\n因为根据定义 $\\operatorname{Var}(z)=1$。由于 $z$ 是 $x$ 的仿射函数，$\\beta$ 的符号（以及是否为零）与 $\\operatorname{Cov}(x,w)$ 的符号相同：\n$$\n\\operatorname{Cov}(z,w) \\;=\\; \\frac{1}{\\sigma_{x}}\\,\\operatorname{Cov}(x,w).\n$$\n\n现在计算在对称窗口上的 $\\operatorname{Cov}(x,w)$。令 $s(x)$ 表示在 $[-\\Delta f,\\Delta f]$ 上的取样/加权密度。问题陈述样本在该对称窗口内是种群的完美代表，且窗口以均值为中心；这意味着 $s(x)=s(-x)$（关于0对称），因此 $E[x]=0$。那么\n$$\n\\operatorname{Cov}(x,w) \\;=\\; E[x\\,w(x)] - E[x]\\,E[w(x)] \\;=\\; E[x\\,w(x)],\n$$\n并且\n$$\nE[x\\,w(x)] \\;=\\; \\int_{-\\Delta f}^{\\Delta f} x\\,w(x)\\,s(x)\\,dx.\n$$\n因为 $w(x)$ 是偶函数，$s(x)$ 也是偶函数，所以被积函数 $x\\,w(x)\\,s(x)$ 是 $x$ 的奇函数，因此其在对称区间上的积分为零：\n$$\n\\int_{-\\Delta f}^{\\Delta f} x\\,w(x)\\,s(x)\\,dx \\;=\\; 0.\n$$\n因此 $\\operatorname{Cov}(x,w)=0$，这意味着 $\\operatorname{Cov}(z,w)=0$，所以\n$$\n\\beta \\;=\\; 0.\n$$\n\n换句话说：在对称U形函数的最小值附近，线性项消失，因此在任何以均值为中心的对称、代表性窗口上，最佳线性拟合的斜率为零。有限样本的噪声可能会使得经验估计值非常接近零，但并非恰好为零，因此是“约等于零”。\n\n这排除了A和B。D是错误的，因为鉴于对称性，斜率的符号不随窗口宽度的变化而改变；它始终为零。E是错误的，因为即使真实关系是非线性的，线性回归的斜率也是有明确定义的。\n\n因此，最佳描述是“约等于零”。", "answer": "$$\\boxed{C}$$", "id": "1961574"}, {"introduction": "除了分析现有数据，进化生物学家还经常构建数学模型，以理解相互竞争的选择压力如何塑造一个性状。本练习要求您从一个模拟生存与繁殖之间经典生活史权衡（life-history trade-off）的适应度函数 $W(z)$ 中，推导出选择梯度。这项实践将锻炼您运用微积分将生物学原理转化为定量进化预测的能力。", "problem": "考虑一个一年生植物种群，其受选择的关键生活史性状是萌发日，记为 $z$，单位为从潜在生长季开始算起的天数。单个植物的适合度 $W(z)$ 由存活与繁殖之间的相互作用决定。\n\n植物存活至成熟的概率取决于其萌发时间。较早萌发的植物面临因晚季霜冻而死亡的更高风险。在第 $z$ 天萌发的植物的存活概率 $S(z)$ 由函数 $S(z) = 1 - \\exp(-z/\\tau_f)$ 建模，其中 $\\tau_f$ 是一个正常数，代表霜冻风险减弱的特征时间尺度。\n\n植物的繁殖产出（繁殖力）$F(z)$ 由其总生长量决定，而延迟萌发会对总生长量产生负面影响。提早萌发能提供竞争优势和更长的生长期。这种关系被建模为繁殖力随萌发日线性下降：$F(z) = F_{max} - c_1 z$，其中 $F_{max}$ 是在 $z=0$ 时萌发的植物的最大潜在繁殖力，$c_1$ 是一个代表延迟萌发每日成本的正常数。假设对于所有相关的萌发时间，都有 $F_{max} - c_1 z > 0$。\n\n单个个体的总适合度是其存活概率与繁殖力的乘积，即 $W(z) = S(z) \\cdot F(z)$。\n\n选择梯度 $\\beta$ 量化了作用于某一性状的定向选择的强度和方向。其定义为相对适合度对性状的导数，并在种群平均性状值处求值。在数学上，$\\beta = \\frac{1}{\\bar{W}} \\frac{dW(z)}{dz} \\Big|_{z=\\bar{z}}$，其中 $\\bar{z}$ 是种群当前的平均萌发日，而 $\\bar{W} = W(\\bar{z})$ 是种群的平均适合度。\n\n请用 $\\bar{z}$、$\\tau_f$、$F_{max}$ 和 $c_1$ 推导出该种群中选择梯度 $\\beta$ 的一个闭式解析表达式。", "solution": "我们从给定的存活函数和繁殖力函数开始：\n$$\nS(z) = 1 - \\exp\\left(-\\frac{z}{\\tau_{f}}\\right), \\quad F(z) = F_{max} - c_{1} z.\n$$\n总适合度是存活率和繁殖力的乘积：\n$$\nW(z) = S(z) F(z) = \\left(1 - \\exp\\left(-\\frac{z}{\\tau_{f}}\\right)\\right)\\left(F_{max} - c_{1} z\\right).\n$$\n选择梯度的定义为\n$$\n\\beta = \\frac{1}{\\bar{W}} \\frac{dW(z)}{dz}\\Big|_{z=\\bar{z}}, \\quad \\text{且} \\quad \\bar{W} = W(\\bar{z}).\n$$\n计算所需的导数。首先，\n$$\nS'(z) = \\frac{d}{dz}\\left(1 - \\exp\\left(-\\frac{z}{\\tau_{f}}\\right)\\right) = \\frac{1}{\\tau_{f}} \\exp\\left(-\\frac{z}{\\tau_{f}}\\right),\n$$\n以及\n$$\nF'(z) = \\frac{d}{dz}\\left(F_{max} - c_{1} z\\right) = -c_{1}.\n$$\n对 $W(z) = S(z)F(z)$ 使用乘法法则，\n$$\n\\frac{dW}{dz} = S'(z) F(z) + S(z) F'(z) = \\frac{1}{\\tau_{f}} \\exp\\left(-\\frac{z}{\\tau_{f}}\\right)\\left(F_{max} - c_{1} z\\right) - c_{1}\\left(1 - \\exp\\left(-\\frac{z}{\\tau_{f}}\\right)\\right).\n$$\n在 $z=\\bar{z}$ 处求值：\n$$\n\\left.\\frac{dW}{dz}\\right|_{z=\\bar{z}} = \\frac{1}{\\tau_{f}} \\exp\\left(-\\frac{\\bar{z}}{\\tau_{f}}\\right)\\left(F_{max} - c_{1} \\bar{z}\\right) - c_{1}\\left(1 - \\exp\\left(-\\frac{\\bar{z}}{\\tau_{f}}\\right)\\right).\n$$\n平均适合度为\n$$\n\\bar{W} = W(\\bar{z}) = \\left(1 - \\exp\\left(-\\frac{\\bar{z}}{\\tau_{f}}\\right)\\right)\\left(F_{max} - c_{1} \\bar{z}\\right).\n$$\n因此，\n$$\n\\beta = \\frac{\\frac{1}{\\tau_{f}} \\exp\\left(-\\frac{\\bar{z}}{\\tau_{f}}\\right)\\left(F_{max} - c_{1} \\bar{z}\\right) - c_{1}\\left(1 - \\exp\\left(-\\frac{\\bar{z}}{\\tau_{f}}\\right)\\right)}{\\left(1 - \\exp\\left(-\\frac{\\bar{z}}{\\tau_{f}}\\right)\\right)\\left(F_{max} - c_{1} \\bar{z}\\right)}.\n$$\n通过拆分分数进行化简：\n$$\n\\beta = \\frac{\\exp\\left(-\\frac{\\bar{z}}{\\tau_{f}}\\right)}{\\tau_{f}\\left(1 - \\exp\\left(-\\frac{\\bar{z}}{\\tau_{f}}\\right)\\right)} - \\frac{c_{1}}{F_{max} - c_{1} \\bar{z}}.\n$$\n使用恒等式 $\\frac{\\exp\\left(-x\\right)}{1 - \\exp\\left(-x\\right)} = \\frac{1}{\\exp\\left(x\\right) - 1}$，并令 $x = \\bar{z}/\\tau_{f}$，我们得到一个等价的紧凑形式：\n$$\n\\beta = \\frac{1}{\\tau_{f}\\left(\\exp\\left(\\frac{\\bar{z}}{\\tau_{f}}\\right) - 1\\right)} - \\frac{c_{1}}{F_{max} - c_{1} \\bar{z}}.\n$$\n这就是所求的选择梯度的闭式解析表达式。", "answer": "$$\\boxed{\\frac{1}{\\tau_{f}\\left(\\exp\\left(\\frac{\\bar{z}}{\\tau_{f}}\\right)-1\\right)}-\\frac{c_{1}}{F_{max}-c_{1}\\bar{z}}}$$", "id": "1961560"}]}