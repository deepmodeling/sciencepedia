{"hands_on_practices": [{"introduction": "这个练习将引导你运用最大简约法 (maximum parsimony) —— 一种最直观的系统发育比较方法 —— 来重建祖先的性状状态。通过在系统发育树上追踪一个离散性状（例如花色），你可以推断出已灭绝祖先的性状，并量化其演化历史。这个实践将帮助你掌握简约法推断的核心逻辑，即通过最小化性状演化改变的次数来寻找最简洁的演化路径 [@problem_id:1761335]。", "problem": "一位植物学家正在研究一个由五个假想植物物种（*Floris aenigma*、*Floris bardi*、*Floris caeruleus*、*Floris duo*和*Floris electra*）组成的小分支中的花色演化历史。根据分子数据，这些物种的系统发育关系已经明确确立。物种*F. aenigma*和*F. bardi*是姐妹群，形成一个独特的谱系。物种*F. duo*和*F. electra*也是姐妹群。包含*F. duo*和*F. electra*的分支又是*F. caeruleus*的姐妹群。最后，包含*F. aenigma*和*F. bardi*的谱系是包含*F. caeruleus*、*F. duo*和*F. electra*的谱系的姐妹群。\n\n这五个现存物种的花色观察结果如下：\n- *F. aenigma*：蓝色\n- *F. bardi*：红色\n- *F. caeruleus*：蓝色\n- *F. duo*：红色\n- *F. electra*：红色\n\n使用最大简约法原则，确定基部节点（所有五个物种的共同祖先）上花色（蓝色或红色）最可能的祖先状态，以及所需的最小演化改变次数（从蓝色到红色或从红色到蓝色的状态转换）。下列哪个陈述准确地描述了这一重建结果？\n\nA. 祖先状态明确为蓝色，总共有2次演化改变。\n\nB. 祖先状态明确为红色，总共有2次演化改变。\n\nC. 祖先状态不明确（可能为蓝色或红色），总共有2次演化改变。\n\nD. 祖先状态明确为蓝色，总共有3次演化改变。\n\nE. 祖先状态不明确（可能为蓝色或红色），总共有3次演化改变。\n\nF. 根据现有信息无法进行重建。", "solution": "该问题要求使用最大简约法原则，在一个给定的系统发育树上对花色的祖先状态进行重建，确定基部节点的状态。该原则指出，最优的演化假说是需要最少演化改变次数的那个。我们可以使用一种两遍扫描算法来解决这个问题，该算法通常被称为Fitch算法。\n\n首先，让我们来表示系统发育树和性状状态。我们可以用物种的首字母来表示它们：A (*F. aenigma*)、B (*F. bardi*)、C (*F. caeruleus*)、D (*F. duo*) 和 E (*F. electra*)。状态为蓝色 (L) 和红色 (R)。\n在树的末端观察到的状态是：A=L, B=R, C=L, D=R, E=R。\n\n系统发育树的文字描述对应于括号表示法 ((A, B), (C, (D, E)))。我们来标记一下内部节点：\n- `N1`：D和E的最近共同祖先。\n- `N2`：C、D和E的最近共同祖先（即C和`N1`的共同祖先）。\n- `N3`：A和B的最近共同祖先。\n- `N4`：基部节点，所有五个物种的最近共同祖先（即`N2`和`N3`的共同祖先）。\n\n**第一遍：自下而上分配状态集**\n在这一遍中，我们从树的末端（叶节点）向上工作到根节点（`N4`），为每个内部节点分配一个可能的状态集。我们还计算总的改变次数（简约分数）。\n\n从两个子节点确定父节点状态集的规则如下：\n- 如果子节点的状态集存在非空交集，则父节点的状态集就是这个交集。\n- 如果子节点的状态集交集为空，则父节点的状态集是它们的并集。在这种情况下，我们将演化改变次数的计数器加一。\n\n让我们应用这个规则：\n\n1.  **节点`N1`（D和E的祖先）：**\n    -   子节点D的状态集为{R}。\n    -   子节点E的状态集为{R}。\n    -   {R}和{R}的交集是{R}。\n    -   因此，`N1`的状态集是{R}。\n    -   交集非空，所以改变次数增加0。\n\n2.  **节点`N3`（A和B的祖先）：**\n    -   子节点A的状态集为{L}。\n    -   子节点B的状态集为{R}。\n    -   {L}和{R}的交集为空。\n    -   并集是{L, R}。因此，`N3`的状态集是{L, R}。\n    -   交集为空，所以我们增加改变次数：分数 = 1。\n\n3.  **节点`N2`（C和`N1`的祖先）：**\n    -   子节点C的状态集为{L}。\n    -   子节点`N1`的状态集为{R}。\n    -   {L}和{R}的交集为空。\n    -   并集是{L, R}。因此，`N2`的状态集是{L, R}。\n    -   交集为空，所以我们增加改变次数：分数 = 1 + 1 = 2。\n\n4.  **节点`N4`（基部节点，`N2`和`N3`的祖先）：**\n    -   子节点`N2`的状态集为{L, R}。\n    -   子节点`N3`的状态集为{L, R}。\n    -   {L, R}和{L, R}的交集是{L, R}。\n    -   因此，`N4`的状态集是{L, R}。\n    -   交集非空，所以改变次数增加0。\n\n在第一遍结束时，最小演化改变总次数（简约分数）为2。基部节点`N4`的状态集为{L, R}。\n\n**第二遍：自上而下分配最终状态**\n基部节点`N4`的状态集{L, R}表明祖先状态是不明确的。蓝色(L)或红色(R)都可能是祖先状态，并且两者都会导致相同的总改变次数(2)。让我们来验证这一点。\n\n自上而下扫描的规则是：\n- 如果一个子节点的状态集包含其父节点被赋予的状态，那么该子节点就被赋予那个状态。\n- 如果一个子节点的状态集不包含其父节点的状态，我们可以从该子节点的状态集中选择任何一个状态。这会强制在通往该子节点的分支上发生一次改变。\n\n**情景1：假设基部节点`N4`为蓝色(L)。**\n- `N4` = L。\n- `N3` 的状态集为 {L, R}。它包含L，所以我们指定 `N3` = L。\n- `N2` 的状态集为 {L, R}。它包含L，所以我们指定 `N2` = L。\n- 现在我们看这些节点的子节点：\n    - 从 `N3`=L：A是L（无改变），B是R（1次改变）。\n    - 从 `N2`=L：C是L（无改变），`N1` 必须被分配一个状态。`N1` 的状态集是 {R}，不包含L。所以我们从它的集合中为 `N1` 分配一个状态，`N1`=R。这要求在从 `N2` 到 `N1` 的分支上发生1次改变。\n- 此情景的总改变次数：1（对于B） + 1（对于`N1`） = 2。\n\n**情景2：假设基部节点`N4`为红色(R)。**\n- `N4` = R。\n- `N3` 的状态集为 {L, R}。它包含R，所以我们指定 `N3` = R。\n- `N2` 的状态集为 {L, R}。它包含R，所以我们指定 `N2` = R。\n- 现在我们看这些节点的子节点：\n    - 从 `N3`=R：A是L（1次改变），B是R（无改变）。\n    - 从 `N2`=R：C是L（1次改变），`N1` 的状态集是 {R}，它包含R。所以我们指定 `N1`=R（无改变）。\n- 此情景的总改变次数：1（对于A） + 1（对于C） = 2。\n\n两种情景都导致总共2次改变，这是我们在第一遍中计算出的最小可能分数。由于蓝色和红色对于基部节点的状态都是同样简约的选择，因此祖先状态是不明确的。\n\n因此，该重建需要至少2次演化改变，且基部节点的祖先状态不明确（可能为蓝色或红色）。这对应于选项C。", "answer": "$$\\boxed{C}$$", "id": "1761335"}, {"introduction": "在分析连续性状的演化时，我们不能简单地将亲缘关系相近的物种视为独立的统计样本，因为它们共享了部分演化历史。本练习将介绍 Felsenstein 提出的系统发育独立比较法 (Phylogenetically Independent Contrasts, PIC)，这是一种解决物种间数据非独立性问题的经典方法。通过亲手完成计算步骤，你将理解如何将物种的性状数据转化为一组统计上独立的数值，每一个数值都代表了一次独立的演化分歧事件 [@problem_id:1761373]。", "problem": "一位演化生物学家正在研究一小组圣甲虫的体型演化。她为三个物种构建了系统发育树，并收集了它们的体型数据：*Rhinoceps ferox*、*Goliathus parvus* 和 *Chalcosoma medius*。系统发育关系如下：*R. ferox* 和 *G. parvus* 是姐妹种，它们的共同祖先与 *C. medius* 构成姐妹群。\n\n代表演化时间（单位：百万年，Myr）的枝长如下：\n- 从 *R. ferox* 和 *G. parvus* 的共同祖先到现今 *R. ferox* 的枝长为 2 Myr。\n- 从 *R. ferox* 和 *G. parvus* 的共同祖先到现今 *G. parvus* 的枝长为 2 Myr。\n- 从这三个物种的系统发育树的根节点到 *R. ferox* 和 *G. parvus* 的共同祖先的枝长为 3 Myr。\n- 从该树的根节点到现今 *C. medius* 的枝长为 5 Myr。\n\n这些物种的成年平均体长为：\n- *Rhinoceps ferox*: 45.5 mm\n- *Goliathus parvus*: 52.1 mm\n- *Chalcosoma medius*: 38.0 mm\n\n为了进行比较分析，必须计算体长这一性状的系统发育独立对比值。使用该方法的标准算法，计算在这三个物种的系统发育树的根节点处计算出的独立对比的数值。假设性状演化遵循布朗运动模型。将你的答案四舍五入到三位有效数字。", "solution": "该问题要求计算一个三物种系统发育树根节点的系统发育独立对比值。我们将使用 Felsenstein 的算法，该算法从树的末端向根节点进行计算。\n\n为清晰起见，我们用符号表示物种、它们的性状和枝长。\n设物种 A 为 *Rhinoceps ferox*，物种 B 为 *Goliathus parvus*，物种 C 为 *Chalcosoma medius*。\n性状值（体长）如下：\n$x_A = 45.5$ mm\n$x_B = 52.1$ mm\n$x_C = 38.0$ mm\n\n枝长如下：\n- 通向 A 的末端枝长，$v_A = 2$ Myr。\n- 通向 B 的末端枝长，$v_B = 2$ Myr。\n- 通向 C 的末端枝长，$v_C = 5$ Myr。\n- 通向 A 和 B 共同祖先（我们称之为节点1）的内枝，其长度为 $v_{1, \\text{stem}} = 3$ Myr。\n\n对于这棵树，该算法包括两个主要部分：首先，计算姐妹种 A 和 B 之间的对比值，并估计它们共同祖先（节点1）的状态；其次，计算节点1和物种 C 之间的对比值。\n\n**步骤 1：计算姐妹种 A 和 B 之间的对比值。**\n第一个独立对比值 $C_1$ 是 A 和 B 之间性状值的差异，通过它们枝长之和的平方根进行标准化。减法的顺序是任意的；我们将计算 $x_B - x_A$。\n$$\nC_1 = \\frac{x_B - x_A}{\\sqrt{v_A + v_B}}\n$$\n代入数值：\n$$\nC_1 = \\frac{52.1 - 45.5}{\\sqrt{2 + 2}} = \\frac{6.6}{\\sqrt{4}} = \\frac{6.6}{2} = 3.3\n$$\n\n**步骤 2：估计共同祖先（节点1）的性状值。**\n节点1的性状值 $x_1$ 是其后代性状值的加权平均值，权重为各自枝长的倒数。\n$$\nx_1 = \\frac{\\frac{1}{v_A}x_A + \\frac{1}{v_B}x_B}{\\frac{1}{v_A} + \\frac{1}{v_B}}\n$$\n由于 $v_A = v_B = 2$，这简化为算术平均值：\n$$\nx_1 = \\frac{x_A + x_B}{2} = \\frac{45.5 + 52.1}{2} = \\frac{97.6}{2} = 48.8\n$$\n因此，节点1处祖先的估计体长为 48.8 mm。\n\n**步骤 3：更新节点1的枝长。**\n在下一步计算中，节点1现在被视为一个末端。其枝长需要进行调整，以考虑步骤2中估计引入的方差。新的枝长 $v'_1$ 是其原始干枝（stem branch）的长度加上一个与其后代分枝长度相关的项。\n$$\nv'_1 = v_{1, \\text{stem}} + \\frac{v_A v_B}{v_A + v_B}\n$$\n代入数值：\n$$\nv'_1 = 3 + \\frac{2 \\times 2}{2 + 2} = 3 + \\frac{4}{4} = 3 + 1 = 4\n$$\n节点1调整后的枝长为 4 Myr。\n\n**步骤 4：计算根节点的对比值。**\n最后一步是计算树根节点的对比值。这个对比值 $C_{\\text{root}}$ 是在新表征的节点1和剩余物种 C 之间计算的。我们使用它们各自的性状值（$x_1$ 和 $x_C$）和枝长（$v'_1$ 和 $v_C$）。\n$$\nC_{\\text{root}} = \\frac{x_1 - x_C}{\\sqrt{v'_1 + v_C}}\n$$\n代入计算出的和给定的数值：\n$$\nC_{\\text{root}} = \\frac{48.8 - 38.0}{\\sqrt{4 + 5}} = \\frac{10.8}{\\sqrt{9}} = \\frac{10.8}{3} = 3.6\n$$\n在根节点计算出的独立对比值为 3.6。\n\n**步骤 5：最终四舍五入。**\n问题要求答案四舍五入到三位有效数字。计算值为 3.6，表示为三位有效数字是 3.60。", "answer": "$$\\boxed{3.60}$$", "id": "1761373"}, {"introduction": "当标准统计检验与考虑了系统发育关系的检验得出截然不同的结论时，我们该如何解读？这个思想实验探讨了系统发育广义最小二乘法 (Phylogenetic Generalized Least Squares, PGLS) 的关键作用，揭示它如何发掘那些被强大系统发育信号所掩盖的性状关联。通过分析这一案例，你将学会如何解读看似矛盾的结果，并理解深层的演化历史是如何塑造我们今天所观察到的性状间关系的 [@problem_id:1953885]。", "problem": "一位进化生物学家正在研究一个由50种蜥蜴组成的演化支中两个连续性状之间的关系：前臂长度（性状X）和攀爬速度（性状Y）。她假设较长的前臂可能提供生物力学上的优势，从而导致更快的攀爬速度。为了检验这一假设，她对数据进行了两种不同的统计分析。\n\n首先，她进行了一次标准的普通最小二乘法（OLS）回归，该分析将50个物种中的每一个都视为独立的数据点。该分析未能发现前臂长度与攀爬速度之间存在统计学上显著的关系（p > 0.05）。\n\n其次，由于担心物种因共同祖先而非独立，她进行了一次系统发育广义最小二乘法（PGLS）回归。这种方法与OLS类似，但它整合了50种蜥蜴的进化树（系统发育），以解释亲缘关系较近的物种预期会彼此更相似这一事实。PGLS分析揭示了前臂长度与攀爬速度之间存在高度显著的正相关关系（p < 0.01）。\n\n鉴于这些相互矛盾的结果，以下哪项陈述提供了最合理的进化解释？\n\nA. PGLS的结果是一个统计学假象（假阳性），因为添加系统发育信息人为地夸大了性状之间的相关性。做出较少假设的OLS结果应被认为更可靠。\n\nB. 前臂长度与攀爬速度之间的关系在整个系统发育过程中进化得非常迅速并呈趋同性。许多独立的谱系独立地进化出了性状间的相似关系。\n\nC. 显著的相关性主要是由少数古老的进化事件驱动的。例如，一个早期的祖先可能进化出了长前臂和快的攀爬速度，其众多后代继承了这种组合，而另一个主要谱系则保留了短前臂和慢的攀爬速度。这造成了性状值的大尺度系统发育聚类，而OLS分析忽略了这一点。\n\nD. OLS的结果是一个假阴性。PGLS方法仅仅是一种在统计上更具功效的检验，因此无论进化模式如何，它都更有可能检测到任何真实的相关性。", "solution": "目标是理解当非系统发育回归显示无显著相关性，而系统发育回归显示有显著相关性时，可以推断出什么。这个情景考验了对系统发育信号及其对性状相关性分析影响的核心概念的理解。\n\n让我们分解这两种分析：\n1.  **普通最小二乘法（OLS）回归：** 这种标准的统计方法假设所有数据点都是独立同分布的。当应用于物种数据时，它实际上忽略了它们共享的进化历史。\n2.  **系统发育广义最小二乘法（PGLS）回归：** 这种方法根据物种共享的进化历史（系统发育）明确地对其预期的协方差进行建模。它校正了亲缘关系较近的物种并非独立观察值这一事实。\n\n关键的观察结果是两者之间的差异：\n- OLS（忽略系统发育）：无显著相关性。\n- PGLS（考虑系统发育）：显著的正相关性。\n\n让我们基于这一差异来评估各个选项：\n\n**A. PGLS的结果是一个统计学假象...OLS结果...应被认为更可靠。**\n这是不正确的。OLS回归中数据点独立性的基本假设在处理物种数据时被违反了。物种是分支进化过程的产物，因此它们并非独立的。PGLS正是为了纠正这种特定的违反而设计的，这使其结果在比较性研究的背景下更可靠，而不是更不可靠。当系统发育存在时忽略它可能导致不正确的推断和膨胀的I型错误率（假阳性），但它也可能掩盖真实的模式，导致II型错误（假阴性），正如本问题所示。\n\n**B. 前臂长度和攀爬速度之间的关系正在非常迅速且趋同地进化...**\n这描述了一个情景，即相关性在进化树上反复且独立地出现。如果许多谱系都在独立地进化出更长的前臂和更快的攀爬速度，那么即使在OLS框架下，这些独立事件也会为相关性提供强有力的统计证据。在这种“高度趋同”的情景中，我们预期OLS也会发现一个显著的结果，而且可能是一个非常强的结果。既然OLS*没有*发现显著结果，这种解释就不太可能。\n\n**C. 显著的相关性主要由少数古老的进化事件驱动...**\n这是最合理的解释。想象一下这些蜥蜴的进化树。假设在它们历史的早期，该谱系分裂成两个主要演化支。在一个演化支中，一个关键的祖先进化出了长前臂和相应的快速攀爬速度；它的所有后代（比如25个物种）都继承了这一性状组合。在另一个主要演化支中，短前臂和慢速的祖先状态被保留下来，它的25个后代继承了该组合。\n\n从OLS的角度来看，它将所有50个物种视为散点图上的独立点，你会看到两团点：一簇是低X和低Y值的点，另一簇是高X和高Y值的点。在每一簇内部，可能没有明显的趋势，因此跨越所有50个点的总体回归线可能是平坦且不显著的。OLS分析之所以失败，是因为变异不是随机分布的，而是由系统发育结构化的。\n\nPGLS分析正确地识别出主要的“事件”是这两个大演化支之间的转变。它正确地将相关性归因于这一深层的进化历史，揭示了被系统发育惯性（相关物种倾向于彼此相似的趋势）所掩盖的潜在正相关关系。因此，这两种检验之间的差异直接指向数据中存在强烈的系统发育信号，其中相关性是由主要的、古老的转变建立的，而不是由许多小的、独立的转变建立的。\n\n**D. OLS的结果是假阴性。PGLS方法仅仅是一种在统计上更具功效的检验...**\n这是一种过度简化，并可能具有误导性。虽然PGLS有时可以提高统计功效，但它并非在所有情况下都比OLS“更具功效”。其主要功能是为数据中的误差结构提供一个*正确*的模型。事实上，如果OLS回归显示了一个完全由系统发育结构（例如，两个不相关的演化支恰好在两种性状上都存在差异）造成的假象性显著结果，PGLS分析可以在考虑系统发育后正确地显示相关性*不*显著。如果一个检验的基本假设被违反，那么它的功效是无关紧要的。关键在于PGLS正确地模拟了进化过程，而在本例中，那个正确的模型揭示了不正确的OLS模型所忽略的模式。选项C中的解释更精确地说明了导致这种统计结果的特定进化模式。\n\n因此，最准确的解释是相关性是真实的，但它是系统发育结构化的，源于进化树深处的重大转变。", "answer": "$$\\boxed{C}$$", "id": "1953885"}]}