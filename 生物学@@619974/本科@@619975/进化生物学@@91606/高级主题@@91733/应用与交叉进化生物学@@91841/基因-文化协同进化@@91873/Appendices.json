{"hands_on_practices": [{"introduction": "本练习提供了一个基因-文化协同演化的基础场景。我们将探讨一个根深蒂固的文化传统——例如季节性斋戒——如何能够对与新陈代谢相关的基因施加强大的选择压力。通过计算单一代内等位基因频率的变化，我们可以直接量化这种文化实践所带来的演化影响。[@problem_id:1932474]", "problem": "在一个与世隔绝的人类群体中，一项文化传统是每年进行为期一个月的严格集体禁食。这一习俗已经延续了数百代。在此期间有效储存和利用能量储备的能力受单个基因 $METF$ 的影响，该基因有两个等位基因：一个“节俭”等位基因 $T$ 和一个“挥霍”等位基因 $t$。\n\n每种基因型的相对终生繁殖成功率估计如下：\n- 基因型为 $tt$ 的个体在禁食期间会遇到极大困难，导致其相对繁殖成功率为 0.70。\n- 基因型为 $TT$ 的个体非常适应禁食，但在食物供应稳定的现代，其终生繁殖成功率略有下降，使其相对繁殖成功率为 0.95。\n- 杂合子个体 ($Tt$) 表现出最高的总体成功率，他们能成功度过禁食期，且没有 $TT$ 基因型的长期劣势。他们的相对繁殖成功率被归一化为 1.0。\n\n假设该种群处于一个世代的开始，在禁食期之前，并且对于该基因座处于哈迪-温伯格平衡状态。“节俭”等位基因 $T$ 的初始频率为 0.30。\n\n计算经过这一代选择（包括年度禁食的影响）后，基因库中 $T$ 等位基因的频率。将你的最终答案四舍五入到四位有效数字。", "solution": "设 $T$ 的初始等位基因频率为 $p=0.30$，$t$ 的初始等位基因频率为 $q=1-p=0.70$。在选择之前，根据哈迪-温伯格平衡，基因型频率分别为 $TT$ 为 $p^{2}$，$Tt$ 为 $2pq$，$tt$ 为 $q^{2}$。\n\n设相对适合度为 $w_{TT}=0.95$，$w_{Tt}=1.0$，$w_{tt}=0.70$。选择之后，平均适合度为\n$$\n\\bar{w}=p^{2}w_{TT}+2pq\\,w_{Tt}+q^{2}w_{tt}.\n$$\n选择后 $T$ 的等位基因频率为\n$$\np'=\\frac{p^{2}w_{TT}+pq\\,w_{Tt}}{\\bar{w}}.\n$$\n\n代入给定值：\n- $p^{2}=0.09$, $2pq=2(0.30)(0.70)=0.42$, $q^{2}=0.49$。\n- $\\bar{w}=0.09(0.95)+0.42(1.0)+0.49(0.70)=0.0855+0.42+0.343=0.8485$。\n- 分子 $= p^2 w_{TT} + pq w_{Tt} = 0.09(0.95)+(0.30 \\times 0.70)(1.0) = 0.0855+0.21=0.2955$。\n\n因此，\n$$\np'=\\frac{0.2955}{0.8485}\\approx 0.348261\\dots\n$$\n四舍五入到四位有效数字，\n$$\np'\\approx 0.3483.\n$$", "answer": "$$\\boxed{0.3483}$$", "id": "1932474"}, {"introduction": "在上一个练习的基础上，本实践将考察一次重大文化变迁所带来的长期后果。当一个群体放弃了某种传统食物来源，与之相关的选择压力可能会被减弱甚至逆转。这个题目要求你模拟一个曾经有害的等位基因，在数百代的时间里，其相对适应度如何因文化变动而改变，这揭示了由文化塑造的适应性景观的动态本质。[@problem_id:1932473]", "problem": "在一个孤立的人类种群中，中和一种传统食用的野生块茎中所含轻度有毒化合物的能力由基因 $TNP$ 控制。该基因有两个等位基因：显性等位基因 $A$ 编码一种功能性中和酶，而隐性等位基因 $a$ 则是无功能的。世代以来，这种块茎都是主食，因此 $a$ 等位基因受到强烈的负选择。\n\n之后发生了一次重大的文化和农业转变，导致人们完全且永久地停止了食用这种块茎。由于他们的饮食中不再含有这种毒素，产生这种中和酶不再有任何益处。事实上，产生这种酶现在会带来轻微的代谢成本。这逆转了选择压力。适应度成本是加性的：基因型为 $AA$ 的个体相对适应度为 $1-2s$，杂合子 ($Aa$) 的相对适应度为 $1-s$，而基因型为 $aa$ 的个体（不产生酶）的相对适应度为 $1$。\n\n在这次饮食转变的时刻（第0代），$a$ 等位基因的频率（我们记为 $q_0$）为 $0.01$。与代谢成本相关的选择系数 $s$ 为 $0.005$。假设种群足够大，交配是随机的，且选择是作用于该基因的唯一进化动力，请计算自饮食转变经过500代后 $a$ 等位基因的频率。将最终答案四舍五入到三位有效数字。", "solution": "该问题要求在给定初始频率 $q_0$ 和一个对 $A$ 等位基因具有加性适应度成本的选择模型的情况下，计算 $t=500$ 代后 $a$ 等位基因的频率。\n\n首先，我们定义参数和模型。\n- 等位基因 $A$ 的频率: $p$\n- 等位基因 $a$ 的频率: $q$\n- 约束条件: $p+q=1$\n- 各基因型的相对适应度值:\n    - $w_{AA} = 1 - 2s$\n    - $w_{Aa} = 1 - s$\n    - $w_{aa} = 1$\n- $a$ 的初始频率: $q_0 = 0.01$\n- 选择系数: $s = 0.005$\n- 世代数: $t = 500$\n\n每代等位基因频率的变化取决于种群的平均适应度 $\\bar{w}$。\n$$ \\bar{w} = p^2 w_{AA} + 2pq w_{Aa} + q^2 w_{aa} $$\n代入适应度值：\n$$ \\bar{w} = p^2 (1 - 2s) + 2pq (1 - s) + q^2 (1) $$\n$$ \\bar{w} = p^2 - 2sp^2 + 2pq - 2spq + q^2 $$\n$$ \\bar{w} = (p^2 + 2pq + q^2) - 2s(p^2 + pq) $$\n使用 $p^2 + 2pq + q^2 = (p+q)^2 = 1$ 并提出公因子 $p$：\n$$ \\bar{w} = 1 - 2s p(p+q) = 1 - 2sp $$\n\n接下来，我们求下一代中等位基因 $a$ 的频率 $q'$。这是选择后基因库中 $a$ 等位基因的频率。\n$$ q' = \\frac{(\\text{frequency of Aa after selection}) \\times \\frac{1}{2} + (\\text{frequency of aa after selection}) \\times 1}{\\text{sum of frequencies after selection}} $$\n这可以简化为：\n$$ q' = \\frac{p q w_{Aa} + q^2 w_{aa}}{\\bar{w}} $$\n代入适应度值：\n$$ q' = \\frac{p q (1 - s) + q^2}{1 - 2sp} $$\n我们可以重写为 $p = 1-q$：\n$$ q' = \\frac{(1-q)q(1-s) + q^2}{1 - 2s(1-q)} = \\frac{q - sq - q^2 + sq^2 + q^2}{1 - 2s + 2sq} = \\frac{q - sq + sq^2}{1 - 2s + 2sq} $$\n$a$ 频率的每代变化量是 $\\Delta q = q' - q$。\n$$ \\Delta q = \\frac{q - sq + sq^2}{1 - 2s + 2sq} - q = \\frac{q - sq + sq^2 - q(1 - 2s + 2sq)}{1 - 2s + 2sq} $$\n$$ \\Delta q = \\frac{q - sq + sq^2 - q + 2sq - 2sq^2}{1 - 2s + 2sq} = \\frac{sq - sq^2}{1 - 2s + 2sq} = \\frac{sq(1-q)}{\\bar{w}} $$\n代入 $p=1-q$：\n$$ \\Delta q = \\frac{spq}{\\bar{w}} $$\n由于选择系数 $s=0.005$ 很小，我们可以近似地认为该变化是随时间连续的。我们也可以将平均适应度近似为 $\\bar{w} = 1-2sp \\approx 1$。\n因此，我们可以写出 $q$ 随时间 $t$（以代为单位）变化的微分方程：\n$$ \\frac{dq}{dt} \\approx spq = s q (1-q) $$\n这是标准的逻辑斯蒂增长方程。我们用分离变量法求解：\n$$ \\frac{dq}{q(1-q)} = s \\, dt $$\n我们对两边进行积分，时间从 $0$ 到 $t$，频率从 $q_0$ 到 $q_t$：\n$$ \\int_{q_0}^{q_t} \\frac{1}{q(1-q)} \\, dq = \\int_0^t s \\, dt $$\n右边的积分就是 $st$。对于左边的积分，我们使用部分分式分解：$\\frac{1}{q(1-q)} = \\frac{1}{q} + \\frac{1}{1-q}$。\n$$ \\int_{q_0}^{q_t} \\left(\\frac{1}{q} + \\frac{1}{1-q}\\right) \\, dq = [\\ln|q| - \\ln|1-q|]_{q_0}^{q_t} = \\left[\\ln\\left(\\frac{q}{1-q}\\right)\\right]_{q_0}^{q_t} $$\n计算定积分：\n$$ \\ln\\left(\\frac{q_t}{1-q_t}\\right) - \\ln\\left(\\frac{q_0}{1-q_0}\\right) = st $$\n重新整理方程以求解 $q_t$：\n$$ \\ln\\left(\\frac{q_t}{1-q_t}\\right) = \\ln\\left(\\frac{q_0}{1-q_0}\\right) + st $$\n对两边取指数：\n$$ \\frac{q_t}{1-q_t} = \\frac{q_0}{1-q_0} \\exp(st) $$\n设 $R_t = \\frac{q_t}{1-q_t}$。则 $R_t = R_0 \\exp(st)$。我们可以用 $R_t$ 来表示 $q_t$ 并求解：\n$q_t = R_t(1-q_t) \\implies q_t = R_t - R_t q_t \\implies q_t(1+R_t) = R_t \\implies q_t = \\frac{R_t}{1+R_t}$。\n\n现在，我们可以代入给定值：\n$q_0 = 0.01$\n$s = 0.005$\n$t = 500$ 代\n\n首先，计算初始比率 $R_0$：\n$$ R_0 = \\frac{q_0}{1-q_0} = \\frac{0.01}{1-0.01} = \\frac{0.01}{0.99} $$\n接下来，计算指数项：\n$$ st = 0.005 \\times 500 = 2.5 $$\n现在，计算 $t=500$ 时的 $R_t$：\n$$ R_{500} = R_0 \\exp(st) = \\frac{0.01}{0.99} \\exp(2.5) $$\n使用计算器，$\\exp(2.5) \\approx 12.18249$。\n$$ R_{500} \\approx \\frac{0.01}{0.99} \\times 12.18249 \\approx 0.1230555 $$\n最后，根据 $R_{500}$ 计算 $q_{500}$：\n$$ q_{500} = \\frac{R_{500}}{1+R_{500}} \\approx \\frac{0.1230555}{1+0.1230555} = \\frac{0.1230555}{1.1230555} \\approx 0.1095719 $$\n题目要求将答案四舍五入到三位有效数字。\n$$ q_{500} \\approx 0.110 $$", "answer": "$$\\boxed{0.110}$$", "id": "1932473"}, {"introduction": "我们的最后一个实践将探讨一个更为微妙的情景，其中文化扮演了抵御环境威胁的不完美缓冲角色。一种净水仪式提供了保护，但其偶尔的失效创造了一个波动的选择环境。这个练习将展示一种文化实践的不可靠性如何导致平衡选择，从而在群体中主动维持遗传多样性（同时保留了抗性与易感性等位基因）。[@problem_id:1932459]", "problem": "在一个庞大的、与世隔绝的人类种群中，一种水生病原体是地方性流行病。该种群有一种文化传承的净水仪式，如果正确执行，可以使水变得安全，并完全保护个体免受该病原体的侵害。然而，由于仪式执行中偶尔出现的失误，在任何一代中，净化失败的概率为 $p$，这会使整个种群暴露于病原体之下。\n\n对这种病原体的易感性由一个具有两个等位基因的单一基因控制，在一个二倍体生物中，这两个等位基因是 $S$（易感）和 $R$（抗性）。遗传和选择背景如下：\n- 抗性等位基因 $R$ 是显性的，这意味着 $RR$ 和 $SR$ 基因型都对病原体表现出抗性。\n- 易感等位基因 $S$ 是隐性的，这意味着只有 $SS$ 基因型表现出易感性。\n- $RR$ 基因型带有一个内在的、隐性的适合度成本 $s_r$（其中 $0 < s_r < 1$），这意味着无论病原体是否存在，其适合度在每一代都会降低 $s_r$。$SR$ 和 $SS$ 基因型没有这种内在成本。\n- 如果暴露于病原体（当仪式失败时发生），易感的 $SS$ 个体将遭受 $s_p$（其中 $0 < s_p < 1$）的适合度降低。\n\n总结在两种可能的环境状态下各基因型的相对适合度（$w$）：\n1.  **仪式成功（概率为 $1-p$）**：$w_{SS} = 1$，$w_{SR} = 1$，$w_{RR} = 1 - s_r$。\n2.  **仪式失败（概率为 $p$）**：$w_{SS} = 1 - s_p$，$w_{SR} = 1$，$w_{RR} = 1 - s_r$。\n\n假设随机交配、种群规模巨大，并且维持着一个稳定的多态性平衡，请推导出易感等位基因 $S$ 的平衡频率的表达式，用 $p$、$s_r$ 和 $s_p$ 表示。", "solution": "题目要求解易感等位基因 $S$ 的稳定平衡频率。让我们将等位基因 $S$ 的频率表示为 $q$，等位基因 $R$ 的频率表示为 $1-q$。由于环境在两种状态（仪式成功或失败）之间波动，长期的进化动态由每种基因型在这些状态下的平均适合度决定。我们将计算每种基因型的算术平均适合度，这对于弱选择是一个有效的近似。\n\n步骤1：计算 $SS$ 基因型的平均相对适合度 $\\bar{w}_{SS}$。\n$SS$ 基因型在概率为 $1-p$ 时适合度为 $1$，在概率为 $p$ 时适合度为 $1 - s_p$。\n$$\n\\bar{w}_{SS} = (1-p) \\times 1 + p \\times (1 - s_p) = 1 - p s_p\n$$\n\n步骤2：计算 $SR$ 基因型的平均相对适合度 $\\bar{w}_{SR}$。\n$SR$ 基因型在概率为 $1-p$ 时适合度为 $1$，在概率为 $p$ 时适合度也为 $1$。\n$$\n\\bar{w}_{SR} = (1-p) \\times 1 + p \\times 1 = 1\n$$\n\n步骤3：计算 $RR$ 基因型的平均相对适合度 $\\bar{w}_{RR}$。\n$RR$ 基因型在概率为 $1-p$ 时适合度为 $1 - s_r$，在概率为 $p$ 时适合度也为 $1 - s_r$。\n$$\n\\bar{w}_{RR} = (1-p) \\times (1 - s_r) + p \\times (1 - s_r) = (1-p+p) \\times (1 - s_r) = 1 - s_r\n$$\n\n步骤4：分析适合度景观以找到稳定多态性平衡的条件。\n如果杂合子的适合度最高（超显性或杂合子优势），则存在稳定的多态性平衡。让我们比较一下平均适合度值：\n- $\\bar{w}_{SR} > \\bar{w}_{SS}$，因为 $1 > 1 - p s_p$，化简为 $p s_p > 0$。由于 $p > 0$ 且 $s_p > 0$ ，此条件满足。\n- $\\bar{w}_{SR} > \\bar{w}_{RR}$，因为 $1 > 1 - s_r$，化简为 $s_r > 0$。由于 $s_r > 0$ ，此条件也满足。\n由于杂合子 $SR$ 的平均适合度高于纯合子 $SS$ 和 $RR$，将会存在导致稳定多态性平衡的平衡选择。\n\n步骤5：计算平衡频率 $q_{eq}$。\n在平衡状态下，等位基因频率的变化量 $\\Delta q$ 为零。在一个单位点、双等位基因系统中，$\\Delta q$ 的通用方程是：\n$$\n\\Delta q = \\frac{q(1-q)}{\\bar{w}} [q(\\bar{w}_{SS} - \\bar{w}_{SR}) + (1-q)(\\bar{w}_{SR} - \\bar{w}_{RR})]\n$$\n其中 $\\bar{w}$ 是种群的平均适合度。对于在多态性平衡点（其中 $0 < q < 1$）$\\Delta q = 0$ 的情况，方括号中的项必须为零：\n$$\nq_{eq}(\\bar{w}_{SS} - \\bar{w}_{SR}) + (1-q_{eq})(\\bar{w}_{SR} - \\bar{w}_{RR}) = 0\n$$\n让我们定义相对于杂合子的针对纯合子的选择系数：\n- 针对 $SS$ 的选择：$t = \\bar{w}_{SR} - \\bar{w}_{SS} = 1 - (1 - p s_p) = p s_p$\n- 针对 $RR$ 的选择：$s = \\bar{w}_{SR} - \\bar{w}_{RR} = 1 - (1 - s_r) = s_r$\n\n平衡方程可以改写为 $q = q_{eq}$：\n$$\nq(-t) + (1-q)(s) = 0\n$$\n$$\n-qt + s - qs = 0\n$$\n$$\ns = qt + qs = q(t+s)\n$$\n求解 $q_{eq}$：\n$$\nq_{eq} = \\frac{s}{s+t}\n$$\n现在，代入 $s$ 和 $t$ 的表达式：\n$$\nq_{eq} = \\frac{s_r}{s_r + p s_p}\n$$\n这就是易感等位基因 $S$ 的稳定平衡频率。", "answer": "$$\\boxed{\\frac{s_r}{s_r + p s_p}}$$", "id": "1932459"}]}