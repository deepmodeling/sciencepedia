{"hands_on_practices": [{"introduction": "我们从祖先状态重建的一项基本技能开始：计算简约性分数。这个练习将引导你运用简约性原则，即寻找演化改变最少的简单解释，来分析一个假设的昆虫系统发育树。掌握这项技术是破译任何性状演化历史的第一步。[@problem_id:1908137]", "id": "1908137", "problem": "一位演化生物学家正在研究一群虚构昆虫的幼虫行为演化。五个现存物种之间的演化关系（系统发育）如下所述：*Glimmerwing*和*Shadowspinner*是姐妹物种（它们共享一个最近的共同祖先）。这对物种的最近亲缘是*Stonemantle*物种。另一对姐妹物种，*Sunstreaker*和*Duskdiver*，形成一个独立的进化支。包含*Glimmerwing*、*Shadowspinner*和*Stonemantle*的进化支与包含*Sunstreaker*和*Duskdiver*的进化支本身是姐妹群，它们源于所有五个物种的单一共同祖先。\n\n所研究的一个关键性状是幼虫的取食行为，它可以是两种状态之一：‘取食型’（幼虫主动消耗食物）或‘非取食型’（幼虫完全依靠卵中的卵黄储备发育）。在五个现存物种中观察到的状态是：\n- *Glimmerwing*：取食型\n- *Shadowspinner*：取食型\n- *Stonemantle*：非取食型\n- *Sunstreaker*：取食型\n- *Duskdiver*：非取食型\n\n假设所有五个物种的共同祖先是‘非取食型’，请确定解释系统发育树上这种性状分布所需的最少演化改变次数（即‘取食型’和‘非取食型’状态之间的转变次数）。这个值被称为总简约性得分。", "solution": "设两种幼虫状态分别用符号 $F$（取食型）和 $N$（非取食型）表示。将这五个物种缩写如下：$G$ = Glimmerwing $(F)$，$H$ = Shadowspinner $(F)$，$T$ = Stonemantle $(N)$，$U$ = Sunstreaker $(F)$，$D$ = Duskdiver $(N)$。系统发育树为 $(((G,H),T),(U,D))$，其中根节点 $R$ 是所有五个物种的共同祖先。定义内部节点：$X$ 是 $G$ 和 $H$ 的最近共同祖先，$A$ 是 $X$ 和 $T$ 的祖先，$B$ 是 $U$ 和 $D$ 的祖先。\n\n使用 Fitch 简约性算法。对于每个节点 $v$，设 $S_{v}$ 为能使以 $v$ 为根的子树中改变次数最小化的可能状态集合。\n\n叶节点集合：\n$$\nS_{G}=\\{F\\},\\quad S_{H}=\\{F\\},\\quad S_{T}=\\{N\\},\\quad S_{U}=\\{F\\},\\quad S_{D}=\\{N\\}.\n$$\n\n自下而上计算内部节点集合：\n- 对于 $X$（子节点为 $G$ 和 $H$），$S_{X}=S_{G}\\cap S_{H}=\\{F\\}$（没有增加改变）。\n- 对于 $A$（子节点为 $X$ 和 $T$），$S_{A}=S_{X}\\cap S_{T}=\\emptyset$，因此设 $S_{A}=S_{X}\\cup S_{T}=\\{F,N\\}$ 并增加 $1$ 次改变。\n- 对于 $B$（子节点为 $U$ 和 $D$），$S_{B}=S_{U}\\cap S_{D}=\\emptyset$，因此设 $S_{B}=S_{U}\\cup S_{D}=\\{F,N\\}$ 并增加 $1$ 次改变。\n- 对于根节点 $R$（子节点为 $A$ 和 $B$），$S_{R}=S_{A}\\cap S_{B}=\\{F,N\\}$（没有额外增加改变）。\n\n因此，在根节点状态未指定的情况下，最少的改变次数为 $1+1=2$。现在考虑给定的根节点状态：所有五个物种的祖先是 $N$。由于 $N\\in S_{R}$，我们指定 $R=N$ 而不产生任何额外的改变。\n\n自上而下分配状态以实现最小值：\n- 选择 $A=N$ 和 $B=N$，因为 $N\\in S_{A}$ 且 $N\\in S_{B}$，这样可以避免在分支 $R\\to A$ 和 $R\\to B$ 上产生额外的改变。\n- 在进化支 $A$ 中：从 $A=N$ 到 $X=\\{F\\}$ 需要一次改变 $N\\to F$；从 $A=N$ 到 $T=N$ 不需要改变；从 $X=F$ 到 $G=F$ 和 $H=F$ 不需要改变。\n- 在进化支 $B$ 中：从 $B=N$ 到 $U=F$ 需要一次改变 $N\\to F$；从 $B=N$ 到 $D=N$ 不需要改变。\n\n因此，总简约性得分为 $1+1=2$，这是与观察到的末端状态和指定的非取食型根节点相容的最小值。", "answer": "$$\\boxed{2}$$"}, {"introduction": "演化历史并非总是简单的线性进程；性状可以被丢失，正如它们可以被获得一样。这个实践问题使用简约性方法来揭示一个更复杂的场景，其中涉及蝾螈繁殖模式的演化逆转。通过追踪该性状的历史，你将看到祖先状态重建如何识别同塑性（homoplasy）的实例，并提供一个更细致的演化视角。[@problem_id:1908182]", "id": "1908182", "problem": "为理解一组相关的蝾螈物种其繁殖模式的演化，我们对它们进行了研究。已知该整个类群的祖先状态是包含水生幼体阶段的生命周期。一些物种演化出了直接发育，其幼体孵化时即为微型成体，完全跳过了幼体阶段。\n\n给定六个物种（一个外群 O 和五个内群物种 A、B、C、D 和 E）观察到的繁殖模式及其系统发育关系。\n\n**观察到的性状：**\n- 物种 O (外群)：水生幼体\n- 物种 A：直接发育\n- 物种 B：水生幼体\n- 物种 C：直接发育\n- 物种 D：直接发育\n- 物种 E：直接发育\n\n**系统发育关系：**\n关系描述如下：姐妹种 A 和 B 构成一个演化支。该演化支又与物种 C 互为姐妹群。这个更大的 (A, B, C) 演化支与物种 D 互为姐妹群。这整个 (A, B, C, D) 演化支与物种 E 互为姐妹群。最后，物种 O 是整个内群 (A, B, C, D, E) 的外群。\n\n使用最大简约性原则（即，倾向于需要最少演化改变次数的解释），确定该性状最可能的演化历史。下列哪个陈述正确描述了这段历史？\n\nA. 2次改变；在导向物种B的谱系中，发生了从直接发育到水生幼体的逆转。\nB. 2次改变；直接发育在导向E的谱系和导向(A, B, C, D)祖先的谱系中独立演化。\nC. 3次改变；直接发育演化了一次，随后在导向物种O和物种B的谱系中丢失。\nD. 3次改变；直接发育在三个独立的谱系中独立演化。\nE. 1次改变；直接发育在内群的祖先中演化了一次，而物种B代表了一个观测错误。", "solution": "设祖先状态和外群状态为水生幼体，编码为 $0$，直接发育编码为 $1$。观察到的尖端状态为：$A=1$，$B=0$，$C=1$，$D=1$，$E=1$，外群 $O=0$。内群的拓扑结构是梳状树 $(((((A,B),C),D),E))$，其中 $O$ 是内群根节点的外群。\n\n使用状态集，自下而上地应用 Fitch 简约算法：\n- 在叶节点上：$S(A)=\\{1\\}$, $S(B)=\\{0\\}$, $S(C)=\\{1\\}$, $S(D)=\\{1\\}$, $S(E)=\\{1\\}$, $S(O)=\\{0\\}$。\n- 节点 $(A,B)$：$S(AB)=S(A)\\cap S(B)=\\emptyset$，所以 $S(AB)=S(A)\\cup S(B)=\\{0,1\\}$，这增加 $1$ 次改变。\n- 节点 $(AB,C)$：$S(ABC)=S(AB)\\cap S(C)=\\{1\\}$，增加 $0$ 次改变。\n- 节点 $(ABC,D)$：$S(ABCD)=S(ABC)\\cap S(D)=\\{1\\}$，增加 $0$ 次改变。\n- 节点 $(ABCD,E)$ (内群根节点)：$S(ABCDE)=S(ABCD)\\cap S(E)=\\{1\\}$，增加 $0$ 次改变。\n- 与外群的根节点：$S(\\text{root})=S(ABCDE)\\cap S(O)=\\emptyset$，因此取并集 $\\{0,1\\}$ 并增加 $1$ 次改变。\n\n因此，最小改变次数为 $1+1=2$。一个与最小化改变一致的自上而下的状态分配，将内群根节点的状态设为 $1$ (因为 $S(ABCDE)=\\{1\\}$)，并将 $1$ 沿着内部支向下传播到 $ABC$ 和 $AB$。在节点 $AB$ 处 (其状态集为 $S(AB)=\\{0,1\\}$)，选择状态 $1$ 以避免在内部支上产生额外的改变。那么，尖端上唯一的差异是在分支 $B$ 上，这需要一次 $1 \\to 0$ 的改变（逆转为水生幼体）。另一次改变是在从总祖先（与状态为 $0$ 的 $O$ 共享）到内群根节点的谱系分支上发生的唯一一次 $0 \\to 1$ 的起源。\n\n这得出的演化历史是：在内群的基部有一次直接发育的获得，在谱系 $B$ 中有一次向水生幼体的逆转，即 $2$ 次改变，其中在 $B$ 中有一次逆转，这与选项 A 相符。", "answer": "$$\\boxed{A}$$"}, {"introduction": "虽然简约性分析很强大，但它将所有变化都视为等概率事件。最后一个练习将介绍一种更复杂的方法——最大似然法，该方法融合了一个概率性的演化模型。你将比较简约性分析和似然分析两种方法对狗的行为性状的重建结果，从而了解不同的假设如何导致对祖先状态的不同推论。[@problem_id:1908136]", "id": "1908136", "problem": "一位演化生物学家正在研究家犬的行为演化。基于基因组数据，构建了一个包含四个特定品种的简化系统发育树。该树由两个主要分支组成，它们共享一个共同祖先，这个祖先代表了这家犬系统发育的根节点。第一个分支包含 German Shepherd 和 Border Collie。第二个分支包含 Pug 和 Beagle。\n\n该生物学家有兴趣重建“牧羊本能”这一复杂行为性状的祖先状态。对于每个品种，该性状被归类为两种离散状态之一：牧羊 (H) 或非牧羊 (N)。观察到的四个品种的状态如下：\n- German Shepherd: H\n- Border Collie: H\n- Pug: N\n- Beagle: N\n\n已知所有家犬的祖先——狼，在这一特定性状类别中被归类为非牧羊 (N)。你的任务是使用两种不同的计算方法，重建家犬系统发育树根节点上该性状的状态。\n\n**第一部分：简约性分析**\n将最大简约性原则应用于此系统发育和性状数据。确定解释所观察到的牧羊本能分布所需的最少演化改变次数（即从 H 到 N 或从 N 到 H 的改变）。\n\n**第二部分：最大似然分析**\n对于最大似然分析，提出了一个简单的、非对称的性状演化模型。该模型假设，在系统发育树的任何给定分支上，性状从牧羊变为非牧羊（一次丢失事件）的概率是 $p_{\\text{H}\\to\\text{N}} = 0.3$，而从非牧羊变为牧羊（一次获得事件）的概率是 $p_{\\text{N}\\to\\text{H}} = 0.1$。因此，性状保持为牧羊状态的概率是 $p_{\\text{H}\\to\\text{H}} = 0.7$，而保持为非牧羊状态的概率是 $p_{\\text{N}\\to\\text{N}} = 0.9$。假设这些概率在系统发育树的所有分支上都是均一的。\n\n计算根节点祖先具有牧羊性状的似然值与具有非牧羊性状的似然值之比，定义为 $R = \\frac{L(\\text{root state = H})}{L(\\text{root state = N})}$。\n\n你的任务是给出第一部分中的最少改变次数，以及第二部分中比率 $R$ 的数值。将 $R$ 的值四舍五入到四位有效数字。", "solution": "简约性分析：这个有四个叶尖的有根树由两个“樱桃”结构组成：分支A包含 German Shepherd 和 Border Collie，两者的观察状态均为 $H$；分支B包含 Pug 和 Beagle，两者的观察状态均为 $N$。使用 Fitch 简约性程序，在叶节点上分配集合：为分支A的两个成员分配 $\\{H\\}$，为分支B的两个成员分配 $\\{N\\}$。在每个“樱桃”结构下方的内部节点上，交集非空，因此分支A的祖先节点为 $\\{H\\}$，分支B的祖先节点为 $\\{N\\}$。在根节点处，$\\{H\\}$ 和 $\\{N\\}$ 的交集为空，因此在分隔 $H$ 子树和 $N$ 子树的单条边上需要一次改变。因此，解释所观察到的分布所需的最少改变次数是 $1$。\n\n最大似然分析：每个分支具有相同的转移概率\n$$\np_{\\text{H}\\to\\text{H}}=0.7,\\quad p_{\\text{H}\\to\\text{N}}=0.3,\\quad p_{\\text{N}\\to\\text{H}}=0.1,\\quad p_{\\text{N}\\to\\text{N}}=0.9.\n$$\n对于分支A（两个 $H$ 叶节点），在分支祖先状态为 $i\\in\\{H,N\\}$ 的条件下，该子树的条件似然值为\n$$\nf_{A}(H)=(p_{\\text{H}\\to\\text{H}})^{2}=0.7^{2}=0.49,\\qquad f_{A}(N)=(p_{\\text{N}\\to\\text{H}})^{2}=0.1^{2}=0.01.\n$$\n对于分支B（两个 $N$ 叶节点），条件似然值为\n$$\nf_{B}(H)=(p_{\\text{H}\\to\\text{N}})^{2}=0.3^{2}=0.09,\\qquad f_{B}(N)=(p_{\\text{N}\\to\\text{N}})^{2}=0.9^{2}=0.81.\n$$\n设 $L(H)$ 表示在根节点为 $H$ 的条件下观察到叶尖状态的似然值，设 $L(N)$ 表示在根节点为 $N$ 的条件下观察到叶尖状态的似然值。对两个内部分支祖先节点的未知状态进行求和，得到\n$$\ng_{A}(H)=p_{\\text{H}\\to\\text{H}}\\,f_{A}(H)+p_{\\text{H}\\to\\text{N}}\\,f_{A}(N)=0.7\\cdot 0.49+0.3\\cdot 0.01=0.346,\n$$\n$$\ng_{B}(H)=p_{\\text{H}\\to\\text{H}}\\,f_{B}(H)+p_{\\text{H}\\to\\text{N}}\\,f_{B}(N)=0.7\\cdot 0.09+0.3\\cdot 0.81=0.306,\n$$\n所以\n$$\nL(H)=g_{A}(H)\\,g_{B}(H)=0.346\\cdot 0.306=0.105876.\n$$\n类似地，\n$$\ng_{A}(N)=p_{\\text{N}\\to\\text{H}}\\,f_{A}(H)+p_{\\text{N}\\to\\text{N}}\\,f_{A}(N)=0.1\\cdot 0.49+0.9\\cdot 0.01=0.058,\n$$\n$$\ng_{B}(N)=p_{\\text{N}\\to\\text{H}}\\,f_{B}(H)+p_{\\text{N}\\to\\text{N}}\\,f_{B}(N)=0.1\\cdot 0.09+0.9\\cdot 0.738=0.738,\n$$\n所以\n$$\nL(N)=g_{A}(N)\\,g_{B}(N)=0.058\\cdot 0.738=0.042804.\n$$\n所求的比率为\n$$\nR=\\frac{L(\\text{root state}=H)}{L(\\text{root state}=N)}=\\frac{0.105876}{0.042804}\\approx 2.474,\n$$\n四舍五入到四位有效数字。\n\n因此，在简约性分析下，最少改变次数为 $1$，而似然比 $R$ 约为 $2.474$。", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 2.474 \\end{pmatrix}}$$"}]}