{"hands_on_practices": [{"introduction": "这个练习将带你深入PGLS计算的数学核心。我们简化了复杂的设置，直接为你呈现从PGLS框架中产生的最终线性方程组 $A\\hat{\\beta} = B$。通过求解其中的斜率系数，你将亲身体验模型参数是如何被估计出来的，从而揭开“最小二乘法”拟合过程最根本的神秘面纱。[@problem_id:1954097]", "problem": "一位进化生物学家正在研究豆娘的成虫体型与幼虫期持续时间之间可能存在的关系。该研究聚焦于一个由四个物种组成的小型演化支。这位生物学家假设，较长的幼虫期能带来更多的生长，从而导致更大的成虫体型。为了检验这一假设，该生物学家旨在拟合一个线性模型，以成虫体型为函数来描述幼虫期的时长。\n\n该生物学家认识到，由于这些物种具有亲缘关系，它们的性状值在统计上并非相互独立的。为了考虑物种间的进化关系，使用了一种专门的线性模型。数据和系统发育信息被浓缩为以下矩阵方程：\n\n$$A\\hat{\\beta} = B$$\n\n其中：\n- $\\hat{\\beta} = \\begin{pmatrix} \\hat{\\beta}_0 \\\\ \\hat{\\beta}_1 \\end{pmatrix}$ 是模型系数的向量。$\\hat{\\beta}_0$ 是截距，$\\hat{\\beta}_1$ 是斜率。斜率 $\\hat{\\beta}_1$ 表示成虫体型每增加一毫米，幼虫期持续时间（以天为单位）的变化量。\n- $A = \\begin{pmatrix} 0.25  1.0 \\\\ 1.0  4.75 \\end{pmatrix}$\n- $B = \\begin{pmatrix} 2.25 \\\\ 10.125 \\end{pmatrix}$\n\n您的任务是从该模型中计算斜率系数 $\\hat{\\beta}_1$。请用“天/毫米”作为单位表示您的答案，并四舍五入到两位有效数字。", "solution": "给定线性系统 $A\\hat{\\beta}=B$ 如下：\n$$\nA=\\begin{pmatrix}\\frac{1}{4}  1 \\\\ 1  \\frac{19}{4}\\end{pmatrix}, \\quad\n\\hat{\\beta}=\\begin{pmatrix}\\hat{\\beta}_{0} \\\\ \\hat{\\beta}_{1}\\end{pmatrix}, \\quad\nB=\\begin{pmatrix}\\frac{9}{4} \\\\ \\frac{81}{8}\\end{pmatrix}.\n$$\n这对应于以下方程组：\n$$\n\\frac{1}{4}\\hat{\\beta}_{0}+\\hat{\\beta}_{1}=\\frac{9}{4}, \\quad\n\\hat{\\beta}_{0}+\\frac{19}{4}\\hat{\\beta}_{1}=\\frac{81}{8}.\n$$\n由第一个方程可得，\n$$\n\\hat{\\beta}_{1}=\\frac{9}{4}-\\frac{1}{4}\\hat{\\beta}_{0}.\n$$\n将此代入第二个方程：\n$$\n\\hat{\\beta}_{0}+\\frac{19}{4}\\left(\\frac{9}{4}-\\frac{1}{4}\\hat{\\beta}_{0}\\right)=\\frac{81}{8}.\n$$\n计算乘积：\n$$\n\\hat{\\beta}_{0}+\\frac{171}{16}-\\frac{19}{16}\\hat{\\beta}_{0}=\\frac{81}{8}.\n$$\n合并同类项：\n$$\n-\\frac{3}{16}\\hat{\\beta}_{0}=\\frac{81}{8}-\\frac{171}{16}=\\frac{162-171}{16}=-\\frac{9}{16}.\n$$\n解出 $\\hat{\\beta}_{0}$：\n$$\n\\hat{\\beta}_{0}=3.\n$$\n反向代入以求得 $\\hat{\\beta}_{1}$：\n$$\n\\hat{\\beta}_{1}=\\frac{9}{4}-\\frac{1}{4}\\cdot 3=\\frac{6}{4}=\\frac{3}{2}=1.5.\n$$\n因此，斜率 $\\hat{\\beta}_{1}$ 是 $1.5$ 天/毫米。四舍五入到两位有效数字，结果仍为 $1.5$。", "answer": "$$\\boxed{1.5}$$", "id": "1954097"}, {"introduction": "为什么我们不能直接对来自不同物种的数据使用标准的线性回归呢？这个练习旨在解答这个根本性问题。它呈现了一个经典但假设性的场景：普通最小二乘法（OLS）回归发现了一个强相关，而系统发育广义最小二乘法（PGLS）分析却未能证实这一点。你的任务是批判性地评估这些相互矛盾的结果，从而理解为何在比较分析中考虑物种间的共享祖先是避免得出虚假结论的关键。[@problem_id:1954100]", "problem": "一位进化生物学家正在研究一个由四种假想的、近缘蛇类组成的演化支中毒液毒性与食性之间的潜在关系。研究的假说是，捕食更大型动物的物种已经进化出更强的毒液作为一种适应。该生物学家收集了每个物种的平均猎物质量数据，并测量了毒液效力，为其分配了一个无单位的“毒性得分”。\n\n收集到的数据如下表所示：\n\n| 物种 | 平均猎物质量 (g) | 毒性得分 |\n|:---:|:--------------:|:--------:|\n|  A  |       20       |   3.1    |\n|  B  |       25       |   3.5    |\n|  C  |       60       |   8.2    |\n|  D  |       10       |   1.5    |\n\n对该群体的系统发育分析表明，物种 A 和 B 是姐妹群（它们形成一个独立的演化支）。物种 C 是 (A,B) 演化支的姐妹群。物种 D 是 (A,B,C) 演化支的姐妹群，使其成为该组中亲缘关系最远的物种。\n\n以“毒性得分”为因变量，“平均猎物质量”为自变量，进行了一次简单的普通最小二乘 (OLS) 回归分析。该分析得出了一个统计学上显著的正相关关系（相关系数 $r \\approx 0.996$，p值为 0.004）。\n\n然而，生物学家认识到近缘物种并非独立的数据点，因此也进行了一次系统发育广义最小二乘 (PGLS) 分析。PGLS 是一种统计方法，它将物种间的系统发育关系纳入考虑，以校正它们的非独立性。PGLS 分析得出的结果是两个变量之间没有显著关系（斜率系数 = 0.08，p值为 0.45）。\n\n鉴于这两个相互矛盾的结果，以下哪个陈述提供了最科学合理的解释？\n\nA. OLS 回归发现的显著关系很可能是一个由系统发育非独立性导致的统计假象。在恰当考虑了共同祖先之后，没有显著证据表明该演化支中猎物质量与毒液毒性之间存在适应性关系。\n\nB. OLS 回归更可靠，因为样本量 (N=4) 对于 PGLS 的复杂计算来说太小了，在这种情况下 PGLS 可能会产生误导性结果。因此，该假说得到了有力支持。\n\nC. PGLS 的结果证明，猎物质量与毒液毒性之间绝对没有进化关系，数据中观察到的模式纯粹是随机进化漂变的结果。\n\nD. 两种分析都有缺陷。显著的 OLS 结果与不显著的 PGLS 结果相结合，表明 PGLS 分析中使用的系统发育树模型不正确。\n\nE. PGLS 分析是更合适的方法，其正斜率 (0.08) 证实了 OLS 发现的正向趋势。PGLS 结果缺乏统计显著性完全是由于样本量小，更大规模的研究肯定会证实这种关系。", "solution": "这个问题的核心在于理解为什么以及何时应使用像系统发育广义最小二乘 (PGLS) 这样的系统发育比较方法，而不是像普通最小二乘 (OLS) 这样的标准统计方法。\n\n首先，我们来分析这两种方法的假设。OLS 回归假设所有数据点都是独立同分布的。在进化生物学中，这一假设常常被违反，因为物种共享共同的祖先。近缘物种（如A和B）预期会比远缘物种（如D）更相似，这仅仅是因为它们从近期共同祖先那里继承了性状，而不必然是独立适应的结果。这种缺乏独立性的情况被称为“系统发育信号”或“系统发育非独立性”。\n\n对原始数据进行的 OLS 回归忽略了这种系统发育结构。它将所有四个物种视为自然界进行的四次独立实验。它发现了一个强的、统计学上显著的正相关 ($r \\approx 0.996$，p值为0.004)。如果这些物种真是独立的，这将是支持该假说的有力证据。\n\n然而，PGLS 正是为解决这个问题而设计的。它将系统发育树作为物种间预期协方差的模型。实质上，它在统计上“校正”了这样一个事实：物种 A 和 B 因为是姐妹群而非常相似，并且 (A,B,C) 演化支可能共享某些性状，从而使其与外群 D 区别开来。PGLS 分析得出了一个不显著的结果（p值为0.45）。这意味着，一旦考虑了因共同祖先造成的相似性，猎物质量与毒液毒性之间表面上的强相关关系就消失了。当数据得到恰当分析时，它们与无关系的原假设（即斜率为零）是一致的。\n\n两个结果之间的差异是关键发现。强大的 OLS 相关性很可能是虚假的，是系统发育结构造成的一种假象。例如，(A,B,C) 演化支的某个祖先可能进化出了中等强度的毒性和对中等大小猎物的偏好。然后，C 的一个后续祖先进化出了更强的毒性和对非常大猎物的偏好，而 A 和 B 彼此保持相似。当你绘制这些点时（D是低-低，A/B是中-中，C是高-高），它们会形成一条直线，但这种模式是由树深处的少数几个进化事件驱动的，而不是由发生在所有分支上的连续、适应性的权衡驱动的。PGLS 能够检测并校正这一点。\n\n现在我们来评估给出的选项：\n\n**A.** 该选项正确地指出 OLS 的结果很可能是系统发育非独立性的统计假象。它正确地总结道，在使用 PGLS 对系统发育进行校正后，不再有显著证据支持所提出的适应性关系。这是对统计结果最准确和谨慎的解释。\n\n**B.** 该选项是错误的。PGLS 是合适的方法，恰恰*因为*数据具有系统发育结构。忽略这个已知的非独立性来源是一个统计错误。虽然小样本量会限制任何检验的统计功效，但这并不能成为使用一个其核心假设被违反的方法 (OLS) 的理由，而不去使用专门为正确处理这种情况而设计的方法 (PGLS)。\n\n**C.** 该选项夸大了从 PGLS 结果中得出的结论。p值为0.45意味着我们未能拒绝无关系的原假设。它并不能*证明*原假设为真（即，它不能证明绝对没有关系）。它仅仅意味着在这个数据集中没有足够的证据来支持存在关系的备择假设。将这种模式纯粹归因于漂变也是一个未经证实的说法。\n\n**D.** 该选项是错误的。OLS 和 PGLS 之间的差异并不表示系统发育树有缺陷。恰恰相反，当系统发育对性状间的关系产生混杂效应时，这是预期的结果。这种差异证明了考虑系统发育是必要的，并且它改变了结论。\n\n**E.** 该选项在解释上犯了一个关键错误。在统计显著性方面，PGLS 的结果与 OLS 的结果是*矛盾*的，而非证实。主要的结论是显著关系的消失。虽然注意到了正斜率 (0.08)，但它在统计上与零无法区分。将不显著“完全”归因于样本量是推测性的，并且忽略了主要结论：在 OLS 中看到的强信号是一种假象。\n\n因此，选项 A 提供了对该场景最准确和科学上有效的解释。", "answer": "$$\\boxed{A}$$", "id": "1954100"}, {"introduction": "PGLS 不仅仅是检验双变量相关性的工具，它更是检验复杂进化假说的基础模块。这个高级练习将带你进入系统发育路径分析的领域，在这里，多个PGLS模型被结合起来，以评估一个假定的因果链。通过计算和解释标准化路径系数，你将学会如何区分直接效应和间接效应，这是探索塑造宏观进化模式复杂过程的一项关键技能。[@problem_id:1954092]", "problem": "一位演化生物学家正在研究一个外温脊椎动物分支中地理分布范围大小的宏观演化驱动因素。他们假设了一个特定的因果路径：历史气候的不稳定性驱动了更宽热耐受性的演化，而这反过来又使得物种能够占据更大的地理分布范围。\n\n为了检验这个假设，研究人员构建了一个路径模型：\n上新世气候速率 (`X`) → 演化出的热幅度 (`Y`) → 当代地理分布范围大小 (`Z`)\n\n该模型意味着气候速率 (`X`) 对分布范围大小 (`Z`) 有一个间接影响，这个影响由热幅度 (`Y`) 所中介。检验此中介假说的关键是，在考虑了通过 `Y` 的路径之后，评估从 `X` 到 `Z` 的直接路径的强度和显著性。\n\n研究人员收集了该分支中大量物种的这三个变量的数据。所有变量都经过转换，使其均值为零。变量的标准差如下：\n- `sd(X)` = 1.5 (单位：公里/年)\n- `sd(Y)` = 1.2 (单位：°C)\n- `sd(Z)` = 3.0 (单位：经对数转换的平方公里)\n\n为了解释因共同祖先导致的物种间统计学上的非独立性，研究人员进行了一系列系统发育广义最小二乘法 (Phylogenetic Generalized Least Squares, PGLS) 回归。结果总结在下表中。注意 `~` 读作“被...所预测”。\n\n| 模型设定                      | 预测变量   | 未标准化系数 (`β`) | 标准误 (SE) | p值     |\n|---------------------------------|-----------|---------------------------------|-----------------|---------|\n| `Y ~ X`                         | `X`       | 0.60                            | 0.15            |  0.01  |\n| `Z ~ X`                         | `X`       | 1.30                            | 0.30            |  0.01  |\n| `Z ~ Y`                         | `Y`       | 2.40                            | 0.40            |  0.01  |\n| `Z ~ X + Y`                     | `X`       | 0.10                            | 0.30            | 0.74    |\n|                                 | `Y`       | 2.00                            | 0.40            |  0.01  |\n\n您的任务是通过解读这些结果来进行系统发育路径分析。计算假设模型中以下路径的标准化路径系数：\n1.  路径 `a`：气候速率 (`X`) 对热幅度 (`Y`) 的影响。\n2.  路径 `b`：在控制了 `X` 的情况下，热幅度 (`Y`) 对分布范围大小 (`Z`) 的影响。\n3.  路径 `c'`：在控制了 `Y` 的情况下，气候速率 (`X`) 对分布范围大小 (`Z`) 的直接影响。\n\n根据您的计算和路径的统计显著性，选择提供正确标准化路径系数（`a*`, `b*`, `c'*`）和最准确结论的选项。\n\nA. `a* = 0.75`, `b* = 0.80`, `c'* = 0.05`。结论：数据为完全中介模型提供了强有力的支持，其中气候速率对分布范围大小的影响完全通过热幅度来传递。\nB. `a* = 0.75`, `b* = 0.80`, `c'* = 0.65`。结论：数据为部分中介模型提供了强有力的支持，其中气候速率通过直接和间接（通过热幅度）两种方式影响分布范围大小。\nC. `a* = 0.60`, `b* = 2.00`, `c'* = 0.10`。结论：数据为完全中介模型提供了强有力的支持。路径分析不应使用标准化系数。\nD. `a* = 0.75`, `b* = 0.96`, `c'* = 0.65`。结论：分析不确定，因为当模型中包含气候速率时，热幅度与分布范围大小之间的关系发生了变化。\nE. `a* = 0.75`, `b* = 0.80`, `c'* = 0.05`。结论：数据为部分中介模型提供了强有力的支持，因为所有三个变量之间都存在显著相关。", "solution": "我们需要使用 PGLS 回归结果和变量的标准差，来求解指定路径的标准化路径系数。对于从预测变量 $P$ 到响应变量 $R$ 的任意路径，其标准化系数由以下公式给出：\n$$\n\\beta^{\\ast}_{R \\leftarrow P} \\;=\\; \\beta_{R \\leftarrow P} \\cdot \\frac{\\operatorname{sd}(P)}{\\operatorname{sd}(R)}.\n$$\n\n路径 a（$X$ 对 $Y$ 的影响）：根据模型 $Y \\sim X$，未标准化系数为 $\\beta_{Y \\leftarrow X}=0.60$，且 $\\operatorname{sd}(X)=1.5$ 和 $\\operatorname{sd}(Y)=1.2$。因此，\n$$\na^{\\ast} \\;=\\; 0.60 \\cdot \\frac{1.5}{1.2} \\;=\\; 0.60 \\cdot 1.25 \\;=\\; 0.75.\n$$\n\n路径 b（在控制了 $X$ 的情况下，$Y$ 对 $Z$ 的影响）：根据模型 $Z \\sim X + Y$，$Y$ 的未标准化系数为 $\\beta_{Z \\leftarrow Y \\mid X}=2.00$，且 $\\operatorname{sd}(Y)=1.2$ 和 $\\operatorname{sd}(Z)=3.0$。因此，\n$$\nb^{\\ast} \\;=\\; 2.00 \\cdot \\frac{1.2}{3.0} \\;=\\; 2.00 \\cdot 0.40 \\;=\\; 0.80.\n$$\n\n路径 $c'$（在控制了 $Y$ 的情况下，$X$ 对 $Z$ 的直接影响）：根据模型 $Z \\sim X + Y$，$X$ 的未标准化系数为 $\\beta_{Z \\leftarrow X \\mid Y}=0.10$，且 $\\operatorname{sd}(X)=1.5$ 和 $\\operatorname{sd}(Z)=3.0$。因此，\n$$\nc'^{\\ast} \\;=\\; 0.10 \\cdot \\frac{1.5}{3.0} \\;=\\; 0.10 \\cdot 0.50 \\;=\\; 0.05.\n$$\n\n统计解释：路径 $a$ 是显著的（p值小于0.01），路径 $b$ 是显著的（p值小于0.01），而直接路径 $c'$ 不显著（p值等于0.74）。这种模式支持一个完全中介模型，其中气候速率对分布范围大小的影响是通过演化出的热幅度来传递的。标准化系数为 $a^{\\ast}=0.75$、$b^{\\ast}=0.80$ 和 $c'^{\\ast}=0.05$，这与选项A相符。", "answer": "$$\\boxed{A}$$", "id": "1954092"}]}