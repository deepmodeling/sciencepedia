{"hands_on_practices": [{"introduction": "渐变论和断续平衡论之间的争论，往往集中在进化变化的“速率”和“时机”上。这个练习将使用群体遗传学中的一个基本工具——育种家方程 $R = h^2S$ ——来将微观进化过程与宏观进化模式联系起来。通过模拟一个包含长期稳定和短暂强烈选择的场景，你将定量地看到同一段进化历史如何能被不同地解读，这突显了这场辩论的核心 [@problem_id:1935681]。这个练习证明了断续模式的出现，并不必然需要引入特殊的进化机制。", "problem": "一个孤立的岛栖鸟类种群在一个关键形态性状上表现出变异：喙的深度。该性状的窄义遗传力（$h^2$）是一个常数，为 0.60。该性状的演化历史具有两个截然不同的阶段。\n\n首先，该种群经历了一个长达 50,000 代的长期演化停滞期。在此期间，环境稳定，导致了非常弱的定向选择压力，这可以用一个微小但恒定的选择差（$S$），即每代 0.050 毫米来模拟。\n\n其次，发生了一次突然而剧烈的环境变化，例如持续的干旱改变了可用的食物来源。这一事件引发了一个持续 500 代的短暂而强烈的快速演化期。在此期间，强烈的定向选择偏爱喙更深的鸟类，这对应于一个巨大且恒定的选择差，即每代 2.5 毫米。\n\n一位对长期模式感兴趣的演化生物学家可能会通过仅考虑整个时间范围（停滞期加上快速演化期）内喙深度的总变化，并将其除以总代数，来计算一个“平均变化速率”。相比之下，在短暂的强选择期间的演化速率代表了“间断性”变化。\n\n计算快速的 500 代期间的变化速率与整个 50,500 代时间间隔内的长期平均变化速率之比。将你的答案表示为一个无量纲数，并四舍五入到三位有效数字。", "solution": "我们使用育种家方程，该方程给出了性状均值每代的响应 $R = h^{2} S$，其中 $h^{2}$ 是窄义遗传力，$S$ 是选择差。\n\n对于 $G_{1} = 50000$ 代的停滞期，选择差为 $S_{1} = 0.050$ 毫米/代，遗传力为 $h^{2} = 0.60$，每代的响应为\n$$\nR_{1} = h^{2} S_{1} = 0.60 \\times 0.050 = 0.030 \\text{ mm per generation}.\n$$\n此阶段的总变化为\n$$\n\\Delta_{1} = G_{1} R_{1} = 50000 \\times 0.030 = 1500 \\text{ mm}.\n$$\n\n对于 $G_{2} = 500$ 代的快速演化期，选择差为 $S_{2} = 2.5$ 毫米/代，遗传力为 $h^{2} = 0.60$，每代的响应为\n$$\nR_{2} = h^{2} S_{2} = 0.60 \\times 2.5 = 1.5 \\text{ mm per generation}.\n$$\n此阶段的总变化为\n$$\n\\Delta_{2} = G_{2} R_{2} = 500 \\times 1.5 = 750 \\text{ mm}.\n$$\n\n在整个 $G_{\\text{tot}} = 50500$ 代的时间间隔内的总变化为\n$$\n\\Delta_{\\text{tot}} = \\Delta_{1} + \\Delta_{2} = 1500 + 750 = 2250 \\text{ mm}.\n$$\n因此，整个时间间隔内的长期平均速率为\n$$\n\\bar{R} = \\frac{\\Delta_{\\text{tot}}}{G_{\\text{tot}}} = \\frac{2250}{50500} \\text{ mm per generation}.\n$$\n\n所求的比率是快速演化期的速率除以长期平均速率：\n$$\n\\text{Ratio} = \\frac{R_{2}}{\\bar{R}} = \\frac{1.5}{\\frac{2250}{50500}} = \\frac{1.5 \\times 50500}{2250} = \\frac{1515}{45} = \\frac{101}{3} \\approx 33.7,\n$$\n此处我们根据要求四舍五入到三位有效数字。", "answer": "$$\\boxed{33.7}$$", "id": "1935681"}, {"introduction": "在理解了理论基础之后，下一步就是用真实的证据来检验这些模型。古生物学家常常结合来自化石的形态学数据和来自现存物种的分子数据。这个练习要求你分析一个假设的数据集，其中包含一个祖先物种及其两个后代物种的形态特征，以及一个分子钟估算的分化时间。你将使用一个“形态不对称指数” $A$ 来量化祖先形态是处于后代物种的中间位置（如渐变论所预测），还是更接近其中一个后代（如断续平衡论所预测）[@problem_id:1935683]。", "problem": "古生物学家正在研究两种现存的深海腹足类姊妹物种——*Bathyspiralis profundus*和*Bathyspiralis abyssalis*的演化分歧。他们有兴趣检验该物种群的形态演化是由谱系渐变论模型还是间断平衡论模型能更好地描述。他们测量的关键形态性状是螺壳盘卷比 $C$，这是一个表示螺壳形状的无量纲量。\n\n从现代和化石标本中收集的数据如下：\n- 现存物种*B. profundus*的平均螺壳盘卷比为$C_{profundus} = 2.45$。\n- 现存物种*B. abyssalis*的平均螺壳盘卷比为$C_{abyssalis} = 3.85$。\n- 分子钟分析估计，这两个物种大约在500万年前从一个最近共同祖先（LCA）分化而来。\n- 在一个可追溯至510万年前的地层中发现了一个保存完好的最近共同祖先（LCA）化石，其螺壳盘卷比为$C_{LCA} = 2.55$。\n\n为了量化演化模式，研究人员定义了一个“形态不对称指数”（Morphological Asymmetry Index），$A$，其公式为：\n$$ A = \\frac{|C_{LCA} - C_{mid}|}{0.5 \\times |C_{profundus} - C_{abyssalis}|} $$\n其中 $C_{mid}$ 是两个现存物种之间的形态中点，计算公式为 $C_{mid} = \\frac{C_{profundus} + C_{abyssalis}}{2}$。\n\n一个接近0的 $A$ 值表示祖先在形态上介于两个后代物种之间，这是一种与渐变论一致的模式。一个接近1的 $A$ 值表示祖先在形态上与其中一个后代物种非常相似，表明大部分演化变化发生在另一个谱系中，这是一种与间断平衡论一致的模式。\n\n根据所提供的数据，以下哪个结论最受支持？\n\nA. 支持渐变论，因为不对称指数接近0。\n\nB. 支持间断平衡论，因为不对称指数接近1。\n\nC. 两种模型都未得到有力支持，因为不对称指数接近0.5。\n\nD. 数据存在矛盾，因为化石年龄比分子分化时间更古老。", "solution": "我们已知$C_{profundus}=2.45$，$C_{abyssalis}=3.85$，以及$C_{LCA}=2.55$。两个现存物种之间的中点定义为\n$$\nC_{mid}=\\frac{C_{profundus}+C_{abyssalis}}{2}。\n$$\n代入所给数值，\n$$\nC_{mid}=\\frac{2.45+3.85}{2}=\\frac{6.30}{2}=3.15。\n$$\n形态不对称指数定义为\n$$\nA=\\frac{|C_{LCA}-C_{mid}|}{0.5\\times |C_{profundus}-C_{abyssalis}|}。\n$$\n计算分子：\n$$\n|C_{LCA}-C_{mid}|=|2.55-3.15|=|{-0.60}|=0.60=\\frac{3}{5}。\n$$\n计算分母：\n$$\n0.5\\times |C_{profundus}-C_{abyssalis}|=0.5\\times |2.45-3.85|=0.5\\times 1.40=0.70=\\frac{7}{10}。\n$$\n因此，\n$$\nA=\\frac{\\frac{3}{5}}{\\frac{7}{10}}=\\frac{3}{5}\\times \\frac{10}{7}=\\frac{30}{35}=\\frac{6}{7}\\approx 0.857142857。\n$$\n根据解释，$A$ 的值接近 $1$，这表明祖先在形态上更接近其中一个后代，与间断平衡论一致。选项D不被支持，因为考虑到化石年代测定和分子钟通常都存在不确定性，化石年龄略大于分子分歧时间的估计本身并不矛盾。因此，最受支持的结论是间断平衡论。", "answer": "$$\\boxed{B}$$", "id": "1935683"}, {"introduction": "虽然比较几个数据点很有启发性，但古生物学家常常能获得跨越数百万年的连续化石序列，这使得我们可以采用更强大的统计方法来检验进化模式。这个更进阶的练习将向你介绍统计模型选择的现代方法。你将把两个相互竞争的模型——一个渐进的随机游走模型和一个断续的“停滞-跳跃”模型——拟合到一个化石时间序列数据上，然后使用赤池信息准则（Akaike Information Criterion, $AIC$）来确定哪个模型能更好地解释观测数据，同时对模型的复杂性进行惩罚 [@problem_id:1935704]。这项练习展示了进化科学中的辩论是如何通过严谨的定量分析，而不仅仅是争辩来解决的。", "problem": "一位古生物学家正在使用一个提供了数百万年连续化石记录的沉积岩芯，研究一种浮游有孔虫 *Globorotalia mutabilis* 的演化历史。该古生物学家在六个不同的地层层面（对应不同的时间点）测量了大量个体的壳口（壳体的主要开口）的平均大小。收集到的数据如下表所示，其中时间以百万年前 (Mya) 为单位，壳口大小以微米 ($\\mu$m) 为单位。\n\n| 时间 ($t_i$, 百万年前) | 壳口大小 ($z_i$, $\\mu$m) |\n|---|---|\n| 5.0 | 102 |\n| 4.0 | 105 |\n| 3.0 | 99 |\n| 2.0 | 140 |\n| 1.0 | 142 |\n| 0.0 | 138 |\n\n该古生物学家希望检验关于观察到的形态变化模式的两个相互竞争的假说：渐变论与间断平衡论。这两个假说被转化为两个统计模型。\n\n**模型 G (渐变论):** 该模型将演化视为一个连续、无偏的随机游走。性状 $z$ 随时间逐渐变化。对于一系列 $n$ 个观测值，该模型的最大化对数似然 ($\\ln L_G$) 由下式给出：\n$$ \\ln L_G = -\\frac{n-1}{2} \\left[ \\ln(2\\pi \\hat{\\sigma}^2_g) + 1 \\right] $$\n其中 $\\hat{\\sigma}^2_g$ 是估计的方差速率，计算公式为：\n$$ \\hat{\\sigma}^2_g = \\frac{1}{n-1} \\sum_{i=1}^{n-1} \\frac{(z_{i+1} - z_i)^2}{|t_{i+1} - t_i|} $$\n该模型有一个可调参数 ($k_G=1$)，即方差速率 $\\sigma^2_g$。\n\n**模型 P (间断平衡论):** 该模型假设性状在很长一段时间内围绕一个恒定的均值保持停滞，变化在一次爆发事件中迅速发生。根据数据，假设单次爆发事件发生在 3.0 百万年前至 2.0 百万年前之间。这被建模为从一个稳定均值 ($\\mu_1$) 到另一个稳定均值 ($\\mu_2$) 的转变。对于在第 $j$ 次观测后发生转变的一系列 $n$ 个观测值，其最大化对数似然 ($\\ln L_P$) 为：\n$$ \\ln L_P = -\\frac{n}{2} \\left[ \\ln(2\\pi \\hat{\\sigma}^2_p) + 1 \\right] $$\n其中 $\\hat{\\sigma}^2_p$ 是围绕两个均值的合并方差：\n$$ \\hat{\\sigma}^2_p = \\frac{1}{n} \\left( \\sum_{i=1}^{j} (z_i - \\hat{\\mu}_1)^2 + \\sum_{i=j+1}^{n} (z_i - \\hat{\\mu}_2)^2 \\right) $$\n此处，$\\hat{\\mu}_1$ 是前 $j$ 个性状值的平均值，$\\hat{\\mu}_2$ 是剩余 $n-j$ 个性状值的平均值。该模型有三个可调参数 ($k_P = 3$)：两个均值 ($\\mu_1, \\mu_2$) 和方差 ($\\sigma^2_p$)\n\n为了比较这两个模型，你将使用赤池信息准则 (Akaike Information Criterion, AIC)，它为给定数据集提供了一个衡量统计模型相对质量的标准。其定义为 $AIC = 2k - 2 \\ln L$，其中 $k$ 是模型中估计参数的数量，$\\ln L$ 是最大化对数似然。AIC 值较低的模型被认为更拟合数据。\n\n你的任务是计算 AIC 值的差异，$\\Delta AIC = AIC_P - AIC_G$。这个值表明哪个模型更受数据支持。将你的最终答案四舍五入到三位有效数字。", "solution": "我们在时间点 $t_{i}\\in\\{5.0,4.0,3.0,2.0,1.0,0.0\\}$ 百万年前有 $n=6$ 个观测值，对应的性状值为 $z_{i}\\in\\{102,105,99,140,142,138\\}$。由于时间是按降序排列的，我们将每个时间间隔解释为正区间 $\\Delta t_{i}=|t_{i+1}-t_{i}|=1$ 百万年（对于所有 $i=1,\\dots,5$），这样方差速率估计量就保持为非负值。\n\n模型 G (渐变论): 方差速率的估计量为\n$$\n\\hat{\\sigma}^{2}_{g}=\\frac{1}{n-1}\\sum_{i=1}^{n-1}\\frac{(z_{i+1}-z_{i})^{2}}{|t_{i+1}-t_{i}|}.\n$$\n计算 $z$ 的连续差值：\n$$\nz_{2}-z_{1}=3,\\quad z_{3}-z_{2}=-6,\\quad z_{4}-z_{3}=41,\\quad z_{5}-z_{4}=2,\\quad z_{6}-z_{5}=-4,\n$$\n所以它们的平方和为\n$$\n3^{2}+(-6)^{2}+41^{2}+2^{2}+(-4)^{2}=9+36+1681+4+16=1746.\n$$\n由于每个 $|t_{i+1}-t_{i}|=1$，我们得到\n$$\n\\hat{\\sigma}^{2}_{g}=\\frac{1746}{n-1}=\\frac{1746}{5}=349.2.\n$$\n最大化对数似然为\n$$\n\\ln L_{G}=-\\frac{n-1}{2}\\left[\\ln\\!\\big(2\\pi\\hat{\\sigma}^{2}_{g}\\big)+1\\right]\n=-\\frac{5}{2}\\left[\\ln\\!\\left(2\\pi\\cdot\\frac{1746}{5}\\right)+1\\right].\n$$\n计算得，\n$$\n2\\pi\\hat{\\sigma}^{2}_{g}=2\\pi\\cdot 349.2=\\frac{3492}{5}\\pi,\\quad\n\\ln\\!\\big(2\\pi\\hat{\\sigma}^{2}_{g}\\big)\\approx 7.6935218904,\n$$\n所以\n$$\n\\ln L_{G}\\approx -\\frac{5}{2}\\left(7.6935218904+1\\right)=-21.7338047259.\n$$\n当 $k_{G}=1$ 时，AIC 值为\n$$\nAIC_{G}=2k_{G}-2\\ln L_{G}=2-2(-21.7338047259)\\approx 45.4676094519.\n$$\n\n模型 P (间断平衡论): 转变指定在 3.0 和 2.0 百万年前之间，即在第 $j=3$ 次观测之后。那么\n$$\n\\hat{\\mu}_{1}=\\frac{z_{1}+z_{2}+z_{3}}{3}=\\frac{102+105+99}{3}=102,\\qquad\n\\hat{\\mu}_{2}=\\frac{z_{4}+z_{5}+z_{6}}{3}=\\frac{140+142+138}{3}=140.\n$$\n计算合并方差\n$$\n\\hat{\\sigma}^{2}_{p}=\\frac{1}{n}\\left(\\sum_{i=1}^{3}(z_{i}-\\hat{\\mu}_{1})^{2}+\\sum_{i=4}^{6}(z_{i}-\\hat{\\mu}_{2})^{2}\\right).\n$$\n组内平方和：\n$$\n(z_{1}-102)^{2}+(z_{2}-102)^{2}+(z_{3}-102)^{2}=0^{2}+3^{2}+(-3)^{2}=18,\n$$\n$$\n(z_{4}-140)^{2}+(z_{5}-140)^{2}+(z_{6}-140)^{2}=0^{2}+2^{2}+(-2)^{2}=8.\n$$\n因此\n$$\n\\hat{\\sigma}^{2}_{p}=\\frac{18+8}{6}=\\frac{26}{6}=\\frac{13}{3}\\approx 4.3333333333.\n$$\n最大化对数似然为\n$$\n\\ln L_{P}=-\\frac{n}{2}\\left[\\ln\\!\\big(2\\pi\\hat{\\sigma}^{2}_{p}\\big)+1\\right]\n=-\\frac{6}{2}\\left[\\ln\\!\\left(2\\pi\\cdot\\frac{13}{3}\\right)+1\\right].\n$$\n计算得，\n$$\n2\\pi\\hat{\\sigma}^{2}_{p}=2\\pi\\cdot\\frac{13}{3}=\\frac{26}{3}\\pi,\\quad\n\\ln\\!\\big(2\\pi\\hat{\\sigma}^{2}_{p}\\big)=\\ln\\pi+\\ln\\!\\left(\\frac{26}{3}\\right)\\approx 3.3042141352,\n$$\n所以\n$$\n\\ln L_{P}\\approx -3\\left(3.3042141352+1\\right)=-12.9126424056.\n$$\n当 $k_{P}=3$ 时，AIC 值为\n$$\nAIC_{P}=2k_{P}-2\\ln L_{P}=6-2(-12.9126424056)\\approx 31.8252848112.\n$$\n\n所求的差值为\n$$\n\\Delta AIC=AIC_{P}-AIC_{G}\\approx 31.8252848112-45.4676094519=-13.6423246407,\n$$\n四舍五入到三位有效数字为 $-13.6$。负值表示模型 P 的 AIC 值更低，更受这些数据支持。", "answer": "$$\\boxed{-13.6}$$", "id": "1935704"}]}