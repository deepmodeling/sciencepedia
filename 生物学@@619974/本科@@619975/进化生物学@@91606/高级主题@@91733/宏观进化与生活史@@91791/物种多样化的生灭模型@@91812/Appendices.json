{"hands_on_practices": [{"introduction": "即使在物种形成率高于灭绝率（即 $\\lambda > \\mu$）的有利条件下，一个谱系由于随机事件仍然可能完全灭绝，尤其是在其早期、物种数量较少时。这个练习将带你探索生灭过程内在的随机性。通过推导一个新谱系最终灭绝的概率，你将更深刻地理解为什么新兴谱系如此脆弱，并掌握分支过程理论中最经典的一个结论。[@problem_id:1911784]", "problem": "一个进化生物学家团队正在研究一个新的演化支的长期命运。该演化支起源于一个定居在原始、孤立大陆上的单个创始物种。为了模拟其物种多样化过程，他们采用了一个简单的连续时间生死模型。\n\n在这个模型中，适用以下规则：\n1.  该过程在时间 $t=0$ 时始于单个物种。\n2.  大陆上存在的每个物种都具有恒定的单位物种成种率 $\\lambda$。成种是一个物种分裂成两个不同物种的事件。\n3.  每个物种也具有恒定的单位物种灭绝率 $\\mu$。\n4.  如果在任何给定时间存在 $N$ 个物种，则整个演化支的总成种率为 $N\\lambda$，总灭绝率为 $N\\mu$。\n5.  不同物种的进化命运彼此相互独立。\n\n生物学家们正在分析一种环境条件有利于物种多样化的情景，即成种率严格大于灭绝率（$\\lambda > \\mu$）。即使在这些有利条件下，由于随机事件，整个演化支仍有可能灭绝，尤其是在物种数量较少时。\n\n计算这个从单个创始物种开始的整个演化支最终会灭绝的概率。请用 $\\lambda$ 和 $\\mu$ 将您的答案表示为一个解析闭式解。", "solution": "设 $q$ 表示从单个物种开始的演化支最终灭绝的概率。考虑一个长度为 $\\mathrm{d}t$ 的微小时间间隔。在此时间间隔内，对于这个单个物种可能发生三个互斥事件：\n- 以概率 $\\lambda\\,\\mathrm{d}t + o(\\mathrm{d}t)$，发生一次成种事件，产生两个后代物种。根据分支和独立性假设，两个后代谱系会独立地灭绝，因此在该事件发生的情况下，灭绝概率为 $q^{2}$。\n- 以概率 $\\mu\\,\\mathrm{d}t + o(\\mathrm{d}t)$，该物种灭绝，因此整个演化支以概率 $1$ 灭绝。\n- 以概率 $1 - (\\lambda + \\mu)\\,\\mathrm{d}t + o(\\mathrm{d}t)$，没有事件发生，灭绝概率仍然为 $q$。\n\n应用全概率定律并保留 $\\mathrm{d}t$ 的一阶项，可得\n$$\nq \\,=\\, \\lambda\\,\\mathrm{d}t\\, q^{2} \\;+\\; \\mu\\,\\mathrm{d}t \\cdot 1 \\;+\\; \\bigl(1 - (\\lambda + \\mu)\\,\\mathrm{d}t\\bigr)\\, q \\;+\\; o(\\mathrm{d}t).\n$$\n将方程两边减去 $q$，再除以 $\\mathrm{d}t$，然后取 $\\mathrm{d}t \\to 0$ 的极限，得到\n$$\n0 \\,=\\, \\lambda\\,(q^{2} - q) \\;+\\; \\mu\\,(1 - q).\n$$\n整理后得到二次方程\n$$\n\\lambda q^{2} - (\\lambda + \\mu) q + \\mu \\,=\\, 0.\n$$\n该方程可因式分解为\n$$\n(\\lambda q - \\mu)(q - 1) \\,=\\, 0,\n$$\n所以候选解为 $q = \\mu/\\lambda$ 和 $q = 1$。灭绝概率是区间 $[0,1]$ 内与该过程一致的最小根。对于 $\\lambda > \\mu$ 的超临界过程，我们有 $\\mu/\\lambda < 1$，此时的灭绝概率是\n$$\nq \\,=\\, \\frac{\\mu}{\\lambda}.\n$$\n（为完整起见，当 $\\lambda \\leq \\mu$ 时，唯一的可接受根是 $q = 1$。）在题目所设定的 $\\lambda > \\mu$ 的假设下，所求的灭绝概率为 $\\mu/\\lambda$。", "answer": "$$\\boxed{\\frac{\\mu}{\\lambda}}$$", "id": "1911784"}, {"introduction": "在实际的进化生物学研究中，我们常常有多种相互竞争的假说（即模型）来解释在系统发育树中观察到的多样化模式。这个练习介绍了一种强大的模型选择统计工具——赤池信息准则（Akaike Information Criterion, AIC）。AIC 让我们能够比较不同模型对数据的拟合优度，同时对过于复杂的模型进行惩罚。通过这个练习，你将学会如何在实践中应用理论模型，从而权衡支持不同宏观进化情景（如恒定速率多样化与多样性依赖性物种形成）的证据。[@problem_id:1911781]", "problem": "一位进化生物学家正在使用一个经过时间校准的分子系统发育树，研究一个深海珊瑚分支的物种多样化动态。为了检验关于宏观进化过程的竞争性假说，该生物学家将两种不同的随机生灭模型与系统发育树中观察到的分支时间进行拟合。\n\n第一个模型是恒定速率生灭 (CR-BD) 模型。该模型假定物种形成速率 ($\\lambda$) 和灭绝速率 ($\\mu$) 在所有时间和所有谱系中都是恒定的。由于该模型估计两个参数（$\\lambda$ 和 $\\mu$），因此它有 $k=2$ 个自由参数。经过数值优化，该模型的最大对数似然值为 $\\ln(L_{\\text{CR-BD}}) = -152.8$。\n\n第二个模型是多样性依赖物种形成 (DDS) 模型。该模型假设灭绝速率 ($\\mu$) 是恒定的，但物种形成速率随着同时代谱系数量 $N$ 的增加而线性下降。物种形成速率由 $\\lambda(N) = \\lambda_0 - \\alpha N$ 给出，其中 $\\lambda_0$ 是初始物种形成速率，$\\alpha$ 量化了多样性依赖的强度。该模型有三个自由参数（$\\lambda_0$、$\\alpha$ 和 $\\mu$），所以 $k=3$。DDS 模型的最大对数似然值为 $\\ln(L_{\\text{DDS}}) = -149.5$。\n\n为了比较这两个模型的解释力，同时对 DDS 模型增加的复杂性进行惩罚，该生物学家使用了一种基于赤池信息准则 (AIC) 的模型选择方法。一个模型的 AIC 值使用以下公式计算：\n$$ \\text{AIC} = 2k - 2\\ln(L) $$\n其中 $k$ 是模型中自由参数的数量，$\\ln(L)$ 是最大化后的对数似然值。更低的 AIC 值表示拟合效果更好的模型。\n\n集合中每个模型的相对支持度可以用赤池权重 $w_i$ 来表示。要为一个来自 $R$ 个候选模型集合中的模型 $i$ 计算该值，首先计算其 AIC 值与集合中最小 AIC 值之间的差值：$\\Delta_i = \\text{AIC}_i - \\text{AIC}_{\\text{min}}$。模型 $i$ 的赤池权重则由下式给出：\n$$ w_i = \\frac{\\exp(-\\frac{1}{2}\\Delta_i)}{\\sum_{j=1}^{R} \\exp(-\\frac{1}{2}\\Delta_j)} $$\n赤池权重 $w_i$ 可以解释为在给定数据的情况下，模型 $i$ 是该模型集合中最佳模型的概率。\n\n使用所提供的信息，计算多样性依赖物种形成 (DDS) 模型的赤池权重。将您的最终答案四舍五入到三位有效数字。", "solution": "我们需要使用赤池信息准则来比较两个模型。根据定义，\n$$ \\text{AIC} = 2k - 2\\ln(L). $$\n\n对于 CR-BD 模型，其 $k=2$ 且 $\\ln(L_{\\text{CR-BD}})=-152.8$，\n$$ \\text{AIC}_{\\text{CR-BD}} = 2\\cdot 2 - 2(-152.8) = 4 + 305.6 = 309.6. $$\n\n对于 DDS 模型，其 $k=3$ 且 $\\ln(L_{\\text{DDS}})=-149.5$，\n$$ \\text{AIC}_{\\text{DDS}} = 2\\cdot 3 - 2(-149.5) = 6 + 299.0 = 305.0. $$\n\n最小的 AIC 是 $\\text{AIC}_{\\text{min}}=305.0$ (DDS模型)。AIC 的差值是\n$$ \\Delta_{\\text{DDS}} = 305.0 - 305.0 = 0, \\quad \\Delta_{\\text{CR-BD}} = 309.6 - 305.0 = 4.6. $$\n\n对于 $R=2$ 个模型，DDS 模型的赤池权重是\n$$ w_{\\text{DDS}} = \\frac{\\exp\\!\\left(-\\frac{1}{2}\\Delta_{\\text{DDS}}\\right)}{\\exp\\!\\left(-\\frac{1}{2}\\Delta_{\\text{DDS}}\\right) + \\exp\\!\\left(-\\frac{1}{2}\\Delta_{\\text{CR-BD}}\\right)} = \\frac{1}{1 + \\exp\\!\\left(-\\frac{1}{2}\\cdot 4.6\\right)} = \\frac{1}{1 + \\exp(-2.3)}. $$\n\n数值上，$\\exp(-2.3) \\approx 0.1002588435$，因此\n$$ w_{\\text{DDS}} \\approx \\frac{1}{1 + 0.1002588435} \\approx 0.908877. $$\n\n四舍五入到三位有效数字得到 $0.909$。", "answer": "$$\\boxed{0.909}$$", "id": "1911781"}, {"introduction": "在使用像 AIC 这样的方法选出“最佳”模型后，关键的下一步是：这个模型真的能很好地代表现实吗？从一堆糟糕的模型中选出最好的一个，其信息量并不大。这个练习介绍了使用模拟进行拟合优度检验的概念。通过将真实数据的某个特征（本例中为树的不平衡度）与在模型下模拟出的数据中该特征的分布进行比较，我们可以评估该模型是否是一个合理的解释。这个实践完善了科学建模的全过程，从模型拟合和选择推进到模型评估，强调了批判性地评估模型而非盲目接受的重要性。[@problem_id:1911791]", "problem": "一位演化生物学家正在研究一个特定演化支的多样化动态，该演化支包含10个现存物种。代表它们之间演化关系的一棵系统发育树已被重建。该生物学家希望评估所观测到的树形是否与一个恒定速率多样化的简单模型（即生灭过程）相符。\n\n为此，研究人员计算了观测树的一个特定不平衡度指标。这个“总体不平衡分数”的计算方法如下：对于树中的9个内部节点（分枝点）中的每一个，计算从该节点分出的两个子演化支中末端物种（叶尖）数量的绝对差值。整棵树的总体不平衡分数是所有内部节点上这些绝对差值的总和。\n\n对于观测到的经验树，其9个内部节点上物种的划分由以下数对给出，其中每一对 $(N_L, N_R)$ 分别代表左侧和右侧子演化支中的物种数量：\n\n(1, 9), (1, 8), (1, 7), (1, 6), (1, 5), (1, 4), (1, 3), (1, 2), (1, 1)\n\n为了确定所观测树的不平衡度是否异常，该生物学家的研究团队进行了大量的模拟。他们假设该演化支的演化遵循恒定速率的生灭模型，并在此假设下生成了2000棵各含10个物种的不同系统发育树。对于这2000棵模拟树中的每一棵，他们都计算了相同的总体不平衡分数。他们的分析显示，在这批模拟树中，有82棵的总体不平衡分数大于或等于从观测的经验树计算出的分数。\n\n根据这些信息，计算统计p值。p值代表在原假设（即该演化支遵循模拟所用的恒定速率生灭过程）下，观测到一棵与经验树一样不平衡或更不平衡的树的概率。请将答案表示为小数形式，并保留三位有效数字。", "solution": "将具有9个内部节点的有根二叉树的总体不平衡分数定义为\n$$\nS=\\sum_{j=1}^{9}\\left|N_{L,j}-N_{R,j}\\right|,\n$$\n其中 $N_{L,j}$ 和 $N_{R,j}$ 是内部节点 $j$ 处左侧和右侧子演化支中的叶尖数量。对于观测到的树，给出的数对为 $(1,9),(1,8),(1,7),(1,6),(1,5),(1,4),(1,3),(1,2),(1,1)$，因此绝对差值分别为 $8,7,6,5,4,3,2,1,0$，其总和为\n$$\nS_{\\text{obs}}=8+7+6+5+4+3+2+1+0=36.\n$$\n为了在原假设（恒定速率生灭过程）下评估其显著性，我们使用基于模拟树的蒙特卡洛p值。如果生成了 $M$ 棵模拟树，其中有 $k$ 棵树满足 $S^{(i)}\\geq S_{\\text{obs}}$，那么上尾p值的蒙特卡洛估计值为\n$$\n\\hat{p}=\\frac{k}{M}.\n$$\n此处，$M=2000$ 且 $k=82$，所以\n$$\n\\hat{p}=\\frac{82}{2000}=\\frac{41}{1000}=0.041.\n$$\n四舍五入到三位有效数字，结果为 $0.0410$。", "answer": "$$\\boxed{0.0410}$$", "id": "1911791"}]}