{"hands_on_practices": [{"introduction": "理解基于智能体的模型（Agent-Based Models, ABMs）的最佳方式之一是亲手执行一次模拟。这个练习将一个寄主-寄生物系统的动态过程分解为最核心的要素：智能体、状态、环境和规则。通过逐步遵循一个严格定义的时间步骤和事件顺序，你将体验到模型是如何随时间演化的，并理解精确的规则执行在计算模拟中的基础性作用 [@problem_id:1840965]。", "problem": "考虑一个简单的基于主体的模型 (Agent-Based Model, ABM)，该模型旨在模拟一种不可恢复的寄生虫在一个小型宿主种群中的传播。环境是一个一维线性栖息地，由一排5个格子表示，依次标记为1到5。模拟开始时有3个宿主主体，名为 A、B 和 C。\n\n系统在时间 $t=0$ 时的初始状态如下：\n- 宿主 A：易感状态，位于格子1。\n- 宿主 B：已感染状态，位于格子3。\n- 宿主 C：易感状态，位于格子5。\n\n模拟以离散时间步 ($t=1, 2, ...$) 进行。在每个时间步内，所有事件都按照以下严格顺序发生：1. 移动，2. 感染，3. 死亡。\n\n主体的规则如下：\n\n1.  **移动规则**：\n    - 已感染的宿主是静止的，不移动。\n    - 易感宿主总是移动。移动方向取决于其当前所在的格子 $i$：\n        - 如果宿主位于末端格子（格子1或5），它会移动到相邻的内部格子（分别为格子2或4）。\n        - 如果宿主位于偶数编号的格子 ($i \\in \\{2, 4\\}$)，它会向右移动一个格子（到格子 $i+1$）。\n        - 如果宿主位于奇数编号的内部格子 ($i = 3$)，它会向左移动一个格子（到格子 $i-1$）。\n\n2.  **感染规则**：\n    - 移动阶段完成后，如果一个易感宿主与一个或多个已感染宿主位于同一个格子，该易感宿主会立即被感染。这一状态变化适用于当前时间步内所有后续阶段。\n\n3.  **死亡规则**：\n    - 易感宿主在任何时间步的死亡概率为0%。\n    - 已感染宿主在任何时间步的死亡概率为25% ($p=0.25$)。\n    - 为确保模拟的确定性，任何概率性死亡事件的结果都是预先确定的。如果从预先提供的随机抽取值列表中取出的一个值小于或等于事件的概率 $p$，则该事件（死亡）发生。\n    - 在模拟过程中，用于每次死亡判定的随机抽取值列表（按顺序使用）为：[0.88, 0.41, 0.19, 0.95]。\n    - 如果在同一个时间步内有多个宿主需要进行死亡判定，则按照其名称的字母顺序进行检查（即，先A，后B，再C）。\n\n你的任务是手动运行此模拟两个完整的时间步（直到 $t=2$ 结束）。在第二个时间步结束时，系统中存活宿主的总数是多少？", "solution": "我们在每个时间步中按照指定的规则顺序进行模拟：移动，然后感染，然后死亡。对于一个已感染的宿主，当且仅当从列表中抽取的下一个随机值 $u$ 满足 $u \\leq p$（其中 $p=0.25$）时，它才会在判定中死亡。如果在同一个时间步内有多个已感染宿主需要判定，顺序是先A，后B，再C。\n\n$t=0$ 时的初始状态：\n- A：易感，位于格子 $1$。\n- B：已感染，位于格子 $3$。\n- C：易感，位于格子 $5$。\n\n时间步 $t=1$：\n- 移动：\n  - 已感染的宿主不移动，所以 B 停留在格子 $3$。\n  - A 是易感状态，位于格子 $1$（末端格子），所以它移动到格子 $2$。\n  - C 是易感状态，位于格子 $5$（末端格子），所以它移动到格子 $4$。\n  - 移动后结果：A 在格子 $2$（易感），B 在格子 $3$（已感染），C 在格子 $4$（易感）。\n- 感染：\n  - A 和 C 没有与任何已感染宿主（B在格子 $3$）位于同一格子，所以没有新的感染发生。\n  - 状态保持不变：A 易感，B 已感染，C 易感。\n- 死亡：\n  - 只有已感染的 B 符合判定条件。使用第一个随机抽取值 $u=0.88$ 与 $p=0.25$ 比较。由于 $0.88>0.25$，B 存活。\n  - $t=1$ 结束时：A 在格子 $2$（易感），B 在格子 $3$（已感染），C 在格子 $4$（易感）。三个宿主都存活。\n\n时间步 $t=2$：\n- 移动：\n  - B 是已感染状态，不移动，停留在格子 $3$。\n  - A 是易感状态，位于偶数格子 $2$，所以它向右移动到格子 $3$。\n  - C 是易感状态，位于偶数格子 $4$，所以它向右移动到格子 $5$。\n  - 移动后结果：A 在格子 $3$（易感），B 在格子 $3$（已感染），C 在格子 $5$（易感）。\n- 感染：\n  - A 与已感染的 B 共同位于格子 $3$，所以 A 立即被感染。\n  - 感染后状态：A 已感染，B 已感染，C 易感。\n- 死亡：\n  - 此步骤需要进行死亡判定的已感染宿主是 A 和 B，按字母顺序。\n  - 对于 A：使用第二个随机抽取值 $u=0.41$。由于 $0.41>0.25$，A 存活。\n  - 对于 B：使用第三个随机抽取值 $u=0.19$。由于 $0.19\\leq 0.25$，B 死亡并被移除。\n  - C 是易感状态，不进行死亡判定。\n\n在 $t=2$ 结束时，存活的宿主是 A（已感染）和 C（易感），总共有 $2$ 个存活宿主。", "answer": "$$\\boxed{2}$$", "id": "1840965"}, {"introduction": "在掌握了基础模拟的步骤后，我们现在将挑战一个更复杂、更贴近生态现实的场景。这个练习引入了二维空间、具有不同目标的智能体类型（捕食者与猎物），以及更为精密的决策逻辑，例如基于距离最小化或最大化的移动策略。它旨在让你体会到，在建模过程中，如何将“追捕猎物”或“躲避天敌”这类直观行为转化为精确、无歧义的计算规则 [@problem_id:1840954]。", "problem": "一位生态学家正在开发一个简单的基于代理的模型（ABM），用以模拟离散景观上的捕食者-猎物动态。环境由一个 5x5 的网格表示，其整数坐标为 $(x, y)$，其中 $x, y \\in \\{1, 2, 3, 4, 5\\}$。该模拟涉及两种类型的代理：捕食者 (P) 和猎物 (Y)。在任何时刻，一个网格方块最多只能被一个代理占据。两个方块之间的距离使用曼哈顿距离计算：$d = |x_1 - x_2| + |y_1 - y_2|$。\n\n在时间 $t=0$ 时，系统的初始状态如下：\n- 一只捕食者位于位置 $P_0 = (3,3)$。\n- 两只猎物位于位置 $Y_{A,0} = (1,3)$ 和 $Y_{B,0} = (5,2)$。\n\n模拟以离散的时间步进行。在每个时间步（从 $t$ 到 $t+1$），以下行动按严格的顺序发生：\n\n1.  **捕食者行动：** 捕食者的探测半径为 $R_d = 3$。它会识别此半径内的所有猎物。然后，它会朝着唯一能使其与*最近*的被探测到的猎物的曼哈顿距离最小化的方向移动一步（到一个相邻的方块，即上、下、左、右）。如果有多只猎物同样近，捕食者会选择 y 坐标较小的那只；如果仍然平局，则选择 x 坐标较小的那只。如果有多个移动方向（北、东、南、西）都能达到相同的最小距离，捕食者的移动优先级为：北 (y+1)，然后是东 (x+1)，然后是南 (y-1)，然后是西 (x-1)。移动后，如果捕食者的新方块被一只猎物占据，该猎物将被吃掉并从模拟中移除。\n\n2.  **猎物移动：** 每只存活的猎物移动一步到一个相邻的（上、下、左、右）、未被占据的方块。移动方向的选择是为了*最大化*其与捕食者新位置（在步骤1的行动之后）的曼哈顿距离。如果多个移动方向都能达到相同的最大距离，猎物移动的优先级为：西 (x-1)，然后是南 (y-1)，然后是东 (x+1)，然后是北 (y+1)。猎物会尝试其最高优先级的有效移动；如果该方块在网格之外或已被占据，它会尝试次高优先级的有效移动，以此类推。如果所有四个可能的移动都无效，猎物将停留在当前位置。所有猎物的移动都是基于此阶段开始时的网格状态来计算的。\n\n3.  **猎物繁殖：** 在移动阶段后仍在网格上的每只猎物都会进行繁殖。对于每只进行繁殖的猎物，会在一个相邻的、未被占据的方块上创建一个新的后代。后代的放置位置通过按固定的优先级顺序（北、东、南、西）检查父代相邻的方块来确定。第一个可用的空方块被选为后代的出生地。如果没有相邻的空方块，该猎物在此时间步内不会繁殖。繁殖过程是顺序的：猎物按 x 坐标递增的顺序进行处理，若 x 坐标相同，则按 y 坐标递增的顺序处理。\n\n从 $t=0$ 的初始条件开始，确定在时间步 $t=2$ 结束时网格上猎物的总数。", "solution": "我们在一个 $5 \\times 5$ 的网格上进行计算，使用曼哈顿距离 $d=\\lvert x_{1}-x_{2}\\rvert+\\lvert y_{1}-y_{2}\\rvert$。在 $t=0$ 时的初始位置为：捕食者 $P_{0}=(3,3)$，猎物 $Y_{A,0}=(1,3)$ 和 $Y_{B,0}=(5,2)$。\n\n从 $t=0$ 到 $t=1$：\n1) 捕食者行动。探测半径 $R_{d}=3$。从 $(3,3)$ 出发的距离：\n$$d\\big((3,3),(1,3)\\big)=|3-1|+|3-3|=2,\\quad d\\big((3,3),(5,2)\\big)=|3-5|+|3-2|=2+1=3.$$\n最近的是位于 $(1,3)$ 的 $Y_{A}$。捕食者移动一步以最小化到 $(1,3)$ 的距离。从 $(3,3)$ 出发的候选移动：\n- 北 $N:(3,4)\\Rightarrow d=|3-1|+|4-3|=3$,\n- 东 $E:(4,3)\\Rightarrow d=|4-1|+|3-3|=3$,\n- 南 $S:(3,2)\\Rightarrow d=|3-1|+|2-3|=3$,\n- 西 $W:(2,3)\\Rightarrow d=|2-1|+|3-3|=1$。\n最小的是西 (W)，所以捕食者移动到 $(2,3)$ 并且没有捕食（该方块未被占据）。\n\n2) 猎物移动，基于捕食者在 $(2,3)$ 的位置和当前占据情况 $\\{(2,3),(1,3),(5,2)\\}$。\n- 在 $(1,3)$ 的猎物 $Y_{A}$：移动以最大化与 $(2,3)$ 的距离。选项：西(W):$(0,3)$ 无效；南(S):$(1,2)$ 距离为 $|1-2|+|2-3|=2$ 有效；东(E):$(2,3)$ 被占据；北(N):$(1,4)$ 距离为 $|1-2|+|4-3|=2$ 有效。在距离2处出现平局；根据 W,S,E,N 的优先级，选择南(S)。所以 $Y_{A}\\to(1,2)$。\n- 在 $(5,2)$ 的猎物 $Y_{B}$：相对于 $(2,3)$ 的选项：西(W):$(4,2)$ 距离为 $|4-2|+|2-3|=3$；南(S):$(5,1)$ 距离为 $|5-2|+|1-3|=5$；东(E):$(6,2)$ 无效；北(N):$(5,3)$ 距离为 $|5-2|+|3-3|=3$。最大值为5，在南(S)方向，所以 $Y_{B}\\to(5,1)$。\n\n新的猎物位置：$(1,2)$ 和 $(5,1)$。捕食者在 $(2,3)$。\n\n3) 猎物繁殖，按 x 递增再按 y 递增的顺序，将后代按 N,E,S,W 的顺序放置在空的相邻方块上。\n- 父代在 $(1,2)$：北(N):$(1,3)$ 为空，所以后代在 $(1,3)$。\n- 父代在 $(5,1)$：北(N):$(5,2)$ 为空，所以后代在 $(5,2)$。\n$t=1$ 结束时：捕食者在 $(2,3)$；猎物在 $(1,2)$、$(1,3)$、$(5,1)$、$(5,2)$。\n\n从 $t=1$ 到 $t=2$：\n1) 捕食者从 $(2,3)$ 行动，探测半径 $R_{d}=3$。距离：\n$$d\\big((2,3),(1,2)\\big)=|2-1|+|3-2|=2,\\quad d\\big((2,3),(1,3)\\big)=|2-1|+|3-3|=1,$$\n$$d\\big((2,3),(5,1)\\big)=|2-5|+|3-1|=5,\\quad d\\big((2,3),(5,2)\\big)=|2-5|+|3-2|=4.$$\n探测到的猎物是 $(1,3)$ 和 $(1,2)$；最近的是 $(1,3)$。捕食者从 $(2,3)$ 移动：\n- 西(W):$(1,3)$ 得到距离 $0$（其他方向得到距离 $2$），所以向西(W)移动到 $(1,3)$ 并吃掉在 $(1,3)$ 的猎物。\n\n2) 猎物移动，此时捕食者在 $(1,3)$；开始时存活的猎物在：$(1,2)$, $(5,1)$, $(5,2)$。\n- 在 $(1,2)$ 的猎物：相对于 $(1,3)$ 的选项：西(W):$(0,2)$ 无效；南(S):$(1,1)$ 距离为 $|1-1|+|1-3|=2$ 有效；东(E):$(2,2)$ 距离为 $|2-1|+|2-3|=2$ 有效；北(N):$(1,3)$ 被占据。在距离2处出现平局；根据 W,S,E,N 的优先级，选择南(S)。移动到 $(1,1)$。\n- 在 $(5,1)$ 的猎物：相对于 $(1,3)$ 的选项：西(W):$(4,1)$ 距离为 $|4-1|+|1-3|=5$ 有效；南(S):$(5,0)$ 无效；东(E):$(6,1)$ 无效；北(N):$(5,2)$ 被占据。所以移动到 $(4,1)$。\n- 在 $(5,2)$ 的猎物：相对于 $(1,3)$ 的选项：西(W):$(4,2)$ 距离为 $|4-1|+|2-3|=4$ 有效；南(S):$(5,1)$ 被占据；东(E):$(6,2)$ 无效；北(N):$(5,3)$ 距离为 $|5-1|+|3-3|=4$ 有效。在距离4处出现平局；根据优先级选择西(W)。移动到 $(4,2)$。\n\n移动后：猎物在 $(1,1)$, $(4,1)$, $(4,2)$。\n\n3) 猎物繁殖，顺序为 $(1,1)$, $(4,1)$, $(4,2)$；后代放置顺序为 N,E,S,W。\n- 父代 $(1,1)$：北(N):$(1,2)$ 为空，后代在 $(1,2)$。\n- 父代 $(4,1)$：北(N):$(4,2)$ 被占据；东(E):$(5,1)$ 为空，后代在 $(5,1)$。\n- 父代 $(4,2)$：北(N):$(4,3)$ 为空，后代在 $(4,3)$。\n\n$t=2$ 结束时：猎物在 $(1,1)$、$(1,2)$、$(4,1)$、$(4,2)$、$(5,1)$、$(4,3)$，总共有 $6$ 只猎物。", "answer": "$$\\boxed{6}$$", "id": "1840954"}, {"introduction": "前面的练习中，智能体的行为规则是预先给定的。但在实际研究中，这些规则源自何处？本练习将探讨如何从基本的生态学原理——最优觅食理论——中推导出智能体的行为策略。通过对智能体面临的权衡（如能量获取与繁殖需求）进行建模，我们将计算出能使其适应性最大化的最优策略，从而为构建ABM中的行为规则提供理论依据 [@problem_id:1840908]。", "problem": "一位生态学家正在为一只独居蜂开发一个简单的基于智能体的模型，以理解其最优觅食策略。这只蜜蜂在一个包含两种花卉的环境中觅食：A种花卉提供高糖低花粉含量的花蜜，而B种花卉提供低糖高花粉含量的花蜜。\n\n模型包含以下参数：\n- 单次访问A种花卉产生 $S_A$ 单位的糖和 $P_A$ 单位的花粉。\n- 单次访问B种花卉产生 $S_B$ 单位的糖和 $P_B$ 单位的花粉。\n- 每次觅食访问，无论花卉种类如何，蜜蜂为自身生存（例如，飞行和体温调节）都需要消耗 $C_E$ 单位糖的代谢能量。\n- 为了抚育其后代，蜜蜂通过将收集的花粉与糖混合来制造“育儿粮”。这个过程需要一个固定的比例，即每单位花粉需要 $k$ 单位的糖。这部分糖用于抚育，不能用于蜜蜂自身的代谢。\n\n假设蜜蜂的适应度与其为幼虫收集和抚育的花粉总量成正比。这只蜜蜂是一个“最优觅食者”，它寻求最大化其一生中的花粉收集总量。它只能在满足其总糖摄入量足以覆盖其代谢成本和抚育所收集花粉所需糖分的约束条件下，才能追求这一目标。蜜蜂采用一种固定的混合觅食策略，其中它将其总觅食访问次数的比例 $x$ 用于访问A种花卉，剩余的比例 $(1-x)$ 用于访问B种花卉。\n\n给定以下参数值：\n- $S_A = 10.0$ 单位糖\n- $P_A = 2.0$ 单位花粉\n- $S_B = 3.0$ 单位糖\n- $P_B = 12.0$ 单位花粉\n- $C_E = 2.5$ 单位糖\n- $k = 0.5$ 单位糖/单位花粉\n\n确定访问A种花卉的最优比例 $x$，以使蜜蜂的总花粉收集量最大化。将最终答案四舍五入到三位有效数字。", "solution": "设蜜蜂选择将比例为 $x$ 的访问次数用于A种花卉，比例为 $(1-x)$ 用于B种花卉。每次访问的期望糖摄入量为\n$$S(x)=x S_{A}+(1-x) S_{B}=S_{B}+x\\left(S_{A}-S_{B}\\right),$$\n每次访问的期望花粉收集量为\n$$P(x)=x P_{A}+(1-x) P_{B}=P_{B}+x\\left(P_{A}-P_{B}\\right).$$\n每次访问会产生 $C_{E}$ 的代谢糖成本，剩下 $S(x)-C_{E}$ 单位的糖可用于抚育。由于抚育每单位花粉需要 $k$ 单位的糖，因此每次访问可抚育的最大花粉量受限于\n$$\\frac{S(x)-C_{E}}{k}.$$\n因此，每次访问抚育的花粉量为\n$$\\min\\!\\left(P(x),\\,\\frac{S(x)-C_{E}}{k}\\right).$$\n为了在 $x\\in[0,1]$ 的范围内最大化这个最小值，最优解出现在两个参数相等的地方（前提是交点在 $[0,1]$ 区间内）。这是因为如果 $P(x)$ 低于糖的上限，增加 $(1-x)$ 以提高 $P(x)$ 会改善最小值；而如果 $P(x)$ 超过糖的上限，增加 $x$ 以提高 $S(x)$（相对于 $P(x)$）也会改善最小值。因此，我们令\n$$P(x)=\\frac{S(x)-C_{E}}{k}.$$\n代入线性形式，\n$$P_{B}+x\\left(P_{A}-P_{B}\\right)=\\frac{S_{B}+x\\left(S_{A}-S_{B}\\right)-C_{E}}{k}.$$\n两边乘以 $k$ 并重新整理关于 $x$ 的项，\n$$k P_{B}+k x\\left(P_{A}-P_{B}\\right)=S_{B}-C_{E}+x\\left(S_{A}-S_{B}\\right),$$\n$$x\\left[k\\left(P_{A}-P_{B}\\right)-\\left(S_{A}-S_{B}\\right)\\right]=S_{B}-C_{E}-k P_{B},$$\n$$x=\\frac{S_{B}-C_{E}-k P_{B}}{k\\left(P_{A}-P_{B}\\right)-\\left(S_{A}-S_{B}\\right)}.$$\n现在代入给定的参数值 $S_{A}=10.0$，$P_{A}=2.0$，$S_{B}=3.0$，$P_{B}=12.0$，$C_{E}=2.5$ 和 $k=0.5$：\n$$\\text{分子}=S_{B}-C_{E}-k P_{B}=3.0-2.5-0.5\\cdot 12.0=-5.5,$$\n$$\\text{分母}=k\\left(P_{A}-P_{B}\\right)-\\left(S_{A}-S_{B}\\right)=0.5\\cdot(2.0-12.0)-(10.0-3.0)=-5-7=-12.$$\n因此，\n$$x=\\frac{-5.5}{-12}=\\frac{11}{24}\\approx 0.458333\\ldots.$$\n这个值在区间 $[0,1]$ 内，因此是可行的，并得到了交点处的最优解。四舍五入到三位有效数字得到 $0.458$。", "answer": "$$\\boxed{0.458}$$", "id": "1840908"}]}