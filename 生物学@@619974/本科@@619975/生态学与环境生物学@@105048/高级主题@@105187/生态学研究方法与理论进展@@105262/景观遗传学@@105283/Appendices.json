{"hands_on_practices": [{"introduction": "景观遗传学的核心原则之一是，景观特征对基因流的阻碍作用（“环境隔离”）可能远大于地理距离本身（“距离隔离”）。本练习提供了一种量化理解这一概念的方法。通过计算并比较两种情景下的遗传分化（以 $F_{ST}$ 衡量），你将亲身体会到，一个显著的地理屏障（如峡谷）如何从根本上改变对种群连通性的预测，即便是在地理距离相对较近的情况下。[@problem_id:1858467]", "problem": "一位保护生物学家正在研究一种稀有的高山蝾螈 *Ambystoma montivagus* 的种群遗传学。该研究侧重于两种不同的景观情景。\n\n**情景1（峡谷）：** 种群Alpha和种群Beta被地理距离 $d_A = 35$ km 分隔。然而，它们的栖息地被一个深邃干旱的峡谷分开，该峡谷对蝾螈的扩散构成了重要障碍。\n\n**情景2（山脊）：** 种群Gamma和种群Delta生活在同一条连续的山脊上，由适宜的森林栖息地相连。它们被地理距离 $d_B = 70$ km 分隔。\n\n该生物学家使用一个模型，其中通过固定指数（$F_{ST}$）测量的遗传分化与每代有效迁移体数量（$N_e m$）通过以下方程相关联：\n$$F_{ST} = \\frac{1}{1 + 4N_e m}$$\n此外，景观特征影响迁移体的数量。$N_e m$ 的模型由下式给出：\n$$N_e m = \\frac{C}{d_{eff}}$$\n其中 $C$ 是一个物种特有的扩散常数，$d_{eff}$ 是种群间的有效距离。有效距离的计算方法是地理距离（公里）加上任何障碍物带来的额外“距离成本”。沿连续山脊的移动没有额外的成本。然而，峡谷造成了一个扩散屏障，相当于 $B = 295$ km 的距离成本。对于这种蝾螈，扩散常数为 $C = 6600 \\text{ km}$。\n\n计算峡谷分隔种群对（Alpha-Beta）与山脊分隔种群对（Gamma-Delta）的遗传分化之比。换句话说，计算 $\\frac{F_{ST, \\text{canyon}}}{F_{ST, \\text{ridge}}}$ 的值。将最终答案四舍五入到三位有效数字。", "solution": "题目要求计算两对蝾螈种群之间遗传分化（$F_{ST}$）的比率。我们已知将 $F_{ST}$ 与每代有效迁移体数量（$N_e m$）以及将 $N_e m$ 与有效距离（$d_{eff}$）关联起来的模型。\n\n给定的模型是：\n1.  $F_{ST} = \\frac{1}{1 + 4N_e m}$\n2.  $N_e m = \\frac{C}{d_{eff}}$\n\n我们需要为两种情景计算这个值：峡谷分隔的种群对和山脊分隔的种群对。\n\n**第一步：分析情景1（峡谷种群对：Alpha-Beta）**\n\n首先，我们计算有效距离 $d_{eff, \\text{canyon}}$。地理距离为 $d_A = 35$ km。峡谷带来了额外的距离成本 $B = 295$ km。\n$$d_{eff, \\text{canyon}} = d_A + B = 35 \\text{ km} + 295 \\text{ km} = 330 \\text{ km}$$\n\n接着，我们使用给定的扩散常数 $C = 6600$ km 计算有效迁移体数量 $(N_e m)_{\\text{canyon}}$。\n$$(N_e m)_{\\text{canyon}} = \\frac{C}{d_{eff, \\text{canyon}}} = \\frac{6600 \\text{ km}}{330 \\text{ km}} = 20$$\n\n现在，我们可以求出峡谷种群对的遗传分化 $F_{ST, \\text{canyon}}$。\n$$F_{ST, \\text{canyon}} = \\frac{1}{1 + 4(N_e m)_{\\text{canyon}}} = \\frac{1}{1 + 4(20)} = \\frac{1}{1 + 80} = \\frac{1}{81}$$\n\n**第二步：分析情景2（山脊种群对：Gamma-Delta）**\n\n首先，我们计算有效距离 $d_{eff, \\text{ridge}}$。地理距离为 $d_B = 70$ km。沿连续山脊移动没有额外的障碍成本。\n$$d_{eff, \\text{ridge}} = d_B = 70 \\text{ km}$$\n\n接着，我们计算有效迁移体数量 $(N_e m)_{\\text{ridge}}$。\n$$(N_e m)_{\\text{ridge}} = \\frac{C}{d_{eff, \\text{ridge}}} = \\frac{6600 \\text{ km}}{70 \\text{ km}} = \\frac{660}{7}$$\n\n现在，我们求出山脊种群对的遗传分化 $F_{ST, \\text{ridge}}$。\n$$F_{ST, \\text{ridge}} = \\frac{1}{1 + 4(N_e m)_{\\text{ridge}}} = \\frac{1}{1 + 4\\left(\\frac{660}{7}\\right)} = \\frac{1}{1 + \\frac{2640}{7}} = \\frac{1}{\\frac{7}{7} + \\frac{2640}{7}} = \\frac{1}{\\frac{2647}{7}} = \\frac{7}{2647}$$\n\n**第三步：计算比率**\n\n所求的量是比率 $\\frac{F_{ST, \\text{canyon}}}{F_{ST, \\text{ridge}}}$。\n$$\\frac{F_{ST, \\text{canyon}}}{F_{ST, \\text{ridge}}} = \\frac{\\frac{1}{81}}{\\frac{7}{2647}}$$\n要除以一个分数，我们乘以它的倒数：\n$$\\frac{F_{ST, \\text{canyon}}}{F_{ST, \\text{ridge}}} = \\frac{1}{81} \\times \\frac{2647}{7} = \\frac{2647}{81 \\times 7} = \\frac{2647}{567}$$\n\n最后，我们进行除法运算得到数值答案。\n$$\\frac{2647}{567} \\approx 4.668430335...$$\n\n题目要求将最终答案四舍五入到三位有效数字。\n前三位有效数字是4、6和6。下一位数字是8，大于或等于5，因此我们将最后一位有效数字向上取整。\n$$4.668... \\approx 4.67$$\n\n遗传分化的比率约为4.67。这表明，尽管山脊种群的地理距离是峡谷种群的两倍，但峡谷分隔的种群的遗传分化程度是山脊种群的4.6倍以上。这突显了障碍物对限制基因流的强大影响。", "answer": "$$\\boxed{4.67}$$", "id": "1858467"}, {"introduction": "在理解了景观会阻碍生物移动后，下一个关键问题是如何模拟这一过程。本练习将介绍一种核心工具：最小成本路径分析，让你扮演景观生态学家的角色，为一只动物在复杂多样的地形中规划扩散路径。通过计算生物体的最有效路线，本练习将“景观阻力”这一抽象概念变得具体可操作，这对于预测基因流走廊和评估栖息地连通性至关重要。[@problem_id:1858466]", "problem": "一位保护生物学家正在研究一种栖息于森林的啮齿动物——白足鼠（*Peromyscus leucopus*）——在破碎化景观中的扩散情况。研究区域被绘制成一个5行4列的矩形网格。网格中的每个单元格代表一个方形地块，并由其坐标 `(row, column)` 标识，其中 `1 \\le \\text{row} \\le 5` 且 `1 \\le \\text{column} \\le 4`。\n\n该景观由三种类型的地形组成，每种地形都有一个不同的“阻力”值，该值量化了老鼠穿越的难度：\n- 森林 (F)：阻力 = 1.0\n- 农田 (A)：阻力 = 4.5\n- 城市区域 (U)：阻力 = 20.0\n\n网格中地形类型的布局如下：\n- 第1行：F, A, A, U\n- 第2行：F, F, A, U\n- 第3行：A, F, A, A\n- 第4行：A, F, F, F\n- 第5行：A, A, A, F\n\n老鼠只能在相邻的单元格之间移动，可以是水平或垂直移动（不能斜向移动）。从一个单元格移动到相邻单元格的单次移动成本定义为这两个单元格阻力值的平均值。一条路径的总累积阻力是构成该路径的所有单次移动成本的总和。\n\n一只老鼠从位于单元格 `(1, 1)` 的一个森林地块开始，需要扩散到位于单元格 `(5, 4)` 的另一个合适的森林地块。计算此次扩散事件的最小可能累积阻力。将最终答案四舍五入到三位有效数字。", "solution": "设单元格 $v$ 的阻力为 $r(v)$。从相邻单元格 $v$ 移动到 $w$ 的成本为\n$$\n\\frac{r(v)+r(w)}{2}.\n$$\n对于一条路径 $P=(v_{0},v_{1},\\dots,v_{k})$，其总成本为\n$$\n\\sum_{t=0}^{k-1}\\frac{r(v_{t})+r(v_{t+1})}{2}\n=\\frac{1}{2}\\left(r(v_{0})+2\\sum_{t=1}^{k-1}r(v_{t})+r(v_{k})\\right).\n$$\n此处 $v_{0}=(1,1)$ 且 $v_{k}=(5,4)$，两者都是森林单元格，其 $r(v_{0})=r(v_{k})=1$。因此，任何路径的总成本为\n$$\n\\frac{1}{2}(1+1)+\\sum_{t=1}^{k-1}r(v_{t})=1+\\sum_{t=1}^{k-1}r(v_{t}).\n$$\n等价地，总成本等于 $1$ 加上路径上所有内部单元格的阻力之和。由于所有阻力都满足 $r(v)\\geq 1$，因此每次移动的成本至少为 $1$，所以任何 $k$ 步的路径成本至少为 $k$。从 $(1,1)$ 到 $(5,4)$ 的曼哈顿距离为\n$$\n|5-1|+|4-1|=4+3=7,\n$$\n所以任何路径都必须至少有 $7$ 步，从而得出总成本的下界为 $7$。\n\n下面展示一条完全在森林单元格上前进而达到此下界的路径：\n$$(1,1)\\to(2,1)\\to(2,2)\\to(3,2)\\to(4,2)\\to(4,3)\\to(4,4)\\to(5,4)。$$\n这条路径有 $7$ 次移动，且每次移动都在森林单元格之间，因此每次移动的成本为\n$$\n\\frac{1+1}{2}=1,\n$$\n总成本为 $7$。因此，最小可能累积阻力是 $7$。四舍五入到三位有效数字，得到 $7.00$。", "answer": "$$\\boxed{7.00}$$", "id": "1858466"}, {"introduction": "现在，我们将视角从个体路径提升到整个种群网络，这在破碎化栖息地的物种保护中非常常见。这项高级练习运用图论来模拟基因流的完整网络，旨在识别出那些对维持整个系统遗传健康至关重要的“关键种群”。通过解决这个问题，你将看到景观遗传学原理如何直接应用于制定战略性的、数据驱动的保护决策。[@problem_id:1858473]", "problem": "在景观遗传学领域，保护工作通常侧重于维持种群间的连通性，以确保稳健的基因流。一个种群网络可以被建模为一个图，其中每个种群是一个节点，任意两个种群之间基因流的“成本”是边的权重。\n\n一位保护生物学家正在研究一个由五个濒危猫科动物的残存种群组成的网络，这些种群被标记为 A、B、C、D 和 E。利用基因组数据，她估算了一个成对的“基因流阻力”值的对称矩阵 $R_{ij}$，其中较高的值表示基因在种群 $i$ 和 $j$ 之间移动的难度更大。该阻力矩阵如下：\n\n$$\nR = \n\\begin{pmatrix}\n & \\text{A} & \\text{B} & \\text{C} & \\text{D} & \\text{E} \\\\\n\\text{A} & 0 & 2 & 8 & 9 & 3 \\\\\n\\text{B} & 2 & 0 & 1 & 7 & 5 \\\\\n\\text{C} & 8 & 1 & 0 & 6 & 4 \\\\\n\\text{D} & 9 & 7 & 6 & 0 & 10 \\\\\n\\text{E} & 3 & 5 & 4 & 10 & 0\n\\end{pmatrix}\n$$\n\n该网络被建模为一个完全加权图，其中任意两个节点之间的边权重是它们在矩阵 $R$ 中对应的阻力值。两个种群之间的“基因流路径长度”定义为该图中对应节点之间的最短路径距离。网络的“平均最短路径长度”是所有唯一成对最短路径长度的总和，除以唯一成对的总数。\n\n为了优先分配保护资源，这位生物学家希望识别出唯一的“关键种群”。关键种群被定义为：从网络中移除该种群后，会导致剩余种群的平均最短路径长度出现最大*增长*的那个种群。\n\n这五个种群中，哪一个是该网络的关键种群？\n\nA. 种群 A\n\nB. 种群 B\n\nC. 种群 C\n\nD. 种群 D\n\nE. 种群 E", "solution": "将五个种群建模为一个完全加权图的顶点集 $V=\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E}\\}$，其边权重为 $w(i,j)=R_{ij}$。对于任意两个顶点 $i,j$，最短路径距离 $d(i,j)$ 是 $i$ 和 $j$ 之间所有路径中，沿路径的边权重之和的最小值。\n\n首先，计算完整图中所有点对之间的最短路径距离。对于每个无序对，将直接边的权重与可能的两跳或三跳路径的权重进行比较，以确保最优性。\n\n- 对于 $\\text{A}$-$\\text{B}$：直接距离为 $2$；任何间接路径都更长。因此 $d(\\text{A},\\text{B})=2$。\n- 对于 $\\text{A}$-$\\text{C}$：直接距离为 $8$；经由 $\\text{B}$：$2+1=3$；经由 $\\text{E}$：$3+4=7$；其他路径更长。因此 $d(\\text{A},\\text{C})=3$。\n- 对于 $\\text{A}$-$\\text{D}$：直接距离为 $9$；经由 $\\text{B}$：$2+7=9$；经由 $\\text{C}$：$8+6=14$（或使用 $d(\\text{A},\\text{C})=3$ 得到 $3+6=9$）；经由 $\\text{E}$：$3+10=13$。因此 $d(\\text{A},\\text{D})=9$。\n- 对于 $\\text{A}$-$\\text{E}$：直接距离为 $3$；任何间接路径至少为 $5$。因此 $d(\\text{A},\\text{E})=3$。\n- 对于 $\\text{B}$-$\\text{C}$：直接距离为 $1$；任何间接路径都更长。因此 $d(\\text{B},\\text{C})=1$。\n- 对于 $\\text{B}$-$\\text{D}$：直接距离为 $7$；经由 $\\text{C}$：$1+6=7$；其他路径更长。因此 $d(\\text{B},\\text{D})=7$。\n- 对于 $\\text{B}$-$\\text{E}$：直接距离为 $5$；经由 $\\text{C}$：$1+4=5$；经由 $\\text{A}$：$2+3=5$；其他路径更长。因此 $d(\\text{B},\\text{E})=5$。\n- 对于 $\\text{C}$-$\\text{D}$：直接距离为 $6$；其他路径更长。因此 $d(\\text{C},\\text{D})=6$。\n- 对于 $\\text{C}$-$\\text{E}$：直接距离为 $4$；其他路径 $\\geq 6$。因此 $d(\\text{C},\\text{E})=4$。\n- 对于 $\\text{D}$-$\\text{E}$：直接距离为 $10$；经由 $\\text{C}$：$6+4=10$；其他路径更长。因此 $d(\\text{D},\\text{E})=10$。\n\n所有 $10$ 个唯一成对最短路径距离的总和是\n$$\nS_{\\text{all}}=2+3+9+3+1+7+5+6+4+10=50,\n$$\n得到总体平均最短路径长度 $\\bar{d}_{\\text{all}}=50/10=5$，此处仅供参考。\n\n关键种群是移除后导致剩余顶点之间平均最短路径长度增量最大的那个种群。对于每个要移除的候选顶点 $v\\in V$，令 $S=V\\setminus\\{v\\}$。对于每个无序对 $\\{i,j\\}\\subset S$，比较 $d_{\\text{full}}(i,j)$（如上计算，允许所有节点）与 $d_{-v}(i,j)$（在 $S$ 上的导出子图中的最短路径，即不允许 $v$ 作为中间节点）。计算这 $\\binom{4}{2}=6$ 个点对的平均值以找出增量。\n\n1) 移除 $\\text{A}$：$S=\\{\\text{B},\\text{C},\\text{D},\\text{E}\\}$，点对为\n$\\{\\text{B},\\text{C}\\},\\{\\text{B},\\text{D}\\},\\{\\text{B},\\text{E}\\},\\{\\text{C},\\text{D}\\},\\{\\text{C},\\text{E}\\},\\{\\text{D},\\text{E}\\}$。\n在完整图中，这些距离分别为 $1,7,5,6,4,10$。这些最短路径中没有一条是必须经过 $\\text{A}$ 的（例如，$\\text{B}\\text{E}=5$ 有不经过 $\\text{A}$ 的路径，如直接连接的 $5$ 或经由 $\\text{C}$ 的 $1+4=5$）。因此，移除 $\\text{A}$ 后每个点对的距离 $d_{-\\text{A}}$ 保持不变，总和仍为 $33$，平均值仍为 $33/6=5.5$。这些点对之间的平均距离没有增加。\n\n2) 移除 $\\text{B}$：$S=\\{\\text{A},\\text{C},\\text{D},\\text{E}\\}$，点对为\n$\\{\\text{A},\\text{C}\\},\\{\\text{A},\\text{D}\\},\\{\\text{A},\\text{E}\\},\\{\\text{C},\\text{D}\\},\\{\\text{C},\\text{E}\\},\\{\\text{D},\\text{E}\\}$。\n在完整图中，这些距离分别为 $3,9,3,6,4,10$。只有 $\\text{A}\\text{C}$ 的最短路径关键地经过了 $\\text{B}$：如果没有 $\\text{B}$，重新计算\n$$\nd_{-\\text{B}}(\\text{A},\\text{C})=\\min\\{8,\\;3+4,\\;9+6,\\;3+10+6\\}=\\min\\{8,7,15,19\\}=7.\n$$\n所有其他点对的距离与之前相同。因此，新的总和是 $7+9+3+6+4+10=39$，平均值为 $39/6=6.5$。这些点对的平均距离增量为 $(39-35)/6=4/6$。\n\n3) 移除 $\\text{C}$：$S=\\{\\text{A},\\text{B},\\text{D},\\text{E}\\}$，点对为\n$\\{\\text{A},\\text{B}\\},\\{\\text{A},\\text{D}\\},\\{\\text{A},\\text{E}\\},\\{\\text{B},\\text{D}\\},\\{\\text{B},\\text{E}\\},\\{\\text{D},\\text{E}\\}$。\n在完整图中，这些距离分别为 $2,9,3,7,5,10$。对于每个点对，都存在不经过 $\\text{C}$ 的最短路径（例如，$\\text{B}\\text{D}$ 直接距离为 $7$；$\\text{A}\\text{D}$ 直接距离为 $9$ 或经由 $\\text{B}$：$2+7=9$）。因此，移除后的距离不变；总和为 $36$，平均值为 $36/6=6$。这些点对之间的平均距离没有增加。\n\n4) 移除 $\\text{D}$：$S=\\{\\text{A},\\text{B},\\text{C},\\text{E}\\}$，点对为\n$\\{\\text{A},\\text{B}\\},\\{\\text{A},\\text{C}\\},\\{\\text{A},\\text{E}\\},\\{\\text{B},\\text{C}\\},\\{\\text{B},\\text{E}\\},\\{\\text{C},\\text{E}\\}$。\n在完整图中，这些距离分别为 $2,3,3,1,5,4$。其最短路径均不经过 $\\text{D}$；因此总和仍为 $18$，平均值为 $18/6=3$。这些点对之间的平均距离没有增加。\n\n5) 移除 $\\text{E}$：$S=\\{\\text{A},\\text{B},\\text{C},\\text{D}\\}$，点对为\n$\\{\\text{A},\\text{B}\\},\\{\\text{A},\\text{C}\\},\\{\\text{A},\\text{D}\\},\\{\\text{B},\\text{C}\\},\\{\\text{B},\\text{D}\\},\\{\\text{C},\\text{D}\\}$。\n在完整图中，这些距离分别为 $2,3,9,1,7,6$。其最短路径均不经过 $\\text{E}$；因此总和仍为 $28$，平均值为 $28/6$。这些点对之间的平均距离没有增加。\n\n因此，只有移除 $\\text{B}$ 会增加剩余种群间的最短路径距离，具体而言，它将 $d(\\text{A},\\text{C})$ 从 $3$ 增加到 $7$，从而将这组点对的平均距离从 $35/6$ 提高到 $39/6$。因此，关键种群是 $\\text{B}$。\n\n因此，正确选项是 B。", "answer": "$$\\boxed{B}$$", "id": "1858473"}]}