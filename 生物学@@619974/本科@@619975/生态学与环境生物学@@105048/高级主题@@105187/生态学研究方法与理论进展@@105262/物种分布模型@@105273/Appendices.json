{"hands_on_practices": [{"introduction": "一个有效的物种分布模型始于对物种生态学的深刻理解。本练习将通过一个简化的数学模型，向你展示为何具有狭窄环境耐受性的“特化物种”通常比“泛化物种”能产生更“尖锐”、更具预测性的模型。通过这个练习，你将把生态位宽度这一生物学概念与模型的可预测性直接联系起来[@problem_id:1882305]。", "problem": "一位生态学家正在为两种假想的甲虫物种开发物种分布模型（SDMs），以了解它们的存在与土壤酸度的关系。该生态学家假设，在给定地点发现每个物种的概率主要由该地点的土壤pH值决定。\n\n- 物种S是“特化物种”，已知仅在狭窄的酸性土壤范围内才能茁壮成长。\n- 物种G是“泛化物种”，能耐受更广泛的土壤pH值范围。\n\n基于大量的实地数据，该生态学家将存在概率 $P(x)$ 建模为土壤pH值（由变量 $x$ 表示）的函数。对于这两个物种，其存在概率遵循高斯响应曲线：\n$$P(x) = \\exp\\left(-\\frac{(x - x_{opt})^2}{2\\sigma^2}\\right)$$\n在此模型中，$x_{opt}$ 代表物种最可能被发现的最适土壤pH值，参数 $\\sigma$ 量化了物种的生态位宽度。较小的 $\\sigma$ 表示特化物种，而较大的 $\\sigma$ 表示泛化物种。\n\n模型参数确定如下：\n- 对两个物种而言，最适pH值为 $x_{opt} = 5.5$。\n- 对于特化物种S，其生态位宽度参数为 $\\sigma_S = 0.4$。\n- 对于泛化物种G，其生态位宽度参数为 $\\sigma_G = 2.0$。\n\n对于给定的环境条件，一个物种分布模型（SDM）的“预测锐度”可以与存在概率随该环境变化而变化的速率相关联。具有更高最大变化率（更陡的梯度）的模型被认为具有更强的预测能力，因为环境中的微小差异会导致预测概率产生巨大而明确的变化。\n\n计算特化物种S的存在概率的最大可能变化率与泛化物种G的存在概率的最大可能变化率之比。即，计算比率 $\\frac{\\max|dP_S/dx|}{\\max|dP_G/dx|}$ 的值。你的答案应该是一个实数。", "solution": "对于一个给定参数 $x_{opt}$ 和 $\\sigma$ 的物种，其存在概率为\n$$\nP(x)=\\exp\\!\\left(-\\frac{(x-x_{opt})^{2}}{2\\sigma^{2}}\\right).\n$$\n使用链式法则对 $x$ 求导。设\n$$\nE(x)=-\\frac{(x-x_{opt})^{2}}{2\\sigma^{2}},\n$$\n则 $P(x)=\\exp(E(x))$ 且\n$$\n\\frac{dP}{dx}=\\exp(E(x))\\frac{dE}{dx}.\n$$\n计算\n$$\n\\frac{dE}{dx}=-\\frac{1}{2\\sigma^{2}}\\cdot 2(x-x_{opt})=-\\frac{x-x_{opt}}{\\sigma^{2}},\n$$\n因此\n$$\n\\frac{dP}{dx}=-\\frac{x-x_{opt}}{\\sigma^{2}}\\exp\\!\\left(-\\frac{(x-x_{opt})^{2}}{2\\sigma^{2}}\\right).\n$$\n绝对变化率为\n$$\n\\left|\\frac{dP}{dx}\\right|=\\frac{|x-x_{opt}|}{\\sigma^{2}}\\exp\\!\\left(-\\frac{(x-x_{opt})^{2}}{2\\sigma^{2}}\\right).\n$$\n设 $y=|x-x_{opt}|$ 且 $y\\ge 0$，并定义\n$$\nf(y)=\\frac{y}{\\sigma^{2}}\\exp\\!\\left(-\\frac{y^{2}}{2\\sigma^{2}}\\right).\n$$\n为求 $f$ 的最大值，对其求导：\n$$\nf'(y)=\\frac{1}{\\sigma^{2}}\\exp\\!\\left(-\\frac{y^{2}}{2\\sigma^{2}}\\right)+\\frac{y}{\\sigma^{2}}\\exp\\!\\left(-\\frac{y^{2}}{2\\sigma^{2}}\\right)\\left(-\\frac{y}{\\sigma^{2}}\\right)\n=\\exp\\!\\left(-\\frac{y^{2}}{2\\sigma^{2}}\\right)\\left(\\frac{1}{\\sigma^{2}}-\\frac{y^{2}}{\\sigma^{4}}\\right).\n$$\n令 $f'(y)=0$ 以寻找临界点：\n$$\n\\frac{1}{\\sigma^{2}}-\\frac{y^{2}}{\\sigma^{4}}=0\\quad\\Longrightarrow\\quad y^{2}=\\sigma^{2}\\quad\\Longrightarrow\\quad y=\\sigma.\n$$\n由于当 $y=0$ 时 $f(0)=0$ 且当 $y\\to\\infty$ 时 $f(y)\\to 0$，因此在 $y=\\sigma$ 处的临界点给出全局最大值。因此，最大绝对斜率为\n$$\n\\max\\left|\\frac{dP}{dx}\\right|=f(\\sigma)=\\frac{\\sigma}{\\sigma^{2}}\\exp\\!\\left(-\\frac{\\sigma^{2}}{2\\sigma^{2}}\\right)=\\frac{1}{\\sigma}\\exp\\!\\left(-\\frac{1}{2}\\right).\n$$\n对于分别具有 $\\sigma_{S}$ 和 $\\sigma_{G}$ 的物种S和G，\n$$\n\\frac{\\max|dP_{S}/dx|}{\\max|dP_{G}/dx|}=\\frac{\\exp(-1/2)/\\sigma_{S}}{\\exp(-1/2)/\\sigma_{G}}=\\frac{\\sigma_{G}}{\\sigma_{S}}.\n$$\n代入 $\\sigma_{S}=0.4$ 和 $\\sigma_{G}=2.0$ 可得\n$$\n\\frac{\\max|dP_{S}/dx|}{\\max|dP_{G}/dx|}=\\frac{2.0}{0.4}=5.\n$$", "answer": "$$\\boxed{5}$$", "id": "1882305"}, {"introduction": "在理解了物种的生态习性之后，下一步是准备我们的环境变量。环境数据之间常常存在相关性（例如，温度与海拔），这个问题被称为“多重共线性”，它会使模型不稳定。本练习提供了一个标准技术——方差膨胀因子（$VIF$）的实践，用于系统地识别和移除冗余的预测变量，以确保模型更加稳健和易于解释[@problem_id:1882322]。", "problem": "一位生态学家正在为一种珍稀的高山植物物种开发物种分布模型 (SDM)。为避免多重共线性问题，该生态学家决定使用基于方差膨胀因子 (VIF) 的逐步选择程序，对一组四个潜在的气候预测变量进行预处理。最初的变量集是：\n- $V_1$：年平均温度\n- $V_2$：年总降水量\n- $V_3$：年温差\n- $V_4$：海拔\n\n预测变量 $V_j$ 的 VIF 计算公式为 $VIF_j = \\frac{1}{1 - R^2_j}$，其中 $R^2_j$ 是将 $V_j$ 对当前集合中所有其他预测变量进行线性回归得到的决定系数。\n\n选择程序如下：\n1. 计算当前集合中所有变量的 VIF。\n2. 找出 VIF 最高的变量。\n3. 如果这个最高的 VIF 大于 5.0 的阈值，则从集合中移除该变量。\n4. 对剩余的变量重复此过程，直到集合中所有变量的 VIF 都小于或等于 5.0。\n\n线性回归分析提供了以下数据：\n\n**第 1 轮 (集合: {$V_1, V_2, V_3, V_4$}):**\n- $V_1$ 对 {$V_2, V_3, V_4$} 的回归：$R^2_1 = 0.980$\n- $V_2$ 对 {$V_1, V_3, V_4$} 的回归：$R^2_2 = 0.600$\n- $V_3$ 对 {$V_1, V_2, V_4$} 的回归：$R^2_3 = 0.750$\n- $V_4$ 对 {$V_1, V_2, V_3$} 的回归：$R^2_4 = 0.970$\n\n从第 1 轮中移除 VIF 最高的变量后，重复进行分析。\n\n**第 2 轮 (剩余变量):**\n设剩余变量为一个新集合。这个新集合的决定系数如下：\n- $V_2$ 对 {$V_3, V_4$} 的回归：$R^2_2 = 0.450$\n- $V_3$ 对 {$V_2, V_4$} 的回归：$R^2_3 = 0.300$\n- $V_4$ 对 {$V_2, V_3$} 的回归：$R^2_4 = 0.820$\n\n从第 2 轮中移除 VIF 最高的变量后，对最后一对变量重复进行分析。\n\n**第 3 轮 (最后一对):**\n- 两个剩余变量之间回归的决定系数为 0.200。\n\n根据这个逐步选择程序，最终模型应保留哪一组变量？\n\nA. {$V_1, V_2$}\n\nB. {$V_2, V_3$}\n\nC. {$V_2, V_4$}\n\nD. {$V_1, V_3, V_4$}\n\nE. {$V_2, V_3, V_4$}", "solution": "题目要求我们使用方差膨胀因子 (VIF) 进行逐步变量选择，移除阈值为 5.0。变量 $V_j$ 的 VIF 由公式 $VIF_j = \\frac{1}{1 - R^2_j}$ 给出。\n\n**第 1 轮：初始集合 {$V_1, V_2, V_3, V_4$}**\n\n首先，我们使用所提供的 $R^2$ 值计算四个初始变量中每一个的 VIF。\n\n对于 $V_1$：\n$VIF_1 = \\frac{1}{1 - R^2_1} = \\frac{1}{1 - 0.980} = \\frac{1}{0.020} = 50.0$\n\n对于 $V_2$：\n$VIF_2 = \\frac{1}{1 - R^2_2} = \\frac{1}{1 - 0.600} = \\frac{1}{0.400} = 2.5$\n\n对于 $V_3$：\n$VIF_3 = \\frac{1}{1 - R^2_3} = \\frac{1}{1 - 0.750} = \\frac{1}{0.250} = 4.0$\n\n对于 $V_4$：\n$VIF_4 = \\frac{1}{1 - R^2_4} = \\frac{1}{1 - 0.970} = \\frac{1}{0.030} \\approx 33.33$\n\n计算出的 VIF 值为：$VIF_1 = 50.0$，$VIF_2 = 2.5$，$VIF_3 = 4.0$，以及 $VIF_4 \\approx 33.33$。\n\n根据程序，我们找出 VIF 最高的变量。这个变量是 $V_1$，其 $VIF_1 = 50.0$。\n然后我们将此值与 5.0 的阈值进行比较。由于 $50.0 > 5.0$，我们必须移除变量 $V_1$。\n\n下一轮的剩余变量集是 {$V_2, V_3, V_4$}。\n\n**第 2 轮：集合 {$V_2, V_3, V_4$}**\n\n现在我们对剩余的变量重复此过程，使用为第 2 轮提供的 $R^2$ 值。请注意，第 2 轮的问题陈述是自洽的，并不要求我们知道移除了哪个变量，但我们的逐步推导已确定该变量为 $V_1$，因此新的回归是 $V_2$ 对 {$V_3, V_4$}，$V_3$ 对 {$V_2, V_4$}，以及 $V_4$ 对 {$V_2, V_3$}。\n\n对于 $V_2$：\n$VIF_2 = \\frac{1}{1 - R^2_2} = \\frac{1}{1 - 0.450} = \\frac{1}{0.550} \\approx 1.82$\n\n对于 $V_3$：\n$VIF_3 = \\frac{1}{1 - R^2_3} = \\frac{1}{1 - 0.300} = \\frac{1}{0.700} \\approx 1.43$\n\n对于 $V_4$：\n$VIF_4 = \\frac{1}{1 - R^2_4} = \\frac{1}{1 - 0.820} = \\frac{1}{0.180} \\approx 5.56$\n\n新的 VIF 值为：$VIF_2 \\approx 1.82$，$VIF_3 \\approx 1.43$，以及 $VIF_4 \\approx 5.56$。\n\n在这个集合中 VIF 最高的变量是 $V_4$，其 $VIF_4 \\approx 5.56$。\n我们将此值与阈值进行比较：$5.56 > 5.0$。因此，我们必须移除变量 $V_4$。\n\n剩余变量集是 {$V_2, V_3$}。\n\n**第 3 轮：集合 {$V_2, V_3$}**\n\n最后，我们分析最后一对剩余变量 {$V_2, V_3$}。当只有两个变量时，它们的 VIF 相同。$V_2$ 对 $V_3$ 回归的 $R^2$ 与 $V_3$ 对 $V_2$ 回归的 $R^2$ 相同。题目说明这个值为 0.200。\n\n两个剩余变量的 VIF 都是：\n$VIF_{final} = \\frac{1}{1 - 0.200} = \\frac{1}{0.800} = 1.25$\n\n我们检查这个 VIF 值是否大于 5.0 的阈值。由于 $1.25 \\le 5.0$，移除条件不满足。逐步选择程序停止。\n\n最终模型要保留的变量集是 {$V_2, V_3$}。这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1882322"}, {"introduction": "当我们用精心挑选的变量构建好模型后，必须评估其性能。一个关键的步骤是理解模型可能犯的错误类型。本练习以雪豹为例，介绍了“错分误差”（commission error）和“漏分误差”（omission error）这两个基本概念，这对于解读模型输出和理解其在现实世界中的保护意义至关重要[@problem_id:1882310]。", "problem": "一位保护生物学家正在使用物种分布模型（SDM），这是一种将物种出现数据与环境变量相关联，以预测物种可能分布区域的工具。目标物种是稀有且难以捉摸的雪豹（*Panthera uncia*）。该模型生成一张生境适宜性地图，将山地划分为“适宜”和“不适宜”区域。为验证模型的准确性，该生物学家将模型的预测结果与新的实地数据进行比较。\n\n考虑验证过程中的以下两个独立结果：\n\n*   **结果1：** SDM预测一个偏远的山谷为“适宜”生境。然而，使用相机陷阱进行为期一年的全面实地调查未能在此山谷中发现任何雪豹的踪迹。\n*   **结果2：** 当地护林员在一个被SDM划分为“不适宜”生境的山脉中发现了一个新的、先前未知的雪豹种群。\n\n从SDM预测的角度来看，以下哪个陈述正确地指出了每个结果所代表的错误类型？\n\nA. 结果1代表漏报错误，结果2代表误报错误。\nB. 结果1代表误报错误，结果2代表漏报错误。\nC. 结果1和结果2都代表漏报错误。\nD. 结果1和结果2都代表误报错误。", "solution": "将SDM的预测定义为 $P \\in \\{\\text{suitable}, \\text{unsuitable}\\}$，将实地验证的真实情况定义为 $R \\in \\{\\text{presence}, \\text{absence}\\}$。在模型验证术语中：\n- 误报错误（error of commission）是假阳性（false positive）：模型预测为适宜（或存在），而现实情况为不存在。用符号表示，即 $P=\\text{suitable}$ 且 $R=\\text{absence}$。\n- 漏报错误（error of omission）是假阴性（false negative）：模型预测为不适宜（或不存在），而现实情况为存在。用符号表示，即 $P=\\text{unsuitable}$ 且 $R=\\text{presence}$。\n\n将这些定义应用于每个结果：\n- 结果1：SDM预测为适宜，但全面的实地调查未能发现该物种，这在验证中被视为不存在的证据。因此，$P=\\text{suitable}$ 且 $R=\\text{absence}$，这符合误报错误。\n- 结果2：SDM预测为不适宜，但护林员发现了一个种群，因此 $P=\\text{unsuitable}$ 且 $R=\\text{presence}$，这符合漏报错误。\n\n因此，结果1是误报错误，结果2是漏报错误，对应于选项B。", "answer": "$$\\boxed{B}$$", "id": "1882310"}]}