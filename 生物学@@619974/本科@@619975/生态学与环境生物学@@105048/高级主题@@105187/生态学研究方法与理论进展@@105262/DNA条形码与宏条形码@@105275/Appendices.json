{"hands_on_practices": [{"introduction": "DNA宏条形码技术（Metabarcoding）的核心产出是大量的DNA序列读数。在生态学研究中，最基础的分析步骤之一就是将这些读数与参考数据库进行比对，然后计算每个物种的相对丰度。这个练习将指导你完成这一基本计算，帮助你理解如何从原始测序数据中解读群落结构，同时强调在计算时精确定义分析对象（例如，仅限于鱼类）的重要性。[@problem_id:1839364]", "problem": "一位环境科学家正在使用环境DNA（eDNA）宏条形码方法，评估新建的 Willow Creek Restoration Site 的鱼类生物多样性。研究人员采集了一个1升的水样，并从中提取了DNA。一个常用于鱼类鉴定的特定基因区域——12S核糖体RNA基因——通过聚合酶链式反应（PCR）进行扩增，并进行了测序。\n\n此次测序共产生了5,250,000条高质量的序列读数。将这些序列与参考数据库进行比对后，这些读数被分配到不同的分类群组。结果如下：\n\n- 分配给 *Perca flavescens* (金鲈) 的读数：1,157,000\n- 分配给 *Lepomis macrochirus* (蓝鳃太阳鱼) 的读数：842,000\n- 分配给 *Ameiurus natalis* (黄鮰) 的读数：235,000\n- 分配给 *Cyprinus carpio* (鲤鱼) 的读数：1,486,000\n- 来自未鉴定真核生物的读数（在鱼类数据库中没有可靠匹配的序列）：980,000\n- 来自细菌的读数：515,000\n- 分配给 *Homo sapiens* (人类) 的读数，可能来自样本处理过程中的污染：35,000\n\n计算在检测到的总*鱼类*群落中，检测到的最频繁的*鱼类*物种的相对读数丰度。将您的答案以小数形式表示，并四舍五入到三位有效数字。", "solution": "题目要求我们计算在检测到的总鱼类群落中，检测到的最频繁鱼类物种的相对读数丰度。分配给鱼类的读数如下：\n- *Perca flavescens* 的读数为 $1{,}157{,}000$，\n- *Lepomis macrochirus* 的读数为 $842{,}000$，\n- *Ameiurus natalis* 的读数为 $235{,}000$，\n- *Cyprinus carpio* 的读数为 $1{,}486{,}000$。\n\n根据定义，非鱼类读数（未鉴定的真核生物、细菌、人类）不计入作为分母的鱼类群落总数中。\n\n鱼类读数的总数为\n$$\nS=1{,}157{,}000+842{,}000+235{,}000+1{,}486{,}000=3{,}720{,}000.\n$$\n检测到的最频繁的鱼类物种是 *Cyprinus carpio*，其读数为\n$$\nM=1{,}486{,}000.\n$$\n因此，相对读数丰度为\n$$\nA=\\frac{M}{S}=\\frac{1{,}486{,}000}{3{,}720{,}000}=\\frac{1486}{3720}=\\frac{743}{1860}\\approx 0.399462\\ldots\n$$\n四舍五入到三位有效数字，结果是\n$$\n0.399.\n$$", "answer": "$$\\boxed{0.399}$$", "id": "1839364"}, {"introduction": "原始的宏条形码数据并非完美无瑕，其中可能包含测序错误或极低丰度的序列（“单例”），这些都可能干扰生态学结论。因此，在进行深入分析之前，必须进行数据清洗和质量控制，这是一个至关重要的生物信息学步骤。通过这个练习，你将亲身体验如何应用一个典型的过滤规则来剔除潜在的噪声，并评估该过程如何影响我们对物种丰富度的最终评估。[@problem_id:1839382]", "problem": "一位生态学家正在研究土地利用历史对土壤真菌多样性的影响。他们比较了两个相邻的森林地块：地块A是一片超过200年未受干扰的老龄林，地块B则是一片30年前在昔日农田上重新造林的区域。该研究使用了DNA宏条形码技术，这是一种通过对特定遗传标记进行测序，从而从单一环境样本中识别多个物种的方法。在本研究中，研究人员对真菌的内转录间隔区（ITS）进行了测序，并将得到的DNA序列在97%的相似性阈值下聚类为操作分类单元（OTU）。每个OTU被视为一个独立真菌物种的代表。\n\n初始原始数据分析提供了以下计数：\n- 两个地块合计鉴定出的独特OTU总数为600。\n- 地块A中初步发现的物种丰富度（OTU总数）为450。\n- 地块B中初步发现的物种丰富度（OTU总数）为350。\n\n为确保数据质量，应用了一套筛选方案。该方案规定，如果一个OTU在其出现的所有地块中都是“单序列OTU”（singleton，即仅由一条DNA序列读数代表），那么它将被从研究中完全移除。单序列OTU的详细分类如下：\n- 有40个OTU仅在地块A中发现且是单序列OTU。\n- 有25个OTU仅在地块B中发现且是单序列OTU。\n- 有15个OTU在两个地块中均有发现，且在地块A和地块B中都是单序列OTU。\n- 有10个OTU在两个地块中均有发现，其在地块A中是单序列OTU，但在地块B中有多条读数。\n- 有5个OTU在两个地块中均有发现，其在地块B中是单序列OTU，但在地块A中有多条读数。\n\n您的任务是计算地块A和地块B经过筛选后的最终物种丰富度。一个地块的最终物种丰富度是指筛选过程完成后，该地块列表中剩余的独特OTU的总数。", "solution": "设 $S_{A}$ 和 $S_{B}$ 分别表示地块A和地块B的初始物种丰富度（OTU数量），筛选规则为：如果一个OTU在其出现的所有地块中都是单序列OTU，则将其完全移除。\n\n已知：\n$$S_{A}=450,\\quad S_{B}=350,$$\n以及单序列OTU的分类：\n- 仅在A中且为单序列：$40$ (完全移除，仅影响A)。\n- 仅在B中且为单序列：$25$ (完全移除，仅影响B)。\n- 在A和B中均为单序列：$15$ (从两者中完全移除)。\n- 在两者中均有，在A中为单序列但在B中为多序列：$10$ (在两者中均保留)。\n- 在两者中均有，在B中为单序列但在A中为多序列：$5$ (在两者中均保留)。\n\n因此，从地块A中移除的OTU数量是那些仅在A中为单序列的OTU与在两个地块中均为单序列的OTU之和：\n$$R_{A}=40+15=55,$$\n而从地块B中移除的数量是：\n$$R_{B}=25+15=40.$$\n\n因此，筛选后的最终丰富度为：\n$$S_{A}^{\\prime}=S_{A}-R_{A}=450-55=395,$$\n$$S_{B}^{\\prime}=S_{B}-R_{B}=350-40=310.$$\n\n使用并集进行一致性检验，可以证实这个结果。初始并集为 $600$。从研究中被完全移除的OTU有 $40+25+15=80$ 个，因此筛选后的并集为 $600-80=520$。筛选后的交集为\n$$\\left(S_{A}^{\\prime}+S_{B}^{\\prime}\\right)-520=395+310-520=185,$$\n这与初始交集 $200$ 减去被移除的 $15$ 个重叠OTU（在两个地块中均为单序列）后的结果相符，即 $200-15=185$。", "answer": "$$\\boxed{\\begin{pmatrix}395 & 310\\end{pmatrix}}$$", "id": "1839382"}, {"introduction": "在下一代测序中，一些技术性假象（artifacts）可能会系统性地扭曲结果，其中“索引跳跃”（index hopping）是一个值得关注的问题，尤其当DNA浓度差异巨大的样品被混合测序时。这种现象可能导致物种在它们本不应出现的样品中被“检测”到，从而产生假阳性结果。本练习要求你建立一个简单的数学模型，利用观察到的数据来量化这一技术误差的影响，这模拟了研究人员在面对复杂测序结果时所采用的诊断和校正思维过程。[@problem_id:1839385]", "problem": "一位生态学家正在进行一项环境脱氧核糖核酸（eDNA）宏条形码研究，以监测两个不同的水生生态系统。样本A采集自一个原始的高海拔池塘，该池塘被认为是稀有地方性物种——高山蝾螈的唯一栖息地。样本B来自一个低地沼泽，已知该沼泽被入侵物种——美国牛蛙密集占据，而其他脊椎动物物种的存在可以忽略不计。\n\n为了准备用于测序的样本，每个样本中的DNA都通过聚合酶链式反应（PCR）进行扩增，并用一对独特的索引进行标记（样本A使用索引A，样本B使用索引B）。然后将得到的两个文库混合在一起，在一个已知容易发生“索引跳跃”的平台上进行测序。索引跳跃是一种人工产物，指在测序过程中，本应附着于一个文库片段的索引引物错误地附着到了来自不同文库的片段上。假设对于任何给定的DNA片段，在测序过程中它被错误分配到*另一个*样本索引池的概率是一个小的恒定值 $h$。\n\n测序完成后，生物信息学分析得出以下结果：\n1.  分配给索引A（高山蝾螈池塘）的读数池总共包含 $N_A = 1,120,000$ 个读数。\n2.  在这个索引A池中，一部分比例为 $f_{B \\to A} = 0.035$ 的读数在分类学上被鉴定为属于美国牛蛙。\n3.  混合前的DNA文库初始定量显示，可扩增的牛蛙DNA（来自样本B）的浓度是高山蝾螈DNA（来自样本A）浓度的25倍。\n\n假设每个样本产生的真实读数比例与其在混合池中的初始DNA浓度成正比，计算由于索引跳跃而被错误分配到美国牛蛙（索引B）池中的真实高山蝾螈读数的总数。请用整数表示你的答案。", "solution": "让我们定义关键变量来为该场景建模。\n设 $T_A$ 为源自高山蝾螈文库（样本A）的真实读数数量。\n设 $T_B$ 为源自美国牛蛙文库（样本B）的真实读数数量。\n设 $N_A$ 为分配给索引A的观测读数总数。\n设 $h$ 为单个读数发生索引跳跃的概率。\n设 $K$ 为初始DNA浓度的比率，该比率与产生的真实读数比率成正比。\n\n题目指出，牛蛙DNA的初始浓度是蝾螈DNA的25倍。这给了我们真实读数的比率：\n$$K = \\frac{T_B}{T_A} = 25$$\n\n在索引A池中观测到的读数数量 $N_A$ 由两部分组成：被正确索引的真实蝾螈读数，以及错误“跳跃”到索引A的真实牛蛙读数。\n被正确索引的蝾螈读数数量为 $T_A(1-h)$。\n跳跃到索引A的牛蛙读数数量为 $T_B \\times h$。\n因此，索引A的总观测读数为 $N_A = T_A(1-h) + T_B h$。\n\n题目指出，索引A池中比例为 $f_{B \\to A} = 0.035$ 的读数被鉴定为牛蛙。这个比例对应于从样本B跳跃到索引A的读数。因此，这些污染读数的绝对数量是：\n$$ \\text{索引A池中的牛蛙读数数量} = N_A \\times f_{B \\to A} $$\n这个数量必须等于源自样本B并跳跃到索引A的读数数量，我们将其定义为 $T_B \\times h$。\n所以，我们得到关键方程：\n$$ T_B \\times h = N_A \\times f_{B \\to A} $$\n\n问题要求的是被错误分配到牛蛙（索引B）池中的真实高山蝾螈读数的数量。我们称这个量为 $H_{A \\to B}$。这是源自样本A并跳跃到索引B的读数数量。\n$$ H_{A \\to B} = T_A \\times h $$\n\n我们有一个关系系统。让我们用它来求解 $H_{A \\to B}$。\n从我们的关键方程：$T_B \\times h = N_A \\times f_{B \\to A}$。\n我们知道 $T_B = K \\times T_A$。将其代入方程得到：\n$$ (K \\times T_A) \\times h = N_A \\times f_{B \\to A} $$\n我们可以重排左侧：\n$$ K \\times (T_A \\times h) = N_A \\times f_{B \\to A} $$\n括号中的项 $T_A \\times h$ 正是我们要找的量 $H_{A \\to B}$。\n$$ K \\times H_{A \\to B} = N_A \\times f_{B \\to A} $$\n现在，我们可以解出 $H_{A \\to B}$：\n$$ H_{A \\to B} = \\frac{N_A \\times f_{B \\to A}}{K} $$\n\n我们已知以下数值：\n$N_A = 1,120,000$\n$f_{B \\to A} = 0.035$\n$K = 25$\n\n现在，我们将这些值代入我们推导出的公式中：\n$$ H_{A \\to B} = \\frac{1,120,000 \\times 0.035}{25} $$\n首先，计算分子：\n$$ 1,120,000 \\times 0.035 = 39,200 $$\n这就是错误地出现在蝾螈样本读数池中的牛蛙读数数量。\n现在，除以 $K$：\n$$ H_{A \\to B} = \\frac{39,200}{25} = 1568 $$\n\n因此，被错误分配到美国牛蛙（索引B）池中的真实高山蝾螈读数的总数是1568。", "answer": "$$\\boxed{1568}$$", "id": "1839385"}]}