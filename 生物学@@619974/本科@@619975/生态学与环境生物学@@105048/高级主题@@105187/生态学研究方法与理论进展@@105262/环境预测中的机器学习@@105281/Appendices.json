{"hands_on_practices": [{"introduction": "在环境科学中，一个核心任务是量化和预测生态系统过程。这个练习将带你进入温室气体通量建模的世界，这是一个对理解气候变化至关重要的领域。此问题旨在让你熟悉一个基本技能：使用一个已经训练好的机器学习模型进行预测，并利用一个关键的性能指标——均方误差（$MSE$）来评估其预测的准确性。[@problem_id:1861419]", "problem": "一个环境科学团队正在评估一个用于预测湿地生态系统每日甲烷 ($CH_4$) 通量的简单模型。该模型是基于一个大型历史数据集，使用机器学习技术开发的，它使用土壤温度和地下水位高度作为输入。提出的线性模型为：\n\n$$ \\hat{F}_{CH_4} = \\beta_0 + \\beta_1 T_{soil} + \\beta_2 WTH $$\n\n其中：\n- $\\hat{F}_{CH_4}$ 是预测的每日甲烷通量，单位为毫克每平方米每小时 ($mg \\cdot m^{-2} \\cdot h^{-1}$)。\n- $T_{soil}$ 是10厘米深度处的每日平均土壤温度，单位为摄氏度 ($^{\\circ}C$)。\n- $WTH$ 是相对于土壤表面的每日平均地下水位高度，单位为厘米 ($cm$)。负值表示地下水位低于土壤表面。\n- 训练后的模型系数为：$\\beta_0 = 80.0$，$\\beta_1 = 5.2$ 和 $\\beta_2 = -2.5$。\n\n为了测试模型的性能，该团队在连续四天内收集了一组新的数据，这组数据未在模型训练期间使用。收集的测试数据如下：\n\n- 第1天：$T_{soil} = 15.0^{\\circ}C$，$WTH = -5.0 \\ cm$，观测的 $F_{CH_4} = 175.0 \\ mg \\cdot m^{-2} \\cdot h^{-1}$\n- 第2天：$T_{soil} = 16.5^{\\circ}C$，$WTH = -2.0 \\ cm$，观测的 $F_{CH_4} = 168.0 \\ mg \\cdot m^{-2} \\cdot h^{-1}$\n- 第3天：$T_{soil} = 14.0^{\\circ}C$，$WTH = -10.0 \\ cm$，观测的 $F_{CH_4} = 182.0 \\ mg \\cdot m^{-2} \\cdot h^{-1}$\n- 第4天：$T_{soil} = 12.5^{\\circ}C$，$WTH = 0.0 \\ cm$，观测的 $F_{CH_4} = 140.0 \\ mg \\cdot m^{-2} \\cdot h^{-1}$\n\n你的任务是计算模型在这个为期四天的测试数据集上的预测值的均方误差 (MSE)。MSE的定义如下：\n\n$$ MSE = \\frac{1}{N} \\sum_{i=1}^{N} (F_{CH_4, i} - \\hat{F}_{CH_4, i})^2 $$\n\n其中 $N$ 是观测次数（本例中为4天），$F_{CH_4, i}$ 是第 $i$ 天的观测通量，$\\hat{F}_{CH_4, i}$ 是第 $i$ 天的预测通量。\n\n请将你的MSE答案以 $(mg \\cdot m^{-2} \\cdot h^{-1})^2$ 为单位表示，并四舍五入到三位有效数字。", "solution": "问题要求计算一个线性模型的预测值与一组观测数据之间的均方误差 (MSE)。预测甲烷通量 ($\\hat{F}_{CH_4}$) 的模型由下式给出：\n$$ \\hat{F}_{CH_4} = 80.0 + 5.2 \\cdot T_{soil} - 2.5 \\cdot WTH $$\n\nMSE 使用以下公式计算：\n$$ MSE = \\frac{1}{N} \\sum_{i=1}^{N} (F_{CH_4, i} - \\hat{F}_{CH_4, i})^2 $$\n其中 $N=4$。\n\n首先，我们必须使用给定的模型和测试数据，计算出这四天中每一天的预测甲烷通量 $\\hat{F}_{CH_4, i}$。\n\n对于第1天：\n$T_{soil} = 15.0^{\\circ}C$, $WTH = -5.0 \\ cm$。\n$$ \\hat{F}_{CH_4, 1} = 80.0 + 5.2(15.0) - 2.5(-5.0) = 80.0 + 78.0 + 12.5 = 170.5 \\ mg \\cdot m^{-2} \\cdot h^{-1} $$\n\n对于第2天：\n$T_{soil} = 16.5^{\\circ}C$, $WTH = -2.0 \\ cm$。\n$$ \\hat{F}_{CH_4, 2} = 80.0 + 5.2(16.5) - 2.5(-2.0) = 80.0 + 85.8 + 5.0 = 170.8 \\ mg \\cdot m^{-2} \\cdot h^{-1} $$\n\n对于第3天：\n$T_{soil} = 14.0^{\\circ}C$, $WTH = -10.0 \\ cm$。\n$$ \\hat{F}_{CH_4, 3} = 80.0 + 5.2(14.0) - 2.5(-10.0) = 80.0 + 72.8 + 25.0 = 177.8 \\ mg \\cdot m^{-2} \\cdot h^{-1} $$\n\n对于第4天：\n$T_{soil} = 12.5^{\\circ}C$, $WTH = 0.0 \\ cm$。\n$$ \\hat{F}_{CH_4, 4} = 80.0 + 5.2(12.5) - 2.5(0.0) = 80.0 + 65.0 - 0.0 = 145.0 \\ mg \\cdot m^{-2} \\cdot h^{-1} $$\n\n接下来，我们计算每一天的平方误差 $(F_{CH_4, i} - \\hat{F}_{CH_4, i})^2$。观测值 ($F_{CH_4, i}$) 在问题描述中已给出。\n\n对于第1天：\n观测通量为 $F_{CH_4, 1} = 175.0$。平方误差为：\n$$ (175.0 - 170.5)^2 = (4.5)^2 = 20.25 $$\n\n对于第2天：\n观测通量为 $F_{CH_4, 2} = 168.0$。平方误差为：\n$$ (168.0 - 170.8)^2 = (-2.8)^2 = 7.84 $$\n\n对于第3天：\n观测通量为 $F_{CH_4, 3} = 182.0$。平方误差为：\n$$ (182.0 - 177.8)^2 = (4.2)^2 = 17.64 $$\n\n对于第4天：\n观测通量为 $F_{CH_4, 4} = 140.0$。平方误差为：\n$$ (140.0 - 145.0)^2 = (-5.0)^2 = 25.00 $$\n\n现在，我们将这些平方误差相加：\n$$ \\sum_{i=1}^{4} (F_{CH_4, i} - \\hat{F}_{CH_4, i})^2 = 20.25 + 7.84 + 17.64 + 25.00 = 70.73 $$\n\n最后，我们通过将总和除以观测次数 $N=4$ 来计算 MSE：\n$$ MSE = \\frac{70.73}{4} = 17.6825 $$\n\n问题要求答案四舍五入到三位有效数字。\n数字 $17.6825$ 四舍五入到三位有效数字是 $17.7$。单位是 $(mg \\cdot m^{-2} \\cdot h^{-1})^2$。", "answer": "$$\\boxed{17.7}$$", "id": "1861419"}, {"introduction": "在上一个练习中，我们评估了一个现有模型，现在我们将更进一步，亲手构建一个模型。这个练习模拟了渔业管理中的一个常见挑战：根据环境因素预测鱼类种群数量，这是实现可持续捕捞的关键。你将使用经典的普通最小二乘法（$OLS$）从汇总数据中“训练”一个简单的线性回归模型，从而深入理解模型是如何从历史数据中“学习”规律的。[@problem_id:1861433]", "problem": "一个渔业管理团队正在为一个关键商业鱼类物种的种群数量开发一个简单的预测模型。他们假设春季平均海面温度（SST）与后续季节的鱼类种群之间存在线性关系。所提出的模型是一个简单线性回归，形式为 $P = \\beta_0 + \\beta_1 T$，其中 $P$ 是以百万为单位的鱼类种群数量，$T$ 是以摄氏度为单位的海面温度。\n\n为了训练这个模型，该团队使用了一个跨越 $n=20$ 年的历史数据集。对于一个在 $n$ 个数据对 $(x_i, y_i)$ 上训练的线性模型 $y = \\hat{\\beta}_0 + \\hat{\\beta}_1 x$，其系数的普通最小二乘估计由以下公式给出：\n$$ \\hat{\\beta}_1 = \\frac{n(\\sum x_i y_i) - (\\sum x_i)(\\sum y_i)}{n(\\sum x_i^2) - (\\sum x_i)^2} $$\n$$ \\hat{\\beta}_0 = \\bar{y} - \\hat{\\beta}_1 \\bar{x} $$\n其中 $\\bar{x}$ 和 $\\bar{y}$ 分别是 $x$ 和 $y$ 的样本均值。在此背景下，温度 $T$ 是自变量（$x$），种群数量 $P$ 是因变量（$y$）。\n\n从这20年的数据集中计算出的汇总统计数据如下：\n- 温度总和：$\\sum T_i = 285.0 \\text{ C}$\n- 种群总和：$\\sum P_i = 61.2 \\text{ million}$\n- 温度平方和：$\\sum T_i^2 = 4110.5 \\text{ C}^2$\n- 温度与种群乘积之和：$\\sum (T_i P_i) = 897.0 \\text{ million} \\cdot \\text{C}$\n- 数据点数量：$n = 20$\n\n使用这个训练好的模型，预测下一季节的鱼类种群数量，该季节预测的春季平均海面温度为 $T_{new} = 15.5$ 摄氏度。\n\n用百万条鱼作为单位来表示你预测的种群数量。将你的最终答案四舍五入到三位有效数字。", "solution": "我们对简单线性回归 $P=\\hat{\\beta}_{0}+\\hat{\\beta}_{1}T$ 使用普通最小二乘法公式，其中 $n=20$，$x\\equiv T$，$y\\equiv P$：\n$$\n\\hat{\\beta}_{1}=\\frac{n\\left(\\sum x_{i}y_{i}\\right)-\\left(\\sum x_{i}\\right)\\left(\\sum y_{i}\\right)}{n\\left(\\sum x_{i}^{2}\\right)-\\left(\\sum x_{i}\\right)^{2}},\\qquad\n\\hat{\\beta}_{0}=\\bar{y}-\\hat{\\beta}_{1}\\bar{x},\n$$\n其中 $\\bar{x}=\\frac{1}{n}\\sum x_{i}$ 且 $\\bar{y}=\\frac{1}{n}\\sum y_{i}$。\n\n代入所提供的汇总统计数据：\n- $n=20$,\n- $\\sum T_{i}=285.0$,\n- $\\sum P_{i}=61.2$,\n- $\\sum T_{i}^{2}=4110.5$,\n- $\\sum T_{i}P_{i}=897.0$.\n\n计算 $\\hat{\\beta}_{1}$ 的分母和分子：\n$$\nD=n\\left(\\sum T_{i}^{2}\\right)-\\left(\\sum T_{i}\\right)^{2}=20\\cdot 4110.5-285.0^{2}=82210.0-81225.0=985.0,\n$$\n$$\nN=n\\left(\\sum T_{i}P_{i}\\right)-\\left(\\sum T_{i}\\right)\\left(\\sum P_{i}\\right)=20\\cdot 897.0-285.0\\cdot 61.2=17940.0-17442.0=498.0.\n$$\n因此\n$$\n\\hat{\\beta}_{1}=\\frac{498}{985}.\n$$\n计算样本均值：\n$$\n\\bar{x}=\\frac{\\sum T_{i}}{n}=\\frac{285.0}{20}=14.25,\\qquad\n\\bar{y}=\\frac{\\sum P_{i}}{n}=\\frac{61.2}{20}=3.06.\n$$\n然后\n$$\n\\hat{\\beta}_{0}=\\bar{y}-\\hat{\\beta}_{1}\\bar{x}=3.06-\\frac{498}{985}\\cdot 14.25.\n$$\n\n对于预测温度 $T_{\\text{new}}=15.5$，预测的种群数量为\n$$\n\\hat{P}(T_{\\text{new}})=\\hat{\\beta}_{0}+\\hat{\\beta}_{1}T_{\\text{new}}.\n$$\n使用恒等式 $\\hat{\\beta}_{0}=\\bar{y}-\\hat{\\beta}_{1}\\bar{x}$，等价地\n$$\n\\hat{P}(T_{\\text{new}})=\\bar{y}+\\hat{\\beta}_{1}\\left(T_{\\text{new}}-\\bar{x}\\right)\n=3.06+\\frac{498}{985}\\left(15.5-14.25\\right)\n=3.06+\\frac{498}{985}\\cdot 1.25.\n$$\n计算精确分数：\n$$\n\\frac{498}{985}\\cdot 1.25=\\frac{498}{985}\\cdot \\frac{5}{4}=\\frac{622.5}{985}=\\frac{1245}{1970}=\\frac{249}{394}.\n$$\n因此\n$$\n\\hat{P}(15.5)=3.06+\\frac{249}{394}\\approx 3.691979695\\ldots\n$$\n四舍五入到三位有效数字，预测的种群数量（单位：百万）是 $3.69$。", "answer": "$$\\boxed{3.69}$$", "id": "1861433"}, {"introduction": "机器学习不仅能预测连续的数值，还能解决分类问题，例如在生态监测中自动识别物种或个体。这个问题将你置于现代野生动物保护技术的前沿，利用人工智能通过独特的斑纹图案来识别斑马个体。这个练习将重点介绍分类模型的性能评估，并解释为何在处理数据不平衡（如此处“Nyota”的图像远少于其他斑马）的情况下，简单的准确率可能会产生误导，同时你将学习计算更为稳健的 $F_1$ 分数。[@problem_id:1861421]", "problem": "一个保护研究团队正在对格利威斑马进行一项非侵入性种群研究，这是一种以其独特条纹图案而闻名的濒危物种。该团队不采用物理捕捉和标记动物的方法，而是使用一个机器学习模型从照片中识别单个斑马个体。他们训练了一个卷积神经网络 (Convolutional Neural Network, CNN) 来执行此识别任务，这是一种专门用于图像分析的深度学习模型。\n\n为了评估该模型的性能，该团队专注于其正确识别一只名为“Nyota”的有详细记录的特定斑马的能力。他们使用了一个包含 2500 张照片的测试数据集。在此数据集中，有 100 张图像被确认为是 Nyota，其余 2400 张图像是其他斑马。\n\n当 CNN 处理这个测试数据集时，其在识别 Nyota 任务上的表现如下：\n- 在 100 张真实的 Nyota 图像中，该模型将其中 85 张正确识别为 Nyota。\n- 在 2400 张其他斑马的图像中，该模型将其中 24 张错误地识别为 Nyota。\n\n使用这些信息，计算该模型对“Nyota”类别分类的 F1 分数。F1 分数是一种同时考虑了精确率和召回率的测试准确性衡量指标。将您的答案表示为四舍五入到三位有效数字的小数。", "solution": "定义“Nyota”类别的混淆矩阵计数：真阳性 $\\text{TP}=85$，假阴性 $\\text{FN}=100-85=15$，以及假阳性 $\\text{FP}=24$。\n\n精确率和召回率的定义如下\n$$P=\\frac{\\text{TP}}{\\text{TP}+\\text{FP}}, \\quad R=\\frac{\\text{TP}}{\\text{TP}+\\text{FN}}.$$\nF1 分数是精确率和召回率的调和平均数：\n$$F_{1}=\\frac{2PR}{P+R}=\\frac{2 \\cdot \\frac{\\text{TP}}{\\text{TP}+\\text{FP}} \\cdot \\frac{\\text{TP}}{\\text{TP}+\\text{FN}}}{\\frac{\\text{TP}}{\\text{TP}+\\text{FP}}+\\frac{\\text{TP}}{\\text{TP}+\\text{FN}}}.$$\n分子和分母同乘以 $(\\text{TP}+\\text{FP})(\\text{TP}+\\text{FN})$ 得\n$$F_{1}=\\frac{2 \\cdot \\text{TP}^{2}}{\\text{TP}(\\text{TP}+\\text{FN})+\\text{TP}(\\text{TP}+\\text{FP})}=\\frac{2 \\cdot \\text{TP}^{2}}{2\\text{TP}^{2}+\\text{TP}\\cdot \\text{FP}+\\text{TP}\\cdot \\text{FN}}=\\frac{2 \\cdot \\text{TP}}{2 \\cdot \\text{TP}+\\text{FP}+\\text{FN}}.$$\n代入给定的计数值：\n$$F_{1}=\\frac{2 \\cdot 85}{2 \\cdot 85+24+15}=\\frac{170}{209}\\approx 0.813397\\ldots$$\n四舍五入到三位有效数字，F1 分数为 $0.813$。", "answer": "$$\\boxed{0.813}$$", "id": "1861421"}]}