{"hands_on_practices": [{"introduction": "在生态学研究中，我们常常需要将新采集的样本与已有的历史基线进行比较。单样本 $t$ 检验正是为此目的服务的基石性统计工具。本练习将指导您计算 $t$ 统计量，以判断岛屿灰狐样本的平均体重是否与已知的历史平均值发生了显著变化，从而掌握检测种群健康或环境条件变化的基本技能 [@problem_id:1883612]。", "problem": "一位野生动物生物学家正在研究圣克鲁斯岛上的岛屿灰狐 (*Urocyon littoralis*) 种群。过去50年收集的历史数据显示，一只成年狐狸的平均体重稳定在总体均值 $\\mu_0 = 1.80$ kg。该生物学家担心，近期食物供应的变化可能正在影响当前狐狸种群的健康状况。为了调查这一点，一个研究团队捕捉并称量了一个由 $n=36$ 只成年狐狸组成的随机样本。发现该样本的平均体重为 $\\bar{x} = 1.71$ kg，样本标准差为 $s = 0.27$ kg。\n\n为了量化近期样本与历史正常水平的偏差，需要计算一个特定的检验统计量。这个统计量衡量的是样本均值偏离历史总体均值的标准误倍数。计算该检验统计量的值。将最终答案四舍五入至三位有效数字。", "solution": "题目要求我们计算衡量样本均值与历史总体均值相差多少个标准误的检验统计量。在总体标准差未知且样本量为 $n$ 的情况下，该统计量为单样本 $t$ 统计量，由以下公式给出：\n$$\nt=\\frac{\\bar{x}-\\mu_{0}}{s/\\sqrt{n}}.\n$$\n代入给定值，我们得到\n$$\nt=\\frac{1.71-1.80}{0.27/\\sqrt{36}}=\\frac{-0.09}{0.27/6}.\n$$\n由于 $\\sqrt{36}=6$，标准误为\n$$\n\\frac{0.27}{6}=0.045.\n$$\n因此，\n$$\nt=\\frac{-0.09}{0.045}=-2.\n$$\n四舍五入到三位有效数字，得到 $-2.00$。", "answer": "$$\\boxed{-2.00}$$", "id": "1883612"}, {"introduction": "动物是否偏好特定的栖息地或资源？这是生态学家经常探究的问题。对于这类基于计数数据的问题，卡方拟合优度检验提供了一种稳健的分析方法。在此实践中，您将分析松鼠的筑巢数据，以检验它们对树种没有偏好的原假设，从而锻炼您将观察到的模式与基于资源可用性的预期模式进行比较的能力 [@problem_id:1883661]。", "problem": "一位生态学家正在研究一片经营林地中欧亚红松鼠 (*Sciurus vulgaris*) 的巢址选择。该生态学家的零假设是，松鼠对任何特定树种都没有表现出偏好，这意味着它们筑巢的树木与该树种在林地中的丰度成正比。\n\n首先，一项对该林地的全面调查确定了四种最常见树种的丰度。从 1200 棵树的样本中得到的结果如下：\n- 欧洲赤松 (*Pinus sylvestris*)：540 棵\n- 欧洲夏栎 (*Quercus robur*)：360 棵\n- 银桦 (*Betula pendula*)：240 棵\n- 欧洲落叶松 (*Larix decidua*)：60 棵\n\n接着，研究团队搜寻了整个林地，共找到了 200 个活跃的松鼠巢。这些巢在不同树种间的分布记录如下：\n- 欧洲赤松：102 个巢\n- 欧洲夏栎：66 个巢\n- 银桦：26 个巢\n- 欧洲落叶松：6 个巢\n\n为检验零假设，该生态学家计算了一个差异统计量。该统计量定义为：对于所有树种，将观测到的巢数与期望的巢数之差的平方除以期望的巢数，然后求和。根据所提供的数据，计算此差异统计量的值。将最终答案四舍五入到三位有效数字。", "solution": "在无偏好的零假设下，每种树木中巢穴的期望数量与该物种的丰度成正比。设树木总数为 $N_{T}=1200$，其中欧洲赤松、欧洲夏栎、银桦和欧洲落叶松的数量分别为 $(540, 360, 240, 60)$。巢穴总数为 $N=200$，观测到的数量为 $O=(102, 66, 26, 6)$。\n\n计算每个树种的比例：\n$$\np_{\\text{Pine}}=\\frac{540}{1200},\\quad p_{\\text{Oak}}=\\frac{360}{1200},\\quad p_{\\text{Birch}}=\\frac{240}{1200},\\quad p_{\\text{Larch}}=\\frac{60}{1200}.\n$$\n那么期望的巢穴数量为\n$$\nE_{i}=N\\,p_{i},\n$$\n具体来说，\n$$\nE_{\\text{Pine}}=200\\cdot\\frac{540}{1200}=90,\\quad\nE_{\\text{Oak}}=200\\cdot\\frac{360}{1200}=60,\\quad\nE_{\\text{Birch}}=200\\cdot\\frac{240}{1200}=40,\\quad\nE_{\\text{Larch}}=200\\cdot\\frac{60}{1200}=10.\n$$\n\n差异统计量（皮尔逊卡方）为\n$$\n\\chi^{2}=\\sum_{i}\\frac{(O_{i}-E_{i})^{2}}{E_{i}}.\n$$\n计算各项：\n$$\n\\frac{(102-90)^{2}}{90}=\\frac{144}{90}=1.6,\\quad\n\\frac{(66-60)^{2}}{60}=\\frac{36}{60}=0.6,\n$$\n$$\n\\frac{(26-40)^{2}}{40}=\\frac{196}{40}=4.9,\\quad\n\\frac{(6-10)^{2}}{10}=\\frac{16}{10}=1.6.\n$$\n求和：\n$$\n\\chi^{2}=1.6+0.6+4.9+1.6=8.7.\n$$\n四舍五入到三位有效数字，结果是 $8.70$。", "answer": "$$\\boxed{8.70}$$", "id": "1883661"}, {"introduction": "生态系统是复杂的，通常有多个不同的模型可以解释我们观察到的数据。模型平均技术并非仅仅挑选一个所谓的“最佳”模型，而是通过综合考虑多个竞争模型的不确定性，来提供一个更为稳健的参数估计。这项高级练习将向您介绍如何使用赤池信息准则（Akaike Information Criterion, AIC）进行模型平均，您将综合多个模型的结果，以获得关于温度对蜂鸟觅食行为影响的最可靠估计，这是现代生态学分析中的一项关键技能 [@problem_id:1883610]。", "problem": "一位生态学家正在研究影响棕煌蜂鸟 (*Selasphorus rufus*) 每日觅食成功率的因素。这位生态学家测量了$n=150$只蜂鸟个体样本每日摄入的花蜜总质量（响应变量，$Y$）。为了解释花蜜摄入量的变化，这位生态学家考虑了三个潜在的预测变量：以摄氏度为单位的平均环境温度（$X_1$）、以每平方米花朵数量为单位的当地花密度（$X_2$），以及以每小时观察到的其他蜂鸟数量衡量的竞争者密度（$X_3$）。\n\n这位生态学家将四个相互竞争的线性回归模型拟合到数据中。其目标是通过考虑模型选择的不确定性，来确定温度对花蜜摄入量影响的最稳健的估计。拟合这四个模型的结果总结如下。对于每个模型$i$，下表列出了估计参数的数量（$k_i$）、最大化对数似然（$\\ln(L_i)$）以及温度变量的估计回归系数（$\\hat{\\beta}_{1,i}$）。\n\n- **模型1：** 花蜜摄入量 ~ 温度\n  - $k_1 = 3$\n  - $\\ln(L_1) = -210.5$\n  - $\\hat{\\beta}_{1,1} = -0.45$\n\n- **模型2：** 花蜜摄入量 ~ 温度 + 花密度\n  - $k_2 = 4$\n  - $\\ln(L_2) = -205.2$\n  - $\\hat{\\beta}_{1,2} = -0.41$\n\n- **模型3：** 花蜜摄入量 ~ 温度 + 竞争者密度\n  - $k_3 = 4$\n  - $\\ln(L_3) = -208.8$\n  - $\\hat{\\beta}_{1,3} = -0.48$\n\n- **模型4：** 花蜜摄入量 ~ 温度 + 花密度 + 竞争者密度\n  - $k_4 = 5$\n  - $\\ln(L_4) = -205.0$\n  - $\\hat{\\beta}_{1,4} = -0.42$\n\n为了进行模型平均，您将使用带有小样本校正的Akaike信息准则 (AICc)。给定模型的AICc计算公式为：\n$$AICc = 2k - 2\\ln(L) + \\frac{2k(k+1)}{n-k-1}$$\n其中$n$是样本大小，$k$是估计参数的数量，$\\ln(L)$是最大化对数似然。\n\n计算温度系数的模型平均估计值。以克/摄氏度为单位表示您的答案，并四舍五入到三位有效数字。", "solution": "目标是计算温度回归系数的模型平均估计值 $\\bar{\\hat{\\beta}}_1$。这需要先计算每个模型的Akaike权重，然后计算每个模型中温度系数估计值的加权平均值。\n\n在一组$M$个模型中，参数$\\theta$的模型平均估计值的计算公式为：\n$$ \\bar{\\hat{\\theta}} = \\sum_{i=1}^{M} w_i \\hat{\\theta}_i $$\n其中$w_i$是模型$i$的Akaike权重，$\\hat{\\theta}_i$是模型$i$中该参数的估计值。在我们的例子中，$\\theta$是温度系数$\\beta_1$，并且我们有$M=4$个模型。\n\n**步骤 1：计算每个模型的AICc值。**\n我们使用给定的公式 $AICc = 2k - 2\\ln(L) + \\frac{2k(k+1)}{n-k-1}$，其中 $n=150$。\n\n对于模型1 ($k_1=3, \\ln(L_1)=-210.5$):\n$AICc_1 = 2(3) - 2(-210.5) + \\frac{2(3)(3+1)}{150-3-1} = 6 + 421 + \\frac{24}{146} = 427 + 0.16438... = 427.16438$\n\n对于模型2 ($k_2=4, \\ln(L_2)=-205.2$):\n$AICc_2 = 2(4) - 2(-205.2) + \\frac{2(4)(4+1)}{150-4-1} = 8 + 410.4 + \\frac{40}{145} = 418.4 + 0.27586... = 418.67586$\n\n对于模型3 ($k_3=4, \\ln(L_3)=-208.8$):\n$AICc_3 = 2(4) - 2(-208.8) + \\frac{2(4)(4+1)}{150-4-1} = 8 + 417.6 + \\frac{40}{145} = 425.6 + 0.27586... = 425.87586$\n\n对于模型4 ($k_4=5, \\ln(L_4)=-205.0$):\n$AICc_4 = 2(5) - 2(-205.0) + \\frac{2(5)(5+1)}{150-5-1} = 10 + 410 + \\frac{60}{144} = 420 + 0.41666... = 420.41667$\n\n**步骤 2：计算Akaike权重 ($w_i$）。**\n首先，找出所有模型中的最小AICc值。\n$AICc_{\\min} = \\min(427.164, 418.676, 425.876, 420.417) = 418.676$（来自模型2）。\n\n接下来，计算每个模型相对于最小值的AICc差值，$\\Delta_i = AICc_i - AICc_{\\min}$。\n$\\Delta_1 = 427.164 - 418.676 = 8.488$\n$\\Delta_2 = 418.676 - 418.676 = 0$\n$\\Delta_3 = 425.876 - 418.676 = 7.200$\n$\\Delta_4 = 420.417 - 418.676 = 1.741$\n\n模型$i$的Akaike权重由以下公式给出：\n$$ w_i = \\frac{\\exp(-\\frac{1}{2}\\Delta_i)}{\\sum_{j=1}^{4} \\exp(-\\frac{1}{2}\\Delta_j)} $$\n\n我们来计算每个模型公式中的分子项（相对似然度）：\n$\\exp(-\\frac{1}{2}\\Delta_1) = \\exp(-0.5 \\times 8.488) = \\exp(-4.244) \\approx 0.01435$\n$\\exp(-\\frac{1}{2}\\Delta_2) = \\exp(-0.5 \\times 0) = \\exp(0) = 1$\n$\\exp(-\\frac{1}{2}\\Delta_3) = \\exp(-0.5 \\times 7.200) = \\exp(-3.600) \\approx 0.02732$\n$\\exp(-\\frac{1}{2}\\Delta_4) = \\exp(-0.5 \\times 1.741) = \\exp(-0.8705) \\approx 0.41873$\n\n现在，计算这些值的总和作为分母：\n$\\sum_{j=1}^{4} \\exp(-\\frac{1}{2}\\Delta_j) \\approx 0.01435 + 1 + 0.02732 + 0.41873 = 1.4604$\n\n最后，我们可以计算出权重：\n$w_1 = \\frac{0.01435}{1.4604} \\approx 0.009826$\n$w_2 = \\frac{1}{1.4604} \\approx 0.68474$\n$w_3 = \\frac{0.02732}{1.4604} \\approx 0.01871$\n$w_4 = \\frac{0.41873}{1.4604} \\approx 0.28672$\n\n**步骤 3：计算温度的模型平均系数。**\n使用公式 $\\bar{\\hat{\\beta}}_1 = \\sum_{i=1}^{4} w_i \\hat{\\beta}_{1,i}$ 和给定的系数估计值：\n$\\hat{\\beta}_{1,1} = -0.45$\n$\\hat{\\beta}_{1,2} = -0.41$\n$\\hat{\\beta}_{1,3} = -0.48$\n$\\hat{\\beta}_{1,4} = -0.42$\n\n$\\bar{\\hat{\\beta}}_1 \\approx (0.009826 \\times -0.45) + (0.68474 \\times -0.41) + (0.01871 \\times -0.48) + (0.28672 \\times -0.42)$\n$\\bar{\\hat{\\beta}}_1 \\approx -0.0044217 - 0.2807434 - 0.0089808 - 0.1204224$\n$\\bar{\\hat{\\beta}}_1 \\approx -0.4145683$\n\n**步骤 4：对最终答案进行四舍五入。**\n将结果四舍五入到三位有效数字，我们得到 -0.415。单位是根据题目要求的克/摄氏度。", "answer": "$$\\boxed{-0.415}$$", "id": "1883610"}]}