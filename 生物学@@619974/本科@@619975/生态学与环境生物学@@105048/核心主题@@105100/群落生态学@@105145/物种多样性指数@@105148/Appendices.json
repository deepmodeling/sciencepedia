{"hands_on_practices": [{"introduction": "本练习将指导您完成香农-维纳指数 ($H'$) 的计算，这是生态学中应用最广泛的α多样性度量之一。通过这个实践，您将学会如何基于物种的相对丰度来量化群落的“不确定性”或信息含量。这个基本技能是任何生态多样性评估的起点 [@problem_id:1882628]。", "problem": "一位生态学家正在研究一个城市区域中，建成一年后的绿色屋顶上自然定植的植物群落。在研究样方内，共识别出250株植物个体。该群落由四个不同的物种组成。其中三个物种的数量如下：\n- *Sedum acre*：112个个体\n- *Poa pratensis*：78个个体\n- *Trifolium repens*：41个个体\n剩余的个体属于第四个物种，*Taraxacum officinale*。\n\n为了量化该植物群落的多样性，生态学家决定计算香农-维纳指数（Shannon-Wiener index），$H'$。该指数是衡量从群落中随机抽取一个个体时，预测其物种身份不确定性的指标。该指数使用以下公式计算：\n$$H' = - \\sum_{i=1}^{S} p_i \\ln(p_i)$$\n其中，$S$ 是群落中物种的总数（物种丰富度），而 $p_i$ 是属于第 $i$ 个物种的个体所占的比例。\n\n计算该植物群落的香农-维纳指数（$H'$）的值。将您的最终答案四舍五入到四位有效数字。", "solution": "题目要求计算一个由四个物种组成的植物群落的香农-维纳指数（Shannon-Wiener index，$H'$）。给定公式为 $H' = - \\sum_{i=1}^{S} p_i \\ln(p_i)$。\n\n首先，我们必须确定四个物种中每个物种的个体数量以及它们在群落中所占的相应比例。\n给定总个体数为 $N = 250$。\n物种数量为 $S = 4$。\n给定前三个物种的数量：\n- 物种1 (*Sedum acre*): $n_1 = 112$\n- 物种2 (*Poa pratensis*): $n_2 = 78$\n- 物种3 (*Trifolium repens*): $n_3 = 41$\n\n第四个物种的个体数量 $n_4$ 可以通过从总数中减去其他物种数量的总和来计算：\n$$n_4 = N - (n_1 + n_2 + n_3)$$\n$$n_4 = 250 - (112 + 78 + 41) = 250 - 231 = 19$$\n因此，第四个物种（*Taraxacum officinale*）的数量为 $n_4 = 19$。\n\n接下来，我们计算每个物种的比例 $p_i$，其中 $p_i = n_i / N$。\n- 物种1: $p_1 = \\frac{112}{250} = 0.448$\n- 物种2: $p_2 = \\frac{78}{250} = 0.312$\n- 物种3: $p_3 = \\frac{41}{250} = 0.164$\n- 物种4: $p_4 = \\frac{19}{250} = 0.076$\n\n作为检验，这些比例的总和应为1：$0.448 + 0.312 + 0.164 + 0.076 = 1.000$。\n\n现在我们可以使用香农-维纳指数公式 $H' = - \\sum_{i=1}^{4} p_i \\ln(p_i)$，展开为：\n$$H' = - [p_1 \\ln(p_1) + p_2 \\ln(p_2) + p_3 \\ln(p_3) + p_4 \\ln(p_4)]$$\n\n我们计算每一项 $p_i \\ln(p_i)$：\n- 第1项: $0.448 \\times \\ln(0.448) \\approx 0.448 \\times (-0.80295) \\approx -0.35972$\n- 第2项: $0.312 \\times \\ln(0.312) \\approx 0.312 \\times (-1.16474) \\approx -0.36340$\n- 第3项: $0.164 \\times \\ln(0.164) \\approx 0.164 \\times (-1.80789) \\approx -0.29649$\n- 第4项: $0.076 \\times \\ln(0.076) \\approx 0.076 \\times (-2.57702) \\approx -0.19585$\n\n现在，我们将这些项相加：\n$$\\sum_{i=1}^{4} p_i \\ln(p_i) \\approx -0.35972 - 0.36340 - 0.29649 - 0.19585 \\approx -1.21546$$\n\n最后，我们计算 $H'$：\n$$H' = -(-1.21546) \\approx 1.21546$$\n\n题目要求答案保留四位有效数字。\n$$H' \\approx 1.215$$", "answer": "$$\\boxed{1.215}$$", "id": "1882628"}, {"introduction": "掌握了基本计算之后，一个更深层次的问题是：在特定情境下，哪个多样性指数更“好”用？本练习通过一个模拟保护生物学场景，挑战您去比较香农指数和辛普森指数对群落结构微小变化的敏感性。这有助于您理解不同指数的侧重点，并学习如何根据研究目的选择最合适的分析工具 [@problem_id:1882601]。", "problem": "一位保护生物学家正在监测一个草地生态系统，并担心一种开始排挤较稀有本地植物的优势草种的早期影响。该生物学家在两个不同的时间对群落进行了取样。在初始状态（状态A），该生态系统有五个植物物种，其相对丰度（比例）如下：\n- 物种1：$p_1 = 0.50$\n- 物种2：$p_2 = 0.30$\n- 物种3：$p_3 = 0.10$\n- 物种4：$p_4 = 0.05$\n- 物种5：$p_5 = 0.05$\n\n经过一段时间的观察，该生物学家发现优势物种（物种1）的丰度增加，而一些较稀有物种的丰度则减少了。群落现在处于状态B，其新的相对丰度如下：\n- 物种1：$p_1 = 0.54$\n- 物种2：$p_2 = 0.30$\n- 物种3：$p_3 = 0.08$\n- 物种4：$p_4 = 0.04$\n- 物种5：$p_5 = 0.04$\n\n为了量化生物多样性的变化，该生物学家考虑了两个常用的指数：香农指数（$H'$）和辛普森多样性指数（$D_{div}$）。它们的定义如下：\n香农指数：$H' = - \\sum_{i=1}^{S} p_i \\ln(p_i)$\n辛普森多样性指数：$D_{div} = 1 - \\sum_{i=1}^{S} p_i^2$\n其中 $S$ 是物种数量，$p_i$ 是物种 $i$ 的比例。\n\n为了确定在这一特定情景下哪个指数是更敏感的早期指标，您必须比较它们的相对变化。计算当群落从状态A过渡到状态B时，香农指数和辛普森多样性指数的百分比下降值。报告这两个百分比下降值之间的绝对差值。例如，如果一个指数下降了5.2%，另一个下降了3.1%，您的答案应该是 $5.2 - 3.1 = 2.1$。将您的最终答案四舍五入到两位有效数字。", "solution": "本题要求我们计算并比较香农指数和辛普森多样性指数在群落结构发生微小变化时的百分比下降值。\n\n**第1步：计算状态A的指数值**\n\n*   **香农指数 ($H'_A$)**:\n    $H'_A = -[0.50 \\ln(0.50) + 0.30 \\ln(0.30) + 0.10 \\ln(0.10) + 0.05 \\ln(0.05) + 0.05 \\ln(0.05)]$\n    $H'_A \\approx -[-0.34657 - 0.36119 - 0.23026 - 0.14979 - 0.14979] \\approx 1.2376$\n\n*   **辛普森多样性指数 ($D_{div,A}$)**:\n    $D_{div,A} = 1 - (0.50^2 + 0.30^2 + 0.10^2 + 0.05^2 + 0.05^2)$\n    $D_{div,A} = 1 - (0.25 + 0.09 + 0.01 + 0.0025 + 0.0025) = 1 - 0.355 = 0.645$\n\n**第2步：计算状态B的指数值**\n\n*   **香农指数 ($H'_B$)**:\n    $H'_B = -[0.54 \\ln(0.54) + 0.30 \\ln(0.30) + 0.08 \\ln(0.08) + 0.04 \\ln(0.04) + 0.04 \\ln(0.04)]$\n    $H'_B \\approx -[-0.33274 - 0.36119 - 0.20206 - 0.12876 - 0.12876] \\approx 1.1535$\n                \n*   **辛普森多样性指数 ($D_{div,B}$)**:\n    $D_{div,B} = 1 - (0.54^2 + 0.30^2 + 0.08^2 + 0.04^2 + 0.04^2)$\n    $D_{div,B} = 1 - (0.2916 + 0.09 + 0.0064 + 0.0016 + 0.0016) = 1 - 0.3912 = 0.6088$\n\n**第3步：计算百分比下降值**\n\n*   **香农指数下降百分比**:\n    $\\Delta_{H'} = \\frac{H'_A - H'_B}{H'_A} \\times 100\\% = \\frac{1.2376 - 1.1535}{1.2376} \\times 100\\% \\approx 6.795\\%$\n                \n*   **辛普森指数下降百分比**:\n    $\\Delta_{D} = \\frac{D_{div,A} - D_{div,B}}{D_{div,A}} \\times 100\\% = \\frac{0.645 - 0.6088}{0.645} \\times 100\\% \\approx 5.612\\%$\n                \n**第4步：计算绝对差值**\n\n*   **百分比下降值的绝对差值**:\n    $|\\Delta_{H'} - \\Delta_{D}| = |6.795\\% - 5.612\\%| = 1.183\\%$\n                \n四舍五入到两位有效数字，结果为 $1.2$。", "answer": "$$\\boxed{1.2}$$", "id": "1882601"}, {"introduction": "这个高级练习将您的技能从描述单一群落内部的多样性（$\\alpha$多样性）提升到比较不同群落之间的差异（$\\beta$多样性）。您将使用布雷-柯蒂斯相异度（Bray-Curtis dissimilarity）来量化群落间的差异，并学习如何利用零模型进行假设检验，以判断观测到的格局是否具有统计显著性。这是连接描述性生态学与推断性生态学研究的关键一步 [@problem_id:1882587]。", "problem": "一位生态学家正在研究一个位于温带森林和邻近草原之间的过渡带（或称生态交错带）的群落结构。为了量化物种组成，她设立了三个不同的样地：一个在森林内（生境A），一个在草原内（生境B），一个在生态交错带内（生境E）。在每个样地中，她记录了五种关键植物的丰度。收集到的数据如下：\n\n*   **生境A：**物种1（50个个体），物种2（40），物种3（5），物种4（0），物种5（0）。\n*   **生境B：**物种1（0），物种2（0），物种3（5），物种4（60），物种5（30）。\n*   **生态交错带E：**物种1（20），物种2（15），物种3（30），物种4（25），物种5（5）。\n\n任意两个地点 $i$ 和 $j$ 之间的组成差异使用布雷-柯蒂斯相异度（Bray-Curtis dissimilarity）$BC_{ij}$ 来衡量，其定义公式为：\n$$ BC_{ij} = \\frac{\\sum_{k=1}^{S} |N_{ik} - N_{jk}|}{\\sum_{k=1}^{S} (N_{ik} + N_{jk})} $$\n其中 $N_{ik}$ 代表地点 $i$ 中物种 $k$ 的丰度，$S$ 是所有地点中物种的总数。\n\n该生态学家假设，生态交错带的物种组成与其周围源生境的差异比随机预期的要更显著。为了检验这个假设，她定义了一个检验统计量 $D$，即生态交错带与两个相邻生境之间的平均布雷-柯蒂斯相异度：$D = \\frac{1}{2}(BC_{AE} + BC_{BE})$。\n\n为了生成用于比较的零分布，采用了一个计算性的零模型。该模型通过在三个地点之间重新分配所有物种的所有个体来创建随机群落，并保持每个物种在所有地点中的总丰度以及每个地点内的个体总数不变的约束条件。通过这个过程，生成了19个检验统计量 $D_{null}$ 的零值。这些值是：\n\n0.345, 0.410, 0.388, 0.431, 0.502, 0.395, 0.455, 0.481, 0.367, 0.422, 0.490, 0.515, 0.379, 0.463, 0.444, 0.401, 0.476, 0.399, 0.428\n\n根据所提供的数据和模拟结果，计算单尾 p 值，以检验观测到的平均相异度 $D_{obs}$ 是否显著大于零模型下的期望值。请将您的答案以保留两位有效数字的小数形式报告。", "solution": "该问题要求我们通过随机化检验计算一个单尾 p 值。这包括两个主要部分：首先，根据给定的物种丰度数据计算检验统计量的观测值 $D_{obs}$；其次，将该观测值与提供的零值分布进行比较，以确定 p 值。\n\n**第1部分：计算观测到的检验统计量，$D_{obs}$**\n\n检验统计量定义为 $D = \\frac{1}{2}(BC_{AE} + BC_{BE})$。我们首先需要使用公式 $BC_{ij} = \\frac{\\sum_{k=1}^{S} |N_{ik} - N_{jk}|}{\\sum_{k=1}^{S} (N_{ik} + N_{jk})}$ 来计算布雷-柯蒂斯相异度 $BC_{AE}$ 和 $BC_{BE}$。物种数据如下：\n- 生境A: $N_A = (50, 40, 5, 0, 0)$\n- 生境B: $N_B = (0, 0, 5, 60, 30)$\n- 生态交错带E: $N_E = (20, 15, 30, 25, 5)$\n\n**步骤 1.1: 计算 $BC_{AE}$**\n\n首先，我们计算生境A和生态交错带E之间丰度的绝对差之和（分子）：\n$$ \\sum_{k=1}^{5} |N_{Ak} - N_{Ek}| = |50 - 20| + |40 - 15| + |5 - 30| + |0 - 25| + |0 - 5| $$\n$$ = 30 + 25 + 25 + 25 + 5 = 110 $$\n\n接下来，我们计算生境A和生态交错带E的总丰度之和（分母）：\n$$ \\sum_{k=1}^{5} (N_{Ak} + N_{Ek}) = (50 + 20) + (40 + 15) + (5 + 30) + (0 + 25) + (0 + 5) $$\n$$ = 70 + 55 + 35 + 25 + 5 = 190 $$\n\n因此，A和E之间的布雷-柯蒂斯相异度为：\n$$ BC_{AE} = \\frac{110}{190} $$\n\n**步骤 1.2: 计算 $BC_{BE}$**\n\n类似地，我们计算生境B和生态交错带E之间丰度的绝对差之和：\n$$ \\sum_{k=1}^{5} |N_{Bk} - N_{Ek}| = |0 - 20| + |0 - 15| + |5 - 30| + |60 - 25| + |30 - 5| $$\n$$ = 20 + 15 + 25 + 35 + 25 = 120 $$\n\n以及生境B和生态交错带E的总丰度之和：\n$$ \\sum_{k=1}^{5} (N_{Bk} + N_{Ek}) = (0 + 20) + (0 + 15) + (5 + 30) + (60 + 25) + (30 + 5) $$\n$$ = 20 + 15 + 35 + 85 + 35 = 190 $$\n\nB和E之间的布雷-柯蒂斯相异度为：\n$$ BC_{BE} = \\frac{120}{190} $$\n\n**步骤 1.3: 计算观测到的检验统计量 $D_{obs}$**\n\n现在我们可以计算观测到的平均相异度：\n$$ D_{obs} = \\frac{1}{2}(BC_{AE} + BC_{BE}) = \\frac{1}{2} \\left( \\frac{110}{190} + \\frac{120}{190} \\right) $$\n$$ D_{obs} = \\frac{1}{2} \\left( \\frac{110 + 120}{190} \\right) = \\frac{1}{2} \\left( \\frac{230}{190} \\right) = \\frac{115}{190} = \\frac{23}{38} $$\n以小数表示，$D_{obs} \\approx 0.60526$。\n\n**第2部分：计算 p 值**\n\n对于单尾随机化检验（检验观测值是否显著大），p 值的计算公式为 $p = \\frac{k+1}{N+1}$，其中 $N$ 是零模拟的次数，$k$ 是大于或等于观测值的零值的数量。\n\n问题陈述中说明运行了 $N=19$ 次模拟。我们的观测统计量是 $D_{obs} \\approx 0.6053$。我们需要将这个值与提供的19个零值进行比较：\n0.345, 0.410, 0.388, 0.431, 0.502, 0.395, 0.455, 0.481, 0.367, 0.422, 0.490, 0.515, 0.379, 0.463, 0.444, 0.401, 0.476, 0.399, 0.428\n\n通过检查，零统计量列表中的最大值是 0.515。我们的观测统计量 $D_{obs} \\approx 0.6053$ 大于所有19个零值中的任何一个。\n\n因此，大于或等于 $D_{obs}$ 的零值的数量是 $k=0$。\n\n现在我们可以计算 p 值：\n$$ p = \\frac{k+1}{N+1} = \\frac{0+1}{19+1} = \\frac{1}{20} = 0.05 $$\n\n问题要求答案保留两位有效数字。值 0.05 可以写作 0.050，以正确表示两位有效数字的精度。第一个有效数字是 5，第二个是末尾的 0。\n\n因此，p 值为 0.050。", "answer": "$$\\boxed{0.050}$$", "id": "1882587"}]}