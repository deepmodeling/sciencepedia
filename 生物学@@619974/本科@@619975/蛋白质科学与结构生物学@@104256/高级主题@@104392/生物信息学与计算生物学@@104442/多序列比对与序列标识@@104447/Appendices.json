{"hands_on_practices": [{"introduction": "在分析多重序列比对（MSA）时，我们不仅要看哪些残基是保守的，还要量化这种保守程度。香农熵（Shannon entropy），即 $H = -\\sum_{i} p_i \\log_2(p_i)$，提供了一种强大的数学工具来衡量比对中特定位置的可变性或不确定性。这个练习将指导你为一个酶活性位点的残基计算香农熵，让你亲手实践如何从原始的氨基酸计数转化为一个有意义的信息论度量 [@problem_id:2121514]。", "problem": "一位研究人员正在研究一个同源酶家族中一个关键活性位点残基的保守性。他们从20个相关的蛋白质序列中构建了一个多序列比对(MSA)。在该比对中对应于此活性位点残基的特定列上，他们观察到以下氨基酸分布：12个序列含有谷氨酸(E)，6个含有天冬氨酸(D)，2个含有丙氨酸(A)。此位置上没有其他类型的氨基酸。\n\n为了量化该位置的变异性，该研究人员决定计算香农熵 $H$。比对中给定位置的香农熵由以下公式定义：\n$$H = -\\sum_{i=1}^{k} p_i \\log_2(p_i)$$\n其中，$k$ 是该位置上存在的不同氨基酸类型的数量，$p_i$ 是第 $i$ 种氨基酸类型的频率。\n\n计算该比对中此特定列的香农熵。以比特为单位表示您的答案，并四舍五入到三位有效数字。", "solution": "共有 $N=20$ 个序列。该列观察到的计数为：$12$ 个 E，$6$ 个 D，以及 $2$ 个 A，因此经验概率为\n$$p_{E}=\\frac{12}{20}=\\frac{3}{5}=0.6,\\quad p_{D}=\\frac{6}{20}=\\frac{3}{10}=0.3,\\quad p_{A}=\\frac{2}{20}=\\frac{1}{10}=0.1.$$\n以比特为单位的香农熵为\n$$H=-\\sum_{i} p_{i}\\log_{2}(p_{i})= -\\left(0.6\\log_{2}(0.6)+0.3\\log_{2}(0.3)+0.1\\log_{2}(0.1)\\right).$$\n使用 $\\log_{2}(x)=\\frac{\\ln x}{\\ln 2}$ 进行数值计算，\n$$\\log_{2}(0.6)\\approx -0.736965594,\\quad \\log_{2}(0.3)=\\log_{2}(0.6)-1\\approx -1.736965594,\\quad \\log_{2}(0.1)\\approx -3.321928095.$$\n因此，\n$$H\\approx -\\left[0.6(-0.736965594)+0.3(-1.736965594)+0.1(-3.321928095)\\right] \\approx 1.295461844.$$\n四舍五入到三位有效数字，得到 $H\\approx 1.30$ 比特。", "answer": "$$\\boxed{1.30}$$", "id": "2121514"}, {"introduction": "在量化了单个位置的变异性之后，下一步是评估一个序列基序（motif）整体包含多少“信息”。信息含量（Information content）与香农熵密切相关，它衡量的是一个位置相对于完全随机背景的保守程度，其计算公式为 $R = \\log_2(s) - H$。这个值也直接决定了序列标识（sequence logo）中字母的高度 [@problem_id:2121500]。通过这个练习，你将为一个假设的三肽基序计算总信息含量，从而更深入地理解熵、信息与序列标识之间的联系。", "problem": "一位生物信息学家正在分析一个新发现的蛋白质家族中的结构基序。该基序是一个由三个氨基酸组成的短肽序列。对大量包含此基序的序列进行多重序列比对，确定了每个位置上以下氨基酸的频率。为方便解题，我们考虑包含20种标准蛋白氨基酸的集合。\n\n*   **位置 1：** 脯氨酸 (P) 的出现频率为 1.0。所有其他氨基酸的频率为 0。\n*   **位置 2：** 此位置是可变的。十种不同的氨基酸（具体为 Alanine、Glycine、Serine、Threonine、Cysteine、Asparagine、Glutamine、Aspartic acid、Glutamic acid 和 Histidine）各自的出现频率为 0.1。其余十种氨基酸从未在此位置出现。\n*   **位置 3：** 此位置只包含两种大的疏水性残基。亮氨酸 (L) 的出现频率为 0.6，异亮氨酸 (I) 的出现频率为 0.4。没有其他氨基酸出现在此位置。\n\n计算这个三残基基序的总信息含量。答案以比特为单位，并四舍五入到三位有效数字。", "solution": "在一个大小为 $s$ 的字母表上，相对于均匀背景的位置特异性基序的信息含量由以下公式给出：\n$$\nR = \\log_{2}(s) - H,\n$$\n其中 Shannon 熵为：\n$$\nH = -\\sum_{a} p(a)\\log_{2} p(a),\n$$\n这里 $s=20$ 代表20种标准氨基酸。该基序的总信息含量是三个位置信息含量的总和。\n\n位置 1：分布为 $p(\\text{P})=1$，其他氨基酸则为 $p(a)=0$。因此：\n$$\nH_{1} = -1\\cdot \\log_{2} 1 = 0,\\quad R_{1} = \\log_{2} 20.\n$$\n\n位置 2：十种氨基酸各自的概率为 $0.1$，其余的为 $0$。因此：\n$$\nH_{2} = -\\sum_{i=1}^{10} 0.1\\,\\log_{2}(0.1) = -\\log_{2}(0.1) = \\log_{2}(10),\n$$\n所以：\n$$\nR_{2} = \\log_{2} 20 - \\log_{2} 10 = \\log_{2}\\!\\left(\\frac{20}{10}\\right) = \\log_{2} 2 = 1.\n$$\n\n位置 3：当 $p(\\text{L})=0.6$ 和 $p(\\text{I})=0.4$ 时，\n$$\nH_{3} = -\\left[0.6\\log_{2}(0.6) + 0.4\\log_{2}(0.4)\\right] \\approx 0.970950594,\n$$\n所以：\n$$\nR_{3} = \\log_{2} 20 - H_{3} \\approx 4.321928095 - 0.970950594 \\approx 3.350977500.\n$$\n\n对所有位置求和，\n$$\nR_{\\text{total}} = R_{1} + R_{2} + R_{3} = \\log_{2} 20 + 1 + \\left(\\log_{2} 20 - H_{3}\\right) = 2\\log_{2} 20 + 1 - H_{3}.\n$$\n数值计算如下：\n$$\nR_{\\text{total}} \\approx 2\\cdot 4.321928095 + 1 - 0.970950594 \\approx 8.672905596 \\text{ 比特}。\n$$\n四舍五入到三位有效数字，结果是 $8.67$ 比特。", "answer": "$$\\boxed{8.67}$$", "id": "2121500"}, {"introduction": "理论概念的最终检验在于它们解决实际问题的能力。在这个综合性练习中，你将面临一个常见的生物信息学挑战：一个简单的“多数原则”共有序列在实验中没有功能 [@problem_id:2121521]。这个练习要求你运用信息含量的概念，根据每个位置的保守程度（以信息含量 $R_i$ 为度量）来设计一个更复杂的、加权的共有序列，这模拟了在进行实验验证前如何提出更合理的假设。通过这个实践，你将体会到如何利用定量分析来指导生物学实验设计。", "problem": "一个生物化学家团队正在研究一种新型的DNA结合转录因子。通过高通量筛选实验，他们识别了该因子能结合的100个不同的8碱基对DNA序列。对这些序列进行了多序列比对（MSA），以确定首选的结合位点。\n\n根据多序列比对，计算了8个位置上每个碱基的频率，如下表所示：\n\n| 位置 | A的频率 | C的频率 | G的频率 | T的频率 |\n|:----:|:-------:|:-------:|:-------:|:-------:|\n| 1 | 0.05 | 0.85 | 0.05 | 0.05 |\n| 2 | 0.90 | 0.02 | 0.05 | 0.03 |\n| 3 | 0.01 | 0.01 | 0.97 | 0.01 |\n| 4 | 0.40 | 0.25 | 0.25 | 0.10 |\n| 5 | 0.10 | 0.20 | 0.30 | 0.40 |\n| 6 | 0.95 | 0.02 | 0.01 | 0.02 |\n| 7 | 0.05 | 0.90 | 0.03 | 0.02 |\n| 8 | 0.10 | 0.05 | 0.80 | 0.05 |\n\n通过在每个位置选择最频繁的碱基，构建了一个“简单共有”序列。然而，当这个简单共有序列被合成并在结合实验中进行测试时，它未能显示出对该转录因子的任何显著亲和力。\n\n首席科学家假设，序列保守性低（即变异性高）的位置可能由于结构原因或为避免负面相互作用而需要一个非显性碱基。为了验证这一假设，你的任务是根据以下规则设计一个“功能加权共有序列”：\n\n1.  对于每个位置 $i$（从1到8），计算信息量 $R_i$。信息量由公式 $R_i = \\log_2(4) - H_i$ 给出，其中 $H_i$ 是该位置的香农熵。\n2.  香农熵的计算公式为 $H_i = -\\sum_{b \\in \\{A,C,G,T\\}} p_{i,b} \\log_2(p_{i,b})$，其中 $p_{i,b}$ 是碱基 $b$ 在位置 $i$ 的频率。在此计算中，使用约定 $p \\log_2(p) = 0$（当 $p=0$ 时）。\n3.  对于每个位置 $i$：\n    a. 如果信息量 $R_i$ 大于或等于阈值 $1.0$ 比特，则选择最频繁的碱基。\n    b. 如果信息量 $R_i$ 小于 $1.0$ 比特，则选择*第二*频繁的碱基。\n4.  如果最频繁或第二频繁的碱基出现平局，则按字母顺序（A、C、G、T）选择第一个碱基。\n\n确定这个8碱基对的功能加权共有序列。", "solution": "我们已知在每个位置 $i \\in \\{1,\\dots,8\\}$ 上，对于 $b \\in \\{A,C,G,T\\}$ 的碱基频率 $p_{i,b}$。对每个位置，计算香农熵\n$$\nH_{i}=-\\sum_{b \\in \\{A,C,G,T\\}} p_{i,b}\\log_{2}\\left(p_{i,b}\\right),\n$$\n约定当 $p=0$ 时 $p\\log_{2}(p)=0$，以及信息量\n$$\nR_{i}=\\log_{2}(4)-H_{i}=2-H_{i}.\n$$\n选择规则：如果 $R_{i}\\geq 1.0$ 比特，选择最频繁的碱基；如果 $R_{i}<1.0$ 比特，选择第二频繁的碱基；按字母顺序（A、C、G、T）解决平局。\n\n位置 $1$：$p=(0.05,0.85,0.05,0.05)$。\n$$\nH_{1}=-\\big(0.05\\log_{2}0.05+0.85\\log_{2}0.85+0.05\\log_{2}0.05+0.05\\log_{2}0.05\\big)\\approx 0.8476,\n$$\n所以 $R_{1}=2-0.8476\\approx 1.1524\\geq 1$。选择最频繁的碱基：$C$。\n\n位置 $2$：$p=(0.90,0.02,0.05,0.03)$。\n$$\nH_{2}\\approx -\\big(0.90\\log_{2}0.90+0.02\\log_{2}0.02+0.05\\log_{2}0.05+0.03\\log_{2}0.03\\big)\\approx 0.6175,\n$$\n所以 $R_{2}\\approx 1.3825\\geq 1$。选择最频繁的碱基：$A$。\n\n位置 $3$：$p=(0.01,0.01,0.97,0.01)$。\n$$\nH_{3}\\approx -\\big(0.01\\log_{2}0.01+0.01\\log_{2}0.01+0.97\\log_{2}0.97+0.01\\log_{2}0.01\\big)\\approx 0.2417,\n$$\n所以 $R_{3}\\approx 1.7583\\geq 1$。选择最频繁的碱基：$G$。\n\n位置 $4$：$p=(0.40,0.25,0.25,0.10)$。\n$$\nH_{4}= -\\big(0.40\\log_{2}0.40+0.25\\log_{2}0.25+0.25\\log_{2}0.25+0.10\\log_{2}0.10\\big)\\approx 1.8610,\n$$\n所以 $R_{4}\\approx 0.1390<1$。选择第二频繁的碱基。最高频率是 A 的 $0.40$（最频繁），其次是 C 和 G 的 $0.25$（第二频繁，平局）。按字母顺序解决平局，因此选择 $C$。\n\n位置 $5$：$p=(0.10,0.20,0.30,0.40)$。\n$$\nH_{5}= -\\big(0.10\\log_{2}0.10+0.20\\log_{2}0.20+0.30\\log_{2}0.30+0.40\\log_{2}0.40\\big)\\approx 1.8464,\n$$\n所以 $R_{5}\\approx 0.1536<1$。选择第二频繁的碱基。频率排序为：$T$ 为 $0.40$（最频繁），$G$ 为 $0.30$（第二频繁），$C$ 为 $0.20$，$A$ 为 $0.10$。选择 $G$。\n\n位置 $6$：$p=(0.95,0.02,0.01,0.02)$。\n$$\nH_{6}\\approx -\\big(0.95\\log_{2}0.95+0.02\\log_{2}0.02+0.01\\log_{2}0.01+0.02\\log_{2}0.02\\big)\\approx 0.3616,\n$$\n所以 $R_{6}\\approx 1.6384\\geq 1$。选择最频繁的碱基：$A$。\n\n位置 $7$：$p=(0.05,0.90,0.03,0.02)$。\n$$\nH_{7}\\approx -\\big(0.05\\log_{2}0.05+0.90\\log_{2}0.90+0.03\\log_{2}0.03+0.02\\log_{2}0.02\\big)\\approx 0.6175,\n$$\n所以 $R_{7}\\approx 1.3825\\geq 1$。选择最频繁的碱基：$C$。\n\n位置 $8$：$p=(0.10,0.05,0.80,0.05)$。\n$$\nH_{8}= -\\big(0.10\\log_{2}0.10+0.05\\log_{2}0.05+0.80\\log_{2}0.80+0.05\\log_{2}0.05\\big)\\approx 1.0219,\n$$\n所以 $R_{8}\\approx 0.9781<1$。选择第二频繁的碱基。频率排序为：$G$ 为 $0.80$（最频繁），$A$ 为 $0.10$（第二频繁），$C$ 和 $T$ 为 $0.05$。选择 $A$。\n\n将每个位置的选择汇总，得到功能加权共有序列：$C,A,G,C,G,A,C,A$，即 $CAGCGACA$。", "answer": "$$\\boxed{CAGCGACA}$$", "id": "2121521"}]}