{"hands_on_practices": [{"introduction": "生物信息学中的序列比对旨在揭示序列间的同源性，而比对的优劣是通过一个量化的得分来衡量的。这个基础练习将引导你亲手计算一个给定比对的得分，通过应用如BLOSUM62这样的替换矩阵和一个线性空位罚分 $g = -8$，你将掌握评估序列比对质量的核心计算方法[@problem_id:2136014]。这是理解更复杂比对算法如何工作的关键第一步。", "problem": "在生物信息学领域，序列比对是一种基本方法，用于比较蛋白质或核苷酸序列，以识别可能源于功能、结构或进化关系的相似区域。比对的质量通过一个分数来量化，该分数使用替换矩阵和空位罚分计算得出。\n\n考虑以下两个短肽序列 Seq1 和 Seq2 的带空位比对：\n\nSeq1: `F E S A G K D E`\nSeq2: `F R S - G K T E`\n\n请使用 BLOSUM62 (BLOcks SUbstitution Matrix 62) 替换矩阵和线性空位罚分来计算总比对分数。线性空位罚分意味着每个由连字符 (`-`) 表示的空位字符都会产生一个固定的负分，而与空位的长度或位置无关。在本题中，线性空位罚分为 $-8$。\n\n以下是来自 BLOSUM62 矩阵的相关替换分数：\n- 分数(F, F) = 6\n- 分数(E, R) = 0\n- 分数(S, S) = 4\n- 分数(G, G) = 6\n- 分数(K, K) = 5\n- 分数(D, T) = -1\n- 分数(E, E) = 5\n\n请以整数形式提供总分数。", "solution": "使用替换矩阵和线性空位罚分的比对分数，是通过将每个比对残基对的替换分数求和，并加上每个空位字符的空位罚分来计算的。令 $s(x,y)$ 表示 BLOSUM62 替换分数，线性空位罚分为 $g=-8$（每个空位字符）。\n\n对于给定的跨越8列的比对，各部分的得分贡献如下：\n$$\ns(F,F)=6,\\quad s(E,R)=0,\\quad s(S,S)=4,\\quad \\text{gap}=g=-8,\\quad s(G,G)=6,\\quad s(K,K)=5,\\quad s(D,T)=-1,\\quad s(E,E)=5.\n$$\n\n因此，总比对分数 $S$ 为\n$$\nS=6+0+4+(-8)+6+5+(-1)+5=17.\n$$", "answer": "$$\\boxed{17}$$", "id": "2136014"}, {"introduction": "在我们学会如何为已知的比对打分后，下一步是理解算法如何从无数可能性中“发现”最优比对。本练习聚焦于动态规划算法（如Needleman-Wunsch）的心脏——递推关系，通过计算动态规划矩阵中单个单元格 $M(i,j)$ 的值，你将揭示算法如何通过一系列局部最优决策来构建全局最优解[@problem_id:2136015]。这个过程是连接比对得分和算法实现的桥梁。", "problem": "在生物信息学中，两条序列的全局比对通常使用动态规划算法来执行。该算法会填充一个矩阵（我们称之为 $M$），其中矩阵项 $M(i,j)$ 代表了将序列 $A$ 的前 $i$ 个字符与序列 $B$ 的前 $j$ 个字符进行比对所能得到的最大可能得分。\n\n一位计算生物学家正在为两条蛋白质序列计算这样一个矩阵中的单个矩阵项 $M(i,j)$。$M(i,j)$ 的计算取决于其相邻单元格的值以及计分系统的参数。该计分系统使用一个替换矩阵来为两个氨基酸的比对计分，并使用一个线性空位罚分来为氨基酸与空位的比对计分。\n\n给定动态规划矩阵中以下预先计算好的值：\n- 将序列 $A$ 的前 $i-1$ 个字符与序列 $B$ 的前 $j-1$ 个字符进行比对的得分为 $M(i-1, j-1) = 15$。\n- 将序列 $A$ 的前 $i-1$ 个字符与序列 $B$ 的前 $j$ 个字符进行比对的得分为 $M(i-1, j) = 6$。\n- 将序列 $A$ 的前 $i$ 个字符与序列 $B$ 的前 $j-1$ 个字符进行比对的得分为 $M(i, j-1) = 9$。\n\n此外，给定相关的计分参数：\n- 将序列 $A$ 的第 $i$ 个字符与序列 $B$ 的第 $j$ 个字符进行比对的替换得分为 $S(A_i, B_j) = -3$。\n- 对于引入的任何空位，应用一个恒定的线性空位罚分 $d = -5$。\n\n$M(i, j)$ 的值是从可以到达此单元格的三种可能移动中获得的最大得分：将字符 $A_i$ 与 $B_j$ 比对、将 $A_i$ 与空位比对、或将 $B_j$ 与空位比对。\n\n计算矩阵项 $M(i,j)$ 的数值。", "solution": "该问题要求计算用于全局序列比对的动态规划矩阵中的一个单元格 $M(i,j)$ 的值，该过程由 Needleman-Wunsch 算法描述。$M(i,j)$ 的值是基于一个递推关系计算的，该关系考虑了导致序列 $A$ 的前 $i$ 个字符和序列 $B$ 的前 $j$ 个字符比对的三种可能性。\n\n三种可能性如下：\n1.  序列 $A$ 的第 $i$ 个字符（表示为 $A_i$）与序列 $B$ 的第 $j$ 个字符（表示为 $B_j$）对齐。这种情况的得分是之前字符比对的得分 $M(i-1, j-1)$，加上比对 $A_i$ 和 $B_j$ 的替换得分 $S(A_i, B_j)$。\n2.  序列 $A$ 的第 $i$ 个字符与一个空位对齐。这种情况的得分是将 $A$ 的前 $i-1$ 个字符与 $B$ 的前 $j$ 个字符进行比对的得分 $M(i-1, j)$，加上空位罚分 $d$。\n3.  序列 $B$ 的第 $j$ 个字符与一个空位对齐。这种情况的得分是将 $A$ 的前 $i$ 个字符与 $B$ 的前 $j-1$ 个字符进行比对的得分 $M(i, j-1)$，加上空位罚分 $d$。\n\n$M(i,j)$ 的值是这三种可能性的得分中的最大值。递推关系为：\n$$\nM(i,j) = \\max \\left\\{ M(i-1, j-1) + S(A_i, B_j), \\quad M(i-1, j) + d, \\quad M(i, j-1) + d \\right\\}\n$$\n\n我们已知以下值：\n- $M(i-1, j-1) = 15$\n- $M(i-1, j) = 6$\n- $M(i, j-1) = 9$\n- $S(A_i, B_j) = -3$\n- $d = -5$\n\n现在，我们计算每种情况的得分。\n\n情况1（将 $A_i$ 与 $B_j$ 比对）：\n得分$_1 = M(i-1, j-1) + S(A_i, B_j) = 15 + (-3) = 12$\n\n情况2（将 $A_i$ 与空位比对）：\n得分$_2 = M(i-1, j) + d = 6 + (-5) = 1$\n\n情况3（将 $B_j$ 与空位比对）：\n得分$_3 = M(i, j-1) + d = 9 + (-5) = 4$\n\n$M(i,j)$ 的值是这三个得分中的最大值：\n$$\nM(i,j) = \\max\\{12, 1, 4\\}\n$$\n\n比较这三个值，最大值为12。\n\n因此，矩阵项 $M(i,j)$ 的值为12。", "answer": "$$\\boxed{12}$$", "id": "2136015"}, {"introduction": "现在，让我们将前面学到的概念融会贯通，挑战一个更综合的任务。这个练习要求你确定两条序列进行全局比对所能得到的最高分，这不仅考验你的计算能力，更促使你思考获得最优比对的策略[@problem_id:2135997]。通过解决这个问题，你将能更深刻地体会到Needleman-Wunsch这类算法的最终目标和强大功能。", "problem": "在一项蛋白质工程研究中，一位研究人员正在将一个新合成的七肽与一个已知的、对特定生物功能至关重要的三肽基序进行比较。目标是使用全局比对算法来量化这两个序列之间的整体相似性。新合成的七肽序列为`C-A-L-T-E-C-H`，而已知的功能性基序序列为`C-A-T`。\n\n为了进行比对，采用了一个简单的评分系统。两个相同氨基酸之间的匹配得分为$+2$，而错配得分为$-1$。每个与空位比对的氨基酸，施以$-2$的线性空位罚分。\n\n使用Needleman-Wunsch全局序列比对算法，计算七肽`C-A-L-T-E-C-H`和三肽`C-A-T`之间可能的最大比对分数。", "solution": "设序列为长度为$7$的$S=\\text{C-A-L-T-E-C-H}$和长度为$3$的$T=\\text{C-A-T}$。使用Needleman-Wunsch全局比对，其评分函数为\n$$\ns(x,y)=\\begin{cases}\n+2,  x=y,\\\\\n-1,  x\\neq y,\n\\end{cases}\n\\quad\\text{且每个空位的罚分为 }g=-2\\text{。}\n$$\n在任何全局比对中，如果在$S$中插入$g_{1}$个空位，在$T$中插入$g_{2}$个空位，那么比对后的长度$L$满足\n$$\nL=7+g_{1}=3+g_{2}\\quad\\Rightarrow\\quad g_{2}-g_{1}=4.\n$$\n总空位罚分等于\n$$\ng\\,(g_{1}+g_{2})=-2\\,(g_{1}+g_{2})=-2\\,(2g_{1}+4)=-4g_{1}-8,\n$$\n当取$g_{1}=0$时，该值最大（负得最少），从而得到一个不可避免的空位成本为$-8$。\n\n当$g_{1}=0$时，恰好有$3$个字母-字母比对列（因为$7-(g_{2})=7-4=3$），因此，如果这$3$列全部是匹配，则可以实现来自这些列的最大可能贡献，最多产生\n$$\n3\\times(+2)=+6.\n$$\n因此，总比对分数的上限为\n$$\n(+6)+(-8)=-2.\n$$\n这个上界是可以达到的，因为$T=\\text{C-A-T}$作为$S$的一个有序子序列出现在位置$1,2,4$。一个明确的最优比对是\n$$\n\\begin{array}{ccccccc}\n\\text{C}  \\text{A}  \\text{L}  \\text{T}  \\text{E}  \\text{C}  \\text{H}\\\\\n\\text{C}  \\text{A}  \\text{-}  \\text{T}  \\text{-}  \\text{-}  \\text{-}\n\\end{array}\n$$\n其分数为\n$$\n(+2)+(+2)+(-2)+(+2)+(-2)+(-2)+(-2)=-2.\n$$\n由于达到了上界$-2$，因此可能的最大Needleman-Wunsch全局比对分数是$-2$。", "answer": "$$\\boxed{-2}$$", "id": "2135997"}]}