{"hands_on_practices": [{"introduction": "掌握理论之后，让我们通过实践来巩固对 R-因子和 R-free 的理解。第一个练习将带你回到根本，练习 R-因子的基本计算。通过这个直接的计算 [@problem_id:2120345]，你将能亲手量化一个原子模型与其所依据的实验数据之间的吻合程度，这是评估任何晶体结构质量的第一步。", "problem": "在X射线晶体学中，一个分子的精修原子模型的质量是通过将其与实验收集的衍射数据进行比较来评估的。用于此比较的一个主要指标是晶体学R因子，它量化了观测到的结构因子振幅 $|F_{obs}|$ 与从原子模型计算出的结构因子振幅 $|F_{calc}|$ 之间的差异。\n\n一位生物化学家刚刚完成了一种新型酶的晶体结构的精修工作。分析结果表明，对所有测量的衍射点 ($h$)，其观测到的结构因子振幅总和为：\n$$ \\sum_{h} |F_{obs}|_h = 125,500 $$\n观测振幅与计算振幅之间绝对差的总和为：\n$$ \\sum_{h} ||F_{obs}|_h - |F_{calc}|_h| = 26,360 $$\n\n计算该模型的晶体学R因子。请用小数表示答案，并保留三位有效数字。", "solution": "晶体学R因子量化了观测到的和计算出的结构因子振幅之间的差异，其定义如下：\n$$\nR = \\frac{\\sum_{h} \\left|\\,|F_{obs}|_{h} - |F_{calc}|_{h}\\,\\right|}{\\sum_{h} |F_{obs}|_{h}}.\n$$\n代入给定的总和值，\n$$\nR = \\frac{26{,}360}{125{,}500}.\n$$\n将该分数用公因数20进行约分，得到\n$$\nR = \\frac{1318}{6275}.\n$$\n计算其小数值：\n$$\nR = \\frac{26360}{125500} \\approx 0.21004\\ldots\n$$\n四舍五入到三位有效数字，得到\n$$\nR \\approx 0.210.\n$$", "answer": "$$\\boxed{0.210}$$", "id": "2120345"}, {"introduction": "计算 R-因子是基础，但真正的科学洞察力来自于对结果的批判性解读。这个练习将挑战你扮演一个审稿人的角色，评估一组发表的验证统计数据 [@problem_id:2120354]。此练习的核心是理解 $R_{\\text{work}}$ 和 $R_{\\text{free}}$ 之间的关键关系，后者是防止模型过拟合的独立检验，这个技能对于阅读科学文献和识别潜在有问题的结构模型至关重要。", "problem": "一名结构生物学导论课程的学生正在准备一个学术报告，内容是关于一篇新近发表的论文，该论文描述了一种细菌酶的X射线晶体结构。为了评估论文中提出的原子模型的质量，该学生检查了模型的验证统计数据表。\n\n为了使问题陈述完全自洽，以下是必要的定义：\n- **分辨率**：衡量最终电子密度图细节水平的指标，单位为埃（Å）。数值越低，分辨率越高（细节越丰富）。\n- **R因子 (或 R-work)**：一个量化原子模型坐标与用于构建和精修该模型的实验性X射线衍射数据之间一致性程度的指标。R因子越低，通常表示模型对其精修所用数据的拟合度越好。\n- **R-free**：一个关键的交叉验证指标。其计算方式与R因子相同，但使用的是一小部分（通常为5-10%）在精修过程中被特意排除的衍射数据。它衡量的是模型对未曾“见过”的数据的预测能力。\n\n该论文报告称，最终模型被精修至2.0 Å的分辨率，最终的R因子为0.22，R-free为0.21。\n\n基于这三个值（分辨率、R因子、R-free），以下哪个陈述是怀疑所报告模型及其验证的最重要和最直接的理由？\n\nA. 2.0 Å的分辨率太低，无法构建一个具有科学意义的原子模型。\n\nB. R因子和R-free的值都高于0.20，这通常被认为是高质量结构可接受的最高阈值，与分辨率无关。\n\nC. R-free值低于R因子值，这表明精修或验证过程可能存在缺陷。\n\nD. R-free和R因子之间的差异仅为0.01，这个差值太小，表明模型对实验数据存在严重过拟合。", "solution": "根据给出的定义，关键的验证原则如下：\n1) 分辨率：数值越低对应越高的细节。2.0埃的分辨率被认为足够高，可以构建和验证一个可靠的原子模型；因此，这个值本身并不值得怀疑。\n2) R因子和R-free：对于一个经过适当验证的模型，交叉验证指标应满足 $R_{\\text{free}} \\geq R_{\\text{work}}$，因为 $R_{\\text{work}}$ 是基于用于精修的数据计算的，而 $R_{\\text{free}}$ 是基于一个预留的测试集计算的。过拟合通常表现为 $R_{\\text{work}}$ 的下降幅度大于 $R_{\\text{free}}$，从而增大了 $R_{\\text{free}} - R_{\\text{work}}$ 之间的差距。\n3) 在大约2.0埃分辨率下的典型范围：通常 $R_{\\text{work}}$ 处于0.18到0.24之间，$R_{\\text{free}}$ 处于0.20到0.27之间，并预期存在一个大约为0.02到0.07的正差距 $R_{\\text{free}} - R_{\\text{work}}$。这些是经验性的预期，而非严格的规则，但它们可以为判断提供指导。\n\n将这些原则应用于报告的值：\n- 分辨率：2.0埃是可以接受的，不是一个危险信号。因此，陈述A是错误的。\n- R因子的绝对值：在2.0埃的分辨率下，$R_{\\text{work}} = 0.22$ 和 $R_{\\text{free}} = 0.21$ 并不会自动导致模型不合格；一个不考虑分辨率的、固定的0.20通用阈值是无效的。因此，陈述B是错误的。\n- 相对顺序：计算差值 $\\Delta R = R_{\\text{free}} - R_{\\text{work}} = 0.21 - 0.22 = -0.01$。这个负值违反了预期的不等式 $R_{\\text{free}} \\geq R_{\\text{work}}$。这是一个直接且即时的危险信号，表明可能存在问题，例如测试集的衍射点泄漏到精修集中，或者交叉验证过程存在其他缺陷。因此，陈述C指出了最重要和最直接的怀疑理由。\n- 差距大小的解释：$|\\Delta R| = 0.01$ 的小差距并不表示严重过拟合；严重过拟合通常会产生一个更大的正差距（即 $R_{\\text{work}}$ 远小于 $R_{\\text{free}}$）。因此，陈述D在问题诊断和方向性上都是错误的。\n\n因此，最重要和最直接的怀疑理由是报告的 $R_{\\text{free}}$ 低于 $R_{\\text{work}}$。", "answer": "$$\\boxed{C}$$", "id": "2120354"}, {"introduction": "在真实的科研场景中，我们常常面对不完美的数据。这个终极练习将引导你解决一个晶体学中的实际难题：当衍射数据表现出各向异性时，如何设计一个公正且稳健的 $R_{\\text{free}}$ 测试集 [@problem_id:2120316]。这个练习揭示了，简单的随机抽样可能不足以保证验证的有效性，需要更精巧的策略来确保测试集能真实地代表整个数据集的特性，从而进行可靠的交叉验证。", "problem": "在生物大分子X射线晶体学中，R因子（R-factor）和自由R因子（R-free）是用于对照实验衍射数据验证原子模型的关键指标。R因子衡量用于模型精修的衍射点的观测结构因子振幅（$|F_{obs}|$）与计算结构因子振幅（$|F_{calc}|$）之间的一致性。为了防止过拟合，通常会从精修中剔除一小部分衍射点（通常为5-10%），用于计算R-free，它作为一个独立的交叉验证指标。\n\n考虑一个针对包含20,000个独立衍射点的数据集进行的新型蛋白质结构精修。该衍射数据具有高度各向异性：数据在倒易空间轴a*和b*方向上延伸至1.8 Å的高分辨率，但在其他方向上仅延伸至3.0 Å。一位晶体学家根据分辨率和方向特征将这20,000个衍射点分类如下：\n\n*   **低分辨率壳层（无穷大 - 3.0 Å）：** 6,000个衍射点，各向同性分布（在所有方向上均匀分布）。\n*   **中分辨率壳层（3.0 Å - 2.2 Å）：** 8,000个衍射点，同样为各向同性分布。\n*   **高分辨率壳层（2.2 Å - 1.8 Å）：** 6,000个衍射点。由于各向异性，这些点按方向划分：\n    *   5,000个衍射点来自“强方向”（靠近a*/b*平面）。\n    *   1,000个衍射点来自“弱方向”（远离a*/b*平面）。\n\n目标是选取一个包含1,000个衍射点（占总数的5%）的测试集，用于计算R-free。一个有效的测试集必须能代表整个数据集，以便对模型预测其未曾用于训练的数据的能力提供无偏的评估。\n\n对于这个特定的各向异性数据集，以下哪种针对1,000个衍射点测试集的选取策略，能为潜在的过拟合提供最稳健和无偏的衡量？\n\nA. 从全部20,000个衍射点中完全随机选取1,000个。\n\nB. 选取高分辨率壳层“弱方向”中全部可用的1,000个衍射点。\n\nC. 仅从高分辨率壳层（2.2 Å - 1.8 Å）中选取衍射点，其中从“强方向”选取833个，从“弱方向”选取167个，以保持它们的比例代表性。\n\nD. 仅按分辨率壳层进行分层抽样。从每个壳层中随机选取5%的衍射点：从低分辨率壳层中选取300个，从中分辨率壳层中选取400个，从高分辨率壳层中选取300个。\n\nE. 同时按分辨率壳层和方向特征进行分层抽样。从每个不同类别中选取5%的衍射点：从低分辨率壳层中选取300个，从中分辨率壳层中选取400个，从高分辨率“强”方向集合中选取250个，从高分辨率“弱”方向集合中选取50个。", "solution": "目标：从 $N=20000$ 个衍射点中选择一个大小为 $T=1000$ 的测试集，该测试集需要能代表分辨率和方向特征的联合分布，从而使R-free能够衡量模型在所有数据区间上的泛化能力，并稳健地检测过拟合。\n\n定义由分辨率和各向异性产生的四个不同类别：\n$$\n\\text{低分辨率}:\\ n_{L}=6000,\\quad\n\\text{中分辨率}:\\ n_{M}=8000,\\quad\n\\text{高分辨率-强方向}:\\ n_{HS}=5000,\\quad\n\\text{高分辨率-弱方向}:\\ n_{HW}=1000.\n$$\n完整数据集中各类别的经验分布为\n$$\np_{L}=\\frac{n_{L}}{N}=\\frac{6000}{20000}=0.3,\\quad\np_{M}=\\frac{8000}{20000}=0.4,\\quad\np_{HS}=\\frac{5000}{20000}=0.25,\\quad\np_{HW}=\\frac{1000}{20000}=0.05.\n$$\n一个无偏且稳健的测试集应尽可能具有相同的联合分布；因此，测试集中的理想目标计数为\n$$\nt^{\\ast}_{i}=T\\,p_{i}\\ \\Rightarrow\\ (t^{\\ast}_{L},t^{\\ast}_{M},t^{\\ast}_{HS},t^{\\ast}_{HW})=(300,400,250,50).\n$$\n\n根据与 $t^{\\ast}$ 的偏差和稳健性（方差）来评估每个选项：\n\nA. 从 $N$ 个中进行简单随机抽样得到 $T$ 个样本，其类别计数是超几何随机变量，均值等于 $t^{\\ast}_{i}$，方差为\n$$\n\\operatorname{Var}(t_{i})=T\\,p_{i}(1-p_{i})\\frac{N-T}{N-1}.\n$$\n因此，虽然期望是无偏的，但实际产生的测试集可能会偏离 $t^{\\ast}$，可能导致稀有但关键的类别（例如，高分辨率-弱方向）代表性不足，从而降低了此各向异性数据集的稳健性。\n\nB. 从高分辨率-弱方向类别中选取全部 $T=1000$ 个点，得到\n$$\n(t_{L},t_{M},t_{HS},t_{HW})=(0,0,0,1000),\n$$\n其偏差为\n$$\n(t_{L}-t^{\\ast}_{L},t_{M}-t^{\\ast}_{M},t_{HS}-t^{\\ast}_{HS},t_{HW}-t^{\\ast}_{HW})=(-300,-400,-250,950),\n$$\n这是高度有偏的，且不具代表性。\n\nC. 仅从高分辨率壳层中按强:弱 $5:1$ 的比例选取，得到\n$$\n(t_{L},t_{M},t_{HS},t_{HW})=(0,0,833,167),\n$$\n因此偏差为\n$$\n(-300,-400,583,117),\n$$\n这同样是强烈的有偏，因为它完全排除了低分辨率和中分辨率的数据。\n\nD. 仅按分辨率分层固定了\n$$\n(t_{L},t_{M},t_{H})=(300,400,300),\\quad t_{H}=t_{HS}+t_{HW}=300.\n$$\n在高分辨率壳层内部，$t_{HS}$ 和 $t_{HW}$ 是随机的，其期望为 $(250,50)$，但方差不为零。特别是，存在一个正概率会严重低估高分辨率-弱方向类别（例如，$t_{HW}=0$ 的概率等于 $\\binom{5000}{300}\\big/\\binom{6000}{300}>0$），这降低了在弱方向上检测过拟合的稳健性。\n\nE. 同时按分辨率和方向特征进行分层抽样，会精确地选取到\n$$\n(t_{L},t_{M},t_{HS},t_{HW})=(300,400,250,50)=t^{\\ast}.\n$$\n这与完整数据集在分辨率和各向异性上的联合分布完全匹配，确保了代表性并最小化了偏差。随机性仅保留在每个层内部，在消除层间不平衡的同时保持了独立性。对于各向异性数据集来说，这是最稳健的方法，因为它保证了稀疏的高分辨率-弱方向衍射点被包含并被赋予正确的权重，同时也覆盖了所有的分辨率壳层。\n\n因此，最稳健和无偏的策略是同时按分辨率壳层和方向特征进行分层抽样。", "answer": "$$\\boxed{E}$$", "id": "2120316"}]}