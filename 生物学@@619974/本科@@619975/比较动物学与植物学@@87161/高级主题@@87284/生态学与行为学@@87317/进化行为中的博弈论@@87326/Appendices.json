{"hands_on_practices": [{"introduction": "动物的觅食行为常常涉及策略权衡。本练习使用一个经典的“鹰鸽博弈”变体，展示了在自然界中，没有单一策略永远是最佳选择，种群中不同策略的稳定共存反而是一种常态。通过计算不同策略的期望收益，并令其相等，你可以亲手推导出进化稳定策略下的种群行为比例，这是理解混合策略进化稳定性的核心技能。[@problem_id:1748810]", "problem": "在一个简化的生态模型中，两只沙漠狐狸必须独立决定去哪里过夜觅食。它们各自有两个选择：去一个单一的大绿洲，或者去周围包含许多孤立觅食点的稀疏灌木丛。\n\n从绿洲获得的总能量收益是一个常数 $H$。从灌木丛中的单个觅食点获得的能量收益是一个常数 $L$。以下规则决定了每只狐狸的能量回报：\n1.  如果两只狐狸都选择灌木丛，它们会在不同的觅食点觅食，每只都获得 $L$ 单位的能量。\n2.  如果一只狐狸选择绿洲而另一只选择灌木丛，那么在绿洲的狐狸将获得其所有资源，得到 $H$ 的能量，而在灌木丛的狐狸则得到 $L$ 的能量。\n3.  如果两只狐狸都选择绿洲，它们必须进行竞争。它们平分资源，但冲突本身会使每只狐狸消耗 $c$ 的能量。因此，每只狐狸的净能量收益是 $H/2 - c$。\n\n当绿洲比灌木丛觅食点更富饶（$H > L$），但共享绿洲的收益低于独占一个灌木丛觅食点（$H/2 - c  L$）时，这个情景变得有趣。假设这些条件成立。在这样一个大型狐狸种群中，个体被随机配对进行这场觅食博弈，种群可以演化到一个稳定状态，其中两种策略（选择绿洲和选择灌木丛）共存。\n\n确定选择在绿洲觅食的狐狸种群的平衡比例。用 $H$、$L$ 和 $c$ 的符号表达式表示你的答案。", "solution": "这个问题可以用演化博弈论的框架来分析。我们有两个参与者（狐狸）和两种策略：“绿洲”和“灌木丛”。我们首先需要构建收益矩阵，该矩阵表示在给定参与者2（列参与者）的策略下，参与者1（行参与者）的能量收益。\n\n让我们将一个参与者的收益表示为 `Payoff(Strategy1, Strategy2)`，其中 `Strategy1` 是该参与者自己的策略，`Strategy2` 是对手的策略。\n\n根据问题描述：\n- 如果参与者1选择“绿洲”，参与者2也选择“绿洲”，收益为 $H/2 - c$。因此，`Payoff(绿洲, 绿洲)` = $H/2 - c$。\n- 如果参与者1选择“绿洲”，参与者2选择“灌木丛”，收益为 $H$。因此，`Payoff(绿洲, 灌木丛)` = $H$。\n- 如果参与者1选择“灌木丛”，参与者2选择“绿洲”，收益为 $L$。因此，`Payoff(灌木丛, 绿洲)` = $L$。\n- 如果参与者1选择“灌木丛”，参与者2也选择“灌木丛”，收益为 $L$。因此，`Payoff(灌木丛, 灌木丛)` = $L$。\n\n我们可以将参与者1的收益总结在一个收益矩阵中：\n$$\n\\begin{array}{c|cc}\n\\text{参与者 1}  \\text{参与者 2: 绿洲}  \\text{参与者 2: 灌木丛} \\\\\n\\hline\n\\text{绿洲}  H/2 - c  H \\\\\n\\text{灌木丛}  L  L \\\\\n\\end{array}\n$$\n\n问题陈述了一个演化稳定混合策略均衡的存在，其中两种策略共存。当选择“绿洲”策略的个体的期望收益（或适应度）等于选择“灌木丛”策略的个体的期望收益时，就会出现这种情况。\n\n设 $p$ 是种群中选择“绿洲”策略的比例。因此，种群中选择“灌木丛”策略的比例是 $1-p$。\n\n现在，我们计算一个个体在这个混合种群中与一个随机成员博弈时，采取每种策略的期望收益。\n\n选择“绿洲”策略的期望收益 $E(\\text{绿洲})$ 是与选择“绿洲”策略的参与者和选择“灌木丛”策略的参与者博弈的收益之和，并按它们在种群中的各自频率加权：\n$$ E(\\text{绿洲}) = p \\cdot \\text{Payoff(绿洲, 绿洲)} + (1-p) \\cdot \\text{Payoff(绿洲, 灌木丛)} $$\n代入收益值：\n$$ E(\\text{绿洲}) = p \\left(\\frac{H}{2} - c\\right) + (1-p)H $$\n\n选择“灌木丛”策略的期望收益 $E(\\text{灌木丛})$ 的计算方法类似：\n$$ E(\\text{灌木丛}) = p \\cdot \\text{Payoff(灌木丛, 绿洲)} + (1-p) \\cdot \\text{Payoff(灌木丛, 灌木丛)} $$\n代入收益值：\n$$ E(\\text{灌木丛}) = p \\cdot L + (1-p)L $$\n简化后得到：\n$$ E(\\text{灌木丛}) = L(p + 1 - p) = L $$\n\n在均衡状态下，期望收益必须相等：$E(\\text{绿洲}) = E(\\text{灌木丛})$。\n$$ p \\left(\\frac{H}{2} - c\\right) + (1-p)H = L $$\n\n现在，我们求解 $p$：\n$$ p \\frac{H}{2} - pc + H - pH = L $$\n重新整理方程，将含有 $p$ 的项分离出来：\n$$ H - L = pH - p \\frac{H}{2} + pc $$\n从右边提取公因子 $p$：\n$$ H - L = p \\left(H - \\frac{H}{2} + c\\right) $$\n$$ H - L = p \\left(\\frac{H}{2} + c\\right) $$\n\n最后，我们求解 $p$，即选择“绿洲”策略的种群的平衡比例：\n$$ p = \\frac{H - L}{\\frac{H}{2} + c} $$\n\n为了简化表达式，我们可以将分子和分母同乘以2：\n$$ p = \\frac{2(H - L)}{H + 2c} $$\n\n题目中给出的条件 $H > L$ 和 $L > H/2 - c$ 确保了 $p$ 是一个介于0和1之间的有效比例。$H > L$ 确保了分子为正。$L > H/2 - c$ 等价于 $c > H/2 - L$。我们来检验条件 $p  1$：\n$2(H-L)  H+2c$\n$2H - 2L  H + 2c$\n$H - 2L  2c$\n$H/2 - L  c$，这与给定的条件 $L > H/2 - c$ 等价。因此，解是一致的。", "answer": "$$\\boxed{\\frac{2(H - L)}{H + 2c}}$$", "id": "1748810"}, {"introduction": "动物的社会性行为，如集群，是进化中一个迷人的现象。本练习构建了一个模型，来探索捕食风险和资源竞争这两种相互冲突的压力如何共同决定了最佳的群体规模。你将学习如何通过设定一个关键的平衡点——即群体中个体与独居个体的适应度相等——来求解进化上的稳定群体大小，这让你能更深刻地理解社会结构背后的进化逻辑。[@problem_id:1748871]", "problem": "在对一种假想鸟类 Glimmerwing Finch 的研究中，一个个体的适应度受其所属觅食群体大小的影响。一位动物行为学家提出了一个模型，用于描述单个雀鸟的适应度 $W(n)$ 作为其群体大小 $n$ 的函数：\n\n$$W(n) = K - \\frac{A}{n} - B n$$\n\n此处，$n$ 是群体中的个体数量（$n \\ge 1$）。该模型的参数均为正常数：\n- $K$ 代表一个基准适应度分量。\n- 项 $\\frac{A}{n}$ 代表因捕食风险而产生的适应度成本。由于稀释效应和警惕性提高，该成本随着群体规模 $n$ 的增大而降低。参数 $A$ 量化了该物种面临的整体捕食压力。\n- 项 $B n$ 代表因资源竞争而产生的适应度成本。随着更多个体竞争同一食物来源，该成本随群体规模 $n$ 线性增加。参数 $B$ 量化了这种竞争的强度。\n\n在该雀鸟种群中，群体会形成和解散。个体可以作为独居鸟类（大小为 $n=1$ 的群体）或作为更大群体的成员存在。系统在一个演化稳定群体规模（记为 $n_{ESS}$）处达到平衡。当群体中一个个体的适应度与独居个体的适应度相同时，就达到了这个稳定规模。此时，独居鸟类加入群体没有净收益，群体成员离开变为独居也没有净收益。\n\n假设为了分析目的，群体规模 $n$ 可以被视为一个连续变量，请确定非平凡的演化稳定群体规模 $n_{ESS}$，用参数 $A$ 和 $B$ 表示。", "solution": "在一个演化稳定群体规模处，一个大小为 $n$ 的群体中个体的适应度等于独居个体的适应度，因此我们设定平衡条件 $W(n)=W(1)$。已知\n$$\nW(n)=K-\\frac{A}{n}-Bn,\n$$\n我们首先计算\n$$\nW(1)=K-A-B.\n$$\n令 $W(n)=W(1)$ 可得\n$$\nK-\\frac{A}{n}-Bn=K-A-B.\n$$\n两边消去 $K$ 并乘以 $-1$ 可得\n$$\n\\frac{A}{n}+Bn=A+B.\n$$\n两边同乘以 $n$ 并整理，得到二次方程\n$$\nBn^{2}-(A+B)n+A=0.\n$$\n使用求根公式解出 $n$ 可得\n$$\nn=\\frac{(A+B)\\pm\\sqrt{(A+B)^{2}-4AB}}{2B}\n=\\frac{(A+B)\\pm\\sqrt{(A-B)^{2}}}{2B}\n=\\frac{(A+B)\\pm|A-B|}{2B}.\n$$\n两个根是 $n=1$ 和 $n=\\frac{A}{B}$。平凡解是 $n=1$；因此，非平凡的平衡点是\n$$\nn_{ESS}=\\frac{A}{B}.\n$$\n可行性要求 $n\\geq 1$，所以当 $A>B$ 时 $n_{ESS}>1$；如果 $A\\leq B$，唯一可行的平衡点是平凡解 $n=1$。", "answer": "$$\\boxed{\\frac{A}{B}}$$", "id": "1748871"}, {"introduction": "在一个群体中，个体如何平衡自身利益与集体利益？本练习以狐獴的警戒行为为例，将博弈论的应用提升到了一个新的层次，即策略是连续变化的（如警戒时间$p$）。你需要运用微积分这一强大的数学工具，通过最大化个体适应度函数来寻找进化稳定策略。这个练习将让你掌握在更复杂、更现实的生物学情境中，如何建模并求解连续策略下的进化均衡点。[@problem_id:1748865]", "problem": "在社会生物学中，群体中动物的行为通常使用博弈论进行建模。考虑一个由 $N$ 只猫鼬组成的觅食群体。每只猫鼬都必须在寻找食物的需求和警惕捕食者的需求之间取得平衡。\n\n我们来为单一个体（“焦点”猫鼬）的适应度建模。其适应度 $W$ 取决于它自身的警戒策略以及群体中其他成员的策略。焦点猫鼬的适应度由其觅食成功率和生存概率的乘积给出。这由以下函数表示：\n\n$$W(p_i, p) = (1 - p_i) \\left( 1 - \\frac{k}{1 + p_i + (N-1)p} \\right)$$\n\n其中：\n- $p_i$ 是焦点猫鼬用于警戒的时间比例（$0 \\le p_i \\le 1$）。\n- $p$ 是群体中其他 $N-1$ 只猫鼬各自用于警戒的时间比例。\n- $N$ 是群体中猫鼬的总数（$N \\ge 1$）。\n- $k$ 是一个与捕食风险强度相关的常数。对于此环境，已知 $1/2  k  1$。\n\n项 $(1 - p_i)$ 代表个体的觅食成功率，当它不花费任何时间进行警戒时，该成功率最大。括号中的项代表在捕食中存活的概率，该概率随着群体总警戒水平 $p_i + (N-1)p$ 的增加而增加。\n\n我们感兴趣的是寻找对称的演化稳定策略（ESS）。这是一个警戒水平，我们称之为 $p^*$，如果群体中的所有个体都采用该策略，它就不会被任何替代策略所“入侵”。在该策略下，没有单个个体可以通过单方面改变自己的警戒水平来获得更高的适应度。\n\n请确定这个最优均衡警戒时间 $p^*$ 关于群体大小 $N$ 和捕食风险常数 $k$ 的解析表达式。", "solution": "问题要求解对称演化稳定策略（ESS），我们将其表示为 $p^*$。在此背景下，ESS 对应于对称纳什均衡。这是一个策略 $p^*$，当所有其他个体都采用该策略时，焦点个体的最佳应对策略也是采用 $p^*$。\n\n设其他 $N-1$ 只猫鼬的警戒策略为 $p$。采用策略 $p_i$ 的焦点个体的适应度由下式给出：\n$$W(p_i, p) = (1 - p_i) \\left( 1 - \\frac{k}{1 + p_i + (N-1)p} \\right)$$\n\n为了找到焦点个体的最优策略 $p_i$，我们必须在保持 $p$ 不变的情况下，关于 $p_i$ 最大化其适应度 $W(p_i, p)$。为此，我们对 $W$ 求关于 $p_i$ 的偏导数，并将其设为零。\n\n令 $G(p_i, p) = 1 + p_i + (N-1)p$。适应度函数为 $W(p_i, p) = (1-p_i)(1 - k/G)$。我们使用乘法法则求导，$(fg)' = f'g + fg'$:\n- $f(p_i) = 1 - p_i \\implies f'(p_i) = -1$。\n- $g(p_i) = 1 - k [G(p_i,p)]^{-1} \\implies g'(p_i) = -k(-1)[G(p_i,p)]^{-2} \\frac{\\partial G}{\\partial p_i} = k[G(p_i,p)]^{-2} \\cdot 1 = \\frac{k}{G^2}$。\n\n偏导数为：\n$$\\frac{\\partial W}{\\partial p_i} = (-1)\\left(1 - \\frac{k}{G}\\right) + (1-p_i)\\left(\\frac{k}{G^2}\\right)$$\n$$\\frac{\\partial W}{\\partial p_i} = -1 + \\frac{k}{G} + \\frac{k(1-p_i)}{G^2}$$\n\n为了求最大值，我们将此导数设为零：\n$$-1 + \\frac{k}{1 + p_i + (N-1)p} + \\frac{k(1-p_i)}{(1 + p_i + (N-1)p)^2} = 0$$\n\nESS 是一个对称均衡，因此我们现在引入所有个体都采用相同策略的条件，即 $p_i = p = p^*$。\n将此代入方程，得到：\n$$-1 + \\frac{k}{1 + p^* + (N-1)p^*} + \\frac{k(1-p^*)}{(1 + p^* + (N-1)p^*)^2} = 0$$\n$$-1 + \\frac{k}{1 + Np^*} + \\frac{k(1-p^*)}{(1 + Np^*)^2} = 0$$\n\n为了解出 $p^*$，我们将整个方程乘以 $(1 + Np^*)^2$：\n$$-(1 + Np^*)^2 + k(1 + Np^*) + k(1-p^*) = 0$$\n\n展开各项：\n$$-(1 + 2Np^* + N^2(p^*)^2) + (k + kNp^*) + (k - kp^*) = 0$$\n$$-1 - 2Np^* - N^2(p^*)^2 + 2k + kNp^* - kp^* = 0$$\n\n按 $p^*$ 的幂次对项进行分组：\n$$-N^2(p^*)^2 + (-2N + kN - k)p^* + (2k - 1) = 0$$\n\n乘以 -1 使首项系数为正：\n$$N^2(p^*)^2 + (2N - (kN - k))p^* - (2k - 1) = 0$$\n$$N^2(p^*)^2 + (2N - k(N-1))p^* + (1 - 2k) = 0$$\n\n这是一个关于 $p^*$ 的一元二次方程，形式为 $ax^2 + bx + c = 0$，其中：\n- $a = N^2$\n- $b = 2N - k(N-1)$\n- $c = 1 - 2k$\n\n我们使用一元二次方程求根公式来求解 $p^*$：\n$$p^* = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$\n$$p^* = \\frac{-(2N - k(N-1)) \\pm \\sqrt{(2N - k(N-1))^2 - 4N^2(1 - 2k)}}{2N^2}$$\n\n我们来化简判别式 $\\Delta = b^2 - 4ac$：\n$$\\Delta = (4N^2 - 4Nk(N-1) + k^2(N-1)^2) - 4N^2(1-2k)$$\n$$\\Delta = 4N^2 - 4N^2k + 4Nk + k^2(N-1)^2 - 4N^2 + 8N^2k$$\n$$\\Delta = 4N^2k + 4Nk + k^2(N-1)^2$$\n$$\\Delta = 4Nk(N+1) + k^2(N-1)^2$$\n由于 $N \\ge 1$ 且 $k > 1/2$，判别式 $\\Delta$ 总是正的，因此存在实数解。\n\n$p^*$ 的解为：\n$$p^* = \\frac{k(N-1) - 2N \\pm \\sqrt{k^2(N-1)^2 + 4Nk(N+1)}}{2N^2}$$\n\n我们必须选择具有物理意义的解。由于 $p^*$ 代表时间比例，它必须是非负的，即 $p^* \\ge 0$。\n我们来分析一下 $k(N-1) - 2N$ 这一项。由于 $k  1$，所以 $k(N-1)  N-1$。因此，$k(N-1) - 2N  N-1-2N = -N-1$。对于 $N \\ge 1$，此项总是负的。\n项 $\\sqrt{\\Delta}$ 总是正的。\n带有负号的解 $\\frac{(k(N-1) - 2N) - \\sqrt{\\Delta}}{2N^2}$ 总是负的，因为分子是两个负项之和，而分母是正项。这个解没有物理意义。\n\n因此，我们必须取带有正号的解：\n$$p^* = \\frac{k(N-1) - 2N + \\sqrt{k^2(N-1)^2 + 4Nk(N+1)}}{2N^2}$$\n为了确认这个根是正的，我们必须检查是否 $\\sqrt{\\Delta} > |k(N-1) - 2N| = 2N - k(N-1)$。\n这等价于检查是否 $\\Delta > (2N - k(N-1))^2$。\n$\\Delta - (2N - k(N-1))^2 = (4Nk(N+1) + k^2(N-1)^2) - (4N^2 - 4Nk(N-1) + k^2(N-1)^2) = 4N^2k + 4Nk - 4N^2 + 4N^2k - 4Nk = 8N^2k - 4N^2 = 4N^2(2k-1)$。\n由于问题陈述 $k > 1/2$，这个差值为正。\n所以，$\\sqrt{\\Delta} > 2N - k(N-1)$，这确保了分子 $k(N-1) - 2N + \\sqrt{\\Delta}$ 为正。因此，为 $p^*$ 选择这个根会得到一个正值。\n这就是正确的、具有物理意义的解。", "answer": "$$\\boxed{\\frac{k(N-1) - 2N + \\sqrt{k^{2}(N-1)^{2} + 4Nk(N+1)}}{2N^{2}}}$$", "id": "1748865"}]}