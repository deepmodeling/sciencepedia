{"hands_on_practices": [{"introduction": "在开启激光之前，一次成功的长期成像实验就需要周密的规划。本练习模拟了一个常见的现实挑战：管理光片显微镜产生的海量数据集。通过计算为满足存储限制所必须进行的调整，你将对成像时长、比特深度和像素合并（binning）等实验参数如何影响最终数据量建立起定量的感觉。", "problem": "一位发育生物学家正计划使用光片荧光显微镜 (Light-Sheet Fluorescence Microscope, LSFM) 对小鼠胚胎进行一项长期活体成像实验。最初的实验计划涉及一个12小时的连续成像过程，预计将使用12位像素编码产生总共6.0太字节 (TB) 的数据。\n\n为了更好地捕捉发育过程的全貌，该研究人员修订了计划。新计划要求将总成像时长增加到36小时。同时，为了增强信号的动态范围，他们决定升级成像探测器，该探测器现在使用16位像素编码。\n\n该研究小组的数据服务器为此实验提供的最大可用存储容量为20.0 TB。为确保修订后计划的数据集不超过此限制，研究人员必须采用空间合并（spatial binning）。在空间合并中，探测器上一个$n \\times n$像素方阵所产生的电荷在读出前被合并（或称“binned”）成一个单一的输出像素。这个过程使每个图像平面中的像素数量减少为原来的$1/n^2$，从而数据大小也相应减小。\n\n假设实验的总数据大小与成像时长和像素位深均成线性关系，那么为确保数据量不超过20.0 TB的存储限制，研究人员必须使用的合并因子 $n$ 的最小整数值是多少？在本题中，请使用 1 TB = $10^{12}$ 字节的换算关系。合并因子 $n$ 是一个无量纲整数。", "solution": "设 $D$ 表示总数据大小，$T$ 表示成像时长，$b$ 表示像素位深，$n$ 表示空间合并因子。根据题设假设，数据大小与时长和位深成线性正比，与合并因子的平方成反比：\n$$\nD \\propto \\frac{T\\,b}{n^{2}}.\n$$\n对于初始计划，有 $T_{0}=12$ 小时，$b_{0}=12$ 位，$n_{0}=1$，以及 $D_{0}=6.0\\ \\text{TB}$。对于修订后的计划，$T_{1}=36$ 小时，$b_{1}=16$ 位，而 $n$ 待定。根据比例关系，\n$$\nD_{1}=D_{0}\\left(\\frac{T_{1}}{T_{0}}\\right)\\left(\\frac{b_{1}}{b_{0}}\\right)\\left(\\frac{n_{0}^{2}}{n^{2}}\\right)=6.0\\ \\text{TB}\\times\\frac{36}{12}\\times\\frac{16}{12}\\times\\frac{1}{n^{2}}.\n$$\n计算各比例因子：\n$$\n\\frac{36}{12}=3,\\quad \\frac{16}{12}=\\frac{4}{3}\\quad\\Rightarrow\\quad 3\\times\\frac{4}{3}=4,\n$$\n所以\n$$\nD_{1}=\\frac{24.0\\ \\text{TB}}{n^{2}}.\n$$\n为满足存储限制 $D_{1}\\leq 20.0\\ \\text{TB}$，\n$$\n\\frac{24.0}{n^{2}}\\leq 20.0 \\quad\\Longrightarrow\\quad n^{2}\\geq \\frac{24.0}{20.0}=\\frac{6}{5}.\n$$\n因此\n$$\nn\\geq \\sqrt{\\frac{6}{5}}.\n$$\n满足此不等式的最小整数 $n$ 是 $n=2$。", "answer": "$$\\boxed{2}$$", "id": "1698144"}, {"introduction": "在活体成像过程中，你需要在各种因素之间不断权衡，以获得最佳数据。本练习让你扮演显微镜操作者的角色，直面一个经典困境：你的信号太弱，但样本移动得很快 [@problem_id:1698180]。理解相机曝光时间、图像亮度和运动模糊之间的关系，对于在不牺牲关键信息的前提下捕捉动态生物过程至关重要。", "problem": "一位发育生物学家正在使用选择性平面照明显微技术（SPIM），一种光片显微技术，对斑马鱼胚胎的心脏发育进行实时成像。其目标是随时间追踪单个心脏祖细胞的迁移。这是一个快速的过程，显著的细胞运动发生在秒级的时间尺度上。相机采集的初始图像太暗，无法清晰地区分荧光标记的细胞。为了增强信号并使细胞更清晰可见，研究人员决定增加相机捕获每一帧的曝光时间，同时保持所有其他参数（如激光照明功率）不变。\n\n下列哪个描述最准确地代表了与此特定调整相关的主要权衡？\n\nA. 图像会变得更亮，空间分辨率会提高，从而可以看到更精细的细节。\n\nB. 图像会变得更暗，运动模糊的风险会增加，从而掩盖细胞细节。\n\nC. 图像会变得更亮，但光毒性的风险会增加，可能对胚胎造成伤害。\n\nD. 图像会变得更亮，但运动模糊的风险会增加，可能掩盖细胞的动态运动。\n\nE. 图像会变得更亮，且没有显著的负面影响，因为SPIM是为温和的活体成像而设计的。", "solution": "我们分析在一个成像快速细胞运动的SPIM装置中，在保持激光照明功率和其他参数不变的情况下，增加相机曝光时间的效果。\n\n首先，增加曝光时间会增加每个像素检测到的光子数量。如果相机处的光子检测率（单位时间内的光子数）为 $R$，那么每帧检测到的信号为\n$$\nS = R\\, t_{\\text{exp}},\n$$\n因此 $S$ 与 $t_{\\text{exp}}$ 呈线性关系。所以，曝光时间越长，图像越亮。\n\n其次，运动模糊与样本速度和曝光时间的乘积成正比。如果一个特征在成像平面上的投影速度为 $v$，那么在单次曝光期间，其图像会被涂抹过一个距离\n$$\nb = v\\, t_{\\text{exp}}.\n$$\n对于快速过程（秒级或更快的运动），增加 $t_{\\text{exp}}$ 会增加 $b$，从而降低解析动态细胞运动和精确追踪单个细胞的能力。\n\n第三，空间分辨率（由光学系统和采样决定）不会因增加曝光时间而提高；曝光时间会改变信号水平和可能的信噪比，但不会改变光学点扩散函数。因此，声称空间分辨率提高的说法是不正确的。\n\n第四，关于光毒性和光漂白：在激光功率保持恒定的情况下增加曝光时间，每帧的总光剂量会更大，这会增加光毒性风险。然而，与宽场或共聚焦显微技术相比，SPIM本身的设计就是为了最小化光剂量，并且在追踪快速运动的特定背景下，增加 $t_{\\text{exp}}$ 最直接和最主要的权衡是运动模糊，其量化表示为 $b = v\\, t_{\\text{exp}}$。因此，尽管较长的曝光时间可能会增加光毒性，但在快速过程中进行此项调整的主要权衡是运动模糊风险的增加。\n\n因此，最准确的描述是，图像会变得更亮，但运动模糊的风险会增加，可能掩盖细胞的动态运动。", "answer": "$$\\boxed{D}$$", "id": "1698180"}, {"introduction": "四维光片实验生成了一部关于发育过程的“电影”，但样本漂移等伪影会掩盖真实的生物学运动。本练习介绍了后处理流程中首个也是最关键的计算步骤：图像配准（image registration） [@problem_id:1698132]。通过理解其目的，你将明白我们如何通过计算来稳定胚胎，为后续的所有分析（例如随时间追踪单个细胞）创建一个必需的稳定参考坐标系。", "problem": "一位发育生物学家正在进行一项延时实验，使用光片荧光显微镜（Lightsheet Fluorescence Microscope）对一个活体发育中的胚胎进行为期48小时的成像。这项技术会生成一个四维（4D）数据集，该数据集由一系列按固定时间间隔捕获的三维（3D）图像堆栈组成。尽管进行了仔细的固定，活体胚胎在长时间的采集过程中仍会在其水性介质中表现出微小且不可预测的物理漂移和旋转。为了分析细胞追踪或形态发生等发育过程，至关重要的是让胚胎在最终处理的数据中呈现为静止状态。一个称为图像配准的计算过程是应用于原始4D数据以解决此问题的第一个主要步骤。\n\n对这个4D光片数据集执行图像配准的主要目的是什么？\n\nA. 自动识别并勾勒出每个3D图像堆栈中单个细胞或解剖结构的边界。\n\nB. 通过计算校正因光漂白导致荧光信号强度随时间衰减的现象。\n\nC. 将从不同空间位置拍摄的多个重叠3D图像堆栈组合成一个更大的、包含整个胚胎的复合图像。\n\nD. 通过算法将来自不同时间点的所有3D图像堆栈对齐到一个公共坐标系，从而在计算上校正胚胎的物理漂移和旋转。\n\nE. 从3D堆栈内的每个2D平面中去除光学模糊和离焦光，从而提高有效分辨率和信噪比。", "solution": "我们将4D光片数据集建模为3D体积的时间序列，$I(\\mathbf{x}, t)$，其中 $\\mathbf{x} \\in \\mathbb{R}^{3}$ 表示空间坐标，$t$ 表示离散的时间点。胚胎的物理漂移和旋转意味着，由于一个随时间变化的空间变换 $T_{t}$（例如，刚性或仿射变换），结构在表观上的位置会随时间改变。图像配准的计算目标是估计变换 $\\{T_{t}\\}$，使得所有体积都对齐到一个公共参考系。形式上，配准旨在寻找能最大化一个选定的参考体积 $I(\\mathbf{x}, t_{0})$ 与变换后的体积 $I(T_{t}(\\mathbf{x}), t)$ 之间相似性度量 $S$ 的变换 $T_{t}$，即：\n$$\n\\max_{T_{t}}\\, S\\big(I(\\mathbf{x}, t_{0}),\\, I(T_{t}(\\mathbf{x}), t)\\big),\n$$\n从而校正时间点间的运动，使胚胎在配准后的数据中看起来是静止的。这直接满足了精确进行细胞追踪和形态发生分析的实际需求。\n\n根据配准的定义和目的评估各个选项：\n- 选项A（分割）：识别和勾勒细胞或结构边界是图像分割，而不是图像配准。配准是对齐图像，而不是描绘对象。\n- 选项B（光漂白校正）：校正随时间变化的强度衰减是光照或光漂白归一化任务，而不是空间对齐。\n- 选项C（拼接）：将重叠的空间切片组合成一个更大的复合图像是马赛克拼接。虽然它在空间上使用了配准概念，但问题关注的是对齐同一视场的不同时间点以抵消漂移和旋转。\n- 选项D（时间上对齐到公共坐标系）：这正是针对延时4D数据集的配准目标——估计并应用 $T_{t}$ 来校正漂移和旋转，从而使样本看起来是静止的。\n- 选项E（反卷积）：去除模糊和离焦光是反卷积或图像复原，而不是图像配准。\n\n因此，在这种情况下，主要目的是通过算法将所有3D堆栈在时间上对齐到一个公共坐标系以校正运动，这正是选项D的内容。", "answer": "$$\\boxed{D}$$", "id": "1698132"}]}