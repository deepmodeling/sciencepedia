{"hands_on_practices": [{"introduction": "基于智能体的模型是理解群体层面现象如何从个体事件中产生的强大工具。第一个练习将探讨遗传漂变，这是演化生物学中的一个基本概念，其中随机性决定了等位基因频率的变化。通过对一个小种群进行建模并计算特定结果的概率，你将亲身体验到随机性在生物系统中的核心作用。[@problem_id:1415652]", "problem": "在某个合成生物学实验室中，一个简单的基于智能体的模型被用来研究一个受控细菌种群中的遗传漂变。在各代之间，种群大小保持为一个恒定数 $N=10$。这些细菌经过基因工程改造，表达两种互斥的荧光蛋白等位基因之一：一种是绿色荧光蛋白 (GFP)，我们可标记为等位基因 'G'；另一种是红色荧光蛋白 (RFP)，标记为等位基因 'R'。这些等位基因是选择性中性的，不提供任何生存或繁殖优势。\n\n在模拟开始时（第 0 代），种群由 $N_G = 3$ 个拥有等位基因 'G' 的细菌和 $N_R = 7$ 个拥有等位基因 'R' 的细菌组成。\n\n下一代（第 1 代）的种群是通过对第 0 代种群进行 $N$ 次独立抽样事件而创建的。每个抽样事件包括从第 0 代种群中*有放回地*随机选择一个细菌，并为新一代创建一个它的完美复制品。\n\n计算第 1 代中拥有等位基因 'G' 的细菌数量与第 0 代中拥有等位基因 'G' 的细菌数量相同的概率。将最终答案四舍五入到三位有效数字。", "solution": "该设置对应于从一个有限总体中进行有放回抽样，其中 $N$ 次抽样中的每一次都独立地以等于其初始频率的概率产生等位基因 $G$。设 $N$ 为每代细菌的总数，设 $N_{G}$ 和 $N_{R}$ 分别为第 0 代中等位基因 $G$ 和 $R$ 的数量。在任何单次抽样中选中一个 $G$ 细菌的概率是\n$$\np=\\frac{N_{G}}{N}, \\quad 1-p=\\frac{N_{R}}{N}.\n$$\n由于下一代是由 $N$ 次有放回的独立抽样形成的，因此第 1 代中 $G$ 等位基因的数量（记为 $X$）服从参数为 $N$ 和 $p$ 的二项分布。因此，对于任意 $k \\in \\{0,1,\\dots,N\\}$，有\n$$\n\\Pr(X=k)=\\binom{N}{k}p^{k}(1-p)^{N-k}.\n$$\n我们要求的是第 1 代拥有与第 0 代完全相同数量的 $G$ 等位基因的概率，即 $k=N_{G}$。代入 $N=10$、$N_{G}=3$ 和 $N_{R}=7$ 可得\n$$\n\\Pr(X=3)=\\binom{10}{3}\\left(\\frac{3}{10}\\right)^{3}\\left(\\frac{7}{10}\\right)^{7}.\n$$\n计算每个因子：\n$$\n\\binom{10}{3}=120,\\quad \\left(\\frac{3}{10}\\right)^{3}=\\frac{27}{1000}=0.027,\\quad \\left(\\frac{7}{10}\\right)^{7}=\\frac{7^{7}}{10^{7}}=\\frac{823543}{10000000}=0.0823543.\n$$\n因此\n$$\n\\Pr(X=3)=120 \\times 0.027 \\times 0.0823543=0.266827932.\n$$\n四舍五入到三位有效数字，得到\n$$\n0.267.\n$$", "answer": "$$\\boxed{0.267}$$", "id": "1415652"}, {"introduction": "在简单的随机性概念之上，本实践引入了明确的规则和空间互动，这是许多基于智能体的模型的标志。你将在一个网格上模拟一个经典的捕食者-猎物生态系统，根据一套既定规则，一丝不苟地追踪每个智能体的移动、能量和繁殖。这个练习强调了严谨的、按部就班的模拟的重要性，并展示了复杂的动态模式如何从简单的局部互动中涌现。[@problem_id:1415680]", "problem": "考虑一个在$3 \\times 3$网格上的简化的捕食者-猎物生态系统的基于智能体的模型 (ABM)。网格单元格由坐标 (行, 列) 标识，其中行和列的索引范围为 0 到 2。\n\n该网格包含三种类型的实体：捕食者 (X)、猎物 (P) 和特殊的‘避难所’单元格 (R)。\n\n**系统规则：**\n1.  **网格：** 一个$3 \\times 3$的网格。单元格 (1,1) 是一个指定的‘避难所’单元格。\n2.  **邻接与优先级：** 所有互动和移动都考虑8个相邻的单元格（包括对角线）。当一个智能体需要在多个有效的相邻单元格中进行选择时，它会遵循一个固定的优先级顺序：北、东北、东、东南、南、西南、西、西北。对于位于 $(r, c)$ 的单元格，这些方向分别对应 $(r-1, c)$、$(r-1, c+1)$、$(r, c+1)$、$(r+1, c+1)$、$(r+1, c)$、$(r+1, c-1)$、$(r, c-1)$ 和 $(r-1, c-1)$。\n3.  **时间步：** 模拟以离散时间步进行，从 $t=0$ 开始。每个时间步内的事件按以下特定顺序发生：(i) 捕食者阶段，(ii) 猎物阶段，(iii) 步骤结束阶段。\n\n**智能体规则：**\n\n**捕食者 (X)：**\n*   **能量：** 每个捕食者都有一个能量水平 $E$。\n*   **能量损失：** 在捕食者阶段开始时，每个捕食者损失4个能量单位。\n*   **移动与捕食：** 捕食者按优先级顺序扫描其相邻单元格。\n    *   如果它发现一个被猎物占据且*不是*避难所的单元格，它会移动到该单元格，吃掉猎物（该猎物从模拟中移除），并获得8个能量单位。该捕食者的回合随之结束。\n    *   如果相邻的猎物仅位于避难所单元格中，它无法捕食它们，并继续扫描其他选项。如果一个单元格是避难所，捕食者不能移动到这个被猎物占据的单元格上。\n    *   如果在相邻单元格中没有找到可捕食的猎物，捕食者会根据优先级顺序移动到第一个可用的*空*相邻单元格。\n*   **饿死：** 如果在时间步结束时，一个捕食者的能量 $E \\le 0$，它将从网格中移除。\n*   **繁殖：** 在此特定模型中，没有捕食者的繁殖规则。\n\n**猎物 (P)：**\n*   **年龄：** 每个猎物都有一个年龄计数器 $A$，初始值为0。\n*   **繁殖：** 在猎物阶段，如果猎物的年龄 $A \\ge 1$，它会进行繁殖。它会根据优先级顺序，在第一个可用的*空*相邻单元格中创建一个新的猎物（后代）。父代猎物的年龄重置为 $A=0$，新的后代以年龄 $A=0$ 开始。在其繁殖的时间步中，父代智能体不移动。\n*   **移动：** 如果猎物在一个时间步中没有繁殖，它会根据优先级顺序移动到第一个可用的*空*相邻单元格。\n*   **避难所豁免：** 位于避难所单元格中的猎物不能被捕食者吃掉。\n\n**步骤结束阶段：**\n*   网格上每个猎物智能体的年龄增加1。\n\n**初始状态 ($t=0$)：**\n*   一个捕食者位于 (1,2)，初始能量为 $E=10$。\n*   一个猎物位于 (0,1)，初始年龄为 $A=0$。\n*   第二个猎物位于 (2,1)，初始年龄为 $A=0$。\n\n从这个初始状态开始模拟该系统。在时间步 $t=2$ 结束时，网格上猎物智能体的总数是多少？", "solution": "我们在 $t=0$ 时标记：避难所在 $(1,1)$，一个能量为 $E=10$ 的捕食者在 $(1,2)$，以及两个年龄均为 $A=0$ 的猎物分别在 $(0,1)$ 和 $(2,1)$。8邻域的优先级顺序是：北 $(r-1,c)$，东北 $(r-1,c+1)$，东 $(r,c+1)$，东南 $(r+1,c+1)$，南 $(r+1,c)$，西南 $(r+1,c-1)$，西 $(r,c-1)$，西北 $(r-1,c-1)$，忽略越界的单元格。在每个时间步，我们执行：捕食者阶段（包括开始时减少4点能量以及捕食/移动），然后是猎物阶段（如果 $A \\ge 1$ 则繁殖，否则移动），最后是步骤结束阶段（将每个猎物的年龄增加1，并在时间步结束时检查捕食者是否饿死）。\n\n时间步 $t=0$。\n捕食者阶段：位于 $(1,2)$ 的捕食者损失4点能量，因此 $E=10-4=6$。它按顺序扫描：$(0,2)$（空），$(0,3)$（越界），$(1,3)$（越界），$(2,3)$（越界），$(2,2)$（空），$(2,1)$（猎物，非避难所），所以它移动到 $(2,1)$，吃掉那里的猎物，并获得8点能量，得到 $E=6+8=14$。位于 $(2,1)$ 的猎物被移除。\n猎物阶段：位于 $(0,1)$ 的剩余猎物年龄为 $A=0  1$，因此它不繁殖；它会按优先级顺序移动到第一个空的相邻单元格。从 $(0,1)$ 出发，有效的候选位置是 $(0,2)$、$(1,2)$、$(1,1)$、$(1,0)$、$(0,0)$；第一个是 $(0,2)$，该位置为空，所以它移动到 $(0,2)$。\n步骤结束：所有猎物的年龄增加1。位于 $(0,2)$ 的猎物年龄变为 $A=1$。捕食者的能量 $E=14 > 0$，所以它存活。\n\n$t=0$ 后的状态：一个捕食者在 $(2,1)$，能量 $E=14$；一个猎物在 $(0,2)$，年龄 $A=1$。\n\n时间步 $t=1$。\n捕食者阶段：位于 $(2,1)$ 的捕食者损失4点能量，因此 $E=14-4=10$。它扫描：$(1,1)$（避难所，空），$(1,2)$（空），$(2,2)$（空），其他位置越界或为空；没有相邻的猎物，所以它移动到第一个空的相邻单元格，即 $(1,1)$。能量保持为 $E=10$。\n猎物阶段：位于 $(0,2)$ 的猎物年龄为 $A=1 \\ge 1$，所以它在第一个空的相邻单元格中繁殖。从 $(0,2)$ 出发，按顺序的有效候选位置是 $(1,2)$、$(1,1)$、$(0,1)$。$(1,2)$ 为空，所以在 $(1,2)$ 放置一个年龄为 $A=0$ 的后代；父代留在 $(0,2)$ 并将年龄重置为 $A=0$。\n步骤结束：增加年龄：位于 $(0,2)$ 的父代年龄变为 $A=1$，位于 $(1,2)$ 的后代年龄变为 $A=1$。捕食者的能量 $E=10 > 0$。\n\n$t=1$ 后的状态：一个捕食者在 $(1,1)$，能量 $E=10$；两个猎物：一个在 $(0,2)$，年龄 $A=1$，另一个在 $(1,2)$，年龄 $A=1$。\n\n时间步 $t=2$。\n捕食者阶段：位于 $(1,1)$ 的捕食者损失4点能量，因此 $E=10-4=6$。它扫描：$(0,1)$（空），$(0,2)$（猎物，非避难所），所以它移动到 $(0,2)$，吃掉那个猎物，并获得8点能量，使 $E=6+8=14$。位于 $(0,2)$ 的猎物被移除；位于 $(1,2)$ 的猎物仍然存在。\n猎物阶段：位于 $(1,2)$ 的剩余猎物年龄为 $A=1 \\ge 1$ 并进行繁殖。从 $(1,2)$ 出发，按顺序的有效相邻单元格是 $(0,2)$、$(2,2)$、$(2,1)$、$(1,1)$、$(0,1)$。$(0,2)$ 被捕食者占据，所以跳过；$(2,2)$ 为空，所以在 $(2,2)$ 创建一个年龄为 $A=0$ 的后代，并将位于 $(1,2)$ 的父代年龄重置为 $A=0$ 且不移动。\n步骤结束：所有猎物的年龄增加1：位于 $(1,2)$ 的父代年龄变为 $A=1$，位于 $(2,2)$ 的后代年龄变为 $A=1$。捕食者的能量 $E=14 > 0$。\n\n在时间步 $t=2$ 结束时，网格上正好有2个猎物智能体。", "answer": "$$\\boxed{2}$$", "id": "1415680"}, {"introduction": "虽然许多基于主体的模型需要通过计算机模拟来研究，但有些模型可以得出简洁的解析解，从而揭示对系统行为的深刻见解。这个问题将挑战你将控制单个智能体生命周期的微观层面规则——其年龄、死亡和分裂——与一个宏观层面的涌现属性联系起来：即种群的长期增长率 $\\lambda$。通过推导这个增长因子的封闭形式表达式，你将发现智能体规则与其产生的可预测的系统层面动力学之间的强大联系。[@problem_id:1415649]", "problem": "考虑一个用于模拟生物反应器中合成微生物种群动态的基于智能体的模型（Agent-Based Model, ABM）。每个智能体的状态由其内部年龄计数器 $a$ 定义，它是一个非负整数，表示自其创建以来所经过的时间步数。模拟以离散时间步进行。\n\n在每个时间步开始时，每个年龄为 $a$ 的智能体都会经历以下三个互斥事件之一：\n1.  **死亡**：智能体死亡并从模拟中移除。此事件发生的概率为 $P_{\\text{death}}(a)$。\n2.  **分裂**：智能体被移除，并被两个年龄均为 $a=0$ 的新子代智能体替代。此事件发生的概率为 $P_{\\text{div}}(a)$。\n3.  **存活**：智能体存活到下一个时间步，届时其年龄将变为 $a+1$。此事件发生的概率为 $P_{\\text{surv}}(a) = 1 - P_{\\text{death}}(a) - P_{\\text{div}}(a)$。\n\n对于此特定模型，事件概率定义如下：\n- 由于存在基础代谢负荷，死亡概率对所有年龄都是恒定的：$P_{\\text{death}}(a) = \\delta$。\n- 分裂是一种工程化行为，仅在特定成熟年龄 $A$（一个正整数）时触发。在此年龄的分裂概率为 $p_{div}$。对于所有其他年龄，分裂概率为零。形式上，$P_{\\text{div}}(a) = p_{div}$ 当 $a=A$ 时，且 $P_{\\text{div}}(a)=0$ 当 $a \\neq A$ 时。\n\n参数 $\\delta$ 和 $p_{div}$ 是正常数，且它们的和小于一：$\\delta + p_{div}  1$。\n\n模拟运行很长时间后，种群会进入稳态指数增长状态，其中时间 $t$ 的智能体总数 $N(t)$ 在每个时间步都增长一个恒定因子 $\\lambda$，即 $N(t+1) = \\lambda N(t)$。这意味着种群已达到稳定的年龄分布。\n\n您的任务是确定长期种群增长因子 $\\lambda$。请用一个关于参数 $A$、$p_{div}$ 和 $\\delta$ 的单闭式解析表达式来表示您的答案。", "solution": "设 $N_a(t)$ 为在时间步 $t$ 时年龄为 $a$ 的智能体数量。总种群数为 $N(t) = \\sum_{a=0}^{\\infty} N_a(t)$。\n问题陈述，经过很长时间后，种群达到稳定年龄分布，并以因子 $\\lambda$ 进行指数增长。这意味着任何特定年龄 $a$ 的智能体数量在每个时间步也以相同的因子增长，即 $N_a(t+1) = \\lambda N_a(t)$。\n这使我们能够将时间 $t$ 时年龄为 $a$ 的智能体数量表示为 $N_a(t) = k_a \\lambda^t$，其中 $k_a$ 代表在稳定增长的种群中年龄为 $a$ 的智能体的恒定比例。\n\n种群的动态可以用一组差分方程来描述。在时间 $t+1$ 时年龄为 $a$ 的智能体，必定是时间 $t$ 时年龄为 $a-1$ 且存活下来未分裂的智能体。在时间 $t+1$ 时年龄为 $a$（对于 $a \\ge 1$）的智能体数量由以下公式给出：\n$$N_a(t+1) = N_{a-1}(t) \\times P_{\\text{surv}}(a-1)$$\n代入 $N_a(t) = k_a \\lambda^t$，我们得到：\n$$k_a \\lambda^{t+1} = k_{a-1} \\lambda^t \\times P_{\\text{surv}}(a-1)$$\n两边同除以 $\\lambda^t$，我们得到关于系数 $k_a$ 的递推关系：\n$$\\lambda k_a = k_{a-1} P_{\\text{surv}}(a-1) \\implies k_a = \\frac{k_{a-1}}{\\lambda} P_{\\text{surv}}(a-1)$$\n我们可以通过用 $k_0$ 表示 $k_a$ 来求解此递推关系：\n$$k_a = k_0 \\lambda^{-a} \\prod_{i=0}^{a-1} P_{\\text{surv}}(i)$$\n\n现在我们必须考虑概率的具体形式。\n$P_{\\text{death}}(a) = \\delta$\n当 $a=A$ 时，$P_{\\text{div}}(a) = p_{div}$，否则为 $0$。\n因此，存活概率 $P_{\\text{surv}}(a) = 1 - P_{\\text{death}}(a) - P_{\\text{div}}(a)$ 为：\n- 当 $a \\neq A$ 时，$P_{\\text{surv}}(a) = 1 - \\delta$。\n- $P_{\\text{surv}}(A) = 1 - \\delta - p_{div}$。\n\n我们需要计算乘积 $\\prod_{i=0}^{A-1} P_{\\text{surv}}(i)$ 以求得 $k_A$。由于 $A$ 是一个正整数，此乘积中的索引 $i$ 的范围是从 $0$ 到 $A-1$。在此范围内，$i \\neq A$，因此乘积中的所有项 $P_{\\text{surv}}(i) = 1 - \\delta$。\n$$\\prod_{i=0}^{A-1} P_{\\text{surv}}(i) = \\prod_{i=0}^{A-1} (1 - \\delta) = (1 - \\delta)^A$$\n现在我们可以写出 $k_A$ 的表达式：\n$$k_A = k_0 \\lambda^{-A} (1-\\delta)^A$$\n\n接下来，我们建立新智能体（年龄为0）生成的方程。新智能体是通过现有智能体的分裂产生的。一个年龄为 $a$ 的智能体在分裂时会产生两个年龄为 0 的新智能体。在时间 $t+1$ 时的新智能体数量是时间 $t$ 时所有年龄组产生的后代总和：\n$$N_0(t+1) = \\sum_{a=0}^{\\infty} 2 \\times N_a(t) \\times P_{\\text{div}}(a)$$\n由于 $P_{\\text{div}}(a)$ 仅在 $a=A$ 时非零，该求和可以简化为单项：\n$$N_0(t+1) = 2 \\times N_A(t) \\times P_{\\text{div}}(A) = 2 N_A(t) p_{div}$$\n代入稳定增长形式 $N_a(t) = k_a \\lambda^t$：\n$$k_0 \\lambda^{t+1} = 2 (k_A \\lambda^t) p_{div}$$\n两边同除以 $\\lambda^t$ 得到在稳态增长下关联不同年龄组的特征方程：\n$$\\lambda k_0 = 2 k_A p_{div}$$\n这个方程也被称为该系统的欧拉-洛特卡方程（Euler-Lotka equation）。它表明，经增长率调整后的新智能体数量是由繁殖智能体的数量及其繁殖能力决定的。\n\n为了求解 $\\lambda$，我们将 $k_A$ 关于 $k_0$ 的表达式代入此特征方程：\n$$\\lambda k_0 = 2 \\left( k_0 \\lambda^{-A} (1-\\delta)^A \\right) p_{div}$$\n由于对于一个未灭绝的种群，$k_0$ 必须为非零，我们可以将等式两边同除以 $k_0$：\n$$\\lambda = 2 p_{div} \\lambda^{-A} (1-\\delta)^A$$\n现在，我们求解 $\\lambda$。将等式两边同乘以 $\\lambda^A$：\n$$\\lambda \\cdot \\lambda^A = 2 p_{div} (1-\\delta)^A$$\n$$\\lambda^{A+1} = 2 p_{div} (1-\\delta)^A$$\n最后，对等式两边取 $(A+1)$ 次方根，得到长期增长因子 $\\lambda$ 的表达式：\n$$\\lambda = \\left[ 2 p_{div} (1-\\delta)^A \\right]^{\\frac{1}{A+1}}$$", "answer": "$$\\boxed{\\left(2 p_{div} (1-\\delta)^{A}\\right)^{\\frac{1}{A+1}}}$$", "id": "1415649"}]}