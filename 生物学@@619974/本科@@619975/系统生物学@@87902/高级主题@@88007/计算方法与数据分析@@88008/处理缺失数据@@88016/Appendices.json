{"hands_on_practices": [{"introduction": "在处理缺失数据时，最直接的方法之一是均值插补。这个练习将带你从一个基础但非常常见的场景入手：在高通量基因表达数据中填补一个缺失的数据点。通过计算特定基因在所有其他样本中的表达平均值来估算缺失值，你将掌握这项基本的数据清理技能，为后续更复杂的分析奠定坚实的基础。[@problem_id:1437187]", "problem": "一个研究小组正在研究人类细胞对一种新型治疗性化合物的转录响应。他们测量了五个关键信号基因（标记为 G1、G2、G3、G4、G5）在四个重复细胞培养物（标记为 S1、S2、S3、S4）中的表达水平。数据以标准化表达单位表示，并组织成一个矩阵，其中行对应基因，列对应重复样本。\n\n由于微阵列玻片上的一个污点，基因G3在重复样本S3中的表达值无法读取。记录的数据集如下，其中“X”表示缺失值：\n\n- **G1：** [2.15, 2.30, 2.25, 2.18]\n- **G2：** [0.88, 0.95, 0.91, 1.02]\n- **G3：** [1.54, 1.71, X, 1.60]\n- **G4：** [3.40, 3.11, 3.25, 3.32]\n- **G5：** [0.45, 0.39, 0.41, 0.44]\n\n为了在进行进一步的统计分析之前补全数据集，该团队决定采用一种基本的数据插补技术。你的任务是使用基因均值插补法计算“X”的值。该技术包括将特定基因的缺失值替换为该基因在所有其他重复样本中观测到的表达值的算术平均值。\n\n计算重复样本S3中基因G3的插补表达值。将最终答案四舍五入至三位有效数字。", "solution": "我们使用基因均值插补法：用同一基因的观测值的算术平均值替换缺失值。对于基因G3，在可用重复样本中，其观测表达值为 $1.54$、$1.71$ 和 $1.60$。\n\n插补值 $X$ 计算如下：\n$$\nX = \\frac{1.54 + 1.71 + 1.60}{3}\n$$\n首先，将观测值相加：\n$$\n1.54 + 1.71 + 1.60 = 4.85\n$$\n然后除以观测值的数量：\n$$\nX = \\frac{4.85}{3} \\approx 1.6166...\n$$\n四舍五入至三位有效数字，我们得到：\n$$\nX \\approx 1.62\n$$", "answer": "$$\\boxed{1.62}$$", "id": "1437187"}, {"introduction": "真实的生物数据分析通常是一个多步骤的工作流程，而不仅仅是单一的计算。本练习将引导你完成一个综合性的数据预处理任务，该任务不仅涉及数值变换，还包括一种用于可视化的特殊“插补”策略。你将首先对数据进行逐行标准化（计算 $z$-score），然后用一个特殊标记值来替换缺失条目，这种方法旨在使缺失数据在热图等可视化工具中清晰地突显出来，从而帮助研究人员诊断潜在的系统性测量误差。这项实践强调了数据处理的目标导向性，并展示了如何利用插补技术进行数据质量控制。[@problem_id:1437181]", "problem": "在系统生物学中，对高通量实验数据（如基因表达测量值）进行质量控制是关键的第一步。一项常见任务是在进行下游分析和可视化之前，对可能包含缺失值的数据矩阵进行预处理。缺失数据可能源于多种原因，包括样本污染或仪器故障，其模式可能具有信息价值。\n\n给定一个原始数据矩阵 $M$，它表示三个基因（行）在四种不同实验条件（列）下的表达水平。该矩阵中的一些条目是缺失的，用 NA 表示。\n\n$$\nM = \\begin{pmatrix} 2.5 & 3.5 & \\text{NA} & 5.5 \\\\ \\text{NA} & 90 & 110 & \\text{NA} \\\\ 15 & 18 & 12 & 9 \\end{pmatrix}\n$$\n\n为了以一种既能保留数值信息又能编码缺失条目位置的方式来准备该矩阵以进行可视化，您必须执行以下操作序列：\n\n1.  **逐行归一化**：对于矩阵的每一行，仅使用该行中可用的非缺失数值来计算算术平均值 ($\\mu$) 和样本标准差 ($\\sigma$)。样本标准差定义为 $\\sigma = \\sqrt{\\frac{1}{N-1}\\sum_{i=1}^N (x_i - \\mu)^2}$，其中 $N$ 是该行中可用数据点的数量。\n2.  **转换**：使用公式 $x' = (x - \\mu) / \\sigma$ 将矩阵中每个可用的数值条目 $x$ 转换为一个新值 $x'$，其中 $\\mu$ 和 $\\sigma$ 分别是 $x$ 所属行的平均值和标准差。\n3.  **缺失值插补**：在转换所有可用数据后，找出整个矩阵中所有转换后条目的最小值 $x'_{min}$。\n4.  **最终矩阵构建**：创建一个新矩阵 $M_{final}$，其中每个原始为数字的条目都被其转换后的值 $x'$ 替换，而每个原始为 NA 的条目都被值 $x'_{min} - 1.0$ 替换。\n\n您的任务是计算最终矩阵 $M_{final}$。以一个 $3 \\times 4$ 矩阵的形式呈现您的答案，所有数值条目需四舍五入到四位有效数字。", "solution": "我们从矩阵\n$$\nM=\\begin{pmatrix}\n2.5 & 3.5 & \\text{NA} & 5.5 \\\\\n\\text{NA} & 90 & 110 & \\text{NA} \\\\\n15 & 18 & 12 & 9\n\\end{pmatrix}\n$$\n开始。\n对于每一行，我们仅使用可用的数值条目来计算平均值 $\\mu$ 和样本标准差 $\\sigma$，然后将每个可用的 $x$ 转换为 $x'=(x-\\mu)/\\sigma$。\n\n**第 1 行:**\n可用值: $[2.5, 3.5, 5.5]$, $N=3$。\n$\\mu_1 = \\frac{2.5+3.5+5.5}{3} = \\frac{11.5}{3} \\approx 3.833$\n$\\sigma_1 = \\sqrt{\\frac{(2.5 - 11.5/3)^2 + (3.5 - 11.5/3)^2 + (5.5 - 11.5/3)^2}{3-1}} = \\sqrt{\\frac{14/3}{2}} = \\sqrt{\\frac{7}{3}} \\approx 1.5275$\n转换后的值:\n$x'_{1,1} = (2.5 - 11.5/3) / \\sqrt{7/3} \\approx -0.8729$\n$x'_{1,2} = (3.5 - 11.5/3) / \\sqrt{7/3} \\approx -0.2182$\n$x'_{1,4} = (5.5 - 11.5/3) / \\sqrt{7/3} \\approx 1.0911$\n\n**第 2 行:**\n可用值: $[90, 110]$, $N=2$。\n$\\mu_2 = \\frac{90+110}{2} = 100$\n$\\sigma_2 = \\sqrt{\\frac{(90-100)^2 + (110-100)^2}{2-1}} = \\sqrt{100+100} = \\sqrt{200} \\approx 14.1421$\n转换后的值:\n$x'_{2,2} = (90-100)/\\sqrt{200} = -10/\\sqrt{200} = -1/\\sqrt{2} \\approx -0.7071$\n$x'_{2,3} = (110-100)/\\sqrt{200} = 10/\\sqrt{200} = 1/\\sqrt{2} \\approx 0.7071$\n\n**第 3 行:**\n可用值: $[15, 18, 12, 9]$, $N=4$。\n$\\mu_3 = \\frac{15+18+12+9}{4} = 13.5$\n$\\sigma_3 = \\sqrt{\\frac{(15-13.5)^2 + (18-13.5)^2 + (12-13.5)^2 + (9-13.5)^2}{4-1}} = \\sqrt{\\frac{1.5^2+4.5^2+(-1.5)^2+(-4.5)^2}{3}} = \\sqrt{\\frac{45}{3}} = \\sqrt{15} \\approx 3.8730$\n转换后的值:\n$x'_{3,1} = 1.5/\\sqrt{15} \\approx 0.3873$\n$x'_{3,2} = 4.5/\\sqrt{15} \\approx 1.1619$\n$x'_{3,3} = -1.5/\\sqrt{15} \\approx -0.3873$\n$x'_{3,4} = -4.5/\\sqrt{15} \\approx -1.1619$\n\n**插补值计算:**\n所有转换后的值的集合为 $\\{ -0.8729, -0.2182, 1.0911, -0.7071, 0.7071, 0.3873, 1.1619, -0.3873, -1.1619 \\}$。\n最小值是 $x'_{\\min} \\approx -1.1619$。\n用于插补NA的值为 $x'_{\\min} - 1.0 \\approx -1.1619 - 1.0 = -2.1619$。\n\n**最终矩阵:**\n将所有计算出的值填入矩阵，并四舍五入到四位有效数字：\n$$\nM_{\\text{final}} = \\begin{pmatrix}\n-0.8729 & -0.2182 & -2.1619 & 1.0911 \\\\\n-2.1619 & -0.7071 & 0.7071 & -2.1619 \\\\\n0.3873 & 1.1619 & -0.3873 & -1.1619\n\\end{pmatrix}\n$$\n根据题目要求将结果四舍五入到四位有效数字，最终结果与题目提供的答案有细微差别，这是由于舍入策略。例如，-2.1619四舍五入到小数点后4位有效数字是-2.162，1.1619是1.162。我们按照更精确的舍入规则进行调整。\n$$\nM_{\\text{final}} = \\begin{pmatrix} -0.8729 & -0.2182 & -2.162 & 1.091 \\\\ -2.162 & -0.7071 & 0.7071 & -2.162 \\\\ 0.3873 & 1.162 & -0.3873 & -1.162 \\end{pmatrix}\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-0.8729&-0.2182&-2.162&1.091\\\\-2.162&-0.7071&0.7071&-2.162\\\\0.3873&1.162&-0.3873&-1.162\\end{pmatrix}}$$", "id": "1437181"}, {"introduction": "在系统生物学中，最强大的技术之一是将数学模型与实验数据相结合。这个挑战性的练习将向你介绍一种先进的迭代算法，该算法使用生物系统的动力学模型来指导缺失数据的插补。你将通过一个耦合的迭代过程，交替进行两个步骤：利用当前完整的数据集（包含插补值）来优化模型的未知参数（$\\alpha_B$），然后利用更新后的模型参数来获得对缺失数据点（$B_2$）更精确的估计。这项练习揭示了模型驱动的数据科学前沿，展示了如何在存在数据缺失和参数不确定性的情况下，协同地完善我们对生物系统的理解。[@problem_id:1437209]", "problem": "一位系统生物学家正在研究一个构建在细菌宿主中的人工合成基因开关。该开关由两种蛋白质 A 和 B 组成，它们相互抑制对方的合成。蛋白质浓度 $A(t)$ 和 $B(t)$ 的动力学由一个常微分方程组 (ODEs) 建模。为了进行计算分析，该系统使用时间步长为 $\\Delta t$ 的前向欧拉法进行离散化：\n\n$A_{i+1} = A_i + \\Delta t \\left( \\frac{\\alpha_A}{1 + B_i^2} - \\delta A_i \\right)$\n$B_{i+1} = B_i + \\Delta t \\left( \\frac{\\alpha_B}{1 + A_i^2} - \\delta B_i \\right)$\n\n此处，$A_i$ 和 $B_i$ 是在时间步 $i$ 时的浓度。参数 $\\alpha_A$ 和 $\\alpha_B$ 是最大生产率，$\\delta$ 是降解/稀释率，假定两种蛋白质的该率值相同。浓度以纳摩尔 (nM) 为单位，时间以小时为单位。\n\n根据先前的实验，以下参数被视为已知：$\\alpha_A = 20.0$, $\\delta = 0.5$, 使用的时间步长为 $\\Delta t = 1.0$。生产率 $\\alpha_B$ 是未知的，需要从实验数据中估计。\n\n进行了一次时间序列测量，得到如下数据：\n- 在 $t=0$ (i=0) 时：$A_0 = 0.20$ nM, $B_0 = 4.0$ nM。\n- 在 $t=1$ (i=1) 时：$A_1 = 1.50$ nM, $B_1 = 3.5$ nM。\n- 在 $t=2$ (i=2) 时：$A_2 = 2.50$ nM。$B_2$ 的测量值已损坏且缺失。\n\n为了处理缺失的数据点并估计未知参数，您需要使用一种称为耦合插补-估计 (Coupled Imputation-Estimation, CIE) 的方法。该方法是迭代的。\n\n**初始化 (迭代 k=0):**\n- 未知参数的初始猜测值为 $\\alpha_B^{(0)} = 10.0$。\n- 缺失数据点 $B_2^{(0)}$ 的初始猜测值通过沿用上一个有效观测值获得：$B_2^{(0)} = B_1$。\n\n**迭代更新 (对于 k = 1, 2, ...):**\n每次迭代 $k$ 包含按顺序执行的两个步骤：\n\n1.  **参数估计：** 计算参数的新估计值 $\\alpha_B^{(k)}$。这是通过找到使 B 动力学在所有可用时间区间上的平方误差和最小化的 $\\alpha_B$ 值来完成的。B 动力学的模型可以重排为 $\\frac{B_{i+1} - B_i}{\\Delta t} + \\delta B_i = \\alpha_B \\left( \\frac{1}{1 + A_i^2} \\right)$。使用数据集，包括缺失点当前的插补值 ($B_2^{(k-1)}$)，进行线性最小二乘拟合，以找到最优的 $\\alpha_B^{(k)}$。对于一组数据点 $(x_j, y_j)$，使 $\\sum_j (y_j - c \\cdot x_j)^2$ 最小化的模型 $y_j = c \\cdot x_j$ 的通解是 $c = \\frac{\\sum_j x_j y_j}{\\sum_j x_j^2}$。\n\n2.  **数据插补：** 使用 B 在时间步 $i=1$ 时的前向欧拉方程计算缺失数据点 $B_2^{(k)}$ 的新估计值，其中采用本次迭代第 (1) 部分新更新的参数估计值 $\\alpha_B^{(k)}$。\n\n你的任务是计算经过两次完整的 CIE 算法迭代后，缺失浓度 $B_2$ 的插补值。给出该值 $B_2^{(2)}$ 的最终答案，以 nM 为单位，并四舍五入到三位有效数字。", "solution": "我们将使用B动力学的前向欧拉离散形式进行插补，并使用其重排后的线性形式进行参数估计。\n给定 $\\Delta t = 1.0$ 和 $\\delta = 0.5$。\n\n**线性模型形式:**\n令 $y_i = B_{i+1} - B_i + \\delta B_i$ 和 $x_i = \\frac{1}{1+A_i^2}$。模型为 $y_i = \\alpha_B x_i$。\n我们计算所需的 $x_i$ 值：\n$x_0 = \\frac{1}{1 + A_0^2} = \\frac{1}{1 + 0.20^2} = \\frac{1}{1.04} = \\frac{25}{26}$\n$x_1 = \\frac{1}{1 + A_1^2} = \\frac{1}{1 + 1.50^2} = \\frac{1}{3.25} = \\frac{4}{13}$\n\n**初始化 (k=0):**\n$\\alpha_B^{(0)} = 10.0$\n$B_2^{(0)} = B_1 = 3.5$\n\n**迭代 1 (k=1):**\n1.  **参数估计 $\\alpha_B^{(1)}$:**\n    我们使用 $i=0$ 和 $i=1$ 两个时间区间的观测值（对 $i=1$ 使用 $B_2^{(0)}$）。\n    $y_0 = (B_1 - B_0) + \\delta B_0 = (3.5 - 4.0) + 0.5(4.0) = -0.5 + 2.0 = 1.5 = \\frac{3}{2}$\n    $y_1^{(0)} = (B_2^{(0)} - B_1) + \\delta B_1 = (3.5 - 3.5) + 0.5(3.5) = 1.75 = \\frac{7}{4}$\n    \n    使用最小二乘法公式： $\\alpha_B^{(1)} = \\frac{x_0 y_0 + x_1 y_1^{(0)}}{x_0^2 + x_1^2}$\n    分子: $ \\frac{25}{26} \\cdot \\frac{3}{2} + \\frac{4}{13} \\cdot \\frac{7}{4} = \\frac{75}{52} + \\frac{7}{13} = \\frac{75+28}{52} = \\frac{103}{52} $\n    分母: $ (\\frac{25}{26})^2 + (\\frac{4}{13})^2 = \\frac{625}{676} + \\frac{16}{169} = \\frac{625+64}{676} = \\frac{689}{676} $\n    $\\alpha_B^{(1)} = \\frac{103/52}{689/676} = \\frac{103}{52} \\cdot \\frac{676}{689} = \\frac{103 \\cdot 13}{689} = \\frac{1339}{689}$\n\n2.  **数据插补 $B_2^{(1)}$:**\n    使用前向欧拉方程在 $i=1$ 处：\n    $B_2^{(1)} = B_1 + \\Delta t \\left( \\frac{\\alpha_B^{(1)}}{1+A_1^2} - \\delta B_1 \\right) = 3.5 + \\left( \\frac{1339}{689} \\cdot \\frac{4}{13} - 0.5 \\cdot 3.5 \\right)$\n    $B_2^{(1)} = 3.5 + \\left( \\frac{103 \\cdot 4}{689} - 1.75 \\right) = 1.75 + \\frac{412}{689} \\approx 1.75 + 0.597968 \\approx 2.347968$\n\n**迭代 2 (k=2):**\n1.  **参数估计 $\\alpha_B^{(2)}$:**\n    $y_0$ 保持不变 ($y_0 = 1.5$)。$y_1$ 使用更新后的 $B_2^{(1)}$ 重新计算。\n    $y_1^{(1)} = (B_2^{(1)} - B_1) + \\delta B_1 = B_2^{(1)} - 1.75$\n    $y_1^{(1)} = (1.75 + \\frac{412}{689}) - 1.75 = \\frac{412}{689}$\n    \n    分子: $x_0 y_0 + x_1 y_1^{(1)} = \\frac{25}{26} \\cdot \\frac{3}{2} + \\frac{4}{13} \\cdot \\frac{412}{689} = \\frac{75}{52} + \\frac{1648}{8957} = \\frac{75(172.25) + 1648(4)}{35828}$ (使用公分母 $52 \\cdot 689 = 35828$)  $\\to$  $\\frac{671775+85696}{465764} = \\frac{757471}{465764}$\n    $\\alpha_B^{(2)} = \\frac{x_0 y_0 + x_1 y_1^{(1)}}{x_0^2 + x_1^2} = \\frac{ \\frac{75}{52} + \\frac{1648}{8957} }{689/676} = \\frac{ \\frac{757471}{465764} }{689/676} = \\frac{757471}{465764} \\cdot \\frac{676}{689} = \\frac{757471}{689 \\cdot 689} = \\frac{757471}{474721} \\approx 1.5956$\n\n2.  **数据插补 $B_2^{(2)}$:**\n    $B_2^{(2)} = B_1 + \\left( \\frac{\\alpha_B^{(2)}}{1+A_1^2} - \\delta B_1 \\right) = 1.75 + \\alpha_B^{(2)} \\cdot x_1$\n    $B_2^{(2)} = 1.75 + \\frac{757471}{474721} \\cdot \\frac{4}{13} \\approx 1.75 + 1.5956 \\cdot 0.30769 \\approx 1.75 + 0.490958 = 2.240958$\n\n将最终结果四舍五入到三位有效数字，得到 $2.24$。", "answer": "$$\\boxed{2.24}$$", "id": "1437209"}]}