{"hands_on_practices": [{"introduction": "在开始任何复杂的统计分析之前，首先对高通量数据进行“鸟瞰式”的全局审视至关重要。本练习将介绍主成分分析（Principal Component Analysis, PCA）作为一种强大的质量控制工具，帮助您直观地识别异常样本，从而在寻找生物学信号之前确保数据集的可靠性。这个步骤是保障后续所有分析有效性的关键第一步 [@problem_id:1440854]。", "problem": "一个研究团队正在研究癌组织和健康组织之间的分子差异。他们从一组患者中收集了10个肿瘤样本和10个相应的邻近健康组织样本。为了分析基因活性，他们对所有20个样本进行了核糖核酸（RNA）测序实验。该实验的原始输出是一个“计数矩阵”，其中每一行对应一个特定基因，每一列对应20个生物样本中的一个。矩阵中每个单元格的值是一个整数，代表在该样本中比对到该基因的测序读数（reads）的数量。\n\n生成计数矩阵后，首席生物信息学家担心，由于文库制备阶段存在可疑的技术误差，其中一个健康组织样本可能是异常样本。这可能意味着其整体基因表达谱与所有其他样本都截然不同。该团队的最终目标是进行统计分析，以识别在肿瘤组和健康组之间存在差异表达的基因。\n\n在进行任何统计比较或数据标准化之前，基于样本的整体表达谱与其他样本的关系，以下哪项质量控制（QC）程序是用于直观识别潜在异常*样本*的最合适的*初始*步骤？\n\nA. 对计数矩阵应用一种标准化方法，例如M值的修剪均值（Trimmed Mean of M-values, TMM），以调整样本间测序深度的差异。\n\nB. 使用一种降维技术，例如主成分分析（Principal Component Analysis, PCA），将样本绘制在二维空间中，并目视检查远离主要集群的样本。\n\nC. 对每个基因进行t检验，以确定在肿瘤组和健康组之间存在显著差异的基因的初步列表。\n\nD. 对每个基因，计算其在所有20个样本中的平均表达值和方差，然后过滤掉低方差的基因。\n\nE. 生成一个火山图，该图描绘了每个基因的统计显著性（p值）与变化幅度（倍数变化）的关系。", "solution": "题目要求我们在进行任何标准化或统计检验之前，选择最合适的初始QC步骤，以便根据整体表达谱关系直观地识别潜在的异常样本。\n\n其目标是以无监督的方式评估样本间的关系，以检测是否存在某个样本与其他样本在全局上不相似。为此，RNA-seq QC中的标准方法是使用无监督降维方法来可视化样本间的距离。主成分分析（PCA）被广泛用于将高维基因表达谱投影到低维空间（通常是前两个主成分），以便能够直观地检查聚类和异常值。因此，通过PCA绘制样本图直接满足了识别远离主要集群的样本的要求。\n\n根据此目标评估每个选项：\n- 选项A（TMM标准化）是一个标准化步骤，而不是一种可视化方法，并且题目明确地将该操作框定为在标准化和差异检验之前的QC可视化步骤。虽然标准化对下游分析和改进PCA很重要，但它本身并不是一个用于检测异常值的可视化QC步骤。\n- 选项B（PCA）是一种无监督的、全局的、可视化的QC方法，通过检查样本在主成分空间中与主要集群的距离，它非常适合用于检测异常样本。\n- 选项C（对每个基因进行t检验）是一种有监督的差异表达分析，而不是初始QC步骤，并且在QC之前不当地进行了统计检验。\n- 选项D（过滤低方差基因）是一个特征选择步骤，可能可以改善某些分析的信号，但它不是一种可视化或识别异常样本的方法，并且不应在初始QC之前执行。\n- 选项E（火山图）需要统计检验结果，而不是针对样本级异常值的初始QC可视化方法。\n\n因此，基于整体表达谱关系来直观识别潜在异常样本的最合适的初始QC程序是PCA。\n\n因此，正确选项是B。", "answer": "$$\\boxed{B}$$", "id": "1440854"}, {"introduction": "一旦确认了数据的质量，下一步就是量化不同实验条件之间基因表达的变化。本练习将指导您完成 $log_{2}$ 倍数变化（$log_2$ Fold Change）这一基本计算，它是生物信息学中衡量表达差异幅度的标准指标。通过这个练习，您还将接触到在处理计数数据时为了避免计算错误而引入的“伪计数”（pseudocount）这一重要概念 [@problem_id:1440835]。", "problem": "一个分子生物学家团队正在研究一种癌细胞系对一种新型治疗剂 `Compound-Z` 的转录响应。他们进行了一项RNA测序实验来测量基因表达水平。该实验包括对照组（用载体溶液处理的细胞）的三个生物学重复和处理组（暴露于 `Compound-Z` 的细胞）的三个生物学重复。对于一个特定的目标基因 `TFG-1`，其原始表达计数记录如下：\n\n-   **对照组计数：** 38, 51, 44\n-   **处理组计数：** 285, 330, 297\n\n在生物信息学分析中，为了防止出现除以零的问题并稳定低计数基因的倍数变化（fold-change）估计的方差，通常会在进行后续计算之前，向每个原始计数值中添加一个称为“伪计数”（pseudocount）的小常数。对于本问题，您需要使用1作为伪计数值。\n\n计算 `TFG-1` 基因表达的log2倍数变化。其定义为：在对所有原始测量值应用伪计数后，处理组平均表达量与对照组平均表达量之比的以2为底的对数。将您的最终答案四舍五入到三位有效数字。", "solution": "我们已知对照组计数为 $38,51,44$，处理组计数为 $285,330,297$。将伪计数 $p=1$ 加到每个原始测量值上。\n\n计算经伪计数调整后的组均值：\n$$\\bar{C}=\\frac{(38+1)+(51+1)+(44+1)}{3}=\\frac{39+52+45}{3}=\\frac{136}{3},$$\n$$\\bar{T}=\\frac{(285+1)+(330+1)+(297+1)}{3}=\\frac{286+331+298}{3}=\\frac{915}{3}=305.$$\n\n倍数变化是处理组均值与对照组均值之比：\n$$\\mathrm{FC}=\\frac{\\bar{T}}{\\bar{C}}=\\frac{305}{136/3}=\\frac{915}{136}.$$\n\nlog2倍数变化为\n$$\\log_{2}(\\mathrm{FC})=\\log_{2}\\!\\left(\\frac{915}{136}\\right)=\\frac{\\ln\\!\\left(\\frac{915}{136}\\right)}{\\ln 2}\\approx 2.750165\\ldots$$\n\n四舍五入到三位有效数字，得到 $2.75$。", "answer": "$$\\boxed{2.75}$$", "id": "1440835"}, {"introduction": "基因表达的巨大变化并不总是意味着它具有生物学意义。最后的这个练习将探讨一个常见的挑战：如何通过理解效应大小（effect size，如此处的倍数变化）和统计置信度（$p$-value）之间的关系，来区分真实的生物学信号与随机噪声。它解释了为何样本组内部的高度变异性，可能导致一个变化很大但统计上并不显著的结果 [@problem_id:1440845]。", "problem": "一位初级生物信息学家正在分析一项核糖核酸 (RNA) 测序实验的数据，该实验旨在鉴定受一种新抗癌药物影响的基因。该实验比较了用药处理的癌细胞系与未经处理的对照组的基因表达水平，每种条件都有多个生物学重复。\n\n对数千个被测基因的分析得出了两个关键指标：\n1.  **Log2(倍数变化):** 衡量表达变化幅度的指标。数值为+2意味着该基因在处理组中的表达量是 $2^2=4$ 倍。数值为-2意味着其表达量是 $2^{-2}=1/4$。\n2.  **p值:** 假设药物没有实际效果（原假设成立），观测到至少与测量值一样极端的倍数变化的概率。小的p值（例如，小于0.05）表明观测到的变化具有统计显著性，不大可能是由随机机会造成的。\n\n这位生物信息学家发现一个名为 GEN-X 的特定基因，其Log2(倍数变化)非常大，为+6.0。然而，计算出的相应p值为0.35。一位资深科学家在审查此结果后，立即得出结论：尽管GEN-X的平均表达量变化巨大，但仅凭此数据，它并非一个有力的药物靶点候选基因。\n\n下列哪个陈述为“为何一个具有极大倍数变化的基因会同时拥有一个高（不显著）的p值”提供了最准确、最基本的统计学解释？\n\nA. 用于计算p值的数学模型已知对高表达基因不准确，本应使用另一种统计检验方法。\n\nB. +6.0的Log2(倍数变化)在生物学上是不合理的，因此必定是由于针对该特定基因的样本存在技术错误或污染所致。\n\nC. 巨大的平均倍数变化伴随着实验组内重复样本间极高的表达水平变异性，从而降低了结果的统计置信度。\n\nD. p值只是衡量原假设为真的概率，因此0.35的值意味着药物有35%的可能没有效果，这对于临床应用来说太高了。\n\nE. 高p值表明，虽然倍数变化很大，但变化的方向不一致；一些重复样本显示上调，而另一些则显示下调。", "solution": "此问题的目标是理解实验生物学中三个关键统计概念之间的关系：效应大小（由倍数变化衡量）、统计显著性（由p值衡量）和数据变异性（方差）。\n\n**步骤1：理解各项指标**\n- **+6.0的Log2(倍数变化):** 这代表**效应大小**。数值+6.0意味着药物处理组中GEN-X的平均表达量是对照组的 $2^6 = 64$ 倍。这是一个非常大的表观效应。该值通常是根据各组内重复样本表达水平的*平均值*计算得出的。\n- **0.35的p值:** 这代表**统计显著性**。像0.35这样的高p值意味着，如果我们假设药物没有实际效果（原假设为真），那么仅由实验中的随机变异导致观测到如此幅度或更大幅度的倍数变化的概率为35%。按照惯例，p值必须很低（例如 < 0.05）才能拒绝原假设并声称结果是“统计上显著的”。当p值为0.35时，我们未能拒绝原假设；我们无法确信所观察到的变化是真实的。\n\n**步骤2：关联效应大小、方差和显著性**\n核心问题是：一个巨大的效应大小（64倍的平均变化）怎么会不具有统计显著性呢？\n\n统计检验，如 Student's t-检验（或用于RNA-seq的更复杂的模型，如DESeq2或edgeR中的模型），其基本原理是通过比较效应大小与数据的变异性。检验统计量的一个简化概念公式是：\n\n$$ \\text{Test Statistic} = \\frac{\\text{Signal}}{\\text{Noise}} = \\frac{\\text{Difference between group means}}{\\text{Variability within groups (Standard Error)}} $$\n\n- **分子**（信号）与倍数变化相关。大的倍数变化意味着大的分子。\n- **分母**（噪声）是衡量我们对均值估计不确定性的指标。它直接由各组内数据点（重复样本的表达水平）的**方差**计算得出。高方差意味着高噪声。\n\np值是由这个检验统计量计算出来的。要得到一个高（不显著）的p值，检验统计量必须很小。在我们的例子中，我们知道分子（信号）很大，因为倍数变化很大。要使整个检验统计量变小，唯一的方法是分母（噪声）也非常大，甚至相对于信号来说更大。\n\n一个非常大的分母意味着GEN-X在重复样本间的表达水平变异性极高。例如，处理组的表达值可能是(10, 50, 1000)，而对照组是(0.5, 1, 15)。处理组的平均表达量远高于对照组，导致了巨大的倍数变化。然而，每个组*内部*数值的巨大离散程度（高方差）使得我们无法自信地断言平均值的差异是由于药物作用，而不仅仅是该基因在细胞中随机、不一致的行为。高p值正反映了这种信心的缺乏。\n\n**步骤3：评估各个选项**\n\n*   **A. 用于计算p值的数学模型已知对高表达基因不准确，本应使用另一种统计检验方法。**\n    这是不正确的。虽然选择正确的 statistical 模型很重要，但由于高方差导致大效应量不显著的现象是统计学的基础，并且可能在任何有效的检验中发生。它不是某个特定模型对高表达基因存在局限性所造成的假象。\n\n*   **B. +6.0的Log2(倍数变化)在生物学上是不合理的，因此必定是由于针对该特定基因的样本存在技术错误或污染所致。**\n    这是不正确的。64倍的变化虽然很大，但在生物学上并非不合理，特别是对于那些从接近零的基础表达水平被强烈激活的基因。在没有进一步证据的情况下，不能仅凭其幅度就将其视为错误。\n\n*   **C. 巨大的平均倍数变化伴随着实验组内重复样本间极高的表达水平变异性，从而降低了结果的统计置信度。**\n    这是正确的解释。它正确地指出了高组内方差是导致大效应大小（倍数变化）可能产生低统计显著性（高p值）的原因。这是对该情景的直接统计学解释。\n\n*   **D. p值只是衡量原假设为真的概率，因此0.35的值意味着药物有35%的可能没有效果，这对于临床应用来说太高了。**\n    这代表了对p值常见但错误的解释。p值是在*原假设为真的前提下*，观测到当前数据（或更极端数据）的概率。它**不是**原假设为真的概率。因此，该陈述基于一个有缺陷的定义。\n\n*   **E. 高p值表明，虽然倍数变化很大，但变化的方向不一致；一些重复样本显示上调，而另一些则显示下调。**\n    这看似合理，但并非最精确或最根本的原因。倍数变化是根据*平均*表达量计算的。+6.0的巨大正向倍数变化意味着处理组的平均值是对照组平均值的64倍。如果处理组的一些重复样本出现下调，这种情况是极不可能发生的。更直接、更确定的原因是组*内部*数值的巨大离散程度（方差），即使所有处理组重复样本的表达量都高于所有对照组的重复样本。高方差是根本原因，这使得C成为更好的答案。\n\n因此，最准确的解释是重复样本间的高变异性。", "answer": "$$\\boxed{C}$$", "id": "1440845"}]}