{"hands_on_practices": [{"introduction": "掌握数据缩放是数据预处理中的一项基本技能。本练习将通过一个简单的蛋白质丰度数据集，指导您手动应用最小-最大缩放公式，将数据转换到指定的 $[-1, 1]$ 区间。通过这个直接的计算实践，您将熟悉数据转换的核心机制，为处理更复杂的数据集打下坚实基础。[@problem_id:1425867]", "problem": "在一项系统生物学实验中，我们在一次刺激后的连续五个时间点测量了某种特定蛋白质的丰度。记录的丰度值（以任意荧光单位表示）被收集到一个向量 $x = [5, 10, 20, 25, 90]$ 中。在将此数据整合到一个更大的计算模型之前，需要对其进行归一化。你的任务是执行最小-最大缩放，将数据转换到 $[-1, 1]$ 的标准化范围内。\n\n将原始数据集中最小值为 $x_{\\min}$、最大值为 $x_{\\max}$ 的一个数据点 $x_i$ 进行最小-最大缩放，使其映射到新范围 $[a, b]$ 的通用公式是：\n\n$$x'_{i} = a + \\frac{(x_i - x_{\\min})(b - a)}{x_{\\max} - x_{\\min}}$$\n\n计算包含缩放后丰度值的新向量 $x'$。将你的答案表示为一个由五个精确分数组成的行向量。", "solution": "我们给定的数据向量为 $x=[5, 10, 20, 25, 90]$，并要求将其通过最小-最大缩放映射到范围 $[-1, 1]$。最小-最大缩放的公式是\n$$\nx'_{i} = a + \\frac{(x_i - x_{\\min})(b - a)}{x_{\\max} - x_{\\min}},\n$$\n其中 $a=-1$, $b=1$, $x_{\\min}=5$, $x_{\\max}=90$。将这些值代入公式，得到\n$$\nx'_{i} = -1 + \\frac{(x_i - 5)(1 - (-1))}{90 - 5} = -1 + \\frac{2(x_i - 5)}{85}.\n$$\n我们现在精确计算每个缩放后的值：\n- 对于 $x_{1}=5$：$x'_{1} = -1 + \\frac{2(5-5)}{85} = -1 + 0 = \\frac{-1}{1}$。\n- 对于 $x_{2}=10$：$x'_{2} = -1 + \\frac{2(10-5)}{85} = -1 + \\frac{10}{85} = -1 + \\frac{2}{17} = \\frac{-15}{17}$。\n- 对于 $x_{3}=20$：$x'_{3} = -1 + \\frac{2(20-5)}{85} = -1 + \\frac{30}{85} = -1 + \\frac{6}{17} = \\frac{-11}{17}$。\n- 对于 $x_{4}=25$：$x'_{4} = -1 + \\frac{2(25-5)}{85} = -1 + \\frac{40}{85} = -1 + \\frac{8}{17} = \\frac{-9}{17}$。\n- 对于 $x_{5}=90$：$x'_{5} = -1 + \\frac{2(90-5)}{85} = -1 + \\frac{170}{85} = -1 + 2 = \\frac{1}{1}$。\n\n因此，表示为精确分数的缩放后向量是\n$$\n\\begin{pmatrix}\n\\frac{-1}{1} & \\frac{-15}{17} & \\frac{-11}{17} & \\frac{-9}{17} & \\frac{1}{1}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{-1}{1} & \\frac{-15}{17} & \\frac{-11}{17} & \\frac{-9}{17} & \\frac{1}{1}\\end{pmatrix}}$$", "id": "1425867"}, {"introduction": "在应用任何归一化方法之前，首先要学会判断数据是否真的需要归一化。本练习提供了一个基于蛋白质组学实验的场景，要求您通过分析不同样本的统计摘要数据（如中位数和四分位数）来识别潜在的技术偏差。这有助于培养您区分系统性技术伪影和真实生物学效应的直觉，这是进行可靠数据分析的关键一步。[@problem_id:1425847]", "problem": "一个系统生物学实验室的研究人员正在研究两种新药物化合物对一种癌细胞系蛋白质组的影响。该实验包含四个样品：\n- 样品A：对照组细胞（未用药处理）。\n- 样品B：用药物1处理的细胞。\n- 样品C：用药物2处理的细胞。\n- 样品D：对照组细胞的技术重复。\n\n在进行质谱分析后，研究人员获得了每个样品中数千种蛋白质的丰度数据。这类实验的一个核心假设是，绝大多数蛋白质的丰度水平不会因处理而改变，因此所有样品中蛋白质丰度的整体统计分布应该相似。任何系统性偏差都可能是由技术性假象（例如，样品制备或仪器灵敏度的变化）引起的，需要进行校正。\n\n为了进行初步的质量检查，研究人员计算了每个样品蛋白质丰度分布（单位为任意荧光单位）的以下汇总统计量：最小值、第一四分位数（Q1）、中位数、第三四分位数（Q3）和最大值。\n\n- **样品A：** 最小值 = 10.5, Q1 = 40.2, 中位数 = 60.1, Q3 = 79.8, 最大值 = 121.3\n- **样品B：** 最小值 = 50.1, Q1 = 80.5, 中位数 = 100.2, Q3 = 120.6, 最大值 = 160.4\n- **样品C：** 最小值 = 5.3, Q1 = 20.8, 中位数 = 35.5, Q3 = 50.2, 最大值 = 85.9\n- **样品D：** 最小值 = 11.2, Q1 = 41.1, 中位数 = 61.3, Q3 = 80.7, 最大值 = 125.0\n\n设想一下使用这些统计数据为每个样品创建一个箱线图。根据这些汇总统计量和实验的核心假设，以下哪个是最恰当的结论及后续行动方案？\n\nA. 样品分布表现出显著的系统性偏移，这可由未对齐的中位数和四分位数证明。在比较样品间的蛋白质水平之前，需要进行数据归一化步骤。\n\nB. 处理组样品（B和C）与对照组（A）之间中位数的巨大差异很可能是由药物强烈的生物学效应引起的。应直接分析数据以捕捉这些重要变化。\n\nC. 主要问题是存在离群值，正如所有样品中最小值和最大值之间的宽范围所示。从每个样品中移除丰度最高和最低的极端蛋白质后，数据将变得可靠。\n\nD. 由于对照组样品（A）及其技术重复（D）显示出非常相似的分布，因此测量技术是可靠的，所有样品的数据无需任何调整即可直接进行比较。", "solution": "核心假设指出，绝大多数蛋白质的丰度在不同条件下不会改变，因此除了随机噪声外，各样品的整体分布应该被对齐。这意味着，在没有技术性假象的情况下，诸如四分位数和中位数之类的汇总分布特征在各样品间应是相似的。\n\n首先，验证技术重复。样品A和D显示出高度相似的四分位数和中位数，这与相同条件下的良好可重复性相一致。计算四分位距（IQR）以评估离散程度：\n$$\n\\mathrm{IQR}_{A}=Q3-Q1=79.8-40.2=39.6,\\quad \\mathrm{IQR}_{D}=80.7-41.1=39.6.\n$$\n中位数也很接近：\n$$\n\\mathrm{Median}_{A}=60.1,\\quad \\mathrm{Median}_{D}=61.3.\n$$\n因此，A和D吻合良好，支持对照组测量的一致性。\n\n接下来，将处理组样品与对照组进行比较。对于样品B：\n$$\n\\mathrm{IQR}_{B}=120.6-80.5=40.1\\approx \\mathrm{IQR}_{A},\n$$\n对于样品C：\n$$\n\\mathrm{IQR}_{C}=50.2-20.8=29.4,\n$$\n该值稍小，但仍具有可比性。关键的是，B和C的中位数和四分位数相对于A（和D）发生了系统性偏移。计算相对于A的中位数偏移：\n$$\n\\Delta \\mathrm{Median}_{B-A}=100.2-60.1=40.1,\\quad \\Delta \\mathrm{Median}_{C-A}=35.5-60.1=-24.6.\n$$\n四分位数也显示出类似的偏移：\n$$\n\\Delta Q1_{B-A}=80.5-40.2=40.3,\\quad \\Delta Q3_{B-A}=120.6-79.8=40.8,\n$$\n$$\n\\Delta Q1_{C-A}=20.8-40.2=-19.4,\\quad \\Delta Q3_{C-A}=50.2-79.8=-29.6.\n$$\n这些在各分位数上近似均匀的偏移量表明，这是全局性的、系统性的偏移，而不是只影响一部分蛋白质的局部变化。在大多数蛋白质在生物学上未发生变化的假设下，这种全局性偏移与技术性假象（例如，上样量、电离效率或仪器灵敏度的差异）更为一致，而非真正的生物学效应，因为生物学效应通常只会改变一部分蛋白质，而不会使所有分位数都发生一致的偏移。\n\n选项B将偏移归因于强烈的生物学效应；然而，B和C的整个分布向相反方向的普遍偏移与大多数蛋白质未发生变化的假设相矛盾，并且是技术性缩放/偏移的典型特征。选项C关注离群值，但A、B和D的IQR相似，主要差异在于位置（中位数和四分位数）而非极值；因此，去除离群值无法解决根本问题。选项D认为，由于A和D一致，所有样品都可以直接比较；尽管A和D验证了对照组的可重复性，但B和C中明显的系统性偏移仍然需要进行校正，以遵守核心假设。\n\n因此，恰当的结论是，各样品间存在显著的系统性偏移，需要在比较不同条件下的蛋白质丰度之前进行归一化（例如，中位数中心化或分位数归一化）。\n\n正确选项是A。", "answer": "$$\\boxed{A}$$", "id": "1425847"}, {"introduction": "归一化是一把双刃剑：如果使用不当，它不仅无法消除噪音，反而会引入严重的系统性错误。这个警示性的练习将让您亲手计算一个案例，其中一个不稳定的“管家基因”被错误地用作参照，从而人为地制造了基因差异表达的假象。通过这个实践，您将深刻理解为何严格验证归一化策略对于得出正确的科学结论至关重要。[@problem_id:1425895]", "problem": "一位分子生物学家正在研究一种新药对人类癌细胞系的影响。目标是确定该药物是否会改变一个靶基因“Gene X”的表达。实验包含两组细胞培养物：一组是接受安慰剂的“对照组”（Control），另一组是接受药物的“处理组”（Treatment）。\n\n为量化基因表达，该生物学家测量了 Gene X 的信使RNA（mRNA）转录本的丰度。作为数据标准化的常规做法，该生物学家还测量了一个被认为是稳定的“参考基因”（reference gene）的表达，该基因被称为“Gene R”，预计其表达水平不会因药物处理而改变。\n\n实验结束后，该生物学家获得了每组三个生物学重复的以下原始mRNA转录本计数（单位任意）：\n\n| 组别 | 重复 | Gene X (计数) | Gene R (计数) |\n|-----------|-----------|-----------------|-----------------|\n| Control | 1 | 1260 | 310 |\n| Control | 2 | 1240 | 290 |\n| Control | 3 | 1250 | 300 |\n| Treatment | 1 | 1275 | 615 |\n| Treatment | 2 | 1225 | 585 |\n| Treatment | 3 | 1250 | 600 |\n\n该生物学家选择的标准化程序如下：\n1. 对于每组（对照组和处理组），计算三个重复中 Gene X 和 Gene R 的平均表达水平。\n2. 对于每组，通过将 Gene X 的平均表达除以参考基因 Gene R 的平均表达，来计算 Gene X 的“标准化表达量”。\n\n最后，为确定药物的效果，该生物学家通过计算处理组中 Gene X 的标准化表达量与对照组中 Gene X 的标准化表达量的比值，来计算倍数变化（fold-change）。\n\n根据所提供的数据和指定的标准化程序，计算 Gene X 的表观倍数变化。将您的答案以一个四舍五入到三位有效数字的数值形式报告。", "solution": "目标是计算 Gene X 表达的表观倍数变化，其定义为处理组中其标准化表达量与对照组中其标准化表达量的比值。\n\n首先，我们计算每组中每个基因的平均表达量。\n\n对于对照组：\nGene X 的原始计数为 1260、1240 和 1250。\n对照组中 Gene X 的平均表达量 $\\langle X_{ctrl} \\rangle$ 为：\n$$ \\langle X_{ctrl} \\rangle = \\frac{1260 + 1240 + 1250}{3} = \\frac{3750}{3} = 1250 $$\nGene R 的原始计数为 310、290 和 300。\n对照组中 Gene R 的平均表达量 $\\langle R_{ctrl} \\rangle$ 为：\n$$ \\langle R_{ctrl} \\rangle = \\frac{310 + 290 + 300}{3} = \\frac{900}{3} = 300 $$\n\n对于处理组：\nGene X 的原始计数为 1275、1225 和 1250。\n处理组中 Gene X 的平均表达量 $\\langle X_{treat} \\rangle$ 为：\n$$ \\langle X_{treat} \\rangle = \\frac{1275 + 1225 + 1250}{3} = \\frac{3750}{3} = 1250 $$\nGene R 的原始计数为 615、585 和 600。\n处理组中 Gene R 的平均表达量 $\\langle R_{treat} \\rangle$ 为：\n$$ \\langle R_{treat} \\rangle = \\frac{615 + 585 + 600}{3} = \\frac{1800}{3} = 600 $$\n\n接下来，我们按照指定对每组进行标准化。标准化表达量 $X_{norm}$ 是通过将 Gene X 的平均表达量除以 Gene R 的平均表达量来计算的。\n\n对于对照组，Gene X 的标准化表达量 $X_{norm, ctrl}$ 为：\n$$ X_{norm, ctrl} = \\frac{\\langle X_{ctrl} \\rangle}{\\langle R_{ctrl} \\rangle} = \\frac{1250}{300} = \\frac{12.5}{3} \\approx 4.1667 $$\n\n对于处理组，Gene X 的标准化表达量 $X_{norm, treat}$ 为：\n$$ X_{norm, treat} = \\frac{\\langle X_{treat} \\rangle}{\\langle R_{treat} \\rangle} = \\frac{1250}{600} = \\frac{12.5}{6} \\approx 2.0833 $$\n\n最后，我们计算表观倍数变化，即处理组的标准化表达量与对照组的标准化表达量的比值。\n\n$$ \\text{Fold-Change} = \\frac{X_{norm, treat}}{X_{norm, ctrl}} = \\frac{1250 / 600}{1250 / 300} = \\frac{1250}{600} \\times \\frac{300}{1250} = \\frac{300}{600} = 0.5 $$\n\n题目要求答案四舍五入到三位有效数字。\n\n$$ \\text{Fold-Change} = 0.500 $$\n\n这个结果表明，该药物导致 Gene X 的表达量减少了50%。然而，直接检查原始数据显示，两组中 Gene X 的平均表达量是相同的（1250单位）。这种表观变化是由标准化程序造成的一种假象，因为“参考”基因 Gene R 并不稳定，其在处理组中的表达量翻了一倍。", "answer": "$$\\boxed{0.500}$$", "id": "1425895"}]}