{"hands_on_practices": [{"introduction": "在系统生物学分析中，我们常常需要将连续的测量值（如基因表达水平）转化为离散的类别，以便简化模型或降低数据噪声。这项练习将模拟一个常见场景：根据表达倍数变化的阈值，将基因归类为“上调”、“下调”或“无变化”。通过这个实践，你将掌握数据分箱的基本方法，这是数据预处理流程中的一个重要步骤。[@problem_id:1426100]", "problem": "在一项系统生物学实验中，一位研究人员研究细胞对一种新合成的信号分子的反应。他们测量了处理过的细胞中一组15个特定基因的表达水平，并将其与未经处理的对照细胞进行比较。结果以倍数变化表示，其中倍数变化是指处理样本中基因的表达水平与对照样本中基因表达水平的比率。\n\n为简化分析，研究人员决定根据以下标准将连续的倍数变化值离散化为三个不同的类别：\n- 如果一个基因的倍数变化严格大于1.8，则被分类为“上调”。\n- 如果一个基因的倍数变化严格小于0.6，则被分类为“下调”。\n- 如果一个基因的倍数变化大于或等于0.6且小于或等于1.8，则被分类为“无变化”。\n\n测得的15个基因的倍数变化如下：\n2.1, 0.5, 1.1, 3.4, 0.9, 1.8, 0.55, 1.79, 2.5, 0.6, 4.0, 0.3, 1.5, 1.81, 0.7\n\n根据所提供的离散化规则，确定被分类为“上调”的基因总数。", "solution": "题目要求我们计算被分类为“上调”的基因数量，定义为倍数变化 $x$ 满足 $x>1.8$ 的基因。给定的倍数变化值为 $2.1$, $0.5$, $1.1$, $3.4$, $0.9$, $1.8$, $0.55$, $1.79$, $2.5$, $0.6$, $4.0$, $0.3$, $1.5$, $1.81$, $0.7$。我们对每个值评估严格不等式 $x>1.8$：\n$2.1>1.8$ (计数)，$0.5 \\not> 1.8$ (不计数)，$1.1 \\not> 1.8$ (不计数)，$3.4>1.8$ (计数)，$0.9 \\not> 1.8$ (不计数)，$1.8 \\not> 1.8$ (不计数，因为不等式是严格的)，$0.55 \\not> 1.8$ (不计数)，$1.79 \\not> 1.8$ (不计数)，$2.5>1.8$ (计数)，$0.6 \\not> 1.8$ (不计数)，$4.0>1.8$ (计数)，$0.3 \\not> 1.8$ (不计数)，$1.5 \\not> 1.8$ (不计数)，$1.81>1.8$ (计数)，$0.7 \\not> 1.8$ (不计数)。满足 $x>1.8$ 的值是 $2.1$、$3.4$、$2.5$、$4.0$ 和 $1.81$。因此，“上调”基因的总数是 $5$ 个。", "answer": "$$\\boxed{5}$$", "id": "1426100"}, {"introduction": "机器学习模型通常要求输入为数值格式，但生物学数据中充满了非数值的分类变量，例如细胞系名称或表型。独热编码（One-hot encoding）是将这些分类标签转化为机器可读格式的标准方法，同时避免了在类别之间引入错误的顺序关系。在这个练习中，你将为一个包含不同癌细胞系的数据集应用独热编码，这是构建预测模型前必不可少的一步。[@problem_id:1426091]", "problem": "在一次系统生物学实验中，一位研究人员正在分析来自几种癌细胞系的转录组数据，以构建一个预测药物敏感性的机器学习模型。数据集中的一个特征是 `Cell_Line` 类型，它是一个分类变量。为了在大多数机器学习算法中使用这个特征，必须先将其转换为数值格式。\n\n该研究人员有来自五个实验样本的一个数据序列，其 `Cell_Line` 值按以下顺序记录：\n`['MCF7', 'HeLa', 'A549', 'HeLa', 'MCF7']`\n\n你的任务是对该序列进行独热编码。编码后表示的新列必须对应于按字母顺序（'A549', 'HeLa', 'MCF7'）排序的唯一细胞系类别。\n\n将得到的独热编码数据呈现为一个单一矩阵，其中每一行对应原始序列中的一个样本，每一列按指定的字母顺序对应一个细胞系类别。", "solution": "我们需要对一个分类变量进行独热编码，其类别需按指定的字母顺序排列。独热编码将每个类别映射到 $\\mathbb{R}^{k}$ 中的一个标准基向量，其中 $k$ 是唯一类别的数量，而 $1$ 的位置由所选的类别顺序决定。\n\n设唯一类别的集合为 $C=\\{\\text{A549},\\text{HeLa},\\text{MCF7}\\}$，并规定字母顺序为 $(\\text{A549},\\text{HeLa},\\text{MCF7})$。根据此顺序分配标准基向量，定义编码映射 $h:C\\to\\{0,1\\}^{3}$ 如下：\n$$\nh(\\text{A549})=(1,0,0),\\quad h(\\text{HeLa})=(0,1,0),\\quad h(\\text{MCF7})=(0,0,1).\n$$\n已知样本序列顺序为 $[\\text{MCF7},\\text{HeLa},\\text{A549},\\text{HeLa},\\text{MCF7}]$，我们构建独热编码矩阵 $Y$，其第 $i$ 行等于对第 $i$ 个样本应用 $h$ 的结果：\n$$\nY=\\begin{pmatrix}\nh(\\text{MCF7})\\\\\nh(\\text{HeLa})\\\\\nh(\\text{A549})\\\\\nh(\\text{HeLa})\\\\\nh(\\text{MCF7})\n\\end{pmatrix}\n=\\begin{pmatrix}\n0 & 0 & 1\\\\\n0 & 1 & 0\\\\\n1 & 0 & 0\\\\\n0 & 1 & 0\\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\n每一列按顺序对应于 $(\\text{A549},\\text{HeLa},\\text{MCF7})$，每一行则对应原始序列中的样本。", "answer": "$$\\boxed{\\begin{pmatrix}0 & 0 & 1\\\\0 & 1 & 0\\\\1 & 0 & 0\\\\0 & 1 & 0\\\\0 & 0 & 1\\end{pmatrix}}$$", "id": "1426091"}, {"introduction": "生物序列（如DNA或蛋白质序列）的长度可变，这为需要固定尺寸输入的机器学习模型带来了挑战。k-mer频率分析是一种强大的特征工程技术，能将任意长度的序列转化为一个固定长度的数值向量。这项练习将引导你完成两个关键步骤：首先，通过计算“k-mers”（长度为$k$的子序列）的出现频率来提取特征；其次，使用$L_2$范数对频率向量进行归一化，以确保不同长度序列之间具有可比性。[@problem_id:1426083]", "problem": "在生物信息学中，机器学习模型常用于分析脱氧核糖核酸 (DNA) 序列。一个关键的预处理步骤涉及将这些由字符（A、C、G、T）组成的可变长度序列转换为固定大小的数值特征向量。一种常见的方法是 k-mer 频率分析。\n\n“k-mer”被定义为 DNA 序列中任意长度为 $k$ 的连续子序列。“k-mer 频率向量”是一个给定序列的向量，其分量是每种可能的 k-mer 的计数，分量的顺序由 k-mer 的字典序（字母序）决定。对于 DNA，字典序为 A < C < G < T。\n\n为确保来自不同长度序列的特征向量具有可比性，必须对这些原始计数向量进行归一化。L2 归一化就是这样一种技术，其中原始频率向量的每个分量都除以向量的欧几里得范数（其各分量平方和的平方根）。\n\n考虑以下 DNA 序列：\n`S = GATTACATATACCA`\n\n您的任务是为此序列生成 L2 归一化 2-mer ($k=2$) 特征向量。作为最终答案，请提供此归一化向量中对应于 2-mer `AT` 的分量值。请将您的最终答案四舍五入到四位有效数字。", "solution": "2-mer 是序列中任意连续的符号对。对于长度为 $n$ 的序列，有 $n-1$ 个重叠的 2-mer。对于 $S=\\text{GATTACATATACCA}$，$n=14$，因此有 $14-1=13$ 个 2-mer：\n$$\\text{GA},\\ \\text{AT},\\ \\text{TT},\\ \\text{TA},\\ \\text{AC},\\ \\text{CA},\\ \\text{AT},\\ \\text{TA},\\ \\text{AT},\\ \\text{TA},\\ \\text{AC},\\ \\text{CC},\\ \\text{CA}.$$\n计数出现次数可得\n$$\\text{AT}:3,\\quad \\text{TA}:3,\\quad \\text{AC}:2,\\quad \\text{CA}:2,\\quad \\text{GA}:1,\\quad \\text{TT}:1,\\quad \\text{CC}:1.$$\n令 $c(w)$ 表示 2-mer $w$ 的原始计数。给定 2-mer $w$ 的 L2 归一化分量为\n$$\\frac{c(w)}{\\left(\\sum_{u} c(u)^{2}\\right)^{1/2}},$$\n其中求和项涵盖所有可能的 2-mer。使用上述非零计数，\n$$\\left\\|c\\right\\|_{2}=\\left(3^{2}+3^{2}+2^{2}+2^{2}+1^{2}+1^{2}+1^{2}\\right)^{1/2}=\\left(29\\right)^{1/2}.$$\n对于 $w=\\text{AT}$，$c(\\text{AT})=3$，因此归一化分量是\n$$\\frac{3}{\\sqrt{29}}.$$\n数值上，\n$$\\frac{3}{\\sqrt{29}}\\approx 0.557086\\ldots,$$\n四舍五入到四位有效数字为\n$$0.5571.$$", "answer": "$$\\boxed{0.5571}$$", "id": "1426083"}]}