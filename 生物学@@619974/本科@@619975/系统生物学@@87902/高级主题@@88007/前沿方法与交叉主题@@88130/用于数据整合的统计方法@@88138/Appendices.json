{"hands_on_practices": [{"introduction": "在数据整合中，一项基本任务是评估不同实验结果之间的一致性。当使用诸如酵母双杂交（Y2H）和免疫共沉淀（Co-IP-MS）等不同方法来研究同一生物学问题时，量化它们结果的重叠程度至关重要。本练习将向您介绍两种标准的相似性度量指标——Jaccard 指数和 Sørensen-Dice 系数，它们是比较和验证高通量生物学数据集的重要工具。[@problem_id:1467781]", "problem": "在一个系统生物学实验中，一位研究员旨在为一个特定的目标蛋白（我们称之为`p53`）鉴定其蛋白质相互作用伙伴。实验采用了两种独立的高通量实验技术。第一种技术是酵母双杂交 (Y2H) 筛选，它鉴定出了一个包含120个潜在相互作用蛋白的列表。第二种技术是免疫共沉淀-质谱联用 (Co-IP-MS)，它鉴定出了一个包含85个潜在相互作用蛋白的列表。通过比较这两个列表，发现有25个蛋白质是两组实验结果所共有的。\n\n为了量化这两种实验方法之间的一致性或符合度，请计算两种标准的相似性度量：\n1. Jaccard 指数，定义为两个集合交集的大小除以并集的大小。\n2. Sørensen-Dice 系数，定义为交集大小的两倍除以两个集合大小之和。\n\n请按顺序提供 Jaccard 指数和 Sørensen-Dice 系数的计算值。将您的最终答案四舍五入到三位有效数字。", "solution": "设 $A$ 是通过 Y2H 鉴定出的蛋白质集合，$B$ 是通过 Co-IP-MS 鉴定出的蛋白质集合。给定集合的大小为 $|A|=120$，$|B|=85$，以及 $|A \\cap B|=25$。\n\n根据容斥原理，并集的大小为\n$$\n|A \\cup B| = |A| + |B| - |A \\cap B| = 120 + 85 - 25 = 180.\n$$\n\nJaccard 指数 $J$ 定义为\n$$\nJ = \\frac{|A \\cap B|}{|A \\cup B|} = \\frac{25}{180} = \\frac{5}{36} \\approx 0.138888\\ldots,\n$$\n四舍五入到三位有效数字为 $0.139$。\n\nSørensen-Dice 系数 $D$ 定义为\n$$\nD = \\frac{2|A \\cap B|}{|A| + |B|} = \\frac{2 \\times 25}{120 + 85} = \\frac{50}{205} = \\frac{10}{41} \\approx 0.243902\\ldots,\n$$\n四舍五入到三位有效数字为 $0.244$。\n\n因此，按照要求的顺序（Jaccard 指数，Sørensen-Dice 系数），其值分别为 $0.139$ 和 $0.244$。", "answer": "$$\\boxed{\\begin{pmatrix}0.139 & 0.244\\end{pmatrix}}$$", "id": "1467781"}, {"introduction": "在简单比较的基础上，本练习将深入探讨如何利用整合数据构建预测模型。我们将使用多元线性回归这一统计建模的基石，来量化通路中酶的表达水平与代谢物产量之间的关系。这个实践将演示如何将一个生物学假设转化为数学模型，并从实验数据中估计其参数，这是定量系统生物学的一项核心技能。[@problem_id:1467795]", "problem": "一位系统生物学家正在研究一种发光细菌中关键代谢物`Luminol-X`的生物合成。该合成过程被认为遵循一个简单的两步酶促途径，其中前体物质被酶E1转化为中间产物，然后中间产物被酶E2转化为Luminol-X。\n\n为量化酶水平与代谢物产量之间的关系，这位生物学家从 $n=10$ 个独立的细菌培养物中收集了数据。对于每个培养物 $i$，他们测量了酶E1（记为 $x_{1i}$）和酶E2（记为 $x_{2i}$）的基因表达水平，以及Luminol-X的最终丰度（记为 $y_i$）。基因表达以“相对表达单位”衡量，代谢物丰度以“相对丰度单位（RAU）”衡量。\n\n该生物学家提议使用以下形式的多元线性回归模型来模拟代谢物丰度：\n$$y_i = \\beta_0 + \\beta_1 x_{1i} + \\beta_2 x_{2i} + \\epsilon_i$$\n其中 $\\beta_0, \\beta_1, \\beta_2$ 是回归系数，$\\epsilon_i$ 代表随机误差。\n\n从实验数据中计算出的汇总统计数据如下：\n- 样本数, $n = 10$\n- 变量总和：\n    - $\\sum_{i=1}^{n} x_{1i} = 55.0$\n    - $\\sum_{i=1}^{n} x_{2i} = 55.0$\n    - $\\sum_{i=1}^{n} y_{i} = 328.0$\n- 平方和：\n    - $\\sum_{i=1}^{n} x_{1i}^2 = 385.0$\n    - $\\sum_{i=1}^{n} x_{2i}^2 = 385.0$\n- 交叉乘积和：\n    - $\\sum_{i=1}^{n} x_{1i} x_{2i} = 336.0$\n    - $\\sum_{i=1}^{n} x_{1i} y_{i} = 2059.0$\n    - $\\sum_{i=1}^{n} x_{2i} y_{i} = 2110.0$\n\n使用普通最小二乘法，计算回归系数 $\\beta_1$ 的值，该系数代表了酶E1表达对Luminol-X丰度的'效应'。请将您的答案四舍五入至三位有效数字。该系数的单位将是 `RAU / 相对表达单位`。", "solution": "我们通过多元线性回归来模拟响应\n$$y_{i}=\\beta_{0}+\\beta_{1}x_{1i}+\\beta_{2}x_{2i}+\\epsilon_{i}.$$\n普通最小二乘估计量满足正规方程\n$$(X^{\\top}X)\\hat{\\beta}=X^{\\top}y,$$\n其中 $X$ 的列由一列1、$x_{1}$ 和 $x_{2}$ 组成。斜率系数也可以通过对变量进行中心化并求解以下方程组来等效地获得：\n$$\\begin{pmatrix}S_{11} & S_{12} \\\\ S_{12} & S_{22}\\end{pmatrix}\\begin{pmatrix}\\hat{\\beta}_{1} \\\\ \\hat{\\beta}_{2}\\end{pmatrix}=\\begin{pmatrix}S_{1y} \\\\ S_{2y}\\end{pmatrix},$$\n其中\n$$\\bar{x}_{1}=\\frac{\\sum x_{1i}}{n},\\quad \\bar{x}_{2}=\\frac{\\sum x_{2i}}{n},\\quad \\bar{y}=\\frac{\\sum y_{i}}{n},$$\n$$S_{11}=\\sum x_{1i}^{2}-n\\bar{x}_{1}^{2},\\quad S_{22}=\\sum x_{2i}^{2}-n\\bar{x}_{2}^{2},\\quad S_{12}=\\sum x_{1i}x_{2i}-n\\bar{x}_{1}\\bar{x}_{2},$$\n$$S_{1y}=\\sum x_{1i}y_{i}-n\\bar{x}_{1}\\bar{y},\\quad S_{2y}=\\sum x_{2i}y_{i}-n\\bar{x}_{2}\\bar{y}.$$\n根据给定数据，计算均值：\n$$\\bar{x}_{1}=\\frac{55.0}{10}=5.5,\\quad \\bar{x}_{2}=\\frac{55.0}{10}=5.5,\\quad \\bar{y}=\\frac{328.0}{10}=32.8.$$\n计算中心化后的和：\n$$S_{11}=385.0-10\\cdot(5.5)^{2}=385.0-302.5=82.5,$$\n$$S_{22}=385.0-10\\cdot(5.5)^{2}=82.5,$$\n$$S_{12}=336.0-10\\cdot(5.5)(5.5)=336.0-302.5=33.5,$$\n$$S_{1y}=2059.0-10\\cdot(5.5)(32.8)=2059.0-1804.0=255.0,$$\n$$S_{2y}=2110.0-10\\cdot(5.5)(32.8)=2110.0-1804.0=306.0.$$\n使用克莱姆法则求解 $\\hat{\\beta}_{1}$：\n$$\\hat{\\beta}_{1}=\\frac{S_{22}S_{1y}-S_{12}S_{2y}}{S_{11}S_{22}-S_{12}^{2}}=\\frac{(82.5)(255.0)-(33.5)(306.0)}{(82.5)(82.5)-(33.5)^{2}}.$$\n计算分子和分母：\n$$(82.5)(255.0)=21037.5,\\quad (33.5)(306.0)=10251.0,$$\n$$(82.5)(82.5)=6806.25,\\quad (33.5)^{2}=1122.25,$$\n因此\n$$\\hat{\\beta}_{1}=\\frac{21037.5-10251.0}{6806.25-1122.25}=\\frac{10786.5}{5684}=1.89769595\\ldots$$\n四舍五入到三位有效数字，系数为 $1.90$，单位为 RAU 每相对表达单位。", "answer": "$$\\boxed{1.90}$$", "id": "1467795"}, {"introduction": "这最后一个高级实践展示了一种强大而前沿的数据整合方法，用于解析复杂组织的细胞构成。您将利用从单细胞多组学数据（RNA 和 ATAC 测序）建立的参考图谱，根据一个整体组织样本的蛋白质组学图谱来确定其细胞组成。这个多步骤问题将挑战您连接来自矩阵分解、细胞类型鉴定和线性建模等领域的概念，以解决一个转化医学研究中的实际问题。[@problem_id:1467785]", "problem": "在系统生物学中，解构异质性大块组织样本的细胞组成是一项基础性挑战。一种强有力的方法是利用单细胞多组学参考图谱。\n\n一位研究人员使用一种技术，通过对同一批单细胞的转录组和染色质可及性进行共同分析，从一份小型组织活检中生成了一个参考图谱。研究人员对此单细胞数据执行了一项使用整合性非负矩阵分解 (integrative Non-Negative Matrix Factorization, iNMF) 的计算分析。iNMF算法将单细胞RNA测序 (scRNA-seq) 表达矩阵和单细胞转座酶可及染色质测序 (scATAC-seq) 可及性矩阵分解为一个共享的细胞-因子矩阵 $H$ 和多个特定模态的特征-因子矩阵。\n\n该分析识别出 $K=3$ 个潜因子，这些潜因子被确定为对应存在的三种主要细胞类型：神经元 (因子1)、星形胶质细胞 (因子2) 和小胶质细胞 (因子3)。得到的细胞-因子矩阵 $H \\in \\mathbb{R}_{\\ge 0}^{3 \\times 6}$ 提供了 $C=6$ 个单细胞中每一个在这三个因子上的载荷。该矩阵如下：\n$$\nH = \\begin{pmatrix}\n9 & 8 & 1 & 1 & 2 & 1 \\\\\n1 & 1 & 8 & 9 & 1 & 2 \\\\\n1 & 2 & 1 & 1 & 8 & 9\n\\end{pmatrix}\n$$\n其中，行对应于因子1、2、3，列对应于细胞 $c_1$ 到 $c_6$。\n\n相应的 $G=4$ 个基因的原始scRNA-seq基因表达计数矩阵 $X_{RNA} \\in \\mathbb{R}_{\\ge 0}^{4 \\times 6}$ 如下：\n$$\nX_{RNA} = \\begin{pmatrix}\n10 & 12 & 1 & 2 & 1 & 1 \\\\\n15 & 14 & 2 & 1 & 2 & 2 \\\\\n1 & 1 & 20 & 22 & 3 & 2 \\\\\n2 & 1 & 1 & 2 & 18 & 16\n\\end{pmatrix}\n$$\n其中，行对应于基因 $g_1, g_2, g_3, g_4$，列对应于同样的六个细胞。\n\n另外，对来自同一来源的一份更大的组织样本进行了大块蛋白质组学测量。$Q=2$ 种蛋白质的丰度向量 $y_{prot}$ 测得为：\n$$\ny_{prot} = \\begin{pmatrix} 6.1 \\\\ 6.15 \\end{pmatrix}\n$$\n已知蛋白质1是基因1的产物，蛋白质2是基因4的产物。\n\n你的任务是使用单细胞参考数据来解构该大块蛋白质组学样本。假设如下：\n1.  每个单细胞都属于其在矩阵 $H$ 中载荷最大的细胞类型 (因子)。\n2.  一种细胞类型的蛋白质特征是其相应基因在该类型所有单细胞中的平均基因表达量。\n3.  大块蛋白质组学向量是各细胞类型蛋白质特征的线性组合，权重为它们各自在大块样本中的比例。设神经元、星形胶质细胞和小胶质细胞的比例分别为 $p_N, p_A, p_M$，其中 $p_N+p_A+p_M=1$。\n\n计算大块组织样本中星形胶质细胞 ($p_A$) 的比例。将你的答案表示为小数，并四舍五入到三位有效数字。", "solution": "iNMF细胞-因子矩阵 $H$ 将每个细胞分配给其载荷最大的因子：\n- 对于 $c_{1}$：$(9,1,1)$，因此是神经元。\n- 对于 $c_{2}$：$(8,1,2)$，因此是神经元。\n- 对于 $c_{3}$：$(1,8,1)$，因此是星形胶质细胞。\n- 对于 $c_{4}$：$(1,9,1)$，因此是星形胶质细胞。\n- 对于 $c_{5}$：$(2,1,8)$，因此是小胶质细胞。\n- 对于 $c_{6}$：$(1,2,9)$，因此是小胶质细胞。\n\n因此，神经元：$\\{c_{1},c_{2}\\}$，星形胶质细胞：$\\{c_{3},c_{4}\\}$，小胶质细胞：$\\{c_{5},c_{6}\\}$。\n\n每种细胞类型的蛋白质特征是相应基因在其所有细胞中的平均表达量。蛋白质1对应于基因1 ($X_{RNA}$ 的第1行)，蛋白质2对应于基因4 ($X_{RNA}$ 的第4行)。从矩阵\n$$\nX_{RNA}=\\begin{pmatrix}\n10 & 12 & 1 & 2 & 1 & 1 \\\\\n15 & 14 & 2 & 1 & 2 & 2 \\\\\n1 & 1 & 20 & 22 & 3 & 2 \\\\\n2 & 1 & 1 & 2 & 18 & 16\n\\end{pmatrix},\n$$\n我们计算出每种细胞类型的特征：\n\n- 神经元 ($c_{1},c_{2}$)：基因1平均值 $=\\frac{10+12}{2}=11$，基因4平均值 $=\\frac{2+1}{2}=1.5$。因此 $s_{N}=\\begin{pmatrix}11\\\\1.5\\end{pmatrix}$。\n- 星形胶质细胞 ($c_{3},c_{4}$)：基因1平均值 $=\\frac{1+2}{2}=1.5$，基因4平均值 $=\\frac{1+2}{2}=1.5$。因此 $s_{A}=\\begin{pmatrix}1.5\\\\1.5\\end{pmatrix}$。\n- 小胶质细胞 ($c_{5},c_{6}$)：基因1平均值 $=\\frac{1+1}{2}=1$，基因4平均值 $=\\frac{18+16}{2}=17$。因此 $s_{M}=\\begin{pmatrix}1\\\\17\\end{pmatrix}$。\n\n设大块蛋白质组学向量为 $y_{prot}=\\begin{pmatrix}6.1\\\\6.15\\end{pmatrix}$。比例为 $p_{N},p_{A},p_{M}$ 且 $p_{N}+p_{A}+p_{M}=1$ 的线性混合模型为\n$$\n\\begin{pmatrix}6.1\\\\6.15\\end{pmatrix}\n= p_{N}\\begin{pmatrix}11\\\\1.5\\end{pmatrix}\n+ p_{A}\\begin{pmatrix}1.5\\\\1.5\\end{pmatrix}\n+ p_{M}\\begin{pmatrix}1\\\\17\\end{pmatrix}.\n$$\n按分量展开，可得\n$$\n11p_{N}+1.5p_{A}+1p_{M}=6.1,\\qquad 1.5p_{N}+1.5p_{A}+17p_{M}=6.15,\\qquad p_{N}+p_{A}+p_{M}=1.\n$$\n使用 $p_{A}=1-p_{N}-p_{M}$ 并代入前两个方程：\n$$\n11p_{N}+1.5(1-p_{N}-p_{M})+p_{M}=6.1 \\;\\Rightarrow\\; 9.5p_{N}-0.5p_{M}=4.6,\n$$\n$$\n1.5p_{N}+1.5(1-p_{N}-p_{M})+17p_{M}=6.15 \\;\\Rightarrow\\; 15.5p_{M}=4.65 \\;\\Rightarrow\\; p_{M}=\\frac{4.65}{15.5}=\\frac{93}{310}=0.3.\n$$\n然后根据 $9.5p_{N}-0.5p_{M}=4.6$，\n$$\n9.5p_{N}-0.5\\cdot 0.3=4.6 \\;\\Rightarrow\\; 9.5p_{N}=4.75 \\;\\Rightarrow\\; p_{N}=\\frac{4.75}{9.5}=0.5.\n$$\n最后，\n$$\np_{A}=1-p_{N}-p_{M}=1-0.5-0.3=0.2.\n$$\n四舍五入到三位有效数字， $p_{A}=0.200$ 。", "answer": "$$\\boxed{0.200}$$", "id": "1467785"}]}