{"hands_on_practices": [{"introduction": "在我们运用神经常微分方程（Neural ODE）模型进行预测之前，首要任务是确立系统的起点。这个练习旨在阐明初始状态向量的关键作用，将抽象的数学概念与具体的生物学测量（如病毒载量和免疫细胞数量）联系起来，这是理解如何将模型应用于新个体以进行个性化预测的基础。通过这个练习，你将能更好地理解如何初始化一个动力学模型以模拟现实世界的生物过程 [@problem_id:1453798]。", "problem": "在系统生物学领域，研究人员正在开发一个模型来预测患者慢性病毒感染的进展。他们使用一个基于神经普通微分方程（NODE）的连续时间模型。在任何时间 $t$，患者系统的状态由一个状态向量 $\\mathbf{y}(t) = [V(t), C(t), D(t)]$ 描述，其中：\n- $V(t)$ 是血液中病毒的浓度。\n- $C(t)$ 是靶向该病毒的活性细胞毒性T淋巴细胞（CTL）的数量。\n- $D(t)$ 是指示器官损伤的特定生物标志物的水平。\n\nNODE直接从这三个量的时间序列数据中学习复杂的潜在动态。它将状态向量的变化率建模为一个由神经网络参数化的函数，该网络的参数为 $\\theta$：\n$$\n\\frac{d\\mathbf{y}(t)}{dt} = f(\\mathbf{y}(t), t; \\theta)\n$$\n为了对新患者进行预测，该模型在初始观测时间 $t_0$ 用一个特定的向量 $\\mathbf{y}(t_0)$进行初始化，然后随时间对该常微分方程进行数值前向积分。\n\n在这个特定的生物学模型的背景下，初始状态向量 $\\mathbf{y}(t_0)$ 中包含了什么信息？\n\nA. 定义生物动态的神经网络的学习权重和偏置（$\\theta$）。\n\nB. 在观测期开始时，为患者测量的病毒浓度、CTL数量和器官损伤生物标志物的具体值。\n\nC. 在疾病过程结束后，病毒载量、CTL数量和器官损伤的预测的长期稳定值。\n\nD. 在时间 $t_0$ 时，病毒浓度、CTL数量和器官损伤的初始变化率。\n\nE. 影响整体疾病进展的静态患者特定因素，例如遗传倾向或年龄。", "solution": "我们给定一个由下式定义的神经普通微分方程\n$$\n\\frac{d\\mathbf{y}(t)}{dt} = f(\\mathbf{y}(t), t; \\theta),\n$$\n这是一个初值问题。为了生成轨迹，该模型需要在时间 $t_{0}$ 处有一个初始条件：\n$$\n\\mathbf{y}(t_{0}) = \\mathbf{y}_{0}.\n$$\n根据状态向量 $\\mathbf{y}(t) = [V(t), C(t), D(t)]$ 的定义，初始状态明确为\n$$\n\\mathbf{y}(t_{0}) = [V(t_{0}),\\, C(t_{0}),\\, D(t_{0})],\n$$\n这些是在观测开始时三个建模量的值。\n\n我们根据这个形式来评估每个选项：\n- 选项A是错误的，因为学习到的权重和偏置是 $f(\\mathbf{y}, t; \\theta)$ 中的参数 $\\theta$；它们不是 $\\mathbf{y}(t_{0})$ 的一部分。\n- 选项B是正确的，因为 $\\mathbf{y}(t_{0})$ 正是在观测开始时为新患者测量的初始值 $V(t_{0}), C(t_{0}), D(t_{0})$ 的向量，它作为积分的初始条件。\n- 选项C是错误的，因为长期或稳定值（例如，平衡点）是前向积分后动力学的结果，并未编码在初始条件中。\n- 选项D是错误的，因为初始变化率是通过在初始状态下评估方程右侧得到的：\n$$\n\\left.\\frac{d\\mathbf{y}(t)}{dt}\\right|_{t=t_{0}} = f(\\mathbf{y}(t_{0}), t_{0}; \\theta),\n$$\n它是 $\\mathbf{y}(t_{0})$ 和 $\\theta$ 的函数，但其本身不等于 $\\mathbf{y}(t_{0})$。\n- 选项E是错误的，因为静态患者特定因素不属于所定义的状态向量，除非明确地作为其分量包含在内；如题所述，$\\mathbf{y}(t)$ 仅包含 $V(t)$、$C(t)$ 和 $D(t)$。\n\n因此，初始状态向量 $\\mathbf{y}(t_{0})$ 包含了在观测开始时为患者测量的病毒浓度、CTL数量和器官损伤生物标志物的具体值。", "answer": "$$\\boxed{B}$$", "id": "1453798"}, {"introduction": "生物系统常常受到突然的外部干预，例如药物注射或环境变化，这些都表现为系统状态的瞬时跳变。本练习将引导你处理一个在连续时间模型中嵌入离散事件的实际场景，即计算在特定时刻注射化合物后蛋白质浓度的变化。掌握如何模拟这类混合动态过程，对于构建能够反映真实实验操作和治疗干预的复杂生物模型至关重要 [@problem_id:1453781]。", "problem": "在一个简化的系统生物学模型中，蛋白质“P”的浓度（记为 $z(t)$，单位为微摩尔/升 ($\\mu M$)）是使用神经常微分方程（Neural ODE）建模的。该系统的动力学由以下方程决定：\n$$\n\\frac{dz(t)}{dt} = f_\\theta(z(t))\n$$\n其中函数 $f_\\theta$ 是一个非常简单的神经网络层，表示为一个没有偏置项的线性变换：$f_\\theta(z) = w \\cdot z$。参数 $w$ 代表蛋白质P生成和降解的净速率常数。\n\n该系统在时间 $t=0$ 时以一个初始浓度开始。在稍后的一个特定时间，一位研究员向细胞培养物中注入一种化合物，导致蛋白质P的浓度发生瞬时变化。\n\n给定以下参数：\n- 时间 $t=0$ 时的初始浓度：$z_0 = 10.0$ $\\mu M$\n- 神经常微分方程参数：$w = -0.50$ $s^{-1}$\n- 注入时间：$t_{inject} = 2.0$ $s$\n- 因注入引起的浓度瞬时增加量：$\\Delta z = 50.0$ $\\mu M$\n\n计算在最终时间 $t_{final} = 4.0$ $s$ 时蛋白质P的浓度。请将您的最终答案以微摩尔/升 ($\\mu M$)为单位表示，并四舍五入到三位有效数字。", "solution": "我们得到神经常微分方程 $\\frac{dz(t)}{dt} = w z(t)$，在 $t = t_{\\text{inject}}$ 时存在一个跳跃（瞬时增加）$\\Delta z$。对于 $0 \\leq t < t_{\\text{inject}}$，该线性常微分方程的解可以通过分离变量法得到：\n$$\n\\frac{dz}{z} = w \\, dt \\quad \\Rightarrow \\quad \\ln|z| = w t + C \\quad \\Rightarrow \\quad z(t) = C \\exp(w t).\n$$\n代入初始条件 $z(0) = z_{0}$ 可得 $C = z_{0}$，因此\n$$\nz(t) = z_{0} \\exp(w t), \\quad 0 \\leq t < t_{\\text{inject}}.\n$$\n在注入时刻的左极限为\n$$\nz\\!\\left(t_{\\text{inject}}^{-}\\right) = z_{0} \\exp\\!\\left(w t_{\\text{inject}}\\right).\n$$\n注入导致一个瞬时跳跃：\n$$\nz\\!\\left(t_{\\text{inject}}^{+}\\right) = z\\!\\left(t_{\\text{inject}}^{-}\\right) + \\Delta z = z_{0} \\exp\\!\\left(w t_{\\text{inject}}\\right) + \\Delta z.\n$$\n对于 $t \\geq t_{\\text{inject}}$，动力学再次遵循 $\\frac{dz}{dt} = w z$，其在 $t_{\\text{inject}}$ 时的初始条件为 $z\\!\\left(t_{\\text{inject}}^{+}\\right)$，得到\n$$\nz(t) = z\\!\\left(t_{\\text{inject}}^{+}\\right) \\exp\\!\\left(w (t - t_{\\text{inject}})\\right).\n$$\n在 $t = t_{\\text{final}}$ 处求值并合并各项，得到闭合形式解\n$$\nz(t_{\\text{final}}) = \\left[z_{0} \\exp\\!\\left(w t_{\\text{inject}}\\right) + \\Delta z \\right] \\exp\\!\\left(w (t_{\\text{final}} - t_{\\text{inject}})\\right) = z_{0} \\exp\\!\\left(w t_{\\text{final}}\\right) + \\Delta z \\exp\\!\\left(w (t_{\\text{final}} - t_{\\text{inject}})\\right).\n$$\n现在代入给定值 $z_{0} = 10.0$，$w = -0.50$，$t_{\\text{inject}} = 2.0$，$t_{\\text{final}} = 4.0$ 和 $\\Delta z = 50.0$：\n$$\nz(4.0) = 10.0 \\exp(-2.0) + 50.0 \\exp(-1.0).\n$$\n数值计算如下：\n$$\n\\exp(-2.0) \\approx 0.1353352832, \\quad \\exp(-1.0) \\approx 0.3678794412,\n$$\n所以\n$$\nz(4.0) \\approx 10.0 \\times 0.1353352832 + 50.0 \\times 0.3678794412 \\approx 1.353352832 + 18.39397206 \\approx 19.74732489.\n$$\n四舍五入到三位有效数字，在 $t_{\\text{final}} = 4.0$ s 时的浓度为 $19.7$ 微摩尔/升。", "answer": "$$\\boxed{19.7}$$", "id": "1453781"}, {"introduction": "计算机模型的强大之处在于能够执行“计算机模拟”（in silico）实验，这在现实世界中可能成本高昂或难以实现。这个高阶练习挑战我们思考如何正确地修改一个已经训练好的模型，以模拟一个永久性的系统改变，比如基因敲除。这不仅仅是简单地改变初始条件，而是需要深入理解并操纵描述系统动态的规则本身（即向量场函数 $f$），这展示了神经常微分方程在探索生物系统鲁棒性和功能方面的强大潜力 [@problem_id:1453843]。", "problem": "一位系统生物学家正在使用神经普通微分方程（Neural ODE）对一个由 $N$ 个基因组成的基因调控网络进行建模。系统在时间 $t$ 的状态由一个向量 $\\mathbf{y}(t) \\in \\mathbb{R}^{N}$ 表示，其中每个分量 $y_i(t)$ 对应于基因 $i$ 的蛋白质产物的浓度。系统的时间演化由以下微分方程控制：\n$$\n\\frac{d\\mathbf{y}}{dt} = f(\\mathbf{y}; \\theta)\n$$\n此处，$f: \\mathbb{R}^{N} \\to \\mathbb{R}^{N}$ 是一个带有学习参数 $\\theta$ 的深度神经网络，它近似了基因调控动力学真实的潜在向量场。该模型已在来自野生型生物体的实验时间序列数据上成功训练。\n\n现在，该生物学家希望使用这个训练好的模型进行一次*计算模拟*实验，模拟对特定基因（比如基因 $k$，其中 $1 \\leq k \\leq N$）的永久性、完全基因敲除。永久性敲除意味着该基因变得完全无功能，其对应的蛋白质产物不再能被合成。目标是从蛋白质 $k$ 浓度为零的状态开始模拟该网络的行为，并确保其在所有后续时间里都保持为零。\n\n下列哪种方法能正确地修改模拟过程，以利用已经训练好的函数 $f(\\mathbf{y}; \\theta)$ 实现对基因 $k$ 的这种永久性敲除？\n\nA. 将第 $k$ 个分量的初始条件设为零，即 $y_k(t_0) = 0$，并保持所有其他基因 $y_j(t_0)$ ($j \\neq k$) 的初始条件不变。然后，求解原始的 ODE $\\frac{d\\mathbf{y}}{dt} = f(\\mathbf{y}; \\theta)$。\n\nB. 在 ODE 求解器中每次评估向量场函数 $f(\\mathbf{y}; \\theta)$ 时，在将*输入向量*传递给神经网络之前，总是将其第 $k$ 个分量设为零。\n\nC. 使用一个修改过的训练数据集从头开始重新训练整个神经网络 $f$，在该数据集中，所有测量的浓度 $y_k$ 的值都被人为地设为零。\n\nD. 为模拟定义一个新的向量场函数 $f'(\\mathbf{y}; \\theta)$。在 ODE 求解器中每次进行评估时，首先计算原始网络的输出 $\\mathbf{v} = f(\\mathbf{y}; \\theta)$，然后通过将其第 $k$ 个分量设为零（$v'_k = 0$），同时保持所有其他分量不变（$v'_j = v_j$ 对 $j \\neq k$）来构建 $f'$ 的输出。使用初始条件 $y_k(t_0) = 0$ 求解新的 ODE $\\frac{d\\mathbf{y}}{dt} = f'(\\mathbf{y}; \\theta)$。\n\nE. 通过移除所有连接到第 $k$ 个输出神经元的连接并将其偏置项设为零来改变神经网络的架构。然后，使用这个修改后的网络来求解 ODE。", "solution": "我们需要对分量 $k$ 进行永久性敲除，这意味着模拟的轨迹必须满足 $y_{k}(t_{0})=0$ 并且在所有后续时间里都保持在不变子空间 $S=\\{\\mathbf{y}\\in\\mathbb{R}^{N}: y_{k}=0\\}$ 上。$S$ 在流作用下保持不变的一个充分必要条件是，当 $y_{k}=0$ 时，向量场的第 $k$ 个分量为零，即对于所有 $\\mathbf{y}\\in S$，都有 $f_{k}(\\mathbf{y};\\theta)=0$。因为训练好的 $f$ 不保证满足此条件，所以必须修改模拟过程，使得 ODE 求解器使用的有效向量场强制满足\n$$\n\\frac{dy_{k}}{dt}=0 \\quad \\text{and} \\quad y_{k}(t_{0})=0,\n$$\n同时允许其余分量根据在 $y_{k}=0$ 的状态下评估的学习到的动力学进行演化。\n\n评估各个选项：\n\nA. 仅设置 $y_{k}(t_{0})=0$ 并对 $\\frac{d\\mathbf{y}}{dt}=f(\\mathbf{y};\\theta)$ 进行积分并不能保证此后 $y_{k}(t)=0$，因为通常情况下在 $S$ 上 $f_{k}(\\mathbf{y};\\theta)\\neq 0$。因此 $S$ 不必是不变的，$y_{k}$ 的值可以离开零。\n\nB. 通过将 $\\mathbf{y}$ 投影到满足 $\\Pi(\\mathbf{y})_{k}=0$ 的 $\\Pi(\\mathbf{y})$ 来修改 $f$ 的输入，会得到有效的 ODE\n$$\n\\frac{d\\mathbf{y}}{dt}=f(\\Pi(\\mathbf{y});\\theta).\n$$\n这仍然得到 $\\frac{dy_{k}}{dt}=f_{k}(\\Pi(\\mathbf{y});\\theta)$，它通常不恒为零。因此，除非施加额外的约束，否则 $y_k$ 不会保持为零；这本身不能实现永久性敲除。\n\nC. 在 $y_{k}$ 被设为零的数据上重新训练是不必要的，并且不能保证在模拟中 $\\frac{dy_{k}}{dt}=0$；此外，它不满足使用已经训练好的 $f(\\mathbf{y};\\theta)$ 的要求。\n\nD. 通过仅屏蔽第 $k$ 个输出来定义一个修改后的向量场 $f'$：\n$$\n\\mathbf{v}=f(\\mathbf{y};\\theta), \\quad v'_{k}=0, \\quad v'_{j}=v_{j}\\ \\text{for}\\ j\\neq k,\n$$\n并求解\n$$\n\\frac{d\\mathbf{y}}{dt}=f'(\\mathbf{y};\\theta), \\quad y_{k}(t_{0})=0.\n$$\n那么对于所有 $t$，都有 $\\frac{dy_{k}}{dt}=0$，因此 $y_{k}(t)\\equiv 0$。对于 $j\\neq k$，$\\frac{dy_{j}}{dt}=f_{j}(\\mathbf{y};\\theta)$ 是在 $y_{k}=0$（因为 $y_k$ 被保持为零）的状态下评估的，这正确地将基因 $k$ 的缺失效应传播到网络的其余部分。这使用了已经训练好的 $f$，并且只修改了模拟过程。\n\nE. 通过改变网络架构来强制第 $k$ 个输出为零，也使得 $\\frac{dy_{k}}{dt}\\equiv 0$，并且在 $y_{k}(t_{0})=0$ 的条件下，会使 $y_{k}(t)=0$。然而，这并没有原样使用已经训练好的函数 $f(\\mathbf{y};\\theta)$；它改变的是模型架构，而不是模拟过程。题目要求使用训练好的 $f$ 来修改模拟过程，E 选项不满足这个要求。\n\n因此，只有选项 D 正确且直接地在模拟中利用已经训练好的 $f(\\mathbf{y};\\theta)$ 来强制实现永久性敲除。", "answer": "$$\\boxed{D}$$", "id": "1453843"}]}