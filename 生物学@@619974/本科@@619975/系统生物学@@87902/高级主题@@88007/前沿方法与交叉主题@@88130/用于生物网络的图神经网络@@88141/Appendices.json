{"hands_on_practices": [{"introduction": "在我们应用图神经网络（GNN）分析生物网络之前，首要任务是将复杂的生物系统转化为机器可以理解的图结构。本练习将指导你如何将一个简单的代谢途径，具体化为两种标准的图表示形式：邻接矩阵（adjacency matrix）和边列表（edge list）。掌握这项转化技能是为任何基于图的机器学习模型准备生物网络数据的关键第一步。[@problem_id:1436682]", "problem": "在系统生物学中，代谢通路通常被建模为图，以便通过图神经网络（GNNs）等机器学习算法进行分析。考虑一个涉及四种代谢物（M1、M2、M3和M4）的简单假设性代谢通路。该通路中的生物化学反应定义了我们图中的连接，具体如下：\n\n1.  代谢物M1是一种底物，可被转化为代谢物M2。\n2.  代谢物M2是一种底物，可被转化为代谢物M3。\n3.  代谢物M2也可以通过一个独立的反应被转化为代谢物M4。\n\n这些反应可以表示为一个有向图，其中从节点 `u` 到节点 `v` 的一条边表示代谢物 `u` 是产生代谢物 `v` 的反应的底物。为了能被GNN处理，这个图必须被转换为数值格式。两种常见的格式是邻接矩阵和边列表。\n\n我们将代谢物按以下顺序作为节点进行索引：M1=1, M2=2, M3=3, M4=4。邻接矩阵 $A$ 是一个方阵，其中如果存在从节点 $i$ 到节点 $j$ 的有向边，则元素 $A_{ij}$ 为 1，否则为 0。边列表是由数对组成的列表，其中每个数对 `[source, target]` 表示一条有向边。\n\n根据所描述的通路，以下哪个选项正确地提供了该图的邻接矩阵和边列表表示？\n\nA.\n邻接矩阵：\n$$\n\\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 1 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}\n$$\n边列表： `[[1, 2], [2, 3], [2, 4]]`\n\nB.\n邻接矩阵：\n$$\n\\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 1 & 0 & 1 & 1 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\end{pmatrix}\n$$\n边列表： `[[1, 2], [2, 1], [2, 3], [3, 2], [2, 4], [4, 2]]`\n\nC.\n邻接矩阵：\n$$\n\\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}\n$$\n边列表： `[[1, 2], [2, 3]]`\n\nD.\n邻接矩阵：\n$$\n\\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\end{pmatrix}\n$$\n边列表： `[[2, 1], [3, 2], [4, 2]]`", "solution": "该通路定义了有向反应：M1到M2，M2到M3，以及M2到M4。在节点索引为M1=1, M2=2, M3=3, M4=4的情况下，这些反应所隐含的有向边为 $(1,2)$、$(2,3)$ 和 $(2,4)$。\n\n根据邻接矩阵 $A$ 的定义，如果存在从节点 $i$ 到节点 $j$ 的有向边，则 $A_{ij}=1$，否则 $A_{ij}=0$。因此，唯一的非零元素是 $A_{12}=1$、$A_{23}=1$ 和 $A_{24}=1$，所有其他元素均为 $0$。这得到\n$$\nA=\\begin{pmatrix}\n0 & 1 & 0 & 0\\\\\n0 & 0 & 1 & 1\\\\\n0 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 0\n\\end{pmatrix}.\n$$\n边列表是记录这些相同边的有向数对集合，即 `[[1,2],[2,3],[2,4]]`。\n\n与选项比较：\n- 选项A具有完全相同的邻接矩阵和边列表，因此是正确的。\n- 选项B包含了不存在的额外反向边 $(2,1)$、$(3,2)$ 和 $(4,2)$，因此是错误的。\n- 选项C省略了边 $(2,4)$，因此是不完整且错误的。\n- 选项D反转了所有边的方向，因此是错误的。\n\n因此，正确选项是A。", "answer": "$$\\boxed{A}$$", "id": "1436682"}, {"introduction": "一旦网络被表示为图，GNN 就通过在相连的节点之间传递“消息”来进行学习。这个问题提供了一个亲手计算单个消息传递步骤的机会，包括聚合邻居节点的特征和使用激活函数进行更新。通过完成这个计算，你将揭开 GNN 如何根据节点的局部邻域信息来更新其自身特征这一核心机制的神秘面纱。[@problem_id:1436694]", "problem": "在系统生物学领域，图神经网络 (GNNs) 是从网络结构化数据（例如蛋白质-蛋白质相互作用 (PPI) 网络）中学习的强大工具。考虑一个简单的 GNN 模型，该模型旨在根据蛋白质之间的连接来更新其特征。\n\n我们关注一个 PPI 网络的一小部分，其中包含一个中心蛋白质 Protein V，它与两个相邻蛋白质 Protein U1 和 Protein U2 相互作用。每个蛋白质都由一个二维特征向量描述。向量的第一个元素代表蛋白质的归一化表达水平，第二个元素代表其线粒体定位分数。\n\n初始特征向量如下：\n- 蛋白质 V: $h_V = [0.1, 0.9]$\n- 蛋白质 U1: $h_{U1} = [0.2, 0.3]$\n- 蛋白质 U2: $h_{U2} = [0.6, 0.1]$\n\nGNN 在单个消息传递步骤中执行一次更新，以找到 Protein V 的新特征向量，记为 $h'_V$。该过程包括两个阶段：\n\n1.  **聚合 (Aggregation)：** 通过对 Protein V 所有邻居的特征向量进行逐元素求和，创建一个聚合邻居向量 $h_{N(V)}$。\n2.  **更新 (Update)：** 将聚合邻居向量 $h_{N(V)}$ 与 Protein V 的原始特征向量 $h_V$ 相加，然后对结果应用逐元素的修正线性单元 (ReLU) 激活函数，从而计算出新特征向量 $h'_V$。ReLU 函数的定义为 $\\text{ReLU}(x) = \\max(0, x)$，应用于向量的每个分量。\n\n计算 Protein V 更新后的特征向量 $h'_V$。", "solution": "给定三个蛋白质的初始特征向量：\n$$\nh_{V}=\\begin{pmatrix}0.1 & 0.9\\end{pmatrix},\\quad\nh_{U1}=\\begin{pmatrix}0.2 & 0.3\\end{pmatrix},\\quad\nh_{U2}=\\begin{pmatrix}0.6 & 0.1\\end{pmatrix}.\n$$\n聚合步骤：聚合邻居向量是邻居特征的逐元素和，\n$$\nh_{N(V)}=h_{U1}+h_{U2}\n=\\begin{pmatrix}0.2 & 0.3\\end{pmatrix}+\\begin{pmatrix}0.6 & 0.1\\end{pmatrix}\n=\\begin{pmatrix}0.8 & 0.4\\end{pmatrix}.\n$$\n更新步骤：对 $h_{V}$ 和 $h_{N(V)}$ 的和应用逐元素的 ReLU，\n$$\nh'_{V}=\\operatorname{ReLU}\\!\\big(h_{V}+h_{N(V)}\\big)\n=\\operatorname{ReLU}\\!\\left(\\begin{pmatrix}0.1 & 0.9\\end{pmatrix}+\\begin{pmatrix}0.8 & 0.4\\end{pmatrix}\\right)\n=\\operatorname{ReLU}\\!\\begin{pmatrix}0.9 & 1.3\\end{pmatrix}.\n$$\n由于每个分量都是正数，因此对于两个分量都有 $\\operatorname{ReLU}(x)=x$，所以\n$$\nh'_{V}=\\begin{pmatrix}0.9 & 1.3\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.9 & 1.3\\end{pmatrix}}$$", "id": "1436694"}, {"introduction": "GNN 的真正威力来自于堆叠多个层，这使得信息能够传播到远超节点直接邻居的范围。这个练习将追踪一个信号在一个简单的线性路径上经过三个 GNN 层的传播过程，这个概念被称为“感受野”（receptive field）的扩展。通过这个实践，你将生动地看到一个节点的表示是如何随着 GNN 层的加深而逐渐融入更远处节点的信息，从而使模型能够学习到复杂的非局部模式。[@problem_id:1436705]", "problem": "在系统生物学的研究中，蛋白质信号通路通常被建模为图，其中蛋白质是节点，它们之间的相互作用是边。我们可以使用图神经网络（GNN）来学习这些蛋白质的表示，这些表示捕获了它们局部网络环境的信息。\n\n考虑一个由四个蛋白质 A、B、C 和 D 组成的简化线性信号通路。这可以表示为一个无向图，其中节点是蛋白质，边代表相互作用：(A, B)、(B, C) 和 (C, D)。\n\n最初，每个蛋白质都有一个标量特征值，代表一种特定的生化属性。设第 $k=0$ 层的初始特征值用 $h^{(0)}$ 表示。在我们的通路中，一个信号起源于蛋白质 A，因此其初始特征值为 $h_A^{(0)} = w$，而其他蛋白质处于基础状态，特征值为零：$h_B^{(0)} = 0$，$h_C^{(0)} = 0$，$h_D^{(0)} = 0$。\n\nGNN 在每一层更新每个蛋白质的特征值。下一层 $k+1$ 的任何蛋白质（节点）$v$ 的更新规则是其自身特征值和当前层 $k$ 的紧邻邻居特征值的函数。具体来说，新的特征值是节点本身及其邻居特征值的平均值。数学上，更新规则是：\n$$h_v^{(k+1)} = \\frac{1}{|\\mathcal{N}(v)| + 1} \\left( h_v^{(k)} + \\sum_{u \\in \\mathcal{N}(v)} h_u^{(k)} \\right)$$\n其中 $\\mathcal{N}(v)$ 是节点 $v$ 的邻居集合，而 $|\\mathcal{N}(v)|$ 是邻居的数量。\n\n计算在网络处理了恰好三层 GNN 的信息后，蛋白质 D 的特征值 $h_D$（即，求出 $h_D^{(3)}$）。将答案表示为关于 $w$ 的符号表达式。", "solution": "我们对无向路径图 A-B-C-D 进行建模，其邻居集合为 $\\mathcal{N}(A)=\\{B\\}$，$\\mathcal{N}(B)=\\{A,C\\}$，$\\mathcal{N}(C)=\\{B,D\\}$ 和 $\\mathcal{N}(D)=\\{C\\}$。逐层更新规则是\n$$\nh_v^{(k+1)}=\\frac{1}{|\\mathcal{N}(v)|+1}\\left(h_v^{(k)}+\\sum_{u\\in\\mathcal{N}(v)}h_u^{(k)}\\right),\n$$\n对于每个节点，该规则变为\n$$\nh_A^{(k+1)}=\\frac{h_A^{(k)}+h_B^{(k)}}{2},\\quad\nh_B^{(k+1)}=\\frac{h_B^{(k)}+h_A^{(k)}+h_C^{(k)}}{3},\\quad\nh_C^{(k+1)}=\\frac{h_C^{(k)}+h_B^{(k)}+h_D^{(k)}}{3},\\quad\nh_D^{(k+1)}=\\frac{h_D^{(k)}+h_C^{(k)}}{2}.\n$$\n初始特征为\n$$\nh_A^{(0)}=w,\\quad h_B^{(0)}=0,\\quad h_C^{(0)}=0,\\quad h_D^{(0)}=0,\n$$\n我们逐层进行计算。\n\n在 $k=1$ 时：\n$$\nh_A^{(1)}=\\frac{w+0}{2}=\\frac{w}{2},\\quad\nh_B^{(1)}=\\frac{0+w+0}{3}=\\frac{w}{3},\\quad\nh_C^{(1)}=\\frac{0+0+0}{3}=0,\\quad\nh_D^{(1)}=\\frac{0+0}{2}=0.\n$$\n\n在 $k=2$ 时：\n$$\nh_A^{(2)}=\\frac{\\frac{w}{2}+\\frac{w}{3}}{2}=\\frac{5w}{12},\\quad\nh_B^{(2)}=\\frac{\\frac{w}{3}+\\frac{w}{2}+0}{3}=\\frac{5w}{18},\\quad\nh_C^{(2)}=\\frac{0+\\frac{w}{3}+0}{3}=\\frac{w}{9},\\quad\nh_D^{(2)}=\\frac{0+0}{2}=0.\n$$\n\n在 $k=3$ 时：\n$$\nh_A^{(3)}=\\frac{\\frac{5w}{12}+\\frac{5w}{18}}{2}=\\frac{25w}{72},\\quad\nh_B^{(3)}=\\frac{\\frac{5w}{18}+\\frac{5w}{12}+\\frac{w}{9}}{3}=\\frac{29w}{108},\\quad\nh_C^{(3)}=\\frac{\\frac{w}{9}+\\frac{5w}{18}+0}{3}=\\frac{7w}{54},\\quad\nh_D^{(3)}=\\frac{0+\\frac{w}{9}}{2}=\\frac{w}{18}.\n$$\n\n因此，经过三层后，蛋白质 D 的特征值为 $h_D^{(3)}=\\frac{w}{18}$。", "answer": "$$\\boxed{\\frac{w}{18}}$$", "id": "1436705"}]}