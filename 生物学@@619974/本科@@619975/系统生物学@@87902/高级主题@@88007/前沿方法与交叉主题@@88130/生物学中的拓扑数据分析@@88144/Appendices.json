{"hands_on_practices": [{"introduction": "将蛋白质等生物大分子表示为点云数据，是拓扑数据分析（TDA）在生物学中的一个核心应用。通过构建Vietoris-Rips复合物，我们可以探索不同空间尺度下的结构特征。这个练习将带你亲手计算一个简单肽链点云中第一个“环”（一维圈）诞生的临界距离 $\\epsilon$，从而将抽象的拓扑概念与具体的分子坐标联系起来。[@problem_id:1475179]", "problem": "在系统生物学中，拓扑数据分析 (TDA) 提供了一个强大的框架，用于分析复杂生物数据的“形状”。一个常见的应用是通过将蛋白质表示为其α-碳原子的点云来研究其构象。然后在此点云上构建Vietoris-Rips复形，以捕捉其在不同空间尺度下的拓扑特征。\n\n一个点集上的Vietoris-Rips复形 $VR(\\epsilon)$ 是一个单纯复形，其中：\n1. 顶点是点本身。\n2. 如果任意两点之间的欧几里得距离小于或等于一个距离参数 $\\epsilon$，则它们之间连接一条边。\n3. 如果三点之间的所有三条成对距离都小于或等于 $\\epsilon$，则这三点形成一个三角形（或2-单纯形）。\n4. 更高维的单纯形（例如，四面体）也以类似方式形成。\n\n随着 $\\epsilon$ 的增加，会形成更多的连接，复形的拓扑结构也随之改变。一个关键事件是出现一个“洞”或1-圈，它是由边组成的闭合环路，但在该 $\\epsilon$ 值下，它不是复形内任何三角形集合的边界。\n\n考虑一个小的肽片段，其结构由其五个 α-碳原子（$P_1$ 到 $P_5$）的三维坐标近似表示，单位为埃 (Å)：\n$P_1 = (0.0, 5.0, 0.1)$\n$P_2 = (4.0, 2.0, -0.2)$\n$P_3 = (3.0, -3.0, 0.3)$\n$P_4 = (-3.0, -3.0, -0.1)$\n$P_5 = (-4.0, 2.0, 0.2)$\n\n确定在此点云的Vietoris-Rips过滤中，第一个非平凡1-圈出现的最小距离阈值 $\\epsilon$。请用埃 (Å) 作答，并四舍五入到三位有效数字。", "solution": "我们寻求最小的阈值 $\\epsilon$，使得在基于五个点 $P_1, \\dots, P_5$ 构建的Vietoris–Rips过滤中首次出现一个非平凡1-圈（一个未被任何2-单纯形填充的边环）。在一个Vietoris–Rips复形 $VR(\\epsilon)$ 中，如果 $P_i$ 和 $P_j$ 之间的欧几里得距离 $d_{ij}$ 满足 $d_{ij} \\le \\epsilon$，则存在一条边 $\\{i, j\\}$；如果三点 $\\{i, j, k\\}$ 之间的所有三条成对距离都 $\\le \\epsilon$，则存在一个三角形。\n\n给定的坐标是：$P_1=(0.0, 5.0, 0.1)$、$P_2=(4.0, 2.0, -0.2)$、$P_3=(3.0, -3.0, 0.3)$、$P_4=(-3.0, -3.0, -0.1)$、$P_5=(-4.0, 2.0, 0.2)$。\n\n首先计算欧几里得距离。使用公式 $d_{ij}^2 = (\\Delta x)^2 + (\\Delta y)^2 + (\\Delta z)^2$，我们得到五条“周边”边（根据坐标建议的自然循环顺序 $1\\to 2\\to 3\\to 4\\to 5\\to 1$）的距离平方：\n$$\n\\begin{aligned}\nd_{12}^2 &= (4-0)^2 + (2-5)^2 + (-0.2-0.1)^2 = 16+9+0.09=25.09 \\\\\nd_{23}^2 &= (3-4)^2 + (-3-2)^2 + (0.3-(-0.2))^2 = 1+25+0.25=26.25 \\\\\nd_{34}^2 &= (-3-3)^2 + (-3-(-3))^2 + (-0.1-0.3)^2 = 36+0+0.16=36.16 \\\\\nd_{45}^2 &= (-4-(-3))^2 + (2-(-3))^2 + (0.2-(-0.1))^2 = 1+25+0.09=26.09 \\\\\nd_{51}^2 &= (0-(-4))^2 + (5-2)^2 + (0.1-0.2)^2 = 16+9+0.01=25.01\n\\end{aligned}\n$$\n非相邻的“对角线”距离的平方是：\n$$\n\\begin{aligned}\nd_{13}^2 &= (3-0)^2 + (-3-5)^2 + (0.3-0.1)^2 = 9+64+0.04=73.04 \\\\\nd_{24}^2 &= (-3-4)^2 + (-3-2)^2 + (-0.1-(-0.2))^2 = 49+25+0.01=74.01 \\\\\nd_{35}^2 &= (-4-3)^2 + (2-(-3))^2 + (0.2-0.3)^2 = 49+25+0.01=74.01 \\\\\nd_{41}^2 &= (0-(-3))^2 + (5-(-3))^2 + (0.1-(-0.1))^2 = 9+64+0.04=73.04 \\\\\nd_{52}^2 &= (4-(-4))^2 + (2-2)^2 + (-0.2-0.2)^2 = 64+0+0.16=64.16\n\\end{aligned}\n$$\n\n当所有五条周边边都存在，且没有任何三角形集合填充该环路时，一个1-圈首次出现。当 $\\epsilon$ 达到 $\\{d_{12}, d_{23}, d_{34}, d_{45}, d_{51}\\}$ 中的最大值，即 $d_{34}=\\sqrt{36.16}$ 时，所有周边边都存在。在 $\\epsilon=\\sqrt{36.16}$ 时，检查是否存在三角形：任何由三个连续顶点（如 $\\{1,2,3\\}$）组成的三角形，都要求相应的对角线（如 $d_{13}$）也满足该阈值。然而，所有对角线距离的平方都大于 $36.16$（最短的对角线距离平方为 $d_{52}^2 = 64.16$）。因此，在 $\\epsilon=\\sqrt{36.16}$ 时，不存在任何三角形，所以由五条周边边形成的环路未被填充，构成了一个非平凡的1-圈。\n\n因此，第一个非平凡1-圈出现的最小阈值是 $\\epsilon=\\sqrt{36.16}$，其十进制值四舍五入到三位有效数字为 $6.01$ 埃。", "answer": "$$\\boxed{6.01}$$", "id": "1475179"}, {"introduction": "在真实的生物学数据分析中，区分有意义的生物信号和实验产生的伪影至关重要。这个思想实验模拟了一个常见的场景：显微镜的机械振动导致数据中出现了一个虚假的周期性模式。通过计算这个由伪影产生的“环”的持续性（persistence），你将学会TDA如何捕捉周期性特征，并理解为何对分析结果的来源进行批判性评估是如此重要。[@problem_id:1475165]", "problem": "一位生物学家正在使用高分辨率显微镜观察一个荧光标记的细胞器，已知该细胞器在一个固定的细胞内是静止的。然而，由于成像装置中存在持续的低频机械振动，所记录的细胞器位置会随时间漂移。这种伪影运动的轨迹恰好是一个以细胞器真实位置（我们可将其定义为原点 $(0, 0)$）为中心、半径为 $A$ 的圆。该振动的周期为 $T$。\n\n为研究此现象，该生物学家拍摄了一系列图像，在 $N$ 个离散且等间隔的时间点 $t_k = k(T/N)$（其中 $k = 0, 1, \\dots, N-1$）记录了细胞器的表观 $(x, y)$ 位置，这些时间点恰好覆盖了振动的一个完整周期。我们假设 $N$ 是一个大整数。\n\n然后，使用一种受拓扑数据分析（TDA）启发的方法来分析这 $N$ 个数据点所组成的集合。该分析通过连接欧几里得距离小于或等于一个增长阈值 $\\epsilon$ 的任意两点，从点云中构建一个形状。当阈值 $\\epsilon$ 刚好大到足以连接时间序列中所有相邻的数据点，从而形成一个闭合的边环时，一个“1-环”（一个循环）就“诞生”了。当这个1-环所包围的孔被填充时，它被认为“死亡”。确保这个特定的圆形孔洞被填充的关键事件，发生在 $\\epsilon$ 达到某个值时，在该值下，首次能够用来自数据云的三个最大分离点构成一个三角形。\n\n这个伪影环的“持续性”定义为其死亡阈值与诞生阈值之差，即 $\\text{Persistence} = \\epsilon_{\\text{death}} - \\epsilon_{\\text{birth}}$。计算这个伪影1-环的持续性。在计算诞生阈值时，你可以假设 $N$ 足够大，以至于对于小 $\\theta$，小角度近似 $\\sin(\\theta) \\approx \\theta$ 成立。请用 $A$ 和 $N$ 表示你的答案，形式为解析表达式。鉴于 $A$ 的单位是微米，请以微米为单位提供你的答案。", "solution": "我们将表观位置建模为位于以原点为中心、半径为 $A$ 的圆上的 $N$ 个等间隔的点。设第 $k$ 个点的极角为 $\\theta_k = \\frac{2\\pi k}{N}$，因此其坐标为 $(A\\cos\\theta_k, A\\sin\\theta_k)$。\n\n诞生阈值：当边的长度刚好足以将每个点与其在时间上的直接相邻点连接起来，形成一个闭合的多边形环路时，我们称1-环诞生。圆上相邻点之间的欧几里得距离对应于圆心角为 $\\Delta = \\frac{2\\pi}{N}$ 的弦。弦长为：\n$$\n\\epsilon_{\\text{birth}} = 2A\\sin\\left(\\frac{\\Delta}{2}\\right) = 2A\\sin\\left(\\frac{\\pi}{N}\\right)\n$$\n根据给定的假设，$N$ 很大，并在诞生阈值的计算中使用小角度近似 $\\sin(\\theta)\\approx \\theta$（对于小 $\\theta$），我们得到：\n$$\n\\epsilon_{\\text{birth}} \\approx 2A\\left(\\frac{\\pi}{N}\\right)\n$$\n\n死亡阈值：在 Vietoris–Rips 构造中，当一个 2-单纯形（三角形）的三个顶点之间的所有两两距离都至多为 $\\epsilon$ 时，该单纯形被包含在内。题目指出，确保圆形孔洞被填充发生在 $\\epsilon$ 值达到某个点时，在该点，首次能用来自数据云的三个最大分离点构成一个三角形。对于圆上的三个点，使最小的两两距离最大化的构型是当它们以 $120^{\\circ}$ 等间隔分开时，即由 $\\frac{2\\pi}{3}$ 的圆心角分隔。圆心角为 $\\frac{2\\pi}{3}$ 的弦长对应的半角为 $\\frac{\\pi}{3}$，因此：\n$$\n\\epsilon_{\\text{death}} = 2A\\sin\\left(\\frac{\\pi}{3}\\right) = \\sqrt{3}\\,A\n$$\n\n持续性：根据定义，\n$$\n\\text{Persistence} = \\epsilon_{\\text{death}} - \\epsilon_{\\text{birth}} \\approx \\sqrt{3}\\,A - 2A\\left(\\frac{\\pi}{N}\\right) = \\left(\\sqrt{3} - \\frac{2\\pi}{N}\\right)A\n$$\n由于 $A$ 的单位是微米，所以该表达式的单位是微米。", "answer": "$$\\boxed{\\left(\\sqrt{3}-\\frac{2\\pi}{N}\\right)A}$$", "id": "1475165"}, {"introduction": "发现一个拓扑特征只是第一步，更关键的问题是：这个特征是真实生物过程的体现，还是仅仅是随机噪声的产物？本练习介绍了一种强大的统计学方法——置换检验（permutation test），用于评估TDA结果的统计显著性。你将学习如何通过构建一个零假设下的分布，来计算观测到的拓扑特征（例如基因表达数据中的细胞周期环）的p值，这是将TDA应用于科学发现的关键环节。[@problem_id:1475171]", "problem": "一位系统生物学家正在研究一种新型真菌物种的细胞周期。他们进行了一项时间序列转录组学实验，在 $M$ 个等间距的时间点测量了 $N$ 个基因的表达水平。实验所得数据可以表示为一个大小为 $N \\times M$ 的矩阵 $E$，其中条目 $E_{ij}$ 对应于基因 $i$ 在时间点 $j$ 的表达量。该矩阵的 $M$ 个列向量中的每一列都代表了系统在特定时间点的状态。\n\n为了分析该过程的整体结构，该生物学家首先对数据进行降维。他们将 $E$ 矩阵的 $M$ 个列向量视为 $N$ 维空间中的点，并使用主成分分析 (PCA) 将这 $M$ 个点投影到一个三维空间中。在得到的三维点云上，他们通过构建一个 Vietoris-Rips 过滤来进行拓扑数据分析 (TDA)。分析揭示了一个单一且非常显著的一维拓扑特征（一个“环”）。该特征的持续性，即其在过滤中的“死亡”尺度与“诞生”尺度之差，被测量为 $P_{obs}$。\n\n该生物学家假设这个环是周期性细胞周期的一个统计显著特征，而不是随机噪声造成的假象。为检验此假设，他们进行了一项基于置换的统计检验。该检验通过对原始数据进行置换来生成 $K$ 个代理数据集。对于这 $K$ 个代理数据集中的每一个，都采用完全相同的分析流程（先进行 PCA，然后进行 TDA），并记录任何一维特征的最大持续性。设从这 $K$ 个代理数据集中获得的最大持续性值集合为 $\\{P_1, P_2, \\dots, P_K\\}$。\n\n假设该置换方案被正确设计，能够在破坏数据时间顺序的同时保留其其他统计特性，请提供单侧 p 值的计算公式。该 p 值代表在不存在真实时间结构的原假设下，观测到一个持续性至少与 $P_{obs}$ 一样大的环的概率。在您的公式中，使用符号 $N(C)$ 来表示集合 $\\{P_k\\}_{k=1}^K$ 中满足条件 $C$ 的元素数量。例如，集合中大于某个值 $\\alpha$ 的持续性值的数量可以写为 $N(P_k > \\alpha)$。为防止在没有代理持续性值超过观测值的情况下 p 值为零，应在比例的分子和分母上都加上一个标准的伪计数 1。", "solution": "我们将该假设检验形式化如下。定义检验统计量为分析流程所产生的最大一维持续性。令观测到的统计量为 $T_{obs} = P_{obs}$。对于在原假设下生成的 $K$ 个代理数据集中的每一个，计算相同的统计量以获得集合 $\\{P_k\\}_{k=1}^K$，其中每个 $P_k$ 是来自第 $k$ 个代理数据集的最大一维持续性。\n\n用于检验观测到的环持续性是否至少与原假设下的期望值一样大的单侧 p 值，由经验超越概率给出，并且在分子和分母上都加上一个伪计数 1，以避免 p 值为零，并反映出将观测数据集本身也视为一种可能的置换。使用符号 $N(C)$ 表示集合 $\\{P_k\\}_{k=1}^K$ 中满足条件 $C$ 的元素计数，则 p 值为：\n$$\np = \\frac{1 + N\\left(P_k \\ge P_{obs}\\right)}{K + 1}\n$$\n该公式计算了所有不小于观测统计量的代理统计量的数量（通过 $\\ge$ 处理相等的情况），在分子上加上一个伪计数 1，然后用包括观测数据在内的总数据集数量 $K+1$ 进行归一化。", "answer": "$$\\boxed{\\frac{1 + N\\left(P_k \\ge P_{obs}\\right)}{K + 1}}$$", "id": "1475171"}]}