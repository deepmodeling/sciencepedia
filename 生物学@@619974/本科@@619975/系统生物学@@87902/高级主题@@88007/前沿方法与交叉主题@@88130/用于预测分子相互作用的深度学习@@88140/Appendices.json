{"hands_on_practices": [{"introduction": "将生物实体转化为计算机可以理解的语言——数字，是应用深度学习解决生物学问题的第一步，这个过程被称为特征工程。本练习将通过一个具体例子，指导你如何利用氨基酸的基本理化性质，为其创建一个简单的数值“指纹”或特征向量，并引入数据归一化这一至关重要的数据预处理步骤。通过这项实践，你将掌握将定性生物信息转化为定量数据的核心技能。[@problem_id:1426736]", "problem": "在生物信息学领域，机器学习模型常用于预测蛋白质的结构和功能。此过程中的一个关键首要步骤，是将氨基酸等定性生物实体转换为计算机可以处理的定量数值表示。这种转换被称为特征工程。\n\n您的任务是根据特定氨基酸的一些基本物理化学性质，为其创建一个数值特征向量。我们为您提供了一小组氨基酸的以下数据：\n\n| 氨基酸 | 符号 | 疏水性 (Kyte-Doolittle 标度) | 分子量 (Da) | pH 7.4 下的净电荷 |\n| :--- | :---: | :---: | :---: | :---: |\n| 丙氨酸 | A | 1.8 | 89.1 | 0 |\n| 甘氨酸 | G | -0.4 | 75.1 | 0 |\n| 亮氨酸 | L | 3.8 | 131.2 | 0 |\n| 赖氨酸 | K | -3.9 | 146.2 | +1 |\n| 谷氨酸 | E | -3.5 | 147.1 | -1 |\n\n为确保每个属性对模型有公平的贡献，并将所有值归入一个共同的范围，您必须对每个属性应用最小-最大归一化。值 $x$ 的最小-最大归一化公式为：\n\n$$x_{\\text{norm}} = \\frac{x - x_{\\min}}{x_{\\max} - x_{\\min}}$$\n\n其中 $x_{\\min}$ 和 $x_{\\max}$ 是指该特定属性在表格提供的整个数据集中的最小值和最大值。\n\n使用表格中的数据，计算 **谷氨酸 (E)** 的三维归一化特征向量。该向量应为 $[v_1, v_2, v_3]$ 的形式，其中 $v_1$ 是归一化疏水性，$v_2$ 是归一化分子量，$v_3$ 是归一化净电荷。\n\n请将您的答案表示为一个无量纲的行向量。向量的每个数值分量四舍五入至三位有效数字。", "solution": "目标是使用所提供的数据和最小-最大归一化公式，计算谷氨酸 (E) 的归一化特征向量。该特征向量包含三个分量：归一化疏水性 ($v_1$)、归一化分子量 ($v_2$) 和归一化净电荷 ($v_3$)。\n\n**第 1 步：确定谷氨酸 (E) 的各项值。**\n从表格中可知，谷氨酸的属性如下：\n- 疏水性, $x_{\\text{hydro}}$ = -3.5\n- 分子量, $x_{\\text{mw}}$ = 147.1 Da\n- 净电荷, $x_{\\text{charge}}$ = -1\n\n**第 2 步：从整个数据集中确定每个属性的最小值和最大值。**\n\n**对于疏水性：**\n- 各值为：1.8, -0.4, 3.8, -3.9, -3.5。\n- 最小值, $x_{\\text{hydro, min}} = -3.9$ (来自赖氨酸)。\n- 最大值, $x_{\\text{hydro, max}} = 3.8$ (来自亮氨酸)。\n\n**对于分子量：**\n- 各值为：89.1, 75.1, 131.2, 146.2, 147.1。\n- 最小值, $x_{\\text{mw, min}} = 75.1$ (来自甘氨酸)。\n- 最大值, $x_{\\text{mw, max}} = 147.1$ (来自谷氨酸)。\n\n**对于净电荷：**\n- 各值为：0, 0, 0, +1, -1。\n- 最小值, $x_{\\text{charge, min}} = -1$ (来自谷氨酸)。\n- 最大值, $x_{\\text{charge, max}} = +1$ (来自赖氨酸)。\n\n**第 3 步：对谷氨酸的每个属性应用最小-最大归一化公式。**\n\n**分量 1：归一化疏水性 ($v_1$)**\n使用公式 $x_{\\text{norm}} = (x - x_{\\min}) / (x_{\\max} - x_{\\min})$：\n$$v_1 = \\frac{x_{\\text{hydro}} - x_{\\text{hydro, min}}}{x_{\\text{hydro, max}} - x_{\\text{hydro, min}}} = \\frac{-3.5 - (-3.9)}{3.8 - (-3.9)} = \\frac{0.4}{7.7}$$\n$$v_1 \\approx 0.05194805...$$\n四舍五入到三位有效数字，得到 $v_1 = 0.0519$。\n\n**分量 2：归一化分子量 ($v_2$)**\n$$v_2 = \\frac{x_{\\text{mw}} - x_{\\text{mw, min}}}{x_{\\text{mw, max}} - x_{\\text{mw, min}}} = \\frac{147.1 - 75.1}{147.1 - 75.1} = \\frac{72.0}{72.0} = 1$$\n该值恰好为 1。为了表示为三位有效数字，我们将其写为 $v_2 = 1.00$。\n\n**分量 3：归一化净电荷 ($v_3$)**\n$$v_3 = \\frac{x_{\\text{charge}} - x_{\\text{charge, min}}}{x_{\\text{charge, max}} - x_{\\text{charge, min}}} = \\frac{-1 - (-1)}{1 - (-1)} = \\frac{0}{2} = 0$$\n该值恰好为 0。为了使其精度与其他分量（两位小数）保持一致，我们将其写为 $v_3 = 0.00$。这种表示法包含一位有效数字（最后一个零），但这是在此上下文中表示精确零的标准方式。\n\n**第 4 步：组装最终的特征向量。**\n谷氨酸 (E) 的归一化特征向量为 $[v_1, v_2, v_3]$。\n代入计算并四舍五入后的值：\n$$[0.0519, 1.00, 0.00]$$\n按要求，结果以行向量的形式呈现。", "answer": "$$\\boxed{\\begin{pmatrix} 0.0519 & 1.00 & 0.00 \\end{pmatrix}}$$", "id": "1426736"}, {"introduction": "一旦我们为蛋白质准备好了特征向量，下一步就是设计一个能够处理这些向量的深度学习模型。本练习旨在揭开前馈神经网络（FNN）的神秘面纱，它将引导你计算一个简单网络架构中的可训练参数总数。这项实践有助于你具体地理解模型复杂度的来源，以及网络结构与其学习能力之间的直接关系。[@problem_id:1426734]", "problem": "一个计算生物学团队正在设计一个简单的前馈神经网络 (FNN)，用于预测两种蛋白质（蛋白质A和蛋白质B）是否会相互作用。该模型的设计如下：\n\n1.  **输入表示：** 每种蛋白质由一个长度为 $D$ 的数值特征向量来表征。对于此模型，$D=50$。神经网络的输入是通过将蛋白质A的特征向量与蛋白质B的特征向量拼接成一个更大的向量而形成的。\n\n2.  **网络架构：** 该网络有一个输入层、两个隐藏层和一个输出层。\n    *   第一个隐藏层包含 $H_1 = 128$ 个神经元。\n    *   第二个隐藏层包含 $H_2 = 64$ 个神经元。\n    *   输出层由单个神经元组成，其产生一个与相互作用概率相关的值。\n\n3.  **连接性：** 网络在连续层之间是全连接的。隐藏层和输出层中的每个神经元都有一个相关联的可训练偏置项。\n\n根据此架构，计算整个网络中可训练参数的总数（即所有权重和偏置的总和）。", "solution": "输入是由两个长度为 $D$ 的向量拼接而成，所以输入维度为 $I=2D$。\n\n对于一个从 $n_{\\text{in}}$ 个输入映射到 $n_{\\text{out}}$ 个输出且带偏置的全连接层，其可训练参数的数量等于 $n_{\\text{in}} n_{\\text{out}} + n_{\\text{out}}$ （权重加上偏置）。\n\n将此应用于每一层：\n- 输入层到第一个隐藏层：$n_{\\text{in}} = I = 2D$，$n_{\\text{out}} = H_{1}$。参数数量：$(2D)H_{1} + H_{1} = (2D+1)H_{1}$。\n- 第一个隐藏层到第二个隐藏层：$n_{\\text{in}} = H_{1}$，$n_{\\text{out}} = H_{2}$。参数数量：$H_{1}H_{2} + H_{2} = (H_{1}+1)H_{2}$。\n- 第二个隐藏层到输出层：$n_{\\text{in}} = H_{2}$，$n_{\\text{out}} = 1$。参数数量：$H_{2}\\cdot 1 + 1 = H_{2}+1$。\n\n因此，可训练参数的总数为\n$$\nP = (2D+1)H_{1} + (H_{1}+1)H_{2} + (H_{2}+1).\n$$\n代入 $D=50$，$H_{1}=128$，$H_{2}=64$：\n$$\nP = (2\\cdot 50 + 1)\\cdot 128 + (128+1)\\cdot 64 + (64+1).\n$$\n计算每一项：\n$$\n(100+1)\\cdot 128 = 101\\cdot 128 = 12928,\n$$\n$$\n(128+1)\\cdot 64 = 129\\cdot 64 = 8256,\n$$\n$$\n64+1 = 65.\n$$\n求和：\n$$\nP = 12928 + 8256 + 65 = 21249.\n$$", "answer": "$$\\boxed{21249}$$", "id": "1426734"}, {"introduction": "构建并训练模型后，最关键的步骤是评估其性能。在许多现实世界的生物学问题中（如药物筛选），数据集往往存在严重的类别不平衡。本练习将阐明在这种情况下，为何像准确率 $Accuracy$ 这样的标准指标会产生误导，并强调使用精确率 $Precision$ 和召回率 $Recall$ 等更精细的指标来真实评估模型实用价值的重要性。[@problem_id:1426729]", "problem": "在一个计算药物发现项目中，一名研究员训练了一个图神经网络（GNN）来执行虚拟筛选。其目标是从一个大型分子库中识别出哪些分子是“活性”的，即它们很可能与一个特定的靶蛋白结合。\n\n该模型在一个包含 1,000,000 个候选分子的数据集上进行了测试。在该数据集中，根据先前的实验工作可知，有 100 个分子是活性分子，其余 999,900 个是非活性分子。\n\n运行筛选后，GNN的预测得出以下结果：\n- 在 100 个实际活性分子中，模型正确识别了 80 个。\n- 在 999,900 个实际非活性分子中，模型将 1,920 个错误地识别为活性分子。\n\n基于这些信息，请执行以下任务：\n1.  计算模型的准确率（accuracy），即所有预测中正确预测的比例。\n2.  对于“活性”类别，计算模型的精确率（precision，即预测为阳性的样本中实际为阳性的比例）和召回率（recall，即实际为阳性的样本中被正确识别的比例）。\n3.  在虚拟筛选的背景下，主要目标是找到稀有的活性化合物，同时尽量减少对假阳性样本进行不必要的后续实验。请结合计算出的指标和数据集的严重类别不平衡问题，评估该模型的性能。\n\n以下哪个陈述对该模型的性能提供了最准确的评估，并为该任务提出了最佳的评估策略？\n\nA. 模型的准确率极高，表明其整体性能优异，并且适合用于识别活性化合物。\n\nB. 由于大量的真阴性样本，模型的准确率具有误导性。精确率-召回率曲线下面积（AUPRC）会是一个信息量更大的指标，因为它能更好地说明在不平衡数据集中，在找到活性化合物和避免假阳性之间的权衡。\n\nC. 模型的召回率很高，但其精确率极低。因此，该模型是无用的，因为一个有用的模型必须同时具备高精确率和高召回率。准确率仍然是快速总结性能的最佳单一指标。\n\nD. 准确率和AUPRC的信息量相同。它们之间的选择仅取决于用户对特定性能分数的偏好。\n\nE. 模型的性能很差，其低精确率就表明了这一点。在这种情况下，一个更好的衡量指标是F1分数，因为AUPRC过于复杂难以解读，并且只有在精确率很高时才有用。", "solution": "根据问题描述定义混淆矩阵的各个条目。真阳性（$TP$）的数量为 $80$，因为模型在 $100$ 个实际活性分子中正确识别了 $80$ 个。假阴性（$FN$）的数量为 $100-80=20$。在 $999{,}900$ 个实际非活性分子中，模型将 $1{,}920$ 个预测为活性，这些是假阳性（$FP$），因此 $FP=1{,}920$。因此，真阴性（$TN$）的数量为 $TN=999{,}900-1{,}920=997{,}980$。样本总数为 $N=1{,}000{,}000$。\n\n准确率定义为正确预测的比例：\n$$\n\\text{Accuracy}=\\frac{TP+TN}{N}=\\frac{80+997{,}980}{1{,}000{,}000}=\\frac{998{,}060}{1{,}000{,}000}=0.99806.\n$$\n\n对于活性类别，精确率是预测为阳性的样本中实际为阳性的比例，召回率是实际为阳性的样本中被正确识别的比例。根据定义，\n$$\n\\text{Precision}=\\frac{TP}{TP+FP}=\\frac{80}{80+1{,}920}=\\frac{80}{2{,}000}=0.04,\n$$\n$$\n\\text{Recall}=\\frac{TP}{TP+FN}=\\frac{80}{80+20}=\\frac{80}{100}=0.8.\n$$\n\n在具有严重类别不平衡的虚拟筛选背景下解释这些结果：准确率 $0.99806$ 主要受大量真阴性样本的主导，因此在评估模型发现稀有活性分子并同时控制假阳性的能力方面具有误导性。召回率 $0.8$ 表明模型找回了大部分实际的活性分子，但精确率 $0.04$ 非常低，这意味着存在大量的假阳性，并会导致后续实验资源的巨大浪费。需要一种能够捕捉在不同阈值下识别活性分子与限制假阳性之间权衡的评估方法；精确率-召回率曲线及其曲线下面积（AUPRC）特别适用于不平衡问题，并且比准确率能更直接地反映这种权衡。因此，最准确的评估和最合适的评估策略在选项B中得到了陈述。", "answer": "$$\\boxed{B}$$", "id": "1426729"}]}