{"hands_on_practices": [{"introduction": "我们将从持久同调最基本的构件——构建过滤（filtration）——开始。本练习将指导您把一组代表蛋白质位置的简单数据点，转化为一系列演变中的几何形状（单纯复形）。通过这个过程，您将亲眼见证当我们改变观察尺度 $ \\epsilon $ 时，拓扑特征如连通分支（由贝蒂数 $ \\beta_0 $ 量化）和环（由 $ \\beta_1 $ 量化）是如何“诞生”与“消亡”的。[@problem_id:1457473]", "problem": "在系统生物学中，拓扑数据分析被用于研究细胞内分子的空间组织。考虑一个简化模型，其中四个关键信号蛋白的位置已通过超分辨率显微技术确定。这些蛋白质被标记为 P1、P2、P3 和 P4，在二维平面中被视作点，其坐标如下（单位：纳米，nm）：\n- P1: (0, 0)\n- P2: (3, 0)\n- P3: (0, 4)\n- P4: (3, 4)\n\n为了分析这些蛋白质的聚类情况，我们可以构建一个称为 Vietoris-Rips 过滤的单纯复形序列。单纯复形是点（0-单纯形）、连接点对的边（1-单纯形）、连接点三元组的填充三角形（2-单纯形）及其高维对应物的集合。\n\n对于给定的距离阈值 $\\epsilon$，Vietoris-Rips (VR) 复形按如下方式构建：一组 $k+1$ 个蛋白质位置构成一个 $k$-单纯形，当且仅当该组中任意两个位置之间的欧几里得距离小于或等于 $\\epsilon$。该过滤是通过逐渐增加 $\\epsilon$ 所生成的 VR 复形序列。\n\n过滤中每个复形的拓扑结构可以通过其贝蒂数来表征。就我们的目的而言，我们关心的是：\n- $\\beta_0$：复形中连通分量的数量。\n- $\\beta_1$：复形中一维环或“孔”的数量。\n\n对于三个特定的过滤值 $\\epsilon_1 = 3.2 \\text{ nm}$，$\\epsilon_2 = 4.2 \\text{ nm}$ 和 $\\epsilon_3 = 5.2 \\text{ nm}$，请确定在每个步骤中生成的 Vietoris-Rips 复形的贝蒂数 $\\beta_0$ 和 $\\beta_1$。\n\n请将您的六个结果按 $(\\beta_0(\\epsilon_1), \\beta_1(\\epsilon_1), \\beta_0(\\epsilon_2), \\beta_1(\\epsilon_2), \\beta_0(\\epsilon_3), \\beta_1(\\epsilon_3))$ 的顺序以单行矩阵的形式提供。", "solution": "问题要求计算由四个点在三个不同距离阈值 $\\epsilon$ 下构建的 Vietoris-Rips (VR) 复形的贝蒂数 $\\beta_0$ 和 $\\beta_1$。这四个点是 P1(0, 0)、P2(3, 0)、P3(0, 4) 和 P4(3, 4)。\n\n首先，我们计算所有点之间的两两欧几里得距离。令 $d(Pi, Pj)$ 为蛋白质 $i$ 和蛋白质 $j$ 之间的距离。\n- $d(P1, P2) = \\sqrt{(3-0)^2 + (0-0)^2} = \\sqrt{9} = 3$\n- $d(P1, P3) = \\sqrt{(0-0)^2 + (4-0)^2} = \\sqrt{16} = 4$\n- $d(P1, P4) = \\sqrt{(3-0)^2 + (4-0)^2} = \\sqrt{9+16} = \\sqrt{25} = 5$\n- $d(P2, P3) = \\sqrt{(0-3)^2 + (4-0)^2} = \\sqrt{9+16} = \\sqrt{25} = 5$\n- $d(P2, P4) = \\sqrt{(3-3)^2 + (4-0)^2} = \\sqrt{16} = 4$\n- $d(P3, P4) = \\sqrt{(3-0)^2 + (4-4)^2} = \\sqrt{9} = 3$\n\n唯一的距离集合是 $\\{3, 4, 5\\}$。根据 VR 复形的定义，如果两点之间的距离 $d$ 小于或等于距离阈值 $\\epsilon$，则它们之间存在一条边（1-单纯形）。如果三点之间的所有三个两两距离都 $\\le \\epsilon$，则这三点构成一个三角形（2-单纯形）。\n\n**步骤 1：对 $\\epsilon_1 = 3.2$ nm 进行分析**\n\n形成单纯形的条件是 $d \\le \\epsilon_1 = 3.2$。\n我们检查哪些两两距离满足此条件：\n- $d(P1, P2) = 3 \\le 3.2$ (形成边 P1-P2)\n- $d(P3, P4) = 3 \\le 3.2$ (形成边 P3-P4)\n- 所有其他距离（4 和 5）都大于 3.2。\n\n在 $\\epsilon_1=3.2$ 处的复形由四个顶点（0-单纯形）和两条边（1-单纯形）{P1, P2} 和 {P3, P4} 组成。\n- 为了求 $\\beta_0$，我们计算连通分量的数量。这些点形成两个独立的分量：一个包含 {P1, P2}，另一个包含 {P3, P4}。因此，$\\beta_0(\\epsilon_1) = 2$。\n- 为了求 $\\beta_1$，我们寻找一维的孔（环）。该复形中没有环。因此，$\\beta_1(\\epsilon_1) = 0$。\n\n**步骤 2：对 $\\epsilon_2 = 4.2$ nm 进行分析**\n\n形成单纯形的条件是 $d \\le \\epsilon_2 = 4.2$。\n我们检查哪些两两距离满足此条件：\n- 距离为 3：$d(P1, P2)$ 和 $d(P3, P4)$ 均 $\\le 4.2$。\n- 距离为 4：$d(P1, P3)$ 和 $d(P2, P4)$ 均 $\\le 4.2$。\n- 距离为 5：$d(P1, P4)$ 和 $d(P2, P3)$ 均 $> 4.2$。\n\n形成的边是 (P1, P2)、(P3, P4)、(P1, P3) 和 (P2, P4)。\n- 为了求 $\\beta_0$，我们检查连通性。边 (P1, P3) 连接了上一步中的两个分量。例如，P1 与 P3 相连，P3 与 P4 相连，P4 又（通过 P1 和 P3）与 P2 相连。所有四个点现在都在一个连通分量中。因此，$\\beta_0(\\epsilon_2) = 1$。\n- 为了求 $\\beta_1$，我们寻找孔。这四条边形成一个环：P1-P3-P4-P2-P1。这是一个潜在的一维孔。如果这个环不是一个 2-单纯形（三角形）集合的边界，那么孔就存在。我们需要检查是否有任何三角形形成。\n    - 三角形 {P1, P2, P3}？需要 $d(P2, P3) = 5$，大于 4.2。不形成。\n    - 三角形 {P1, P3, P4}？需要 $d(P1, P4) = 5$，大于 4.2。不形成。\n    - 三角形 {P1, P2, P4}？需要 $d(P1, P4) = 5$，大于 4.2。不形成。\n    - 三角形 {P2, P4, P3}？需要 $d(P2, P3) = 5$，大于 4.2。不形成。\n由于没有形成 2-单纯形，这个环没有被填充。它代表一个真正的一维孔。因此，$\\beta_1(\\epsilon_2) = 1$。\n\n**步骤 3：对 $\\epsilon_3 = 5.2$ nm 进行分析**\n\n形成单纯形的条件是 $d \\le \\epsilon_3 = 5.2$。\n我们检查哪些两两距离满足此条件：\n- 距离为 3、4 和 5 的所有点对距离都 $\\le 5.2$。\n这意味着所有可能的点对都由一条边连接。该图是完全图 $K_4$。\n- 由于图是连通的，$\\beta_0(\\epsilon_3) = 1$。\n- 为了求 $\\beta_1$，我们检查上一步中的孔是否已被填充。我们寻找 2-单纯形。\n    - 三角形 {P1, P2, P3}：距离为 {3, 4, 5}。都 $\\le 5.2$。此 2-单纯形形成。\n    - 三角形 {P1, P3, P4}：距离为 {4, 5, 3}。都 $\\le 5.2$。此 2-单纯形形成。\n    - 三角形 {P2, P4, P3}：距离为 {4, 5, 3}。都 $\\le 5.2$。此 2-单纯形形成。\n    - 三角形 {P1, P2, P4}：距离为 {3, 5, 4}。都 $\\le 5.2$。此 2-单纯形形成。\n上一步中的环 P1-P3-P4-P2-P1 现在被填充了。例如，这个环可以看作是两个三角形 {P1, P3, P4} 和 {P1, P4, P2} 并集的边界。由于该环现在是 2-链（2-单纯形的和）的边界，它在同调中不再代表一个孔。实际上，这四个点以及它们所有的连接边和面构成了一个四面体（一个 3-单纯形），它是可收缩的并且没有孔。因此，$\\beta_1(\\epsilon_3) = 0$。\n\n结果总结：\n- 对于 $\\epsilon_1 = 3.2$：$(\\beta_0, \\beta_1) = (2, 0)$\n- 对于 $\\epsilon_2 = 4.2$：$(\\beta_0, \\beta_1) = (1, 1)$\n- 对于 $\\epsilon_3 = 5.2$：$(\\beta_0, \\beta_1) = (1, 0)$\n\n要求的最终答案是行矩阵 $(\\beta_0(\\epsilon_1), \\beta_1(\\epsilon_1), \\beta_0(\\epsilon_2), \\beta_1(\\epsilon_2), \\beta_0(\\epsilon_3), \\beta_1(\\epsilon_3))$。\n这对应于 $(2, 0, 1, 1, 1, 0)$。", "answer": "$$\\boxed{\\begin{pmatrix} 2 & 0 & 1 & 1 & 1 & 0 \\end{pmatrix}}$$", "id": "1457473"}, {"introduction": "计算拓扑特征只是成功的一半，解读结果才是关键。本练习使用了一个持久性条形码（persistence barcode），这是拓扑数据分析的一种常见输出，它源于一个细胞集落的生长模型。您的任务是利用条形码中的“诞生”与“消亡”时间信息，来确定在特定空间尺度下存在多少个独立的细胞簇，从而学会将抽象的条形码转化为具体的生物学洞见。[@problem_id:1457508]", "problem": "一位系统生物学家正在使用拓扑数据分析（Topological Data Analysis, TDA）的方法来分析一个发育中的细胞集落的空间组织结构。在某个特定时间点，单个细胞的位置被记录下来。为了理解其聚类行为，计算了第0阶同调群（$H_0$）的持久性条形码。这个条形码追踪了当“连通性半径”$\\epsilon$增加时，连通分支（细胞簇）的形成与合并过程。\n\n条形码中的每个条都由一对值 $(\\epsilon_{\\text{birth}}, \\epsilon_{\\text{death}})$ 表示，其中：\n- $\\epsilon_{\\text{birth}}$ 是一个新的、孤立的簇出现的半径。在此分析中，单个细胞从一开始就存在，因此所有主要分支的 $\\epsilon_{\\text{birth}} = 0$。\n- $\\epsilon_{\\text{death}}$ 是该簇与另一个更早形成的簇合并，从而作为一个独立的连通分支“消亡”时的半径。\n\n有一个分支，代表所有细胞都连接起来后的整个集落，它会无限期地存在。这由一个无穷大的消亡时间表示。\n\n该生物学家获得了以下（生成，消亡）对的集合，其中半径 $\\epsilon$ 的单位是微米（$\\mu$m）：\n`{(0, 1.2), (0, 4.5), (0, 2.8), (0, 9.1), (0, 0.7), (0, 3.6), (0, infinity)}`\n\n根据这些持久性数据，当连通性半径恰好为 $\\epsilon = 3.0$ $\\mu$m时，存在多少个不同的细胞簇？", "solution": "我们分析 $H_{0}$ 持久性条形码，其中每个连通分支由一个区间 $(\\epsilon_{\\text{birth}}, \\epsilon_{\\text{death}})$ 表示。在给定的尺度 $\\epsilon$ 下，连通分支的数量等于其区间包含 $\\epsilon$ 的条的数量，按照惯例，一个条在 $\\epsilon_{\\text{birth}} \\le \\epsilon < \\epsilon_{\\text{death}}$ 期间是“存活”的，因为该分支在 $\\epsilon = \\epsilon_{\\text{death}}$ 时因并入一个更早形成的分支而消亡。\n\n形式上，在尺度 $\\epsilon$ 下的簇的数量为\n$$\nN(\\epsilon) = \\left|\\left\\{i : \\epsilon_{\\text{birth},i} \\le \\epsilon < \\epsilon_{\\text{death},i}\\right\\}\\right|.\n$$\n鉴于所有主要分支的 $\\epsilon_{\\text{birth}} = 0$，该公式简化为\n$$\nN(\\epsilon) = \\left|\\left\\{i : \\epsilon < \\epsilon_{\\text{death},i}\\right\\}\\right|.\n$$\n\n给出的消亡时间为 $\\{0.7, 1.2, 2.8, 3.6, 4.5, 9.1, \\infty\\}$。在 $\\epsilon = 3.0$ 时，那些 $\\epsilon_{\\text{death}} \\le 3.0$ 的分支已经消亡，而那些 $\\epsilon_{\\text{death}} > 3.0$ 的分支仍然存活。大于 $3.0$ 的消亡时间是 $3.6$、$4.5$、$9.1$ 和 $\\infty$。因此，\n$$\nN(3.0) = 4.\n$$\n因此，在 $\\epsilon = 3.0$ 时，有 $4$ 个不同的簇。", "answer": "$$\\boxed{4}$$", "id": "1457508"}, {"introduction": "现在，让我们将这些概念应用于一个更动态、更复杂的流行病学数据集，其中病例在时间与空间上同时被追踪。本练习将使用一种不同的距离度量方式（切比雪夫距离）来分析流行病病例的聚集情况。通过计算病例簇的“总持久性”（total persistence），您将学习如何从爆发的早期阶段量化其整体结构，这是区分不同传播模式的关键一步。[@problem_id:1457477]", "problem": "一位流行病学家正在分析一种新型病毒的初期传播，以理解其传播动力学。数据包含最初五个确诊病例，记录了它们的空间位置和症状发作时间。为简化模型，空间位置由沿一条交通走廊的单一坐标 $x$（单位为公里）表示，时间 $t$ 从第一次观测开始以天为单位进行测量。这五个病例（标记为 $P_1$ 到 $P_5$）由以下 $(x, t)$ 坐标给出：\n$P_1 = (1, 2)$\n$P_2 = (3, 1)$\n$P_3 = (10, 8)$\n$P_4 = (8, 10)$\n$P_5 = (6, 6)$\n\n为了量化这些病例的聚集程度，您将对该数据集进行持续同调分析。任意两个病例 $P_i=(x_i, t_i)$ 和 $P_j=(x_j, t_j)$ 之间的“距离”使用切比雪夫距离（或最大范数）定义，由 $d(P_i, P_j) = \\max(|x_i - x_j|, |t_i - t_j|)$ 给出。\n\n分析侧重于0维同调特征（$H_0$），其对应于连通分支。这个过程称为过滤，具体如下：\n1.  在过滤值 $\\epsilon = 0$ 时，五个数据点中的每一个都被视为一个独立的连通分支。这些分支中每一个的“诞生”时间都是 0。\n2.  随着过滤值 $\\epsilon$ 的增加，如果 $d(P_i, P_j) \\le \\epsilon$，则认为任意两点 $P_i$ 和 $P_j$ 之间存在一条边。\n3.  当一条新边连接了两个先前不连通的分支时，它们会合并。为保持清晰的谱系，应用一个标准规则：与索引较高的点关联的分支并入与索引较低的点关联的分支。例如，如果一条边连接了包含 $P_3$ 的分支和包含 $P_5$ 的分支，则 $P_5$ 的分支“消亡”，并与 $P_3$ 的分支合并。消亡分支的“消亡”时间是发生合并时的 $\\epsilon$ 值。\n4.  一个分支，即与最终合并集合中索引最低的点关联的分支，将永不消亡。它的持续性是无穷大的。\n\n一个分支的持续性定义为其消亡时间减去其诞生时间。计算总持续性，即所有具有有限生命周期的分支的持续性之和。请以天为单位表示最终答案。", "solution": "给定平面上的五个点，其坐标为 $(x,t)$，以及切比雪夫距离\n$$\nd(P_{i},P_{j})=\\max\\left(|x_{i}-x_{j}|,\\;|t_{i}-t_{j}|\\right).\n$$\n我们分析由该距离诱导的 Vietoris–Rips 过滤下的 $H_{0}$ 持续性：当 $d(P_{i},P_{j})\\leq \\epsilon$ 时，边出现；当一条边连接两个先前不连通的分支时，连通分支合并。每个分支在 $\\epsilon=0$ 时诞生，当两个分支合并时，与索引较高的点关联的分支消亡；一个分支（与最终分支集合中索引最低的点关联）永远存在。总持续性是所有消亡分支（即除了最终存活的分支之外的所有分支）的消亡时间之和。\n\n首先计算所有点对之间的切比雪夫距离：\n- $P_{1}=(1,2)$ 和 $P_{2}=(3,1)$ 之间：\n$$\nd(P_{1},P_{2})=\\max(|1-3|,|2-1|)=\\max(2,1)=2.\n$$\n- $P_{1}=(1,2)$ 和 $P_{3}=(10,8)$ 之间：\n$$\nd(P_{1},P_{3})=\\max(|1-10|,|2-8|)=\\max(9,6)=9.\n$$\n- $P_{1}=(1,2)$ 和 $P_{4}=(8,10)$ 之间：\n$$\nd(P_{1},P_{4})=\\max(|1-8|,|2-10|)=\\max(7,8)=8.\n$$\n- $P_{1}=(1,2)$ 和 $P_{5}=(6,6)$ 之间：\n$$\nd(P_{1},P_{5})=\\max(|1-6|,|2-6|)=\\max(5,4)=5.\n$$\n- $P_{2}=(3,1)$ 和 $P_{3}=(10,8)$ 之间：\n$$\nd(P_{2},P_{3})=\\max(|3-10|,|1-8|)=\\max(7,7)=7.\n$$\n- $P_{2}=(3,1)$ 和 $P_{4}=(8,10)$ 之间：\n$$\nd(P_{2},P_{4})=\\max(|3-8|,|1-10|)=\\max(5,9)=9.\n$$\n- $P_{2}=(3,1)$ 和 $P_{5}=(6,6)$ 之间：\n$$\nd(P_{2},P_{5})=\\max(|3-6|,|1-6|)=\\max(3,5)=5.\n$$\n- $P_{3}=(10,8)$ 和 $P_{4}=(8,10)$ 之间：\n$$\nd(P_{3},P_{4})=\\max(|10-8|,|8-10|)=\\max(2,2)=2.\n$$\n- $P_{3}=(10,8)$ 和 $P_{5}=(6,6)$ 之间：\n$$\nd(P_{3},P_{5})=\\max(|10-6|,|8-6|)=\\max(4,2)=4.\n$$\n- $P_{4}=(8,10)$ 和 $P_{5}=(6,6)$ 之间：\n$$\nd(P_{4},P_{5})=\\max(|8-6|,|10-6|)=\\max(2,4)=4.\n$$\n\n按 $\\epsilon$（距离）递增的顺序对潜在的边进行排序：\n- $\\epsilon=2$：边 $(1,2)$ 和 $(3,4)$。\n- $\\epsilon=4$：边 $(3,5)$ 和 $(4,5)$。\n- $\\epsilon=5$：边 $(1,5)$ 和 $(2,5)$。\n- $\\epsilon=7$：边 $(2,3)$。\n- $\\epsilon=8$：边 $(1,4)$。\n- $\\epsilon=9$：边 $(1,3)$ 和 $(2,4)$。\n\n现在运行过滤过程，当一条边首次连接两个先前不连通的分支时合并它们，并应用“长者”（较低索引）规则来确定哪个分支消亡：\n- 在 $\\epsilon=0$ 时：五个分支 $\\{1\\}$, $\\{2\\}$, $\\{3\\}$, $\\{4\\}$, $\\{5\\}$，全部在 $0$ 时诞生。\n- 在 $\\epsilon=2$ 时：\n  - 边 $(1,2)$ 连接 $\\{1\\}$ 和 $\\{2\\}$。较低的索引是 $1$，所以 $2$ 的分支在 $\\epsilon=2$ 时消亡，剩下以 $1$ 为代表的 $\\{1,2\\}$。\n  - 边 $(3,4)$ 连接 $\\{3\\}$ 和 $\\{4\\}$。较低的索引是 $3$，所以 $4$ 的分支在 $\\epsilon=2$ 时消亡，剩下以 $3$ 为代表的 $\\{3,4\\}$。\n  当前分支：$\\{1,2\\}$（代表 $1$），$\\{3,4\\}$（代表 $3$），$\\{5\\}$（代表 $5$）。\n- 在 $\\epsilon=4$ 时：\n  - 边 $(3,5)$ 连接 $\\{3,4\\}$ 和 $\\{5\\}$。代表 $3$ 和 $5$ 之间较低的索引是 $3$，所以 $5$ 的分支在 $\\epsilon=4$ 时消亡，剩下以 $3$ 为代表的 $\\{3,4,5\\}$。\n  - 边 $(4,5)$ 是冗余的（两者已在同一分支中），因此没有影响。\n  当前分支：$\\{1,2\\}$（代表 $1$），$\\{3,4,5\\}$（代表 $3$）。\n- 在 $\\epsilon=5$ 时：\n  - 边 $(1,5)$ 连接 $\\{1,2\\}$（代表 $1$）和 $\\{3,4,5\\}$（代表 $3$）。较低的索引是 $1$，所以以 $3$ 为代表的分支在 $\\epsilon=5$ 时消亡，并入以 $1$ 为代表的分支。现在所有的点都在一个以 $1$ 为代表的分支 $\\{1,2,3,4,5\\}$ 中。\n  - 边 $(2,5)$ 是冗余的，因为图已经连通。\n- 对于更大的 $\\epsilon$，任何增加的边都连接已在单一分支中的点；不会有更多的消亡发生。由点 $1$ 代表的分支永远存在。\n\n因此，有限生命周期（持续性）如下：\n- $2$ 的分支：在 $2$ 消亡；持续性 $2-0=2$。\n- $4$ 的分支：在 $2$ 消亡；持续性 $2-0=2$。\n- $5$ 的分支：在 $4$ 消亡；持续性 $4-0=4$。\n- $3$ 的分支：在 $5$ 消亡；持续性 $5-0=5$。\n$1$ 的分支具有无穷大的持续性，不计入总和。\n\n因此，总持续性（有限生命周期的总和）是\n$$\n2+2+4+5=13.\n$$\n根据此类过滤下的 $H_{0}$ 持续性理论，这个总和也等于点集的最小生成树的总权重（边的权重由切比雪夫距离给出），在这里是 $2+2+4+5=13$，这证实了结果。\n\n最终答案，以天为单位，是 $13$。", "answer": "$$\\boxed{13}$$", "id": "1457477"}]}