{"hands_on_practices": [{"introduction": "决策树是机器学习中一种直观且强大的分类工具，它模仿人类的决策过程。本练习将带你体验构建决策树的核心步骤：通过计算信息增益来选择最具预测能力的特征。在这个以药物基因组学为背景的假设场景中，你将学会如何量化单个核苷酸多态性（SNP）对药物反应分类的重要性，这是生物信息学中一项基本技能。[@problem_id:1443753]", "problem": "在一项药物基因组学研究中，研究人员正在调查遗传变异对患者新药反应的影响。他们收集了10名患者的数据，重点关注三个特定的双等位基因单核苷酸多态性（SNPs），即DNA序列中单个位置的变异。对于每个SNP，其等位基因由0或1表示。每位患者的药物反应被分为'高'或'低'两类。\n\n数据集如下所示：\n\n| 患者ID | SNP1 | SNP2 | SNP3 | 药物反应 |\n|------------|------|------|------|---------------|\n| 1          | 0    | 0    | 1    | 低           |\n| 2          | 1    | 0    | 0    | 低           |\n| 3          | 0    | 0    | 1    | 高          |\n| 4          | 1    | 0    | 0    | 低           |\n| 5          | 0    | 1    | 1    | 高          |\n| 6          | 1    | 1    | 0    | 高          |\n| 7          | 0    | 1    | 1    | 高          |\n| 8          | 1    | 1    | 0    | 高          |\n| 9          | 0    | 0    | 1    | 低           |\n| 10         | 1    | 1    | 1    | 低           |\n\n为了建立一个预测模型，研究人员选用了决策树算法。第一步是选择信息量最大的SNP作为决策树的根节点。这需要通过计算每个SNP的信息增益来确定。\n\n计算为药物反应分类提供最多信息的那个SNP的信息增益。您的计算应使用以2为底的对数。将您的最终答案四舍五入到三位有效数字。", "solution": "我们对药物反应 $Y \\in \\{\\text{High}, \\text{Low}\\}$ 和特征 $A \\in \\{\\text{SNP1, SNP2, SNP3}\\}$（其值为二进制值 $v \\in \\{0,1\\}$）进行建模。一个具有概率 $p$ 和 $1-p$ 的二元分布的熵（使用以2为底的对数）为\n$$\nH(Y) = -\\sum_{y} P(y)\\log_{2}P(y).\n$$\n特征 $A$ 的信息增益为\n$$\nIG(A) = H(Y) - \\sum_{v \\in \\{0,1\\}} P(A=v)\\,H(Y \\mid A=v),\n$$\n其中\n$$\nH(Y \\mid A=v) = -\\sum_{y} P(y \\mid A=v)\\log_{2}P(y \\mid A=v).\n$$\n\n从数据集中可知，有5个高反应和5个低反应，所以\n$$\nH(Y) = -\\left(\\frac{1}{2}\\log_{2}\\frac{1}{2} + \\frac{1}{2}\\log_{2}\\frac{1}{2}\\right) = 1.\n$$\n\n对于SNP1：其值分布为 $P(\\text{SNP1}=0)=\\frac{5}{10}$ 和 $P(\\text{SNP1}=1)=\\frac{5}{10}$。当 $\\text{SNP1}=0$ 时，类别计数为 高 3，低 2，可得\n$$\nH(Y \\mid \\text{SNP1}=0) = -\\frac{3}{5}\\log_{2}\\frac{3}{5} - \\frac{2}{5}\\log_{2}\\frac{2}{5}.\n$$\n当 $\\text{SNP1}=1$ 时，类别计数为 高 2，低 3，所以\n$$\nH(Y \\mid \\text{SNP1}=1) = -\\frac{2}{5}\\log_{2}\\frac{2}{5} - \\frac{3}{5}\\log_{2}\\frac{3}{5},\n$$\n该值与前面的熵相等。因此\n$$\nH(Y \\mid \\text{SNP1}) = \\frac{1}{2}\\left[-\\frac{3}{5}\\log_{2}\\frac{3}{5} - \\frac{2}{5}\\log_{2}\\frac{2}{5}\\right] + \\frac{1}{2}\\left[-\\frac{2}{5}\\log_{2}\\frac{2}{5} - \\frac{3}{5}\\log_{2}\\frac{3}{5}\\right]\n= -\\frac{3}{5}\\log_{2}\\frac{3}{5} - \\frac{2}{5}\\log_{2}\\frac{2}{5}.\n$$\n于是\n$$\nIG(\\text{SNP1}) = 1 - \\left[-\\frac{3}{5}\\log_{2}\\frac{3}{5} - \\frac{2}{5}\\log_{2}\\frac{2}{5}\\right].\n$$\n数值上，$H(Y \\mid \\text{SNP1}) \\approx 0.970950594$，所以 $IG(\\text{SNP1}) \\approx 0.029049406$。\n\n对于SNP2：其值分布为 $P(\\text{SNP2}=0)=\\frac{5}{10}$ 和 $P(\\text{SNP2}=1)=\\frac{5}{10}$。当 $\\text{SNP2}=0$ 时，类别计数为 高 1，低 4，所以\n$$\nH(Y \\mid \\text{SNP2}=0) = -\\frac{1}{5}\\log_{2}\\frac{1}{5} - \\frac{4}{5}\\log_{2}\\frac{4}{5}.\n$$\n当 $\\text{SNP2}=1$ 时，类别计数为 高 4，低 1，得到相同的熵。因此\n$$\nH(Y \\mid \\text{SNP2}) = -\\frac{1}{5}\\log_{2}\\frac{1}{5} - \\frac{4}{5}\\log_{2}\\frac{4}{5},\n$$\n且\n$$\nIG(\\text{SNP2}) = 1 - \\left[-\\frac{1}{5}\\log_{2}\\frac{1}{5} - \\frac{4}{5}\\log_{2}\\frac{4}{5}\\right].\n$$\n数值上，$H(Y \\mid \\text{SNP2}) \\approx 0.721928095$，所以 $IG(\\text{SNP2}) \\approx 0.278071905$。\n\n对于SNP3：其值分布为 $P(\\text{SNP3}=0)=\\frac{4}{10}$ 和 $P(\\text{SNP3}=1)=\\frac{6}{10}$。当 $\\text{SNP3}=0$ 时，类别计数为 高 2，低 2，所以\n$$\nH(Y \\mid \\text{SNP3}=0) = -\\frac{1}{2}\\log_{2}\\frac{1}{2} - \\frac{1}{2}\\log_{2}\\frac{1}{2} = 1.\n$$\n当 $\\text{SNP3}=1$ 时，类别计数为 高 3，低 3，所以\n$$\nH(Y \\mid \\text{SNP3}=1) = -\\frac{1}{2}\\log_{2}\\frac{1}{2} - \\frac{1}{2}\\log_{2}\\frac{1}{2} = 1.\n$$\n因此\n$$\nH(Y \\mid \\text{SNP3}) = \\frac{4}{10}\\cdot 1 + \\frac{6}{10}\\cdot 1 = 1,\n$$\n且\n$$\nIG(\\text{SNP3}) = 1 - 1 = 0.\n$$\n\n信息增益最大的SNP是SNP2，其信息增益为 $IG(\\text{SNP2}) \\approx 0.278071905$。四舍五入到三位有效数字得到 $0.278$。", "answer": "$$\\boxed{0.278}$$", "id": "1443753"}, {"introduction": "训练好的机器学习模型不仅能进行预测，还能作为探索生物系统动态的“数字孪生”。本练习将展示如何利用一个已训练的神经网络来模拟基因调控网络（GRN）。通过在模型中进行“计算机内”（in silico）基因敲除实验，你将学习如何量化系统对扰动的响应，并评估其整体稳健性，这是系统生物学中的一个核心概念。[@problem_id:1443740]", "problem": "一位系统生物学家训练了一个小型前馈神经网络 (NN)，用于为一个合成细菌内的核心基因调控网络 (GRN) 建模。该模型根据三个输入转录因子基因 $G_1$、$G_2$ 和 $G_3$ 的表达水平，预测两个输出基因 $G_4$ 和 $G_5$ 的稳态表达水平。\n\n该神经网络架构如下：\n- 一个输入层，包含3个神经元，代表基因 $G_1, G_2, G_3$ 的表达水平。设输入向量为 $x = [x_1, x_2, x_3]^T$。\n- 一个隐藏层，包含2个神经元。\n- 一个输出层，包含2个神经元，代表基因 $G_4, G_5$ 的表达水平。设输出向量为 $y = [y_1, y_2]^T$。\n\n从第 $k-1$ 层到第 $k$ 层的变换由 $y^{(k)} = f(W^{(k)}y^{(k-1)} + b^{(k)})$ 给出，其中 $y^{(0)} = x$，$W^{(k)}$ 是权重矩阵，$b^{(k)}$ 是偏置向量，$f$ 是逐元素激活函数。对于此网络，隐藏层和输出层的激活函数均为修正线性单元 (ReLU)，定义为 $f(z) = \\max(0, z)$。\n\n该网络训练好的参数如下：\n- **从输入层到隐藏层：**\n  权重矩阵 $W^{(1)} = \\begin{pmatrix} 1.0 & -1.2 & 0.4 \\\\ 0.5 & 0.8 & -2.0 \\end{pmatrix}$\n  偏置向量 $b^{(1)} = \\begin{pmatrix} -0.2 \\\\ 0.1 \\end{pmatrix}$\n- **从隐藏层到输出层：**\n  权重矩阵 $W^{(2)} = \\begin{pmatrix} 2.0 & 0.5 \\\\ -0.8 & 1.5 \\end{pmatrix}$\n  偏置向量 $b^{(2)} = \\begin{pmatrix} 0.1 \\\\ -0.3 \\end{pmatrix}$\n\n该细菌的“野生型”(WT)菌株的基线输入基因表达水平由向量 $x_{WT} = [1.5, 2.0, 0.5]^T$ 给出。\n\n为了评估该 GRN 的稳健性，您将进行一系列*in silico*基因敲除实验。基因 $G_i$ 的敲除通过将其对应的输入表达水平 $x_i$ 设为零来建模，同时保持其他输入处于其野生型水平。\n\n对于任何给定输入，总输出表达 $O$ 定义为输出基因表达水平之和：$O = y_1 + y_2$。由敲除基因 $G_i$ 引起的扰动 $P_i$ 定义为总输出表达的绝对相对变化：$P_i = \\frac{|O_{WT} - O_{KO,i}|}{O_{WT}}$，其中 $O_{WT}$ 是野生型输入的总输出，$O_{KO,i}$ 是基因 $G_i$ 敲除后的总输出。\n\n系统的总体稳健性 $R$ 定义为1减去所有可能的输入基因单基因敲除的平均扰动。\n\n计算该 GRN 模型的总体稳健性 $R$。将您的答案表示为一个无量纲值，并四舍五入到三位有效数字。", "solution": "对于任意输入 $x$ 的前馈计算过程如下：隐藏层预激活 $a^{(1)} = W^{(1)}x + b^{(1)}$，隐藏层激活 $h = f(a^{(1)})$，输出层预激活 $a^{(2)} = W^{(2)}h + b^{(2)}$，以及输出 $y = f(a^{(2)})$，其中 $f(z) = \\max(0, z)$ 逐元素应用。总输出为 $O = y_{1} + y_{2}$，敲除 $G_{i}$ 的扰动为 $P_{i} = \\frac{|O_{WT} - O_{KO,i}|}{O_{WT}}$，稳健性为 $R = 1 - \\frac{1}{3}\\sum_{i=1}^{3} P_{i}$。\n\n野生型输入 $x_{WT} = \\begin{pmatrix} 1.5 \\\\ 2.0 \\\\ 0.5 \\end{pmatrix}$：\n$$\nW^{(1)}x_{WT} = \\begin{pmatrix} 1.0(1.5) + (-1.2)(2.0) + 0.4(0.5) \\\\ 0.5(1.5) + 0.8(2.0) + (-2.0)(0.5) \\end{pmatrix}\n= \\begin{pmatrix} -0.7 \\\\ 1.35 \\end{pmatrix},\\quad\na^{(1)}_{WT} = \\begin{pmatrix} -0.7 \\\\ 1.35 \\end{pmatrix} + \\begin{pmatrix} -0.2 \\\\ 0.1 \\end{pmatrix} = \\begin{pmatrix} -0.9 \\\\ 1.45 \\end{pmatrix}.\n$$\n应用ReLU函数，得到 $h_{WT} = \\begin{pmatrix} 0 \\\\ 1.45 \\end{pmatrix}$。然后\n$$\nW^{(2)}h_{WT} = \\begin{pmatrix} 2.0(0) + 0.5(1.45) \\\\ (-0.8)(0) + 1.5(1.45) \\end{pmatrix}\n= \\begin{pmatrix} 0.725 \\\\ 2.175 \\end{pmatrix},\\quad\na^{(2)}_{WT} = \\begin{pmatrix} 0.725 \\\\ 2.175 \\end{pmatrix} + \\begin{pmatrix} 0.1 \\\\ -0.3 \\end{pmatrix} = \\begin{pmatrix} 0.825 \\\\ 1.875 \\end{pmatrix}.\n$$\n因此 $y_{WT} = \\begin{pmatrix} 0.825 \\\\ 1.875 \\end{pmatrix}$ 且 $O_{WT} = 0.825 + 1.875 = 2.7 = \\frac{27}{10}$。\n\n敲除 $G_{1}$：$x_{KO,1} = \\begin{pmatrix} 0 \\\\ 2.0 \\\\ 0.5 \\end{pmatrix}$。\n$$\nW^{(1)}x_{KO,1} = \\begin{pmatrix} 1.0(0) + (-1.2)(2.0) + 0.4(0.5) \\\\ 0.5(0) + 0.8(2.0) + (-2.0)(0.5) \\end{pmatrix}\n= \\begin{pmatrix} -2.2 \\\\ 0.6 \\end{pmatrix},\\quad\na^{(1)}_{KO,1} = \\begin{pmatrix} -2.2 \\\\ 0.6 \\end{pmatrix} + \\begin{pmatrix} -0.2 \\\\ 0.1 \\end{pmatrix} = \\begin{pmatrix} -2.4 \\\\ 0.7 \\end{pmatrix}.\n$$\nReLU函数给出 $h_{KO,1} = \\begin{pmatrix} 0 \\\\ 0.7 \\end{pmatrix}$。然后\n$$\nW^{(2)}h_{KO,1} = \\begin{pmatrix} 2.0(0) + 0.5(0.7) \\\\ (-0.8)(0) + 1.5(0.7) \\end{pmatrix}\n= \\begin{pmatrix} 0.35 \\\\ 1.05 \\end{pmatrix},\\quad\na^{(2)}_{KO,1} = \\begin{pmatrix} 0.35 \\\\ 1.05 \\end{pmatrix} + \\begin{pmatrix} 0.1 \\\\ -0.3 \\end{pmatrix} = \\begin{pmatrix} 0.45 \\\\ 0.75 \\end{pmatrix}.\n$$\n因此 $y_{KO,1} = \\begin{pmatrix} 0.45 \\\\ 0.75 \\end{pmatrix}$ 且 $O_{KO,1} = 0.45 + 0.75 = 1.2 = \\frac{12}{10}$。扰动为\n$$\nP_{1} = \\frac{|O_{WT} - O_{KO,1}|}{O_{WT}} = \\frac{\\left|\\frac{27}{10} - \\frac{12}{10}\\right|}{\\frac{27}{10}} = \\frac{\\frac{15}{10}}{\\frac{27}{10}} = \\frac{15}{27} = \\frac{5}{9}.\n$$\n\n敲除 $G_{2}$：$x_{KO,2} = \\begin{pmatrix} 1.5 \\\\ 0 \\\\ 0.5 \\end{pmatrix}$。\n$$\nW^{(1)}x_{KO,2} = \\begin{pmatrix} 1.0(1.5) + (-1.2)(0) + 0.4(0.5) \\\\ 0.5(1.5) + 0.8(0) + (-2.0)(0.5) \\end{pmatrix}\n= \\begin{pmatrix} 1.7 \\\\ -0.25 \\end{pmatrix},\\quad\na^{(1)}_{KO,2} = \\begin{pmatrix} 1.7 \\\\ -0.25 \\end{pmatrix} + \\begin{pmatrix} -0.2 \\\\ 0.1 \\end{pmatrix} = \\begin{pmatrix} 1.5 \\\\ -0.15 \\end{pmatrix}.\n$$\nReLU函数给出 $h_{KO,2} = \\begin{pmatrix} 1.5 \\\\ 0 \\end{pmatrix}$。然后\n$$\nW^{(2)}h_{KO,2} = \\begin{pmatrix} 2.0(1.5) + 0.5(0) \\\\ (-0.8)(1.5) + 1.5(0) \\end{pmatrix}\n= \\begin{pmatrix} 3.0 \\\\ -1.2 \\end{pmatrix},\\quad\na^{(2)}_{KO,2} = \\begin{pmatrix} 3.0 \\\\ -1.2 \\end{pmatrix} + \\begin{pmatrix} 0.1 \\\\ -0.3 \\end{pmatrix} = \\begin{pmatrix} 3.1 \\\\ -1.5 \\end{pmatrix}.\n$$\n因此 $y_{KO,2} = \\begin{pmatrix} 3.1 \\\\ 0 \\end{pmatrix}$ 且 $O_{KO,2} = 3.1 = \\frac{31}{10}$。扰动为\n$$\nP_{2} = \\frac{|O_{WT} - O_{KO,2}|}{O_{WT}} = \\frac{\\left|\\frac{27}{10} - \\frac{31}{10}\\right|}{\\frac{27}{10}} = \\frac{\\frac{4}{10}}{\\frac{27}{10}} = \\frac{4}{27}.\n$$\n\n敲除 $G_{3}$：$x_{KO,3} = \\begin{pmatrix} 1.5 \\\\ 2.0 \\\\ 0 \\end{pmatrix}$。\n$$\nW^{(1)}x_{KO,3} = \\begin{pmatrix} 1.0(1.5) + (-1.2)(2.0) + 0.4(0) \\\\ 0.5(1.5) + 0.8(2.0) + (-2.0)(0) \\end{pmatrix}\n= \\begin{pmatrix} -0.9 \\\\ 2.35 \\end{pmatrix},\\quad\na^{(1)}_{KO,3} = \\begin{pmatrix} -0.9 \\\\ 2.35 \\end{pmatrix} + \\begin{pmatrix} -0.2 \\\\ 0.1 \\end{pmatrix} = \\begin{pmatrix} -1.1 \\\\ 2.45 \\end{pmatrix}.\n$$\nReLU函数给出 $h_{KO,3} = \\begin{pmatrix} 0 \\\\ 2.45 \\end{pmatrix}$。然后\n$$\nW^{(2)}h_{KO,3} = \\begin{pmatrix} 2.0(0) + 0.5(2.45) \\\\ (-0.8)(0) + 1.5(2.45) \\end{pmatrix}\n= \\begin{pmatrix} 1.225 \\\\ 3.675 \\end{pmatrix},\\quad\na^{(2)}_{KO,3} = \\begin{pmatrix} 1.225 \\\\ 3.675 \\end{pmatrix} + \\begin{pmatrix} 0.1 \\\\ -0.3 \\end{pmatrix} = \\begin{pmatrix} 1.325 \\\\ 3.375 \\end{pmatrix}.\n$$\n因此 $y_{KO,3} = \\begin{pmatrix} 1.325 \\\\ 3.375 \\end{pmatrix}$ 且 $O_{KO,3} = 1.325 + 3.375 = 4.7 = \\frac{47}{10}$。扰动为\n$$\nP_{3} = \\frac{|O_{WT} - O_{KO,3}|}{O_{WT}} = \\frac{\\left|\\frac{27}{10} - \\frac{47}{10}\\right|}{\\frac{27}{10}} = \\frac{\\frac{20}{10}}{\\frac{27}{10}} = \\frac{20}{27}.\n$$\n\n三次敲除的平均扰动为\n$$\n\\overline{P} = \\frac{1}{3}\\left(\\frac{5}{9} + \\frac{4}{27} + \\frac{20}{27}\\right) = \\frac{1}{3}\\left(\\frac{15}{27} + \\frac{4}{27} + \\frac{20}{27}\\right) = \\frac{1}{3}\\cdot\\frac{39}{27} = \\frac{13}{27}.\n$$\n因此，稳健性为\n$$\nR = 1 - \\overline{P} = 1 - \\frac{13}{27} = \\frac{14}{27} \\approx 0.518518\\ldots\n$$\n四舍五入到三位有效数字，$R = 0.519$。", "answer": "$$\\boxed{0.519}$$", "id": "1443740"}, {"introduction": "复杂的机器学习模型（如深度神经网络）通常被视为“黑箱”，其预测过程难以理解，这限制了它们在临床决策等关键领域的应用。本练习将介绍一种强大的解释技术，类似于局部可解释模型无关解释（LIME）。你将通过构建一个简单的局部线性模型来解释一个复杂的“黑箱”对特定患者药物抗性的预测，从而揭示模型做出特定决策背后的基因特征。[@problem_id:1443750]", "problem": "一个计算生物学家团队开发了一个复杂的、非线性的“黑箱”机器学习模型，记为 $f(\\mathbf{x})$，用于预测患者的耐药性评分。该评分是一个连续值，数值越高表示耐药性越强。模型的输入 $\\mathbf{x} = (x_1, x_2)$ 是一个向量，代表了从患者肿瘤活检中提取的两个关键基因（Gene-1和Gene-2）的归一化表达水平。\n\n为了使模型的预测对临床医生来说是可解释的，该团队使用了一个局部代理模型。对于一个特定的患者，其基因表达向量为 $\\mathbf{x}_{\\text{pt}} = (10.0, 5.0)$，黑箱模型预测其耐药性评分为 $f(\\mathbf{x}_{\\text{pt}}) = 0.80$。为了解释这一预测，他们决定用一个简单的线性模型 $g(\\mathbf{z})$ 来近似 $f$ 在 $\\mathbf{x}_{\\text{pt}}$ 紧邻区域的行为。\n\n线性模型 $g(\\mathbf{z})$ 旨在解释黑箱模型输出与患者预测评分之间的偏差。其形式由下式给出：\n$$g(\\mathbf{z}) = f(\\mathbf{x}_{\\text{pt}}) + w_1 (z_1 - x_{\\text{pt},1}) + w_2 (z_2 - x_{\\text{pt},2})$$\n其中 $\\mathbf{z}=(z_1, z_2)$ 是 $\\mathbf{x}_{\\text{pt}}$ 邻域中的一个点，而 $w_1, w_2$ 是分别代表基因1和基因2局部重要性的权重。\n\n这些权重是通过执行加权线性回归找到的。在 $\\mathbf{x}_{\\text{pt}}$ 周围生成一组 $N$ 个合成数据点 $\\{\\mathbf{z}^{(i)}\\}_{i=1}^N$，并使用黑箱模型 $f$ 获得它们相应的耐药性评分 $\\{f(\\mathbf{z}^{(i)})\\}_{i=1}^N$。权重 $w_1$ 和 $w_2$ 是使加权平方误差和最小化的值：\n$$\\mathcal{L}(w_1, w_2) = \\sum_{i=1}^{N} \\pi_i \\left( f(\\mathbf{z}^{(i)}) - g(\\mathbf{z}^{(i)}) \\right)^2$$\n每个合成点 $\\mathbf{z}^{(i)}$ 的权重 $\\pi_i$ 由其与患者数据点 $\\mathbf{x}_{\\text{pt}}$ 的接近程度决定，使用指数核函数计算：\n$$\\pi_i = \\exp\\left(-\\frac{D(\\mathbf{x}_{\\text{pt}}, \\mathbf{z}^{(i)})^2}{\\sigma^2}\\right)$$\n其中 $D(\\mathbf{u}, \\mathbf{v})$是点 $\\mathbf{u}$ 和 $\\mathbf{v}$ 之间的标准欧几里得距离，核宽度 $\\sigma = 0.2$。\n\n该团队从黑箱模型中生成了以下三个合成数据点及其对应的分数：\n1.  $\\mathbf{z}^{(1)} = (10.1, 5.0)$，其 $f(\\mathbf{z}^{(1)}) = 0.75$\n2.  $\\mathbf{z}^{(2)} = (10.0, 5.1)$，其 $f(\\mathbf{z}^{(2)}) = 0.82$\n3.  $\\mathbf{z}^{(3)} = (9.9, 5.2)$，其 $f(\\mathbf{z}^{(3)}) = 0.85$\n\n你的任务是计算这两个基因的局部重要性权重 $w_1$ 和 $w_2$。请提供 $w_1$ 和 $w_2$ 的值作为答案，并四舍五入到三位有效数字。", "solution": "我们用以下公式来模拟与 $f(\\mathbf{x}_{\\text{pt}})$ 的局部偏差：\n$$g(\\mathbf{z})=f(\\mathbf{x}_{\\text{pt}})+w_{1}(z_{1}-x_{\\text{pt},1})+w_{2}(z_{2}-x_{\\text{pt},2}).$$\n对每个合成点 $\\mathbf{z}^{(i)}$，定义偏移量 $d x_{i}=z^{(i)}_{1}-x_{\\text{pt},1}$、$d y_{i}=z^{(i)}_{2}-x_{\\text{pt},2}$ 和目标 $y_{i}=f(\\mathbf{z}^{(i)})-f(\\mathbf{x}_{\\text{pt}})$。那么，加权最小二乘问题\n$$\\min_{w_{1},w_{2}}\\sum_{i=1}^{N}\\pi_{i}\\left(y_{i}-w_{1} d x_{i}-w_{2} d y_{i}\\right)^{2}$$\n的解为 $w=(w_{1},w_{2})^{\\top}=(X^{\\top}WX)^{-1}X^{\\top}Wy$，其中\n$$X=\\begin{pmatrix}d x_{1} & d y_{1}\\\\ d x_{2} & d y_{2}\\\\ d x_{3} & d y_{3}\\end{pmatrix},\\quad W=\\operatorname{diag}(\\pi_{1},\\pi_{2},\\pi_{3}),\\quad y=\\begin{pmatrix}y_{1}\\\\ y_{2}\\\\ y_{3}\\end{pmatrix}.$$\n根据数据，当 $\\mathbf{x}_{\\text{pt}}=(10.0,5.0)$ 且 $f(\\mathbf{x}_{\\text{pt}})=0.80$ 时，我们有：\n- $\\mathbf{z}^{(1)}=(10.1,5.0)$: $d x_{1}=0.1$, $d y_{1}=0$, $y_{1}=0.75-0.80=-0.05$.\n- $\\mathbf{z}^{(2)}=(10.0,5.1)$: $d x_{2}=0$, $d y_{2}=0.1$, $y_{2}=0.82-0.80=0.02$.\n- $\\mathbf{z}^{(3)}=(9.9,5.2)$: $d x_{3}=-0.1$, $d y_{3}=0.2$, $y_{3}=0.85-0.80=0.05$.\n\n核权重 $\\pi_{i}$ 使用公式 $\\pi_{i}=\\exp\\!\\left(-\\frac{D(\\mathbf{x}_{\\text{pt}},\\mathbf{z}^{(i)})^{2}}{\\sigma^{2}}\\right)$ 计算，其中 $\\sigma=0.2$，$D$ 为欧几里得距离。距离为\n$$D_{1}^{2}=0.1^{2}=0.01,\\quad D_{2}^{2}=0.1^{2}=0.01,\\quad D_{3}^{2}=(-0.1)^{2}+0.2^{2}=0.05.$$\n因此\n$$\\pi_{1}=\\pi_{2}=\\exp(-0.25),\\quad \\pi_{3}=\\exp(-1.25).$$\n令 $A=\\exp(-0.25)$ 且 $B=\\exp(-1.25)$。则\n$$X=\\begin{pmatrix}0.1 & 0\\\\ 0 & 0.1\\\\ -0.1 & 0.2\\end{pmatrix},\\quad W=\\operatorname{diag}(A,A,B),\\quad y=\\begin{pmatrix}-0.05\\\\ 0.02\\\\ 0.05\\end{pmatrix}.$$\n计算正规方程的各组成部分：\n$$S_{xx}=\\sum \\pi_{i} d x_{i}^{2}=0.01(A+B),\\quad S_{yy}=\\sum \\pi_{i} d y_{i}^{2}=0.01A+0.04B,\\quad S_{xy}=\\sum \\pi_{i} d x_{i} d y_{i}=-0.02B,$$\n$$b_{1}=\\sum \\pi_{i} d x_{i} y_{i}=-0.005(A+B),\\quad b_{2}=\\sum \\pi_{i} d y_{i} y_{i}=0.002A+0.01B.$$\n正规方程为\n$$\\begin{pmatrix}S_{xx} & S_{xy}\\\\ S_{xy} & S_{yy}\\end{pmatrix}\\begin{pmatrix}w_{1}\\\\ w_{2}\\end{pmatrix}=\\begin{pmatrix}b_{1}\\\\ b_{2}\\end{pmatrix},$$\n其行列式为\n$$\\Delta=S_{xx}S_{yy}-S_{xy}^{2}=0.0001A^{2}+0.0005AB=0.0001A(A+5B)>0.$$\n使用克莱姆法则（或 $2\\times 2$ 逆矩阵）可得：\n$$w_{1}=\\frac{b_{1}S_{yy}-b_{2}S_{xy}}{\\Delta}=-0.1\\cdot\\frac{5A+21B}{A+5B},\\qquad w_{2}=\\frac{S_{xx}b_{2}-S_{xy}b_{1}}{\\Delta}=0.2\\cdot\\frac{A+B}{A+5B}.$$\n由于 $B=A\\exp(-1)$，记 $r=\\exp(-1)$，这些表达式可简化为：\n$$w_{1}=-0.1\\cdot\\frac{5+21r}{1+5r},\\qquad w_{2}=0.2\\cdot\\frac{1+r}{1+5r}.$$\n当 $r=\\exp(-1)$ 时，其数值为：\n$$w_{1}\\approx -0.448175,\\qquad w_{2}\\approx 0.0963499.$$\n四舍五入到三位有效数字，得到：\n$$w_{1}\\approx -0.448,\\qquad w_{2}\\approx 0.0963.$$", "answer": "$$\\boxed{\\begin{pmatrix}-0.448 & 0.0963\\end{pmatrix}}$$", "id": "1443750"}]}