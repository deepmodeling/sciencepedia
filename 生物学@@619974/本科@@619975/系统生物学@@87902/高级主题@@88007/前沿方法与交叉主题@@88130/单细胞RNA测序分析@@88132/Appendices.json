{"hands_on_practices": [{"introduction": "任何严谨的单细胞分析都始于严格的质量控制。此练习将带你完成一个基本但至关重要的步骤：识别并过滤掉低质量细胞，以确保你的下游分析是基于健康、有代表性的细胞群体。我们将使用一个常用的指标——线粒体基因表达百分比——并应用统计学规则来设定一个客观的过滤阈值 [@problem_id:1465907]。", "problem": "在单细胞RNA测序 (scRNA-seq) 实验中，一个关键的质量控制步骤是过滤掉低质量的细胞。细胞健康状况不佳（例如应激或细胞膜破裂）的一个常见指标是源自线粒体的信使RNA (mRNA) 转录本所占的百分比异常高。健康、完整的细胞通常具有较低的线粒体基因表达百分比。\n\n一位生物信息学家分析了一个大的细胞群体，并总结了线粒体基因百分比的分布情况。统计摘要显示，该分布的第一个四分位数 (Q1) 为 3.5%，第三个四分位数 (Q3) 为 9.0%。\n\n为了客观地移除具有高线粒体含量的离群细胞，一种常见的统计方法是基于四分位距 (IQR) 来设定一个上限阈值。该规则将此阈值定义为 $Q3 + 1.5 \\times IQR$，其中 $IQR = Q3 - Q1$。任何线粒体基因百分比超过此阈值的细胞都将被视为低质量细胞，并从后续分析中移除。\n\n计算该过滤阈值的数值。将最终答案表示为小数形式，并四舍五入到三位有效数字。", "solution": "上限离群阈值由规则 $Q3 + 1.5 \\times IQR$ 定义，其中 $IQR = Q3 - Q1$。\n\n已知 $Q1 = 0.035$ 且 $Q3 = 0.090$，计算四分位距：\n$$\nIQR = Q3 - Q1 = 0.090 - 0.035 = 0.055.\n$$\n计算离群阈值：\n$$\n\\text{Threshold} = Q3 + 1.5 \\times IQR = 0.090 + 1.5 \\times 0.055 = 0.090 + 0.0825 = 0.1725.\n$$\n四舍五入到三位有效数字后，阈值为 $0.173$。", "answer": "$$\\boxed{0.173}$$", "id": "1465907"}, {"introduction": "在对细胞进行质量控制后，下一步通常是使用UMAP等降维技术对它们进行可视化和聚类。然而，解读这些图谱需要细致的理解。这个思想实验探讨了一个常见的情景：两个在UMAP图上靠得很近的细胞簇，却在基因表达上存在显著差异，这将挑战你对可视化结果与潜在生物学过程之间关系的理解 [@problem_id:1465887]。", "problem": "在单细胞基因组学领域，一名研究人员正在使用单细胞RNA测序技术分析一个免疫细胞数据集。使用的主要可视化工具是均匀流形逼近与投影（UMAP），它将高维的基因表达数据（每个细胞约20,000个基因的测量值）降维到一个二维图中。在这张图上，具有相似表达谱的细胞被分组到不同的细胞簇中。\n\n研究人员观察到两个不同的细胞簇，簇A和簇B，它们在UMAP图上紧密相邻，彼此之间只有很小的间隙。基于这种邻近性，最初的假设是这两个簇代表非常相似的细胞状态。然而，随后的簇A和簇B之间的差异基因表达分析显示，有超过500个基因的表达水平存在统计学上的显著差异（经过多重检验校正后）。\n\n鉴于这两个看似矛盾的结果——在UMAP图上位置邻近但存在大量差异表达基因——最可能的生物学解释是什么？\n\nA. 差异表达分析存在缺陷。UMAP图上簇的邻近性是高度生物学相似性的确凿证据，这意味着差异表达的基因应该非常少，甚至没有。\n\nB. 这两个簇代表功能上完全相同的细胞，数百个差异表达基因都是由单细胞数据固有的统计噪声导致的假阳性结果。\n\nC. UMAP算法失败并产生了一个误导性的可视化结果；这两个簇实际上是生物学上不相关的细胞类型，本应在图上相距很远。\n\nD. 这两个簇可能代表了一个连续生物学过程（如细胞分化或激活）中两个不同但密切相关的状态。UMAP的邻近性反映了它们在这个连续过程中的联系，而差异表达则突显了细胞从一个状态过渡到下一个状态时发生的活跃转录变化。\n\nE. 簇A和簇B中的细胞来自两个完全不同的、被错误混合的实验，观察到的差异纯粹是技术性假象。", "solution": "我们通过考虑UMAP的属性和单细胞RNA测序中差异表达的性质来解释这一明显的矛盾。\n\n首先，UMAP是一种非线性降维方法，旨在将高维空间中的局部邻域结构保留到二维空间中。UMAP图上的邻近性反映了细胞共享邻域或位于所学习到的流形的邻近区域；它不提供全局相似性的度量保证，也不提供转录距离的线性比例关系。因此，即使许多基因在发生变化，两个紧密相邻且间隙很小的簇也可能表明它们沿着一个连续的轨迹（例如，分化、激活或细胞周期进程）相连。\n\n其次，在单细胞数据中，差异表达分析通常会在密切相关的状态之间检测到许多具有统计学显著差异的基因，尤其是在细胞数量众多且多重检验得到适当控制的情况下。在一个生物学转变过程中，细胞可以经历广泛但协调的转录重编程，其中每个基因的变化可能不大但数量众多；这些变化的总和可以产生数百个显著基因，而这与UMAP上的邻近性并不矛盾。\n\n评估各个选项：\n- A是错误的，因为UMAP的邻近性并非高度生物学相似性（即最少差异表达）的确凿证据；它反映的是局部流形结构，沿着邻近的轨迹仍然可以有许多基因发生变化。\n- B是难以置信的，因为经过多重检验校正后的数百个显著基因不可能全部是假阳性；当得到适当控制时，单细胞分析方法通常会在相邻状态之间检测到大量的差异表达基因集。\n- C是不太可能的，因为UMAP完全失败并产生不相关类型相邻的可视化结果并非最简约的解释；此外，UMAP通常能保留局部连通性，而邻近性与共享流形比与完全不相关更一致。\n- D是最一致的解释：这些簇是连续过程（如分化或激活）中不同但密切相关的状态。UMAP的邻近性反映了连续性，而大量的差异表达基因集反映了转变过程中活跃的转录变化。\n- E意味着技术性混合或批次效应；这类假象通常会产生与技术协变量一致的分离，并且在质量控制中通常很明显。所描述的紧密邻近、间隙小以及生物学上连贯的差异表达，更符合真实的生物学连续过程，而不是纯粹的技术假象。\n\n因此，最可能的生物学解释是，这两个簇代表了一个连续过程中的相邻状态，而差异表达反映了这一转变背后的转录程序。", "answer": "$$\\boxed{D}$$", "id": "1465887"}, {"introduction": "单细胞分析的真正威力在于它能够揭示在不同细胞类型和条件下基因表达的复杂动态。这个练习将超越简单的两两比较，向你介绍如何使用线性模型来检验一个更精妙的生物学问题：一种药物对一种细胞类型的影响是否不同于它对另一种细胞类型的影响？通过构建和解释一个包含交互项 $x_{cond} x_{type}$ 的模型，你将学会一种量化基因-背景依赖性效应的强大方法 [@problem_id:1465892]。", "problem": "在一项系统生物学研究中，研究人员正在探究免疫系统对一种新药的反应。他们进行了一项单细胞RNA测序（scRNA-seq）实验，以测量从两组受试者（一个对照组和一个药物处理组）中分离出的两种不同细胞类型（细胞类型A和细胞类型B）的基因表达。\n\n对于一个特定的感兴趣基因，一位生物统计学家提出了一个线性模型来描述其期望的对数转换标准化表达量，记为 $E$。该模型使用两个指示变量 $x_{cond}$ 和 $x_{type}$ 以及一组系数 $\\beta_0, \\beta_c, \\beta_t, \\beta_{int}$，将 $E$ 与实验条件和细胞类型关联起来。\n\n该模型由以下方程给出：\n$$E = \\beta_0 + \\beta_c x_{cond} + \\beta_t x_{type} + \\beta_{int} x_{cond} x_{type}$$\n\n指示变量编码如下：\n- 对于实验条件：对照组 $x_{cond} = -1$，处理组 $x_{cond} = +1$。\n- 对于细胞类型：细胞类型A为 $x_{type} = -1$，细胞类型B为 $x_{type} = +1$。\n\n研究人员特别感兴趣的是那些药物在细胞类型B中的效果与在细胞类型A中不同的基因。为了量化这一点，他们希望计算一个“差异治疗效应”。这被定义为细胞类型B中由治疗引起的表达变化量，减去细胞类型A中由治疗引起的表达变化量。\n\n根据所提供的模型，推导出这个差异治疗效应关于模型系数的符号表达式。", "solution": "我们从以下线性模型开始：\n$$E=\\beta_{0}+\\beta_{c}x_{cond}+\\beta_{t}x_{type}+\\beta_{int}x_{cond}x_{type}.$$\n将固定细胞类型的治疗引起的变化定义为处理条件和对照条件之间的差异。设 $x_{type}=s$，其中 $s\\in\\{-1,+1\\}$ 分别代表细胞类型A和细胞类型B。那么\n$$E_{\\text{treated},s}=\\beta_{0}+\\beta_{c}(+1)+\\beta_{t}s+\\beta_{int}(+1)s=\\beta_{0}+\\beta_{c}+\\beta_{t}s+\\beta_{int}s,$$\n$$E_{\\text{control},s}=\\beta_{0}+\\beta_{c}(-1)+\\beta_{t}s+\\beta_{int}(-1)s=\\beta_{0}-\\beta_{c}+\\beta_{t}s-\\beta_{int}s.$$\n细胞类型 $s$ 的治疗效应是\n$$\\Delta(s)=E_{\\text{treated},s}-E_{\\text{control},s}=(\\beta_{0}+\\beta_{c}+\\beta_{t}s+\\beta_{int}s)-(\\beta_{0}-\\beta_{c}+\\beta_{t}s-\\beta_{int}s).$$\n消去共同项后得到\n$$\\Delta(s)=2\\beta_{c}+2\\beta_{int}s.$$\n对于细胞类型B，$s=+1$，因此 $\\Delta(+1)=2\\beta_{c}+2\\beta_{int}$。对于细胞类型A，$s=-1$，因此 $\\Delta(-1)=2\\beta_{c}-2\\beta_{int}$。差异治疗效应，定义为细胞类型B中的治疗效应减去细胞类型A中的治疗效应，即为\n$$\\Delta(+1)-\\Delta(-1)=(2\\beta_{c}+2\\beta_{int})-(2\\beta_{c}-2\\beta_{int})=4\\beta_{int}.$$\n因此，所求的表达式为 $4\\beta_{int}$。", "answer": "$$\\boxed{4\\beta_{int}}$$", "id": "1465892"}]}