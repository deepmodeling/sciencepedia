{"hands_on_practices": [{"introduction": "在从原始单细胞测序数据中推断生物学意义之前，一个至关重要的初始步骤是数据归一化。由于测序深度等技术差异，原始基因计数本身可能具有误导性。这个练习将指导你完成一项基本的数据处理任务，通过校正细胞间的文库大小差异来揭示真实的基因表达模式，这是任何轨迹推断分析的必要前提。[@problem_id:1475523]", "problem": "在系统生物学领域，单细胞RNA测序 (scRNA-seq) 是一项强大的技术，用于测量数千个单个细胞的基因表达谱。scRNA-seq 的一个常见应用是轨迹推断，其目的是通过分析细胞的基因表达模式，将它们沿着一个连续的生物学过程（如细胞分化）进行计算排序。这种排序创建了一个“伪时间”轴，代表了该过程的进展。\n\n一位研究人员从一个正在经历分化的细胞群体中收集了scRNA-seq数据。他们从这个群体中分离出了两个特定的细胞，Cell A 和 Cell B。这些细胞的原始数据包括每个基因的唯一分子标识符 (UMI) 的计数，该计数与最初存在的信使RNA分子的数量成正比。在一个细胞中计数的UMI总数被称为其“文库大小”，并且由于技术因素，细胞间的文库大小可能会有显著差异。\n\n已知该分化过程由两个关键的标记基因调控：\n1.  `Gene_Start`: 该基因在分化过程的开始阶段高表达，随着细胞的成熟其表达量逐渐降低。\n2.  `Gene_End`: 该基因在初始阶段低表达，随着细胞到达分化过程的末端其表达量逐渐增加。\n\n这两个细胞的原始UMI计数数据如下：\n\n*   **Cell A**:\n    *   总文库大小 (总UMI计数): 2,000\n    *   `Gene_Start` 的UMI计数: 200\n    *   `Gene_End` 的UMI计数: 10\n\n*   **Cell B**:\n    *   总文库大小 (总UMI计数): 10,000\n    *   `Gene_Start` 的UMI计数: 500\n    *   `Gene_End` 的UMI计数: 200\n\n根据这些数据和标记基因的已知作用，关于 Cell A 和 Cell B 在分化轨迹上的相对位置，最科学合理的结论是什么？\n\nA. Cell A 比 Cell B 处于分化过程的更早阶段。\n\nB. Cell B 比 Cell A 处于分化过程的更早阶段。\n\nC. 数据无法得出结论，因为 Cell B 两个标记基因的原始计数都更高，呈现出矛盾的生物学信号。\n\nD. 两个细胞很可能都处于稳定的终末分化状态，因为它们的表达谱无法以有意义的方式进行排序。\n\nE. 与 Cell B 相比，Cell A 的文库大小太小，无法得出任何可靠的结论。", "solution": "为了比较具有不同文库大小的细胞间的基因表达，应使用文库大小归一化。相关原理是比较每个细胞内各个基因的UMI所占的比例，其定义为\n$$\np_{g,c}=\\frac{\\text{细胞 }c\\text{ 中基因 }g\\text{ 的UMI计数}}{\\text{细胞 }c\\text{ 的总UMI计数（文库大小）}}.\n$$\n计算 Cell A 的归一化表达量：\n$$\np_{\\text{Gene\\_Start},A}=\\frac{200}{2000}=\\frac{1}{10},\\quad p_{\\text{Gene\\_End},A}=\\frac{10}{2000}=\\frac{1}{200}.\n$$\n计算 Cell B 的归一化表达量：\n$$\np_{\\text{Gene\\_Start},B}=\\frac{500}{10000}=\\frac{1}{20},\\quad p_{\\text{Gene\\_End},B}=\\frac{200}{10000}=\\frac{1}{50}.\n$$\n比较归一化后的值：\n$$\np_{\\text{Gene\\_Start},A}=\\frac{1}{10}>\\frac{1}{20}=p_{\\text{Gene\\_Start},B},\\quad p_{\\text{Gene\\_End},A}=\\frac{1}{200}<\\frac{1}{50}=p_{\\text{Gene\\_End},B}.\n$$\n根据所述标记基因的行为进行解读：`Gene_Start` 的相对表达量较高和 `Gene_End` 的相对表达量较低，表明其处于较早的伪时间位置；而 `Gene_Start` 的表达量较低和 `Gene_End` 的表达量较高，则表明其处于较晚的伪时间位置。因此，Cell A 在分化轨迹上比 Cell B 更早。\n\n这排除了其他选项：原始计数是矛盾的（归一化解决了这个问题），两个细胞都处于终末状态（相反的标记基因趋势表明了过程的进展），或者 Cell A 的文库大小使得无法进行推断（比例是可解释的）。", "answer": "$$\\boxed{A}$$", "id": "1475523"}, {"introduction": "许多轨迹推断方法通过构建一个细胞-细胞相似性图来表示潜在的发育路径。然而，这个图的构建过程可能会产生错误的连接，即“短路边”，错误地将早期祖细胞直接连接到终末状态的细胞。这个练习介绍了一种定量方法，通过计算“邻域不一致性分数”（NIS），来识别并评估这些可能存在的伪影，从而让你能够亲手实践如何“调试”和精炼推断出的细胞轨迹。[@problem_id:1475469]", "problem": "在单细胞转录组学领域，轨迹推断旨在根据基因表达数据的静态快照重建细胞的发育路径。一种常见的方法是构建一个k-最近邻（k-NN）图，其中每个细胞是一个节点，边连接表达谱相似的细胞。从这个图中，为每个细胞计算一个“伪时间”值，将它们沿着发育轨迹排序。当参数选择不佳时（例如邻居数 $k$），会出现一个关键挑战，即产生人为的“短路”边，这些边错误地将早期祖细胞直接连接到晚期终末细胞，绕过了中间状态。\n\n为了识别和修剪此类人为产物，需要一个量化指标。考虑细胞图中任意给定边 $(u, v)$ 的“邻域不一致性分数”（NIS）。其原理是，对于一条有效的边，细胞 $v$ 的伪时间应与细胞 $u$ 的其他邻居的伪时间一致，反之亦然。\n\nNIS 定义如下：对于一条边 $(u, v)$，设 $P_i$ 是细胞 $i$ 的预先计算好的伪时间。设 $N'(u)$ 是 $u$ 的邻居集合（不包括 $v$），$N'(v)$ 是 $v$ 的邻居集合（不包括 $u$）。设 $\\langle P \\rangle_{N'}$ 和 $\\sigma_{N'}$ 分别表示给定邻域集合内伪时间的均值和标准差。那么 NIS 由以下公式给出：\n\n$$ \\text{NIS}(u, v) = \\frac{1}{2} \\left( \\frac{|P_v - \\langle P \\rangle_{N'(u)}|}{\\sigma_{N'(u)}} + \\frac{|P_u - \\langle P \\rangle_{N'(v)}|}{\\sigma_{N'(v)}} \\right) $$\n\n您的任务是评估一条连接祖细胞 $c_A$ 和终末分化细胞 $c_B$ 的可疑边。相关的预计算值如下：\n\n- 细胞 $c_A$ 的伪时间：$P_A = 0.05$\n- 细胞 $c_B$ 的伪时间：$P_B = 0.95$\n- 对于 $c_A$ 的邻域（不包括 $c_B$）：$\\langle P \\rangle_{N'(A)} = 0.08$ 且 $\\sigma_{N'(A)} = 0.030$\n- 对于 $c_B$ 的邻域（不包括 $c_A$）：$\\langle P \\rangle_{N'(B)} = 0.91$ 且 $\\sigma_{N'(B)} = 0.040$\n\n计算边 $(c_A, c_B)$ 的邻域不一致性分数。将您的最终答案四舍五入到三位有效数字。", "solution": "我们使用给定的邻域不一致性分数定义：\n$$\n\\text{NIS}(u, v) = \\frac{1}{2} \\left( \\frac{|P_v - \\langle P \\rangle_{N'(u)}|}{\\sigma_{N'(u)}} + \\frac{|P_u - \\langle P \\rangle_{N'(v)}|}{\\sigma_{N'(v)}} \\right).\n$$\n对于边 $u=c_{A}$ 和 $v=c_{B}$，代入所提供的值：\n- $P_{A} = 0.05$, $P_{B} = 0.95$,\n- $\\langle P \\rangle_{N'(A)} = 0.08$, $\\sigma_{N'(A)} = 0.030$,\n- $\\langle P \\rangle_{N'(B)} = 0.91$, $\\sigma_{N'(B)} = 0.040$.\n\n计算每个标准化偏差项：\n$$\n\\frac{|P_{B} - \\langle P \\rangle_{N'(A)}|}{\\sigma_{N'(A)}} = \\frac{|0.95 - 0.08|}{0.030} = \\frac{0.87}{0.030} = 29,\n$$\n$$\n\\frac{|P_{A} - \\langle P \\rangle_{N'(B)}|}{\\sigma_{N'(B)}} = \\frac{|0.05 - 0.91|}{0.040} = \\frac{0.86}{0.040} = 21.5.\n$$\n将两项平均以获得 NIS：\n$$\n\\text{NIS}(c_{A}, c_{B}) = \\frac{1}{2}\\left(29 + 21.5\\right) = \\frac{50.5}{2} = 25.25.\n$$\n四舍五入到三位有效数字得到 $25.3$。", "answer": "$$\\boxed{25.3}$$", "id": "1475469"}, {"introduction": "在计算生物学中，算法的性能基准测试是验证其可靠性的核心环节。为了信任一个轨迹推断算法的结果，我们必须用一个已知“基准真相”的数据集来严格评估它。本练习将让你扮演算法开发者的角色，在一个模拟场景中，使用一个综合性能指标 $S$ 来量化一个新算法的准确性，该指标同时考虑了推断的细胞谱系拓扑结构和伪时间排序的正确性。[@problem_id:1475509]", "problem": "在系统生物学中，评估轨迹推断（TI）算法的性能至关重要。一种常见的方法是使用具有已知基准真相细胞分化路径的模拟数据。您的任务是使用预定义的复合度量来评估一种名为“PathFinder”的新型TI算法。\n\n基准真相的发育过程被建模为一个有向图，其中节点是不同的细胞簇，边代表它们之间的转换。真实的拓扑结构由四个细胞簇组成：一个祖细胞（P）、一个中间状态（I）、命运A（A）和命运B（B）。代表真实分化路径的基准真相边集为 $G_{true} = \\{(P, I), (I, A), (I, B)\\}$。\n\nPathFinder算法在模拟数据上运行，并推断出一个拓扑结构，其边集为 $G_{inferred} = \\{(P, I), (I, A), (P, B)\\}$。\n\nTI的一个关键方面也是细胞沿谱系的正确排序，这被称为伪时间。对于真实谱系 P $\\rightarrow$ I $\\rightarrow$ A，五个特定细胞的基准真相时间顺序由列表 $O_{true} = [c_1, c_2, c_3, c_4, c_5]$ 给出，其中列表中较早的位置表示较早的伪时间。PathFinder算法对这五个相同细胞推断出的顺序为 $O_{inferred} = [c_2, c_1, c_4, c_3, c_5]$。\n\n为了量化算法的性能，定义了一个综合得分 $S$，它是拓扑得分 ($S_{topo}$) 和伪时间得分 ($S_{pseudo}$) 的加权平均值：\n$$S = 0.6 \\cdot S_{topo} + 0.4 \\cdot S_{pseudo}$$\n\n拓扑得分 $S_{topo}$ 是根据边集计算出的F1分数。F1分数是精确率和召回率的调和平均数，其中，如果一条边同时存在于 $G_{true}$ 和 $G_{inferred}$ 中，则为真阳性（TP）；如果它存在于 $G_{inferred}$ 中但不存在于 $G_{true}$ 中，则为假阳性（FP）；如果它存在于 $G_{true}$ 中但不存在于 $G_{inferred}$ 中，则为假阴性（FN）。\n\n伪时间得分 $S_{pseudo}$ 仅针对被正确识别的谱系进行计算。它被定义为基准真相和推断的细胞排序之间的 Kendall's Tau-a 等级相关系数 ($\\tau_a$) 。对于一个包含 $n$ 个项目的列表，$\\tau_a$ 由以下公式给出：\n$$\\tau_a = \\frac{N_c - N_d}{\\frac{1}{2} n(n-1)}$$\n其中 $N_c$ 是一致对的数量，$N_d$ 是不一致对的数量。如果一对细胞在两个列表中的相对顺序相同，则它们是一致的；如果它们的相对顺序相反，则它们是不一致的。如果构成从起点到终点路径的所有边都是真阳性，那么该谱系就被认为是“正确识别的”。\n\n计算PathFinder算法的综合得分 $S$。将您的最终答案四舍五入到三位有效数字。", "solution": "识别拓扑结构的真阳性、假阳性和假阴性。基准真相的边为 $G_{true}=\\{(P,I),(I,A),(I,B)\\}$，推断的边为 $G_{inferred}=\\{(P,I),(I, A),(P,B)\\}$。因此，\n- 真阳性：$(P,I)$ 和 $(I,A)$，所以 $\\mathrm{TP}=2$。\n- 假阳性：$(P,B)$，所以 $\\mathrm{FP}=1$。\n- 假阴性：$(I,B)$，所以 $\\mathrm{FN}=1$。\n\n计算精确率和召回率：\n$$\\mathrm{Precision}=\\frac{\\mathrm{TP}}{\\mathrm{TP}+\\mathrm{FP}}=\\frac{2}{2+1}=\\frac{2}{3},\\quad \\mathrm{Recall}=\\frac{\\mathrm{TP}}{\\mathrm{TP}+\\mathrm{FN}}=\\frac{2}{2+1}=\\frac{2}{3}.$$\nF1分数是调和平均数：\n$$S_{topo}=\\frac{2\\cdot \\mathrm{Precision}\\cdot \\mathrm{Recall}}{\\mathrm{Precision}+\\mathrm{Recall}}=\\frac{2\\cdot \\frac{2}{3}\\cdot \\frac{2}{3}}{\\frac{2}{3}+\\frac{2}{3}}=\\frac{2}{3}.$$\n\n检查谱系 $P\\rightarrow I\\rightarrow A$ 是否被正确识别。它的边是 $(P,I)$ 和 $(I,A)$，两者都是真阳性，因此它被正确识别，并有资格进行伪时间评估。\n\n对于 $O_{true}=[c_{1},c_{2},c_{3},c_{4},c_{5}]$ 和 $O_{inferred}=[c_{2},c_{1},c_{4},c_{3},c_{5}]$，其中 $n=5$，计算 Kendall's $\\tau_{a}$，因此总对数为 $\\frac{1}{2}n(n-1)=10$。使用真实位置 $\\{c_{1}:1,c_{2}:2,c_{3}:3,c_{4}:4,c_{5}:5\\}$ 和推断位置 $\\{c_{2}:1,c_{1}:2,c_{4}:3,c_{3}:4,c_{5}:5\\}$，按真实顺序评估所有对：\n- $(c_{1},c_{2})$ 不一致；$(c_{1},c_{3})$ 一致；$(c_{1},c_{4})$ 一致；$(c_{1},c_{5})$ 一致；\n- $(c_{2},c_{3})$ 一致；$(c_{2},c_{4})$ 一致；$(c_{2},c_{5})$ 一致；\n- $(c_{3},c_{4})$ 不一致；$(c_{3},c_{5})$ 一致；$(c_{4},c_{5})$ 一致。\n\n因此 $N_{c}=8$ 且 $N_{d}=2$，得出\n$$S_{pseudo}=\\tau_{a}=\\frac{N_{c}-N_{d}}{\\frac{1}{2}n(n-1)}=\\frac{8-2}{10}=\\frac{6}{10}=0.6.$$\n\n将得分与给定的权重相结合：\n$$S=0.6\\cdot S_{topo}+0.4\\cdot S_{pseudo}=0.6\\cdot \\frac{2}{3}+0.4\\cdot 0.6=\\frac{3}{5}\\cdot \\frac{2}{3}+\\frac{2}{5}\\cdot \\frac{3}{5}=\\frac{2}{5}+\\frac{6}{25}=\\frac{10}{25}+\\frac{6}{25}=\\frac{16}{25}=0.64.$$\n四舍五入到三位有效数字，结果是 $0.640$。", "answer": "$$\\boxed{0.640}$$", "id": "1475509"}]}