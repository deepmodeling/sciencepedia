{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。要真正理解生物本体论（如基因本体论GO），关键在于掌握其底层的图结构。基因本体论（Gene Ontology, GO）被组织成一个有向无环图（Directed Acyclic Graph, DAG），其中每个节点代表一个生物学概念，边则代表它们之间的关系。本练习将引导你将GO本体论视为一个图，通过追踪术语之间的路径来计算它们之间的距离，这是功能富集分析和语义相似性计算等高级应用的核心技能。[@problem_id:1419513]", "problem": "基因本体论 (Gene Ontology, GO) 为我们关于基因和蛋白质功能的知识提供了一个结构化的、可计算的表示。它被组织成一个有向无环图 (DAG)，其中每个术语代表一个生物学概念，有向边代表从更具体的术语（子节点）到更一般的术语（父节点）的关系，例如`is_a`（是）或`part_of`（部分是）。\n\n考虑以下GO `biological_process`（生物学过程）本体论的一个简化子集，其中列出了每个术语的父节点。术语`biological_process` (GO:0008150) 是该层次结构的根节点，没有父节点。\n\n*   **术语 (ID): 父节点**\n*   'cellular_process' (GO:0009987): {'biological_process'}\n*   'metabolic_process' (GO:0008152): {'biological_process'}\n*   'cellular_component_organization' (GO:0016043): {'cellular_process'}\n*   'catabolic_process' (GO:0009056): {'cellular_process', 'metabolic_process'}\n*   'organelle_organization' (GO:0007031): {'cellular_component_organization'}\n*   'autophagy' (GO:0006914): {'catabolic_process'}\n*   'organelle_fission' (GO:0044594): {'organelle_organization'}\n*   'selective_autophagy' (GO:0043936): {'autophagy'}\n*   'mitochondrial_fission' (GO:0000266): {'organelle_fission'}\n*   'mitophagy' (GO:0000422): {'selective_autophagy'}\n\n对于本体论中的任意两个术语，我们可以定义一条路径，该路径向上遍历至一个共同祖先。两个术语之间的“最短路径长度”定义为：从第一个术语向上到其最特异共同祖先 (Most Specific Common Ancestor, MSCA) 的路径上的边数，与从第二个术语向上到同一MSCA的路径上的边数之和。\n\n最特异共同祖先 (MSCA) 是两个术语之间深度最大的共同祖先。一个术语的“深度”是指从根节点（`biological_process`）到该术语的最长可能路径上的边数。\n\n根据所提供的本体论结构，计算`mitophagy` (GO:0000422) 和`mitochondrial_fission` (GO:0000266) 之间的最短路径长度。", "solution": "我们首先将父节点关系列为向上边（从子节点到父节点）。对于每个被查询的术语，我们通过沿着父节点反复向上追溯至根节点，来枚举其所有祖先。\n\nmitophagy (GO:0000422)的祖先：\nmitophagy → selective_autophagy → autophagy → catabolic_process → {cellular_process, metabolic_process} → biological_process.\n因此，祖先集合为 $\\{\\text{mitophagy}, \\text{selective\\_autophagy}, \\text{autophagy}, \\text{catabolic\\_process}, \\text{cellular\\_process}, \\text{metabolic\\_process}, \\text{biological\\_process}\\}$。\n\nmitochondrial_fission (GO:0000266)的祖先：\nmitochondrial_fission → organelle_fission → organelle_organization → cellular_component_organization → cellular_process → biological_process.\n因此，祖先集合为 $\\{\\text{mitochondrial\\_fission}, \\text{organelle\\_fission}, \\text{organelle\\_organization}, \\text{cellular\\_component\\_organization}, \\text{cellular\\_process}, \\text{biological\\_process}\\}$。\n\n共同祖先是 $\\{\\text{cellular\\_process}, \\text{biological\\_process}\\}$。为了确定最特异共同祖先 (MSCA)，我们比较它们的深度，深度定义为从根节点 $\\text{biological\\_process}$ 到该术语的最长路径上的边数。我们有：\n- $\\text{depth}(\\text{biological\\_process}) = 0$。\n- $\\text{depth}(\\text{cellular\\_process}) = 1$。\n\n因此，MSCA是 $\\text{cellular\\_process}$。\n\n最短路径长度定义为从每个术语向上到MSCA的路径上的边数之和。计算这些向上距离：\n- 从 mitophagy 到 cellular_process: mitophagy → selective_autophagy (1) → autophagy (2) → catabolic_process (3) → cellular_process (4)，共 4 条边。\n- 从 mitochondrial_fission 到 cellular_process: mitochondrial_fission → organelle_fission (1) → organelle_organization (2) → cellular_component_organization (3) → cellular_process (4)，共 4 条边。\n\n将它们相加得出最短路径长度：\n$$4 + 4 = 8.$$", "answer": "$$\\boxed{8}$$", "id": "1419513"}, {"introduction": "在系统生物学中，我们经常使用通路富集分析来解读基因列表的功能。然而，当使用不同的数据库（如KEGG和Reactome）时，我们可能会得到看似不同但同样有效的结果。本练习旨在揭示这种现象背后的原因，即不同数据库在组织和定义生物学通路方面的哲学差异。通过分析一个具体的案例，你将学会批判性地解读生物信息学分析结果，并理解数据库的结构如何影响我们对生物学数据的诠释。[@problem_id:1419489]", "problem": "一名系统生物学的学生正在分析一个基因列表，该列表来自一个用新型药物化合物处理人类细胞培养物的实验，其中包含了差异表达的基因。为了理解其功能性影响，该学生使用了两个广泛使用的数据库——京都基因与基因组百科全书（KEGG）和 Reactome 数据库——对该基因列表进行了通路富集分析。\n\n使用 KEGG 数据库的分析将“Metabolism of xenobiotics by cytochrome P450”（细胞色素P450对外源性物质的代谢）确定为最显著富集的通路。与此相反，使用 Reactome 数据库的分析则报告“Phase I - Functionalization of compounds”（I相 - 化合物的功能化）为首要命中结果。这两个结果在统计上都是显著的，并且在生物学上也是合理的，因为“I相功能化”是已知的异源物代谢的一部分。该学生感到困惑，为什么对完全相同的基因列表进行的两次分析，会突出显示名称和概念范围都不同的通路作为首要结果。\n\n以下哪个陈述为这一观察结果提供了最准确和最根本的解释？\n\nA. Reactome 通路以精细粒度、分层的方式组织，代表特定的分子事件，而 KEGG 通路则被整理为更广泛、更通用的参考图谱。观察到的差异是因为学生的基因列表最显著地集中在 Reactome 将其作为一个独立通路分离出来的特定子过程中。\nB. KEGG 数据库的更新周期与 Reactome 数据库不同，且频率更低，这意味着其通路定义可能更旧，并且未能反映对异源物代谢的最新理解。\nC. 用于富集分析的底层统计检验方法根本不同；KEGG 分析工具通常使用单尾费舍尔精确检验，而 Reactome 工具默认使用二项式检验，从而导致通路排名不同。\nD. 这种差异是由于每个数据库的核心焦点不同；KEGG 主要为代谢通路设计，而 Reactome 则为细胞信号传导和细胞周期过程优化，这导致了对相同基因的不同通路注释。\nE. Reactome 数据库包含的已注释人类基因总数明显多于 KEGG 数据库，这改变了背景基因集，从而改变了所有通路富集分数的计算结果。", "solution": "题目要求我们解释为什么对同一个基因列表使用 KEGG 和 Reactome 进行的两次富集分析，会返回名称不同、概念范围也不同的首要通路，尽管这两个结果在统计上都是显著的，并且在生物学上都与异源物代谢相符。\n\n步骤1：确定富集分析依赖于什么。\n- 过表达分析评估输入的基因列表是否在预定义的基因集中存在统计学上的过度代表。其结果关键取决于参考数据库中那些基因集的定义和边界。\n- 因此，不同数据库在通路定义、粒度和层次结构上的差异，可以为同一个生物信号产生不同的排名靠前的条目。\n\n步骤2：描述 KEGG 通路整理的特征。\n- KEGG 将通路整理为宽泛的参考图谱，这些图谱将多个子过程和组分捆绑到综合性图表中。对于异源物代谢，KEGG 图谱通常在一个集成图谱中包括 I 相（通过细胞色素P450进行的功能化）、II 相（结合反应），有时还包括相关的转运和下游途径。\n- 因此，像“Metabolism of xenobiotics by cytochrome P450”这样的 KEGG 首要命中结果反映了一个包含多个子过程的宽泛通路。\n\n步骤3：描述 Reactome 通路整理的特征。\n- Reactome 是基于事件的，并且是明确分层的。它将生物学过程组织成一个由通路、子通路和反应组成的精细粒度层次结构，并具有父子关系。\n- 作为异源物代谢的一部分，Reactome 将诸如“Phase I - Functionalization of compounds”之类的特定子过程区分为独立的子通路，置于更宽泛的父级通路之下。\n\n步骤4：推断观察到的差异的原因。\n- 如果基因列表特别富集于 I 相酶（例如，特定的细胞色素P450和相关还原酶），由于其精细粒度的通路定义，Reactome 会将特定的子过程“Phase I - Functionalization of compounds”排在首位。\n- 而 KEGG 因为将相关的子过程聚合成一个更宽泛的单一图谱，所以会突出显示涵盖性的异源物代谢通路，例如“Metabolism of xenobiotics by cytochrome P450”。\n- 因此，两个结果都指向相同的底层生物学过程，但由于数据库不同的整理理念和粒度水平，其名称和范围有所不同。\n\n步骤5：评估其他解释选项 (B–E)。\n- B (更新周期差异) 既不是一个根本性的解释，通常也不准确；两个数据库都得到积极维护，观察到的差异与整理的粒度有关，而不是时效性。\n- C (不同的统计检验) 对比 KEGG 与 Reactome 而言本身不一定正确；两者通常都通过过表达分析（例如，费舍尔精确检验）进行分析，具体方法取决于所使用的工具。这里的核心差异源于通路定义，而不一定是不同的默认检验方法。\n- D (不同的核心焦点：代谢与信号传导) 无法解释本案例，因为两个数据库都全面地包含了代谢通路；Reactome 的首要命中结果是一个代谢子过程，而不是一个信号传导相关的条目。\n- E (不同的背景基因全集) 可能会影响p值，但不能从根本上解释为什么具有嵌套范围且概念上不同的通路名称会成为首要命中结果；题目中给出的这对结果明确地反映了分层式整理与宽泛式整理的对比。\n\n结论：最准确和最根本的解释是，Reactome 精细粒度、分层式、基于事件的整理方式将特定的子过程分离为独立的通路，而 KEGG 则将更宽泛的过程聚合成参考图谱。该基因列表最集中于 I 相子过程，从而导致了在首要通路名称上观察到的差异。\n\n因此，正确选项是 A。", "answer": "$$\\boxed{A}$$", "id": "1419489"}, {"introduction": "在对新物种进行基因组注释时，我们常常会遇到来自不同数据库的预测信息相互冲突的情况。解决这类问题是现代计算生物学的一项核心任务，它要求我们能够整合多种来源的证据，做出最可靠的判断。本练习模拟了一个真实的科研场景，你需要扮演一位计算生物学家，通过一个定量的证据整合框架来解决一个关键酶的功能注释冲突。你将学习如何综合利用序列同源性（$S_{\\text{homology}}$）、蛋白质结构域（$S_{\\text{domain}}$）和基因共表达（$S_{\\text{coexpression}}$）这三条独立的证据线，以数据驱动的方式得出结论。[@problem_id:1419495]", "problem": "一个计算生物学家团队正在对一种新测序的嗜极古菌 *Thermovibrio syntheticus* 进行代谢重建。他们在泛酸生物合成途径中发现了一个关键缺口，具体而言是 L-天冬氨酸转化为 β-丙氨酸的反应。由基因 `TS_1337` 编码的一个假设蛋白是填补这一缺失功能的首要候选者。然而，两个主要的生物学数据库对该酶的身份提供了相互矛盾的预测。\n\n- 京都基因与基因组百科全书（KEGG）的注释流程表明，`TS_1337` 编码一种**天冬氨酸-1-脱羧酶 (PanD)**，其酶学委员会（EC）编号为 4.1.1.11。\n- Reactome 数据库的注释表明，`TS_1337` 编码一种**谷氨酸脱羧酶 (GAD)**，其EC编号为 4.1.1.15，已知该酶在某些相关生物体中对 L-天冬氨酸具有混杂活性。\n\n为解决这一冲突，您必须应用一个定量证据整合框架。每个候选酶（PanD 和 GAD）的综合证据得分 $S$ 使用以下加权公式计算：\n$$S = 0.4 \\times S_{\\text{homology}} + 0.3 \\times S_{\\text{domain}} + 0.3 \\times S_{\\text{coexpression}}$$\n\n您被提供了以下生物信息学数据：\n\n1.  **同源性证据 ($S_{\\text{homology}}$):** 对 TS_1337 蛋白序列在一个经过整理的参考数据库中进行了 BLASTp 搜索。一个蛋白质序列与其自身序列比对的 bit-score 是 580。\n    - 与已验证的 PanD 蛋白比对的最高 bit-score 是 450。\n    - 与已验证的 GAD 蛋白比对的最高 bit-score 是 310。\n    同源性得分定义为候选者的 bit-score 与自比对 bit-score 的比率：$S_{\\text{homology}} = \\frac{\\text{bit-score}}{\\text{self-score}}$。\n\n2.  **蛋白质结构域证据 ($S_{\\text{domain}}$):** 使用 InterProScan 分析了 TS_1337 的蛋白质序列，并将其组成的结构域与 PanD 和 GAD 酶家族的经典结构域进行了比较。\n    - 在 TS_1337 蛋白中鉴定出的结构域：{IPR002047, IPR001633, IPR036858}\n    - PanD 家族的经典结构域：{IPR002047, IPR001633, IPR020846}\n    - GAD 家族的经典结构域：{IPR002047, IPR019866}\n    结构域得分由 TS_1337 中的结构域集合 ($A$) 与候选家族的经典结构域集合 ($B$) 之间的 Jaccard 相似性指数定义：$S_{\\text{domain}} = \\frac{|A \\cap B|}{|A \\cup B|}$。\n\n3.  **基因共表达证据 ($S_{\\text{coexpression}}$):** 对转录组数据的分析确定了 10 个与 `TS_1337` 高度共表达的其他基因。通过它们参与的途径对它们的功能进行了注释。\n    - 6 个共表达基因属于“泛酸与辅酶A生物合成”途径（KEGG 图：`ko00770`）。\n    - 2 个共表达基因属于“谷氨酸代谢”途径（KEGG 图：`ko00250`）。\n    - 2 个共表达基因无法进行功能表征。\n    PanD 酶是 ko00770 途径的经典成员，而 GAD 酶是 ko00250 途径的经典成员。候选者的共表达得分是属于候选者主要代谢途径的*已表征的*共表达基因的比例。\n\n您的任务是计算 PanD 和 GAD 的总证据得分。然后，为了量化对更优注释的置信度，计算更可能的候选者的总分与可能性较小的候选者的总分之比。\n\n计算这个置信度比率。将您的最终答案四舍五入到三位有效数字。", "solution": "综合证据得分定义为\n$$S=0.4\\,S_{\\text{homology}}+0.3\\,S_{\\text{domain}}+0.3\\,S_{\\text{coexpression}},$$\n其中 $S_{\\text{homology}}=\\frac{\\text{bit-score}}{\\text{self-score}}$，$S_{\\text{domain}}=\\frac{|A\\cap B|}{|A\\cup B|}$，而 $S_{\\text{coexpression}}$ 等于候选者主要途径中已表征的共表达基因的比例。\n\n同源性证据：\n- 自身 bit-score 为 $580$。\n- PanD 最佳匹配 bit-score 为 $450$，得出 $S_{\\text{homology}}^{\\text{PanD}}=\\frac{450}{580}=\\frac{45}{58}$。\n- GAD 最佳匹配 bit-score 为 $310$，得出 $S_{\\text{homology}}^{\\text{GAD}}=\\frac{310}{580}=\\frac{31}{58}$。\n\n结构域证据：\n- TS_1337 结构域 $A=\\{\\text{IPR002047},\\text{IPR001633},\\text{IPR036858}\\}$。\n- PanD 经典结构域 $B_{\\text{PanD}}=\\{\\text{IPR002047},\\text{IPR001633},\\text{IPR020846}\\}$，得出 $|A\\cap B_{\\text{PanD}}|=2$，$|A\\cup B_{\\text{PanD}}|=4$，所以 $S_{\\text{domain}}^{\\text{PanD}}=\\frac{2}{4}=\\frac{1}{2}$。\n- GAD 经典结构域 $B_{\\text{GAD}}=\\{\\text{IPR002047},\\text{IPR019866}\\}$，得出 $|A\\cap B_{\\text{GAD}}|=1$，$|A\\cup B_{\\text{GAD}}|=4$，所以 $S_{\\text{domain}}^{\\text{GAD}}=\\frac{1}{4}$。\n\n共表达证据：\n- 在10个共表达基因中，2个未被表征，因此有 $8$ 个已表征。\n- PanD 途径基因：$6$ 个，因此 $S_{\\text{coexpression}}^{\\text{PanD}}=\\frac{6}{8}=\\frac{3}{4}$。\n- GAD 途径基因：$2$ 个，因此 $S_{\\text{coexpression}}^{\\text{GAD}}=\\frac{2}{8}=\\frac{1}{4}$。\n\n使用 $0.4=\\frac{2}{5}$ 和 $0.3=\\frac{3}{10}$ 计算总分：\n$$S^{\\text{PanD}}=\\frac{2}{5}\\cdot\\frac{45}{58}+\\frac{3}{10}\\cdot\\frac{1}{2}+\\frac{3}{10}\\cdot\\frac{3}{4}\n=\\frac{9}{29}+\\frac{3}{20}+\\frac{9}{40}\n=\\frac{795}{1160}=\\frac{159}{232},$$\n$$S^{\\text{GAD}}=\\frac{2}{5}\\cdot\\frac{31}{58}+\\frac{3}{10}\\cdot\\frac{1}{4}+\\frac{3}{10}\\cdot\\frac{1}{4}\n=\\frac{31}{145}+\\frac{3}{20}\n=\\frac{211}{580}.$$\n\n由于 $S^{\\text{PanD}}>S^{\\text{GAD}}$，PanD 的可能性更大。置信度比率为\n$$\\text{Ratio}=\\frac{S^{\\text{PanD}}}{S^{\\text{GAD}}}\n=\\frac{\\frac{159}{232}}{\\frac{211}{580}}\n=\\frac{159\\cdot 580}{232\\cdot 211}\n=\\frac{23055}{12238}\\approx 1.883886.$$\n\n四舍五入到三位有效数字，该比率为 $1.88$。", "answer": "$$\\boxed{1.88}$$", "id": "1419495"}]}