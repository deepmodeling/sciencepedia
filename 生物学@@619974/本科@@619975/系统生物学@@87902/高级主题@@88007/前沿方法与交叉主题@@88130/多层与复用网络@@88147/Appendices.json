{"hands_on_practices": [{"introduction": "在系统生物学中，我们常常需要整合来自不同实验方法的数据，而多重网络为此提供了一个强大的框架。本练习将通过一个基因调控网络的实例，向您展示如何利用多重网络比较两种常见的实验技术（ChIP-seq 和 Y1H）所揭示的相互作用。通过计算和比较一个转录因子在不同层中的“度”，您将学会如何从多重网络的视角发现其在不同生物学情境下的功能差异 [@problem_id:1450032]。", "problem": "在系统生物学中，多重网络被用来模拟复杂的生物系统，它通过将不同类型的关系或数据源表示为独立的层。考虑一个涉及五个转录因子 (TFs) 的小规模基因调控网络：`STAT1`、`MYC`、`TP53`、`HIF1A` 和 `NFKB1`。这些转录因子与一组靶基因之间的相互作用是通过两种不同的实验技术研究的，每种技术构成多重网络中的一个层。\n\n第一层是根据染色质免疫沉淀测序 (ChIP-seq) 数据构建的，该技术用于鉴定转录因子在体内的基因启动子区域的结合情况。观察到的 ChIP-seq 相互作用如下：\n- `TP53` 结合 `GENE1`、`GENE2`、`GENE3`、`GENE4`\n- `MYC` 结合 `GENE5`、`GENE6`\n- `HIF1A` 结合 `GENE1`\n- `NFKB1` 结合 `GENE2`、`GENE5`\n- `STAT1` 结合 `GENE3`\n\n第二层是根据酵母单杂交 (Y1H) 数据构建的，该技术用于测量转录因子在体外与特定DNA序列结合的潜力。观察到的 Y1H 相互作用如下：\n- `TP53` 结合 `GENE6`\n- `MYC` 结合 `GENE1`、`GENE2`、`GENE3`\n- `HIF1A` 结合 `GENE4`、`GENE5`、`GENE6`\n- `NFKB1` 结合 `GENE1`\n- `STAT1` 结合 `GENE4`、`GENE5`\n\n在此网络模型中，转录因子在给定层中的“度”定义为它在该层中结合的不同靶基因的数量。通过比较转录因子在不同层中的连接性，可以推断它们的不同作用。\n\n在下列转录因子中，哪一个在 ChIP-seq 网络层中表现出最高的度，同时又在 Y1H 网络层中表现出最低的度之一？\n\nA. `STAT1`\n\nB. `MYC`\n\nC. `TP53`\n\nD. `HIF1A`\n\nE. `NFKB1`", "solution": "我们将该多重网络建模为两层：第1层 (ChIP-seq) 和第2层 (Y1H)。对于每个转录因子，将其在层 $\\ell$ 中的度定义为 $k^{(\\ell)}(\\mathrm{TF})$，等于其在该层中结合的不同靶基因数量。\n\n根据 ChIP-seq 相互作用（第1层），计算每个转录因子的靶基因数量可得：\n$$k^{(1)}(\\mathrm{TP53})=4,\\quad k^{(1)}(\\mathrm{MYC})=2,\\quad k^{(1)}(\\mathrm{HIF1A})=1,\\quad k^{(1)}(\\mathrm{NFKB1})=2,\\quad k^{(1)}(\\mathrm{STAT1})=1.$$\n因此，第1层中的最高度为\n$$\\max k^{(1)}=4\\ \\text{，由}\\ \\mathrm{TP53}\\ \\text{达到}。$$\n\n根据 Y1H 相互作用（第2层），计算靶基因数量可得：\n$$k^{(2)}(\\mathrm{TP53})=1,\\quad k^{(2)}(\\mathrm{MYC})=3,\\quad k^{(2)}(\\mathrm{HIF1A})=3,\\quad k^{(2)}(\\mathrm{NFKB1})=1,\\quad k^{(2)}(\\mathrm{STAT1})=2.$$\n第2层中的最低度为\n$$\\min k^{(2)}=1\\ \\text{，由}\\ \\mathrm{TP53}\\ \\text{和}\\ \\mathrm{NFKB1}\\ \\text{达到}。$$\n\n因此，在 ChIP-seq 层中表现出最高度，同时在 Y1H 层中表现出最低度之一的转录因子是 $\\mathrm{TP53}$。\n\n对应的选项是 C。", "answer": "$$\\boxed{C}$$", "id": "1450032"}, {"introduction": "生物系统中的许多关系天然地构成二分网络，例如病毒与其宿主蛋白之间的相互作用。直接分析二分网络有时难以揭示同类节点间的关系，而网络投影技术则能解决这一问题。在这个练习中，您将从一个病毒-宿主蛋白二分网络出发，构建两种不同的单分投影网络，分别揭示病毒之间因共同攻击目标而产生的联系，以及宿主蛋白之间因被共同病毒攻击而形成的关联 [@problem_id:1450018]。", "problem": "在病毒系统生物学中，病毒与宿主生物之间的相互作用可以建模为一个二分网络。考虑一位生物学家正在研究一个简化系统，该系统由一组四个病毒 $U = \\{V_1, V_2, V_3, V_4\\}$ 和它们靶向的一组六个人类蛋白质 $V = \\{P_1, P_2, P_3, P_4, P_5, P_6\\}$ 组成。如果病毒 $v$ 与人类蛋白质 $p$ 相互作用，则在病毒 $v \\in U$ 和蛋白质 $p \\in V$ 之间存在一条边。观测到的相互作用如下：\n\n- 病毒 $V_1$ 靶向蛋白质 $P_1$、$P_2$ 和 $P_3$。\n- 病毒 $V_2$ 靶向蛋白质 $P_2$、$P_3$ 和 $P_4$。\n- 病毒 $V_3$ 靶向蛋白质 $P_4$ 和 $P_5$。\n- 病毒 $V_4$ 靶向蛋白质 $P_1$、$P_4$ 和 $P_6$。\n\n从这个二分网络可以构建出两个单模投影网络：\n\n1.  一个**病毒投影网络** $G_V$，其中节点是病毒。如果两个不同的病毒靶向至少一个共同的人类蛋白质，则它们之间存在一条边。两个病毒之间边的权重定义为它们共享的共同蛋白质靶点的总数。\n\n2.  一个**蛋白质投影网络** $G_P$，其中节点是人类蛋白质。如果两个不同的蛋白质被至少一个共同的病毒靶向，则它们之间存在一条边。在该网络中，蛋白质节点的度简单地定义为与其连接的其他蛋白质节点的数量（即，我们计算边的数量，而不是它们的权重）。\n\n您的任务是计算以下两个量：\n- 令 $W_{12}$ 为病毒投影网络 $G_V$ 中连接病毒 $V_1$ 和病毒 $V_2$ 的边的权重。\n- 令 $K_{P4}$ 为蛋白质投影网络 $G_P$ 中蛋白质 $P_4$ 的度。\n\n确定有序对 $(W_{12}, K_{P4})$。", "solution": "该问题要求计算两个值 $W_{12}$ 和 $K_{P4}$，这两个值是从一个给定的病毒-蛋白质相互作用二分网络的两种不同投影中导出的。我们将逐步求解每个值。\n\n首先，我们通过列出每个病毒的蛋白质靶点集合来表示该二分网络：\n- $V_1$ 的靶点：$T(V_1) = \\{P_1, P_2, P_3\\}$\n- $V_2$ 的靶点：$T(V_2) = \\{P_2, P_3, P_4\\}$\n- $V_3$ 的靶点：$T(V_3) = \\{P_4, P_5\\}$\n- $V_4$ 的靶点：$T(V_4) = \\{P_1, P_4, P_6\\}$\n\n**第一部分：从病毒投影网络 ($G_V$) 计算 $W_{12}$**\n\n病毒投影网络 $G_V$ 以病毒为节点。两个病毒之间边的权重是它们共同蛋白质靶点的数量。我们需要找到 $W_{12}$，即 $V_1$ 和 $V_2$ 之间边的权重。\n\n为了求得这个权重，我们需要确定 $V_1$ 和 $V_2$ 的共同靶点。这对应于求它们的靶点集合的交集，$T(V_1) \\cap T(V_2)$。\n\n- $T(V_1) = \\{P_1, P_2, P_3\\}$\n- $T(V_2) = \\{P_2, P_3, P_4\\}$\n\n这两个集合的交集是：\n$$ T(V_1) \\cap T(V_2) = \\{P_1, P_2, P_3\\} \\cap \\{P_2, P_3, P_4\\} = \\{P_2, P_3\\} $$\n共同靶点的集合是 $\\{P_2, P_3\\}$。该集合中的元素数量为 2。\n因此，$V_1$ 和 $V_2$ 之间边的权重是 2。\n$$ W_{12} = 2 $$\n\n**第二部分：从蛋白质投影网络 ($G_P$) 计算 $K_{P4}$**\n\n蛋白质投影网络 $G_P$ 以蛋白质为节点。如果两个蛋白质被至少一个共同的病毒靶向，则它们之间存在一条边。蛋白质节点 $P_4$ 的度 $K_{P4}$ 是与 $P_4$ 相连的其他蛋白质的数量。\n\n为了找到 $P_4$ 的邻接点，我们首先需要确定哪些病毒靶向 $P_4$。根据题目陈述：\n- $V_2$ 靶向 $P_4$。\n- $V_3$ 靶向 $P_4$。\n- $V_4$ 靶向 $P_4$。\n\n所以，靶向 $P_4$ 的病毒集合是 $\\{V_2, V_3, V_4\\}$。\n如果一个蛋白质 $P_j$（其中 $j \\neq 4$）也同样被这些病毒（$V_2$、$V_3$ 或 $V_4$）中的至少一个靶向，那么它就与 $P_4$ 相连。让我们找出这三个病毒靶向的所有蛋白质。\n\n- $V_2$ 靶向的蛋白质：$T(V_2) = \\{P_2, P_3, P_4\\}$\n- $V_3$ 靶向的蛋白质：$T(V_3) = \\{P_4, P_5\\}$\n- $V_4$ 靶向的蛋白质：$T(V_4) = \\{P_1, P_4, P_6\\}$\n\n让我们确定 $P_4$ 的邻接点：\n- 因为 $P_2$ 和 $P_3$ 也被 $V_2$ 靶向，所以在 $G_P$ 中存在边 $(P_4, P_2)$ 和 $(P_4, P_3)$。\n- 因为 $P_5$ 也被 $V_3$ 靶向，所以在 $G_P$ 中存在边 $(P_4, P_5)$。\n- 因为 $P_1$ 和 $P_6$ 也被 $V_4$ 靶向，所以在 $G_P$ 中存在边 $(P_4, P_1)$ 和 $(P_4, P_6)$。\n\n与 $P_4$ 相连的蛋白质集合是所有被病毒 $V_2, V_3, V_4$ 中任何一个与 $P_4$ 共同靶向的蛋白质的并集，且不包括 $P_4$ 本身。\n- 与 $V_2$ 的共同靶点：$\\{P_2, P_3\\}$\n- 与 $V_3$ 的共同靶点：$\\{P_5\\}$\n- 与 $V_4$ 的共同靶点：$\\{P_1, P_6\\}$\n\n$P_4$ 的邻接点集合是这些集合的并集：$\\{P_2, P_3\\} \\cup \\{P_5\\} \\cup \\{P_1, P_6\\} = \\{P_1, P_2, P_3, P_5, P_6\\}$。\n\n度 $K_{P4}$ 是这个邻接点集合中的节点数量。\n邻接点是 $P_1, P_2, P_3, P_5, P_6$。共有 5 个这样的蛋白质。\n因此，蛋白质 $P_4$ 的度是 5。\n$$ K_{P4} = 5 $$\n\n**结论**\n\n我们已经计算出两个值：$W_{12} = 2$ 和 $K_{P4} = 5$。\n问题要求的是有序对 $(W_{12}, K_{P4})$。\n\n最终答案是 $(2, 5)$。", "answer": "$$\\boxed{\\begin{pmatrix} 2 & 5 \\end{pmatrix}}$$", "id": "1450018"}, {"introduction": "多层网络的分析不仅限于描述其静态结构，更能用来评估系统的动态属性，例如鲁棒性。本练习模拟了对一个由两条相互连接的信号通路组成的细胞系统的“攻击”，旨在比较两种不同的策略来识别系统的关键节点。通过这项实践，您将深刻理解为何使用多重网络特有的指标（例如跨层连接性）比简单地聚合所有相互作用，更能有效地揭示系统的脆弱点 [@problem_id:1450043]。", "problem": "一位系统生物学家正在研究一个细胞系统的弹性，该系统包含两个相互连接的通路，并被建模为一个双层复用网络。该系统由10个关键生物分子组成，表示为标记为 $V_1, V_2, \\dots, V_{10}$ 的节点。第1层代表信号转导通路，第2层代表代谢通路。每层内部的相互作用（边）如下所示：\n\n-   **第1层边**：$\\{(V_1,V_3), (V_1,V_4), (V_1,V_5), (V_1,V_6), (V_1,V_7), (V_1,V_8), (V_2,V_3), (V_2,V_4), (V_2,V_9), (V_5,V_{10})\\}$\n-   **第2层边**：$\\{(V_1,V_2), (V_2,V_3), (V_2,V_4), (V_3,V_5), (V_4,V_6), (V_7,V_8), (V_9,V_{10})\\}$\n\n为了评估该系统的脆弱性，正在比较两种靶向攻击策略。每种策略都涉及从网络中移除单个最关键的节点，其中关键性由不同的度量指标定义。\n\n-   **策略A（高阶攻击）**：此策略针对具有最高**复用度**的节点。一个节点 $i$ 的复用度记为 $k_i^{\\text{mux}}$，是其在各层中的度之和。设 $k_i^{[1]}$ 和 $k_i^{[2]}$ 分别为节点 $i$ 在第1层和第2层中的度。那么，$k_i^{\\text{mux}} = k_i^{[1]} + k_i^{[2]}$。\n\n-   **策略B（桥接节点攻击）**：此策略针对具有最高**层间连接性得分**的节点。该得分记为 $C_i$，用于识别在两个层中同时具有重要作用的节点。它被定义为节点在各层中的度的乘积：$C_i = k_i^{[1]} \\times k_i^{[2]}$。\n\n移除一个节点后网络的鲁棒性，通过所得**聚合网络**中最大连通分量（LCC）的大小来量化。聚合网络是一个单层图，包含所有剩余节点以及来自两个层的所有边。\n\n设 $S_A$ 为根据策略A移除目标节点后LCC的大小，$S_B$ 为根据策略B移除目标节点后LCC的大小。\n\n计算比率 $R = S_B / S_A$，该比率比较了桥接节点攻击相对于高阶攻击的影响。将最终答案四舍五入到四位有效数字。", "solution": "假设所有列出的边都是无向的，这是最大连通分量（LCC）分析的标准做法，并且聚合网络是两个层中所有边的并集。节点为 $V_{1},\\dots,V_{10}$。对于第1层，边为 $\\{(V_{1},V_{3}), (V_{1},V_{4}), (V_{1},V_{5}), (V_{1},V_{6}), (V_{1},V_{7}), (V_{1},V_{8}), (V_{2},V_{3}), (V_{2},V_{4}), (V_{2},V_{9}), (V_{5},V_{10})\\}$。对于第2层，边为 $\\{(V_{1},V_{2}), (V_{2},V_{3}), (V_{2},V_{4}), (V_{3},V_{5}), (V_{4},V_{6}), (V_{7},V_{8}), (V_{9},V_{10})\\}$。\n\n计算每层中的度。在第1层中：\n- $k_{1}^{[1]}=6$ (邻居 $V_{3},V_{4},V_{5},V_{6},V_{7},V_{8}$),\n- $k_{2}^{[1]}=3$ (邻居 $V_{3},V_{4},V_{9}$),\n- $k_{3}^{[1]}=2$ (邻居 $V_{1},V_{2}$),\n- $k_{4}^{[1]}=2$ (邻居 $V_{1},V_{2}$),\n- $k_{5}^{[1]}=2$ (邻居 $V_{1},V_{10}$),\n- $k_{6}^{[1]}=1$ (邻居 $V_{1}$),\n- $k_{7}^{[1]}=1$ (邻居 $V_{1}$),\n- $k_{8}^{[1]}=1$ (邻居 $V_{1}$),\n- $k_{9}^{[1]}=1$ (邻居 $V_{2}$),\n- $k_{10}^{[1]}=1$ (邻居 $V_{5}$).\n\n在第2层中：\n- $k_{1}^{[2]}=1$ (邻居 $V_{2}$),\n- $k_{2}^{[2]}=3$ (邻居 $V_{1},V_{3},V_{4}$),\n- $k_{3}^{[2]}=2$ (邻居 $V_{2},V_{5}$),\n- $k_{4}^{[2]}=2$ (邻居 $V_{2},V_{6}$),\n- $k_{5}^{[2]}=1$ (邻居 $V_{3}$),\n- $k_{6}^{[2]}=1$ (邻居 $V_{4}$),\n- $k_{7}^{[2]}=1$ (邻居 $V_{8}$),\n- $k_{8}^{[2]}=1$ (邻居 $V_{7}$),\n- $k_{9}^{[2]}=1$ (邻居 $V_{10}$),\n- $k_{10}^{[2]}=1$ (邻居 $V_{9}$).\n\n对于每个节点 $i$，复用度和层间连接性得分分别为 $k_{i}^{\\text{mux}}=k_{i}^{[1]}+k_{i}^{[2]}$ 和 $C_{i}=k_{i}^{[1]}k_{i}^{[2]}$，得出：\n- $V_{1}$: $k_{1}^{\\text{mux}}=7$, $C_{1}=6$.\n- $V_{2}$: $k_{2}^{\\text{mux}}=6$, $C_{2}=9$.\n- $V_{3}$: $k_{3}^{\\text{mux}}=4$, $C_{3}=4$.\n- $V_{4}$: $k_{4}^{\\text{mux}}=4$, $C_{4}=4$.\n- $V_{5}$: $k_{5}^{\\text{mux}}=3$, $C_{5}=2$.\n- $V_{6}$: $k_{6}^{\\text{mux}}=2$, $C_{6}=1$.\n- $V_{7}$: $k_{7}^{\\text{mux}}=2$, $C_{7}=1$.\n- $V_{8}$: $k_{8}^{\\text{mux}}=2$, $C_{8}=1$.\n- $V_{9}$: $k_{9}^{\\text{mux}}=2$, $C_{9}=1$.\n- $V_{10}$: $k_{10}^{\\text{mux}}=2$, $C_{10}=1$.\n\n因此，策略A（最高复用度）移除 $V_{1}$，策略B（最高层间连接性）移除 $V_{2}$。\n\n通过合并两层的所有边来构建聚合网络。在移除节点之前，聚合网络中的邻居集合为：\n- $V_{1}: \\{V_{2},V_{3},V_{4},V_{5},V_{6},V_{7},V_{8}\\}$,\n- $V_{2}: \\{V_{1},V_{3},V_{4},V_{9}\\}$,\n- $V_{3}: \\{V_{1},V_{2},V_{5}\\}$,\n- $V_{4}: \\{V_{1},V_{2},V_{6}\\}$,\n- $V_{5}: \\{V_{1},V_{3},V_{10}\\}$,\n- $V_{6}: \\{V_{1},V_{4}\\}$,\n- $V_{7}: \\{V_{1},V_{8}\\}$,\n- $V_{8}: \\{V_{1},V_{7}\\}$,\n- $V_{9}: \\{V_{2},V_{10}\\}$,\n- $V_{10}: \\{V_{5},V_{9}\\}$.\n\n在策略A下，移除 $V_{1}$。剩余的边连接了以下集合：\n- $\\{V_{2},V_{3},V_{4},V_{5},V_{6},V_{9},V_{10}\\}$ 通过边 $V_{2}-V_{3}$、$V_{2}-V_{4}$、$V_{2}-V_{9}$、$V_{3}-V_{5}$、$V_{4}-V_{6}$、$V_{5}-V_{10}$、$V_{9}-V_{10}$ 连接，形成一个大小为 7 的连通分量；而 $\\{V_{7},V_{8}\\}$ 通过边 $V_{7}-V_{8}$ 连接，形成一个大小为 2 的连通分量。因此，LCC 的大小为 $S_{A}=7$。\n\n在策略B下，移除 $V_{2}$。剩余的节点 $\\{V_{1},V_{3},V_{4},V_{5},V_{6},V_{7},V_{8},V_{9},V_{10}\\}$ 都通过诸如从 $V_{1}$ 到 $\\{V_{3},V_{4},V_{5},V_{6},V_{7},V_{8}\\}$ 以及 $V_{5}-V_{10}-V_{9}$ 等路径相连，从而形成一个大小为 $S_{B}=9$ 的单一连通分量。\n\n因此，所求比率为\n$$\nR=\\frac{S_{B}}{S_{A}}=\\frac{9}{7}\\approx 1.285714\\ldots\n$$\n四舍五入到四位有效数字，得到 $R=1.286$。", "answer": "$$\\boxed{1.286}$$", "id": "1450043"}]}