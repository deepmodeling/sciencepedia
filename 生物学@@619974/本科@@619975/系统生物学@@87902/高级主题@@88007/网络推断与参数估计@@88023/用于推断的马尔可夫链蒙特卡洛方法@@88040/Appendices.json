{"hands_on_practices": [{"introduction": "马尔可夫链蒙特卡洛（MCMC）方法的核心在于一个概率决策步骤，即是否接受一个新提出的参数值。这个练习将带你深入MCMC算法的“引擎室”，通过计算Metropolis-Hastings接受概率，亲身体验模型如何根据数据似然性来探索参数空间。理解这一基本步骤是揭开MCMC神秘面纱、掌握其工作原理的关键。[@problem_id:1444253]", "problem": "一位系统生物学家正在研究一个简单的酶促反应，其中底物蛋白 S 被激酶磷酸化生成产物 P。该反应被建模为一个一级动力学过程。在时间 $t$ 时，磷酸化产物 P 的浓度 $[P](t)$ 由以下方程描述：\n$$[P](t) = [S]_0 (1 - \\exp(-kt))$$\n其中 $[S]_0$ 是底物 S 的初始浓度，而 $k$ 是磷酸化速率常数。该生物学家旨在利用贝叶斯推断方法，特别是 Metropolis-Hastings 马尔可夫链蒙特卡洛（MCMC）算法，从实验数据中估计 $k$ 的值。\n\n实验在底物初始浓度为 $[S]_0 = 1.0 \\, \\mu\\text{M}$ 的条件下进行。在三个不同的时间点测量了产物 P 的浓度，得到以下数据集：\n- 在 $t_1 = 1.0$ 分钟时，测得浓度为 $[P]_1 = 0.25 \\, \\mu\\text{M}$。\n- 在 $t_2 = 2.0$ 分钟时，测得浓度为 $[P]_2 = 0.45 \\, \\mu\\text{M}$。\n- 在 $t_3 = 5.0$ 分钟时，测得浓度为 $[P]_3 = 0.70 \\, \\mu\\text{M}$。\n\n假设测量误差是独立的，并且服从均值为零、已知标准差为 $\\sigma = 0.05 \\, \\mu\\text{M}$ 的高斯分布。对于贝叶斯分析，速率常数 $k$ 的先验分布被选为区间 $[0, 1.0 \\, \\text{min}^{-1}]$ 上的均匀分布。\n\n在 MCMC 模拟的一个步骤中，链的当前状态是 $k_{current} = 0.30 \\, \\text{min}^{-1}$。提出了一个新的候选状态 $k_{prop} = 0.35 \\, \\text{min}^{-1}$。计算此提议移动的 Metropolis-Hastings 接受概率 $\\alpha$。将最终答案四舍五入到三位有效数字。", "solution": "我们使用具有已知标准差 $\\sigma$ 的独立高斯误差来对观测值建模，因此对于给定的 $k$，其似然函数为\n$$\nL(k) = \\prod_{i=1}^{3} \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\!\\left(-\\frac{\\left([P]_{i}-[P](t_{i};k)\\right)^{2}}{2\\sigma^{2}}\\right),\n$$\n其中 $[P](t;k) = [S]_{0}\\left(1-\\exp(-kt)\\right)$。$k$ 的先验分布在 $[0,1]$ 上是均匀的，且 $k_{current}=0.30$ 和 $k_{prop}=0.35$ 都在此区间内，因此先验比率为 $1$。假设提议分布是对称的（因此提议密度比为 $1$），则 Metropolis-Hastings 接受概率为\n$$\n\\alpha = \\min\\!\\left(1,\\frac{L(k_{prop})}{L(k_{current})}\\right)\n= \\min\\!\\left(1,\\exp\\!\\left(-\\frac{\\sum_{i=1}^{3}\\left(r_{prop,i}^{2}-r_{curr,i}^{2}\\right)}{2\\sigma^{2}}\\right)\\right),\n$$\n其中残差为 $r_{(\\cdot),i} = [P]_{i}-[P](t_{i};k_{(\\cdot)})$。\n\n使用 $[S]_{0}=1.0$, $\\sigma=0.05$, 时间 $t_{1}=1.0$, $t_{2}=2.0$, $t_{3}=5.0$, 以及观测值 $[P]_{1}=0.25$, $[P]_{2}=0.45$, $[P]_{3}=0.70$, 计算模型预测值：\n- 对于 $k_{current}=0.30$:\n$$\n[P](1;0.30)=1-\\exp(-0.30)=0.2591817793,\\quad\n[P](2;0.30)=1-\\exp(-0.60)=0.4511883639,\\quad\n[P](5;0.30)=1-\\exp(-1.50)=0.7768698399.\n$$\n残差及其平方：\n$$\nr_{curr,1}=0.25-0.2591817793=-0.0091817793,\\quad r_{curr,1}^{2}\\approx 0.0000843051,\n$$\n$$\nr_{curr,2}=0.45-0.4511883639=-0.0011883639,\\quad r_{curr,2}^{2}\\approx 0.00000141221,\n$$\n$$\nr_{curr,3}=0.70-0.7768698399=-0.0768698399,\\quad r_{curr,3}^{2}\\approx 0.00590897229,\n$$\n因此\n$$\n\\mathrm{SSE}_{current}=\\sum r_{curr,i}^{2}\\approx 0.00599468957.\n$$\n\n- 对于 $k_{prop}=0.35$:\n$$\n[P](1;0.35)=1-\\exp(-0.35)=0.2953119103,\\quad\n[P](2;0.35)=1-\\exp(-0.70)=0.5034146962,\\quad\n[P](5;0.35)=1-\\exp(-1.75)=0.8262260565.\n$$\n残差及其平方：\n$$\nr_{prop,1}=0.25-0.2953119103=-0.0453119103,\\quad r_{prop,1}^{2}\\approx 0.00205316922,\n$$\n$$\nr_{prop,2}=0.45-0.5034146962=-0.0534146962,\\quad r_{prop,2}^{2}\\approx 0.00285312977,\n$$\n$$\nr_{prop,3}=0.70-0.8262260565=-0.1262260565,\\quad r_{prop,3}^{2}\\approx 0.01593301734,\n$$\n因此\n$$\n\\mathrm{SSE}_{prop}=\\sum r_{prop,i}^{2}\\approx 0.02083931633.\n$$\n\n因此\n$$\n\\Delta \\mathrm{SSE}=\\mathrm{SSE}_{prop}-\\mathrm{SSE}_{current}\\approx 0.01484462676,\\quad\n2\\sigma^{2}=2\\cdot(0.05)^{2}=0.005,\n$$\n似然比为\n$$\n\\frac{L(k_{prop})}{L(k_{current})}=\\exp\\!\\left(-\\frac{\\Delta \\mathrm{SSE}}{2\\sigma^{2}}\\right)\n=\\exp\\!\\left(-\\frac{0.01484462676}{0.005}\\right)=\\exp(-2.96892535)\\approx 0.0514.\n$$\n因此，\n$$\n\\alpha=\\min(1,0.0514)=0.0514,\n$$\n保留三位有效数字。", "answer": "$$\\boxed{0.0514}$$", "id": "1444253"}, {"introduction": "成功运行MCMC并收集到大量参数样本后，下一步便是分析这些结果。这个练习着重于一个重要的诊断步骤：分析参数间的相关性。通过计算从后验分布中抽取的生长速率 $r$ 和环境承载力 $K$ 之间的相关系数，你将学会如何识别模型的参数辨识度问题，并理解模型在拟合数据时可能存在的权衡。[@problem_id:1444240]", "problem": "一位系统生物学家正在研究酵母培养物的生长动态。种群增长由以下逻辑斯谛方程建模：\n$$ \\frac{dN}{dt} = r N \\left(1 - \\frac{N}{K}\\right) $$\n其中 $N$ 是种群大小，$t$ 是时间，$r$ 是内禀增长率，$K$ 是环境的承载能力。\n\n为了从实验数据中估计 $r$ 和 $K$ 的值，该生物学家使用马尔可夫链蒙特卡洛（MCMC）算法进行贝叶斯推断。这种计算技术从后验概率分布中生成一系列参数值（称为样本），该分布代表了在观察数据后对参数的更新信念。分析 MCMC 输出的一个关键步骤是检查估计参数之间的相关性，因为强相关性可能表明模型是病态的，或者数据对于区分参数效应的信息量不足。\n\nMCMC 模拟为参数对 $(r, K)$ 产生了大量的样本。为了进行快速分析，该生物学家随机选择了其中的五个样本：\n\n- 样本 1: ($r_1=0.55$, $K_1=980$)\n- 样本 2: ($r_2=0.48$, $K_2=1050$)\n- 样本 3: ($r_3=0.51$, $K_3=1010$)\n- 样本 4: ($r_4=0.60$, $K_4=950$)\n- 样本 5: ($r_5=0.45$, $K_5=1100$)\n\n$r$ 的单位是 $\\text{小时}^{-1}$，$K$ 的单位是 千个细胞。\n\n基于这个后验样本子集，计算增长率 $r$ 和承载能力 $K$ 之间的样本皮尔逊相关系数。该系数提供了这两个参数之间线性关联的定量度量。最终答案应为一个无量纲数。将您的最终答案四舍五入至三位有效数字。", "solution": "目标是为给定的五对增长率 $r$ 和承载能力 $K$ 的样本计算样本皮尔逊相关系数 $\\rho_{r,K}$。对于一组 $n$ 个样本，两个变量 $x$ 和 $y$ 之间的样本皮尔逊相关系数公式为：\n$$ \\rho_{x,y} = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^{n} (x_i - \\bar{x})^2 \\sum_{i=1}^{n} (y_i - \\bar{y})^2}} $$\n在我们的例子中，$x$ 对应于增长率 $r$，$y$ 对应于承载能力 $K$，样本数量为 $n=5$。\n\n首先，我们计算 $r$ 和 $K$ 的样本均值。\n给定的 $r$ 样本为 $\\{0.55, 0.48, 0.51, 0.60, 0.45\\}$。\n$r$ 的样本均值为：\n$$ \\bar{r} = \\frac{1}{5} \\sum_{i=1}^{5} r_i = \\frac{0.55 + 0.48 + 0.51 + 0.60 + 0.45}{5} = \\frac{2.59}{5} = 0.518 $$\n\n给定的 $K$ 样本为 $\\{980, 1050, 1010, 950, 1100\\}$。\n$K$ 的样本均值为：\n$$ \\bar{K} = \\frac{1}{5} \\sum_{i=1}^{5} K_i = \\frac{980 + 1050 + 1010 + 950 + 1100}{5} = \\frac{5090}{5} = 1018 $$\n\n接下来，我们计算每个样本与均值的偏差，即 $(r_i - \\bar{r})$ 和 $(K_i - \\bar{K})$。我们还将计算这些偏差的乘积以及它们的平方。\n\n对于 $i=1$:\n$r_1 - \\bar{r} = 0.55 - 0.518 = 0.032$\n$K_1 - \\bar{K} = 980 - 1018 = -38$\n$(r_1 - \\bar{r})(K_1 - \\bar{K}) = (0.032)(-38) = -1.216$\n$(r_1 - \\bar{r})^2 = (0.032)^2 = 0.001024$\n$(K_1 - \\bar{K})^2 = (-38)^2 = 1444$\n\n对于 $i=2$:\n$r_2 - \\bar{r} = 0.48 - 0.518 = -0.038$\n$K_2 - \\bar{K} = 1050 - 1018 = 32$\n$(r_2 - \\bar{r})(K_2 - \\bar{K}) = (-0.038)(32) = -1.216$\n$(r_2 - \\bar{r})^2 = (-0.038)^2 = 0.001444$\n$(K_2 - \\bar{K})^2 = (32)^2 = 1024$\n\n对于 $i=3$:\n$r_3 - \\bar{r} = 0.51 - 0.518 = -0.008$\n$K_3 - \\bar{K} = 1010 - 1018 = -8$\n$(r_3 - \\bar{r})(K_3 - \\bar{K}) = (-0.008)(-8) = 0.064$\n$(r_3 - \\bar{r})^2 = (-0.008)^2 = 0.000064$\n$(K_3 - \\bar{K})^2 = (-8)^2 = 64$\n\n对于 $i=4$:\n$r_4 - \\bar{r} = 0.60 - 0.518 = 0.082$\n$K_4 - \\bar{K} = 950 - 1018 = -68$\n$(r_4 - \\bar{r})(K_4 - \\bar{K}) = (0.082)(-68) = -5.576$\n$(r_4 - \\bar{r})^2 = (0.082)^2 = 0.006724$\n$(K_4 - \\bar{K})^2 = (-68)^2 = 4624$\n\n对于 $i=5$:\n$r_5 - \\bar{r} = 0.45 - 0.518 = -0.068$\n$K_5 - \\bar{K} = 1100 - 1018 = 82$\n$(r_5 - \\bar{r})(K_5 - \\bar{K}) = (-0.068)(82) = -5.576$\n$(r_5 - \\bar{r})^2 = (-0.068)^2 = 0.004624$\n$(K_5 - \\bar{K})^2 = (82)^2 = 6724$\n\n现在，我们将这些量相加。\n相关系数的分子是偏差乘积之和：\n$$ \\sum_{i=1}^{5} (r_i - \\bar{r})(K_i - \\bar{K}) = -1.216 - 1.216 + 0.064 - 5.576 - 5.576 = -13.52 $$\n\n分母中的项是偏差平方之和：\n$$ \\sum_{i=1}^{5} (r_i - \\bar{r})^2 = 0.001024 + 0.001444 + 0.000064 + 0.006724 + 0.004624 = 0.01388 $$\n$$ \\sum_{i=1}^{5} (K_i - \\bar{K})^2 = 1444 + 1024 + 64 + 4624 + 6724 = 13880 $$\n\n现在，将这些和代入相关系数公式中：\n$$ \\rho_{r,K} = \\frac{-13.52}{\\sqrt{0.01388 \\times 13880}} $$\n$$ \\rho_{r,K} = \\frac{-13.52}{\\sqrt{192.6544}} $$\n$$ \\rho_{r,K} = \\frac{-13.52}{13.8800144} \\approx -0.97406243... $$\n\n将结果四舍五入至三位有效数字，我们得到 -0.974。这个强负相关表明，在此模型和数据下，较高的增长率 $r$ 估计值与较低的承载能力 $K$ 估计值相关联，反之亦然。", "answer": "$$\\boxed{-0.974}$$", "id": "1444240"}, {"introduction": "参数估计本身不是最终目的，我们还必须评估我们的模型是否真实地反映了生物过程。本练习将介绍一种强大的模型验证技术——后验预测检验。你将使用从后验分布中抽取的参数值来模拟新的“虚拟”数据集，并将其与真实的实验数据进行比较，从而以一种稳健的方式评估模型的充分性。[@problem_id:1444232]", "problem": "一位系统生物学家正在研究一个细菌培养物的生长动力学。种群大小 $N(t)$（单位：千个细胞）被假设遵循逻辑斯谛增长模型。逻辑斯谛微分方程的解析解由下式给出：\n$$N(t) = \\frac{K N_0}{N_0 + (K - N_0) \\exp(-rt)}$$\n其中，$t$ 是时间（单位：小时），$N_0$ 是初始种群大小，$r$ 是内禀增长率（单位：$\\text{小时}^{-1}$），$K$ 是环境承载力（单位：千个细胞）。\n\n实验以 $N_0 = 10$ 千个细胞的初始种群开始。在多个时间点测量了种群大小，得到以下实验数据：\n\n| 时间, $t$ (小时) | 种群, $N(t)$ (千个细胞) |\n|:-----------------:|:---------------------------------------:|\n| 10                | 70                                      |\n| 20                | 260                                     |\n| 30                | 510                                     |\n| 40                | 580                                     |\n\n为了推断模型参数 $r$ 和 $K$，该生物学家使用马尔可夫链蒙特卡洛（MCMC）算法进行了贝叶斯分析。这个过程生成了一个后验分布，表示在给定数据的情况下 $r$ 和 $K$ 的可能取值。以下是从该 MCMC 后验分布中抽取的三个代表性样本：\n\n*   样本1：$(r_1, K_1) = (0.19, 610)$\n*   样本2：$(r_2, K_2) = (0.21, 590)$\n*   样本3：$(r_3, K_3) = (0.22, 580)$\n\n您的任务是执行后验预测检验。这包括使用来自后验分布的参数样本来模拟新的生长曲线，并将它们与原始实验数据进行比较。根据您的分析，以下哪个陈述最准确地评估了逻辑斯谛增长模型对该数据集的充分性？\n\nA. 该模型拟合良好。观测数据点被系统地包含在从后验分布模拟的轨迹范围内。这表明该模型足够灵活以解释数据，并且推断出的参数与观测结果一致。\n\nB. 该模型存在系统性偏差，因此拟合效果不佳。例如，在 $t=20$ 小时，所有模拟轨迹预测的种群大小都大于观测数据点 260。这种持续的差异表明该模型无法完全复制观测到的动力学过程。\n\nC. 该模型对数据过拟合。来自样本1的轨迹几乎完美匹配数据点这一事实表明 MCMC 过程找到了一个单一的“最佳”解，而忽略了系统中的真实不确定性。\n\nD. 后验参数样本变化太大，使得模型不具有预测性。模拟轨迹的广泛分布表明参数 $r$ 和 $K$ 没有被数据很好地约束，因此该模型不能用于可靠的预测。", "solution": "我们已知逻辑斯谛解\n$$\nN(t)=\\frac{K N_{0}}{N_{0}+(K-N_{0})\\exp(-r t)},\n$$\n其中 $N_{0}=10$。对于每个后验样本 $(r_{i},K_{i})$，定义预测轨迹\n$$\nN_{i}(t)=\\frac{K_{i} N_{0}}{N_{0}+(K_{i}-N_{0})\\exp(-r_{i} t)}.\n$$\n我们将计算在 $t\\in\\{10,20,30,40\\}$ 处的 $N_{i}(t)$，并与观测数据 $\\{70,260,510,580\\}$ 进行比较。\n\n样本1：$(r_{1},K_{1})=(0.19,610)$。\n这里 $K_{1}-N_{0}=600$ 且 $K_{1}N_{0}=6100$，所以\n$$\nN_{1}(t)=\\frac{6100}{10+600\\exp(-0.19 t)}.\n$$\n- 当 $t=10$ 时：$N_{1}(10)\\approx 61.1$。\n- 当 $t=20$ 时：$N_{1}(20)\\approx 260.4$。\n- 当 $t=30$ 时：$N_{1}(30)\\approx 508.4$。\n- 当 $t=40$ 时：$N_{1}(40)\\approx 592.3$。\n\n样本2：$(r_{2},K_{2})=(0.21,590)$。\n这里 $K_{2}-N_{0}=580$ 且 $K_{2}N_{0}=5900$，所以\n$$\nN_{2}(t)=\\frac{5900}{10+580\\exp(-0.21 t)}.\n$$\n- 当 $t=10$ 时：$N_{2}(10)\\approx 72.8$。\n- 当 $t=20$ 时：$N_{2}(20)\\approx 315.5$。\n- 当 $t=30$ 时：$N_{2}(30)\\approx 533.4$。\n- 当 $t=40$ 时：$N_{2}(40)\\approx 582.3$。\n\n样本3：$(r_{3},K_{3})=(0.22,580)$。\n这里 $K_{3}-N_{0}=570$ 且 $K_{3}N_{0}=5800$，所以\n$$\nN_{3}(t)=\\frac{5800}{10+570\\exp(-0.22 t)}.\n$$\n- 当 $t=10$ 时：$N_{3}(10)\\approx 79.3$。\n- 当 $t=20$ 时：$N_{3}(20)\\approx 341.2$。\n- 当 $t=30$ 时：$N_{3}(30)\\approx 538.1$。\n- 当 $t=40$ 时：$N_{3}(40)\\approx 575.1$。\n\n与在 $(10,20,30,40)$ 小时的观测数据 $(70,260,510,580)$ 的比较：\n- 当 $t=10$ 时：预测值约为 $[61.1, 72.8, 79.3]$。观测值 $70$ 位于此范围内。\n- 当 $t=20$ 时：预测值约为 $[260.4, 315.5, 341.2]$。观测值 $260$ 位于此预测范围之外（所有预测值都大于观测值）。\n- 当 $t=30$ 时：预测值约为 $[508.4, 533.4, 538.1]$。观测值 $510$ 位于此范围内。\n- 当 $t=40$ 时：预测值约为 $[575.1, 582.3, 592.3]$。观测值 $580$ 位于此范围内。\n\n分析表明，对于所提供的三个代表性后验样本，在 $t=20$ 小时，所有模拟的种群大小都持续地高于观测值 260。尽管在其他时间点拟合良好，但这一点揭示了模型可能存在的系统性偏差：模型似乎预测了比实际观测到的更快的早期增长阶段。这种持续的差异表明模型未能完全捕捉观测数据的动态特性。因此，陈述 B 最准确地描述了这种情况。陈述 A 是不正确的，因为观测数据点并未被系统地包含在内。陈述 C 和 D 没有得到计算结果的支持。", "answer": "$$\\boxed{B}$$", "id": "1444232"}]}