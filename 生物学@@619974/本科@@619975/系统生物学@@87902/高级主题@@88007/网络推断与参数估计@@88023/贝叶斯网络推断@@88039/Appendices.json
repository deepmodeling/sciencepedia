{"hands_on_practices": [{"introduction": "掌握贝叶斯网络的第一步是理解其核心——贝叶斯定理。这个练习将我们置于一个非常现实的生物医学情景中：评估一种针对罕见疾病的新诊断测试的可靠性。通过这个实践，你将计算一个阳性测试结果真正意味着患病的概率，这将揭示一个在统计学和日常直觉中经常被忽视的关键概念——基础概率的重要性。这个看似简单的计算是理解更复杂网络中概率推理的基石 [@problem_id:1418735]。", "problem": "在系统生物学领域，研究人员正在为一种名为Kaelan酶缺乏症（KED）的罕见遗传性代谢疾病开发一种新的诊断筛查测试。已知在普通人群中，每8000人中就有1人患有此病。这项新测试基于血液中特定的生物标志物浓度。\n\n该测试的统计验证已确定了以下性能特征：\n1.  该测试的灵敏度，定义为在个体患有KED的条件下测试结果为阳性的概率，为0.995。\n2.  该测试的特异性，定义为在个体未患有KED的条件下测试结果为阴性的概率，为0.980。\n\n从普通人群中随机抽取一个个体并进行此项筛查测试。结果呈阳性。计算该个体确实患有Kaelan酶缺乏症的概率。将最终答案以小数形式表示，并四舍五入至三位有效数字。", "solution": "设 $D$ 表示个体患有KED的事件， $+$ 表示阳性测试结果。患病率为 $P(D) = \\frac{1}{8000}$，因此 $P(D^{c}) = 1 - \\frac{1}{8000} = \\frac{7999}{8000}$。灵敏度为 $P(+ \\mid D) = 0.995$，特异性为 $P(- \\mid D^{c}) = 0.980$，因此 $P(+ \\mid D^{c}) = 1 - 0.980 = 0.020$。\n\n根据贝叶斯定理，\n$$\nP(D \\mid +) = \\frac{P(+ \\mid D)P(D)}{P(+ \\mid D)P(D) + P(+ \\mid D^{c})P(D^{c})}.\n$$\n代入给定值，\n$$\nP(D \\mid +) = \\frac{0.995 \\cdot \\frac{1}{8000}}{0.995 \\cdot \\frac{1}{8000} + 0.020 \\cdot \\frac{7999}{8000}}.\n$$\n分子和分母同乘以 $8000$，\n$$\nP(D \\mid +) = \\frac{0.995}{0.995 + 0.020 \\cdot 7999} = \\frac{0.995}{160.975} = \\frac{995}{160975}.\n$$\n进行数值计算，\n$$\nP(D \\mid +) \\approx 0.006181084\\ldots\n$$\n四舍五入至三位有效数字，结果为 $0.00618$。", "answer": "$$\\boxed{0.00618}$$", "id": "1418735"}, {"introduction": "在掌握了单步贝叶斯推理之后，我们现在将注意力转向由多个相互关联的事件组成的网络。这个练习以一个简化的酶动力学模型为例，其中酶的构象 ($C$) 影响其活性水平 ($A$)，进而决定底物的结合状态 ($B$)，形成一个简单的因果链。你的任务是预测在已知上游原因（酶的构象）的情况下，下游事件（底物未结合）发生的概率，这需要你通过“边缘化”一个我们无法直接观察的中间变量来进行推理。这项练习是学习如何在贝叶斯网络中进行预测性推理的基础 [@problem_id:1418698]。", "problem": "在一个简化的酶动力学模型中，某种特定酶的功能由一个涉及三个随机变量的贝叶斯网络描述：构象 ($C$)、活性水平 ($A$) 和底物结合状态 ($B$)。该网络具有因果结构，其中构象影响活性水平，活性水平进而决定底物结合状态 ($C \\to A \\to B$)。\n\n这些变量具有以下状态：\n-   构象 ($C$)：高活性构象 ($C_H$) 或低活性构象 ($C_L$)。\n-   活性水平 ($A$)：活性 ($A_T$) 或非活性 ($A_I$)。\n-   底物结合状态 ($B$)：结合 ($B_D$) 或未结合 ($B_U$)。\n\n概率关系定义如下：\n\n1.  酶处于高活性构象的先验概率为：\n    $P(C = C_H) = 0.3$\n\n2.  给定酶的构象，其活性水平的条件概率为：\n    $P(A = A_T | C = C_H) = 0.9$\n    $P(A = A_T | C = C_L) = 0.2$\n\n3.  给定酶的活性水平，底物结合状态的条件概率为：\n    $P(B = B_D | A = A_T) = 0.85$\n    $P(B = B_D | A = A_I) = 0.05$\n\n已知观察到一个酶处于其高活性构象 ($C = C_H$)，那么一个底物分子未结合 ($B = B_U$) 的概率是多少？请以精确小数值给出答案。", "solution": "我们被要求在贝叶斯网络 $C \\to A \\to B$ 中计算条件概率 $P(B=B_{U} \\mid C=C_{H})$。根据对中间变量 $A$ 应用全概率公式，并利用在给定 $A$ 的条件下 $B$ 与 $C$ 条件独立，我们有\n$$\nP(B=B_{U} \\mid C=C_{H})=\\sum_{a \\in \\{A_{T},A_{I}\\}} P(B=B_{U} \\mid A=a, C=C_{H})\\,P(A=a \\mid C=C_{H})\n= \\sum_{a \\in \\{A_{T},A_{I}\\}} P(B=B_{U} \\mid A=a)\\,P(A=a \\mid C=C_{H}).\n$$\n根据给定的概率，\n$$\nP(A=A_{T} \\mid C=C_{H})=0.9 \\quad \\Rightarrow \\quad P(A=A_{I} \\mid C=C_{H})=1-0.9=0.1,\n$$\n并且\n$$\nP(B=B_{D} \\mid A=A_{T})=0.85 \\quad \\Rightarrow \\quad P(B=B_{U} \\mid A=A_{T})=1-0.85=0.15,\n$$\n$$\nP(B=B_{D} \\mid A=A_{I})=0.05 \\quad \\Rightarrow \\quad P(B=B_{U} \\mid A=A_{I})=1-0.05=0.95.\n$$\n因此，\n$$\nP(B=B_{U} \\mid C=C_{H})=0.15 \\cdot 0.9 + 0.95 \\cdot 0.1 = 0.135 + 0.095 = 0.23.\n$$", "answer": "$$\\boxed{0.23}$$", "id": "1418698"}, {"introduction": "虽然前面练习中的精确计算对于理解基本原理至关重要，但现实世界中的生物网络——如蛋白质相互作用组或基因调控网络——往往庞大而复杂，使得精确推理变得不切实际甚至不可能。这个练习将向你介绍一种解决此类问题的强大计算工具：吉布斯抽样 (Gibbs sampling)，这是一种马尔可夫链蒙特卡洛 (MCMC) 方法。通过模拟一个蛋白质复合物形成过程中的一个抽样步骤，你将亲身体验近似推理算法的内部工作原理，了解在面对复杂性时，我们如何能够有效地估计系统的概率特性 [@problem_id:1418760]。", "problem": "在系统生物学中，蛋白质相互作用通常被建模为一个网络，其中每个蛋白质的状态都会影响其邻近的蛋白质。考虑一个用于描述蛋白质复合物形成的简化模型，该复合物由四个蛋白质 P1、P2、P3 和 P4 组成的线性链表示。\n\n每个蛋白质 $P_i$ 的状态由一个二元变量 $X_i \\in \\{0, 1\\}$ 描述，其中 $X_i=1$ 表示该蛋白质处于“激活”状态（被招募到复合物中），而 $X_i=0$ 表示它处于“非激活”状态。\n\n该系统的行为由一个遵循玻尔兹曼分布的联合概率分布描述，$P(X_1, X_2, X_3, X_4) \\propto \\exp(-E/k_B T)$，其中 $k_B$ 是玻尔兹曼常数，$T$ 是温度。能量函数 $E$ 取决于链中相邻蛋白质之间的相互作用：\n$$E(X_1, X_2, X_3, X_4) = -J(X_1 X_2 + X_2 X_3 + X_3 X_4)$$\n此处，$J > 0$ 是一个代表相互作用强度的常数，它在能量上有利于相邻蛋白质处于相同状态。为方便表示，所有热效应都并入一个单一的无量纲参数 $\\alpha = J/(k_B T)$。因此，给定构型 $\\mathbf{X} = (X_1, X_2, X_3, X_4)$ 的概率可以表示为：\n$$P(\\mathbf{X}) \\propto \\exp(\\alpha (X_1 X_2 + X_2 X_3 + X_3 X_4))$$\n\n为研究该系统的性质（在真实世界场景中，该系统过于庞大，无法进行精确推断），一位研究人员采用了吉布斯采样。这种迭代方法包括在给定所有其他变量当前状态的条件下，从其条件概率分布中逐个对每个变量进行采样。\n\n假设经过数次迭代后，系统处于状态 $(X_1=1, X_3=0, X_4=1)$。根据吉布斯采样协议，下一步是通过从其条件概率分布中为 $X_2$ 抽取一个新值来更新蛋白质 P2 的状态。计算蛋白质 P2 的新状态为激活状态的概率，即，求出 $P(X_2=1 | X_1=1, X_3=0, X_4=1)$。将您的答案表示为 $\\alpha$ 的函数。", "solution": "我们使用带有给定能量的玻尔兹曼分布，因此对于任何构型 $\\mathbf{X}$，\n$$\nP(\\mathbf{X}) \\propto \\exp\\!\\left(\\alpha\\,(X_{1}X_{2}+X_{2}X_{3}+X_{3}X_{4})\\right).\n$$\n在吉布斯采样中，用于更新 $X_{2}$ 的条件概率为\n$$\nP(X_{2}=1 \\mid X_{1},X_{3},X_{4})=\\frac{P(X_{2}=1,X_{1},X_{3},X_{4})}{P(X_{2}=0,X_{1},X_{3},X_{4})+P(X_{2}=1,X_{1},X_{3},X_{4})}.\n$$\n对于固定的 $(X_{1},X_{3},X_{4})$，指数中依赖于 $X_{2}$ 的项是 $\\alpha(X_{1}X_{2}+X_{2}X_{3})$，而 $\\alpha X_{3}X_{4}$ 与 $X_{2}$ 无关，因而在条件比率中被约分消去。因此，\n$$\nP(X_{2}=x \\mid X_{1},X_{3},X_{4}) \\propto \\exp\\!\\left(\\alpha\\,(X_{1}x+xX_{3})\\right).\n$$\n从而，\n$$\nP(X_{2}=1 \\mid X_{1},X_{3},X_{4})=\\frac{\\exp\\!\\left(\\alpha\\,(X_{1}+X_{3})\\right)}{\\exp\\!\\left(\\alpha\\,(X_{1}+X_{3})\\right)+\\exp(0)}=\\frac{\\exp\\!\\left(\\alpha\\,(X_{1}+X_{3})\\right)}{1+\\exp\\!\\left(\\alpha\\,(X_{1}+X_{3})\\right)}.\n$$\n代入给定值 $X_{1}=1$, $X_{3}=0$, $X_{4}=1$（注意 $X_{4}$ 不影响条件概率），\n$$\nP(X_{2}=1 \\mid X_{1}=1,X_{3}=0,X_{4}=1)=\\frac{\\exp(\\alpha)}{1+\\exp(\\alpha)}=\\frac{1}{1+\\exp(-\\alpha)}.\n$$", "answer": "$$\\boxed{\\frac{1}{1+\\exp(-\\alpha)}}$$", "id": "1418760"}]}