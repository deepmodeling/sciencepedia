{"hands_on_practices": [{"introduction": "在进行拔靴法分析时，第一步也是最关键的一步是能够正确解读其输出。本练习提供了一个在系统生物学中常见的场景——细菌持久性，你将使用一个已经完成的拔靴法分析结果来估计持久性细胞比例的置信区间。这个练习旨在帮助你熟悉拔靴法百分位置信区间的基本概念，并理解如何从排序后的拔靴法统计量分布中提取不确定性的量化指标 [@problem_id:1420137]。", "problem": "一位系统生物学研究者正在研究细菌持久性，这是一种微生物种群中的一小部分在致命剂量的抗生素作用下存活下来的现象。该研究者用八个重复的*大肠杆菌*（*Escherichia coli*）培养物进行了一项实验。每个培养物都用高浓度的氨苄青霉素处理，经过一段时间后，通过计数剩余的菌落形成单位（CFUs）来确定存活分数。测量到以下八个存活分数：\n$$ \\{1.72, 1.41, 1.55, 3.15, 1.63, 1.88, 1.39, 1.61\\} \\times 10^{-5} $$\n为了量化从未经正态分布的小数据集中估计真实平均存活分数的不确定性，研究者进行了一项计算拔靴法分析（computational bootstrap analysis）。该分析包括从原始数据中生成 $B=10,000$ 个拔靴法重抽样样本，并计算每个重抽样样本的平均值。这样就得到了一个包含10,000个拔靴法平均值的分布。将这些平均值按升序排序后，记录了排序后列表中的关键值。在排序后的列表中，特定位置的值如下：\n- 第250个值：$1.59 \\times 10^{-5}$\n- 第500个值：$1.64 \\times 10^{-5}$\n- 第9500个值：$2.31 \\times 10^{-5}$\n- 第9750个值：$2.42 \\times 10^{-5}$\n\n利用拔靴法分析的这些信息，使用百分位数法确定平均存活分数的90%置信区间。给出该区间的下限和上限。用 $10^{-5}$ 作为单位表示你的最终答案的下限和上限，并将每个值四舍五入到三位有效数字。", "solution": "我们想用拔靴法百分位数法求出平均值的90%置信区间。设 $B$ 为拔靴法重抽样的次数，设 $\\{\\bar{x}^{*(1)},\\ldots,\\bar{x}^{*(B)}\\}$ 表示按升序排列的拔靴法平均值。对于名义覆盖率为 $1-\\alpha=0.90$ 的双侧百分位数区间，其下限和上限取自排序后拔靴法分布的经验分位数 $p_{\\text{lower}}=\\alpha/2$ 和 $p_{\\text{upper}}=1-\\alpha/2$：\n$$\n\\text{CI}_{\\text{percentile}}=\\left[\\bar{x}^{*}_{(\\lfloor p_{\\text{lower}} B \\rfloor)}\\,,\\,\\bar{x}^{*}_{(\\lceil p_{\\text{upper}} B \\rceil)}\\right].\n$$\n这里 $B=10000$ 且 $\\alpha=0.10$，所以\n$$\np_{\\text{lower}}=0.05,\\quad p_{\\text{upper}}=0.95,\\quad p_{\\text{lower}} B=500,\\quad p_{\\text{upper}} B=9500.\n$$\n题目给出了在这些位置上精确的排序后拔靴法值：\n- 第500个值（0.05分位数）：$1.64 \\times 10^{-5}$，\n- 第9500个值（0.95分位数）：$2.31 \\times 10^{-5}$。\n因此，平均存活分数的90%拔靴法百分位置信区间是\n$$\n\\left[1.64 \\times 10^{-5},\\,2.31 \\times 10^{-5}\\right].\n$$\n以 $10^{-5}$ 为单位表示这些界限，得到数对 $\\left(1.64,\\,2.31\\right)$，这已经保留了三位有效数字。", "answer": "$$\\boxed{\\begin{pmatrix}1.64 & 2.31\\end{pmatrix}}$$", "id": "1420137"}, {"introduction": "拔靴法的强大之处在于其广泛的适用性，包括估计比例这类非均值参数的不确定性。本练习将带你进入深度突变扫描（DMS）的前沿领域，任务是量化中性突变所占比例的不确定性。这个问题挑战你将经验性的重抽样过程与一个理论模型（二项分布）联系起来，这不仅展示了拔靴法的灵活性，也揭示了在某些情况下利用理论分布来简化计算的有效途径 [@problem_id:1420152]。", "problem": "一个系统生物学实验室正在使用深度突变扫描 (DMS) 来研究一种特定酶中单氨基酸取代的功能性后果。这项高通量实验为每个突变产生一个连续的“适应度分数”$s$。适应度分数为 $s=0$ 表示中性突变（对功能无影响），$s<0$ 表示有害突变，而 $s>0$ 表示有益突变。\n\n由于固有的实验噪声和检测方法的分辨率，任何适应度分数 $s$ 在范围 $|s| \\le 0.05$ 内的突变都被认为是功能上中性的。在一项初步实验中，为 25 个不同的突变测量得到了以下 25 个适应度分数：\n$S = [-1.21, -0.99, -0.87, -0.65, -0.53, -0.48, -0.33, -0.29, -0.21, -0.15, -0.11, -0.08, -0.04, -0.02, 0.01, 0.03, 0.04, 0.07, 0.10, 0.14, 0.22, 0.35, 0.58, 0.91, 1.15]$\n\n为了基于这个有限的样本来量化中性突变比例的统计不确定性，你的任务是执行一次重抽样分析。具体来说，你的目标是确定中性突变真实比例的 95% 置信区间。为此，你需要构想生成 $B=10000$ 个重抽样数据集。每个重抽样数据集都是通过从原始数据集 $S$ 中*有放回地*抽取 25 个适应度分数来构建的。对于这 $10000$ 个重抽样数据集中的每一个，需要计算其中性突变的比例。95% 置信区间则由这 10000 个比例值构成的分布的第 2.5 和第 97.5 百分位数给出。\n\n计算这个 95% 置信区间的下界和上界。以一对数值（下界在前）的形式报告你的答案，并保留三位有效数字。", "solution": "我们首先将每个适应度分数 $s \\in S$ 分类：如果 $|s| \\leq 0.05$，则其为中性。在给定的列表中，\n$$S = [-1.21, -0.99, -0.87, -0.65, -0.53, -0.48, -0.33, -0.29, -0.21, -0.15, -0.11, -0.08, -0.04, -0.02, 0.01, 0.03, 0.04, 0.07, 0.10, 0.14, 0.22, 0.35, 0.58, 0.91, 1.15],$$\n中性分数为 $-0.04, -0.02, 0.01, 0.03, 0.04$，因此在总共 $n=25$ 个突变中，中性突变数量为 $c=5$。观测到的中性突变比例为\n$$\\hat{p} = \\frac{c}{n} = \\frac{5}{25} = 0.2.$$\n\n在拔靴法 (bootstrap) 流程中，每个重抽样数据集都是通过从 $S$ 中有放回地抽取 $n=25$ 个分数来构建的。每次抽样都来自为每个观测值赋予 $1/n$ 概率质量的经验分布；因此，单次抽样抽中中性突变的概率等于 $\\hat{p}$。因此，在一个拔靴法重抽样样本中，中性突变的数量 $K$ 服从\n$$K \\sim \\operatorname{Binomial}(n, \\hat{p}), \\quad \\text{with } n=25, \\ \\hat{p}=0.2.$$\n中性突变比例的拔靴法分布为 $K/n$。95% 拔靴法百分位置信区间对应于 $K/n$ 的 $0.025$ 和 $0.975$ 分位数，即，存在值 $k_{\\mathrm{L}}$ 和 $k_{\\mathrm{U}}$ 使得：\n$$\\Pr(K \\leq k_{\\mathrm{L}}) \\geq 0.025 \\ \\text{and} \\ \\Pr(K \\leq k_{\\mathrm{L}}-1) < 0.025,$$\n$$\\Pr(K \\leq k_{\\mathrm{U}}) \\geq 0.975 \\ \\text{and} \\ \\Pr(K \\leq k_{\\mathrm{U}}-1) < 0.975.$$\n\n二项概率为\n$$\\Pr(K=k) = \\binom{25}{k} (0.2)^{k} (0.8)^{25-k}.$$\n使用 $P_{k}=\\Pr(K=k)$ 和以下递推关系计算下尾部概率：\n$$\\frac{P_{k+1}}{P_{k}} = \\frac{25-k}{k+1} \\cdot \\frac{0.2}{0.8} = \\frac{25-k}{k+1} \\cdot 0.25.$$\n从\n$$P_{0} = 0.8^{25} \\approx 0.003776,$$\n$$P_{1} = P_{0} \\cdot 25 \\cdot 0.25 \\approx 0.0236,$$\n开始计算，所以\n$$\\Pr(K \\leq 0) \\approx 0.003776 < 0.025,\\quad \\Pr(K \\leq 1) \\approx 0.003776 + 0.0236 = 0.0274 \\geq 0.025.$$\n因此 $k_{\\mathrm{L}}=1$，得到下界 $k_{\\mathrm{L}}/n = 1/25 = 0.04$。\n\n对于上尾部，我们继续计算累积和：\n$$P_{2} = 3 P_{1} \\approx 0.0708,\\ \\ P_{3} \\approx 0.1356,\\ \\ P_{4} \\approx 0.1865,\\ \\ P_{5} \\approx 0.1958,$$\n$$P_{6} \\approx 0.1631,\\ \\ P_{7} \\approx 0.1107,\\ \\ P_{8} \\approx 0.06227,\\ \\ P_{9} \\approx 0.02941.$$\n累积概率：\n$$\\Pr(K \\leq 8) \\approx 0.9521 < 0.975,\\quad \\Pr(K \\leq 9) \\approx 0.9815 \\geq 0.975.$$\n因此 $k_{\\mathrm{U}}=9$，得到上界 $k_{\\mathrm{U}}/n = 9/25 = 0.36$。\n\n因此，使用所述的拔靴法百分位方法，中性突变真实比例的 95% 置信区间为 $[0.04, 0.36]$。保留三位有效数字后，该区间为 $[0.0400, 0.360]$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.0400 & 0.360 \\end{pmatrix}}$$", "id": "1420152"}]}