{"hands_on_practices": [{"introduction": "赤池信息准则 (AIC) 和贝叶斯信息准则 (BIC) 都在模型拟合优度和模型复杂度之间寻求平衡，但它们惩罚复杂性的方式不尽相同。这个练习将核心集中在两个准则的“惩罚项”上，通过一个具体的计算，让你直接比较它们是如何惩罚模型复杂性的。理解它们在惩罚力度上的差异，是掌握这两种准则不同行为和适用场景的第一步。[@problem_id:1936657]", "problem": "一位生态学家正在分析一个关于物种丰度随时间变化的数据集，该数据集包含 $n=50$ 个不同的观测值。他们正在考虑一个特定的种群动态模型，该模型需要从数据中估计 $k=5$ 个自由参数。为了在惩罚复杂度的同时评估模型质量，他们使用了两种常用的信息准则。\n\n赤池信息准则 (AIC) 定义为 $\\text{AIC} = 2k - 2\\ln(\\mathcal{L})$，而贝叶斯信息准则 (BIC) 定义为 $\\text{BIC} = k\\ln(n) - 2\\ln(\\mathcal{L})$。在这些公式中，$\\mathcal{L}$ 是模型似然函数的最大化值，$k$ 是估计参数的数量，而 $n$ 是观测值的数量。\n\n$2k$ (对于 AIC) 和 $k\\ln(n)$ (对于 BIC) 这两项被称为“惩罚项”，因为随着模型复杂度（即参数数量 $k$）的增加，它们会使准则的值增大。\n\n对于这个特定的模型和数据集，计算 BIC 惩罚项与 AIC 惩罚项之间的差值。将答案表示为一个数值，并四舍五入到三位有效数字。", "solution": "AIC 的惩罚项是 $2k$，BIC 的惩罚项是 $k\\ln(n)$。其差值（BIC 惩罚项减去 AIC 惩罚项）为\n$$\nk\\ln(n) - 2k = k\\left(\\ln(n) - 2\\right).\n$$\n代入 $k=5$ 和 $n=50$ 得\n$$\n5\\left(\\ln(50) - 2\\right).\n$$\n使用数值 $\\ln(50) \\approx 3.912023$，我们得到\n$$\n5\\left(3.912023 - 2\\right) = 5 \\times 1.912023 = 9.560115.\n$$\n四舍五入到三位有效数字，结果是 $9.56$。", "answer": "$$\\boxed{9.56}$$", "id": "1936657"}, {"introduction": "理论最终要应用于实践。在系统生物学中，我们常常需要面对描述同一生物过程的多个竞争模型。这个练习模拟了一个常见的研究场景：利用BIC来判断一个更复杂的模型是否因其对数据的更佳拟合而变得合理，或者一个更简单的模型是否已经足够。通过这个练习，你将学会如何应用BIC作为决策工具，在不同的假设之间做出选择。[@problem_id:1447591]", "problem": "一位系统生物学家正在研究一种特定菌株在营养环境波动下的种群动态。提出了两个相互竞争的数学模型，模型 A 和模型 B，来描述细菌的生长。该生物学家进行了一项实验，并收集了一个时间序列数据集，其中包含 $n=200$ 个细菌种群密度的测量值。\n\n模型 A 是一个较简单的模型，有 $k_A = 3$ 个可调参数。将此模型与实验数据拟合后，似然函数的自然对数的最大值为 $\\ln(\\mathcal{L}_A) = -180.5$。\n\n模型 B 是一个更复杂的模型，它包含了额外的动态特性，共有 $k_B = 5$ 个可调参数。将此模型与相同的数据集拟合，得到最大自然对数似然值为 $\\ln(\\mathcal{L}_B) = -177.0$。\n\n为了在惩罚复杂度的同时判断哪个模型更好地被数据支持，研究人员使用了贝叶斯信息准则 (Bayesian Information Criterion, BIC)。BIC 的计算公式为：\n$$BIC = k \\ln(n) - 2 \\ln(\\mathcal{L})$$\n其中 $k$ 是模型中的参数数量，$n$ 是数据点的数量，而 $\\ln(\\mathcal{L})$ 是最大自然对数似然值。BIC 分数较低的模型被认为更拟合数据。\n\n为了量化一个模型相对于另一个模型的证据，计算差值 $\\Delta BIC = BIC_{B} - BIC_{A}$。请将您的 $\\Delta BIC$ 答案表示为一个四舍五入到三位有效数字的实数。", "solution": "对于一个参数数量为 $k$、样本大小为 $n$、最大对数似然值为 $\\ln(\\mathcal{L})$ 的模型，其贝叶斯信息准则为\n$$\nBIC = k \\ln(n) - 2 \\ln(\\mathcal{L}).\n$$\n对于模型 A，有 $k_{A} = 3$，$n = 200$，以及 $\\ln(\\mathcal{L}_{A}) = -180.5$，\n$$\nBIC_{A} = 3 \\ln(200) - 2(-180.5) = 3 \\ln(200) + 361.\n$$\n对于模型 B，有 $k_{B} = 5$，$n = 200$，以及 $\\ln(\\mathcal{L}_{B}) = -177.0$，\n$$\nBIC_{B} = 5 \\ln(200) - 2(-177.0) = 5 \\ln(200) + 354.\n$$\n差值为\n$$\n\\Delta BIC = BIC_{B} - BIC_{A} = \\left(5 \\ln(200) + 354\\right) - \\left(3 \\ln(200) + 361\\right) = 2 \\ln(200) - 7.\n$$\n数值计算 $\\ln(200)$：\n$$\n\\ln(200) = \\ln(2) + 2 \\ln(10) \\approx 0.6931471806 + 2 \\times 2.302585093 \\approx 5.298317367.\n$$\n因此，\n$$\n\\Delta BIC \\approx 2 \\times 5.298317367 - 7 = 10.596634734 - 7 = 3.596634734.\n$$\n四舍五入到三位有效数字，得到 $3.60$。", "answer": "$$\\boxed{3.60}$$", "id": "1447591"}, {"introduction": "模型选择准则虽然强大，但其正确使用依赖于一些基本假设。这个问题揭示了一个在实践中至关重要的概念陷阱：直接比较在不同数据尺度（例如，原始数据与对数转换后的数据）上拟合的模型的AIC或BIC值。理解为什么这种比较是无效的，将加深你对似然函数这一核心概念的掌握，而似然函数正是这些信息准则的统计学基石。[@problem_id:1447532]", "problem": "一位系统生物学的研究者正在研究细胞培养物中荧光蛋白的降解。他们在$i=1, \\dots, n$的一系列时间点$t_i$收集荧光强度数据$y_i$。该研究者为这个过程提出了一个简单的指数衰减模型。然而，他们不确定是应该将模型拟合到原始荧光数据，还是拟合到数据的自然对数上。\n\n我们定义两种方法：\n- **模型 A**：将函数 $f_A(t, a, b) = a \\exp(-bt)$ 直接拟合到原始数据$y_i$。该模型假设观测数据点$y_i$是来自均值为$f_A(t_i, a, b)$、方差恒为$\\sigma_A^2$的正态分布的样本。\n- **模型 B**：将线性函数 $f_B(t, c, d) = c - dt$ 拟合到对数转换后的数据 $z_i = \\ln(y_i)$。这等价于拟合模型 $y(t) = \\exp(c - dt)$，其形式与模型 A 相同。该模型假设转换后的数据点$z_i$是来自均值为$f_B(t_i, c, d)$、方差恒为$\\sigma_B^2$的正态分布的样本。\n\n在进行两种拟合后，研究者为每个模型计算了贝叶斯信息准则 (BIC)，其定义为 $BIC = k \\ln(n) - 2 \\ln(\\hat{L})$，其中$k$是估计参数的数量，$n$是数据点的数量，$\\hat{L}$是似然函数的最大化值。他们发现模型 B 的 BIC 值显著低于模型 A 的 BIC 值（根据该准则，这表明拟合效果更好）。他们得出结论，对于这个数据集，将模型拟合到对数转换后的数据是更优的方法。\n\n以下哪个陈述提供了最根本且统计上最严谨的理由，来解释为什么研究者对这两个 BIC 值的直接比较是无效的？\n\nA. BIC 仅对误差已知为完全正态分布的模型有效，而数据的对数转换可能扭曲了先前为正态的误差分布。\n\nB. 对数转换改变了因变量的尺度，这人为地且不公平地减小了残差平方和，从而导致模型 B 的 BIC 值无效地偏小。\n\nC. 这两个模型不是相互嵌套的，而 BIC 只能用于比较嵌套模型。\n\nD. 似然 $\\hat{L}_A$ 和 $\\hat{L}_B$ 是针对不同的概率密度函数（一个针对变量 $Y$，一个针对变量 $Z = \\ln(Y)$）计算的，因此它们不在一个可比较的尺度上。\n\nE. 两个模型的参数数量 $k$ 不同，因为模型 B 包含一个隐含的转换参数，而这个参数在 BIC 计算中没有被计入。", "solution": "设观测数据为 $y_{1},\\dots,y_{n}$，对应时间为 $t_{1},\\dots,t_{n}$，其中对所有 $i$ 有 $z_{i}=\\ln(y_{i})$。\n\n在模型 A 下，原始尺度上的观测模型为\n$$\nY_{i}\\mid a,b,\\sigma_{A}^{2} \\sim \\mathcal{N}\\!\\left(\\mu_{i},\\sigma_{A}^{2}\\right),\\quad \\mu_{i}=a\\exp(-b t_{i}),\n$$\n因此，对于观测到的 $y_{1:n}$，其对数似然为\n$$\n\\ell_{A}(a,b,\\sigma_{A}^{2})\n= -\\frac{n}{2}\\ln(2\\pi) - n\\ln(\\sigma_{A}) - \\frac{1}{2\\sigma_{A}^{2}} \\sum_{i=1}^{n} \\left(y_{i}-a\\exp(-b t_{i})\\right)^{2}.\n$$\n\n在模型 B 下（在对数尺度上拟合），模型为\n$$\nZ_{i}=\\ln(Y_{i}) \\mid c,d,\\sigma_{B}^{2} \\sim \\mathcal{N}\\!\\left(\\eta_{i},\\sigma_{B}^{2}\\right),\\quad \\eta_{i}=c-d t_{i}.\n$$\n转换后数据 $z_{1:n}$ 的对数似然为\n$$\n\\ell_{B,Z}(c,d,\\sigma_{B}^{2})\n= -\\frac{n}{2}\\ln(2\\pi) - n\\ln(\\sigma_{B}) - \\frac{1}{2\\sigma_{B}^{2}} \\sum_{i=1}^{n} \\left(\\ln y_{i} - (c - d t_{i})\\right)^{2}.\n$$\n\n然而，BIC 是从观测数据的对数边际似然的渐近近似推导出来的。为了在同等基础上比较模型，两个似然都必须是针对同一观测变量写的。由模型 B 所隐含的关于 $Y$ 的似然可以通过变量转换得到。由于 $z=\\ln y$ 是单调函数，其反函数为 $y=\\exp z$，雅可比式为 $\\left|\\frac{dy}{dz}\\right|=y$，因此在模型 B 下，$Y$ 的隐含密度为\n$$\np_{Y|B}(y_{i}\\mid c,d,\\sigma_{B}^{2})\n= p_{Z|B}(\\ln y_{i}\\mid c,d,\\sigma_{B}^{2}) \\cdot \\frac{1}{y_{i}}\n= \\frac{1}{y_{i}\\,\\sigma_{B}\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{(\\ln y_{i}-(c-d t_{i}))^{2}}{2\\sigma_{B}^{2}}\\right),\n$$\n对于 $y_{i}>0$。因此，在模型 B 下，观测到的 $y_{1:n}$ 的对数似然为\n$$\n\\ell_{B,Y}(c,d,\\sigma_{B}^{2})\n= \\ell_{B,Z}(c,d,\\sigma_{B}^{2}) - \\sum_{i=1}^{n} \\ln y_{i}.\n$$\n项 $-\\sum_{i=1}^{n}\\ln y_{i}$ 是对数雅可比项，它仅依赖于数据和转换，而不依赖于 $(c,d,\\sigma_{B}^{2})$。\n\n用于模型比较的 BIC 是 $BIC = k \\ln(n) - 2 \\ln(\\hat{L})$，其中 $\\hat{L}$ 是模型下观测数据的最大化似然值。因此，与模型 A 可比较的模型 B 的正确 BIC 必须使用为 $Y$ 计算的 $\\hat{L}$，即\n$$\nBIC_{B,\\text{correct}} \\;=\\; k_{B}\\ln(n) - 2\\ln \\hat{L}_{B}(Y)\n\\;=\\; k_{B}\\ln(n) - 2\\left(\\ln \\hat{L}_{B}(Z) - \\sum_{i=1}^{n}\\ln y_{i}\\right)\n\\;=\\; \\bigl(k_{B}\\ln(n) - 2\\ln \\hat{L}_{B}(Z)\\bigr) + 2\\sum_{i=1}^{n}\\ln y_{i}.\n$$\n如果研究者直接比较由 $\\ln \\hat{L}_{A}(Y)$ 计算出的 $BIC_{A}$ 和由 $\\ln \\hat{L}_{B}(Z)$ 计算出的 $BIC_{B}$，他们实际上是在比较定义在不同样本空间和不同基测度上的似然。缺失的对数雅可比项意味着这两个 BIC 值不在一个共同的尺度上。严谨的要求是使用针对同一观测变量的似然来比较模型；等价地，要包含雅可比项，以使两个 BIC 值都是从关于 $Y$ 的 $\\ln \\hat{L}$ 计算得出。\n\n因此，这种直接比较之所以无效，最根本且统计上最严谨的原因是，似然是针对不同的概率密度函数计算的（一个针对 $Y$，一个针对 $Z=\\ln Y$），因此若不进行变量转换的调整，它们就不能直接比较。这对应于选项 D。作为补充说明：BIC 可以比较非嵌套模型，所以 C 是错误的；正态性是每个模型内部的一个建模假设，其本身不会使 BIC 无效，所以 A 是错误的；关于残差平方和尺度的说法（B）在使用基于似然的准则时并非根本问题；并且模型 B 中没有额外的对数转换参数，所以 E 是错误的。", "answer": "$$\\boxed{D}$$", "id": "1447532"}]}