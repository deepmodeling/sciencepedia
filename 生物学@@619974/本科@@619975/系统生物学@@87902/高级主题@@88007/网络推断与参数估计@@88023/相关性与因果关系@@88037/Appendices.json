{"hands_on_practices": [{"introduction": "在系统生物学研究中，我们常常会遇到两个变量随时间同步变化的情况，其相关性系数甚至可能接近完美。本练习 [@problem_id:1425320] 呈现了一个经典场景：一个核心生物钟基因的表达与细胞的能量货币ATP的浓度高度相关。这个练习旨在训练你的批判性思维，抵制“高相关性等于因果关系”的诱惑，并引导你思考一个更深层次的可能性——是否存在一个共同的上游驱动因素在同时调控这两个变量？", "problem": "一位系统生物学家正在研究生物钟与细胞代谢之间的相互作用。该研究人员使用了一群经过化学同步化处理的培养人体细胞，使它们同步地进行其24小时的代谢和基因表达周期。在48小时内，每小时进行一次测量。数据显示，一个我们称之为`Gene-C`的核心生物钟基因的表达水平与细胞内三磷酸腺苷（ATP）的总浓度之间存在着强烈的、统计上显著的正相关性（Pearson相关系数 $r > 0.9$）。`Gene-C`的表达和ATP的浓度都以大约24小时为周期进行振荡，在几乎相同的时间达到峰值和谷值。\n\n**仅**根据这一观测数据，以下哪个陈述是对该发现最科学准确且严谨的解释？\n\nA. 数据表明`Gene-C`的蛋白质产物是一种直接催化ATP合成中关键反应的酶。\n\nB. 数据证明，由ATP浓度代表的细胞能量状态是决定`Gene-C`表达时间和幅度的主要调控信号。\n\nC. 强相关性意味着必然存在直接的因果关系。因此，要么是`Gene-C`的表达控制ATP水平，要么是ATP水平控制`Gene-C`的表达。\n\nD. 数据显示了两个变量之间的强关联性，但其本身无法区分几种可能性：`Gene-C`的活性调节ATP水平，ATP水平调节`Gene-C`的表达，或者两者都由中央生物钟振荡器的一个共同上游组分共同调节。\n\nE. 由于这种相关性是在高度受控的细胞培养实验中观察到的，与不受控的人群研究不同，因此观察到的关联可以被确信地解释为因果关系。", "solution": "我们得到的是同步化细胞中的观测时间序列数据，该数据显示一个核心生物钟基因（表示为Gene-C）的表达与细胞内ATP浓度均以约24小时为周期振荡，峰值和谷值几乎同时出现，并且它们的Pearson相关系数满足 $r>0.9$。推论必须仅限于这种在时间序列背景下的观测相关性所能严格支持的范围。\n\n首先，根据定义，两个采样序列 $\\{x_{i}\\}$ 和 $\\{y_{i}\\}$ 之间的Pearson相关系数为\n$$\nr=\\frac{\\sum_{i=1}^{n}\\left(x_{i}-\\bar{x}\\right)\\left(y_{i}-\\bar{y}\\right)}{\\sqrt{\\sum_{i=1}^{n}\\left(x_{i}-\\bar{x}\\right)^{2}}\\sqrt{\\sum_{i=1}^{n}\\left(y_{i}-\\bar{y}\\right)^{2}}}.\n$$\n一个大于0.9的 $r$ 值表示存在强线性关联，但仅凭相关性不能确定因果关系或其方向。在具有共同周期性驱动因素的时间序列中，即使被测变量之间没有直接的因果关系，也可能出现高相关性。\n\n为了将其形式化，假设两个测量值都由一个潜在的生物钟振荡器 $Z(t)$ 驱动，其基本角频率为 $\\omega=\\frac{2\\pi}{T}$，其中 $T\\approx 24\\,\\text{hours}$。一个最小模型是\n$$\nX(t)=\\alpha_{X}+A_{X}\\cos\\left(\\omega t+\\phi\\right)+\\epsilon_{X}(t),\\quad Y(t)=\\alpha_{Y}+A_{Y}\\cos\\left(\\omega t+\\phi\\right)+\\epsilon_{Y}(t),\n$$\n其中 $X(t)$ 代表Gene-C的表达，$Y(t)$ 代表ATP的浓度，$\\phi$ 编码了它们近乎同相的对齐关系，而 $\\epsilon_{X}$ 和 $\\epsilon_{Y}$ 是噪声项。如果 $\\epsilon_{X}$ 和 $\\epsilon_{Y}$ 相对于振荡幅度很小，那么协方差 $\\operatorname{Cov}(X,Y)$ 将主要由乘积 $A_{X}A_{Y}\\operatorname{Var}(\\cos(\\omega t+\\phi))$ 决定，相应的 $r$ 值将接近1。即使 $X$ 不导致 $Y$ 且 $Y$ 也不导致 $X$，只要它们都是一个共同驱动因素 $Z(t)$ 的函数，这种高相关性也可能发生：\n$$\nX(t)=f\\bigl(Z(t)\\bigr)+\\epsilon_{X}(t),\\quad Y(t)=g\\bigl(Z(t)\\bigr)+\\epsilon_{Y}(t).\n$$\n因此，观察到振荡同相的强相关性与多种因果结构是一致的：$X\\rightarrow Y$，$Y\\rightarrow X$，或 $Z\\rightarrow X$ 和 $Z\\rightarrow Y$（由上游生物钟组分共同调节）等等。如果没有干预措施（例如，对Gene-C或ATP通路进行 $\\mathrm{do}(\\cdot)$ 操作）或额外的分析来确定时间上的优先顺序并排除混杂因素，那么仅凭相关性无法推断出方向性及机制。\n\n现在评估每个选项：\n\nA. 该选项断言了一个特定的分子机制（Gene-C蛋白是一种ATP合成酶）。观测到的相关性不能确定分子功能；这样的主张需要生物化学证据。因此该选项无证据支持。\n\nB. 该选项声称证明了ATP是控制Gene-C表达的主要调控信号。相关性不能证明方向性或主要性；它也可能与相反方向的因果关系或由生物钟共同调节的情况相符。\n\nC. 该选项声称必然存在单向的直接因果关系。这排除了共同原因的可能性，而考虑到有一个生物钟振荡器同时驱动两者，共同原因的可能性是完全合理的。因此该选项不正确。\n\nD. 该选项指出，数据展示了强关联性，但无法区分是Gene-C调节ATP，还是ATP调节Gene-C，抑或是由一个上游生物钟组分共同调节。这是恰当、谨慎且严谨的解释。\n\nE. 该选项声称细胞培养中的受控条件意味着因果关系。受控条件确实减少了一些混杂因素，但在没有进行扰动或采用能够进行因果推断的设计的情况下，体外实验中的观测关联仍然不能确定因果关系。\n\n因此，最科学准确且严谨的解释是选项D。", "answer": "$$\\boxed{D}$$", "id": "1425320"}, {"introduction": "当我们观察到一个相关性后，仅仅保持怀疑是不够的；科学的下一步是设计实验来检验各种因果假设。本练习 [@problem_id:1425392] 将带你从被动的观察者转变为主动的实验设计者。面对一个负相关现象和三种可能的因果解释（正向因果、反向因果、共同原因），你将评估一个巧妙的干预实验——利用诱导型启动子——如何帮助我们排除其中一种假设，从而向揭示真相迈出关键一步。", "problem": "一位系统生物学家正在研究一个在充分混合的恒定环境中生长的克隆细菌种群。她使用单细胞成像技术，量化了数千个单细胞中一种特定应激反应蛋白（S蛋白）的浓度和瞬时生长速率 $\\mu$。她观察到这两个变量之间存在很强的负相关性：S蛋白水平较高的细胞，其生长速率始终较低。\n\n为解释这一观察结果，提出了三个主要假设：\n*   **假设1（代谢成本）：** S蛋白的生产和维持具有代谢成本，会消耗本可用于生长的细胞资源。因此，高浓度的S蛋白是导致生长速率降低的直接原因。\n*   **假设2（生长感知）：** 由于随机、偶然的原因，本质上生长较慢的细胞会将其自身状态感知为“不健康”或“有压力”。这种内部状态会触发S蛋白的表达增加，作为一种保护性反应。因此，低生长速率是导致S蛋白浓度增加的原因。\n*   **假设3（共同原因）：** 单个细胞的局部微环境存在隐藏的、微观的波动（例如，短暂的营养限制或细胞附近代谢副产物的积累）。这些局部的“应激”事件独立地导致S蛋白表达的增加和生长速率的降低。\n\n为了区分这些假设，该生物学家构建了一种新的细菌菌株。在该菌株中，S蛋白的基因被置于一个可诱导启动子的控制之下。这使她能够通过向生长培养基中添加特定的化学诱导剂，来人为地迫使细胞产生高水平的S蛋白。该诱导剂本身已经过单独验证，对细胞的生长速率没有直接影响。\n\n然后进行实验：她取一个快速生长的细胞群体（这些细胞自然具有低水平的S蛋白），并加入化学诱导剂。诱导后，她观察到细胞现在含有高浓度的S蛋白，但它们的生长速率保持不变且很高，与没有诱导剂生长的对照组细胞无法区分。\n\n根据这个后续实验的结果，关于这三个假设的有效性，最合乎逻辑的结论是什么？\n\nA. 假设1得到了有力支持。\n\nB. 假设2得到了有力支持。\n\nC. 假设3得到了有力支持。\n\nD. 假设1被驳斥，而假设2和假设3仍然是合理的。\n\nE. 所有三个假设都被驳斥。", "solution": "定义 $S$ 为S蛋白的浓度，$\\mu$ 为瞬时生长速率， $U$ 为一个未观察到的微环境因素， $I$ 为诱导剂输入。最初的观察是单个细胞中 $S$ 和 $\\mu$ 之间存在负相关性。\n\n将每个假设转化为一个因果预测：\n- 假设1（代谢成本）假定 $S$ 对 $\\mu$ 有直接的因果效应，即较高的 $S$ 会降低 $\\mu$。用微分形式表示，它预测在固定其他原因、仅改变 $S$ 的干预下，$\\frac{\\partial \\mu}{\\partial S}<0$。用因果表示法，在 $\\operatorname{do}(S=s_{\\text{high}})$ 操作下，应观察到 $\\mu$ 相对于其在自然 $S$ 水平下的值有所下降。\n- 假设2（生长感知）假定 $\\mu$ 在因果上影响 $S$，而非反之。因此，因果图为 $\\mu \\rightarrow S$，这意味着对 $S$ 的干预不会改变 $\\mu$：在 $\\operatorname{do}(S=s_{\\text{high}})$ 操作下，$\\frac{\\partial \\mu}{\\partial S}=0$。\n- 假设3（共同原因）假定 $U \\rightarrow S$ 和 $U \\rightarrow \\mu$，且效应符号相反以产生负相关性。在这里，$S$ 不是 $\\mu$ 的原因，因此在 $\\operatorname{do}(S=s_{\\text{high}})$ 操作下，同样预期 $\\frac{\\partial \\mu}{\\partial S}=0$。\n\n实验通过使用 $I$ 来将 $S$ 设为高水平，从而执行了干预：$I \\rightarrow S$，且已验证诱导剂对 $\\mu$ 没有直接影响。根据经验观察，诱导后，$S$ 增加到高水平，而 $\\mu$ 保持不变且很高，与对照组无法区分。从因果关系的角度解释，观察到的对 $\\operatorname{do}(S=s_{\\text{high}})$ 的响应是 $\\mu$ 不变：$\\Delta \\mu=0$。\n\n根据这个干预实验的结果来评估这些假设：\n- 根据假设1， $S$ 的直接代谢负担要求增加 $S$ 会因果性地降低 $\\mu$，即在 $\\operatorname{do}(S=s_{\\text{high}})$ 操作后 $\\Delta \\mu<0$。数据与此相矛盾，因此假设1被驳斥。\n- 根据假设2，由于因果箭头是 $\\mu \\rightarrow S$，操纵 $S$ 不应改变 $\\mu$，即 $\\Delta \\mu=0$。这与观察结果相符，因此假设2仍然是合理的。\n- 根据假设3，由于 $U$ 是共同原因，且 $S$ 对 $\\mu$ 没有因果作用，单独操纵 $S$ 不应影响 $\\mu$，即 $\\Delta \\mu=0$。这也与观察结果相符，因此假设3仍然是合理的。\n\n因此，该干预排除了S蛋白对生长有直接成本的可能性（假设1），但与反向因果关系（假设2）和隐藏的共同原因（假设3）都相符。最合乎逻辑的结论是，假设1被驳斥，而假设2和假设3仍然是合理的。", "answer": "$$\\boxed{D}$$", "id": "1425392"}, {"introduction": "相关性与因果性的辨析并不总是定性的，有时需要深入的定量分析。这个高级练习 [@problem_id:1425390] 展示了一个更为精妙的场景：一个简单的、符合直觉的生物学模型（模块累加效应）如何在数学上产生一个看似完全不同（乘法效应）的强相关性。通过这个练习，你将体会到，即使两个变量之间没有直接的因果关系，它们的关联也可能不是随机的，而是可以被底层机制的数学模型精确预测的，这正是系统生物学建模的魅力所在。", "problem": "在系统生物学中，遗传相互作用分析旨在理解基因如何协同作用以产生表型。一个常见的观察是上位性，即双基因敲除的表型效应与基于单基因敲除的预期不同。\n\n一位系统生物学家为某一特定生物体提出了一个“模块化适应度”模型。在此模型中，生物体的总适应度 $W$ 是大量（数量为 $M$）独立且相同的功能模块贡献之和。在野生型状态下，每个模块贡献的适应度为1，因此野生型总适应度为 $W_{WT} = M$。\n\n基因的作用是支持这些模块的一个特定子集。当一个基因 $G_k$ 被敲除时，它所支持的所有 $m_k$ 个模块都完全失效，其适应度贡献降至零。这种敲除的严重性 $S_k$ 定义为总适应度的分数损失，即 $S_k = (W_{WT} - W_{k}) / W_{WT}$，其中 $W_k$ 是敲除生物体的适应度。\n\n对于一项涉及成对敲除的研究，假设任何给定基因对 $G_A$ 和 $G_B$ 具有非重叠的多效性效应；也就是说，受 $G_A$ 影响的模块集合与受 $G_B$ 影响的模块集合完全不相交。\n\n一位分析师在不了解这种潜在模块化机制的情况下，检查了一个大型的基因敲除实验数据集。对于这类非重叠基因对的一个多样化群体，他们绘制了测得的双基因敲除严重性 $S_{AB}$ 相对于单个严重性乘积 $S_A S_B$ 的关系图。该分析师报告称存在强正线性相关，这导致一些人得出基因之间存在乘性相互作用的结论。\n\n你的任务是评估所提出的加性模块化模型是否能解释这一观察结果。假设模块化模型是正确的，计算理论上的皮尔逊相关系数 $\\rho(S_{AB}, S_A S_B)$。在此计算中，将基因对群体中的单个严重性 $S_A$ 和 $S_B$ 建模为独立同分布的随机变量，每个变量都服从区间 $[0, L]$ 上的均匀分布，其中 $L$ 是一个常数，代表观察到的最大单基因严重性。最终答案应为一个闭式解析表达式。", "solution": "在具有非重叠多效性效应的加性模块化模型中，双基因敲除的严重性等于单个严重性之和。令 $S_{A}$ 和 $S_{B}$ 表示单基因严重性，$S_{AB}$ 表示双基因敲除严重性。由于受 $G_{A}$ 和 $G_{B}$ 影响的模块不相交，因此双基因敲除中总适应度的损失分数是单个损失分数之和，所以\n$$\nS_{AB}=S_{A}+S_{B}.\n$$\n\n我们被要求计算 $S_{AB}$ 和 $S_{A}S_{B}$ 之间的皮尔逊相关系数，假设 $S_{A}$ 和 $S_{B}$ 作为 $\\mathrm{Uniform}[0,L]$ 独立同分布。定义 $X:=S_{A}$ 和 $Y:=S_{B}$。那么 $X,Y$ 是独立同分布的，且\n$$\n\\mathbb{E}[X]=\\mathbb{E}[Y]=\\frac{L}{2},\\quad \\mathbb{E}[X^{2}]=\\mathbb{E}[Y^{2}]=\\frac{L^{2}}{3},\\quad \\mathrm{Var}(X)=\\mathrm{Var}(Y)=\\frac{L^{2}}{12}.\n$$\n此外，\n$$\n\\mathbb{E}[XY]=\\mathbb{E}[X]\\mathbb{E}[Y]=\\frac{L^{2}}{4},\\quad \\mathbb{E}[X^{2}Y^{2}]=\\mathbb{E}[X^{2}]\\mathbb{E}[Y^{2}]=\\frac{L^{4}}{9}.\n$$\n\n皮尔逊相关系数为\n$$\n\\rho(S_{AB},S_{A}S_{B})=\\frac{\\mathrm{Cov}(X+Y,XY)}{\\sqrt{\\mathrm{Var}(X+Y)\\,\\mathrm{Var}(XY)}}.\n$$\n\n计算协方差：\n$$\n\\mathrm{Cov}(X+Y,XY)=\\mathbb{E}[(X+Y)XY]-\\mathbb{E}[X+Y]\\mathbb{E}[XY].\n$$\n独立性意味着\n$$\n\\mathbb{E}[(X+Y)XY]=\\mathbb{E}[X^{2}Y]+\\mathbb{E}[XY^{2}]=\\mathbb{E}[X^{2}]\\mathbb{E}[Y]+\\mathbb{E}[X]\\mathbb{E}[Y^{2}]=\\frac{L^{2}}{3}\\cdot\\frac{L}{2}+\\frac{L}{2}\\cdot\\frac{L^{2}}{3}=\\frac{L^{3}}{3}.\n$$\n另外，\n$$\n\\mathbb{E}[X+Y]\\mathbb{E}[XY]=\\left(\\frac{L}{2}+\\frac{L}{2}\\right)\\cdot\\frac{L^{2}}{4}=L\\cdot\\frac{L^{2}}{4}=\\frac{L^{3}}{4}.\n$$\n因此，\n$$\n\\mathrm{Cov}(X+Y,XY)=\\frac{L^{3}}{3}-\\frac{L^{3}}{4}=\\frac{L^{3}}{12}.\n$$\n\n计算分母中的方差。因为 $X$ 和 $Y$ 是独立的，\n$$\n\\mathrm{Var}(X+Y)=\\mathrm{Var(X)}+\\mathrm{Var}(Y)=\\frac{L^{2}}{12}+\\frac{L^{2}}{12}=\\frac{L^{2}}{6}.\n$$\n对于乘积，\n$$\n\\mathrm{Var}(XY)=\\mathbb{E}[X^{2}Y^{2}]-(\\mathbb{E}[XY])^{2}=\\frac{L^{4}}{9}-\\left(\\frac{L^{2}}{4}\\right)^{2}=\\frac{L^{4}}{9}-\\frac{L^{4}}{16}=\\frac{7L^{4}}{144}.\n$$\n\n将这些放在一起，\n$$\n\\rho(S_{AB},S_{A}S_{B})=\\frac{\\frac{L^{3}}{12}}{\\sqrt{\\frac{L^{2}}{6}\\cdot\\frac{7L^{4}}{144}}}=\\frac{\\frac{L^{3}}{12}}{L^{3}\\cdot\\frac{\\sqrt{7}}{12\\sqrt{6}}}=\\frac{\\sqrt{6}}{\\sqrt{7}}=\\sqrt{\\frac{6}{7}}.\n$$\n\n因此，具有独立均匀分布的单基因严重性的加性模块化模型预测，$S_{AB}$ 和 $S_{A}S_{B}$ 之间存在强正相关，其皮尔逊系数为 $\\sqrt{\\frac{6}{7}}$，且与 $L$ 无关。", "answer": "$$\\boxed{\\sqrt{\\frac{6}{7}}}$$", "id": "1425390"}]}