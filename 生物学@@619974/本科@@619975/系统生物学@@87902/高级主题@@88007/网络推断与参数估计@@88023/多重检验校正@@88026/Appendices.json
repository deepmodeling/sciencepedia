{"hands_on_practices": [{"introduction": "在现代生物学研究中，高通量实验（如蛋白质组学或基因组学）同时检测数千个变量，这带来了巨大的统计挑战。该练习将引导您应用 Bonferroni 校正，这是一种控制家族整体错误率（Family-Wise Error Rate, FWER）的基础方法。通过为一个假设的蛋白质组学实验计算调整后的显著性阈值，您将亲身体会到在进行大规模多重检验时，保持统计严谨性是多么重要。[@problem_id:1450318]", "problem": "一个药理学家团队正在研究细胞对一种新开发的抗癌药物的反应。他们使用质谱法进行了一项大规模的定量蛋白质组学实验，以比较用药治疗的癌细胞与未用药治疗的对照组细胞中的蛋白质表达水平。该实验同时测量了5,000种不同蛋白质的丰度。\n\n对每种蛋白质都进行了一项统计检验，以确定其表达水平是否因药物治疗而发生显著变化。该团队希望在所有5,000次检验中，控制至少出现一次假发现（I类错误）的概率。他们决定将家族谬误率（FWER）严格控制在0.05。为此，他们将使用Bonferroni校正来调整每个单独蛋白质检验的显著性阈值。\n\n计算必须用于5,000个独立统计检验中每一个检验的新显著性阈值，通常表示为 $\\alpha'$。将您的答案以科学记数法表示，并四舍五入到两位有效数字。", "solution": "我们希望在 $m=5000$ 次独立假设检验中，将家族谬误率（FWER）控制在 $\\alpha=0.05$ 的水平。使用Bonferroni校正，我们设定每次检验的显著性阈值 $\\alpha'$，使得联合界保证 $m\\alpha' \\leq \\alpha$。因此，经过Bonferroni校正的阈值是\n$$\n\\alpha'=\\frac{\\alpha}{m}。\n$$\n代入 $\\alpha=0.05$ 和 $m=5000$，\n$$\n\\alpha'=\\frac{0.05}{5000}=\\frac{5\\times 10^{-2}}{5\\times 10^{3}}=\\left(\\frac{5}{5}\\right)\\times 10^{-2-3}=1\\times 10^{-5}。\n$$\n以科学记数法表示并四舍五入到两位有效数字，得到\n$$\n\\alpha' = 1.0 \\times 10^{-5}.\n$$", "answer": "$$\\boxed{1.0 \\times 10^{-5}}$$", "id": "1450318"}, {"introduction": "虽然 Bonferroni 校正简单直观，但它通常过于严格，可能会导致我们错失许多真正的发现（即增加了第二类错误的风险）。为了在控制错误和保持统计功效之间取得更好的平衡，科学家们开发了更先进的方法，例如控制错误发现率（False Discovery Rate, FDR）的 Benjamini-Hochberg (BH) 程序。本练习将带您一步步地应用 BH 程序，这是一个在当代基因组学和系统生物学研究中被广泛采用的核心技能，让您学会如何在实践中识别出具有统计显著性的结果。[@problem_id:1450361]", "problem": "一位系统生物学家正在进行一项代谢组学实验，以确定在新药治疗下代谢物浓度的变化。在对五种不同的关键代谢物进行统计检验，比较治疗组与对照组后，获得了以下p值：0.005、0.02、0.06、0.07 和 0.5。\n\n为了解决多重假设检验问题，该生物学家决定使用 Benjamini-Hochberg 程序来控制错误发现率 (FDR)。期望的FDR设定为 25% (即 $Q = 0.25$)。\n\n根据 Benjamini-Hochberg 程序，下列哪一组代表了所有被认为具有统计显著性的p值？\n\nA. 0.005\n\nB. 0.005, 0.02\n\nC. 0.005, 0.02, 0.06\n\nD. 0.005, 0.02, 0.06, 0.07\n\nE. 0.005, 0.02, 0.06, 0.07, 0.5", "solution": "我们应用 Benjamini-Hochberg (BH) 程序。设假设数量为 $m=5$，目标错误发现率为 $Q=0.25$，p值按升序排列为\n$$\np_{(1)}=0.005,\\quad p_{(2)}=0.02,\\quad p_{(3)}=0.06,\\quad p_{(4)}=0.07,\\quad p_{(5)}=0.5.\n$$\nBH 临界值为\n$$\nc_{i}=\\frac{i}{m}Q,\\quad i=1,2,3,4,5.\n$$\n当 $m=5$ 且 $Q=0.25$ 时，这些值为\n$$\nc_{1}=0.05,\\quad c_{2}=0.1,\\quad c_{3}=0.15,\\quad c_{4}=0.2,\\quad c_{5}=0.25.\n$$\n根据Benjamini-Hochberg程序，我们寻找满足 $p_{(k)} \\leq \\frac{k}{m}Q$ 的最大索引 $k$。如果这样的 $k$ 存在，则所有到 $k$ 为止的原假设都被拒绝。让我们逐一检查每个p值与对应的临界值：\n$$\np_{(1)}=0.005\\leq 0.05,\\quad p_{(2)}=0.02\\leq 0.1,\\quad p_{(3)}=0.06\\leq 0.15,\\quad p_{(4)}=0.07\\leq 0.2,\\quad p_{(5)}=0.5\\nleq 0.25.\n$$\n满足条件 $p_{(k)} \\le c_k$ 的最大索引是 $k=4$。因此，所有到 $k=4$ 为止的p值（即 $p_{(1)}, p_{(2)}, p_{(3)}, p_{(4)}$）都被认为是显著的，这对应于选项D。", "answer": "$$\\boxed{D}$$", "id": "1450361"}, {"introduction": "多重检验的一个常见陷阱是“p 值 hacking”或“摘樱桃”，即在检视所有结果后，只挑选看似有趣的子集进行分析，而不进行适当的校正。这种做法会极大地增加假阳性的风险。这个练习通过一个思想实验，计算了在零假设（即没有任何真实效应）成立的情况下，仅仅因为随机性，我们期望在一个基因子集中找到多少个“显著”的结果，从而深刻揭示了为什么必须预先设定分析计划并严格执行多重检验校正。[@problem_id:1450327]", "problem": "一位生物信息学家使用来自核糖核酸（RNA）测序实验的数据进行差异基因表达分析，以比较处理样本和对照样本。该分析覆盖了整个小鼠基因组，共计 $N_{total} = 22,000$ 个基因。对每个单个基因的假设检验均使用 $\\alpha = 0.05$ 的标准显著性阈值。在对结果进行初步审阅后，研究人员决定专注于一个预先定义的、已知与代谢途径相关的基因集，该基因集包含 $N_{subset} = 800$ 个基因。在这个子集中，研究人员报告发现有 $k = 45$ 个基因的未经校正的p值小于阈值 $\\alpha = 0.05$。\n\n为了严格评估这一发现，我们希望确定仅由随机机会所能预期的结果。假设处理对任何基因都没有实际效果（即，无差异表达的原假设对所有22,000个基因都成立），那么在代谢途径子集中，p值小于0.05的基因的期望数量是多少？\n\nA. 0.05\n\nB. 1\n\nC. 40\n\nD. 45\n\nE. 1100", "solution": "假设原假设对所有基因均成立，那么每个基因的p值在区间 $[0,1]$ 上服从均匀分布。对于一个固定的显著性阈值 $\\alpha$，单个基因的p值满足 $p < \\alpha$ 的概率是 $\\alpha$。\n\n为代谢子集中的 $N_{subset}$ 个基因定义指示变量：对于基因 $i$，如果其p值小于 $\\alpha$，则令 $X_{i}=1$，否则令 $X_{i}=0$。在原假设下，对每个 $i$ 都有 $P(X_{i}=1)=\\alpha$，因此 $\\mathbb{E}[X_{i}]=\\alpha$。\n\n令 $S=\\sum_{i=1}^{N_{subset}} X_{i}$ 为该子集中p值满足 $p<\\alpha$ 的基因总数。根据期望的线性性质，\n$$\n\\mathbb{E}[S]=\\sum_{i=1}^{N_{subset}} \\mathbb{E}[X_{i}]=N_{subset}\\,\\alpha.\n$$\n将 $N_{subset}=800$ 和 $\\alpha=0.05$ 代入，可得\n$$\n\\mathbb{E}[S]=800 \\times 0.05=40.\n$$\n这对应于选项C。", "answer": "$$\\boxed{C}$$", "id": "1450327"}]}