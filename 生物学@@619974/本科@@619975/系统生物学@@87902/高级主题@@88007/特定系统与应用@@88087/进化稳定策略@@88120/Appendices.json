{"hands_on_practices": [{"introduction": "本练习探讨了合作策略（生产公共物品）在何种条件下能够保持进化稳定，这是一个在微生物学中常见的合作与欺骗的经典问题。通过这个练习，你将学习如何根据一个生物学情景构建收益矩阵，并应用正式的稳定性条件来找到一个策略成为进化稳定策略（ESS）所需的临界阈值 [@problem_id:1432865]。", "problem": "在一个简化的微生物竞争模型中，一个细菌种群由两种表型组成，它们竞争一种复杂的多聚物资源。\n1.  **生产者 (P)：** 这类细菌分泌一种胞外酶来将多聚物分解为可用的营养物质。这个过程会产生一个代谢成本 $c > 0$。单个生产者的酶促作用所产生的营养物质总量对应于一个收益 $b > 0$。\n2.  **欺骗者 (C)：** 这类细菌不产生该酶，因此不产生任何成本。然而，它们可以消耗由生产者产生的营养物质。\n\n我们对种群中任意两个细菌之间的相互作用进行建模。多聚物分解所带来的收益分配如下：由生产者产生的收益中，一部分比例 $\\alpha$（其中 $0 \\le \\alpha \\le 1$）是私有的，仅由该生产者消耗。剩余部分 $(1-\\alpha)$ 成为公共物品，由相互作用的两个个体平均分享。\n\n个体的收益定义为其获得的总收益减去其付出的任何成本。根据这些规则，可以构建一个收益矩阵 $E(S_1, S_2)$，其中 $S_1$ 是焦点个体的策略，$S_2$ 是其对手的策略。\n\n如果一个策略满足抵抗稀有突变策略入侵的特定稳定性条件，则该策略被定义为演化稳定策略 (ESS)。为了使“生产者”策略成为一个ESS，成本收益比 $c/b$ 必须严格小于某个阈值，该阈值可能取决于私有因子 $\\alpha$。\n\n确定成本收益比 $c/b$ 的这个阈值。用 $\\alpha$ 的函数表示你的答案。", "solution": "为了解决这个问题，我们首先需要为两种策略构建收益矩阵：生产者 (P) 和欺骗者 (C)。矩阵项 $E(S_1, S_2)$ 表示采用策略 $S_1$ 的个体对抗采用策略 $S_2$ 的对手时所获得的收益。\n\n**步骤1：构建收益矩阵**\n\n让我们为“行”博弈方计算四种可能互动中的每一种收益。\n\n1.  **生产者 vs. 生产者的收益, $E(P, P)$：**\n    焦点个体（一个生产者）与另一个生产者互动。\n    - 它产生收益 $b$ 并支付成本 $c$。\n    - 它获得 $\\alpha b$ 的私有收益。\n    - 它向公共物品贡献 $(1-\\alpha)b$。\n    - 它的对手也向公共物品贡献 $(1-\\alpha)b$。\n    - 公共物品的总量是 $2(1-\\alpha)b$。\n    - 这个公共物品被平均分享，所以焦点个体获得的份额是 $\\frac{1}{2} \\times 2(1-\\alpha)b = (1-\\alpha)b$。\n    - 获得的总收益是 (私有收益) + (公共物品份额) = $\\alpha b + (1-\\alpha)b = b$。\n    - 净收益是总收益减去成本：$E(P, P) = b - c$。\n\n2.  **生产者 vs. 欺骗者的收益, $E(P, C)$：**\n    焦点个体（一个生产者）与一个欺骗者互动。\n    - 它产生收益 $b$ 并支付成本 $c$。\n    - 它获得 $\\alpha b$ 的私有收益。\n    - 它向公共物品贡献 $(1-\\alpha)b$。\n    - 欺骗者对手对公共物品没有任何贡献。\n    - 公共物品的总量是 $(1-\\alpha)b$。\n    - 这个被平均分享，所以焦点个体获得的份额是 $\\frac{1}{2}(1-\\alpha)b$。\n    - 获得的总收益是 (私有收益) + (公共物品份额) = $\\alpha b + \\frac{1}{2}(1-\\alpha)b = (\\alpha + \\frac{1}{2} - \\frac{\\alpha}{2})b = (\\frac{1+\\alpha}{2})b$。\n    - 净收益是总收益减去成本：$E(P, C) = (\\frac{1+\\alpha}{2})b - c$。\n\n3.  **欺骗者 vs. 生产者的收益, $E(C, P)$：**\n    焦点个体（一个欺骗者）与一个生产者互动。\n    - 它不生产任何东西，也不支付任何成本。\n    - 生产者对手产生 $(1-\\alpha)b$ 的公共物品。\n    - 这个被平均分享，所以焦点个体（欺骗者）获得的份额是 $\\frac{1}{2}(1-\\alpha)b$。\n    - 净收益就是这个收益：$E(C, P) = \\frac{1}{2}(1-\\alpha)b$。\n\n4.  **欺骗者 vs. 欺骗者的收益, $E(C, C)$：**\n    焦点个体（一个欺骗者）与另一个欺骗者互动。\n    - 两者都不产生酶，所以没有收益产生，也没有成本支付。\n    - 收益为零：$E(C, C) = 0$。\n\n行博弈方的收益矩阵是：\n$$\n\\begin{array}{c|cc}\n & \\text{P} & \\text{C} \\\\\n\\hline\n\\text{P} & b-c & \\left(\\frac{1+\\alpha}{2}\\right)b - c \\\\\n\\text{C} & \\frac{1}{2}(1-\\alpha)b & 0\n\\end{array}\n$$\n\n**步骤2：应用演化稳定策略 (ESS) 的条件**\n\n一个策略 $S_1$（在此案例中为 P）是 ESS，如果对于任何替代策略 $S_2$（在此案例中为 C），以下两个条件之一成立：\n1.  $E(S_1, S_1) > E(S_2, S_1)$\n2.  $E(S_1, S_1) = E(S_2, S_1)$ 并且 $E(S_1, S_2) > E(S_2, S_2)$\n\n第一个条件表明，一个 ESS 在对抗自身时必须比任何突变策略表现得更好。这可以防止突变体的初始入侵。第二个条件涵盖了突变体在对抗 ESS 种群时表现同样出色的情况，并要求 ESS 策略在对抗突变体时必须比突变体对抗自身时表现得更好。\n\n让我们检查策略 P 对抗突变策略 C 的这些条件。\n\n**检查条件1：**\n我们检验是否 $E(P, P) > E(C, P)$。\n$$b - c > \\frac{1}{2}(1-\\alpha)b$$\n我们想找到关于成本收益比 $c/b$ 的条件。重排不等式：\n$$b - \\frac{1}{2}(1-\\alpha)b > c$$\n$$b \\left(1 - \\frac{1-\\alpha}{2}\\right) > c$$\n$$b \\left(\\frac{2 - 1 + \\alpha}{2}\\right) > c$$\n$$b \\left(\\frac{1+\\alpha}{2}\\right) > c$$\n两边除以 $b$（为正数）：\n$$\\frac{c}{b} < \\frac{1+\\alpha}{2}$$\n如果这个严格不等式成立，策略 P 就是一个 ESS。问题要求的是 $c/b$ 必须小于的阈值。这个阈值是 $\\frac{1+\\alpha}{2}$。\n\n**步骤3：验证边界情况**\n为了完整起见，让我们分析当第一个条件不严格满足时会发生什么，即当 $E(P, P) = E(C, P)$ 时。这发生在 $\\frac{c}{b} = \\frac{1+\\alpha}{2}$。\n在这种情况下，我们必须检查条件2：$E(P, C) > E(C, C)$。\n$$E(P, C) = \\left(\\frac{1+\\alpha}{2}\\right)b - c$$\n因为我们处于边界情况 $\\frac{c}{b} = \\frac{1+\\alpha}{2}$，我们可以代入 $c = (\\frac{1+\\alpha}{2})b$：\n$$E(P, C) = \\left(\\frac{1+\\alpha}{2}\\right)b - \\left(\\frac{1+\\alpha}{2}\\right)b = 0$$\n并且我们知道 $E(C, C) = 0$。\n因此，在边界上，$E(P, C) = E(C, C)$。条件2所要求的严格不等式不成立。因此，当 $\\frac{c}{b} = \\frac{1+\\alpha}{2}$ 时，P 不是一个 ESS。\n\n因此，要使 P 成为一个 ESS，比率 $c/b$ 必须严格小于 $\\frac{1+\\alpha}{2}$。因此，阈值就是这个表达式。", "answer": "$$\\boxed{\\frac{1+\\alpha}{2}}$$", "id": "1432865"}, {"introduction": "并非所有种群都会固定在单一策略上，在许多情况下，多种不同的行为策略会以稳定的比例共存。本问题将探讨一个典型的混合策略场景，在这种场景中，一个种群内同时存在“大胆”和“害羞”两种行为 [@problem_id:1432901]。通过为这两种策略建立适应度收益模型，你将练习计算多态种群中的策略均衡频率，这是进化博弈论中的一项基本技能。", "problem": "在一个鸟类种群中，雄性的求偶行为由单一基因座控制，产生两种不同的策略：“大胆”和“害羞”。雄性们为争夺交配机会而竞争，成功获得配偶会带来 $V$ 的适应度收益。\n\n- **大胆策略 (B)：** 使用此策略的雄性会进行攻击性强且引人注目的展示。\n- **害羞策略 (S)：** 使用此策略的雄性会进行保守且不引人注目的展示。\n\n一个焦点雄性的适应度回报取决于其自身策略和其竞争者的策略，具体由以下互动规则描述：\n1.  当一只**大胆**雄性与一只**害羞**雄性竞争时，大胆雄性总能赢得配偶，获得全部的适应度收益 $V$。害羞雄性在此互动中没有收益，也不产生任何成本。\n2.  当两只**害羞**雄性竞争时，它们不会使冲突升级，而是平等地分享交配机会，每只获得 $V/2$ 的平均适应度收益。\n3.  当两只**大胆**雄性竞争时，它们会进行一场代价高昂的肉搏。胜利者获得配偶（收益 $V$），而失败者则会受伤，承受 $C$ 的适应度成本。每只雄性获胜或失败的几率均等。\n\n假设种群数量庞大，个体随机配对进行竞争。系统达到一个稳定的多态性均衡，其中大胆和害羞策略共存。在此均衡状态下，害羞策略者的数量与大胆策略者的数量之比是多少？请用包含 $V$ 和 $C$ 的符号表达式来表示你的答案。", "solution": "设种群中大胆策略的频率为 $p$，害羞策略的频率为 $q$，且 $q=1-p$。根据互动规则：\n- 大胆 vs 大胆：每只获得期望回报 $(V - C)/2$。\n- 大胆 vs 害羞：大胆者获得 $V$。\n- 害羞 vs 大胆：害羞者获得 $0$。\n- 害羞 vs 害羞：每只获得 $V/2$。\n\n因此，在一个随机混合的大种群中，期望回报为\n$$\nE_{B} = p \\cdot \\frac{V - C}{2} + q \\cdot V,\n$$\n$$\nE_{S} = p \\cdot 0 + q \\cdot \\frac{V}{2} = q \\cdot \\frac{V}{2}.\n$$\n在一个稳定的多态性均衡下（在此博弈中要求 $C > V$），以正频率使用的策略必须产生相等的期望回报，因此令 $E_{B} = E_{S}$：\n$$\np \\cdot \\frac{V - C}{2} + q \\cdot V = q \\cdot \\frac{V}{2}.\n$$\n等式两边同乘以 $2$：\n$$\np (V - C) + 2 q V = q V.\n$$\n整理得：\n$$\np (V - C) = q V - 2 q V = - q V.\n$$\n两边同乘以 $-1$ 并重组：\n$$\np (C - V) = q V.\n$$\n等式两边同除以 $p V$，得到害羞策略者与大胆策略者之比：\n$$\n\\frac{q}{p} = \\frac{C - V}{V}.\n$$\n这就是在多态性均衡下，害羞策略者的数量与大胆策略者的数量之比。", "answer": "$$\\boxed{\\frac{C - V}{V}}$$", "id": "1432901"}, {"introduction": "真实的生物互动往往涉及许多个体和连续变化的性状，而不仅仅是两个参与者或几种离散的选择。这个练习将我们从简单的双人博弈带入一个包含众多参与者和连续贡献范围的公共物品博弈场景 [@problem_id:1432884]。它引入了一种强大的、基于微积分的方法来寻找进化稳定策略，展示了该理论框架如何能被应用于更真实、更复杂的生物系统中。", "problem": "在一个微生物合作模型中，一个大种群由 $N$ 个个体组成。每个个体 $i$ 可以选择贡献其资源的一部分 $x_i$（其中 $x_i \\in [0, 1]$）用于生产一种公共物品。个体做出贡献 $x_i$ 的成本是线性的，由 $C(x_i) = c x_i$ 给出，其中 $c$ 是一个正常数，表示单位贡献成本。\n\n种群中所有个体的贡献被汇集起来，形成总贡献 $X = \\sum_{j=1}^{N} x_j$。这种公共物品带来的收益由所有 $N$ 个个体平均分享。该收益表现出饱和效应，即随着总贡献的增加，其效果会减弱。每个个体获得的收益由函数 $B(X) = \\frac{V X}{K+X}$ 描述，其中 $V$ 和 $K$ 是正常数，分别代表最大可能收益和半饱和常数。\n\n个体 $i$ 的净支付是共享收益减去其个人成本：$P_i = B(X) - C(x_i)$。我们感兴趣的是找到一个对称的演化稳定策略（ESS），即一个策略 $x^*$，如果整个种群都采用该策略，它就不会被任何替代的突变策略入侵。\n\n假设该系统存在一个唯一的对称ESS，记为 $x^*$，且满足条件 $0 < x^* < 1$，请确定 $x^*$ 关于 $N, V, K,$ 和 $c$ 的表达式。", "solution": "个体 $i$ 的支付由其收益减去其成本给出。收益取决于总贡献 $X = \\sum_{j=1}^{N} x_j$，而成本仅取决于其自身的贡献 $x_i$。\n$$P_i(x_1, x_2, ..., x_N) = \\frac{V \\sum_{j=1}^{N} x_j}{K + \\sum_{j=1}^{N} x_j} - c x_i$$\n\n为了找到演化稳定策略（ESS），我们考虑一个由定居者组成的种群中一个稀有突变体的命运。假设定居者种群采用策略 $x_r$。我们引入一个采用不同策略 $x_m$ 的单个突变个体。现在种群由 $N-1$ 个执行策略 $x_r$ 的个体和一个执行策略 $x_m$ 的个体组成。\n\n在这个混合种群中，总贡献为 $X = (N-1)x_r + x_m$。\n\n突变个体的支付，通常称为入侵适应度，是其自身策略 $x_m$ 和定居者策略 $x_r$ 的函数：\n$$W(x_m, x_r) = \\frac{V ((N-1)x_r + x_m)}{K + (N-1)x_r + x_m} - c x_m$$\n\n一个ESS $x^*$ 必须是其自身的最佳对策。这意味着如果定居者策略是 $x_r = x^*$，那么使突变体支付最大化的策略 $x_m$ 必须是 $x_m = x^*$。为了找到突变体的最优策略，我们需要关于 $x_m$ 最大化 $W(x_m, x_r)$。我们通过求 $W$ 关于 $x_m$ 的偏导数并将其设为零来实现这一点。\n\n$$\\frac{\\partial W(x_m, x_r)}{\\partial x_m} = \\frac{\\partial}{\\partial x_m} \\left( \\frac{V ((N-1)x_r + x_m)}{K + (N-1)x_r + x_m} \\right) - c$$\n\n使用除法定则求导，$\\frac{d}{dz}\\left(\\frac{u}{v}\\right) = \\frac{u'v - uv'}{v^2}$，其中 $u = V((N-1)x_r + x_m)$ 且 $v = K+(N-1)x_r + x_m$。关于 $x_m$ 求导，我们得到 $u' = V$ 和 $v' = 1$。\n\n$$\\frac{\\partial W}{\\partial x_m} = \\frac{V(K + (N-1)x_r + x_m) - V((N-1)x_r + x_m)(1)}{(K + (N-1)x_r + x_m)^2} - c$$\n\n化简分子：\n$$V(K + (N-1)x_r + x_m) - V((N-1)x_r + x_m) = V K$$\n\n所以导数为：\n$$\\frac{\\partial W}{\\partial x_m} = \\frac{V K}{(K + (N-1)x_r + x_m)^2} - c$$\n\nESS条件要求，对于一个执行策略 $x^*$ 的定居者种群，当突变体也执行策略 $x^*$ 时，入侵适应度的梯度为零。换句话说，没有偏离 $x^*$ 的动机。我们令 $x_m = x_r = x^*$，并将导数设为零。\n\n$$\\left. \\frac{\\partial W}{\\partial x_m} \\right|_{x_m=x_r=x^*} = \\frac{V K}{(K + (N-1)x^* + x^*)^2} - c = 0$$\n\n$$\\frac{V K}{(K + N x^*)^2} - c = 0$$\n\n现在，我们求解这个方程以得到 $x^*$。\n$$\\frac{V K}{(K + N x^*)^2} = c$$\n$$(K + N x^*)^2 = \\frac{V K}{c}$$\n\n对两边取平方根。由于 $K, N, x^*$ 都是正数，项 $K + N x^*$ 必须是正数，所以我们取正根。\n$$K + N x^* = \\sqrt{\\frac{V K}{c}}$$\n\n分离含有 $x^*$ 的项：\n$$N x^* = \\sqrt{\\frac{V K}{c}} - K$$\n\n最后，解出 $x^*$：\n$$x^* = \\frac{1}{N} \\left( \\sqrt{\\frac{V K}{c}} - K \\right)$$\n\n这就是对称的演化稳定策略，前提是问题的假设，即存在一个内部解（$0 < x^* < 1$）。", "answer": "$$\\boxed{\\frac{1}{N} \\left( \\sqrt{\\frac{V K}{c}} - K \\right)}$$", "id": "1432884"}]}