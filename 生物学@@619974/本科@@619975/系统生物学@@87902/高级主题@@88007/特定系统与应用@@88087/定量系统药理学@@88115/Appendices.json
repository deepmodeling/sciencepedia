{"hands_on_practices": [{"introduction": "定量系统药理学(QSP)的基础是精确描述药物与其靶点之间的相互作用。本练习将引导你从最基本的质量作用定律出发，推导出一个考虑了“配体耗尽”效应的受体-配体结合模型。通过这个实践，你将理解在受体浓度较高或药物亲和力极强的情况下，为何不能简单地假设游离配体浓度等于总配体浓度，并掌握更精确计算受体占有率的方法。[@problem_id:2813040]", "problem": "一种类固醇激素在细胞核中根据单位点可逆结合平衡与其同源核受体（NR）结合。设核受体总浓度为 $R_{T} = 10\\ \\text{nM}$，解离常数（定义为 $K_{d} = \\frac{[R][L]}{[RL]}$）为 $K_{d} = 5\\ \\text{nM}$。向细胞核中添加配体至已知的总浓度 $L_{T}$，并且不能先验地忽略因与受体结合而引起的配体耗竭。从质量作用定律、$K_{d}$ 的定义以及受体和配体的质量守恒出发，完成以下任务：\n\n1. 推导受体占有率 $f(L_{T})$（定义为 $f(L_{T}) = \\frac{[RL]}{R_{T}}$）作为 $R_{T}$、$K_{d}$ 和 $L_{T}$ 的函数解析表达式，不假设游离配体等于总配体。\n\n2. 使用您的表达式，计算当 $L_{T} = 1\\ \\text{nM}$、$L_{T} = 5\\ \\text{nM}$ 和 $L_{T} = 50\\ \\text{nM}$ 时的受体占有率。\n\n3. 假设转录输出 $T(L_{T})$ 与占有率成正比，且基础活性可忽略不计，即 $T(L_{T}) = \\alpha\\, f(L_{T})$，其中 $\\alpha$ 为某个比例常数（任意单位），因此最大转录输出为 $T_{\\max} = \\alpha$。使用您推导的 $f(L_{T})$，写出 $T(L_{T})$（可包含常数 $\\alpha$），并推断转录响应随 $L_{T}$ 变化的定性形状。\n\n4. 在此模型下，确定能产生 $T(L_{T}^{(0.8)}) = 0.8\\, T_{\\max}$ 的总配体浓度 $L_{T}^{(0.8)}$。将您对 $L_{T}^{(0.8)}$ 的最终答案以 $\\text{nM}$ 为单位表示，并四舍五入到三位有效数字。", "solution": "问题陈述具有科学依据，提法恰当且完整。它描述了一个带有配体耗竭的标准可逆结合平衡，这是定量药理学和系统生物学中一个常见且重要的情况。我们将按要求进行推导和计算。\n\n配体 $L$ 与受体 $R$ 的结合由以下可逆反应描述：\n$$ R + L \\rightleftharpoons RL $$\n该系统在平衡状态下由三个基本关系决定。\n\n解离常数 $K_{d}$ 定义为：\n$$ K_{d} = \\frac{[R][L]}{[RL]} $$\n其中 $[R]$、$[L]$ 和 $[RL]$ 分别是游离受体、游离配体和受体-配体复合物的平衡浓度。\n\n受体的质量守恒为：\n$$ R_{T} = [R] + [RL] $$\n其中 $R_{T}$ 是总受体浓度。\n\n配体的质量守恒为：\n$$ L_{T} = [L] + [RL] $$\n其中 $L_{T}$ 是总配体浓度。问题指明 $[L]$ 不一定等于 $L_{T}$，当结合引起的配体耗竭显著时，这是正确的处理方法。\n\n第1部分：推导受体占有率 $f(L_{T})$。\n\n我们的目标是找到受体占有率 $f(L_{T}) = \\frac{[RL]}{R_{T}}$ 关于已知量 $R_{T}$、$L_{T}$ 和 $K_{d}$ 的表达式。为此，我们必须首先找到 $[RL]$ 的表达式。\n\n根据质量守恒方程，我们用复合物浓度 $[RL]$ 来表示游离浓度：\n$$ [R] = R_{T} - [RL] $$\n$$ [L] = L_{T} - [RL] $$\n将这些表达式代入 $K_{d}$ 的定义中：\n$$ K_{d} = \\frac{(R_{T} - [RL])(L_{T} - [RL])}{[RL]} $$\n我们现在必须就 $[RL]$ 求解此方程。重新整理方程得到：\n$$ K_{d}[RL] = (R_{T} - [RL])(L_{T} - [RL]) $$\n$$ K_{d}[RL] = R_{T}L_{T} - R_{T}[RL] - L_{T}[RL] + [RL]^2 $$\n将所有项移到一边，得到关于 $[RL]$ 的二次方程：\n$$ [RL]^2 - (R_{T} + L_{T} + K_{d})[RL] + R_{T}L_{T} = 0 $$\n这是一个标准二次方程，形式为 $ax^2 + bx + c = 0$，其中 $x = [RL]$，$a = 1$，$b = -(R_{T} + L_{T} + K_{d})$，$c = R_{T}L_{T}$。其解由求根公式给出：\n$$ [RL] = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} $$\n$$ [RL] = \\frac{(R_{T} + L_{T} + K_{d}) \\pm \\sqrt{(R_{T} + L_{T} + K_{d})^2 - 4R_{T}L_{T}}}{2} $$\n我们必须选择具有物理意义的根。复合物 $[RL]$ 的浓度不能超过受体 ($R_{T}$) 或配体 ($L_{T}$) 的总浓度。正根会得出一个大于 $R_{T} + L_{T}$ 的 $[RL]$ 值，这在物理上是不可能的。因此，我们必须选择负根。\n$$ [RL] = \\frac{(R_{T} + L_{T} + K_{d}) - \\sqrt{(R_{T} + L_{T} + K_{d})^2 - 4R_{T}L_{T}}}{2} $$\n受体占有率 $f(L_{T})$ 通过将 $[RL]$ 除以 $R_{T}$ 得到：\n$$ f(L_{T}) = \\frac{[RL]}{R_{T}} = \\frac{(R_{T} + L_{T} + K_{d}) - \\sqrt{(R_{T} + L_{T} + K_{d})^2 - 4R_{T}L_{T}}}{2R_{T}} $$\n这就是所要求的解析表达式。\n\n第2部分：计算受体占有率。\n\n给定 $R_{T} = 10\\ \\text{nM}$ 和 $K_{d} = 5\\ \\text{nM}$。我们使用推导出的 $f(L_{T})$ 表达式来计算三种不同总配体浓度下的占有率。\n\n当 $L_{T} = 1\\ \\text{nM}$ 时：\n$$ f(1) = \\frac{(10 + 1 + 5) - \\sqrt{(10 + 1 + 5)^2 - 4(10)(1)}}{2(10)} $$\n$$ f(1) = \\frac{16 - \\sqrt{16^2 - 40}}{20} = \\frac{16 - \\sqrt{256 - 40}}{20} = \\frac{16 - \\sqrt{216}}{20} $$\n$$ f(1) \\approx \\frac{16 - 14.697}{20} \\approx 0.0652 $$\n\n当 $L_{T} = 5\\ \\text{nM}$ 时：\n$$ f(5) = \\frac{(10 + 5 + 5) - \\sqrt{(10 + 5 + 5)^2 - 4(10)(5)}}{2(10)} $$\n$$ f(5) = \\frac{20 - \\sqrt{20^2 - 200}}{20} = \\frac{20 - \\sqrt{400 - 200}}{20} = \\frac{20 - \\sqrt{200}}{20} $$\n$$ f(5) = \\frac{20 - 10\\sqrt{2}}{20} = 1 - \\frac{\\sqrt{2}}{2} \\approx 0.293 $$\n\n当 $L_{T} = 50\\ \\text{nM}$ 时：\n$$ f(50) = \\frac{(10 + 50 + 5) - \\sqrt{(10 + 50 + 5)^2 - 4(10)(50)}}{2(10)} $$\n$$ f(50) = \\frac{65 - \\sqrt{65^2 - 2000}}{20} = \\frac{65 - \\sqrt{4225 - 2000}}{20} = \\frac{65 - \\sqrt{2225}}{20} $$\n$$ f(50) \\approx \\frac{65 - 47.17}{20} \\approx 0.892 $$\n\n第3部分：转录响应的定性形状。\n\n转录输出 $T(L_{T})$ 与占有率 $f(L_{T})$ 成正比，即 $T(L_{T}) = \\alpha\\, f(L_{T})$。最大输出为 $T_{\\max} = \\alpha$。因此，转录响应曲线作为 $L_{T}$ 的函数的形状与占有率曲线 $f(L_{T})$ 的形状相同，只是在垂直方向上按常数 $\\alpha$ 进行了缩放。\n根据 $f(L_{T})$ 的表达式：\n- 当 $L_{T} = 0$ 时，$[RL] = 0$，所以 $f(0) = 0$。响应从零开始。\n- 随着 $L_{T}$ 增加，$[RL]$ 也增加。对导数 $\\frac{df}{dL_{T}}$ 的简单分析表明它始终为正，因此该函数是单调递增的。\n- 当 $L_{T} \\to \\infty$ 时，受体变得饱和。在此极限下，$[RL] \\to R_{T}$，这意味着 $f(L_{T}) \\to 1$。\n因此，转录响应 $T(L_{T})$ 从 0 开始，随 $L_{T}$ 单调增加，并渐近地趋近于最大值 $T_{\\max} = \\alpha$。其形状是一条饱和的、类似双曲线的曲线，这是由质量作用定律决定的剂量-效应关系的典型特征。\n\n第4部分：计算 $L_{T}^{(0.8)}$。\n\n我们需要找到导致转录输出等于最大值$80\\%$的总配体浓度 $L_{T}^{(0.8)}$。\n$$ T(L_{T}^{(0.8)}) = 0.8\\, T_{\\max} $$\n代入 $T(L_{T})$ 和 $T_{\\max}$ 的定义：\n$$ \\alpha\\, f(L_{T}^{(0.8)}) = 0.8\\, \\alpha $$\n这简化为找到使受体占有率为 $0.8$ 的配体浓度：\n$$ f(L_{T}^{(0.8)}) = 0.8 $$\n根据定义，$f(L_{T}) = \\frac{[RL]}{R_{T}}$。因此我们有：\n$$ \\frac{[RL]}{R_{T}} = 0.8 \\implies [RL] = 0.8\\, R_{T} $$\n使用给定值 $R_{T} = 10\\ \\text{nM}$：\n$$ [RL] = 0.8 \\times 10\\ \\text{nM} = 8\\ \\text{nM} $$\n现在我们必须找到产生此复合物平衡浓度的总配体浓度 $L_{T}$。我们可以使用基本方程进行反向推算。\n首先，求出游离受体浓度 $[R]$：\n$$ [R] = R_{T} - [RL] = 10\\ \\text{nM} - 8\\ \\text{nM} = 2\\ \\text{nM} $$\n接下来，使用 $K_{d}$ 的定义求出游离配体浓度 $[L]$：\n$$ K_{d} = \\frac{[R][L]}{[RL]} \\implies [L] = \\frac{K_{d}[RL]}{[R]} $$\n使用 $K_{d} = 5\\ \\text{nM}$：\n$$ [L] = \\frac{(5\\ \\text{nM})(8\\ \\text{nM})}{2\\ \\text{nM}} = 20\\ \\text{nM} $$\n最后，使用配体的质量平衡方程求出总配体浓度 $L_{T}$：\n$$ L_{T} = [L] + [RL] $$\n$$ L_{T}^{(0.8)} = 20\\ \\text{nM} + 8\\ \\text{nM} = 28\\ \\text{nM} $$\n问题要求答案四舍五入到三位有效数字，即 $28.0\\ \\text{nM}$。", "answer": "$$\n\\boxed{28.0}\n$$", "id": "2813040"}, {"introduction": "理论模型只有在与实验数据结合时才能发挥其预测能力。本练习将带你进入QSP在数据分析中的实际应用，你将学习如何将一个经典的剂量-反应模型与一组模拟的实验数据进行拟合。通过这个过程，你不仅能估算出像半数有效浓度（$EC_{50}$）和希尔系数（$n$）这样的关键药理学参数，还将接触到参数估计中的不确定性概念，即如何计算置信区间。[@problem_id:2961642]", "problem": "您正在研究由表皮生长因子 (EGF) 激活的 Ras-丝裂原活化蛋白激酶 (Ras-MAPK) 信号级联。研究方法是测量稳态下磷酸化的细胞外信号调节激酶 (ERK) 的比例，并将其作为细胞外配体浓度的函数。假设以下常用于受体介导的协同激活信号传导的基础理论：(i) 受体-配体结合遵循质量作用定律，(ii) 稳态下的信号输出是被占据或激活的受体比例及其下游协同步骤的单调函数，(iii) 不同剂量下的测量噪声是独立同分布的，服从方差恒定的高斯分布。在这些假设下，一个与活化的 Ras 比例及随后的 ERK 磷酸化水平一致的协同激活模型，使用一个具有四个参数的可饱和、单调、协同的函数，将配体浓度 $c$ 映射到响应 $y(c)$。这四个参数是：基础响应 $B$（无单位分数）、最大响应 $T$（无单位分数）、半数有效浓度 $EC_{50}$（单位为 nM）以及希尔系数 $n$（无单位，$n>0$）。参数 $EC_{50}$ 定义为响应值介于 $B$ 和 $T$ 中间值时所对应的浓度 $c$。在高斯噪声下的非线性回归意味着，参数的最大似然估计能使残差平方和最小化。\n\n任务：对于下方的每个数据集，使用非线性最小二乘法，将一个与(i)–(iii)点一致且参数为 $(B,T,EC_{50},n)$ 的协同激活模型拟合到所提供的剂量-响应数据。然后，使用参数估计的渐近正态近似，根据估计的参数协方差计算 $EC_{50}$ 的双侧 $0.95$ 置信区间（使用学生t分布的分位数，其自由度等于数据点数量减去参数数量）。最终结果必须以纳摩尔 (nM) 为单位报告。\n\n数据集（每个响应值是稳态下磷酸化的 ERK 的比例，无单位）：\n\n- 数据集 A（EGF 在典型上皮细胞系中；具有广泛覆盖范围的“理想情况”）\n  - 浓度 (nM)：$0$, $0.1$, $0.3$, $1$, $3$, $10$, $30$。\n  - 响应（无单位）：$0.050$, $0.077$, $0.130$, $0.328$, $0.605$, $0.843$, $0.911$。\n\n- 数据集 B（在 Ras 依赖背景下的类神经生长因子协同机制）\n  - 浓度 (nM)：$0$, $0.01$, $0.03$, $0.1$, $0.3$, $1$, $3$, $10$。\n  - 响应（无单位）：$0.020$, $0.0208$, $0.0272$, $0.096$, $0.380$, $0.694$, $0.739$, $0.743$。\n\n- 数据集 C（剂量敏感性平缓的突变体；在测试范围内未完全饱和）\n  - 浓度 (nM)：$0$, $1$, $3$, $10$, $30$, $100$。\n  - 响应（无单位）：$0.100$, $0.157$, $0.203$, $0.295$, $0.382$, $0.484$。\n\n- 数据集 D（近零基础响应；更宽的动态范围和更高的 $EC_{50}$）\n  - 浓度 (nM)：$0$, $5$, $10$, $30$, $50$, $100$, $300$。\n  - 响应（无单位）：$0.000$, $0.033$, $0.086$, $0.314$, $0.503$, $0.743$, $0.930$。\n\n拟合要求与约束：\n- 使用一个四参数协同激活模型，其参数为 $(B,T,EC_{50},n)$，满足 $0 \\le B \\le T \\le 1$，$EC_{50} > 0$（单位为 nM），以及 $n \\in (0,5]$。\n- 使用非线性最小二乘法同时估计所有四个参数。\n- 使用基于雅可比矩阵的参数估计渐近协方差来计算 $EC_{50}$ 的标准误，并使用自由度为 $N-4$（其中 $N$ 是数据集中的数据点数量）的学生t分位数构建双侧 $0.95$ 置信区间。\n- 将 $EC_{50}$ 及其置信区间边界以浮点数形式表示，单位为 nM。\n- 将所有报告的数值输出四舍五入至 $4$ 位有效数字。\n\n测试套件与预期输出：\n- 程序必须将所有四个数据集 A–D 作为固定的测试套件进行处理。\n- 对于每个数据集，计算并返回一个三元组，包含估计的 $EC_{50}$（单位为 nM）及其双侧 $0.95$ 置信区间的下限和上限（单位为 nM），每个值都四舍五入至 $4$ 位有效数字。\n- 您的程序应生成单行输出，其中包含一个以方括号括起来的逗号分隔列表形式的结果，每个数据集的三元组都包含在各自的方括号内，并按 $[A,B,C,D]$ 的顺序排列。例如，格式必须严格遵循 $[[a\\_1,a\\_2,a\\_3],[b\\_1,b\\_2,b\\_3],[c\\_1,c\\_2,c\\_3],[d\\_1,d\\_2,d\\_3]]$，其中每个 $a\\_i$, $b\\_i$, $c\\_i$, $d\\_i$ 都是一个以 nM 为单位、四舍五入至 $4$ 位有效数字的浮点数。不得打印任何额外文本。", "solution": "我们使用第一性原理，将 Ras-丝裂原活化蛋白激酶 (Ras-MAPK) 级联的生物学机制与一个协同剂量-响应模型联系起来。受体-配体相互作用受质量作用定律支配：被占据的受体比例随配体浓度 $c$ 单调增加。Ras-MAPK 中的下游招募和激活步骤可以表现出协同性，从而有效地产生一个通过指数为 $n$ 的 S 型变换依赖于 $c$ 的响应。在稳态下，与这些原理一致的一个最小且广泛使用的映射是一个可饱和的单调函数，其参数包括基础活性 $B$、最大活性 $T$、半数有效浓度 $EC_{50}$ 以及控制表观协同性的希尔系数 $n$。半数有效浓度 $EC_{50}$ 的定义条件是响应介于 $B$ 和 $T$ 的中间值。\n\n从统计角度来看，假设在不同浓度下噪声是独立同分布的、方差恒定的高斯噪声；那么参数的最大似然估计会使残差平方和最小化。因此，非线性最小二乘法是一个合适的估计器。设模型表示为\n$$\ny(c; \\theta) \\equiv B + (T - B)\\,\\frac{c^{n}}{EC_{50}^{n} + c^{n}},\n$$\n参数向量为 $\\theta = (B, T, EC_{50}, n)$。约束条件 $0 \\le B \\le T \\le 1$、$EC_{50} > 0$ 和 $n \\in (0,5]$ 保证了生物学上的真实性（响应是分数，浓度是正数，协同性是有限的正数）。\n\n给定数据 $\\{(c_i, y_i)\\}_{i=1}^{N}$，非线性最小二乘估计器求解\n$$\n\\hat{\\theta} = \\arg\\min_{\\theta} \\sum_{i=1}^{N} \\left[y_i - y(c_i;\\theta)\\right]^2.\n$$\n在标准正则性条件下，$\\hat{\\theta}$ 是渐近正态的，其协方差可通过观测到的费雪信息矩阵的逆来近似。高斯-牛顿近似得出\n$$\n\\widehat{\\mathrm{Cov}}(\\hat{\\theta}) \\approx s^2 \\left(J^\\top J\\right)^{-1},\n$$\n其中 $J$ 是雅可比矩阵，其元素为\n$$\nJ_{i,k} = \\frac{\\partial y(c_i;\\theta)}{\\partial \\theta_k}\\Bigg|_{\\theta=\\hat{\\theta}},\n$$\n且 $s^2$ 是残差方差估计量\n$$\ns^2 = \\frac{1}{N - p} \\sum_{i=1}^{N} \\left[y_i - y(c_i;\\hat{\\theta})\\right]^2,\n$$\n其中 $p=4$ 是参数数量。许多非线性最小二乘法的软件实现，包括信赖域反射算法，会计算 $\\left(J^\\top J\\right)^{-1}$ 的一个估计值，并用 $s^2$ 对其进行缩放，以生成参数协方差矩阵的估计值。\n\n为了计算 $EC_{50}$ 的双侧 $0.95$ 置信区间，从协方差矩阵的相应对角线元素中提取 $EC_{50}$ 分量的方差估计值 $\\widehat{\\mathrm{Var}}(\\widehat{EC_{50}})$。标准误是\n$$\n\\mathrm{SE}(\\widehat{EC_{50}}) = \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{EC_{50}})}.\n$$\n自由度为 $\\nu = N - p$ 时，置信水平为 $0.95$ 的双侧置信区间为\n$$\n\\widehat{EC_{50}} \\pm t_{1 - \\alpha/2,\\,\\nu}\\ \\mathrm{SE}(\\widehat{EC_{50}}),\n$$\n其中 $\\alpha = 1 - 0.95 = 0.05$，而 $t_{1 - \\alpha/2,\\,\\nu}$ 是自由度为 $\\nu$ 的学生t分布的 $(1 - \\alpha/2)$ 分位数。\n\n针对每个数据集的算法计划：\n1. 汇集浓度 $c_i$（单位 nM）和响应 $y_i$（无单位）的向量。\n2. 通过非线性最小二乘法拟合四参数模型 $y(c;\\theta)$，并使用边界约束 $0 \\le B \\le 1$、$0 \\le T \\le 1$、$EC_{50} \\in (0, \\infty)$ 和 $n \\in (0,5]$。一个有效的初始化方法是：将 $B$ 设为观测到的最小响应，将 $T$ 设为观测到的最大响应，将 $EC_{50}$ 设为正浓度值的中位数，将 $n$ 设为 $1$。\n3. 获取基于雅可比矩阵的参数协方差矩阵，并计算 $\\widehat{EC_{50}}$ 的标准误。\n4. 使用 $\\nu = N - 4$，计算 $t_{1 - 0.025,\\,\\nu}$，并构建 $EC_{50}$ 的双侧 $0.95$ 置信区间。\n5. 以 nM 为单位表示点估计和区间边界，并将每个值四舍五入至 $4$ 位有效数字。\n6. 使用格式 $[[a_1,a_2,a_3],[b_1,b_2,b_3],[c_1,c_2,c_3],[d_1,d_2,d_3]]$ 输出包含四个三元组的单行结果，按 $[A,B,C,D]$ 的顺序排列，其中对每个数据集，三元组为 $[\\widehat{EC_{50}}, \\mathrm{CI}_{\\mathrm{low}}, \\mathrm{CI}_{\\mathrm{high}}]$。\n\n所提供的数据集涵盖了对 Ras-MAPK 信号推断至关重要的互补情景：具有良好动态范围的典型 S 型响应、具有亚纳摩尔级灵敏度的高度协同机制、具有不完全饱和且挑战可识别性的平缓斜率，以及跨越超过两个数量级浓度的近零基础响应机制。带有边界约束的非线性回归和渐近协方差计算共同产生了具有科学意义的 $EC_{50}$ 估计值及其置信区间，所有单位均为纳摩尔，适用于比较不同条件下的信号传导灵敏度。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\nfrom scipy.stats import t as student_t\n\ndef hill_response(c, B, T, EC50, n):\n    # Cooperative activation model, c in nM, responses unitless\n    # Ensure safe power for zero concentration: c**n is 0 when c=0 and n>0\n    return B + (T - B) * (np.power(c, n)) / (np.power(EC50, n) + np.power(c, n))\n\ndef fit_hill_and_ci(c, y):\n    c = np.asarray(c, dtype=float)\n    y = np.asarray(y, dtype=float)\n\n    # Initial guesses\n    B0 = float(np.clip(np.min(y), 0.0, 1.0))\n    T0 = float(np.clip(np.max(y), 0.0, 1.0))\n    # Avoid EC50 initialization at 0 due to zero concentrations; use median of positive concentrations\n    positive_c = c[c > 0]\n    EC500 = float(np.median(positive_c)) if positive_c.size > 0 else 1.0\n    n0 = 1.0\n\n    p0 = [B0, T0, EC500, n0]\n\n    # Bounds: 0 = B = 1, 0 = T = 1, EC50 in (1e-12, 1e9], n in (1e-6, 5]\n    # Also enforce B = T by using independent bounds and relying on optimizer; data typically ensure B=T.\n    lower_bounds = [0.0, 0.0, 1e-12, 1e-6]\n    upper_bounds = [1.0, 1.0, 1e9, 5.0]\n\n    # Fit\n    popt, pcov = curve_fit(\n        hill_response, c, y,\n        p0=p0, bounds=(lower_bounds, upper_bounds),\n        method='trf', max_nfev=10000\n    )\n\n    # Degrees of freedom\n    N = y.size\n    p = 4\n    dof = max(N - p, 1)\n\n    # curve_fit with absolute_sigma=False scales pcov by reduced chi^2 internally,\n    # but we will keep it as provided (already scaled) for standard errors.\n    # Extract standard error for EC50\n    se = np.sqrt(np.diag(pcov))\n    se_ec50 = float(se[2])\n\n    ec50_hat = float(popt[2])\n\n    # Two-sided 95% CI using Student t\n    alpha = 0.05\n    tcrit = float(student_t.ppf(1 - alpha/2.0, dof))\n    ci_low = ec50_hat - tcrit * se_ec50\n    ci_high = ec50_hat + tcrit * se_ec50\n\n    # Enforce positivity for CI bounds (biologically EC50 > 0)\n    ci_low = max(ci_low, 0.0)\n\n    return ec50_hat, ci_low, ci_high\n\ndef round_sig(x, sig=4):\n    if x == 0 or not np.isfinite(x):\n        return \"0.0\"\n    # Use general format with specified significant digits\n    return f\"{x:.{sig}g}\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Dataset A\n    c_A = np.array([0.0, 0.1, 0.3, 1.0, 3.0, 10.0, 30.0], dtype=float)\n    y_A = np.array([0.050, 0.077, 0.130, 0.328, 0.605, 0.843, 0.911], dtype=float)\n\n    # Dataset B\n    c_B = np.array([0.0, 0.01, 0.03, 0.1, 0.3, 1.0, 3.0, 10.0], dtype=float)\n    y_B = np.array([0.020, 0.0208, 0.0272, 0.096, 0.380, 0.694, 0.739, 0.743], dtype=float)\n\n    # Dataset C\n    c_C = np.array([0.0, 1.0, 3.0, 10.0, 30.0, 100.0], dtype=float)\n    y_C = np.array([0.100, 0.157, 0.203, 0.295, 0.382, 0.484], dtype=float)\n\n    # Dataset D\n    c_D = np.array([0.0, 5.0, 10.0, 30.0, 50.0, 100.0, 300.0], dtype=float)\n    y_D = np.array([0.000, 0.033, 0.086, 0.314, 0.503, 0.743, 0.930], dtype=float)\n\n    test_cases = [\n        (c_A, y_A),\n        (c_B, y_B),\n        (c_C, y_C),\n        (c_D, y_D),\n    ]\n\n    results = []\n    for c, y in test_cases:\n        ec50_hat, ci_low, ci_high = fit_hill_and_ci(c, y)\n        # Round to 4 significant figures as floats\n        val1 = float(round_sig(ec50_hat, 4))\n        val2 = float(round_sig(ci_low, 4))\n        val3 = float(round_sig(ci_high, 4))\n        results.append([val1, val2, val3])\n\n    # Final print statement in the exact required format.\n    # Ensure single-line, nested list with comma-separated values.\n    formatted = \"[\" + \",\".join(\"[\" + \",\".join(map(str, triple)) + \"]\" for triple in results) + \"]\"\n    print(formatted)\n\nsolve()\n```", "id": "2961642"}, {"introduction": "药物在体内的疗效不仅取决于其在细胞水平上的作用，还严重依赖于其在组织中的输运过程。本练习将挑战你将视野从单个细胞扩展到三维组织层面，通过建立一个反应-扩散模型来模拟药物在一个肿瘤球体中的渗透情况。这个高级实践将展示QSP如何被用来预测由于药物渗透不足而可能出现的“庇护所”效应，这对于理解实体瘤的耐药性至关重要。[@problem_id:1460983]", "problem": "一个肿瘤药物开发团队正在研究一种新型共价抑制剂在三维（3D）肿瘤球状体模型中的渗透情况。该球状体是一个半径为 $R$ 的球体，其中靶蛋白的初始浓度 $T_0$ 是均匀的。抑制剂从外部供给，在球状体表面（$r=R$）维持恒定的浓度 $C_0$。药物以有效扩散系数 $D$ 扩散进入球状体，并以二级速率常数 $k_{\\text{on}}$ 与其靶蛋白发生不可逆结合。\n\n假设系统对于药物浓度分布 $C(r)$ 达到了稳态，其中 $r$ 是距球状体中心的径向距离。在本分析中，您可以假设靶蛋白浓度近似保持在 $T_0$ 不变（准一级近似），这对于初始渗透分析是有效的。这将反应项简化为消耗速率 $k_{\\text{on}} T_0 C(r)$。\n\n“庇护核心”被定义为球状体的中心区域，在该区域药物浓度过低，无法达到治疗效果。这种情况发生在 $C(r)$ 低于临界阈值 $C_{\\text{crit}}$ 的地方。这个庇护核心的半径用 $r_s$ 表示。\n\n假设系统在反应限制区域运行，其中希勒模量（Thiele modulus）的平方 $\\Phi^2 = \\frac{R^2 k_{\\text{on}} T_0}{D}$ 远小于1（即 $\\Phi \\ll 1$），请推导庇护核心半径 $r_s$ 的闭式解析表达式。您的最终答案需用球状体半径 $R$、希勒模量 $\\Phi$ 和无量纲浓度比 $\\eta = \\frac{C_{\\text{crit}}}{C_0}$ 来表示。您可以假设 $\\eta  1$。", "solution": "在稳态、球对称和准一级消耗 $k_{\\text{on}}T_{0}C$ 的条件下，球体内药物浓度 $C(r)$ 的扩散-反应方程为\n$$\n0=D\\left(\\frac{1}{r^{2}}\\frac{d}{dr}\\left(r^{2}\\frac{dC}{dr}\\right)\\right)-k_{\\text{on}}T_{0}\\,C.\n$$\n定义 $\\lambda^{2}=\\frac{k_{\\text{on}}T_{0}}{D}$，于是常微分方程变为\n$$\n\\frac{d^{2}C}{dr^{2}}+\\frac{2}{r}\\frac{dC}{dr}-\\lambda^{2}C=0.\n$$\n具有球对称性的有限通解为\n$$\nC(r)=\\frac{A}{r}\\sinh(\\lambda r),\n$$\n因为当 $r\\to 0$ 时，包含 $\\cosh$ 的项会发散。应用边界条件 $C(R)=C_{0}$ 可得\n$$\nA=\\frac{C_{0}R}{\\sinh(\\lambda R)}.\n$$\n因此，\n$$\n\\frac{C(r)}{C_{0}}=\\frac{R}{r}\\frac{\\sinh(\\lambda r)}{\\sinh(\\lambda R)}.\n$$\n通过 $\\Phi^{2}=\\frac{R^{2}k_{\\text{on}}T_{0}}{D}$ 引入希勒模量 $\\Phi$，于是有 $\\lambda R=\\Phi$ 和 $\\lambda r=\\Phi\\,\\frac{r}{R}$。那么\n$$\n\\frac{C(r)}{C_{0}}=\\frac{R}{r}\\frac{\\sinh\\!\\left(\\Phi\\frac{r}{R}\\right)}{\\sinh(\\Phi)}.\n$$\n在反应限制区域 $\\Phi\\ll 1$ 中，对 $\\Phi$ 展开至二阶：\n$$\n\\sinh\\!\\left(\\Phi\\frac{r}{R}\\right)=\\Phi\\frac{r}{R}+\\frac{\\Phi^{3}}{6}\\left(\\frac{r}{R}\\right)^{3}+O(\\Phi^{5}),\\quad\n\\sinh(\\Phi)=\\Phi+\\frac{\\Phi^{3}}{6}+O(\\Phi^{5}),\n$$\n代入可得\n$$\n\\frac{C(r)}{C_{0}} \\approx \\left(\\frac{R}{r}\\right)\\frac{\\Phi\\frac{r}{R}\\left(1 + \\frac{1}{6}\\Phi^2\\frac{r^2}{R^2}\\right)}{\\Phi\\left(1 + \\frac{1}{6}\\Phi^2\\right)} \\approx \\left(1 + \\frac{\\Phi^2}{6}\\frac{r^2}{R^2}\\right)\\left(1 - \\frac{\\Phi^2}{6}\\right) \\approx 1-\\frac{\\Phi^{2}}{6}\\left(1-\\frac{r^{2}}{R^{2}}\\right).\n$$\n根据 $C(r_{s})=C_{\\text{crit}}=\\eta C_{0}$（其中 $\\eta=\\frac{C_{\\text{crit}}}{C_{0}}1$）定义庇护核心半径 $r_{s}$。使用与 $\\Phi\\ll 1$ 一致的主阶近似，\n$$\n\\eta=1-\\frac{\\Phi^{2}}{6}\\left(1-\\frac{r_{s}^{2}}{R^{2}}\\right).\n$$\n解出 $r_{s}$ 可得\n$$\n\\frac{r_{s}^{2}}{R^{2}}=1-\\frac{6}{\\Phi^{2}}(1-\\eta),\n$$\n因此\n$$\nr_{s}=R\\sqrt{1-\\frac{6}{\\Phi^{2}}(1-\\eta)}.\n$$\n该表达式为实数，因此仅当 $1-\\eta\\leq \\frac{\\Phi^{2}}{6}$ 时存在庇护核心；否则 $r_{s}=0$（无庇护区域），这与反应限制区域中浓度梯度很弱的情况相符。", "answer": "$$\\boxed{R\\sqrt{1-\\frac{6(1-\\eta)}{\\Phi^2}}}$$", "id": "1460983"}]}