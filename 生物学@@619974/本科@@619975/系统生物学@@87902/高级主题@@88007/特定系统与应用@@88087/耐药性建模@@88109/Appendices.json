{"hands_on_practices": [{"introduction": "在建立任何生物系统的数学模型之前，一个关键步骤是从实验数据中确定模型的关键参数。本练习将引导你掌握一项基本技能：如何处理时间序列数据，以估算耐药细胞群体的净生长速率 $k$。通过将指数增长模型 $N(t) = N_0 \\exp(kt)$ 线性化，你将学习到一种在生物数据分析中广泛使用的方法，从而将原始的细胞计数数据转化为一个有意义的生长动力学参数 [@problem_id:1448090]。", "problem": "在一项关于药物抗性的研究中，一个癌细胞群体用一种恒定高浓度的新型治疗剂处理。研究发现，一小部分细胞亚群对该药物具有抗性并持续增殖。据推测，该抗性亚群的增长遵循一个简单的指数模型，$N(t) = N_0 \\exp(kt)$，其中$N(t)$是时间$t$时的抗性细胞数量，$N_0$是$t=0$时的初始抗性细胞数量，$k$是在治疗条件下抗性种群的净增长率。\n\n一位生物学家记录了在不同时间点$t$（单位：小时）的抗性细胞数量$N$的以下数据：\n\n| 时间，$t$ (h) | 抗性细胞数量，$N$ |\n|:-------------:|:------------------------------:|\n| 0             | 1250                           |\n| 12            | 2100                           |\n| 24            | 3500                           |\n| 36            | 6100                           |\n| 48            | 10200                          |\n\n根据这些实验数据，确定净增长率$k$的最佳拟合估计值。请以每小时 (h$^{-1}$) 为单位表示你的答案，并四舍五入到三位有效数字。", "solution": "我们用$N(t)=N_{0}\\exp(kt)$来为抗性亚群建模。取自然对数可得到一个线性关系\n$$\ny_{i}=\\ln N(t_{i})=\\ln N_{0}+k\\,t_{i},\n$$\n因此，估计$k$就简化为对$y_{i}$和$t_{i}$进行简单的线性回归。最小二乘斜率为\n$$\nk=\\frac{n\\sum t_{i}y_{i}-\\left(\\sum t_{i}\\right)\\left(\\sum y_{i}\\right)}{n\\sum t_{i}^{2}-\\left(\\sum t_{i}\\right)^{2}},\n$$\n其中有$n=5$个数据点。\n\n计算给定$N_{i}$的$y_{i}=\\ln N_{i}$：\n$$\n\\begin{aligned}\n&\\ln(1250)=7.13089883029635,\\\\\n&\\ln(2100)=7.64969262371151,\\\\\n&\\ln(3500)=8.16051824747750,\\\\\n&\\ln(6100)=8.71604405016140,\\\\\n&\\ln(10200)=9.23014299927236.\n\\end{aligned}\n$$\n用$t=\\{0,12,24,36,48\\}$计算所需的总和：\n$$\n\\sum t_{i}=120,\\quad \\sum t_{i}^{2}=4320,\\quad \\sum y_{i}=40.88729675091912,\n$$\n$$\n\\sum t_{i}y_{i}=0+12(7.64969262371151)+24(8.16051824747750)+36(8.71604405016140)+48(9.23014299927236)=1044.4731991948818.\n$$\n代入斜率公式：\n$$\nk=\\frac{5\\cdot 1044.4731991948818-120\\cdot 40.88729675091912}{5\\cdot 4320-120^{2}}=\\frac{315.89038586411436}{7200}=0.043873664\\ \\text{h}^{-1}.\n$$\n四舍五入到三位有效数字，最佳拟合估计值为$0.0439\\ \\text{h}^{-1}$。", "answer": "$$\\boxed{0.0439}$$", "id": "1448090"}, {"introduction": "耐药性的产生往往伴随着“适应性成本”（fitness cost），即在没有药物的环境中，耐药细胞的生长速度可能慢于敏感细胞。这个练习将探讨这种权衡关系，并利用一个竞争性生长模型来揭示适应性疗法（adaptive therapy）背后的数学原理。通过计算实现特定耐药细胞比例下降所需的“停药期”时长，你将深入理解如何利用细胞间的竞争来控制耐药性的演变 [@problem_id:1448117]。", "problem": "在肿瘤学领域，一种称为适应性疗法的策略涉及周期性地停止药物治疗，以管理耐药性的演变。这种方法基于以下原理：耐药癌细胞通常具有“适应性成本”，这意味着在无药环境中，它们的生长速度比药物敏感细胞慢。\n\n考虑一个在$t=0$时刻撤回药物治疗后肿瘤细胞群体的简化模型。该群体由两种类型的细胞组成：药物敏感细胞，其群体大小为$N_S(t)$；以及耐药细胞，其群体大小为$N_R(t)$。在没有药物的情况下，假定两种细胞类型都遵循简单的指数增长动力学。\n\n敏感细胞的内在增长率为$r_S$，耐药细胞的内在增长率为$r_R$。由于耐药性的适应性成本，我们假设$r_S > r_R$。在撤药的时刻（$t=0$），耐药细胞在总群体中所占的比例为$f_{R,0}$。\n\n无药期（或称“停药期”）的目标是让生长更快的敏感细胞在竞争中胜过耐药细胞，从而降低肿瘤中耐药细胞的比例。推导一个闭式解析表达式，用于计算无药期持续时间$T$。该时间$T$需满足耐药细胞在总群体中的比例从其初始值$f_{R,0}$降低到一个新值$\\alpha f_{R,0}$，其中$\\alpha$是一个满足$0 < \\alpha < 1$的常数。", "solution": "我们用无药环境下的指数增长来模拟药物敏感和耐药的细胞亚群。设$N_{S}(t)$和$N_{R}(t)$分别表示时刻$t$的敏感细胞群体和耐药细胞群体的大小。给定的物理原理是，每个亚群都以其内在增长率呈指数增长：\n$$\nN_{S}(t)=N_{S}(0)\\,\\exp(r_{S} t),\\quad N_{R}(t)=N_{R}(0)\\,\\exp(r_{R} t),\n$$\n其中由于耐药性的适应性成本，有$r_{S}>r_{R}$。\n\n设初始耐药比例为$f_{R,0}$，因此\n$$\nf_{R,0}=\\frac{N_{R}(0)}{N_{S}(0)+N_{R}(0)}.\n$$\n定义$N_{0}=N_{S}(0)+N_{R}(0)$，则$N_{R}(0)=f_{R,0}N_{0}$且$N_{S}(0)=(1-f_{R,0})N_{0}$。\n\n在时刻$t$的耐药细胞比例为\n$$\nf_{R}(t)=\\frac{N_{R}(t)}{N_{S}(t)+N_{R}(t)}=\\frac{N_{R}(0)\\exp(r_{R} t)}{N_{S}(0)\\exp(r_{S} t)+N_{R}(0)\\exp(r_{R} t)}.\n$$\n代入$N_{R}(0)=f_{R,0}N_{0}$和$N_{S}(0)=(1-f_{R,0})N_{0}$并消去$N_{0}$可得\n$$\nf_{R}(t)=\\frac{f_{R,0}\\exp(r_{R} t)}{(1-f_{R,0})\\exp(r_{S} t)+f_{R,0}\\exp(r_{R} t)}.\n$$\n我们要求无药期持续时间$T$满足$f_{R}(T)=\\alpha f_{R,0}$，其中$0<\\alpha<1$。设定此条件：\n$$\n\\alpha f_{R,0}=\\frac{f_{R,0}\\exp(r_{R} T)}{(1-f_{R,0})\\exp(r_{S} T)+f_{R,0}\\exp(r_{R} T)}.\n$$\n假设$f_{R,0}>0$，从两边消去$f_{R,0}$并取倒数：\n$$\n\\frac{1}{\\alpha}=\\frac{(1-f_{R,0})\\exp(r_{S} T)+f_{R,0}\\exp(r_{R} T)}{\\exp(r_{R} T)}=(1-f_{R,0})\\exp\\big((r_{S}-r_{R})T\\big)+f_{R,0}.\n$$\n重新整理以分离指数项：\n$$\n\\frac{1}{\\alpha}-f_{R,0}=(1-f_{R,0})\\exp\\big((r_{S}-r_{R})T\\big).\n$$\n除以$(1-f_{R,0})$并取自然对数：\n$$\n\\exp\\big((r_{S}-r_{R})T\\big)=\\frac{\\frac{1}{\\alpha}-f_{R,0}}{1-f_{R,0}}\n\\quad\\Longrightarrow\\quad\n(r_{S}-r_{R})T=\\ln\\!\\left(\\frac{\\frac{1}{\\alpha}-f_{R,0}}{1-f_{R,0}}\\right).\n$$\n最后，\n$$\nT=\\frac{1}{r_{S}-r_{R}}\\,\\ln\\!\\left(\\frac{\\frac{1}{\\alpha}-f_{R,0}}{1-f_{R,0}}\\right).\n$$\n由于$r_{S}>r_{R}$且$0<\\alpha<1$，对数的参数大于1，这确保了对于$0<f_{R,0}<1$的情况有$T>0$。", "answer": "$$\\boxed{\\frac{1}{r_{S}-r_{R}}\\,\\ln\\!\\left(\\frac{\\frac{1}{\\alpha}-f_{R,0}}{1-f_{R,0}}\\right)}$$", "id": "1448117"}, {"introduction": "掌握了生长速率和细胞竞争的基本模型后，我们可以将其应用于评估和优化临床治疗策略。这个问题将挑战你通过数学方法，量化比较两种常见的给药方案：持续低剂量疗法与间歇性高剂量疗法。此练习揭示了药物浓度 $C$ 与杀伤效果 $d(C)$ 之间的非线性关系如何影响治疗结果，从而展示了数学模型在优化治疗设计中的强大力量 [@problem_id:1448109]。", "problem": "一个细菌种群在培养基中培养，其数量 $N(t)$ 从初始种群 $N_0$ 开始，随时间 $t$ 以自然增长率 $r$ 呈指数增长。为了控制其增长，施用一种抗生素。该药物会诱导一个死亡率 $d(C)$，该死亡率依赖于其浓度 $C$，并遵循以下饱和函数：\n$$d(C) = d_{max} \\frac{C}{K_m + C}$$\n其中，$d_{max}$ 是药物可能诱导的最大死亡率，而 $K_m$ 是达到此最大速率一半时所需的药物浓度。种群的净变化率由 $\\frac{dN}{dt} = (r - d(C))N$ 给出。\n\n在总时长为 $T$ 的周期内，考虑两种不同的治疗策略。两种策略使用的总药量 $D$ 完全相同，该药量定义为浓度曲线在 $[0, T]$ 时间段上的时间积分。\n\n1.  **连续节拍式疗法 (CMT):** 在整个周期 $T$ 内维持恒定的药物浓度。\n2.  **间歇性高剂量疗法 (IHDT):** 仅在持续时间为 $T_{on}$ (其中 $0 < T_{on} < T$)的初始时间段内施用高浓度药物。在从 $T_{on}$ 到 $T$ 的剩余时间内，没有药物存在。\n\n确定在CMT疗法下的最终细菌种群数量 $N_{CMT}(T)$ 与在IHDT疗法下的最终细菌种群数量 $N_{IHDT}(T)$ 之比的解析表达式。您的答案应使用参数 $d_{max}$、$K_m$、$T$、$T_{on}$ 和 $D$ 来表示。", "solution": "种群遵循线性常微分方程 $ \\frac{dN}{dt} = \\left(r - d(C(t))\\right) N$，其中 $d(C) = d_{max} \\frac{C}{K_{m} + C}$。分离变量可得 $\\frac{dN}{N} = \\left(r - d(C(t))\\right) dt$。从 $0$ 到 $T$ 积分，并利用 $N(0) = N_{0}$，可得\n$$\n\\ln\\left(\\frac{N(T)}{N_{0}}\\right) = \\int_{0}^{T} \\left(r - d(C(t))\\right) dt = rT - \\int_{0}^{T} d(C(t))\\,dt,\n$$\n所以\n$$\nN(T) = N_{0}\\,\\exp\\!\\left(rT - \\int_{0}^{T} d(C(t))\\,dt\\right).\n$$\n\n对于CMT，浓度是恒定的：$C(t) = C_{c}$，对于 $t \\in [0,T]$。总药量约束 $D = \\int_{0}^{T} C(t)\\,dt$ 给出 $C_{c} = \\frac{D}{T}$。因此 $d(C)$ 是恒定的：\n$$\nd_{c} = d_{max}\\,\\frac{\\frac{D}{T}}{K_{m} + \\frac{D}{T}}.\n$$\n因此，\n$$\n\\int_{0}^{T} d(C(t))\\,dt = T\\,d_{c} = d_{max}\\,\\frac{D}{K_{m} + \\frac{D}{T}},\n$$\n并且\n$$\nN_{CMT}(T) = N_{0}\\,\\exp\\!\\left(rT - d_{max}\\,\\frac{D}{K_{m} + \\frac{D}{T}}\\right).\n$$\n\n对于IHDT，浓度为 $C(t) = C_{h}$（当 $t \\in [0,T_{on}]$ 时）和 $C(t) = 0$（当 $t \\in (T_{on},T]$ 时）。药物预算 $D = \\int_{0}^{T} C(t)\\,dt$ 给出 $C_{h} T_{on} = D$，所以 $C_{h} = \\frac{D}{T_{on}}$。那么\n$$\n\\int_{0}^{T} d(C(t))\\,dt = \\int_{0}^{T_{on}} d_{max}\\,\\frac{\\frac{D}{T_{on}}}{K_{m} + \\frac{D}{T_{on}}}\\,dt = T_{on}\\,d_{max}\\,\\frac{\\frac{D}{T_{on}}}{K_{m} + \\frac{D}{T_{on}}} = d_{max}\\,\\frac{D}{K_{m} + \\frac{D}{T_{on}}},\n$$\n并且\n$$\nN_{IHDT}(T) = N_{0}\\,\\exp\\!\\left(rT - d_{max}\\,\\frac{D}{K_{m} + \\frac{D}{T_{on}}}\\right).\n$$\n\n因此该比率为\n$$\n\\frac{N_{CMT}(T)}{N_{IHDT}(T)} = \\exp\\!\\left(-d_{max}\\,\\frac{D}{K_{m} + \\frac{D}{T}} + d_{max}\\,\\frac{D}{K_{m} + \\frac{D}{T_{on}}}\\right) = \\exp\\!\\left(d_{max}\\,D\\left[\\frac{1}{K_{m} + \\frac{D}{T_{on}}} - \\frac{1}{K_{m} + \\frac{D}{T}}\\right]\\right).\n$$", "answer": "$$\\boxed{\\exp\\!\\left(d_{max}\\,D\\left[\\frac{1}{K_{m} + \\frac{D}{T_{on}}} - \\frac{1}{K_{m} + \\frac{D}{T}}\\right]\\right)}$$", "id": "1448109"}]}