{"hands_on_practices": [{"introduction": "理论知识的最佳试金石是实践。理解积分反馈控制最直观的方式，莫过于观察它在实际作用下的独特“行为指纹”。本练习 [@problem_id:1439507] 提出了一个思想实验，旨在帮助你区分积分反馈与更简单的比例反馈。通过分析系统在持续扰动下的响应曲线，你将学会识别积分控制最核心的特性——鲁棒的完美适应能力。", "problem": "在一个合成生物学项目中，一个E. coli菌株被改造用于生产一种有价值的代谢物，“代谢物X”。遗传回路被设计用于将代谢物X的胞内浓度稳态地维持在一个特定的设定点 $C_0$。正在考虑两种潜在的调节反馈回路设计。第一种是比例反馈控制器，其中产生代谢物X的酶的合成速率，与设定点 $C_0$ 和当前浓度 $C(t)$ 之间的差值成正比地进行调节。第二种是积分反馈控制器，其中该酶的合成速率，根据设定点 $C_0$ 和当前浓度 $C(t)$ 之间差值随时间的累积（积分）进行调节。\n\n为了测试系统的行为，进行了一项实验。细胞最初处于稳态，代谢物X的浓度在设定点 $C_0$。在时间 $t=0$ 时，通过激活一个转运蛋白的基因引入一个持续的扰动，该转运蛋白以恒定速率将代谢物X持续泵出细胞。随后，监测代谢物X的浓度 $C(t)$。\n\n以下是对于 $t > 0$ 时浓度 $C(t)$ 可能的时间演化的四种描述。这些描述中哪一种是积分反馈控制系统所独有的特征？\n\nA. 浓度 $C(t)$ 最初降至 $C_0$ 以下。然后反馈系统激活，导致浓度增加，经过一段调整期后，它精确地返回到原始设定点浓度 $C_0$。\n\nB. 浓度 $C(t)$ 最初降至 $C_0$ 以下。然后反馈系统激活，导致浓度增加，但它稳定在一个新的、恒定的稳态浓度 $C_f$ 上，该浓度严格小于原始设定点 $C_0$。\n\nC. 浓度 $C(t)$ 开始从 $C_0$ 下降，并持续降低，直到达到一个新的、非常低的稳态浓度，系统没有表现出明显的反作用来抵消下降并返回到 $C_0$ 的趋势。\n\nD. 浓度 $C(t)$ 最初降至 $C_0$ 以下，但反馈系统过度校正，导致浓度上升到 $C_0$ 以上，然后再次下降到其以下，从而围绕某个小于 $C_0$ 的值产生持续振荡。", "solution": "设 $C(t)$ 表示代谢物X的胞内浓度。设酶合成控制输入为 $u(t)$，设持续的输出扰动（在 $t=0$ 时激活）为一个常数 $d>0$，代表一个外排速率。考虑关于扰动前稳态 $C_0$ 的线性化对象模型：\n$$\n\\frac{dC}{dt}=p\\,u-k\\,C-d,\n$$\n其中 $p>0$ 将酶合成速率映射到代谢物X的净生产，而 $k>0$ 代表总的一阶损失或稀释。在扰动前（$d=0$），系统处于稳态 $C=C_0$，具有某个基线输入 $u=u_0$ 满足\n$$\n0=p\\,u_0-k\\,C_0\\quad\\Rightarrow\\quad u_0=\\frac{k}{p}C_0.\n$$\n定义偏差 $x(t)=C(t)-C_0$ 和 $v(t)=u(t)-u_0$。从对象动态方程中减去扰动前的平衡方程，得到 $t\\geq 0$ 时的偏差动态方程：\n$$\n\\frac{dx}{dt}=p\\,v-k\\,x-d.\n$$\n设调节目标是维持 $C(t)\\to C_0$，等价于 $x(t)\\to 0$。定义调节误差 $e(t)=C_0-C(t)=-x(t)$。\n\n比例控制：$v(t)=K_p\\,e(t)=-K_p\\,x(t)$，其中 $K_p>0$。代入对象模型得到\n$$\n\\frac{dx}{dt}=p\\big(-K_p x\\big)-k\\,x-d=-(pK_p+k)\\,x-d.\n$$\n在稳态下，$dx/dt=0$ 给出\n$$\n0=-(pK_p+k)\\,x_{\\text{ss}}-d\\quad\\Rightarrow\\quad x_{\\text{ss}}=-\\frac{d}{pK_p+k}.\n$$\n因此稳态误差为\n$$\ne_{\\text{ss}}=-x_{\\text{ss}}=\\frac{d}{pK_p+k}>0,\n$$\n所以 $C_{\\text{ss}}=C_0-e_{\\text{ss}}<C_0$。因此，在恒定扰动下，比例控制产生一个非零的稳态误差（适应是不完美的），这与描述B相符。\n\n积分控制：$v(t)$ 由误差的积分驱动，可以写成微分形式\n$$\n\\frac{dv}{dt}=K_i\\,e(t)=-K_i\\,x(t),\n$$\n其中 $K_i>0$。考虑闭环系统的稳态。在稳态下，$\\frac{dv}{dt}=0$ 意味着 $e_{\\text{ss}}=0$，因此 $x_{\\text{ss}}=0$，所以 $C_{\\text{ss}}=C_0$。与稳态下的对象方程保持一致性要求\n$$\n0=p\\,v_{\\text{ss}}-k\\,x_{\\text{ss}}-d=p\\,v_{\\text{ss}}-d\\quad\\Rightarrow\\quad v_{\\text{ss}}=\\frac{d}{p},\n$$\n这是一个有限值。因此，积分控制器通过一个恰好足以抵消恒定扰动的恒定偏移量来调整 $u$，从而实现零稳态误差，即在瞬态过程后完美地适应并回到 $C_0$。这种行为是积分反馈在恒定扰动下的独有特征，与描述A相符。\n\n为了完整起见，在没有有效反馈作用的情况下，会有 $v=0$ 并且\n$$\n\\frac{dx}{dt}=-k\\,x-d\\quad\\Rightarrow\\quad x_{\\text{ss}}=-\\frac{d}{k},\n$$\n这对应于下降到一个低的稳态（描述C）。持续振荡（描述D）可能由各种类型的不良调谐反馈引起，并非积分控制的独有标志；此外，积分控制的标志性特征是对于恒定扰动的零稳态误差，而不是在设定点以下持续振荡。\n\n因此，积分反馈控制的独有特征描述是，尽管存在恒定扰动，浓度仍能精确返回到原始设定点 $C_0$，这与选项A相对应。", "answer": "$$\\boxed{A}$$", "id": "1439507"}, {"introduction": "我们已经知道积分反馈能够实现完美适应，但生物系统是如何在分子层面实现这种精妙的数学运算呢？本练习 [@problem_id:1439451] 将带你探索一种在合成生物学中广泛应用的“对偶积分反馈”分子线路。通过分析这个具体实现，你将亲手计算并理解系统的稳态设定点是如何由几个关键的生化反应速率常数决定的，这揭示了生物系统设定和调节其“恒温器”的优雅机制。", "problem": "一个合成生物学家团队正在设计一种细菌菌株，以鲁棒地维持一种荧光蛋白 $X$ 的细胞内浓度。该控制系统是一个实现对抗性积分反馈机制的基因线路。该机制涉及两种额外的控制器分子，$Z_1$ 和 $Z_2$。控制这些物种浓度（其浓度分别表示为 $x$、$z_1$ 和 $z_2$）的生化网络由以下一系列过程定义：\n\n1.  蛋白质 $X$ 以速率 $\\mu$ 组成性地产生。\n2.  蛋白质 $X$ 发生一级降解，速率常数为 $\\delta$。\n3.  控制器分子 $Z_1$ 催化 $X$ 的降解。此过程的反应速率为 $k x z_1$。\n4.  控制器分子 $Z_1$ 以速率 $k_1$ 组成性地产生。\n5.  控制器分子 $Z_2$ 的产生由 $X$ 催化，产生速率为 $k_2 x$。\n6.  控制器分子 $Z_1$ 和 $Z_2$ 在双分子反应中相互湮灭，速率常数为 $\\eta$。\n\n最初，该线路的参数设置为：$\\mu = 100$ nM/min，$\\delta = 0.1$ min$^{-1}$，$k = 1.0$ nM$^{-1}$min$^{-1}$，$k_1 = 50.0$ nM/min，$k_2 = 1.70$ min$^{-1}$，以及 $\\eta = 1.0$ nM$^{-1}$min$^{-1}$。\n\n通过定向进化，筛选出一种细菌变体，该变体在编码 $Z_1$ 的基因的启动子区域存在突变。该突变使其产生速率降至新值 $k'_1 = \\frac{1}{2} k_1$，而系统所有其他参数保持不变。\n\n计算该进化变体中蛋白质 $X$ 的新稳态浓度。最终答案以 nM 为单位，并四舍五入至三位有效数字。", "solution": "设 $x$、$z_1$ 和 $z_2$ 分别表示 $X$、$Z_1$ 和 $Z_2$ 的浓度。根据所列过程，质量作用动力学方程组为：\n$$\n\\frac{dx}{dt}=\\mu-\\delta x-k x z_1,\n$$\n$$\n\\frac{dz_1}{dt}=k_1-\\eta z_1 z_2,\n$$\n$$\n\\frac{dz_2}{dt}=k_2 x-\\eta z_1 z_2.\n$$\n在稳态下，令所有时间导数等于零。根据 $z_1$ 和 $z_2$ 的方程，\n$$\n0=k_1-\\eta z_1 z_2, \\quad 0=k_2 x-\\eta z_1 z_2.\n$$\n通过共同的湮灭项使两式右侧相等，可得\n$$\nk_1=\\eta z_1 z_2=k_2 x \\implies x^{\\ast}=\\frac{k_1}{k_2}.\n$$\n因此，$x$ 的稳态设定点与 $\\mu$、$\\delta$、$k$ 和 $\\eta$ 无关。发生突变后，$k_1'=\\frac{1}{2}k_1$，因此新的稳态浓度为\n$$\nx'^{\\ast}=\\frac{k_1'}{k_2}=\\frac{1}{2}\\frac{k_1}{k_2}.\n$$\n代入数值 $k_1=50.0\\,\\text{nM/min}$ 和 $k_2=1.70\\,\\text{min}^{-1}$，得到\n$$\nx'^{\\ast}=\\frac{1}{2}\\cdot\\frac{50.0}{1.70}\\,\\text{nM}=\\frac{25.0}{1.70}\\,\\text{nM}\\approx 14.705882\\ldots\\,\\text{nM}.\n$$\n四舍五入至三位有效数字，得到 $14.7$ nM。", "answer": "$$\\boxed{14.7}$$", "id": "1439451"}, {"introduction": "完美适应的实现依赖于一个理想的“积分器”，它能无偏差地累积误差信号。然而，在真实的生物环境中，分子会降解，信号会“泄漏”，完美的积分器难以存在。本练习 [@problem_id:1439453] 作为一个对理论模型的“压力测试”，将探讨当积分器存在“泄漏”时会发生什么。通过计算这种不完美系统中的稳态误差，你将更深刻地理解为什么一个无泄漏的积分环节对于实现鲁棒的完美适应至关重要。", "problem": "一个合成生物电路被设计用于调控输出蛋白 $Y$ 的浓度。该电路的动力学涉及一个中间调控蛋白 $I$。这些蛋白的浓度（记为 $[Y]$ 和 $[I]$）随时间的变化遵循以下微分方程组：\n$$\n\\frac{d[Y]}{dt} = k_p [I] - \\gamma_Y [Y]\n$$\n$$\n\\frac{d[I]}{dt} = k_{set} - k_i [Y] - \\gamma_I [I]\n$$\n此处，$k_p$ 是由 $I$ 激活的 $Y$ 的生成速率常数，$\\gamma_Y$ 是 $Y$ 的降解速率，$k_{set}$ 是 $I$ 的一个恒定基础生成速率，$k_i$ 是由 $Y$ 介导的 $I$ 的移除速率常数，而 $\\gamma_I$ 代表 $I$ 的内源降解速率。所有参数均为正实常数。\n\n最初，构建的电路使得蛋白 $I$ 的内源降解可以忽略不计，即 $\\gamma_I = 0$。使系统达到稳态，此时输出蛋白的浓度记为 $[Y]_{ss,0}$。\n\n随后，引入一个突变，使蛋白 $I$ 的内源降解速率增加到一个新的非零值 $\\gamma_I > 0$。系统随后进入一个新的稳态，此时输出蛋白的浓度记为 $[Y]_{ss,new}$。\n\n请用系统参数 $k_p, k_i, \\gamma_Y$ 和新的降解速率 $\\gamma_I$ 推导比值 $\\frac{[Y]_{ss,new}}{[Y]_{ss,0}}$ 的表达式。", "solution": "令时间导数为零以设定稳态。根据第一个方程，\n$$\n0 = k_p[I] - \\gamma_Y[Y] \\quad \\Rightarrow \\quad [I] = \\frac{\\gamma_Y}{k_p}[Y].\n$$\n最初，当 $\\gamma_I=0$ 时，稳态下的第二个方程给出\n$$\n0 = k_{set} - k_i[Y] \\quad \\Rightarrow \\quad [Y]_{ss,0} = \\frac{k_{set}}{k_i}.\n$$\n引入 $\\gamma_I > 0$ 后，稳态下的第二个方程变为\n$$\n0 = k_{set} - k_i[Y] - \\gamma_I[I] = k_{set} - \\left(k_i + \\frac{\\gamma_I\\gamma_Y}{k_p}\\right)[Y],\n$$\n解得\n$$\n[Y]_{ss,new} = \\frac{k_{set}}{k_i + \\frac{\\gamma_I\\gamma_Y}{k_p}}.\n$$\n因此，该比值为\n$$\n\\frac{[Y]_{ss,new}}{[Y]_{ss,0}} = \\frac{\\frac{k_{set}}{k_i + \\frac{\\gamma_I\\gamma_Y}{k_p}}}{\\frac{k_{set}}{k_i}} = \\frac{k_i}{k_i + \\frac{\\gamma_I\\gamma_Y}{k_p}} = \\frac{k_p k_i}{k_p k_i + \\gamma_I\\gamma_Y}.\n$$", "answer": "$$\\boxed{\\frac{k_p k_i}{k_p k_i + \\gamma_I \\gamma_Y}}$$", "id": "1439453"}]}