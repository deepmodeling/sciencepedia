{"hands_on_practices": [{"introduction": "在我们绘制适应度景观之前，首先必须了解它所覆盖的“领地”——基因型空间。这个练习提供了一个基础性的计算，帮助我们理解可能的基因组合数量是如何呈指数级增长的。通过这个计算，我们可以体会到进化在广阔的可能空间中搜索最优解时所面临的巨大挑战。[@problem_id:1434214]", "problem": "在进化生物学和系统生物学中，“基因型空间”是指某一给定生物体或系统的所有可能遗传构型的集合。理解这个空间的大小是分析适应度景观和进化路径等概念的根本第一步。\n\n考虑一个病毒抗药性发展的简化模型。抗性表型由病毒基因组内特定数量位点（称为基因座）上的突变决定。在每个基因座上，我们假设存在两种可能的变体，即等位基因：原始的易感“野生型”等位基因和新的抗性“突变型”等位基因。每个基因座上都有两种可能等位基因的系统称为双等位基因系统。病毒在所有相关基因座上的等位基因特定组合定义了其基因型。\n\n首先，计算一种简单病毒株可能拥有的独特基因型总数，其抗性由 $L_1 = 3$ 个独立的双等位基因座决定。\n\n其次，计算一种更复杂病毒株可能拥有的独特基因型总数，其抗性涉及 $L_2 = 10$ 个独立的双等位基因座。\n\n你的最终答案应为两个整数，分别对应 $L_1$ 和 $L_2$ 两种情况下的基因型数量。", "solution": "每个基因型是在每个基因座上选择一个等位基因的结果。对于一个有 $L$ 个独立双等位基因座的系统，每个基因座 $i$ 有 $2$ 种可能的等位基因。根据乘法法则，不同基因型的总数是所有基因座上选择数量的乘积：\n$$\nN(L)=\\prod_{i=1}^{L} 2=2^{L}.\n$$\n对于有 $L_{1}=3$ 个基因座的简单病毒株，\n$$\nN(L_{1})=2^{L_{1}}=2^{3}=8.\n$$\n对于有 $L_{2}=10$ 个基因座的复杂病毒株，\n$$\nN(L_{2})=2^{L_{2}}=2^{10}=1024.\n$$\n因此，所要求的两种基因型数量分别为 $8$ 和 $1024$。", "answer": "$$\\boxed{\\begin{pmatrix}8 & 1024\\end{pmatrix}}$$", "id": "1434214"}, {"introduction": "了解了基因型空间的尺度后，我们进而探索景观的“形状”。适应度景观可以用连续函数来建模，尤其是在系统生物学中，像蛋白质浓度这样的性状是连续变化的。这个练习将向您展示如何使用梯度这一数学工具来确定最可能的进化方向——即适应度景观上的最陡上升路径。[@problem_id:1434207]", "problem": "在一个合成生物学实验中，一个细菌种群被设计成其适应度 $F$ 依赖于两种蛋白质——蛋白质X和蛋白质Y的细胞内浓度。设它们的浓度分别用 $x$ 和 $y$ 表示，单位为任意单位 (a.u.)。高浓度的蛋白质X是有益的，而高浓度的蛋白质Y是有害的。这种关系由以下适应度函数量化，该函数模拟了X的激活和Y的抑制的综合效应：\n$$F(x, y) = F_{max} \\left( \\frac{x^n}{K_x^n + x^n} \\right) \\left( \\frac{K_y^n}{K_y^n + y^n} \\right)$$\n该系统的参数如下：\n- 最大适应度, $F_{max} = 1.0$ (无量纲)\n- 希尔系数, $n = 2$\n- 蛋白质X的半最大激活常数, $K_x = 10 \\text{ a.u.}$\n- 蛋白质Y的半最大抑制常数, $K_y = 20 \\text{ a.u.}$\n\n最初，细菌种群的平均蛋白质表达状态为 $(x_0, y_0) = (K_x, K_y)$。假设在环境的选择压力下，该种群将“贪婪地”进化，即其蛋白质表达水平将沿着适应度景观上最陡峭的上升方向改变。\n\n确定初始的适应方向。将此方向表示为在点 $(x_0, y_0)$ 处评估的适应度函数的梯度向量与x轴正方向所成的角度。请以度为单位提供您的答案，并四舍五入到三位有效数字。", "solution": "种群沿着最陡峭的上升方向适应，该方向由梯度向量 $\\nabla F(x,y) = \\left( \\frac{\\partial F}{\\partial x}, \\frac{\\partial F}{\\partial y} \\right)$ 给出。\n\n令 $A(x) = \\frac{x^{n}}{K_{x}^{n} + x^{n}}$ 且 $R(y) = \\frac{K_{y}^{n}}{K_{y}^{n} + y^{n}}$，所以 $F(x,y) = F_{\\max} A(x) R(y)$。\n\n则\n$$\n\\frac{\\partial F}{\\partial x} = F_{\\max} R(y) A'(x), \\quad \\frac{\\partial F}{\\partial y} = F_{\\max} A(x) R'(y).\n$$\n使用商法则计算 $A'(x)$，其中 $f(x) = x^{n}$ 和 $g(x) = K_{x}^{n} + x^{n}$：\n$$\nA'(x) = \\frac{f'(x)g(x) - f(x)g'(x)}{g(x)^{2}} = \\frac{n x^{n-1} (K_{x}^{n} + x^{n}) - x^{n} n x^{n-1}}{(K_{x}^{n} + x^{n})^{2}} = \\frac{n K_{x}^{n} x^{n-1}}{(K_{x}^{n} + x^{n})^{2}}.\n$$\n类似地，\n$$\nR'(y) = \\frac{0 \\cdot (K_{y}^{n} + y^{n}) - K_{y}^{n} \\cdot n y^{n-1}}{(K_{y}^{n} + y^{n})^{2}} = - \\frac{n K_{y}^{n} y^{n-1}}{(K_{y}^{n} + y^{n})^{2}}.\n$$\n在点 $(x_{0}, y_{0}) = (K_{x}, K_{y})$ 处求值：\n$$\nA(K_{x}) = \\frac{K_{x}^{n}}{K_{x}^{n} + K_{x}^{n}} = \\frac{1}{2}, \\quad R(K_{y}) = \\frac{K_{y}^{n}}{K_{y}^{n} + K_{y}^{n}} = \\frac{1}{2},\n$$\n$$\nA'(K_{x}) = \\frac{n K_{x}^{n} K_{x}^{n-1}}{(2 K_{x}^{n})^{2}} = \\frac{n}{4 K_{x}}, \\quad R'(K_{y}) = - \\frac{n K_{y}^{n} K_{y}^{n-1}}{(2 K_{y}^{n})^{2}} = - \\frac{n}{4 K_{y}}.\n$$\n因此，\n$$\n\\left. \\frac{\\partial F}{\\partial x} \\right|_{(K_{x},K_{y})} = F_{\\max} \\cdot \\frac{1}{2} \\cdot \\frac{n}{4 K_{x}} = \\frac{F_{\\max} n}{8 K_{x}}, \\quad\n\\left. \\frac{\\partial F}{\\partial y} \\right|_{(K_{x},K_{y})} = F_{\\max} \\cdot \\frac{1}{2} \\cdot \\left( - \\frac{n}{4 K_{y}} \\right) = - \\frac{F_{\\max} n}{8 K_{y}}.\n$$\n因此，在 $(K_{x}, K_{y})$ 处的梯度是\n$$\n\\nabla F(K_{x}, K_{y}) = \\left( \\frac{F_{\\max} n}{8 K_{x}}, \\, - \\frac{F_{\\max} n}{8 K_{y}} \\right).\n$$\n该向量与x轴正方向所成的角度 $\\theta$ 满足\n$$\n\\tan \\theta = \\frac{ \\left. \\frac{\\partial F}{\\partial y} \\right|_{(K_{x},K_{y})} }{ \\left. \\frac{\\partial F}{\\partial x} \\right|_{(K_{x},K_{y})} } = \\frac{ - \\frac{F_{\\max} n}{8 K_{y}} }{ \\frac{F_{\\max} n}{8 K_{x}} } = - \\frac{K_{x}}{K_{y}}.\n$$\n当 $F_{\\max} = 1$，$n = 2$，$K_{x} = 10$ 且 $K_{y} = 20$ 时，上式变为\n$$\n\\tan \\theta = - \\frac{10}{20} = - \\frac{1}{2}.\n$$\n由于x分量为正，y分量为负，梯度位于第四象限，所以\n$$\n\\theta = \\arctan\\!\\left( - \\frac{1}{2} \\right) = - \\frac{180}{\\pi} \\arctan\\!\\left( \\frac{1}{2} \\right) \\approx -26.565051\\ \\text{度}.\n$$\n四舍五入到三位有效数字，初始的适应方向是 $-26.6$ 度。", "answer": "$$\\boxed{-26.6}$$", "id": "1434207"}, {"introduction": "现实中的适应过程往往不是简单的“爬山”。这个练习将带领我们分析一个复杂的“崎岖”景观，在这里，通往顶峰的道路并非一帆风顺。我们将通过识别可以困住种群的局部最优点，并计算到达全局最高点的不同适应性路径数量，来深入理解景观的结构如何影响进化的可预测性。[@problem_id:1434220]", "problem": "在演化系统生物学中，适应性景观（fitness landscape）是一个从一组基因型到其适应度值的映射。考虑一个单倍体生物的简化模型，该生物有4个基因座，每个基因座可以有两个等位基因之一（用0或1表示）。因此，一个基因型可以用一个4位的二进制字符串表示，范围从 '0000'（野生型）到 '1111'。下表给出了16种可能基因型中每一种的适应度，以繁殖率衡量。\n\n| 基因型   | 适应度  | 基因型   | 适应度  |\n| :------: | :-----: | :------: | :-----: |\n| 0000     | 1.0     | 1000     | 2.5     |\n| 0001     | 0.7     | 1001     | 2.2     |\n| 0010     | 2.8     | 1010     | 4.5     |\n| 0011     | 2.7     | 1011     | 7.0     |\n| 0100     | 0.8     | 1100     | 5.0     |\n| 0101     | 4.0     | 1101     | 3.5     |\n| 0110     | 1.5     | 1110     | 6.0     |\n| 0111     | 3.8     | 1111     | 8.0     |\n\n我们定义以下术语：\n- 单步突变（single-step mutation）指二进制字符串中恰好一个数字发生改变（例如，'1010'是'1011'的单步突变体）。\n- “全局适应性峰”（global fitness peak）是整个景观中具有最高适应度值的基因型。\n- “局部适应性峰”（local fitness peak）是指其适应度严格大于其所有单步突变邻居的基因型。全局峰也被视为一个局部峰。\n- “适应性路径”（adaptive path）是从一个初始基因型开始到一个目标基因型结束的基因型序列，其中序列中每个后续基因型都是通过单步突变到达的，并且具有严格更高的适应度值。\n\n设 $L$ 为该景观中局部适应性峰的总数。设 $P$ 为从野生型基因型 '0000' 到全局适应性峰的不同适应性路径的数量。\n\n计算比率 $P/L$，这是一个将演化的可预测性与景观的崎岖度联系起来的度量。将您的最终答案四舍五入到两位有效数字。", "solution": "我们将基因型视为一个4维超立方体的顶点，如果两个基因型之间恰好相差一个比特，则它们之间存在一条边。设 $f(g)$ 表示基因型 $g$ 的适应度。一个适应性步骤是从 $g$ 到 $h$ 的一条边，其中汉明距离为1且 $f(h)>f(g)$。所有适应性步骤的集合定义了一个按适应度递增方向排列的有向无环图（DAG）。从 $0000$ 到 $1111$ 的适应性路径则是该DAG中从 $0000$ 到 $1111$ 的一条有向路径。\n\n首先，通过找出表中的最大适应度来确定全局峰。最大值为 $f(1111)=8.0$，所以全局峰是 $1111$。\n\n接下来，计算局部峰。如果一个基因型 $g$ 对于其四个单步邻居 $h$ 中的每一个，都有 $f(g)>f(h)$，那么它就是一个局部峰。我们检查每个基因型：\n\n- $0000$：邻居为 $1000$ ($2.5$)、$0100$ ($0.8$)、$0010$ ($2.8$)、$0001$ ($0.7$)。由于 $2.5>1.0$ 且 $2.8>1.0$，因此不是一个峰。\n- $0001$：邻居为 $1001$ ($2.2$)、$0101$ ($4.0$)、$0011$ ($2.7$)、$0000$ ($1.0$)。由于有多个邻居的适应度更高，因此不是一个峰。\n- $0010$：邻居为 $1010$ ($4.5$)、$0110$ ($1.5$)、$0000$ ($1.0$)、$0011$ ($2.7$)。由于 $4.5>2.8$，因此不是一个峰。\n- $0011$：邻居为 $1011$ ($7.0$)、$0111$ ($3.8$)、$0001$ ($0.7$)、$0010$ ($2.8$)。由于 $7.0>2.7$、$3.8>2.7$ 且 $2.8>2.7$，因此不是一个峰。\n- $0100$：邻居为 $1100$ ($5.0$)、$0000$ ($1.0$)、$0110$ ($1.5$)、$0101$ ($4.0$)。由于 $5.0>0.8$、$4.0>0.8$、$1.5>0.8$ 且 $1.0>0.8$，因此不是一个峰。\n- $0101$：邻居为 $1101$ ($3.5$)、$0001$ ($0.7$)、$0111$ ($3.8$)、$0100$ ($0.8$)。所有邻居的适应度都更低：$4.0>3.5$、$4.0>0.7$、$4.0>3.8$、$4.0>0.8$。因此 $0101$ 是一个局部峰。\n- $0110$：邻居为 $1110$ ($6.0$)、$0010$ ($2.8$)、$0100$ ($0.8$)、$0111$ ($3.8$)。由于有多个邻居的适应度更高，因此不是一个峰。\n- $0111$：邻居为 $1111$ ($8.0$)、$0011$ ($2.7$)、$0101$ ($4.0$)、$0110$ ($1.5$)。由于 $8.0>3.8$ 且 $4.0>3.8$，因此不是一个峰。\n- $1000$：邻居为 $0000$ ($1.0$)、$1100$ ($5.0$)、$1010$ ($4.5$)、$1001$ ($2.2$)。由于 $5.0>2.5$ 且 $4.5>2.5$，因此不是一个峰。\n- $1001$：邻居为 $0001$ ($0.7$)、$1101$ ($3.5$)、$1011$ ($7.0$)、$1000$ ($2.5$)。由于 $3.5>2.2$、$7.0>2.2$ 且 $2.5>2.2$，因此不是一个峰。\n- $1010$：邻居为 $0010$ ($2.8$)、$1110$ ($6.0$)、$1000$ ($2.5$)、$1011$ ($7.0$)。由于 $6.0>4.5$ 且 $7.0>4.5$，因此不是一个峰。\n- $1011$：邻居为 $0011$ ($2.7$)、$1111$ ($8.0$)、$1001$ ($2.2$)、$1010$ ($4.5$)。由于 $8.0>7.0$，因此不是一个峰。\n- $1100$：邻居为 $0100$ ($0.8$)、$1000$ ($2.5$)、$1110$ ($6.0$)、$1101$ ($3.5$)。由于 $6.0>5.0$，因此不是一个峰。\n- $1101$：邻居为 $0101$ ($4.0$)、$1001$ ($2.2$)、$1111$ ($8.0$)、$1100$ ($5.0$)。由于 $4.0>3.5$、$8.0>3.5$ 且 $5.0>3.5$，因此不是一个峰。\n- $1110$：邻居为 $0110$ ($1.5$)、$1010$ ($4.5$)、$1100$ ($5.0$)、$1111$ ($8.0$)。由于 $8.0>6.0$，因此不是一个峰。\n- $1111$：作为全局最大值，其所有邻居的适应度都更低；它是一个局部峰。\n\n因此，局部适应性峰的总数是 $L=2$（即 $0101$ 和 $1111$）。\n\n现在计算 $P$，即从 $0000$ 到 $1111$ 的适应性路径的数量。通过列出从 $0000$ 可达的节点出发的出边（适应度更高的单步邻居）来构建DAG：\n\n- 从 $0000$ ($1.0$)：到 $1000$ ($2.5$)、$0010$ ($2.8$)。\n- 从 $1000$ ($2.5$)：到 $1100$ ($5.0$)、$1010$ ($4.5$)。\n- 从 $0010$ ($2.8$)：到 $1010$ ($4.5$)。\n- 从 $1100$ ($5.0$)：到 $1110$ ($6.0$)。\n- 从 $1010$ ($4.5$)：到 $1110$ ($6.0$)、$1011$ ($7.0$)。\n- 从 $1110$ ($6.0$)：到 $1111$ ($8.0$)。\n- 从 $1011$ ($7.0$)：到 $1111$ ($8.0$)。\n\n将 $N(g)$ 定义为该DAG中从基因型 $g$ 到 $1111$ 的有向路径数量。使用动态规划（在可达集合内按从高到低的适应度进行拓扑排序），施加终端条件 $N(1111)=1$，并且对于任何其他节点 $g$，\n$$\nN(g)=\\sum_{h:\\,h\\text{ is a single-step neighbor of }g,\\;f(h)>f(g)} N(h).\n$$\n从汇点向上评估：\n$$\nN(1111)=1,\\quad N(1110)=N(1111)=1,\\quad N(1011)=N(1111)=1,\n$$\n$$\nN(1010)=N(1110)+N(1011)=1+1=2,\\quad N(1100)=N(1110)=1,\n$$\n$$\nN(1000)=N(1100)+N(1010)=1+2=3,\\quad N(0010)=N(1010)=2,\n$$\n$$\nN(0000)=N(1000)+N(0010)=3+2=5.\n$$\n因此 $P=5$。\n\n最后，计算该比率并四舍五入到两位有效数字：\n$$\n\\frac{P}{L}=\\frac{5}{2}=2.5.\n$$\n因此，保留两位有效数字，该比率为 $2.5$。", "answer": "$$\\boxed{2.5}$$", "id": "1434220"}]}