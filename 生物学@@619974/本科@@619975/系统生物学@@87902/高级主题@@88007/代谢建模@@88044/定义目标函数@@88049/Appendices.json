{"hands_on_practices": [{"introduction": "在系统生物学中，一个核心挑战是如何在数学上定义细胞的“目标”，例如最快速度的生长。通量平衡分析（FBA）通过构建一个“生物质目标函数”来解决此问题，该函数本质上是制造一个细胞单位所需的各种生物分子的化学配方。本练习将指导你根据一个假设微生物的实验测量数据，从头开始构建这样一个目标函数，这是将细胞生理学目标转化为可计算模型的关键一步。[@problem_id:2038523]", "problem": "在合成生物学领域，通量平衡分析 (FBA) 是一种强大的计算方法，用于预测生物体基因组尺度模型中的代谢通量分布。FBA 的一个关键组成部分是“生物质目标函数”，这是一个伪反应，代表了合成所有细胞组分以产生1克干重 (gDW) 所需的化学计量需求。\n\n考虑一种假设的微生物 *Artificium aedificator*，其生物质为了建模目的已被简化。该生物体的干重由三类大分子组成：Structurin (S)、Energin (E) 和 Informatin (I)。其1克干重的组成如下：\n- 0.600 克 Structurin (S)\n- 0.300 克 Energin (E)\n- 0.100 克 Informatin (I)\n\n这些大分子由三种前体代谢物合成：一种通用氨基酸 (AA)、一种通用核苷酸 (NT) 和一种通用脂肪酸 (FA)。这些大分子的合成反应由以下化学计量式给出：\n- Structurin 的合成：$8 \\text{ AA} + 2 \\text{ FA} \\longrightarrow 1 \\text{ S}$\n- Energin 的合成：$10 \\text{ FA} \\longrightarrow 1 \\text{ E}$\n- Informatin 的合成：$12 \\text{ NT} \\longrightarrow 1 \\text{ I}$\n\n前体和大分子的摩尔质量已确定为：\n- AA 的摩尔质量：$0.110 \\text{ g/mmol}$\n- NT 的摩尔质量：$0.330 \\text{ g/mmol}$\n- FA 的摩尔质量：$0.280 \\text{ g/mmol}$\n- S 的摩尔质量：$1.440 \\text{ g/mmol}$\n- E 的摩尔质量：$2.800 \\text{ g/mmol}$\n- I 的摩尔质量：$3.960 \\text{ g/mmol}$\n\n下列哪个化学计量方程正确地表示了产生1克干重 (gDW) 的 *A. aedificator* 的生物质目标函数？\n\nA. $\\frac{10}{3} \\text{ AA} + \\frac{10}{33} \\text{ NT} + \\frac{40}{21} \\text{ FA} \\longrightarrow 1 \\text{ gDW}$\n\nB. $\\frac{24}{5} \\text{ AA} + \\frac{6}{5} \\text{ NT} + \\frac{21}{5} \\text{ FA} \\longrightarrow 1 \\text{ gDW}$\n\nC. $8 \\text{ AA} + 12 \\text{ NT} + 12 \\text{ FA} \\longrightarrow 1 \\text{ gDW}$\n\nD. $\\frac{10}{3} \\text{ AA} + \\frac{10}{33} \\text{ NT} + \\frac{92}{21} \\text{ FA} \\longrightarrow 1 \\text{ gDW}$", "solution": "目标：推导 AA、NT 和 FA 的生物质目标函数系数（单位为 mmol/gDW），使得它们的组合能够精确产生由 0.600 g S、0.300 g E 和 0.100 g I 组成的 1 gDW 生物质，且与大分子合成化学计量和摩尔质量一致。\n\n1) 使用公式 $n = \\frac{m}{M}$ 以及给定的质量（单位 g）和摩尔质量（单位 g/mmol），将大分子质量转换为摩尔（mmol）：\n$$\nn_{S} = \\frac{0.600}{1.440} = \\frac{600}{1440} = \\frac{5}{12} \\text{ mmol},\\quad\nn_{E} = \\frac{0.300}{2.800} = \\frac{300}{2800} = \\frac{3}{28} \\text{ mmol},\\quad\nn_{I} = \\frac{0.100}{3.960} = \\frac{100}{3960} = \\frac{5}{198} \\text{ mmol}.\n$$\n\n2) 使用合成化学计量式计算每 1 gDW 所需的前体量：\n- Structurin：$8\\,\\text{AA} + 2\\,\\text{FA} \\longrightarrow 1\\,\\text{S}$。对于 $n_{S} = \\frac{5}{12}$ mmol 的 S：\n$$\n\\text{合成S所需的AA}: 8\\,n_{S} = 8 \\cdot \\frac{5}{12} = \\frac{10}{3} \\text{ mmol},\\quad\n\\text{合成S所需的FA}: 2\\,n_{S} = 2 \\cdot \\frac{5}{12} = \\frac{5}{6} \\text{ mmol}.\n$$\n- Energin：$10\\,\\text{FA} \\longrightarrow 1\\,\\text{E}$。对于 $n_{E} = \\frac{3}{28}$ mmol 的 E：\n$$\n\\text{合成E所需的FA}: 10\\,n_{E} = 10 \\cdot \\frac{3}{28} = \\frac{15}{14} \\text{ mmol}.\n$$\n- Informatin：$12\\,\\text{NT} \\longrightarrow 1\\,\\text{I}$。对于 $n_{I} = \\frac{5}{198}$ mmol 的 I：\n$$\n\\text{合成I所需的NT}: 12\\,n_{I} = 12 \\cdot \\frac{5}{198} = \\frac{60}{198} = \\frac{10}{33} \\text{ mmol}.\n$$\n\n3) 对所有大分子的前体需求量求和：\n$$\nn_{\\text{AA}} = \\frac{10}{3},\\quad\nn_{\\text{NT}} = \\frac{10}{33},\\quad\nn_{\\text{FA}} = \\frac{5}{6} + \\frac{15}{14} = \\frac{35}{42} + \\frac{45}{42} = \\frac{80}{42} = \\frac{40}{21}.\n$$\n\n4) 因此，生物质目标函数（每 1 gDW）为：\n$$\n\\frac{10}{3}\\,\\text{AA} + \\frac{10}{33}\\,\\text{NT} + \\frac{40}{21}\\,\\text{FA} \\longrightarrow 1\\,\\text{gDW}.\n$$\n\n5) 使用前体的摩尔质量 $M_{\\text{AA}} = 0.110$、$M_{\\text{NT}} = 0.330$、$M_{\\text{FA}} = 0.280$ g/mmol 进行质量一致性检验：\n$$\nm_{\\text{AA}} = \\frac{10}{3} \\cdot 0.110 = \\frac{1.1}{3} \\text{ g},\\quad\nm_{\\text{NT}} = \\frac{10}{33} \\cdot 0.330 = \\frac{3.3}{33} = 0.100 \\text{ g},\\quad\nm_{\\text{FA}} = \\frac{40}{21} \\cdot 0.280 = \\frac{11.2}{21} \\text{ g}.\n$$\n求和得到\n$$\n\\frac{1.1}{3} + 0.100 + \\frac{11.2}{21} = 0.366\\overline{6} + 0.100 + 0.533\\overline{3} = 1.000 \\text{ g},\n$$\n确认了总质量为 1 gDW。这与选项 A 一致。", "answer": "$$\\boxed{A}$$", "id": "2038523"}, {"introduction": "从自然系统转向工程系统，目标函数也是指导设计的关键。在合成生物学中，设计一组相互“正交”（即互不干扰）的组件是一项重大挑战。本练习要求你为一个合成转录因子库定义一个“系统特异性得分”，通过量化所有组件的总在靶激活与总脱靶激活的比率，来评估整个系统的性能。这展示了如何将一个抽象的工程目标（如特异性）转化为一个精确的、可用于优化的数学表达式。[@problem_id:1427264]", "problem": "一位合成生物学家正在为一个复杂的基因电路设计一个大型的合成转录因子 (TF) 及其相应启动子的文库。该文库包含 $N$ 种不同的 TF（由 $i \\in \\{1, 2, \\dots, N\\}$ 索引）和 $N$ 个相应的目标启动子（由 $j \\in \\{1, 2, \\dots, N\\}$ 索引）。TF $i$ 被特异性设计用于激活启动子 $i$（靶上相互作用），但也可能微弱地激活其他启动子 $j \\neq i$（脱靶相互作用）。\n\nTF $i$ 对启动子 $j$ 的激活强度由函数 $W_{ij} = \\alpha \\beta^{|i-j|}$ 建模，其中：\n- $\\alpha$ 是一个正常数，代表最大的靶上激活强度。\n- $\\beta$ 是脱靶衰减因子，满足 $0 < \\beta < 1$。\n- 项 $|i-j|$ 代表了 TF $i$ 与启动子 $j$ 在设计空间中的简化“距离”。较小的距离意味着更高的相似性，从而有更高的交叉反应可能性。\n\n为了量化整个文库的整体性能，该生物学家定义了一个全系统的“特异性分数” $S_{sys}$。该分数是所有 TF-启动子对的总靶上激活与所有对的总脱靶激活之比。\n\n你的任务是推导系统特异性分数 $S_{sys}$ 的闭式表达式，用组分数量 $N$ 和衰减因子 $\\beta$ 来表示。", "solution": "系统特异性分数 $S_{sys}$ 定义为总靶上激活与总脱靶激活之比。我们可以将其写为：\n$$\nS_{sys} = \\frac{\\sum_{\\text{on-target}} W_{ij}}{\\sum_{\\text{off-target}} W_{ij}}\n$$\n让我们首先计算分子（总靶上激活），然后计算分母（总脱靶激活）。\n\n**步骤1：计算总靶上激活。**\n靶上相互作用发生在TF索引与启动子索引匹配时，即 $i=j$。总靶上激活是所有 $W_{ii}$（其中 $i=1, \\dots, N$）的和。\n$$\n\\sum_{\\text{on-target}} W_{ij} = \\sum_{i=1}^{N} W_{ii} = \\sum_{i=1}^{N} \\alpha \\beta^{|i-i|} = \\sum_{i=1}^{N} \\alpha \\beta^{0} = \\sum_{i=1}^{N} \\alpha = N\\alpha\n$$\n\n**步骤2：计算总脱靶激活。**\n脱靶相互作用发生在所有 $i \\neq j$ 的配对 $(i, j)$ 上。总脱靶激活是对此类所有配对的双重求和。\n$$\n\\sum_{\\text{off-target}} W_{ij} = \\sum_{i=1}^{N} \\sum_{\\substack{j=1 \\\\ j \\neq i}}^{N} W_{ij} = \\sum_{i=1}^{N} \\sum_{\\substack{j=1 \\\\ j \\neq i}}^{N} \\alpha \\beta^{|i-j|}\n$$\n这个和代表了激活矩阵 $W$ 中除了对角线元素之外的所有元素。我们可以通过计算所有元素的总和，然后减去对角线元素的总和来得到这个值。\n所有元素的总和是：\n$$\n\\sum_{\\text{all}} W_{ij} = \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\alpha \\beta^{|i-j|}\n$$\n对角线元素的总和是我们在步骤1中找到的靶上总和，即 $N\\alpha$。\n因此，\n$$\n\\sum_{\\text{off-target}} W_{ij} = \\left(\\sum_{i=1}^{N} \\sum_{j=1}^{N} \\alpha \\beta^{|i-j|}\\right) - N\\alpha = \\alpha \\left( \\left(\\sum_{i=1}^{N} \\sum_{j=1}^{N} \\beta^{|i-j|}\\right) - N \\right)\n$$\n让我们集中计算双重求和 $F = \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\beta^{|i-j|}$。我们可以将关于 $j$ 的内层求和分成三部分：$j<i$、$j=i$ 和 $j>i$。\n$$\nF = \\sum_{i=1}^{N} \\left( \\sum_{j=1}^{i-1} \\beta^{|i-j|} + \\beta^{|i-i|} + \\sum_{j=i+1}^{N} \\beta^{|i-j|} \\right) = \\sum_{i=1}^{N} \\left( \\sum_{j=1}^{i-1} \\beta^{i-j} + 1 + \\sum_{j=i+1}^{N} \\beta^{j-i} \\right)\n$$\n括号内的两个和都是有限几何级数。\n对于第一个和，设 $k = i-j$。当 $j$ 从 $1$ 变到 $i-1$ 时，$k$ 从 $i-1$ 变到 $1$。\n$$\n\\sum_{j=1}^{i-1} \\beta^{i-j} = \\sum_{k=1}^{i-1} \\beta^{k} = \\beta \\frac{1-\\beta^{i-1}}{1-\\beta}\n$$\n对于第二个和，设 $k = j-i$。当 $j$ 从 $i+1$ 变到 $N$ 时，$k$ 从 $1$ 变到 $N-i$。\n$$\n\\sum_{j=i+1}^{N} \\beta^{j-i} = \\sum_{k=1}^{N-i} \\beta^{k} = \\beta \\frac{1-\\beta^{N-i}}{1-\\beta}\n$$\n将这些代回 $F$ 的表达式中：\n$$\nF = \\sum_{i=1}^{N} \\left( 1 + \\beta \\frac{1-\\beta^{i-1}}{1-\\beta} + \\beta \\frac{1-\\beta^{N-i}}{1-\\beta} \\right) = \\sum_{i=1}^{N} \\left( 1 + \\frac{\\beta}{1-\\beta} (2 - \\beta^{i-1} - \\beta^{N-i}) \\right)\n$$\n现在，我们对 $i$ 求和：\n$$\nF = \\sum_{i=1}^{N} 1 + \\frac{\\beta}{1-\\beta} \\sum_{i=1}^{N} (2 - \\beta^{i-1} - \\beta^{N-i}) = N + \\frac{\\beta}{1-\\beta} \\left( 2N - \\sum_{i=1}^{N} \\beta^{i-1} - \\sum_{i=1}^{N} \\beta^{N-i} \\right)\n$$\n让我们计算剩余的和。\n$$\n\\sum_{i=1}^{N} \\beta^{i-1} = \\sum_{k=0}^{N-1} \\beta^{k} = \\frac{1-\\beta^N}{1-\\beta}\n$$\n$$\n\\sum_{i=1}^{N} \\beta^{N-i} = \\beta^{N-1} + \\beta^{N-2} + \\dots + \\beta^0 = \\sum_{k=0}^{N-1} \\beta^{k} = \\frac{1-\\beta^N}{1-\\beta}\n$$\n所以，这两个和是相同的。将此代入 $F$ 的表达式中：\n$$\nF = N + \\frac{\\beta}{1-\\beta} \\left( 2N - 2 \\frac{1-\\beta^N}{1-\\beta} \\right) = N + \\frac{2N\\beta}{1-\\beta} - \\frac{2\\beta(1-\\beta^N)}{(1-\\beta)^2}\n$$\n脱靶激活强度的总和是 $\\alpha(F-N)$。\n$$\n\\sum_{\\text{off-target}} W_{ij} = \\alpha \\left( \\frac{2N\\beta}{1-\\beta} - \\frac{2\\beta(1-\\beta^N)}{(1-\\beta)^2} \\right) = \\frac{2\\alpha\\beta}{(1-\\beta)^2} \\left( N(1-\\beta) - (1-\\beta^N) \\right)\n$$\n\n**步骤3：计算系统特异性分数。**\n现在我们可以计算比率 $S_{sys}$。\n$$\nS_{sys} = \\frac{N\\alpha}{\\frac{2\\alpha\\beta}{(1-\\beta)^2} \\left( N(1-\\beta) - 1 + \\beta^N \\right)}\n$$\n$\\alpha$ 项相互抵消。\n$$\nS_{sys} = \\frac{N (1-\\beta)^2}{2\\beta (N(1-\\beta) - 1 + \\beta^N)}\n$$\n这就是系统特异性分数的最终闭式表达式。", "answer": "$$ \\boxed{ \\frac{N(1-\\beta)^{2}}{2\\beta(N(1-\\beta) - 1 + \\beta^{N})} } $$", "id": "1427264"}, {"introduction": "定义目标函数的另一个关键应用是连接数学模型与实验数据。为了确定模型的哪组参数“最佳”，我们需要一个函数来量化模型预测与实验测量值之间的吻合程度。本练习将引导你计算一个加权残差平方和（$\\chi^2$），这是一种广泛使用的目标函数，它不仅衡量误差大小，还通过权重考虑了不同实验测量（如蛋白质磷酸化和基因表达）的不确定性。这是参数估计和模型验证的基础。[@problem_id:1427249]", "problem": "一位系统生物学家正在为一个细胞信号通路开发数学模型。在该通路中，一个外部信号触发了一种蛋白质（我们称之为`P`）的磷酸化。这种蛋白质的磷酸化形式 `pP`，接着作为转录因子来增加一个特定基因 `G` 的表达。该模型由一组参数 $\\theta$ 描述，旨在预测 `pP` 的浓度以及 `G` 基因的mRNA相对丰度随时间的变化。\n\n为了验证模型并找到最佳参数，该生物学家收集了两种不同类型的实验数据：\n1.  **磷酸化蛋白质组学数据**：`pP` 浓度的测量值。\n    -   在时间 $t_1 = 10 \\text{ min}$ 时，测得的 `pP` 浓度为 $45.2 \\text{ nM}$，测量标准差为 $\\sigma_1 = 3.5 \\text{ nM}$。\n    -   在时间 $t_2 = 20 \\text{ min}$ 时，测得的 `pP` 浓度为 $88.9 \\text{ nM}$，测量标准差为 $\\sigma_2 = 6.1 \\text{ nM}$。\n2.  **基因表达数据**：使用定量聚合酶链式反应 (qPCR) 测量的 `G` 基因mRNA的相对丰度。\n    -   在时间 $t_3 = 60 \\text{ min}$ 时，测得的 `G`-mRNA 相对丰度为 $8.2$ 单位，测量标准差为 $\\sigma_3 = 0.7$ 单位。\n\n该生物学家正在测试一组特定的参数 $\\theta_0$。使用这组参数，模型给出以下预测值：\n-   在 $t_1 = 10 \\text{ min}$ 时，预测的 `pP` 浓度为 $41.8 \\text{ nM}$。\n-   在 $t_2 = 20 \\text{ min}$ 时，预测的 `pP` 浓度为 $95.3 \\text{ nM}$。\n-   在 $t_3 = 60 \\text{ min}$ 时，预测的 `G`-mRNA 相对丰度为 $9.4$ 单位。\n\n为了量化参数集 $\\theta_0$ 对数据的解释程度，您需要计算一个目标函数。请计算实验数据与模型预测值之间的总加权平方误差和的值。假设遵循标准的统计实践，即每个平方误差项的权重是相应实验测量值方差的倒数。最终答案是一个无量纲量。请将最终答案四舍五入到三位有效数字。", "solution": "目标是计算一个目标函数的值，具体来说是加权平方误差和（通常表示为 $\\chi^2$），该值用于量化在给定参数集下实验测量值与模型预测值之间的差异。\n\n加权平方误差和的通用公式是：\n$$ \\chi^2 = \\sum_{i=1}^{N} w_i (y_i^{\\text{exp}} - y_i^{\\text{model}})^2 $$\n其中 $N$ 是数据点的总数，$y_i^{\\text{exp}}$ 是第 $i$ 个实验测量值，$y_i^{\\text{model}}$ 是相应的模型预测值，$w_i$ 是第 $i$ 个数据点的权重。\n\n题目指出，每个项的权重是相应测量值方差的倒数。方差 $\\sigma_i^2$ 是标准差 $\\sigma_i$ 的平方。因此，权重 $w_i$ 由 $w_i = \\frac{1}{\\sigma_i^2}$ 给出。\n\n将此代入通用公式，得到需要计算的具体目标函数：\n$$ \\chi^2 = \\sum_{i=1}^{N} \\frac{(y_i^{\\text{exp}} - y_i^{\\text{model}})^2}{\\sigma_i^2} $$\n\n我们有三个实验数据点，所以 $N=3$。让我们从题目陈述中确定每个数据点的值。\n\n**数据点1：$t_1 = 10$ min 时的 `pP` 浓度**\n-   实验测量值：$y_1^{\\text{exp}} = 45.2 \\text{ nM}$\n-   模型预测值：$y_1^{\\text{model}} = 41.8 \\text{ nM}$\n-   标准差：$\\sigma_1 = 3.5 \\text{ nM}$\n\n**数据点2：$t_2 = 20$ min 时的 `pP` 浓度**\n-   实验测量值：$y_2^{\\text{exp}} = 88.9 \\text{ nM}$\n-   模型预测值：$y_2^{\\text{model}} = 95.3 \\text{ nM}$\n-   标准差：$\\sigma_2 = 6.1 \\text{ nM}$\n\n**数据点3：$t_3 = 60$ min 时的 `G`-mRNA 丰度**\n-   实验测量值：$y_3^{\\text{exp}} = 8.2 \\text{ 单位}$\n-   模型预测值：$y_3^{\\text{model}} = 9.4 \\text{ 单位}$\n-   标准差：$\\sigma_3 = 0.7 \\text{ 单位}$\n\n现在我们可以计算每个数据点对总 $\\chi^2$ 值的贡献。\n\n**第1项：**\n$$ \\frac{(y_1^{\\text{exp}} - y_1^{\\text{model}})^2}{\\sigma_1^2} = \\frac{(45.2 - 41.8)^2}{(3.5)^2} = \\frac{(3.4)^2}{12.25} = \\frac{11.56}{12.25} \\approx 0.943673 $$\n\n**第2项：**\n$$ \\frac{(y_2^{\\text{exp}} - y_2^{\\text{model}})^2}{\\sigma_2^2} = \\frac{(88.9 - 95.3)^2}{(6.1)^2} = \\frac{(-6.4)^2}{37.21} = \\frac{40.96}{37.21} \\approx 1.099435 $$\n\n**第3项：**\n$$ \\frac{(y_3^{\\text{exp}} - y_3^{\\text{model}})^2}{\\sigma_3^2} = \\frac{(8.2 - 9.4)^2}{(0.7)^2} = \\frac{(-1.2)^2}{0.49} = \\frac{1.44}{0.49} \\approx 2.938775 $$\n\n总加权平方误差和是这三项的和：\n$$ \\chi^2 = 0.943673 + 1.099435 + 2.938775 = 4.981883 $$\n\n题目要求将答案四舍五入到三位有效数字。\n计算值为 $4.981883$。前三位有效数字是 4、9 和 8。下一位数字是 1，小于 5，所以我们向下舍入。\n\n因此，最终答案是 $4.98$。", "answer": "$$\\boxed{4.98}$$", "id": "1427249"}]}