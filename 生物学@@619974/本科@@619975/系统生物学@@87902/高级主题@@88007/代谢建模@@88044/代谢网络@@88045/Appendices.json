{"hands_on_practices": [{"introduction": "要用计算方法分析复杂的代谢网络，第一步是将其生化反应转化为数学语言。每个反应都可以表示为一个化学计量向量，其中反应物系数为负，产物系数为正。这个练习将指导您完成这一基本转换，将一个大家熟知的整体反应——糖酵解——表示为一个向量，这是构建任何代谢模型（特别是化学计量矩阵 $S$）的基石。[@problem_id:1445968]", "problem": "在系统生物学中，代谢途径使用化学计量矩阵进行数学表示。该矩阵中的每一列都是一个代表单次反应的向量，其元素对应于所涉及代谢物的化学计量系数。\n\n考虑肌肉细胞中无氧糖酵解的总反应，这是一个提供快速能量的过程。在此途径中，一分子的葡萄糖无氧转化为两分子的乳酸。该转化与能量生成相耦合，净结果是由两分子的二磷酸腺苷 (ADP) 和两分子的无机磷酸 (Pi) 合成两分子的三磷酸腺苷 (ATP)。\n\n你的任务是确定该总反应的化学计量向量。该向量应按指定顺序罗列以下代谢物的系数：\n1. 葡萄糖\n2. ATP\n3. ADP\n4. Pi\n5. 乳酸\n\n请遵循标准惯例，即反应物的化学计量系数为负值，产物的化学计量系数为正值。将最终答案表示为单行矩阵。", "solution": "化学计量向量通过为写成标准形式 $\\sum_{i} \\nu_{i} X_{i} = 0$ 的反应中的每种代谢物 $X_{i}$ 指定一个系数 $\\nu_{i}$ 来表示总反应。根据惯例，反应物的系数为负，产物的系数为正。\n\n所述的肌肉细胞无氧糖酵解总反应为：一分子葡萄糖转化为两分子乳酸，同时由两分子二磷酸腺苷(ADP)和两分子无机磷酸(Pi)净合成两分子三磷酸腺苷(ATP)。\n将该反应明确写出：\n$$\\text{葡萄糖} + 2\\,\\text{ADP} + 2\\,\\text{Pi} \\longrightarrow 2\\,\\text{乳酸} + 2\\,\\text{ATP}.$$\n\n应用此符号惯例：\n- 葡萄糖是反应物，被消耗：系数为 $-1$。\n- ATP是产物，被生成：系数为 $+2$。\n- ADP是反应物，被消耗：系数为 $-2$。\n- Pi是反应物，被消耗：系数为 $-2$。\n- 乳酸是产物，被生成：系数为 $+2$。\n\n将这些系数按照指定顺序 [葡萄糖, ATP, ADP, Pi, 乳酸] 排列，即可得到化学计量行向量\n$$\\begin{pmatrix} -1 & 2 & -2 & -2 & 2 \\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}-1 & 2 & -2 & -2 & 2\\end{pmatrix}}$$", "id": "1445968"}, {"introduction": "在能够描述单个反应之后，下一步是定义细胞的最终生化目标：生长。在代谢模型中，这通常通过一个特殊的“生物质合成反应”来表示，该反应消耗前体和能量（如 $ATP$）以合成细胞的所有组成部分。尽管此练习使用了一个假设场景，但它能让您亲身体验科学家们是如何估算生物质合成的化学计量与能量需求的，这是建立用于通量平衡分析（FBA）的准确目标函数的关键一步。[@problem_id:1445985]", "problem": "研究一种假设的细菌 *Metabolicus simplicius* 生产生物质的效率。其干生物质由几种大分子组成，但为了简化模型，我们仅考虑其蛋白质和脂质含量。研究发现，其干生物质按质量计含有 50.0% 的蛋白质和 20.0% 的脂质。\n\n为了构建生物质合成模型，做出以下假设：\n1.  所有蛋白质都可由单一重复的单体——氨基酸丙氨酸（摩尔质量 $M_{Ala} = 89.09 \\text{ g/mol}$）表示。\n2.  所有脂质都可由单一重复的单体——脂肪酸棕榈酸（摩尔质量 $M_{PA} = 256.42 \\text{ g/mol}$）表示。\n3.  从中心代谢前体合成这些单体的能量成本（以腺苷三磷酸 (ATP) 计）为：\n    - 每合成一分子丙氨酸需要 5 分子 ATP。\n    - 每合成一分子棕榈酸需要 40 分子 ATP。\n4.  聚合（将单体组装成大分子）的能量成本为：\n    - 每形成一个肽键（将氨基酸连接成蛋白质）需要 4 分子 ATP。\n    - 每将一分子棕榈酸并入脂质结构需要 2 分子 ATP。\n5.  对于所涉及的大聚合物，假设形成蛋白质质量所需的肽键数量等于丙氨酸单体的数量。\n\n基于此模型，计算合成 1.00 克该细菌干生物质所需的 ATP 总摩尔数。将最终答案以每克生物质的 ATP 摩尔数表示，并四舍五入至三位有效数字。", "solution": "我们将 1.00 克的干生物质建模为含有 0.500 的蛋白质质量分数和 0.200 的脂质质量分数。因此，产生 ATP 需求的质量为\n$$\nm_{\\text{prot}}=0.500 \\text{ g}, \\quad m_{\\text{lip}}=0.200 \\text{ g}.\n$$\n使用给定的单体表示和摩尔质量，相应的单体摩尔数为\n$$\nn_{\\text{Ala}}=\\frac{m_{\\text{prot}}}{M_{\\text{Ala}}}=\\frac{0.500}{89.09} \\text{ mol}, \\qquad\nn_{\\text{PA}}=\\frac{m_{\\text{lip}}}{M_{\\text{PA}}}=\\frac{0.200}{256.42} \\text{ mol}.\n$$\n每个丙氨酸并入蛋白质的 ATP 成本等于单体合成成本和聚合成本之和。根据假设，肽键的数量等于丙氨酸单体的数量，所以\n$$\n\\text{ATP per Ala} = 5 + 4 = 9,\n$$\n得到\n$$\nn_{\\text{ATP,prot}} = 9\\,n_{\\text{Ala}} = 9\\left(\\frac{0.500}{89.09}\\right) \\text{ mol}.\n$$\n类似地，对于脂质，每个并入的棕榈酸的 ATP 成本等于\n$$\n\\text{ATP per PA} = 40 + 2 = 42,\n$$\n得到\n$$\nn_{\\text{ATP,lip}} = 42\\,n_{\\text{PA}} = 42\\left(\\frac{0.200}{256.42}\\right) \\text{ mol}.\n$$\n合成 1.00 克建模的生物质所需的 ATP 总量为\n$$\nn_{\\text{ATP,tot}} = n_{\\text{ATP,prot}} + n_{\\text{ATP,lip}} \n= 9\\left(\\frac{0.500}{89.09}\\right) + 42\\left(\\frac{0.200}{256.42}\\right) \\text{ mol}.\n$$\n进行数值计算，\n$$\nn_{\\text{Ala}} \\approx \\frac{0.500}{89.09} \\approx 5.6123\\times 10^{-3} \\text{ mol}, \\quad\nn_{\\text{ATP,prot}} \\approx 9 \\times 5.6123\\times 10^{-3} = 5.05107\\times 10^{-2} \\text{ mol},\n$$\n$$\nn_{\\text{PA}} \\approx \\frac{0.200}{256.42} \\approx 7.7997\\times 10^{-4} \\text{ mol}, \\quad\nn_{\\text{ATP,lip}} \\approx 42 \\times 7.7997\\times 10^{-4} = 3.27587568\\times 10^{-2} \\text{ mol}.\n$$\n因此，\n$$\nn_{\\text{ATP,tot}} \\approx 5.05107\\times 10^{-2} + 3.27587568\\times 10^{-2}\n= 8.32694568\\times 10^{-2} \\text{ mol}.\n$$\n由于这是针对 1.00 克的生物质，结果的单位是每克生物质的 ATP 摩尔数。四舍五入至三位有效数字，得到\n$$\n0.0833.\n$$", "answer": "$$\\boxed{0.0833}$$", "id": "1445985"}, {"introduction": "现在我们既能表示反应，又能定义细胞目标，便可以将这些概念整合起来分析一个完整的系统。本练习可以看作一个微型通量平衡分析（FBA）问题，它要求您为一个简化的能量代谢系统建立模型，应用稳态假设 ($S v = 0$)，并在一系列约束条件下优化目标（$ATP$ 生产）。通过这个实践，您将学会如何运用建模来量化特定生理扰动（如此处的质子泄漏）对细胞关键性能指标的影响。[@problem_id:2404803]", "problem": "本题使用一个最小化的、质量平衡的化学计量模型来量化质子被动扩散（即膜渗漏）对三磷酸腺苷（ATP）生产能力的影响。考虑内膜外侧（周质/膜间隙）有一个由代谢物 $H_p$ 代表的集中质子池。还原当量由一种抽象代谢物 $Red$ 代表。对于被追踪的代谢物，所有通量必须被视为稳态，即满足 $S v = 0$。定义了以下反应：\n- 还原当量供应：$R_{in}: \\ \\emptyset \\rightarrow Red$，通量为 $v_{in}$，界限为 $0 \\le v_{in} \\le R_{max}$。\n- 电子传递链质子泵：$R_{pump}: \\ Red \\rightarrow \\emptyset + s \\ H_p$，通量为 $v_{pump}$，界限为 $0 \\le v_{pump} \\le U_{pump}$。此处，$s$ 是每消耗一单位还原当量所泵出的质子数。\n- ATP合酶：$R_{ATP}: \\ p \\ H_p \\rightarrow \\emptyset$，通量为 $v_{ATP}$，界限为 $0 \\le v_{ATP} < \\infty$。此处，$p$ 是每合成一个ATP所需的质子数，而 $v_{ATP}$ 直接等于ATP的生产速率。\n- 质子渗漏：$R_{leak}: \\ H_p \\rightarrow \\emptyset$，通量 $v_{leak}$ 固定为一个指定的常数 $L$（即 $v_{leak} = L$）。这模拟了消耗质子动势的被动质子扩散。\n\n设决策变量向量为 $v = [v_{in}, v_{pump}, v_{ATP}, v_{leak}, v_{sink}]^\\top$，其中 $v_{sink} \\ge 0$ 允许任何未使用的还原当量被消耗掉（$Red \\rightarrow \\emptyset$），以满足 $Red$ 的平衡。$Red$ 和 $H_p$ 的稳态质量平衡方程为：\n- $Red$：$v_{in} - v_{pump} - v_{sink} = 0$。\n- $H_p$：$s \\ v_{pump} - p \\ v_{ATP} - v_{leak} = 0$。\n\n所有通量的单位均为毫摩尔每克干重每小时，即 $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{h}^{-1}$。所有参数 $R_{max}$、$U_{pump}$、$s$、$p$、$L$ 均为非负实数，其含义如下：\n- $R_{max}$：还原当量供应 $v_{in}$ 的上界。\n- $U_{pump}$：电子传递链泵送通量 $v_{pump}$ 的上界。\n- $s$：每消耗一单位 $Red$ 所泵出的质子数。\n- $p$：每合成一个ATP所消耗的质子数。\n- $L$：固定的质子渗漏通量 $v_{leak}$。\n\n任务：对于下面的每一组参数，计算满足上述约束条件的最大可行ATP生产速率 $v_{ATP}^\\star$。如果不存在稳态解（即约束条件不可行），则返回 $-1.0$。\n\n您必须仅使用所述模型、稳态平衡方程和界限。将每个结果表示为单位为 $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{h}^{-1}$ 的实数，并四舍五入到六位小数。\n\n测试集（每个案例为 $(R_{max}, U_{pump}, s, p, L)$）：\n1. $(10, 8, 10, 4, 0)$\n2. $(10, 8, 10, 4, 10)$\n3. $(10, 8, 10, 4, 85)$\n4. $(5, 100, 10, 4, 10)$\n5. $(12, 12, 10, 3.67, 0)$\n\n最终输出格式：您的程序应生成单行输出，其中包含五个结果，以逗号分隔，并用方括号括起来，例如 $[x_1,x_2,x_3,x_4,x_5]$，其中每个 $x_i$ 均按要求四舍五入到六位小数。", "solution": "所提出的问题是一个约束优化任务，可以形式化为一个线性规划问题。目标是在一个简化的代谢模型中，根据一组化学计量和容量约束，确定三磷酸腺苷的最大生产速率 $v_{ATP}$。\n\n该系统由以下变量和约束定义：\n\n**决策变量：** 通量向量为 $v = [v_{in}, v_{pump}, v_{ATP}, v_{leak}, v_{sink}]^\\top$。\n\n**稳态质量平衡：**\n1. 对于还原当量, $Red$：$v_{in} - v_{pump} - v_{sink} = 0$。\n2. 对于质子, $H_p$：$s \\cdot v_{pump} - p \\cdot v_{ATP} - v_{leak} = 0$。\n\n**通量界限和条件：**\n3. $0 \\le v_{in} \\le R_{max}$\n4. $0 \\le v_{pump} \\le U_{pump}$\n5. $0 \\le v_{ATP} < \\infty$\n6. $v_{leak} = L$\n7. $v_{sink} \\ge 0$\n\n任务是最大化目标函数 $f(v) = v_{ATP}$。\n\n我们将通过简化约束系统来解析地解决此问题。\n\n从平衡(1)和约束(7)，我们推导出 $v_{sink} = v_{in} - v_{pump} \\ge 0$，这意味着一个重要的耦合关系：$v_{in} \\ge v_{pump}$。将其与约束(3)结合，我们发现 $v_{pump} \\le v_{in} \\le R_{max}$，这确立了泵送通量的一个上界：$v_{pump} \\le R_{max}$。\n\n从平衡(2)和条件(6)，我们将 $v_{ATP}$ 表示为 $v_{pump}$ 的函数：\n$p \\cdot v_{ATP} = s \\cdot v_{pump} - v_{leak} = s \\cdot v_{pump} - L$。\n对于一个物理上有意义的问题，其中ATP合成需要质子动势，参数 $p$（每个ATP所需的质子数）必须严格为正，即 $p > 0$。所提供的所有测试案例都满足此条件。在此必要假设下，我们可以写出：\n$$v_{ATP} = \\frac{s \\cdot v_{pump} - L}{p}$$\n\n目标是最大化 $v_{ATP}$。由于参数 $s$ 和 $p$ 是正常数，最大化 $v_{ATP}$ 等价于最大化通量 $v_{pump}$。因此，问题简化为寻找 $v_{pump}$ 的最大可行值。\n\n让我们整合所有关于 $v_{pump}$ 的约束：\na. 根据约束(4)，$0 \\le v_{pump} \\le U_{pump}$。\nb. 根据从约束(1)、(3)和(7)的推导，$v_{pump} \\le R_{max}$。\nc. 根据约束(5)，$v_{ATP} \\ge 0$，这意味着 $\\frac{s \\cdot v_{pump} - L}{p} \\ge 0$。当 $p>0$ 且 $s>0$（对于一个功能正常的泵来说就是这种情况）时，该式可简化为 $s \\cdot v_{pump} - L \\ge 0$，或 $v_{pump} \\ge \\frac{L}{s}$。\n\n综合这些，$v_{pump}$ 的可行范围是：\n$$ \\frac{L}{s} \\le v_{pump} \\le \\min(U_{pump}, R_{max}) $$\n\n要使一个可行的稳态解存在，这个区间必须非空。这要求下界小于或等于上界：\n$$ \\frac{L}{s} \\le \\min(U_{pump}, R_{max}) $$\n\n如果此条件不满足，则约束条件相互矛盾，导致系统不可行。在这种情况下，不存在稳态解，指定的输出为 $-1.0$。\n\n如果条件得到满足，则存在一组可行的通量。为了最大化 $v_{pump}$（并因此最大化 $v_{ATP}$），我们必须从其可行范围中选择最大值。设此最优通量为 $v_{pump}^\\star$：\n$$ v_{pump}^\\star = \\min(U_{pump}, R_{max}) $$\n该值代表通过质子泵的有效最大通量，其瓶颈在于还原当量的可用性（受 $R_{max}$ 限制）或泵本身的内在容量（受 $U_{pump}$ 限制）。\n\n然后，将 $v_{pump}^\\star$ 代入推导出的 $v_{ATP}$ 表达式中，即可计算出最大ATP生产速率 $v_{ATP}^\\star$：\n$$ v_{ATP}^\\star = \\frac{s \\cdot v_{pump}^\\star - L}{p} = \\frac{s \\cdot \\min(U_{pump}, R_{max}) - L}{p} $$\n这个最终表达式为计算每组参数所需的值提供了一种直接方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum feasible ATP production rate for a series of metabolic models.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (R_max, U_pump, s, p, L)\n    test_cases = [\n        (10, 8, 10, 4, 0),\n        (10, 8, 10, 4, 10),\n        (10, 8, 10, 4, 85),\n        (5, 100, 10, 4, 10),\n        (12, 12, 10, 3.67, 0),\n    ]\n\n    results = []\n    for case in test_cases:\n        R_max, U_pump, s, p, L = case\n\n        # The maximum possible flux through the pump is limited by the supply of\n        # reducing equivalents (R_max) and the pump's own capacity (U_pump).\n        v_pump_effective_max = min(R_max, U_pump)\n\n        # For ATP synthesis to be non-negative (v_ATP >= 0), the proton pumping\n        # rate must be sufficient to overcome the passive proton leak (L).\n        # The condition is s * v_pump - L >= 0.\n        # This gives a minimum required v_pump.\n        # We must handle the case s=0 to avoid division by zero.\n        # If s=0 and L>0, the condition can never be met, so it's infeasible.\n        # If s=0 and L=0, the condition becomes 0 >= 0, and v_pump_min_req is 0.\n        if s == 0:\n            if L > 0:\n                # Infeasible if pump doesn't work but there is a leak\n                v_pump_min_req = float('inf')\n            else:\n                # No leak, no pumping needed to overcome it\n                v_pump_min_req = 0.0\n        else:\n            v_pump_min_req = L / s\n\n        # A steady-state solution is feasible only if the maximum possible pump flux\n        # is greater than or equal to the minimum required pump flux.\n        if v_pump_effective_max >= v_pump_min_req:\n            # If feasible, we maximize v_ATP by maximizing v_pump.\n            # The optimal v_pump is its effective maximum value.\n            v_pump_star = v_pump_effective_max\n            \n            # The parameter p must be > 0 for ATP synthesis to be well-defined.\n            # The problem context and test cases imply p > 0.\n            if p > 0:\n                v_atp_star = (s * v_pump_star - L) / p\n            else:\n                # If p=0, ATP can be produced 'for free'.\n                # If s*v_pump_star - L == 0, v_ATP is not constrained.\n                # If s*v_pump_star - L != 0, it's a contradiction.\n                # This case represents a poorly defined model, but we can treat v_ATP as 0\n                # or infeasible. Problem statement implies p > 0.\n                v_atp_star = -1.0 # Fallback for malformed problem not in tests.\n            \n            results.append(v_atp_star)\n        else:\n            # If the constraints cannot be simultaneously satisfied, the system is infeasible.\n            results.append(-1.0)\n    \n    # Format results to six decimal places as specified.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2404803"}]}