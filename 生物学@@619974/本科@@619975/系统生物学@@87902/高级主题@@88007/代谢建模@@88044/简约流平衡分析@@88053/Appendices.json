{"hands_on_practices": [{"introduction": "第一个练习将带你探讨细胞面临的一个基本问题：当有多条路径可以合成同一种产物时，细胞会如何选择？通过这个简化的网络模型[@problem_id:1456653]，我们将运用简约通量平衡分析（pFBA）来揭示细胞如何在其首要目标（最大化生长）达成后，通过最小化总代谢通量来选择最高效的路线。这个练习旨在巩固 pFBA 的两步优化核心思想。", "problem": "正在研究一种假设的微生物，以探究其生产有价值生物质前体的潜力。其简化的核心代谢可由以下一系列不可逆反应来描述，其中 $S_{ext}$ 是外部底物，A、B 和 C 是内部代谢物：\n- 反应 1 ($R_1$): 底物摄取, $S_{ext} \\xrightarrow{v_1} A$\n- 反应 2 ($R_2$): 直接转化, $A \\xrightarrow{v_2} B$\n- 反应 3 ($R_3$): 替代途径起始, $A \\xrightarrow{v_3} C$\n- 反应 4 ($R_4$): 替代途径末端, $C \\xrightarrow{v_4} B$\n- 反应 5 ($R_5$): 生物质生产, $B \\xrightarrow{v_5} \\text{Biomass}$\n\n该生物体在稳态下运行。底物 $S_{ext}$ 的摄取是有限的，其通量 $v_1$ 不能超过 $10.0$ mmol gDW$^{-1}$ h$^{-1}$。所有内部反应也都是不可逆的，意味着它们的通量不能为负。\n\n您的任务是应用简约通量平衡分析 (Parsimonious Flux Balance Analysis, pFBA)，该方法首先最大化一个生物学目标，然后找到实现该最大值所需的最有效通量分布。请确定唯一的稳态通量分布向量 $(v_1, v_2, v_3, v_4, v_5)$，该向量既能最大化生物质生产速率 ($v_5$)，又能最小化实现此最大值所需的总代谢通量之和。\n\n请以行向量 $(v_1, v_2, v_3, v_4, v_5)$ 的形式表示您的答案，包含五个通量的数值，单位为 mmol gDW$^{-1}$ h$^{-1}$。", "solution": "设通量为 $v_{1},\\dots,v_{5}$，均为不可逆反应，因此对所有 $i$ 都有 $v_{i}\\geq 0$，且摄取上限为 $v_{1}\\leq 10$。在稳态下，内部代谢物满足质量平衡：\n- 对 $A$：$v_{1}-v_{2}-v_{3}=0$。\n- 对 $C$：$v_{3}-v_{4}=0$。\n- 对 $B$：$v_{2}+v_{4}-v_{5}=0$。\n\n首先，最大化生物学目标 $v_{5}$。从平衡方程中消去 $v_{2},v_{4}$：\n$$\nv_{2}=v_{1}-v_{3},\\quad v_{4}=v_{3},\\quad v_{5}=v_{2}+v_{4}=(v_{1}-v_{3})+v_{3}=v_{1}.\n$$\n因此 $v_{5}=v_{1}$。由于 $0\\leq v_{1}\\leq 10$，在 $v_{1}=10$ 时达到最大值，得到 $v_{5}^{\\max}=10$。\n\n第二步，施加约束 $v_{5}=10$，并在相同的约束条件下（简约FBA）最小化总通量 $T=\\sum_{i=1}^{5}v_{i}$。已知 $v_{1}=10$, $v_{5}=10$, 且 $v_{2}=10-v_{3}$, $v_{4}=v_{3}$，计算\n$$\nT=v_{1}+v_{2}+v_{3}+v_{4}+v_{5}=10+(10-v_{3})+v_{3}+v_{3}+10=30+v_{3}.\n$$\n由于 $v_{3}\\geq 0$，$T$ 的最小值在 $v_{3}=0$ 时取得，得出\n$$\nv_{3}^{*}=0,\\quad v_{2}^{*}=10,\\quad v_{4}^{*}=0,\\quad v_{1}^{*}=10,\\quad v_{5}^{*}=10.\n$$\n该解是唯一的，因为在可行集上，$T=30+v_{3}$ 是关于 $v_{3}$ 的一个严格单调递增函数。\n\n因此，唯一的 pFBA 通量向量是 $(v_{1},v_{2},v_{3},v_{4},v_{5})=(10,10,0,0,10)$。", "answer": "$$\\boxed{\\begin{pmatrix}10 & 10 & 0 & 0 & 10\\end{pmatrix}}$$", "id": "1456653"}, {"introduction": "真实的代谢网络远比上一个例子复杂，它们包含可逆反应和内部循环，这为细胞提供了代谢灵活性。这个练习[@problem_id:1456660]将通过一个包含可逆反应的更复杂网络，让你深入理解 pFBA 如何在这种冗余中挑选出唯一的“简约”解。你将亲手计算并体会到，最小化总通量的原则是如何帮助我们预测细胞对酶资源的最经济利用方式。", "problem": "一位系统生物学家正在研究一种名为 *Metabolicus efficiens* 的新细菌的中心代谢。该生物体的主要目标是最大化其生长速率，该速率与关键生物质前体 P 的生产速率成正比。其次要目标，这是一个细胞经济性原则，即以尽可能小的总代谢成本实现此最大生长。该成本可以通过最小化所有代谢通量绝对值之和来建模。这种两步优化过程被称为简约通量平衡分析 (pFBA)。\n\n简化的代谢网络在伪稳态下运行，由以下反应描述。所有通量 $v_i$ 的单位均为 mmol/gDW/h。\n\n*   $v_S$：底物摄取，$S_{ext} \\rightarrow S$。底物摄取受限，满足 $0 \\le v_S \\le 10$。\n*   $v_1$：$S \\rightarrow 2A$ (不可逆)\n*   $v_2$：$A \\rightarrow P$ (不可逆)\n*   $v_3$：$S \\rightarrow B$ (不可逆)\n*   $v_4$：$B \\rightarrow P$ (不可逆)\n*   $v_5$：$A \\leftrightarrow B$ (可逆)\n*   $v_{bio}$：生物质生产，$P \\rightarrow \\text{Biomass}$ (不可逆)\n\n通量 $v_{bio}$ 代表生长速率，是需要最大化的主要目标。中间代谢物为 S、A、B 和 P。\n\n首先，确定最大可能的生物质生产速率 $v_{bio, max}$。然后，找出在达到该最大速率的同时，也最小化所有通量绝对值总和 $\\sum_{i} |v_i|$ 的特定通量分布，其中总和涵盖网络中的所有反应 ($v_S, v_1, v_2, v_3, v_4, v_5, v_{bio}$)。\n\n计算这个最小的通量绝对值总和。以 mmol/gDW/h 为单位表示您的答案。", "solution": "设通量为 $v_{S}, v_{1}, v_{2}, v_{3}, v_{4}, v_{5}, v_{bio}$，其约束条件为 $0 \\leq v_{S} \\leq 10$，$v_{1}, v_{2}, v_{3}, v_{4}, v_{bio} \\geq 0$ 和 $v_{5} \\in \\mathbb{R}$。内部代谢物 $S, A, B, P$ 的伪稳态施加了以下平衡方程：\n$$\n\\text{S:}\\quad v_{S} - v_{1} - v_{3} = 0,\n$$\n$$\n\\text{A:}\\quad 2 v_{1} - v_{2} - v_{5} = 0 \\;\\Rightarrow\\; v_{2} = 2 v_{1} - v_{5},\n$$\n$$\n\\text{B:}\\quad v_{3} + v_{5} - v_{4} = 0 \\;\\Rightarrow\\; v_{4} = v_{3} + v_{5},\n$$\n$$\n\\text{P:}\\quad v_{2} + v_{4} - v_{bio} = 0 \\;\\Rightarrow\\; v_{bio} = v_{2} + v_{4}.\n$$\n\n主要目标 (最大化 $v_{bio}$): 将 $v_{2}$ 和 $v_{4}$ 代入 P 的平衡方程：\n$$\nv_{bio} = (2 v_{1} - v_{5}) + (v_{3} + v_{5}) = 2 v_{1} + v_{3}.\n$$\n根据 S 的平衡方程，$v_{S} = v_{1} + v_{3}$。对于固定的 $v_{S}$，\n$$\nv_{bio} = 2 v_{1} + v_{3} = (v_{1} + v_{3}) + v_{1} = v_{S} + v_{1},\n$$\n为使其最大化，取 $v_{1} = v_{S}$ 和 $v_{3} = 0$ (需满足 $v_{1}, v_{3} \\geq 0$)。由于 $v_{S} \\leq 10$，最大摄取率为 $v_{S} = 10$，得到\n$$\nv_{1} = 10,\\quad v_{3} = 0,\\quad v_{bio, \\max} = 2 v_{1} + v_{3} = 20.\n$$\n\n次要目标 (在 $v_{bio} = 20$ 的条件下最小化 $\\sum_{i} |v_{i}|$): 当 $v_{1} = 10$，$v_{3} = 0$ 时，使用 A 和 B 的平衡方程得到\n$$\nv_{2} = 2 v_{1} - v_{5} = 20 - v_{5},\\quad v_{4} = v_{3} + v_{5} = v_{5}.\n$$\n不可逆性要求 $v_{2} \\geq 0$ 和 $v_{4} \\geq 0$，因此 $0 \\leq v_{5} \\leq 20$。同时，$v_{bio} = v_{2} + v_{4} = 20$ 自动成立。\n\n通量绝对值总和为\n$$\nJ(v_{5}) = |v_{S}| + |v_{1}| + |v_{2}| + |v_{3}| + |v_{4}| + |v_{5}| + |v_{bio}|.\n$$\n对于 $0 \\leq v_{5} \\leq 20$，所有这些通量都是非负的，所以可以去掉绝对值符号：\n$$\nJ(v_{5}) = 10 + 10 + (20 - v_{5}) + 0 + v_{5} + v_{5} + 20 = 60 + v_{5}.\n$$\n当 $v_{5} = 0$ 时，该式取得最小值，为\n$$\nJ_{\\min} = 60.\n$$\n相应的简约通量分布为 $v_{S} = 10$，$v_{1} = 10$，$v_{2} = 20$，$v_{3} = 0$，$v_{4} = 0$，$v_{5} = 0$，$v_{bio} = 20$，最小的通量绝对值总和为 $60$ mmol/gDW/h。", "answer": "$$\\boxed{60}$$", "id": "1456660"}, {"introduction": "除了计算特定条件下的最优通量分布，pFBA 更是一个强大的预测工具，能帮助我们推断细胞将如何适应环境变化。这个思想实验[@problem_id:1456664]将挑战你从计算转向概念推理，定性地分析当关键营养物质受限时，细胞的生长速率和整体代谢投入会发生怎样的变化。这个练习将培养你利用模型进行科学预测和系统性思考的能力。", "problem": "一位系统生物学家正在使用计算模型来研究一种假设细菌的代谢。该模型基于简约通量平衡分析（pFBA）的原理，这是一个用于预测细胞内代谢反应速率（通量）的优化框架。pFBA过程包括两个连续的优化阶段：\n\n1.  **阶段1（生物量最大化）：** 执行标准的通量平衡分析（FBA），以找到生物质生产的最大可能速率（“生长速率”），这被视为细胞的主要目标。这一过程是在遵守所有化学计量和热力学约束（包括环境中营养物质的最大摄取速率）的前提下完成的。设此阶段的结果为最优生物量通量 $Z_{opt}$。\n\n2.  **阶段2（通量最小化）：** 将生物质生产速率固定为阶段1中找到的最优值 $Z_{opt}$。然后，执行第二次优化，以找到一个满足此生长速率的通量分布，同时最小化网络中所有反应通量的绝对值之和。这个“简约”解代表了在给定最优生长速率下的最大代谢效率状态。\n\n生物学家的初始模拟是在一个以葡萄糖为主要碳源的生长培养基中进行的，该培养基具有定义的最大摄取通量。然后，生物学家决定通过降低葡萄糖摄取通量的上限来模拟一个胁迫条件，这实际上是模拟一个营养更贫乏的环境。模型的所有其他参数保持不变。\n\n假设在初始模拟中，葡萄糖摄取是生长的限制因素，那么这一变化对pFBA模拟的两个关键输出会产生什么预期的定性影响？\n\nA. 最优生物量通量将减少，最小化的总通量之和将减少。\n\nB. 最优生物量通量将减少，最小化的总通量之和将增加。\n\nC. 最优生物量通量将减少，最小化的总通量之和将保持不变。\n\nD. 最优生物量通量将保持不变，最小化的总通量之和将减少。\n\nE. 最优生物量通量将保持不变，最小化的总通量之和将保持不变。\n\nF. 最优生物量通量将增加，最小化的总通量之和将增加。", "solution": "设代谢网络由稳态约束 $S v = 0$ 表示，通量边界为 $l \\leq v \\leq u$，生物质生产通量由 $Z = c^{\\top} v$ 给出。用 $v_{\\text{glc}}$ 表示葡萄糖摄取通量，其上限为 $u_{\\text{glc}}$。\n\n阶段1 (FBA) 求解\n$$\n\\max_{v}\\; c^{\\top} v \\quad \\text{subject to} \\quad S v = 0,\\quad l \\leq v \\leq u.\n$$\n如果葡萄糖摄取在初始最优点是限制性的，则约束 $v_{\\text{glc}} \\leq u_{\\text{glc}}$ 在最优点是激活的，即 $v_{\\text{glc}} = u_{\\text{glc}}$，并且最优生物量通量满足\n$$\nZ_{\\text{opt}} = c^{\\top} v^{\\star}, \\quad v^{\\star}_{\\text{glc}} = u_{\\text{glc}}.\n$$\n现在将葡萄糖上限降低到一个更小的值 $u_{\\text{glc}}' < u_{\\text{glc}}$，所有其他约束保持不变。这严格地缩小了可行域：\n$$\n\\{v: S v = 0,\\; l \\leq v \\leq u,\\; v_{\\text{glc}} \\leq u_{\\text{glc}}'\\} \\subset \\{v: S v = 0,\\; l \\leq v \\leq u,\\; v_{\\text{glc}} \\leq u_{\\text{glc}}\\}.\n$$\n由于目标是在一个更小的可行集上进行最大化，新的最优生物量通量是非增的。因为 $v_{\\text{glc}}$ 是有约束性和限制性的， $u_{\\text{glc}}$ 的减少在新最优点是激活的，所以可行集的减小移除了之前的最大化点，这意味着严格的减少：\n$$\nZ_{\\text{opt}}' < Z_{\\text{opt}}.\n$$\n\n阶段2 (pFBA) 接着固定 $c^{\\top} v = Z_{\\text{opt}}'$ 并最小化总通量大小。一个标准的线性规划形式是最小化 $\\sum_{i} (v_{i}^{+} + v_{i}^{-})$，其中 $v = v^{+} - v^{-}$ 且 $v^{+}, v^{-} \\geq 0$，但为了推理，考虑 $\\sum_{i} |v_{i}|$ 就足够了：\n$$\n\\min_{v}\\; \\sum_{i} |v_{i}| \\quad \\text{subject to} \\quad S v = 0,\\; l \\leq v \\leq u',\\; c^{\\top} v = Z_{\\text{opt}}',\n$$\n其中 $u'$ 与 $u$ 的区别仅在于 $u_{\\text{glc}}' < u_{\\text{glc}}$。\n\n设 $v^{\\text{pfba}}$ 为在原始设置下，生物量为 $Z_{\\text{opt}}$ 且葡萄糖边界为 $u_{\\text{glc}}$ 时的 pFBA 解。定义缩放因子\n$$\n\\alpha \\equiv \\frac{Z_{\\text{opt}}'}{Z_{\\text{opt}}}.\n$$\n在葡萄糖限制、网络和产率不变的情况下，$\\alpha \\in (0,1)$ 且 $v' \\equiv \\alpha v^{\\text{pfba}}$ 满足：\n- 稳态：$S v' = S(\\alpha v^{\\text{pfba}}) = \\alpha S v^{\\text{pfba}} = 0$。\n- 边界：对于任何具有边界 $l_{i} \\leq v_{i} \\leq u_{i}$ 的分量，乘以 $\\alpha \\in (0,1)$ 保持了可行性，因为 $v^{\\text{pfba}}$ 是可行的，并且对于可逆通量 $l_{i} \\leq 0 \\leq u_{i}$，对于不可逆通量 $0 \\leq l_{i} \\leq v_{i}^{\\text{pfba}} \\leq u_{i}$ 意味着 $0 \\leq \\alpha v_{i}^{\\text{pfba}} \\leq v_{i}^{\\text{pfba}} \\leq u_{i}$。具体对于葡萄糖， $(v')_{\\text{glc}} = \\alpha v^{\\text{pfba}}_{\\text{glc}} = \\alpha u_{\\text{glc}} \\leq u_{\\text{glc}}'$，这是根据在葡萄糖限制下 $Z_{\\text{opt}}'$ 的构造得出的。\n- 生物量：$c^{\\top} v' = \\alpha c^{\\top} v^{\\text{pfba}} = \\alpha Z_{\\text{opt}} = Z_{\\text{opt}}'$。\n\n因此，$v'$ 对于新的阶段2问题是可行的，其目标值为\n$$\n\\sum_{i} |v'_{i}| = \\sum_{i} |\\alpha v^{\\text{pfba}}_{i}| = \\alpha \\sum_{i} |v^{\\text{pfba}}_{i}|.\n$$\n由于 $\\alpha \\in (0,1)$，这提供了一个可行解，其总通量和严格小于之前的值。因为 pFBA 最小化这个和，新的最小化和不能超过这个可行值，因此相对于原始的最小化和也必须严格减少。\n\n因此：\n- 最优生物量通量减少。\n- 最小化的总通量之和减少。\n\n这对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1456664"}]}