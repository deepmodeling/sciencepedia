{"hands_on_practices": [{"introduction": "为了量化地评估网络划分的优劣，我们使用一个称为模块度（modularity）的指标，记为 $Q$。一个较高的 $Q$ 值意味着一个更强的社区结构。本练习将让你亲手计算同一个蛋白质相互作用网络的两种不同划分方案的模块度，从而判断哪种划分更能体现其内在的模块化特征。[@problem_id:1452201]", "problem": "在系统生物学中，网络常被用来模拟生物实体之间的相互作用。一种常见的类型是蛋白质-蛋白质相互作用（PPI）网络，其中节点代表蛋白质，边代表它们之间的物理相互作用。一项关键任务是识别这些网络中的“社区”或“模块”，它们通常对应于蛋白质复合物或功能通路。特定社区结构或划分的质量可以用一个称为模块度的指标来量化，记为 $Q$。较高的模块度得分表示一个更好的划分，其中社区内部的连接密集，而社区之间的连接稀疏。\n\n考虑一个由8种蛋白质（标记为P1到P8）组成的小型PPI网络。相互作用（边）如下：\n(P1, P2), (P1, P3), (P2, P3), (P2, P4), (P3, P4), (P4, P5), (P5, P6), (P5, P7), (P6, P7), (P6, P8), (P7, P8)。\n\n两个相互竞争的假设提出了将该网络划分为两个功能模块的不同方法。\n- **划分A**：社区1 = {P1, P2, P3, P4}，社区2 = {P5, P6, P7, P8}\n- **划分B**：社区1 = {P1, P2, P3}，社区2 = {P4, P5, P6, P7, P8}\n\n给定划分的模块度 $Q$ 使用以下公式计算：\n$$Q = \\sum_{c=1}^{N_c} \\left[ \\frac{L_c}{m} - \\left( \\frac{D_c}{2m} \\right)^2 \\right]$$\n其中：\n- $N_c$ 是社区的总数。\n- $m$ 是网络中边的总数。\n- $L_c$ 是两端都在社区 $c$ 内部的边的数量。\n- $D_c$ 是社区 $c$ 中所有节点的度之和。（节点的度是连接到该节点的边的数量）。\n\n计算划分A的模块度得分 $Q_A$ 和划分B的模块度得分 $Q_B$。下列哪个选项正确报告了这些值？\n\nA. $Q_A = \\frac{9}{22}$, $Q_B = \\frac{34}{121}$\n\nB. $Q_A = \\frac{34}{121}$, $Q_B = \\frac{9}{22}$\n\nC. $Q_A = \\frac{7}{22}$, $Q_B = \\frac{23}{121}$\n\nD. $Q_A = \\frac{45}{121}$, $Q_B = \\frac{34}{121}$\n\nE. $Q_A = \\frac{9}{22}$, $Q_B = \\frac{9}{22}$", "solution": "我们列举网络并精确计算模块度。\n\n该网络有如下边\n(P1,P2), (P1,P3), (P2,P3), (P2,P4), (P3,P4), (P4,P5), (P5,P6), (P5,P7), (P6,P7), (P6,P8), (P7,P8),\n所以边的总数是 $m=11$。\n\n节点度为：\n$\\deg(P1)=2$, $\\deg(P2)=3$, $\\deg(P3)=3$, $\\deg(P4)=3$, $\\deg(P5)=3$, $\\deg(P6)=3$, $\\deg(P7)=3$, $\\deg(P8)=2$,\n其总和为 $22=2m$，这验证了 $m=11$。\n\n一个划分的模块度为\n$$\nQ=\\sum_{c=1}^{N_{c}}\\left[\\frac{L_{c}}{m}-\\left(\\frac{D_{c}}{2m}\\right)^{2}\\right],\n$$\n其中 $L_{c}$ 是社区 $c$ 内部的边的数量，而 $D_{c}$ 是社区 $c$ 中节点的度之和。\n\n划分A：社区1 $=\\{P1,P2,P3,P4\\}$，社区2 $=\\{P5,P6,P7,P8\\}$。\n- 对于社区1，内部边为 $(P1,P2),(P1,P3),(P2,P3),(P2,P4),(P3,P4)$，因此 $L_{1}=5$。度之和为 $D_{1}=\\deg(P1)+\\deg(P2)+\\deg(P3)+\\deg(P4)=2+3+3+3=11$。\n- 对于社区2，内部边为 $(P5,P6),(P5,P7),(P6,P7),(P6,P8),(P7,P8)$，因此 $L_{2}=5$。度之和为 $D_{2}=\\deg(P5)+\\deg(P6)+\\deg(P7)+\\deg(P8)=3+3+3+2=11$。\n\n因此，\n$$\nQ_{A}=\\left[\\frac{5}{11}-\\left(\\frac{11}{22}\\right)^{2}\\right]+\\left[\\frac{5}{11}-\\left(\\frac{11}{22}\\right)^{2}\\right]\n=2\\left[\\frac{5}{11}-\\frac{1}{4}\\right]\n=2\\left[\\frac{20}{44}-\\frac{11}{44}\\right]\n=2\\cdot\\frac{9}{44}\n=\\frac{9}{22}.\n$$\n\n划分B：社区1 $=\\{P1,P2,P3\\}$，社区2 $=\\{P4,P5,P6,P7,P8\\}$。\n- 对于社区1，内部边为 $(P1,P2),(P1,P3),(P2,P3)$，因此 $L_{1}=3$。度之和为 $D_{1}=\\deg(P1)+\\deg(P2)+\\deg(P3)=2+3+3=8$。\n- 对于社区2，内部边为 $(P4,P5),(P5,P6),(P5,P7),(P6,P7),(P6,P8),(P7,P8)$，因此 $L_{2}=6$。度之和为 $D_{2}=\\deg(P4)+\\deg(P5)+\\deg(P6)+\\deg(P7)+\\deg(P8)=3+3+3+3+2=14$。\n\n因此，\n$$\nQ_{B}=\\left[\\frac{3}{11}-\\left(\\frac{8}{22}\\right)^{2}\\right]+\\left[\\frac{6}{11}-\\left(\\frac{14}{22}\\right)^{2}\\right]\n=\\left[\\frac{3}{11}-\\frac{16}{121}\\right]+\\left[\\frac{6}{11}-\\frac{49}{121}\\right]\n=\\left[\\frac{33}{121}-\\frac{16}{121}\\right]+\\left[\\frac{66}{121}-\\frac{49}{121}\\right]\n=\\frac{17}{121}+\\frac{17}{121}\n=\\frac{34}{121}.\n$$\n\n与选项比较，$Q_{A}=\\frac{9}{22}$ 和 $Q_{B}=\\frac{34}{121}$ 对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1452201"}, {"introduction": "当网络被划分为社区后，我们可以进一步分析单个节点的特定角色。一些节点主要在其自身社区内发挥核心作用，而另一些则充当着连接不同社区的关键桥梁。本练习将介绍参与系数（participation coefficient）$P_i$ 这一指标，它被用来对节点进行分类，并要求你判断一个关键的“枢纽”蛋白主要在其模块内部发挥作用，还是作为连接不同模块的连接者。[@problem_id:1452179]", "problem": "在系统生物学中，细胞功能通常由相互作用的蛋白质群执行，这些蛋白质群可以被建模为蛋白质-蛋白质相互作用（PPI）网络。这些网络通常表现出模块化结构，其中连接紧密的蛋白质形成执行特定生物学功能的社群或模块。蛋白质的作用可以通过其连接模式来表征。\n\n考虑一个由10种蛋白质组成的小型假想PPI网络：P1, P2, P3, P4, P5, P6, P7, P8, P9 和 P10。一项分析已将该网络划分为两个不同的功能模块：\n-   模块A：{P1, P2, P3, P4, P5}\n-   模块B：{P6, P7, P8, P9, P10}\n\n观测到的相互作用被认为是无向的，如下所示：\n-   P1 与 P2, P3, P4, P6, P7 相互作用。\n-   P2 与 P3, P5 相互作用。\n-   P3 与 P4 相互作用。\n-   P4 与 P5 相互作用。\n-   P6 与 P7, P10 相互作用。\n-   P7 与 P8 相互作用。\n-   P8 与 P9 相互作用。\n-   P9 与 P10 相互作用。\n\n为了量化一个蛋白质是主要在其自身模块内相互作用，还是作为不同模块之间的桥梁，可以计算其*参与系数* $P_i$。蛋白质 $i$ 的参与系数由以下公式定义：\n$$P_i = 1 - \\sum_{s=1}^{N_M} \\left( \\frac{k_{is}}{k_i} \\right)^2$$\n其中 $k_i$ 是蛋白质 $i$ 的总相互作用数（其度），$N_M$ 是网络中模块的总数，而 $k_{is}$ 是蛋白质 $i$ 与模块 $s$ 中蛋白质的相互作用数。\n\n蛋白质P1因其相对较高的连接数而成为一个枢纽。为了确定它是一个“省内”枢纽（主要在其自身模块内相互作用）还是一个“连接者”枢纽（连接不同模块），请计算蛋白质P1的参与系数。\n\n请以保留三位有效数字的小数形式提供您的答案。", "solution": "我们有两个模块，因此设 $N_{M}=2$，模块 $A=\\{P1,P2,P3,P4,P5\\}$ 和模块 $B=\\{P6,P7,P8,P9,P10\\}$。对于蛋白质 $P1$，观测到的相互作用对象是 $P2,P3,P4,P6,P7$，因此其总度为\n$$k_{1}=5.$$\n与模块 $A$ 内的相互作用对象是 $P2,P3,P4$，所以\n$$k_{1A}=3,$$\n与模块 $B$ 的相互作用对象是 $P6,P7$，所以\n$$k_{1B}=2.$$\n使用参与系数的定义\n$$P_{1}=1-\\sum_{s=1}^{N_{M}}\\left(\\frac{k_{1s}}{k_{1}}\\right)^{2}=1-\\left[\\left(\\frac{k_{1A}}{k_{1}}\\right)^{2}+\\left(\\frac{k_{1B}}{k_{1}}\\right)^{2}\\right],$$\n我们代入数值得到\n$$P_{1}=1-\\left[\\left(\\frac{3}{5}\\right)^{2}+\\left(\\frac{2}{5}\\right)^{2}\\right]=1-\\left(\\frac{9}{25}+\\frac{4}{25}\\right)=1-\\frac{13}{25}=\\frac{12}{25}.$$\n转换为小数并保留三位有效数字，得到 $0.480$。", "answer": "$$\\boxed{0.480}$$", "id": "1452179"}, {"introduction": "此前我们评估了已知的社区划分，但我们如何从零开始发现这些社区呢？一种强大的方法是 Girvan-Newman 算法，它依赖于识别并移除连接社区的“桥梁”边。本练习将探讨该算法的核心概念——边介数中心性（edge betweenness centrality）$C_B(e)$，并介绍一种在大型生物网络中应用此思想的实用近似方法。[@problem_id:1452189]", "problem": "在系统生物学中，识别大型生物网络中的关键功能模块是一项基本任务。一种常见的社区检测方法是 Girvan-Newman 算法，该算法通过迭代地移除具有最高“边介数中心性”的边来将网络分解成社区。对于给定的边 $e$，其介数中心性 $C_B(e)$ 定义为，在所有可能的不同节点对中，经过边 $e$ 的最短路径占所有最短路径的比例之和：\n$$C_B(e) = \\sum_{s \\neq t} \\frac{\\sigma_{st}(e)}{\\sigma_{st}}$$\n其中 $\\sigma_{st}$ 是节点 $s$ 和 $t$ 之间最短路径的总数，而 $\\sigma_{st}(e)$ 是这些最短路径中经过边 $e$ 的数量。\n\n对于非常大的网络，例如一个完整的人类蛋白质-蛋白质相互作用（PPI）网络，精确计算 $C_B(e)$ 在计算上是不可行的。一种实际的替代方法是通过抽样一小部分节点对来估计中心性。本问题将探讨这样一种近似方法。\n\n考虑一个由六个蛋白质组成的小型无权子网络，标记为 A、B、C、D、E 和 F。观察到的相互作用由以下边表示：(A,B), (A,C), (B,D), (C,D), (D,E) 和 (E,F)。\n\n为了估计边介数，我们随机抽取了一组六个源-目标对：{(A, F), (B, F), (C, F), (A, E), (B, C), (D, F)}。\n\n你的任务是计算边 $e = (\\text{D,E})$ 的**抽样边介数**，我们将其定义为*仅*对此特定抽样对集合计算的中心性总和。请以一个数字的形式提供你的答案。", "solution": "给定一个无权无向图，其边为 (A,B), (A,C), (B,D), (C,D), (D,E), (E,F)。对于边 $e$，其边介数中心性定义为\n$$C_{B}(e)=\\sum_{s\\neq t}\\frac{\\sigma_{st}(e)}{\\sigma_{st}},$$\n其中 $\\sigma_{st}$ 是节点 $s$ 和 $t$ 之间的最短路径总数，$\\sigma_{st}(e)$ 是这些最短路径中通过 $e$ 的数量。抽样边介数将此和限制在有序源-目标对的抽样集 $S$ 上。对于给定的样本 $S=\\{(A,F),(B,F),(C,F),(A,E),(B,C),(D,F)\\}$ 和边 $e=(D,E)$，我们计算\n$$C_{B}^{S}(D,E)=\\sum_{(s,t)\\in S}\\frac{\\sigma_{st}(D,E)}{\\sigma_{st}}.$$\n\n由于该图是无权的，最短路径具有最少的边数。我们评估每个抽样对：\n\n对于 $(A,F)$，从 $A$ 到 $F$ 的最短路径长度为 4：即 $A\\to B\\to D\\to E\\to F$ 或 $A\\to C\\to D\\to E\\to F$。因此 $\\sigma_{AF}=2$，两条路径都包含 $(D,E)$，所以 $\\sigma_{AF}(D,E)=2$，得出 $\\frac{\\sigma_{AF}(D,E)}{\\sigma_{AF}}=1$。\n\n对于 $(B,F)$，唯一的最短路径是 $B\\to D\\to E\\to F$，长度为3，所以 $\\sigma_{BF}=1$，并且它包含 $(D,E)$，因此 $\\frac{\\sigma_{BF}(D,E)}{\\sigma_{BF}}=1$。\n\n对于 $(C,F)$，唯一的最短路径是 $C\\to D\\to E\\to F$，所以 $\\sigma_{CF}=1$，并且它包含 $(D,E)$，因此 $\\frac{\\sigma_{CF}(D,E)}{\\sigma_{CF}}=1$。\n\n对于 $(A,E)$，最短路径长度为3：$A\\to B\\to D\\to E$ 和 $A\\to C\\to D\\to E$。因此 $\\sigma_{AE}=2$，两条路径都包含 $(D,E)$，所以 $\\sigma_{AE}(D,E)=2$，得出 $\\frac{\\sigma_{AE}(D,E)}{\\sigma_{AE}}=1$。\n\n对于 $(B,C)$，最短路径长度为2：$B\\to D\\to C$ 和 $B\\to A\\to C$。两条路径都不使用 $(D,E)$，所以 $\\sigma_{BC}=2$ 且 $\\sigma_{BC}(D,E)=0$，得出 $\\frac{\\sigma_{BC}(D,E)}{\\sigma_{BC}}=0$。\n\n对于 $(D,F)$，唯一的最短路径是 $D\\to E\\to F$，所以 $\\sigma_{DF}=1$，并且它包含 $(D,E)$，因此 $\\frac{\\sigma_{DF}(D,E)}{\\sigma_{DF}}=1$。\n\n将这些贡献相加得到\n$$C_{B}^{S}(D,E)=1+1+1+1+0+1=5.$$", "answer": "$$\\boxed{5}$$", "id": "1452189"}]}