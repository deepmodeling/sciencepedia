{"hands_on_practices": [{"introduction": "将生物通路数学化是系统生物学的第一步。此练习将指导你如何将一个简单的信号级联反应转化为它的计算表示——邻接矩阵。通过这个过程，你将亲身体会到无权图如何捕捉相互作用的存在与否，而加权图如何通过引入如磷酸化效率等量化信息来丰富我们的模型 [@problem_id:1477790]。", "problem": "在系统生物学中，蛋白质相互作用网络通常表示为图。考虑一个涉及三种蛋白质P1、P2和P3的简单线性信号级联。在此级联中，蛋白质P1通过磷酸化激活蛋白质P2，随后蛋白质P2也通过磷酸化激活蛋白质P3。这三种蛋白质之间没有其他相互作用，例如自激活或反向激活。\n\n我们可以使用两种不同的图表示来对此系统进行建模：\n\n1.  一个**无权有向图**，其中从蛋白质 $i$ 到蛋白质 $j$ 的边存在，当且仅当 $i$ 激活 $j$。\n2.  一个**加权有向图**，其中从蛋白质 $i$ 到蛋白质 $j$ 的边的权重代表了磷酸化事件的生化效率。P1激活P2的效率为 $0.85$，P2激活P3的效率为 $0.60$。边权重为零意味着没有相互作用。\n\n你的任务是确定这两种表示的邻接矩阵。设无权邻接矩阵为 $A_U$，加权邻接矩阵为 $A_W$。对于这两个矩阵，行和列都应按(P1, P2, P3)的顺序对应于蛋白质。在有向图的邻接矩阵中，第 $i$ 行第 $j$ 列的元素代表从节点 $i$到节点 $j$ 的连接。\n\n以下哪个选项正确地提供了邻接矩阵对 $(A_U, A_W)$？\n\nA. $A_U = \\begin{pmatrix} 0 & 1 & 0 \\\\ 1 & 0 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix}, A_W = \\begin{pmatrix} 0 & 0.85 & 0 \\\\ 0.85 & 0 & 0.60 \\\\ 0 & 0.60 & 0 \\end{pmatrix}$\n\nB. $A_U = \\begin{pmatrix} 0 & 0 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{pmatrix}, A_W = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0.85 & 0 & 0 \\\\ 0 & 0.60 & 0 \\end{pmatrix}$\n\nC. $A_U = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 0 & 0 \\end{pmatrix}, A_W = \\begin{pmatrix} 0 & 0.85 & 0 \\\\ 0 & 0 & 0.60 \\\\ 0 & 0 & 0 \\end{pmatrix}$\n\nD. $A_U = \\begin{pmatrix} 0 & 0.85 & 0 \\\\ 0 & 0 & 0.60 \\\\ 0 & 0 & 0 \\end{pmatrix}, A_W = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 0 & 0 \\end{pmatrix}$\n\nE. $A_U = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 0 & 0 \\end{pmatrix}, A_W = \\begin{pmatrix} 0 & 0.60 & 0 \\\\ 0 & 0 & 0.85 \\\\ 0 & 0 & 0 \\end{pmatrix}$", "solution": "在一个节点顺序为 $(\\text{P1}, \\text{P2}, \\text{P3})$ 的有向邻接矩阵中，元素 $A_{ij}$ 代表从节点 $i$ 到节点 $j$ 的一条边。对于无权情况，$A_{ij}=1$ 表示从 $i$ 到 $j$ 存在激活，否则 $A_{ij}=0$。对于加权情况，$A_{ij}$ 等于从 $i$ 到 $j$ 激活的给定效率，如果没有相互作用，则 $A_{ij}=0$。\n\n该信号级联明确指定了两条有向边：$\\text{P1} \\rightarrow \\text{P2}$ 和 $\\text{P2} \\rightarrow \\text{P3}$，没有其他相互作用。因此，无权邻接矩阵必须在位置 $(1,2)$ 和 $(2,3)$ 处为1，在其他位置处为0：\n$$\nA_{U}=\\begin{pmatrix}\n0 & 1 & 0 \\\\\n0 & 0 & 1 \\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n\n加权邻接矩阵在相同的位置使用给定的效率，$0.85$ 对应 $\\text{P1} \\rightarrow \\text{P2}$，$0.60$ 对应 $\\text{P2} \\rightarrow \\text{P3}$：\n$$\nA_{W}=\\begin{pmatrix}\n0 & 0.85 & 0 \\\\\n0 & 0 & 0.60 \\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n\n与选项比较，这对矩阵与选项C完全匹配。其他选项要么包含了反向或额外的边，要么交换了权重，要么对换了加权和无权矩阵。", "answer": "$$\\boxed{C}$$", "id": "1477790"}, {"introduction": "在构建了网络模型之后，下一步便是如何解读它。本练习从表示转向了诠释，探讨了一个基本的图属性——“最短路径”——在加权和无权网络中如何具有截然不同的生物学含义。这个思想实验将突显一个关键原则：添加权重不仅是优化模型，它还能从根本上改变我们能回答的问题和能获得的洞见 [@problem_id:1477754]。", "problem": "一位系统生物学家正在为一个信号转导通路建模，该通路始于细胞表面受体蛋白的激活，终于细胞核内目标转录因子的激活。该通路被表示为一个有向图，其中蛋白质是节点，相互作用（例如，磷酸化事件）是边。该生物学家考虑了两种不同的模型来描述这个网络。\n\n**模型1：无权网络**\n在此模型中，如果已知蛋白质A直接激活蛋白质B，则存在一条从A到B的边。所有边都被同等对待。该网络中两个节点之间的“最短路径”被定义为包含最少边数的路径。\n\n**模型2：加权网络**\n该模型使用与模型1相同的节点和边。然而，每条从蛋白质A到蛋白质B的边都被赋予一个正权重 $w(A, B)$，它表示激活信号从A传播到B所需的平均时间（以毫秒为单位）。该网络中两个节点之间的“最短路径”被定义为其所有边的权重之和最小的路径。\n\n在这两种模型中，从初始受体到最终转录因子的最短路径最准确的生物学解释是什么？\n\nA. 在无权网络中，它代表具有最少连续蛋白质激活步骤的通路。在加权网络中，它代表允许信号从受体到靶标最快传播的通路。\n\nB. 在无权网络中，它代表允许信号最快传播的通路。在加权网络中，它代表具有最少连续蛋白质激活步骤的通路。\n\nC. 在两种网络中，最短路径都标识了信号传播最节能的路线，因为更少或更快的步骤与更低的三磷酸腺苷（ATP）消耗相关。\n\nD. 在无权网络中，它代表细胞内物理上最紧凑的通路。在加权网络中，它代表对随机蛋白质失活最具鲁棒性的通路。\n\nE. 在两种网络中，最短路径都标识了从受体到靶标进化上最保守的通路。", "solution": "将模型1的有向图定义为 $G=(V,E)$，其中源（受体）$s \\in V$，目标（转录因子）$t \\in V$。一条从 $s$ 到 $t$ 的路径 $P$ 可以写为 $P=(v_{0}=s,v_{1},\\dots,v_{k}=t)$，其边为 $\\left(v_{i-1},v_{i}\\right) \\in E$。在无权网络中，路径的长度是边的数量：\n$$\nL(P)=k.\n$$\n最短路径旨在最小化所有 $s \\to t$ 路径的 $L(P)$。从生物学上讲，每条边对应于从一个蛋白质到下一个蛋白质的直接激活事件（例如，磷酸化）。因此，最小化 $L(P)$ 标识了从受体到转录因子具有最少连续蛋白质激活步骤的通路。\n\n对于模型2，使用相同的 $G=(V,E)$，但为其分配一个正权重函数 $w:E \\to \\mathbb{R}_{>0}$，其中 $w(A,B)$ 是激活信号从A传播到B的平均时间。路径 $P=(v_{0}=s,\\dots,v_{k}=t)$ 的成本（总时间）是\n$$\nC(P)=\\sum_{i=1}^{k} w\\!\\left(v_{i-1},v_{i}\\right).\n$$\n最短路径旨在最小化所有 $s \\to t$ 路径的 $C(P)$。由于权重代表传播时间，最小化 $C(P)$ 会得到从受体到转录因子预期信号传输最快的通路。这不一定会最小化步骤数；一条具有更多但更快边的路径可能会有更短的总时间。\n\n评估选项：\n- A 符合定义：无权最短路径对应最少的激活步骤；加权最短路径对应最快的传播（最小总时间）。\n- B 颠倒了这些解释，因此是错误的。\n- C 引入了能量效率和ATP消耗，这些并未在图的定义中指定或编码；此处的 dlaest 路径不一定能使能量最小化。\n- D 提到了物理紧凑性和鲁棒性，这些不能用边数或时间权重来表示；这两种解释都不能从定义中得出。\n- E 提到了进化保守性，这既不能用边数也不能用时间权重来编码。\n\n因此，正确选项是A。", "answer": "$$\\boxed{A}$$", "id": "1477754"}, {"introduction": "最后的这项练习将挑战你在动态模拟中应用这些概念。通过将信号通路建模为随机游走，你将定量地比较无权模型与基于生化信息的加权模型的预测差异。这个练习展示了权重如何能够产生对生物过程时序的显著不同且通常更真实的预测，让你体会到加权分析在动态建模中的威力 [@problem_id:1477791]。", "problem": "一位系统生物学家正在为一个细胞内信号通路开发计算模型。该通路可以简化为一个由四个相互作用的蛋白质组成的有向图：一个受体（节点1），两个中间激酶（节点2和节点3），以及一个目标转录因子（节点4）。信号流由以下连接表示：从节点1到节点2和节点3；从节点2到节点3和节点4；以及从节点3到节点2和节点4。\n\n该信号传导过程被建模为一个离散时间随机游走，其中一个信号包在时间 $t=0$ 时从受体（节点1）发出。当信号首次到达作为吸收态的转录因子（节点4）时，该过程结束。该生物学家想要比较两种不同的信号传播模型，并量化它们之间的差异。\n\n**模型 A（无权）：** 这是一个朴素模型，其中信号在任何给定节点以相等的概率转移到其连接的任一下游邻居。\n\n**模型 B（有权）：** 该模型包含了生物化学动力学。信号从节点 `u` 转移到邻近下游节点 `v` 的概率与节点 `v` 处蛋白质的催化活性成正比。该活性由速率常数 $k_v$ 表征。因此，转移概率由 $P_{u \\to v} = k_v / \\sum_{w \\in N(u)} k_w$ 给出，其中 $N(u)$ 是 `u` 的所有下游邻居的集合。对于此通路，速率常数给定为：$k_2 = k$，$k_3 = 3k$ 和 $k_4 = 2k$，其中 $k$ 为某个基本速率。\n\n你的任务是分析这两种模型的预测差异。计算比率 $\\mathcal{R} = \\frac{\\langle T_{1 \\to 4} \\rangle_{\\text{A}}}{\\langle T_{1 \\to 4} \\rangle_{\\text{B}}}$，其中 $\\langle T_{1 \\to 4} \\rangle_{\\text{A}}$ 和 $\\langle T_{1 \\to 4} \\rangle_{\\text{B}}$ 分别是模型A和模型B下信号从节点1传播到节点4的平均首达时间（MFPT）。请以精确分数形式给出你的答案。", "solution": "问题要求计算在一个有向图上随机游走的两种不同模型中，从节点1到节点4的平均首达时间（MFPT）的比率。设 $T_i$ 表示从节点 $i$ 开始到达目标节点4的MFPT。根据定义，从目标节点到其自身的MFPT为零，因此 $T_4 = 0$。\n\n对于任何非目标节点 $i$，其 MFPT 可以表示为 1 加上从其邻居节点出发的 MFPT 以转移概率为权重的加权平均值。通用公式为：\n$$T_i = 1 + \\sum_{j \\in N(i)} P_{i \\to j} T_j$$\n其中 $N(i)$ 是节点 $i$ 的下游邻居集合，$P_{i \\to j}$ 是从节点 $i$ 转移到节点 $j$ 的概率。\n\n图结构如下：\n- 节点1的邻居为 $N(1) = \\{2, 3\\}$。\n- 节点2的邻居为 $N(2) = \\{3, 4\\}$。\n- 节点3的邻居为 $N(3) = \\{2, 4\\}$。\n- 节点4是吸收目标。\n\n我们需要求出 $T_1$。为此，我们建立一个关于 $T_1, T_2, T_3$ 的线性方程组：\n1.  $T_1 = 1 + P_{1 \\to 2} T_2 + P_{1 \\to 3} T_3$\n2.  $T_2 = 1 + P_{2 \\to 3} T_3 + P_{2 \\to 4} T_4 = 1 + P_{2 \\to 3} T_3$ (因为 $T_4=0$)\n3.  $T_3 = 1 + P_{3 \\to 2} T_2 + P_{3 \\to 4} T_4 = 1 + P_{3 \\to 2} T_2$ (因为 $T_4=0$)\n\n现在我们针对每个模型解这个方程组。\n\n**模型 A：无权图**\n\n在此模型中，向邻居节点的转移是等概率的。\n- 从节点1（2个邻居）： $P_{1 \\to 2} = 1/2$, $P_{1 \\to 3} = 1/2$。\n- 从节点2（2个邻居）： $P_{2 \\to 3} = 1/2$, $P_{2 \\to 4} = 1/2$。\n- 从节点3（2个邻居）： $P_{3 \\to 2} = 1/2$, $P_{3 \\to 4} = 1/2$。\n\n将这些概率代入方程组：\n2.  $T_2 = 1 + \\frac{1}{2} T_3$\n3.  $T_3 = 1 + \\frac{1}{2} T_2$\n\n这是一个关于 $T_2$ 和 $T_3$ 的二元线性方程组。我们将方程（3）代入（2）：\n$T_2 = 1 + \\frac{1}{2} \\left(1 + \\frac{1}{2} T_2\\right) = 1 + \\frac{1}{2} + \\frac{1}{4} T_2 = \\frac{3}{2} + \\frac{1}{4} T_2$\n$T_2 - \\frac{1}{4} T_2 = \\frac{3}{2} \\implies \\frac{3}{4} T_2 = \\frac{3}{2} \\implies T_2 = 2$。\n\n现在，我们使用方程（3）求出 $T_3$：\n$T_3 = 1 + \\frac{1}{2}(2) = 1 + 1 = 2$。\n\n最后，我们使用方程（1）计算 $T_1$：\n$T_1 = 1 + \\frac{1}{2} T_2 + \\frac{1}{2} T_3 = 1 + \\frac{1}{2}(2) + \\frac{1}{2}(2) = 1 + 1 + 1 = 3$。\n所以，对于模型A，$\\langle T_{1 \\to 4} \\rangle_{\\text{A}} = 3$。\n\n**模型 B：有权图**\n\n转移概率 $P_{u \\to v}$ 与目标节点 $v$ 的速率常数 $k_v$ 成正比。我们已知 $k_2=k$, $k_3=3k$, $k_4=2k$。\n- 从节点1（$N(1) = \\{2, 3\\}$）：归一化因子为 $\\sum_{w \\in N(1)} k_w = k_2 + k_3 = k + 3k = 4k$。\n  $P_{1 \\to 2} = \\frac{k_2}{4k} = \\frac{k}{4k} = \\frac{1}{4}$。\n  $P_{1 \\to 3} = \\frac{k_3}{4k} = \\frac{3k}{4k} = \\frac{3}{4}$。\n\n- 从节点2（$N(2) = \\{3, 4\\}$）：归一化因子为 $\\sum_{w \\in N(2)} k_w = k_3 + k_4 = 3k + 2k = 5k$。\n  $P_{2 \\to 3} = \\frac{k_3}{5k} = \\frac{3k}{5k} = \\frac{3}{5}$。\n  $P_{2 \\to 4} = \\frac{k_4}{5k} = \\frac{2k}{5k} = \\frac{2}{5}$。\n\n- 从节点3（$N(3) = \\{2, 4\\}$）：归一化因子为 $\\sum_{w \\in N(3)} k_w = k_2 + k_4 = k + 2k = 3k$。\n  $P_{3 \\to 2} = \\frac{k_2}{3k} = \\frac{k}{3k} = \\frac{1}{3}$。\n  $P_{3 \\to 4} = \\frac{k_4}{3k} = \\frac{2k}{3k} = \\frac{2}{3}$。\n\n现在，我们将这些概率代入我们的通用方程组中：\n2.  $T_2 = 1 + P_{2 \\to 3} T_3 = 1 + \\frac{3}{5} T_3$\n3.  $T_3 = 1 + P_{3 \\to 2} T_2 = 1 + \\frac{1}{3} T_2$\n\n我们求解这个新的关于 $T_2$ 和 $T_3$ 的方程组。将（3）代入（2）：\n$T_2 = 1 + \\frac{3}{5} \\left(1 + \\frac{1}{3} T_2\\right) = 1 + \\frac{3}{5} + \\frac{1}{5} T_2 = \\frac{8}{5} + \\frac{1}{5} T_2$\n$T_2 - \\frac{1}{5} T_2 = \\frac{8}{5} \\implies \\frac{4}{5} T_2 = \\frac{8}{5} \\implies T_2 = 2$。\n\n使用这个值代入方程（3）求出 $T_3$：\n$T_3 = 1 + \\frac{1}{3}(2) = 1 + \\frac{2}{3} = \\frac{5}{3}$。\n\n最后，我们使用方程（1）计算模型 B 的 $T_1$：\n$T_1 = 1 + P_{1 \\to 2} T_2 + P_{1 \\to 3} T_3 = 1 + \\frac{1}{4}(2) + \\frac{3}{4}\\left(\\frac{5}{3}\\right)$\n$T_1 = 1 + \\frac{2}{4} + \\frac{15}{12} = 1 + \\frac{1}{2} + \\frac{5}{4}$\n$T_1 = \\frac{4}{4} + \\frac{2}{4} + \\frac{5}{4} = \\frac{11}{4}$。\n所以，对于模型B，$\\langle T_{1 \\to 4} \\rangle_{\\text{B}} = \\frac{11}{4}$。\n\n**计算比率 $\\mathcal{R}$**\n\n最后一步是计算两个MFPT的比率：\n$\\mathcal{R} = \\frac{\\langle T_{1 \\to 4} \\rangle_{\\text{A}}}{\\langle T_{1 \\to 4} \\rangle_{\\text{B}}} = \\frac{3}{\\frac{11}{4}} = 3 \\times \\frac{4}{11} = \\frac{12}{11}$。", "answer": "$$\\boxed{\\frac{12}{11}}$$", "id": "1477791"}]}