{"hands_on_practices": [{"introduction": "在系统生物学中，首要任务是将复杂的生物系统抽象为网络模型。本练习将通过一个直观的流行病学场景——家庭内的疾病传播——指导您完成这一基本技能的实践。您将学习如何将个体间的接触关系转化为一种称为邻接矩阵的数学形式，从而牢固掌握生物系统与其图论表示之间的直接联系 [@problem_id:1462969]。", "id": "1462969", "problem": "考虑一个用于模拟疾病传播的小型孤立家庭。该家庭由四名成员组成：Alice、Bob、Charlie 和 David。在这个家庭内部，促进传播的直接接触发生在特定的成员对之间。两位家长 Alice和Bob 彼此有直接接触。每位家长都与他们的两个孩子 Charlie 和 David 有直接接触。两个孩子之间也有直接接触。不存在其他直接接触的情况。\n\n一个潜在的传播网络可以用一个邻接矩阵 $A$ 来表示，其中如果个体 $i$ 和个体 $j$ 有直接接触，则矩阵元素 $A_{ij}$ 为 1，否则为 0。根据定义，个体与自身没有接触。\n\n构建这个家庭的邻接矩阵 $A$。矩阵的行和列应按字母顺序对应于以下个体：1. Alice, 2. Bob, 3. Charlie, 4. David。您的答案必须是完整的矩阵。", "solution": "我们将该家庭建模为一个无向简单图，其顶点按以下顺序排列：1: Alice, 2: Bob, 3: Charlie, 4: David。根据邻接矩阵 $A$ 的定义，如果个体 $i$ 和 $j$ 有直接接触，我们设 $A_{ij}=1$，否则设 $A_{ij}=0$，并且由于没有人与自己接触，所以 $A_{ii}=0$。\n\n根据描述：\n- Alice 和 Bob 有接触，所以 $A_{12}=A_{21}=1$。\n- 每位家长与每个孩子都有接触：Alice 与 Charlie 和 David 接触，得到 $A_{13}=A_{31}=1$ 和 $A_{14}=A_{41}=1$；Bob 与 Charlie 和 David 接触，得到 $A_{23}=A_{32}=1$ 和 $A_{24}=A_{42}=1$。\n- 两个孩子之间有接触，所以 $A_{34}=A_{43}=1$。\n- 不存在其他接触，并且所有对角线元素都为零：$A_{11}=A_{22}=A_{33}=A_{44}=0$。\n\n因此，所有非对角线元素都为 1，而对角线元素都为 0，得到\n$$\nA=\\begin{pmatrix}\n0 & 1 & 1 & 1\\\\\n1 & 0 & 1 & 1\\\\\n1 & 1 & 0 & 1\\\\\n1 & 1 & 1 & 0\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0 & 1 & 1 & 1\\\\ 1 & 0 & 1 & 1\\\\ 1 & 1 & 0 & 1\\\\ 1 & 1 & 1 & 0\\end{pmatrix}}$$"}, {"introduction": "许多生物过程，如基因调控，都涉及有方向的因果关系。本练习将引导您超越简单的连接，转而为这些有向互动（如激活和抑制）建模。通过构建一个基因调控网络并计算其中特定长度的路径数量，您不仅能练习如何表示复杂的调控逻辑，还能学会运用图论对网络结构进行定量分析 [@problem_id:1463020]。", "id": "1463020", "problem": "在系统生物学中，基因调控网络通常被建模为有向图，以分析其结构并预测其行为。考虑一个细胞内基因调控回路的简化模型，该模型涉及一个外部信号和三个基因。其组成部分及相互作用如下：\n\n1.  一个外部信号分子，记为 $S$，激活基因 $G_1$ 的表達。\n2.  基因 $G_1$ 的蛋白质产物作为转录因子，激活基因 $G_2$ 和基因 $G_3$ 的表达。\n3.  基因 $G_2$ 的蛋白质产物抑制基因 $G_1$ 的表达，形成一个负反馈回路。\n4.  基因 $G_3$ 是此特定通路的末端输出；其蛋白质产物不调控 $S$、$G_1$ 或 $G_2$。\n\n该网络可以表示为一个有向图，其节点为四个组成部分 $\\{S, G_1, G_2, G_3\\}$。如果节点 $X$ 直接引起节点 $Y$ 的状态或表达发生变化（激活或抑制），则存在一条从 $X$ 到 $Y$ 的有向边。\n\n图中长度为 $k$ 的路径定义为一个由 $k+1$ 个节点组成的序列 $(v_0, v_1, \\dots, v_k)$，使得对于所有从 $1$ 到 $k$ 的 $i$，都存在一条从 $v_{i-1}$ 到 $v_i$ 的有向边。计算该网络中存在的长度为3的不同路径的总数。", "solution": "我们首先将生物学描述转化为一个有向图，其节点为 $\\{S,G_{1},G_{2},G_{3}\\}$，有向边由所述的调控关系给出：\n- $S \\to G_{1}$（$S$ 激活 $G_{1}$），\n- $G_{1} \\to G_{2}$ 和 $G_{1} \\to G_{3}$（$G_{1}$ 激活 $G_{2}$ 和 $G_{3}$），\n- $G_{2} \\to G_{1}$（$G_{2}$ 抑制 $G_{1}$），\n- $G_{3}$ 没有出边。\n\n一条长度为3的有向路径是一个序列 $(v_{0},v_{1},v_{2},v_{3})$，其边为 $v_{0}\\to v_{1}\\to v_{2}\\to v_{3}$。我们可以通过直接枚举或使用邻接矩阵方法来计算此类路径的数量。\n\n使用鄰接矩陣方法，將節點排序為 $(S,G_{1},G_{2},G_{3})$，並定義鄰接矩陣 $A$ 為：如果存在從節點 $i$ 到節點 $j$ 的邊，則 $A_{ij}=1$，否則 $A_{ij}=0$。则\n$$\nA=\\begin{pmatrix}\n0 & 1 & 0 & 0\\\\\n0 & 0 & 1 & 1\\\\\n0 & 1 & 0 & 0\\\\\n0 & 0 & 0 & 0\n\\end{pmatrix}.\n$$\n图论中的一个标准结论是，$(A^{k})_{ij}$ 等于从节点 $i$ 到节点 $j$ 的长度为 $k$ 的有向途径的数量。因此，长度为3的路径总数是 $A^{3}$ 中所有元素的总和。计算\n$$\nA^{2}=\\begin{pmatrix}\n0 & 0 & 1 & 1\\\\\n0 & 1 & 0 & 0\\\\\n0 & 0 & 1 & 1\\\\\n0 & 0 & 0 & 0\n\\end{pmatrix},\n\\qquad\nA^{3}=\\begin{pmatrix}\n0 & 1 & 0 & 0\\\\\n0 & 0 & 1 & 1\\\\\n0 & 1 & 0 & 0\\\\\n0 & 0 & 0 & 0\n\\end{pmatrix}.\n$$\n$A^{3}$ 的所有元素求和得到 $1+2+1+0=4$。\n\n为了完整起见，我们明确地列举出所有长度为3的不同路径：\n$S \\to G_{1} \\to G_{2} \\to G_{1}$,\n$G_{1} \\to G_{2} \\to G_{1} \\to G_{2}$,\n$G_{1} \\to G_{2} \\to G_{1} \\to G_{3}$,\n$G_{2} \\to G_{1} \\to G_{2} \\to G_{1}$.\n恰好有 $4$ 条这样的路径，与矩阵计算结果相符。", "answer": "$$\\boxed{4}$$"}, {"introduction": "网络模型的真正力量在于其预测系统行为的能力。这项高级练习将挑战您模拟药物干预对信号通路的影响。通过将一套逻辑规则应用于图模型，您将推导出细胞网络在受到扰动后的新稳态，这充分展示了如何利用这些图表示来理解和预测系统层面的后果 [@problem_id:1462975]。", "id": "1462975", "problem": "一个细胞决策通路的简化模型由一个包含8个蛋白质组分（标记为P1至P8）的有向图表示。组分P1是一个受体，它被一个持续的外部信号刺激，这意味着它的状态总是“激活”。组分之间的连接和调控效应（相互作用）被描述为一个有向边列表，其形式为（源，目标，效应）：\n\n*   (P1, P2, 激活)\n*   (P1, P3, 激活)\n*   (P2, P4, 激活)\n*   (P2, P5, 抑制)\n*   (P3, P5, 激活)\n*   (P3, P6, 抑制)\n*   (P4, P7, 激活)\n*   (P5, P7, 抑制)\n*   (P6, P8, 激活)\n*   (P7, P8, 抑制)\n\n任何组分（源P1除外）的活性状态由调控它的组分的状态决定。一个组分要处于“激活”状态的规则是它必须同时满足两个条件：\n1.  至少有一个激活它的上游组分是“激活”状态。\n2.  所有抑制它的上游组分都是“非激活”状态。\n\n如果这两个条件中任何一个不被满足，该组分就变为“非激活”状态。没有激活输入的组分总是“非激活”的。没有抑制输入的组分被认为默认满足第二个条件。\n\n我们假设，在任何干预之前，一个持续的信号环境已导致一个基线状态，其中所有8个组分都处于“激活”状态。然后，引入一种高度特异性的药物，该药物完全并永久地与组分P2结合，迫使其状态变为“非激活”。这种抑制效应随后在网络中传播，直到所有组分达到一个新的、稳定的活性状态平衡。\n\n计算在这个新的平衡状态下，处于“非激活”状态的组分总数。", "solution": "令 $s_{i} \\in \\{0,1\\}$ 表示 $P_{i}$ 的活性，$1$ 代表激活，$0$ 代表非激活。受体 $P_{1}$ 持续受刺激，因此 $s_{1}=1$。药物永久性地使 $P_{2}$ 变为非激活，因此 $s_{2}=0$。\n\n对于任何具有激活输入集 $A_{i}$ 和抑制输入集 $I_{i}$ 的组分 $P_{i}$，其更新规则为\n$$\ns_{i}=\\left(\\bigvee_{j \\in A_{i}} s_{j}\\right)\\land \\left(\\bigwedge_{k \\in I_{i}} \\neg s_{k}\\right),\n$$\n这里的约定是，空析取为 $0$（没有激活物意味着非激活），空合取为 $1$（没有抑制物意味着该条件被满足）。\n\n鉴于该图为无环图，按拓扑顺序评估每个节点：\n\n对于 $P_{3}$，$A_{3}=\\{1\\}$ 且 $I_{3}=\\varnothing$。因此\n$$\ns_{3}=\\left(\\bigvee_{j \\in \\{1\\}} s_{j}\\right)\\land 1=s_{1}\\land 1=1.\n$$\n\n对于 $P_{4}$，$A_{4}=\\{2\\}$ 且 $I_{4}=\\varnothing$。因此\n$$\ns_{4}=\\left(\\bigvee_{j \\in \\{2\\}} s_{j}\\right)\\land 1=s_{2}\\land 1=0.\n$$\n\n对于 $P_{5}$，$A_{5}=\\{3\\}$ 且 $I_{5}=\\{2\\}$。因此\n$$\ns_{5}=\\left(\\bigvee_{j \\in \\{3\\}} s_{j}\\right)\\land \\left(\\bigwedge_{k \\in \\{2\\}} \\neg s_{k}\\right)=s_{3}\\land \\neg s_{2}=1\\land \\neg 0=1.\n$$\n\n对于 $P_{6}$，$A_{6}=\\varnothing$ 且 $I_{6}=\\{3\\}$。因此\n$$\ns_{6}=\\left(\\bigvee_{j \\in \\varnothing} s_{j}\\right)\\land \\left(\\bigwedge_{k \\in \\{3\\}} \\neg s_{k}\\right)=0\\land \\neg s_{3}=0.\n$$\n\n对于 $P_{7}$，$A_{7}=\\{4\\}$ 且 $I_{7}=\\{5\\}$。因此\n$$\ns_{7}=s_{4}\\land \\neg s_{5}=0\\land \\neg 1=0.\n$$\n\n对于 $P_{8}$，$A_{8}=\\{6\\}$ 且 $I_{8}=\\{7\\}$。因此\n$$\ns_{8}=s_{6}\\land \\neg s_{7}=0\\land \\neg 0=0.\n$$\n\n因此，在新的平衡状态下，非激活的组分是 $P_{2}, P_{4}, P_{6}, P_{7}, P_{8}$，总共有 $5$ 个。", "answer": "$$\\boxed{5}$$"}]}