{"hands_on_practices": [{"introduction": "随机模拟算法 (SSA) 的核心是“倾向” (propensity) 的概念，它量化了在当前系统状态下，每个可能反应的瞬时发生率。所有反应倾向的总和，即总倾向 $a_0$，决定了下一个反应事件发生的时间间隔。这个练习将通过一个简单的基因表达模型，带你实践计算这些基本量，为理解 SSA 的“何时”发生反应这一关键步骤打下基础。", "problem": "考虑一个用于描述细胞内单个基因表达的简化随机模型。该模型关注特定信使核糖核酸（mRNA）的分子数量，记为 $M$。两个反应控制着 mRNA 种群的动态变化：\n\n1.  **转录**：产生一个 mRNA 分子。这是一个形式为 $\\emptyset \\rightarrow M$ 的零级反应，以恒定的倾向发生。\n2.  **降解**：一个已有的 mRNA 分子被降解。这是一个形式为 $M \\rightarrow \\emptyset$ 的一级反应，具有一个随机速率常数。\n\n反应的倾向代表其瞬时概率速率。在特定时刻，系统的状态由 mRNA 分子数 $n_M$ 定义。\n\n给定以下参数：\n- 恒定生产倾向：$k_p = 10.5 \\text{ s}^{-1}$\n- 降解速率常数：$k_d = 0.12 \\text{ s}^{-1}$\n- 当前 mRNA 分子数：$n_M = 150$\n\n计算此刻系统的总倾向 $a_0$。在随机模拟算法中，总倾向是一个关键量，因为它决定了到下一个反应事件发生的时间。你的答案需以 $\\text{s}^{-1}$ 为单位，并四舍五入到三位有效数字。", "solution": "在随机化学动力学框架（Gillespie）中，每个反应的倾向是在给定当前状态下其发生的瞬时速率。\n\n- 对于零级转录反应 $\\emptyset \\rightarrow M$，其倾向是恒定的：\n$$\na_{\\text{prod}} = k_{p}.\n$$\n\n- 对于一级降解反应 $M \\rightarrow \\emptyset$，其倾向与当前分子数成正比：\n$$\na_{\\text{deg}} = k_{d}\\, n_{M}.\n$$\n\n总倾向是所有反应倾向之和：\n$$\na_{0} = a_{\\text{prod}} + a_{\\text{deg}} = k_{p} + k_{d}\\, n_{M}.\n$$\n\n代入给定值 $k_{p} = 10.5\\,\\text{s}^{-1}$、$k_{d} = 0.12\\,\\text{s}^{-1}$ 和 $n_{M} = 150$，我们得到\n$$\na_{0} = 10.5 + 0.12 \\times 150 = 10.5 + 18.0 = 28.5.\n$$\n\n因此，总倾向为 $28.5\\,\\text{s}^{-1}$，保留三位有效数字后为 $28.5$。", "answer": "$$\\boxed{28.5}$$", "id": "1468248"}, {"introduction": "在确定下一个反应“何时”发生后，SSA 的下一步是决定“哪个”反应会发生。这个选择不是确定性的，而是概率性的，每个反应被选中的概率与其倾向值占总倾向的比例成正比。这个练习将模拟一个常见的生物信号转导场景——两种激酶竞争磷酸化同一个底物——让你亲手计算特定反应发生的概率。", "problem": "一个细胞含有一种信号蛋白 $P$，它可以通过磷酸化被激活。这种磷酸化可以由两种不同的酶——激酶A（$K_A$）和激酶B（$K_B$）——催化。该系统是充分混合的，并且可以通过以下两个基元化学反应进行建模：\n\n1.  $P + K_A \\xrightarrow{c_A} P^* + K_A$\n2.  $P + K_B \\xrightarrow{c_B} P^* + K_B$\n\n此处，$P^*$ 代表该蛋白质的磷酸化（活性）形式。这两个反应分别以二级速率常数 $c_A$ 和 $c_B$ 进行。这些常数包含了关于每对反应物分子的反应速率的信息。\n\n在某一特定时刻，系统中包含 $n_P$ 个底物蛋白 $P$ 分子，$n_A$ 个激酶A分子，以及 $n_B$ 个激酶B分子。\n\n假设对这些反应进行随机性描述，请确定系统中即将发生的下一个反应是一个 P 分子被一个 $K_A$ 分子磷酸化的概率。请用 $c_A$、$c_B$、$n_A$ 和 $n_B$ 将您的答案表示为一个符号表达式。", "solution": "我们采用随机化学动力学（Gillespie）框架。对于一个二级速率常数为 $c$ 的、发生在两种不同物种 $X$ 和 $Y$ 之间的基元双分子反应，其倾向函数是 $c$ 与不同反应物对数量（即 $n_{X}n_{Y}$）的乘积。因此，这两个反应通道的倾向函数分别为\n$$\na_{A}=c_{A}\\,n_{P}\\,n_{A},\\qquad a_{B}=c_{B}\\,n_{P}\\,n_{B}.\n$$\n总倾向函数为\n$$\na_{0}=a_{A}+a_{B}=c_{A}\\,n_{P}\\,n_{A}+c_{B}\\,n_{P}\\,n_{B}.\n$$\n根据 Gillespie 理论，下一个发生的反应是某个给定通道的概率，等于该通道的倾向函数除以总倾向函数。因此，下一个反应是由 $K_{A}$ 催化的磷酸化反应的概率为\n$$\n\\frac{a_{A}}{a_{0}}=\\frac{c_{A}\\,n_{P}\\,n_{A}}{c_{A}\\,n_{P}\\,n_{A}+c_{B}\\,n_{P}\\,n_{B}}.\n$$\n从分子和分母中提出公因子 $n_{P}$（假设 $n_{P}>0$ 以确保反应可以发生），可得\n$$\n\\frac{c_{A}\\,n_{A}}{c_{A}\\,n_{A}+c_{B}\\,n_{B}}.\n$$\n该表达式仅取决于 $c_{A}$、$c_{B}$、$n_{A}$ 和 $n_{B}$，符合题目要求。", "answer": "$$\\boxed{\\frac{c_{A}n_{A}}{c_{A}n_{A}+c_{B}n_{B}}}$$", "id": "1468285"}, {"introduction": "真实的生物过程，如转录、翻译和蛋白质成熟，往往包含固有的时间延迟，而标准的 SSA 假设反应是瞬时的。为了模拟这些更复杂的系统，我们需要对算法进行扩展，引入事件调度机制来处理延迟反应。本练习将引导你手动执行一个包含固定时间延迟的反应网络的模拟，这不仅能加深你对算法核心逻辑的理解，还能让你体验到如何将 SSA 应用于更接近真实生物学复杂性的问题。", "problem": "考虑一个宿主细胞内病毒蛋白合成的简化模型。该系统包含三种物质：数量恒定的病毒基因组 ($S_1$)、前体蛋白 ($S_2$) 和成熟的功能性蛋白 ($S_3$)。其化学反应网络由以下反应描述：\n\n1.  **转录/翻译 (R1):** $S_1 \\xrightarrow{c_1} S_2$。前体蛋白 $S_2$ 以恒定速率产生。此反应的倾向（hazard）为 $a_1 = c_1$。\n2.  **成熟 (R2):** $S_2 \\xrightarrow{k_2} S_3$。前体蛋白 $S_2$ 经历构象变化，成为成熟蛋白 $S_3$。该过程不是瞬时的，存在一个固定的时间延迟 $\\tau$。当在时间 $t$ 选择发生此反应时，一个 $S_2$ 分子会立即被消耗，但相应的 $S_3$ 分子仅在时间 $t+\\tau$ 出现。引发此反应的倾向为 $a_2 = k_2 N_2$，其中 $N_2$ 是 $S_2$ 的分子数。\n3.  **前体蛋白降解 (R3):** $S_2 \\xrightarrow{k_3} \\emptyset$。前体蛋白被降解。其倾向为 $a_3 = k_3 N_2$。\n4.  **成熟蛋白降解 (R4):** $S_3 \\xrightarrow{k_4} \\emptyset$。成熟蛋白被降解。其倾向为 $a_4 = k_4 N_3$，其中 $N_3$ 是 $S_3$ 的分子数。\n\n为模拟该系统，必须使用标准随机模拟算法 (Stochastic Simulation Algorithm, SSA) 的一种改进形式，以考虑时间延迟。一个“事件”被定义为系统中分子数量的任何离散变化。这包括瞬时反应 (R1, R3, R4) 的发生，也包括延迟反应 (R2) 的完成（即产物的生成）。\n\n给定以下参数和初始条件：\n-   初始时间：$t=0$。\n-   初始分子数：$N_2(0) = 0$, $N_3(0) = 0$。\n-   速率常数：$c_1 = 10.0 \\text{ s}^{-1}$，$k_2 = 0.5 \\text{ s}^{-1}$，$k_3 = 0.2 \\text{ s}^{-1}$，$k_4 = 1.0 \\text{ s}^{-1}$。\n-   时间延迟：$\\tau = 0.2 \\text{ s}$。\n\n你需要从 $t=0$ 开始，对恰好**三个**连续事件进行模拟。用于分别确定到下一个反应的时间和反应索引的均匀随机数对 $(r_1, r_2)$ 的序列如下：\n-   对于事件 1：$(0.50, 0.40)$\n-   对于事件 2：$(0.30, 0.95)$\n-   如需后续计算，使用：$(0.10, 0.50)$\n\n确定这三个事件发生后系统的状态。你的答案应包括前体蛋白的最终分子数 ($N_2$)、成熟蛋白的最终分子数 ($N_3$) 以及最终时间 ($t$)。最终时间以秒为单位，并四舍五入到四位有效数字。", "solution": "我们应用一种延迟反应 SSA。瞬时反应的等待时间由下式抽取：\n$$\n\\Delta t=\\frac{1}{a_{0}}\\ln\\!\\left(\\frac{1}{r_{1}}\\right),\n$$\n其中 $a_{0}=a_{1}+a_{2}+a_{3}+a_{4}$，而反应索引通过寻找满足 $\\sum_{i=1}^{j}a_{i}\\geq r_{2}a_{0}$ 的最小 $j$ 来选择。对于延迟反应 R2，当它在时间 $t$ 启动时，一个 $S_{2}$ 被立即消耗，并安排一个完成事件（增加一个 $S_{3}$）在 $t+\\tau$ 发生。下一个事件总是瞬时反应的发生和最早的已安排完成事件中最早发生的一个。\n\n在 $t=0$ 时，$N_{2}=0$，$N_{3}=0$。因此 $a_{1}=c_{1}$，$a_{2}=k_{2}N_{2}$，$a_{3}=k_{3}N_{2}$，$a_{4}=k_{4}N_{3}$。\n\n事件 1，使用 $(r_{1},r_{2})=(0.50,0.40)$：\n- 初始倾向：$a_{1}=c_{1}=10$，$a_{2}=k_{2}N_{2}=0$，$a_{3}=k_{3}N_{2}=0$，$a_{4}=k_{4}N_{3}=0$，所以 $a_{0}=10$。\n- 时间增量：\n$$\n\\Delta t_{1}=\\frac{1}{10}\\ln\\!\\left(\\frac{1}{0.50}\\right)=\\frac{\\ln 2}{10}.\n$$\n- 反应选择：$r_{2}a_{0}=0.40\\times 10=4$。累积和为 $a_{1}=10$，所以 R1 发生。\n- 在 $t_{1}=\\frac{\\ln 2}{10}$ 时更新：$N_{2}\\to 1$，$N_{3}\\to 0$。没有安排延迟完成事件。\n\n事件 2，使用 $(r_{1},r_{2})=(0.30,0.95)$：\n- 当前倾向（$N_{2}=1$，$N_{3}=0$）：$a_{1}=10$，$a_{2}=k_{2}N_{2}=0.5$，$a_{3}=k_{3}N_{2}=0.2$，$a_{4}=0$，所以 $a_{0}=10.7$。\n- 时间增量：\n$$\n\\Delta t_{2}=\\frac{1}{10.7}\\ln\\!\\left(\\frac{1}{0.30}\\right)=\\frac{1}{10.7}\\ln\\!\\left(\\frac{10}{3}\\right).\n$$\n- 反应选择：$r_{2}a_{0}=0.95\\times 10.7=10.165$。累积和：$a_{1}=10<10.165$，$a_{1}+a_{2}=10.5>10.165$，因此 R2 启动。\n- 在 $t_{2}=t_{1}+\\Delta t_{2}=\\frac{\\ln 2}{10}+\\frac{1}{10.7}\\ln\\!\\left(\\frac{10}{3}\\right)$ 时更新：消耗一个 $S_{2}$，所以 $N_{2}\\to 0$，$N_{3}\\to 0$。在 \n$$\nt_{\\text{comp}}=t_{2}+\\tau=\\frac{\\ln 2}{10}+\\frac{1}{10.7}\\ln\\!\\left(\\frac{10}{3}\\right)+0.2.\n$$\n安排一个完成事件。\n\n事件 3：比较下一次瞬时反应的时间与已安排在 $t_{\\text{comp}}$ 的完成事件的时间。\n- 事件 2 之后，$N_{2}=0$，$N_{3}=0$，所以 $a_{1}=10$，$a_{2}=0$，$a_{3}=0$，$a_{4}=0$，$a_{0}=10$。使用下一对随机数 $(r_{1},r_{2})=(0.10,0.50)$，从 $t_{2}$ 开始的候选瞬时反应时间增量为\n$$\n\\Delta t_{\\text{cand}}=\\frac{1}{10}\\ln\\!\\left(\\frac{1}{0.10}\\right)=\\frac{1}{10}\\ln 10.\n$$\n- 已安排的完成事件在 $t_2$ 之后 $\\tau=0.2$ 时到达。由于 $0.2<\\frac{1}{10}\\ln 10$，下一个事件是在 $t_{\\text{comp}}$ 的延迟完成事件；此次完成不消耗新的随机数。\n- 在 $t_{3}=t_{\\text{comp}}$ 时更新：生成一个 $S_{3}$，所以 $N_{3}\\to 1$，$N_{2}$ 保持不变。\n\n最终时间的数值计算：\n$$\nt_{3}=\\frac{\\ln 2}{10}+\\frac{1}{10.7}\\ln\\!\\left(\\frac{10}{3}\\right)+0.2\\approx 0.0693147+0.1125208+0.2\\approx 0.3818355,\n$$\n四舍五入到四位有效数字为 $0.3818$。\n\n因此，三个事件后，系统状态为 $N_{2}=0$，$N_{3}=1$，$t=0.3818$ s。", "answer": "$$\\boxed{\\begin{pmatrix}0 & 1 & 0.3818\\end{pmatrix}}$$", "id": "1468236"}]}