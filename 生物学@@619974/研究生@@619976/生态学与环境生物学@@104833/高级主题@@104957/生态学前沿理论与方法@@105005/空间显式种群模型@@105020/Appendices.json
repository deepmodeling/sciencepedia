{"hands_on_practices": [{"introduction": "理论的生命力在于实践。本章提供了一系列动手实践，旨在将抽象的空间显式模型理论转化为具体的分析和解决问题的能力。这些练习将引导您从分析经典的连续模型着手，逐步过渡到对模型假设的批判性思考，最终亲手构建并探索应用于生态保护的计算模型。\n\n反应-扩散方程，特别是 Fisher-KPP 方程，是描述生物入侵等空间生态学过程的基石。本练习旨在培养两项核心的数学建模技能：无量纲化和入侵波速的推导 [@problem_id:2534611]。通过无量纲化，我们将揭示系统内在的特征尺度，而推导最小入侵速度则让我们掌握该模型的关键预测能力，这对于理解和应用反应-扩散模型至关重要。", "problem": "一个在一维（$1$-D）无界生境中具有局部逻辑斯谛增长和随机扩散的空间显性种群，可用 Fisher–Kolmogorov–Petrovsky–Piskunov (Fisher–KPP) 反应扩散方程来建模：\n$$\n\\frac{\\partial N}{\\partial t} \\;=\\; D\\,\\frac{\\partial^{2}N}{\\partial x^{2}} \\;+\\; r\\,N\\Bigl(1-\\frac{N}{K}\\Bigr),\n$$\n其中 $N(x,t)$ 是种群密度，$D$ 是扩散系数，$r$ 是内禀增长率，$K$ 是环境承载力。考虑一个物种，其参数为 $D=0.5\\,\\text{km}^{2}/\\text{yr}$，$r=0.2\\,\\text{yr}^{-1}$，以及 $K=100\\,\\text{ind}/\\text{km}^{2}$。\n\n使用量纲分析和标度变换的第一性原理，完成以下任务：\n\n1) 通过为空间选择特征尺度 $L$、为时间选择特征尺度 $T$、为密度选择特征尺度 $K$ 来引入无量纲变量，从而将方程转换为无量纲形式。选择 $L$ 和 $T$ 使得变换后方程中扩散项和增长项的系数都等于 $1$。写出得到的无量纲偏微分方程，并指出方程中剩余的任何内在无量纲参数。\n\n2) 在无界直线上，考虑连接不稳定状态和稳定状态的单调行进入侵波。从第 ($1$) 部分得到的无量纲方程出发，使用行波约化和关于前沿的线性化来确定最小无量纲入侵速度。然后将此最小速度转换回有量纲单位，以得到一个用 $D$ 和 $r$ 表示的显式表达式。最后，对给定物种，数值计算这个最小入侵速度。最终数值答案以 $\\text{km}/\\text{yr}$ 为单位表示，并四舍五入到四位有效数字。\n\n你最终报告的答案必须是一个实数，代表以 $\\text{km}/\\text{yr}$ 为单位的最小入侵速度，并四舍五入到四位有效数字。", "solution": "所给问题是反应扩散方程分析中的一个标准且合理的习题，具体涉及 Fisher-Kolmogorov-Petrovsky-Piskunov (Fisher-KPP) 方程。该问题有科学依据，内部逻辑一致，并包含了获得唯一解所需的所有信息。我们将着手进行分析。\n\n控制方程如下所示：\n$$\n\\frac{\\partial N}{\\partial t} \\;=\\; D\\,\\frac{\\partial^{2}N}{\\partial x^{2}} \\;+\\; r\\,N\\Bigl(1-\\frac{N}{K}\\Bigr)\n$$\n其中 $N(x,t)$ 是种群密度，$D$ 是扩散系数，$r$ 是内禀增长率，$K$ 是环境承载力。给定的参数值为 $D=0.5\\,\\text{km}^{2}/\\text{yr}$、$r=0.2\\,\\text{yr}^{-1}$ 和 $K=100\\,\\text{ind}/\\text{km}^{2}$。\n\n**第 1 部分：无量纲化**\n\n我们引入以下无量纲变量，使用长度的特征尺度 $L$、时间的特征尺度 $T$ 和种群密度的特征尺度 $K$：\n$$\nu = \\frac{N}{K}, \\quad \\xi = \\frac{x}{L}, \\quad \\tau = \\frac{t}{T}\n$$\n这里，$u$、$\\xi$ 和 $\\tau$ 分别是无量纲密度、空间和时间变量。我们使用链式法则，将原方程中的导数用这些新变量表示：\n$$\n\\frac{\\partial N}{\\partial t} = \\frac{\\partial (Ku)}{\\partial \\tau} \\frac{\\partial \\tau}{\\partial t} = \\frac{K}{T} \\frac{\\partial u}{\\partial \\tau}\n$$\n$$\n\\frac{\\partial N}{\\partial x} = \\frac{\\partial (Ku)}{\\partial \\xi} \\frac{\\partial \\xi}{\\partial x} = \\frac{K}{L} \\frac{\\partial u}{\\partial \\xi} \\quad \\implies \\quad \\frac{\\partial^{2} N}{\\partial x^{2}} = \\frac{\\partial}{\\partial x}\\left(\\frac{K}{L}\\frac{\\partial u}{\\partial \\xi}\\right) = \\frac{K}{L} \\frac{\\partial}{\\partial \\xi}\\left(\\frac{\\partial u}{\\partial \\xi}\\right) \\frac{\\partial \\xi}{\\partial x} = \\frac{K}{L^2} \\frac{\\partial^{2} u}{\\partial \\xi^{2}}\n$$\n将这些表达式代入 Fisher-KPP 方程，得到：\n$$\n\\frac{K}{T} \\frac{\\partial u}{\\partial \\tau} = D \\frac{K}{L^2} \\frac{\\partial^{2} u}{\\partial \\xi^{2}} + r (Ku) \\left(1 - \\frac{Ku}{K}\\right)\n$$\n整个方程除以 $K$ 并重新整理，得到：\n$$\n\\frac{1}{T} \\frac{\\partial u}{\\partial \\tau} = \\frac{D}{L^2} \\frac{\\partial^{2} u}{\\partial \\xi^{2}} + r u(1 - u)\n$$\n两边乘以 $T$，我们得到：\n$$\n\\frac{\\partial u}{\\partial \\tau} = \\frac{DT}{L^2} \\frac{\\partial^{2} u}{\\partial \\xi^{2}} + rT u(1 - u)\n$$\n题目要求我们选择特征尺度 $L$ 和 $T$，使得扩散项和反应项的系数都等于 $1$。这给出了一个关于 $L$ 和 $T$ 的两个代数方程组：\n$$\n\\frac{DT}{L^2} = 1\n$$\n$$\nrT = 1\n$$\n由第二个方程，我们求得特征时间尺度 $T$：\n$$\nT = \\frac{1}{r}\n$$\n将此结果代入第一个方程，我们可以解出特征长度尺度 $L$：\n$$\n\\frac{D(1/r)}{L^2} = 1 \\quad \\implies \\quad \\frac{D}{r} = L^2 \\quad \\implies \\quad L = \\sqrt{\\frac{D}{r}}\n$$\n使用这些特征尺度，Fisher-KPP 方程的无量纲形式变为：\n$$\n\\frac{\\partial u}{\\partial \\tau} = \\frac{\\partial^2 u}{\\partial \\xi^2} + u(1-u)\n$$\n在这个典范形式中，所有有量纲参数（$D$、$r$、$K$）都已被吸收到变量的标度变换中。因此，方程本身不再含有内在的无量纲参数。\n\n**第 2 部分：最小入侵速度**\n\n我们分析无量纲方程的行波解，其形式为 $u(\\xi, \\tau) = U(z)$，其中 $z = \\xi - c\\tau$ 是行波坐标，$c$ 是恒定的无量纲波速。该波连接了不稳定平衡态 $u=0$ 和稳定平衡态 $u=1$。导数变换如下：\n$$\n\\frac{\\partial u}{\\partial \\tau} = -c \\frac{dU}{dz}, \\quad \\frac{\\partial^2 u}{\\partial \\xi^2} = \\frac{d^2 U}{dz^2}\n$$\n将这些代入无量纲偏微分方程，得到关于波形 $U(z)$ 的二阶常微分方程：\n$$\n-c U' = U'' + U(1-U) \\quad \\text{或} \\quad U'' + cU' + U(1-U) = 0\n$$\n入侵前锋的边界条件为：当 $z \\to \\infty$ 时（前沿），$U(z) \\to 0$；当 $z \\to -\\infty$ 时（后沿），$U(z) \\to 1$。\n\n为了确定最小速度，我们分析波的前沿行为，在此处 $U$ 接近于 $0$。在这个极限下，项 $U(1-U) = U - U^2$ 可以线性化为 $U$。常微分方程变为：\n$$\nU'' + cU' + U \\approx 0\n$$\n这是一个线性齐次常系数常微分方程。我们寻求形式为 $U(z) \\propto \\exp(-\\lambda z)$ 的指数解，该解在 $z$ 很大时必须衰减（因此 $\\lambda  0$）。代入线性化的常微分方程，得到关于 $\\lambda$ 的特征方程：\n$$\n\\lambda^2 - c\\lambda + 1 = 0\n$$\n$\\lambda$ 的根由二次求根公式给出：\n$$\n\\lambda = \\frac{c \\pm \\sqrt{c^2 - 4}}{2}\n$$\n为使种群密度在前沿处呈单调（非振荡）衰减，根 $\\lambda$ 必须是实数且为正。存在实数根的条件是判别式必须为非负：\n$$\nc^2 - 4 \\ge 0 \\quad \\implies \\quad c^2 \\ge 4\n$$\n由于入侵速度 $c$ 必须为正，这意味着 $c \\ge 2$。因此，可能的最小无量纲速度是：\n$$\nc_{min} = 2\n$$\n现在，我们必须将这个最小无量纲速度转换回有量纲单位。有量纲速度 $v$ 与无量纲速度 $c$ 通过特征速度 $L/T$ 相关联：\n$$\nv = c \\frac{L}{T}\n$$\n使用前面推导出的 $L$ 和 $T$ 的表达式：\n$$\n\\frac{L}{T} = \\frac{\\sqrt{D/r}}{1/r} = r \\sqrt{\\frac{D}{r}} = \\sqrt{r^2 \\frac{D}{r}} = \\sqrt{Dr}\n$$\n因此，有量纲速度为 $v = c \\sqrt{Dr}$。最小入侵速度 $v_{min}$ 对应于 $c_{min}=2$：\n$$\nv_{min} = 2\\sqrt{Dr}\n$$\n这就是著名的 Fisher-KPP 方程最小入侵速度公式。\n\n最后，我们使用给定的参数值来计算该速度：$D = 0.5\\,\\text{km}^{2}/\\text{yr}$ 和 $r = 0.2\\,\\text{yr}^{-1}$。\n$$\nv_{min} = 2 \\sqrt{(0.5\\,\\text{km}^{2}/\\text{yr})(0.2\\,\\text{yr}^{-1})} = 2 \\sqrt{0.1\\,\\text{km}^{2}/\\text{yr}^{2}}\n$$\n$$\nv_{min} = 2 \\sqrt{0.1} \\, \\text{km}/\\text{yr} \\approx 2 \\times 0.316227766... \\, \\text{km}/\\text{yr}\n$$\n$$\nv_{min} \\approx 0.632455532... \\, \\text{km}/\\text{yr}\n$$\n按照要求将结果四舍五入到四位有效数字，我们得到 $0.6325\\,\\text{km}/\\text{yr}$。", "answer": "$$\n\\boxed{0.6325}\n$$", "id": "2534611"}, {"introduction": "经典的 Fisher-KPP 模型为我们理解种群扩张提供了基础框架，但其预测的入侵速度 $c = 2\\sqrt{Dr}$ 常常低于真实世界中的观测值。这个矛盾揭示了简化模型与复杂生态现实之间的差距。本练习将挑战您像一名生态理论家一样思考，探讨哪些生物学机制可能打破经典模型的假设，从而导致更快的，甚至是加速的入侵过程 [@problem_id:2534591]。这不仅是一次对理论知识的检验，更是对模型进行批判性评估和拓展能力的训练，帮助您建立对模型假设与其生态学后果之间联系的深刻理解。", "problem": "一个密度为 $u(x,t)$ 的种群正在沿一个近似线性的生境入侵。独立的实验室测量提供了一个低密度人均增长率 $r$ 和一个与菲克扩散（扩散系数为 $D$）相符的有效运动性。在野外，入侵前沿以持续速度 $c_{\\mathrm{emp}}$ 传播，该速度远大于经典的 Fisher–Kolmogorov–Petrovsky–Piskunov 模型在菲克扩散和单调人均增长条件下，通过在 $u \\approx 0$ 处线性化得到的最小速度预测值。经典的 Fisher–Kolmogorov–Petrovsky–Piskunov 模型假设：局部菲克扩散、空间同质性、无整体漂移，以及一个反应项 $f(u)$，该反应项在 $u$ 较小时递增，且其人均增长率 $f(u)/u$ 在 $(0,K)$ 区间上对 $u$ 是非增的（其中 $K$ 为某个环境承载力）。\n\n从第一性原理的视角，请识别出违反至少一个 Fisher–Kolmogorov–Petrovsky–Piskunov 模型假设，并能合理地产生更快，甚至加速的空间扩散的机理（机制）解释，并选择能够捕捉该机理的相应数学上明确的模型修正。选择所有适用项。\n\nA. 持续的定向流（例如风或水流）将个体沿入侵方向平流。将控制方程修改为\n$\\partial_t u + v \\,\\partial_x u = D \\,\\partial_{xx} u + f(u)$\n其中常数漂移速度 $v0$ 与入侵方向一致。\n\nB. 罕见的长距离跳跃扩散，其位移分布为肥尾分布。用非局部扩散代替局部扩散，例如\n$\\partial_t u(x,t) = \\int_{\\mathbb{R}} K(x-y)\\,u(y,t)\\,dy - u(x,t) + f\\big(u(x,t)\\big)$\n其中 $K$ 是一个概率核，其尾部呈代数衰减 $K(z) \\propto |z|^{-1-\\alpha}$（对于某个 $\\alpha \\in (0,2)$），或等价地使用分数阶拉普拉斯算子\n$\\partial_t u = -\\kappa\\,(-\\Delta)^{\\alpha/2} u + f(u)$\n其中 $\\alpha \\in (0,2)$ 且 $\\kappa0$。\n\nC. 在低到中等密度下的正密度依赖性增长（合作效应或弱阿利效应），使得 $f(u)/u$ 在 $u=0$ 附近的某个区间上增加，导致推挤波前沿。使用如下反应项\n$f(u) = r\\,u\\left(1-\\frac{u}{K}\\right)\\big(1+a\\,u\\big)$\n其中 $a0$。\n\nD. 具有严格阈值的强阿利效应，例如\n$f(u) = r\\,u\\left(1-\\frac{u}{K}\\right)\\left(\\frac{u}{A}-1\\right)$\n其中 $A \\in (0,K)$，其前提是，当初始值高于阈值时，它通常会产生比经典 Fisher–Kolmogorov–Petrovsky–Piskunov 模型更快的波。\n\nE. 从扩散模型转换到积分差分模型，使用与扩散步长具有相同方差的薄尾高斯扩散核，例如\n$u_{t+1}(x) = \\int_{\\mathbb{R}} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\!\\left(-\\frac{(x-y)^2}{2\\sigma^2}\\right) f\\big(u_t(y)\\big)\\,dy$，\n其论点是非局部性本身就能确保比经典 Fisher–Kolmogorov–Petrovsky–Piskunov 预测更快的扩散速度。\n\nF. 密度依赖性扩散，在低密度时具有更高的运动性（例如，寻找配偶或避免干扰），因此前缘的有效扩散系数比实验室测定值更大。使用非线性扩散\n$\\partial_t u = \\partial_x\\!\\big(D(u)\\,\\partial_x u\\big) + f(u)$\n其中 $D(u)$ 当 $u \\downarrow 0$ 时减小，因此 $D(0)$ 超过了在中等密度下测量的实验室估计值。", "solution": "问题陈述需经过验证。\n\n**步骤1：提取已知条件**\n- 种群密度：$u(x,t)$\n- 生境：近似线性\n- 低密度人均增长率：$r$\n- 运动性：菲克扩散，系数为 $D$\n- 观测到的入侵速度：$c_{\\mathrm{emp}}$\n- 观测结果：$c_{\\mathrm{emp}}$ 远大于经典的 Fisher–Kolmogorov–Petrovsky–Piskunov (FKPP) 最小速度预测值。\n- FKPP 模型的参考假设：\n    1. 局部菲克扩散：$\\partial_t u = D \\partial_{xx} u + f(u)$\n    2. 空间同质性：$D$ 和 $f(u)$ 的参数为常数。\n    3. 无整体漂移：无平流项。\n    4. 反应项 $f(u)$ 在 $u$ 较小时递增。\n    5. 人均增长率 $f(u)/u$ 在 $(0,K)$ 上对 $u$ 是非增的。\n- FKPP 最小速度是通过在 $u \\approx 0$ 处线性化得到的。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题根植于生物入侵的经典理论，特别是反应扩散方程和著名的 FKPP 模型。现实世界中的入侵速度常常超过朴素 FKPP 预测值的现象是数学生态学中的一个主要课题。列出的待评估潜在机制（平流、阿利效应、非局部扩散、密度依赖性扩散）都是标准的、并被积极研究的课题。该问题在科学上是合理的，事实上是正确的。\n- **适定性**：该问题要求从一个列表中识别出能够解释特定现象的有效机理模型。这是一个概念性问题，基于已建立的数学和生态学理论，有一组确定的正确答案。该问题是适定的。\n- **客观性**：语言技术性强且精确。不存在主观或基于观点的陈述。\n- **完整性与一致性**：问题提供了足够的背景信息，定义了基线模型（FKPP）及其假设，并清楚地陈述了需要解释的差异。已知条件是自洽的。\n\n**步骤3：结论与行动**\n问题陈述有效。它提出了一个理论生态学中标准的、非平凡的问题。现在开始求解过程。\n\n**求解推导**\n该问题关注的是能够产生比经典 FKPP 速度更快的入侵速度的机制。FKPP 方程为 $\\partial_t u = D \\partial_{xx} u + f(u)$，并遵循所列出的假设。关键假设 #5，即 $f(u)/u$ 是非增的，意味着人均增长率在 $u=0$ 时达到最大值。这导致了一个“拉动”行波，其速度由前缘 $u \\approx 0$ 处的线性动力学决定。线性化得到 $\\partial_t u = D \\partial_{xx} u + f'(0) u$。对于 $f'(0)=r$，该方程对任何速度 $c \\ge 2\\sqrt{Dr}$ 都容许行波解。从局部初始数据开始的入侵会选择最小速度，即 $c_{FKPP} = 2\\sqrt{Dr}$。\n\n我们必须分析每个提出的修改，以确定它是否违反了至少一个 FKPP 假设，并能合理地产生一个持续的速度 $c > c_{FKPP}$ 或加速的扩散。\n\n**选项评估**\n\n**A. 持续的定向流（例如风或水流）...**\n提出的模型是 $\\partial_t u + v \\,\\partial_x u = D \\,\\partial_{xx} u + f(u)$，其中 $v0$。\n这个修改违反了 FKPP 的“无整体漂移”假设。为了找到波速，我们可以变换到一个移动坐标系 $\\xi = x - vt$。在此坐标系中，方程变为 $\\partial_{\\tau} \\tilde{u} = D \\,\\partial_{\\xi\\xi} \\tilde{u} + f(\\tilde{u})$，其中 $\\tilde{u}(\\xi, \\tau) = u(x,t)$。这是一个标准的反应扩散方程，其最小入侵速度为 $c_{FKPP} = 2\\sqrt{Dr}$。变换回静止的实验室坐标系，前沿的总速度是在移动介质中的传播速度与介质本身速度之和。\n$c = v + c_{FKPP} = v + 2\\sqrt{Dr}$。\n由于假设 $v0$，所得速度 $c$ 严格大于 $2\\sqrt{Dr}$。这个机制在生态学上是合理的，在数学上是健全的。\n**结论：正确。**\n\n**B. 罕见的长距离跳跃扩散...**\n这个选项用非局部扩散代替了局部扩散，由一个具有肥尾核 $K(z) \\propto |z|^{-1-\\alpha}$（其中 $\\alpha \\in (0,2)$）的积分-微分方程描述，或等价地由一个分数阶扩散方程 $\\partial_t u = -\\kappa\\,(-\\Delta)^{\\alpha/2} u + f(u)$ 描述。\n这违反了“局部菲克扩散”的假设。菲克扩散对应于具有有限方差（薄尾）的扩散核的极限。所提出的核具有无限方差。一个基本结论是，对于具有 KPP 型增长的反应方程，肥尾扩散核不会导致恒速行波。相反，它们会产生一个加速的入侵前沿。前沿的位置通常随时间 $t$ 超线性地变化。由于前沿持续加速，其瞬时速度最终将超过任何恒定值，包括 $c_{FKPP}$。这是一个公认的导致比 FKPP 更快扩散的机制。\n**结论：正确。**\n\n**C. 在低到中等密度下的正密度依赖性增长...**\n这个选项提出了一个反应项 $f(u)$，使得人均增长率 $f(u)/u$ 在 $u$ 较小时是增加的。给出的例子是 $f(u) = r\\,u\\left(1-\\frac{u}{K}\\right)\\big(1+a\\,u\\big)$，其中 $a0$。这描述了一个弱阿利效应。为了使该机制有效，$f(u)/u$ 必须增加，这要求 $\\frac{d}{du}(f(u)/u)|_{u=0}  0$。对于所给的例子，这对应于 $a  1/K$。这违反了 FKPP 的假设 #5，即 $f(u)/u$ 是非增的。当这个条件被违反时，波不再被前端的动力学“拉动”。相反，它被中等密度下更高的增长率“推动”。推挤波的速度由完整的非线性反应项决定，并且严格大于在 $u=0$ 处线性化所预测的速度。即，$c_{pushed}  c_{linear} = 2\\sqrt{Df'(0)} = 2\\sqrt{Dr}$。\n**结论：正确。**\n\n**D. 具有严格阈值的强阿利效应...**\n模型是 $f(u) = r\\,u\\left(1-\\frac{u}{K}\\right)\\left(\\frac{u}{A}-1\\right)$，其中 $A \\in(0,K)$。这代表了一个强阿利效应，即种群在密度阈值 $A$ 以下会下降至灭绝。这里，对于 $u \\in (0,A)$ 有 $f(u)  0$，这意味着 $f'(0) = -r/A  0$。问题陈述中说，实验室测量提供了一个“低密度人均增长率 $r$”，这意味着在 $u$ 较小时测量到了正的增长率。因此，所提出的模型，对于所有小的 $u  0$ 都具有负增长率，与问题陈述中提供的数据不一致。将其波速与 FKPP 速度 $2\\sqrt{Dr}$ 进行比较的前提是不成立的，因为该公式中的 $r$ 必须是 $f'(0)$，而在这里它是负值。这个模型不可能是对给定情景的有效解释。\n**结论：不正确。**\n\n**E. 从扩散模型转换到积分差分模型...**\n这个选项提出用一个离散时间的积分差分方程来代替连续偏微分方程，并使用高斯（薄尾）扩散核。其论点是“非局部性本身就能确保更快的扩散”。这个论点是错误的。非局部扩散的入侵动力学定性性质是由扩散核的尾部权重决定的，而不是非局部性本身。一个薄尾核，如高斯核，其所有矩都是有限的，在适当的极限下，会产生与标准反应扩散方程定性相同的动力学。它将产生一个具有恒定、有限速度的行波。没有先验理由认为这个速度会显著大于其连续时间下的类似物。加速波或推挤波的机制在此并不存在。\n**结论：不正确。**\n\n**F. 密度依赖性扩散，在低密度时具有更高的运动性...**\n提出的模型是 $\\partial_t u = \\partial_x\\!\\big(D(u)\\,\\partial_x u\\big) + f(u)$，违反了扩散系数为常数的假设。该选项将机理（机制）解释为“低密度时有更高的运动性”，这意味着扩散系数 $D(u)$ 是密度 $u$ 的减函数。实验室对 $D$ 的测量是在某个中等密度 $u_{lab}  0$ 下进行的，得到一个值 $D_{lab} = D(u_{lab})$。FKPP 预测将基于这个值：$c_{pred} = 2\\sqrt{D_{lab}r}$。然而，拉动波的速度是由前缘（$u \\to 0$）的参数决定的。因此，入侵前沿的实际速度是 $c_{actual} = 2\\sqrt{D(0)r}$。由于 $D(u)$ 是一个减函数，所以有 $D(0)  D(u_{lab}) = D_{lab}$。因此，$c_{actual}  c_{pred}$。这个机制为观察到的差异提供了一个直接且合理的解释。\n\n注意：该选项的文本“其中 $D(u)$ 当 $u \\downarrow 0$ 时减小”与陈述的机理（“低密度时有更高的运动性”）和结论（“$D(0)$ 超过了在中等密度下测量的实验室估计值”）相矛盾。字面解读意味着 $D(u)$ 是 $u$ 的增函数。该选项是基于预期的科学含义（即 $D(u)$ 是 $u$ 的减函数）进行评估的。\n**结论：正确。**\n\n最终总结：选项 A、B、C 和 F 描述了有效的机理和模型，它们违反了 FKPP 假设，并且能够产生比经典 FKPP 预测更快的入侵动力学。", "answer": "$$\\boxed{ABCF}$$", "id": "2534591"}, {"introduction": "当生境并非连续，而是由离散的斑块构成时，斑块模型（patch models）成为了一种更合适的建模工具。本练习将指导您从连续的反应-扩散世界进入离散的斑块世界，亲手构建一个包含“源-汇”动态（source-sink dynamics）的复合种群模型 [@problem_id:2534600]。通过这个计算实践，您将探索斑块间的连通性如何影响“源”种群对“汇”种群的“救援效应”，并最终决定整个复合种群的持久性。这不仅是编码能力的锻炼，更是将理论概念应用于解决景观生态学和保育生物学中核心问题的具体实践。", "problem": "给定一个空间显式、密度无关的斑块模型。对于每个由 $i \\in \\{0,1,2,3,4\\}$ 索引的斑块，您拥有每个时间步的人均存活率 $s_i$ 和以普查补充量衡量的人均繁殖力 $f_i$。假设采用繁殖后普查，因此局部有限增长率为 $\\lambda_i = s_i + f_i$。定义内禀增长率为 $r_i = \\ln(\\lambda_i)$。如果 $r_i  0$，则斑块为源；如果 $r_i  0$，则为汇。\n\n扩散驱动的定殖由一个连接矩阵 $A(\\alpha)$ 建模，其元素为\n$$\nA_{ij}(\\alpha) = \n\\begin{cases}\n\\exp\\left(-\\dfrac{d_{ij}}{\\alpha}\\right),  \\text{若 } i \\neq j, \\\\\n0,  \\text{若 } i = j,\n\\end{cases}\n$$\n其中 $d_{ij}$ 是斑块 $i$ 和 $j$ 形心之间的欧氏距离，$\\alpha  0$ 是一个扩散长度尺度参数。对于每个斑块 $i$，定殖压力为 $c_i = \\beta \\sum_{j=0}^{4} A_{ij}(\\alpha) p_j$，其中 $p_i \\in [0,1]$ 是斑块 $i$ 在平衡状态下的占据概率，$\\beta  0$ 是一个全局定殖标度。局部灭绝率依赖于斑块类型：如果斑块 $i$ 是源，则 $e_i = e_{\\text{src}}$；如果斑块 $i$ 是汇，则 $e_i = e_{\\text{snk}}$。占据动态遵循经典的斑块占据微分方程\n$$\n\\frac{dp_i}{dt} = \\left(1 - p_i\\right) c_i - e_i p_i,\n$$\n且平衡由不动点条件确定\n$$\np_i = \\frac{c_i}{c_i + e_i} \\quad \\text{其中} \\quad c_i = \\beta \\sum_{j=0}^{4} A_{ij}(\\alpha) p_j.\n$$\n您必须对每个指定的 $\\alpha$ 值，通过不动点迭代求解稳定不动点 $p \\in [0,1]^5$，从任何合理的初始猜测开始，并迭代直到连续迭代之间的无穷范数差小于一个严格的容差。\n\n使用以下数据：\n- 斑块坐标 $(x_i,y_i)$：\n  - 斑块 $0$：$(0.0, 0.0)$\n  - 斑块 $1$：$(1.5, 0.2)$\n  - 斑块 $2$：$(0.8, 1.0)$\n  - 斑块 $3$：$(2.5, 1.7)$\n  - 斑块 $4$：$(3.0, 0.1)$\n- 存活率 $s_i$ 和繁殖力 $f_i$：\n  - $s = [0.70, 0.50, 0.65, 0.40, 0.55]$\n  - $f = [0.60, 0.30, 0.55, 0.35, 0.30]$\n- 定殖标度和灭绝参数：\n  - $\\beta = 0.60$\n  - $e_{\\text{src}} = 0.10$\n  - $e_{\\text{snk}} = 0.50$\n\n您的任务：\n1. 对每个 $i \\in \\{0,1,2,3,4\\}$，计算 $\\lambda_i = s_i + f_i$ 和 $r_i = \\ln(\\lambda_i)$。如果 $r_i  0$，将每个斑块分类为源；如果 $r_i  0$，则分类为汇。将分类表示为一个长度为 $5$ 的整数列表，源为 $1$，汇为 $0$，按斑块索引升序排列。\n2. 对于扩散长度尺度 $\\alpha$ 的每个情景值，求解平衡不动点系统\n   $$\n   p_i = \\frac{\\beta \\sum_{j=0}^{4} A_{ij}(\\alpha) p_j}{\\beta \\sum_{j=0}^{4} A_{ij}(\\alpha) p_j + e_i}\n   $$\n   使用不动点迭代法，无穷范数的严格收敛容差为 $\\varepsilon = 10^{-12}$，并设置 $10^6$ 次迭代的硬上限，以避免在收敛失败时出现非终止情况。使用步骤 1 的分类为每个斑块设置 $e_i$。\n3. 对于每个情景，仅报告汇斑块的占据概率，按斑块索引升序排列，每个概率四舍五入到恰好三位小数。\n\n测试套件：\n- 使用以下四个 $\\alpha$ 值构成测试套件，并评估模型在不同连通性机制下的行为：$\\alpha \\in \\{0.50, 1.00, 2.00, 4.00\\}$。该集合包括一个低连通性案例、两个中等连通性案例和一个高连通性案例。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个外层方括号内的两个项目。\n  1. 第一个项目是长度为 $5$ 的分类列表，其条目在 $\\{0,1\\}$ 中，表示汇（$0$）或源（$1$），按斑块索引顺序 $[0,1,2,3,4]$排列。\n  2. 第二个项目是一个列表的列表，每个内部列表对应一个 $\\alpha$ 值（按 $\\alpha = 0.50, 1.00, 2.00, 4.00$ 的顺序），其中每个内部列表仅包含汇斑块的平衡占据概率，按斑块索引升序排列并四舍五入到三位小数。\n- 例如，最后一行应如下所示：\n  $$\n  [[b_0,b_1,b_2,b_3,b_4],[[q_{1}^{(1)},q_{3}^{(1)},q_{4}^{(1)}],[q_{1}^{(2)},q_{3}^{(2)},q_{4}^{(2)}],[q_{1}^{(3)},q_{3}^{(3)},q_{4}^{(3)}],[q_{1}^{(4)},q_{3}^{(4)},q_{4}^{(4)}]]]\n  $$\n  其中 $b_i \\in \\{0,1\\}$，每个 $q_{k}^{(\\ell)}$ 是一个四舍五入到三位的小数。确保程序仅打印此行，不含多余的空格或文本。\n\n本问题中的所有量都是无单位的，并且是每个时间步的。不涉及角度。所需的答案是如上指定的整数列表和浮点数列表。您的解决方案必须实现为一个完整、可运行的程序。", "solution": "问题陈述已经过验证，被认为是科学上合理、定义明确且自洽的。它提出了一个来自理论生态学的标准斑块占据异质种群模型。所有参数和控制方程都已明确定义。我们将着手进行求解。\n\n该问题需要进行两部分的计算。首先，我们必须根据每个斑块的内禀人口统计学特性将其分类为源或汇。其次，对于一组给定的扩散长度尺度 $\\alpha$，我们必须使用不动点迭代方案求解平衡斑块占据概率 $p_i$。\n\n**第 1 部分：斑块分类**\n\n一个斑块被分类为源还是汇，取决于其内禀增长率 $r_i$。这由每个斑块 $i \\in \\{0, 1, 2, 3, 4\\}$ 的人均存活率 $s_i$ 和人均繁殖力 $f_i$ 导出。对于繁殖后普查模型，局部有限增长率 $\\lambda_i$ 定义为存活率和繁殖力之和：\n$$\n\\lambda_i = s_i + f_i\n$$\n内禀增长率 $r_i$ 是 $\\lambda_i$ 的自然对数：\n$$\nr_i = \\ln(\\lambda_i)\n$$\n如果一个斑块 $i$ 的种群在隔离状态下会增长（$r_i  0$），则其为源；如果会减少（$r_i  0$），则为汇。\n\n给定的数据是：\n- 存活率：$s = [0.70, 0.50, 0.65, 0.40, 0.55]$\n- 繁殖力：$f = [0.60, 0.30, 0.55, 0.35, 0.30]$\n\n我们为每个斑块 $i$ 计算 $\\lambda_i$：\n- $\\lambda_0 = s_0 + f_0 = 0.70 + 0.60 = 1.30$\n- $\\lambda_1 = s_1 + f_1 = 0.50 + 0.30 = 0.80$\n- $\\lambda_2 = s_2 + f_2 = 0.65 + 0.55 = 1.20$\n- $\\lambda_3 = s_3 + f_3 = 0.40 + 0.35 = 0.75$\n- $\\lambda_4 = s_4 + f_4 = 0.55 + 0.30 = 0.85$\n\n接下来，我们计算 $r_i = \\ln(\\lambda_i)$:\n- $r_0 = \\ln(1.30) \\approx 0.262  0 \\implies$ 源\n- $r_1 = \\ln(0.80) \\approx -0.223  0 \\implies$ 汇\n- $r_2 = \\ln(1.20) \\approx 0.182  0 \\implies$ 源\n- $r_3 = \\ln(0.75) \\approx -0.288  0 \\implies$ 汇\n- $r_4 = \\ln(0.85) \\approx -0.163  0 \\implies$ 汇\n\n分类结果，用 $1$ 表示源，$0$ 表示汇，为 $[1, 0, 1, 0, 0]$。\n相应的局部灭绝率 $e_i$ 根据此分类和给定的参数 $e_{\\text{src}} = 0.10$ 和 $e_{\\text{snk}} = 0.50$ 设置：\n$$\ne = [0.10, 0.50, 0.10, 0.50, 0.50]\n$$\n\n**第 2 部分：平衡占据概率**\n\n平衡占据概率 $p = [p_0, p_1, p_2, p_3, p_4]$ 由不动点方程确定：\n$$\np_i = \\frac{c_i}{c_i + e_i}\n$$\n其中定殖压力 $c_i$ 由下式给出\n$$\nc_i = \\beta \\sum_{j=0}^{4} A_{ij}(\\alpha) p_j\n$$\n全局定殖标度为 $\\beta = 0.60$。连接矩阵 $A(\\alpha)$ 依赖于扩散长度尺度 $\\alpha$ 和斑块形心之间的欧氏距离 $d_{ij}$。其元素为 $A_{ij}(\\alpha) = \\exp(-d_{ij}/\\alpha)$（当 $i \\neq j$ 时）和 $A_{ii}(\\alpha) = 0$。\n\n首先，我们使用斑块坐标计算对称距离矩阵 $D$，其中 $D_{ij} = d_{ij}$：\n- $P_0=(0.0, 0.0)$, $P_1=(1.5, 0.2)$, $P_2=(0.8, 1.0)$, $P_3=(2.5, 1.7)$, $P_4=(3.0, 0.1)$。\n这产生诸如 $d_{01} = \\sqrt{(1.5-0.0)^2 + (0.2-0.0)^2} \\approx 1.513$ 的距离。\n\n我们必须为每个指定的 $\\alpha \\in \\{0.50, 1.00, 2.00, 4.00\\}$ 值求解该系统。问题指定使用不动点迭代法。设第 $k$ 次迭代的概率向量为 $p^{(k)}$。下一个迭代 $p^{(k+1)}$ 由映射 $F$ 给出：\n$$\np^{(k+1)} = F(p^{(k)})\n$$\n其中映射的第 $i$ 个分量是：\n$$\n[F(p)]_i = \\frac{\\beta \\sum_{j=0}^{4} A_{ij}(\\alpha) p_j}{\\beta \\sum_{j=0}^{4} A_{ij}(\\alpha) p_j + e_i}\n$$\n对于每个 $\\alpha$，迭代过程如下：\n1.  使用预先计算的距离矩阵 $D$ 计算连接矩阵 $A(\\alpha)$。\n2.  初始化概率向量 $p^{(0)}$。一个避免 $p=0$ 处平凡不动点的合理选择是对于所有 $i$，$p^{(0)}_i = 0.5$。\n3.  迭代 $p^{(k+1)} = F(p^{(k)})$，其中 $k = 0, 1, 2, \\ldots$\n4.  当连续迭代之间的无穷范数差小于容差 $\\varepsilon = 10^{-12}$ 时停止：\n    $$\n    \\|p^{(k+1)} - p^{(k)}\\|_{\\infty} = \\max_i |p_{i}^{(k+1)} - p_{i}^{(k)}|  \\varepsilon\n    $$\n5.  强制执行最大 $10^6$ 次迭代以防止非终止。\n\n一旦迭代收敛到一个不动点 $p^*$，我们提取汇斑块（即斑块 $1$、$3$ 和 $4$）的概率。然后将这些概率（$p_1^*, p_3^*, p_4^*$）四舍五入到三位小数。对测试套件中的每个 $\\alpha$ 重复此过程。\n\n最终输出是一个包含两个元素的列表：斑块分类列表和一个列表的列表，其中每个内部列表包含针对给定 $\\alpha$ 的汇斑块的、四舍五入后的平衡占据概率。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the patch-occupancy model problem as specified.\n\n    1. Classifies patches as sources or sinks.\n    2. For each alpha, solves for equilibrium occupancies using fixed-point iteration.\n    3. Formats the results into the required output string.\n    \"\"\"\n    # Define given parameters\n    coords = np.array([\n        [0.0, 0.0],  # Patch 0\n        [1.5, 0.2],  # Patch 1\n        [0.8, 1.0],  # Patch 2\n        [2.5, 1.7],  # Patch 3\n        [3.0, 0.1]   # Patch 4\n    ])\n    s = np.array([0.70, 0.50, 0.65, 0.40, 0.55])\n    f = np.array([0.60, 0.30, 0.55, 0.35, 0.30])\n    \n    beta = 0.60\n    e_src = 0.10\n    e_snk = 0.50\n    \n    alphas = [0.50, 1.00, 2.00, 4.00]\n    tolerance = 1e-12\n    max_iterations = 1_000_000\n    n_patches = len(coords)\n\n    # --- Task 1: Patch Classification ---\n    lambda_vals = s + f\n    r_vals = np.log(lambda_vals)\n    \n    # Classification: 1 for source (r  0), 0 for sink (r  0)\n    classification = (r_vals  0).astype(int).tolist()\n    \n    # Assign extinction rates based on classification\n    e_rates = np.where(r_vals  0, e_src, e_snk)\n    \n    # Identify indices of sink patches for final reporting\n    sink_indices = np.where(r_vals  0)[0]\n    \n    # --- Pre-computation: Distance Matrix ---\n    dist_matrix = np.zeros((n_patches, n_patches))\n    for i in range(n_patches):\n        for j in range(i, n_patches):\n            dist = np.linalg.norm(coords[i] - coords[j])\n            dist_matrix[i, j] = dist\n            dist_matrix[j, i] = dist\n\n    # --- Task 2  3: Fixed-Point Iteration and Result Collection ---\n    all_sink_occupancies = []\n    \n    for alpha in alphas:\n        # Compute connectivity matrix A(alpha)\n        # We explicitly set a large value where alpha is zero to avoid division by zero,\n        # though the problem states alpha  0. This is just for robustness.\n        # The exponential of a large negative number will be zero.\n        with np.errstate(divide='ignore', invalid='ignore'):\n            A = np.exp(-dist_matrix / alpha)\n        \n        # Diagonal entries are 0\n        np.fill_diagonal(A, 0)\n        \n        # Initialize occupancy probabilities (vector p)\n        # Start with 0.5 to avoid the trivial fixed point at p=0\n        p = np.full(n_patches, 0.5)\n\n        for _ in range(max_iterations):\n            p_old = p.copy()\n            \n            # Calculate colonization pressure (vector c)\n            c = beta * (A @ p_old)\n            \n            # Update occupancy probabilities using the fixed-point equation\n            # p_i = c_i / (c_i + e_i)\n            # Handle c_i + e_i = 0 case, though unlikely as e_i  0\n            denominator = c + e_rates\n            p = np.divide(c, denominator, out=np.zeros_like(c), where=denominator!=0)\n\n            # Check for convergence using the infinity norm\n            if np.linalg.norm(p - p_old, ord=np.inf)  tolerance:\n                break\n        \n        # Extract occupancy probabilities for sink patches\n        sink_p = p[sink_indices]\n        \n        # Round to three decimal places\n        rounded_sink_p = np.round(sink_p, 3).tolist()\n        all_sink_occupancies.append(rounded_sink_p)\n        \n    # --- Final Output Formatting ---\n    # Assemble the final data structure\n    final_result = [classification, all_sink_occupancies]\n    \n    # Convert the result to a string representation without spaces\n    output_str = str(final_result).replace(\" \", \"\")\n    \n    print(output_str)\n\nsolve()\n```", "id": "2534600"}]}