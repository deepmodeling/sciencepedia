{"hands_on_practices": [{"introduction": "环境DNA（eDNA）检测本质上是概率性的；即使目标物种存在，单次采样也可能因为DNA浓度低或随机分布而导致检测失败。本练习将介绍一种基本而关键的策略——重复采样——以将总体检测成功率提高到预期的可靠水平。掌握如何计算所需的重复次数是设计稳健eDNA监测方案的基石。[@problem_id:2488055]", "problem": "一个保护团队正在为某个河段的一种稀有两栖动物设计一项环境脱氧核糖核酸（eDNA）调查。每个水样重复样本都经过过滤、提取，并使用定量聚合酶链式反应（qPCR）进行检测分析。在该物种存在于该河段的条件下，来自给定样本的单个实验室重复样本产生检测结果的概率为 $p$，并且由于使用了独立的等分试样、提取过程和qPCR反应孔，不同的重复样本可被视为独立的伯努利试验。该团队旨在保证在物种存在的条件下，在 $n$ 个独立的重复样本中至少检测到一次该物种的可靠性为 $R$。\n\n1. 仅从独立伯努利试验和概率的补集法则的定义出发，推导出一个关于在 $n$ 个独立重复样本中至少有一次检测的概率的通用表达式（用 $p$ 和 $n$ 表示）。\n\n2. 使用您的表达式，确定当每个重复样本的检测概率 $p = 0.28$ 时，确保可靠性至少为 $R = 0.95$ 的最小整数 $n$。将 $R$ 解释为在物种存在的条件下，在 $n$ 个重复样本中观察到至少一次检测的条件概率。将所需的 $n$ 以一个不带单位的单一数字报告。不要四舍五入到指定的有效数字位数；而是提供满足要求的精确最小整数 $n$。", "solution": "在尝试任何解答之前，首先对问题陈述的有效性进行评估。\n\n**问题验证**\n\n从陈述中逐字提取已知条件：\n1.  单个实验室重复样本产生检测结果的概率为 $p$。\n2.  不同的重复样本是独立的伯努利试验。\n3.  独立重复样本的数量为 $n$。\n4.  团队旨在保证至少检测到一次该物种的可靠性为 $R$。\n5.  第1部分要求仅从独立伯努利试验和补集法则的定义出发，推导出一个关于在 $n$ 个重复样本中至少有一次检测的概率的表达式（用 $p$ 和 $n$ 表示）。\n6.  第2部分要求当 $p = 0.28$ 时，求出使 $R \\geq 0.95$ 的最小整数 $n$。$R$ 被解释为在物种存在的条件下，至少有一次检测的条件概率。\n\n该问题被认定为**有效**。它在科学上基于概率论原理及其在生态调查设计（环境DNA）中的应用。该问题提法恰当，提供了所有必要信息，且不存在矛盾。语言客观，参数（$p=0.28$, $R=0.95$）对于所描述的场景是现实的。该问题需要对基本概念进行标准而严谨的应用，这是一项合理的科学任务。\n\n**求解过程**\n\n将按要求分两部分解决该问题。\n\n**第1部分：检测概率的通用表达式**\n\n设 $D_i$ 为第 $i$ 次重复样本中发生检测的事件，其中 $i \\in \\{1, 2, \\dots, n\\}$。\n根据题意，每次重复样本都是一次伯努利试验。单次试验成功（检测到）的概率为 $p$。\n$$P(D_i) = p$$\n其补集事件 $D_i^c$ 是第 $i$ 次重复样本中未发生检测的事件。该事件的概率根据概率的补集公理得出：\n$$P(D_i^c) = 1 - P(D_i) = 1 - p$$\n我们需要求出在 $n$ 次重复样本中至少有一次检测的概率。设该事件为 $A$。事件 $A$ 是各次检测事件的并集：\n$$A = D_1 \\cup D_2 \\cup \\dots \\cup D_n$$\n为了求出 $P(A)$，使用补集法则更为直接。事件 $A$ 的补集 $A^c$ 是指在 $n$ 次重复样本中均*未*检测到的事件。这等价于各次未检测到事件的交集：\n$$A^c = D_1^c \\cap D_2^c \\cap \\dots \\cap D_n^c$$\n问题陈述中指出，各次重复样本是独立的。根据多个事件独立性的定义，它们交集的概率是它们各自概率的乘积：\n$$P(A^c) = P(D_1^c) \\times P(D_2^c) \\times \\dots \\times P(D_n^c)$$\n由于对所有的 $i=1, \\dots, n$ 都有 $P(D_i^c) = 1 - p$，这个乘积变为：\n$$P(A^c) = \\prod_{i=1}^{n} P(D_i^c) = (1-p)^n$$\n事件 $A$ 的概率通过应用补集法则得到：\n$$P(A) = 1 - P(A^c)$$\n代入我们关于 $P(A^c)$ 的表达式，我们得到在 $n$ 个独立重复样本中至少有一次检测的概率的通用表达式：\n$$P(\\text{至少一次检测}) = 1 - (1-p)^n$$\n\n**第2部分：所需重复样本数量的计算**\n\n可靠性 $R$ 定义为至少有一次检测的概率。我们得到的要求是，当每个重复样本的检测概率 $p = 0.28$ 时，该可靠性必须至少为 $R = 0.95$。我们必须找到满足此条件的最小整数 $n$。\n\n使用第1部分推导出的表达式，该条件可表示为一个不等式：\n$$1 - (1-p)^n \\geq R$$\n代入给定值 $p=0.28$ 和 $R=0.95$：\n$$1 - (1-0.28)^n \\geq 0.95$$\n$$1 - (0.72)^n \\geq 0.95$$\n我们现在求解 $n$。首先，分离含有 $n$ 的项：\n$$-(0.72)^n \\geq 0.95 - 1$$\n$$-(0.72)^n \\geq -0.05$$\n两边同乘以 $-1$。此操作会反转不等号的方向：\n$$(0.72)^n \\leq 0.05$$\n为了求解指数 $n$，我们对两边取自然对数（$\\ln$）。由于自然对数是一个单调递增函数，不等号的方向保持不变。\n$$\\ln\\left((0.72)^n\\right) \\leq \\ln(0.05)$$\n使用对数性质 $\\ln(x^y) = y \\ln(x)$：\n$$n \\ln(0.72) \\leq \\ln(0.05)$$\n为了分离出 $n$，我们必须除以 $\\ln(0.72)$。我们必须首先确定该项的符号。由于 $0 < 0.72 < 1$，其自然对数为负，即 $\\ln(0.72) < 0$。不等式两边同时除以一个负数会再次反转不等号的方向：\n$$n \\geq \\frac{\\ln(0.05)}{\\ln(0.72)}$$\n现在，我们计算右边的表达式：\n$$\\ln(0.05) \\approx -2.99573227355$$\n$$\\ln(0.72) \\approx -0.32850406697$$\n$$n \\geq \\frac{-2.99573227355}{-0.32850406697} \\approx 9.119313$$\n重复样本的数量 $n$ 必须是整数。问题要求满足此条件的最小整数 $n$。由于 $n$ 必须大于或等于约 $9.119$，所以 $n$ 的最小整数值为 $10$。\n\n为了验证，我们可以检查 $n=9$ 和 $n=10$ 时的情况：\n对于 $n=9$：$1 - (0.72)^9 \\approx 1 - 0.05305 \\approx 0.94695$。这小于 $0.95$，因此 $n=9$ 不足够。\n对于 $n=10$：$1 - (0.72)^{10} \\approx 1 - 0.03820 \\approx 0.96180$。这大于 $0.95$，因此 $n=10$ 是足够的。\n\n因此，所需的最小整数重复样本数量为 $10$。", "answer": "$$\\boxed{10}$$", "id": "2488055"}, {"introduction": "在认识到重复采样的重要性之后，现实世界的eDNA调查还必须面对实际限制，其中最常见的就是预算。本练习探讨了一个经典的权衡问题：在总成本固定的情况下，我们应该收集许多小体积样本，还是少量大体积样本？通过构建一个简单的优化模型，您将学习如何量化这一权衡，并做出数据驱动的决策，以在给定的预算内最大化检测概率。[@problem_id:2488009]", "problem": "您正在设计一项环境DNA（eDNA；环境脱氧核糖核酸）调查，目的是在物种存在于某个样点的条件下，最大化检测到该单一目标物种的几率。假设存在以下基本事实和约束条件。\n\n1. 捕获过程：如果目标模板分子的环境浓度使得在采样的水中每升的期望计数为 $\\lambda$，那么根据泊松到达模型，一个体积为 $v$ 升的水样中含有至少一个目标分子的概率为 $1 - \\exp(-\\lambda v)$。\n2. 实验室成功率：每个重复样本都有一个独立的、与体积无关的概率 $s$，使得实验室工作流程（提取、扩增、测序）能成功将捕获到的目标分子转化为可检测的读数。只有当捕获和实验室流程都成功时，一个重复样本才能产生一次检出。\n3. 重复取样：您在同一地点采集 $r$ 个经过相同处理的独立重复样本，每个样本的体积均为 $v$。在物种存在的条件下，这些重复样本是相互独立的。\n4. 预算：总预算为 $B$ 个成本单位。每个重复样本会产生一笔固定设置成本 $c_0$ 和一笔与体积成正比的可变成本 $c_v v$。因此，预算约束为 $r(c_0 + c_v v) \\leq B$。假设在最优情况下，预算将被完全用尽，且 $v>0$。\n\n任务：\na) 仅使用上述陈述和基本概率法则，推导出单个重复样本的检出概率（作为 $v$ 的函数）以及所有重复样本中至少有一次检出的概率（作为 $(r,v)$ 的函数）。然后，利用预算约束消去 $v$，得到一个仅依赖于 $r$ 和参数的目标 $P(r)$。\nb) 给定参数 $\\lambda = 0.1 \\, \\text{L}^{-1}$，$s = 0.5$，$B = 600$ 个成本单位，$c_0 = 40$ 个成本单位，以及 $c_v = 5$ 个成本单位每升，计算可行的正整数 $r$，并确定使目标 $P(r)$ 最大化的整数 $r$。仅报告该最大化整数 $r$。不要包含单位。如果需要进行数值评估，您可以使用任何合理的精度进行计算；由于答案是整数，因此不需要指定四舍五入规则。", "solution": "首先对用户的问题进行验证。\n\n从问题陈述中提取的已知条件：\n- 在体积为 $v$ 的样本中捕获到至少一个目标分子的概率为 $P_{\\text{capture}} = 1 - \\exp(-\\lambda v)$，其中 $\\lambda$ 是每升水中分子的期望计数。\n- 单个重复样本的实验室成功率为 $s$，与其他因素无关。\n- 一次检出需要捕获和实验室流程均成功。\n- 共有 $r$ 个独立的重复样本，每个样本的体积为 $v$。\n- 总预算为 $B$，约束条件为 $r(c_0 + c_v v) \\leq B$，其中 $c_0$ 是每个重复样本的固定成本，$c_v$ 是每升体积的成本。\n- 假设在最优情况下预算被完全用尽，因此 $r(c_0 + c_v v) = B$。\n- 样本体积必须为正，即 $v > 0$。\n- 用于数值评估的参数：$\\lambda = 0.1$ $\\text{L}^{-1}$，$s = 0.5$，$B = 600$，$c_0 = 40$，$c_v = 5$。\n\n验证结论：\n该问题具有科学依据，它使用标准的泊松过程模型进行粒子检测，这适用于模拟eDNA的分布。该问题被构建为一个形式良好的约束优化问题。其语言客观、精确。问题的设定自成体系，没有矛盾。这是一个应用生物统计学和优化领域的有效练习。\n\n开始推导解决方案。\n\n任务 (a)：推导目标函数 $P(r)$。\n\n单个重复样本的检出概率，我们记为 $P_{\\text{rep}}$，是两个独立事件的联合概率：捕获到至少一个分子和实验室流程成功。\n捕获概率给定为 $P_{\\text{capture}}(v) = 1 - \\exp(-\\lambda v)$。\n实验室成功率给定为 $s$。\n因此，单个重复样本的检出概率为：\n$$\nP_{\\text{rep}}(v) = P_{\\text{capture}}(v) \\times s = s(1 - \\exp(-\\lambda v))\n$$\n\n接下来，我们考虑所有 $r$ 个重复样本的总检出概率。问题要求的是至少有一次检出的概率。更直接的方法是先计算其互补事件的概率：在所有 $r$ 个重复样本中均未检出。\n单个重复样本中未检出的概率是 $1 - P_{\\text{rep}}(v)$。\n$$\n1 - P_{\\text{rep}}(v) = 1 - s(1 - \\exp(-\\lambda v))\n$$\n由于 $r$ 个重复样本是独立的，所有 $r$ 个样本均未检出的概率是它们各自未检出概率的乘积：\n$$\nP(\\text{zero detections in } r \\text{ replicates}) = (1 - P_{\\text{rep}}(v))^r = \\left(1 - s(1 - \\exp(-\\lambda v))\\right)^r\n$$\n因此，至少有一次检出的概率，我们记为 $P(r,v)$，是：\n$$\nP(r,v) = 1 - \\left(1 - s(1 - \\exp(-\\lambda v))\\right)^r\n$$\n\n对于(a)部分的最后一步，是利用预算约束消去体积变量 $v$，从而得到一个仅依赖于重复样本数量 $r$ 和给定参数的目标函数 $P(r)$。在最优解处，预算约束被视为等式：\n$$\nr(c_0 + c_v v) = B\n$$\n我们在 $r > 0$ 的条件下解出 $v$。\n$$\nc_0 + c_v v = \\frac{B}{r}\n$$\n$$\nc_v v = \\frac{B}{r} - c_0\n$$\n$$\nv(r) = \\frac{1}{c_v}\\left(\\frac{B}{r} - c_0\\right)\n$$\n为了使 $v$ 具有物理意义，我们必须有 $v > 0$，这意味着 $\\frac{B}{r} - c_0 > 0$，从而得到约束条件 $r < \\frac{B}{c_0}$。\n\n现在，我们将 $v(r)$ 的表达式代入概率函数 $P(r,v)$。指数项变为：\n$$\n-\\lambda v(r) = -\\lambda \\left(\\frac{1}{c_v}\\left(\\frac{B}{r} - c_0\\right)\\right) = -\\frac{\\lambda}{c_v}\\left(\\frac{B}{r} - c_0\\right) = \\frac{\\lambda c_0}{c_v} - \\frac{\\lambda B}{c_v r}\n$$\n将此代入 $P(r,v)$ 的表达式，得到最终的目标函数 $P(r)$：\n$$\nP(r) = 1 - \\left(1 - s\\left(1 - \\exp\\left(\\frac{\\lambda c_0}{c_v} - \\frac{\\lambda B}{c_v r}\\right)\\right)\\right)^r\n$$\n\n任务 (b)：求解最优重复样本数 $r$ 的数值解。\n\n给定参数为：$\\lambda = 0.1$，$s = 0.5$，$B = 600$，$c_0 = 40$，以及 $c_v = 5$。\n\n首先，我们确定整数 $r$ 的可行范围。重复样本数必须是正整数，即 $r \\geq 1$。约束条件 $v > 0$ 要求 $r < \\frac{B}{c_0}$。\n$$\nr < \\frac{600}{40} = 15\n$$\n因此，$r$ 的可行整数集合是 $\\{1, 2, 3, \\dots, 14\\}$。\n\n接下来，我们将参数值代入 $P(r)$ 的表达式中。我们先计算指数中的常数：\n$$\n\\frac{\\lambda c_0}{c_v} = \\frac{0.1 \\times 40}{5} = \\frac{4}{5} = 0.8\n$$\n$$\n\\frac{\\lambda B}{c_v} = \\frac{0.1 \\times 600}{5} = \\frac{60}{5} = 12\n$$\n目标函数变为：\n$$\nP(r) = 1 - \\left(1 - 0.5\\left(1 - \\exp\\left(0.8 - \\frac{12}{r}\\right)\\right)\\right)^r\n$$\n可以通过简化幂的底数来重写此式：\n$$\n1 - 0.5(1 - \\exp(\\dots)) = 1 - 0.5 + 0.5\\exp(\\dots) = 0.5 + 0.5\\exp(\\dots)\n$$\n所以，\n$$\nP(r) = 1 - \\left(0.5 + 0.5 \\exp\\left(0.8 - \\frac{12}{r}\\right)\\right)^r\n$$\n我们的任务是找到使该函数最大化的整数 $r \\in \\{1, 2, \\dots, 14\\}$。我们对每个可行的 $r$ 值计算 $P(r)$。\n\n- 当 $r=1$ 时: $P(1) = 1 - (0.5 + 0.5 \\exp(0.8 - 12))^{1} = 1 - (0.5 + 0.5 \\exp(-11.2)) \\approx 0.49999$\n- 当 $r=2$ 时: $P(2) = 1 - (0.5 + 0.5 \\exp(0.8 - 6))^{2} = 1 - (0.5 + 0.5 \\exp(-5.2))^{2} \\approx 0.74718$\n- 当 $r=3$ 时: $P(3) = 1 - (0.5 + 0.5 \\exp(0.8 - 4))^{3} = 1 - (0.5 + 0.5 \\exp(-3.2))^{3} \\approx 0.85906$\n- 当 $r=4$ 时: $P(4) = 1 - (0.5 + 0.5 \\exp(0.8 - 3))^{4} = 1 - (0.5 + 0.5 \\exp(-2.2))^{4} \\approx 0.90477$\n- 当 $r=5$ 时: $P(5) = 1 - (0.5 + 0.5 \\exp(0.8 - 2.4))^{5} = 1 - (0.5 + 0.5 \\exp(-1.6))^{5} \\approx 0.92183$\n- 当 $r=6$ 时: $P(6) = 1 - (0.5 + 0.5 \\exp(0.8 - 2))^{6} = 1 - (0.5 + 0.5 \\exp(-1.2))^{6} \\approx 0.92411$\n- 当 $r=7$ 时: $P(7) = 1 - (0.5 + 0.5 \\exp(0.8 - 12/7))^{7} \\approx 1 - (0.5 + 0.5 \\exp(-0.914))^{7} \\approx 0.91817$\n- 当 $r=8$ 时: $P(8) = 1 - (0.5 + 0.5 \\exp(0.8 - 1.5))^{8} \\approx 1 - (0.5 + 0.5 \\exp(-0.7))^{8} \\approx 0.90659$\n\n概率值在 $r=6$ 之前持续增加，之后开始下降。\n$P(5) \\approx 0.92183$\n$P(6) \\approx 0.92411$\n$P(7) \\approx 0.91817$\n检出概率 $P(r)$ 的最大值出现在 $r=6$ 处。在这个值上，增加重复样本数量 $r$ 与减少每个重复样本的体积 $v$ 之间的权衡达到了最优。当重复样本较少时（例如，$r=5$），体积 $v$ 会更大，这会提高单个重复样本的成功率，但较少的重复次数使得总体检出可能性更低。当重复样本较多时（例如，$r=7$），体积 $v$ 变得过小，导致单个重复样本的成功率急剧下降，以至于即使有更多的重复样本也无法弥补。\n\n使目标函数 $P(r)$ 最大化的整数是 $6$。", "answer": "$$\n\\boxed{6}\n$$", "id": "2488009"}, {"introduction": "设计并执行采样方案后，最后一步是解读结果。一个阳性的eDNA信号是物种存在的有力证据，但并非绝对可靠，因为存在假阳性（如样本污染）的可能性。本练习将运用贝叶斯定理，将关于物种占有率的先验知识与检测方法的灵敏度和特异性相结合，从而在获得阳性结果后，定量计算出物种真实存在的后验概率。[@problem_id:2488011]", "problem": "一项环境DNA采样活动旨在调查某河段内的一种隐秘鱼类。根据往年的分层占域分析，该物种在采样时真正占据该河段的先验概率为 $0.35$。对一份水样进行单基因座定量聚合酶链式反应（qPCR）检测。当检测在该单基因座上返回超过阈值的扩增信号时，记录为阳性检测结果。当该物种存在时，检测过程包括两个连续且必需的阶段：首先，在野外采集过程中，滤膜上捕获到至少一个目标DNA分子；其次，在qPCR过程中成功扩增目标基因座。在物种真实存在的条件下，捕获到至少一个分子的概率为 $0.70$；在捕获成功的条件下，qPCR成功扩增目标的概率为 $0.90$。假设在物种真实存在的条件下，这两个阶段是条件独立的。当该物种真实不存在时，阳性结果只能通过假阳性机制（例如，样品交叉污染或非特异性扩增）产生，这些机制共同导致单一样本的单基因座检测的假阳性概率为 $0.004$（等效于特异性为 $0.996$）。假设假阳性机制与物种存在过程相互独立。本次检测对该样本得出了阳性结果。\n\n从条件概率和全概率定律的基本定义出发，计算在得到这一阳性结果的情况下，该物种真实存在的后验概率。最终答案以小数形式表示，无单位，并四舍五入至四位有效数字。", "solution": "该问题要求计算后验概率，这是贝叶斯定理的直接应用。在继续之前，必须验证问题陈述的科学性和逻辑一致性。\n\n该问题是贝叶斯推断中的一个定义明确的练习，贝叶斯推断是包括生态学在内的科学学科中现代统计分析的基石。它在科学上基于环境DNA（eDNA）方法论、物种检测和概率建模的原理。所有必要的数据均已提供，且没有矛盾之处。\n\n我们定义以下事件：\n- $A$: 隐秘鱼类物种真实存在于该河段的事件。\n- $A^c$: 该物种真实不存在于该河段的事件。这是事件 $A$ 的补集。\n- $B$: qPCR检测得出阳性结果的事件。\n\n问题给出了以下概率，即已知条件：\n- 物种存在的先验概率：$P(A) = 0.35$。\n- 假阳性概率，即在物种不存在的情况下得到阳性结果的概率：$P(B|A^c) = 0.004$。\n\n从存在的先验概率，我们可以推导出不存在的先验概率：\n$$\nP(A^c) = 1 - P(A) = 1 - 0.35 = 0.65\n$$\n\n在物种真实存在（$A$）的条件下，检测过程包括两个连续且条件独立的阶段。设 $C$ 为捕获到至少一个目标DNA分子的事件，设 $D$ 为qPCR成功扩增的事件。在存在 $A$ 的情况下，要得到阳性结果 $B$，需要 $C$ 和 $D$ 同时发生。问题提供了：\n- 在物种存在的条件下，捕获的概率：$P(C|A) = 0.70$。\n- 在捕获成功且物种存在的条件下，扩增的概率：$P(D|C, A) = 0.90$。\n\n因为在物种存在的条件下这两个阶段是条件独立的，所以物种真实存在时得到阳性结果的概率 $P(B|A)$ 是这两个连续阶段概率的乘积：\n$$\nP(B|A) = P(C|A) \\times P(D|C, A) = 0.70 \\times 0.90 = 0.63\n$$\n这个值 $P(B|A)$ 是整个检测过程（包括野外采样和实验室分析）的灵敏度。\n\n我们被要求计算在检测得出阳性结果的情况下，物种真实存在的后验概率。这就是条件概率 $P(A|B)$。我们将使用贝叶斯定理，其定义如下：\n$$\nP(A|B) = \\frac{P(B|A) P(A)}{P(B)}\n$$\n分母 $P(B)$ 是得到阳性结果的全概率。这可以使用全概率定律，通过根据物种的存在（$A$）或不存在（$A^c$）来划分事件空间来计算：\n$$\nP(B) = P(B|A) P(A) + P(B|A^c) P(A^c)\n$$\n将已知值代入此表达式：\n$$\nP(B) = (0.63)(0.35) + (0.004)(0.65)\n$$\n首先，我们计算各个项：\n$$\nP(B|A) P(A) = 0.63 \\times 0.35 = 0.2205\n$$\n$$\nP(B|A^c) P(A^c) = 0.004 \\times 0.65 = 0.0026\n$$\n现在，我们将这些项相加，求出阳性结果的全概率：\n$$\nP(B) = 0.2205 + 0.0026 = 0.2231\n$$\n计算出所有分量后，我们现在可以将它们代入贝叶斯定理，以求得后验概率 $P(A|B)$：\n$$\nP(A|B) = \\frac{P(B|A) P(A)}{P(B)} = \\frac{0.2205}{0.2231}\n$$\n进行最后的除法运算：\n$$\nP(A|B) \\approx 0.988346033169...\n$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $9$、$8$、$8$ 和 $3$。第五位有效数字是 $4$，小于 $5$，因此我们向下舍入。\n$$\nP(A|B) \\approx 0.9883\n$$\n这就是在环境DNA检测结果为阳性的情况下，该物种真实存在的后验概率。", "answer": "$$\\boxed{0.9883}$$", "id": "2488011"}]}