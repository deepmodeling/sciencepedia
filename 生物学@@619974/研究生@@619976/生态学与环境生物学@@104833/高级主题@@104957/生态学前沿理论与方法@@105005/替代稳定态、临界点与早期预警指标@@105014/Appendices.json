{"hands_on_practices": [{"introduction": "在我们寻找临界慢化 (critical slowing down) 的微妙迹象之前，我们必须首先处理数据中更明显的模式。生态时间序列常常受到强烈的季节性周期和长期趋势的主导，这些模式可能会模仿或掩盖真实的预警指标。这个练习提供了一个直接的动手实践机会，让您了解这些确定性成分是如何夸大关键指标的，并学习实施一个稳健的预处理流程来移除它们，这是任何时间序列分析的基本技能。[@problem_id:2470755]", "problem": "要求您在一个数学上受控的模拟中，演示强烈的季节性周期如何夸大方差和滞后一阶自相关，并实现一个预处理流程，在计算预警指标之前移除此类季节性和低频分量。您编写的程序必须从基本原理出发，实现以下规范。\n\n考虑一个离散时间序列 $\\{x_t\\}_{t=1}^{T}$，它由三个分量的加性组合而成：一个线性趋势、一个正弦季节性分量和一个自回归噪声项。对于每个测试用例，根据以下数据生成过程来生成该序列\n$$\n\\varepsilon_t = \\rho \\,\\varepsilon_{t-1} + \\eta_t,\\quad \\eta_t \\sim \\mathcal{N}(0,\\sigma^2),\\quad \\varepsilon_0 = 0,\n$$\n$$\nx_t = \\mu + \\beta\\,(t-1) + A \\sin\\!\\Big( 2\\pi \\,\\frac{t}{P} + \\phi_0 \\Big) + \\varepsilon_t,\n$$\n其中 $t \\in \\{1,2,\\dots,T\\}$。三角函数中使用的所有角度都必须是弧度。对于所有测试用例，取 $\\mu=0$。\n\n定义样本均值为 $\\bar{x} = \\frac{1}{T}\\sum_{t=1}^T x_t$。定义样本方差为\n$$\ns^2(x) = \\frac{1}{T-1}\\sum_{t=1}^T \\big(x_t - \\bar{x}\\big)^2,\n$$\n以及滞后一阶自相关为\n$$\nr_1(x) = \\frac{\\sum_{t=1}^{T-1} \\big(x_{t} - \\bar{x}\\big)\\big(x_{t+1} - \\bar{x}\\big)}{\\sum_{t=1}^{T-1} \\big(x_{t} - \\bar{x}\\big)^2}.\n$$\n\n实现一个基于普通最小二乘法的预处理流程，该流程移除一个常数、一个线性趋势和一个已知周期为 $P$ 的单一正弦谐波：\n- 构建一个设计矩阵，其列为 $1$、$t$、$\\sin\\!\\big(2\\pi t/P\\big)$ 和 $\\cos\\!\\big(2\\pi t/P\\big)$，其中 $t=1,\\dots,T$。\n- 使用最小二乘法将 $x_t$ 拟合到此设计上，并计算残差 $r_t = x_t - \\widehat{x}_t$。\n- 从残差序列 $\\{r_t\\}$ 计算 $s^2(r)$ 和 $r_1(r)$。\n\n为量化季节性和趋势对指标的夸大程度，计算：\n- 方差比 $R_{\\mathrm{var}} = \\dfrac{s^2(x)}{\\max\\{s^2(r),\\epsilon\\}}$，其中 $\\epsilon = 10^{-12}$。\n- 自相关幅值比 $R_{\\mathrm{ac}} = \\dfrac{|r_1(x)| + \\delta}{|r_1(r)| + \\delta}$，其中 $\\delta = 10^{-8}$。\n\n您的程序必须对以下五个测试用例执行这些计算。每个测试用例都是一个元组 $(T,P,A,\\sigma,\\rho,\\beta,\\phi_0,\\mathrm{seed})$，其中除种子是整数外，所有参数都是实数值。使用给定的种子初始化伪随机数生成器，以使生成的 $\\eta_t$ 是可复现的。这五个测试用例是：\n- 用例1（带有强季节性的理想路径）：$(\\,1000,\\,50.0,\\,2.0,\\,1.0,\\,0.2,\\,0.0,\\,0.3,\\,123\\,)$。\n- 用例2（无季节性对照）：$(\\,1000,\\,50.0,\\,0.0,\\,1.0,\\,0.2,\\,0.0,\\,0.0,\\,456\\,)$。\n- 用例3（非整数周期）：$(\\,1000,\\,73.5,\\,2.0,\\,1.0,\\,0.2,\\,0.0,\\,1.0,\\,789\\,)$。\n- 用例4（添加了线性趋势）：$(\\,1000,\\,50.0,\\,1.5,\\,1.0,\\,0.2,\\,0.005,\\,2.0,\\,101112\\,)$。\n- 用例5（高噪声、弱季节性、弱自相关）：$(\\,1000,\\,40.0,\\,0.5,\\,3.0,\\,0.05,\\,0.0,\\,0.7,\\,131415\\,)$。\n\n对于每个测试用例，按以下顺序计算并返回一个包含四个浮点数的列表：\n- $R_{\\mathrm{var}}$,\n- $R_{\\mathrm{ac}}$,\n- $r_1(x)$,\n- $r_1(r)$.\n\n使用标准的四舍五入，将每个浮点数精确到 $6$ 位小数。您的程序应生成单行输出，其中包含所有测试用例的结果，形式为一个用方括号括起来的逗号分隔列表，其中每个元素是对应于一个测试用例的四个数字的列表。例如，一个有效的输出格式是\n$$\n\\big[\\,[R_{\\mathrm{var}}^{(1)},R_{\\mathrm{ac}}^{(1)},r_1(x)^{(1)},r_1(r)^{(1)}],\\dots,[R_{\\mathrm{var}}^{(5)},R_{\\mathrm{ac}}^{(5)},r_1(x)^{(5)},r_1(r)^{(5)}]\\,\\big].\n$$\n\n注意事项和约束：\n- 每个测试用例使用独立的随机流，且仅使用提供的种子来初始化随机性。\n- 正弦波使用弧度作为角度单位，即项 $2\\pi t / P + \\phi_0$ 以弧度为单位。\n- 不涉及物理单位；按规定报告纯数字。\n- 不要使用任何外部数据；所有计算必须基于提供的参数进行。\n- 在计算比率时使用指定的 $\\epsilon$ 和 $\\delta$ 以确保数值稳定性。", "solution": "所提出的问题在科学上是合理的，在数学上是明确定义的。它涉及时间序列分析中的一项关键任务，特别是在生态学等领域，在这些领域中，潜在的趋势和季节性周期可能会掩盖或人为地夸大临界转变的预警信号。我们将严谨地、一步步地实现所要求的模拟和分析流程。\n\n问题的核心是演示确定性分量（特别是线性趋势和正弦季节性周期）如何影响时间序列的样本方差和滞后一阶自相关。这些统计指标常被用于监测“临界慢化”的迹象，这是一种系统达到临界点之前出现的现象。然而，只有在移除了混淆信号后，这些指标的值才是可靠的。通过普通最小二乘法 (OLS) 进行去趋势和去季节性的指定程序是实现此目的的标准方法。\n\n对于由参数集 $(T,P,A,\\sigma,\\rho,\\beta,\\phi_0,\\mathrm{seed})$ 定义的每个测试用例，将按如下方式执行分析。\n\n首先，我们生成时间序列 $\\{x_t\\}_{t=1}^{T}$。这包括两个阶段。\n\n1.  **生成自回归噪声过程**：噪声分量 $\\varepsilon_t$ 是一个 AR(1) 过程。我们用给定的整数 `seed` 初始化伪随机数生成器以确保可复现性。序列 $\\{\\eta_t\\}_{t=1}^T$ 从正态分布 $\\mathcal{N}(0,\\sigma^2)$ 中抽取。然后通过迭代生成 AR(1) 序列：\n    $$\n    \\varepsilon_t = \\rho \\,\\varepsilon_{t-1} + \\eta_t\n    $$\n    初始条件为 $\\varepsilon_0 = 0$。\n\n2.  **构建完整时间序列**：最终的时间序列 $x_t$ 是线性趋势、季节性分量和噪声过程 $\\varepsilon_t$ 的加性组合。给定 $\\mu=0$，模型为：\n    $$\n    x_t = \\beta\\,(t-1) + A \\sin\\!\\Big( 2\\pi \\,\\frac{t}{P} + \\phi_0 \\Big) + \\varepsilon_t\n    $$\n    其中 $t \\in \\{1, 2, \\dots, T\\}$。所有角度都以弧度计算。\n\n其次，我们计算原始时间序列 $\\{x_t\\}$ 的统计指标。\n\n1.  **样本均值**：$\\bar{x} = \\frac{1}{T}\\sum_{t=1}^T x_t$。\n2.  **样本方差**：$s^2(x) = \\frac{1}{T-1}\\sum_{t=1}^T \\big(x_t - \\bar{x}\\big)^2$。这是标准的无偏样本方差。\n3.  **滞后-1 自相关**：我们使用提供的特定公式：\n    $$\n    r_1(x) = \\frac{\\sum_{t=1}^{T-1} \\big(x_{t} - \\bar{x}\\big)\\big(x_{t+1} - \\bar{x}\\big)}{\\sum_{t=1}^{T-1} \\big(x_{t} - \\bar{x}\\big)^2}\n    $$\n    需要注意的是，分母的求和范围只到 $T-1$，这与样本自相关函数最常见的定义有所不同，但它仍然是一个明确定义的量，我们将完全按照规定来实现。\n\n第三，我们应用预处理流程来移除趋势和季节性分量。这是通过普通最小二乘 (OLS) 回归实现的。\n\n1.  **构建设计矩阵**：回归模型旨在捕获一个常数偏移、一个线性趋势和一个周期为 $P$ 的正弦分量。一个具有任意相位 $\\phi_0$ 的正弦波可以表示为正弦和余弦函数的线性组合。因此，模型是：\n    $$\n    x_t = c_0 \\cdot 1 + c_1 \\cdot t + c_2 \\sin(2\\pi t/P) + c_3 \\cos(2\\pi t/P) + r_t\n    $$\n    我们构建一个大小为 $T \\times 4$ 的设计矩阵 $\\mathbf{X}$，其中第 $t$ 行由 $[1, t, \\sin(2\\pi t/P), \\cos(2\\pi t/P)]$ 给出。观测向量为 $\\mathbf{x} = [x_1, \\dots, x_T]^T$。\n\n2.  **解正规方程**：系数向量 $\\mathbf{c} = [c_0, c_1, c_2, c_3]^T$ 的 OLS 估计值通过求解正规方程 $\\mathbf{X}^T \\mathbf{X} \\mathbf{c} = \\mathbf{X}^T \\mathbf{x}$ 得到。解为 $\\hat{\\mathbf{c}} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{x}$。在数值计算上，最好使用一种稳定的算法来求解，例如基于 QR 分解的算法，`scipy.linalg.lstsq` 就提供了这种算法。\n\n3.  **计算残差**：拟合值为 $\\hat{x}_t = \\hat{c}_0 + \\hat{c}_1 t + \\hat{c}_2 \\sin(2\\pi t/P) + \\hat{c}_3 \\cos(2\\pi t/P)$，或者用矩阵形式表示为 $\\hat{\\mathbf{x}} = \\mathbf{X} \\hat{\\mathbf{c}}$。残差序列为 $\\{r_t\\}$，其中 $r_t = x_t - \\hat{x}_t$。该序列表示减去估计的趋势和季节性分量后剩余的信号。\n\n第四，我们计算残差序列 $\\{r_t\\}$ 的统计指标。根据带有截距项的 OLS 的构造，残差的均值 $\\bar{r}$ 保证为零（或在数值上与其无法区分）。方差 $s^2(r)$ 和自相关 $r_1(r)$ 使用与 $x_t$ 相同的公式计算，只需将 $x_t$ 替换为 $r_t$，并将 $\\bar{x}$ 替换为 $\\bar{r}=0$。\n\n最后，我们通过计算指定的比率来量化指标的夸大程度。\n\n1.  **方差比**：$R_{\\mathrm{var}} = \\dfrac{s^2(x)}{\\max\\{s^2(r),\\epsilon\\}}$，稳定化常数为 $\\epsilon = 10^{-12}$。\n2.  **自相关幅值比**：$R_{\\mathrm{ac}} = \\dfrac{|r_1(x)| + \\delta}{|r_1(r)| + \\delta}$，稳定化常数为 $\\delta = 10^{-8}$。\n\n对于每个测试用例，程序将计算并报告列表 $[R_{\\mathrm{var}}, R_{\\mathrm{ac}}, r_1(x), r_1(r)]$，每个值都四舍五入到 $6$ 位小数。所有测试用例的结果将被汇总到一个最终的列表的列表中。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import lstsq\n\ndef solve():\n    \"\"\"\n    Solves the time series analysis problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # (T, P, A, sigma, rho, beta, phi_0, seed)\n        (1000, 50.0, 2.0, 1.0, 0.2, 0.0, 0.3, 123),\n        (1000, 50.0, 0.0, 1.0, 0.2, 0.0, 0.0, 456),\n        (1000, 73.5, 2.0, 1.0, 0.2, 0.0, 1.0, 789),\n        (1000, 50.0, 1.5, 1.0, 0.2, 0.005, 2.0, 101112),\n        (1000, 40.0, 0.5, 3.0, 0.05, 0.0, 0.7, 131415),\n    ]\n\n    # Stabilization constants\n    epsilon = 1e-12\n    delta = 1e-8\n    \n    final_results = []\n\n    for case in test_cases:\n        T, P, A, sigma, rho, beta, phi_0, seed = case\n        \n        # 1. Generate the time series\n        rng = np.random.default_rng(seed)\n        eta = rng.normal(0, sigma, T)\n        \n        epsilon_t = np.zeros(T)\n        # AR(1) process generation\n        # epsilon_t[0] is based on epsilon_t[-1] which is 0.\n        # So we can write a clean loop.\n        # The problem statement has epsilon_0 = 0.\n        # Our time index t is from 1 to T, corresponding to array index 0 to T-1.\n        # So epsilon_t for t=1 (index 0) uses epsilon_0=0.\n        # epsilon_t[0] = rho * 0 + eta[0]\n        epsilon_t[0] = eta[0]\n        for t_idx in range(1, T):\n            epsilon_t[t_idx] = rho * epsilon_t[t_idx - 1] + eta[t_idx]\n\n        t_vec = np.arange(1, T + 1)\n        \n        trend = beta * (t_vec - 1)\n        seasonal = A * np.sin(2 * np.pi * t_vec / P + phi_0)\n        x_t = trend + seasonal + epsilon_t\n\n        # 2. Analyze the raw series x_t\n        x_mean = np.mean(x_t)\n        s2_x = np.var(x_t, ddof=1)\n        \n        # Lag-1 autocorrelation for x_t as per problem definition\n        num_r1_x = np.sum((x_t[:-1] - x_mean) * (x_t[1:] - x_mean))\n        den_r1_x = np.sum((x_t[:-1] - x_mean)**2)\n        r1_x = num_r1_x / den_r1_x if den_r1_x != 0 else 0.0\n        \n        # 3. Preprocessing via OLS\n        # Construct design matrix\n        X_design = np.empty((T, 4))\n        X_design[:, 0] = 1.0  # Constant\n        X_design[:, 1] = t_vec # Linear trend\n        X_design[:, 2] = np.sin(2 * np.pi * t_vec / P) # Seasonal (sin)\n        X_design[:, 3] = np.cos(2 * np.pi * t_vec / P) # Seasonal (cos)\n        \n        # Perform OLS\n        coeffs, _, _, _ = lstsq(X_design, x_t)\n        \n        # Compute residuals\n        x_hat = X_design @ coeffs\n        r_t = x_t - x_hat\n        \n        # 4. Analyze the residual series r_t\n        r_mean = np.mean(r_t)  # Should be near zero\n        s2_r = np.var(r_t, ddof=1)\n        \n        # Lag-1 autocorrelation for r_t\n        num_r1_r = np.sum((r_t[:-1] - r_mean) * (r_t[1:] - r_mean))\n        den_r1_r = np.sum((r_t[:-1] - r_mean)**2)\n        r1_r = num_r1_r / den_r1_r if den_r1_r != 0 else 0.0\n        \n        # 5. Compute inflation ratios\n        R_var = s2_x / max(s2_r, epsilon)\n        R_ac = (abs(r1_x) + delta) / (abs(r1_r) + delta)\n        \n        # Aggregate results for this case\n        result_list = [R_var, R_ac, r1_x, r1_r]\n        final_results.append(result_list)\n\n    # 6. Format and print the final output\n    sublist_strings = []\n    for row in final_results:\n        # Format each number to 6 decimal places and join into a string like \"[v1,v2,v3,v4]\"\n        formatted_row = ','.join([f'{v:.6f}' for v in row])\n        sublist_strings.append(f'[{formatted_row}]')\n        \n    final_output_string = f\"[{','.join(sublist_strings)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "2470755"}, {"introduction": "一旦移除了确定性趋势，一个更微妙的挑战便浮现出来：如何将生态系统的真实动态与观测过程本身引入的噪声分离开来。如果忽略这种测量误差，直接将模型应用于观测数据，可能会导致对关键参数（如自回归系数 $\\phi$）的估计产生系统性偏差。此练习要求您从第一性原理推导这种偏差，并介绍功能强大的状态空间模型和卡尔曼滤波器，它们是从含噪观测中正确估计潜在过程参数的标准工具。[@problem_id:2470759]", "problem": "在一个接近临界点的湖泊富营养化系统中，潜在生态状态变量 $x_t$（例如，反映内部反馈的对数叶绿素浓度）据推测会表现出临界慢化现象，该现象可由一个1阶自回归($\\mathrm{AR}$)动态过程概括：$x_t = \\phi x_{t-1} + w_t$，其中 $| \\phi | < 1$。过程新息 $w_t$ 是独立同分布的高斯变量，均值为 $0$，方差为 $\\sigma_w^2$，记为 $w_t \\sim \\mathcal{N}(0,\\sigma_w^2)$。观测是有噪声的：$y_t = x_t + \\epsilon_t$，其中独立的 $\\epsilon_t \\sim \\mathcal{N}(0,\\tau^2)$ 且与 $\\{w_s\\}_{s \\in \\mathbb{Z}}$ 独立。这种测量误差在生态监测中很常见，并且可能会使基于持续性的预警指标 (EWI) 产生偏误。\n\n假设一位实践者忽略观测误差，并使用普通最小二乘法($\\mathrm{OLS}$)通过对 $y_{t-1}$ 回归 $y_t$（无截距项）来估计持续性。令 $\\widehat{\\phi}_{\\text{naive}}$ 表示由此得到的斜率估计量。假设 $\\{x_t\\}$ 和 $\\{y_t\\}$ 满足严平稳性和遍历性，并仅使用协方差、方差和自回归的基本定义以及大数定律，将样本矩与其总体对应量联系起来。不要调用任何关于衰减偏误的现成公式；相反，应从第一性原理出发进行推导。\n\n任务A（渐近伪真参数的推导）：以闭式形式推导概率极限 $\\phi^{\\dagger}(\\phi,\\sigma_w^2,\\tau^2) = \\lim_{T \\to \\infty} \\widehat{\\phi}_{\\text{naive}}$，将其表示为真实自回归系数 $\\phi$、过程噪声方差 $\\sigma_w^2$ 和观测误差方差 $\\tau^2$ 的函数。您的推导应从平稳 $\\mathrm{AR}(1)$ 过程的方差和协方差的定义方程以及噪声的独立性结构开始。将最终答案表示为单个闭式解析表达式。无需四舍五入，也无需报告单位。\n\n任务B（用于校正偏误的状态估计）：构建该系统所蕴含的线性高斯状态空间模型，并写出卡尔曼滤波器 (KF) 的时间更新（预测）和测量更新（校正）递归式，包括误差方差的里卡蒂递归式。推导后验误差方差的稳态标量代数里卡蒂方程以及相应的稳态卡尔曼增益，将它们表示为 $\\phi$、$\\sigma_w^2$ 和 $\\tau^2$ 的函数。您无需以闭式形式求解此方程。\n\n答案规格：仅报告表达式 $\\phi^{\\dagger}(\\phi,\\sigma_w^2,\\tau^2)$ 作为您的最终答案。最终答案框中不应包含任何数值近似、单位或附加文本。", "solution": "我们从一个受临界点附近生态动态启发的线性高斯状态空间模型开始。潜在状态 $x_t$ 根据一个1阶自回归($\\mathrm{AR}(1)$)过程演化，\n$$\nx_t = \\phi x_{t-1} + w_t, \\quad w_t \\sim \\mathcal{N}(0,\\sigma_w^2), \\quad | \\phi | < 1,\n$$\n其中 $w_t$ 在时间上是独立的。观测过程为\n$$\ny_t = x_t + \\epsilon_t, \\quad \\epsilon_t \\sim \\mathcal{N}(0,\\tau^2),\n$$\n其中 $\\epsilon_t$ 在时间上是独立的，并且与 $\\{w_s\\}_{s \\in \\mathbb{Z}}$ 和 $\\{x_s\\}_{s \\in \\mathbb{Z}}$ 独立。\n\n任务A。我们的目标是计算在无截距项的情况下，将 $y_t$ 对 $y_{t-1}$ 进行回归的朴素普通最小二乘法($\\mathrm{OLS}$)估计量的概率极限。在严平稳性和遍历性条件下，并且假定二阶矩是有限的，根据大数定律，样本协方差和方差收敛于其总体对应量。对于零均值情况，$\\mathrm{OLS}$ 斜率收敛于以下比率\n$$\n\\phi^{\\dagger} = \\lim_{T \\to \\infty} \\widehat{\\phi}_{\\text{naive}} = \\frac{\\operatorname{Cov}(y_t,y_{t-1})}{\\operatorname{Var}(y_{t-1})}.\n$$\n我们使用模型结构从第一性原理计算分子和分母。\n\n首先，计算 $\\{x_t\\}$ 的方差和滞后1阶协方差。对于一个满足 $| \\phi | < 1$ 的平稳 $\\mathrm{AR}(1)$ 过程，我们有\n$$\n\\operatorname{Var}(x_t) = \\gamma_x(0), \\quad \\operatorname{Cov}(x_t,x_{t-1}) = \\gamma_x(1).\n$$\n使用定义递归式 $x_t = \\phi x_{t-1} + w_t$ 以及 $x_{t-1}$ 和 $w_t$ 之间的独立性，\n$$\n\\gamma_x(0) = \\operatorname{Var}(x_t) = \\operatorname{Var}(\\phi x_{t-1} + w_t) = \\phi^2 \\operatorname{Var}(x_{t-1}) + \\operatorname{Var}(w_t) = \\phi^2 \\gamma_x(0) + \\sigma_w^2,\n$$\n所以\n$$\n\\gamma_x(0) = \\frac{\\sigma_w^2}{1 - \\phi^2}.\n$$\n类似地，\n$$\n\\gamma_x(1) = \\operatorname{Cov}(x_t,x_{t-1}) = \\operatorname{Cov}(\\phi x_{t-1} + w_t, x_{t-1}) = \\phi \\operatorname{Var}(x_{t-1}) + \\operatorname{Cov}(w_t,x_{t-1}) = \\phi \\gamma_x(0),\n$$\n因为 $w_t$ 与 $x_{t-1}$ 独立。\n\n接下来，根据 $y_t = x_t + \\epsilon_t$ 和独立性结构计算 $\\operatorname{Cov}(y_t,y_{t-1})$ 和 $\\operatorname{Var}(y_{t-1})$。我们有\n$$\n\\operatorname{Cov}(y_t,y_{t-1}) = \\operatorname{Cov}(x_t + \\epsilon_t, x_{t-1} + \\epsilon_{t-1}) = \\operatorname{Cov}(x_t,x_{t-1}) + \\operatorname{Cov}(x_t,\\epsilon_{t-1}) + \\operatorname{Cov}(\\epsilon_t,x_{t-1}) + \\operatorname{Cov}(\\epsilon_t,\\epsilon_{t-1}).\n$$\n根据时间上的独立性以及 $x_t$、$w_t$ 和 $\\epsilon_s$ 之间的独立性，所有混合项都为零，并且 $\\operatorname{Cov}(\\epsilon_t,\\epsilon_{t-1}) = 0$，因此\n$$\n\\operatorname{Cov}(y_t,y_{t-1}) = \\gamma_x(1) = \\phi \\gamma_x(0).\n$$\n另外，\n$$\n\\operatorname{Var}(y_{t-1}) = \\operatorname{Var}(x_{t-1} + \\epsilon_{t-1}) = \\operatorname{Var}(x_{t-1}) + \\operatorname{Var}(\\epsilon_{t-1}) = \\gamma_x(0) + \\tau^2.\n$$\n因此，\n$$\n\\phi^{\\dagger} = \\frac{\\operatorname{Cov}(y_t,y_{t-1})}{\\operatorname{Var}(y_{t-1})} = \\frac{\\phi \\gamma_x(0)}{\\gamma_x(0) + \\tau^2}.\n$$\n将 $\\gamma_x(0) = \\sigma_w^2/(1 - \\phi^2)$ 代入，得到以原始参数表示的闭式表达式：\n$$\n\\phi^{\\dagger}(\\phi,\\sigma_w^2,\\tau^2) = \\frac{\\phi \\, \\dfrac{\\sigma_w^2}{1 - \\phi^2}}{\\dfrac{\\sigma_w^2}{1 - \\phi^2} + \\tau^2} = \\frac{\\phi \\, \\sigma_w^2}{\\sigma_w^2 + (1 - \\phi^2)\\tau^2}.\n$$\n这表明，只要 $\\tau^2 > 0$，朴素持续性估计值就会向 $0$ 衰减。\n\n任务B。为了校正这种偏误，我们构建线性高斯状态空间模型并指定卡尔曼滤波器 (KF) 的递归式。在满足高斯性的条件下，卡尔曼滤波器可提供最优线性无偏状态估计，并能对 $\\phi$、$\\sigma_w^2$ 和 $\\tau^2$ 进行最大似然估计。\n\n状态方程：\n$$\nx_t = \\phi x_{t-1} + w_t, \\quad w_t \\sim \\mathcal{N}(0,\\sigma_w^2).\n$$\n观测方程：\n$$\ny_t = x_t + \\epsilon_t, \\quad \\epsilon_t \\sim \\mathcal{N}(0,\\tau^2).\n$$\n初始化：$x_{0|0} = \\mathbb{E}[x_0]$（通常为 $0$）和 $P_{0|0} = \\operatorname{Var}(x_0)$（对于扩散先验，取一个大的 $P_{0|0}$；对于平稳初始化，$P_{0|0} = \\sigma_w^2/(1 - \\phi^2)$）。\n\n预测（时间更新）：\n$$\nx_{t|t-1} = \\phi x_{t-1|t-1}, \\quad P_{t|t-1} = \\phi^2 P_{t-1|t-1} + \\sigma_w^2.\n$$\n新息及其方差：\n$$\n\\nu_t = y_t - x_{t|t-1}, \\quad S_t = P_{t|t-1} + \\tau^2.\n$$\n卡尔曼增益：\n$$\nK_t = \\frac{P_{t|t-1}}{S_t} = \\frac{P_{t|t-1}}{P_{t|t-1} + \\tau^2}.\n$$\n更新（测量校正）：\n$$\nx_{t|t} = x_{t|t-1} + K_t \\nu_t, \\quad P_{t|t} = (1 - K_t) P_{t|t-1}.\n$$\n稳态标量代数里卡蒂方程：如果存在稳态后验误差方差 $P$，它满足\n$$\nP = \\left(\\phi^2 P + \\sigma_w^2\\right) - \\frac{\\left(\\phi^2 P + \\sigma_w^2\\right)^2}{\\phi^2 P + \\sigma_w^2 + \\tau^2} = \\frac{\\left(\\phi^2 P + \\sigma_w^2\\right)\\tau^2}{\\phi^2 P + \\sigma_w^2 + \\tau^2}.\n$$\n等价地，\n$$\n\\phi^2 P^2 + \\left[\\sigma_w^2 + \\tau^2(1 - \\phi^2)\\right] P - \\tau^2 \\sigma_w^2 = 0,\n$$\n其正根即为稳态 $P$，而稳态卡尔曼增益则为\n$$\nK = \\frac{\\phi^2 P + \\sigma_w^2}{\\phi^2 P + \\sigma_w^2 + \\tau^2}.\n$$\n该滤波器能够产生最优的线性状态估计，并通过由新息 $\\nu_t \\sim \\mathcal{N}(0,S_t)$ 构建的似然函数实现一致的参数估计，从而消除了 $\\widehat{\\phi}_{\\text{naive}}$ 中的衰减偏误。\n\n所要求的最终答案是朴素 $\\mathrm{AR}(1)$ 斜率的伪真极限，我们已推导出其为\n$$\n\\phi^{\\dagger}(\\phi,\\sigma_w^2,\\tau^2) = \\frac{\\phi \\, \\sigma_w^2}{\\sigma_w^2 + (1 - \\phi^2)\\tau^2}.\n$$", "answer": "$$\\boxed{\\frac{\\phi\\,\\sigma_w^2}{\\sigma_w^2+(1-\\phi^2)\\tau^2}}$$", "id": "2470759"}, {"introduction": "现实世界的数据采集很少能产生教科书案例中假定的完美规则的时间序列；不规则采样是常态，而非例外。将假定固定时间步长的标准模型应用于此类数据，可能会严重扭曲最终的预警指标。本练习旨在探讨这些朴素方法所带来的后果，并介绍正确的分析框架：连续时间随机过程，它提供了一种无论采样方案如何都能稳健估计系统属性的方法。[@problem_id:2470823]", "problem": "监测一个湖泊以探测浮游植物生物量发生“范式转移”(regime shift)的早期预警指标。由于天气和后勤原因，观测在不规则的时间 $\\{t_i\\}_{i=1}^n$ 进行，其中存在数据缺失的片段。在一个稳定平衡点附近，生物量异常 $X(t)$ 可以被线性化的连续时间 Ornstein–Uhlenbeck (OU) 过程很好地近似：\n$$\n\\mathrm{d}X(t) = -\\alpha \\big(X(t)-\\mu\\big)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W(t),\n$$\n其中 $\\alpha>0$ 是局部稳定性（恢复速率），$\\mu$ 是平衡点，$\\sigma>0$ 是噪声强度，$W(t)$ 是一个标准维纳过程。早期预警指标包括固定日历时滞 $\\Delta^\\star>0$ 下的自相关，定义为 $\\rho(\\Delta^\\star)=\\mathrm{Cov}\\big(X(t),X(t+\\Delta^\\star)\\big)/\\mathrm{Var}\\big(X(t)\\big)$，以及平稳方差 $\\mathrm{Var}\\big(X(t)\\big)$。\n\n实践者通常通过将 $X_{i+1}$ 对 $X_i$ 进行回归来计算离散序列的一阶自回归 (AR(1)) 系数，就好像时间步长是相等的一样；或者他们在计算自相关和方差之前，先线性插值到一个规则的网格上。你的任务是评估在不规则采样下，这些做法所引入的偏差，并提出一种在时间步长不相等的情况下仍然有效的、基于统计学原理的估计量。\n\n下列哪个陈述是正确的？选择所有适用项。\n\nA. 一种基于原理的方法是，利用观测到的时间间隔 $\\Delta_i=t_{i+1}-t_i$，最大化连续时间 OU 模型的精确高斯转移似然，从而得到在标准正则性条件下一致的 $(\\alpha,\\mu,\\sigma^2)$ 估计值。然后可以报告 $\\rho(\\Delta^\\star)=\\exp(-\\alpha \\Delta^\\star)$ 和 $\\mathrm{Var}(X)=\\sigma^2/(2\\alpha)$。当数据缺失导致典型的时间间隔增大（以至于许多 $\\Delta_i>\\Delta^\\star$）时，忽略 $\\Delta_i$ 的朴素 AR(1) 回归会低估 $\\rho(\\Delta^\\star)$，而线性插值会夸大短时滞的自相关并缩减方差。\n\nB. 线性插值到规则网格，然后进行标准的 AR(1) 和样本方差计算，对于 $\\rho(\\Delta^\\star)$ 和 $\\mathrm{Var}(X)$ 都是渐近无偏的，因为插值保留了二阶矩。相反，在存在长间隔的情况下，忽略 AR(1) 中的 $\\Delta_i$ 倾向于高估 $\\rho(\\Delta^\\star)$。\n\nC. 一种频域替代方法是使用 Lomb–Scargle 周期图 (LSP) 来估计非均匀采样下的谱密度 $S(f)$；通过 Whittle 型似然拟合 OU 谱形式 $S(f)\\propto\\big(\\alpha^2+(2\\pi f)^2\\big)^{-1}$，可以得到 $\\alpha$ 的一致估计量，并因此得到 $\\rho(\\Delta^\\star)=\\exp(-\\alpha \\Delta^\\star)$ 和 $\\mathrm{Var}(X)=\\sigma^2/(2\\alpha)$ 的一致估计量。在随机缺失采样下，忽略 $\\Delta_i$ 的成对 AR(1) 对 $\\rho(\\Delta^\\star)$ 有向下偏差，而线性插值使方差有向下偏差。\n\nD. 丢弃所有 $\\Delta_i\\neq \\Delta^\\star$ 的数据对，并在剩余的子序列上计算样本自相关和方差是无偏的，并且比连续时间似然法更有效，因为 $\\Delta_i\\neq \\Delta^\\star$ 的观测值不包含关于 $\\rho(\\Delta^\\star)$ 的信息。\n\nE. 因为正自相关会夸大变异性，所以从不规则采样数据中得到的通常样本方差相对于平稳方差是向上偏的；线性插值通过平滑来纠正这一点，从而恢复方差的无偏性。", "solution": "问题陈述提出了一个基于离散、不规则观测的连续时间随机过程的统计估计问题。这是许多科学领域（包括生态建模）中一个常见且不简单的问题。\n\n### **问题陈述验证**\n\n_步骤1：提取已知条件_\n- **模型**：用于生物量异常 $X(t)$ 的 Ornstein–Uhlenbeck (OU) 过程，由 $\\mathrm{d}X(t) = -\\alpha \\big(X(t)-\\mu\\big)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W(t)$ 给出。\n- **参数**：稳定性 $\\alpha>0$，平衡点 $\\mu$，噪声强度 $\\sigma>0$。\n- **噪声**：$W(t)$ 是一个标准维纳过程。\n- **数据**：在不规则时间 $\\{t_i\\}_{i=1}^n$ 观测到的时间序列，时间间隔为 $\\Delta_i=t_{i+1}-t_i$。\n- **目标量**：平稳方差 $\\mathrm{Var}\\big(X(t)\\big)$ 和在固定时滞 $\\Delta^\\star>0$ 下的自相关 $\\rho(\\Delta^\\star)$。\n- **目标**：评估关于从不规则数据中估计这些量的基于原理的方法和朴素方法的陈述的有效性。\n\n_步骤2：使用提取的已知条件进行验证_\n该问题在科学上和数学上都是合理的。OU 过程是描述一个随机驱动的线性系统返回到平衡点的典型模型，广泛用于近似稳定状态附近的动力学。对早期预警信号的分析，例如由于稳定性参数 $\\alpha$ 减小（临界慢化）而导致的方差和自相关上升，是临界点理论的一个基本课题。从离散、不规则数据进行参数估计的问题是统计推断中一个明确定义的挑战。问题陈述是客观的、自洽的，并且没有科学谬误或歧义。\n\n_步骤3：结论与行动_\n问题陈述是**有效的**。我们可以进行完整解答。\n\n### **理论推导**\n\n首先，我们确定平稳 OU 过程的性质。\n随机微分方程 (SDE) 是 $\\mathrm{d}X(t) = -\\alpha (X(t)-\\mu)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W(t)$。\n我们来分析中心化过程 $Y(t) = X(t) - \\mu$，它遵循 $\\mathrm{d}Y(t) = -\\alpha Y(t)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W(t)$。\n\n1.  **平稳矩**：在平稳状态下，均值为 $\\mathrm{E}[X(t)] = \\mu$。方差可以通过求解相应的 Fokker-Planck 方程或直接从积分解中得到：\n    $$\n    \\mathrm{Var}(X) = \\mathrm{Var}(Y) = \\frac{\\sigma^2}{2\\alpha}\n    $$\n2.  **自相关**：时滞为 $\\Delta > 0$ 的自协方差函数是 $\\mathrm{Cov}\\big(X(t), X(t+\\Delta)\\big) = \\mathrm{Var}(X) e^{-\\alpha\\Delta}$。由此得到自相关函数 (ACF)：\n    $$\n    \\rho(\\Delta) = \\frac{\\mathrm{Cov}\\big(X(t), X(t+\\Delta)\\big)}{\\mathrm{Var}(X)} = e^{-\\alpha\\Delta}\n    $$\n    因此，目标量是模型参数的函数：$\\mathrm{Var}(X) = \\sigma^2/(2\\alpha)$ 和 $\\rho(\\Delta^\\star) = e^{-\\alpha\\Delta^\\star}$。当系统接近临界点时，$\\alpha \\to 0$，导致方差和自相关都增加。\n\n3.  **精确离散化**：OU 过程是一个线性随机微分方程，它有一个精确的离散时间等价形式。该 SDE 的解表明，对于任意两个时间点 $t_i$ 和 $t_{i+1}$（间隔为 $\\Delta_i = t_{i+1}-t_i$），在给定 $X(t_i)$ 的条件下，$X(t_{i+1})$ 的条件分布是高斯的：\n    $$\n    X(t_{i+1}) | X(t_i) \\sim \\mathcal{N}\\left(\\mu + (X(t_i)-\\mu)e^{-\\alpha\\Delta_i}, \\frac{\\sigma^2}{2\\alpha}(1-e^{-2\\alpha\\Delta_i})\\right)\n    $$\n    这种关系是对不规则采样数据进行基于统计学原理分析的基础。\n\n### **评估估计方法**\n\n**基于原理的方法：**\n- **最大似然估计 (MLE)**：利用上述精确的条件分布，可以为观测序列 $\\{X(t_i)\\}_{i=1}^n$ 构建对数似然函数：\n  $$\n  \\log L(\\alpha, \\mu, \\sigma^2) = \\sum_{i=1}^{n-1} \\log p(X(t_{i+1})|X(t_i); \\alpha, \\mu, \\sigma^2)\n  $$\n  对该函数关于参数 $(\\alpha, \\mu, \\sigma^2)$ 进行最大化，可以提供一致的、渐近正态的和有效的估计量。然后通过 MLE 的不变性性质可以得到早期预警指标 (EWI) 的估计值：$\\hat{\\rho}(\\Delta^\\star)=e^{-\\hat{\\alpha}\\Delta^\\star}$ 和 $\\widehat{\\mathrm{Var}}(X)=\\hat{\\sigma}^2/(2\\hat{\\alpha})$。这是一种标准且稳健的方法。\n- **频域估计**：另一种方法是在频域中进行。平稳 OU 过程的功率谱密度 (PSD) 是：\n  $$\n  S(f) = \\frac{\\sigma^2}{\\alpha^2 + (2\\pi f)^2}\n  $$\n  对于非均匀采样的数据，Lomb-Scargle 周期图 (LSP) 提供了对 PSD 的一致估计。然后可以通过将理论 PSD 模型拟合到 LSP（例如，通过最小化一个 Whittle 型似然）来获得 $\\alpha$ 和 $\\sigma^2$ 的一致估计。\n\n**朴素方法：**\n- **朴素 AR(1) 回归**：此方法忽略不规则的时间步长 $\\Delta_i$，并通过普通最小二乘法拟合模型 $X_{i+1} = c + \\phi X_i + \\text{noise}$。估计的系数 $\\hat{\\phi}$ 近似于真实的时间依赖自回归参数的平均值：\n  $$\n  \\mathrm{E}[\\hat{\\phi}] \\approx \\frac{\\sum_{i=1}^{n-1} \\mathrm{Cov}(X_i, X_{i+1})}{\\sum_{i=1}^{n-1} \\mathrm{Var}(X_i)} = \\frac{\\sum_{i=1}^{n-1} \\mathrm{Var}(X)e^{-\\alpha\\Delta_i}}{(n-1)\\mathrm{Var}(X)} = \\frac{1}{n-1}\\sum_{i=1}^{n-1} e^{-\\alpha\\Delta_i}\n  $$\n  如果缺失数据导致许多间隔 $\\Delta_i$ 远大于目标时滞 $\\Delta^\\star$，那么 $e^{-\\alpha\\Delta_i}$ 项会很小，从而将平均值拉低。因此，$\\hat{\\phi}$ 将是 $\\rho(\\Delta^\\star) = e^{-\\alpha\\Delta^\\star}$ 的一个向下偏的估计量。\n\n- **线性插值**：此方法通过在观测点之间画直线来创建一个新的、规则间隔的时间序列。这个过程从根本上改变了数据的统计特性。\n  - **自相关**：两个观测值之间的插值点是完全线性相关的。这引入了人为的平滑性，并夸大了在短时滞下的估计相关性。\n  - **方差**：考虑在观测值 $X_i$ 和 $X_{i+1}$ 之间长度为 $\\Delta_i$ 的时间间隔中点处插值的一个点 $X'$。它的值为 $X' = (X_i+X_{i+1})/2$。它的方差是 $\\mathrm{Var}(X') = \\frac{1}{4}\\mathrm{Var}(X_i+X_{i+1}) = \\frac{1}{2}\\mathrm{Var}(X)(1+\\rho(\\Delta_i))$。由于对于任何 $\\Delta_i>0$，都有 $\\rho(\\Delta_i) < 1$，所以我们有 $\\mathrm{Var}(X') < \\mathrm{Var}(X)$。插值数据集的总方差是原始点和新点方差的平均值，因此将低于真实的平稳方差 $\\sigma^2/(2\\alpha)$。这构成了一个向下偏差。\n\n### **逐项分析**\n\n**A. 一种基于原理的方法是，最大化精确高斯转移似然...**\n该陈述正确地描述了基于 OU 过程精确转移概率的 MLE 方法。它正确地断言该方法产生一致的估计量。它正确地提供了基于估计参数的早期预警指标 (EWI) 的公式。最后，它正确地诊断了朴素方法的偏差：忽略时间间隔的 AR(1) 回归在存在长间隔时会低估 $\\rho(\\Delta^\\star)$，而线性插值会夸大短时滞自相关并缩减方差。这个陈述的每一部分都是准确的。\n**结论：正确**\n\n**B. 线性插值到规则网格...是渐近无偏的...**\n该陈述不正确。如上所述，线性插值引入了系统性偏差。它会缩减（低估）方差并夸大（高估）短时滞自相关。插值保留二阶矩的前提是错误的。此外，它错误地声称在 AR(1) 拟合中忽略 $\\Delta_i$ 会导致对 $\\rho(\\Delta^\\star)$ 的高估；在存在长间隔的情况下，偏差通常是向下的。\n**结论：不正确**\n\n**C. 一种频域替代方法是使用 Lomb–Scargle 周期图...**\n该陈述正确地描述了一种有效的频域方法，该方法使用 LSP 处理非均匀采样，并拟合已知的 OU 过程谱形式。它正确地指出该方法为 $\\alpha$ 和 $\\sigma^2$ 提供了（并因此为早期预警指标 EWI 提供了）一致的估计量。然后，它正确地重申了前面讨论过的朴素方法的偏差：成对 AR(1) 系数对 $\\rho(\\Delta^\\star)$ 有向下偏差，而线性插值使方差有向下偏差。\n**结论：正确**\n\n**D. 丢弃所有 $\\Delta_i\\neq \\Delta^\\star$ 的数据对...是无偏且更有效的...**\n该陈述不正确。虽然仅使用具有特定间隔 $\\Delta^\\star$ 的数据对可能会得到一个条件无偏的估计（如果存在足够多的此类数据对，但这不太可能），但这样做效率极低。最大似然估计在渐近意义上是最有效的估计过程，因为它使用了所有可用的数据。丢弃观测值就是丢弃信息，这会增加估计量的方差（即降低效率）。声称 $\\Delta_i \\neq \\Delta^\\star$ 的观测值不包含关于 $\\rho(\\Delta^\\star) = e^{-\\alpha\\Delta^\\star}$ 的信息是错误的。所有数据对都包含关于底层参数 $\\alpha$ 的信息，而 $\\alpha$ 决定了在*任何*时滞下的自相关。\n**结论：不正确**\n\n**E. 因为正自相关会夸大变异性，所以通常的样本方差...是向上偏的...**\n该陈述不正确。前提“正自相关会夸大变异性”经常被误解。对于一个正自相关的过程，标准的样本方差估计量 $S^2 = \\frac{1}{n-1}\\sum (X_i - \\bar{X})^2$ 实际上相对于真实平稳方差是**向下偏的**。观测值并非完全独立，并且倾向于比独立抽样更接近样本均值，导致 $\\mathrm{E}[S^2] < \\mathrm{Var}(X)$。声称存在向上偏差是错误的。因此，声称通过线性插值进行平滑“纠正”了这种不存在的向上偏差也是错误的；如前所述，插值进一步减小了方差，加剧了向下偏差。\n**结论：不正确**\n\n因此，陈述 A 和 C 是对该情况唯一正确的描述。它们提出了两种有效的、基于原理的方法，并正确指出了几种朴素方法的缺陷。", "answer": "$$\\boxed{AC}$$", "id": "2470823"}]}