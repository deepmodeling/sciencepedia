{"hands_on_practices": [{"introduction": "在系统地理学中，一项基本任务是从遗传数据中估算关键的人口统计学参数。本练习旨在实践群体遗传学中最基本的关系之一：在中性、平衡模型下，核苷酸多样性（$\\pi$）与有效种群大小（$N_e$）之间的联系 [@problem_id:2521267]。掌握这一计算是解读遗传数据，理解突变和遗传漂变之间相互作用的基础。", "problem": "正在谱系地理学背景下，对一个随机交配的岛屿栖息蜥蜴谱系进行研究，以推断其种群历史。您从该物种分布范围内采样的 $n$ 个二倍体个体中，对一个长度为 $L$ 个碱基对、假定为中性且非重组的核基因座进行了测序。经过严格的质量控制以排除具有选择证据的位点后，观测到的每位点平均成对核苷酸多样性（所有染色体对之间每位点差异的平均比例），记为 $\\pi$，其值为 $\\pi = 0.0087$。一项独立的基于谱系的估计显示，该基因座的每位点、每世代突变率为 $\\mu = 1.1 \\times 10^{-8}$。\n\n假设在突变-漂变平衡状态下，种群符合一个大小恒定、二倍体遗传、中性且遵循无限位点突变模型的赖特-费舍尔种群模型。在这些假设下，估计该谱系的二倍体有效种群大小 $N_{e}$。将您的最终答案四舍五入至 $3$ 位有效数字。以二倍体个体数的形式表达您的最终答案。", "solution": "该问题陈述已经过严格验证，被认为是有效的。它在科学上基于群体遗传学原理，提问得当，信息充分，可得出唯一解，且陈述客观。该问题要求应用基本理论，从遗传数据中估计一个关键的种群参数。\n\n这个问题的核心在于，在突变-漂变平衡状态下的赖特-费舍尔模型的特定假设下，核苷酸多样性、有效种群大小和突变率三者之间的关系。对于一个大小恒定的二倍体随机交配种群，每位点预期平均成对核苷酸多样性，记为 $E[\\pi]$，等于种群突变参数 $\\theta$。\n\n在二倍体种群中，种群突变参数 $\\theta$ 的计算公式如下：\n$$\n\\theta = 4 N_{e} \\mu\n$$\n其中 $N_{e}$ 是二倍体有效种群大小，$\\mu$ 是每位点每世代的中性突变率。\n\n在突变-漂变平衡状态下，预期的核苷酸多样性等于此参数：\n$$\nE[\\pi] = \\theta = 4 N_{e} \\mu\n$$\n题目提供了观测到的平均成对核苷酸多样性 $\\pi = 0.0087$，这是我们对理论期望值 $E[\\pi]$ 的经验估计。我们还得到了每位点每世代的突变率 $\\mu = 1.1 \\times 10^{-8}$。题目中提供的其他参数，如基因座长度 $L$ 和样本大小 $n$，对于一项真实的研究是背景信息，但对于本次特定计算并非必需，因为 $\\pi$ 已经作为每位点的平均值给出。\n\n我们可以利用所提供的数据建立以下方程：\n$$\n\\pi = 4 N_{e} \\mu\n$$\n我们的目标是求解二倍体有效种群大小 $N_{e}$。我们可以通过代数方法重新整理该方程：\n$$\nN_{e} = \\frac{\\pi}{4 \\mu}\n$$\n现在，我们将给定的数值代入这个表达式中：\n$$\n\\pi = 0.0087\n$$\n$$\n\\mu = 1.1 \\times 10^{-8}\n$$\n将这些值代入我们求解 $N_{e}$ 的方程中：\n$$\nN_{e} = \\frac{0.0087}{4 \\times (1.1 \\times 10^{-8})}\n$$\n首先，计算分母：\n$$\n4 \\times 1.1 \\times 10^{-8} = 4.4 \\times 10^{-8}\n$$\n现在，进行除法运算：\n$$\nN_{e} = \\frac{0.0087}{4.4 \\times 10^{-8}} = \\frac{8.7 \\times 10^{-3}}{4.4 \\times 10^{-8}}\n$$\n$$\nN_{e} = \\left(\\frac{8.7}{4.4}\\right) \\times 10^{-3 - (-8)} = \\left(\\frac{8.7}{4.4}\\right) \\times 10^{5}\n$$\n系数的除法结果为：\n$$\n\\frac{8.7}{4.4} \\approx 1.977272...\n$$\n因此，有效种群大小为：\n$$\nN_{e} \\approx 1.977272... \\times 10^{5} \\approx 197727.27...\n$$\n题目要求将最终答案四舍五入至 $3$ 位有效数字。前三位有效数字是 $1$、$9$ 和 $7$。第四位有效数字是 $7$，大于或等于 $5$，因此我们必须对第三位有效数字进行进位。\n$$\nN_{e} \\approx 1.98 \\times 10^{5}\n$$\n这对应于估计的二倍体有效种群大小为 $198,000$ 个个体。", "answer": "$$\\boxed{1.98 \\times 10^{5}}$$", "id": "2521267"}, {"introduction": "物种很少是完全随机混合的，其遗传结构通常与地理分布相关。本练习将引导您完成一个完整的按距离隔离（Isolation-by-Distance, IBD）分析，这是景观遗传学和系统地理学的一块基石 [@problem_id:2521282]。通过这个实践，您将学习如何计算遗传距离和地理距离，并检验它们之间的统计关系，从而量化物种在空间尺度上的基因流限制。", "problem": "给定从多个地点采样的、具有空间参考信息的个体的二倍体单核苷酸多态性 (SNP) 基因型。假设每个个体都在一个地点进行采样，并且每个地点可能采样多个个体，它们都共享相同的坐标。将每个地点视为一个亚群。您的任务是通过对遗传分化统计量的转换值与地理距离的对数进行回归，来估计隔离-距离 (IBD) 斜率。\n\n基本原理和定义：\n- 两个亚群之间的固定指数 (F-统计量)，记为 $F_{ST}$，衡量了亚群间等位基因频率的标准化方差。对于两个样本间的双等位基因标记，一个广泛使用的无偏估计量是跨基因座聚合的 Hudson 估计量，其定义如下。对于每个基因座 $l$，令 $n_1 = 2 m_1$ 和 $n_2 = 2 m_2$ 分别为亚群 $1$ 和 $2$ 中的基因拷贝数，其中 $m_1$ 和 $m_2$ 是在相应亚群中对该基因座进行基因分型的二倍体个体数量。令 $x_1$ 和 $x_2$ 分别为 $n_1$ 和 $n_2$ 个基因拷贝中衍生等位基因的计数，样本频率为 $p_1 = x_1/n_1$ 和 $p_2 = x_2/n_2$。定义 $h_1 = p_1(1 - p_1)$ 和 $h_2 = p_2(1 - p_2)$。每个基因座的组分是\n$$\na_l = (p_1 - p_2)^2 - \\frac{h_1}{n_1 - 1} - \\frac{h_2}{n_2 - 1}, \\quad\nb_l = p_1(1 - p_2) + p_2(1 - p_1).\n$$\n多基因座 Hudson 估计量是\n$$\nF_{ST} = \\frac{\\sum_l a_l}{\\sum_l b_l},\n$$\n前提是 $\\sum_l b_l > 0$。如果 $\\sum_l b_l = 0$，则该基因座集不提供任何信息，对于该对组合应被视为无信息。\n- 两个亚群的 IBD 变换为 $y = \\frac{F_{ST}}{1 - F_{ST}}$。\n- 两个地点之间的地理距离，其经纬度以度为单位给出，是使用半正矢公式在半径为 $R = 6371$ 公里的球体上计算的。对于以度为单位的坐标 $(\\phi_1, \\lambda_1)$ 和 $(\\phi_2, \\lambda_2)$，首先将其转换为弧度，然后计算\n$$\n\\Delta \\phi = \\phi_2 - \\phi_1, \\quad \\Delta \\lambda = \\lambda_2 - \\lambda_1,\n$$\n$$\nA = \\sin^2\\left(\\frac{\\Delta \\phi}{2}\\right) + \\cos(\\phi_1)\\cos(\\phi_2)\\sin^2\\left(\\frac{\\Delta \\lambda}{2}\\right),\n$$\n$$\nd = 2 R \\arcsin(\\sqrt{A}),\n$$\n得出以公里为单位的 $d$。使用 $d$ 的自然对数 $\\log(d)$ 作为预测变量。\n- 使用所有无序的不同亚群对，通过普通最小二乘法 (OLS) 估计线性关系\n$$\ny = \\alpha + \\beta \\log(d) + \\varepsilon\n$$\n的斜率参数 $\\beta$，其中包含截距 $\\alpha$。OLS 斜率是通过最小化所有成对数据的残差平方和得到的。\n\n程序要求：\n- 实现以上步骤：按地点对个体进行分组，使用 Hudson 估计量跨所有基因座计算成对的 $F_{ST}$，转换为 $y = \\frac{F_{ST}}{1 - F_{ST}}$，通过半正矢公式计算地理距离（单位：公里，输入角度为度，内部计算使用弧度），并对 $y$ 与 $\\log(d)$ 进行带截距的 OLS 回归拟合。排除任何 $d \\le 0$ 的配对（因为只对不同的地点进行配对，所以不应出现这种情况）。\n- 单位：所有距离必须以公里为单位计算；使用 $R = 6371$ 公里。输入中的角度以度为单位给出，必须转换为弧度以用于三角函数。回归使用自然对数（以 $e$ 为底）。\n- 输出：对于下面测试套件中的每个数据集，输出 OLS 斜率 $\\beta$，为一个浮点数，保留 $6$ 位小数。\n- 最终输出格式：您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[0.123456,0.000001,1.234567]\"）。\n\n测试套件：\n每个数据集包含一组地点。每个地点指定一个纬度（度）、一个经度（度）和一系列二倍体个体。每个个体在所有基因座上的基因型都编码为衍生等位基因的计数，取值于 $\\{0, 1, 2\\}$。在一个数据集中，所有个体的基因座顺序是一致的。\n\n数据集 A（理想情况；$4$ 个地点，$8$ 个基因座，每个地点 $4$ 个个体）：\n- 地点和坐标（纬度，经度，单位：度）：\n  - A: $(0, 0)$\n  - B: $(0, 1)$\n  - C: $(0, 2)$\n  - D: $(0, 3)$\n- 按地点的基因型（行为个体，列为基因座 $\\ell = 1,\\dots,8$）：\n  - A:\n    - $[0, 1, 0, 1, 2, 1, 2, 1]$\n    - $[0, 0, 1, 1, 0, 1, 1, 1]$\n    - $[0, 0, 0, 0, 0, 1, 0, 1]$\n    - $[0, 0, 0, 0, 0, 0, 0, 1]$\n  - B:\n    - $[1, 1, 2, 1, 2, 1, 2, 2]$\n    - $[0, 1, 0, 1, 1, 1, 1, 2]$\n    - $[0, 0, 0, 1, 0, 1, 1, 1]$\n    - $[0, 0, 0, 0, 0, 1, 0, 0]$\n  - C:\n    - $[1, 2, 2, 1, 2, 2, 2, 2]$\n    - $[1, 1, 1, 1, 1, 2, 2, 2]$\n    - $[0, 0, 0, 1, 1, 1, 1, 2]$\n    - $[0, 0, 0, 1, 0, 0, 0, 0]$\n  - D:\n    - $[1, 2, 2, 2, 2, 2, 2, 2]$\n    - $[1, 2, 1, 2, 2, 2, 2, 2]$\n    - $[1, 1, 1, 2, 1, 2, 2, 2]$\n    - $[1, 0, 1, 0, 1, 1, 1, 2]$\n\n数据集 B（分化较弱的边界情况；$3$ 个地点，$6$ 个基因座，每个地点 $3$ 个个体）：\n- 地点和坐标：\n  - E: $(10, 10)$\n  - F: $(10, 11)$\n  - G: $(11, 10)$\n- 基因型：\n  - E:\n    - $[1, 1, 1, 2, 1, 1]$\n    - $[1, 1, 1, 1, 1, 1]$\n    - $[1, 1, 0, 1, 1, 0]$\n  - F:\n    - $[1, 1, 1, 2, 1, 1]$\n    - $[1, 1, 1, 1, 1, 1]$\n    - $[1, 0, 1, 1, 0, 1]$\n  - G:\n    - $[1, 1, 1, 2, 1, 1]$\n    - $[1, 1, 1, 1, 1, 1]$\n    - $[0, 1, 1, 1, 1, 0]$\n\n数据集 C（包含一个遥远、高度分化地点的边缘情况；$4$ 个地点，$7$ 个基因座，每个地点 $3$ 个个体）：\n- 地点和坐标：\n  - H: $(0, 0)$\n  - I: $(0, 1)$\n  - J: $(0, 2)$\n  - K: $(20, 20)$\n- 基因型：\n  - H:\n    - $[1, 1, 1, 1, 1, 1, 1]$\n    - $[1, 1, 0, 1, 1, 0, 1]$\n    - $[0, 0, 0, 1, 0, 0, 0]$\n  - I:\n    - $[1, 1, 1, 1, 1, 1, 1]$\n    - $[1, 1, 1, 1, 1, 1, 1]$\n    - $[0, 0, 0, 1, 0, 0, 0]$\n  - J:\n    - $[1, 1, 1, 1, 1, 1, 1]$\n    - $[1, 0, 1, 1, 1, 0, 1]$\n    - $[0, 0, 0, 1, 0, 0, 0]$\n  - K:\n    - $[2, 2, 2, 2, 2, 2, 2]$\n    - $[2, 2, 1, 2, 2, 2, 1]$\n    - $[1, 1, 1, 2, 1, 1, 1]$\n\n您的程序必须在内部完全按照规定构建这些数据集，执行所描述的计算，并打印一行包含数据集 A、数据集 B 和数据集 C 的斜率的结果，按此顺序排列，保留 $6$ 位小数，格式为一个用方括号括起来的逗号分隔列表。", "solution": "所提出的问题经过了严格的验证，被认为是科学上可靠、定义明确且客观的。它描述了群体遗传学领域中量化隔离-距离效应的标准程序。其定义、数据和目标都具有足够的清晰度和精确性，足以得出一个唯一的、可验证的解决方案。因此，我们可以着手推导和实施该解决方案。\n\n目标是估计变换后的遗传分化与地理距离自然对数之间线性关系的斜率参数 $\\beta$。该模型由 $y = \\alpha + \\beta \\log(d) + \\varepsilon$ 给出。估计过程包括三个主要阶段：数据组织、成对度量计算以及通过普通最小二乘法 (OLS) 进行参数估计。\n\n首先，将提供的基因型数据按采样地点进行组织。输入数据包括二倍体个体的基因型，其在多个单核苷酸多态性 (SNP) 基因座上的基因型被编码为衍生等位基因的计数，是一个来自集合 $\\{0, 1, 2\\}$ 的整数。我们必须为每对不同的地点处理这些数据。\n\n其次，对于每对唯一的无序地点组合，我们计算两个关键指标：地理距离 $d$ 和变换后的遗传分化 $y$。\n\n地理距离 $d$ 使用半正矢公式计算，该公式确定了球体上的大圆距离。给定两个地点的坐标 $(\\phi_1, \\lambda_1)$ 和 $(\\phi_2, \\lambda_2)$（以度为单位），我们首先将它们转换为弧度。然后，以公里 ($km$) 为单位的距离 $d$ 按如下方式计算：\n$$\nd = 2 R \\arcsin\\left(\\sqrt{\\sin^2\\left(\\frac{\\Delta \\phi}{2}\\right) + \\cos(\\phi_1)\\cos(\\phi_2)\\sin^2\\left(\\frac{\\Delta \\lambda}{2}\\right)}\\right)\n$$\n其中 $\\Delta \\phi = \\phi_2 - \\phi_1$, $\\Delta \\lambda = \\lambda_2 - \\lambda_1$，地球半径取为 $R = 6371$ km。我们回归模型中的预测变量是此距离的自然对数，对于给定的配对 $i$，即 $X_i = \\log(d_i)$。任何计算出的距离 $d \\le 0$ 的配对必须从分析中排除。\n\n遗传分化使用固定指数 $F_{ST}$ 进行量化。我们采用多基因座 Hudson 估计量，这是一个针对双等位基因标记的无偏估计量。对于给定的一个亚群（地点）对，分别有个体数 $m_1$ 和 $m_2$，则基因拷贝数分别为 $n_1 = 2m_1$ 和 $n_2 = 2m_2$。对于每个基因座 $l$，我们首先计算衍生等位基因的样本等位基因频率，$p_{1,l} = x_{1,l}/n_1$ 和 $p_{2,l} = x_{2,l}/n_2$，其中 $x_{1,l}$ 和 $x_{2,l}$ 是该基因座上每个亚群中衍生等位基因的计数。该估计量的每个基因座组分为：\n$$\na_l = (p_{1,l} - p_{2,l})^2 - \\frac{h_{1,l}}{n_1 - 1} - \\frac{h_{2,l}}{n_2 - 1}\n$$\n$$\nb_l = p_{1,l}(1 - p_{2,l}) + p_{2,l}(1 - p_{1,l})\n$$\n其中 $h_{1,l} = p_{1,l}(1 - p_{1,l})$ 和 $h_{2,l} = p_{2,l}(1 - p_{2,l})$ 是种群内杂合度。分母中包含 $n-1$ 的项是对有限样本量的校正。多基因座估计量是这些组分在所有 $L$ 个基因座上求和的比率：\n$$\nF_{ST} = \\frac{\\sum_{l=1}^{L} a_l}{\\sum_{l=1}^{L} b_l}\n$$\n此计算仅在分母 $\\sum_l b_l > 0$ 时有效。如果不满足此条件，则该对种群被认为不含信息，并从后续分析中排除。然后，使用以下公式对 $F_{ST}$ 值进行变换，以使其与 $\\log(d)$ 的关系线性化：\n$$\ny = \\frac{F_{ST}}{1 - F_{ST}}\n$$\n如果 $F_{ST} \\ge 1$，此变换无定义。此类代表完全或极端分化的配对也应从回归分析中排除。\n\n第三，在为所有有效的地点对 $i$ 计算出数据集 $\\{(\\log(d_i), y_i)\\}$ 后，我们估计斜率参数 $\\beta$。线性模型为 $y_i = \\alpha + \\beta \\log(d_i) + \\varepsilon_i$。使用普通最小二乘法 (OLS)，最小化残差平方和 $\\sum_i (y_i - (\\alpha + \\beta \\log(d_i)))^2$ 的斜率 $\\beta$ 由下式给出：\n$$\n\\beta = \\frac{\\sum_{i} (\\log(d_i) - \\overline{\\log(d)}) (y_i - \\bar{y})}{\\sum_{i} (\\log(d_i) - \\overline{\\log(d)})^2}\n$$\n其中 $\\overline{\\log(d)}$ 和 $\\bar{y}$ 分别是预测变量和响应变量的样本均值。将为每个提供的数据集计算此值。实现将精确遵循这些步骤，利用数值库来稳健地计算距离、遗传统计量和最终的 OLS 回归。", "answer": "[0.088657,0.000302,0.083815]", "id": "2521282"}, {"introduction": "当我们从物种间水平探究深时历史时，一个核心挑战是基因树和物种树可能不一致。本练习将探讨导致这种不一致的主要原因之一：不完全谱系分选（Incomplete Lineage Sorting, ILS） [@problem_id:2521228]。通过动手计算在给定分支长度的物种树中ILS的期望比例，您将对这一关键的演化过程获得定量的理解，这对于准确重建演化历史至关重要。", "problem": "考虑一个拓扑结构为 $((A,B),C)$ 的有根三类群物种树，该物种树在标准多物种溯祖模型下演化，且生物体为二倍体。假设满足以下条件：每个谱系内随机交配、中性演化、物种形成后无基因流、基因座内无重组、以及基因座之间相互独立。在每个祖先分支上，有效种群大小恒定且等于 $N_e$。设 $A$ 和 $B$ 的分化发生在时间 $\\tau_{AB}$（以代为单位），$(A,B)$ 与 $C$ 的分化发生在时间 $\\tau_{ABC}$（以代为单位），且 $\\tau_{ABC} \\gt \\tau_{AB}$。这两个物种形成事件之间的内部自分支长度为 $\\Delta T = \\tau_{ABC} - \\tau_{AB}$。已知 $\\Delta T$ 等于 $1.2\\,N_e$ 代。\n\n请仅使用溯祖理论的基本性质（具体而言，在一个大小为 $N_e$ 的恒定大小二倍体种群中，两个谱系的溯祖等待时间服从速率为 $\\frac{1}{2N_e}$ 的指数分布；以及当三个谱系进入一个单一的恒定大小种群时，首个发生溯祖的谱系对在所有三个可能组合中是可交换的），计算在大量独立基因座中，仅由不完全谱系分选（ILS）导致的基因树与物种树拓扑不一致的期望比例。\n\n请将最终答案表示为无单位的小数，并四舍五入到 $4$ 位有效数字。", "solution": "该问题提出了系统发育学中的一个经典情景，用于计算因不完全谱系分选（ILS）导致的基因树-物种树不一致性的概率。该问题定义明确，科学上合理，并包含了获得唯一解所需的所有信息。\n\n我们将从物种 $A$、$B$ 和 $C$ 中抽样的三个基因谱系分别表示为 $a$、$b$ 和 $c$。物种树拓扑结构为 $((A,B),C)$。这意味着物种 $A$ 和 $B$ 拥有比它们中任意一个与物种 $C$ 更近的共同祖先。\n\n我们向后追溯这三个谱系的历史。从现在到时间 $\\tau_{AB}$，这些谱系在各自物种的祖先种群中独立演化。在时间 $\\tau_{AB}$，谱系 $a$ 和 $b$ 进入它们的共同祖先种群，我们将其表示为 $AB$。谱系 $c$ 仍处于一个独立的祖先谱系中。这种状态在内部自分支的持续时间 $\\Delta T = \\tau_{ABC} - \\tau_{AB}$ 内保持不变。在时间 $\\tau_{ABC}$，祖先种群 $AB$ 和 $C$ 的祖先谱系合并成一个单一的共同祖先种群，我们将其表示为 $ABC$。此时，进入种群 $ABC$ 的谱系数量为两个或三个，具体取决于在时间间隔 $\\Delta T$ 内发生了什么。\n\n基因树的拓扑结构由溯祖事件的顺序决定。当且仅当谱系 $a$ 和 $b$ 在它们任何一个与谱系 $c$ 发生溯祖之前，彼此先发生溯祖，才会形成与物种树一致的基因树，即拓扑结构为 $((A,B),C)$。\n\n在时间间隔 $\\Delta T$ 内，对于谱系 $a$ 和 $b$，存在两种相互排斥的情景：\n$1$. 两个谱系 $a$ 和 $b$ 在种群 $AB$ 内发生溯祖。\n$2$. 两个谱系 $a$ 和 $b$ 未能在种群 $AB$ 内发生溯祖，并与谱系 $c$ 一起作为不同的谱系进入更深的祖先种群 $ABC$。\n\n让我们分析这些情景的概率。问题陈述，在一个有效种群大小恒为 $N_e$ 的二倍体种群中，任意两个谱系发生溯祖的等待时间服从指数分布，其速率参数为 $\\lambda = \\frac{1}{2N_e}$ 每代。内部自分支的持续时间为 $\\Delta T$。\n\n两个谱系在时间间隔 $\\Delta T$ 内未能发生溯祖的概率由指数分布的生存函数给出：\n$$P(\\text{no coalescence in } \\Delta T) = \\exp\\left(-\\lambda \\Delta T\\right) = \\exp\\left(-\\frac{\\Delta T}{2N_e}\\right)$$\n因此，它们在此时间间隔内发生溯祖的概率是：\n$$P(\\text{coalescence in } \\Delta T) = 1 - \\exp\\left(-\\frac{\\Delta T}{2N_e}\\right)$$\n\n如果在时间间隔 $\\Delta T$ 内发生溯祖（情景1），那么谱系 $a$ 和 $b$ 合并。由此产生的祖先谱系和谱系 $c$ 进入种群 $ABC$。此时只剩下两个谱系，它们必然会在更早的某个时间点发生溯祖。在这种情况下，基因树的拓扑结构保证是 $((A,B),C)$，与物种树一致。\n\n只有当情景2发生时，才可能产生不一致的基因树。也就是说，谱系 $a$ 和 $b$ 必须在内部自分支上未能发生溯祖。此事件的概率是 $P(\\text{no coalescence in } \\Delta T)$。如果发生这种情况，在时间 $\\tau_{ABC}$，三个不同的谱系（$a$、$b$ 和 $c$）进入祖先种群 $ABC$。\n\n问题陈述，在这个单一的、随机交配的种群 $ABC$ 中，首个发生溯祖的谱系对的身份是可交换的。这意味着三个可能的谱系对——$(a,b)$、$(a,c)$ 或 $(b,c)$——中任何一对首先发生溯祖的可能性都是相等的。任何特定谱系对首先发生溯祖的概率是 $\\frac{1}{3}$。\n最终的基因树拓扑结构取决于哪个谱系对首先发生溯祖：\n- 如果 $(a,b)$ 首先发生溯祖，拓扑结构为 $((A,B),C)$（一致）。这种情况发生的条件概率为 $\\frac{1}{3}$。\n- 如果 $(a,c)$ 首先发生溯祖，拓扑结构为 $((A,C),B)$（不一致）。这种情况发生的条件概率为 $\\frac{1}{3}$。\n- 如果 $(b,c)$ 首先发生溯祖，拓扑结构为 $((B,C),A)$（不一致）。这种情况发生的条件概率为 $\\frac{1}{3}$。\n\n因此，在三个谱系进入种群 $ABC$ 的条件下，获得不一致拓扑的概率是后两种结果的概率之和：\n$$P(\\text{discordant} | \\text{no coalescence in } \\Delta T) = \\frac{1}{3} + \\frac{1}{3} = \\frac{2}{3}$$\n观察到不一致基因树的总概率 $P_d$ 是情景2发生的概率乘以在情景2发生条件下的不一致概率。\n$$P_d = P(\\text{no coalescence in } \\Delta T) \\times P(\\text{discordant} | \\text{no coalescence in } \\Delta T)$$\n$$P_d = \\exp\\left(-\\frac{\\Delta T}{2N_e}\\right) \\times \\frac{2}{3}$$\n\n问题给出了内部自分支长度的具体值：$\\Delta T = 1.2 N_e$ 代。我们将这个值代入方程：\n$$P_d = \\frac{2}{3} \\exp\\left(-\\frac{1.2 N_e}{2 N_e}\\right)$$\n项 $N_e$ 被消去，简化了指数部分：\n$$P_d = \\frac{2}{3} \\exp(-0.6)$$\n现在，我们必须计算其数值。\n$$P_d \\approx \\frac{2}{3} \\times 0.548811636$$\n$$P_d \\approx 0.365874424$$\n问题要求答案四舍五入到 $4$ 位有效数字。结果为 $0.3659$。\n\n在大量独立基因座中，不一致基因树的期望比例等价于这个概率 $P_d$。", "answer": "$$\\boxed{0.3659}$$", "id": "2521228"}]}