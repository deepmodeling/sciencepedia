{"hands_on_practices": [{"introduction": "“一体化健康”框架的一个核心技能是量化病原体在相互关联的种群（如人类和动物）中的传播能力。基本再生数 $R_0$ 是衡量这一能力的关键指标。本练习将指导您使用下一代矩阵（Next-Generation Matrix, NGM）这一流行病学标准工具，为一个假设的人畜共患病系统构建数学模型，并计算其 $R_0$。通过这个实践，您将掌握在多宿主系统中评估疫情爆发潜力的基本方法。[@problem_id:2515610]", "problem": "在“同一健康”框架下，一种人畜共患病原体在一个耦合的易感-感染-移除（SIR）系统中，在人类和家畜之间传播。设宿主类别为人类（$H$）和动物（$A$）。假设传播为频率依赖性，宿主种群规模大且近似恒定，并且在无病平衡点时，两个宿主中的几乎所有个体都是易感者。设 $\\beta_{ij}$ 表示（由宿主 $j$ 的每个感染个体）向宿主 $i$ 的易感者的人均传播率，设 $\\gamma_{j}$ 表示宿主 $j$ 的感染个体的人均移除（恢复或死亡）率。在这些假设下，下一代矩阵（NGM）的元素等于将单个典型的 $j$ 型感染者引入一个完全易感的系统中所引起的 $i$ 型二代感染的期望数量。\n\n使用基本再生数 $R_{0}$ 的标准定义，即 NGM 的谱半径（主特征值），以 $\\beta_{ij}$ 和 $\\gamma_{j}$ 的符号形式推导 NGM，然后根据以下参数值计算 $R_{0}$（单位为 day$^{-1}$）：\n- $\\beta_{HH} = 0.3$, $\\beta_{AA} = 0.5$, $\\beta_{HA} = 0.1$, $\\beta_{AH} = 0.2$,\n- $\\gamma_{H} = 0.2$, $\\gamma_{A} = 0.25$.\n\n然后，基于 NGM 及其主特征向量的基本原理，确定哪种传播途径（人类内部 $H \\to H$，动物内部 $A \\to A$，或跨物种 $H \\leftrightarrow A$）在维持传播中占主导地位，并说明你的理由。\n\n在你的最终数值答案中，仅报告 $R_0$ 的值，四舍五入到四位有效数字。将 $R_0$ 表示为无量纲量。", "solution": "该问题已经过验证，被认为是有效的。它在科学上基于标准的流行病学建模理论，特别是针对多宿主 SIR 系统的下一代矩阵（NGM）的使用。该问题提法明确，为得到唯一且有意义的解提供了所有必需的参数和定义。语言客观而精确。\n\n该系统描述了两个耦合种群中感染个体的动态：人类（$H$）和动物（$A$）。设 $I_H$ 和 $I_A$ 分别是人类和动物种群中的感染个体数量。这些感染仓室在无病平衡点（DFE）附近线性化后的动态是 NGM 方法的核心。在 DFE 处，假定总种群数量大且恒定，并且几乎所有个体都是易感的。\n\n每个感染仓室的变化率由新感染率减去移除（恢复或死亡）率给出。根据问题的定义，感染类别向量 $\\mathcal{I} = [I_H, I_A]^T$ 的线性化系统为：\n$$\n\\frac{d}{dt} \\begin{pmatrix} I_H \\\\ I_A \\end{pmatrix} = \\begin{pmatrix} \\beta_{HH} I_H + \\beta_{HA} I_A \\\\ \\beta_{AH} I_H + \\beta_{AA} I_A \\end{pmatrix} - \\begin{pmatrix} \\gamma_H I_H \\\\ \\gamma_A I_A \\end{pmatrix}\n$$\n这可以写成矩阵形式 $\\frac{d\\mathcal{I}}{dt} = (\\mathcal{F} - \\mathcal{V})\\mathcal{I}$，其中 $\\mathcal{F}$ 是新感染率矩阵，$\\mathcal{V}$ 是转移率（移除）矩阵。\n\n新感染矩阵 $\\mathcal{F}$ 为：\n$$\n\\mathcal{F} = \\begin{pmatrix} \\beta_{HH} & \\beta_{HA} \\\\ \\beta_{AH} & \\beta_{AA} \\end{pmatrix}\n$$\n移除矩阵 $\\mathcal{V}$ 是一个对角矩阵，其元素为人均移除率：\n$$\n\\mathcal{V} = \\begin{pmatrix} \\gamma_H & 0 \\\\ 0 & \\gamma_A \\end{pmatrix}\n$$\n下一代矩阵 $K$ 定义为 $K = \\mathcal{F}\\mathcal{V}^{-1}$。$\\mathcal{V}$ 的逆矩阵为：\n$$\n\\mathcal{V}^{-1} = \\begin{pmatrix} \\frac{1}{\\gamma_H} & 0 \\\\ 0 & \\frac{1}{\\gamma_A} \\end{pmatrix}\n$$\n$\\mathcal{V}^{-1}$ 对角线上的元素 $1/\\gamma_j$ 代表宿主类型 $j$ 的个体平均感染期。\n\n因此，符号形式的 NGM，$K$，为：\n$$\nK = \\mathcal{F}\\mathcal{V}^{-1} = \\begin{pmatrix} \\beta_{HH} & \\beta_{HA} \\\\ \\beta_{AH} & \\beta_{AA} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\gamma_H} & 0 \\\\ 0 & \\frac{1}{\\gamma_A} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\beta_{HH}}{\\gamma_H} & \\frac{\\beta_{HA}}{\\gamma_A} \\\\ \\frac{\\beta_{AH}}{\\gamma_H} & \\frac{\\beta_{AA}}{\\gamma_A} \\end{pmatrix}\n$$\n元素 $K_{ij}$ 代表在一个完全易感的种群中，单个 $j$ 型感染个体在其整个感染期内所引起的 $i$ 种种群中的平均二代感染数。\n\n基本再生数 $R_0$ 是 $K$ 的谱半径（主特征值）。对于一个 $2 \\times 2$ 矩阵 $K = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$，其特征值 $\\lambda$ 是特征方程 $\\lambda^2 - \\text{Tr}(K)\\lambda + \\det(K) = 0$ 的根。谱半径是较大的那个根：\n$$\nR_0 = \\rho(K) = \\frac{\\text{Tr}(K) + \\sqrt{(\\text{Tr}(K))^2 - 4\\det(K)}}{2}\n$$\n代入 $K$ 的符号元素：\n$$\nR_0 = \\frac{1}{2} \\left[ \\left(\\frac{\\beta_{HH}}{\\gamma_H} + \\frac{\\beta_{AA}}{\\gamma_A}\\right) + \\sqrt{\\left(\\frac{\\beta_{HH}}{\\gamma_H} - \\frac{\\beta_{AA}}{\\gamma_A}\\right)^2 + 4\\left(\\frac{\\beta_{HA}}{\\gamma_A}\\right)\\left(\\frac{\\beta_{AH}}{\\gamma_H}\\right)} \\right]\n$$\n现在我们代入给定的数值：\n$\\beta_{HH} = 0.3$, $\\beta_{AA} = 0.5$, $\\beta_{HA} = 0.1$, $\\beta_{AH} = 0.2$ (单位为 day$^{-1}$)\n$\\gamma_{H} = 0.2$, $\\gamma_{A} = 0.25$ (单位为 day$^{-1}$)\n\n数值 NGM 的元素是：\n$K_{HH} = \\frac{\\beta_{HH}}{\\gamma_H} = \\frac{0.3}{0.2} = 1.5$\n$K_{HA} = \\frac{\\beta_{HA}}{\\gamma_A} = \\frac{0.1}{0.25} = 0.4$\n$K_{AH} = \\frac{\\beta_{AH}}{\\gamma_H} = \\frac{0.2}{0.2} = 1.0$\n$K_{AA} = \\frac{\\beta_{AA}}{\\gamma_A} = \\frac{0.5}{0.25} = 2.0$\n\n数值 NGM 是：\n$$\nK = \\begin{pmatrix} 1.5 & 0.4 \\\\ 1.0 & 2.0 \\end{pmatrix}\n$$\n我们计算它的迹和行列式：\n$\\text{Tr}(K) = 1.5 + 2.0 = 3.5$\n$\\det(K) = (1.5)(2.0) - (0.4)(1.0) = 3.0 - 0.4 = 2.6$\n\n现在，我们计算 $R_0$：\n$$\nR_0 = \\frac{3.5 + \\sqrt{(3.5)^2 - 4(2.6)}}{2} = \\frac{3.5 + \\sqrt{12.25 - 10.4}}{2} = \\frac{3.5 + \\sqrt{1.85}}{2}\n$$\n$R_0 \\approx \\frac{3.5 + 1.360147}{2} = \\frac{4.860147}{2} \\approx 2.4300735$\n四舍五入到四位有效数字，$R_0 = 2.430$。\n\n为了确定主导传播途径，我们必须分析 $K$ 的主右特征向量 $v = [v_H, v_A]^T$。该特征向量给出了疫情初始阶段人类和动物种群中新发病例的相对分布。该特征向量满足方程 $Kv = R_0 v$。\n$$\n\\begin{pmatrix} 1.5 & 0.4 \\\\ 1.0 & 2.0 \\end{pmatrix} \\begin{pmatrix} v_H \\\\ v_A \\end{pmatrix} = 2.4300735 \\begin{pmatrix} v_H \\\\ v_A \\end{pmatrix}\n$$\n根据矩阵方程的第二行：\n$1.0 v_H + 2.0 v_A = 2.4300735 v_A$\n$v_H = (2.4300735 - 2.0) v_A = 0.4300735 v_A$\n主特征向量与 $v \\propto [0.430, 1]^T$ 成正比。这表明在疫情爆发初期，人类中每出现约 0.43 例新病例，动物中就会出现 1 例新病例。动物种群承担了更大比例的新增感染。\n\n为确定是哪条途径维持了传播，我们考察这些新感染是如何产生的。下一代感染总数由 $K v$ 给出。这些感染的来源是病例的初始分布，该分布也与 $v$ 成正比。我们可以根据新感染的来源和接收种群来分解它们。设归一化的特征向量为 $v = [0.430, 1]^T$。\n- 来自人类的二代感染总数（与 $v_H$ 成正比）：\n  - 对人类 ($H \\to H$): $K_{HH} v_H = 1.5 \\times 0.430 = 0.645$\n  - 对动物 ($H \\to A$): $K_{AH} v_H = 1.0 \\times 0.430 = 0.430$\n- 来自动物的二代感染总数（与 $v_A$ 成正比）：\n  - 对人类 ($A \\to H$): $K_{HA} v_A = 0.4 \\times 1 = 0.400$\n  - 对动物 ($A \\to A$): $K_{AA} v_A = 2.0 \\times 1 = 2.000$\n\n比较不同传播途径对产生新病例的贡献：\n- 人类内部 ($H \\to H$)：相对贡献为 $0.645$。\n- 动物内部 ($A \\to A$)：相对贡献为 $2.000$。\n- 跨物种 ($H \\leftrightarrow A$): 总相对贡献为 $0.430 + 0.400 = 0.830$。\n\n在指数增长阶段，动物内部的传播途径 ($A \\to A$) 导致了最大比例的新增感染。其贡献 ($2.000$) 远大于人类内部途径 ($0.645$) 和合并的跨物种途径 ($0.830$)。因此，动物种群内部的传播是维持该疫情的主导途径。这与动物内部再生数 $K_{AA} = 2.0$ 是 NGM 中最大元素，以及主特征向量在动物种群上有很大权重的事实相一致。", "answer": "$$\\boxed{2.430}$$", "id": "2515610"}, {"introduction": "在计算出系统的整体 $R_0$ 之后，接下来的关键问题是：哪些传播途径对疫情的贡献最大？为了有效地进行“一体化健康”干预，我们必须能够区分种内传播和跨物种传播的重要性。本练习通过一个精巧的思想实验，引导您从数学上“移除”人类与动物之间的传播桥梁，并推导出由此引起的 $R_0$ 变化量 $\\Delta R_0$。这个过程不仅能加深您对 $R_0$ 构成的理解，还能量化针对跨物种传播的干预措施可能带来的具体效益。[@problem_id:2515630]", "problem": "一种人畜共患病原体在人群和家畜种群之间传播。设人类和动物宿主种群分别用 $H$ 和 $A$ 表示，其总种群规模为 $N_H$ 和 $N_A$，在流行病的时间尺度上保持近似恒定。假设传播遵循质量作用定律，感染期呈指数分布，人类的恢复率为 $\\gamma_H$，动物的恢复率为 $\\gamma_A$。设 $\\beta_{XY}$ 表示从种群 $Y \\in \\{H,A\\}$ 中的一个感染个体到种群 $X \\in \\{H,A\\}$ 中的一个易感个体的单位人均传播率，其中 $\\beta_{HH}$ 和 $\\beta_{AA}$ 代表物种内传播，$\\beta_{HA}$ 和 $\\beta_{AH}$ 代表跨物种传播。假设在无病状态下，基本上所有个体都是易感的，因此 $S_H \\approx N_H$ 且 $S_A \\approx N_A$。\n\n根据基本再生数 $R_0$ 的定义，即下一代算子的谱半径，双种群下一代矩阵的元素等于在一个其他方面完全易感的系统中，引入到种群 $Y$ 中的单个新感染个体在种群 $X$ 中引起的预期二代感染数。利用此定义和标准的质量作用假设，推导在同时存在物种内和跨物种传播情况下的基本再生数 $R_0$，然后通过设置 $\\beta_{HA}=\\beta_{AH}=0$ 移除跨物种传播后重新计算它。设 $\\Delta R_0$ 表示通过移除跨物种传播获得的基本再生数的减少量，即完整 $R_0$（包含跨物种传播）与无跨物种传播的 $R_0$ 之间的差值。\n\n请提供一个关于 $\\Delta R_0$ 的单一闭式解析表达式，用 $\\beta_{HH}$、$\\beta_{AA}$、$\\beta_{HA}$、$\\beta_{AH}$、$\\gamma_H$、$\\gamma_A$、$N_H$ 和 $N_A$ 表示。除这些符号外，不要引入任何新符号。必要时可以使用绝对值。无需进行数值评估，也无需提供单位。\n\n最后，用文字简要解释您得出的 $\\Delta R_0$ 的符号和大小对于针对跨物种传播途径的综合性“同一健康”（One Health, OH）干预措施意味着什么。\n\n您的最终答案必须仅为 $\\Delta R_0$ 的单一解析表达式。无需四舍五入，也无需报告单位。", "solution": "在尝试求解之前，需对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 宿主种群：人类 ($H$)，动物 ($A$)\n- 总种群规模：$N_H$, $N_A$ (恒定)\n- 人类恢复率：$\\gamma_H$。\n- 动物恢复率：$\\gamma_A$。\n- 感染期：呈指数分布，恢复率为 $\\gamma_H$ 和 $\\gamma_A$。\n- 单位人均传播率：$\\beta_{XY}$ 从种群 $Y \\in \\{H,A\\}$ 到种群 $X \\in \\{H,A\\}$。\n- 物种内传播：$\\beta_{HH}$，$\\beta_{AA}$。\n- 跨物种传播：$\\beta_{HA}$，$\\beta_{AH}$。\n- 无病平衡状态下的易感种群近似：$S_H \\approx N_H$, $S_A \\approx N_A$。\n- $R_0$的定义：下一代矩阵的谱半径。\n- $\\Delta R_0$的定义：完整 $R_0$（包含跨物种传播）与无跨物种传播的 $R_0$（其中 $\\beta_{HA}=\\beta_{AH}=0$）之间的差值。\n\n**步骤2：验证**\n- **科学依据：** 该问题对双种群系统使用了标准的易感-感染-恢复（SIR）框架，这是数理流行病学的基石。使用下一代矩阵计算基本再生数 $R_0$ 是一种严谨且被广泛接受的方法。所有概念在该领域内均已成熟确立。\n- **适定性：** 该问题提供了所有必要的参数和一个明确的目标：推导一个特定量 $\\Delta R_0$。其设定允许一个唯一、稳定且有意义的解。\n- **客观性：** 该问题以精确的数学和流行病学术语陈述，没有主观性或模糊性。\n\n**步骤3：结论与行动**\n该问题具有科学合理性、适定性、客观性和完整性。因此，该问题被认定为**有效**。我们继续进行求解推导。\n\n分析基于为两个感染仓室（受感染的人类 $I_H$ 和受感染的动物 $I_A$）构建下一代矩阵 $K$。该矩阵的元素 $K_{ij}$ 表示在一个其他方面完全易感的种群中，由种群 $j$ 中的单个感染个体在其整个感染期内在种群 $i$ 中产生的预期二代感染数。\n\n由种群 $Y$ 中的一个感染个体在种群 $X$ 中引起的新感染率为 $\\beta_{XY} S_X$。鉴于在无病状态下 $S_X \\approx N_X$ 的假设，该率变为 $\\beta_{XY} N_X$。种群 $Y$ 中个体的平均感染期为 $\\frac{1}{\\gamma_Y}$。\n\n因此，完整的 $2 \\times 2$ 下一代矩阵 $K_{\\text{full}}$ 的元素为：\n- $K_{11}$（人类来自人类）：感染率为 $\\beta_{HH} N_H$。平均感染期为 $\\frac{1}{\\gamma_H}$。因此，$K_{11} = \\frac{\\beta_{HH} N_H}{\\gamma_H}$。\n- $K_{12}$（人类来自动物）：感染率为 $\\beta_{HA} N_H$。平均感染期为 $\\frac{1}{\\gamma_A}$。因此，$K_{12} = \\frac{\\beta_{HA} N_H}{\\gamma_A}$。\n- $K_{21}$（动物来自人类）：感染率为 $\\beta_{AH} N_A$。平均感染期为 $\\frac{1}{\\gamma_H}$。因此，$K_{21} = \\frac{\\beta_{AH} N_A}{\\gamma_H}$。\n- $K_{22}$（动物来自动物）：感染率为 $\\beta_{AA} N_A$。平均感染期为 $\\frac{1}{\\gamma_A}$。因此，$K_{22} = \\frac{\\beta_{AA} N_A}{\\gamma_A}$。\n\n完整的下一代矩阵为：\n$$ K_{\\text{full}} = \\begin{pmatrix} \\frac{\\beta_{HH} N_H}{\\gamma_H} & \\frac{\\beta_{HA} N_H}{\\gamma_A} \\\\ \\frac{\\beta_{AH} N_A}{\\gamma_H} & \\frac{\\beta_{AA} N_A}{\\gamma_A} \\end{pmatrix} $$\n\n基本再生数 $R_{0,\\text{full}}$ 是 $K_{\\text{full}}$ 的谱半径，也就是其最大特征值。我们通过求解特征方程 $\\det(K_{\\text{full}} - \\lambda I) = 0$ 来找到特征值 $\\lambda$。\n为简化起见，我们将物种内再生数表示为 $R_{H} = \\frac{\\beta_{HH} N_H}{\\gamma_H}$ 和 $R_{A} = \\frac{\\beta_{AA} N_A}{\\gamma_A}$。特征方程为：\n$$ \\left(R_H - \\lambda\\right)\\left(R_A - \\lambda\\right) - \\left(\\frac{\\beta_{HA} N_H}{\\gamma_A}\\right)\\left(\\frac{\\beta_{AH} N_A}{\\gamma_H}\\right) = 0 $$\n$$ \\lambda^2 - (R_H + R_A)\\lambda + R_H R_A - \\frac{\\beta_{HA}\\beta_{AH}N_H N_A}{\\gamma_H \\gamma_A} = 0 $$\n根据二次公式求得的 $\\lambda$ 的解为：\n$$ \\lambda = \\frac{(R_H + R_A) \\pm \\sqrt{(R_H + R_A)^2 - 4(R_H R_A - \\frac{\\beta_{HA}\\beta_{AH}N_H N_A}{\\gamma_H \\gamma_A})}}{2} $$\n$$ \\lambda = \\frac{(R_H + R_A) \\pm \\sqrt{(R_H - R_A)^2 + 4\\frac{\\beta_{HA}\\beta_{AH}N_H N_A}{\\gamma_H \\gamma_A}}}{2} $$\n$R_{0,\\text{full}}$ 是较大的特征值（取“+”号）：\n$$ R_{0,\\text{full}} = \\frac{1}{2}\\left(R_H + R_A + \\sqrt{(R_H - R_A)^2 + 4\\frac{\\beta_{HA}\\beta_{AH}N_H N_A}{\\gamma_H \\gamma_A}}\\right) $$\n\n接下来，我们计算在没有跨物种传播情况下的 $R_0$。设 $\\beta_{HA} = 0$ 和 $\\beta_{AH} = 0$，下一代矩阵变为对角矩阵：\n$$ K_{\\text{no-cross}} = \\begin{pmatrix} R_H & 0 \\\\ 0 & R_A \\end{pmatrix} $$\n特征值是对角线元素 $R_H$ 和 $R_A$。谱半径是这些值的最大值，因为只要任一种群能够单独维持传播，病原体就能持续存在。\n$$ R_{0,\\text{no-cross}} = \\max(R_H, R_A) $$\n使用恒等式 $\\max(a, b) = \\frac{1}{2}(a+b + |a-b|)$，我们可以将其写为：\n$$ R_{0,\\text{no-cross}} = \\frac{1}{2}(R_H + R_A + |R_H - R_A|) $$\n\n最后，我们计算基本再生数的减少量 $\\Delta R_0 = R_{0,\\text{full}} - R_{0,\\text{no-cross}}$。\n$$ \\Delta R_0 = \\frac{1}{2}\\left(R_H + R_A + \\sqrt{(R_H - R_A)^2 + 4\\frac{\\beta_{HA}\\beta_{AH}N_H N_A}{\\gamma_H \\gamma_A}}\\right) - \\frac{1}{2}(R_H + R_A + |R_H - R_A|) $$\n项 $(R_H + R_A)$ 被抵消。注意到 $|x| = \\sqrt{x^2}$，我们有 $|R_H - R_A| = \\sqrt{(R_H - R_A)^2}$。\n$$ \\Delta R_0 = \\frac{1}{2}\\left(\\sqrt{(R_H - R_A)^2 + 4\\frac{\\beta_{HA}\\beta_{AH}N_H N_A}{\\gamma_H \\gamma_A}} - \\sqrt{(R_H - R_A)^2}\\right) $$\n代回 $R_H$ 和 $R_A$ 的完整表达式：\n$$ \\Delta R_0 = \\frac{1}{2}\\left(\\sqrt{\\left(\\frac{\\beta_{HH} N_H}{\\gamma_H} - \\frac{\\beta_{AA} N_A}{\\gamma_A}\\right)^2 + 4\\frac{\\beta_{HA}\\beta_{AH}N_H N_A}{\\gamma_H \\gamma_A}} - \\left|\\frac{\\beta_{HH} N_H}{\\gamma_H} - \\frac{\\beta_{AA} N_A}{\\gamma_A}\\right|\\right) $$\n这就是 $\\Delta R_0$ 的最终闭式解析表达式。\n\n**解释：**\n$\\Delta R_0$ 的符号必然是非负的（$\\Delta R_0 \\ge 0$），因为所有参数都是非负的，且对于任意非负的 $X$ 和 $Y$，都有 $\\sqrt{X+Y} \\ge \\sqrt{X}$。这证实了一个逻辑预期，即移除传播途径不会增加病原体的繁殖能力。只有当跨物种传播不存在时（即 $\\beta_{HA}\\beta_{AH}=0$），其值才为零。\n\n$\\Delta R_0$ 的大小量化了跨物种传播对整体流行潜力的协同贡献。对于“同一健康”（One Health）干预措施而言，这个值至关重要。一个大的 $\\Delta R_0$ 值表明，连接人类和动物种群的“桥梁”是疫情爆发的主要驱动因素。在这种情况下，旨在切断这些跨物种联系的综合干预措施——例如动物疫苗接种、扑杀、加强生物安全或限制人畜接触——将非常有效，从而显著降低整体 $R_0$。相反，一个小的 $\\Delta R_0$ 值意味着传播主要在单个或两个种群内部独立维持。在这种情况下，“同一健康”策略必须优先考虑宿主种群内部的控制措施，而不是仅仅关注交界面。因此，$\\Delta R_0$ 的大小为在基于交界面的控制措施和针对特定种群的控制措施之间分配资源提供了定量依据。", "answer": "$$\\boxed{\\frac{1}{2}\\left(\\sqrt{\\left(\\frac{\\beta_{HH} N_H}{\\gamma_H} - \\frac{\\beta_{AA} N_A}{\\gamma_A}\\right)^2 + 4\\frac{\\beta_{HA}\\beta_{AH}N_H N_A}{\\gamma_H \\gamma_A}} - \\left|\\frac{\\beta_{HH} N_H}{\\gamma_H} - \\frac{\\beta_{AA} N_A}{\\gamma_A}\\right|\\right)}$$", "id": "2515630"}, {"introduction": "将理论模型转化为有效的公共卫生行动，需要依赖于跨部门的综合监测系统。然而，在现实世界中，监测资源（如资金和人力）总是有限的。本练习模拟了一个典型的“一体化健康”挑战：如何在满足人类、牲畜和野生动物三个不同群体的最低病原体检出率要求的同时，设计一个总成本最低的抽样方案。通过解决这个优化问题，您将学会如何运用定量方法来制定兼具科学严谨性和成本效益的综合监测策略。[@problem_id:2515632]", "problem": "“同一健康”（One Health）框架下的综合性人畜共患病原体监测需要在人类、牲畜和野生动物部门之间进行协调抽样。考虑一个包含三个分层（人类、牲畜和野生动物）的分层设计。假设相对于抽样比例，每个分层中的种群数量巨大，可视为无限；采用简单随机抽样；个体间的感染状态相互独立；并且分层 $i$ 中受感染个体的诊断测试结果为阳性的概率等于该分层中的测试灵敏度。设分层 $i$ 的设计患病率为 $p_i$，单个个体的测试灵敏度为 $\\sigma_i$，每个样本的成本为 $c_i$ 美元（USD），在该分层中检测到至少一个受感染个体的最小要求概率为 $\\beta_i$。您必须确定每个分层的样本量 $n_i$（整数），以在满足各部门特定检测约束的同时，最小化总成本。\n\n使用以下经验上合理的参数：\n- 人类：$p_{\\mathrm{H}} = 0.004$，$\\sigma_{\\mathrm{H}} = 0.97$，$\\beta_{\\mathrm{H}} = 0.90$，$c_{\\mathrm{H}} = 250$。\n- 牲畜：$p_{\\mathrm{L}} = 0.015$，$\\sigma_{\\mathrm{L}} = 0.92$，$\\beta_{\\mathrm{L}} = 0.95$，$c_{\\mathrm{L}} = 70$。\n- 野生动物：$p_{\\mathrm{W}} = 0.010$，$\\sigma_{\\mathrm{W}} = 0.85$，$\\beta_{\\mathrm{W}} = 0.80$，$c_{\\mathrm{W}} = 320$。\n\n从感染的独立伯努利试验和条件性测试阳性的第一性原理出发，推导出一个表达式，用于计算确保在分层 $i$ 中满足检测概率约束的最小整数样本量 $n_i$。然后，确定在满足三个部门特定约束条件的情况下，使总成本 $C = c_{\\mathrm{H}} n_{\\mathrm{H}} + c_{\\mathrm{L}} n_{\\mathrm{L}} + c_{\\mathrm{W}} n_{\\mathrm{W}}$ 最小化的最优三元组 $(n_{\\mathrm{H}}, n_{\\mathrm{L}}, n_{\\mathrm{W}})$。最后，计算最小化的总成本 $C$。\n\n用美元（USD）表示最终的最小化总成本。无需四舍五入。", "solution": "对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- 分层：人类（H）、牲畜（L）、野生动物（W）。共 $3$ 个分层。\n- 种群模型：每个分层中的种群数量巨大，可视为无限。\n- 抽样模型：在每个分层内进行简单随机抽样。\n- 感染模型：所有个体间的感染状态相互独立。\n- 诊断测试模型：对分层 $i$ 中受感染个体的测试以概率 $\\sigma_i$（灵敏度）得出阳性结果。\n- 分层 $i$ 的参数：\n    - $p_i$：设计患病率。\n    - $\\sigma_i$：单个个体测试灵敏度。\n    - $c_i$：每个样本的成本（美元，USD）。\n    - $\\beta_i$：检测到至少一个受感染个体的最小要求概率。\n    - $n_i$：整数样本量。\n- 目标函数：最小化总成本 $C = c_{\\mathrm{H}} n_{\\mathrm{H}} + c_{\\mathrm{L}} n_{\\mathrm{L}} + c_{\\mathrm{W}} n_{\\mathrm{W}}$。\n- 约束条件：每个分层 $i$ 的检测概率必须至少为 $\\beta_i$。\n- 具体参数值：\n    - 人类：$p_{\\mathrm{H}} = 0.004$，$\\sigma_{\\mathrm{H}} = 0.97$，$\\beta_{\\mathrm{H}} = 0.90$，$c_{\\mathrm{H}} = 250$。\n    - 牲畜：$p_{\\mathrm{L}} = 0.015$，$\\sigma_{\\mathrm{L}} = 0.92$，$\\beta_{\\mathrm{L}} = 0.95$，$c_{\\mathrm{L}} = 70$。\n    - 野生动物：$p_{\\mathrm{W}} = 0.010$，$\\sigma_{\\mathrm{W}} = 0.85$，$\\beta_{\\mathrm{W}} = 0.80$，$c_{\\mathrm{W}} = 320$。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据，是概率论在流行病学监测设计中的一个标准应用，而监测设计是“同一健康”框架下生态学和环境生物学的核心课题。模型假设（大种群、独立伯努利试验）是恰当的，并且在此类分析中很常见。该问题是适定的；它是一个带有线性目标函数和可分离、明确定义的约束条件的约束优化问题，预计存在唯一解。所有必要数据均已提供，且无内生矛盾。语言客观而精确。该问题并非无足轻重，因为它需要从第一性原理进行推导和后续计算。因此，该问题被认定为有效。\n\n**第三步：结论与行动**\n问题有效。将提供解答。\n\n**推导与求解**\n问题在于确定样本量 $(n_{\\mathrm{H}}, n_{\\mathrm{L}}, n_{\\mathrm{W}})$，以在满足各分层特定检测概率约束的条件下，最小化总成本。该优化问题是可分离的，意味着我们可以独立确定每个分层所需的最小样本量。\n\n我们考虑单个分层 $i$。对于从该分层中随机选择的一个个体，要将其计为一个检测到的阳性病例，必须发生两个独立事件：该个体必须被感染（概率为 $p_i$），并且诊断测试必须返回阳性结果（条件概率为 $\\sigma_i$）。单个随机抽样的个体既被感染又检测呈阳性的概率是这些概率的乘积，我们将其定义为有效的单一个体检测概率 $\\pi_i$。\n$$ \\pi_i = p_i \\sigma_i $$\n其互补事件，即单个抽样个体*未*被检测为阳性病例，其概率为 $1 - \\pi_i$。这种情况发生在个体未被感染（概率为 $1-p_i$）或个体虽被感染但测试失败（概率为 $p_i(1-\\sigma_i)$）时。总概率为 $(1-p_i) + p_i(1-\\sigma_i) = 1 - p_i\\sigma_i = 1 - \\pi_i$。\n\n鉴于我们采集了 $n_i$ 个个体的样本，并假设个体之间相互独立（大种群假设为此提供了依据），在整个样本中*未*检测到任何阳性病例的概率，是所有 $n_i$ 次独立试验均未检测到阳性结果的概率。该概率为 $(1-\\pi_i)^{n_i}$。\n\n在样本中检测到至少一个阳性病例的概率是该事件的补集：\n$$ P(\\text{在分层 i 中检测到}) = 1 - (1 - \\pi_i)^{n_i} = 1 - (1 - p_i \\sigma_i)^{n_i} $$\n问题要求此概率至少为 $\\beta_i$：\n$$ 1 - (1 - p_i \\sigma_i)^{n_i} \\ge \\beta_i $$\n我们现在必须为整数样本量 $n_i$ 求解此不等式。\n$$ 1 - \\beta_i \\ge (1 - p_i \\sigma_i)^{n_i} $$\n对两边取自然对数是允许的，因为两边都是小于1的正数。\n$$ \\ln(1 - \\beta_i) \\ge \\ln\\left((1 - p_i \\sigma_i)^{n_i}\\right) $$\n$$ \\ln(1 - \\beta_i) \\ge n_i \\ln(1 - p_i \\sigma_i) $$\n为分离出 $n_i$，我们用 $\\ln(1 - p_i \\sigma_i)$ 去除。因为 $p_i > 0$ 且 $\\sigma_i > 0$，所以 $0 < p_i \\sigma_i < 1$，这意味着 $\\ln(1 - p_i \\sigma_i)$ 是一个负数。除以一个负数会反转不等号：\n$$ n_i \\ge \\frac{\\ln(1 - \\beta_i)}{\\ln(1 - p_i \\sigma_i)} $$\n由于 $n_i$ 必须是整数，分层 $i$ 所需的最小样本量（我们记作 $n_i^*$）是满足此条件的最小整数。这由向上取整函数（ceiling function）给出：\n$$ n_i^* = \\left\\lceil \\frac{\\ln(1 - \\beta_i)}{\\ln(1 - p_i \\sigma_i)} \\right\\rceil $$\n目标是最小化总成本 $C = \\sum_i c_i n_i$。由于所有成本 $c_i$ 均为正，总成本 $C$ 是每个 $n_i$ 的单调递增函数。为最小化 $C$，我们必须为每个 $n_i$ 选择满足其各自约束的最小可能整数值。因此，每个分层的最优样本量恰好是其所需的最小值 $n_i^*$。\n\n现在我们使用给定参数将此公式应用于每个分层。\n\n**人类分层 (H):**\n$p_{\\mathrm{H}} = 0.004$，$\\sigma_{\\mathrm{H}} = 0.97$，$\\beta_{\\mathrm{H}} = 0.90$，$c_{\\mathrm{H}} = 250$。\n有效检测概率为 $\\pi_{\\mathrm{H}} = p_{\\mathrm{H}} \\sigma_{\\mathrm{H}} = 0.004 \\times 0.97 = 0.00388$。\n$$ n_{\\mathrm{H}} = \\left\\lceil \\frac{\\ln(1 - 0.90)}{\\ln(1 - 0.00388)} \\right\\rceil = \\left\\lceil \\frac{\\ln(0.10)}{\\ln(0.99612)} \\right\\rceil \\approx \\lceil 592.28 \\rceil = 593 $$\n\n**牲畜分层 (L):**\n$p_{\\mathrm{L}} = 0.015$，$\\sigma_{\\mathrm{L}} = 0.92$，$\\beta_{\\mathrm{L}} = 0.95$，$c_{\\mathrm{L}} = 70$。\n有效检测概率为 $\\pi_{\\mathrm{L}} = p_{\\mathrm{L}} \\sigma_{\\mathrm{L}} = 0.015 \\times 0.92 = 0.0138$。\n$$ n_{\\mathrm{L}} = \\left\\lceil \\frac{\\ln(1 - 0.95)}{\\ln(1 - 0.0138)} \\right\\rceil = \\left\\lceil \\frac{\\ln(0.05)}{\\ln(0.9862)} \\right\\rceil \\approx \\lceil 215.58 \\rceil = 216 $$\n\n**野生动物分层 (W):**\n$p_{\\mathrm{W}} = 0.010$，$\\sigma_{\\mathrm{W}} = 0.85$，$\\beta_{\\mathrm{W}} = 0.80$，$c_{\\mathrm{W}} = 320$。\n有效检测概率为 $\\pi_{\\mathrm{W}} = p_{\\mathrm{W}} \\sigma_{\\mathrm{W}} = 0.010 \\times 0.85 = 0.0085$。\n$$ n_{\\mathrm{W}} = \\left\\lceil \\frac{\\ln(1 - 0.80)}{\\ln(1 - 0.0085)} \\right\\rceil = \\left\\lceil \\frac{\\ln(0.20)}{\\ln(0.9915)} \\right\\rceil \\approx \\lceil 188.55 \\rceil = 189 $$\n\n在满足所有约束条件下，使总成本最小化的最优样本量三元组为 $(n_{\\mathrm{H}}, n_{\\mathrm{L}}, n_{\\mathrm{W}}) = (593, 216, 189)$。\n\n最后，我们使用这些样本量和给定的单位样本成本来计算最小化的总成本 $C$。\n$$ C = c_{\\mathrm{H}} n_{\\mathrm{H}} + c_{\\mathrm{L}} n_{\\mathrm{L}} + c_{\\mathrm{W}} n_{\\mathrm{W}} $$\n$$ C = (250 \\times 593) + (70 \\times 216) + (320 \\times 189) $$\n$$ C = 148250 + 15120 + 60480 $$\n$$ C = 223850 $$\n该监测项目的最小化总成本为 $223850$ 美元（USD）。", "answer": "$$\\boxed{223850}$$", "id": "2515632"}]}