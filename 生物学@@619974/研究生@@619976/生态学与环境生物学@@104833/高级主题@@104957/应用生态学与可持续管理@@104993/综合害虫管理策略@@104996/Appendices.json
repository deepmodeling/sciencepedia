{"hands_on_practices": [{"introduction": "综合虫害管理（IPM）的根本在于做出经济上合理的决策。第一个实践让你扮演一位农艺师，任务是确定最有利可图的害虫控制水平。通过将边际分析原理应用于一个实际的剂量-反应模型，你将计算出使利润最大化的最佳生物农药剂量 $D^*$，从而探索控制成本与作物收益之间的关键权衡。[@problem_id:2499149]", "problem": "一位农学家正在为一片麦田设计综合虫害管理（IPM）方案，他必须选择一种生物农药的施用剂量，记为 $D$（单位为 $\\mathrm{L\\ ha^{-1}}$），以控制一种会降低产量的害虫。在剂量 $D$ 下的预期可销售产量模型为\n$$\nY(D) \\;=\\; Y_{\\min} \\;+\\; \\bigl(Y_{\\max} - Y_{\\min}\\bigr)\\,\\bigl(1 - \\exp(-k\\,D)\\bigr),\n$$\n该模型以标准的剂量-反应形式体现了收益递减。其中 $Y_{\\min}$ 是零干预时的预期可销售产量，$Y_{\\max}$ 是在近乎完全控制下可达到的产量，$k$ 是一个正的反应参数。施用剂量 $D$ 的每公顷总成本为\n$$\nC(D) \\;=\\; c\\,D \\;+\\; F,\n$$\n其中 $c$ 是单位剂量的可变成本，$F$ 是与病虫害侦察和施用准备相关的每公顷固定成本。作物价格为 $V$（单位产量的收入）。该农学家旨在选择 $D$ 以最大化利润\n$$\n\\Pi(D) \\;=\\; V\\,Y(D) \\;-\\; C(D).\n$$\n假设为单次施用，并且对于所有 $D \\ge 0$，剂量-反应均表现出边际收益递减。\n\n给定以下参数值：\n- $Y_{\\min} = 3\\,\\mathrm{t\\ ha^{-1}}$，\n- $Y_{\\max} = 7\\,\\mathrm{t\\ ha^{-1}}$，\n- $k = 0.6\\,\\mathrm{(L\\ ha^{-1})^{-1}}$，\n- $V = 300\\,\\mathrm{USD\\ t^{-1}}$，\n- $c = 180\\,\\mathrm{USD\\ L^{-1}}$，\n- $F = 50\\,\\mathrm{USD\\ ha^{-1}}$，\n\n确定在所述假设下能使利润 $\\Pi(D)$ 最大化的经济最优剂量 $D^{\\ast}$（单位为 $\\mathrm{L\\ ha^{-1}}$）。将答案四舍五入至三位有效数字。以 $\\mathrm{L\\ ha^{-1}}$ 为单位表示该剂量。", "solution": "对所述问题进行验证。\n\n**步骤 1：提取已知信息**\n- 预期可销售产量函数：$Y(D) = Y_{\\min} + \\bigl(Y_{\\max} - Y_{\\min}\\bigr)\\,\\bigl(1 - \\exp(-k\\,D)\\bigr)$\n- 总成本函数：$C(D) = c\\,D + F$\n- 利润函数：$\\Pi(D) = V\\,Y(D) - C(D)$\n- 参数值：\n  - $Y_{\\min} = 3\\,\\mathrm{t\\ ha^{-1}}$\n  - $Y_{\\max} = 7\\,\\mathrm{t\\ ha^{-1}}$\n  - $k = 0.6\\,\\mathrm{(L\\ ha^{-1})^{-1}}$\n  - $V = 300\\,\\mathrm{USD\\ t^{-1}}$\n  - $c = 180\\,\\mathrm{USD\\ L^{-1}}$\n  - $F = 50\\,\\mathrm{USD\\ ha^{-1}}$\n- 目标：确定在 $D \\ge 0$ 范围内使 $\\Pi(D)$ 最大化的最优剂量 $D^{\\ast}$。\n- 假设：对于所有 $D \\ge 0$，剂量-反应均表现出边际收益递减。\n\n**步骤 2：使用提取的已知信息进行验证**\n问题具有科学依据。产量函数 $Y(D)$ 是剂量-反应分析中使用的标准单分子生长模型。成本函数 $C(D)$ 是一个简单的线性模型。这些是农业经济学中常用且适当的形式化方法。目标是最大化利润，这是微观经济学中的一个标准问题。\n\n问题是适定的。利润函数 $\\Pi(D)$ 是关于剂量 $D$ 的连续且二阶可导函数。为检查产量的边际收益递减，我们计算 $Y(D)$ 对 $D$ 的一阶和二阶导数：\n一阶导数，即边际产量，为：\n$$ \\frac{dY}{dD} = k(Y_{\\max} - Y_{\\min})\\exp(-kD) $$\n因为 $k>0$ 且 $Y_{\\max} > Y_{\\min}$，所以对所有 $D$ 都有 $\\frac{dY}{dD} > 0$，这是符合逻辑的。\n二阶导数为：\n$$ \\frac{d^2Y}{dD^2} = -k^2(Y_{\\max} - Y_{\\min})\\exp(-kD) $$\n因为 $k^2 > 0$ 且 $Y_{\\max} > Y_{\\min}$，所以对所有 $D \\ge 0$ 都有 $\\frac{d^2Y}{dD^2} < 0$。这证实了所述的边际收益递减假设是该模型所固有的。\n\n问题是客观的，因为所有项都由精确的数学公式和数值定义。单位在内部是自洽的。问题是自足的，并为得到唯一解提供了所有必要信息。\n\n**步骤 3：结论与行动**\n问题有效。接下来将推导求解。\n\n目标是找到使利润函数 $\\Pi(D)$ 最大化的剂量 $D$。每公顷的利润由下式给出：\n$$ \\Pi(D) = V\\,Y(D) - C(D) $$\n代入 $Y(D)$ 和 $C(D)$ 的表达式：\n$$ \\Pi(D) = V\\left[Y_{\\min} + \\bigl(Y_{\\max} - Y_{\\min}\\bigr)\\,\\bigl(1 - \\exp(-k\\,D)\\bigr)\\right] - \\left(c\\,D + F\\right) $$\n为了找到最优剂量 $D^{\\ast}$，我们必须找到使利润函数对 $D$ 的一阶导数等于零的 $D$ 值。这是一阶最大化条件。\n$$ \\frac{d\\Pi}{dD} = V\\frac{dY}{dD} - \\frac{dC}{dD} = 0 $$\n让我们计算各个导数：\n$$ \\frac{dY}{dD} = \\frac{d}{dD}\\left[Y_{\\min} + \\bigl(Y_{\\max} - Y_{\\min}\\bigr)\\,\\bigl(1 - \\exp(-k\\,D)\\bigr)\\right] = k\\bigl(Y_{\\max} - Y_{\\min}\\bigr)\\exp(-k\\,D) $$\n$$ \\frac{dC}{dD} = \\frac{d}{dD}\\left[c\\,D + F\\right] = c $$\n注意，固定成本 $F$ 不影响最优剂量，因为它是一个相对于 $D$ 的常数。\n在最优剂量 $D = D^{\\ast}$ 处，令利润函数的导数等于零：\n$$ V\\left[k\\bigl(Y_{\\max} - Y_{\\min}\\bigr)\\exp(-k\\,D^{\\ast})\\right] - c = 0 $$\n这个方程代表了经济学原理：当边际收入等于边际成本时，利润最大化。在这里，增加一个单位剂量的边际收入是 $V \\frac{dY}{dD}$，边际成本是 $c$。\n现在我们求解 $D^{\\ast}$：\n$$ V k \\bigl(Y_{\\max} - Y_{\\min}\\bigr)\\exp(-k\\,D^{\\ast}) = c $$\n$$ \\exp(-k\\,D^{\\ast}) = \\frac{c}{V k \\bigl(Y_{\\max} - Y_{\\min}\\bigr)} $$\n对两边取自然对数：\n$$ -k\\,D^{\\ast} = \\ln\\left(\\frac{c}{V k \\bigl(Y_{\\max} - Y_{\\min}\\bigr)}\\right) $$\n$$ D^{\\ast} = -\\frac{1}{k}\\ln\\left(\\frac{c}{V k \\bigl(Y_{\\max} - Y_{\\min}\\bigr)}\\right) $$\n利用对数性质 $\\ln(1/x) = -\\ln(x)$，我们可以将其写为：\n$$ D^{\\ast} = \\frac{1}{k}\\ln\\left(\\frac{V k \\bigl(Y_{\\max} - Y_{\\min}\\bigr)}{c}\\right) $$\n为了存在一个最优剂量 $D^{\\ast} > 0$，对数的参数必须大于1，即 $V k (Y_{\\max} - Y_{\\min}) > c$。这个条件表明，在 $D=0$ 时的初始边际收入必须超过边际成本。\n\n为确认这是一个最大值，我们检查二阶条件。利润函数的二阶导数是：\n$$ \\frac{d^2\\Pi}{dD^2} = V\\frac{d^2Y}{dD^2} = V\\left[-k^2\\bigl(Y_{\\max} - Y_{\\min}\\bigr)\\exp(-k\\,D)\\right] = -V k^2 \\bigl(Y_{\\max} - Y_{\\min}\\bigr)\\exp(-k\\,D) $$\n鉴于 $V>0$、$k>0$ 且 $Y_{\\max} > Y_{\\min}$，二阶导数 $\\frac{d^2\\Pi}{dD^2}$ 对所有 $D \\ge 0$ 都是严格为负的。这证明了利润函数 $\\Pi(D)$ 是严格凹函数，因此临界点 $D^{\\ast}$ 对应唯一的全局最大值。\n\n现在，我们代入给定的数值：\n$Y_{\\max} - Y_{\\min} = 7 - 3 = 4\\,\\mathrm{t\\ ha^{-1}}$\n$V = 300\\,\\mathrm{USD\\ t^{-1}}$\n$k = 0.6\\,\\mathrm{(L\\ ha^{-1})^{-1}}$\n$c = 180\\,\\mathrm{USD\\ L^{-1}}$\n\n首先，我们检查内部解的条件：\n$V k (Y_{\\max} - Y_{\\min}) = 300 \\times 0.6 \\times 4 = 720\\,\\mathrm{USD\\ L^{-1}}$。\n由于 $720 > 180$（即 $c$），该条件得到满足，存在一个最优剂量 $D^{\\ast}>0$。\n\n将这些值代入 $D^{\\ast}$ 的表达式中：\n$$ D^{\\ast} = \\frac{1}{0.6}\\ln\\left(\\frac{300 \\times 0.6 \\times 4}{180}\\right) $$\n$$ D^{\\ast} = \\frac{1}{0.6}\\ln\\left(\\frac{720}{180}\\right) $$\n$$ D^{\\ast} = \\frac{1}{0.6}\\ln(4) $$\n使用值 $\\ln(4) \\approx 1.386294$：\n$$ D^{\\ast} \\approx \\frac{1.386294}{0.6} \\approx 2.31049\\,\\mathrm{L\\ ha^{-1}} $$\n根据问题要求，将结果四舍五入到三位有效数字，我们得到：\n$$ D^{\\ast} \\approx 2.31\\,\\mathrm{L\\ ha^{-1}} $$", "answer": "$$\n\\boxed{2.31}\n$$", "id": "2499149"}, {"introduction": "有效的IPM决策依赖于可靠的数据，而数据收集的基石是精心设计的抽样方案。本练习要求你确定在特定精度水平下估算害虫密度所需的样本数量 $n$。你将使用负二项分布——一种常见的聚集型害虫种群模型——来推导并应用一个公式，以确保你的监测工作在统计上既稳健又高效。[@problem_id:2499122]", "problem": "在一项害虫综合治理（IPM）项目中，田间昆虫学家必须确定初级抽样单元（例如，叶片或样方）的数量，以便以预先设定的相对精度来估计平均害虫密度。经验证据支持使用均值为 $m$、聚集参数为 $k$ 的负二项分布来模拟每个抽样单元中的害虫数量，其方差可以很好地用 $m + \\frac{m^{2}}{k}$ 来描述。Green 方案中使用的固定精度准则是，样本均值的相对标准误（定义为样本均值的标准误除以真实均值）不超过目标值 $D$。\n\n从负二项分布的均值和方差的定义，以及 $n$ 个独立同分布抽样单元的样本均值的方差出发，推导出一个满足固定精度准则的最小 $n$ 的表达式（作为 $m$、$k$ 和 $D$ 的函数）。然后，当 $k = 1.2$，$m = 5$，$D = 0.25$ 时，计算这个表达式的值。报告满足固定精度准则的最小整数 $n$。无需按有效数字进行四舍五入；报告最小整数。", "solution": "所述问题是有效的。这是一个统计生态学中的适定问题，基于抽样理论和种群模型的既定原则。所有必要信息都已提供，目标明确且可形式化。我们现在开始推导和求解。\n\n设 $X_i$（其中 $i = 1, 2, \\dots, n$）为在第 $i$ 个初级抽样单元中计数的害虫数量。问题陈述这些是独立同分布（i.i.d.）的随机变量。$X_i$ 的分布是负二项分布。\n\n该分布的均值给出为：\n$$E[X_i] = m$$\n\n方差给出为：\n$$\\text{Var}(X_i) = \\sigma^2 = m + \\frac{m^2}{k}$$\n其中 $k$是聚集参数。\n\n目标是使用样本均值 $\\bar{X}$ 来估计真实平均害虫密度 $m$，样本均值定义为：\n$$\\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i$$\n\n样本均值的期望值为：\n$$E[\\bar{X}] = E\\left[\\frac{1}{n} \\sum_{i=1}^{n} X_i\\right] = \\frac{1}{n} \\sum_{i=1}^{n} E[X_i] = \\frac{1}{n} (n \\cdot m) = m$$\n这表明样本均值 $\\bar{X}$ 是真实均值 $m$ 的一个无偏估计量。\n\n由于变量 $X_i$ 的独立性，样本均值的方差为：\n$$\\text{Var}(\\bar{X}) = \\text{Var}\\left(\\frac{1}{n} \\sum_{i=1}^{n} X_i\\right) = \\frac{1}{n^2} \\sum_{i=1}^{n} \\text{Var}(X_i) = \\frac{1}{n^2} (n \\cdot \\sigma^2) = \\frac{\\sigma^2}{n}$$\n\n样本均值的标准误，记为 $SE(\\bar{X})$，是其方差的平方根：\n$$SE(\\bar{X}) = \\sqrt{\\text{Var}(\\bar{X})} = \\sqrt{\\frac{\\sigma^2}{n}} = \\frac{\\sigma}{\\sqrt{n}}$$\n\n问题规定了一个基于样本均值相对标准误的固定精度准则。相对标准误定义为样本均值的标准误除以真实均值 $m$。该数量不得超过一个预设值 $D$。此准则的数学表述为：\n$$\\frac{SE(\\bar{X})}{m} \\le D$$\n\n代入我们关于 $SE(\\bar{X})$ 的表达式：\n$$\\frac{\\sigma/{\\sqrt{n}}}{m} \\le D$$\n\n我们现在必须就样本量 $n$ 解这个不等式。\n$$\\frac{\\sigma}{m\\sqrt{n}} \\le D$$\n重新整理各项以分离出 $n$：\n$$\\sqrt{n} \\ge \\frac{\\sigma}{mD}$$\n不等式两边平方，得到最小样本量的条件：\n$$n \\ge \\left(\\frac{\\sigma}{mD}\\right)^2 = \\frac{\\sigma^2}{m^2 D^2}$$\n\n现在，我们代入给定的方差表达式 $\\sigma^2 = m + \\frac{m^2}{k}$：\n$$n \\ge \\frac{m + \\frac{m^2}{k}}{m^2 D^2}$$\n这个表达式可以通过分配分母来简化：\n$$n \\ge \\frac{m}{m^2 D^2} + \\frac{m^2/k}{m^2 D^2}$$\n$$n \\ge \\frac{1}{m D^2} + \\frac{1}{k D^2}$$\n提出公因式 $\\frac{1}{D^2}$，我们得到最小样本量 $n$ 作为 $m$、$k$ 和 $D$ 的函数的最终表达式：\n$$n \\ge \\frac{1}{D^2} \\left(\\frac{1}{m} + \\frac{1}{k}\\right)$$\n这是问题要求的第一个结果。\n\n接下来，我们必须用给定的参数值 $k = 1.2$，$m = 5$ 和 $D = 0.25$ 来计算该表达式。\n我们有：\n$$D = 0.25 = \\frac{1}{4}$$\n$$m = 5$$\n$$k = 1.2 = \\frac{12}{10} = \\frac{6}{5}$$\n\n将这些值代入关于 $n$ 的不等式中：\n$$n \\ge \\frac{1}{(1/4)^2} \\left(\\frac{1}{5} + \\frac{1}{6/5}\\right)$$\n$$n \\ge \\frac{1}{1/16} \\left(\\frac{1}{5} + \\frac{5}{6}\\right)$$\n$$n \\ge 16 \\left(\\frac{6}{30} + \\frac{25}{30}\\right)$$\n$$n \\ge 16 \\left(\\frac{31}{30}\\right)$$\n$$n \\ge \\frac{16 \\times 31}{30} = \\frac{8 \\times 31}{15} = \\frac{248}{15}$$\n\n为求得 $n$ 的最小整数值，我们必须计算该分数的值：\n$$\\frac{248}{15} = 16.5333\\dots$$\n因此，条件是 $n \\ge 16.5333\\dots$。由于 $n$ 必须是表示抽样单元数量的整数，我们必须找到满足此条件的最小整数。这可以通过对数值向上取整来实现：\n$$n_{min} = \\lceil 16.5333\\dots \\rceil = 17$$\n因此，所需的最小抽样单元数量为 $17$。", "answer": "$$\\boxed{17}$$", "id": "2499122"}, {"introduction": "即使有了精心设计的抽样方案，如果我们没有考虑到不完全探测的问题，我们的观测结果也可能产生误导。这个进阶实践处理了观测偏差这一关键问题，即观测到的计数值低于真实种群数量。你将深入研究一个分层模型，以理解探测概率 $p_d$ 如何影响你的估计值，并且最重要的是，你将推导出一个无偏估计量 $\\hat{m}$ 来纠正这种影响，从而确保数据的完整性。[@problem_id:2499113]", "problem": "一个综合虫害管理（IPM）项目通过重复样方抽样来监测果园中的某个害虫物种。设存在 $n$ 个独立的抽样单元（样方），由 $i \\in \\{1,\\dots,n\\}$ 索引。在每个单元 $i$ 中，未被观测到的真实个体数量 $N_i$ 被建模为来自均值为 $m$ 的 Poisson 分布的一个实现，记作 $N_i \\sim \\text{Poisson}(m)$。单元中存在的每个个体被独立探测到的概率为 $p_d \\in (0,1)$，该概率通过在匹配条件下进行的独立校准实验得知。设 $X_i$ 表示单元 $i$ 中的观测计数，该计数是通过使用校准过的方案对每个单元进行一次调查而获得的。\n\n从 Poisson 分布、Bernoulli 分布以及全期望定律和全方差定律的基本定义出发，完成以下任务：\n\n1. 在给定 $m$ 和 $p_d$ 的情况下，推导 $X_i$ 的边际分布。然后，用 $m$ 和 $p_d$ 明确地计算 $\\mathbb{E}[X_i]$ 和 $\\operatorname{Var}(X_i)$。\n\n2. 令 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$ 为忽略了不完美探测的观测计数的样本均值。判断当 $p_d < 1$ 时，$\\bar{X}$ 是否是 $m$ 的无偏估计量，并量化偏差 $\\operatorname{Bias}(\\bar{X}; m) = \\mathbb{E}[\\bar{X}] - m$ 和相对偏差 $\\frac{\\mathbb{E}[\\bar{X}] - m}{m}$，用 $p_d$ 和 $m$ 表示。\n\n3. 推导一个仅为 $\\bar{X}$ 和 $p_d$ 的函数的 $m$ 的无偏估计量 $\\hat{m}$。然后，在上述模型下，以闭合形式推导 $\\operatorname{Var}(\\hat{m})$，并仅用 $m$、$n$ 和 $p_d$ 表示你的答案。仅使用第一性原理，如全期望定律和全方差定律来证明每一步；不要引用未从这些定律推导出的结果。\n\n将第 3 部分的最终结果按 $(\\hat{m}, \\operatorname{Var}(\\hat{m}))$ 的顺序列出两个表达式。如果你选择展示任何中间数值示例，请用“个体/抽样单元”来表示这些量，但最终报告的表达式应为符号形式，不包含单位。", "solution": "该问题是有效的，因为它在生态统计学上具有科学依据，问题阐述清晰，是客观的，并且内部一致。我们按顺序对三个部分进行求解。\n\n分层模型定义如下：\n1. 抽样单元 $i$ 中的真实个体数量 $N_i$ 服从均值为 $m$ 的 Poisson 分布。其概率质量函数（PMF）为 $P(N_i = k) = \\frac{\\exp(-m)m^k}{k!}$，其中 $k \\in \\{0, 1, 2, \\dots\\}$。\n2. 给定有 $N_i = k$ 个个体，观测计数 $X_i$ 是 $k$ 次独立 Bernoulli 试验中的成功次数，每次试验的成功概率为 $p_d$。这是一个二项分布，$X_i | N_i=k \\sim \\text{Binomial}(k, p_d)$。其条件概率质量函数为 $P(X_i = x | N_i = k) = \\binom{k}{x} p_d^x (1-p_d)^{k-x}$，其中 $x \\in \\{0, 1, \\dots, k\\}$。\n\n**第 1 部分：$X_i$ 的边际分布、$\\mathbb{E}[X_i]$ 和 $\\operatorname{Var}(X_i)$**\n\n为了求出 $X_i$ 的边际分布，我们使用全概率定律，对未观测到的真实计数 $N_i$ 的所有可能值进行求和。给定 $N_i=k$ 时 $X_i$ 的支撑集是 $x \\le k$，因此对于给定的 $x$，我们必须有 $k \\ge x$。\n$$P(X_i = x) = \\sum_{k=x}^{\\infty} P(X_i = x | N_i = k) P(N_i = k)$$\n代入二项分布和 Poisson 分布的概率质量函数：\n$$P(X_i = x) = \\sum_{k=x}^{\\infty} \\left[ \\binom{k}{x} p_d^x (1-p_d)^{k-x} \\right] \\left[ \\frac{\\exp(-m)m^k}{k!} \\right]$$\n我们展开二项式系数 $\\binom{k}{x} = \\frac{k!}{x!(k-x)!}$ 并重新排列各项：\n$$P(X_i = x) = \\sum_{k=x}^{\\infty} \\frac{k!}{x!(k-x)!} p_d^x (1-p_d)^{k-x} \\frac{\\exp(-m)m^k}{k!}$$\n$$P(X_i = x) = \\frac{\\exp(-m) p_d^x}{x!} \\sum_{k=x}^{\\infty} \\frac{m^k (1-p_d)^{k-x}}{(k-x)!}$$\n令求和索引变为 $j = k-x$。当 $k$ 从 $x$ 变化到 $\\infty$ 时，$j$ 从 $0$ 变化到 $\\infty$。同时，$k=j+x$。\n$$P(X_i = x) = \\frac{\\exp(-m) p_d^x}{x!} \\sum_{j=0}^{\\infty} \\frac{m^{j+x} (1-p_d)^j}{j!}$$\n我们可以从和式中提出因子 $m^x$：\n$$P(X_i = x) = \\frac{\\exp(-m) (m p_d)^x}{x!} \\sum_{j=0}^{\\infty} \\frac{m^j (1-p_d)^j}{j!}$$\n$$P(X_i = x) = \\frac{\\exp(-m) (m p_d)^x}{x!} \\sum_{j=0}^{\\infty} \\frac{(m(1-p_d))^j}{j!}$$\n该和式是指数函数的泰勒级数展开式，$\\sum_{j=0}^{\\infty} \\frac{a^j}{j!} = \\exp(a)$。此处，$a = m(1-p_d)$。\n$$P(X_i = x) = \\frac{\\exp(-m) (m p_d)^x}{x!} \\exp(m(1-p_d))$$\n合并指数项：$\\exp(-m) \\exp(m - m p_d) = \\exp(-m + m - m p_d) = \\exp(-m p_d)$。\n$$P(X_i = x) = \\frac{\\exp(-m p_d) (m p_d)^x}{x!}$$\n这是均值为 $m p_d$ 的 Poisson 分布的概率质量函数。因此，$X_i$ 的边际分布是 $\\text{Poisson}(m p_d)$。\n对于参数为 $\\lambda$ 的 Poisson 分布，其期望和方差均等于 $\\lambda$。因此，对于 $X_i \\sim \\text{Poisson}(m p_d)$：\n$$\\mathbb{E}[X_i] = m p_d$$\n$$\\operatorname{Var}(X_i) = m p_d$$\n\n按照要求，我们现在使用全期望定律和全方差定律重新推导这些矩。\n给定 $N_i$ 时，$X_i$ 的条件期望是 $\\mathbb{E}[X_i | N_i] = N_i p_d$。\n根据全期望定律：\n$$\\mathbb{E}[X_i] = \\mathbb{E}_{N_i}[\\mathbb{E}[X_i | N_i]] = \\mathbb{E}[N_i p_d] = p_d \\mathbb{E}[N_i]$$\n由于 $N_i \\sim \\text{Poisson}(m)$，我们有 $\\mathbb{E}[N_i] = m$。\n$$\\mathbb{E}[X_i] = m p_d$$\n给定 $N_i$ 时，$X_i$ 的条件方差是 $\\operatorname{Var}(X_i | N_i) = N_i p_d (1-p_d)$。\n根据全方差定律（也称为 Eve 定律）：\n$$\\operatorname{Var}(X_i) = \\mathbb{E}_{N_i}[\\operatorname{Var}(X_i | N_i)] + \\operatorname{Var}_{N_i}(\\mathbb{E}[X_i | N_i])$$\n我们分别计算每一项：\n第一项：$\\mathbb{E}[\\operatorname{Var}(X_i | N_i)] = \\mathbb{E}[N_i p_d (1-p_d)] = p_d(1-p_d)\\mathbb{E}[N_i] = m p_d(1-p_d)$。\n第二项：$\\operatorname{Var}(\\mathbb{E}[X_i | N_i]) = \\operatorname{Var}(N_i p_d) = p_d^2 \\operatorname{Var}(N_i)$。\n由于 $N_i \\sim \\text{Poisson}(m)$，我们有 $\\operatorname{Var}(N_i) = m$。\n所以，$\\operatorname{Var}(\\mathbb{E}[X_i | N_i]) = m p_d^2$。\n将两项相加：\n$$\\operatorname{Var}(X_i) = m p_d(1-p_d) + m p_d^2 = m p_d - m p_d^2 + m p_d^2 = m p_d$$\n结果相同，证实了我们的分析。\n\n**第 2 部分：样本均值 $\\bar{X}$ 的偏差**\n\n观测计数的样本均值为 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$。我们确定它的期望，以评估其作为 $m$ 的估计量的偏差。利用期望的线性性质和第 1 部分的结果：\n$$\\mathbb{E}[\\bar{X}] = \\mathbb{E}\\left[\\frac{1}{n}\\sum_{i=1}^{n} X_i\\right] = \\frac{1}{n}\\sum_{i=1}^{n} \\mathbb{E}[X_i]$$\n由于所有 $X_i$ 都是同分布的，对于所有 $i \\in \\{1,\\dots,n\\}$，都有 $\\mathbb{E}[X_i] = m p_d$。\n$$\\mathbb{E}[\\bar{X}] = \\frac{1}{n} \\sum_{i=1}^{n} (m p_d) = \\frac{1}{n} (n m p_d) = m p_d$$\n如果一个估计量的期望等于被估计的参数，那么该估计量是无偏的。这里，我们在估计 $m$。要使 $\\bar{X}$ 成为 $m$ 的无偏估计量，我们需要 $\\mathbb{E}[\\bar{X}] = m$。然而，我们得到的结果是 $\\mathbb{E}[\\bar{X}] = m p_d$。\n问题指定 $p_d \\in (0,1)$，因此 $p_d < 1$。在这种情况下，$m p_d \\neq m$（假设 $m>0$，这对总体均值是隐含的）。因此，$\\bar{X}$ 是 $m$ 的一个有偏估计量。\n\n偏差定义为 $\\operatorname{Bias}(\\bar{X}; m) = \\mathbb{E}[\\bar{X}] - m$。\n$$\\operatorname{Bias}(\\bar{X}; m) = m p_d - m = m(p_d - 1)$$\n由于 $p_d < 1$，项 $(p_d - 1)$ 是负的，因此偏差也是负的。这表明忽略不完美探测会导致对真实平均丰度的系统性低估。\n\n相对偏差是偏差除以真实参数值：\n$$\\text{Relative Bias} = \\frac{\\mathbb{E}[\\bar{X}] - m}{m} = \\frac{m(p_d - 1)}{m} = p_d - 1$$\n\n**第 3 部分：无偏估计量 $\\hat{m}$ 及其方差**\n\n我们寻求一个仅为 $\\bar{X}$ 和 $p_d$ 的函数且对 $m$ 无偏的估计量 $\\hat{m}$。也就是说，我们需要 $\\mathbb{E}[\\hat{m}] = m$。\n从第 2 部分我们知道 $\\mathbb{E}[\\bar{X}] = m p_d$。为了构造一个无偏估计量，我们可以对因子 $p_d$ 进行校正。我们定义估计量 $\\hat{m}$ 为：\n$$\\hat{m} = \\frac{\\bar{X}}{p_d}$$\n该估计量的期望是：\n$$\\mathbb{E}[\\hat{m}] = \\mathbb{E}\\left[\\frac{\\bar{X}}{p_d}\\right] = \\frac{1}{p_d} \\mathbb{E}[\\bar{X}] = \\frac{1}{p_d} (m p_d) = m$$\n由于 $\\mathbb{E}[\\hat{m}] = m$，$\\hat{m}$ 是 $m$ 的无偏估计量。\n\n接下来，我们推导 $\\hat{m}$ 的方差。对于常数 $a$ 和随机变量 $Y$，使用性质 $\\operatorname{Var}(aY) = a^2 \\operatorname{Var}(Y)$：\n$$\\operatorname{Var}(\\hat{m}) = \\operatorname{Var}\\left(\\frac{\\bar{X}}{p_d}\\right) = \\frac{1}{p_d^2} \\operatorname{Var}(\\bar{X})$$\n为了求出 $\\operatorname{Var}(\\bar{X})$，我们利用 $n$ 个抽样单元是独立的事实，这意味着随机变量 $N_i$ 是独立的。由于每个单元内的探测过程也与其他单元无关，观测计数 $X_i$ 是独立同分布的（IID）。\n$$\\operatorname{Var}(\\bar{X}) = \\operatorname{Var}\\left(\\frac{1}{n} \\sum_{i=1}^{n} X_i\\right) = \\frac{1}{n^2} \\operatorname{Var}\\left(\\sum_{i=1}^{n} X_i\\right)$$\n对于独立的随机变量，和的方差等于方差的和：\n$$\\operatorname{Var}(\\bar{X}) = \\frac{1}{n^2} \\sum_{i=1}^{n} \\operatorname{Var}(X_i)$$\n由于 $X_i$ 是同分布的，对所有 $i$ 都有 $\\operatorname{Var}(X_i) = m p_d$。\n$$\\operatorname{Var}(\\bar{X}) = \\frac{1}{n^2} (n \\cdot m p_d) = \\frac{m p_d}{n}$$\n最后，我们将这个结果代入 $\\operatorname{Var}(\\hat{m})$ 的表达式中：\n$$\\operatorname{Var}(\\hat{m}) = \\frac{1}{p_d^2} \\left( \\frac{m p_d}{n} \\right) = \\frac{m}{n p_d}$$\n无偏估计量 $\\hat{m}$ 的方差的这个最终表达式是按照要求用模型参数 $m$、$n$ 和 $p_d$ 来表示的。\n第 3 部分的结果是估计量 $\\hat{m} = \\frac{\\bar{X}}{p_d}$ 及其方差 $\\operatorname{Var}(\\hat{m}) = \\frac{m}{n p_d}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\bar{X}}{p_d} & \\frac{m}{n p_d}\n\\end{pmatrix}\n}\n$$", "id": "2499113"}]}