{"hands_on_practices": [{"introduction": "种群模型中的随机性从何而来？此练习通过一个基础性的推导来回答此问题。我们将聚焦于人口随机性——源于个体繁殖和存活的偶然性差异——并使用Galton-Watson分支过程对其进行建模。通过从概率母函数的第一性原理出发，您将推导出泊松后代分布下的人口方差，从而深刻理解模型中的关键参数（如 $\\sigma_{d}^{2}$）是如何与个体层面的生命事件直接关联的。[@problem_id:2509935]", "problem": "一个具有非重叠世代的受威胁种群被建模为一个 Galton–Watson 分支过程，以评估在人口随机性条件下的最小可存活种群和准灭绝风险。人口随机性是指在其他方面完全相同的个体之间，纯粹由偶然因素引起的个体出生和死亡结果的随机变异，当种群规模较小时，其影响尤为显著。设第 $t$ 代的种群大小为 $N_{t}$，并假设第 $t$ 代中每个个体产生的后代数量是一个独立同分布的非负整数值随机变量 $X_{i,t}$，具有共同的后代分布。种群根据以下公式更新：\n$$\nN_{t+1} \\,=\\, \\sum_{i=1}^{N_{t}} X_{i,t}.\n$$\n假设后代分布为均值参数 $\\lambda \\gt 0$ 的 $\\text{Poisson}(\\lambda)$ 分布。仅从非负整数值随机变量 $X$ 的概率生成函数 $G(s) \\equiv \\mathbb{E}[s^{X}]$ 的基本定义、均值和方差通过 $G(s)$ 在 $s=1$ 处的导数表示的定义，以及个体后代数量的独立性出发，推导每个亲代的后代数量的人口方差（记为 $\\sigma_{d}^{2}$）的表达式，该方差项通过 $\\mathrm{Var}(N_{t+1}\\,|\\,N_{t}) \\,=\\, N_{t}\\,\\sigma_{d}^{2}$ 对种群增长的条件方差有贡献。将最终答案表示为 $\\lambda$ 的函数。无需单位。以单一闭式解析表达式的形式提供最终答案。", "solution": "所提出的问题是理论种群生态学中一个有效且适定（well-posed）的问题。它要求推导一个由具有泊松后代分布的 Galton-Watson 分支过程建模的种群的人口方差。推导过程必须从涉及概率生成函数的第一性原理出发。\n\n第 $t+1$ 代的种群大小由总和 $N_{t+1} = \\sum_{i=1}^{N_t} X_{i,t}$ 给出，其中 $X_{i,t}$ 代表第 $t$ 代中个体 $i$ 产生的后代数量，而 $N_t$ 是第 $t$ 代的种群大小。随机变量 $X_{i,t}$ 被假定为独立同分布 (i.i.d.)，服从均值参数为 $\\lambda$ 的泊松分布。为简化符号，我们将一般性的后代随机变量表示为 $X$，因此 $X \\sim \\text{Poisson}(\\lambda)$。\n\n待推导的量是人口方差，记为 $\\sigma_{d}^{2}$，它通过种群大小的条件方差定义：\n$$\n\\mathrm{Var}(N_{t+1}\\,|\\,N_{t}) = N_{t}\\,\\sigma_{d}^{2}\n$$\n为了求出 $\\sigma_{d}^{2}$，我们必须首先从其基本定义计算 $\\mathrm{Var}(N_{t+1}\\,|\\,N_{t})$。在种群大小 $N_{t}$ 为固定整数值（比如 $n$）的条件下，下一代的规模是 $n$ 个独立同分布随机变量的总和：$N_{t+1} = \\sum_{i=1}^{n} X_i$。由于随机变量 $X_i$ 是独立的，它们的和的方差是它们方差的和：\n$$\n\\mathrm{Var}\\left(\\sum_{i=1}^{n} X_i\\right) = \\sum_{i=1}^{n} \\mathrm{Var}(X_i)\n$$\n由于后代分布是相同的，对所有 $i$ 都有 $\\mathrm{Var}(X_i) = \\mathrm{Var}(X)$。因此，对于固定的 $N_t = n$，我们有：\n$$\n\\mathrm{Var}\\left(\\sum_{i=1}^{n} X_i\\right) = n \\cdot \\mathrm{Var}(X)\n$$\n这种关系对随机变量 $N_t$ 可能取的任何给定值 $n$ 都成立。因此，我们可以将条件方差表示为随机变量 $N_t$ 本身的函数：\n$$\n\\mathrm{Var}(N_{t+1}\\,|\\,N_{t}) = N_t \\cdot \\mathrm{Var}(X)\n$$\n将此推导出的表达式与问题陈述中提供的表达式 $\\mathrm{Var}(N_{t+1}\\,|\\,N_{t}) = N_{t}\\,\\sigma_{d}^{2}$ 进行比较，我们立即推断出人口方差等于单个后代分布的方差：\n$$\n\\sigma_{d}^{2} = \\mathrm{Var}(X)\n$$\n问题现在简化为使用指定的概率生成函数 (PGF) 方法计算泊松分布随机变量 $X \\sim \\text{Poisson}(\\lambda)$ 的方差。\n\n均值为 $\\lambda$ 的泊松随机变量 $X$ 的概率质量函数 (PMF) 由下式给出：\n$$\n\\mathbb{P}(X=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}, \\quad \\text{for } k \\in \\{0, 1, 2, \\dots\\}\n$$\nPGF, $G(s)$，定义为 $G(s) \\equiv \\mathbb{E}[s^{X}]$。我们为泊松分布计算此函数：\n$$\nG(s) = \\sum_{k=0}^{\\infty} s^k \\mathbb{P}(X=k) = \\sum_{k=0}^{\\infty} s^k \\frac{\\lambda^k \\exp(-\\lambda)}{k!}\n$$\n我们可以将不依赖于求和索引 $k$ 的项 $\\exp(-\\lambda)$ 提取出来：\n$$\nG(s) = \\exp(-\\lambda) \\sum_{k=0}^{\\infty} \\frac{(s\\lambda)^k}{k!}\n$$\n该求和是指数函数的麦克劳林级数，$\\sum_{k=0}^{\\infty} \\frac{z^k}{k!} = \\exp(z)$。令 $z = s\\lambda$，我们得到 PGF 的闭式表达式：\n$$\nG(s) = \\exp(-\\lambda) \\exp(s\\lambda) = \\exp(\\lambda(s-1))\n$$\n问题指定均值和方差需要通过在 $s=1$ 处求值的 PGF 的导数来找到。公式如下：\n$$\n\\mathbb{E}[X] = G'(1)\n$$\n$$\n\\mathrm{Var}(X) = G''(1) + G'(1) - (G'(1))^2\n$$\n我们计算 $G(s)$ 对 $s$ 的一阶和二阶导数：\n一阶导数：\n$$\nG'(s) = \\frac{d}{ds} \\exp(\\lambda(s-1)) = \\lambda \\exp(\\lambda(s-1))\n$$\n二阶导数：\n$$\nG''(s) = \\frac{d}{ds} \\left( \\lambda \\exp(\\lambda(s-1)) \\right) = \\lambda^2 \\exp(\\lambda(s-1))\n$$\n现在，我们在 $s=1$ 处计算这些导数的值：\n$$\nG'(1) = \\lambda \\exp(\\lambda(1-1)) = \\lambda \\exp(0) = \\lambda\n$$\n$$\nG''(1) = \\lambda^2 \\exp(\\lambda(1-1)) = \\lambda^2 \\exp(0) = \\lambda^2\n$$\n$G'(1)=\\lambda$ 的值证实了该分布的均值确实是 $\\lambda$。我们将这些结果代入方差公式：\n$$\n\\mathrm{Var}(X) = G''(1) + G'(1) - (G'(1))^2 = \\lambda^2 + \\lambda - (\\lambda)^2 = \\lambda\n$$\n因此，泊松后代分布的方差是 $\\lambda$。由于我们已经确定 $\\sigma_{d}^{2} = \\mathrm{Var}(X)$，我们得出结论，人口方差是：\n$$\n\\sigma_{d}^{2} = \\lambda\n$$\n这个结果是繁殖被建模为泊松过程的分支过程的一个基本但重要的性质。它表明每个亲代的后代数量的方差等于每个亲代的平均后代数量。", "answer": "$$\\boxed{\\lambda}$$", "id": "2509935"}, {"introduction": "在掌握了理论之后，如何将其应用于解决实际的保护问题？这个练习将理论与计算实践相结合，要求您处理一个连续时间的生灭过程。您需要首先推导出单个谱系在有限时间内的灭绝概率，然后利用此结果编写一个程序，以数值方式计算出满足特定风险容忍度的最小可行种群（MVP）。这项实践强调了种群生存力分析（PVA）中从抽象数学模型到具体管理决策的转化过程。[@problem_id:2509956]", "problem": "考虑一个描述封闭种群丰度的连续时间线性生灭分支过程。每个个体独立地以人均速率 $b$ (每年) 进行繁殖，并独立地以人均速率 $d$ (每年) 死亡。状态 $N(t)$ 是指时间 $t$ (以年为单位) 的个体数量，其中 $N(0)=N_0 \\in \\mathbb{N}$，且状态 $0$ 是吸收态。一位保护管理者定义了一个风险容忍度准则：选择最小的初始丰度 $N_0$ (在此准则下称为最小生存种群)，使得在时间 $\\tau$ 前灭绝的概率不超过容忍水平 $\\alpha$，即，满足下式的最小 $N_0 \\in \\mathbb{N}$：\n$$\n\\mathbb{P}\\big(N(\\tau)=0 \\,\\big|\\, N(0)=N_0\\big) \\le \\alpha.\n$$\n请仅使用连续时间马尔可夫分支过程的基本性质，即：谱系独立性、状态 $0$ 的吸收性、以及基于无穷小时间增量的全概率定律，推导出一个有原理支持的数值方法，用以对给定的参数 $(b,d,\\tau,\\alpha)$ （其中 $b \\ge 0$，$d \\ge 0$，$\\tau \\ge 0$ (单位为年)，且 $\\alpha \\in (0,1)$）计算满足该不等式的最小 $N_0$。你的方法必须在 $bd$ (超临界)、$b=d$ (临界) 和 $bd$ (亚临界) 的情形下都具有稳健性，并且必须能透明地处理边界情况 $\\tau=0$。\n\n实现要求：\n- 你的程序必须硬编码一个包含参数四元组 $(b,d,\\tau,\\alpha)$ 的测试套件，并对每个四元组计算满足 $\\mathbb{P}(N(\\tau)=0 \\mid N(0)=N_0) \\le \\alpha$ 的最小整数 $N_0$。\n- 时间单位必须是年，速率单位是每年；输出 $N_0$ 是一个整数计数，必须以无单位整数的形式报告。\n- 用于覆盖不同情形和边界情况的测试套件如下：\n  - 情况 1 (超临界，中等时间范围): $(b,d,\\tau,\\alpha) = (0.5, 0.4, 10.0, 0.05)$。\n  - 情况 2 (临界，长时间范围): $(b,d,\\tau,\\alpha) = (0.2, 0.2, 20.0, 0.1)$。\n  - 情况 3 (亚临界，中等时间范围): $(b,d,\\tau,\\alpha) = (0.3, 0.6, 5.0, 0.2)$。\n  - 情况 4 (时间边界): $(b,d,\\tau,\\alpha) = (0.5, 0.4, 0.0, 0.01)$。\n  - 情况 5 (超临界，极严苛风险): $(b,d,\\tau,\\alpha) = (0.55, 0.5, 50.0, 0.000001)$。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[n_1,n_2,n_3,n_4,n_5]$，其中每个 $n_i$ 是按上述顺序为相应情况计算出的最小整数 $N_0$。\n\n方法约束：\n- 你必须依赖分支过程的第一性原理，来获得一个从单个祖先开始、在时间 $\\tau$ 前灭绝的可计算概率，然后利用谱系独立性将其推广到 $N_0$ 个祖先的情况，最后计算满足该不等式的最小整数 $N_0$。\n- 不要在问题陈述中假设或引用灭绝概率的最终公式；相反，你的方法应基于事件的短时分解和谱系的独立性来构建计算过程。\n- 最终输出必须是确定性的，并且仅包含指定列表格式的整数结果。", "solution": "所提出的问题是数学生态学中一个适定且有科学依据的问题。它要求在一个概率性风险准则下，确定最小生存种群规模 $N_0$。该模型是一个连续时间线性生灭过程，这是随机过程理论中的一个基本构造。该问题是有效的，因为它是自洽的、事实可靠，并且允许从第一性原理推导出唯一且有意义的解。\n\n解法将分三个阶段展开。首先，我们将推导从单个个体开始的谱系在时间 $\\tau$ 前灭绝的概率，记为 $p(\\tau)$。该推导将基于对无穷小时间间隔内事件的分析，从而得到一个关于 $p(\\tau)$ 的微分方程。其次，利用独立谱系原理，我们将此结果推广到起始种群为 $N_0$ 个个体的情况。第三，我们将求解所得不等式，以获得满足保护管理者风险容忍度的最小整数 $N_0$。\n\n**1. 单个祖先灭绝概率 $p(\\tau)$ 的推导**\n\n令 $p(t) = \\mathbb{P}(N(t)=0 \\mid N(0)=1)$ 为从单个个体开始的种群在时间 $t$ 前灭绝的概率。我们使用全概率定律，通过以无穷小时间间隔 $[0, dt)$ 内发生的第一个事件为条件，来推导 $p(t)$ 的微分方程。当 $dt \\to 0$ 时，从 $t=0$ 时的一个个体开始的过程，可以通过以下三种互斥的方式之一演化：\n\n1.  发生一次死亡，概率为 $d \\cdot dt + o(dt)$。种群数量变为 $0$。由于 $0$ 是一个吸收态，灭绝是必然的。该谱系在时间 $t$ 前灭绝的概率为 $1$。\n2.  发生一次出生，概率为 $b \\cdot dt + o(dt)$。种群数量变为 $2$。根据马尔可夫性质和后代的独立性，原始谱系在时间 $t$ 前灭绝的充要条件是，两个新的独立谱系都在剩余的时间 $t-dt$ 内灭绝。此事件的概率为 $[p(t-dt)]^2$。\n3.  既不发生出生也不发生死亡，概率为 $1 - (b+d)dt + o(dt)$。种群数量保持为 $1$。如果从此刻开始的该过程在剩余的时间 $t-dt$ 内灭绝，则该谱系在时间 $t$ 前灭绝。其概率为 $p(t-dt)$。\n\n将这些贡献相加，我们得到：\n$$\np(t) = d \\cdot dt \\cdot 1 + b \\cdot dt \\cdot [p(t-dt)]^2 + [1 - (b+d)dt] \\cdot p(t-dt) + o(dt)\n$$\n我们使用泰勒展开 $p(t-dt) = p(t) - \\frac{dp}{dt}dt + O(dt^2)$。将此式代入方程：\n$$\np(t) = d \\cdot dt + b \\cdot dt \\cdot [p(t)]^2 + \\left( p(t) - \\frac{dp}{dt}dt \\right) - (b+d)dt \\cdot p(t) + O(dt^2)\n$$\n化简并合并 $dt$ 的同阶项：\n$$\n0 = d \\cdot dt + b \\cdot [p(t)]^2 \\cdot dt - \\frac{dp}{dt}dt - (b+d)p(t) \\cdot dt + O(dt^2)\n$$\n两边同除以 $dt$ 并取 $dt \\to 0$ 的极限，我们得到关于 $p(t)$ 的后向 Kolmogorov 微分方程：\n$$\n\\frac{dp}{dt} = b p(t)^2 - (b+d)p(t) + d\n$$\n方程右边是关于 $p(t)$ 的二次式，可以因式分解：\n$$\n\\frac{dp}{dt} = (bp(t) - d)(p(t) - 1)\n$$\n初始条件是，在时间 $t=0$ 时，种群数量为 $N(0)=1$，因此不可能已灭绝。于是，$p(0) = 0$。我们用分离变量法求解此微分方程，从 $t=0$ 积分到 $t=\\tau$。\n\n**情况 I：$b \\neq d$ (超临界或亚临界)**\n\n$$\n\\int_{p(0)}^{p(\\tau)} \\frac{dp}{(bp-d)(p-1)} = \\int_0^\\tau dt\n$$\n使用部分分式分解，$\\frac{1}{(bp-d)(p-1)} = \\frac{1}{b-d}\\left(\\frac{1}{p-1} - \\frac{b}{bp-d}\\right)$。\n$$\n\\frac{1}{b-d} \\left[ \\ln|p-1| - \\ln|bp-d| \\right]_{0}^{p(\\tau)} = \\tau\n$$\n$$\n\\frac{1}{b-d} \\left[ \\ln\\left|\\frac{p-1}{bp-d}\\right| \\right]_{0}^{p(\\tau)} = \\tau\n$$\n代入积分上下限 $p(0)=0$ 和 $p(\\tau)$：\n$$\n\\ln\\left|\\frac{p(\\tau)-1}{bp(\\tau)-d}\\right| - \\ln\\left|\\frac{-1}{-d}\\right| = (b-d)\\tau\n$$\n由于 $p(\\tau) \\in [0,1)$，我们有 $p(\\tau)-1  0$。同时，在典型的参数范围内，$bp(\\tau)-d$ 为负，因此对数内的比值为正。我们可以写为 $\\ln\\left(\\frac{1-p(\\tau)}{d-bp(\\tau)}\\right) - \\ln\\left(\\frac{1}{d}\\right) = (b-d)\\tau$。\n$$\n\\ln\\left(\\frac{d(1-p(\\tau))}{d-bp(\\tau)}\\right) = (b-d)\\tau\n$$\n取指数并求解 $p(\\tau)$，得到：\n$$\np(\\tau) = \\frac{d(e^{(b-d)\\tau} - 1)}{b e^{(b-d)\\tau} - d}\n$$\n\n**情况 II：$b = d$ (临界)**\n\n微分方程简化为 $\\frac{dp}{dt} = b(p-1)^2$。\n$$\n\\int_{p(0)}^{p(\\tau)} \\frac{dp}{(p-1)^2} = \\int_0^\\tau b dt\n$$\n$$\n\\left[ -\\frac{1}{p-1} \\right]_{0}^{p(\\tau)} = b\\tau\n$$\n$$\n-\\frac{1}{p(\\tau)-1} - \\left(-\\frac{1}{0-1}\\right) = b\\tau \\implies \\frac{1}{1-p(\\tau)} - 1 = b\\tau\n$$\n求解 $p(\\tau)$，得到：\n$$\np(\\tau) = \\frac{b\\tau}{1+b\\tau}\n$$\n\n**2. 推广到 $N_0$ 个个体**\n\n分支过程的一个基本原理是谱系的独立性。一个从 $N_0$ 个体开始的种群在时间 $\\tau$ 前灭绝的充要条件是，由原始个体分别产生的全部 $N_0$ 个独立谱系都在时间 $\\tau$ 前灭绝。因此，整个种群的灭绝概率为：\n$$\n\\mathbb{P}(N(\\tau)=0 \\mid N(0)=N_0) = \\left[p(\\tau)\\right]^{N_0}\n$$\n管理者的准则是找到满足...的最小整数 $N_0$：\n$$\n[p(\\tau)]^{N_0} \\le \\alpha\n$$\n\n**3. 最小生存种群 $N_0$ 的计算**\n\n为找到最小整数 $N_0$，我们分析该不等式。\n如果 $\\tau=0$，则 $p(0)=0$。不等式变为 $0^{N_0} \\le \\alpha$，因为 $\\alpha \\in(0,1)$，所以这对任何 $N_0 \\ge 1$ 都成立。满足条件的最小整数是 $N_0=1$。\n\n如果 $\\tau0$，则 $p(\\tau) \\in (0,1)$。我们可以对不等式两边取自然对数。由于 $\\ln(p(\\tau))$ 是负数，两边同除以它会使不等号反转：\n$$\nN_0 \\ln(p(\\tau)) \\le \\ln(\\alpha) \\implies N_0 \\ge \\frac{\\ln(\\alpha)}{\\ln(p(\\tau))}\n$$\n满足此条件的最小整数 $N_0$ 可通过向上取整函数（ceiling function）找到：\n$$\nN_0 = \\left\\lceil \\frac{\\ln(\\alpha)}{\\ln(p(\\tau))} \\right\\rceil\n$$\n对于数值实现，特别是在 $b$ 接近 $d$ 时，$b \\neq d$ 情况下的 $p(\\tau)$ 公式可能容易出现浮点误差。使用包含 `expm1(x) = e^x - 1` 的数学上等价且数值上更稳定的形式会更好：令 $x=(b-d)\\tau$，则\n$$\np(\\tau) = \\frac{d \\cdot \\text{expm1}(x)}{b \\cdot \\text{expm1}(x) + (b - d)}\n$$\n这避免了在计算小 $x$ 的 $e^x-1$ 时可能发生的灾难性抵消。\n\n最终的算法如下：\n1.  对于每组参数 $(b,d,\\tau,\\alpha)$，首先检查是否 $\\tau=0$。如果是，则 $N_0=1$。\n2.  否则，根据临界 ($b=d$) 或非临界 ($b \\neq d$) 情况，使用相应的公式计算 $p(\\tau)$，并采用数值稳健的表达式。\n3.  使用向上取整公式 $N_0 = \\lceil \\ln(\\alpha) / \\ln(p(\\tau)) \\rceil$ 计算所需的最小 $N_0$。结果必须是一个整数。\n这个有原理支持的程序为计算给定测试套件所需的最小生存种群规模，提供了一个确定性且科学可靠的方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_n0(b: float, d: float, tau: float, alpha: float) - int:\n    \"\"\"\n    Computes the minimum viable population N0 based on a continuous-time\n    birth-death process model.\n\n    Args:\n        b: Per capita birth rate (per year).\n        d: Per capita death rate (per year).\n        tau: Time horizon (years).\n        alpha: Maximum acceptable extinction probability.\n\n    Returns:\n        The smallest integer N0 satisfying the risk criterion.\n    \"\"\"\n    # Per the derivation, if the time horizon is zero, the population cannot be extinct\n    # unless it started at zero. For N(0) = N_0 = 1, the probability of extinction\n    # at t=0 is exactly 0. The inequality 0 = alpha holds for any N_0 = 1.\n    # The smallest such integer is 1.\n    if tau == 0.0:\n        return 1\n\n    # Calculate p(tau), the extinction probability for a single lineage by time tau.\n    # The derivation from first principles yields two cases.\n    if b == d:\n        # Critical case: p(tau) = b*tau / (1 + b*tau)\n        # If b=d=0, the population size is constant, so p(tau)=0.\n        if b == 0.0:\n            p_tau = 0.0\n        else:\n            p_tau = (b * tau) / (1.0 + b * tau)\n    else:\n        # Non-critical case (supercritical bd or subcritical bd).\n        # We use a numerically stable formula derived in the solution text.\n        # p(tau) = d*(e^((b-d)tau) - 1) / (b*e^((b-d)tau) - d)\n        # Let x = (b-d)*tau. The formula becomes d*(exp(x)-1) / (b*exp(x)-d).\n        # To avoid catastrophic cancellation when x is close to 0, we use expm1(x).\n        # Numerator: d * expm1(x)\n        # Denominator: b*exp(x) - d = b*(exp(x)-1) + b - d = b*expm1(x) + (b-d)\n        x = (b - d) * tau\n        numerator = d * np.expm1(x)\n        denominator = b * np.expm1(x) + (b - d)\n        \n        # If d=0 (pure birth), p_tau=0. The numerator is 0.\n        # If the denominator is zero, this would imply a singularity, but the\n        # function is well-behaved. This case is not expected for valid parameters.\n        if denominator == 0:\n            # For b=0,d0 (pure death), p_tau = 1-exp(-d*tau).\n            # The general formula's denominator is -d, so it works.\n            # This logic path is for extreme edge cases not in the test suite.\n            p_tau = 0.0 if d == 0.0 else 1.0\n        else:\n            p_tau = numerator / denominator\n\n    # The probability of extinction for N0 lineages is (p_tau)^N0.\n    # We need to find the smallest integer N0 such that (p_tau)^N0 = alpha.\n\n    # If extinction from one ancestor is impossible (p_tau=0), one individual is enough.\n    # This happens if d=0 and b0.\n    if p_tau == 0.0:\n        return 1\n\n    # For p_tau  0, we solve by taking logarithms.\n    # N0 * log(p_tau) = log(alpha)\n    # Since 0  p_tau  1 (for finite tau), log(p_tau) is negative.\n    # Dividing by log(p_tau) reverses the inequality:\n    # N0 = log(alpha) / log(p_tau)\n    # The smallest integer N0 is the ceiling of this expression.\n    n0_float = np.log(alpha) / np.log(p_tau)\n    n0 = int(np.ceil(n0_float))\n    \n    return n0\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # The test suite of parameter quadruples (b, d, tau, alpha).\n    test_cases = [\n        # Case 1 (supercritical, moderate horizon)\n        (0.5, 0.4, 10.0, 0.05),\n        # Case 2 (critical, long horizon)\n        (0.2, 0.2, 20.0, 0.1),\n        # Case 3 (subcritical, moderate horizon)\n        (0.3, 0.6, 5.0, 0.2),\n        # Case 4 (boundary in time)\n        (0.5, 0.4, 0.0, 0.01),\n        # Case 5 (supercritical, very stringent risk)\n        (0.55, 0.5, 50.0, 0.000001),\n    ]\n\n    results = []\n    for case in test_cases:\n        b, d, tau, alpha = case\n        result = compute_n0(b, d, tau, alpha)\n        results.append(result)\n\n    # The final print statement must match the required format exactly.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2509956"}, {"introduction": "除了个体层面的随机性，影响整个种群的环境波动是另一个关键因素。本练习将介绍用于模拟环境随机性的标准工具：随机微分方程（SDEs）。您将使用伊藤引理和布朗运动的首渡时间理论，来推导几何布朗运动模型下的准灭绝概率。掌握这项练习意味着您将能够处理现代种群生存力分析中最广泛使用的模型之一，并理解其数学核心。[@problem_id:2509921]", "problem": "一个在适度规模下人口随机性可忽略的封闭种群，受到扰动其指数增长率的环境随机性的影响。设 $ N_t $ 表示时间 $ t $ 的种群大小，并假设在生态时间尺度上，它可以用Itô随机微分方程（SDE）很好地描述\n$ dN_t = r\\,N_t\\,dt + \\sigma\\,N_t\\,dW_t $，\n其中 $ r \\in \\mathbb{R} $ 是人均平均增长率，$ \\sigma  0 $ 是环境噪声的强度，而 $ W_t $ 是一个标准布朗运动。设 $ N_q \\in (0,\\infty) $ 表示在最小可存活种群（MVP）分析中使用的准灭绝阈值，并假设初始大小满足 $ N_0  N_q $。定义对数状态变量 $ X_t = \\ln N_t $ 和相应的吸收下边界 $ a = \\ln N_q $。设到达准灭绝的首达时间为 $ T = \\inf\\{ t \\ge 0 : X_t \\le a \\} $。 \n\n从 $ N_t $ 的SDE出发，仅使用随机微积分的基础工具（例如，针对 $ \\ln N_t $ 的Itô引理）和布朗运动的经典性质（例如，带漂移布朗运动穿越边界的反射原理），推导该模型在对数空间中的扩散近似，并获得在固定时间 $ \\tau  0 $ 内准灭绝概率 $ \\mathbb{P}( T \\le \\tau ) $ 的闭式表达式。将您的最终答案表示为关于 $ x_0 = \\ln N_0 $、$ a = \\ln N_q $、$ \\mu = r - \\sigma^2/2 $、$ \\sigma $、$ \\tau $ 和标准正态累积分布函数 $ \\Phi $ 的单个解析表达式。 \n\n您的最终答案必须是一个单一的闭式表达式。不要提供不等式或待解方程。不要包含单位。不要四舍五入或近似；请给出关于 $ \\Phi $ 的精确符号表达式。", "solution": "所述问题具有科学依据，提法恰当且客观。这是数学生态学和金融学中的一个经典问题，基于已建立的随机微分方程理论。所有必要信息均已提供，问题没有矛盾或含糊之处。因此，该问题是有效的，我们可以着手求解。\n\n种群动态由几何布朗运动的随机微分方程（SDE）描述：\n$$ dN_t = r\\,N_t\\,dt + \\sigma\\,N_t\\,dW_t $$\n其中 $N_t$ 是时间 $t$ 时的种群大小，$r$ 是人均平均增长率，$\\sigma$ 是环境噪声强度，$W_t$ 是标准布朗运动。\n\n我们关心的是种群大小对数 $X_t = \\ln N_t$ 的动态。为了找到 $X_t$ 的SDE，我们对函数 $f(N_t) = \\ln N_t$ 应用Itô引理。所需的导数为：\n$$ \\frac{\\partial f}{\\partial N_t} = \\frac{1}{N_t}, \\quad \\frac{\\partial^2 f}{\\partial N_t^2} = -\\frac{1}{N_t^2} $$\n根据Itô引理，微分 $dX_t$ 由下式给出：\n$$ dX_t = \\left( r\\,N_t \\cdot \\frac{\\partial f}{\\partial N_t} + \\frac{1}{2}(\\sigma\\,N_t)^2 \\cdot \\frac{\\partial^2 f}{\\partial N_t^2} \\right) dt + \\left( \\sigma\\,N_t \\cdot \\frac{\\partial f}{\\partial N_t} \\right) dW_t $$\n代入导数，我们得到：\n$$ dX_t = \\left( r\\,N_t \\cdot \\frac{1}{N_t} + \\frac{1}{2}\\sigma^2 N_t^2 \\cdot \\left(-\\frac{1}{N_t^2}\\right) \\right) dt + \\left( \\sigma\\,N_t \\cdot \\frac{1}{N_t} \\right) dW_t $$\n$$ dX_t = \\left(r - \\frac{\\sigma^2}{2}\\right) dt + \\sigma\\,dW_t $$\n问题定义了 $\\mu = r - \\sigma^2/2$，这是长期随机增长率。根据这个定义，对数种群大小的SDE变为：\n$$ dX_t = \\mu\\,dt + \\sigma\\,dW_t $$\n这个方程描述了一个算术（或带漂移的）布朗运动。在初始条件 $X_0 = x_0$ 下，此SDE的解为：\n$$ X_t = x_0 + \\mu t + \\sigma W_t $$\n问题是要找到准灭绝概率，即种群在时间 $\\tau$ 之前下降到或低于阈值 $N_q$ 的概率。用对数种群大小表示，这就是 $X_t$ 在时间 $\\tau$ 之前达到或穿过吸收壁 $a = \\ln N_q$ 的概率。这是一个首达时间问题。我们寻求计算 $\\mathbb{P}(T \\le \\tau)$，其中 $T = \\inf\\{ t \\ge 0 : X_t \\le a \\}$。初始状态为 $x_0  a$。\n\n事件 $\\{T \\le \\tau\\}$ 等价于事件 $\\{\\min_{0 \\le t \\le \\tau} X_t \\le a\\}$。为了解决这个问题，我们可以将问题转换为典范形式。考虑过程 $Y_t = -(X_t - x_0) = -\\mu t - \\sigma W_t$。该过程从 $Y_0 = 0$ 开始。条件 $X_t \\le a$ 等价于 $x_0 - Y_t \\le a$，简化为 $Y_t \\ge x_0 - a$。\n因此，过程 $X_t$ 撞击下边界 $a$ 的事件等价于过程 $Y_t$ 撞击上边界的事件：\n$$ \\min_{0 \\le t \\le \\tau} X_t \\le a \\iff \\max_{0 \\le t \\le \\tau} Y_t \\ge x_0 - a $$\n设 $b = x_0 - a$。由于 $x_0  a$，我们有 $b  0$。过程 $Y_t$ 可以写成 $Y_t = (-\\mu)t + \\sigma(-W_t)$。由于 $-W_t$ 也是一个标准布朗运动，所以 $Y_t$ 是一个漂移为 $-\\mu$、波动率参数为 $\\sigma$ 的带漂移布朗运动。问题简化为求 $\\mathbb{P}(\\max_{0 \\le t \\le \\tau} Y_t \\ge b)$。\n\n这是带漂移布朗运动的一个经典结果，可以从反射原理推导得出。对于从 $Z_0=0$ 开始的过程 $Z_t = \\nu t + \\sigma W_t$，在时间 $\\tau$ 之前撞击上边界 $k0$ 的概率由下式给出：\n$$ \\mathbb{P}(\\max_{0 \\le t \\le \\tau} Z_t \\ge k) = \\mathbb{P}\\left(\\max_{0 \\le t \\le \\tau} \\left(\\frac{\\nu}{\\sigma}t + W_t\\right) \\ge \\frac{k}{\\sigma}\\right) $$\n对于一个过程 $S_t = \\nu' t + W_t$（单位波动率）撞击边界 $k'$ 的公式是：\n$$ \\mathbb{P}(\\max_{0 \\le t \\le \\tau} S_t \\ge k') = \\Phi\\left(\\frac{\\nu'\\tau - k'}{\\sqrt{\\tau}}\\right) + \\exp(2\\nu'k') \\Phi\\left(\\frac{-\\nu'\\tau - k'}{\\sqrt{\\tau}}\\right) $$\n在我们的例子中，过程是 $Y_t$，所以对应的漂移是 $\\nu = -\\mu$。需要用标准形式分析的过程是 $S_t = Y_t/\\sigma$。它的漂移是 $\\nu' = -\\mu/\\sigma$，边界是 $k' = b/\\sigma = (x_0-a)/\\sigma$。\n\n将 $\\nu' = -\\mu/\\sigma$ 和 $k' = (x_0-a)/\\sigma$ 代入标准公式：\n$$ \\mathbb{P}(T \\le \\tau) = \\Phi\\left(\\frac{(-\\mu/\\sigma)\\tau - (x_0-a)/\\sigma}{\\sqrt{\\tau}}\\right) + \\exp\\left(2\\left(-\\frac{\\mu}{\\sigma}\\right)\\left(\\frac{x_0-a}{\\sigma}\\right)\\right) \\Phi\\left(\\frac{-((-\\mu/\\sigma)\\tau) - (x_0-a)/\\sigma}{\\sqrt{\\tau}}\\right) $$\n我们简化每一项。第一个 $\\Phi$ 函数的参数是：\n$$ \\frac{-\\mu\\tau - (x_0-a)}{\\sigma\\sqrt{\\tau}} = \\frac{a - x_0 - \\mu\\tau}{\\sigma\\sqrt{\\tau}} $$\n指数项是：\n$$ \\frac{-2\\mu(x_0-a)}{\\sigma^2} = \\frac{2\\mu(a-x_0)}{\\sigma^2} $$\n第二个 $\\Phi$ 函数的参数是：\n$$ \\frac{\\mu\\tau - (x_0-a)}{\\sigma\\sqrt{\\tau}} = \\frac{a-x_0+\\mu\\tau}{\\sigma\\sqrt{\\tau}} $$\n结合这些简化项，得到准灭绝概率的最终表达式：\n$$ \\mathbb{P}(T \\le \\tau) = \\Phi\\left(\\frac{a - x_0 - \\mu\\tau}{\\sigma\\sqrt{\\tau}}\\right) + \\exp\\left(\\frac{2\\mu(a - x_0)}{\\sigma^2}\\right) \\Phi\\left(\\frac{a - x_0 + \\mu\\tau}{\\sigma\\sqrt{\\tau}}\\right) $$\n此表达式给出了到达准灭绝边界的首达时间的累积分布函数。", "answer": "$$ \\boxed{\\Phi\\left(\\frac{a - x_0 - \\mu\\tau}{\\sigma\\sqrt{\\tau}}\\right) + \\exp\\left(\\frac{2\\mu(a - x_0)}{\\sigma^2}\\right) \\Phi\\left(\\frac{a - x_0 + \\mu\\tau}{\\sigma\\sqrt{\\tau}}\\right)} $$", "id": "2509921"}]}