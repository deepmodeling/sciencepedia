{"hands_on_practices": [{"introduction": "这项实践为建立机理性的生物累积模型奠定了基础。通过从基本原理出发推导稳态毒代动力学模型，您将对摄取和损失途径如何共同决定生物体内的污染物负荷有一个根本性的理解。此外，进行敏感性分析将揭示哪些生理和暴露参数对模型预测的影响最为关键，这是指导研究和风险评估的一项重要技能。[@problem_id:2472203]", "problem": "一个处于稳态的单室鱼类模型通过两种途径接收疏水性有机污染物：通过鳃上皮直接从水中摄取和通过猎物进行食物摄取；并通过排泄、生物转化和生长稀释失去污染物。从质量守恒原理出发，生物体污染物浓度的净变化率是总摄取与总一级损失之差。在稳态下，时间导数等于零，因此稳态下单位体重的身体负荷（每单位湿重生物体的污染物质量）是总摄取与总损失之比。令 $B^{*}$ 表示单位质量的稳态身体负荷。令 $k_1$ 为水摄取清除率，$C_w$ 为溶解水浓度，$AE$ 为食物同化效率，$I$ 为单位质量的食物摄食率，$C_d$ 为食物中的污染物浓度，$k_2$ 为排泄净化速率常数，$k_m$ 为生物转化速率常数，$g$ 为躯体生长速率常数。假设一级动力学以及水和食物摄取通量以及损失过程的可加性。\n\n1. 仅使用质量守恒和上述线性可加性假设，用 $k_1$、$C_w$、$AE$、$I$、$C_d$、$k_2$、$k_m$ 和 $g$ 写出 $B^{*}$ 的表达式。\n\n2. 将 $B^{*}$ 对参数 $p$ 的归一化局部灵敏度定义为 $s_p \\equiv \\frac{\\partial \\ln B^{*}}{\\partial \\ln p}$。对每个参数 $p \\in \\{k_1, C_w, AE, I, C_d, k_2, k_m, g\\}$，推导 $s_p$ 的符号表达式。\n\n3. 假设有以下科学上合理的参数值和独立的微小不确定性（以变异系数表示，其中变异系数 (CV) 是标准差除以平均值）：\n- $k_1 = 0.8\\ \\mathrm{L\\ kg^{-1}\\ d^{-1}}$，$\\mathrm{CV}(k_1) = 0.5$，\n- $C_w = 5\\ \\mathrm{ng\\ L^{-1}}$，$\\mathrm{CV}(C_w) = 0.3$，\n- $AE = 0.7$，$\\mathrm{CV}(AE) = 0.2$，\n- $I = 0.03\\ \\mathrm{d^{-1}}$，$\\mathrm{CV}(I) = 0.4$，\n- $C_d = 500\\ \\mathrm{ng\\ kg^{-1}}$，$\\mathrm{CV}(C_d) = 0.6$，\n- $k_2 = 0.02\\ \\mathrm{d^{-1}}$，$\\mathrm{CV}(k_2) = 0.25$，\n- $k_m = 0.01\\ \\mathrm{d^{-1}}$，$\\mathrm{CV}(k_m) = 0.5$，\n- $g = 0.005\\ \\mathrm{d^{-1}}$，$\\mathrm{CV}(g) = 0.3$。\n\n在针对小的、独立的不确定性的delta方法近似下，$\\ln B^{*}$ 的方差近似为 $\\sum_{p} (s_p\\, \\mathrm{CV}(p))^2$。计算此近似方差中可归因于损失过程的部分，定义为\n$$\nF_{\\mathrm{loss}} \\equiv \\frac{\\sum_{p \\in \\{k_2, k_m, g\\}} \\left(s_p\\, \\mathrm{CV}(p)\\right)^2}{\\sum_{p \\in \\{k_1, C_w, AE, I, C_d, k_2, k_m, g\\}} \\left(s_p\\, \\mathrm{CV}(p)\\right)^2}.\n$$\n\n将 $F_{\\mathrm{loss}}$ 的最终答案表示为四位有效数字的小数（无量纲）。", "solution": "在尝试解答之前，将对问题进行验证。\n\n**问题验证**\n\n**第1步：提取已知条件**\n- 模型：处于稳态的单室鱼类模型。\n- 原理：质量守恒，一级动力学，通量的可加性。\n- 污染物浓度的净变化率：(总摄取) - (总一级损失)。\n- 稳态条件：浓度的时间导数为 $0$。\n- 变量：\n    - $B^{*}$：单位质量的稳态身体负荷。\n    - $k_1$：水摄取清除率 ($0.8\\ \\mathrm{L\\ kg^{-1}\\ d^{-1}}$)。\n    - $C_w$：溶解水浓度 ($5\\ \\mathrm{ng\\ L^{-1}}$)。\n    - $AE$：食物同化效率 ($0.7$)。\n    - $I$：单位质量摄食率 ($0.03\\ \\mathrm{d^{-1}}$)。\n    - $C_d$：食物中的污染物浓度 ($500\\ \\mathrm{ng\\ kg^{-1}}$)。\n    - $k_2$：排泄净化速率常数 ($0.02\\ \\mathrm{d^{-1}}$)。\n    - $k_m$：生物转化速率常数 ($0.01\\ \\mathrm{d^{-1}}$)。\n    - $g$：躯体生长速率常数 ($0.005\\ \\mathrm{d^{-1}}$)。\n- 不确定性（变异系数，CV）：\n    - $\\mathrm{CV}(k_1) = 0.5$\n    - $\\mathrm{CV}(C_w) = 0.3$\n    - $\\mathrm{CV}(AE) = 0.2$\n    - $\\mathrm{CV}(I) = 0.4$\n    - $\\mathrm{CV}(C_d) = 0.6$\n    - $\\mathrm{CV}(k_2) = 0.25$\n    - $\\mathrm{CV}(k_m) = 0.5$\n    - $\\mathrm{CV}(g) = 0.3$\n- 定义与公式：\n    - 归一化局部灵敏度：$s_p \\equiv \\frac{\\partial \\ln B^{*}}{\\partial \\ln p}$。\n    - 方差近似：$\\mathrm{Var}(\\ln B^{*}) \\approx \\sum_{p} (s_p\\, \\mathrm{CV}(p))^2$。\n    - 来自损失的方差分数：$F_{\\mathrm{loss}} \\equiv \\frac{\\sum_{p \\in \\{k_2, k_m, g\\}} \\left(s_p\\, \\mathrm{CV}(p)\\right)^2}{\\sum_{p \\in \\{k_1, C_w, AE, I, C_d, k_2, k_m, g\\}} \\left(s_p\\, \\mathrm{CV}(p)\\right)^2}$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，植根于生态毒理学中使用的标准毒物动力学模型原理。所描述的模型是一个经典的一室生物累积模型。问题是适定的，提供了足够的信息来唯一地解决其三个部分。语言是客观的，并使用标准术语。问题中说明的参数值，对于鱼类-污染物系统而言，是科学上合理的。量纲一致性成立，因为浓度的变化率（[质量/质量]/时间）被通量（[质量/质量]/时间）所平衡。该问题并非无足轻重，需要应用微积分和不确定性传播方法。\n\n**第3步：结论与行动**\n问题有效。将提供完整解答。\n\n**第1部分：推导 $B^{*}$**\n\n令 $C_{org}(t)$ 为鱼体内污染物浓度（每单位鱼体质量的污染物质量）。该浓度的质量守恒原理由以下微分方程给出：\n$$\n\\frac{dC_{org}}{dt} = (\\text{摄取通量}) - (\\text{损失率})\n$$\n总摄取通量是来自水和食物的摄取之和。\n- 来自水的摄取通量，单位鱼体质量：$k_1 C_w$。\n- 来自食物的摄取通量，单位鱼体质量：$AE \\cdot I \\cdot C_d$。\n因此，总摄取通量为 $J_{uptake} = k_1 C_w + AE \\cdot I \\cdot C_d$。\n\n损失过程包括排泄、生物转化和生长稀释。所有过程都假定遵循关于生物体浓度 $C_{org}$ 的一级动力学。\n- 因排泄导致的损失率：$k_2 C_{org}$。\n- 因生物转化导致的损失率：$k_m C_{org}$。\n- 因生长稀释导致的损失率：$g C_{org}$。\n总损失率是这些单独速率之和：$J_{loss} = (k_2 + k_m + g)C_{org}$。\n\n完整的动态方程是：\n$$\n\\frac{dC_{org}}{dt} = (k_1 C_w + AE \\cdot I \\cdot C_d) - (k_2 + k_m + g)C_{org}\n$$\n在稳态下，$\\frac{dC_{org}}{dt} = 0$，浓度为稳态身体负荷，$C_{org} = B^{*}$。\n$$\n0 = (k_1 C_w + AE \\cdot I \\cdot C_d) - (k_2 + k_m + g)B^{*}\n$$\n解出 $B^{*}$ 得：\n$$\nB^{*} = \\frac{k_1 C_w + AE \\cdot I \\cdot C_d}{k_2 + k_m + g}\n$$\n\n**第2部分：推导灵敏度系数 $s_p$**\n\n归一化灵敏度定义为 $s_p \\equiv \\frac{\\partial \\ln B^{*}}{\\partial \\ln p} = \\frac{p}{B^{*}} \\frac{\\partial B^{*}}{\\partial p}$。\n令 $U = k_1 C_w + AE \\cdot I \\cdot C_d$ 为分子（总摄取通量），$K_{loss} = k_2 + k_m + g$ 为分母（总损失速率常数）。则 $B^{*} = \\frac{U}{K_{loss}}$，且 $\\ln B^{*} = \\ln U - \\ln K_{loss}$。\n\n对于摄取参数 $p \\in \\{k_1, C_w, AE, I, C_d\\}$，该参数仅出现在 $U$ 中。\n$$\ns_p = \\frac{\\partial (\\ln U - \\ln K_{loss})}{\\partial \\ln p} = \\frac{\\partial \\ln U}{\\partial \\ln p} = \\frac{p}{U} \\frac{\\partial U}{\\partial p}\n$$\n- 对于 $p = k_1$：$\\frac{\\partial U}{\\partial k_1} = C_w \\implies s_{k_1} = \\frac{k_1 C_w}{U} = \\frac{k_1 C_w}{k_1 C_w + AE \\cdot I \\cdot C_d}$\n- 对于 $p = C_w$：$\\frac{\\partial U}{\\partial C_w} = k_1 \\implies s_{C_w} = \\frac{C_w k_1}{U} = \\frac{k_1 C_w}{k_1 C_w + AE \\cdot I \\cdot C_d}$\n- 对于 $p = AE$：$\\frac{\\partial U}{\\partial AE} = I C_d \\implies s_{AE} = \\frac{AE \\cdot I C_d}{U} = \\frac{AE \\cdot I \\cdot C_d}{k_1 C_w + AE \\cdot I \\cdot C_d}$\n- 对于 $p = I$：$\\frac{\\partial U}{\\partial I} = AE C_d \\implies s_I = \\frac{I \\cdot AE C_d}{U} = \\frac{AE \\cdot I \\cdot C_d}{k_1 C_w + AE \\cdot I \\cdot C_d}$\n- 对于 $p = C_d$：$\\frac{\\partial U}{\\partial C_d} = AE \\cdot I \\implies s_{C_d} = \\frac{C_d \\cdot AE \\cdot I}{U} = \\frac{AE \\cdot I \\cdot C_d}{k_1 C_w + AE \\cdot I \\cdot C_d}$\n\n对于损失参数 $p \\in \\{k_2, k_m, g\\}$，该参数仅出现在 $K_{loss}$ 中。\n$$\ns_p = \\frac{\\partial (\\ln U - \\ln K_{loss})}{\\partial \\ln p} = -\\frac{\\partial \\ln K_{loss}}{\\partial \\ln p} = -\\frac{p}{K_{loss}} \\frac{\\partial K_{loss}}{\\partial p}\n$$\n- 对于 $p = k_2$：$\\frac{\\partial K_{loss}}{\\partial k_2} = 1 \\implies s_{k_2} = -\\frac{k_2}{K_{loss}} = -\\frac{k_2}{k_2 + k_m + g}$\n- 对于 $p = k_m$：$\\frac{\\partial K_{loss}}{\\partial k_m} = 1 \\implies s_{k_m} = -\\frac{k_m}{K_{loss}} = -\\frac{k_m}{k_2 + k_m + g}$\n- 对于 $p = g$：$\\frac{\\partial K_{loss}}{\\partial g} = 1 \\implies s_g = -\\frac{g}{K_{loss}} = -\\frac{g}{k_2 + k_m + g}$\n\n**第3部分：计算 $F_{\\mathrm{loss}}$**\n\n首先，使用给定的参数值计算中间项的数值。\n- 水摄取通量：$J_w = k_1 C_w = (0.8)(5) = 4\\ \\mathrm{ng\\ kg^{-1}\\ d^{-1}}$。\n- 食物摄取通量：$J_d = AE \\cdot I \\cdot C_d = (0.7)(0.03)(500) = 10.5\\ \\mathrm{ng\\ kg^{-1}\\ d^{-1}}$。\n- 总摄取通量：$U = J_w + J_d = 4 + 10.5 = 14.5\\ \\mathrm{ng\\ kg^{-1}\\ d^{-1}}$。\n- 总损失速率常数：$K_{loss} = k_2 + k_m + g = 0.02 + 0.01 + 0.005 = 0.035\\ \\mathrm{d^{-1}}$。\n\n接下来，计算灵敏度系数的数值。\n- $s_{k_1} = s_{C_w} = \\frac{J_w}{U} = \\frac{4}{14.5} = \\frac{8}{29}$。\n- $s_{AE} = s_{I} = s_{C_d} = \\frac{J_d}{U} = \\frac{10.5}{14.5} = \\frac{21}{29}$。\n- $s_{k_2} = -\\frac{k_2}{K_{loss}} = -\\frac{0.02}{0.035} = -\\frac{4}{7}$。\n- $s_{k_m} = -\\frac{k_m}{K_{loss}} = -\\frac{0.01}{0.035} = -\\frac{2}{7}$。\n- $s_g = -\\frac{g}{K_{loss}} = -\\frac{0.005}{0.035} = -\\frac{1}{7}$。\n\n现在，计算方差计算中的项 $(s_p \\cdot \\mathrm{CV}(p))^2$。\n令 $V_{p} = (s_p \\cdot \\mathrm{CV}(p))^2$。\n\n损失过程的方差贡献：\n- $V_{k_2} = \\left(-\\frac{4}{7} \\cdot 0.25\\right)^2 = \\left(-\\frac{1}{7}\\right)^2 = \\frac{1}{49}$。\n- $V_{k_m} = \\left(-\\frac{2}{7} \\cdot 0.5\\right)^2 = \\left(-\\frac{1}{7}\\right)^2 = \\frac{1}{49}$。\n- $V_g = \\left(-\\frac{1}{7} \\cdot 0.3\\right)^2 = \\frac{0.09}{49}$。\n损失过程的总和是 $F_{\\mathrm{loss}}$ 的分子：\n$$\n\\sum_{p \\in \\{k_2, k_m, g\\}} V_p = \\frac{1}{49} + \\frac{1}{49} + \\frac{0.09}{49} = \\frac{2.09}{49}\n$$\n\n摄取过程的方差贡献：\n- $V_{k_1} = \\left(\\frac{8}{29} \\cdot 0.5\\right)^2 = \\left(\\frac{4}{29}\\right)^2 = \\frac{16}{841}$。\n- $V_{C_w} = \\left(\\frac{8}{29} \\cdot 0.3\\right)^2 = \\left(\\frac{2.4}{29}\\right)^2 = \\frac{5.76}{841}$。\n- $V_{AE} = \\left(\\frac{21}{29} \\cdot 0.2\\right)^2 = \\left(\\frac{4.2}{29}\\right)^2 = \\frac{17.64}{841}$。\n- $V_I = \\left(\\frac{21}{29} \\cdot 0.4\\right)^2 = \\left(\\frac{8.4}{29}\\right)^2 = \\frac{70.56}{841}$。\n- $V_{C_d} = \\left(\\frac{21}{29} \\cdot 0.6\\right)^2 = \\left(\\frac{12.6}{29}\\right)^2 = \\frac{158.76}{841}$。\n摄取过程的总和是：\n$$\n\\sum_{p \\in \\text{uptake}} V_p = \\frac{16 + 5.76 + 17.64 + 70.56 + 158.76}{841} = \\frac{268.72}{841}\n$$\n\n总方差是所有过程贡献的总和（$F_{\\mathrm{loss}}$ 的分母）：\n$$\n\\sum_{\\text{all } p} V_p = \\frac{2.09}{49} + \\frac{268.72}{841}\n$$\n一个公分母是 $49 \\times 841 = 41209$。\n$$\n\\sum_{\\text{all } p} V_p = \\frac{2.09 \\cdot 841}{41209} + \\frac{268.72 \\cdot 49}{41209} = \\frac{1757.69 + 13167.28}{41209} = \\frac{14924.97}{41209}\n$$\n分子是 $\\sum_{p \\in \\text{loss}} V_p = \\frac{2.09}{49} = \\frac{1757.69}{41209}$。\n\n最后，计算分数 $F_{\\mathrm{loss}}$：\n$$\nF_{\\mathrm{loss}} = \\frac{\\sum_{p \\in \\{k_2, k_m, g\\}} V_p}{\\sum_{\\text{all } p} V_p} = \\frac{1757.69 / 41209}{14924.97 / 41209} = \\frac{1757.69}{14924.97} \\approx 0.1177683\n$$\n四舍五入到四位有效数字得到 $0.1178$。", "answer": "$$\n\\boxed{0.1178}\n$$", "id": "2472203"}, {"introduction": "在毒代动力学模型的基础上，本练习深入探讨了从体外到体内外推（in vitro to in vivo extrapolation, IVIVE）的关键实践。您将学习如何将实验室测得的代谢清除率转化为整个生物体的速率常数，这是预测毒理学的一块基石，可以减少对动物试验的依赖。此项实践还引入了正规的不确定性分析，使您能够量化实验输入的可变性如何传播到最终的模型参数中。[@problem_id:2472181]", "problem": "一种疏水性有机污染物表现出可由肝细胞测量的生物转化，您希望将体外固有清除率转化为体内一级代谢生物转化速率常数，以便为单室生理毒代动力学（PBTK）模型中的体内负荷动力学提供信息。假设一个体积为 $V_{b}$ 的充分混合的机体房室，通过血-体分配系数 $K_{b}$ 与血液快速达到平衡，并且肝脏消除遵循充分搅拌肝模型，其中肝血流量为 $Q_{h}$，血液中未结合分数为 $f_{u,b}$。体外固有清除率在肝细胞中测量，并使用肝细胞密度和肝脏质量将其放大至整个肝脏。\n\n数据：\n- 每个肝细胞的体外固有清除率：$Cl_{\\text{int, in vitro}} = 0.35\\ \\mu\\text{L}\\ \\text{min}^{-1}\\ (10^{6}\\ \\text{cells})^{-1}$。\n- 肝细胞密度（每克肝脏的肝细胞数）：$H = 120 \\times 10^{6}\\ \\text{cells}\\ \\text{g}^{-1}$。\n- 肝脏质量：$M_{l} = 10\\ \\text{g}$。\n- 肝血流量：$Q_{h} = 19.0\\ \\text{L}\\ \\text{day}^{-1}$。\n- 血中未结合分数：$f_{u,b} = 0.15$。\n- 血-体分配系数：$K_{b} = 8.0$。\n- 身体体积：$V_{b} = 0.25\\ \\text{L}$。\n\n不确定性模型：\n- 将 $Cl_{\\text{int, in vitro}}$、$H$、$M_{l}$、$Q_{h}$、$f_{u,b}$ 和 $K_{b}$ 视为独立的对数正态分布输入，其变异系数分别为 $CV(Cl_{\\text{int, in vitro}}) = 0.25$、$CV(H) = 0.15$、$CV(M_{l}) = 0.05$、$CV(Q_{h}) = 0.10$、$CV(f_{u,b}) = 0.20$ 和 $CV(K_{b}) = 0.30$。将 $V_{b}$ 视为无不确定性的已知量。\n\n任务：\n1. 从与充分搅拌肝模型相连的单室身体的质量平衡出发，推导出体内一级代谢生物转化速率常数 $k_{m}$（单位 day$^{-1}$），使其成为 $Cl_{\\text{int, in vitro}}$、$H$、$M_{l}$、$Q_{h}$、$f_{u,b}$、$K_{b}$ 和 $V_{b}$ 的函数。清楚地说明您定义和使用的中间生理量，并在需要时使用标准单位转换。\n2. 使用对数尺度上的一阶不确定性传播（针对对数正态输入的delta方法），其中 $\\operatorname{Var}[\\ln y] = \\sum_{i} \\left(\\frac{\\partial \\ln y}{\\partial \\ln x_{i}}\\right)^{2} \\operatorname{Var}[\\ln x_{i}]$ 且对于独立输入 $\\operatorname{Var}[\\ln x_{i}] = \\ln\\!\\big(1 + CV(x_{i})^{2}\\big)$，计算 $k_{m}$ 的变异系数，表示为 $CV(k_{m}) = \\sqrt{\\exp\\!\\big(\\operatorname{Var}[\\ln k_{m}]\\big) - 1}$。\n\n将您的最终答案以小数形式（无单位）表示为单个量 $CV(k_{m})$。将您的答案四舍五入至三位有效数字。", "solution": "在尝试任何解答之前，需对问题进行验证。\n\n**步骤1：提取已知条件**\n提供以下数据和定义：\n- 每个肝细胞的体外固有清除率：$Cl_{\\text{int, in vitro}} = 0.35\\ \\mu\\text{L}\\ \\text{min}^{-1}\\ (10^{6}\\ \\text{cells})^{-1}$。\n- 肝细胞密度：$H = 120 \\times 10^{6}\\ \\text{cells}\\ \\text{g}^{-1}$。\n- 肝脏质量：$M_{l} = 10\\ \\text{g}$。\n- 肝血流量：$Q_{h} = 19.0\\ \\text{L}\\ \\text{day}^{-1}$。\n- 血中未结合分数：$f_{u,b} = 0.15$。\n- 血-体分配系数：$K_{b} = 8.0$。\n- 身体体积：$V_{b} = 0.25\\ \\text{L}$。\n- 不确定性模型：$Cl_{\\text{int, in vitro}}$、$H$、$M_{l}$、$Q_{h}$、$f_{u,b}$ 和 $K_{b}$ 是独立的对数正态分布随机变量。$V_{b}$ 是一个常数。\n- 变异系数 (CV)：$CV(Cl_{\\text{int, in vitro}}) = 0.25$、$CV(H) = 0.15$、$CV(M_{l}) = 0.05$、$CV(Q_{h}) = 0.10$、$CV(f_{u,b}) = 0.20$、$CV(K_{b}) = 0.30$。\n- 对数转换变量的方差公式：$\\operatorname{Var}[\\ln x_{i}] = \\ln(1 + CV(x_{i})^{2})$。\n- 一阶不确定性传播公式：$\\operatorname{Var}[\\ln y] = \\sum_{i} \\left(\\frac{\\partial \\ln y}{\\partial \\ln x_{i}}\\right)^{2} \\operatorname{Var}[\\ln x_{i}]$。\n- 从对数方差计算CV的公式：$CV(y) = \\sqrt{\\exp(\\operatorname{Var}[\\ln y]) - 1}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于生理毒代动力学（PBTK）模型的既定原则，特别是充分搅拌肝模型和体外至体内外推（IVIVE）的标准方法。所有概念，如固有清除率、分配系数、血流量和蛋白质结合，都是该领域的基础。该问题在科学上是合理的。\n- **良定性**：该问题提供了推导目标量和执行不确定性分析所需的所有必要数据、模型假设和数学公式。任务陈述清晰，可以导出一个唯一的、有意义的解。\n- **客观性**：该问题以精确、定量和无偏见的技术语言陈述。\n\n**步骤3：结论与行动**\n该问题被认为是有效的，因为其科学依据充分、良定且客观。将提供解答。\n\n**任务1：代谢速率常数 $k_{m}$ 的推导**\n\n该系统被描述为一个单室身体模型。体内污染物总量 $A_{b}$ 由其在体内的浓度 $C_{b}$ 与身体体积 $V_{b}$ 的乘积给出：\n$$A_{b} = C_{b} V_{b}$$\n体内污染物总量的变化速率由肝脏中的代谢消除所决定。此消除过程被建模为速率常数为 $k_{m}$ 的一级过程：\n$$\\frac{dA_{b}}{dt} = -k_{m} A_{b}$$\n消除速率也可以用肝清除率 $Cl_{h}$ 和血液中污染物的浓度 $C_{\\text{blood}}$来表示。问题指出身体房室通过血-体分配系数 $K_{b}$ 与血液快速达到平衡，该系数定义为 $K_{b} = C_{\\text{blood}} / C_{b}$。因此，$C_{\\text{blood}} = K_{b} C_{b}$。\n因此，肝消除速率为：\n$$\\text{Elimination Rate} = Cl_{h} C_{\\text{blood}} = Cl_{h} K_{b} C_{b}$$\n代入 $C_{b} = A_{b} / V_{b}$，我们得到：\n$$\\text{Elimination Rate} = Cl_{h} K_{b} \\frac{A_{b}}{V_{b}} = \\left( \\frac{K_{b} Cl_{h}}{V_{b}} \\right) A_{b}$$\n通过将两种变化速率的表达式相等，我们找到一级代谢速率常数 $k_{m}$：\n$$k_{m} = \\frac{K_{b} Cl_{h}}{V_{b}}$$\n肝清除率 $Cl_{h}$ 由充分搅拌肝模型描述：\n$$Cl_{h} = Q_{h} \\frac{f_{u,b} Cl_{\\text{int,L}}}{Q_{h} + f_{u,b} Cl_{\\text{int,L}}}$$\n此处，$Cl_{\\text{int,L}}$ 代表整个肝脏的总固有清除率。这必须从提供的体外数据进行放大。体外固有清除率 $Cl_{\\text{int, in vitro}}$ 是以每 $10^{6}$ 个肝细胞为单位给出的。肝脏中肝细胞的总数是肝细胞密度 $H$ 和肝脏质量 $M_{l}$ 的乘积。\n肝脏的总固有清除率，单位为 $\\mu\\text{L}/\\text{min}$，是：\n$$Cl_{\\text{int,L}} [\\mu\\text{L}/\\text{min}] = Cl_{\\text{int, in vitro}} \\times H \\times M_{l}$$\n问题要求 $k_{m}$ 的单位为 $\\text{day}^{-1}$。$Cl_{h}$ 表达式中的所有参数必须具有一致的单位，通常是 $\\text{L}/\\text{day}$。我们定义一个转换因子 $\\alpha$，将 $Cl_{\\text{int,L}}$ 从 $\\mu\\text{L}/\\text{min}$ 转换为 $\\text{L}/\\text{day}$：\n$$\\alpha = \\frac{1440\\ \\text{min}}{1\\ \\text{day}} \\times \\frac{1\\ \\text{L}}{10^{6}\\ \\mu\\text{L}} = 1.44 \\times 10^{-3} \\frac{\\text{L} \\cdot \\text{min}}{\\mu\\text{L} \\cdot \\text{day}}$$\n设 $Cl_{\\text{int}}^{*}$ 为以 $\\text{L}/\\text{day}$ 为单位的总肝固有清除率：\n$$Cl_{\\text{int}}^{*} = \\alpha \\cdot Cl_{\\text{int, in vitro}} \\cdot H \\cdot M_{l}$$\n将此代入 $Cl_{h}$ 的表达式（现在所有项的单位都兼容），然后再代入 $k_{m}$ 的表达式，我们得到最终的函数：\n$$k_{m} = \\frac{K_{b}}{V_{b}} \\left( Q_{h} \\frac{f_{u,b} Cl_{\\text{int}}^{*}}{Q_{h} + f_{u,b} Cl_{\\text{int}}^{*}} \\right) = \\frac{K_{b} Q_{h}}{V_{b}} \\frac{f_{u,b} (\\alpha \\cdot Cl_{\\text{int, in vitro}} \\cdot H \\cdot M_{l})}{Q_{h} + f_{u,b} (\\alpha \\cdot Cl_{\\text{int, in vitro}} \\cdot H \\cdot M_{l})}$$\n这完成了任务1的推导。\n\n**任务2：计算 $k_{m}$ 的变异系数**\n\n我们必须计算 $CV(k_{m}) = \\sqrt{\\exp(\\operatorname{Var}[\\ln k_{m}]) - 1}$。这需要使用提供的delta方法公式来求出 $\\operatorname{Var}[\\ln k_{m}]$。首先，我们确定所需的形式为 $\\frac{\\partial \\ln k_{m}}{\\partial \\ln x_{i}}$ 的偏导数，也称为灵敏度系数。\n$k_{m}$ 的自然对数为：\n$$\\ln k_{m} = \\ln K_{b} + \\ln Q_{h} - \\ln V_{b} + \\ln(f_{u,b}) + \\ln(Cl_{\\text{int}}^{*}) - \\ln(Q_{h} + f_{u,b} Cl_{\\text{int}}^{*})$$\n由于 $Cl_{\\text{int}}^{*} = \\alpha \\cdot Cl_{\\text{int, in vitro}} \\cdot H \\cdot M_{l}$，我们有 $\\ln(Cl_{\\text{int}}^{*}) = \\ln \\alpha + \\ln Cl_{\\text{int, in vitro}} + \\ln H + \\ln M_{l}$。\n\n灵敏度系数计算如下：\n- 对于 $K_{b}$：$\\frac{\\partial \\ln k_{m}}{\\partial \\ln K_{b}} = 1$。\n- 对于 $Cl_{\\text{int}}^{*}$ 内的变量（$Cl_{\\text{int, in vitro}}$、$H$、$M_{l}$）和 $f_{u,b}$：设 $x$ 为这些变量中的任何一个，并设 $Z = f_{u,b} Cl_{\\text{int}}^{*}$。\n  $$\\frac{\\partial \\ln k_{m}}{\\partial \\ln x} = \\frac{\\partial(\\ln Z - \\ln(Q_h + Z))}{\\partial \\ln x} = 1 - \\frac{\\partial \\ln(Q_h + Z)}{\\partial \\ln x} = 1 - \\frac{Z}{Q_h + Z} = \\frac{Q_h}{Q_h + Z}$$\n  所以，对于 $x \\in \\{Cl_{\\text{int, in vitro}}, H, M_{l}, f_{u,b}\\}$，灵敏度为 $S_{Z} = \\frac{Q_h}{Q_h + f_{u,b} Cl_{\\text{int}}^{*}}$。\n- 对于 $Q_{h}$：\n  $$\\frac{\\partial \\ln k_{m}}{\\partial \\ln Q_{h}} = \\frac{\\partial(\\ln Q_h - \\ln(Q_h + Z))}{\\partial \\ln Q_h} = 1 - \\frac{Q_h}{Q_h + Z} = \\frac{Z}{Q_h + Z}$$\n  灵敏度为 $S_{Q_{h}} = \\frac{f_{u,b} Cl_{\\text{int}}^{*}}{Q_{h} + f_{u,b} Cl_{\\text{int}}^{*}}$。\n\n接下来，我们使用输入的平均值来评估这些灵敏度系数。\n首先，计算 $Cl_{\\text{int}}^{*}$：\n$$Cl_{\\text{int}}^{*} = (1.44 \\times 10^{-3}) \\times (0.35) \\times (120) \\times (10) = 0.6048\\ \\text{L}/\\text{day}$$\n然后，计算项 $f_{u,b} Cl_{\\text{int}}^{*}$：\n$$f_{u,b} Cl_{\\text{int}}^{*} = 0.15 \\times 0.6048 = 0.09072\\ \\text{L}/\\text{day}$$\n现在，计算灵敏度：\n$$S_{Z} = \\frac{19.0}{19.0 + 0.09072} = \\frac{19.0}{19.09072} \\approx 0.995249$$\n$$S_{Q_{h}} = \\frac{0.09072}{19.0 + 0.09072} = \\frac{0.09072}{19.09072} \\approx 0.004751$$\n\n现在，计算对数转换后输入的方差，$\\operatorname{Var}[\\ln x_{i}] = \\ln(1 + CV(x_{i})^{2})$：\n- $x_{1} = Cl_{\\text{int, in vitro}}$: $\\operatorname{Var}[\\ln x_{1}] = \\ln(1 + 0.25^{2}) = \\ln(1.0625) \\approx 0.060625$\n- $x_{2} = H$: $\\operatorname{Var}[\\ln x_{2}] = \\ln(1 + 0.15^{2}) = \\ln(1.0225) \\approx 0.022253$\n- $x_{3} = M_{l}$: $\\operatorname{Var}[\\ln x_{3}] = \\ln(1 + 0.05^{2}) = \\ln(1.0025) \\approx 0.002497$\n- $x_{4} = Q_{h}$: $\\operatorname{Var}[\\ln x_{4}] = \\ln(1 + 0.10^{2}) = \\ln(1.01) \\approx 0.009950$\n- $x_{5} = f_{u,b}$: $\\operatorname{Var}[\\ln x_{5}] = \\ln(1 + 0.20^{2}) = \\ln(1.04) \\approx 0.039221$\n- $x_{6} = K_{b}$: $\\operatorname{Var}[\\ln x_{6}] = \\ln(1 + 0.30^{2}) = \\ln(1.09) \\approx 0.086178$\n\n现在，我们计算总方差 $\\operatorname{Var}[\\ln k_{m}]$：\n$$\\operatorname{Var}[\\ln k_{m}] = \\left(\\frac{\\partial \\ln k_{m}}{\\partial \\ln K_b}\\right)^2 \\operatorname{Var}[\\ln K_b] + \\left(\\frac{\\partial \\ln k_{m}}{\\partial \\ln Q_h}\\right)^2 \\operatorname{Var}[\\ln Q_h] + \\sum_{x \\in \\{Cl_{\\text{int}}, H, M_l, f_{u,b}\\}} \\left(\\frac{\\partial \\ln k_{m}}{\\partial \\ln x}\\right)^2 \\operatorname{Var}[\\ln x]$$\n$$\\operatorname{Var}[\\ln k_{m}] = (1)^{2}\\operatorname{Var}[\\ln K_b] + (S_{Q_h})^{2}\\operatorname{Var}[\\ln Q_h] + (S_Z)^{2}(\\operatorname{Var}[\\ln Cl_{\\text{int}}] + \\operatorname{Var}[\\ln H] + \\operatorname{Var}[\\ln M_l] + \\operatorname{Var}[\\ln f_{u,b}])$$\n代入数值：\n$$\\operatorname{Var}[\\ln k_{m}] \\approx (1)^{2}(0.086178) + (0.004751)^{2}(0.009950) + (0.995249)^{2}(0.060625 + 0.022253 + 0.002497 + 0.039221)$$\n$$\\operatorname{Var}[\\ln k_{m}] \\approx 0.086178 + (2.257 \\times 10^{-5})(0.009950) + (0.99052)(0.124596)$$\n$$\\operatorname{Var}[\\ln k_{m}] \\approx 0.086178 + 2.246 \\times 10^{-7} + 0.123415$$\n$$\\operatorname{Var}[\\ln k_{m}] \\approx 0.209593$$\n\n最后，我们计算变异系数 $CV(k_{m})$：\n$$CV(k_{m}) = \\sqrt{\\exp(\\operatorname{Var}[\\ln k_{m}]) - 1} \\approx \\sqrt{\\exp(0.209593) - 1}$$\n$$CV(k_{m}) \\approx \\sqrt{1.23318 - 1} = \\sqrt{0.23318} \\approx 0.482887$$\n四舍五入到三位有效数字，我们得到 $0.483$。", "answer": "$$\n\\boxed{0.483}\n$$", "id": "2472181"}, {"introduction": "这最后一项实践将您从对个体的理论建模转向对整个食物网的实证分析。您将实现用于计算营养级放大因子（Trophic Magnification Factor, TMF）的统计框架，这是根据现场数据评估生物放大的关键指标。这个动手编码练习将巩固您对如何从统计学上检验生物放大作用以及如何处理特定群体差异等复杂问题的理解，从而架起生态理论与数据驱动推断之间的桥梁。[@problem_id:2472211]", "problem": "您将获得由营养级和脂质标准化污染物浓度组成的物种级别观测数据。您的目标是根据第一性原理，形式化并实现对数线性营养放大模型的拟合，检验不同组间的斜率异质性，并计算营养放大因子的置信区间。\n\n从以下基本原理开始：\n- 营养放大框架假定，对于具有生物放大效应的污染物，消费者生物体内的稳态浓度与营养级之间的关系是，每个营养级都有一个近似恒定的倍数变化。在以 10 为底的对数线性模型下，这表示为 $ \\log_{10}(C_i) = \\beta_0 + \\beta_1 \\,\\mathrm{TP}_i + \\varepsilon_i $，其中 $C_i$ 是物种 $i$ 的脂质标准化浓度，$\\mathrm{TP}_i$ 是营养级，$\\beta_0$ 和 $\\beta_1$ 是回归参数，$\\varepsilon_i$ 是均值为 $0$、方差恒定的独立正态误差。\n- 营养放大因子 (TMF) 定义为，在对数线性模型下，营养级每增加一个单位，浓度的倍数变化。对于以 10 为底的对数，$\\mathrm{TMF} = 10^{\\beta_1}$。\n- 在高斯误差假设下，普通最小二乘 (OLS) 估计提供无偏的线性参数估计，并且在线性无偏估计量中方差最小，同时线性系数的标准 t 置信区间在渐近和正态性假设下成立。\n\n您的程序必须：\n- 实现 OLS，从适当的简化模型中估计对数线性斜率及其标准误。\n- 当存在分组结构时，通过嵌套模型 F 检验来检验各组间的斜率异质性。在斜率相等的零假设下，此检验允许各组具有不同的截距。\n- 计算对数线性斜率在 0.95 置信水平下的双侧置信区间，并通过单调的以 10 为底的指数变换，将其转换为 $\\mathrm{TMF}$ 对应的置信区间。\n\n需要实现的建模和检验规范：\n- 令 $y_i = \\log_{10}(C_i)$。\n- 对于不含不同分组的数据集，通过 OLS 拟合简化模型 $y_i = \\beta_0 + \\beta_1 \\,\\mathrm{TP}_i + \\varepsilon_i$。将斜率估计值表示为 $\\hat{\\beta}_1$。令 $n$ 为观测数量，$p$ 为模型中的参数数量。将残差方差估计为 $\\hat{\\sigma}^2 = \\mathrm{RSS}/(n-p)$，其中 $\\mathrm{RSS}$ 是残差平方和，并将 $\\hat{\\beta}_1$ 的方差计算为 $\\hat{\\sigma}^2 (X^\\top X)^{-1}$ 的相应对角线元素。\n- 对于包含 $k \\ge 2$ 个分组（索引为 $g \\in \\{1,\\dots,k\\}$）的数据集，为 $k-1$ 个分组定义指示符列，并：\n  - 拟合具有共同斜率和分组特定截距的简化模型：$y_i = \\beta_0 + \\beta_1 \\,\\mathrm{TP}_i + \\sum_{j=2}^k \\gamma_j \\,\\mathbb{I}\\{G_i = j\\} + \\varepsilon_i$。\n  - 拟合具有分组特定斜率（交互作用）的完整模型：$y_i = \\beta_0 + \\beta_1 \\,\\mathrm{TP}_i + \\sum_{j=2}^k \\gamma_j \\,\\mathbb{I}\\{G_i = j\\} + \\sum_{j=2}^k \\delta_j \\,\\mathrm{TP}_i \\,\\mathbb{I}\\{G_i = j\\} + \\varepsilon_i$。\n  - 令 $\\mathrm{RSS}_\\mathrm{red}$ 和 $\\mathrm{RSS}_\\mathrm{full}$ 表示残差平方和，令 $p_\\mathrm{red}$ 和 $p_\\mathrm{full}$ 表示简化模型和完整模型的参数数量，自由度为 $df_1 = p_\\mathrm{full} - p_\\mathrm{red}$ 和 $df_2 = n - p_\\mathrm{full}$。计算 $F = \\frac{(\\mathrm{RSS}_\\mathrm{red} - \\mathrm{RSS}_\\mathrm{full})/df_1}{\\mathrm{RSS}_\\mathrm{full}/df_2}$ 以及在自由度为 $(df_1, df_2)$ 的 $F$ 分布下对应的上尾 $p$ 值。在显著性水平 $\\alpha = 0.05$ 下，如果该 $p$ 值小于 $\\alpha$，则拒绝斜率同质性假设。\n  - 对于 $\\mathrm{TMF}$ 估计及其置信区间，请使用简化模型（仅包含分组主效应）的斜率估计值 $\\hat{\\beta}_1$ 及其标准误。\n- 斜率和 $\\mathrm{TMF}$ 的置信区间构造：\n  - $\\beta_1$ 的 $0.95$ 置信区间由 $\\hat{\\beta}_1 \\pm t_{1-\\alpha/2, \\, df} \\,\\mathrm{SE}(\\hat{\\beta}_1)$ 给出，其中 $df$ 是简化模型的残差自由度，$t_{1-\\alpha/2, \\, df}$ 是 Student $t$ 分布的上分位数。\n  - 根据变换 $x \\mapsto 10^x$ 的单调性，$\\mathrm{TMF}$ 对应的 $0.95$ 置信区间为 $[10^{L}, \\, 10^{U}]$，其中 $[L, U]$ 是 $\\beta_1$ 的置信区间。\n\n用于测试的输入数据，浓度单位为 ng g$^{-1}$ 脂质重量，营养级无单位：\n- 情况 $1$（单组，正斜率）：\n  - 营养级 $\\mathrm{TP} = [2.0, 2.3, 2.6, 2.9, 3.2, 3.5, 3.8, 4.1]$。\n  - 浓度 $C = [0.0331, 0.0367, 0.0447, 0.0542, 0.0602, 0.0750, 0.0913, 0.1032]$。\n  - 分组 $G = ['A', 'A', 'A', 'A', 'A', 'A', 'A', 'A']$。\n- 情况 $2$（两组，斜率相似，截距不同）：\n  - 营养级 $\\mathrm{TP} = [2.0, 2.5, 3.0, 3.5, 4.0, 2.1, 2.6, 3.1, 3.6, 4.1]$。\n  - 浓度 $C = [0.0200, 0.0258, 0.0308, 0.0398, 0.0501, 0.0267, 0.0327, 0.0417, 0.0533, 0.0652]$。\n  - 分组 $G = ['A', 'A', 'A', 'A', 'A', 'B', 'B', 'B', 'B', 'B']$。\n- 情况 $3$（两组，斜率异质）：\n  - 营养级 $\\mathrm{TP} = [2.0, 2.5, 3.0, 3.5, 4.0, 2.1, 2.6, 3.1, 3.6, 4.1]$。\n  - 浓度 $C = [0.0200, 0.0212, 0.0226, 0.0235, 0.0251, 0.0859, 0.1320, 0.1880, 0.2880, 0.4310]$。\n  - 分组 $G = ['A', 'A', 'A', 'A', 'A', 'B', 'B', 'B', 'B', 'B']$。\n- 情况 $4$（单组，斜率接近于零）：\n  - 营养级 $\\mathrm{TP} = [2.0, 2.5, 3.0, 3.5, 4.0, 4.5]$。\n  - 浓度 $C = [0.0331, 0.0308, 0.0316, 0.0308, 0.0324, 0.0308]$。\n  - 分组 $G = ['A', 'A', 'A', 'A', 'A', 'A']$。\n\n输出规范：\n- 对于每种情况，计算：\n  - 由简化模型斜率 $\\hat{\\beta}_1$ 得出的 $\\mathrm{TMF}$ 点估计值 $10^{\\hat{\\beta}_1}$。\n  - 通过对斜率置信区间端点进行以 10 为底的指数变换得到的 $\\mathrm{TMF}$ 的双侧 $0.95$ 置信区间端点，即 $[10^{L}, 10^{U}]$。\n  - 一个布尔值，指示在显著性水平 $\\alpha = 0.05$ 下是否拒绝各组间的斜率同质性假设。对于只有一个分组的情况，返回布尔值 $\\mathrm{False}$。\n- 将所有报告的浮点数输出四舍五入到 4 位小数。\n- 您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表，其中每个元素对应一个测试用例，并且本身是一个 `[TMF, CI_low, CI_high, reject]` 形式的列表。例如：`[[..., ..., ..., True], [...], ...]`。", "solution": "问题已经过严格评估，并被确定为有效。它在科学上基于生态毒理学和统计线性建模的原理，问题提出得当，信息充分且一致，并使用客观、正式的语言表述。任务是实现一个标准、可验证的程序来分析营养放大数据。我们现在开始解决问题。\n\n方法论基础是用于一般线性模型的普通最小二乘 (OLS) 估计，其矩阵形式表示为 $\\mathbf{y} = X\\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}$，其中 $\\mathbf{y}$ 是 $n \\times 1$ 的观测向量，$X$ 是 $n \\times p$ 的设计矩阵，$\\boldsymbol{\\beta}$ 是 $p \\times 1$ 的参数向量，$\\boldsymbol{\\varepsilon}$ 是 $n \\times 1$ 的误差项向量，假设其独立同分布，均值为 $0$，方差为 $\\sigma^2$。$\\boldsymbol{\\beta}$ 的 OLS 估计量是使残差平方和（$\\mathrm{RSS}$）最小化的估计量，由 $\\hat{\\boldsymbol{\\beta}} = (X^\\top X)^{-1} X^\\top \\mathbf{y}$ 给出。\n\n对每个数据集的分析分几个步骤进行。首先，输入浓度 $C_i$ 被转换为响应变量 $y_i = \\log_{10}(C_i)$。然后，构造适当的设计矩阵以表示指定的线性模型。\n\n对于单个分组的数据集，或在多分组分析中的简化模型，模型为 $y_i = \\beta_0 + \\beta_1 \\mathrm{TP}_i + \\varepsilon_i$。设计矩阵 $X$ 有 $n$ 行和 $p=2$ 列：一列全为 1 的截距列和一列营养级 $\\mathrm{TP}_i$。对于包含 $k \\ge 2$ 个分组的多分组分析，具有共同斜率和分组特定截距的简化模型是 $y_i = \\beta_0 + \\beta_1 \\mathrm{TP}_i + \\sum_{j=2}^k \\gamma_j \\mathbb{I}\\{G_i=j\\} + \\varepsilon_i$，其中 $\\mathbb{I}\\{G_i=j\\}$ 是分组隶属关系的指示变量。该模型有 $p_{\\mathrm{red}} = 1 (\\text{截距}) + 1 (\\text{斜率}) + (k-1) (\\text{分组效应}) = k+1$ 个参数。对应的设计矩阵 $X_{\\mathrm{red}}$ 由截距列、营养级列和 $k-1$ 个非参考组的指示变量列构成。\n\n一旦参数 $\\hat{\\boldsymbol{\\beta}}$ 被估计出来，我们计算残差平方和 $\\mathrm{RSS} = \\sum_{i=1}^n (y_i - \\hat{y}_i)^2$，其中 $\\hat{y}_i = (X\\hat{\\boldsymbol{\\beta}})_i$。误差方差的无偏估计量是 $\\hat{\\sigma}^2 = \\mathrm{RSS}/(n-p)$，其中分母 $df = n-p$ 表示残差自由度。参数估计的方差-协方差矩阵由 $\\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\hat{\\sigma}^2 (X^\\top X)^{-1}$ 给出。斜率估计的标准误 $\\mathrm{SE}(\\hat{\\beta}_1)$ 是该矩阵第二个对角元素的平方根。\n\n为了检验 $k$ 个分组间的斜率异质性，我们将简化模型（共同斜率）与一个包含分组特定斜率的完整模型进行比较：$y_i = \\beta_0 + \\beta_1 \\mathrm{TP}_i + \\sum_{j=2}^k \\gamma_j \\mathbb{I}\\{G_i=j\\} + \\sum_{j=2}^k \\delta_j \\mathrm{TP}_i \\mathbb{I}\\{G_i=j\\} + \\varepsilon_i$。这个完整模型有 $p_{\\mathrm{full}} = 2k$ 个参数。设计矩阵 $X_{\\mathrm{full}}$ 包括 $X_{\\mathrm{red}}$ 的列，外加 $k-1$ 个交互作用列，其中每个交互作用列是 $\\mathrm{TP}$ 向量和分组指示符向量的逐元素乘积。这个比较通过嵌套模型 $F$ 检验来形式化。统计量计算如下：\n$$ F = \\frac{(\\mathrm{RSS}_{\\mathrm{red}} - \\mathrm{RSS}_{\\mathrm{full}})/(p_{\\mathrm{full}} - p_{\\mathrm{red}})}{\\mathrm{RSS}_{\\mathrm{full}}/(n - p_{\\mathrm{full}})} $$\n在无斜率异质性（即所有 $\\delta_j=0$）的零假设下，该统计量服从自由度为 $df_1 = p_{\\mathrm{full}} - p_{\\mathrm{red}}$ 和 $df_2 = n - p_{\\mathrm{full}}$ 的 $F$ 分布。如果在显著性水平 $\\alpha=0.05$ 下，计算出的 $p$ 值小于 $\\alpha$，我们拒绝零假设。对于单分组情况，此检验不适用，同质性不证自明。\n\n营养放大因子 $\\mathrm{TMF}$ 是根据简化模型（如果 $k>1$，则为具有分组特定截距的模型）的斜率估计为 $\\widehat{\\mathrm{TMF}} = 10^{\\hat{\\beta}_1}$。斜率参数 $\\beta_1$ 的双侧 $100(1-\\alpha)\\%$ 置信区间构造为 $\\hat{\\beta}_1 \\pm t_{1-\\alpha/2, df} \\mathrm{SE}(\\hat{\\beta}_1)$，其中 $t_{1-\\alpha/2, df}$ 是具有 $df = n - p_{\\mathrm{red}}$ 残差自由度的 Student's $t$ 分布的上临界值。设该区间为 $[L, U]$。由于指数函数的单调性，$\\mathrm{TMF}$ 对应的置信区间为 $[10^L, 10^U]$。此过程系统地应用于所有提供的测试用例。", "answer": "```python\nimport numpy as np\nfrom scipy.stats import t, f\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print the final results.\n    \"\"\"\n    test_cases = [\n        {\n            \"tp\": np.array([2.0, 2.3, 2.6, 2.9, 3.2, 3.5, 3.8, 4.1]),\n            \"conc\": np.array([0.0331, 0.0367, 0.0447, 0.0542, 0.0602, 0.0750, 0.0913, 0.1032]),\n            \"groups\": np.array(['A', 'A', 'A', 'A', 'A', 'A', 'A', 'A'])\n        },\n        {\n            \"tp\": np.array([2.0, 2.5, 3.0, 3.5, 4.0, 2.1, 2.6, 3.1, 3.6, 4.1]),\n            \"conc\": np.array([0.0200, 0.0258, 0.0308, 0.0398, 0.0501, 0.0267, 0.0327, 0.0417, 0.0533, 0.0652]),\n            \"groups\": np.array(['A', 'A', 'A', 'A', 'A', 'B', 'B', 'B', 'B', 'B'])\n        },\n        {\n            \"tp\": np.array([2.0, 2.5, 3.0, 3.5, 4.0, 2.1, 2.6, 3.1, 3.6, 4.1]),\n            \"conc\": np.array([0.0200, 0.0212, 0.0226, 0.0235, 0.0251, 0.0859, 0.1320, 0.1880, 0.2880, 0.4310]),\n            \"groups\": np.array(['A', 'A', 'A', 'A', 'A', 'B', 'B', 'B', 'B', 'B'])\n        },\n        {\n            \"tp\": np.array([2.0, 2.5, 3.0, 3.5, 4.0, 4.5]),\n            \"conc\": np.array([0.0331, 0.0308, 0.0316, 0.0308, 0.0324, 0.0308]),\n            \"groups\": np.array(['A', 'A', 'A', 'A', 'A', 'A'])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _analyze_case(case[\"tp\"], case[\"conc\"], case[\"groups\"])\n        results.append(result)\n\n    # Format output exactly as specified\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]},{r[2]},{str(r[3]).lower()}]\" for r in results]) + \"]\"\n    print(output_str)\n\ndef _ols_fit(X, y):\n    \"\"\"\n    Performs an Ordinary Least Squares (OLS) regression.\n\n    Args:\n        X (np.ndarray): The design matrix (n_samples, n_features).\n        y (np.ndarray): The response vector (n_samples,).\n\n    Returns:\n        tuple: A tuple containing:\n            - beta_hat (np.ndarray): Estimated coefficients.\n            - se_beta_hat (np.ndarray): Standard errors of coefficients.\n            - rss (float): Residual sum of squares.\n            - df_residual (int): Residual degrees of freedom.\n    \"\"\"\n    n, p = X.shape\n    df_residual = n - p\n\n    # Solve (X'X)B = X'y for B using a numerically stable method\n    try:\n        XtX = X.T @ X\n        Xty = X.T @ y\n        beta_hat = np.linalg.solve(XtX, Xty)\n    except np.linalg.LinAlgError:\n        return np.full(p, np.nan), np.full(p, np.nan), np.nan, df_residual\n\n    residuals = y - (X @ beta_hat)\n    rss = np.sum(residuals**2)\n\n    if df_residual > 0:\n        sigma_sq_hat = rss / df_residual\n        # Variance-covariance matrix of beta_hat\n        try:\n            cov_beta_hat = sigma_sq_hat * np.linalg.inv(XtX)\n            se_beta_hat = np.sqrt(np.diag(cov_beta_hat))\n        except np.linalg.LinAlgError:\n            se_beta_hat = np.full(p, np.nan)\n    else:\n        se_beta_hat = np.full(p, np.inf)\n\n    return beta_hat, se_beta_hat, rss, df_residual\n\ndef _analyze_case(tp, conc, groups):\n    \"\"\"\n    Analyzes a single case of trophic magnification data.\n    \"\"\"\n    y = np.log10(conc)\n    n = len(y)\n    unique_groups = sorted(list(set(groups)))\n    k = len(unique_groups)\n    alpha = 0.05\n\n    # --- Reduced Model (for TMF estimation and as null for F-test) ---\n    # Model: common slope, group-specific intercepts (if k > 1)\n    # X_red columns: Intercept, TP, and k-1 group dummies\n    X_red = np.column_stack([np.ones(n), tp])\n    if k > 1:\n        for i in range(1, k):  # Reference group is unique_groups[0]\n            group_indicator = (groups == unique_groups[i]).astype(int)\n            X_red = np.column_stack([X_red, group_indicator])\n\n    beta_hat_red, se_beta_hat_red, rss_red, df_red = _ols_fit(X_red, y)\n    \n    # The common slope (beta_1) is the second coefficient\n    beta1_hat = beta_hat_red[1]\n    se_beta1 = se_beta_hat_red[1]\n\n    # --- Slope Heterogeneity F-Test (if k > 1) ---\n    reject_homogeneity = False\n    if k > 1:\n        # Full Model: group-specific slopes and intercepts\n        # X_full columns: X_red + k-1 interaction terms (TP * group_dummy)\n        X_full = X_red.copy()\n        for i in range(1, k):\n            group_indicator = (groups == unique_groups[i]).astype(int)\n            interaction_term = tp * group_indicator\n            X_full = np.column_stack([X_full, interaction_term])\n\n        _, _, rss_full, _ = _ols_fit(X_full, y)\n        \n        p_red = X_red.shape[1]\n        p_full = X_full.shape[1]\n        \n        df1 = p_full - p_red\n        df2 = n - p_full\n        \n        if rss_full > 1e-12 and df1 > 0 and df2 > 0 and rss_red > rss_full:\n            F_stat = ((rss_red - rss_full) / df1) / (rss_full / df2)\n            p_value = f.sf(F_stat, df1, df2)\n            if p_value < alpha:\n                reject_homogeneity = True\n\n    # --- TMF and Confidence Interval Calculation ---\n    # Based on the reduced model, as per instructions\n    tmf_est = 10**beta1_hat\n\n    # Critical t-value from Student's t-distribution\n    t_crit = t.ppf(1 - alpha / 2, df_red)\n    \n    # Confidence interval for the slope beta_1\n    ci_beta1_lower = beta1_hat - t_crit * se_beta1\n    ci_beta1_upper = beta1_hat + t_crit * se_beta1\n    \n    # Transformed confidence interval for TMF\n    ci_tmf_lower = 10**ci_beta1_lower\n    ci_tmf_upper = 10**ci_beta1_upper\n\n    return [\n        round(tmf_est, 4),\n        round(ci_tmf_lower, 4),\n        round(ci_tmf_upper, 4),\n        reject_homogeneity\n    ]\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2472211"}]}