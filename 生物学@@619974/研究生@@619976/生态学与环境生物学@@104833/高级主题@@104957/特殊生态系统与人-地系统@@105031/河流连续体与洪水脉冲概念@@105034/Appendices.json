{"hands_on_practices": [{"introduction": "生态系统的代谢状态是其功能的核心指标，而产呼比（$P:R$）是衡量该状态的关键参数。本练习将引导您应用河流连续体概念（RCC）的核心原理，通过一个简化的数学模型，计算从上游源头到下游大河不同河段的 $P:R$ 值。通过这个实践，您将深入理解河流物理环境（如光照、深度）的纵向变化如何决定生态系统是自养型还是异养型。[@problem_id:2530525]", "problem": "一个河流网络由三个在地貌上显著不同的河段组成，这与河流连续体概念和洪水脉冲概念相符：一个上游源头（河段A）、一个中游河段（河段B）和一个大型下游河流（河段C）。您需要利用以下基本关系和生态学假设，从基本原理出发，为每个河段计算每日的生产-呼吸比率（$P\\!:\\!R$）：\n\n- 总初级生产力（GPP）与河床的底栖光照成正比，即 $GPP = \\alpha\\, I_{b}$，其中 $\\alpha$ 是一个光合效率参数。\n- 生态系统呼吸作用（ER）与代谢活跃生物量成正比，即 $ER = \\beta\\, M$，其中 $\\beta$ 将生物量转换为耗氧量。\n- 代谢活跃生物量 $M$ 与洪水脉冲强度 $h$（代表洪水脉冲补给有机质和微生物生境的能力）成线性关系，即 $M = \\gamma\\, h$，其中 $\\gamma$ 是一个比例常数。\n- 河床的底栖光照 $I_{b}$ 是穿过冠层和水体后到达河床的入射地表光合有效辐射，即 $I_{b} = f\\, I_{0}\\, \\exp(-\\kappa\\, z)$，其中 $f$ 是冠层开阔度分数，$I_{0}$ 是每日入射地表光照，$\\kappa$ 是垂直光衰减系数，$z$ 是平均深度。\n\n参数值如下：\n\n- 全局参数（所有河段共享）：$\\alpha = 0.18$，$\\beta = 0.15$，$\\gamma = 30$。\n- 河段A（上游源头）：$I_{0} = 45$, $f = 0.25$, $\\kappa = 1.5$, $z = 0.4$, $h = 0.2$。\n- 河段B（中游河段）：$I_{0} = 50$, $f = 0.70$, $\\kappa = 0.7$, $z = 1.2$, $h = 0.6$。\n- 河段C（大型下游河流）：$I_{0} = 55$, $f = 0.90$, $\\kappa = 2.0$, $z = 6.0$, $h = 1.5$。\n\n所有量均采用一致的每日面积单位，因此 $P\\!:\\!R$ 是无量纲的。\n\n任务：\n1) 从上述定义出发（不使用任何未提供的简化公式），推导出一个给定河段的 $P\\!:\\!R$ 关于 $\\alpha$、$\\beta$、$\\gamma$、$f$、$I_{0}$、$\\kappa$、$z$ 和 $h$ 的显式表达式。\n2) 使用所给参数，计算每个河段的 $P\\!:\\!R$ 值。\n3) 根据 $P\\!:\\!R$ 值，将每个河段分类为自养型（$P\\!:\\!R > 1$）或异养型（$P\\!:\\!R < 1$），并解释您的理由。\n\n答案规格：\n- 按照（河段A，河段B，河段C）的顺序，使用 $\\texttt{pmatrix}$ 格式将三个 $P\\!:\\!R$ 值以行向量的形式报告。\n- 将每个 $P\\!:\\!R$ 值四舍五入到三位有效数字。\n- $P\\!:\\!R$ 是无量纲的；只报告数字。", "solution": "在尝试任何解答之前，首先对问题陈述进行验证。\n\n步骤1：提取已知条件\n问题提供了以下关系和定义：\n- 总初级生产力：$GPP = \\alpha\\, I_{b}$\n- 生态系统呼吸作用：$ER = \\beta\\, M$\n- 代谢活跃生物量：$M = \\gamma\\, h$\n- 底栖光照强度：$I_{b} = f\\, I_{0}\\, \\exp(-\\kappa\\, z)$\n- 待求的比率是生产-呼吸比率，记为 $P\\!:\\!R$。它定义为 $GPP / ER$。\n\n问题提供了以下参数值：\n- 共享的全局参数：$\\alpha = 0.18$，$\\beta = 0.15$，$\\gamma = 30$。\n- 河段A（上游源头）：$I_{0} = 45$, $f = 0.25$, $\\kappa = 1.5$, $z = 0.4$, $h = 0.2$。\n- 河段B（中游河段）：$I_{0} = 50$, $f = 0.70$, $\\kappa = 0.7$, $z = 1.2$, $h = 0.6$。\n- 河段C（大型下游河流）：$I_{0} = 55$, $f = 0.90$, $\\kappa = 2.0$, $z = 6.0$, $h = 1.5$。\n所有量都声明为具有一致的单位，使得最终的 $P\\!:\\!R$ 比率无量纲。\n\n任务是：\n1. 推导 $P\\!:\\!R$ 的显式表达式。\n2. 计算三个河段中每一个的 $P\\!:\\!R$ 数值。\n3. 将每个河段分类为自养型（$P\\!:\\!R > 1$）或异养型（$P\\!:\\!R < 1$）。\n\n步骤2：验证\n对问题的有效性进行评估：\n- **科学依据：** 该问题基于水生生态学中简化但标准的模型。生产（依赖光照）和呼吸（依赖生物量）的关系是基础的。使用比尔-朗伯定律描述光衰减是正确的。该框架与河流连续体和洪水脉冲概念的核心原则一致。该问题在科学上是合理的。\n- **适定性：** 该问题提供了所有必要的方程、参数和明确的目标。方程组是确定性的，对每个河段都有唯一解。该问题是适定的。\n- **客观性：** 语言是定量的和精确的，没有主观或模棱两可的术语。\n- **完整性和一致性：** 提供了所有必需的数据，并且没有内部矛盾。\n\n步骤3：结论\n问题被认定为有效。将制定一个解答方案。\n\n解答过程首先推导生产-呼吸比率 $P\\!:\\!R$ 的通用公式，然后将其应用于每个河流河段的具体参数。\n\n任务1：推导 $P\\!:\\!R$ 表达式。\n生产-呼吸比率定义为总初级生产力（$GPP$）与生态系统呼吸作用（$ER$）之比。\n$$\nP\\!:\\!R = \\frac{GPP}{ER}\n$$\n问题提供了 $GPP$ 和 $ER$ 的表达式：\n$$\nGPP = \\alpha\\, I_{b}\n$$\n$$\nER = \\beta\\, M\n$$\n将这些代入 $P\\!:\\!R$ 的定义中，得到：\n$$\nP\\!:\\!R = \\frac{\\alpha\\, I_{b}}{\\beta\\, M}\n$$\n此外，问题提供了底栖光照 $I_{b}$ 和代谢活跃生物量 $M$ 的表达式：\n$$\nI_{b} = f\\, I_{0}\\, \\exp(-\\kappa\\, z)\n$$\n$$\nM = \\gamma\\, h\n$$\n将这些表达式代入 $P\\!:\\!R$ 的方程中，得到最终的显式公式：\n$$\nP\\!:\\!R = \\frac{\\alpha\\, (f\\, I_{0}\\, \\exp(-\\kappa\\, z))}{\\beta\\, (\\gamma\\, h)}\n$$\n这可以更清晰地写为：\n$$\nP\\!:\\!R = \\frac{\\alpha\\, f\\, I_{0}\\, \\exp(-\\kappa\\, z)}{\\beta\\, \\gamma\\, h}\n$$\n至此完成第一个任务。\n\n任务2：计算每个河段的 $P\\!:\\!R$ 值。\n现在使用推导出的公式和提供的参数，计算三个河段中每一个的 $P\\!:\\!R$ 比率。将进行所有计算，并按要求将最终结果四舍五入到三位有效数字。\n\n对于河段A（上游源头）：\n$I_{0} = 45$, $f = 0.25$, $\\kappa = 1.5$, $z = 0.4$, $h = 0.2$。\n全局参数为 $\\alpha = 0.18$，$\\beta = 0.15$，$\\gamma = 30$。\n$$\nP\\!:\\!R_{\\text{A}} = \\frac{0.18 \\times 0.25 \\times 45 \\times \\exp(-1.5 \\times 0.4)}{0.15 \\times 30 \\times 0.2} = \\frac{2.025 \\times \\exp(-0.6)}{0.9} = 2.25 \\times \\exp(-0.6)\n$$\n$$\nP\\!:\\!R_{\\text{A}} \\approx 2.25 \\times 0.5488116 \\approx 1.234826 \\approx 1.23\n$$\n\n对于河段B（中游河段）：\n$I_{0} = 50$, $f = 0.70$, $\\kappa = 0.7$, $z = 1.2$, $h = 0.6$。\n全局参数保持不变。\n$$\nP\\!:\\!R_{\\text{B}} = \\frac{0.18 \\times 0.70 \\times 50 \\times \\exp(-0.7 \\times 1.2)}{0.15 \\times 30 \\times 0.6} = \\frac{6.3 \\times \\exp(-0.84)}{2.7}\n$$\n$$\nP\\!:\\!R_{\\text{B}} \\approx 2.333... \\times 0.4317105 \\approx 1.0073245 \\approx 1.01\n$$\n\n对于河段C（大型下游河流）：\n$I_{0} = 55$, $f = 0.90$, $\\kappa = 2.0$, $z = 6.0$, $h = 1.5$。\n全局参数保持不变。\n$$\nP\\!:\\!R_{\\text{C}} = \\frac{0.18 \\times 0.90 \\times 55 \\times \\exp(-2.0 \\times 6.0)}{0.15 \\times 30 \\times 1.5} = \\frac{8.91 \\times \\exp(-12)}{6.75} = 1.32 \\times \\exp(-12)\n$$\n$$\nP\\!:\\!R_{\\text{C}} \\approx 1.32 \\times 6.14421 \\times 10^{-6} \\approx 8.11036 \\times 10^{-6}\n$$\n保留三位有效数字，结果为 $8.11 \\times 10^{-6}$。\n\n任务3：对每个河段进行分类。\n分类基于计算出的 $P\\!:\\!R$ 值。如果生产超过呼吸（$P\\!:\\!R > 1$），则系统为自养型；如果呼吸超过生产（$P\\!:\\!R < 1$），则系统为异养型。\n\n- **河段A：** $P\\!:\\!R_{\\text{A}} \\approx 1.23$。由于 $1.23 > 1$，该河段被分类为**自养型**。在此模型中，较低的洪水脉冲强度（$h=0.2$）限制了用于呼吸作用的生物量，而尽管有冠层遮蔽，仍有足够的光线穿透水体，使得生产能够超过呼吸。\n\n- **河段B：** $P\\!:\\!R_{\\text{B}} \\approx 1.01$。由于 $1.01 > 1$，该河段也被分类为**自养型**。这与河流连续体概念一致，其中河道较宽、冠层覆盖较少的中游河段通常表现出最高的初级生产率。\n\n- **河段C：** $P\\!:\\!R_{\\text{C}} \\approx 8.11 \\times 10^{-6}$。由于 $8.11 \\times 10^{-6} \\ll 1$，该河段被分类为强**异养型**。由于深度大（$z=6.0$）和浊度高（$\\kappa=2.0$）导致的极端光照限制，几乎消除了初级生产（$\\exp(-12)$ 是一个极小的因子）。同时，高洪水脉冲补给（$h=1.5$）支持了大量的呼吸生物量，导致系统中的呼吸作用远超生产。这与对大型、深水、浑浊的下游河流的预期相符。\n\n因此，三个河段的 $P\\!:\\!R$ 比率的最终数值答案是 $1.23$、$1.01$ 和 $8.11 \\times 10^{-6}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.23 & 1.01 & 8.11 \\times 10^{-6}\n\\end{pmatrix}\n}\n$$", "id": "2530525"}, {"introduction": "河流不仅是水的通道，也是生物地球化学反应的热点区域，其对营养盐的加工和去除能力至关重要。本练习将带您进入营养物螺旋理论的实践应用，通过分析一个模拟的营养物添加实验数据，来计算关键的营养盐吸收指标，如吸收长度（$S_w$）和吸收速率（$U$）。这项练习能让您掌握量化河流生态系统服务功能的核心方法，并理解水流和生物过程如何共同调控养分动态。[@problem_id:2530554]", "problem": "一条正在经历中度漫滩事件的沙床低地河流，既体现了河流连续体概念（River Continuum Concept）所强调的纵向过程，也体现了洪水脉冲概念（Flood Pulse Concept）所强调的侧向交换。在一个具有均匀流和几何形状的完全混合主干河段，假设条件稳定，在河段尺度上纵向弥散相对于平流可忽略不计，并且溶解性硝酸盐通过横截面平均的一级过程被河床和洪泛区汇去除。在洪水脉冲的上涨阶段，进行了一次短时恒率的营养物添加实验，并同时使用了一种保守性示踪剂。利用该示踪剂对反应性硝酸盐信号进行稀释校正，以获得有效的反应物浓度信号。现场测量得到以下数据：\n\n- 平均顺流速度：$u = 0.25$ m s$^{-1}$。\n- 平均水深：$h = 0.35$ m。\n- 环境硝酸盐浓度（背景值，添加前）：$C = 0.25$ mg N L$^{-1}$。\n- 在所分析河段的上游端（$x = 0$），经示踪剂校正的硝酸盐添加浓度：$\\tilde{C}(0) = 0.10$ mg N L$^{-1}$。\n- 在 $x = 800$ m 处，经示踪剂校正的硝酸盐添加浓度：$\\tilde{C}(800) = 0.040$ mg N L$^{-1}$。\n\n从一个具有平流输运和向边界的垂向平均一级去除的微分长度控制体积的质量守恒出发，推导经示踪剂校正的反应性溶质浓度的指数空间衰减规律，以及摄取长度 $S_w$、摄取速度 $v_f$ 和面积摄取速率 $U$ 的定义。然后，利用上述数据：\n\n1. 根据 $\\tilde{C}(x)$ 的下游指数衰减计算摄取长度 $S_w$。\n2. 使用 $u$、$h$ 和 $S_w$ 计算摄取速度 $v_f$。\n3. 使用 $v_f$ 和环境浓度 $C$ 计算环境硝酸盐的面积摄取速率 $U$。\n\n将 $S_w$ 以米（m）表示，$v_f$ 以 m s$^{-1}$ 表示，$U$ 以 mg m$^{-2}$ s$^{-1}$ 表示。将 $S_w$、$v_f$ 和 $U$ 的计算结果各自保留四位有效数字。", "solution": "我们从质量守恒定律开始，将其应用于一个一维、稳定、横截面平均的控制体积，其微分长度为 $\\mathrm{d}x$，宽度为 $w$。令 $C(x)$ 表示水体中垂向平均的溶解性硝酸盐浓度。横截面积为 $A = w h$。在稳定条件下，且在河段尺度上纵向弥散相对于平流可忽略不计，控制体积中溶质质量的净平流变化与向河床和侧向（洪泛区和潜流区）汇的面积摄取相平衡：\n$$u A \\frac{\\mathrm{d}C}{\\mathrm{d}x} \\,\\mathrm{d}x \\;=\\; -\\,w\\,\\mathrm{d}x\\,U(C),$$\n其中 $U(C)$ 是面积摄取通量（单位面积单位时间的质量）。消去 $w\\,\\mathrm{d}x$ 并代入 $A = w h$，得到基本关系式：\n$$u h \\frac{\\mathrm{d}C}{\\mathrm{d}x} \\;=\\; -\\,U(C).$$\n\n在混合条件下，一个经过充分检验的生物地球化学硝酸盐去除模型是相对于浓度 $C$ 的一级反应，其面积通量形式表示为：\n$$U(C) \\;=\\; v_f\\, C,$$\n其中 $v_f$ 是摄取速度（单位时间的长度）。将此式代入质量平衡方程，得到：\n$$u h \\frac{\\mathrm{d}C}{\\mathrm{d}x} \\;=\\; -\\,v_f\\, C.$$\n整理得：\n$$\\frac{\\mathrm{d}C}{\\mathrm{d}x} \\;=\\; -\\,\\frac{v_f}{u h}\\, C.$$\n求解这个线性常微分方程，得到指数空间衰减规律：\n$$C(x) \\;=\\; C(0)\\,\\exp\\!\\left(-\\frac{v_f}{u h}\\, x\\right).$$\n\n根据营养盐螺旋理论的定义，摄取长度 $S_w$ 是此衰减的特征 e-折距离。与标准形式 $C(x) = C(0)\\exp\\!\\left(-x/S_w\\right)$ 进行比较，可确定：\n$$S_w \\;=\\; \\frac{u h}{v_f}.$$\n等价地，$v_f = \\frac{u h}{S_w}$。面积摄取速率则直接由其定义得出：\n$$U \\;=\\; v_f\\, C.$$\n\n在与保守性示踪剂配对的营养物添加实验中，反应性溶质信号通过示踪剂进行稀释校正，得到一个经示踪剂校正的浓度 $\\tilde{C}(x)$。该浓度遵循与上述 $C(x)$ 相同的随距离指数衰减的规律。因此，$S_w$ 可以通过下游两点的 $\\tilde{C}(x)$ 测量值来估算：\n$$\\tilde{C}(x) \\;=\\; \\tilde{C}(0)\\,\\exp\\!\\left(-\\frac{x}{S_w}\\right)\\;\\;\\Rightarrow\\;\\; \\ln\\!\\left(\\frac{\\tilde{C}(x)}{\\tilde{C}(0)}\\right) \\;=\\; -\\,\\frac{x}{S_w}.$$\n从距离为 $0$ 和 $L$ 的一对点求解 $S_w$：\n$$S_w \\;=\\; -\\,\\frac{L}{\\ln\\!\\left(\\frac{\\tilde{C}(L)}{\\tilde{C}(0)}\\right)}.$$\n\n现在进行数值计算。\n\n1. 根据 $x=0$ 和 $x=L$ 之间观测到的衰减计算摄取长度 $S_w$，其中 $L = 800$ m，$\\tilde{C}(0) = 0.10$ mg N L$^{-1}$，$\\tilde{C}(800) = 0.040$ mg N L$^{-1}$：\n$$S_w \\;=\\; -\\,\\frac{800}{\\ln\\!\\left(\\frac{0.040}{0.10}\\right)} \\;=\\; -\\,\\frac{800}{\\ln(0.4)}.$$\n计算对数：\n$$\\ln(0.4) \\;=\\; -0.9162907319\\ldots,$$\n所以\n$$S_w \\;\\approx\\; \\frac{800}{0.9162907319} \\;\\approx\\; 873.085\\ \\text{m}.$$\n\n保留四位有效数字，$S_w \\approx 873.1$ m。\n\n2. 根据 $v_f = \\frac{u h}{S_w}$ 计算摄取速度 $v_f$，其中 $u = 0.25$ m s$^{-1}$，$h = 0.35$ m，$S_w \\approx 873.085$ m：\n$$v_f \\;=\\; \\frac{0.25 \\times 0.35}{873.085} \\;=\\; \\frac{0.0875}{873.085}\\ \\text{m s}^{-1} \\;\\approx\\; 1.002 \\times 10^{-4}\\ \\text{m s}^{-1}.$$\n\n保留四位有效数字，$v_f \\approx 1.002 \\times 10^{-4}$ m s$^{-1}$。\n\n3. 使用环境浓度 $C = 0.25$ mg N L$^{-1}$ 计算面积摄取速率 $U = v_f C$。使用 $1$ L $= 10^{-3}$ m$^{3}$ 将 $C$ 的单位转换为 mg m$^{-3}$，因此 $1$ mg L$^{-1} = 1000$ mg m$^{-3}$。于是\n$$C \\;=\\; 0.25 \\times 1000 \\;=\\; 250\\ \\text{mg m}^{-3}.$$\n则\n$$U \\;=\\; \\left(1.002 \\times 10^{-4}\\ \\text{m s}^{-1}\\right)\\times \\left(250\\ \\text{mg m}^{-3}\\right) \\;=\\; 2.505 \\times 10^{-2}\\ \\text{mg m}^{-2}\\ \\text{s}^{-1}.$$\n\n保留四位有效数字，$U \\approx 2.505 \\times 10^{-2}$ mg m$^{-2}$ s$^{-1}$。\n\n汇总所要求的量，使用指定单位并保留四位有效数字：\n- $S_w$：$873.1$ m，\n- $v_f$：$1.002 \\times 10^{-4}$ m s$^{-1}$，\n- $U$：$2.505 \\times 10^{-2}$ mg m$^{-2}$ s$^{-1}$。", "answer": "$$\\boxed{\\begin{pmatrix}873.1 & 1.002\\times 10^{-4} & 2.505\\times 10^{-2}\\end{pmatrix}}$$", "id": "2530554"}, {"introduction": "洪水脉冲概念（FPC）强调了河流与洪泛平原之间横向连接的重要性，特别是对于食物网的物质支持。本练习将向您展示如何使用稳定同位素（如 $\\delta^{13}\\mathrm{C}$ 和 $\\delta^{15}\\mathrm{N}$）这一强大工具，来解析消费者食物来源的构成。您将建立一个双源混合模型，以定量估算洪泛平原初级生产对鱼类消费者的贡献比例，从而将水文过程、资源有效性和营养生态学紧密联系起来。[@problem_id:2530551]", "problem": "对一个经历季节性淹没的泛滥平原河流系统进行建模，以量化洪水脉冲概念 (Flood Pulse Concept, FPC) 和河流连续体概念 (River Continuum Concept, RCC) 如何影响鱼类的碳源。给定碳和氮的稳定同位素比率，以千分之（‰）的 delta 标记法表示，涉及三个区室：泛滥平原附生生物、陆源碎屑和一种鱼类消费者。假设该鱼类摄食源自这两种来源的混合食物。使用一个双源、双同位素的营养质量平衡模型来估算鱼组织中源自泛滥平原的碳的比例。\n\n使用的基本原理：\n- 混合食性中同位素的质量守恒：消费者的同位素组成反映了其食物来源的加权平均值，外加系统的营养富集（也称为营养级分馏）。\n- 对于食物网的某个层级内的特定同位素，每个营养级的营养富集因子近似恒定，并且每次营养转移时线性累加。\n- 洪水脉冲概念 (FPC) 假设，在淹没期间，泛滥平原的连通性增加了泛滥平原初级生产（例如附生生物）在食物网中的作用；而河流连续体概念 (RCC) 则强调自源性和异源性的纵向梯度。这些概念为来源选择和解释提供了动因，但不会改变质量平衡的数学形式。\n\n定义和设置：\n- 设鱼类消费者的同位素值为 $\\delta^{13}\\mathrm{C}_{\\mathrm{fish}}$ 和 $\\delta^{15}\\mathrm{N}_{\\mathrm{fish}}$。\n- 设泛滥平原附生生物的同位素值为 $\\delta^{13}\\mathrm{C}_{\\mathrm{peri}}$ 和 $\\delta^{15}\\mathrm{N}_{\\mathrm{peri}}$。\n- 设陆源碎屑的同位素值为 $\\delta^{13}\\mathrm{C}_{\\mathrm{terr}}$ 和 $\\delta^{15}\\mathrm{N}_{\\mathrm{terr}}$。\n- 设碳的营养富集因子为 $\\Delta_{\\mathrm{C}}$（千分之/每营养级），氮的为 $\\Delta_{\\mathrm{N}}$（千分之/每营养级）。\n- 设 $f$ 为鱼类食物中源自泛滥平原的碳的比例（无单位，限制在 $0 \\le f \\le 1$）。\n- 设 $\\mathrm{TL}$ 为鱼的营养级，初级生产者位于 $\\mathrm{TL} = 1$。\n\n你的任务：\n- 仅从质量平衡和营养富集原理出发，推导一个方程组，该方程组允许同时使用 $\\delta^{13}\\mathrm{C}$ 和 $\\delta^{15}\\mathrm{N}$ 求解 $f$，假设营养富集在 $\\mathrm{TL} - 1$ 次营养转移中线性累加，且食物来源为线性混合。\n- 将此解决方案实现为一个程序，为下面定义的每个测试用例计算 $f$。\n- 将最终的 $f$ 约束在闭区间 $\\left[0,1\\right]$ 内，以确保物理合理性。\n- 将 $f$ 报告为小数形式，四舍五入到三位小数。不要使用百分号。\n\n单位：\n- 所有同位素输入值和营养富集因子均以千分之（‰）为单位。\n- 输出 $f$ 是无单位的，必须以小数形式报告。\n\n角度单位：\n- 不适用。\n\n测试套件：\n每个测试用例是一个元组，形式为 $(\\delta^{13}\\mathrm{C}_{\\mathrm{fish}}, \\delta^{15}\\mathrm{N}_{\\mathrm{fish}}, \\delta^{13}\\mathrm{C}_{\\mathrm{peri}}, \\delta^{15}\\mathrm{N}_{\\mathrm{peri}}, \\delta^{13}\\mathrm{C}_{\\mathrm{terr}}, \\delta^{15}\\mathrm{N}_{\\mathrm{terr}}, \\Delta_{\\mathrm{C}}, \\Delta_{\\mathrm{N}})$，所有同位素和富集值均以千分之为单位。\n\n使用以下五个测试用例：\n1. $(-22.5, 8.6, -20.0, 5.0, -28.0, 2.0, 1.0, 3.4)$\n2. $(-20.5, 7.0, -20.0, 5.0, -28.0, 2.0, 1.0, 3.4)$\n3. $(-27.0, 6.3, -20.0, 5.0, -28.0, 2.0, 1.0, 3.4)$\n4. $(-18.0, 10.0, -20.0, 5.0, -28.0, 2.0, 1.0, 3.4)$\n5. $(-25.0, 7.5, -23.0, 4.0, -30.0, 1.0, 0.4, 3.0)$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含五个 $f$ 值，按顺序排列，四舍五入到三位小数，作为一个逗号分隔的列表，并用方括号括起来。例如：“[0.123,0.456,0.789,0.012,0.345]”。", "solution": "问题陈述经评估后被确定为有效。它在科学上基于稳定同位素生态学的既定原理，并且在数学上是适定的，构成了一个可解的线性方程组。\n\n该解决方案源于营养系统中稳定同位素的质量守恒原理。消费者（鱼类）的同位素特征是其食物来源特征的线性混合，并经过营养富集校正。问题要求同时使用两种同位素 $\\delta^{13}\\mathrm{C}$ 和 $\\delta^{15}\\mathrm{N}$ 来求解食物比例 $f$。这是通过构建一个也考虑了未知营养级的方程组来实现的。\n\n设 $f$ 为鱼类食物中源自泛滥平原附生生物的无单位比例。因此，源自陆源碎屑的比例是 $(1-f)$。这些来源是营养级为 $\\mathrm{TL}=1$ 的初级生产者。设鱼类消费者处于一个未知的营养级 $\\mathrm{TL}$。从初级生产者到鱼类的营养转移次数为 $T = \\mathrm{TL} - 1$。每种同位素的总同位素富集是单位营养级富集因子与转移次数的乘积，即碳为 $T \\cdot \\Delta_{\\mathrm{C}}$，氮为 $T \\cdot \\Delta_{\\mathrm{N}}$。\n\n每种同位素的质量平衡关系为：\n$$ \\delta_{\\text{consumer}} = \\delta_{\\text{diet}} + \\text{total enrichment} $$\n食物的特征值 $\\delta_{\\text{diet}}$ 是各来源的加权平均值：\n$$ \\delta_{\\text{diet}} = f \\cdot \\delta_{\\text{source 1}} + (1-f) \\cdot \\delta_{\\text{source 2}} $$\n将此应用于我们特定的系统，针对碳和氮两种同位素，得到两个方程：\n$$ \\delta^{13}\\mathrm{C}_{\\mathrm{fish}} = \\left( f \\cdot \\delta^{13}\\mathrm{C}_{\\mathrm{peri}} + (1-f) \\cdot \\delta^{13}\\mathrm{C}_{\\mathrm{terr}} \\right) + T \\cdot \\Delta_{\\mathrm{C}} $$\n$$ \\delta^{15}\\mathrm{N}_{\\mathrm{fish}} = \\left( f \\cdot \\delta^{15}\\mathrm{N}_{\\mathrm{peri}} + (1-f) \\cdot \\delta^{15}\\mathrm{N}_{\\mathrm{terr}} \\right) + T \\cdot \\Delta_{\\mathrm{N}} $$\n这两个方程包含两个未知数，$f$ 和 $T$。为了求解它们，我们重新排列方程，将包含未知数的项分离到一边。\n对于碳同位素：\n$$ f \\cdot \\delta^{13}\\mathrm{C}_{\\mathrm{peri}} + \\delta^{13}\\mathrm{C}_{\\mathrm{terr}} - f \\cdot \\delta^{13}\\mathrm{C}_{\\mathrm{terr}} + T \\cdot \\Delta_{\\mathrm{C}} = \\delta^{13}\\mathrm{C}_{\\mathrm{fish}} $$\n$$ f \\cdot (\\delta^{13}\\mathrm{C}_{\\mathrm{peri}} - \\delta^{13}\\mathrm{C}_{\\mathrm{terr}}) + T \\cdot \\Delta_{\\mathrm{C}} = \\delta^{13}\\mathrm{C}_{\\mathrm{fish}} - \\delta^{13}\\mathrm{C}_{\\mathrm{terr}} $$\n对于氮同位素：\n$$ f \\cdot \\delta^{15}\\mathrm{N}_{\\mathrm{peri}} + \\delta^{15}\\mathrm{N}_{\\mathrm{terr}} - f \\cdot \\delta^{15}\\mathrm{N}_{\\mathrm{terr}} + T \\cdot \\Delta_{\\mathrm{N}} = \\delta^{15}\\mathrm{N}_{\\mathrm{fish}} $$\n$$ f \\cdot (\\delta^{15}\\mathrm{N}_{\\mathrm{peri}} - \\delta^{15}\\mathrm{N}_{\\mathrm{terr}}) + T \\cdot \\Delta_{\\mathrm{N}} = \\delta^{15}\\mathrm{N}_{\\mathrm{fish}} - \\delta^{15}\\mathrm{N}_{\\mathrm{terr}} $$\n这是一个关于变量 $f$ 和 $T$ 的标准二元线性方程组。我们可以将其表示为矩阵形式 $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{x} = [f, T]^\\top$：\n$$\n\\begin{pmatrix}\n(\\delta^{13}\\mathrm{C}_{\\mathrm{peri}} - \\delta^{13}\\mathrm{C}_{\\mathrm{terr}}) & \\Delta_{\\mathrm{C}} \\\\\n(\\delta^{15}\\mathrm{N}_{\\mathrm{peri}} - \\delta^{15}\\mathrm{N}_{\\mathrm{terr}}) & \\Delta_{\\mathrm{N}}\n\\end{pmatrix}\n\\begin{pmatrix}\nf \\\\\nT\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n(\\delta^{13}\\mathrm{C}_{\\mathrm{fish}} - \\delta^{13}\\mathrm{C}_{\\mathrm{terr}}) \\\\\n(\\delta^{15}\\mathrm{N}_{\\mathrm{fish}} - \\delta^{15}\\mathrm{N}_{\\mathrm{terr}})\n\\end{pmatrix}\n$$\n解此方程组可得到向量 $\\mathbf{x}$ 的唯一解，前提是系数矩阵 $\\mathbf{A}$ 是非奇异的（即其行列式不为零）。解向量的第一个元素就是我们所求的比例 $f$。\n\n物理约束要求 $f$ 必须表示一个比例，这意味着计算出的值必须被限制在闭区间 $[0, 1]$ 内。$f < 0$ 或 $f > 1$ 的值在物理上是无意义的，表明消费者的同位素特征位于由食物来源定义的、并经过营养富集校正的混合多边形之外。这种情况可能是由测量误差、未计入的食物来源，或来源或营养富集因子值的时空变化引起的。根据问题的要求，计算出的 $f$ 的解被裁剪以强制执行此约束。最终的实现将为每个测试用例求解这个线性方程组，将得到的 $f$ 裁剪到 $[0, 1]$ 范围内，并按规定格式化输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the fraction of floodplain-derived carbon in a fish's diet\n    using a two-source, two-isotope mass-balance model.\n    \"\"\"\n    \n    # Each test case is a tuple of the form:\n    # (d13C_fish, d15N_fish, d13C_peri, d15N_peri, d13C_terr, d15N_terr, Delta_C, Delta_N)\n    test_cases = [\n        (-22.5, 8.6, -20.0, 5.0, -28.0, 2.0, 1.0, 3.4),\n        (-20.5, 7.0, -20.0, 5.0, -28.0, 2.0, 1.0, 3.4),\n        (-27.0, 6.3, -20.0, 5.0, -28.0, 2.0, 1.0, 3.4),\n        (-18.0, 10.0, -20.0, 5.0, -28.0, 2.0, 1.0, 3.4),\n        (-25.0, 7.5, -23.0, 4.0, -30.0, 1.0, 0.4, 3.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack the parameters for the current test case\n        d13C_fish, d15N_fish, d13C_peri, d15N_peri, d13C_terr, d15N_terr, Delta_C, Delta_N = case\n\n        # Set up the system of linear equations A*x = b, where x = [f, T]\n        # f is the fraction of periphyton, T is the number of trophic transfers.\n\n        # Construct the coefficient matrix A\n        # A[0,0] = d13C_peri - d13C_terr\n        # A[0,1] = Delta_C\n        # A[1,0] = d15N_peri - d15N_terr\n        # A[1,1] = Delta_N\n        A = np.array([\n            [d13C_peri - d13C_terr, Delta_C],\n            [d15N_peri - d15N_terr, Delta_N]\n        ])\n\n        # Construct the constant vector b\n        # b[0] = d13C_fish - d13C_terr\n        # b[1] = d15N_fish - d15N_terr\n        b = np.array([\n            d13C_fish - d13C_terr,\n            d15N_fish - d15N_terr\n        ])\n\n        # Solve the system of equations for x = [f, T]\n        # A check for singularity could be added, but the test data is well-behaved.\n        # det_A = np.linalg.det(A)\n        # if np.isclose(det_A, 0):\n        #     # Handle singular matrix case if necessary\n        #     # For this problem, we assume valid, non-singular systems.\n        #     continue\n        \n        try:\n            solution = np.linalg.solve(A, b)\n            f_raw = solution[0]\n        except np.linalg.LinAlgError:\n            # This case occurs if the matrix A is singular.\n            # In an ecological context, this means the sources and trophic enrichment vectors\n            # are collinear in isotope space, making the problem indeterminate.\n            # We will assign NaN and handle it, although not expected for this problem set.\n            f_raw = np.nan\n\n        # Constrain f to the physically plausible interval [0, 1]\n        f_constrained = np.clip(f_raw, 0.0, 1.0)\n\n        # Format the result to three decimal places and add to the list\n        results.append(f\"{f_constrained:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2530551"}]}