{"hands_on_practices": [{"introduction": "为何有些外来物种即使在适宜的新环境中也无法成功立足？本练习引入了强阿利效应（strong Allee effect）的概念，在这种效应下，低密度种群的增长率会受到抑制。通过分析这一经典模型 [@problem_id:2473492]，您将掌握“阿利阈值”（Allee threshold）的关键概念，即种群生存和建群所需的最小密度。这不仅是入侵生物学的基本原则，在濒危物种的保护和恢复工作中也同样至关重要。", "problem": "一个外来物种被引入到一个新的栖息地，在低密度下，其寻找配偶和合作行为产生了强烈的阿利效应（Allee effect）。设其种群密度由以下常微分方程（ODE）建模：\n$$\n\\dot{N} \\equiv \\frac{dN}{dt} = r\\,N\\left(1-\\frac{N}{K}\\right)\\left(\\frac{N}{A}-1\\right),\n$$\n其中参数满足 $r>0$，$K>A>0$，$r$ 是内禀增长率，$K$ 是环境承载力，$A$ 是阿利阈值密度。假设对所有 $t\\ge 0$ 都有 $N(t)\\ge 0$，且 $N(0)=N_{0}$。\n\n仅使用常微分方程平衡点的基本定义（$\\dot{N}=0$）以及由方程右侧关于 $N$ 在各平衡点处的导数符号决定的局部稳定性，完成以下任务：\n\n- 识别所有平衡点，并通过在各平衡点附近对常微分方程进行线性化来确定其局部稳定性。\n- 从第一性原理出发，推导出区分种群走向灭绝与成功建立并收敛至承载力的轨迹的入侵判据。\n- 以模型参数 $r$、$K$ 和 $A$ 的单个闭式表达式的形式，报告保证种群成功建立而非灭绝的最小初始密度 $N_{\\mathrm{crit}}$。\n\n最终的 $N_{\\mathrm{crit}}$ 以“个体/公顷”为单位表示。无需进行数值计算，最终报告的表达式中不应出现不等式。", "solution": "该问题要求分析一个具有强阿利效应的、描述种群密度 $N(t)$ 的常微分方程（ODE）。该模型由下式给出：\n$$\n\\frac{dN}{dt} = r\\,N\\left(1-\\frac{N}{K}\\right)\\left(\\frac{N}{A}-1\\right)\n$$\n其中，对所有 $t \\ge 0$ 都有 $N(t) \\ge 0$，参数满足 $r>0$ 和 $K>A>0$。\n\n首先，我们必须验证问题陈述的有效性。\n**步骤1：提取已知条件**\n-   控制方程为 $\\frac{dN}{dt} = r\\,N\\left(1-\\frac{N}{K}\\right)\\left(\\frac{N}{A}-1\\right)$。\n-   参数为内禀增长率 $r>0$、承载力 $K$ 和阿利阈值 $A$。它们受约束 $K>A>0$。\n-   初始条件为 $N(0)=N_0$，且种群密度为非负值，$N(t) \\ge 0$。\n-   任务是找到所有平衡点，通过线性化确定其局部稳定性，推导种群建立的判据，并找到实现该建立的最小初始密度 $N_{\\mathrm{crit}}$。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：** 该模型是描述受强阿利效应影响的种群动态的标准且成熟的表示方法，它将逻辑斯谛增长与一个阈值项相结合。它是理论生态学中的一个基本模型。该问题在科学上是合理的。\n-   **适定性：** 该问题是一个一阶自治常微分方程的适定初值问题。方程右侧是一个多项式，保证了解的存在性和唯一性。问题表述清晰，旨在寻求一个可通过数学推导得出的结果。\n-   **客观性与完备性：** 该问题以精确的数学术语陈述，没有主观性。所有必要的参数和约束（$r, K, A$ 以及 $K>A>0$）都已提供，足以进行所要求的分析。提及‘个体/公顷’只是指定了密度变量 $N$ 及其相关参数 $A$ 和 $K$ 的物理单位，这是自洽的，并未引入任何缺陷。\n\n**步骤3：结论与行动**\n该问题是有效的。它是一维动力学系统稳定性分析的一个标准练习。我们开始求解。\n\n设常微分方程的右侧为 $f(N)$：\n$$\nf(N) = r\\,N\\left(1-\\frac{N}{K}\\right)\\left(\\frac{N}{A}-1\\right)\n$$\n根据问题的指示，我们必须首先识别平衡点，然后确定其稳定性。\n\n**平衡点的识别**\n平衡点，记为 $N^*$，是使种群密度变化率为零的 $N$ 值。这由条件 $\\frac{dN}{dt} = f(N^*) = 0$ 定义：\n$$\nr\\,N^*\\left(1-\\frac{N^*}{K}\\right)\\left(\\frac{N^*}{A}-1\\right) = 0\n$$\n由于 $r > 0$，解可以通过将每个包含 $N^*$ 的因子设为零来找到：\n1. $N^* = 0$\n2. $1 - \\frac{N^*}{K} = 0 \\implies N^* = K$\n3. $\\frac{N^*}{A} - 1 = 0 \\implies N^* = A$\n因此，该系统有三个平衡点：$N_1^* = 0$，$N_2^* = A$ 和 $N_3^* = K$。\n\n**通过线性化进行稳定性分析**\n为了确定每个平衡点的局部稳定性，我们必须计算 $f(N)$ 关于 $N$ 的导数，即该一维系统的雅可比矩阵。\n$$\nf(N) = \\frac{r}{AK}N(K-N)(N-A) = \\frac{r}{AK}(-N^3 + (A+K)N^2 - AKN)\n$$\n导数 $f'(N) = \\frac{df}{dN}$ 为：\n$$\nf'(N) = \\frac{r}{AK}(-3N^2 + 2(A+K)N - AK)\n$$\n平衡点 $N^*$ 的稳定性由 $f'(N^*)$ 的符号决定：\n-   如果 $f'(N^*) < 0$，该平衡点是局部稳定的。\n-   如果 $f'(N^*) > 0$，该平衡点是局部不稳定的。\n\n我们在三个平衡点处分别计算 $f'(N^*)$ 的值。\n\n1. **在 $N_1^* = 0$ 处的平衡点：**\n$$\nf'(0) = \\frac{r}{AK}(-3(0)^2 + 2(A+K)(0) - AK) = \\frac{r}{AK}(-AK) = -r\n$$\n由于 $r > 0$，我们有 $f'(0) < 0$。因此，平衡点 $N^* = 0$ 是**稳定的**。这代表种群灭绝。\n\n2. **在 $N_2^* = A$ 处的平衡点：**\n$$\nf'(A) = \\frac{r}{AK}(-3A^2 + 2(A+K)A - AK) = \\frac{r}{AK}(-3A^2 + 2A^2 + 2AK - AK)\n$$\n$$\nf'(A) = \\frac{r}{AK}(-A^2 + AK) = \\frac{r}{AK}A(K-A) = \\frac{r}{K}(K-A)\n$$\n在约束条件 $K > A > 0$ 和 $r>0$ 下，项 $(K-A)$ 是正的。因此，$f'(A) > 0$。平衡点 $N^* = A$ 是**不稳定的**。这就是阿利阈值。\n\n3. **在 $N_3^* = K$ 处的平衡点：**\n$$\nf'(K) = \\frac{r}{AK}(-3K^2 + 2(A+K)K - AK) = \\frac{r}{AK}(-3K^2 + 2K^2 + 2AK - AK)\n$$\n$$\nf'(K) = \\frac{r}{AK}(-K^2 + AK) = \\frac{r}{AK}K(A-K) = \\frac{r}{A}(A-K)\n$$\n在 $K > A > 0$ 和 $r>0$ 的条件下，项 $(A-K)$ 是负的。因此，$f'(K) < 0$。平衡点 $N^* = K$ 是**稳定的**。这代表种群在承载力处成功建立。\n\n**入侵判据与临界密度 $N_{\\mathrm{crit}}$**\n稳定性分析揭示了相线 $N \\ge 0$ 上的动力学行为。该系统有两个稳定平衡点，分别位于 $N=0$（灭绝）和 $N=K$（建立），它们被位于 $N=A$ 的一个不稳定平衡点分开。这个不稳定平衡点充当分界线（separatrix），将状态空间划分为两个吸引盆。\n-   对于初始种群密度 $N_0$ 满足 $0 \\le N_0 < A$ 的情况，种群轨迹将收敛到位于 $N=0$ 的稳定平衡点。这导致种群灭绝。\n-   对于初始种群密度 $N_0$ 满足 $N_0 > A$ 的情况，种群轨迹将收敛到位于 $N=K$ 的稳定平衡点。这构成了种群的成功建立。\n-   如果 $N_0 = A$，种群将停留在不稳定的平衡点上，但任何无穷小的扰动都会将其推向 $0$ 或 $K$。\n\n问题要求保证种群建立的最小初始密度 $N_{\\mathrm{crit}}$。“建立”被定义为收敛到承载力 $K$。这种情况发生当且仅当初始密度 $N_0$ 大于阿利阈值 $A$。该阈值本身是必须跨越的边界。因此，临界密度就是不稳定平衡点的值。\n$$\nN_{\\mathrm{crit}} = A\n$$\n这是最小密度阈值；任何超过此值的初始种群密度都将导致成功建立。该表达式已按要求用模型参数表示。", "answer": "$$\n\\boxed{A}\n$$", "id": "2473492"}, {"introduction": "一个物种成功建立后，它如何在破碎化的景观中扩散？本练习将指导您从基本原理出发，推导空间生态学中最基础的模型之一——集合种群模型（metapopulation model）。这个练习 [@problem_id:2473480] 将锻炼您将生物过程（斑块网络中的定殖与灭绝）转化为数学模型（一个常微分方程）的能力。您将亲自推导出入侵物种在整个景观中扩散并持续存在的临界条件，即定殖率 $c$ 与灭绝率 $e$ 之间的关系。", "problem": "考虑一个入侵物种在一个数量极大（$N$）的相同生境斑块中扩散。在任意时刻 $t$，令 $X_{i}(t) \\in \\{0,1\\}$ 表示斑块 $i$ 是否被占据（$X_{i}(t)=1$）或为空（$X_{i}(t)=0$），并定义被占据斑块的比例为 $p_{N}(t) \\equiv \\frac{1}{N}\\sum_{i=1}^{N} X_{i}(t)$。假设存在以下具有生物学基础的机制和极限：\n- 每个被占据的斑块以每个斑块 $c>0$ 的速率独立地产生定殖尝试。一次定殖尝试会从其他 $N-1$ 个斑块中均匀随机地选择一个目标斑块，如果目标斑块为空，则定殖瞬间成功。\n- 每个被占据的斑块以每个斑块 $e>0$ 的速率独立地灭绝，之后变为空斑块。\n- 斑块均匀混合，在极限 $N \\to \\infty$ 下，随机占据过程集中在一条确定的轨道上，该轨道描述了占据比例 $p(t) \\equiv \\lim_{N\\to\\infty} p_{N}(t)$。\n\n从这些假设以及连续时间马尔可夫过程的转移速率定义，结合密度依赖过程的大数定律极限出发，通过平衡单位时间内的预期定殖和灭绝事件速率，推导一个关于 $p(t)$ 的闭式平均场常微分方程（ODE）。使用您推导出的ODE：\n- 识别所有平衡占据率及其可行性。\n- 使用关于 $p=0$ 的线性化，陈述确定入侵物种何时能从稀有状态开始增长的入侵准则。\n- 当满足入侵准则时，确定哪个平衡点是局部稳定的。\n\n答案规格：最终答案仅提供非零平衡占据率，以一个关于 $c$ 和 $e$ 的闭式解析表达式表示。最终答案中不要包含任何文字、不等式或单位。不要进行四舍五入；提供精确表达式。", "solution": "首先对问题陈述进行严格验证，以确定其科学和逻辑的完整性。\n\n**步骤1：提取已知条件**\n- 系统由 $N$ 个相同的生境斑块组成，其中 $N$ 非常大。\n- 斑块 $i$ 的状态为 $X_{i}(t) \\in \\{0, 1\\}$，其中 $1$ 表示被占据， $0$ 表示为空。\n- 被占据斑块的比例为 $p_{N}(t) = \\frac{1}{N}\\sum_{i=1}^{N} X_{i}(t)$。\n- 在极限 $N \\to \\infty$ 下，该比例收敛到一条确定的轨道 $p(t) = \\lim_{N\\to\\infty} p_{N}(t)$。\n- 每个被占据的斑块以每个斑块 $c > 0$ 的速率产生定殖尝试。\n- 一次定殖尝试会从其他 $N-1$ 个斑块中均匀随机地选择一个目标。\n- 如果目标斑块为空，则定殖尝试成功。\n- 每个被占据的斑块以每个斑块 $e > 0$ 的速率灭绝。\n- 系统表现出均匀混合的特性。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据。它描述了理论生态学中一类已广为人知的模型，称为集合种群模型，特别是 Levins 模型的一个包含内部定殖的变体。其假设——斑块层面的独立随机事件、均匀混合以及大N下的平均场极限——是用于从底层随机过程推导确定性动态的标准且严谨的简化方法。该问题是适定的，提供了所有必要的参数（$c$ 和 $e$）和概念框架，以推导唯一的微分方程并分析其性质。语言客观而精确。该问题没有违反任何数学或生物学的基本原理；相反，它是数学物学中的一个典型练习。它不完整、不矛盾，也非无足轻重。\n\n**步骤3：结论与行动**\n该问题有效。将提供解答。\n\n任务是推导被占据斑块比例 $p(t)$ 的平均场常微分方程（ODE）。$p(t)$ 的变化率，记作 $\\frac{dp}{dt}$，由空斑块被定殖的速率与被占据斑块灭绝的速率之间的平衡决定。\n\n让我们考虑在平均场极限 $N \\to \\infty$ 下的系统。被占据的斑块数量为 $N p(t)$，空斑块的数量为 $N(1 - p(t))$。\n\n首先，我们构建因灭绝而被占据斑块的损失率。在 $N p(t)$ 个被占据的斑块中，每个斑块的独立灭绝率为 $e$。因此，系统中单位时间内灭绝事件的总数为 $e \\times N p(t)$。为了求得被占据斑块*比例*的变化率，我们必须将这个总速率除以 $N$。\n因灭绝导致的 $p(t)$ 下降率 = $\\frac{e N p(t)}{N} = e p(t)$。\n这给出了ODE中的灭绝项：$-e p(t)$。\n\n接下来，我们构建因定殖而被占据斑块的增长率。$N p(t)$ 个被占据的斑块中，每个斑块以速率 $c$ 产生定殖尝试。整个系统产生的定殖尝试总速率为 $c \\times N p(t)$。\n一次尝试只有落在空斑块上才算成功。一个给定的定殖斑块将其繁殖体送至其他 $N-1$ 个斑块之一。在平均场极限下，任何一个被选为目标的斑块为空的概率就是全局空斑块的比例，即 $(1 - p(t))$。模型指出目标是从其他 $N-1$ 个斑块中选择的。这些斑块中的空斑块数量为 $N(1-p(t))$。因此，一次定殖尝试成功找到空斑块的概率为 $\\frac{N(1 - p(t))}{N-1}$。\n成功定殖的总速率（即新斑块被占据的速率）是总尝试速率乘以每次尝试成功的概率：\n新占据速率 = $(c N p(t)) \\times \\left( \\frac{N(1 - p(t))}{N-1} \\right)$。\n为了求得被占据斑块*比例*的变化率，此表达式需除以 $N$：\n因定殖导致的 $p(t)$ 增长率 = $\\frac{1}{N} \\left[ c N p(t) \\frac{N(1 - p(t))}{N-1} \\right] = c p(t) (1 - p(t)) \\frac{N}{N-1}$。\n在极限 $N \\to \\infty$ 下，项 $\\frac{N}{N-1}$ 收敛于 $1$。因此，平均场ODE中的定殖项为 $c p(t)(1 - p(t))$。\n\n结合定殖增长项和灭绝损失项，我们得到 $p(t)$ 的控制ODE：\n$$ \\frac{dp}{dt} = c p(t)(1 - p(t)) - e p(t) $$\n这个方程是带线性死亡项的逻辑斯谛方程的一种形式。我们将右边记为 $f(p) = c p(1-p) - e p$。\n\n为求平衡占据率，我们令 $\\frac{dp}{dt} = 0$：\n$$ c p(1-p) - e p = 0 $$\n$$ p [c(1-p) - e] = 0 $$\n该方程产生两个可能的平衡解（记作 $p^*$）。\n第一个是平凡平衡点：\n$$ p^*_1 = 0 $$\n这对应于物种完全灭绝。该解总是可行的，因为 $0 \\le 0 \\le 1$。\n第二个平衡点可以通过将方括号内的项设为零来求得：\n$$ c(1-p^*) - e = 0 $$\n$$ c - c p^* - e = 0 $$\n$$ c p^* = c - e $$\n$$ p^*_2 = \\frac{c-e}{c} = 1 - \\frac{e}{c} $$\n这是非平凡平衡点，或称地方性平衡点。为使该平衡点在物理上可行，其值必须位于区间 $[0, 1]$ 内。因为 $c > 0$ 且 $e > 0$，条件 $p^*_2 \\le 1$ 简化为 $1 - \\frac{e}{c} \\le 1$，即 $-\\frac{e}{c} \\le 0$，此条件恒成立。条件 $p^*_2 \\ge 0$ 要求 $1 - \\frac{e}{c} \\ge 0$，这意味着 $c \\ge e$。因此，仅当定殖率大于或等于灭绝率时，非平凡平衡点才是可行的。\n\n接下来，我们通过分析平凡平衡点 $p^*_1 = 0$ 的稳定性来建立入侵准则。如果一个小的种群能够增长，入侵就是可能的，这意味着 $p=0$ 处的平衡点是不稳定的。其稳定性由右侧函数在平衡点处的导数 $f'(p)$ 的符号决定。\n$$ f(p) = cp - cp^2 - ep $$\n$$ f'(p) = \\frac{d}{dp}(cp - cp^2 - ep) = c - 2cp - e $$\n在 $p=0$ 处求值：\n$$ f'(0) = c - 2c(0) - e = c - e $$\n为使种群能从稀有状态增长（即 $p=0$ 为一个不稳定的平衡点），我们需要 $f'(0) > 0$。因此，入侵准则为：\n$$ c - e > 0 \\quad \\text{或} \\quad c > e $$\n\n最后，我们确定当入侵准则 $c > e$ 满足时，哪个平衡点是局部稳定的。\n我们已经证明，当 $c > e$ 时， $f'(0) > 0$，所以平凡平衡点 $p^*_1 = 0$ 是不稳定的。\n现在我们分析非平凡平衡点 $p^*_2 = 1 - e/c$ 的稳定性。我们在此点计算 $f'(p)$ 的值：\n$$ f'(p^*_2) = f'\\left(1 - \\frac{e}{c}\\right) = c - 2c\\left(1 - \\frac{e}{c}\\right) - e $$\n$$ f'(p^*_2) = c - \\left(2c - 2c\\frac{e}{c}\\right) - e $$\n$$ f'(p^*_2) = c - (2c - 2e) - e $$\n$$ f'(p^*_2) = c - 2c + 2e - e = -c + e = -(c - e) $$\n由于满足入侵准则 $c > e$，这意味着 $c - e > 0$。\n因此， $f'(p^*_2) = -(c - e) < 0$。\n负的导数表明该平衡点是局部稳定的。因此，当入侵物种能够建立种群时（$c > e$），系统会收敛到稳定的非零平衡占据率 $p^*_2 = 1 - \\frac{e}{c}$。\n\n问题要求给出非零平衡占据率。即 $p^*_2$。", "answer": "$$\\boxed{1 - \\frac{e}{c}}$$", "id": "2473480"}, {"introduction": "生物入侵如何深远地改变生态系统功能，例如养分循环和碳储存？本练习 [@problem_id:2473478] 模拟了一个常见的研究情景，即利用入侵地和未入侵地的配对样方数据来评估影响。通过这个实践，您将获得建立和应用动态生态系统模型的实践经验，将分解和土壤有机质形成的基本原理转化为代码，以预测氮矿化和土壤碳储量的长期变化。这将帮助您深入理解物种性状如何与生态系统层面的效应联系起来。", "problem": "一种植物入侵改变了碎屑的输入和质量。考虑成对的入侵和未入侵样地，您已测量了这些样地的凋落物碳氮比、分解速率和凋落物碳输入。假设以下基本原则适用：(i) 凋落物质量损失遵循一级动力学，意味着瞬时碳损失速率与当前的凋落物碳库成正比；(ii) 在给定时间的净氮矿化等于从分解的凋落物碳中释放的氮减去支持微生物生长所需的氮，其中微生物生长由一个恒定的碳利用效率（CUE）和一个恒定的微生物生物量碳氮比决定；(iii) 微生物生长碳的一个恒定部分转变为稳定的土壤有机碳（SOC），并以一级动力学进行衰减。假设在预测时间范围内，空间条件同质且参数保持不变。\n\n您的程序将使用的定义和符号：\n- 凋落物碳输入速率 $I_C$，单位为 $\\mathrm{g\\ C\\ m^{-2}\\ yr^{-1}}$。\n- 凋落物碳库 $C_L(t)$，单位为 $\\mathrm{g\\ C\\ m^{-2}}$。\n- 土壤有机碳（SOC）库 $C_S(t)$，单位为 $\\mathrm{g\\ C\\ m^{-2}}$。\n- 凋落物分解速率常数 $k_L$，单位为 $\\mathrm{yr^{-1}}$。\n- 土壤有机碳衰减速率常数 $k_S$，单位为 $\\mathrm{yr^{-1}}$。\n- 凋落物碳氮比 $\\mathrm{CN_L}$，单位为 $\\mathrm{g\\ C\\ g^{-1}\\ N}$。\n- 微生物生物量碳氮比 $\\mathrm{CN_{mic}}$，单位为 $\\mathrm{g\\ C\\ g^{-1}\\ N}$。\n- 碳利用效率（CUE）$e$（无量纲），指被微生物生物量固定的已分解碳的比例。\n- 稳定化比例 $s$（无量纲），指转变为稳定化土壤有机碳的微生物生长碳的比例。\n- 时间跨度 $T$，单位为 $\\mathrm{yr}$。\n\n需要实现的原理：\n- 一级凋落物碳动态与恒定输入：凋落物库从初始条件 $C_L(0)$ 开始，在恒定的 $I_C$ 和 $k_L$ 下演变。\n- 在时间 $t$ 的净氮矿化通量等于从分解凋落物中释放的氮与微生物生长所需的氮之差，给定 $e$ 和 $\\mathrm{CN_{mic}}$。\n- 土壤有机碳（SOC）由一部分比例为 $s$ 的微生物生长碳累积，并以速率 $k_S$ 衰减。\n- 初始条件代表 $t=0$ 时未入侵系统的入侵前稳态：设置 $C_L(0) = I_C^{\\mathrm{uninv}}/k_L^{\\mathrm{uninv}}$ 和 $C_S(0) = s\\, e\\, I_C^{\\mathrm{uninv}}/k_S$。\n\n您的程序必须为每个测试用例执行以下操作：\n1. 使用上述原理，计算在时间跨度 $[0,T]$ 内，入侵样地和未入侵样地的累积净氮矿化量，然后报告其差值 $\\Delta M_N = M_N^{\\mathrm{inv}} - M_N^{\\mathrm{uninv}}$，单位为 $\\mathrm{g\\ N\\ m^{-2}}$。\n2. 使用上述原理，计算入侵样地和未入侵样地的土壤有机碳库 $C_S(T)$，然后报告其差值 $\\Delta C_S(T) = C_S^{\\mathrm{inv}}(T) - C_S^{\\mathrm{uninv}}(T)$，单位为 $\\mathrm{g\\ C\\ m^{-2}}$。\n3. 将每个测试用例的输出表示为一个包含两个浮点数的列表 $[\\Delta M_N,\\ \\Delta C_S(T)]$。将所有测试用例的结果汇总到一个列表中。\n\n不涉及角度单位。如果需要，百分比必须表示为小数。\n\n测试套件。每个测试用例提供未入侵和入侵样地的参数、微生物和稳定化参数以及时间跨度 $T$。使用上述初始条件定义。参数值为：\n- 测试用例 $1$（固氮入侵者；更高的输入和更快的衰减）：\n  - 未入侵：$I_C^{\\mathrm{uninv}} = 400$， $k_L^{\\mathrm{uninv}} = 0.6$， $\\mathrm{CN_L}^{\\mathrm{uninv}} = 60$。\n  - 入侵：$I_C^{\\mathrm{inv}} = 520$， $k_L^{\\mathrm{inv}} = 0.9$， $\\mathrm{CN_L}^{\\mathrm{inv}} = 25$。\n  - 共享参数：$e = 0.4$， $\\mathrm{CN_{mic}} = 8$， $s = 0.25$， $k_S = 0.03$， $T = 10$。\n- 测试用例 $2$（木本入侵者；较慢的衰减和更高的 $\\mathrm{CN_L}$）：\n  - 未入侵：$I_C^{\\mathrm{uninv}} = 350$， $k_L^{\\mathrm{uninv}} = 0.5$， $\\mathrm{CN_L}^{\\mathrm{uninv}} = 50$。\n  - 入侵：$I_C^{\\mathrm{inv}} = 360$， $k_L^{\\mathrm{inv}} = 0.4$， $\\mathrm{CN_L}^{\\mathrm{inv}} = 120$。\n  - 共享参数：$e = 0.45$， $\\mathrm{CN_{mic}} = 9$， $s = 0.2$， $k_S = 0.02$， $T = 20$。\n- 测试用例 $3$（边界情况，$k_L^{\\mathrm{inv}} = k_S$，用于测试向土壤有机碳的退化强迫）：\n  - 未入侵：$I_C^{\\mathrm{uninv}} = 300$， $k_L^{\\mathrm{uninv}} = 0.3$， $\\mathrm{CN_L}^{\\mathrm{uninv}} = 55$。\n  - 入侵：$I_C^{\\mathrm{inv}} = 300$， $k_L^{\\mathrm{inv}} = 0.02$， $\\mathrm{CN_L}^{\\mathrm{inv}} = 40$。\n  - 共享参数：$e = 0.35$， $\\mathrm{CN_{mic}} = 7$， $s = 0.2$， $k_S = 0.02$， $T = 5$。\n- 测试用例 $4$（阈值情况，当 $e/\\mathrm{CN_{mic}} = 1/\\mathrm{CN_L}^{\\mathrm{inv}}$ 时，$\\mathrm{CN_L}^{\\mathrm{inv}}$ 满足任何时间净矿化量为零）：\n  - 未入侵：$I_C^{\\mathrm{uninv}} = 450$， $k_L^{\\mathrm{uninv}} = 0.7$， $\\mathrm{CN_L}^{\\mathrm{uninv}} = 30$。\n  - 入侵：$I_C^{\\mathrm{inv}} = 450$， $k_L^{\\mathrm{inv}} = 0.7$， $\\mathrm{CN_L}^{\\mathrm{inv}} = 20$。\n  - 共享参数：$e = 0.4$， $\\mathrm{CN_{mic}} = 8$， $s = 0.3$, $k_S = 0.04$, $T = 15$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个每个测试用例结果的列表，每个测试用例的结果是一个双元素列表 $[\\Delta M_N,\\ \\Delta C_S(T)]$。数字必须是浮点数。整体结构必须是打印在单行上的单个列表，例如 $[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]]$，无附加文本。$\\Delta M_N$ 和 $\\Delta C_S(T)$ 都必须使用其指定单位：$\\Delta M_N$ 在 $[0,T]$ 上的单位为 $\\mathrm{g\\ N\\ m^{-2}}$，$\\Delta C_S(T)$ 在时间 $T$ 的单位为 $\\mathrm{g\\ C\\ m^{-2}}$。", "solution": "该问题具有科学依据，定义明确，且所有必要的参数和初始条件均已提供。因此，该问题是有效的。解决方案通过对控制常微分方程（ODE）进行解析积分来推导。\n\n凋落物碳库 $C_L(t)$ 和土壤有机碳（SOC）库 $C_S(t)$ 的动态由一个一阶线性常微分方程组描述。\n\n凋落物碳库的常微分方程为：\n$$\n\\frac{dC_L(t)}{dt} = I_C - k_L C_L(t)\n$$\n其中 $I_C$ 是恒定的凋落物碳输入速率，$k_L$ 是一阶分解速率常数。未入侵和入侵情景的初始条件都是未入侵生态系统的稳态凋落物碳库，由 $\\frac{dC_L}{dt} = 0$ 给出：\n$$\nC_L(0) = \\frac{I_C^{\\mathrm{uninv}}}{k_L^{\\mathrm{uninv}}}\n$$\n该常微分方程的通解为：\n$$\nC_L(t) = \\left( C_L(0) - \\frac{I_C}{k_L} \\right) e^{-k_L t} + \\frac{I_C}{k_L}\n$$\n对于未入侵样地，参数是恒定的，系统保持稳态，因此 $C_L^{\\mathrm{uninv}}(t) = C_L(0)$。对于入侵样地，在 $t=0$ 时参数切换为 $I_C^{\\mathrm{inv}}$ 和 $k_L^{\\mathrm{inv}}$，$C_L^{\\mathrm{inv}}(t)$ 遵循上述使用这些新参数和指定初始条件的瞬态解。\n\n瞬时净氮矿化速率 $m_N(t)$ 是从分解凋落物中释放的氮与微生物同化的氮之间的差值：\n$$\nm_N(t) = \\frac{k_L C_L(t)}{\\mathrm{CN_L}} - \\frac{e \\cdot k_L C_L(t)}{\\mathrm{CN_{mic}}} = k_L C_L(t) \\left( \\frac{1}{\\mathrm{CN_L}} - \\frac{e}{\\mathrm{CN_{mic}}} \\right)\n$$\n在时间跨度 $[0, T]$ 上的累积净矿化量为 $M_N = \\int_0^T m_N(t) dt$。对于未入侵样地，由于 $C_L^{\\mathrm{uninv}}(t)$ 是常数，这可以简化为：\n$$\nM_N^{\\mathrm{uninv}} = I_C^{\\mathrm{uninv}} \\left( \\frac{1}{\\mathrm{CN_L}^{\\mathrm{uninv}}} - \\frac{e}{\\mathrm{CN_{mic}}} \\right) T\n$$\n对于入侵样地，我们必须对 $m_N^{\\mathrm{inv}}(t)$ 的完整表达式进行积分：\n$$\nM_N^{\\mathrm{inv}} = \\left( \\frac{1}{\\mathrm{CN_L}^{\\mathrm{inv}}} - \\frac{e}{\\mathrm{CN_{mic}}} \\right) k_L^{\\mathrm{inv}} \\int_0^T C_L^{\\mathrm{inv}}(t) dt\n$$\n求解该积分得到：\n$$\nM_N^{\\mathrm{inv}} = \\left( \\frac{1}{\\mathrm{CN_L}^{\\mathrm{inv}}} - \\frac{e}{\\mathrm{CN_{mic}}} \\right) \\left[ \\left( \\frac{I_C^{\\mathrm{uninv}}}{k_L^{\\mathrm{uninv}}} - \\frac{I_C^{\\mathrm{inv}}}{k_L^{\\mathrm{inv}}} \\right) (1 - e^{-k_L^{\\mathrm{inv}} T}) + I_C^{\\mathrm{inv}} T \\right]\n$$\n所需的输出是差值 $\\Delta M_N = M_N^{\\mathrm{inv}} - M_N^{\\mathrm{uninv}}$。\n\n土壤有机碳库的常微分方程为：\n$$\n\\frac{dC_S(t)}{dt} = s \\cdot e \\cdot k_L C_L(t) - k_S C_S(t)\n$$\n其中 $s$ 是稳定化比例，$e$ 是碳利用效率，$k_S$ 是土壤有机碳衰减速率常数。初始条件是未入侵系统的稳态土壤有机碳：\n$$\nC_S(0) = \\frac{s e I_C^{\\mathrm{uninv}}}{k_S}\n$$\n这是一个带时变强迫项的线性一阶常微分方程。解可以通过使用积分因子 $e^{k_S t}$ 求得。\n对于未入侵样地，系统处于稳态，因此对所有 $t$ 都有 $C_S^{\\mathrm{uninv}}(t) = C_S(0)$。因此，$C_S^{\\mathrm{uninv}}(T) = C_S(0)$。\n对于入侵样地，我们必须求解瞬态方程。解取决于 $k_L^{\\mathrm{inv}}$ 是否等于 $k_S$。\n\n情况1：$k_L^{\\mathrm{inv}} \\neq k_S$（非共振情况）。$C_S^{\\mathrm{inv}}(t)$ 的解为：\n$$\nC_S^{\\mathrm{inv}}(t) = \\frac{s e k_L^{\\mathrm{inv}}}{k_S - k_L^{\\mathrm{inv}}} \\left( C_L(0) - \\frac{I_C^{\\mathrm{inv}}}{k_L^{\\mathrm{inv}}} \\right) (e^{-k_L^{\\mathrm{inv}} t} - e^{-k_S t}) + \\frac{s e I_C^{\\mathrm{inv}}}{k_S} (1 - e^{-k_S t}) + C_S(0) e^{-k_S t}\n$$\n情况2：$k_L^{\\mathrm{inv}} = k_S$（共振情况）。$C_S^{\\mathrm{inv}}(t)$ 的解为：\n$$\nC_S^{\\mathrm{inv}}(t) = s e k_L^{\\mathrm{inv}} \\left( C_L(0) - \\frac{I_C^{\\mathrm{inv}}}{k_L^{\\mathrm{inv}}} \\right) t e^{-k_L^{\\mathrm{inv}} t} + \\frac{s e I_C^{\\mathrm{inv}}}{k_S} (1 - e^{-k_S t}) + C_S(0) e^{-k_S t}\n$$\n在两种情况下，我们都计算 $t=T$ 时的 $C_S^{\\mathrm{inv}}(t)$，并计算差值 $\\Delta C_S(T) = C_S^{\\mathrm{inv}}(T) - C_S^{\\mathrm{uninv}}(T)$。\n\n程序将实现这些推导出的解析解，为每个测试用例计算 $[\\Delta M_N, \\Delta C_S(T)]$。", "answer": "```python\nimport numpy as np\n\ndef calculate_dynamics_change(params_uninv, params_inv, params_shared):\n    \"\"\"\n    Calculates the change in cumulative N mineralization and final SOC pool\n    due to a plant invasion, based on an analytical model solution.\n\n    Args:\n        params_uninv (tuple): Parameters for the uninvaded plot (I_C, k_L, CN_L).\n        params_inv (tuple): Parameters for the invaded plot (I_C, k_L, CN_L).\n        params_shared (tuple): Shared parameters (e, CN_mic, s, k_S, T).\n\n    Returns:\n        list: A list containing two floats [delta_M_N, delta_C_S_T].\n    \"\"\"\n    I_C_uninv, k_L_uninv, CN_L_uninv = params_uninv\n    I_C_inv, k_L_inv, CN_L_inv = params_inv\n    e, CN_mic, s, k_S, T = params_shared\n\n    # --- Part 1: Calculate change in cumulative Net N Mineralization (Delta M_N) ---\n\n    # For the uninvaded plot, the system is at steady state.\n    # Instantaneous N mineralization rate is constant: m_N = I_C * (1/CN_L - e/CN_mic)\n    f_N_uninv = (1.0 / CN_L_uninv) - (e / CN_mic)\n    M_N_uninv = I_C_uninv * f_N_uninv * T\n\n    # For the invaded plot, the system is in a transient state.\n    # Initial litter C pool is from the uninvaded steady state.\n    C_L0 = I_C_uninv / k_L_uninv\n    f_N_inv = (1.0 / CN_L_inv) - (e / CN_mic)\n\n    # Cumulative N mineralization is F_N * integral(k_L * C_L(t) dt)\n    # The integral of k_L * C_L(t) is equivalent to total C input minus change in C pool\n    # The more direct formula derived in the solution is used here.\n    term_C_L_transient = (C_L0 - I_C_inv / k_L_inv) * (1.0 - np.exp(-k_L_inv * T))\n    M_N_inv = f_N_inv * (term_C_L_transient + I_C_inv * T)\n    \n    delta_M_N = M_N_inv - M_N_uninv\n\n    # --- Part 2: Calculate change in SOC pool at time T (Delta C_S(T)) ---\n\n    # Initial SOC pool is from the uninvaded steady state.\n    C_S0 = s * e * I_C_uninv / k_S\n    C_S_uninv_T = C_S0  # Uninvaded SOC pool remains at steady state.\n\n    # For the invaded plot, we solve the transient ODE for C_S(t)\n    # and evaluate at t = T.\n    if abs(k_L_inv - k_S)  1e-12:  # Resonant case: k_L_inv is equal to k_S\n        term1 = s * e * k_L_inv * (C_L0 - I_C_inv / k_L_inv) * T * np.exp(-k_L_inv * T)\n        term2 = (s * e * I_C_inv / k_S) * (1.0 - np.exp(-k_S * T))\n        term3 = C_S0 * np.exp(-k_S * T)\n        C_S_inv_T = term1 + term2 + term3\n    else:  # Non-resonant case\n        term1_coeff = (s * e * k_L_inv) / (k_S - k_L_inv)\n        term1_dC_L = C_L0 - (I_C_inv / k_L_inv)\n        term1_exp = np.exp(-k_L_inv * T) - np.exp(-k_S * T)\n        term1 = term1_coeff * term1_dC_L * term1_exp\n        \n        term2 = (s * e * I_C_inv / k_S) * (1.0 - np.exp(-k_S * T))\n        term3 = C_S0 * np.exp(-k_S * T)\n        C_S_inv_T = term1 + term2 + term3\n\n    delta_C_S_T = C_S_inv_T - C_S_uninv_T\n\n    return [delta_M_N, delta_C_S_T]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        {\n            \"uninv\": (400, 0.6, 60),\n            \"inv\": (520, 0.9, 25),\n            \"shared\": (0.4, 8, 0.25, 0.03, 10),\n        },\n        # Test case 2\n        {\n            \"uninv\": (350, 0.5, 50),\n            \"inv\": (360, 0.4, 120),\n            \"shared\": (0.45, 9, 0.2, 0.02, 20),\n        },\n        # Test case 3\n        {\n            \"uninv\": (300, 0.3, 55),\n            \"inv\": (300, 0.02, 40),\n            \"shared\": (0.35, 7, 0.2, 0.02, 5),\n        },\n        # Test case 4\n        {\n            \"uninv\": (450, 0.7, 30),\n            \"inv\": (450, 0.7, 20),\n            \"shared\": (0.4, 8, 0.3, 0.04, 15),\n        },\n    ]\n\n    all_results_str = []\n    for case in test_cases:\n        result = calculate_dynamics_change(case[\"uninv\"], case[\"inv\"], case[\"shared\"])\n        # Format each number as a float string for the list\n        all_results_str.append(f\"[{result[0]},{result[1]}]\")\n\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```", "id": "2473478"}]}