{"hands_on_practices": [{"introduction": "生态学假说通常可以通过数学模型来精确表述和检验。此练习应用了演化生态学中的优化理论，来探讨入侵生物学中的一个核心权衡：在生长与防御之间分配资源。通过解决这个问题，您将定量地理解“天敌释放”如何驱动入侵物种演化出较低的防御投入，这为了解入侵成功背后的演化动力学提供了坚实的理论基础。[@problem_id:2486907]", "problem": "一种入侵植物将其同化资源的 $\\alpha \\in [0,1]$ 部分分配给化学防御，剩余的 $1-\\alpha$ 部分分配给生长和繁殖。设马尔萨斯适应度可由人均净增长率近似表示\n$$\nW(\\alpha) = r(1-\\alpha) - m(\\alpha),\n$$\n其中 $r>0$ 是一个常数比例因子，将分配给生长的资源转化为内在的人均增长率，而 $m(\\alpha)$ 是由天敌引起的人均死亡风险。根据经验，$m(\\alpha)$ 是 $\\alpha$ 的递减函数，通常可以用关于防御投入的指数下降函数很好地描述。因此，假设在原产地，该风险的形式为\n$$\nm_{\\mathrm{N}}(\\alpha) = m_{0}\\,\\exp(-k \\alpha),\n$$\n其中 $m_{0}>0$ 是基线天敌压力，$k>0$ 是单位投入的防御效力。\n\n天敌释放假说 (Enemy Release Hypothesis, ERH) 认为，在引入地，天敌压力会减小。将此模型化为天敌丰度或攻击率乘以一个因子 $\\phi \\in (0,1)$ 的减少，因此引入地的风险为\n$$\nm_{\\mathrm{I}}(\\alpha) = \\phi\\, m_{0}\\,\\exp(-k \\alpha).\n$$\n\n仅使用约束优化的基本微积分和标准生活史权衡推理，完成以下任务：\n\n1. 推导在原产地使 $W(\\alpha)$ 最大化的内部最优分配 $\\alpha_{\\mathrm{N}}^{\\ast}$ 和在引入地使 $W(\\alpha)$ 最大化的内部最优分配 $\\alpha_{\\mathrm{I}}^{\\ast}$，约束条件为 $\\alpha \\in [0,1]$。陈述确保这些最优点是内部且唯一的正则性条件。\n2. 假设参数在两个区域都满足内部解的条件，计算由 ERH 引起的最优分配变化，\n$$\n\\Delta \\alpha^{\\ast} \\equiv \\alpha_{\\mathrm{I}}^{\\ast} - \\alpha_{\\mathrm{N}}^{\\ast},\n$$\n并将最终结果表示为仅含 $\\phi$ 和 $k$ 的单个闭式解析表达式。无需单位。请勿对答案进行近似或四舍五入。", "solution": "所给问题是演化生态学领域的一个标准优化问题，具体涉及防御投入与生长繁殖投入之间的权衡。该问题提法明确，具有科学依据，并包含在特定条件下获得唯一解所需的所有信息。推导过程如下。\n\n马尔萨斯适应度 $W(\\alpha)$ 由以下函数给出：\n$$\nW(\\alpha) = r(1-\\alpha) - m(\\alpha)\n$$\n其中 $\\alpha \\in [0,1]$ 是分配给化学防御的资源比例，$r>0$ 是与生长相关的常数，$m(\\alpha)$ 是死亡风险。\n\n在原产地，适应度函数为：\n$$\nW_{\\mathrm{N}}(\\alpha) = r(1-\\alpha) - m_{\\mathrm{N}}(\\alpha) = r(1-\\alpha) - m_{0}\\,\\exp(-k \\alpha)\n$$\n在引入地，根据天敌释放假说 (ERH)，适应度函数为：\n$$\nW_{\\mathrm{I}}(\\alpha) = r(1-\\alpha) - m_{\\mathrm{I}}(\\alpha) = r(1-\\alpha) - \\phi\\, m_{0}\\,\\exp(-k \\alpha)\n$$\n其中 $\\phi \\in (0,1)$ 表示天敌压力的减小。\n\n为找到使适应度最大化的最优分配 $\\alpha^{\\ast}$，我们必须通过对 $W(\\alpha)$ 关于 $\\alpha$ 求一阶导数并令其为零来找到临界点。我们考虑一个通用形式 $W(\\alpha) = r(1-\\alpha) - C \\exp(-k\\alpha)$，其中 $C$ 是一个正常数（原产地为 $C=m_0$，引入地为 $C=\\phi m_0$）。\n\n一阶导数为：\n$$\n\\frac{dW}{d\\alpha} = \\frac{d}{d\\alpha} \\left( r - r\\alpha - C\\exp(-k\\alpha) \\right) = -r - C(-k)\\exp(-k\\alpha) = -r + Ck\\exp(-k\\alpha)\n$$\n令导数为零以求临界点 $\\alpha^{\\ast}$：\n$$\n-r + Ck\\exp(-k\\alpha^{\\ast}) = 0\n$$\n$$\nCk\\exp(-k\\alpha^{\\ast}) = r\n$$\n$$\n\\exp(-k\\alpha^{\\ast}) = \\frac{r}{Ck}\n$$\n对两边取自然对数：\n$$\n-k\\alpha^{\\ast} = \\ln\\left(\\frac{r}{Ck}\\right)\n$$\n解出 $\\alpha^{\\ast}$：\n$$\n\\alpha^{\\ast} = -\\frac{1}{k}\\ln\\left(\\frac{r}{Ck}\\right) = \\frac{1}{k}\\ln\\left(\\left(\\frac{r}{Ck}\\right)^{-1}\\right) = \\frac{1}{k}\\ln\\left(\\frac{Ck}{r}\\right)\n$$\n为确认此临界点为最大值点，我们考察二阶导数：\n$$\n\\frac{d^2W}{d\\alpha^2} = \\frac{d}{d\\alpha} \\left( -r + Ck\\exp(-k\\alpha) \\right) = Ck(-k)\\exp(-k\\alpha) = -Ck^2\\exp(-k\\alpha)\n$$\n鉴于 $C>0$，$k>0$ 且 $\\exp(\\cdot)$ 恒为正，二阶导数 $\\frac{d^2W}{d\\alpha^2}$ 对所有 $\\alpha$ 均严格为负。这表明适应度函数 $W(\\alpha)$ 是严格凹函数。因此，临界点 $\\alpha^{\\ast}$ 对应一个唯一的全局最大值。\n\n问题要求一个内部解，即 $\\alpha^{\\ast} \\in (0,1)$。其正则性条件为：\n1.  $\\alpha^{\\ast} > 0$：\n    $$\n    \\frac{1}{k}\\ln\\left(\\frac{Ck}{r}\\right) > 0 \\implies \\ln\\left(\\frac{Ck}{r}\\right) > 0 \\implies \\frac{Ck}{r} > 1 \\implies Ck > r\n    $$\n2.  $\\alpha^{\\ast} < 1$：\n    $$\n    \\frac{1}{k}\\ln\\left(\\frac{Ck}{r}\\right) < 1 \\implies \\ln\\left(\\frac{Ck}{r}\\right) < k \\implies \\frac{Ck}{r} < \\exp(k) \\implies Ck < r\\exp(k)\n    $$\n因此，唯一内部最优解的条件是 $r < Ck < r\\exp(k)$。\n\n现在，我们将此结果应用于原产地和引入地。\n对于原产地，$C = m_0$。最优分配为：\n$$\n\\alpha_{\\mathrm{N}}^{\\ast} = \\frac{1}{k}\\ln\\left(\\frac{m_0 k}{r}\\right)\n$$\n其为内部解的条件是 $r < m_0 k < r\\exp(k)$。\n\n对于引入地，$C = \\phi m_0$。最优分配为：\n$$\n\\alpha_{\\mathrm{I}}^{\\ast} = \\frac{1}{k}\\ln\\left(\\frac{\\phi m_0 k}{r}\\right)\n$$\n其为内部解的条件是 $r < \\phi m_0 k < r\\exp(k)$。\n\n问题陈述假设参数在两个区域都满足内部解的条件。我们需要计算最优分配的变化量 $\\Delta \\alpha^{\\ast} = \\alpha_{\\mathrm{I}}^{\\ast} - \\alpha_{\\mathrm{N}}^{\\ast}$。\n代入 $\\alpha_{\\mathrm{I}}^{\\ast}$ 和 $\\alpha_{\\mathrm{N}}^{\\ast}$ 的表达式：\n$$\n\\Delta \\alpha^{\\ast} = \\frac{1}{k}\\ln\\left(\\frac{\\phi m_0 k}{r}\\right) - \\frac{1}{k}\\ln\\left(\\frac{m_0 k}{r}\\right)\n$$\n提出因子 $\\frac{1}{k}$：\n$$\n\\Delta \\alpha^{\\ast} = \\frac{1}{k}\\left[ \\ln\\left(\\frac{\\phi m_0 k}{r}\\right) - \\ln\\left(\\frac{m_0 k}{r}\\right) \\right]\n$$\n使用对数恒等式 $\\ln(a) - \\ln(b) = \\ln(a/b)$：\n$$\n\\Delta \\alpha^{\\ast} = \\frac{1}{k} \\ln\\left( \\frac{\\frac{\\phi m_0 k}{r}}{\\frac{m_0 k}{r}} \\right)\n$$\n简化对数函数的参数：\n$$\n\\Delta \\alpha^{\\ast} = \\frac{1}{k} \\ln(\\phi)\n$$\n此表达式仅依赖于天敌释放因子 $\\phi$ 和防御效力 $k$，符合题目要求。由于 $\\phi \\in (0,1)$，$\\ln(\\phi)$ 为负，这意味着 $\\Delta \\alpha^{\\ast} < 0$。这个结果在生态学上是合理的：天敌释放导致对防御的最优投入减少。", "answer": "$$\n\\boxed{\\frac{1}{k}\\ln(\\phi)}\n$$", "id": "2486907"}, {"introduction": "严谨的实验设计是检验如“新武器假说”等生态学理论的基石。这个练习将挑战您扮演一位科学审稿人的角色，批判性地评估一种常用的实验方法（使用活性炭），并识别其潜在的混淆效应。通过分析土壤化学和植物生理学的相互作用，本练习旨在培养您解读实验数据和设计更可靠研究方案的关键技能。[@problem_id:2486867]", "problem": "“新武器假说”（novel weapons hypothesis）的一个核心预测是，入侵植物可以通过在入侵范围内稀有或缺失的次级代谢产物来抑制本地邻近植物。化感作用实验通常通过向土壤中添加活性炭（AC）来吸附溶解的化感物质，然后从邻近植物性能的变化中推断因果效应来检验这一假说。然而，活性炭对土壤化学和生物群有多种副作用，这些副作用可能会混淆推断。考虑一个温室盆栽实验，其中用入侵植物处理过的土壤，在 $2$ kg 的花盆中以 $10~\\text{g kg}^{-1}$ 的比例添加活性炭（即每盆 $m = 20$ g 活性炭）。与吸附剂相互作用的有效土壤溶液体积约为 $V = 0.5$ L。初始正磷酸盐浓度为 $C_0 = 0.2~\\text{mg P L}^{-1}$。独立的批量测试表明，所选活性炭对磷酸盐的吸附具有 Langmuir 吸附容量 $Q_{\\max} = 0.5~\\text{mg P g}^{-1}$ 和亲和力 $b = 2~\\text{L mg}^{-1}$。根据先前对相同土壤和碳源的滴定曲线，活性炭将土壤 pH 从 $5.5$ 提高到 $6.8$。一种主要的候选化感物质是酚酸，其羧基的酸解离常数为 $pK_a = 4.5$。\n\n仅使用化感作用的基本定义（供体释放抑制受体的生化物质）、质量平衡、平衡吸附和酸碱形态，推断在此环境下活性炭对养分和化感物质副作用的可能大小和方向。然后，确定以下哪些选项既 (i) 正确解释了为什么活性炭除了去除化感物质外还能改变植物性能，又 (ii) 提出了一种替代吸附剂或统计校正方法，以在这些条件下更特异性地分离化感效应。\n\n选择所有适用项。\n\nA. 活性炭主要通过吸附疏水性化感物质来促进受体植物生长；但由于给定的 $Q_{\\max}$ 和 $b$ 意味着活性炭在 $C_0$ 和 $V$ 条件下可以去除几乎所有可用的正磷酸盐，因此活性炭也可能将磷的有效性降低到限制生长的水平。一种更具选择性的吸附剂，如聚乙烯基聚吡咯烷酮（PVPP），它能与酚类物质强力结合，同时对无机磷酸盐和铵的亲和力可忽略不计，再结合一个惰性模拟吸附剂对照组以匹配物理扰动，将能更好地分离化感效应。\n\nB. 用强碱性阴离子交换树脂替代活性炭，以便捕获酚酸，同时不影响无机养分；树脂的固定电荷对磷酸盐呈惰性，因此养分有效性得以保持，可以清晰地推断出化感效应。\n\nC. 使用经过去离子水预洗的高温生物炭（在 $700\\,^{\\circ}\\mathrm{C}$ 下热解）；因为洗涤去除了灰分，生物炭将像活性炭一样有效地吸附化感物质，同时保持土壤 pH 和矿物养分不变，从而消除主要的人为干扰。\n\nD. 如果必须使用活性炭，应先在平衡的稀释营养液中预平衡，以占据其养分结合位点，同时设置一个平行的“添加养分但无吸附剂”的对照组，并使用结构方程模型（SEM）分析所得的植物和土壤数据，通过控制测得的土壤磷、氮和 pH 值作为观测协变量，来估计从“吸附剂存在”到受体性能的直接路径。\n\nE. 为了从统计上校正活性炭的人为干扰，仅根据初始受体幼苗质量计算倾向得分，并基于此得分对添加碳和未添加碳的盆栽进行匹配；即使碳改变了养分和 pH，匹配比较也将消除所有混杂因素，并产生对化感效应的无偏估计。", "solution": "该问题陈述在科学上是有效的。它基于生态学（新武器假说）、土壤化学（吸附等温线、pH效应）和分析化学（酸碱平衡）的既定原理。所提供的数据是合理的，足以对化感作用实验中活性炭（AC）的混杂效应进行定量分析。\n\n首先，我将根据所提供的数据分析活性炭的副作用。\n\n1.  **活性炭对正磷酸盐有效性的影响**\n    土壤溶液中的磷酸盐与活性炭之间的相互作用由 Langmuir 吸附等温线和质量平衡方程描述。\n    Langmuir 方程为：\n    $$q_e = \\frac{Q_{\\max} \\cdot b \\cdot C_e}{1 + b \\cdot C_e}$$\n    其中 $q_e$ 是平衡时单位质量活性炭吸附的磷酸盐量，$C_e$ 是溶液中的平衡磷酸盐浓度，$Q_{\\max} = 0.5$ mg P g$^{-1}$ 是最大吸附容量，$b = 2$ L mg$^{-1}$ 是吸附亲和力。\n\n    盆栽系统中磷酸盐的质量平衡方程为：\n    $$(C_0 - C_e) \\cdot V = q_e \\cdot m$$\n    其中 $C_0 = 0.2$ mg P L$^{-1}$ 是初始磷酸盐浓度，$V = 0.5$ L 是有效溶液体积，$m = 20$ g 是添加的活性炭质量。\n\n    将 Langmuir 方程代入质量平衡方程：\n    $$(0.2 - C_e) \\cdot 0.5 = \\left( \\frac{(0.5)(2) C_e}{1 + (2) C_e} \\right) \\cdot 20$$\n    $$0.1 - 0.5 C_e = \\frac{20 C_e}{1 + 2 C_e}$$\n    $$(0.1 - 0.5 C_e)(1 + 2 C_e) = 20 C_e$$\n    $$0.1 + 0.2 C_e - 0.5 C_e - C_e^2 = 20 C_e$$\n    $$C_e^2 + 20.3 C_e - 0.1 = 0$$\n\n    这是一个关于 $C_e$ 的二次方程。求解正根：\n    $$C_e = \\frac{-20.3 + \\sqrt{20.3^2 - 4(1)(-0.1)}}{2(1)} = \\frac{-20.3 + \\sqrt{412.09 + 0.4}}{2} = \\frac{-20.3 + \\sqrt{412.49}}{2} \\approx \\frac{-20.3 + 20.3099}{2} \\approx 0.005 \\text{ mg P L}^{-1}$$\n    初始浓度为 $C_0 = 0.2$ mg P L$^{-1}$。添加活性炭后，平衡磷酸盐浓度降低至约 $0.005$ mg P L$^{-1}$。这表示减少了 $\\frac{0.2 - 0.005}{0.2} \\times 100\\% = 97.5\\%$。有效磷（一种主要的常量营养元素）如此急剧的减少，几乎肯定会限制植物生长。这是一个主要的混杂效应；任何因添加活性炭（由于化感物质被去除）而观察到的植物生长增加，都会被这种诱发的养分缺乏所抵消。\n\n2.  **活性炭引起的 pH 变化对化感物质形态的影响**\n    该化感物质是一种酚酸（HA），其 $pK_a = 4.5$。其生物活性通常与中性的、更亲脂的形态（HA）有关，而去质子化的阴离子形态（A$^-$）活性较低。其形态分布由 Henderson-Hasselbalch 方程决定：\n    $$\\text{pH} = pK_a + \\log_{10}\\left(\\frac{[\\text{A}^-]}{[\\text{HA}]}\\right)$$\n    活性炭将土壤 pH 从 $5.5$ 提高到 $6.8$。\n    -   在初始 pH 值为 $5.5$ 时：\n        $5.5 = 4.5 + \\log_{10}\\left(\\frac{[\\text{A}^-]}{[\\text{HA}]}\\right) \\implies \\frac{[\\text{A}^-]}{[\\text{HA}]} = 10^{1.0} = 10$。\n        活性形态 HA 的比例为 $\\frac{[\\text{HA}]}{[\\text{HA}] + [\\text{A}^-]} = \\frac{1}{1 + 10} = \\frac{1}{11} \\approx 9.1\\%$。\n    -   添加活性炭后，在最终 pH 值为 $6.8$ 时：\n        $6.8 = 4.5 + \\log_{10}\\left(\\frac{[\\text{A}^-]}{[\\text{HA}]}\\right) \\implies \\frac{[\\text{A}^-]}{[\\text{HA}]} = 10^{2.3} \\approx 199.5$。\n        活性形态 HA 的比例为 $\\frac{1}{1 + 199.5} = \\frac{1}{200.5} \\approx 0.5\\%$。\n    活性炭引起的 pH 升高，极大地将平衡从活性的、不带电的化感物质形态推向活性较低的、带电的形态。仅此 pH 变化，与任何吸附无关，便会降低该酚酸的植物毒性，从而混淆了对活性炭效应的解释。\n\n现在，我将评估每个选项。\n\nA. 该选项指出活性炭会降低磷的有效性。我上面的计算证实了这一点，表明在给定参数下，超过 $97\\%$ 的可溶性正磷酸盐会被活性炭吸附。这是对活性炭非化感作用效应的一个正确解释。该选项接着提出使用聚乙烯基聚吡咯烷酮（PVPP），这是一种已知通过氢键与酚类化合物强力结合的聚合物，同时与磷酸盐等无机离子的相互作用可以忽略不计。这使得 PVPP 成为针对目标化感物质的一种更具选择性的吸附剂。将其与惰性模拟吸附剂（如沙子）结合使用，以控制物理土壤扰动，是优秀的实验设计。这个提议正确地指出了一个用于分离化感效应的有效替代策略。\n**结论：正确。**\n\nB. 该选项提议使用强碱性阴离子交换树脂来捕获酚酸的阴离子形态。虽然它确实能捕获去质子化的化感物质（A$^-$），但其核心主张——“不影响无机养分”——是根本错误的。在相关 pH 范围内，正磷酸盐以阴离子（H$_2$PO$_4^-$ 和 HPO$_4^{2-}$）形式存在。强碱性阴离子交换树脂会结合这些磷酸盐阴离子，以及硝酸根（NO$_3^-$）和硫酸根（SO$_4^{2-}$）等其他养分阴离子。因此，这种方法无法解决养分耗竭的问题，甚至可能加剧该问题。\n**结论：错误。**\n\nC. 该选项提议使用经过洗涤的高温生物炭。洗涤生物炭确实可以降低其灰分含量，从而减轻 pH 升高的干扰。然而，该选项提出了两个很强但可能错误的论断。首先，它声称该生物炭吸附化感物质“与活性炭同样有效”。活性炭经过特殊的活化过程，以产生极高的比表面积和微孔结构，使其成为比大多数未活化生物炭更优越的吸附剂。其次，它声称该生物炭将使矿物养分“保持不变”。即使没有灰分，生物炭的碳基质也具有表面官能团和多孔结构，可以吸附包括磷酸盐在内的养分。虽然这种效应可能比活性炭小，但假设其不存在是错误的。该提议只是一种部分缓解措施，并非其所声称的干净解决方案。\n**结论：错误。**\n\nD. 该选项针对必须使用活性炭的情况。它提出了一个多管齐下的策略。首先，用养分预平衡活性炭以饱和其吸附位点，是减少其消耗实验土壤中养分的有效方法。其次，它建议设置适当的对照组。第三，也是最重要的一点，它提议使用结构方程模型（SEM）。SEM 是一种能够定量划分效应的统计技术。通过对从`活性炭存在`到`土壤性质（P、N、pH）`再到`植物性能`的因果路径进行建模，可以估计活性炭的间接效应（通过土壤性质变化介导）和直接效应（残差效应，解释为化感物质的去除）。当混杂效应无法通过实验消除时，这是一种复杂而有效的统计学方法来剖析这些效应。\n**结论：正确。**\n\nE. 该选项提议“仅根据初始受体幼苗质量”使用倾向得分匹配（PSM）。PSM 是一种控制处理前混杂变量的技术。本问题中的混杂源于活性炭的处理后效应（pH 和养分的变化）。基于处理前变量（如初始幼苗质量）进行匹配，可以控制植物间的初始差异，但完全无法解释由处理本身产生的混杂变量。声称这种方法“将消除所有混杂”是错误的。要使用统计模型来控制混杂因素，必须将混杂因素本身（pH、养分）纳入模型，如选项 D 所建议。\n**结论：错误。**", "answer": "$$\\boxed{AD}$$", "id": "2486867"}, {"introduction": "许多生态和演化过程的复杂性使得解析解难以获得，此时计算模拟便成为一种强大的研究工具。本练习运用数量遗传学的基础模型，即 Lande 方程，来模拟植物防御性状在被引入新环境后，如何经历代际演化。这个实践将为您提供一个建立动态模型的亲身经验，该模型整合了“天敌释放”和“新武器”假说的核心概念，从而能够预测性状的演化轨迹。[@problem_id:2486890]", "problem": "您的任务是形式化并实现一个定量遗传学模型，用以分析在“敌人释放假说”和“新武器假说”下，防御投资性状如何演化。考虑一个单一的、代表防御投资的加性数量性状，记为 $D \\in [0,\\infty)$，其在离散世代 $t$ 的种群均值为 $\\mu_t$。该性状的狭义遗传力为 $h^2$，表型方差 $\\sigma_P^2$ 恒定，因此加性遗传方差为 $G = h^2 \\sigma_P^2$。环境通过两项对选择产生影响：一个敌人压力项和一个新武器项。假设个体对数适合度函数是关于 $D$ 的二次函数，并带有一个线性收益项：\n$$\n\\ln W(D \\mid E, w) = r_0 + \\big(s_e E + w\\big) D - c D^2,\n$$\n其中，$r_0$ 是基线马尔萨斯适合度，$s_e$ 是将敌人压力 $E$ 转换为防御边际收益的强度系数，$w$ 是一个代表新武器效应的加性边际收益项（在原生范围中为零，在引入范围中非零），而 $c &gt; 0$ 是防御的凸成本。假设选择是弱的，且性状呈高斯分布，因此选择梯度由对数适合度在均值处的导数给出：$\\beta_t = \\left.\\frac{\\partial \\ln W}{\\partial D}\\right|_{D=\\mu_t}$。使用定量遗传学（QG）中的 Lande 方程，该方程将对选择的响应与选择梯度关联起来：$\\Delta \\mu_t = G \\beta_t$，其中 $\\Delta \\mu_t = \\mu_{t+1} - \\mu_t$。\n\n在指定世代发生的释放事件会瞬间改变敌人压力，并在引入范围内激活新武器效应。您必须为一个两阶段轨迹建模：一个参数为 $(E_{\\mathrm{pre}}, w_{\\mathrm{pre}} = 0)$ 的释放前阶段，紧接着一个参数为 $(E_{\\mathrm{post}}, w_{\\mathrm{post}})$ 的释放后阶段。性状均值必须使用 Lande 方程和从上述对数适合度导出的选择梯度逐代更新。为保持生物学上的现实性，通过在零处进行截断来强制每代性状均值的非负性，即在应用选择后设置 $\\mu_{t+1} \\leftarrow \\max\\{0,\\mu_{t+1}\\}$。您可以假设 $r_0$ 在选择梯度中被抵消，不影响均值的演化。\n\n您的任务是编写一个完整的、可运行的程序，该程序针对下面的每个测试用例，计算在指定数量的释放前和释放后世代之后，最终的释放后均值 $\\mu_{\\mathrm{final}}$。将每个输出表示为四舍五入到六位小数的无量纲分数。\n\n所需的更新规则和模型假设必须从以下内容推导得出：\n- Lande 方程 $\\Delta \\mu_t = G \\beta_t$。\n- 定义 $G = h^2 \\sigma_P^2$，其中 $h^2 \\in [0,1]$。\n- 从指定的对数适合度得出的选择梯度。\n- 在指定世代数上的离散时间迭代，并带有截断 $\\mu_t \\ge 0$。\n\n实现一个函数，该函数为每个测试用例接受以下参数：\n- 初始均值 $\\mu_0$。\n- 遗传力 $h^2$。\n- 表型方差 $\\sigma_P^2$。\n- 成本系数 $c$。\n- 敌人-收益系数 $s_e$。\n- 释放前敌人压力 $E_{\\mathrm{pre}}$。\n- 释放后敌人压力 $E_{\\mathrm{post}}$。\n- 释放后新武器边际收益 $w_{\\mathrm{post}}$（设置释放前 $w_{\\mathrm{pre}} = 0$）。\n- 释放前世代数 $T_{\\mathrm{pre}}$。\n- 释放后世代数 $T_{\\mathrm{post}}$。\n\n对每一代 $t$，计算\n$$\n\\beta_t = \\big(s_e E_t + w_t\\big) - 2c\\,\\mu_t, \\quad \\mu_{t+1} = \\max\\{0, \\mu_t + G \\beta_t\\}。\n$$\n在 $T_{\\mathrm{pre}}$ 步中使用 $(E_t, w_t) = (E_{\\mathrm{pre}}, 0)$，然后在 $T_{\\mathrm{post}}$ 步中使用 $(E_t, w_t) = (E_{\\mathrm{post}}, w_{\\mathrm{post}})$。\n\n测试套件：\n为以下五个测试用例提供输出。所有量均为无量纲。将每个最终输出四舍五入到六位小数。\n\n- 用例 A（敌人释放导致防御选择减弱）：\n  - $\\mu_0 = 0.5$, $h^2 = 0.3$, $\\sigma_P^2 = 0.5$, $c = 1.0$, $s_e = 1.2$, $E_{\\mathrm{pre}} = 1.0$, $E_{\\mathrm{post}} = 0.2$, $w_{\\mathrm{post}} = 0.0$, $T_{\\mathrm{pre}} = 100$, $T_{\\mathrm{post}} = 50$。\n\n- 用例 B（敌人释放但新武器维持选择）：\n  - $\\mu_0 = 0.5$, $h^2 = 0.3$, $\\sigma_P^2 = 0.5$, $c = 1.0$, $s_e = 1.2$, $E_{\\mathrm{pre}} = 1.0$, $E_{\\mathrm{post}} = 0.2$, $w_{\\mathrm{post}} = 0.6$, $T_{\\mathrm{pre}} = 100$, $T_{\\mathrm{post}} = 50$。\n\n- 用例 C（因遗传力为零而无进化响应）：\n  - $\\mu_0 = 0.4$, $h^2 = 0.0$, $\\sigma_P^2 = 0.8$, $c = 1.0$, $s_e = 1.0$, $E_{\\mathrm{pre}} = 1.0$, $E_{\\mathrm{post}} = 0.0$, $w_{\\mathrm{post}} = 0.5$, $T_{\\mathrm{pre}} = 100$, $T_{\\mathrm{post}} = 50$。\n\n- 用例 D（因表型方差为零而无进化响应）：\n  - $\\mu_0 = 0.7$, $h^2 = 0.5$, $\\sigma_P^2 = 0.0$, $c = 1.5$, $s_e = 0.8$, $E_{\\mathrm{pre}} = 0.5$, $E_{\\mathrm{post}} = 0.1$, $w_{\\mathrm{post}} = 0.0$, $T_{\\mathrm{pre}} = 30$, $T_{\\mathrm{post}} = 30$。\n\n- 用例 E（释放后选择将性状推向边界 $\\mu = 0$）：\n  - $\\mu_0 = 0.05$, $h^2 = 0.4$, $\\sigma_P^2 = 0.25$, $c = 1.0$, $s_e = 0.0$, $E_{\\mathrm{pre}} = 0.0$, $E_{\\mathrm{post}} = 0.0$, $w_{\\mathrm{post}} = -0.1$, $T_{\\mathrm{pre}} = 5$, $T_{\\mathrm{post}} = 50$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[r_a,r_b,r_c]”），其中每个条目是相应测试用例的最终 $\\mu_{\\mathrm{final}}$，四舍五入到六位小数，并按上面列出的相同顺序排列。", "solution": "从定量遗传学（QG）框架开始。对于一个均值为 $\\mu_t$、加性遗传方差为 $G$ 的数量性状，Lande 方程给出了每代的改变量：\n$$\n\\Delta \\mu_t = G \\beta_t,\n$$\n其中 $\\beta_t$ 是选择梯度。在弱选择和性状分布近似正态的条件下，选择梯度是马尔萨斯适合度（对数适合度）对性状的导数，并在均值处取值：\n$$\n\\beta_t = \\left.\\frac{\\partial \\ln W}{\\partial D}\\right|_{D=\\mu_t}。\n$$\n我们假设对数适合度的形式为\n$$\n\\ln W(D \\mid E, w) = r_0 + \\big(s_e E + w\\big) D - c D^2,\n$$\n其中 $s_e E$ 是来自敌人压力的防御边际收益，$w$ 是源于新武器假说的额外边际收益（仅在释放后激活），而 $c > 0$ 捕捉了防御投资的凸成本。基线 $r_0$ 在对 $D$ 求导时被抵消。求导得出\n$$\n\\beta_t = (s_e E_t + w_t) - 2 c \\mu_t。\n$$\n将此代入 Lande 方程，并使用 $G = h^2 \\sigma_P^2$，得到离散时间更新规则\n$$\n\\mu_{t+1} = \\mu_t + G \\big[(s_e E_t + w_t) - 2 c \\mu_t\\big] 。\n$$\n为保持一个非负投资性状的生物学现实性，在每一步通过截断施加一个零边界：\n$$\n\\mu_{t+1} \\leftarrow \\max\\{0,\\ \\mu_{t+1}\\}。\n$$\n定义两阶段机制：\n- 释放前 ($t = 0, \\ldots, T_{\\mathrm{pre}}-1$): $(E_t, w_t) = (E_{\\mathrm{pre}}, 0)$。\n- 释放后 ($t = T_{\\mathrm{pre}}, \\ldots, T_{\\mathrm{pre}} + T_{\\mathrm{post}} - 1$): $(E_t, w_t) = (E_{\\mathrm{post}}, w_{\\mathrm{post}})$。\n\n对于固定的 $(E,w)$ 且无边界截断，该更新是一个仿射线性递推关系：\n$$\n\\mu_{t+1} = (1 - 2 c G) \\mu_t + G (s_e E + w).\n$$\n这在以下位置有一个稳定平衡点：\n$$\n\\mu^\\star = \\frac{s_e E + w}{2c},\n$$\n其收敛因子为 $\\alpha = 1 - 2 c G$。当 $| \\alpha | &lt; 1$（例如，当 $0 &lt; c G &lt; 1$ 时），解为\n$$\n\\mu_t = \\mu^\\star + (\\mu_0 - \\mu^\\star) \\alpha^t。\n$$\n然而，因为我们强制要求 $\\mu_t \\ge 0$（并且因为如果 $s_e E + w &lt; 0$，释放后的最适值可能为负），精确的算法是迭代Lande更新并在每一代将结果截断于零。\n\n算法设计：\n- 计算 $G = h^2 \\sigma_P^2$。\n- 初始化 $\\mu \\leftarrow \\mu_0$。\n- 进行 $T_{\\mathrm{pre}}$ 步：更新 $\\mu \\leftarrow \\max\\{0, \\mu + G[(s_e E_{\\mathrm{pre}}) - 2 c \\mu]\\}$。\n- 进行 $T_{\\mathrm{post}}$ 步：更新 $\\mu \\leftarrow \\max\\{0, \\mu + G[(s_e E_{\\mathrm{post}} + w_{\\mathrm{post}}) - 2 c \\mu]\\}$。\n- 返回最终的 $\\mu$，四舍五入到六位小数。\n\n测试套件的定性预期：\n- 用例 A: $G = 0.15$, $c = 1.0$, 所以 $\\alpha = 1 - 2 c G = 0.7$。释放前最适值 $\\mu^\\star_{\\mathrm{pre}} = \\frac{1.2}{2} = 0.6$；释放后最适值 $\\mu^\\star_{\\mathrm{post}} = \\frac{0.24}{2} = 0.12$。长的释放前阶段将 $\\mu$ 推向接近 $0.6$，随后向 $0.12$ 收敛。在 50 个释放后世代后的最终值非常接近 $0.12$，四舍五入后大约为 $0.120000$。\n- 用例 B: 与用例 A 相同，但 $w_{\\mathrm{post}} = 0.6$ 使释放后最适值增加到 $\\mu^\\star_{\\mathrm{post}} = \\frac{0.84}{2} = 0.42$。从接近 $0.6$ 收敛到接近 $0.42$，得到大约 $0.420000$。\n- 用例 C: $h^2 = 0$ 意味着 $G = 0$ 且 $\\mu_t$ 恒定；最终值为 $0.400000$。\n- 用例 D: $\\sigma_P^2 = 0$ 意味着 $G = 0$ 且 $\\mu_t$ 恒定；最终值为 $0.700000$。\n- 用例 E: $G = 0.1$, $c = 1.0$, 所以 $\\alpha = 0.8$。释放前阶段将 $\\mu$ 从 $0.05$ 向下推向 $0$；释放后最适值为负，$\\mu^\\star_{\\mathrm{post}} = \\frac{-0.1}{2} = -0.05$，所以无约束的动态会穿过零，但截断强制 $\\mu \\ge 0$，得到最终值为 $0.000000$。\n\n因此，程序应输出一行，包含五个用方括号括起来的逗号分隔浮点数，对应于用例 A 到 E。根据以上分析，预期的输出大约是 $[0.120000, 0.420000, 0.400000, 0.700000, 0.000000]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef evolve_defense(mu0, h2, sigma_p2, c, s_e, E_pre, E_post, w_post, T_pre, T_post):\n    \"\"\"\n    Evolve the mean defense trait using the Lande equation with boundary truncation.\n    \"\"\"\n    G = h2 * sigma_p2  # additive genetic variance\n    mu = float(mu0)\n\n    # Pre-release: w = 0\n    b_pre = s_e * E_pre  # linear coefficient in log-fitness\n    for _ in range(int(T_pre)):\n        beta = b_pre - 2.0 * c * mu\n        mu = mu + G * beta\n        if mu < 0.0:\n            mu = 0.0\n\n    # Post-release\n    b_post = s_e * E_post + w_post\n    for _ in range(int(T_post)):\n        beta = b_post - 2.0 * c * mu\n        mu = mu + G * beta\n        if mu < 0.0:\n            mu = 0.0\n\n    return mu\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (mu0, h2, sigma_p2, c, s_e, E_pre, E_post, w_post, T_pre, T_post)\n    test_cases = [\n        (0.5, 0.3, 0.5, 1.0, 1.2, 1.0, 0.2, 0.0, 100, 50),     # Case A\n        (0.5, 0.3, 0.5, 1.0, 1.2, 1.0, 0.2, 0.6, 100, 50),     # Case B\n        (0.4, 0.0, 0.8, 1.0, 1.0, 1.0, 0.0, 0.5, 100, 50),     # Case C\n        (0.7, 0.5, 0.0, 1.5, 0.8, 0.5, 0.1, 0.0, 30, 30),      # Case D\n        (0.05, 0.4, 0.25, 1.0, 0.0, 0.0, 0.0, -0.1, 5, 50),    # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        mu0, h2, sigma_p2, c, s_e, E_pre, E_post, w_post, T_pre, T_post = case\n        mu_final = evolve_defense(mu0, h2, sigma_p2, c, s_e, E_pre, E_post, w_post, T_pre, T_post)\n        results.append(f\"{mu_final:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2486890"}]}