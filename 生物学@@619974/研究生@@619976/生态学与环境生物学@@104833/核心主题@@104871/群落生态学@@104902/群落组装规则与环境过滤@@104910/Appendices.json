{"hands_on_practices": [{"introduction": "环境筛选是决定物种能否在特定地点“定居”的首要关卡。本练习将 Hutchinson 的多维生态位概念付诸实践，利用高斯响应函数来量化物种在特定环境条件下的适宜度 [@problem_id:2477215]。通过这个计算，你将掌握如何基于物种的生态位特征（生态位中心和宽度）和环境条件，来预测哪些物种能够通过环境筛选，从而构成潜在的本地群落。", "problem": "一位景观生态学家正采用Hutchinsonian生态位框架来评估一个区域植物区系中的环境过滤。考虑一个由两个标准化的非生物轴（温度和土壤湿度）表征的单一地点。设该地点的环境向量为 $\\mathbf{x} = (T, M) = (1, -1)$，其中$T$和$M$均以偏离区域平均值的标准差（SD）单位来衡量，因此它们是无量纲的。对于每个物种$i$，假设其在$\\mathbf{x}$处的非生物适宜度遵循一个二元高斯响应，该响应以物种的生态位最适点（生态位中心）$\\boldsymbol{\\mu}_i = (\\mu_{i,T}, \\mu_{i,M})$为中心，并具有特定于轴的生态位宽度$b_{i,T}$和$b_{i,M}$，这些宽度被解释为沿各自轴的标准差。假设两个轴的贡献是独立的（对角协方差），并且适宜度被缩放以在生态位中心达到最大值$1$。\n\n该群落由五个物种组成，其生态位参数如下：\n- 物种 A: $\\boldsymbol{\\mu}_{A} = (1, -1)$, $\\mathbf{b}_{A} = (1, 1)$。\n- 物种 B: $\\boldsymbol{\\mu}_{B} = (2, -1)$, $\\mathbf{b}_{B} = (1, 1)$。\n- 物种 C: $\\boldsymbol{\\mu}_{C} = (1, 1)$, $\\mathbf{b}_{C} = (1, 1)$。\n- 物种 D: $\\boldsymbol{\\mu}_{D} = (0, 0)$, $\\mathbf{b}_{D} = (1, 1)$。\n- 物种 E: $\\boldsymbol{\\mu}_{E} = (3, -3)$, $\\mathbf{b}_{E} = (2, 2)$。\n\n假设在没有生物过滤器（例如，没有竞争排斥）的情况下，当且仅当物种在$\\mathbf{x}$处的非生物适宜度至少达到固定阈值$\\tau = 0.2$时，才预测该物种会出现在该地点。\n\n使用上述假设，计算每个物种在$\\mathbf{x}$处的非生物适宜度，并确定哪些物种满足非生物过滤器（即适宜度 $\\ge \\tau$）。请将预测的物种丰富度（通过该地点非生物过滤器的物种数量）作为一个单独的整数作为您的最终答案报告。不要包含单位。如果您进行任何数值近似，中间步骤无需四舍五入到指定的有效数字位数，但最终答案是一个精确的整数，不需要四舍五入。", "solution": "问题陈述已经过分析，并被认为是有效的。它在科学上基于既有的生态学理论，问题阐述清晰，并提供了一套完整且一致的数据和约束条件，足以推导出一个唯一的、有意义的解。其中没有逻辑矛盾、事实不准确或含糊之处。\n\n该问题要求计算五个物种在特定地点的非生物适宜度，并确定哪些物种能通过环境过滤器。物种$i$在环境位置$\\mathbf{x} = (T, M)$的适宜度由一个二元高斯响应函数描述。根据各轴独立以及在物种生态位最适点$\\boldsymbol{\\mu}_i = (\\mu_{i,T}, \\mu_{i,M})$处最大适宜度为$1$的假设，适宜度函数$S_i(\\mathbf{x})$定义为：\n$$ S_i(\\mathbf{x}) = \\exp\\left( -\\frac{1}{2} \\left[ \\left(\\frac{T - \\mu_{i,T}}{b_{i,T}}\\right)^2 + \\left(\\frac{M - \\mu_{i,M}}{b_{i,M}}\\right)^2 \\right] \\right) $$\n在这里，$b_{i,T}$和$b_{i,M}$是生态位宽度，即沿各自环境轴的标准差。方括号中的项是从该地点的环境$\\mathbf{x}$到物种的生态位最适点$\\boldsymbol{\\mu}_i$的平方马氏距离$D_i^2(\\mathbf{x}, \\boldsymbol{\\mu}_i)$，该空间由生态位宽度进行了缩放。\n\n该地点的特征由环境向量$\\mathbf{x} = (1, -1)$描述。如果一个物种的适宜度$S_i(\\mathbf{x})$大于或等于阈值$\\tau = 0.2$，则预测该物种存在。此条件可表示为：\n$$ S_i(\\mathbf{x}) \\ge \\tau $$\n$$ \\exp\\left( -\\frac{1}{2} D_i^2 \\right) \\ge 0.2 $$\n对两边取自然对数：\n$$ -\\frac{1}{2} D_i^2 \\ge \\ln(0.2) $$\n$$ D_i^2 \\le -2 \\ln(0.2) = -2 \\ln\\left(\\frac{1}{5}\\right) = 2 \\ln(5) $$\n由于$\\ln(5) \\approx 1.6094$，平方距离的临界值约为$2 \\times 1.6094 = 3.2188$。如果一个物种与其生境条件的平方马氏距离小于或等于这个值，则该物种通过过滤器。\n\n我们现在计算五个物种中每一个在地点$\\mathbf{x}=(1, -1)$的$D_i^2$值。\n\n物种 A: $\\boldsymbol{\\mu}_{A} = (1, -1)$, $\\mathbf{b}_{A} = (1, 1)$。\n生态位中心与该地点的环境完全重合。\n$$ D_A^2 = \\left(\\frac{1 - 1}{1}\\right)^2 + \\left(\\frac{-1 - (-1)}{1}\\right)^2 = 0^2 + 0^2 = 0 $$\n由于$0 \\le 2\\ln(5)$，物种A通过过滤器。其适宜度为$S_A = \\exp(0) = 1$。\n\n物种 B: $\\boldsymbol{\\mu}_{B} = (2, -1)$, $\\mathbf{b}_{B} = (1, 1)$。\n$$ D_B^2 = \\left(\\frac{1 - 2}{1}\\right)^2 + \\left(\\frac{-1 - (-1)}{1}\\right)^2 = (-1)^2 + 0^2 = 1 $$\n由于$1 \\le 2\\ln(5)$，物种B通过过滤器。其适宜度为$S_B = \\exp(-1/2) \\approx 0.607$。\n\n物种 C: $\\boldsymbol{\\mu}_{C} = (1, 1)$, $\\mathbf{b}_{C} = (1, 1)$。\n$$ D_C^2 = \\left(\\frac{1 - 1}{1}\\right)^2 + \\left(\\frac{-1 - 1}{1}\\right)^2 = 0^2 + (-2)^2 = 4 $$\n为了检查$4 \\le 2\\ln(5)$是否成立，我们可以检查$2 \\le \\ln(5)$，这等同于检查$e^2 \\le 5$。由于$e \\approx 2.718$，$e^2 \\approx 7.389$，大于$5$。因此，$4  2\\ln(5)$。物种C未通过过滤器。其适宜度为$S_C = \\exp(-4/2) = \\exp(-2) \\approx 0.135$。\n\n物种 D: $\\boldsymbol{\\mu}_{D} = (0, 0)$, $\\mathbf{b}_{D} = (1, 1)$。\n$$ D_D^2 = \\left(\\frac{1 - 0}{1}\\right)^2 + \\left(\\frac{-1 - 0}{1}\\right)^2 = 1^2 + (-1)^2 = 2 $$\n由于$2 \\le 2\\ln(5)$（因为$1 \\le \\ln(5)$，而此式成立是因为$e  5$），物种D通过过滤器。其适宜度为$S_D = \\exp(-2/2) = \\exp(-1) \\approx 0.368$。\n\n物种 E: $\\boldsymbol{\\mu}_{E} = (3, -3)$, $\\mathbf{b}_{E} = (2, 2)$。\n$$ D_E^2 = \\left(\\frac{1 - 3}{2}\\right)^2 + \\left(\\frac{-1 - (-3)}{2}\\right)^2 = \\left(\\frac{-2}{2}\\right)^2 + \\left(\\frac{2}{2}\\right)^2 = (-1)^2 + 1^2 = 2 $$\n与物种D一样，$D_E^2 = 2 \\le 2\\ln(5)$。物种E通过过滤器。其适宜度为$S_E = \\exp(-2/2) = \\exp(-1) \\approx 0.368$。\n\n满足非生物过滤器（适宜度 $\\ge 0.2$）的物种是A、B、D和E。\n预测的物种丰富度是这些物种的总数。\n物种数量 = $4$。", "answer": "$$\n\\boxed{4}\n$$", "id": "2477215"}, {"introduction": "群落的构建不仅受到环境的筛选，物种间的相互作用（如竞争）同样是关键的“过滤器”。本练习整合了这两个过程，将环境压力梯度引入经典的 Lotka-Volterra 竞争模型中 [@problem_id:2477218]。你将计算一个临界环境压力阈值 $E_{\\max}$，超过该阈值，竞争性共存便不再可能，从而深刻理解非生物和生物筛选如何协同作用，共同决定群落的最终成员。", "problem": "在一个沿土壤盐度梯度（一种环境筛选）组合形成的滨海沙丘植物群落中，两个竞争物种的动态由双物种 Lotka–Volterra 竞争系统建模。对于物种 $i \\in \\{1,2\\}$，令 $N_{i}(t)$ 表示其在时间 $t$ 的丰度，令 $r_{i}(E)$ 表示其在筛选强度 $E$ 下的内禀人均增长率。其动态为\n$$\n\\frac{dN_{i}}{dt} \\;=\\; N_{i}\\!\\left(r_{i}(E) \\;-\\; \\sum_{j=1}^{2} \\alpha_{ij} N_{j}\\right),\n$$\n其中 $\\alpha_{ij}$ 是定义了竞争矩阵 $A=\\begin{pmatrix}\\alpha_{11}  \\alpha_{12}\\\\ \\alpha_{21}  \\alpha_{22}\\end{pmatrix}$ 的竞争系数。假设环境筛选以线性方式抑制内禀增长率，\n$$\nr_{i}(E) \\;=\\; r_{i}^{(0)} \\;-\\; \\beta_{i}\\,E,\n$$\n其中 $\\beta_{i}  0$ 是物种特异性敏感度，$r_{i}^{(0)}  0$ 是基线增长率。两物种共存要求系统存在一个严格为正的内部平衡点 $\\mathbf{N}^{*}=(N_{1}^{*},N_{2}^{*})^{\\top}$。\n\n考虑以下与强种内限制和中等种间竞争相一致的参数化：\n$$\nA = \\begin{pmatrix} 1  0.3 \\\\ 0.2  1 \\end{pmatrix}, \\quad \\mathbf{r}^{(0)} = \\begin{pmatrix} 1.2 \\\\ 0.9 \\end{pmatrix}, \\quad \\boldsymbol{\\beta} = \\begin{pmatrix} 0.4 \\\\ 1.0 \\end{pmatrix}.\n$$\n将 $E \\geq 0$ 视为一个无量纲的筛选强度指数。\n\n仅使用 Lotka–Volterra 竞争框架中平衡和可行性的定义，推导出使得内部平衡点 $\\mathbf{N}^{*}(E)$ 存在且严格为正（即两物种共存）的最大筛选强度 $E_{\\max}$。将 $E_{\\max}$ 的最终答案表示为一个四舍五入到四位有效数字的无量纲实数。最终答案不应报告单位。", "solution": "该问题要求确定一个双物种 Lotka-Volterra 竞争系统能够维持一个严格为正（可行）的内部平衡点的最大环境筛选强度 $E_{\\max}$。对于物种 $i \\in \\{1, 2\\}$，该系统的动态由下式给出\n$$\n\\frac{dN_{i}}{dt} \\;=\\; N_{i}\\!\\left(r_{i}(E) \\;-\\; \\sum_{j=1}^{2} \\alpha_{ij} N_{j}\\right)\n$$\n内禀增长率 $r_{i}(E)$ 是环境筛选强度 $E$ 的函数：\n$$\nr_{i}(E) = r_{i}^{(0)} - \\beta_{i}E\n$$\n一个内部平衡点，记为 $\\mathbf{N}^{*} = (N_{1}^{*}, N_{2}^{*})^{\\top}$，是两个物种丰度均不为零的稳态解。为了找到这个平衡点，我们将时间导数 $\\frac{dN_i}{dt}$ 对 $i=1,2$ 设为 $0$。因为严格为正的平衡要求 $N_1^*  0$ 且 $N_2^*  0$，所以括号中的项必须为零：\n$$\nr_{1}(E) - \\alpha_{11} N_{1}^{*} - \\alpha_{12} N_{2}^{*} = 0 \\\\\nr_{2}(E) - \\alpha_{21} N_{1}^{*} - \\alpha_{22} N_{2}^{*} = 0\n$$\n这代表了一个关于变量 $N_{1}^{*}$ 和 $N_{2}^{*}$ 的二元线性方程组。写成矩阵形式为 $A \\mathbf{N}^{*} = \\mathbf{r}(E)$，其中：\n$$\nA = \\begin{pmatrix} \\alpha_{11}  \\alpha_{12}\\\\ \\alpha_{21}  \\alpha_{22} \\end{pmatrix}, \\quad \\mathbf{N}^{*} = \\begin{pmatrix} N_{1}^{*} \\\\ N_{2}^{*} \\end{pmatrix}, \\quad \\mathbf{r}(E) = \\begin{pmatrix} r_{1}(E) \\\\ r_{2}(E) \\end{pmatrix}\n$$\n假设竞争矩阵 $A$ 可逆，则平衡丰度的解由 $\\mathbf{N}^{*} = A^{-1} \\mathbf{r}(E)$ 给出。给定的参数为：\n$$\nA = \\begin{pmatrix} 1  0.3 \\\\ 0.2  1 \\end{pmatrix}, \\quad \\mathbf{r}^{(0)} = \\begin{pmatrix} 1.2 \\\\ 0.9 \\end{pmatrix}, \\quad \\boldsymbol{\\beta} = \\begin{pmatrix} 0.4 \\\\ 1.0 \\end{pmatrix}\n$$\n首先，我们计算 $A$ 的行列式：\n$$\n\\det(A) = \\alpha_{11}\\alpha_{22} - \\alpha_{12}\\alpha_{21} = (1)(1) - (0.3)(0.2) = 1 - 0.06 = 0.94\n$$\n由于 $\\det(A) \\neq 0$，矩阵 $A$ 是可逆的。其逆矩阵为：\n$$\nA^{-1} = \\frac{1}{\\det(A)}\\begin{pmatrix} \\alpha_{22}  -\\alpha_{12}\\\\ -\\alpha_{21}  \\alpha_{11} \\end{pmatrix} = \\frac{1}{0.94}\\begin{pmatrix} 1  -0.3\\\\ -0.2  1 \\end{pmatrix}\n$$\n现在可以将平衡丰度 $N_{1}^{*}$ 和 $N_{2}^{*}$ 表示为 $E$ 的函数：\n$$\n\\begin{pmatrix} N_{1}^{*}(E) \\\\ N_{2}^{*}(E) \\end{pmatrix} = \\frac{1}{0.94}\\begin{pmatrix} 1  -0.3\\\\ -0.2  1 \\end{pmatrix} \\begin{pmatrix} r_{1}(E) \\\\ r_{2}(E) \\end{pmatrix}\n$$\n增长率为 $r_{1}(E) = 1.2 - 0.4E$ 和 $r_{2}(E) = 0.9 - 1.0E$。将它们代入 $N_{1}^{*}(E)$ 和 $N_{2}^{*}(E)$ 的表达式中：\n$$\nN_{1}^{*}(E) = \\frac{1}{0.94} \\left[ (1) r_{1}(E) - (0.3) r_{2}(E) \\right] = \\frac{1}{0.94} \\left[ (1.2 - 0.4E) - 0.3(0.9 - E) \\right]\n$$\n$$\nN_{2}^{*}(E) = \\frac{1}{0.94} \\left[ (-0.2) r_{1}(E) + (1) r_{2}(E) \\right] = \\frac{1}{0.94} \\left[ -0.2(1.2 - 0.4E) + (0.9 - E) \\right]\n$$\n化简方括号内的表达式：\n对于 $N_{1}^{*}(E)$：\n$$\n(1.2 - 0.4E) - (0.27 - 0.3E) = 1.2 - 0.27 - 0.4E + 0.3E = 0.93 - 0.1E\n$$\n对于 $N_{2}^{*}(E)$：\n$$\n(-0.24 + 0.08E) + (0.9 - E) = 0.9 - 0.24 + 0.08E - E = 0.66 - 0.92E\n$$\n因此，平衡丰度为：\n$$\nN_{1}^{*}(E) = \\frac{0.93 - 0.1E}{0.94} \\\\\nN_{2}^{*}(E) = \\frac{0.66 - 0.92E}{0.94}\n$$\n共存的条件是平衡点严格为正，即 $N_{1}^{*}(E)  0$ 且 $N_{2}^{*}(E)  0$。由于分母 $0.94$ 是正数，这要求分子也为正：\n1. $0.93 - 0.1E  0 \\implies 0.93  0.1E \\implies E  \\frac{0.93}{0.1} \\implies E  9.3$\n2. $0.66 - 0.92E  0 \\implies 0.66  0.92E \\implies E  \\frac{0.66}{0.92}$\n\n两个条件必须同时满足才能共存。因此，$E$ 必须小于这两个上界的最小值：\n$$\nE  \\min\\left(9.3, \\frac{0.66}{0.92}\\right)\n$$\n计算第二个上界：$\\frac{0.66}{0.92} \\approx 0.71739$。这个值明显小于 9.3。因此，对 $E$ 的有效约束是由第二个条件施加的，该条件与物种2的生存能力有关。允许存在严格为正的内部平衡点的 $E$ 的范围是 $0 \\le E  \\frac{0.66}{0.92}$。\n问题要求的是可能实现共存的最大筛选强度 $E_{\\max}$。这对应于 $E$ 的有效范围的上确界：\n$$\nE_{\\max} = \\frac{0.66}{0.92} = \\frac{33}{46}\n$$\n数值必须四舍五入到四位有效数字：\n$$\nE_{\\max} \\approx 0.7173913... \\approx 0.7174\n$$", "answer": "$$\\boxed{0.7174}$$", "id": "2477218"}, {"introduction": "在观测到一个群落结构时，我们如何判断它是由确定性的生态位过程塑造，还是仅仅是随机过程的结果？为了回答这个问题，生态学家使用中性模型作为零假设。本练习将引导你推导并应用一个核心的中性群落模型——狄利克雷-多项分布（Dirichlet-multinomial distribution），来计算观测到一个特定物种丰度向量的概率 [@problem_id:2477273]。这个过程将帮助你理解如何利用统计推断来检验群落组建的潜在机制。", "problem": "在一个固定面积样地中，我们对一个陆生植物群落进行监测，通过普查记录了 $S$ 个功能相似物种中每个物种的丰度。在一个群落构建的中性取样模型下，物种被假定为功能等价的，仅在其相对丰度上有所不同。设未知的相对丰度物种组成向量为 $\\mathbf{p} = (p_{1},\\dots,p_{S})$，其中 $\\sum_{i=1}^{S} p_{i} = 1$ 且 $p_{i} \\ge 0$。假设 $\\mathbf{p}$ 的先验分布为参数是 $\\boldsymbol{\\alpha} = (\\alpha_{1},\\dots,\\alpha_{S})$ 的狄利克雷分布 (Dirichlet distribution)，并在给定 $\\mathbf{p}$ 的条件下，从多项分布中抽取一个包含 $N$ 个个体的样本，得到观测到的物种丰度向量 $\\mathbf{n} = (n_{1},\\dots,n_{S})$，其中 $\\sum_{i=1}^{S} n_{i} = N$。\n\n仅从狄利克雷密度和多项概率质量函数的标准定义出发，通过对 $\\mathbf{p}$ 进行积分，推导出边际概率（似然）$\\mathcal{L}(\\boldsymbol{\\alpha}\\,|\\,\\mathbf{n}) = \\Pr(\\mathbf{n}\\,|\\,\\boldsymbol{\\alpha})$ 的一个闭式表达式。\n\n然后，对于 $S=3$、参数 $\\boldsymbol{\\alpha} = (2,3,1)$、总个体数 $N = 10$ 和观测计数 $\\mathbf{n} = (4,5,1)$，对此似然进行数值计算。将你最终的数值答案表示为保留四位有效数字的小数。\n\n最后，用一两句话简要解释，在多个样地中，观测到的物种丰度向量与该似然预期值之间的系统性偏差如何能表明存在非中性构建过程，例如环境过滤或生态位分化。你的解释不需要任何计算，也不会影响上面要求的数值答案。", "solution": "此问题经核实具有科学依据，提法明确且客观。这是贝叶斯统计学应用于生态模型中的一个标准问题。我现在开始解答。\n\n目标是推导狄利克雷-多项模型的边际似然 $\\mathcal{L}(\\boldsymbol{\\alpha}\\,|\\,\\mathbf{n}) = \\Pr(\\mathbf{n}\\,|\\,\\boldsymbol{\\alpha})$，然后对一组特定参数进行求值。\n\n该模型由两个部分定义：\n$1$. 物种相对丰度 $\\mathbf{p} = (p_{1},\\dots,p_{S})$ 的先验分布，这是一个参数向量为 $\\boldsymbol{\\alpha} = (\\alpha_{1},\\dots,\\alpha_{S})$ 的狄利克雷分布。其概率密度函数 (PDF) 由以下公式给出：\n$$\n\\Pr(\\mathbf{p}\\,|\\,\\boldsymbol{\\alpha}) = \\frac{\\Gamma\\left(\\sum_{i=1}^{S} \\alpha_{i}\\right)}{\\prod_{i=1}^{S} \\Gamma(\\alpha_{i})} \\prod_{i=1}^{S} p_{i}^{\\alpha_{i}-1}\n$$\n该分布定义在单纯形上，其中对所有 $i$ 都有 $\\sum_{i=1}^{S} p_{i} = 1$ 和 $p_{i} \\ge 0$。我们将归一化常数（即多元贝塔函数）表示为 $B(\\boldsymbol{\\alpha}) = \\frac{\\prod_{i=1}^{S} \\Gamma(\\alpha_{i})}{\\Gamma\\left(\\sum_{i=1}^{S} \\alpha_{i}\\right)}$。\n\n$2$. 在给定总样本量 $N$ 和相对丰度 $\\mathbf{p}$ 的情况下，观测到的物种计数 $\\mathbf{n} = (n_{1},\\dots,n_{S})$ 的条件分布。这是一个多项分布，其概率质量函数 (PMF) 为：\n$$\n\\Pr(\\mathbf{n}\\,|\\,N, \\mathbf{p}) = \\frac{N!}{\\prod_{i=1}^{S} n_{i}!} \\prod_{i=1}^{S} p_{i}^{n_{i}}\n$$\n其中 $\\sum_{i=1}^{S} n_{i} = N$。\n\n边际似然 $\\Pr(\\mathbf{n}\\,|\\,\\boldsymbol{\\alpha})$ 是通过将似然 $\\Pr(\\mathbf{n}\\,|\\,\\mathbf{p})$ 和先验 $\\Pr(\\mathbf{p}\\,|\\,\\boldsymbol{\\alpha})$ 的乘积对 $\\mathbf{p}$ 的所有可能值进行积分得到的。这是全概率定律在连续随机变量上的应用。\n$$\n\\Pr(\\mathbf{n}\\,|\\,\\boldsymbol{\\alpha}) = \\int_{\\mathbf{p}} \\Pr(\\mathbf{n}\\,|\\,N, \\mathbf{p}) \\Pr(\\mathbf{p}\\,|\\,\\boldsymbol{\\alpha}) \\,d\\mathbf{p}\n$$\n积分范围是标准的 $(S-1)$-单纯形。\n\n代入 PMF 和 PDF 的表达式：\n$$\n\\Pr(\\mathbf{n}\\,|\\,\\boldsymbol{\\alpha}) = \\int_{\\mathbf{p}} \\left( \\frac{N!}{\\prod_{i=1}^{S} n_{i}!} \\prod_{i=1}^{S} p_{i}^{n_{i}} \\right) \\left( \\frac{\\Gamma\\left(\\sum_{i=1}^{S} \\alpha_{i}\\right)}{\\prod_{i=1}^{S} \\Gamma(\\alpha_{i})} \\prod_{i=1}^{S} p_{i}^{\\alpha_{i}-1} \\right) \\,d\\mathbf{p}\n$$\n我们可以将不依赖于 $\\mathbf{p}$ 的项分组并移到积分符号外部：\n$$\n\\Pr(\\mathbf{n}\\,|\\,\\boldsymbol{\\alpha}) = \\frac{N!}{\\prod_{i=1}^{S} n_{i}!} \\frac{\\Gamma\\left(\\sum_{i=1}^{S} \\alpha_{i}\\right)}{\\prod_{i=1}^{S} \\Gamma(\\alpha_{i})} \\int_{\\mathbf{p}} \\left( \\prod_{i=1}^{S} p_{i}^{n_{i}} \\right) \\left( \\prod_{i=1}^{S} p_{i}^{\\alpha_{i}-1} \\right) \\,d\\mathbf{p}\n$$\n合并积分内的乘积项：\n$$\n\\Pr(\\mathbf{n}\\,|\\,\\boldsymbol{\\alpha}) = \\frac{N!}{\\prod_{i=1}^{S} n_{i}!} \\frac{\\Gamma\\left(\\sum_{i=1}^{S} \\alpha_{i}\\right)}{\\prod_{i=1}^{S} \\Gamma(\\alpha_{i})} \\int_{\\mathbf{p}} \\prod_{i=1}^{S} p_{i}^{(n_{i}+\\alpha_{i})-1} \\,d\\mathbf{p}\n$$\n积分内的表达式 $\\prod_{i=1}^{S} p_{i}^{(n_{i}+\\alpha_{i})-1}$ 是另一个狄利克雷分布的核，其更新后的参数为 $\\boldsymbol{\\alpha}' = \\boldsymbol{\\alpha} + \\mathbf{n} = (\\alpha_{1}+n_{1}, \\dots, \\alpha_{S}+n_{S})$。该核在单纯形上的积分等于这个新狄利克雷分布的归一化常数，也就是其 PDF 前面系数的倒数。\n$$\n\\int_{\\mathbf{p}} \\prod_{i=1}^{S} p_{i}^{(n_{i}+\\alpha_{i})-1} \\,d\\mathbf{p} = \\frac{\\prod_{i=1}^{S} \\Gamma(n_{i}+\\alpha_{i})}{\\Gamma\\left(\\sum_{i=1}^{S} (n_{i}+\\alpha_{i})\\right)}\n$$\n我们知道 $\\sum_{i=1}^{S} n_{i} = N$，所以分母中的伽马函数变为 $\\Gamma\\left(N + \\sum_{i=1}^{S} \\alpha_{i}\\right)$。\n\n将此结果代回我们的边际似然表达式中：\n$$\n\\Pr(\\mathbf{n}\\,|\\,\\boldsymbol{\\alpha}) = \\frac{N!}{\\prod_{i=1}^{S} n_{i}!} \\frac{\\Gamma\\left(\\sum_{i=1}^{S} \\alpha_{i}\\right)}{\\prod_{i=1}^{S} \\Gamma(\\alpha_{i})} \\frac{\\prod_{i=1}^{S} \\Gamma(n_{i}+\\alpha_{i})}{\\Gamma\\left(N + \\sum_{i=1}^{S} \\alpha_{i}\\right)}\n$$\n这就是边际概率的闭式表达式，也称为狄利克雷-多项分布。我们记 $A_0 = \\sum_{i=1}^S \\alpha_i$。一种常见的写法是：\n$$\n\\Pr(\\mathbf{n}\\,|\\,\\boldsymbol{\\alpha}) = \\frac{N!}{\\prod_{i=1}^{S}n_{i}!} \\frac{B(\\boldsymbol{\\alpha}+\\mathbf{n})}{B(\\boldsymbol{\\alpha})} = \\binom{N}{\\mathbf{n}} \\frac{\\Gamma(A_0)}{\\Gamma(N+A_0)} \\prod_{i=1}^{S} \\frac{\\Gamma(n_i+\\alpha_i)}{\\Gamma(\\alpha_i)}\n$$\n第一种公式可能最便于计算。\n\n现在，我们对给定值进行计算：$S=3$，$\\boldsymbol{\\alpha} = (2,3,1)$，$N = 10$，$\\mathbf{n} = (4,5,1)$。\n首先，我们计算必要的和与分量：\n多项式系数：\n$$ \\frac{N!}{\\prod_{i=1}^{S} n_{i}!} = \\frac{10!}{4!\\,5!\\,1!} = \\frac{3628800}{(24)(120)(1)} = \\frac{3628800}{2880} = 1260 $$\n先验参数之和：\n$$ \\sum_{i=1}^{S} \\alpha_{i} = 2+3+1 = 6 $$\n伽马函数的参数：\n$$ \\boldsymbol{\\alpha}+\\mathbf{n} = (2+4, 3+5, 1+1) = (6, 8, 2) $$\n$$ N + \\sum_{i=1}^{S} \\alpha_{i} = 10 + 6 = 16 $$\n\n现在，我们利用整数 $k$ 的性质 $\\Gamma(k) = (k-1)!$ 来组合这些项：\n$$ \\Gamma\\left(\\sum_{i=1}^{S} \\alpha_{i}\\right) = \\Gamma(6) = 5! = 120 $$\n$$ \\prod_{i=1}^{S} \\Gamma(\\alpha_{i}) = \\Gamma(2)\\Gamma(3)\\Gamma(1) = (1!)(2!)(0!) = (1)(2)(1) = 2 $$\n$$ \\prod_{i=1}^{S} \\Gamma(n_{i}+\\alpha_{i}) = \\Gamma(6)\\Gamma(8)\\Gamma(2) = (5!)(7!)(1!) = (120)(5040)(1) = 604800 $$\n$$ \\Gamma\\left(N + \\sum_{i=1}^{S} \\alpha_{i}\\right) = \\Gamma(16) = 15! $$\n\n将这些值代入推导出的公式中：\n$$\n\\Pr(\\mathbf{n}\\,|\\,\\boldsymbol{\\alpha}) = \\left(\\frac{10!}{4!\\,5!\\,1!}\\right) \\frac{\\Gamma(6)}{\\Gamma(2)\\Gamma(3)\\Gamma(1)} \\frac{\\Gamma(6)\\Gamma(8)\\Gamma(2)}{\\Gamma(16)}\n$$\n$$\n\\Pr(\\mathbf{n}\\,|\\,\\boldsymbol{\\alpha}) = (1260) \\left(\\frac{5!}{1!\\,2!\\,0!}\\right) \\left(\\frac{5!\\,7!\\,1!}{15!}\\right) = (1260) \\left(\\frac{120}{2}\\right) \\left(\\frac{(120)(5040)}{15!}\\right)\n$$\n$$\n\\Pr(\\mathbf{n}\\,|\\,\\boldsymbol{\\alpha}) = (1260)(60) \\frac{604800}{15!} = \\frac{75600 \\times 604800}{15!}\n$$\n为简化起见，我们使用阶乘来计算：\n$$\n\\Pr(\\mathbf{n}\\,|\\,\\boldsymbol{\\alpha}) = \\frac{10!}{4!\\,5!} \\times \\frac{5!}{15!} \\times \\frac{5!\\,7!}{2} = \\frac{10! \\times 5! \\times 7!}{4! \\times 15! \\times 2}\n$$\n使用 $\\frac{10!}{15!} = \\frac{1}{15 \\times 14 \\times 13 \\times 12 \\times 11}$ 和 $5! = 120 = 5 \\times 4!$：\n$$\n\\Pr(\\mathbf{n}\\,|\\,\\boldsymbol{\\alpha}) = \\frac{5 \\times 4! \\times 7!}{4! \\times (15 \\times 14 \\times 13 \\times 12 \\times 11) \\times 2} = \\frac{5 \\times 7!}{ (15 \\times 14 \\times 13 \\times 12 \\times 11) \\times 2}\n$$\n$$\n\\Pr(\\mathbf{n}\\,|\\,\\boldsymbol{\\alpha}) = \\frac{5 \\times 5040}{ (15 \\times 14 \\times 13 \\times 12 \\times 11) \\times 2} = \\frac{25200}{ (360360) \\times 2} = \\frac{25200}{720720} = \\frac{5}{143}\n$$\n这证实了之前的计算。现在，我们计算小数值并四舍五入到四位有效数字。\n$$ \\frac{5}{143} \\approx 0.034965034965... $$\n第一位有效数字是 $3$。接下来的三位是 $4$, $9$, $6$。$6$ 后面的数字是 $5$，所以我们将 $6$ 向上取整。\n结果是 $0.03497$。\n\n最后，关于对此模型偏差的解释：如果观测到的丰度数据在该中性模型下持续表现出较低的似然，这种系统性偏差将意味着物种并不像假设的那样功能等价。这表明确定性过程，例如偏好某些性状物种的环境过滤或由种间竞争引起的生态位分化，正在构建该群落。", "answer": "$$\\boxed{0.03497}$$", "id": "2477273"}]}