{"hands_on_practices": [{"introduction": "景观遗传学的一个基本目标是量化基因流（使种群同质化）和遗传漂变（导致种群分化）之间的平衡。固定指数 $F_{ST}$ 是衡量这种分化的指标。本练习 [@problem_id:2501749] 要求您使用经典的岛屿模型，将观测到的 $F_{ST}$ 值转化为每代有效迁移个体数 $N_e m$ 的估计值，这是理解种群连通性的关键参数。", "problem": "一个植物异质种群占据了一个由许多斑块组成的景观，这些斑块通过花粉和种子传播相连。对许多斑块的中性基因座进行遗传抽样，得到亚群间的标准化固定指数（F-统计量）估计值为 $F_{ST}=0.05$。假设亚群数量众多，具有相等的有效种群大小（有效种群大小, $N_{e}$），每代以一个对称的分数 $m$（每代中，一个亚群中新移民基因所占的比例）交换迁移个体，并且系统在经典的无限岛屿模型下，具有离散世代和中性选择，处于迁移-漂变平衡状态。一项独立的种群统计学研究估计每个亚群的 $N_{e}=500$。\n\n从岛屿模型中中性等位基因的核心漂变-迁移平衡框架以及 $F_{ST}$ 作为亚群间等位基因频率的标准化方差的定义出发，推导出一个仅用 $F_{ST}$ 表示的复合迁移参数 $N_{e}m$ 的表达式。然后，对 $F_{ST}=0.05$ 的情况进行求值。最后，基于岛屿模型中遗传漂变和基因流的基本原理，阐明在该系统中基因流是否可能足够强以对抗局部遗传漂变，并用一两句话说明你的理由。报告 $N_{e}m$ 的最终数值；无需单位，也无需四舍五入。", "solution": "该问题要求在无限岛屿模型处于迁移-漂变平衡的假设下，从固定指数 $F_{ST}$ 推导出复合参数 $N_{e}m$。然后，要求进行数值评估，并在基因流和遗传漂变之间平衡的背景下解释结果。\n\n核心原理是作用于中性等位基因的两种相反进化力量之间的平衡。在有效种群大小（$N_{e}$）有限的亚群内，遗传漂变导致等位基因频率分化，增加了它们之间的遗传分化。由迁移率（$m$）代表的基因流从一个共同的迁移库中引入等位基因，这使等位基因频率均质化并抵消了分化。标准化固定指数 $F_{ST}$ 是这种分化的一个度量。在平衡状态下，由漂变产生分化的速率与由基因流消除分化的速率完全相等。\n\n我们可以通过考虑从同一亚群中抽取的两个等位基因的同源概率（$F_{ST}$）来形式化这种平衡。遗传漂变增加了这个概率。在一个有效大小为 $N_{e}$ 的二倍体种群中，在没有其他力量作用的情况下，经过一代随机交配，同源概率的增加量由变化 $\\Delta F_{\\text{drift}}$ 给出。对于下一代抽取的两个等位基因，如果它们是同一个亲本等位基因的拷贝（概率为 $\\frac{1}{2N_{e}}$），或者它们是不同亲本等位基因的拷贝（概率为 $1 - \\frac{1}{2N_{e}}$）且这些亲本等位基因在上一代中已经同源（概率为 $F_{ST}$），那么它们就是同源的。新的概率是 $F' = \\frac{1}{2N_{e}} + (1 - \\frac{1}{2N_{e}})F_{ST}$。因此，由漂变引起的变化是 $\\Delta F_{\\text{drift}} = F' - F_{ST} = \\frac{1 - F_{ST}}{2N_{e}}$。\n\n基因流降低了同源概率。在岛屿模型中，任何亚群中都有比例为 $m$ 的等位基因是来自整个异质种群的迁移者。我们假设迁移来的等位基因是从一个概念上无限大的基因库中抽取的，因此它们在到达时彼此之间或与本地等位基因之间永远不会是同源的。要使从一个亚群中抽样的两个等位基因因在该亚群内的祖先关系而同源，两者都必须是非迁移者。这个概率是 $(1-m)^{2}$。因此，基因流每代将局部同源概率降低一个因子 $(1-m)^{2}$。对于小的 $m$，我们可以将这个因子近似为 $(1-m)^{2} \\approx 1-2m$。因此，由迁移引起的 $F_{ST}$ 的变化大约是 $\\Delta F_{\\text{migration}} \\approx -2m F_{ST}$。\n\n在平衡状态下，净变化为零：$\\Delta F_{\\text{drift}} + \\Delta F_{\\text{migration}} = 0$。\n$$\n\\frac{1 - F_{ST}}{2N_{e}} - 2m F_{ST} \\approx 0\n$$\n$$\n\\frac{1 - F_{ST}}{2N_{e}} \\approx 2m F_{ST}\n$$\n重新整理这个方程以求解 $F_{ST}$，我们得到：\n$$\n1 - F_{ST} \\approx 4N_{e}m F_{ST}\n$$\n$$\n1 \\approx F_{ST} + 4N_{e}m F_{ST} = F_{ST}(1 + 4N_{e}m)\n$$\n这得出了经典的近似关系式：\n$$\nF_{ST} \\approx \\frac{1}{1 + 4N_{e}m}\n$$\n这个公式是群体遗传学的基础，它直接将遗传结构（$F_{ST}$）与漂变（与 $N_{e}$ 相关）和基因流（$m$）的种群过程联系起来。\n\n第一个任务是推导出一个仅用 $F_{ST}$ 表示的复合参数 $N_{e}m$ 的表达式。我们重新整理上述表达式：\n$$\n1 + 4N_{e}m = \\frac{1}{F_{ST}}\n$$\n$$\n4N_{e}m = \\frac{1}{F_{ST}} - 1 = \\frac{1 - F_{ST}}{F_{ST}}\n$$\n$$\nN_{e}m = \\frac{1 - F_{ST}}{4F_{ST}}\n$$\n这就是所求的表达式。所提供的 $N_{e} = 500$ 的值是一致的种群统计信息，但对于这部分的计算并非必需，因为该计算完全基于 $F_{ST}$ 中编码的遗传数据。\n\n第二个任务是对给定的值 $F_{ST} = 0.05$ 评估此表达式。\n$$\nN_{e}m = \\frac{1 - 0.05}{4(0.05)} = \\frac{0.95}{0.20} = 4.75\n$$\n复合参数 $N_{e}m$ 代表每代进入一个亚群的有效迁移个体数。\n\n最后，我们必须评估基因流是否足够强以对抗局部遗传漂变。由 Sewall Wright 提出的一个广泛使用的经验法则是，如果 $N_e m > 1$，基因流就足够强大以防止亚群之间出现显著分化；而如果 $N_e m  1$，则漂变占主导地位，导致显著的趋异。在这个系统中，$N_{e}m = 4.75$，显著大于 $1$。因此，基因流确实足够强大，足以克服局部遗传漂变的分化效应，从而维持一个相互连接的异质种群，而不是一个由孤立、趋异的亚群组成的集合。", "answer": "$$\n\\boxed{4.75}\n$$", "id": "2501749"}, {"introduction": "基因流在空间上的分布很少是均匀的，它受到景观特征的引导和限制。为了对此进行建模，我们可以将景观表示为一个对移动具有“阻力”的表面。本练习 [@problem_id:2501802] 通过要求您计算最简单的连通性形式——最小成本路径，并思考更复杂的模型（如电路理论）如何捕捉更全面的基因流视图，为您提供了对这一概念的基础性认识。", "problem": "一个沿一维生境廊道扩散的生物体，由一个包含三个线性排列的相邻单元的栅格表示，各单元的阻力（无量纲的移动成本）从左到右依次为 $\\left(1, 10, 1\\right)$。起点和终点分别固定在最左侧和最右侧单元的中心。移动仅限于相邻单元（在此一维设定中为四邻域连通性），从单元 $i$ 移动到相邻单元 $j$ 的一步成本定义为两个单元阻力的算术平均值乘以它们中心之间的欧几里得距离。每个方形单元的边长为 $1$，因此每步的长度为 $1$。\n\n从最小成本路径距离的定义出发——即在所有允许路径中，沿某条路径的步长成本之和的最小值——计算两个端点之间的最小成本路径距离。请用一个精确的数值（无量纲）表示最终答案。无需四舍五入。\n\n在您的解答中，还需从第一性原理出发，论证为何在一般情况下，当二维嵌入中存在备选的并行路径时，基于电路的距离（根据阻力景观上的电路网络类比计算出的等效电阻）会低于仅由中心高成本单元所暗示的数值，尽管在这个线性的三单元廊道中只有一条路径。您的论证必须从电阻的串并联规则和等效电阻的最小能量表征开始，并定性解释额外的并行路径如何通过分流电流来降低等效电阻。最终报告的答案应仅为上文指定的最小成本路径距离。", "solution": "我们从栅格景观中最小成本路径距离的定义开始。一条路径 $\\mathcal{P}$ 是连接源点与终点的一系列相邻单元。从单元 $i$ 移动到相邻单元 $j$ 的一步成本由下式给出：\n$$\nc_{ij} \\;=\\; \\frac{r_{i}+r_{j}}{2}\\, d_{ij},\n$$\n其中 $r_{i}$ 和 $r_{j}$ 是单元阻力，$d_{ij}$ 是单元中心之间的欧几里得距离。路径 $\\mathcal{P}$ 的累积成本是沿路径中各步 $(i,j)\\in \\mathcal{P}$ 的成本 $c_{ij}$ 的总和。最小成本路径距离是连接端点的所有允许路径中，该总和的最小值。\n\n在这个由三个单元组成、端点分别位于最左侧和最右侧单元中心的一维廊道中，只存在一条允许的路径，该路径包含两步：从左侧单元到中间单元，以及从中间单元到右侧单元。设阻力分别为 $r_{L}=1$、$r_{C}=10$ 和 $r_{R}=1$。单元边长为 $1$，因此每步的长度为 $d_{LC}=1$ 和 $d_{CR}=1$。\n\n计算每步的成本：\n- 从左侧到中间的步长：\n$$\nc_{LC} \\;=\\; \\frac{r_{L}+r_{C}}{2}\\, d_{LC} \\;=\\; \\frac{1+10}{2}\\cdot 1 \\;=\\; \\frac{11}{2}.\n$$\n- 从中间到右侧的步长：\n$$\nc_{CR} \\;=\\; \\frac{r_{C}+r_{R}}{2}\\, d_{CR} \\;=\\; \\frac{10+1}{2}\\cdot 1 \\;=\\; \\frac{11}{2}.\n$$\n\n该唯一路径的累积成本为\n$$\nC_{\\text{LCP}} \\;=\\; c_{LC} + c_{CR} \\;=\\; \\frac{11}{2} + \\frac{11}{2} \\;=\\; 11.\n$$\n因为在一维的三单元链中没有其他路径，所以这条唯一路径自然就是最小成本路径，因此最小成本路径距离等于 $11$。\n\n现在，我们来论证为何当二维嵌入中存在备选的并行路径时，基于电路的距离（等效电阻）会低于仅由中心高成本单元所暗示的数值，尽管在这个线性链中并不存在并行路径。电路网络类比通过在单元中心设置节点，并根据景观的阻力场为相邻节点之间分配电导，来模拟在阻力景观中的移动。当只有一条串联链连接端点时，等效电阻是串联各边电阻的总和，这与单一路径的约束是一致的：\n$$\nR_{\\text{series}} \\;=\\; R_{1} + R_{2} + \\cdots,\n$$\n因此，在严格的一维链中，除了求和之外没有其他方式可以降低总电阻。然而，在具有多条可能路径的二维景观中，额外的连接会形成并行或网状结构。对于并联电阻，其组合电阻 $R_{\\parallel}$ 遵循以下公式：\n$$\n\\frac{1}{R_{\\parallel}} \\;=\\; \\sum_{k} \\frac{1}{R_{k}},\n$$\n这意味着\n$$\nR_{\\parallel} \\;\\; \\min_{k} R_{k}.\n$$\n因此，任何增加的并行通路都会相对于任何单一路径降低整体的等效电阻，因为总电导通过求和而增加。\n\n更一般地，两个边界节点之间的等效电阻可以通过 Thomson 原理（也称为最小能量原理）来表征：在所有满足内部节点流量守恒的、从源到汇的单位电流流 $\\mathbf{f}$ 中，等效电阻 $R_{\\text{eff}}$ 等于最小耗散功率，\n$$\nR_{\\text{eff}} \\;=\\; \\min_{\\mathbf{f}} \\sum_{e} r_{e}\\, f_{e}^{2},\n$$\n其中 $r_{e}$ 和 $f_{e}$ 分别是边 $e$ 上的电阻和电流。增加备选路径为单位电流的分配引入了额外的自由度，允许电流避开或部分绕过高阻力边，从而降低该二次型的最小值。这是凸性和 Rayleigh 单调性定律的直接结果：增加任何边的电阻都不会使 $R_{\\text{eff}}$ 减小，而增加一条具有有限电导的备选边（或路径）也不会使 $R_{\\text{eff}}$ 增大。因此，在具有多条路径的二维景观中，基于电路的距离通常会产生一个比单一高成本瓶颈所暗示的要低的等效电阻，因为电流会在各路径间分配以减少总能量耗散。在当前的一维三单元廊道中，这种分流是不可能的，因此最小成本路径和基于电路的距离都受制于必须穿越中心高阻力区域这一条件，其结果值在一个一致的边阻力参数化下等于串联总和。", "answer": "$$\\boxed{11}$$", "id": "2501802"}, {"introduction": "除了理解宏观格局外，景观遗传学还使我们能够对特定个体进行推断，例如识别近期迁移的个体。通过利用种群间的等位基因频率差异，我们可以评估给定个体的基因型起源于某个源种群而非另一个的可能性。本练习 [@problem_id:2501782] 将指导您掌握基于似然性的个体溯源测试的核心逻辑，这是研究扩散和连通性的强大工具。", "problem": "在一个包含$2$个亚群（种群$1$和种群$2$）的异质景观中，您正在进行一项归属检验，以评估在种群$1$中抽样的某个目标个体是否是来自种群$2$的近期迁移者。考虑$3$个独立的、共显性的、具有等位基因$A$和$a$的双等位基因座。对于这个简化的例子，假设在这$3$个基因座的每一个上，每个种群内的等位基因$A$频率在各个基因座之间是相同的：在种群$1$中，等位基因$A$的频率为$p_{1}=0.2$，而在种群$2$中，等位基因$A$的频率为$p_{2}=0.8$。该目标个体的多位点基因型为$AA/AA/AA$。\n\n假设如下：\n- 每个种群内部符合哈迪-温伯格平衡（Hardy–Weinberg equilibrium, HWE）。\n- 基因座之间存在连锁平衡（给定来源种群，基因座是条件独立的）。\n- 等位基因频率的估计值已知且无误差，并如上所述同样适用于每个基因座。\n- 该个体属于各种群的先验概率相等。\n- 对数似然比定义为：在种群$2$下的多位点基因型似然与在种群$1$下的多位点基因型似然之比的自然对数。\n\n仅使用这些假设和标准定义，计算该个体源自种群$2$而非种群$1$这一假说的对数似然比（以自然对数为单位）。将最终数值答案四舍五入至四位有效数字。提供一个不带单位的实数。", "solution": "令$G$表示目标个体的多位点基因型，即$AA/AA/AA$。目标是计算对数似然比$\\Lambda$，其定义为：\n$$\n\\Lambda = \\ln \\left( \\frac{L(G | \\text{Pop } 2)}{L(G | \\text{Pop } 1)} \\right)\n$$\n其中，$L(G | \\text{Pop } i)$是在给定个体源自种群$i$的条件下，观测到基因型$G$的似然。\n\n首先，我们确定单个基因座上基因型的似然。单基因座基因型为$AA$。问题陈述，每个种群内部均符合哈迪-温伯格平衡 (HWE)。在HWE下，纯合基因型$AA$的期望频率是等位基因$A$频率的平方。\n令$p_i$为种群$i$中等位基因$A$的频率。在给定个体来自种群$i$的条件下，在单个基因座上观测到基因型$AA$的似然为：\n$$\nL(\\text{genotype } AA | \\text{Pop } i) = p_i^2\n$$\n\n接下来，我们使用给定的等位基因频率$p_1 = 0.2$和$p_2 = 0.8$来计算每个种群的单基因座似然。\n对于种群$1$：\n$$\nL(\\text{genotype } AA | \\text{Pop } 1) = p_1^2 = (0.2)^2 = 0.04\n$$\n对于种群$2$：\n$$\nL(\\text{genotype } AA | \\text{Pop } 2) = p_2^2 = (0.8)^2 = 0.64\n$$\n\n现在，我们确定多位点基因型$G = AA/AA/AA$的似然。问题陈述存在连锁平衡，这意味着基因座之间在统计上是独立的。因此，多位点基因型的似然是$3$个独立基因座上各自基因型似然的乘积。\n对于来自种群$i$的个体，其多位点似然为：\n$$\nL(G | \\text{Pop } i) = L(\\text{genotype } AA | \\text{Pop } i) \\times L(\\text{genotype } AA | \\text{Pop } i) \\times L(\\text{genotype } AA | \\text{Pop } i) = \\left( L(\\text{genotype } AA | \\text{Pop } i) \\right)^3\n$$\n代入单基因座似然表达式，我们得到：\n$$\nL(G | \\text{Pop } i) = (p_i^2)^3 = p_i^6\n$$\n\n我们现在可以计算每个种群的多位点似然。\n对于种群$1$：\n$$\nL(G | \\text{Pop } 1) = p_1^6 = (0.2)^6\n$$\n对于种群$2$：\n$$\nL(G | \\text{Pop } 2) = p_2^6 = (0.8)^6\n$$\n注意，先验概率相等的假设与似然比的计算无关，尽管它对于计算归属的后验概率是必要的。\n\n似然比$R$是这两个似然的比值：\n$$\nR = \\frac{L(G | \\text{Pop } 2)}{L(G | \\text{Pop } 1)} = \\frac{p_2^6}{p_1^6} = \\left(\\frac{p_2}{p_1}\\right)^6\n$$\n代入给定值：\n$$\nR = \\left(\\frac{0.8}{0.2}\\right)^6 = 4^6 = 4096\n$$\n\n最后，我们通过取$R$的自然对数来计算对数似然比$\\Lambda$：\n$$\n\\Lambda = \\ln(R) = \\ln(4096)\n$$\n这可以使用对数性质进行简化：\n$$\n\\Lambda = \\ln(4^6) = 6 \\ln(4) = 6 \\ln(2^2) = 12 \\ln(2)\n$$\n为了获得数值，我们使用$\\ln(2) \\approx 0.69314718...$的值：\n$$\n\\Lambda = 12 \\times 0.69314718... \\approx 8.317766...\n$$\n问题要求答案四舍五入至四位有效数字。\n$$\n\\Lambda \\approx 8.318\n$$\n这个正的对数似然比表明，观测到的基因型$AA/AA/AA$源自种群$2$的可能性要远大于源自种群$1$。", "answer": "$$\n\\boxed{8.318}\n$$", "id": "2501782"}]}