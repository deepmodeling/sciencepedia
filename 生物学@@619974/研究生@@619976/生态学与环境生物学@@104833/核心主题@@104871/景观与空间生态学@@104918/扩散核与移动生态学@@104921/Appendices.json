{"hands_on_practices": [{"introduction": "不同的扩散核在数学性质上存在显著差异，尤其是在分布的“尾部”行为上，这对生态学意义重大。矩 (moments) 是描述分布形状和尺度的强大数学工具。通过本练习，您将深入探究两种常用的扩散核：Laplace 核和 Cauchy 核，并理解为何前者的所有矩都存在，而后者则因其“重尾”特性而缺乏高阶矩，这与罕见但至关重要的长距离扩散事件直接相关。这项实践 [@problem_id:2480505] 将锻炼您计算这些关键统计量并区分不同核函数形式的数学基础。", "problem": "一位种群生态学家使用不同的传播核来模拟沿笔直河岸廊道的一维种子传播距离。设 $X$ 表示随机抽取的一粒种子从母本植物到其降落位置的有符号位移（单位：米）。考虑将两个广泛使用的传播核作为 $X$ 的概率密度函数 (PDF)：\n\n- 一个率参数为 $\\lambda>0$ 的拉普拉斯核，其表达式为 $K_{L}(x) = \\frac{\\lambda}{2}\\exp(-\\lambda|x|)$，对所有实数 $x$ 成立。\n- 一个尺度参数为 $\\gamma>0$ 的柯西核，其表达式为 $K_{C}(x) = \\frac{1}{\\pi\\gamma}\\frac{1}{1+(x/\\gamma)^{2}}$，对所有实数 $x$ 成立。\n\n对于一个固定的非负实数 $p$，核 $K$ 的 $p$ 阶绝对矩定义为\n$$\n\\mu_{p}(K) \\equiv \\int_{-\\infty}^{\\infty} |x|^{p}\\,K(x)\\,\\mathrm{d}x.\n$$\n\n任务：\n1. 推导 $\\mu_{p}(K_{L})$ 作为 $p$ 和 $\\lambda$ 的函数的闭式表达式。你可以使用伽马函数 $\\Gamma(\\cdot)$ 来表示你的答案。\n2. 对于柯西核，确定数值 $p^{\\star} \\equiv \\sup\\{p \\ge 0 : \\mu_{p}(K_{C}) < \\infty\\}$。\n\n将你的最终答案以双元素行向量 $\\begin{pmatrix} \\mu_{p}(K_{L}) & p^{\\star} \\end{pmatrix}$ 的形式报告。无需四舍五入，且最终报告的表达式中不应包含任何单位。", "solution": "所给出的问题陈述是在生态建模背景下的一个定义明确的数学练习。它包含两个独立的任务：计算拉普拉斯分布的 $p$ 阶绝对矩，以及确定柯西分布的 $p$ 阶绝对矩的收敛域。该问题具有科学依据，使用了标准的数学定义，并包含了得到唯一解所需的所有必要信息。因此，该问题被认为是有效的，下面给出了完整的推导过程。\n\n核 $K(x)$ 的 $p$ 阶绝对矩定义为\n$$ \\mu_{p}(K) \\equiv \\int_{-\\infty}^{\\infty} |x|^{p}\\,K(x)\\,\\mathrm{d}x $$\n对于给定的 $p \\ge 0$。\n\n任务 1：计算拉普拉斯核的 $\\mu_{p}(K_{L})$。\n\n拉普拉斯核由 $K_{L}(x) = \\frac{\\lambda}{2}\\exp(-\\lambda|x|)$ 给出，其中 $\\lambda > 0$。我们将其代入矩的定义中：\n$$ \\mu_{p}(K_{L}) = \\int_{-\\infty}^{\\infty} |x|^{p} \\frac{\\lambda}{2}\\exp(-\\lambda|x|) \\,\\mathrm{d}x $$\n被积函数 $f(x) = |x|^{p} \\frac{\\lambda}{2}\\exp(-\\lambda|x|)$ 是 $x$ 的偶函数，因为 $|-x|^{p} = |x|^{p}$ 且 $|-x| = |x|$。因此，在 $(-\\infty, \\infty)$ 上的积分是在 $(0, \\infty)$ 上的积分的两倍：\n$$ \\mu_{p}(K_{L}) = 2 \\int_{0}^{\\infty} x^{p} \\frac{\\lambda}{2}\\exp(-\\lambda x) \\,\\mathrm{d}x = \\lambda \\int_{0}^{\\infty} x^{p} \\exp(-\\lambda x) \\,\\mathrm{d}x $$\n为使该积分收敛，我们需要 $p > -1$。由于问题指定 $p \\ge 0$，此条件总是满足的。\n我们通过换元法将该积分与伽马函数的标准定义 $\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1} \\exp(-t) \\,\\mathrm{d}t$ 联系起来。\n设 $t = \\lambda x$。则 $x = t/\\lambda$ 且 $\\mathrm{d}x = (1/\\lambda)\\mathrm{d}t$。积分限仍然是从 $0$ 到 $\\infty$。\n将这些代入 $\\mu_{p}(K_{L})$ 的表达式中，得到：\n$$ \\mu_{p}(K_{L}) = \\lambda \\int_{0}^{\\infty} \\left(\\frac{t}{\\lambda}\\right)^{p} \\exp(-t) \\left(\\frac{1}{\\lambda}\\right) \\,\\mathrm{d}t $$\n$$ \\mu_{p}(K_{L}) = \\lambda \\left(\\frac{1}{\\lambda^{p}}\\right) \\left(\\frac{1}{\\lambda}\\right) \\int_{0}^{\\infty} t^{p} \\exp(-t) \\,\\mathrm{d}t $$\n$$ \\mu_{p}(K_{L}) = \\frac{1}{\\lambda^{p}} \\int_{0}^{\\infty} t^{(p+1)-1} \\exp(-t) \\,\\mathrm{d}t $$\n右侧的积分是伽马函数 $\\Gamma(p+1)$ 的定义。\n因此，拉普拉斯核的 $p$ 阶绝对矩的闭式表达式为：\n$$ \\mu_{p}(K_{L}) = \\frac{\\Gamma(p+1)}{\\lambda^{p}} $$\n\n任务 2：确定柯西核的 $p^{\\star}$。\n\n柯西核由 $K_{C}(x) = \\frac{1}{\\pi\\gamma}\\frac{1}{1+(x/\\gamma)^{2}}$ 给出，其中 $\\gamma > 0$。我们的任务是找到 $p^{\\star} = \\sup\\{p \\ge 0 : \\mu_{p}(K_{C}) < \\infty\\}$。\n首先，我们写出 $\\mu_{p}(K_{C})$ 的表达式：\n$$ \\mu_{p}(K_{C}) = \\int_{-\\infty}^{\\infty} |x|^{p} \\frac{1}{\\pi\\gamma}\\frac{1}{1+(x/\\gamma)^{2}} \\,\\mathrm{d}x $$\n被积函数同样是偶函数，因此我们可以简化积分：\n$$ \\mu_{p}(K_{C}) = \\frac{2}{\\pi\\gamma} \\int_{0}^{\\infty} \\frac{x^{p}}{1+(x/\\gamma)^{2}} \\,\\mathrm{d}x $$\n为了确定对于哪些 $p \\ge 0$ 的值此积分是有限的，我们必须分析被积函数在积分限 $x \\to 0^{+}$ 和 $x \\to \\infty$ 附近的行为。\n设被积函数为 $g(x) = \\frac{x^{p}}{1+(x/\\gamma)^{2}}$。\n\n在 $x=0$ 附近，分母 $1+(x/\\gamma)^{2}$ 趋近于 $1$。因此，被积函数的行为类似于 $x^{p}$：\n$$ g(x) \\sim x^{p} \\quad \\text{as } x \\to 0^{+} $$\n对于某个小的 $\\delta > 0$，积分 $\\int_{0}^{\\delta} x^{p} \\,\\mathrm{d}x$ 收敛当且仅当 $p > -1$。由于题目给定 $p \\ge 0$，所以在积分下限 $x=0$ 附近，该积分总是收敛的。\n\n在 $x=\\infty$ 附近，分母中的项 $1$ 与 $(x/\\gamma)^{2}$ 相比变得可以忽略不计。因此，被积函数的行为类似于：\n$$ g(x) = \\frac{x^{p}}{1+x^{2}/\\gamma^{2}} \\sim \\frac{x^{p}}{x^{2}/\\gamma^{2}} = \\gamma^{2}x^{p-2} \\quad \\text{as } x \\to \\infty $$\n根据反常积分的极限比较检验法，对于某个大的 $M > 0$，积分 $\\int_{M}^{\\infty} g(x) \\,\\mathrm{d}x$ 收敛当且仅当积分 $\\int_{M}^{\\infty} x^{p-2} \\,\\mathrm{d}x$ 收敛。\n后一个积分收敛当且仅当指数严格小于 $-1$：\n$$ p - 2 < -1 \\implies p < 1 $$\n为使积分 $\\mu_{p}(K_{C})$ 为有限值，在 $x=0$ 和 $x=\\infty$ 处的收敛条件都必须满足。结合 $p \\ge 0$ (来自问题陈述) 和 $p < 1$ (来自我们的收敛性分析)，我们发现对于区间 $[0, 1)$ 内的所有 $p$，该积分是有限的。\n使矩为有限值的 $p$ 的集合是 $\\{p \\in \\mathbb{R} \\mid 0 \\le p < 1\\}$。\n问题要求的是该集合的上确界 $p^{\\star}$。\n$$ p^{\\star} = \\sup [0, 1) = 1 $$\n\n两个结果是 $\\mu_{p}(K_{L}) = \\frac{\\Gamma(p+1)}{\\lambda^{p}}$ 和 $p^{\\star} = 1$。这些结果应以一个双元素行向量的形式报告。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\Gamma(p+1)}{\\lambda^{p}} & 1\n\\end{pmatrix}\n}\n$$", "id": "2480505"}, {"introduction": "从理论性质转向经验数据，我们必须认识到，现实世界中动物的移动通常不是在所有方向上都均匀的（各向同性）；它可能受到风、水流或地貌等因素的影响，产生方向性偏差，即各向异性 (anisotropy)。本练习介绍了一个处理移动数据分析的核心统计工作流程。您将使用最大似然估计 (maximum likelihood estimation, MLE) 来拟合一个各向异性的高斯核，并利用强大的似然比检验 (likelihood ratio test, LRT) 来严谨地判断移动是否确实是各向异性的，或者一个更简单的各向同性模型是否足够。完成这个练习 [@problem_id:2480590] 将使您具备分析真实二维位移数据、量化移动中的方向偏差以及执行严格假设检验的实用计算技能。", "problem": "您正在研究运动生态学中的二维动物位移数据，其中单步位移通过高斯扩散核进行建模。假设每个观察到的位移向量都是来自一个具有未知均值和协方差的多元正态分布的独立样本。您需要使用最大似然法拟合一个各向异性的高斯核，然后检验各向同性的假设。\n\n基本背景和定义：\n- 具有均值向量 $\\boldsymbol{\\mu}$ 和协方差矩阵 $\\boldsymbol{\\Sigma}$ 的 $d$ 维多元正态密度是一个经过充分验证的扩散步长模型。其对于独立观测的似然函数遵循密度的乘积，其对数似然具有可加性。\n- 对于来自多元正态分布的独立样本，均值和协方差的最大似然估计存在，并通过在正定约束下最大化对数似然获得。似然比检验（LRT）使用在零假设和备择假设下最大化的似然函数之比，威尔克斯定理提供了检验统计量的渐近零分布。\n\n数学设置：\n- 您观察到 $n$ 个二维位移向量 $\\{\\mathbf{x}_i\\}_{i=1}^n$，其中 $\\mathbf{x}_i \\in \\mathbb{R}^2$，假设它们独立同分布于 $\\mathcal{N}_2(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$。\n- 备择假设允许一个无约束的对称正定协方差矩阵 $\\boldsymbol{\\Sigma}$，代表一个各向异性的高斯扩散核。\n- 各向同性的零假设将协方差约束为单位矩阵的标量倍数，即 $\\boldsymbol{\\Sigma} = \\sigma^2 \\mathbf{I}_2$。\n\n任务：\n1. 对于给定的模拟数据集（如下指定），在备择假设下使用最大似然估计法估计均值 $\\boldsymbol{\\mu}$ 和协方差矩阵 $\\boldsymbol{\\Sigma}$。另外，在零假设下使用最大似然估计法估计 $\\boldsymbol{\\mu}$ 和 $\\sigma^2$。\n2. 计算似然比检验统计量 $T = 2\\big(\\ell_{\\text{alt}} - \\ell_{\\text{null}}\\big)$，其中 $\\ell_{\\text{alt}}$ 和 $\\ell_{\\text{null}}$ 分别表示在备择模型和零模型下最大化的对数似然。在零假设下，当 $n$ 很大时，$T$ 近似服从 $\\chi^2_k$ 分布，其中 $k$ 等于两个模型之间自由协方差参数数量的差异。在二维情况下，$k = 2$。\n3. 对每个数据集计算 $p$ 值，即在观测到的 $T$ 值处评估的 $\\chi^2_k$ 分布的上尾概率。\n\n角度单位要求：\n- 下文引入的任何旋转角度均以弧度为单位。\n\n单位：\n- 无需报告任何物理单位。所有输出均为无单位的概率。\n\n测试集（您的程序将使用的数据生成机制；每个数据集由固定的随机种子生成以确保可复现性）：\n所有数据均为二维（$d = 2$），真实均值为零 $\\boldsymbol{\\mu} = \\mathbf{0}$，样本量和协方差结构如下。在每种情况下，使用指定的种子从 $\\mathcal{N}_2(\\mathbf{0}, \\boldsymbol{\\Sigma}_{\\text{true}})$ 中抽取 $n$ 个样本。\n\n- 情况A（各向同性，大样本）：$n = 500$，种子 $= 17$，$\\boldsymbol{\\Sigma}_{\\text{true}} = 4 \\mathbf{I}_2$。\n- 情况B（轴对齐各向异性，大样本）：$n = 500$，种子 $= 29$，$\\boldsymbol{\\Sigma}_{\\text{true}} = \\mathrm{diag}(9, 1)$。\n- 情况C（旋转各向异性，大样本）：$n = 500$，种子 $= 97$。设 $\\theta = \\pi/6$（弧度）。定义旋转矩阵 $\\mathbf{R}(\\theta) = \\begin{pmatrix}\\cos \\theta & -\\sin \\theta \\\\ \\sin \\theta & \\cos \\theta\\end{pmatrix}$ 和轴对齐协方差 $\\mathbf{D} = \\mathrm{diag}(4, 1)$。设 $\\boldsymbol{\\Sigma}_{\\text{true}} = \\mathbf{R}(\\theta)\\,\\mathbf{D}\\,\\mathbf{R}(\\theta)^\\top$。\n- 情况D（轻微各向异性，中等样本）：$n = 200$，种子 $= 1234$，$\\boldsymbol{\\Sigma}_{\\text{true}} = \\mathrm{diag}(1.2, 0.8)$。\n- 情况E（各向同性，小样本）：$n = 50$，种子 $= 2021$，$\\boldsymbol{\\Sigma}_{\\text{true}} = \\mathbf{I}_2$。\n\n实现和输出要求：\n- 您的程序必须使用上述种子在内部准确生成指定的数据集。\n- 仅使用从多元正态模型推导出的基于原则的最大似然估计，不使用临时的启发式方法。\n- 对于每种情况，基于适用于似然比检验统计量 $T$ 的 $\\chi^2_2$ 参考分布计算各向同性检验的 $p$ 值。\n- 最终输出格式：您的程序应生成单个输出行，其中包含以逗号分隔并括在方括号中的结果。结果应为与情况A到E相对应的五个 $p$ 值，每个值精确到小数点后六位，顺序为A, B, C, D, E。例如，一个带有占位符值的输出将类似于“[0.123456,0.000321,0.543210,0.010000,0.999999]”。", "solution": "该问题要求对二维高斯扩散核的各向同性进行统计检验。我们得到 $n$ 个独立同分布的位移向量 $\\{\\mathbf{x}_i\\}_{i=1}^n$，其中每个 $\\mathbf{x}_i \\in \\mathbb{R}^2$ 都假定为来自多元正态分布 $\\mathcal{N}_2(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$ 的样本。分析将通过推导两个竞争假设下模型参数的最大似然估计（MLEs），然后构建似然比检验（LRT）来进行。\n\n两个假设如下：\n零假设 $H_0$ 假定扩散核是各向同性的。这将协方差矩阵约束为单位矩阵的标量倍数：\n$$ H_0: \\boldsymbol{\\Sigma} = \\sigma^2 \\mathbf{I}_2 $$\n其中 $\\sigma^2 > 0$ 是一个单一的方差参数，$\\mathbf{I}_2$ 是 $2 \\times 2$ 的单位矩阵。\n\n备择假设 $H_A$ 允许各向异性。这意味着协方差矩阵 $\\boldsymbol{\\Sigma}$ 是一个无约束的对称正定矩阵：\n$$ H_A: \\boldsymbol{\\Sigma} = \\begin{pmatrix} \\sigma_{11} & \\sigma_{12} \\\\ \\sigma_{21} & \\sigma_{22} \\end{pmatrix}, \\text{ 其中 } \\sigma_{12} = \\sigma_{21} \\text{ 且 } \\boldsymbol{\\Sigma} \\succ 0 $$\n\n对于来自 $\\mathcal{N}_d(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$ 的 $n$ 个观测样本，当维度 $d=2$ 时，其对数似然函数为：\n$$ \\ell(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma}) = -\\frac{nd}{2}\\log(2\\pi) - \\frac{n}{2}\\log|\\boldsymbol{\\Sigma}| - \\frac{1}{2}\\sum_{i=1}^n (\\mathbf{x}_i - \\boldsymbol{\\mu})^\\top \\boldsymbol{\\Sigma}^{-1} (\\mathbf{x}_i - \\boldsymbol{\\mu}) $$\n\n首先，我们找到备择假设 $H_A$ 下的 MLE。需要估计的参数是 $\\boldsymbol{\\mu}$ 和 $\\boldsymbol{\\Sigma}$。多元统计学中的标准结果表明，MLE 是样本均值和样本协方差矩阵（分母为 $n$）：\n$$ \\hat{\\boldsymbol{\\mu}}_{\\text{alt}} = \\frac{1}{n} \\sum_{i=1}^n \\mathbf{x}_i $$\n$$ \\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}} = \\frac{1}{n} \\sum_{i=1}^n (\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}_{\\text{alt}})(\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}_{\\text{alt}})^\\top $$\n将这些估计值代入对数似然函数，由于迹算子的一个性质，求和项得到简化：\n$$ \\sum_{i=1}^n (\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}_{\\text{alt}})^\\top \\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}^{-1} (\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}_{\\text{alt}}) = \\mathrm{tr}\\left(\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}^{-1} \\sum_{i=1}^n (\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}_{\\text{alt}})(\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}_{\\text{alt}})^\\top\\right) = \\mathrm{tr}(\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}^{-1} n \\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}) = n \\, \\mathrm{tr}(\\mathbf{I}_d) = nd $$\n因此，$H_A$ 下最大化的对数似然为：\n$$ \\ell_{\\text{alt}} = \\ell(\\hat{\\boldsymbol{\\mu}}_{\\text{alt}}, \\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}) = -\\frac{nd}{2}\\log(2\\pi) - \\frac{n}{2}\\log|\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}| - \\frac{nd}{2} $$\n\n接下来，我们找到零假设 $H_0$ 下的 MLE。参数是 $\\boldsymbol{\\mu}$ 和 $\\sigma^2$。在此约束下的对数似然函数为：\n$$ \\ell(\\boldsymbol{\\mu}, \\sigma^2 | H_0) = -\\frac{nd}{2}\\log(2\\pi) - \\frac{nd}{2}\\log(\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^n \\|\\mathbf{x}_i - \\boldsymbol{\\mu}\\|^2_2 $$\n均值的 MLE 仍然是样本均值，$\\hat{\\boldsymbol{\\mu}}_{\\text{null}} = \\hat{\\boldsymbol{\\mu}}_{\\text{alt}}$。我们将其表示为 $\\hat{\\boldsymbol{\\mu}}$。为了找到 $\\sigma^2$ 的 MLE，我们对对数似然函数关于 $\\sigma^2$ 求导并令其为零，得到：\n$$ \\hat{\\sigma}^2_{\\text{null}} = \\frac{1}{nd} \\sum_{i=1}^n \\|\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}\\|^2_2 $$\n平方和可以与无约束样本协方差矩阵的迹联系起来：\n$$ \\sum_{i=1}^n \\|\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}}\\|^2_2 = \\sum_{i=1}^n \\mathrm{tr}\\left((\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}})(\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}})^\\top\\right) = \\mathrm{tr}\\left( \\sum_{i=1}^n (\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}})(\\mathbf{x}_i - \\hat{\\boldsymbol{\\mu}})^\\top \\right) = \\mathrm{tr}(n \\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}) $$\n因此，$H_0$ 下 $\\sigma^2$ 的 MLE 是各维度总方差的平均值：\n$$ \\hat{\\sigma}^2_{\\text{null}} = \\frac{1}{d} \\mathrm{tr}(\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}) $$\n将这些估计值代入零假设的对数似然函数，求和项变为 $\\frac{1}{2\\hat{\\sigma}^2_{\\text{null}}} (nd \\hat{\\sigma}^2_{\\text{null}}) = \\frac{nd}{2}$。$H_0$ 下最大化的对数似然为：\n$$ \\ell_{\\text{null}} = \\ell(\\hat{\\boldsymbol{\\mu}}, \\hat{\\sigma}^2_{\\text{null}}) = -\\frac{nd}{2}\\log(2\\pi) - \\frac{nd}{2}\\log(\\hat{\\sigma}^2_{\\text{null}}) - \\frac{nd}{2} $$\n\n似然比检验统计量 $T$ 定义为最大化对数似然之差的两倍：\n$$ T = 2(\\ell_{\\text{alt}} - \\ell_{\\text{null}}) = 2 \\left( \\left(-\\frac{n}{2}\\log|\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}|\\right) - \\left(-\\frac{nd}{2}\\log(\\hat{\\sigma}^2_{\\text{null}})\\right) \\right) $$\n$$ T = n \\left( d\\log(\\hat{\\sigma}^2_{\\text{null}}) - \\log|\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}| \\right) = n \\log\\left( \\frac{(\\hat{\\sigma}^2_{\\text{null}})^d}{|\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}|} \\right) $$\n代入 $\\hat{\\sigma}^2_{\\text{null}} = \\frac{1}{d}\\mathrm{tr}(\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}})$ 并设 $d=2$：\n$$ T = n \\log\\left( \\frac{\\left(\\frac{1}{2}\\mathrm{tr}(\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}})\\right)^2}{|\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}|} \\right) $$\n该统计量比较了 $\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}$ 特征值的算术平均数的平方与它们的几何平均数（行列式）。\n\n根据威尔克斯定理，当 $n$ 很大时，$T$ 在零假设下渐近地服从卡方分布。自由度 $k$ 是备择模型和零模型中自由协方差参数数量的差异。对于 $d=2$，$H_A$ 有 3 个自由协方差参数（$\\sigma_{11}, \\sigma_{22}, \\sigma_{12}$），而 $H_0$ 有 1 个（$\\sigma^2$）。因此，$k = 3 - 1 = 2$。\n所以，$T \\sim \\chi^2_2$ 在 $H_0$ 下。\n\n每个测试案例的步骤是：\n1. 从指定的真实分布 $\\mathcal{N}_2(\\mathbf{0}, \\boldsymbol{\\Sigma}_{\\text{true}})$ 生成 $n$ 个数据点。\n2. 计算样本均值 $\\hat{\\boldsymbol{\\mu}}$ 和协方差矩阵的 MLE $\\hat{\\boldsymbol{\\Sigma}}_{\\text{alt}}$。\n3. 使用推导出的公式计算 LRT 统计量 $T$。\n4. 计算 $p$ 值，即 $\\chi^2_2$ 分布的上尾概率，也就是 $P(X \\ge T)$，其中 $X \\sim \\chi^2_2$。这通过使用卡方分布的生存函数来计算。\n一个小的 $p$ 值（例如，$p < 0.05$）提供了拒绝各向同性零假设的证据，支持各向异性的备择假设。", "answer": "```python\nimport numpy as np\nfrom scipy.stats import chi2\n\ndef solve():\n    \"\"\"\n    Performs a Likelihood Ratio Test for isotropy on simulated 2D displacement data.\n\n    For each test case, the function:\n    1. Generates a dataset from a bivariate normal distribution.\n    2. Computes the maximum likelihood estimates for parameters under the\n       anisotropic (alternative) and isotropic (null) hypotheses.\n    3. Calculates the Likelihood Ratio Test statistic.\n    4. Computes the p-value using the asymptotic chi-squared distribution.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Case C: Define the rotation and covariance matrix for rotated anisotropy.\n    theta = np.pi / 6\n    R_theta = np.array([\n        [np.cos(theta), -np.sin(theta)],\n        [np.sin(theta), np.cos(theta)]\n    ])\n    D_C = np.diag([4, 1])\n    Sigma_C = R_theta @ D_C @ R_theta.T\n\n    test_cases = [\n        {'n': 500, 'seed': 17, 'Sigma_true': np.array([[4, 0], [0, 4]]), 'case': 'A'},\n        {'n': 500, 'seed': 29, 'Sigma_true': np.array([[9, 0], [0, 1]]), 'case': 'B'},\n        {'n': 500, 'seed': 97, 'Sigma_true': Sigma_C, 'case': 'C'},\n        {'n': 200, 'seed': 1234, 'Sigma_true': np.array([[1.2, 0], [0, 0.8]]), 'case': 'D'},\n        {'n': 50, 'seed': 2021, 'Sigma_true': np.eye(2), 'case': 'E'}\n    ]\n\n    p_values = []\n    \n    # Dimension of the data\n    d = 2\n\n    for case in test_cases:\n        n = case['n']\n        seed = case['seed']\n        Sigma_true = case['Sigma_true']\n\n        # 1. Generate n samples from N_2(0, Sigma_true)\n        rng = np.random.default_rng(seed)\n        mean_true = np.zeros(d)\n        data = rng.multivariate_normal(mean_true, Sigma_true, size=n)\n\n        # 2. Estimate parameters by maximum likelihood.\n        # Although the true mean is 0, the model assumes an unknown mean.\n        # MLE for mu is the sample mean for both hypotheses.\n        mu_hat = np.mean(data, axis=0)\n\n        # MLE for covariance under the alternative hypothesis (anisotropic)\n        # np.cov with bias=True divides by n, which is the MLE.\n        Sigma_hat_alt = np.cov(data, rowvar=False, bias=True)\n\n        # 3. Calculate the Likelihood Ratio Test statistic T.\n        # T = n * log( (tr(Sigma_hat)/d)^d / det(Sigma_hat) )\n        det_Sigma_hat = np.linalg.det(Sigma_hat_alt)\n        tr_Sigma_hat = np.trace(Sigma_hat_alt)\n\n        # Handle potential numerical issues if determinant is\n        # non-positive, although unlikely with generated data.\n        if det_Sigma_hat <= 0:\n            # If Sigma_hat is not positive definite, the likelihood is not\n            # well-defined. This can happen with degenerate data.\n            # In such a case, the test is not applicable. For this problem,\n            # we can assume it will be positive.\n            # We can use a very large T to yield a p-value of 0.\n            T_statistic = np.inf\n        else:\n            # MLE for variance under the null hypothesis (isotropic)\n            sigma_sq_hat_null = tr_Sigma_hat / d\n            \n            # The argument to the logarithm is the ratio of the arithmetic mean\n            # to the geometric mean of the eigenvalues of Sigma_hat_alt, raised to power d.\n            # By AM-GM inequality, this is >= 1.\n            log_argument = (sigma_sq_hat_null**d) / det_Sigma_hat\n            T_statistic = n * np.log(log_argument)\n        \n        # 4. Compute the p-value.\n        # The test statistic T is asymptotically chi-squared distributed with\n        # k = (d*(d+1)/2 - 1) degrees of freedom. For d=2, k=2.\n        k = d * (d + 1) // 2 - 1\n        p_value = chi2.sf(T_statistic, df=k)\n        \n        p_values.append(f\"{p_value:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(p_values)}]\")\n\nsolve()\n\n```", "id": "2480590"}, {"introduction": "现在，我们将应用关于扩散核的知识来解决生态学中的一个核心问题：预测种群的扩张速率。一个物种入侵新区域的速度能有多快？这项实践深入探讨了数学化生态学的核心，使用积分差分方程 (integrodifference equation) 来模拟种群扩散。它展示了一种强大的技术，其中扩散核的矩生成函数 (moment-generating function, MGF)——一个与其各阶矩密切相关的量——直接决定了入侵的渐进速度 $c^*$。通过完成这个推导 [@problem_id:2480511]，您将深刻理解个体扩散的微观过程与种群扩张的宏观模式之间的联系，这是空间生态学的基石。", "problem": "考虑一个用于描述种群在空间中扩散的一维积分差分模型，\n$$\nn_{t+1}(x) \\;=\\; \\int_{\\mathbb{R}} K(x-y)\\, f\\!\\left(n_t(y)\\right)\\, dy,\n$$\n其中 $t$ 是离散时间，$x \\in \\mathbb{R}$ 是空间，$K(x)$ 是描述扩散的概率密度函数，$f$ 是受密度调节的人均增长函数。假设在低密度下，增长是线性的，乘数为 $R \\equiv f'(0) > 1$，并且扩散由拉普拉斯核\n$$\nK(x) \\;=\\; \\frac{1}{2b}\\,\\exp\\!\\left(-\\frac{|x|}{b}\\right)\n$$\n给出，其尺度参数为 $b>0$。令 $M(s)$ 表示 $K$ 的矩生成函数（MGF），其定义为 $M(s) \\equiv \\int_{\\mathbb{R}} \\exp(sx)\\,K(x)\\,dx$，其中 $|s|<1/b$。\n\n从低密度线性化和解的指数拟设出发，推导最小渐进入侵速度 $c^*$ 关于 $M(s)$ 的变分特征。然后，使用上述拉普拉斯核，证明 $M(s)$ 可以写成闭合形式，并确定 $c^*$ 关于 $R$ 和 $b$ 的精确闭合形式表达式。你的最终表达式应以符号形式给出（无需数值计算），并且必须用初等函数表示，如果需要，还可以使用由 $W(z)\\exp(W(z))=z$ 隐式定义的 Lambert $W$ 函数。最终答案中不要包含单位。如果 Lambert $W$ 函数的多个实数分支在数学上都是可能的，请使用能够为 $R>1$ 产生生物学上可接受的最小速度的分支。\n\n提供 $c^*$ 的最终表达式作为你的答案。无需四舍五入；报告一个精确的闭合形式表达式。", "solution": "该问题要求推导由一个积分差分方程控制的种群的最小渐进入侵速度 $c^*$。\n\n积分差分模型由下式给出\n$$\nn_{t+1}(x) \\;=\\; \\int_{\\mathbb{R}} K(x-y)\\, f\\!\\left(n_t(y)\\right)\\, dy\n$$\n其中 $n_t(x)$ 是种群密度，$K(x)$ 是扩散核，$f(n)$ 是增长函数。\n\n首先，我们验证问题的陈述。\n已知条件如下：\n1.  模型方程： $n_{t+1}(x) = \\int_{\\mathbb{R}} K(x-y) f(n_t(y)) dy$。\n2.  低密度下的增长率： $R \\equiv f'(0) > 1$。\n3.  扩散核：$K(x) = \\frac{1}{2b} \\exp(-\\frac{|x|}{b})$，其中 $b>0$。\n4.  矩生成函数（MGF）定义： $M(s) \\equiv \\int_{\\mathbb{R}} \\exp(sx) K(x) dx$，其中 $|s|<1/b$。\n5.  辅助定义：Lambert W 函数，$W(z)\\exp(W(z))=z$。\n\n该问题具有科学依据，是适定且客观的。这是一个关于反应扩散和入侵动力学的数学生态学中的标准问题。前提条件在事實上是正確的，並且內部一致。提供了必要的信息，并且问题是可形式化和可验证的。因此，问题是有效的，我們可以繼續求解。\n\n解答过程分为三个主要部分：\n1.  最小速度 $c^*$ 的变分特征推导。\n2.  计算指定拉普拉斯核的矩生成函数。\n3.  求解变分问题以找到 $c^*$ 的显式表达式。\n\n步骤 1：$c^*$ 的变分特征\n\n在入侵前沿的领先边缘，种群密度 $n_t(x)$ 非常低。我们可以围绕不稳定的平衡点 $n=0$ 对增长函数 $f(n)$ 进行线性化。泰勒展开给出 $f(n) \\approx f(0) + f'(0)n$。由于 $n=0$ 是一个平衡点，我们有 $f(0)=0$。问题定义了 $R \\equiv f'(0)$，因此近似变为 $f(n) \\approx Rn$。线性化的积分差分方程是：\n$$\nn_{t+1}(x) \\;=\\; R \\int_{\\mathbb{R}} K(x-y)\\, n_t(y)\\, dy\n$$\n我们寻找形式为 $n_t(x) = A \\exp(-s(x-ct))$ 的行波解，其中 $c$ 是波速，$s>0$ 是前沿处的指数衰减率。将此拟设代入线性化方程中：\n\n左手边 (LHS) 是：\n$$\nn_{t+1}(x) = A \\exp(-s(x-c(t+1))) = A \\exp(-s(x-ct) + sc) = n_t(x) \\exp(sc)\n$$\n右手边 (RHS) 是：\n$$\nR \\int_{\\mathbb{R}} K(x-y)\\, A \\exp(-s(y-ct))\\, dy\n$$\n令积分的哑变量为 $z=x-y$，因此 $y=x-z$ 且 $dy = -dz$。积分限反转。\n$$\nRHS = R \\int_{+\\infty}^{-\\infty} K(z)\\, A \\exp(-s(x-z-ct))\\, (-dz) = R A \\exp(-s(x-ct)) \\int_{-\\infty}^{+\\infty} K(z) \\exp(sz)\\, dz\n$$\n该积分是矩生成函数 $M(s)$ 的定义。因此，RHS 变为：\n$$\nRHS = R n_t(x) M(s)\n$$\n令 LHS 和 RHS 相等，并除以 $n_t(x)$，得到特征方程：\n$$\n\\exp(sc) = R M(s)\n$$\n求解速度 $c$ 作为衰减率 $s$ 的函数：\n$$\nsc = \\ln(R M(s)) \\implies c(s) = \\frac{\\ln(R) + \\ln(M(s))}{s}\n$$\n渐进入侵速度 $c^*$ 是在所有有效的衰减率 $s>0$ 上这些可能速度的最小值。这提供了变分特征：\n$$\nc^* = \\min_{s>0} c(s) = \\min_{s>0} \\left[ \\frac{\\ln(R) + \\ln(M(s))}{s} \\right]\n$$\n\n步骤 2：矩生成函数的计算\n\n核是拉普拉斯分布 $K(x) = \\frac{1}{2b}\\exp(-\\frac{|x|}{b})$。我们计算它的矩生成函数：\n$$\nM(s) = \\int_{-\\infty}^{\\infty} \\exp(sx) \\frac{1}{2b} \\exp\\left(-\\frac{|x|}{b}\\right) dx = \\frac{1}{2b} \\left[ \\int_{-\\infty}^0 \\exp(sx)\\exp\\left(\\frac{x}{b}\\right)dx + \\int_0^{\\infty} \\exp(sx)\\exp\\left(-\\frac{x}{b}\\right)dx \\right]\n$$\n$$\nM(s) = \\frac{1}{2b} \\left[ \\int_{-\\infty}^0 \\exp\\left(x\\left(s+\\frac{1}{b}\\right)\\right)dx + \\int_0^{\\infty} \\exp\\left(x\\left(s-\\frac{1}{b}\\right)\\right)dx \\right]\n$$\n对于 $|s| < 1/b$，积分收敛。计算它们：\n$$\nM(s) = \\frac{1}{2b} \\left[ \\left. \\frac{\\exp(x(s+1/b))}{s+1/b} \\right|_{-\\infty}^0 + \\left. \\frac{\\exp(x(s-1/b))}{s-1/b} \\right|_0^{\\infty} \\right] = \\frac{1}{2b} \\left[ \\frac{1}{s+1/b} - \\frac{1}{s-1/b} \\right]\n$$\n$$\nM(s) = \\frac{1}{2b} \\left[ \\frac{(s-1/b) - (s+1/b)}{(s+1/b)(s-1/b)} \\right] = \\frac{1}{2b} \\left[ \\frac{-2/b}{s^2-1/b^2} \\right] = \\frac{1/b^2}{1/b^2-s^2} = \\frac{1}{1 - b^2s^2}\n$$\n矩生成函数的闭合形式表达式是 $M(s) = (1 - b^2s^2)^{-1}$。\n\n步骤 3：确定 $c^*$ 的表达式\n\n为了找到 $c(s)$ 的最小值，我们将其关于 $s$ 的导数设为零，即 $c'(s)=0$。\n$$\nc(s) = \\frac{\\ln(R) - \\ln(1-b^2s^2)}{s}\n$$\n条件 $c'(s)=0$ 导出以下方程：\n$$\ns \\frac{d}{ds}[-\\ln(1-b^2s^2)] - [-\\ln(1-b^2s^2)] = \\ln(R)\n$$\n$$\ns \\left( -\\frac{-2b^2s}{1-b^2s^2} \\right) + \\ln(1-b^2s^2) = \\ln(R) \\implies \\frac{2b^2s^2}{1-b^2s^2} + \\ln(1-b^2s^2) = \\ln(R)\n$$\n设一个新变量 $Y = 1-b^2s^2$。由于 $s>0$ 且 $|s|<1/b$，我们有 $0 < Y < 1$。并且 $b^2s^2=1-Y$。方程变换为：\n$$\n\\frac{2(1-Y)}{Y} + \\ln(Y) = \\ln(R) \\implies \\frac{2}{Y} - 2 + \\ln(Y) = \\ln(R)\n$$\n重新整理得到：\n$$\n\\ln(Y) + \\frac{2}{Y} = \\ln(R) + 2\n$$\n对两边取指数：\n$$\n\\exp(\\ln(Y) + 2/Y) = Y \\exp(2/Y) = \\exp(\\ln(R)+2) = R\\exp(2)\n$$\n为了匹配 Lambert W 函数的形式，令 $W = -2/Y$。则 $Y = -2/W$。将此代入方程：\n$$\n(-\\frac{2}{W}) \\exp(-W) = R\\exp(2) \\implies W\\exp(W) = \\frac{-2}{R\\exp(2)} = -2R^{-1}\\exp(-2)\n$$\n这意味着对于 Lambert W 函数的某个分支 $k$，$W = W_k(-2R^{-1}\\exp(-2))$。\n\n我们必须选择能够产生物理有效解的分支。我们要求 $s$ 是实数且为正，这意味着 $0<Y<1$。由于 $Y=-2/W$，这个条件变为 $0 < -2/W < 1$。这意味着 $W < -2$。\nW 函数的自变量是 $z = -2R^{-1}\\exp(-2)$。由于 $R>1$，我们有 $0 < 2R^{-1}\\exp(-2) < 2\\exp(-2)$。值 $-1/e$ 是 W 函数实数解的分支点，且 $-1/e \\approx -0.3679$，而 $-2\\exp(-2) \\approx -0.2707$。自变量 $z$ 位于区间 $(-2\\exp(-2), 0)$ 内，这在 $[-1/e, 0)$ 之内。在这个区间内，有两个实数分支：\n-   $W_0(z) \\in [-1, 0)$。\n-   $W_{-1}(z) \\in (-\\infty, -1]$。\n条件 $W < -2$ 只能由 $W_{-1}$ 分支满足。具体来说，因为 $z > -2\\exp(-2)$ 并且 $W_{-1}$ 是一个递减函数，所以 $W_{-1}(z) < W_{-1}(-2\\exp(-2)) = -2$。因此，我们必须使用 $k=-1$ 分支。令 $W^* = W_{-1}(-2R^{-1}\\exp(-2))$。\n\n我们现在求 $c^*$ 的表达式。在最优 $s$（记为 $s^*$）处的速度是 $c^*=c(s^*)$。在最小值处 $c^*$ 的一个替代表達式是 $c^* = M'(s^*)/M(s^*)$。\n$M'(s) = - (1-b^2s^2)^{-2} (-2b^2s) = \\frac{2b^2s}{(1-b^2s^2)^2}$。\n$$\nc^* = \\frac{M'(s^*)}{M(s^*)} = \\frac{2b^2s^*/(1-b^2(s^*)^2)^2}{1/(1-b^2(s^*)^2)} = \\frac{2b^2s^*}{1-b^2(s^*)^2}\n$$\n使用 $Y = 1-b^2s^2$ 和 $s^*=\\sqrt{1-Y}/b$ （因为 $s>0$）：\n$$\nc^* = \\frac{2b^2 (\\sqrt{1-Y}/b)}{Y} = \\frac{2b\\sqrt{1-Y}}{Y}\n$$\n代入 $Y = -2/W^*$：\n$$\nc^* = \\frac{2b\\sqrt{1 - (-2/W^*)}}{-2/W^*} = -bW^*\\sqrt{1+2/W^*} = -bW^*\\sqrt{\\frac{W^*+2}{W^*}}\n$$\n由于 $W^* < -2$，所以 $W^*$ 和 $W^*+2$ 都是负数。它們的比值是正數。平方根是实数，可以写成 $\\sqrt{-(W^*+2)}/\\sqrt{-W^*}$。\n$$\nc^* = -b W^* \\frac{\\sqrt{-(W^*+2)}}{\\sqrt{-W^*}} = -b(-|W^*|) \\frac{\\sqrt{-(W^*+2)}}{\\sqrt{|W^*|}} = b|W^*|\\frac{\\sqrt{-(W^*+2)}}{\\sqrt{|W^*|}}\n$$\n$$\nc^* = b\\sqrt{|W^*|} \\sqrt{-(W^*+2)} = b\\sqrt{-W^*} \\sqrt{-(W^*+2)} = b\\sqrt{(-W^*)(-(W^*+2))}\n$$\n$$\nc^* = b\\sqrt{W^*(W^*+2)}\n$$\n将 $W^*$ 的完整表达式代回，我们得到最终结果。", "answer": "$$\\boxed{b \\sqrt{W_{-1}\\left(-2R^{-1}\\exp(-2)\\right) \\left( W_{-1}\\left(-2R^{-1}\\exp(-2)\\right) + 2 \\right)}}$$", "id": "2480511"}]}