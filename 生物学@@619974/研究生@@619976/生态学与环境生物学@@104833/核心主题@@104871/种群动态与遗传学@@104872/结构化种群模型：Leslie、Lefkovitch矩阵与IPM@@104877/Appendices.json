{"hands_on_practices": [{"introduction": "种群投影矩阵的结构直接反映了生物体的生命史。本练习将引导您探索“可约性”（reducibility）这一数学概念，它揭示了生命周期何时由不相连或单向连接的多个部分组成。通过分析一个块上三角形式的Lefkovitch矩阵，您将理解可约性如何影响种群的整体动态，并将抽象的矩阵属性与真实的生命周期图联系起来。[@problem_id:2536688]", "problem": "考虑一个具有两个生命周期组分（标记为 $X$（阶段1–2）和 $Y$（阶段3–4））的阶段结构种群。假设该种群在每个离散时间步长上通过一个 $4 \\times 4$ 的非负 Lefkovitch（基于阶段的）矩阵 $A$ 进行演变，其形式为\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0.8 & 0.5 & 0.05 & 0 \\\\\n0.2 & 0.7 & 0 & 0.1 \\\\\n0 & 0 & 0.5 & 0.2 \\\\\n0 & 0 & 0.1 & 0.5\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\nB_{X} & C \\\\\n0 & B_{Y}\n\\end{pmatrix},\n$$\n其中\n$$\nB_{X} \\;=\\; \\begin{pmatrix} 0.8 & 0.5 \\\\ 0.2 & 0.7 \\end{pmatrix}, \n\\quad\nB_{Y} \\;=\\; \\begin{pmatrix} 0.5 & 0.2 \\\\ 0.1 & 0.5 \\end{pmatrix},\n\\quad\nC \\;=\\; \\begin{pmatrix} 0.05 & 0 \\\\ 0 & 0.1 \\end{pmatrix}.\n$$\n矩阵中的元素表示一个时间步长后，从列阶段到行阶段的预期贡献（包括存活并停留在原阶段、进入下一阶段、退回上一阶段以及繁殖），这与生态学中使用的阶段结构种群演变矩阵一致。\n\n仅使用基本定义、行列式的性质以及关于非负矩阵的基本事实，完成以下任务：\n\n1) 引用通过置换化为上三角分块形式的可约性定义，或等价地，通过阶段间可达性的有向图，解释为什么 $A$ 是可约的。\n\n2) 从特征值是特征多项式 $\\det(\\lambda I - A) \\,=\\, 0$ 的根这一定义出发，推导 $B_{X}$ 和 $B_{Y}$ 的特征多项式，然后以精确的封闭形式求出 $A$ 的特征值。\n\n3) 以关于非负矩阵的成熟理论（Perron–Frobenius 理论）为基础，论证为什么总种群的长期渐近增长率等于 $A$ 的最大特征值，并解释此处可约性的生物学意义，即存在相互隔离的生命周期组分，且它们之间存在单向耦合（通过 $C$ 从 $Y$ 到 $X$，但反之则不然）。保持生态学解释简洁，并与分块结构紧密联系。\n\n在你的最终数值答案中，以单个行矩阵的形式报告 $A$ 的四个特征值，以精确形式从大到小排序。不要四舍五入；如有必要，提供带有根号的精确表达式。不需要单位。", "solution": "所给问题是线性代数在种群生态学，特别是结构化种群模型中的一个标准应用。它具有科学依据，问题设定良好且客观。所有必要的数据均已提供，所提问题在数学上和生物学上都有意义。该问题是有效的。\n\n将按要求分三部分给出解答。\n\n1) 关于矩阵 $A$ 的可约性\n\n一个 $n \\times n$ 的方阵 $A$ 被定义为**可约的**，如果存在一个置换矩阵 $P$ 使得 $P^T A P$ 是一个上三角分块矩阵，或者如果索引集合 $\\{1, 2, ..., n\\}$ 可以被划分为两个不相交的非空子集 $I_1$ 和 $I_2$，使得对于所有 $i \\in I_2$ 和 $j \\in I_1$ 都有 $A_{ij} = 0$。等价地，一个非负矩阵是可约的，当且仅当其关联的有向图不是强连通的。\n\n给定的矩阵 $A$ 是\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0.8 & 0.5 & 0.05 & 0 \\\\\n0.2 & 0.7 & 0 & 0.1 \\\\\n0 & 0 & 0.5 & 0.2 \\\\\n0 & 0 & 0.1 & 0.5\n\\end{pmatrix}\n$$\n问题陈述本身已将 $A$ 以上三角分块形式呈现，其中置换矩阵是单位矩阵 $I$。我们将阶段划分为两个集合：$I_X = \\{1, 2\\}$ 对应生命周期组分 $X$，以及 $I_Y = \\{3, 4\\}$ 对应组分 $Y$。矩阵 $A$ 呈现如下形式\n$$\nA \\;=\\;\n\\begin{pmatrix}\nB_{X} & C \\\\\n0 & B_{Y}\n\\end{pmatrix}\n$$\n左下角的分块代表从 $I_X$ 中的阶段到 $I_Y$ 中的阶段的转移，它是一个 $2 \\times 2$ 的零矩阵。这直接满足了可约矩阵的定义。\n\n从阶段转移的有向图角度来看，节点是各个阶段 $\\{1, 2, 3, 4\\}$。如果矩阵元素 $A_{ij}$ 为正，则存在一条从阶段 $j$ 到阶段 $i$ 的边。$A$ 左下角的零分块意味着 $A_{31} = A_{32} = A_{41} = A_{42} = 0$。这意味着不存在从组分 $X$（阶段1和2）中的任何阶段到组分 $Y$（阶段3和4）中的任何阶段的有向边。因此，不可能从阶段1或2到达阶段3或4。该图不是强连通的，这正是可约性的图论定义。例如，从节点1到节点3不存在路径。\n\n2) 特征值的推导\n\n矩阵 $A$ 的特征值 $\\lambda$ 是其特征多项式的根，由方程 $\\det(\\lambda I - A) = 0$ 定义。对于一个分块三角矩阵，其行列式是对角线上各分块行列式的乘积。\n$$\n\\det(\\lambda I - A) = \\det \\begin{pmatrix} \\lambda I_2 - B_X & -C \\\\ 0 & \\lambda I_2 - B_Y \\end{pmatrix} = \\det(\\lambda I_2 - B_X) \\det(\\lambda I_2 - B_Y)\n$$\n因此，$A$ 的特征值集合是其对角分块 $B_X$ 和 $B_Y$ 特征值的并集。我们将分别求出这两组特征值。\n\n对于分块 $B_X = \\begin{pmatrix} 0.8 & 0.5 \\\\ 0.2 & 0.7 \\end{pmatrix}$：\n其特征多项式为 $p_X(\\lambda) = \\det(\\lambda I_2 - B_X)$。\n$$\n\\det \\begin{pmatrix} \\lambda - 0.8 & -0.5 \\\\ -0.2 & \\lambda - 0.7 \\end{pmatrix} = (\\lambda - 0.8)(\\lambda - 0.7) - (-0.5)(-0.2) = 0\n$$\n$$\n\\lambda^2 - 1.5\\lambda + 0.56 - 0.1 = 0\n$$\n$$\n\\lambda^2 - \\frac{3}{2}\\lambda + \\frac{46}{100} = 0 \\quad \\implies \\quad \\lambda^2 - \\frac{3}{2}\\lambda + \\frac{23}{50} = 0\n$$\n使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$\n\\lambda_X = \\frac{\\frac{3}{2} \\pm \\sqrt{\\left(-\\frac{3}{2}\\right)^2 - 4(1)\\left(\\frac{23}{50}\\right)}}{2} = \\frac{\\frac{3}{2} \\pm \\sqrt{\\frac{9}{4} - \\frac{92}{50}}}{2} = \\frac{\\frac{3}{2} \\pm \\sqrt{\\frac{225 - 184}{100}}}{2} = \\frac{\\frac{3}{2} \\pm \\sqrt{\\frac{41}{100}}}{2}\n$$\n$$\n\\lambda_X = \\frac{\\frac{3}{2} \\pm \\frac{\\sqrt{41}}{10}}{2} = \\frac{3}{4} \\pm \\frac{\\sqrt{41}}{20} = \\frac{15 \\pm \\sqrt{41}}{20}\n$$\n来自 $B_X$ 的两个特征值是 $\\lambda_{X,1} = \\frac{15 + \\sqrt{41}}{20}$ 和 $\\lambda_{X,2} = \\frac{15 - \\sqrt{41}}{20}$。\n\n对于分块 $B_Y = \\begin{pmatrix} 0.5 & 0.2 \\\\ 0.1 & 0.5 \\end{pmatrix}$：\n其特征多项式为 $p_Y(\\lambda) = \\det(\\lambda I_2 - B_Y)$。\n$$\n\\det \\begin{pmatrix} \\lambda - 0.5 & -0.2 \\\\ -0.1 & \\lambda - 0.5 \\end{pmatrix} = (\\lambda - 0.5)^2 - (-0.2)(-0.1) = 0\n$$\n$$\n\\lambda^2 - \\lambda + 0.25 - 0.02 = 0\n$$\n$$\n\\lambda^2 - \\lambda + \\frac{23}{100} = 0\n$$\n使用二次公式：\n$$\n\\lambda_Y = \\frac{1 \\pm \\sqrt{(-1)^2 - 4(1)\\left(\\frac{23}{100}\\right)}}{2} = \\frac{1 \\pm \\sqrt{1 - \\frac{92}{100}}}{2} = \\frac{1 \\pm \\sqrt{\\frac{8}{100}}}{2} = \\frac{1 \\pm \\frac{2\\sqrt{2}}{10}}{2}\n$$\n$$\n\\lambda_Y = \\frac{1 \\pm \\frac{\\sqrt{2}}{5}}{2} = \\frac{1}{2} \\pm \\frac{\\sqrt{2}}{10} = \\frac{5 \\pm \\sqrt{2}}{10}\n$$\n来自 $B_Y$ 的两个特征值是 $\\lambda_{Y,1} = \\frac{5 + \\sqrt{2}}{10}$ 和 $\\lambda_{Y,2} = \\frac{5 - \\sqrt{2}}{10}$。\n\n$A$ 的四个特征值是这两组特征值的并集。我们必须对它们进行排序。\n$\\lambda_{X,1} = \\frac{15 + \\sqrt{41}}{20} \\approx \\frac{15 + 6.403}{20} \\approx 1.070$\n$\\lambda_{Y,1} = \\frac{5 + \\sqrt{2}}{10} = \\frac{10 + 2\\sqrt{2}}{20} \\approx \\frac{10 + 2.828}{20} \\approx 0.641$\n$\\lambda_{X,2} = \\frac{15 - \\sqrt{41}}{20} \\approx \\frac{15 - 6.403}{20} \\approx 0.430$\n$\\lambda_{Y,2} = \\frac{5 - \\sqrt{2}}{10} = \\frac{10 - 2\\sqrt{2}}{20} \\approx \\frac{10 - 2.828}{20} \\approx 0.359$\n排序后的特征值为 $\\lambda_1 = \\lambda_{X,1}$，$\\lambda_2 = \\lambda_{Y,1}$，$\\lambda_3 = \\lambda_{X,2}$，以及 $\\lambda_4 = \\lambda_{Y,2}$。\n\n3) 渐近增长与生物学解释\n\n在时间步长 $t$ 的种群向量 $\\mathbf{n}(t)$ 由演变式 $\\mathbf{n}(t) = A^t \\mathbf{n}(0)$ 给出。当 $t \\to \\infty$ 时，系统的长期行为由 $A$ 的最大模特征值（即主特征值或谱半径 $\\lambda_1 = \\rho(A)$）决定。根据关于非负矩阵的 Perron-Frobenius 理论，这个主特征值是实数且非负。对于大的 $t$，种群向量会趋近于一个稳定的阶段分布（对应于 $\\lambda_1$ 的右特征向量 $\\mathbf{w}_1$），并以 $\\lambda_1$ 给出的速率指数增长或衰减：$\\mathbf{n}(t) \\sim c \\lambda_1^t \\mathbf{w}_1$，其中常数 $c$ 取决于初始种群向量 $\\mathbf{n}(0)$。因此，总种群的长期渐近增长率恰好是 $\\lambda_1$。在本例中，$\\lambda_1 = \\frac{15 + \\sqrt{41}}{20} \\approx 1.07 > 1$，表明种群正在增长。\n\n在此背景下，可约性的生物学意义在于生命周期被划分为相互隔离或部分连接的组分。分块结构 $A = \\begin{pmatrix} B_{X} & C \\\\ 0 & B_{Y} \\end{pmatrix}$ 表明种群被分为两组阶段，$X = \\{1, 2\\}$ 和 $Y = \\{3, 4\\}$。零分块表示组分 $X$ 中的个体（例如，幼体）不能转移到组分 $Y$ 中（例如，成体）。非零分块 $C$ 表示从组分 $Y$ 到组分 $X$ 的单向流动，这可以代表 $Y$ 中的成体繁殖后代，后代进入 $X$ 中的幼体阶段。生命周期不是一个闭环；组分 $Y$ 是 $X$ 的一个来源，但一旦个体的谱系进入 $X$，它就会被困在其中。整个种群的最终命运由具有更高内在增长率（主特征值）的组分决定。此处，$\\rho(B_X) = \\lambda_{X,1} \\approx 1.07$，而 $\\rho(B_Y) = \\lambda_{Y,1} \\approx 0.64$。由于 $\\rho(B_X) > \\rho(B_Y)$，组分 $X$ 的动态主导了整个种群的长期增长。组分 $Y$ 自身会趋于灭绝，其在总种群中的相对贡献将随时间推移而减少。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{15 + \\sqrt{41}}{20} & \\frac{5 + \\sqrt{2}}{10} & \\frac{15 - \\sqrt{41}}{20} & \\frac{5 - \\sqrt{2}}{10} \\end{pmatrix}}\n$$", "id": "2536688"}, {"introduction": "生态学家在建模时常需要简化复杂的生命史，例如将多个生命阶段合并为一个。本练习将深入探讨这种“阶段聚合”（stage aggregation）操作的后果。您将学习一种基于稳定阶段分布的特定聚合方法，并发现一个重要结论：这种方法可以在简化模型的同时，精确地保持种群的长期增长率 $\\lambda$ 不变。[@problem_id:2536679]", "problem": "考虑一个由三阶段 Lefkovitch 矩阵 $A$ 描述的阶段结构种群，该矩阵通过 $n_{t+1} = A n_{t}$ 作用于阶段丰度向量 $n_{t}$，其中\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0 & 0.8 & 1.2 \\\\\n0.5 & 0.3 & 0.1 \\\\\n0 & 0.4 & 0.6\n\\end{pmatrix}.\n$$\n在这里，第 $j$ 列列出了当前处于阶段 $j$ 的个体在下一次普查时对每个阶段的期望贡献，其中第一行是繁殖力，下面的行是阶段转移。$A$ 的主特征值 $\\lambda$ 等于长期的每时间步长渐近增长率，而相关的右特征向量（归一化使其和为一）给出了稳定阶段分布。\n\n你的任务是将相邻的阶段 $2$ 和 $3$ 合并成一个单一的复合阶段，使用基于原始系统稳定阶段分布下，复合阶段内原始阶段 $2$ 和阶段 $3$ 个体的条件构成的概率加权平均法。具体来说，设 $p_{2}$ 和 $p_{3}$ 分别为在复合阶段的条件下，个体处于原始阶段 $2$ 或 $3$ 的概率；这些概率必须从原始模型的稳定阶段分布中推导出来，并且必须满足 $p_{2} + p_{3} = 1$。通过以下方式构建降维后的 $2 \\times 2$ 投影矩阵：\n- 将复合阶段的有效繁殖力计算为原始阶段 $2$ 和 $3$ 繁殖力的概率加权平均值，以及\n- 通过对相应的原始转移进行概率加权平均来计算复合阶段的转移，同时在适当的情况下，对于转入和转出复合阶段的转移，要遵循可加性。\n\n然后，计算降维矩阵的主特征值 $\\lambda'$，并量化其在长期增长率上引起的绝对误差 $|\\lambda' - \\lambda|$。将 $|\\lambda' - \\lambda|$ 的最终数值以小数形式表示。如果结果非零，则四舍五入到四位有效数字。清晰地展示你如何从第一性原理推导出 $p_{2}$ 和 $p_{3}$，以及如何利用这些概率构建降维矩阵。", "solution": "该问题要求分析一个三阶段 Lefkovitch 矩阵模型，通过合并两个相邻阶段将此模型降维为一个二阶段模型，并计算此降维在长期渐近增长率上引起的误差。分析必须在完全数学严谨性的基础上进行。\n\n给定的 $3 \\times 3$ Lefkovitch 矩阵为：\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0 & 0.8 & 1.2 \\\\\n0.5 & 0.3 & 0.1 \\\\\n0 & 0.4 & 0.6\n\\end{pmatrix}\n$$\n长期渐近增长率 $\\lambda$ 是 $A$ 的主特征值。它通过求解特征方程 $\\det(A - \\lambda I) = 0$ 来找到。\n$$\n\\det\n\\begin{pmatrix}\n-\\lambda & 0.8 & 1.2 \\\\\n0.5 & 0.3 - \\lambda & 0.1 \\\\\n0 & 0.4 & 0.6 - \\lambda\n\\end{pmatrix}\n\\;=\\; 0\n$$\n沿第一列展开行列式得到：\n$$\n(-\\lambda) \\left[ (0.3 - \\lambda)(0.6 - \\lambda) - (0.1)(0.4) \\right] - (0.5) \\left[ (0.8)(0.6 - \\lambda) - (1.2)(0.4) \\right] + 0 = 0\n$$\n$$\n(-\\lambda) \\left[ \\lambda^2 - 0.9\\lambda + 0.18 - 0.04 \\right] - (0.5) \\left[ 0.48 - 0.8\\lambda - 0.48 \\right] = 0\n$$\n$$\n(-\\lambda) (\\lambda^2 - 0.9\\lambda + 0.14) - (0.5)(-0.8\\lambda) = 0\n$$\n$$\n-\\lambda^3 + 0.9\\lambda^2 - 0.14\\lambda + 0.4\\lambda = 0\n$$\n$$\n-\\lambda^3 + 0.9\\lambda^2 + 0.26\\lambda = 0\n$$\n提出因子 $-\\lambda$：\n$$\n-\\lambda (\\lambda^2 - 0.9\\lambda - 0.26) = 0\n$$\n解为 $\\lambda = 0$ 以及二次方程 $\\lambda^2 - 0.9\\lambda - 0.26 = 0$ 的根。根据 Perron-Frobenius 定理，主特征值是唯一的正根。使用二次求根公式：\n$$\n\\lambda = \\frac{-(-0.9) + \\sqrt{(-0.9)^2 - 4(1)(-0.26)}}{2(1)} = \\frac{0.9 + \\sqrt{0.81 + 1.04}}{2} = \\frac{0.9 + \\sqrt{1.85}}{2}\n$$\n该值的数值约为 $\\lambda \\approx 1.1300735$。\n\n接下来，我们求解相应的右特征向量 $w = (w_1, w_2, w_3)^T$，它代表了稳定阶段分布 (SSD)。它满足 $(A - \\lambda I)w = 0$。\n$$\n\\begin{pmatrix}\n-\\lambda & 0.8 & 1.2 \\\\\n0.5 & 0.3 - \\lambda & 0.1 \\\\\n0 & 0.4 & 0.6 - \\lambda\n\\end{pmatrix}\n\\begin{pmatrix} w_1 \\\\ w_2 \\\\ w_3 \\end{pmatrix}\n= \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n根据第三行，有 $0.4w_2 + (0.6 - \\lambda)w_3 = 0$，可推得 $w_2 = \\frac{\\lambda - 0.6}{0.4} w_3$。\n根据第一行，有 $-\\lambda w_1 + 0.8w_2 + 1.2w_3 = 0$。代入 $w_2$ 的表达式：\n$$\n-\\lambda w_1 + 0.8 \\left( \\frac{\\lambda - 0.6}{0.4} \\right) w_3 + 1.2w_3 = 0\n$$\n$$\n-\\lambda w_1 + 2(\\lambda - 0.6)w_3 + 1.2w_3 = 0\n$$\n$$\n-\\lambda w_1 + (2\\lambda - 1.2 + 1.2)w_3 = 0\n$$\n$$\n-\\lambda w_1 + 2\\lambda w_3 = 0\n$$\n因为 $\\lambda \\ne 0$，我们有 $w_1 = 2w_3$。该特征向量与 $\\begin{pmatrix} 2w_3, \\frac{\\lambda-0.6}{0.4}w_3, w_3 \\end{pmatrix}^T$ 成正比。SSD 由比例给出，因此为方便起见，我们可以设 $w_3=1$，得到一个相对丰度向量 $w \\propto \\begin{pmatrix} 2, \\frac{\\lambda-0.6}{0.4}, 1 \\end{pmatrix}^T$。\n\n问题要求将阶段 $2$ 和 $3$ 合并为一个复合阶段。权重概率 $p_2$ 和 $p_3$ 是在稳定阶段分布时，一个体在处于复合阶段的条件下，其分别处于阶段 $2$ 或 $3$ 的条件概率。\n$$\np_2 = \\frac{w_2}{w_2 + w_3} \\quad \\text{和} \\quad p_3 = \\frac{w_3}{w_2 + w_3}\n$$\n使用我们关于 $w_2$ 和 $w_3$ 的表达式：\n$$\nw_2 + w_3 = \\left(\\frac{\\lambda-0.6}{0.4}\\right) + 1 = \\frac{\\lambda - 0.6 + 0.4}{0.4} = \\frac{\\lambda - 0.2}{0.4}\n$$\n因此，这些概率为：\n$$\np_2 = \\frac{(\\lambda - 0.6)/0.4}{(\\lambda - 0.2)/0.4} = \\frac{\\lambda - 0.6}{\\lambda - 0.2}\n$$\n$$\np_3 = \\frac{1}{(\\lambda - 0.2)/0.4} = \\frac{0.4}{\\lambda - 0.2}\n$$\n可以验证 $p_2 + p_3 = \\frac{\\lambda - 0.6 + 0.4}{\\lambda - 0.2} = 1$。\n\n现在，我们为新的阶段结构构建降维的 $2 \\times 2$ 矩阵 $A'$，新的阶段结构为：阶段 $1'$ (原始阶段 $1$) 和阶段 $2'$ (阶段 $2$ 和 $3$ 的复合阶段)。\n$$\nA' = \\begin{pmatrix} A'_{11} & A'_{12} \\\\ A'_{21} & A'_{22} \\end{pmatrix}\n$$\n$A'_{11}$: 从阶段 $1'$ 留在阶段 $1'$ 的个体。这等于 $A_{11} = 0$。\n$A'_{21}$: 从阶段 $1'$ 转移到阶段 $2'$ 的个体。这等于从阶段 $1$ 到阶段 $2$ 和 $3$ 的转移之和：$A'_{21} = A_{21} + A_{31} = 0.5 + 0 = 0.5$。\n$A'_{12}$: 阶段 $2'$ 的有效繁殖力。这等于阶段 $2$ 和 $3$ 繁殖力的加权平均值：$A'_{12} = p_2 A_{12} + p_3 A_{13} = p_2(0.8) + p_3(1.2)$。代入 $p_2$ 和 $p_3$ 的符号表达式：\n$$\nA'_{12} = \\left(\\frac{\\lambda - 0.6}{\\lambda - 0.2}\\right) (0.8) + \\left(\\frac{0.4}{\\lambda - 0.2}\\right) (1.2) = \\frac{0.8\\lambda - 0.48 + 0.48}{\\lambda - 0.2} = \\frac{0.8\\lambda}{\\lambda - 0.2}\n$$\n$A'_{22}$: 从阶段 $2'$ 留在阶段 $2'$ 的个体。一个处于阶段 $2'$ 的个体，有 $p_2$ 的概率是原始阶段 $2$ 的个体，有 $p_3$ 的概率是原始阶段 $3$ 的个体。其在下一时间步中对新复合阶段的贡献，是对原始阶段 $2$ 和 $3$ 到新复合阶段（即原始阶段 $2$ 和 $3$）的转移率进行加权平均得到的。\n$$\nA'_{22} = p_2 (A_{22} + A_{32}) + p_3 (A_{23} + A_{33}) = p_2(0.3 + 0.4) + p_3(0.1 + 0.6) = p_2(0.7) + p_3(0.7) = 0.7(p_2+p_3) = 0.7\n$$\n降维矩阵为：\n$$\nA' = \\begin{pmatrix}\n0 & \\frac{0.8\\lambda}{\\lambda - 0.2} \\\\\n0.5 & 0.7\n\\end{pmatrix}\n$$\n$A'$ 的主特征值 $\\lambda'$ 可由其特征方程 $\\det(A' - \\lambda' I) = 0$ 求得：\n$$\n\\det\\begin{pmatrix} -\\lambda' & \\frac{0.8\\lambda}{\\lambda - 0.2} \\\\ 0.5 & 0.7 - \\lambda' \\end{pmatrix} = 0\n$$\n$$\n(-\\lambda')(0.7 - \\lambda') - (0.5)\\left(\\frac{0.8\\lambda}{\\lambda - 0.2}\\right) = 0\n$$\n$$\n(\\lambda')^2 - 0.7\\lambda' - \\frac{0.4\\lambda}{\\lambda - 0.2} = 0\n$$\n我们现在必须检验原始特征值 $\\lambda$ 是否是这个新方程的一个解。让我们代入 $\\lambda' = \\lambda$：\n$$\n\\lambda^2 - 0.7\\lambda - \\frac{0.4\\lambda}{\\lambda - 0.2} = 0\n$$\n由于 $\\lambda$ 是主特征值，$\\lambda > 0$，我们可以用 $\\lambda$ 除以该方程两边：\n$$\n\\lambda - 0.7 - \\frac{0.4}{\\lambda - 0.2} = 0\n$$\n两边乘以 $(\\lambda - 0.2)$ 以消去分母（注意 $\\lambda \\approx 1.13 \\ne 0.2$）：\n$$\n(\\lambda - 0.7)(\\lambda - 0.2) - 0.4 = 0\n$$\n$$\n\\lambda^2 - 0.2\\lambda - 0.7\\lambda + 0.14 - 0.4 = 0\n$$\n$$\n\\lambda^2 - 0.9\\lambda - 0.26 = 0\n$$\n这恰好是原始矩阵 $A$ 的特征方程。由于 $\\lambda$ 满足此方程，$\\lambda$ 是降维矩阵 $A'$ 的一个特征值。因为 $A'$ 是一个非负、不可约矩阵，其主特征值是唯一的正值。因此，$A'$ 的主特征值 $\\lambda'$ 必须等于 $\\lambda$。\n\n长期增长率中引起的绝对误差为 $|\\lambda' - \\lambda|$。由于我们已经证明了 $\\lambda' = \\lambda$，误差为：\n$$\n|\\lambda' - \\lambda| = |\\lambda - \\lambda| = 0\n$$\n这个聚合过程，当基于原始系统的稳定阶段分布时，其构造方式可以精确地保持主特征值不变。任何通过数值计算得到的非零结果都将是舍入误差的假象。解析结果是精确的。", "answer": "$$\\boxed{0}$$", "id": "2536679"}, {"introduction": "当我们将模型从离散阶段扩展到如体型等连续性状时，积分投影模型（Integral Projection Models, IPMs）是强大的工具。然而，将连续模型离散化以进行计算会带来实际挑战。本练习将聚焦于一个关键问题——“驱逐”（eviction），即个体因生长或发育而超出模型预设的性状范围所导致的概率损失，并让您动手实现一种严谨的校正方法以保证模型的准确性。[@problem_id:2536709]", "problem": "一个基于体型结构的积分投影模型 (IPM) 通过线性积分算子来表示具有连续状态变量 $y$（例如，体型大小）的种群动态\n$$ n_{t+1}(y) = \\int_{y_{\\min}}^{y_{\\max}} K(y,x)\\,n_t(x)\\,dx, $$\n其中 $K(y,x)$ 是一个包含生存-生长和繁殖组分的核。生存-生长组分可以写为 $s(x)\\,g(y\\mid x)$，其中 $s(x)$ 是生存概率，$g(y\\mid x)$ 是给定生长前状态 $x$ 的情况下（在存活个体中）生长后状态为 $y$ 的条件概率密度函数，满足 $\\int_{-\\infty}^{\\infty} g(y\\mid x)\\,dy = 1$。为了对IPM进行计算，通常将状态空间限制在一个有界域 $[y_{\\min},y_{\\max}]$ 内，并在具有节点 $y_j$ 和权重 $w_j>0$ 的网格 $\\{(y_j,w_j)\\}_{j=1}^M$ 上应用求积法则，以有限和来近似积分。\n\n当 $g(y\\mid x)$ 将非零概率质量分布在 $[y_{\\min},y_{\\max}]$ 之外时，对于一个固定的 $x$，其生长转移的离散近似\n$$ \\sum_{j=1}^M w_j\\,g(y_j\\mid x), $$\n会严格小于 $1$。这种现象被称为“驱逐”（eviction），因为概率质量从离散化域中丢失了。“驱逐”会使从离散化算子导出的估计（例如，最终投影矩阵的主特征值）产生偏差，并且会使生长后体型的条件期望 $\\mathbb{E}[y\\mid x]$ 失真。\n\n考虑一个IPM，其状态空间为 $[y_{\\min},y_{\\max}] = [1,10]$，生长核 $g(y\\mid x)$ 为高斯分布，均值为 $m(x)$，方差为有限的 $\\sigma^2(x)$。对于一个特定的生长前体型 $x^\\star$，其均值 $m(x^\\star)=7.80$，在网格上使用中点求积法，对 $x^\\star$ 处的生长组分，得出以下内部近似值：\n- 内部质量（零阶矩）：$S(x^\\star) = \\sum_{j=1}^M w_j\\,g(y_j\\mid x^\\star) = 0.94$，\n- 内部一阶矩：$E_{\\text{in}}(x^\\star) = \\sum_{j=1}^M y_j\\,w_j\\,g(y_j\\mid x^\\star) = 7.52$。\n假设 $y_1=1$ 和 $y_M=10$ 是边界网格节点。我们希望对 $x^\\star$ 处的离散生长转移进行修正，以满足：\n(i) 保持总概率（离散和等于 $1$），并且\n(ii) 保持生长后体型的条件期望 $\\mathbb{E}[y\\mid x^\\star] = m(x^\\star)$。\n一种可行的方法是在 $y_1$ 处增加一个非负的边界分配值 $\\alpha(x^\\star)$，在 $y_M$ 处增加一个非负的边界分配值 $\\beta(x^\\star)$（所有内部权重保持不变），并选择这两个值以满足上述两个条件。\n\n哪个选项正确解释了“驱逐”及其影响，并提出了一种既能保持总概率又能保持预期生长后体型的修正方法，同时为上述数值给出了数值上有效的边界分配值 $\\alpha(x^\\star)$ 和 $\\beta(x^\\star)$？\n\nA. 如果网格足够密集，“驱逐”是可忽略不计的；主特征值和一阶矩不受影响。最佳的修正是丢弃被驱逐的质量。设置 $\\alpha(x^\\star)=0$ 和 $\\beta(x^\\star)=0$。\n\nB. “驱逐”人为地减少了行和，使主特征值向下偏倚。最佳的修正是通过将所有 $w_j\\,g(y_j\\mid x^\\star)$ 除以 $S(x^\\star)$ 来重新归一化内部权重；设置 $\\alpha(x^\\star)=0$ 和 $\\beta(x^\\star)=0$。\n\nC. “驱逐”从离散化状态空间中移除了概率质量，导致人为的死亡率，并使主特征值和条件平均体型向下偏倚。一种矩守恒的边界重分布方法通过选择满足 $\\alpha(x^\\star)+\\beta(x^\\star)=1-S(x^\\star)$ 和 $y_1\\alpha(x^\\star)+y_M\\beta(x^\\star)=m(x^\\star)-E_{\\text{in}}(x^\\star)$ 的 $\\alpha(x^\\star),\\beta(x^\\star)\\ge 0$ 来恢复零阶矩和一阶矩。对于给定值，$\\alpha(x^\\star)\\approx 0.0356$ 且 $\\beta(x^\\star)\\approx 0.0244$。\n\nD. “驱逐”移除了低于 $y_{\\min}$ 和高于 $y_{\\max}$ 的质量。为避免主特征值的偏差，将所有丢失的质量置于上边界：设置 $\\alpha(x^\\star)=0$ 和 $\\beta(x^\\star)=1-S(x^\\star)=0.06$。\n\nE. “驱逐”移除了质量；为了保持期望体型，将丢失的质量按距均值的距离成比例地分割：设置 $\\alpha(x^\\star)=(1-S(x^\\star))\\,(y_M-m(x^\\star))/(y_M-y_1)$ 和 $\\beta(x^\\star)=(1-S(x^\\star))\\,(m(x^\\star)-y_1)/(y_M-y_1)$，并保持内部权重不变，这能确保组合后的均值等于 $m(x^\\star)$。", "solution": "首先对问题陈述进行严格验证。\n\n### 步骤1：提取已知条件\n- 基于体型的种群动态由积分投影模型（IPM）建模：$$n_{t+1}(y) = \\int_{y_{\\min}}^{y_{\\max}} K(y,x)\\,n_t(x)\\,dx$$\n- 核 $K(y,x)$ 包含一个生存-生长组分 $s(x)\\,g(y\\mid x)$。\n- $g(y\\mid x)$ 是给定生长前体型 $x$ 时，生长后体型为 $y$ 的条件概率密度函数（PDF），满足 $\\int_{-\\infty}^{\\infty} g(y\\mid x)\\,dy = 1$。\n- 状态空间有界于域 $[y_{\\min}, y_{\\max}] = [1, 10]$。\n- 使用带有网格点 $y_j$ 和权重 $w_j$ 的求积法则进行数值近似。边界网格节点为 $y_1 = 1$ 和 $y_M = 10$。\n- 当生长总概率的离散近似值小于1时，即 $\\sum_{j=1}^M w_j\\,g(y_j\\mid x) < 1$，发生“驱逐”现象。\n- 生长核 $g(y\\mid x)$ 是高斯分布，均值为 $m(x)$，方差为 $\\sigma^2(x)$。\n- 对于特定体型 $x^\\star$，真实的生长后体型条件期望为 $\\mathbb{E}[y\\mid x^\\star] = m(x^\\star) = 7.80$。\n- 在域上，生长PDF零阶矩的数值近似值为 $S(x^\\star) = \\sum_{j=1}^M w_j\\,g(y_j\\mid x^\\star) = 0.94$。\n- 在域上，生长PDF一阶矩的数值近似值为 $E_{\\text{in}}(x^\\star) = \\sum_{j=1}^M y_j\\,w_j\\,g(y_j\\mid x^\\star) = 7.52$。\n- 寻求一种修正方法，通过在边界 $y_1$ 处增加非负分配值 $\\alpha(x^\\star)$ 和在 $y_M$ 处增加非负分配值 $\\beta(x^\\star)$ 来满足两个条件：\n    1.  `(i)` 保持总概率：修正后的离散和必须等于 $1$。\n    2.  `(ii)` 保持生长后体型的条件期望：修正后的离散期望必须等于 $m(x^\\star)$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据。积分投影模型是理论生态学中的一个标准工具。在数值实现中由于域截断导致的“驱逐”现象是一个有据可查的问题。设计一种保留矩（在此情况下是零阶矩和一阶矩）的修正方法，是减轻这种数值假象的一种标准而严谨的途径。该问题是适定的，提供了所有必要的数据来构建和求解未知的边界分配值。语言客观、精确。该问题不包含科学或事实上的不健全之处，不是比喻性的，是自洽的，不是不切实际的，结构良好，不是平凡的，并且是可科学验证的。\n\n### 步骤3：结论与行动\n问题陈述有效。我将继续推导解决方案并评估各个选项。\n\n### 求解推导\n\n目标是找到非负值 $\\alpha(x^\\star)$ 和 $\\beta(x^\\star)$，它们被加到边界 $y_1$ 和 $y_M$ 的离散概率分布上，以修正因驱逐而损失的概率质量。\n\n离散近似在域 $[y_1, y_M]$ 内捕获的总概率质量为 $S(x^\\star) = 0.94$。真实的总概率是 $1$。因此，被驱逐的总质量是：\n$$ M_{\\text{evicted}} = 1 - S(x^\\star) = 1 - 0.94 = 0.06 $$\n条件(i)要求新的边界分配值之和等于这个被驱逐的质量，从而将总概率恢复到 $1$：\n$$ \\alpha(x^\\star) + \\beta(x^\\star) = 1 - S(x^\\star) $$\n数值上，即为：\n$$ \\alpha(x^\\star) + \\beta(x^\\star) = 0.06 \\quad (*)$$\n\n由内部近似捕获的体型一阶矩（期望）是 $E_{\\text{in}}(x^\\star) = 7.52$。真实的期望是 $m(x^\\star) = 7.80$。一阶矩的差异是：\n$$ E_{\\text{discrepancy}} = m(x^\\star) - E_{\\text{in}}(x^\\star) = 7.80 - 7.52 = 0.28 $$\n条件(ii)要求由边界分配值贡献的一阶矩必须恰好补偿这个差异。由 $\\alpha(x^\\star)$ 在 $y_1$ 和 $\\beta(x^\\star)$ 在 $y_M$ 贡献的矩是 $y_1 \\alpha(x^\\star) + y_M \\beta(x^\\star)$。因此：\n$$ y_1 \\alpha(x^\\star) + y_M \\beta(x^\\star) = m(x^\\star) - E_{\\text{in}}(x^\\star) $$\n使用给定的边界点值 $y_1=1$ 和 $y_M=10$，我们得到：\n$$ 1 \\cdot \\alpha(x^\\star) + 10 \\cdot \\beta(x^\\star) = 0.28 \\quad (**) $$\n\n我们现在得到了一个包含两个未知数 $\\alpha(x^\\star)$ 和 $\\beta(x^\\star)$ 的二元线性方程组：\n1. $\\alpha(x^\\star) + \\beta(x^\\star) = 0.06$\n2. $\\alpha(x^\\star) + 10\\beta(x^\\star) = 0.28$\n\n从方程(1)，我们将 $\\alpha(x^\\star)$ 用 $\\beta(x^\\star)$ 表示：\n$$ \\alpha(x^\\star) = 0.06 - \\beta(x^\\star) $$\n将此代入方程(2)：\n$$ (0.06 - \\beta(x^\\star)) + 10\\beta(x^\\star) = 0.28 $$\n$$ 0.06 + 9\\beta(x^\\star) = 0.28 $$\n$$ 9\\beta(x^\\star) = 0.28 - 0.06 = 0.22 $$\n$$ \\beta(x^\\star) = \\frac{0.22}{9} \\approx 0.02444... $$\n现在，我们求 $\\alpha(x^\\star)$:\n$$ \\alpha(x^\\star) = 0.06 - \\frac{0.22}{9} = \\frac{0.54 - 0.22}{9} = \\frac{0.32}{9} \\approx 0.03555... $$\n这些值为 $\\alpha(x^\\star) \\approx 0.0356$ 和 $\\beta(x^\\star) \\approx 0.0244$。两者均为非负，符合要求。\n\n### 逐项分析选项\n\n**A. 如果网格足够密集，“驱逐”是可忽略不计的；主特征值和一阶矩不受影响。最佳的修正是丢弃被驱逐的质量。设置 $\\alpha(x^\\star)=0$ 和 $\\beta(x^\\star)=0$。**\n这个说法是不正确的。对于此转移，损失了 $1-S(x^\\star) = 0.06$ 或 $6\\%$ 的概率质量，“驱逐”现象不可忽略。这相当于引入了人为死亡率，这将使主特征值（种群增长率）向下偏倚。一阶矩也明显受到影响，因为内部均值为 $7.52/0.94 \\approx 8.0$，这与真实均值 $7.80$ 不同。设置 $\\alpha(x^\\star)=0$ 和 $\\beta(x^\\star)=0$ 未能修正这些偏差。\n**结论：不正确。**\n\n**B. “驱逐”人为地减少了行和，使主特征值向下偏倚。最佳的修正是通过将所有 $w_j\\,g(y_j\\mid x^\\star)$ 除以 $S(x^\\star)$ 来重新归一化内部权重；设置 $\\alpha(x^\\star)=0$ 和 $\\beta(x^\\star)=0$。**\n第一句话是正确的：减小的行和等同于人为死亡率，并使主特征值向下偏倚。然而，所提出的修正方法是不充分的。重新归一化内部权重恢复了零阶矩（总概率等于 $1$），因为 $\\sum_j \\frac{w_j g(y_j \\mid x^\\star)}{S(x^\\star)} = \\frac{1}{S(x^\\star)} \\sum_j w_j g(y_j \\mid x^\\star) = \\frac{S(x^\\star)}{S(x^\\star)} = 1$。然而，该方法不能保持一阶矩。修正后的均值将是 $\\frac{1}{S(x^\\star)}\\sum_j y_j w_j g(y_j \\mid x^\\star) = \\frac{E_{\\text{in}}(x^\\star)}{S(x^\\star)} = \\frac{7.52}{0.94} \\approx 8.0$，这不等于真实均值 $m(x^\\star)=7.80$。\n**结论：不正确。**\n\n**C. “驱逐”从离散化状态空间中移除了概率质量，导致人为的死亡率，并使主特征值和条件平均体型向下偏倚。一种矩守恒的边界重分布方法通过选择满足 $\\alpha(x^\\star)+\\beta(x^\\star)=1-S(x^\\star)$ 和 $y_1\\alpha(x^\\star)+y_M\\beta(x^\\star)=m(x^\\star)-E_{\\text{in}}(x^\\star)$ 的 $\\alpha(x^\\star),\\beta(x^\\star)\\ge 0$ 来恢复零阶矩和一阶矩。对于给定值，$\\alpha(x^\\star)\\approx 0.0356$ 且 $\\beta(x^\\star)\\approx 0.0244$。**\n该选项正确地描述了“驱逐”的后果。它正确地构建了为同时守恒零阶矩（总概率）和一阶矩（均值）所需的二元线性方程组。所提供的数值 $\\alpha(x^\\star)\\approx 0.0356$ 和 $\\beta(x^\\star)\\approx 0.0244$ 与我们推导的解完全匹配。该方法为数值偏差提供了严谨的修正。\n**结论：正确。**\n\n**D. “驱逐”移除了低于 $y_{\\min}$ 和高于 $y_{\\max}$ 的质量。为避免主特征值的偏差，将所有丢失的质量置于上边界：设置 $\\alpha(x^\\star)=0$ 和 $\\beta(x^\\star)=1-S(x^\\star)=0.06$。**\n该方法通过加回所有丢失的质量来保持零阶矩（总概率）。然而，它未能保持一阶矩。设置 $\\alpha(x^\\star)=0$ 和 $\\beta(x^\\star)=0.06$ 会导致修正后的一阶矩为 $E_{\\text{corr}} = E_{\\text{in}}(x^\\star) + y_M \\beta(x^\\star) = 7.52 + 10 \\cdot (0.06) = 7.52 + 0.60 = 8.12$。这个值 $8.12$ 不等于真实均值 $m(x^\\star)=7.80$。\n**结论：不正确。**\n\n**E. “驱逐”移除了质量；为了保持期望体型，将丢失的质量按距均值的距离成比例地分割：设置 $\\alpha(x^\\star)=(1-S(x^\\star))\\,(y_M-m(x^\\star))/(y_M-y_1)$ 和 $\\beta(x^\\star)=(1-S(x^\\star))\\,(m(x^\\star)-y_1)/(y_M-y_1)$，并保持内部权重不变，这能确保组合后的均值等于 $m(x^\\star)$。**\n该选项提出了一种用于分配丢失质量的特定启发式方法。让我们来分析它。分配值的和是 $\\alpha(x^\\star) + \\beta(x^\\star) = (1-S(x^\\star))\\left(\\frac{y_M-m(x^\\star)}{y_M-y_1} + \\frac{m(x^\\star)-y_1}{y_M-y_1}\\right) = (1-S(x^\\star))\\left(\\frac{y_M-y_1}{y_M-y_1}\\right) = 1-S(x^\\star)$。所以，此方法确实守恒总概率。但“确保组合后的均值等于 $m(x^\\star)$”的说法等同于选项C中导出的条件：$y_1\\alpha(x^\\star) + y_M\\beta(x^\\star) = m(x^\\star) - E_{\\text{in}}(x^\\star)$。然而，这种启发式方法给出的附加矩为 $y_1\\alpha(x^\\star) + y_M\\beta(x^\\star) = (1-S(x^\\star))m(x^\\star)$，这通常不等于 $m(x^\\star) - E_{\\text{in}}(x^\\star)$。使用给定数值，该启发式方法增加的矩为 $(1-0.94) \\cdot 7.80 = 0.06 \\cdot 7.80 = 0.468$。这不等于所需的附加矩 $0.28$。总的修正后均值为 $E_{\\text{in}}(x^\\star) + (1-S(x^\\star))m(x^\\star) = 7.52 + 0.468 = 7.988$，这不等于 $m(x^\\star)=7.80$。因此，该选项中的说法是错误的。\n**结论：不正确。**", "answer": "$$\\boxed{C}$$", "id": "2536709"}]}