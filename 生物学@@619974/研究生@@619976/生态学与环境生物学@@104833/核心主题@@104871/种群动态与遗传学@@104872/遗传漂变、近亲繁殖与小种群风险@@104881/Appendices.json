{"hands_on_practices": [{"introduction": "我们的动手实践始于探究有限种群规模最基本的后果：由于随机遗传漂变导致的遗传多样性稳定丧失。这个练习 [@problem_id:2494469] 要求您从第一性原理出发，推导出经典的杂合度 ($H_t$) 衰减方程。通过完成这一推导，您将对遗传变异如何随时间流逝以及其与近交累积 ($F_t$) 的直接关系有一个具体的理解。", "problem": "一个封闭的、随机交配的二倍体种群遵循赖特-费舍尔模型，其有效种群大小 $N_{e}$ 恒定。您正在研究一个没有突变、迁移或选择的单个中性位点。令 $H_{t}$ 表示期望杂合度（在第 $t$ 代中随机抽样的两个等位基因处于不同等位基因状态的概率），令 $F_{t}$ 表示近交系数（在第 $t$ 代中随机抽样的两个等位基因同源相同的概率）。\n\n从 $H_{t}$ 和 $F_{t}$ 的基本定义以及大小为 $N_{e}$ 的二倍体种群中配子的随机结合出发，从第一性原理推导一个用 $H_{t}$ 和 $N_{e}$ 表示 $H_{t+1}$ 的递归关系，然后求解该递归式，得到 $H_{t}$ 作为 $H_{0}$、$N_{e}$ 和 $t$ 的函数的闭式解。\n\n将您的结果应用于一个初始杂合度 $H_{0} = 0.8$、有效种群大小 $N_{e} = 100$ 的种群，计算 $t = 50$ 代后的期望杂合度 $H_{50}$，以及 50 代后初始遗传多样性保留的比例 $H_{50}/H_{0}$。将所求的两个量表示为纯数（无单位）。将您的数值答案四舍五入到四位有效数字。", "solution": "我们在赖特-费舍尔假设下进行分析：一个封闭的、随机交配的、具有恒定有效大小 $N_{e}$ 的二倍体种群，世代不重叠，并且研究一个没有突变、迁移或选择的中性位点。令 $H_{t}$ 为第 $t$ 代的期望杂合度，令 $F_{t}$ 为近交系数，即在第 $t$ 代中随机抽样的两个等位基因同源相同的概率。\n\n基本定义与事实：\n- 根据定义，$F_{t}$ 是同源相同的概率；在没有突变的情况下，状态相同随时间推移与同源相同是一致的，因此期望杂合度通过其补集与 $F_{t}$ 相关。更准确地说，两个抽样等位基因不同的概率等于它们不是从初始状态传播而来的同源相同的概率。这得到了标准关系式\n$$\nH_{t} = H_{0}\\bigl(1 - F_{t}\\bigr),\n$$\n这是一个经过充分验证的、连接期望杂合度与近交系数的结果。\n- 在有效大小为 $N_{e}$ 的二倍体种群中，配子随机结合的情况下，在第 $t+1$ 代中抽样的两个等位基因在紧邻的上一代发生溯祖（即，是同一个亲本基因拷贝的复制品）的概率是\n$$\n\\frac{1}{2N_{e}}.\n$$\n如果它们没有立即发生溯祖（概率为 $1 - \\frac{1}{2N_{e}}$），那么它们的同源相同性与上一代相同。这导出了近交系数的经典递归式：\n$$\nF_{t+1} \\;=\\; \\frac{1}{2N_{e}} \\;+\\; \\Bigl(1 - \\frac{1}{2N_{e}}\\Bigr) F_{t}.\n$$\n\n从 $H_{t}$ 和 $F_{t}$ 之间的关系，我们推导杂合度的递归关系。对 $F$ 的递归式两边取补集：\n\n$$\n1 - F_{t+1} \\;=\\; 1 - \\frac{1}{2N_{e}} - \\Bigl(1 - \\frac{1}{2N_{e}}\\Bigr) F_{t}\n\\;=\\; \\Bigl(1 - \\frac{1}{2N_{e}}\\Bigr)\\bigl(1 - F_{t}\\bigr).\n$$\n\n两边同乘以 $H_{0}$ 并使用 $H_{t} = H_{0}(1 - F_{t})$ 得\n\n$$\nH_{t+1} \\;=\\; \\Bigl(1 - \\frac{1}{2N_{e}}\\Bigr) H_{t}.\n$$\n\n这个一阶线性差分方程通过迭代求解得到\n\n$$\nH_{t} \\;=\\; H_{0}\\Bigl(1 - \\frac{1}{2N_{e}}\\Bigr)^{t}.\n$$\n\n\n现在我们将其应用于 $H_{0} = 0.8$，$N_{e} = 100$ 和 $t = 50$ 的情况。计算每代保留因子：\n\n$$\n1 - \\frac{1}{2N_{e}} \\;=\\; 1 - \\frac{1}{200} \\;=\\; \\frac{199}{200} \\;=\\; 0.995.\n$$\n\n因此，\n\n$$\nH_{50} \\;=\\; 0.8 \\times 0.995^{50}.\n$$\n\n为了计算 50 代后初始多样性保留的比例，我们构建\n\n$$\n\\frac{H_{50}}{H_{0}} \\;=\\; 0.995^{50}.\n$$\n\n\n现在我们计算 $0.995^{50}$。使用重复平方或对数法可得\n\n$$\n0.995^{50} \\approx 0.7783151801\\ldots\n$$\n\n于是，\n\n$$\nH_{50} \\;=\\; 0.8 \\times 0.7783151801\\ldots \\;\\approx\\; 0.6226521441\\ldots\n$$\n\n\n四舍五入到四位有效数字：\n- $H_{50} \\approx 0.6227$,\n- $H_{50}/H_{0} \\approx 0.7783$.\n\n按要求，这两个量都是无量纲的。", "answer": "$$\n\\boxed{\\begin{pmatrix}0.6227 & 0.7783\\end{pmatrix}}\n$$", "id": "2494469"}, {"introduction": "在确定了遗传多样性如何衰减之后，我们现在转向控制这一衰减速率的关键因素：有效种群大小 ($N_e$)。本实践 [@problem_id:2494485] 利用偏斜的性别比这一常见的现实世界场景，来阐释为何 $N_e$ 通常远小于普查数量。通过从其与近交相关的基本定义中推导出 $N_e$ 的公式，您将从机理上理解种群结构如何加速遗传漂变的过程。", "problem": "一个孤立的、雌雄异体的二倍体物种，在一个给定的繁殖季节里，普查数量为 $N_m = 50$ 只成年雄性和 $N_f = 200$ 只成年雌性。假设一个理想化的 Wright–Fisher 模型，具有离散世代、随机交配、世代不重叠，并且没有选择、迁移或突变。每个合子由一个从雄性配子池中抽取的单倍体配子和一个从雌性配子池中抽取的单倍体配子结合而成，同一性别内的所有成年个体平均贡献相等数量的配子，且后代数量遵循该模型固有多项式抽样。\n\n使用近交有效种群大小的定义，即由于随机抽样导致的近交系数 $F$ 的每代增量 $\\Delta F$ 满足 $\\Delta F = 1/(2 N_e)$（其中 $N_e$ 是某个能产生与理想雌雄同体种群相同 $\\Delta F$ 的值），通过考虑在 $t$ 代随机抽样的两个基因拷贝因在 $t-1$ 代发生溯祖合并而同源相同（Identity by Descent, IBD）的概率，推导出这个雌雄异体种群的 $\\Delta F$。据此，在这些假设下计算给定 $N_m$ 和 $N_f$ 的有效种群大小 $N_e$。请给出精确的数值答案。然后，基于你所使用的抽样过程，用机制性的术语简要解释为什么偏斜的性别比会相对于普查数量降低 $N_e$。\n\n你的最终数值答案必须是一个实数。不需要四舍五入。不需要单位。", "solution": "我们从基于近交的有效种群大小的定义开始：在一个大小为 $N$ 的雌雄同体的理想 Wright–Fisher 种群中，近交系数的每代变化量满足 $\\Delta F = 1/(2N)$。根据近交有效种群大小 $N_e$ 的定义，任何近交每代增量为 $\\Delta F$ 的种群，其 $N_e$ 满足 $\\Delta F = 1/(2 N_e)$。\n\n为了找到在随机交配条件下，一个具有 $N_m$ 个雄性和 $N_f$ 个雌性的雌雄异体种群的 $N_e$，我们推导其方差有效种群大小 $N_e^{(v)}$。在理想的赖特-费舍尔模型中，它与近交有效种群大小 $N_e^{(i)}$ 相等。\n\n等位基因频率的代际变化方差由 $\\text{Var}(\\Delta p) = p(1-p)/(2N_e)$ 定义。我们也可以通过考虑从 $N_m$ 个雄性和 $N_f$ 个雌性中抽样配子来计算这个方差。下一代基因频率是父源和母源配子频率的平均值，因此其方差是：\n$$\n\\text{Var}(\\Delta p) = \\frac{1}{4} \\left( \\text{Var}(p_{\\text{gametes}, m}) + \\text{Var}(p_{\\text{gametes}, f}) \\right)\n$$\n从 $N_m$ 个二倍体雄性（$2N_m$ 个基因拷贝）中抽样的配子频率方差为 $\\text{Var}(p_{\\text{gametes}, m}) = \\frac{p(1-p)}{2N_m}$。同理，雌性为 $\\frac{p(1-p)}{2N_f}$。因此，\n$$\n\\text{Var}(\\Delta p) = \\frac{1}{4} \\left( \\frac{p(1-p)}{2N_m} + \\frac{p(1-p)}{2N_f} \\right) = \\frac{p(1-p)}{8} \\left( \\frac{1}{N_m} + \\frac{1}{N_f} \\right).\n$$\n将两个 $\\text{Var}(\\Delta p)$ 的表达式相等：\n$$\n\\frac{p(1-p)}{2N_e} = \\frac{p(1-p)}{8} \\left( \\frac{1}{N_m} + \\frac{1}{N_f} \\right).\n$$\n简化后得到：\n$$\n\\frac{1}{N_e} = \\frac{1}{4} \\left( \\frac{1}{N_m} + \\frac{1}{N_f} \\right) = \\frac{1}{4N_m} + \\frac{1}{4N_f}.\n$$\n求解 $N_e$ 得到公认的雌雄异体有效种群大小公式：\n$$\nN_e = \\frac{4 N_m N_f}{N_m + N_f}.\n$$\n代入 $N_m = 50$ 和 $N_f = 200$，\n$$\nN_e \\;=\\; \\frac{4 \\times 50 \\times 200}{50 + 200}\n\\;=\\; \\frac{4 \\times 10000}{250}\n\\;=\\; \\frac{40000}{250}\n\\;=\\; 160.\n$$\n因此，有效种群大小为 $160$。\n\n在性别比偏斜的情况下 $N_e$ 减小的机制性解释：有效种群大小是雄性和雌性数量的调和平均数的四倍。调和平均数由较小的数值主导。当性别比偏斜时（例如，$N_m \\ll N_f$），数量较少的性别（雄性）造成了遗传瓶颈。下一代的每个个体都必须有一个父亲和一个母亲，因此，尽管雌性数量众多，但基因多样性通过雄性传递时受到了严格的限制。这增加了后代共享同一个父亲的概率，从而增加了遗传漂变的速度（等同于增加了等位基因频率方差和近交率），并因此降低了有效种群大小 $N_e$。", "answer": "$$\\boxed{160}$$", "id": "2494485"}, {"introduction": "我们最后的练习将我们已探索的所有概念融合成一个强有力的综合体：一个关于灭绝漩涡的动态模型。这项计算实践 [@problem_id:2494475] 要求您构建一个将种群统计学与遗传动态耦合起来的仿真模型。您将主动模拟一个反馈循环，其中小种群规模增加了近交，而近交又反过来降低了种群增长率，可能将种群推向灭绝，从而清晰地、亲手展示了小种群面临的最重大风险之一。", "problem": "要求您构建并分析一个离散时间的人口-遗传耦合模型，该模型能够捕捉小种群中近交累积与种群增长之间的反馈。您的实现必须从基础且经过充分检验的关系出发，不得依赖任何未指明的启发式方法。\n\n定义一个种群大小序列 $\\{N_t\\}_{t \\ge 0}$ 和一个近交系数序列 $\\{F_t\\}_{t \\ge 0}$，它们具有以下性质。\n\n- 种群动态。使用 Ricker 型密度调节和乘性 Allee 效应。每代的普查规模更新如下：\n$$\nN_{t+1} \\;=\\; N_t \\;\\exp\\!\\big(r \\,(1 - N_t/K)\\big)\\; \\exp(-B\\,F_t)\\; \\frac{N_t}{N_t + A},\n$$\n其中 $r$ 是内禀增长参数，$K$ 是环境承载力，$A$ 是 Allee 效应尺度，而 $\\exp(-B F_t)$ 是由近交引起的平均适合度下降（近交负载参数 $B$ 以二倍体致死当量为单位）。\n\n- 遗传学。在每一代中，近交系数根据标准的 Wright–Fisher 随机交配递归式进行更新，不考虑突变或迁移：\n$$\nF_{t+1} \\;=\\; F_t \\;+\\; \\frac{1 - F_t}{2\\,N_{e,t}},\n$$\n其中有效种群大小（记为 $N_{e,t}$）随普查规模变化，关系为 $N_{e,t} \\,=\\, \\alpha\\, N_t$，且 $\\alpha \\in (0,1]$ 捕捉了繁殖成功率的方差以及对理想条件的偏离。为在极小种群中保持生物学合理性，对有效种群大小施加一个下界，使得 $N_{e,t} \\leftarrow \\max(\\alpha N_t, N_e^{\\min})$，其中 $N_e^{\\min} = 1$。\n\n- 灭绝边界。将 $N_t \\le N_{\\mathrm{ext}}$ 视为一个吸收性灭绝状态，其中 $N_{\\mathrm{ext}} = 10^{-3}$。一旦 $N_t \\le N_{\\mathrm{ext}}$，该种群即被视为灭绝，并为分类目的保持此状态。\n\n解释。该耦合产生了一个反馈：小的 $N_t$ 会减小 $N_{e,t}$，这会加速 $F_t$ 的增长，从而降低平均适合度 $\\exp(-B F_t)$，进而可能进一步压低 $N_{t+1}$，可能造成灭绝漩涡。相反，足够大的 $N_t$ 会增加 $N_{e,t}$，减缓 $F_t$ 的增长，并可能使种群得以存续。\n\n任务。对于下面测试套件中的每一组参数，从初始条件 $(N_0^{\\mathrm{low}}, F_0)$ 和 $(N_0^{\\mathrm{high}}, F_0)$（其中 $F_0 = 0$）开始，对耦合系统进行两次确定性模拟。将系统演化整 $T$ 代。通过比较两次运行的结果，对该参数集的长期结果进行分类：\n\n- 如果两条轨迹都达到灭绝（即在 $\\le T$ 步内 $N_t \\le N_{\\mathrm{ext}}$），则返回整数 $0$。\n- 如果两条轨迹都存续（即在 $T$ 步内均未达到灭绝），则返回整数 $1$。\n- 如果在 $T$ 步内恰好一条轨迹达到灭绝而另一条存续，则返回整数 $2$（这表明存在双稳态和灭绝漩涡阈值）。\n\n推导的基本依据。您的构建必须基于：(i) Wright–Fisher 种群中近交系数更新的定义，(ii) 通过一个比例常数建立的有效种群大小与普查规模之间的关系，(iii) 建模为 $\\exp(-B F)$ 的对平均适合度的乘性近交衰退，以及 (iv) 带有 Allee 效应因子的 Ricker 型种群动态更新。\n\n数值要求。本问题以无量纲形式提出，因此不需要物理单位。不涉及角度。任何分数或比例在代码中都应表示为小数。您算法中的所有数值决策（包括灭绝检测）都必须严格遵循上述定义，不得有任何偏离。\n\n测试套件。请严格使用以下参数集。每个元组为 $(r, K, A, \\alpha, B, N_0^{\\mathrm{low}}, N_0^{\\mathrm{high}}, T)$，所有数字均为实数，并在此提供：\n\n- 案例 1: $(1.0, 1000.0, 0.0, 0.7, 0.5, 5.0, 500.0, 300)$\n- 案例 2: $(1.0, 1000.0, 100.0, 0.2, 0.9, 10.0, 600.0, 500)$\n- 案例 3: $(1.0, 1000.0, 0.0, 0.5, 1.4, 100.0, 600.0, 300)$\n- 案例 4: $(1.0, 1000.0, 0.0, 0.5, 0.98, 1.0, 400.0, 500)$\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[x_1,x_2,x_3,x_4]$），其中 $x_i$ 是对应上述顺序案例 $i$ 的整数分类。不允许有其他输出。", "solution": "问题陈述已经过评估，被认为是有效的。它具有科学依据、问题良定、客观，并为构建形式化解决方案提供了所有必要信息。该模型基于种群生态学和遗传学的既定原则。我将继续进行解决方案的推导和实现。\n\n该问题要求对一个由两个离散时间确定性方程组成的耦合系统进行模拟，该系统描述了种群大小 $N_t$ 和平均近交系数 $F_t$ 的演化。分析旨在根据种群对初始种群大小的敏感性对其长期行为进行分类，这可以揭示灭绝漩涡的可能性。\n\n该系统由以下递归关系组定义：\n\n$1$. **种群动态**：从第 $t$ 代到第 $t+1$ 代的普查种群大小的变化受一个模型控制，该模型包含内禀增长、密度依赖性调节、近交衰退和 Allee 效应。方程为：\n$$\nN_{t+1} = N_t \\exp\\left(r \\left(1 - \\frac{N_t}{K}\\right)\\right) \\exp(-B F_t) \\frac{N_t}{N_t + A}\n$$\n在此，$r$ 是自然增长的内禀速率，$K$ 是环境承载力，$B$ 是近交负载参数（衡量单位近交所致的适合度下降），$A$ 是 Allee 效应参数，定义了临界种群大小阈值。项 $\\exp(r (1 - N_t/K))$ 是 Ricker 密度调节模型。项 $\\exp(-B F_t)$ 表示因近交导致的种群平均适合度下降。项 $N_t / (N_t + A)$ 模拟了 II 型 Allee 效应，其中在低种群密度下，人均增长-率随密度增加而增加。\n\n$2$. **遗传动态**：近交系数 $F_t$，即某一位点上的两个等位基因因共同祖先而相同的概率，根据有限大小的随机交配种群的标准 Wright-Fisher 模型进行演化：\n$$\nF_{t+1} = F_t + \\frac{1 - F_t}{2 N_{e,t}}\n$$\n该方程表明，每一代中近交的增长速率与有效种群大小 $N_{e,t}$ 成反比。随着 $F_t$ 接近其最大值 $1$，增长速率会减慢。\n\n$3$. **生态-演化耦合**：种群动态过程和遗传过程是耦合的。有效种群大小 $N_{e,t}$ 被假定为普查规模 $N_t$ 的一部分，并由一个下限值修正：\n$$\nN_{e,t} = \\max(\\alpha N_t, N_e^{\\min})\n$$\n其中 $\\alpha \\in (0, 1]$ 是一个缩放因子，$N_e^{\\min} = 1$ 是最小有效大小，以确保即使在 $N_t \\to 0$ 的情况下，遗传更新方程仍保持生物学上的合理性。反过来，近交系数 $F_t$ 会影响 $N_{t+1}$ 的种群动态更新，从而形成一个反馈循环。小的 $N_t$ 导致小的 $N_{e,t}$，加速了 $F_t$ 的上升，这会导致更严重的近交衰退，进一步减小 $N_{t+1}$。这种正反馈是灭绝漩涡的机制。\n\n**模拟算法与分类**\n\n对于每个给定的参数集 $(r, K, A, \\alpha, B, N_0^{\\mathrm{low}}, N_0^{\\mathrm{high}}, T)$，执行以下算法。\n\n首先，定义一个模拟函数。该函数接收一个参数集和初始种群大小 $N_0$ 作为输入，初始近交系数固定为 $F_0 = 0$。它最多迭代 $T$ 代。\n\n单条轨迹的模拟过程如下：\n- 初始化状态变量 $N \\leftarrow N_0$ 和 $F \\leftarrow F_0$。\n- 对于从 $0$ 到 $T-1$ 的每个离散时间步 $t$：\n    - 检查是否灭绝：如果 $N \\leq N_{\\mathrm{ext}}$ （其中 $N_{\\mathrm{ext}} = 10^{-3}$），则认为种群已灭绝。该轨迹的模拟终止，结果记录为“灭绝”。\n    - 如果未灭绝，计算当前代的有效种群大小：$N_e \\leftarrow \\max(\\alpha N, 1.0)$。\n    - 使用当前状态 $(N, F)$ 和模型方程计算下一代的状态 $(N_{\\mathrm{next}}, F_{\\mathrm{next}})$：\n        $$\n        N_{\\mathrm{next}} \\leftarrow N \\exp\\left(r \\left(1 - \\frac{N}{K}\\right)\\right) \\exp(-B F) \\frac{N}{N + A}\n        $$\n        $$\n        F_{\\mathrm{next}} \\leftarrow F + \\frac{1 - F}{2 N_e}\n        $$\n    - 更新状态：$N \\leftarrow N_{\\mathrm{next}}$ 和 $F \\leftarrow F_{\\mathrm{next}}$。\n- 循环完成后（即在 $T$ 次更新后），如果种群尚未被宣告灭绝，则进行最终检查：如果 $N \\leq N_{\\mathrm{ext}}$，则认为种群在第 $T$ 代灭绝。否则，它已存续。\n\n对于每个参数集，此模拟函数被调用两次：一次使用低初始大小 $N_0^{\\mathrm{low}}$，一次使用高初始大小 $N_0^{\\mathrm{high}}$。设结果分别为 `extinct_low` 和 `extinct_high`（每个都是布尔值）。\n\n该参数集的最终分类由这两个结果根据指定规则确定：\n- 如果 `extinct_low` 为真且 `extinct_high` 为真，则分类为 $0$。\n- 如果 `extinct_low` 为假且 `extinct_high` 为假，则分类为 $1$。\n- 如果一个为真另一个为假，则分类为 $2$。这表示双稳态，即种群的长期命运取决于其初始大小，这是灭绝漩涡的一个特征信号。\n\n该实现将把此逻辑应用于所提供的四个测试案例中的每一个，并将结果格式化为整数列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(r, K, A, alpha, B, N0, T, Next_val, Ne_min, F0):\n    \"\"\"\n    Simulates the coupled demographic-genetic model for T generations.\n\n    This function evolves the population size N and inbreeding coefficient F\n    according to the provided discrete-time equations.\n\n    Args:\n        r (float): Intrinsic growth parameter.\n        K (float): Carrying capacity.\n        A (float): Allee-effect scale.\n        alpha (float): Scaling factor for effective population size.\n        B (float): Inbreeding load parameter.\n        N0 (float): Initial census population size.\n        T (int): Number of generations to simulate.\n        Next_val (float): Extinction threshold for population size.\n        Ne_min (float): Minimum effective population size.\n        F0 (float): Initial inbreeding coefficient.\n\n    Returns:\n        bool: True if the population goes extinct within T generations,\n              False otherwise.\n    \"\"\"\n    N = float(N0)\n    F = float(F0)\n\n    for _ in range(T):\n        # 1. Check for extinction at the beginning of the generation.\n        if N <= Next_val:\n            return True\n\n        # 2. Calculate effective population size for the current generation.\n        Ne = max(alpha * N, Ne_min)\n\n        # 3. Calculate N and F for the next generation.\n        # The update for N_{t+1} depends on the state at time t (N_t, F_t).\n        N_next = N * np.exp(r * (1.0 - N / K)) * np.exp(-B * F) * (N / (N + A))\n        \n        # The update for F_{t+1} depends on F_t and N_{e,t} (which depends on N_t).\n        F_next = F + (1.0 - F) / (2.0 * Ne)\n\n        # 4. Update state variables.\n        N = N_next\n        F = F_next\n\n    # 5. Final check for extinction after T full generations.\n    if N <= Next_val:\n        return True\n\n    return False\n\ndef solve():\n    \"\"\"\n    Main function to run simulations for all test cases and print results.\n    \"\"\"\n    # Test suite: (r, K, A, alpha, B, N0_low, N0_high, T)\n    test_cases = [\n        (1.0, 1000.0, 0.0, 0.7, 0.5, 5.0, 500.0, 300),\n        (1.0, 1000.0, 100.0, 0.2, 0.9, 10.0, 600.0, 500),\n        (1.0, 1000.0, 0.0, 0.5, 1.4, 100.0, 600.0, 300),\n        (1.0, 1000.0, 0.0, 0.5, 0.98, 1.0, 400.0, 500),\n    ]\n\n    # Model constants as defined in the problem\n    Next_val = 1e-3\n    Ne_min = 1.0\n    F0 = 0.0\n\n    results = []\n    for params in test_cases:\n        r, K, A, alpha, B, N0_low, N0_high, T = params\n        \n        # Run simulation for the low initial population size\n        extinct_low = run_simulation(r, K, A, alpha, B, N0_low, int(T), Next_val, Ne_min, F0)\n        \n        # Run simulation for the high initial population size\n        extinct_high = run_simulation(r, K, A, alpha, B, N0_high, int(T), Next_val, Ne_min, F0)\n        \n        # Classify the outcome based on the two trajectories\n        if extinct_low and extinct_high:\n            # Both trajectories go to extinction\n            classification = 0\n        elif not extinct_low and not extinct_high:\n            # Both trajectories persist\n            classification = 1\n        else:\n            # One persists, one goes extinct (bistability)\n            classification = 2\n            \n        results.append(classification)\n\n    # Format and print the final output exactly as specified.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver.\nsolve()\n```", "id": "2494475"}]}