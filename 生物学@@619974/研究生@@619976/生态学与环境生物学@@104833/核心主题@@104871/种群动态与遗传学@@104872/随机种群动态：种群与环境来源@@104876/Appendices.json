{"hands_on_practices": [{"introduction": "我们如何将经典的人口增长模型（如逻辑斯谛增长）转变为能捕捉环境随机性的随机模型？这个练习将指导你完成这一关键步骤。你将从一个确定性模型出发，引入代表环境波动的随机项，并应用伊腾引理（Itō's lemma），这是随机微积分中的一个核心工具。通过这个过程，你不仅能推导出对数尺度下的种群动态方程，还将揭示一个关键概念——伊腾校正项（Itō correction term），它解释了为什么随机性本身会系统性地影响种群的平均增长轨迹。[@problem_id:2535419]", "problem": "在恒定环境中，单物种族群的经典模型是确定性逻辑斯谛增长，其内禀增长率为 $r$，承载能力为 $K$。假设环境随机性以乘法方式作用于人均增长率，代表非生物条件的随机波动，并被建模为由维纳过程 $W_t$ 驱动、强度为 $\\sigma$ 的高斯环境噪声。在随机微积分的 Itô 解释下进行计算。\n\n从确定性逻辑斯谛形式和环境变异性乘以人均增长率的建模假设出发，写出在 Itô 解释下，种群数量 $N(t)$ 的随机微分方程（stochastic differential equation (SDE)）。然后，通过对变换 $X(t)=\\ln N(t)$ 应用 Itô 引理，推导出 $X(t)$ 的 SDE，并明确指出由 $\\ln$ 变换的曲率引起的漂移项中的 Itô 修正项。\n\n将你的最终答案表示为 $X(t)$ 的 SDE 的漂移函数的解析表达式，该表达式用 $X$、$r$、$K$ 和 $\\sigma$ 书写。不要写成方程；仅给出作为单个表达式的漂移函数。不需要进行数值评估，也不需要四舍五入。", "solution": "所述问题在科学上是合理的，在数学上是适定的、客观的且自洽的。它提出了随机种群动态学（数学生态学的一个分支学科）领域中的一个标准的、非平凡的练习。所有必要的参数和建模假设都已清楚提供。因此，该问题是有效的，我们开始进行推导。\n\n出发点是种群数量为 $N(t)$ 的确定性逻辑斯谛增长方程：\n$$\n\\frac{dN}{dt} = rN\\left(1 - \\frac{N}{K}\\right)\n$$\n此处，$r$ 是内禀增长率，$K$ 是承载能力。人均增长率为 $\\frac{1}{N}\\frac{dN}{dt}$，由下式给出：\n$$\n\\frac{1}{N}\\frac{dN}{dt} = r\\left(1 - \\frac{N}{K}\\right)\n$$\n问题指明，被建模为来自维纳过程 $W_t$、强度为 $\\sigma$ 的高斯噪声的环境随机性，以乘法方式作用于此人均增长率。在 Itô 解释下，随机人均增长率可以写为 $r\\left(1 - \\frac{N_t}{K}\\right)dt + \\sigma dW_t$。种群的总变化量 $dN_t$ 是种群数量 $N_t$ 乘以这个随机人均增长率。这就得出了 $N(t)$ 的随机微分方程（SDE）：\n$$\ndN_t = N_t \\left[ r\\left(1 - \\frac{N_t}{K}\\right)dt + \\sigma dW_t \\right]\n$$\n这可以写成标准形式 $dN_t = a(N_t)dt + b(N_t)dW_t$，其中漂移函数是 $a(N_t) = rN_t\\left(1 - \\frac{N_t}{K}\\right)$，扩散函数是 $b(N_t) = \\sigma N_t$。\n\n下一步是求变换后变量 $X(t) = \\ln N(t)$ 的 SDE。我们对随机过程 $N_t$ 的函数 $f(N_t)$ 应用 Itô 引理。令 $f(N) = \\ln N$。$f$ 对 $N$ 的必要偏导数为：\n$$\n\\frac{\\partial f}{\\partial N} = \\frac{1}{N}\n$$\n$$\n\\frac{\\partial^2 f}{\\partial N^2} = -\\frac{1}{N^2}\n$$\nItô 引理指出，$X_t = f(N_t)$ 的微分是：\n$$\ndX_t = \\left[ \\frac{\\partial f}{\\partial N}a(N_t) + \\frac{1}{2}\\frac{\\partial^2 f}{\\partial N^2}\\left(b(N_t)\\right)^2 \\right]dt + \\frac{\\partial f}{\\partial N}b(N_t)dW_t\n$$\n我们将 $a(N_t)$、$b(N_t)$ 以及 $f(N)$ 的导数的表达式代入此公式。\n\n$dX_t$ 过程的漂移项是 $dt$ 的系数：\n$$\n\\text{Drift}(X_t) = \\frac{\\partial f}{\\partial N}a(N_t) + \\frac{1}{2}\\frac{\\partial^2 f}{\\partial N^2}\\left(b(N_t)\\right)^2\n$$\n代入具体的函数：\n$$\n\\text{Drift}(X_t) = \\left(\\frac{1}{N_t}\\right) \\left[rN_t\\left(1 - \\frac{N_t}{K}\\right)\\right] + \\frac{1}{2}\\left(-\\frac{1}{N_t^2}\\right)\\left(\\sigma N_t\\right)^2\n$$\n简化此表达式：\n$$\n\\text{Drift}(X_t) = r\\left(1 - \\frac{N_t}{K}\\right) - \\frac{1}{2}\\frac{1}{N_t^2}\\sigma^2 N_t^2\n$$\n$$\n\\text{Drift}(X_t) = r\\left(1 - \\frac{N_t}{K}\\right) - \\frac{1}{2}\\sigma^2\n$$\n项 $-\\frac{1}{2}\\sigma^2$ 是 Itô 修正项。它源于对数变换的非线性（即 $\\frac{\\partial^2 f}{\\partial N^2} \\neq 0$）。这个修正是 Itô 微积分的一个决定性特征，它解释了波动性对变换后过程漂移的影响。\n\n$dX_t$ 过程的扩散项是 $dW_t$ 的系数：\n$$\n\\text{Diffusion}(X_t) = \\frac{\\partial f}{\\partial N}b(N_t) = \\left(\\frac{1}{N_t}\\right)\\left(\\sigma N_t\\right) = \\sigma\n$$\n因此，$X(t)$ 的 SDE 为：\n$$\ndX_t = \\left[ r\\left(1 - \\frac{N_t}{K}\\right) - \\frac{1}{2}\\sigma^2 \\right]dt + \\sigma dW_t\n$$\n问题要求漂移函数的最终表达式用 $X$ 来表示。由于 $X(t) = \\ln N(t)$，我们有 $N(t) = \\exp(X(t))$。我们将其代入漂移表达式中：\n$$\n\\text{Drift}(X) = r\\left(1 - \\frac{\\exp(X)}{K}\\right) - \\frac{1}{2}\\sigma^2\n$$\n这就是对数变换后种群数量漂移所需的解析表达式。", "answer": "$$\n\\boxed{r\\left(1 - \\frac{\\exp(X)}{K}\\right) - \\frac{1}{2}\\sigma^2}\n$$", "id": "2535419"}, {"introduction": "建立了随机模型后，一个至关重要的问题便是：种群的长期命运如何，特别是它是否面临灭绝的风险？本练习将带你深入探讨随机微分方程在边界（$N=0$）处的行为，这是评估种群生存力的核心。你将运用标度函数（scale function）和速度密度（speed measure）等严格的数学工具，来判断灭绝边界是可达的还是不可达的，并分析在不同条件下（如是否存在迁入）边界是吸收性的还是反射性的。这项实践将使你对种群灭绝的动态有更深刻的数学理解。[@problem_id:2535401]", "problem": "一个在波动环境中进行密度依赖性增长的种群被建模为非负实数轴上的一个一维伊藤扩散，其状态变量 $N_{t} \\in [0,\\infty)$ 满足随机微分方程\n$$\n\\mathrm{d}N_{t} \\;=\\; \\big(\\,\\iota \\;+\\; r\\,N_{t}\\,(1 - N_{t}/K)\\,\\big)\\,\\mathrm{d}t \\;+\\; \\sigma\\,N_{t}^{\\gamma}\\,\\mathrm{d}W_{t},\n$$\n其中 $r>0$ 是内禀增长率，$K>0$ 是环境承载力，$\\sigma>0$ 是噪声强度，$\\gamma>0$ 控制乘性噪声标度，$\\iota\\ge 0$ 是一个恒定的迁入项，$W_{t}$ 是一个标准维纳过程。假设 $N_{0}>0$。\n\n从一维伊藤扩散的基础边界分类理论出发，分析在 $N=0$ 处的边界。你的分析必须基于标度与速度构造以及相关的边界可达性与类型的可积性判据。具体来说：\n\n- 确定指数 $\\gamma$ 在何种范围内，边界 $N=0$ 是从内部可达的，以及在何种范围内是不可达的，并找出分类发生变化的阈值。\n- 对于 $N=0$ 可达的情况，说明 $N=0$ 是吸收边界还是瞬时反射边界，并给出各自出现时以 $\\iota$ 表示的条件。\n- 特别考虑种群动态噪声标度 $\\gamma=\\frac{1}{2}$ 的情况，计算边界 $N=0$ 从可达变为不可达时的临界迁入强度 $\\iota_{c}(\\sigma)$，该强度是 $\\sigma$ 的函数。将你的最终答案表示为关于 $\\iota_{c}(\\sigma)$ 的单一闭式解析表达式。不需要进行数值近似。", "solution": "我们考虑一个状态空间为 $[0,\\infty)$ 的一维伊藤扩散，其漂移为 $\\mu(n) = \\iota + r n (1 - n/K)$，扩散系数为 $b(n) = \\sigma n^{\\gamma}$。$n=0$ 处的边界分类由 Feller 检验通过标度函数和速度测度确定。我们回顾一维伊藤扩散 $\\mathrm{d}X_{t} = \\mu(X_{t})\\,\\mathrm{d}t + b(X_{t})\\,\\mathrm{d}W_{t}$ 的基本定义：\n\n- 标度密度为\n$$\ns'(x) \\;=\\; \\exp\\!\\left(-\\int^{x} \\frac{2\\,\\mu(z)}{b(z)^{2}}\\,\\mathrm{d}z\\right).\n$$\n- 标度函数（在一个仿射变换下）为 $S(x) = \\int^{x} s'(y)\\,\\mathrm{d}y$。\n- 速度密度为 $m(x) = \\dfrac{2}{b(x)^{2}\\,s'(x)}$。\n\n位于 $0$ 的下边界从内部可达的充要条件是 $S(0+)$ 是有限的，等价于对于某个 $\\delta>0$\n$$\n\\int_{0+}^{\\delta} s'(y)\\,\\mathrm{d}y \\;<\\; \\infty \\quad \\text{。}\n$$\n如果这个积分发散，那么 $0$ 就是不可达的（根据其他积分的结果，可能是入口边界或自然边界）。对于我们在 $n=0$ 附近的分类，主导行为由 $\\mu(n)$ 和 $b(n)$ 在 $n$ 较小时的渐近性确定，即 $\\mu(n) \\sim \\iota + r n$ 和 $b(n) \\sim \\sigma n^{\\gamma}$。\n\n因此，我们分析当 $x \\downarrow 0$ 时 $s'(x)$ 的渐近性：\n$$\ns'(x) \\;=\\; \\exp\\!\\left(-\\int^{x} \\frac{2(\\iota + r z)}{\\sigma^{2}\\,z^{2\\gamma}}\\,\\mathrm{d}z\\right)\n\\;=\\; \\exp\\!\\left(-\\frac{2\\iota}{\\sigma^{2}}\\int^{x} z^{-2\\gamma}\\,\\mathrm{d}z \\;-\\; \\frac{2r}{\\sigma^{2}}\\int^{x} z^{1-2\\gamma}\\,\\mathrm{d}z\\right).\n$$\n我们分开计算这两个积分。\n\n1. 迁入驱动项 $\\int^{x} z^{-2\\gamma}\\,\\mathrm{d}z$ 的行为如下：\n- 若 $\\gamma \\neq \\frac{1}{2}$，则 $\\int^{x} z^{-2\\gamma}\\,\\mathrm{d}z = \\dfrac{x^{1-2\\gamma}}{1-2\\gamma} + C$，当 $x \\downarrow 0$ 时，若 $\\gamma < \\frac{1}{2}$，此积分为有限值；若 $\\gamma > \\frac{1}{2}$，其绝对值发散。\n- 若 $\\gamma = \\frac{1}{2}$，则 $\\int^{x} z^{-1}\\,\\mathrm{d}z = \\ln x + C$，当 $x \\downarrow 0$ 时对数发散。\n\n2. 内禀增长项 $\\int^{x} z^{1-2\\gamma}\\,\\mathrm{d}z$ 的行为如下：\n- 若 $\\gamma \\neq 1$，则 $\\int^{x} z^{1-2\\gamma}\\,\\mathrm{d}z = \\dfrac{x^{2-2\\gamma}}{2-2\\gamma} + C$，当 $x \\downarrow 0$ 时，若 $\\gamma < 1$，此积分为有限值；若 $\\gamma \\ge 1$，其绝对值发散（在 $\\gamma=1$ 时是对数发散）。\n- 若 $\\gamma = 1$，则 $\\int^{x} z^{-1}\\,\\mathrm{d}z = \\ln x + C$。\n\n在 $x=0$ 附近，$s'(x)$ 指数项的主要贡献来自于这两个积分中更奇异的那一个。我们按 $\\iota$ 的值分情况讨论。\n\n情况 A：$\\iota = 0$ (无迁入)。则\n$$\ns'(x) \\;\\sim\\; \\exp\\!\\left(-\\frac{2r}{\\sigma^{2}}\\int^{x} z^{1-2\\gamma}\\,\\mathrm{d}z\\right).\n$$\n- 若 $\\gamma < 1$，则 $\\int^{x} z^{1-2\\gamma}\\,\\mathrm{d}z$ 是有限的，且当 $x \\downarrow 0$ 时趋于 $0$，因此 $s'(x)\\to \\exp(0) = 1$。所以 $\\int_{0}^{\\delta} s'(y)\\,\\mathrm{d}y$ 是有限的，且 $0$ 是可达的。\n- 若 $\\gamma \\ge 1$，则 $\\int^{x} z^{1-2\\gamma}\\,\\mathrm{d}z$ 当 $x \\downarrow 0$ 时发散至 $-\\infty$，因为在 $\\gamma=1$ 时 $\\ln x \\to -\\infty$ 或在 $\\gamma>1$ 时 $x^{2-2\\gamma}/(2-2\\gamma)\\to -\\infty$。这使得指数 $-\\frac{2r}{\\sigma^{2}}\\int^{x} z^{1-2\\gamma}\\,\\mathrm{d}z$ 趋向 $+\\infty$，因此 $s'(x)\\to +\\infty$ 且 $\\int_{0}^{\\delta} s'(y)\\,\\mathrm{d}y$ 发散。因此 $0$ 是不可达的。结论：当 $\\iota=0$ 时，可达性阈值为 $\\gamma^{\\ast} = 1$，即当 $\\gamma<1$ 时可达，当 $\\gamma \\ge 1$ 时不可达。\n\n情况 B：$\\iota > 0$ (有正迁入)。那么当 $x\\downarrow 0$ 时，更奇异的项来自于 $\\int^{x} z^{-2\\gamma}\\,\\mathrm{d}z$（当 $\\gamma \\ge \\frac{1}{2}$ 时）：\n$$\ns'(x) \\;\\sim\\; \\exp\\!\\left(-\\frac{2\\iota}{\\sigma^{2}}\\int^{x} z^{-2\\gamma}\\,\\mathrm{d}z\\right) \\times \\text{(次主导因子)}.\n$$\n- 若 $\\gamma < \\frac{1}{2}$，则 $\\int^{x} z^{-2\\gamma}\\,\\mathrm{d}z$ 是有限的，且当 $x \\downarrow 0$ 时趋于 $0$，所以 $s'(x)\\to 1$ 并且 $\\int_{0}^{\\delta} s'(y)\\,\\mathrm{d}y$ 是有限的。因此 $0$ 是可达的。\n- 若 $\\gamma > \\frac{1}{2}$，则 $\\int^{x} z^{-2\\gamma}\\,\\mathrm{d}z \\sim \\dfrac{x^{1-2\\gamma}}{1-2\\gamma}$ 当 $x \\downarrow 0$ 时发散，其符号使得 $-\\dfrac{2\\iota}{\\sigma^{2}} \\int^{x} z^{-2\\gamma}\\,\\mathrm{d}z \\to +\\infty$，因此 $s'(x)\\to +\\infty$ 且 $\\int_{0}^{\\delta} s'(y)\\,\\mathrm{d}y$ 发散。因此 $0$ 是不可达的。\n- 若 $\\gamma = \\frac{1}{2}$，则 $s'(x) \\sim \\exp\\!\\big(-\\frac{2\\iota}{\\sigma^{2}} \\ln x\\big) = x^{-2\\iota/\\sigma^{2}}$（除去来自 $r$ 项的乘性慢变因子，这些因子奇异性较弱）。因此在 $0$ 附近 $s'$ 的可积性由下式决定：\n$$\n\\int_{0}^{\\delta} y^{-2\\iota/\\sigma^{2}}\\,\\mathrm{d}y \\quad \\text{此积分收敛当且仅当} \\quad \\frac{2\\iota}{\\sigma^{2}} < 1.\n$$\n因此，在 $\\gamma=\\frac{1}{2}$ 处存在一个尖锐阈值 $\\iota_{c}(\\sigma) = \\sigma^{2}/2$：如果 $\\iota < \\sigma^{2}/2$，则 $S(0+)<\\infty$，且 $0$ 是可达的；如果 $\\iota \\ge \\sigma^{2}/2$，则 $S(0+)=\\infty$，且 $0$ 是不可达的。\n\n可达情况下的吸收与反射对比。如果边界是可达的，那么到达 $0$ 时的行为由在 $0$ 处的系数决定：\n- 扩散系数满足 $b(0) = \\lim_{n\\downarrow 0} \\sigma n^{\\gamma} = 0$（对于任何 $\\gamma>0$）。\n- 在 $0$ 处的漂移是 $\\mu(0) = \\iota$。\n\n因此：\n- 如果 $\\iota = 0$，则在 $0$ 处漂移和扩散都为零，随机微分方程在 $N_{t}=0$ 时简化为 $\\mathrm{d}N_{t} = 0$。因此 $0$ 是吸收的。\n- 如果 $\\iota > 0$，则在 $N_{t}=0$ 处扩散为零但漂移为严格正值，所以到达 $0$ 的轨迹被瞬时推入内部。用边界分类的术语来说，$0$ 是瞬时反射的。\n\n可达性阈值总结：\n- 当 $\\iota = 0$ 时：对于 $\\gamma < 1$ 是可达的，对于 $\\gamma \\ge 1$ 是不可达的；如果可达，则是吸收的。\n- 当 $\\iota > 0$ 时：对于 $\\gamma < \\frac{1}{2}$ 是可达的；对于 $\\gamma > \\frac{1}{2}$ 是不可达的；在 $\\gamma = \\frac{1}{2}$ 时，可达当且仅当 $\\iota < \\sigma^{2}/2$。如果可达，则是瞬时反射的。\n\n题目要求计算的在 $\\gamma=\\frac{1}{2}$ 时，边界在可达与不可达之间转换的临界迁入强度为：\n$$\n\\iota_{c}(\\sigma) \\;=\\; \\frac{\\sigma^{2}}{2}.\n$$\n无需四舍五入或数值近似。", "answer": "$$\\boxed{\\frac{\\sigma^{2}}{2}}$$", "id": "2535401"}, {"introduction": "理论模型若要应用于现实世界，就必须与观测数据相结合。这个最终的练习将搭建起理论与实践之间的桥梁，引导你解决从时间序列数据中估计模型参数的问题。从一个随机指数增长模型出发，你将学习如何推导出关键参数——内禀增长率 $r$ 和环境随机性强度 $\\sigma$ ——的最大似然估计量（Maximum Likelihood Estimators, MLEs）。掌握这项技能对于任何一位希望利用真实种群数据来检验和应用随机动态模型的生态学家来说都至关重要。[@problem_id:2535427]", "problem": "一个单一物种的封闭种群在连续时间内经历随机指数增长。设 $N_t$ 表示在时间 $t$ 的真实丰度，对于所有 $t$ 都有 $N_t \\in (0,\\infty)$。假设丰度的对数 $X_t \\equiv \\ln N_t$ 遵循随机微分方程 (SDE; stochastic differential equation)：\n$$\n\\mathrm{d}X_t \\;=\\; r\\,\\mathrm{d}t \\;+\\; \\sigma\\,\\mathrm{d}W_t,\n$$\n其中 $r \\in \\mathbb{R}$ 是人均内蕴增长率，$\\sigma \\in (0,\\infty)$ 是环境随机性的强度，而 $W_t$ 是标准布朗运动。您在严格递增的时间点 $0 = t_0 < t_1 < \\cdots < t_m$ 对丰度进行了 $m+1$ 次精确、无噪声的观测，得到 $\\{N_{t_i}\\}_{i=0}^m$，其中 $N_{t_0}$ 已知。记 $\\Delta_i \\equiv t_i - t_{i-1}$，其中 $i \\in \\{1,\\dots,m\\}$。\n\n仅使用上述SDE、布朗运动增量的基本性质以及基础概率论，完成以下任务：\n\n- 对每个 $i \\in \\{1,\\dots,m\\}$，推导条件转移密度 $p(N_{t_i}\\mid N_{t_{i-1}}; r,\\sigma)$，并从第一性原理证明其形式的合理性。\n- 利用SDE所蕴含的马尔可夫性质，在不重叠的布朗运动增量相互独立的假设下，构建完整似然函数 $L(r,\\sigma \\mid \\{N_{t_i}\\}_{i=0}^m)$。\n- 求出 $r$ 和 $\\sigma$ 的闭式最大似然估计 (MLEs; maximum likelihood estimators)，并用观测序列 $\\{N_{t_i}\\}_{i=0}^m$ 和抽样区间 $\\{\\Delta_i\\}_{i=1}^m$ 来表示。\n\n您的最终估计量必须仅用观测到的对数增量 $Y_i \\equiv \\ln N_{t_i} - \\ln N_{t_{i-1}}$ 和 $\\Delta_i$ 来表示。您的最终答案必须是一个单一的解析表达式，其中包含按照答案说明中指定的行矩阵形式排列的两个估计量。不需要进行数值计算或四舍五入。假设 $m \\ge 1$ 且所有 $N_{t_i} \\in (0,\\infty)$ 都是精确已知的。", "solution": "问题陈述具有科学依据、提法恰当、客观且自洽。它描述了随机过程统计推断中的一个标准且基本的任务，具体而言，是从离散时间观测中对几何布朗运动进行参数估计。所有必要的组成部分都已提供，不存在矛盾或歧义。该问题是有效的。我们着手进行解答。\n\n该问题要求推导随机指数增长模型参数的最大似然估计。物种丰度 $N_t$ 遵循一个过程，其对数 $X_t = \\ln N_t$ 由算术布朗运动的随机微分方程 (SDE) 决定：\n$$\n\\mathrm{d}X_t = r\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t\n$$\n该模型意味着 $N_t = \\exp(X_t)$ 遵循几何布朗运动。我们已知在时间点 $0=t_0 < t_1 < \\dots < t_m$ 上的 $m+1$ 个离散丰度观测值 $\\{N_{t_i}\\}_{i=0}^m$。\n\n首先，我们推导条件转移密度 $p(N_{t_i} \\mid N_{t_{i-1}}; r,\\sigma)$。为此，我们将 $X_t$ 的 SDE 在单个观测区间 $[t_{i-1}, t_i]$ 上进行积分。\n$$\n\\int_{t_{i-1}}^{t_i} \\mathrm{d}X_t = \\int_{t_{i-1}}^{t_i} r\\,\\mathrm{d}t + \\int_{t_{i-1}}^{t_i} \\sigma\\,\\mathrm{d}W_t\n$$\n$$\nX_{t_i} - X_{t_{i-1}} = r(t_i - t_{i-1}) + \\sigma(W_{t_i} - W_{t_{i-1}})\n$$\n设 $\\Delta_i = t_i - t_{i-1}$。标准布朗运动 $W_t$ 的一个基本性质是，其在不重叠区间上的增量是独立且服从正态分布的。具体来说，增量 $W_{t_i} - W_{t_{i-1}}$ 是一个随机变量，服从分布 $\\mathcal{N}(0, t_i - t_{i-1})$，即 $W_{t_i} - W_{t_{i-1}} \\sim \\mathcal{N}(0, \\Delta_i)$。\n因此，项 $\\sigma(W_{t_i} - W_{t_{i-1}})$ 也服从正态分布：$\\sigma(W_{t_i} - W_{t_{i-1}}) \\sim \\mathcal{N}(0, \\sigma^2 \\Delta_i)$。\n对数增量，我们记为 $Y_i \\equiv X_{t_i} - X_{t_{i-1}} = \\ln N_{t_i} - \\ln N_{t_{i-1}}$，是确定性漂移项 $r\\Delta_i$ 和随机项的和。因此，在给定 $X_{t_{i-1}}$ 的条件下，其条件分布是正态的：\n$$\nY_i \\mid X_{t_{i-1}} \\sim \\mathcal{N}(r\\Delta_i, \\sigma^2\\Delta_i)\n$$\n等价地，在给定 $X_{t_{i-1}}$ 的条件下，$X_{t_i}$ 的条件分布是：\n$$\nX_{t_i} \\mid X_{t_{i-1}} \\sim \\mathcal{N}(X_{t_{i-1}} + r\\Delta_i, \\sigma^2\\Delta_i)\n$$\n$X_{t_i}$ 的条件概率密度函数 (PDF) 为：\n$$\np(X_{t_i} \\mid X_{t_{i-1}}; r, \\sigma) = \\frac{1}{\\sqrt{2\\pi\\sigma^2\\Delta_i}} \\exp\\left(-\\frac{(X_{t_i} - (X_{t_{i-1}} + r\\Delta_i))^2}{2\\sigma^2\\Delta_i}\\right)\n$$\n为了求出所需的 $N_{t_i}$ 的转移密度，我们应用概率密度的变量替换公式。给定变换 $X_t = \\ln N_t$，该变换的雅可比行列式为 $|\\frac{\\mathrm{d}X_{t_i}}{\\mathrm{d}N_{t_i}}| = |\\frac{1}{N_{t_i}}| = \\frac{1}{N_{t_i}}$，因为 $N_{t_i} > 0$。\n$$\np(N_{t_i} \\mid N_{t_{i-1}}; r, \\sigma) = p(X_{t_i}=\\ln N_{t_i} \\mid X_{t_{i-1}}=\\ln N_{t_{i-1}}; r, \\sigma) \\cdot \\frac{1}{N_{t_i}}\n$$\n代入 $X_{t_i}$ 和 $X_{t_{i-1}}$ 的表达式，得到转移密度，这是一个对数正态 PDF：\n$$\np(N_{t_i} \\mid N_{t_{i-1}}; r, \\sigma) = \\frac{1}{N_{t_i}\\sqrt{2\\pi\\sigma^2\\Delta_i}} \\exp\\left(-\\frac{(\\ln N_{t_i} - \\ln N_{t_{i-1}} - r\\Delta_i)^2}{2\\sigma^2\\Delta_i}\\right)\n$$\n\n第二，我们构建似然函数。SDE 定义了一个马尔可夫过程，且布朗运动在不重叠时间区间上的增量的独立性意味着对数增量 $\\{Y_i\\}_{i=1}^m$ 是相互独立的随机变量。因此，在给定初始状态 $N_{t_0}$ 的条件下，观测序列 $\\{N_{t_i}\\}_{i=1}^m$ 的联合概率是各个条件转移概率的乘积：\n$$\nL(r, \\sigma) = p(N_{t_1}, \\dots, N_{t_m} \\mid N_{t_0}; r, \\sigma) = \\prod_{i=1}^m p(N_{t_i} \\mid N_{t_{i-1}}; r, \\sigma)\n$$\n代入推导出的密度并使用简写 $Y_i = \\ln N_{t_i} - \\ln N_{t_{i-1}}$：\n$$\nL(r, \\sigma) = \\prod_{i=1}^m \\frac{1}{N_{t_i}\\sqrt{2\\pi\\sigma^2\\Delta_i}} \\exp\\left(-\\frac{(Y_i - r\\Delta_i)^2}{2\\sigma^2\\Delta_i}\\right)\n$$\n使用对数似然函数 $\\ell(r,\\sigma) = \\ln L(r,\\sigma)$ 会更方便：\n$$\n\\ell(r, \\sigma) = \\sum_{i=1}^m \\left[ -\\ln(N_{t_i}) - \\frac{1}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln(\\sigma^2\\Delta_i) - \\frac{(Y_i - r\\Delta_i)^2}{2\\sigma^2\\Delta_i} \\right]\n$$\n为了对 $r$ 和 $\\sigma$ 进行最大化，我们可以忽略不依赖于这些参数的项。对数似然函数的相关部分，我们记为 $\\ell^*$，是：\n$$\n\\ell^*(r, \\sigma) = \\sum_{i=1}^m \\left[ - \\ln(\\sigma) - \\frac{(Y_i - r\\Delta_i)^2}{2\\sigma^2\\Delta_i} \\right] = -m\\ln(\\sigma) - \\frac{1}{2\\sigma^2}\\sum_{i=1}^m \\frac{(Y_i - r\\Delta_i)^2}{\\Delta_i}\n$$\n\n第三，我们通过计算 $\\ell^*$ 对 $r$ 和 $\\sigma$ 的偏导数并将其设为零，来求得最大似然估计量 (MLEs) $\\hat{r}$ 和 $\\hat{\\sigma}$。\n为了求 $\\hat{r}$，我们对 $r$ 求导：\n$$\n\\frac{\\partial \\ell^*}{\\partial r} = -\\frac{1}{2\\sigma^2} \\sum_{i=1}^m \\frac{\\partial}{\\partial r} \\frac{(Y_i - r\\Delta_i)^2}{\\Delta_i} = -\\frac{1}{2\\sigma^2} \\sum_{i=1}^m \\frac{2(Y_i - r\\Delta_i)(-\\Delta_i)}{\\Delta_i} = \\frac{1}{\\sigma^2} \\sum_{i=1}^m (Y_i - r\\Delta_i)\n$$\n将该导数设为零，得到估计量 $\\hat{r}$ 的方程：\n$$\n\\frac{1}{\\sigma^2} \\sum_{i=1}^m (Y_i - \\hat{r}\\Delta_i) = 0 \\quad\\implies\\quad \\sum_{i=1}^m Y_i = \\hat{r}\\sum_{i=1}^m \\Delta_i\n$$\n求解 $\\hat{r}$ 可得：\n$$\n\\hat{r} = \\frac{\\sum_{i=1}^m Y_i}{\\sum_{i=1}^m \\Delta_i}\n$$\n为了求 $\\hat{\\sigma}$，我们对 $\\sigma$ 求 $\\ell^*$ 的导数：\n$$\n\\frac{\\partial \\ell^*}{\\partial \\sigma} = -\\frac{m}{\\sigma} - \\sum_{i=1}^m \\frac{(Y_i - r\\Delta_i)^2}{\\Delta_i} \\left(-\\frac{1}{\\sigma^3}\\right) = -\\frac{m}{\\sigma} + \\frac{1}{\\sigma^3}\\sum_{i=1}^m \\frac{(Y_i - r\\Delta_i)^2}{\\Delta_i}\n$$\n将该导数设为零，并用 $\\hat{r}$ 替代 $r$，得到 $\\hat{\\sigma}$ 的方程：\n$$\n-\\frac{m}{\\hat{\\sigma}} + \\frac{1}{\\hat{\\sigma}^3}\\sum_{i=1}^m \\frac{(Y_i - \\hat{r}\\Delta_i)^2}{\\Delta_i} = 0\n$$\n两边乘以 $\\hat{\\sigma}^3$ (因为 $\\sigma \\in (0,\\infty)$，所以 $\\hat{\\sigma} \\ne 0$)：\n$$\n-m\\hat{\\sigma}^2 + \\sum_{i=1}^m \\frac{(Y_i - \\hat{r}\\Delta_i)^2}{\\Delta_i} = 0\n$$\n求解 $\\hat{\\sigma}^2$ 得到方差的 MLE：\n$$\n\\hat{\\sigma}^2 = \\frac{1}{m} \\sum_{i=1}^m \\frac{(Y_i - \\hat{r}\\Delta_i)^2}{\\Delta_i}\n$$\n根据 MLE 的不变性，$\\sigma$ 的估计量是 $\\sigma^2$ 估计量的平方根：\n$$\n\\hat{\\sigma} = \\left(\\frac{1}{m} \\sum_{i=1}^m \\frac{(Y_i - \\hat{r}\\Delta_i)^2}{\\Delta_i}\\right)^{\\frac{1}{2}}\n$$\n将 $\\hat{r}$ 的完整表达式代入 $\\hat{\\sigma}$ 的公式中，得到完全由数据 $\\{Y_i, \\Delta_i\\}$ 表示的最终显式估计量，符合题目要求。\n$$\n\\hat{r} = \\frac{\\sum_{i=1}^m Y_i}{\\sum_{i=1}^m \\Delta_i}\n$$\n$$\n\\hat{\\sigma} = \\left(\\frac{1}{m} \\sum_{i=1}^m \\frac{\\left(Y_i - \\Delta_i \\frac{\\sum_{j=1}^m Y_j}{\\sum_{j=1}^m \\Delta_j}\\right)^2}{\\Delta_i}\\right)^{\\frac{1}{2}}\n$$\n这些就是参数 $r$ 和 $\\sigma$ 的闭式最大似然估计量。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sum_{i=1}^m Y_i}{\\sum_{i=1}^m \\Delta_i} & \\left(\\frac{1}{m} \\sum_{i=1}^m \\frac{1}{\\Delta_i}\\left(Y_i - \\frac{\\Delta_i \\sum_{j=1}^m Y_j}{\\sum_{j=1}^m \\Delta_j}\\right)^2\\right)^{\\frac{1}{2}}\n\\end{pmatrix}\n}\n$$", "id": "2535427"}]}