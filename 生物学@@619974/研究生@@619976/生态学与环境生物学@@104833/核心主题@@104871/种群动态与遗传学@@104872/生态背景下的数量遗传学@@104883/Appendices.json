{"hands_on_practices": [{"introduction": "在野外估算遗传力是定量遗传学研究的基础，但表型测量值往往包含着不可忽略的误差。这个练习将引导你从第一性原理出发，推导测量误差如何系统性地影响窄义遗传力（$h^2$）的估算，并学习如何校正这种偏差。通过这个实践，你将更深刻地理解表型方差的构成，以及在经验研究中保持严谨性的重要性。[@problem_id:2526721]", "problem": "一位野外生态学家正在研究一个野生植物种群中的数量性状。设个体的潜在（真实的、无误差的）表型由随机变量 $Y$ 表示，其表型方差为 $V_{P}$，加性遗传方差为 $V_{A}$。狭义遗传力定义为 $h^{2} = V_{A}/V_{P}$。该性状在野外通过一种仪器测量，该仪器会引入独立的、均值为零的测量误差 $E$，其方差为 $V_{m}$，因此观测到的表型为 $Y_{\\text{obs}} = Y + E$。研究者未意识到测量误差的存在，通过将加性遗传方差除以观测表型方差来估计遗传力，从而得到观测遗传力 $h^{2}_{\\text{obs}}$。\n\n仅使用狭义遗传力的定义以及独立随机变量之和的方差等于其方差之和的性质，推导 $h^{2}$、$h^{2}_{\\text{obs}}$、$V_{P}$ 和 $V_{m}$ 之间的关系，并用它来量化 $h^{2}_{\\text{obs}}$ 中的向下偏差，并计算从 $h^{2}_{\\text{obs}}$ 恢复 $h^{2}$ 所需的校正。\n\n假设该种群根据经验估计的方差分量如下：$V_{A} = 0.24$，$V_{P} = 0.60$，$V_{m} = 0.15$ （单位均为性状单位的平方）。报告校正后的遗传力 $h^{2}$，其值为一个 0 到 1 之间的小数。将你的答案四舍五入到三位有效数字。", "solution": "本题要求分析测量误差如何影响狭义遗传力 $h^{2}$ 的估计。我们将首先验证题目的陈述，若其有效，则进行严谨的推导。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n- 潜在表型：随机变量 $Y$。\n- $Y$ 的表型方差：$V_{P}$。\n- 加性遗传方差：$V_{A}$。\n- 狭义遗传力的定义：$h^{2} = V_{A}/V_{P}$。\n- 测量误差：随机变量 $E$，独立于 $Y$，均值为零，方差为 $V_{m}$。\n- 观测表型：$Y_{\\text{obs}} = Y + E$。\n- 观测遗传力：$h^{2}_{\\text{obs}}$，通过将加性遗传方差除以观测表型方差计算得出。\n- 方差性质：独立随机变量之和的方差等于其方差之和。\n- 经验方差分量：$V_{A} = 0.24$，$V_{P} = 0.60$，$V_{m} = 0.15$。\n- 任务：推导 $h^{2}$、$h^{2}_{\\text{obs}}$、$V_{P}$ 和 $V_{m}$ 之间的关系。量化偏差。计算校正值。报告校正后的遗传力 $h^{2}$，保留三位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，植根于数量遗传学的基础原理。所描述的定义和关系（例如，方差分解、遗传力的定义）在该领域是标准的。测量误差导致表型方差增大的情景是经验生态学和遗传学中一个现实且常见的问题。该问题设定良好，为获得唯一解提供了所有必要的信息和定义。数值是一致且合理的（$V_{A} < V_{P}$，所有方差均为正值）。该问题是可形式化的，需要直接应用统计学和遗传学原理。它不是主观的、形而上学的或微不足道的。\n\n**步骤 3：结论与行动**\n问题有效。我们将继续进行求解。\n\n**推导与求解**\n\n真实的狭义遗传力 $h^{2}$ 定义为加性遗传方差 $V_{A}$ 与总潜在表型方差 $V_{P}$ 的比值：\n$$h^{2} = \\frac{V_{A}}{V_{P}}$$\n观测表型 $Y_{\\text{obs}}$ 是真实表型 $Y$ 和测量误差 $E$ 的和。\n$$Y_{\\text{obs}} = Y + E$$\n研究者使用观测表型的方差（我们记为 $V_{P, \\text{obs}}$）来计算观测遗传力 $h^{2}_{\\text{obs}}$。\n$$h^{2}_{\\text{obs}} = \\frac{V_{A}}{V_{P, \\text{obs}}}$$\n为了找到 $h^{2}$ 和 $h^{2}_{\\text{obs}}$ 之间的关系，我们必须首先用基本方差分量来表示 $V_{P, \\text{obs}}$。观测表型的方差为 $V_{P, \\text{obs}} = \\text{Var}(Y_{\\text{obs}})$。已知 $Y$ 和 $E$ 是独立随机变量，它们之和的方差等于它们各自方差之和：\n$$V_{P, \\text{obs}} = \\text{Var}(Y + E) = \\text{Var}(Y) + \\text{Var}(E)$$\n根据定义，$\\text{Var}(Y) = V_{P}$ 且 $\\text{Var}(E) = V_{m}$。因此，观测表型方差因测量误差方差而增大：\n$$V_{P, \\text{obs}} = V_{P} + V_{m}$$\n现在，将这个表达式代入 $h^{2}_{\\text{obs}}$ 的公式中：\n$$h^{2}_{\\text{obs}} = \\frac{V_{A}}{V_{P} + V_{m}}$$\n为了将其与真实遗传力 $h^{2}$ 联系起来，我们使用定义 $V_{A} = h^{2}V_{P}$。代入 $V_{A}$ 得到真实遗传力与观测遗传力之间的关系：\n$$h^{2}_{\\text{obs}} = \\frac{h^{2}V_{P}}{V_{P} + V_{m}} = h^{2} \\left( \\frac{V_{P}}{V_{P} + V_{m}} \\right)$$\n这个方程建立了 $h^{2}$、$h^{2}_{\\text{obs}}$、$V_{P}$ 和 $V_{m}$ 之间的关系。\n\n为了量化向下偏差，我们考察比例因子 $\\frac{V_{P}}{V_{P} + V_{m}}$。由于方差不能为负，所以 $V_{P} > 0$ 且 $V_{m} \\ge 0$。在本题中，存在测量误差，所以 $V_{m} > 0$。由此直接得出 $V_{P} < V_{P} + V_{m}$，因此该因子严格小于 1：\n$$\\frac{V_{P}}{V_{P} + V_{m}} < 1$$\n这表明 $h^{2}_{\\text{obs}} < h^{2}$ （对于任何 $h^2 > 0$），证实了当测量误差存在但被忽略时，遗传力估计中存在系统性的向下偏差。偏差是差值 $h^{2}_{\\text{obs}} - h^{2}$。\n\n为了找到从观测值 $h^{2}_{\\text{obs}}$ 恢复真实遗传力 $h^{2}$ 所需的校正，我们重排已推导出的关系式以求解 $h^{2}$：\n$$h^{2} = h^{2}_{\\text{obs}} \\left( \\frac{V_{P} + V_{m}}{V_{P}} \\right) = h^{2}_{\\text{obs}} \\left( 1 + \\frac{V_{m}}{V_{P}} \\right)$$\n该公式提供了必要的校正。要获得真实遗传力，观测遗传力必须乘以因子 $(1 + V_{m}/V_{P})$ 进行放大。\n\n最后，题目要求我们使用所提供的经验方差分量来报告校正后的遗传力 $h^{2}$。“校正后的遗传力”就是真实的遗传力，可以直接从所提供的真实方差分量计算得出。\n已知：\n$V_{A} = 0.24$\n$V_{P} = 0.60$\n$V_{m} = 0.15$\n\n使用狭义遗传力的基本定义：\n$$h^{2} = \\frac{V_{A}}{V_{P}} = \\frac{0.24}{0.60}$$\n计算过程为：\n$$h^{2} = \\frac{24}{60} = \\frac{2}{5} = 0.4$$\n为了验证一致性，我们可以先计算有偏差的估计值 $h^{2}_{\\text{obs}}$，然后应用校正。\n$V_{P, \\text{obs}} = V_{P} + V_{m} = 0.60 + 0.15 = 0.75$。\n$h^{2}_{\\text{obs}} = \\frac{V_{A}}{V_{P, \\text{obs}}} = \\frac{0.24}{0.75} = 0.32$。\n应用校正因子：\n$h^{2} = h^{2}_{\\text{obs}} \\left( 1 + \\frac{V_{m}}{V_{P}} \\right) = 0.32 \\left( 1 + \\frac{0.15}{0.60} \\right) = 0.32 (1 + 0.25) = 0.32(1.25) = 0.4$。\n结果相同，符合预期。题目要求答案四舍五入到三位有效数字。\n\n校正后的遗传力是 $h^2 = 0.400$。", "answer": "$$\\boxed{0.400}$$", "id": "2526721"}, {"introduction": "进化是由自然选择驱动的，但我们如何量化作用于自然种群的选择压力呢？本练习模拟了一个从野外采集数据的场景，要求你将个体的总适应度分解为存活和繁殖等多个阶段，并分别估算作用于性状的选择梯度。这个过程将让你掌握Lande和Arnold提出的经典选择分析框架，是将理论模型与实际数据联系起来的关键一步。[@problem_id:2526754]", "problem": "您会获得来自野生种群单个繁殖季节的个体水平数据，其中在选择前测量了一个目标性状，并记录了两个阶段性适合度组分：交配成功率和生存力。您的任务是分别针对生存和交配阶段估计该性状上的定向选择，并在一个加性遗传框架下预测标准化性状均值的净单代进化变化。\n\n您的推理必须仅基于以下核心定义和经过充分检验的数量遗传学事实：\n- 对于每个个体 $i$，绝对适合度是可测量的、乘法性组分（例如，存活率和交配成功率）的乘积。如果 $V_i$ 是生存力（存活至繁殖的概率；$V_i \\in \\{0,1\\}$），而 $M_i$ 是交配成功率（一个非负整数计数），那么绝对适合度为 $W_i = V_i \\times M_i$。\n- 任何组分 $C_i$ 的相对适合度是 $c_i = C_i / \\bar{C}$，其中 $\\bar{C}$ 是该组分在参考集中的均值（对于生存力：所有个体；对于交配：仅限于幸存者）。总相对适合度是 $w_i = W_i / \\bar{W}$，其中 $\\bar{W}$ 是种群中的平均绝对适合度。\n- 选择差定义为表型与相对适合度之间的协方差。对单个性状的定向选择可以通过使用普通最小二乘法（OLS）将相对适合度对标准化性状进行回归所得的斜率来估计，其中性状在种群水平上被标准化为均值为 $0$、方差为 $1$。\n\n您必须执行以下步骤：\n1. 性状标准化：给定原始性状值 $z_i$，计算标准化值 $z_i' = (z_i - \\bar{z}) / \\sigma_z$，其中 $\\bar{z}$ 是样本均值，$\\sigma_z$ 是使用除数 $N$（而非 $N-1$）计算的性状的种群标准差。\n2. 生存力阶段：为所有个体计算生存力相对适合度 $v_i = V_i / \\bar{V}$，其中 $\\bar{V}$ 是所有个体 $V_i$ 的样本均值。通过将 $v_i$ 对 $z_i'$ 进行回归（包含截距），估计定向生存力梯度作为 OLS 斜率。\n3. 交配阶段：限定于 $V_i = 1$ 的幸存者。计算交配相对适合度 $m_i = M_i / \\bar{M}_S$，其中 $\\bar{M}_S$ 是幸存者中 $M_i$ 的样本均值。通过在幸存者中将 $m_i$ 对 $z_i'$ 进行回归（包含截距），估计定向交配梯度作为 OLS 斜率。使用在种群水平上计算的相同的标准化性状值 $z_i'$。\n4. 总选择：为所有个体计算 $W_i = V_i \\times M_i$ 和总相对适合度 $w_i = W_i / \\bar{W}$。通过将 $w_i$ 对 $z_i'$ 进行回归（包含截距），估计净定向选择梯度作为 OLS 斜率。\n5. 进化预测：您会获得性状在标准化尺度上的加性遗传方差，记作 $G'$，这是在表型方差等于 $1$ 的单位下表示的加性遗传方差。使用定向选择下的标准加性遗传响应，预测标准化均值性状的单代变化，并以性状标准差单位报告。\n\n您的程序必须对以下测试套件执行上述计算，并按所列顺序为每个案例生成结果。在每个案例中，所有数组均按个体索引对齐。\n\n案例 A（两个阶段均有贡献的一般情况）：\n- 性状值 $z$：$[-0.7,-0.4,-0.2,0.0,0.1,0.3,0.6,0.8,1.1,1.3]$\n- 生存力 $V$：$[0,1,1,1,1,1,1,1,1,0]$\n- 交配计数 $M$：$[0,1,1,2,2,3,3,4,5,0]$\n- 加性遗传方差（标准化尺度）$G'$: $0.4$\n\n案例 B（无选择的边界情况：恒定的生存力和恒定的交配）：\n- 性状值 $z$：$[-1.0,-0.5,0.0,0.5,1.0]$\n- 生存力 $V$：$[1,1,1,1,1]$\n- 交配计数 $M$：$[2,2,2,2,2]$\n- 加性遗传方差（标准化尺度）$G'$: $0.3$\n\n案例 C（相反的阶段：生存力不利于高性状值，而交配偏好高性状值）：\n- 性状值 $z$：$[-1.5,-1.0,-0.8,-0.5,-0.2,0.0,0.2,0.5,0.8,1.0,1.2,1.5]$\n- 生存力 $V$：$[1,1,1,1,1,1,1,1,0,0,0,0]$\n- 交配计数 $M$：$[1,1,1,2,2,3,3,4,0,0,0,0]$\n- 加性遗传方差（标准化尺度）$G'$: $0.5$\n\n每个案例的必需输出：\n- 一个包含四个浮点数的列表 $[b_V, b_M, b_T, \\Delta]$，其中 $b_V$ 是生存力定向选择梯度，$b_M$ 是交配定向选择梯度，$b_T$ 是总定向选择梯度，$\\Delta$ 是预测的标准化均值性状的单代变化。\n- 将所有四个数字表示为小数点后六位四舍五入的小数。这些值以性状标准差为单位，因为性状是标准化的。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有案例的结果，形式为列表的列表，顺序为 A、B、C。例如：\"[[a1,a2,a3,a4],[b1,b2,b3,b4],[c1,c2,c3,c4]]\"。不得有任何其他打印文本。", "solution": "所呈现的问题是进化数量遗传学中的一个标准练习。它提法明确，有科学依据，并为获得唯一解提供了所有必要信息。这些定义和步骤与 Lande and Arnold (1983) 建立的用于测量自然选择的基础框架一致。因此，该问题是有效的，我们着手求解。\n\n目标是计算两个适合度阶段——生存力 ($V$) 和交配成功率 ($M$)——以及总适合度 ($W$) 的定向选择梯度 ($b$)，然后预测对选择的进化响应 ($\\Delta$)。性状的选择梯度定义为相对适合度对标准化性状值进行线性回归的斜率。\n\n首先，我们形式化选择梯度的计算。对于因变量 $y$（相对适合度）对自变量 $x$（标准化性状 $z'$）的简单线性回归，我们记为 $b$ 的普通最小二乘法（OLS）斜率由以下公式给出：\n$$\nb = \\frac{\\text{cov}(x, y)}{\\text{var}(x)}\n$$\n在这个问题中，性状 $z$ 被标准化为 $z'$，使得在大小为 $N$ 的整个初始种群中，其均值为 $\\bar{z}' = 0$，方差为 $\\text{var}(z') = 1$。\n\n该过程执行如下：\n\n步骤 1：性状标准化\n对于一组原始性状值 $\\{z_i\\}$，我们计算种群均值 $\\bar{z}$ 和种群标准差 $\\sigma_z$（使用除数 $N$）。每个个体 $i$ 的标准化性状值为：\n$$\nz'_i = \\frac{z_i - \\bar{z}}{\\sigma_z}\n$$\n根据构造，$\\{z'_i\\}$ 的完整集合的均值为 $0$，方差为 $1$。\n\n步骤 2：生存力选择梯度 ($b_V$)\n生存力相对适合度是 $v_i = V_i / \\bar{V}$，为所有 $N$ 个个体计算。生存力选择梯度 $b_V$ 是将 $v_i$ 对 $z'_i$ 进行回归得到的 OLS 斜率。由于此回归在 $\\text{var}(z') = 1$ 的整个种群上执行，公式简化为：\n$$\nb_V = \\frac{\\text{cov}(z', v)}{\\text{var}(z')} = \\text{cov}(z', v)\n$$\n此外，由于 $\\bar{z}' = 0$，协方差简化为乘积的均值：$\\text{cov}(z', v) = E[z'v] - E[z']E[v] = E[z'v]$。因此：\n$$\nb_V = \\frac{1}{N} \\sum_{i=1}^{N} z'_i v_i\n$$\n\n步骤 3：交配选择梯度 ($b_M$)\n此分析仅限于存活的 $N_S$ 个体子集（即 $V_i = 1$ 的个体）。交配相对适合度是 $m_i = M_i / \\bar{M}_S$，其中 $\\bar{M}_S$ 是幸存者中的平均交配成功率。交配选择梯度 $b_M$ 是将 $m_i$ 对 $z'_i$ 进行回归（针对此幸存者子集）得到的 OLS 斜率。\n关键是，幸存者子集内标准化性状值的方差 $\\text{var}(z'_{survivors})$ 不一定等于 $1$。因此，我们必须使用完整的 OLS 斜率公式，仅应用于 $N_S$ 个幸存者：\n$$\nb_M = \\frac{\\text{cov}(z'_{survivors}, m_{survivors})}{\\text{var}(z'_{survivors})}\n$$\n其中协方差和方差是在幸存者子集上计算的。\n\n步骤 4：总选择梯度 ($b_T$)\n总绝对适合度为 $W_i = V_i \\times M_i$。总相对适合度为 $w_i = W_i / \\bar{W}$。总选择梯度 $b_T$ 是通过在整个 $N$ 个个体的初始种群中将 $w_i$ 对 $z'_i$ 进行回归计算得出的。与生存力梯度一样，$\\text{var}(z') = 1$，因此计算简化为：\n$$\nb_T = \\frac{\\text{cov}(z', w)}{\\text{var}(z')} = \\text{cov}(z', w) = \\frac{1}{N} \\sum_{i=1}^{N} z'_i w_i\n$$\n量 $b_T$ 表示在所有适合度阶段中，作用于该性状的净定向选择压力。\n\n步骤 5：预测的进化变化 ($\\Delta$)\n标准化性状均值的单代变化由育种家方程预测。对选择的响应 ($\\Delta$) 是性状的遗传力 ($h^2$) 和选择差 ($S$) 的乘积。在标准化尺度上，表型方差为 $1$，因此遗传力在数值上等于标准化的加性遗传方差，$h^2 = G'/P' = G'/1 = G'$。标准化性状上的选择差等于总选择梯度，$S' = b_T$。因此，预测方程为：\n$$\n\\Delta = G' \\times b_T\n$$\n此预测变化 $\\Delta$ 以表型标准差为单位。\n\n以下 Python 代码为每个给定的测试案例精确地实现了这一逻辑。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to execute the analysis for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        {\n            \"z\": [-0.7, -0.4, -0.2, 0.0, 0.1, 0.3, 0.6, 0.8, 1.1, 1.3],\n            \"V\": [0, 1, 1, 1, 1, 1, 1, 1, 1, 0],\n            \"M\": [0, 1, 1, 2, 2, 3, 3, 4, 5, 0],\n            \"G_prime\": 0.4\n        },\n        {\n            \"z\": [-1.0, -0.5, 0.0, 0.5, 1.0],\n            \"V\": [1, 1, 1, 1, 1],\n            \"M\": [2, 2, 2, 2, 2],\n            \"G_prime\": 0.3\n        },\n        {\n            \"z\": [-1.5, -1.0, -0.8, -0.5, -0.2, 0.0, 0.2, 0.5, 0.8, 1.0, 1.2, 1.5],\n            \"V\": [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0],\n            \"M\": [1, 1, 1, 2, 2, 3, 3, 4, 0, 0, 0, 0],\n            \"G_prime\": 0.5\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_selection(case[\"z\"], case[\"V\"], case[\"M\"], case[\"G_prime\"])\n        results.append(result)\n\n    # Format the output string exactly as specified.\n    sub_strings = []\n    for r in results:\n        # Format each number to 6 decimal places.\n        formatted_numbers = [f\"{val:.6f}\" for val in r]\n        sub_strings.append(f\"[{','.join(formatted_numbers)}]\")\n    \n    final_output = f\"[{','.join(sub_strings)}]\"\n    print(final_output)\n\ndef calculate_selection(z, V, M, G_prime):\n    \"\"\"\n    Calculates selection gradients and evolutionary response for a single case.\n\n    Args:\n        z (list): Raw trait values.\n        V (list): Viability data (0 or 1).\n        M (list): Mating success counts.\n        G_prime (float): Additive genetic variance on the standardized scale.\n\n    Returns:\n        list: A list containing [b_V, b_M, b_T, delta].\n    \"\"\"\n    z_raw = np.array(z, dtype=np.float64)\n    V_raw = np.array(V, dtype=np.float64)\n    M_raw = np.array(M, dtype=np.float64)\n\n    # 1. Trait standardization\n    z_mean = np.mean(z_raw)\n    z_std = np.std(z_raw)  # Uses N in the denominator by default (ddof=0)\n    # Handle case where trait has no variance\n    if z_std == 0:\n        return [0.0, 0.0, 0.0, 0.0]\n    z_prime = (z_raw - z_mean) / z_std\n\n    # 2. Viability gradient (b_V)\n    b_V = 0.0\n    V_mean = np.mean(V_raw)\n    if V_mean > 0:\n        v_rel = V_raw / V_mean\n        # For regressions on the full dataset, var(z')=1, so gradient is cov(z', y_rel),\n        # which simplifies to mean(z' * y_rel) because mean(z')=0.\n        b_V = np.mean(z_prime * v_rel)\n\n    # 3. Mating gradient (b_M)\n    b_M = 0.0\n    survivors_mask = V_raw == 1\n    num_survivors = np.sum(survivors_mask)\n    if num_survivors >= 2: # OLS regression requires at least 2 data points\n        z_prime_survivors = z_prime[survivors_mask]\n        M_survivors = M_raw[survivors_mask]\n        \n        M_S_mean = np.mean(M_survivors)\n        if M_S_mean > 0:\n            m_rel = M_survivors / M_S_mean\n            \n            # Regression is on a subset, so var(z') is not 1. Use full OLS slope formula.\n            var_z_survivors = np.var(z_prime_survivors) # ddof=0 for population variance of the subset\n            if var_z_survivors > 0:\n                cov_zm_survivors = np.cov(z_prime_survivors, m_rel, ddof=0)[0, 1]\n                b_M = cov_zm_survivors / var_z_survivors\n\n    # 4. Total gradient (b_T)\n    b_T = 0.0\n    W_raw = V_raw * M_raw\n    W_mean = np.mean(W_raw)\n    if W_mean > 0:\n        w_rel = W_raw / W_mean\n        # Regression on full dataset, so simplified formula applies.\n        b_T = np.mean(z_prime * w_rel)\n\n    # 5. Evolutionary prediction (Delta)\n    delta = G_prime * b_T\n    \n    return [b_V, b_M, b_T, delta]\n\nsolve()\n```", "id": "2526754"}, {"introduction": "当选择同时作用于多个性状时，进化响应不仅取决于选择的方向，还受到性状间遗传相关（pleiotropy）的约束。这个练习将让你应用多变量育种家方程（multivariate breeder's equation），即 $\\Delta \\bar{\\mathbf{z}} = \\mathbf{G} \\boldsymbol{\\beta}$，来预测多个性状的联合进化。通过将进化响应分解到遗传变异的主轴上，你将直观地看到遗传结构如何引导或限制种群对选择的适应性改变。[@problem_id:2526726]", "problem": "一个多年生植物物种栖息于异质性环境中，表现出三个数量性状：开花期 ($z_{1}$)、叶片厚度 ($z_{2}$) 和最大根深 ($z_{3}$)。假设在单代内，在微弱且恒定的定向选择作用下，其联合进化响应由性状间的加性遗传协方差和定向选择梯度共同决定。加性遗传方差-协方差矩阵（$\\mathbf{G}$ 矩阵）和定向选择梯度向量 $\\boldsymbol{\\beta}$ 已通过一项大型田野研究估算得出，如下所示：\n$$\n\\mathbf{G} \\;=\\; \n\\begin{pmatrix}\n2 & 1 & 0 \\\\\n1 & 2 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix},\n\\qquad\n\\boldsymbol{\\beta} \\;=\\;\n\\begin{pmatrix}\n0.5 \\\\\n0.5 \\\\\n1\n\\end{pmatrix}.\n$$\n仅使用数量遗传学和线性代数的基本定义，对单代选择完成以下任务：\n1) 计算性状均值向量的期望变化量 $\\Delta \\bar{\\mathbf{z}}$。\n2) 将 $\\Delta \\bar{\\mathbf{z}}$ 分解为与 $\\mathbf{G}$ 矩阵的特征向量对齐的正交分量，并明确指出与 $\\mathbf{G}$ 矩阵最大特征值对应的特征向量所贡献的部分。\n\n最终答案请报告 $\\Delta \\bar{\\mathbf{z}}$ 模长平方中，可由沿 $\\mathbf{G}$ 矩阵主特征向量的分量所解释的比例。答案以小数形式表示，并四舍五入至四位有效数字。不包含任何单位。", "solution": "该问题陈述具有科学依据，提法严谨，并包含了获得唯一解所需的所有信息。该问题基于多变量育种家方程，这是数量遗传学的一个基石。所提供的加性遗传方差-协方差矩阵 $\\mathbf{G}$ 是对称的，并且（如下文将证明的）是正定的，这是此类矩阵的一个必要属性。该问题是有效的。\n\n性状均值向量的期望进化响应 $\\Delta \\bar{\\mathbf{z}}$ 由多变量育种家方程给出：\n$$\n\\Delta \\bar{\\mathbf{z}} = \\mathbf{G} \\boldsymbol{\\beta}\n$$\n其中 $\\mathbf{G}$ 是加性遗传方差-协方差矩阵，$\\boldsymbol{\\beta}$ 是定向选择梯度向量。\n\n首先，我们使用所提供的矩阵计算 $\\Delta \\bar{\\mathbf{z}}$：\n$$\n\\mathbf{G} = \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}, \\qquad \\boldsymbol{\\beta} = \\begin{pmatrix} 0.5 \\\\ 0.5 \\\\ 1 \\end{pmatrix}\n$$\n矩阵-向量乘积为：\n$$\n\\Delta \\bar{\\mathbf{z}} = \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ 0.5 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2(0.5) + 1(0.5) + 0(1) \\\\ 1(0.5) + 2(0.5) + 0(1) \\\\ 0(0.5) + 0(0.5) + 1(1) \\end{pmatrix} = \\begin{pmatrix} 1.5 \\\\ 1.5 \\\\ 1 \\end{pmatrix}\n$$\n接下来，我们将此响应向量 $\\Delta \\bar{\\mathbf{z}}$ 分解为与 $\\mathbf{G}$ 矩阵的特征向量对齐的分量。由于 $\\mathbf{G}$ 是一个实对称矩阵，其特征向量构成一个正交基。我们必须求出这些特征向量和对应的特征值。特征值 $\\lambda$ 是特征方程 $\\det(\\mathbf{G} - \\lambda\\mathbf{I}) = 0$ 的根。\n$$\n\\det\\left(\\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} - \\lambda\\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\\right) = \\det\\begin{pmatrix} 2-\\lambda & 1 & 0 \\\\ 1 & 2-\\lambda & 0 \\\\ 0 & 0 & 1-\\lambda \\end{pmatrix} = 0\n$$\n沿第三行展开行列式可得：\n$$\n(1-\\lambda) \\det\\begin{pmatrix} 2-\\lambda & 1 \\\\ 1 & 2-\\lambda \\end{pmatrix} = (1-\\lambda) \\left[(2-\\lambda)^{2} - 1\\right] = 0\n$$\n$$\n(1-\\lambda) (\\lambda^{2} - 4\\lambda + 4 - 1) = (1-\\lambda) (\\lambda^{2} - 4\\lambda + 3) = (1-\\lambda)(\\lambda-1)(\\lambda-3) = 0\n$$\n特征值为 $\\lambda_1 = 3$，$\\lambda_2 = 1$，和 $\\lambda_3 = 1$。所有特征值均为正，这证实了 $\\mathbf{G}$ 矩阵是正定的。主特征值，即对应于最大遗传方差轴（称为 $g_{max}$）的特征值，是 $\\lambda_{max} = 3$。\n\n现在我们求解与 $\\lambda_{max} = 3$ 对应的特征向量 $\\mathbf{e}_{max}$。我们求解方程 $(\\mathbf{G} - 3\\mathbf{I})\\mathbf{v} = \\mathbf{0}$：\n$$\n\\begin{pmatrix} 2-3 & 1 & 0 \\\\ 1 & 2-3 & 0 \\\\ 0 & 0 & 1-3 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix} = \\begin{pmatrix} -1 & 1 & 0 \\\\ 1 & -1 & 0 \\\\ 0 & 0 & -2 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这就得到了方程组 $-v_1 + v_2 = 0$（因此 $v_1=v_2$）和 $-2v_3 = 0$（因此 $v_3=0$）。一个代表性的特征向量是 $\\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$。为了获得单位化的特征向量，我们将其除以其模长 $||\\mathbf{v}|| = \\sqrt{1^2 + 1^2 + 0^2} = \\sqrt{2}$。\n单位化的主特征向量是：\n$$\n\\mathbf{e}_{max} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n$\\Delta \\bar{\\mathbf{z}}$ 沿 $\\mathbf{e}_{max}$ 方向的分量由 $\\Delta \\bar{\\mathbf{z}}$ 在 $\\mathbf{e}_{max}$ 上的投影给出：\n$$\n(\\Delta \\bar{\\mathbf{z}})_{max} = (\\Delta \\bar{\\mathbf{z}} \\cdot \\mathbf{e}_{max}) \\mathbf{e}_{max}\n$$\n投影系数是标量积：\n$$\nc_{max} = \\Delta \\bar{\\mathbf{z}} \\cdot \\mathbf{e}_{max} = \\begin{pmatrix} 1.5 \\\\ 1.5 \\\\ 1 \\end{pmatrix} \\cdot \\left(\\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}\\right) = \\frac{1}{\\sqrt{2}} (1.5 \\times 1 + 1.5 \\times 1 + 1 \\times 0) = \\frac{3}{\\sqrt{2}}\n$$\n响应向量沿 $\\mathbf{e}_{max}$ 的分量明确为 $(\\Delta \\bar{\\mathbf{z}})_{max} = \\frac{3}{\\sqrt{2}} \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} \\right) = \\frac{3}{2} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1.5 \\\\ 1.5 \\\\ 0 \\end{pmatrix}$。\n\n问题要求的是 $\\Delta \\bar{\\mathbf{z}}$ 模长平方中可由该分量解释的比例。首先，我们计算总响应向量 $\\Delta \\bar{\\mathbf{z}}$ 的模长平方：\n$$\n||\\Delta \\bar{\\mathbf{z}}||^2 = (1.5)^2 + (1.5)^2 + 1^2 = 2.25 + 2.25 + 1 = 5.5\n$$\n接下来，我们计算沿 $\\mathbf{e}_{max}$ 的分量的模长平方。由于 $\\mathbf{e}_{max}$ 是一个单位向量，这个值就是投影系数的平方 $c_{max}^2$：\n$$\n||(\\Delta \\bar{\\mathbf{z}})_{max}||^2 = c_{max}^2 = \\left(\\frac{3}{\\sqrt{2}}\\right)^2 = \\frac{9}{2} = 4.5\n$$\n所求的比例是这两个模长平方的比值：\n$$\n\\text{比例} = \\frac{||(\\Delta \\bar{\\mathbf{z}})_{max}||^2}{||\\Delta \\bar{\\mathbf{z}}||^2} = \\frac{4.5}{5.5} = \\frac{45}{55} = \\frac{9}{11}\n$$\n最后，我们将这个分数表示为小数，并四舍五入到四位有效数字：\n$$\n\\frac{9}{11} \\approx 0.818181...\n$$\n四舍五入后得到 $0.8182$。这一结果表明，以变化的平方来衡量，大约 $81.82\\%$ 的总进化响应被约束在最大遗传方差轴上。", "answer": "$$\n\\boxed{0.8182}\n$$", "id": "2526726"}]}