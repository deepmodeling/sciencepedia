{"hands_on_practices": [{"introduction": "从一个营养级到下一个营养级的总能量转移效率并不是一个单一的数值。它实际上是几个不同生物和生态过程的乘积：捕食效率、同化效率和生产效率。本练习将引导你计算总的传递效率，并更重要地，促使你思考这些抽象的效率在现实世界的生态系统中是如何通过实证研究来测量的。[@problem_id:2531465]", "problem": "一个远洋食物网模块包含一个核心捕食者功能群，在一个固定的时间窗口内捕食单个猎物功能群，在此期间，种群储存量相对于流通量可以忽略不计。设 $P_{\\mathrm{prey}}$ 表示该时间窗口内猎物功能群的产量， $I$ 表示捕食者从该猎物获得的摄食量， $A$ 表示该摄食量的同化部分，$P_{\\mathrm{pred}}$ 表示捕食者功能群的产量（生长加繁殖）。利用质能守恒和标准生态生产预算定义以下效率：开发效率 $EE$ 为被捕食者摄食的猎物产量比例，$EE = I / P_{\\mathrm{prey}}$；同化效率 $AE$ 为摄食能量中被同化的比例，$AE = A / I$；生产效率 $PE$ 为同化能量中实现为捕食者产量的比例，$PE = P_{\\mathrm{pred}} / A$。从猎物产量到捕食者产量的营养转移效率为 $\\lambda$，定义为在同一时间窗口内，$P_{\\mathrm{prey}}$ 中以 $P_{\\mathrm{pred}}$ 形式出现的比例，即 $\\lambda = P_{\\mathrm{pred}} / P_{\\mathrm{prey}}$。\n\n此模块的测量值给定为 $EE = 0.5$，$AE = 0.7$ 和 $PE = 0.3$。仅使用上述定义和质能平衡，计算 $\\lambda$ 并将其表示为无单位的小数。将您的答案四舍五入到 $3$ 位有效数字。在您的推理中，还需解释在实践中如何从野外和实验室数据凭经验估算 $EE$、$AE$ 和 $PE$ 中的每一个，而无需借助未经测量的“捷径”公式。", "solution": "该问题详细说明了跨一个营养级的质能核算。其基本依据包括以下在固定时间窗口内经过充分检验的生态能量学定义和守恒定律：\n\n1. 定义猎物产量为 $P_{\\mathrm{prey}}$。\n2. 捕食者从该猎物获得的摄食量为 $I$。\n3. 捕食者的同化量为 $A$。\n4. 捕食者的产量（生长加繁殖）为 $P_{\\mathrm{pred}}$。\n\n根据定义，\n- 开发效率为 $EE = I / P_{\\mathrm{prey}}$。\n- 同化效率为 $AE = A / I$。\n- 生产效率为 $PE = P_{\\mathrm{pred}} / A$。\n\n我们感兴趣的营养转移效率是猎物产量中表现为捕食者产量的部分：\n$$\n\\lambda = \\frac{P_{\\mathrm{pred}}}{P_{\\mathrm{prey}}}.\n$$\n\n为了用各组分效率表示 $\\lambda$，我们利用定义将各项预算逐步联系起来。从 $EE = I / P_{\\mathrm{prey}}$ 开始，这意味着\n$$\nI = EE \\, P_{\\mathrm{prey}}.\n$$\n接下来，$AE = A / I$ 意味着\n$$\nA = AE \\, I.\n$$\n最后，$PE = P_{\\mathrm{pred}} / A$ 意味着\n$$\nP_{\\mathrm{pred}} = PE \\, A.\n$$\n按顺序组合这些关系：\n$$\nP_{\\mathrm{pred}} = PE \\, A = PE \\,(AE \\, I) = PE \\,(AE \\,(EE \\, P_{\\mathrm{prey}})) = (EE \\, AE \\, PE)\\, P_{\\mathrm{prey}}.\n$$\n两边同除以 $P_{\\mathrm{prey}}$ 得到\n$$\n\\lambda = \\frac{P_{\\mathrm{pred}}}{P_{\\mathrm{prey}}} = EE \\times AE \\times PE.\n$$\n\n代入给定值 $EE = 0.5$，$AE = 0.7$ 和 $PE = 0.3$：\n$$\n\\lambda = 0.5 \\times 0.7 \\times 0.3 = 0.105.\n$$\n四舍五入到 $3$ 位有效数字，结果仍为 $0.105$。\n\n各组分的经验估算（基于可测量量的概念性纲要）：\n\n- 估算 $EE$（开发效率）：$EE = I / P_{\\mathrm{prey}}$ 需要在同一时间窗口内对猎物产量和捕食者从该猎物获得的摄食量进行独立估算。$P_{\\mathrm{prey}}$ 可以用适合猎物分类单元的标准生产方法来测量（对初级生产者，可使用同位素或溶解氧产量分析法，并结合生长模型；对动物猎物，可使用基于世代的增量求和法，或将经验性生产量-生物量关系与生长速率相结合）。$I$ 可以通过捕食者消耗量测量来估算：野外胃含物时间序列结合胃排空率，将胃含物转化为摄食率；基于示踪剂的摄食量（例如，标记的猎物）；或受观测到的生长和呼吸限制的生物能量需求模型，并使用来自胃含物或稳定同位素混合模型的食性组成，将其分配给核心猎物。在相同的时空域内，$I / P_{\\mathrm{prey}}$ 的比值即为 $EE$。\n\n- 估算 $AE$（同化效率）：$AE = A / I$ 需要同时测量摄食量和排遗量。用已知份量的核心猎物对代表性捕食者进行受控喂养试验，收集所有粪便和反刍物以量化排遗物。使用能量或元素特异性分析（例如，用弹式量热法测能量，用碳氮分析测元素）来计算 $I$ 和未同化部分。同化量为 $A = I - \\text{排遗量}$。在野外，$AE$ 也可以通过将摄食量估算与使用沉积物捕集器和排泄培养法直接测量的排遗量和溶解有机物损失相结合来推断，尽管对于给定的食性和温度，实验室校准通常能提供更精确的 $AE$。\n\n- 估算 $PE$（生产效率）：$PE = P_{\\mathrm{pred}} / A$ 需要捕食者产量和同化量。捕食者产量 $P_{\\mathrm{pred}}$ 在该时间窗口内被量化为躯体生长加上繁殖输出（生长量来自重复的体型-质量测量或耳石/标志重捕法的增量；繁殖量来自生殖腺产量或后代生物量）。同化量 $A$ 可以从 $AE$ 估算值与摄食量结合得到，$A = AE \\times I$，或者独立地从完整的能量收支中得到，$A = P_{\\mathrm{pred}} + R + \\text{排泄量}$，其中 $R$ 是用呼吸测定法测量的呼吸量。该比值提供了 $PE$。\n\n总之，这些独立可测量的量，当如上组合时，通过纯粹的流量核算得出了 $\\lambda$ 的乘积形式，然后我们对其进行了数值计算。\n\n因此，所要求的无单位小数（保留 $3$ 位有效数字）是 $0.105$。", "answer": "$$\\boxed{0.105}$$", "id": "2531465"}, {"introduction": "对能量流动的理解需要超越纯粹的能量视角。生物体是由各种化学元素（如 $C$、$N$、$P$）按特定比例构成的，而这种构成需求会影响其能量利用效率。这个练习探讨了当食物的元素组成与消费者身体的元素组成不匹配时，即使能量充足，也会如何限制其生长效率，从而引入了关键的养分限制概念。[@problem_id:2531433]", "problem": "一种恒温水生消费者维持着严格的元素稳态，其碳氮摩尔比为 $r_{c} = 6$。它摄食的食物的碳氮摩尔比为 $r_{d} = 20$。设摄食量以碳为基准定义，摄入的碳为 $I_{C}$，摄入的氮为 $I_{N} = I_{C}/r_{d}$。碳的同化效率为 $AE_{C} = 0.7$，氮的同化效率为 $AE_{N} = 0.7$，因此同化量分别为 $A_{C} = AE_{C}\\,I_{C}$ 和 $A_{N} = AE_{N}\\,I_{N}$。假设该消费者只有在同化的元素完全满足其化学计量需求时才能将其分配给新的生物量，任何超过平衡生长所需氮量的过量同化碳都被呼吸消耗掉，并且没有其他代谢成本或损失。将生产量 $P$ 定义为整合到新生物量中的碳量。将生产效率 $\\mathrm{PE}$ 定义为基于碳的总生长效率，$\\mathrm{PE} = P/I_{C}$。仅使用这些定义和质量平衡，并假设在给定的化学计量约束下，生长仅受限制性更强的元素限制，计算可实现的最大 $\\mathrm{PE}$。你的答案应以无单位的小数形式表示，不带百分号。如果结果为精确小数，则无需四舍五入。", "solution": "首先根据所需标准对问题进行验证。\n\n从问题陈述中提取的已知条件：\n- 消费者的碳氮摩尔比：$r_{c} = 6$。\n- 食物的碳氮摩尔比：$r_{d} = 20$。\n- 摄入的碳：$I_{C}$。\n- 摄入的氮：$I_{N} = I_{C}/r_{d}$。\n- 碳的同化效率：$AE_{C} = 0.7$。\n- 氮的同化效率：$AE_{N} = 0.7$。\n- 同化的碳：$A_{C} = AE_{C}\\,I_{C}$。\n- 同化的氮：$A_{N} = AE_{N}\\,I_{N}$。\n- 生物量生产（生长）需要 $r_{c}$ 的碳氮比。\n- 超过化学计量需求而同化的碳被呼吸消耗。\n- 不考虑其他代谢成本或损失。\n- 生产量 $P$ 定义为整合到新生物量中的碳。\n- 生产效率 $\\mathrm{PE}$ 定义为 $\\mathrm{PE} = P/I_{C}$。\n- 生长受化学计量上更稀缺的元素限制。\n\n验证结论：\n该问题在科学上基于生态化学计量学的原理。定义清晰、自洽且一致。提供的数值是合理的。问题提法得当、客观，并需要基于所提供模型进行逻辑推导。它并非浅显，也未基于任何谬误。因此，该问题被认为是有效的，可以推导出解决方案。\n\n目标是计算生产效率 $\\mathrm{PE} = P/I_{C}$。数量 $P$ 代表整合到新生物量中的碳。这一过程受到同化养分的可利用性以及消费者生物量严格的化学计量要求（即碳氮摩尔比为 $r_{c} = 6$）的约束。\n\n首先，我们确定相对于摄入的碳 $I_{C}$，同化的碳（$A_{C}$）和氮（$A_{N}$）的量。\n同化的碳量由下式给出：\n$$A_{C} = AE_{C} \\cdot I_{C} = 0.7 \\cdot I_{C}$$\n摄入的氮量 $I_{N}$ 通过食物的碳氮比 $r_{d}$ 与摄入的碳量 $I_{C}$ 相关联：\n$$I_{N} = \\frac{I_{C}}{r_{d}} = \\frac{I_{C}}{20}$$\n那么同化的氮量 $A_{N}$ 为：\n$$A_{N} = AE_{N} \\cdot I_{N} = AE_{N} \\cdot \\frac{I_{C}}{r_{d}} = 0.7 \\cdot \\frac{I_{C}}{20}$$\n\n接下来，我们必须确定生长的限制性养分。这通过比较可利用的同化养分的比例与新生物量所需的比例来确定。同化的碳与同化的氮的比例是：\n$$\\frac{A_{C}}{A_{N}} = \\frac{AE_{C} \\cdot I_{C}}{AE_{N} \\cdot (I_{C}/r_{d})}$$\n鉴于 $AE_{C} = AE_{N} = 0.7$，这些项可以消去：\n$$\\frac{A_{C}}{A_{N}} = \\frac{I_{C}}{I_{C}/r_{d}} = r_{d} = 20$$\n消费者的生物量需要 $r_{c} = 6$ 的碳氮比。我们将可利用的同化养分的比例（$A_{C}/A_{N} = 20$）与生物量所需的比例（$r_{c} = 6$）进行比较。\n由于 $A_{C}/A_{N} > r_{c}$（即 $20 > 6$），相对于氮，碳在化学计量上是过量的。因此，氮是生长的限制性养分。\n\n根据问题陈述，生长是通过利用全部限制性养分来进行的。因此，所有同化的氮 $A_{N}$ 都将被整合到新的生物量中。设 $P_{N}$ 为整合到生产量中的氮。\n$$P_{N} = A_{N} = 0.7 \\cdot \\frac{I_{C}}{20}$$\n整合到新生物量中的碳量（定义为生产量 $P$）必须满足消费者相对于整合的氮 $P_{N}$ 的化学计量比 $r_{c}$。\n$$\\frac{P}{P_{N}} = r_{c}$$\n$$P = r_{c} \\cdot P_{N}$$\n代入 $P_{N}$ 的表达式：\n$$P = r_{c} \\cdot \\left( 0.7 \\cdot \\frac{I_{C}}{20} \\right)$$\n问题要求计算生产效率 $\\mathrm{PE}$，定义为 $P/I_{C}$。\n$$\\mathrm{PE} = \\frac{P}{I_{C}} = \\frac{r_{c} \\cdot \\left( 0.7 \\cdot \\frac{I_{C}}{20} \\right)}{I_{C}}$$\n分子和分母中的 $I_{C}$ 项相互抵消，得到 $\\mathrm{PE}$ 的表达式：\n$$\\mathrm{PE} = \\frac{r_{c} \\cdot 0.7}{r_{d}}$$\n在更一般的形式下，对于氮限制（$r_{d} > r_{c}$），且给定 $AE_C = AE_N$：\n$$\\mathrm{PE} = \\frac{r_{c} \\cdot AE_{N}}{r_{d}}$$\n现在我们代入给定的数值：$r_{c}=6$, $r_{d}=20$ 和 $AE_{N}=0.7$。\n$$\\mathrm{PE} = \\frac{6 \\cdot 0.7}{20} = \\frac{4.2}{20}$$\n$$\\mathrm{PE} = 0.21$$\n过量同化的碳 $A_C^{excess}$ 被呼吸消耗掉。这可以通过总同化碳减去用于生产的碳来计算：\n$A_C^{excess} = A_C - P = (0.7 \\cdot I_C) - (0.21 \\cdot I_C) = 0.49 \\cdot I_C$。这证实了由于化学计量失衡，相当一部分同化碳未被用于生长。最终的生产效率完全由化学计量失配和同化效率决定。", "answer": "$$\\boxed{0.21}$$", "id": "2531433"}, {"introduction": "能量利用效率不是固定不变的常数，而是响应环境条件（如温度）的动态生理特征。这项高级实践将指导你如何利用实验数据來校准一个生物能量学模型。通过这个模型，你将能够预测生物的生长效率如何随温度梯度的变化而改变，这对于预测生态系统如何响应气候变化至关重要。[@problem_id:2531473]", "problem": "考虑一个在生态现实温度范围内的鱼类能量收支，其中摄食和呼吸被测量为温度的函数。您的任务是根据实验室测量数据校准一个关于摄食和呼吸的温度依赖性生物能量学模型，然后使用该校准模型计算在指定温度梯度下的预测总生长效率。您的推导和实现必须仅从核心定义和广为接受的经验性温度标度关系开始，并且不得先验地假设任何目标效率。\n\n从以下基本定义和事实开始。\n\n1. 生物体能量收支恒等式（每个个体，每单位时间）：摄入的能量 $I(T)$ 被分配给生长 $G(T)$、呼吸 $R(T)$、排泄 $U(T)$、特定动态作用 $S(T)$（吸收后处理成本）和排遗 $F(T)$（未同化的粪便），因此 $I(T) = G(T) + R(T) + U(T) + S(T) + F(T)$。\n2. 同化效率 $AE$ 是摄入能量中被同化的部分，因此 $A(T) = AE \\cdot I(T)$ 且 $F(T) = (1 - AE) \\cdot I(T)$。\n3. 一种常用的吸收后成本表示法将 $U(T)$ 和 $S(T)$ 建模为同化能量的固定比例：$U(T) = e \\cdot A(T)$ 和 $S(T) = s \\cdot A(T)$，其中常数 $e$ 和 $s$ 在研究范围内与 $T$ 无关。\n4. 总生长效率 (GGE) 定义为摄入能量中转化为生长的部分：$\\mathrm{GGE}(T) = \\dfrac{G(T)}{I(T)}$，表示为小数（无单位）。\n5. 在一个适度的、亚致死温度范围内，许多生理速率可以用 $Q_{10}$ 模型很好地描述：对于任何速率 $X(T)$，$X(T) = X_{\\mathrm{ref}} \\cdot q^{(T - T_{\\mathrm{ref}})/10}$，其中 $X_{\\mathrm{ref}}$ 是在参考温度 $T_{\\mathrm{ref}}$ 下的速率，而 $q$ 是 $Q_{10}$ 参数。取自然对数可得 $\\ln X(T) = \\ln X_{\\mathrm{ref}} + \\left(\\dfrac{\\ln q}{10}\\right) (T - T_{\\mathrm{ref}})$，这使得线性最小二乘法校准成为可能。\n\n校准目标：通过最小化观测速率和模型速率在自然对数空间中的残差平方和，为摄食 $I(T)$ 和呼吸 $R(T)$ 分别校准两个独立的 $Q_{10}$ 模型。也就是说，对于每个过程 $X \\in \\{I, R\\}$，通过对线性化形式 $\\ln X(T) = \\beta_0 + \\beta_1 (T - T_{\\mathrm{ref}})$ 进行普通最小二乘法来估计 $X_{\\mathrm{ref}}$ 和 $q_X$，其中 $\\beta_0 = \\ln X_{\\mathrm{ref}}$ 且 $\\beta_1 = \\dfrac{\\ln q_X}{10}$。\n\n校准完成后，仅使用能量收支恒等式和校准的 $I(T)$ 和 $R(T)$，计算在指定温度梯度上的预测 $\\mathrm{GGE}(T)$。所有摄食和呼吸测量值均以千焦/天/个体为单位，所有温度均以摄氏度为单位。所有 $\\mathrm{GGE}(T)$ 的输出必须报告为小数（无单位），并四舍五入到四位小数。\n\n测试套件和参数：\n\n对于所有测试用例，使用共同的参考温度 $T_{\\mathrm{ref}} = 15$ 摄氏度以及常数 $AE = 0.72$，$s = 0.18$，$e = 0.10$。\n\n- 测试用例 A (juvenile salmonid-like energetics):\n  - 观测数据：温度 $[\\,5,\\,10,\\,15,\\,20,\\,25\\,]$（摄氏度），摄食 $[\\,12.7,\\,18.0,\\,25.0,\\,36.0,\\,48.0\\,]$（千焦/天/个体），呼吸 $[\\,4.6,\\,6.8,\\,10.0,\\,15.2,\\,22.1\\,]$（千焦/天/个体）。\n  - 在温度 $[\\,5,\\,10,\\,15,\\,20,\\,25\\,]$（摄氏度）下评估 $\\mathrm{GGE}(T)$。\n\n- 测试用例 B (small benthic fish):\n  - 观测数据：温度 $[\\,5,\\,10,\\,15,\\,20,\\,25\\,]$（摄氏度），摄食 $[\\,6.4,\\,8.8,\\,12.0,\\,16.3,\\,22.5\\,]$（千焦/天/个体），呼吸 $[\\,2.2,\\,3.3,\\,5.0,\\,7.4,\\,11.4\\,]$（千焦/天/个体）。\n  - 在温度 $[\\,5,\\,10,\\,15,\\,20,\\,25\\,]$（摄氏度）下评估 $\\mathrm{GGE}(T)$。\n\n- 测试用例 C (cold-adapted fish, 较稀疏的数据):\n  - 观测数据：温度 $[\\,6,\\,12,\\,18,\\,24\\,]$（摄氏度），摄食 $[\\,11.2,\\,12.9,\\,15.2,\\,17.6\\,]$（千焦/天/个体），呼吸 $[\\,3.3,\\,4.9,\\,7.4,\\,11.1\\,]$（千焦/天/个体）。\n  - 在温度 $[\\,6,\\,12,\\,18,\\,24\\,]$（摄氏度）下评估 $\\mathrm{GGE}(T)$。\n\n实现要求：\n\n- 如上所述，在自然对数空间中通过线性最小二乘法分别为 $I(T)$ 和 $R(T)$ 校准 $Q_{10}$ 模型参数。使用为每个测试用例给定的 $T_{\\mathrm{ref}}$（在此处所有用例中均相同）。\n- 从校准的 $I(T)$ 和 $R(T)$，严格根据能量收支关系和定义，并使用提供的常数 $AE$、$s$ 和 $e$ 来推导 $G(T)$，然后推导出 $\\mathrm{GGE}(T)$。\n- 将 $\\mathrm{GGE}(T)$ 值报告为小数（无单位），并四舍五入到四位小数。\n- 您的程序必须确定性地执行，无需用户交互，并生成单行输出，其中包含一个逗号分隔的嵌套列表。每个内部列表按 A、B、C 的顺序对应一个测试用例，并按该用例指定的评估温度顺序包含 $\\mathrm{GGE}(T)$ 值。例如，一个包含两个内部列表的输出看起来像这样：“[[0.1234,0.2345],[0.3456,0.4567]]”（这只是一个格式示例，并非此处期望的数字）。\n\n答案格式：\n\n- 生成仅一行输出，包含如上所述的嵌套列表（输出中无单位；所有值均为四舍五入到四位小数的小数）。\n- 不要打印任何额外文本。", "solution": "该问题要求校准一个温度依赖性的生物能量学模型，并应用该模型来预测鱼类的总生长效率（$\\mathrm{GGE}$）。该过程包括两个主要阶段：首先，使用提供的实验数据进行模型校准；其次，在指定温度下预测 $\\mathrm{GGE}(T)$。\n\n支配生物体能量收支的基本关系是能量守恒定律，表述为：\n$$\nI(T) = G(T) + R(T) + U(T) + S(T) + F(T)\n$$\n其中 $I$ 是摄食，$G$ 是生长，$R$ 是呼吸，$U$ 是排泄，$S$ 是特定动态作用，$F$ 是排遗，所有这些都是单位时间的量并且是温度 $T$ 的函数。我们的任务是找到总生长效率，定义为：\n$$\n\\mathrm{GGE}(T) = \\frac{G(T)}{I(T)}\n$$\n为了推导 $\\mathrm{GGE}(T)$ 的表达式，我们首先用可建模的量来表示生长 $G(T)$。重新整理能量收支方程可得：\n$$\nG(T) = I(T) - R(T) - U(T) - S(T) - F(T)\n$$\n问题为能量损失项提供了定义。排遗 $F(T)$ 是摄食的一部分，通过同化效率 $AE$ 关联：\n$$\nF(T) = (1 - AE) \\cdot I(T)\n$$\n同化能 $A(T)$ 是摄入能量中未被排遗的部分：\n$$\nA(T) = I(T) - F(T) = I(T) - (1-AE) \\cdot I(T) = AE \\cdot I(T)\n$$\n排泄 $U(T)$ 和特定动态作用 $S(T)$ 被定义为同化能的固定比例，分别为 $e$ 和 $s$：\n$$\nU(T) = e \\cdot A(T) = e \\cdot AE \\cdot I(T)\n$$\n$$\nS(T) = s \\cdot A(T) = s \\cdot AE \\cdot I(T)\n$$\n将这些代入 $G(T)$ 的方程中：\n$$\nG(T) = I(T) - R(T) - (e \\cdot AE \\cdot I(T)) - (s \\cdot AE \\cdot I(T)) - ((1-AE) \\cdot I(T))\n$$\n我们可以合并含有 $I(T)$ 的项：\n$$\nG(T) = I(T) \\cdot (1 - e \\cdot AE - s \\cdot AE - (1-AE)) - R(T)\n$$\n简化 $I(T)$ 的系数：\n$$\n1 - e \\cdot AE - s \\cdot AE - 1 + AE = AE \\cdot (1 - e - s)\n$$\n这导出了生长的最终表达式：\n$$\nG(T) = AE \\cdot (1-e-s) \\cdot I(T) - R(T)\n$$\n现在，我们可以通过将生长方程除以 $I(T)$ 来写出 $\\mathrm{GGE}(T)$ 的表达式：\n$$\n\\mathrm{GGE}(T) = \\frac{AE \\cdot (1-e-s) \\cdot I(T) - R(T)}{I(T)} = AE \\cdot (1-e-s) - \\frac{R(T)}{I(T)}\n$$\n这就是我们将用于预测的方程。它需要已知函数 $I(T)$ 和 $R(T)$。\n\n问题指明摄食 $I(T)$ 和呼吸 $R(T)$ 都使用 $Q_{10}$ 关系进行建模：\n$$\nX(T) = X_{\\mathrm{ref}} \\cdot q^{(T - T_{\\mathrm{ref}})/10}\n$$\n其中 $X$ 代表 $I$ 或 $R$，$X_{\\mathrm{ref}}$ 是在参考温度 $T_{\\mathrm{ref}}$ 下的速率，而 $q$ 是 $Q_{10}$ 因子。为了找到参数 $X_{\\mathrm{ref}}$ 和 $q$，我们使用提供的数据来校准模型。校准通过对模型的自然对数转换版本进行线性最小二乘回归来执行：\n$$\n\\ln X(T) = \\ln X_{\\mathrm{ref}} + \\left(\\frac{\\ln q}{10}\\right) (T - T_{\\mathrm{ref}})\n$$\n该方程具有直线形式 $y = \\beta_0 + \\beta_1 x$，其中：\n- $y = \\ln X(T)$\n- $x = T - T_{\\mathrm{ref}}$\n- 截距 $\\beta_0 = \\ln X_{\\mathrm{ref}}$\n- 斜率 $\\beta_1 = (\\ln q)/10$\n\n对于每个测试用例，我们执行两次独立的线性回归：一次针对摄食数据 ($T_{\\mathrm{obs}}$, $I_{\\mathrm{obs}}$)，一次针对呼吸数据 ($T_{\\mathrm{obs}}$, $R_{\\mathrm{obs}}$)。\n从每个过程（$X \\in \\{I, R\\}$）的回归输出中，我们获得估计的斜率 $\\hat{\\beta}_1$ 和截距 $\\hat{\\beta}_0$。然后模型参数计算如下：\n$$\n\\hat{X}_{\\mathrm{ref}} = e^{\\hat{\\beta}_0}\n$$\n$$\n\\hat{q} = e^{10 \\cdot \\hat{\\beta}_1}\n$$\n利用校准后的函数 $\\hat{I}(T)$ 和 $\\hat{R}(T)$，我们可以使用推导出的 $\\mathrm{GGE}(T)$ 公式来预测有效范围内任何温度 $T$ 下的总生长效率。\n\n每个测试用例的总体算法如下：\n1.  设置常数 $T_{\\mathrm{ref}} = 15 \\,^{\\circ}\\mathrm{C}$，$AE = 0.72$，$s = 0.18$ 和 $e = 0.10$。计算常数项 $C = AE \\cdot (1 - e - s) = 0.72 \\cdot (1 - 0.10 - 0.18) = 0.5184$。\n2.  对于摄食数据，将观测值转换为 $x_i = T_{\\mathrm{obs},i} - T_{\\mathrm{ref}}$ 和 $y_i = \\ln(I_{\\mathrm{obs},i})$。\n3.  对 $y_i$ 关于 $x_i$ 进行线性回归，以找到斜率 $\\hat{\\beta}_{1,I}$ 和截距 $\\hat{\\beta}_{0,I}$。\n4.  计算摄食模型参数：$\\hat{I}_{\\mathrm{ref}} = e^{\\hat{\\beta}_{0,I}}$ 和 $\\hat{q}_I = e^{10 \\cdot \\hat{\\beta}_{1,I}}$。\n5.  对呼吸数据 ($T_{\\mathrm{obs}}$, $R_{\\mathrm{obs}}$) 重复步骤 2-4，以找到 $\\hat{R}_{\\mathrm{ref}}$ 和 $\\hat{q}_R$。\n6.  对于测试用例中提供的每个评估温度 $T_j$：\n    a. 预测摄食：$\\hat{I}(T_j) = \\hat{I}_{\\mathrm{ref}} \\cdot \\hat{q}_I^{(T_j - T_{\\mathrm{ref}})/10}$。\n    b. 预测呼吸：$\\hat{R}(T_j) = \\hat{R}_{\\mathrm{ref}} \\cdot \\hat{q}_R^{(T_j - T_{\\mathrm{ref}})/10}$。\n    c. 计算效率：$\\mathrm{GGE}(T_j) = C - \\frac{\\hat{R}(T_j)}{\\hat{I}(T_j)}$。\n    d. 将结果四舍五入到四位小数。\n7.  将所有评估温度下计算出的 GGE 值收集到一个列表中。\n8.  将所有测试用例的列表聚合为一个嵌套列表，并格式化为单行字符串作为最终输出。此过程将使用允许的 Python `numpy` 和 `scipy` 库来实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Solves the bioenergetics problem for all test cases.\n    \"\"\"\n    # Common parameters for all test cases\n    T_ref = 15.0  # degrees Celsius\n    AE = 0.72  # Assimilation efficiency\n    s = 0.18  # Specific dynamic action fraction\n    e = 0.10  # Excretion fraction\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Test Case A (juvenile salmonid-like energetics)\",\n            \"obs_temps\": np.array([5.0, 10.0, 15.0, 20.0, 25.0]),\n            \"obs_ingestion\": np.array([12.7, 18.0, 25.0, 36.0, 48.0]),\n            \"obs_respiration\": np.array([4.6, 6.8, 10.0, 15.2, 22.1]),\n            \"eval_temps\": np.array([5.0, 10.0, 15.0, 20.0, 25.0]),\n        },\n        {\n            \"name\": \"Test Case B (small benthic fish)\",\n            \"obs_temps\": np.array([5.0, 10.0, 15.0, 20.0, 25.0]),\n            \"obs_ingestion\": np.array([6.4, 8.8, 12.0, 16.3, 22.5]),\n            \"obs_respiration\": np.array([2.2, 3.3, 5.0, 7.4, 11.4]),\n            \"eval_temps\": np.array([5.0, 10.0, 15.0, 20.0, 25.0]),\n        },\n        {\n            \"name\": \"Test Case C (cold-adapted fish, sparser data)\",\n            \"obs_temps\": np.array([6.0, 12.0, 18.0, 24.0]),\n            \"obs_ingestion\": np.array([11.2, 12.9, 15.2, 17.6]),\n            \"obs_respiration\": np.array([3.3, 4.9, 7.4, 11.1]),\n            \"eval_temps\": np.array([6.0, 12.0, 18.0, 24.0]),\n        },\n    ]\n\n    all_results = []\n    \n    # Pre-calculate the constant part of the GGE equation\n    gge_constant_term = AE * (1 - e - s)\n\n    for case in test_cases:\n        # --- Model Calibration ---\n        \n        # Prepare data for linear regression\n        # Independent variable x = T - T_ref\n        x_obs = case[\"obs_temps\"] - T_ref\n\n        # Dependent variables y = ln(Rate)\n        y_ingestion = np.log(case[\"obs_ingestion\"])\n        y_respiration = np.log(case[\"obs_respiration\"])\n        \n        # Perform linear regression for Ingestion\n        # y = intercept + slope * x\n        # intercept = beta_0, slope = beta_1\n        slope_I, intercept_I, _, _, _ = stats.linregress(x_obs, y_ingestion)\n        \n        # Perform linear regression for Respiration\n        slope_R, intercept_R, _, _, _ = stats.linregress(x_obs, y_respiration)\n\n        # Calculate Q10 model parameters from regression results\n        # I_ref = exp(beta_0_I), q_I = exp(10 * beta_1_I)\n        I_ref = np.exp(intercept_I)\n        q_I = np.exp(10 * slope_I)\n\n        # R_ref = exp(beta_0_R), q_R = exp(10 * beta_1_R)\n        R_ref = np.exp(intercept_R)\n        q_R = np.exp(10 * slope_R)\n        \n        # --- Prediction ---\n        \n        case_results = []\n        for temp in case[\"eval_temps\"]:\n            # Predict Ingestion and Respiration at the evaluation temperature\n            # using the calibrated Q10 models\n            exponent = (temp - T_ref) / 10.0\n            pred_I = I_ref * (q_I ** exponent)\n            pred_R = R_ref * (q_R ** exponent)\n            \n            # Calculate Gross Growth Efficiency (GGE)\n            # GGE(T) = AE * (1 - e - s) - R(T) / I(T)\n            gge = gge_constant_term - (pred_R / pred_I)\n            \n            # Round to four decimal places\n            case_results.append(round(gge, 4))\n            \n        all_results.append(case_results)\n\n    # --- Final Output Formatting ---\n    # Construct the output string manually to avoid spaces and match the required format.\n    # Example: [[0.1234,0.2345],[0.3456,0.4567]]\n    outer_parts = []\n    for res_list in all_results:\n        inner_str = '[' + ','.join(f\"{val:.4f}\" for val in res_list) + ']'\n        outer_parts.append(inner_str)\n    final_output_string = '[' + ','.join(outer_parts) + ']'\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "2531473"}]}