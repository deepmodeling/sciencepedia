{"hands_on_practices": [{"introduction": "本练习将带您回到经典的 Lotka-Volterra 模型的核心，训练一项关键的分析技能：相平面分析。通过计算和理解捕食者和猎物在共存平衡点处的零增长等倾线（nullclines）的几何特性，我们可以直观地揭示该模型标志性周期性振荡的内在机制。这项实践旨在通过几何视角加深您对动力系统行为的理解 [@problem_id:2524775]。", "problem": "考虑经典的洛特卡-沃尔泰拉（Lotka–Volterra）捕食者-猎物模型，该模型由以下常微分方程组给出\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}t}=\\alpha x-\\beta x y,\\qquad \\frac{\\mathrm{d}y}{\\mathrm{d}t}=\\delta x y-\\gamma y,\n$$\n其中 $x$ 表示猎物密度，$y$ 表示捕食者密度，$\\alpha,\\beta,\\gamma,\\delta$ 为正常数。仅使用猎物和捕食者的零增长等倾线（nullclines 或 zero-growth isoclines）的定义以及平面中关于斜率和角度的标准几何事实，确定在正象限的共存平衡点处，猎物和捕食者零增长等倾线的斜率，并推导出在该点处这两条零增长等倾线之间的夹角。将最终的角度以弧度表示，并作为一个单一的精确值。此外，简要说明这些斜率如何刻画共存平衡点附近相平面中等倾线的局部几何形态。你最终报告的答案必须仅为以弧度表示的角度，以精确形式给出，不进行近似，且在最终的方框内不带单位。", "solution": "所述问题具有科学依据，提法恰当且客观。这是数学生态学中动力系统分析的一个标准练习，因此是有效的。我们开始求解。\n\n该系统由洛特卡-沃尔泰拉方程描述：\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} = f(x, y) = \\alpha x - \\beta x y\n$$\n$$\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} = g(x, y) = \\delta x y - \\gamma y\n$$\n其中 $x$是猎物密度，$y$是捕食者密度，$\\alpha, \\beta, \\gamma, \\delta$ 是正常数。\n\n首先，我们确定零增长等倾线，即相平面上某个种群变化率为零的曲线。\n\n猎物零增长等倾线（或 $x$-零增长等倾线）由条件 $\\frac{\\mathrm{d}x}{\\mathrm{d}t} = 0$ 定义。将第一个方程设为零可得：\n$$\n\\alpha x - \\beta x y = 0 \\implies x(\\alpha - \\beta y) = 0\n$$\n当 $x=0$（$y$轴）或 $\\alpha - \\beta y = 0$ 时，该方程成立，后者可简化为水平线 $y = \\frac{\\alpha}{\\beta}$。\n\n捕食者零增长等倾线（或 $y$-零增长等倾线）由条件 $\\frac{\\mathrm{d}y}{\\mathrm{d}t} = 0$ 定义。将第二个方程设为零可得：\n$$\n\\delta x y - \\gamma y = 0 \\implies y(\\delta x - \\gamma) = 0\n$$\n当 $y=0$（$x$轴）或 $\\delta x - \\gamma = 0$ 时，该方程成立，后者可简化为垂直线 $x = \\frac{\\gamma}{\\delta}$。\n\n系统的平衡点是猎物和捕食者零增长等倾线的交点。问题指明了“正象限中的共存平衡点”，这对应于非平凡零增长等倾线的交点，在该点 $x > 0$ 且 $y > 0$。这个平衡点我们记为 $(x^*, y^*)$，通过求解以下方程组得到：\n$$\ny = \\frac{\\alpha}{\\beta}\n$$\n$$\nx = \\frac{\\gamma}{\\delta}\n$$\n因此，共存平衡点位于 $(x^*, y^*) = \\left(\\frac{\\gamma}{\\delta}, \\frac{\\alpha}{\\beta}\\right)$。由于所有参数都为正，该点确实在第一象限。\n\n现在，我们来确定在该平衡点处零增长等倾线的斜率。\n穿过共存平衡点的猎物零增长等倾线是直线 $y = \\frac{\\alpha}{\\beta}$。这是一条水平线。根据定义，任何水平线的斜率都为零。我们将此斜率记为 $m_{prey}$。\n$$\nm_{prey} = 0\n$$\n穿过共存平衡点的捕食者零增长等倾线是直线 $x = \\frac{\\gamma}{\\delta}$。这是一条垂直线。任何垂直线的斜率都是未定义的（或无穷大）。我们将此斜率记为 $m_{predator}$。\n\n一条水平线和一条垂直线之间的夹角 $\\theta$ 是一个直角。以弧度表示，直角是 $\\frac{\\pi}{2}$。从几何上看，这是不言而喻的。从解析的角度看，如果我们考虑零增长等倾线的切向量，猎物零增长等倾线 $y = \\frac{\\alpha}{\\beta}$ 的切向量为 $\\mathbf{v}_{prey} = (1, 0)$，而捕食者零增长等倾线 $x = \\frac{\\gamma}{\\delta}$ 的切向量为 $\\mathbf{v}_{predator} = (0, 1)$。它们之间的夹角 $\\theta$ 可由点积公式给出：\n$$\n\\cos(\\theta) = \\frac{\\mathbf{v}_{prey} \\cdot \\mathbf{v}_{predator}}{||\\mathbf{v}_{prey}|| \\cdot ||\\mathbf{v}_{predator}||} = \\frac{(1)(0) + (0)(1)}{\\sqrt{1^2+0^2} \\sqrt{0^2+1^2}} = \\frac{0}{1} = 0\n$$\n满足 $\\cos(\\theta)=0$ 的角度 $\\theta \\in [0, \\pi]$ 是 $\\theta = \\frac{\\pi}{2}$。零增长等倾线是正交的。\n\n最后，我们说明这些斜率如何刻画等倾线的局部几何形态。向量场 $(\\frac{\\mathrm{d}x}{\\mathrm{d}t}, \\frac{\\mathrm{d}y}{\\mathrm{d}t})$ 在零增长等倾线上具有特定的方向。\n在猎物零增长等倾线（$y = \\frac{\\alpha}{\\beta}$）上，我们有 $\\frac{\\mathrm{d}x}{\\mathrm{d}t}=0$，所以向量场是纯垂直的：$(0, \\delta x y - \\gamma y)$。流是垂直的。\n在捕食者零增长等倾线（$x = \\frac{\\gamma}{\\delta}$）上，我们有 $\\frac{\\mathrm{d}y}{\\mathrm{d}t}=0$，所以向量场是纯水平的：$(\\alpha x - \\beta x y, 0)$。流是水平的。\n平衡点处零增长等倾线的正交性意味着，解轨道在穿过猎物零增长等倾线时必须具有垂直的切向量，而在穿过捕食者零增长等倾线时必须具有水平的切向量。这种垂直相交迫使流围绕平衡点旋转，这是经典洛特卡-沃尔泰拉模型中中性稳定中心的特征。零增长等倾线这种简单的正交几何结构，是围绕共存平衡点存在封闭周期轨道的根本原因。", "answer": "$$\\boxed{\\frac{\\pi}{2}}$$", "id": "2524775"}, {"introduction": "在经典的 Lotka-Volterra 模型基础上，我们引入了更符合生物学现实的 Rosenzweig-MacArthur 模型，该模型考虑了捕食者的饱和效应。这个练习将引导您探索一个著名且有悖常理的生态学现象——“富集悖论”（paradox of enrichment），即增加猎物的承载能力 $K$ 反而可能导致系统失稳。您将通过严格的数学分析，运用雅可比矩阵和稳定性判据，来推导系统发生霍普夫分岔（Hopf bifurcation）的临界条件，从而亲手揭示极限环是如何从一个稳定的平衡点中产生的 [@problem_id:2524854]。", "problem": "一个资源-消费者系统由带有霍林 II 型功能反应的 Rosenzweig–MacArthur 捕食者-猎物方程建模：\n$$\n\\begin{aligned}\n\\frac{dN}{dt} &= r N \\left(1 - \\frac{N}{K}\\right) - \\frac{a N}{1 + a h N}\\, P,\\\\\n\\frac{dP}{dt} &= e\\,\\frac{a N}{1 + a h N}\\, P - m P,\n\\end{aligned}\n$$\n其中，$N$ 是猎物密度，$P$ 是捕食者密度，$r>0$ 是猎物的内在增长率，$K>0$ 是猎物的环境承载力（富集参数），$a>0$ 是捕食者的攻击率，$h>0$ 是处理时间，$e \\in (0,1]$ 是转换效率，$m>0$ 是捕食者的人均死亡率。假设参数满足 $e>m h$，从而存在唯一的内平衡点。\n\n从平衡点、雅可比线性化、以及二维常微分方程（ODE）线性稳定性和霍普夫分岔的迹-行列式准则的定义出发，完成以下任务：\n- 根据参数确定内平衡点 $(N^{\\ast},P^{\\ast})$。\n- 计算在 $(N^{\\ast},P^{\\ast})$ 处的雅可比矩阵，并将其迹和行列式表示为 $K$ 和其他参数的函数。\n- 证明在 $(N^{\\ast},P^{\\ast})$ 处的行列式为正，并且当 $K$ 变化时，迹会穿过零点，并通过计算在穿越点处的 $\\frac{d}{dK}(\\operatorname{tr} J)$ 来验证非退化（横截性）条件。\n- 推导当 $\\operatorname{tr} J=0$且 $\\det J>0$ 时的精确临界值 $K=K_{\\mathrm{H}}$，这意味着当 $K$ 经过 $K_{\\mathrm{H}}$ 时会发生霍普夫分岔。\n\n将您的最终结果表示为 $K_{\\mathrm{H}}$ 关于 $a$、$h$、$e$ 和 $m$ 的单个、简化的解析表达式。不需要数值近似或四舍五入。仅表达最终的 $K_{\\mathrm{H}}$；不包括单位。", "solution": "所提出的问题是数学生态学中动态系统稳定性分析的一个标准练习。它有科学依据，提法恰当，并包含所有必要信息。因此，这是一个有效的问题，我们开始求解。\n\n该系统由以下常微分方程给出：\n$$\n\\begin{aligned}\n\\frac{dN}{dt} &= r N \\left(1 - \\frac{N}{K}\\right) - \\frac{a N P}{1 + a h N} \\\\\n\\frac{dP}{dt} &= e\\,\\frac{a N P}{1 + a h N} - m P\n\\end{aligned}\n$$\n参数 $r, K, a, h, e, m$ 均为正常数，其中 $e \\in (0, 1]$。问题陈述提供了条件 $e > m h$，这保证了唯一内平衡点的存在。\n\n首先，我们确定内平衡点 $(N^{\\ast}, P^{\\ast})$，其中 $N^{\\ast} > 0$ 且 $P^{\\ast} > 0$。通过将两个时间导数都设为零来找到该平衡点。\n由 $\\frac{dP}{dt} = 0$，我们有：\n$$\nP \\left( e\\,\\frac{a N}{1 + a h N} - m \\right) = 0\n$$\n由于对于内平衡点 $P^{\\ast} \\neq 0$，我们必须有：\n$$\ne\\,\\frac{a N^{\\ast}}{1 + a h N^{\\ast}} - m = 0\n$$\n$$\ne a N^{\\ast} = m(1 + a h N^{\\ast}) = m + m a h N^{\\ast}\n$$\n$$\nN^{\\ast}(e a - m a h) = m\n$$\n$$\nN^{\\ast} = \\frac{m}{a(e - m h)}\n$$\n条件 $e > m h$ 确保了 $e - m h > 0$，并且由于 $a>0$ 和 $m>0$，因此 $N^{\\ast} > 0$。\n\n接下来，由 $\\frac{dN}{dt} = 0$，我们有：\n$$\nN \\left( r \\left(1 - \\frac{N}{K}\\right) - \\frac{a P}{1 + a h N} \\right) = 0\n$$\n对于内平衡点，$N^{\\ast} \\neq 0$，所以我们必须有：\n$$\nr \\left(1 - \\frac{N^{\\ast}}{K}\\right) = \\frac{a P^{\\ast}}{1 + a h N^{\\ast}}\n$$\n我们可以解出 $P^{\\ast}$：\n$$\nP^{\\ast} = \\frac{r(1 + a h N^{\\ast})}{a} \\left(1 - \\frac{N^{\\ast}}{K}\\right)\n$$\n为了使 $P^{\\ast} > 0$，我们需要 $1 - \\frac{N^{\\ast}}{K} > 0$，这意味着条件 $K > N^{\\ast}$。\n\n接下来，我们计算系统的雅可比矩阵 $J$。令 $f(N, P) = \\frac{dN}{dt}$ 和 $g(N, P) = \\frac{dP}{dt}$。\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f}{\\partial N} & \\frac{\\partial f}{\\partial P} \\\\ \\frac{\\partial g}{\\partial N} & \\frac{\\partial g}{\\partial P} \\end{pmatrix}\n$$\n偏导数是：\n$$\n\\frac{\\partial f}{\\partial N} = r - \\frac{2 r N}{K} - \\frac{a(1+ahN)P - aNP(ah)}{(1+ahN)^{2}} = r - \\frac{2 r N}{K} - \\frac{a P}{(1 + a h N)^{2}}\n$$\n$$\n\\frac{\\partial f}{\\partial P} = -\\frac{a N}{1 + a h N}\n$$\n$$\n\\frac{\\partial g}{\\partial N} = \\frac{eaP(1+ahN) - eaNP(ah)}{(1+ahN)^{2}} = \\frac{e a P}{(1 + a h N)^{2}}\n$$\n$$\n\\frac{\\partial g}{\\partial P} = \\frac{e a N}{1 + a h N} - m\n$$\n我们在内平衡点 $(N^{\\ast}, P^{\\ast})$ 处计算雅可比矩阵。我们将此矩阵表示为 $J^{\\ast}$。其元素为 $J_{ij}^{\\ast} = J_{ij}|_{(N^{\\ast}, P^{\\ast})}$。\n根据捕食者的平衡条件，我们立即看到：\n$$\nJ_{22}^{\\ast} = \\frac{e a N^{\\ast}}{1 + a h N^{\\ast}} - m = 0\n$$\n其他元素是：\n$$\nJ_{11}^{\\ast} = r - \\frac{2 r N^{\\ast}}{K} - \\frac{a P^{\\ast}}{(1 + a h N^{\\ast})^{2}}\n$$\n$$\nJ_{12}^{\\ast} = -\\frac{a N^{\\ast}}{1 + a h N^{\\ast}}\n$$\n$$\nJ_{21}^{\\ast} = \\frac{e a P^{\\ast}}{(1 + a h N^{\\ast})^{2}}\n$$\n$J^{\\ast}$ 的迹和行列式由下式给出：\n$$\n\\operatorname{tr} J^{\\ast} = J_{11}^{\\ast} + J_{22}^{\\ast} = J_{11}^{\\ast}\n$$\n$$\n\\det J^{\\ast} = J_{11}^{\\ast} J_{22}^{\\ast} - J_{12}^{\\ast} J_{21}^{\\ast} = 0 - \\left(-\\frac{a N^{\\ast}}{1 + a h N^{\\ast}}\\right)\\left(\\frac{e a P^{\\ast}}{(1 + a h N^{\\ast})^{2}}\\right) = \\frac{a^{2} e N^{\\ast} P^{\\ast}}{(1 + a h N^{\\ast})^{3}}\n$$\n由于 $a, e, N^{\\ast}, P^{\\ast}, h$ 均为正值，显然 $\\det J^{\\ast} > 0$。\n\n当 $\\operatorname{tr} J^{\\ast} = 0$ 且 $\\det J^{\\ast} > 0$ 时，发生霍普夫分岔。我们已经确定行列式为正。现在我们寻找使迹为零的 $K$ 的条件。\n$$\n\\operatorname{tr} J^{\\ast} = r - \\frac{2 r N^{\\ast}}{K} - \\frac{a P^{\\ast}}{(1 + a h N^{\\ast})^{2}} = 0\n$$\n为了简化这个表达式，我们使用猎物的平衡条件 $r(1 - \\frac{N^{\\ast}}{K}) = \\frac{a P^{\\ast}}{1 + a h N^{\\ast}}$。代入此式，我们可以重写 $J_{11}^{\\ast}$：\n$$\nJ_{11}^{\\ast} = \\left(r - \\frac{r N^{\\ast}}{K}\\right) - \\frac{r N^{\\ast}}{K} - \\frac{a P^{\\ast}}{(1 + a h N^{\\ast})^{2}} = r\\left(1 - \\frac{N^{\\ast}}{K}\\right) - \\frac{r N^{\\ast}}{K} - \\frac{a P^{\\ast}}{(1 + a h N^{\\ast})^{2}}\n$$\n$$\nJ_{11}^{\\ast} = \\frac{a P^{\\ast}}{1 + a h N^{\\ast}} - \\frac{r N^{\\ast}}{K} - \\frac{a P^{\\ast}}{(1+ahN^{\\ast})^{2}} = \\frac{a P^{\\ast}(1+ahN^{\\ast}) - aP^{\\ast}}{(1+ahN^{\\ast})^2} - \\frac{rN^{\\ast}}{K} = \\frac{a^{2} h N^{\\ast} P^{\\ast}}{(1+ahN^{\\ast})^{2}} - \\frac{rN^{\\ast}}{K}\n$$\n我们将迹设为零：\n$$\n\\frac{a^{2} h N^{\\ast} P^{\\ast}}{(1+ahN^{\\ast})^{2}} - \\frac{rN^{\\ast}}{K} = 0\n$$\n由于 $N^{\\ast} > 0$，我们可以用它来除：\n$$\n\\frac{a^{2} h P^{\\ast}}{(1+ahN^{\\ast})^{2}} = \\frac{r}{K}\n$$\n代入 $P^{\\ast} = \\frac{r(1 + a h N^{\\ast})}{a} (1 - \\frac{N^{\\ast}}{K})$：\n$$\n\\frac{a^{2} h}{(1+ahN^{\\ast})^{2}} \\frac{r(1 + a h N^{\\ast})}{a} \\left(1 - \\frac{N^{\\ast}}{K}\\right) = \\frac{r}{K}\n$$\n简化并除以 $r$（因为 $r>0$）：\n$$\n\\frac{a h}{1 + a h N^{\\ast}} \\left(1 - \\frac{N^{\\ast}}{K}\\right) = \\frac{1}{K}\n$$\n我们求解 $K$。两边同乘以 $K(1 + a h N^{\\ast})$：\n$$\na h K \\left(1 - \\frac{N^{\\ast}}{K}\\right) = 1 + a h N^{\\ast}\n$$\n$$\na h (K - N^{\\ast}) = 1 + a h N^{\\ast}\n$$\n$$\na h K - a h N^{\\ast} = 1 + a h N^{\\ast}\n$$\n$$\na h K = 1 + 2 a h N^{\\ast}\n$$\n发生分岔的 $K$ 的临界值，我们记作 $K_{\\mathrm{H}}$，是：\n$$\nK_{\\mathrm{H}} = \\frac{1 + 2 a h N^{\\ast}}{a h} = \\frac{1}{ah} + 2N^{\\ast}\n$$\n为了验证非退化（横截性）条件，我们必须检查在 $K = K_{\\mathrm{H}}$ 时 $\\frac{d}{dK}(\\operatorname{tr} J^{\\ast}) \\neq 0$。\n迹是 $\\operatorname{tr} J^{\\ast} = \\frac{r N^{\\ast}}{K(1+ahN^{\\ast})} [ a h K - (1 + 2 a h N^{\\ast}) ]$。关于 $K$ 求导：\n$$\n\\frac{d}{dK}(\\operatorname{tr} J^{\\ast}) = \\frac{r N^{\\ast}}{1+ahN^{\\ast}} \\frac{d}{dK} \\left[ a h - \\frac{1 + 2 a h N^{\\ast}}{K} \\right] = \\frac{r N^{\\ast}}{1+ahN^{\\ast}} \\left( \\frac{1 + 2 a h N^{\\ast}}{K^{2}} \\right)\n$$\n由于所有参数和变量均为正，该导数严格为正。横截性条件得到满足。\n\n最后，我们将 $N^{\\ast} = \\frac{m}{a(e - m h)}$ 的表达式代入 $K_{\\mathrm{H}}$ 的方程中：\n$$\nK_{\\mathrm{H}} = \\frac{1}{ah} + 2 \\left( \\frac{m}{a(e - m h)} \\right)\n$$\n为了简化，我们通分：\n$$\nK_{\\mathrm{H}} = \\frac{e - m h + 2 m h}{a h (e - m h)} = \\frac{e + m h}{a h (e - m h)}\n$$\n这就是系统发生霍普夫分岔时环境承载力的临界值。", "answer": "$$\n\\boxed{\\frac{e+mh}{ah(e-mh)}}\n$$", "id": "2524854"}, {"introduction": "理论生态学的前沿在于理解空间维度如何塑造种群动态。本练习将带领您从非空间模型迈向空间生态学，通过编写一个完整的数值实验来模拟反应-扩散（reaction-diffusion）捕食-猎物系统。您将实现一个包含猎物自我限制和捕食者饱腹效应的模型，并在二维网格上观察不同扩散率组合如何催生或抑制复杂的空间格局（如斑点和条纹）的出现，这是探索生态系统自组织涌现特性的重要实践 [@problem_id:2524831]。", "problem": "您被要求设计并实现一个完整且可复现的数值实验，用于模拟在二维离散网格上、在无通量（诺伊曼）边界条件下，由扩散驱动的双物种捕食者-猎物动力学。生态动力学必须是遵循 Lotka-Volterra 框架精神的捕食者-猎物模型，但需加入猎物自我限制和捕食者饱和效应，以确保存在一个生物学上合理的、全局稳定的均匀平衡态。该平衡态在合适的扩散对比度下，可以展现出扩散驱动的斑图形成。\n\n起始点（基本基础）：\n- 种群密度是空间和时间的函数，猎物密度表示为 $u(x,y,t)$，捕食者密度表示为 $v(x,y,t)$。\n- 局部动力学由猎物内在增长和捕食者-猎物相互作用所控制，空间运动由菲克扩散描述，其中通量与梯度成正比。无通量边界要求边界上的法向导数为零。\n- 空间离散化采用均匀笛卡尔网格和中心差分法来计算二阶导数，时间离散化采用一阶方法前向欧拉法。\n\n待模拟模型：\n- 设局部动力学为猎物逻辑斯谛增长和捕食的 Holling II型功能反应（Rosenzweig–MacArthur 形式）：\n  - 猎物：$u$ 以内在增长率 $r$ 和环境承载量 $K$ 进行逻辑斯谛增长，并以一个随猎物密度饱和的速率被消耗。\n  - 捕食者：$v$ 通过将消耗的猎物以效率 $e$ 转化为捕食者生物量而增加，其死亡率为 $m$。\n- 加入空间扩散，猎物扩散系数为 $D_u$，捕食者扩散系数为 $D_v$，使得空间扩展的动力学满足\n  $$\n  \\frac{\\partial u}{\\partial t} = D_u \\nabla^2 u + f(u,v), \\quad \\frac{\\partial v}{\\partial t} = D_v \\nabla^2 v + g(u,v),\n  $$\n  其中 $f(u,v)$ 和 $g(u,v)$ 是由 Rosenzweig–MacArthur 相互作用定义的局部动力学。\n\n需实现的科学细节：\n1. 设局部动力学为\n   - $f(u,v) = r u \\left(1 - \\frac{u}{K}\\right) - \\frac{a u}{1 + h a u} v$,\n   - $g(u,v) = e \\frac{a u}{1 + h a u} v - m v$,\n   参数固定如下：\n   - $r = 1.0$,\n   - $K = 1.0$,\n   - $a = 2.0$,\n   - $h = 0.5$,\n   - $e = 0.6$,\n   - $m = 0.4$.\n2. 计算由局部动力学所蕴含的唯一正值均匀平衡态 $(u^\\ast,v^\\ast)$（即求解 $f(u^\\ast,v^\\ast) = 0$ 和 $g(u^\\ast,v^\\ast) = 0$，其中 $u^\\ast > 0, v^\\ast > 0$），并在该平衡态附近使用一个微小的、具有空间结构的扰动来初始化空间场：\n   $$\n   u_{i,j}(0) = u^\\ast \\left[1 + \\epsilon \\cos\\left(\\frac{2\\pi i}{N}\\right) \\cos\\left(\\frac{2\\pi j}{N}\\right)\\right], \\quad\n   v_{i,j}(0) = v^\\ast \\left[1 + \\epsilon \\cos\\left(\\frac{2\\pi i}{N}\\right) \\cos\\left(\\frac{2\\pi j}{N}\\right)\\right],\n   $$\n   其中 $i,j$ 为整数网格索引，角度以弧度为单位，$\\epsilon = 0.01$ 是扰动幅度。\n3. 使用大小为 $N \\times N$（其中 $N = 64$）的二维方形网格，空间步长 $dx = 1$（任意长度单位），显式前向欧拉时间步长 $dt = 0.01$（任意时间单位），模拟直至最终时间 $T = 10$（即恰好 $T/dt = 1000$ 个时间步）。\n4. 通过与中心差分五点拉普拉斯算子一致的离散格式来强制执行无通量边界条件（法向导数为零）。通过将阵列嵌入到一个由各边界反射构造的幽灵节点层中来实现离散拉普拉斯算子（即幽灵节点的值等于第一个内部节点的值，从而在边界上强制一阶导数为零），然后应用标准的五点模板；等效地，用一个单元的镜像反射来填充（pad）场，并使用其四个最近邻之和减去中心点值的 4 倍来近似内部点的 $dx^2 \\nabla^2$。\n5. 在每一步更新后，通过将 $u$ 和 $v$ 的下界限定为 0 来确保数值非负性（以避免因数值误差导致的负密度），而不以其他方式改变动力学。\n\n定量斑图度量：\n- 为了量化空间结构的出现和持续性，请在最终时刻使用 II 型离散余弦变换（DCT）计算最强非零空间模式相对于均匀模式的主导性。II 型 DCT 在诺伊曼（无通量）边界条件下是一种自然的选择：\n  1. 令 $\\mathcal{C}[u]$ 表示在 $t = T$ 时刻对猎物场 $u$ 进行的正交归一化的二维 II 型 DCT。\n  2. 令 $P_{k,\\ell} = \\left(\\mathcal{C}[u]_{k,\\ell}\\right)^2$ 为模式 $(k,\\ell)$ 的功率。\n  3. 定义谱主导指数\n     $$\n     S = \\frac{\\max\\{ P_{k,\\ell} : (k,\\ell) \\neq (0,0) \\}}{P_{0,0}}.\n     $$\n  指数 $S$ 是一个非负实数；较大的值表示（相对于空间平均值）更强的空间结构。\n\n测试套件：\n- 对扩散系数 $(D_u,D_v)$ 使用以下三组参数，同时保持所有其他参数和数值设置如上所述：\n  1. 情况 A（捕食者扩散更快）： $(D_u,D_v) = (0.01, 0.50)$。\n  2. 情况 B（扩散速率相等）： $(D_u,D_v) = (0.10, 0.10)$。\n  3. 情况 C（猎物扩散更快）： $(D_u,D_v) = (0.20, 0.01)$。\n  \n对于每种情况，运行模拟并计算最终时间 $T$ 时猎物的谱主导指数 $S$。要求的程序输出为单行文本，包含一个由三个浮点数组成的列表，按顺序对应 $(S_{\\text{A}}, S_{\\text{B}}, S_{\\text{C}})$，每个数字四舍五入到恰好 6 位小数。该行必须格式化为无空格、逗号分隔的类 Python 列表，例如，“[0.123456,0.234567,0.345678]”。\n\n您的程序必须是完全自包含的，不接收任何输入，并严格按照指定格式产生一行输出。所有三角函数表达式中的角度必须解释为弧度。最终的数值答案不需要物理单位，因为所提出的模型是无量纲的。", "solution": "我们使用基于菲克扩散定律和标准捕食者-猎物动力学的反应扩散框架来模拟空间捕食者-猎物系统，该动力学扩展了 Lotka-Volterra 相互作用，包含了猎物自我限制和捕食者饱和。设 $u(x,y,t)$ 为猎物密度，$v(x,y,t)$ 为捕食者密度。\n\n1. 从第一性原理构建模型：\n   - 菲克扩散假定扩散通量 $\\mathbf{J}$ 与密度的负梯度成正比，即 $\\mathbf{J}_u = - D_u \\nabla u$ 和 $\\mathbf{J}_v = - D_v \\nabla v$，其中 $D_u$ 和 $D_v$ 是常数扩散系数。质量守恒意味着 $\\partial u/\\partial t = -\\nabla \\cdot \\mathbf{J}_u + f(u,v)$ 和 $\\partial v/\\partial t = -\\nabla \\cdot \\mathbf{J}_v + g(u,v)$，从而得到反应扩散方程\n     $$\n     \\frac{\\partial u}{\\partial t} = D_u \\nabla^2 u + f(u,v), \\quad \\frac{\\partial v}{\\partial t} = D_v \\nabla^2 v + g(u,v).\n     $$\n   - Rosenzweig–MacArthur 捕食者-猎物动力学给出\n     $$\n     f(u,v) = r u \\left(1 - \\frac{u}{K}\\right) - \\frac{a u}{1 + h a u} v,\\quad\n     g(u,v) = e \\frac{a u}{1 + h a u} v - m v,\n     $$\n     其中 $r$ 是猎物内在增长率，$K$ 是环境承载量，$a$ 是攻击率，$h$ 是处理时间，$e$ 是转化效率，$m$ 是捕食者死亡率。\n\n2. 均匀平衡态：\n   - 在空间均匀的稳态 $(u^\\ast,v^\\ast)$ 下，我们有 $f(u^\\ast,v^\\ast) = 0$ 和 $g(u^\\ast,v^\\ast) = 0$。对于 $v^\\ast > 0$，捕食者方程简化为\n     $$\n     e \\frac{a u^\\ast}{1 + h a u^\\ast} = m.\n     $$\n     解出 $u^\\ast$ 可得\n     $$\n     u^\\ast = \\frac{m}{a(e - m h)},\n     $$\n     条件是 $e - m h > 0$。已知 $u^\\ast$ 后，可从猎物方程得到 $v^\\ast$。将 $f(u^\\ast,v^\\ast) = 0$ 两边同除以 $u^\\ast > 0$ 可得\n     $$\n     r \\left(1 - \\frac{u^\\ast}{K}\\right) = \\frac{a}{1 + h a u^\\ast} v^\\ast \\quad \\Rightarrow \\quad\n     v^\\ast = \\frac{r \\left(1 - \\frac{u^\\ast}{K}\\right) \\left(1 + h a u^\\ast\\right)}{a}.\n     $$\n   - 使用参数 $r = 1.0$，$K = 1.0$，$a = 2.0$，$h = 0.5$，$e = 0.6$，$m = 0.4$，我们得到 $e - m h = 0.6 - 0.4 \\cdot 0.5 = 0.4 > 0$，因此\n     $$\n     u^\\ast = \\frac{0.4}{2.0 \\cdot 0.4} = 0.5, \\quad\n     v^\\ast = \\frac{1.0 \\cdot \\left(1 - 0.5\\right) \\cdot \\left(1 + 0.5 \\cdot 2.0 \\cdot 0.5\\right)}{2.0} = \\frac{0.5 \\cdot 1.5}{2.0} = 0.375.\n     $$\n\n3. 边界条件与空间离散化：\n   - 无通量（诺伊曼）边界条件规定法向导数在边界处为零：$\\partial u/\\partial n = 0$ 和 $\\partial v/\\partial n = 0$。在间距为 $dx$ 的均匀网格上的有限差分框架下，标准的五点模板通过以下公式近似内部网格点 $(i,j)$ 处的拉普拉斯算子：\n     $$\n     \\left(\\nabla^2 w\\right)_{i,j} \\approx \\frac{w_{i+1,j} + w_{i-1,j} + w_{i,j+1} + w_{i,j-1} - 4 w_{i,j}}{dx^2}.\n     $$\n   - 诺伊曼条件通过构造跨越每个边界的镜像反射的幽灵节点来强制执行。对于 $i=0$ 处的左边界，将 $i=-1$ 处的幽灵值设为 $w_{1,j}$，以强制实施产生边界处一阶导数为零的离散对称性。这同样适用于所有边界。等效地，可以用关于边界反射的值在所有方向上将数组填充一个单元，并对未填充的内部应用五点模板；这将产生一个与法向导数为零一致的离散拉普拉斯算子。\n\n4. 时间积分与稳定性考虑：\n   - 我们使用时间步长为 $dt$ 的前向欧拉法。每个时间步的离散更新为\n     $$\n     u^{n+1} = u^n + dt \\left( D_u \\nabla^2 u^n + f(u^n, v^n) \\right), \\quad\n     v^{n+1} = v^n + dt \\left( D_v \\nabla^2 v^n + g(u^n, v^n) \\right).\n     $$\n     在我们的测试套件中，$dx = 1$ 且最大扩散系数 $D_{\\max} \\leq 0.50$，显式扩散稳定性约束 $dt \\lesssim \\frac{dx^2}{4 D_{\\max}}$ 表明 $dt \\leq 0.5$。选择 $dt = 0.01$ 是保守且稳定的。反应项可能会施加额外的约束；所选的参数和步长都足够小以保持稳定性。我们还在每次更新后强制执行 $u \\geq 0$ 和 $v \\geq 0$ 以保持生物学非负性。\n\n5. 初始化：\n   - 我们在 $(u^\\ast,v^\\ast)$ 附近用一个幅度为 $\\epsilon = 0.01$ 的微小空间扰动和一个单一余弦模式进行初始化：\n     $$\n     u_{i,j}(0) = u^\\ast \\left[1 + \\epsilon \\cos\\left(\\frac{2\\pi i}{N}\\right) \\cos\\left(\\frac{2\\pi j}{N}\\right)\\right], \\quad\n     v_{i,j}(0) = v^\\ast \\left[1 + \\epsilon \\cos\\left(\\frac{2\\pi i}{N}\\right) \\cos\\left(\\frac{2\\pi j}{N}\\right)\\right],\n     $$\n     其中 $i,j \\in \\{0,1,\\dots,N-1\\}$，角度以弧度为单位，$N = 64$，$dx = 1$。\n\n6. 使用离散余弦变换进行斑图量化：\n   - 在诺伊曼边界条件下，自然的正交基由余弦模式组成。因此，我们在最终时间 $T$ 计算带有正交归一化的二维 II 型离散余弦变换 $\\mathcal{C}[u]$。模式 $(k,\\ell)$ 的功率为 $P_{k,\\ell} = \\left(\\mathcal{C}[u]_{k,\\ell}\\right)^2$。谱主导指数为\n     $$\n     S = \\frac{\\max\\{ P_{k,\\ell} : (k,\\ell) \\neq (0,0) \\}}{P_{0,0}}.\n     $$\n     此处，$P_{0,0}$ 对应于平均（均匀）模式的平方，而分子则选出最强的空间异质性。较大的 $S$ 值表示相对于平均值更强的空间斑图化。\n\n7. 相对扩散速率的影响：\n   - 情况 A 中 $(D_u,D_v) = (0.01, 0.50)$，使得捕食者扩散远快于猎物，从而形成经典的短程激活（猎物）和长程抑制（捕食者）结构。即使没有严格的图灵不稳定性，与猎物扩散更强的情况相比，这种设置也倾向于保持或放大猎物的非均匀性，从而产生较大的 $S$ 值。\n   - 情况 B 中 $(D_u,D_v) = (0.10, 0.10)$，两种物种以相同速率扩散，倾向于均匀地平滑扰动，从而产生中等或较低的 $S$ 值。\n   - 情况 C 中 $(D_u,D_v) = (0.20, 0.01)$，猎物扩散快于捕食者，这会迅速使猎物均匀化并抑制空间变异，从而导致三种情况中最小的 $S$ 值。\n\n8. 算法：\n   - 预计算 $(u^\\ast,v^\\ast)$。\n   - 使用指定的余弦扰动初始化 $u$ 和 $v$。\n   - 对于 $n = 1$ 到 $T/dt$：\n     - 使用单细胞镜像填充和五点模板计算 $\\nabla^2 u$ 和 $\\nabla^2 v$。\n     - 使用前向欧拉法更新 $u$ 和 $v$。\n     - 通过在零点截断来强制 $u \\geq 0$ 和 $v \\geq 0$。\n   - 根据 $t = T$ 时的 $u$ 的 DCT-II 计算 $S$。\n   - 对三种扩散情况重复以上步骤，并返回三个 $S$ 值。\n\n9. 输出规格：\n   - 最终输出必须是单行文本：一个包含三个值 $[S_{\\text{A}},S_{\\text{B}},S_{\\text{C}}]$ 的类 Python 列表，每个值四舍五入到恰好 6 位小数，且无空格。\n\n该设计将数值方法与潜在的生态学和物理学原理联系起来，并提供了一个具体、可测试的度量，用于捕捉相对扩散速率的差异如何调节由具有生物学现实修正的 Lotka-Volterra 型相互作用所控制的捕食者-猎物系统中空间斑图的出现和持续。", "answer": "```python\nimport numpy as np\nfrom scipy.fft import dctn\n\ndef laplacian_neumann(u):\n    \"\"\"\n    Compute 2D Laplacian with Neumann (no-flux) boundary conditions\n    using one-cell mirror reflection padding and a five-point stencil.\n    \"\"\"\n    up = np.pad(u, pad_width=1, mode='reflect')\n    lap = (\n        up[1:-1, 0:-2] + up[1:-1, 2:] + up[0:-2, 1:-1] + up[2:, 1:-1]\n        - 4.0 * up[1:-1, 1:-1]\n    )\n    return lap  # since dx=1, no need to divide by dx^2\n\ndef kinetics(u, v, params):\n    \"\"\"\n    Rosenzweig–MacArthur kinetics:\n    f(u,v) = r u (1 - u/K) - (a u / (1 + h a u)) v\n    g(u,v) = e (a u / (1 + h a u)) v - m v\n    \"\"\"\n    r, K, a, h, e, m = params\n    hu = 1.0 + h * a * u\n    pred_rate = (a * u) / hu\n    f = r * u * (1.0 - u / K) - pred_rate * v\n    g = e * pred_rate * v - m * v\n    return f, g\n\ndef equilibrium(params):\n    \"\"\"\n    Compute the positive homogeneous equilibrium (u*, v*) under\n    Rosenzweig–MacArthur kinetics. Requires e - m h > 0.\n    From e * (a u)/(1 + h a u) = m -> u* = m / [a (e - m h)]\n    Then v* from r (1 - u*/K) = (a/(1 + h a u*)) v*\n    \"\"\"\n    r, K, a, h, e, m = params\n    denom = a * (e - m * h)\n    if denom <= 0:\n        raise ValueError(\"No positive equilibrium: e - m h must be > 0.\")\n    u_star = m / denom\n    v_star = r * (1.0 - u_star / K) * (1.0 + h * a * u_star) / a\n    if u_star <= 0 or v_star <= 0:\n        raise ValueError(\"Nonpositive equilibrium; check parameters.\")\n    return u_star, v_star\n\ndef simulate_and_pattern_strength(Du, Dv, params, N=64, dx=1.0, dt=0.01, T=10.0, eps=0.01, seed=0):\n    \"\"\"\n    Simulate the reaction–diffusion system with given diffusion coefficients\n    and compute the spectral dominance index S of prey at final time.\n    \"\"\"\n    steps = int(round(T / dt))\n    u_star, v_star = equilibrium(params)\n\n    # Initialize with cosine perturbation (angles in radians)\n    i = np.arange(N)\n    j = np.arange(N)\n    ii, jj = np.meshgrid(i, j, indexing='ij')\n    cos_mode = np.cos(2.0 * np.pi * ii / N) * np.cos(2.0 * np.pi * jj / N)\n    u = u_star * (1.0 + eps * cos_mode)\n    v = v_star * (1.0 + eps * cos_mode)\n\n    # Time stepping\n    for _ in range(steps):\n        lap_u = laplacian_neumann(u)\n        lap_v = laplacian_neumann(v)\n        f, g = kinetics(u, v, params)\n        u = u + dt * (Du * lap_u + f)\n        v = v + dt * (Dv * lap_v + g)\n        # Enforce non-negativity to avoid numerical undershoot\n        np.maximum(u, 0.0, out=u)\n        np.maximum(v, 0.0, out=v)\n\n    # Compute spectral dominance index S using DCT-II with orthonormalization\n    Cu = dctn(u, type=2, norm='ortho')\n    power = Cu ** 2\n    P00 = power[0, 0]\n    # Max over nonzero modes\n    # Flatten all, set (0,0) to -inf to exclude, then take max\n    power_nonzero = power.copy()\n    power_nonzero[0, 0] = -np.inf\n    Pmax = np.max(power_nonzero)\n    S = float(Pmax / P00) if P00 > 0 else 0.0\n    return S\n\ndef solve():\n    # Fixed kinetic parameters: r, K, a, h, e, m\n    params = (1.0, 1.0, 2.0, 0.5, 0.6, 0.4)\n\n    # Test suite of diffusion parameters: (Du, Dv)\n    test_cases = [\n        (0.01, 0.50),  # Case A: predator diffuses faster\n        (0.10, 0.10),  # Case B: equal diffusion\n        (0.20, 0.01),  # Case C: prey diffuses faster\n    ]\n\n    results = []\n    for Du, Dv in test_cases:\n        S = simulate_and_pattern_strength(Du, Dv, params, N=64, dx=1.0, dt=0.01, T=10.0, eps=0.01)\n        # Round to 6 decimals in final print; keep full precision internally\n        results.append(S)\n\n    # Final print statement in the exact required format: no spaces, 6 decimals\n    print(\"[\" + \",\".join(f\"{x:.6f}\" for x in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2524831"}]}