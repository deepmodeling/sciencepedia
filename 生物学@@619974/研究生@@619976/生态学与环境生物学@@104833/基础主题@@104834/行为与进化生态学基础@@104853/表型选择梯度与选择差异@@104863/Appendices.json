{"hands_on_practices": [{"introduction": "在量化表型选择时，首要步骤是计算选择差异（selection differential, $S$），它衡量了选择事件前后种群平均表型的变化。然而，原始的 $S$ 值会受性状单位和变异性的影响，难以在不同性状或研究间直接比较。为了解决这个问题，演化生物学家将其标准化，得到了无量纲的选择强度（selection intensity, $i$）。这个练习将指导你完成这一基本但至关重要的数据转换，让你能够以标准化的方式评估选择的强弱。[@problem_id:2519775]", "problem": "一位植物生态学家在一个大型、随机交配的异交草本植物种群中，测量了一个以毫米为单位的数量形态性状 $z$（例如，叶柄长度）。由于季节性干旱，该种群在发芽和开花之间经历了生存力选择。设选择前世代中该性状的表型方差为 $\\text{Var}(z)$，选择差 $S$ 为存活至开花的个体的平均表型与选择前世代的平均表型之差，两者均以相同的毫米尺度测量。\n\n仅使用以下基本事实：\n- 选择差 $S$ 是在所考虑的选择事件中由选择引起的种群平均表型的变化，以与 $z$ 相同的单位在原始性状尺度上测量。\n- 在此背景下，标准化效应量是通过将平均值偏移以表型标准差为单位来表示而获得的，即，将原始尺度的平均值差异除以表型标准差 $\\sigma_{z}$，其中 $\\sigma_{z}$ 是表型方差的正平方根。\n\n假设对于该性状，表型方差为 $\\text{Var}(z)=9$ (mm^2)，并且在该生存力选择事件中，观测到的选择差为 $S=0.3$ mm。\n\n计算标准化选择差（选择强度），其定义为由选择引起的、以 $z$ 的表型标准差为单位表示的平均值偏移。请以纯数字形式提供您的数值答案，不带单位。您无需四舍五入，因为可以得到精确值。此外，请用文字简要说明该值对选择强度的含义；但是，在您最终报告的答案中，只包含数值，不带任何文字或单位。", "solution": "该问题要求计算标准化选择差，这是衡量选择强度的一个指标。该量通常被称为选择强度，用符号 $i$ 表示。\n\n首先，我们必须验证问题陈述。\n已知条件如下：\n1. 数量性状 $z$ 以毫米（mm）为单位测量。\n2. 选择前世代中该性状的表型方差为 $\\text{Var}(z) = 9 \\text{ mm}^2$。\n3. 选择差为 $S = 0.3 \\text{ mm}$。\n4. 选择差 $S$ 定义为由选择引起的种群平均表型的变化。\n5. 标准化效应量通过将原始尺度的平均值差异除以表型标准差 $\\sigma_z$ 获得。\n6. 表型标准差 $\\sigma_z$ 是表型方差 $\\text{Var}(z)$ 的正平方根。\n7. 任务是计算标准化选择差，它被明确定义为由选择引起的、以 $z$ 的表型标准差为单位表示的平均值偏移。\n\n该问题在科学上是合理的，因为它是数量进化遗传学基本原理的直接应用，特别是测量自然选择的框架。表型方差、选择差和选择强度的概念是该领域的核心。问题提法得当，为获得唯一解提供了所有必要的定义和数值。所提供的值在生物学上是合理的。因此，问题是有效的，我们可以继续求解。\n\n标准化选择差，即选择强度 $i$，定义为选择差 $S$ 除以性状的表型标准差 $\\sigma_z$。这可以写成以下方程：\n$$i = \\frac{S}{\\sigma_z}$$\n该公式将平均表型的变化重新标度为一个无量纲量，以标准差为单位表示该变化。\n\n我们已知选择差 $S = 0.3 \\text{ mm}$。\n我们已知表型方差 $\\text{Var}(z) = 9 \\text{ mm}^2$。\n\n表型标准差 $\\sigma_z$ 是表型方差的平方根：\n$$\\sigma_z = \\sqrt{\\text{Var}(z)}$$\n代入已知的方差值：\n$$\\sigma_z = \\sqrt{9 \\text{ mm}^2} = 3 \\text{ mm}$$\n\n现在，我们可以通过将 $S$ 和 $\\sigma_z$ 的值代入其定义来计算选择强度 $i$：\n$$i = \\frac{S}{\\sigma_z} = \\frac{0.3 \\text{ mm}}{3 \\text{ mm}}$$\n分子和分母中的毫米（mm）单位相互抵消，这对于一个标准化度量是符合预期的。\n$$i = \\frac{0.3}{3} = 0.1$$\n计算出的标准化选择差的值为 $0.1$。\n\n就其生物学意义而言，$i = 0.1$ 的值表示在选择事件（干旱）中存活下来的个体的平均表型，比选择发生前整个种群的平均表型大十分之一个表型标准差。这种强度的选择通常被认为是弱选择，但其在许多代中的累积效应可能是显著的。正号表示选择偏好性状 $z$ 的较大值。", "answer": "$$\\boxed{0.1}$$", "id": "2519775"}, {"introduction": "选择差异 $S$ 描述了选择的结果，但更深层次的问题是，这种变化是如何由性状与个体适合度（fitness）之间的关系驱动的。本练习将引导你推导并应用一个核心的演化定量遗传学恒等式，该恒等式揭示了选择差异 $S$ 与性状和绝对适合度 $W$ 之间的协方差的直接关系。通过比较不同背景下的种群，你将亲自发现，即使性状与适合度的底层关联（协方差）保持不变，种群整体的繁殖成功率（平均绝对适合度 $\\bar{W}$）也会调节选择差异的大小，这突显了衡量选择时考虑生态背景的重要性。[@problem_id:2519754]", "problem": "一项野外研究记录了一个野生种群同代群中每个个体的生态性状（用 $z$ 表示）和绝对适应度（用 $W$ 表示）。相对适应度定义为 $w = W / \\bar{W}$，其中 $\\bar{W}$ 是该同代群的平均绝对适应度。表型选择差 $S$ 定义为对下一代有贡献的个体的平均表型与初始平均表型之差，两者均在任何进化响应发生之前测量。假设繁殖贡献与 $W$ 成正比。\n\n同代群 A 的平均绝对适应度为 $\\bar{W} = 1.5$，绝对适应度与该性状的样本协方差为 $\\operatorname{Cov}(W, z) = 0.3$。\n\n1. 仅从上述定义以及期望和协方差的基本性质出发，推导一个用 $\\bar{W}$ 和 $\\operatorname{Cov}(W, z)$ 表示 $S$ 的表达式，且不引入关于 $W$ 和 $z$ 联合分布的任何额外假设。\n2. 使用你推导的表达式计算同代群 A 的 $S$。\n3. 考虑同代群 B，其 $\\bar{W} = 2.0$ 且具有相同的 $\\operatorname{Cov}(W, z) = 0.3$。计算同代群 B 的 $S$。\n4. 通过给出比率 $S_{\\text{A}} / S_{\\text{B}}$，报告一个单一数值，该数值总结了相同的原始协方差如何在具有不同 $\\bar{W}$ 的同代群中产生不同的 $S$。将你的答案四舍五入到四位有效数字。无需单位。", "solution": "该问题陈述已被验证为具有科学依据、自洽且可通过算法求解。它基于数量进化生态学中的标准定义和原理。所有必要数据均已提供，不存在矛盾。我们将进行形式推导和后续计算。\n\n该问题要求推导表型选择差 $S$ 并为两个不同的同代群进行计算。\n\n1. $S$ 表达式的推导。\n\n表型选择差 $S$ 定义为在单代内，选择前到选择后平均表型的变化。设 $\\bar{z}$ 表示整个初始同代群的平均表型，$\\bar{z}'$ 表示将对下一代做出贡献的被选择个体的平均表型。因此定义为：\n$$S = \\bar{z}' - \\bar{z}$$\n\n为了求得 $\\bar{z}'$，我们必须计算由每个个体的繁殖贡献加权的平均表型。问题陈述，个体的繁殖贡献与其绝对适应度 $W$ 成正比。因此，被选择群体的平均表型 $\\bar{z}'$ 是性状 $z$ 的期望值，其中每个个体都按其适应度 $W$ 进行加权。用基于初始种群分布的期望来表示，即：\n$$\\bar{z}' = \\frac{E[Wz]}{E[W]}$$\n\n分母 $E[W]$ 就是同代群的平均绝对适应度 $\\bar{W}$。分子 $E[Wz]$ 是两个随机变量 $W$ 和 $z$ 乘积的期望。我们可以使用协方差的定义来表示它：\n$$\\operatorname{Cov}(W, z) = E[Wz] - E[W]E[z]$$\n\n整理这个恒等式以求解 $E[Wz]$，得到：\n$$E[Wz] = \\operatorname{Cov}(W, z) + E[W]E[z]$$\n\n代入已知量 $E[W] = \\bar{W}$ 和 $E[z] = \\bar{z}$，我们得到：\n$$E[Wz] = \\operatorname{Cov}(W, z) + \\bar{W}\\bar{z}$$\n\n现在，我们将这个表达式代回 $\\bar{z}'$ 的公式中：\n$$\\bar{z}' = \\frac{\\operatorname{Cov}(W, z) + \\bar{W}\\bar{z}}{\\bar{W}}$$\n\n这可以拆分为两项：\n$$\\bar{z}' = \\frac{\\operatorname{Cov}(W, z)}{\\bar{W}} + \\frac{\\bar{W}\\bar{z}}{\\bar{W}} = \\frac{\\operatorname{Cov}(W, z)}{\\bar{W}} + \\bar{z}$$\n\n最后，我们将此结果代入选择差 $S$ 的定义中：\n$$S = \\bar{z}' - \\bar{z} = \\left( \\frac{\\operatorname{Cov}(W, z)}{\\bar{W}} + \\bar{z} \\right) - \\bar{z}$$\n$$S = \\frac{\\operatorname{Cov}(W, z)}{\\bar{W}}$$\n这就是所要求的表达式。它将一代内的选择响应（$S$）与性状和绝对适应度之间的协方差联系起来，并由平均绝对适应度进行归一化。这个结果是选择理论的基石之一，有时被称为 Robertson-Price 恒等式。\n\n2. 计算同代群 A 的 $S$。\n\n对于同代群 A，给定参数为 $\\bar{W}_{\\text{A}} = 1.5$ 和 $\\operatorname{Cov}(W, z)_{\\text{A}} = 0.3$。使用推导出的公式：\n$$S_{\\text{A}} = \\frac{\\operatorname{Cov}(W, z)_{\\text{A}}}{\\bar{W}_{\\text{A}}} = \\frac{0.3}{1.5} = \\frac{1}{5} = 0.2$$\n\n3. 计算同代群 B 的 $S$。\n\n对于同代群 B，给定参数为 $\\bar{W}_{\\text{B}} = 2.0$ 和 $\\operatorname{Cov}(W, z)_{\\text{B}} = 0.3$。使用推导出的公式：\n$$S_{\\text{B}} = \\frac{\\operatorname{Cov}(W, z)_{\\text{B}}}{\\bar{W}_{\\text{B}}} = \\frac{0.3}{2.0} = 0.15$$\n这表明，对于一个固定的性状与适应度之间的协方差，平均适应度较高的种群其选择差较小。\n\n4. 计算比率 $S_{\\text{A}} / S_{\\text{B}}$。\n\n我们被要求计算两个同代群的选择差之比。\n$$\\frac{S_{\\text{A}}}{S_{\\text{B}}} = \\frac{0.2}{0.15} = \\frac{20}{15} = \\frac{4}{3}$$\n\n问题要求一个四舍五入到四位有效数字的数值答案。\n$$\\frac{4}{3} = 1.3333...$$\n四舍五入到四位有效数字得到 $1.333$。", "answer": "$$\\boxed{1.333}$$", "id": "2519754"}, {"introduction": "在自然界中，生物体的性状很少孤立存在，它们常常相互关联。这就带来了一个关键挑战：一个性状的均值发生变化，是因为它本身受到了直接选择，还是因为它与另一个受选择的性状相关联（间接选择）？为了区分这两种情况，我们需要从选择差异 $\\mathbf{S}$ 升级到选择梯度 $\\boldsymbol{\\beta}$。本练习将带你进入多变量选择分析的核心，运用 Lande 和 Arnold 的经典框架，通过矩阵代数从观测到的总选择（$\\mathbf{S}$）和性状的方差-协方差矩阵（$\\mathbf{P}$）中，计算出衡量直接选择压力的选择梯度向量 $\\boldsymbol{\\beta}$。[@problem_id:2519772]", "problem": "一项对某野生植物的野外研究，量化了两个在选择前收集的定量表型，表示为一个以性状单位度量的均值中心化性状向量 $\\mathbf{z}=(z_{1},z_{2})^{\\top}$，并测量了经过生存选择后的相对适合度 $w$（均值为1）。选择前性状的表型方差-协方差矩阵估计为\n$$\n\\mathbf{P}=\\begin{pmatrix}4 & 1 \\\\ 1 & 9\\end{pmatrix},\n$$\n选择差向量（被选择个体的平均表型与初始均值之差）估计为\n$$\n\\mathbf{S}=\\begin{pmatrix}0.2 \\\\ -0.3\\end{pmatrix},\n$$\n两者均以性状单位度量。假设适合度可由表型的线性函数进行局部近似，并且对于相对适合度对表型的线性回归，普通最小二乘法正交性条件成立，同时选择是弱选择，以致高阶项可以忽略。\n\n从(i)每个性状的选择差定义为选择引起的其均值变化，(ii)当适合度为相对度量时，选择差向量等于性状与相对适合度之间协方差的恒等式，以及(iii)相对适合度对表型的线性回归出发，推导出连接选择差向量、表型方差-协方差矩阵和定向选择梯度向量之间的线性代数关系。然后利用此关系计算该系统的定向选择梯度向量 $\\boldsymbol{\\beta}$。最后，在保持另一性状不变的情况下，用对其相应性状的直接选择来解释 $\\boldsymbol{\\beta}$ 的每个分量。\n\n将 $\\boldsymbol{\\beta}$ 的两个分量表示为精确值。以单个行向量的形式报告你的最终数值答案。关于单位，将 $\\boldsymbol{\\beta}$ 的每个分量解释为每单位性状的相对适合度变化，但你不需要在方框答案中包含单位。", "solution": "所给问题是表型选择的定量遗传学中的一个标准练习，具体应用了由 Lande 和 Arnold 发展的多元选择模型。我们的任务是首先推导关联选择差向量 $\\mathbf{S}$、表型方差-协方差矩阵 $\\mathbf{P}$ 和选择梯度向量 $\\boldsymbol{\\beta}$ 的基本方程，然后计算 $\\boldsymbol{\\beta}$ 并解释其对一个给定系统的分量。该问题提法恰当，科学上合理，并为求得唯一解提供了所有必要信息。\n\n我们从推导开始。问题陈述，相对适合度 $w$ 可近似为均值中心化的表型向量 $\\mathbf{z}=(z_1, z_2)^{\\top}$ 的线性函数。该关系由线性回归模型表示：\n$$w = \\alpha + \\beta_1 z_1 + \\beta_2 z_2 + \\epsilon$$\n用向量表示法，即为 $w = \\alpha + \\boldsymbol{\\beta}^{\\top}\\mathbf{z} + \\epsilon$，其中 $\\boldsymbol{\\beta} = (\\beta_1, \\beta_2)^{\\top}$ 是定向选择梯度向量，$\\epsilon$ 是误差项。\n\n我们对等式两边取期望。鉴于性状是均值中心化的，则 $E[\\mathbf{z}] = \\mathbf{0}$。普通最小二乘（OLS）模型假设误差项的期望值为零，即 $E[\\epsilon] = 0$。给定的平均相对适合度为 $\\bar{w} = E[w] = 1$。\n$$E[w] = E[\\alpha + \\boldsymbol{\\beta}^{\\top}\\mathbf{z} + \\epsilon] = \\alpha + \\boldsymbol{\\beta}^{\\top}E[\\mathbf{z}] + E[\\epsilon]$$\n$$1 = \\alpha + \\boldsymbol{\\beta}^{\\top}\\mathbf{0} + 0 \\implies \\alpha = 1$$\n因此，适合度的线性模型为 $w = 1 + \\boldsymbol{\\beta}^{\\top}\\mathbf{z} + \\epsilon$。\n\n问题陈述，选择差向量 $\\mathbf{S}$ 等于性状和相对适合度之间的协方差。根据定义，变量向量 $\\mathbf{z}$ 和标量变量 $w$ 之间的协方差为：\n$$\\mathbf{S} = \\text{cov}(\\mathbf{z}, w) = E[(\\mathbf{z} - E[\\mathbf{z}])(w - E[w])]$$\n代入已知的均值 $E[\\mathbf{z}] = \\mathbf{0}$ 和 $E[w] = 1$，我们得到：\n$$\\mathbf{S} = E[\\mathbf{z}(w - 1)]$$\n现在，从我们的线性适合度模型代入 $(w-1)$ 的表达式，$w - 1 = \\boldsymbol{\\beta}^{\\top}\\mathbf{z} + \\epsilon = \\mathbf{z}^{\\top}\\boldsymbol{\\beta} + \\epsilon$。\n$$\\mathbf{S} = E[\\mathbf{z}(\\mathbf{z}^{\\top}\\boldsymbol{\\beta} + \\epsilon)]$$\n利用期望算子的线性性质：\n$$\\mathbf{S} = E[\\mathbf{z}\\mathbf{z}^{\\top}\\boldsymbol{\\beta}] + E[\\mathbf{z}\\epsilon]$$\n因为 $\\boldsymbol{\\beta}$ 是一个常数系数向量，它可以从期望中提取出来：\n$$\\mathbf{S} = E[\\mathbf{z}\\mathbf{z}^{\\top}]\\boldsymbol{\\beta} + E[\\mathbf{z}\\epsilon]$$\n根据定义，$E[\\mathbf{z}\\mathbf{z}^{\\top}]$ 项是均值中心化性状的方差-协方差矩阵 $\\mathbf{P}$。$E[\\mathbf{z}\\epsilon]$ 项代表预测变量与误差项之间的协方差。OLS回归的一个基本假设（“正交性条件”）是此协方差为零，即 $E[\\mathbf{z}\\epsilon] = \\mathbf{0}$。\n代入这些恒等式，我们便得出了所要求的关系：\n$$\\mathbf{S} = \\mathbf{P}\\boldsymbol{\\beta}$$\n这个方程是多元选择分析的基石。它表明，对一组性状的选择的总进化响应（$\\mathbf{S}$）是作用于这些性状的直接选择压力（$\\boldsymbol{\\beta}$）与它们之间的表型变异和协变异模式（$\\mathbf{P}$）的乘积。\n\n接下来，我们计算给定系统的选择梯度向量 $\\boldsymbol{\\beta}$。我们重排推导出的方程以求解 $\\boldsymbol{\\beta}$：\n$$\\boldsymbol{\\beta} = \\mathbf{P}^{-1}\\mathbf{S}$$\n提供的矩阵是：\n$$\\mathbf{P} = \\begin{pmatrix} 4 & 1 \\\\ 1 & 9 \\end{pmatrix}, \\quad \\mathbf{S} = \\begin{pmatrix} 0.2 \\\\ -0.3 \\end{pmatrix}$$\n首先，我们计算表型方差-协方差矩阵的逆矩阵 $\\mathbf{P}^{-1}$。对于一个通用的 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$，其逆矩阵为 $\\frac{1}{ad-bc}\\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$。\n$\\mathbf{P}$ 的行列式为 $\\det(\\mathbf{P}) = (4)(9) - (1)(1) = 36 - 1 = 35$。\n因此，逆矩阵为：\n$$\\mathbf{P}^{-1} = \\frac{1}{35}\\begin{pmatrix} 9 & -1 \\\\ -1 & 4 \\end{pmatrix}$$\n现在，我们进行矩阵乘法 $\\boldsymbol{\\beta} = \\mathbf{P}^{-1}\\mathbf{S}$。为保持精确性，我们将 $\\mathbf{S}$ 的分量表示为分数：$0.2 = \\frac{2}{10} = \\frac{1}{5}$ 和 $-0.3 = -\\frac{3}{10}$。\n$$\\boldsymbol{\\beta} = \\frac{1}{35}\\begin{pmatrix} 9 & -1 \\\\ -1 & 4 \\end{pmatrix} \\begin{pmatrix} 1/5 \\\\ -3/10 \\end{pmatrix}$$\n$$\\boldsymbol{\\beta} = \\frac{1}{35}\\begin{pmatrix} (9)(\\frac{1}{5}) + (-1)(-\\frac{3}{10}) \\\\ (-1)(\\frac{1}{5}) + (4)(-\\frac{3}{10}) \\end{pmatrix} = \\frac{1}{35}\\begin{pmatrix} \\frac{9}{5} + \\frac{3}{10} \\\\ -\\frac{1}{5} - \\frac{12}{10} \\end{pmatrix}$$\n为合并向量内的项，我们找到一个公分母：\n$$\\boldsymbol{\\beta} = \\frac{1}{35}\\begin{pmatrix} \\frac{18}{10} + \\frac{3}{10} \\\\ -\\frac{2}{10} - \\frac{12}{10} \\end{pmatrix} = \\frac{1}{35}\\begin{pmatrix} \\frac{21}{10} \\\\ -\\frac{14}{10} \\end{pmatrix}$$\n最后，我们乘以标量 $\\frac{1}{35}$：\n$$\\boldsymbol{\\beta} = \\begin{pmatrix} \\frac{21}{350} \\\\ -\\frac{14}{350} \\end{pmatrix} = \\begin{pmatrix} \\frac{3 \\times 7}{50 \\times 7} \\\\ -\\frac{2 \\times 7}{50 \\times 7} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{50} \\\\ -\\frac{2}{50} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{50} \\\\ -\\frac{1}{25} \\end{pmatrix}$$\n所以，选择梯度向量的分量为 $\\beta_1 = \\frac{3}{50}$ 和 $\\beta_2 = -\\frac{1}{25}$。\n\n最后，我们解释这些分量。选择梯度 $\\beta_i$ 是相对适合度 $w$ 对性状 $z_i$ 的偏导数，即 $\\beta_i = \\partial w / \\partial z_i$。它量化了对某一性状的*直接*选择强度，同时保持分析中所有其他性状不变。\n第一个分量 $\\beta_1 = \\frac{3}{50} = 0.06$，为正值。这表明对性状 $z_1$ 存在直接的正向定向选择。在保持性状 $z_2$ 不变的情况下，性状 $z_1$ 增加一个单位，对应于个体期望相对适合度增加 $0.06$。\n第二个分量 $\\beta_2 = -\\frac{1}{25} = -0.04$，为负值。这表明对性状 $z_2$ 存在直接的负向定向选择（即对较小性状值的选择）。在保持性状 $z_1$ 不变的情况下，性状 $z_2$ 增加一个单位，对应于期望相对适合度减少 $0.04$。\n将此与选择差 $\\mathbf{S}$ 区分开来至关重要。选择差 $S_i$ 衡量性状 $i$ 均值的总变化，它既是作用于性状 $i$ 的直接选择的函数，也是因性状 $i$ 与其他受选择的性状相关而产生的间接选择的函数。而选择梯度 $\\boldsymbol{\\beta}$ 则恰当地分离出了直接的选择力。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3}{50} & -\\frac{1}{25}\n\\end{pmatrix}\n}\n$$", "id": "2519772"}]}