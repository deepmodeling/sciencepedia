{"hands_on_practices": [{"introduction": "我们从亲代投资的核心冲突开始：单个亲代与单个子代之间的资源分配之争。由于遗传相关度的差异——亲代与其任何一个子女的相关度为 $r=1/2$，而子女与自身的相关度为 $1$——亲代和子代在“最优”投资水平上存在分歧，这构成了亲子冲突理论的基石。通过本练习，你将运用微积分来推导亲代和子代各自偏好的投资量，从而量化这一经典的进化拉锯战 [@problem_id:2517971]。", "problem": "考虑一个二倍体物种中的单次亲代抚育行为，其中亲代将非负量的投入 $I \\ge 0$ 分配给一个目标子代。设子代从投入中获得的适应性收益为 $B(I) = b_0 \\ln(1 + a I)$，其中 $b_0 > 0$ 且 $a > 0$；设亲代的适应性成本为 $C(I) = c I$，其中 $c > 0$。假设一个经典的亲子冲突框架，在该框架中，亲代使其广义适应性 $W_P(I) = r B(I) - C(I)$ 最大化，而子代偏好的抚育水平对应于在它能单方面决定 $I$ 的情况下，使其函数 $W_O(I) = B(I) - C(I)$ 最大化的水平，其中 $r$ 是二倍体物种的亲子亲缘关系度。取 $r = \\tfrac{1}{2}$。假设 $I$ 被约束为非负，且如果无约束最优解为负，则约束最优解为 $I = 0$。\n\n从广义适应性和边际优化（一阶和二阶条件）的定义出发，推导内部最优解以及它们为正的参数条件。当内部最优解为正时，以闭合形式计算亲代偏好的投入 $I_P$ 和子代偏好的投入 $I_O$，并用 $a$、$b_0$ 和 $c$ 表示。将最终答案以有序对 $(I_P, I_O)$ 的形式表示为精确的解析表达式。无需进行数值四舍五入，且 $I$ 无需单位。", "solution": "首先对问题陈述进行严格的验证过程。\n\n步骤 1：提取已知条件。\n提供的已知信息如下：\n- 投入水平：$I \\ge 0$。\n- 子代适应性收益函数：$B(I) = b_0 \\ln(1 + a I)$，其中参数 $b_0 > 0$ 且 $a > 0$。\n- 亲代适应性成本函数：$C(I) = c I$，其中参数 $c > 0$。\n- 亲代的广义适应性函数：$W_P(I) = r B(I) - C(I)$。\n- 子代偏好抚育水平的适应性函数：$W_O(I) = B(I) - C(I)$。\n- 二倍体物种的亲子亲缘关系度：$r = \\frac{1}{2}$。\n- 约束条件：如果无约束最优解为负，则约束最优解为 $I = 0$。\n- 目标：推导亲代偏好的投入 $I_P$ 和子代偏好的投入 $I_O$ 作为闭合形式的内部最优解，并以有序对 $(I_P, I_O)$ 的形式呈现答案。\n\n步骤 2：使用提取的已知条件进行验证。\n该问题是行为生态学中的一个标准练习，具体将 Hamilton 法则和优化理论应用于一个亲子冲突模型。\n- **科学依据：** 该模型基于演化生物学的既定原则，即广义适应性理论。使用对数收益函数表示投入的边际收益递减，这是一个常见且现实的假设。线性成本函数是一个标准的简化。二倍体物种亲子亲缘关系度取值 $r = \\frac{1}{2}$ 是正确的。该问题具有科学合理性。\n- **适定性：** 该问题提供了两个定义良好、连续且二阶可导的目标函数 $W_P(I)$ 和 $W_O(I)$，需要在定义域 $I \\ge 0$ 上进行最大化。其结构保证了每种情况下都存在唯一的最大值。\n- **客观性：** 该问题用精确的数学语言陈述，没有歧义或主观论断。\n\n步骤 3：结论与行动。\n该问题被认为是有效的。它是自洽、一致的，并基于既定的科学和数学原理。下面将进行求解。\n\n所用方法是使用微分学的优化方法。我们旨在分别找到使亲代的广义适应性 $W_P(I)$ 和子代的适应性 $W_O(I)$ 最大化的 $I$ 值。这些值记为 $I_P$ 和 $I_O$。\n\n首先，我们确定亲代偏好的投入 $I_P$。\n亲代的广义适应性函数是：\n$$W_P(I) = r B(I) - C(I) = \\frac{1}{2} b_0 \\ln(1 + a I) - c I$$\n为了求最大值，我们计算其关于 $I$ 的一阶导数并令其为零。这是内部最优解的一阶条件。\n$$\\frac{dW_P}{dI} = \\frac{d}{dI} \\left( \\frac{1}{2} b_0 \\ln(1 + a I) - c I \\right) = \\frac{1}{2} b_0 \\frac{a}{1 + a I} - c$$\n令导数为零可得：\n$$\\frac{a b_0}{2(1 + a I)} - c = 0$$\n$$\\frac{a b_0}{2c} = 1 + a I$$\n$$a I = \\frac{a b_0}{2c} - 1$$\n$$I_P = \\frac{1}{a} \\left( \\frac{a b_0}{2c} - 1 \\right) = \\frac{b_0}{2c} - \\frac{1}{a}$$\n这是内部最优解的候选值。为确认其为最大值，我们检验二阶条件。二阶导数必须为负。\n$$\\frac{d^2W_P}{dI^2} = \\frac{d}{dI} \\left( \\frac{a b_0}{2} (1 + a I)^{-1} - c \\right) = -\\frac{a b_0}{2} (1 + a I)^{-2} (a) = -\\frac{a^2 b_0}{2(1 + a I)^2}$$\n已知 $a > 0$ 且 $b_0 > 0$，分子 $a^2 b_0$ 为正。对于 $I \\ge 0$，分母 $2(1+aI)^2$ 也为正。因此，$\\frac{d^2W_P}{dI^2} < 0$，这证实了该临界点是一个局部最大值。\n问题要求的是内部最优解，即 $I_P > 0$。其条件为：\n$$\\frac{b_0}{2c} - \\frac{1}{a} > 0 \\implies \\frac{b_0}{2c} > \\frac{1}{a} \\implies a b_0 > 2c$$\n如果 $a b_0 \\le 2c$，则在 $I=0$ 处的边际收益为非正，最优投入为角点解 $I_P=0$。问题所求的是内部最优解，即在值为正的条件下，上面推导出的表达式。\n\n接下来，我们确定子代偏好的投入 $I_O$。\n子代的适应性函数是：\n$$W_O(I) = B(I) - C(I) = b_0 \\ln(1 + a I) - c I$$\n请注意，成本 $C(I)$ 是对亲代的成本，但它通过影响亲代的未来繁殖成功（这涉及到与目标子代有亲缘关系的兄弟姐妹）来影响子代的广义适应性。问题陈述将函数定义为 $W_O(I) = B(I) - C(I)$，这意味着子代对亲代适应性成本的评估等同于其自身适应性收益的评估。这代表了冲突的极端情况。\n我们求其关于 $I$ 的一阶导数：\n$$\\frac{dW_O}{dI} = \\frac{d}{dI} \\left( b_0 \\ln(1 + a I) - c I \\right) = b_0 \\frac{a}{1 + a I} - c$$\n为满足一阶条件，令导数为零：\n$$\\frac{a b_0}{1 + a I} - c = 0$$\n$$\\frac{a b_0}{c} = 1 + a I$$\n$$a I = \\frac{a b_0}{c} - 1$$\n$$I_O = \\frac{1}{a} \\left( \\frac{a b_0}{c} - 1 \\right) = \\frac{b_0}{c} - \\frac{1}{a}$$\n我们检验二阶条件：\n$$\\frac{d^2W_O}{dI^2} = \\frac{d}{dI} \\left( a b_0 (1 + a I)^{-1} - c \\right) = -a b_0 (1 + a I)^{-2} (a) = -\\frac{a^2 b_0}{(1 + a I)^2}$$\n因为 $a > 0$ 且 $b_0 > 0$，我们得到 $\\frac{d^2W_O}{dI^2} < 0$，这证实了该点是一个局部最大值。\n内部最优解 $I_O > 0$ 的条件是：\n$$\\frac{b_0}{c} - \\frac{1}{a} > 0 \\implies \\frac{b_0}{c} > \\frac{1}{a} \\implies a b_0 > c$$\n问题要求的是正内部最优解的闭合形式表达式。因此，当各自的条件（$a b_0 > 2c$ 和 $a b_0 > c$）满足时，$I_P$ 和 $I_O$ 的表达式有效。$I_P > 0$ 的条件比 $I_O > 0$ 的条件更严格。当亲代存在内部最优解时，子代也必然存在内部最优解。\n\n最终答案为有序对 $(I_P, I_O)$。\n$$I_P = \\frac{b_0}{2c} - \\frac{1}{a}$$\n$$I_O = \\frac{b_0}{c} - \\frac{1}{a}$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{b_0}{2c} - \\frac{1}{a} & \\frac{b_0}{c} - \\frac{1}{a}\n\\end{pmatrix}\n}\n$$", "id": "2517971"}, {"introduction": "现实中的亲代投资决策往往比单亲单子代模型更为复杂，亲代需要在多个子代之间分配有限的资源。当窝中存在亲子关系不确定性时（例如由于婚外父权），问题就变得更加棘手，因为雄性亲代与不同子代之间的遗传相关度可能不同。这个练习要求你使用拉格朗日乘子法来解决一个约束优化问题，从而确定父亲在面对不同亲缘关系的雏鸟时，如何最优地分配其育雏时间 [@problem_id:2517949]。", "problem": "一只具有领地意识的雄鸟需将其亲代抚育分配给三只雏鸟。设 $I_i \\ge 0$ 表示分配给雏鸟 $i \\in \\{1,2,3\\}$ 的抚育时间，总抚育预算为 $I$，因此 $\\sum_{i=1}^{3} I_i = I$。雄鸟从投资于雏鸟 $i$ 的抚育中获得的广义适合度回报，是遗传相关系数 $r_i$ 与一个收益递减的效益函数 $B_i(I_i)$ 的乘积。假设基本量遵循以下定义：\n- 广义适合度是遗传相关度乘以受益者适合度效应在所有受益者中的总和。\n- 父鸟与一只雏鸟的遗传相关度等于二分之一乘以该父鸟对那只雏鸟的父权概率。\n- 由于收益递减，亲代抚育的回报相对于投入是凹函数。\n\n假设混合父权产生的父权概率为 $p_1 = 1$，$p_2 = 0.6$，以及 $p_3 = 0.2$。因此，预期的相关度为 $r_i = \\tfrac{1}{2} p_i$，即 $r_1 = 0.5$，$r_2 = 0.3$，$r_3 = 0.1$。设效益函数为 $B_i(I_i) = s_i \\sqrt{I_i}$，效率乘数分别为 $s_1 = 1.0$，$s_2 = 0.8$，以及 $s_3 = 1.2$。总可用抚育时间为 $I = 120$ 小时。\n\n从上述核心定义出发，使用拉格朗日乘数法，从第一性原理推导出在约束条件 $\\sum_{i=1}^{3} I_i = I$ 和 $I_i \\ge 0$ 下，使雄鸟广义适合度 $\\sum_{i=1}^{3} r_i B_i(I_i)$ 最大化的最优分配 $I_i^{\\ast}$。然后，根据给定参数计算 $(I_1^{\\ast}, I_2^{\\ast}, I_3^{\\ast})$ 的数值。最后，分析混合父权相对于所有雏鸟均为完全父权（即对所有 $i$ 都有 $p_i = 1$）的情况，如何影响 $I_i^{\\ast}$。\n\n报告最终的数值分配向量 $(I_1^{\\ast}, I_2^{\\ast}, I_3^{\\ast})$，单位为小时，四舍五入到四位有效数字。", "solution": "所提出的问题是一个定义明确的约束优化问题，其基础是行为生态学的标准原理。该问题在科学上是合理的，且内部逻辑一致。因此，我们将着手解决此问题。\n\n目标是最大化雄鸟的总广义适合度 $F$，即从三只雏鸟各自获得的适合度回报之和。对雏鸟 $i$ 的适合度回报是遗传相关度 $r_i$ 和效益函数 $B_i(I_i)$ 的乘积。总广义适合度为：\n$$ F(I_1, I_2, I_3) = \\sum_{i=1}^{3} r_i B_i(I_i) $$\n抚育时间的投资 $I_i$ 必须为非负值，即 $I_i \\ge 0$，并且受总预算约束：\n$$ \\sum_{i=1}^{3} I_i = I $$\n根据函数和参数的具体形式：\n- 父权概率：$p_1 = 1$，$p_2 = 0.6$，$p_3 = 0.2$。\n- 相关系数：$r_i = \\frac{1}{2} p_i$，所以 $r_1 = 0.5$，$r_2 = 0.3$，$r_3 = 0.1$。\n- 效益函数：$B_i(I_i) = s_i \\sqrt{I_i}$。\n- 效率乘数：$s_1 = 1.0$，$s_2 = 0.8$，$s_3 = 1.2$。\n- 总预算：$I = 120$。\n\n目标函数变为：\n$$ F(I_1, I_2, I_3) = r_1 s_1 \\sqrt{I_1} + r_2 s_2 \\sqrt{I_2} + r_3 s_3 \\sqrt{I_3} $$\n这是一个在等式约束和非负约束下最大化函数的问题。我们使用拉格朗日乘数法。构建拉格朗日函数 $\\mathcal{L}$：\n$$ \\mathcal{L}(I_1, I_2, I_3, \\lambda) = \\left( \\sum_{i=1}^{3} r_i s_i \\sqrt{I_i} \\right) - \\lambda \\left( \\left( \\sum_{i=1}^{3} I_i \\right) - I \\right) $$\n还必须考虑非负约束 $I_i \\ge 0$。如果可能出现边界解（即对某个 $i$ 有 $I_i=0$），则需要完整的 Karush-Kuhn-Tucker (KKT) 条件。然而，对雏鸟 $i$ 的边际效益为 $\\frac{\\partial (r_i B_i)}{\\partial I_i} = \\frac{r_i s_i}{2\\sqrt{I_i}}$。当 $I_i \\to 0^+$ 时，对于任何 $r_i s_i > 0$ 的雏鸟，该边际效益趋近于无穷大。在此问题中，所有乘积 $r_i s_i$ 均为正值：\n- $r_1 s_1 = (0.5)(1.0) = 0.5$\n- $r_2 s_2 = (0.3)(0.8) = 0.24$\n- $r_3 s_3 = (0.1)(1.2) = 0.12$\n由于在零投资时的边际回报是无穷大，任何最优分配都必须对所有 $i$ 满足 $I_i^{\\ast} > 0$。因此，非负约束是非紧的（不起作用），我们可以通过将拉格朗日函数对每个 $I_i$ 的偏导数设为零来找到最优点。\n\n最大值的一阶条件是：\n$$ \\frac{\\partial \\mathcal{L}}{\\partial I_i} = \\frac{r_i s_i}{2\\sqrt{I_i}} - \\lambda = 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = I - \\sum_{i=1}^{3} I_i = 0 $$\n从第一个条件可知，在最优点，投资于每只雏鸟的边际广义适合度回报必须等于一个常数 $\\lambda$：\n$$ \\frac{r_i s_i}{2\\sqrt{I_i}} = \\lambda $$\n解出 $I_i$，得到其用拉格朗日乘数 $\\lambda$ 表示的值：\n$$ \\sqrt{I_i} = \\frac{r_i s_i}{2\\lambda} \\implies I_i = \\left(\\frac{r_i s_i}{2\\lambda}\\right)^2 = \\frac{(r_i s_i)^2}{4\\lambda^2} $$\n现在，我们将这个 $I_i$ 的表达式代入预算约束中以求解 $\\lambda$：\n$$ \\sum_{i=1}^{3} I_i = \\sum_{i=1}^{3} \\frac{(r_i s_i)^2}{4\\lambda^2} = I $$\n$$ \\frac{1}{4\\lambda^2} \\sum_{i=1}^{3} (r_i s_i)^2 = I $$\n$$ 4\\lambda^2 = \\frac{1}{I} \\sum_{j=1}^{3} (r_j s_j)^2 $$\n将此结果代回 $I_i$ 的表达式，我们推导出每只雏鸟的最优分配 $I_i^{\\ast}$：\n$$ I_i^{\\ast} = \\frac{(r_i s_i)^2}{ \\frac{1}{I} \\sum_{j=1}^{3} (r_j s_j)^2 } = I \\cdot \\frac{(r_i s_i)^2}{\\sum_{j=1}^{3} (r_j s_j)^2} $$\n这就是通解。它表明，对雏鸟 $i$ 的最优投资与总预算 $I$ 成正比，并且与它的有效质量 $(r_i s_i)^2$ 相对于所有雏鸟的该值平方和的比值成正比。\n\n现在我们计算特定混合父权情况下的数值。首先，计算有效质量的平方：\n- $(r_1 s_1)^2 = (0.5)^2 = 0.25$\n- $(r_2 s_2)^2 = (0.24)^2 = 0.0576$\n- $(r_3 s_3)^2 = (0.12)^2 = 0.0144$\n其和为：\n$$ \\sum_{j=1}^{3} (r_j s_j)^2 = 0.25 + 0.0576 + 0.0144 = 0.322 $$\n在总预算为 $I=120$ 小时的情况下，最优分配为：\n$$ I_1^{\\ast} = 120 \\cdot \\frac{0.25}{0.322} \\approx 93.1677 \\text{ 小时} $$\n$$ I_2^{\\ast} = 120 \\cdot \\frac{0.0576}{0.322} \\approx 21.4658 \\text{ 小时} $$\n$$ I_3^{\\ast} = 120 \\cdot \\frac{0.0144}{0.322} \\approx 5.3665 \\text{ 小时} $$\n最后，我们通过将此分配与完全父权的假设情况（即对所有 $i$，有 $p_i = 1$，因此 $r_i = 0.5$）相比较，来分析混合父权的影响。\n在完全父权的情景下，有效质量为：\n- $r_1 s_1 = (0.5)(1.0) = 0.5$\n- $r_2 s_2 = (0.5)(0.8) = 0.4$\n- $r_3 s_3 = (0.5)(1.2) = 0.6$\n有效质量的平方为：\n- $(r_1 s_1)^2 = 0.25$\n- $(r_2 s_2)^2 = 0.16$\n- $(r_3 s_3)^2 = 0.36$\n其和为 $\\sum_{j=1}^{3} (r_j s_j)^2 = 0.25 + 0.16 + 0.36 = 0.77$。\n在完全父权下的最优分配将是：\n$$ I_{1, \\text{full}}^{\\ast} = 120 \\cdot \\frac{0.25}{0.77} \\approx 38.96 \\text{ 小时} $$\n$$ I_{2, \\text{full}}^{\\ast} = 120 \\cdot \\frac{0.16}{0.77} \\approx 24.94 \\text{ 小时} $$\n$$ I_{3, \\text{full}}^{\\ast} = 120 \\cdot \\frac{0.36}{0.77} \\approx 56.10 \\text{ 小时} $$\n比较这两种分配：\n- 混合父权：$(I_1^{\\ast}, I_2^{\\ast}, I_3^{\\ast}) \\approx (93.17, 21.47, 5.367)$\n- 完全父权：$(I_{1, \\text{full}}^{\\ast}, I_{2, \\text{full}}^{\\ast}, I_{3, \\text{full}}^{\\ast}) \\approx (38.96, 24.94, 56.10)$\n分析结果是清晰的。对雏鸟2和3的父权不确定性导致了亲代抚育的剧烈重新分配。对有确定父权的雏鸟的投资（$I_1^{\\ast}$）增加了一倍以上，从大约39小时增加到93小时。相反，对父权不确定的雏鸟的投资则急剧下降。对雏鸟3（父权最低）的投资减少了近一个数量级，从56小时降至仅5个多小时。对雏鸟2（中等父权）的投资也有所减少。雄鸟将其有限的资源集中在能提供最高广义适合度回报的后代上，而回报则由遗传相关度（$r_i$）和转换效率（$s_i$）的综合效应决定。父权的降低会急剧拉低雏鸟在雄鸟适合度计算中的价值，导致投资向其自身遗传后代的理性转移。\n\n按要求将混合父权情况下的结果四舍五入到四位有效数字：\n$$ I_1^{\\ast} = 93.17 $$\n$$ I_2^{\\ast} = 21.47 $$\n$$ I_3^{\\ast} = 5.366 $$\n总和为 $93.17 + 21.47 + 5.366 = 120.006$，在四舍五入精度内与总预算 $I=120$ 一致。", "answer": "$$\n\\boxed{\\begin{pmatrix} 93.17 & 21.47 & 5.366 \\end{pmatrix}}\n$$", "id": "2517949"}, {"introduction": "亲代投资不仅涉及“投资多少”，还涉及“是否投资”的识别决策，尤其是在面对巢寄生时。寄主鸟类必须根据不完美的线索（如蛋壳图案）来判断巢中的蛋是自己的还是寄生者的，这个决策过程充满了犯错的风险——错误地抛弃自己的蛋或接受寄生者的蛋。本练习将引导你应用信号检测理论的框架，通过构建一个预期损失函数并将其最小化，来推导出一个最优的决策阈值，揭示生物体在不确定性下如何做出统计上最优的判断 [@problem_id:2517959]。", "problem": "一种宿主鸟类面临专性巢寄生。当遇到一窝卵时，亲鸟会观察到一个单变量表型线索 $x$（例如，蛋壳图案相似性指数），然后应用一个由 $\\tau$ 参数化的确定性阈值规则：如果 $x \\ge \\tau$，则弃除该卵，否则接受它。线索的分布取决于真实状态：如果卵来自宿主（状态 $H$），则 $x \\sim \\mathcal{N}(\\mu_{H},\\sigma^{2})$；如果卵来自寄生物（状态 $P$），则 $x \\sim \\mathcal{N}(\\mu_{P},\\sigma^{2})$，其中 $\\mu_{P} > \\mu_{H}$ 和 $\\sigma > 0$ 是已知常数。随机遇到的一个卵是寄生卵的先验概率为 $p \\in (0,1)$。如果亲鸟接受了一个寄生卵（状态为 $P$ 但采取“接受”行动），它会产生一个接受成本 $c_{a} > 0$；如果它弃除一个宿主卵（状态为 $H$ 但采取“弃除”行动），则会产生一个弃除成本 $c_{r} > 0$。所有其他结果的成本均为零。\n\n从条件概率和期望值的定义出发，不引入任何预先推导的决策公式，完成以下任务：\n\n- 推导在阈值策略下的期望损失 $L(\\tau)$，将其表示为 $\\tau$, $p$, $c_{a}$, $c_{r}$, $\\mu_{H}$, $\\mu_{P}$ 和 $\\sigma$ 的函数。\n- 计算使 $L(\\tau)$ 在所有实数 $\\tau$ 上最小化的值 $\\tau^{*}$。将 $\\tau^{*}$ 表示为包含 $p$, $c_{a}$, $c_{r}$, $\\mu_{H}$, $\\mu_{P}$ 和 $\\sigma$ 的解析表达式的闭式解。\n\n你的最终答案应该是 $\\tau^{*}$ 的单一解析表达式。不需要也不允许使用数值近似。", "solution": "我们首先形式化这个随机决策设定，然后通过对真实状态进行条件化并对线索分布进行积分来计算期望损失。令 $A$ 表示“接受”行动，$R$ 表示“弃除”行动。在参数为 $\\tau$ 的阈值规则下，策略为：如果 $x \\ge \\tau$ 则为 $R$，如果 $x < \\tau$ 则为 $A$。\n\n根据全期望定律，策略 $\\tau$ 下的期望损失为\n$$\nL(\\tau) \\;=\\; \\mathbb{E}[\\text{loss}] \\;=\\; \\mathbb{P}(P)\\,\\mathbb{E}[\\text{loss}\\mid P] \\;+\\; \\mathbb{P}(H)\\,\\mathbb{E}[\\text{loss}\\mid H].\n$$\n根据成本结构（只有两种错误类型会产生非零损失），我们有：\n- 如果真实状态是 $P$（寄生卵），当行动为 $A$ 时会产生损失 $c_{a}$；这种情况发生的概率为 $\\mathbb{P}(A\\mid P) = \\mathbb{P}(x<\\tau\\mid P)$。\n- 如果真实状态是 $H$（宿主卵），当行动为 $R$ 时会产生损失 $c_{r}$；这种情况发生的概率为 $\\mathbb{P}(R\\mid H) = \\mathbb{P}(x\\ge \\tau\\mid H)$。\n\n令 $F_{P}(\\cdot)$ 和 $F_{H}(\\cdot)$ 分别表示在状态 $P$ 和 $H$ 下 $x$ 的累积分布函数（CDF），$f_{P}(\\cdot)$ 和 $f_{H}(\\cdot)$ 分别表示相应的概率密度函数（PDF）。当 $\\mathbb{P}(P)=p$ 且 $\\mathbb{P}(H)=1-p$ 时，期望损失为\n$$\nL(\\tau) \\;=\\; p\\,c_{a}\\,F_{P}(\\tau) \\;+\\; (1-p)\\,c_{r}\\,\\bigl(1 - F_{H}(\\tau)\\bigr).\n$$\n根据模型假设，$x\\mid P \\sim \\mathcal{N}(\\mu_{P},\\sigma^{2})$ 且 $x\\mid H \\sim \\mathcal{N}(\\mu_{H},\\sigma^{2})$，因此 $F_{P}$ 和 $F_{H}$ 是正态累积分布函数，具有相同的方差参数 $\\sigma^{2}$ 和各自的均值 $\\mu_{P}$ 和 $\\mu_{H}$。\n\n为了找到最小化损失的阈值 $\\tau^{*}$，我们将 $L(\\tau)$ 对 $\\tau$ 求导，并令导数等于零。利用 $\\frac{d}{d\\tau}F_{P}(\\tau)=f_{P}(\\tau)$ 和 $\\frac{d}{d\\tau}F_{H}(\\tau)=f_{H}(\\tau)$，我们得到\n$$\n\\frac{d}{d\\tau}L(\\tau) \\;=\\; p\\,c_{a}\\,f_{P}(\\tau) \\;-\\; (1-p)\\,c_{r}\\,f_{H}(\\tau).\n$$\n临界点满足\n$$\np\\,c_{a}\\,f_{P}(\\tau) \\;=\\; (1-p)\\,c_{r}\\,f_{H}(\\tau),\n$$\n或等价地，\n$$\n\\frac{f_{P}(\\tau)}{f_{H}(\\tau)} \\;=\\; \\frac{(1-p)\\,c_{r}}{p\\,c_{a}}.\n$$\n我们现在计算正态概率密度函数之比。对于均值为 $\\mu$、方差为 $\\sigma^{2}$ 的正态分布，\n$$\nf(x\\mid \\mu,\\sigma^{2}) \\;=\\; \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\Bigl(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\Bigr).\n$$\n因此，\n$$\n\\frac{f_{P}(\\tau)}{f_{H}(\\tau)} \\;=\\; \\exp\\Bigl(-\\frac{(\\tau-\\mu_{P})^{2}}{2\\sigma^{2}}+\\frac{(\\tau-\\mu_{H})^{2}}{2\\sigma^{2}}\\Bigr)\n\\;=\\; \\exp\\Bigl(\\frac{2\\tau(\\mu_{P}-\\mu_{H}) + \\mu_{H}^{2}-\\mu_{P}^{2}}{2\\sigma^{2}}\\Bigr).\n$$\n令此式等于 $\\frac{(1-p)\\,c_{r}}{p\\,c_{a}}$ 并取自然对数，得到\n$$\n\\frac{2\\tau(\\mu_{P}-\\mu_{H}) + \\mu_{H}^{2}-\\mu_{P}^{2}}{2\\sigma^{2}} \\;=\\; \\ln\\!\\Bigl(\\frac{(1-p)\\,c_{r}}{p\\,c_{a}}\\Bigr).\n$$\n解出 $\\tau$ 可得\n$$\n2\\tau(\\mu_{P}-\\mu_{H}) \\;=\\; 2\\sigma^{2}\\,\\ln\\!\\Bigl(\\frac{(1-p)\\,c_{r}}{p\\,c_{a}}\\Bigr) \\;-\\; \\mu_{H}^{2} \\;+\\; \\mu_{P}^{2},\n$$\n因此\n$$\n\\tau^{*} \\;=\\; \\frac{\\sigma^{2}}{\\mu_{P}-\\mu_{H}}\\,\\ln\\!\\Bigl(\\frac{(1-p)\\,c_{r}}{p\\,c_{a}}\\Bigr) \\;+\\; \\frac{\\mu_{P}^{2}-\\mu_{H}^{2}}{2(\\mu_{P}-\\mu_{H})}.\n$$\n使用恒等式 $\\mu_{P}^{2}-\\mu_{H}^{2} = (\\mu_{P}-\\mu_{H})(\\mu_{P}+\\mu_{H})$，我们可以简化第二项，从而得到更具解释性的闭式解\n$$\n\\tau^{*} \\;=\\; \\frac{\\mu_{P}+\\mu_{H}}{2} \\;+\\; \\frac{\\sigma^{2}}{\\mu_{P}-\\mu_{H}}\\,\\ln\\!\\Bigl(\\frac{(1-p)\\,c_{r}}{p\\,c_{a}}\\Bigr).\n$$\n\n接下来需要验证该临界点确实是一个唯一的最小值点。因为 $\\mu_{P} > \\mu_{H}$ 且两个条件分布都是方差相等的正态分布，所以似然比 $\\frac{f_{P}(\\tau)}{f_{H}(\\tau)}$ 是 $\\tau$ 的一个严格递增函数（其对数是 $\\tau$ 的线性函数）。因此，方程 $\\frac{f_{P}(\\tau)}{f_{H}(\\tau)} = \\frac{(1-p)c_{r}}{p c_{a}}$ 有唯一解，从而确定了临界点的唯一性。为了进行二阶检验，再次求导：\n$$\n\\frac{d^{2}}{d\\tau^{2}}L(\\tau) \\;=\\; p\\,c_{a}\\,f_{P}'(\\tau) \\;-\\; (1-p)\\,c_{r}\\,f_{H}'(\\tau).\n$$\n对于正态概率密度函数，$f'(x) = -\\frac{x-\\mu}{\\sigma^{2}}\\,f(x)$。在临界点 $\\tau^{*}$ 处进行计算，此处满足 $p\\,c_{a}\\,f_{P}(\\tau^{*})=(1-p)\\,c_{r}\\,f_{H}(\\tau^{*})$，我们得到\n$$\n\\frac{d^{2}}{d\\tau^{2}}L(\\tau^{*}) \\;=\\; \\frac{(1-p)\\,c_{r}\\,f_{H}(\\tau^{*})}{\\sigma^{2}}\\,(\\mu_{P}-\\mu_{H}) \\;>\\; 0,\n$$\n因为 $f_{H}(\\tau^{*})>0$, $(1-p)\\,c_{r}>0$ 且 $\\mu_{P}-\\mu_{H}>0$。所以，$\\tau^{*}$ 是 $L(\\tau)$ 的唯一全局最小值点。\n\n因此，最优阈值的闭式解为\n$$\n\\tau^{*} \\;=\\; \\frac{\\mu_{P}+\\mu_{H}}{2} \\;+\\; \\frac{\\sigma^{2}}{\\mu_{P}-\\mu_{H}}\\,\\ln\\!\\Bigl(\\frac{(1-p)\\,c_{r}}{p\\,c_{a}}\\Bigr).\n$$", "answer": "$$\\boxed{\\frac{\\mu_{P}+\\mu_{H}}{2}+\\frac{\\sigma^{2}}{\\mu_{P}-\\mu_{H}}\\ln\\!\\left(\\frac{(1-p)c_{r}}{p\\,c_{a}}\\right)}$$", "id": "2517959"}]}