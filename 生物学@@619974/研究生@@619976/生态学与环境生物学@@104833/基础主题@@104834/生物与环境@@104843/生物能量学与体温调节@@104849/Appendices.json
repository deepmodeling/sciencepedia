{"hands_on_practices": [{"introduction": "这第一个练习通过聚焦于热量平衡的基本原理，为理解恒温动物的体温调节奠定了基础。你将把热力学第一定律应用于一个简化情景，以计算动物在寒冷环境中维持其核心体温 $T_b$ 所必须消耗的代谢能量。这项实践旨在巩固你对热导率 $C$ 以及在热中性区以下生活所需能量成本的核心概念的理解 [@problem_id:2516303]。", "problem": "一只小型的内温哺乳动物在静止、干燥的空气中静息一整天。其核心体温被调节并恒定在 $T_{b} = 37\\,^\\circ\\text{C}$，而环境空气温度为 $T_{a} = 5\\,^\\circ\\text{C}$。该动物的最小干热导（综合了最大隔热条件下的辐射和对流传热）为 $C_{\\min} = 0.2\\ \\mathrm{W\\,K^{-1}}$。其基础代谢率（在热中性状态下的最小代谢产热率）为 $BMR = 1.5\\ \\mathrm{W}$。\n\n仅使用稳态下将身体视为控制体积的能量守恒定律，以及在干热条件下感热损失通过一个热导与核心-环境温差成正比这一唯象事实，确定在此条件下为维持 $T_{b}$ 恒定在 $24\\ \\mathrm{h}$ 内消耗的总代谢能。假设蒸发散热和对外所做的机械功均可忽略不计，并假设该动物可以根据需要调节其新陈代谢，但其代谢率不能低于 $BMR$。以 $\\mathrm{kJ}$ 为单位表示您的最终答案，并四舍五入到四位有效数字。", "solution": "本题要求确定一只内温哺乳动物在特定环境条件下 $24$ 小时内的总代谢能量消耗。控制该系统的基本原理是热力学第一定律，即能量守恒定律，应用于稳态下将动物视为一个控制体积的情形。\n\n题目指出，动物的核心体温 $T_{b}$ 是恒定的。这意味着系统处于稳态，其体内储存能量的变化率为零。动物的能量平衡可表示为：\n$$\\frac{dE_{storage}}{dt} = H_{M} - H_{loss} - P_{work}$$\n其中 $H_{M}$ 是代谢产热率，$H_{loss}$ 是向环境的散热率，$P_{work}$ 是动物对外做机械功的功率。\n在稳态条件下，$\\frac{dE_{storage}}{dt} = 0$。题目还指明对外做的机械功可忽略不计，因此 $P_{work} = 0$。这可将能量平衡方程简化为：\n$$H_{M} = H_{loss}$$\n这意味着，为了维持恒定的体温，代谢产热率必须与散热率完全相等。\n\n题目指出，感热损失与核心-环境温差成正比。这在物理上对应于牛顿冷却定律和斯特藩-玻尔兹曼定律（对于辐射，在小温差下进行线性化）的组合形式，并表示为：\n$$H_{loss} = C \\cdot (T_{b} - T_{a})$$\n此处，$C$ 是热导，$T_{b} = 37\\,^\\circ\\text{C}$ 是核心体温，$T_{a} = 5\\,^\\circ\\text{C}$ 是环境空气温度。在寒冷环境中（即当 $T_{a}$ 低于动物的下临界温度时），动物会通过最大化其隔热能力来最小化热量损失。这对应于使用最小干热导，$C_{\\min} = 0.2\\ \\mathrm{W\\,K^{-1}}$。\n\n温差为 $\\Delta T = T_{b} - T_{a} = 37\\,^\\circ\\text{C} - 5\\,^\\circ\\text{C} = 32\\,^\\circ\\text{C}$。以摄氏度为单位的温差在数值上等于以开尔文为单位的温差，因此 $\\Delta T = 32\\ \\mathrm{K}$。\n\n现在我们可以计算动物向环境的散热率：\n$$H_{loss} = C_{\\min} \\cdot (T_{b} - T_{a}) = (0.2\\ \\mathrm{W\\,K^{-1}}) \\cdot (32\\ \\mathrm{K}) = 6.4\\ \\mathrm{W}$$\n\n根据稳态能量平衡，所需的代谢率 $H_{M}$ 必须等于此散热率：\n$$H_{M} = 6.4\\ \\mathrm{W}$$\n\n我们必须将此结果与动物的基础代谢率 $BMR = 1.5\\ \\mathrm{W}$ 进行核对。BMR 代表静息动物在其热中性区内的最低代谢率。题目指出动物的代谢率不能低于此速率。由于我们计算出的所需代谢率 $H_{M} = 6.4\\ \\mathrm{W}$ 大于 $BMR$，因此这是一个生理上有效的状态。动物必须将其新陈代谢提高到 $6.4\\ \\mathrm{W}$ 以补偿热量损失并维持其体温。\n\n在时间间隔 $\\Delta t$ 内消耗的总代谢能 $E_{total}$ 是代谢功率 ($H_{M}$) 与持续时间的乘积。\n$$E_{total} = H_{M} \\times \\Delta t$$\n时间间隔为 $\\Delta t = 24\\ \\mathrm{h}$。为保持单位一致性，我们将小时转换为秒，注意到 $1\\ \\mathrm{W} = 1\\ \\mathrm{J\\,s^{-1}}$。\n$$\\Delta t = 24\\ \\mathrm{h} \\times 60\\ \\mathrm{min\\,h^{-1}} \\times 60\\ \\mathrm{s\\,min^{-1}} = 86400\\ \\mathrm{s}$$\n\n现在，我们计算以焦耳为单位的总能量：\n$$E_{total} = (6.4\\ \\mathrm{J\\,s^{-1}}) \\times (86400\\ \\mathrm{s}) = 552960\\ \\mathrm{J}$$\n\n题目要求最终答案以千焦（$\\mathrm{kJ}$）为单位，并四舍五入到四位有效数字。\n$$E_{total} = \\frac{552960\\ \\mathrm{J}}{1000\\ \\mathrm{J\\,kJ^{-1}}} = 552.96\\ \\mathrm{kJ}$$\n\n四舍五入到四位有效数字，我们得到：\n$$E_{total} \\approx 553.0\\ \\mathrm{kJ}$$", "answer": "$$\\boxed{553.0}$$", "id": "2516303"}, {"introduction": "在代谢率概念的基础上，本实践将深入探讨如何利用间接量热法对其进行经验性测量。你将把原始的呼吸数据，特别是耗氧量和呼吸商（$RQ$），转换为以瓦特（$W$）为单位的精确代谢率。这项练习不仅连接了生理测量与能量理论，还通过将计算值与标准预测模型进行比较，引入了异速生长的关键概念 [@problem_id:2516305]。", "problem": "一只处于静息状态的小型吸热哺乳动物，测得其耗氧率为 $0.5\\ \\mathrm{mL\\ O_2\\ g^{-1}\\ h^{-1}}$，呼吸商 (RQ) 为 $0.8$。其体重为 $0.3\\ \\mathrm{kg}$。请使用间接测热法的基本原理，通过将代谢底物视为碳水化合物和脂肪的混合物（蛋白质的贡献可忽略不计），计算其基础代谢率 (BMR)，单位为瓦特。请使用以下基本信息和假设：\n\n- 呼吸商定义为 $RQ = \\dot{V}_{\\mathrm{CO_2}}/\\dot{V}_{\\mathrm{O_2}}$。\n- 在标准状况下，代表性底物完全氧化的反应如下：\n  - 葡萄糖：$\\mathrm{C_6H_{12}O_6} + 6\\,\\mathrm{O_2} \\to 6\\,\\mathrm{CO_2} + 6\\,\\mathrm{H_2O}$，其标准燃烧焓为 $\\Delta H_{\\mathrm{c,glc}} = -2803\\ \\mathrm{kJ\\ mol^{-1}}$。\n  - 棕榈酸：$\\mathrm{C_{16}H_{32}O_2} + 23\\,\\mathrm{O_2} \\to 16\\,\\mathrm{CO_2} + 16\\,\\mathrm{H_2O}$，其标准燃烧焓为 $\\Delta H_{\\mathrm{c,pal}} = -9980\\ \\mathrm{kJ\\ mol^{-1}}$。\n- 假设观测到的 $RQ$ 源于葡萄糖和棕榈酸氧化瞬时混合物的贡献，且与给定的化学计量关系内在一致（忽略蛋白质和氮平衡）。\n- 使用标准温度和压力下干燥理想气体的摩尔体积 (STPD)，$V_m = 22.414\\ \\mathrm{L\\ mol^{-1}}$。\n- 取 $1\\ \\mathrm{W} = 1\\ \\mathrm{J\\ s^{-1}}$。\n\n然后，将测得的 BMR 与异速模型 $B_{\\mathrm{pred}} = 0.07\\, m^{0.72}$ 的预测值进行比较，其中 $B_{\\mathrm{pred}}$ 的单位为 $\\mathrm{W}$，体重 $m$ 的单位为克。令 $B_{\\mathrm{meas}}$ 表示您根据气体交换数据计算出的 BMR。以无量纲小数的形式报告比率 $r = B_{\\mathrm{meas}}/B_{\\mathrm{pred}}$。将您最终报告的比率四舍五入至三位有效数字。", "solution": "间接测热法的核心原理是，生物体产生的热量与消耗的氧气量成正比。准确的比例常数，即氧热价，取决于被氧化底物的化学性质。呼吸商 ($RQ$) 定义为产生的二氧化碳体积 ($\\dot{V}_{\\mathrm{CO_2}}$) 与消耗的氧气体积 ($\\dot{V}_{\\mathrm{O_2}}$) 之比，它使我们能够确定正在代谢的底物混合比例。\n\n首先，我们确定所提供的两种代表性底物——葡萄糖 ($\\mathrm{C_6H_{12}O_6}$) 和棕榈酸 ($\\mathrm{C_{16}H_{32}O_2}$)——完全氧化时的 $RQ$。根据 Avogadro 定律，在相同温度和压力下，气体的体积比等于其摩尔量之比。\n对于葡萄糖：\n$$ \\mathrm{C_6H_{12}O_6} + 6\\,\\mathrm{O_2} \\to 6\\,\\mathrm{CO_2} + 6\\,\\mathrm{H_2O} $$\n$$ RQ_{\\mathrm{glc}} = \\frac{6 \\text{ mol } \\mathrm{CO_2}}{6 \\text{ mol } \\mathrm{O_2}} = 1.0 $$\n对于棕榈酸：\n$$ \\mathrm{C_{16}H_{32}O_2} + 23\\,\\mathrm{O_2} \\to 16\\,\\mathrm{CO_2} + 16\\,\\mathrm{H_2O} $$\n$$ RQ_{\\mathrm{pal}} = \\frac{16 \\text{ mol } \\mathrm{CO_2}}{23 \\text{ mol } \\mathrm{O_2}} \\approx 0.6957 $$\n该哺乳动物测得的 $RQ$ 为 $0.8$。我们假设这是葡萄糖和脂肪氧化混合作用的结果，忽略蛋白质。设 $f$ 为用于碳水化合物氧化的耗氧量比例，$(1-f)$ 为用于脂肪氧化的比例。总 $RQ$ 是加权平均值：\n$$ RQ = f \\cdot RQ_{\\mathrm{glc}} + (1-f) \\cdot RQ_{\\mathrm{pal}} $$\n代入已知值：\n$$ 0.8 = f \\cdot (1.0) + (1-f) \\cdot \\left(\\frac{16}{23}\\right) $$\n$$ 0.8 = f + \\frac{16}{23} - \\frac{16}{23}f $$\n$$ 0.8 - \\frac{16}{23} = f \\left(1 - \\frac{16}{23}\\right) $$\n$$ \\frac{4}{5} - \\frac{16}{23} = f \\left(\\frac{7}{23}\\right) $$\n$$ \\frac{92 - 80}{115} = f \\left(\\frac{7}{23}\\right) $$\n$$ \\frac{12}{115} = f \\left(\\frac{7}{23}\\right) $$\n解出 $f$：\n$$ f = \\frac{12}{115} \\cdot \\frac{23}{7} = \\frac{12}{5 \\cdot 23} \\cdot \\frac{23}{7} = \\frac{12}{35} $$\n因此，$\\frac{12}{35}$ 的耗氧量用于葡萄糖氧化，$(1-f) = \\frac{23}{35}$ 用于棕榈酸氧化。\n\n接下来，我们计算每种底物每摩尔氧气释放的能量。代谢过程是放热的，因此反应焓为负。释放的能量是该焓的绝对值。\n对于葡萄糖，消耗 $6$ 摩尔 $\\mathrm{O_2}$ 时， $|\\Delta H_{\\mathrm{c,glc}}| = 2803\\ \\mathrm{kJ}$。\n$$ E_{\\mathrm{glc}} = \\frac{2803 \\ \\mathrm{kJ}}{6 \\ \\mathrm{mol \\ O_2}} $$\n对于棕榈酸，消耗 $23$ 摩尔 $\\mathrm{O_2}$ 时， $|\\Delta H_{\\mathrm{c,pal}}| = 9980\\ \\mathrm{kJ}$。\n$$ E_{\\mathrm{pal}} = \\frac{9980 \\ \\mathrm{kJ}}{23 \\ \\mathrm{mol \\ O_2}} $$\n对于观测到的 $RQ$，平均每摩尔氧气释放的能量是加权平均值：\n$$ E_{\\mathrm{avg/mol}} = f \\cdot E_{\\mathrm{glc}} + (1-f) \\cdot E_{\\mathrm{pal}} $$\n$$ E_{\\mathrm{avg/mol}} = \\left(\\frac{12}{35}\\right) \\left(\\frac{2803}{6}\\right) + \\left(\\frac{23}{35}\\right) \\left(\\frac{9980}{23}\\right) = \\frac{2 \\cdot 2803}{35} + \\frac{9980}{35} = \\frac{5606 + 9980}{35} = \\frac{15586}{35} \\ \\mathrm{kJ\\ mol^{-1}} $$\n为了以每单位体积能量的形式求出氧热价，我们使用 STPD 下理想气体的摩尔体积，$V_m = 22.414\\ \\mathrm{L\\ mol^{-1}}$。\n$$ K_{\\mathrm{O_2}} = \\frac{E_{\\mathrm{avg/mol}}}{V_m} = \\frac{15586/35 \\ \\mathrm{kJ\\ mol^{-1}}}{22.414\\ \\mathrm{L\\ mol^{-1}}} = \\frac{15586}{35 \\cdot 22.414} \\ \\mathrm{kJ\\ L^{-1}} $$\n现在，我们计算该哺乳动物的总耗氧率 $\\dot{V}_{\\mathrm{O_2}}$。该哺乳动物的体重为 $m = 0.3\\ \\mathrm{kg} = 300\\ \\mathrm{g}$。比耗氧率为 $0.5\\ \\mathrm{mL\\ O_2\\ g^{-1}\\ h^{-1}}$。\n$$ \\dot{V}_{\\mathrm{O_2}} = (0.5\\ \\mathrm{mL\\ O_2\\ g^{-1}\\ h^{-1}}) \\cdot (300\\ \\mathrm{g}) = 150\\ \\mathrm{mL\\ h^{-1}} $$\n为了以瓦特（$1\\ \\mathrm{W} = 1\\ \\mathrm{J\\ s^{-1}}$）为单位计算代谢率，我们必须对单位进行一致的转换。\n$$ \\dot{V}_{\\mathrm{O_2}} = 150 \\ \\frac{\\mathrm{mL}}{\\mathrm{h}} \\cdot \\frac{1\\ \\mathrm{L}}{1000\\ \\mathrm{mL}} \\cdot \\frac{1\\ \\mathrm{h}}{3600\\ \\mathrm{s}} = \\frac{150}{3600000} \\ \\mathrm{L\\ s^{-1}} = \\frac{1}{24000} \\ \\mathrm{L\\ s^{-1}} $$\n测得的基础代谢率 $B_{\\mathrm{meas}}$ 是耗氧率与氧热价的乘积。我们还将单位从 $\\mathrm{kJ}$ 转换为 $\\mathrm{J}$。\n$$ B_{\\mathrm{meas}} = \\dot{V}_{\\mathrm{O_2}} \\cdot K_{\\mathrm{O_2}} = \\left(\\frac{1}{24000} \\ \\mathrm{L\\ s^{-1}}\\right) \\cdot \\left(\\frac{15586}{35 \\cdot 22.414} \\ \\mathrm{kJ\\ L^{-1}}\\right) \\cdot \\left(\\frac{1000\\ \\mathrm{J}}{1\\ \\mathrm{kJ}}\\right) $$\n$$ B_{\\mathrm{meas}} = \\frac{15586 \\cdot 1000}{24000 \\cdot 35 \\cdot 22.414} \\ \\mathrm{W} = \\frac{15586}{24 \\cdot 35 \\cdot 22.414} \\ \\mathrm{W} = \\frac{15586}{840 \\cdot 22.414} \\ \\mathrm{W} \\approx 0.82781 \\ \\mathrm{W} $$\n接下来，我们使用给定的异速模型 $B_{\\mathrm{pred}} = 0.07\\, m^{0.72}$ 计算预测的 BMR，$B_{\\mathrm{pred}}$，其中质量 $m$ 必须以克为单位。\n$$ m = 300\\ \\mathrm{g} $$\n$$ B_{\\mathrm{pred}} = 0.07 \\cdot (300)^{0.72} \\ \\mathrm{W} $$\n$$ B_{\\mathrm{pred}} = 0.07 \\cdot \\exp(0.72 \\cdot \\ln(300)) \\ \\mathrm{W} \\approx 0.07 \\cdot \\exp(0.72 \\cdot 5.70378) \\ \\mathrm{W} \\approx 0.07 \\cdot \\exp(4.10672) \\ \\mathrm{W} $$\n$$ B_{\\mathrm{pred}} \\approx 0.07 \\cdot 60.74516 \\ \\mathrm{W} \\approx 4.25216 \\ \\mathrm{W} $$\n最后，我们计算比率 $r = B_{\\mathrm{meas}}/B_{\\mathrm{pred}}$ 并四舍五入至三位有效数字。\n$$ r = \\frac{B_{\\mathrm{meas}}}{B_{\\mathrm{pred}}} = \\frac{0.82781\\ \\mathrm{W}}{4.25216\\ \\mathrm{W}} \\approx 0.194679 $$\n四舍五入至三位有效数字得到：\n$$ r \\approx 0.195 $$", "answer": "$$ \\boxed{0.195} $$", "id": "2516305"}, {"introduction": "这最后一个综合性实践将前面的概念融合成一个强大的应用：机理化物种分布模型。你将基于第一性原理构建一个生物能量学模型，以预测生物的适生气候生态位，并评估其在气候变化下可能发生的变化。这项练习展示了热平衡和异速生长的基本原理如何被放大应用于解决紧迫的、大尺度的生态学问题 [@problem_id:2516337]。", "problem": "要求您实现一个完整的、可运行的程序，该程序使用提供的当前和未来气候下的气候网格，计算一个假想恒温生物的能量可行性并预测其分布范围限制。推导必须基于热平衡的第一性原理以及经过充分检验的基本异速标度关系。假设该生物体维持恒定的核心体温。任务是预测在两种气候下，哪些网格单元在最冷和最热的代表性月份中均能量可行，然后汇总可行单元的数量。最终程序必须按规定产生一个单行输出字符串。\n\n您必须使用的基本原理：\n- 稳态热平衡：代谢产热等于维持恒定体温所需的干热交换和蒸发冷却之和。对于处于稳态的恒温动物，该平衡可以用速率（单位：瓦特）表示。干热交换遵循牛顿冷却定律：它与身体和环境之间的温度梯度成正比，比例系数由热导给出。\n- 基础代谢率 (BMR) 和最小热导的异速标度：基础代谢功率与体重的 3/4 次方成比例，最小干热导与体重的 2/3 次方成比例。这些是经过充分检验的经验关系，适合作为此处的基础。\n- 约束条件：\n  - 由于可持续的有氧范围，一天内的最大持续代谢功率存在上限，表示为基础代谢率的倍数。\n  - 每日摄入量存在上限，表示为一天内基础代謝率的倍数。\n  - 最大蒸发冷却能力也存在上限，表示为基础代谢率的倍数。\n\n需要实现的模型要素：\n- 设体重为 $m$，单位为 $\\mathrm{kg}$；核心体温为 $T_b$，单位为 $\\text{°C}$。\n- 设基础代谢功率为 $$B(m) = b_0 \\, m^{3/4}$$，单位为 $\\mathrm{W}$，其中 $b_0$ 是一个常数，单位为 $\\mathrm{W\\;kg^{-3/4}}$。\n- 设最小干热导为 $$C(m) = c_0 \\, m^{2/3}$$，单位为 $\\mathrm{W\\,^\\circ C^{-1}}$，其中 $c_0$ 是一个常数，单位为 $\\mathrm{W\\,^\\circ C^{-1}\\,kg^{-2/3}}$。\n- 设最大持续代谢功率为 $$M_{\\max} = e_{\\max} \\, B(m)$$，单位为 $\\mathrm{W}$，其中 $e_{\\max}$ 无量纲。\n- 设最大蒸发冷却能力为 $$E_{\\max} = e_{\\mathrm{evap}} \\, B(m)$$，单位为 $\\mathrm{W}$，其中 $e_{\\mathrm{evap}}$ 无量纲。\n- 设每日最大可同化能量为 $$E_{\\mathrm{intake,max}} = e_{\\mathrm{intake}} \\, B(m) \\, t_d$$，单位为 $\\mathrm{J}$，其中 $e_{\\mathrm{intake}}$ 无量纲，$t_d$ 是一天的秒数。\n- 对于环境温度为 $T_{\\mathrm{cold}}$（单位 $\\text{°C}$）的寒冷代表性月份，使用稳态热平衡和牛顿冷却定律来确定在全天维持 $T_b$ 所需的持续代谢功率。持续代谢功率不能低于 $B(m)$。每日能量需求是持续功率乘以 $t_d$，可行性要求其不超过 $E_{\\mathrm{intake,max}}$，且持续功率不超过 $M_{\\max}$。\n- 对于环境温度为 $T_{\\mathrm{hot}}$（单位 $\\text{°C}$）的炎热代表性月份，计算在产生至少基础代谢功率的同时为了维持 $T_b$ 所需的稳态蒸发冷却速率。可行性要求所需的蒸发冷却不超过 $E_{\\max}$。\n\n气候：\n- 网格是 $3 \\times 3$ 的月平均环境温度数组，单位为 $\\mathrm{^\\circ C}$：\n  - 当前寒冷月份网格 $T_{\\mathrm{cold}}^{\\mathrm{cur}}$：\n    - 行 $1$：$[5,8,6]$\n    - 行 $2$：$[10,12,11]$\n    - 行 $3$：$[15,17,14]$\n  - 当前炎热月份网格 $T_{\\mathrm{hot}}^{\\mathrm{cur}}$：\n    - 行 $1$：$[25,27,26]$\n    - 行 $2$：$[30,32,31]$\n    - 行 $3$：$[38,40,39]$\n  - 未来寒冷月份网格 $T_{\\mathrm{cold}}^{\\mathrm{fut}}$：\n    - 行 $1$：$[7,10,8]$\n    - 行 $2$：$[12,14,13]$\n    - 行 $3$：$[17,19,16]$\n  - 未来炎热月份网格 $T_{\\mathrm{hot}}^{\\mathrm{fut}}$：\n    - 行 $1$：$[26,28,27]$\n    - 行 $2$：$[32,34,33]$\n    - 行 $3$：$[40,42,41]$\n\n常量和单位：\n- 使用 $t_d = 86400$ 秒作为一天的时长。\n- 所有温度单位均为 $\\mathrm{^\\circ C}$。\n- 功率单位为 $\\mathrm{W}$，每日能量单位为 $\\mathrm{J}$。\n\n测试套件（三个生物体参数集）：\n- Case $1$ (小型哺乳动物，中等活动范围与摄入量)：\n  - $m = 0.1 \\ \\mathrm{kg}$, $T_b = 37 \\ \\mathrm{^\\circ C}$,\n  - $b_0 = 3.4 \\ \\mathrm{W\\,kg^{-3/4}}$, $c_0 = 0.5 \\ \\mathrm{W\\,^\\circ C^{-1}\\,kg^{-2/3}}$,\n  - $e_{\\max} = 7$, $e_{\\mathrm{evap}} = 3$, $e_{\\mathrm{intake}} = 6$.\n- Case $2$ (较大型哺乳动物，相似的活动范围與摄入量)：\n  - $m = 5.0 \\ \\mathrm{kg}$, $T_b = 37 \\ \\mathrm{^\\circ C}$,\n  - $b_0 = 3.4 \\ \\mathrm{W\\,kg^{-3/4}}$, $c_0 = 0.5 \\ \\mathrm{W\\,^\\circ C^{-1}\\,kg^{-2/3}}$,\n  - $e_{\\max} = 7$, $e_{\\mathrm{evap}} = 3$, $e_{\\mathrm{intake}} = 6$.\n- Case $3$ (摄入能力低的小型哺乳动物)：\n  - $m = 0.1 \\ \\mathrm{kg}$, $T_b = 37 \\ \\mathrm{^\\circ C}$,\n  - $b_0 = 3.4 \\ \\mathrm{W\\,kg^{-3/4}}$, $c_0 = 0.5 \\ \\mathrm{W\\,^\\circ C^{-1}\\,kg^{-2/3}}$,\n  - $e_{\\max} = 7$, $e_{\\mathrm{evap}} = 3$, $e_{\\mathrm{intake}} = 2$.\n\n每个网格单元的可行性规则：\n- 一个网格单元是可行的，当且仅当该生物体在该单元的寒冷月份和炎热月份条件下，根据稳态热平衡、牛顿冷却定律及上述约束条件所隐含的规则，均能量可行。\n\n所需输出和单位：\n- 对于每个测试用例，计算四个整数：\n  - $N_{\\mathrm{cur}}$：当前气候下可行单元的数量，\n  - $N_{\\mathrm{fut}}$：未来气候下可行单元的数量，\n  - $N_{\\mathrm{gain}}$：当前不可行但在未来可行的单元数量，\n  - $N_{\\mathrm{loss}}$：当前可行但在未来不可行的单元数量。\n- 所有四个值都是纯计数（无单位整数）。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个外部列表，该列表包含三个内部列表，每个测试用例一个，每个内部列表按 $[N_{\\mathrm{cur}},N_{\\mathrm{fut}},N_{\\mathrm{gain}},N_{\\mathrm{loss}}]$ 的顺序包含四个整数。\n- 输出不得包含任何空格。例如，一个语法上正确的形式是 $[[1,2,0,0],[9,9,0,0],[0,3,3,0]]$（这只是一个形式示例；不要重复使用这些数字）。\n\n角度单位不适用。百分比不使用。确保所有计算都遵守上述指定的物理单位，并且您的实现遵循所述的基本原理，而不是任何未提供的快捷公式。", "solution": "问题的核心是针对每个网格单元，确定一个假想的恒温动物在给定的最冷（$T_{\\mathrm{cold}}$）和最热（$T_{\\mathrm{hot}}$）月份的环境温度下，能否在生理约束下维持其核心体温 $T_b$。一个单元是可栖息的，当且仅当该生物体在这两种热环境场景下都是可行的。\n\n首先，我们根据生物体的体重 $m$ 建立其基本生理参数。\n基础代谢功率 $B$ 由以下异速关系给出：\n$$B(m) = b_0 \\, m^{3/4}$$\n最小干热导 $C$ 衡量了每单位温差下与环境的非蒸发性热交换速率，由以下公式给出：\n$$C(m) = c_0 \\, m^{2/3}$$\n这些基本参数 $B$ 和 $C$ 用于定义生物体的生理极限。最大持续代谢功率为 $M_{\\max} = e_{\\max} \\, B$。最大蒸发冷却能力为 $E_{\\max} = e_{\\mathrm{evap}} \\, B$。每日最大能量摄入为 $E_{\\mathrm{intake,max}} = e_{\\mathrm{intake}} \\, B \\, t_d$，其中 $t_d$ 是一天的秒数（$86400 \\, \\mathrm{s}$）。\n\n其次，我们推导寒冷环境下的可行性条件，此时环境温度为 $T_a = T_{\\mathrm{cold}}$。为维持恒定的体温 $T_b$，生物体必须产生代谢热以抵消向环境的干热损失。根据牛顿冷却定律，此干热损失为 $H_{\\text{dry}} = C \\cdot (T_b - T_a)$。假设在寒冷条件下蒸发冷却可忽略不计（这是低于热中性区条件下的标准简化假设），所需的代谢功率 $M_{\\mathrm{req,cold}}$ 必须平衡此损失：$M_{\\mathrm{req,cold}} = C \\cdot (T_b - T_{\\mathrm{cold}})$。然而，恒温动物的代谢率不能低于其基础水平 $B$。因此，在寒冷中维持的实际代谢功率 $M_{\\mathrm{cold}}$ 是：\n$$M_{\\mathrm{cold}} = \\max(B, C \\cdot (T_b - T_{\\mathrm{cold}}))$$\n为使生物体能够存活，此所需代谢功率不得超过其最大持续代谢功率 $M_{\\max}$。此外，一天所需的总能量 $E_{\\mathrm{daily}} = M_{\\mathrm{cold}} \\cdot t_d$ 不得超过每日最大可同化能量 $E_{\\mathrm{intake,max}}$。这两个约束可以表示为：\n$$M_{\\mathrm{cold}} \\le M_{\\max} = e_{\\max} \\, B$$\n$$M_{\\mathrm{cold}} \\cdot t_d \\le E_{\\mathrm{intake,max}} = e_{\\mathrm{intake}} \\, B \\, t_d \\implies M_{\\mathrm{cold}} \\le e_{\\mathrm{intake}} \\, B$$\n综合这两个条件，寒冷环境下的可行性必要条件是：\n$$M_{\\mathrm{cold}} \\le \\min(e_{\\max}, e_{\\mathrm{intake}}) \\cdot B$$\n代入 $M_{\\mathrm{cold}}$ 的表达式，完整的条件变为：\n$$\\max(B, C \\cdot (T_b - T_{\\mathrm{cold}})) \\le \\min(e_{\\max}, e_{\\mathrm{intake}}) \\cdot B$$\n\n第三，我们推导炎热环境下的可行性条件，此时 $T_a = T_{\\mathrm{hot}}$。在这种情况下，干热损失减少，如果 $T_{\\mathrm{hot}} > T_b$ 甚至可能变为热增益。生物体必须散发其代谢热。问题指定我们应在生物体处于其基础代谢率 $M=B$ 时计算所需的蒸发冷却，因为这代表了它必须处理的最小热负荷。稳态热平衡方程为 $M = H_{\\text{dry}} + E_{\\text{evap}}$，可得 $E_{\\text{evap}} = M - H_{\\text{dry}}$。因此，所需的蒸发冷却 $E_{\\mathrm{req,hot}}$ 为：\n$$E_{\\mathrm{req,hot}} = B - C \\cdot (T_b - T_{\\mathrm{hot}})$$\n如果此表达式为负（即，如果 $T_{\\mathrm{hot}}$ 足够低，以致干热损失超过基础产热），则不需要蒸发冷却，因此所需量为 $0$。因此，我们必须使用：\n$$E_{\\mathrm{req,hot}} = \\max(0, B - C \\cdot (T_b - T_{\\mathrm{hot}}))$$\n为使生物体能够存活，此所需冷却不得超过其生理极限 $E_{\\max}$。炎热月份的可行性条件是：\n$$E_{\\mathrm{req,hot}} \\le E_{\\max} = e_{\\mathrm{evap}} \\cdot B$$\n代入 $E_{\\mathrm{req,hot}}$ 的表达式，完整的条件是：\n$$\\max(0, B - C \\cdot (T_b - T_{\\mathrm{hot}})) \\le e_{\\mathrm{evap}} \\cdot B$$\n\n最后，我们综合这些条件来预测生物体的分布范围。对于三个测试用例中的每一个，我们首先计算生物体特定的参数 $B$ 和 $C$。然后，对于 $9$ 个网格单元中的每一个，我们应用当前和未来气候下的可行性规则。\n为当前气候计算一个可行性的布尔矩阵 $F^{\\mathrm{cur}}$，其中元素 $F^{\\mathrm{cur}}_{ij}$ 为真，当且仅当单元 $(i,j)$ 在其寒冷月份 ($T^{\\mathrm{cur}}_{\\mathrm{cold}, ij}$) 和炎热月份 ($T^{\\mathrm{cur}}_{\\mathrm{hot}, ij}$) 都可行。为未来气候计算一个类似的矩阵 $F^{\\mathrm{fut}}$。\n根据這些矩阵，计算所需的计数：\n- $N_{\\mathrm{cur}} = \\sum_{i,j} F^{\\mathrm{cur}}_{ij}$ (当前气候下可行单元的数量)\n- $N_{\\mathrm{fut}} = \\sum_{i,j} F^{\\mathrm{fut}}_{ij}$ (未来气候下可行单元的数量)\n- $N_{\\mathrm{gain}} = \\sum_{i,j} (\\neg F^{\\mathrm{cur}}_{ij} \\land F^{\\mathrm{fut}}_{ij})$ (增加的单元)\n- $N_{\\mathrm{loss}} = \\sum_{i,j} (F^{\\mathrm{cur}}_{ij} \\land \\neg F^{\\mathrm{fut}}_{ij})$ (失去的单元)", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes energetic feasibility and range limits for an endothermic organism\n    based on first principles of heat balance and allometric scaling.\n    \"\"\"\n\n    # Climate Grids\n    T_cold_cur = np.array([\n        [5, 8, 6],\n        [10, 12, 11],\n        [15, 17, 14]\n    ], dtype=float)\n\n    T_hot_cur = np.array([\n        [25, 27, 26],\n        [30, 32, 31],\n        [38, 40, 39]\n    ], dtype=float)\n\n    T_cold_fut = np.array([\n        [7, 10, 8],\n        [12, 14, 13],\n        [17, 19, 16]\n    ], dtype=float)\n\n    T_hot_fut = np.array([\n        [26, 28, 27],\n        [32, 34, 33],\n        [40, 42, 41]\n    ], dtype=float)\n\n    # Test suite: (m, T_b, b0, c0, e_max, e_evap, e_intake)\n    test_cases = [\n        # Case 1: small mammal, moderate scope and intake\n        (0.1, 37.0, 3.4, 0.5, 7.0, 3.0, 6.0),\n        # Case 2: larger mammal, similar scope and intake\n        (5.0, 37.0, 3.4, 0.5, 7.0, 3.0, 6.0),\n        # Case 3: small mammal with low intake capacity\n        (0.1, 37.0, 3.4, 0.5, 7.0, 3.0, 2.0)\n    ]\n\n    # Global constants\n    # t_d = 86400  # seconds in a day. Not explicitly needed if we work with powers.\n\n    all_results = []\n\n    for case in test_cases:\n        m, T_b, b0, c0, e_max, e_evap, e_intake = case\n\n        # --- Step 1: Calculate organism-specific parameters ---\n        # Basal Metabolic Power (W)\n        B = b0 * (m ** (3/4))\n        # Minimal Dry Thermal Conductance (W/°C)\n        C = c0 * (m ** (2/3))\n\n        def is_cell_feasible(T_cold, T_hot):\n            \"\"\"Checks feasibility for a single cell given its cold/hot month temps.\"\"\"\n            \n            # --- Step 2: Check cold month feasibility ---\n            # Required metabolic power to offset dry heat loss, not falling below BMR\n            M_cold_req = np.maximum(B, C * (T_b - T_cold))\n            \n            # Cold feasibility constraints:\n            # 1. Sustained power does not exceed max aerobic scope (M_max = e_max * B)\n            # 2. Daily energy requirement does not exceed max intake (M_cold <= e_intake * B)\n            cold_limit_factor = min(e_max, e_intake)\n            is_feasible_cold = (M_cold_req <= cold_limit_factor * B)\n\n            # --- Step 3: Check hot month feasibility ---\n            # Required evaporative cooling at basal metabolic rate\n            E_req_hot = np.maximum(0, B - C * (T_b - T_hot))\n\n            # Hot feasibility constraint: required cooling does not exceed max capacity\n            is_feasible_hot = (E_req_hot <= e_evap * B)\n\n            # Cell is feasible if and only if both conditions are met\n            return is_feasible_cold and is_feasible_hot\n\n        # --- Step 4: Compute feasibility grids ---\n        is_feasible_cur = np.zeros_like(T_cold_cur, dtype=bool)\n        is_feasible_fut = np.zeros_like(T_cold_fut, dtype=bool)\n\n        for i in range(T_cold_cur.shape[0]):\n            for j in range(T_cold_cur.shape[1]):\n                is_feasible_cur[i, j] = is_cell_feasible(T_cold_cur[i, j], T_hot_cur[i, j])\n                is_feasible_fut[i, j] = is_cell_feasible(T_cold_fut[i, j], T_hot_fut[i, j])\n\n        # --- Step 5: Aggregate results ---\n        N_cur = np.sum(is_feasible_cur)\n        N_fut = np.sum(is_feasible_fut)\n        \n        # N_gain: cells that are NOT feasible in current but ARE in future\n        N_gain = np.sum(np.logical_and(np.logical_not(is_feasible_cur), is_feasible_fut))\n        \n        # N_loss: cells that ARE feasible in current but ARE NOT in future\n        N_loss = np.sum(np.logical_and(is_feasible_cur, np.logical_not(is_feasible_fut)))\n        \n        all_results.append([N_cur, N_fut, N_gain, N_loss])\n\n    # --- Step 6: Format output ---\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, res))}]\" for res in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2516337"}]}