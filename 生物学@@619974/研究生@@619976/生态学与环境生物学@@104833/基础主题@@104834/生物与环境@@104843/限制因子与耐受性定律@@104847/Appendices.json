{"hands_on_practices": [{"introduction": "掌握限制因子概念的最佳起点是其最经典的表述：李比希最低量定律。本练习提供了一个动手实践的机会，将该定律定量地应用于一个常见的生态情景——浮游植物生长受到必需营养物质的限制。通过基于氮和磷的有效供应量计算潜在生长速率，您将直接确定实际的生长速率，并识别出制约该种群的单一营养物质 [@problem_id:2504508]。", "problem": "单一浮游植物物种在一个充分混合的中宇宙中生长，其中两种必需且不可替代的营养物质——溶解性无机氮（N）和磷（P）——以恒定浓度供应。现场测量报告的资源供给量为 $R_{N} = 5$ mmol N m$^{-3}$ 和 $R_{P} = 0.2$ mmol P m$^{-3}$。在此处相关的低浓度下，每种营养物质所贡献的潜在比增长率与其环境浓度大致成线性关系，其物种特异性系数分别为 $b_{N} = 0.1$ d$^{-1}$ 每 mmol N m$^{-3}$ 和 $b_{P} = 0.8$ d$^{-1}$ 每 mmol P m$^{-3}$。根据“对于必需且不可替代的资源，实际比增长率受限于相对于生物体需求而言最限制其生长的资源”（Liebig最低量定律）这一定义，确定该物种的预测比增长率，并指出哪种营养物质是限制性的。\n\n最终比增长率以 d$^{-1}$ 为单位表示，并将数值答案四舍五入至三位有效数字。在您的推理过程中，需说明哪种营养物质是限制性的，但最终答案只输入数值增长率（不含单位）。", "solution": "题干已经过严格评估，被认为是有效的。它在科学上是合理的，其依据是已确立的生态学原理——Liebig最低量定律，并提供了一套完整且一致的参数，足以得出一个唯一的、定量的解。题干中不存在逻辑矛盾、事实错误或含糊之处。我们开始求解。\n\n控制该系统的核心原理是Liebig最低量定律，该定律假定：对于必需且不可替代的资源，生物过程的总速率由相对于生物体需求而言供应量最少的资源所决定。在本题情境下，浮游植物的实际比增长率（记为 $\\mu$）受限于由每种营养物质单独支持的各潜在比增长率中的最小值。设 $\\mu_{N}$ 为由氮（$N$）限制的潜在增长率，$\\mu_{P}$ 为由磷（$P$）限制的潜在增长率。因此，实际增长率为：\n$$ \\mu = \\min(\\mu_{N}, \\mu_{P}) $$\n题目指出，潜在增长率与环境营养物浓度成线性关系。潜在比增长率的方程如下：\n$$ \\mu_{N} = b_{N} R_{N} $$\n$$ \\mu_{P} = b_{P} R_{P} $$\n其中 $R_{N}$ 和 $R_{P}$ 是资源浓度，$b_{N}$ 和 $b_{P}$ 是物种特异性增长系数。\n\n给定的参数如下：\n- 氮资源供给：$R_{N} = 5$ mmol N m$^{-3}$\n- 磷资源供给：$R_{P} = 0.2$ mmol P m$^{-3}$\n- 氮的增长系数：$b_{N} = 0.1$ d$^{-1}$ (mmol N m$^{-3}$)$^{-1}$\n- 磷的增长系数：$b_{P} = 0.8$ d$^{-1}$ (mmol P m$^{-3}$)$^{-1}$\n\n现在我们计算每种营养物质对应的潜在比增长率。\n\n对于氮：\n$$ \\mu_{N} = b_{N} R_{N} = (0.1 \\text{ d}^{-1} (\\text{mmol N m}^{-3})^{-1}) \\times (5 \\text{ mmol N m}^{-3}) = 0.5 \\text{ d}^{-1} $$\n对于磷：\n$$ \\mu_{P} = b_{P} R_{P} = (0.8 \\text{ d}^{-1} (\\text{mmol P m}^{-3})^{-1}) \\times (0.2 \\text{ mmol P m}^{-3}) = 0.16 \\text{ d}^{-1} $$\n应用Liebig定律，我们比较这两个潜在增长率，以确定浮游植物物种的实际比增长率：\n$$ \\mu = \\min(\\mu_{N}, \\mu_{P}) = \\min(0.5 \\text{ d}^{-1}, 0.16 \\text{ d}^{-1}) $$\n这两个值中的最小值是 $0.16 \\text{ d}^{-1}$。\n$$ \\mu = 0.16 \\text{ d}^{-1} $$\n因为由磷支持的潜在增长率 $\\mu_{P}$ 低于由氮支持的潜在增长率 $\\mu_{N}$，我们得出结论：在指定条件下，磷是该浮游植物物种的限制性营养物质。\n\n题目要求最终的比增长率以 d$^{-1}$ 为单位，并保留三位有效数字。计算值为 $0.16$。为用三位有效数字表示此值，我们必须在末尾添加一个零，此处的零是有效位。因此，比增长率为 $0.160$ d$^{-1}$。", "answer": "$$\\boxed{0.160}$$", "id": "2504508"}, {"introduction": "除了资源的可利用性，生物的成功还取决于其对环境条件的耐受能力，这一原则被谢尔福德耐受性定律所概括。本实践将挑战您扮演生态学家的角色，分析一组关于生物体在温度梯度上表现的原始数据集。通过对一个假设的温度性能曲线进行简单的线性建模，您将估算出关键的最低和最高温度耐受限$T_L$和$T_U$，从而量化物种基本生态位的边界 [@problem_id:2504494]。", "problem": "一种外温水生无脊椎动物的种群净增长率表现出热性能曲线，该曲线以无量纲的相对性能 $P$ 来衡量，在观测到的最适温度下归一化为 $P=1$。根据 Shelford 的耐受性定律，种群仅在有限的环境范围内持续存在，其耐受性下限和上限由关键性能指标降至临界阈值时的温度所定义。在此，将低温和高温耐受极限 $T_{\\mathrm{L}}$ 和 $T_{\\mathrm{U}}$ 定义为相对性能等于操作阈值 $P_{\\mathrm{th}}=0.05$ 时的温度。\n\n经验测量提供了以下温度和相对性能的配对数据：温度 $T=\\{10,15,20,25,30\\}$（单位为 $^{\\circ}\\text{C}$）以及对应的相对性能 $P=\\{0.1,0.5,1.0,0.6,0.1\\}$（无量纲）。假设在观测到的温度之间，性能-温度关系是分段线性的，并且在超出观测极值范围时，以最邻近段的斜率作为一阶局部近似，继续呈线性变化。在这些假设下，通过求解相关分段上的适当线性关系，确定在阈值 $P_{\\mathrm{th}}=0.05$ 时的 $T_{\\mathrm{L}}$ 和 $T_{\\mathrm{U}}$ 的估计值。\n\n以 $^{\\circ}\\text{C}$ 为单位表示您的最终温度，按 $\\left(T_{\\mathrm{L}},T_{\\mathrm{U}}\\right)$ 的顺序排列。将您的答案四舍五入到 $3$ 位有效数字。", "solution": "本题要求确定一个外温生物的低温和高温耐受极限，即 $T_{\\mathrm{L}}$ 和 $T_{\\mathrm{U}}$。这些极限对应于相对性能 $P$ 下降到指定阈值 $P_{\\mathrm{th}} = 0.05$ 时的温度。温度 $T$ 和性能 $P$ 之间的关系被建模为一个基于离散经验数据集的分段线性函数。\n\n所提供的数据点 $(T, P)$ 为：$(10, 0.1)$、$(15, 0.5)$、$(20, 1.0)$、$(25, 0.6)$ 和 $(30, 0.1)$。该模型假设在这些点之间呈线性行为，并在超出观测温度范围（$T<10\\,^{\\circ}\\text{C}$ 和 $T>30\\,^{\\circ}\\text{C}$）时，使用最邻近段的斜率进行线性外推。\n\n首先，我们确定低温耐受极限 $T_{\\mathrm{L}}$。该极限位于热最适值（$T=20\\,^{\\circ}\\text{C}$）的较冷一侧。我们所寻求的性能值 $P_{\\mathrm{th}}=0.05$ 低于在这一侧观测到的最低性能，即在 $T=10\\,^{\\circ}\\text{C}$ 时的 $P=0.1$。因此，我们必须根据由两个最冷数据点$(T_1, P_1) = (10, 0.1)$ 和 $(T_2, P_2) = (15, 0.5)$定义的线段来外推线性趋势。\n\n此线段的斜率 $m_{\\mathrm{L}}$ 计算如下：\n$$\nm_{\\mathrm{L}} = \\frac{P_2 - P_1}{T_2 - T_1} = \\frac{0.5 - 0.1}{15 - 10} = \\frac{0.4}{5} = 0.08\n$$\n对于 $T \\le 10\\,^{\\circ}\\text{C}$，从此线段延伸出的直线方程由点斜式给出，使用点 $(T_1, P_1)$：\n$$\nP(T) - P_1 = m_{\\mathrm{L}}(T - T_1)\n$$\n我们求解当 $P(T_{\\mathrm{L}}) = P_{\\mathrm{th}} = 0.05$ 时的温度 $T_{\\mathrm{L}}$。代入数值：\n$$\n0.05 - 0.1 = 0.08 (T_{\\mathrm{L}} - 10)\n$$\n求解 $T_{\\mathrm{L}}$：\n$$\n-0.05 = 0.08 T_{\\mathrm{L}} - 0.8\n$$\n$$\n0.08 T_{\\mathrm{L}} = 0.8 - 0.05 = 0.75\n$$\n$$\nT_{\\mathrm{L}} = \\frac{0.75}{0.08} = \\frac{75}{8} = 9.375 \\,^{\\circ}\\text{C}\n$$\n\n接下来，我们确定高温耐受极限 $T_{\\mathrm{U}}$。该极限位于最适值的较暖一侧。目标性能 $P_{\\mathrm{th}}=0.05$ 低于在这一侧观测到的最低性能，即在 $T=30\\,^{\\circ}\\text{C}$ 时的 $P=0.1$。因此，我们必须根据由两个最暖数据点 $(T_3, P_3) = (25, 0.6)$ 和 $(T_4, P_4) = (30, 0.1)$ 定义的线段进行外推。\n\n此线段的斜率 $m_{\\mathrm{U}}$ 是：\n$$\nm_{\\mathrm{U}} = \\frac{P_4 - P_3}{T_4 - T_3} = \\frac{0.1 - 0.6}{30 - 25} = \\frac{-0.5}{5} = -0.1\n$$\n对于 $T \\ge 30\\,^{\\circ}\\text{C}$，从此线段延伸出的直线方程由点斜式给出，使用点 $(T_4, P_4)$：\n$$\nP(T) - P_4 = m_{\\mathrm{U}}(T - T_4)\n$$\n我们求解当 $P(T_{\\mathrm{U}}) = P_{\\mathrm{th}} = 0.05$ 时的温度 $T_{\\mathrm{U}}$。代入数值：\n$$\n0.05 - 0.1 = -0.1 (T_{\\mathrm{U}} - 30)\n$$\n求解 $T_{\\mathrm{U}}$：\n$$\n-0.05 = -0.1 T_{\\mathrm{U}} + 3\n$$\n$$\n0.1 T_{\\mathrm{U}} = 3 + 0.05 = 3.05\n$$\n$$\nT_{\\mathrm{U}} = \\frac{3.05}{0.1} = 30.5 \\,^{\\circ}\\text{C}\n$$\n\n题目要求最终答案四舍五入到 $3$ 位有效数字。\n计算出的下限值为 $T_{\\mathrm{L}} = 9.375$，四舍五入到 $9.38$。\n计算出的上限值为 $T_{\\mathrm{U}} = 30.5$，已经是 $3$ 位有效数字。\n\n因此，估计的耐受极限为 $T_{\\mathrm{L}} \\approx 9.38\\,^{\\circ}\\text{C}$ 和 $T_{\\mathrm{U}} = 30.5\\,^{\\circ}\\text{C}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n9.38 & 30.5\n\\end{pmatrix}\n}\n$$", "id": "2504494"}, {"introduction": "在真实的生物系统中，识别限制的来源可能非常复杂，常涉及外部供应与内部调控之间的动态相互作用。这个高阶的、数据驱动的练习将让您扮演植物生态生理学家的角色，分析植物在水分利用上的权衡。通过实施一个简单的水力模型并分析全天数据，您将估算植物的水力导度$K_{sp}$，并诊断蒸腾作用主要是受土壤-植物水分供应的限制，还是受植物自身气孔调节的限制 [@problem_id:2504512]。", "problem": "给定叶片的日气孔导度、叶片水势和饱和水汽压差的时间序列。假设在测量的时间分辨率内，土壤-植物连续体内的水分流动处于稳态，在该观测时间尺度上内部水分储存可忽略不计，且叶片处的气相和液相通量相平衡。使用以下基本原理：\n\n- 植物水分通量的质量守恒：在稳态下，液相通量等于气相通量。\n- 植物水力学的类达西关系：土壤和叶片之间的稳态液相水通量 $E$ (单位为 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$) 遵循 $E = K_{\\mathrm{sp}} \\, \\Delta \\Psi$，其中 $K_{\\mathrm{sp}}$ 是土壤-植物整体水力导度 (单位为 $\\mathrm{mol\\,m^{-2}\\,s^{-1}\\,MPa^{-1}}$)，$\\Delta \\Psi = \\Psi_{\\mathrm{soil}} - \\Psi_{\\mathrm{leaf}}$ (单位为 $\\mathrm{MPa}$)。\n- 叶片处的气相通量：$E = g_s \\, D$，其中 $g_s$ (单位为 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$) 是对水蒸气的气孔导度，而 $D$ 是以摩尔分数表示的饱和水汽压差 (VPD) (无量纲)。此处的饱和水汽压差 (VPD) 定义为叶温下饱和状态与环境空气之间的水蒸气摩尔分数之差。\n\n从这些基本原理出发，在截距为 $0$ 且偏差源于测量噪声的假设下，使用关系式 $E = K_{\\mathrm{sp}} \\, \\Delta \\Psi$ 推导 $K_{\\mathrm{sp}}$ 的估计量。然后，对每个时间点，通过使用容差带比较水力供应能力 $K_{\\mathrm{sp}} \\, \\Delta \\Psi$ 和气孔需求 $g_s \\, D$，推断其限制因素。定义无量纲诊断量 $\\phi = \\dfrac{K_{\\mathrm{sp}} \\, \\Delta \\Psi}{g_s \\, D}$。将一个时间点分类为：\n- 若 $\\phi > 1 + \\tau$，则为气孔调节限制，\n- 若 $\\phi < 1 - \\tau$，则为水分供应限制，\n- 若 $1 - \\tau \\le \\phi \\le 1 + \\tau$，则为共同限制，\n\n其中 $\\tau$ 是一个小的正阈值。报告每个数据集中落入每个类别的时间点所占的比例。\n\n实现一个程序，对以下三个测试用例执行这些步骤。对于每个测试用例，计算每个时间点 $i$ 的 $E_i = g_{s,i} \\, D_i$，构建 $\\Delta \\Psi_i = \\Psi_{\\mathrm{soil}} - \\Psi_{\\mathrm{leaf},i}$，通过拟合一个 $E$ 对 $\\Delta \\Psi$ 的零截距线性模型来估计 $K_{\\mathrm{sp}}$，然后通过 $\\phi_i$ 和 $\\tau$ 对每个时间点的限制因素进行分类。在整个过程中使用指定的单位。将 $K_{\\mathrm{sp}}$ 以 $\\mathrm{mol\\,m^{-2}\\,s^{-1}\\,MPa^{-1}}$ 表示，输出的比例以小数表示（而非百分比）。\n\n测试套件 (数组按从黎明到黄昏的顺序排列)：\n\n- 测试用例 1 (普遍情况，以气孔调节为主，且至少有一个接近供应限制点)：\n  - $\\Psi_{\\mathrm{soil}} = -0.2 \\,\\mathrm{MPa}$\n  - $D = [\\,0.004,\\,0.008,\\,0.015,\\,0.025,\\,0.030,\\,0.022,\\,0.012,\\,0.005\\,]$ (无量纲)\n  - $g_s = [\\,0.08,\\,0.12,\\,0.20,\\,0.25,\\,0.22,\\,0.18,\\,0.10,\\,0.06\\,] \\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$\n  - $\\Psi_{\\mathrm{leaf}} = [\\,-0.264,\\,-0.392,\\,-0.68,\\,-0.825,\\,-1.124,\\,-0.8336,\\,-0.44,\\,-0.26\\,] \\,\\mathrm{MPa}$\n  - $\\tau = 0.05$ (无量纲)\n\n- 测试用例 2 (以水分供应限制为主，偏差较小)：\n  - $\\Psi_{\\mathrm{soil}} = -0.2 \\,\\mathrm{MPa}$\n  - $D = [\\,0.004,\\,0.008,\\,0.015,\\,0.025,\\,0.030,\\,0.022,\\,0.012,\\,0.005\\,]$ (无量纲)\n  - $g_s = [\\,0.08,\\,0.12,\\,0.20,\\,0.25,\\,0.22,\\,0.18,\\,0.10,\\,0.06\\,] \\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$\n  - $\\Psi_{\\mathrm{leaf}} = [\\,-0.2304,\\,-0.2864,\\,-0.47,\\,-0.79375,\\,-0.794,\\,-0.5564,\\,-0.314,\\,-0.2285\\,] \\,\\mathrm{MPa}$\n  - $\\tau = 0.05$ (无量纲)\n\n- 测试用例 3 (一天中大部分时间接近共同限制)：\n  - $\\Psi_{\\mathrm{soil}} = -0.2 \\,\\mathrm{MPa}$\n  - $D = [\\,0.004,\\,0.008,\\,0.015,\\,0.025,\\,0.030,\\,0.022,\\,0.012,\\,0.005\\,]$ (无量纲)\n  - $g_s = [\\,0.08,\\,0.12,\\,0.20,\\,0.25,\\,0.22,\\,0.18,\\,0.10,\\,0.06\\,] \\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$\n  - $\\Psi_{\\mathrm{leaf}} = [\\,-0.23264,\\,-0.29408,\\,-0.509,\\,-0.81875,\\,-0.8666,\\,-0.596,\\,-0.3164,\\,-0.2312\\,] \\,\\mathrm{MPa}$\n  - $\\tau = 0.05$ (无量纲)\n\n要求的输出和单位：\n- 对于每个测试用例，按顺序输出四个数字：估计的 $K_{\\mathrm{sp}}$ (单位为 $\\mathrm{mol\\,m^{-2}\\,s^{-1}\\,MPa^{-1}}$)，保留 $5$ 位小数；水分供应限制的时间点所占的比例 (小数)，保留 $3$ 位小数；气孔调节限制的时间点所占的比例 (小数)，保留 $3$ 位小数；以及共同限制的时间点所占的比例 (小数)，保留 $3$ 位小数。\n- 将所有测试用例的结果汇总到一个包含 $12$ 个数字的扁平列表中，顺序为测试用例 $1$ 到 $3$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表 (例如：$[\\,\\text{result}_1,\\text{result}_2,\\ldots\\,]$)。", "solution": "提交分析的问题陈述已经过严格验证。首先，所有给定条件，包括所有物理模型、参数、数据时间序列和程序指令，均已逐字提取。然后，根据所需标准对问题进行了评估。\n\n结论是该问题 **有效 (valid)**。\n\n该问题在科学上基于公认的植物水力学和气孔生理学原理，特别是水分输运的欧姆定律类比。该模型是一种简化，但却是标准且有用的模型。它是一个适定问题 (well-posed)，提供了明确的目标和一套完整、一致的数据与定义，从而可以得到唯一解。其语言客观而精确。所有单位在量纲上都是一致的。测试用例中提供的数据对于植物在一天内的日变化是物理上合理的。不存在逻辑矛盾、未满足的前提或其他致命缺陷。因此，我将继续进行推导和求解。\n\n问题的核心在于关联植物叶片稳态水通量 $E$ 的两个表达式。气相通量，或称“气孔需求”，由下式给出：\n$$\nE = g_s D\n$$\n其中 $g_s$ 是对水蒸气的气孔导度 (单位为 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$)，$D$ 是叶片-空气饱和水汽压差 (无量纲摩尔分数)。液相通量，或称“水力供应”，由一个类达西关系描述：\n$$\nE = K_{\\mathrm{sp}} \\Delta \\Psi\n$$\n其中 $K_{\\mathrm{sp}}$ 是土壤-植物水力导度 (单位为 $\\mathrm{mol\\,m^{-2}\\,s^{-1}\\,MPa^{-1}}$)，而 $\\Delta \\Psi = \\Psi_{\\mathrm{soil}} - \\Psi_{\\mathrm{leaf}}$ 是土壤和叶片之间的水势差 ($\\mathrm{MPa}$)。\n\n第一个任务是估计 $K_{\\mathrm{sp}}$。我们获得了 $g_s$、$D$ 和 $\\Psi_{\\mathrm{leaf}}$ 的时间序列数据，以及 $\\Psi_{\\mathrm{soil}}$ 的一个恒定值。问题指定了一个 $E$ 对 $\\Delta\\Psi$ 的零截距线性模型。我们首先根据气体交换数据计算每个时间点 $i$ 的“观测”通量 $E_i = g_{s,i} D_i$。我们还计算水势差 $\\Delta\\Psi_i = \\Psi_{\\mathrm{soil}} - \\Psi_{\\mathrm{leaf},i}$。\n\n需要拟合的模型是 $E = K_{\\mathrm{sp}} \\Delta\\Psi$。这是一个通过原点的线性回归。使残差平方和 $S(K_{\\mathrm{sp}}) = \\sum_{i} (E_i - K_{\\mathrm{sp}}\\Delta\\Psi_i)^2$ 最小化的斜率 $K_{\\mathrm{sp}}$ 的值，可以通过将其关于 $K_{\\mathrm{sp}}$ 的导数置零来找到：\n$$\n\\frac{dS}{dK_{\\mathrm{sp}}} = \\sum_{i} 2(E_i - K_{\\mathrm{sp}}\\Delta\\Psi_i)(-\\Delta\\Psi_i) = 0\n$$\n求解 $K_{\\mathrm{sp}}$ 可得普通最小二乘估计量：\n$$\n\\hat{K}_{\\mathrm{sp}} = \\frac{\\sum_{i} E_i \\Delta\\Psi_i}{\\sum_{i} (\\Delta\\Psi_i)^2}\n$$\n这个单一的 $\\hat{K}_{\\mathrm{sp}}$ 值代表了整个数据集的估计整体水力导度。\n\n第二个任务是为每个时间点分类蒸腾作用的限制因素。问题定义了一个无量纲诊断量 $\\phi$，即潜在水力供应与气孔需求 (实际通量) 的比值：\n$$\n\\phi_i = \\frac{\\text{Potential Supply}_i}{\\text{Actual Flux}_i} = \\frac{\\hat{K}_{\\mathrm{sp}} \\Delta\\Psi_i}{g_{s,i}D_i}\n$$\n注意到分母就是观测通量 $E_i$。$\\phi_i = 1$ 的值表示我们拟合模型预测的供应能力与观测通量之间达到完美平衡。偏离 $1$ 则表明存在潜在限制。使用给定的容差阈值 $\\tau$，我们按如下方式对每个时间点 $i$ 进行分类：\n- **气孔调节限制**：若 $\\phi_i > 1 + \\tau$，水力系统能够供应的水量超过了气孔允许排出的水量。气孔是蒸腾作用的主要限制因素。\n- **水分供应限制**：若 $\\phi_i < 1 - \\tau$，气孔需求的水量超过了水力系统在该水势梯度下能够供应的水量。水力传导路径是主要限制因素。\n- **共同限制**：若 $1 - \\tau \\le \\phi_i \\le 1 + \\tau$，供应和需求在容差 $\\tau$ 范围内近似平衡。\n\n每个测试用例的计算步骤如下：\n1.  对于每个时间点 $i=1, \\dots, n$，计算通量 $E_i = g_{s,i} D_i$ 和水势降 $\\Delta\\Psi_i = \\Psi_{\\mathrm{soil}} - \\Psi_{\\mathrm{leaf},i}$。\n2.  使用 $E$ 和 $\\Delta\\Psi$ 的这些向量，通过上面推导的公式计算单一估计值 $\\hat{K}_{\\mathrm{sp}}$。\n3.  对于每个时间点 $i$，计算诊断量 $\\phi_i = (\\hat{K}_{\\mathrm{sp}} \\Delta\\Psi_i) / E_i$。\n4.  根据 $\\phi_i$ 相对于界限 $1 \\pm \\tau$ 的值，统计落入三个限制类别中每个类别的时间点数量。\n5.  通过将计数除以总时间点数 $n$ 来计算每个类别的比例。\n6.  每个测试用例的结果是：估计的 $\\hat{K}_{\\mathrm{sp}}$ (保留 $5$ 位小数) 以及三个比例 (水分供应限制、气孔调节限制、共同限制) (保留 $3$ 位小数)。将所有测试用例的这四种值汇总到一个扁平列表中，作为最终输出。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the plant hydraulics problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"psi_soil\": -0.2, # MPa\n            \"D\": np.array([0.004, 0.008, 0.015, 0.025, 0.030, 0.022, 0.012, 0.005]), # dimensionless\n            \"g_s\": np.array([0.08, 0.12, 0.20, 0.25, 0.22, 0.18, 0.10, 0.06]), # mol m^-2 s^-1\n            \"psi_leaf\": np.array([-0.264, -0.392, -0.68, -0.825, -1.124, -0.8336, -0.44, -0.26]), # MPa\n            \"tau\": 0.05, # dimensionless\n        },\n        {\n            \"psi_soil\": -0.2,\n            \"D\": np.array([0.004, 0.008, 0.015, 0.025, 0.030, 0.022, 0.012, 0.005]),\n            \"g_s\": np.array([0.08, 0.12, 0.20, 0.25, 0.22, 0.18, 0.10, 0.06]),\n            \"psi_leaf\": np.array([-0.2304, -0.2864, -0.47, -0.79375, -0.794, -0.5564, -0.314, -0.2285]),\n            \"tau\": 0.05,\n        },\n        {\n            \"psi_soil\": -0.2,\n            \"D\": np.array([0.004, 0.008, 0.015, 0.025, 0.030, 0.022, 0.012, 0.005]),\n            \"g_s\": np.array([0.08, 0.12, 0.20, 0.25, 0.22, 0.18, 0.10, 0.06]),\n            \"psi_leaf\": np.array([-0.23264, -0.29408, -0.509, -0.81875, -0.8666, -0.596, -0.3164, -0.2312]),\n            \"tau\": 0.05,\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        psi_soil = case[\"psi_soil\"]\n        D = case[\"D\"]\n        g_s = case[\"g_s\"]\n        psi_leaf = case[\"psi_leaf\"]\n        tau = case[\"tau\"]\n\n        # Step 1: Calculate E (vapor-phase flux)\n        E = g_s * D\n\n        # Step 2: Calculate delta_psi (water potential difference)\n        delta_psi = psi_soil - psi_leaf\n\n        # Step 3: Estimate K_sp using zero-intercept linear regression\n        # K_sp = (sum(E_i * delta_psi_i)) / (sum(delta_psi_i^2))\n        k_sp = np.dot(E, delta_psi) / np.dot(delta_psi, delta_psi)\n\n        # Step 4: Calculate the diagnostic phi for each timepoint\n        # phi = (K_sp * delta_psi) / E\n        phi = (k_sp * delta_psi) / E\n\n        # Step 5: Classify each timepoint and calculate fractions\n        n = len(E)\n        lower_bound = 1 - tau\n        upper_bound = 1 + tau\n\n        supply_limited_count = np.sum(phi  lower_bound)\n        stomatal_limited_count = np.sum(phi > upper_bound)\n        co_limited_count = np.sum((phi >= lower_bound)  (phi = upper_bound))\n\n        frac_supply_limited = supply_limited_count / n\n        frac_stomatal_limited = stomatal_limited_count / n\n        frac_co_limited = co_limited_count / n\n        \n        # Append results for this case to the main list\n        all_results.extend([k_sp, frac_supply_limited, frac_stomatal_limited, frac_co_limited])\n\n    # Format the final output string as required\n    formatted_results = []\n    for i, res in enumerate(all_results):\n        if i % 4 == 0:  # K_sp\n            formatted_results.append(f\"{res:.5f}\")\n        else:  # Fractions\n            formatted_results.append(f\"{res:.3f}\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2504512"}]}