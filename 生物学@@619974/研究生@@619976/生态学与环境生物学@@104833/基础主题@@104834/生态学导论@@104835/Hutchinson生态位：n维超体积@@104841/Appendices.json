{"hands_on_practices": [{"introduction": "生态学的一个核心概念是将物种的“基础生态位”（能够生存的环境条件集合）与“现实生态位”（实际占据的环境）区分开来。扩散限制是造成这种差异的主要原因之一。本练习提供了一个基于第一性原理的具体计算，旨在量化一个简单的地理障碍如何系统性地偏离我们对生态位中心的估计，从而加深对野外数据如何反映被截断生态位的理解。[@problem_id:2498812]", "problem": "一个物种的基本赫钦森生态位在环境空间 $\\mathbb{R}^{2}$ 中由一个实心椭圆表示\n$$\nH \\;=\\; \\left\\{ (e_{1},e_{2}) \\in \\mathbb{R}^{2} \\;:\\; \\frac{(e_{1}-\\mu_{1})^{2}}{a^{2}} + \\frac{(e_{2}-\\mu_{2})^{2}}{b^{2}} \\,\\le\\, 1 \\right\\},\n$$\n其质心位于 $\\mu \\,=\\, (\\mu_{1},\\mu_{2}) \\,=\\, (0,0)$，半轴为 $a \\,>\\, 0$ 和 $b \\,>\\, 0$。设环境-地理映射 $\\varphi$ 在重缩放后为恒等映射，因此对于所有 $g \\in \\mathbb{R}^{2}$ 都有 $\\varphi(g) \\,=\\, g$；因此，$\\varphi^{-1}(H) \\,=\\, H$。一个扩散障碍 $M$ 排除了所有第一坐标为负的地理位置，即 $M \\,=\\, \\{(x,y) \\in \\mathbb{R}^{2} : x \\,\\ge\\, 0\\}$，因此只有 $\\varphi^{-1}(H)$ 的右半部分得以实现。假设实现的出现点在 $R \\,=\\, \\varphi^{-1}(H) \\cap M$ 上均匀分布。\n\n一种常见的基于质心的生态位中心估计量使用实现的环境向量的样本均值。在无限采样的情况下，该估计量收敛于环境空间中实现集的几何质心。仅从上述定义和将几何质心计算为适当面积分的第一性原理出发，推导期望估计量并量化其相对于真实质心 $\\mu$ 的偏差。具体来说，计算偏差向量的欧几里得范数\n$$\n\\|\\mathbb{E}[\\hat{\\mu}] - \\mu\\|_{2}\n$$\n并用 $a$ 和 $b$ 表示为一个闭式表达式。\n\n您的最终答案必须是单个闭式解析表达式。不应包含单位。不要提供不等式或方程式。如果必须简化任何常数，请以符号形式进行；本问题不需要进行数值舍入。", "solution": "对问题陈述进行严格评估如下。\n\n**步骤1：提取已知条件**\n-   基本赫钦森生态位是环境空间 $\\mathbb{R}^{2}$ 中的一个实心椭圆 $H$：\n    $$H \\;=\\; \\left\\{ (e_{1},e_{2}) \\in \\mathbb{R}^{2} \\;:\\; \\frac{(e_{1}-\\mu_{1})^{2}}{a^{2}} + \\frac{(e_{2}-\\mu_{2})^{2}}{b^{2}} \\,\\le\\, 1 \\right\\}$$\n-   生态位的真实质心是 $\\mu \\,=\\, (\\mu_{1},\\mu_{2}) \\,=\\, (0,0)$。\n-   椭圆的半轴为 $a \\,>\\, 0$ 和 $b \\,>\\, 0$。\n-   环境-地理映射是恒等映射，$\\varphi(g) \\,=\\, g$，这意味着潜在分布与生态位相同，即 $\\varphi^{-1}(H) \\,=\\, H$。\n-   扩散障碍 $M$ 将物种限制在地理区域 $M \\,=\\, \\{(x,y) \\in \\mathbb{R}^{2} : x \\,\\ge\\, 0\\}$。\n-   实现分布 $R$ 是潜在分布和可及区域的交集：$R \\,=\\, \\varphi^{-1}(H) \\cap M \\,=\\, H \\cap M$。\n-   实现的出现点在 $R$ 上均匀分布。\n-   在无限采样下，生态位质心的估计量 $\\hat{\\mu}$ 收敛于实现集 $R$ 的几何质心，我们将其表示为 $\\mathbb{E}[\\hat{\\mu}]$。\n-   任务是计算偏差向量的欧几里得范数，$\\|\\mathbb{E}[\\hat{\\mu}] - \\mu\\|_{2}$。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题使用了一个公认的生态学概念——赫钦森生态位，并采用标准的几何和分析工具（椭圆、质心、积分）对其进行建模。由于扩散障碍导致的基本生态位与实现生态位之间的区别是生态学的核心课题。该问题是对生态位截断的一个简化但科学上有效的表示。\n-   **适定性：** 该问题提供了确定唯一解所需的所有必要定义和约束。无限采样的假设将估计问题简化为对几何质心的确定性计算。定义清晰且在数学上是形式化的。\n-   **客观性：** 语言是形式化和定量的。没有主观或基于观点的陈述。\n\n**步骤3：结论与行动**\n该问题是有效的。它具有科学依据、适定性、客观性并且是自洽的。现在将推导完整解。\n\n**解的推导**\n基本生态位的真实质心给定为 $\\mu = (0,0)$。在无限采样下的估计量 $\\mathbb{E}[\\hat{\\mu}]$ 是实现生态位 $R$ 的几何质心。实现生态位 $R$ 是椭圆\n$$ \\frac{e_{1}^{2}}{a^{2}} + \\frac{e_{2}^{2}}{b^{2}} \\le 1 $$\n中第一坐标为非负（即 $e_{1} \\ge 0$）的部分。这对应于以原点为中心的实心椭圆的右半部分。\n\n区域 $R$ 的几何质心坐标，我们记为 $(\\hat{\\mu}_{1}, \\hat{\\mu}_{2}) = \\mathbb{E}[\\hat{\\mu}]$，由以下公式给出：\n$$ \\hat{\\mu}_{1} = \\frac{\\iint_{R} e_{1} \\,dA}{\\iint_{R} dA} \\quad \\text{和} \\quad \\hat{\\mu}_{2} = \\frac{\\iint_{R} e_{2} \\,dA}{\\iint_{R} dA} $$\n其中 $dA = de_{1}de_{2}$。\n\n首先，我们计算分母，即区域 $R$ 的面积。完整椭圆 $H$ 的面积是 $\\pi ab$。由于 $R$ 恰好是椭圆的一半，其面积为：\n$$ \\text{Area}(R) = \\iint_{R} dA = \\frac{1}{2} \\pi a b $$\n\n接下来，我们计算 $\\hat{\\mu}_{2}$ 的分子。区域 $R$ 关于 $e_{1}$ 轴（直线 $e_{2}=0$）对称。被积函数 $f(e_{1},e_{2})=e_{2}$ 是关于 $e_{2}$ 的奇函数。因此，奇函数在对称域上的积分为零：\n$$ \\iint_{R} e_{2} \\,dA = 0 $$\n这意味着质心的第二坐标为 $\\hat{\\mu}_{2} = 0$。由于区域的对称性，这是预料之中的。\n\n现在，我们计算 $\\hat{\\mu}_{1}$ 的分子：\n$$ \\iint_{R} e_{1} \\,dA = \\iint_{R} e_{1} \\,de_{1}de_{2} $$\n我们可以在椭圆的右半部分上建立积分。$e_{1}$ 的界限是从 $0$ 到 $a$。对于给定的 $e_{1}$，$e_{2}$ 的界限是从 $-b\\sqrt{1-e_{1}^2/a^2}$ 到 $+b\\sqrt{1-e_{1}^2/a^2}$。\n$$ \\iint_{R} e_{1} \\,dA = \\int_{0}^{a} \\left( \\int_{-b\\sqrt{1-e_{1}^{2}/a^{2}}}^{b\\sqrt{1-e_{1}^{2}/a^{2}}} e_{1} \\,de_{2} \\right) de_{1} $$\n对 $e_{2}$ 进行积分：\n$$ \\int_{0}^{a} e_{1} \\left[ e_{2} \\right]_{-b\\sqrt{1-e_{1}^{2}/a^{2}}}^{b\\sqrt{1-e_{1}^{2}/a^{2}}} \\,de_{1} = \\int_{0}^{a} e_{1} \\left( 2b\\sqrt{1-\\frac{e_{1}^{2}}{a^{2}}} \\right) de_{1} = 2b \\int_{0}^{a} e_{1} \\sqrt{1-\\frac{e_{1}^{2}}{a^{2}}} \\,de_{1} $$\n为求解此积分，我们使用换元法，令 $u = 1 - \\frac{e_{1}^{2}}{a^{2}}$。这得到 $du = -\\frac{2e_{1}}{a^{2}}de_{1}$，或 $e_{1}de_{1} = -\\frac{a^{2}}{2}du$。积分上下限从 $e_{1}=0$ 变为 $u=1$，从 $e_{1}=a$ 变为 $u=0$。\n$$ 2b \\int_{1}^{0} \\sqrt{u} \\left( -\\frac{a^{2}}{2} \\right) du = -a^{2}b \\int_{1}^{0} u^{1/2} du = a^{2}b \\int_{0}^{1} u^{1/2} du $$\n$$ = a^{2}b \\left[ \\frac{u^{3/2}}{3/2} \\right]_{0}^{1} = a^{2}b \\left( \\frac{2}{3}(1)^{3/2} - \\frac{2}{3}(0)^{3/2} \\right) = \\frac{2}{3}a^{2}b $$\n现在我们可以计算 $\\hat{\\mu}_{1}$：\n$$ \\hat{\\mu}_{1} = \\frac{\\frac{2}{3}a^{2}b}{\\frac{1}{2}\\pi ab} = \\frac{2a^{2}b}{3} \\cdot \\frac{2}{\\pi ab} = \\frac{4a}{3\\pi} $$\n因此，估计的质心为 $\\mathbb{E}[\\hat{\\mu}] = (\\hat{\\mu}_{1}, \\hat{\\mu}_{2}) = \\left(\\frac{4a}{3\\pi}, 0\\right)$。\n\n估计量的偏差是估计质心与真实质心之间的差值：\n$$ \\text{Bias} = \\mathbb{E}[\\hat{\\mu}] - \\mu = \\left(\\frac{4a}{3\\pi}, 0\\right) - (0,0) = \\left(\\frac{4a}{3\\pi}, 0\\right) $$\n最后，我们计算偏差向量的欧几里得范数：\n$$ \\|\\mathbb{E}[\\hat{\\mu}] - \\mu\\|_{2} = \\left\\| \\left(\\frac{4a}{3\\pi}, 0\\right) \\right\\|_{2} = \\sqrt{\\left(\\frac{4a}{3\\pi}\\right)^{2} + 0^{2}} = \\sqrt{\\left(\\frac{4a}{3\\pi}\\right)^{2}} $$\n由于 $a > 0$，量 $\\frac{4a}{3\\pi}$ 是正的，所以范数为：\n$$ \\|\\mathbb{E}[\\hat{\\mu}] - \\mu\\|_{2} = \\frac{4a}{3\\pi} $$\n该表达式量化了因扩散障碍导致样本被截断，从而在估计生态位中心时引入的系统误差的大小。偏差仅存在于被截断的轴上，其大小与生态位在该轴上的范围 $a$ 成正比。沿未受限制轴的范围 $b$ 不影响偏差的大小。", "answer": "$$\n\\boxed{\\frac{4a}{3\\pi}}\n$$", "id": "2498812"}, {"introduction": "从生态过程转向观测过程，本练习探讨了抽样偏差对生态位估计的影响，这在处理仅有出现记录的数据时尤为关键。通过构建一个概率性生态位模型，我们分析了系统性的抽样工作量趋势（例如，更容易接近的区域被更多地抽样）如何扭曲我们对生态位中心的认知。此练习演示了如何利用数学方法精确推导出这种观测偏差的后果，这是物种分布模型分析中的一项重要技能。[@problem_id:2498835]", "problem": "一个物种的基本哈钦森生态位 (fundamental Hutchinsonian niche) 由一个二维气候环境空间中的概率密度表示，该空间的坐标轴为温度 $T$（摄氏度）和降水量 $P$（毫米）。假设真实的环境占据分布为二元正态分布，其均值向量为 $\\boldsymbol{\\mu} = \\begin{pmatrix}\\mu_{T} \\\\ \\mu_{P}\\end{pmatrix}$，协方差矩阵为\n$$\n\\boldsymbol{\\Sigma} \\;=\\;\n\\begin{pmatrix}\n\\sigma_{T}^{2} & \\rho \\,\\sigma_{T}\\sigma_{P} \\\\\n\\rho \\,\\sigma_{T}\\sigma_{P} & \\sigma_{P}^{2}\n\\end{pmatrix},\n$$\n因此，物种出现点的环境协变量密度为\n$$\nf_{\\mathbf{X}}(\\mathbf{x}) \\;=\\; \\frac{1}{2\\pi \\sqrt{|\\boldsymbol{\\Sigma}|}} \\exp\\!\\Big(-\\tfrac{1}{2}(\\mathbf{x}-\\boldsymbol{\\mu})^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu})\\Big),\n$$\n其中 $\\mathbf{x}=\\begin{pmatrix}T \\\\ P\\end{pmatrix}$，$|\\boldsymbol{\\Sigma}|$ 表示 $\\boldsymbol{\\Sigma}$ 的行列式。\n\n由于可达性偏差，所收集的仅有物种出现记录 (presence-only records) 的采样工作量沿温度轴单调增加。假设一个简单的对数线性工作量模型 $w(\\mathbf{x}) \\propto \\exp(\\beta\\, T)$，其中 $\\beta>0$ 是已知常数。在标准非齐次泊松点过程 (inhomogeneous Poisson point process) 采样下，观测到的仅有物种出现记录的环境密度与 $f_{\\mathbf{X}}(\\mathbf{x})\\,w(\\mathbf{x})$ 成正比。\n\n从这些假设和多元正态分布的定义出发，推导估计的生态位质心 (niche centroid) 的偏差向量的解析表达式：\n$$\n\\boldsymbol{\\Delta} \\;=\\; \\mathbb{E}_{\\text{obs}}[\\mathbf{X}] \\;-\\; \\boldsymbol{\\mu},\n$$\n该表达式应以 $\\boldsymbol{\\Sigma}$ 和 $\\beta$ 表示。然后，使用参数值 $\\sigma_{T}=3$、$\\sigma_{P}=200$、$\\rho=0.4$ 和 $\\beta=0.02$（每摄氏度），计算 $\\boldsymbol{\\Delta}$ 的数值。将最终数值答案的每个分量四舍五入到 $4$ 位有效数字。用相应坐标轴的单位（温度分量为摄氏度，降水分量为毫米）表示偏差向量的分量，但不要在方框答案中包含单位。将最终数值答案表示为一个包含 $2$ 个分量的行向量。", "solution": "该问题已经过验证，被认为是科学上可靠、定义明确且客观的。其中没有矛盾、歧义或逻辑缺陷。我们直接进行推导。\n\n真实的环境占据分布，即基本生态位，是一个二元正态概率密度函数 $f_{\\mathbf{X}}(\\mathbf{x})$，其中 $\\mathbf{X} \\sim \\mathcal{N}(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$。环境协变量向量为 $\\mathbf{x} = \\begin{pmatrix} T \\\\ P \\end{pmatrix}$。\n\n采样工作量由 $w(\\mathbf{x}) \\propto \\exp(\\beta T)$ 给出，其中 $\\beta > 0$ 是一个已知常数。观测到的物种出现密度 $f_{\\text{obs}}(\\mathbf{x})$ 与真实占据密度和采样工作量函数的乘积成正比：\n$$\nf_{\\text{obs}}(\\mathbf{x}) \\propto f_{\\mathbf{X}}(\\mathbf{x}) w(\\mathbf{x})\n$$\n代入正态密度和工作量模型的表达式，我们得到：\n$$\nf_{\\text{obs}}(\\mathbf{x}) \\propto \\frac{1}{2\\pi \\sqrt{|\\boldsymbol{\\Sigma}|}} \\exp\\left(-\\frac{1}{2}(\\mathbf{x}-\\boldsymbol{\\mu})^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu})\\right) \\exp(\\beta T)\n$$\n由于指数前因子 $\\frac{1}{2\\pi \\sqrt{|\\boldsymbol{\\Sigma}|}}$ 是一个常数，我们可以将其并入比例常数中。问题的核心在于指数部分。让我们合并指数项：\n$$\nf_{\\text{obs}}(\\mathbf{x}) \\propto \\exp\\left(-\\frac{1}{2}(\\mathbf{x}-\\boldsymbol{\\mu})^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu}) + \\beta T\\right)\n$$\n$\\beta T$ 这一项可以写成向量形式。设 $\\mathbf{b} = \\begin{pmatrix} \\beta \\\\ 0 \\end{pmatrix}$。那么 $\\beta T = \\beta \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} T \\\\ P \\end{pmatrix} = \\mathbf{b}^{\\top}\\mathbf{x}$。指数部分为：\n$$\n\\mathcal{E} = -\\frac{1}{2}(\\mathbf{x}-\\boldsymbol{\\mu})^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu}) + \\mathbf{b}^{\\top}\\mathbf{x}\n$$\n我们展开二次型：\n$$\n\\mathcal{E} = -\\frac{1}{2}(\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\mathbf{x} - \\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu} - \\boldsymbol{\\mu}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\mathbf{x} + \\boldsymbol{\\mu}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}) + \\mathbf{b}^{\\top}\\mathbf{x}\n$$\n由于 $\\boldsymbol{\\mu}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\mathbf{x}$ 是一个标量，它等于其转置 $\\mathbf{x}^{\\top}(\\boldsymbol{\\Sigma}^{-1})^{\\top}\\boldsymbol{\\mu} = \\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}$，因为 $\\boldsymbol{\\Sigma}^{-1}$ 是对称的。因此，表达式变为：\n$$\n\\mathcal{E} = -\\frac{1}{2}\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\mathbf{x} + \\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu} + \\mathbf{b}^{\\top}\\mathbf{x} - \\frac{1}{2}\\boldsymbol{\\mu}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}\n$$\n我们将 $\\mathbf{x}$ 的线性项组合在一起：\n$$\n\\mathcal{E} = -\\frac{1}{2}\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\mathbf{x} + (\\boldsymbol{\\mu}^{\\top}\\boldsymbol{\\Sigma}^{-1} + \\mathbf{b}^{\\top})\\mathbf{x} - \\frac{1}{2}\\boldsymbol{\\mu}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}\n$$\n该表达式具有多元正态密度对数函数的形式。一个均值向量为 $\\boldsymbol{\\mu}_{\\text{obs}}$、协方差矩阵为 $\\boldsymbol{\\Sigma}$ 的一般正态密度，其对数密度正比于：\n$$\n-\\frac{1}{2}(\\mathbf{x}-\\boldsymbol{\\mu}_{\\text{obs}})^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu}_{\\text{obs}}) = -\\frac{1}{2}\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\mathbf{x} + \\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{\\text{obs}} - \\frac{1}{2}\\boldsymbol{\\mu}_{\\text{obs}}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{\\text{obs}}\n$$\n通过比较我们的 $\\mathcal{E}$ 表达式与一般形式中关于 $\\mathbf{x}^{\\top}$（或 $\\mathbf{x}$）的线性项，我们可以确定新的均值向量 $\\boldsymbol{\\mu}_{\\text{obs}}$。\n$$\n\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{\\text{obs}} = (\\boldsymbol{\\mu}^{\\top}\\boldsymbol{\\Sigma}^{-1} + \\mathbf{b}^{\\top})\\mathbf{x} = \\mathbf{x}^{\\top}(\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu} + \\mathbf{b})\n$$\n这个等式必须对所有 $\\mathbf{x}$ 成立，这意味着：\n$$\n\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{\\text{obs}} = \\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu} + \\mathbf{b}\n$$\n为了求解 $\\boldsymbol{\\mu}_{\\text{obs}}$，即观测分布下的期望值 $\\mathbb{E}_{\\text{obs}}[\\mathbf{X}]$，我们从左侧乘以 $\\boldsymbol{\\Sigma}$：\n$$\n\\boldsymbol{\\Sigma}(\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{\\text{obs}}) = \\boldsymbol{\\Sigma}(\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu} + \\mathbf{b})\n$$\n$$\n\\boldsymbol{\\mu}_{\\text{obs}} = \\boldsymbol{\\mu} + \\boldsymbol{\\Sigma}\\mathbf{b}\n$$\n因此，观测分布 $f_{\\text{obs}}(\\mathbf{x})$ 是一个二元正态分布，其均值为 $\\boldsymbol{\\mu}_{\\text{obs}} = \\boldsymbol{\\mu} + \\boldsymbol{\\Sigma}\\mathbf{b}$，协方差矩阵与原始分布相同，为 $\\boldsymbol{\\Sigma}$。\n\n偏差向量 $\\boldsymbol{\\Delta}$ 定义为观测均值与真实均值之差：\n$$\n\\boldsymbol{\\Delta} = \\mathbb{E}_{\\text{obs}}[\\mathbf{X}] - \\boldsymbol{\\mu} = \\boldsymbol{\\mu}_{\\text{obs}} - \\boldsymbol{\\mu}\n$$\n代入我们得到的 $\\boldsymbol{\\mu}_{\\text{obs}}$：\n$$\n\\boldsymbol{\\Delta} = (\\boldsymbol{\\mu} + \\boldsymbol{\\Sigma}\\mathbf{b}) - \\boldsymbol{\\mu} = \\boldsymbol{\\Sigma}\\mathbf{b}\n$$\n这就是偏差向量的解析表达式。我们现在用 $\\boldsymbol{\\Sigma}$ 和 $\\beta$ 的分量来表示它：\n$$\n\\boldsymbol{\\Delta} = \\begin{pmatrix} \\sigma_{T}^{2} & \\rho \\sigma_{T}\\sigma_{P} \\\\ \\rho \\sigma_{T}\\sigma_{P} & \\sigma_{P}^{2} \\end{pmatrix} \\begin{pmatrix} \\beta \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\sigma_{T}^{2}\\beta + (\\rho \\sigma_{T}\\sigma_{P}) \\cdot 0 \\\\ (\\rho \\sigma_{T}\\sigma_{P})\\beta + \\sigma_{P}^{2} \\cdot 0 \\end{pmatrix} = \\begin{pmatrix} \\beta \\sigma_{T}^{2} \\\\ \\beta \\rho \\sigma_{T}\\sigma_{P} \\end{pmatrix}\n$$\n温度偏差 $\\Delta_T$ 为 $\\beta \\sigma_{T}^{2}$。降水偏差 $\\Delta_P$ 为 $\\beta \\rho \\sigma_{T}\\sigma_{P}$。\n\n现在，我们使用给定的参数：$\\sigma_{T}=3$、$\\sigma_{P}=200$、$\\rho=0.4$ 和 $\\beta=0.02$ 来计算 $\\boldsymbol{\\Delta}$ 的数值。\n\n偏差的温度分量是：\n$$\n\\Delta_T = \\beta \\sigma_{T}^{2} = (0.02) \\cdot (3^{2}) = 0.02 \\cdot 9 = 0.18\n$$\n偏差的降水分量是：\n$$\n\\Delta_P = \\beta \\rho \\sigma_{T}\\sigma_{P} = (0.02) \\cdot (0.4) \\cdot (3) \\cdot (200) = 0.008 \\cdot 600 = 4.8\n$$\n得到的偏差向量为 $\\boldsymbol{\\Delta} = \\begin{pmatrix} 0.18 \\\\ 4.8 \\end{pmatrix}$。题目要求将每个分量四舍五入到 $4$ 位有效数字。\n$$\n\\Delta_T = 0.1800\n$$\n$$\n\\Delta_P = 4.800\n$$\n最终数值答案以行向量形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1800 & 4.800 \\end{pmatrix}}\n$$", "id": "2498835"}, {"introduction": "在评估生态位模型时，除了估计偏差（准确性）外，我们还必须考虑估计的方差（精确性）。环境变量之间的相关性（即多重共线性）是统计建模中的一个常见挑战，它会“放大”模型参数的不确定性。本高级练习将带领您运用统计理论，推导共线性如何不仅影响模型系数的方差，还如何通过“德尔塔方法”（delta method）传递并影响生态位边界方向的不确定性，从而量化我们对生态位形状估计的信心。[@problem_id:2498766]", "problem": "某个目标物种的物种分布模型被定义为关于环境协变量的逻辑回归，它将 Hutchinsonian 生态位描述为环境空间中出现概率超过某一阈值的点集。考虑一个二维环境空间，其中有两个标准化的预测变量 $x_{1}$ 和 $x_{2}$（均值为 $0$，方差为 $1$），它们之间的相关系数为 $\\rho \\in (-1,1)$。设模型为\n$$\n\\Pr(Y=1 \\mid x_{1}, x_{2}) \\;=\\; \\left(1 + \\exp\\!\\left(-(\\beta_{0} + \\beta_{1} x_{1} + \\beta_{2} x_{2})\\right)\\right)^{-1}.\n$$\n假设从具有所述协方差结构的环境分布中抽取了 $N$ 个独立样本，并假设在决策边界周围进行了平衡抽样，因此 Fisher 信息中每个观测的权重 $w_{i} = \\pi_{i}(1-\\pi_{i})$ 可以用一个跨观测的常数 $\\bar{w}$ 来近似。环境空间中 $p^{\\ast} = 0.5$ 的生态位边界是直线 $\\beta_{0} + \\beta_{1} x_{1} + \\beta_{2} x_{2} = 0$，其法向量的方向（当与可用环境相交时，该方向控制生态位边界的形状）由角度给出\n$$\n\\phi \\;=\\; \\arctan2(\\beta_{2}, \\beta_{1}).\n$$\n从最大似然估计的渐近正态性和 Fisher 信息公式 $I(\\beta) = X^{\\top} W X$（其中 $W$ 是对角元为 $w_{i}$ 的对角矩阵）以及环境预测变量的协方差矩阵\n$$\n\\Sigma_{x} \\;=\\; \\begin{pmatrix} 1 & \\rho \\\\ \\rho & 1 \\end{pmatrix},\n$$\n出发，执行以下操作：\n\n- 推导 $(\\hat{\\beta}_{1}, \\hat{\\beta}_{2})$ 的近似协方差矩阵，用 $N$、$\\bar{w}$ 和 $\\rho$ 表示，并确定由 $\\rho$ 引起的斜率估计中的方差膨胀。\n- 使用 delta 方法，推导 $\\operatorname{Var}(\\hat{\\phi})$ 主阶近似的显式表达式，该表达式是 $(\\beta_{1},\\beta_{2},\\rho,N,\\bar{w})$ 的函数。\n- 将超体积边界方向不确定性的膨胀因子定义为比率\n$$\nR(\\rho) \\;=\\; \\frac{\\operatorname{Var}(\\hat{\\phi}; \\rho)}{\\operatorname{Var}(\\hat{\\phi}; 0)}.\n$$\n- 在 $\\beta_{1} = 1$，$\\beta_{2} = 2$ 和 $\\rho = 0.8$ 时，计算 $R(\\rho)$ 的值。请以单个精确值（不进行四舍五入）的形式提供最终答案。最终答案必须是 $R(0.8)$ 的值，不带单位。", "solution": "所述问题具有科学依据、是良定的且客观。它提出了一个应用于生态建模的标准（尽管是高级的）统计推断问题。所有必需信息均已提供，任务逻辑结构清晰。该问题是有效的，将提供解答。\n\n第一步是推导最大似然估计量 $(\\hat{\\beta}_{1}, \\hat{\\beta}_{2})$ 的近似协方差矩阵。完整参数向量 $\\hat{\\beta} = (\\hat{\\beta}_{0}, \\hat{\\beta}_{1}, \\hat{\\beta}_{2})^{T}$ 的渐近协方差矩阵是 Fisher 信息矩阵 $I(\\beta)$ 的逆矩阵。Fisher 信息由 $I(\\beta) = X^{\\top} W X$ 给出，其中 $X$ 是 $N \\times 3$ 的设计矩阵，$W$ 是 $N \\times N$ 的权重对角矩阵。问题陈述权重 $w_i = \\pi_i(1-\\pi_i)$ 可以用一个常数 $\\bar{w}$ 来近似。因此，$W \\approx \\bar{w}I_{N}$，其中 $I_N$ 是 $N \\times N$ 的单位矩阵。因此，Fisher 信息矩阵可以近似为 $I(\\beta) \\approx \\bar{w} X^{\\top} X$。\n\n对于大样本容量 $N$，矩阵 $\\frac{1}{N}X^{\\top}X$ 收敛于预测变量的二阶矩矩阵。观测 $i$ 的设计向量是 $(1, x_{i1}, x_{i2})^{T}$。鉴于预测变量 $x_{1}$ 和 $x_{2}$ 已被标准化，均值为 $0$，方差为 $1$，且它们的相关性为 $\\rho$，设计向量外积的期望是：\n$$\nE\\left[ \\begin{pmatrix} 1 \\\\ x_1 \\\\ x_2 \\end{pmatrix} \\begin{pmatrix} 1 & x_1 & x_2 \\end{pmatrix} \\right] =\n\\begin{pmatrix}\nE[1] & E[x_1] & E[x_2] \\\\\nE[x_1] & E[x_1^2] & E[x_1 x_2] \\\\\nE[x_2] & E[x_1 x_2] & E[x_2^2]\n\\end{pmatrix} =\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & \\rho \\\\\n0 & \\rho & 1\n\\end{pmatrix}\n$$\n此处，对于 $j \\in \\{1,2\\}$，$E[x_j^2] = \\operatorname{Var}(x_j) + (E[x_j])^2 = 1+0=1$，且 $E[x_1 x_2] = \\operatorname{Cov}(x_1, x_2) = \\rho \\sqrt{\\operatorname{Var}(x_1)\\operatorname{Var}(x_2)} = \\rho$。\n因此，对于大样本 $N$，Fisher 信息矩阵为 $I(\\beta) \\approx N\\bar{w} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & \\rho \\\\ 0 & \\rho & 1 \\end{pmatrix}$。\n其块对角结构意味着截距的估计量 $\\hat{\\beta}_{0}$ 与斜率的估计量 $(\\hat{\\beta}_{1}, \\hat{\\beta}_{2})$ 渐近不相关。$(\\hat{\\beta}_{1}, \\hat{\\beta}_{2})$ 的协方差矩阵可以通过对 $I(\\beta)$ 中相应的 $2 \\times 2$ 子矩阵求逆得到：\n$$\n\\operatorname{Var}(\\hat{\\beta}_{1}, \\hat{\\beta}_{2}) \\approx \\left( N\\bar{w} \\begin{pmatrix} 1 & \\rho \\\\ \\rho & 1 \\end{pmatrix} \\right)^{-1} = \\frac{1}{N\\bar{w}} \\begin{pmatrix} 1 & \\rho \\\\ \\rho & 1 \\end{pmatrix}^{-1}\n$$\n该 $2 \\times 2$ 矩阵的逆矩阵是 $\\frac{1}{1-\\rho^2}\\begin{pmatrix} 1 & -\\rho \\\\ -\\rho & 1 \\end{pmatrix}$。因此，近似协方差矩阵为：\n$$\n\\operatorname{Var}(\\hat{\\beta}_{1}, \\hat{\\beta}_{2}) \\approx \\frac{1}{N\\bar{w}(1-\\rho^2)} \\begin{pmatrix} 1 & -\\rho \\\\ -\\rho & 1 \\end{pmatrix}\n$$\n斜率估计的方差是对角元：$\\operatorname{Var}(\\hat{\\beta}_1) \\approx \\operatorname{Var}(\\hat{\\beta}_2) \\approx \\frac{1}{N\\bar{w}(1-\\rho^2)}$。在没有相关性（$\\rho=0$）的情况下，方差将是 $\\frac{1}{N\\bar{w}}$。由共线性引起的方差膨胀由因子 $\\frac{1}{1-\\rho^2}$ 给出，这是此情况下的标准方差膨胀因子（VIF）。\n\n接下来，我们使用 delta 方法推导角度 $\\hat{\\phi} = \\arctan2(\\hat{\\beta}_{2}, \\hat{\\beta}_{1})$ 的方差。该方差可近似为 $\\operatorname{Var}(\\hat{\\phi}) \\approx (\\nabla \\phi)^T \\operatorname{Var}(\\hat{\\beta}_{1}, \\hat{\\beta}_{2}) (\\nabla \\phi)$，其中 $\\nabla \\phi$ 是 $\\phi(\\beta_1, \\beta_2) = \\arctan2(\\beta_2, \\beta_1)$ 在真实参数值处求得的梯度。偏导数为：\n$$\n\\frac{\\partial \\phi}{\\partial \\beta_1} = -\\frac{\\beta_2}{\\beta_1^2 + \\beta_2^2} \\quad \\text{和} \\quad \\frac{\\partial \\phi}{\\partial \\beta_2} = \\frac{\\beta_1}{\\beta_1^2 + \\beta_2^2}\n$$\n梯度向量为 $\\nabla \\phi = \\frac{1}{\\beta_1^2 + \\beta_2^2} \\begin{pmatrix} -\\beta_2 \\\\ \\beta_1 \\end{pmatrix}$。\n将此代入 delta 方法的公式中：\n$$\n\\operatorname{Var}(\\hat{\\phi}) \\approx \\frac{1}{(\\beta_1^2+\\beta_2^2)^2} \\begin{pmatrix} -\\beta_2 & \\beta_1 \\end{pmatrix} \\left( \\frac{1}{N\\bar{w}(1-\\rho^2)} \\begin{pmatrix} 1 & -\\rho \\\\ -\\rho & 1 \\end{pmatrix} \\right) \\begin{pmatrix} -\\beta_2 \\\\ \\beta_1 \\end{pmatrix}\n$$\n$$\n= \\frac{1}{N\\bar{w}(1-\\rho^2)(\\beta_1^2+\\beta_2^2)^2} \\begin{pmatrix} -\\beta_2 & \\beta_1 \\end{pmatrix} \\begin{pmatrix} -\\beta_2 - \\rho\\beta_1 \\\\ \\rho\\beta_2 + \\beta_1 \\end{pmatrix}\n$$\n$$\n= \\frac{1}{N\\bar{w}(1-\\rho^2)(\\beta_1^2+\\beta_2^2)^2} \\left( (-\\beta_2)(-\\beta_2 - \\rho\\beta_1) + \\beta_1(\\rho\\beta_2 + \\beta_1) \\right)\n$$\n$$\n= \\frac{1}{N\\bar{w}(1-\\rho^2)(\\beta_1^2+\\beta_2^2)^2} \\left( \\beta_2^2 + \\rho\\beta_1\\beta_2 + \\rho\\beta_1\\beta_2 + \\beta_1^2 \\right)\n$$\n化简后可得到角度估计量方差的表达式：\n$$\n\\operatorname{Var}(\\hat{\\phi}) \\approx \\frac{\\beta_1^2 + \\beta_2^2 + 2\\rho\\beta_1\\beta_2}{N\\bar{w}(1-\\rho^2)(\\beta_1^2 + \\beta_2^2)^2}\n$$\n现在我们求膨胀因子 $R(\\rho) = \\frac{\\operatorname{Var}(\\hat{\\phi}; \\rho)}{\\operatorname{Var}(\\hat{\\phi}; 0)}$。我们首先计算 $\\rho=0$ 时的方差：\n$$\n\\operatorname{Var}(\\hat{\\phi}; 0) \\approx \\frac{\\beta_1^2 + \\beta_2^2}{N\\bar{w}(\\beta_1^2 + \\beta_2^2)^2} = \\frac{1}{N\\bar{w}(\\beta_1^2 + \\beta_2^2)}\n$$\n那么比值为：\n$$\nR(\\rho) = \\frac{\\frac{\\beta_1^2 + \\beta_2^2 + 2\\rho\\beta_1\\beta_2}{N\\bar{w}(1-\\rho^2)(\\beta_1^2 + \\beta_2^2)^2}}{\\frac{1}{N\\bar{w}(\\beta_1^2 + \\beta_2^2)}} = \\frac{\\beta_1^2 + \\beta_2^2 + 2\\rho\\beta_1\\beta_2}{(1-\\rho^2)(\\beta_1^2 + \\beta_2^2)}\n$$\n最后，我们在 $\\beta_{1}=1$，$\\beta_{2}=2$ 和 $\\rho=0.8$ 的条件下计算 $R(\\rho)$ 的值。最好使用精确分数以避免舍入误差。$\\rho = 0.8 = \\frac{4}{5}$。\n表达式中的各项为：\n- $\\beta_1^2 + \\beta_2^2 = 1^2 + 2^2 = 1+4=5$。\n- $2\\rho\\beta_1\\beta_2 = 2 \\cdot \\frac{4}{5} \\cdot 1 \\cdot 2 = \\frac{16}{5}$。\n- $1 - \\rho^2 = 1 - \\left(\\frac{4}{5}\\right)^2 = 1 - \\frac{16}{25} = \\frac{9}{25}$。\n\n将这些值代入 $R(\\rho)$ 的表达式中：\n$$\nR(0.8) = R\\left(\\frac{4}{5}\\right) = \\frac{5 + \\frac{16}{5}}{\\frac{9}{25} \\cdot 5} = \\frac{\\frac{25+16}{5}}{\\frac{9}{5}} = \\frac{\\frac{41}{5}}{\\frac{9}{5}} = \\frac{41}{9}\n$$", "answer": "$$\n\\boxed{\\frac{41}{9}}\n$$", "id": "2498766"}]}