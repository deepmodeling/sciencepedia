{"hands_on_practices": [{"introduction": "在着手任何生态学研究之前，一个基本问题是：我需要多少样本？这个问题不仅仅是后勤问题，更是统计推断的基石。本练习将带领我们从第一性原理出发，推导功效分析中的样本量计算公式，这对于任何期望发现特定大小效应的研究都至关重要。通过这个过程，你将加深对统计功效、效应大小、以及I型错误（$\\alpha$）和II型错误（$\\beta$）之间权衡的理解。 [@problem_id:2538634]", "problem": "一位生态学家正在计划一项随机平行组实地实验，以比较恢复的栖息地与未恢复的对照组之间的无脊椎动物平均生物量。设恢复组的均值为 $\\mu_{T}$，对照组的均值为 $\\mu_{C}$。假设观测值独立，各组间方差 $\\sigma^{2}$ 相同且已知，并采用等量分配，每组有 $n$ 个观测值。研究者将进行 $H_{0}:\\mu_{T}-\\mu_{C}=0$ 的双侧假设检验，显著性水平为 $\\alpha$，目标功效为 $1-\\beta$，以检测由 $\\delta=(\\mu_{T}-\\mu_{C})/\\sigma$ 定义的标准化效应量 $\\delta$。\n\n请仅使用适用于生态学研究设计规划的第一性原理——即中心极限定理 (CLT)、第一类和第二类错误的定义，以及双样本 t 统计量的大样本正态近似——推导出在双侧检验和等组别样本量的情况下，达到指定的 $\\alpha$、$\\beta$ 和 $\\delta$ 所需的每组样本量 $n$（不四舍五入为整数）。\n\n您的推导必须：\n- 从样本均值之差的分布以及在 $H_{0}$ 和备择假设下的检验统计量的定义开始。\n- 使用标准正态累积分布函数 $\\Phi(\\cdot)$ 及其分位数函数 $\\Phi^{-1}(\\cdot)$ 来表示水平为 $\\alpha$ 的拒绝阈值，以及在备择假设下对应于功效 $1-\\beta$ 的非中心均值。\n- 以 $\\alpha$、$\\beta$ 和 $\\delta$ 的函数形式，显式求解 $n$ 的闭式解。\n\n请以包含 $\\Phi^{-1}(\\cdot)$ 的单个闭式解析表达式报告您的最终答案。不要进行上取整或四舍五入；不需要进行数值计算。样本量是无单位的，因此不需要单位。", "solution": "该问题陈述在科学上是合理的、定义明确、客观，并包含了进行严谨推导所需的所有必要信息。它提出了统计功效分析中的一个标准任务。因此，该问题是有效的，我们开始进行解答。\n\n我们的任务是为一个双样本研究推导出每组的样本量，用 $n$ 表示。目标是比较两个均值，即处理组的 $\\mu_{T}$ 和对照组的 $\\mu_{C}$。\n\n设 $\\bar{X}_{T}$ 和 $\\bar{X}_{C}$ 分别是从处理组和对照组获得的样本均值，每组的样本量均为 $n$。观测值是独立的，总体方差 $\\sigma^{2}$ 是共同的且假定为已知。根据中心极限定理 (CLT)，对于足够大的样本量 $n$，样本均值的分布可由正态分布近似：\n$$ \\bar{X}_{T} \\sim \\mathcal{N}\\left(\\mu_{T}, \\frac{\\sigma^{2}}{n}\\right) $$\n$$ \\bar{X}_{C} \\sim \\mathcal{N}\\left(\\mu_{C}, \\frac{\\sigma^{2}}{n}\\right) $$\n由于两组的独立性，样本均值之差 $\\bar{X}_{T} - \\bar{X}_{C}$ 的分布也是正态的。此差值的期望值和方差为：\n$$ E[\\bar{X}_{T} - \\bar{X}_{C}] = E[\\bar{X}_{T}] - E[\\bar{X}_{C}] = \\mu_{T} - \\mu_{C} $$\n$$ \\text{Var}(\\bar{X}_{T} - \\bar{X}_{C}) = \\text{Var}(\\bar{X}_{T}) + \\text{Var}(\\bar{X}_{C}) = \\frac{\\sigma^{2}}{n} + \\frac{\\sigma^{2}}{n} = \\frac{2\\sigma^{2}}{n} $$\n因此，均值之差的抽样分布为：\n$$ (\\bar{X}_{T} - \\bar{X}_{C}) \\sim \\mathcal{N}\\left(\\mu_{T} - \\mu_{C}, \\frac{2\\sigma^{2}}{n}\\right) $$\n假设检验的检验统计量是标准化的样本均值之差。我们将检验统计量 $Z$ 定义为：\n$$ Z = \\frac{(\\bar{X}_{T} - \\bar{X}_{C}) - (\\mu_{T} - \\mu_{C})}{\\sqrt{\\frac{2\\sigma^{2}}{n}}} $$\n在原假设 $H_{0}: \\mu_{T} - \\mu_{C} = 0$下，该统计量简化为：\n$$ Z_{0} = \\frac{\\bar{X}_{T} - \\bar{X}_{C}}{\\sigma\\sqrt{\\frac{2}{n}}} $$\n在 $H_{0}$ 下，$Z_{0}$ 服从标准正态分布，$Z_{0} \\sim \\mathcal{N}(0, 1)$。\n\n对于显著性水平为 $\\alpha$ 的双侧检验，如果观测到的检验统计量的绝对值 $|Z_{0}|$ 超过临界值，我们则拒绝 $H_{0}$。这个临界值是标准正态分布的上 $\\alpha/2$ 分位数。使用标准正态累积分布函数 $\\Phi(\\cdot)$ 及其逆函数（分位数函数）$\\Phi^{-1}(\\cdot)$，临界值为 $\\Phi^{-1}(1 - \\alpha/2)$。\n拒绝规则是：如果 $|Z_{0}| > \\Phi^{-1}(1 - \\alpha/2)$，则拒绝 $H_{0}$。\n\n接下来，我们考虑检验的功效 $1 - \\beta$。这是当备择假设 $H_{A}$ 为真时，正确拒绝 $H_{0}$ 的概率。问题指定了我们希望检测的标准化效应量 $\\delta = (\\mu_{T} - \\mu_{C})/\\sigma$。我们考虑一个具体的备择假设，其中真实差值为 $\\mu_{T} - \\mu_{C} = \\Delta$，因此 $\\delta = \\Delta/\\sigma$。\n功效是在 $H_{A}$ 为真的条件下，检验统计量落入拒绝域的概率。对于双侧检验，功效为 $P(|Z_{0}| > \\Phi^{-1}(1 - \\alpha/2) | \\mu_{T} - \\mu_{C} = \\Delta)$。\n在典型的双侧检验功效计算中，我们不失一般性地假设 $\\Delta > 0$。在这种情况下，对于合理的功效，在下尾拒绝的概率变得可以忽略不计。功效主要由在上尾拒绝的概率决定。\n$$ 1 - \\beta \\approx P\\left(Z_{0} > \\Phi^{-1}(1 - \\alpha/2) | \\mu_{T} - \\mu_{C} = \\Delta\\right) $$\n$$ 1 - \\beta \\approx P\\left(\\frac{\\bar{X}_{T} - \\bar{X}_{C}}{\\sigma\\sqrt{\\frac{2}{n}}} > \\Phi^{-1}(1 - \\alpha/2) | \\mu_{T} - \\mu_{C} = \\Delta\\right) $$\n为了计算这个概率，我们必须在备择假设下对随机变量 $\\bar{X}_{T} - \\bar{X}_{C}$ 进行标准化，其均值为 $\\Delta$。我们减去均值 $\\Delta$ 并除以标准差 $\\sigma\\sqrt{2/n}$：\n$$ 1 - \\beta \\approx P\\left( \\frac{(\\bar{X}_{T} - \\bar{X}_{C}) - \\Delta}{\\sigma\\sqrt{\\frac{2}{n}}} > \\frac{\\sigma\\sqrt{\\frac{2}{n}}\\Phi^{-1}(1 - \\alpha/2) - \\Delta}{\\sigma\\sqrt{\\frac{2}{n}}} \\right) $$\n概率内部左侧的项是一个标准正态随机变量。我们称其为 $Z_{A}$。\n$$ 1 - \\beta \\approx P\\left( Z_{A} > \\Phi^{-1}(1 - \\alpha/2) - \\frac{\\Delta}{\\sigma\\sqrt{\\frac{2}{n}}} \\right) $$\n一个标准正态变量 $Z_{A}$ 超过某个值 $c$ 的概率是 $1 - \\Phi(c)$。要使这个概率等于 $1-\\beta$，值 $c$ 必须是分位数 $\\Phi^{-1}(\\beta)$。\n$$ \\Phi^{-1}(\\beta) = \\Phi^{-1}(1 - \\alpha/2) - \\frac{\\Delta}{\\sigma\\sqrt{\\frac{2}{n}}} $$\n利用正态分布的对称性，$\\Phi^{-1}(\\beta) = -\\Phi^{-1}(1 - \\beta)$。代入此式和标准化效应量的定义 $\\delta = \\Delta/\\sigma$：\n$$ -\\Phi^{-1}(1 - \\beta) = \\Phi^{-1}(1 - \\alpha/2) - \\frac{\\delta \\sigma}{\\sigma\\sqrt{\\frac{2}{n}}} $$\n$$ -\\Phi^{-1}(1 - \\beta) = \\Phi^{-1}(1 - \\alpha/2) - \\delta\\sqrt{\\frac{n}{2}} $$\n现在，我们必须求解样本量 $n$。\n$$ \\delta\\sqrt{\\frac{n}{2}} = \\Phi^{-1}(1 - \\frac{\\alpha}{2}) + \\Phi^{-1}(1 - \\beta) $$\n$$ \\sqrt{n} = \\frac{\\sqrt{2}}{\\delta} \\left( \\Phi^{-1}(1 - \\frac{\\alpha}{2}) + \\Phi^{-1}(1 - \\beta) \\right) $$\n对两边平方，得到每组样本量 $n$ 的最终闭式表达式：\n$$ n = \\frac{2}{\\delta^{2}} \\left( \\Phi^{-1}(1 - \\frac{\\alpha}{2}) + \\Phi^{-1}(1 - \\beta) \\right)^{2} $$\n该表达式以所期望的第一类错误率 $\\alpha$、第二类错误率 $\\beta$ 和标准化效应量 $\\delta$ 的函数形式，给出了每组所需的样本量。", "answer": "$$ \\boxed{ \\frac{2}{\\delta^2} \\left( \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) + \\Phi^{-1}(1 - \\beta) \\right)^{2} } $$", "id": "2538634"}, {"introduction": "确定了需要多少样本后，下一个关键问题是：什么是独立的样本？在复杂的多层次实验设计中，误将子样本或重复测量当作真正的重复，即“伪重复”（pseudoreplication），是生态学研究中最常见的统计错误之一。本练习提供了一个典型的实验室微观世界实验场景，要求你精确识别独立的实验单元。掌握这项技能对于确保统计检验的有效性和结论的可靠性至关重要。[@problem_id:2538657]", "problem": "一项实验室微观世界实验测试了温度对一种小型水生无脊椎动物个体代谢率的影响。实验设置了 $3$ 个温度处理：$12^\\circ\\text{C}$、$18^\\circ\\text{C}$ 和 $24^\\circ\\text{C}$。为实施处理，实验室为每个温度维持了 $2$ 个独立的水浴，每个水浴都有自己的恒温器和再循环回路。在每个水浴内，将 $4$ 个充气水箱放置在同一个架子上，并专门连接到该水浴。每个水箱包含从一个大型、充分混合的种群中随机抽取的 $8$ 个个体。使用校准的呼吸测定法，在连续几天内对每个个体的耗氧率进行 $3$ 次测量。温度只在水浴层面进行控制；连接到同一水浴的所有水箱共享相同的再循环水和环境微气候。不存在其他区组因素。假设没有死亡、没有缺失数据，并且所有测量误差在设计层次结构的相应水平内是独立同分布的。\n\n研究人员计划使用固定效应单因素方差分析（ANOVA）来检验平均代谢率是否因温度而异。从实验单元、重复和自由度的核心定义出发，确定能避免该设计中伪重复的适当分析单元，并在一个尊重随机化、基于设计的分析下，计算温度效应 $F$ 检验的分母自由度。\n\n请提供温度效应 $F$ 检验的分母自由度作为最终答案（一个整数）。无需四舍五入。", "solution": "该问题要求在一个分层实验设计中，确定用于检验处理效应的 $F$ 检验的适当分析单元及其对应的分母自由度。解决方案要求严格应用实验单元和重复的定义，以避免伪重复的统计谬误。\n\n首先，我们必须定义核心概念。**实验单元** 是指能够独立施加一种处理的最小实验材料单位。真正的 **重复** 是将一种处理应用于多个独立的实验单元。**伪重复** 发生于将来自单个实验单元的子样本或重复测量误当作独立重复。方差分析（ANOVA）中处理效应的分母自由度必须基于真实实验单元的数量，而不是子样本或测量的数量。\n\n让我们剖析所描述的实验的分层结构。\n处理因子是温度，有 $a=3$ 个水平：$12^\\circ\\text{C}$、$18^\\circ\\text{C}$ 和 $24^\\circ\\text{C}$。\n\n处理之下的最高实验结构层次是 **水浴**。问题陈述道：“为每个温度维持了 $2$ 个独立的水浴，每个水浴都有自己的恒温器和再循环回路。”这个陈述至关重要。特定温度的施加是在水浴层面控制的。因为每个水浴都有自己的恒温器，所以将一个温度分配给一个水浴，在物理上和统计上都独立于分配给任何其他水浴。因此，**水浴是实验单元**。\n每个温度处理的真实重复数量是 $n=2$。\n整个实验中的实验单元总数是处理数乘以每个处理的重复数：$N = a \\times n = 3 \\times 2 = 6$。\n\n设计层次结构中的后续层次是这些实验单元内部的子样本。\n- **水箱**：在每个水浴内，有 $k=4$ 个水箱。这些水箱“共享相同的再循环水和环境微气候”。因此，来自同一水浴内不同水箱的观测值不是独立的。它们受到与该特定水浴的温度调节和水化学相关的相同随机误差的影响。这些水箱是 **子样本** 或 **观测单元**，而不是实验单元。\n- **个体**：在每个水箱内，有 $m=8$ 个个体。这些个体也是嵌套在水箱内的子样本。它们的代謝率不是独立的，因为它们共享水箱的共同环境，进而也共享水浴的共同环境。\n- **测量**：每个个体被测量 $p=3$ 次。这些是对同一个体的 **重复测量**，同样不是温度效应的独立重复。\n\n单因素 ANOVA 检验处理组均值相等的假设。该检验的 $F$ 统计量是处理均方与误差均方之比：\n$$ F = \\frac{\\text{MS}_{\\text{Treatment}}}{\\text{MS}_{\\text{Error}}} $$\n$\\text{MS}_{\\text{Treatment}}$ 量化了 $a=3$ 个温度组的平均代谢率*之间*的变异。其自由度为 $\\text{df}_{\\text{Treatment}} = a - 1 = 3 - 1 = 2$。\n$\\text{MS}_{\\text{Error}}$ 必须量化每个处理组内*真实实验单元之间*的随机变异。这就是水浴之间的变异。这个误差项的自由度，也就是 $F$ 检验的分母自由度，是根据实验单元总数（$N$）和处理组数（$a$）计算的。\n\n分母自由度由下式给出：\n$$ \\text{df}_{\\text{Error}} = N - a $$\n在此设计中，实验单元（水浴）的总数是 $N=6$，处理组（温度）的数量是 $a=3$。\n因此，温度效应 $F$ 检验的分母自由度为：\n$$ \\text{df}_{\\text{Error}} = 6 - 3 = 3 $$\n任何使用水箱总数（$24$）、个体总数（$192$）或测量总数（$576$）来计算误差自由度（例如，$24-3=21$，$192-3=189$ 或 $576-3=573$）的分析都将犯下伪重复的错误，导致统计功效的无效膨胀和犯第一类错误的高概率。正确的分析尊重了在水浴层面进行的随机化。温度效应的适当误差项是在 $a=3$ 个温度中的每一个温度下，观测到的 $n=2$ 个水浴之间的变异。", "answer": "$$\\boxed{3}$$", "id": "2538657"}, {"introduction": "许多生态学研究本质上都具有层次结构，例如样地嵌套在站点中，或个体嵌套在样方内。本练习超越了仅仅识别这种结构，引导我们利用线性混合模型对其进行显式建模，并在预算等现实约束下优化研究设计。这个高级练习将分层数据的概念与强大的混合模型框架联系起来，展示了如何运用统计理论来最大化我们科学结论的精度，从而最有效地利用有限的研究资源。[@problem_id:2538629]", "problem": "生态学家正在研究微气候如何在多个林分中调节林下植物的生长。林分 $j$ 中个体 $i$ 的响应被建模为一个具有固定斜率和特定于林分的随机截距的线性混合模型，\n$$\ny_{ij} = \\beta_0 + \\beta_1 x_{ij} + b_{0j} + \\epsilon_{ij},\n$$\n其中 $b_{0j} \\sim \\mathcal{N}(0,\\sigma_b^2)$ 在林分间独立，$\\epsilon_{ij} \\sim \\mathcal{N}(0,\\sigma_e^2)$ 在个体间独立且与 $b_{0j}$ 独立。该研究采用平衡设计，有 $J$ 个林分，每个林分有 $n$ 个个体。预测变量 $x_{ij}$ 的设计按如下方式控制：在每个林分 $j$ 内，样本均值 $\\bar{x}_j$ 和林分内样本方差 $v_w$ 由设计固定；在林分间，林分均值 $\\bar{x}_j$ 的方差固定为 $v_b$，且 $x_{ij}$ 的总均值等于零。也就是说，对于每个林分 $j$，$\\sum_{i=1}^{n} (x_{ij}-\\bar{x}_j)^2 = n\\,v_w$；在林分间，$\\frac{1}{J}\\sum_{j=1}^{J} \\bar{x}_j^2 = v_b$，且 $\\sum_{j=1}^{J} \\bar{x}_j = 0$。\n\n假设 $J \\geq 2$，$n \\geq 2$，且 $\\sigma_b^2 > 0$, $\\sigma_e^2 > 0$, $v_w > 0$, $v_b > 0$。\n\n任务：\n- 在高斯线性混合模型假设下，从第一性原理推导 $\\beta_1$ 的最佳线性无偏估计量 $\\hat{\\beta}_1$ 的方差 $\\operatorname{Var}(\\hat{\\beta}_1)$ 的精确表达式，该表达式用 $J$，$n$，$v_w$，$v_b$，$\\sigma_e^2$ 和 $\\sigma_b^2$ 表示。\n- 假设总预算固定为 $C$，每个林分的启动成本为 $c_0 > 0$，每个个体的测量成本为 $c_1 > 0$，因此 $J = C/(c_0 + c_1 n)$。保持 $C$ 固定且所有其他量为常数，确定使 $\\operatorname{Var}(\\hat{\\beta}_1)$ 最小化的林分内样本量 $n$。假设参数满足确保存在内部最优解的条件。使用具体参数值 $\\sigma_e^2 = 4$，$\\sigma_b^2 = 1$，$v_w = 1$，$v_b = 1$，$c_0 = 1$ 和 $c_1 = 1$ 来计算最优的 $n$。将最终数值答案四舍五入至四位有效数字。\n- 在你的推导过程中，简要论证 $J$ 和 $n$ 的设计选择如何控制 $\\hat{\\beta}_1$ 的精度，并定性地解释在此平衡设计下，增加 $J$ 和 $n$ 如何影响估计随机截距方差 $\\sigma_b^2$ 的精度。\n\n作为你的最终回答，仅报告如上所求的最优 $n$ 值，该值应为单个数值，四舍五入至四位有效数字，不带单位。", "solution": "所述问题具有科学依据，是良定且客观的。它提出了一个在使用线性混合模型的生态学研究统计设计中的标准问题，尽管细节繁多。所有必需的参数和约束都已提供，不存在内部矛盾或违反数学或科学原理的情况。该问题是有效的，并将推导出解答。\n\n林分 $j$ 中个体 $i$ 的响应 $y_{ij}$ 的模型由下式给出：\n$$\ny_{ij} = \\beta_0 + \\beta_1 x_{ij} + b_{0j} + \\epsilon_{ij}\n$$\n其中 $b_{0j} \\sim \\mathcal{N}(0, \\sigma_b^2)$ 和 $\\epsilon_{ij} \\sim \\mathcal{N}(0, \\sigma_e^2)$ 是独立随机变量。\n对于所有 $N=Jn$ 个观测值，该模型的矩阵表示法为 $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\mathbf{Z}\\mathbf{b} + \\boldsymbol{\\epsilon}$。响应向量 $\\mathbf{y}$ 的协方差矩阵为 $\\mathbf{V} = \\operatorname{Var}(\\mathbf{y}) = \\mathbf{Z}\\operatorname{Var}(\\mathbf{b})\\mathbf{Z}^T + \\operatorname{Var}(\\boldsymbol{\\epsilon}) = \\sigma_b^2 \\mathbf{Z}\\mathbf{Z}^T + \\sigma_e^2 \\mathbf{I}_{Jn}$。\n在有 $J$ 个林分、每个林分有 $n$ 个个体的平衡设计下，矩阵 $\\mathbf{Z}$ 的结构为 $\\mathbf{Z} = \\mathbf{I}_J \\otimes \\mathbf{1}_n$，其中 $\\mathbf{I}_J$ 是 $J \\times J$ 的单位矩阵，$\\mathbf{1}_n$ 是 $n \\times 1$ 的全1向量。这给出 $\\mathbf{Z}\\mathbf{Z}^T = \\mathbf{I}_J \\otimes \\mathbf{J}_n$，其中 $\\mathbf{J}_n$ 是 $n \\times n$ 的全1矩阵。\n协方差矩阵 $\\mathbf{V}$ 是块对角的：\n$$\n\\mathbf{V} = \\sigma_b^2 (\\mathbf{I}_J \\otimes \\mathbf{J}_n) + \\sigma_e^2 (\\mathbf{I}_J \\otimes \\mathbf{I}_n) = \\mathbf{I}_J \\otimes (\\sigma_e^2 \\mathbf{I}_n + \\sigma_b^2 \\mathbf{J}_n)\n$$\n$\\boldsymbol{\\beta} = [\\beta_0, \\beta_1]^T$ 的最佳线性无偏估计量(BLUE)是广义最小二乘(GLS)估计量 $\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{V}^{-1} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{V}^{-1} \\mathbf{y}$，其方差-协方差矩阵为 $\\operatorname{Var}(\\hat{\\boldsymbol{\\beta}}) = (\\mathbf{X}^T \\mathbf{V}^{-1} \\mathbf{X})^{-1}$。我们需要推导该矩阵的(2,2)元素，它对应于 $\\operatorname{Var}(\\hat{\\beta}_1)$。\n\n协方差矩阵的逆 $\\mathbf{V}^{-1}$ 也是块对角的：$\\mathbf{V}^{-1} = \\mathbf{I}_J \\otimes (\\sigma_e^2 \\mathbf{I}_n + \\sigma_b^2 \\mathbf{J}_n)^{-1}$。使用 Sherman-Morrison-Woodbury 公式，块的逆矩阵为：\n$$\n(\\sigma_e^2 \\mathbf{I}_n + \\sigma_b^2 \\mathbf{J}_n)^{-1} = \\frac{1}{\\sigma_e^2}\\mathbf{I}_n - \\frac{\\sigma_b^2}{\\sigma_e^2(\\sigma_e^2 + n\\sigma_b^2)}\\mathbf{J}_n\n$$\n让我们将这个 $n \\times n$ 的块矩阵表示为 $\\mathbf{V}_{\\text{block}}^{-1}$。矩阵 $\\mathbf{X}^T \\mathbf{V}^{-1} \\mathbf{X}$ 是 $\\boldsymbol{\\beta}$ 的 Fisher 信息矩阵。由于其块结构，它可以计算为对 $J$ 个林分的求和：\n$$\n\\mathbf{X}^T \\mathbf{V}^{-1} \\mathbf{X} = \\sum_{j=1}^{J} \\mathbf{X}_j^T \\mathbf{V}_{\\text{block}}^{-1} \\mathbf{X}_j = \\sum_{j=1}^{J} \\begin{pmatrix} \\mathbf{1}_n^T \\\\ \\mathbf{x}_j^T \\end{pmatrix} \\mathbf{V}_{\\text{block}}^{-1} \\begin{pmatrix} \\mathbf{1}_n & \\mathbf{x}_j \\end{pmatrix}\n= \\sum_{j=1}^{J} \\begin{pmatrix} \\mathbf{1}_n^T \\mathbf{V}_{\\text{block}}^{-1} \\mathbf{1}_n & \\mathbf{1}_n^T \\mathbf{V}_{\\text{block}}^{-1} \\mathbf{x}_j \\\\ \\mathbf{x}_j^T \\mathbf{V}_{\\text{block}}^{-1} \\mathbf{1}_n & \\mathbf{x}_j^T \\mathbf{V}_{\\text{block}}^{-1} \\mathbf{x}_j \\end{pmatrix}\n$$\n问题陈述，对于预测变量 $x_{ij}$，由于条件 $\\sum_{j=1}^{J} \\bar{x}_j = 0$，其总均值为零。这极大地简化了计算，因为它使得设计矩阵 $\\mathbf{X}$ 的列相对于权重矩阵 $\\mathbf{V}^{-1}$ 是正交的。\n让我们验证这一点。非对角元素是 $\\sum_j \\mathbf{1}_n^T \\mathbf{V}_{\\text{block}}^{-1} \\mathbf{x}_j$。\n首先，$\\mathbf{1}_n^T \\mathbf{V}_{\\text{block}}^{-1} = \\mathbf{1}_n^T (\\frac{1}{\\sigma_e^2}\\mathbf{I}_n - \\frac{\\sigma_b^2}{\\sigma_e^2(\\sigma_e^2 + n\\sigma_b^2)}\\mathbf{J}_n) = \\frac{1}{\\sigma_e^2}\\mathbf{1}_n^T - \\frac{n\\sigma_b^2}{\\sigma_e^2(\\sigma_e^2 + n\\sigma_b^2)}\\mathbf{1}_n^T = \\frac{\\sigma_e^2 + n\\sigma_b^2 - n\\sigma_b^2}{\\sigma_e^2(\\sigma_e^2 + n\\sigma_b^2)}\\mathbf{1}_n^T = \\frac{1}{\\sigma_e^2 + n\\sigma_b^2}\\mathbf{1}_n^T$。\n因此，非对角元素是 $\\sum_j \\frac{1}{\\sigma_e^2 + n\\sigma_b^2} \\mathbf{1}_n^T \\mathbf{x}_j = \\frac{n}{\\sigma_e^2 + n\\sigma_b^2} \\sum_j \\bar{x}_j = 0$。\n因此矩阵 $\\mathbf{X}^T \\mathbf{V}^{-1} \\mathbf{X}$ 是对角矩阵。我们只需要计算其(2,2)元素，即 $\\sum_{j=1}^{J} \\mathbf{x}_j^T \\mathbf{V}_{\\text{block}}^{-1} \\mathbf{x}_j$。\n$$\n\\mathbf{x}_j^T \\mathbf{V}_{\\text{block}}^{-1} \\mathbf{x}_j = \\mathbf{x}_j^T \\left( \\frac{1}{\\sigma_e^2}\\mathbf{I}_n - \\frac{\\sigma_b^2}{\\sigma_e^2(\\sigma_e^2 + n\\sigma_b^2)}\\mathbf{J}_n \\right) \\mathbf{x}_j = \\frac{1}{\\sigma_e^2}\\sum_{i=1}^{n}x_{ij}^2 - \\frac{\\sigma_b^2(n\\bar{x}_j)^2}{\\sigma_e^2(\\sigma_e^2 + n\\sigma_b^2)}\n$$\n使用恒等式 $\\sum_i x_{ij}^2 = \\sum_i (x_{ij}-\\bar{x}_j)^2 + n\\bar{x}_j^2 = n v_w + n\\bar{x}_j^2$，我们得到：\n$$\n\\mathbf{x}_j^T \\mathbf{V}_{\\text{block}}^{-1} \\mathbf{x}_j = \\frac{n v_w + n\\bar{x}_j^2}{\\sigma_e^2} - \\frac{n^2\\bar{x}_j^2\\sigma_b^2}{\\sigma_e^2(\\sigma_e^2 + n\\sigma_b^2)} = \\frac{n v_w}{\\sigma_e^2} + n\\bar{x}_j^2\\left(\\frac{1}{\\sigma_e^2} - \\frac{n\\sigma_b^2}{\\sigma_e^2(\\sigma_e^2 + n\\sigma_b^2)}\\right)\n$$\n$$\n= \\frac{n v_w}{\\sigma_e^2} + n\\bar{x}_j^2\\left(\\frac{\\sigma_e^2+n\\sigma_b^2 - n\\sigma_b^2}{\\sigma_e^2(\\sigma_e^2 + n\\sigma_b^2)}\\right) = \\frac{n v_w}{\\sigma_e^2} + \\frac{n\\bar{x}_j^2}{\\sigma_e^2 + n\\sigma_b^2}\n$$\n对所有林分 $j$ 求和：\n$$\n[\\mathbf{X}^T \\mathbf{V}^{-1} \\mathbf{X}]_{22} = \\sum_{j=1}^{J} \\left( \\frac{n v_w}{\\sigma_e^2} + \\frac{n\\bar{x}_j^2}{\\sigma_e^2 + n\\sigma_b^2} \\right) = \\frac{J n v_w}{\\sigma_e^2} + \\frac{n}{\\sigma_e^2 + n\\sigma_b^2}\\sum_{j=1}^{J}\\bar{x}_j^2\n$$\n使用设计约束 $\\sum_j \\bar{x}_j^2 = J v_b$，上式变为：\n$$\n[\\mathbf{X}^T \\mathbf{V}^{-1} \\mathbf{X}]_{22} = \\frac{J n v_w}{\\sigma_e^2} + \\frac{J n v_b}{\\sigma_e^2 + n\\sigma_b^2}\n$$\n由于 $\\mathbf{X}^T \\mathbf{V}^{-1} \\mathbf{X}$ 是对角矩阵，$\\operatorname{Var}(\\hat{\\beta}_1)$ 是该项的倒数。\n$$\n\\operatorname{Var}(\\hat{\\beta}_1) = \\left( \\frac{J n v_w}{\\sigma_e^2} + \\frac{J n v_b}{\\sigma_e^2 + n\\sigma_b^2} \\right)^{-1} = \\frac{1}{Jn \\left( \\frac{v_w}{\\sigma_e^2} + \\frac{v_b}{\\sigma_e^2 + n\\sigma_b^2} \\right)}\n$$\n这个表达式表示固定斜率估计量的方差。它与总信息量成反比，总信息量是林分内信息 ($Jnv_w/\\sigma_e^2$) 和林分间信息 ($Jnv_b/(\\sigma_e^2 + n\\sigma_b^2)$) 的总和。\n\n接下来，我们在预算约束 $J = C / (c_0 + c_1 n)$ 下，关于林分内样本量 $n$ 来最小化此方差。为了最小化方差，我们最大化其倒数，即信息量 $I(n)$：\n$$\nI(n) = \\frac{C n}{c_0 + c_1 n} \\left( \\frac{v_w}{\\sigma_e^2} + \\frac{v_b}{\\sigma_e^2 + n\\sigma_b^2} \\right)\n$$\n我们对 $I(n)$ 关于 $n$ 求导，并令导数为零。\n$$\n\\frac{dI}{dn} = C \\left[ \\frac{d}{dn}\\left(\\frac{n}{c_0+c_1n}\\right) \\frac{v_w}{\\sigma_e^2} + \\frac{d}{dn}\\left(\\frac{n}{(c_0+c_1n)(\\sigma_e^2+n\\sigma_b^2)}\\right)v_b \\right] = 0\n$$\n各个分量的导数是：\n$$\n\\frac{d}{dn}\\left(\\frac{n}{c_0+c_1n}\\right) = \\frac{c_0}{(c_0+c_1n)^2}\n$$\n$$\n\\frac{d}{dn}\\left(\\frac{n}{(c_0+c_1n)(\\sigma_e^2+n\\sigma_b^2)}\\right) = \\frac{c_0\\sigma_e^2 - c_1n^2\\sigma_b^2}{((c_0+c_1n)(\\sigma_e^2+n\\sigma_b^2))^2}\n$$\n令 $\\frac{dI}{dn}=0$ 并除以公共的正因子，得到：\n$$\n\\frac{v_w}{\\sigma_e^2} \\frac{c_0}{(c_0+c_1n)^2} + \\frac{v_b(c_0\\sigma_e^2 - c_1n^2\\sigma_b^2)}{(c_0+c_1n)^2(\\sigma_e^2+n\\sigma_b^2)^2} = 0\n$$\n$$\n\\frac{v_w}{\\sigma_e^2} (\\sigma_e^2+n\\sigma_b^2)^2 + v_b(c_0\\sigma_e^2 - c_1n^2\\sigma_b^2) = 0\n$$\n展开并按 $n$ 的幂次合并同类项：\n$$\n\\frac{v_w}{\\sigma_e^2} ((\\sigma_e^2)^2 + 2n\\sigma_e^2\\sigma_b^2 + n^2(\\sigma_b^2)^2) + v_b c_0\\sigma_e^2 - v_b c_1 n^2\\sigma_b^2 = 0\n$$\n$$\nn^2\\left(\\frac{v_w(\\sigma_b^2)^2}{\\sigma_e^2} - v_b c_1\\sigma_b^2\\right) + n(2v_w\\sigma_b^2) + (v_w\\sigma_e^2 + v_b c_0\\sigma_e^2) = 0\n$$\n我们代入给定的参数值：$\\sigma_e^2 = 4$, $\\sigma_b^2 = 1$, $v_w = 1$, $v_b = 1$, $c_0 = 1$ 和 $c_1 = 1$。\n$$\nn^2\\left(\\frac{1(1)^2}{4} - 1(1)(1)\\right) + n(2(1)(1)) + (1(4) + 1(1)(4)) = 0\n$$\n$$\nn^2\\left(\\frac{1}{4} - 1\\right) + 2n + (4+4)=0\n$$\n$$\n-\\frac{3}{4}n^2 + 2n + 8 = 0\n$$\n乘以 $-4$ 以去掉分数和前导负号：\n$$\n3n^2 - 8n - 32 = 0\n$$\n这是一个关于 $n$ 的一元二次方程。我们使用求根公式，由于 $n$ 必须为正，因此取正根：\n$$\nn = \\frac{-(-8) + \\sqrt{(-8)^2 - 4(3)(-32)}}{2(3)} = \\frac{8 + \\sqrt{64 + 384}}{6} = \\frac{8 + \\sqrt{448}}{6}\n$$\n化简根式：$\\sqrt{448} = \\sqrt{64 \\times 7} = 8\\sqrt{7}$。\n$$\nn = \\frac{8 + 8\\sqrt{7}}{6} = \\frac{4 + 4\\sqrt{7}}{3} = \\frac{4}{3}(1+\\sqrt{7})\n$$\n数值上，这大约是 $n \\approx 4.860965...$。四舍五入到四位有效数字，得到 $n = 4.861$。\n\n最后，我们提供所要求的论证。\n$\\hat{\\beta}_1$ 的精度是信息量 $I(\\hat{\\beta}_1) = 1/\\operatorname{Var}(\\hat{\\beta}_1) = Jn(\\frac{v_w}{\\sigma_e^2} + \\frac{v_b}{\\sigma_e^2+n\\sigma_b^2})$。该精度取决于设计选择 $J$ 和 $n$。增加 $J$ (林分数)会线性增加林分内和林分间的信息分量，从而总是能提高精度。增加 $n$ (每个林分的个体数)也会增加这两个分量；然而，它对林分间信息的贡献 $\\frac{n}{\\sigma_e^2+n\\sigma_b^2} = \\frac{1}{\\sigma_e^2/n + \\sigma_b^2}$ 表现出收益递减，当 $n \\to \\infty$ 时，其极限为 $1/\\sigma_b^2$。预算约束迫使在 $J$ 和 $n$ 之间进行权衡。最优设计平衡了增加一个林分与在现有林分中增加一个个体所带来的边际信息增益。\n\n随机截距方差估计 $\\hat{\\sigma}_b^2$ 的精度主要由林分数 $J$ 决定。参数 $\\sigma_b^2$ 描述了林分*间*的变异性。为了估计一个方差，需要多个数据点；在此背景下，估计的随机效应 $\\hat{b}_{0j}$ 就充当了这些数据点。更大的 $J$ 提供了更多的这些点，从而可以对其方差进行更稳定和精确的估计。林分内样本量 $n$ 起到次要作用：更大的 $n$ 会减少林分水平均值 $\\bar{y}_j$ 中的误差($\\bar{\\epsilon}_j$)，从而可以更精确地估计每个单独的随机效应 $b_{0j}$。这“清理”了用于估计 $\\sigma_b^2$ 的数据。然而，如果没有足够数量的林分 $J$，即使完美估计的 $b_{0j}$ (来自无限的 $n$) 也会得出一个不佳的 $\\sigma_b^2$ 估计。因此，要高精度地估计 $\\sigma_b^2$，增加 $J$ 从根本上说比增加 $n$ 更重要。", "answer": "$$\n\\boxed{4.861}\n$$", "id": "2538629"}]}