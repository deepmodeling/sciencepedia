{"hands_on_practices": [{"introduction": "生态学的核心任务之一是理解个体生命史特征如何汇集成种群层面的动态。本练习将指导您构建一个阶段结构的种群模型，这是一种将个体生存、生长和繁殖率等生命周期参数综合为预测整个种群长期行为的强大工具。通过计算Lefkovitch矩阵的主特征值（$\\lambda$）及其相关的特征向量，您将能够量化种群的渐进增长率、稳定的阶段分布和繁殖价值，这些都是无法仅从个体层面观察到的关键涌现特性。[@problem_id:2502393]", "problem": "一个阶段结构种群在种群水平（一个生态组织层次）上进行监测，具有三个生命阶段：幼苗（$L$）、幼体（$J$）和成体（$A$）。普查间隔为一年。在两次普查之间，个体可以停留在当前阶段或生长到下一个阶段；不存在退化。成体进行繁殖，其后代在下一次普查时进入幼苗阶段。根据长期人口统计数据估算出以下年度生命率：\n\n- 幼苗停滞：一株幼苗以 $0.4$ 的概率保持为幼苗。\n- 幼苗生长：一株幼苗以 $0.3$ 的概率成长为幼体。\n- 幼体停滞：一个个体以 $0.6$ 的概率保持为幼体。\n- 幼体生长：一个个体以 $0.2$ 的概率成长为成体。\n- 成体停滞（存活）：一个个体以 $0.8$ 的概率保持为成体。\n- 繁殖力：每个成体平均产生 $4$ 个新个体，这些新个体能存活到在下一次普查时被计为幼苗；幼体和幼苗不繁殖。\n\n1) 仅使用核心定义，即下一年的种群向量 $\\mathbf{n}_{t+1}$ 由阶段投影矩阵 $\\mathbf{A}$ 作用于当前种群向量 $\\mathbf{n}_{t}$ 得到，即 $\\mathbf{n}_{t+1}=\\mathbf{A}\\mathbf{n}_{t}$，并且 $\\mathbf{A}$ 的一个元素 $a_{ij}$ 是指在时间 $t$ 的一个 $j$ 阶段个体在时间 $t+1$ 所产生的 $i$ 阶段个体的期望数量，构建一个阶段顺序为 $(L,J,A)$ 的 $3\\times 3$ Lefkovitch 矩阵 $\\mathbf{A}$。\n\n2) 根据线性种群模型的第一性原理和适用于非负本原矩阵的 Perron–Frobenius 定理，计算 $\\mathbf{A}$ 的主特征值 $\\lambda$，该值是种群的渐近逐年倍增率。将 $\\lambda$ 的最终数值答案四舍五入到四位有效数字。将 $\\lambda$ 表示为一个无量纲的年倍增因子。\n\n3) 确定稳定阶段分布（与 $\\lambda$ 相关的右特征向量，归一化使其和为 $1$）和繁殖价值向量（与 $\\lambda$ 相关的左特征向量，归一化使成体繁殖价值等于 $1$）。从生态学角度简要解释这些向量，将它们与种群水平的推断范围联系起来。\n\n最终答案只需要 $\\lambda$ 的数值。所有的中间步骤和解释都必须在您的解题过程中展示出来。", "solution": "所提出的问题是线性种群动态学中的一个标准练习，具体涉及阶段结构模型。它具有科学依据、问题适定、客观，并包含得出唯一解所需的所有信息。我们将着手进行分析。\n\n该问题要求一个由三部分组成的解：$1$) 构建阶段投影矩阵， $2$) 计算其主特征值，以及 $3$) 确定并解释相关的右特征向量和左特征向量。\n\n第1部分：构建 Lefkovitch 矩阵 $\\mathbf{A}$\n\n种群被划分为三个阶段：幼苗（$L$）、幼体（$J$）和成体（$A$）。在时间 $t$ 的种群状态由向量 $\\mathbf{n}_{t} = \\begin{pmatrix} n_L(t) \\\\ n_J(t) \\\\ n_A(t) \\end{pmatrix}$ 给出。其动态由线性递推关系 $\\mathbf{n}_{t+1} = \\mathbf{A} \\mathbf{n}_{t}$ 控制，其中 $\\mathbf{A}$ 是 $3 \\times 3$ 的 Lefkovitch 矩阵。$\\mathbf{A}$ 的元素 $a_{ij}$ 表示在时间 $t$ 处于阶段 $j$ 的个体对时间 $t+1$ 处于阶段 $i$ 的人均贡献。阶段顺序指定为 ($L, J, A$)。\n\n我们使用给定的生命率来构建矩阵 $\\mathbf{A}$：\n-   $a_{11}$：从幼苗到幼苗的贡献。这是幼苗的停滞概率，给定为 $0.4$。\n-   $a_{12}$：从幼体到幼苗的贡献。幼体不繁殖，所以此项为 $0$。\n-   $a_{13}$：从成体到幼苗的贡献。这是繁殖力，给定为每个成体平均产生 $4$ 个新幼苗。\n-   $a_{21}$：从幼苗到幼体的贡献。这是幼苗的生长概率，给定为 $0.3$。\n-   $a_{22}$：从幼体到幼体的贡献。这是幼体的停滞概率，给定为 $0.6$。\n-   $a_{23}$：从成体到幼体的贡献。不存在退化，所以成体不能变回幼体。此项为 $0$。\n-   $a_{31}$：从幼苗到成体的贡献。幼苗必须经过幼体阶段，所以它们不能在一个时间步内变成成体。此项为 $0$。\n-   $a_{32}$：从幼体到成体的贡献。这是幼体的生长概率，给定为 $0.2$。\n-   $a_{33}$：从成体到成体的贡献。这是成体的停滞（存活）概率，给定为 $0.8$。\n\n综合这些元素，Lefkovitch 矩阵 $\\mathbf{A}$ 为：\n$$\n\\mathbf{A} = \\begin{pmatrix} 0.4  0  4 \\\\ 0.3  0.6  0 \\\\ 0  0.2  0.8 \\end{pmatrix}\n$$\n\n第2部分：计算主特征值 $\\lambda$\n\n种群的长期渐近增长率由 $\\mathbf{A}$ 的主特征值给出。特征值 $\\lambda$ 是特征方程 $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$ 的根，其中 $\\mathbf{I}$ 是单位矩阵。\n\n$$\n\\det\\left( \\begin{pmatrix} 0.4  0  4 \\\\ 0.3  0.6  0 \\\\ 0  0.2  0.8 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\right) = 0\n$$\n$$\n\\det\\begin{pmatrix} 0.4-\\lambda  0  4 \\\\ 0.3  0.6-\\lambda  0 \\\\ 0  0.2  0.8-\\lambda \\end{pmatrix} = 0\n$$\n我们使用沿第一行的代数余子式展开来计算行列式：\n$$\n(0.4-\\lambda) \\begin{vmatrix} 0.6-\\lambda  0 \\\\ 0.2  0.8-\\lambda \\end{vmatrix} - 0 \\cdot \\begin{vmatrix} 0.3  0 \\\\ 0  0.8-\\lambda \\end{vmatrix} + 4 \\cdot \\begin{vmatrix} 0.3  0.6-\\lambda \\\\ 0  0.2 \\end{vmatrix} = 0\n$$\n$$\n(0.4-\\lambda)((0.6-\\lambda)(0.8-\\lambda) - 0) + 4((0.3)(0.2) - 0) = 0\n$$\n$$\n(0.4-\\lambda)(0.48 - 1.4\\lambda + \\lambda^2) + 0.24 = 0\n$$\n$$\n0.192 - 0.56\\lambda + 0.4\\lambda^2 - 0.48\\lambda + 1.4\\lambda^2 - \\lambda^3 + 0.24 = 0\n$$\n这简化为特征多项式：\n$$\n-\\lambda^3 + 1.8\\lambda^2 - 1.04\\lambda + 0.432 = 0\n$$\n或者，乘以 $-1$：\n$$\n\\lambda^3 - 1.8\\lambda^2 + 1.04\\lambda - 0.432 = 0\n$$\n矩阵 $\\mathbf{A}$ 是非负且本原的（因为 $\\mathbf{A}^2$ 的所有元素都严格为正），因此 Perron-Frobenius 定理保证了存在一个唯一的、单的、实的、正的特征值 $\\lambda_1$，其模严格大于所有其他特征值。这个 $\\lambda_1$ 就是渐近种群增长率。这个三次方程必须进行数值求解。实根被求得为：\n$$\n\\lambda \\approx 1.2428\n$$\n另外两个根是一对共轭复数，其模小于 $\\lambda$。按要求四舍五入到四位有效数字，主特征值为 $1.243$。\n\n第3部分：稳定阶段分布和繁殖价值\n\n稳定阶段分布是对应于主特征值 $\\lambda$ 的右特征向量 $\\mathbf{w}$。它满足 $\\mathbf{A}\\mathbf{w} = \\lambda\\mathbf{w}$。$\\mathbf{w}$ 的分量代表了每个阶段个体的稳定比例。\n$$\n\\begin{pmatrix} 0.4  0  4 \\\\ 0.3  0.6  0 \\\\ 0  0.2  0.8 \\end{pmatrix} \\begin{pmatrix} w_L \\\\ w_J \\\\ w_A \\end{pmatrix} = \\lambda \\begin{pmatrix} w_L \\\\ w_J \\\\ w_A \\end{pmatrix}\n$$\n这就产生了一个线性方程组。我们可以求解各分量的比率。例如，从第三行，我们有 $0.2w_J + 0.8w_A = \\lambda w_A$，这给出 $w_J = \\frac{\\lambda - 0.8}{0.2} w_A$。使用 $\\lambda \\approx 1.2428$，我们发现 $w_J \\approx 2.214 w_A$。从第二行，我们有 $0.3w_L + 0.6w_J = \\lambda w_J$，这给出 $w_L = \\frac{\\lambda - 0.6}{0.3} w_J$。这给出 $w_L \\approx 2.143 w_J \\approx 4.745 w_A$。该特征向量与 $\\begin{pmatrix} 4.745 \\\\ 2.214 \\\\ 1 \\end{pmatrix}$ 成比例。归一化使各分量之和为 $1$：\n$$\n\\mathbf{w} = \\frac{1}{4.745 + 2.214 + 1} \\begin{pmatrix} 4.745 \\\\ 2.214 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0.596 \\\\ 0.278 \\\\ 0.126 \\end{pmatrix}\n$$\n从生态学上讲，这个向量描述了种群在平衡时的结构：它将由大约 $59.6\\%$ 的幼苗、 $27.8\\%$ 的幼体和 $12.6\\%$ 的成体组成。这是一个种群水平的涌现特性。\n\n繁殖价值向量是对应于 $\\lambda$ 的左特征向量 $\\mathbf{v}$。它满足 $\\mathbf{v}^T\\mathbf{A} = \\lambda\\mathbf{v}^T$。其分量衡量了每个阶段的个体对未来种群增长的相对贡献。\n$$\n\\begin{pmatrix} v_L  v_J  v_A \\end{pmatrix} \\begin{pmatrix} 0.4  0  4 \\\\ 0.3  0.6  0 \\\\ 0  0.2  0.8 \\end{pmatrix} = \\lambda \\begin{pmatrix} v_L  v_J  v_A \\end{pmatrix}\n$$\n这给出了另一个方程组。归一化使成体的繁殖价值为 $1$ ($v_A = 1$)，我们使用第二个方程：$0.6v_J + 0.2v_A = \\lambda v_J$，这给出 $v_J = \\frac{0.2}{\\lambda - 0.6} v_A \\approx 0.311$。从第三个方程：$4v_L + 0.8v_A = \\lambda v_A$，这给出 $v_L = \\frac{\\lambda - 0.8}{4} v_A \\approx 0.111$。\n繁殖价值向量是：\n$$\n\\mathbf{v} = \\begin{pmatrix} 0.111 \\\\ 0.311 \\\\ 1 \\end{pmatrix}\n$$\n从生态学上讲，就其对后代各自的预期贡献而言，一个幼体的价值大约是成体的 $31.1\\%$，一个幼苗的价值大约是成体的 $11.1\\%$。这反映了存活并达到繁殖成体阶段的概率。这也是一个种群水平的概念，由所有阶段的生活史权衡所决定。\n\n最终要求的答案是主特征值 $\\lambda$ 的数值。\n$$\n\\lambda \\approx 1.243\n$$", "answer": "$$\\boxed{1.243}$$", "id": "2502393"}, {"introduction": "在不同尺度上分析生态数据时，我们观察到的模式可能会发生巨大变化甚至逆转，这种现象被称为辛普森悖论。这个练习提供了一个经典案例，要求您辨析相关性与因果性之间的差异，这在跨越不同生态组织层次（例如，从特定生境到整个景观）进行推断时至关重要。通过分层分析和运用因果有向无环图（DAGs），您将学会如何识别和控制混淆变量，从而揭示潜在的、真实的生态学关系，避免因错误聚合数据而得出误导性结论。[@problem_id:2502384]", "problem": "在一项于两个不同景观层内进行的群落水平的野外研究中，调查了一个目标鸟类物种在两种生境类型中的存在情况。这两个景观层，记为 $S \\in \\{A,B\\}$，在非生物条件和可达性方面有所不同，这也影响了抽样力度。在每个层内，两种生境类型为 $H \\in \\{\\text{Forest}, \\text{Meadow}\\}$。响应变量为物种存在情况，$Y \\in \\{1,0\\}$，按样方记录。以下计数是每个层和生境内独立样方的总和：\n\n- $S=A$ 层：Forest 有 $19$ 例存在和 $1$ 例缺失；Meadow 有 $900$ 例存在和 $100$ 例缺失。\n- $S=B$ 层：Forest 有 $60$ 例存在和 $940$ 例缺失；Meadow 有 $1$ 例存在和 $19$ 例缺失。\n\n假设 $S$ 对生境分配 $H$（通过可达性和可利用性）和物种存在情况 $Y$（通过非生物条件）都有因果影响，并且 $H$ 可能对 $Y$ 有因果影响。您将评估层内和跨层的总体水平上的物种-生境关联，然后使用因果有向无环图 (DAG) 来调和任何悖论。\n\n任务：\n\n1. 根据比较 $\\text{Forest}$ 与 $\\text{Meadow}$ 的优势比的定义，即 $\\text{Forest}$ 中 $Y=1$ 的优势与 $\\text{Meadow}$ 中 $Y=1$ 的优势之比，计算 $S=A$ 和 $S=B$ 的特定层优势比。\n2. 跨层汇总数据，并计算比较 $\\text{Forest}$ 与 $\\text{Meadow}$ 的边际优势比。确定关联方向是否相对于两个特定层的关联都发生了逆转，从而证明辛普森悖论。\n3. 指定一个包含节点 $S$、$H$ 和 $Y$ 且与上述文字假设一致的因果有向无环图。根据因果识别的第一性原理，陈述用于估计 $H$ 对 $Y$ 的因果效应的最小充分调整集。\n4. 假设在根据您的 DAG 进行适当调整后，一个共同的因果优势比在各层中都成立，请使用一个一致的分层估计量，计算一个单一的、比较 $\\text{Forest}$ 与 $\\text{Meadow}$ 且经过分层调整的优势比。将最终调整后的优势比四舍五入到四位有效数字，并将其报告为一个无单位的纯数字。\n\n只需提供任务 4 的值作为您的最终答案。", "solution": "该问题要求对一项生态学研究的计数数据进行系统性分析，以评估物种-生境关联，证明辛普森悖论，并使用因果推断的原理来解决它。分析分四个步骤进行。\n\n首先，我们定义我们的符号。令 $Y \\in \\{1, 0\\}$ 分别表示物种的存在和缺失。令 $H \\in \\{\\text{Forest}, \\text{Meadow}\\}$ 为生境类型。该研究按景观层 $S \\in \\{A, B\\}$ 进行分层。对于每个层 $i \\in \\{A, B\\}$，数据可以表示为一个 $2 \\times 2$ 列联表：\n- $a_i$：在 Forest ($H=\\text{Forest}$) 中存在 ($Y=1$) 的计数。\n- $b_i$：在 Forest ($H=\\text{Forest}$) 中缺失 ($Y=0$) 的计数。\n- $c_i$：在 Meadow ($H=\\text{Meadow}$) 中存在 ($Y=1$) 的计数。\n- $d_i$：在 Meadow ($H=\\text{Meadow}$) 中缺失 ($Y=0$) 的计数。\n\n给定生境中物种存在的优势定义为存在数与缺失数之比。比较 Forest 与 Meadow 的优势比（$OR$）是它们各自优势的比值。\n$$ OR = \\frac{\\text{Odds}(Y=1|H=\\text{Forest})}{\\text{Odds}(Y=1|H=\\text{Meadow})} = \\frac{a/b}{c/d} = \\frac{ad}{bc} $$\n\n任务 1：计算特定层的优势比。\n对于 $A$ 层，数据为 $a_A = 19$，$b_A = 1$，$c_A = 900$，$d_A = 100$。\n$A$ 层的优势比为：\n$$ OR_A = \\frac{a_A d_A}{b_A c_A} = \\frac{19 \\times 100}{1 \\times 900} = \\frac{1900}{900} = \\frac{19}{9} $$\n由于 $OR_A \\approx 2.11  1$，在 $A$ 层中，Forest 生境与物种存在之间存在正相关。\n\n对于 $B$ 层，数据为 $a_B = 60$，$b_B = 940$，$c_B = 1$，$d_B = 19$。\n$B$ 层的优势比为：\n$$ OR_B = \\frac{a_B d_B}{b_B c_B} = \\frac{60 \\times 19}{940 \\times 1} = \\frac{1140}{940} = \\frac{114}{94} = \\frac{57}{47} $$\n由于 $OR_B \\approx 1.21  1$，在 $B$ 层中也存在正相关。\n\n任务 2：计算边际优势比并证明辛普森悖论。\n为计算边际优势比，我们汇总两个层的数据。\n在 Forest 中的总计数：$a = a_A + a_B = 19 + 60 = 79$ 例存在；$b = b_A + b_B = 1 + 940 = 941$ 例缺失。\n在 Meadow 中的总计数：$c = c_A + c_B = 900 + 1 = 901$ 例存在；$d = d_A + d_B = 100 + 19 = 119$ 例缺失。\n边际优势比 $OR_M$ 由此汇总表计算得出：\n$$ OR_M = \\frac{a d}{b c} = \\frac{79 \\times 119}{941 \\times 901} = \\frac{9401}{847841} $$\n数值上，$OR_M \\approx 0.011$。该值小于 $1$，表明在数据汇总时，Forest 生境与物种存在之间存在负相关。与特定层的关联（$OR_A  1$ 和 $OR_B  1$）相比，关联方向发生了逆转。这种逆转就是辛普森悖论的定义。\n\n任务 3：指定因果有向无环图 (DAG) 和调整集。\n问题陈述提供了因果关系：\n1. $S$ 对 $H$ 有因果影响（$S \\to H$）。\n2. $S$ 对 $Y$ 有因果影响（$S \\to Y$）。\n3. $H$ 可能对 $Y$ 有因果影响（$H \\to Y$）。\n这些关系定义了一个 DAG，其中 $S$ 是 $H$ 和 $Y$ 的共同原因：\n$$ H \\leftarrow S \\to Y $$\n路径 $H \\leftarrow S \\to Y$ 是一条从 $H$ 到 $Y$ 的非因果“后门”路径，它导致了伪相关。为了估计 $H$ 对 $Y$ 的因果效应（路径 $H \\to Y$），必须通过对混杂变量 $S$ 进行条件化来阻断这条后门路径。因此，最小充分调整集是 $\\{S\\}$。这证明了使用分层分析的合理性。\n\n任务 4：计算分层调整后的优势比。\n为了获得经 $S$ 的混杂效应调整后的 $H$ 对 $Y$ 效应的单一优势比估计值，我们使用 Mantel-Haenszel 估计量。该估计量计算特定层优势比的加权平均值。公式为：\n$$ OR_{MH} = \\frac{\\sum_{i=A,B} \\frac{a_i d_i}{n_i}}{\\sum_{i=A,B} \\frac{b_i c_i}{n_i}} $$\n其中 $n_i = a_i + b_i + c_i + d_i$ 是第 $i$ 层的总样本量。\n\n首先，我们计算每个层的总样本量：\n$n_A = 19 + 1 + 900 + 100 = 1020$。\n$n_B = 60 + 940 + 1 + 19 = 1020$。\n\n现在，我们计算 $OR_{MH}$ 公式的分子和分母：\n分子：\n$$ \\sum_{i} \\frac{a_i d_i}{n_i} = \\frac{19 \\times 100}{1020} + \\frac{60 \\times 19}{1020} = \\frac{1900}{1020} + \\frac{1140}{1020} = \\frac{3040}{1020} $$\n分母：\n$$ \\sum_{i} \\frac{b_i c_i}{n_i} = \\frac{1 \\times 900}{1020} + \\frac{940 \\times 1}{1020} = \\frac{900}{1020} + \\frac{940}{1020} = \\frac{1840}{1020} $$\nMantel-Haenszel 优势比是这两个量的比值：\n$$ OR_{MH} = \\frac{3040/1020}{1840/1020} = \\frac{3040}{1840} = \\frac{304}{184} = \\frac{38}{23} $$\n调整后优势比的精确值为 $\\frac{38}{23}$。将其转换为小数，约等于 $1.6521739$。按要求四舍五入到四位有效数字，得到 $1.652$。这个调整后的优势比大于 1，这与特定层的分析结果一致，并且代表了在控制了 $S$ 层的混杂效应后，Forest 生境对物种存在优势的因果效应的估计值。", "answer": "$$\\boxed{1.652}$$", "id": "2502384"}, {"introduction": "对生态过程的建模选择通常取决于我们所关注的组织层次。本练习将带您进入景观连通性分析领域，通过实践对比两种截然不同的建模范式：最小成本路径（LCP）和电路理论（ECT）。LCP通常被视为模拟具有完美知识的“最优”个体的行为，而ECT则更适合描述大量个体在景观中扩散的种群级流动。通过亲手实现这两种方法，您将深刻体会到，选择个体还是种群作为分析的“主角”，将如何从根本上决定我们使用的工具、得到的预测结果，以及对景观功能的生态学解释。[@problem_id:2502429]", "problem": "给定一个由非负移动成本组成的二维栅格表示的离散景观，以及两个由栅格单元的互斥集合表示的生境斑块。您的任务是，从基本原理出发，实现对应不同生态组织层次和范围的两种连通性预测，然后在一小组测试景观上计算成对的输出结果。\n\n生态学解释与组织层次：\n- 在个体层面，一个最小化其累积移动成本的生物会遵循一条近似于局部移动成本与步长加权之和最小的路径。这被操作化为最小成本路径 (Least-Cost Path, LCP)，即在一个加权网格图上的路径，其边权重由相邻单元间的移动成本给出。在指数扩散核下，从源斑块到目标斑块的单位个体预测移动概率可以建模为 $P_{\\mathrm{LCP}} = \\exp(-\\alpha \\, C_{\\min})$，其中 $C_{\\min}$ 是最小成本路径的累积成本，$\\alpha  0$ 是一个尺度参数。\n- 在种群层面（集合种群连通性），大量的个体通过景观中的许多可能路径进行扩散。电路理论 (Electrical Circuit Theory, ECT) 基于随机游走和电阻网络之间的等效性，为这种多路径流提供了一种基于原理的表示方法。通过为每个图的边赋予等于其移动成本倒数的电导来构建一个电阻网络。将源斑块中所有单元的电势固定为 $1$，目标斑块中所有单元的电势固定为 $0$，并求解由欧姆定律 (Ohm’s Law, OL) 和基尔霍夫电流定律 (Kirchhoff’s Current Law, KCL) 所蕴含的狄利克雷边界值问题。离开源斑块的总电流等于两个斑块之间的等效电导 $C_{\\mathrm{eq}}$。一个与更高层次流动相符的有界移动概率可以建模为 $P_{\\mathrm{ECT}} = 1 - \\exp(-\\beta \\, C_{\\mathrm{eq}})$，其中 $\\beta  0$。\n\n实现的基石：\n- 将栅格表示为一个加权无向图，其中每个有效单元是一个节点，边连接 $8$-邻域（水平、垂直和对角）。水平和垂直步长为 $1$，对角步长为 $\\sqrt{2}$。\n- 从成本为 $c_i$ 的单元 $i$ 移动到成本为 $c_j$ 的相邻单元 $j$，步长为 $\\ell_{ij}$，其移动成本是算术平均成本乘以步长，即 $(c_i + c_j)/2 \\cdot \\ell_{ij}$。如果 $c_i$ 或 $c_j$ 不是有限值，则省略该边。\n- 最小成本路径 (LCP)：使用 Dijkstra 算法计算从任何源单元到任何目标单元的最小累积成本 $C_{\\min}$，将所有源单元视为初始距离为 $0$ 的多源点。如果不存在路径，按惯例定义 $C_{\\min} = +\\infty$ 且 $P_{\\mathrm{LCP}} = 0$。\n- 电路理论 (ECT)：为每条边赋予电导 $g_{ij} = 1 / \\left( (c_i + c_j)/2 \\cdot \\ell_{ij} \\right)$。在源斑块单元上施加狄利克雷电势 $V=1$，在目标斑块单元上施加 $V=0$；所有其他有效单元均为未知。令 $L$ 表示由电导组装的图拉普拉斯矩阵。求解在每个内部节点 $u$ 处由 KCL 蕴含的内部节点电势线性系统：$\\sum_{v} g_{uv} (V_u - V_v) = 0$，其中求和对象是 $u$ 的邻居 $v$，且对于边界节点，$V_v$ 是已知的。等效电导 $C_{\\mathrm{eq}}$ 等于离开源边界的总电流，$C_{\\mathrm{eq}} = \\sum_{s \\in S} \\sum_{v \\sim s} g_{sv} (V_s - V_v)$，其中 $V_s=1$。如果源和目标组分之间没有路径连接，则按惯例 $C_{\\mathrm{eq}} = 0$ 且 $P_{\\mathrm{ECT}} = 0$。\n\n图构建与数值细节：\n- 使用 $8$-邻域连通性，步长为 $1$（正交）和 $\\sqrt{2}$（对角）。\n- 一个单元是有效的当且仅当其成本是有限的。与任何无效单元相连的边都将被省略。\n- 对于 LCP，运行多源 Dijkstra 算法，一旦任何目标单元从优先队列中弹出，即终止以获得 $C_{\\min}$。\n- 对于 ECT，为有效单元组装稀疏拉普拉斯矩阵，对两个斑块施加狄利克雷约束，并求解简化后的线性系统以获得内部电势。然后计算 $C_{\\mathrm{eq}}$ 作为离开源斑块的总电流。\n\n需要计算的预测移动概率：\n- 若 $C_{\\min}$ 是有限的，则 $P_{\\mathrm{LCP}} = \\exp(-\\alpha \\, C_{\\min})$，否则为 $0$。\n- $P_{\\mathrm{ECT}} = 1 - \\exp(-\\beta \\, C_{\\mathrm{eq}})$。\n\n本问题不要求考虑角度。也不需要物理单位；所有成本都以抽象的成本单位计，距离以单元长度单位计。\n\n测试套件：\n实现您的程序，为以下每个测试用例计算 $[P_{\\mathrm{LCP}}, P_{\\mathrm{ECT}}]$。所有坐标均为从零开始的 $(\\text{row}, \\text{col})$。\n\n- 案例 A（一般景观，单单元斑块，连通）：\n  - 尺寸为 $5 \\times 5$ 的栅格，成本如下\n    $\n    \\begin{bmatrix}\n    1  1  2  2  3 \\\\\n    1  2  2  3  3 \\\\\n    2  2  3  4  4 \\\\\n    2  3  4  5  5 \\\\\n    3  4  5  5  6\n    \\end{bmatrix}\n    $\n  - 源斑块 $S = \\{(0,0)\\}$，目标斑块 $T = \\{(4,4)\\}$。\n  - 参数：$\\alpha = 0.2$, $\\beta = 1$。\n- 案例 B（均匀景观上相邻斑块的边界条件）：\n  - 尺寸为 $3 \\times 3$ 的栅格，所有值均为 $1$。\n  - 源斑块 $S = \\{(1,1)\\}$，目标斑块 $T = \\{(1,2)\\}$。\n  - 参数：$\\alpha = 1$, $\\beta = 1$。\n- 案例 C（被不可通行的障碍完全隔离）：\n  - 尺寸为 $5 \\times 5$ 的栅格，所有值均为 $1$，但中间一整行的成本为 $+\\infty$（不可通行），即对于所有列 $j$，单元 $(2,j)$ 的成本为 $+\\infty$。\n  - 源斑块 $S = \\{(0,0), (0,4)\\}$，目标斑块 $T = \\{(4,0), (4,4)\\}$。\n  - 参数：$\\alpha = 1$, $\\beta = 1$。\n- 案例 D（两条平行廊道；多单元斑块）：\n  - 尺寸为 $6 \\times 6$ 的栅格，初始值设为 $10$，然后将第 $1$ 行和第 $4$ 行所有列的成本设为 $1$，其他单元保持为 $10$。\n  - 源斑块 $S = \\{(1,0), (4,0)\\}$，目标斑块 $T = \\{(1,5), (4,5)\\}$。\n  - 参数：$\\alpha = 0.5$, $\\beta = 1$。\n\n要求的程序行为：\n- 将上述测试套件硬编码到您的程序中。\n- 对每个案例，完全按照上述说明计算 $P_{\\mathrm{LCP}}$ 和 $P_{\\mathrm{ECT}}$。\n- 使用标准四舍五入将每个概率值保留到 $6$ 位小数。\n- 最终输出格式：您的程序应生成一行输出，包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果本身应该是一个双元素列表。例如，输出必须是以下形式：\n$$\n\\left[ [p_1, q_1], [p_2, q_2], [p_3, q_3], [p_4, q_4] \\right]\n$$\n  其中，$p_k$ 和 $q_k$ 分别是案例 $k$（按 A, B, C, D 顺序）的 $P_{\\mathrm{LCP}}$ 和 $P_{\\mathrm{ECT}}$ 的四舍五入值。", "solution": "该问题陈述已经过严格分析并被认为是有效的。其科学基础植根于景观生态学的既定原则，问题设定明确，为获得唯一解提供了所有必要信息，且表述客观。该问题要求实现两种不同的生态连通性模型——最小成本路径（LCP）和电路理论（ECT）——并将其应用于一系列测试景观。解决方案首先构建景观的图表示，然后对每个模型应用指定的算法。\n\n首先，将景观栅格转换为一个加权无向图 $G = (V, E)$，其中节点集 $V$ 对应于具有有限移动成本的栅格单元，边 $E$ 连接相邻节点。连通性由一个8邻域（摩尔邻域）定义。对于任意两个相邻且成本分别为 $c_i$ 和 $c_j$ 的单元 $i$ 和 $j$，在 $E$ 中存在一条边 $(i, j)$。赋予该边的移动成本 $w_{ij}$ 由公式 $w_{ij} = \\frac{c_i + c_j}{2} \\ell_{ij}$ 给出，其中 $\\ell_{ij}$ 是单元中心之间的欧几里得距离。对于水平和垂直邻居，$\\ell_{ij}=1$；对于对角邻居，$\\ell_{ij}=\\sqrt{2}$。如果 $c_i$ 或 $c_j$ 是无限的，则两个单元之间不创建边，这有效地表示了一个不可通行的障碍。\n\n第一个模型代表个体层面的移动，即最小成本路径（LCP）。计算源斑块 $S$ 和目标斑块 $T$ 之间最小成本路径的累积成本 $C_{\\min}$。这是一个经典的图上非负边权的最短路径问题，为此采用了Dijkstra算法。为了处理多单元斑块，使用了Dijkstra算法的多源变体。源斑块 $S$ 中所有节点的距离初始化为 $0$，所有其他节点的距离初始化为 $\\infty$。算法通过迭代地探索图来进行，总是从当前累积成本最低的节点扩展路径。一旦属于目标斑块 $T$ 的第一个节点被确定（即从优先队列中取出），搜索即告终止，从而得到 $C_{\\min}$。如果在到达任何目标节点之前优先队列已空，则表示 $S$ 和 $T$ 是断开的，此时 $C_{\\min}$ 取为 $\\infty$。然后，移动概率计算为 $P_{\\mathrm{LCP}} = \\exp(-\\alpha \\, C_{\\min})$，并约定如果 $C_{\\min} = \\infty$，则 $P_{\\mathrm{LCP}}=0$。\n\n第二个模型代表种群层面的连通性，基于电路理论（ECT）。该模型同时考虑了源斑块和目标斑块之间的所有可能路径。景观图 $G$ 被解释为一个电阻网络。边 $(i, j)$ 的电导 $g_{ij}$ 是其移动成本的倒数：$g_{ij} = 1/w_{ij}$。通过将源斑块 $S$ 中所有节点的电势设置为 $V_S=1$ 并将目标斑块 $T$ 中所有节点的电势设置为 $V_T=0$ 来建立一个狄利克雷边界值问题。所有其他（内部）节点的电势是未知的。\n\n根据基尔霍夫电流定律（KCL），任何内部节点 $u$ 的净电流流入必须为零。这个条件导出一个线性方程组：\n$$\n\\sum_{v \\sim u} g_{uv} (V_u - V_v) = 0\n$$\n其中求和遍历 $u$ 的所有邻居 $v$。该系统可以针对所有内部节点 $u \\in I$ 进行重组，形成一个矩阵方程 $A\\mathbf{x} = \\mathbf{b}$。这里，$\\mathbf{x}$ 是内部节点未知电势的向量。矩阵 $A$ 是图拉普拉斯矩阵的一个子矩阵，对应于内部节点。对于一个内部节点 $u_i$，对角线元素 $A_{ii}$ 是所有入射边电导的总和，$A_{ii} = \\sum_{v \\sim u_i} g_{u_i v}$。对于一个相邻的内部节点 $u_j$，非对角线元素 $A_{ij}$ 是 $-g_{u_i u_j}$。向量 $\\mathbf{b}$ 则考虑了边界节点（源斑块）的固定电势，其中 $b_i = \\sum_{s \\in S, s \\sim u_i} g_{u_i s} V_s = \\sum_{s \\in S, s \\sim u_i} g_{u_i s}$。\n\n这个稀疏线性系统被求解以得到内部电势向量 $\\mathbf{x}$。在求解之前，会从源斑块执行一次连通性检查（例如，广度优先搜索）。如果目标斑块不可达，则斑块之间是电断开的，等效电导 $C_{\\mathrm{eq}}$ 为 $0$。否则，在解出所有节点的电势后，网络的等效电导 $C_{\\mathrm{eq}}$ 计算为从源斑块流出的总电流：\n$$\nC_{\\mathrm{eq}} = \\sum_{s \\in S} \\sum_{v \\sim s} g_{sv} (V_s - V_v)\n$$\n最后，种群层面的移动概率计算为 $P_{\\mathrm{ECT}} = 1 - \\exp(-\\beta \\, C_{\\mathrm{eq}})$。对于所有案例，数值结果按要求四舍五入到6位小数。", "answer": "[[0.169047,0.852959],[0.367879,0.632121],[0.0,0.0],[0.082085,0.864665]]", "id": "2502429"}]}