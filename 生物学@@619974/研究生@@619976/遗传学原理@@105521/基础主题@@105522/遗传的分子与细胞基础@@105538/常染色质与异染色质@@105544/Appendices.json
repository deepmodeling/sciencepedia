{"hands_on_practices": [{"introduction": "聚合体物理学为我们理解基因组的三维结构提供了强大的定量工具。通过将染色质域建模为蠕虫状链（Worm-like chain），我们可以探索其物理特性（如刚度）和线性包装密度如何共同决定其空间大小。本练习将引导你运用此模型，通过计算比较同等长度的常染色质和异染色质域的回转半径 $R_g$，从而直观地理解它们在压缩程度上的显著差异 [@problem_id:2808585]。", "problem": "间期染色质的三维高分子物理解释采用蠕虫状链 (WLC) 模型来模拟 $10^{5}$ 到 $10^{6}$ 碱基对尺度上的结构域。在此框架下，常染色质和异染色质在有效刚度以及沿染色质纤维轴的有效线性包装密度方面均有所不同。考虑一个大小为 $200{,}000$ 碱基对的单结构域片段，其在 $100$–$500$ 千碱基对尺度下体内测量的材料属性如下：\n\n- 常染色质：有效持续长度 $p_{\\mathrm{eu}} = 35\\,\\text{nm}$ 和沿纤维的有效线性碱基对密度 $d_{\\mathrm{eu}} = 10\\,\\text{bp}\\,\\text{nm}^{-1}$。\n- 异染色质：有效持续长度 $p_{\\mathrm{het}} = 80\\,\\text{nm}$ 和沿纤维的有效线性碱基对密度 $d_{\\mathrm{het}} = 70\\,\\text{bp}\\,\\text{nm}^{-1}$。\n\n从基本的高分子定义出发：轮廓长度 $L$ 等于高分子片段的总弧长；持续长度 $p$ 由切向-切向相关性随弧长分离呈指数衰减来定义；回旋半径 $R_{g}$ 是单个链中单体到质心的均方根距离。假设处于 θ 条件（理想链）下，并且当 $L/p \\gg 1$ 时，蠕虫状链 (WLC) 的長链极限适用。仅使用这些基础信息，计算常染色质域的预期回旋半径 $R_{g,\\mathrm{eu}}$ 和异染色质域的预期回旋半径 $R_{g,\\mathrm{het}}$，结果以微米表示。然后计算定义为\n$$\nr \\equiv \\frac{R_{g,\\mathrm{eu}}}{R_{g,\\mathrm{het}}}.\n$$\n的压缩比。将 $r$ 的单一数值四舍五入至三位有效数字作为最终答案报告。最终报告值不含单位。中间计算的回旋半径以微米表示。", "solution": "首先将对问题进行严格验证，以确定其科学和逻辑上的完整性。\n\n从问题陈述中逐字提取的已知条件如下：\n- 高分子模型：蠕虫状链 (WLC)。\n- 生物学背景：$10^5$ 到 $10^6$ 碱基对尺度上的间期染色质结构域。\n- 结构域大小：$N = 200,000$ 碱基对。\n- 常染色质属性：\n  - 有效持续长度：$p_{\\mathrm{eu}} = 35\\,\\text{nm}$。\n  - 有效线性碱基对密度：$d_{\\mathrm{eu}} = 10\\,\\text{bp}\\,\\text{nm}^{-1}$。\n- 异染色质属性：\n  - 有效持续长度：$p_{\\mathrm{het}} = 80\\,\\text{nm}$。\n  - 有效线性碱基对密度：$d_{\\mathrm{het}} = 70\\,\\text{bp}\\,\\text{nm}^{-1}$。\n- 假设和条件：\n  - θ 条件（理想链行为）。\n  - 当 $L/p \\gg 1$ 时，WLC 的長链极限适用，其中 $L$ 为轮廓长度，$p$ 为持续长度。\n- 要求计算：\n  - 常染色质的回旋半径，$R_{g,\\mathrm{eu}}$。\n  - 异染色质的回旋半径，$R_{g,\\mathrm{het}}$。\n  - 压缩比，$r \\equiv \\frac{R_{g,\\mathrm{eu}}}{R_{g,\\mathrm{het}}}$。\n- 报告要求：$r$ 的最终值四舍五入至三位有效数字。\n\n现在，我们基于这些提取的已知条件来验证该问题。\n该问题具有科学依据。蠕虫状链是高分子物理学中的一个经典模型，其应用于描述染色质的中尺度组织是生物物理学中一个标准且活跃的研究领域。所提供的持续长度和线性包装密度值在文献中讨论的有效染色质纤维的物理上合理的范围内。该问题提法明确，提供了所有必要的参数和清晰的目标。语言客观且量化。θ 条件和長链极限等假设被明确陈述，这是一个规范的物理问题的标志。長链极限的条件 $L/p \\gg 1$ 必须在求解过程中进行验证，但问题的结构允许进行这种验证。问题没有矛盾、沒有缺失信息、也不依赖于伪科学或主观论断。因此，该问题被认定为有效，并将提供解答。\n\n基本任务是在指定假设下计算蠕虫状链的回旋半径 $R_g$。问题指出我们处于長链极限，其中轮廓长度 $L$ 远大于持续长度 $p$。在此极限下，θ 条件下的 WLC 的链统计特性趋近于高斯链。均方回旋半径 $\\langle R_g^2 \\rangle$ 由公认的公式给出：\n$$ \\langle R_g^2 \\rangle = \\frac{L p}{3} $$\n为简化起见，我们将省略尖括号，将预期回旋半径表示为 $R_g = \\sqrt{Lp/3}$。\n\n首先，我们必须确定每种染色质类型的轮廓长度 $L$。轮廓长度是高分子片段的总物理长度。它由总碱基对数 $N$ 和沿纤维的线性碱基对密度 $d$ 计算得出。\n$$ L = \\frac{N}{d} $$\n我们将此公式应用于常染色质和异染色质。\n\n对于常染色质：\n参数为 $N = 200,000$，$p_{\\mathrm{eu}} = 35\\,\\text{nm}$，以及 $d_{\\mathrm{eu}} = 10\\,\\text{bp}\\,\\text{nm}^{-1}$。\n轮廓长度为：\n$$ L_{\\mathrm{eu}} = \\frac{N}{d_{\\mathrm{eu}}} = \\frac{200,000\\,\\text{bp}}{10\\,\\text{bp}\\,\\text{nm}^{-1}} = 20,000\\,\\text{nm} $$\n我们必须首先验证長链极限假设：\n$$ \\frac{L_{\\mathrm{eu}}}{p_{\\mathrm{eu}}} = \\frac{20,000\\,\\text{nm}}{35\\,\\text{nm}} = \\frac{4000}{7} \\approx 571.4 $$\n由于 $571.4 \\gg 1$，因此对常染色质使用長链极限公式是合理的。\n常染色质域的回旋半径为：\n$$ R_{g,\\mathrm{eu}}^2 = \\frac{L_{\\mathrm{eu}} p_{\\mathrm{eu}}}{3} = \\frac{(20,000\\,\\text{nm}) (35\\,\\text{nm})}{3} = \\frac{700,000}{3}\\,\\text{nm}^2 $$\n$$ R_{g,\\mathrm{eu}} = \\sqrt{\\frac{700,000}{3}}\\,\\text{nm} \\approx 483.045...\\,\\text{nm} $$\n以微米表示，即 $R_{g,\\mathrm{eu}} \\approx 0.483\\,\\mu\\text{m}$。\n\n对于异染色质：\n参数为 $N = 200,000$，$p_{\\mathrm{het}} = 80\\,\\text{nm}$，以及 $d_{\\mathrm{het}} = 70\\,\\text{bp}\\,\\text{nm}^{-1}$。\n轮廓长度为：\n$$ L_{\\mathrm{het}} = \\frac{N}{d_{\\mathrm{het}}} = \\frac{200,000\\,\\text{bp}}{70\\,\\text{bp}\\,\\text{nm}^{-1}} = \\frac{20,000}{7}\\,\\text{nm} $$\n我们验证長链极限假设：\n$$ \\frac{L_{\\mathrm{het}}}{p_{\\mathrm{het}}} = \\frac{20,000/7\\,\\text{nm}}{80\\,\\text{nm}} = \\frac{20,000}{7 \\times 80} = \\frac{250}{7} \\approx 35.7 $$\n由于 $35.7 \\gg 1$，長链极限对于异染色质也是一个合理的近似，尽管其适用性不如常染色质那么稳固。\n异染色质域的回旋半径为：\n$$ R_{g,\\mathrm{het}}^2 = \\frac{L_{\\mathrm{het}} p_{\\mathrm{het}}}{3} = \\frac{(\\frac{20,000}{7}\\,\\text{nm}) (80\\,\\text{nm})}{3} = \\frac{1,600,000}{21}\\,\\text{nm}^2 $$\n$$ R_{g,\\mathrm{het}} = \\sqrt{\\frac{1,600,000}{21}}\\,\\text{nm} \\approx 276.026...\\,\\text{nm} $$\n以微米表示，即 $R_{g,\\mathrm{het}} \\approx 0.276\\,\\mu\\text{m}$。\n\n最后，我们计算压缩比 $r$。更严谨的做法是首先推导出该比率的符号表达式。\n$$ R_g = \\sqrt{\\frac{Lp}{3}} = \\sqrt{\\frac{(N/d)p}{3}} = \\sqrt{\\frac{Np}{3d}} $$\n那么，比率 $r$ 是：\n$$ r = \\frac{R_{g,\\mathrm{eu}}}{R_{g,\\mathrm{het}}} = \\frac{\\sqrt{\\frac{N p_{\\mathrm{eu}}}{3 d_{\\mathrm{eu}}}}}{\\sqrt{\\frac{N p_{\\mathrm{het}}}{3 d_{\\mathrm{het}}}}} $$\n项 $N$ 和 $3$ 消去，得到一个仅取决于两种染色质类型内在材料属性的简化表达式：\n$$ r = \\sqrt{\\frac{p_{\\mathrm{eu}}}{d_{\\mathrm{eu}}} \\cdot \\frac{d_{\\mathrm{het}}}{p_{\\mathrm{het}}}} = \\sqrt{\\frac{p_{\\mathrm{eu}} d_{\\mathrm{het}}}{p_{\\mathrm{het}} d_{\\mathrm{eu}}}} $$\n现在，我们将给定值代入此表达式：\n$$ r = \\sqrt{\\frac{(35\\,\\text{nm}) (70\\,\\text{bp}\\,\\text{nm}^{-1})}{(80\\,\\text{nm}) (10\\,\\text{bp}\\,\\text{nm}^{-1})}} = \\sqrt{\\frac{2450}{800}} = \\sqrt{\\frac{245}{80}} = \\sqrt{\\frac{49}{16}} $$\n计算得出一个精确的有理数值：\n$$ r = \\frac{\\sqrt{49}}{\\sqrt{16}} = \\frac{7}{4} = 1.75 $$\n问题要求答案四舍五入至三位有效数字。精确值 $1.75$ 已有三位有效数字。\n结果表明，对于具有相同碱基对数的片段，常染色质域在空间上比异染色质域更伸展，正如其较低的包装密度所预期的那样，尽管其刚度较低。", "answer": "$$\\boxed{1.75}$$", "id": "2808585"}, {"introduction": "组蛋白修饰构成了标记染色质状态的“表观遗传密码”，而计算方法是解读这一密码的关键。本练习将指导你基于贝叶斯定理，构建一个高斯朴素贝叶斯分类器，利用与活性相关的 H3K27ac 和与抑制相关的 H3K9me3 这两种关键组蛋白修饰的ChIP-seq数据来进行基因组区域的分类。通过这个实践，你将掌握一项将原始表观基因组数据转化为有生物学意义的染色质状态注释的基本技能 [@problem_id:2808610]。", "problem": "给定两种组蛋白修饰在无重叠的 $10$ 千碱基基因组区间内的染色质免疫沉淀测序 (ChIP-seq) 富集值：组蛋白H3赖氨酸$9$三甲基化 (H3K9me$3$)，通常与抑制性、紧凑的染色质 (异染色质) 相关；以及组蛋白H3赖氨酸$27$乙酰化 (H3K27ac)，通常与活性、开放的染色质 (常染色质) 相关。利用这些信号作为特征，构建一个概率分类器，为每个区间输出一个支持异染色质相对于常染色质的对数优势比分数，并据此对每个区间进行分类。本题要求基于 Bayes 定理的基本原理和简单的、可检验的假设来实现和评估此分类器。\n\n假设以下基础：\n- 分子生物学中心法则确立了染色质状态影响转录可及性，且广泛重复的观察结果将 H3K9me$3$ 富集与异染色质相关联，将 H3K27ac 富集与常染色质相关联。\n- 我们使用 Bayes 定理将后验优势比与先验优势比和似然比联系起来。\n- 我们采用朴素贝叶斯假设，即在给定类别的情况下，特征之间是独立的。\n- 在每个类别中，每个特征都被建模为一个单变量正态（高斯）随机变量，其未知的均值和方差通过最大似然法从训练数据中估计。\n\n更具体地说，令一个区间由特征向量 $\\mathbf{x} = (x_1, x_2)$ 表示，其中 $x_1$ 是 H3K9me$3$ 富集值，$x_2$ 是 H3K27ac 富集值。令类别 $C \\in \\{\\mathrm{H}, \\mathrm{E}\\}$ 表示异染色质 ($\\mathrm{H}$) 或常染色质 ($\\mathrm{E}$)。您将需要：\n- 从训练集中以相对频率估计类别先验概率 $\\pi_{\\mathrm{H}}$ 和 $\\pi_{\\mathrm{E}}$。\n- 对每个类别 $c \\in \\{\\mathrm{H}, \\mathrm{E}\\}$ 和每个特征索引 $j \\in \\{1,2\\}$，使用特定类别的训练样本，通过最大似然法估计高斯参数 $\\mu_{c,j}$ 和 $\\sigma^2_{c,j}$（计算方差时使用分母 $n_c$，其中 $n_c$ 是类别 $c$ 中的训练样本数量）。\n- 为保证数值稳定性，应用一个方差下限：将每个 $\\sigma^2_{c,j}$ 替换为 $\\max(\\sigma^2_{c,j}, \\epsilon)$，其中 $\\epsilon = 10^{-6}$。\n- 在朴素贝叶斯模型下，计算测试区间 $\\mathbf{x}$ 的对数优势比分数：\n$$\ns(\\mathbf{x}) \\equiv \\log \\frac{p(C=\\mathrm{H}\\mid \\mathbf{x})}{p(C=\\mathrm{E}\\mid \\mathbf{x})}\n= \\log \\frac{\\pi_{\\mathrm{H}}}{\\pi_{\\mathrm{E}}} + \\sum_{j=1}^{2} \\left[ \\log \\mathcal{N}\\!\\left(x_j \\mid \\mu_{\\mathrm{H},j}, \\sigma^2_{\\mathrm{H},j}\\right) - \\log \\mathcal{N}\\!\\left(x_j \\mid \\mu_{\\mathrm{E},j}, \\sigma^2_{\\mathrm{E},j}\\right) \\right],\n$$\n其中 $\\mathcal{N}(x \\mid \\mu, \\sigma^2)$ 表示均值为 $\\mu$、方差为 $\\sigma^2$ 的正态密度。\n- 如果 $s(\\mathbf{x}) \\ge 0$，则将 $\\mathbf{x}$ 分类为异染色质；如果 $s(\\mathbf{x})  0$，则分类为常染色质。\n- 以正确分类区间的比例作为测试集上的分类准确率进行评估。以小数形式报告准确率。\n\n训练数据（每对 $(x_1, x_2)$ 后都跟着其类别标签）：\n- 异染色质 ($\\mathrm{H}$): $(4.8, 0.3)$, $(5.1, 0.4)$, $(4.5, 0.2)$, $(5.3, 0.5)$, $(4.9, 0.4)$, $(5.0, 0.6)$, $(4.7, 0.3)$, $(5.2, 0.4)$.\n- 常染色质 ($\\mathrm{E}$): $(0.4, 4.9)$, $(0.5, 5.2)$, $(0.3, 4.7)$, $(0.6, 5.1)$, $(0.4, 4.8)$, $(0.5, 5.0)$, $(0.2, 4.6)$, $(0.6, 5.3)$.\n\n测试数据（每对 $(x_1, x_2)$ 后都跟着其真实类别标签）：$(4.6, 0.5)\\rightarrow \\mathrm{H}$, $(0.5, 5.1)\\rightarrow \\mathrm{E}$, $(5.4, 0.2)\\rightarrow \\mathrm{H}$, $(0.2, 5.4)\\rightarrow \\mathrm{E}$, $(5.0, 5.0)\\rightarrow \\mathrm{E}$, $(4.0, 1.0)\\rightarrow \\mathrm{H}$, $(0.4, 4.9)\\rightarrow \\mathrm{E}$.\n\n角度单位不适用。输出不需要物理单位，因为富集值是无量纲的。\n\n您的程序必须：\n- 严格按照规定实现上述估计和分类过程，包括方差下限 $\\epsilon = 10^{-6}$ 和分母为 $n_c$ 的最大似然方差估计量。\n- 按给定顺序，为每个测试区间计算其对数优势比分数 $s(\\mathbf{x})$ 和预测类别（将异染色质编码为整数 $1$，常染色质编码为整数 $0$）。\n- 计算测试集上的总体准确率，即正确预测数除以 $7$。\n\n测试套件和输出规范：\n- 严格使用上面给出的训练和测试数据作为测试套件。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含：四舍五入到小数点后3位的准确率，接着是7个测试区间的7个对数优势比分数（每个分数都四舍五入到小数点后3位），最后是这些测试区间的7个整数预测。例如，正确格式的输出看起来像 $[0.857,2.314,-1.772,\\dots,1,0,\\dots]$。", "solution": "该问题要求构建并评估一个概率分类器，以根据两种组蛋白修饰 $x_1$ (H3K9me$3$) 和 $x_2$ (H3K27ac) 的富集值来区分两种染色质状态：异染色质 ($H$) 和常染色质 ($E$)。所规定的方法是使用带有高斯类条件似然的朴素贝叶斯分类器。对问题陈述的验证证实了其科学依据、数学一致性和良定性。我们着手进行求解。\n\n该分类器的核心是 Bayes 定理，它将给定特征向量 $\\mathbf{x} = (x_1, x_2)$ 时类别 $C$ 的后验概率与类别先验概率 $p(C)$ 和类条件似然 $p(\\mathbf{x} \\mid C)$ 联系起来。我们关心的是对数优势比，或称对数后验比，它决定了分类边界：\n$$s(\\mathbf{x}) = \\log \\frac{p(C=H \\mid \\mathbf{x})}{p(C=E \\mid \\mathbf{x})}$$\n使用 Bayes 定理，上式变为：\n$$s(\\mathbf{x}) = \\log \\frac{p(\\mathbf{x} \\mid C=H) p(C=H)}{p(\\mathbf{x} \\mid C=E) p(C=E)} = \\log \\frac{p(C=H)}{p(C=E)} + \\log \\frac{p(\\mathbf{x} \\mid C=H)}{p(\\mathbf{x} \\mid C=E)}$$\n项 $\\frac{p(C=H)}{p(C=E)}$ 是类别先验概率之比，即 $\\frac{\\pi_H}{\\pi_E}$。朴素贝叶斯假定特征在给定类别的情况下是条件独立的，即 $p(\\mathbf{x} \\mid C) = p(x_1 \\mid C) p(x_2 \\mid C)$。因此，对数优势比分数分解为对各个特征的求和：\n$$s(\\mathbf{x}) = \\log \\frac{\\pi_H}{\\pi_E} + \\sum_{j=1}^{2} \\log \\frac{p(x_j \\mid C=H)}{p(x_j \\mid C=E)}$$\n每个类条件特征分布被建模为单变量正态分布，$p(x_j \\mid C=c) = \\mathcal{N}(x_j \\mid \\mu_{c,j}, \\sigma^2_{c,j})$。单个观测值 $x_j$ 的对数似然为 $\\log \\mathcal{N}(x_j \\mid \\mu, \\sigma^2) = -\\frac{1}{2}\\log(2\\pi\\sigma^2) - \\frac{(x_j-\\mu)^2}{2\\sigma^2}$。求和中每个特征的项变为：\n$$\\log p(x_j \\mid C=H) - \\log p(x_j \\mid C=E) = \\frac{1}{2}\\log\\left(\\frac{\\sigma^2_{E,j}}{\\sigma^2_{H,j}}\\right) - \\frac{(x_j-\\mu_{H,j})^2}{2\\sigma^2_{H,j}} + \\frac{(x_j-\\mu_{E,j})^2}{2\\sigma^2_{E,j}}$$\n\n第一步是使用最大似然估计 (MLE) 从提供的训练数据中估计模型参数。\n\n**1. 参数估计**\n\n训练集包含 $n_H = 8$ 个异染色质样本和 $n_E = 8$ 个常染色质样本。\n训练样本总数为 $N = n_H + n_E = 16$。\n\n**类别先验概率：**\n先验概率通过训练数据中的相对频率来估计：\n$\\pi_H = \\frac{n_H}{N} = \\frac{8}{16} = 0.5$\n$\\pi_E = \\frac{n_E}{N} = \\frac{8}{16} = 0.5$\n对数先验比为 $\\log(\\pi_H / \\pi_E) = \\log(1) = 0$。\n\n**类条件高斯参数：**\n对每个类别 $c \\in \\{H, E\\}$ 和每个特征 $j \\in \\{1, 2\\}$，我们计算样本均值 $\\mu_{c,j}$ 和样本方差 $\\sigma^2_{c,j}$（根据 MLE 的规定，使用 $n_c$ 作为分母）。\n\n对于异染色质 ($H$)：\n- 训练数据 ($x_1$): $\\{4.8, 5.1, 4.5, 5.3, 4.9, 5.0, 4.7, 5.2\\}$\n- 训练数据 ($x_2$): $\\{0.3, 0.4, 0.2, 0.5, 0.4, 0.6, 0.3, 0.4\\}$\n- $\\mu_{H,1} = \\frac{1}{8}\\sum x_{H,1,i} = 4.9375$\n- $\\sigma^2_{H,1} = \\frac{1}{8}\\sum (x_{H,1,i} - \\mu_{H,1})^2 = 0.06234375$\n- $\\mu_{H,2} = \\frac{1}{8}\\sum x_{H,2,i} = 0.3875$\n- $\\sigma^2_{H,2} = \\frac{1}{8}\\sum (x_{H,2,i} - \\mu_{H,2})^2 = 0.01359375$\n\n对于常染色质 ($E$)：\n- 训练数据 ($x_1$): $\\{0.4, 0.5, 0.3, 0.6, 0.4, 0.5, 0.2, 0.6\\}$\n- 训练数据 ($x_2$): $\\{4.9, 5.2, 4.7, 5.1, 4.8, 5.0, 4.6, 5.3\\}$\n- $\\mu_{E,1} = \\frac{1}{8}\\sum x_{E,1,i} = 0.4375$\n- $\\sigma^2_{E,1} = \\frac{1}{8}\\sum (x_{E,1,i} - \\mu_{E,1})^2 = 0.01734375$\n- $\\mu_{E,2} = \\frac{1}{8}\\sum x_{E,2,i} = 4.95$\n- $\\sigma^2_{E,2} = \\frac{1}{8}\\sum (x_{E,2,i} - \\mu_{E,2})^2 = 0.0525$\n\n问题指定了方差下限 $\\epsilon = 10^{-6}$。所有计算出的方差都大于 $\\epsilon$，因此直接使用。\n\n**2. 测试数据分类**\n\n我们现在使用估计的参数为 7 个测试区间中的每一个计算对数优势比分数 $s(\\mathbf{x})$。如果 $s(\\mathbf{x}) \\ge 0$，则区间被分类为异染色质 ($H$)；如果 $s(\\mathbf{x})  0$，则分类为常染色质 ($E$)。我们将 H 编码为 1，E 编码为 0。\n\n- **测试区间 1:** $\\mathbf{x} = (4.6, 0.5)$, 真实标签: $H$\n$s(4.6, 0.5) \\approx 687.258$。由于 $s > 0$，预测为 $H$ ($1$)。正确。\n\n- **测试区间 2:** $\\mathbf{x} = (0.5, 5.1)$, 真实标签: $E$\n$s(0.5, 5.1) \\approx -259.882$。由于 $s  0$，预测为 $E$ ($0$)。正确。\n\n- **测试区间 3:** $\\mathbf{x} = (5.4, 0.2)$, 真实标签: $H$\n$s(5.4, 0.2) \\approx 1146.467$。由于 $s > 0$，预测为 $H$ ($1$)。正确。\n\n- **测试区间 4:** $\\mathbf{x} = (0.2, 5.4)$, 真实标签: $E$\n$s(0.2, 5.4) \\approx -1355.700$。由于 $s  0$，预测为 $E$ ($0$)。正确。\n\n- **测试区间 5:** $\\mathbf{x} = (5.0, 5.0)$, 真实标签: $E$\n$s(5.0, 5.0) \\approx -181.939$。由于 $s  0$，预测为 $E$ ($0$)。正确。\n\n- **测试区间 6:** $\\mathbf{x} = (4.0, 1.0)$, 真实标签: $H$\n$s(4.0, 1.0) \\approx 276.994$。由于 $s > 0$，预测为 $H$ ($1$)。正确。\n\n- **测试区间 7:** $\\mathbf{x} = (0.4, 4.9)$, 真实标签: $E$\n$s(0.4, 4.9) \\approx -239.544$。由于 $s  0$，预测为 $E$ ($0$)。正确。\n\n分数的大数量级是由于训练类别分隔良好，导致估计的方差很小。与类别均值相差多个标准差的测试点会产生极小的似然值，从而导致大数量级的对数似然值。\n\n**3. 评估**\n\n所有 $7$ 个测试区间都被正确分类。\n准确率是正确预测的比例：\n准确率 = $\\frac{\\text{正确预测数}}{\\text{总预测数}} = \\frac{7}{7} = 1.0$。\n\n最终需要报告的结果是：\n- 准确率：$1.000$\n- 对数优势比分数：$[687.258, -259.882, 1146.467, -1355.700, -181.939, 276.994, -239.544]$\n- 预测值：$[1, 0, 1, 0, 0, 1, 0]$\n这些值被格式化并组合成指定的输出字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and evaluates a Gaussian Naive Bayes classifier for chromatin states.\n    \"\"\"\n    \n    # 1. DEFINE TRAINING AND TEST DATA\n    \n    # Training data: (H3K9me3, H3K27ac) features for Heterochromatin (H) and Euchromatin (E)\n    train_H = np.array([\n        [4.8, 0.3], [5.1, 0.4], [4.5, 0.2], [5.3, 0.5],\n        [4.9, 0.4], [5.0, 0.6], [4.7, 0.3], [5.2, 0.4]\n    ])\n    \n    train_E = np.array([\n        [0.4, 4.9], [0.5, 5.2], [0.3, 4.7], [0.6, 5.1],\n        [0.4, 4.8], [0.5, 5.0], [0.2, 4.6], [0.6, 5.3]\n    ])\n\n    # Test data: (features, ground-truth label)\n    test_suite = [\n        (np.array([4.6, 0.5]), 1),  # H\n        (np.array([0.5, 5.1]), 0),  # E\n        (np.array([5.4, 0.2]), 1),  # H\n        (np.array([0.2, 5.4]), 0),  # E\n        (np.array([5.0, 5.0]), 0),  # E\n        (np.array([4.0, 1.0]), 1),  # H\n        (np.array([0.4, 4.9]), 0),  # E\n    ]\n    \n    # Numerical stability parameter\n    epsilon = 1e-6\n\n    # 2. PARAMETER ESTIMATION FROM TRAINING DATA\n\n    # Estimate class priors\n    n_H = len(train_H)\n    n_E = len(train_E)\n    n_total = n_H + n_E\n    pi_H = n_H / n_total\n    pi_E = n_E / n_total\n    \n    # The log prior ratio log(pi_H / pi_E) is used in the log-odds score.\n    # Since n_H = n_E, this term is log(1) = 0.\n    log_prior_ratio = np.log(pi_H / pi_E)\n    \n    # Estimate Gaussian parameters (mean and variance) for each class and feature\n    # Using MLE, variance denominator is n_c (ddof=0 in numpy.var)\n    mu_H = np.mean(train_H, axis=0)\n    var_H = np.var(train_H, axis=0)\n    \n    mu_E = np.mean(train_E, axis=0)\n    var_E = np.var(train_E, axis=0)\n    \n    # Apply variance floor for numerical stability\n    var_H = np.maximum(var_H, epsilon)\n    var_E = np.maximum(var_E, epsilon)\n\n    # 3. CLASSIFICATION AND EVALUATION\n\n    def log_norm_pdf(x, mu, var):\n        \"\"\"\n        Computes the log of the Normal probability density function.\n        \"\"\"\n        return -0.5 * np.log(2 * np.pi * var) - ((x - mu)**2) / (2 * var)\n\n    def compute_log_odds_score(x_vec):\n        \"\"\"\n        Computes the log-odds score s(x) for heterochromatin vs. euchromatin.\n        s(x) = log(p(C=H|x) / p(C=E|x))\n        \"\"\"\n        # Sum of log-likelihood ratios for each feature\n        log_likelihood_ratio = 0\n        for j in range(2): # For each feature j=0,1 (or 1,2 in problem text)\n            log_lik_H = log_norm_pdf(x_vec[j], mu_H[j], var_H[j])\n            log_lik_E = log_norm_pdf(x_vec[j], mu_E[j], var_E[j])\n            log_likelihood_ratio += (log_lik_H - log_lik_E)\n            \n        return log_prior_ratio + log_likelihood_ratio\n\n    log_odds_scores = []\n    predictions = []\n    correct_predictions = 0\n\n    for x_test, true_label in test_suite:\n        # Calculate log-odds score\n        score = compute_log_odds_score(x_test)\n        log_odds_scores.append(score)\n        \n        # Classify based on the sign of the score\n        # Prediction is 1 (H) if score >= 0, else 0 (E)\n        prediction = 1 if score >= 0 else 0\n        predictions.append(prediction)\n        \n        # Check if prediction is correct\n        if prediction == true_label:\n            correct_predictions += 1\n            \n    # Calculate overall accuracy\n    accuracy = correct_predictions / len(test_suite)\n    \n    # 4. FORMAT AND PRINT OUTPUT\n    \n    # Format accuracy and scores to 3 decimal places\n    formatted_accuracy = f\"{accuracy:.3f}\"\n    formatted_scores = [f\"{s:.3f}\" for s in log_odds_scores]\n    \n    # Combine all results into a single list\n    output_list = [formatted_accuracy] + formatted_scores + predictions\n    \n    # Print in the specified format: [acc,s1,...,s7,p1,...,p7]\n    print(f\"[{','.join(map(str, output_list))}]\")\n\nsolve()\n```", "id": "2808610"}, {"introduction": "细胞如何在分裂过程中“记忆”并维持其染色质状态是表观遗传学的核心问题之一。本练习将引导你从第一性原理出发，构建一个随机模型来描述表观遗传记忆的机制，该模型整合了亲代组蛋白的半保留分配和“读写”反馈回路等关键生物学过程 [@problem_id:2808569]。通过推导一个双稳态马尔可夫链的稳态解，你将能定量地探索决定异染色质状态稳定遗传的参数。", "problem": "在一个细胞群体中，考虑一个由 $N$ 个核小体组成的单一基因组位点。根据成熟的染色质生物学理论，在每个细胞周期中，该位点会经历脱氧核糖核酸 (DNA) 复制，并伴随亲代组蛋白的半保留分离：每个带有亲代异染色质标记的核小体独立地以概率 $\\rho$ 留在一个给定的子染色单体上，或者以概率 $1 - \\rho$ 被一个新的未修饰核小体替换。\n\n我们将异染色质状态 $S$ 定义为位点上带有足够的可被“读取器”识别的抑制性组蛋白标记，从而导致转录沉默的状况；并将常染色质状态 $E$ 定义为其互补状态。\n\n由“读取-书写”酶介导的正反馈建模如下。每个遗传下来的异染色质标记核小体可以在同一细胞周期内，作为模板在其邻近的新核小体上书写标记。我们通过将单个遗传标记在该周期内重建结构域的净成功率建模为一个独立的、成功概率为 $s$ 的伯努利事件，来对这种局部扩散进行粗粒化处理。如果在由遗传标记引发的模板化扩散尝试中至少有一次成功，则该位点在周期结束时返回状态 $S$；否则，它会转变到状态 $E$。\n\n在状态 $E$ 下，可能发生从头成核事件：在一个细胞周期内，每个核小体位置独立地以概率 $\\nu$ 经历一次成核尝试，并且每次这样的尝试独立地以概率 $s$ 启动“读取-书写”反馈并成功建立状态 $S$。当且仅当该周期内至少有一次此类尝试成功时，该位点进入状态 $S$。\n\n仅使用上述独立性假设、独立伯努利试验计数的二项分布定义以及全概率定律，回答以下问题。\n\n(a) 推导单周期维持概率 $p$（即一个起始于状态 $S$ 的位点在周期结束时仍处于状态 $S$ 的概率），并将其表示为 $N$、$\\rho$ 和 $s$ 的函数。\n\n(b) 推导单周期建立概率 $\\alpha$（即一个起始于状态 $E$ 的位点在周期结束时转变为状态 $S$ 的概率），并将其表示为 $N$、$\\nu$ 和 $s$ 的函数。\n\n(c) 将该位点建模为一个两状态马尔可夫链，其转移概率为：$S \\to S$ 等于 $p$，$S \\to E$ 等于 $1 - p$，$E \\to S$ 等于 $\\alpha$，$E \\to E$ 等于 $1 - \\alpha$。计算稳态沉默分数 $\\pi^{\\ast}$（定义为处于状态 $S$ 的稳态概率），并将其表示为 $N$、$\\rho$、 $s$ 和 $\\nu$ 的闭式解析表达式。\n\n假设 $N \\ge 1$ 且 $0 \\le \\rho \\le 1$、$0 \\le s \\le 1$、$0 \\le \\nu \\le 1$。将您对 $\\pi^{\\ast}$ 的最终答案表示为一个精确的闭式表达式；无需进行四舍五入。", "solution": "首先将对问题进行严格验证。\n\n**问题验证**\n\n步骤 1：提取的已知条件。\n- 单个基因组位点包含 $N$ 个核小体。\n- 状态 $S$ 是异染色质（沉默）；状态 $E$ 是常染色质（活跃）。\n- 复制后， $N$ 个亲代异染色质标记中的每一个都以独立的概率 $\\rho$ 被一个子染色单体遗传。\n- 对于起始于状态 $S$ 的位点，设 $k$ 为遗传标记的数量。这 $k$ 个标记中的每一个都会启动一次“重建尝试”，这是一个成功概率为 $s$ 的伯努利试验。如果至少有一次尝试成功，该位点返回状态 $S$。否则，它会转变到状态 $E$。\n- 对于起始于状态 $E$ 的位点， $N$ 个核小体位置中的每一个都独立地以概率 $\\nu$ 经历一次*从头*成核尝试。每一次这样的尝试都独立地以概率 $s$ 建立状态 $S$。如果至少有一次此类尝试成功，则该位点转变为状态 $S$。\n- 假设：所有概率事件（遗传、扩散、成核）均如所述相互独立。重复伯努利试验中的成功次数服从二项分布。全概率定律适用。\n- 约束条件：$N \\ge 1$ 是一个整数；$0 \\le \\rho \\le 1$；$0 \\le s \\le 1$；$0 \\le \\nu \\le 1$。\n- 目标：推导 (a) 维持概率 $p = P(S \\to S)$，(b) 建立概率 $\\alpha = P(E \\to S)$，以及 (c) 从得到的两状态马尔可夫链中计算稳态沉默分数 $\\pi^{\\ast}$。\n\n步骤 2：已知条件的验证。\n- 该问题是**有科学依据的**。它提出了一个简化但标准的表观遗传状态继承的理论模型，该模型基于组蛋白修饰、“读取-书写”反馈以及染色质组分的随机分配等成熟概念。\n- 该问题是**适定的**。所有参数和概率规则都已明确定义，从而可以为所求量找到唯一且可计算的解。问题设定是自洽的。\n- 该问题是**客观的**。语言是正式的，没有主观论断。\n- 该问题不违反任何指定的无效标准。它在事实上并非不成立，是可形式化的，是完整的，在模型的抽象框架内是物理上合理的，并且并非无价值的。\n\n步骤 3：结论。\n该问题被判定为**有效**。将提供解答。\n\n**解答推导**\n\n(a) 维持概率 $p = P(S \\to S)$ 的推导。\n一个位点起始于状态 $S$，我们将其解释为所有 $N$ 个核小体都被标记。DNA 复制后，我们考虑一个子染色单体。$N$ 个亲代标记中的每一个都以概率 $\\rho$ 被遗传。设 $K$ 为该染色单体遗传的亲代标记数量的随机变量。由于遗传事件是独立的，$K$ 服从二项分布，$K \\sim B(N, \\rho)$。遗传恰好 $k$ 个标记的概率由下式给出：\n$$P(K=k) = \\binom{N}{k} \\rho^k (1-\\rho)^{N-k}$$\n对于 $k \\in \\{0, 1, \\dots, N\\}$。\n\n给定遗传了 $k$ 个标记，每个标记都会独立地启动一次重建异染色质结构域的尝试，成功概率为 $s$。如果这 $k$ 次尝试中至少有一次成功，该位点就返回状态 $S$。其互补事件是所有 $k$ 次尝试都失败。单次尝试失败的概率是 $1-s$。由于这些尝试是独立的，所有 $k$ 次尝试都失败的概率是 $(1-s)^k$。\n因此，在给定遗传了 $k$ 个标记的条件下，返回状态 $S$ 的条件概率是：\n$$P(S \\to S | K=k) = 1 - (1-s)^k$$\n注意，如果 $k=0$，这个概率是 $1-(1-s)^0 = 0$，这是正确的，因为没有遗传标记意味着没有用于重建的模板。\n\n为了求得总概率 $p = P(S \\to S)$，我们应用全概率定律，对 $k$ 的所有可能值进行边缘化：\n$$p = \\sum_{k=0}^{N} P(S \\to S | K=k) P(K=k) = \\sum_{k=0}^{N} \\left[1 - (1-s)^k\\right] \\binom{N}{k} \\rho^k (1-\\rho)^{N-k}$$\n我们可以将这个和式分成两部分：\n$$p = \\sum_{k=0}^{N} \\binom{N}{k} \\rho^k (1-\\rho)^{N-k} - \\sum_{k=0}^{N} (1-s)^k \\binom{N}{k} \\rho^k (1-\\rho)^{N-k}$$\n第一个和式是二项分布的整个概率质量函数的总和，等于 $1$。第二个和式可以使用二项式定理 $(x+y)^n = \\sum_{k=0}^n \\binom{n}{k} x^k y^{n-k}$ 来简化：\n$$\\sum_{k=0}^{N} \\binom{N}{k} [\\rho(1-s)]^k (1-\\rho)^{N-k} = [\\rho(1-s) + (1-\\rho)]^N = [\\rho - \\rho s + 1 - \\rho]^N = [1 - \\rho s]^N$$\n因此，维持概率 $p$ 是：\n$$p = 1 - (1 - \\rho s)^N$$\n\n(b) 建立概率 $\\alpha = P(E \\to S)$ 的推导。\n一个位点起始于状态 $E$。如果*从头*建立成功，则会发生向状态 $S$ 的转变。对 $N$ 个核小体位置中的每一个，此过程都包含两个步骤：发生一次成核尝试（概率为 $\\nu$），如果发生，该尝试成功建立状态 $S$（概率为 $s$）。\n对于单个核小体位置，成功建立事件的概率是这两个独立步骤概率的乘积：$\\nu s$。\n如果在 $N$ 个位置中的任何一个上发生了至少一次这样的成功事件，该位点就转变到状态 $S$。其互补事件是在 $N$ 个位置上都没有发生成功的建立事件。\n对于单个位置，*不*发生成功建立事件的概率是 $1 - \\nu s$。\n由于 $N$ 个位置上的事件是独立的，所有 $N$ 个位置都未能成功建立的概率是 $(1-\\nu s)^N$。\n这是保持在状态 $E$ 的概率：$P(E \\to E) = (1-\\nu s)^N$。\n建立概率 $\\alpha = P(E \\to S)$ 是其互补事件的概率：\n$$\\alpha = 1 - P(E \\to E) = 1 - (1 - \\nu s)^N$$\n\n(c) 稳态沉默分数 $\\pi^{\\ast}$ 的计算。\n该系统被建模为一个具有状态 $\\{S, E\\}$ 和以下转移概率的两状态马尔可夫链：\n- $P(S \\to S) = p = 1 - (1 - \\rho s)^N$\n- $P(S \\to E) = 1 - p = (1 - \\rho s)^N$\n- $P(E \\to S) = \\alpha = 1 - (1 - \\nu s)^N$\n- $P(E \\to E) = 1 - \\alpha = (1 - \\nu s)^N$\n\n设稳态分布为 $\\pi = (\\pi_S, \\pi_E)$，其中 $\\pi_S = \\pi^{\\ast}$ 是稳态沉默分数，$\\pi_E$ 是稳态常染色质分数。根据定义，$\\pi_S + \\pi_E = 1$。\n在稳态下，状态之间的概率流必须平衡。流出状态 $S$ 的总概率必须等于流入状态 $S$ 的总概率：\n$$ \\pi_S P(S \\to E) = \\pi_E P(E \\to S) $$\n代入已知关系：\n$$ \\pi_S (1 - p) = (1 - \\pi_S) \\alpha $$\n我们求解 $\\pi_S$：\n$$ \\pi_S - \\pi_S p = \\alpha - \\pi_S \\alpha $$\n$$ \\pi_S (1 - p + \\alpha) = \\alpha $$\n$$ \\pi_S = \\frac{\\alpha}{1 - p + \\alpha} $$\n该表达式要求链是遍历的，除非 $1-p+\\alpha = 0$，否则该条件成立。这种极端情况对应于 $p=1$ 和 $\\alpha=0$，此时状态是吸收态，在此被排除。\n\n现在，我们将 (a) 和 (b) 部分推导出的 $p$ 和 $\\alpha$ 的表达式代入 $\\pi_S$ 的方程中，我们将其记为 $\\pi^{\\ast}$：\n$$ \\pi^{\\ast} = \\frac{\\alpha}{(1 - p) + \\alpha} $$\n使用 $1-p = (1-\\rho s)^N$ 和 $\\alpha = 1-(1-\\nu s)^N$，我们得到：\n$$ \\pi^{\\ast} = \\frac{1 - (1 - \\nu s)^N}{(1 - \\rho s)^N + [1 - (1 - \\nu s)^N]} $$\n这可以简化为最终的闭式表达式：\n$$ \\pi^{\\ast} = \\frac{1 - (1 - \\nu s)^N}{1 + (1 - \\rho s)^N - (1 - \\nu s)^N} $$\n该表达式给出了发现位点处于沉默状态 $S$ 的稳态概率，它是模型参数 $N$、$\\rho$、$s$ 和 $\\nu$ 的函数。", "answer": "$$\\boxed{\\frac{1 - (1 - \\nu s)^{N}}{1 + (1 - \\rho s)^{N} - (1 - \\nu s)^{N}}}$$", "id": "2808569"}]}