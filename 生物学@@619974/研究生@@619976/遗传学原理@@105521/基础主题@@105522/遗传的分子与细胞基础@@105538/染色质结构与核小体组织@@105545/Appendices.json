{"hands_on_practices": [{"introduction": "理解核小体的三维结构是掌握染色质组织的关键第一步。DNA双螺旋以精确的方式缠绕在组蛋白八聚体上，其中DNA的旋转朝向决定了哪些DNA凹槽可以与组蛋白表面相互作用。本练习将引导你通过计算来探索这种旋转定位，将核小体DNA路径上的线性碱基对位置与螺旋的方位角直接联系起来 [@problem_id:2797169]。", "problem": "一个核小体核心颗粒将大约两圈的B型脱氧核糖核酸（DNA）缠绕在一个组蛋白八聚体上。设二分体碱基对为旋转相位的原点，并将其旋转设定定义为角度 $0$（弧度）。在B型DNA中，螺旋重复为 $h = 10.5$ 个碱基对/圈，因此每前进一个碱基对，DNA的方位角会均匀地增加一整圈的 $1/h$。超螺旋位点（SHL）$n$ 标记了沿DNA缠绕路径上周期性的小沟内向接触位点，并且在一个很好的近似下，这些位点出现在距离二分体为 $s(n) \\approx 10 n$ 的碱基对偏移处。假设对于本次计算，相邻SHL整数之间的这个 $10$ 碱基对间距是精确成立的。\n\n定义在碱基对偏移量 $s$ 处的旋转设定为方位角 $\\theta(s)$，该角是通过相对于二分体的均匀前进获得的，并对一整圈取模，将结果约化到 $[0,2\\pi)$ 区间内的主值。仅使用这些定义和 $h=10.5$，按顺序计算在 SHL $-5$、SHL $-2$、SHL $+2$ 和 SHL $+5$ 处的预期旋转设定值（以弧度为单位）。将您的最终答案表示为 $\\pi$ 的精确有理数倍，每个值都约化到区间 $[0,2\\pi)$ 内，并将这四个值以单行矩阵的形式报告。", "solution": "首先，将对问题的科学性和逻辑完整性进行验证。\n\n从题目陈述中提取的已知条件如下：\n- DNA是B型。\n- 二分体碱基对是原点，其旋转设定为 $0$ 弧度。\n- 螺旋重复为 $h = 10.5$ 个碱基对/圈。\n- 前进一个碱基对对应于方位角均匀增加一整圈的 $\\frac{1}{h}$。\n- 超螺旋位点（SHL）由整数 $n$ 表示。\n- 对于给定的 SHL $n$，其距离二分体的碱基对偏移量 $s$ 由精确关系 $s(n) = 10n$ 给出。\n- 在偏移量 $s$ 处的旋转设定 $\\theta(s)$ 是相对于二分体的总方位角，经过对一整圈取模，约化到主值范围 $[0, 2\\pi)$。\n- 任务是计算当 $n \\in \\{-5, -2, +2, +5\\}$ 时，$\\theta(s(n))$ 的值。\n\n该问题具有科学依据，提法得当且客观。它基于DNA结构及其组织成染色质的既定原则，特别是DNA缠绕组蛋白八聚体形成核小体的过程。所提供的参数，如 $h = 10.5$ bp/turn，是溶液中B型DNA的标准教科书值。模型 $s(n) = 10n$ 是描述核小体核心颗粒中DNA接触几何构型的常用且有用的简化。该问题是自洽的，提供了推导出唯一、有意义解所需的所有信息。不存在矛盾、歧义或逻辑谬误。因此，该问题被认为是有效的，并将提供解答。\n\nDNA螺旋的旋转相位随着其序列位置均匀前进。一个完整的 $360$ 度转角，即 $2\\pi$ 弧度，发生在 $h = 10.5$ 个碱基对的长度上。因此，每碱基对的角度增加量 $\\Delta\\theta_{\\text{bp}}$ 为：\n$$\n\\Delta\\theta_{\\text{bp}} = \\frac{2\\pi}{h} = \\frac{2\\pi}{10.5} = \\frac{2\\pi}{\\frac{21}{2}} = \\frac{4\\pi}{21} \\text{ 弧度/碱基对}\n$$\n距离二分体（此处角度定义为 $0$）的碱基对偏移量为 $s$ 处的旋转设定 $\\theta(s)$ 是累积角度，必须将其约化到主区间 $[0, 2\\pi)$ 内。这是一个取模运算。\n$$\n\\theta(s) = (s \\cdot \\Delta\\theta_{\\text{bp}}) \\pmod{2\\pi}\n$$\n问题规定，给定 SHL $n$ 的碱基对偏移量 $s$ 取为 $s(n) = 10n$。将此关系和 $\\Delta\\theta_{\\text{bp}}$ 的表达式代入 $\\theta(s)$ 的方程，我们得到旋转设定作为 SHL 指数 $n$ 的函数：\n$$\n\\theta(n) = \\left( (10n) \\cdot \\frac{4\\pi}{21} \\right) \\pmod{2\\pi} = \\left( \\frac{40n\\pi}{21} \\right) \\pmod{2\\pi}\n$$\n现在我们为每个所需的 SHL 指数 $n$ 计算该值。\n\n对于 SHL $n = -5$：\n总角度为 $\\frac{40(-5)\\pi}{21} = -\\frac{200\\pi}{21}$。\n为了找到区间 $[0, 2\\pi)$ 内的等效角，我们必须加上 $2\\pi$ 的整数倍。我们可以将 $-\\frac{200}{21}$ 写成 $-9 - \\frac{11}{21}$。因此，角度是 $-9\\pi - \\frac{11\\pi}{21}$。不，这不是最清晰的方法。我们转而直接进行取模运算。\n$$\n-\\frac{200\\pi}{21} = -\\frac{(10 \\cdot 21 - 10)\\pi}{21} = -\\frac{210\\pi}{21} + \\frac{10\\pi}{21} = -5 \\cdot (2\\pi) + \\frac{10\\pi}{21}\n$$\n主值是正余数。\n$$\n\\theta(-5) = \\frac{10\\pi}{21}\n$$\n\n对于 SHL $n = -2$：\n总角度为 $\\frac{40(-2)\\pi}{21} = -\\frac{80\\pi}{21}$。\n我们进行取模运算：\n$$\n-\\frac{80\\pi}{21} = -\\frac{(4 \\cdot 21 - 4)\\pi}{21} = -\\frac{84\\pi}{21} + \\frac{4\\pi}{21} = -2 \\cdot (2\\pi) + \\frac{4\\pi}{21}\n$$\n主值是正余数。\n$$\n\\theta(-2) = \\frac{4\\pi}{21}\n$$\n\n对于 SHL $n = +2$：\n总角度为 $\\frac{40(2)\\pi}{21} = \\frac{80\\pi}{21}$。\n我们进行取模运算：\n$$\n\\frac{80\\pi}{21} = \\frac{(1 \\cdot 42 + 38)\\pi}{21} = \\frac{42\\pi}{21} + \\frac{38\\pi}{21} = 1 \\cdot (2\\pi) + \\frac{38\\pi}{21}\n$$\n余数是主值。\n$$\n\\theta(+2) = \\frac{38\\pi}{21}\n$$\n\n对于 SHL $n = +5$：\n总角度为 $\\frac{40(5)\\pi}{21} = \\frac{200\\pi}{21}$。\n我们进行取模运算：\n$$\n\\frac{200\\pi}{21} = \\frac{(4 \\cdot 42 + 32)\\pi}{21} = \\frac{168\\pi}{21} + \\frac{32\\pi}{21} = 4 \\cdot (2\\pi) + \\frac{32\\pi}{21}\n$$\n余数是主值。\n$$\n\\theta(+5) = \\frac{32\\pi}{21}\n$$\n所需的四个旋转设定值，按指定顺序（SHL $-5$、SHL $-2$、SHL $+2$、SHL $+5$）分别为 $\\frac{10\\pi}{21}$、$\\frac{4\\pi}{21}$、$\\frac{38\\pi}{21}$ 和 $\\frac{32\\pi}{21}$ 弧度。由于 $2\\pi = \\frac{42\\pi}{21}$，所有值都正确地位于区间 $[0, 2\\pi)$ 内。最终结果必须以行矩阵的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{10\\pi}{21} & \\frac{4\\pi}{21} & \\frac{38\\pi}{21} & \\frac{32\\pi}{21} \\end{pmatrix}}\n$$", "id": "2797169"}, {"introduction": "核小体不仅是DNA的包装单元，更是基因调控的动态参与者。通过与转录因子竞争结合位点，核小体能够直接控制基因的可及性。本练习将应用平衡态统计力学的原理，让你定量地分析组蛋白乙酰化如何通过改变核小体的结合自由能，从而影响转录因子的占据率，揭示表观遗传修饰调控基因表达的物理基础 [@problem_id:2797130]。", "problem": "一个定位的核小体遮蔽了一个启动子，该核小体与一个DNA结合转录因子（TF）竞争。假设存在以下生物学和物理学框架：\n\n- 启动子在热平衡状态下存在两种相互排斥的宏观状态：没有核小体的可及状态（状态 $\\mathrm{O}$）和有核小体结合的不可及状态（状态 $\\mathrm{N}$）。设 $\\mathrm{N}$ 和 $\\mathrm{O}$ 之间的自由能差为 $\\Delta G_{\\mathrm{nuc}}$（因此 $\\mathrm{N}$ 相对于 $\\mathrm{O}$ 的统计权重为 $\\exp(-\\Delta G_{\\mathrm{nuc}}/(k_{B}T))$），其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是絕對溫度。\n- 在状态 $\\mathrm{O}$ 中，TF可以结合到其位点上，其条件占有率（在可及的情况下）为 $f_{\\mathrm{TF}}$，该值取决于TF浓度和TF–DNA亲和力，但不受组蛋白乙酰化的影响。在状态 $\\mathrm{N}$ 中，假设TF位点是不可及的。\n- 组蛋白乙酰化修饰了核小体-DNA的相互作用，使得核小体结合自由能增加了 $\\Delta\\Delta G = \\Delta G_{\\mathrm{nuc}}^{\\mathrm{acetyl}} - \\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}} = +1.5\\,k_{B}T$（也就是说，乙酰化通过降低其有利程度来破坏核小体结合的稳定性）。\n- 考虑在乙酰化前，体系处于强核小体遮蔽的状态下，即 $\\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T)) \\gg 1$，因此启动子的可及性是TF占有率的限制因素。\n\n使用平衡统计力学和上述假设，推导TF占有率的预期倍数变化（乙酰化后与乙酰化前的比率），并对 $\\Delta\\Delta G = 1.5\\,k_{B}T$ 的情况进行数值计算。将倍数变化表示为一个纯数，并将您的答案四舍五入到四位有效数字。", "solution": "该问题要求在组蛋白乙酰化后，推导并计算转录因子（TF）在一个启动子位点上占有率的倍数变化。该系统使用平衡统计力学进行建模。\n\n**问题验证**\n\n首先，我对问题陈述进行严格的验证。\n\n1.  **提取已知条件**：明确给出的信息是：\n    *   启动子有两个宏观状态：可及状态（O）和核小体结合状态（N）。\n    *   系统处于热平衡状态。\n    *   状态N和状态O之间的自由能差为 $\\Delta G_{\\mathrm{nuc}}$。\n    *   状态N相对于状态O的统计权重为 $\\exp(-\\Delta G_{\\mathrm{nuc}}/(k_{B}T))$。\n    *   在状态O中，TF的条件占有率为 $f_{\\mathrm{TF}}$。此量与组蛋白乙酰化无关。\n    *   在状态N中，TF位点是不可及的。\n    *   组蛋白乙酰化使核小体结合自由能改变了 $\\Delta\\Delta G = \\Delta G_{\\mathrm{nuc}}^{\\mathrm{acetyl}} - \\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}} = +1.5\\,k_{B}T$。\n    *   系统在乙酰化前处于强核小体遮蔽的状态，数学上表述为 $\\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T)) \\gg 1$。\n\n2.  **使用提取的已知条件进行验证**：该问题具有科学依据，采用统计力学的标准原理（玻尔兹曼分布）来为一个被广泛理解的生物现象（启动子上的竞争性结合）建模。该问题是适定问题，因为所有必要的参数和条件都已定义，可以得到唯一解。语言客观而精确。问题陈述未表现出任何科学上不健全、不完整或模糊不清等缺陷。\n\n3.  **结论与行动**：该问题被认为是有效的。我将继续推導解决方案。\n\n**解决方案的推导**\n\nTF的总占有率，记为 $\\langle\\mathrm{Occ}_{\\mathrm{TF}}\\rangle$，是系统处于TF结合其DNA位点状态的概率。根据问题描述，这只在启动子处于可及状态O时才会发生。因此，TF占有率是启动子可及的概率 $P(\\mathrm{O})$ 与给定启动子可及条件下TF结合的条件概率 $f_{\\mathrm{TF}}$ 的乘积。\n\n$$\n\\langle\\mathrm{Occ}_{\\mathrm{TF}}\\rangle = P(\\mathrm{O}) \\times f_{\\mathrm{TF}}\n$$\n\n概率 $P(\\mathrm{O})$ 由开放状态O与核小体遮蔽状态N之间的热平衡决定。我们可以为这两个状态定义一个配分函数 $Z$。通过将参考状态O的自由能设为零，$G_{\\mathrm{O}} = 0$，其统计权重为 $w_{\\mathrm{O}} = \\exp(-G_{\\mathrm{O}}/(k_{B}T)) = 1$。状态N的自由能为 $G_{\\mathrm{N}} = \\Delta G_{\\mathrm{nuc}}$，因此其权重为 $w_{\\mathrm{N}} = \\exp(-\\Delta G_{\\mathrm{nuc}}/(k_{B}T))$。\n\n配分函数是权重的总和：\n$$\nZ = w_{\\mathrm{O}} + w_{\\mathrm{N}} = 1 + \\exp(-\\Delta G_{\\mathrm{nuc}}/(k_{B}T))\n$$\n\n启动子处于可及状态O的概率是状态O的权重除以配分函数：\n$$\nP(\\mathrm{O}) = \\frac{w_{\\mathrm{O}}}{Z} = \\frac{1}{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}/(k_{B}T))}\n$$\n\n现在我们可以将TF占有率写为：\n$$\n\\langle\\mathrm{Occ}_{\\mathrm{TF}}\\rangle = f_{\\mathrm{TF}} \\left( \\frac{1}{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}/(k_{B}T))} \\right)\n$$\n\n问题要求的是占有率的倍数变化，即乙酰化后的占有率与乙酰化前的占有率之比。\n\n乙酰化前（未修饰）的占有率为：\n$$\n\\langle\\mathrm{Occ}_{\\mathrm{TF}}\\rangle_{\\mathrm{unmod}} = f_{\\mathrm{TF}} \\left( \\frac{1}{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T))} \\right)\n$$\n\n乙酰化后的占有率为：\n$$\n\\langle\\mathrm{Occ}_{\\mathrm{TF}}\\rangle_{\\mathrm{acetyl}} = f_{\\mathrm{TF}} \\left( \\frac{1}{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{acetyl}}/(k_{B}T))} \\right)\n$$\n\n倍数变化是比率 $\\frac{\\langle\\mathrm{Occ}_{\\mathrm{TF}}\\rangle_{\\mathrm{acetyl}}}{\\langle\\mathrm{Occ}_{\\mathrm{TF}}\\rangle_{\\mathrm{unmod}}}$。因子 $f_{\\mathrm{TF}}$ 会被约掉。\n$$\n\\text{Fold-Change} = \\frac{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T))}{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{acetyl}}/(k_{B}T))}\n$$\n\n给定 $\\Delta G_{\\mathrm{nuc}}^{\\mathrm{acetyl}} = \\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}} + \\Delta\\Delta G$。我们将此关系代入倍数变化的表达式中。\n$$\n\\text{Fold-Change} = \\frac{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T))}{1 + \\exp(-(\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}} + \\Delta\\Delta G)/(k_{B}T))} = \\frac{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T))}{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T))\\exp(-\\Delta\\Delta G/(k_{B}T))}\n$$\n\n现在我们应用强遮蔽条件，$\\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T)) \\gg 1$。我们将此大量记为 $X = \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T))$。\n表达式变为：\n$$\n\\text{Fold-Change} = \\frac{1 + X}{1 + X \\exp(-\\Delta\\Delta G/(k_{B}T))}\n$$\n\n由于 $X \\gg 1$，我们可以在 $X \\to \\infty$ 的极限下分析此表达式。为正式进行此操作，我们将分子和分母同时除以 $X$：\n$$\n\\text{Fold-Change} = \\frac{\\frac{1}{X} + 1}{\\frac{1}{X} + \\exp(-\\Delta\\Delta G/(k_{B}T))}\n$$\n\n取 $X \\to \\infty$ 的极限，项 $\\frac{1}{X}$ 趋近于 $0$。表达式简化为：\n$$\n\\text{Fold-Change} \\approx \\frac{0 + 1}{0 + \\exp(-\\Delta\\Delta G/(k_{B}T))} = \\frac{1}{\\exp(-\\Delta\\Delta G/(k_{B}T))} = \\exp(\\Delta\\Delta G/(k_{B}T))\n$$\n这是在指定极限条件下倍数变化的最终解析表达式。\n\n**数值计算**\n\n给定 $\\Delta\\Delta G = +1.5\\,k_{B}T$。将其代入推导出的表达式中：\n$$\n\\text{Fold-Change} = \\exp\\left(\\frac{1.5\\,k_{B}T}{k_{B}T}\\right) = \\exp(1.5)\n$$\n计算其数值为：\n$$\n\\exp(1.5) \\approx 4.48168907 \\dots\n$$\n根据要求，四舍五入到四位有效数字：\n$$\n\\text{Fold-Change} \\approx 4.482\n$$\n$\\Delta\\Delta G$ 的正值表明乙酰化使核小体结合变得不稳定，从而使启动子更易于接近。这导致TF占有率增加，因此预期倍数变化大于$1$，与我们的结果一致。", "answer": "$$\\boxed{4.482}$$", "id": "2797130"}, {"introduction": "现代遗传学研究在很大程度上依赖于高通量测序技术和计算分析。本练习将带你进入生物信息学的世界，模拟一个分析ATAC-seq数据的真实场景。你将通过编写算法，将原始的测序片段数据转化为对启动子区域染色质结构的关键描述，例如核小体耗竭区（NDR）的宽度和+1核小体的位置，从而亲身体验从数据到生物学洞见的完整过程 [@problem_id:2797038]。", "problem": "设计并实现一个程序，该程序在给定启动子周围的转座酶可及性染色质测序 (Assay for Transposase-Accessible Chromatin using sequencing, ATAC-seq) 双端片段的情况下，根据染色质结构和核小体组织的基本原理计算两个量：(i) 相对于转录起始位点 (transcription start site, TSS) 的第一个下游核小体二分体的位置（下文称正一核小体二分体），以及 (ii) 以 TSS 为中心的核小体耗尽区 (nucleosome-depleted region, NDR) 的宽度。您的实现必须基于以下基本且被广泛接受的事实：(a) 依赖三磷酸腺苷 (adenosine triphosphate, ATP) 的转座酶优先插入到可及的脱氧核糖核酸 (deoxyribonucleic acid, DNA) 中，而 ATAC-seq 的双端片段反映了染色质的可及性区域；(b) 单核小体保护大约 $147$ 个碱基对 (base pairs, bp) 的 DNA，因此长度在单核小体附近的 ATAC-seq 片段模式反映了核小体的占据情况；(c) 核小体二分体是核小体 DNA 缠绕的中心，可以用核小体大小片段的中心来近似；(d) 正一核小体是 TSS 下游的第一个核小体；(e) 启动子处的 NDR 表现为 TSS 周围核小体占据率的一个波谷。\n\n您必须按如下方式将计算形式化。\n\n- 输入模型。给定一个有限的双端片段列表，每个片段表示为一个半开基因组区间 $[s_i, e_i)$，位于以碱基对 (bp) 为单位的整数坐标轴上，相对于 $x=0$ 处的 TSS。其中 $s_i$ 和 $e_i$ 是整数，且 $s_i < e_i$。片段 $i$ 的长度为 $\\ell_i = e_i - s_i$，其中心为 $c_i = (s_i + e_i)/2$（可能为非整数）。此外，还给定一个用于分析的基因组窗口 $[x_{\\min}, x_{\\max}]$，一个用于筛选核小体大小片段的单核小体长度范围 $[L_{\\min}, L_{\\max}]$（单位 bp），一个高斯平滑带宽 $\\sigma > 0$（单位 bp），一个阈值分数 $\\alpha \\in (0,1)$，以及一个用于搜索正一核小体的搜索区间 $[x_a, x_b]$（单位 bp）。\n\n- 核小体中心密度。令 $\\mathcal{N} = \\{ i \\mid L_{\\min} \\le \\ell_i \\le L_{\\max} \\}$ 为核小体大小片段的集合。在整数网格 $x_k \\in \\{ x_{\\min}, x_{\\min}+1, \\dots, x_{\\max} \\}$ 上，定义平滑后的核小体中心密度\n$$\nD(x_k) \\;=\\; \\sum_{i \\in \\mathcal{N}} \\exp\\!\\left( -\\frac{(x_k - c_i)^2}{2\\sigma^2} \\right).\n$$\n\n- 正一核小体二分体。将正一核小体二分体估计值 $x^\\star$ 定义为在搜索区间内使 $D(x)$ 最大化的位置：\n$$\nx^\\star \\;=\\; \\operatorname*{arg\\,max}_{x_k \\in [x_a, x_b] \\cap \\mathbb{Z}} \\; D(x_k),\n$$\n若有多个最大值，则选择最小的 $x_k$。报告 $x^\\star$ 作为相对于 TSS 的整数值（单位 bp）。\n\n- 核小体耗尽区宽度。令\n$$\n\\theta \\;=\\; \\alpha \\cdot \\max_{x_k \\in [x_{\\min}, x_{\\max}] \\cap \\mathbb{Z}} D(x_k).\n$$\n形成集合 $\\mathcal{Z} = \\{ x_k \\in [x_{\\min}, x_{\\max}] \\cap \\mathbb{Z} \\,:\\, D(x_k) \\le \\theta \\}$。考虑 $\\mathcal{Z}$ 中包含 $x=0$ 的连通分量（相对于整数网格上的单位步长）；如果不存在包含 $0$ 的此类分量，则定义 NDR 宽度为 $0$。否则，如果此连通分量由连续的网格点 $\\{ x_{i_0}, x_{i_0+1}, \\dots, x_{i_1} \\}$ 组成，且 $x_{i_0} \\le 0 \\le x_{i_1}$，则定义 NDR 宽度为\n$$\nw \\;=\\; (i_1 - i_0 + 1) \\times 1 \\;\\text{bp}.\n$$\n报告 $w$ 为以碱基对为单位的整数。\n\n实现一个严格遵循上述定义的算法。仅使用提供的片段和参数。所有答案必须以碱基对 (bp) 为单位表示为整数。\n\n测试套件。使用以下四个测试用例。每个测试用例提供 $[x_{\\min}, x_{\\max}]$，$[L_{\\min}, L_{\\max}]$，$\\sigma$，$\\alpha$，$[x_a, x_b]$，以及一个以 bp 为单位的半开区间 $(s_i, e_i)$ 形式的片段显式列表。\n\n- 用例 1（理想路径，下游有清晰的正一峰且有明确定义的 NDR）：\n    - 窗口：$x_{\\min} = -300$, $x_{\\max} = 400$。\n    - 单核小体长度范围：$L_{\\min} = 120$, $L_{\\max} = 200$。\n    - 高斯带宽：$\\sigma = 10$。\n    - 阈值分数：$\\alpha = 0.25$。\n    - 正一搜索范围：$x_a = 20$, $x_b = 250$。\n    - 片段 $(s_i, e_i)$：\n    $$\n    \\big[\n    (-20,130),\\,(-15,135),\\,(-13,137),\\,(-17,133),\\,(-10,140),\\,(-16,134),\\;\n    (-245,-95),\\,(-235,-85),\\,(-240,-90),\\,(-247,-97),\\;\n    (140,290),\\,(145,295),\\,(150,300),\\;\n    (-55,-5),\\,(-35,15),\\,(-25,25),\\,(-15,35),\\,(-5,45)\n    \\big].\n    $$\n\n- 用例 2（边界情况：在正一搜索范围内没有核小体大小的片段）：\n    - 窗口：$x_{\\min} = -200$, $x_{\\max} = 200$。\n    - 单核小体长度范围：$L_{\\min} = 120$, $L_{\\max} = 200$。\n    - 高斯带宽：$\\sigma = 8$。\n    - 阈值分数：$\\alpha = 0.20$。\n    - 正一搜索范围：$x_a = 20$, $x_b = 180$。\n    - 片段 $(s_i, e_i)$：\n    $$\n    \\big[\n    (-205,-55),\\,(-195,-45),\\,(-185,-35),\\;\n    (-45,5),\\,(-30,20),\\,(-20,30),\\,(-5,45)\n    \\big].\n    $$\n\n- 用例 3（下游有强核小体占据，NDR 较窄）：\n    - 窗口：$x_{\\min} = -200$, $x_{\\max} = 300$。\n    - 单核小体长度范围：$L_{\\min} = 120$, $L_{\\max} = 200$。\n    - 高斯带宽：$\\sigma = 12$。\n    - 阈值分数：$\\alpha = 0.30$。\n    - 正一搜索范围：$x_a = 20$, $x_b = 250$。\n    - 片段 $(s_i, e_i)$：\n    $$\n    \\big[\n    (-185,-35),\\,(-175,-25),\\,(-165,-15),\\;\n    (60,210),\\,(65,215),\\,(70,220),\\,(75,225),\\,(67,217),\\;\n    (-65,85),\\;\n    (-40,10),\\,(-25,25),\\,(-10,40)\n    \\big].\n    $$\n\n- 用例 4（边缘情况：完全核小体耗尽，只有短片段）：\n    - 窗口：$x_{\\min} = -200$, $x_{\\max} = 200$。\n    - 单核小体长度范围：$L_{\\min} = 120$, $L_{\\max} = 200$。\n    - 高斯带宽：$\\sigma = 10$。\n    - 阈值分数：$\\alpha = 0.10$。\n    - 正一搜索范围：$x_a = 20$, $x_b = 180$。\n    - 片段 $(s_i, e_i)$：\n    $$\n    \\big[\n    (-55,-5),\\,(-35,15),\\,(-25,25),\\,(-15,35),\\,(5,55)\n    \\big].\n    $$\n\n最终输出格式。您的程序应生成单行输出，其中包含四个测试用例的结果，格式为方括号括起来的逗号分隔列表，每个测试用例的结果是一个双元素列表 $[x^\\star, w]$。例如，打印\n$[ [x^\\star_1,w_1], [x^\\star_2,w_2], [x^\\star_3,w_3], [x^\\star_4,w_4] ]$\n不含任何附加文本，并且 $x^\\star_j$ 和 $w_j$ 均以碱基对 (bp) 为单位表示为整数。", "solution": "题目要求我们根据相对于启动子转录起始位点 (TSS) 的转座酶可及性染色质测序 (ATAC-seq) 双端片段，计算两个量：正一核小体二分体的位置和核小体耗尽区 (NDR) 的宽度。解决方案必须基于染色质生物学中的核心定义和经过充分检验的事实，并以计算机可以确定性执行的算法形式表达。\n\n原理基础。\n\n- 片段类别反映染色质结构。在 ATAC-seq 中，转座酶优先插入到可及的脱氧核糖核酸 (DNA) 中。受单核小体保护的 DNA 大约跨越 $147$ 个碱基对 (bp)，因此长度在 $147$ bp 附近（例如 $[120, 200]$ bp）的双端片段富集了单核小体的足迹。这些片段的中心近似于核小体二分体的位置。短片段（例如 $[35,100]$ bp）富集在开放染色质中，但在本问题中，我们不直接依赖短片段；相反，我们通过模拟单核小体信号的缺失来定义核小体耗尽区。\n\n- 核小体占据率作为平滑后的中心密度。给定核小体大小片段的中心 $c_i$，位置 $x$ 处的局部占据率可以通过使用带宽为 $\\sigma$ 的高斯核进行核密度估计来建模：\n$$\nD(x) \\;=\\; \\sum_{i \\in \\mathcal{N}} \\exp\\!\\left( -\\frac{(x - c_i)^2}{2\\sigma^2} \\right),\n$$\n其中 $\\mathcal{N}$ 为核小体大小片段的索引。这是一个经过充分检验的方法，用于从离散的中心点获得连续的占据率代理，同时通过平滑控制噪声。\n\n- 正一核小体二分体。根据定义，正一核小体是 TSS 下游的第一个核小体。在实践中，我们扫描一个下游区间 $[x_a, x_b]$ 并定位 $D(x)$ 的最大值，若有多个最大值则返回最小的坐标：\n$$\nx^\\star \\;=\\; \\operatorname*{arg\\,max}_{x \\in [x_a, x_b]} D(x).\n$$\n离散化到整数网格上可以得到唯一的整数值结果。\n\n- 核小体耗尽区宽度。NDR 是 TSS 周围核小体占据率的波谷。为了使其精确且可进行单元测试，我们在分析窗口 $[x_{\\min}, x_{\\max}]$ 内，以其最大值的某个分数 $\\alpha$ 对平滑后的占据率进行阈值处理：\n$$\n\\theta \\;=\\; \\alpha \\cdot \\max_{x \\in [x_{\\min}, x_{\\max}]} D(x).\n$$\n然后，我们收集集合 $\\mathcal{Z} = \\{ x \\in [x_{\\min}, x_{\\max}] \\cap \\mathbb{Z} : D(x) \\le \\theta \\}$ 并取包含 $x=0$ 的连通分量（在一维整数格点的邻接关系中）。如果没有分量包含 $0$，根据定义 NDR 宽度为 $0$。否则，如果该分量在单位间隔的整数网格上跨越索引 $i_0$ 到 $i_1$，那么以碱基对为单位的宽度是\n$$\nw \\;=\\; (i_1 - i_0 + 1) \\times 1\\ \\text{bp}.\n$$\n这个定义将概念上的“波谷”映射为一个精确的、整数值的长度，该长度源于 TSS 周围从无到低的核小体密度。\n\n算法设计。\n\n- 步骤 1：解析输入。对于每个测试用例，读取 $[x_{\\min}, x_{\\max}]$，$[L_{\\min}, L_{\\max}]$，$\\sigma$，$\\alpha$，$[x_a, x_b]$，以及半开区间片段 $(s_i, e_i)$ 的列表。\n\n- 步骤 2：计算片段长度 $\\ell_i = e_i - s_i$ 和中心 $c_i = (s_i + e_i)/2$。\n\n- 步骤 3：选择核小体大小的片段 $\\mathcal{N} = \\{ i : L_{\\min} \\le \\ell_i \\le L_{\\max} \\}$。\n\n- 步骤 4：构建整数网格 $x_k \\in \\{ x_{\\min}, x_{\\min}+1, \\dots, x_{\\max} \\}$，并评估\n$$\nD(x_k) \\;=\\; \\sum_{i \\in \\mathcal{N}} \\exp\\!\\left( -\\frac{(x_k - c_i)^2}{2\\sigma^2} \\right)\n$$\n通过直接求和，这对于此处指定的小型合成数据集是数值稳定的。\n\n- 步骤 5：通过在 $x_k \\in [x_a, x_b] \\cap \\mathbb{Z}$ 上最大化 $D(x_k)$ 来寻找正一核小体二分体 $x^\\star$，并向最小的 $x_k$ 进行平局决胜。因为网格是整数值的且 $\\sigma > 0$，所以得到的 $x^\\star$ 是一个以碱基对为单位的整数。\n\n- 步骤 6：在整个分析网格上计算 $\\theta = \\alpha \\cdot \\max_k D(x_k)$。构建 $\\mathcal{Z}$ 的布尔掩码，其对应 $D(x_k) \\le \\theta$ 的 $x_k$。识别索引 $k_0$ 使得 $x_{k_0} = 0$ (TSS)。如果 $D(0) > \\theta$（即 TSS 不在阈值以下的低占据区域），则设置 $w=0$。否则，从 $k_0$ 向左和向右扩展，同时保持在 $\\mathcal{Z}$ 内，以找到包含 $k_0$ 的最大连续索引 $i_0$ 和 $i_1$。计算 NDR 宽度为 $w = (i_1 - i_0 + 1)$（单位为碱基对）。\n\n- 步骤 7：格式化输出。对于四个测试用例，将双元素列表 $[x^\\star, w]$ 聚合为单个列表，并在一行上打印为带括号的、逗号分隔的列表，其条目为整数，不含附加文本。\n\n科学真实性与测试套件。\n\n- 用例 1 包括上游（负一核小体）、下游约 $+60$ bp 处（正一核小体）和更下游（正二核小体）的强单核小体大小片段簇，以及 TSS 附近的短片段。当 $\\sigma = 10$ 和 $\\alpha = 0.25$ 时，约 $+60$ bp 附近的占据峰在正一搜索区域 $[20,250]$ 中占主导地位，NDR 跨越 $0$ bp 周围的一个低占据波谷，其边界是向上游和下游核小体方向上占据率的升高。\n\n- 用例 2 在 $[20,180]$ 范围内缺少核小体大小的片段，因此该区域的 $D(x)$ 基本平坦且接近于零；平局决胜规则选择了允许的最小坐标 $x^\\star = 20$。NDR 宽度很大，因为在 TSS 附近 $D(x)$ 从未超过低阈值 $\\theta$。\n\n- 用例 3 在约 $+140$ bp 处呈现一个强的下游簇，在 $+10$ bp 附近有一个弱的核小体，在 $-100$ bp 附近有一个上游簇。当 $\\sigma = 12$ 和 $\\alpha = 0.30$ 时，$D(x)$ 在 $[20,250]$ 内的最大值出现在约 $+140$ bp 的簇附近，而 $0$ bp 周围的 NDR 由于 $+10$ bp 附近占据率的升高而比用例 1 中更窄。\n\n- 用例 4 完全不包含核小体大小的片段。因此 $D(x) \\equiv 0$，$\\theta = 0$，NDR 是整个窗口，其宽度等于 $[x_{\\min}, x_{\\max}]$ 中的整数位置数，即 $(x_{\\max} - x_{\\min} + 1)$ 个碱基对。在 $[20,180]$ 中的正一核小体二分体由平局决胜规则设置为 $x^\\star = 20$。\n\n所有计算均以碱基对 (bp) 为单位，并以整数形式报告。程序完全按照定义评估高斯和与集合操作，确保每个测试用例的数值输出仅由提供的输入和参数决定，没有任何启发式捷径。", "answer": "```\n[[60,85],[20,401],[142,51],[20,401]]\n```", "id": "2797038"}]}