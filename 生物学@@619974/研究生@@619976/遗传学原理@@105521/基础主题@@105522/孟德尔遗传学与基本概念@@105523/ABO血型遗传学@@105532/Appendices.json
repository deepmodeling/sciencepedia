{"hands_on_practices": [{"introduction": "掌握群体遗传学的核心在于能够将抽象的等位基因频率与可观察到的群体表型分布联系起来。本练习将引导您运用哈迪-温伯格平衡原理，处理一个包含三个等位基因（$A$, $B$ 和 $i$）的经典座位，并考虑显性关系。通过从根本上推导 ABO 血型系统的表型频率，您将巩固对多等位基因系统在群体层面如何表达的理解 [@problem_id:2789269]。", "problem": "在 ABO 血型系统中，考虑一个具有三个等位基因（表示为 $A$、$B$ 和 $i$）的单常染色体位点，其在群体中的等位基因频率分别为 $p_A$、$p_B$ 和 $p_i$，且 $p_A + p_B + p_i = 1$。假设一个大的、随机交配的群体处于 Hardy–Weinberg 平衡 (HWE) 状态，且无选择、无突变、无迁移。显性关系如下：等位基因 $A$ 和 $B$ 互为共显性，并且两者都对等位基因 $i$ 呈完全显性。因此，基因型 $AA$ 和 $Ai$ 表现为 A 型，基因型 $BB$ 和 $Bi$ 表现为 B 型，基因型 $AB$ 表现为 AB 型，而基因型 $ii$ 表现为 O 型。\n\n请严格基于多等位基因位点的 Hardy–Weinberg 原理和上述显性关系，首先以 $p_A$、$p_B$ 和 $p_i$ 为变量，推导出表现型 $A$、$B$、$AB$ 和 $O$ 的频率。然后，利用这些表现型频率，推导一个表达式，用于计算从该群体中独立随机抽取的两个个体具有相同 ABO 表现型的概率。\n\n请以一个用 $p_A$、$p_B$ 和 $p_i$ 表示的单一封闭形式代数表达式给出最终结果。无需进行数值近似或舍入。", "solution": "基本依据包括多等位基因位点的 Hardy–Weinberg 原理以及将基因型映射到表现型的 Mendelian 显性关系。在 Hardy–Weinberg 平衡 (HWE) 状态下，对于频率分别为 $p_A$、$p_B$ 和 $p_i$（且 $p_A + p_B + p_i = 1$）的等位基因 $A$、$B$ 和 $i$，其基因型频率由配子的随机结合决定，具体如下：\n- 纯合子：$AA$ 的频率为 $p_A^2$，$BB$ 的频率为 $p_B^2$，$ii$ 的频率为 $p_i^2$。\n- 杂合子：$AB$ 的频率为 $2 p_A p_B$，$Ai$ 的频率为 $2 p_A p_i$，$Bi$ 的频率为 $2 p_B p_i$。\n\n在所述显性关系下，基因型到表现型的映射如下：\n- 表现型 $A$ 由基因型 $AA$ 和 $Ai$ 产生。\n- 表现型 $B$ 由基因型 $BB$ 和 $Bi$ 产生。\n- 表现型 $AB$ 仅由基因型 $AB$ 产生（共显性）。\n- 表现型 $O$ 仅由基因型 $ii$ 产生。\n\n因此，表现型频率为：\n- $f_A = p_A^2 + 2 p_A p_i$\n- $f_B = p_B^2 + 2 p_B p_i$\n- $f_{AB} = 2 p_A p_B$\n- $f_O = p_i^2$\n\n题目要求的是两个独立随机抽取的个体具有相同 ABO 表现型的概率。由于独立抽样意味着两次抽取的个体的表现型是相互独立的，该概率是所有表现型频率的平方和：\n$$\nP_{\\text{same}} \\;=\\; f_A^2 + f_B^2 + f_{AB}^2 + f_O^2.\n$$\n将 $f_A$、$f_B$、$f_{AB}$ 和 $f_O$ 的表达式代入，可得：\n$$\nP_{\\text{same}} \\;=\\; \\left(p_A^2 + 2 p_A p_i\\right)^2 \\;+\\; \\left(p_B^2 + 2 p_B p_i\\right)^2 \\;+\\; \\left(2 p_A p_B\\right)^2 \\;+\\; \\left(p_i^2\\right)^2.\n$$\n这是一个用 $p_A$、$p_B$ 和 $p_i$ 表示的封闭形式代数表达式，它在指定假设下直接计算出所求概率。如果需要，可以展开此表达式，并利用 $p_A + p_B + p_i = 1$ 进一步简化，但对于得到一个有效的封闭形式结果而言，这种展开并非必要。", "answer": "$$\\boxed{\\left(p_A^2+2p_A p_i\\right)^2+\\left(p_B^2+2p_B p_i\\right)^2+\\left(2p_A p_B\\right)^2+p_i^4}$$", "id": "2789269"}, {"introduction": "孟德尔遗传定律为我们提供了强大的预测框架，但真实世界的遗传学充满了有趣的例外。这个练习通过一个罕见的 $\\mathrm{cis}\\!-\\!AB$ 等位基因案例，探讨了不完全外显性的概念，即特定基因型可能不会百分之百地表现出预期的表型。通过计算这种复杂遗传模式下的后代表型频率，您将学习如何运用概率论来解释和预测那些偏离经典孟德尔比例的遗传现象 [@problem_id:2772066]。", "problem": "ABO血型系统的单基因座模型假设，ABO基因的等位基因编码决定红细胞抗原表型的糖基转移酶活性：等位基因 $A$ 编码 $\\alpha$-$N$-乙酰半乳糖胺基转移酶（A活性），等位基因 $B$ 编码 $\\alpha$-半乳糖基转移酶（B活性），而等位基因 $i$（历史上称为 $O$）是无酶活性的无效等位基因。一个罕见的重组等位基因，记作 $\\mathrm{cis}\\!-\\!AB$，编码一种对 $A$ 和 $B$ 决定簇具有双重特异性的单一糖基转移酶，并已知在标准血清学检测中表现出表现度多变和外显不全。假设减数分裂遵循孟德尔分离定律，且不存在分离畸变。\n\n考虑一个 $\\mathrm{cis}\\!-\\!AB/i$ 亲本与一个 $i/i$ 亲本的交配。在一个经过验证的固定表型分型方案下，基因型 $\\mathrm{cis}\\!-\\!AB/i$ 被分为以下血清学表型，其外显率概率如下：\n- $P(\\text{phenotype }A \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.22$,\n- $P(\\text{phenotype }B \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.15$,\n- $P(\\text{phenotype }AB \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.62$,\n- $P(\\text{phenotype }O \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.01$,\n总和为 $1.00$。\n\n对于基因型 $i/i$，假设 $P(\\text{phenotype }O \\mid i/i) = 1.00$ 且 $P(\\text{any other phenotype} \\mid i/i) = 0$。\n\n仅使用上述定义、孟德尔分离定律和全概率定律，推导此次交配如何在后代中产生所有四种ABO表型，并计算后代中表型 $A$、$B$、$AB$ 和 $O$ 的预期频率。按 $A, B, AB, O$ 的顺序，以小数形式报告这四个频率，其总和应为 $1$，并将最终报告的数字四舍五入到四位有效数字。请勿在答案中使用百分号。", "solution": "所述问题是有效的。它在科学上基于孟德尔遗传学和概率论的原理。该问题提法恰当，为求得唯一解提供了所有必要的数据和定义，没有内部矛盾或模糊之处。这一情景涉及罕见的 $\\mathrm{cis}\\!-\\!AB$ 等位基因及其已知的外显不全特性，是人类遗传学中一个有效但非平凡的问题。\n\n求解过程需要两个主要步骤：首先，使用孟德尔分离定律确定可能的后代基因型的概率；其次，应用全概率定律，使用给定的外显率概率，计算每种表型的预期频率。\n\n设等位基因记为 $\\mathcal{A}_{\\mathrm{cisAB}}$、$\\mathcal{A}_A$、$\\mathcal{A}_B$ 和 $\\mathcal{A}_i$。问题中使用了 $\\mathrm{cis}\\!-\\!AB$、$A$、$B$ 和 $i$ 的表示法。我们将遵循问题中的表示法。\n\n交配发生在基因型为 $\\mathrm{cis}\\!-\\!AB/i$ 的亲本和基因型为 $i/i$ 的亲本之间。\n根据孟德尔分离定律，每个亲本以相等的概率将其两个等位基因中的一个遗传给后代。由于不存在分离畸变，因此来自杂合子亲本的每个等位基因的遗传概率恰好为 $\\frac{1}{2}$。\n\n亲本 $1$（基因型 $\\mathrm{cis}\\!-\\!AB/i$）产生两种类型的配子：\n\\begin{itemize}\n    \\item 带有等位基因 $\\mathrm{cis}\\!-\\!AB$ 的配子，概率为 $P(\\text{gamete} = \\mathrm{cis}\\!-\\!AB) = 0.5$。\n    \\item 带有等位基因 $i$ 的配子，概率为 $P(\\text{gamete} = i) = 0.5$。\n\\end{itemize}\n\n亲本 $2$（基因型 $i/i$）只产生一种类型的配子：\n\\begin{itemize}\n    \\item 带有等位基因 $i$ 的配子，概率为 $P(\\text{gamete} = i) = 1.0$。\n\\end{itemize}\n\n后代的基因型及其概率由每个亲本的配子组合决定。\n\\begin{enumerate}\n    \\item 后代基因型 $\\mathrm{cis}\\!-\\!AB/i$：由亲本 $1$ 的 $\\mathrm{cis}\\!-\\!AB$ 配子和亲本 $2$ 的 $i$ 配子融合产生。\n    其概率为 $P(G=\\mathrm{cis}\\!-\\!AB/i) = 0.5 \\times 1.0 = 0.5$。\n    \\item 后代基因型 $i/i$：由亲本 $1$ 的 $i$ 配子和亲本 $2$ 的 $i$ 配子融合产生。\n    其概率为 $P(G=i/i) = 0.5 \\times 1.0 = 0.5$。\n\\end{enumerate}\n后代基因型概率之和为 $0.5 + 0.5 = 1.0$，符合预期。\n\n问题要求计算后代中表型 $A$、$B$、$AB$ 和 $O$ 的预期频率。我们使用全概率定律。对于任何表型 $\\Phi$，其概率是给定每个可能基因型时该表型的条件概率，再乘以每个基因型的概率，然后对所有基因型求和：\n$$P(\\Phi=\\phi) = \\sum_{G_j} P(\\Phi=\\phi \\mid G=G_j) \\times P(G=G_j)$$\n其中，总和是针对所有可能的后代基因型 $G_j$。在本例中，基因型为 $G_1 = \\mathrm{cis}\\!-\\!AB/i$ 和 $G_2 = i/i$。\n\n给定的条件概率（外显率值）如下：\n\\begin{itemize}\n    \\item $P(\\text{phenotype } A \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.22$\n    \\item $P(\\text{phenotype } B \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.15$\n    \\item $P(\\text{phenotype } AB \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.62$\n    \\item $P(\\text{phenotype } O \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.01$\n\\end{itemize}\n对于 $i/i$ 基因型：\n\\begin{itemize}\n    \\item $P(\\text{phenotype } O \\mid i/i) = 1.00$\n    \\item $P(\\text{any other phenotype} \\mid i/i) = 0$\n\\end{itemize}\n\n利用这些信息，我们计算每种表型的概率：\n\n1.  **表型 A 频率：**\n    $$P(A) = P(A \\mid \\mathrm{cis}\\!-\\!AB/i)P(\\mathrm{cis}\\!-\\!AB/i) + P(A \\mid i/i)P(i/i)$$\n    $$P(A) = (0.22)(0.5) + (0)(0.5) = 0.11$$\n\n2.  **表型 B 频率：**\n    $$P(B) = P(B \\mid \\mathrm{cis}\\!-\\!AB/i)P(\\mathrm{cis}\\!-\\!AB/i) + P(B \\mid i/i)P(i/i)$$\n    $$P(B) = (0.15)(0.5) + (0)(0.5) = 0.075$$\n\n3.  **表型 AB 频率：**\n    $$P(AB) = P(AB \\mid \\mathrm{cis}\\!-\\!AB/i)P(\\mathrm{cis}\\!-\\!AB/i) + P(AB \\mid i/i)P(i/i)$$\n    $$P(AB) = (0.62)(0.5) + (0)(0.5) = 0.31$$\n\n4.  **表型 O 频率：**\n    $$P(O) = P(O \\mid \\mathrm{cis}\\!-\\!AB/i)P(\\mathrm{cis}\\!-\\!AB/i) + P(O \\mid i/i)P(i/i)$$\n    $$P(O) = (0.01)(0.5) + (1.00)(0.5) = 0.005 + 0.5 = 0.505$$\n\n该推导解释了这次交配如何能产生所有四种表型。后代群体是两种基因型的混合体。$i/i$ 个体将始终表现为 O 型血。而 $\\mathrm{cis}\\!-\\!AB/i$ 个体由于外显不全，可以表现出四种表型中的任何一种，尽管概率不同。这些结果的加权和导致在整个后代群体中，所有四种表型的概率都非零。\n\n为了验证，表型频率的总和是：\n$P(A) + P(B) + P(AB) + P(O) = 0.11 + 0.075 + 0.31 + 0.505 = 1.0$。\n\n问题要求将频率报告为小数，并四舍五入到四位有效数字。\n\\begin{itemize}\n    \\item $P(A) = 0.11 \\to 0.1100$\n    \\item $P(B) = 0.075 \\to 0.07500$\n    \\item $P(AB) = 0.31 \\to 0.3100$\n    \\item $P(O) = 0.505 \\to 0.5050$\n\\end{itemize}\n因此，表型 $A, B, AB, O$ 的最终频率分别为 $0.1100$、$0.07500$、$0.3100$ 和 $0.5050$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1100 & 0.07500 & 0.3100 & 0.5050\n\\end{pmatrix}\n}\n$$", "id": "2772066"}, {"introduction": "现代遗传学研究越来越依赖于计算建模，以整合从基因到表型的多层次生物学信息。这项综合性练习要求您构建一个动态区室模型，来模拟糖蛋白在高尔基体中经历的 ABO 抗原合成过程。通过将基因型（决定酶的表达水平 $E_A$ 和 $E_B$）与生化动力学和细胞运输相结合，您将亲身体验如何从第一性原理出发，定量地预测分子水平的表型结果，这是系统生物学方法的精髓所在 [@problem_id:2772055]。", "problem": "您的任务是设计并实现一个离散的、单次通过的区室模型，用以描述基于N-乙酰乳糖胺的聚糖在内质网（ER）和高尔基体中成熟的过程。该模型必须能够捕捉ABO血型转移酶活性对细胞表面抗原出现的影响。该模型必须基于以下基本原理：分子生物学中心法则（基因型决定酶丰度）、在底物饱和条件下由质量作用动力学描述的酶催化作用（产生有效的一级速率定律），以及通过高尔基体的顺序性囊泡运输。您编写的程序必须能针对指定的参数集，计算出细胞表面聚糖末端携带A抗原、B抗原或仍为H抗原的预测比例，并以小数形式表示。\n\n使用的建模假设和定义：\n- 区室化：一个糖蛋白依次穿过内质网（ER）和高尔基体，其中高尔基体由三个串联的区室表示：顺面、中间和反面。设高尔基体区室有 $n=3$ 个，索引为 $i \\in \\{1,2,3\\}$。在此问题中，ER被视为一个没有ABO转化的转运区室；它在顺面高尔基体入口处引入底物H抗原。因此，就ABO转化而言，只有三个高尔基体区室贡献反应事件。\n- 区室内驻留时间：设在区室 $i$ 内的驻留时间为 $t_i$（单位为 $\\mathrm{s}$），这些时间收集在一个向量 $\\mathbf{t} = [t_1,t_2,t_3]$ 中，且 $t_i \\ge 0$。\n- 有效动力学：假设供体底物是饱和的，因此由ABO转移酶催化的H到A和H到B的转化可以很好地近似为独立的、竞争性的不可逆一级反应，每个区室具有恒定的风险率。对于区室 $i$，定义伪一级速率常数 $k_{Ai}$ 和 $k_{Bi}$，单位为 $\\mathrm{s}^{-1}$。\n- 酶活性的遗传控制：设 $E_A$ 和 $E_B$ 分别为A型和B型转移酶的无量纲相对表达水平，由基因型决定。每个区室单位酶的催化效率为常数 $c_{Ai}$ 和 $c_{Bi}$，单位为 $\\mathrm{s}^{-1}$ 每单位酶，因此对每个 $i$ 都有 $k_{Ai} = E_A \\cdot c_{Ai}$ 和 $k_{Bi} = E_B \\cdot c_{Bi}$。\n- 单次通过运输：每个聚糖按顺序单次通过每个区室。在区室 $i$ 内，H状态可以随机且不可逆地转化为A或B，或者在离开前保持为H状态，其恒定风险率为 $k_{Ai}$ 和 $k_{Bi}$。到达细胞表面后不发生转化。不存在逆向运输和逆反应。进入顺面高尔基体时的初始条件是：H状态的比例为 $1$，A和B状态的比例为 $0$。\n\n要求的推导与计算：\n- 仅使用上述定义以及竞争性泊松过程和恒定风险率下生存分析的第一性原理，推导出将 $(\\mathbf{t}, \\mathbf{c}_A, \\mathbf{c}_B, E_A, E_B)$ 映射到最终细胞表面组分比例 $(f_A, f_B, f_H)$ 的表达式，其中 $f_A$ 是携带A抗原的比例，$f_B$ 是携带B抗原的比例，$f_H$ 是仍为H抗原的比例。您的推导必须从每个区室中未转化H状态的生存函数开始，并考虑跨区室生存率的顺序累积以及在每个区室中转化为A或B的条件概率。最终比例必须满足 $f_A \\ge 0$，$f_B \\ge 0$，$f_H \\ge 0$ 和 $f_A + f_B + f_H = 1$。\n- 所有时间参数的单位必须是 $\\mathrm{s}$，所有速率常数的单位必须是 $\\mathrm{s}^{-1}$，所有输出必须报告为四舍五入到 $6$ 位小数的小数。\n\n测试套件的输入参数：\n- 固定催化效率向量（在所有测试用例中相同）：\n  - $\\mathbf{c}_A = [2.0\\times 10^{-3},\\;4.0\\times 10^{-3},\\;1.0\\times 10^{-3}]\\,\\mathrm{s}^{-1}\\,\\text{每单位酶}$。\n  - $\\mathbf{c}_B = [1.5\\times 10^{-3},\\;3.5\\times 10^{-3},\\;1.2\\times 10^{-3}]\\,\\mathrm{s}^{-1}\\,\\text{每单位酶}$。\n- 定义基础驻留时间向量：\n  - $\\mathbf{t}^{(\\text{base})} = [600,\\;900,\\;600]\\,\\mathrm{s}$。\n- 程序必须为以下 $5$ 个测试用例中的每一个计算 $(f_A, f_B, f_H)$，其中每个用例是一个元组 $(E_A, E_B, \\mathbf{t})$：\n  1. $(1.0,\\;0.0,\\;\\mathbf{t}^{(\\text{base})})$ 模拟典型运输下的A基因型。\n  2. $(0.0,\\;1.2,\\;\\mathbf{t}^{(\\text{base})})$ 模拟典型运输下B表达增强的情况。\n  3. $(0.8,\\;0.8,\\;\\mathbf{t}^{(\\text{base})})$ 模拟典型运输下的共表达（AB基因型）。\n  4. $(0.0,\\;0.0,\\;\\mathbf{t}^{(\\text{base})})$ 模拟无转化的O基因型。\n  5. $(1.0,\\;0.0,\\;[5,\\;5,\\;5]\\,\\mathrm{s})$ 模拟极快运输下的A基因型。\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素是对应于一个测试用例的内部列表，包含三个小数 $[f_A,f_B,f_H]$，顺序与上述测试用例相同。数值必须四舍五入到 $6$ 位小数。例如，语法正确的输出形式为 $[[x_{11},x_{12},x_{13}],[x_{21},x_{22},x_{23}],\\dots]$，除了逗号和括号外，没有额外的空白字符要求。", "solution": "该问题要求推导并实现一个区室模型，用于描述糖蛋白在穿过高尔基体时合成ABO抗原的过程。该模型基于竞争反应的一级动力学和顺序运输。\n\n**问题验证。**\n问题陈述经评估为有效。它在科学上基于细胞生物学和生物化学动力学的既定原则，特别是区室建模、在底物饱和下近似为一级过程的质量作用定律，以及顺序性囊泡运输。问题定义明确，提供了所有必需的参数、初始条件（进入顺面高尔基体时为$100\\%$ H抗原）以及一套清晰、客观的状态转换规则。所提供的参数对于生物系统是物理上现实的。问题是自包含的、可数学形式化的，并在模型的推导和实现中提出了一个非平凡的挑战。\n\n**模型推导。**\n\n设糖蛋白的状态由其末端抗原表示，可以是H、A或B。过程始于一批全部处于H状态的糖蛋白进入高尔基体的第一个区室。高尔基体被建模为 $n=3$ 个顺序区室，索引为 $i \\in \\{1, 2, 3\\}$。\n\n设 $H_i$、$A_i$ 和 $B_i$ 分别表示在离开区室 $i$ 时，该批次中处于H、A和B状态的比例。进入区室 $1$（为方便表示，索引记为 $i=0$）时的初始条件为：\n$$\nH_0 = 1, \\quad A_0 = 0, \\quad B_0 = 0\n$$\n\n在每个区室 $i$ 内，一个糖蛋白驻留时间为 $t_i$。在此期间，处于H状态的分子可以以伪一级速率常数 $k_{Ai}$ 转化为A状态，或以速率常数 $k_{Bi}$ 转化为B状态。这些转化被建模为竞争性的、独立的泊松过程。在区室 $i$ 中H转化的总风险率为各个速率之和：\n$$\n\\lambda_i = k_{Ai} + k_{Bi}\n$$\n速率常数由酶表达水平 $E_A$ 和 $E_B$ 以及内在催化效率 $\\mathbf{c}_A$ 和 $\\mathbf{c}_B$ 决定：\n$$\nk_{Ai} = E_A \\cdot c_{Ai}, \\quad k_{Bi} = E_B \\cdot c_{Bi}\n$$\n\n考虑一个进入区室 $i$ 的H状态糖蛋白。在其驻留时间 $t_i$ 内保持H状态的概率由速率为 $\\lambda_i$ 的指数分布的生存函数给出：\n$$\nP(\\text{在区室 } i \\text{ 内以H状态存活}) = e^{-\\lambda_i t_i}\n$$\n因此，它被转化为A或B的概率为：\n$$\nP(\\text{在区室 } i \\text{ 内转化}) = 1 - e^{-\\lambda_i t_i}\n$$\n如果发生转化（即 $\\lambda_i > 0$），结果由相对速率决定。转化到A状态的条件概率为：\n$$\nP(\\text{H} \\to \\text{A} | \\text{发生转化}) = \\frac{k_{Ai}}{k_{Ai} + k_{Bi}} = \\frac{k_{Ai}}{\\lambda_i}\n$$\n转化到B状态的条件概率为：\n$$\nP(\\text{H} \\to \\text{B} | \\text{发生转化}) = \\frac{k_{Bi}}{k_{Ai} + k_{Bi}} = \\frac{k_{Bi}}{\\lambda_i}\n$$\n如果 $\\lambda_i=0$，则不发生转化，这些条件概率也就不需要了。\n\n现在，我们可以为当这批糖蛋白从一个区室传递到下一个区室时各组分比例 $H_i$、$A_i$ 和 $B_i$ 建立递推关系。设 $H_{i-1}$、$A_{i-1}$ 和 $B_{i-1}$ 是进入区室 $i$ 时的比例。\n\n进入区室 $i$ 时仍处于H状态的批次比例为 $H_{i-1}$。只有这部分会发生转化。离开区室 $i$ 时仍保持H状态的比例为：\n$$\nH_i = H_{i-1} \\cdot e^{-\\lambda_i t_i}\n$$\n这是一个递推公式。将其展开，经过 $n$ 个区室后剩余的H总比例为：\n$$\nH_n = H_0 \\prod_{j=1}^{n} e^{-\\lambda_j t_j} = \\exp\\left(-\\sum_{j=1}^{n} \\lambda_j t_j\\right)\n$$\n\n已经处于A或B状态的糖蛋白是惰性的。新的A和B抗原仅由 $H_{i-1}$ 比例的组分形成。在区室 $i$ 中，A抗原携带者比例的增量，记为 $\\Delta A_i$，是进入的H比例乘以转化概率，再乘以该转化是向A的条件概率：\n$$\n\\Delta A_i = H_{i-1} \\cdot \\left(1 - e^{-\\lambda_i t_i}\\right) \\cdot \\frac{k_{Ai}}{\\lambda_i}\n$$\nB抗原也类似：\n$$\n\\Delta B_i = H_{i-1} \\cdot \\left(1 - e^{-\\lambda_i t_i}\\right) \\cdot \\frac{k_{Bi}}{\\lambda_i}\n$$\n这些公式在 $\\lambda_i > 0$ 时成立。如果 $\\lambda_i=0$，则 $k_{Ai}=k_{Bi}=0$，项 $(1 - e^{-\\lambda_i t_i})$ 为零，从而正确地得到 $\\Delta A_i = 0$ 和 $\\Delta B_i = 0$。\n\n经过区室 $i$ 后的总比例是进入时的比例与新形成比例的总和：\n$$\nA_i = A_{i-1} + \\Delta A_i\n$$\n$$\nB_i = B_{i-1} + \\Delta B_i\n$$\n\n离开最后一个区室（$i=3$）时的最终比例为 $(f_A, f_B, f_H) = (A_3, B_3, H_3)$。这些比例是通过对 $i=1, 2, 3$ 顺序应用递推关系计算出来的。\n\n**计算算法。**\n1. 初始化比例：$H \\leftarrow 1.0$，$A \\leftarrow 0.0$，$B \\leftarrow 0.0$。\n2. 对每个区室 $i$（从 $1$ 到 $3$）：\n   a. 计算速率常数 $k_{Ai} = E_A \\cdot c_{Ai}$ 和 $k_{Bi} = E_B \\cdot c_{Bi}$。\n   b. 计算总风险率 $\\lambda_i = k_{Ai} + k_{Bi}$。\n   c. 确定进入区室 $i$ 的H组分中通过该区室后存活下来的比例：$S_i = e^{-\\lambda_i t_i}$。\n   d. 确定进入的H组分中发生转化的比例：$C_i = 1 - S_i$。\n   e. 计算从当前H比例中新生成的A和B的数量。如果 $\\lambda_i > 0$：\n      i. $\\Delta A = H \\cdot C_i \\cdot (k_{Ai} / \\lambda_i)$\n      ii. $\\Delta B = H \\cdot C_i \\cdot (k_{Bi} / \\lambda_i)$\n   f. 更新总比例：$A \\leftarrow A + \\Delta A$，$B \\leftarrow B + \\Delta B$。\n   g. 为下一阶段更新H比例：$H \\leftarrow H \\cdot S_i$。\n3. 最终计算出的 $A$、$B$ 和 $H$ 的值即为所求的比例 $f_A, f_B, f_H$。然后将它们四舍五入到 $6$ 位小数。此过程确保了质量守恒，即在浮点精度和舍入误差允许的范围内，$f_A + f_B + f_H = 1$。", "answer": "[[0.995505,0.0,0.004495],[0.0,0.991444,0.008556],[0.82948,0.160136,0.010384],[0.0,0.0,1.0],[0.034419,0.0,0.965581]]", "id": "2772055"}]}