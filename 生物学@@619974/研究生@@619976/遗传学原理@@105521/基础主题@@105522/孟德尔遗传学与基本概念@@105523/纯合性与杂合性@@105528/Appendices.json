{"hands_on_practices": [{"introduction": "群体遗传学的核心任务之一是从样本数据中推断群体的演化过程。这个练习将指导你完成一个基本但至关重要的分析：从原始基因型计数出发，计算等位基因频率，并估算近交系数 $F_{IS}$ [@problem_id:2823093]。通过将观测杂合度与哈代-温伯格平衡下的期望杂合度进行比较，我们可以量化群体中杂合子缺失的程度，这通常是近亲繁殖或群体结构存在的重要标志。", "problem": "从一个二倍体、随机交配的群体中，针对一个具有等位基因 $A$ 和 $B$ 的单个双等位基因座进行抽样。样本包含基因型计数 $(n_{AA}, n_{AB}, n_{BB}) = (112, 58, 30)$，总计 $n = 200$ 个个体。假设该群体来源符合哈迪-温伯格平衡（HWE），并且抽样相对于基因型是随机的。\n\n从基本原理和核心定义出发：\n- 群体中等位基因 $A$ 的频率用 $p$ 表示，在 HWE 条件下，基因型频率由等位基因频率向量的平方给出。\n- 观测杂合度定义为样本中杂合子的比例。\n- HWE 条件下的期望杂合度是由等位基因频率 $p$ 所决定的群体中杂合子的比例。\n\n利用这些原理，从基因型计数推导出 $p$ 的最大似然估计量 $\\hat{p}$，然后推导作为 $p$ 的函数的期望杂合度，最后计算个体相对于其亚群体的 Wright 近交系数 $(F_{IS})$ 的估计量，该估计量为该样本中杂合度相对于 HWE 期望的标准化亏损。报告给定数据的 $\\hat{F}_{IS}$ 的单一数值。将最终答案四舍五入到四位有效数字，且不带单位。", "solution": "该问题已经过验证，被认为是科学上合理、提法严谨且内容自洽的。这是群体遗传学中的一个标准问题。我们可以开始解答。\n\n该问题要求从基因型计数样本中计算近交系数 $F_{IS}$。解题过程必须按规定从基本原理推导。设该双等位基因座上的等位基因为 $A$ 和 $B$。观测到的基因型 $AA$、$AB$ 和 $BB$ 的计数分别为 $n_{AA} = 112$、$n_{AB} = 58$ 和 $n_{BB} = 30$。总样本大小为 $n = n_{AA} + n_{AB} + n_{BB} = 112 + 58 + 30 = 200$。\n\n首先，我们推导等位基因 $A$ 频率（用 $p$ 表示）的最大似然估计量 (MLE)。等位基因 $B$ 的频率则为 $q = 1-p$。根据哈迪-温伯格平衡 (HWE) 原理，群体中基因型 $AA$、$AB$ 和 $BB$ 的期望频率分别为 $p^2$、$2pq$ 和 $q^2 = (1-p)^2$。\n\n假设样本是从一个大型随机交配群体中抽取的，则基因型计数服从多项分布。给定观测计数，参数 $p$ 的似然函数 $L$ 与观察到每种基因型的概率的其计数值次方的乘积成正比：\n$$ L(p | n_{AA}, n_{AB}, n_{BB}) \\propto (p^2)^{n_{AA}} (2p(1-p))^{n_{AB}} ((1-p)^2)^{n_{BB}} $$\n我们可以通过合并含 $p$ 和 $(1-p)$ 的项来简化此表达式：\n$$ L(p) \\propto p^{2n_{AA}} \\cdot p^{n_{AB}} \\cdot (1-p)^{n_{AB}} \\cdot (1-p)^{2n_{BB}} $$\n$$ L(p) \\propto p^{2n_{AA} + n_{AB}} (1-p)^{n_{AB} + 2n_{BB}} $$\n为了找到使该似然最大化的 $p$ 值，我们使用对数似然函数 $\\ln L(p)$，因为它将乘积转换为和，从而简化了最大化问题：\n$$ \\ln L(p) = C + (2n_{AA} + n_{AB})\\ln(p) + (n_{AB} + 2n_{BB})\\ln(1-p) $$\n其中 $C$ 是一个不依赖于 $p$ 的常数。为了找到最大值，我们对 $\\ln L(p)$ 关于 $p$ 求导，并令其等于零：\n$$ \\frac{d}{dp} \\ln L(p) = \\frac{2n_{AA} + n_{AB}}{p} - \\frac{n_{AB} + 2n_{BB}}{1-p} = 0 $$\n解 $p$：\n$$ \\frac{2n_{AA} + n_{AB}}{p} = \\frac{n_{AB} + 2n_{BB}}{1-p} $$\n$$ (2n_{AA} + n_{AB})(1-p) = p(n_{AB} + 2n_{BB}) $$\n$$ 2n_{AA} + n_{AB} - p(2n_{AA} + n_{AB}) = p(n_{AB} + 2n_{BB}) $$\n$$ 2n_{AA} + n_{AB} = p(2n_{AA} + n_{AB} + n_{AB} + 2n_{BB}) $$\n$$ 2n_{AA} + n_{AB} = p(2n_{AA} + 2n_{AB} + 2n_{BB}) $$\n$$ 2n_{AA} + n_{AB} = p \\cdot 2(n_{AA} + n_{AB} + n_{BB}) = 2np $$\n这给出了 $p$ 的最大似然估计量，记作 $\\hat{p}$：\n$$ \\hat{p} = \\frac{2n_{AA} + n_{AB}}{2n} $$\n该结果可以直观地理解为样本基因库中 $A$ 等位基因的比例。样本中等位基因的总数为 $2n$。每个 $AA$ 个体携带两个 $A$ 等位基因，每个 $AB$ 个体携带一个 $A$ 等位基因。\n\n使用给定数据 ($n_{AA} = 112$，$n_{AB} = 58$，$n = 200$)，我们计算 $\\hat{p}$：\n$$ \\hat{p} = \\frac{2(112) + 58}{2(200)} = \\frac{224 + 58}{400} = \\frac{282}{400} = 0.705 $$\n\n接下来，我们定义观测杂合度和期望杂合度。观测杂合度 $H_o$ 是样本中杂合子的比例：\n$$ H_o = \\frac{n_{AB}}{n} $$\n对于给定数据：\n$$ H_o = \\frac{58}{200} = 0.29 $$\n期望杂合度 $H_e$ 是在给定等位基因频率 $p$ 的情况下，根据 HWE 期望的杂合子频率。这由 HWE 原理推导得出：\n$$ H_e(p) = 2p(1-p) $$\n期望杂合度的估计量 $\\hat{H}_e$ 是通过将最大似然估计量 $\\hat{p}$ 代入该公式获得的：\n$$ \\hat{H}_e = 2\\hat{p}(1-\\hat{p}) $$\n使用我们计算出的 $\\hat{p} = 0.705$：\n$$ \\hat{H}_e = 2(0.705)(1 - 0.705) = 2(0.705)(0.295) = 0.41595 $$\n\n最后，Wright 的近交系数 $F_{IS}$ 定义为亚群体中杂合子相对于 HWE 期望的标准化亏损。其估计量 $\\hat{F}_{IS}$ 计算如下：\n$$ \\hat{F}_{IS} = \\frac{\\hat{H}_e - H_o}{\\hat{H}_e} = 1 - \\frac{H_o}{\\hat{H}_e} $$\n正值表示杂合子亏损（近交），而负值表示杂合子过量。代入 $H_o$ 和 $\\hat{H}_e$ 的值：\n$$ \\hat{F}_{IS} = 1 - \\frac{0.29}{0.41595} \\approx 1 - 0.69719918 $$\n$$ \\hat{F}_{IS} \\approx 0.30280082 $$\n题目要求将答案四舍五入到四位有效数字。第一位有效数字是 $3$。接下来的三位是 $0$、$2$ 和 $8$。第五位是 $0$，所以我们不进位。\n$$ \\hat{F}_{IS} \\approx 0.3028 $$\n该值表明，与基于样本等位基因频率的哈迪-温伯格平衡期望相比，样本中的杂合子存在显著亏损。", "answer": "$$\n\\boxed{0.3028}\n$$", "id": "2823093"}, {"introduction": "在比较不同群体之间的遗传多样性时，一个常见的挑战是样本量的不一致，这可能会对杂合度等度量产生偏差。本练习介绍了一种名为“稀疏化”(rarefaction)的统计方法，用于标准化不同大小样本的杂合度估计 [@problem_id:2823073]。通过从第一性原理推导出一个不受样本量影响的杂合度度量，你将学会如何对遗传多样性进行严谨而公正的比较。", "problem": "一个多等位基因座在两个独立的二倍体样本（记为样本 A 和样本 B）中分离出等位基因 $A_1, A_2, A_3, A_4$。每个样本中的基因型可能任意偏离哈迪-温伯格平衡；仅给出基因拷贝中的等位基因计数。具体而言，样本 A 包含 $n_A = 35$ 个二倍体个体，因此有 $2 n_A = 70$ 个基因拷贝，其等位基因计数为 $(n_{1}^{A}, n_{2}^{A}, n_{3}^{A}, n_{4}^{A}) = (28, 22, 14, 6)$。样本 B 包含 $n_B = 20$ 个二倍体个体，因此有 $2 n_B = 40$ 个基因拷贝，其等位基因计数为 $(n_{1}^{B}, n_{2}^{B}, n_{3}^{B}, n_{4}^{B}) = (14, 12, 8, 6)$。\n\n从第一性原理出发，且不假设哈迪-温伯格平衡，请在基因拷贝层面使用稀疏化方法，定义一个可在不同 $n$ 值的样本间进行比较的标准化杂合度。具体来说，将样本的标准化杂合度 $H_{r}$ 定义为：从该样本的 $2n$ 个基因拷贝中无放回地均匀随机抽取两个基因拷贝，这两个拷贝携带不同等位基因类型的概率。请通过基本计数法，推导一个用等位基因计数 $(n_1, \\dots, n_k)$ 和 $n$ 表示的 $H_{r}$ 通用表达式。\n\n然后，应用你的表达式根据上述数据计算 $H_{r}(A)$ 和 $H_{r}(B)$，并报告比率 $R = H_{r}(A) / H_{r}(B)$。将最终答案表示为最简分数，无需四舍五入。", "solution": "所述问题是有效的。它在群体遗传学中有科学依据，内容自洽，且提法恰当。所有数据都是一致的，足以推导出唯一解。我将开始进行推导和计算。\n\n假设一个样本包含 $n$ 个二倍体个体，对应于目标基因座上总共 $N = 2n$ 个基因拷贝。该基因座分离出 $k$ 个等位基因，其各自的计数为 $(n_1, n_2, \\dots, n_k)$，因此基因拷贝总数为 $N = \\sum_{i=1}^{k} n_i$。\n\n标准化杂合度 $H_r$ 定义为从样本中无放回地均匀随机抽取的两个基因拷贝属于不同等位基因类型的概率。\n\n从 $N$ 个可用拷贝中选择一个不同的基因拷贝的无序对的总方式数由二项式系数 $\\binom{N}{2}$ 给出：\n$$ \\binom{N}{2} = \\frac{N(N-1)}{2} $$\n这构成了我们进行概率计算的样本空间的大小。\n\n我们可以通过先确定其互补事件 $G_r$ 的概率来计算 $H_r$，其中 $G_r$ 是抽到两个*相同*等位基因类型拷贝的概率。然后，$H_r = 1 - G_r$。\n\n对于一个计数为 $n_i$ 的特定等位基因 $A_i$，抽到两个该等位基因拷贝的方式数为 $\\binom{n_i}{2}$。抽到一对相同类型基因拷贝的总方式数是所有 $k$ 个等位基因方式数之和：\n$$ \\text{相同类型对的数量} = \\sum_{i=1}^{k} \\binom{n_i}{2} = \\sum_{i=1}^{k} \\frac{n_i(n_i-1)}{2} $$\n概率 $G_r$ 是相同类型对的数量与可能总对数的比率：\n$$ G_r = \\frac{\\sum_{i=1}^{k} \\binom{n_i}{2}}{\\binom{N}{2}} = \\frac{\\sum_{i=1}^{k} \\frac{n_i(n_i-1)}{2}}{\\frac{N(N-1)}{2}} = \\frac{\\sum_{i=1}^{k} n_i(n_i-1)}{N(N-1)} $$\n因此，标准化杂合度 $H_r$ 由下式给出：\n$$ H_r = 1 - G_r = 1 - \\frac{\\sum_{i=1}^{k} n_i(n_i-1)}{N(N-1)} $$\n由于问题要求用 $n$ 来表示表达式，且 $N=2n$，因此通用表达式为：\n$$ H_r = 1 - \\frac{\\sum_{i=1}^{k} n_i(n_i-1)}{2n(2n-1)} $$\n这个表达式通常被称为 Nei 的基因多样性无偏估计量，它正确地考虑了从有限样本中进行无放回抽样的情况，因此使其不受哈迪-温伯格平衡等假设的影响。\n\n现在，我们将此公式应用于样本 A 和样本 B 的给定数据。\n\n对于样本 A：\n个体数为 $n_A = 35$，因此基因拷贝数为 $N_A = 2n_A = 70$。等位基因计数为 $(n_{1}^{A}, n_{2}^{A}, n_{3}^{A}, n_{4}^{A}) = (28, 22, 14, 6)$。\n$G_r(A)$ 表达式中分子的总和是：\n$$ \\sum_{i=1}^{4} n_i^A(n_i^A-1) = 28 \\times (27) + 22 \\times (21) + 14 \\times (13) + 6 \\times (5) $$\n$$ = 756 + 462 + 182 + 30 = 1430 $$\n分母项是 $N_A(N_A-1) = 70 \\times 69 = 4830$。\n样本 A 的纯合度概率为：\n$$ G_r(A) = \\frac{1430}{4830} = \\frac{143}{483} $$\n样本 A 的标准化杂合度为：\n$$ H_r(A) = 1 - G_r(A) = 1 - \\frac{143}{483} = \\frac{483 - 143}{483} = \\frac{340}{483} $$\n\n对于样本 B：\n个体数为 $n_B = 20$，因此基因拷贝数为 $N_B = 2n_B = 40$。等位基因计数为 $(n_{1}^{B}, n_{2}^{B}, n_{3}^{B}, n_{4}^{B}) = (14, 12, 8, 6)$。\n$G_r(B)$ 表达式中分子的总和是：\n$$ \\sum_{i=1}^{4} n_i^B(n_i^B-1) = 14 \\times (13) + 12 \\times (11) + 8 \\times (7) + 6 \\times (5) $$\n$$ = 182 + 132 + 56 + 30 = 400 $$\n分母项是 $N_B(N_B-1) = 40 \\times 39 = 1560$。\n样本 B 的纯合度概率为：\n$$ G_r(B) = \\frac{400}{1560} = \\frac{40}{156} = \\frac{10}{39} $$\n样本 B 的标准化杂合度为：\n$$ H_r(B) = 1 - G_r(B) = 1 - \\frac{10}{39} = \\frac{39 - 10}{39} = \\frac{29}{39} $$\n\n最后，我们计算所需的比率 $R = H_r(A) / H_r(B)$。\n$$ R = \\frac{H_r(A)}{H_r(B)} = \\frac{\\frac{340}{483}}{\\frac{29}{39}} = \\frac{340}{483} \\times \\frac{39}{29} $$\n为了简化，我们观察到 $483 = 3 \\times 161$ 且 $39 = 3 \\times 13$。因子 $3$ 可以消掉：\n$$ R = \\frac{340}{3 \\times 161} \\times \\frac{3 \\times 13}{29} = \\frac{340 \\times 13}{161 \\times 29} $$\n我们检查剩余数字的质因数：$340 = 2^2 \\times 5 \\times 17$，$13$ 是质数，$161 = 7 \\times 23$，$29$ 是质数。分子和分母之间没有公因数。我们进行乘法运算：\n$$ R = \\frac{4420}{4669} $$\n这是最终答案，表示为最简分数。", "answer": "$$\\boxed{\\frac{4420}{4669}}$$", "id": "2823073"}, {"introduction": "现代基因组学研究产生海量数据，但这些数据并非完美无瑕，基因分型错误是常见的技术噪音。本高级练习将带你进入数据质量控制的前沿，设计一个利用孟德尔遗传定律的QC流程来估算基因分型错误率 $\\varepsilon$ [@problem_id:2823096]。你将学习如何利用家系（三元组）信息来量化错误，并推导出一个校正公式，从而从观测值中恢复出更接近真实的群体杂合度。", "problem": "一个基因分型平台被用于检测多个个体中 $L$ 个双等位基因的常染色体单核苷酸多态性。您的任务是设计一个质量控制（QC）程序，该程序使用孟德尔三元组来估计对称的等位基因级别基因分型错误率，然后使用该估计值来校正一个队列的观测杂合度。假设以下基本事实和定义为您推导的基础：孟德尔三元组中的分离定律、等位基因和个体间基因分型错误的独立性、可忽略不计的每个位点的新生突变率（约为 $10^{-8}$ 的量级），以及观测杂合度 $H_O$ 是杂合基因型检出结果的比例。\n\n为确保科学真实性，QC程序受如下约束。在一个大的三元组-位点观测数据集中，您只关注那些双亲都具有重复、一致、高质量基因型检出结果且为相反纯合子（一个亲本为 $A/A$，另一个为 $B/B$）的位点。根据孟德尔定律，在这些位点上，子代的真实基因型必须是 $A/B$。设等位基因级别的基因分型错误率为 $\\varepsilon$，定义为一个被检测的等位基因被误读为另一个等位基因的概率，且对于一个基因型的两个等位基因，错误是独立的。\n\n收集到的数据：\n- 在 $N = 120{,}000$ 个双亲为相反纯合子的三元组-位点观测中，您记录到 $K = 900$ 个在上述QC筛选条件下子代观测基因型不为杂合子的实例。\n- 在一个包含 $n = 100$ 个无亲缘关系个体的队列中，使用同一平台对 $L = 700{,}000$ 个位点进行分型，所有个体和位点中杂合基因型检出结果的总数为 $R = 22{,}400{,}000$。\n\n任务：\n1. 在对称的等位基因级别错误模型下，根据第一性原理，写出一个真实的杂合基因型被观测为非杂合基因型的概率，并用此概率构建在 $N$ 个此类三元组-位点观测中观测到 $K$ 个非杂合子代检出结果的二项似然函数。从此似然函数推导出基因分型错误参数 $\\varepsilon$ 的最大似然估计。\n2. 设 $H$ 表示队列水平的真实杂合度（在整个队列和所有位点中，真实杂合基因型的比例）。从错误模型出发，用 $H$ 和 $\\varepsilon$ 表示队列的观测杂合度比例 $h_{\\text{obs}}$，然后通过代数运算求解 $H$，使其表示为 $h_{\\text{obs}}$ 和 $\\varepsilon$ 的函数。\n3. 根据队列计数计算 $h_{\\text{obs}}$，代入任务1中基于三元组得到的 $\\varepsilon$ 估计值，得出考虑了基因分型错误的校正后 $H$ 的估计值。将您最终校正的 $H$ 的估计值四舍五入到四位有效数字。以纯数字形式给出最终答案，不带任何单位。", "solution": "问题陈述已经过严谨验证。所有给定条件均已提取并根据科学依据、良定性和客观性标准进行了评估。该问题被认定为科学有效、自洽且良定的。这是一个统计遗传学中的标准问题，涉及基因分型错误的估计及其在校正群体遗传学指标中的应用。注意到 $H_O$ 和 $h_{\\text{obs}}$ 在符号上的区别，但鉴于上下文已明确其意，此区别可视为不重要。我将使用 $h_{\\text{obs}}$ 表示观测杂合度比例，用 $H$ 表示真实杂合度比例。解题过程如下。\n\n问题分为三个任务。我们将按顺序解决它们。\n\n任务1：推导基因分型错误参数 $\\varepsilon$ 的最大似然估计。\n\n设两个等位基因为 $A$ 和 $B$。根据孟德尔定律，基因型为 $A/A$ 和 $B/B$ 的双亲所生子代的真实基因型必然是杂合的，即 $A/B$。基因分型过程独立地检测子代的两个等位基因。对称的等位基因级别错误率 $\\varepsilon$ 是一个真实等位基因被误读的概率。\n$P(\\text{观测} = B | \\text{真实} = A) = \\varepsilon$\n$P(\\text{观测} = A | \\text{真实} = A) = 1-\\varepsilon$\n$P(\\text{观测} = A | \\text{真实} = B) = \\varepsilon$\n$P(\\text{观测} = B | \\text{真实} = B) = 1-\\varepsilon$\n\n一个真实的杂合基因型 $A/B$ 在观测基因型为 $A/A$ 或 $B/B$ 时，被观测为非杂合基因型。\n当真实的 $A$ 等位基因被读作 $A$ 且真实的 $B$ 等位基因被读作 $A$ 时，观测基因型为 $A/A$。这种情况的概率是 $P(\\text{观测} = A|A) \\times P(\\text{观测} = A|B) = (1-\\varepsilon)\\varepsilon$。\n当真实的 $A$ 等位基因被读作 $B$ 且真实的 $B$ 等位基因被读作 $B$ 时，观测基因型为 $B/B$。这种情况的概率是 $P(\\text{观测} = B|A) \\times P(\\text{观测} = B|B) = \\varepsilon(1-\\varepsilon)$。\n\n由于这些是不相交事件，一个真实的杂合子被观测为非杂合子的总概率 $p_{err}$ 是它们的和：\n$$p_{err} = P(\\text{观测为 } A/A \\text{ 或 } B/B | \\text{真实为 } A/B) = (1-\\varepsilon)\\varepsilon + \\varepsilon(1-\\varepsilon) = 2\\varepsilon(1-\\varepsilon)$$\n问题陈述，在 $N = 120,000$ 个这样的三元组-位点观测（其中子代是真实的杂合子）中，有 $K = 900$ 个被观测为非杂合子。此类错误的数量 $K$ 服从试验次数为 $N$、成功概率为 $p_{err}$ 的二项分布。\n$$K \\sim \\text{Binomial}(N, p_{err})$$\n$\\varepsilon$ 的似然函数是：\n$$L(\\varepsilon; K, N) = \\binom{N}{K} [p_{err}]^K [1-p_{err}]^{N-K} = \\binom{N}{K} [2\\varepsilon(1-\\varepsilon)]^K [1-2\\varepsilon(1-\\varepsilon)]^{N-K}$$\n二项分布概率参数的最大似然估计是样本比例。因此， $p_{err}$ 的最大似然估计，记为 $\\hat{p}_{err}$，是：\n$$\\hat{p}_{err} = \\frac{K}{N}$$\n将此代入我们对 $p_{err}$ 的表达式中，得到一个关于 $\\varepsilon$ 的最大似然估计（记为 $\\hat{\\varepsilon}$）的方程：\n$$\\frac{K}{N} = 2\\hat{\\varepsilon}(1-\\hat{\\varepsilon})$$\n这是一个关于 $\\hat{\\varepsilon}$ 的二次方程：\n$$2\\hat{\\varepsilon}^2 - 2\\hat{\\varepsilon} + \\frac{K}{N} = 0$$\n使用求根公式解 $\\hat{\\varepsilon}$：\n$$\\hat{\\varepsilon} = \\frac{-(-2) \\pm \\sqrt{(-2)^2 - 4(2)(\\frac{K}{N})}}{2(2)} = \\frac{2 \\pm \\sqrt{4 - \\frac{8K}{N}}}{4} = \\frac{1 \\pm \\sqrt{1 - \\frac{2K}{N}}}{2}$$\n基因分型错误率 $\\varepsilon$ 通常很小，即 $\\varepsilon \\ll 0.5$。两个解关于 $0.5$ 对称。我们必须选择较小的根，这对应于低错误率的物理现实情景。\n$$\\hat{\\varepsilon} = \\frac{1 - \\sqrt{1 - \\frac{2K}{N}}}{2}$$\n至此完成第一个任务。\n\n任务2：用观测杂合度 $h_{\\text{obs}}$ 和 $\\varepsilon$ 表示真实杂合度 $H$。\n\n设 $H$ 为一个队列中真实杂合基因型的比例， $1-H$ 为真实纯合基因型的比例。观测杂合度 $h_{\\text{obs}}$ 是所有被观测为杂合基因型的基因型所占的比例。一个观测到的杂合子可能是一个被正确识别的真实杂合子，也可能是一个被错误识别的真实纯合子。\n我们使用全概率公式：\n$$h_{\\text{obs}} = P(\\text{观测为杂合子}) = P(\\text{观测为杂合子} | \\text{真实为杂合子})P(\\text{真实为杂合子}) + P(\\text{观测为杂合子} | \\text{真实为纯合子})P(\\text{真实为纯合子})$$\n我们有 $P(\\text{真实为杂合子}) = H$ 和 $P(\\text{真实为纯合子}) = 1-H$。我们需要以下条件概率：\n1.  $P(\\text{观测为杂合子} | \\text{真实为杂合子})$：这个概率是 $1 - p_{err} = 1 - 2\\varepsilon(1-\\varepsilon)$。\n2.  $P(\\text{观测为杂合子} | \\text{真实为纯合子})$：设真实基因型为纯合子，例如 $A/A$。如果它的一个等位基因被正确读为 $A$ 而另一个被错误读为 $B$，那么它就会被观测为杂合子 ($A/B$)。根据哪个等位基因拷贝被误读，这有两种可能的方式：$(A \\to A, A \\to B)$ 或 $(A \\to B, A \\to A)$。每种情况的概率是 $(1-\\varepsilon)\\varepsilon$。因此， $P(\\text{观测为杂合子} | \\text{真实为纯合子}) = (1-\\varepsilon)\\varepsilon + \\varepsilon(1-\\varepsilon) = 2\\varepsilon(1-\\varepsilon)$。\n\n将这些代入 $h_{\\text{obs}}$ 的方程中：\n$$h_{\\text{obs}} = \\left[1 - 2\\varepsilon(1-\\varepsilon)\\right]H + \\left[2\\varepsilon(1-\\varepsilon)\\right](1-H)$$\n我们现在求解 $H$。\n$$h_{\\text{obs}} = H - 2\\varepsilon(1-\\varepsilon)H + 2\\varepsilon(1-\\varepsilon) - 2\\varepsilon(1-\\varepsilon)H$$\n$$h_{\\text{obs}} = H \\left[1 - 4\\varepsilon(1-\\varepsilon)\\right] + 2\\varepsilon(1-\\varepsilon)$$\n$$h_{\\text{obs}} - 2\\varepsilon(1-\\varepsilon) = H \\left[1 - 4\\varepsilon + 4\\varepsilon^2\\right]$$\n$$h_{\\text{obs}} - 2\\varepsilon(1-\\varepsilon) = H (1-2\\varepsilon)^2$$\n$$H = \\frac{h_{\\text{obs}} - 2\\varepsilon(1-\\varepsilon)}{(1-2\\varepsilon)^2}$$\n这个表达式给出了真实杂合度 $H$ 作为观测杂合度 $h_{\\text{obs}}$ 和错误率 $\\varepsilon$ 的函数。至此完成第二个任务。\n\n任务3：计算校正后的 $H$ 的估计值。\n\n我们结合前两个任务的结果。我们可以将从任务1推导出的最大似然估计关系式代入 $H$ 的方程。\n从任务1可知，我们有 $2\\hat{\\varepsilon}(1-\\hat{\\varepsilon}) = K/N$。\n同样从任务1可知，$(1-2\\hat{\\varepsilon}) = \\sqrt{1-2K/N}$，这意味着 $(1-2\\hat{\\varepsilon})^2 = 1 - 2K/N$。\n将这些代入 $H$ 的方程中，可以得到一个关于 $H$ 的校正估计值（我们记为 $\\hat{H}$）的非常简洁的表达式：\n$$\\hat{H} = \\frac{h_{\\text{obs}} - K/N}{1 - 2K/N}$$\n现在，我们根据所提供的数据计算数值。\n队列中的观测杂合度是：\n$$h_{\\text{obs}} = \\frac{R}{n \\times L} = \\frac{22,400,000}{100 \\times 700,000} = \\frac{22,400,000}{70,000,000} = \\frac{224}{700} = 0.32$$\n一个真实的杂合子被错误检出为纯合子的估计概率是：\n$$\\frac{K}{N} = \\frac{900}{120,000} = \\frac{9}{1200} = \\frac{3}{400} = 0.0075$$\n现在我们将这些值代入 $\\hat{H}$ 的表达式中：\n$$\\hat{H} = \\frac{0.32 - 0.0075}{1 - 2(0.0075)} = \\frac{0.3125}{1 - 0.015} = \\frac{0.3125}{0.985}$$\n$$\\hat{H} \\approx 0.3172588832...$$\n问题要求将最终答案四舍五入到四位有效数字。\n$$\\hat{H} \\approx 0.3173$$\n这就是校正后的群体水平真实杂合度的估计值。", "answer": "$$ \\boxed{0.3173} $$", "id": "2823096"}]}