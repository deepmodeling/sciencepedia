{"hands_on_practices": [{"introduction": "虽然二倍体遗传学提供了基本框架，但许多生物，特别是植物，是多倍体。本练习将挑战您通过将减数分裂和分离的基本原则应用于具有多个等位基因的同源四倍体系统来扩展您的理解。通过推导预期的表型比例，您将看到共显性和显性相互作用如何在更复杂的染色体背景下发挥作用 [@problem_id:2831941]。", "problem": "一种同源四倍体植物物种，其单个基因座上有一个由$A_{1}$、$A_{2}$和$a_{0}$这$3$个等位基因组成的复等位基因系列。等位基因$A_{1}$和$A_{2}$互为共显性，且各自对$a_{0}$为完全显性。表现型仅由基因型中是否存在$A_{1}$和$A_{2}$决定：任何含有至少一个$A_{1}$副本但不含$A_{2}$副本的基因型表现为$P_{1}$型；任何含有至少一个$A_{2}$副本但不含$A_{1}$副本的基因型表现为$P_{2}$型；任何同时含有至少一个$A_{1}$副本和一个$A_{2}$副本的基因型表现为共显性的$P_{12}$型；只有完全由$a_{0}$组成的基因型才表现为$P_{0}$型。用于自交的亲本植株为同源四倍体，其在该基因座上的基因型为$A_{1}A_{2}a_{0}a_{0}$。\n\n假设为四体遗传，在减数分裂时进行随机二价体配对，且无双重减数。配子为二倍体（$2x$），由从两个二价体中各接收一个等位基因形成。\n\n仅使用推广到四体配对的分离基本定律（每个二价体随机贡献其两个等位基因中的一个）以及上述共显性/显性规则，从第一性原理推导该$A_{1}A_{2}a_{0}a_{0}$植株自交后代的预期表现型比例。请将最终答案以行向量的形式给出，比例顺序为$(P_{12}, P_{1}, P_{2}, P_{0})$。所有条目均以精确分数表示，不要四舍五入。", "solution": "我们从应用于四体遗传、随机二价体配对且无双重减数的标准孟德尔分离定律开始。在同源四倍体中，一个基因座上的四条同源染色体在减数第一次分裂时配对形成两个二价体。在随机二价体配对的情况下，四条同源染色体被均匀地分配成两个无序的对；在每个二价体内，两个等位基因中的一个随机传递给一个二倍体配子。无双重减数意味着每个配子从每个二价体中恰好接收一个等位基因，绝不会从同一染色单体臂接收两个姐妹产物。\n\n将亲本基因型$A_{1}A_{2}a_{0}a_{0}$中的四条同源染色体标记为：携带$A_{1}$的$c_{1}$，携带$A_{2}$的$c_{2}$，以及分别携带$a_{0}$的$c_{3}$和$c_{4}$。可能的二价体配对方式是集合$\\{c_{1},c_{2},c_{3},c_{4}\\}$的$3$种完全匹配：\n$$(c_{1}\\text{-}c_{2},\\, c_{3}\\text{-}c_{4}),\\quad (c_{1}\\text{-}c_{3},\\, c_{2}\\text{-}c_{4}),\\quad (c_{1}\\text{-}c_{4},\\, c_{2}\\text{-}c_{3}),$$\n每种配对方式发生的概率为$1/3$。在任何给定的配对中，每个二价体以$1/2$的概率贡献其两个等位基因中的一个。\n\n通过对所有配对方式进行平均，计算二倍体配子基因型的分布：\n\n1. 对于配对 $(c_{1}\\text{-}c_{2},\\, c_{3}\\text{-}c_{4})$ （概率为$1/3$）：第一个二价体以各$1/2$的概率贡献$A_{1}$或$A_{2}$；第二个二价体总是贡献$a_{0}$。因此，在此配对条件下，配子为$A_{1}a_{0}$的概率为$1/2$，为$A_{2}a_{0}$的概率为$1/2$。\n\n2. 对于配对 $(c_{1}\\text{-}c_{3},\\, c_{2}\\text{-}c_{4})$ （概率为$1/3$）：第一个二价体以各$1/2$的概率贡献$A_{1}$或$a_{0}$；第二个二价体以各$1/2$的概率贡献$A_{2}$或$a_{0}$。因此，在此配对条件下，配子是$A_{1}A_{2}$、$A_{1}a_{0}$、$A_{2}a_{0}$或$a_{0}a_{0}$中的一种，每种的概率为$1/4$。\n\n3. 对于配对 $(c_{1}\\text{-}c_{4},\\, c_{2}\\text{-}c_{3})$ （概率为$1/3$）：与情况2的推理相同，条件配子分布同样是在$A_{1}A_{2}$、$A_{1}a_{0}$、$A_{2}a_{0}$和$a_{0}a_{0}$上均匀分布，每种概率为$1/4$。\n\n对这3种配对方式进行平均，得到总的二倍体配子分布：\n- $\\Pr(A_{1}A_{2}) = \\left(\\frac{2}{3}\\right)\\left(\\frac{1}{4}\\right) = \\frac{1}{6}$,\n- $\\Pr(A_{1}a_{0}) = \\left(\\frac{1}{3}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{2}{3}\\right)\\left(\\frac{1}{4}\\right) = \\frac{1}{6} + \\frac{1}{6} = \\frac{1}{3}$,\n- $\\Pr(A_{2}a_{0}) = \\frac{1}{3}$，由对称性可得，\n- $\\Pr(a_{0}a_{0}) = \\left(\\frac{2}{3}\\right)\\left(\\frac{1}{4}\\right) = \\frac{1}{6}$.\n\n将这四种二倍体配子类型及其概率表示为\n$$G_{12}: A_{1}A_{2}\\ \\text{with}\\ p_{12}=\\frac{1}{6},\\quad G_{1}: A_{1}a_{0}\\ \\text{with}\\ p_{1}=\\frac{1}{3},\\quad G_{2}: A_{2}a_{0}\\ \\text{with}\\ p_{2}=\\frac{1}{3},\\quad G_{0}: a_{0}a_{0}\\ \\text{with}\\ p_{0}=\\frac{1}{6}.$$\n\n自交过程是两个独立的二倍体配子结合形成一个四倍体合子。其表现型仅取决于合子是否含有至少一个$A_{1}$和/或至少一个$A_{2}$：\n- 表现型$P_{0}$（不含$A_{1}$或$A_{2}$）出现当且仅当两个配子均为$G_{0}$：$\\Pr(P_{0}) = p_{0}^{2} = \\left(\\frac{1}{6}\\right)^{2} = \\frac{1}{36}$。\n- 表现型$P_{1}$（至少含一个$A_{1}$，不含$A_{2}$）出现于两个配子都不含$A_{2}$且至少一个含有$A_{1}$时，即配子对为$(G_{1},G_{1})$或$(G_{1},G_{0})$（任意顺序）：$\\Pr(P_{1}) = p_{1}^{2} + 2p_{1}p_{0} = \\left(\\frac{1}{3}\\right)^{2} + 2\\left(\\frac{1}{3}\\right)\\left(\\frac{1}{6}\\right) = \\frac{1}{9} + \\frac{1}{9} = \\frac{2}{9}$。\n- 表现型$P_{2}$的情况是对称的：$\\Pr(P_{2}) = p_{2}^{2} + 2p_{2}p_{0} = \\frac{2}{9}$。\n- 表现型$P_{12}$（至少含一个$A_{1}$和至少一个$A_{2}$）是前三种情况的补集：$\\Pr(P_{12}) = 1 - \\Pr(P_{0}) - \\Pr(P_{1}) - \\Pr(P_{2}) = 1 - \\frac{1}{36} - \\frac{2}{9} - \\frac{2}{9} = 1 - \\frac{1}{36} - \\frac{16}{36} = \\frac{19}{36}$。\n\n因此，自交后代的预期表现型比例，按$(P_{12}, P_{1}, P_{2}, P_{0})$顺序排列，为\n$$\\left(\\frac{19}{36},\\ \\frac{2}{9},\\ \\frac{2}{9},\\ \\frac{1}{36}\\right).$$\n这些是精确值，无需四舍五入。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{19}{36} & \\frac{2}{9} & \\frac{2}{9} & \\frac{1}{36}\\end{pmatrix}}$$", "id": "2831941"}, {"introduction": "在现实世界中，观察到的后代比例常常偏离简单的孟德尔预测，这通常是由于基因型之间的生存能力差异所致。本实践从理论预测转向实证分析，介绍了强大的最大似然估计（Maximum Likelihood Estimation, MLE）方法来量化选择。您将学习如何从实验杂交数据中估计基因型的相对生存能力（$v_{LL}$ 和 $v_{L+}$），这是任何数量遗传学家的一项核心技能 [@problem_id:2831940]。", "problem": "某一单基因座上存在一个等位基因系列，包括等位基因 $A^L$ 和野生型等位基因 $A$。研究人员进行了多次 $A^L/A$ 与 $A^L/A$ 的独立交配，并在受精后的某一确定阶段对子代进行了基因分型。假设以下基本前提：\n- 在无分离畸变的孟德尔分离定律下，$A^L/A \\times A^L/A$ 交配产生的合子基因型频率为：$A^L/A^L$ 为 $1/4$，$A^L/A$ 为 $1/2$，$A/A$ 为 $1/4$。\n- 生存力选择作用于受精之后、基因分型之前。设特定基因型的相对生存力为：$A^L/A^L$ 为 $v_{LL}$，$A^L/A$ 为 $v_{L+}$，且根据尺度的定义，$A/A$ 的生存力 $v_{++} = 1$。\n- 以存活至基因分型为条件，观测到的基因型计数服从多项分布，其各类别概率等于经特定基因型生存力加权并归一化（使其总和为1）后的孟德尔式合子比例。\n\n存活并被基因分型的子代的观测计数为：$A^L/A^L$ 为 $n_{LL} = 18$，$A^L/A$ 为 $n_{L+} = 220$，$A/A$ 为 $n_{++} = 262$。\n\n请使用基于上述假设的最大似然法，推导 $v_{LL}$ 和 $v_{L+}$ 的似然函数，并在 $v_{++}$ 固定为 1 的情况下，求出 $v_{LL}$ 和 $v_{L+}$ 的最大似然估计值。请将 $\\left(v_{LL}, v_{L+}\\right)$ 的最终估计值以小数形式表示，并四舍五入到三位有效数字。以 $\\left(v_{LL}, v_{L+}\\right)$ 的顺序，将最终答案表示为包含两个条目的一行。", "solution": "该问题要求从观测到的子代计数中推导特定基因型生存力的最大似然估计 (MLEs)。所陈述的问题具有科学依据、提法恰当且客观。它提供了一个清晰的遗传模型、数值数据和一个明确的统计目标。因此，该问题是有效的，我们可以继续进行解答。\n\n该问题源于一个二倍体生物中的标准二等位基因座，其等位基因表示为 $A^L$ 和野生型 $A$。交配方式为杂合子自交，$A^L/A \\times A^L/A$。假设为无分离畸变的孟德尔遗传，期望的合子基因型频率为：\n$$\nP(A^L/A^L) = \\frac{1}{4}\n$$\n$$\nP(A^L/A) = \\frac{1}{2}\n$$\n$$\nP(A/A) = \\frac{1}{4}\n$$\n\n生存力选择在基因型被计数之前作用于这些合子。相对生存力给定为：$A^L/A^L$ 基因型为 $v_{LL}$，$A^L/A$ 基因型为 $v_{L+}$，野生型 $A/A$ 基因型为 $v_{++}$。根据相对尺度的定义，野生型的生存力被设为 1，因此 $v_{++} = 1$。\n\n期望存活到观测时间的基因型比例，与其合子频率和各自生存力的乘积成正比。设 $p_{LL}$、$p_{L+}$ 和 $p_{++}$ 分别是观测到基因型为 $A^L/A^L$、$A^L/A$ 和 $A/A$ 的存活个体的概率。这些概率的总和必须为 1。首先，我们求出未归一化的比例：\n$$\n\\text{Proportion}(A^L/A^L) \\propto \\frac{1}{4} v_{LL}\n$$\n$$\n\\text{Proportion}(A^L/A) \\propto \\frac{1}{2} v_{L+}\n$$\n$$\n\\text{Proportion}(A/A) \\propto \\frac{1}{4} v_{++} = \\frac{1}{4}\n$$\n归一化常数，即群体平均生存力 $\\bar{v}$，是这些量的总和：\n$$\n\\bar{v} = \\frac{1}{4} v_{LL} + \\frac{1}{2} v_{L+} + \\frac{1}{4}\n$$\n因此，归一化后的概率为：\n$$\np_{LL} = \\frac{\\frac{1}{4} v_{LL}}{\\bar{v}} = \\frac{v_{LL}}{v_{LL} + 2v_{L+} + 1}\n$$\n$$\np_{L+} = \\frac{\\frac{1}{2} v_{L+}}{\\bar{v}} = \\frac{2v_{L+}}{v_{LL} + 2v_{L+} + 1}\n$$\n$$\np_{++} = \\frac{\\frac{1}{4}}{\\bar{v}} = \\frac{1}{v_{LL} + 2v_{L+} + 1}\n$$\n\n观测到的基因型计数为 $n_{LL} = 18$、$n_{L+} = 220$ 和 $n_{++} = 262$。观测到的子代总数为 $N = n_{LL} + n_{L+} + n_{++} = 18 + 220 + 262 = 500$。在给定参数 $v_{LL}$ 和 $v_{L+}$ 的条件下，观测到这些计数的似然函数服从多项分布：\n$$\nL(v_{LL}, v_{L+} | n_{LL}, n_{L+}, n_{++}) = \\frac{N!}{n_{LL}! n_{L+}! n_{++}!} p_{LL}^{n_{LL}} p_{L+}^{n_{L+}} p_{++}^{n_{++}}\n$$\n为了求得最大似然估计，我们可以最大化对数似然函数 $\\mathcal{L} = \\ln(L)$。组合项相对于参数是一个常数，在最大化过程中可以忽略。设 $D = v_{LL} + 2v_{L+} + 1$。\n$$\n\\mathcal{L}(v_{LL}, v_{L+}) \\propto n_{LL} \\ln(p_{LL}) + n_{L+} \\ln(p_{L+}) + n_{++} \\ln(p_{++})\n$$\n$$\n\\mathcal{L} \\propto n_{LL} \\ln\\left(\\frac{v_{LL}}{D}\\right) + n_{L+} \\ln\\left(\\frac{2v_{L+}}{D}\\right) + n_{++} \\ln\\left(\\frac{1}{D}\\right)\n$$\n$$\n\\mathcal{L} \\propto n_{LL} \\ln(v_{LL}) + n_{L+} \\ln(2) + n_{L+} \\ln(v_{L+}) - (n_{LL} + n_{L+} + n_{++}) \\ln(D)\n$$\n舍去常数项 $n_{L+} \\ln(2)$，需要最大化的函数是：\n$$\n\\mathcal{L}(v_{LL}, v_{L+}) = n_{LL} \\ln(v_{LL}) + n_{L+} \\ln(v_{L+}) - N \\ln(v_{LL} + 2v_{L+} + 1)\n$$\n为求最大值，我们对 $v_{LL}$ 和 $v_{L+}$ 分别求偏导数，并令其为零。\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial v_{LL}} = \\frac{n_{LL}}{v_{LL}} - \\frac{N}{v_{LL} + 2v_{L+} + 1} = 0\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial v_{L+}} = \\frac{n_{L+}}{v_{L+}} - \\frac{2N}{v_{LL} + 2v_{L+} + 1} = 0\n$$\n令 $\\hat{v}_{LL}$ 和 $\\hat{v}_{L+}$ 表示最大似然估计值。方程组变为：\n$$\n\\frac{n_{LL}}{\\hat{v}_{LL}} = \\frac{N}{\\hat{v}_{LL} + 2\\hat{v}_{L+} + 1}\n$$\n$$\n\\frac{n_{L+}}{\\hat{v}_{L+}} = \\frac{2N}{\\hat{v}_{LL} + 2\\hat{v}_{L+} + 1}\n$$\n我们可以解这个方程组。由第一个方程，我们得到 $\\hat{v}_{LL} + 2\\hat{v}_{L+} + 1 = \\frac{N \\hat{v}_{LL}}{n_{LL}}$。\n将此代入第二个方程：\n$$\n\\frac{n_{L+}}{\\hat{v}_{L+}} = \\frac{2N}{\\frac{N \\hat{v}_{LL}}{n_{LL}}} = \\frac{2n_{LL}}{\\hat{v}_{LL}}\n$$\n这给出了估计值之间的直接关系：\n$$\nn_{L+} \\hat{v}_{LL} = 2 n_{LL} \\hat{v}_{L+} \\implies \\hat{v}_{LL} = \\frac{2 n_{LL}}{n_{L+}} \\hat{v}_{L+}\n$$\n现在，考虑两种基因型期望计数的比率。$A^L/A^L$ 与 $A/A$ 存活者的期望比率为 $\\frac{E[n_{LL}]}{E[n_{++}]} = \\frac{p_{LL}}{p_{++}} = v_{LL}$。类似地，$A^L/A$ 与 $A/A$ 存活者的比率为 $\\frac{E[n_{L+}]}{E[n_{++}]} = \\frac{p_{L+}}{p_{++}} = 2v_{L+}$。\n一个简单直观且与最大似然估计(MLE)等价的估计量，可以通过用观测比率替换期望比率来构建：\n$$\n\\hat{v}_{LL} = \\frac{n_{LL}}{n_{++}}\n$$\n$$\n2\\hat{v}_{L+} = \\frac{n_{L+}}{n_{++}} \\implies \\hat{v}_{L+} = \\frac{n_{L+}}{2n_{++}}\n$$\n我们可以通过将这些表达式代回导数方程来进行验证。例如，对于第一个导数：\n$$\n\\frac{n_{LL}}{\\hat{v}_{LL}} = \\frac{n_{LL}}{n_{LL}/n_{++}} = n_{++}\n$$\n$$\n\\frac{N}{\\hat{v}_{LL} + 2\\hat{v}_{L+} + 1} = \\frac{N}{\\frac{n_{LL}}{n_{++}} + 2\\frac{n_{L+}}{2n_{++}} + 1} = \\frac{N}{\\frac{n_{LL} + n_{L+} + n_{++}}{n_{++}}} = \\frac{N}{N/n_{++}} = n_{++}\n$$\n由于 $n_{++} = n_{++}$，该方程成立。同样的验证对第二个导数也成立。因此，这些确实是正确的最大似然估计值(MLEs)。\n\n现在我们代入给定的数值：$n_{LL}=18$，$n_{L+}=220$ 和 $n_{++}=262$。\n$$\n\\hat{v}_{LL} = \\frac{n_{LL}}{n_{++}} = \\frac{18}{262} \\approx 0.06870229...\n$$\n$$\n\\hat{v}_{L+} = \\frac{n_{L+}}{2n_{++}} = \\frac{220}{2 \\times 262} = \\frac{220}{524} \\approx 0.41984732...\n$$\n按要求四舍五入至三位有效数字：\n$$\n\\hat{v}_{LL} \\approx 0.0687\n$$\n$$\n\\hat{v}_{L+} \\approx 0.420\n$$\n相对生存力的最终估计值为 $(v_{LL}, v_{L+}) \\approx (0.0687, 0.420)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.0687 & 0.420 \\end{pmatrix}}\n$$", "id": "2831940"}, {"introduction": "要理解多个等位基因的长期演化命运，我们必须将焦点从单个家系转移到整个种群。本实践将引导您构建一个受生存能力选择作用的三等位基因座的群体遗传学模型。通过推导等位基因频率的递推关系并求解平衡状态，您将深刻理解选择如何能够在种群中维持遗传多样性 [@problem_id:2831943]。", "problem": "考虑一个有效种群大小为无限的随机交配、世代不重叠的二倍体种群，其单个基因座上有 $3$ 个等位基因 $A_{1}$、$A_{2}$ 和 $A_{3}$。设合子阶段（在生存力选择之前）的等位基因频率分别为 $p_{1}$、$p_{2}$ 和 $p_{3}$，且 $p_{1}+p_{2}+p_{3}=1$。假设合子按哈代-温伯格平衡（HWE）比例形成。生存力选择作用于基因型，使得基因型 $(A_{i},A_{j})$ 的适合度为 $w_{ij}$，其中对于所有 $i,j \\in \\{1,2,3\\}$ 均有 $w_{ij}=w_{ji}$。不存在突变、迁移或遗传漂变。成年个体通过配子随机结合进行繁殖，形成下一代的合子。\n\n仅从哈代-温伯格比例、生存力选择和平均适合度归一化的定义出发，完成以下任务：\n\n1) 推导三等位基因座在生存力选择下的等位基因频率递归方程，将 $p_{i}^{\\prime}$（选择后、繁殖前成年群体中等位基因 $A_{i}$ 的频率）表示为 $\\{p_{1},p_{2},p_{3}\\}$ 和 $\\{w_{ij}\\}$ 的函数。\n\n2) 从第一性原理出发，求出内部多态性（即对所有 $i$ 都有 $p_{i}^{*} \\in (0,1)$ 的平衡）的平衡条件，并用线性代数符号，以 $3 \\times 3$ 对称矩阵 $W=(w_{ij})$ 的形式，给出内部平衡等位基因频率向量的封闭解形式。\n\n3) 现在考虑具体的生存力矩阵\n$$\nW \\;=\\; \\begin{pmatrix}\n0.8 & 1.0 & 1.1\\\\\n1.0 & 0.85 & 1.05\\\\\n1.1 & 1.05 & 0.9\n\\end{pmatrix}.\n$$\n使用第 $2$ 部分得到的一般结果，计算该矩阵下等位基因 $A_{1}$ 的平衡频率 $p_{1}^{*}$。将你的答案四舍五入到 $4$ 位有效数字。最终答案以无单位的纯数表示。", "solution": "所给问题是理论群体遗传学中一个标准的、定义明确的练习。它具有科学依据，内容自洽，且所提供的数据均一致。因此，我们可以着手求解。\n\n问题分三部分解决：首先，推导等位基因频率的递归方程；其次，确定内部平衡条件及其通解；最后，根据给定的适合度矩阵计算一个具体的平衡频率。\n\n首先，我们来推导等位基因 $A_{i}$ 的频率递归方程。\n前提是：一个有效种群大小为无限的随机交配二倍体种群。合子按哈代-温伯格平衡（HWE）比例形成。在合子阶段，等位基因 $A_{1}$、$A_{2}$ 和 $A_{3}$ 的频率分别为 $p_{1}$、$p_{2}$ 和 $p_{3}$，且 $\\sum_{i=1}^{3} p_{i}=1$。\n在HWE下，合子阶段六种可能基因型的频率为：\n- 纯合子：$P(A_{i}A_{i}) = p_{i}^{2}$，其中 $i \\in \\{1,2,3\\}$\n- 杂合子：$P(A_{i}A_{j}) = 2p_{i}p_{j}$，其中 $i \\neq j$，$i,j \\in \\{1,2,3\\}$\n\n生存力选择作用于这些合子。基因型 $(A_{i},A_{j})$ 的适合度由 $w_{ij}$ 给出，其中 $W=(w_{ij})$ 是一个 $3 \\times 3$ 的对称矩阵。选择之后，每种基因型的相对比例是其初始频率乘以其适合度。为了得到成年个体中基因型的实际频率，我们必须用种群的平均适合度 $\\bar{w}$ 进行归一化。平均适合度是每种基因型的适合度按其HWE频率加权的总和：\n$$\n\\bar{w} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} P(A_{i}A_{j}) w_{ij} = p_{1}^{2}w_{11} + p_{2}^{2}w_{22} + p_{3}^{2}w_{33} + 2p_{1}p_{2}w_{12} + 2p_{1}p_{3}w_{13} + 2p_{2}p_{3}w_{23}\n$$\n存活下来的成年个体中各基因型的频率为：\n$$\nP'_{ii} = \\frac{p_{i}^{2} w_{ii}}{\\bar{w}} \\quad \\text{和} \\quad P'_{ij} = \\frac{2p_{i}p_{j} w_{ij}}{\\bar{w}} \\quad \\text{对于 } i \\neq j\n$$\n下一代中等位基因的频率 $p'_{i}$ 是这些成年个体产生的配子池中该等位基因的频率。等位基因 $A_{i}$ 的频率是 $A_{i}A_{i}$ 纯合子频率加上所有包含 $A_{i}$ 的杂合子频率之和的一半。以 $i=1$ 为例：\n$$\np'_{1} = P'_{11} + \\frac{1}{2}P'_{12} + \\frac{1}{2}P'_{13} = \\frac{p_{1}^{2}w_{11}}{\\bar{w}} + \\frac{p_{1}p_{2}w_{12}}{\\bar{w}} + \\frac{p_{1}p_{3}w_{13}}{\\bar{w}}\n$$\n提出因子 $p_{1}$：\n$$\np'_{1} = \\frac{p_{1}(p_{1}w_{11} + p_{2}w_{12} + p_{3}w_{13})}{\\bar{w}}\n$$\n我们定义等位基因 $A_{i}$ 的边际适合度为 $w_{i} = \\sum_{j=1}^{3} p_{j}w_{ij}$。使用这个定义， $p'_{1}$ 的表达式简化为：\n$$\np'_{1} = p_{1} \\frac{w_{1}}{\\bar{w}}\n$$\n对任意等位基因 $A_{i}$ 进行推广，递归方程为：\n$$\np'_{i} = p_{i} \\frac{w_{i}}{\\bar{w}} = p_{i} \\frac{\\sum_{j=1}^{3} p_{j}w_{ij}}{\\sum_{k=1}^{3}\\sum_{l=1}^{3} p_{k}p_{l}w_{kl}}\n$$\n这就完成了问题的第一部分。\n\n其次，我们必须找到内部多态性平衡的条件。\n平衡是一种等位基因频率从一代到下一代保持不变的状态，即对所有 $i$ 都有 $p'_{i} = p^{*}_{i}$ 。设 $p^{*}_{i}$ 表示等位基因 $A_{i}$ 的平衡频率。该条件变为：\n$$\np^{*}_{i} = p^{*}_{i} \\frac{w^{*}_{i}}{\\bar{w}^{*}}\n$$\n其中 $w^{*}_{i}$ 和 $\\bar{w}^{*}$ 是在平衡频率 $\\{p^{*}_{j}\\}$ 下计算出的边际适合度和平均适合度。对于内部多态性，我们需要对所有 $i$ 都有 $p^{*}_{i} \\in (0,1)$ 。这使我们可以除以不为零的 $p^{*}_{i}$，得到：\n$$\n1 = \\frac{w^{*}_{i}}{\\bar{w}^{*}} \\implies w^{*}_{i} = \\bar{w}^{*} \\quad \\text{对于所有 } i \\in \\{1,2,3\\}\n$$\n这是一个完全多态性平衡的基本条件：种群中存在的所有等位基因的边际适合度必须相等。这给了我们一个方程组：$w^{*}_{1}=w^{*}_{2}=w^{*}_{3}$。我们用 $\\lambda$ 表示这个共同的值。\n$$\n\\begin{cases}\np^{*}_{1}w_{11} + p^{*}_{2}w_{12} + p^{*}_{3}w_{13} = \\lambda \\\\\np^{*}_{1}w_{21} + p^{*}_{2}w_{22} + p^{*}_{3}w_{23} = \\lambda \\\\\np^{*}_{1}w_{31} + p^{*}_{2}w_{32} + p^{*}_{3}w_{33} = \\lambda\n\\end{cases}\n$$\n在线性代数表示法中，如果 $\\mathbf{p}^{*} = (p^{*}_{1}, p^{*}_{2}, p^{*}_{3})^{T}$ 且 $\\mathbf{1} = (1,1,1)^{T}$，这个方程组可以写成 $W\\mathbf{p}^{*} = \\lambda \\mathbf{1}$。\n如果适合度矩阵 $W$ 是可逆的，我们可以解出 $\\mathbf{p}^{*}$：\n$$\n\\mathbf{p}^{*} = W^{-1}(\\lambda \\mathbf{1}) = \\lambda W^{-1}\\mathbf{1}\n$$\n为了求解标量 $\\lambda$，我们使用等位基因频率之和必须为1的约束条件： $\\sum_{i=1}^{3} p^{*}_{i} = 1$ 。用向量表示法，即为 $\\mathbf{1}^{T}\\mathbf{p}^{*} = 1$。代入 $\\mathbf{p}^{*}$ 的表达式：\n$$\n\\mathbf{1}^{T}(\\lambda W^{-1}\\mathbf{1}) = 1 \\implies \\lambda (\\mathbf{1}^{T}W^{-1}\\mathbf{1}) = 1\n$$\n求解 $\\lambda$：\n$$\n\\lambda = \\frac{1}{\\mathbf{1}^{T}W^{-1}\\mathbf{1}}\n$$\n将此结果代回 $\\mathbf{p}^{*}$ 的方程，得到内部平衡频率向量的封闭解：\n$$\n\\mathbf{p}^{*} = \\frac{W^{-1}\\mathbf{1}}{\\mathbf{1}^{T}W^{-1}\\mathbf{1}}\n$$\n项 $\\mathbf{1}^{T}W^{-1}\\mathbf{1}$ 是逆适合度矩阵 $W^{-1}$ 所有元素的总和，而向量 $W^{-1}\\mathbf{1}$ 是 $W^{-1}$ 的行和向量。因此，等位基因 $A_{i}$ 的平衡频率是 $W^{-1}$ 第 $i$ 行元素之和除以 $W^{-1}$ 所有元素之和。\n\n第三，我们计算特定生存力矩阵的平衡频率 $p^{*}_{1}$：\n$$\nW = \\begin{pmatrix} 0.8 & 1.0 & 1.1 \\\\ 1.0 & 0.85 & 1.05 \\\\ 1.1 & 1.05 & 0.9 \\end{pmatrix}\n$$\n为了使用我们的公式，我们必须计算 $W^{-1}$。一个 $3 \\times 3$ 矩阵的逆矩阵由 $W^{-1} = \\frac{1}{\\det(W)}\\text{adj}(W)$ 给出，其中 $\\text{adj}(W)$ 是伴随矩阵（代数余子式矩阵的转置）。\n$W$ 的行列式为：\n$$\n\\det(W) = 0.8(0.85 \\cdot 0.9 - 1.05 \\cdot 1.05) - 1.0(1.0 \\cdot 0.9 - 1.05 \\cdot 1.1) + 1.1(1.0 \\cdot 1.05 - 0.85 \\cdot 1.1)\n$$\n$$\n\\det(W) = 0.8(0.765 - 1.1025) - 1.0(0.9 - 1.155) + 1.1(1.05 - 0.935)\n$$\n$$\n\\det(W) = 0.8(-0.3375) - 1.0(-0.255) + 1.1(0.115) = -0.27 + 0.255 + 0.1265 = 0.1115\n$$\n$W$ 的代数余子式矩阵 $C$ 的元素为 $C_{ij} = (-1)^{i+j}M_{ij}$，其中 $M_{ij}$ 是余子式。\n$$\nC_{11} = +(0.85 \\cdot 0.9 - 1.05 \\cdot 1.05) = -0.3375\n$$\n$$\nC_{12} = -(1.0 \\cdot 0.9 - 1.05 \\cdot 1.1) = 0.255\n$$\n$$\nC_{13} = +(1.0 \\cdot 1.05 - 0.85 \\cdot 1.1) = 0.115\n$$\n由于 $W$ 是对称的，其代数余子式矩阵 $C$ 和伴随矩阵 $\\text{adj}(W)=C^{T}$ 也是对称的。我们需要所有代数余子式来求所有元素的总和。\n$$\nC_{22} = +(0.8 \\cdot 0.9 - 1.1 \\cdot 1.1) = -0.49\n$$\n$$\nC_{23} = -(0.8 \\cdot 1.05 - 1.0 \\cdot 1.1) = 0.26\n$$\n$$\nC_{33} = +(0.8 \\cdot 0.85 - 1.0 \\cdot 1.0) = -0.32\n$$\n完整的代数余子式矩阵是：\n$$\nC = \\begin{pmatrix} -0.3375 & 0.255 & 0.115 \\\\ 0.255 & -0.49 & 0.26 \\\\ 0.115 & 0.26 & -0.32 \\end{pmatrix}\n$$\n计算 $p^{*}_{1}$ 的分子是 $C$（或 $\\text{adj}(W)$）第一行元素的总和：\n$$\n\\text{Row}_{1} \\text{ sum} = -0.3375 + 0.255 + 0.115 = 0.0325\n$$\n分母是 $C$ 中所有元素的总和：\n$$\n\\text{Sum}(C) = (-0.3375 + 0.255 + 0.115) + (0.255 - 0.49 + 0.26) + (0.115 + 0.26 - 0.32)\n$$\n$$\n\\text{Sum}(C) = (0.0325) + (0.025) + (0.055) = 0.1125\n$$\n平衡频率 $p^{*}_{1}$ 是第一行元素之和与所有代数余子式总和的比率（因子 $1/\\det(W)$ 在分子和分母中被消去）：\n$$\np^{*}_{1} = \\frac{0.0325}{0.1125} = \\frac{325}{1125} = \\frac{13 \\times 25}{45 \\times 25} = \\frac{13}{45}\n$$\n作为小数，$p^{*}_{1} = 13 \\div 45 \\approx 0.28888...$。四舍五入到 4 位有效数字得到 $0.2889$。\n所有计算出的频率（$p^{*}_{1}=13/45$, $p^{*}_{2}=2/9$, $p^{*}_{3}=22/45$）都在区间 $(0,1)$ 内，意味着这个内部平衡是有效的。", "answer": "$$\\boxed{0.2889}$$", "id": "2831943"}]}