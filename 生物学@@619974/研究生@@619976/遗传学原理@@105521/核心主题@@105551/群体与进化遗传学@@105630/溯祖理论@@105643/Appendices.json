{"hands_on_practices": [{"introduction": "为了开始我们对溯祖理论的实践探索，我们将从其最基础的计算入手。这个练习要求你确定样本中若干谱系首次发生溯祖合并事件的期望等待时间。通过解决这个问题，你将巩固对样本量($k$)和种群大小($N$)如何共同决定溯祖速率的理解，这是整个溯祖理论的基石。[@problem_id:1477286]", "problem": "考虑一个大小恒定为 $N$ 个个体的理想化二倍体种群。在此模型中，世代是离散且不重叠的。我们假设，给定世代中的每个等位基因都是从上一代完整基因库中随机选择的一个等位基因的完美复制。任何一个亲代的基因库总共包含 $2N$ 个等位基因。\n\n当向后追溯等位基因的祖先时，“溯祖事件”被定义为两个不同的遗传谱系在紧邻的上一代中起源于同一个親代等位基因的时刻。\n\n假设您从当前种群中采集了一个包含四个不同等位基因的样本。您希望向后追溯它们的祖先。计算直到这四个谱系中的任意一对之间发生第一次溯祖事件时，所需回溯的期望世代数。这样的事件将使您样本中不同祖先谱系的数量从四个减少到三个。\n\n请用种群大小 $N$ 的解析公式来表示您的答案。", "solution": "我们使用Wright–Fisher模型来模拟一个大小恒定为 $N$ 的二倍体种群的繁殖过程，因此在 $t-1$ 代中的 $2N$ 个等位基因中的每一个，对于 $t$ 代中的任何一个等位基因来说，都是一个等可能的亲本。将 $k$ 个抽样谱系向后追溯一代，每个谱系从 $2N$ 个亲代等位基因中独立且均匀地选择一个亲本等位基因。\n\n对于任意一对特定的谱系，它们在紧邻的上一代发生溯祖（即，两者选择了同一个亲代等位基因）的概率是\n$$\n\\frac{1}{2N},\n$$\n因为在第一个谱系选择了一个祖先后，第二个谱系必须从 $2N$ 个等可能的等位基因中选择与之相同的那个。\n\n当有 $k=4$ 个谱系时，共有 $\\binom{4}{2}=6$ 个无序对。在标准溯祖近似下（该近似忽略了同时发生多个溯祖事件的概率，这是一个数量级为 $(2N)^{-2}$ 的事件），每一代中至少有一对谱系发生溯祖的概率 $p$ 是\n$$\np=\\binom{4}{2}\\cdot\\frac{1}{2N}=\\frac{6}{2N}=\\frac{3}{N}.\n$$\n因为每回溯一代，要么发生一次溯祖事件（使谱系数量减少），要么所有四个谱系都保持独立，并且每一代发生溯祖的概率都是相同的，所以到第一次溯祖事件的等待时间 $T$（以世代为单位）服从成功参数为 $p$ 的几何分布。因此，直到第一次溯祖事件发生的期望世代数是\n$$\n\\mathbb{E}[T]=\\frac{1}{p}=\\frac{N}{3}.\n$$", "answer": "$$\\boxed{\\frac{N}{3}}$$", "id": "1477286"}, {"introduction": "现实世界中的种群很少能保持恒定的大小。这个实践将超越理想化的模型，探讨种群波动，特别是瓶颈效应，如何影响遗传历史。你将为一个周期性变化的种群计算有效种群大小($N_e$)，从而理解为何在时间上平均溯祖速率时，调和平均数是恰当的度量——这是将溯祖理论应用于现实人口统计情景的一个关键见解。[@problem_id:1914452]", "problem": "一个单倍体古菌种群栖息在一个表现出可预测活动周期的间歇泉中。在间歇泉的稳定阶段，持续 $g_1 = 90$ 代，种群繁衍生息，并维持着 $N_{large} = 5.0 \\times 10^5$ 个体的庞大规模。此后，间歇泉进入一个持续 $g_2 = 10$ 代的不稳定喷发阶段，在此期间种群数量骤降至 $N_{small} = 5.0 \\times 10^2$ 个体的瓶颈规模。这整个 $g_1 + g_2$ 代的周期无限重复。\n\n在一个大小为 $N$ 的单倍体种群中，任意两个随机选择的基因谱系发生合并（即追溯到上一代的同一个共同祖先）的概率由溯祖率 $1/N$ 给出。这个波动种群的长期遗传行为可以用一个有效种群大小 $N_e$ 来描述。有效种群大小被定义为一个理想化的、大小恒定的种群的大小，该种群将经历与实际波动的种群相同的平均溯祖率。\n\n计算该古菌种群的有效种群大小 $N_e$。将您的最终答案四舍五入到三位有效数字。", "solution": "在单倍体种群中，当该代的普查规模为 $N_{t}$ 时，两个谱系的每代溯祖率为 $1/N_{t}$。有效种群大小 $N_{e}$ 的定义使其恒定的溯祖率等于波动溯祖率的长期时间平均值。因此，\n$$\n\\frac{1}{N_{e}}=\\left\\langle \\frac{1}{N_{t}}\\right\\rangle=\\frac{g_{1}}{g_{1}+g_{2}}\\cdot\\frac{1}{N_{large}}+\\frac{g_{2}}{g_{1}+g_{2}}\\cdot\\frac{1}{N_{small}}.\n$$\n等价地，\n$$\n\\frac{1}{N_{e}}=\\frac{g_{1}\\left(\\frac{1}{N_{large}}\\right)+g_{2}\\left(\\frac{1}{N_{small}}\\right)}{g_{1}+g_{2}},\\quad\\text{so}\\quad N_{e}=\\frac{g_{1}+g_{2}}{\\frac{g_{1}}{N_{large}}+\\frac{g_{2}}{N_{small}}}.\n$$\n代入 $g_{1}=90$，$g_{2}=10$，$N_{large}=5.0\\times 10^{5}$ 和 $N_{small}=5.0\\times 10^{2}$：\n$$\n\\frac{1}{N_{e}}=\\frac{90\\left(\\frac{1}{5.0\\times 10^{5}}\\right)+10\\left(\\frac{1}{5.0\\times 10^{2}}\\right)}{100}\n=\\frac{\\frac{90}{5.0\\times 10^{5}}+\\frac{10}{5.0\\times 10^{2}}}{100}.\n$$\n精确计算分子部分：\n$$\n\\frac{90}{5.0\\times 10^{5}}=\\frac{9}{5\\times 10^{4}}=\\frac{9}{50000},\\qquad\n\\frac{10}{5.0\\times 10^{2}}=\\frac{1}{50}=\\frac{1000}{50000},\n$$\n所以\n$$\n\\frac{1}{N_{e}}=\\frac{\\frac{9}{50000}+\\frac{1000}{50000}}{100}=\\frac{\\frac{1009}{50000}}{100}=\\frac{1009}{5\\times 10^{6}}.\n$$\n因此\n$$\nN_{e}=\\frac{5\\times 10^{6}}{1009}\\approx 4.955\\times 10^{3}.\n$$\n四舍五入到三位有效数字，得到 $N_{e}=4.96\\times 10^{3}$。", "answer": "$$\\boxed{4.96 \\times 10^{3}}$$", "id": "1914452"}, {"introduction": "在掌握了单步等待时间和种群动态的影响之后，我们现在可以构建完整的图景。这个更进一步的推导要求你计算整个样本追溯到最近共同祖先(MRCA)的总期望时间。通过对溯祖过程中每个阶段（从 $n$ 个谱系到 $n-1$ 个，依此类推）的期望等待时间进行求和，你不仅将推导群体遗传学中的一个关键结果，还将体会到溯祖理论作为一种强大工具，其背后用以模拟完整祖先历史的数学结构。[@problem_id:2800316]", "problem": "在一个有效群体大小恒为 $N_{e}$ 的泛交二倍体群体中，随机抽取 $n \\ge 2$ 条染色体。时间以溯祖单位计量，即世代数除以 $2N_{e}$ 进行重新标度，使得任意一对谱系以每单位重标度时间速率 $1$ 发生合并。在Kingman溯祖模型下，当存在 $k$ 个祖先谱系时，任意一个无序谱系对以总速率 $\\binom{k}{2}$ 合并，且到下一次合并事件的等待时间呈指数分布。仅使用这些定义和该过程的马尔可夫性质，推导样本回到最近共同祖先（MRCA）的期望总时间 $E[T_{\\mathrm{MRCA}}]$ 的一个闭式表达式（作为 $n$ 的函数），并以溯祖时间单位表示。请以最简闭式形式给出最终表达式。无需四舍五入。", "solution": "目标是求解一个包含 $n$ 条染色体的样本回到最近共同祖先（MRCA）的期望总时间，记为 $E[T_{\\mathrm{MRCA}}]$。溯祖过程模拟了样本的祖先谱系在时间上向后追溯。该过程从当前时间（$t=0$）的 $k=n$ 个谱系开始，直到仅剩 $k=1$ 个谱系时结束，这个剩下的谱系就是整个样本的MRCA。\n\n设 $T_k$ 为当存在 $k$ 个祖先谱系时，等待一次合并事件发生的随机变量。该过程从有 $k$ 个谱系的状态转换到有 $k-1$ 个谱系的状态。到达MRCA的总时间是从 $k=n$ 到 $k=2$ 的这些等待时间之和。最后一次从 $k=2$ 到 $k=1$ 的合并事件，确立了MRCA。因此，总时间为：\n$$T_{\\mathrm{MRCA}} = T_n + T_{n-1} + \\dots + T_2 = \\sum_{k=2}^{n} T_k$$\n根据期望的线性性质，期望总时间是每个区间期望等待时间的总和：\n$$E[T_{\\mathrm{MRCA}}] = E\\left[\\sum_{k=2}^{n} T_k\\right] = \\sum_{k=2}^{n} E[T_k]$$\n这一步的合理性由该过程的马尔可夫性质保证，该性质意味着在每个状态下的等待时间独立于之前的历史。\n\n现在我们必须求出期望等待时间 $E[T_k]$。根据问题陈述，当有 $k$ 个谱系时，任意无序对都可以合并，总合并速率为 $\\binom{k}{2}$。这是因为总共有 $\\binom{k}{2}$ 个不同的谱系对，并且时间被标度，使得任意单个谱系对的合并速率为 $1$。因此，第一个合并事件发生的总速率 $\\lambda_k$ 是所有独立竞争谱系对速率之和，即 $\\lambda_k = \\binom{k}{2}$。\n\n该事件的等待时间 $T_k$ 服从速率为 $\\lambda_k$ 的指数分布：\n$$T_k \\sim \\mathrm{Exp}\\left(\\lambda_k\\right) = \\mathrm{Exp}\\left(\\binom{k}{2}\\right)$$\n速率为 $\\lambda$ 的指数分布随机变量的期望值为 $1/\\lambda$。因此，存在 $k$ 个谱系的时间区间的期望持续时间为：\n$$E[T_k] = \\frac{1}{\\lambda_k} = \\frac{1}{\\binom{k}{2}}$$\n代入二项式系数的公式 $\\binom{k}{2} = \\frac{k(k-1)}{2}$，我们得到：\n$$E[T_k] = \\frac{1}{\\frac{k(k-1)}{2}} = \\frac{2}{k(k-1)}$$\n如题所述，所有时间均以溯祖单位表示。\n\n现在，我们将此表达式代回到总期望时间的求和式中：\n$$E[T_{\\mathrm{MRCA}}] = \\sum_{k=2}^{n} \\frac{2}{k(k-1)}$$\n为了计算这个和式，我们对通项使用部分分式分解法：\n$$\\frac{2}{k(k-1)} = 2\\left(\\frac{1}{k-1} - \\frac{1}{k}\\right)$$\n该和式变成一个裂项级数：\n$$E[T_{\\mathrm{MRCA}}] = \\sum_{k=2}^{n} 2\\left(\\frac{1}{k-1} - \\frac{1}{k}\\right) = 2 \\sum_{k=2}^{n} \\left(\\frac{1}{k-1} - \\frac{1}{k}\\right)$$\n展开和式可以展示各项的相消过程：\n$$E[T_{\\mathrm{MRCA}}] = 2 \\left[ \\left(\\frac{1}{1} - \\frac{1}{2}\\right) + \\left(\\frac{1}{2} - \\frac{1}{3}\\right) + \\left(\\frac{1}{3} - \\frac{1}{4}\\right) + \\dots + \\left(\\frac{1}{n-1} - \\frac{1}{n}\\right) \\right]$$\n对于 $j \\in \\{2, 3, \\dots, n-1\\}$，所有形如 $\\pm \\frac{1}{j}$ 的中间项都相互抵消，只剩下括号内的首项和末项：\n$$E[T_{\\mathrm{MRCA}}] = 2 \\left(\\frac{1}{1} - \\frac{1}{n}\\right) = 2 \\left(1 - \\frac{1}{n}\\right)$$\n最后，我们将此表达式写成最简闭式的单分式形式：\n$$E[T_{\\mathrm{MRCA}}] = \\frac{2(n-1)}{n}$$\n这就是对于一个大小为 $n$ 的样本，回到最近共同祖先的期望时间，以溯祖时间单位表示的最终表达式。", "answer": "$$\\boxed{\\frac{2(n-1)}{n}}$$", "id": "2800316"}]}