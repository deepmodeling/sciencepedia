{"hands_on_practices": [{"introduction": "生殖隔离机制可以分为多个阶段，而时间隔离是其中一种重要的合子前屏障。本练习旨在通过一个数学模型来实践如何量化时间隔离的强度。我们将假设物种的日常活动模式服从高斯分布，并计算它们之间重叠的程度，从而将一个抽象的生物学概念转化为一个可计算的指标[@problem_id:2839857]。", "problem": "在一对同域分布的近缘昆虫物种中，当它们的交配活动集中在一天中的不同时间时，就会产生合子前时间隔离。假设每个物种的每日交配活动时间可以用关于时间 $t$（单位：小时）的高斯概率密度函数来近似，并在实数轴 $\\mathbb{R}$ 上进行理想化：\n- 物种 $1$：$f_{1}(t)=\\dfrac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\!\\left(-\\dfrac{(t-\\mu_{1})^{2}}{2\\sigma^{2}}\\right)$，其中 $\\mu_{1}=8$ 且 $\\sigma^{2}=1$。\n- 物种 $2$：$f_{2}(t)=\\dfrac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\!\\left(-\\dfrac{(t-\\mu_{2})^{2}}{2\\sigma^{2}}\\right)$，其中 $\\mu_{2}=12$ 且 $\\sigma^{2}=1$。\n\n假设这些函数代表交配机会随时间变化的归一化分布，因此它们在 $\\mathbb{R}$ 上的积分均为$1$。将归一化时间重叠度定义为两个密度函数逐点取最小值的积分，\n$$\nO=\\int_{-\\infty}^{\\infty}\\min\\{f_{1}(t),f_{2}(t)\\}\\,dt,\n$$\n并将时间隔离指数定义为 $T=1-O$。\n\n仅使用这些定义和给定参数，计算 $T$。将最终答案表示为一个无单位小数，并四舍五入到四位有效数字。", "solution": "对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 物种 $1$ 交配活动密度：$f_{1}(t)=\\dfrac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\left(-\\dfrac{(t-\\mu_{1})^{2}}{2\\sigma^{2}}\\right)$\n- 物种 $1$ 的参数：$\\mu_{1}=8$，$\\sigma^{2}=1$。\n- 物种 $2$ 交配活动密度：$f_{2}(t)=\\dfrac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\left(-\\dfrac{(t-\\mu_{2})^{2}}{2\\sigma^{2}}\\right)$\n- 物种 $2$ 的参数：$\\mu_{2}=12$，$\\sigma^{2}=1$。\n- 时间变量 $t$ 定义在 $\\mathbb{R}$ 上。\n- 归一化时间重叠度的定义：$O=\\int_{-\\infty}^{\\infty}\\min\\{f_{1}(t),f_{2}(t)\\}\\,dt$。\n- 时间隔离指数的定义：$T=1-O$。\n- 最终答案必须是四舍五入到四位有效数字的小数。\n\n步骤2：使用提取的已知条件进行验证。\n该问题使用数学生物学中的一个标准模型——高斯分布，来表示一种生物现象（异时隔离）。参数被明确指定，重叠度和隔离指数的定义在数学上是精确的。该问题是自洽的，作为一个模型具有科学依据，并且是良定的。不存在矛盾、歧义或事实不准确之处。因此，该问题被认定为有效。\n\n步骤3：结论与行动。\n问题有效。现在推导求解过程。\n\n任务是计算时间隔离指数 $T=1-O$，其中 $O$ 是重叠积分。问题的核心是计算 $O=\\int_{-\\infty}^{\\infty}\\min\\{f_{1}(t),f_{2}(t)\\}\\,dt$。\n\n两个概率密度函数为：\n$f_{1}(t) = \\dfrac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\dfrac{(t-8)^{2}}{2}\\right)$\n$f_{2}(t) = \\dfrac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\dfrac{(t-12)^{2}}{2}\\right)$\n此处，两个分布的标准差均为 $\\sigma=\\sqrt{1}=1$。\n\n为了计算这两个函数最小值的积分，我们必须首先找到交点 $t_c$，在该点处 $f_{1}(t_c)=f_{2}(t_c)$。\n$$\n\\dfrac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\dfrac{(t_c-8)^{2}}{2}\\right) = \\dfrac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\dfrac{(t_c-12)^{2}}{2}\\right)\n$$\n对等式两边取自然对数，得到：\n$$\n-\\dfrac{(t_c-8)^{2}}{2} = -\\dfrac{(t_c-12)^{2}}{2}\n$$\n$$\n(t_c-8)^{2} = (t_c-12)^{2}\n$$\n这个方程有一个非平凡解：\n$$\nt_c-8 = -(t_c-12) = -t_c+12\n$$\n$$\n2t_c = 20\n$$\n$$\nt_c = 10\n$$\n现在我们确定在 $t_c=10$ 的两侧哪个函数值更小。函数 $g(t)=(t-8)^2-(t-12)^2$ 的导数 $g'(t)=2(t-8)-2(t-12)=8$ 为正。因此，$g(t)$ 是严格单调递增的。由于 $g(10)=0$：\n- 当 $t < 10$ 时，$g(t)<0$，意味着 $(t-8)^2 < (t-12)^2$。$f_1(t)$ 的指数比 $f_2(t)$ 的指数更大（负得更少），因此 $f_{1}(t) > f_{2}(t)$。所以，当 $t<10$ 时，$\\min\\{f_{1}(t),f_{2}(t)\\} = f_{2}(t)$。\n- 当 $t > 10$ 时，$g(t)>0$，意味着 $(t-8)^2 > (t-12)^2$。$f_1(t)$ 的指数比 $f_2(t)$ 的指数更小（负得更多），因此 $f_{1}(t) < f_{2}(t)$。所以，当 $t>10$ 时，$\\min\\{f_{1}(t),f_{2}(t)\\} = f_{1}(t)$。\n\n现在，重叠积分 $O$ 可以写为：\n$$\nO = \\int_{-\\infty}^{10} f_{2}(t)\\,dt + \\int_{10}^{\\infty} f_{1}(t)\\,dt\n$$\n这些积分可以用正态分布的累积分布函数（CDF）来表示。设 $\\Phi_{\\mu,\\sigma}(x)$ 为均值为 $\\mu$、标准差为 $\\sigma$ 的正态分布的累积分布函数。\n第一个积分是 $\\int_{-\\infty}^{10} f_{2}(t)\\,dt = \\Phi_{12,1}(10)$。\n第二个积分是 $\\int_{10}^{\\infty} f_{1}(t)\\,dt = 1 - \\int_{-\\infty}^{10} f_{1}(t)\\,dt = 1 - \\Phi_{8,1}(10)$。\n\n因此，$O = \\Phi_{12,1}(10) + 1 - \\Phi_{8,1}(10)$。\n\n我们可以使用标准正态累积分布函数 $\\Phi(z) = \\Phi_{0,1}(z)$ 来标准化这些累积分布函数，其中 $\\Phi_{\\mu,\\sigma}(x) = \\Phi\\left(\\frac{x-\\mu}{\\sigma}\\right)$。\n$$\n\\Phi_{12,1}(10) = \\Phi\\left(\\frac{10-12}{1}\\right) = \\Phi(-2)\n$$\n$$\n\\Phi_{8,1}(10) = \\Phi\\left(\\frac{10-8}{1}\\right) = \\Phi(2)\n$$\n将它们代入 $O$ 的表达式中：\n$$\nO = \\Phi(-2) + 1 - \\Phi(2)\n$$\n利用标准正态累积分布函数的对称性质 $\\Phi(-z) = 1 - \\Phi(z)$，我们有：\n$$\nO = (1 - \\Phi(2)) + 1 - \\Phi(2) = 2 - 2\\Phi(2)\n$$\n或者，$O = \\Phi(-2) + \\Phi(-2) = 2\\Phi(-2)$。\n\n时间隔离指数为 $T = 1-O$。\n$$\nT = 1 - (2 - 2\\Phi(2)) = 2\\Phi(2) - 1\n$$\n表达式 $2\\Phi(z)-1$ 等价于 $\\Phi(z)-\\Phi(-z)$，它表示标准正态变量落在区间 $[-z, z]$ 内的概率。在我们的例子中，$z=2$，所以 $T = \\Phi(2)-\\Phi(-2)$。\n\n为了计算数值，我们使用正态分布累积分布函数在 $z=2$ 处的标准值。一个常用的近似值是 $\\Phi(2) \\approx 0.97725$。\n$$\nT \\approx 2(0.97725) - 1 = 1.9545 - 1 = 0.9545\n$$\n这个值也可以用误差函数 $\\text{erf}(x)$ 来表示，即 $T = \\text{erf}\\left(\\frac{z}{\\sqrt{2}}\\right)$。当 $z=2$ 时，即为 $T = \\text{erf}(\\sqrt{2})$。\n使用一个更精确的值，$\\text{erf}(\\sqrt{2}) \\approx 0.954499736$。\n四舍五入到四位有效数字，我们得到 $0.9545$。\n\n隔离指数 $T$ 为 $0.9545$。这表明交配活动分布的重叠度为 $O=1-T \\approx 0.0455$，意味着存在很强的时间生殖隔离。", "answer": "$$\\boxed{0.9545}$$", "id": "2839857"}, {"introduction": "在理解了合子前隔离之后，我们转向合子后隔离的遗传基础。Dobzhansky-Muller (DM) 模型为杂种不育或不活提供了经典的遗传学解释，即祖先群体中独立演化出的新等位基因在杂种后代中首次相遇时可能产生负面的上位效应。本练习将引导你从第一性原理出发，推导在存在重组的情况下，$F_2$代杂种的预期适合度下降情况，从而深入理解基因互作如何形成生殖屏障[@problem_id:2839952]。", "problem": "考虑一个双基因座 Dobzhansky–Muller 不相容性（DMI）模型，其基因座为 $A/a$ 和 $B/b$。物种 $1$ 固定了单倍型 $A b$（在基因座 $A$ 上为衍生等位基因 $A$，在基因座 $B$ 上为祖先等位基因 $b$），而物种 $2$ 固定了单倍型 $a B$（在基因座 $A$ 上为祖先等位基因 $a$，在基因座 $B$ 上为衍生等位基因 $B$）。当衍生等位基因 $A$ 和 $B$ 组合在同一个体中时，它们通过上位性作用以一个乘法因子 $s$ 降低生存力；具体而言，任何携带至少一个 $A$ 等位基因和至少一个 $B$ 等位基因的个体的相对生存力为 $1 - s$，而所有其他基因型的相对生存力为 $1$。假设：\n- 随机交配，种群大小足够大，且不存在其他形式的选择或分离扭曲。\n- 子一代（F$1$）完全由双杂合子 $A a \\, B b$ 组成。\n- 两个基因座之间的重组率为 $r$，其中 $0 \\le r \\le \\tfrac{1}{2}$。\n- 子二代（F$2$）是通过 F$1$ 亲本在配子发生过程中发生重组后，其产生的配子随机结合而产生的。\n- 生存力选择作用于 F$2$ 合子形成之后，并且 DMI 根据上述规则完全外显。\n\n仅使用孟德尔分离定律、重组率 $r$ 的定义以及配子随机结合的原理，推导 F$2$ 群体的预期平均相对生存力 $\\bar{w}_{\\text{F}2}(r,s)$ 作为 $r$ 和 $s$ 的函数的显式闭式表达式。最终答案必须是单个解析表达式。不需要进行数值计算。", "solution": "所述问题具有科学依据、提法明确、客观，并包含了获得唯一解所需的所有必要信息。这是理论群体遗传学中一个关于 Dobzhansky-Muller 不相容性（DMI）后果的标准问题。因此，我将进行其形式化推导。\n\n目标是推导子二代（F$2$）的平均相对生存力，记为 $\\bar{w}_{\\text{F}2}(r,s)$，作为重组率 $r$ 和选择系数 $s$ 的函数。平均相对生存力是群体中所有基因型在选择前频率加权的相对生存力的平均值。其定义为：\n$$ \\bar{w} = \\sum_{i} f_i w_i $$\n其中 $f_i$ 是选择前基因型 $i$ 的频率，$w_i$ 是其相对生存力。\n\n根据题目，携带至少一个 $A$ 等位基因和至少一个 $B$ 等位基因的基因型的相对生存力为 $1-s$。所有其他基因型的相对生存力为 $1$。设 $P(\\text{incompatible})$ 为 F$2$ 代在选择前所有携带至少一个 $A$ 等位基因和至少一个 $B$ 等位基因的基因型的总频率。所有其他（相容）基因型的频率为 $1 - P(\\text{incompatible})$。因此，平均生存力可以表示为：\n$$ \\bar{w}_{\\text{F}2} = \\big(1 - P(\\text{incompatible})\\big) \\times 1 + P(\\text{incompatible}) \\times (1-s) $$\n$$ \\bar{w}_{\\text{F}2} = 1 - P(\\text{incompatible}) + P(\\text{incompatible}) - s \\cdot P(\\text{incompatible}) $$\n$$ \\bar{w}_{\\text{F}2} = 1 - s \\cdot P(\\text{incompatible}) $$\n因此，问题简化为计算 $P(\\text{incompatible})$。\n\n首先，我们必须确定 F$1$ 代产生的配子的频率。F$1$ 个体是由物种 $1$（基因型 $AAbb$，固定了单倍型 $Ab$）和物种 $2$（基因型 $aaBB$，固定了单倍型 $aB$）杂交形成的。产生的 F$1$ 个体是双杂合子，基因型为 $AaBb$，具体来说，其亲本单倍型处于相斥相，可以写作 $Ab/aB$。\n\n在这些 F$1$ 个体的减数分裂过程中，两个基因座之间以频率 $r$ 发生重组。产生的配子是：\n-   亲本型（非重组）配子：$Ab$ 和 $aB$。它们的总频率为 $1-r$。因此，各自的频率为 $f(Ab) = f(aB) = \\frac{1-r}{2}$。\n-   重组型配子：$AB$ 和 $ab$。它们的总频率为 $r$。因此，各自的频率为 $f(AB) = f(ab) = \\frac{r}{2}$。\n\nF$2$ 代是由 F$1$ 种群产生的这些配子随机结合而产生的。为了求得 $P(\\text{incompatible})$，我们对所有形如 $A\\_B\\_$ 的基因型频率求和。在计算上，先计算相容基因型的总频率 $P(\\text{compatible})$，然后使用关系式 $P(\\text{incompatible}) = 1 - P(\\text{compatible})$ 更为简单。\n\n相容基因型是那些相对生存力为 $1$ 的基因型。这些是形如 $A\\_bb$、$aaB\\_$ 和 $aabb$ 的基因型。这三类是互斥的。\n$$ P(\\text{compatible}) = P(A\\_bb) + P(aaB\\_) + P(aabb) $$\n我们通过对构成各类的基因型频率求和来计算每一类的频率，这些基因型频率是相应配子频率的乘积。\n\n1.  基因型 $aabb$ 的频率：\n    $$ P(aabb) = f(ab) \\times f(ab) = \\left(\\frac{r}{2}\\right)^2 = \\frac{r^2}{4} $$\n\n2.  基因型 $A\\_bb$（即 $AAbb$ 和 $Aabb$）的频率：\n    $$ f(AAbb) = f(Ab) \\times f(Ab) = \\left(\\frac{1-r}{2}\\right)^2 = \\frac{(1-r)^2}{4} $$\n    $$ f(Aabb) = 2 \\times f(Ab) \\times f(ab) = 2 \\left(\\frac{1-r}{2}\\right) \\left(\\frac{r}{2}\\right) = \\frac{r(1-r)}{2} $$\n    $$ P(A\\_bb) = f(AAbb) + f(Aabb) = \\frac{(1-r)^2}{4} + \\frac{2r(1-r)}{4} = \\frac{(1-r)(1-r+2r)}{4} = \\frac{(1-r)(1+r)}{4} = \\frac{1-r^2}{4} $$\n\n3.  基因型 $aaB\\_$（即 $aaBB$ 和 $aaBb$）的频率：\n    根据对称性，$P(aaB\\_)$ 的推导过程与 $P(A\\_bb)$ 的完全相同。\n    $$ P(aaB\\_) = \\frac{1-r^2}{4} $$\n\n现在，我们将这些频率相加，求出相容基因型的总频率：\n$$ P(\\text{compatible}) = P(A\\_bb) + P(aaB\\_) + P(aabb) = \\frac{1-r^2}{4} + \\frac{1-r^2}{4} + \\frac{r^2}{4} $$\n$$ P(\\text{compatible}) = \\frac{2(1-r^2) + r^2}{4} = \\frac{2 - 2r^2 + r^2}{4} = \\frac{2-r^2}{4} $$\n\n因此，不相容基因型的频率为：\n$$ P(\\text{incompatible}) = 1 - P(\\text{compatible}) = 1 - \\frac{2-r^2}{4} = \\frac{4 - (2-r^2)}{4} = \\frac{4-2+r^2}{4} = \\frac{2+r^2}{4} $$\n\n最后，我们将此表达式代回到平均相对生存力的方程中：\n$$ \\bar{w}_{\\text{F}2}(r,s) = 1 - s \\cdot P(\\text{incompatible}) = 1 - s \\left(\\frac{2+r^2}{4}\\right) $$\n这就是 F$2$ 群体预期平均相对生存力作为 $r$ 和 $s$ 的函数的最终闭式表达式。", "answer": "$$\n\\boxed{1 - s\\left(\\frac{2+r^2}{4}\\right)}\n$$", "id": "2839952"}, {"introduction": "现代演化生物学研究表明，生殖隔离的强度在基因组上并非均一，形成了所谓的“物种形成之岛”。本高级练习将我们带入群体基因组学的前沿，通过构建一个混合模型来分析简化的联合等位基因频率谱数据。你将学习如何使用最大似然估计来推断基因组中受强隔离屏障影响的区域比例，这反映了当代物种形成基因组学研究中的核心挑战[@problem_id:2839960]。", "problem": "一个程序必须从联合位点类别谱中推断一个简化的、跨基因座具有异质性迁移的隔离-迁移模型的参数，然后量化所推断的屏障强度分布。其生物学背景是，合子前和合子后生殖隔离机制相对于其他基因组区域，降低了某些基因组区域的有效种间迁移。该计算任务纯粹以数学术语构建，使用了一个关于位点类别的混合模型，并提供了所有必要的定义。\n\n定义和模型假设：\n- 考虑一个联合位点类别谱，其被聚合成四个针对两个分类单元的互斥且穷尽的类别：共享多态性、居群 $1$ 中的私有多态性、居群 $2$ 中的私有多态性以及固定差异。设观测到的计数为向量 $\\mathbf{C} = [C_{\\mathrm{S}}, C_{\\mathrm{P1}}, C_{\\mathrm{P2}}, C_{\\mathrm{D}}]$，总位点数为 $N = C_{\\mathrm{S}} + C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}}$。\n- 在一个跨基因座具有异质性迁移的隔离-迁移情景下，将异质性建模为基因座上的一个两类混合模型：\n  1. 高迁移类别（泛交极限）：期望的位点类别概率为 $\\mathbf{v}_{\\mathrm{H}} = [1, 0, 0, 0]$。\n  2. 屏障类别（无迁移，长期隔离极限，但允许分离变异）：期望的位点类别概率为\n     $$\\mathbf{v}_{\\mathrm{B}}(\\phi) = \\left[0,\\ \\frac{\\phi}{2},\\ \\frac{\\phi}{2},\\ 1 - \\phi\\right],$$\n     其中 $\\phi \\in [0,1]$ 参数化了非共享变异中为多态性而非固定差异的比例。较大的 $\\phi$ 表示在屏障类别内，相对于固定差异，私有多态性的比例更高。\n- 设 $w \\in [0,1]$ 为高迁移类别的混合权重，因此屏障类别的权重为 $(1 - w)$。期望的位点类别概率为\n  $$\\mathbf{p}(w,\\phi) = w \\cdot \\mathbf{v}_{\\mathrm{H}} + (1 - w)\\cdot \\mathbf{v}_{\\mathrm{B}}(\\phi) = \\left[w,\\ (1 - w)\\frac{\\phi}{2},\\ (1 - w)\\frac{\\phi}{2},\\ (1 - w)(1 - \\phi)\\right]。$$\n- 假设各位点独立同分布，且观测计数 $\\mathbf{C}$ 是从总数为 $N$、类别概率为 $\\mathbf{p}(w,\\phi)$ 的多项分布中抽取的。这种复合似然近似是位点频率谱分析中的一个标准起点。\n\n估计目标：\n- 对每个给定的测试用例 $\\mathbf{C}$，通过最大化多项似然（或等价地，对数似然）来估计最大似然参数 $(\\widehat{w}, \\widehat{\\phi})$：\n  $$\\ell(w,\\phi \\mid \\mathbf{C}) = C_{\\mathrm{S}}\\log p_{\\mathrm{S}} + C_{\\mathrm{P1}}\\log p_{\\mathrm{P1}} + C_{\\mathrm{P2}}\\log p_{\\mathrm{P2}} + C_{\\mathrm{D}}\\log p_{\\mathrm{D}},$$\n  约束条件为 $w \\in [0,1]$、$\\phi \\in [0,1]$，并且如上所述 $p_{\\mathrm{S}} + p_{\\mathrm{P1}} + p_{\\mathrm{P2}} + p_{\\mathrm{D}} = 1$。\n- 将跨基因座的屏障强度分布解释为一个伯努利随机变量 $B$，其支撑集为 $\\{0,1\\}$，其中 $B = 0$ 表示高迁移基因座（无屏障），$B = 1$ 表示屏障基因座（迁移完全受阻）。在此混合模型下，分布为 $P(B=1) = 1 - w$ 和 $P(B=0) = w$。报告 $B$ 的均值和方差：\n  $$\\mathbb{E}[B] = 1 - w,\\quad \\mathrm{Var}(B) = w(1 - w)。$$\n\n边界约定：\n- 如果 $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}} = 0$（即只观测到共享多态性），则定义 $\\widehat{w} = 1$ 并根据连续性设 $\\widehat{\\phi} = 0$。\n- 如果 $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} > 0$ 且 $C_{\\mathrm{D}} = 0$，则定义 $\\widehat{\\phi} = 1$。\n- 如果 $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} = 0$ 且 $C_{\\mathrm{D}} > 0$，则定义 $\\widehat{\\phi} = 0$。\n\n测试套件：\n- 使用以下四个测试用例，每个用例的总位点数 $N = 1000$：\n  1. $\\mathbf{C}^{(1)} = \\left[800, 80, 70, 50\\right]$。\n  2. $\\mathbf{C}^{(2)} = \\left[400, 200, 190, 210\\right]$。\n  3. $\\mathbf{C}^{(3)} = \\left[50, 250, 260, 440\\right]$。\n  4. $\\mathbf{C}^{(4)} = \\left[1000, 0, 0, 0\\right]$。\n\n所需计算：\n- 对每个测试用例 $\\mathbf{C}^{(k)}$，计算使模型下多项似然最大化的 $(\\widehat{w}^{(k)}, \\widehat{\\phi}^{(k)})$。然后使用上述公式计算相应的屏障均值和方差 $\\left(\\mathbb{E}[B]^{(k)}, \\mathrm{Var}(B)^{(k)}\\right)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个 Python 风格的列表嵌套列表形式的结果。对每个测试用例 $k \\in \\{1,2,3,4\\}$，输出列表 $\\left[\\widehat{w}^{(k)}, \\widehat{\\phi}^{(k)}, \\mathbb{E}[B]^{(k)}, \\mathrm{Var}(B)^{(k)}\\right]$，其中每个值四舍五入到六位小数。按照上述测试套件的顺序，将这些列表连接成一个外部列表。例如：\"[[0.123456,0.654321,0.876544,0.108721],[...],[...],[...]]\"。", "solution": "问题已提交验证。\n\n**第1步：提取的已知条件**\n- 数据：四个位点类别计数的向量，$\\mathbf{C} = [C_{\\mathrm{S}}, C_{\\mathrm{P1}}, C_{\\mathrm{P2}}, C_{\\mathrm{D}}]$。\n- 总位点数：$N = C_{\\mathrm{S}} + C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}}$。\n- 模型：一个由以下定义的两类混合模型：\n    - 高迁移类别概率向量：$\\mathbf{v}_{\\mathrm{H}} = [1, 0, 0, 0]$。\n    - 屏障类别概率向量：$\\mathbf{v}_{\\mathrm{B}}(\\phi) = \\left[0,\\ \\frac{\\phi}{2},\\ \\frac{\\phi}{2},\\ 1 - \\phi\\right]$。\n- 模型参数：混合权重 $w \\in [0,1]$ 和屏障多态性参数 $\\phi \\in [0,1]$。\n- 整体位点类别概率：$\\mathbf{p}(w,\\phi) = w \\cdot \\mathbf{v}_{\\mathrm{H}} + (1 - w)\\cdot \\mathbf{v}_{\\mathrm{B}}(\\phi)$。具体来说，$p_{\\mathrm{S}} = w$，$p_{\\mathrm{P1}} = (1 - w)\\frac{\\phi}{2}$，$p_{\\mathrm{P2}} = (1 - w)\\frac{\\phi}{2}$，以及 $p_{\\mathrm{D}} = (1 - w)(1 - \\phi)$。\n- 似然模型：计数 $\\mathbf{C}$ 服从试验次数为 $N$、概率为 $\\mathbf{p}(w,\\phi)$ 的多项分布。\n- 目标：找到最大似然估计值 $(\\widehat{w}, \\widehat{\\phi})$，使对数似然函数 $\\ell(w,\\phi \\mid \\mathbf{C}) = C_{\\mathrm{S}}\\log p_{\\mathrm{S}} + C_{\\mathrm{P1}}\\log p_{\\mathrm{P1}} + C_{\\mathrm{P2}}\\log p_{\\mathrm{P2}} + C_{\\mathrm{D}}\\log p_{\\mathrm{D}}$ 最大化。\n- 派生量：对于表示屏障状态的伯努利随机变量 $B$，计算其均值 $\\mathbb{E}[B] = 1 - w$ 和方差 $\\mathrm{Var}(B) = w(1 - w)$。\n- 边界约定：\n    1. 如果 $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}} = 0$，则 $\\widehat{w} = 1$ 且 $\\widehat{\\phi} = 0$。\n    2. 如果 $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} > 0$ 且 $C_{\\mathrm{D}} = 0$，则 $\\widehat{\\phi} = 1$。\n    3. 如果 $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} = 0$ 且 $C_{\\mathrm{D}} > 0$，则 $\\widehat{\\phi} = 0$。\n- 测试套件：\n    1. $\\mathbf{C}^{(1)} = [800, 80, 70, 50]$，$N=1000$。\n    2. $\\mathbf{C}^{(2)} = [400, 200, 190, 210]$，$N=1000$。\n    3. $\\mathbf{C}^{(3)} = [50, 250, 260, 440]$，$N=1000$。\n    4. $\\mathbf{C}^{(4)} = [1000, 0, 0, 0]$，$N=1000$。\n\n**第2步：验证**\n该问题具有科学依据，代表了群体遗传学中一个简化但有效的模型。它是一个适定问题 (well-posed)，具有在紧凑参数空间上最大化的明确定义的目标函数（多项似然）。问题陈述是客观、完整且无矛盾的。所有术语都已定义，任务是一个标准的统计估计问题。\n\n**结论：**该问题有效。\n\n**解题推导**\n目标是找到使多项对数似然函数最大化的参数 $(\\widehat{w}, \\widehat{\\phi})$。我们将模型概率代入对数似然表达式中：\n$$ \\ell(w,\\phi) = C_{\\mathrm{S}}\\log(w) + C_{\\mathrm{P1}}\\log\\left((1 - w)\\frac{\\phi}{2}\\right) + C_{\\mathrm{P2}}\\log\\left((1 - w)\\frac{\\phi}{2}\\right) + C_{\\mathrm{D}}\\log((1 - w)(1 - \\phi)) $$\n利用对数的性质，我们可以展开并重组各项：\n$$ \\ell(w,\\phi) = C_{\\mathrm{S}}\\log(w) + (C_{\\mathrm{P1}} + C_{\\mathrm{P2}})\\left[\\log(1 - w) + \\log(\\phi) - \\log(2)\\right] + C_{\\mathrm{D}}\\left[\\log(1 - w) + \\log(1 - \\phi)\\right] $$\n合并涉及 $w$ 和 $\\phi$ 的项：\n$$ \\ell(w,\\phi) = \\left[ C_{\\mathrm{S}}\\log(w) + (C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}})\\log(1-w) \\right] + \\left[ (C_{\\mathrm{P1}} + C_{\\mathrm{P2}})\\log(\\phi) + C_{\\mathrm{D}}\\log(1-\\phi) \\right] - (C_{\\mathrm{P1}} + C_{\\mathrm{P2}})\\log(2) $$\n为了最大化，我们可以忽略常数项 $-(C_{\\mathrm{P1}} + C_{\\mathrm{P2}})\\log(2)$。剩余的函数是可分离的，这意味着我们可以独立地最大化涉及 $w$ 的部分和涉及 $\\phi$ 的部分。\n\n设 $L_w(w) = C_{\\mathrm{S}}\\log(w) + (C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}})\\log(1-w)$。\n为了找到最大值，我们对 $w$ 求导并令其为零：\n$$ \\frac{dL_w}{dw} = \\frac{C_{\\mathrm{S}}}{w} - \\frac{C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}}}{1-w} = 0 $$\n$$ C_{\\mathrm{S}}(1-w) = w(C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}}) $$\n$$ C_{\\mathrm{S}} = w(C_{\\mathrm{S}} + C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}}) = wN $$\n因此 $w$ 的最大似然估计为：\n$$ \\widehat{w} = \\frac{C_{\\mathrm{S}}}{N} $$\n\n设 $L_\\phi(\\phi) = (C_{\\mathrm{P1}} + C_{\\mathrm{P2}})\\log(\\phi) + C_{\\mathrm{D}}\\log(1-\\phi)$。\n为了找到最大值，我们对 $\\phi$ 求导并令其为零：\n$$ \\frac{dL_\\phi}{d\\phi} = \\frac{C_{\\mathrm{P1}} + C_{\\mathrm{P2}}}{\\phi} - \\frac{C_{\\mathrm{D}}}{1-\\phi} = 0 $$\n$$ (C_{\\mathrm{P1}} + C_{\\mathrm{P2}})(1-\\phi) = C_{\\mathrm{D}}\\phi $$\n$$ C_{\\mathrm{P1}} + C_{\\mathrm{P2}} = \\phi(C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}}) $$\n因此 $\\phi$ 的最大似然估计为：\n$$ \\widehat{\\phi} = \\frac{C_{\\mathrm{P1}} + C_{\\mathrm{P2}}}{C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}}} $$\n当分母不为零时，这些解析解是有效的。所提供的边界条件处理了这些边缘情况。\n- 如果 $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}} = 0$，则 $C_S=N$，所以 $\\widehat{w}=N/N=1$。$\\widehat{\\phi}$ 的分母为 $0$，使其未定义。问题规定在这种情况下 $\\widehat{\\phi}=0$。\n- 如果 $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} > 0$ 且 $C_{\\mathrm{D}} = 0$，我们的公式得出 $\\widehat{\\phi} = \\frac{C_{\\mathrm{P1}} + C_{\\mathrm{P2}}}{C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + 0} = 1$，与约定相符。\n- 如果 $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} = 0$ 且 $C_{\\mathrm{D}} > 0$，我们的公式得出 $\\widehat{\\phi} = \\frac{0}{0 + C_{\\mathrm{D}}} = 0$，也与约定相符。\n\n派生量由估计的参数计算得出：\n$$ \\mathbb{E}[B] = 1 - \\widehat{w} $$\n$$ \\mathrm{Var}(B) = \\widehat{w}(1 - \\widehat{w}) $$\n\n**测试用例计算**\n\n对于每个测试用例 $\\mathbf{C}^{(k)} = [C_{\\mathrm{S}}, C_{\\mathrm{P1}}, C_{\\mathrm{P2}}, C_{\\mathrm{D}}]$，其中 $N=1000$：\n\n1.  **$\\mathbf{C}^{(1)} = [800, 80, 70, 50]$**\n    - $\\widehat{w}^{(1)} = \\frac{800}{1000} = 0.8$\n    - $\\widehat{\\phi}^{(1)} = \\frac{80 + 70}{80 + 70 + 50} = \\frac{150}{200} = 0.75$\n    - $\\mathbb{E}[B]^{(1)} = 1 - 0.8 = 0.2$\n    - $\\mathrm{Var}(B)^{(1)} = 0.8 \\times (1 - 0.8) = 0.16$\n    - 结果： $[0.8, 0.75, 0.2, 0.16]$\n\n2.  **$\\mathbf{C}^{(2)} = [400, 200, 190, 210]$**\n    - $\\widehat{w}^{(2)} = \\frac{400}{1000} = 0.4$\n    - $\\widehat{\\phi}^{(2)} = \\frac{200 + 190}{200 + 190 + 210} = \\frac{390}{600} = 0.65$\n    - $\\mathbb{E}[B]^{(2)} = 1 - 0.4 = 0.6$\n    - $\\mathrm{Var}(B)^{(2)} = 0.4 \\times (1 - 0.4) = 0.24$\n    - 结果： $[0.4, 0.65, 0.6, 0.24]$\n\n3.  **$\\mathbf{C}^{(3)} = [50, 250, 260, 440]$**\n    - $\\widehat{w}^{(3)} = \\frac{50}{1000} = 0.05$\n    - $\\widehat{\\phi}^{(3)} = \\frac{250 + 260}{250 + 260 + 440} = \\frac{510}{950} \\approx 0.536842$\n    - $\\mathbb{E}[B]^{(3)} = 1 - 0.05 = 0.95$\n    - $\\mathrm{Var}(B)^{(3)} = 0.05 \\times (1 - 0.05) = 0.0475$\n    - 结果： $[0.05, 0.536842, 0.95, 0.0475]$\n\n4.  **$\\mathbf{C}^{(4)} = [1000, 0, 0, 0]$**\n    - 此处，$C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}} = 0$。我们应用第一个边界条件。\n    - $\\widehat{w}^{(4)} = 1.0$\n    - $\\widehat{\\phi}^{(4)} = 0.0$\n    - $\\mathbb{E}[B]^{(4)} = 1 - 1.0 = 0.0$\n    - $\\mathrm{Var}(B)^{(4)} = 1.0 \\times (1 - 1.0) = 0.0$\n    - 结果： $[1.0, 0.0, 0.0, 0.0]$\n\n实现将遵循此逻辑来计算和格式化最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes maximum likelihood estimates for a simplified isolation-with-migration model\n    and derived barrier strength statistics for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # C_S, C_P1, C_P2, C_D\n        (800, 80, 70, 50),\n        (400, 200, 190, 210),\n        (50, 250, 260, 440),\n        (1000, 0, 0, 0),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        c_s, c_p1, c_p2, c_d = case\n        n = c_s + c_p1 + c_p2 + c_d\n\n        c_non_shared = c_p1 + c_p2 + c_d\n\n        if c_non_shared == 0:\n            # This corresponds to boundary condition 1: C_P1 + C_P2 + C_D = 0\n            # Then N = C_S, so w_hat = C_S / N = 1.\n            # phi_hat is non-identifiable, set to 0 by convention.\n            w_hat = 1.0\n            phi_hat = 0.0\n        else:\n            # General case for MLEs derived in the solution\n            w_hat = c_s / n\n            \n            c_priv_poly = c_p1 + c_p2\n            phi_hat = c_priv_poly / c_non_shared\n            # This general formula correctly handles boundary conditions 2 and 3:\n            # If C_D = 0, phi_hat = c_priv_poly / c_priv_poly = 1.\n            # If c_priv_poly = 0, phi_hat = 0 / C_D = 0.\n\n        # Calculate the mean and variance of the barrier strength distribution\n        mean_b = 1.0 - w_hat\n        var_b = w_hat * (1.0 - w_hat)\n        \n        result_tuple = (w_hat, phi_hat, mean_b, var_b)\n        all_results.append(result_tuple)\n\n    # Format the results into a single string as required.\n    # Each sublist is formatted as a string without spaces, e.g., \"[v1,v2,v3,v4]\".\n    # Each value is formatted to six decimal places.\n    list_of_strings = [\n        f\"[{','.join(f'{val:.6f}' for val in result)}]\" for result in all_results\n    ]\n    \n    # The final output is a string representation of a list of these string-lists.\n    final_output_string = f\"[{','.join(list_of_strings)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "2839960"}]}