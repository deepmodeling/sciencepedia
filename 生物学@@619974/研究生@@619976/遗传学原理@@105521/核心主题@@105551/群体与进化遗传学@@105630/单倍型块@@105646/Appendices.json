{"hands_on_practices": [{"introduction": "四分体检验是从群体遗传数据中检测历史重组的基本原则。本练习将直接应用该检验，要求您分析一组定相的单倍型，并识别出解释观测到的遗传变异所需的最少重组断点数量，从而划定单倍型块的边界 ([@problem_id:2820834])。", "problem": "一个基因组区域包含$4$个有序的单核苷酸多态性 (SNP)，记为 $S_1, S_2, S_3, S_4$。在无限位点模型（无重复突变、无基因转换、随机交配）下，您对$6$个抽样染色体在这些SNP位点上的定相单倍型进行了分析，等位基因按 $(S_1,S_2,S_3,S_4)$ 的顺次编码为$0$和$1$：\n- $H_1 = (0,0,0,0)$\n- $H_2 = (0,1,0,0)$\n- $H_3 = (1,0,0,0)$\n- $H_4 = (1,1,0,0)$\n- $H_5 = (0,0,1,0)$\n- $H_6 = (0,1,1,1)$\n\n对每对相邻的SNP对 $(S_1,S_2)$、$(S_2,S_3)$ 和 $(S_3,S_4)$ 应用四配子检验。此处，重组断点定义为在相邻标记间的SNP间区间内存在至少一次历史重组事件。请确定在模型假设下，为与观察到的定相单倍型保持一致，必须包含重组断点的最小SNP间区间集合。\n\n仅报告相邻SNP间不同重组断点的最小数量。只提供数字，无需四舍五入。", "solution": "所述问题具有科学依据、提法恰当且客观。它基于群体遗传学的基本原理，特别是无限位点模型和用于检测重组的四配子检验。所有必要的数据和定义都已提供，问题没有歧义或矛盾。这是一个有效且可解的问题。\n\n需要应用的核心原理是四配子检验。在无限位点模型下，每个突变都发生在染色体上的一个独特位置且永不回复，一组非重组序列的谱系历史可以用一个单一的完美系统发育树（一棵树）来表示。对于任意两个双等位基因单核苷酸多态性 (SNP)，其等位基因记为 $0$ 和 $1$，存在四种可能的双位点单倍型（配子）：$(0,0)$, $(0,1)$, $(1,0)$ 和 $(1,1)$。如果两个SNP位点之间没有发生重组，那么在一个样本中最多只能存在这四种配子中的三种。第四种配子的出现只能通过历史重组事件来解释，该事件将来自不同祖先背景的等位基因组合在一起。因此，观察到两个位点间存在所有四种配子，是推断它们之间的区间内至少发生过一次重组事件的充分证据。\n\n我们已知$4$个有序SNP，$S_1, S_2, S_3, S_4$，以及$6$个定相单倍型：\n$H_1 = (0,0,0,0)$\n$H_2 = (0,1,0,0)$\n$H_3 = (1,0,0,0)$\n$H_4 = (1,1,0,0)$\n$H_5 = (0,0,1,0)$\n$H_6 = (0,1,1,1)$\n\n我们将对$3$个相邻的SNP间区间分别应用四配子检验。\n\n1.  $S_1$ 和 $S_2$ 之间的区间：\n    我们从给定的$6$个完整单倍型中提取 $(S_1, S_2)$ 对的双位点单倍型：\n    - 来自 $H_1$: $(0,0)$\n    - 来自 $H_2$: $(0,1)$\n    - 来自 $H_3$: $(1,0)$\n    - 来自 $H_4$: $(1,1)$\n    - 来自 $H_5$: $(0,0)$\n    - 来自 $H_6$: $(0,1)$\n    观察到的独特双位点单倍型集合是 $\\{(0,0), (0,1), (1,0), (1,1)\\}$。由于所有四种可能的配子都存在，我们必须得出结论，在 $S_1$ 和 $S_2$ 之间的区间内至少发生了一次历史重组事件。该区间必须包含一个重组断点。\n\n2.  $S_2$ 和 $S_3$ 之间的区间：\n    我们提取 $(S_2, S_3)$ 对的双位点单倍型：\n    - 来自 $H_1$: $(0,0)$\n    - 来自 $H_2$: $(1,0)$\n    - 来自 $H_3$: $(0,0)$\n    - 来自 $H_4$: $(1,0)$\n    - 来自 $H_5$: $(0,1)$\n    - 来自 $H_6$: $(1,1)$\n    观察到的独特双位点单倍型集合是 $\\{(0,0), (1,0), (0,1), (1,1)\\}$。同样，所有四种可能的配子都存在。因此，我们必须推断，在 $S_2$ 和 $S_3$ 之间的区间内至少发生了一次重组事件。该区间也必须包含一个重组断点。\n\n3.  $S_3$ 和 $S_4$ 之间的区间：\n    我们提取 $(S_3, S_4)$ 对的双位点单倍型：\n    - 来自 $H_1$: $(0,0)$\n    - 来自 $H_2$: $(0,0)$\n    - 来自 $H_3$: $(0,0)$\n    - 来自 $H_4$: $(0,0)$\n    - 来自 $H_5$: $(1,0)$\n    - 来自 $H_6$: $(1,1)$\n    观察到的独特双位点单倍型集合是 $\\{(0,0), (1,0), (1,1)\\}$。在这种情况下，只存在四种可能配子中的三种。配子 $(0,1)$ 未在样本中观察到。第四种配子的缺失意味着数据与 $S_3$ 和 $S_4$ 位点间无重组历史的情况一致。因此，四配子检验不提供该区间存在重组断点的证据，也不要求该区间存在重组断点。\n\n基于此系统性分析，为与数据保持一致而必须包含重组断点的最小SNP间区间集合，包括 $S_1$ 和 $S_2$ 之间的区间，以及 $S_2$ 和 $S_3$ 之间的区间。\n\n因此，相邻SNP间不同重组断点的最小数量是 $2$。", "answer": "$$\\boxed{2}$$", "id": "2820834"}, {"introduction": "虽然群体数据为单倍型块提供了统计证据，但家系核心家系（trio）数据为了解遗传机制提供了直接的窗口。本练习利用孟德尔分离定律的原理，从不定相的核心家系基因型中逻辑推断出亲本的单倍型。通过这样做，您将确定与亲代向子代遗传物质传递过程相一致的最简约的块结构 ([@problem_id:2820870])。", "problem": "一个经过基因分型的家庭三联体包括父母双方和一个后代，他们在一条染色体上从左到右排列的三个相邻的双等位基因单核苷酸多态性（SNP）标记（表示为 $S_1$、$S_2$ 和 $S_3$）上进行了分型。每个SNP的等位基因编码为 $0$ 和 $1$。假设没有基因分型错误、新生突变，并且遵循孟德尔分离定律。观测到的未定相二倍体基因型如下：\n- 母亲：$S_1 = 0/1$，$S_2 = 0/1$，$S_3 = 0/1$。\n- 父亲：$S_1 = 0/0$，$S_2 = 1/1$，$S_3 = 0/1$。\n- 后代：$S_1 = 0/1$，$S_2 = 0/1$，$S_3 = 0/1$。\n\n仅使用孟德尔遗传定律和SNP的顺序，在该三联体中可确定的地方重建亲本单倍型，并推断出最简约的单倍型区块结构。在本问题中，单倍型区块定义为这样一个最大的连续SNP集合：对于该集合，可以在不假定产生后代的减数分裂过程中区块内部发生任何重组事件的情况下，明确地确定该三联体中亲本的单倍型。\n\n报告与数据一致的此类单倍型区块的最小数量，以单个整数形式表示。无需四舍五入。以无单位的整数形式表达最终答案。", "solution": "该问题要求针对一个家庭三联体在三个相邻的SNP标记（$S_1$、$S_2$ 和 $S_3$）上重建亲本单倍型，并随后确定与所提供的基因型数据一致的单倍型区块的最小数量。单倍型区块被定义为一个最大的连续SNP集合，对于该集合，假定区块内部没有重组发生，可以明确地确定该三联体中亲本的单倍型。\n\n提供的未定相二倍体基因型如下：\n- 母亲 (M)：$S_1 = 0/1$，$S_2 = 0/1$，$S_3 = 0/1$。\n- 父亲 (F)：$S_1 = 0/0$，$S_2 = 1/1$，$S_3 = 0/1$。\n- 后代 (O)：$S_1 = 0/1$，$S_2 = 0/1$，$S_3 = 0/1$。\n\n假设为：无基因分型错误，无新生突变，及遵循孟德尔分离定律。\n\n首先，我们验证问题陈述。\n步骤1：提取已知条件。\n- 家庭结构：母亲、父亲、后代。\n- 标记：三个有序、相邻的双等位基因SNP（$S_1, S_2, S_3$），等位基因为 $\\{0, 1\\}$。\n- 母亲的基因型：$(S_1: 0/1, S_2: 0/1, S_3: 0/1)$。\n- 父亲的基因型：$(S_1: 0/0, S_2: 1/1, S_3: 0/1)$。\n- 后代的基因型：$(S_1: 0/1, S_2: 0/1, S_3: 0/1)$。\n- 约束条件：无基因分型错误，无新生突变，遵循孟德尔分离定律。\n- 单倍型区块的定义：“这样一个最大的连续SNP集合：对于该集合，可以在不假定产生后代的减数分裂过程中区块内部发生任何重组事件的情况下，明确地确定该三联体中亲本的单倍型。”\n- 目标：报告此类单倍型区块的最小数量。\n\n步骤2：使用提取的已知条件进行验证。\n该问题在科学上基于孟德尔遗传学原理，这是生物学的一个基本概念。数据和术语在群体遗传学和基因组学中是标准的。该问题陈述清晰，提供了足够的信息和一个基于精确定义的明确目标。语言客观且无歧义。该问题不违反任何指定的无效标准；它是一个标准的、可解决的遗传学难题。\n\n步骤3：结论与行动。\n问题有效。我们继续进行解答。\n\n设一个单倍型由与SNP $S_1, S_2, S_3$ 相对应的有序等位基因三元组 $(a_1, a_2, a_3)$ 表示。\n\n1.  **确定父亲的单倍型。**\n父亲的基因型是 $S_1(0/0)$，$S_2(1/1)$，$S_3(0/1)$。由于他在 $S_1$ 和 $S_2$ 上是纯合的，他拥有的任何单倍型在 $S_1$ 处必须为 $0$，在 $S_2$ 处必须为 $1$。由于他在 $S_3$ 上是杂合的，他的两个单倍型必须在该位点上有所不同。因此，父亲的两条染色体单倍型可以明确地确定为 $(0, 1, 0)$ 和 $(0, 1, 1)$。我们将其表示为 $F: (0, 1, 0) / (0, 1, 1)$。这三个标记的相位都是已知的。\n\n2.  **确定传递的等位基因。**\n后代的基因型是来自母亲的一个单倍型和来自父亲的一个单倍型的组合。\n- 在 $S_1$ 处，父亲是 $0/0$，后代是 $0/1$。父亲必须传递了一个 $0$ 等位基因。为了让后代是 $0/1$，母亲必须传递了一个 $1$ 等位基因。\n- 在 $S_2$ 处，父亲是 $1/1$，后代是 $0/1$。父亲必须传递了一个 $1$ 等位基因。为了让后代是 $0/1$，母亲必须传递了一个 $0$ 等位基因。\n- 在 $S_3$ 处，父母双方都是 $0/1$，后代也是 $0/1$。我们无法明确地确定等位基因的亲本来源。可能是父亲传递了 $0$ 而母亲传递了 $1$，也可能是父亲传递了 $1$ 而母亲传递了 $0$。\n\n3.  **推断亲本相位和单倍型区块。**\n我们现在应用单倍型区块的定义，该定义要求能够为一个连续的SNP集合明确地指定亲本单倍型。\n\n**分析SNP集合 $\\{S_1, S_2\\}$：**\n- **父亲在 $\\{S_1, S_2\\}$ 上的单倍型**：他的基因型是 $S_1(0/0)$，$S_2(1/1)$。他在此区域的单倍型必定是 $(0, 1)$ 和 $(0, 1)$。该相位是明确确定的。\n- **母亲在 $\\{S_1, S_2\\}$ 上的单倍型**：她的基因型是 $S_1(0/1)$，$S_2(0/1)$。根据步骤2，我们推断出她传递给后代的单倍型包含 $(S_1, S_2)$ 的等位基因 $(1, 0)$。由于她在两个位点上都是杂合的，她另一个未传递的单倍型必须是 $(0, 1)$，以构成她未传递的等位基因。因此，母亲在此区域的单倍型可以明确地确定为 $(1, 0) / (0, 1)$。\n\n由于父母双方在连续集合 $\\{S_1, S_2\\}$ 上的亲本单倍型都可以被明确地确定，这个集合满足了成为一个区块的条件。\n\n**分析SNP集合 $\\{S_1, S_2, S_3\\}$：**\n要成为一个单一区块，母亲和父亲的单倍型必须在所有三个标记上都能被明确地确定。\n- **父亲在 $\\{S_1, S_2, S_3\\}$ 上的单倍型**：如步骤1所确定，它们明确为 $(0, 1, 0) / (0, 1, 1)$。\n- **母亲在 $\\{S_1, S_2, S_3\\}$ 上的单倍型**：我们知道她在 $\\{S_1, S_2\\}$ 上的单倍型是 $(1, 0)$ 和 $(0, 1)$。她在 $S_3$ 处的基因型是 $0/1$。这导致了她的完整单倍型有两种可能性：\n    - 可能性A：$(1, 0, 0) / (0, 1, 1)$\n    - 可能性B：$(1, 0, 1) / (0, 1, 0)$\n\n为了区分这两种可能性，我们检查整个遗传过程，并假设没有发生重组。\n- 如果母亲的相位是可能性A，她可以传递 $(1, 0, 0)$。为了使后代的基因型为 $(0/1, 0/1, 0/1)$，父亲必须传递 $(0, 1, 1)$。这与父亲的单倍型一致。\n- 如果母亲的相位是可能性B，她可以传递 $(1, 0, 1)$。为了使后代的基因型为 $(0/1, 0/1, 0/1)$，父亲必须传递 $(0, 1, 0)$。这也与父亲的单倍型一致。\n\n由于两种可能性（A和B）都能为后代的基因型提供一个有效的、非重组的解释，我们无法仅根据三联体数据来区分它们。因此，母亲在集合 $\\{S_1, S_2, S_3\\}$ 上的单倍型无法被明确地确定。\n这意味着集合 $\\{S_1, S_2, S_3\\}$ 不是一个单一的单倍型区块。这也意味着集合 $\\{S_2, S_3\\}$ 也不是一个区块，因为问题的根源在于母亲在 $S_2$ 和 $S_3$ 之间的相位不确定性。\n\n4.  **确定区块的最小数量。**\n我们已经确定 $\\{S_1, S_2\\}$ 符合一个区块的条件，并且是最大的，因为更大的集合 $\\{S_1, S_2, S_3\\}$ 不符合条件。这定义了第一个区块。所有标记的集合是 $\\{S_1, S_2, S_3\\}$。第一个区块 $B_1 = \\{S_1, S_2\\}$ 覆盖了前两个标记。剩下的标记 $\\{S_3\\}$ 必须自己形成一个区块 $B_2 = \\{S_3\\}$。单个SNP自然地形成一个单倍型区块，因为其“单倍型”（等位基因）已由基因型给出。\n\n因此，该区域被划分为两个连续的单倍型区块：$\\{S_1, S_2\\}$ 和 $\\{S_3\\}$。这是一个包含 $2$ 个区块的划分。另一种划分方式是 $\\{S_1\\}$、$\\{S_2\\}$、$\\{S_3\\}$，即 $3$ 个区块。问题要求的是区块的最小数量。由于划分为单个区块是不可能的，因此最小区块数量为 $2$。\n\n与数据一致的单倍型区块的最小数量是 $2$。", "answer": "$$\\boxed{2}$$", "id": "2820870"}, {"introduction": "在现代基因组学中定义单倍型块需要严谨的定量方法，并要考虑到抽样变异。本计算练习要求您实现一个标准的统计流程：计算标准化的连锁不平衡度量（$D'$），使用非参数自举法（bootstrapping）估计其置信区间，并应用既定标准将SNP对划分为强连锁不平衡。这项实践有助于培养分析真实世界群体规模数据的基本技能 ([@problem_id:2820833])。", "problem": "给你提供了候选单倍型块内双等位基因单核苷酸多态性 (SNPs) 对的定相单倍型计数数据。对于每个 SNP 对，你必须计算归一化连锁不平衡度量 $D'$ 的非参数自举置信区间，然后根据 Gabriel 准则判断该对是否符合强连锁不平衡的条件。你的程序必须从核心定义和广泛接受的程序出发，实现以下内容：\n\n- 考虑两个双等位基因 SNPs，其等位基因为 $A/a$ 和 $B/b$。设观察到的定相单倍型计数为有序四元组 $\\left[n_{AB}, n_{Ab}, n_{aB}, n_{ab}\\right]$，其中每个 $n_{\\cdot}$ 是一个非负整数计数，染色体总数为 $N = n_{AB} + n_{Ab} + n_{aB} + n_{ab}$。定义单倍型频率为 $f_{AB} = n_{AB}/N$, $f_{Ab} = n_{Ab}/N$, $f_{aB} = n_{aB}/N$, 和 $f_{ab} = n_{ab}/N$，它们满足 $f_{AB} + f_{Ab} + f_{aB} + f_{ab} = 1$。\n- 定义等位基因频率 $p_A = f_{AB} + f_{Ab}$ 和 $p_B = f_{AB} + f_{aB}$。连锁不平衡系数为 $D = f_{AB} - p_A p_B$。\n- 归一化不平衡度 $D'$ 定义为 $D$ 的绝对值，通过其在观察到的等位基因频率下的理论最大值进行缩放，即\n  $$\n  D' = \\begin{cases}\n  \\dfrac{|D|}{\\min\\left(p_A\\left(1-p_B\\right),\\left(1-p_A\\right)p_B\\right)} & \\text{若 } D \\ge 0, \\\\\n  \\dfrac{|D|}{\\min\\left(p_A p_B,\\left(1-p_A\\right)\\left(1-p_B\\right)\\right)} & \\text{若 } D < 0,\n  \\end{cases}\n  $$\n  约定如果分母为 $0$，则 $D'$ 定义为 $0$。根据构造，$D'$ 位于闭区间 $[0,1]$ 内。\n- 为了量化抽样不确定性，请对染色体使用非参数自举法：从包含根据 $\\left[n_{AB}, n_{Ab}, n_{aB}, n_{ab}\\right]$ 重复的四种单倍型的多重集中，有放回地重抽样 $N$ 个单倍型，在重抽样的数据上重新计算 $D'$，并将此过程重复 $R$ 次自举复制，以获得自举样本 $\\{D'_1, D'_2, \\dots, D'_R\\}$。使用百分位数法形成名义覆盖率为 $1-\\alpha$ 的双侧置信区间，方法是取自举样本 $D'$ 值的经验 $\\alpha/2$ 分位数作为下限，经验 $1-\\alpha/2$ 分位数作为上限。\n- 对得到的区间应用 Gabriel 强连锁不平衡准则：如果 $D'$ 的置信区间上限严格大于 $0.98$ 且下限严格大于 $0.7$，则该 SNP 对被归类为强连锁不平衡。\n\n实现规则和所需常量：\n- 使用固定的伪随机数生成器种子 $s = 1729$ 进行自举，以确保结果的确定性。\n- 使用 $R = 5000$ 次自举复制和名义覆盖率为 $1-\\alpha = 0.95$ 的双侧置信区间（即 $\\alpha = 0.05$，因此百分位数分位点在 $0.025$ 和 $0.975$）。\n- 将所有报告的 $D'$ 值和置信界限表示为小数点后精确到三位的小数。不要使用百分号。\n\n测试集：\n- 您必须计算以下五个测试用例的结果，每个用例由单倍型计数四元组 $\\left[n_{AB}, n_{Ab}, n_{aB}, n_{ab}\\right]$ 指定：\n  1. 用例 $\\mathrm{A}$: $\\left[40, 0, 0, 60\\right]$。\n  2. 用例 $\\mathrm{B}$: $\\left[35, 5, 5, 55\\right]$。\n  3. 用例 $\\mathrm{C}$: $\\left[25, 25, 25, 25\\right]$。\n  4. 用例 $\\mathrm{D}$: $\\left[9, 1, 1, 89\\right]$。\n  5. 用例 $\\mathrm{E}$: $\\left[49, 1, 1, 49\\right]$。\n\n输出规格：\n- 对于每个用例，计算由观察计数得出的点估计值 $D'$，在 $\\alpha/2 = 0.025$ 和 $1-\\alpha/2 = 0.975$ 处的自举下限和上限，以及根据 Gabriel 准则的布尔决策。\n- 你的程序应该生成单行输出，包含一个长度为 5 的列表，其中每个元素按 $\\mathrm{A}$ 到 $\\mathrm{E}$ 的顺序对应一个用例。每个元素本身必须是一个形式为 $\\left[\\text{Dprime}, \\text{Lower}, \\text{Upper}, \\text{Strong}\\right]$ 的列表，其中 $\\text{Dprime}$、$\\text{Lower}$ 和 $\\text{Upper}$ 是精确到三位小数的小数，$\\text{Strong}$ 是一个布尔值。例如，两个假设用例的语法有效输出可能看起来像 $\\left[\\left[0.832, 0.701, 0.994, \\mathrm{True}\\right], \\left[0.412, 0.205, 0.673, \\mathrm{False}\\right]\\right]$。你的程序必须为所有五个指定的用例，按照给定顺序，精确输出一行这样的结果。", "solution": "所提出的问题要求实现一个统计程序，以评估单核苷酸多态性 (SNPs) 对之间的连锁不平衡 (LD)。该问题在科学上是有效的、定义明确的，并为得到唯一的、可复现的解决方案提供了所有必要的定义和参数。所描述的方法——计算归一化的连锁不平衡系数 $D'$、使用非参数自举法估计置信区间，以及应用 Gabriel 准则——在群体遗传学领域都是标准且成熟的方法。我将以严谨的方式进行解答。\n\n解决方案的结构如下。首先，我们定义一个函数，根据一组给定的四个单倍型计数来计算归一化连锁不平衡的点估计值 $D'$。其次，我们实现非参数自举程序来生成 $D'$ 值的经验分布。第三，我们使用此分布构建基于百分位数的置信区间。最后，我们将指定的 Gabriel 准则应用于此区间，以确定是否存在强 LD。然后将这整个过程应用于所提供的五个测试用例中的每一个。\n\n**1. 数学公式**\n\n设两个双等位基因位点（等位基因为 $A/a$ 和 $B/b$）的观察到的定相单倍型计数由向量 $\\mathbf{n} = [n_{AB}, n_{Ab}, n_{aB}, n_{ab}]$ 给出。抽样的染色体总数为 $N = \\sum_i n_i = n_{AB} + n_{Ab} + n_{aB} + n_{ab}$。\n\n四种单倍型的频率估计如下：\n$$\nf_{AB} = \\frac{n_{AB}}{N}, \\quad f_{Ab} = \\frac{n_{Ab}}{N}, \\quad f_{aB} = \\frac{n_{aB}}{N}, \\quad f_{ab} = \\frac{n_{ab}}{N}\n$$\n由此，第一个位点上等位基因 $A$ 和第二个位点上等位基因 $B$ 的频率为：\n$$\np_A = f_{AB} + f_{Ab}\n$$\n$$\np_B = f_{AB} + f_{aB}\n$$\n连锁不平衡系数 $D$ 衡量了观察到的单倍型频率 $f_{AB}$ 与连锁平衡时期望的频率 $p_A p_B$ 之间的偏差：\n$$\nD = f_{AB} - p_A p_B\n$$\n$D$ 的值受等位基因频率的限制。为了创建一个标准化的度量，$D$ 通过其可能的最大绝对值 $D_{max}$ 进行归一化，得到 $D'$。$D_{max}$ 的值取决于 $D$ 的符号：\n$$\nD_{max} = \\begin{cases}\n\\min(p_A(1-p_B), (1-p_A)p_B) & \\text{若 } D \\ge 0, \\\\\n\\min(p_A p_B, (1-p_A)(1-p_B)) & \\text{若 } D < 0.\n\\end{cases}\n$$\n归一化的连锁不平衡 $D'$ 定义为：\n$$\nD' = \\frac{|D|}{D_{max}}\n$$\n按照惯例，如果 $D_{max} = 0$，则 $D'$ 定义为 $0$。根据构造，$D' \\in [0, 1]$。\n\n**2. 统计分析的算法实现**\n\n设计一个主函数，我们可以称之为 `compute_d_prime`，用于执行这些计算。为了稳健性和效率，该函数使用 `NumPy` 来实现，以支持向量化操作，从而允许它同时处理一批单倍型计数向量。这对于自举过程尤其有利。\n\n**2.1. 点估计计算**\n对于每个测试用例，我们首先使用 `compute_d_prime` 函数，直接从提供的单倍型计数 $[n_{AB}, n_{Ab}, n_{aB}, n_{ab}]$ 计算 $D'$ 的点估计值。\n\n**2.2. 非参数自举**\n为了量化 $D'$ 点估计值的不确定性，我们采用非参数自举。程序如下：\n- 将 $N$ 个观察到的染色体集合视为一个经验分布。抽取每种单倍型的概率由其观察频率给出，即 $\\mathbf{p} = [f_{AB}, f_{Ab}, f_{aB}, f_{ab}]$。\n- 通过从这个经验分布中有放回地抽取 $N$ 条染色体来生成一个自举样本。这在计算上等同于从一个参数为 $N$ 和概率向量为 $\\mathbf{p}$ 的多项分布中抽取一个大小为 $N$ 的样本。\n- 对于每个计数自举样本，我们重新计算 $D'$ 值。\n- 这个过程重复 $R = 5000$ 次，产生一个 $D'$ 值的自举分布：$\\{D'_1, D'_2, \\dots, D'_R\\}$。\n- 为确保可复现性，伪随机数生成器使用指定的值 $s = 1729$ 进行播种。\n\n所有 $R$ 个自举样本的生成都是通过使用 `numpy.random.default_rng().multinomial(N, p, size=R)` 在一次高效的操作中完成的。随后，对所有 $R$ 个复制样本的 $D'$ 计算以完全向量化的方式执行。\n\n**2.3. 置信区间构建**\n使用百分位数法构建 $D'$ 的 $1 - \\alpha = 0.95$ 置信区间。置信区间的下限和上限分别是排序后的 $D'$ 值自举分布的经验 $\\alpha/2 = 0.025$ 和 $1 - \\alpha/2 = 0.975$ 分位数。这些值使用 `numpy.quantile` 高效计算。\n\n**2.4. 强连锁不平衡的 Gabriel 准则**\n最后，将计算出的置信区间 $[L, U]$ 与 Gabriel 准则进行比较。如果同时满足以下两个条件，一个 SNP 对将被归类为强 LD：\n- 置信下限 $L > 0.7$。\n- 置信上限 $U > 0.98$。\n这将产生一个布尔决策（`True` 或 `False`）。\n\n**3. 输出生成**\n通过迭代五个测试用例来构建最终输出。对于每个用例，计算 $D'$ 的点估计值、置信区间的下限和上限，以及强 LD 的布尔决策。这四个值被格式化为一个列表，其中浮点数表示为精确到三位小数的字符串。然后，所有五个用例的列表被聚合成一个单一的列表，并作为连续的一行文本打印，严格遵守指定的格式。使用格式化字符串（Python中的 f-strings）确保了数值结果的精确表示。", "answer": "```\n[[1.000, 1.000, 1.000, True],[0.792, 0.604, 0.958, False],[0.000, 0.000, 0.470, False],[0.889, 0.667, 1.000, True],[0.960, 0.880, 1.000, True]]\n```", "id": "2820833"}]}