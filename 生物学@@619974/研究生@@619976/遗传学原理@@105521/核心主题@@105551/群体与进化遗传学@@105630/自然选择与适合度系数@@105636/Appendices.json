{"hands_on_practices": [{"introduction": "自然选择的动态变化可以通过数学精确地描述。通过解决这个基础问题，你将直接应用赖特适应度 (Wrightian fitness) 的概念来预测一个简单的单倍体种群在一代选择后的基因型频率。这个练习将巩固你对平均适应度 $\\bar{w}$ 在标准化后代频率中的核心作用的理解，并为分析更复杂的选择情景奠定基础 [@problem_id:2832271]。", "problem": "一个大的、均匀混合的无性单倍体种群由三种基因型组成，索引为 $i \\in \\{1,2,3\\}$。每种基因型 $i$ 都有一个恒定的赖特适应度 $w_i$，该适应度决定了在一个没有突变、迁移或遗传漂变的单一、离散、世代不重叠的生命周期中，其对下一代的预期贡献大小。在第 $t$ 代开始时，基因型频率向量为 $(p_1, p_2, p_3)$，且 $p_1 + p_2 + p_3 = 1$。选择通过差异性生存/繁殖起作用，因此源自基因型 $i$ 的存活后代的预期数量与 $w_i$ 乘以基因型 $i$ 的亲本数量成正比。令 $\\bar{w}$ 表示种群平均适应度（按当前频率加权的各基因型平均个体成功率），并令 $(p_1', p_2', p_3')$ 表示经过选择和归一化后第 $t+1$ 代开始时的基因型频率。\n\n在某特定实验中，第 $t$ 代时，三种基因型的适应度为 $w = (1.00, 1.05, 0.98)$，初始频率为 $(p_1, p_2, p_3) = (0.5, 0.3, 0.2)$。严格根据上述定义（即基因型的贡献与 $w_i$ 成正比，且频率必须归一化为总和为 $1$），计算下一代的频率向量 $(p_1', p_2', p_3')$ 和下一代的平均适应度 $\\bar{w}'$。\n\n将您的最终数值结果以单行向量 $(p_1', p_2', p_3', \\bar{w}')$ 的形式报告，其中每个条目四舍五入到四位有效数字。条目以普通小数形式表示（无百分号）。不应报告其他任何量。", "solution": "该问题提出了一个针对单倍体、无性种群的离散时间种群遗传学标准模型。任务是根据三种基因型的初始频率和适应度值，计算下一代的基因型频率和种群平均适应度。问题陈述具有科学依据，提法恰当，并包含了所有必要信息。因此，该问题是有效的。\n\n设第 $t$ 代的种群由三种基因型的频率向量 $\\boldsymbol{p} = (p_1, p_2, p_3)$ 描述，其中 $\\sum_{i=1}^{3} p_i = 1$。相应的赖特适应度由向量 $\\boldsymbol{w} = (w_1, w_2, w_3)$ 给出。问题陈述指出，每种基因型对后代的预期贡献与其适应度和当前频率成正比。\n\n设第 $t$ 代开始时的总种群大小为 $N$。基因型 $i$ 的个体数量为 $N_i = p_i N$。基因型 $i$ 产生的后代数量，我们记为 $N'_i$，与 $w_i N_i$ 成正比。因此，我们可以写出 $N'_i = C w_i N_i$，其中 $C$ 是一个对所有基因型都相同的比例常数。\n\n在归一化之前，子代中的个体总数是所有基因型的总和：\n$$N' = \\sum_{i=1}^{3} N'_i = \\sum_{i=1}^{3} C w_i N_i = C \\sum_{i=1}^{3} w_i (p_i N) = C N \\sum_{i=1}^{3} w_i p_i$$\n下一代中基因型 $i$ 的频率 $p'_i$ 是其后代数量与后代总数的比率：\n$$p'_i = \\frac{N'_i}{N'} = \\frac{C w_i N_i}{\\sum_{j=1}^{3} C w_j N_j} = \\frac{w_i (p_i N)}{\\sum_{j=1}^{3} w_j (p_j N)}$$\n常数 $C$ 和 $N$ 被约去，得到基本递推关系：\n$$p'_i = \\frac{p_i w_i}{\\sum_{j=1}^{3} p_j w_j}$$\n分母是第 $t$ 代的种群平均适应度，定义为个体适应度的加权平均值：\n$$\\bar{w} = \\sum_{i=1}^{3} p_i w_i$$\n因此，第 $t+1$ 代基因型 $i$ 的频率由下式给出：\n$$p'_i = \\frac{p_i w_i}{\\bar{w}}$$\n第 $t$ 代的给定数据如下：\n- 频率：$(p_1, p_2, p_3) = (0.5, 0.3, 0.2)$\n- 适应度：$(w_1, w_2, w_3) = (1.00, 1.05, 0.98)$\n\n首先，我们计算第 $t$ 代的平均适应度 $\\bar{w}$：\n$$\\bar{w} = p_1 w_1 + p_2 w_2 + p_3 w_3$$\n$$\\bar{w} = (0.5)(1.00) + (0.3)(1.05) + (0.2)(0.98) = 0.500 + 0.315 + 0.196 = 1.011$$\n现在我们可以计算下一代的频率 $(p'_1, p'_2, p'_3)$：\n$$p'_1 = \\frac{p_1 w_1}{\\bar{w}} = \\frac{(0.5)(1.00)}{1.011} = \\frac{0.500}{1.011} \\approx 0.4945598...$$\n$$p'_2 = \\frac{p_2 w_2}{\\bar{w}} = \\frac{(0.3)(1.05)}{1.011} = \\frac{0.315}{1.011} \\approx 0.3115727...$$\n$$p'_3 = \\frac{p_3 w_3}{\\bar{w}} = \\frac{(0.2)(0.98)}{1.011} = \\frac{0.196}{1.011} \\approx 0.1938674...$$\n问题要求将这些值四舍五入到四位有效数字：\n- $p'_1 \\approx 0.4946$\n- $p'_2 \\approx 0.3116$\n- $p'_3 \\approx 0.1939$\n\n接下来，我们必须计算第 $t+1$ 代的种群平均适应度，记为 $\\bar{w}'$。这是使用新计算出的频率 $(p'_1, p'_2, p'_3)$ 来计算的：\n$$\\bar{w}' = p'_1 w_1 + p'_2 w_2 + p'_3 w_3$$\n为避免舍入误差的传播，我们应该代入 $p'_i$ 的精确表达式：\n$$\\bar{w}' = \\sum_{i=1}^{3} p'_i w_i = \\sum_{i=1}^{3} \\left(\\frac{p_i w_i}{\\bar{w}}\\right) w_i = \\frac{1}{\\bar{w}} \\sum_{i=1}^{3} p_i w_i^2$$\n我们首先计算总和 $\\sum_{i=1}^{3} p_i w_i^2$：\n$$\\sum_{i=1}^{3} p_i w_i^2 = (0.5)(1.00)^2 + (0.3)(1.05)^2 + (0.2)(0.98)^2$$\n$$\\sum_{i=1}^{3} p_i w_i^2 = (0.5)(1.0000) + (0.3)(1.1025) + (0.2)(0.9604)$$\n$$\\sum_{i=1}^{3} p_i w_i^2 = 0.50000 + 0.33075 + 0.19208 = 1.02283$$\n现在，我们可以求出 $\\bar{w}'$：\n$$\\bar{w}' = \\frac{1.02283}{1.011} \\approx 1.01170128...$$\n四舍五入到四位有效数字得到：\n- $\\bar{w}' \\approx 1.012$\n\n最终结果是行向量 $(p'_1, p'_2, p'_3, \\bar{w}')$，其中每个条目都四舍五入到四位有效数字。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4946 & 0.3116 & 0.1939 & 1.012\n\\end{pmatrix}\n}\n$$", "id": "2832271"}, {"introduction": "在掌握了单倍体模型后，我们将复杂性提升到二倍体生物，这是大多数动物和植物的遗传基础。这个练习引导你推导在孟德尔遗传和显性效应影响下，等位基因频率如何响应选择压力而改变。通过计算，你将体会到显性系数 $h$ 如何调节杂合子适应度，并最终影响等位基因的进化轨迹 [@problem_id:2832269]。", "problem": "一个大的、随机交配的二倍体群体，在一个常染色体位点上拥有两个等位基因 $A$ 和 $a$。合子通过配子的随机结合而形成，因此在选择之前，基因型频率遵循Hardy–Weinberg平衡（HWE）：$AA$ 为 $p^{2}$，$Aa$ 为 $2pq$，$aa$ 为 $q^{2}$，其中 $p$ 是等位基因 $A$ 的频率，$q=1-p$。接着，生存力选择起作用，各基因型的相对适应度为 $w_{AA}=1+s$，$w_{Aa}=1+hs$ 以及 $w_{aa}=1$，其中 $s$ 是选择系数，$h$ 是显性参数。假设没有其他进化力量，并且成年个体根据其选择后的频率按比例贡献配子。\n\n仅从这些定义出发，推导经过生存力选择后下一代等位基因 $A$ 的频率 $p'$ 的表达式，并计算当 $p=0.3$，$s=0.02$ 和 $h=0.25$ 时的值。将最终数值答案表示为四舍五入到四位有效数字的小数。", "solution": "题目要求从第一性原理出发，推导在生存力选择下下一代等位基因频率 $p'$ 的表达式。随后，必须对一组特定参数计算该表达式的值。\n\n群体的初始状态由一个具有两个等位基因 $A$ 和 $a$ 的单一基因座的Hardy-Weinberg平衡（HWE）频率来描述。设 $p$ 为等位基因 $A$ 的频率，$q=1-p$ 为等位基因 $a$ 的频率。合子阶段（选择前）的基因型频率为：\n- $AA$ 的频率：$f_{zygote}(AA) = p^2$\n- $Aa$ 的频率：$f_{zygote}(Aa) = 2pq$\n- $aa$ 的频率：$f_{zygote}(aa) = q^2$\n\n生存力选择作用于这些基因型。相对适应度给定为 $w_{AA} = 1+s$，$w_{Aa} = 1+hs$ 和 $w_{aa} = 1$。存活成年个体中每种基因型的频率，与其初始频率乘以其相对适应度成正比。为了得到成年基因型的真实频率，我们必须用它们的总和来归一化这些乘积。这个总和是群体的平均适应度 $\\bar{w}$。\n\n平均适应度 $\\bar{w}$ 是基因型适应度的加权平均值，其中权重是HWE基因型频率：\n$$ \\bar{w} = f_{zygote}(AA) \\cdot w_{AA} + f_{zygote}(Aa) \\cdot w_{Aa} + f_{zygote}(aa) \\cdot w_{aa} $$\n代入给定的表达式，我们有：\n$$ \\bar{w} = p^2(1+s) + 2pq(1+hs) + q^2(1) $$\n\n存活下来繁殖的成年群体中的基因型频率为：\n- 成年 $AA$ 的频率：$f_{adult}(AA) = \\frac{p^2 w_{AA}}{\\bar{w}} = \\frac{p^2(1+s)}{\\bar{w}}$\n- 成年 $Aa$ 的频率：$f_{adult}(Aa) = \\frac{2pq w_{Aa}}{\\bar{w}} = \\frac{2pq(1+hs)}{\\bar{w}}$\n- 成年 $aa$ 的频率：$f_{adult}(aa) = \\frac{q^2 w_{aa}}{\\bar{w}} = \\frac{q^2}{\\bar{w}}$\n\n下一代 $A$ 的等位基因频率 $p'$，是这些存活的成年个体产生的配子池中 $A$ 等位基因的频率。假设遵循Mendelian遗传学，纯合子 $AA$ 个体只产生 $A$ 配子，而杂合子 $Aa$ 个体以相等的比例（各 $1/2$）产生 $A$ 和 $a$ 配子。因此，$p'$ 是成年 $AA$ 个体频率与成年 $Aa$ 个体频率的一半之和：\n$$ p' = f_{adult}(AA) + \\frac{1}{2} f_{adult}(Aa) $$\n代入成年个体频率的表达式：\n$$ p' = \\frac{p^2 w_{AA}}{\\bar{w}} + \\frac{1}{2} \\left( \\frac{2pq w_{Aa}}{\\bar{w}} \\right) = \\frac{p^2 w_{AA} + pq w_{Aa}}{\\bar{w}} $$\n从分子中提出因子 $p$ 得到另一种形式：\n$$ p' = \\frac{p(p w_{AA} + q w_{Aa})}{\\bar{w}} $$\n代入 $\\bar{w}$ 的完整表达式和具体的适应度值，我们得到下一代等位基因频率的通用公式：\n$$ p' = \\frac{p^2(1+s) + pq(1+hs)}{p^2(1+s) + 2pq(1+hs) + q^2} $$\n推导到此结束。\n\n接下来，我们必须计算在给定 $p=0.3$，$s=0.02$ 和 $h=0.25$ 的情况下 $p'$ 的数值。\n首先，我们确定等位基因 $a$ 的频率：$q = 1-p = 1-0.3 = 0.7$。\n\n我们计算 $p'$ 表达式的分子：\n$$ \\text{Numerator} = p^2(1+s) + pq(1+hs) $$\n$$ \\text{Numerator} = (0.3)^2(1+0.02) + (0.3)(0.7)(1+(0.25)(0.02)) $$\n$$ \\text{Numerator} = (0.09)(1.02) + (0.21)(1+0.005) $$\n$$ \\text{Numerator} = (0.09)(1.02) + (0.21)(1.005) $$\n$$ \\text{Numerator} = 0.0918 + 0.21105 = 0.30285 $$\n\n接下来，我们计算分母，也就是平均适应度 $\\bar{w}$：\n$$ \\bar{w} = p^2(1+s) + 2pq(1+hs) + q^2 $$\n$$ \\bar{w} = (0.3)^2(1+0.02) + 2(0.3)(0.7)(1.005) + (0.7)^2 $$\n$$ \\bar{w} = 0.0918 + (0.42)(1.005) + 0.49 $$\n$$ \\bar{w} = 0.0918 + 0.4221 + 0.49 = 1.0039 $$\n\n最后，我们通过将分子除以分母来计算 $p'$：\n$$ p' = \\frac{0.30285}{1.0039} \\approx 0.3016635123... $$\n题目要求结果四舍五入到四位有效数字。第五位有效数字是 $6$，所以我们将第四位向上取整。\n$$ p' \\approx 0.3017 $$", "answer": "$$ \\boxed{0.3017} $$", "id": "2832269"}, {"introduction": "自然选择不仅仅导致有利等位基因的固定，它同样可以维持种群内的遗传多样性。此实践聚焦于一种重要的平衡选择机制——超显性 (overdominance)，即杂合子拥有最高适应度。你将通过推导平衡点的条件，计算出等位基因频率达到稳定共存时的具体数值，从而深入理解选择如何在进化过程中维持变异 [@problem_id:2832267]。", "problem": "考虑一个极大的、随机交配的二倍体种群，其世代离散不重叠，在具有两个等位基因 $A$ 和 $a$ 的单个基因座上受到生存力选择的影响。假定在每一代中，选择之前的群体都处于哈代-温伯格平衡（HWE）状态。基因型的相对生存力分别为 $w_{AA}=0.9$、$w_{Aa}=1$ 和 $w_{aa}=0.8$。设 $p$ 表示选择前合子中等位基因 $A$ 的频率，$q=1-p$。\n\n从相对适合度、平均适合度和生存力选择下的等位基因频率递归式的基本定义出发（该递归式通过以基因型频率乘以其相对适合度进行加权，并以平均适合度进行归一化得到），完成以下任务：\n\n1. 在超显性（即杂合子具有最高生存力）条件下，推导表征任意内部平衡等位基因频率 $p^{*}\\in(0,1)$ 的条件，并用适合度参数表示。\n2. 使用该条件，根据给定的适合度值，确定内部平衡等位基因频率 $p^{*}$。\n3. 计算在此平衡频率下的平均适合度 $\\bar{w}$。\n\n最终答案只报告平衡时的平均适合度，并表示为一个精确的有理数。不要包含任何单位。", "solution": "所提出的问题是理论群体遗传学中的一道标准习题，其定义明确。下面我们来解答此题。\n\n二倍体种群中生存力选择的基本原理是，不同的基因型以不同的速率从合子阶段存活到成年阶段。这些差异存活率由相对适合度（或称生存力）来量化，我们将其表示为 $w_{AA}$、$w_{Aa}$ 和 $w_{aa}$。\n\n我们首先考虑一个随机交配的极大种群。在这些条件下，任何一代中合子的基因型频率由哈代-温伯格比例给出：\n- $AA$ 合子的频率：$f(AA)_{zygotes} = p^2$\n- $Aa$ 合子的频率：$f(Aa)_{zygotes} = 2pq$\n- $aa$ 合子的频率：$f(aa)_{zygotes} = q^2$\n其中 $p$ 是上一代基因库中等位基因 $A$ 的频率，$q = 1-p$ 是等位基因 $a$ 的频率。\n\n经过选择后，存活下来的成年个体中三种基因型的频率与它们的初始频率乘以各自的相对生存力成正比。\n- $AA$ 成年个体的比例频率 $\\propto p^2 w_{AA}$\n- $Aa$ 成年个体的比例频率 $\\propto 2pq w_{Aa}$\n- $aa$ 成年个体的比例频率 $\\propto q^2 w_{aa}$\n\n这些比例频率的总和给出了种群的平均适合度 $\\bar{w}$，该值作为归一化常数，使得存活成年个体的频率之和等于 $1$。\n$$ \\bar{w} = p^2 w_{AA} + 2pq w_{Aa} + q^2 w_{aa} $$\n\n下一代中等位基因 $A$ 的频率，记为 $p'$，是存活成年个体产生的配子中等位基因 $A$ 的频率。由于 $AA$ 个体只产生 $A$ 配子，而 $Aa$ 个体以 $1/2$ 的频率产生 $A$ 配子，因此频率 $p'$ 由 $AA$ 成年个体的频率加上 $Aa$ 成年个体频率的一半给出。\n$$ p' = \\frac{p^2 w_{AA} + \\frac{1}{2}(2pq w_{Aa})}{\\bar{w}} = \\frac{p^2 w_{AA} + pq w_{Aa}}{\\bar{w}} = \\frac{p(p w_{AA} + q w_{Aa})}{\\bar{w}} $$\n此方程即为生存力选择下的等位基因频率递归式。\n\n平衡是一种等位基因频率在代际间不发生变化的状态，即 $p' = p$。每代等位基因频率的变化为 $\\Delta p = p' - p$。\n$$ \\Delta p = \\frac{p(p w_{AA} + q w_{Aa})}{\\bar{w}} - p = \\frac{p(p w_{AA} + q w_{Aa}) - p\\bar{w}}{\\bar{w}} $$\n我们可以用等位基因的平均适合度来表示 $\\bar{w}$，即 $\\bar{w}_A = p w_{AA} + q w_{Aa}$ 和 $\\bar{w}_a = p w_{Aa} + q w_{aa}$，使得 $\\bar{w} = p \\bar{w}_A + q \\bar{w}_a$。\n将此代入 $\\Delta p$ 的表达式：\n$$ \\Delta p = \\frac{p \\bar{w}_A - p(p\\bar{w}_A + q\\bar{w}_a)}{\\bar{w}} = \\frac{p \\bar{w}_A (1 - p) - pq\\bar{w}_a}{\\bar{w}} = \\frac{pq(\\bar{w}_A - \\bar{w}_a)}{\\bar{w}} $$\n当 $p=0$，$q=0$（即 $p=1$），或 $\\bar{w}_A - \\bar{w}_a = 0$ 时，达到平衡（$\\Delta p = 0$）。前两种是一个等位基因被固定的平凡平衡点。内部平衡，即两个等位基因都在种群中得以维持（$p^* \\in (0,1)$），需要满足第三个条件：\n$$ \\bar{w}_A = \\bar{w}_a $$\n这是内部平衡的一般条件。\n\n1. 为了用适合度参数推导平衡等位基因频率 $p^*$，我们求解这个条件：\n$$ p^* w_{AA} + (1-p^*) w_{Aa} = p^* w_{Aa} + (1-p^*) w_{aa} $$\n重新整理各项以求解 $p^*$：\n$$ p^*(w_{AA} - w_{Aa}) + w_{Aa} = p^*(w_{Aa} - w_{aa}) + w_{aa} $$\n$$ w_{Aa} - w_{aa} = p^*(w_{Aa} - w_{aa} - (w_{AA} - w_{Aa})) $$\n$$ w_{Aa} - w_{aa} = p^*(2w_{Aa} - w_{AA} - w_{aa}) $$\n这就得出了内部平衡等位基因频率的表达式：\n$$ p^* = \\frac{w_{Aa} - w_{aa}}{2w_{Aa} - w_{AA} - w_{aa}} $$\n在超显性条件下，即 $w_{Aa} > w_{AA}$ 且 $w_{Aa} > w_{aa}$ 时，该平衡是稳定的。在这种情况下，分子（$w_{Aa} - w_{aa}$）和分母（$(w_{Aa} - w_{AA}) + (w_{Aa} - w_{aa})$）都为正，确保了 $p^* > 0$。同样可以证明 $p^* < 1$。\n\n2. 现在我们使用给定的适合度值：$w_{AA}=0.9$，$w_{Aa}=1$ 和 $w_{aa}=0.8$。这些值对应于超显性。我们将它们代入推导出的 $p^*$ 公式中：\n$$ p^* = \\frac{1 - 0.8}{2(1) - 0.9 - 0.8} = \\frac{0.2}{2 - 1.7} = \\frac{0.2}{0.3} = \\frac{2}{3} $$\n等位基因 $A$ 的内部平衡频率是 $p^* = 2/3$。因此，等位基因 $a$ 的平衡频率是 $q^* = 1 - p^* = 1/3$。\n\n3. 最后，我们计算种群在此平衡点上的平均适合度 $\\bar{w}^*$。在平衡时，我们有恒等式 $\\bar{w}^* = \\bar{w}_A = \\bar{w}_a$。我们可以使用任何一个表达式。让我们使用 $\\bar{w}_A = p w_{AA} + q w_{Aa}$：\n$$ \\bar{w}^* = p^* w_{AA} + q^* w_{Aa} = \\left(\\frac{2}{3}\\right)(0.9) + \\left(\\frac{1}{3}\\right)(1) $$\n$$ \\bar{w}^* = \\left(\\frac{2}{3}\\right)\\left(\\frac{9}{10}\\right) + \\frac{1}{3} = \\frac{18}{30} + \\frac{1}{3} = \\frac{3}{5} + \\frac{1}{3} $$\n为了将这些分数相加，我们找到公分母 $15$：\n$$ \\bar{w}^* = \\frac{9}{15} + \\frac{5}{15} = \\frac{14}{15} $$\n这是在稳定内部平衡点上的平均适合度，表示为一个精确的有理数。\n作为验算，我们可以使用完整表达式计算 $\\bar{w}^*$：\n$$ \\bar{w}^* = (p^*)^2 w_{AA} + 2p^*q^* w_{Aa} + (q^*)^2 w_{aa} = \\left(\\frac{2}{3}\\right)^2(0.9) + 2\\left(\\frac{2}{3}\\right)\\left(\\frac{1}{3}\\right)(1) + \\left(\\frac{1}{3}\\right)^2(0.8) $$\n$$ \\bar{w}^* = \\left(\\frac{4}{9}\\right)\\left(\\frac{9}{10}\\right) + \\frac{4}{9} + \\left(\\frac{1}{9}\\right)\\left(\\frac{8}{10}\\right) = \\frac{36}{90} + \\frac{40}{90} + \\frac{8}{90} = \\frac{84}{90} = \\frac{14}{15} $$\n结果是一致的。", "answer": "$$\\boxed{\\frac{14}{15}}$$", "id": "2832267"}]}