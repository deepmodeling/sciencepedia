{"hands_on_practices": [{"introduction": "多倍体生物学的基础在于理解其独特的遗传机制，而这一切都始于减数分裂。与二倍体不同，同源四倍体中的配子形成过程更为复杂。本练习将引导你从第一性原理出发，推导一个特定四倍体基因型所产生的配子频率，并进一步引入“双重还原”（double reduction）这一多倍体减数分裂特有的现象，让你亲身体验如何将复杂的生物学过程转化为精确的数学模型。[@problem_id:2793967]", "problem": "一个同源四倍体个体，其常染色体上单个基因座的基因型为 $Aaaa$。假设在该基因座上进行四体遗传，减数分裂中染色体随机分离，且配子为二体（每个配子携带从 $4$ 条同源染色体中抽取的 $2$ 个等位基因拷贝）。\n\n仅使用以下基本依据：\n- 推广到多体系统的 Mendel 分离定律：在没有特殊机制的情况下，等位基因拷贝分离，使得每个配子接收到正确的倍性。\n- 在同源四倍体中，当染色体随机分离且无双重减数时，一个基因座上的两个等位基因拷贝由两条不同的同源染色体贡献，并且 $4$ 条同源染色体中任意无序的一对染色体共同分离进入一个配子的可能性均等。\n- 双重减数定义为：由于多价体配对以及基因座和着丝粒之间发生交换，导致一个基因座上的两个等位基因拷贝来源于同一条减数分裂前同源染色体的姐妹染色单体。\n\n任务：\n1. 在染色体随机分离且无双重减数的情况下，根据第一性原理推导由 $Aaaa$ 同源四倍体产生的二体配子的基因型频率，即 $\\Pr(AA)$、$\\Pr(Aa)$ 和 $\\Pr(aa)$。\n2. 扩展推导，引入每个配子的双重减数率 $\\alpha$，其定义为在目标基因座上，配子中的两个等位基因拷贝均来源于同一条减数分裂前同源染色体（即发生双重减数）的概率。假设在双重减数发生的条件下，$4$ 条同源染色体中任意一条成为这两个等位基因拷贝来源的可能性均等。使用全概率定律，以 $\\alpha$ 为函数，求出 $\\Pr(AA)$、$\\Pr(Aa)$ 和 $\\Pr(aa)$ 的闭式表达式。\n\n将您的最终答案表示为单个行向量 $\\big[\\Pr(AA)\\;\\;\\Pr(Aa)\\;\\;\\Pr(aa)\\big]$，其中包含以 $\\alpha$ 表示的简化精确表达式。无需四舍五入。不包含任何单位。", "solution": "所述问题具有科学依据、提法明确且客观。它提出了一个标准、可形式化的多体遗传模型，并为推导唯一解提供了所有必要的定义和约束。我们将开始推导。\n\n设同源四倍体基因型为 $Aaaa$。我们可以将四条同源染色体表示为 $C_1, C_2, C_3, C_4$。不失一般性，设染色体 $C_1$ 上的等位基因为 $A$，染色体 $C_2, C_3$, 和 $C_4$ 上的等位基因为 $a$。二体配子由从这四个等位基因中抽取的两个组成。\n\n首先，我们解决任务 $1$：在染色体随机分离且无双重减数的假设下，推导配子基因型频率。\n问题指出，在没有双重减数的情况下，二体配子由取样两条不同的同源染色体形成。从四条可用染色体中选择一个无序对的总方式数由二项式系数 $\\binom{4}{2}$ 给出。\n$$ \\binom{4}{2} = \\frac{4!}{2!(4-2)!} = \\frac{4 \\times 3}{2} = 6 $$\n这六种等可能的染色体组合决定了最终的配子基因型：\n$1$. $\\{C_1, C_2\\}$，携带等位基因 $\\{A, a\\}$，产生 $Aa$ 配子。\n$2$. $\\{C_1, C_3\\}$，携带等位基因 $\\{A, a\\}$，产生 $Aa$ 配子。\n$3$. $\\{C_1, C_4\\}$，携带等位基因 $\\{A, a\\}$，产生 $Aa$ 配子。\n$4$. $\\{C_2, C_3\\}$，携带等位基因 $\\{a, a\\}$，产生 $aa$ 配子。\n$5$. $\\{C_2, C_4\\}$，携带等位基因 $\\{a, a\\}$，产生 $aa$ 配子。\n$6$. $\\{C_3, C_4\\}$，携带等位基因 $\\{a, a\\}$，产生 $aa$ 配子。\n\n我们计算导致每种配子基因型的组合数：\n- 形成 $AA$ 配子，必须选择两条携带 $A$ 的染色体。由于只有一条这样的染色体（$C_1$），这是不可能的。计数为 $0$。\n- 形成 $Aa$ 配子，必须选择一条带 $A$ 的染色体和一条带 $a$ 的染色体。选择带 $A$ 的染色体有 $\\binom{1}{1}$ 种方式，选择带 $a$ 的染色体有 $\\binom{3}{1}$ 种方式。计数为 $\\binom{1}{1}\\binom{3}{1} = 1 \\times 3 = 3$。\n- 形成 $aa$ 配子，必须选择两条带 $a$ 的染色体。有 $3$ 条这样的染色体。计数为 $\\binom{3}{2} = 3$。\n\n总计数为 $0 + 3 + 3 = 6$，与我们的总组合数相符。令 $DR^c$ 表示无双重减数事件。在 $DR^c$ 条件下的概率为：\n$$ \\Pr(AA | DR^c) = \\frac{0}{6} = 0 $$\n$$ \\Pr(Aa | DR^c) = \\frac{3}{6} = \\frac{1}{2} $$\n$$ \\Pr(aa | DR^c) = \\frac{3}{6} = \\frac{1}{2} $$\n这就完成了第一个任务。\n\n接下来，我们解决任务 $2$：引入双重减数率 $\\alpha$。\n我们将使用全概率定律。对于任意配子基因型 $G \\in \\{AA, Aa, aa\\}$，其总概率为：\n$$ \\Pr(G) = \\Pr(G | DR) \\Pr(DR) + \\Pr(G | DR^c) \\Pr(DR^c) $$\n我们已知 $\\Pr(DR) = \\alpha$，其中 $DR$ 是双重减数事件。因此，$\\Pr(DR^c) = 1 - \\alpha$。\n\n我们必须确定在双重减数条件下的配子概率，即 $\\Pr(G | DR)$。双重减数是指配子中的两个等位基因拷贝均来源于同一条减数分裂前的同源染色体。问题规定，在 $DR$ 条件下，4 条同源染色体（带等位基因 $A$ 的 $C_1$；带等位基因 $a$ 的 $C_2, C_3, C_4$）中每一条成为来源的可能性均等。\n- 如果来源同源染色体是 $C_1$（携带 $A$），则配子接收到两个 $A$ 等位基因，形成一个 $AA$ 配子。此事件的概率为 $\\frac{1}{4}$。\n- 如果来源同源染色体是 $C_2, C_3,$ 或 $C_4$（均携带 $a$），则配子接收到两个 $a$ 等位基因，形成一个 $aa$ 配子。此事件的概率为 $\\frac{3}{4}$。\n- 通过双重减数形成 $Aa$配子是不可能的，因为它需要来自不同同源染色体的等位基因。\n\n因此，在双重减数条件下的概率为：\n$$ \\Pr(AA | DR) = \\frac{1}{4} $$\n$$ \\Pr(Aa | DR) = 0 $$\n$$ \\Pr(aa | DR) = \\frac{3}{4} $$\n\n现在，我们将这些条件概率代入每种配子基因型的全概率定律中。\n\n对于 $AA$ 配子：\n$$ \\Pr(AA) = \\Pr(AA | DR) \\alpha + \\Pr(AA | DR^c) (1 - \\alpha) $$\n$$ \\Pr(AA) = \\left(\\frac{1}{4}\\right)\\alpha + (0)(1 - \\alpha) = \\frac{1}{4}\\alpha $$\n\n对于 $Aa$ 配子：\n$$ \\Pr(Aa) = \\Pr(Aa | DR) \\alpha + \\Pr(Aa | DR^c) (1 - \\alpha) $$\n$$ \\Pr(Aa) = (0)\\alpha + \\left(\\frac{1}{2}\\right)(1 - \\alpha) = \\frac{1}{2}(1 - \\alpha) $$\n\n对于 $aa$ 配子：\n$$ \\Pr(aa) = \\Pr(aa | DR) \\alpha + \\Pr(aa | DR^c) (1 - \\alpha) $$\n$$ \\Pr(aa) = \\left(\\frac{3}{4}\\right)\\alpha + \\left(\\frac{1}{2}\\right)(1 - \\alpha) $$\n$$ \\Pr(aa) = \\frac{3}{4}\\alpha + \\frac{1}{2} - \\frac{1}{2}\\alpha = \\frac{1}{2} + \\left(\\frac{3}{4} - \\frac{2}{4}\\right)\\alpha = \\frac{1}{2} + \\frac{1}{4}\\alpha $$\n\n为了验证正确性，我们确认这些概率之和为 $1$：\n$$ \\Pr(AA) + \\Pr(Aa) + \\Pr(aa) = \\left(\\frac{1}{4}\\alpha\\right) + \\left(\\frac{1}{2} - \\frac{1}{2}\\alpha\\right) + \\left(\\frac{1}{2} + \\frac{1}{4}\\alpha\\right) $$\n$$ = \\left(\\frac{1}{4} - \\frac{2}{4} + \\frac{1}{4}\\right)\\alpha + \\left(\\frac{1}{2} + \\frac{1}{2}\\right) = (0)\\alpha + 1 = 1 $$\n推导逻辑上是一致的。所要求的结果是这三个概率组成的行向量。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{4}\\alpha & \\frac{1}{2}(1 - \\alpha) & \\frac{1}{2} + \\frac{1}{4}\\alpha\n\\end{pmatrix}\n}\n$$", "id": "2793967"}, {"introduction": "在掌握了单个多倍体个体如何产生配子后，下一步自然是探究这些遗传规则在群体层面会产生怎样的后果。本练习将经典的哈迪-温伯格（Hardy-Weinberg）平衡原理扩展到同源四倍体群体，要求你推导其基因型频率。通过将四倍体的总杂合度与具有相同等位基因频率的二倍体进行比较，你将定量地揭示多倍体在群体中维持更高水平遗传变异的关键机制。[@problem_id:2793984]", "problem": "在一个具有四体遗传的同源四倍体植物物种中，假设存在一个无限大的种群，进行随机交配，且没有选择、迁移和突变。进一步假设减数分裂过程中没有发生双减数，且染色体随机分离，因此配子携带从亲本4条同源染色体中无放回抽取的2个基因拷贝。\n\n考虑一个具有等位基因 $A$ 和 $a$ 的单一位点，并设 $A$ 在种群中的等位基因频率为 $p$（因此 $a$ 的频率为 $q = 1 - p$）。Hardy–Weinberg平衡（HWE）指的是在配子随机结合的条件下，基因型频率完全由等位基因频率决定的状态。\n\n仅使用Mendelian分离、随机交配的基本原理，以及扩展到无双减数的多体遗传的HWE定义，完成以下任务：\n\n1. 推导同源四倍体的合子HWE基因型比例，按等位基因剂量类别 $A^4$、$A^3a$、$A^2a^2$、$Aa^3$ 和 $a^4$ 进行分组，并表示为 $p$ 和 $q$ 的函数。\n2. 推导具有相同等位基因频率 $p$ 的二倍体的相应HWE基因型比例。\n3. 将二倍体的总杂合度定义为杂合子 $Aa$ 的频率，将同源四倍体的总杂合度定义为所有混合剂量基因型（即同时包含 $A$ 和 $a$ 的基因型）的总频率，即 $A^3a$、$A^2a^2$ 和 $Aa^3$。根据你推导出的基因型比例，计算同源四倍体与二倍体之间总杂合度的差异，并将其表示为仅关于 $p$ 的函数。\n\n请以单个简化的、关于 $p$ 的解析表达式的形式提供最终答案。无需四舍五入。不包括单位。", "solution": "问题陈述具有科学依据、提法恰当、客观，并包含足够的信息以得出唯一解。这是理论群体遗传学中的一个标准问题。我们可以开始推导。\n\n该问题要求基于扩展到同源四倍体种群的Hardy-Weinberg平衡（HWE）原理，进行一个包含三部分的推导。\n\n第1部分：同源四倍体HWE基因型比例\n\n对于同源四倍体生物，HWE基因型频率由等位基因随机组合形成四倍体合子来决定。给定一个双等位基因座，其等位基因 $A$ 和 $a$ 的种群频率分别为 $p$ 和 $q=1-p$，合子的形成等同于从基因库中随机抽取4个等位基因。因此，一个合子中等位基因 $A$ 的数量服从参数为 $n=4$（倍性水平）和概率为 $p$（等位基因 $A$ 的频率）的二项分布。\n\n一个合子恰好拥有 $k$ 个拷贝的等位基因 $A$ 和 $4-k$ 个拷贝的等位基因 $a$ 的概率由以下二项式公式给出：\n$$ P(\\text{Genotype with } k \\text{ copies of } A) = \\binom{4}{k} p^k q^{4-k} $$\n\n使用此原理，我们推导五种可能的基因型类别的频率：\n\n1.  基因型 $A^4$（等位基因剂量 $A^4$）：这对应于 $k=4$ 个拷贝的等位基因 $A$。\n    $$ \\text{freq}(A^4) = \\binom{4}{4} p^4 q^{4-4} = 1 \\cdot p^4 \\cdot q^0 = p^4 $$\n\n2.  基因型 $A^3a$（等位基因剂量 $A^3a$）：这对应于 $k=3$ 个拷贝的等位基因 $A$。\n    $$ \\text{freq}(A^3a) = \\binom{4}{3} p^3 q^{4-3} = 4 p^3 q $$\n\n3.  基因型 $A^2a^2$（等位基因剂量 $A^2a^2$）：这对应于 $k=2$ 个拷贝的等位基因 $A$。\n    $$ \\text{freq}(A^2a^2) = \\binom{4}{2} p^2 q^{4-2} = 6 p^2 q^2 $$\n\n4.  基因型 $Aa^3$（等位基因剂量 $Aa^3$）：这对应于 $k=1$ 个拷贝的等位基因 $A$。\n    $$ \\text{freq}(Aa^3) = \\binom{4}{1} p^1 q^{4-1} = 4 p q^3 $$\n\n5.  基因型 $a^4$（等位基因剂量 $a^4$）：这对应于 $k=0$ 个拷贝的等位基因 $A$。\n    $$ \\text{freq}(a^4) = \\binom{4}{0} p^0 q^{4-0} = 1 \\cdot p^0 \\cdot q^4 = q^4 $$\n\n这些频率代表了 $(p+q)^4$ 的展开式，这与无双减数的同源四倍体中HWE的预期相符。\n\n第2部分：二倍体HWE基因型比例\n\n对于二倍体生物，适用相同的原理，但倍性水平为 $n=2$。该过程等同于从基因库中随机抽取2个等位基因。基因型频率遵循 $(p+q)^2$ 的二项展开式。\n\n1.  基因型 $AA$：\n    $$ \\text{freq}(AA) = \\binom{2}{2} p^2 q^0 = p^2 $$\n\n2.  基因型 $Aa$:\n    $$ \\text{freq}(Aa) = \\binom{2}{1} p^1 q^1 = 2pq $$\n\n3.  基因型 $aa$：\n    $$ \\text{freq}(aa) = \\binom{2}{0} p^0 q^2 = q^2 $$\n\n第3部分：总杂合度的差异\n\n首先，我们按照规定为两种倍性水平定义总杂合度。\n\n二倍体种群中的总杂合度 $H_{diploid}$ 是单个杂合基因型 $Aa$ 的频率。\n$$ H_{diploid} = \\text{freq}(Aa) = 2pq $$\n\n同源四倍体种群中的总杂合度 $H_{tetraploid}$ 是所有同时包含等位基因 $A$ 和 $a$ 的基因型的总频率。\n$$ H_{tetraploid} = \\text{freq}(A^3a) + \\text{freq}(A^2a^2) + \\text{freq}(Aa^3) $$\n$$ H_{tetraploid} = 4p^3q + 6p^2q^2 + 4pq^3 $$\n一个等效且更简单的方法是将其计算为1减去纯合基因型（$A^4$ 和 $a^4$）的总频率。\n$$ H_{tetraploid} = 1 - (\\text{freq}(A^4) + \\text{freq}(a^4)) = 1 - (p^4 + q^4) $$\n\n接下来，我们通过代入 $q = 1-p$ 来计算差值 $\\Delta H = H_{tetraploid} - H_{diploid}$，使其成为仅关于 $p$ 的函数。\n$$ \\Delta H = [1 - (p^4 + (1-p)^4)] - [2p(1-p)] $$\n我们必须使用二项式定理展开项 $(1-p)^4$：\n$$ (1-p)^4 = \\binom{4}{0}1^4(-p)^0 + \\binom{4}{1}1^3(-p)^1 + \\binom{4}{2}1^2(-p)^2 + \\binom{4}{3}1^1(-p)^3 + \\binom{4}{4}1^0(-p)^4 $$\n$$ (1-p)^4 = 1 - 4p + 6p^2 - 4p^3 + p^4 $$\n现在，将此展开式代回 $\\Delta H$ 的表达式中。\n$$ \\Delta H = 1 - [p^4 + (1 - 4p + 6p^2 - 4p^3 + p^4)] - [2p - 2p^2] $$\n$$ \\Delta H = 1 - [1 - 4p + 6p^2 - 4p^3 + 2p^4] - 2p + 2p^2 $$\n分配负号。\n$$ \\Delta H = 1 - 1 + 4p - 6p^2 + 4p^3 - 2p^4 - 2p + 2p^2 $$\n最后，整理并合并同类项，得到关于 $p$ 的简化多项式。\n$$ \\Delta H = (-2p^4) + (4p^3) + (-6p^2 + 2p^2) + (4p - 2p) + (1 - 1) $$\n$$ \\Delta H = -2p^4 + 4p^3 - 4p^2 + 2p $$\n这就是同源四倍体和二倍体种群之间总杂合度的差异关于等位基因频率 $p$ 的最终简化解析表达式。", "answer": "$$\n\\boxed{-2p^4 + 4p^3 - 4p^2 + 2p}\n$$", "id": "2793984"}, {"introduction": "除了改变遗传和群体动态，多倍化也是宏观进化的一个主要驱动力，尤其是在异源多倍体中。全基因组复制事件之后，基因组通常会经历一个“分馏”（fractionation）过程，即大规模的基因丢失，而这一过程往往并非随机。本练习将带你进入计算演化基因组学的前沿，通过编写代码实现一个似然比检验，来检测异源多倍体中两个亚基因组之间是否存在偏向性的基因丢失，从而将一个重要的生物学假说转化为可操作的统计模型。[@problem_id:2794031]", "problem": "您的任务是，使用全基因组共线性数据，形式化并实现一个统计检验，以检测异源多倍体中两个亚基因组间的偏向性基因丢失（也称为偏向性分化）。生物学背景如下：一次全基因组复制事件为每个祖先基因座产生了两个异源同源拷贝，此处分别记为亚基因组A和亚基因组B上的拷贝。随着时间的推移，基因丢失事件会发生。全基因组共线性作图使得每个祖先基因座能够被归类为四种可观察状态之一：仅在A上保留（A上的单拷贝），仅在B上保留（B上的单拷贝），在两者上均保留（重复拷贝），或在两者上均丢失（未观察到）。为避免后两种状态引入的无关参数，您将仅基于观察为单拷贝的基因座来进行检验。\n\n基本原理与假设：\n- 全基因组复制后，每个祖先基因座产生两个异源同源拷贝，一个在亚基因组A上，一个在亚基因组B上。在共享进化过程的条件下，这些异源同源基因座在基因组上是独立的，这在许多植物异源多倍体中是一个很好的近似。\n- 在亚基因组间丢失率相等的零模型下，对于某个基因座恰好只保留一个拷贝的事件，其拷贝保留在亚基因-组A上的概率等于保留在亚基因组B上的概率。这意味着，当只考虑单拷贝时，对于“A上保留的单拷贝”事件，这是一个成功概率为 $p_{0} = 1/2$ 的对称伯努利过程。\n- 在偏向性丢失的备择模型下，对于单拷贝事件，保留的拷贝位于亚基因组A上的概率是一个未知参数 $p \\in (0,1)$。\n\n数学形式化：\n- 设有 $m$ 个共线性区块。在区块 $i \\in \\{1,\\dots,m\\}$ 中，您观察到亚基因组A上有 $x_{i}$ 个单拷贝，亚基因组B上有 $y_{i}$ 个单拷贝。定义总计数为 $X = \\sum_{i=1}^{m} x_{i}$，$Y = \\sum_{i=1}^{m} y_{i}$，以及 $n = X + Y$。\n- 在给定 $n$ 的条件下，并假设在“仅单拷贝”子集中各基因座的贡献是独立同分布的，则 $p$ 的充分统计量是 $X \\sim \\mathrm{Binomial}(n, p)$。零假设为 $H_{0}: p = 1/2$。备择假设为 $H_{1}: p \\neq 1/2$。\n- 对数似然（在不依赖于 $p$ 的一个加性常数范围内）为 $\\ell(p) = X \\log p + Y \\log(1-p)$，其中 $\\log$ 是自然对数。在 $H_{1}$ 下，当 $n>0$ 时，最大似然估计量为 $\\widehat{p} = X/n$。似然比统计量为 $\\Lambda = 2\\left[\\ell(\\widehat{p}) - \\ell(p_{0})\\right]$，其中 $p_{0} = 1/2$。在 $H_{0}$ 和标准正则性条件下，$\\Lambda$ 渐近服从自由度为 $1$ 的 $\\chi^{2}$ 分布。如果 $n=0$，则定义 $\\widehat{p} = 1/2$，$\\Lambda = 0$，并且不拒绝 $H_{0}$。\n\n您的任务：\n- 实现一个程序，对于下方的每个测试用例，该程序需要将区块级别的计数汇总为 $X$、$Y$ 和 $n$，计算 $\\widehat{p}$，计算似然比统计量 $\\Lambda$，使用自由度为 $1$ 的 $\\chi^{2}$ 分布计算上尾p值，并决定是否在显著性水平 $\\alpha = 0.05$ 下拒绝 $H_{0}$（双边检验，由 $\\chi^{2}$ 参考分布所编码）。\n- 数值细节：\n  - 使用自然对数作为 $\\log$。\n  - 通过在计算 $\\ell(\\widehat{p})$ 时采用 $0 \\log 0 = 0$ 的约定来处理 $X = 0$ 或 $Y = 0$ 的边界情况。\n  - 如果 $n = 0$，返回 $\\widehat{p} = 1/2$，$\\Lambda = 0$，p值 $= 1$，以及决策“不拒绝”。\n\n测试套件：\n- 每个测试用例是一个共线性区块的列表，其中每个区块由一对非负整数 $(x_{i}, y_{i})$ 表示。每个测试用例的输入数据直接嵌入在程序中，无需外部输入。\n  1. 全基因组范围内的均衡单拷贝计数: 区块 $= [($10$,$10$),($20$,$20$),($50$,$50$),($5$,$5$),($15$,$15$)]$.\n  2. 强烈偏向亚基因组A: 区块 $= [($35$,$15$),($40$,$10$),($50$,$20$),($30$,$10$),($45$,$15$)]$.\n  3. 小样本轻度不对称: 区块 $= [($3$,$1$)]$.\n  4. 完全偏斜的边界情况: 区块 $= [($0$,$50$)]$.\n  5. 未观察到单拷贝: 区块 $= [($0$,$0$)]$.\n\n程序输出规范：\n- 对于每个测试用例，输出一个包含四个元素的列表：$[\\Lambda,\\ \\widehat{p},\\ \\text{p\\_value},\\ \\text{reject}]$，其中 $\\Lambda$ 是作为浮点数的似然比统计量，$\\widehat{p}$ 是作为浮点数的最大似然估计值，$\\text{p\\_value}$ 是作为浮点数的上尾 $\\chi^{2}$ p值，而 $\\text{reject}$ 是一个布尔值，指示在 $\\alpha = 0.05$ 时是否拒绝 $H_{0}$。\n- 所有浮点数必须四舍五入到恰好6位小数。\n- 您的程序应生成单行输出，其中包含五个测试用例的结果，形式为一个用方括号括起来的逗号分隔列表，例如：$\\text{[}[r_{1}], [r_{2}], [r_{3}], [r_{4}], [r_{5}]\\text{]}$，其中每个 $[r_{k}]$ 是按指定顺序排列的测试用例 $k$ 的四元素列表。", "solution": "所提出的问题是应用统计学领域，特别是在进化基因组学范畴内，一个有效且适定的练习。它要求实现一个似然比检验来评估异源多倍体基因组中的偏向性基因丢失。其框架在科学上是合理的，假设陈述清晰，统计形式化是标准的。我们将着手进行解法的推导和实现。\n\n问题的核心在于检验一个关于二项分布中比例参数 $p$ 的假设。给定两个亚基因组A和B上的单拷贝基因计数。设 $X$ 为亚基因组A上的单拷贝计数，$Y$ 为亚基因组B上的单拷贝计数，观察到的单拷贝总数为 $n=X+Y$。模型设定亚基因组A上的单拷贝数量 $X$ 服从二项分布，即 $X \\sim \\mathrm{Binomial}(n, p)$，其中 $p$ 是一个单拷贝基因被保留在亚基因组A上的概率。\n\n零假设 $H_0$ 设定不存在偏向，即两个亚基因组的保留概率相等，因此 $p = p_{0} = 1/2$。备择假设 $H_1$ 设定存在偏向，即 $p \\neq 1/2$。\n\n对于参数 $p$，给定数据 $X$ 和 $Y$，其似然函数与 $L(p) = p^X (1-p)^Y$ 成正比。使用对数似然函数 $\\ell(p) = \\log L(p)$ 更为方便，在忽略一个加性常数的情况下，它表示为：\n$$ \\ell(p) = X \\log p + Y \\log(1-p) $$\n其中 $\\log$ 表示自然对数。\n\n似然比检验统计量 $\\Lambda$ 定义为备择假设下的最大对数似然与零假设下的对数似然之差的两倍：\n$$ \\Lambda = 2 \\left( \\sup_{p \\in (0,1)} \\ell(p) - \\ell(p_{0}) \\right) $$\n\n在 $H_{1}$ 下，参数 $p$ 在区间 $(0,1)$ 内不受约束。通过最大化 $\\ell(p)$ 可以找到 $p$ 的最大似然估计量 (MLE)，当 $n > 0$ 时，其结果为 $\\widehat{p} = X/n$。因此，对数似然的最大值为 $\\ell(\\widehat{p})$：\n$$ \\ell(\\widehat{p}) = X \\log\\left(\\frac{X}{n}\\right) + Y \\log\\left(\\frac{Y}{n}\\right) $$\n\n在 $H_{0}$ 下，参数固定为 $p_{0} = 1/2$。对数似然为：\n$$ \\ell(p_0) = X \\log\\left(\\frac{1}{2}\\right) + Y \\log\\left(\\frac{1}{2}\\right) = (X+Y) \\log\\left(\\frac{1}{2}\\right) = -n \\log 2 $$\n\n结合这些表达式，似然比统计量为：\n$$ \\Lambda = 2 \\left[ \\ell(\\widehat{p}) - \\ell(p_0) \\right] = 2 \\left[ X \\log\\left(\\frac{X}{n}\\right) + Y \\log\\left(\\frac{Y}{n}\\right) - (-n \\log 2) \\right] $$\n这可以重排为一个计算上更稳定的形式：\n$$ \\Lambda = 2 \\left[ X \\log X + Y \\log Y - n \\log n + n \\log 2 \\right] $$\n该统计量等价于拟合优度的G检验统计量，其中观测计数为 $X$ 和 $Y$，而 $H_{0}$ 下的期望计数为 $n/2$ 和 $n/2$。\n\n我们必须按照问题陈述中的规定处理边界情况：\n1. 如果 $n = 0$，则 $X=0$ 且 $Y=0$。没有可用数据来检验该假设。我们定义 $\\widehat{p} = 1/2$ 且 $\\Lambda = 0$。相应的p值为 $1$，因此不拒绝 $H_0$。\n2. 如果 $X=0$ 或 $Y=0$（但 $n>0$），$\\ell(\\widehat{p})$ 的表达式中会包含形如 $0 \\log 0$ 的项。根据信息论和统计学中的标准约定，我们定义 $0 \\log 0 = 0$。\n    - 如果 $X=0$，则 $Y=n$ 且 $\\widehat{p}=0$。对数似然 $\\ell(\\widehat{p}) = 0 \\log 0 + n \\log(n/n) = 0$。那么 $\\Lambda = 2[0 - (-n \\log 2)] = 2n \\log 2$。\n    - 如果 $Y=0$，则 $X=n$ 且 $\\widehat{p}=1$。对数似然 $\\ell(\\widehat{p}) = n \\log(n/n) + 0 \\log 0 = 0$。那么 $\\Lambda = 2[0 - (-n \\log 2)] = 2n \\log 2$。\n因此，对于一个亚基因组的单拷贝数为零的边界情况，公式简化为 $\\Lambda = 2n \\log 2$。\n\n在标准正则性条件下（二项模型满足这些条件），统计量 $\\Lambda$ 渐近服从卡方分布，其自由度等于 $H_1$ 和 $H_0$ 之间自由参数数量的差值。在这里，这个差值是 $1-0=1$。因此，我们用 $\\chi^2_1$ 分布来检验 $\\Lambda$。\n\np值是在假设 $H_0$ 为真的情况下，观测到至少与从数据中计算出的检验统计量一样极端的统计量的概率。这对应于 $\\chi^2_1$ 分布的上尾概率：\n$$ \\text{p-value} = P(\\chi^2_1 \\ge \\Lambda) $$\n我们将使用卡方分布的生存函数（1 - CDF）来进行此计算。决策规则是，如果p值小于指定的显著性水平 $\\alpha = 0.05$，则拒绝 $H_0$。\n\n对每个测试用例的实现将按以下步骤进行：\n1. 汇总所有共线性区块的计数 $(x_i, y_i)$，以获得总计数 $X = \\sum x_i$ 和 $Y = \\sum y_i$。\n2. 计算单拷贝总数 $n = X + Y$。\n3. 根据问题说明，单独处理 $n=0$ 的情况。\n4. 对于 $n > 0$，计算 $\\widehat{p}=X/n$ 和统计量 $\\Lambda$，根据 $X$ 或 $Y$ 是否为零使用适当的公式。\n5. 使用 $\\chi^2_1$ 分布的生存函数计算p值。\n6. 通过将p值与 $\\alpha=0.05$ 比较，确定是否拒绝 $H_0$ 的布尔决策。\n7. 将结果——$\\Lambda$、$\\widehat{p}$、p值和拒绝决策——格式化为指定的精度和结构。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2\n\ndef analyze_fractionation(blocks):\n    \"\"\"\n    Computes the likelihood ratio test for biased fractionation.\n\n    Args:\n        blocks (list of tuples): A list where each tuple (x_i, y_i) contains\n                                 the counts of singletons on subgenomes A and B\n                                 for synteny block i.\n\n    Returns:\n        list: A list containing [Lambda, p_hat, p_value, reject_decision].\n    \"\"\"\n    # Step 1: Aggregate counts\n    x_total = sum(b[0] for b in blocks)\n    y_total = sum(b[1] for b in blocks)\n    n_total = x_total + y_total\n\n    # Step 2: Handle the case of no singletons\n    if n_total == 0:\n        p_hat = 0.5\n        lambda_stat = 0.0\n        p_value = 1.0\n        reject = False\n        return [lambda_stat, p_hat, p_value, reject]\n\n    # Step 3: Calculate MLE for p\n    p_hat = x_total / n_total\n\n    # Step 4: Calculate the Likelihood Ratio statistic Lambda\n    # Use the convention 0 * log(0) = 0, which simplifies the formula at boundaries.\n    if x_total == 0 or y_total == 0:\n        # If X=0 or Y=0, ell(p_hat) = 0. Lambda = 2 * (0 - ell(p0)).\n        # ell(p0) = n*log(0.5) = -n*log(2).\n        # So, Lambda = 2 * n * log(2).\n        lambda_stat = 2 * n_total * np.log(2)\n    else:\n        # General formula: Lambda = 2 * (ell(p_hat) - ell(p0))\n        # ell(p_hat) = X*log(X/n) + Y*log(Y/n)\n        # ell(p0) = n*log(0.5)\n        # Lambda = 2 * (X*log(X) + Y*log(Y) - n*log(n) + n*log(2))\n        lambda_stat = 2 * (x_total * np.log(x_total) + \n                             y_total * np.log(y_total) - \n                             n_total * np.log(n_total) +\n                             n_total * np.log(2))\n    \n    # Step 5: Compute the p-value from the chi-squared distribution\n    # Degrees of freedom = 1 (1 parameter 'p' in H1 vs 0 in H0)\n    p_value = chi2.sf(lambda_stat, df=1)\n\n    # Step 6: Make a decision based on the significance level alpha = 0.05\n    alpha = 0.05\n    reject = p_value  alpha\n\n    return [lambda_stat, p_hat, p_value, reject]\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis on the defined test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # 1. Balanced genome-wide singleton counts\n        [ (10, 10), (20, 20), (50, 50), (5, 5), (15, 15) ],\n        # 2. Strong bias toward subgenome A\n        [ (35, 15), (40, 10), (50, 20), (30, 10), (45, 15) ],\n        # 3. Small-sample mild asymmetry\n        [ (3, 1) ],\n        # 4. Boundary with complete skew\n        [ (0, 50) ],\n        # 5. No singletons observed\n        [ (0, 0) ]\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = analyze_fractionation(case)\n        all_results.append(result)\n\n    # Format the final output string according to the specification.\n    # Floats must be rounded to exactly 6 decimal places.\n    # The output should be a string representation of a list of lists.\n    formatted_parts = []\n    for res_list in all_results:\n        lambda_val, p_hat_val, p_val, reject_val = res_list\n        part_str = (f\"[{lambda_val:.6f}, {p_hat_val:.6f}, \"\n                    f\"{p_val:.6f}, {str(reject_val).lower()}]\")\n        formatted_parts.append(part_str)\n\n    # Final print statement in the exact required format.\n    # This forms a string looking like: [[...], [...], ...]\n    final_output_string = f\"[{','.join(formatted_parts)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "2794031"}]}