{"hands_on_practices": [{"introduction": "为了真正理解遗传作图，掌握如何从基本假设推导出图距至关重要。第一个练习要求您直接从交叉事件服从泊松分布这一假设出发，推导霍尔丹作图函数。通过完成这一推导 [@problem_id:2826723]，您将巩固对无干涉模型下预期交叉数 $m$ 与可观测重组率 $r$ 之间关系的理解。", "problem": "在一个大的、随机交配的二倍体物种中，根据多次减数分裂的观察，两个基因座之间的重组率为 $r=0.2$。假设采用Haldane无干涉模型：沿一条染色单体的交换构成一个泊松过程，染色单体参与交换是随机且独立的，且在一条染色单体上，两个基因座之间的交换次数是一个均值为 $m$ 的泊松随机变量。根据基本定义，重组率 $r$ 是指在一条染色单体上，两个基因座之间发生奇数次交换的概率，而以摩根（Morgan）为单位的遗传图距等于该区间内每条染色单体的预期交换次数。从这些基础出发，且不引用任何已有的作图函数，请推导 $r$ 和 $m$ 之间的关系，计算当 $r=0.2$ 时的 $m$ 值，并简要解释在 Haldane 假设下，推断出的图距相对于 $r$ 增大的实际意义。请将 $m$ 的最终数值答案以摩根（Morgan）为单位表示，并四舍五入到 $4$ 位有效数字。", "solution": "对问题陈述进行了严格审查，确认其有效。该问题基于遗传作图的科学原理，问题设定良好，信息充足，可得出唯一解，并使用了客观、明确的术语。我们可以开始进行推导和求解。\n\n问题陈述指出，在一条染色单体上两个基因座之间发生的交换次数（我们记为随机变量 $K$）服从均值为 $m$ 的泊松分布。因此，$K$ 的概率质量函数为：\n$$P(K=k) = \\frac{\\exp(-m) m^k}{k!} \\quad \\text{for } k = 0, 1, 2, \\dots$$\n其中 $m$ 是预期的交换次数，定义为以摩根（Morgan）为单位的遗传图距。\n\n重组率 $r$ 定义为基因座之间发生奇数次交换的概率。我们可以将其表示为所有奇数 $k$ 值的概率之和：\n$$r = P(K \\text{ is odd}) = \\sum_{j=0}^{\\infty} P(K=2j+1)$$\n$$r = P(K=1) + P(K=3) + P(K=5) + \\dots$$\n将泊松概率质量函数代入此和式中，得到：\n$$r = \\frac{\\exp(-m) m^1}{1!} + \\frac{\\exp(-m) m^3}{3!} + \\frac{\\exp(-m) m^5}{5!} + \\dots$$\n我们可以提出公因子 $\\exp(-m)$：\n$$r = \\exp(-m) \\left( \\frac{m^1}{1!} + \\frac{m^3}{3!} + \\frac{m^5}{5!} + \\dots \\right)$$\n括号中的级数可以从指数函数在 $0$ 附近的泰勒级数展开式中识别出来：\n$$ \\exp(m) = \\sum_{k=0}^{\\infty} \\frac{m^k}{k!} = 1 + \\frac{m}{1!} + \\frac{m^2}{2!} + \\frac{m^3}{3!} + \\dots $$\n$$ \\exp(-m) = \\sum_{k=0}^{\\infty} \\frac{(-m)^k}{k!} = 1 - \\frac{m}{1!} + \\frac{m^2}{2!} - \\frac{m^3}{3!} + \\dots $$\n为了分离出奇次幂项的和，我们将第二个级数从第一个级数中减去：\n$$ \\exp(m) - \\exp(-m) = \\left(1 + \\frac{m}{1!} + \\dots\\right) - \\left(1 - \\frac{m}{1!} + \\dots\\right) = 2 \\left( \\frac{m}{1!} + \\frac{m^3}{3!} + \\frac{m^5}{5!} + \\dots \\right) $$\n括号中的表达式正是我们计算 $r$ 所需的级数。因此：\n$$ \\frac{m^1}{1!} + \\frac{m^3}{3!} + \\frac{m^5}{5!} + \\dots = \\frac{1}{2} (\\exp(m) - \\exp(-m)) $$\n将此代回 $r$ 的方程中：\n$$r = \\exp(-m) \\left[ \\frac{1}{2} (\\exp(m) - \\exp(-m)) \\right]$$\n$$r = \\frac{1}{2} (\\exp(-m)\\exp(m) - \\exp(-m)\\exp(-m))$$\n$$r = \\frac{1}{2} (1 - \\exp(-2m))$$\n这就是所求的 $r$ 和 $m$ 之间的关系，即 Haldane 作图函数。这完成了任务的第一部分。\n\n接下来，我们必须计算给定重组率 $r = 0.2$ 时的 $m$ 值。我们重排已推导的方程以求解 $m$：\n$$0.2 = \\frac{1}{2} (1 - \\exp(-2m))$$\n$$0.4 = 1 - \\exp(-2m)$$\n$$\\exp(-2m) = 1 - 0.4 = 0.6$$\n对两边取自然对数：\n$$-2m = \\ln(0.6)$$\n$$m = -\\frac{1}{2} \\ln(0.6)$$\n现在，我们按照指示计算数值并四舍五入到 $4$ 位有效数字。\n$$m \\approx -\\frac{1}{2} (-0.5108256)$$\n$$m \\approx 0.2554128$$\n四舍五入到 $4$ 位有效数字，我们得到 $m = 0.2554$ 摩根（Morgan）。\n\n最后，我们讨论其实际意义。在遗传学实验中，可观察的量是重组率 $r$，而图距 $m$ 是一个理论构建，代表了交换事件的真实平均次数。对于非常小的距离，即 $m \\ll 1$ 时，作图函数的泰勒展开式 $\\exp(-2m) \\approx 1 - 2m + \\frac{(2m)^2}{2} - \\dots$，可得 $r \\approx \\frac{1}{2}(1 - (1 - 2m)) = m$。在这种情况下，$r$ 是 $m$ 的一个良好近似。\n\n然而，随着距离 $m$ 的增加，基因座之间发生多次交换的概率变得显著。偶数次交换（例如，双交换）会恢复染色单体上等位基因的亲本连锁，因此不会产生重组型染色体，也无法在测量 $r$ 时被检测到。重组率 $r$ 只计算了奇数次交换事件的净结果。因此，$r$ 系统性地低估了交换事件的真实频率 $m$。如我们的计算所示，观察到的重组率 $r=0.2$ 对应于实际图距 $m \\approx 0.2554$ 摩根（Morgan）。因此，相对于观察到的重组频率，推断出的图距会“增大”，以弥补未被观察到的偶数次交换事件。随着距离的增加，这种效应会变得更加显著，$r$ 会渐近地趋向于最大值 $0.5$（对于非连锁基因），而 $m$ 则可以无限增加。", "answer": "$$\\boxed{0.2554}$$", "id": "2826723"}, {"introduction": "虽然霍尔丹模型提供了一个基准，但大多数生物体都表现出交叉干涉。本练习将介绍考虑了正干涉的科萨姆比模型，并要求您将其与霍尔丹模型进行直接比较。通过推导这两个函数并计算给定重组率下的图距 [@problem_id:2826683]，您将对模拟干涉如何影响遗传距离的估算获得定量的认识。", "problem": "在一个大的、随机交配的二倍体种群中，两个位点相距的重组率为 $r = 0.2$。该种群具有标准的减数分裂行为且无染色单体干涉。设图距 $m$（单位为摩根）定义为两位点间每条染色单体上发生的交换的期望数，其中 $1$ 摩根对应 $100$ 厘摩根（cM）。仅从关于交换奇偶性的第一性原理和标准模型假设出发，完成以下任务。\n\n1) 在 Haldane 的无干涉模型下，假设区间内的交换作为均匀泊松过程发生，并且当且仅当两位点间发生奇数次交换时，配子才是重组型的。根据这些假设和泊松分布的奇偶性，推导出 $m$ 作为 $r$ 的函数的显式表达式，然后计算当 $r = 0.2$ 时的值。\n\n2) 在 Kosambi 的正干涉模型下，假设干涉是局部作用的，因此当一个图距为 $m$、重组率为 $r$ 的区间增加一个无穷小增量 $\\mathrm{d}m$ 时，重组率的变化 $\\mathrm{d}r$ 反映了跨越边界的奇偶性翻转，同时根据一个局部定义的并发系数（COC）减弱了相邻交换的共同发生，这产生了一个联系 $\\mathrm{d}r$ 和 $\\mathrm{d}m$ 的适定的一阶微分方程。以此为基础，推导出 $m$ 作为 $r$ 的函数的显式表达式，然后计算当 $r = 0.2$ 时的值。\n\n3) 解释你在第 $1$ 部分和第 $2$ 部分中获得的数值比较，说明对于相同的 $r$，干涉模型如何改变推断出的图距。\n\n将所有数值答案四舍五入至四位有效数字。图距以厘摩根（cM）为单位表示。将你的两个数值答案以行向量 $\\bigl(m_{\\text{Kosambi}},\\,m_{\\text{Haldane}}\\bigr)$ 的形式报告（单位为 cM）。", "solution": "所给问题是理论群体遗传学中的一个标准练习，涉及在两种不同的交换干涉模型下，重组率和图距之间的数学关系。该问题提法适定，有科学依据，并包含了解决问题所需的所有信息。我将按要求进行推导。\n\n图距 $m$ 定义为两个遗传位点之间的区间内，单条染色单体上发生交换的期望数。重组率 $r$ 是一个杂合个体产生的配子对这些位点是重组型的概率。当且仅当配子所遗传的染色单体上的两位点间发生了奇数次交换时，该配子才是重组型的。\n\n**1) Haldane 作图函数（无干涉）**\n\n在此模型中，假设交换沿染色体作为均匀泊松过程发生。泊松过程的参数是区间内事件的期望数，即图距 $m$。在该区间内观察到恰好 $k$ 次交换的概率由泊松概率质量函数给出：\n$$P(k; m) = \\frac{m^k \\exp(-m)}{k!}$$\n对 $k = 0, 1, 2, \\dots$ 成立。\n\n如果交换次数 $k$ 为奇数，则可观察到重组。因此，重组率 $r$ 是所有奇数 $k$ 值的概率之和：\n$$r = \\sum_{j=0}^{\\infty} P(k=2j+1; m) = \\sum_{j=0}^{\\infty} \\frac{m^{2j+1} \\exp(-m)}{(2j+1)!}$$\n我们可以提出因子 $\\exp(-m)$：\n$$r = \\exp(-m) \\sum_{j=0}^{\\infty} \\frac{m^{2j+1}}{(2j+1)!}$$\n求和项是双曲正弦函数 $\\sinh(m)$ 的泰勒级数展开。\n$$\\sinh(m) = \\frac{\\exp(m) - \\exp(-m)}{2} = \\sum_{j=0}^{\\infty} \\frac{m^{2j+1}}{(2j+1)!}$$\n将此代入 $r$ 的表达式：\n$$r = \\exp(-m) \\sinh(m) = \\exp(-m) \\left( \\frac{\\exp(m) - \\exp(-m)}{2} \\right)$$\n$$r = \\frac{\\exp(-m)\\exp(m) - \\exp(-m)\\exp(-m)}{2} = \\frac{1 - \\exp(-2m)}{2}$$\n这个方程给出了重组率 $r$ 作为图距 $m$ 的函数。为了求解 $m$ 关于 $r$ 的表达式，我们整理该方程：\n$$2r = 1 - \\exp(-2m)$$\n$$\\exp(-2m) = 1 - 2r$$\n$$-2m = \\ln(1 - 2r)$$\n$$m_{\\text{Haldane}}(r) = -\\frac{1}{2} \\ln(1 - 2r)$$\n这就是 Haldane 作图函数。对于给定的重组率 $r = 0.2$，以摩根为单位的图距是：\n$$m_{\\text{Haldane}} = -\\frac{1}{2} \\ln(1 - 2(0.2)) = -\\frac{1}{2} \\ln(1 - 0.4) = -\\frac{1}{2} \\ln(0.6)$$\n数值上，$\\ln(0.6) \\approx -0.5108256$。\n$$m_{\\text{Haldane}} \\approx -\\frac{1}{2}(-0.5108256) \\approx 0.2554128 \\text{ 摩根}$$\n因为 $1$ 摩根等于 $100$ 厘摩根（cM），我们有：\n$$m_{\\text{Haldane}} \\approx 25.54128 \\text{ cM}$$\n四舍五入至四位有效数字，我们得到 $25.54$ cM。\n\n**2) Kosambi 作图函数（正干涉）**\n\n这个模型引入了正干涉，即一次交换事件会降低附近发生另一次交换的概率。问题指导我们推导一个一阶微分方程。让我们考虑当图距 $m$ 增加一个无穷小量 $\\mathrm{d}m$ 时，重组率的变化 $\\mathrm{d}r$。根据定义，在片段 $\\mathrm{d}m$ 中发生一次交换的概率是 $\\mathrm{d}m$。\n这次新的交换会翻转区间内总交换次数的奇偶性。\n如果一个先前非重组的染色单体（偶数次交换，概率为 $1-r$）变为重组型，重组率会增加。如果一个先前重组的染色单体（奇数次交换，概率为 $r$）变为非重组型，重组率会减小。\n\n变化率是 $\\frac{\\mathrm{d}r}{\\mathrm{d}m}$。在没有干涉的情况下，从偶数到奇数的转换率为 $1-r$，从奇数到偶数的转换率为 $r$，这导致 $\\frac{\\mathrm{d}r}{\\mathrm{d}m} = (1-r) - r = 1-2r$，积分后得到 Haldane 函数。\n\n在有干涉的情况下，增加一次新交换的速率取决于是否已经存在交换。Kosambi 的模型基于一个假设，即局部并发系数（COC）等于 $2r$。COC 是在已经存在一次交换的条件下发生另一次交换的条件概率与无条件概率之比。\n这导出了联系 $r$ 和 $m$ 的微分方程：\n$$\\frac{\\mathrm{d}r}{\\mathrm{d}m} = 1 - 4r^2$$\n我们求解这个可分离的微分方程：\n$$\\frac{\\mathrm{d}r}{1 - 4r^2} = \\mathrm{d}m$$\n对两边进行积分，边界条件为当 $m=0$ 时 $r=0$：\n$$\\int_{0}^{r} \\frac{\\mathrm{d}x}{1 - 4x^2} = \\int_{0}^{m} \\mathrm{d}y$$\n左边的积分是标准形式。令 $u = 2x$，则 $\\mathrm{d}u = 2\\mathrm{d}x$。\n$$\\int_{0}^{2r} \\frac{1}{2} \\frac{\\mathrm{d}u}{1-u^2} = m$$\n$\\frac{1}{1-u^2}$ 的积分是 $\\operatorname{arctanh}(u)$。\n$$\\frac{1}{2} \\left[ \\operatorname{arctanh}(u) \\right]_0^{2r} = m$$\n$$\\frac{1}{2} (\\operatorname{arctanh}(2r) - \\operatorname{arctanh}(0)) = m$$\n因为 $\\operatorname{arctanh}(0) = 0$，我们有：\n$$m_{\\text{Kosambi}}(r) = \\frac{1}{2} \\operatorname{arctanh}(2r)$$\n这就是 Kosambi 作图函数。反双曲正切也可以用自然对数表示：$\\operatorname{arctanh}(x) = \\frac{1}{2}\\ln\\left(\\frac{1+x}{1-x}\\right)$。\n因此，一个等价的形式是 $m_{\\text{Kosambi}}(r) = \\frac{1}{4}\\ln\\left(\\frac{1+2r}{1-2r}\\right)$。\n\n对于给定的重组率 $r = 0.2$，以摩根为单位的图距是：\n$$m_{\\text{Kosambi}} = \\frac{1}{2} \\operatorname{arctanh}(2(0.2)) = \\frac{1}{2} \\operatorname{arctanh}(0.4)$$\n数值上，$\\operatorname{arctanh}(0.4) \\approx 0.4236489$。\n$$m_{\\text{Kosambi}} \\approx \\frac{1}{2}(0.4236489) \\approx 0.2118245 \\text{ 摩根}$$\n转换为厘摩根：\n$$m_{\\text{Kosambi}} \\approx 21.18245 \\text{ cM}$$\n四舍五入至四位有效数字，我们得到 $21.18$ cM。\n\n**3) 比较的解释**\n\n我们发现，对于重组率 $r=0.2$，推断出的图距为 $m_{\\text{Haldane}} \\approx 25.54$ cM 和 $m_{\\text{Kosambi}} \\approx 21.18$ cM。考虑了正干涉的 Kosambi 模型，对于相同的观测重组频率，得出了更小的图距。\n\n这个结果是关于多重交换的不同假设的直接推论。\n- **图距 ($m$)** 是交换的总期望频率。\n- **重组率 ($r$)** 是观察到奇数次交换的频率。\n\n偶数次交换（$k=2, 4, \\dots$）会消耗图距，但不会被检测为重组事件；它们相互“屏蔽”了。\n- 在 **Haldane 模型（无干涉）**中，交换是独立事件。发生两次或更多次交换的概率是显著的。这些多重交换，特别是偶数次交换，增加了达到给定奇数次交换频率（$r$）所需的总交换事件数（$m$）。\n- 在 **Kosambi 模型（正干涉）**中，一次交换的存在会抑制附近其他交换的形成。与 Haldane 模型相比，这系统性地降低了双交换、三交换及更高阶交换事件的频率。通过减少“屏蔽”效应的双交换的发生，干涉使得重组成为潜在交换频率的更“有效”的指标。因此，产生相同的观测重组率 $r$ 所需的总交换次数（一个更小的 $m$）也更少。\n\n总之，对于给定的 $r$，在无干涉模型中推断的图距 $m$ 必须更大，以解释在偶数次交换构型中预期存在的更多“浪费的”或“隐藏的”交换。", "answer": "$$\\boxed{\\begin{pmatrix} 21.18 & 25.54 \\end{pmatrix}}$$", "id": "2826683"}, {"introduction": "将理论模型转化为实用工具是现代遗传学和生物信息学的核心技能。最后一个练习将从纸笔推导转向计算实现。您将编写一个程序，对一系列重组率应用霍尔丹和科萨姆比作图函数 [@problem_id:2403810]，这将使您能够直观地、系统地比较在不同干涉假设下，推断出的图距如何随着位点间距离的增加而变化。", "problem": "实现一个程序，对于一个遵循孟德尔分离定律的二倍体生物中两个基因座之间的每个给定重组频率 $r$，该程序使用 Haldane 作图函数和 Kosambi 作图函数计算遗传图距。作图函数将重组率 $r \\in [0, 0.5)$ 转换为以厘摩（cM）为单位的遗传距离 $D$。遗传距离结果必须以厘摩（cM）为单位报告，并四舍五入到 $6$ 位小数。\n\n运行时不提供输入。相反，您的程序必须内部评估一组固定的重组频率测试集。对 $r$ 使用以下测试集：$[0.0, 0.01, 0.1, 0.2, 0.3, 0.49]$。对于此列表中的每个 $r$，计算两个值：\n- $D_{\\mathrm{H}}(r)$：以厘摩（cM）为单位的 Haldane 距离。\n- $D_{\\mathrm{K}}(r)$：以厘摩（cM）为单位的 Kosambi 距离。\n\n按照下面描述的精确输出格式报告结果。如果 $r$ 在闭开区间 $[0, 0.5)$ 之外，则作图函数未定义，不得进行计算；这种情况在提供的测试集中不会发生。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且本身是一个以厘摩（cM）为单位的双元素列表 $[D_{\\mathrm{H}}(r), D_{\\mathrm{K}}(r)]$，每个值都四舍五入到 $6$ 位小数。具体来说，输出必须如下所示：\n\"[[D_H(r_1),D_K(r_1)],[D_H(r_2),D_K(r_2)],...,[D_H(r_6),D_K(r_6)]]\"\n所有数字都四舍五入到 $6$ 位小数，且无任何附加文本。", "solution": "所述问题经过了严格的验证。\n\n### 第 1 步：提取已知条件\n- **任务**：使用 Haldane 和 Kosambi 作图函数，根据重组频率 $r$ 计算遗传图距 $D$。\n- **输入数据**：一组固定的重组频率 $r$：$[0.0, 0.01, 0.1, 0.2, 0.3, 0.49]$。\n- **$r$ 的定义域**：$r \\in [0, 0.5)$。提供的测试用例属于此定义域。\n- **作图函数**：Haldane 函数 $D_{\\mathrm{H}}(r)$ 和 Kosambi 函数 $D_{\\mathrm{K}}(r)$。未提供明确的公式，但假定它们是标准的领域知识。\n- **输出单位**：距离必须以厘摩（cM）为单位。\n- **精度**：结果必须四舍五入到 $6$ 位小数。\n- **输出格式**：表示列表的列表的单行字符串：`[[D_H(r_1),D_K(r_1)],...,[D_H(r_6),D_K(r_6)]]`。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于经典遗传学和群体遗传学的基本原理，特别是遗传连锁和作图。重组频率、图距以及 Haldane 和 Kosambi 函数的概念是该领域标准、成熟的模型。该问题具有科学合理性。\n- **适定性**：对于指定的 $r$ 定义域，作图函数在数学上是良定义的。对于每个有效的输入 $r$，都存在一个唯一的、稳定的 $D_{\\mathrm{H}}(r)$ 和 $D_{\\mathrm{K}}(r)$ 解。\n- **客观性**：该问题以客观、正式的语言陈述。它要求基于已建立的科学模型进行定量计算。\n- **完整性**：虽然问题省略了作图函数的显式公式，但这些在遗传学中是经典公式。对于该领域的专家来说，省略这些公式并不会使问题变得不完整。这些公式被普遍认为是：\n    - Haldane 函数：$D_{\\mathrm{H}}(r) = -50 \\ln(1 - 2r)$ cM。\n    - Kosambi 函数：$D_{\\mathrm{K}}(r) = 25 \\ln\\left(\\frac{1+2r}{1-2r}\\right)$ cM。\n      有了这些领域特定的知识，问题就是完全指定的了。\n- **其他缺陷**：该问题没有表现出其他缺陷，如矛盾、不可行性或不可验证性。\n\n### 第 3 步：结论与行动\n该问题是**有效的**。我们将继续提供完整的解决方案。\n\n该问题要求使用两种不同的模型根据重组频率计算遗传图距。遗传图距 $D$ 量化了染色体上两个基因座之间的距离。它通常以厘摩（cM）为单位，其中 $1$ cM 对应于基因座之间发生重组的概率为 $1\\%$。重组频率 $r$ 是可观察到的重组后代比例，对于不连锁的基因座，其理论最大值为 $0.5$。作图函数提供了可观察的 $r$ 与理论图距 $D$ 之间的数学关系，其中 $D$ 定义为每次减数分裂的预期交换次数。\n\n图距的单位是摩根（Morgan），等于 $100$ 厘摩。以摩根为单位的距离（我们将其表示为 $m$）与下面的函数直接相关。要求的输出是以 cM 为单位，因此应用了 $100$ 的系数。\n\n**Haldane 作图函数**\n该函数假设交换遵循泊松过程，即一个位置的交换不影响另一位置发生交换的概率（无干涉）。如果两个基因座之间发生奇数次交换，就会发生重组事件。重组频率 $r$ 与以摩根为单位的图距 $m$ 之间的关系是：\n$$r = \\frac{1}{2}(1 - e^{-2m})$$\n求解 $m$ 可得以摩根为单位的距离：\n$$m = -\\frac{1}{2}\\ln(1-2r)$$\n为了以厘摩为单位表示该距离，我们乘以 $100$。因此，Haldane 距离 $D_{\\mathrm{H}}(r)$ 是：\n$$D_{\\mathrm{H}}(r) = 100 \\times m = -50 \\ln(1-2r)$$\n此函数的定义域为 $1-2r > 0$，即 $r < 0.5$。\n\n**Kosambi 作图函数**\n该函数引入了交换干涉的概念，即一次交换的发生会降低附近发生另一次交换的概率。该模型得出以下关系：\n$$r = \\frac{1}{2}\\tanh(2m)$$\n其中 $\\tanh$ 是双曲正切函数。为了求出图距，我们求解 $m$：\n$$m = \\frac{1}{2}\\text{arctanh}(2r)$$\n其中 $\\text{arctanh}$ 是反双曲正切函数。使用恒等式 $\\text{arctanh}(x) = \\frac{1}{2}\\ln\\left(\\frac{1+x}{1-x}\\right)$，我们可以写出：\n$$m = \\frac{1}{2} \\times \\frac{1}{2} \\ln\\left(\\frac{1+2r}{1-2r}\\right) = \\frac{1}{4} \\ln\\left(\\frac{1+2r}{1-2r}\\right)$$\n转换为厘摩，Kosambi 距离 $D_{\\mathrm{K}}(r)$ 是：\n$$D_{\\mathrm{K}}(r) = 100 \\times m = 25 \\ln\\left(\\frac{1+2r}{1-2r}\\right)$$\n此函数的定义域为 $\\vert 2r \\vert < 1$，考虑到 $r \\ge 0$，这对应于 $r < 0.5$。\n\n对于较小的 $r$ 值，两个函数都近似于 $D \\approx 100r$，这可以通过泰勒展开来证明。随着 $r$ 接近 $0.5$，预测的距离会发散，由于 Haldane 函数假设没有干涉，其预测的图距会更大。\n\n**计算算法**\n解决方案的实现将按以下步骤进行：\n1.  定义待测试的重组频率 $r$ 列表：$[0.0, 0.01, 0.1, 0.2, 0.3, 0.49]$。\n2.  遍历测试集中的每个 $r$ 值。\n3.  对于每个 $r$：\n    a. 如果 $r = 0.0$，则 $D_{\\mathrm{H}}(0)$ 和 $D_{\\mathrm{K}}(0)$ 在解析上都为 $0$。\n    b. 如果 $r > 0$，计算 $D_{\\mathrm{H}}(r) = -50 \\ln(1-2r)$ 和 $D_{\\mathrm{K}}(r) = 25 \\ln\\left(\\frac{1+2r}{1-2r}\\right)$。\n4.  将每个计算出的距离四舍五入到 $6$ 位小数。\n5.  将每对结果 $[D_{\\mathrm{H}}(r), D_{\\mathrm{K}}(r)]$ 存储在列表中。\n6.  将最终结果列表格式化为指定的字符串格式，确保不含空格。\n对这些公式的系统性应用将产生所需的输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes genetic map distances using Haldane and Kosambi mapping functions\n    for a fixed suite of recombination frequencies.\n    \"\"\"\n    \n    # Define the test cases for recombination frequency r.\n    test_cases = [0.0, 0.01, 0.1, 0.2, 0.3, 0.49]\n\n    results = []\n    for r in test_cases:\n        # The recombination frequency r must be in the interval [0, 0.5).\n        # The problem statement guarantees this for the test suite.\n\n        # Handle the edge case r = 0 separately to avoid log(1) computation\n        # and potential floating point inaccuracies, though it would evaluate correctly.\n        # Both D_H(0) and D_K(0) are 0.\n        if r == 0.0:\n            d_h = 0.0\n            d_k = 0.0\n        else:\n            # Haldane's mapping function: D_H(r) = -50 * ln(1 - 2r) cM\n            # The distance D is measured in centiMorgans (cM).\n            # The map distance in Morgans is m = -0.5 * ln(1 - 2r).\n            # D = 100 * m.\n            d_h = -50.0 * np.log(1.0 - 2.0 * r)\n\n            # Kosambi's mapping function: D_K(r) = 25 * ln((1 + 2r) / (1 - 2r)) cM\n            # The map distance in Morgans is m = 0.5 * arctanh(2r)\n            # D = 100 * m = 50 * arctanh(2r).\n            # Using the identity arctanh(x) = 0.5 * ln((1+x)/(1-x)), this is equivalent to\n            # D = 25 * ln((1 + 2r) / (1 - 2r)).\n            d_k = 25.0 * np.log((1.0 + 2.0 * r) / (1.0 - 2.0 * r))\n\n        # Round results to 6 decimal places as required.\n        d_h_rounded = round(d_h, 6)\n        d_k_rounded = round(d_k, 6)\n        \n        results.append([d_h_rounded, d_k_rounded])\n\n    # Format the output string to match the exact requirement:\n    # \"[[D_H(r_1),D_K(r_1)],[D_H(r_2),D_K(r_2)],...,[D_H(r_6),D_K(r_6)]]\"\n    # Using str() and replace() is a robust way to match the specified format\n    # which has no spaces.\n    output_string = str(results).replace(\" \", \"\")\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```", "id": "2403810"}]}