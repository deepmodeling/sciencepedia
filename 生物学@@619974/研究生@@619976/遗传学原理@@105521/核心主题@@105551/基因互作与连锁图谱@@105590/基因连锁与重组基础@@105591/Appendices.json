{"hands_on_practices": [{"introduction": "遗传图距（$d$）和重组率（$r$）是连锁分析中的核心概念，但它们并不总能划等号。这个练习旨在揭示两者之间的关键区别，通过将简单的线性近似与更精确的霍尔丹（Haldane）作图函数进行比较，你将亲手计算并理解为何需要作图函数来校正多次交换事件对观测结果的影响。这个基本功的训练对于精确解读遗传数据至关重要 [@problem_id:2817249]。", "problem": "在一个双杂合个体的测交中，观察到两个基因座之间的重组率为 $r=0.18$。使用遗传作图的基本原理，完成以下任务：\n- 使用线性小距离近似法估算图距，该方法将图距（单位为摩尔根）等同于重组率 $r$。\n- 使用基于区间内交换形成的泊松模型的显式无干涉作图函数，独立地估算图距（假设为无交换干涉的 Haldane 模型）。\n\n将两个答案都以厘摩（centiMorgan (cM)）表示，并四舍五入至四位有效数字。根据其基本假设，简要说明哪个估计值更大及其原因。你最终报告的值必须仅为两个数值估计，不带单位，并按以下顺序排列：线性近似估计，然后是 Haldane 作图函数估计。", "solution": "所述问题是有效的。它在科学上基于遗传连锁分析的原理，问题表述清晰且提供了所有必要信息，并以客观、明确的语言表达。我们现在开始解答。\n\n基本量是重组率 $r$ 和图距 $d$。重组率 $r$ 是一个可观测量，定义为一次杂交中产生的重组后代的比例。图距 $d$（以摩尔根为单位）是一个理论构念，定义为每次减数分裂中，在一个染色体区间内发生的交换事件的期望数。一摩尔根对应于每次减数分裂平均发生一次交换。一厘摩（cM）是 $\\frac{1}{100}$ 摩尔根。\n\n问题给出的观测重组率为 $r = 0.18$。我们必须使用两种不同的模型来估算图距。\n\n首先，我们使用线性小距离近似法。该模型仅对非常小的 $r$ 值有效。它基于一个简化假设，即区间内发生一次以上交换事件的概率可以忽略不计。如果最多只能发生一次交换，那么每次交换事件都会产生重组配子。在这种情况下，重组配子的频率（$r$）等于交换事件的频率（$d$）。\n因此，线性近似为：\n$$d_{linear} \\approx r$$\n给定 $r = 0.18$，以摩尔根为单位的图距是：\n$$d_{linear} = 0.18 \\text{ Morgans}$$\n为了以厘摩表示，我们乘以 $100$：\n$$d_{linear, cM} = 0.18 \\times 100 = 18.00 \\text{ cM}$$\n四舍五入到四位有效数字，得到 $18.00$ cM。\n\n其次，我们使用 Haldane 作图函数。该模型假设交换沿染色体呈泊松过程分布，其均值为 $d$。这是一个无交换干涉的模型，意味着在某一点发生的一次交换不影响附近发生另一次交换的概率。在泊松模型下，区间内发生恰好 $k$ 次交换的概率由下式给出：\n$$P(X=k) = \\frac{\\exp(-d)d^k}{k!}$$\n只有当两个基因座之间发生奇数次交换（$k=1, 3, 5, ...$）时，才能观察到它们之间的重组。偶数次交换（$k=0, 2, 4, ...$）会恢复亲本的连锁相，从而产生非重组配子。因此，重组率 $r$ 是所有奇数次交换概率的总和：\n$$r = \\sum_{k \\text{ odd}} P(X=k) = P(X=1) + P(X=3) + \\dots$$\n这个无穷级数有一个著名的闭式解：\n$$r = \\frac{1}{2}(1 - \\exp(-2d))$$\n这就是 Haldane 作图函数。我们已知 $r = 0.18$，必须求解 $d$。\n$$0.18 = \\frac{1}{2}(1 - \\exp(-2d))$$\n两边乘以 $2$：\n$$0.36 = 1 - \\exp(-2d)$$\n整理各项：\n$$\\exp(-2d) = 1 - 0.36 = 0.64$$\n为了求解 $d$，我们对两边取自然对数：\n$$-2d = \\ln(0.64)$$\n$$d = -\\frac{1}{2}\\ln(0.64)$$\n这就得到了以摩尔根为单位的距离 $d$。我们计算其数值：\n$$d \\approx -\\frac{1}{2}(-0.446287) \\approx 0.2231435 \\text{ Morgans}$$\n换算成厘摩：\n$$d_{Haldane, cM} = 0.2231435 \\times 100 \\approx 22.31435 \\text{ cM}$$\n四舍五入到四位有效数字，得到 $22.31$ cM。\n\n最后，我们必须解释为什么 Haldane 估计值（$d_{Haldane, cM} \\approx 22.31$）大于线性近似值（$d_{linear, cM} = 18.00$）。这种差异的产生是因为重组率 $r$ 系统地低估了真实的图距 $d$。线性近似法 $d \\approx r$ 忽略了多重交换的影响。而 Haldane 模型明确地考虑了这些影响。具体来说，双交换事件（以及所有更高阶的偶数次交换事件）会产生亲本型的、非重组的单倍型。这些事件对图距 $d$ 有贡献（因为 $d$ 计算了所有交换），但在重组率 $r$ 中却无法被检测到。随着基因间距离的增加，这种多重“遮蔽”交换的概率变得显著。为了产生 $r=0.18$ 的观测重组率，真实的潜在交换频率 $d$ 必须高于 $0.18$，以补偿那部分在重组分析中不可见的双交换。Haldane 函数提供了正确的数学映射来解释这种低估。线性近似只是 Haldane 函数在 $d=0$ 附近泰勒级数展开的第一项，即 $r = d - d^2 + \\dots$。对于任何 $d > 0$，图距 $d$ 将总是大于重组率 $r$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n18.00 & 22.31\n\\end{pmatrix}\n}\n$$", "id": "2817249"}, {"introduction": "在上一个练习的基础上，我们将进一步探索更复杂的遗传现象——交换干涉（crossover interference）。本练习将对比两种经典的作图函数：假设没有干涉的霍尔丹模型和考虑了正干涉的科萨姆比（Kosambi）模型 [@problem_id:2817255]。通过计算，你将看到不同的生物学假设如何导致对重组率的不同预测，从而加深对连锁强度背后生物学机制的理解。", "problem": "在对同一条染色体上的两个基因座进行的两点测交中，测得基因座之间的遗传图距为 $30$ 厘摩根 (cM)，其中 $1$ 摩根等于 $100$ cM。设 $d$ 表示以摩根为单位的图距，$r$ 表示重组分数（重组配子的概率）。两种经典的作图函数在关于交换干涉的不同假设下，将 $d$ 和 $r$ 关联起来：\n- Haldane 作图函数假设没有干涉，并将沿染色单体的交换建模为泊松过程。\n- Kosambi 作图函数假设存在正干涉，随着距离的增加，重组的几率也随之增加。\n\n基于这些假设以及重组分数和遗传图距的标准定义，计算当 $d = 30$ cM 时，由 Haldane 作图函数和 Kosambi 作图函数预测的重组分数 $r$。然后计算这两个 $r$ 值之间的绝对差。将所有重组分数以小数形式表示（而非百分数）。将所求的三个量均四舍五入到四位有效数字。你的最终答案应按此顺序给出：Haldane $r$ 值、Kosambi $r$ 值以及它们之间的绝对差。", "solution": "该问题陈述具有科学依据、提法恰当且客观。它基于遗传连锁与重组的基本原理，使用已建立的数学模型（Haldane 和 Kosambi 作图函数）将遗传图距与重组频率关联起来。所有必要数据均已提供。该问题是有效的。\n\n任务是：对于给定的遗传图距 $d$，使用两种不同的作图函数计算重组分数 $r$，然后求出得到的两个 $r$ 值之间的绝对差。\n\n已知条件如下：\n- 遗传图距：$30$ 厘摩根 (cM)。\n- 以摩根为单位的图距符号：$d$。\n- 重组分数符号：$r$。\n- 待使用的作图函数：Haldane 和 Kosambi。\n\n首先，我们必须将图距单位从厘摩根 (cM) 转换成摩根。题目说明 $1$ 摩根等于 $100$ cM。\n因此，以摩根为单位的图距 $d$ 为：\n$$d = \\frac{30 \\text{ cM}}{100 \\text{ cM/Morgan}} = 0.3 \\text{ Morgans}$$\n\n现在，我们将应用每种作图函数。\n\n1.  **Haldane 作图函数**\n    该函数是在无交换干涉的假设下推导出来的，意味着一次交换事件的发生不影响附近另一次交换事件发生的概率。交换被建模为泊松过程。重组分数 $r_H$ 和图距 $d$（以摩根为单位）之间的关系由以下公式给出：\n    $$r_H = \\frac{1}{2}(1 - \\exp(-2d))$$\n    代入 $d = 0.3$：\n    $$r_H = \\frac{1}{2}(1 - \\exp(-2 \\times 0.3)) = \\frac{1}{2}(1 - \\exp(-0.6))$$\n    我们计算其数值：\n    $$\\exp(-0.6) \\approx 0.548811636$$\n    $$r_H \\approx \\frac{1}{2}(1 - 0.548811636) = \\frac{1}{2}(0.451188364) = 0.225594182$$\n    四舍五入到四位有效数字，我们得到：\n    $$r_H \\approx 0.2256$$\n\n2.  **Kosambi 作图函数**\n    该函数考虑了正交换干涉，即一次交换事件会降低其附近发生另一次交换的可能性。重组分数 $r_K$ 和图距 $d$（以摩根为单位）之间的关系由以下公式给出：\n    $$r_K = \\frac{1}{2}\\tanh(2d)$$\n    其中 $\\tanh$ 是双曲正切函数。代入 $d = 0.3$：\n    $$r_K = \\frac{1}{2}\\tanh(2 \\times 0.3) = \\frac{1}{2}\\tanh(0.6)$$\n    我们回顾双曲正切的定义：$\\tanh(x) = \\frac{\\exp(2x) - 1}{\\exp(2x) + 1}$。因此：\n    $$r_K = \\frac{1}{2} \\left( \\frac{\\exp(1.2) - 1}{\\exp(1.2) + 1} \\right)$$\n    我们计算其数值：\n    $$\\exp(1.2) \\approx 3.32011692$$\n    $$r_K \\approx \\frac{1}{2} \\left( \\frac{3.32011692 - 1}{3.32011692 + 1} \\right) = \\frac{1}{2} \\left( \\frac{2.32011692}{4.32011692} \\right) \\approx \\frac{1}{2}(0.537049567) = 0.2685247835$$\n    四舍五入到四位有效数字，我们得到：\n    $$r_K \\approx 0.2685$$\n\n3.  **绝对差**\n    最后，我们计算两个重组分数之间的绝对差 $\\Delta r$。在最终四舍五入之前，使用未四舍五入的数值进行此计算以保持精度至关重要。\n    $$\\Delta r = |r_H - r_K|$$\n    $$\\Delta r = |0.225594182 - 0.2685247835| = |-0.0429306015| = 0.0429306015$$\n    将此结果四舍五入到四位有效数字：\n    $$\\Delta r \\approx 0.04293$$\n\n所求的三个量，均四舍五入到四位有效数字，分别是：由 Haldane 函数得出的重组分数 ($r_H$)、由 Kosambi 函数得出的重组分数 ($r_K$)，以及它们的绝对差 ($\\Delta r$)。", "answer": "$$\\boxed{\\begin{pmatrix} 0.2256 & 0.2685 & 0.04293 \\end{pmatrix}}$$", "id": "2817255"}, {"introduction": "现在，让我们从理论计算转向实际的数据分析。这个练习模拟了处理真菌四分体数据的真实场景，你将利用亲本双型（PD）、非亲本双型（NPD）和四分型（TT）的原始计数来估计重组率。更重要的是，你将学习如何通过构建置信区间来量化估计的不确定性，这是严谨的遗传学研究所必需的统计技能 [@problem_id:2817196]。", "problem": "将一种形成无序四分体的异宗配合真菌进行两个基因座的杂交。根据孢子基因型，您对总共 $N=800$ 个完整四分体进行评分和分类，将其归入三种经典类型：亲本双型 (PD)、四分型 (TT) 和非亲本双型 (NPD)。观测到的计数如下：\n- PD: $520$\n- TT: $250$\n- NPD: $30$\n\n假设如下：\n- 四分体是独立的，并且在给定基础类型概率的条件下，计数向量服从多项分布。\n- 不存在染色单体干涉，且染色单体参与交换是随机的。\n- 根据无序四分体中四分体类型的定义，一个 PD 四分体包含 $0$ 个重组染色单体，一个 TT 四分体包含 $2$ 个重组染色单体，一个 NPD 四分体包含 $4$ 个重组染色单体。\n\n仅使用这些定义和多项抽样模型作为基本依据，完成以下任务：\n1. 推导两个基因座之间的重组染色单体分数 $r$ 的估计量 $\\hat{r}$，并根据数据计算其数值。\n2. 使用delta方法，推导 $\\hat{r}$ 的大样本方差关于类型概率的表达式，然后通过代入经验类型比例，获得标准误的数值估计。使用标准正态分位数 $z_{0.975}=1.96$ 构建 $r$ 的 $95\\%$ 置信区间，形式为 $\\hat{r} \\pm z_{0.975}\\,\\mathrm{SE}(\\hat{r})$。\n\n以小数形式（无百分号）报告点估计 $\\hat{r}$ 以及 $95\\%$ 置信区间的下界和上界的最终数值结果，每个结果均四舍五入至四位有效数字。您的最终答案必须是一个单行矩阵，按顺序包含 $\\hat{r}$、下界和上界这三个值。", "solution": "所提出的问题具有科学依据，提法恰当且客观。它代表了四分体分析中一个标准的统计遗传学练习。所有必要的数据和定义都已提供，假设陈述清晰，并与该领域的通用模型一致。该问题是有效的，并存在唯一且有意义的解。\n\n目标是估计两个遗传基因座之间的重组染色单体分数 $r$，并为该估计构建一个置信区间。\n\n设观测到亲本双型 (PD)、四分型 (TT) 或非亲本双型 (NPD) 四分体的真实未知概率分别为 $p_{PD}$、$p_{TT}$ 和 $p_{NPD}$，其中 $p_{PD} + p_{TT} + p_{NPD} = 1$。观测到的计数 $(n_{PD}, n_{TT}, n_{NPD})$ 假定服从总计数为 $N$ 且概率为这些值的多项分布。\n提供的数据为：$N=800$，$n_{PD}=520$，$n_{TT}=250$，$n_{NPD}=30$。\n\n重组染色单体分数 $r$ 代表了发生重组的染色单体的比例。根据问题对无序四分体的定义，一个 PD 四分体包含 $0$ 个重组染色单体，一个 TT 四分体包含 $2$ 个，一个 NPD 四分体包含 $4$ 个。单个四分体由 $4$ 条染色单体组成。因此，重组染色单体的期望分数由加权平均给出：\n$$r = \\frac{0 \\cdot p_{PD} + 2 \\cdot p_{TT} + 4 \\cdot p_{NPD}}{4} = \\frac{1}{2} p_{TT} + p_{NPD}$$\n\n1. 估计量 $\\hat{r}$ 的推导与计算。\n\n多项分布概率的最大似然估计量 (MLE) 是观测到的样本比例：\n$$ \\hat{p}_{PD} = \\frac{n_{PD}}{N}, \\quad \\hat{p}_{TT} = \\frac{n_{TT}}{N}, \\quad \\hat{p}_{NPD} = \\frac{n_{NPD}}{N} $$\n根据最大似然估计量的不变性，$r$ 的最大似然估计量（记为 $\\hat{r}$）通过将这些样本比例代入 $r$ 的表达式得到：\n$$ \\hat{r} = g(\\hat{p}_{TT}, \\hat{p}_{NPD}) = \\frac{1}{2} \\hat{p}_{TT} + \\hat{p}_{NPD} = \\frac{1}{2} \\frac{n_{TT}}{N} + \\frac{n_{NPD}}{N} = \\frac{n_{TT} + 2n_{NPD}}{2N} $$\n该估计量对应于样本中观测到的重组染色单体分数，它是一个矩估计量，并且在本例中也是最大似然估计量。\n\n使用所提供的数据：\n$$ \\hat{r} = \\frac{250 + 2(30)}{2(800)} = \\frac{250 + 60}{1600} = \\frac{310}{1600} = \\frac{31}{160} = 0.19375 $$\n\n2. 大样本方差的推导与置信区间的构建。\n\n估计量 $\\hat{r}$ 是随机样本比例 $\\hat{p}_{TT}$ 和 $\\hat{p}_{NPD}$ 的线性函数。对于线性函数，delta方法提供的是方差的精确公式，而非近似值。$\\hat{r}$ 的大样本方差由多项分布比例的协方差矩阵推导得出。\n$$ Var(\\hat{r}) = Var \\left( \\frac{1}{2} \\hat{p}_{TT} + \\hat{p}_{NPD} \\right) = \\frac{1}{4} Var(\\hat{p}_{TT}) + Var(\\hat{p}_{NPD}) + Cov(\\hat{p}_{TT}, \\hat{p}_{NPD}) $$\n对于规模为 $N$ 的多项分布，样本比例的方差和协方差为：\n$$ Var(\\hat{p}_i) = \\frac{p_i(1-p_i)}{N}, \\quad Cov(\\hat{p}_i, \\hat{p}_j) = -\\frac{p_i p_j}{N} \\quad \\text{for } i \\neq j $$\n将这些代入 $\\hat{r}$ 的方差表达式中：\n$$ Var(\\hat{r}) = \\frac{1}{4} \\frac{p_{TT}(1-p_{TT})}{N} + \\frac{p_{NPD}(1-p_{NPD})}{N} - \\frac{p_{TT}p_{NPD}}{N} $$\n该表达式可以展开并简化：\n$$ Var(\\hat{r}) = \\frac{1}{4N} [p_{TT}(1-p_{TT}) + 4p_{NPD}(1-p_{NPD}) - 4p_{TT}p_{NPD}] $$\n$$ Var(\\hat{r}) = \\frac{1}{4N} [p_{TT} - p_{TT}^2 + 4p_{NPD} - 4p_{NPD}^2 - 4p_{TT}p_{NPD}] $$\n$$ Var(\\hat{r}) = \\frac{1}{4N} [ (p_{TT} + 4p_{NPD}) - (p_{TT}^2 + 4p_{TT}p_{NPD} + 4p_{NPD}^2) ] $$\n$$ Var(\\hat{r}) = \\frac{(p_{TT} + 4p_{NPD}) - (p_{TT} + 2p_{NPD})^2}{4N} $$\n这就是推导出的 $\\hat{r}$ 的大样本方差关于类型概率的表达式。\n\n为了获得该方差的数值估计，我们用样本比例替换真实概率：\n$$ \\widehat{Var}(\\hat{r}) = \\frac{(\\hat{p}_{TT} + 4\\hat{p}_{NPD}) - (\\hat{p}_{TT} + 2\\hat{p}_{NPD})^2}{4N} $$\n首先，我们计算比例：\n$$ \\hat{p}_{TT} = \\frac{250}{800} = 0.3125, \\quad \\hat{p}_{NPD} = \\frac{30}{800} = 0.0375 $$\n然后我们计算方差公式中的各项：\n$$ \\hat{p}_{TT} + 4\\hat{p}_{NPD} = 0.3125 + 4(0.0375) = 0.3125 + 0.15 = 0.4625 $$\n$$ \\hat{p}_{TT} + 2\\hat{p}_{NPD} = 0.3125 + 2(0.0375) = 0.3125 + 0.075 = 0.3875 $$\n注意，正如预期的那样，$\\hat{p}_{TT} + 2\\hat{p}_{NPD} = 2\\hat{r} = 2(0.19375) = 0.3875$。\n将这些代入方差估计公式：\n$$ \\widehat{Var}(\\hat{r}) = \\frac{0.4625 - (0.3875)^2}{4(800)} = \\frac{0.4625 - 0.15015625}{3200} = \\frac{0.31234375}{3200} \\approx 9.76074 \\times 10^{-5} $$\n标准误 (SE) 是估计方差的平方根：\n$$ \\mathrm{SE}(\\hat{r}) = \\sqrt{\\widehat{Var}(\\hat{r})} \\approx \\sqrt{9.76074 \\times 10^{-5}} \\approx 0.009879646 $$\n使用正态近似构建 $r$ 的 $95\\%$ 置信区间：$\\hat{r} \\pm z_{0.975} \\, \\mathrm{SE}(\\hat{r})$。其中 $z_{0.975} = 1.96$：\n误差范围 $= 1.96 \\times 0.009879646 \\approx 0.0193641$\n置信区间为：\n$$ 0.19375 \\pm 0.0193641 $$\n下界：$0.19375 - 0.0193641 = 0.1743859$\n上界：$0.19375 + 0.0193641 = 0.2131141$\n\n最后，按要求将结果四舍五入至四位有效数字：\n点估计 $\\hat{r} = 0.1938$\n下界 $= 0.1744$\n上界 $= 0.2131$\n\n这些值以单行矩阵的形式报告。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.1938 & 0.1744 & 0.2131 \\end{pmatrix} } $$", "id": "2817196"}]}