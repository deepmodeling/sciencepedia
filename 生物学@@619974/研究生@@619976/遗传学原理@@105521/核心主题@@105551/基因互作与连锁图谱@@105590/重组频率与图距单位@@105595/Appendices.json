{"hands_on_practices": [{"introduction": "本练习旨在巩固从实验数据中计算重组频率和遗传图距的核心技能。通过分析一次标准测交的后代群体产生的配子比例，你将可以直接应用重组率的定义，并将其转换为遗传作图的基本单位（图距单位，m.u. 或厘摩，cM）。这是构建任何遗传连锁图谱的第一步，也是最基本的一步。[@problem_id:1472918]", "problem": "一位农业遗传学家正在研究一种新的观赏植物品种。其中两个性状特别引人关注：花瓣颜色和叶片质地。控制花瓣颜色的基因有一个显性等位基因 $P$（紫色花瓣）和一个隐性等位基因 $p$（白色花瓣）。控制叶片质地的基因有一个显性等位基因 $T$（坚韧叶片）和一个隐性等位基因 $t$（柔软叶片）。\n\n这位遗传学家进行了一次测交。一个对这两个基因都为杂合的双杂合体植株被用作亲本之一。通过观察该杂交产生的大量后代的表型，对其配子进行了分析。分析显示，这个双杂合体亲本产生的配子比例如下：\n- 40% 携带等位基因 $P$ 和 $T$。\n- 10% 携带等位基因 $P$ 和 $t$。\n- 10% 携带等位基因 $p$ 和 $T$。\n- 40% 携带等位基因 $p$ 和 $t$。\n\n根据这些结果，计算花瓣颜色基因（$P$）和叶片质地基因（$T$）之间的遗传图距。将图距以图距单位（m.u.）表示。", "solution": "在双杂合体 $PpTt$ 与纯合隐性个体 $pptt$ 的测交中，每个后代的表型直接反映了来自双杂合体亲本的单个配子中的等位基因组合。因此，观察到的后代比例等于双杂合体产生的配子比例。\n\n给出的双杂合体配子比例如下：$f(PT)=0.40$，$f(Pt)=0.10$，$f(pT)=0.10$ 和 $f(pt)=0.40$。这两个频率最高的类别确定了亲本型（非重组）配子，即 $PT$ 和 $pt$，表明其连锁相为 $PT/pt$。频率较低的类别，$Pt$ 和 $pT$，是重组配子。\n\n根据定义，重组率 $r$ 是重组配子所占的比例：\n$$\nr = f(Pt) + f(pT) = 0.10 + 0.10 = 0.20.\n$$\n以图距单位表示的遗传图距 $d$ 定义为 $1$ 个图距单位对应于 $0.01$ 的重组率，因此\n$$\nd = 100 \\times r = 100 \\times 0.20 = 20.\n$$\n因此，基因 $P$ 和 $T$ 相距 $20$ 个图距单位。", "answer": "$$\\boxed{20}$$", "id": "1472918"}, {"introduction": "遗传图距的计算不仅仅是得出一个数值，更重要的是理解其统计特性。本练习将引导你超越简单的点估计，深入探讨遗传作图的统计基础。你将从第一性原理出发，推导连锁距离的最大似然估计量（$\\hat{d}$），并利用大样本理论计算其标准误，从而学会量化遗传图谱的置信度，这在任何严谨的科学研究中都是至关重要的一步。[@problem_id:2845266]", "problem": "一个在两个共显性基因座上杂合的二倍体生物与一个纯合隐性测试体进行杂交，并对所得子代的基因型进行评分，以便明确区分由该杂合体贡献的重组配子和非重组配子。假设在一个包含 $n = 1000$ 个独立子代的样本中，有 $k = 150$ 个在这两个基因座之间发生了重组。\n\n假设以下基本前提：\n- 每个子代反映了来自杂合体的单个减数分裂产物，并且对于每次减数分裂，重组指示变量是一个伯努利随机变量，其参数等于重组率 $r \\in (0, \\frac{1}{2})$。\n- 在经典的无干涉交换形成模型（Haldane 模型）下，二价体上两个基因座之间区间的交换遵循均匀泊松过程，并且在没有染色单体干涉的情况下，一条焦点染色单体以 $1/2$ 的概率独立参与每次交换。\n- 图距 $d$ 以摩尔根（Morgan）为单位测量，其中 $1$ 摩尔根等于 $100$ 厘摩（cM）。\n- 当且仅当一条染色单体在该区间内经历奇数次交换时，它相对于这两个基因座是重组的。\n\n从这些假设出发，并且不引用任何现成的作图函数恒等式，完成以下任务：\n1. 在伯努利抽样模型下，写出 $r$ 的似然函数，并推导出最大似然估计量 $\\hat{r}$。\n2. 使用交换的泊松模型和上述重组的定义，推导连接 $r$ 和 $d$ 的函数关系，并将其反转以将 $d$表示为 $r$ 的函数。利用此关系获得 $\\hat{d}$。\n3. 使用大样本似然理论和适当的变换论证，推导出 $\\hat{d}$ 的渐近标准误（以摩尔根为单位）关于 $n$ 和 $r$ 的显式表达式，然后代入 $\\hat{r}$ 进行计算。最后，将此标准误转换为厘摩。\n\n报告 $\\hat{d}$ 的渐近标准误的数值，以厘摩为单位。将答案四舍五入到四位有效数字。最终答案以 cM 表示。", "solution": "对问题陈述进行验证。\n\n逐字提取给定条件：\n- 一个在两个共显性基因座上杂合的二倍体生物与一个纯合隐性测试体进行杂交。\n- 样本大小：$n = 1000$ 个独立子代。\n- 重组体数量：$k = 150$。\n- 每个子代是一个单一的减数分裂产物。\n- 重组指示变量是一个伯努利随机变量，其参数为 $r \\in (0, \\frac{1}{2})$。\n- 交换遵循均匀泊松过程（Haldane 模型）。\n- 一条染色单体以 $1/2$ 的概率参与一次交换（无染色单体干涉）。\n- 图距 $d$ 以摩尔根为单位；$1$ 摩尔根 $= 100$ 厘摩。\n- 如果一条染色单体经历奇数次交换，则为重组体。\n\n根据验证标准对问题进行评估：\n- **科学依据**：该问题基于经典遗传学和统计推断的基本既定原则（连锁分析、Haldane 作图函数、最大似然估计、delta 方法）。该模型是理论遗传学的基石。\n- **良定性**：该问题定义明确，提供了所有必要的参数和假设，以推导出唯一且有意义的解。\n- **客观性**：语言精确、技术性强，且不含主观内容。\n\n该问题被认定为科学上合理、完整且无歧义。这是理论遗传学和统计学中的一个标准练习。因此，该问题是有效的，我们继续进行解答。\n\n任务分为三个部分。\n\n**第 1 部分：$r$ 的似然函数和最大似然估计量**\n\n该实验包含对 $n = 1000$ 个独立减数分裂产物的抽样。每个产物要么以概率 $r$ 发生重组，要么以概率 $1-r$ 不发生重组。这构成了一个包含 $n$ 次伯努利试验的序列。观察到的重组总数 $k$ 服从二项分布。在大小为 $n$ 的样本中观察到 $k$ 个重组体的概率由以下公式给出：\n$$\nP(K=k | n, r) = \\binom{n}{k} r^k (1-r)^{n-k}\n$$\n似然函数 $L(r)$与此概率成正比。我们将其写作：\n$$\nL(r) = \\binom{n}{k} r^k (1-r)^{n-k}\n$$\n为了找到最大似然估计量（MLE）$\\hat{r}$，我们要最大化 $L(r)$。在计算上，最大化对数似然函数 $\\ell(r) = \\ln L(r)$ 更简单：\n$$\n\\ell(r) = \\ln\\left(\\binom{n}{k}\\right) + k \\ln(r) + (n-k) \\ln(1-r)\n$$\n我们对 $\\ell(r)$ 关于 $r$ 求导，并令导数等于零：\n$$\n\\frac{d\\ell(r)}{dr} = \\frac{k}{r} - \\frac{n-k}{1-r} = 0\n$$\n解出 $r$：\n$$\n\\frac{k}{r} = \\frac{n-k}{1-r} \\implies k(1-r) = r(n-k) \\implies k - kr = nr - kr \\implies k = nr\n$$\n这给出了重组率 $r$ 的最大似然估计量：\n$$\n\\hat{r} = \\frac{k}{n}\n$$\n给定 $k = 150$ 和 $n = 1000$，估计值为：\n$$\n\\hat{r} = \\frac{150}{1000} = 0.15\n$$\n\n**第 2 部分：重组率 $r$ 与图距 $d$ 之间的关系**\n\n以摩尔根为单位的图距 $d$ 定义为在目标区间内，单条染色单体的预期交换次数。在标准模型下，考虑的是二价体（包含四条染色单体的结构）上的交换，整个二价体的平均交换数为 $2d$。设 $X$ 为二价体上交换次数的随机变量。根据 Haldane 模型，$X$ 服从均值为 $2d$ 的泊松分布：\n$$\nX \\sim \\text{Poisson}(2d), \\quad P(X=x) = \\frac{\\exp(-2d)(2d)^x}{x!} \\quad \\text{for } x = 0, 1, 2, \\ldots\n$$\n如果一条给定的染色单体参与了奇数次交换，那么它就是重组的。在无染色单体干涉的情况下，一条染色单体参与任何一次给定交换的概率是 $1/2$。如果二价体上有 $x$ 次交换，我们关注的焦点染色单体参与的次数服从二项分布 $\\text{Binomial}(x, 1/2)$。给定总共有 $x$ 次交换，它参与奇数次交换的概率，如果 $x=0$ 则为 $0$，如果 $x>0$ 则为 $1/2$。\n\n重组率 $r$ 是一条染色单体发生重组的总概率。我们通过以交换次数 $X$为条件来计算这个概率：\n$$\nr = P(\\text{recombinant}) = \\sum_{x=0}^{\\infty} P(\\text{recombinant} | X=x) P(X=x)\n$$\n$$\nr = P(\\text{recombinant} | X=0) P(X=0) + \\sum_{x=1}^{\\infty} P(\\text{recombinant} | X=x) P(X=x)\n$$\n$$\nr = (0) \\cdot P(X=0) + \\sum_{x=1}^{\\infty} \\left(\\frac{1}{2}\\right) P(X=x) = \\frac{1}{2} \\sum_{x=1}^{\\infty} P(X=x)\n$$\n由于 $\\sum_{x=0}^{\\infty} P(X=x) = 1$，我们有 $\\sum_{x=1}^{\\infty} P(X=x) = 1 - P(X=0)$。因此：\n$$\nr = \\frac{1}{2} (1 - P(X=0))\n$$\n对于均值为 $2d$ 的泊松分布，$P(X=0) = \\exp(-2d)$。代入此式，得到 Haldane 作图函数：\n$$\nr = \\frac{1}{2} (1 - \\exp(-2d))\n$$\n我们必须反转此函数，以将距离 $d$ 表示为重组率 $r$ 的函数：\n$$\n2r = 1 - \\exp(-2d) \\implies \\exp(-2d) = 1 - 2r \\implies -2d = \\ln(1-2r)\n$$\n$$\nd(r) = -\\frac{1}{2} \\ln(1 - 2r)\n$$\n根据最大似然估计量的不变性，$d$ 的最大似然估计量是：\n$$\n\\hat{d} = d(\\hat{r}) = -\\frac{1}{2} \\ln(1 - 2\\hat{r})\n$$\n\n**第 3 部分：$\\hat{d}$ 的渐近标准误**\n\n我们使用 delta 方法来找到 $\\hat{d}$ 的渐近方差。公式为：\n$$\n\\text{Var}(\\hat{d}) \\approx \\left(\\frac{d(d)}{dr}\\bigg|_{r=\\hat{r}}\\right)^2 \\text{Var}(\\hat{r})\n$$\n首先，我们找到 $\\hat{r}$ 的大样本方差。对于单次伯努利试验，费雪信息为 $1/(r(1-r))$。对于 $n$ 次试验，费雪信息为 $I(r) = n/(r(1-r))$。$\\hat{r}$ 的渐近方差是费雪信息的倒数：\n$$\n\\text{Var}(\\hat{r}) \\approx \\frac{1}{I(r)} = \\frac{r(1-r)}{n}\n$$\n接下来，我们求 $d(r)$ 的导数：\n$$\n\\frac{d(d)}{dr} = \\frac{d}{dr}\\left(-\\frac{1}{2} \\ln(1-2r)\\right) = -\\frac{1}{2} \\cdot \\frac{1}{1-2r} \\cdot (-2) = \\frac{1}{1-2r}\n$$\n现在我们将这些结果结合起来，求 $\\hat{d}$ 的渐近方差：\n$$\n\\text{Var}(\\hat{d}) \\approx \\left(\\frac{1}{1-2r}\\right)^2 \\frac{r(1-r)}{n} = \\frac{r(1-r)}{n(1-2r)^2}\n$$\n$\\hat{d}$ 的渐近标准误是方差的平方根：\n$$\n\\text{SE}(\\hat{d}) = \\sqrt{\\frac{r(1-r)}{n(1-2r)^2}} = \\frac{\\sqrt{r(1-r)}}{(1-2r)\\sqrt{n}}\n$$\n我们将此表达式在 MLE $\\hat{r} = 0.15$ 和 $n = 1000$ 处进行求值：\n$$\n\\widehat{\\text{SE}}(\\hat{d}) = \\frac{\\sqrt{0.15(1-0.15)}}{(1-2(0.15))\\sqrt{1000}} = \\frac{\\sqrt{0.15 \\cdot 0.85}}{(1-0.3)\\sqrt{1000}} = \\frac{\\sqrt{0.1275}}{0.7\\sqrt{1000}}\n$$\n计算数值：\n$$\n\\widehat{\\text{SE}}(\\hat{d}) \\approx \\frac{0.3570714}{0.7 \\cdot 31.622777} \\approx \\frac{0.3570714}{22.135944} \\approx 0.0161313 \\text{ 摩尔根}\n$$\n问题要求以厘摩（cM）为单位的标准误。我们使用换算关系 $1$ 摩尔根 $= 100$ cM：\n$$\n\\widehat{\\text{SE}}(\\hat{d})_{\\text{cM}} = \\widehat{\\text{SE}}(\\hat{d})_{\\text{Morgans}} \\times 100 \\approx 0.0161313 \\times 100 = 1.61313 \\text{ cM}\n$$\n四舍五入到四位有效数字，我们得到 $1.613$ cM。", "answer": "$$\\boxed{1.613}$$", "id": "2845266"}, {"introduction": "从重组频率（$r$）到图距（$d$）的转换依赖于对交叉事件的数学模型。这个高级计算练习探讨了一个核心问题：当我们用于推断的作图函数（如Haldane或Kosambi模型）与真实的生物学过程不匹配时会发生什么？通过编程实现不同模型并计算估计偏差，你将深刻理解不同作图函数背后的假设及其对遗传距离估计稳健性的影响。[@problem_id:2845250]", "problem": "您需要实现一个完整的、确定性的程序，用于评估在存在交换干涉的情况下，由于作图函数设定错误导致的距离推断的稳健性。该程序必须为一组测试用例计算，当真实的重组分数是由一个不同的、具有干涉效应的交换过程生成时，两种广泛使用的作图函数如何根据观测到的重组分数推断遗传距离。核心定义如下。一个遗传区间的真实遗传距离为 $d$ 摩尔根（M），其中 1 摩尔根对应于每次减数分裂中每条染色单体上发生 1 次交换的期望值。单位厘摩尔根（cM）的定义为 100 厘摩尔根等于 1 摩尔根。重组分数 $r(d)$ 是指减数分裂为界定该区间的两个基因座产生一条重组型染色单体的概率，这等价于在该区间内发生奇数次交换的概率。作图函数是 $r$ 和 $d$ 之间的一种可逆关系。Haldane 作图函数假设染色单体上的交换是一个无干涉的泊松更新过程。Kosambi 作图函数假设存在具有特定局部依赖结构的正干涉。在本任务中，“真实”重组分数将由卡方干涉模型（也称计数模型）生成，其整数干涉参数为 $m \\in \\{0,1,2,\\dots\\}$。在该模型中，染色单体上的交换间距服从形状参数为 $m+1$、均值为 1 摩尔根的爱尔朗分布。对于每个测试用例，程序必须执行以下所有步骤：\n- 将提供的真实距离 $d_{\\mathrm{true}}$（单位为厘摩尔根 cM）使用 $d_{\\mathrm{M}} = d_{\\mathrm{true}}/100$ 转换为摩尔根（M）。\n- 在卡方干涉模型下，使用参数 $m$ 计算“真实”重组分数 $r_{\\mathrm{true}}$，该分数是长度为 $d_{\\mathrm{M}}$ 的区间内发生奇数次交换的概率。\n- 仅使用观测到的 $r_{\\mathrm{true}}$，通过分别对 Haldane 作图函数和 Kosambi 作图函数求逆，计算出两个推断距离 $\\widehat{d}_{\\mathrm{H}}$ 和 $\\widehat{d}_{\\mathrm{K}}$（单位为摩尔根）。\n- 将这些推断距离转换为厘摩尔根，并报告它们相对于 $d_{\\mathrm{true}}$ 的偏差，偏差以厘摩尔根为单位，计算公式为 $b_{\\mathrm{H}} = 100\\,\\widehat{d}_{\\mathrm{H}} - d_{\\mathrm{true}}$ 和 $b_{\\mathrm{K}} = 100\\,\\widehat{d}_{\\mathrm{K}} - d_{\\mathrm{true}}$。\n- 报告三元组 $\\big[r_{\\mathrm{true}}, b_{\\mathrm{H}}, b_{\\mathrm{K}}\\big]$。\n\n所有概率必须以小数表示，而非百分比。所有距离和偏差必须以厘摩尔根（cM）表示。您的程序必须将每个报告值四舍五入到恰好 $6$ 位小数。\n\n测试套件。您的程序必须评估以下测试用例，这些用例以有序对 $\\big(d_{\\mathrm{true}}\\ \\text{(cM)},\\ m\\big)$ 的形式指定：\n- 案例 1：$(0.5,\\ 0)$，\n- 案例 2：$(10.0,\\ 1)$，\n- 案例 3：$(40.0,\\ 5)$，\n- 案例 4：$(90.0,\\ 1)$，\n- 案例 5：$(2.0,\\ 10)$。\n\n最终输出格式。您的程序应生成单行输出，该输出是一个用方括号括起来的、以逗号分隔的列表，其中每个元素本身是按照测试套件顺序排列的三元列表，即每个案例的 $\\big[r_{\\mathrm{true}}, b_{\\mathrm{H}}, b_{\\mathrm{K}}\\big]$。例如，输出必须类似 $[[x_1,y_1,z_1],[x_2,y_2,z_2],\\dots]$，其中每个数字都四舍五入到恰好 $6$ 位小数，且不含额外的空格或文本。\n\n科学现实性、基本依据与约束条件。您必须从以下基本定义出发：重组分数等于区间内发生奇数次交换的概率，并且作图函数提供了 $r$ 和 $d$ 之间的可逆关系。卡方干涉模型必须用于通过一个对整数 $m \\ge 0$ 成立的数学精确表达式，从 $d_{\\mathrm{M}}$ 和 $m$ 生成 $r_{\\mathrm{true}}$。Haldane 和 Kosambi 作图函数只能用于从观测到的 $r_{\\mathrm{true}}$ 反推出推断距离。不允许用户输入；程序必须能直接运行，并仅按指定格式打印所需的单行输出。", "solution": "在尝试任何解决方案之前，问题陈述都经过了严格的验证。\n\n**步骤 1：提取已知条件**\n\n- **核心定义**：\n    - 遗传距离 $d$，单位为摩尔根 ($\\mathrm{M}$) 或厘摩尔根 ($\\mathrm{cM}$)，其中 $100\\,\\mathrm{cM} = 1\\,\\mathrm{M}$。\n    - 重组分数 $r(d)$ 是发生奇数次交换的概率。\n    - 作图函数是 $r$ 和 $d$ 之间的一种可逆关系。\n- **真实交换过程**：\n    - 卡方干涉模型，整数干涉参数为 $m \\in \\{0, 1, 2, \\dots\\}$。\n    - 染色单体上的交换间距服从形状参数为 $m+1$、均值为 1 摩尔根的爱尔朗分布。\n- **推断模型**：\n    - Haldane 作图函数（无干涉）。\n    - Kosambi 作图函数（正干涉）。\n- **计算任务**：\n    1.  将真实距离 $d_{\\mathrm{true}}$（单位 cM）转换为摩尔根：$d_{\\mathrm{M}} = d_{\\mathrm{true}}/100$。\n    2.  使用卡方模型，根据 $d_{\\mathrm{M}}$ 和 $m$ 计算真实重组分数 $r_{\\mathrm{true}}$。\n    3.  使用 $r_{\\mathrm{true}}$ 对 Haldane 和 Kosambi 作图函数求逆，以找到推断距离 $\\widehat{d}_{\\mathrm{H}}$ 和 $\\widehat{d}_{\\mathrm{K}}$（单位为摩尔根）。\n    4.  计算偏差（单位 cM）：$b_{\\mathrm{H}} = 100\\,\\widehat{d}_{\\mathrm{H}} - d_{\\mathrm{true}}$ 和 $b_{\\mathrm{K}} = 100\\,\\widehat{d}_{\\mathrm{K}} - d_{\\mathrm{true}}$。\n    5.  报告三元组 $[r_{\\mathrm{true}}, b_{\\mathrm{H}}, b_{\\mathrm{K}}]$。\n- **数值与格式要求**：\n    - 所有报告值必须四舍五入到恰好 6 位小数。\n    - 最终输出必须是单行：一个列表的列表，例如 $[[x_1, y_1, z_1], [x_2, y_2, z_2], \\dots]$。\n- **测试套件**：\n    - 案例 1：$(d_{\\mathrm{true}} = 0.5, m = 0)$\n    - 案例 2：$(d_{\\mathrm{true}} = 10.0, m = 1)$\n    - 案例 3：$(d_{\\mathrm{true}} = 40.0, m = 5)$\n    - 案例 4：$(d_{\\mathrm{true}} = 90.0, m = 1)$\n    - 案例 5：$(d_{\\mathrm{true}} = 2.0, m = 10)$\n\n**步骤 2：使用提取的已知条件进行验证**\n\n- **有科学依据**：该问题基于遗传重组理论的基本和经典模型，包括 Haldane、Kosambi 和卡方交换干涉模型。这些是理论遗传学中的标准工具。\n- **良态问题**：这是一个良态问题。所需计算的每一步都已明确定义。输入已指定，所需输出无歧义。所涉及的数学函数在相关域内是良定义且可逆的。每个测试用例都存在唯一、稳定的解。\n- **客观性**：该问题使用了来自遗传学和数学的精确、客观和标准的术语。它不包含任何主观或基于观点的陈述。\n- **完整性与一致性**：问题陈述是自洽且内部一致的。它要求对卡方模型使用“一个数学精确表达式”。虽然这个表达式没有直接给出，但文献中存在一个根据给定前提推导出的标准公式。该公式将重组分数 $r$ 与图距 $d$（单位为摩尔根）以及干涉参数 $m$ 联系起来。通过注意到当 $m=0$ 时，卡方模型应该且确实会简化为无干涉的 Haldane 模型，从而证实了其一致性。\n\n**步骤 3：结论与行动**\n\n该问题是 **有效的**。它是一个在理论遗传学领域中合理、定义明确的计算问题。将提供一个完整的、论证充分的解决方案。\n\n这个任务是量化当作用函数被错误指定时，遗传距离估计中的误差或偏差。真实的遗传过程遵循卡方交换干涉模型，但遗传学家使用更简单的模型（假设无干涉 (Haldane) 或另一种形式的干涉 (Kosambi)）来推断距离。该过程是纯计算性的，并依赖于这些模型的精确数学定义。\n\n让我们来定义基本量。真实遗传距离，记为 $d_{\\mathrm{true}}$，以厘摩尔根（$\\mathrm{cM}$）为单位提供。在所有计算中，必须使用关系式 $d_{\\mathrm{M}} = d_{\\mathrm{true}}/100$ 将其转换为摩尔根（$\\mathrm{M}$）。摩尔根单位将图距定义为区间内单条染色单体上交换的期望数。\n\n“真实”重组分数 $r_{\\mathrm{true}}$ 是由具有给定整数参数 $m \\ge 0$ 的卡方干涉模型生成的。该模型假定一种特定形式的正交换干涉，即一次交换事件会抑制邻近区域另一次交换的形成。对于图距 $d_{\\mathrm{M}}$，重组分数由发生奇数次交换的概率给出。在基于交叉的卡方模型的标准公式下，这表示为：\n$$r_{\\mathrm{true}}(d_{\\mathrm{M}}, m) = \\frac{1}{2}\\left(1 - e^{-2 d_{\\mathrm{M}}} \\sum_{j=0}^{m} \\frac{(2 d_{\\mathrm{M}})^j}{j!}\\right)$$\n在此，$m=0$ 的情况对应无干涉，模型简化为 Haldane 模型，其中交换遵循泊松过程。随着 $m$ 的增加，干涉强度增强，意味着交换变得更加均匀间隔。\n\n在 $r_{\\mathrm{true}}$ 作为唯一“观测”数据的情况下，我们必须使用两种备选的作图函数来推断距离。\n\n1\\. Haldane 作图函数假设无干涉（$m=0$）。距离 $d$ 和重组分数 $r$ 之间的关系是：\n$$r_{\\mathrm{H}}(d) = \\frac{1}{2}(1 - e^{-2d})$$\n为了从观测到的 $r_{\\mathrm{true}}$ 推断距离 $\\widehat{d}_{\\mathrm{H}}$，我们必须对这个函数求逆：\n$$\\widehat{d}_{\\mathrm{H}}(r_{\\mathrm{true}}) = -\\frac{1}{2}\\ln(1 - 2r_{\\mathrm{true}})$$\n\n2\\. Kosambi 作图函数假设一种特定形式的正干涉。其关系是：\n$$r_{\\mathrm{K}}(d) = \\frac{1}{2}\\tanh(2d)$$\n对此函数求逆，得到推断距离 $\\widehat{d}_{\\mathrm{K}}$：\n$$\\widehat{d}_{\\mathrm{K}}(r_{\\mathrm{true}}) = \\frac{1}{2}\\mathrm{arctanh}(2r_{\\mathrm{true}}) = \\frac{1}{4}\\ln\\left(\\frac{1 + 2r_{\\mathrm{true}}}{1 - 2r_{\\mathrm{true}}}\\right)$$\n两个逆函数对于 $r_{\\mathrm{true}} \\in [0, 0.5)$ 均有效。\n\n每个测试用例 $(d_{\\mathrm{true}}, m)$ 的计算过程如下：\n首先，将真实距离转换为摩尔根：$d_{\\mathrm{M}} = d_{\\mathrm{true}}/100$。\n其次，使用带参数 $d_{\\mathrm{M}}$ 和 $m$ 的卡方模型公式计算 $r_{\\mathrm{true}}$。求和项 $\\sum_{j=0}^{m} \\frac{(2 d_{\\mathrm{M}})^j}{j!}$ 进行数值计算。\n第三，将此 $r_{\\mathrm{true}}$ 代入 Haldane 和 Kosambi 的逆公式，计算出估计距离 $\\widehat{d}_{\\mathrm{H}}$ 和 $\\widehat{d}_{\\mathrm{K}}$（单位为摩尔根）。\n第四，将这些估计距离转换回厘摩尔根：$\\widehat{d}_{\\mathrm{H,cM}} = 100 \\cdot \\widehat{d}_{\\mathrm{H}}$ 和 $\\widehat{d}_{\\mathrm{K,cM}} = 100 \\cdot \\widehat{d}_{\\mathrm{K}}$。\n最后，偏差计算为估计距离与真实距离之差（单位为厘摩尔根）：\n$$b_{\\mathrm{H}} = \\widehat{d}_{\\mathrm{H,cM}} - d_{\\mathrm{true}}$$\n$$b_{\\mathrm{K}} = \\widehat{d}_{\\mathrm{K,cM}} - d_{\\mathrm{true}}$$\n报告所得三元组 $[r_{\\mathrm{true}}, b_{\\mathrm{H}}, b_{\\mathrm{K}}]$，每个值都四舍五入到六位小数。当 $m>0$ 时，与无干涉情况相比，正干涉会降低给定 $d_{\\mathrm{M}}$ 的重组频率 $r_{\\mathrm{true}}$。因此，当 Haldane 和 Kosambi 函数接收到这个较低的 $r_{\\mathrm{true}}$ 时，它们会推断出更短的距离，从而导致负偏差（$b_{\\mathrm{H}} < 0$，$b_{\\mathrm{K}} < 0$），这一点将由实现来证明。", "answer": "```python\nimport numpy as np\n# The problem can be solved using numpy alone, scipy is not strictly necessary\n# if the Poisson-related sum is implemented manually, as done here.\n\ndef solve():\n    \"\"\"\n    Computes recombination fractions and distance inference biases for a set of test cases\n    according to the problem specification.\n    \"\"\"\n    # Test suite: (d_true in cM, m)\n    test_cases = [\n        (0.5, 0),\n        (10.0, 1),\n        (40.0, 5),\n        (90.0, 1),\n        (2.0, 10),\n    ]\n\n    results = []\n    \n    for d_true, m in test_cases:\n        # Step A: Convert true distance from centimorgans to Morgans.\n        d_M = d_true / 100.0\n\n        # Step B: Compute the true recombination fraction under the chi-square model.\n        # r_true = 0.5 * (1 - exp(-2*d_M) * sum_{j=0 to m} (2*d_M)^j / j!)\n        lambda_val = 2.0 * d_M\n        \n        # Calculate the sum term sum_{j=0 to m} (lambda^j / j!) efficiently.\n        # This avoids large numbers from factorials and powers by computing terms iteratively.\n        poisson_sum = 0.0\n        term = 1.0  # Term for j=0 is lambda^0/0! = 1\n        poisson_sum += term\n        for j in range(1, m + 1):\n            term *= lambda_val / j\n            poisson_sum += term\n            \n        r_true = 0.5 * (1.0 - np.exp(-lambda_val) * poisson_sum)\n\n        # Step C: Infer distances by inverting Haldane and Kosambi mapping functions.\n        # To avoid potential domain errors for log and arctanh if 2*r_true is very close to 1,\n        # we can clamp it slightly below, although this is not expected for the given models.\n        two_r_true = 2.0 * r_true\n        if two_r_true >= 1.0:\n            two_r_true = 1.0 - 1e-12\n\n        # Haldane inversion: d_H = -0.5 * log(1 - 2*r)\n        d_hat_H_M = -0.5 * np.log(1.0 - two_r_true)\n        \n        # Kosambi inversion: d_K = 0.5 * arctanh(2*r)\n        d_hat_K_M = 0.5 * np.arctanh(two_r_true)\n\n        # Step D: Convert inferred distances to cM and compute biases.\n        d_hat_H_cM = 100.0 * d_hat_H_M\n        d_hat_K_cM = 100.0 * d_hat_K_M\n        \n        b_H = d_hat_H_cM - d_true\n        b_K = d_hat_K_cM - d_true\n\n        # Step E: Store the triple [r_true, b_H, b_K]\n        results.append([r_true, b_H, b_K])\n\n    # Format the final output string as specified: [[r1,bH1,bK1],[r2,bH2,bK2],...]\n    # Each number is rounded to 6 decimal places.\n    formatted_results = []\n    for res in results:\n        # Format each number in the triple to 6 decimal places and join into a string like \"[x,y,z]\"\n        formatted_triple = f\"[{','.join([f'{v:.6f}' for v in res])}]\"\n        formatted_results.append(formatted_triple)\n    \n    # Join all triples with commas and enclose in brackets for the final output\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "2845250"}]}