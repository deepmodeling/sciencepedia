{"hands_on_practices": [{"introduction": "在遗传学研究中，一个核心挑战是区分表型是由遗传因素决定的，还是由环境因素模仿遗传效应产生的。这种由环境诱导、模拟特定基因型表型的现象被称为表型模仿（phenocopy）。这个思想实验 [@problem_id:2807824] 将引导你通过经典的遗传杂交实验设计，推导出区分真实遗传突变和环境诱导的表型模仿所需的一系列明确的、可验证的预测，从而奠定基因分析的逻辑基石。", "problem": "在一种模式生物中，可以观察到一个形态上显著不同的表型，记为 $P$。该生物具有一个对器官发育至关重要的、注释明确的基因座 $W$。考虑两种基于遗传学核心原理的因果模型：\n\n- 模型 G（遗传突变）：在标准环境 $E_0$ 下，当生物体为纯合子 $ww$ 时，位于基因 $W$ 上的一个隐性功能丧失等位基因 $w$ 会导致表型 $P$，且具有完全外显性。根据 Mendel 分离定律，杂合子自交产生的 $F_2$ 代基因型比例为 $1:2:1$ ($WW:Ww:ww$)，并且在完全外显的情况下，患病表型比例为 $1/4$。\n- 模型 E（环境拟表型）：野生型基因型 $WW$ 仅在发育窗口期 $t^\\*$ 内精确暴露于特定扰动 $E^\\*$ 时才会表现出表型 $P$；在没有 $E^\\*$ 的情况下，$WW$ 不会表现出 $P$。在这里，$P$ 模拟了 $ww$ 的效应，但并不需要突变等位基因。根据定义，拟表型是由环境诱导的，不通过 $w$ 的分离而遗传。\n\n一只野外捕获的雄性创始者表现出表型 $P$。你进行以下受控思想实验来判别模型 G 和模型 E：\n\n- 杂交 1：将患病雄性创始者与一只基因型经核实的实验室野生型雌性 $WW$ 交配；所有 $F_1$ 代在 $E_0$ 下（不暴露于 $E^\\*$）饲养。\n- 杂交 2：$F_1 \\times F_1$ 自交；所有 $F_2$ 代在 $E_0$ 下饲养。\n- 关联检验：同时，从实验室品系中组建病例和对照队列，并对 $W$ 附近的标记进行连锁/关联分析；检验 $P$ 是否在家系内与 $W$ 的等位基因共分离。\n- 诱导检验：在一个野生型品系 ($WW$) 中，将一个队列仅在 $t^\\*$ 期间暴露于 $E^\\*$，并饲养一个匹配的队列在 $E_0$ 环境下。\n\n假设样本量足够大，抽样误差可以忽略不计，并且 $E^\\*$ 暴露是随机化的，与基因型或合子性无关。\n\n下列哪一组观察结果与创始者的表型 $P$ 是一个拟表型（模型 E）而非由一个分离的突变等位基因（模型 G）引起的情况最一致？\n\nA. $E_0$ 环境下的 $F_1$ 代：$0\\%$ 表现出 $P$；$E_0$ 环境下的 $F_2$ 代：$0\\%$ 表现出 $P$；家系内连锁/关联分析未检测到 $P$ 与 $W$ 附近标记的共分离；在诱导检验中，暴露于 $E^\\*$ 的 $WW$ 动物中有比例为 $q>0$ 的个体表现出 $P$，而在 $E_0$ 环境下的个体中则有 $0\\%$ 表现出 $P$。\n\nB. $E_0$ 环境下的 $F_1$ 代：$0\\%$ 表现出 $P$；$E_0$ 环境下的 $F_2$ 代：约 $25\\%$ 表现出 $P$；家系内分析揭示了 $P$ 与 $W$ 处的一个单倍型存在共分离，重组率接近 $0$；在诱导检验中，$0\\%$ 的 $WW$ 动物在 $E^\\*$ 环境下表现出 $P$。\n\nC. 在一个群体队列中，一同抚养的双胞胎中，$P$ 的同卵双生子一致性在 $E_0$ 环境下远超异卵双生子一致性；在 $E_0$ 环境下的 $F_2$ 代中，约 $25\\%$ 表现出 $P$；家系内连锁在 $W$ 处呈阳性。\n\nD. $E_0$ 环境下的 $F_1$ 代：$0\\%$ 表现出 $P$；$E_0$ 环境下的 $F_2$ 代：约 $25\\%$ 表现出 $P$；家系内连锁在 $W$ 处呈阴性，但在 $W$ 附近观察到病例-对照关联的 $p<10^{-9}$；在诱导检验中，暴露于 $E^\\*$ 的 $WW$ 动物中有比例为 $q>0$ 的个体表现出 $P$。\n\n选择唯一最佳答案。", "solution": "必须首先验证问题陈述的科学性和逻辑完整性。\n\n### 步骤 1：提取已知条件\n- **表型**：$P$，形态上显著不同。\n- **基因座**：$W$，对器官发育至关重要。\n- **模型 G（遗传突变）**：\n    - 等位基因：$w$，位于基因座 $W$ 上的隐性功能丧失等位基因。\n    - 基因型-表型图谱：纯合子 $ww$ 导致表型 $P$。\n    - 环境：标准环境 $E_0$。\n    - 外显率：完全外显。\n    - 遗传方式：Mendel 分离。杂合子自交 ($Ww \\times Ww$) 产生的 $F_2$ 代基因型比例为 $1:2:1$ ($WW:Ww:ww$)，患病表型比例为 $\\frac{1}{4}$ ($P$)。\n- **模型 E（环境拟表型）**：\n    - 基因型-表型图谱：野生型基因型 $WW$ 仅在发育窗口期 $t^\\*$ 暴露于环境扰动 $E^\\*$ 时才表现出表型 $P$。\n    - 遗传方式：表型 $P$ 不通过等位基因 $w$ 的分离而遗传。\n- **创始动物**：一只野外捕获的雄性，表现出表型 $P$。\n- **实验设计**：\n    - **杂交 1**：创始雄性 ($P$) $\\times$ 实验室雌性 ($WW$，经核实)。$F_1$ 代在 $E_0$ 下饲养。\n    - **杂交 2**：$F_1 \\times F_1$ 自交。$F_2$ 代在 $E_0$ 下饲养。\n    - **关联检验**：对 $P$ 与基因座 $W$ 附近的标记进行连锁/关联检验，以确定共分离。\n    - **诱导检验**：将一批野生型 ($WW$) 动物在 $t^\\*$ 期间暴露于 $E^\\*$；一个匹配的批次在 $E_0$ 下饲养。\n- **假设**：\n    - 样本量大，抽样误差可忽略。\n    - 暴露于 $E^\\*$ 是随机的，与基因型无关。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学上成立**：该问题基于遗传学的基本原理，包括 Mendel 遗传、隐性等位基因、拟表型、连锁分析和受控杂交。这些概念是该学科的核心。\n2.  **问题定义明确**：问题提出了两个互斥的假说（模型 G vs. 模型 E），以及一组旨在区分它们的实验。问题要求确定哪组实验结果支持其中一个假说。这种结构允许得出唯一的逻辑解。\n3.  **客观性**：语言精确且技术性强。所有术语（$P$、$W$、$w$、$E_0$、$E^\\*$、拟表型、完全外显）都有定义或是遗传学中的标准术语。实验设置的描述是客观的。\n4.  **完整性**：问题提供了足够的信息来推断每种模型下的预期结果。没有缺失关键数据。\n5.  **一致性**：给定的条件内部是一致的。模型和实验设计不含矛盾。\n\n### 步骤 3：结论与行动\n问题陈述是有效的。这是一个在遗传学领域中表述清晰的问题，需要基于既定原则进行逻辑推导。我们可以继续进行解答。\n\n### 解题推导\n任务是确定哪一组观察结果与创始者的表型是拟表型（模型 E）最一致。为此，我们必须首先预测在两种模型下各自的实验结果。\n\n**模型 G（遗传原因）下的预测**\n如果创始雄性的表型 $P$ 是由隐性基因型 $ww$ 引起的，那么：\n- **杂交 1**：创始雄性 ($ww$) 与野生型雌性 ($WW$) 杂交。所有 $F_1$ 代后代的基因型必须为 $Ww$。由于等位基因 $w$ 是隐性的，且 $F_1$ 代在环境 $E_0$ 下饲养，它们的表型将是野生型。因此，$0\\%$ 的 $F_1$ 代会表现出表型 $P$。\n- **杂交 2**：$F_1$ 杂合子 ($Ww \\times Ww$) 自交将产生 $F_2$ 代后代，其基因型符合 $1:2:1$ 的 Mendel 比例（$WW:Ww:ww$）。由于完全外显，所有 $ww$ 个体都将表现出表型 $P$。因此，大约 $\\frac{1}{4}$ 或 $25\\%$ 的 $F_2$ 代将表现出表型 $P$。\n- **关联检验**：由于表型 $P$ 是由基因座 $W$ 的基因型直接引起的，表型将与 $w$ 等位基因（或与它完全连锁的标记）在家系内完美共分离。连锁分析将得出高度显著的结果。\n- **诱导检验**：根据模型 G 的定义，表型 $P$ 是遗传的。将野生型 ($WW$) 动物暴露于环境扰动 $E^\\*$ 不会产生任何效应。因此，这些动物中应该有 $0\\%$ 表现出 $P$。\n\n**模型 E（拟表型）下的预测**\n如果创始雄性是一个拟表型，他的基因型是野生型 ($WW$)，其表型 $P$ 是由在野外暴露于环境 ($E^\\*$) 所致。\n- **杂交 1**：创始雄性 ($WW$) 与野生型雌性 ($WW$) 杂交。所有 $F_1$ 代后代的基因型必须是 $WW$。由于它们在标准环境 $E_0$（不暴露于 $E^\\*$）下饲养，没有个体会表现出该表型。因此，$0\\%$ 的 $F_1$ 代会表现出表型 $P$。\n- **杂交 2**：$F_1$ 个体 ($WW \\times WW$) 自交将产生基因型完全为 $WW$ 的 $F_2$ 代。由于它们也在 $E_0$ 环境下饲养，它们不会暴露于诱导因素。因此，$0\\%$ 的 $F_2$ 代将表现出表型 $P$。\n- **关联检验**：创始者的表型 $P$ 不是遗传的。它出现在一个 $WW$ 个体中。因此，该表型在后续世代中不会与 $W$ 基因座的任何等位基因分离。连锁分析将找不到任何关联。\n- **诱导检验**：模型指出 $E^\\*$ 会在 $WW$ 个体中诱导表型 $P$。因此，将一批 $WW$ 动物暴露于 $E^\\*$ 将导致其中一部分（比例 $q>0$）表现出 $P$，而未暴露的对照组发病率为 $0\\%$。\n\n我们现在根据模型 E 的预测来评估每个选项。\n\n**选项 A 分析**\n- “$E_0$ 环境下的 $F_1$ 代：$0\\%$ 表现出 $P$”：这与两种模型都一致。\n- “$E_0$ 环境下的 $F_2$ 代：$0\\%$ 表现出 $P$”：这与模型 E 一致，但与模型 G 相矛盾（模型 G 预测为 $25\\%$）。\n- “家系内连锁/关联分析未检测到 $P$ 与 $W$ 附近标记的共分离”：这与模型 E 一致，因为该性状不可遗传。它与模型 G 相矛盾。\n- “在诱导检验中，暴露于 $E^\\*$ 的 $WW$ 动物中有比例 $q>0$ 的个体表现出 $P$，而在 $E_0$ 环境下的个体中则有 $0\\%$ 表现出 $P$”：这是对模型 E 中定义的拟表型的决定性检验。它证实了环境而非基因型可以导致该表型。这个结果与模型 G 相矛盾。\n**结论**：此选项中的所有观察结果都与模型 E 完全一致，且与模型 G 不一致。这是对拟表型的正确描述。\n\n**选项 B 分析**\n- “$E_0$ 环境下的 $F_1$ 代：$0\\%$ 表现出 $P$”：与两种模型都一致。\n- “$E_0$ 环境下的 $F_2$ 代：约 $25\\%$ 表现出 $P$”：这是隐性性状的经典 Mendel 比例，强烈支持模型 G，并与模型 E 预测的 $0\\%$ 相矛盾。\n- “家系内分析揭示了 $P$ 与 $W$ 处的一个单倍型存在共分离”：这表明存在与基因座 $W$ 相关的遗传原因，支持模型 G，与模型 E 相矛盾。\n- “在诱导检验中，$0\\%$ 的 $WW$ 动物在 $E^\\*$ 环境下表现出 $P$”：这意味着环境不诱导该表型，支持模型 G，与模型 E 相矛盾。\n**结论**：这些观察结果是遗传原因（模型 G）的教科书式案例，而不是拟表型。此选项 **不正确**。\n\n**选项 C 分析**\n- “在一个群体队列中，一同抚养的双胞胎中，$P$ 的同卵双生子一致性在 $E_0$ 环境下远超异卵双生子一致性”：基因完全相同的双胞胎具有更高的一致性，是性状具有遗传基础的有力证据。这支持模型 G。\n- “在 $E_0$ 环境下的 $F_2$ 代中，约 $25\\%$ 表现出 $P$”：与选项 B 一样，这支持模型 G，与模型 E 相矛盾。\n- “家系内连锁在 $W$ 处呈阳性”：这再次指向位于基因座 $W$ 的遗传原因，支持模型 G。\n**结论**：此选项描述了一个具有明确遗传起因的性状，与模型 G 一致，而非模型 E。此选项 **不正确**。\n\n**选项 D 分析**\n- “$E_0$ 环境下的 $F_1$ 代：$0\\%$ 表现出 $P$”：与两种模型都一致。\n- “$E_0$ 环境下的 $F_2$ 代：约 $25\\%$ 表现出 $P$”：这强烈支持模型 G，并且与创始人是简单拟表型（模型 E）时应观察到的情况直接矛盾。\n- “家系内连锁在 $W$ 处呈阴性，但在 $W$ 附近观察到病例-对照关联的 $p<10^{-9}$”：这是一个令人困惑且可能自相矛盾的陈述。如果 $W$ 处的单个隐性基因导致该表型并在家系中分离产生 $25\\%$ 的比例，连锁*必须*是阳性的。然而，强烈的关联信号仍然指向 $W$ 附近的遗传基础。$F_2$ 的结果是最直接的证据。\n- “在诱导检验中，暴露于 $E^\\*$ 的 $WW$ 动物中有比例 $q>0$ 的个体表现出 $P$”：这支持模型 E。\n**结论**：此选项呈现了相互矛盾的结果。$F_2$ 中 $25\\%$ 的表型证明了一个隐性等位基因正在分离，这要求创始者是 $ww$（或至少是 $Ww$，但未给出此信息）。这一结果与创始者是 $WW$ 拟表型的假设不相容。这些结果的组合可能暗示了一个更复杂的场景，如基因-环境相互作用，即两种因素都可能导致该表型，但这并不是与创始人特定情况是模型 E 所定义的简单拟表型*最一致*的观察结果集。模型 E 明确预测 $F_2$ 中有 $0\\%$ 的患病者。选项 A 是一组清晰、内部一致的观察结果，与模型 E 的预测完全匹配。因此，选项 D 是 **不正确的**。\n\n基于系统性评估，选项 A 中的观察结果集为创始者表型是拟表型（模型 E）的假说提供了明确的支持，同时驳斥了遗传假说（模型 G）。", "answer": "$$\\boxed{A}$$", "id": "2807824"}, {"introduction": "一旦我们认识到基因和环境的共同作用，下一个关键问题便是如何量化它们之间的相互作用。基因型与环境互作（$G \\times E$）描述了不同基因型在不同环境下的反应差异，是理解表型可塑性的核心。本练习 [@problem_id:2807674] 将指导你使用经典的统计方法——方差分析（ANOVA），亲手分解表型变异，并计算出互作效应的统计显著性，让你对这一重要概念获得定量的、具象的理解。", "problem": "一位植物育种家正在研究环境条件如何改变可观察性状并可能产生拟表型（phenocopies），即环境影响模拟遗传效应。为量化基因型与环境的交互作用（genotype-by-environment interaction），该育种家在 $J=3$ 个受控环境中种植了 $I=3$ 个近交基因型，每个基因型-环境组合有 $r=2$ 个重复个体。测量的表型是幼苗高度。数据如下：\n\n- 基因型 $G_{1}$：\n  - 环境 $E_{1}$：$10$, $11$\n  - 环境 $E_{2}$：$12$, $12$\n  - 环境 $E_{3}$：$14$, $15$\n- 基因型 $G_{2}$：\n  - 环境 $E_{1}$：$12$, $11$\n  - 环境 $E_{2}$：$11$, $10$\n  - 环境 $E_{3}$：$10$, $9$\n- 基因型 $G_{3}$：\n  - 环境 $E_{1}$：$14$, $13$\n  - 环境 $E_{2}$：$13$, $14$\n  - 环境 $E_{3}$：$12$, $11$\n\n使用方差分析（ANOVA; Analysis of Variance）的框架，将基因型和环境视为具有重复的平衡双因素布局中的固定效应。从方差分解的第一性原理出发，计算基因型与环境交互作用的平方和以及适当的均方误差，并构建 $F$ 统计量来检验不存在基因型与环境交互作用的原假设。指明用于交互作用项和误差项的自由度。\n\n仅报告交互作用的 $F$ 统计量作为最终答案。将您的答案四舍五入到 $4$ 位有效数字。$F$ 统计量是无量纲的，不需要单位。", "solution": "该问题陈述具有科学依据、提法明确且客观。它提出了一个数量遗传学中的标准实验设计，需要使用双因素方差分析 (ANOVA) 进行分析。所有必要的数据都已提供，约束条件一致，且问题存在唯一解。因此，该问题是有效的，我们开始求解。\n\n该问题要求从第一性原理计算基因型与环境交互作用的 $F$ 统计量。我们得到一个平衡双因素布局，其中有 $I=3$ 个基因型， $J=3$ 个环境，以及每个单元格 $r=2$ 个重复。观测总数为 $N = I \\times J \\times r = 3 \\times 3 \\times 2 = 18$。观测值 $y_{ijk}$（在环境 $j$ 中基因型 $i$ 的第 $k$ 个重复的表型）的统计模型是：\n$$y_{ijk} = \\mu + G_i + E_j + (GE)_{ij} + \\epsilon_{ijk}$$\n其中 $\\mu$ 是总平均值，$G_i$ 是第 $i$ 个基因型的固定效应，$E_j$ 是第 $j$ 个环境的固定效应，$(GE)_{ij}$ 是交互作用效应，$\\epsilon_{ijk}$ 是随机误差项。\n\n首先，我们整理数据并计算单元格总和 $T_{ij.} = \\sum_{k=1}^{r} y_{ijk}$，以及基因型的边际总和 $T_{i..} = \\sum_{j=1}^{J} T_{ij.}$ 和环境的边际总和 $T_{.j.} = \\sum_{i=1}^{I} T_{ij.}$。\n\n单元格总和 $T_{ij.}$ 如下：\n\\begin{itemize}\n    \\item $G_1, E_1: 10 + 11 = 21$\n    \\item $G_1, E_2: 12 + 12 = 24$\n    \\item $G_1, E_3: 14 + 15 = 29$\n    \\item $G_2, E_1: 12 + 11 = 23$\n    \\item $G_2, E_2: 11 + 10 = 21$\n    \\item $G_2, E_3: 10 + 9 = 19$\n    \\item $G_3, E_1: 14 + 13 = 27$\n    \\item $G_3, E_2: 13 + 14 = 27$\n    \\item $G_3, E_3: 12 + 11 = 23$\n\\end{itemize}\n\n边际总和如下：\n\\begin{itemize}\n    \\item 基因型总和 ($T_{i..}$):\n    \\begin{itemize}\n        \\item $T_{1..} = 21 + 24 + 29 = 74$\n        \\item $T_{2..} = 23 + 21 + 19 = 63$\n        \\item $T_{3..} = 27 + 27 + 23 = 77$\n    \\end{itemize}\n    \\item 环境总和 ($T_{.j.}$):\n    \\begin{itemize}\n        \\item $T_{.1.} = 21 + 23 + 27 = 71$\n        \\item $T_{.2.} = 24 + 21 + 27 = 72$\n        \\item $T_{.3.} = 29 + 19 + 23 = 71$\n    \\end{itemize}\n\\end{itemize}\n总计为 $T_{...} = 74 + 63 + 77 = 214$。作为核对，$T_{...} = 71 + 72 + 71 = 214$。\n\nANOVA 的核心是将总平方和 ($SS_{Total}$)，即与总平均值的总离差平方和，分解为可归因于不同变异来源的组成部分。\n$$SS_{Total} = SS_{G} + SS_{E} + SS_{GE} + SS_{Error}$$\n我们使用平方和的标准计算公式，从修正项 $CT = \\frac{T_{...}^2}{N}$ 开始。\n$$CT = \\frac{(214)^2}{18} = \\frac{45796}{18} = \\frac{22898}{9}$$\n\n计算过程如下：\n\n1.  **总平方和 ($SS_{Total}$):** $SS_{Total} = \\sum_{i,j,k} y_{ijk}^2 - CT$。\n    $$\\sum_{i,j,k} y_{ijk}^2 = 10^2+11^2+12^2+12^2+14^2+15^2+12^2+11^2+11^2+10^2+10^2+9^2+14^2+13^2+13^2+14^2+12^2+11^2 = 2592$$\n    $$SS_{Total} = 2592 - \\frac{22898}{9} = \\frac{23328 - 22898}{9} = \\frac{430}{9}$$\n\n2.  **误差平方和 ($SS_{Error}$):** 这代表单元格内变异。它是所有观测值的平方和与单元格总和的平方和除以重复数之差。\n    $$SS_{Error} = \\sum_{i,j,k} y_{ijk}^2 - \\sum_{i,j} \\frac{T_{ij.}^2}{r}$$\n    单元格总和的平方和为：\n    $$\\sum_{i,j} \\frac{T_{ij.}^2}{r} = \\frac{1}{2}(21^2 + 24^2 + 29^2 + 23^2 + 21^2 + 19^2 + 27^2 + 27^2 + 23^2) = \\frac{1}{2}(5176) = 2588$$\n    因此，\n    $$SS_{Error} = 2592 - 2588 = 4$$\n\n3.  **基因型平方和 ($SS_{G}$):**\n    $$SS_{G} = \\sum_{i} \\frac{T_{i..}^2}{Jr} - CT = \\frac{1}{3 \\times 2}(74^2 + 63^2 + 77^2) - \\frac{22898}{9} = \\frac{15374}{6} - \\frac{22898}{9} = \\frac{7687}{3} - \\frac{22898}{9} = \\frac{23061 - 22898}{9} = \\frac{163}{9}$$\n\n4.  **环境平方和 ($SS_{E}$):**\n    $$SS_{E} = \\sum_{j} \\frac{T_{.j.}^2}{Ir} - CT = \\frac{1}{3 \\times 2}(71^2 + 72^2 + 71^2) - \\frac{22898}{9} = \\frac{15266}{6} - \\frac{22898}{9} = \\frac{7633}{3} - \\frac{22898}{9} = \\frac{22899 - 22898}{9} = \\frac{1}{9}$$\n\n5.  **交互作用平方和 ($SS_{GE}$):** 这通过减法得到。小计的平方和（单元格间变异）是 $SS_{Subtotals} = \\sum_{i,j} (T_{ij.}^2/r) - CT = 2588 - 22898/9 = (23292 - 22898)/9 = 394/9$。\n    $$SS_{GE} = SS_{Subtotals} - SS_{G} - SS_{E} = \\frac{394}{9} - \\frac{163}{9} - \\frac{1}{9} = \\frac{394 - 163 - 1}{9} = \\frac{230}{9}$$\n\n接下来，我们确定相关项的自由度 ($df$)：\n\\begin{itemize}\n    \\item $df_{GE} = (I-1)(J-1) = (3-1)(3-1) = 2 \\times 2 = 4$\n    \\item $df_{Error} = IJ(r-1) = 3 \\times 3 \\times (2-1) = 9 \\times 1 = 9$\n\\end{itemize}\n\n现在我们通过将平方和除以它们各自的自由度来计算均方 ($MS$)：\n\\begin{itemize}\n    \\item 交互作用均方: $MS_{GE} = \\frac{SS_{GE}}{df_{GE}} = \\frac{230/9}{4} = \\frac{230}{36} = \\frac{115}{18}$\n    \\item 误差均方 (适当的均方误差): $MS_{Error} = \\frac{SS_{Error}}{df_{Error}} = \\frac{4}{9}$\n\\end{itemize}\n\n最后，交互作用的 $F$ 统计量是交互作用均方与误差均方的比值。这用于检验原假设 $H_0: (GE)_{ij} = 0$ 对所有 $i,j$ 成立。\n$$F_{GE} = \\frac{MS_{GE}}{MS_{Error}} = \\frac{115/18}{4/9} = \\frac{115}{18} \\times \\frac{9}{4} = \\frac{115}{2 \\times 4} = \\frac{115}{8} = 14.375$$\n\n题目要求答案四舍五入到 $4$ 位有效数字。\n$$F_{GE} \\approx 14.38$$", "answer": "$$\\boxed{14.38}$$", "id": "2807674"}, {"introduction": "虽然方差分析（ANOVA）在处理分类环境因素时非常有效，但现实世界中的环境梯度（如温度、海拔）通常是连续的。为了描述单个基因型在连续环境梯度下的表型变化，我们引入了“反应规范”（reaction norm）的概念。本练习 [@problem_id:2807675] 将挑战你构建一个能够体现当代定量遗传学研究精髓的线性混合模型（LMM），该模型不仅能通过随机斜率捕捉基因型特异的反应规范，还能同时处理由极端环境引起的系统性偏差和方差变化。", "problem": "一位实验者在 $J$ 个室外田间试验点，对一个包含 $I$ 个近交基因型的组进行一项数量性状的测量。这些试验点的连续环境指数 $E_j$（例如，发育期间的日平均温度）各不相同，且每个基因型与环境的组合中有 $K$ 个重复个体。其中一部分试验点超过了一个热阈值，已知这会诱导一种与基因型无关、模拟功能缺失突变体的表型（一种典型的表型模写）。对于这些试验点，定义一个指示变量 $H_j \\in \\{0,1\\}$，其中 $H_j=1$ 表示热激条件。目标是使用线性混合模型 (LMM) 对基因型特异性的环境响应（反应规范）进行建模，该模型使用 $E_j$ 的随机斜率，同时也要考虑到在热应激下由表型模写引起的系统性偏移和增加的残差变异性。通过对 $E_j$ 进行中心化，应使截距在平均环境下具有可解释性。\n\n以下哪个模型设定正确地满足了这些要求？请选择唯一最佳选项。\n\nA. $y_{ijk} = \\beta_0 + \\beta_H H_j + \\beta_E E_{cj} + b_{0i} + b_{1i} E_{cj} + \\varepsilon_{ijk}$，其中 $E_{cj} = E_j - \\bar{E}$，$\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0} & \\sigma_{b0b1} \\\\ \\sigma_{b0b1} & \\sigma^2_{b1} \\end{pmatrix} \\right)$，且 $\\varepsilon_{ijk} \\sim \\mathcal{N}\\!\\left(0, \\sigma^2_{H(j)}\\right)$，$\\sigma^2_{H(j)} = \\sigma^2_{\\mathrm{hot}}$（若 $H_j=1$）而 $\\sigma^2_{H(j)} = \\sigma^2_{\\mathrm{cool}}$（若 $H_j=0$）。\n\nB. $y_{ijk} = \\beta_0 + \\beta_H H_j + b_{0i} + b_{1i} H_j + \\varepsilon_{ijk}$，其中 $\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0} & 0 \\\\ 0 & \\sigma^2_{b1} \\end{pmatrix} \\right)$ 且 $\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma^2)$ 是同方差的。\n\nC. $y_{ijk} = \\beta_0 + \\beta_E E_j + \\sum_{i'=1}^{I} \\gamma_{i'} \\mathbf{1}\\{i=i'\\} + \\sum_{i'=1}^{I} \\delta_{i'} \\mathbf{1}\\{i=i'\\} E_j + \\varepsilon_{ijk}$，其中 $\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma^2)$。\n\nD. $y_{ijk} = \\beta_0 + \\beta_E E_{cj} + b_{0i} + \\varepsilon_{ijk}$，其中 $b_{0i} \\sim \\mathcal{N}(0,\\sigma^2_{b0})$ 且 $\\varepsilon_{ijk} \\sim \\mathcal{N}\\!\\left(0,\\sigma^2_{H(j)}\\right)$ 如选项 A 所述。\n\nE. $y_{ijk} = \\beta_0 + \\beta_H H_j + \\beta_E E_{cj} + b_{0i} + b_{1i} E_{cj} + \\varepsilon_{ijk}$，其中 $\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0} & 0 \\\\ 0 & \\sigma^2_{b1} \\end{pmatrix} \\right)$ 且 $\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma^2)$。\n\n假设：所有不同基因型 $i$ 的随机效应项和残差项之间相互独立，环境指数 $E_j$ 的观测没有误差，并且试验设计包括至少 $J \\ge 3$ 个不同的 $E_j$ 值，同时涵盖 $H_j=0$ 和 $H_j=1$ 的试验点。", "solution": "问题陈述要求构建一个线性混合模型 (LMM) 来分析在 $J$ 个田间试验点上对 $I$ 个近交基因型测量的数量性状 $y_{ijk}$，其中每个组合有 $K$ 个重复。该模型必须满足几个特定标准。在评估所提供的选项之前，我将首先验证问题陈述，然后基于这些标准推导出正确的模型结构。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- 响应变量：数量性状，表示为 $y_{ijk}$，代表在试验点 $j$ 的基因型 $i$ 的第 $k$ 个个体。\n- 因子和协变量：\n    - $I$ 个近交基因型，以 $i$ 为索引。\n    - $J$ 个室外田间试验点，以 $j$ 为索引。\n    - 每个基因型-环境组合有 $K$ 个重复个体。\n    - 一个连续的环境指数 $E_j$。\n    - 一个二元热激指示变量 $H_j \\in \\{0,1\\}$，其中对于超过热阈值的试验点，$H_j=1$。\n- 建模要求：\n    1.  使用线性混合模型 (LMM)。\n    2.  使用 $E_j$ 的随机斜率对基因型特异性的环境响应（反应规范）进行建模。\n    3.  考虑到热应激（$H_j=1$）下由表型模写引起的表型系统性偏移。\n    4.  考虑到热应激下增加的残差变异性。\n    5.  通过对 $E_j$ 进行中心化，使模型截距在平均环境下具有可解释性。\n- 假设：\n    - 所有不同基因型 $i$ 的随机效应项和残差项之间相互独立。\n    - $E_j$ 的观测没有误差。\n    - 试验设计包括至少 $J \\ge 3$ 个不同的 $E_j$ 值，并涵盖 $H_j=0$ 和 $H_j=1$ 两种情况。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**：该问题在数量遗传学和统计建模方面有充分的科学基础。使用带有随机斜率的LMM来模拟基因型与环境的相互作用是一种标准且科学上稳健的方法。表型模写、反应规范和异方差性等概念是现代遗传学的核心。\n- **良定性**：目标定义清晰：确定一个能包含一系列特定生物学和统计学特征的模型的正确数学表达式。该问题的结构使得在给定选项中存在唯一的正确答案。\n- **客观性**：语言技术性强、精确且不含主观性。诸如“近交基因型”、“连续环境指数”和“随机斜率”等术语在该领域内有明确的定义。\n\n**第3步：结论与行动**\n问题陈述在科学上是合理的、良定的且客观的。它不包含任何会使其无效的逻辑矛盾、信息缺失或其他缺陷。我将继续推导解决方案。\n\n### 正确模型的推导\n\n表型 $y_{ijk}$ 的模型必须通过将每个要求转换为一个数学项来构建。\n\n1.  **平均环境下的截距和群体平均环境响应**：要求 $5$ 指出，截距应在平均环境下具有可解释性。这通过对连续环境变量 $E_j$ 进行中心化来实现。设 $\\bar{E} = \\frac{1}{J}\\sum_{j=1}^{J} E_j$。中心化后的协变量为 $E_{cj} = E_j - \\bar{E}$。描述群体平均反应规范的模型的固定效应部分则为 $\\beta_0 + \\beta_E E_{cj}$，其中 $\\beta_0$ 是在平均环境（$E_{cj} = 0$）下的总平均表型，而 $\\beta_E$ 是所有基因型反应规范的平均斜率。\n\n2.  **由表型模写引起的系统性偏移**：要求 $3$ 指出，模型必须能容纳由热应激（由 $H_j=1$ 指示）引起的系统性偏移。这是一个适用于所有基因型的固定效应。通过添加项 $\\beta_H H_j$ 可以正确地对其建模，其中 $\\beta_H$ 代表在控制了 $E_{cj}$ 的效应后，热激条件下的平均表型变化。\n\n3.  **基因型特异性反应规范（随机斜率）**：要求 $2$ 要求使用随机斜率对基因型特异性反应规范进行建模。这意味着每个基因型 $i$ 都有其自己的截距和斜率。在线性混合模型中，这些被建模为与群体平均值的随机偏差。\n    - 基因型 $i$ 的截距是 $\\beta_0 + b_{0i}$，其中 $b_{0i}$ 是基因型 $i$ 的随机截距偏差。\n    - 基因型 $i$ 的斜率是 $\\beta_E + b_{1i}$，其中 $b_{1i}$ 是基因型 $i$ 的随机斜率偏差。\n    因此，特定基因型反应规范的组合项为 $(\\beta_0 + b_{0i}) + (\\beta_E + b_{1i}) E_{cj}$。分离出随机部分，得到 $b_{0i} + b_{1i} E_{cj}$ 项。随机效应 $(b_{0i}, b_{1i})$ 被假定从一个总体分布中抽取，通常是多元正态分布。最一般的形式允许截距和斜率之间存在协方差：\n    $$ \\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0} & \\sigma_{b0b1} \\\\ \\sigma_{b0b1} & \\sigma^2_{b1} \\end{pmatrix} \\right) $$\n    协方差项 $\\sigma_{b0b1}$ 至关重要，因为它模拟了基础性状值与环境敏感性之间的遗传相关性。\n\n4.  **增加的残差变异性**：要求 $4$ 指出，在热应激下残差变异性增加。残差项 $\\varepsilon_{ijk}$ 解释了同一基因型-环境组合内重复间的变异。需要对不同条件下的不同方差进行建模（异方差性）。$\\varepsilon_{ijk}$ 的方差必须依赖于热激指示变量 $H_j$。这可以指定为 $\\varepsilon_{ijk} \\sim \\mathcal{N}(0, \\sigma^2_{H(j)})$，其中方差 $\\sigma^2_{H(j)}$ 取两个不同的值：一个用于 $H_j=0$（例如 $\\sigma^2_{\\mathrm{cool}}$），另一个用于 $H_j=1$（例如 $\\sigma^2_{\\mathrm{hot}}$）。\n\n**完整模型设定**：\n结合所有组成部分，完整的模型方程为：\n$$ y_{ijk} = \\beta_0 + \\beta_H H_j + \\beta_E E_{cj} + b_{0i} + b_{1i} E_{cj} + \\varepsilon_{ijk} $$\n并附带以下分布假设：\n$$ E_{cj} = E_j - \\bar{E} $$\n$$ \\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0} & \\sigma_{b0b1} \\\\ \\sigma_{b0b1} & \\sigma^2_{b1} \\end{pmatrix} \\right) $$\n$$ \\varepsilon_{ijk} \\sim \\mathcal{N}\\!\\left(0, \\sigma^2_{H(j)}\\right) $$\n\n### 选项评估\n\n**A. $y_{ijk} = \\beta_0 + \\beta_H H_j + \\beta_E E_{cj} + b_{0i} + b_{1i} E_{cj} + \\varepsilon_{ijk}$，其中 $E_{cj} = E_j - \\bar{E}$，$\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0} & \\sigma_{b0b1} \\\\ \\sigma_{b0b1} & \\sigma^2_{b1} \\end{pmatrix} \\right)$，且 $\\varepsilon_{ijk} \\sim \\mathcal{N}\\!\\left(0, \\sigma^2_{H(j)}\\right)$，$\\sigma^2_{H(j)} = \\sigma^2_{\\mathrm{hot}}$（若 $H_j=1$）而 $\\sigma^2_{H(j)} = \\sigma^2_{\\mathrm{cool}}$（若 $H_j=0$）。**\n该设定与推导出的模型完全匹配。它正确地包含了：\n-   中心化的环境协变量（$E_{cj}$）。\n-   用于系统性热激偏移的固定效应（$\\beta_H H_j$）。\n-   一个完整的随机截距和随机斜率模型（$b_{0i} + b_{1i} E_{cj}$），并带有协方差项（$\\sigma_{b0b1}$）。\n-   依赖于热激状态的异方差残差（$\\sigma^2_{H(j)}$）。\n**结论：正确**\n\n**B. $y_{ijk} = \\beta_0 + \\beta_H H_j + b_{0i} + b_{1i} H_j + \\varepsilon_{ijk}$，其中 $\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0} & 0 \\\\ 0 & \\sigma^2_{b1} \\end{pmatrix} \\right)$ 且 $\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma^2)$ 是同方差的。**\n这个模型存在根本性缺陷。它完全忽略了连续环境变量 $E_j$，而这对于建模反应规范至关重要。它还错误地假设了同方差残差，违反了要求 $4$。它完全没有对连续环境响应进行建模。\n**结论：错误**\n\n**C. $y_{ijk} = \\beta_0 + \\beta_E E_j + \\sum_{i'=1}^{I} \\gamma_{i'} \\mathbf{1}\\{i=i'\\} + \\sum_{i'=1}^{I} \\delta_{i'} \\mathbf{1}\\{i=i'\\} E_j + \\varepsilon_{ijk}$，其中 $\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma^2)$。**\n这是一个固定效应模型，而非线性混合模型。它将基因型视为固定因子，这与要求 $1$ 相悖。此外，它未能包含热激固定效应（$\\beta_H H_j$），没有模拟异方差性，并使用了未中心化的协变量 $E_j$。\n**结论：错误**\n\n**D. $y_{ijk} = \\beta_0 + \\beta_E E_{cj} + b_{0i} + \\varepsilon_{ijk}$，其中 $b_{0i} \\sim \\mathcal{N}(0,\\sigma^2_{b0})$ 且 $\\varepsilon_{ijk} \\sim \\mathcal{N}\\!\\left(0,\\sigma^2_{H(j)}\\right)$ 如选项 A 所述。**\n这是一个仅包含随机截距的模型。它缺少随机斜率项（$b_{1i} E_{cj}$），这是一个关键性失误，因为要求 $2$ 明确要求用随机斜率来模拟基因型特异性的环境响应。它也忽略了表型模写偏移的固定效应（$\\beta_H H_j$）。\n**结论：错误**\n\n**E. $y_{ijk} = \\beta_0 + \\beta_H H_j + \\beta_E E_{cj} + b_{0i} + b_{1i} E_{cj} + \\varepsilon_{ijk}$，其中 $\\begin{pmatrix} b_{0i} \\\\ b_{1i} \\end{pmatrix} \\sim \\mathcal{N}\\!\\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} \\sigma^2_{b0} & 0 \\\\ 0 & \\sigma^2_{b1} \\end{pmatrix} \\right)$ 且 $\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma^2)$。**\n这个模型比较接近但仍然是错误的。其主要缺陷是同方差残差的假设（$\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma^2)$），这与模拟热应激下增加的残差变异性的要求相悖。一个次要、不那么关键的缺陷是假设随机截距和随机斜率之间协方差为零，这是一种简化，问题陈述中并没有为此提供理由。\n**结论：错误**", "answer": "$$\\boxed{A}$$", "id": "2807675"}]}