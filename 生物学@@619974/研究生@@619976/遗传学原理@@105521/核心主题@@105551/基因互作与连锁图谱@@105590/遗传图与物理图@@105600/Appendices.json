{"hands_on_practices": [{"introduction": "物理图谱（以碱基对为单位）与遗传图谱（以厘摩为单位）之间的关系并非简单的线性对应。该关系由局部重组率 $r(x)$ 决定，总遗传距离是通过对物理长度上的 $r(x)$ 进行积分得到的。这个练习将这一核心原则付诸实践，将抽象概念转化为具体的计算，从而巩固您对重组热点和冷点如何导致两种图谱差异的理解。[@problem_id:2817629]", "problem": "一个从物理坐标 $x=0$ 到 $x=30$ 兆碱基（megabase, $\\mathrm{Mb}$）的线性染色体片段，其局部重组率密度是分段常数，单位是厘摩每兆碱基（centiMorgan, $\\mathrm{cM}$ per $\\mathrm{Mb}$）。具体来说，对于 $0 \\le x < 20$ $\\mathrm{Mb}$，重组率密度为 $0.5$ $\\mathrm{cM}/\\mathrm{Mb}$；对于 $20 \\le x \\le 30$ $\\mathrm{Mb}$，重组率密度为 $3$ $\\mathrm{cM}/\\mathrm{Mb}$。请仅使用通过局部重组率密度将遗传图谱与物理图谱联系起来的基本定义，计算整个 $30$ $\\mathrm{Mb}$ 区域的总遗传距离。以厘摩（$\\mathrm{cM}$）为单位，用一个数字表示你的最终答案。不需要四舍五入。", "solution": "所提出的问题是遗传学中关联物理图谱和遗传图谱基本原理的一个直接应用。该问题具有科学依据、提法明确且信息完整。我们将开始解答。\n\n物理图谱（以兆碱基（$\\mathrm{Mb}$）等长度单位度量）和遗传图谱（以厘摩（$\\mathrm{cM}$）度量）之间的核心关系由局部重组率密度定义，我们将其表示为 $r(x)$。这个函数 $r(x)$ 量化了染色体上特定物理位置 $x$ 处每单位物理距离的遗传距离。其单位通常是厘摩每兆碱基（$\\mathrm{cM}/\\mathrm{Mb}$）。\n\n一个染色体连续片段上，从物理起始坐标 $x_a$ 到结束坐标 $x_b$ 的总遗传距离 $\\Delta G$，可以通过对物理区间 $[x_a, x_b]$ 上的局部重组率密度 $r(x)$ 进行积分来获得。在数学上，这表示为：\n$$ \\Delta G = \\int_{x_a}^{x_b} r(x) \\, dx $$\n这个积分代表了在整个染色体片段的物理长度上遗传距离的累积。\n\n在所给问题中，我们有一个从物理坐标 $x_1 = 0$ $\\mathrm{Mb}$ 延伸到 $x_3 = 30$ $\\mathrm{Mb}$ 的线性染色体片段。局部重组率密度 $r(x)$ 在整个区域内并非均匀，而是以分段常数函数的形式给出。该函数定义如下：\n$$\nr(x) =\n\\begin{cases}\nr_1 = 0.5 \\, \\text{cM/Mb} & \\text{for } 0 \\le x < 20 \\, \\text{Mb} \\\\\nr_2 = 3 \\, \\text{cM/Mb} & \\text{for } 20 \\le x \\le 30 \\, \\text{Mb}\n\\end{cases}\n$$\n为了计算整个 $30$ $\\mathrm{Mb}$ 区域的总遗传距离 $\\Delta G_{total}$，我们必须计算 $r(x)$ 从 $x = 0$ 到 $x = 30$ 的积分。\n$$ \\Delta G_{total} = \\int_{0}^{30} r(x) \\, dx $$\n由于函数 $r(x)$ 的分段性质，我们必须将积分划分为多个片段，对应于重组率为常数的各个区间。不连续点在 $x_2 = 20$ $\\mathrm{Mb}$。因此，我们在此点将积分分开：\n$$ \\Delta G_{total} = \\int_{0}^{20} r(x) \\, dx + \\int_{20}^{30} r(x) \\, dx $$\n现在，我们将各区间对应的重组率密度常数值代入积分中：\n$$ \\Delta G_{total} = \\int_{0}^{20} 0.5 \\, dx + \\int_{20}^{30} 3 \\, dx $$\n对常数进行积分很简单。对于第一个区间，从 $x=0$ 到 $x=20$ $\\mathrm{Mb}$，遗传距离 $\\Delta G_1$ 是：\n$$ \\Delta G_1 = 0.5 \\times (20 - 0) = 0.5 \\times 20 = 10 \\, \\text{cM} $$\n对于第二个区间，从 $x=20$ 到 $x=30$ $\\mathrm{Mb}$，遗传距离 $\\Delta G_2$ 是：\n$$ \\Delta G_2 = 3 \\times (30 - 20) = 3 \\times 10 = 30 \\, \\text{cM} $$\n整个 $30$ $\\mathrm{Mb}$ 区域的总遗传距离是两个子区域遗传距离之和：\n$$ \\Delta G_{total} = \\Delta G_1 + \\Delta G_2 = 10 + 30 $$\n$$ \\Delta G_{total} = 40 \\, \\text{cM} $$\n计算完成。总遗传距离为 $40$ 厘摩。", "answer": "$$ \\boxed{40} $$", "id": "2817629"}, {"introduction": "理解了理论联系之后，我们如何利用实验数据构建遗传图谱呢？三点测交实验使我们能够通过观察重组频率来确定基因的顺序和它们之间的距离。这个经典的练习连接了理论与实践，演示了如何从原始后代计数中推断基因顺序、计算图谱距离和干扰，这是理解连锁分析的一项基本技能。[@problem_id:2817779]", "problem": "在一个模式生物中，为绘制位于同一条染色体上的三个基因座（标记为 $A$、$B$ 和 $C$）的图谱，进行了一次三点测交。子代被分为四个交换类别：非交换型 (NCO)、在区间 $A$–$B$ 内的单交换型 (SCO)、在区间 $B$–$C$ 内的单交换型 (SCO) 以及双交换型 (DCO)。观测到的计数为：$800$ 个 NCO，$180$ 个 $A$–$B$ 区间的 SCO，$180$ 个 $B$–$C$ 区间的 SCO，以及 $20$ 个 DCO。假设没有染色单体干涉，并且每个交换类别都已被正确识别。\n\n仅使用那些将遗传图距与小遗传距离的重组频率相关联，以及根据观测双交换与乘积法则期望值的偏差来定义干涉的核心定义，计算：\n- $A$–$B$ 和 $B$–$C$ 之间的遗传图距，以厘摩 (cM) 为单位表示，以及\n- 由 $A$、$B$ 和 $C$ 所跨越区域的干涉，以无单位小数表示。\n\n将每个遗传图距（以厘摩 cM 为单位）四舍五入至四位有效数字，并将干涉（作为无单位小数）四舍五入至四位有效数字。将你的最终答案以行向量 $\\big[d_{AB},\\ d_{BC},\\ I\\big]$ 的形式报告，其中 $d_{AB}$ 和 $d_{BC}$ 是以 cM 为单位的图距，$I$ 是干涉（无单位）。", "solution": "问题陈述已经过验证，可用于分析。其科学基础为经典遗传学原理，问题阐述清晰且客观。所有必要数据均已提供，且内部一致。\n\n分析首先计算实验的子代总数。设 $N_{NCO}$ 为非交换型子代的数量，$N_{SCO, AB}$ 为基因座 $A$ 和 $B$ 之间区间的单交换型子代数量，$N_{SCO, BC}$ 为基因座 $B$ 和 $C$ 之间区间的单交换型子代数量，$N_{DCO}$ 为双交换型子代的数量。子代总数 $N$ 是这些数量的总和：\n$$N = N_{NCO} + N_{SCO, AB} + N_{SCO, BC} + N_{DCO}$$\n代入给定值：\n$$N = 800 + 180 + 180 + 20 = 1180$$\n\n两个基因座之间的遗传图距 $d$ 定义为它们之间的重组频率，以厘摩 (cM) 为单位表示，其中 $1 \\text{ cM}$ 对应于 $1\\%$ 的重组频率。\n\n为计算基因座 $A$ 和 $B$ 之间的图距 $d_{AB}$，我们必须识别出所有由该区间内发生交换事件而产生的子代。这些子代包括 $A$–$B$ 区域的单交换型和双交换型，因为一次双交换 (DCO) 事件涉及一次在 $A$–$B$ 区域的交换和第二次在 $B$–$C$ 区域的交换。区间 $A$–$B$ 的重组频率，记为 $R.F._{AB}$，为：\n$$R.F._{AB} = \\frac{N_{SCO, AB} + N_{DCO}}{N} = \\frac{180 + 20}{1180} = \\frac{200}{1180}$$\n因此，图距为：\n$$d_{AB} = R.F._{AB} \\times 100 = \\frac{200}{1180} \\times 100 \\approx 16.94915 \\text{ cM}$$\n按要求四舍五入到四位有效数字，得到 $d_{AB} = 16.95 \\text{ cM}$。\n\n同样，基因座 $B$ 和 $C$ 之间的图距 $d_{BC}$ 是根据该区间的重组频率 $R.F._{BC}$ 计算的。该区间的重组子代为 $B$–$C$ 区域的单交换型和双交换型。\n$$R.F._{BC} = \\frac{N_{SCO, BC} + N_{DCO}}{N} = \\frac{180 + 20}{1180} = \\frac{200}{1180}$$\n图距 $d_{BC}$ 为：\n$$d_{BC} = R.F._{BC} \\times 100 = \\frac{200}{1180} \\times 100 \\approx 16.94915 \\text{ cM}$$\n四舍五入到四位有效数字，得到 $d_{BC} = 16.95 \\text{ cM}$。\n\n接下来，我们计算干涉 $I$。干涉量化了一个区域的交换对相邻区域发生交换概率的影响程度。它是根据并发系数 $C$ 计算的。并发系数是观测双交换频率 ($DCO_{obs}$) 与预期双交换频率 ($DCO_{exp}$) 的比值。\n观测 DCO 频率为：\n$$DCO_{obs} = \\frac{N_{DCO}}{N} = \\frac{20}{1180}$$\n预期的 DCO 频率，在假设两个区间的交换事件是独立的前提下，是它们各自重组频率的乘积：\n$$DCO_{exp} = R.F._{AB} \\times R.F._{BC} = \\left(\\frac{200}{1180}\\right) \\times \\left(\\frac{200}{1180}\\right) = \\frac{40000}{1392400}$$\n因此，并发系数 $C$ 为：\n$$C = \\frac{DCO_{obs}}{DCO_{exp}} = \\frac{20/1180}{(200/1180) \\times (200/1180)} = \\frac{20 \\times 1180}{200 \\times 200} = \\frac{23600}{40000} = 0.59$$\n干涉 $I$ 定义为：\n$$I = 1 - C$$\n$$I = 1 - 0.59 = 0.41$$\n按要求四舍五入至四位有效数字，得到 $I = 0.4100$。\n\n最终结果为图距 $d_{AB} = 16.95 \\text{ cM}$、$d_{BC} = 16.95 \\text{ cM}$ 和干涉 $I = 0.4100$。", "answer": "$$\\boxed{\\begin{pmatrix} 16.95 & 16.95 & 0.4100 \\end{pmatrix}}$$", "id": "2817779"}, {"introduction": "构建一个包含三个标记的图谱是可行的，但现代基因组学常常要处理包含成千上万个标记的高密度图谱，这带来了巨大的计算挑战。将大量标记排序以找到最可能的排列顺序，在计算上等同于“旅行商问题”（TSP），这是一个已知的 NP-难问题。理解 TSP 类比，阐明了为何启发式算法对于构建密集的遗传图谱至关重要，并为理解其中涉及的算法挑战提供了一个强大的概念框架。[@problem_id:2817672]", "problem": "您正在为一个分离群体中的 $n$ 个多态性标记构建单条染色体的遗传图谱。设 $r_{ij}$ 表示标记 $i$ 和 $j$ 之间的重组率，设 $d_{ij}$ 表示通过单调作图函数 $d_{ij} = f(r_{ij})$ 获得的相应遗传距离（例如，Haldane 或 Kosambi 型作图函数，此处不假设具体公式）。遗传图谱顺序是 $n$ 个标记在线上的一个排列，最佳顺序是在标准交换模型下，使观测到的基因型的多点似然最大化的那个排列。请您评估标记排序与旅行商问题 (TSP) 之间常见的类比，并从第一性原理出发，解释为何高密度遗传图谱的构建要使用启发式算法。\n\n下列哪个陈述最能概括标记排序的旅行商问题 (TSP) 类比以及在高密度图谱中使用启发式算法的理由？请选择所有适用项。\n\nA. 在单个连锁群上的标记排序问题中，我们寻求一个能使多点似然最大化的标记排列；这可以被看作是一个完全图上的最短哈密顿路径问题，其边权重是基于重组的不相似性（例如，$w_{ij}$ 随 $d_{ij}$ 增加）的函数。由于排列的数量随标记数量呈阶乘增长，当 $n$ 增加时，精确的全局搜索在计算上变得不可行，这促使我们采用能够近似优化顺序的启发式方法。\n\nB. 因为在任何作图函数 $f(\\cdot)$ 下，相邻区间的重组计数在整个染色体上都是独立的且严格可加的，所以动态规划算法可以在 $n$ 的多项式时间内得出精确解；因此，使用启发式算法主要是为了方便，而非必要。\n\nC. 与 TSP 的类比在原则上是不成立的，因为遗传距离 $d_{ij}$ 可能违反三角不等式，所以为 TSP 结构设计的图搜索启发式算法无法使用；因此，当样本量很大时，只有穷举法才能产生正确的顺序。\n\nD. 在高密度图谱中，基因分型错误和缺失数据会引入虚假的较小成对距离（例如，由错误引起的表观双交换），这在目标函数景观中产生了许多局部最优解。受 TSP 启发的启发式算法，如最近邻构建、2-opt 或 Lin–Kernighan 交换以及模拟退火，可以有效地遍历搜索空间，以在不进行完全穷举的情况下找到接近最优的顺序。\n\nE. 将重叠群（contigs）组装成支架（scaffolds）的物理图谱构建与遗传图谱排序是相同的，因为两者都是为了最小化碱基对距离的总和；因此，只有在没有参考基因组的情况下，遗传图谱构建才需要启发式算法。\n\nF. 实践中采用的一种标准规约方法是通过添加一个与所有标记以固定权重（例如，0 或一个常数）相连的人工锚定节点，将线性排序问题转化为一个环路问题，这样，在增广图上的最优 TSP 回路在移除锚点后，就能导出一个合理的标记顺序；这为遗传图谱构建重用 TSP 求解器和启发式算法提供了理由，即使染色体是线性的。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知信息**\n-   问题背景：为单条染色体构建遗传图谱。\n-   数据来源：一个拥有 $n$ 个多态性标记的分离群体。\n-   变量 $r_{ij}$：标记 $i$ 和 $j$ 之间的重组率。\n-   变量 $d_{ij}$：标记 $i$ 和 $j$ 之间的遗传距离，由单调作图函数 $d_{ij} = f(r_{ij})$ 定义。\n-   图谱顺序的定义：$n$ 个标记在线上的一个排列。\n-   优化标准：最佳顺序是使观测基因型在标准交换模型下的多点似然最大化的排列。\n-   任务：评估标记排序与旅行商问题 (TSP) 之间的类比，并解释为何高密度遗传图谱要使用启发式算法。\n\n**步骤 2：使用提取的已知信息进行验证**\n-   **科学依据**：该问题完美地根植于统计遗传学和计算生物学的原理。连锁分析、重组率 ($r_{ij}$)、遗传距离 ($d_{ij}$)、作图函数 (Haldane, Kosambi)、多点似然和标记排序等概念都是标准且成熟的。其与旅行商问题的联系是遗传图谱构建领域的经典议题。\n-   **良构性**：该问题是良构的。它要求基于所提供的标准科学背景评估几个陈述。目标清晰且可实现。\n-   **客观性**：问题陈述使用精确、客观和技术性的语言表达，没有歧义或主观内容。\n\n**步骤 3：结论与行动**\n问题陈述在科学上是合理的、良构的且客观的。它不包含任何可辨别的缺陷。因此，判定为**有效**。我将进行完整的推导和分析。\n\n构建遗传图谱的基本任务是确定 $n$ 个遗传标记沿染色体的线性顺序。最优顺序是能够最好地解释群体中观测到的遗传模式的顺序，这在形式上是使基因型数据的多点似然最大化的标记排列。对于给定的标记顺序 $(m_1, m_2, \\dots, m_n)$，似然是相邻标记间重组率的函数：$L(\\text{order} | \\text{data}) = g(r_{m_1m_2}, r_{m_2m_3}, \\dots, r_{m_{n-1}m_n})$。\n\n最大化这个似然是一个计算上极其艰巨的优化问题。所有可能顺序的集合是 $n$ 个标记的所有排列的集合。总共有 $n!$ 个这样的排列，或者说 $n!/2$ 个独特的线性顺序（因为反向顺序是等价的）。这个数字呈阶乘增长，其增长速度远超任何 $n$ 的多项式函数。例如，对于 $n=15$ 个标记，需要检查的顺序有 $15!/2 \\approx 6.5 \\times 10^{11}$ 个。对于拥有成百上千个标记的高密度图谱，穷举法在计算上是不可能的。\n\n这种问题结构类似于旅行商问题 (TSP)。在 TSP 中，人们寻求一条访问一系列城市中的每一个城市一次并返回起点的最短路径。我们可以将标记建模为“城市”，并定义任意两个标记 $i$ 和 $j$ 之间的“距离”或“成本” $w_{ij}$。这个成本是它们估计的重组率 $r_{ij}$ 或相应遗传距离 $d_{ij}$ 的增函数。高重组率意味着标记相距很远，因此成本很高。标记排序问题于是就变成了寻找一个标记排列，以最小化序列中相邻标记间的成本总和。这就是最短哈密顿路径问题，它被认为是 NP-难的，并且在计算上等同于 TSP。\n\n由于这种 NP-难度，为大的 $n$ 找到精确的、全局最优的解是不可行的。因此，遗传学家必须依赖启发式算法——即那些能在可行的时间内找到近似（接近最优）解的计算策略。\n\n我们现在来评估每个陈述。\n\n**A. 在单个连锁群上的标记排序问题中，我们寻求一个能使多点似然最大化的标记排列；这可以被看作是一个完全图上的最短哈密顿路径问题，其边权重是基于重组的不相似性（例如，$w_{ij}$ 随 $d_{ij}$ 增加）的函数。由于排列的数量随标记数量呈阶乘增长，当 $n$ 增加时，精确的全局搜索在计算上变得不可行，这促使我们采用能够近似优化顺序的启发式方法。**\n\n该陈述是对问题的精确和正确的总结。它正确地将目标确定为最大化似然，正确地将问题形式化为最短哈密顿路径问题（TSP 的一个变体），正确地将边权重定义为基于重组的不相似性度量，并正确地指出搜索空间的阶乘增长是导致精确方法计算上不可行的根本原因，因此需要启发式方法。\n结论：**正确**。\n\n**B. 因为在任何作图函数 $f(\\cdot)$ 下，相邻区间的重组计数在整个染色体上都是独立的且严格可加的，所以动态规划算法可以在 $n$ 的多项式时间内得出精确解；因此，使用启发式算法主要是为了方便，而非必要。**\n\n该陈述在多个方面都与事实不符。首先，由于交换干涉的存在，相邻区间内的重组事件通常不是独立的；因此，它们的计数也不是独立的。其次，重组率（$r_{ij}$）不具有可加性。即使在没有干涉的理想化模型（Haldane 函数）下，共线标记的遗传距离（$d_{ij}$）是可加的，但重组率不是：对于三个有序标记 $i, j, k$，有 $r_{ik} = r_{ij} + r_{jk} - 2r_{ij}r_{jk}$。陈述中的`在任何作图函数下`是错误的。第三，也是最关键的一点，标记排序问题是 NP-难的。目前尚不存在任何能对其进行精确求解的多项式时间算法，无论是基于动态规划还是其他方法。启发式算法是计算上的必需，而不仅仅是为了方便。\n结论：**不正确**。\n\n**C. 与 TSP 的类比在原则上是不成立的，因为遗传距离 $d_{ij}$ 可能违反三角不等式，所以为 TSP 结构设计的图搜索启发式算法无法使用；因此，当样本量很大时，只有穷举法才能产生正确的顺序。**\n\n该陈述存在缺陷。虽然由于统计抽样误差或基因分型错误，*估计的*遗传距离确实可能违反三角不等式（$d_{ik} > d_{ij} + d_{jk}$），但这是一个数据质量问题，而不是类比在原则上的失败。一条线上的潜在真实距离必须满足三角不等式（对于有序标记，其形式为可加性 $d_{ik} = d_{ij} + d_{jk}$）。此外，声称启发式算法`无法使用`是错误的。许多强大的 TSP 启发式算法，如模拟退火、遗传算法和 Lin-Kernighan 启发式算法，并不严格要求三角不等式才能运行，尽管它们的性能保证可能会改变。最后，`只有穷举法才能产生正确的顺序`的结论是荒谬的；即使对于中等大小的 $n$，穷举法也是不可能的。\n结论：**不正确**。\n\n**D. 在高密度图谱中，基因分型错误和缺失数据会引入虚假的较小成对距离（例如，由错误引起的表观双交换），这在目标函数景观中产生了许多局部最优解。受 TSP 启发的启发式算法，如最近邻构建、2-opt 或 Lin–Kernighan 交换以及模拟退火，可以有效地遍历搜索空间，以在不进行完全穷举的情况下找到接近最优的顺序。**\n\n该陈述为使用高级启发式算法提供了一个正确且重要的实践理由。基因分型错误确实可以模拟双交换，而双交换在短距离内是生物学上罕见的。这会导致对实际上相距很远的标记间的重组率（以及距离）产生误导性的低估。这类伪迹会造成一个“崎岖”的优化景观，其中包含许多局部最优解，这些局部最优解会困住简单的贪心算法。该陈述正确地列举了一系列 TSP 启发式算法，从简单的（最近邻）到复杂的局部搜索（2-opt、Lin-Kernighan）和元启发式算法（模拟退火），这些算法旨在导航这类复杂的搜索空间并找到高质量、接近最优的解。这不仅解释了*为何*使用启发式算法，还解释了*为何*需要高级启发式算法来处理嘈杂生物数据的现实情况。\n结论：**正确**。\n\n**E. 将重叠群（contigs）组装成支架（scaffolds）的物理图谱构建与遗传图谱排序是相同的，因为两者都是为了最小化碱基对距离的总和；因此，只有在没有参考基因组的情况下，遗传图谱构建才需要启发式算法。**\n\n该陈述不正确。它混淆了两个截然不同的问题。遗传图谱构建是基于重组频率（一种遗传连锁的统计度量）来排列标记。物理图谱构建是基于物理证据（如序列重叠）来排列 DNA 片段（如重叠群）。它们的目标函数是不同的。`只有在没有参考基因组的情况下，遗传图谱构建才需要启发式算法`这一断言也是错误的。对启发式算法的需求源于排序问题本身的组合复杂性（$O(n!)$），这一事实与是否存在参考基因组无关。即使有参考基因组，人们也可能出于各种原因（例如，检测染色体重排）进行从头遗传图谱构建。\n结论：**不正确**。\n\n**F. 实践中采用的一种标准规约方法是通过添加一个与所有标记以固定权重（例如，0 或一个常数）相连的人工锚定节点，将线性排序问题转化为一个环路问题，这样，在增广图上的最优 TSP 回路在移除锚点后，就能导出一个合理的标记顺序；这为遗传图谱构建重用 TSP 求解器和启发式算法提供了理由，即使染色体是线性的。**\n\n该陈述准确地描述了一种计算机科学中用于通过环路问题求解器解决路径问题的标准且有效的技术。线性染色体上的标记排序问题是一个最短哈密顿路径问题。通过引入一个与所有真实标记具有零成本边的人工“仓库”节点，可以将该问题转化为寻找最短哈密顿环路（标准的 TSP）问题。最短环路将从仓库出发，遍历最优的标记路径，然后返回仓库。从所得环路中移除仓库即可恢复最优路径。这种形式化的规约为将为 TSP 开发的大量算法和软件直接应用于遗传图谱构建问题提供了严谨的理由。\n结论：**正确**。\n\n总而言之，陈述 A、D 和 F 正确地描述了 TSP 类比的基本方面以及在遗传图谱构建中使用启发式算法的理由。", "answer": "$$\\boxed{ADF}$$", "id": "2817672"}]}