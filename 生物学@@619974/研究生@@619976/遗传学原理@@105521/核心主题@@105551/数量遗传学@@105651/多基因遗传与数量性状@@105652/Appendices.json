{"hands_on_practices": [{"introduction": "要理解多基因性状，我们必须首先学习如何剖析其背后的遗传变异。这项实践将引导你学习数量遗传学中的一个基础方法：利用亲缘关系远近不同的个体间的相似度，将遗传方差分解为加性（$V_A$）和显性（$V_D$）两个部分。通过比较全同胞和半同胞，你将从第一性原理出发，推导出这些方差组分如何不同地贡献于它们的表型相关性，这是估算遗传力的关键洞见。[@problem_id:2838200]", "problem": "一个大的、随机交配的二倍体群体，在影响某个数量性状的许多非连锁、双等位基因座上处于 Hardy–Weinberg 平衡 (HWE) 和连锁平衡 (LE) 状态。不存在上位性、选择性交配和近亲繁殖。个体的性状表型可以写为 $P = A + D + E$，其中 $A$ 是加性遗传值（育种值），$D$ 是显性离差，$E$ 是环境离差，且 $E$ 在个体间独立，并且与基因型不相关。表型方差分解为 $V_{P} = V_{A} + V_{D} + V_{E}$，并且该性状已被标准化，使得 $V_{P} = 1$。\n\n仅使用随机交配条件下 Mendelian 分离定律和同源等同 (IBD) 推理的第一性原理，推导一对全同胞之间以及一对父系半同胞（共享一个父本但母本不相关）之间的表型预期相关性。将每个相关性仅用 $V_{A}$ 和 $V_{D}$ 表示。在这些假设下，清晰地展示显性如何导致全同胞相关性相对于半同胞相关性的增加。\n\n将您的最终结果以行矩阵 $\\begin{pmatrix} r_{\\mathrm{FS}} & r_{\\mathrm{HS}} \\end{pmatrix}$ 的形式报告，其中 $r_{\\mathrm{FS}}$ 是预期的全同胞相关性，$r_{\\mathrm{HS}}$ 是预期的半同胞相关性。无需数值取约，也无需单位，因为相关性根据其构造是无量纲的。", "solution": "该问题陈述经证实具有科学依据、问题明确且客观。它代表了基于既定原则的定量遗传学中的一个标准练习。我们将开始推导。\n\n两个个体（记为 $1$ 和 $2$）的表型之间的相关性定义为：\n$$\nr = \\text{Corr}(P_{1}, P_{2}) = \\frac{\\text{Cov}(P_{1}, P_{2})}{\\sqrt{V(P_{1})V(P_{2})}}\n$$\n问题指出群体处于平衡状态，因此所有个体都具有相同的表型方差 $V_{P}$。此外，该方差已被标准化为 $V_{P} = 1$。因此，相关性简化为协方差：\n$$\nr = \\text{Cov}(P_{1}, P_{2})\n$$\n表型 $P$ 由线性模型 $P = A + D + E$ 给出，其中 $A$ 是加性遗传值，$D$ 是显性离差，$E$ 是环境离差。两个亲属的表型之间的协方差是：\n$$\n\\text{Cov}(P_{1}, P_{2}) = \\text{Cov}(A_{1} + D_{1} + E_{1}, A_{2} + D_{2} + E_{2})\n$$\n使用协方差的性质展开此式可得：\n$$\n\\text{Cov}(P_{1}, P_{2}) = \\text{Cov}(A_{1}, A_{2}) + \\text{Cov}(D_{1}, D_{2}) + \\text{Cov}(E_{1}, E_{2}) + \\text{Cov}(A_{1}, D_{2}) + \\text{Cov}(A_{2}, D_{1}) + \\text{Cov}(A_{1}, E_{2}) + \\text{Cov}(A_{2}, E_{1}) + \\text{Cov}(D_{1}, E_{2}) + \\text{Cov}(D_{2}, E_{1})\n$$\n我们根据问题的假设来评估交叉项：\n1.  环境离差 $E$ 在个体间是独立的，所以 $\\text{Cov}(E_{1}, E_{2}) = 0$。\n2.  环境离差与基因型不相关，这意味着它们与基因型分量 $A$ 和 $D$ 不相关。因此，所有 $\\text{Cov}(A, E)$ 和 $\\text{Cov}(D, E)$ 项都为零。\n3.  在一个处于 Hardy-Weinberg 平衡和连锁平衡的随机交配群体中，加性遗传值和显性离差是不相关的。这在个体内部和个体之间都成立，因此 $\\text{Cov}(A_{1}, D_{2}) = 0$ 且 $\\text{Cov}(A_{2}, D_{1}) = 0$。\n\n因此，表型协方差简化为遗传协方差之和：\n$$\n\\text{Cov}(P_{1}, P_{2}) = \\text{Cov}(A_{1}, A_{2}) + \\text{Cov}(D_{1}, D_{2})\n$$\n我们的任务简化为使用同源等同 (IBD) 的第一性原理，为全同胞和半同胞推导这两个遗传协方差项。\n\n两个亲属之间的遗传协方差是群体遗传方差（$V_{A}$ 和 $V_{D}$）以及共享 IBD 等位基因概率的函数。让我们为一对个体定义两个关键系数：\n- 亲缘系数 $\\theta_{12}$，指的是从个体 $1$ 的一个基因座上随机抽取一个等位基因，与从个体 $2$ 的同一基因座上随机抽取一个等位基因是 IBD 的概率。\n- 同胞系数 $\\Delta_{12}$，指的是两个个体在一个基因座上共享两个等位基因 IBD（即它们的基因型是 IBD）的概率。\n\n加性值的协方差为 $\\text{Cov}(A_{1}, A_{2}) = 2\\theta_{12}V_{A}$。这是因为加性值 $A$ 是单个等位基因效应的总和。两个亲属的加性值之间的协方差与它们的等位基因是 IBD 的概率成正比。具体来说，对于单个基因座，$A = g_{m} + g_{p}$，其中 $g$ 代表一个等位基因的加性效应。$\\text{Cov}(A_1, A_2) = \\text{Cov}(g_{1m}+g_{1p}, g_{2m}+g_{2p}) = 4\\theta_{12}\\text{Var}(g)$。由于在随机交配下 $V_{A,locus} = 2\\text{Var}(g)$，这得到 $\\text{Cov}(A_1, A_2) = 2\\theta_{12}V_{A,locus}$。对所有非连锁基因座求和，得到总协方差。\n\n显性离差的协方差为 $\\text{Cov}(D_{1}, D_{2}) = \\Delta_{12}V_{D}$。显性离差 $D$ 是二倍体基因型（一个基因座上两个等位基因之间的相互作用）的一个属性。协方差 $\\text{Cov}(D_{1}, D_{2}) = \\mathbb{E}[D_{1}D_{2}]$（因为 $\\mathbb{E}[D]=0$）仅在两个个体的基因型相关时才非零。这种相关性是由于 IBD 造成的。如果基因型是 IBD（概率为 $\\Delta_{12}$），则期望 $\\mathbb{E}[D_{1}D_{2}]$ 等于 $V_{D}$，否则为零（假设随机交配）。因此，协方差恰好是 $\\Delta_{12}V_{D}$。\n\n现在，我们为指定的关系计算 $\\theta$ 和 $\\Delta$。\n\n**全同胞 (FS)**\n全同胞共享双亲，一个父本 (F) 和一个母本 (M)，他们非近交且不相关。设 IBD 状态由 $k_{i}$ 描述，即在一个基因座上共享 $i$ 个 IBD 等位基因的概率。\n- 共享两个 IBD 等位基因的概率（$k_{2}$）要求继承相同的父本等位基因（概率 $1/2$）并且继承相同的母本等位基因（概率 $1/2$）。这些是独立事件。因此，$\\Delta_{FS} = k_{2} = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$。\n- 共享零个 IBD 等位基因的概率（$k_{0}$）要求继承不同的父本等位基因（概率 $1/2$）并且继承不同的母本等位基因（概率 $1/2$）。因此，$k_{0} = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$。\n- 共享一个 IBD 等位基因的概率为 $k_{1} = 1 - k_{0} - k_{2} = 1 - \\frac{1}{4} - \\frac{1}{4} = \\frac{1}{2}$。\n亲缘系数由这些概率推导得出：$\\theta_{FS} = \\frac{1}{4}k_{1} + \\frac{1}{2}k_{2} = \\frac{1}{4}(\\frac{1}{2}) + \\frac{1}{2}(\\frac{1}{4}) = \\frac{1}{8} + \\frac{1}{8} = \\frac{1}{4}$。\n全同胞的表型相关性为：\n$$\nr_{FS} = \\text{Cov}(P_{1}, P_{2}) = 2\\theta_{FS}V_{A} + \\Delta_{FS}V_{D} = 2(\\frac{1}{4})V_{A} + \\frac{1}{4}V_{D} = \\frac{1}{2}V_{A} + \\frac{1}{4}V_{D}\n$$\n\n**父系半同胞 (HS)**\n父系半同胞共享一个共同的父本 (F)，但母本不同且不相关。\n- 他们不可能共享两个 IBD 等位基因，因为他们只有一个共同的亲本。因此，$\\Delta_{HS} = k_{2} = 0$。\n- 如果他们从共同的父本那里继承了相同的等位基因，他们就共享一个 IBD 等位基因。这个概率是 $k_{1} = 1/2$。\n- 如果他们从共同的父本那里继承了不同的等位基因，他们就共享零个 IBD 等位基因，概率为 $k_{0} = 1/2$。\n亲缘系数为：$\\theta_{HS} = \\frac{1}{4}k_{1} + \\frac{1}{2}k_{2} = \\frac{1}{4}(\\frac{1}{2}) + \\frac{1}{2}(0) = \\frac{1}{8}$。\n半同胞的表型相关性为：\n$$\nr_{HS} = \\text{Cov}(P_{1}, P_{2}) = 2\\theta_{HS}V_{A} + \\Delta_{HS}V_{D} = 2(\\frac{1}{8})V_{A} + (0)V_{D} = \\frac{1}{4}V_{A}\n$$\n\n**显性的贡献**\n推导出的相关性为 $r_{FS} = \\frac{1}{2}V_{A} + \\frac{1}{4}V_{D}$ 和 $r_{HS} = \\frac{1}{4}V_{A}$。比较揭示了显性的作用。半同胞之间的相关性仅取决于加性遗传方差 $V_{A}$。这是因为他们不能共享一个 IBD 的二倍体基因型（$\\Delta_{HS} = 0$），因此由基因座内等位基因相互作用产生的方差分量（$V_{D}$）对他们的相似性没有贡献。相比之下，全同胞有 $1/4$ 的概率共享相同的 IBD 基因型（$\\Delta_{FS} = 1/4$）。这使得显性效应能够对他们的相似性做出贡献，将其相关性增加了 $\\frac{1}{4}V_{D}$ 的量。全同胞相关性并不仅仅是半同胞相关性的两倍（如果只有加性效应存在，情况会是这样，因为 $2\\theta_{FS} = 2(2\\theta_{HS})$）；它比两倍还多出了这个显性项。全同胞之间这种额外的相似性是随机交配群体中非加性遗传方差（特别是显性方差）的典型特征。\n\n最终结果按要求以行矩阵形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}V_{A} + \\frac{1}{4}V_{D} & \\frac{1}{4}V_{A} \\end{pmatrix}}\n$$", "id": "2838200"}, {"introduction": "数量遗传学的核心预测工具是“育种家方程”，它将遗传力与选择响应联系起来。这项练习将挑战你从线性回归的基本原理出发，推导出这个著名的方程 $R = h^2 S$，从而巩固你对狭义遗传力（$h^2$）为何是预测短期演化的关键参数的理解。随后，你将把这个强大的工具应用于一个人工选择的实际情景中。[@problem_id:2838165]", "problem": "一个大的、随机交配的二倍体群体表现出一个数量性状，该性状受许多微效位点的纯加性基因作用控制。设表型模型为 $P = A + E$，其中 $A$ 是加性遗传（育种）值，$E$ 是环境离差，且 $\\operatorname{Cov}(A,E)=0$。表型方差为 $V_{P}=\\sigma_{P}^{2}$，加性遗传方差为 $V_{A}$。窄义遗传力为 $h^{2}=V_{A}/V_{P}$。在选择之前，该性状近似服从正态分布。\n\n在一代中，育种计划对上尾部进行表型截断选择。对于此截断，该计划报告了选择强度 $i$（从截断的正态模型中获得）。假设选择后的亲本随机交配，无显性，无上位性，并且环境分布在各代之间保持不变，因此子代表型均值等于子代育种值均值。\n\n仅使用上述基本定义和加性下的线性预测的标准性质，从第一性原理出发，推导在该截断选择下一个世代群体均值的预期变化，用 $i$、$h^{2}$ 和 $\\sigma_{P}$ 表示。然后，根据给定的 $i=1.755$，$h^{2}=0.36$ 和 $\\sigma_{P}=8.4$（性状单位）计算该表达式的值。用性状单位表示最终答案，并将答案四舍五入到 $4$ 位有效数字。", "solution": "问题要求从第一性原理出发，推导截断选择下一个世代群体均值的变化，然后用给定的具体参数计算这个变化。这个量被称为选择响应，用 $R$ 表示。\n\n设 $\\mu_P$ 和 $\\mu_A$ 分别为选择前亲代群体的表型均值和加性遗传（育种）值均值。不失一般性，我们可以将所有性状测量为其与初始均值的离差，使得 $\\mu_P = 0$ 且 $\\mu_A = 0$。表型模型为 $P = A + E$，其中 $P$ 是表型，$A$ 是育种值，$E$ 是环境离差。取期望可得 $\\mu_P = \\mu_A + \\mu_E$。根据我们的约定，这意味着 $\\mu_E=0$。\n\n选择是基于表型 $P$ 进行的。让下标 $S$ 表示被选择的亲本群体。该被选群体的表型均值为 $\\mu_{P,S}$。选择差 $S$ 是被选亲本的表型均值与选择前亲代群体的均值之差：\n$$S = \\mu_{P,S} - \\mu_P$$\n当 $\\mu_P=0$ 时，这简化为 $S = \\mu_{P,S}$。\n\n子代是通过这些被选亲本之间的随机交配产生的。设 $\\mu_{P'}$ 和 $\\mu_{A'}$ 分别表示子代的表型均值和育种值均值。选择响应 $R$ 是从亲代到子代群体表型均值的变化：\n$$R = \\mu_{P'} - \\mu_P$$\n当 $\\mu_P=0$ 时，这变为 $R = \\mu_{P'}$。\n\n问题陈述子代表型均值等于子代育种值均值。这意味着 $\\mu_{P'} = \\mu_{A'}$。这个假设基于环境分布不变的事实，因此子代的平均环境效应 $\\mu_{E'}$ 与亲代的相同，我们已将其设为 $\\mu_E=0$。\n此外，在随机交配下，子代的平均育种值是被选亲本平均育种值的平均值。设 $\\mu_{A,S}$ 为被选亲本的平均育种值。那么，$\\mu_{A'} = \\mu_{A,S}$。\n综合这些事实，选择响应为：\n$$R = \\mu_{P'} = \\mu_{A'} = \\mu_{A,S}$$\n我们现在的任务是找到 $\\mu_{A,S}$（即 $R$）和 $\\mu_{P,S}$（即 $S$）之间的关系。这种关系可以从线性回归的原理中推导出。\n\n我们希望根据个体的表型 $P$ 来预测其育种值 $A$。$A$ 对 $P$ 的线性回归给出了从 $P$ 预测 $A$ 的最佳线性预测。回归方程是：\n$$E[A | P] - \\mu_A = b_{A,P} (P - \\mu_P)$$\n其中 $b_{A,P}$ 是 $A$ 对 $P$ 的回归系数。使用我们的约定，即初始均值为零，这简化为 $E[A|P] = b_{A,P} P$。\n\n回归系数 $b_{A,P}$ 定义为：\n$$b_{A,P} = \\frac{\\operatorname{Cov}(A, P)}{\\operatorname{Var}(P)}$$\n问题提供了模型 $P = A + E$ 且 $\\operatorname{Cov}(A, E) = 0$。分子中的协方差项可以展开：\n$$\\operatorname{Cov}(A, P) = \\operatorname{Cov}(A, A+E) = \\operatorname{Cov}(A, A) + \\operatorname{Cov}(A, E)$$\n根据定义，$\\operatorname{Cov}(A, A) = \\operatorname{Var}(A) = V_A$。我们已知 $\\operatorname{Cov}(A, E) = 0$。\n因此，$\\operatorname{Cov}(A, P) = V_A$。\n分母是表型方差，$\\operatorname{Var}(P) = V_P$。\n将这些代入回归系数的表达式中：\n$$b_{A,P} = \\frac{V_A}{V_P}$$\n根据定义，这个比率是窄义遗传力 $h^2$。所以，$b_{A,P} = h^2$。\n\n因此，回归方程为 $E[A|P] = h^2 P$。预期育种值和表型之间的这种关系也适用于群体中任何子群体的均值。具体来说，对于被选亲本群体：\n$$E[A | \\text{selected}] = h^2 E[P | \\text{selected}]$$\n等式左边是被选群体的平均育种值 $\\mu_{A,S}$。等式右边包含被选群体的平均表型 $\\mu_{P,S}$。\n$$\\mu_{A,S} = h^2 \\mu_{P,S}$$\n回顾我们的定义，$R = \\mu_{A,S}$ 且 $S = \\mu_{P,S}$。将这些代入方程，得到育种家方程：\n$$R = h^2 S$$\n问题提供了选择强度 $i$，而不是选择差 $S$。选择强度定义为用表型标准差 $\\sigma_P = \\sqrt{V_P}$ 标准化后的选择差：\n$$i = \\frac{S}{\\sigma_P}$$\n这个定义源于正态分布的性质，即对于截断选择，被选（截断）部分的均值与分布的标准差成正比，$i$是比例常数。\n从这个定义中，我们可以将选择差表示为 $S = i \\sigma_P$。\n\n将这个 $S$ 的表达式代入育种家方程，得到选择响应的最终推导关系：\n$$R = h^2 (i \\sigma_P) = i h^2 \\sigma_P$$\n该方程用选择强度 $i$、窄义遗传力 $h^2$ 和表型标准差 $\\sigma_P$ 预测了一代内群体均值的变化，符合题目要求。\n\n现在我们用给定的数值计算这个表达式：\n$i = 1.755$\n$h^2 = 0.36$\n$\\sigma_P = 8.4$ 性状单位。\n\n预期的选择响应是：\n$$R = (1.755) \\times (0.36) \\times (8.4)$$\n$$R = (0.6318) \\times (8.4)$$\n$$R = 5.30712$$\n问题要求将答案四舍五入到 $4$ 位有效数字。\n前四位有效数字是 $5$、$3$、$0$ 和 $7$。第五位数字是 $1$，所以我们向下舍入。\n$$R \\approx 5.307$$\n选择响应是 $5.307$ 性状单位。", "answer": "$$\\boxed{5.307}$$", "id": "2838165"}, {"introduction": "在基因组学时代，我们分析来自全基因组关联研究（GWAS）的成千上万个遗传变异，但连锁不平衡（LD）使得解释它们的影响变得复杂。这项高级练习将向你介绍LD谱回归的核心逻辑，这是一种区分多基因信号与混杂因素的强大技术。通过推导单个SNP的边际效应大小与其LD谱分之间的关系，你将学习到现代统计遗传学如何利用LD的结构从GWAS摘要数据中估算遗传力。[@problem_id:2838198]", "problem": "一个数量性状由通过单核苷酸多态性 (SNP) 起作用的高度多基因结构决定。考虑一个在 $M$ 个 SNP 上进行了基因分型的群体样本，样本量为 $N$。设 $\\mathbf{X} \\in \\mathbb{R}^{N \\times M}$ 是标准化的基因型矩阵，其列均值为 $0$，方差为 $1$。设 $\\mathbf{R} = \\frac{1}{N}\\mathbf{X}^{\\top}\\mathbf{X}$ 表示样本连锁不平衡 (LD) 矩阵，您可以将其视为固定的，并且等于群体 LD 矩阵。表型向量 $\\mathbf{y} \\in \\mathbb{R}^{N}$ 服从一个加性线性模型\n$$\n\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\gamma} + \\mathbf{e},\n$$\n其中 $\\boldsymbol{\\gamma} \\in \\mathbb{R}^{M}$ 是每个等位基因的因果效应向量，$\\mathbf{e} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma_{e}^{2}\\mathbf{I}_{N})$ 是独立的环境噪声。假设该性状已被标准化，使得 $\\operatorname{Var}(\\mathbf{y})=1$。对于每个 SNP $j$，通过将 $\\mathbf{y}$ 回归到第 $j$ 个基因型列来定义单变量边际效应估计量：其向量形式为，\n$$\n\\hat{\\boldsymbol{\\beta}} \\equiv \\frac{1}{N}\\mathbf{X}^{\\top}\\mathbf{y} \\in \\mathbb{R}^{M}.\n$$\n假设一个可交换的高斯随机效应先验 $\\boldsymbol{\\gamma} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma_{\\gamma}^{2}\\mathbf{I}_{M})$，且其独立于 $\\mathbf{e}$。定义 SNP $j$ 的 LD 得分为 $l_{j} \\equiv \\sum_{k=1}^{M} r_{jk}^{2}$，其中 $r_{jk}$ 是 $\\mathbf{R}$ 的第 $(j,k)$ 个元素。最后，在性状标准化 $\\operatorname{Var}(\\mathbf{y})=1$ 的条件下，定义 SNP 遗传力 $h_{g}^{2}$ 为 $h_{g}^{2} \\equiv \\operatorname{Var}(\\mathbf{X}\\boldsymbol{\\gamma})$。\n\n仅使用这些定义以及多变量高斯随机变量和使用标准化预测变量的线性回归的性质，推导出条件期望\n$$\n\\mathbb{E}\\!\\left[\\,N\\,\\hat{\\beta}_{j}^{2} \\,\\middle|\\, \\mathbf{R} \\right]\n$$\n的显式闭式表达式，该表达式应为 $N$、$M$、$h_{g}^{2}$ 和 $l_{j}$ 的函数。您的推导必须从上述模型和定义出发，不得引用任何关于 LD 得分回归的已有结论。以最简的封闭形式给出最终表达式。无需进行数值评估。最终答案必须是单一的、无单位的解析表达式。", "solution": "我们的目标是推导条件期望 $\\mathbb{E}\\!\\left[\\,N\\,\\hat{\\beta}_{j}^{2} \\,\\middle|\\, \\mathbf{R} \\right]$。该期望是针对随机变量 $\\boldsymbol{\\gamma}$ 和 $\\mathbf{e}$ 进行的，其中 LD 矩阵 $\\mathbf{R}$（以及基因型矩阵 $\\mathbf{X}$）被视为固定的。\n\n首先，我们将边际效应估计量 $\\hat{\\boldsymbol{\\beta}}$ 用其模型分量表示。根据定义：\n$$\n\\hat{\\boldsymbol{\\beta}} = \\frac{1}{N}\\mathbf{X}^{\\top}\\mathbf{y} = \\frac{1}{N}\\mathbf{X}^{\\top}(\\mathbf{X}\\boldsymbol{\\gamma} + \\mathbf{e})\n$$\n利用 $\\mathbf{R} = \\frac{1}{N}\\mathbf{X}^{\\top}\\mathbf{X}$，上式变为：\n$$\n\\hat{\\boldsymbol{\\beta}} = \\left(\\frac{1}{N}\\mathbf{X}^{\\top}\\mathbf{X}\\right)\\boldsymbol{\\gamma} + \\frac{1}{N}\\mathbf{X}^{\\top}\\mathbf{e} = \\mathbf{R}\\boldsymbol{\\gamma} + \\frac{1}{N}\\mathbf{X}^{\\top}\\mathbf{e}\n$$\n该向量的第 $j$ 个分量 $\\hat{\\beta}_{j}$ 是：\n$$\n\\hat{\\beta}_{j} = (\\mathbf{R}\\boldsymbol{\\gamma})_{j} + \\frac{1}{N}(\\mathbf{X}^{\\top}\\mathbf{e})_{j}\n$$\n我们现在计算 $N\\hat{\\beta}_{j}^{2}$ 的期望。由于 $\\boldsymbol{\\gamma}$ 和 $\\mathbf{e}$ 是相互独立且均值为零的随机变量，$\\hat{\\beta}_{j}$ 表达式中两个项的交叉乘积的期望为零。因此，期望的线性性质告诉我们：\n$$\n\\mathbb{E}\\!\\left[\\,N\\,\\hat{\\beta}_{j}^{2} \\,\\middle|\\, \\mathbf{R} \\right] = N\\,\\mathbb{E}\\!\\left[\\,(\\mathbf{R}\\boldsymbol{\\gamma})_{j}^{2}\\,\\right] + \\frac{1}{N}\\mathbb{E}\\!\\left[\\,(\\mathbf{X}^{\\top}\\mathbf{e})_{j}^{2}\\,\\right]\n$$\n我们分别计算右侧的两项。\n\n第一项涉及因果效应 $\\boldsymbol{\\gamma}$。$(\\mathbf{R}\\boldsymbol{\\gamma})_j$ 是 $\\sum_{k=1}^{M} r_{jk}\\gamma_{k}$。由于 $\\boldsymbol{\\gamma} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma_{\\gamma}^{2}\\mathbf{I}_{M})$，我们有 $\\mathbb{E}[\\gamma_{k}\\gamma_{l}] = \\sigma_{\\gamma}^{2}\\delta_{kl}$（其中 $\\delta_{kl}$ 是克罗内克函数）。因此：\n$$\n\\mathbb{E}\\!\\left[\\,(\\mathbf{R}\\boldsymbol{\\gamma})_{j}^{2}\\,\\right] = \\mathbb{E}\\!\\left[\\,\\left(\\sum_{k=1}^{M} r_{jk}\\gamma_{k}\\right)^{2}\\,\\right] = \\sum_{k=1}^{M}\\sum_{l=1}^{M} r_{jk}r_{jl}\\,\\mathbb{E}\\!\\left[\\,\\gamma_{k}\\gamma_{l}\\,\\right] = \\sigma_{\\gamma}^{2}\\sum_{k=1}^{M} r_{jk}^{2}\n$$\n根据 LD 得分的定义 $l_{j} = \\sum_{k=1}^{M} r_{jk}^{2}$，第一项简化为 $\\sigma_{\\gamma}^{2}l_{j}$。\n\n第二项涉及环境噪声 $\\mathbf{e}$。$(\\mathbf{X}^{\\top}\\mathbf{e})_j$ 是 $\\mathbf{x}_{j}^{\\top}\\mathbf{e}$，其中 $\\mathbf{x}_{j}$ 是 $\\mathbf{X}$ 的第 $j$ 列。由于 $\\mathbf{e} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma_{e}^{2}\\mathbf{I}_{N})$，其平方的期望（即方差）为：\n$$\n\\mathbb{E}\\!\\left[\\,(\\mathbf{x}_{j}^{\\top}\\mathbf{e})^{2}\\,\\right] = \\operatorname{Var}(\\mathbf{x}_{j}^{\\top}\\mathbf{e}) = \\mathbf{x}_{j}^{\\top}\\operatorname{Cov}(\\mathbf{e})\\mathbf{x}_{j} = \\mathbf{x}_{j}^{\\top}(\\sigma_{e}^{2}\\mathbf{I}_{N})\\mathbf{x}_{j} = \\sigma_{e}^{2}(\\mathbf{x}_{j}^{\\top}\\mathbf{x}_{j})\n$$\n由于基因型列被标准化为方差为 1，我们有 $\\frac{1}{N}\\mathbf{x}_{j}^{\\top}\\mathbf{x}_{j} = 1$，这意味着 $\\mathbf{x}_{j}^{\\top}\\mathbf{x}_{j} = N$。因此，第二项的期望为 $N\\sigma_{e}^{2}$。\n\n将这些结果代回，我们得到 $\\hat{\\beta}_{j}^2$ 的期望：\n$$\n\\mathbb{E}\\!\\left[\\,\\hat{\\beta}_{j}^{2}\\,\\right] = \\sigma_{\\gamma}^{2}l_{j} + \\frac{1}{N^2}(N\\sigma_{e}^{2}) = \\sigma_{\\gamma}^{2}l_{j} + \\frac{\\sigma_{e}^{2}}{N}\n$$\n因此，我们要求解的量为：\n$$\n\\mathbb{E}\\!\\left[\\,N\\,\\hat{\\beta}_{j}^{2} \\,\\middle|\\, \\mathbf{R} \\right] = N\\,\\mathbb{E}\\!\\left[\\,\\hat{\\beta}_{j}^{2}\\,\\right] = N\\left( \\sigma_{\\gamma}^{2}l_{j} + \\frac{\\sigma_{e}^{2}}{N} \\right) = N\\sigma_{\\gamma}^{2}l_{j} + \\sigma_{e}^{2}\n$$\n最后一步是用给定的参数 $h_{g}^{2}$ 和 $M$ 来表示方差分量 $\\sigma_{\\gamma}^{2}$ 和 $\\sigma_{e}^{2}$。\n总表型方差（每个个体）为 1，并且可以分解为遗传和环境分量：$\\operatorname{Var}(y_i) = \\operatorname{Var}((\\mathbf{X}\\boldsymbol{\\gamma})_i) + \\operatorname{Var}(e_i)$。这可以写成 $1 = h_{g}^{2} + \\sigma_{e}^{2}$，所以 $\\sigma_{e}^{2} = 1 - h_{g}^{2}$。\n\n要将 $h_{g}^{2}$ 与 $\\sigma_{\\gamma}^{2}$ 联系起来，我们计算遗传值的期望方差：\n$$\nh_{g}^{2} = \\operatorname{Var}(\\mathbf{X}\\boldsymbol{\\gamma}) = \\mathbb{E}_{\\boldsymbol{\\gamma}}\\!\\left[\\frac{1}{N}(\\mathbf{X}\\boldsymbol{\\gamma})^{\\top}(\\mathbf{X}\\boldsymbol{\\gamma})\\right] = \\mathbb{E}\\!\\left[\\boldsymbol{\\gamma}^{\\top}\\mathbf{R}\\boldsymbol{\\gamma}\\right]\n$$\n利用迹运算的性质：\n$$\nh_{g}^{2} = \\mathbb{E}\\!\\left[\\operatorname{Tr}(\\mathbf{R}\\boldsymbol{\\gamma}\\boldsymbol{\\gamma}^{\\top})\\right] = \\operatorname{Tr}(\\mathbf{R}\\,\\mathbb{E}[\\boldsymbol{\\gamma}\\boldsymbol{\\gamma}^{\\top}]) = \\operatorname{Tr}(\\mathbf{R}\\sigma_{\\gamma}^{2}\\mathbf{I}_{M}) = \\sigma_{\\gamma}^{2}\\operatorname{Tr}(\\mathbf{R})\n$$\n由于每个 SNP 的方差为 1，$\\mathbf{R}$ 的对角元素 $r_{jj}$ 均为 1，因此 $\\operatorname{Tr}(\\mathbf{R}) = M$。\n所以，$h_{g}^{2} = M\\sigma_{\\gamma}^{2}$，这意味着 $\\sigma_{\\gamma}^{2} = \\frac{h_{g}^{2}}{M}$。\n\n将 $\\sigma_{\\gamma}^{2}$ 和 $\\sigma_{e}^{2}$ 的表达式代入我们的结果，得到最终表达式：\n$$\n\\mathbb{E}\\!\\left[\\,N\\,\\hat{\\beta}_{j}^{2} \\,\\middle|\\, \\mathbf{R} \\right] = N\\left(\\frac{h_{g}^{2}}{M}\\right)l_{j} + (1 - h_{g}^{2})\n$$", "answer": "$$\n\\boxed{\\frac{N h_{g}^{2}}{M} l_{j} + 1 - h_{g}^{2}}\n$$", "id": "2838198"}]}