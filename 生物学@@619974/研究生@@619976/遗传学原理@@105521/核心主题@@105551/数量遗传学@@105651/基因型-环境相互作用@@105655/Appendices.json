{"hands_on_practices": [{"introduction": "方差分析（ANOVA）是量化基因型与环境互作（G×E）的经典统计框架。本练习将带您从第一性原理出发，推导并计算G×E互作的平方和，从而深入理解互作效应的本质——即基因型和环境的独立主效应无法解释的表型变异部分。通过这个实践，您将为理解更复杂的遗传模型打下坚实的基础。[@problem_id:2820161]", "problem": "一项植物育种试验在两种基因型和两种环境下评估一个数量性状，以评价基因型与环境（G×E）的互作效应。设 $i \\in \\{1,2\\}$ 为基因型索引，$j \\in \\{1,2\\}$ 为环境索引。在每个基因型-环境单元格中，有 $n$ 个独立重复个体，其中 $n=8$，每个个体测量一次。固定效应双因素方差分析（ANOVA）模型为\n$$\ny_{ijk} \\;=\\; \\mu \\;+\\; g_i \\;+\\; e_j \\;+\\; (ge)_{ij} \\;+\\; \\epsilon_{ijk},\n$$\n其中 $k \\in \\{1,\\dots,n\\}$ 为重复索引，$\\mu$ 是总均值，$g_i$ 是基因型效应，$e_j$ 是环境效应，$(ge)_{ij}$ 是 G×E 互作效应，$\\epsilon_{ijk}$ 是均值为 $0$ 且方差恒定的独立误差。观测到的单元格样本均值为\n$$\n\\bar{y}_{11}=10,\\quad \\bar{y}_{12}=14,\\quad \\bar{y}_{21}=12,\\quad \\bar{y}_{22}=11.\n$$\n从固定效应下最小二乘估计的核心定义以及平衡设计的标准方差分析分解出发，推导G×E平方和关于单元格均值和 $n$ 的表达式，不得引用任何预先记背的快捷公式。然后利用给定数据和 $n=8$ 计算G×E平方和的数值。报告一个实数值。无需进行四舍五入。", "solution": "对所述问题进行验证。\n\n逐字提取已知条件：\n- 评估一个数量性状。\n- 索引：$i \\in \\{1,2\\}$ 代表基因型，$j \\in \\{1,2\\}$ 代表环境。\n- 每个单元格的重复数：$n=8$。\n- 重复索引：$k \\in \\{1,\\dots,n\\}$。\n- 方差分析模型：$y_{ijk} = \\mu + g_i + e_j + (ge)_{ij} + \\epsilon_{ijk}$。\n- 模型组成：$\\mu$ 是总均值，$g_i$ 是基因型效应，$e_j$ 是环境效应，$(ge)_{ij}$ 是 G×E 互作效应。\n- 误差项：$\\epsilon_{ijk}$ 是均值为 $0$ 且方差恒定的独立误差。\n- 观测到的单元格样本均值：$\\bar{y}_{11}=10$, $\\bar{y}_{12}=14$, $\\bar{y}_{21}=12$, $\\bar{y}_{22}=11$。问题陈述中的记号 $\\bar{y}_{ij}$ 被理解为单元格均值 $\\bar{y}_{ij.} = \\frac{1}{n}\\sum_{k=1}^n y_{ijk}$。\n\n验证结论：\n该问题具有科学依据、提法得当、客观且信息自洽。它描述了一个标准的固定效应双因素方差分析，这是统计学和遗传学中的一种基本方法。所提供的数据足以完成该任务，该任务要求从基本原理出发进行推导，然后进行计算。该问题不违反任何有效性标准。因此，将提供解答。\n\n该问题要求从基本原理出发，推导基因型与环境（G×E）互作的平方和，记为 $SS_{G \\times E}$。该模型是一个固定效应线性模型：\n$$\ny_{ijk} \\;=\\; \\mu \\;+\\; g_i \\;+\\; e_j \\;+\\; (ge)_{ij} \\;+\\; \\epsilon_{ijk}\n$$\n该模型是过度参数化的。为了获得参数的唯一最小二乘估计，我们施加和为零的约束：\n$$\n\\sum_{i=1}^2 g_i = 0, \\quad \\sum_{j=1}^2 e_j = 0, \\quad \\sum_{i=1}^2 (ge)_{ij} = 0 \\text{ for each } j, \\quad \\sum_{j=1}^2 (ge)_{ij} = 0 \\text{ for each } i\n$$\n单元格 $(i, j)$ 中观测值的期望值 $E[y_{ijk}] = \\mu + g_i + e_j + (ge)_{ij}$ 的最小二乘估计是该单元格的样本均值：\n$$\n\\widehat{E[y_{ijk}]} = \\bar{y}_{ij.} = \\frac{1}{n} \\sum_{k=1}^n y_{ijk}\n$$\n各参数的最小二乘估计值可以用各种样本均值来表示。我们定义这些均值如下：\n总均值：$\\bar{y}_{...} = \\frac{1}{4n} \\sum_{i=1}^2 \\sum_{j=1}^2 \\sum_{k=1}^n y_{ijk} = \\frac{1}{4} \\sum_{i=1}^2 \\sum_{j=1}^2 \\bar{y}_{ij.}$\n基因型均值：$\\bar{y}_{i..} = \\frac{1}{2n} \\sum_{j=1}^2 \\sum_{k=1}^n y_{ijk} = \\frac{1}{2} \\sum_{j=1}^2 \\bar{y}_{ij.}$\n环境均值：$\\bar{y}_{.j.} = \\frac{1}{2n} \\sum_{i=1}^2 \\sum_{k=1}^n y_{ijk} = \\frac{1}{2} \\sum_{i=1}^2 \\bar{y}_{ij.}$\n\n参数的最小二乘估计值为：\n$$\n\\hat{\\mu} = \\bar{y}_{...} \\\\\n\\hat{g}_i = \\bar{y}_{i..} - \\bar{y}_{...} \\\\\n\\hat{e}_j = \\bar{y}_{.j.} - \\bar{y}_{...} \\\\\n\\widehat{(ge)}_{ij} = \\bar{y}_{ij.} - \\hat{\\mu} - \\hat{g}_i - \\hat{e}_j = \\bar{y}_{ij.} - \\bar{y}_{...} - (\\bar{y}_{i..} - \\bar{y}_{...}) - (\\bar{y}_{.j.} - \\bar{y}_{...}) = \\bar{y}_{ij.} - \\bar{y}_{i..} - \\bar{y}_{.j.} + \\bar{y}_{...}\n$$\n互作效应 $(ge)_{ij}$ 表示单元格均值 $\\bar{y}_{ij.}$ 与仅由基因型和环境的加性效应所预测的值之间的偏差。\n\n在方差分析模型中，任一效应的平方和定义为实验中所有观测值对应的估计效应的平方之和。对于 G×E 互作，这个和是对所有 $4n$ 个观测值求和。对于任一观测值 $y_{ijk}$，其对应的估计互作效应为 $\\widehat{(ge)}_{ij}$。\n$$\nSS_{G \\times E} = \\sum_{i=1}^2 \\sum_{j=1}^2 \\sum_{k=1}^n (\\widehat{(ge)}_{ij})^2\n$$\n由于估计效应 $\\widehat{(ge)}_{ij}$ 对于单元格 $(i, j)$ 内的所有 $n$ 个重复都是恒定的，我们可以简化表达式：\n$$\nSS_{G \\times E} = \\sum_{i=1}^2 \\sum_{j=1}^2 \\left( n \\cdot (\\widehat{(ge)}_{ij})^2 \\right) = n \\sum_{i=1}^2 \\sum_{j=1}^2 (\\widehat{(ge)}_{ij})^2\n$$\n代入推导出的估计互作效应表达式，我们得到 G×E 平方和关于样本均值和 $n$ 的公式：\n$$\nSS_{G \\times E} = n \\sum_{i=1}^2 \\sum_{j=1}^2 (\\bar{y}_{ij.} - \\bar{y}_{i..} - \\bar{y}_{.j.} + \\bar{y}_{...})^2\n$$\n至此，按要求完成了推导。现在，我们计算其数值。重复数为 $n=8$。给定的单元格均值为 $\\bar{y}_{11.} = 10$、$\\bar{y}_{12.} = 14$、$\\bar{y}_{21.} = 12$ 和 $\\bar{y}_{22.} = 11$。\n\n首先，我们计算所需的边际均值和总均值：\n总均值：\n$$\n\\bar{y}_{...} = \\frac{1}{4} (10 + 14 + 12 + 11) = \\frac{47}{4} = 11.75\n$$\n基因型均值：\n$$\n\\bar{y}_{1..} = \\frac{1}{2} (10 + 14) = \\frac{24}{2} = 12 \\\\\n\\bar{y}_{2..} = \\frac{1}{2} (12 + 11) = \\frac{23}{2} = 11.5\n$$\n环境均值：\n$$\n\\bar{y}_{.1.} = \\frac{1}{2} (10 + 12) = \\frac{22}{2} = 11 \\\\\n\\bar{y}_{.2.} = \\frac{1}{2} (14 + 11) = \\frac{25}{2} = 12.5\n$$\n接下来，我们计算四个单元格中每个单元格的估计互作效应：\n$$\n\\widehat{(ge)}_{11} = \\bar{y}_{11.} - \\bar{y}_{1..} - \\bar{y}_{.1.} + \\bar{y}_{...} = 10 - 12 - 11 + 11.75 = -1.25 \\\\\n\\widehat{(ge)}_{12} = \\bar{y}_{12.} - \\bar{y}_{1..} - \\bar{y}_{.2.} + \\bar{y}_{...} = 14 - 12 - 12.5 + 11.75 = 1.25 \\\\\n\\widehat{(ge)}_{21} = \\bar{y}_{21.} - \\bar{y}_{2..} - \\bar{y}_{.1.} + \\bar{y}_{...} = 12 - 11.5 - 11 + 11.75 = 1.25 \\\\\n\\widehat{(ge)}_{22} = \\bar{y}_{22.} - \\bar{y}_{2..} - \\bar{y}_{.2.} + \\bar{y}_{...} = 11 - 11.5 - 12.5 + 11.75 = -1.25\n$$\n最后，我们使用推导出的公式计算 G×E 平方和：\n$$\nSS_{G \\times E} = n \\sum_{i=1}^2 \\sum_{j=1}^2 (\\widehat{(ge)}_{ij})^2 = 8 \\left[ (-1.25)^2 + (1.25)^2 + (1.25)^2 + (-1.25)^2 \\right]\n$$\n$$\nSS_{G \\times E} = 8 \\left[ 2 \\cdot (-1.25)^2 + 2 \\cdot (1.25)^2 \\right] = 8 \\left[ 4 \\cdot (1.25)^2 \\right]\n$$\n我们有 $1.25 = \\frac{5}{4}$，因此 $(1.25)^2 = \\left(\\frac{5}{4}\\right)^2 = \\frac{25}{16}$。\n$$\nSS_{G \\times E} = 8 \\left( 4 \\cdot \\frac{25}{16} \\right) = 8 \\left( \\frac{100}{16} \\right) = 8 \\left( \\frac{25}{4} \\right) = 2 \\cdot 25 = 50\n$$\nG×E 平方和的数值是 $50$。", "answer": "$$\\boxed{50}$$", "id": "2820161"}, {"introduction": "反应规范（Reaction norms）将G×E互作从抽象的统计量转化为直观的图形。通过将每个基因型的表型描绘成环境梯度的函数，我们可以清晰地看到基因型对环境变化的响应模式。本练习将让您通过代数计算，精确定位基因型之间发生优劣排序逆转的“交叉点”，这是理解和预测基因型在不同环境下表现的关键技能。[@problem_id:2820143]", "problem": "在线性反应规范框架中，基因型 $g$ 在环境 $x$ 中的预期表型被建模为 $y_{g}(x)=\\beta_{0g}+\\beta_{1g}x$，其中 $\\beta_{0g}$ 是截距（在 $x=0$ 时的基线表型），$\\beta_{1g}$ 是斜率（$x$ 每单位变化引起的表型变化）。当基因型对预期表型的影响取决于环境时，就存在基因型-环境（G×E）相互作用，这种情况在存在基因型 $g \\neq h$ 且 $\\beta_{1g} \\neq \\beta_{1h}$ 时发生。基因型 $g$ 和 $h$ 之间在环境值 $x^{\\star}$ 处的交叉相互作用是一个点，在该点上 $y_{g}(x^{\\star})=y_{h}(x^{\\star})$ 且 $\\beta_{1g} \\neq \\beta_{1h}$，这意味着预期表型的排序在 $x^{\\star}$ 两侧发生了变化。\n\n考虑三个基因型 $A$、$B$ 和 $C$，它们的反应规范为\n$y_{A}(x)=\\beta_{0A}+\\beta_{1A}x$、$y_{B}(x)=\\beta_{0B}+\\beta_{1B}x$ 和 $y_{C}(x)=\\beta_{0C}+\\beta_{1C}x$，参数如下\n$\\beta_{1A}=0$，$\\beta_{1B}=1.2$，$\\beta_{1C}=-0.5$，以及 $\\beta_{0A}=5$，$\\beta_{0B}=3$，$\\beta_{0C}=6$。环境范围是 $x \\in [0,2]$。\n\n仅使用上述定义和代数推理，确定在 $[0,2]$ 范围内的所有 $A$、$B$ 和 $C$ 之间的不同成对交叉点。令 $S$ 表示这些不同交叉点 $x$ 坐标的总和。将 $S$ 的精确值报告为单个实数。如果在 $[0,2]$ 范围内没有交叉点，则取 $S=0$。无需四舍五入，也无需单位。", "solution": "该问题已经过验证，被认为是数量遗传学中一个定义明确、有科学依据的问题。我将开始解答。\n\n基因型 $g$ 在环境 $x$ 中的预期表型 $y_g(x)$ 由线性反应规范模型给出：\n$$y_g(x) = \\beta_{0g} + \\beta_{1g}x$$\n其中 $\\beta_{0g}$ 是截距，$\\beta_{1g}$ 是斜率。\n\n提供了三个基因型 $A$、$B$ 和 $C$ 的参数：\n基因型 $A$: $\\beta_{0A}=5$, $\\beta_{1A}=0$。\n基因型 $B$: $\\beta_{0B}=3$, $\\beta_{1B}=1.2$。\n基因型 $C$: $\\beta_{0C}=6$, $\\beta_{1C}=-0.5$。\n\n将这些参数代入模型，我们得到每个基因型的具体反应规范方程：\n$$y_{A}(x) = 5 + (0)x = 5$$\n$$y_{B}(x) = 3 + 1.2x$$\n$$y_{C}(x) = 6 - 0.5x$$\n\n两个基因型 $g$ 和 $h$ 之间的交叉相互作用发生在一个环境值 $x^{\\star}$ 处，在该处它们的表型值相等，即 $y_g(x^{\\star}) = y_h(x^{\\star})$，且它们的环​​境敏感性（斜率）不同，即 $\\beta_{1g} \\neq \\beta_{1h}$。基因型 $A$、$B$ 和 $C$ 的斜率分别为 $\\beta_{1A}=0$、$\\beta_{1B}=1.2$ 和 $\\beta_{1C}=-0.5$。由于这三个斜率都不同，因此对于这些基因型的任意一对，都满足交叉相互作用的条件。\n\n我们必须找到每个成对交叉的 $x$ 值，并验证它是否落在指定的环境范围 $x \\in [0, 2]$ 内。我们将分析三种可能的基因型配对。\n\n1.  **基因型 $A$ 和基因型 $B$ 之间的交叉：**\n    我们令它们的反应规范相等，以找到交叉点，记为 $x_{AB}$：\n    $$y_A(x_{AB}) = y_B(x_{AB})$$\n    $$5 = 3 + 1.2x_{AB}$$\n    $$2 = 1.2x_{AB}$$\n    $$x_{AB} = \\frac{2}{1.2} = \\frac{2}{12/10} = \\frac{20}{12} = \\frac{5}{3}$$\n    为了确定这是否是指定范围内的有效交叉点，我们检查 $x_{AB} \\in [0, 2]$ 是否成立。由于 $0 \\le \\frac{5}{3} \\le 2$（因为 $0 \\le 5$ 且 $5 \\le 6$），因此该点有效。\n\n2.  **基因型 $A$ 和基因型 $C$ 之间的交叉：**\n    我们令它们的反应规范相等，以找到交叉点 $x_{AC}$：\n    $$y_A(x_{AC}) = y_C(x_{AC})$$\n    $$5 = 6 - 0.5x_{AC}$$\n    $$-1 = -0.5x_{AC}$$\n    $$x_{AC} = \\frac{1}{0.5} = 2$$\n    我们检查 $x_{AC} \\in [0, 2]$ 是否成立。值 $x_{AC}=2$ 位于区间的边界上并被包含在内。因此，该点有效。\n\n3.  **基因型 $B$ 和基因型 $C$ 之间的交叉：**\n    我们令它们的反应规范相等，以找到交叉点 $x_{BC}$：\n    $$y_B(x_{BC}) = y_C(x_{BC})$$\n    $$3 + 1.2x_{BC} = 6 - 0.5x_{BC}$$\n    $$1.2x_{BC} + 0.5x_{BC} = 6 - 3$$\n    $$1.7x_{BC} = 3$$\n    $$x_{BC} = \\frac{3}{1.7} = \\frac{3}{17/10} = \\frac{30}{17}$$\n    我们检查 $x_{BC} \\in [0, 2]$ 是否成立。由于 $0 \\le \\frac{30}{17} \\le 2$（因为 $0 \\le 30$ 且 $30 \\le 34$），因此该点有效。\n\n在环境范围 $[0, 2]$ 内的不同交叉点是 $x_{AB} = \\frac{5}{3}$、$x_{AC} = 2$ 和 $x_{BC} = \\frac{30}{17}$。问题要求计算这些 $x$ 坐标的总和 $S$。\n$$S = x_{AB} + x_{AC} + x_{BC} = \\frac{5}{3} + 2 + \\frac{30}{17}$$\n\n为了计算这个和，我们找到分数的公分母，即 $3 \\times 17 = 51$。\n$$S = \\frac{5 \\times 17}{3 \\times 17} + \\frac{2 \\times 51}{51} + \\frac{30 \\times 3}{17 \\times 3}$$\n$$S = \\frac{85}{51} + \\frac{102}{51} + \\frac{90}{51}$$\n$$S = \\frac{85 + 102 + 90}{51}$$\n$$S = \\frac{187 + 90}{51}$$\n$$S = \\frac{277}{51}$$\n分子 $277$ 是一个质数，并且不是 $51$ 的倍数。因此，该分数是最简分数。\n$S$ 的精确值为 $\\frac{277}{51}$。", "answer": "$$\\boxed{\\frac{277}{51}}$$", "id": "2820143"}, {"introduction": "在处理多环境试验数据时，G×E互作可能呈现出复杂的模式。AMMI（主效应加性与互作效应乘性）模型通过将方差分析（ANOVA）与主成分分析（PCA）相结合，为我们提供了一种解剖这种复杂性的有力工具。本练习将指导您完成一次简化的AMMI分析，从计算互作残差矩阵到提取关键的主成分分数，从而学会如何识别导致互作的主要变异来源，并对基因型的稳定性和特异适应性进行量化评估。[@problem_id:2820171]", "problem": "一个植物育种项目评估了三个基因型在三个环境下的谷物产量。设产量矩阵表示为 $Y \\in \\mathbb{R}^{3 \\times 3}$，其行由基因型 $\\{G_{1},G_{2},G_{3}\\}$ 索引，列由环境 $\\{E_{1},E_{2},E_{3}\\}$ 索引，单位为 $\\text{t ha}^{-1}$。观测到的小区平均值为\n$$\nY \\;=\\;\n\\begin{pmatrix}\n6.9 & 4.8 & 4.8 \\\\\n5.6 & 4.4 & 4.4 \\\\\n4.9 & 4.6 & 4.6\n\\end{pmatrix}.\n$$\n假设基因型-环境数据服从一个双因素固定效应模型，\n$$\nY_{ge} \\;=\\; \\mu \\;+\\; \\alpha_{g} \\;+\\; \\beta_{e} \\;+\\; (\\text{genotype} \\times \\text{environment})_{ge},\n$$\n其中 $\\mu$ 是总平均值，$\\alpha_{g}$ 是满足 $\\sum_{g}\\alpha_{g}=0$ 的基因型主效应，$\\beta_{e}$ 是满足 $\\sum_{e}\\beta_{e}=0$ 的环境主效应，并且基因型-环境互作效应满足常规双因素方差分析的约束条件，即互作矩阵的各行之和与各列之和均为 $0$。将所提供的小区平均值视为固定值（每个小区一个观测值）。\n\n按以下步骤进行：\n- 进行双因素方差分析分解，以获得拟合的加性部分 $\\mu+\\alpha_{g}+\\beta_{e}$ 和残差互作矩阵 $R \\in \\mathbb{R}^{3 \\times 3}$，其元素为 $R_{ge}=Y_{ge}-\\mu-\\alpha_{g}-\\beta_{e}$。\n- 通过奇异值分解 $R=U D V^{\\top}$ 对 $R$ 进行主成分分析，其中 $U \\in \\mathbb{R}^{3 \\times 3}$ 和 $V \\in \\mathbb{R}^{3 \\times 3}$ 的列是标准正交的，$D=\\operatorname{diag}(d_{1},d_{2},d_{3})$ 且 $d_{1}\\ge d_{2}\\ge d_{3}\\ge 0$ 是奇异值。\n- 在主效应加性和互作效应乘性（AMMI）框架中，将 AMMI1（第一互作主成分）基因型得分定义为行主成分得分的第一列，即由 $U D$ 的第一列给出的向量。\n\n使用此流程，计算基因型 $G_{1}$ 的 AMMI1 基因型得分。将你的最终答案以单个实数形式报告。将答案四舍五入到四位有效数字。无需单位。此外，在你的推理中，简要解释第一互作主成分的符号结构，并说明其在不同环境下基因型差异响应方面的意义。", "solution": "问题陈述具有科学依据，内容完整且定义明确。它描述了主效应加性和互作效应乘性（AMMI）模型的一个标准应用，这是一种在植物遗传学中使用的有效生物统计学方法。因此，我们可以直接进行求解。\n\n双因素固定效应模型由下式给出\n$$Y_{ge} \\;=\\; \\mu \\;+\\; \\alpha_{g} \\;+\\; \\beta_{e} \\;+\\; R_{ge}$$\n其中 $Y_{ge}$ 是观测产量，$\\mu$ 是总平均值，$\\alpha_{g}$ 是基因型主效应，$\\beta_{e}$ 是环境主效应，$R_{ge}$ 是基因型-环境互作残差。这些效应受限于和为零的约束条件 $\\sum_{g}\\alpha_{g}=0$ 和 $\\sum_{e}\\beta_{e}=0$。互作矩阵 $R$ 的元素为 $R_{ge}$，其行和与列和均为零。\n\n给定的产量矩阵为\n$$\nY \\;=\\;\n\\begin{pmatrix}\n6.9 & 4.8 & 4.8 \\\\\n5.6 & 4.4 & 4.4 \\\\\n4.9 & 4.6 & 4.6\n\\end{pmatrix}.\n$$\n\n第一步是进行双因素方差分析分解。\n总平均值 $\\mu$ 是所有 $3 \\times 3 = 9$ 个元素的平均值：\n$$\\mu = \\frac{1}{9} \\sum_{g=1}^{3} \\sum_{e=1}^{3} Y_{ge} = \\frac{45.0}{9} = 5.0$$\n\n基因型（行）平均值 $Y_{g.}$ 为：\n$$Y_{1.} = \\frac{6.9 + 4.8 + 4.8}{3} = \\frac{16.5}{3} = 5.5$$\n$$Y_{2.} = \\frac{5.6 + 4.4 + 4.4}{3} = \\frac{14.4}{3} = 4.8$$\n$$Y_{3.} = \\frac{4.9 + 4.6 + 4.6}{3} = \\frac{14.1}{3} = 4.7$$\n\n环境（列）平均值 $Y_{.e}$ 为：\n$$Y_{.1} = \\frac{6.9 + 5.6 + 4.9}{3} = \\frac{17.4}{3} = 5.8$$\n$$Y_{.2} = \\frac{4.8 + 4.4 + 4.6}{3} = \\frac{13.8}{3} = 4.6$$\n$$Y_{.3} = \\frac{4.8 + 4.4 + 4.6}{3} = \\frac{13.8}{3} = 4.6$$\n\n互作残差计算如下：$R_{ge} = Y_{ge} - (\\mu + \\alpha_g + \\beta_e) = Y_{ge} - Y_{g.} - Y_{.e} + \\mu$。\n$$R_{11} = 6.9 - 5.5 - 5.8 + 5.0 = 0.6$$\n$$R_{12} = 4.8 - 5.5 - 4.6 + 5.0 = -0.3$$\n$$R_{13} = 4.8 - 5.5 - 4.6 + 5.0 = -0.3$$\n$$R_{21} = 5.6 - 4.8 - 5.8 + 5.0 = 0.0$$\n$$R_{22} = 4.4 - 4.8 - 4.6 + 5.0 = 0.0$$\n$$R_{23} = 4.4 - 4.8 - 4.6 + 5.0 = 0.0$$\n$$R_{31} = 4.9 - 4.7 - 5.8 + 5.0 = -0.6$$\n$$R_{32} = 4.6 - 4.7 - 4.6 + 5.0 = 0.3$$\n$$R_{33} = 4.6 - 4.7 - 4.6 + 5.0 = 0.3$$\n\n互作残差矩阵 $R$ 为：\n$$\nR \\;=\\;\n\\begin{pmatrix}\n0.6 & -0.3 & -0.3 \\\\\n0 & 0 & 0 \\\\\n-0.6 & 0.3 & 0.3\n\\end{pmatrix}\n$$\n根据模型的约束条件，$R$ 的行和与列和均为零。\n\n第二步是通过奇异值分解 $R = U D V^{\\top}$ 对 $R$ 进行主成分分析。奇异值 $d_i$ 是 $R R^{\\top}$ 特征值的平方根。$U$ 的列是 $R R^{\\top}$ 对应的特征向量。\n$$\nR R^{\\top} =\n\\begin{pmatrix}\n0.6 & -0.3 & -0.3 \\\\\n0 & 0 & 0 \\\\\n-0.6 & 0.3 & 0.3\n\\end{pmatrix}\n\\begin{pmatrix}\n0.6 & 0 & -0.6 \\\\\n-0.3 & 0 & 0.3 \\\\\n-0.3 & 0 & 0.3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.54 & 0 & -0.54 \\\\\n0 & 0 & 0 \\\\\n-0.54 & 0 & 0.54\n\\end{pmatrix}\n$$\n这是一个秩-1矩阵，因此它只有一个非零特征值 $\\lambda_1$。特征值是特征方程 $\\det(R R^{\\top} - \\lambda I) = 0$ 的根。通过观察，或者因为迹是特征值之和，我们有 $\\lambda_1 = \\text{tr}(R R^{\\top}) = 0.54 + 0 + 0.54 = 1.08$。其他特征值为 $\\lambda_2 = \\lambda_3 = 0$。\n奇异值为 $d_i = \\sqrt{\\lambda_i}$，因此 $d_1 = \\sqrt{1.08}$ 且 $d_2 = d_3 = 0$。\n\n$U$ 的第一列，记作 $u_1$，是对应于 $\\lambda_1 = 1.08$ 的 $R R^{\\top}$ 的归一化特征向量：\n$$(R R^{\\top} - \\lambda_1 I) u_1 = 0 \\implies\n\\begin{pmatrix}\n0.54 - 1.08 & 0 & -0.54 \\\\\n0 & 0 - 1.08 & 0 \\\\\n-0.54 & 0 & 0.54 - 1.08\n\\end{pmatrix}\n\\begin{pmatrix} u_{11} \\\\ u_{21} \\\\ u_{31} \\end{pmatrix} =\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这给出了方程组 $-0.54 u_{11} - 0.54 u_{31} = 0 \\implies u_{11} = -u_{31}$ 和 $-1.08 u_{21} = 0 \\implies u_{21} = 0$。一个未归一化的特征向量是 $(1, 0, -1)^{\\top}$。归一化该向量可得：\n$$u_1 = \\frac{1}{\\sqrt{1^2 + 0^2 + (-1)^2}} \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 1/\\sqrt{2} \\\\ 0 \\\\ -1/\\sqrt{2} \\end{pmatrix}$$\n符号约定由关系式 $u_1 = (1/d_1)R v_1$ 确定，这证实了此符号选择的正确性。\n\n第三步是计算 AMMI1 基因型得分，定义为 $U D$ 的第一列。该向量为 $d_1 u_1$：\n$$d_1 u_1 = \\sqrt{1.08} \\begin{pmatrix} 1/\\sqrt{2} \\\\ 0 \\\\ -1/\\sqrt{2} \\end{pmatrix} = \\begin{pmatrix} \\sqrt{1.08/2} \\\\ 0 \\\\ -\\sqrt{1.08/2} \\end{pmatrix} = \\begin{pmatrix} \\sqrt{0.54} \\\\ 0 \\\\ -\\sqrt{0.54} \\end{pmatrix}$$\n基因型 $G_1$ 的 AMMI1 基因型得分是该向量的第一个元素。\n$$\\text{Score}(G_1) = \\sqrt{0.54} \\approx 0.7348469$$\n四舍五入到四位有效数字得到 $0.7348$。\n\n最后，我们解释第一互作主成分（IPC1）的符号结构。互作效应可近似为 $R_{ge} \\approx d_1 u_{g1} v_{e1}$。项 $d_1 u_{g1}$ 是第 $g$ 个基因型在 IPC1 上的基因型得分，$v_{e1}$ 是第 $e$ 个环境在 IPC1 上的环境得分。\n基因型得分为 $(\\sqrt{0.54}, 0, -\\sqrt{0.54})^{\\top}$。基因型 $G_1$ 的得分为正， $G_3$ 的得分为负，$G_2$ 的得分为零。\n第一个右奇异向量 $v_1$ 与 $(0.6, -0.3, -0.3)^{\\top}$ 成正比，因此环境 $E_1$ 的得分为正，而 $E_2$ 和 $E_3$ 的得分为负。\n对 $(G_g, E_e)$ 组合的互作效应与其得分的乘积成正比。\n- 对于 $G_1$：在 $E_1$ 中的乘积为正（正 $\\times$ 正），在 $E_2$ 和 $E_3$ 中为负（正 $\\times$ 负）。这意味着 $G_1$ 在 $E_1$ 中的表现优于其加性模型的预测，但在 $E_2$ 和 $E_3$ 中表现较差。\n- 对于 $G_3$：在 $E_1$ 中的乘积为负（负 $\\times$ 正），在 $E_2$ 和 $E_3$ 中为正（负 $\\times$ 负）。这意味着 $G_3$ 表现出与 $G_1$ 相反的响应模式。\n- 对于 $G_2$：得分为零，表明它是一个稳定的基因型，其跨环境的表现可以仅由加性模型很好地描述，沿此主轴没有表现出显著的互作效应。\n因此，符号结构区分了对环境具有不同特定适应性的基因型。", "answer": "$$\\boxed{0.7348}$$", "id": "2820171"}]}