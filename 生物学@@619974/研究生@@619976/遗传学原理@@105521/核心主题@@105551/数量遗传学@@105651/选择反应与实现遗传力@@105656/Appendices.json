{"hands_on_practices": [{"introduction": "在开始动手实践之前，我们首先需要从第一性原理出发，坚实地掌握选择反应背后的理论基础。本练习将指导你推导育种家方程 $R = h^2 S$，揭示表型、育种值和遗传力三者之间的内在联系。理解这一核心推导过程，是准确应用该方程解决更复杂问题的关键一步 [@problem_id:2831004]。", "problem": "一个大的随机交配群体正在对一个受多个基因座影响且主要为加性基因作用的数量性状进行混合选择。假设标准加性分解为 $P = A + E$，其中 $P$ 是表型，$A$ 是加性遗传值（育种值），$E$ 是环境偏差，且 $\\operatorname{Var}(P) = \\sigma_{P}^{2}$ 和 $\\operatorname{Var}(A) = \\sigma_{A}^{2}$。狭义遗传力定义为 $h^{2} = \\sigma_{A}^{2} / \\sigma_{P}^{2}$。选择差 $S$ 定义为被选亲本的平均表型与选择前群体平均表型之差，选择反应 $R$ 定义为子代群体平均表型与选择前群体平均表型之差。假设世代间没有系统性环境变化，亲本贡献相等，并且交配是随机的，因此传递的平均育种值等于被选亲本的平均育种值。\n\n仅使用这些基本定义和假设，首先推导连接预期单代选择反应 $R$、选择差 $S$ 和狭义遗传力 $h^{2}$ 的表达式。然后，根据可观测的量定义实现的狭义遗传力 $h^{2}_{R}$，并计算在一个混合选择实验第一代中的数值，其中观测到的选择差为 $S = 1.5$，观测到的选择反应为 $R = 0.6$。以精确小数形式提供你计算的 $h^{2}_{R}$ 的数值结果；无需四舍五入。最后，基于相同的基础理论，简要讨论实现的估计值 $h^{2}_{R}$ 是否与在相似环境条件下，从同一群体的线性混合模型中获得的独立基于系谱的估计值 $h^{2} = 0.4$ 相一致。你的最终数值答案必须只包含计算出的 $h^{2}_{R}$。", "solution": "问题陈述经审阅，确认有效。这是一个在数量遗传学领域定义明确的问题，基于标准的、有科学依据的原理和定义，并提供了所有必要信息。不存在矛盾、歧义或事实不准确之处。我们开始进行解答。\n\n该问题要求三部分内容：首先，推导选择反应（$R$）、选择差（$S$）和狭义遗传力（$h^{2}$）之间的关系；其次，根据实验数据计算实现的遗传力（$h_{R}^{2}$）；第三，讨论并将此实现值与基于系谱的估计值进行比较。\n\n让我们从正式推导开始。给定一个数量性状的表型模型：\n$$P = A + E$$\n其中 $P$ 是表型，$A$ 是加性遗传值（或育种值），$E$ 是环境偏差。群体均值分别表示为 $\\mu_{P}$、$\\mu_{A}$ 和 $\\mu_{E}$。不失一般性，我们可以将平均环境偏差设为零，即 $\\mu_{E} = 0$，因此 $\\mu_{P} = \\mu_{A}$。给定方差 $\\operatorname{Var}(P) = \\sigma_{P}^{2}$ 和 $\\operatorname{Var}(A) = \\sigma_{A}^{2}$，以及狭义遗传力的定义 $h^{2} = \\sigma_{A}^{2} / \\sigma_{P}^{2}$。我们假设育种值和环境偏差不相关，即 $\\operatorname{Cov}(A, E) = 0$。\n\n个体育种值 $A$ 与其表型 $P$ 之间的关系可以用 $A$ 对 $P$ 的线性回归来描述。该回归的斜率 $b_{A \\cdot P}$ 由下式给出：\n$$b_{A \\cdot P} = \\frac{\\operatorname{Cov}(A, P)}{\\operatorname{Var}(P)}$$\n我们可以展开协方差项：\n$$\\operatorname{Cov}(A, P) = \\operatorname{Cov}(A, A + E) = \\operatorname{Cov}(A, A) + \\operatorname{Cov}(A, E)$$\n由于 $\\operatorname{Cov}(A, A) = \\operatorname{Var}(A) = \\sigma_{A}^{2}$ 且假设 $\\operatorname{Cov}(A, E) = 0$，上式简化为：\n$$\\operatorname{Cov}(A, P) = \\sigma_{A}^{2}$$\n将此结果代回回归斜率的表达式中，得到：\n$$b_{A \\cdot P} = \\frac{\\sigma_{A}^{2}}{\\sigma_{P}^{2}} = h^{2}$$\n这证明了育种值对表型的回归等于狭义遗传力。该回归预测了在给定个体表型偏差的情况下，其育种值偏离群体均值的期望值：\n$$\\mathbb{E}[A - \\mu_{A} | P] = h^{2} (P - \\mu_{P})$$\n现在，考虑被选亲本群体。设其平均表型为 $\\mu_{P_{s}}$，平均育种值为 $\\mu_{A_{s}}$。选择差 $S$ 定义为被选亲本的平均表型与基础群体平均表型的偏差：\n$$S = \\mu_{P_{s}} - \\mu_{P}$$\n该被选群体的平均育种值与群体平均育种值的期望偏差，可以通过将回归应用于被选群体的平均表型来求得：\n$$\\mu_{A_{s}} - \\mu_{A} = h^{2} (\\mu_{P_{s}} - \\mu_{P}) = h^{2} S$$\n这个方程预测了被选作繁殖的亲本的平均育种值的变化。问题陈述中提到“交配是随机的，因此传递的平均育种值等于被选亲本的平均育种值”。这意味着子代的平均育种值 $\\mu_{A'}$ 等于被选亲本的平均育种值 $\\mu_{A_{s}}$。因此，从亲代到子代的平均育种值变化为：\n$$\\Delta\\mu_{A} = \\mu_{A'} - \\mu_{A} = \\mu_{A_{s}} - \\mu_{A} = h^{2} S$$\n选择反应 $R$ 定义为一代之内群体平均表型的变化：\n$$R = \\mu_{P'} - \\mu_{P}$$\n其中 $\\mu_{P'}$ 是子代的平均表型。我们可以写出 $\\mu_{P'} = \\mu_{A'} + \\mu_{E'}$。问题中“世代间没有系统性环境变化”的假设意味着 $\\mu_{E'} = \\mu_{E}$。由于我们已设定 $\\mu_{E} = 0$，因此 $\\mu_{E'} = 0$。于是，$\\mu_{P'} = \\mu_{A'}$。又因为 $\\mu_{P} = \\mu_{A}$，选择反应 $R$ 变为：\n$$R = \\mu_{A'} - \\mu_{A} = \\Delta\\mu_{A}$$\n综合我们的发现，我们得出了数量遗传学的基础方程，通常称为育种家方程：\n$$R = h^{2} S$$\n推导至此完成。\n\n接下来，我们定义并计算实现的狭义遗传力 $h^{2}_{R}$。当 $S$ 和 $R$ 是来自选择实验的观测值时，可以对该方程进行变形，以提供遗传力的估计值。这个估计值被称为实现的遗传力，因为它是根据观测到的选择反应计算出来的。\n$$h^{2}_{R} = \\frac{R}{S}$$\n问题提供了一个混合选择实验的观测值：选择差为 $S = 1.5$，选择反应为 $R = 0.6$。我们计算 $h^{2}_{R}$ 如下：\n$$h^{2}_{R} = \\frac{0.6}{1.5} = \\frac{6}{15} = \\frac{2}{5} = 0.4$$\n\n最后，我们被要求讨论这个实现的估计值 $h^{2}_{R} = 0.4$ 是否与一个独立的、基于系谱的估计值 $h^{2} = 0.4$ 相一致。这两个估计值在数值上完全相同。这代表了对该性状潜在遗传模型的一次强有力的一致性检验。实现的遗传力 $h^{2}_{R}$ 是通过选择反应与选择差的比值来衡量遗传力，使其成为进化过程的直接结果。相反，来自线性混合模型的基于系谱的估计值，则是通过群体中亲缘个体间的相似模式来推断遗传力，它根据系谱定义的已知协方差结构将表型方差划分为遗传和环境组分。这两种不同方法之间的完美一致表明，简单加性模型的几个主要假设在该群体中对该性状是成立的。具体来说，这意味着非加性遗传效应（显性与上位性）、基因型与环境的互作以及世代间的系统性环境趋势都是可以忽略不计的，因为这些因素中的任何一个都会导致预测的选择反应（基于系谱的 $h^2$）与观测到的选择反应（其定义了 $h^{2}_{R}$）之间出现差异。这种一致性证实了该性状对选择的反应与群体中存在的加性遗传方差所预测的完全一致。", "answer": "$$\\boxed{0.4}$$", "id": "2831004"}, {"introduction": "掌握了育种家方程的基本形式后，下一个关键是理解并量化方程中的选择差（$S$）。本练习将模拟一种常见的选择方法——截断选择，并要求你从群体分布的统计学特性出发，推导出选择差的具体数值。通过这个实践，你将学会如何将抽象的选择压力概念，转化为一个源于特定选择策略的可计算指标 [@problem_id:2846010]。", "problem": "一个大的随机交配群体表现出一个数量性状，该性状已被标准化，使得群体均值为 $0$，表型标准差为 $\\sigma_{P}=1$。通过仅保留这一代中表型值最高的 $5\\%$ 的个体作为育种者，实施定向截尾选择。假设表型呈正态分布，遗传结构在多个位点上是纯加性的，不存在基因型与环境的互作效应，且环境在各代之间保持稳定。已知狭义遗传力为 $h^{2}=0.3$。\n\n请仅使用核心定义和分布特性，从基本原理出发计算此截尾选择方案的选择差 $S$，然后以表型标准差为单位，确定预期的单代选择响应 $R$。仅报告 $R$ 的数值，并四舍五入至四位有效数字。", "solution": "所提出的问题是数量遗传学中的一个标准练习，其定义明确、科学上合理且内部一致。因此，该问题被认为是有效的，并将提供一个正式的解法。\n\n目标是计算一个数量性状的预期单代选择响应 $R$。在特定假设（加性遗传结构、稳定环境、无基因型-环境互作）下，控制此过程的基本方程是育种家方程：\n$$R = h^{2}S$$\n其中 $h^{2}$ 是狭义遗传力，$S$ 是选择差。我们已知 $h^{2} = 0.3$。主要任务是从基本原理出发计算 $S$。\n\n选择差 $S$ 定义为被选择个体的平均表型值 $\\mu_s$ 与选择前整个群体的平均表型值 $\\mu_P$ 之间的差值。\n$$S = \\mu_s - \\mu_P$$\n题目说明该性状已被标准化，使得群体均值为 $\\mu_P = 0$，表型标准差为 $\\sigma_P = 1$。因此，表型值 $P$ 服从标准正态分布，我们记为 $Z \\sim N(0, 1)$。$Z$ 的概率密度函数 (PDF) 为 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right)$。由于 $\\mu_P = 0$，选择差简化为 $S = \\mu_s$。\n\n选择程序是截尾选择，其中只有群体中顶部的 $p = 5\\% = 0.05$ 被保留用于育种。设 $T$ 代表截断阈值，它是将被选择群体与群体其余部分分开的表型值。该值 $T$ 由条件 $P(Z > T) = p$ 定义，或等效地，$\\int_{T}^{\\infty} \\phi(z) dz = p = 0.05$。\n\n被选择群体的平均表型 $\\mu_s$ 是在 $Z > T$ 的条件下表型 $Z$ 的条件期望。其计算公式为：\n$$\\mu_s = E[Z | Z > T] = \\frac{\\int_{T}^{\\infty} z \\cdot \\phi(z) dz}{P(Z > T)}$$\n分母已知为 $p = 0.05$。我们必须按要求从基本原理出发计算分子。\n$$ \\int_{T}^{\\infty} z \\cdot \\phi(z) dz = \\int_{T}^{\\infty} z \\cdot \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) dz $$\n该积分使用换元法 $u = -\\frac{z^2}{2}$ 进行计算。其微分为 $du = -z \\cdot dz$。积分限变换如下：当 $z \\to T$ 时，$u \\to -\\frac{T^2}{2}$；当 $z \\to \\infty$ 时，$u \\to -\\infty$。积分变为：\n$$ \\frac{1}{\\sqrt{2\\pi}} \\int_{-T^2/2}^{-\\infty} \\exp(u) (-du) = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{-T^2/2} \\exp(u) du $$\n$\\exp(u)$ 的原函数是 $\\exp(u)$。计算该定积分得到：\n$$ \\frac{1}{\\sqrt{2\\pi}} \\left[ \\exp(u) \\right]_{-\\infty}^{-T^2/2} = \\frac{1}{\\sqrt{2\\pi}} \\left( \\exp\\left(-\\frac{T^2}{2}\\right) - \\lim_{u\\to-\\infty} \\exp(u) \\right) $$\n由于 $\\lim_{u\\to-\\infty} \\exp(u) = 0$，结果为：\n$$ \\int_{T}^{\\infty} z \\cdot \\phi(z) dz = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{T^2}{2}\\right) = \\phi(T) $$\n因此，被选择群体的均值被证明为：\n$$ \\mu_s = \\frac{\\phi(T)}{p} $$\n且选择差为 $S = \\frac{\\phi(T)}{p}$。由于 $\\sigma_P = 1$，这个量 $S$ 也被称为选择强度 $i$。\n\n我们现在进行数值计算。\n首先，我们找到截断点 $T$，使得 $P(Z > T) = 0.05$。这等同于找到 $T$，使其累积分布函数 (CDF) 为 $\\Phi(T) = P(Z \\le T) = 1 - 0.05 = 0.95$。通过查询标准正态分布表或使用计算工具，我们得到该分位数的值：\n$$T \\approx 1.6448536$$\n接下来，我们计算在该点的概率密度函数 (PDF) 值 $\\phi(T)$：\n$$ \\phi(T) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(1.6448536)^2}{2}\\right) \\approx \\frac{1}{2.506628} \\exp\\left(-\\frac{2.70554}{2}\\right) \\approx 0.398942 \\exp(-1.35277) \\approx 0.1031356 $$\n现在，我们可以计算选择差 $S$：\n$$ S = \\frac{\\phi(T)}{p} \\approx \\frac{0.1031356}{0.05} \\approx 2.062712 $$\n该值的单位是表型标准差。由于 $\\sigma_P = 1$，$S$ 的数值为 $2.062712$。\n\n最后，我们使用育种家方程计算选择响应 $R$：\n$$ R = h^{2}S $$\n给定遗传力 $h^{2} = 0.3$，我们有：\n$$ R = 0.3 \\times 2.062712 \\approx 0.6188136 $$\n题目要求结果保留四位有效数字。将该值四舍五入后得到：\n$$ R \\approx 0.6188 $$\n该值表示下一代平均表型值的预期增量，以初始群体表型标准差为单位进行度量。", "answer": "$$\\boxed{0.6188}$$", "id": "2846010"}, {"introduction": "理论与现实在本章节的最后一个练习中交汇。我们将不再是利用育种家方程来预测选择反应，而是反过来用它来诊断为何观测到的反应与预期不符。这个解决问题的场景突显了一个核心概念：遗传力并非一个固定不变的生物学常数，而是对环境因素高度敏感的。通过本练习，你将学会如何利用“实现了的遗传力”这一工具，来量化那些隐藏在实验数据背后的环境变异 [@problem_id:1525837]。", "problem": "一个生物技术研究团队正在对一种酵母菌株 *Saccharomyces cerevisiae* 进行选择性育种计划，以增强其乙醇生产能力，用于生物燃料应用。被选择的数量性状是最大乙醇生产速率。\n\n初始未经选择的酵母菌落种群的平均生产速率为 $25.0$ mmol/hr/g。从该种群中，团队选择了表现最佳的菌落进行育种。这组被选出的亲本菌落的平均生产速率为 $35.0$ mmol/hr/g。通过将被选亲本随机交配产生的子代，其平均生产速率为 $27.0$ mmol/hr/g。这整个选择实验是在一个大型工业生物反应器中进行的。\n\n另外，在完美控制的理想实验室条件下，对初始酵母种群进行了详细的基因组和表型分析。这些分析确定，生产速率的加性遗传方差（$V_A$）为 $9.0$ (mmol/hr/g)$^2$，而在这些理想条件下的总表型方差（$V_P$）为 $25.0$ (mmol/hr/g)$^2$。\n\n工业生物反应器中增加的环境异质性（例如，温度和营养物可用性的梯度）引入了一个在理想实验室条件下不存在的额外环境方差来源。假设在两种环境中加性遗传方差相同，并且任何基因-环境互作效应都可忽略不计。\n\n计算在工业生物反应器中发现的这个额外环境方差分量的大小。答案以 (mmol/hr/g)$^2$ 为单位，并保留三位有效数字。", "solution": "该问题要求计算工业生物反应器中相较于理想实验室条件的额外环境方差（$V_{E, \\text{extra}}$）。我们可以通过应用数量遗传学原理来解决这个问题，特别是育种家方程和表型方差的分解。\n\n首先，让我们根据工业生物反应器实验提供的数据，定义并计算选择差（$S$）和选择响应（$R$）。\n\n选择差（$S$）是被选亲本的平均值（$\\mu_S$）与原始种群的平均值（$\\mu_0$）之间的差值。\n$$S = \\mu_S - \\mu_0$$\n给定 $\\mu_S = 35.0$ mmol/hr/g 且 $\\mu_0 = 25.0$ mmol/hr/g：\n$$S = 35.0 \\text{ mmol/hr/g} - 25.0 \\text{ mmol/hr/g} = 10.0 \\text{ mmol/hr/g}$$\n\n选择响应（$R$）是子代平均值（$\\mu_1$）与原始种群平均值（$\\mu_0$）之间的差值。\n$$R = \\mu_1 - \\mu_0$$\n给定 $\\mu_1 = 27.0$ mmol/hr/g 且 $\\mu_0 = 25.0$ mmol/hr/g：\n$$R = 27.0 \\text{ mmol/hr/g} - 25.0 \\text{ mmol/hr/g} = 2.0 \\text{ mmol/hr/g}$$\n\n育种家方程将选择响应、选择差和狭义遗传力（$h^2$）联系起来：\n$$R = h^2 S$$\n我们可以使用生物反应器实验中观测到的 $R$ 和 $S$ 来计算在该特定环境下的*实现*狭义遗传力（$h^2_{\\text{realized}}$）。\n$$h^2_{\\text{realized}} = \\frac{R}{S} = \\frac{2.0 \\text{ mmol/hr/g}}{10.0 \\text{ mmol/hr/g}} = 0.20$$\n\n狭义遗传力也定义为加性遗传方差（$V_A$）与总表型方差（$V_P$）的比率。在生物反应器的背景下，即为：\n$$h^2_{\\text{realized}} = \\frac{V_A}{V_{P, \\text{bioreactor}}}$$\n题目指出 $V_A$ 是该酵母菌株的一个恒定属性，给定为 $V_A = 9.0$ (mmol/hr/g)$^2$。我们现在可以计算生物反应器中的总表型方差 $V_{P, \\text{bioreactor}}$。\n$$V_{P, \\text{bioreactor}} = \\frac{V_A}{h^2_{\\text{realized}}} = \\frac{9.0 \\text{ (mmol/hr/g)}^2}{0.20} = 45.0 \\text{ (mmol/hr/g)}^2$$\n\n总表型方差（$V_P$）是遗传方差（$V_G$）和环境方差（$V_E$）之和，前提是假设没有基因-环境互作。由于我们处理的是狭义遗传力，我们使用加性遗传方差 $V_A$。\n$$V_P = V_A + V_E$$\n题目指出，生物反应器中的环境方差 $V_{E, \\text{bioreactor}}$ 由理想条件下的环境方差 $V_{E, \\text{ideal}}$ 加上一个额外分量 $V_{E, \\text{extra}}$ 组成。\n$$V_{E, \\text{bioreactor}} = V_{E, \\text{ideal}} + V_{E, \\text{extra}}$$\n因此，生物反应器中的总表型方差可以写成：\n$$V_{P, \\text{bioreactor}} = V_A + V_{E, \\text{ideal}} + V_{E, \\text{extra}}$$\n\n$V_A + V_{E, \\text{ideal}}$ 这一项就是理想实验室条件下的总表型方差 $V_{P, \\text{ideal}}$。\n$$V_{P, \\text{ideal}} = V_A + V_{E, \\text{ideal}}$$\n题目给出了这个值：$V_{P, \\text{ideal}} = 25.0$ (mmol/hr/g)$^2$。\n\n所以，我们可以将其代回到我们关于生物反应器表型方差的方程中：\n$$V_{P, \\text{bioreactor}} = V_{P, \\text{ideal}} + V_{E, \\text{extra}}$$\n我们被要求解出 $V_{E, \\text{extra}}$。重新整理方程得到：\n$$V_{E, \\text{extra}} = V_{P, \\text{bioreactor}} - V_{P, \\text{ideal}}$$\n代入我们已计算和已给出的数值：\n$$V_{E, \\text{extra}} = 45.0 \\text{ (mmol/hr/g)}^2 - 25.0 \\text{ (mmol/hr/g)}^2 = 20.0 \\text{ (mmol/hr/g)}^2$$\n\n额外的环境方差分量是 $20.0$ (mmol/hr/g)$^2$。该值已经给出，并保留了三位有效数字。", "answer": "$$\\boxed{20.0}$$", "id": "1525837"}]}