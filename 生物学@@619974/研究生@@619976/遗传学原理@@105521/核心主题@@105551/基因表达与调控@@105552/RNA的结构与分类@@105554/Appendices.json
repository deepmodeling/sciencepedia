{"hands_on_practices": [{"introduction": "RNA二级结构（如发夹环）的稳定性是其功能的关键决定因素。我们可以使用热力学模型来量化这种稳定性，例如广泛使用的最近邻模型。本练习提供了应用该模型可加性原理的基础实践，使您能够计算给定发夹环结构的折叠自由能（$\\Delta G$），这是RNA生物物理学中的一项基石技能。[@problem_id:2848597]", "problem": "在温度 $37^{\\circ}\\mathrm{C}$ 下，一个较长的核糖核酸 (RNA) 分子中的一段信使核糖核酸 (mRNA) 片段内部形成了一个分子内发夹结构。折叠的局部序列为\n5'-GCGC AAAUU CGCG-3'，\n该序列形成一个发夹结构，包含一个由$5$个核苷酸组成的环（序列为 AAAUU）和一个由$4$个碱基对组成的 Watson–Crick 茎区，其中 $5'$臂为 GCGC，3'臂为其反向互补序列 CGCG。假设不存在非经典配对、悬垂末端和三级相互作用。\n\n使用 RNA 二级结构在 $37^{\\circ}\\mathrm{C}$ 下的热力学最近邻加和模型，其中折叠自由能变化 $\\Delta G_{37}$ 是以下各项之和：\n- 茎区中每对相邻碱基对的堆积贡献，使用以下 Watson–Crick 最近邻自由能（单位：kcal/mol）：\n  - GC/CG: $\\Delta G_{37} = -3.40$\n  - CG/GC: $\\Delta G_{37} = -2.40$\n- 发夹环起始罚分，仅取决于环的长度（单位：kcal/mol）：\n  - 环长度 $5$: $\\Delta G_{37} = +5.60$\n- 螺旋外部末端的末端罚分，适用于每个末端 AU 或 GU 碱基对（单位：kcal/mol）：\n  - 螺旋末端的 AU 或 GU：每个此类末端对 $\\Delta G_{37} = +0.45$\n  - 螺旋末端的 GC：$\\Delta G_{37} = 0.00$\n\n无其他额外奖励或罚分。\n\n计算此发夹结构的总折叠自由能变化 $\\Delta G_{37}$（单位：kcal/mol）。将您的答案四舍五入至三位有效数字。以 kcal/mol 为单位表示最终能量。", "solution": "问题陈述已经过验证，被认为是具有科学依据、提法恰当且内部一致的。它呈现了一个基于已建立的核糖核酸 (RNA) 二级结构最近邻模型的标准生物物理计算。所有必需的参数均已提供。\n\n目标是计算形成一个特定分子内发夹结构的总折叠自由能变化 $\\Delta G_{37}$。根据所提供的热力学最近邻加和模型，总自由能变化是碱基对堆积、环起始和末端罚分的贡献之和。\n控制方程是：\n$$\n\\Delta G_{37, \\text{total}} = \\Delta G_{\\text{stacking}} + \\Delta G_{\\text{loop}} + \\Delta G_{\\text{terminal}}\n$$\n\n首先，我们必须仔细剖析由序列 $5'$-GCGC AAAUU CGCG-$3'$ 形成的发夹结构。问题陈述指出，该序列形成一个具有4个碱基对的茎区和5个核苷酸的环。茎区的 5'臂是序列 $5'$-GCGC-$3'$，3'臂是其反向互补序列 $5'$-CGCG-$3'$。在完整序列 $5'$-G$_1$C$_2$G$_3$C$_4$A$_5$A$_6$A$_7$U$_8$U$_9$C$_{10}$G$_{11}$C$_{12}$G$_{13}$-$3'$ 中，这对应于 5'端片段 G$_1$C$_2$G$_3$C$_4$ 与 3'端片段 C$_{10}$G$_{11}$C$_{12}$G$_{13}$ 的配对。具体来说，Watson-Crick 碱基对是 G$_1$-C$_{13}$、C$_2$-G$_{12}$、G$_3$-C$_{11}$ 和 C$_4$-G$_{10}$。配对片段之间的核苷酸 A$_5$A$_6$A$_7$U$_8$U$_9$ 形成了这个5个核苷酸的环。\n\n在结构确定之后，我们计算每个能量贡献。\n\n$1$. $\\Delta G_{\\text{stacking}}$：堆积自由能是茎区中相邻碱基对贡献的总和。存在 $n-1 = 4-1 = 3$ 个这样的堆积相互作用。我们从螺旋的外部末端向环的方向识别它们：\n- 第一个堆积发生在 G$_1$-C$_{13}$ 对和 C$_2$-G$_{12}$ 对之间。这对应于一条链上的 $5'$-GC-$3'$ 二核苷酸堆积在另一条链上的 $3'$-CG-$5'$ 二核苷酸之上。这是一个 GC/CG 堆积。提供的自由能为 $\\Delta G_{37}(\\text{GC/CG}) = -3.40~\\mathrm{kcal/mol}$。\n- 第二个堆积发生在 C$_2$-G$_{12}$ 对和 G$_3$-C$_{11}$ 对之间。这对应于一条链上的 $5'$-CG-$3'$ 二核苷酸堆积在另一条链上的 $3'$-GC-$5'$ 二核苷酸之上。这是一个 CG/GC 堆积。提供的自由能为 $\\Delta G_{37}(\\text{CG/GC}) = -2.40~\\mathrm{kcal/mol}$。\n- 第三个堆积发生在 G$_3$-C$_{11}$ 对和 C$_4$-G$_{10}$ 对之间。这对应于一条链上的 $5'$-GC-$3'$ 二核苷酸堆积在另一条链上的 $3'$-CG-$5'$ 二核苷酸之上。这是另一个 GC/CG 堆积。提供的自由能为 $\\Delta G_{37}(\\text{GC/CG}) = -3.40~\\mathrm{kcal/mol}$。\n\n总堆积自由能是这些贡献的总和：\n$$\n\\Delta G_{\\text{stacking}} = (-3.40) + (-2.40) + (-3.40) = -9.20~\\mathrm{kcal/mol}\n$$\n\n$2$. $\\Delta G_{\\text{loop}}$：发夹环起始罚分取决于环的长度。该环由5个核苷酸（A$_5$A$_6$A$_7$U$_8$U$_9$）组成。问题指定了长度为5的环的罚分：\n$$\n\\Delta G_{\\text{loop}} = +5.60~\\mathrm{kcal/mol}\n$$\n\n$3$. $\\Delta G_{\\text{terminal}}$：对螺旋外部末端的末端 AU 或 GU 对施加罚分。此发夹茎区的外部末端是 G$_1$-C$_{13}$ 碱基对。由于这是一个 GC 对，指定的罚分为零。\n$$\n\\Delta G_{\\text{terminal}} = 0.00~\\mathrm{kcal/mol}\n$$\n\n最后，我们将这些组分相加以求出发夹形成的总自由能变化：\n$$\n\\Delta G_{37, \\text{total}} = \\Delta G_{\\text{stacking}} + \\Delta G_{\\text{loop}} + \\Delta G_{\\text{terminal}}\n$$\n$$\n\\Delta G_{37, \\text{total}} = (-9.20) + (5.60) + (0.00) = -3.60~\\mathrm{kcal/mol}\n$$\n结果 $-3.60$ 已按要求用三位有效数字表示。ΔG₃₇ 的负值表明，在指定条件下，此发夹结构的形成是自发的。", "answer": "$$ \\boxed{-3.60} $$", "id": "2848597"}, {"introduction": "虽然前一个练习涉及已知结构，但生物信息学的一个核心目标是从一级序列预测分子的折叠结构。这个计算实践将指导您实现一个动态规划算法，以找到RNA的最小自由能（MFE）结构。您将整合现代实验SHAPE数据作为伪能量项，这反映了当代结合计算和实验以实现更准确预测的研究方法。[@problem_id:2848657]", "problem": "您需要实现一个程序，该程序将选择性2'-羟基酰化引物延伸分析 (Selective 2’-Hydroxyl Acylation analyzed by Primer Extension, SHAPE) 的反应性整合到一个简化的RNA二级结构预测热力学模型中，并在无假结（no-pseudoknot）约束下计算最小自由能 (minimum free energy, MFE) 结构。您的实现必须仅依赖于以下核心定义和广泛接受的规则：\n\n- 分子生物学的中心法则和核糖核酸 (RNA) 结构原则指出，单链RNA通过分子内碱基配对折叠成二级结构，该结构受互补相互作用和空间可行性的限制。\n- 标准的 Watson–Crick 碱基对遵循 $\\mathrm{A}\\text{-}\\mathrm{U}$ 和 $\\mathrm{G}\\text{-}\\mathrm{C}$ 互补原则；摆动碱基对 $\\mathrm{G}\\text{-}\\mathrm{U}$ 是允许的。这些碱基对有成熟的热力学观测数据支持。\n- SHAPE反应性与核苷酸的柔性存在经验上的关联。一种常见的方法是将反应性整合到一个伪自由能项中，该项对高反应性位置的配对进行惩罚。对于位置 $i$ 的每个核苷酸，定义其配对时的伪自由能为\n$$\n\\Delta G_{\\mathrm{SHAPE}}(i) = m \\cdot r_i + b,\n$$\n其中 $r_i$ 是SHAPE反应性，$m$ 是斜率，$b$ 是截距。能量单位为 $\\mathrm{kcal/mol}$。\n\n您必须使用以下简化的、明确的热力学模型：\n\n- 允许的碱基对及其碱基对能量 $E_{\\mathrm{bp}}$（单位 $\\mathrm{kcal/mol}$）：\n  - $\\mathrm{A}\\text{-}\\mathrm{U}$ 和 $\\mathrm{U}\\text{-}\\mathrm{A}$：$-2.0$，\n  - $\\mathrm{G}\\text{-}\\mathrm{C}$ 和 $\\mathrm{C}\\text{-}\\mathrm{G}$：$-3.0$，\n  - $\\mathrm{G}\\text{-}\\mathrm{U}$ 和 $\\mathrm{U}\\text{-}\\mathrm{G}$：$-1.0$。\n- 发夹环长度约束：仅当 $j - i - 1 \\ge L$ (其中 $L = 3$) 时，一对 $(i,j)$ 才能形成。\n- 不允许出现假结。\n- 能量可加性：一个有效的二级结构的总自由能是所有已形成碱基对的能量之和\n$$\nE_{\\text{pair}}(i,j) = E_{\\mathrm{bp}}(\\text{pair}(i,j)) + \\Delta G_{\\mathrm{SHAPE}}(i) + \\Delta G_{\\mathrm{SHAPE}}(j),\n$$\n未配对的核苷酸贡献的能量为 $0$。能量以 $\\mathrm{kcal/mol}$ 表示。\n- 目标：在上述约束下最小化总自由能。\n\n需要实现的动态规划规范：\n\n- 设 $n$ 为序列长度。对于包含两端索引的子序列，定义 $E[i,j]$ 为在区间 $[i,j]$ 上可达到的最小能量，其中 $0 \\le i \\le j \\le n-1$。\n- 边界条件：当 $i \\ge j$ 时，$E[i,j] = 0$。\n- $i < j$ 的递推关系：\n  - 不配对选项：\n    - 使 $i$ 不配对：$E[i,j] \\leftarrow \\min\\left(E[i,j], E[i+1,j]\\right)$，\n    - 使 $j$ 不配对：$E[i,j] \\leftarrow \\min\\left(E[i,j], E[i,j-1]\\right)$。\n  - 如果允许，则进行配对的选项：如果位置 $(i,j)$ 处的核苷酸可以形成允许的配对，并且 $j - i - 1 \\ge L$，则\n    $$\n    E[i,j] \\leftarrow \\min\\left(E[i,j], E[i+1,j-1] + E_{\\mathrm{bp}}(i,j) + \\Delta G_{\\mathrm{SHAPE}}(i) + \\Delta G_{\\mathrm{SHAPE}}(j)\\right).\n    $$\n  - 对 $k$ 进行分支（串联），其中 $i \\le k < j$：\n    $$\n    E[i,j] \\leftarrow \\min\\left(E[i,j], E[i,k] + E[k+1,j]\\right).\n    $$\n\n回溯过程必须重构一个与最小能量一致的最优结构。该结构表示为一个长度为 $n$ 的列表，其中索引 $p$ 处的元素是与位置 $p+1$ 配对的核苷酸的基于1的索引。如果位置 $p+1$ 未配对，则在索引 $p$ 处存储 $0$。例如，对于 $n=4$ 且配对为 $(1,4)$、未配对为 $(2,3)$ 的结构，其表示为 $[4,0,0,1]$。\n\n角度单位不适用。能量必须按规定以 $\\mathrm{kcal/mol}$ 为单位进行解释。然而，输出是整数形式的配对伙伴索引表示，因此是无单位的。\n\n在程序内部实现的测试套件（无用户输入）。对于每个案例，使用给定的RNA序列、SHAPE反应性 $r_i$ 和 $(m,b)$：\n\n- 案例 1（通用正常路径）：\n  - 序列：\"GCGAAUUGCGCU\"。\n  - 反应性： $[0.10, 0.20, 0.15, 1.20, 1.00, 0.90, 0.85, 1.10, 0.25, 0.15, 0.20, 0.10]$。\n  - 参数：$m = 1.8$，$b = -0.6$。\n- 案例 2（边界情况：所有反应性为零，负截距强烈倾向于配对）：\n  - 序列：\"AUGCUAGC\"。\n  - 反应性：$[0,0,0,0,0,0,0,0]$。\n  - 参数：$m = 1.8$，$b = -0.6$。\n- 案例 3（边缘情况：由于A的同聚物，没有允许的配对）：\n  - 序列：\"AAAAAA\"。\n  - 反应性：$[0.5, 0.7, 0.9, 0.1, 0.2, 0.3]$。\n  - 参数：$m = 1.0$，$b = 0.0$。\n- 案例 4（边缘情况：序列太短，无法满足 $L=3$ 的发夹环约束）：\n  - 序列：\"GCUG\"。\n  - 反应性：$[0.9, 0.2, 1.1, 0.3]$。\n  - 参数：$m = 1.8$，$b = -0.6$。\n\n最终输出格式：\n\n- 对于每个测试用例，计算MFE配对伙伴索引整数列表（长度为 $n$），其中配对伙伴使用基于1的索引，未配对位置使用 $0$。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表中的每个结果本身也是一个由方括号括起来的整数列表。例如：\"[[4,0,0,1],[...],[...],[...]]\"。", "solution": "问题陈述经评估有效。它描述了生物信息学中一个简化的、但有科学依据的计算问题：预测一个能使伪自由能函数最小化的RNA二级结构。该模型整合了经验性的SHAPE数据（一种标准技术），并依赖于一个明确定义的动态规划方法，在无假结约束下寻找最小自由能（MFE）结构。该问题是适定的、客观的，并包含了计算唯一解所需的所有信息。\n\n解决方案的核心是基于 Nussinov-Jacobson 或 Zuker 算法原理的动态规划算法。设 $n$ 为RNA序列的长度。我们将 $E[i,j]$ 定义为从索引 $i$ 到 $j$（含两端）的子序列的最小自由能，其中 $0 \\le i \\le j < n$。目标是计算 $E[0, n-1]$。\n\n提供的递推关系为：\n$$\nE[i,j] = \\min \\begin{cases}\nE[i+1, j] \\\\\nE[i, j-1] \\\\\nE[i+1, j-1] + E_{\\text{pair}}(i,j) \\\\\n\\min_{i \\le k < j} (E[i,k] + E[k+1,j])\n\\end{cases}\n$$\n一项批判性分析表明，前两项（代表两端未配对的核苷酸）是冗余的。分支项 $\\min_{i \\le k < j} (E[i,k] + E[k+1,j])$ 内在地包含了这些情况。具体来说，当 $k=i$ 时，该项变为 $E[i,i] + E[i+1,j]$。由于 $E[i,i]=0$（空子序列的能量），这简化为 $E[i+1,j]$，即核苷酸 $i$ 不配对的情况。类似地，当 $k=j-1$ 时，该项变为 $E[i,j-1] + E[j,j] = E[i,j-1]$，覆盖了 $j$ 不配对的情况。\n\n因此，为了实现更高效、更优雅的实现，该递推关系被合并为针对区间 $[i,j]$ 上结构的两种基本情况：\n1.  核苷酸 $i$ 和 $j$ 形成一个碱基对。这仅在它们是互补的（$\\mathrm{A}\\text{-}\\mathrm{U}$、$\\mathrm{G}\\text{-}\\mathrm{C}$ 或 $\\mathrm{G}\\text{-}\\mathrm{U}$）并且满足最小环长度约束 $j - i - 1 \\ge L$（其中 $L=3$）时才可能。其能量是内在碱基对能量、两个核苷酸的源自SHAPE的伪能量以及被包含子序列 $[i+1,j-1]$ 的MFE之和。\n    $$ E_{1} = E[i+1, j-1] + E_{\\mathrm{bp}}(i,j) + \\Delta G_{\\mathrm{SHAPE}}(i) + \\Delta G_{\\mathrm{SHAPE}}(j) $$\n2.  $[i,j]$ 上的结构是 $[i,k]$ 和 $[k+1,j]$ 上两个独立子结构的串联，其中 $k$ 是某个分割点，满足 $i \\le k < j$。总能量是两个子结构能量之和。算法必须找到使该和最小化的分割点 $k$。\n    $$ E_{2} = \\min_{i \\le k < j} (E[i,k] + E[k+1,j]) $$\n\n最终能量 $E[i,j]$ 是这些可能性的最小值：$E[i,j] = \\min(E_1, E_2)$，其中 $E_1$ 仅在允许配对时才被考虑。\n\n算法流程如下：\n首先，对序列中的每个核苷酸 $p$, 预先计算其SHAPE伪自由能贡献 $\\Delta G_{\\mathrm{SHAPE}}(p) = m \\cdot r_p + b$。\n\n初始化一个大小为 $n \\times n$ 的二维矩阵 $E$。基本情况为对于所有 $i \\ge j$，$E[i,j] = 0$。该矩阵按子序列长度 $d=j-i$ 从 $d=1$ 到 $d=n-1$ 递增的顺序填充。这确保了在计算 $E[i,j]$ 时，其所依赖的所有更小子序列的能量都已被计算。\n\n为了重构最优结构，使用第二个相同维度的矩阵 `trace`。`trace`$[i,j]$ 存储导致 $E[i,j]$ 取得最小值的选择。一个特殊值（例如 $-1$）表示最小值是通过 $(i,j)$ 配对实现的。否则，`trace`$[i,j]$ 存储分支情况下的最优分割点 $k$。\n\n在 $E$ 和 `trace` 矩阵被完全填充后，从 `backtrack(0, n-1)` 开始启动一个递归回溯函数。该函数遍历 `trace` 矩阵以重建构成MFE结构之一的碱基对集合。如果 `trace`$[i,j]$ 指示一个配对，则记录配对 $(i,j)$，并函数在被包含的区间 `backtrack(i+1, j-1)` 上递归调用。如果它指示在 $k$ 处发生分支，则函数在两个独立的子区间 `backtrack(i, k)` 和 `backtrack(k+1, j)` 上递归调用。\n\n最终结果存储在一个长度为 $n$ 的数组中，其中每个位置存放其配对伙伴的基于1的索引，如果未配对则存放 $0$。此过程被系统地应用于每个提供的测试用例。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the specified test cases for RNA MFE structure prediction.\n    \"\"\"\n    test_cases = [\n        (\"GCGAAUUGCGCU\", [0.10, 0.20, 0.15, 1.20, 1.00, 0.90, 0.85, 1.10, 0.25, 0.15, 0.20, 0.10], (1.8, -0.6)),\n        (\"AUGCUAGC\", [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], (1.8, -0.6)),\n        (\"AAAAAA\", [0.5, 0.7, 0.9, 0.1, 0.2, 0.3], (1.0, 0.0)),\n        (\"GCUG\", [0.9, 0.2, 1.1, 0.3], (1.8, -0.6)),\n    ]\n\n    results = []\n    for case in test_cases:\n        seq, reactivities, params = case\n        result = compute_mfe_structure(seq, reactivities, params)\n        results.append(result)\n\n    def list_to_str(lst):\n        return f\"[{','.join(map(str, lst))}]\"\n\n    formatted_results = ','.join(map(list_to_str, results))\n    print(f\"[{formatted_results}]\")\n\ndef compute_mfe_structure(sequence, reactivities, params):\n    \"\"\"\n    Computes the Minimum Free Energy (MFE) secondary structure of an RNA sequence\n    using a simplified thermodynamic model with SHAPE data.\n    \"\"\"\n    n = len(sequence)\n    m, b = params\n    L = 3  # Minimum hairpin loop length\n\n    base_pair_energies = {\n        frozenset({'A', 'U'}): -2.0,\n        frozenset({'G', 'C'}): -3.0,\n        frozenset({'G', 'U'}): -1.0,\n    }\n\n    def can_pair(b1, b2):\n        return frozenset({b1, b2}) in base_pair_energies\n\n    def get_pair_energy(b1, b2):\n        return base_pair_energies.get(frozenset({b1, b2}), float('inf'))\n\n    delta_g_shape = np.array([m * r + b for r in reactivities])\n\n    E = np.full((n, n), float('inf'))\n    trace = np.zeros((n, n), dtype=int)\n\n    for i in range(n):\n        E[i, i] = 0\n    for i in range(n - 1):\n        E[i + 1, i] = 0\n\n    for d in range(1, n):  # d = j - i\n        for i in range(n - d):\n            j = i + d\n\n            # Option 1: Bifurcation (covers unpaired ends via k=i or k=j-1)\n            min_bifurcation_energy = float('inf')\n            best_k = -1\n            for k in range(i, j):\n                energy = E[i, k] + E[k + 1, j]\n                if energy < min_bifurcation_energy:\n                    min_bifurcation_energy = energy\n                    best_k = k\n            \n            E[i, j] = min_bifurcation_energy\n            trace[i, j] = best_k\n\n            # Option 2: Nucleotides i and j form a pair\n            if can_pair(sequence[i], sequence[j]) and j - i - 1 >= L:\n                pair_energy_term = get_pair_energy(sequence[i], sequence[j]) \\\n                                 + delta_g_shape[i] + delta_g_shape[j]\n                \n                total_pair_energy = E[i + 1, j - 1] + pair_energy_term\n                \n                if total_pair_energy < E[i, j]:\n                    E[i, j] = total_pair_energy\n                    trace[i, j] = -1  # Special value indicates pairing\n\n    partners = [0] * n\n    \n    # Using a stack for non-recursive backtracking to avoid recursion depth limits\n    # on potentially long sequences, though not an issue for these test cases.\n    stack = [(0, n - 1)]\n    while stack:\n        i, j = stack.pop()\n        \n        if i >= j:\n            continue\n            \n        trace_val = trace[i, j]\n        \n        if trace_val == -1:  # (i, j) form a pair\n            partners[i] = j + 1\n            partners[j] = i + 1\n            stack.append((i + 1, j - 1))\n        else:  # Bifurcation at k\n            k = trace_val\n            stack.append((i, k))\n            stack.append((k + 1, j))\n\n    return partners\n\nsolve()\n```", "id": "2848657"}, {"introduction": "除了结构，RNA分子还是复杂调控网络的核心参与者，并受到严格的质量控制。本练习深入探讨了无义介导的降解（NMD）途径，这是真核生物中一种至关重要的监视机制。您将从基本原理出发，构建一个定量模型，将基因的外显子-内含子结构与过早翻译终止后其mRNA被降解的概率联系起来，从而展示生物学逻辑如何能够被数学化地描述和检验。[@problem_id:2848618]", "problem": "真核生物中的信使核糖核酸（mRNA）通过转录和剪接产生。外显子连接后，外显子连接复合物（Exon Junction Complexes, EJCs）会沉积在每个外显子-外显子连接处上游的一个特征性距离处。在翻译的先驱轮（pioneer round of translation）中，核糖体会移除其经过的EJC。无义介导的mRNA降解（Nonsense-Mediated Decay, NMD）是一种依赖翻译的质量控制途径。当翻译提前终止，且下游至少有一个EJC与终止核糖体的距离足够远，以致于能使终止监视复合物（通常称为SURF复合物，包含Up-frameshift protein 1 (UPF1)和真核生物释放因子 (eRF1 and eRF3)）与EJC（通过UPF2和UPF3）发生有效相互作用，而不是被正常终止密码子附近的聚腺苷酸结合蛋白细胞质1（Poly(A)-Binding Protein Cytoplasmic 1 (PABPC1)）所抑制时，NMD途径就会被触发。\n\n假设以下有经验证据支持的特征和简化条件：\n- EJC正好沉积在每个外显子-外显子连接处上游$e$个核苷酸的位置，并被任何穿过它们的翻译核糖体移除。\n- 当且仅当，在提前终止位置$x$（从起始密码子沿编码序列测量的核苷酸位置），存在至少一个下游EJC，其位置在$x$下游至少$s$个核苷酸处时，NMD被触发。忽略不依赖EJC的NMD以及除此标准之外的三撇非翻译区长度的任何影响。\n- 给定编码序列中发生无义突变的条件下，其位置$x$在区间$\\left[0, L\\right)$上服从均匀分布，其中$L$是编码序列的长度（以核苷酸计）。\n\n考虑一个mRNA，其编码序列包含$E=4$个外显子，从起始密码子开始，其长度分别为$l_{1}=300$、$l_{2}=600$、$l_{3}=450$和$l_{4}=654$个核苷酸。设EJC的沉积偏移量为每个连接处上游$e=24$个核苷酸，触发NMD所需的最小间隔为$s=50$个核苷酸。设$L=\\sum_{i=1}^{E} l_{i}$。\n\n从中心法则（脱氧核糖核酸到核糖核酸到蛋白质）、剪接耦合的EJC沉积的定义、核糖体介导的EJC移除的定义，以及NMD作为在存在足够远下游EJC情况下终止翻译的定义出发，完成以下任务：\n1. 从上述第一性原理出发，推导一个关于$x$的条件，该条件根据下游EJC的位置来确定NMD是否被触发。证明该条件可以简化为仅涉及最后一个外显子-外显子连接处沉积的EJC的单个不等式。\n2. 使用该条件，推导一个闭式表达式，用于计算一个均匀随机的提前终止（如上定义）触发NMD的概率，该表达式是关于$\\{l_{i}\\}_{i=1}^{E}$、$e$、$s$和$L$的函数。\n3. 针对指定的外显子-内含子结构和参数，对该概率进行数值计算。将最终数值答案四舍五入至四位有效数字，并以区间$\\left[0,1\\right]$内的小数形式表示。", "solution": "所提出的问题是分子生物学中的一个定量练习，其基础是基因表达和RNA监视的既定机制，特别是无义介导的mRNA降解（Nonsense-Mediated Decay, NMD）。该问题是自洽的，在其定义的模型内具有科学合理性，并且在数学上是适定的。它要求将基础概率论应用于一个简化但现实的生物学场景。因此，该问题是有效的，我们继续进行严格的推导。\n\n首先，我们为信使核糖核酸（mRNA）的编码序列（coding sequence, CDS）建立一个坐标系。设起始密码子对应于位置$0$，CDS的末端位于位置$L$。提前终止密码子（premature termination codon, PTC）的位置，用$x$表示，是区间$\\left[0, L\\right)$内的一个点。CDS的总长度是其$E$个外显子长度的总和：\n$$L = \\sum_{i=1}^{E} l_{i}$$\n\n该转录本有$E-1$个外显子-外显子连接处。第$k$个连接处的位置$P_{J_k}$，它分隔了外显子$k$和外显子$k+1$，位于前面所有外显子累积长度处：\n$$P_{J_k} = \\sum_{i=1}^{k} l_{i}$$\n其中 $k \\in \\{1, 2, \\dots, E-1\\}$。\n\n根据问题陈述，外显子连接复合物（Exon Junction Complex, EJC）沉积在每个连接处上游距离$e$的位置。因此，与第$k$个连接处相关的EJC的位置$P_{\\text{EJC}_k}$是：\n$$P_{\\text{EJC}_k} = P_{J_k} - e = \\left(\\sum_{i=1}^{k} l_{i}\\right) - e$$\n\n如果核糖体在位置$x$的PTC处终止翻译，并且下游至少有一个EJC与终止位点距离足够远，NMD途径就会被触发。在翻译过程中，核糖体会移除其经过的所有EJC。因此，对于位置$x$处的PTC，剩余的EJC集合是那些满足$P_{\\text{EJC}_k} > x$的EJC。NMD触发的条件是，对于这些剩余的EJC中的至少一个，其与PTC的距离必须至少为$s$。这可以表述如下：\n当且仅当存在一个$k \\in \\{1, 2, \\dots, E-1\\}$，使得以下两个条件都满足时，NMD被触发：\n1. EJC位于PTC的下游：$P_{\\text{EJC}_k} > x$。\n2. EJC与PTC之间的间隔足够大：$P_{\\text{EJC}_k} - x \\ge s$。\n\n第二个条件，$x \\le P_{\\text{EJC}_k} - s$，更具限制性，并且在$s > 0$的情况下蕴含了第一个条件。因为$s=50$，所以情况确实如此。因此，NMD触发的总体条件简化为存在一个索引$k$，使得：\n$$x \\le P_{\\text{EJC}_k} - s$$\n\n这意味着，如果PTC位置$x$小于或等于集合$\\{P_{\\text{EJC}_1} - s, P_{\\text{EJC}_2} - s, \\dots, P_{\\text{EJC}_{E-1}} - s\\}$中的至少一个值，NMD就会被触发。这是一个逻辑或（OR）条件。如果一个数小于或等于一个集合中的至少一个值，那么它必定小于或等于该集合中的最大值。因此，该条件等价于：\n$$x \\le \\max_{k \\in \\{1, \\dots, E-1\\}} \\left( P_{\\text{EJC}_k} - s \\right)$$\n\n外显子长度$l_i$均为正数。因此，连接处位置$P_{J_k}$随$k$的增加而严格递增。这意味着EJC位置$P_{\\text{EJC}_k} = P_{J_k} - e$也随$k$的增加而严格递增。因此，集合中的最大值对应于最大的索引，即$k = E-1$。这是在最后一个外显子-外显子连接处沉积的EJC。NMD触发的条件简化为单个不等式：\n$$x \\le P_{\\text{EJC}_{E-1}} - s$$\n这完成了推导的第一部分。PTC必须出现在最终EJC上游$s$个核苷酸的位置或更早的位置。\n\n对于第二部分，我们推导NMD概率的闭式表达式。PTC的位置$x$是一个在区间$\\left[0, L\\right)$上均匀分布的随机变量。对于均匀分布，一个事件的概率是“有利区域”的长度与总样本空间长度的比值。\n\n有利区域由所有触发NMD的$x$位置组成。这是满足$x \\le P_{\\text{EJC}_{E-1}} - s$的$x$值区间。因为$x$不能为负（因为它是一个位置），所以NMD敏感区域是$\\left[0, x_{\\text{NMD}}\\right]$，其中：\n$$x_{\\text{NMD}} = P_{\\text{EJC}_{E-1}} - s = \\left(\\left(\\sum_{i=1}^{E-1} l_i\\right) - e\\right) - s$$\n这个有利区域的长度是$x_{\\text{NMD}}$。总样本空间的长度是$L$。因此，概率$P(\\text{NMD})$是：\n$$P(\\text{NMD}) = \\frac{x_{\\text{NMD}}}{L} = \\frac{\\left(\\sum_{i=1}^{E-1} l_i\\right) - e - s}{L}$$\n代入 $L = \\sum_{i=1}^{E} l_i$，我们得到闭式表达式：\n$$P(\\text{NMD}) = \\frac{\\left(\\sum_{i=1}^{E-1} l_i\\right) - e - s}{\\sum_{i=1}^{E} l_i}$$\n该表达式是关于外显子长度$\\{l_i\\}$、EJC偏移量$e$、NMD分离距离$s$和总CDS长度$L$（其依赖于$\\{l_i\\}$）的函数。这完成了第二部分。\n\n对于第三部分，我们使用给定的数值来评估这个概率：\n$E=4$，$l_1=300$，$l_2=600$，$l_3=450$，$l_4=654$。\n$e=24$。\n$s=50$。\n\n首先，我们计算前$E-1=3$个外显子长度的总和：\n$$\\sum_{i=1}^{3} l_i = l_1 + l_2 + l_3 = 300 + 600 + 450 = 1350$$\n这对应于最后一个连接处的位置$P_{J_3}$。最终EJC的位置是$P_{\\text{EJC}_3} = 1350 - e = 1350 - 24 = 1326$。触发NMD的PTC的位置上限是$x_{\\text{NMD}} = P_{\\text{EJC}_3} - s = 1326 - 50 = 1276$。因此，区间$\\left[0, 1276\\right]$内的任何PTC都将触发NMD。\n\n接下来，我们计算总CDS长度，$L$：\n$$L = \\sum_{i=1}^{4} l_i = (l_1+l_2+l_3) + l_4 = 1350 + 654 = 2004$$\n\n该概率是NMD敏感区域长度与总CDS长度的比值：\n$$P(\\text{NMD}) = \\frac{x_{\\text{NMD}}}{L} = \\frac{1276}{2004}$$\n\n现在，我们计算数值并四舍五入到四位有效数字：\n$$P(\\text{NMD}) = \\frac{1276}{2004} \\approx 0.6367265469...$$\n四舍五入到四位有效数字得到$0.6367$。这表示在这个特定基因的编码序列中随机发生的无义突变，导致其mRNA通过NMD途径降解的概率。", "answer": "$$ \\boxed{0.6367} $$", "id": "2848618"}]}