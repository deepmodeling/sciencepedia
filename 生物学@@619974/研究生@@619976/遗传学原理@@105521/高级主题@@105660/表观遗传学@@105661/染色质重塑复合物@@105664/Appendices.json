{"hands_on_practices": [{"introduction": "染色质重塑复合物不仅能够移动核小体，还能将它们组织成有序的阵列，这对基因调控至关重要。本练习通过一个关于ISWI家族重塑复合物的思想实验，探讨其不同亚基如何协同工作，特别是其独特的“DNA尺子”机制在建立规则的核小体间距中所起的关键作用。通过分析一个特定突变的影响，你将深入理解这些分子机器的精巧设计原理。[@problem_id:1475072]", "problem": "模拟开关 (ISWI) 家族染色质重塑复合物通过将核小体组织成均匀间隔的阵列，在真核生物基因调控中起着至关重要的作用。一个典型的ISWI复合物通过其催化性ATPase亚基利用三磷酸腺苷 (ATP) 水解产生的能量，使核小体沿DNA滑动。其间隔功能由一种“DNA尺”机制调控，该机制至少依赖于两种相互作用：复合物与核小体核心组蛋白八聚体的结合，以及一个非催化亚基上的特化结构域对相邻的核小体外（连接）DNA长度的感知。\n\n考虑一个*体外*染色质组装实验。将一个长的线性DNA分子与足量的纯化组蛋白八聚体和ATP一起孵育，导致核小体沿DNA随机沉积。随后，向该体系中加入纯化的ISWI型重塑复合物。\n\n您正在比较该复合物的两个版本：\n1.  **野生型 (WT) 复合物：** 一个功能完备的ISWI复合物。\n2.  **突变型 (MUT) 复合物：** 该复合物在一个非催化亚基上含有一个突变，该突变完全消除了其结合或感知核小体外连接DNA的能力。然而，其ATPase活性以及与核小体核心颗粒直接结合的能力完全不受影响。\n\n假设两个实验都进行至平衡状态，下列哪个陈述最能描述使用MUT复合物的实验中，DNA分子上核小体的最终排列方式？\n\nA. 核小体将会存在，但排列成无序、不规则的模式，且连接DNA的长度高度可变。\n\nB. 核小体滑动将被完全抑制，核小体将固定在其最初的随机沉积位点。\n\nC. 核小体将被迫进入一种超浓缩状态，紧密堆积在一起，其间的连接DNA长度极短或为零。\n\nD. MUT复合物的功能将与WT复合物完全相同，从而形成一个规则间隔的核小体阵列。\n\nE. MUT复合物将导致组蛋白八聚体从DNA上解离，从而形成裸露DNA的状态。", "solution": "首先，回顾ISWI依赖的核小体间隔的机理基础。野生型复合物通过耦合两种相互作用来实现规则的间隔：(i) 通过其ATPase亚基与核小体核心颗粒结合，该亚基使DNA围绕组蛋白八聚体发生移位，从而滑动核小体；以及 (ii) 通过一个非催化亚基实现对核小体外连接DNA长度的感知，该亚基实现了一种“DNA尺”功能。“DNA尺”使滑动产生偏向，从而让连接DNA的长度趋近于一个优选值，在平衡时产生均匀间隔的阵列。\n\n现在分析突变型复合物。根据问题陈述，该突变体保留了ATPase活性和核小体核心结合能力，但完全丧失了结合或感知核小体外连接DNA的能力。因此，强制形成规则间隔的关键偏向组件——“DNA尺”——缺失了。没有了连接DNA的感知，剩余的ATP驱动的滑动无法被导向以均等化连接DNA的长度。相反，在间隔方面，滑动变得实际上不受调控，产生的移动并未与间隔目标相耦合。\n\n在平衡状态下，当缺乏间隔偏向且存在核小体间的空间排斥时，系统不会收敛到一个规则间隔的阵列。相反，它将在受排除体积约束的条件下对核小体滑动相容的各种构象进行采样，从而导致一种连接DNA长度可变的无序排列。因为ATPase活性和核小体结合能力完好无损，所以滑动并未被废除，因此核小体不会固定在其初始沉积位点。此外，在此背景下，ISWI没有机理基础来驱逐核小体或使连接DNA超浓缩至零长度：ISWI复合物通常不是驱逐组蛋白的重塑因子，并且“尺”的丧失并不会施加一种压缩偏向以将连接DNA的长度压缩到超越空间位阻极限。\n\n因此：\n- 选项A与保留滑动能力但丧失间隔偏向的情况相符。\n- 选项B不正确，因为在有活性的ATPase和核小体结合能力的情况下，滑动仍然是可能的。\n- 选项C不正确，因为没有定向力来将连接DNA压缩到最小长度，并且空间约束阻止了零长度间隔的出现。\n- 选项D不正确，因为丧失连接DNA的感知能力消除了关键的间隔功能。\n- 选项E不正确，因为在这些条件下，ISWI缺乏驱逐组蛋白八聚体所需的活性。\n\n因此，该突变体导致了核小体排列无序、不规则，且连接DNA长度高度可变。", "answer": "$$\\boxed{A}$$", "id": "1475072"}, {"introduction": "在基因激活过程中，染色质重塑复合物是移走还是推开阻碍性的核小体？这是一个核心的机制性问题。本练习将让你扮演一名分子生物学家的角色，设计并解读一项关键实验来回答这个问题。你将学习如何利用染色质免疫共沉淀测序（ChIP-seq）技术，根据其在诱导前后产生的不同信号模式，明确区分核小体“滑移”与“驱逐”这两种不同的作用方式。[@problem_id:1475093]", "problem": "一位分子生物学家正在研究一种新发现的 ATP 依赖性染色质重塑复合物的作用机制，他们将其命名为“激活剂招募复合物”（Activator Recruitment Complex, ARC）。已知 ARC 对于一个特异性诱导基因 `GeneZ` 在响应激素信号时被激活至关重要。`GeneZ` 的启动子区域的特征是有一个位置固定的核小体 Nuc-P，它直接遮蔽了一个关键转录因子的结合位点。在激素刺激下，ARC 招募到 `GeneZ` 启动子是转录起始的先决条件。\n\n有两种相互竞争的假说描述 ARC 在该启动子上的功能：\n1.  **驱逐假说（The Eviction Hypothesis）**：ARC 将 Nuc-P 组蛋白八聚体从 DNA 上完全移除，从而暴露转录因子结合位点。\n2.  **滑动假说（The Sliding Hypothesis）**：ARC 沿 DNA 推送 Nuc-P 核小体到一个新的位置，在不使组蛋白八聚体从 DNA 分子上脱离的情况下揭示出结合位点。\n\n为区分这两种假说，研究人员使用一种针对核心组蛋白 H3 的高亲和性抗体，进行了染色质免疫沉淀后测序（ChIP-seq）。该实验在用激素处理30分钟之前（未诱导状态）和之后（诱导状态）的细胞培养物上进行。将所得数据绘制成以 `GeneZ` 启动子为中心的测序读数深度相对于基因组位置的函数图。在未诱导状态下，H3 ChIP-seq 数据显示一个与 Nuc-P 位置相对应的单一尖锐峰。\n\n以下哪种来自诱导细胞样本的 H3 ChIP-seq 数据潜在结果，能为滑动假说提供最明确的支持？\n\nA. 对应于 Nuc-P 的 H3 ChIP-seq 峰完全消失，并且启动子 1000 个碱基对范围内没有出现新的 H3 峰。\n\nB. 对应于 Nuc-P 的 H3 ChIP-seq 峰的高度降低了约 90%，而其位置保持不变。\n\nC. 对应于 Nuc-P 的 H3 ChIP-seq 峰消失，并且一个总信号强度相似的、新的、清晰的 H3 ChIP-seq 峰出现在原始峰位置下游 150 个碱基对的中心位置。\n\nD. 与未诱导状态相比，对应于 Nuc-P 的 H3 ChIP-seq 峰在位置和强度上都保持不变。\n\nE. 对应于 Nuc-P 的单一 H3 ChIP-seq 峰被分布在整个启动子区域的几个小的、宽的峰所取代。", "solution": "将 $S_{\\text{H3}}(x)$ 定义为组蛋白 H3 的 ChIP-seq 读数深度信号，作为以启动子为中心的基因组坐标 $x$ 的函数。在未诱导状态下，位于 $x_{0}$ 处的一个单一尖锐峰反映了在转录因子位点之上位置固定的核小体 Nuc-P。\n\n根据驱逐假说，ARC 移除了 Nuc-P 处的组蛋白八聚体。预测的结果是在 $x_{0}$ 处 H3 信号丢失，且附近没有补偿性增加；在一个局部启动子窗口 $W$ 内，积分信号减少：\n$$\n\\int_{W} S_{\\text{H3}}^{\\text{induced}}(x)\\,dx \\ll \\int_{W} S_{\\text{H3}}^{\\text{uninduced}}(x)\\,dx,\n$$\n且启动子附近没有出现新的清晰峰。\n\n根据滑动假说，ARC 沿着同一段 DNA 重新定位 Nuc-P，但并不使其脱离。预测的结果是 H3 峰从 $x_{0}$ 移动到一个新位置 $x_{1}$，原始峰消失，并在 $x_{1}$ 处出现一个新的清晰峰。因为组蛋白八聚体仍然结合在启动子区域内，$W$ 内的积分信号大致守恒：\n$$\n\\int_{W} S_{\\text{H3}}^{\\text{induced}}(x)\\,dx \\approx \\int_{W} S_{\\text{H3}}^{\\text{uninduced}}(x)\\,dx,\n$$\n并且新峰的总面积（通常其高度和形状也）与原始峰相似，仅仅是平移了一段与核小体重新定位相符的距离。\n\n评估各个选项：\nA 显示峰消失且附近没有新峰，这与驱逐相符，而非滑动。\nB 显示在相同位置峰的减弱，这与部分驱逐或占据率降低相符，而非平移重新定位。\nC 显示原始峰消失，并在下游约一个核小体足迹的位置出现一个总信号强度相似的、新的、清晰的 H3 峰，这是滑动的明确标志，表明启动子区域中的 H3 占据是守恒的。\nD 显示没有变化，意味着没有发生重塑。\nE 显示弥散的、多个小峰，这是不明确的（可能反映了核小体位置模糊化、部分驱逐或混合的重新定位），而非一个清晰的单一滑动事件。\n\n因此，为滑动假说提供最明确支持的是选项 C 中描述的结果。", "answer": "$$\\boxed{C}$$", "id": "1475093"}, {"introduction": "从单基因研究到全基因组分析是现代遗传学的标志性转变。要全面理解一个染色质重塑复合物（如SWI/SNF）的功能，我们必须在全基因组尺度上识别其直接调控的靶点。本练习提供了一个实践性的计算生物学任务，你将整合多种高通量测序数据（如 ATAC-seq 和 ChIP-seq），通过编写程序来量化染色质状态的变化，并最终推断出 BRG1 重塑复合物的直接作用靶点。[@problem_id:2796621]", "problem": "您将获得一个简化的、自洽的定量框架，用于整合使用测序的转座酶可及性染色质分析 (ATAC-seq)、组蛋白H3赖氨酸27乙酰化 (H3K27ac) 染色质免疫共沉淀测序 (ChIP-seq) 以及 Brahma相关基因1 (BRG1，也称为SMARCA4) 的占有数据，以在BRG1耗尽后推断SWI/SNF染色质重塑复合物的直接增强子靶标。请设计一个程序，该程序基于以下基本原理实现一种原则性分析：\n\n- 活跃的增强子以染色质可及性和组蛋白乙酰化为标志。增强子处的ATAC-seq读数计数近似于其可及性。增强子处的H3K27ac ChIP-seq计数近似于其乙酰化水平。\n- 像BRG1这样的染色质重塑因子直接调节核小体定位，从而影响增强子的可及性和活性。预计耗尽BRG1主要会在其直接结合的位点降低增强子的可及性和活性。\n- 为量化变化，请使用由正伪计数稳定的测序计数的对数比率。为量化在一组增强子中BRG1占有与增强子变化之间的关联，请使用皮尔逊相关系数。\n\n需要实现的定义：\n\n- 对于索引为 $i$ 的增强子，设 $C^{A}_i$ 和 $D^{A}_i$ 分别表示在对照和BRG1耗尽条件下的ATAC-seq计数。设 $C^{H}_i$ 和 $D^{H}_i$ 分别表示在对照和BRG1耗尽条件下的H3K27ac ChIP-seq计数。设 $O_i$ 表示在对照条件下的BRG1占有分数（例如，ChIP-seq信号或峰强度）。\n- 给定一个正伪计数 $p$，定义可及性的以2为底的对数倍数变化为\n$$\n\\Delta^A_i = \\log_2\\!\\left(\\frac{D^{A}_i + p}{C^{A}_i + p}\\right),\n$$\n以及乙酰化的以2为底的对数倍数变化为\n$$\n\\Delta^H_i = \\log_2\\!\\left(\\frac{D^{H}_i + p}{C^{H}_i + p}\\right).\n$$\n- 定义两个等长（$n \\ge 2$）向量 $\\mathbf{x}=(x_i)$ 和 $\\mathbf{y}=(y_i)$ 之间的皮尔逊相关系数为\n$$\nr(\\mathbf{x},\\mathbf{y}) = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\left(\\sum_{i=1}^{n} (x_i - \\bar{x})^2\\right)\\left(\\sum_{i=1}^{n} (y_i - \\bar{y})^2\\right)}},\n$$\n其中 $\\bar{x}$ 和 $\\bar{y}$ 是算术平均值。如果分母为零（即任一向量的方差为零），则按惯例定义 $r(\\mathbf{x},\\mathbf{y}) = 0$。\n- 通过使用以下规则进行阈值化，推断一组推定的BRG1直接靶标：一个增强子 $i$ 被称为直接靶标，当且仅当\n$$\nO_i \\ge \\tau_{\\mathrm{occ}}, \\quad \\Delta^A_i \\le -\\tau_{A}, \\quad \\Delta^H_i \\le -\\tau_{H},\n$$\n其中 $\\tau_{\\mathrm{occ}} > 0$、$\\tau_{A} > 0$ 和 $\\tau_{H} > 0$ 是用户指定的阈值。\n\n您的程序必须精确实现上述定义，并为每个测试用例计算以下输出：\n- $\\{O_i\\}$ 和 $\\{\\Delta^A_i\\}$ 之间的皮尔逊相关系数，四舍五入到三位小数。\n- $\\{O_i\\}$ 和 $\\{\\Delta^H_i\\}$ 之间的皮尔逊相关系数，四舍五入到三位小数。\n- 推断出的直接靶标的数量（一个整数）。\n- 推断出的直接靶标的从零开始的索引列表，按升序排列。\n\n边界情况处理：\n- 所有对数均以2为底。\n- 使用提供的伪计数 $p$ 以避免除以零。\n- 如果皮尔逊相关中的任一向量的方差为零，则该相关性返回 $0$。\n\n测试套件：\n提供一个硬编码并评估以下三个独立测试用例的程序。对于每个测试用例 $t \\in \\{1,2,3\\}$，输入包括用于 $C^{A}$、$D^{A}$、$C^{H}$、$D^{H}$、$O$ 的数组，以及标量 $p$、$\\tau_{\\mathrm{occ}}$、$\\tau_A$、$\\tau_H$。数组按增强子索引对齐，并且必须视为从零开始索引。\n\n- 测试用例1（一般情况）：\n  - $C^{A} = [180, 240, 95, 160, 210, 130, 75, 300]$\n  - $D^{A} = [90, 200, 70, 120, 140, 110, 60, 260]$\n  - $C^{H} = [1500, 2200, 800, 1200, 2400, 900, 700, 2600]$\n  - $D^{H} = [900, 1800, 700, 900, 1900, 850, 650, 2100]$\n  - $O = [5.2, 7.8, 2.1, 6.0, 8.5, 3.5, 1.0, 9.0]$\n  - $p = 1.0$, $\\tau_{\\mathrm{occ}} = 6.0$, $\\tau_{A} = 0.3$, $\\tau_{H} = 0.25$\n\n- 测试用例2（零值和阈值临界值的边界条件）：\n  - $C^{A} = [0, 50, 100, 0]$\n  - $D^{A} = [0, 25, 200, 0]$\n  - $C^{H} = [0, 400, 800, 0]$\n  - $D^{H} = [0, 200, 1200, 0]$\n  - $O = [6.0, 6.0, 5.9, 10.0]$\n  - $p = 0.5$, $\\tau_{\\mathrm{occ}} = 6.0$, $\\tau_{A} = 0.5$, $\\tau_{H} = 0.5$\n\n- 测试用例3（无变化的边界情况）：\n  - $C^{A} = [100, 100, 100, 100]$\n  - $D^{A} = [100, 100, 100, 100]$\n  - $C^{H} = [1000, 1000, 1000, 1000]$\n  - $D^{H} = [1000, 1000, 1000, 1000]$\n  - $O = [3.0, 3.0, 3.0, 3.0]$\n  - $p = 1.0$, $\\tau_{\\mathrm{occ}} = 5.0$, $\\tau_{A} = 0.1$, $\\tau_{H} = 0.1$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果本身必须是 $[\\text{corr\\_ATAC}, \\text{corr\\_H3K27ac}, \\text{n\\_direct}, \\text{direct\\_indices}]$ 形式的列表，其中 $\\text{corr\\_ATAC}$ 和 $\\text{corr\\_H3K27ac}$ 是四舍五入到三位小数的浮点数，$\\text{n\\_direct}$ 是一个整数，而 $\\text{direct\\_indices}$ 是一个整数列表。具体来说，您的输出必须如下所示\n$[[r^A_1, r^H_1, n_1, [\\dots]], [r^A_2, r^H_2, n_2, [\\dots]], [r^A_3, r^H_3, n_3, [\\dots]]]$\n包含为上述测试套件计算的值，且不含任何额外文本。", "solution": "问题陈述已经过严格评估，被认为是有效的。它在科学上基于染色质生物学的原理，在数学上是适定的，并且没有任何歧义、矛盾或事实上的不健全之处。该问题为表观基因组数据的简化分析提供了一个清晰的定量框架，这是计算生物学中的一项常见任务。因此，我们将着手推导解决方案。\n\n目标是使用多模态测序数据分析一组推定的增强子，以推断BRG1染色质重塑因子的直接靶标。这是通过为每个提供的测试用例实施一系列精确的计算步骤来完成的。\n\n方法论的结构如下：\n\n1.  **计算对数倍数变化**：对于每个索引为 $i$ 的增强子，量化了在BRG1耗尽后染色质可及性和组蛋白乙酰化的变化。我们给出了以2为底的对数倍数变化公式：\n    -   可及性变化：$\\Delta^A_i = \\log_2\\!\\left(\\frac{D^{A}_i + p}{C^{A}_i + p}\\right)$\n    -   乙酰化变化：$\\Delta^H_i = \\log_2\\!\\left(\\frac{D^{H}_i + p}{C^{H}_i + p}\\right)$\n\n    在此，$C^{A}_i$ 和 $C^{H}_i$ 分别是对照条件下的ATAC-seq和H3K27ac ChIP-seq计数。$D^{A}_i$ 和 $D^{H}_i$ 是BRG1耗尽条件下的相应计数。一个正伪计数 $p$ 被添加到每一项以稳定比率，防止除以零并减轻低计数值时噪声的影响。这些计算产生两个向量，$\\mathbf{\\Delta}^A = \\{\\Delta^A_i\\}$ 和 $\\mathbf{\\Delta}^H = \\{\\Delta^H_i\\}$，表示每个增强子对BRG1耗尽的响应。\n\n2.  **计算皮尔逊相关系数**：我们必须量化增强子上的BRG1占有与观察到的可及性和乙酰化变化之间的关联。这是通过使用皮尔逊相关系数 $r$ 来实现的。我们计算两个这样的系数：\n    -   $r(\\mathbf{O}, \\mathbf{\\Delta}^A)$：BRG1占有向量 $\\mathbf{O} = \\{O_i\\}$ 与可及性变化向量 $\\mathbf{\\Delta}^A$ 之间的相关性。\n    -   $r(\\mathbf{O}, \\mathbf{\\Delta}^H)$：BRG1占有向量 $\\mathbf{O}$ 与乙酰化变化向量 $\\mathbf{\\Delta}^H$ 之间的相关性。\n\n    两个长度为 $n$ 的向量 $\\mathbf{x}$ 和 $\\mathbf{y}$ 之间的皮尔逊相关系数公式为：\n    $$\n    r(\\mathbf{x},\\mathbf{y}) = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\left(\\sum_{i=1}^{n} (x_i - \\bar{x})^2\\right)\\left(\\sum_{i=1}^{n} (y_i - \\bar{y})^2\\right)}}\n    $$\n    其中 $\\bar{x}$ 和 $\\bar{y}$ 是样本均值。根据问题的明确指示，如果 $\\mathbf{x}$ 或 $\\mathbf{y}$ 的方差为零（导致分母为零），则相关性 $r(\\mathbf{x},\\mathbf{y})$ 定义为 $0$。最终值必须四舍五入到三位小数。\n\n3.  **识别直接靶标**：提供了一组标准来将增强子分类为“直接靶标”。该分类基于以下前提：BRG1的直接靶标应具有高BRG1占有，并在BRG1耗尽后表现出可及性和乙酰化的显著降低。一个增强子 $i$ 被分类为直接靶标，当且仅当满足以下所有三个条件：\n    $$\n    O_i \\ge \\tau_{\\mathrm{occ}}, \\quad \\Delta^A_i \\le -\\tau_{A}, \\quad \\Delta^H_i \\le -\\tau_{H}\n    $$\n    其中 $\\tau_{\\mathrm{occ}}$、$\\tau_A$ 和 $\\tau_H$ 分别是给定的占有、可及性降低和乙酰化降低的正阈值。请注意，降低对应于负的对数倍数变化，因此有条件 $\\Delta^A_i \\le -\\tau_{A}$ 和 $\\Delta^H_i \\le -\\tau_{H}$。\n\n4.  **组合结果**：对于每个测试用例，最终输出被编译成一个包含四个元素的列表：\n    -   计算出的相关性 $r(\\mathbf{O}, \\mathbf{\\Delta}^A)$，已四舍五入。\n    -   计算出的相关性 $r(\\mathbf{O}, \\mathbf{\\Delta}^H)$，已四舍五入。\n    -   被识别为直接靶标的增强子总数，一个整数。\n    -   这些直接靶标的从零开始的索引列表，按升序排序。\n\n该实现将对三个指定的测试用例中的每一个应用此系列操作，以生成最终的格式化输出。使用矢量化操作（例如由`NumPy`等库提供）是实现这些计算的最有效和最直接的方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the chromatin remodeling analysis problem for the three given test cases.\n    \"\"\"\n    \n    test_cases = [\n        {\n            \"C_A\": [180, 240, 95, 160, 210, 130, 75, 300],\n            \"D_A\": [90, 200, 70, 120, 140, 110, 60, 260],\n            \"C_H\": [1500, 2200, 800, 1200, 2400, 900, 700, 2600],\n            \"D_H\": [900, 1800, 700, 900, 1900, 850, 650, 2100],\n            \"O\": [5.2, 7.8, 2.1, 6.0, 8.5, 3.5, 1.0, 9.0],\n            \"p\": 1.0, \"tau_occ\": 6.0, \"tau_A\": 0.3, \"tau_H\": 0.25\n        },\n        {\n            \"C_A\": [0, 50, 100, 0],\n            \"D_A\": [0, 25, 200, 0],\n            \"C_H\": [0, 400, 800, 0],\n            \"D_H\": [0, 200, 1200, 0],\n            \"O\": [6.0, 6.0, 5.9, 10.0],\n            \"p\": 0.5, \"tau_occ\": 6.0, \"tau_A\": 0.5, \"tau_H\": 0.5\n        },\n        {\n            \"C_A\": [100, 100, 100, 100],\n            \"D_A\": [100, 100, 100, 100],\n            \"C_H\": [1000, 1000, 1000, 1000],\n            \"D_H\": [1000, 1000, 1000, 1000],\n            \"O\": [3.0, 3.0, 3.0, 3.0],\n            \"p\": 1.0, \"tau_occ\": 5.0, \"tau_A\": 0.1, \"tau_H\": 0.1\n        }\n    ]\n\n    def calculate_pearson_r(x, y):\n        \"\"\"\n        Calculates the Pearson correlation coefficient. Returns 0 if variance of either input is 0.\n        \"\"\"\n        if x.std() == 0 or y.std() == 0:\n            return 0.0\n        return np.corrcoef(x, y)[0, 1]\n\n    results = []\n    for case in test_cases:\n        # Convert lists to numpy arrays for vectorized operations\n        C_A = np.array(case[\"C_A\"])\n        D_A = np.array(case[\"D_A\"])\n        C_H = np.array(case[\"C_H\"])\n        D_H = np.array(case[\"D_H\"])\n        O = np.array(case[\"O\"])\n        p = case[\"p\"]\n        tau_occ = case[\"tau_occ\"]\n        tau_A = case[\"tau_A\"]\n        tau_H = case[\"tau_H\"]\n\n        # Step 1: Calculate log fold-changes\n        delta_A = np.log2((D_A + p) / (C_A + p))\n        delta_H = np.log2((D_H + p) / (C_H + p))\n\n        # Step 2: Calculate Pearson correlation coefficients\n        corr_ATAC = calculate_pearson_r(O, delta_A)\n        corr_H3K27ac = calculate_pearson_r(O, delta_H)\n\n        # Round to three decimal places\n        corr_ATAC_rounded = round(corr_ATAC, 3)\n        corr_H3K27ac_rounded = round(corr_H3K27ac, 3)\n\n        # Step 3: Identify direct targets\n        target_indices = np.where(\n            (O >= tau_occ) & \n            (delta_A <= -tau_A) & \n            (delta_H <= -tau_H)\n        )[0]\n        \n        n_direct = len(target_indices)\n        direct_indices_list = target_indices.tolist()\n\n        # Step 4: Assemble results for the case\n        case_result = [\n            corr_ATAC_rounded,\n            corr_H3K27ac_rounded,\n            n_direct,\n            direct_indices_list\n        ]\n        results.append(case_result)\n\n    # Format the final output string to remove spaces for compact representation\n    # e.g., '[1, 2, [3, 4]]' -> '[1,2,[3,4]]'\n    final_output_str = f\"[{','.join(str(item).replace(' ', '') for item in results)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```", "id": "2796621"}]}