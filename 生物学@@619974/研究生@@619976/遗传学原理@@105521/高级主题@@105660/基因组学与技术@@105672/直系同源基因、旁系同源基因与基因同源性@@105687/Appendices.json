{"hands_on_practices": [{"introduction": "在比较基因组学中，第一步通常是在大型数据库中搜索相似序列。本练习旨在训练您批判性地解读BLAST搜索结果，理解统计显著的相似性（由极低的E值$E$-value支持）是推断同源性（即共同祖先）的有力证据 [@problem_id:2834929]。然而，仅凭一次成对序列比对的统计数据，尚不足以区分直系同源和旁系同源，后者需要更丰富的系统发育和基因组上下文信息。", "problem": "来自物种 $X$ 的一个蛋白质和来自物种 $Y$ 的一个蛋白质，通过基本局部比对搜索工具（BLAST）进行蛋白质-蛋白质比对，产生了以下摘要统计数据：双序列一致性为 $30\\%$，比对覆盖度为较长序列的 $80\\%$，期望值（E-value）为 $10^{-20}$。假设该 BLAST 搜索使用了标准的非冗余蛋白质数据库，并且低复杂度区域已被屏蔽。仅使用关于序列同源性和数据库搜索统计的核心定义和经过充分检验的事实，判断这些证据是否足以断定同源性，以及是否足以区分直系同源和旁系同源。通过诉诸第一性原理来证明你的选择：同源性作为共同祖先的定义，BLAST E值作为明确零假设模型下预期随机匹配数的含义，以及直系同源和旁系同源在物种形成与基因重复方面的定义。选择唯一的最佳选项。\n\nA. 证据足以断定同源性，因为 $10^{-20}$ 的E值表明在整个数据库中随机匹配的概率极低；然而，若无系统发育和基因组背景信息（例如，基因树-物种树调和、基因重复时间或保守共线性），则不足以区分直系同源和旁系同源。\n\nB. 证据不足以断定同源性，因为 $30\\%$ 的一致性位于“模糊区”；尽管E值很低，但低百分比一致性排除了对共同祖先的可靠推断。\n\nC. 证据足以断定直系同源性，因为高比对覆盖度（$80\\%$）加上极低的E值（$10^{-20}$）意味着这两个序列是跨物种的唯一最佳匹配，这本身就确立了基于物种形成的关系。\n\nD. 证据不足以断定同源性，因为比对没有覆盖任一序列的 $100\\%$；只有在蛋白质水平上，一致性 $>40\\%$ 的全长比对才能可靠地表明共同祖先。\n\nE. 证据足以断定同源性，也足以将该关系归类为旁系同源，因为低于 $40\\%$ 的序列一致性和低于 $10^{-10}$ 的E值是基因重复衍生的相似性的特征，而非物种形成的特征。", "solution": "首先将对问题陈述进行严格的验证。\n\n步骤1：提取已知条件\n- 比较了两种蛋白质，一个来自物种 $X$，一个来自物种 $Y$。\n- 通过基本局部比对搜索工具（BLAST）进行蛋白质-蛋白质比对。\n- 双序列一致性为 $30\\%$。\n- 比对覆盖度为较长序列的 $80\\%$。\n- 期望值（E-value）为 $10^{-20}$。\n- 搜索是针对一个标准的非冗余蛋白质数据库进行的。\n- 低复杂度区域已被屏蔽。\n- 任务是评估这些证据是否足以断定同源性，以及是否足以区分直系同源和旁系同源。\n- 论证必须基于第一性原理：同源性的定义、BLAST E值的含义以及直系同源物和旁系同源物的定义。\n\n步骤2：验证问题陈述\n问题陈述具有科学依据，使用了生物信息学和分子进化领域的标准术语和概念（如同源性、直系同源、旁系同源、BLAST、E值、百分比一致性）。提供的定量数据（$30\\%$ 一致性，$80\\%$ 覆盖度，E值为 $10^{-20}$）是内部一致的，并代表了真实序列数据库搜索的可能结果。问题提取得当，要求基于基本定义对证据进行具体评估。它是客观的，不包含科学或事实上的不健全之处、缺失信息或逻辑矛盾。该问题是有效的。\n\n步骤3：推导解决方案\n该问题要求对两种不同的进化主张的证据进行评估：首先是同源性，其次是同源性的具体类型（直系同源与旁系同源）。这些必须根据所提供的统计数据和基本原理进行评估。\n\n首先，我们分析关于同源性的断言。同源性定义为共同祖先。它是从具有统计学显著性的相似性中推断出的结论。在BLAST搜索中，用于此推断的主要统计量是期望值（E-value）。E值的定义是，在一个给定大小的数据库中，由于偶然性，预期出现的得分等于或大于观测得分的比对数量。零假设是观测到的相似性是一个随机产物。\n\n在这个问题中，E值是 $10^{-20}$。这个值非常小。它表明，在对一个相当规模的数据库进行 $10^{20}$ 次搜索中，人们预期仅有一次会由于随机机会找到这样的比对。这使得我们可以有信心地拒绝零假设。因此，观测到的相似性在统计学上具有压倒性的显著性。\n\n百分比一致性为 $30\\%$。虽然该值落在所谓的“模糊区”（$20-35\\%$），在这一区域内仅凭一致性并非同源性的可靠指标，但E值提供的更为严格的统计检验取代了这一点。E值的计算已经包含了比对得分，该得分是序列一致性（以及其他因素，如替换、比对长度和空位罚分）、序列长度和数据库大小的函数。一个高度显著的E值，如 $10^{-20}$，即使在百分比一致性中等的情况下，也为同源性提供了强有力的证据。较长序列 $80\\%$ 的比对覆盖度进一步加强了这一结论，因为它表明相似性并非局限于一个小的、偶然保守的基序，而是延伸到了蛋白质的相当大一部分，这表明它们的整体结构或一个大结构域具有共同的进化起源。因此，证据足以断定同源性。\n\n其次，我们分析区分直系同源和旁系同源的能力。直系同源物是不同物种中的同源基因，它们起源于最近共同祖先中的单个基因，并通过物种形成事件产生。旁系同源物是物种内部或物种之间的同源基因，它们起源于基因重复事件。\n\n单次BLAST比对，无论其统计显著性如何，都不足以解析基因重复和物种形成事件的历史。考虑一个在物种 $X$ 和物种 $Y$ 的谱系分离之前的共同祖先中发生的基因重复事件。那么，这两个物种都会继承由此产生的两个旁系同源基因。一次BLAST搜索可以在物种 $X$ 和 $Y$ 之间识别出一个同源对，但这可能是一对直系同源物，也可能是一对旁系同源物。或者，在物种形成后，一个谱系中可能发生了基因重复。那么，BLAST的匹配结果将是直系同源物之间的，但在不知道是这种情况而非前一种情况发生时，这是无法确定的。\n\n为了明确区分直系同源物和旁系同源物，必须重建该基因家族的进化历史。这需要更全面的数据和分析，例如：\n1.  系统发育重建：用来自不同物种的多个同源序列构建一个基因树，并将此基因树与已知的物种树进行调和。在基因树拓扑结构与物种树冲突的节点上，可以推断出基因重复事件。\n2.  基因组背景分析：检查基因的染色体位置（共线性）。直系同源物通常位于保守的共线性区块中，而近期的旁系同源物可能以串联阵列的形式存在。\n\n所提供的数据——一次单独的双序列比对——没有提供关于更广泛的基因家族或基因组背景的信息。因此，无法区分这两种蛋白质的共同祖先是存在于物种的最近共同祖先中（意味着是直系同源），还是其谱系中某个基因重复事件的结果（意味着是旁系同源）。\n\n逐项选项分析：\n\nA. 该陈述正确地指出，低的E值是同源性的决定性证据。它也正确地说明，区分直系同源和旁系同源需要超越单次双序列比对的额外、更复杂的分析。所给出的例子（系统发育调和、共线性）是用于此目的的标准方法。该选项与第一性原理一致。\n结论：**正确**。\n\nB. 该陈述错误地将一个启发式规则（“模糊区”）置于严格的E值统计度量之上。一个高度显著的E值是同源性的主要证据，并解决了中等百分比一致性的模糊性。该陈述存在根本性缺陷。\n结论：**错误**。\n\nC. 该陈述做出了一个未经证实的跳跃。首先，问题并未说明该匹配是相互最佳匹配。其次，更关键的是，即使是相互最佳匹配也只是预测直系同源性的一种启发式方法，而非确凿的证明。在基因丢失或旁系同源物间进化速率差异的情况下，它可能会失效。它本身并不能“确立基于物种形成的关系”。这需要系统发育分析。\n结论：**错误**。\n\nD. 该陈述提出了并非基于科学原理的武断且过于严格的标准。同源性通常是为保守结构域推断的，而这些结构域并不跨越蛋白质的全长。由E值所捕捉的比对长度、得分和数据库大小的组合，才是评估显著性的正确方法，而非对一致性和覆盖度的僵硬截断值。\n结论：**错误**。\n\nE. 该陈述提出了一个毫无根据的主张。序列一致性的程度是自分歧以来的进化时间的函数，而不是分歧机制（物种形成与基因重复）的函数。古老的直系同源物和古老的旁系同源物都可以表现出较低的序列一致性。没有规则将特定的一致性范围与旁系同源或直系同源联系起来。\n结论：**错误**。\n\n基于这一严谨的分析，选项A是唯一根据分子进化的基本原理正确解释该生物信息学证据的陈述。", "answer": "$$\\boxed{A}$$", "id": "2834929"}, {"introduction": "重建基因家族的进化历史是理解其功能的关键，而协调基因树（reconciled gene tree）提供了一个清晰的模型来描绘这些历史事件。本练习将指导您在一个已知的协调基因树上，根据最近共同祖先节点的事件类型（物种形成或基因重复），严格应用直系同源和旁系同源的定义来进行分类 [@problem_id:2834878]。这项实践将强化您从系统发育模型中准确解读基因演化关系的核心技能。", "problem": "提供了一个校正有根基因树，它代表了从物种$A$、$B$和$C$中采样的单个基因家族。叶节点是现存基因$A_1$、$A_2$、$B_1$和$C_1$，其中$A_1$和$A_2$来自物种$A$，$B_1$来自物种$B$，$C_1$来自物种$C$。内部节点被标注为物种形成（$S$）或重复（$D$）。树的拓扑结构如下（括号表示节点标签）：\n\n- 根节点是一个物种形成节点$S_0$，它有两个子节点：左子节点$N_1$和右子节点（叶节点）$C_1$。\n- 左子节点$N_1$是一个重复节点$D_1$，它有两个子节点：左子节点$N_2$和右子节点（叶节点）$A_2$。\n- 节点$N_2$是一个物种形成节点$S_1$，它的两个子节点是叶节点$A_1$和$B_1$。\n\n因此，在根节点$S_0$的左侧，树的形状是$((A_1,B_1)_{S_1},A_2)_{D_1}$，在$S_0$的右侧是$C_1$。\n\n请仅使用以下基本定义。在校正基因树中，内部节点被解释为基因家族历史中的演化事件：重复节点代表基因重复；物种形成节点代表物种分化。如果两个基因在物种形成事件中分化，则它们是直系同源基因；如果在重复事件中分化，则它们是旁系同源基因；如果它们的分化涉及水平基因转移（HGT；horizontal gene transfer），则它们是异源同源基因。假设内部节点上只有物种形成和重复的标签，并且没有提供额外的转移标注。\n\n根据这些定义和树上的节点类型标签，从基本原理出发，将这$4$个现存基因中的每一个无序对分类为直系同源、旁系同源或异源同源。哪个选项为所有$6$个无序对提供了与所给信息完全一致的分类？\n\n- A. $(A_1,B_1)$ 为直系同源；$(A_1,A_2)$ 为旁系同源；$(B_1,A_2)$ 为旁系同源；$(C_1,A_1)$ 为直系同源；$(C_1,B_1)$ 为直系同源；$(C_1,A_2)$ 为直系同源；没有异源同源对。\n- B. $(A_1,B_1)$ 为直系同源；$(A_1,A_2)$ 为旁系同源；$(B_1,A_2)$ 为旁系同源；$(C_1,A_1)$ 为直系同源；$(C_1,B_1)$ 为直系同源；$(C_1,A_2)$ 为旁系同源；没有异源同源对。\n- C. $(A_1,B_1)$ 为直系同源；$(A_1,A_2)$ 为旁系同源；$(B_1,A_2)$ 为异源同源；$(C_1,A_1)$ 为直系同源；$(C_1,B_1)$ 为直系同源；$(C_1,A_2)$ 为直系同源。\n- D. 所有来自不同物种的基因对都是直系同源，所有来自同一物种的基因对都是旁系同源；因此$(A_1,B_1)$、$(A_1,C_1)$、$(A_2,B_1)$、$(A_2,C_1)$是直系同源，而$(A_1,A_2)$是旁系同源对；不需要其他分类。", "solution": "我们从支配校正基因树中同源性分类的核心定义开始：\n\n- 在校正基因树中，内部节点代表基因家族的演化事件：物种形成节点（$S$）对应于物种分化，其中谱系按物种划分；重复节点（$D$）对应于谱系内的基因拷贝数增加。\n- 如果两个现存基因的分化可追溯到物种形成事件，则它们是直系同源基因。在一个内部节点被标注为$S$或$D$的有根基因树中，该标准具体化为这两个基因的最近共同祖先（lowest common ancestor, LCA）被标注为物种形成节点。\n- 如果两个现存基因的分化可追溯到重复事件，则它们是旁系同源基因，这具体化为它们的LCA被标注为重复节点。\n- 如果两个现存基因的分化涉及水平基因转移（HGT；horizontal gene transfer），则它们是异源同源基因。在没有对节点或边进行显式转移标注（例如，没有$T$标签或通过校正检测到转移事件）的情况下，仅凭$S$和$D$标签无法诊断异源同源。\n\n给定基因树：\n- 根节点$S_0$向左分裂为$D_1$，向右分裂为$C_1$。\n- $D_1$分裂为$S_1$和$A_2$。\n- $S_1$分裂为$A_1$和$B_1$。\n\n我们通过识别LCA及其标签来分析每个无序对。\n\n1. 基因对 $(A_1,B_1)$：\n- LCA是$S_1$，因为$A_1$和$B_1$是物种形成节点$S_1$下的姐妹节点。\n- LCA的标签是$S$。\n- 根据定义，$(A_1,B_1)$是直系同源基因。\n\n2. 基因对 $(A_1,A_2)$：\n- $A_1$在$S_1$下，而$A_2$是$D_1$下$S_1$的姐妹节点。\n- LCA是$D_1$。\n- LCA的标签是$D$。\n- 根据定义，$(A_1,A_2)$是旁系同源基因。\n\n3. 基因对 $(B_1,A_2)$：\n- $B_1$在$S_1$下，而$A_2$是$D_1$下$S_1$的姐妹节点。\n- LCA是$D_1$。\n- LCA的标签是$D$。\n- 根据定义，$(B_1,A_2)$是旁系同源基因。它们是外旁系同源（out-paralogs），因为这次重复事件早于分离物种$A$和$B$的物种形成事件。\n\n4. 基因对 $(C_1,A_1)$：\n- $C_1$是根节点$S_0$的右子节点，$A_1$在左子树中。\n- LCA是根节点$S_0$。\n- LCA的标签是$S$。\n- 根据定义，$(C_1,A_1)$是直系同源基因。\n\n5. 基因对 $(C_1,B_1)$：\n- $C_1$是根节点$S_0$的右子节点，$B_1$在左子树中。\n- LCA是根节点$S_0$。\n- LCA的标签是$S$。\n- 根据定义，$(C_1,B_1)$是直系同源基因。\n\n6. 基因对 $(C_1,A_2)$：\n- $C_1$是根节点$S_0$的右子节点，$A_2$在左子树中。\n- LCA是根节点$S_0$。\n- LCA的标签是$S$。\n- 根据定义，$(C_1,A_2)$是直系同源基因。重要的是，这反映了多对多直系同源关系：与$C$分化后，$A$谱系上的重复事件导致在物种$A$中相对于$C_1$产生了多个共同直系同源基因（co-orthologs）。\n\n关于异源同源：\n- 没有任何内部节点或边被标注为转移事件，并且问题说明只提供了$S$和$D$标签。\n- 因此，根据给定信息，没有任何基因对可以被指定为异源同源。\n\n逐项分析选项：\n\n- 选项A列出：\n  - $(A_1,B_1)$ 为直系同源（与分析匹配：正确）。\n  - $(A_1,A_2)$ 为旁系同源（正确）。\n  - $(B_1,A_2)$ 为旁系同源（正确）。\n  - $(C_1,A_1)$ 为直系同源（正确）。\n  - $(C_1,B_1)$ 为直系同源（正确）。\n  - $(C_1,A_2)$ 为直系同源（正确）。\n  - 声明没有异源同源（正确，因为只给出了$S/D$标签）。\n  结论：正确。\n\n- 选项B的唯一不同之处在于将$(C_1,A_2)$归类为旁系同源。$C_1$和$A_2$的LCA是$S_0$（物种形成），而不是重复；因此它们是直系同源，而非旁系同源。该选项将下游的重复事件与分离这对基因的事件混淆了。\n  结论：不正确。\n\n- 选项C将$(B_1,A_2)$标记为异源同源。没有证据表明存在水平基因转移；它们的LCA是$D_1$（重复），这使它们成为旁系同源。在没有转移标注的情况下引入异源同源是不合理的。\n  结论：不正确。\n\n- 选项D断言了一个朴素的规则：所有跨物种基因对都是直系同源，所有同物种基因对都是旁系同源。这个规则错误地将$(B_1,A_2)$归类为直系同源，尽管它们的LCA是一个重复事件（$D_1$），并且未能认识到$(C_1,A_2)$也是直系同源，尽管在其他地方发生了重复。正确的标准是LCA事件的类型，而不仅仅是物种身份。\n  结论：不正确。\n\n因此，唯一完全一致的分类由选项A给出。", "answer": "$$\\boxed{A}$$", "id": "2834878"}, {"introduction": "基因重复为进化创新提供了原始素材，但这些重复的基因副本随后的命运是什么？本练习介绍了一个核心的分子进化工具——非同义替换率（$d_N$）与同义替换率（$d_S$）之比（$\\omega$），它用于量化作用于基因上的选择压力 [@problem_id:2834923]。通过亲手计算一对旁系同源基因的$\\omega$值，您将学会如何判断它们是在经历纯化选择、中性选择还是正选择，从而洞察其功能的分化或保守性。", "problem": "脊椎动物基因组中的一对重复基因（旁系同源基因）源于一次古老的基因重复事件。这两个旁系同源基因之间的密码子水平比对包含 $L = 1000$ 个对齐的密码子，且不含空位或终止密码子。在标准遗传密码下，根据 Nei–Gojobori 框架中使用的经典位点计数法计算，整个比对中的同义位点总数和非同义位点总数分别为 $S = 800$ 和 $N = 2200$，因此 $S + N = 3L$。在整个比对中，观测到的可归因于同义替换和非同义替换的成对差异数分别为 $s = 160$ 和 $n = 330$。\n\n假设核苷酸替换遵循 Jukes–Cantor 1969 (JC69) 模型（即一个位点上三种可能的替换速率相等、时间均一且各位点独立），并沿用经典的 Nei–Gojobori 计数方案，从每个同义位点上的观测同义差异比例和每个非同义位点上的观测非同义差异比例来估计同义替换率 $d_{S}$ 和非同义替换率 $d_{N}$。然后计算这对旁系同源基因的非同义替换率与同义替换率之比 $\\omega = d_{N}/d_{S}$。\n\n仅报告 $\\omega$ 的值，以纯数字形式呈现，并保留四位有效数字。", "solution": "问题陈述已经过验证，被认定为有效。其科学基础在于分子进化原理，问题陈述清晰，数据充分且一致，表述客观。未发现任何瑕疵。我们可以开始求解。\n\n该问题要求计算一对旁系同源基因的非同义替换率与同义替换率之比，记为 $\\omega$。这一计算通过 Nei–Gojobori 方法完成，该方法包含两个主要步骤：首先，计算观测到的同义差异和非同义差异的比例；其次，使用一个核苷酸替换模型（在本例中为 Jukes–Cantor 1969 (JC69) 模型）对这些比例进行多重替换校正。\n\n提供的已知数据如下：\n- 已对齐密码子总数：$L = 1000$。\n- 同义位点总数：$S = 800$。\n- 非同义位点总数：$N = 2200$。\n- 观测到的同义差异数：$s = 160$。\n- 观测到的非同义差异数：$n = 330$。\n\n一致性检验 $S+N = 800 + 2200 = 3000 = 3L = 3 \\times 1000$ 成立。\n\n首先，我们计算每个同义位点上的同义差异比例 $p_S$，以及每个非同义位点上的非同义差异比例 $p_N$。\n\n同义差异的比例计算如下：\n$$p_S = \\frac{s}{S}$$\n代入给定值：\n$$p_S = \\frac{160}{800} = 0.2$$\n\n非同义差异的比例计算如下：\n$$p_N = \\frac{n}{N}$$\n代入给定值：\n$$p_N = \\frac{330}{2200} = \\frac{33}{220} = \\frac{3}{20} = 0.15$$\n\n这些比例 $p_S$ 和 $p_N$ 代表了序列间观测到的差异。它们是对真实进化距离的低估，因为在同一个位点上可能发生了多次替换，而这些多次替换在简单的成对比较中是不可见的。为了校正这一点，我们应用 Jukes–Cantor 校正。\n\nJC69 模型提供了一个公式，可以根据观测到的不同位点的比例 $p$ 来估计每个位点的替换数 $d$：\n$$d = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} p\\right)$$\n只要 $p < \\frac{3}{4}$，该校正就有效，而 $p_S$ 和 $p_N$ 均满足此条件。\n\n我们将此公式分别应用于同义位点和非同义位点，以估计同义替换率 $d_S$ 和非同义替换率 $d_N$。\n\n对于同义替换率 $d_S$：\n$$d_S = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} p_S\\right)$$\n代入 $p_S = 0.2$：\n$$d_S = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\times 0.2\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{0.8}{3}\\right) = -\\frac{3}{4} \\ln\\left(\\frac{2.2}{3}\\right)$$\n数值上，此值为：\n$$d_S \\approx -0.75 \\times \\ln(0.7333...) \\approx -0.75 \\times (-0.310155) \\approx 0.232616$$\n\n对于非同义替换率 $d_N$：\n$$d_N = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} p_N\\right)$$\n代入 $p_N = 0.15$：\n$$d_N = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\times 0.15\\right) = -\\frac{3}{4} \\ln\\left(1 - 0.2\\right) = -\\frac{3}{4} \\ln(0.8)$$\n数值上，此值为：\n$$d_N \\approx -0.75 \\times (-0.223144) \\approx 0.167358$$\n\n最后，非同义替换率与同义替换率之比 $\\omega$ 是 $d_N$ 与 $d_S$ 的比值：\n$$\\omega = \\frac{d_N}{d_S}$$\n代入计算出的值：\n$$\\omega \\approx \\frac{0.167358}{0.232616} \\approx 0.719453$$\n\n问题要求结果保留四位有效数字。前四位有效数字是 $7$、$1$、$9$ 和 $4$。第五位数字是 $5$，因此我们将第四位数字向上取整。\n$$\\omega \\approx 0.7195$$\n这个值小于 $1$，表明这对旁系同源基因受到了纯化选择（或负选择）的作用。在这种选择压力下，非同义突变平均而言是有害的，因此它们比同义突变更频繁地从群体中被清除。", "answer": "$$\\boxed{0.7195}$$", "id": "2834923"}]}