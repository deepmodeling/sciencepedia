{"hands_on_practices": [{"introduction": "在功能基因组学中，RNA测序（RNA-seq）测量的并非转录本的绝对丰度，而是其相对丰度。这一固有的数据“成分性”（compositionality）如果处理不当，会产生具有误导性的分析结果。本练习 [@problem_id:2811878] 通过一个思想实验，清晰地揭示了当少数基因的表达发生剧烈变化时，其他表达稳定的基因会如何被人为地“看作”表达下调。理解这一现象对于任何进行差异表达分析的研究者都至关重要。", "problem": "一项RNA测序（RNA-seq）实验比较了两种条件，分别标记为条件$\\mathrm{A}$和条件$\\mathrm{B}$。假设存在以下基本事实和定义：\n\n1. 测序产生的计数（counts）与输入RNA池中转录本的相对丰度成正比；当从每个样本中获得固定数量的读数（reads）时，观测到的计数是成分性的（compositional），即它们估计的是总和为$1$的潜在相对丰度。\n2. 在总计数归一化（也称为每百万读数缩放（CPM） scaling）下，每个样本都通过其总读数计数进行缩放；如果总读数计数相等，这种归一化方法不改变计数值，比较就简化为比较相对丰度。\n3. 一个基因在不同条件间的倍数变化（fold-change）定义为其在条件$\\mathrm{B}$中的归一化丰度与在条件$\\mathrm{A}$中的归一化丰度的比值。\n\n考虑一个转录组，其包含两个不相交的基因组：一个由高表达基因组成的子集$\\mathrm{H}$及其补集$\\mathrm{L}$。在条件$\\mathrm{A}$下，$\\mathrm{H}$所占的总相对丰度为 $f \\in (0,1)$，而$\\mathrm{L}$所占的总相对丰度为 $1 - f$。在条件$\\mathrm{B}$下，$\\mathrm{H}$中的每个基因的真实表达量都上调了一个乘法因子 $r > 0$，而$\\mathrm{L}$中的每个基因的真实表达量保持不变。用于$\\mathrm{A}$和$\\mathrm{B}$的文库经测序后得到的总读数相同，因此可以直接应用总计数归一化。\n\n任务1（推导）：仅从相对丰度总和为$1$的成分性约束以及倍数变化的定义出发，推导一个用$f$和$r$表示的表达式，该表达式代表在朴素总计数归一化下，$\\mathrm{L}$中任一真实表达量未发生变化的基因$g$的表观倍数变化。\n\n任务2（玩具示例验证）：使用以下具体的玩具实例来验证您的表达式。在条件$\\mathrm{A}$下，共有五个基因：三个位于$\\mathrm{H}$中的高表达基因，其总相对丰度为 $f = 0.6$；以及两个位于$\\mathrm{L}$中的基因，它们均分剩余的$0.4$相对丰度。在条件$\\mathrm{B}$下，$\\mathrm{H}$中每个基因的表达量乘以 $r=3$，而$\\mathrm{L}$中的基因不变。假设两个文库都产生$10^{6}$条读数。计算$\\mathrm{L}$中一个未变化基因的朴素总计数归一化倍数变化，并验证其是否与您推导的表达式相符。\n\n请以单个闭式解析表达式的形式提供您的最终答案，用$f$和$r$表示在朴素总计数归一化下$\\mathrm{L}$中一个非差异表达基因的表观倍数变化。不要包含单位。", "solution": "将首先验证问题的科学性和逻辑一致性。\n\n**第一步：提取已知条件**\n\n- **定义1**：RNA-seq计数是成分性的，估计的是总和为$1$的潜在相对丰度。\n- **定义2**：对于总读数计数相等的文库，总计数归一化等同于直接比较相对丰度。\n- **定义3**：倍数变化是在条件$\\mathrm{B}$中的归一化丰度与在条件$\\mathrm{A}$中的归一化丰度的比值。\n- **条件A**：一个转录组有两个不相交的基因集$\\mathrm{H}$和$\\mathrm{L}$。$\\mathrm{H}$的总相对丰度为$f$，其中$f \\in (0,1)$。$\\mathrm{L}$的总相对丰度为$1-f$。\n- **条件B**：$\\mathrm{H}$中的每个基因的真实表达量都上调了一个因子$r > 0$。$\\mathrm{L}$中的每个基因的真实表达量保持不变。\n- **任务1**：推导任一基因$g \\in \\mathrm{L}$的表观倍数变化（用$f$和$r$表示）。\n- **任务2（验证数据）**：\n    - 条件A：总共5个基因。3个基因在$\\mathrm{H}$中，总相对丰度为$f = 0.6$。2个基因在$\\mathrm{L}$中，均分剩余的$0.4$丰度。\n    - 条件B：$\\mathrm{H}$中基因的上调因子为$r = 3$。\n    - 测序深度：两个文库均为$10^{6}$条读数。\n\n**第二步：使用提取的已知条件进行验证**\n\n根据验证标准对问题陈述进行评估。\n\n- **科学基础**：该问题坚实地立足于功能基因组学的原理，特别是RNA-seq数据的分析。成分性数据的概念以及总计数归一化所引入的偏差是转录组学中基本且公认的问题。\n- **适定性**：该问题是适定的。它提供了充分的定义和约束，可以为目标量推导出唯一的解析解。\n- **客观性**：语言精确、量化，没有主观或模糊的术语。\n\n该问题没有任何无效标志。它在科学上是合理的，可形式化的，完整的，并提出了一个关于成分性约束下数据归一化的数学后果的非平凡问题。\n\n**结论**\n\n该问题有效。将提供解答。\n\n**解题推导**\n\n目标是求出属于集合$\\mathrm{L}$的基因的表观倍数变化，该集合包含在条件$\\mathrm{A}$和$\\mathrm{B}$之间真实分子丰度不变的基因。这种表观变化源于数据的成分性，即所有相对丰度的总和必须为$1$。\n\n设$\\alpha_{g,A}$和$\\alpha_{g,B}$分别为基因$g$在条件$\\mathrm{A}$和条件$\\mathrm{B}$下的相对丰度。设所有基因的集合为$\\mathcal{G} = \\mathrm{H} \\cup \\mathrm{L}$。成分性约束表明：\n$$ \\sum_{g \\in \\mathcal{G}} \\alpha_{g,A} = 1 \\quad \\text{和} \\quad \\sum_{g \\in \\mathcal{G}} \\alpha_{g,B} = 1 $$\n\n根据问题陈述，在条件$\\mathrm{A}$下：\n$$ \\sum_{h \\in \\mathrm{H}} \\alpha_{h,A} = f $$\n$$ \\sum_{l \\in \\mathrm{L}} \\alpha_{l,A} = 1 - f $$\n\n为了模拟“真实”变化，我们考虑潜在的、未归一化的分子丰度。让我们将条件$\\mathrm{A}$样本中的总分子丰度表示为$C_{T,A}$。任何基因$g$的丰度为$C_{g,A} = \\alpha_{g,A} C_{T,A}$。\n\n在条件$\\mathrm{B}$下，每个基因$h \\in \\mathrm{H}$的真实丰度乘以$r$，每个基因$l \\in \\mathrm{L}$的真实丰度保持不变。在条件$\\mathrm{B}$下，基因$g$的新的未归一化丰度，记为$C'_{g,B}$，是：\n$$ C'_{h,B} = r \\cdot C_{h,A} \\quad \\text{对于 } h \\in \\mathrm{H} $$\n$$ C'_{l,B} = C_{l,A} \\quad \\text{对于 } l \\in \\mathrm{L} $$\n\n在条件$\\mathrm{B}$下，新的总分子丰度$C'_{T,B}$是所有基因的总和：\n$$ C'_{T,B} = \\sum_{h \\in \\mathrm{H}} C'_{h,B} + \\sum_{l \\in \\mathrm{L}} C'_{l,B} = \\sum_{h \\in \\mathrm{H}} (r \\cdot C_{h,A}) + \\sum_{l \\in \\mathrm{L}} C_{l,A} $$\n提出因子$r$并将总和用条件$\\mathrm{A}$下的相对丰度表示：\n$$ C'_{T,B} = r \\left( \\sum_{h \\in \\mathrm{H}} C_{h,A} \\right) + \\sum_{l \\in \\mathrm{L}} C_{l,A} $$\n我们知道 $\\sum_{h \\in \\mathrm{H}} C_{h,A} = C_{T,A} \\sum_{h \\in \\mathrm{H}} \\alpha_{h,A} = C_{T,A} \\cdot f$。\n且 $\\sum_{l \\in \\mathrm{L}} C_{l,A} = C_{T,A} \\sum_{l \\in \\mathrm{L}} \\alpha_{l,A} = C_{T,A} \\cdot (1-f)$。\n将这些代入$C'_{T,B}$的表达式中：\n$$ C'_{T,B} = r(C_{T,A} \\cdot f) + C_{T,A} \\cdot (1-f) = C_{T,A} (rf + 1 - f) $$\n\n为了满足成分性约束，在条件$\\mathrm{B}$下观测到的任何基因$g$的相对丰度$\\alpha_{g,B}$是其新的真实丰度除以新的总丰度：\n$$ \\alpha_{g,B} = \\frac{C'_{g,B}}{C'_{T,B}} $$\n\n我们关心的是基因$g \\in \\mathrm{L}$。对于这样的基因，$C'_{g,B} = C_{g,A}$。我们还知道$C_{g,A} = \\alpha_{g,A} \\cdot C_{T,A}$。代入这些关系：\n$$ \\alpha_{g,B} = \\frac{C_{g,A}}{C'_{T,B}} = \\frac{\\alpha_{g,A} \\cdot C_{T,A}}{C_{T,A} (rf + 1 - f)} $$\n项$C_{T,A}$被消去，剩下：\n$$ \\alpha_{g,B} = \\frac{\\alpha_{g,A}}{rf + 1 - f} $$\n\n问题将倍数变化定义为归一化丰度的比值。由于总文库大小相等，这对应于相对丰度的比值。对于任何基因$g \\in \\mathrm{L}$（假设$\\alpha_{g,A} \\neq 0$），其表观倍数变化$FC_g$为：\n$$ FC_g = \\frac{\\alpha_{g,B}}{\\alpha_{g,A}} = \\frac{\\frac{\\alpha_{g,A}}{rf + 1 - f}}{\\alpha_{g,A}} $$\n$$ FC_g = \\frac{1}{rf + 1 - f} $$\n该表达式仅依赖于$f$和$r$，符合要求。\n\n**用玩具示例进行验证**\n\n现在，我们使用提供的玩具示例来验证这个通用表达式。\n- 已知：$f=0.6$, $r=3$。\n- 根据推导出的公式，$\\mathrm{L}$中一个基因的预期表观倍数变化是：\n$$ FC_g = \\frac{1}{(3)(0.6) + 1 - 0.6} = \\frac{1}{1.8 + 0.4} = \\frac{1}{2.2} = \\frac{10}{22} = \\frac{5}{11} $$\n\n接下来，我们使用玩具数据从第一性原理计算这个值。\n- 在条件$\\mathrm{A}$下，总读数计数为$N = 10^6$。\n- $\\mathrm{L}$中2个基因的总相对丰度为$1-f = 0.4$。由于它们均分此丰度，单个基因$g \\in \\mathrm{L}$的相对丰度为$\\alpha_{g,A} = \\frac{0.4}{2} = 0.2$。\n- 该基因在条件$\\mathrm{A}$下的读数计数为$C_{g,A} = \\alpha_{g,A} \\cdot N = 0.2 \\cdot 10^6 = 200,000$。\n- 集合$\\mathrm{H}$在条件$\\mathrm{A}$下的总读数计数为$f \\cdot N = 0.6 \\cdot 10^6 = 600,000$。\n\n- 在条件$\\mathrm{B}$下，$\\mathrm{H}$中基因的真实丰度乘以$r=3$，而$\\mathrm{L}$中的基因不变。新的未归一化总计数是：\n$$ C'_{T,B} = (\\text{H的计数}) \\times r + (\\text{L的计数}) \\times 1 = (600,000 \\times 3) + (400,000 \\times 1) = 1,800,000 + 400,000 = 2,200,000 $$\n- 我们关注的基因$g \\in \\mathrm{L}$的未归一化计数仍为$200,000$。\n- 基因$g$在条件$\\mathrm{B}$下的新相对丰度是：\n$$ \\alpha_{g,B} = \\frac{\\text{g的未归一化计数}}{\\text{新的未归一化总计数}} = \\frac{200,000}{2,200,000} = \\frac{2}{22} = \\frac{1}{11} $$\n\n- 表观倍数变化是相对丰度的比值：\n$$ FC_g = \\frac{\\alpha_{g,B}}{\\alpha_{g,A}} = \\frac{1/11}{0.2} = \\frac{1/11}{1/5} = \\frac{5}{11} $$\n这个结果与推导公式预测的结果相符。验证成功。表达式正确。", "answer": "$$\n\\boxed{\\frac{1}{rf + 1 - f}}\n$$", "id": "2811878"}, {"introduction": "认识到成分性偏差的挑战后，我们接着探索一种解决方案。在广受欢迎的DESeq2分析包中应用的“比例中值法”（median-of-ratios method）为校正文库大小和成分偏差提供了一种稳健的策略。本练习 [@problem_id:2811863] 将引导您一步步手动计算这些关键的归一化因子，并验证其一个核心特性：对数据进行整体缩放时的不变性，从而加深您对高级归一化方法原理的理解。", "problem": "为进行差异表达分析而对核糖核酸测序（RNA-seq）计数数据进行归一化时，一项核心任务是估计能够捕捉文库深度和其他全局缩放效应的样本特异性大小因子。Differential Expression Sequencing 2 (DESeq2) 方法通过比率中位数方法来定义大小因子：对每个基因，计算其在所有样本中的几何平均数；然后对每个样本，计算所有正计数基因的观测计数与这些几何平均数的比率；最后，取这些比率的中位数作为该样本的大小因子。请仅使用此定义以及几何平均数和中位数的标准定义，回答以下问题。\n\n给定一个由四个基因 $\\{G_1,G_2,G_3,G_4\\}$ 在三个样本 $\\{S_{\\mathrm{A}},S_{\\mathrm{B}},S_{\\mathrm{C}}\\}$ 中测得的严格正计数矩阵：\n$$\nN \\;=\\;\n\\begin{pmatrix}\n100 & 150 & 50 \\\\\n200 & 300 & 100 \\\\\n400 & 600 & 200 \\\\\n800 & 1200 & 400\n\\end{pmatrix},\n$$\n其中，列对应样本 $(S_{\\mathrm{A}},S_{\\mathrm{B}},S_{\\mathrm{C}})$，行对应基因 $(G_1,G_2,G_3,G_4)$。所有条目均为原始计数。\n\n1) 使用比率中位数定义，计算每个样本的 DESeq2 大小因子。\n\n2) 现在考虑将所有计数通过一个公共常数因子 $k = 10$ 进行统一缩放，得到缩放后的矩阵 $N' = k N$。请在不引用几何平均数和中位数定义之外任何结论的情况下，从基本原理出发，证明从 $N'$ 计算出的大小因子是否与从 $N$ 计算出的大小因子不同，并解释原因。\n\n请将 $(S_{\\mathrm{A}},S_{\\mathrm{B}},S_{\\mathrm{C}})$ 的公共大小因子向量以单行矩阵的形式报告，结果四舍五入至四位有效数字，最终数值答案不带单位。", "solution": "提交分析的问题陈述被认为是有效的。它在科学上基于转录组数据归一化的既定原则，特别是 DESeq2 使用的比率中位数方法。该问题是良构的，以清晰、客观且无矛盾的方式提供了所有必要的定义和数据。它提出了一个可形式化和可验证的计算任务。我将继续进行求解。\n\n该问题分为两部分。第一部分是计算给定计数矩阵 $N$ 的大小因子。第二部分是根据基本原理证明统一缩放对这些大小因子的影响。\n\n设计数矩阵为 $N$，其中 $N_{ij}$ 是基因 $i \\in \\{1, 2, 3, 4\\}$ 和样本 $j \\in \\{A, B, C\\}$ 的计数。该矩阵如下：\n$$\nN =\n\\begin{pmatrix}\nN_{1A} & N_{1B} & N_{1C} \\\\\nN_{2A} & N_{2B} & N_{2C} \\\\\nN_{3A} & N_{3B} & N_{3C} \\\\\nN_{4A} & N_{4B} & N_{4C}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n100 & 150 & 50 \\\\\n200 & 300 & 100 \\\\\n400 & 600 & 200 \\\\\n800 & 1200 & 400\n\\end{pmatrix}\n$$\n\n**第1部分：计算矩阵 $N$ 的大小因子**\n\n根据所提供的定义，计算分三步进行。\n\n**步骤1.1：计算每个基因的几何平均数。**\n基因 $i$ 在3个样本中的几何平均数，记为 $g_i$，由 $g_i = (N_{iA} \\cdot N_{iB} \\cdot N_{iC})^{1/3}$ 给出。\n\n对于基因 $G_1$：\n$$ g_1 = (100 \\times 150 \\times 50)^{1/3} = (750000)^{1/3} $$\n对于基因 $G_2$：\n$$ g_2 = (200 \\times 300 \\times 100)^{1/3} = (6000000)^{1/3} $$\n对于基因 $G_3$：\n$$ g_3 = (400 \\times 600 \\times 200)^{1/3} = (48000000)^{1/3} $$\n对于基因 $G_4$：\n$$ g_4 = (800 \\times 1200 \\times 400)^{1/3} = (384000000)^{1/3} $$\n\n可以观察到矩阵 $N$ 的结构。对于任何基因 $i$ 和样本 $j$，有 $N_{ij} = 2^{i-1} N_{1j}$。这一结构特性简化了各基因几何平均数之间的关系：\n$$ g_i = (\\prod_{j \\in \\{A,B,C\\}} N_{ij})^{1/3} = (\\prod_{j} 2^{i-1} N_{1j})^{1/3} = ((2^{i-1})^3 \\prod_{j} N_{1j})^{1/3} = 2^{i-1} (\\prod_{j} N_{1j})^{1/3} = 2^{i-1} g_1 $$\n因此，$g_2 = 2g_1$，$g_3 = 4g_1$，$g_4 = 8g_1$。\n\n**步骤1.2：对每个样本，计算观测计数与几何平均数的比率。**\n对每个样本 $j$，我们为所有 $i \\in \\{1, 2, 3, 4\\}$ 构建一组比率 $\\{r_{ij} = N_{ij} / g_i\\}$。因为问题说明所有计数均为正，所以我们考虑所有基因。\n\n由于观察到的矩阵结构，这些比率可以简化为：\n$$ r_{ij} = \\frac{N_{ij}}{g_i} = \\frac{2^{i-1} N_{1j}}{2^{i-1} g_1} = \\frac{N_{1j}}{g_1} $$\n这意味着对于一个给定的样本 $j$，比率 $r_{ij}$ 对所有基因 $i$ 都是恒定的。\n\n对于样本 $S_A$：所有比率均等于 $N_{1A} / g_1 = 100 / g_1$。\n$$ \\frac{100}{(750000)^{1/3}} $$\n对于样本 $S_B$：所有比率均等于 $N_{1B} / g_1 = 150 / g_1$。\n$$ \\frac{150}{(750000)^{1/3}} $$\n对于样本 $S_C$：所有比率均等于 $N_{1C} / g_1 = 50 / g_1$。\n$$ \\frac{50}{(750000)^{1/3}} $$\n\n**步骤1.3：每个样本的大小因子是其比率的中位数。**\n一组相同数字的中位数就是该数字本身。\n设 $s_j$ 为样本 $j$ 的大小因子。\n\n对于样本 $S_A$：\n$$ s_A = \\text{median}\\left(\\left\\{\\frac{100}{g_1}, \\frac{100}{g_1}, \\frac{100}{g_1}, \\frac{100}{g_1}\\right\\}\\right) = \\frac{100}{g_1} = \\frac{100}{(750000)^{1/3}} \\approx 1.100639 $$\n对于样本 $S_B$：\n$$ s_B = \\text{median}\\left(\\left\\{\\frac{150}{g_1}, \\frac{150}{g_1}, \\frac{150}{g_1}, \\frac{150}{g_1}\\right\\}\\right) = \\frac{150}{g_1} = \\frac{150}{(750000)^{1/3}} \\approx 1.650959 $$\n对于样本 $S_C$：\n$$ s_C = \\text{median}\\left(\\left\\{\\frac{50}{g_1}, \\frac{50}{g_1}, \\frac{50}{g_1}, \\frac{50}{g_1}\\right\\}\\right) = \\frac{50}{g_1} = \\frac{50}{(750000)^{1/3}} \\approx 0.550320 $$\n\n**第2部分：对统一缩放的不变性**\n\n我们现在必须从基本原理出发，证明当计数矩阵 $N$ 被一个常数因子 $k > 0$ 缩放时，大小因子是否会改变。设新矩阵为 $N' = k N$，其元素为 $N'_{ij} = k N_{ij}$。设基因数量为 $L$，样本数量为 $M$。\n\n**步骤2.1：计算新的基因几何平均数 $g'_i$。**\n使用缩放后矩阵 $N'$ 计算基因 $i$ 的几何平均数为：\n$$ g'_i = \\left( \\prod_{j=1}^{M} N'_{ij} \\right)^{1/M} $$\n代入 $N'_{ij} = k N_{ij}$：\n$$ g'_i = \\left( \\prod_{j=1}^{M} (k N_{ij}) \\right)^{1/M} = \\left( k^M \\prod_{j=1}^{M} N_{ij} \\right)^{1/M} $$\n$$ g'_i = (k^M)^{1/M} \\left( \\prod_{j=1}^{M} N_{ij} \\right)^{1/M} = k \\cdot g_i $$\n每个基因的新几何平均数就是原始几何平均数乘以相同的因子 $k$。\n\n**步骤2.2：计算新的比率 $r'_{ij}$。**\n使用缩放后数据计算基因 $i$ 和样本 $j$ 的比率为：\n$$ r'_{ij} = \\frac{N'_{ij}}{g'_i} $$\n代入上一步得到的 $N'_{ij}$ 和 $g'_i$ 的表达式：\n$$ r'_{ij} = \\frac{k N_{ij}}{k g_i} = \\frac{N_{ij}}{g_i} = r_{ij} $$\n缩放因子 $k$ 完全抵消。因此，对于每个样本，缩放后矩阵 $N'$ 的比率集合与原始矩阵 $N$ 的比率集合完全相同。\n\n**步骤2.3：计算新的大小因子 $s'_j$。**\n大小因子 $s'_j$ 是给定样本 $j$ 的新比率集合 $\\{r'_{ij}\\}$ 的中位数：\n$$ s'_j = \\text{median}(\\{r'_{i j}\\}_{i=1}^L) $$\n由于对所有基因 $i$ 都有 $r'_{ij} = r_{ij}$，所以比率集合没有改变。因此，其中位数也必定保持不变。\n$$ s'_j = \\text{median}(\\{r_{i j}\\}_{i=1}^L) = s_j $$\n这证明了从缩放后矩阵 $N'$ 计算出的大小因子与从原始矩阵 $N$ 计算出的大小因子完全相同。对所有计数进行统一缩放对 DESeq2 的大小因子没有影响。这一性质是该方法的基础，因为它确保了归一化矫正的是文库大小的差异，而不是测量单位的全局变化。\n\n因此，$(S_A, S_B, S_C)$ 的大小因子向量对于矩阵 $N$ 和 $N'$ 是共同的。将计算值四舍五入到四位有效数字，得到：\n$s_A \\approx 1.101$\n$s_B \\approx 1.651$\n$s_C \\approx 0.5503$\n该向量为 $(1.101, 1.651, 0.5503)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.101 & 1.651 & 0.5503\n\\end{pmatrix}\n}\n$$", "id": "2811863"}, {"introduction": "除了精通数据分析算法，功能基因组学研究的有效性在很大程度上还取决于严谨的实验设计。本练习 [@problem_id:2811821] 模拟了一个真实的多组学研究场景，其中充满了各种技术性偏差。通过解读主成分分析（Principal Component Analysis, PCA）图，您将学会如何识别“批次效应”（batch effects）和“混杂偏倚”（confounding）的典型迹象——这是高维数据分析中最常见的两个“陷阱”。", "problem": "一个实验室对一个队列进行了分析，该队列具有匹配的转录组学（RNA测序）、蛋白质组学（质谱）和代谢组学（质谱）数据，以研究一种疾病表型。根据分子生物学的中心法则，DNA的变化可以影响RNA的丰度，进而影响蛋白质水平，最终影响代谢物的浓度。然而，在功能基因组学中，测量结果可能受到生物学变异和技术变异的双重影响。两个关键概念是批次效应（batch effects）和混淆（confounding）。考虑以下场景和观察结果：\n\n- 该队列包含 $n$ 个人类样本，分为病例组和对照组。样本在 $b$ 个处理轮次（批次）中进行处理，这些批次在不同的日历日期进行，蛋白质组学和代谢组学数据在两台不同的仪器上采集。在每个批次和仪器运行中都注入了混合的质量控制（QC）参考品。\n- 在每个组学层经过标准预处理（归一化和对数转换）后，分别进行主成分分析（Principal Component Analysis, PCA）。还对每个组学层进行了基于欧几里得距离的层次聚类。\n- 在转录组学数据集中，第一主成分 $PC1$ 解释了大约 $35\\%$ 的方差，并与测序批次一致（来自同一批次的样本具有相似的 $PC1$ 得分）。第二主成分 $PC2$ 解释了大约 $12\\%$ 的方差，并且当分开检查各个批次时，在每个批次内部显示出病例组和对照组之间的分离。混合的QC文库与其各自的测序批次聚类在一起，而不是所有QC都聚在一起。\n- 在蛋白质组学数据集中，$PC1$ 解释了大约 $28\\%$ 的方差，并与仪器身份一致。来自同一仪器的QC注入样本聚类在一起，并与另一台仪器上的QC注入样本分开。在每台仪器内部，病例组与对照组的分离在 $PC2$ 上最为明显。\n- 在代谢组学数据集中，$PC1$ 解释了大约 $30\\%$ 的方差，并与仪器身份和注入顺序一致。在给定仪器上，来自早期和晚期位置的QC注入样本沿 $PC1$ 有轻微分离。病例组与对照组的分离在 $PC2$ 上可见，但比转录组学中弱。\n- 元数据显示，在第一个测序批次中处理的病例组比例高于在该批次中处理的对照组比例（例如，约 $80\\%$ 的病例组对约 $40\\%$ 的对照组），并且在一台仪器上的注入顺序相对于表型是非随机的。\n\n基于以下基本定义：(i) 批次效应是与技术因素（如运行批次、日期、试剂批号或仪器）相关的系统性、非生物学差异；(ii) 当一个科学关注的变量（表型）与一个同样影响测量的技术因素在统计上相关时，就会发生混淆，导致观察到的差异归因模糊不清；并回顾PCA旨在寻找最大化方差的正交方向，而层次聚类根据总体相似性对样本进行分组：\n\n下列哪个陈述正确地定义了这些概念，并描述了它们在上述情景的PCA和聚类中如何体现？选择所有适用项。\n\nA. 批次效应是与处理批次或仪器相关的系统性非生物学偏移；在转录组学中 $PC1$ 与测序批次的一致性，在蛋白质组学和代谢组学中与仪器的一致性，以及QC样本按批次或仪器聚类而不是所有QC聚在一起，这些都与显著的批次效应相符。\n\nB. 在转录组学中观察到的病例组与对照组沿 $PC1$ 的分离证明了强烈的生物学信号，因为混淆要求表型独立于技术因素；因此，如果病例组和对照组在 $PC1$ 上也存在差异，那么 $PC1$ 与运行批次的一致性不可能是批次效应。\n\nC. 在一个病例组和对照组均匀分布在各个批次中的完美平衡设计中，批次效应会因其构造而从PCA中消失，因此任何主成分上按表型的任何分离都必须是生物学上的。\n\nD. 一种影响平台特异性步骤上游分子的分析前扰动（例如，提取前处理延迟）预计会在转录组学、蛋白质组学和代谢组学中产生协调的批次结构；相比之下，如果只有转录组学显示 $PC1$ 与运行批次一致，而蛋白质组学和代谢组学则不然，这表明存在一个组学特异性的技术伪影，而不是跨组学的批次效应。\n\nE. 如果层次聚类首先按表型对样本进行分组，其次才按批次分组，这表明没有批次效应，因为聚类揭示了数据中存在的唯一主要变异来源。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知信息**\n\n-   **研究类型**：一项关于具有疾病表型的队列的多组学研究，涉及转录组学（RNA测序）、蛋白质组学（质谱）和代谢组学（质谱）。\n-   **概念框架**：分子生物学中心法则（DNA → RNA → 蛋白质 → 代谢物）。\n-   **变异来源**：生物学变异和技术变异。\n-   **关键概念**：批次效应，混淆。\n-   **样本信息**：$n$ 个人类样本，分类为病例组或对照组。\n-   **实验设计**：样本在 $b$ 个批次中处理（在不同日期进行的处理运行）。蛋白质组学和代谢组学数据在两台不同的仪器上采集。\n-   **质量控制 (QC)**：在每个批次和仪器运行中都使用了混合的QC参考品。\n-   **数据分析**：对每个组学层的归一化、对数转换后的数据进行了主成分分析（PCA）和基于欧几里得距离的层次聚类。\n-   **转录组学观察结果**：\n    -   $PC1$ 解释了约 $35\\%$ 的方差，并与测序批次一致。\n    -   $PC2$ 解释了约 $12\\%$ 的方差，并在批次内区分了病例组和对照组。\n    -   QC样本按其各自的测序批次进行聚类。\n-   **蛋白质组学观察结果**：\n    -   $PC1$ 解释了约 $28\\%$ 的方差，并与仪器身份一致。\n    -   来自同一仪器的QC样本聚在一起。\n    -   $PC2$ 在每台仪器内显示出病例-对照分离。\n-   **代谢组学观察结果**：\n    -   $PC1$ 解释了约 $30\\%$ 的方差，并与仪器身份和注入顺序一致。\n    -   QC样本根据注入顺序沿 $PC1$ 显示出一些分离。\n    -   $PC2$ 显示出病例-对照分离，但比转录组学弱。\n-   **元数据信息**：\n    -   实验设计不平衡：第一个测序批次中的病例组比例（约 $80\\%$）与对照组比例（约 $40\\%$）不同。\n    -   一台仪器上的注入顺序相对于表型是非随机的。\n-   **给出的定义**：\n    -   **批次效应**：与技术因素（运行批次、日期、试剂、仪器）相关的系统性、非生物学差异。\n    -   **混淆**：科学关注的变量（表型）与一个同样影响测量的技术因素在统计上相关。\n\n**步骤2：使用提取的已知信息进行验证**\n\n-   **科学基础**：该问题出色地立足于功能基因组学和生物信息学的现实挑战。所描述的情景，包括实验设计缺陷（不平衡的批次）和由此产生的数据结构（$PC1$ 上的批次效应、混淆），是一个经典且高度现实的问题。使用PCA、聚类和QC是诊断此类问题的标准方法。\n-   **适定性**：该问题是适定的。它提供了一个详细、自成体系的情景，并要求根据此情景和给出的定义对陈述进行评估。信息足以确定每个选项的正确性。\n-   **客观性**：语言技术性强、精确且客观。没有主观或模糊的术语。\n\n**步骤3：结论与行动**\n\n该问题陈述是有效的。它在科学上是合理的、适定的和客观的。该情景是用于教授高维生物数据分析中批次效应和混淆概念的教科书式例子。我将继续进行解答。\n\n***\n\n**选项分析**\n\n**A. 批次效应是与处理批次或仪器相关的系统性非生物学偏移；在转录组学中 $PC1$ 与测序批次的一致性，在蛋白质组学和代谢组学中与仪器的一致性，以及QC样本按批次或仪器聚类而不是所有QC聚在一起，这些都与显著的批次效应相符。**\n这一陈述由两部分组成。第一部分是批次效应的定义，与问题陈述中提供的定义以及公认的科学定义一致。第二部分解释了观察结果。PCA是一种降维技术，它找到主成分（$PC$），即捕获数据中最大方差的正交方向。$PC1$ 捕获了最大比例的方差。如果 $PC1$ 与处理批次或仪器等技术因素对齐，这意味着该技术因素是数据中主要的变异来源。这是批次效应的标志。此外，混合QC样本在技术上是相同的。在没有批次效应的情况下，无论它们在何时何地运行，都应该聚集在一起。观察到它们按批次（转录组学）或按仪器（蛋白质组学）聚类，这提供了明确的证据，表明处理批次/仪器正在引入系统性的、非生物学的变异。因此，该陈述是将定义正确应用于所提供证据的例子。\n**结论：正确。**\n\n**B. 在转录组学中观察到的病例组与对照组沿 $PC1$ 的分离证明了强烈的生物学信号，因为混淆要求表型独立于技术因素；因此，如果病例组和对照组在 $PC1$ 上也存在差异，那么 $PC1$ 与运行批次的一致性不可能是批次效应。**\n该陈述在关于混淆的推理中包含基本错误。问题明确将混淆定义为关注变量（表型）和技术因素（批次）之间的统计关联。该陈述错误地声称混淆要求独立性。元数据显示表型确实与批次相关：“在第一个测序批次中处理的病例组比例高于在该批次中处理的对照组比例”。因为 $PC1$ 与测序批次（批次效应）对齐，而批次又与表型相关，所以在数学上必然导致 $PC1$ 也将与表型相关。这并不能“证明一个强烈的生物学信号”；相反，它证明了生物学信号与技术信号相混淆，使得仅根据 $PC1$ 无法区分这两者。其结论恰恰是相反的：$PC1$ 同时与批次和表型对齐是混淆批次效应的经典标志。\n**结论：错误。**\n\n**C. 在一个病例组和对照组均匀分布在各个批次中的完美平衡设计中，批次效应会因其构造而从PCA中消失，因此任何主成分上按表型的任何分离都必须是生物学上的。**\n这个陈述是错误的。“完美平衡的设计”确保生物学因素（表型）与技术因素（批次）正交。这是消除*混淆*的关键步骤，从而可以无偏地评估生物学效应。然而，平衡设计并*不能*消除批次效应本身。与批次相关的技术变异仍然存在于数据矩阵中。PCA仍然会检测到这种变异。如果批次效应是最大的变异来源，它仍然会体现在 $PC1$ 上。平衡设计中的关键区别在于，这个代表批次效应的 $PC1$ 将与表型不相关。表型分离将出现在另一个正交的主成分上（例如，$PC2$）。“批次效应会从PCA中消失”的断言是错误的。它们只是与感兴趣的表型解耦了。\n**结论：错误。**\n\n**D. 一种影响平台特异性步骤上游分子的分析前扰动（例如，提取前处理延迟）预计会在转录组学、蛋白质组学和代谢组学中产生协调的批次结构；相比之下，如果只有转录组学显示 $PC1$ 与运行批次一致，而蛋白质组学和代谢组学则不然，这表明存在一个组学特异性的技术伪影，而不是跨组学的批次效应。**\n该陈述提出了一条正确且复杂的推理思路。一个分析前变量，例如在任何组学特异性制备之前的样本收集或处理，会影响整个样本。这样的因素会在该样本衍生的所有分子层（RNA、蛋白质、代谢物）中引入一个共享的技术变异结构。这将导致一个“协调的”批次结构，其中所有三个数据集中的主要变异轴将彼此相关，并与分析前因素相关。问题描述了不同的主要变异来源：转录组学的测序批次，以及蛋白质组学/代谢组学的仪器。这种不协调性有力地表明，主导的技术伪影并非来自共享的分析前来源，而是特定于各个分析平台的。这个推理是合理的。\n**结论：正确。**\n\n**E. 如果层次聚类首先按表型对样本进行分组，其次才按批次分组，这表明没有批次效应，因为聚类揭示了数据中存在的唯一主要变异来源。**\n这个陈述是错误的。层次聚类根据样本的总体相似性（或距离）将它们组织成一个树状图。树状图中的第一个、最高级别的分裂对应于最大的变异来源。如果这个分裂按表型分开了样本，这表明生物学信号强于任何技术伪影。然而，如果每个表型组内的后续、较低级别的分裂对应于批次，这明确表明数据中*存在*批次效应。它只是一个比表型小的变异来源。“这表明没有批次效应”的陈述是一个错误的结论。按批次的次级分组是批次效应存在的直接证据。\n**结论：错误。**", "answer": "$$\\boxed{AD}$$", "id": "2811821"}]}