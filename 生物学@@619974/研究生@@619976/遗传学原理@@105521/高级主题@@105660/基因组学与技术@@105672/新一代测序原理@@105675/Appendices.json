{"hands_on_practices": [{"introduction": "在任何测序项目的实验设计中，测序覆盖度都是一个基本参数。它代表基因组中每个碱基被测序的平均次数。对于规划实验以确保其具有足够的统计能力来进行变异检测或基因组组装而言，根据读长数 $N$、读长 $L$ 和基因组大小 $G$ 计算预期覆盖度是一项基础技能。这项练习将让你实践推导和应用这一核心关系。[@problem_id:2840991]", "problem": "一个实验室使用下一代测序 (NGS) 技术进行全基因组测序，从一个大小为 $G$ 碱基对 (bp) 的单倍体基因组中生成了 $N$ 个固定长度为 $L$ 的单端读长。覆盖深度是指覆盖基因组中一个随机选择的碱基的预期测序读长数，等效于每个碱基的平均测序冗余度。假设满足 Lander–Waterman 均匀随机抽样条件：读长的起始位置在基因组上是独立且均匀分布的，不存在位置偏好性，并且 $G \\gg L$，因此边缘效应可以忽略不计。\n\n仅从平均覆盖度等于测序得到的碱基总数除以基因组长度这一定义出发，推导在这些条件下预期覆盖深度的表达式。然后，对于从大小为 $G = 3.2 \\times 10^{9}$ bp 的基因组中测序得到的 $N = 5.5 \\times 10^{8}$ 个长度为 $L = 100$ bp 的读长，进行数值计算。将你的最终答案表示为一个无量纲数（无单位）。将最终的数值结果四舍五入到四位有效数字。", "solution": "在尝试进行任何解答之前，需对问题陈述进行严格验证。\n\n首先，我们逐字提取给定的量和定义。\n-   单端读长数量：$N$。\n-   每个读长的长度：$L$。\n-   单倍体基因组的大小：$G$。\n-   覆盖深度的定义：“覆盖基因组中一个随机选择的碱基的预期测序读长数，等效于每个碱基的平均测序冗余度”。\n-   假设：满足 Lander–Waterman 均匀随机抽样条件，具体而言，读长的起始位置是独立且均匀分布的，不存在位置偏好性，并且 $G \\gg L$。\n-   推导的起点：“平均覆盖度等于测序得到的碱基总数除以基因组长度”。\n-   用于计算的数值：$N = 5.5 \\times 10^{8}$，$L = 100$ bp，$G = 3.2 \\times 10^{9}$ bp。\n-   要求的输出格式：一个四舍五入到四位有效数字的无量纲数。\n\n接下来，我们基于这些提取的信息来验证问题。\n-   **科学依据**：该问题正确地基于基因组学和生物信息学的基本原理。Lander-Waterman 模型是测序理论的基石，而覆盖度的概念是所有测序实验的核心。所提供的数值对于一个典型的哺乳动物大小基因组的全基因组测序项目是符合实际的。\n-   **适定性**：该问题是适定的。它提供了所有必要的信息（$N$、$L$、$G$），明确陈述了操作所依据的假设，并指明了必须从中开始推导的精确定义。目标是明确的：推导一个表达式，然后计算一个指定精度的数值。\n-   **客观性**：该问题以精确、客观的语言陈述，没有任何主观性或模糊性。\n\n该问题不存在任何缺陷。它在科学上并非不合理、不完整、自相矛盾或不适定。其假设（$G \\gg L$、均匀抽样）是使问题易于处理的标准简化，并且已明确说明。该问题是有效的。我们现在开始进行解答。\n\n设 $C$ 表示预期的覆盖深度。问题要求我们从平均覆盖度是测序得到的碱基总数除以基因组长度这一定义出发。\n\n总读长数为 $N$。每个读长的长度为 $L$ 个碱基对。因此，测序得到的碱基总数是读长数量与每个读长长度的乘积。\n$$\n\\text{Total Sequenced Bases} = N \\times L\n$$\n\n基因组的大小为 $G$。\n\n根据所提供的基本定义，平均覆盖度 $C$ 是这两个量的比值：\n$$\nC = \\frac{\\text{Total Sequenced Bases}}{\\text{Genome Length}}\n$$\n\n将分子和分母的表达式代入，我们得到预期覆盖深度的解析表达式：\n$$\nC = \\frac{N \\times L}{G}\n$$\n问题的推导部分至此完成。该公式表示基因组中的一个碱基预期被测序的平均次数。$N$ 的单位是读长数（无量纲计数），$L$ 的单位是每个读长的碱基对数，$G$ 的单位是碱基对。因此，$C$ 的单位是无量纲的，这与其作为冗余因子的定义是一致的。\n\n现在，我们必须使用所提供的值对该表达式进行数值计算：\n-   $N = 5.5 \\times 10^{8}$\n-   $L = 100$\n-   $G = 3.2 \\times 10^{9}$\n\n将这些值代入推导出的公式中：\n$$\nC = \\frac{(5.5 \\times 10^{8}) \\times 100}{3.2 \\times 10^{9}}\n$$\n我们进行算术运算：\n$$\nC = \\frac{5.5 \\times 10^{10}}{3.2 \\times 10^{9}}\n$$\n$$\nC = \\frac{5.5}{3.2} \\times 10^{10-9}\n$$\n$$\nC = \\frac{55}{32} \\times 10^{1}\n$$\n$$\nC = 1.71875 \\times 10\n$$\n$$\nC = 17.1875\n$$\n问题要求将最终的数值结果四舍五入到四位有效数字。$17.1875$ 的前四位有效数字是 $1$、$7$、$1$ 和 $8$。第五位有效数字是 $7$，大于或等于 $5$，因此我们将第四位有效数字向上舍入。\n$$\nC \\approx 17.19\n$$\n这是一个无量纲的量，符合要求。该结果表明，平均而言，基因组中的每个碱基被大约 $17.19$ 个读长所覆盖。", "answer": "$$\\boxed{17.19}$$", "id": "2840991"}, {"introduction": "原始测序数据很少是完美的，常常包含来自文库制备过程的技术性杂质。在进行任何下游分析之前，一个至关重要的步骤是质量控制（QC），以识别并去除这些杂质。本实践问题提出了一个经典的现实世界场景：对一个被接头二聚体（adapter-dimers）污染的文库进行故障排除，要求你将实验观察结果与其分子层面的原因联系起来，并选择合适的计算过滤策略。[@problem_id:2417424]", "problem": "一次双末端下一代测序 (NGS) 运行产生了高比例的、主要由已知接头基序组成的读段。质量控制报告表明，许多读段从起始位置就含有大量接头序列，并且在去除接头后，许多读段的插入片段长度可以忽略不计。在文库构建的哪个步骤中最可能产生这些序列？以及在进行下游分析之前，哪种计算策略最适合用于去除它们？\n\nA. 在接头连接步骤中，过量的接头分子导致了接头-接头连接产物的形成，并且连接后的大小筛选不充分，使得这些短的构建体得以保留；在计算上，使用已知的接头序列对每个读段（或读段对）进行接头感知剪切，然后丢弃任何剪切后插入片段长度低于最小阈值 $\\ell_{\\min}$ 的读段或读段对，这表明该序列主要由接头组成。\n\nB. 机械剪切过程中的过度片段化产生了超短的插入片段；在计算上，提高碱基质量剪切的阈值，以便丢弃平均 Phred 质量低于截断值 $Q_{\\min}$ 的读段。\n\nC. 簇扩增过程中的 Index hopping（文库标签跳跃）产生了虚假的嵌合读段；在计算上，通过将允许的 Index 错配数 $m_{\\max}$ 减少到接近于零，以更严格的条形码错配容忍度进行拆分。\n\nD. 不完整的末端修复产生了发夹状分子，导致测序异常；在计算上，将所有读段比对到参考基因组上，并丢弃在允许最多 $k$ 个错配后仍未比对上的任何读段。\n\nE. 聚合酶链式反应 (PCR) 过程中的引物二聚体形成产生了短的扩增子；在计算上，通过将具有相同 $k$-mer 特征谱的读段折叠成一个代表性序列来移除高丰度的 $k$-mers。", "solution": "必须首先确定问题陈述的有效性。\n\n### 第一步：提取已知信息\n问题提供了一次双末端下一代测序 (NGS) 运行的以下观察结果：\n1.  高比例的读段主要由已知的接头基序组成。\n2.  质量控制报告表明许多读段从起始位置就含有大量接头内容。\n3.  去除接头后，许多读段的插入片段长度可以忽略不计。\n\n问题要求找出在文库构建阶段导致这些观察结果的最可能原因，以及在下游分析前去除这些人为产物序列的最合适计算策略。\n\n### 第二步：使用提取的已知信息进行验证\n现在将评估问题陈述的科学有效性和清晰度。\n- **科学依据**：所述情景是 NGS 文库制备中一个典型且常见的产物。所呈现的概念——双末端测序、接头基序、质量控制、插入片段长度、接头连接、大小筛选以及各种计算过滤策略——在基因组学和生物信息学领域是基础且公认的。这些观察结果与所谓的“接头二聚体”（adapter-dimers）的形成相一致。这不是推测。\n- **适定性**：这个问题是适定的。这些观察结果强烈指向一个特定的分子产物，问题要求确定其生成机制和相应的校正计算程序。在该学科中存在一个标准、唯一且广为接受的答案。\n- **客观性**：语言是技术性和客观的。诸如“高比例”、“大量接头内容”和“可忽略的插入片段长度”等短语是源自常见 QC 软件（例如 FastQC）输出的标准描述符。没有歧义或主观性。\n\n### 第三步：结论与行动\n问题陈述在科学上是合理的、适定的和客观的。它基于实验基因组学中一个现实且常见的情景。因此，该问题是**有效的**。将推导出一个完整的解决方案。\n\n### 推导与选项分析\n\n提供的观察结果必须与文库制备中的某个机制有逻辑上的联系。\n1.  **“许多读段从起始位置就含有接头内容”**：在标准测序文库中，读段从 DNA 插入片段的 5' 端开始。接头序列被连接到该插入片段的末端。因此，接头序列只应出现在读段的 3' 端，并且仅当 DNA 插入片段短于测序读段长度时（这种现象称为“读穿”，read-through）。在读段的起始位置（5' 端）出现接头序列表明测序过程直接从一个接头分子开始，而不是从一个 DNA 插入片段开始。\n2.  **“高比例的读段主要由已知的接头基序组成”和“去除接头后插入片段长度可忽略不计”**：这两点加强了第一点。如果一个读段几乎完全由接头序列组成，那么在计算上去除此接头序列后，剩余的“插入片段”长度将接近于零。高丰度表明文库制备过程中存在系统性问题。\n\n唯一能产生由两个接头连接在一起的测序模板的合理解释是**接头二聚体**（adapter-dimers）的形成。这发生在接头连接步骤中。如果接头分子的摩尔浓度相对于 DNA 片段的浓度过高，连接酶更有可能将两个接头分子连接在一起，而不是将一个接头连接到一个 DNA 片段上。这些接头二聚体构建体很短，通常在 $120$ 到 $150$ 个碱基对之间。\n\n文库制备中的一个后续步骤是大小筛选，其目的是富集期望的片段大小分布（例如，$300$-$500$ 碱基对）并消除非常短的片段。如果此大小筛选步骤执行得不理想或不够严格，这些短的接头二聚体构建体将保留在最终文库中，被 PCR 扩增并测序。\n\n纠正此问题的计算策略必须专门针对这些人为产物读段。该策略包括两个方面：\n1.  **识别**：使用接头剪切工具（例如 `cutadapt`、`Trimmomatic`）和已知的接头序列来识别并从所有读段中移除接头内容。\n2.  **过滤**：剪切后，源自接头二聚体的读段将变得非常短。因此，必须应用长度过滤器，如果剩余序列的长度低于指定的最小阈值 $\\ell_{\\min}$，则丢弃任何读段（或者在这种双末端情况下，丢弃整个读段对）。\n\n现在，将根据这个推导出的理解来评估每个选项。\n\n**A. 在接头连接步骤中，过量的接头分子导致了接头-接头连接产物的形成，并且连接后的大小筛选不充分，使得这些短的构建体得以保留；在计算上，使用已知的接头序列对每个读段（或读段对）进行接头感知剪切，然后丢弃任何剪切后插入片段长度低于最小阈值 $\\ell_{\\min}$ 的读段或读段对，这表明该序列主要由接头组成。**\n这个选项正确地指出了原因：由过量接头浓度导致的接头二聚体形成，然后通过大小筛选未能充分去除。所提出的计算策略——接头剪切后基于最小长度阈值 $\\ell_{\\min}$ 进行过滤——正是去除这些人为产物的标准且最有效的方法。\n**结论：正确。**\n\n**B. 机械剪切过程中的过度片段化产生了超短的插入片段；在计算上，提高碱基质量剪切的阈值，以便丢弃平均 Phred 质量低于截断值 $Q_{\\min}$ 的读段。**\n这个原因与证据不符。超短插入片段会导致在读段的 3' 端出现接头读穿，而不是在 5' 端起始位置出现接头内容。计算策略也是错误的。问题在于序列内容（接头与插入片段），而非碱基质量。虽然质量可以作为某些问题的代理指标，但它在这里不是直接的解决方案。基于平均质量截断值 $Q_{\\min}$ 丢弃读段不会专门针对接头二聚体。\n**结论：错误。**\n\n**C. 簇扩增过程中的 Index hopping（文库标签跳跃）产生了虚假的嵌合读段；在计算上，通过将允许的 Index 错配数 $m_{\\max}$ 减少到接近于零，以更严格的条形码错配容忍度进行拆分。**\n这描述了一个完全不同的人为产物。Index hopping（或 index 错配）导致在拆分过程中，一个样本的读段被错误地分配给另一个样本。它不会产生完全由接头序列组成的读段。原因和提出的解决方案与所描述的问题无关。\n**结论：错误。**\n\n**D. 不完整的末端修复产生了发夹状分子，导致测序异常；在计算上，将所有读段比对到参考基因组上，并丢弃在允许最多 $k$ 个错配后仍未比对上的任何读段。**\n不完整的末端修复或 A-加尾会导致连接效率降低，从而导致文库产量降低，而不是产生高丰度的特定产物。所提出的计算策略也不是最优的。使用比对作为筛选接头二聚体的主要过滤器，计算成本高昂，并且预设了参考基因组的存在。标准工作流程是在比对*之前*进行接头/质量剪切和过滤。\n**结论：错误。**\n\n**E. 聚合酶链式反应 (PCR) 过程中的引物二聚体形成产生了短的扩增子；在计算上，通过将具有相同 $k$-mer 特征谱的读段折叠成一个代表性序列来移除高丰度的 $k$-mers。**\n虽然引物二聚体可以在 PCR 过程中形成，但问题指明读段主要由“已知的接头基序”组成。在这种情况下，“接头”通常指的是连接接头，而不是在接头上某个位点退火的 PCR 引物。接头二聚体在连接过程中形成，这是在 PCR 之前。所描述的计算策略是一种基于 $k$-mer 计数的数字归一化或错误校正形式，而不是去除接头污染的标准程序。目标是完全移除这些人为产物读段，而不是将它们折叠成一个单一的代表性序列。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2417424"}, {"introduction": "在将短读长组装成更长的连续序列（contigs）之后，一个关键问题是：“我的组装质量如何？”NG50统计量是一个广泛使用的度量标准，用于量化基因组组装的连续性，它提供了一个单一的数值来概括基因组中有多少部分包含在大型重叠群中。这项练习将指导你一步步计算NG50，这对于任何评估基因组组装质量的人来说都是一项实用技能。[@problem_id:2417502]", "problem": "一个源自新一代测序 (NGS) 的基因组组装草图包含了一系列重叠群，其长度分别为 $\\{100, 50, 20, 5, 5\\}$ 千碱基对 (kbp)。估计的单倍体基因组大小为 $150$ 千碱基对 (kbp)。NG50统计量的定义如下：给定一个估计的基因组大小 $G$，将所有重叠群按长度非递增顺序排序，并计算从最长到最短的累计总和；NG50是指当累计总和首次等于或超过 $\\frac{1}{2}G$ 时的那个重叠群的长度 $L$。计算此组装的NG50值。答案以千碱基对 (kbp) 为单位。在你的解答中不要使用任何百分号。", "solution": "对问题陈述进行验证。\n\n逐字提取已知条件如下：\n1.  一组重叠群长度：$\\{100, 50, 20, 5, 5\\}$ 千碱基对 (kbp)。\n2.  估计的单倍体基因组大小：$150$ 千碱基对 (kbp)。\n3.  NG50的定义：给定一个估计的基因组大小 $G$，将所有重叠群按长度非递增顺序排序，并计算从最长到最短的累计总和；NG50是指当累计总和首次等于或超过 $\\frac{1}{2}G$ 时的那个重叠群的长度 $L$。\n\n验证结论：\n问题是有效的。它具有科学依据，因为它涉及NG50统计量的计算，这是生物信息学中用于评估基因组组装连续性的一项标准且定义明确的指标。该问题提法得当，提供了所有必要的数据和一个清晰、无歧义的定义，可以得出一个唯一的解。所提供的数据是自洽且符合实际的。该问题是客观的，并且没有任何逻辑或事实上的缺陷。\n\n我们开始进行解答。\n\n任务是为一个给定的基因组组装草图计算NG50统计量。\n给定的重叠群长度集合为 $C = \\{100, 50, 20, 5, 5\\}$，单位为千碱基对 (kbp)。\n估计的单倍体基因组大小为 $G = 150$ kbp。\n\nNG50的定义要求我们找到一个重叠群长度 $L$，它使得重叠群长度的累计总和达到或超过估计基因组大小的 $50\\%$。为了进行此计算，必须将重叠群按长度降序排列。\n\n首先，我们计算目标累计长度，即估计基因组大小的一半：\n$$\n\\text{Target Sum} = \\frac{1}{2} G = \\frac{1}{2} \\times 150 \\text{ kbp} = 75 \\text{ kbp}\n$$\n\n接下来，我们将给定的重叠群长度按非递增（降序）顺序排序。所提供的列表已经是排好序的：\n$L = [100, 50, 20, 5, 5]$。\n\n现在，我们从最长的重叠群开始计算这些长度的累计总和，并在每一步检查总和是否达到或超过 $75$ kbp 的目标。\n\n令 $l_i$ 为排序后列表中第 $i$ 个重叠群的长度。\n令 $S_k$ 为前 $k$ 个重叠群长度的累计总和，$S_k = \\sum_{i=1}^{k} l_i$。我们在寻找满足 $S_k \\ge 75$ 的最小整数 $k$。那么NG50就是第 $k$ 个重叠群的长度，即 $l_k$。\n\n步骤1：考虑第一个（最长的）重叠群。\n其长度为 $l_1 = 100$ kbp。\n累计总和为 $S_1 = l_1 = 100$ kbp。\n\n我们检查累计总和是否满足条件：\n$S_1 \\ge 75$ kbp 吗？\n$100 \\ge 75$。是的，条件满足。\n\n由于第一个重叠群就满足了条件，计算过程在此停止。索引 $k$ 为 $1$。NG50统计量被定义为这个特定重叠群的长度，$l_k$，也就是 $l_1$。\n\n因此，该组装的NG50是第一个重叠群的长度。\n$$\n\\text{NG50} = l_1 = 100 \\text{ kbp}\n$$\n问题要求答案以千碱基对为单位表示。计算出的值为 $100$。", "answer": "$$\n\\boxed{100}\n$$", "id": "2417502"}]}