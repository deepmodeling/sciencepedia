{"hands_on_practices": [{"introduction": "在开启任何一项古DNA测序项目之前，一个至关重要的步骤是进行严谨的实验设计。研究人员必须估算所需的测序量，以确保能够以合理的成本获得足够高质量的数据来回答其科学问题。这项练习将引导您完成一个核心的实际计算，将目标基因组的有效覆盖度、样本中内源性DNA的预期含量以及测序文库的复杂性等关键参数联系起来，从而确定需要生成的原始测序读数总量 [@problem_id:2691892]。这是一个贯穿古基因组学研究规划阶段的基本技能。", "problem": "在古DNA（aDNA）测序项目中，规划测序深度需要将预期的内源性含量、重复率和读长与目标基因组的有效唯一覆盖度联系起来。考虑一次读长为 $75 \\ \\mathrm{bp}$ 的单端Illumina测序，目标基因组大小为 $3 \\times 10^{9} \\ \\mathrm{bp}$。您的目标是在目标基因组上达到 $0.5\\times$ 的去重后有效覆盖度。预实验数据表明内源性含量为 $0.05$（即原始读段中有 $0.05$ 的比例来源于目标分类单元），文库复杂度表明 $0.30$ 的内源性读段将被标记为重复，并在去重过程中被移除。\n\n假设以下与古基因组学实践一致的标准近似：\n- 覆盖度定义为比对到目标上的唯一碱基总数除以单倍体基因组大小。\n- 内源性比例均匀适用于所有原始读段，并且所有内源性读段都能以 $75 \\ \\mathrm{bp}$ 的完整可用长度正确比对。\n- 去重过程移除了 $0.30$ 比例的内源性读段，留下 $0.70$ 比例的内源性读段作为唯一读段。污染读段不提供任何目标覆盖度。\n- 对于本计算，因接头修剪、碱基质量过滤以及上述假设之外的比对失败所造成的损失可以忽略不计。\n\n在这些假设下，计算达到目标有效覆盖度所需的原始读段数量。以读段数量表示最终答案，并四舍五入到三位有效数字。", "solution": "对问题陈述进行验证。\n\n逐字提取给定条件：\n- 读长: $L = 75 \\ \\mathrm{bp}$\n- 基因组大小: $G = 3 \\times 10^{9} \\ \\mathrm{bp}$\n- 目标去重后有效覆盖度: $C_{eff} = 0.5\\times$\n- 内源性含量: $f_{endo} = 0.05$\n- 内源性读段的重复比例: $f_{dup} = 0.30$\n- 内源性读段的唯一比例: $1 - f_{dup} = 1 - 0.30 = 0.70$\n- 覆盖度定义：比对到目标上的唯一碱基总数除以单倍体基因组大小。\n- 假设：内源性比例是均匀的；所有内源性读段均以全长 $L$ 进行比对；去重移除比例为 $f_{dup}$ 的读段；其他损失可忽略不计。\n- 要求输出：所需的原始读段数量，四舍五入到三位有效数字。\n\n验证结论：该问题有效。它在科学上基于基因组学和测序分析的原理，提供了一个具有现实参数的、适定、客观且自洽的定量问题。它没有违反任何无效性标准。所提供的假设是古基因组学中用于此类初步计算的标准简化方法。\n\n求解过程如下。\n\n设 $N_{raw}$ 为所需的原始读段总数。\n目标有效覆盖度 $C_{eff}$ 定义为唯一的、比对到目标上的碱基总数（我们称之为 $B_{eff}$）除以基因组大小 $G$。\n$$C_{eff} = \\frac{B_{eff}}{G}$$\n由此，达到目标覆盖度所需的有效碱基总数为：\n$$B_{eff} = C_{eff} \\times G$$\n现在，我们必须将 $B_{eff}$ 与原始读段总数 $N_{raw}$ 联系起来。这个过程涉及反映数据处理流程的几个步骤。\n\n首先，原始读段总数 $N_{raw}$ 乘以内源性含量比例 $f_{endo}$，以确定源自目标基因组的读段数量 $N_{endo}$。\n$$N_{endo} = N_{raw} \\times f_{endo}$$\n其次，这些内源性读段需要进行去重处理。其中比例为 $f_{dup}$ 的读段被识别为重复并被移除。剩余的唯一读段比例为 $(1 - f_{dup})$。因此，唯一内源性读段的数量 $N_{unique}$ 为：\n$$N_{unique} = N_{endo} \\times (1 - f_{dup}) = N_{raw} \\times f_{endo} \\times (1 - f_{dup})$$\n根据问题的假设，每个唯一内源性读段都以其全长 $L$ 贡献给有效碱基总数。因此，有效碱基总数 $B_{eff}$ 可以表示为：\n$$B_{eff} = N_{unique} \\times L = N_{raw} \\times f_{endo} \\times (1 - f_{dup}) \\times L$$\n我们现在有两个关于 $B_{eff}$ 的表达式。通过令它们相等，我们可以构建一个方程来求解未知量 $N_{raw}$。\n$$C_{eff} \\times G = N_{raw} \\times f_{endo} \\times (1 - f_{dup}) \\times L$$\n整理方程以求解 $N_{raw}$：\n$$N_{raw} = \\frac{C_{eff} \\times G}{f_{endo} \\times (1 - f_{dup}) \\times L}$$\n现在，我们将给定值代入此表达式：\n- $C_{eff} = 0.5$\n- $G = 3 \\times 10^{9}$\n- $f_{endo} = 0.05$\n- $f_{dup} = 0.30$\n- $L = 75$\n\n$$N_{raw} = \\frac{0.5 \\times (3 \\times 10^{9})}{0.05 \\times (1 - 0.30) \\times 75}$$\n我们分别计算分子和分母。\n分子：\n$$0.5 \\times 3 \\times 10^{9} = 1.5 \\times 10^{9}$$\n分母：\n$$0.05 \\times (1 - 0.30) \\times 75 = 0.05 \\times 0.70 \\times 75 = 0.035 \\times 75 = 2.625$$\n现在，我们进行除法运算：\n$$N_{raw} = \\frac{1.5 \\times 10^{9}}{2.625}$$\n$$N_{raw} = \\frac{1500}{2625} \\times 10^{9} = \\frac{4}{7} \\times 10^{9} \\approx 0.57142857... \\times 10^{9}$$\n为了用标准科学计数法表示，我们写作：\n$$N_{raw} \\approx 5.7142857... \\times 10^{8}$$\n问题要求答案四舍五入到三位有效数字。\n$$N_{raw} \\approx 5.71 \\times 10^{8}$$\n这就是在给定条件下，为达到指定有效覆盖度目标所必须生成的原始测序读段总数。", "answer": "$$\\boxed{5.71 \\times 10^8}$$", "id": "2691892"}, {"introduction": "古DNA分析中最臭名昭著的挑战之一是区分真实的遗传变异与DNA降解产生的“伪影”。胞嘧啶（C）脱氨是DNA死后损伤最常见的形式，它在测序结果中会被误读为胸腺嘧啶（T），从而凭空制造出C到T的单核苷酸多态性（SNP）。这项练习旨在通过建立一个量化指标来解决这个问题，挑战您将链偏向性的诊断思路形式化为一个精确的数学表达式，这在计算生物学中是一项核心技能 [@problem_id:1468882]。通过这种方式，我们可以利用数据的内在统计特性，来揭示哪些变异可能是化学损伤的产物，而非真实的生物信号。", "problem": "在古基因组学领域，一个重大挑战是如何区分真实的遗传变异与死后DNA损伤。这类损伤最常见的形式之一是胞嘧啶（C）脱氨变成尿嘧啶（U）。在研究痕量古代DNA所必需的聚合酶链式反应（PCR）扩增过程中，DNA聚合酶会将这种U读取为胸腺嘧啶（T）。因此，古代生物DNA中的一个C碱基可能被测序仪错误地报告为一个T碱基，从而模拟出C到T的单核苷酸多态性（SNP）。\n\nDNA的双链特性使这个问题更加复杂。如果反向链上的一个C发生脱氨，其在正向链上的原始配对碱基是鸟嘌呤（G）。反向链上受损的C到U的变化将被读取为T，而生物信息学分析流程会推断其在正向链上的互补碱基为腺嘌呤（A）。因此，根据损伤发生在在哪条链上，C的脱氨损伤在最终的测序数据中可能表现为C到T或G到A的替换。\n\n识别这些损伤假象的一个关键诊断方法是检查链偏好性。一个真正的杂合SNP应该存在于源自正向链和反向链的DNA片段上。相比之下，由损伤引起的替换是一种化学假象，在给定位置上，它更有可能在一条链上比另一条链上累积。\n\n考虑这样一个场景：您正在分析一个古代DNA样本中的单个核苷酸位置。参考基因组在该位置有一个鸟嘌呤（G），但您的测序读数显示出‘G’和‘A’两种碱基的混合。计数如下：\n- $n_{f,A}$：比对到正向链且显示为‘A’的读数数量。\n- $n_{f,G}$：比对到正向链且显示为‘G’的读数数量。\n- $n_{r,A}$：比对到反向链且显示为‘A’的读数数量。\n- $n_{r,G}$：比对到反向链且显示为‘G’的读数数量。\n\n为了量化‘A’碱基的链偏好程度，我们定义一个自定义的“不对称性得分”，$S_{bias}$。该得分定义为：在正向链上观察到的‘A’读数比例与无偏好性假设下的预期比例之间的绝对差，再用该预期比例进行归一化。\n- 观察比例，$F_{obs}$，是所有观察到的‘A’读数中映射到正向链的比例。\n- 预期比例，$F_{exp}$，是所有读数（任何碱基）中映射到正向链的比例。这代表了在没有任何链偏好性的情况下，‘A’读数分布的基线期望。\n\n因此，不对称性得分由 $S_{bias} = \\frac{|F_{obs} - F_{exp}|}{F_{exp}}$ 给出。\n\n请根据四个测量量 $n_{f,A}$、$n_{f,G}$、$n_{r,A}$ 和 $n_{r,G}$，推导出一个 $S_{bias}$ 的单一闭合形式解析表达式。", "solution": "目标是利用所提供的计数，为不对称性得分 $S_{bias}$ 推导出一个闭合形式的表达式。该得分的公式为 $S_{bias} = \\frac{|F_{obs} - F_{exp}|}{F_{exp}}$。我们需要根据给定的变量找出 $F_{obs}$ 和 $F_{exp}$ 的表达式。\n\n首先，让我们基于四个基本测量值定义中间的总计数：\n- 显示为‘A’的总读数数量为 $N_A = n_{f,A} + n_{r,A}$。\n- 显示为‘G’的总读数数量为 $N_G = n_{f,G} + n_{r,G}$。\n- 比对到正向链的总读数数量为 $N_f = n_{f,A} + n_{f,G}$。\n- 比对到反向链的总读数数量为 $N_r = n_{r,A} + n_{r,G}$。\n- 覆盖此位置的总读数数量为 $N_{total} = N_f + N_r = n_{f,A} + n_{f,G} + n_{r,A} + n_{r,G}$。\n\n现在，我们可以根据问题陈述中的定义，为 $F_{obs}$ 和 $F_{exp}$ 构建表达式。\n\n步骤 1：确定 $F_{obs}$ 的表达式。\n$F_{obs}$ 是在正向链上发现的所有‘A’读数的观察比例。这是正向链上的‘A’读数数量除以‘A’读数的总数。\n$$F_{obs} = \\frac{n_{f,A}}{N_A} = \\frac{n_{f,A}}{n_{f,A} + n_{r,A}}$$\n\n步骤 2：确定 $F_{exp}$ 的表达式。\n$F_{exp}$ 是在无偏好性假设下，正向链上‘A’读数的预期比例。问题将其定义为映射到正向链的所有读数的总比例。这是正向链的总读数数量除以所有读数的总数。\n$$F_{exp} = \\frac{N_f}{N_{total}} = \\frac{n_{f,A} + n_{f,G}}{n_{f,A} + n_{f,G} + n_{r,A} + n_{r,G}}$$\n\n步骤 3：将 $F_{obs}$ 和 $F_{exp}$ 的表达式代入 $S_{bias}$ 的定义中。\n$$S_{bias} = \\frac{|F_{obs} - F_{exp}|}{F_{exp}} = \\frac{\\left| \\frac{n_{f,A}}{n_{f,A} + n_{r,A}} - \\frac{n_{f,A} + n_{f,G}}{n_{f,A} + n_{f,G} + n_{r,A} + n_{r,G}} \\right|}{\\frac{n_{f,A} + n_{f,G}}{n_{f,A} + n_{f,G} + n_{r,A} + n_{r,G}}}$$\n\n步骤 4：简化表达式。让我们从分子中绝对值内的差值开始。\n为了进行分数相减，我们找到一个公分母，即 $(n_{f,A} + n_{r,A})(n_{f,A} + n_{f,G} + n_{r,A} + n_{r,G})$。\n$$F_{obs} - F_{exp} = \\frac{n_{f,A}(n_{f,A} + n_{f,G} + n_{r,A} + n_{r,G}) - (n_{f,A} + n_{f,G})(n_{f,A} + n_{r,A})}{(n_{f,A} + n_{r,A})(n_{f,A} + n_{f,G} + n_{r,A} + n_{r,G})}$$\n现在，展开该表达式的分子：\n$$n_{f,A}(n_{f,A} + n_{f,G} + n_{r,A} + n_{r,G}) = n_{f,A}^2 + n_{f,A}n_{f,G} + n_{f,A}n_{r,A} + n_{f,A}n_{r,G}$$\n$$(n_{f,A} + n_{f,G})(n_{f,A} + n_{r,A}) = n_{f,A}^2 + n_{f,A}n_{r,A} + n_{f,G}n_{f,A} + n_{f,G}n_{r,A}$$\n将第二个展开项从第一个中减去：\n$$(n_{f,A}^2 + n_{f,A}n_{f,G} + n_{f,A}n_{r,A} + n_{f,A}n_{r,G}) - (n_{f,A}^2 + n_{f,A}n_{r,A} + n_{f,G}n_{f,A} + n_{f,G}n_{r,A})$$\n项 $n_{f,A}^2$、$n_{f,A}n_{f,G}$ 和 $n_{f,A}n_{r,A}$ 被抵消，剩下：\n$$n_{f,A}n_{r,G} - n_{f,G}n_{r,A}$$\n所以，差值为：\n$$F_{obs} - F_{exp} = \\frac{n_{f,A}n_{r,G} - n_{f,G}n_{r,A}}{(n_{f,A} + n_{r,A})(n_{f,A} + n_{f,G} + n_{r,A} + n_{r,G})}$$\n\n步骤 5：将这个简化的差值代回 $S_{bias}$ 的表达式中。\n$$S_{bias} = \\frac{\\left| \\frac{n_{f,A}n_{r,G} - n_{f,G}n_{r,A}}{(n_{f,A} + n_{r,A})(n_{f,A} + n_{f,G} + n_{r,A} + n_{r,G})} \\right|}{\\frac{n_{f,A} + n_{f,G}}{n_{f,A} + n_{f,G} + n_{r,A} + n_{r,G}}}$$\n我们可以消掉同时出现在分子分母和主分母分母中的项 $(n_{f,A} + n_{f,G} + n_{r,A} + n_{r,G})$。\n$$S_{bias} = \\frac{\\frac{|n_{f,A}n_{r,G} - n_{f,G}n_{r,A}|}{n_{f,A} + n_{r,A}}}{\\frac{n_{f,A} + n_{f,G}}{1}} = \\frac{|n_{f,A}n_{r,G} - n_{f,G}n_{r,A}|}{(n_{f,A} + n_{r,A})(n_{f,A} + n_{f,G})}$$\n这就是不对称性得分的最终简化闭合形式表达式。", "answer": "$$\\boxed{\\frac{|n_{f,A}n_{r,G} - n_{f,G}n_{r,A}|}{(n_{f,A} + n_{r,A})(n_{f,A} + n_{f,G})}}$$", "id": "1468882"}, {"introduction": "在识别了DNA损伤之后，理解其对最终科学结论的潜在影响同样重要。即使是少量未被校正的DNA损伤，也可能系统性地扭曲我们对古代种群遗传历史的推断。这项练习通过一个假设情景，让您亲手量化这种偏差，计算胞嘧啶脱氨损伤如何人为地改变群体遗传多样性的一个关键指标——核苷酸多样性（$\\pi$）[@problem_id:1908415]。通过这个计算，您将更深刻地理解为何在古基因组学分析中，对损伤伪影的严格处理是不可或缺的一步。", "problem": "一个古基因组学家团队正在使用古代DNA（aDNA）研究一个已灭绝的古人类种群的遗传多样性。他们已经从三个不同的个体中恢复了部分基因组序列。aDNA研究中的一个主要问题是死后化学降解。最常见的损伤形式是胞嘧啶脱氨作用，即胞嘧啶（C）碱基发生生物化学变化，在使用聚合酶链式反应（PCR）进行测序时，被错误地读取为胸腺嘧啶（T）。假设其他碱基（A、G、T）不受影响。\n\n该团队希望量化这种特定类型的测序伪影会如何影响他们对遗传多样性的估计。他们使用核苷酸多样性（用 $\\pi$ 表示），其定义为从样本中随机选择的任意两条序列之间每个位点的平均核苷酸差异数。对于一个包含 $N$ 条长度为 $L$ 的序列的样本，其计算公式为：\n$$ \\pi = \\frac{1}{\\binom{N}{2}} \\sum_{i<j} \\frac{d_{ij}}{L} $$\n其中 $d_{ij}$ 是序列 $i$ 和序列 $j$ 之间存在差异的核苷酸位点数，而 $\\binom{N}{2}$ 是不同序列对的总数。\n\n假设来自三个古代个体（$N=3$, $L=10$）的某一特定10个碱基对区域的“真实”（未受损）DNA序列如下：\n- 个体 1: `ATCGATCGAT`\n- 个体 2: `ATCGGTCGAT`\n- 个体 3: `ATGGATCGAT`\n\n假设在古代样本中，任何一个给定的胞嘧啶碱基都有一个恒定的概率 $p_d = 0.1$ 发生脱氨作用并被误读为胸腺嘧啶。\n\n计算测序（受损）样本的*期望*核苷酸多样性 $\\pi_{\\text{artifact}}$ 与真实（未受损）样本的核苷酸多样性 $\\pi_{\\text{true}}$ 之间的比值。将比值 $\\frac{\\pi_{\\text{artifact}}}{\\pi_{\\text{true}}}$ 的答案表示为一个四舍五入到三位有效数字的数值。", "solution": "我们使用核苷酸多样性 $\\pi$ 的定义\n$$\n\\pi=\\frac{1}{\\binom{N}{2}}\\sum_{i<j}\\frac{d_{ij}}{L}.\n$$\n对于 $N=3$ 和 $L=10$，$\\binom{3}{2}=3$，且 $\\sum_{i<j}d_{ij}$ 等于每个位点上差异对数量在所有位点上的总和。\n\n首先计算 $\\pi_{\\text{true}}$。三条真实的序列是：\n- 个体 1: ATCGATCGAT\n- 个体 2: ATCGGTCGAT\n- 个体 3: ATGGATCGAT\n\n逐个位点比较，差异仅出现在第 $3$ 和第 $5$ 位。在第 $3$ 位（C,C,G），差异对是 $(1,3)$ 和 $(2,3)$，总共有 $2$ 个差异对。在第 $5$ 位（A,G,A），差异对是 $(1,2)$ 和 $(2,3)$，总共有 $2$ 个差异对。所有其他位点贡献为 $0$。因此，所有位点的总差异对数为\n$$\nS_{\\text{true}}=2+2=4,\n$$\n所以\n$$\n\\pi_{\\text{true}}=\\frac{S_{\\text{true}}}{3L}=\\frac{4}{30}.\n$$\n\n现在计算损伤后差异对的期望数量。只有胞嘧啶会发生变化，每个胞嘧啶独立地以概率 $p_{d}=p$ 变为胸腺嘧啶。所有其他碱基保持不变。\n\n- 不含胞嘧啶的位点（第 $1,2,4,6,8,9,10$ 位）：贡献的期望差异对为 $0$（不变）。\n- 第 $5$ 位（A,G,A）：不含胞嘧啶；期望差异对数仍为 $2$。\n- 第 $3$ 位（C,C,G）：G 不受影响；每个 C 独立地以概率 $p$ 脱氨成 T。涉及 G 的对，即 $(1,3)$ 和 $(2,3)$，总是存在差异，贡献为 $2$。对 $(1,2)$ 存在差异当且仅当两个 C 中只有一个发生脱氨，其概率为 $2p(1-p)$。因此，该位点的期望差异对数为\n$$\n2+2p(1-p).\n$$\n- 第 $7$ 位（C,C,C）：三个 C 中每一个都独立地以概率 $p$ 脱氨成 T。设 $k$ 为损伤后 T 的数量，则 $k\\sim\\text{Binomial}(3,p)$。该位点的差异对数量等于 $k(3-k)$。因此\n$$\n\\mathbb{E}[\\text{在第7位的差异对数}]=\\mathbb{E}[k(3-k)]=3\\mathbb{E}[k]-\\mathbb{E}[k^{2}].\n$$\n已知 $E[k]=3p$ 且 $E[k^{2}]=\\operatorname{Var}(k)+E[k]^{2}=3p(1-p)+9p^{2}$，我们得到\n$$\n3(3p)-\\left(3p(1-p)+9p^{2}\\right)=6p-6p^{2}=6p(1-p).\n$$\n\n将所有位点的期望差异对数相加得到\n$$\nS_{\\text{artifact}}^{\\text{exp}}=\\bigl(2+2p(1-p)\\bigr)+2+6p(1-p)=4+8p(1-p).\n$$\n因此，\n$$\n\\pi_{\\text{artifact}}=\\frac{S_{\\text{artifact}}^{\\text{exp}}}{30}=\\frac{4+8p(1-p)}{30}.\n$$\n比值为\n$$\n\\frac{\\pi_{\\text{artifact}}}{\\pi_{\\text{true}}}=\\frac{\\frac{4+8p(1-p)}{30}}{\\frac{4}{30}}=\\frac{4+8p(1-p)}{4}=1+2p(1-p).\n$$\n代入 $p=0.1$ 得\n$$\n1+2(0.1)(1-0.1)=1+2(0.1)(0.9)=1+0.18=1.18.\n$$\n四舍五入到三位有效数字，比值为 $1.18$。", "answer": "$$\\boxed{1.18}$$", "id": "1908415"}]}