{"hands_on_practices": [{"introduction": "在进行任何四分体分析之前，首要任务是准确地对每个四分体进行分类。本练习将亲本双型（$PD$）、非亲本双型（$NPD$）和四分型（$T$）的基本定义转化为一个清晰的算法，从而巩固了这些核心概念。通过这个过程，你不仅能将理论知识付诸实践，还能体会到数据验证，特别是检验等位基因 $2:2$ 分离定律的重要性。[@problem_id:2864980]", "problem": "给定一个来自单次减数分裂的无序四分体，该生物体类似子囊菌，在两个双等位基因标记上是杂合的。设这两个基因座的等位基因表示为 $A/a$ 和 $B/b$，并假设减数分裂前的二倍体是由两个单倍体亲本 $AB$ 和 $ab$ 杂交形成的，因此合子处于连锁相 $AB/ab$。每个四分体表示为从集合 $\\{AB, Ab, aB, ab\\}$ 中抽取的 $4$ 个单倍体双基因座基因型的多重集。这四个孢子是无序的；也就是说，这 $4$ 个基因型的任意排列都表示同一个四分体。需要使用的基本事实是：(i) 在一个完整的四分体中，每个基因座的减数分裂分离产生 $2:2$ 的等位基因分布（即恰好有两个孢子携带 $A$，两个携带 $a$；同样，恰好有两个携带 $B$，两个携带 $b$），以及 (ii) 重组可以产生非亲本的双基因座组合 $Ab$ 和 $aB$。\n\n您的任务是设计一个程序，实现一种算法分类规则，将任何给定的四分体映射到以下类别之一，并按以下规定进行数字编码：\n- 亲本双型 (Parental Ditype, $PD$)：编码为 $0$。\n- 四分型 (Tetratype, $T$)：编码为 $1$。\n- 非亲本双型 (Nonparental Ditype, $NPD$)：编码为 $2$。\n- 无效 (在任一基因座上违反 $2:2$ 分离规则，或包含 $\\{A,a,B,b\\}$ 之外的符号)：编码为 $-1$。\n\n您实现的算法必须从上述基本事实出发，根据第一性原理推导得出。具体来说，您必须严格地仅根据观察到的 $4$ 个双基因座基因型的多重集以及每个基因座的 $2:2$ 分离约束来进行分类，而不依赖于现成的公式。您的程序必须：\n- 将四分体视为无序的（分类必须对孢子排列保持不变）。\n- 在分类前，验证每个基因座的 $2:2$ 分离约束；如果违反该约束，或者任何基因型的字符不属于 $\\{A,a,B,b\\}$ 或长度不完全为 $2$，则返回编码 $-1$。\n- 否则，当且仅当四分体恰好包含两个亲本基因型 $AB$ 和 $ab$（每个重复度为 $2$）时，将其映射为 $0$（亲本双型）；当且仅当它恰好包含两个非亲本基因型 $Ab$ 和 $aB$（每个重复度为 $2$）时，映射为 $2$（非亲本双型）；当且仅当它包含所有四种基因型 $\\{AB, Ab, aB, ab\\}$（每个重复度为 $1$）时，映射为 $1$（四分型）。\n\n测试套件和输出规范：\n- 按以下顺序使用固定的 $5$ 个四分体作为测试套件：\n    $1.$ $\\{AB, AB, ab, ab\\}$。\n    $2.$ $\\{Ab, Ab, aB, aB\\}$。\n    $3.$ $\\{AB, Ab, aB, ab\\}$。\n    $4.$ $\\{AB, AB, Ab, ab\\}$。\n    $5.$ $\\{AB, ab, aB, aX\\}$。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的、逗号分隔的整数列表，且无空格。例如，形如 $[r_1,r_2,r_3,r_4,r_5]$ 的输出，其中每个 $r_i$ 是测试用例 $i$ 的编码。\n- 此问题不涉及物理单位或角度。所有结果均为整数。\n\n您的实现必须是一个完整的、可运行的程序，执行时仅产生最终所需的输出行。", "solution": "该问题陈述有效。它在科学上基于减数分裂遗传学的原理，在数学上是适定的，并且用客观、明确的语言定义。它没有违反任何无效标准。因此，我将从第一性原理出发，提供一个解决方案。\n\n任务是为来自基因型为 $AB/ab$ 的二倍体合子的无序减数分裂四分体构建一个分类算法。该分类必须区分亲本双型 ($PD$)、非亲本双型 ($NPD$)、四分型 ($T$) 和无效四分体。\n\n**从第一性原理推导算法**\n\n在尝试任何分类之前，算法必须首先强制执行遗传学的基本约束和问题的定义。这就建立了一个逻辑层次：验证先于分类。\n\n**1. 验证阶段：强制执行生物学和形式上的正确性**\n\n设输入四分体为一个由四个双基因座基因型组成的多重集，$T = \\{g_1, g_2, g_3, g_4\\}$。\n\n- **形式有效性**：问题将基因型定义为双字符字符串。第一个字符必须来自集合 $\\{A, a\\}$，第二个字符必须来自集合 $\\{B, b\\}$。任何偏离此格式的情况，例如不正确的字符串长度或出现未定义的符号（如“$X$”），都构成形式上的违规。根据问题的规范，这样的输入不是一个有效的四分体，必须被拒绝。\n\n- **生物学有效性（$2:2$ 分离定律）**：单个杂合基因座减数分裂的基石是分离定律，该定律规定一个完整的四分体必须包含 $2:2$ 的等位基因比例。对于所讨论的两个基因座，这转化为四个严格的条件。设 $C(x)$ 为四分体中所有四个孢子中等位基因 $x$ 的总数。这些条件是：\n$$\nC(A) = 2 \\quad \\land \\quad C(a) = 2\n$$\n$$\nC(B) = 2 \\quad \\land \\quad C(b) = 2\n$$\n如果这四个等式中的任何一个不满足，该四分体就代表非整倍性或其他减数分裂错误，或者仅仅是一个格式错误的输入。在任何一种情况下，它都被归类为无效（编码 -1）。\n\n算法必须首先遍历给定的四个基因型，验证其形式结构，并同时计算总的等位基因数 $C(A), C(a), C(B), C(b)$。如果任何检查失败，则过程终止并返回 -1。\n\n**2. 分类阶段：有效四分体的分析**\n\n成功通过验证阶段的四分体是符合 $2:2$ 分离规则的合法减数分裂产物。它被分为 $PD$、$NPD$ 或 $T$ 的依据是其包含的亲本型 ($AB, ab$) 和非亲本型 ($Ab, aB$) 基因型的构成。\n\n通过分析一个有效四分体可以包含的不同基因型*类型*的数量，可以得出一个关键的见解。\n- **一种不同类型**：一个 $\\{g, g, g, g\\}$ 形式的四分体不能满足 $2:2$ 规则。例如，$\\{AB, AB, AB, AB\\}$ 得到 $C(A)=4$，而不是 $2$。所以这是不可能的。\n- **三种不同类型**：对于不同的 $g_1, g_2, g_3$，一个 $\\{g_1, g_1, g_2, g_3\\}$ 形式的四分体也不能满足 $2:2$ 规则。如果我们令 $g_1=AB$，前两个孢子贡献的计数为 $C(A)=2, C(B)=2$。为了满足总体的 $2:2$ 规则，剩下的孢子 $g_2, g_3$ 必须贡献 $C(a)=2, C(b)=2$，这意味着 $g_2=ab$ 且 $g_3=ab$。这迫使四分体成为 $\\{AB, AB, ab, ab\\}$，它只有两种不同的类型，这是一个矛盾。所以，三种不同类型是不可能的。\n\n因此，任何有效的四分体必须恰好包含**两种**或**四种**不同的基因型类型。这一关键推论为分类提供了一个稳健的框架。\n\n- **情况 1：四种不同的基因型**\n  如果一个四分体包含四种不同的基因型，并且鉴于孢子总数为四，它必须是多重集 $\\{AB, Ab, aB, ab\\}$，其中每种基因型都以重复度 $1$ 出现。这是**四分型 ($T$)**的定义。我们可以验证它是有效的：$C(A)$ 来自 $AB$ 和 $Ab$，所以 $C(A)=2$。$C(a)$ 来自 $aB$ 和 $ab$，所以 $C(a)=2$。同样，$C(B)=2$ 和 $C(b)=2$。这样的四分体被分类为 $T$（编码 $1$）。\n\n- **情况 2：两种不同的基因型**\n  如果一个四分体包含两种不同的基因型，其形式必须是 $\\{g_1, g_1, g_2, g_2\\}$。为了满足两个基因座的 $2:2$ 规则，基因型 $g_1$ 和 $g_2$ 必须是互补的。例如，如果 $g_1=AB$，其贡献是 $1A, 1B$。为了达到 $2A, 2a, 2B, 2b$ 的目标，两个 $g_2$ 型孢子必须共同贡献 $1A, 2a, 1B, 2b$。这是不可能的。相反，两个 $g_1$ 孢子贡献 $2A, 2B$。那么两个 $g_2$ 孢子必须贡献 $0A, 2a, 0B, 2b$，这意味着 $g_2=ab$。因此，唯一可能的基因型对是 $(AB, ab)$ 和 $(Ab, aB)$。这导致两种子情况：\n  - **亲本双型 ($PD$)**：两种基因型是亲本类型 $\\{AB, ab\\}$。四分体是 $\\{AB, AB, ab, ab\\}$。这被分类为 $PD$（编码 $0$）。\n  - **非亲本双型 ($NPD$)**：两种基因型是非亲本类型 $\\{Ab, aB\\}$。四分体是 $\\{Ab, Ab, aB, aB\\}$。这被分类为 $NPD$（编码 $2$）。\n\n**最终算法结构**\n1.  实现验证检查（形式和生物学上的）。如果失败，返回 $-1$。\n2.  如果四分体有效，则计算四种可能基因型的重复度：$N_{AB}, N_{Ab}, N_{aB}, N_{ab}$。\n3.  根据这些计数应用互斥的分类规则。\n    - 如果 $N_{AB}=2$ 且 $N_{ab}=2$，返回 $0$ ($PD$)。\n    - 如果 $N_{Ab}=2$ 且 $N_{aB}=2$，返回 $2$ ($NPD$)。\n    - 如果 $N_{AB}=1, N_{Ab}=1, N_{aB}=1, N_{ab}=1$，返回 $1$ ($T$)。\n此过程是完备、正确的，并且是直接从问题的公理化基础推导出来的。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport collections\n\ndef solve():\n    \"\"\"\n    Solves the tetrad classification problem for the specified test suite.\n    \"\"\"\n\n    def classify_tetrad(tetrad: list[str]) -> int:\n        \"\"\"\n        Classifies a single meiotic tetrad based on genetic principles.\n\n        The classification follows a two-step process: validation and then classification.\n        A tetrad is invalid if it violates formal structure or the 2:2 allele segregation law.\n        A valid tetrad is classified as PD, T, or NPD based on its genotype composition.\n\n        Args:\n            tetrad: A list of 4 strings representing the genotypes of the spores.\n\n        Returns:\n            An integer code: 0 for PD, 1 for T, 2 for NPD, -1 for Invalid.\n        \"\"\"\n        # --- Step 1: Validation ---\n        \n        # 1a: Check basic structure (must be 4 spores)\n        if len(tetrad) != 4:\n            return -1\n\n        # 1b: Check allele validity and count alleles for segregation check\n        allele_counts = collections.defaultdict(int)\n        valid_alleles_locus1 = {'A', 'a'}\n        valid_alleles_locus2 = {'B', 'b'}\n\n        for genotype in tetrad:\n            # Genotype must be a string of length 2\n            if not isinstance(genotype, str) or len(genotype) != 2:\n                return -1\n            \n            allele1, allele2 = genotype[0], genotype[1]\n            \n            # Alleles must be from the allowed sets\n            if allele1 not in valid_alleles_locus1 or allele2 not in valid_alleles_locus2:\n                return -1\n\n            allele_counts[allele1] += 1\n            allele_counts[allele2] += 1\n\n        # 1c: Check for 2:2 allele segregation law\n        if not (allele_counts.get('A', 0) == 2 and allele_counts.get('a', 0) == 2 and\n                allele_counts.get('B', 0) == 2 and allele_counts.get('b', 0) == 2):\n            return -1\n\n        # --- Step 2: Classification of Valid Tetrads ---\n        \n        genotype_counts = collections.Counter(tetrad)\n        \n        # Parental Ditype (PD): code 0\n        # Contains exactly the two parental genotypes, AB and ab, each with multiplicity 2.\n        if genotype_counts.get('AB', 0) == 2 and genotype_counts.get('ab', 0) == 2:\n            return 0\n            \n        # Nonparental Ditype (NPD): code 2\n        # Contains exactly the two nonparental genotypes, Ab and aB, each with multiplicity 2.\n        if genotype_counts.get('Ab', 0) == 2 and genotype_counts.get('aB', 0) == 2:\n            return 2\n            \n        # Tetratype (T): code 1\n        # Contains all four genotypes {AB, Ab, aB, ab}, each with multiplicity 1.\n        if (genotype_counts.get('AB', 0) == 1 and genotype_counts.get('Ab', 0) == 1 and\n            genotype_counts.get('aB', 0) == 1 and genotype_counts.get('ab', 0) == 1):\n            return 1\n            \n        # Per the derivation, a valid tetrad must fall into one of the above three categories.\n        # This fallback is for logical completeness but should not be reached.\n        return -1\n\n\n    # Define the fixed test suite from the problem statement.\n    test_cases = [\n        ['AB', 'AB', 'ab', 'ab'],    # Case 1: PD\n        ['Ab', 'Ab', 'aB', 'aB'],    # Case 2: NPD\n        ['AB', 'Ab', 'aB', 'ab'],    # Case 3: T\n        ['AB', 'AB', 'Ab', 'ab'],    # Case 4: Invalid (violates 2:2 'a' segregation)\n        ['AB', 'ab', 'aB', 'aX']     # Case 5: Invalid (contains illegal character 'X')\n    ]\n\n    results = []\n    for case in test_cases:\n        result = classify_tetrad(case)\n        results.append(result)\n\n    # Final print statement must produce only the required single-line format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2864980"}, {"introduction": "对四分体进行分类并获得计数后，下一个自然而然的问题是：这些数字告诉我们什么？本练习将介绍遗传学家使用的一种核心统计方法——卡方拟合优度检验（$\\chi^2$ goodness-of-fit test）。通过比较观察到的四分体计数与在独立分配假设下预期的频率，你将学会如何定量地检验遗传连锁这一基本假说。[@problem_id:2865026]", "problem": "一个在两个基因座上杂合的二倍体 Saccharomyces cerevisiae 菌株进行了孢子形成，其无序四分体被解剖并分为亲本双型 ($PD$)、非亲本双型 ($NPD$) 和四分型 ($T$) 三类。在总共 $356$ 个完整四分体中，观测到的数量为：$PD = 94$，$NPD = 88$，$T = 174$。在不连锁（独立分配且无染色单体干涉）的原假设下，$PD:NPD:T$ 的预期类别比例为 $1:1:2$。\n\n仅使用卡方拟合优度检验的定义，计算不连锁原假设的卡方检验统计量。将你的最终答案表示为一个四舍五入到四位有效数字的实数。不要报告 $p$ 值，也不要包含任何单位。", "solution": "该问题要求计算一个拟合优度检验的卡方 ($\\chi^2$) 检验统计量。这是遗传学中的一个标准程序，用于评估遗传杂交的观测数据是否与特定假设（在本例中为两个基因独立分配的假设）下的预期频率有显著偏离。\n\n首先，正式陈述所给信息。\n观测到的四分体总数：$N = 356$。\n三个四分体类型的观测频率为：\n- 亲本双型 (Parental Ditype)：$O_{PD} = 94$。\n- 非亲本双型 (Nonparental Ditype)：$O_{NPD} = 88$。\n- 四分型 (Tetratype)：$O_{T} = 174$。\n\n原假设 ($H_0$) 是两个基因座独立分配。对于像 *Saccharomyces cerevisiae* 这样的生物体，在进行减数分裂时，若基因不连锁，亲本双型 ($PD$) 和非亲本双型 ($NPD$) 四分体源于减数分裂I中期不同染色体的随机朝向，因此理论上以相等的频率出现 ($PD:NPD = 1:1$)。四分型 ($T$) 四分体的频率则取决于基因与着丝粒的交换。一个常见的理论模型预测最终比例为 $1:1:4$。然而，该问题明确规定使用简化的 $1:1:2$ 比例作为原假设，这可能是基于特定简化假设。我们的计算将严格遵循题目给出的 $1:1:2$ 比例。\n\n预期比例 $1:1:2$ 中各部分之和为 $1 + 1 + 2 = 4$。我们现在可以根据总样本量 $N=356$，计算在原假设下每个类别的期望频率 ($E_i$)。\n每个类别的期望频率由公式 $E_i = (\\text{proportion}_i) \\times N$ 给出。\n\n- $PD$ 的期望频率：\n$$E_{PD} = \\frac{1}{1+1+2} \\times N = \\frac{1}{4} \\times 356 = 89$$\n\n- $NPD$ 的期望频率：\n$$E_{NPD} = \\frac{1}{1+1+2} \\times N = \\frac{1}{4} \\times 356 = 89$$\n\n- $T$ 的期望频率：\n$$E_{T} = \\frac{2}{1+1+2} \\times N = \\frac{2}{4} \\times 356 = \\frac{1}{2} \\times 356 = 178$$\n\n作为检验，期望频率之和必须等于观测总数：$E_{PD} + E_{NPD} + E_{T} = 89 + 89 + 178 = 356 = N$。计算结果一致。\n\n卡方检验统计量 $\\chi^2$ 由以下公式定义：\n$$\\chi^2 = \\sum_{i} \\frac{(O_i - E_i)^2}{E_i}$$\n其中 $O_i$ 是观测频率，$E_i$ 是第 $i$ 个类别的期望频率。\n\n我们现在计算每个类别对总 $\\chi^2$ 值的贡献。\n\n- 对于 $PD$ 类别：\n$$\\frac{(O_{PD} - E_{PD})^2}{E_{PD}} = \\frac{(94 - 89)^2}{89} = \\frac{5^2}{89} = \\frac{25}{89}$$\n\n- 对于 $NPD$ 类别：\n$$\\frac{(O_{NPD} - E_{NPD})^2}{E_{NPD}} = \\frac{(88 - 89)^2}{89} = \\frac{(-1)^2}{89} = \\frac{1}{89}$$\n\n- 对于 $T$ 类别：\n$$\\frac{(O_{T} - E_{T})^2}{E_{T}} = \\frac{(174 - 178)^2}{178} = \\frac{(-4)^2}{178} = \\frac{16}{178} = \\frac{8}{89}$$\n\n总 $\\chi^2$ 统计量是这些值的和：\n$$\\chi^2 = \\frac{25}{89} + \\frac{1}{89} + \\frac{8}{89} = \\frac{25 + 1 + 8}{89} = \\frac{34}{89}$$\n\n最后，我们必须按照题目要求，计算这个分数的数值，并将其四舍五入到四位有效数字。\n$$\\chi^2 = \\frac{34}{89} \\approx 0.38202247...$$\n将此结果四舍五入到四位有效数字得到 $0.3820$。这个值代表了观测到的四分体计数与不连锁假设下的预期计数之间的差异大小。", "answer": "$$\\boxed{0.3820}$$", "id": "2865026"}, {"introduction": "从两个位点扩展到多个位点，本练习将带你应对遗传学中的一个实际挑战：构建多点遗传图谱。由于实验数据包含随机误差，成对的图距估计值可能不完全满足可加性。这个实践将演示如何推断正确的基因顺序，并使用最小二乘法等统计方法，从带有噪音的数据中创建一个一致且协调的遗传图谱。[@problem_id:2865030]", "problem": "在一种形成无序四分子的同宗配合真菌中，对大量子囊中的三个基因座 $A$、$B$ 和 $C$ 进行了基因分型。对于每对基因座，研究者首先通过公式 $\\hat{r}_{ij} = \\frac{1}{2} T + \\mathrm{NPD}$，将观察到的亲本双型 (PD)、非亲本双型 (NPD) 和四分型 (T) 四分子的频率转换为估计的染色单体重组率 $\\hat{r}_{ij}$，然后应用无干涉 (Haldane) 作图函数得到 $\\hat{d}_{ij} = -\\frac{1}{2}\\ln(1 - 2\\hat{r}_{ij})$，从而计算出以摩根为单位的初步成对图距估计值 $\\hat{d}_{ij}$。得到的初步基因座间距离估计值（以摩根为单位）如下：\n- $\\hat{d}_{AB} = 0.145$\n- $\\hat{d}_{BC} = 0.202$\n- $\\hat{d}_{AC} = 0.331$\n\n由于真实图距沿线性顺序是可加的，但初步估计值 $\\hat{d}_{ij}$ 包含抽样噪声，因此它们不必精确满足可加性。假设没有交换干涉（因此 Haldane 距离是可加的），并且真实区段距离是非负的。在三种可能的线性顺序中，选择与这些约束条件一致的顺序，然后执行无加权最小二乘调整，以强制该顺序满足可加性。具体来说，如果选择的顺序是 $A$–$B$–$C$，则引入未知的非负区段长度 $a = d_{AB}$ 和 $b = d_{BC}$，通过 $a + b$ 预测 $d_{AC}$，并选择 $a$ 和 $b$ 以最小化预测距离与初步估计值 $\\hat{d}_{ij}$ 之间的离差平方和。\n\n在选定顺序下，通过此最小二乘投影强制满足可加性后，基因座 $A$ 和 $C$ 之间的调整后图距（以摩根为单位）是多少？将您的答案四舍五入到四位有效数字，并以摩根为单位表示。最终答案中不要包含单位。", "solution": "该问题要求确定三个基因座“$A$”、“$B$”和“$C$”的线性基因顺序，并随后对图距进行最小二乘调整以强制满足可加性。\n\n首先，需要验证问题陈述的有效性。\n给定的数据是初步的成对图距估计值：\n$\\hat{d}_{AB} = 0.145$ 摩根\n$\\hat{d}_{BC} = 0.202$ 摩根\n$\\hat{d}_{AC} = 0.331$ 摩根\n问题假设没有交换干涉，这意味着真实图距（$d_{ij}$）沿着线性染色体是可加的。问题还指出，真实区段距离是非负的。任务是选择最可能的线性顺序，执行无加权最小二乘调整，并报告调整后的距离$d_{AC}$。\n\n该问题在科学上基于遗传作图的原理，问题提出得很好，目标明确，数据充分，并且陈述客观。初步估计中的轻微非可加性（$\\hat{d}_{AB} + \\hat{d}_{BC} = 0.145 + 0.202 = 0.347 \\ne 0.331 = \\hat{d}_{AC}$）归因于抽样噪声，这是一个现实情景，并为进行统计调整提供了根本动因。因此，该问题被认为是有效的。\n\n求解过程分两个阶段：确定基因顺序和最小二乘调整。\n\n阶段 1：确定基因顺序\n三个基因座有 $3$ 种可能的线性顺序：$A-B-C$、$A-C-B$ 和 $B-A-C$。假设图距具有可加性，那么两个最外侧基因座之间的距离应等于相邻基因座之间距离之和。我们对每种可能的顺序，比较两个较小估计距离之和与最大估计距离，以找出差异最小的顺序。\n\n情况 1：顺序 $A-B-C$。预期的关系是 $d_{AC} = d_{AB} + d_{BC}$。使用估计值，我们将 $\\hat{d}_{AB} + \\hat{d}_{BC}$ 与 $\\hat{d}_{AC}$ 进行比较。\n$\\hat{d}_{AB} + \\hat{d}_{BC} = 0.145 + 0.202 = 0.347$。\n差异为 $|\\left(\\hat{d}_{AB} + \\hat{d}_{BC}\\right) - \\hat{d}_{AC}| = |0.347 - 0.331| = 0.016$。\n\n情况 2：顺序 $A-C-B$。预期的关系是 $d_{AB} = d_{AC} + d_{CB}$。使用估计值，我们将 $\\hat{d}_{AC} + \\hat{d}_{BC}$ 与 $\\hat{d}_{AB}$ 进行比较。\n$\\hat{d}_{AC} + \\hat{d}_{BC} = 0.331 + 0.202 = 0.533$。\n差异为 $|\\left(\\hat{d}_{AC} + \\hat{d}_{BC}\\right) - \\hat{d}_{AB}| = |0.533 - 0.145| = 0.388$。\n\n情况 3：顺序 $B-A-C$。预期的关系是 $d_{BC} = d_{BA} + d_{AC}$。使用估计值，我们将 $\\hat{d}_{AB} + \\hat{d}_{AC}$ 与 $\\hat{d}_{BC}$ 进行比较。\n$\\hat{d}_{AB} + \\hat{d}_{AC} = 0.145 + 0.331 = 0.476$。\n差异为 $|\\left(\\hat{d}_{AB} + \\hat{d}_{AC}\\right) - \\hat{d}_{BC}| = |0.476 - 0.202| = 0.274$。\n\n最小的差异 ($0.016$) 对应于顺序 $A-B-C$。因此选择此顺序为最可能的线性顺序。\n\n阶段 2：无加权最小二乘调整\n对于顺序 $A-B-C$，设调整后的非负区段距离为 $a = d_{AB}$ 和 $b = d_{BC}$。根据可加性原则，最外侧基因座之间的调整后距离为 $d_{AC} = a + b$。\n\n目标是找到 $a$ 和 $b$ 的值，以最小化初步估计值 $\\hat{d}_{ij}$ 与调整后距离之间的离差平方和 $S(a, b)$。\n$$S(a, b) = (\\hat{d}_{AB} - a)^2 + (\\hat{d}_{BC} - b)^2 + (\\hat{d}_{AC} - (a+b))^2$$\n代入给定的数值：\n$$S(a, b) = (0.145 - a)^2 + (0.202 - b)^2 + (0.331 - a - b)^2$$\n为了找到最小值，我们计算 $S$ 关于 $a$ 和 $b$ 的偏导数，并令它们为 $0$。\n$$\\frac{\\partial S}{\\partial a} = -2(0.145 - a) - 2(0.331 - a - b) = 0$$\n$$\\frac{\\partial S}{\\partial b} = -2(0.202 - b) - 2(0.331 - a - b) = 0$$\n两边同除以 $-2$ 来简化方程组：\n$$ (0.145 - a) + (0.331 - a - b) = 0 $$\n$$ (0.202 - b) + (0.331 - a - b) = 0 $$\n合并同类项，我们得到一个二元线性方程组：\n$$ 2a + b - 0.476 = 0 \\implies 2a + b = 0.476 \\quad (1) $$\n$$ a + 2b - 0.533 = 0 \\implies a + 2b = 0.533 \\quad (2) $$\n我们必须解这个方程组来求 $a$ 和 $b$。由方程 $(1)$ 得 $b = 0.476 - 2a$。将此代入方程 $(2)$：\n$$ a + 2(0.476 - 2a) = 0.533 $$\n$$ a + 0.952 - 4a = 0.533 $$\n$$ -3a = 0.533 - 0.952 $$\n$$ -3a = -0.419 $$\n$$ a = \\frac{0.419}{3} $$\n现在，将 $a$ 的值代回 $b$ 的表达式中：\n$$ b = 0.476 - 2\\left(\\frac{0.419}{3}\\right) = \\frac{1.428}{3} - \\frac{0.838}{3} = \\frac{0.590}{3} $$\n$a$ 和 $b$ 均为正数，满足非负性约束。\n\n问题要求的是基因座 $A$ 和 $C$ 之间的调整后图距，即 $d_{AC} = a + b$。\n$$ d_{AC} = a + b = \\frac{0.419}{3} + \\frac{0.590}{3} = \\frac{0.419 + 0.590}{3} = \\frac{1.009}{3} $$\n计算数值：\n$$ d_{AC} \\approx 0.336333... $$\n按要求四舍五入到四位有效数字，我们得到 $0.3363$。这就是 $A$ 和 $C$ 之间的调整后图距。", "answer": "$$\\boxed{0.3363}$$", "id": "2865030"}]}