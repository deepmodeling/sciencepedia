{"hands_on_practices": [{"introduction": "克努森假说的一个核心观察是，遗传性肿瘤（如视网膜母细胞瘤）的发病率在儿童早期呈线性增长。这个练习旨在将这一经验观察用数学语言精确地表达出来。通过将“第二次打击”事件建模为一个泊松过程，你将推导出在短时间内，遗传性病例的累积发病率如何近似地与年龄 $t$ 成正比，从而为“一次打击”动力学建立起基础的定量直觉 [@problem_id:2824884]。", "problem": "在遗传性视网膜母细胞瘤中，新生儿的每个视网膜祖细胞都携带一个视网膜母细胞瘤易感基因等位基因的胚系失活，因此任何一个细胞中只需要发生第二次体细胞失活即可引发一个肿瘤灶。考虑一个与 Knudson 的双重打击假说一致的理想化模型：每个易感视网膜祖细胞中的第二次打击事件遵循泊松过程，其单个细胞的发生率为 $u$（每单位时间），且各细胞间的事件是相互独立的。设 $M(t)$ 表示在年龄 $t$ 时易感视网膜祖细胞的数量。在生命早期的一个短时间区间 $[0,t]$（其中 $t$ 很小）内，发育变化足够缓慢，因此 $M(t)$ 可以用一个常数 $M_0$ 来近似。当任何一个细胞中发生第一次“第二次打击”事件时，肿瘤就被视为已经形成。\n\n仅使用关于泊松过程、独立性以及生存率和累积发生率之间关系的基本性质，推导截至年龄 $t$ 至少已形成一个肿瘤的累积概率 $I(t)$ 的小 $t$ 近似（对 $t$ 的一阶近似）。你的最终答案应表示为由 $u$、$M_0$ 和 $t$ 组成的单个闭式解析表达式，不带单位。最终答案中不要包含等式或不等式；只提供表达式本身。", "solution": "该问题陈述是一个将随机过程原理应用于生物模型的有效且合理的练习。它在 Knudson 的双重打击假说背景下具有科学依据，并使用标准的数学理想化模型——泊松过程，来模拟体细胞突变事件。所有必要的参数都已提供，任务是进行一个特定且明确定义的推导。我现在开始进行解答。\n\n让我们精确地定义这个系统。我们有一个包含 $M_0$ 个易感视网膜祖细胞的群体。在短时间区间 $[0, t]$ 内，这些细胞的数量被假定为恒定。每个细胞都可能发生“第二次打击”事件，该事件遵循泊松过程。\n\n对于单个细胞，我们用索引 $i$ 来表示，其中 $i \\in \\{1, 2, \\dots, M_0\\}$。细胞 $i$ 中第二次打击事件的发生遵循一个恒定率为 $u$ 的泊松过程。在时间区间 $[0, t]$ 内，细胞 $i$ 中此类事件发生的次数（我们记为 $N_i(t)$）遵循均值为 $\\lambda = u t$ 的泊松分布。$N_i(t)$ 的概率质量函数由以下公式给出：\n$$ P(N_i(t) = k) = \\frac{(ut)^k \\exp(-ut)}{k!} $$\n其中 $k$ 是事件发生的次数。\n\n当 $M_0$ 个细胞中的*任何*一个发生第一次“第二次打击”事件时，一个肿瘤灶便形成。我们需要求解的是截至年龄 $t$ 至少已形成一个肿瘤的累积概率 $I(t)$。通常，先计算其互补概率会更简单，即生存函数 $S(t)$。生存函数 $S(t)$ 是指到时间 $t$ 为止*没有*肿瘤形成的概率。\n$$ S(t) = P(\\text{no tumor initiated by time } t) $$\n这等价于到时间 $t$ 为止，*没有*细胞发生过第二次打击事件。这意味着对于所有细胞 $i=1, \\dots, M_0$，第二次打击事件的发生次数必须为零。\n$$ S(t) = P(N_1(t)=0 \\text{ and } N_2(t)=0 \\text{ and } \\dots \\text{ and } N_{M_0}(t)=0) $$\n问题陈述中说明，每个细胞中的事件是独立发生的。因此，联合概率是各个单独概率的乘积：\n$$ S(t) = \\prod_{i=1}^{M_0} P(N_i(t)=0) $$\n对于单个细胞 $i$，发生零次第二次打击事件（$k=0$）的概率可以从泊松分布中得到：\n$$ P(N_i(t)=0) = \\frac{(ut)^0 \\exp(-ut)}{0!} = \\exp(-ut) $$\n由于这个概率对于所有 $M_0$ 个细胞都是相同的，总生存概率 $S(t)$ 为：\n$$ S(t) = (\\exp(-ut))^{M_0} = \\exp(-M_0 u t) $$\n这个结果也可以从以下性质来理解：$M_0$ 个速率为 $u$ 的独立泊松过程的叠加，是一个总速率为 $M_0 u$ 的单一泊松过程。\n\n累积发生率 $I(t)$ 是至少形成一个肿瘤的概率。它是生存函数 $S(t)$ 的补集：\n$$ I(t) = 1 - S(t) $$\n代入我们得到的 $S(t)$ 表达式：\n$$ I(t) = 1 - \\exp(-M_0 u t) $$\n这是在给定模型下累积发生率的精确表达式。\n\n然而，题目要求的是对 $t$ 的一阶小 $t$ 近似。这可以通过对指数函数在零点附近进行泰勒级数展开来获得。 $\\exp(x)$ 的泰勒级数为：\n$$ \\exp(x) = 1 + x + \\frac{x^2}{2!} + \\frac{x^3}{3!} + \\dots $$\n对于一阶近似，我们保留到自变量一次方的项。令 $x = -M_0 u t$。当 $t$ 很小时，$x$ 也很小，因此该近似是有效的。\n$$ \\exp(-M_0 u t) \\approx 1 + (-M_0 u t) = 1 - M_0 u t $$\n将此一阶近似代回 $I(t)$ 的表达式中：\n$$ I(t) \\approx 1 - (1 - M_0 u t) = 1 - 1 + M_0 u t $$\n$$ I(t) \\approx M_0 u t $$\n这个线性近似表明，在短时间内，肿瘤形成的概率随时间 $t$、易感细胞数量 $M_0$ 以及单个细胞突变率 $u$ 线性增加。这就是所要求的一阶近似。", "answer": "$$\\boxed{M_0 u t}$$", "id": "2824884"}, {"introduction": "在建立了肿瘤发生的基本动力学模型之后，我们来深入探究“第二次打击”背后的分子机制。“打击”并非单一事件，而是可以由点突变或诸如杂合性丢失（Loss of Heterozygosity, LOH）等更大范围的染色体事件引起。这个练习将挑战你对这些相互竞争的分子机制进行建模，并量化它们各自的贡献，这对于理解肿瘤的演化路径至关重要 [@problem_id:2824891]。", "problem": "一个抑癌基因 $T$ 遵循 Knudson 双突变假说：一个细胞必须在 $T$ 基因上获得两次失活事件才会失去其功能。考虑一个增殖性祖细胞的克隆群体，其中每个细胞都已携带 $T$ 基因的第一次突变（即，细胞是杂合的 $a/A$，带有一个突变等位基因 $a$ 和一个野生型等位基因 $A$）。在一个固定的观察窗口期内，每个细胞都经历分裂，在分裂过程中，第二次突变可能通过两种互斥的机制产生：\n\n- 通过有丝分裂重组导致的杂合性丢失 (LOH)：定义 $r$ 为在每次细胞分裂中，$T$ 基因与其在同源染色体上的着丝粒之间发生单次有丝分裂重组交换的概率。这样的事件会产生两个具有相互性LOH的子细胞：一个变为纯合突变型 $a/a$，另一个变为纯合野生型 $A/A$，因此每次此类事件恰好产生一个发生第二次突变的 $a/a$ 子细胞。\n\n- 剩余野生型等位基因的点突变：定义 $u$ 为在S期，野生型等位基因 $A$ 发生失活性点突变并传递给一个子细胞的每个染色单体复制的概率。因为在有丝分裂之前，$A$ 等位基因被复制成两个姐妹染色单体，所以每次分裂有 $2$ 个独立的染色单体靶点，每个靶点的突变概率为 $u$；假设 $u \\ll 1$，因此在同一次分裂中发生多次突变的情况可以忽略不计，并且靶点间的独立性是有效的稀有事件近似。\n\n假设事件是稀有的，因此在整个群体和时间窗口内，(i) 每次分裂的机制独立作用，且每次分裂最多只发生一种第二次突变的机制，(ii) 在该窗口期内，细胞谱系不会获得超过一次的第二次突变，以及 (iii) 群体增长的细节仅影响计数的大小，而不会偏向于任何一种机制的竞争。\n\n在这些假设下，并从竞争性稀有事件的第一性原理出发，计算在观察窗口期内群体中出现的所有第二次突变中，归因于杂合性丢失 (LOH) 的期望比例。请将您的答案表示为仅包含 $r$ 和 $u$ 的简化符号表达式。无需进行数值计算，也无需单位。", "solution": "该问题要求计算在抑癌基因 $T$ 的所有第二次突变中，由杂合性丢失 (LOH) 引起的期望比例。初始细胞群体是杂合的，携带一个突变等位基因 ($a$) 和一个野生型等位基因 ($A$)。第二次突变导致产生纯合突变基因型 $a/a$。\n\n我们必须首先确定在单次细胞分裂中，通过两种指定机制中的每一种发生第二次突变的概率。我们将一次分裂中通过LOH发生第二次突变的事件表示为 $E_{LOH}$，将通过点突变发生第二次突变的事件表示为 $E_{PM}$。\n\n1.  **通过杂合性丢失 (LOH) 发生第二次突变的概率：**\n    问题将 $r$ 定义为每次细胞分裂中发生导致LOH的有丝分裂重组事件的概率。问题明确指出，此类事件恰好产生一个基因型为 $a/a$ 的子细胞。因此，在单次分裂中通过LOH产生第二次突变细胞的概率直接由下式给出：\n    $$ P(E_{LOH}) = r $$\n\n2.  **通过点突变 (PM) 发生第二次突变的概率：**\n    问题将 $u$ 定义为野生型等位基因 $A$ 发生失活性突变的每个染色单体复制的概率。在有丝分裂之前的S期，细胞DNA进行复制。携带野生型等位基因 $A$ 的染色体被复制成两个姐妹染色单体，每个都携带一个 $A$ 等位基因。这为点突变提供了两个独立的目标。让我们计算这两个目标中至少一个获得突变的概率。\n\n    单个染色单体的 $A$ 等位基因*不*发生突变的概率是 $(1 - u)$。\n    由于两个姐妹染色单体上的突变是独立事件，因此*两个*染色单体都不发生突变的概率是它们各自不突变概率的乘积：\n    $$ P(\\text{no mutation}) = (1 - u) \\times (1 - u) = (1 - u)^2 $$\n    发生至少一次突变的概率，即事件 $E_{PM}$，是不发生突变事件的补集：\n    $$ P(E_{PM}) = 1 - P(\\text{no mutation}) = 1 - (1 - u)^2 $$\n    展开平方项，我们得到：\n    $$ P(E_{PM}) = 1 - (1 - 2u + u^2) = 2u - u^2 $$\n    问题给出了 $u \\ll 1$ 的假设。这使我们可以忽略二阶项 $u^2$，因为它远小于一阶项 $2u$。这是稀有事件的标准近似。\n    因此，每次分裂发生点突变事件的概率可以很好地近似为：\n    $$ P(E_{PM}) \\approx 2u $$\n    两个 $A$ 染色单体中的一个发生点突变事件，会导致两个子细胞中的一个接收到新突变的等位基因，使其基因型变为 $a/a$，从而构成第二次突变。\n\n3.  **机制间的竞争：**\n    问题指出，LOH和点突变是互斥的机制。因此，在单次细胞分裂中发生第二次突变的总概率 $P_{\\text{total}}$ 是每种机制概率的总和：\n    $$ P_{\\text{total}} = P(E_{LOH}) + P(E_{PM}) = r + 2u $$\n    我们被要求计算所有第二次突变中归因于LOH的期望比例。在一个有大量独立试验（细胞分裂）的场景中，特定类型结果的期望比例等于在该类型事件发生的概率，条件是所考虑的任何事件中有一个发生。\n\n    设 $F_{LOH}$ 为所求比例。此比例是通过LOH发生第二次突变的概率与任何第二次突变的总概率之比：\n    $$ F_{LOH} = \\frac{P(E_{LOH})}{P_{\\text{total}}} $$\n    将推导出的概率代入此表达式，得到：\n    $$ F_{LOH} = \\frac{r}{r + 2u} $$\n    这个最终的符号表达式代表了由LOH引起的第二次突变的比例，是按照要求从第一性原理推导出来的。事件是稀有的、互斥的，以及群体动力学不引入偏倚的这些假设，对于这种每次分裂概率的直接比较至关重要。", "answer": "$$ \\boxed{\\frac{r}{r + 2u}} $$", "id": "2824891"}, {"introduction": "本章的最后一个练习将理论模型应用于一个真实的临床问题，展示了克努森假说的强大应用价值。通过理解遗传性（一次打击）和散发性（两次打击）癌症的不同动力学特征，我们可以在缺少直接基因检测信息的情况下，对患者队列进行统计“拆分”。这个练习将指导你构建一个混合模型，以根据患者的单侧或双侧患病情况，推断一个队列中遗传性病例所占的比例，凸显了该假说在遗传流行病学和临床推断中的重要作用 [@problem_id:2824865]。", "problem": "一个儿科肿瘤科室希望在一个临床诊断为视网膜母细胞瘤的队列中，通过确诊年龄为 $t$ 岁，在不进行种系基因检测的情况下，估计遗传性病例与散发性病例的比例。假设存在以下基于 Knudson 双重打击假说的机理模型。在遗传性类别中，每只眼睛携带一个种系“第一次打击”，该眼的肿瘤起始发生于一次体细胞“第二次打击”。在散发性类别中，每只眼睛的肿瘤起始需要两次体细胞打击。对于每只眼睛，体细胞打击的发生遵循一个速率恒定的齐次泊松过程。假设在给定类别的情况下，双眼相互独立，并且在确诊前每只眼睛最多发生一个肿瘤。该队列仅包含病例（即在年龄 $t$ 岁前至少有一只眼睛受累的儿童），这些病例被分为单侧（恰好一只眼睛受累）或双侧（双眼均受累）。\n\n使用以下参数假设：在遗传性类别中，每只眼睛的第二次打击过程速率为 $\\alpha$（每年），在散发性类别中，单次打击过程的速率为 $\\lambda$（每年），因此一只眼睛中发生两次所需打击的时间遵循形状参数为 $2$、速率为 $\\lambda$ 的爱尔朗分布。所有眼睛和所有个体共享相同的参数。设已确诊病例中遗传性病例的未知比例为 $f$，因此已确诊病例中散发性病例的比例为 $1-f$。\n\n到年龄 $t$ 时，该科室观察到 $B$ 个双侧病例和 $U$ 个单侧病例，总数为 $N=B+U$。给定 $t=2$ 年，$\\alpha=1$ 年$^{-1}$，$\\lambda=0.2$ 年$^{-1}$，以及观察到的计数 $B=60$ 和 $U=60$，构建一个与上述假设一致的、有原则的混合模型，推导出以 $f$ 为变量的似然函数，并计算 $f$ 的最大似然估计。将您的最终估计表示为小数，并四舍五入至四位有效数字。", "solution": "该问题已经过验证，被认定为具有科学依据、问题明确，并且是将统计学原理明确应用于癌症遗传学中一个公认模型的案例。因此，该问题是有效的，并将提供解答。\n\n该问题要求在一个确诊队列中，估计遗传性视网膜母细胞瘤病例的比例 $f$。该队列由 $N = B+U$ 个个体组成，其中 $B$ 是双侧病例数，$U$ 是单侧病例数。该模型是一个双组分混合模型，其中一个确诊个体以概率 $f$ 属于遗传性类别，或以概率 $1-f$ 属于散发性类别。\n\n首先，我们必须确定在确诊年龄 $t$ 之前，对于每个类别，单只眼睛受累的概率。设 $p_H$ 为遗传性（H）类别的该概率，$p_S$ 为散发性（S）类别的该概率。\n\n在遗传性类别中，肿瘤在一次体细胞打击后形成，该打击过程是速率为 $\\alpha$ 的泊松过程。此事件发生的时间 $T_H$ 遵循速率为 $\\alpha$ 的指数分布。在时间 $t$ 前一只眼睛受累的概率是该分布在 $t$ 处的累积分布函数（CDF）。\n$$p_H = P(T_H \\le t) = 1 - \\exp(-\\alpha t)$$\n\n在散发性类别中，肿瘤在两次体细胞打击后形成，其中单次打击是速率为 $\\lambda$ 的泊松过程。第二次打击发生的时间 $T_S$ 遵循形状参数 $k=2$、速率为 $\\lambda$ 的爱尔朗分布。其CDF由下式给出：\n$$p_S = P(T_S \\le t) = 1 - \\sum_{n=0}^{2-1} \\frac{(\\lambda t)^n}{n!} \\exp(-\\lambda t) = 1 - \\left( \\frac{(\\lambda t)^0}{0!} + \\frac{(\\lambda t)^1}{1!} \\right) \\exp(-\\lambda t)$$\n$$p_S = 1 - (1 + \\lambda t) \\exp(-\\lambda t)$$\n\n接下来，我们确定在确诊病例（即至少有一只眼睛受累）的条件下，观察到单侧或双侧疾病的概率。设 $A$ 为确诊事件。鉴于对于给定类别 $C \\in \\{H, S\\}$，双眼是独立的，那么没有眼睛受累的概率是 $(1-p_C)^2$。因此，确诊的概率是：\n$$P(A|C) = 1 - (1-p_C)^2 = 1 - (1 - 2p_C + p_C^2) = 2p_C - p_C^2$$\n恰好有一只（单侧）或两只（双侧）眼睛受累的概率由二项分布给出：\n$$P(\\text{Unilateral}|C) = \\binom{2}{1} p_C (1-p_C) = 2p_C(1-p_C)$$\n$$P(\\text{Bilateral}|C) = \\binom{2}{2} p_C^2 (1-p_C)^0 = p_C^2$$\n一个确诊病例是单侧或双侧的概率，以其类别为条件，是：\n$$P(\\text{Bilateral}|A, C) = \\frac{P(\\text{Bilateral}|C)}{P(A|C)} = \\frac{p_C^2}{2p_C - p_C^2} = \\frac{p_C}{2-p_C}$$\n$$P(\\text{Unilateral}|A, C) = \\frac{P(\\text{Unilateral}|C)}{P(A|C)} = \\frac{2p_C(1-p_C)}{2p_C - p_C^2} = \\frac{2(1-p_C)}{2-p_C}$$\n我们记 $P_{B|H} = P(\\text{Bilateral}|A, H)$，$P_{U|H} = P(\\text{Unilateral}|A, H)$，对于散发性类别 $S$ 也类似。\n\n该队列是一个混合体。一个确诊病例是双侧的总概率 $\\pi_B$ 为：\n$$\\pi_B(f) = f \\cdot P_{B|H} + (1-f) \\cdot P_{B|S}$$\n一个确诊病例是单侧的总概率 $\\pi_U$ 为：\n$$\\pi_U(f) = f \\cdot P_{U|H} + (1-f) \\cdot P_{U|S} = 1 - \\pi_B(f)$$\n在总共 $N=B+U$ 个病例中观察到 $B$ 个双侧和 $U$ 个单侧病例的似然函数 $L(f)$ 由二项似然给出：\n$$L(f) \\propto [\\pi_B(f)]^B [\\pi_U(f)]^U = [\\pi_B(f)]^B [1 - \\pi_B(f)]^U$$\n为了找到 $f$ 的最大似然估计（MLE），我们最大化对数似然函数 $\\ell(f) = \\ln L(f)$:\n$$\\ell(f) = B \\ln(\\pi_B(f)) + U \\ln(1 - \\pi_B(f))$$\n我们对 $f$ 求导并令其为零：\n$$\\frac{d\\ell}{df} = \\left( \\frac{B}{\\pi_B(f)} - \\frac{U}{1-\\pi_B(f)} \\right) \\frac{d\\pi_B}{df} = 0$$\n假设 $\\frac{d\\pi_B}{df} \\neq 0$（即两类别的双侧概率不同），这意味着：\n$$\\frac{B}{\\pi_B(\\hat{f})} = \\frac{U}{1-\\pi_B(\\hat{f})} \\implies B(1-\\pi_B(\\hat{f})) = U \\pi_B(\\hat{f})$$\n$$B = (B+U)\\pi_B(\\hat{f}) \\implies \\pi_B(\\hat{f}) = \\frac{B}{B+U} = \\frac{B}{N}$$\nMLE $\\hat{f}$ 通过解此方程得到：\n$$\\hat{f} \\cdot P_{B|H} + (1-\\hat{f}) \\cdot P_{B|S} = \\frac{B}{N}$$\n$$\\hat{f} (P_{B|H} - P_{B|S}) = \\frac{B}{N} - P_{B|S}$$\n$$\\hat{f} = \\frac{B/N - P_{B|S}}{P_{B|H} - P_{B|S}}$$\n\n现在我们代入给定的数值：$t=2$ 年, $\\alpha=1$ 年$^{-1}$, $\\lambda=0.2$ 年$^{-1}$, $B=60$, $U=60$。因此，$N=120$ 且 $B/N = 60/120 = 0.5$。\n\n首先，我们计算 $p_H$ 和 $p_S$:\n$$\\alpha t = 1 \\cdot 2 = 2$$\n$$p_H = 1 - \\exp(-2)$$\n$$\\lambda t = 0.2 \\cdot 2 = 0.4$$\n$$p_S = 1 - (1 + 0.4)\\exp(-0.4) = 1 - 1.4\\exp(-0.4)$$\n\n接着，我们计算条件概率 $P_{B|H}$ 和 $P_{B|S}$:\n$$P_{B|H} = \\frac{p_H}{2-p_H} = \\frac{1 - \\exp(-2)}{2 - (1 - \\exp(-2))} = \\frac{1 - \\exp(-2)}{1 + \\exp(-2)}$$\n$$P_{B|S} = \\frac{p_S}{2-p_S} = \\frac{1 - 1.4\\exp(-0.4)}{2 - (1 - 1.4\\exp(-0.4))} = \\frac{1 - 1.4\\exp(-0.4)}{1 + 1.4\\exp(-0.4)}$$\n这些值的数值计算结果是：\n$$P_{B|H} \\approx \\frac{1 - 0.13533528}{1 + 0.13533528} = \\frac{0.86466472}{1.13533528} \\approx 0.76159416$$\n$$P_{B|S} \\approx \\frac{1 - 1.4(0.67032005)}{1 + 1.4(0.67032005)} = \\frac{1 - 0.93844807}{1 + 0.93844807} = \\frac{0.06155193}{1.93844807} \\approx 0.03175280$$\n\n最后，我们计算 $\\hat{f}$：\n$$\\hat{f} = \\frac{0.5 - P_{B|S}}{P_{B|H} - P_{B|S}} \\approx \\frac{0.5 - 0.03175280}{0.76159416 - 0.03175280} = \\frac{0.46824720}{0.72984136} \\approx 0.6415535$$\n将结果四舍五入至四位有效数字得到 $0.6416$。这就是在确诊队列中遗传性病例比例的最大似然估计。", "answer": "$$\\boxed{0.6416}$$", "id": "2824865"}]}