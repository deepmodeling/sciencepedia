{"hands_on_practices": [{"introduction": "D-统计量（或ABBA-BABA检验）是利用全基因组SNP数据检测古代基因流的强大工具。本练习将指导你计算D-统计量，以及至关重要的一步——使用块状刀切法（block-jackknife）评估其统计显著性。通过完成这个例子 [@problem_id:2544491]，你将学会如何量化指示基因渗入的基因树拓扑结构不对称性，并学习如何构建对研究结果的置信度，这在现代群体基因组学中是一项至关重要的技能。", "problem": "一项针对适应性渐渗的四分类单元检验使用了全基因组范围内的双等位基因单核苷酸多态性（SNPs）数据，这些数据被排列成不重叠的物理区块以考虑连锁。这些分类单元的排列方式为 $\\left(P_{1},P_{2},P_{3},O\\right)$，其中 $O$ 是一个外群。在没有渐渗且只有不完全谱系分选（ILS）的原假设下，位点模式 $\\mathrm{ABBA}$ 和 $\\mathrm{BABA}$ 的期望计数是相等的。D-统计量用于量化这些计数中的不对称性。为了进行区块重抽样，基因组被分割成 $B=50$ 个等长的区块。\n\n在整个数据集中，总计数为 $\\mathrm{ABBA}=320$ 和 $\\mathrm{BABA}=280$。为了评估不确定性，执行了删一区块刀切法（每次剔除一个区块）。设 $\\hat{D}_{(-b)}$ 表示移除区块 $b$ 后计算出的 D-统计量，并设 $\\bar{D}_{\\mathrm{LOO}}=\\frac{1}{B}\\sum_{b=1}^{B}\\hat{D}_{(-b)}$ 为留一法估计值的均值。从 $B=50$ 个留一法重复样本中，观察到平方偏差和为\n$$\n\\sum_{b=1}^{B}\\left(\\hat{D}_{(-b)}-\\bar{D}_{\\mathrm{LOO}}\\right)^{2}=2.296\\times 10^{-4}.\n$$\n\n仅使用 $\\mathrm{ABBA}$–$\\mathrm{BABA}$ 框架和删一刀切法的基本定义，完成以下任务：\n- 根据总计数推导全基因组 D-统计量的表达式，并计算其值。\n- 从删一刀切方差估计量的定义出发，推导用 $B$ 和留一法偏差表示的估计量，然后计算刀切标准误和用于检验原假设 $D=0$ 的相应 $Z$-分数。\n\n将您的最终答案以行矩阵 $\\left[D,\\;Z\\right]$ 的形式报告，其中两个条目都四舍五入到四位有效数字，并以纯小数形式表示（无单位）。", "solution": "该问题陈述具有科学依据，表述清晰，客观，并包含了完整解答所需的所有信息。它描述了 D-统计量（ABBA-BABA检验）与区块刀切法方差估计相结合的一个标准应用，这些都是群体基因组学中的既定方法。所提供的数据是一致且合理的。因此，我们将进行完整的推导和计算。\n\n首先，我们推导并计算全基因组 D-统计量，记为 $\\hat{D}$。该统计量用于量化由 $\\mathrm{ABBA}$ 和 $\\mathrm{BABA}$ 位点模式所代表的两种备择基因树拓扑计数之间的不对称性。设 $n_{\\mathrm{ABBA}}$ 和 $n_{\\mathrm{BABA}}$ 为整个基因组中这些模式的总计数。D-统计量定义为这些计数的归一化差异：\n$$\n\\hat{D} = \\frac{n_{\\mathrm{ABBA}} - n_{\\mathrm{BABA}}}{n_{\\mathrm{ABBA}} + n_{\\mathrm{BABA}}}\n$$\n问题给出的总计数为：$n_{\\mathrm{ABBA}} = 320$ 和 $n_{\\mathrm{BABA}} = 280$。将这些值代入公式可得：\n$$\n\\hat{D} = \\frac{320 - 280}{320 + 280} = \\frac{40}{600} = \\frac{1}{15}\n$$\n其数值为 $\\hat{D} \\approx 0.066667$。\n\n接下来，我们使用删一区块刀切法来解决不确定性估计和假设检验问题。题目要求我们推导方差估计量。设 $\\hat{D}$ 是从包含 $B$ 个区块的完整数据集计算出的统计量，$\\hat{D}_{(-b)}$ 是省略区块 $b$ 后重新计算的统计量。对于每个区块 $b \\in \\{1, 2, ..., B\\}$，刀切伪值 $J_b$ 定义为：\n$$\nJ_b = B \\hat{D} - (B-1)\\hat{D}_{(-b)}\n$$\n$\\hat{D}$ 的刀切方差估计量由伪值的样本方差除以区块数 $B$ 给出：\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{1}{B(B-1)} \\sum_{b=1}^{B} (J_b - \\bar{J})^2\n$$\n其中 $\\bar{J}$ 是伪值的均值，$\\bar{J} = \\frac{1}{B}\\sum_{b=1}^{B} J_b$。为继续推导，我们将此方差用留一法估计值 $\\hat{D}_{(-b)}$ 来表示。首先，我们求出均值伪值 $\\bar{J}$：\n$$\n\\bar{J} = \\frac{1}{B} \\sum_{b=1}^{B} [B \\hat{D} - (B-1)\\hat{D}_{(-b)}] = B \\hat{D} - \\frac{B-1}{B} \\sum_{b=1}^{B} \\hat{D}_{(-b)} = B \\hat{D} - (B-1)\\bar{D}_{\\mathrm{LOO}}\n$$\n其中 $\\bar{D}_{\\mathrm{LOO}} = \\frac{1}{B}\\sum_{b=1}^{B}\\hat{D}_{(-b)}$ 是留一法估计值的均值。单个伪值与均值的偏差为：\n$$\nJ_b - \\bar{J} = \\left[B \\hat{D} - (B-1)\\hat{D}_{(-b)}\\right] - \\left[B \\hat{D} - (B-1)\\bar{D}_{\\mathrm{LOO}}\\right] = -(B-1)(\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}})\n$$\n将此结果代入方差公式：\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{1}{B(B-1)} \\sum_{b=1}^{B} \\left[ -(B-1)(\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}}) \\right]^2 = \\frac{(B-1)^2}{B(B-1)} \\sum_{b=1}^{B} (\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}})^2\n$$\n这可以简化为我们所求的删一刀切方差估计量的表达式：\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{B-1}{B} \\sum_{b=1}^{B} (\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}})^2\n$$\n推导出此表达式后，我们现在可以计算其值。已知 $B=50$ 且平方偏差和为 $\\sum_{b=1}^{B}\\left(\\hat{D}_{(-b)}-\\bar{D}_{\\mathrm{LOO}}\\right)^{2}=2.296\\times 10^{-4}$。\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{50-1}{50} (2.296 \\times 10^{-4}) = \\frac{49}{50} (2.296 \\times 10^{-4}) = 0.98 \\times 2.296 \\times 10^{-4} = 2.25008 \\times 10^{-4}\n$$\n刀切标准误 $\\mathrm{SE}_J(\\hat{D})$ 是方差的平方根：\n$$\n\\mathrm{SE}_J(\\hat{D}) = \\sqrt{\\widehat{\\mathrm{Var}}_{J}(\\hat{D})} = \\sqrt{2.25008 \\times 10^{-4}} \\approx 0.01500027\n$$\n最后，我们计算用于检验原假设 $H_0: D=0$ 的 $Z$-分数。$Z$-分数是估计的统计量与其标准误之比：\n$$\nZ = \\frac{\\hat{D} - D_{H_0}}{\\mathrm{SE}_J(\\hat{D})} = \\frac{\\hat{D}}{\\mathrm{SE}_J(\\hat{D})}\n$$\n使用已计算出的 $\\hat{D}$ 和 $\\mathrm{SE}_J(\\hat{D})$ 的值：\n$$\nZ = \\frac{1/15}{0.01500027} \\approx \\frac{0.066666...}{0.01500027} \\approx 4.44439\n$$\n问题要求最终答案以行矩阵 $[D, Z]$ 的形式报告，两个值均四舍五入至四位有效数字。\n$D = 0.066666... \\approx 0.06667$\n$Z = 4.44439... \\approx 4.444$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.06667 & 4.444\n\\end{pmatrix}\n}\n$$", "id": "2544491"}, {"introduction": "在基因组中检测到基因渗入的信号后，下一个关键问题是确认该信号的性质，特别是当它与选择性扫描的迹象重叠时。这个练习 [@problem_id:2789562] 提出了一个常见的研究挑战：一个选择性扫描是由新出现的突变引起的，还是由从另一个群体渗入的等位基因造成的？你将批判性地评估几种检验策略，学会识别最能区分适应性渗入与新生扫描的特定信号，从而磨练你为复杂进化假说设计严谨检验方案的能力。", "problem": "您正在研究一个受体群体 $\\mathrm{R}$（包含 $n_{\\mathrm{R}} = 100$ 个高覆盖度基因组）和一个假定的供体群体 $\\mathrm{D}$（包含 $n_{\\mathrm{D}} = 15$ 个基因组），此外还有一个用于区分祖先等位基因与衍生等位基因的外群 $\\mathrm{O}$。在群体 $\\mathrm{R}$ 中，一个位点 $L$ 显示出强烈的类似选择性清除的模式：一个高频率的衍生等位基因（称之为等位基因 $B$，频率 $f_B \\approx 0.8$），一个长的高频率单倍型，以及降低的局部核苷酸多样性。您希望区分 $\\mathrm{R}$ 群体中位点 $L$ 处的选择性清除是由来自 $\\mathrm{D}$ 群体的适应性渐渗导致的，还是由 $\\mathrm{R}$ 群体内部出现的新生突变导致的。您已经识别出“供体特有衍生”位点，这些是双等位基因位点，在这些位点上，相对于 $\\mathrm{O}$，群体 $\\mathrm{D}$ 在衍生等位基因上是固定的，而这个衍生等位基因在其他未被怀疑与 $\\mathrm{D}$ 有过基因交换的群体中在全基因组范围内是罕见的。考虑位点 $L$ 周围 $\\pm 250$ 千碱基大小的窗口。\n\n根据群体遗传学的基本原理，适应性渐渗意味着在 $\\mathrm{R}$ 中被选择性清除的单倍型，在连锁位点上，应该比 $\\mathrm{R}$ 中的非携带者单倍型更晚近地与 $\\mathrm{D}$ 共祖，这导致在该窗口内，携带者染色体上供体特有衍生等位基因的富集。相比之下，$\\mathrm{R}$ 中的新生选择性清除不应在携带者染色体上造成超越由不完全谱系分选所导致的背景共享水平的、局部的供体特有衍生等位基因富集。\n\n在恰当控制全基因组背景共享和局部连锁的情况下，哪种检验策略最能特异性地利用供体特异性等位基因状态来区分位点 $L$ 处的渐渗清除和新生清除？\n\nA. 在 $\\pm 250$ 千碱基窗口内，计算等位基因 $B$ 携带者与非携带者在其单倍型上观察到的供体特有衍生等位基因比例的差异，并通过保持连锁不平衡 (LD; linkage disequilibrium) 的染色体块置换来评估其显著性。窗口内局部的、显著为正的差异支持适应性渐渗。\n\nB. 计算 $\\mathrm{R}$ 群体中携带者与非携带者在 $L$ 周围的扩展单倍型纯合性 (EHH; extended haplotype homozygosity) 衰减，如果携带者具有更长的 EHH 区段，则推断为渐渗，因为渐渗的单倍型预期会更长。\n\nC. 在滑动窗口中计算 ABBA–BABA D-统计量，使用四元组 $(\\mathrm{P}_1,\\mathrm{P}_2,\\mathrm{P}_3,\\mathrm{O}) = (\\mathrm{R} \\text{中的非携带者}, \\mathrm{R} \\text{中的携带者}, \\mathrm{D}, \\mathrm{O})$。在 $L$ 附近，ABBA 显著多于 BABA 表明，携带者与 $\\mathrm{D}$ 共享的衍生等位基因比非携带者更多，这与适应性渐渗一致。\n\nD. 比较 $\\mathrm{R}$ 群体携带者中 $L$ 位点周围纯合区段的平均长度与 $\\mathrm{D}$ 群体中的平均区段长度。如果 $\\mathrm{R}$ 群体携带者的区段比 $\\mathrm{D}$ 群体短，则推断为新生清除；如果更长，则推断为适应性渐渗。\n\nE. 在窗口内计算 $\\mathrm{R}$ 群体携带者与 $\\mathrm{D}$ 群体之间的固定指数 $F_{ST}$。如果 $F_{ST}$ 低，则推断为渐渗；如果高，则推断为新生清除。", "solution": "问题陈述经过验证。\n\n**第1步：提取已知信息**\n- 受体群体：$\\mathrm{R}$，样本量 $n_{\\mathrm{R}} = 100$。\n- 假定供体群体：$\\mathrm{D}$，样本量 $n_{\\mathrm{D}} = 15$。\n- 外群：$\\mathrm{O}$，用于区分祖先等位基因与衍生等位基因。\n- 位点：$L$，位于群体 $\\mathrm{R}$ 中。\n- 等位基因：位于位点 $L$ 的一个衍生等位基因 $B$ 在群体 $\\mathrm{R}$ 中频率很高，$f_B \\approx 0.8$。\n- 在 $\\mathrm{R}$ 中的观察：位点 $L$ 显示出类似选择性清除的模式（高频率的衍生等位基因、长的高频率单倍型、降低的局部核苷酸多样性）。\n- 目标：区分位点 $L$ 处的选择性清除的起源是来自 $\\mathrm{D}$ 的适应性渐渗，还是 $\\mathrm{R}$ 内部的*新生*选择性清除。\n- 关键标记：“供体特有衍生”位点，即相对于 $\\mathrm{O}$，$\\mathrm{D}$ 在该衍生等位基因上是固定的，并且该衍生等位基因在其他群体中是罕见的。\n- 分析窗口：位点 $L$ 周围的 $\\pm 250$ 千碱基。\n- 适应性渐渗的假设：在 $\\mathrm{R}$ 中被清除的单倍型（携带等位基因 $B$）应该比 $\\mathrm{R}$ 中的非携带者单倍型更晚近地与来自 $\\mathrm{D}$ 的单倍型共祖。这导致在携带者染色体上，供体特有衍生等位基因出现局部富集。\n- *新生*选择性清除的假设：源于 $\\mathrm{R}$ 内部的选择性清除不应造成这种局部富集，其水平不会超过因不完全谱系分选导致的背景共享。\n\n**第2步：使用提取的已知信息进行验证**\n根据验证标准对问题进行评估。\n- **科学依据：** 问题基于群体遗传学的既定原理，特别是选择性清除、渐渗、不完全谱系分选和溯祖理论。场景和术语都是该领域的标准用法。\n- **问题明确：** 问题提出了两个清晰、互斥的假设，并要求找出区分它们的最具特异性的方法。它提供了所有必要的信息（群体、样本、遗传信号、标记定义）以进行解答推理。\n- **客观性：** 语言精确且技术化。它描述了一个客观的科学问题，没有主观性或偏见。\n\n**第3步：结论与行动**\n问题陈述是有效的。这是一个在群体基因组学领域中表述清晰的问题。我将继续进行解答。\n\n根本任务是识别一种在适应性渐渗模型下存在，但在*新生*选择性清除模型下不存在的统计特征。根据群体遗传学理论，从群体 $\\mathrm{D}$ 适应性渐渗到 $\\mathrm{R}$ 的一个单倍型，将导致携带者单倍型上受选择位点 $L$ 周围的一个染色体片段具有源自 $\\mathrm{D}$ 的近期祖先。在 $\\mathrm{R}$ 群体中不携带被清除等位基因 $B$ 的单倍型（非携带者），以及源于*新生*清除的染色体，将仅因不完全谱系分选而与 $\\mathrm{D}$ 共享古老的祖先。因此，最直接的检验是确定，与 $\\mathrm{R}$ 中不携带 $B$ 的染色体相比，$\\mathrm{R}$ 中携带 $B$ 的染色体是否显示出与群体 $\\mathrm{D}$ 的遗传相似性存在局部过量。\n\n**逐项分析**\n\n**A. 在 $\\pm 250$ 千碱基窗口内，计算等位基因 $B$ 携带者与非携带者在其单倍型上观察到的供体特有衍生等位基因比例的差异，并通过保持连锁不平衡（LD）的染色体块置换来评估其显著性。窗口内局部的、显著为正的差异支持适应性渐渗。**\n该策略直接检验了适应性渐渗假说的核心预测。\n1.  它使用了正确的比较组：$\\mathrm{R}$ 中的 $B$ 携带者（检验组）对 $\\mathrm{R}$ 中的非携带者（对照组）。这种比较有效地将与选择性清除相关的信号从群体 $\\mathrm{R}$ 和 $\\mathrm{D}$ 之间的背景遗传关系中分离出来。\n2.  它利用了问题中定义的最具信息量的标记：“供体特有衍生”等位基因。这些等位基因是 $\\mathrm{D}$ 祖源的特异性标记。这些标记在携带者单倍型上的富集是其起源于 $\\mathrm{D}$ 的有力证据。\n3.  它正确地提出了一个统计显著性检验（染色体块置换），该检验考虑了连锁位点（LD）的非独立性，这对于基于单倍型的检验至关重要。\n4.  一个显著为正的差异证实了与等位基因 $B$ 连锁的基因组区域比 $\\mathrm{R}$ 群体中的其他单倍型更相似于群体 $\\mathrm{D}$，这与渐渗一致。这种方法在概念上与 S* 统计量等已建立的方法相似。\n结论：**正确**。这是一个设计良好、具体且统计上严谨的方法。\n\n**B. 计算 $\\mathrm{R}$ 群体中携带者与非携带者在 $L$ 周围的扩展单倍型纯合性（EHH）衰减，并如果携带者具有更长的 EHH 区段，则推断为渐渗，因为渐渗的单倍型预期会更长。**\n扩展单倍型纯合性（EHH）是用于检测近期正选择的指标。长的 EHH 区段表明一个单倍型上升到高频率的速度太快，以至于重组还来不及将其打断。问题陈述已经假设存在一个带有“长的高频率单倍型”的“类似选择性清除的模式”，这意味着 $B$ 携带者具有高的 EHH。源于 $\\mathrm{R}$ 内部*新生*突变的选择性清除也会产生一个长的 EHH 区段。因此，观察到 $B$ 携带者的高 EHH 证实了存在选择性清除，但并未提供关于被清除等位基因*起源*（渐渗 vs. *新生*）的信息。单倍型的相对长度对于这种区分不是一个可靠的诊断指标。\n结论：**不正确**。这个检验对于所提出的问题缺乏特异性。\n\n**C. 在滑动窗口中计算 ABBA–BABA D-统计量，使用四元组 $(\\mathrm{P}_1,\\mathrm{P}_2,\\mathrm{P}_3,\\mathrm{O}) = (\\mathrm{R} \\text{中的非携带者}, \\mathrm{R} \\text{中的携带者}, \\mathrm{D}, \\mathrm{O})$。在 $L$ 附近，ABBA 显著多于 BABA 表明，携带者与 $\\mathrm{D}$ 共享的衍生等位基因比非携带者更多，这与适应性渐渗一致。**\nD-统计量旨在通过检验共享衍生等位基因的不对称性来检测基因流。指定的四元组为 $(\\mathrm{P}_1, \\mathrm{P}_2, \\mathrm{P}_3, \\mathrm{O})$，其中 $\\mathrm{P}_1$ 是 $\\mathrm{R}$ 中的非携带者，$\\mathrm{P}_2$ 是 $\\mathrm{R}$ 中的携带者，$\\mathrm{P}_3$ 是群体 $\\mathrm{D}$，$\\mathrm{O}$ 是外群。正的 D 统计量表示，相比于 $\\mathrm{P}_1$ 和 $\\mathrm{P}_3$ 共享衍生等位基因而 $\\mathrm{P}_2$ 不共享的位点（`BABA` 模式），$\\mathrm{P}_2$ 和 $\\mathrm{P}_3$ 共享衍生等位基因而 $\\mathrm{P}_1$ 不共享的位点（`ABBA` 模式）存在过量。在此背景下，一个显著为正的 D 统计量意味着 $\\mathrm{R}$ 中携带 $B$ 的染色体比 $\\mathrm{R}$ 中不携带 $B$ 的染色体与群体 $\\mathrm{D}$ 共享更多的衍生等位基因。这是对从 $\\mathrm{D}$ 到 $B$ 携带谱系的渐渗的直接检验。在滑动窗口中应用此检验，可以把信号定位到 $L$ 位点周围的区域。这是一种用于检测适应性渐渗的标准且强大的方法（与 $f_d$ 统计量相关）。\n结论：**正确**。这是一个统计上可靠且广泛用于解决此类问题的策略。\n\n**D. 比较 $\\mathrm{R}$ 群体携带者中 $L$ 位点周围纯合区段的平均长度与 $\\mathrm{D}$ 群体中的平均区段长度。如果 $\\mathrm{R}$ 群体携带者的区段比 $\\mathrm{D}$ 群体短，则推断为新生清除；如果更长，则推断为适应性渐渗。**\n单倍型的长度是其年龄和局部重组率的函数。一个刚刚在群体 $\\mathrm{R}$ 中开始被清除的渐渗单倍型，可能比群体 $\\mathrm{D}$ 中的源单倍型年轻得多（因此也更长），而在 $\\mathrm{D}$ 群体中该等位基因可能已经很古老。反之，一个古老的渐渗事件之后再发生的选择性清除，可能导致 $\\mathrm{R}$ 中的单倍型现在比 $\\mathrm{D}$ 中的更短。在受体和供体群体中，单倍型长度之间没有一种简单、普遍的关系可以区分渐渗和*新生*清除。这种比较不具有诊断性。\n结论：**不正确**。其推理在逻辑上有缺陷。\n\n**E. 在窗口内计算 $\\mathrm{R}$ 群体携带者与 $\\mathrm{D}$ 群体之间的固定指数 $F_{ST}$。如果 $F_{ST}$ 低，则推断为渐渗；如果高，则推断为新生清除。**\n固定指数 $F_{ST}$ 衡量群体间的遗传分化。如果 $\\mathrm{R}$ 中携带 $B$ 的单倍型起源于 $\\mathrm{D}$，那么在 $L$ 位点周围的窗口内，它们在遗传上应该与 $\\mathrm{D}$ 中的单倍型非常相似。这将导致这两个群体之间较低的 $F_{ST}$。相反，对于*新生*清除，$B$ 携带者是 $\\mathrm{R}$ 本土的，因此应该表现出与 $\\mathrm{D}$ 的背景分化水平。尽管其基本原理是合理的，但所陈述的策略是不完整的。一个低的 $F_{ST}$ 值只有在与基线（例如 $\\mathrm{R}$ 与 $\\mathrm{D}$ 之间的全基因组平均 $F_{ST}$，或非携带者与 $\\mathrm{D}$ 之间的 $F_{ST}$）进行比较时才有意义。该选项仅陈述“如果 $F_{ST}$ 低”，这不是一个定义明确的统计检验。没有这个关键的比较，该方法是未充分说明的。\n结论：**不正确**。所提议的检验不完整，并且缺乏适当的对照或比较基线。", "answer": "$$\\boxed{\\text{AC}}$$", "id": "2789562"}, {"introduction": "理解了如何检测和辨别适应性渗入后，深入其背后的理论基础至关重要。本练习将挑战你推导一个新引入的有益等位基因最终在受体群体中固定下来的概率，从而理解其成功的条件。通过应用群体遗传学理论的基石——扩散近似，你将量化初始频率 ($\\alpha$)、选择强度 ($s$) 和群体大小 ($N$) 如何共同决定该等位基因的最终命运 [@problem_id:2789588]。这个练习有助于巩固对适应性渗入动态的根本理解。", "problem": "一个适应性等位基因 $A$ 通过单次杂交脉冲，渗入一个大小恒定为 $N$ 的大型、随机交配的二倍体受体种群中，其初始等位基因频率为 $p(0)=\\alpha$，其中 $0<\\alpha<1$。假设采用世代不重叠的 Wright-Fisher 抽样模型，脉冲事件后无迁移，无突变，且处于连锁平衡状态。在受体遗传背景下，等位基因 $A$ 具有加性适应度优势，使得各基因型的相对适应度分别为 $w_{aa}=1$，$w_{Aa}=1+s$ 和 $w_{AA}=1+2s$，其中 $s>0$ 为一个不随时间变化的常数。假设为扩散近似意义下的弱选择（即 $s$ 很小，但 $Ns$ 可以是有限值），且 Wright-Fisher 扩散近似方法有效。\n\n从第一性原理出发，使用适用于选择作用下的 Wright-Fisher 扩散模型的 Kolmogorov 后向方程，推导渗入等位基因 $A$ 最终被固定的概率的精确闭式表达式。该表达式应为初始频率 $\\alpha$、选择系数 $s$ 和种群大小 $N$ 的函数。你的最终答案必须是关于 $\\alpha$、$s$ 和 $N$ 的单一解析表达式。不要提供不等式或方程组。不需要进行数值舍入。", "solution": "所述问题具有科学依据、良定且客观。它呈现了理论群体遗传学中的一个经典情景，可以使用该领域的支柱——Wright-Fisher 模型及其扩散近似——进行形式化和求解。所有必要的参数和条件——种群大小 $N$、选择系数 $s$、初始频率 $\\alpha$ 以及加性选择的遗传模型——均已提供。该问题是自洽的，没有内在矛盾。因此，我将按照指示，从第一性原理出发进行严谨的推导。\n\n一个等位基因从初始频率 $p$ 开始，其最终固定概率（我们记为 $u(p)$）由不依赖于时间的 Kolmogorov 后向方程描述。对于一个具有漂移系数 $M(p)$ 和扩散系数 $V(p)$ 的一维扩散过程，该方程是一个二阶常微分方程（ODE）：\n$$\n\\frac{1}{2} V(p) \\frac{d^2 u}{dp^2} + M(p) \\frac{du}{dp} = 0\n$$\n该方程需在反映固定和丢失定义的边界条件下求解。如果等位基因的频率为 $0$，它就丢失了，因此其固定概率为 $0$。如果其频率为 $1$，它就被固定了，因此其固定概率为 $1$。\n$$\nu(0) = 0 \\quad \\text{and} \\quad u(1) = 1\n$$\n为了针对这一特定问题求解该方程，我们必须首先从给定的带有选择作用的 Wright-Fisher 模型中推导出漂移系数和扩散系数。\n\n扩散系数 $V(p)$ 表示由于随机遗传漂变导致的每代等位基因频率变化的方差。在一个有效大小恒为 $N$ 的二倍体种群中，有 $2N$ 个基因拷贝。下一代中等位基因 $A$ 的拷贝数是通过对当前频率为 $p$ 的基因库进行二项抽样得到的。因此，下一代等位基因频率的方差为：\n$$\nV(p) = \\frac{p(1-p)}{2N}\n$$\n漂移系数 $M(p)$ 表示由于选择作用导致的每代等位基因频率的期望变化。设 $p$ 为等位基因 $A$ 的频率。基因型 $aa$、$Aa$ 和 $AA$ 的适应度分别为 $w_{aa}=1$，$w_{Aa}=1+s$ 和 $w_{AA}=1+2s$。种群的平均适应度 $\\bar{w}$ 是各基因型适应度按其 Hardy-Weinberg 频率加权的平均值：\n$$\n\\bar{w} = (1-p)^2 w_{aa} + 2p(1-p) w_{Aa} + p^2 w_{AA}\n$$\n代入给定的适应度值：\n$$\n\\bar{w} = (1-p)^2(1) + 2p(1-p)(1+s) + p^2(1+2s)\n$$\n$$\n\\bar{w} = (1 - 2p + p^2) + (2p - 2p^2)(1+s) + p^2(1+2s)\n$$\n$$\n\\bar{w} = 1 - 2p + p^2 + 2p + 2sp - 2p^2 - 2sp^2 + p^2 + 2sp^2 = 1 + 2sp\n$$\n等位基因 $A$ 在下一代的频率 $p'$ 由基因型 $Aa$ 和 $AA$ 贡献的等位基因频率给出：\n$$\np' = \\frac{p(1-p)w_{Aa} + p^2 w_{AA}}{\\bar{w}} = \\frac{p(1-p)(1+s) + p^2(1+2s)}{1+2sp}\n$$\n$$\np' = \\frac{p - p^2 + sp - sp^2 + p^2 + 2sp^2}{1+2sp} = \\frac{p + sp + sp^2}{1+2sp}\n$$\n等位基因频率的期望变化 $\\Delta p$ 为 $p' - p$：\n$$\n\\Delta p = \\frac{p + sp + sp^2}{1+2sp} - p = \\frac{p + sp + sp^2 - p(1+2sp)}{1+2sp}\n$$\n$$\n\\Delta p = \\frac{p + sp + sp^2 - p - 2sp^2}{1+2sp} = \\frac{sp - sp^2}{1+2sp} = \\frac{sp(1-p)}{1+2sp}\n$$\n问题指明选择是弱的（$s$ 很小），这允许我们使用扩散近似。在此极限下，分母 $1+2sp \\approx 1$。因此，漂移系数为：\n$$\nM(p) = \\mathbb{E}[\\Delta p] \\approx sp(1-p)\n$$\n现在我们将推导出的系数 $M(p)$ 和 $V(p)$ 代入 Kolmogorov 后向方程：\n$$\n\\frac{1}{2} \\left( \\frac{p(1-p)}{2N} \\right) \\frac{d^2 u}{dp^2} + sp(1-p) \\frac{du}{dp} = 0\n$$\n对于开区间 $(0, 1)$ 内的等位基因频率 $p$，我们可以将整个方程除以非零项 $p(1-p)$：\n$$\n\\frac{1}{4N} \\frac{d^2 u}{dp^2} + s \\frac{du}{dp} = 0\n$$\n乘以 $4N$ 将方程简化为：\n$$\n\\frac{d^2 u}{dp^2} + 4Ns \\frac{du}{dp} = 0\n$$\n这是一个二阶线性齐次常系数常微分方程。令 $v(p) = \\frac{du}{dp}$。该方程变为关于 $v(p)$ 的一阶常微分方程：\n$$\n\\frac{dv}{dp} + 4Ns v = 0\n$$\n这是一个可分离变量的方程。其解为 $v(p) = C_1 \\exp(-4Nsp)$，其中 $C_1$ 是一个积分常数。由于 $v(p) = \\frac{du}{dp}$，我们对 $p$ 积分以求得 $u(p)$：\n$$\nu(p) = \\int C_1 \\exp(-4Nsp) dp = C_1 \\left( \\frac{\\exp(-4Nsp)}{-4Ns} \\right) + C_2\n$$\n为方便起见，我们用重新定义的常数 $A$ 和 $B$ 来写出通解：\n$$\nu(p) = A + B \\exp(-4Nsp)\n$$\n我们使用边界条件 $u(0)=0$ 和 $u(1)=1$ 来确定常数 $A$ 和 $B$。\n应用 $u(0)=0$：\n$$\n0 = A + B \\exp(-4Ns \\cdot 0) \\implies 0 = A + B \\implies A = -B\n$$\n应用 $u(1)=1$：\n$$\n1 = A + B \\exp(-4Ns)\n$$\n将 $A = -B$ 代入第二个方程：\n$$\n1 = -B + B \\exp(-4Ns) = B(\\exp(-4Ns) - 1)\n$$\n这给出了 $B$ 的值：\n$$\nB = \\frac{1}{\\exp(-4Ns) - 1}\n$$\n相应地， $A$ 的值为：\n$$\nA = -B = -\\frac{1}{\\exp(-4Ns) - 1} = \\frac{1}{1 - \\exp(-4Ns)}\n$$\n将这些常数代回 $u(p)$ 的通解中：\n$$\nu(p) = \\frac{1}{1 - \\exp(-4Ns)} + \\frac{1}{\\exp(-4Ns) - 1} \\exp(-4Nsp)\n$$\n$$\nu(p) = \\frac{1}{1 - \\exp(-4Ns)} - \\frac{1}{1 - \\exp(-4Ns)} \\exp(-4Nsp)\n$$\n$$\nu(p) = \\frac{1 - \\exp(-4Nsp)}{1 - \\exp(-4Ns)}\n$$\n这就是 Kimura 推导出的著名的关于加性选择下等位基因固定概率的公式。题目要求的是初始频率为 $p(0) = \\alpha$ 时的固定概率。我们只需将 $p = \\alpha$ 代入我们推导出的表达式中。", "answer": "$$\n\\boxed{\\frac{1 - \\exp(-4Ns\\alpha)}{1 - \\exp(-4Ns)}}\n$$", "id": "2789588"}]}