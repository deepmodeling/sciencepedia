{"hands_on_practices": [{"introduction": "这项练习提供了分子模式识别的基础实践。通过分析一个带注释的DNA位点，你将学会识别原核插入序列（IS）元件的典型特征——末端反向重复序列、转座酶基因和靶位点重复序列——并将该元件本身与其在基因组中留下的“疤痕”区分开来。[@problem_id:2862692]", "problem": "一个原核生物染色体区域的注释如下。在一个连续的区段内，发现了两个长度为 $23$ 个碱基对的完美反向重复序列，它们呈反向排列。在这些反向重复序列之间，有一个长度为 $1053$ 个碱基对的单一开放阅读框（ORF），预测其编码一个含有 $351$ 个氨基酸的蛋白质。该蛋白质具有一个保守的天冬氨酸-天冬氨酸-谷氨酸（DDE）催化三联体和一个N端的螺旋-转角-螺旋（helix–turn–helix）DNA结合结构域。紧邻左侧反向重复序列的外侧和紧邻右侧反向重复序列的外侧，侧翼的宿主序列含有相同的 $9$ 个碱基对的正向重复序列。在反向重复序列内部，不存在额外的编码序列（例如，抗生素抗性基因、解离酶或整合酶）。除了这个插入之外，该基因座在其他方面与相关菌株具有同线性（syntenic）。\n\n仅使用关于原核生物转座元件的基本定义——即，插入序列（IS）元件是携带一个两侧为末端反向重复序列的转座酶的最简单单位，并且DDE家族转座酶介导的转座会在宿主中产生短的靶位点重复（作为正向重复序列）——请判断该基因座是一个IS元件还是另一类转座元件，并识别观察到的哪些特征对应于元件的边界，哪些对应于插入所产生的宿主重复。\n\n哪个选项最佳地对此元件进行了分类，并正确地指派了每个组成部分？\n\nA. 一个插入序列（IS）。IS单位的内部边界是 $23$ 个碱基对的反向重复序列，并包含DDE转座酶ORF；侧翼相同的 $9$ 个碱基对的正向重复序列是宿主的靶位点重复，不属于IS的一部分。\n\nB. 一个复合转座子。最外侧的 $9$ 个碱基对的正向重复序列是转座子的真正末端，并且是移动元件的一部分；$23$ 个碱基对的反向重复序列是无关的宿主回文序列。\n\nC. 一个插入序列（IS）。IS单位包括 $23$ 个碱基对的反向重复序列，并且还包括侧翼的 $9$ 个碱基对的正向重复序列作为其最外侧的边界，因此切除时这 $9$ 个碱基对的重复序列会随元件一同被移除。\n\nD. 不是插入序列。因为DDE基序意味着一种复制型机制，需要一个辅助的解离酶和解离位点，所以解离酶基因的缺失意味着该元件不能自主转座；因此，将其分类为IS的依据不成立。\n\nE. 一个微型反向重复序列转座元件（MITE）。短反向重复序列和 $9$ 个碱基对的正向重复序列的存在表明这是一个非自主元件；ORF是残留的，不属于移动单位的一部分。", "solution": "在尝试解答之前，必须首先验证问题陈述的科学合理性、自洽性和清晰度。\n\n步骤1：提取已知条件\n- 系统是一个原核生物染色体区域。\n- 一个连续区段包含两个长度为 $23$ 个碱基对（$bp$）的完美反向重复序列（IRs），呈反向排列。\n- 在这些IRs之间是一个长度为 $1053$ $bp$ 的单一开放阅读框（ORF）。\n- 该ORF预测编码一个含有 $351$ 个氨基酸的蛋白质。\n- 该蛋白质具有一个保守的天冬氨酸-天冬氨酸-谷氨酸（DDE）催化三联体。\n- 该蛋白质具有一个N端的螺旋-转角-螺旋（HTH）DNA结合结构域。\n- 在IRs的两侧，宿主序列含有相同的 $9$ $bp$ 正向重复序列（DRs）。\n- 在IRs之间没有发现其他编码序列（如，抗生素抗性、解离酶、整合酶）。\n- 与相关菌株相比，该基因座破坏了同线性，表明存在一次插入事件。\n- 问题提供了定义：\n    1. 插入序列（IS）元件是具有一个两侧为末端IRs的转座酶的最简单单位。\n    2. DDE家族转座酶在插入时会在宿主序列中产生短的靶位点重复（TSDs），表现为正向重复序列。\n\n步骤2：使用已知条件进行验证\n问题描述了一个具有特定结构的遗传基因座，并提供了分子遗传学的标准定义。\n- **科学依据**：该描述是原核生物转座元件的一个教科书式案例。`IR-基因-IR` 结构是IS元件的典型结构。DDE基序是DDE/D-转座酶/整合酶超家族的标志，该超家族包括了大多数已知IS元件的转座酶。HTH基序是在此类蛋白质中常见的DNA结合结构域。产生被称为靶位点重复（TSDs）的短正向重复序列，是此类元件转座的标志。指定的长度（$23$ $bp$ 的IRs，$9$ $bp$ 的TSDs，约 $1$ $kb$ 的ORF）对于原核生物IS元件来说都是典型的。该陈述在科学上是合理的，并且在事实上是正确的。\n- **问题适定性**：这个问题是适定的。所提供的定义和结构数据足以得出一个关于该元件及其组成部分的唯一分类。\n- **客观性**：语言精确且客观。\n\n步骤3：结论与行动\n问题陈述是有效的。这是一个在分子遗传学领域定义明确且科学准确的问题。我将继续推导解决方案并评估每个选项。\n\n解决方案推导\n问题要求根据基本原则对所描述的遗传元件进行分类。让我们应用所提供的定义。\n\n1.  **元件类型分类**：问题将插入序列（IS）元件定义为“携带一个两侧为末端反向重复序列的转座酶的最简单单位”。所描述的结构由一个单一ORF和其两侧的两个 $23$ $bp$ 的完美反向重复序列组成。该ORF编码一个具有DDE催化三联体和HTH DNA结合结构域的蛋白质，这些是转座酶蛋白的特征性标志。这与IS元件的定义完全匹配。它是“最简单”的单位，因为它不携带任何乘客基因，例如抗生素抗性基因。如果一个元件除了转座机制外还包含此类乘客基因，则会被归类为转座子。\n\n2.  **元件边界识别**：转座元件是可移动的DNA片段本身。在IS元件和许多其他转座子中，边界由末端反向重复序列（IRs）定义。转座酶蛋白识别这些IR序列以介导切除和插入。因此，移动单位从左侧的 $23$ $bp$ IR开始，到右侧的 $23$ $bp$ IR结束。该IS元件的总长度是两个IRs和内部序列长度的总和：$23$ $bp$ + $1053$ $bp$ + $23$ $bp$ = $1099$ $bp$。\n\n3.  **侧翼重复序列的识别**：问题指出，DDE家族转座酶会产生“宿主中的短靶位点重复（TSDs），表现为正向重复序列”。其机制涉及转座酶在靶DNA上制造交错的切口。然后，转座元件被连接到产生的单链悬挂端上。宿主的DNA修复机制会填补悬挂端对面的缺口，导致靶位点序列的重复。这些重复的序列，即TSDs，位于插入元件的两侧，但它们是宿主染色体的一部分，而不是移动DNA的一部分。观察到的紧邻IRs外侧的相同的 $9$ $bp$ 正向重复序列完全符合这个描述。它们是转座行为在宿主基因组中留下的足迹。\n\n结论：所描述的基因座是一个IS元件，其边界是 $23$ $bp$ 的IRs。外部的 $9$ $bp$ 正向重复序列是属于宿主DNA的TSDs。\n\n逐项分析\n\nA. 一个插入序列（IS）。IS单位的内部边界是 $23$ 个碱基对的反向重复序列，并包含DDE转座酶ORF；侧翼相同的 $9$ 个碱基对的正向重复序列是宿主的靶位点重复，不属于IS的一部分。\n此陈述与我们的推导完全一致。它正确地将该元件识别为IS，正确地将其边界定义为IRs，并正确地将侧翼的DRs识别为不属于该元件的宿主TSDs。\n结论：**正确**。\n\nB. 一个复合转座子。最外侧的 $9$ 个碱基对的正向重复序列是转座子的真正末端，并且是移动元件的一部分；$23$ 个碱基对的反向重复序列是无关的宿主回文序列。\n此陈述在多个方面都是不正确的。首先，一个复合转座子通常由两个IS元件侧翼包围一个包含其他基因的中心区域组成。该元件只有一个转座酶基因。其次，正向重复序列（TSDs）不属于移动元件。第三，将侧翼包围着转座酶基因的IRs视为“无关的回文序列”，是对转座元件结构的基本误解。\n结论：**不正确**。\n\nC. 一个插入序列（IS）。IS单位包括 $23$ 个碱基对的反向重复序列，并且还包括侧翼的 $9$ 个碱基对的正向重复序列作为其最外侧的边界，因此切除时这 $9$ 个碱基对的重复序列会随元件一同被移除。\n此陈述正确地将该元件识别为IS，但错误地将 $9$ $bp$ 的正向重复序列包含在移动单位内。TSDs是靶位点的特征，而不是元件本身的特征。IS元件的精确切除会留下一个 $9$ $bp$ 重复序列的拷贝，从而恢复（或几乎恢复）原始的宿主序列。\n结论：**不正确**。\n\nD. 不是插入序列。因为DDE基序意味着一种复制型机制，需要一个辅助的解离酶和解离位点，所以解离酶基因的缺失意味着该元件不能自主转座；因此，将其分类为IS的依据不成立。\n此陈述基于一个错误的前提。DDE催化基序是使用“剪切-粘贴”机制的转座酶的特征，这是一种保守型机制，而非复制型。在像Tn3家族这样的元件中发现的复制型转座，使用丝氨酸重组酶家族的转座酶，并需要一个解离酶进行二次反应。DDE转座酶不需要解离酶。因此，该元件是自主的。\n结论：**不正确**。\n\nE. 一个微型反向重复序列转座元件（MITE）。短反向重复序列和 $9$ 个碱基对的正向重复序列的存在表明这是一个非自主元件；ORF是残留的，不属于移动单位的一部分。\n此陈述不正确。根据定义，MITE是一种缺乏转座酶基因的非自主元件。而此元件含有一个 $1053$ $bp$ 的ORF，预测编码一个完整的、同时具有催化和DNA结合结构域的转座酶。没有证据表明该ORF是“残留的”。功能性转座酶基因的存在使之成为一个自主元件，而不是MITE。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2862692"}, {"introduction": "在基本识别的基础上，本问题深入探讨了复制型转座的分子机制，这是一种不同于简单的“剪切-粘贴”模型的途径。你将通过预测一个经典遗传实验的结果来剖析转座子编码的解离酶和宿主同源重组机制的作用，该实验旨在捕获一个关键的中间体——共整合体。[@problem_id:2862678]", "problem": "一个携带Tn3家族复制型转座子的供体质粒被用于将一个可筛选的抗生素抗性基因递送到大肠杆菌 (Escherichia coli) 中一个无关的目标质粒上。供体质粒 $P_D$ 的总长度为 $12.2\\,\\mathrm{kb}$，并且已经包含一个长度为 $5.2\\,\\mathrm{kb}$ 的转座子 $TnX$ 拷贝。目标质粒 $P_T$ 的长度为 $4.8\\,\\mathrm{kb}$。通过要求供体编码的转座子抗性和目标质粒抗性同时存在于一个细胞中来筛选转座事件，然后通过琼脂糖凝胶电泳分析质粒脱氧核糖核酸 (DNA)。\n\n基本背景 (非目标结论)：在复制型转座中，转座酶催化链转移，形成一个连接供体和目标复制子的共整合体。共整合体包含位于供体-目标连接处两侧的转座子重复拷贝，并通过在res位点上由转座子编码的解离酶催化的位点特异性重组事件，解离成两个独立的复制子。在缺少解离酶的情况下，由宿主重组蛋白A (RecA) 介导的同源重组原则上可以在重复的转座子拷贝之间进行重组并分离复制子，但这条途径通常比解离酶介导的解离效率低。转座过程中产生的靶位点重复具有由转座酶决定的特征长度，而不由解离酶决定。\n\n你构建了一个菌株，其携带的供体质粒中的解离酶基因($tnpR$)被精确删除($\\Delta tnpR$)，而转座酶基因保持完整。你将该质粒通过标准的接合或转化方法导入RecA缺陷型宿主($recA^{-}$)或RecA正常型宿主($recA^{+}$)中，并筛选同时携带目标质粒标记和转座子标记的细胞。然后你分离质粒DNA，并通过凝胶电泳评估其大小。\n\n关于转座产物的谱系及其通过质粒大小变化的可检测性，以下哪个预测与上述机制原理最为一致？选择所有适用项。\n\nA. 在 $\\Delta tnpR\\;recA^{-}$ 背景下，双抗性克隆中的主要产物将是一个未解离的共整合体，其大小约为 $|P_D| + |P_T| + |TnX| \\approx 12.2\\,\\mathrm{kb} + 4.8\\,\\mathrm{kb} + 5.2\\,\\mathrm{kb} = 22.2\\,\\mathrm{kb}$，产生一条新的大条带；$P_T$ 简单增加 $5.2\\,\\mathrm{kb}$ 到约 $10.0\\,\\mathrm{kb}$ 的情况将很罕见或不存在。\n\nB. $tnpR$的删除缩短了靶位点重复的长度（例如，从 $5\\,\\mathrm{bp}$ 缩短到 $0\\,\\mathrm{bp}$），因此插入片段太小，无法通过质粒大小的变化来检测。\n\nC. $tnpR$的删除将机制转变为保守的“剪切-粘贴”途径，因此供体质粒将减少 $5.2\\,\\mathrm{kb}$，目标质粒将增加 $5.2\\,\\mathrm{kb}$，产生相互的大小变化。\n\nD. 在 $\\Delta tnpR\\;recA^{+}$ 背景下，将检测到两类产物：约 $22.2\\,\\mathrm{kb}$ 的大共整合体，以及频率相对于野生型降低的、大小约为 $|P_T| + |TnX| \\approx 10.0\\,\\mathrm{kb}$ 的简单目标插入产物，因为重复的 $TnX$ 拷贝之间的同源重组可以在没有解离酶的情况下低效地解离共整合体。\n\nE. 解离酶功能的丧失会废除转座，因此只能回收未经修饰的 $P_D$ 和 $P_T$。\n\nF. 因为解离酶通常通过结合res位点并抑制转座酶启动子来调节转录，所以 $\\Delta tnpR$ 供体倾向于增加共整合体形成的初始速率；然而，仅检测 $P_T$ 简单大小变化的分析方法会低估 $\\Delta tnpR$ 菌株中的转座，因为未解离的共整合体积累并作为约 $22.2\\,\\mathrm{kb}$ 的大得多的分子种类迁移，而不是作为 $P_T$ 的 $+5.2\\,\\mathrm{kb}$ 大小变化。", "solution": "在尝试解答之前，必须首先验证问题陈述的科学合理性、自身一致性和清晰度。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 供体质粒: $P_D$, 总长度 $|P_D| = 12.2\\,\\mathrm{kb}$。\n- 转座子: $TnX$，一个Tn3家族复制型转座子，长度 $|TnX| = 5.2\\,\\mathrm{kb}$。\n- 供体质粒 $P_D$ 包含一个预先存在的 $TnX$ 拷贝。\n- 目标质粒: $P_T$, 长度 $|P_T| = 4.8\\,\\mathrm{kb}$。\n- 机制: 复制型转座。转座酶形成共整合体。解离酶(由 $tnpR$ 编码)解离共整合体。宿主RecA蛋白也可以通过同源重组解离共整合体，但效率较低。转座酶决定靶位点重复的长度。\n- 实验修改: 从供体质粒中删除了$tnpR$解离酶基因 ($\\Delta tnpR$)。\n- 宿主背景: 实验在RecA缺陷型($recA^{-}$)或RecA正常型($recA^{+}$)宿主中进行。\n- 筛选: 筛选同时表达转座子和目标质粒抗性标记的克隆。\n- 分析: 通过琼脂糖凝胶电泳评估质粒DNA的大小。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据充分：** 该问题描述了Tn3家族转座子的经典复制型转座机制，这是分子遗传学的一个基石性课题。转座酶($tnpA$)、解离酶($tnpR$)、共整合体中间产物以及通过RecA的替代解离途径的作用都得到了准确的描述。使用$\\Delta tnpR$和$recA^-$突变体的实验设计是解析该途径的经典遗传学方法。所有信息都与已建立的科学原理一致。\n- **问题明确：** 该问题提供了推断预期实验结果所需的所有必要信息（质粒大小、遗传背景、机制）。问题要求找出与所提供原理最一致的预测，从而可以得到一组唯一的正确答案。\n- **客观性：** 语言技术性强且精确。没有主观或模糊的陈述。大小和遗传状态都得到了明确定义。\n\n**步骤3：结论与行动**\n问题陈述在科学上是合理的，问题是明确的，并且是客观的。这是一个有效的问题。我们可以继续进行解答。\n\n### 解答推导\n\n问题的核心在于理解在复制型转座的背景下删除解离酶基因($tnpR$)的后果，以及宿主的同源重组能力(RecA状态)如何影响这一过程。\n\n**1. 共整合体的形成与结构**\n复制型转座始于来自供体质粒 $P_D$ 的转座酶作用于转座子 $TnX$ 的末端和目标质粒 $P_T$ 上的一个靶位点。该过程涉及切口和链转移，随后通过DNA合成复制转座子。结果是一个被称为共整合体的单个、大的环状分子。\n\n共整合体包含供体质粒骨架的完整序列、目标质粒的完整序列以及两个转座子拷贝。\n供体质粒骨架的大小为 $|P_D| - |TnX| = 12.2\\,\\mathrm{kb} - 5.2\\,\\mathrm{kb} = 7.0\\,\\mathrm{kb}$。\n目标质粒的大小为 $|P_T| = 4.8\\,\\mathrm{kb}$。\n因此，共整合体的总大小为：\n$$(\\text{Donor backbone}) + (\\text{Target plasmid}) + 2 \\times (\\text{Transposon})$$\n$$ \\text{Size}_{\\text{cointegrate}} = (7.0\\,\\mathrm{kb}) + (4.8\\,\\mathrm{kb}) + 2 \\times (5.2\\,\\mathrm{kb}) = 11.8\\,\\mathrm{kb} + 10.4\\,\\mathrm{kb} = 22.2\\,\\mathrm{kb} $$\n另一种计算方法是 $|P_D| + |P_T| = 12.2\\,\\mathrm{kb} + 4.8\\,\\mathrm{kb} = 17.0\\,\\mathrm{kb}$，这代表了两个原始质粒的融合，但忽略了转座子的复制。正确的表述是，该过程融合了两个复制子并复制了转座子，所以结构是一个融合体。计算最终质量最常见的方法是将其各组分相加：供体骨架、目标质粒和两个转座子拷贝。这总计为 $|P_D| - |TnX| + |P_T| + 2|TnX| = |P_D| + |P_T| + |TnX|$。使用给定值：\n$$ \\text{Size}_{\\text{cointegrate}} = 12.2\\,\\mathrm{kb} + 4.8\\,\\mathrm{kb} + 5.2\\,\\mathrm{kb} = 22.2\\,\\mathrm{kb} $$\n这个大的质粒现在携带了两个原始质粒的标记，因此将被筛选出来。\n\n**2. 共整合体解离**\n共整合体是一个中间产物。它必须解离成两个独立的质粒，以完成转座事件。共整合体的结构是 [供体骨架] -- [TnX] -- [目标质粒] -- [TnX] --。两个 $TnX$ 拷贝的方向相同。\n- **解离酶途径：** $tnpR$基因的产物——解离酶，催化位于转座子拷贝内部的两个 *res* 位点之间的位点特异性重组。这是主要的、高效的途径。它产生原始的供体质粒 $P_D$ ($12.2\\,\\mathrm{kb}$) 和一个现在包含一份转座子拷贝的目标质粒 $P_T'$ (大小为 $|P_T| + |TnX| = 4.8\\,\\mathrm{kb} + 5.2\\,\\mathrm{kb} = 10.0\\,\\mathrm{kb}$)。\n- **RecA途径：** 在缺少解离酶的情况下，由RecA介导的宿主通用同源重组系统可以在两个相同的$TnX$拷贝之间进行重组。这比专门的解离酶系统效率低，但仍能解离共整合体，产生相同的最终产物。\n\n**3. 实验条件分析**\n- **情况1：$\\Delta tnpR\\;recA^{-}$ 背景。** 在此菌株中，用于解离的特化解离酶途径($\\Delta tnpR$)和通用同源重组途径($recA^{-}$)都被禁用。转座将进行到共整合体阶段，形成 $22.2\\,\\mathrm{kb}$ 的质粒。然而，该共整合体无法解离。因此，筛选出的克隆（需要两种抗性标记）将主要含有这个大的、稳定的共整合体。简单的插入产物（$10.0\\,\\mathrm{kb}$）将不会形成。\n\n- **情况2：$\\Delta tnpR\\;recA^{+}$ 背景。** 在此菌株中，解离酶途径被禁用，但同源重组途径是活性的($recA^{+}$)。共整合体将像之前一样形成。RecA蛋白随后可以作用于重复的$TnX$序列来解离共整合体。如问题所述，此途径效率较低。因此，我们预计会观察到产物的混合物：一些克隆将含有未解离的 $22.2\\,\\mathrm{kb}$ 共整合体，而另一些将含有解离产物，其中包括带有转座子插入的 $10.0\\,\\mathrm{kb}$ 目标质粒。获得这种解离的 $10.0\\,\\mathrm{kb}$ 产物的频率将低于解离高效的野生型($tnpR^{+}$)情况。\n\n### 逐项分析\n\n**A. 在 $\\Delta tnpR\\;recA^{-}$ 背景下，双抗性克隆中的主要产物将是一个未解离的共整合体，其大小约为 $|P_D| + |P_T| + |TnX| \\approx 12.2\\,\\mathrm{kb} + 4.8\\,\\mathrm{kb} + 5.2\\,\\mathrm{kb} = 22.2\\,\\mathrm{kb}$，产生一条新的大条带；$P_T$ 简单增加 $5.2\\,\\mathrm{kb}$ 到约 $10.0\\,\\mathrm{kb}$ 的情况将很罕见或不存在。**\n该陈述直接源于我们对情况1的分析。当两种解离途径都被阻断时，转座过程停滞在共整合体中间产物阶段。大小计算是正确的。大小为 $10.0\\,\\mathrm{kb}$ 的解离产物无法形成。\n**结论：正确**\n\n**B. $tnpR$的删除缩短了靶位点重复的长度（例如，从 $5\\,\\mathrm{bp}$ 缩短到 $0\\,\\mathrm{bp}$），因此插入片段太小，无法通过质粒大小的变化来检测。**\n问题背景明确指出，“靶位点重复……不由解离酶决定。”它们是转座酶催化的链转移反应的产物。解离酶在后续步骤中起作用。因此，删除$tnpR$对靶位点重复没有影响。该陈述在根本上是错误的。\n**结论：错误**\n\n**C. $tnpR$的删除将机制转变为保守的“剪切-粘贴”途径，因此供体质粒将减少 $5.2\\,\\mathrm{kb}$，目标质粒将增加 $5.2\\,\\mathrm{kb}$，产生相互的大小变化。**\n$TnX$转座子被指定为“Tn3家族复制型转座子”。选择复制型还是保守（剪切-粘贴）型转座是转座酶和转座子本身所固有的。删除解离酶基因，它参与一个独立的后续步骤，并不会改变初始的转座机制。转座仍将是复制型的，通过共整合体进行。\n**结论：错误**\n\n**D. 在 $\\Delta tnpR\\;recA^{+}$ 背景下，将检测到两类产物：约 $22.2\\,\\mathrm{kb}$ 的大共整合体，以及频率相对于野生型降低的、大小约为 $|P_T| + |TnX| \\approx 10.0\\,\\mathrm{kb}$ 的简单目标插入产物，因为重复的 $TnX$ 拷贝之间的同源重组可以在没有解离酶的情况下低效地解离共整合体。**\n该陈述与我们对情况2的分析完全吻合。共整合体($22.2\\,\\mathrm{kb}$)形成并积累，因为主要的解离酶途径缺失。次要的、效率较低的RecA介导的途径允许一些解离发生，产生简单的插入产物($10.0\\,\\mathrm{kb}$)。这种低效率解释了为什么两种分子都被观察到，以及为什么简单插入的频率降低。\n**结论：正确**\n\n**E. 解离酶功能的丧失会废除转座，因此只能回收未经修饰的 $P_D$ 和 $P_T$。**\n这是错误的。转座由转座酶启动，而题中说明转座酶是完整的。解离酶是转座中间产物*解离*所必需的，而不是其形成所必需的。转座将会发生，导致共整合体的形成。因此，将会回收修饰过的质粒。\n**结论：错误**\n\n**F. 因为解离酶通常通过结合res位点并抑制转座酶启动子来调节转录，所以 $\\Delta tnpR$ 供体倾向于增加共整合体形成的初始速率；然而，仅检测 $P_T$ 简单大小变化的分析方法会低估 $\\Delta tnpR$ 菌株中的转座，因为未解离的共整合体积累并作为约 $22.2\\,\\mathrm{kb}$ 的大得多的分子种类迁移，而不是作为 $P_T$ 的 $+5.2\\,\\mathrm{kb}$ 大小变化。**\n该陈述引入了TnpR在Tn3系统中的一个已知调控作用。TnpR抑制其自身的转录以及转座酶($tnpA$)的转录。删除$tnpR$解除了这种抑制，导致更高水平的转座酶，从而提高了共整合体形成的频率。陈述的第二部分正确地指出了一个重要的实验后果：如果一个人的分析方法只设计用来检测最终的解离产物（$10.0\\,\\mathrm{kb}$ 的质粒），他就会错过所有被困在共整合体阶段（$22.2\\,\\mathrm{kb}$）的转座事件。这将导致对真实转座频率的低估，而该频率在机制上是增加的。这是一个微妙但正确的观点。\n**结论：正确**", "answer": "$$\\boxed{ADF}$$", "id": "2862678"}, {"introduction": "在基因组学时代，通过计算方法识别转座元件是一项基本技能。这项练习挑战你的算法思维，要求你设计一种方法来发现推定的插入序列，并评估其在随机背景模型下的统计显著性。你将运用生物信息学和统计学原理，制定一种策略来从DNA序列中的偶然事件中区分出真正的生物学信号。[@problem_id:2862714]", "problem": "给定一个与原核转座元件相关的计算基因组学任务，专注于检测开放阅读框（ORF）周围的候选末端反向重复序列（TIR）和靶位点重复（TSD），并在一个无效模型下估计一个解析性假阳性率。解决方案必须是一个完整的程序，该程序实现检测算法，并使用基于核苷酸独立性原则的统计模型计算一个保守的解析性假阳性率。\n\n任务背景、定义和假设：\n\n- 末端反向重复序列（Terminal Inverted Repeat）被定义为元件两侧的一对DNA片段，一个在左侧，一个在右侧，使得一个片段是另一个片段的反向互补，最多允许有界数量的错配。靶位点重复（Target Site Duplication）被定义为宿主基因组上紧邻两个TIR外侧的一段相同的短序列，在元件插入时产生。插入序列（IS）元件通常被此类特征所包围，同时含有一个编码转座酶的开放阅读框。\n- 你将在一个无效假设下工作，即DNA序列中的每个核苷酸都是独立同分布（i.i.d.）生成的，其背景频率为$\\left(f_A, f_C, f_G, f_T\\right)$，其中 $f_A + f_C + f_G + f_T = 1$。\n- 坐标以$0$-基、半开区间的形式给出：一个ORF由$\\left[s, e\\right)$指定，意味着它从索引$s$开始，到索引$e$之前结束。\n- 你必须从第一性原理推导一个有效的统计模型来：\n  1. 在无效模型下，计算两个独立采样的长度为$L$的片段在至少$M$个位置上作为反向互补匹配的概率。\n  2. 计算两个独立采样的长度为$\\ell$的片段完全相同的概率。\n  3. 将检测到的TIR对和TSD的证据合并为一个单一的联合概率，该概率表示在无效模型下观察到至少同样极端证据的可能性。\n  4. 对所有TIR对比较和所有测试的TSD长度进行多重检验校正，为所报告的候选者生成一个保守的、解析推导的假阳性率估计。使用一个有效的家族错误率界限，如Bonferroni校正：如果$p_{\\text{local}}$是所选候选者的局部联合概率，而$m$是测试的假设总数，则一个保守的校正值为$\\min\\left(1, m \\cdot p_{\\text{local}}\\right)$。\n\n算法要求：\n\n- 对于每个测试用例，考虑ORF周围的一个左窗口和一个右窗口：\n  - 左窗口是区间$\\left[\\max(0, s - w), s\\right)$，长度为$w_L = s - \\max(0, s - w)$。\n  - 右窗口是区间$\\left[e, \\min(N, e + w)\\right)$，长度为$w_R = \\min(N, e + w) - e$，其中$N$是序列长度，$w$是给定的窗口大小。\n- 候选TIR搜索：\n  - 在整数范围$\\left[L_{\\min}, L_{\\max}\\right]$内的所有长度$L$上，考虑完全在左窗口内的每个长度为$L$的左子串，以及完全在右窗口内的每个长度为$L$的右子串。对于每一对，计算在$L$个对齐位置上的反向互补匹配数$M$和错配数$e = L - M$。\n  - 在所有满足$e \\le e_{\\max}$的配对中，选择最大化$M$（等效于最小化$e$）的单个最佳候选者。如果出现平局，可以优先选择更大的$L$，然后是字典序最早的左右起始位置。如果没有配对满足$e \\le e_{\\max}$，则报告未发现，并将解析性假阳性率估计设置为$1$。\n- 候选TSD检测：\n  - 给定所选的TIR对，其左坐标为$\\left[i_L, i_L + L\\right)$，右坐标为$\\left[j_R, j_R + L\\right)$，检测整数范围$\\left[\\ell_{\\min}, \\ell_{\\max}\\right]$内最长的精确匹配长度$\\ell$，使得左TIR紧邻上游的片段$\\left[i_L - \\ell, i_L\\right)$与右TIR紧邻下游的片段$\\left[j_R + L, j_R + L + \\ell\\right)$完全匹配，并且两者都在边界内。如果不存在这样的$\\ell \\ge \\ell_{\\min}$，则设置$\\ell = 0$并认为TSD的贡献缺失。\n- 基于基本原理的统计建模：\n  - 令$r$表示在i.i.d.背景下，两个独立核苷酸成为反向互补匹配的单位位置概率。仅使用独立性和互补性规则，从$\\left(f_A, f_C, f_G, f_T\\right)$推导$r$。\n  - 在位置间独立的假设下，$L$个对齐位置上的反向互补匹配数$K$遵循一个你必须推导的分布。用它来计算尾概率$p_{\\text{TIR,local}} = \\Pr\\left[K \\ge M\\right]$。\n  - 令$s$表示在相同背景下，两个独立核苷酸相同的单位位置概率。仅使用独立性从$\\left(f_A, f_C, f_G, f_T\\right)$推导$s$。长度为$\\ell$的精确TSD的局部概率$p_{\\text{TSD,local}}$由$s$和$\\ell$推导得出。\n  - 将TIR和TSD的证据合并为一个单一的局部概率$p_{\\text{local}}$，用于表示观察到的事件或更极端的事件，使用一个由你指定的独立性假设证明的有原则的组合方法。如果$\\ell = 0$，则通过取$p_{\\text{local}} = p_{\\text{TIR,local}}$来忽略TSD证据。\n  - 令$m_{\\text{pairs}}$为在所有$L \\in \\left[L_{\\min}, L_{\\max}\\right]$上执行的TIR对比较总数。你必须计算\n    $$m_{\\text{pairs}} = \\sum_{L=L_{\\min}}^{L_{\\max}} \\left(\\max\\left(0, w_L - L + 1\\right)\\right) \\cdot \\left(\\max\\left(0, w_R - L + 1\\right)\\right)$$\n    如果$\\ell \\ge \\ell_{\\min}$，令$m_{\\text{tsd}}$为测试的TSD长度数量，即$m_{\\text{tsd}} = \\ell_{\\max} - \\ell_{\\min} + 1$，否则$m_{\\text{tsd}} = 1$。使用一个保守的Bonferroni校正，其中$m = m_{\\text{pairs}} \\cdot m_{\\text{tsd}}$，为单个最佳候选者生成解析性假阳性率估计$\\widehat{\\mathrm{FDR}} = \\min\\left(1, m \\cdot p_{\\text{local}}\\right)$。如果没有有效的候选者（$m_{\\text{pairs}} = 0$或没有配对满足$e \\le e_{\\max}$），则设置$\\widehat{\\mathrm{FDR}} = 1$。\n  \n用于实现和测试的输入：\n\n实现你的程序以运行以下包含四个用例的测试套件。对于每个用例，计算并仅报告最终的解析性假阳性率估计$\\widehat{\\mathrm{FDR}}$，以小数形式表示，并四舍五入到小数点后六位。\n\n- 测试用例 1（清晰的TIR和TSD；均匀背景）：\n  - 序列 $S_1$：\n    - 左侧翼： CCCCC C\n    - TSD： AAG\n    - 左TIR： ACGTACGTAC\n    - 内部： AAAACCCCGGGGTTTT\n    - 右TIR： GTACGTACGT\n    - TSD： AAG\n    - 右侧翼： TTTTTT\n    - 串联： \"CCCCCCAAGACGTACGTACAAAACCCCGGGGTTTTGTACGTACGTAAGTTTTTT\"\n  - ORF坐标 $\\left[s, e\\right) = \\left[20, 32\\right)$\n  - 窗口 $w = 12$\n  - TIR长度范围 $\\left[L_{\\min}, L_{\\max}\\right] = \\left[6, 12\\right]$\n  - 最大错配数 $e_{\\max} = 1$\n  - TSD长度范围 $\\left[\\ell_{\\min}, \\ell_{\\max}\\right] = \\left[3, 3\\right]$\n  - 背景频率 $\\left(f_A, f_C, f_G, f_T\\right) = \\left(0.25, 0.25, 0.25, 0.25\\right)$\n\n- 测试用例 2（在零错配下无TIR可检测；均匀背景）：\n  - 序列 $S_2$：\n    - \"GATTACAGATTACAGATTACAGATTACAGATTACAGATTACA\"\n  - ORF坐标 $\\left[s, e\\right) = \\left[18, 24\\right)$\n  - 窗口 $w = 10$\n  - TIR长度范围 $\\left[L_{\\min}, L_{\\max}\\right] = \\left[6, 10\\right]$\n  - 最大错配数 $e_{\\max} = 0$\n  - TSD长度范围 $\\left[\\ell_{\\min}, \\ell_{\\max}\\right] = \\left[3, 5\\right]$\n  - 背景频率 $\\left(f_A, f_C, f_G, f_T\\right) = \\left(0.25, 0.25, 0.25, 0.25\\right)$\n\n- 测试用例 3（边界长度的TIR，有一个错配；均匀背景）：\n  - 序列 $S_3$：\n    - 左侧翼： GGGG\n    - TSD： CGTA\n    - 左TIR： AACCGA\n    - 内部： TTTTTT\n    - 右TIR： ACGGTT\n    - TSD： CGTA\n    - 右侧翼： CCCC\n    - 串联： \"GGGGCGTAAACCGATTTTTTACGGTTCGTACCCC\"\n  - ORF坐标 $\\left[s, e\\right) = \\left[14, 20\\right)$\n  - 窗口 $w = 10$\n  - TIR长度范围 $\\left[L_{\\min}, L_{\\max}\\right] = \\left[6, 6\\right]$\n  - 最大错配数 $e_{\\max} = 1$\n  - TSD长度范围 $\\left[\\ell_{\\min}, \\ell_{\\max}\\right] = \\left[4, 4\\right]$\n  - 背景频率 $\\left(f_A, f_C, f_G, f_T\\right) = \\left(0.25, 0.25, 0.25, 0.25\\right)$\n\n- 测试用例 4（清晰的TIR和TSD；非均匀背景）：\n  - 序列 $S_4$：\n    - 左侧翼： TTTTT\n    - TSD： GGCAT\n    - 左TIR： ATGCCGTA\n    - 内部： CCCCAAAAGGGGTTTT\n    - 右TIR： TACGGCAT\n    - TSD： GGCAT\n    - 右侧翼： AAAAA\n    - 串联： \"TTTTTGGCATATGCCGTACCCCAAAAGGGGTTTTTACGGCATGGCATAAAAA\"\n  - ORF坐标 $\\left[s, e\\right) = \\left[20, 34\\right)$\n  - 窗口 $w = 12$\n  - TIR长度范围 $\\left[L_{\\min}, L_{\\max}\\right] = \\left[7, 10\\right]$\n  - 最大错配数 $e_{\\max} = 0$\n  - TSD长度范围 $\\left[\\ell_{\\min}, \\ell_{\\max}\\right] = \\left[5, 5\\right]$\n  - 背景频率 $\\left(f_A, f_C, f_G, f_T\\right) = \\left(0.30, 0.20, 0.20, 0.30\\right)$\n\n程序输出规范：\n\n- 你的程序应使用上述要求为每个测试用例的单个最佳候选者计算解析性假阳性率估计$\\widehat{\\mathrm{FDR}}$。\n- 最终的程序输出必须是包含四个浮点数的单行列表，对应四个测试用例，精确到小数点后六位，没有空格，并用方括号括起来。例如，输出行应如下所示：\"[0.123456,0.000001,1.000000,0.532100]\"。", "solution": "该问题陈述是一个有效且定义明确的计算生物学任务。其科学基础植根于遗传学和生物统计学的原理，为识别推定的转座元件并评估其统计显著性提供了一套清晰客观的要求。所有必要的参数和数据都已提供，并且没有内部矛盾或逻辑缺陷。我们现在将从第一性原理出发推导解决方案。\n\n任务的核心是区分真实的生物信号——由末端反向重复序列（TIRs）和靶位点重复（TSDs）标记的转座元件——与随机序列假象。这通过构建一个无效假设，计算在此假设下观察到证据的概率，并对该概率进行校正以考虑到所执行的广泛搜索来实现。\n\n**1. 统计框架：无效模型**\n\n我们首先将无效假设形式化：DNA序列是一个由独立同分布（i.i.d.）过程生成的随机序列，其中每个位置的每个核苷酸都独立地从集合 $\\{A, C, G, T\\}$ 中抽取，具有固定的背景频率 $(f_A, f_C, f_G, f_T)$，使得 $\\sum_{i \\in \\{A,C,G,T\\}} f_i = 1$。\n\n在此模型下，我们可以推导出两个独立抽取的核苷酸 $N_1$ 和 $N_2$ 之间基本匹配事件的概率。\n\n- **反向互补匹配的概率 ($r$)**：当核苷酸对 $(N_1, N_2)$ 是 $(A, T)$、$(T, A)$、$(C, G)$ 或 $(G, C)$ 之一时，发生反向互补匹配。由于独立性，总概率 $r$ 是这些不相交事件的概率之和：\n$$r = P(N_1=A, N_2=T) + P(N_1=T, N_2=A) + P(N_1=C, N_2=G) + P(N_1=G, N_2=C)$$\n$$r = f_A f_T + f_T f_A + f_C f_G + f_G f_C = 2(f_A f_T + f_C f_G)$$\n\n- **相同匹配的概率 ($s$)**：当 $N_1$ 和 $N_2$ 是相同的核苷酸时，发生相同匹配。概率 $s$ 为：\n$$s = P(N_1=A, N_2=A) + P(N_1=C, N_2=C) + P(N_1=G, N_2=G) + P(N_1=T, N_2=T)$$\n$$s = f_A^2 + f_C^2 + f_G^2 + f_T^2$$\n\n这两个概率 $r$ 和 $s$ 是我们统计检验的基础参数。\n\n**2. TIR 证据的局部概率 ($p_{\\text{TIR,local}}$)**\n\n一个候选TIR对由两个长度为 $L$ 的序列组成。在无效假设下，它们被视为两个独立的随机序列。将左片段与右片段的反向互补序列进行比较，等同于比较两个独立的长度为 $L$ 的随机序列在每个位置上是否反向互补。\n\n$L$ 个位置中的每一个都代表一个独立的伯努利试验，其中“成功”是发生反向互补匹配，概率为 $r$。因此，$L$ 个位置中的总匹配数 $K$ 服从二项分布：$K \\sim B(L, r)$。\n\n问题要求通过最大化匹配数 $M$ 来选择“最佳”候选者。此最佳候选者的统计显著性通过计算观察到至少同样“极端”（即至少同样好）结果的概率来评估。这对应于尾概率 $\\Pr(K \\ge M)$。这是TIR证据的局部p值：\n$$p_{\\text{TIR,local}} = \\Pr(K \\ge M | L, r) = \\sum_{k=M}^{L} \\binom{L}{k} r^k (1-r)^{L-k}$$\n\n**3. TSD 证据的局部概率与组合概率 ($p_{\\text{local}}$)**\n\nTSD 是一个短序列的精确重复。我们在范围 $[\\ell_{\\min}, \\ell_{\\max}]$ 内搜索长度为 $\\ell$ 的最长精确TSD。在i.i.d.无效模型下，TIRs两侧的区域与TIRs本身以及彼此之间都是独立的。因此，TIR和TSD事件在统计上是独立的。\n\n在两个特定的非重叠区域之间观察到长度为 $\\ell$ 的精确TSD的局部概率是 $\\ell$ 次连续相同匹配的概率。由于核苷酸位置之间的独立性，这个概率是 $s^\\ell$。这代表了来自TSD的“证据”。\n\n为了结合TIR和TSD的证据，我们计算此复合事件在无效假设下的联合概率。由于事件是独立的，联合概率是它们各自概率的乘积。如果为最佳TIR候选者（在长度 $L$ 上有 $M$ 个匹配）找到了一个长度为 $\\ell \\ge \\ell_{\\min}$ 的TSD，则组合的局部概率是：\n$$p_{\\text{local}} = p_{\\text{TIR,local}} \\cdot s^{\\ell}$$\n如果没有找到长度至少为 $\\ell_{\\min}$ 的TSD，我们设置 $\\ell=0$，此时TSD不提供额外证据。在这种情况下，局部概率就是TIR的概率：\n$$p_{\\text{local}} = p_{\\text{TIR,local}}$$\n\n**4. 多重假设校正与最终的 $\\widehat{\\mathrm{FDR}}$**\n\n寻找最佳候选者的过程涉及大量的比较。我们在不同的长度和起始位置上测试了许多潜在的TIR对。这构成了一个多重假设检验问题，所得的 $p_{\\text{local}}$ 必须进行校正，以控制因偶然性而发现一个看似显著结果的膨胀概率。\n\n我们使用Bonferroni校正，这是一种控制家族错误率（FWER）的保守方法，它为假阳性率提供了上界。校正因子 $m$ 是执行的检验总数。\n\n- **TIR对检验次数 ($m_{\\text{pairs}}$)**：对于每个长度 $L \\in [L_{\\min}, L_{\\max}]$，在长度为 $w_L$ 的左窗口中有 $\\max(0, w_L - L + 1)$ 个可能的起始位置，在长度为 $w_R$ 的右窗口中有 $\\max(0, w_R - L + 1)$ 个。测试的TIR对总数为：\n$$m_{\\text{pairs}} = \\sum_{L=L_{\\min}}^{L_{\\max}} \\left(\\max\\left(0, w_L - L + 1\\right)\\right) \\cdot \\left(\\max\\left(0, w_R - L + 1\\right)\\right)$$\n\n- **TSD检验次数 ($m_{\\text{tsd}}$)**：如果找到了一个合格的TSD，搜索隐含地测试了 $[\\ell_{\\min}, \\ell_{\\max}]$ 范围内的所有长度。测试的TSD长度数量为 $m_{\\text{tsd}} = \\ell_{\\max} - \\ell_{\\min} + 1$。如果没有找到有效的TSD，则测试了一个单一的复合假设（即不存在TSD），因此我们取 $m_{\\text{tsd}} = 1$。\n\n总假设数是 $m = m_{\\text{pairs}} \\cdot m_{\\text{tsd}}$。经Bonferroni校正的p值，我们用作解析性假阳性率估计 $\\widehat{\\mathrm{FDR}}$，是：\n$$\\widehat{\\mathrm{FDR}} = \\min\\left(1, m \\cdot p_{\\text{local}}\\right)$$\n\n如果初始搜索没有找到满足最大错误约束（$e \\le e_{\\max}$）的TIR候选者，或者如果搜索空间为空（$m_{\\text{pairs}} = 0$），则无法做出统计上显著的判断，我们设置 $\\widehat{\\mathrm{FDR}} = 1$。\n\n**5. 算法实现**\n\n程序化解决方案直接实现了这一逻辑。它首先计算必要的搜索窗口参数（$w_L, w_R$）和统计参数（$r, s$）。然后，通过遍历所有指定的长度 $L$ 和左右窗口中所有可能的起始位置，执行穷举搜索以找到最佳TIR候选者。最佳候选者基于严格的层次化标准进行选择：最小错配数 $e$、最大长度 $L$ 和字典序最小的起始位置 $(i_L, j_R)$。\n\n一旦确定了最佳TIR，就在指定的侧翼区域和长度范围内进行最长TSD的搜索。在确定最佳TIR和TSD后，使用推导出的公式计算局部概率，其中二项分布尾概率使用 `scipy.stats.binom.sf` 进行高效计算。最后，计算多重检验校正因子 $m$，并确定最终的 $\\widehat{\\mathrm{FDR}}$。此过程独立应用于提供的每个测试用例。", "answer": "$$\\boxed{\\text{[0.000003,1.000000,0.000078,0.000000]}}$$", "id": "2862714"}]}