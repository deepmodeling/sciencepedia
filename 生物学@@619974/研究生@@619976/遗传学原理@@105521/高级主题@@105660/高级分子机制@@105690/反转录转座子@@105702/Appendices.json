{"hands_on_practices": [{"introduction": "在分子生物学中，报告基因检测是量化特定生物过程的关键工具。这项练习将挑战您像基因工程师一样思考，利用方向依赖性剪接等基本原理，设计一个能够特异性报告真实逆转录转座事件的精巧系统。掌握这种设计逻辑对于在实验室环境中准确量化L1活性至关重要。[@problem_id:2846686]", "problem": "您正在设计一个基于细胞的报告系统，用以在哺乳动物细胞中定量长散布核元件-1 (LINE-1) 的反转座。该系统使用新霉素磷酸转移酶基因 (Neo) 并通过遗传霉素 (G418) 进行筛选。从基本原理出发：中心法则（DNA转录为前体信使RNA，内含子由剪接体利用有方向性的$5'$供体和$3'$受体位点移除，成熟的信使RNA被翻译），以及LINE-1的靶标引物反转录 (TPRT) 机制（一个聚腺苷酸化的LINE-1 RNA模板在染色体切口处被反转录并以互补DNA的形式插入）。一个有效的设计必须确保只有在满足以下两个条件时才会出现G418抗性克隆：(i) 报告基因盒序列首先在LINE-1 RNA的背景下被转录并正确剪接，以及 (ii) 该剪接后的序列被复制成DNA并通过TPRT整合。您将选择最严谨的设计和理由来达到这种特异性。\n\n以下哪个选项最能满足这些要求，并正确解释了为什么G418抗性能够特异性地报告成功的TPRT和剪接？\n\nA. 将一个猿猴病毒$40$ (SV$40$) 启动子–Neo–聚腺苷酸化信号盒以相对于LINE-1转录的反义方向插入到LINE-1的$3'$非翻译区。用一个合成内含子中断Neo基因，该内含子相对于Neo是反义的（因此其$5'$供体/$3'$受体在Neo的转录方向上是颠倒的），但相对于LINE-1转录本是正义的。供体质粒无法表达功能性Neo，因为在Neo的转录方向上，反义内含子不被剪接体识别，从而导致编码序列被破坏。然而，当LINE-1前体信使RNA生成时，该内含子呈现为正义方向并被剪接掉；随后，经过剪接的LINE-1 RNA被TPRT反转录并整合，产生一个带有无内含子、含启动子的Neo的基因组拷贝，从而赋予稳定的G418抗性。\n\nB. 将一个SV$40$启动子–Neo–聚腺苷酸化信号盒以反义方向插入LINE-1，并在Neo内部放置一个正义方向的内含子。由于内含子相对于Neo是正义方向的，在源自供体质粒的转录本中会发生剪接，从而允许功能性Neo的基础表达并因此产生G418抗性；因此，抗性克隆的任何增加都必须反映TPRT的增强。\n\nC. 将一个被正义方向内含子中断的、无启动子的Neo，以相对于LINE-1的正义方向插入到LINE-1的$3'$非翻译区。只有在反转座之后，宿主的基因组启动子才会驱动Neo的表达，并且由于内含子相对于Neo是正义方向的，可以保证内含子被移除。因此，G418抗性特异性地标记TPRT。\n\nD. 将一个SV$40$启动子–Neo–聚腺苷酸化信号盒以相对于LINE-1的正义方向放置，并省略任何内含子以避免剪接复杂性。因为Neo存在于LINE-1信使RNA上，只有当该RNA作为反转录的模板时，翻译才会产生Neo蛋白；因此，G418抗性必然报告TPRT事件。", "solution": "我们从与此遗传报告基因设计相关的基本原理开始分析。\n\n1. 转录和剪接具有方向依赖性。前体信使RNA的剪接要求内含子$5'$端的剪接供体和$3'$端的剪接受体相对于转录方向呈现正确的朝向。如果一个内含子相对于转录本被置于反向（反义）方向，其保守的$5'$和$3'$剪接信号会显得颠倒（例如，在转录链上，经典的GT–AG变为CT–AC），且不被剪接体识别，因此该内含子不会被移除。\n\n2. 通过靶标引物反转录 (TPRT) 进行的LINE-1反转座需要一个聚腺苷酸化的LINE-1信使RNA。LINE-1核糖核蛋白在基因组DNA上引入一个单链切口，将信使RNA的poly(A)尾与富含T的靶点退火，并利用该RNA作为模板进行反转录，生成随后被整合的互补DNA。任何携带在LINE-1信使RNA内的序列都将被复制到新的互补DNA插入片段中，并且至关重要的是，只有存在于经过加工的（即剪接后的）信使RNA中的序列才会被传递下去。\n\n3. 使用遗传霉素 (G418) 进行筛选要求细胞核内的一个启动子在多次细胞倍增过程中持续表达一个功能性的新霉素磷酸转移酶开放阅读框，这意味着稳定的基因组表达。因此，要将G418抗性与TPRT联系起来，设计必须能阻止功能性Neo从供体质粒上表达，以及从任何绕过RNA中间体的DNA事件（例如，质粒直接整合）中表达，同时只允许由经过剪接的LINE-1信使RNA产生并整合到基因组中的无内含子Neo拷贝进行表达。\n\n评估每个选项：\n\n选项 A:\n- 设计：SV$40$启动子–Neo–poly(A)信号盒以相对于LINE-1转录的反义方向插入到LINE-1的$3'$非翻译区。内含子相对于Neo是反义的，但相对于LINE-1是正义的。\n- 作用机制：源自供体质粒上SV$40$启动子的转录本会遇到反义方向的内含子；由于$5'$供体/$3'$受体信号是颠倒的，剪接体无法移除该内含子。该内含子破坏了Neo编码序列，翻译后不产生功能性酶；因此，供体质粒不能赋予G418抗性。相反，LINE-1前体信使RNA以相反（互补）的方向包含了该基因盒序列；在此背景下，同一个内含子呈现为正义方向并被有效剪接掉。经过加工的LINE-1信使RNA，现在携带了一个无内含子的Neo序列，作为TPRT的模板。整合之后，所产生的基因组拷贝包含一个带有自身SV$40$启动子和聚腺苷酸化信号的无内含子Neo基因，从而能够实现Neo的强劲转录和翻译，并赋予稳定的G418抗性。供体质粒的直接DNA整合不会移除内含子，也不会产生抗性，从而保持了对RNA介导的TPRT路径的特异性。这一逻辑满足了两个必要条件：在LINE-1 RNA中正确剪接和通过TPRT进行复制/整合。\n- 结论：正确。\n\n选项 B:\n- 设计：该基因盒相对于LINE-1是反义的，但内含子相对于Neo是正义的。\n- 作用机制：由供体质粒上SV$40$启动子驱动的转录本会遇到Neo内一个正义方向的内含子，剪接体将移除该内含子，直接从质粒中产生一个无内含子、功能性的Neo信使RNA。这导致了G418抗性的产生，而无需LINE-1的转录、在LINE-1背景下的剪接或TPRT。因此，抗性对于TPRT不具有特异性，并且违反了阻止供体质粒表达的要求。\n- 结论：错误。\n\n选项 C:\n- 设计：无启动子的Neo和一个正义方向的内含子，以相对于LINE-1的正义方向被放置。\n- 作用机制：反转座后，基因组拷贝将携带一个无启动子的Neo；其表达将依赖于偶然整合到宿主启动子的下游。即使TPRT发生且内含子在LINE-1信使RNA中被移除，许多真实的反转座事件也会因为未能捕获启动子而无法被记分。反之，来自非TPRT事件（例如，供体质粒随机整合到一个转录单元中）的启动子陷阱表达可能产生G418抗性，尽管并没有发生LINE-1 RNA的加工和TPRT。因此，抗性不是TPRT加剪接的特异性读出。\n- 结论：错误。\n\n选项 D:\n- 设计：该基因盒相对于LINE-1是正义的，并且完全没有内含子。\n- 作用机制：没有内含子，供体质粒上的SV$40$启动子会立即驱动功能性Neo的表达，导致G418抗性的产生，这与任何LINE-1活动无关。此外，将Neo蛋白的产生等同于TPRT在概念上是错误的：从信使RNA翻译并不意味着该RNA被反转录并整合了。这违反了将抗性严格与通过TPRT发生的RNA到DNA转换以及剪接的发生联系起来的要求。\n- 结论：错误。\n\n因此，只有选项A提供了一种设计，通过方向依赖性剪接以及包含专用的启动子和聚腺苷酸化信号，确保G418抗性仅在报告基因序列(i) 在LINE-1转录本中被正确剪接，并且(ii) 通过TPRT被捕获到基因组中时才会产生，同时防止了来自供体DNA的伪表达。", "answer": "$$\\boxed{A}$$", "id": "2846686"}, {"introduction": "L1逆转录转座子的核心引擎由其编码的ORF1p和ORF2p蛋白驱动。这个思想实验旨在帮助您理清它们各自独立又相互协作的功能，特别是“顺式偏好”这一关键概念，以及像Alu这样的非自主元件如何“劫持”这套机制。理解这些蛋白质层面的动力学是掌握基因组中不同逆转录转座子家族行为的关键。[@problem_id:2846740]", "problem": "一个人类细胞系含有内源性的长散布核元件-1 (LINE-1，简称L1) 逆转座子和Alu短散布核元件 (SINEs)。每个活跃的L1编码开放阅读框1蛋白 (ORF1p)（一种RNA结合三聚体分子伴侣）和开放阅读框2蛋白 (ORF2p)（一种核酸内切酶和逆转录酶）。Alu元件不编码蛋白质，但带有一个多聚腺苷酸尾巴。非长末端重复序列逆转座子的逆转座通过靶标引物逆转录 (TPRT) 进行，在此过程中，核酸内切酶在基因组DNA上造成一个切口，逆转录酶直接在靶位点以RNA为模板合成互补DNA (cDNA)。关于L1的一个得到充分支持的观察是，其蛋白质对其编码自身的RNA表现出强烈的顺式偏好性，形成核糖核蛋白 (RNP) 颗粒，该颗粒被转运到细胞核中执行TPRT。\n\n你通过基因工程改造细胞，使其从一个异源启动子表达ORF2p，但不共表达L1 RNA或ORF1p，同时使用针对L1报告基因RNA和Alu报告基因RNA的标准报告基因分析来测量逆转座。在另一个平行实验条件下，你在维持ORF2p过表达的同时，使用小干扰RNA敲低内源性的ORF1p。假设中心法则 (DNA $\\rightarrow$ RNA $\\rightarrow$ 蛋白质)、RNP作为分子伴侣将RNA模板带入细胞核的要求、L1蛋白对其编码RNA的顺式偏好性，以及ORF2p在核酸内切酶介导的切口和逆转录中的酶促作用均为有效的基本原则。\n\n哪个选项最能合理解释为什么仅过表达ORF2p可以动员SINEs但不能有效动员新的L1拷贝，并最准确地预测在持续过表达ORF2p的情况下敲低ORF1p时，报告基因分析和基因组稳定性的定性结果？\n\nA. ORF2p以反式作用方式提供酶功能（核酸内切酶和逆转录酶）并识别多聚腺苷酸尾巴，使得Alu SINE RNA能够在不需要ORF1p的情况下寄生于ORF2p进行TPRT，而高效的L1逆转座则需要一个依赖于ORF1p的L1 RNP来伴护和保护L1 RNA并执行顺式偏好性。因此，仅过表达ORF2p会增加SINE报告基因的动员，但不会增加L1报告基因的动员；当敲低ORF1p时，L1报告基因活性进一步降低，SINE报告基因活性保持升高或增加，由细胞mRNA形成的加工过的假基因增多，并且由于不受约束的ORF2p核酸内切酶活性，DNA双链断裂增加。\n\nB. ORF2p对于所有逆转座都是充分的；ORF1p对于L1和Alu都是可有可无的。因此，ORF2p过表达会同时增加L1和SINE报告基因的动员，而敲低ORF1p对两种报告基因或基因组稳定性都没有影响。\n\nC. 因为Alu SINEs是缺少$5'$端帽的RNA聚合酶III转录本，ORF2p无法将它们用作模板，但它可以在没有ORF1p的情况下高效作用于带帽的L1 RNA。因此，ORF2p过表达会增加L1报告基因的动员而非SINEs；当敲低ORF1p时，L1报告基因活性不变，DNA损伤极小。\n\nD. ORF1p的主要作用是抑制SINE的寄生；因此，仅过表达ORF2p通常无法动员SINEs，而L1拷贝可以在没有ORF1p的情况下动员。在ORF2p过表达的情况下敲低ORF1p会同时增加L1和SINE报告基因的动员，并通过减少RNP拥挤来降低DNA损伤。\n\nE. 在没有ORF1p的情况下，ORF2p缺乏核酸内切酶活性，因此仅有ORF2p时，L1和SINEs都不能动员；在敲低ORF1p后，两种报告基因活性都降低，但DNA损伤仍然增加，因为ORF2p在染色质上积累。", "solution": "问题陈述已经过验证，被认为是合理的。它具有科学依据，阐述清晰，并包含足够的信息，可以根据所提供的关于逆转座子的分子遗传学原理得出逻辑结论。\n\n该问题要求根据已建立的LINE-1 (L1)和Alu SINE逆转座原理，对一个实验观察进行合理解释，并对后续实验结果进行预测。让我们根据给定的条件来分析这个系统。\n\n**基本原理：**\n1.  **L1逆转座：**一个活跃的L1元件产生一个双顺反子RNA，该RNA被翻译成开放阅读框1蛋白 (ORF1p) 和开放阅读框2蛋白 (ORF2p)。\n2.  **顺式偏好性：**ORF1p和ORF2p优先结合到编码它们的同一个L1 RNA分子上，形成一个核糖核蛋白 (RNP) 颗粒。\n3.  **ORF1p功能：**ORF1p是一种RNA结合分子伴侣，对于在RNP内覆盖、稳定和伴护长的L1 RNA至关重要。\n4.  **ORF2p功能：**ORF2p拥有逆转座所需的酶活性：一种核酸内切酶，用于在靶基因组DNA上造成切口；一种逆转录酶，用于从RNA模板合成cDNA。这个过程被称为靶标引物逆转录 (TPRT)。\n5.  **SINE逆转座：**Alu SINEs是非自主性元件。它们不编码任何蛋白质。它们被转录成带有聚腺苷酸尾巴的RNA，并且必须“寄生”于L1的机制（特别是ORF2p，也可能包括ORF1p）才能被逆转座。\n\n**实验条件分析：**\n\n**条件1：仅过表达ORF2p**\n在这种设置下，ORF2p从一个异源启动子表达，这意味着其mRNA不是一个全长的L1转录本。因此，顺式偏好性的自然机制被颠覆了。细胞中充满了未与L1 RNA或ORF1p预先结合的“游离”ORF2p。\n\n*   **L1报告基因的动员：**为了使L1报告基因RNA能被高效逆转座，它必须形成一个稳定的RNP。这需要ORF1p（作为分子伴侣）和ORF2p。由于ORF1p没有被过表达，L1报告基因必须争夺低水平的内源性ORF1p。此外，过表达的ORF2p是以反式作用方式提供的，由于L1机制强烈的顺式偏好性，这是一种形成L1 RNP的低效方式。缺乏足够的ORF1p分子伴侣使得长而脆弱的L1 RNA容易降解，并阻碍了能够进入细胞核并执行TPRT的功能性RNP的形成。因此，预计L1报告基因的动员效率会非常低。\n*   **Alu SINE报告基因的动员：**Alu RNA是带有聚腺苷酸尾巴的短非编码RNA。这些元件可以寄生于以反式作用方式提供的大量游离ORF2p。公认的事实是ORF2p可以结合到多聚腺苷酸化的RNA上。游离的ORF2p可以结合到一个Alu RNA上，将其转运（或在细胞核中与其相遇），并以该Alu RNA为模板执行TPRT。与长的L1 RNA相比，这个过程对基于ORF1p的RNP没有同样严格的要求，从而使得仅ORF2p就能动员SINEs。\n\n这一分析合理解释了问题中所述的观察结果：仅过表达ORF2p能够动员SINEs，但不能有效动员新的L1拷贝。\n\n**条件2：过表达ORF2p并敲低内源性ORF1p**\n在这里，关键的ORF1p分子伴侣的水平被进一步降低。\n\n*   **L1报告基因的动员：**由于缺乏共表达的ORF1p以及顺式偏好性的破坏，动员本已效率低下。敲低剩余的内源性ORF1p将使L1报告基因RNA更加缺乏其必需的分子伴侣，使得功能性RNP的形成几乎不可能。因此，L1报告基因活性应会进一步下降。\n*   **Alu SINE报告基因的动员：**由于SINE的动员主要依赖于寄生游离的ORF2p，并且对ORF1p的依赖性较低，该活性应保持在较高水平。一些证据表明ORF1p可能与SINE RNA竞争结合ORF2p；如果是这样，移除ORF1p甚至可能增加SINE的动员。因此，预计SINE活性将保持高水平或可能增加。\n*   **基因组稳定性：**ORF1p不仅是一个分子伴侣，也是RNP的一个关键组成部分，据信它能调节和靶向ORF2p强大的酶活性。在缺乏足够ORF1p的情况下，大量过量的“裸露”ORF2p不受束缚和调节。其核酸内切酶活性可能导致广泛的、脱靶的DNA切口和双链断裂 (DSBs)，从而导致显著的基因组不稳定性。此外，其逆转录酶可以滥捕其他细胞的多聚腺苷酸化RNA（即细胞基因的mRNA），将其逆转录，并将产生的cDNA插回基因组，从而产生加工过的假基因。这是基因组损伤的另一个主要来源。\n\n**选项评估：**\n\n**A.** 该选项指出ORF2p以反式作用方式起作用，识别多聚腺苷酸尾巴，并在不需要ORF1p的情况下动员Alu SINEs。它正确地将此与需要依赖ORF1p的L1 RNP进行伴护和执行顺式偏好性的高效L1逆转座进行了对比。然后，它正确地预测，随着ORF1p的敲低，L1活性将下降，SINE活性将保持升高或增加，加工过的假基因形成将增多，并且由于不受约束的ORF2p核酸内切酶活性，DNA损伤 (DSBs) 将会增加。这与上述详细分析完全一致。\n**结论：正确**\n\n**B.** 该选项声称ORF1p对于L1和Alu的逆转座都是可有可无的。这在根本上是错误的。如问题给定条件所述，ORF1p的分子伴侣功能对于长的L1 RNA的完整性和加工至关重要。因此，其关于敲低ORF1p没有影响的预测也是错误的。\n**结论：错误**\n\n**C.** 该选项错误地声称ORF2p不能使用Alu SINE RNA作为模板，因为它们缺少一个$5'$端帽。ORF2p的识别主要由$3'$端的多聚腺苷酸尾巴介导，而不是$5'$端帽。该选项直接与问题中SINEs可以被动员的观察结果相矛盾。它还错误地声称L1可以在没有ORF1p的情况下高效动员，并且DNA损伤将是极小的。\n**结论：错误**\n\n**D.** 该选项错误地将ORF1p的主要作用描述为SINE寄生的抑制剂，而其已知的主要是作为L1 RNA的分子伴侣。然后，它通过声称仅ORF2p无法动员SINEs来与问题的前提相矛盾。其关于敲低ORF1p会增加L1动员的预测是不合逻辑的，因为这移除了一个必需的组分。关于DNA损伤会减少的说法与不受调节的ORF2p所带来的预期结果相反。\n**结论：错误**\n\n**E.** 该选项提出了一个强烈但通常不正确的断言，即没有ORF1p时ORF2p缺乏核酸内切酶活性。如果这是真的，那么仅过表达ORF2p就不能通过TPRT动员SINEs，这与问题的前提相矛盾。它对DNA损伤的解释也是矛盾的：如果ORF2p在没有ORF1p的情况下是酶学上无活性的，那么它仅仅在染色质上积累不应引起切口或断裂。\n**结论：错误**\n\n基于这一严谨的分析，选项A是唯一一个为观察到的现象和实验的预测结果提供了科学上合理且完整解释的选项。", "answer": "$$\\boxed{A}$$", "id": "2846740"}, {"introduction": "从实验室检测到大规模基因组学分析，确认个体基因组中新的逆转录转座子插入是现代遗传学的一项重要任务。这项实践提供了一个生物信息学流程的蓝图。您将学习如何将逆转录转座的生物学特征（如分裂读段和靶位点重复）转化为一套具体的计算规则和过滤器，从而从真实的测序数据中准确地识别新的插入事件。[@problem_id:2846706]", "problem": "您的任务是形式化一个计算识别流程，利用分裂读长和不一致读长对的证据，从短读长全基因组测序 (WGS) 数据中识别长散布核元件-1 (L1) 和 Alu 短散布核元件 (SINEs) 的非参考基因组插入，并实施明确的过滤器以减少重复区域中的假阳性。该流程必须表达为一个确定性决策函数，对于一个由一组特征总结的候选位点，该函数输出标签 L1、Alu 或 reject (拒绝) 中的一个。设计必须从遗传学和测序的第一性原理出发进行论证，但实现本身应遵循下文定义的精确、可复现的规则集。\n\n基础背景和可观察信号：\n- 中心法则和基因组结构意味着逆转录转座子插入会通过在参考基因组和插入元件序列之间创建新的连接点来改变参考基因组。跨越此类连接点的 Illumina 双末端短读长会产生分裂读长比对和不一致读长对信号。\n- 非长末端重复 (non-LTR) 逆转录转座子插入，包括长散布核元件-1 (LINE-1，缩写为 L1) 和 Alu，其典型特征是由于靶标引物逆转录，在插入位点处有一个多聚腺苷酸尾和一个短的靶位点重复。\n- 在重复区域，比对模糊性会增加伪信号；稳健的过滤器必须考虑比对质量、重复背景和信号一致性。\n\n使用以下每个候选位点的变量来定义决策规则：\n- 分裂读长计数：$s_L, s_R$ (左、右断点)。\n- 不一致读长对计数：$d_L, d_R$ (左、右集群)。\n- 分裂读长的中位比对质量：$m_L, m_R$。\n- 在 $1,000$ 碱基对窗口内的局部重复或低可比对性分数：$r$，表示为 $[0,1]$ 区间内的实数。\n- 与同家族最近的已注释参考转座元件的邻近度 (单位为碱基对)：$p$，必须以碱基对 (bp) 为单位处理。\n- 来自读长对布局的方向一致性标志：$o \\in \\{\\text{True}, \\text{False}\\}$。\n- 从软剪切一致性序列中估计的多聚腺苷酸尾长度：$a$ (单位为碱基对)。\n- 靶位点重复长度估计：$t$ (单位为碱基对)。\n- 分裂剪切比对到元件一致性序列的支持度：$c_{L1}$ (L1 一致性序列)，$c_{Alu}$ (Alu 一致性序列)。\n- 断点一致性偏差：$b$ (绝对偏差，单位为碱基对)，表示推断的左、右断点间距与靶位点重复长度之间的绝对差值。\n\n按如下方式定义流程：\n1) 证据聚合：\n   - 计算支持度得分 $S = s_L + s_R + 0.5 \\times (d_L + d_R)$。要求 $S \\ge T$，其中 $T = 4$。\n2) 分裂读长侧翼要求：\n   - $s_L \\ge 1$ 且 $s_R \\ge 1$，或者，如果至少一侧的分裂读长为零，则要求 $d_L + d_R \\ge 6$。\n3) 比对质量过滤器：\n   - 对于任何 $s_\\cdot > 0$ 的一侧，要求相应的中位比对质量 $m_\\cdot \\ge 20$。如果 $s_\\cdot = 0$，则忽略相应的 $m_\\cdot$。\n4) 重复内容过滤器：\n   - 要求 $r \\le 0.6$。\n5) 与参考元件的邻近度：\n   - 要求 $p \\ge 100$ 碱基对。\n6) 方向一致性：\n   - 要求 $o = \\text{True}$。\n7) 多聚腺苷酸尾：\n   - 要求 $a \\ge 8$。\n8) 断点一致性：\n   - 要求 $b \\le 10$ 碱基对。\n9) 通用靶位点重复范围：\n   - 要求 $t \\in [4,25]$ 碱基对。\n10) 使用分裂剪切比对支持度进行家族分配：\n    - 如果 $c_{L1} - c_{Alu} \\ge 2$，分配临时家族 $F = \\text{L1}$。\n    - 否则如果 $c_{Alu} - c_{L1} \\ge 2$，分配临时家族 $F = \\text{Alu}$。\n    - 否则，拒绝。\n11) 家族特异性检查：\n    - 如果 $F = \\text{L1}$，额外要求 $a \\ge 12$ 且 $t \\in [5,25]$ 碱基对。\n    - 如果 $F = \\text{Alu}$，额外要求 $a \\ge 8$ 且 $t \\in [7,25]$ 碱基对。\n如果一个候选位点通过所有适用的过滤器，则输出分配的家族；否则，输出 reject (拒绝)。\n\n实现一个程序，将这个精确的流程应用于以下候选位点的测试套件。每个测试用例以有序元组 $(s_L,s_R,d_L,d_R,m_L,m_R,r,p,o,a,t,c_{L1},c_{Alu},b)$ 的形式提供，其中距离单位为碱基对，$r$ 无单位。布尔值 $o$ 写作 $\\text{True}$ 或 $\\text{False}$。\n\n- 测试用例 1: $(3,2,2,1,60,55,0.2,500,\\text{True},22,12,6,1,3)$\n- 测试用例 2: $(2,2,1,1,45,40,0.3,400,\\text{True},11,14,1,5,2)$\n- 测试用例 3: $(1,1,4,0,30,25,0.5,120,\\text{True},8,8,0,3,0)$\n- 测试用例 4: $(3,2,2,2,50,50,0.75,600,\\text{True},20,10,4,1,3)$\n- 测试用例 5: $(0,2,5,4,0,35,0.4,1000,\\text{True},13,10,3,0,4)$\n- 测试用例 6: $(2,2,2,1,40,37,0.25,50,\\text{True},10,12,0,3,1)$\n- 测试用例 7: $(2,2,2,2,50,50,0.2,300,\\text{True},15,9,2,2,1)$\n- 测试用例 8: $(2,2,2,2,45,45,0.2,400,\\text{False},18,10,4,0,2)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素为精确的字符串 L1、Alu 或 reject 之一，不带引号。例如：\"[L1,Alu,reject]\"。", "solution": "该问题陈述经过详细审查，被认定为有效。它提出了一个在生物信息学领域内明确定义、有科学依据的计算任务，该领域是定量生物学和计算机科学的一个子学科。该问题是自洽的，其参数是现实的，决策逻辑是确定性的且没有矛盾。因此，我们可以着手提供一个正式的解决方案。\n\n目标是构建一个计算流程，将候选的基因组位点分类为长散在核元件-1 (L1) 或 Alu 元件的插入，或将其作为假象拒绝。该流程形式化了解读来自短读长全基因组测序 (WGS) 数据信号的过程。所提供的规则是在实践中用于移动元件插入发现的算法的一个简化但具有代表性的模型。流程中每一步的理由都根植于分子遗传学和测序技术的原理。\n\n一个候选插入由一个包含14个特征的向量来定义： $(s_L,s_R,d_L,d_R,m_L,m_R,r,p,o,a,t,c_{L1},c_{Alu},b)$ 。我们将应用一系列过滤器。在任何步骤失败都会导致候选位点被拒绝。\n\n**1. 证据聚合过滤器**\n插入的主要证据来源于分裂读长和不一致读长对。一个分裂读长的一部分比对到参考基因组，另一部分比对到插入的元件或未比对（软剪切）。一个不一致读长对具有异常的方向或插入片段大小，表明读长之间存在结构性改变。\n总支持度得分定义为 $S = s_L + s_R + 0.5 \\times (d_L + d_R)$。变量 $s_L$ 和 $s_R$ 分别是支持左、右断点的分裂读长计数。变量 $d_L$ 和 $d_R$ 是不一致读长对的计数。不一致读长对的权重为 $0.5$，因为它们被认为是比分裂读长精确度较低的证据。一个候选位点必须具有最低的聚合支持度得分：\n$$\nS \\ge T \\quad \\text{其中} \\quad T=4\n$$\n这个初始过滤器移除了证据不足、无法与背景噪音可靠区分的位点。\n\n**2. 断点确认过滤器**\n一个插入事件有两个断点。理想情况下，两者都由分裂读长支持。规则是：\n$$\n(s_L \\ge 1 \\text{ 且 } s_R \\ge 1) \\quad \\text{或} \\quad (d_L + d_R \\ge 6)\n$$\n如果分裂读长没有覆盖插入位点的两侧，则需要高于平均数量的不一致读长对来补偿。这处理了一个断点位于难以进行唯一读长比对的区域的情况。\n\n**3. 比对质量过滤器**\n读长比对的模糊性是假阳性的主要来源。比对质量 ($MQ$) 是比对错误概率的 PHRED 标度值。该过滤器要求分裂读长比对具有高置信度：\n$$\n\\text{若 } s_L > 0, \\text{ 则 } m_L \\ge 20 \\quad \\text{且} \\quad \\text{若 } s_R > 0, \\text{ 则 } m_R \\ge 20\n$$\n其中 $m_L$ 和 $m_R$ 是中位比对质量。阈值 $20$ 对应于 $1\\%$ 的比对错误概率，是结构变异分析的标准最低要求。\n\n**4. 重复背景过滤器**\n具有高重复密度的基因组区域会导致系统性的读长错配。我们过滤掉位于此类问题区域中的候选位点：\n$$\nr \\le 0.6\n$$\n这里，$r$ 是候选位点周围一个 $1,000$ 碱基对窗口内被注释为重复或低可比对性的区域所占的比例。\n\n**5. 邻近度过滤器**\n靠近参考基因组中现有转座元件的信号可能是假象。为避免这种情况，候选位点必须与同家族的已知元件保持足够的距离：\n$$\np \\ge 100 \\text{ bp}\n$$\n其中 $p$ 是到最近的已注释参考元件的距离。\n\n**6. 读长对方向过滤器**\n一个典型的逆转录转座子插入会在双末端读长数据中产生一个特征信号（例如，插入片段大小增加且读长对为正反方向）。该过滤器要求存在这种预期的信号：\n$$\no = \\text{True}\n$$\n这有助于将真实的插入与其它结构变异（如倒位或易位）区分开来。\n\n**7. 多聚腺苷酸尾过滤器**\n介导 L1 和 Alu 插入的靶标引物逆转录 (TPRT) 机制导致在新元件的 $3'$ 端形成一个多聚A尾。存在足够长的多聚A尾是真实逆转录转座事件的强有力证据。\n$$\na \\ge 8 \\text{ bp}\n$$\n其中 $a$ 是估计的多聚A尾的长度。\n\n**8. 断点一致性过滤器**\n一个简单插入的左、右断点应该是连续的，仅由靶位点重复隔开。不精确的比对可能会产生一个小的间隙或重叠。大的差异表明可能是一个更复杂的事件或假象。\n$$\nb \\le 10 \\text{ bp}\n$$\n其中 $b$ 是推断的断点间距与TSD长度之间的绝对偏差。\n\n**9. 靶位点重复 (TSD) 过滤器**\nTPRT 在插入位点处创建了一个基因组序列的短重复，称为 TSD。TSD 的长度是一个标志性特征。\n$$\nt \\in [4, 25] \\text{ bp}\n$$\n其中 $t$ 是估计的 TSD 长度。\n\n**10. 家族分配逻辑**\n如果一个候选位点通过了所有前面的过滤器，它的家族将通过比较比对到 L1 和 Alu 一致性序列的分裂剪切读长的支持度来确定。\n- 如果 $c_{L1} - c_{Alu} \\ge 2$，临时家族为 $F = \\text{L1}$。\n- 如果 $c_{Alu} - c_{L1} \\ge 2$，临时家族为 $F = \\text{Alu}$。\n- 否则，证据模糊不清，候选位点被拒绝。\n\n**11. 家族特异性过滤器**\n最后，检查更严格的、家族特异性的生物化学特性。\n- 如果 $F = \\text{L1}$，我们要求更长的多聚A尾和特定的 TSD 范围：$a \\ge 12$ 且 $t \\in [5, 25]$。\n- 如果 $F = \\text{Alu}$，要求略有不同：$a \\ge 8$ 且 $t \\in [7, 25]$。\n\n只有当一个候选位点通过所有通用过滤器及其相应的家族特异性过滤器时，才会被接受并标记为 'L1' 或 'Alu'。否则，它被标记为 'reject'。\n\n**示例演练：测试用例 2**\n输入：$(s_L,s_R,d_L,d_R,m_L,m_R,r,p,o,a,t,c_{L1},c_{Alu},b) = (2,2,1,1,45,40,0.3,400,\\text{True},11,14,1,5,2)$。\n1. 支持度 $S = 2+2+0.5 \\times(1+1) = 5$。$5 \\ge 4$。通过。\n2. 侧翼：$s_L=2 \\ge 1$ 且 $s_R=2 \\ge 1$。通过。\n3. MQ: $m_L=45 \\ge 20$, $m_R=40 \\ge 20$。通过。\n4. 重复性: $r=0.3 \\le 0.6$。通过。\n5. 邻近度: $p=400 \\ge 100$。通过。\n6. 方向: $o=\\text{True}$。通过。\n7. Poly-A: $a=11 \\ge 8$。通过。\n8. 一致性: $b=2 \\le 10$。通过。\n9. TSD: $t=14 \\in [4,25]$。通过。\n10. 家族: $c_{Alu} - c_{L1} = 5-1 = 4$。$4 \\ge 2$。临时家族 $F = \\text{Alu}$。\n11. 家族特异性 (Alu):\n    - $a=11 \\ge 8$。通过。\n    - $t=14 \\in [7,25]$。通过。\n所有过滤器均通过。结果是 **Alu**。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Applies a deterministic decision function to classify candidate retrotransposon\n    insertions based on a set of genomic and sequencing features.\n    \"\"\"\n\n    # Test cases as tuples of (s_L, s_R, d_L, d_R, m_L, m_R, r, p, o, a, t, c_L1, c_Alu, b)\n    test_cases = [\n        (3, 2, 2, 1, 60, 55, 0.2, 500, True, 22, 12, 6, 1, 3),   # TC1\n        (2, 2, 1, 1, 45, 40, 0.3, 400, True, 11, 14, 1, 5, 2),   # TC2\n        (1, 1, 4, 0, 30, 25, 0.5, 120, True, 8, 8, 0, 3, 0),     # TC3\n        (3, 2, 2, 2, 50, 50, 0.75, 600, True, 20, 10, 4, 1, 3), # TC4\n        (0, 2, 5, 4, 0, 35, 0.4, 1000, True, 13, 10, 3, 0, 4),   # TC5\n        (2, 2, 2, 1, 40, 37, 0.25, 50, True, 10, 12, 0, 3, 1),   # TC6\n        (2, 2, 2, 2, 50, 50, 0.2, 300, True, 15, 9, 2, 2, 1),   # TC7\n        (2, 2, 2, 2, 45, 45, 0.2, 400, False, 18, 10, 4, 0, 2), # TC8\n    ]\n\n    results = []\n    for case in test_cases:\n        result = classify_locus(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef classify_locus(s_L, s_R, d_L, d_R, m_L, m_R, r, p, o, a, t, c_L1, c_Alu, b):\n    \"\"\"\n    Implements the full classification pipeline for a single candidate locus.\n    \n    Args:\n        s_L, s_R: split-read counts\n        d_L, d_R: discordant-pair counts\n        m_L, m_R: median mapping qualities of split reads\n        r: local repetitive fraction\n        p: proximity to nearest reference TE\n        o: orientation consistency flag\n        a: poly-adenine tail length estimate\n        t: target site duplication length estimate\n        c_L1, c_Alu: split-clip alignment support for L1/Alu\n        b: breakpoint coherence deviation\n\n    Returns:\n        'L1', 'Alu', or 'reject'\n    \"\"\"\n    \n    # 1) Evidence aggregation\n    T = 4\n    S = s_L + s_R + 0.5 * (d_L + d_R)\n    if S < T:\n        return 'reject'\n\n    # 2) Split-read side requirement\n    if not ((s_L >= 1 and s_R >= 1) or (d_L + d_R >= 6)):\n        return 'reject'\n\n    # 3) Mapping quality filter\n    if (s_L > 0 and m_L < 20) or (s_R > 0 and m_R < 20):\n        return 'reject'\n\n    # 4) Repeat content filter\n    if r > 0.6:\n        return 'reject'\n\n    # 5) Proximity to reference elements\n    if p < 100:\n        return 'reject'\n\n    # 6) Orientation consistency\n    if not o:\n        return 'reject'\n\n    # 7) Poly-adenine tail\n    if a < 8:\n        return 'reject'\n        \n    # 8) Breakpoint coherence\n    if b > 10:\n        return 'reject'\n\n    # 9) General target site duplication range\n    if not (4 <= t <= 25):\n        return 'reject'\n\n    # 10) Family assignment using split-clip alignment support\n    provisional_family = None\n    if c_L1 - c_Alu >= 2:\n        provisional_family = 'L1'\n    elif c_Alu - c_L1 >= 2:\n        provisional_family = 'Alu'\n    else:\n        return 'reject'\n\n    # 11) Family-specific checks\n    if provisional_family == 'L1':\n        if a >= 12 and 5 <= t <= 25:\n            return 'L1'\n        else:\n            return 'reject'\n    elif provisional_family == 'Alu':\n        if a >= 8 and 7 <= t <= 25:\n            return 'Alu'\n        else:\n            return 'reject'\n            \n    # This part should not be reached given the logic, but as a fallback.\n    return 'reject'\n\nsolve()\n```", "id": "2846706"}]}