{"hands_on_practices": [{"introduction": "掌握内聚力-张力理论，首先必须理解植物将水从土壤提升至树冠所面临的基本物理挑战。本练习引导你运用流体静力学第一性原理，计算将水提升至特定高度所需的能量，即由重力引起的水势差（$\\Delta \\Psi_g = \\rho g \\Delta h$）。通过这个计算，你将能够量化重力在植物水分运输中所扮演的角色，并将其与实际测量的叶片水势进行比较，从而具体感受张力需要克服的障碍有多大。[@problem_id:2555396]", "problem": "内聚-张力理论的一个中心预测是，水在木质部中于负压（张力）下上升，且水势的重力分量随海拔升高而增加，从而产生一个额外的压力差，这个压力差必须由蒸腾作用产生的张力来平衡。考虑一个从树基土壤表面到高度 $H = 35$ 米处叶片的、充满水的笔直木质部通道。假设水柱相对于垂直加速度是静态的（准稳态），流体是不可压缩的，且温度对密度的影响可忽略不计。从流体静力平衡 $\\frac{dP}{dz} = -\\rho g$ 和水势作为单位体积能量（单位为压力）的定义出发，推导基部和叶片之间水势差的重力贡献，将其表示为海拔差异的函数。然后使用 $\\rho = 1.00 \\times 10^{3}$ kg m$^{-3}$ 和 $g = 9.81$ m s$^{-2}$ 计算其在 $H = 35$ 米时的量值，并将其最终数值结果以兆帕斯卡（MPa）表示。将您的数值结果四舍五入至四位有效数字。\n\n最后，相对于在水分充足的温带树木（约 $-1.0$ 至 $-2.5$ MPa）和适应干旱的灌木（约 $-3.0$ 至 $-6.0$ MPa）中测得的午间叶片水势，解释您所得到的量值的意义，说明重力对内聚-张力机制所需总张力的相对贡献。您最终报告的答案必须仅为计算出的以 MPa 为单位的数值。", "solution": "所述问题具有科学根据、良态且客观。它基于已建立的流体静力学原理和植物水分运输的内聚-张力理论。所有必要的常数和条件均已提供，且不存在矛盾。因此，该问题是有效的，可以求解。\n\n我们首先将水势 $\\Psi$ 的概念形式化，它被定义为单位体积水的势能。就本问题而言，我们考虑两个最相关的分量：压力势 $\\Psi_p$（等同于流体静力压力 $P$）和重力势 $\\Psi_g$。因此，在海拔 $z$ 处的总水势由以下总和给出：\n$$ \\Psi(z) = \\Psi_p(z) + \\Psi_g(z) $$\n质量为 $m$ 的水在高度 $z$ 处的重力势能为 $U_g = mgz$。对应的单位体积 $V$ 的势为 $\\frac{U_g}{V} = \\frac{m}{V} g z$。认识到密度 $\\rho = \\frac{m}{V}$，以压力单位表示的重力势为：\n$$ \\Psi_g(z) = \\rho g z $$\n其中 $g$ 是重力加速度。\n\n问题陈述水柱处于流体静力平衡状态，该状态由以下微分方程式描述：\n$$ \\frac{dP}{dz} = -\\rho g $$\n这个方程式表明，流体静力压力 $P$ 随高度 $z$ 的增加而线性减少。\n\n第一项任务是推导树基（我们定义为 $z_1 = 0$）和高度为 $H$（在 $z_2 = H = 35$ 米处）的叶片之间水势差的重力贡献。这个贡献就是这两个海拔高度之间重力势项 $\\Delta\\Psi_g$ 的差值。\n$$ \\Delta\\Psi_g = \\Psi_g(z_2) - \\Psi_g(z_1) $$\n代入 $\\Psi_g(z)$ 的表达式，我们得到：\n$$ \\Delta\\Psi_g = \\rho g z_2 - \\rho g z_1 = \\rho g H - \\rho g (0) = \\rho g H $$\n这就是水势差的重力贡献的解析表达式。它代表了将水抵抗重力提升到高度 $H$ 所需的单位体积势能。\n\n接下来，我们使用给定的值计算这个贡献的数值大小：水密度 $\\rho = 1.00 \\times 10^{3}$ kg m$^{-3}$，重力加速度 $g = 9.81$ m s$^{-2}$，以及高度 $H = 35$ m。\n$$ \\Delta\\Psi_g = (1.00 \\times 10^{3} \\, \\text{kg m}^{-3}) \\times (9.81 \\, \\text{m s}^{-2}) \\times (35 \\, \\text{m}) $$\n计算结果为：\n$$ \\Delta\\Psi_g = 343350 \\, \\text{kg m}^{-1} \\text{s}^{-2} $$\n单位 kg m$^{-1}$ s$^{-2}$ 等同于标准压力单位帕斯卡（Pa）。\n$$ \\Delta\\Psi_g = 343350 \\, \\text{Pa} $$\n为了将此结果以兆帕斯卡（MPa）表示，我们使用换算关系 $1$ MPa $= 10^6$ Pa。\n$$ \\Delta\\Psi_g = \\frac{343350}{10^6} \\, \\text{MPa} = 0.343350 \\, \\text{MPa} $$\n问题要求将此数值结果四舍五入至四位有效数字。第五位有效数字是 $5$，所以我们将第四位数字进位。\n$$ \\Delta\\Psi_g \\approx 0.3434 \\, \\text{MPa} $$\n\n最后，我们解释这个量值的意义。$\\Delta\\Psi_g \\approx +0.3434$ MPa 这个值代表了将水抵抗重力提升到 35 米高度的“代价”。在内聚-张力理论的框架内，总水势通常从土壤到叶片递减以驱动水流。总叶片水势 $\\Psi_{\\text{leaf}}$ 是其各分量的总和：$\\Psi_{\\text{leaf}} = \\Psi_{p, \\text{leaf}} + \\Psi_{g, \\text{leaf}}$。叶片处的重力分量是 $\\Psi_{g, \\text{leaf}} = \\rho g H = +0.3434$ MPa。压力分量 $\\Psi_{p, \\text{leaf}}$ 是张力，其值为负。\n对于一个水分充足的温带树木，其典型的午间 $\\Psi_{\\text{leaf}}$ 约为 $-1.5$ MPa，所需的张力是：\n$$ \\Psi_{p, \\text{leaf}} = \\Psi_{\\text{leaf}} - \\Psi_{g, \\text{leaf}} \\approx -1.5 \\, \\text{MPa} - 0.3434 \\, \\text{MPa} \\approx -1.84 \\, \\text{MPa} $$\n在这种情况下，重力势构成了总水势预算的重要部分。张力必须足够负，以克服重力势以及土壤水势和摩擦阻力等其他因素。对于适应干旱的灌木，它们会产生低得多的叶片水势（例如 $-4.5$ MPa）以从干燥的土壤中提取水分，所需的张力将是 $\\Psi_{p, \\text{leaf}} \\approx -4.5 \\, \\text{MPa} - 0.3434 \\, \\text{MPa} \\approx -4.84 \\, \\text{MPa}$。尽管在这些情况下重力的相对贡献较小，但它仍然是一个不可避免的物理障碍，必须由蒸腾作用产生的张力来克服。因此，我们计算出的 $0.3434$ MPa 这个值量化了重力对维管植物高度施加的一个基本限制。", "answer": "$$\\boxed{0.3434}$$", "id": "2555396"}, {"introduction": "既然我们理解了重力构成的巨大挑战，一个自然而然的问题随之而来：植物的木质部导管如何在巨大的负压（张力）下保持水分连续而不断裂？本实践练习将带你深入到微观层面，探讨纹孔膜的关键作用。你将运用杨-拉普拉斯方程计算单个纹孔中弯液面所能承受的毛细管压力，这个压力是阻止空气栓塞（air-seeding）入侵、维持水柱稳定性的核心物理机制。[@problem_id:2555348]", "problem": "在木质部运输的内聚力-张力理论框架中，空气-水界面（弯液面）跨越纹孔膜中的纳米级孔隙所产生的毛细管压力，会阻止空气栓塞进入充满水的导管。考虑一个半径为 $r$ 的圆柱形单孔，该孔隙连接着一个已栓塞（充满气体）的导管和一个相邻的充满水的导管。在温度 $T$ 下，空气-水的表面张力为 $\\gamma$，在亲水性纹孔膜处的静态接触角（通过液体测量）为 $\\theta$。在准静态条件下，弯液面呈现恒定平均曲率的形状，并被钉扎在孔隙的边缘。\n\n从界面热力学和弯曲界面的力学平衡出发，即通过弯液面虚位移中压力-体积功与表面自由能之间的微分平衡关系，仅利用圆形孔隙中球冠的几何特性，推导出界面两侧的压力差（气体压力减去液体压力）$\\Delta P$ 关于 $\\gamma$、$r$ 和 $\\theta$ 的表达式。然后，使用 $r=50\\ \\text{nm}$、$\\gamma=0.072\\ \\text{N m}^{-1}$ 和 $\\theta=0^\\circ$ 计算 $\\Delta P$ 的大小。\n\n最终答案以兆帕为单位表示，并保留两位有效数字。", "solution": "所述问题在科学上是合理的、内容自洽且提法适定。我们将着手推导界面两侧的压力差表达式，然后计算其大小。\n\n该问题要求从虚功原理出发，将压力-体积功与界面自由能的变化联系起来进行推导。我们考虑一个由气相和液（水）相组成的体系，两相被一个界面隔开，在半径为 $r$ 的圆柱形孔隙内形成一个弯液面。弯液面是一个球冠。三相（气、液、固）的接触线被钉扎在孔隙边缘，即一个半径为 $r$ 的圆周上。接触角 $\\theta$ 在此接触线上定义。$\\Delta P$ 是压力差 $P_{\\text{gas}} - P_{\\text{liquid}}$。\n\n让我们考虑液-气界面的一个虚位移。对于此问题，最方便的虚位移是流体沿圆柱形孔隙轴线的无穷小位移 $dz$。该位移导致三相接触线沿孔隙的固体壁移动。\n\n对于一个恒温下经历可逆过程的体系，热力学第一定律可以用亥姆霍兹自由能 $F = U - TS$ 来表示。其微分变化为 $dF = -P dV + \\sum_i \\gamma_i dA_i$，其中第二项代表表面自由能的变化。对于一个处于力学平衡的多相体系，虚位移所引起的亥姆霍兹自由能总变化必须为零，即 $dF_{\\text{total}} = 0$。\n\n我们体系的总自由能是体相能和界面能之和：\n$F_{\\text{total}} = F_{\\text{liquid}} + F_{\\text{gas}} + F_{\\text{interface}}$\n对于一个虚位移，其变化为：\n$dF_{\\text{total}} = dF_{\\text{liquid}} + dF_{\\text{gas}} + dF_{\\text{interface}} = 0$\n\n体相的功项为 $dF_{\\text{liquid}} = -P_{\\text{liquid}} dV_{\\text{liquid}}$ 和 $dF_{\\text{gas}} = -P_{\\text{gas}} dV_{\\text{gas}}$。在我们的虚位移 $dz$ 中，液体体积增加了 $dV_{\\text{liquid}} = \\pi r^2 dz$，气体体积减少了相同的量，所以 $dV_{\\text{gas}} = -\\pi r^2 dz$。\n体相自由能的总变化是：\n$dF_{\\text{bulk}} = -P_{\\text{liquid}}(\\pi r^2 dz) - P_{\\text{gas}}(-\\pi r^2 dz) = (P_{\\text{gas}} - P_{\\text{liquid}})\\pi r^2 dz = \\Delta P \\pi r^2 dz$。\n\n界面自由能有三个组分，分别对应于固-气、固-液和液-气界面。设它们各自的表面张力为 $\\gamma_{sg}$、$\\gamma_{sl}$ 和 $\\gamma_{lg}$（在问题中记为 $\\gamma$）。\n$F_{\\text{interface}} = \\gamma_{sg} A_{sg} + \\gamma_{sl} A_{sl} + \\gamma A_{lg}$。\n在位移 $dz$ 期间，面积为 $A_{lg}$ 的液-气界面被平移，所以其面积一阶变化为零，即 $dA_{lg}=0$。然而，固-液界面沿孔壁前进，其面积增加：$dA_{sl} = 2\\pi r dz$。相应地，固-气界面的面积减少：$dA_{sg} = -2\\pi r dz$。\n界面自由能的变化是：\n$dF_{\\text{interface}} = \\gamma_{sg} (-2\\pi r dz) + \\gamma_{sl} (2\\pi r dz) = (\\gamma_{sl} - \\gamma_{sg}) 2\\pi r dz$。\n\n在平衡状态下，总自由能变化为零：\n$dF_{\\text{total}} = \\Delta P \\pi r^2 dz + (\\gamma_{sl} - \\gamma_{sg}) 2\\pi r dz = 0$。\n$\\Delta P \\pi r^2 = -(\\gamma_{sl} - \\gamma_{sg}) 2\\pi r = (\\gamma_{sg} - \\gamma_{sl}) 2\\pi r$。\n\n项 $(\\gamma_{sg} - \\gamma_{sl})$ 通过平衡接触线的 Young-Dupré 方程与液-气表面张力 $\\gamma$ 和接触角 $\\theta$ 相关联：\n$\\gamma_{sg} = \\gamma_{sl} + \\gamma \\cos\\theta$。\n因此，$\\gamma_{sg} - \\gamma_{sl} = \\gamma \\cos\\theta$。\n\n将此代入我们的平衡条件，得到：\n$\\Delta P \\pi r^2 = (\\gamma \\cos\\theta) 2\\pi r$。\n\n解出 $\\Delta P = P_{\\text{gas}} - P_{\\text{liquid}}$，我们得到所需的表达式：\n$$\n\\Delta P = \\frac{2\\gamma \\cos\\theta}{r}\n$$\n这就是所要求的表达式，它是 Young-Laplace 方程在圆柱形毛细管中球形弯液面情况下的一个特定形式。\n\n现在，我们使用给定值计算 $\\Delta P$ 的大小：\n孔隙半径, $r = 50 \\ \\text{nm} = 50 \\times 10^{-9} \\ \\text{m}$。\n空气-水表面张力, $\\gamma = 0.072 \\ \\text{N m}^{-1}$。\n接触角, $\\theta = 0^\\circ$。\n\n将这些值代入推导出的公式中：\n$\\Delta P = \\frac{2 \\times (0.072 \\ \\text{N m}^{-1}) \\times \\cos(0^\\circ)}{50 \\times 10^{-9} \\ \\text{m}}$。\n由于 $\\cos(0^\\circ) = 1$：\n$\\Delta P = \\frac{2 \\times 0.072}{50 \\times 10^{-9}} \\ \\frac{\\text{N}}{\\text{m}^2}$。\n单位 $\\text{N m}^{-2}$ 等价于帕斯卡 ($\\text{Pa}$)。\n$\\Delta P = \\frac{0.144}{50 \\times 10^{-9}} \\ \\text{Pa} = \\frac{0.144}{5 \\times 10^{-8}} \\ \\text{Pa} = 0.0288 \\times 10^8 \\ \\text{Pa} = 2.88 \\times 10^6 \\ \\text{Pa}$。\n\n问题要求答案以兆帕（$\\text{MPa}$）表示，其中 $1 \\ \\text{MPa} = 10^6 \\ \\text{Pa}$。\n$\\Delta P = 2.88 \\ \\text{MPa}$。\n\n最后，我们必须将结果四舍五入到两位有效数字。\n$\\Delta P \\approx 2.9 \\ \\text{MPa}$。\n\n这个正压力差表示，相对于液相，必须施加到气相的压力，以迫使空气穿过孔隙，这种现象被称为空气栓塞。它也等于在空穴化（通过从相邻充气导管发生的空气栓塞而发生）之前，水柱能够承受的张力（负压）的大小。", "answer": "$$\n\\boxed{2.9}\n$$", "id": "2555348"}, {"introduction": "在掌握了基本物理力和微观稳定机制后，下一个挑战是将这些分离的概念整合成一个能够预测植物生理功能的动态模型。这个综合性练习要求你构建一个简化但完整的机理模型，它连接了环境驱动因素（如饱和水汽压差）、植物的水力结构以及木质部的脆弱性。通过求解这个模型，你将能够预测在特定条件下植物的实际稳态蒸腾水流量，这是将凝聚力-张力理论应用于生态生理学问题的重要一步。[@problem_id:2555401]", "problem": "构建一个基于内聚-张力框架的蒸腾驱动木质部流动的最小机理模型。您的模型必须结合从叶片到大气的气相扩散和通过植物导水路径的液相流动，同时考虑木质部对张力的脆弱性。该模型必须预测通过植物的实现稳态水的质量流率，表示为水的摩尔损失率。您必须实现一个程序，为下文指定的一小组测试用例计算此预测的实现流量。该程序必须使用以下原理和设计约束。\n\n基本原理和模型假设：\n- 气相扩散（叶片到空气）：根据准稳态条件下稀薄气体中的菲克扩散，叶面积为 $A_{\\ell}$、水蒸气气孔导度为 $g_{\\mathrm{sw}}$（单位为 $\\mathrm{mol \\ m^{-2} \\ s^{-1}}$）的叶片的摩尔蒸腾速率 $E_{\\text{mol}}$（单位为 $\\mathrm{mol \\ s^{-1}}$）与水蒸气摩尔分数差成正比，对于给定的饱和水汽压差（VPD），该摩尔分数差可近似为比率 $\\Delta c \\approx D / P_{\\text{atm}}$，其中 $D$ 是饱和水汽压差，$P_{\\text{atm}}$ 是大气压力。因此，\n  $$E_{\\text{mol}} = g_{\\mathrm{sw}} \\, A_{\\ell} \\, \\frac{D}{P_{\\text{atm}}}.$$\n  此处，如果 $D$ 以千帕斯卡（kPa）为单位提供，则必须将其转换为帕斯卡（Pa），其中 $1 \\ \\mathrm{kPa} = 1000 \\ \\mathrm{Pa}$。大气压力取为 $P_{\\text{atm}} = 101325 \\ \\mathrm{Pa}$。\n- 连续性（液-气通量等价）：通过木质部的质量流率 $F$（单位为 $\\mathrm{kg \\ s^{-1}}$）等于摩尔蒸腾速率乘以水的摩尔质量 $M_{\\mathrm{w}}$，其中 $M_{\\mathrm{w}} = 0.01801528 \\ \\mathrm{kg \\ mol^{-1}}$。因此，\n  $$F_{\\text{demand}} = M_{\\mathrm{w}} \\, E_{\\text{mol}}.$$\n- 液相流动（木质部水力学）：在稳态条件下，达西定律（欧姆定律类比）给出\n  $$F = K_{\\text{tot}}(\\psi_{\\ell}, T)\\, \\bigl(\\psi_{\\text{soil}} - \\psi_{\\ell}\\bigr),$$\n  其中 $K_{\\text{tot}}$ 是总水力导度（单位为 $\\mathrm{kg \\ s^{-1} \\ MPa^{-1}}$），$\\psi_{\\text{soil}}$ 是土壤水势（单位为 $\\mathrm{MPa}$），$\\psi_{\\ell}$ 是叶片水势（单位为 $\\mathrm{MPa}$）。总导度是参考导度为 $K_{\\text{root,ref}}$ 的根系路径和最大参考导度为 $K_{\\text{stem,max,ref}}$（经脆弱性函数折减）的茎干路径的串联组合。对于串联元件，\n  $$K_{\\text{tot}}^{-1} = K_{\\text{root}}^{-1} + K_{\\text{stem}}^{-1},$$\n  温度校正后的导度为\n  $$K_{\\text{root}}(T) = K_{\\text{root,ref}} \\, \\frac{\\mu(T_{\\text{ref}})}{\\mu(T)}, \\quad K_{\\text{stem,max}}(T) = K_{\\text{stem,max,ref}} \\, \\frac{\\mu(T_{\\text{ref}})}{\\mu(T)},$$\n  其中 $\\mu(T)$ 是水的动力粘度（单位为 $\\mathrm{Pa \\ s}$），$T_{\\text{ref}} = 298.15 \\ \\mathrm{K}$（即 $25 \\ ^{\\circ}\\mathrm{C}$）。使用经验关系式\n  $$\\mu(T) = A \\, 10^{\\frac{B}{T - C}}, \\quad A = 2.414 \\times 10^{-5} \\ \\mathrm{Pa \\ s}, \\ B = 247.8 \\ \\mathrm{K}, \\ C = 140 \\ \\mathrm{K},$$\n  其中 $T$ 以开尔文为单位。木质部对张力的脆弱性由相对导水率的逻辑斯谛函数表示\n  $$k_{\\text{rel}}(\\psi) = \\frac{1}{1 + \\exp\\bigl(-S\\,(\\psi - P_{50})\\bigr)},$$\n  其中 $P_{50}$（单位为 $\\mathrm{MPa}$）是导水率损失 $50\\%$ 时的水势，$S$（单位为 $\\mathrm{MPa^{-1}}$）是斜率。叶片水势为 $\\psi_{\\ell}$ 时的茎干导度是\n  $$K_{\\text{stem}}(\\psi_{\\ell}, T) = K_{\\text{stem,max}}(T) \\, k_{\\text{rel}}(\\psi_{\\ell}).$$\n- 实现的稳态：定义水力供应函数\n  $$H(\\psi_{\\ell}; T) = K_{\\text{tot}}(\\psi_{\\ell}, T)\\, \\bigl(\\psi_{\\text{soil}} - \\psi_{\\ell}\\bigr), \\quad \\psi_{\\ell} \\le \\psi_{\\text{soil}}.$$\n  实现的稳态流量按以下方式确定。\n  1. 根据气体扩散和连续性计算 $F_{\\text{demand}}$。\n  2. 在指定的势窗 $[\\psi_{\\min}, \\psi_{\\text{soil}}]$（其中 $\\psi_{\\min} = -10 \\ \\mathrm{MPa}$）内，计算最大水力供应量 $H_{\\max}(T) = \\max_{\\psi_{\\ell} \\in [\\psi_{\\min}, \\psi_{\\text{soil}}]} H(\\psi_{\\ell}; T)$。\n  3. 如果 $F_{\\text{demand}} \\le H_{\\max}(T)$，则至少存在一个 $\\psi_{\\ell}^{\\star}$ 使得 $H(\\psi_{\\ell}^{\\star}; T) = F_{\\text{demand}}$。选择张力大小最小的解（即最接近 $\\psi_{\\text{soil}}$ 的解），并设 $F_{\\text{real}} = F_{\\text{demand}}$。\n  4. 如果 $F_{\\text{demand}} > H_{\\max}(T)$，则植物受水力供应限制；设 $F_{\\text{real}} = H_{\\max}(T)$，此时的 $\\psi_{\\ell}$ 使供应量最大化。\n\n数值和算法要求：\n- 温度 $T$ 必须以摄氏度为单位提供，并按 $T[\\mathrm{K}] = T[^{\\circ}\\mathrm{C}] + 273.15$ 转换为开尔文。\n- 使用 $P_{\\text{atm}} = 101325 \\ \\mathrm{Pa}$ 和 $M_{\\mathrm{w}} = 0.01801528 \\ \\mathrm{kg \\ mol^{-1}}$。\n- 对于水力搜索，在跨越 $[\\psi_{\\min}, \\psi_{\\text{soil}}]$ 的至少 $10001$ 个点的均匀网格上评估 $H(\\psi_{\\ell}; T)$，以定位 $H_{\\max}$ 并在 $F_{\\text{demand}} \\le H_{\\max}$ 时为近土壤解定界。如果需要，使用相邻网格点之间的线性插值来精确化 $\\psi_{\\ell}^{\\star}$。\n\n输出规范：\n- 对于每个测试用例，报告实现的水的摩尔流率 $E_{\\text{real}}$，单位为 $\\mathrm{mmol \\ s^{-1}}$，其中 $E_{\\text{real}} = 1000 \\, F_{\\text{real}} / M_{\\mathrm{w}}$。\n- 将每个结果表示为保留六位小数的浮点数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[x1,x2,x3]”）。\n\n测试用例集：\n实现您的程序，为以下五个测试用例计算输出。每个元组按顺序排列 $(D_{\\mathrm{kPa}}, T_{^{\\circ}\\mathrm{C}}, A_{\\ell}, g_{\\mathrm{sw}}, \\psi_{\\text{soil}}, K_{\\text{root,ref}}, K_{\\text{stem,max,ref}}, P_{50}, S)$，单位为 $(\\mathrm{kPa}, ^{\\circ}\\mathrm{C}, \\mathrm{m^{2}}, \\mathrm{mol \\ m^{-2} \\ s^{-1}}, \\mathrm{MPa}, \\mathrm{kg \\ s^{-1} \\ MPa^{-1}}, \\mathrm{kg \\ s^{-1} \\ MPa^{-1}}, \\mathrm{MPa}, \\mathrm{MPa^{-1}})$。\n- 案例 $1$（中等需求，水分充足，高导度）：$(1.5, 25.0, 1.5, 0.2, -0.2, 0.0012, 0.0013, -2.0, 3.0)$。\n- 案例 $2$（高需求，土壤干燥，低导度；预计受供应限制）：$(4.0, 25.0, 1.5, 0.2, -0.8, 0.00012, 0.00012, -1.5, 4.0)$。\n- 案例 $3$（零需求边界）：$(0.0, 30.0, 2.0, 0.3, -0.5, 0.0005, 0.0010, -2.0, 3.0)$。\n- 案例 $4$（相对于案例 $2$ 的温度对粘度的影响）：$(4.0, 45.0, 1.5, 0.2, -0.8, 0.00012, 0.00012, -1.5, 4.0)$。\n- 案例 $5$（土壤极度干燥，接近脆弱性阈值）：$(1.0, 25.0, 1.0, 0.15, -2.0, 0.0005, 0.0008, -1.8, 5.0)$。\n\n编程任务：\n- 完全按照规定实现模型。\n- 在程序中硬编码测试用例集，并计算实现的摩尔流率（单位 $\\mathrm{mmol \\ s^{-1}}$），四舍五入到六位小数。\n- 生成单行输出，其中包含所需列表格式的五个结果。", "solution": "所陈述的问题具有科学依据、提法明确，并提供了一套完整的参数和清晰的算法流程。它代表了一个有效、尽管简化了的、基于已建立的内聚-张力理论的植物水分运输机理模型。其中没有矛盾、模糊之处或事实错误。因此，我们可以着手推导和实现解决方案。\n\n问题的核心是通过寻找大气需求和水力供应的交点来确定植物的稳态水流量。该系统由叶片水势 $\\psi_{\\ell}$ 控制，它耦合了运输的液相和气相。实现流量 $F_{\\text{real}}$ 是由大气决定的需求流量 $F_{\\text{demand}}$ 和植物水力系统能供应的最大可能流量 $H_{\\max}$ 中的较小者。\n\n解决方案按以下步骤构建：\n\n首先，我们计算大气蒸发需求。摩尔蒸腾速率 $E_{\\text{mol}}$ 由一个菲克扩散模型给出：\n$$E_{\\text{mol}} = g_{\\mathrm{sw}} \\, A_{\\ell} \\, \\frac{D}{P_{\\text{atm}}}$$\n其中 $g_{\\mathrm{sw}}$ 是气孔导度，$A_{\\ell}$ 是叶面积，$D$ 是饱和水汽压差，$P_{\\text{atm}}$ 是大气压力。请注意，$D$ 必须通过乘以 $1000$ 从 $\\mathrm{kPa}$ 转换为 $\\mathrm{Pa}$。大气压力被视为一个常数，$P_{\\text{atm}} = 101325 \\ \\mathrm{Pa}$。\n根据质量连续性原理，大气所需求的质量流率 $F_{\\text{demand}}$ 必须等于摩尔速率乘以水的摩尔质量 $M_{\\mathrm{w}} = 0.01801528 \\ \\mathrm{kg \\ mol^{-1}}$：\n$$F_{\\text{demand}} = M_{\\mathrm{w}} \\, E_{\\text{mol}}$$\n\n其次，我们定义水力供应函数 $H(\\psi_{\\ell}; T)$。该函数描述了在给定叶片水势 $\\psi_{\\ell}$ 和温度 $T$ 下，植物能够维持的最大水流速率。它基于一个类比于欧姆定律的达西类型定律：\n$$H(\\psi_{\\ell}; T) = K_{\\text{tot}}(\\psi_{\\ell}, T) \\, (\\psi_{\\text{soil}} - \\psi_{\\ell})$$\n驱动力是土壤水势 $\\psi_{\\text{soil}}$ 和叶片水势 $\\psi_{\\ell}$ 之间的水势差。总水力导度 $K_{\\text{tot}}$ 本身是 $\\psi_{\\ell}$ 和温度 $T$ 的函数。植物水力路径被建模为两个串联的导度：根系导度 $K_{\\text{root}}$ 和茎干导度 $K_{\\text{stem}}$。因此，总导度由以下公式给出：\n$$K_{\\text{tot}}^{-1} = K_{\\text{root}}^{-1} + K_{\\text{stem}}^{-1} \\quad \\implies \\quad K_{\\text{tot}} = \\frac{K_{\\text{root}} \\, K_{\\text{stem}}}{K_{\\text{root}} + K_{\\text{stem}}}$$\n导度根据水的温度依赖性粘度 $\\mu(T)$ 进行校正。粘度的经验公式为：\n$$\\mu(T) = A \\cdot 10^{\\frac{B}{T - C}}$$\n其中常数 $A = 2.414 \\times 10^{-5} \\ \\mathrm{Pa \\ s}$，$B = 247.8 \\ \\mathrm{K}$，$C = 140 \\ \\mathrm{K}$。温度必须以开尔文为单位（$T[\\mathrm{K}] = T[^{\\circ}\\mathrm{C}] + 273.15$）。导度相对于其在参考温度 $T_{\\text{ref}} = 298.15 \\ \\mathrm{K}$ 下的参考值进行调整：\n$$K_{\\text{root}}(T) = K_{\\text{root,ref}} \\, \\frac{\\mu(T_{\\text{ref}})}{\\mu(T)}$$\n$$K_{\\text{stem,max}}(T) = K_{\\text{stem,max,ref}} \\, \\frac{\\mu(T_{\\text{ref}})}{\\mu(T)}$$\n该模型的关键特征是木质部对栓塞的脆弱性，即在高张力（负水势）下导度会丧失。这通过相对导水率函数 $k_{\\text{rel}}(\\psi_{\\ell})$ 被整合到茎干导度中：\n$$K_{\\text{stem}}(\\psi_{\\ell}, T) = K_{\\text{stem,max}}(T) \\, k_{\\text{rel}}(\\psi_{\\ell})$$\n函数 $k_{\\text{rel}}$ 是一个逻辑斯谛曲线：\n$$k_{\\text{rel}}(\\psi_{\\ell}) = \\frac{1}{1 + \\exp\\bigl(-S\\,(\\psi_{\\ell} - P_{50})\\bigr)}$$\n其中 $P_{50}$ 是导水率损失 $50\\%$ 时的水势，$S$ 控制脆弱性曲线的陡峭程度。在此模型中，根系导度被假定为不易受损。\n\n第三，我们找到最大可能的水力供应量 $H_{\\max}(T)$。供应函数 $H(\\psi_{\\ell}; T)$ 通常有单一最大值。当 $\\psi_{\\ell} = \\psi_{\\text{soil}}$ 时，流量为零。随着 $\\psi_{\\ell}$ 变得更负，驱动力 $(\\psi_{\\text{soil}} - \\psi_{\\ell})$ 增加，从而增加流量。然而，当 $\\psi_{\\ell}$ 进一步下降时，由于栓塞，$k_{\\text{rel}}(\\psi_{\\ell})$ 减小，这反过来又降低了 $K_{\\text{tot}}$，并最终导致流量 $H$ 减小。我们必须通过在指定的叶片水势范围（从 $\\psi_{\\min} = -10 \\ \\mathrm{MPa}$ 到 $\\psi_{\\text{soil}}$）内评估 $H(\\psi_{\\ell}; T)$ 来找到该函数的最大值 $H_{\\max}(T)$。这是通过将区间 $[\\psi_{\\min}, \\psi_{\\text{soil}}]$ 离散化为一个至少有 $10001$ 个点的精细网格，并在此网格上找到 $H$ 的最大值来完成的。\n\n第四，我们确定实现的稳态质量流 $F_{\\text{real}}$。\n- 如果大气需求大于植物的最大能力（$F_{\\text{demand}} > H_{\\max}$），则流量受供应限制。植物无法满足需求，实现的流量被限制在最大可能速率：$F_{\\text{real}} = H_{\\max}$。\n- 如果大气需求小于或等于最大能力（$F_{\\text{demand}} \\le H_{\\max}$），则植物可以维持所需的流量。系统在叶片水势 $\\psi_{\\ell}^{\\star}$ 处达到平衡，此时供应等于需求。因此，实现的流量由大气决定：$F_{\\text{real}} = F_{\\text{demand}}$。\n\n最后，将实现的质量流率 $F_{\\text{real}}$（单位 $\\mathrm{kg \\ s^{-1}}$）转换为所需的输出格式：单位为毫摩尔每秒（$\\mathrm{mmol \\ s^{-1}}$）的摩尔流率 $E_{\\text{real}}$。\n$$E_{\\text{real}} = \\frac{F_{\\text{real}}}{M_{\\mathrm{w}}} \\times 1000$$\n程序将对所提供的五个测试用例中的每一个实施此逻辑，并将最终结果四舍五入到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    It computes the realized molar flow rate for each case and prints the results\n    in the specified format.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (D_kPa, T_C, A_l, g_sw, psi_soil, K_root_ref, K_stem_max_ref, P50, S)\n    # Units: (kPa, °C, m^2, mol m^-2 s^-1, MPa, kg s^-1 MPa^-1, kg s^-1 MPa^-1, MPa, MPa^-1)\n    test_cases = [\n        (1.5, 25.0, 1.5, 0.2, -0.2, 0.0012, 0.0013, -2.0, 3.0),\n        (4.0, 25.0, 1.5, 0.2, -0.8, 0.00012, 0.00012, -1.5, 4.0),\n        (0.0, 30.0, 2.0, 0.3, -0.5, 0.0005, 0.0010, -2.0, 3.0),\n        (4.0, 45.0, 1.5, 0.2, -0.8, 0.00012, 0.00012, -1.5, 4.0),\n        (1.0, 25.0, 1.0, 0.15, -2.0, 0.0005, 0.0008, -1.8, 5.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        realized_flow = calculate_realized_flow(case)\n        results.append(f\"{realized_flow:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_realized_flow(params):\n    \"\"\"\n    Computes the realized steady-state molar flow rate of water for a single set of parameters.\n    \"\"\"\n    # Unpack parameters\n    D_kPa, T_C, A_l, g_sw, psi_soil, K_root_ref, K_stem_max_ref, P50, S = params\n\n    # --- Constants ---\n    P_ATM = 101325.0         # Atmospheric pressure (Pa)\n    M_W = 0.01801528         # Molar mass of water (kg/mol)\n    T_REF = 298.15           # Reference temperature (K)\n    VISC_A = 2.414e-5        # Viscosity parameter A (Pa s)\n    VISC_B = 247.8           # Viscosity parameter B (K)\n    VISC_C = 140.0           # Viscosity parameter C (K)\n    PSI_MIN = -10.0          # Minimum leaf water potential for search (MPa)\n    N_POINTS = 10001         # Number of grid points for hydraulic supply curve\n\n    # --- Step 1: Unit conversions and temperature-dependent calculations ---\n    D_Pa = D_kPa * 1000.0\n    T_K = T_C + 273.15\n\n    # Viscosity of water function\n    def mu(T_in_K):\n        return VISC_A * 10**(VISC_B / (T_in_K - VISC_C))\n\n    # Calculate viscosity correction factor\n    viscosity_correction = mu(T_REF) / mu(T_K)\n    \n    # Adjust conductances for temperature\n    K_root_T = K_root_ref * viscosity_correction\n    K_stem_max_T = K_stem_max_ref * viscosity_correction\n\n    # --- Step 2: Calculate atmospheric demand flow rate (F_demand) ---\n    E_mol = g_sw * A_l * D_Pa / P_ATM\n    F_demand = M_W * E_mol\n    \n    # --- Step 3: Define hydraulic supply function H(psi_l) and find its maximum ---\n    \n    # Relative conductivity function (vulnerability curve)\n    def k_rel(psi):\n        return 1.0 / (1.0 + np.exp(-S * (psi - P50)))\n    \n    # Generate grid for leaf water potential psi_l\n    psi_l_grid = np.linspace(PSI_MIN, psi_soil, N_POINTS)\n    \n    # Calculate H(psi_l) across the grid using vectorized operations with numpy\n    k_rel_values = k_rel(psi_l_grid)\n    K_stem_T_values = K_stem_max_T * k_rel_values\n    \n    # Calculate total conductance using the robust form for series conductances\n    # This form, K_tot = (K1 * K2) / (K1 + K2), avoids explicit inversion.\n    denominator = K_root_T + K_stem_T_values\n    K_tot_values = np.divide(K_root_T * K_stem_T_values, denominator, \n                             out=np.zeros_like(denominator), where=denominator != 0)\n\n    # Calculate hydraulic supply H(psi_l)\n    H_values = K_tot_values * (psi_soil - psi_l_grid)\n    \n    # Find the maximum hydraulic supply\n    H_max = np.max(H_values)\n\n    # --- Step 4: Determine the realized mass flow rate (F_real) ---\n    if F_demand > H_max:\n        F_real = H_max  # Supply-limited case\n    else:\n        F_real = F_demand  # Demand-limited case\n\n    # --- Step 5: Convert F_real to molar flow rate in mmol/s and return ---\n    E_real = 1000.0 * F_real / M_W\n    \n    return E_real\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "2555401"}]}