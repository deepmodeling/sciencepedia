{"hands_on_practices": [{"introduction": "理解孤雌生殖的起点是分析其对后代基因组成的影响。本练习旨在建立一个基础模型，用以量化特定类型的自体孤雌生殖（中心融合）如何影响杂合性——这是评估进化潜力和近交衰退风险的关键参数。通过推导重组率 $r$ 与杂合性保留概率之间的关系，您将掌握分析繁殖系统遗传后果的核心技能 [@problem_id:2595264]。", "problem": "在一个表现出中心融合自体单性生殖的二倍体动物谱系中，考虑一个携带具有两个等位基因 $A$ 和 $a$ 的基因座的二价体，使得母亲在该基因座上初始为杂合子 $A/a$。假设采用标准的减数分裂四分体模型，无染色单体干涉且分离正常，并且二倍性通过中心融合恢复，意即来自第一次分裂形成的两个二分体的各一个单倍体产物融合形成子代的细胞核。设该基因座与其着丝粒之间的重组率为 $r$（在有序四分体分析的意义下，即标准的基因座-着丝粒重组距离）。\n\n从第一次分裂分离和第二次分裂分离的基本定义以及经典的有序四分体框架出发，推导出一个以 $r$ 表示的闭式表达式，该表达式表示经过一代中心融合自体单性生殖后，二倍体单性生殖子代在该基因座上保持杂合性的概率。将最终答案表示为关于 $r$ 的单个解析表达式。无需进行数值计算或四舍五入。", "solution": "本题要求推导通过中心融合自体单性生殖产生的子代在给定基因座上保持其母亲杂合性的概率。我们首先分析减数分裂过程和分离模式。\n\n母亲是二倍体，在一个带有等位基因 $A$ 和 $a$ 的基因座上是杂合的。她的基因型是 $A/a$。在减数分裂之前，发生DNA复制，因此同源染色体对形成的二价体包含四条染色单体。一条复制后的染色体由两条都携带等位基因 $A$ 的姐妹染色单体组成，另一条则由两条都携带等位基因 $a$ 的姐妹染色单体组成。\n\n减数分裂的遗传结果取决于基因座与其着丝粒之间是否发生交换。这导致了等位基因的两种分离模式：\n\n1.  **第一次分裂分离 (FDS)**：当基因座和着丝粒之间没有发生交换时，会出现这种模式。在减数分裂后期 I，同源染色体分离。一个次级母细胞接收带有两条 $A$ 染色单体的复制后染色体，另一个则接收带有两条 $a$ 染色单体的复制后染色体。等位基因 $A$ 和 $a$ 在第一次减数分裂时分离。\n\n2.  **第二次分裂分离 (SDS)**：当基因座和着丝粒之间发生单次交换时，会出现这种模式。由于交换，进入减数分裂后期 I 分离的每个同源染色体现在都是杂合的，携带一个带有等位基因 $A$ 的染色单体和一个带有等位基因 $a$ 的染色单体。因此，等位基因 $A$ 和 $a$ 直到姐妹染色单体分离的第二次减数分裂时才发生分离。\n\n题目给出了基因座和着丝粒之间的重组率 $r$，这是在有序四分体分析的背景下定义的。在此框架中，重组率 $r$ 等于表现出第二次分裂分离的四分体频率的一半。这是因为一个SDS四分体在四个产物中包含两个重组产物和两个非重组产物。\n设 $P(\\text{FDS})$ 和 $P(\\text{SDS})$ 分别是发生 FDS 和 SDS 模式的概率。根据 $r$ 的定义：\n$$r = \\frac{1}{2} P(\\text{SDS})$$\n这意味着：\n$$P(\\text{SDS}) = 2r$$\n由于对于单个基因座，FDS 和 SDS 是仅有的两种可能性：\n$$P(\\text{FDS}) = 1 - P(\\text{SDS}) = 1 - 2r$$\n该模型对于重组率 $r$ 满足 $0 \\le r \\le \\frac{1}{2}$ 时有效，这确保了 $P(\\text{SDS}) \\le 1$。\n\n接下来，我们分析中心融合自体单性生殖对每种分离模式的后果。中心融合定义为，在减数分裂 I 结束后形成的两个二分体中，各取一个单倍体产物进行融合。\n\n**情况1：发生 FDS (概率为 $1 - 2r$)**\n在减数分裂 I 结束时，一个二分体包含两条 $A$ 型染色单体，另一个二分体包含两条 $a$ 型染色单体。\n- 第一个二分体经过减数分裂 II，产生两个单倍体细胞核，基因型均为 $A$。\n- 第二个二分体经过减数分裂 II，产生两个单倍体细胞核，基因型均为 $a$。\n中心融合涉及将第一个二分体的产物中的一个细胞核（必然是 $A$）与第二个二分体的产物中的一个细胞核（必然是 $a$）融合。产生的二倍体子代基因型将是 $A/a$。\n因此，如果发生 FDS，子代必定是杂合子。在 FDS 发生的条件下，保持杂合性的概率是 $1$。\n$$P(\\text{杂合} | \\text{FDS}) = 1$$\n\n**情况2：发生 SDS (概率为 $2r$)**\n在减数分裂 I 结束时，由于发生了交换，两个二分体都是杂合的。每个二分体包含一条 $A$ 型染色单体和一条 $a$ 型染色单体。\n- 第一个二分体经过减数分裂 II，产生一个基因型为 $A$ 的单倍体细胞核和一个基因型为 $a$ 的单倍体细胞核。随机选择一个 $A$ 细胞核的概率是 $\\frac{1}{2}$，选择一个 $a$ 细胞核的概率是 $\\frac{1}{2}$。\n- 类似地，第二个二分体的减数分裂产物是一个 $A$ 细胞核和一个 $a$ 细胞核。选择 $A$ 的概率也是 $\\frac{1}{2}$，选择 $a$ 的概率也是 $\\frac{1}{2}$。\n中心融合将来自第一个谱系的一个随机细胞核与来自第二个的一个随机细胞核结合起来。子代可能的基因型是：\n- $A/A$：通过融合来自第一个二分体的 $A$ 细胞核和来自第二个二分体的 $A$ 细胞核。概率是 $P(A_1 \\cap A_2) = P(A_1)P(A_2) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$。\n- $a/a$：通过融合来自第一个二分体的 $a$ 细胞核和来自第二个二分体的 $a$ 细胞核。概率是 $P(a_1 \\cap a_2) = P(a_1)P(a_2) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$。\n- $A/a$：通过融合来自第一个的 $A$ 和来自第二个的 $a$，或来自第一个的 $a$ 和来自第二个的 $A$。概率是 $P(A_1 \\cap a_2) + P(a_1 \\cap A_2) = (\\frac{1}{2} \\times \\frac{1}{2}) + (\\frac{1}{2} \\times \\frac{1}{2}) = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}$。\n因此，如果发生 SDS，子代是杂合子的概率是 $\\frac{1}{2}$。\n$$P(\\text{杂合} | \\text{SDS}) = \\frac{1}{2}$$\n\n**保持杂合性的总概率**\n现在我们可以应用全概率定律来计算子代为杂合子（$P(\\text{Het})$）的总概率：\n$$P(\\text{Het}) = P(\\text{Het} | \\text{FDS}) \\cdot P(\\text{FDS}) + P(\\text{Het} | \\text{SDS}) \\cdot P(\\text{SDS})$$\n代入我们已推导出的值：\n$$P(\\text{Het}) = (1) \\cdot (1 - 2r) + \\left(\\frac{1}{2}\\right) \\cdot (2r)$$\n$$P(\\text{Het}) = 1 - 2r + r$$\n$$P(\\text{Het}) = 1 - r$$\n这就是经过一代中心融合自体单性生殖后，单性生殖子代在该基因座上保持杂合性的概率的闭式表达式。", "answer": "$$\\boxed{1-r}$$", "id": "2595264"}, {"introduction": "在掌握了孤雌生殖对个体基因的影响后，我们将视野扩展到种群和进化层面。孤雌生殖在自然界中与有性生殖构成竞争，其成功的关键之一在于能否克服著名的“双倍生殖成本”。本练习要求您为一种诱导孤雌生殖的共生体建立入侵动态模型，通过权衡其适应性成本 $c$ 和传播效率 $t$，推导出其在有性生殖种群中成功扩散的临界条件 [@problem_id:2595272]。", "problem": "在许多节肢动物中，母系遗传的细菌可以诱导其宿主进行产雌孤雌生殖。考虑一个处于种群动态平衡的随机交配、世代不重叠的宿主种群，其中有性生殖的宿主产生的女儿和儿子数量相等。假设在本地有性生殖种群中，每个雌性平均每代产生$1$个成年女儿和$1$个成年儿子（因此每个母亲的平均成年女儿数为$1$），这与密度调节下的Fisher均等投入原则一致。\n\n一个稀有的母系遗传共生体出现，它会诱导受感染的雌性进行产雌孤雌生殖。一个受感染的雌性只产生女儿，每个女儿从其母亲那里独立地遗传该共生体的概率为 $t \\in (0,1]$。感染对受感染的雌性施加一个乘性的适合度成本 $c \\in [0,1)$，使得相对于未受感染的有性生殖雌性，一个受感染的雌性产生的可存活成年后代总数减少为原来的 $(1-c)$ 倍。不存在父系传播或水平传播，受感染的雌性不需要交配，并且在共生体保持稀有时，密度调节继续维持本地种群的动态平衡。\n\n仅从这些基本原则和定义（母系遗传传播、有性生殖个体的均等性比平衡，以及种群动态平衡意味着每个有性生殖母亲平均产生一个成年女儿）出发，推导出临界成本函数 $c^{*}(t)$ 的闭式表达式，使得共生体从稀有状态下频率增加的条件是当且仅当 $c < c^{*}(t)$。请以单一解析表达式的形式给出 $c^{*}(t)$。不需要数值近似，也不涉及单位。", "solution": "本题要求推导诱导孤雌生殖的共生体入侵的临界成本函数 $c^{*}(t)$。入侵分析将基于比较稀有的受感染谱系的繁殖率与本地未受感染谱系的繁殖率。\n\n让我们将一个谱系的每个个体每代增长率定义为：由单个雌性产生的、存活到繁殖年龄且属于同一谱系的雌性后代的平均数量。如果受感染雌性谱系的增长率 $\\lambda_{I}$ 大于本地未受感染（有性生殖）雌性谱系的增长率 $\\lambda_{U}$，则共生体将成功入侵（即在稀有时频率增加）。入侵的条件是 $\\lambda_{I} > \\lambda_{U}$。\n\n首先，我们确定本地未受感染谱系的增长率 $\\lambda_{U}$。问题陈述，宿主种群处于种群动态平衡状态，其中一个有性生殖的雌性平均产生 $1$ 个成年女儿。这意味着就雌性后代而言，每个未受感染的母亲在下一代中恰好被替代。因此，未受感染雌性谱系的增长率为：\n$$\n\\lambda_{U} = 1\n$$\n\n接下来，我们必须确定受感染谱系的增长率 $\\lambda_{I}$。这是单个受感染雌性产生的受感染女儿的期望数量。我们可以如下计算：\n\n1.  一个未受感染的有性生殖雌性产生 $1$ 个成年女儿和 $1$ 个成年儿子。因此，她产生的可存活成年后代总数为 $1 + 1 = 2$。\n2.  问题陈述，感染施加了一个乘性的适合度成本 $c \\in [0,1)$，使得相对于未受感染的雌性，受感染雌性产生的可存活成年后代总数减少为原来的 $(1-c)$ 倍。因此，一个受感染雌性产生的成年后代总数为 $2(1-c)$。\n3.  受感染的雌性是产雌孤雌生殖的，只产生女儿。因此，一个受感染的雌性产生 $2(1-c)$ 个成年女儿。\n4.  共生体以概率 $t \\in (0,1]$ 从母亲垂直传播给女儿。因此，一个受感染的母亲产生的*受感染*女儿的期望数量是女儿总数乘以传播概率。\n\n这就得出了受感染谱系的每个个体增长率：\n$$\n\\lambda_{I} = (2(1-c)) \\times t = 2t(1-c)\n$$\n\n共生体从稀有状态下频率增加的条件是 $\\lambda_{I} > \\lambda_{U}$。代入增长率的表达式，我们得到：\n$$\n2t(1-c) > 1\n$$\n这个不等式表明，如果感染成本 $c$ 足够低，共生体就会入侵。问题要求的是临界成本 $c^{*}(t)$，使得入侵发生的条件是当且仅当 $c < c^{*}(t)$。该临界值可以在不等式变为等式的边界处找到，该点表示受感染谱系与未受感染谱系具有相同的增长率。\n$$\n2t(1-c^{*}(t)) = 1\n$$\n我们现在解这个关于 $c^{*}(t)$ 的方程，以获得临界成本函数。\n$$\n1 - c^{*}(t) = \\frac{1}{2t}\n$$\n$$\nc^{*}(t) = 1 - \\frac{1}{2t}\n$$\n这个表达式就是临界成本。如果实际成本 $c$ 小于 $c^{*}(t)$，则受感染谱系的每个个体增长率将大于 $1$，共生体将会扩散。如果 $c$ 大于或等于 $c^{*}(t)$，共生体将不会扩散。为了在成本为非负（$c \\ge 0$）的情况下入侵成为可能，我们必须有 $c^{*}(t) > 0$，这意味着 $1 - \\frac{1}{2t} > 0$，即 $t > \\frac{1}{2}$。如果传播效率 $t$ 不大于 $\\frac{1}{2}$，那么即使直接适合度成本 $c$ 为零，共生体也无法克服雄性带来的成本。推导出的 $c^{*}(t)$ 表达式正确地解释了在 $t$ 的整个定义域内的这种阈值行为。", "answer": "$$\n\\boxed{1 - \\frac{1}{2t}}\n$$", "id": "2595272"}, {"introduction": "最后，我们深入到触发孤雌生殖的细胞生物学机制层面。无论是自发还是人工诱导，孤雌生殖的成功都依赖于对卵母细胞的有效“激活”，以模拟受精信号。这项计算实践将指导您构建一个关于卵母细胞激活关键信号——钙离子振荡——的生物物理模型。通过模拟和分析，您将获得系统生物学建模的实践经验，并学习如何预测不同刺激条件能否成功启动卵母细胞的无性发育 [@problem_id:2595294]。", "problem": "构建一个最小的、基于生物物理学的动物卵母细胞内钙诱导钙释放模型，用以预测在没有受精的情况下退出中期停滞的条件。您的推导必须从质量平衡以及经过充分检验的通道门控和泵送动力学基序开始，并最终形成一个计算实现。该实现需要根据模拟的胞质钙时间序列，判断激活刺激是否足以触发退出。最终的程序必须对模型进行数值求解，并针对一个指定的测试套件评估一个决策准则，生成与结尾描述完全一致的单行输出。\n\n使用的生物物理学和数学基础：\n- 设胞质游离钙浓度为 $c$（单位为 $\\mu \\mathrm{M}$），未失活通道的比例为 $h$（无量纲，$0 \\le h \\le 1$）。设内质网 (ER) 为细胞内钙库，其游离钙浓度表示为 $c_{\\mathrm{ER}}$（单位为 $\\mu \\mathrm{M}$）。\n- 假设胞质的钙通量平衡：胞质钙浓度的随时间变化率 $\\frac{dc}{dt}$ 等于从ER到胞质的释放通量加上ER泄漏，减去泵入ER的摄取，再加上质膜流入，减去质膜流出。时间单位为秒。\n- 将肌醇 $1,4,5$-三磷酸 (IP3) 受体通道的开放表示为一个处于准稳态的激活门与一个遵循一阶弛豫的失活门 $h$ 的乘积。使用Hill型稳态激活，以及一个以钙依赖性时间常数向钙依赖性稳态弛豫的失活门；这些是从 De Young–Keizer 形式主义推导出的标准近似。\n- 通过体积比约束 $c_{\\mathrm{ER}} = \\frac{c_0 - c}{c_1}$ 来保持质膜交换前的总细胞内钙守恒，其中 $c_0$ 是总游离钙当量（单位为 $\\mu \\mathrm{M}$），$c_1$ 是胞质与ER的体积比（无量纲）。内部通量遵守此守恒定律，仅质膜的流入和流出项会破坏该守恒。\n\n基于这些基础，构建以下最小模型，除测试套件中变化的参数外，其余均使用固定值：\n- 胞质钙动力学：\n$$\n\\frac{dc}{dt} = J_{\\mathrm{chan}}(c,h,i) + J_{\\mathrm{leak}}(c,i) - J_{\\mathrm{pump}}(c) + J_{\\mathrm{in}} - k_{\\mathrm{out}}\\,c,\n$$\n其中 $i$ 表示 IP3 浓度（单位为 $\\mu \\mathrm{M}$），$J_{\\mathrm{in}}$ 是恒定的流入通量（单位为 $\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$），$k_{\\mathrm{out}}$ 是一阶流出速率（单位为 $\\mathrm{s}^{-1}$）。\n- 通道介导的释放和 ER 泄漏：\n$$\nJ_{\\mathrm{chan}} = v_1\\,m_{\\infty}(c,i)^3\\,h^3\\,(c_{\\mathrm{ER}} - c),\\quad\nJ_{\\mathrm{leak}} = v_2\\,(c_{\\mathrm{ER}} - c),\n$$\n其中\n$$\nm_{\\infty}(c,i) = \\frac{i}{i + d_1}\\cdot \\frac{c}{c + d_5},\\quad c_{\\mathrm{ER}} = \\frac{c_0 - c}{c_1}.\n$$\n- 泵入 ER 的摄取（肌浆/内质网钙ATP酶 (SERCA)）：\n$$\nJ_{\\mathrm{pump}} = v_3\\,\\frac{c^2}{k_p^2 + c^2}.\n$$\n- 通道失活门：\n$$\n\\frac{dh}{dt} = \\frac{h_{\\infty}(c,i) - h}{\\tau_h(c,i)},\\quad\nh_{\\infty}(c,i) = \\frac{Q_2(i)}{Q_2(i) + c},\\quad\n\\tau_h(c,i) = \\frac{1}{a_2\\,(Q_2(i) + c)},\n$$\n其中 $Q_2(i) = d_2\\,\\frac{i + d_1}{i + d_3}$。\n- 动物卵母细胞的固定默认参数（括号内为单位）：\n  - $c_0 = 2.0$ ($\\mu \\mathrm{M}$), $c_1 = 0.185$ (无量纲)。\n  - $v_1 = 6.0$ ($\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$), $v_2 = 0.11$ ($\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$), $v_3 = 0.9$ ($\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$), $k_p = 0.1$ ($\\mu \\mathrm{M}$)。\n  - $a_2 = 0.2$ ($\\mu \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$), $d_1 = 0.13$ ($\\mu \\mathrm{M}$), $d_2 = 1.049$ ($\\mu \\mathrm{M}$), $d_3 = 0.943$ ($\\mu \\mathrm{M}$), $d_5 = 0.082$ ($\\mu \\mathrm{M}$)。\n  - $k_{\\mathrm{out}} = 0.02$ ($\\mathrm{s}^{-1}$)，除非有变动。\n  - 初始条件：$c(0) = 0.1$ ($\\mu \\mathrm{M}$), $h(0) = h_{\\infty}(c(0),i)$。\n- 将 IP3 浓度 $i$ 和质膜钙流入 $J_{\\mathrm{in}}$ 视为人工孤雌生殖刺激（例如，离子载体、锶）的代理。\n\n无受精情况下退出中期的激活准则：\n- 已有充分证据表明，重复性的钙瞬变会触发动物卵母细胞退出中期停滞。在长度为 $T_{\\mathrm{end}}$（单位为秒）的模拟窗口内，若满足以下任一条件，则定义为激活成功：\n  - $c(t)$ 中至少出现 $N_{\\min}$ 个独立的峰值，且峰值严格大于阈值 $c_{\\mathrm{thr}}$（单位为 $\\mu \\mathrm{M}$），或者\n  - 超过 $c_{\\mathrm{base}}$ 的钙浓度的时间积分值超过面积阈值 $A_{\\min}$：\n  $$\n  \\int_{0}^{T_{\\mathrm{end}}} \\max\\{c(t) - c_{\\mathrm{base}},\\,0\\}\\,dt \\ge A_{\\min}.\n  $$\n- 使用 $T_{\\mathrm{end}} = 1500$ ($\\mathrm{s}$), $N_{\\min} = 3$, $c_{\\mathrm{thr}} = 0.4$ ($\\mu \\mathrm{M}$), $c_{\\mathrm{base}} = 0.3$ ($\\mu \\mathrm{M}$), 以及 $A_{\\min} = 60$ ($\\mu \\mathrm{M}\\cdot \\mathrm{s}$)。\n- 峰值之间必须至少相隔 $\\Delta t_{\\min} = 20$ ($\\mathrm{s}$) 才能被计为独立的峰值。\n\n数值要求：\n- 使用合适的常微分方程求解器对系统在 $t \\in [0, T_{\\mathrm{end}}]$ 区间上进行积分，绝对容差至多为 $10^{-9}$，相对容差至多为 $10^{-6}$。时间以秒表示，浓度以 $\\mu \\mathrm{M}$ 表示。\n- 按规定计算峰值数量和面积准则。每个测试用例的决策是一个布尔值：如果激活准则被满足，则为 true，否则为 false。\n\n测试套件：\n- 每个测试用例指定一个元组 $(i, v_3, J_{\\mathrm{in}}, k_{\\mathrm{out}})$，单位如上所述；所有其他参数保持默认值。使用以下 $5$ 个用例：\n  - 用例 $1$：$(i, v_3, J_{\\mathrm{in}}, k_{\\mathrm{out}}) = (0.5, 0.9, 0.02, 0.02)$。\n  - 用例 $2$：$(i, v_3, J_{\\mathrm{in}}, k_{\\mathrm{out}}) = (0.2, 0.9, 0.02, 0.02)$。\n  - 用例 $3$：$(i, v_3, J_{\\mathrm{in}}, k_{\\mathrm{out}}) = (0.5, 2.0, 0.02, 0.02)$。\n  - 用例 $4$：$(i, v_3, J_{\\mathrm{in}}, k_{\\mathrm{out}}) = (1.0, 0.9, 0.02, 0.02)$。\n  - 用例 $5$：$(i, v_3, J_{\\mathrm{in}}, k_{\\mathrm{out}}) = (0.5, 0.9, 0.0, 0.1)$。\n- 对每个用例进行模拟，并输出一个布尔值以表明激活准则是否被满足。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的 Python 风格的布尔值列表，按所列顺序对应于这 5 个用例，例如：“[True,False,True,False,True]”。输出中不允许包含额外的文本或空白字符。", "solution": "问题陈述已根据科学合理性、数学一致性和客观性标准进行了系统性评估。所提出的模型是细胞内钙动力学的一个公认的表示方法，它基于 Li-Rinzel 对肌醇 $1,4,5$-三磷酸 (IP3) 受体的 De Young–Keizer 模型的简化。所有参数、初始条件、模拟协议和评估标准都已明确无误地指定。因此，该问题被认为是有效的，并按如下方式构建解决方案。\n\n该问题要求构建并模拟一个动物卵母细胞钙动力学的生物物理模型，以确定在各种刺激条件下是否发生孤雌激活。该模型被表述为一个由两个耦合的常微分方程 (ODE) 组成的系统，这代表了一个初值问题 (IVP)。\n\n系统的状态变量是胞质游离钙浓度 $c(t)$ 和未失活的 IP3 受体通道的比例 $h(t)$。该系统由以下方程描述：\n$$\n\\frac{dc}{dt} = J_{\\mathrm{chan}}(c,h,i) + J_{\\mathrm{leak}}(c,i) - J_{\\mathrm{pump}}(c) + J_{\\mathrm{in}} - k_{\\mathrm{out}}\\,c\n$$\n$$\n\\frac{dh}{dt} = \\frac{h_{\\infty}(c,i) - h}{\\tau_h(c,i)}\n$$\n\n这些方程基于胞质钙的质量平衡原理。每一项都代表一个独特的生物物理过程：\n\n1.  **从 ER 到胞质的通量**：\n    -   $J_{\\mathrm{chan}} = v_1\\,m_{\\infty}(c,i)^3\\,h^3\\,(c_{\\mathrm{ER}} - c)$: 此项代表通过 IP3 受体通道从内质网 (ER) 发生的钙诱导钙释放 (CICR)。该通量与浓度梯度 $(c_{\\mathrm{ER}} - c)$ 成正比。通道门控是快速激活过程 $m_{\\infty}$ 和慢速失活过程 $h$ 的乘积。激活门 $m_{\\infty}(c,i) = \\frac{i}{i + d_1}\\cdot \\frac{c}{c + d_5}$ 同时依赖于刺激 $i$（IP3 浓度）和胞质钙 $c$，形成了一个对兴奋性至关重要的正反馈回路。失活门 $h$ 在高钙浓度下关闭通道，提供了振荡动力学所需的负反馈。3次幂是根据问题陈述指定的。ER 钙浓度 $c_{\\mathrm{ER}}$ 通过守恒定律 $c_{\\mathrm{ER}} = (c_0 - c)/c_1$ 与胞质浓度 $c$ 相关联，其中 $c_0$ 是系统总钙量，$c_1$ 是胞质与 ER 的体积比。\n    -   $J_{\\mathrm{leak}} = v_2\\,(c_{\\mathrm{ER}} - c)$: 这是钙从 ER 到胞质的被动泄漏，由相同的浓度梯度驱动。\n\n2.  **从胞质到 ER 的通量**：\n    -   $J_{\\mathrm{pump}} = v_3\\,\\frac{c^2}{k_p^2 + c^2}$: 此项模拟了 SERCA 泵将钙从胞质主动转运回 ER 的过程。它由一个 Hill 方程描述，表明了钙与泵的协同结合。这个过程是在钙瞬变后恢复低基础钙水平的主要机制。\n\n3.  **质膜通量**：\n    -   $J_{\\mathrm{in}} - k_{\\mathrm{out}}\\,c$: 这些项代表与细胞外环境的钙交换。$J_{\\mathrm{in}}$ 是一个恒定的流入，而 $k_{\\mathrm{out}}\\,c$ 是一个一阶流出，代表像 PMCA 这样的泵的排出作用。\n\n4.  **失活门动力学**：\n    -   描述 $h$ 的 ODE 描述了其向钙依赖性稳态 $h_{\\infty}(c,i) = \\frac{Q_2(i)}{Q_2(i) + c}$ 的弛豫过程，时间常数为 $\\tau_h(c,i) = \\frac{1}{a_2\\,(Q_2(i) + c)}$。函数 $Q_2(i) = d_2\\,\\frac{i + d_1}{i + d_3}$ 封装了 IP3 对失活过程的调节效应。这种慢速负反馈对于产生持续振荡至关重要。\n\n解决方案策略对每个测试用例包含以下步骤：\n1.  **初始化**：设置特定测试用例 $(i, v_3, J_{\\mathrm{in}}, k_{\\mathrm{out}})$ 的参数。确定初始状态向量 $[c(0), h(0)]$。$c(0) = 0.1\\,\\mu\\mathrm{M}$ 是固定的，$h(0)$ 计算为 $h_{\\infty}(c(0), i)$，以确保失活门从其准稳态开始。\n2.  **数值积分**：在时间区间 $[0, T_{\\mathrm{end}}]$（$T_{\\mathrm{end}} = 1500\\,\\mathrm{s}$）上对 ODE 系统进行数值求解。我们使用 `scipy.integrate` 库中的 `solve_ivp` 函数，这是一个用于初值问题的稳健求解器。为确保准确性和稳定性，特别是考虑到潜在的刚性问题，我们选择 'LSODA' 方法。按要求将容差设置为 $rtol=10^{-6}$ 和 $atol=10^{-9}$。解在一系列密集的时间点网格上进行评估，以便进行准确的后续分析。\n3.  **评估激活准则**：对得到的 $c(t)$ 时间序列进行分析，以确定是否触发了中期退出。此决策基于两个准则：\n    -   **峰值计数**：计算超过阈值 $c_{\\mathrm{thr}} = 0.4\\,\\mu\\mathrm{M}$ 的独立钙峰值的数量。为此目的，使用 `scipy.signal` 的 `find_peaks` 函数。强制执行至少 $\\Delta t_{\\min} = 20\\,\\mathrm{s}$ 的时间间隔，以将峰计为独立的。如果计数至少为 $N_{\\min}=3$，则满足此准则。\n    -   **积分钙浓度**：使用梯形法则 (`numpy.trapz`) 计算超过基线 $c_{\\mathrm{base}} = 0.3\\,\\mu\\mathrm{M}$ 的钙浓度的时间积分。如果该积分值 $\\int_{0}^{T_{\\mathrm{end}}} \\max\\{c(t) - c_{\\mathrm{base}},\\,0\\}\\,dt$ 超过阈值 $A_{\\min} = 60\\,\\mu\\mathrm{M}\\cdot\\mathrm{s}$，则满足此准则。\n4.  **决策**：如果峰值计数准则或积分钙浓度准则中的任意一个被满足，则测试用例结果为成功激活。每个用例的最终输出是一个布尔值（`True` 或 `False`）。\n\n提供的 Python 代码实现了这个完整的工作流程。它定义了模型方程，为每个测试用例设置参数，调用 ODE 求解器，并将决策逻辑应用于模拟结果，最终生成指定格式的布尔值列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.signal import find_peaks\n\ndef solve():\n    \"\"\"\n    Solves the calcium dynamics model for oocyte activation and evaluates\n    the activation criteria across a suite of test cases.\n    \"\"\"\n\n    # Default model parameters\n    default_params = {\n        'c0': 2.0,    # muM\n        'c1': 0.185,  # dimensionless\n        'v1': 6.0,    # muM/s\n        'v2': 0.11,   # muM/s\n        'kp': 0.1,    # muM\n        'a2': 0.2,    # 1/(muM*s)\n        'd1': 0.13,   # muM\n        'd2': 1.049,  # muM\n        'd3': 0.943,  # muM\n        'd5': 0.082,  # muM\n    }\n\n    # Test cases: (i, v3, J_in, k_out)\n    test_cases = [\n        (0.5, 0.9, 0.02, 0.02),\n        (0.2, 0.9, 0.02, 0.02),\n        (0.5, 2.0, 0.02, 0.02),\n        (1.0, 0.9, 0.02, 0.02),\n        (0.5, 0.9, 0.0, 0.1),\n    ]\n\n    # Activation criterion parameters\n    T_end = 1500.0         # s\n    N_min = 3              # count\n    c_thr = 0.4            # muM\n    delta_t_min = 20.0     # s\n    c_base = 0.3           # muM\n    A_min = 60.0           # muM*s\n\n    # Initial condition for cytosolic calcium\n    c_initial = 0.1        # muM\n\n    # Time points for ODE solver output\n    t_eval_step = 0.5      # s\n    t_eval = np.arange(0, T_end + t_eval_step, t_eval_step)\n\n    results = []\n    for case in test_cases:\n        i, v3_case, J_in_case, k_out_case = case\n\n        params = default_params.copy()\n        params['i'] = i\n        params['v3'] = v3_case\n        params['J_in'] = J_in_case\n        params['k_out'] = k_out_case\n\n        # Calculate initial h based on steady-state at t=0\n        Q2_initial = params['d2'] * (i + params['d1']) / (i + params['d3'])\n        h_initial = Q2_initial / (Q2_initial + c_initial)\n        \n        y0 = [c_initial, h_initial]\n\n        # Numerically integrate the system of ODEs\n        sol = solve_ivp(\n            model_rhs, \n            (0, T_end), \n            y0, \n            args=(params,), \n            t_eval=t_eval, \n            method='LSODA', # Robust for potentially stiff problems\n            rtol=1e-6, \n            atol=1e-9\n        )\n        \n        t = sol.t\n        c_series = sol.y[0]\n\n        # --- Evaluate activation criteria ---\n\n        # 1. Peak count criterion\n        distance_samples = int(delta_t_min / t_eval_step)\n        peaks, _ = find_peaks(c_series, height=c_thr, distance=distance_samples)\n        num_peaks = len(peaks)\n        peak_criterion_met = (num_peaks >= N_min)\n\n        # 2. Integrated calcium criterion\n        integrand = np.maximum(c_series - c_base, 0)\n        area = np.trapz(integrand, t)\n        area_criterion_met = (area >= A_min)\n\n        # Final decision for the case\n        activation_achieved = peak_criterion_met or area_criterion_met\n        results.append(activation_achieved)\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef model_rhs(t, y, params):\n    \"\"\"\n    Defines the right-hand side of the ODE system for calcium dynamics.\n    \"\"\"\n    c, h = y\n    \n    # Unpack parameters\n    i = params['i']\n    c0, c1 = params['c0'], params['c1']\n    v1, v2, v3, kp = params['v1'], params['v2'], params['v3'], params['kp']\n    a2, d1, d2, d3, d5 = params['a2'], params['d1'], params['d2'], params['d3'], params['d5']\n    J_in, k_out = params['J_in'], params['k_out']\n    \n    # Algebraic relations\n    c_ER = (c0 - c) / c1\n    \n    # Positive feedback activation\n    m_inf = (i / (i + d1)) * (c / (c + d5))\n    \n    # Inactivation dynamics\n    Q2 = d2 * (i + d1) / (i + d3)\n    h_inf = Q2 / (Q2 + c)\n    tau_h = 1.0 / (a2 * (Q2 + c))\n    \n    # Fluxes\n    J_chan = v1 * (m_inf**3) * (h**3) * (c_ER - c)\n    J_leak = v2 * (c_ER - c)\n    J_pump = v3 * (c**2) / (kp**2 + c**2)\n    \n    # Derivatives\n    dcdt = J_chan + J_leak - J_pump + J_in - k_out * c\n    dhdt = (h_inf - h) / tau_h\n    \n    return [dcdt, dhdt]\n\nsolve()\n```", "id": "2595294"}]}