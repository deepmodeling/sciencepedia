{"hands_on_practices": [{"introduction": "我们首先来描述棘皮动物水管系统微小管道内的物理环境。这项练习要求你计算雷诺数（$Re$），这是一个决定流体流动性质的关键无量纲参数。通过计算，你将确定水流是由惯性主导还是由粘性主导，这是建立任何精确的系统生物力学模型至关重要的第一步 [@problem_id:2567844]。", "problem": "在海星的水管系统中，每个管足通过一个侧管连接到辐射管，该侧管可以理想化为一个直圆柱体。考虑这样一个侧管，其圆形横截面直径为 $D = 50\\,\\mu\\mathrm{m}$，由坛足肌肉收缩驱动，输送海水的稳定体积流量为 $Q = 1\\,\\mu\\mathrm{L}\\,\\mathrm{min}^{-1}$。假设在 $20\\,^{\\circ}\\mathrm{C}$ 时，海水的动力黏度为 $\\mu = 1.05 \\times 10^{-3}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$，密度为 $\\rho = 1.025 \\times 10^{3}\\,\\mathrm{kg}\\cdot\\mathrm{m}^{-3}$。仅使用流体力学的基本定义和适当的几何关系，计算此侧管中流动的雷诺数，其中以管径作为特征长度，以平均轴向速度作为特征速度。然后，根据您计算出的值以及雷诺数作为惯性效应与黏性效应之比的物理意义，说明在此流态下，动量平衡中是否可以忽略惯性效应，并给出定量论证。将雷诺数报告为一个纯数（无量纲），并将您的答案四舍五入到两位有效数字。在所有中间计算中使用国际单位制（SI）单位。", "solution": "**步骤1：提取已知条件**\n-   管道几何形状：直圆柱体\n-   横截面直径：$D = 50\\,\\mu\\mathrm{m}$\n-   体积流量：$Q = 1\\,\\mu\\mathrm{L}\\,\\mathrm{min}^{-1}$\n-   流动条件：稳定\n-   流体：$20\\,^{\\circ}\\mathrm{C}$ 的海水\n-   海水动力黏度：$\\mu = 1.05 \\times 10^{-3}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$\n-   海水密度：$\\rho = 1.025 \\times 10^{3}\\,\\mathrm{kg}\\cdot\\mathrm{m}^{-3}$\n-   雷诺数的特征长度：管径 $D$\n-   雷诺数的特征速度：平均轴向速度 $v$\n-   要求计算：雷诺数 $Re$，四舍五入到两位有效数字。\n-   要求分析：根据 $Re$ 的值，判断在动量平衡中是否可以忽略惯性效应，并提供定量论证。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于流体力学原理，特别是用雷诺数表征流态的概念。所述的海水物理性质（密度和黏度）值对于给定温度是标准且正确的。几何和流动参数对于像海星水管系统这样的微尺度系统是生物学上合理的。这个问题是适定的、自洽的，并要求进行明确的计算和基于物理的解释。所有必要的数据都已提供，且没有矛盾之处。语言客观、精确。\n\n**步骤3：结论与行动**\n问题被判定为**有效的**。将提供一个解。\n\n任务是计算海星水管系统侧管中海水流动的雷诺数 $Re$。雷诺数是一个无量纲量，表示流体内部惯性力与黏性力之比。其定义为：\n$$Re = \\frac{\\rho v L}{\\mu}$$\n其中 $\\rho$ 是流体密度，$v$ 是特征速度，$L$ 是特征线性尺寸，$\\mu$ 是流体的动力黏度。问题指定特征长度为管径 $L=D$，特征速度为平均轴向速度 $v$。因此，公式变为：\n$$Re = \\frac{\\rho v D}{\\mu}$$\n为了计算 $Re$，我们必须首先确定平均轴向速度 $v$，并确保所有量都用一致的国际单位制（SI）单位表示。\n\n首先，我们将给定的参数转换为国际单位制基本单位。\n直径为 $D = 50\\,\\mu\\mathrm{m} = 50 \\times 10^{-6}\\,\\mathrm{m}$。\n动力黏度为 $\\mu = 1.05 \\times 10^{-3}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$。这已经是国际单位制单位。\n密度为 $\\rho = 1.025 \\times 10^{3}\\,\\mathrm{kg}\\cdot\\mathrm{m}^{-3}$。这也是国际单位制单位。\n体积流量为 $Q = 1\\,\\mu\\mathrm{L}\\,\\mathrm{min}^{-1}$。我们将其转换为 $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$。\n已知 $1\\,\\mathrm{L} = 10^{-3}\\,\\mathrm{m}^3$，则 $1\\,\\mu\\mathrm{L} = 10^{-6}\\,\\mathrm{L} = 10^{-9}\\,\\mathrm{m}^3$。\n此外，$1\\,\\mathrm{min} = 60\\,\\mathrm{s}$。\n因此，以国际单位制表示的流量为：\n$$Q = \\frac{1 \\times 10^{-9}\\,\\mathrm{m}^3}{60\\,\\mathrm{s}} = \\frac{1}{60} \\times 10^{-9}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}$$\n\n接下来，我们计算平均轴向速度 $v$。对于流经恒定横截面积 $A$ 的管道的流体，平均速度通过连续性方程 $Q = vA$ 与体积流量 $Q$ 相关联。管道的横截面是直径为 $D$ 的圆形，所以其面积为：\n$$A = \\pi \\left(\\frac{D}{2}\\right)^2 = \\frac{\\pi D^2}{4}$$\n因此，平均轴向速度为：\n$$v = \\frac{Q}{A} = \\frac{Q}{\\frac{\\pi D^2}{4}} = \\frac{4Q}{\\pi D^2}$$\n\n现在我们可以将 $v$ 的这个表达式代入雷诺数的公式中：\n$$Re = \\frac{\\rho \\left(\\frac{4Q}{\\pi D^2}\\right) D}{\\mu} = \\frac{4 \\rho Q}{\\pi \\mu D}$$\n这种形式更可取，因为它允许直接从给定的量进行计算，从而最大限度地减少中间舍入误差。\n我们将以国际单位制表示的值代入该表达式中：\n$$Re = \\frac{4 \\times (1.025 \\times 10^{3}\\,\\mathrm{kg}\\cdot\\mathrm{m}^{-3}) \\times (\\frac{1}{60} \\times 10^{-9}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1})}{\\pi \\times (1.05 \\times 10^{-3}\\,\\mathrm{Pa}\\cdot\\mathrm{s}) \\times (50 \\times 10^{-6}\\,\\mathrm{m})}$$\n让我们分别计算数值因子和 $10$ 的幂。\n$$Re = \\left( \\frac{4 \\times 1.025}{60 \\times \\pi \\times 1.05 \\times 50} \\right) \\times \\left( \\frac{10^3 \\times 10^{-9}}{10^{-3} \\times 10^{-6}} \\right)$$\n包含 $10$ 的幂的项简化为：\n$$\\frac{10^{-6}}{10^{-9}} = 10^3$$\n数值系数为：\n$$\\frac{4.1}{60 \\times \\pi \\times 1.05 \\times 50} = \\frac{4.1}{3000 \\times \\pi \\times 1.05} = \\frac{4.1}{3150 \\pi}$$\n合并这些结果：\n$$Re = \\frac{4.1}{3150 \\pi} \\times 10^3 = \\frac{4100}{3150 \\pi} = \\frac{410}{315 \\pi} \\approx \\frac{1.301587}{\\pi} \\approx 0.41432$$\n问题要求答案四舍五入到两位有效数字。\n$$Re \\approx 0.41$$\n\n任务的第二部分是解释这个结果。雷诺数的物理意义是惯性力与黏性力之比。低雷诺数（$Re \\ll 1$）表示黏性力主导惯性力，这种流态被称为斯托克斯流或蠕动流。高雷诺数（$Re \\gg 1$）表示惯性力占主导地位，导致湍流。\n我们计算出的值为 $Re \\approx 0.41$。由于该值小于 $1$，它证实了流动处于黏性效应占主导的蠕动流区域。\n在动量平衡（纳维-斯托克斯方程）中忽略惯性效应的定量论证就是 $Re$ 本身的大小。惯性力与黏性力的大小之比约为 $0.41$。这意味着惯性力的大小约为黏性力的 $41\\%$。在许多流体动力学分析中，特别是在微流控学和微尺度生理流动中，小于主导项大小一半的项在一阶近似中被认为是可忽略的。因此，因为 $Re < 1$，动量平衡中的惯性项可以被忽略，从而将纳维-斯托克斯方程简化为线性的斯托克斯方程。该断言是合理的。", "answer": "$$ \\boxed{0.41} $$", "id": "2567844"}, {"introduction": "基于水管系统中的流动由粘性主导这一理解，我们现在来探讨解剖学上的差异如何直接影响液压功能。本练习要求你应用泊肃叶流原理，比较不同纲棘皮动物辐管的液压阻力。这项练习将锻炼你将形态学与生理性能联系起来的能力，并让你体会演化针对同一工程问题所产生的多样化对策 [@problem_id:2567825]。", "problem": "棘皮动物通过水管系统（WVS）内产生的液压来驱动管足。一个关键的管道是辐管，它将流体分配到坛囊和管足。假设比较组织学得到以下五个主要纲的代表性物种的辐管内部横截面积，每个面积都在同源的中辐位置测量，并理想化为沿局部段具有恒定横截面的圆形：海星纲 $A_{\\mathrm{Ast}}=0.080\\,\\text{mm}^{2}$，海胆纲 $A_{\\mathrm{Ech}}=0.050\\,\\text{mm}^{2}$，海参纲 $A_{\\mathrm{Hol}}=0.120\\,\\text{mm}^{2}$，蛇尾纲 $A_{\\mathrm{Oph}}=0.035\\,\\text{mm}^{2}$，以及海百合纲 $A_{\\mathrm{Crin}}=0.060\\,\\text{mm}^{2}$。假设体腔液可被视为不可压缩的牛顿流体，其动力黏度为 $\\mu=1.20\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$。考虑每条辐管长度为 $L=15\\,\\text{mm}$ 的一个直的、水平的、局部均匀的段，在所关心的时间尺度内管壁无柔性，并在管壁处施加无滑移边界条件。\n\n在一项比较试验中，WVS 的运动器官驱动相同的体积流率 $Q=1.00\\times 10^{-10}\\,\\text{m}^{3}\\,\\text{s}^{-1}$ 通过上述每个辐管段。从不可压缩、稳态的 Navier–Stokes 方程出发，针对无体力作用下直圆管内充分发展的轴对称层流进行特化，并使用无滑移边界条件，推导长度为 $L$ 的管段上的压降 $\\Delta P$ 对 $Q$、$\\mu$ 和横截面积 $A$ 的函数依赖关系。然后使用所提供的数据计算在这五个纲之间，在这些相同条件下最大压降与最小压降之比 $\\rho$。\n\n以纯数形式（无单位）报告 $\\rho$，并将最终答案四舍五入到三位有效数字。不要报告中间值；只要求提供最终的比率。", "solution": "**对问题陈述的验证**\n\n**步骤1：提取给定条件**\n- 辐管的横截面积：\n  - 海星纲: $A_{\\mathrm{Ast}}=0.080\\,\\text{mm}^{2}$\n  - 海胆纲: $A_{\\mathrm{Ech}}=0.050\\,\\text{mm}^{2}$\n  - 海参纲: $A_{\\mathrm{Hol}}=0.120\\,\\text{mm}^{2}$\n  - 蛇尾纲: $A_{\\mathrm{Oph}}=0.035\\,\\text{mm}^{2}$\n  - 海百合纲: $A_{\\mathrm{Crin}}=0.060\\,\\text{mm}^{2}$\n- 流体性质：动力黏度 $\\mu=1.20\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$。\n- 辐管段几何形状：长度 $L=15\\,\\text{mm}$。\n- 流动条件：体积流率 $Q=1.00\\times 10^{-10}\\,\\text{m}^{3}\\,\\text{s}^{-1}$。\n- 假设：不可压缩牛顿流体，稳态，充分发展，轴对称层流，直圆管，无体力，管壁处无滑移边界条件，无管壁柔性。\n\n**步骤2：使用提取的给定条件进行验证**\n该问题具有科学依据，是流体力学基本原理（Navier-Stokes 方程）在生物流体动力学场景中的直接应用。给定的参数对于微流体系统是物理上合理的；快速计算雷诺数可以确认流动完全处于层流状态（$Re \\ll 2100$），从而验证了初始假设。该问题是适定的，提供了推导所需关系和计算最终值所需的所有必要信息。语言客观而精确。该问题没有科学上的不健全、模糊不清和矛盾之处。这是一个标准的、可形式化的物理学问题。\n\n**步骤3：结论与行动**\n问题有效。将制定严谨的解法。\n\n推导始于柱坐标系 $(r, \\theta, z)$ 下的不可压缩、稳态 Navier-Stokes 方程，其中 $z$ 是辐管的轴向方向：\n$$ \\rho \\left( \\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla)\\mathbf{v} \\right) = -\\nabla P + \\mu \\nabla^2 \\mathbf{v} + \\mathbf{f} $$\n问题指定了一系列简化条件：\n1.  稳态流：$\\frac{\\partial}{\\partial t} = 0$。\n2.  无体力：$\\mathbf{f} = \\mathbf{0}$。\n3.  直圆管中的轴对称流：对所有物理量 $\\frac{\\partial}{\\partial \\theta} = 0$，且径向速度 $v_r$ 和方位角速度 $v_\\theta$ 均为零。因此速度矢量为 $\\mathbf{v} = v_z(r, z)\\mathbf{\\hat{z}}$。\n4.  充分发展的流：速度剖面不依赖于轴向坐标 $z$，因此 $\\frac{\\partial v_z}{\\partial z} = 0$。这意味着 $v_z$ 仅是 $r$ 的函数，即 $v_z(r)$。\n\n在这些条件下，不可压缩流体的连续性方程 $\\nabla \\cdot \\mathbf{v} = 0$ 得以简化。在柱坐标系中：\n$$ \\frac{1}{r}\\frac{\\partial(r v_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial v_\\theta}{\\partial \\theta} + \\frac{\\partial v_z}{\\partial z} = 0 $$\n由于 $v_r=0$，$v_\\theta=0$ 且 $\\frac{\\partial v_z}{\\partial z} = 0$，连续性方程恒成立。\n\n接下来，我们简化 Navier-Stokes 动量方程。由于 $v_z$ 不是 $z$ 的函数，物质导数项 $(\\mathbf{v} \\cdot \\nabla)\\mathbf{v}$ 变为零。方程简化为：\n$$ \\mathbf{0} = -\\nabla P + \\mu \\nabla^2 \\mathbf{v} $$\n我们按分量分析此矢量方程。\n$r$ 分量为：\n$$ 0 = -\\frac{\\partial P}{\\partial r} $$\n这表明压力 $P$ 不是径向坐标 $r$ 的函数。\n$\\theta$ 分量是平凡的。\n$z$ 分量为：\n$$ 0 = -\\frac{\\partial P}{\\partial z} + \\mu \\left( \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial v_z}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2 v_z}{\\partial \\theta^2} + \\frac{\\partial^2 v_z}{\\partial z^2} \\right) $$\n已知 $v_z = v_z(r)$，因此对 $\\theta$ 和 $z$ 的导数为零。由于我们已确定 $P$ 与 $r$ 无关，并且问题设置因轴对称性而意味着 $P$ 在 $\\theta$ 方向上是均匀的，因此 $P$ 只能是 $z$ 的函数，即 $P(z)$。方程变为：\n$$ \\frac{dP}{dz} = \\mu \\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{d v_z}{dr}\\right) $$\n方程左边只是 $z$ 的函数，而右边只是 $r$ 的函数。这只有在两边都等于一个常数时才可能成立。设此常数为 $-G$，它代表驱动流动的恒定负压梯度。\n$$ \\frac{dP}{dz} = -G $$\n将此式对压力从 $z=0$ 积分到 $z=L$，得到 $P(L) - P(0) = -GL$。压降为 $\\Delta P = P(0) - P(L) = GL$。\n\n现在我们求解速度剖面 $v_z(r)$：\n$$ \\mu \\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{d v_z}{dr}\\right) = -G $$\n$$ \\frac{d}{dr}\\left(r \\frac{d v_z}{dr}\\right) = -\\frac{G}{\\mu} r $$\n对 $r$ 积分：\n$$ r \\frac{d v_z}{dr} = -\\frac{G}{2\\mu} r^2 + C_1 $$\n$$ \\frac{d v_z}{dr} = -\\frac{G}{2\\mu} r + \\frac{C_1}{r} $$\n再次积分：\n$$ v_z(r) = -\\frac{G}{4\\mu} r^2 + C_1 \\ln(r) + C_2 $$\n我们应用边界条件。首先，中心线（$r=0$）处的速度必须是有限的，这要求 $C_1=0$。其次，辐管壁（$r=R$，其中 $R$ 是内半径）处的无滑移条件规定 $v_z(R)=0$：\n$$ 0 = -\\frac{G}{4\\mu} R^2 + C_2 \\implies C_2 = \\frac{GR^2}{4\\mu} $$\n将常数代回，得到泊肃叶流特有的抛物线速度剖面：\n$$ v_z(r) = \\frac{G}{4\\mu} (R^2 - r^2) $$\n体积流率 $Q$ 通过将速度剖面在辐管的横截面积 $A$ 上积分得到：\n$$ Q = \\int_A v_z(r) dA = \\int_0^R v_z(r) (2\\pi r dr) = \\int_0^R \\frac{G}{4\\mu} (R^2 - r^2) (2\\pi r dr) $$\n$$ Q = \\frac{\\pi G}{2\\mu} \\int_0^R (R^2 r - r^3) dr = \\frac{\\pi G}{2\\mu} \\left[ \\frac{R^2 r^2}{2} - \\frac{r^4}{4} \\right]_0^R = \\frac{\\pi G}{2\\mu} \\left( \\frac{R^4}{2} - \\frac{R^4}{4} \\right) = \\frac{\\pi G R^4}{8\\mu} $$\n这就是哈根-泊肃叶方程。我们现在用 $Q$ 来表示压降 $\\Delta P$。首先，求解压力梯度常数 $G$：\n$$ G = \\frac{8\\mu Q}{\\pi R^4} $$\n压降为 $\\Delta P = GL$：\n$$ \\Delta P = \\frac{8\\mu L Q}{\\pi R^4} $$\n问题提供的是横截面积 $A$，而不是半径 $R$。我们必须用 $A$ 来表示这个关系。对于圆形横截面，有 $A = \\pi R^2$，这意味着 $R^2 = A/\\pi$ 且 $R^4 = (A/\\pi)^2 = A^2/\\pi^2$。将此代入 $\\Delta P$ 的方程中：\n$$ \\Delta P = \\frac{8\\mu L Q}{\\pi (A^2 / \\pi^2)} = \\frac{8\\pi\\mu L Q}{A^2} $$\n这就是压降对给定参数的函数依赖关系。问题指出，对于所有五个物种，$\\mu$、$L$ 和 $Q$ 都是相同的。因此，压降 $\\Delta P$ 与横截面积的平方成反比：\n$$ \\Delta P \\propto \\frac{1}{A^2} $$\n我们需要计算最大压降与最小压降之比 $\\rho$。最大压降 $\\Delta P_{\\text{max}}$ 将出现在具有最小面积 $A_{\\text{min}}$ 的物种中。最小压降 $\\Delta P_{\\text{min}}$ 将出现在具有最大面积 $A_{\\text{max}}$ 的物种中。\n$$ \\rho = \\frac{\\Delta P_{\\text{max}}}{\\Delta P_{\\text{min}}} = \\frac{8\\pi\\mu L Q/A_{\\text{min}}^2}{8\\pi\\mu L Q/A_{\\text{max}}^2} = \\frac{A_{\\text{max}}^2}{A_{\\text{min}}^2} = \\left(\\frac{A_{\\text{max}}}{A_{\\text{min}}}\\right)^2 $$\n根据所提供的数据：\n$A_{\\text{max}} = A_{\\mathrm{Hol}} = 0.120\\,\\text{mm}^{2}$\n$A_{\\text{min}} = A_{\\mathrm{Oph}} = 0.035\\,\\text{mm}^{2}$\n因此，该比率为：\n$$ \\rho = \\left(\\frac{0.120}{0.035}\\right)^2 = \\left(\\frac{120}{35}\\right)^2 = \\left(\\frac{24}{7}\\right)^2 $$\n$$ \\rho = \\frac{576}{49} \\approx 11.755102... $$\n根据要求四舍五入到三位有效数字：\n$$ \\rho \\approx 11.8 $$\n这个比率量化了在给定流率下，不同纲棘皮动物之间水力阻力的显著差异，这是它们辐管形态不同的直接结果。", "answer": "$$\n\\boxed{11.8}\n$$", "id": "2567825"}, {"introduction": "我们的最后一个练习将分析从单个组件提升到系统层面，将水管系统视为一个集成的液压网络。你将对部分系统进行建模，以研究当像阀门这样的单个组件发生故障时，系统如何维持其功能。这项计算练习引入了强大的“液-电类比”方法，并量化了系统的稳健性，从而让你深入了解生物系统的鲁棒性设计原理 [@problem_id:2567858]。", "problem": "您的任务是形式化并编程一个基于流体动力学的棘皮动物水管系统 (WVS) 网络模型，该模型能够捕捉在侧阀失效情况下管足的稳态压力分布，然后使用明确定义的恢复力指标来量化其鲁棒性。该模型必须从层流流体动力学和质量守恒的第一性原理推导得出，并且程序必须为提供的测试套件计算数值答案。\n\n基于基本定律的建模假设：\n- 使用哈根-泊肃叶线性本构关系作为液压阻力定律：对于任意两个连接的节点 $i$ 和 $j$，稳态体积流量为 $Q_{ij} = (P_i - P_j)/R_{ij}$，其中 $P_i$ 和 $P_j$ 是节点压力， $R_{ij}$ 是液压阻力。这是欧姆定律的液压类比。\n- 在每个未知压力节点上强制执行质量守恒（基尔霍夫电流定律的液压类比）：离开该节点的流量代数和为 $0$。\n- 将筛板-石管组合体视为一个理想压力源，其相对于压力为 $0$ 的外部水体具有固定压力 $P_s$ ，并通过一个源阻力 $R_m$ 连接到环管/辐管的近端。\n- 将辐管建模为一个由 $N$ 个节点组成的线性链，索引为 $r_0,\\dots,r_{N-1}$，其中对于 $k \\in \\{0,\\dots,N-2\\}$，$r_k$ 和 $r_{k+1}$ 之间存在最近邻阻力 $R_r$。\n- 对于每个 $k \\in \\{0,\\dots,N-1\\}$，一个管足节点 $t_k$ 通过一个侧阀连接到相应的辐管节点 $r_k$。当侧阀打开时，其阻力为 $R_v$；当失效（关闭）时，$r_k$ 和 $t_k$ 之间没有连接。每个管足节点 $t_k$ 始终通过一个负载阻力 $R_{tf}$ 连接到外部水体（压力为 $0$），该阻力在稳态下捕捉泄漏/外流和有效顺应性。\n\n未知量与方程：\n- 未知压力是所有 $2N$ 个节点压力，按顺序排列为 $\\mathbf{p} = [P_{r_0},\\dots,P_{r_{N-1}},P_{t_0},\\dots,P_{t_{N-1}}]^\\top$。\n- 固定压力节点是压力为 $P_s$ 的源和压力为 $0$ 的水体（接地）。源仅通过 $R_m$ 连接到 $r_0$；接地通过 $R_{tf}$ 连接到每个 $t_k$。\n- 对每个未知节点，强制执行节点平衡：$\\sum_{j} (P_i - P_j)/R_{ij} = 0$，其中求和遍及所有直接连接的邻居 $j$（包括固定压力邻居）。将其组装成一个线性系统 $G \\mathbf{p} = \\mathbf{b}$，其中 $G$ 是对称导纳矩阵，其条目为 $G_{ii} = \\sum_{j} 1/R_{ij}$ 和 $G_{ij} = -1/R_{ij}$（对于每对未知-未知邻居）。来自固定压力邻居的贡献作为 $(P_{\\text{fixed}})/R_{i,\\text{fixed}}$ 添加到右侧项 $\\mathbf{b}$ 中。\n\n阀门失效与开关逻辑：\n- 设失效侧阀的集合由索引 $\\mathcal{F} \\subseteq \\{0,\\dots,N-1\\}$ 给出。对于 $k \\in \\mathcal{F}$，省略 $r_k$ 和 $t_k$ 之间的连接。对于 $k \\notin \\mathcal{F}$，包含阻力为 $R_v$ 的连接。\n\n从解中计算的鲁棒性指标：\n- 设 $\\mathcal{O} = \\{k \\in \\{0,\\dots,N-1\\} : k \\notin \\mathcal{F}\\}$ 为开启的管足集合。设 $\\{P_{t_k} : k \\in \\mathcal{O}\\}$ 是通过求解 $G \\mathbf{p} = \\mathbf{b}$ 得到的开启管足处的压力。\n- 定义三个无量纲鲁棒性指标：\n  1. 高于阈值的分数：$f = \\frac{1}{|\\mathcal{O}|} \\sum_{k \\in \\mathcal{O}} \\mathbf{1}\\{P_{t_k} \\ge P_{\\text{thr}}\\}$。如果 $|\\mathcal{O}| = 0$，定义 $f = 0$。\n  2. 开启管足间的变异系数：$\\mathrm{CV} = \\sigma/\\mu$，其中 $\\mu$ 和 $\\sigma$ 分别是 $\\{P_{t_k} : k \\in \\mathcal{O}\\}$ 的均值和标准差。按惯例，如果 $|\\mathcal{O}| \\le 1$，定义 $\\mathrm{CV} = 0$。如果 $\\mu = 0$，定义 $\\mathrm{CV} = 0$。\n  3. 相对于相同参数下无失效基线的效率：$e = \\mu/\\mu_0$，其中 $\\mu_0$ 是在 $\\mathcal{F} = \\varnothing$（所有阀门开启）时，使用相同的 $(N,R_m,R_r,R_v,R_{tf},P_s)$ 计算得到的平均管足压力。如果 $|\\mathcal{O}| = 0$ 或 $\\mu_0 = 0$，定义 $e = 0$。\n- 所有三个指标都是无量纲的；输出中不需要物理单位。\n\n您的程序必须：\n- 根据上述规则为每个测试用例构建并求解线性系统 $G \\mathbf{p} = \\mathbf{b}$。\n- 对每个测试用例，无论是否明确提供了基线测试用例，都使用相同的参数（所有阀门开启，$\\mathcal{F} = \\varnothing$）在内部计算相应的无失效基线 $\\mu_0$。\n- 为每个测试用例计算如上定义的三元组 $(f,\\mathrm{CV},e)$。\n- 生成一行输出，包含所有结果，这些结果聚合成一个扁平的、逗号分隔的列表，并用方括号括起来，按测试用例排序，每个测试用例内按 $(f,\\mathrm{CV},e)$ 排序。为保证数值稳定性和可比性，在输出字符串中，每个浮点数应四舍五入到小数点后恰好 $6$ 位。例如，输出必须看起来像 $[f_1,\\mathrm{CV}_1,e_1,f_2,\\mathrm{CV}_2,e_2,\\dots]$。\n\n测试套件：\n- 除非另有说明，通用参数为：$N = 5$，$P_s = 3000$ (帕斯卡)，$P_{\\text{thr}} = 1000$ (帕斯卡)，$R_m = 1.0 \\times 10^8$ (帕斯卡·秒/立方米)，$R_r = 5.0 \\times 10^7$ (帕斯卡·秒/立方米)，$R_v = 5.0 \\times 10^7$ (帕斯卡·秒/立方米)，$R_{tf} = 1.0 \\times 10^8$ (帕斯卡·秒/立方米)。\n- 五个测试用例，每个都指定为一个失效索引集 $\\mathcal{F}$（从零开始的索引）以及适用的参数覆盖：\n  1. 用例 A（基线行为）：$\\mathcal{F} = \\varnothing$。\n  2. 用例 B（单个失效）：$\\mathcal{F} = \\{2\\}$。\n  3. 用例 C（交替失效）：$\\mathcal{F} = \\{0,2,4\\}$。\n  4. 用例 D（完全侧向失效）：$\\mathcal{F} = \\{0,1,2,3,4\\}$。\n  5. 用例 E（轴向阻力增加且部分失效）：参数覆盖 $R_r = 2.0 \\times 10^8$；$\\mathcal{F} = \\{1,3\\}$。\n- 不涉及角度单位。\n- 所有输出都是无量纲浮点数；输出中不需要物理单位。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序如下：用例 A $(f,\\mathrm{CV},e)$，用例 B $(f,\\mathrm{CV},e)$，用例 C $(f,\\mathrm{CV},e)$，用例 D $(f,\\mathrm{CV},e)$，用例 E $(f,\\mathrm{CV},e)$。每个浮点数必须打印到小数点后恰好 $6$ 位。", "solution": "该问题陈述是有效的。它提出了一项基于液压和电阻网络之间公认类比的、有科学依据的任务。该问题是良置的，为构建一个具有唯一且稳定解的线性方程组提供了一套清晰而完整的规则。所有参数、变量和指标都得到了客观且无歧义的定义。任务是为一个简化的棘皮动物水管系统模型进行稳态压力分布建模，并量化其对组件失效的鲁棒性。\n\n该方法的核心是将液压网络表示为一个线性方程组 $G \\mathbf{p} = \\mathbf{b}$，该方程组源于每个节点的质量守恒原理。这是节点分析法的直接应用，其中液压的哈根-泊肃叶定律 $Q_{ij} = (P_i - P_j)/R_{ij}$ 充当了类似于电路中欧姆定律的本构关系。在这里，$Q_{ij}$ 是从节点 $i$到节点 $j$ 的体积流率，$P_i$ 和 $P_j$ 是这些节点的液压压力，$R_{ij}$ 是连接它们的管道的液压阻力。\n\n该系统包含 $N$ 个辐管节点，表示为 $r_0, \\dots, r_{N-1}$，以及 $N$ 个相应的管足节点，表示为 $t_0, \\dots, t_{N-1}$。这 $2N$ 个节点的压力是未知数，我们将其排列成一个列向量 $\\mathbf{p} = [P_{r_0}, \\dots, P_{r_{N-1}}, P_{t_0}, \\dots, P_{t_{N-1}}]^\\top$。该系统包括两个固定压力的外部节点：压力为 $P_s$ 的源（筛板）和压力为 $0$ 的外部水体（接地）。\n\n在任何未知压力节点 $i$ 上的质量守恒要求离开该节点的流量总和为零：$\\sum_{j} Q_{ij} = 0$。将哈根-泊肃叶定律代入每个流量，我们得到 $\\sum_{j} (P_i - P_j)/R_{ij} = 0$。这可以重写为 $P_i \\sum_{j} (1/R_{ij}) - \\sum_{j} P_j/R_{ij} = 0$。项 $g_{ij} = 1/R_{ij}$ 是液导。\n\n这组 $2N$ 个方程被组装成矩阵形式 $G \\mathbf{p} = \\mathbf{b}$。导纳矩阵 $G$ 是一个 $2N \\times 2N$ 的对称矩阵，$\\mathbf{b}$ 是一个 $2N \\times 1$ 的源向量。\n- 导纳矩阵的对角线元素由 $G_{ii} = \\sum_{j} g_{ij}$ 给出，其中求和遍及节点 $i$ 的所有邻居 $j$（包括固定压力邻居）。\n- 如果节点 $i$ 和 $j$ 相连，则非对角线元素为 $G_{ij} = -g_{ij}$，否则为 $G_{ij} = 0$。\n- 源向量 $\\mathbf{b}$ 考虑了与固定压力源的连接。对于一个未知节点 $i$，其在源向量中的条目是 $b_i = \\sum_{j \\in \\text{fixed}} P_j g_{ij}$。\n\n我们模型中的具体连接决定了 $G$ 和 $\\mathbf{b}$ 的结构：\n1.  **源连接**：压力为 $P_s$ 的源通过阻力 $R_m$ 连接到节点 $r_0$。这为 $G_{0,0}$ 贡献了 $g_m = 1/R_m$，并为 $b_0$ 贡献了 $P_s g_m$。\n2.  **辐管**：对于 $k=0, \\dots, N-2$，节点 $r_k$ 和 $r_{k+1}$ 通过阻力 $R_r$ 连接。对于每个这样的连接，我们将 $g_r = 1/R_r$ 加到对角元素 $G_{k,k}$ 和 $G_{k+1,k+1}$ 上，并从非对角元素 $G_{k,k+1}$ 和 $G_{k+1,k}$ 中减去 $g_r$。\n3.  **侧阀**：节点 $r_k$ 通过阻力 $R_v$ 连接到 $t_k$，前提是阀门未失效（即 $k \\notin \\mathcal{F}$）。对于每个打开的阀门，我们使用导纳 $g_v = 1/R_v$ 相应地更新矩阵条目 $G_{k,k}$、$G_{N+k,N+k}$、$G_{k,N+k}$ 和 $G_{N+k,k}$。如果阀门失效，则省略此连接。\n4.  **管足到水体**：每个管足节点 $t_k$ 通过阻力 $R_{tf}$ 连接到外部水体（压力 $0$）。这为对角元素 $G_{N+k,N+k}$ 添加了一个导纳 $g_{tf} = 1/R_{tf}$。由于水体压力为 $0$，此连接对源向量 $\\mathbf{b}$ 没有贡献。\n\n一旦为给定的参数集和失效集 $\\mathcal{F}$ 构建了矩阵 $G$ 和向量 $\\mathbf{b}$，就求解线性系统 $G \\mathbf{p} = \\mathbf{b}$ 以获得压力向量 $\\mathbf{p}$。管足节点的压力 $\\{P_{t_k}\\}_{k=0}^{N-1}$ 从解向量 $\\mathbf{p}$ 中提取。\n\n根据这些压力，我们为开启的管足集合 $\\mathcal{O}$ 计算三个无量纲鲁棒性指标：\n-   **高于阈值的分数, $f$**：$f = \\frac{1}{|\\mathcal{O}|} \\sum_{k \\in \\mathcal{O}} \\mathbf{1}\\{P_{t_k} \\ge P_{\\text{thr}}\\}$。\n-   **变异系数, $\\mathrm{CV}$**：$\\mathrm{CV} = \\sigma/\\mu$，其中 $\\mu$ 和 $\\sigma$ 分别是压力 $\\{P_{t_k} : k \\in \\mathcal{O}\\}$ 的均值和总体标准差。\n-   **效率, $e$**：$e = \\mu/\\mu_0$，其中 $\\mu_0$ 是在无失效情况（$\\mathcal{F}=\\varnothing$）下，使用相同系统参数计算的平均管足压力。\n\n实现中严格遵循了为这些指标指定的边界情况（例如，当 $|\\mathcal{O}| \\le 1$ 或 $\\mu_0=0$ 时）。程序系统地处理每个测试用例，计算基线 $\\mu_0$，求解指定的失效场景，计算三元组 $(f, \\mathrm{CV}, e)$，并按要求格式化最终的聚合结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes robustness metrics for a model of the Echinoderm water vascular system.\n    \"\"\"\n    # Define common parameters and the test suite as specified in the problem.\n    common_params = {\n        'N': 5,\n        'Ps': 3000.0,\n        'P_thr': 1000.0,\n        'Rm': 1.0e8,\n        'Rr': 5.0e7,\n        'Rv': 5.0e7,\n        'Rtf': 1.0e8,\n    }\n\n    test_cases = [\n        {'name': 'Case A (baseline behavior)', 'F_failures': set()},\n        {'name': 'Case B (single failure)', 'F_failures': {2}},\n        {'name': 'Case C (alternating failures)', 'F_failures': {0, 2, 4}},\n        {'name': 'Case D (complete lateral failure)', 'F_failures': {0, 1, 2, 3, 4}},\n        {'name': 'Case E (increased axial resistance with partial failure)', \n         'F_failures': {1, 3}, \n         'overrides': {'Rr': 2.0e8}},\n    ]\n\n    def solve_pressure_network(params):\n        \"\"\"\n        Constructs and solves the linear system G*p = b for the node pressures.\n        \n        Args:\n            params (dict): A dictionary of system parameters including N, Ps, resistances,\n                           and the set of failed valves F_failures.\n\n        Returns:\n            numpy.ndarray: An array of pressures at the tube-foot nodes.\n        \"\"\"\n        N = params['N']\n        if N == 0:\n            return np.array([])\n            \n        Ps = params['Ps']\n        Rm, Rr, Rv, Rtf = params['Rm'], params['Rr'], params['Rv'], params['Rtf']\n        F_failures = params['F_failures']\n\n        num_nodes = 2 * N\n        G = np.zeros((num_nodes, num_nodes))\n        b = np.zeros(num_nodes)\n\n        g_m, g_r, g_v, g_tf = 1/Rm, 1/Rr, 1/Rv, 1/Rtf\n\n        # Source connection to radial node r_0 (index 0)\n        G[0, 0] += g_m\n        b[0] += Ps * g_m\n\n        # Radial canal connections (r_k to r_{k+1})\n        for k in range(N - 1):\n            idx1, idx2 = k, k + 1\n            G[idx1, idx1] += g_r\n            G[idx2, idx2] += g_r\n            G[idx1, idx2] -= g_r\n            G[idx2, idx1] -= g_r\n\n        # Lateral valve and tube foot connections\n        for k in range(N):\n            idx_r = k\n            idx_t = N + k\n\n            # Connection from r_k to t_k (if valve is open)\n            if k not in F_failures:\n                G[idx_r, idx_r] += g_v\n                G[idx_t, idx_t] += g_v\n                G[idx_r, idx_t] -= g_v\n                G[idx_t, idx_r] -= g_v\n\n            # Connection from t_k to ground (pressure 0)\n            G[idx_t, idx_t] += g_tf\n            # The b vector is not affected as ground pressure is 0.\n\n        try:\n            pressures = np.linalg.solve(G, b)\n        except np.linalg.LinAlgError:\n            # This case should not happen for a physically valid, connected network.\n            return np.full(N, np.nan) \n\n        return pressures[N:]  # Return only the tube-foot pressures\n\n    all_results = []\n    for case in test_cases:\n        # Set up parameters for the current test case, including overrides\n        current_params = common_params.copy()\n        if 'overrides' in case:\n            current_params.update(case['overrides'])\n        \n        N = current_params['N']\n        P_thr = current_params['P_thr']\n        F_failures = case['F_failures']\n\n        # 1. Compute baseline mu_0 for the current parameter set (no failures)\n        baseline_params = current_params.copy()\n        baseline_params['F_failures'] = set()\n        p_tf_baseline = solve_pressure_network(baseline_params)\n        \n        mu_0 = 0.0\n        if p_tf_baseline.size > 0:\n            mu_0 = np.mean(p_tf_baseline)\n\n        # 2. Compute pressures for the actual failure case\n        current_case_params = current_params.copy()\n        current_case_params['F_failures'] = F_failures\n        p_tf_current = solve_pressure_network(current_case_params)\n        \n        # 3. Calculate metrics based on the results\n        O_indices = [k for k in range(N) if k not in F_failures]\n        num_open = len(O_indices)\n\n        if num_open == 0:\n            f, cv, e = 0.0, 0.0, 0.0\n        else:\n            p_tf_open = p_tf_current[O_indices]\n            \n            # Metric f: Fraction above threshold\n            f = np.sum(p_tf_open >= P_thr) / num_open\n            \n            # Metric CV: Coefficient of variation\n            mu = np.mean(p_tf_open)\n            if num_open = 1 or mu == 0:\n                cv = 0.0\n            else:\n                sigma = np.std(p_tf_open, ddof=0)  # Population standard deviation\n                cv = sigma / mu\n            \n            # Metric e: Efficiency relative to baseline\n            if mu_0 == 0:\n                e = 0.0\n            else:\n                e = mu / mu_0\n\n        all_results.extend([f, cv, e])\n\n    # Format and print the final output in the required single-line format.\n    formatted_results = [f\"{x:.6f}\" for x in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2567858"}]}