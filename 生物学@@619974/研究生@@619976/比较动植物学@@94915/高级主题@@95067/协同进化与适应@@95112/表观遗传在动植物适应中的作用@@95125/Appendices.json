{"hands_on_practices": [{"introduction": "要理解表观遗传继承，一个核心问题是：在没有持续环境诱导或选择压力的情况下，一个表观遗传标记如何在代际间传递？这个过程很少是完美的。本练习旨在通过一个简洁的数学模型，帮助我们建立关于表观遗传标记动态变化的基础直觉。通过推导一个封闭形式的表达式，你将能够量化传递保真度（$f$）对标记在群体中频率的影响，从而掌握分析跨代表观遗传动态的理论基石。[@problem_id:2568111]", "problem": "在比较动物学和植物学中，许多适应性响应涉及表观遗传标记，例如胞嘧啶甲基化或组蛋白修饰，这些标记可以跨代遗传而不改变底层的脱氧核糖核酸（DNA）序列。考虑一个植物或动物物种的大型、充分混合的种群，其中一个初始诱导的二元表观遗传标记（每个个体存在或不存在）不受选择压力，并且在初始世代后没有新的环境诱导。假设是无性系或有效的单亲遗传，因此每个子代的表观遗传状态仅取决于其单个亲本的状态。设每代表观遗传传递的保真度为 $f \\in [0,1]$，这意味着有标记的亲本以概率 $f$ 将标记传递给子代，并以概率 $1 - f$ 在子代中将标记重置为无标记状态。在没有环境诱导的情况下，无标记的亲本不会在其子代中产生新的标记。设 $x_{0} \\in [0,1]$ 表示标记个体的初始比例，设 $x_{t}$ 表示 $t$ 代后标记个体的期望比例，其中 $t \\in \\mathbb{N}$。\n\n仅使用概率公理、全概率定律以及两状态表观遗传过程的马尔可夫性质，推导一个关于 $f$、$t$ 和 $x_{0}$ 的 $x_{t}$ 的闭式表达式。请将您的最终答案表示为单个解析表达式。无需进行数值计算或四舍五入。", "solution": "该问题要求为 $t$ 代后表观遗传标记个体的期望比例（记作 $x_t$）推导一个闭式表达式。此推导必须基于所述的第一性原理。\n\n让我们将此系统形式化。我们考虑一个个体表观遗传状态的两状态模型：标记（$M$）或无标记（$U$）。在第 $t$ 代，种群中标记个体的比例是 $x_t$。对于一个大型、充分混合的种群，我们可以将此比例等同于从第 $t$ 代随机选择一个个体被标记的概率。设 $S_t$ 为表示第 $t$ 代个体状态的随机变量。于是，我们有：\n$$ x_t = P(S_t = M) $$\n因此，无标记个体的比例是：\n$$ P(S_t = U) = 1 - x_t $$\n初始条件给定为 $x_0$，即第 $t=0$ 代时标记个体的比例。\n\n问题陈述该过程是马尔可夫的，意味着第 $t+1$ 代子代的状态仅取决于其在第 $t$ 代的亲本的状态。传递概率定义如下：\n1. 一个有标记的亲本以保真度 $f$ 传递标记。这是在亲本有标记的条件下，子代也有标记的条件概率：\n$$ P(S_{t+1} = M | S_t = M) = f $$\n2. 因此，一个有标记的亲本以概率 $1-f$ 产生一个无标记的子代（标记被重置）：\n$$ P(S_{t+1} = U | S_t = M) = 1 - f $$\n3. 无标记的亲本不产生新的标记。这意味着一个无标记的亲本产生一个有标记的子代的概率为零：\n$$ P(S_{t+1} = M | S_t = U) = 0 $$\n4. 因此，一个无标记的亲本必须以概率 $1$ 产生一个无标记的子代：\n$$ P(S_{t+1} = U | S_t = U) = 1 - P(S_{t+1} = M | S_t = U) = 1 - 0 = 1 $$\n\n为了求出下一代中标记个体的比例 $x_{t+1}$，我们应用全概率定律。我们通过对第 $t$ 代亲本的可能状态进行条件化，来求出事件 $\\{S_{t+1} = M\\}$ 的概率。事件集合 $\\\\{S_t = M\\\\}$ 和 $\\\\{S_t = U\\\\}$ 构成了亲本状态样本空间的一个划分。\n根据全概率定律：\n$$ x_{t+1} = P(S_{t+1} = M) = P(S_{t+1} = M | S_t = M) P(S_t = M) + P(S_{t+1} = M | S_t = U) P(S_t = U) $$\n\n将上面定义的概率代入此方程：\n$$ x_{t+1} = (f)(x_t) + (0)(1 - x_t) $$\n\n这可以简化为以下线性齐次递推关系：\n$$ x_{t+1} = f x_t $$\n\n这个关系描述了标记个体比例随世代的演化。它是一个简单的几何级数。我们可以从 $t=0$ 时的初始条件 $x_0$ 出发，通过迭代来求解此关系。\n\n对于 $t=1$：\n$$ x_1 = f x_0 $$\n对于 $t=2$：\n$$ x_2 = f x_1 = f (f x_0) = f^2 x_0 $$\n对于 $t=3$：\n$$ x_3 = f x_2 = f (f^2 x_0) = f^3 x_0 $$\n\n通过观察，我们提出对于任何世代 $t \\in \\mathbb{N}$ （其中 $\\mathbb{N} = \\{0, 1, 2, ...\\}$ 包括了 $t=0$ 时的初始状态）的通解是：\n$$ x_t = f^t x_0 $$\n\n这个闭式表达式可以用数学归纳法来正式证明。\n**基础情形：** 当 $t=0$ 时，该公式得出 $x_0 = f^0 x_0 = 1 \\cdot x_0 = x_0$，这与给定的初始条件一致。\n**归纳步骤：** 假设该公式对于某个整数 $k \\ge 0$ 成立，即 $x_k = f^k x_0$。我们必须证明它对于 $k+1$ 也成立。根据递推关系，我们有 $x_{k+1} = f x_k$。代入 $x_k$ 的归纳假设，我们得到：\n$$ x_{k+1} = f (f^k x_0) = f^{k+1} x_0 $$\n这就是 $t=k+1$ 时所需的公式。归纳完成。\n\n推导出的表达式 $x_t = x_0 f^t$ 是 $t$ 代后标记个体比例的闭式解，用初始比例 $x_0$、传递保真度 $f$ 和世代数 $t$ 表示。此结果表明，在没有选择或新诱导的情况下，表观遗传标记的频率随世代呈几何级数衰减，其衰减率由其传递的保真度决定。如果保真度是完美的（$f=1$），标记将维持在其初始频率。如果保真度为零（$f=0$），标记将在单一代内被消除。对于任何中间保真度 $f \\in (0,1)$，当 $t \\to \\infty$ 时，标记个体的比例趋近于零。", "answer": "$$\n\\boxed{x_0 f^t}\n$$", "id": "2568111"}, {"introduction": "从理论模型转向真实的跨代实验，我们立即会面临一个巨大的挑战：技术变异，即所谓的“批次效应”。如果实验设计不当，这些由不同实验日期、试剂批次或测序泳道引入的系统性偏差，可能会与我们真正关心的生物学信号（如代际差异）完全混淆，导致错误的结论。本练习将引导你思考如何运用实验设计的黄金法则——随机化、区组化和重复——来构建一个稳健的多年生、多物种研究方案。通过精心设计，我们可以从统计上将技术噪音与生物信号分离开来，确保我们对跨代表观遗传的估计是可靠且无偏的。[@problem_id:2568221]", "problem": "一项比较研究旨在量化一种自花授粉的一年生植物和一种胎生鱼类在匹配的环境梯度下的跨代表观遗传。对于每个分类单元，从相同的创始群体中繁殖三代（$G_0$、$G_1$、$G_2$），并将其暴露于匹配的环境中。在成年期，对叶片和鳃组织应用全基因组亚硫酸氢盐测序（WGBS）。由于资源限制，文库制备在 $P$ 个制备日内完成，测序在 $R$ 个不同的流通池上的 $L$ 个泳道中进行，并且试剂盒批次随流通池的更换而改变。研究人员将使用以下形式的线性混合效应模型分析每个位点的甲基化值\n$$\ny_{i\\ell} \\;=\\; \\mu \\;+\\; \\alpha_{\\text{taxon}[i]} \\;+\\; \\gamma_{\\text{generation}[i]} \\;+\\; \\tau_{\\text{tissue}[i]} \\;+\\; \\theta_{\\text{environment}[i]} \\;+\\; f_{\\text{family}[i]} \\;+\\; b_{\\text{prep}[i]} \\;+\\; c_{\\text{lane}[i]} \\;+\\; d_{\\text{flowcell}[i]} \\;+\\; \\varepsilon_{i\\ell},\n$$\n其中 $y_{i\\ell}$ 是个体 $i$ 在位点 $\\ell$ 的转换后甲基化水平，$\\mu$ 是截距，$\\alpha_{\\text{taxon}}$、$\\gamma_{\\text{generation}}$、$\\tau_{\\text{tissue}}$和$\\theta_{\\text{environment}}$是固定效应，$f_{\\text{family}}$、$b_{\\text{prep}}$、$c_{\\text{lane}}$、$d_{\\text{flowcell}}$是代表生物谱系和技术因素的随机效应。研究人员希望确保 (i) $\\gamma_{\\text{generation}}$ 的估计值不与技术因素混淆，(ii) 方差组分 $\\operatorname{Var}(b_{\\text{prep}})$、$\\operatorname{Var}(c_{\\text{lane}})$ 和 $\\operatorname{Var}(d_{\\text{flowcell}})$ 是可识别和可估计的，以及 (iii) 任何批次校正程序都不会去除真实的生物学信号。\n\n从实验设计的基本原则（随机化、重复和区组化）、分子生物学的中心法则以及线性模型的标准属性（可识别性要求设计矩阵各列之间非共线性以及随机效应关联矩阵的连通性）的角度来看，在保留跨代信号的同时，以下哪种综合策略能最好地控制这个多代、多分类单元的表观基因组研究中的批次效应？\n\nA. 实施平衡的随机区组设计，遍及所有制备日、泳道和流通池，使得每个层级都包含近乎等量的分类单元、世代、组织和环境样本；在区组内使用带条形码的接头随机化文库制备顺序，并对文库进行多重化，以便每个泳道接收来自所有生物学组的分层随机子集。为每个个体包含双重技术重复：一个独立的文库复制和一个独立的测序泳道复制；在每个文库中包含外源参照控制和亚硫酸氢盐转化控制。预留一组固定的“桥接”等分样本，在所有流通池上重复测序以连接不同批次。拟合一个混合效应模型，其中包含试剂盒批次内的制备日和流通池内的泳道的嵌套随机效应，如果批次数量少，则将试剂盒批次作为固定协变量，并且仅对控制特征或技术重复的对比应用经验贝叶斯批次校正，而生物学对比（$\\gamma_{\\text{generation}}$）则由随机化设计来锚定。\n\nB. 为避免代际间的交叉污染，在不同的制备日和不同的泳道上制备和测序每一代，避免跨代进行多重化；通过省略技术重复来优先考虑通量，并依赖测序后的主成分分析来回归去除作为批次效应的顶部主成分。仅当批次效应在统计上显著时，才将其视为协变量。\n\nC. 将每一代中的所有个体混合到每个分类单元和组织的单一复合文库中，以消除代内变异；在专用的泳道上对每个混合文库进行测序。仅在代际间使用生物学重复，跳过外源参照以避免污染，并且即使每个批次仅包含一个世代，也将其作为随机效应来估计批次效应。\n\nD. 在每一代内随机化文库制备顺序，但将整个测序泳道专用于单一世代，以最大限度地减少索引串扰。仅对低起始量的样本进行测序技术重复。在不包含批次或生物学协变量的情况下，对所有胞嘧啶进行全局分位数归一化来标准化所有样本，然后拟合一个不含批次随机效应的固定效应模型，以避免过度参数化。\n\n选择唯一最佳选项。", "solution": "该问题要求评估一个复杂、多因素的表观遗传学研究的实验设计策略。所选策略的有效性必须根据实验设计原则（随机化、重复、区组化）、分子生物学以及线性混合效应模型的特性来判断。\n\n**问题验证**\n\n首先，有必要对问题陈述进行批判性审查。\n\n**已知条件：**\n-   **研究系统：** 一种自花授粉的一年生植物和一种胎生鱼类。\n-   **生物学因素：** 分类单元（$\\alpha_{\\text{taxon}}$）、世代（$G_0, G_1, G_2$; $\\gamma_{\\text{generation}}$）、组织（叶/鳃; $\\tau_{\\text{tissue}}$）、环境（$\\theta_{\\text{environment}}$）以及家系谱系（$f_{\\text{family}}$）。\n-   **技术因素：** $P$ 个文库制备日（$b_{\\text{prep}}$）、$L$ 个测序泳道（$c_{\\text{lane}}$）、$R$ 个流通池（$d_{\\text{flowcell}}$）以及随流通池更换而改变的试剂盒批次。\n-   **方法学：** 全基因组亚硫酸氢盐测序（WGBS）。\n-   **统计模型：** 一个指定的线性混合效应模型：$y_{i\\ell} = \\mu + \\alpha_{\\text{taxon}[i]} + \\gamma_{\\text{generation}[i]} + \\tau_{\\text{tissue}[i]} + \\theta_{\\text{environment}[i]} + f_{\\text{family}[i]} + b_{\\text{prep}[i]} + c_{\\text{lane}[i]} + d_{\\text{flowcell}[i]} + \\varepsilon_{i\\ell}$。\n-   **明确目标：** (i) 避免 $\\gamma_{\\text{generation}}$ 的估计值与技术因素发生混淆。(ii) 确保技术方差组分（$\\operatorname{Var}(b_{\\text{prep}})$、$\\operatorname{Var}(c_{\\text{lane}})$、$\\operatorname{Var}(d_{\\text{flowcell}})$）是可识别和可估计的。(iii) 确保批次校正不会去除生物学信号。\n\n**验证结论：**\n问题陈述是**有效的**。它描述了现代基因组学中一个现实而复杂的场景。生物学和技术因素都得到了清晰的定义。目标是具体的、可衡量的，并且与健全的科学实践相关。所提供的统计模型是处理此类数据的恰当工具。该问题陈述清晰，具有科学依据，并且需要严格应用统计学和实验设计原则来解决。它没有违反任何无效标准。进入求解阶段。\n\n**从第一性原理推导**\n\n核心挑战是将关注的固定效应 $\\gamma_{\\text{generation}}$ 的估计值与各种随机技术效应（$b_{\\text{prep}}, c_{\\text{lane}}, d_{\\text{flowcell}}$）的影响分离开来。\n\n1.  **混淆与可识别性：** 在线性模型中，如果两个效应的设计矩阵列是线性相关的（共线性），它们的影响就无法被唯一地估计。最极端的情况是完全混淆，例如，所有 $G_0$ 代的样本都在制备日1处理，所有 $G_1$ 代在第2天处理，所有 $G_2$ 代在第3天处理。在这种情况下，任何观察到的差异都可能归因于世代或制备日。从数学上讲，无法区分 $\\gamma_{\\text{generation}}$ 和 $b_{\\text{prep}}$。为了满足目标 (i)，实验设计*必须*打破这种共线性。实现这一目标的主要工具是**平衡区组设计**内的**随机化**。这意味着要确保来自所有世代（$G_0, G_1, G_2$）的样本在技术因素（制备日、泳道、流通池）的所有或多个水平上都有代表。\n\n2.  **方差组分的可估计性：** 为了估计一个随机效应的方差组分，例如 $\\operatorname{Var}(d_{\\text{flowcell}})$，设计必须有多个与该因素不同水平相关联的数据点，并且是“连通的”。连通性意味着设计中存在可以比较所有水平的路径。例如，如果流通池1和流通池2没有相同类型的样本，或者它们之间没有共享的技术重复，那么它们的系统性差异（批次效应）就难以稳健地估计。使用**“桥接”样本**——即在多个流通池上测序的同一样本或等分样本——可以创建直接的联系，从而有力地锚定流通池效应的估计，满足目标 (ii)。技术重复（对同一文库重新测序或对同一DNA重新制备文库）也服务于此目的，因为它允许直接量化技术噪音。\n\n3.  **生物学信号的保留：** 批次校正方法是必要的，但也可能存在风险。激进的、“盲目”的方法，如全局分位数归一化或回归去除主成分，如果生物学变异与批次协变，就可能会去除真实的生物学变异，从而违反目标 (iii)。一个更优的策略是明确地对批次效应进行建模，正如问题中提出的线性混合效应模型。随机化设计确保了生物学效应在设计上与批次效应是正交的，从而允许模型正确地划分方差。此外，使用**阴性对照**（例如，外源参照）或技术重复来估计批次校正的参数，确保校正是基于纯粹的技术变异，而不是技术和生物学变异的混合体。\n\n因此，一个最优的策略必须将平衡的随机区组设计与技术重复、对照的使用以及基于模型的分析相结合。\n\n**选项评估**\n\n**A. 实施平衡的随机区组设计...**\n这个选项提出了一个堪称教科书完美的实验设计。\n-   **平衡的随机区组设计**是解决混淆问题的正确答案（目标 i）。将所有生物学组（分类单元、世代等）分布在各个技术批次（制备日、泳道、流通池）中，确保了正交性，并允许独立估计各种效应。\n-   **双重技术重复**和**桥接等分样本**直接解决了对技术方差组分进行稳健估计的需求，并确保设计在主要批次因素（如流通池和试剂盒批次）之间是连通的（目标 ii）。\n-   包含**外源参照控制**是监测和归一化技术效率（例如，亚硫酸氢盐转化效率）的标准最佳实践。\n-   所提议的分析方法复杂且可靠。将批次因素建模为**嵌套随机效应**是恰当的。基于**控制特征或技术重复**来应用校正是一种先进的方法，可以避免去除生物学信号（目标 iii）。\n该策略是全面的，并正确应用了所有相关原则。\n**结论：正确。**\n\n**B. 为避免代际间的交叉污染，在不同的制备日和不同的泳道上制备和测序每一代...**\n这个策略存在根本性缺陷，因为它造成了完全的混淆。\n-   在不同的泳道上测序每一代，并在不同的制备日制备它们，使得`generation`的效应与`lane`和`prep day`的效应完全共线。这使得实现目标 (i) 成为不可能。\n-   省略技术重复妨碍了目标 (ii) 的实现。\n-   依赖于事后的**基于主成分分析的回归**进行批次校正是众所周知的危险做法，因为主成分通常捕获的是生物学和技术变异的混合体。去除它们可能会抹去感兴趣的信号，违反了目标 (iii)。\n**结论：不正确。**\n\n**C. 将每一代中的所有个体混合到每个分类单元和组织的单一复合文库中...**\n这个策略包含了多个严重错误。\n-   **混合**样本（Pool-seq）导致所有关于个体水平变异信息的丢失。这使得所提议的基于个体的线性模型无效，并且无法估计家系效应（$f_{\\text{family}}$）或任何组内方差。\n-   将每个混合文库放在**专用的泳道**上，再次在`generation`和`lane`之间造成了完全的混淆，违反了目标 (i)。\n-   “即使每个批次仅包含一个世代，也可以将批次作为随机效应来估计”这一说法在统计学上是错误的，因为存在混淆；该模型将不可识别。这违反了目标 (ii)。\n-   **跳过外源参照控制**消除了一个用于技术性能的至关重要的先验控制。\n**结论：不正确。**\n\n**D. 在每一代内随机化文库制备顺序，但将整个测序泳道专用于单一世代...**\n这个策略同样存在严重缺陷。\n-   关键缺陷在于将**整个测序泳道专用于单一世代**。这在固定效应 $\\gamma_{\\text{generation}}$和随机效应$c_{\\text{lane}}$之间造成了完全的混淆。这致命地违反了目标 (i)。声称的减少索引串扰的好处远远不及此设计失误的危害；此外，使用独特的双重索引可以更好地管理串扰。\n-   **全局分位数归一化**是一种极其激进的技术，它强行使所有样本的分布完全相同。这很容易去除代与代之间真实的全局生物学差异，直接违反了目标 (iii)。\n-   **拟合一个不含批次随机效应的固定效应模型**在统计上是不恰当的。它忽略了数据中已知的非独立性来源，会导致不正确的推断。随机效应是模拟众多批次水平所贡献的方差的正确方法。\n**结论：不正确。**\n\n总而言之，只有选项A提供了一个在统计学上稳健的设计，能够有力地解决问题陈述中概述的挑战。其他选项引入了致命的混淆和/或依赖于可能会破坏感兴趣的生物学信号的分析程序。", "answer": "$$\\boxed{A}$$", "id": "2568221"}, {"introduction": "一个成功的实验设计最终会产出海量的原始测序数据，而将这些数据转化为有意义的生物学见解，则需要一个严谨、可重复的生物信息学分析流程。本练习提供了一个从原始读段（raw reads）到差异甲基化区域（DMRs）的完整路线图，涵盖了全基因组亚硫酸氢盐测序（WGBS）数据分析的每一个关键节点。你将思考如何处理从质量控制、特异性比对，到偏差校正和高级统计建模（如使用beta-泊松模型处理过离散问题）等一系列挑战。掌握这一流程是表观基因组学研究的核心技能，它确保了你的分析不仅在统计上是健全的，而且是完全可重复的，这是现代科学研究的基石。[@problem_id:2568213]", "problem": "一个研究团队旨在比较一种多年生植物和一种脊椎动物在共同花园中饲养两代，并暴露于相同环境胁迫下的适应性表观遗传。对于每个物种和每一代，他们都有 $n=3$ 个全基因组亚硫酸氢盐测序 (WGBS) 组织样本的独立生物学重复。他们的目标是鉴定出在两代之间持续存在、并且在两个物种的功能类似组织中共享的差异甲基化区域 (DMRs)。他们需要一个可复现、偏倚受控的流程，从原始读段到统计上稳健的 DMR 鉴定，该流程需同时适用于植物和动物的甲基化组。\n\n仅使用以下基本事实作为您推理的基础：亚硫酸氢盐将未甲基化的胞嘧啶转化为尿嘧啶，在聚合酶链式反应 (PCR) 和测序后被读取为胸腺嘧啶，而 5-甲基胞嘧啶则能抵抗这种转化；因此，经过亚硫酸氢盐处理的读段显示出胞嘧啶到胸腺嘧啶的不对称性，必须由亚硫酸氢盐感知型比对 (bisulfite-aware alignment) 来处理；一个位点的甲基化水平表现为总覆盖读段中甲基化读段的计数，在理想化的独立试验下遵循二项分布模型，但实际表现出生物学和技术上的过度离散，通常用贝塔-二项分布建模；相邻胞嘧啶的甲基化水平倾向于在空间上相关；植物在 CHG 和 CHH 背景下有大量的非 CpG 甲基化，而动物主要在 CpG 背景下甲基化，在特定细胞类型中存在罕见的非 CpG 甲基化。\n\n哪个选项是用于与表观遗传相关的跨物种 DMR 发现的最合适的、可复现的流程，能够最小化偏倚并最大化统计有效性？\n\nA. 建立一个脚本化工作流程（例如，在 Snakemake 或 Nextflow 中），使用软件容器化和固定的随机种子以保证可复现性。通过接头和质量修剪进行质量控制 (QC)，然后生成 FastQC 报告和过表达序列检查。使用未甲基化的 spike-in（例如，λ 噬菌体）和适合物种的内部对照来评估亚硫酸氢盐转化效率；生成 M-bias 图并修剪有偏倚的读段末端。使用亚硫酸氢盐感知型比对器（例如，Bismark 或 bwa-meth）与合适的参考基因组进行比对：对于物种内存在多态性的样本，使用单核苷酸多态性 (SNP) 屏蔽的或样本个性化的参考基因组，或者在有匹配的重测序数据时，屏蔽检测到的胞嘧啶到胸腺嘧啶的多态性。在甲基化提取之前，使用基于位置的重复标记（如果使用了唯一分子标识符 (UMI)，则使用 UMI 感知型去重）去除 PCR 重复。为所有胞嘧啶背景提取甲基化信息：植物中的 CpG、CHG 和 CHH；动物中的 CpG（如果生物学上预期存在，则可选地包括非 CpG）；使用覆盖度过滤器（例如，$n_{ij}\\geq 5$ 和去除极端异常值）计算每个位点的甲基化水平 $\\hat{p}_{ij}=m_{ij}/n_{ij}$。排除与已知或新发现的胞嘧啶到胸腺嘧啶多态性重叠的胞嘧啶，以避免遗传混淆。使用具有生物学意义的窗口或具有最小胞嘧啶数和区域长度限制的自适应聚类，将胞嘧啶聚合成候选区域。使用贝塔-二项回归测试 DMR，该模型能对重复样本方差和协变量（例如，代际、批次）进行建模，并对邻近胞嘧啶进行空间平滑；使用 Benjamini–Hochberg 程序在 $q\\leq 0.05$ 的水平上控制假发现率 (FDR)，并要求最小绝对甲基化差异（例如，$\\geq 0.2$）和最小区域大小。跨物种比较仅限于直系同源或同线性区域以及匹配的背景（例如，CpG-to-CpG），植物特有的分析额外报告 CHG 和 CHH。记录所有软件版本和参数。\n\nB. 修剪接头，然后使用标准的短读段比对器（例如，Bowtie$2$），不使用亚硫酸氢盐模式，将读段与参考基因组比对；通过计算胞嘧啶与胸腺嘧啶的数量来计算每个 CpG 的甲基化，不进行转化效率控制；在甲基化提取之后去除 PCR 重复；对每个 CpG 在所有重复中合并的数据使用 Fisher 精确检验来鉴定 DMR，在 $p<0.05$ 时使用 Bonferroni 校正，然后将显著的 CpG 合并成区域。忽略植物中的非 CpG 背景，以保持跨物种分析的一致性，并假设在共同花园条件下多态性可以忽略不计。\n\nC. 使用容器化工作流程和亚硫酸氢盐感知型比对。为了最大化灵敏度，在比对前去除重复读段。如果动物中的平均非 CpG 甲基化水平低于 $1\\%$, 则假设转化效率为 $100\\%$, 并将相同的假设应用于植物。将甲基化定量为 beta 值，并使用移动平均进行平滑；对窗口化的 beta 值执行双样本 $t$ 检验，不对重复样本特异性的覆盖度或过度离散进行建模。在名义上的 $p<0.05$ 宣布 DMR，不进行多重检验校正，但要求最小甲基化差异为 $0.1$。为了可比性，对两个物种使用相同的仅 CpG 分析。\n\nD. 进行接头修剪并使用亚硫酸氢盐感知型比对器进行比对。在两个物种中都使用 CHH 中的非 CpG 甲基化水平作为转化效率的代理。移除映射到重复区域的读段以避免模糊比对。在每个组内合并重复以增加深度，并对每个区域拟合一个二项广义线性模型，不考虑过度离散或平滑；控制 FDR 在 $q\\leq 0.05$。对于植物，在构建区域时包括 CHG 和 CHH，但对于动物仅分析 CpG。忽略 SNP 屏蔽，因为亚硫酸氢盐处理主要影响胞嘧啶，从而最小化了多态性的影响。\n\n选择唯一最佳答案。", "solution": "用户提供了一个关于为比较表观基因组学研究设计生物信息学流程的问题陈述。我将首先验证问题陈述，然后进行完整解答。\n\n### 问题验证\n\n**第 1 步：提取已知信息**\n\n问题陈述提供了以下信息：\n- **研究目标：** 比较一种多年生植物和一种脊椎动物的适应性表观遗传。\n- **实验设计：** 两个物种均暴露于相同的环境胁迫下，跨越两代，并在共同花园中饲养。\n- **数据：** 来自功能类似组织的全基因组亚硫酸氢盐测序 (WGBS)。\n- **重复：** 每个物种和每一代有 $n=3$ 个独立的生物学重复。\n- **分析目标：** 鉴定在两代之间持续存在且在两个物种间共享的差异甲基化区域 (DMRs)。\n- **流程要求：** 流程必须是可复现、偏倚受控且统计上稳健的，适用于植物和动物的甲基化组。\n- **基本事实：**\n    1. 亚硫酸氢钠将未甲基化的胞嘧啶转化为尿嘧啶（测序后读为胸腺嘧啶），而 $5$-甲基胞嘧啶则能抵抗转化。\n    2. 经亚硫酸氢盐处理的读段表现出胞嘧啶到胸腺嘧啶的不对称性，需要使用亚硫酸氢盐感知型比对。\n    3. 一个位点的甲基化是总覆盖读段中甲基化读段的计数，理想情况下遵循二项分布，但实际上表现出过度离散，通常用贝塔-二项分布建模。\n    4. 相邻胞嘧啶的甲基化在空间上是相关的。\n    5. 植物在 CpG、CHG 和 CHH 背景下有显著的甲基化。\n    6. 动物主要在 CpG 背景下甲基化，在特定细胞类型中有罕见的非 CpG 甲基化。\n\n**第 2 步：使用提取的已知信息进行验证**\n\n- **科学基础：** 该问题基于表观遗传学和生物信息学中用于 WGBS 数据分析的既定原则。所有基本事实都是对底层生物学和数据特征的正确表述。实验设计是合理的，在生态表观遗传学中很常见。\n- **问题明确：** 该问题要求根据提供的基本事实和一个明确的研究目标，从一组给定的选项中确定最合适的流程。其结构旨在通过从所提供原则的逻辑推导来确定一个唯一的最佳答案。\n- **客观性：** 语言是技术性的、精确的，并且没有主观论断。对流程的要求（可复现、偏倚受控、统计稳健）是计算生物学中的标准准则。\n\n**第 3 步：结论与行动**\n\n问题陈述是 **有效的**。它在科学上是合理的、问题明确且客观。它提供了一个清晰的背景和足够的事实基础，可以严格评估所提出的选项。我现在将进行解答。\n\n### 解答推导\n\n目标是确定一个可复现、能控制已知偏倚且在统计上适用于比较植物和动物 WGBS 数据的流程。根据提供的基本事实，一个正确的流程必须解决几个关键点：\n\n1.  **可复现性：** 分析必须是自动化的和有文档记录的。这要求脚本化的工作流程（例如，使用 Snakemake/Nextflow）、软件环境控制（例如，使用 Docker/Singularity 等容器化技术）以及所有软件版本和参数的文档记录。\n2.  **偏倚控制：**\n    - **读段质量：** 初始处理必须包括接头和质量修剪。\n    - **亚硫酸氢盐转化效率不足：** 转化效率从来不是 $100\\%$。这必须通过经验性测量来确定，通常使用未甲基化的 spike-in 对照（如 λ 噬菌体 DNA）。否则会引入系统性偏倚，将未转化的未甲基化胞嘧啶误判为甲基化的。\n    - **比对偏倚：** 亚硫酸氢盐处理会产生非互补的链（一条链上 C 到 T 的变化，另一条链上 G 到 A 的变化）。标准的比对器将无法正确映射这些读段。如基本事实所述，亚硫酸氢盐感知型比对器是必不可少的。\n    - **遗传变异 vs. 表观遗传变异：** 一个胞嘧啶到胸腺嘧啶的单核苷酸多态性 (SNP) 在亚硫酸氢盐测序后与一个组成性未甲基化的胞嘧啶无法区分。这是一个关键的混淆因素。流程必须考虑 SNP，例如通过在参考基因组中屏蔽多态性位点。\n    - **PCR 扩增偏倚：** PCR 重复是文库制备过程中的产物，必须在比对后识别并移除，以防止人为地夸大读段计数和歪曲甲基化估计。\n3.  **统计建模：**\n    - **过度离散：** 基本事实明确指出 WGBS 计数数据表现出过度离散，意味着方差大于二项分布模型的预测。因此，不能合并重复样本，并且需要一个能解释这种额外生物学方差的统计模型，如贝塔-二项模型。\n    - **空间相关性：** 由于邻近胞嘧啶的甲基化状态是相关的，因此采用包含这种空间信息的方法（例如，平滑或区域检验）比单位点检验更具效力且更具生物学相关性。\n    - **多重检验：** 全基因组分析涉及数百万次统计检验。严格控制假发现率 (FDR)，例如使用 Benjamini-Hochberg 程序，是强制性的，以避免大量的假阳性。简单的 p 值阈值是不可接受的。\n4.  **跨物种和背景特异性分析：** 流程必须正确处理植物和动物不同的甲基化图谱。这意味着在植物中分析 CpG、CHG 和 CHH 背景，但在动物中主要分析 CpG。物种间的比较必须在同类基础上进行（例如，直系同源区域中的 CpG 背景）。\n\n基于这些原则，我现在将评估每个选项。\n\n### 逐项分析\n\n**A. 建立一个脚本化工作流程...**\n此选项提出了一个全面而严谨的流程。\n- **可复现性：** 它明确提到了脚本化工作流程、容器化和参数文档化。这是正确的。\n- **偏倚控制：** 它包括 QC、修剪、使用 spike-in 评估亚硫酸氢盐转化效率、生成 M-bias 图、使用亚硫酸氢盐感知型比对器、处理 SNP 的方法（屏蔽/个性化）以及在比对后去除 PCR 重复。这正确地解决了所有主要的偏倚来源。\n- **统计建模：** 它建议使用贝塔-二项回归模型，这正确地处理了过度离散并允许包含协变量。它通过平滑融入了空间信息，应用了适当的 FDR 控制（Benjamini-Hochberg），并使用了效应量过滤器（最小甲基化差异）。这是一种统计上最先进的方法。\n- **跨物种/背景分析：** 它正确地指定了在植物中分析所有背景（CpG、CHG、CHH）以及在动物中分析适当的背景，并将跨物种比较限制在直系同源区域和匹配的背景上。这是正确的方法。\n\n**结论：** **正确**。该选项描述了一个遵循最佳实践并直接解决问题陈述和基本事实中概述的要求和复杂性的流程。\n\n**B. 修剪接头，然后使用标准的短读段比对器...**\n此选项包含几个致命的缺陷。\n- **比对：** 使用“标准的短读段比对器...不使用亚硫酸氢盐模式”直接违背了基本事实，即经亚硫酸氢盐处理的读段由于 C-to-T 不对称性而需要特殊的比对器。仅这一步就使整个流程无效，因为大多数读段将无法比对或比对错误。\n- **统计：** “合并所有重复”忽略了基本事实中提到的过度离散，导致伪重复和虚高的假阳性率。Fisher 精确检验不适用于具有可变覆盖度的过度离散计数数据。\n- **偏倚控制：** “不进行转化效率控制”是不可接受的。“假设多态性可以忽略不计”是一个危险的假设，它混淆了遗传学和表观遗传学。\n- **生物学背景：** “忽略植物中的非 CpG 背景”丢弃了关键的生物学信息，因为已知 CHG 和 CHH 甲基化在植物中是大量的并且功能上很重要。\n\n**结论：** **错误**。该流程在比对、统计和偏倚控制步骤上存在根本性缺陷。\n\n**C. 使用容器化工作流程和亚硫酸氢盐感知型比对。为了最大化灵敏度，在比对前去除重复读段...**\n此选项以正确的前提开始，但包含关键错误。\n- **PCR 重复：** 声称“在比对前去除重复读段”在逻辑上是不可能的。PCR 重复是通过在参考基因组上具有相同的起始和结束映射坐标来识别的；这只能在比对*之后*完成。\n- **偏倚控制：** 假设“$100\\%$”转化效率在科学上是不合理的。需要进行测量。\n- **统计建模：** “对窗口化的 beta 值执行...$t$ 检验”是一种不恰当的统计检验。Beta 值不携带有关覆盖度的信息，而 $t$ 检验不能正确地对计数数据、其方差结构或 WGBS 数据固有的过度离散进行建模。\n- **多重检验：** “不进行多重检验校正”是基因组学中的一个基本错误。这保证了不可接受的高数量的假阳性。\n\n**结论：** **错误**。该流程包含逻辑上不可能的步骤，并采用了极不充分的统计方法。\n\n**D. 进行接头修剪并使用亚硫酸氢盐感知型比对器进行比对。使用 CHH 中的非 CpG 甲基化水平作为转化效率的代理...**\n此选项包含一些不正确的假设和方法。\n- **偏倚控制：** 使用 CHH 甲基化作为转化效率的代理对于植物是无效的，因为在植物中 CHH 甲基化是受生物学调控的，并且可能很高。即使在动物中，它也是一个不理想的替代 proper spike-in control 的方法。\n- **PCR 重复：** 该选项没有提及处理 PCR 重复，这是一个主要的偏倚来源。\n- **统计：** “在每个组内合并重复”在统计上是无效的，因为它忽略了重复间的变异性和过度离散。使用“不考虑过度离散的二项广义线性模型”直接与基本事实相矛盾，即数据是过度离散的。一个不考虑这一点的模型是设定错误的。\n- **遗传混淆：** “忽略 SNP 屏蔽”的理由基于有缺陷的推理。C-to-T SNP 是亚硫酸氢盐测序数据中一个主要且众所周知的混淆因素，必须加以处理。\n\n**结论：** **错误**。该流程使用了有缺陷的代理进行质量控制，并采用了忽略数据已知特性的不恰当统计模型。", "answer": "$$\\boxed{A}$$", "id": "2568213"}]}