{"hands_on_practices": [{"introduction": "为了理解协同进化军备竞赛的动态本质，我们从一个基础的群体遗传学框架——“基因对基因”模型——开始。这个练习将要求你推导出在何种条件下，植物的抗性与植食性动物的毒力能通过频率依赖性选择在种群中得以维持 [@problem_id:2554981]。掌握这个模型至关重要，它能帮助你理解互作性状的成本和收益如何导致一个稳定的多态性平衡，从而阻止任何一方获得永久性的胜利。", "problem": "考虑一个单倍体植物种群和一个单倍体食草动物种群，它们在基因对基因关系下相互作用。该植物有一个抗性位点，其等位基因为 $R$ 和 $r$，频率分别为 $p$ 和 $1 - p$。该食草动物有一个毒性位点，其等位基因为 $V$ 和 $v$，频率分别为 $q$ 和 $1 - q$。假设每一代中植物个体和食草动物个体之间随机相遇。\n\n假设宿主-天敌选择动态包含以下基本且广泛使用的要素：\n- 下一代的基因型频率由每个物种内各基因型的相对适应度在离散世代中确定，其中基因型适应度等于遭遇事件中的期望繁殖成功率。\n- 无论相遇结果如何，抗性等位基因 $R$ 都会给植物带来一个固定代价 $c_{R}$，其中 $0 < c_{R} < 1$。\n- 无论相遇结果如何，毒性等位基因 $V$ 都会给食草动物带来一个固定代价 $c_{V}$，其中 $0 < c_{V} < 1$。\n- 如果食草行为在一个植物个体上成功，该植物的适应度将因一个伤害因子 $s$ 而乘性降低，其中 $0 < s < 1$。\n- 如果食草行为失败，除了任何固定代价外，植物不会受到额外伤害。\n- 在基因对基因相互作用下，无毒性食草动物 $v$ 在 $R$ 植物上失败，在 $r$ 植物上成功；有毒性食草动物 $V$ 在 $R$ 和 $r$ 植物上均成功。\n- 成功的食草行为为食草动物带来标准化的收益 $1$（在计算任何固定代价之前），失败则收益为 $0$。\n\n任务：\n1. 仅使用上述定义和假设，推导植物和食草动物的边际适应度，将其表示为 $p$、$q$、$c_{R}$、$c_{V}$ 和 $s$ 的函数。然后，推导由各物种内按比例选择所蕴含的等位基因频率递推关系 $p \\mapsto p^{\\prime}$ 和 $q \\mapsto q^{\\prime}$。\n2. 通过使各物种内竞争等位基因的边际适应度相等，找出满足 $0 < p^{\\ast} < 1$ 和 $0 < q^{\\ast} < 1$ 的内部多态平衡点 $(p^{\\ast}, q^{\\ast})$。将 $p^{\\ast}$ 和 $q^{\\ast}$ 用 $c_{R}$、$c_{V}$ 和 $s$ 以闭合形式表示，并说明内部平衡点存在所需的任何参数限制。\n\n以解析形式的行向量 $(p^{\\ast}, q^{\\ast})$ 提供你的最终答案。不要进行近似或四舍五入。", "solution": "首先根据所需标准对问题进行验证。\n\n**步骤 1：提取已知条件**\n- 种群：单倍体植物，单倍体食草动物。\n- 相互作用：基因对基因关系。\n- 植物位点：等位基因 $R$（抗性，频率 $p$）和 $r$（易感性，频率 $1-p$）。\n- 食草动物位点：等位基因 $V$（毒性，频率 $q$）和 $v$（无毒性，频率 $1-q$）。\n- 相遇：在每个离散世代中随机发生。\n- 适应度模型：下一代频率由相对基因型适应度（期望繁殖成功率）确定。\n- 代价与伤害：\n    - 抗性 ($R$) 的固定代价：$c_{R}$，其中 $0 < c_{R} < 1$。\n    - 毒性 ($V$) 的固定代价：$c_{V}$，其中 $0 < c_{V} < 1$。\n    - 成功食草行为导致的植物适应度降低：乘性因子 $s$，其中 $0 < s < 1$。\n- 相互作用矩阵：\n    - 食草动物 $v$ 作用于植物 $R$：失败。\n    - 食草动物 $v$ 作用于植物 $r$：成功。\n    - 食草动物 $V$ 作用于植物 $R$：成功。\n    - 食草动物 $V$ 作用于植物 $r$：成功。\n- 食草动物收益：\n    - 成功食草：标准化收益为 $1$（计算代价前）。\n    - 失败食草：收益为 $0$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了一个典型的基因对基因模型，这是协同进化动态研究中的一个基本概念。它在科学上是合理的，并基于群体遗传学的既定原则。\n- **适定性**：该问题定义清晰，包含了所有必要的参数和相互作用规则。它要求进行标准分析：推导适应度函数、递推关系以及确定内部平衡点。其结构允许得出唯一且有意义的解。\n- **客观性**：问题陈述精确、量化，并且没有主观或含糊的语言。\n\n**结论：** 该问题有效。这是一个在理论生物学中被良好表述的问题，可以使用标准的数学方法解决。\n\n**任务 1：推导适应度与递推关系**\n\n设 $W_R$ 和 $W_r$ 分别为植物等位基因 $R$ 和 $r$ 的边际适应度。设 $W_V$ 和 $W_v$ 分别为食草动物等位基因 $V$ 和 $v$ 的边际适应度。由于种群是单倍体，基因型适应度等同于等位基因的边际适应度。我们将两个物种的基准适应度都标准化为 $1$。\n\n**植物适应度**\n植物的适应度由其基因型以及遇到每种食草动物类型的概率决定。\n- **等位基因 $R$ 的适应度 ($W_R$)**：带有等位基因 $R$ 的植物会产生一个固定代价 $c_{R}$，使其基准适应度降至 $1-c_{R}$。它有 $q$ 的概率遇到有毒性食草动物 ($V$)，这会导致食草成功，其适应度将再乘以 $(1-s)$。它有 $1-q$ 的概率遇到无毒性食草动物 ($v$)，此时食草失败，因此没有进一步的适应度降低。期望适应度为：\n$$W_{R} = q \\cdot (1-c_{R})(1-s) + (1-q) \\cdot (1-c_{R}) = (1-c_{R}) [q(1-s) + (1-q)] = (1-c_{R})(1-qs)$$\n- **等位基因 $r$ 的适应度 ($W_r$)**：带有等位基因 $r$ 的植物不承担抗性代价。然而，有毒性 ($V$) 和无毒性 ($v$) 的食草动物都能成功取食它。因此，它在每次相遇时都会遭受 $s$ 的伤害，适应度变为 $1-s$。期望适应度为：\n$$W_{r} = 1-s$$\n植物种群的平均适应度为 $\\bar{W}_{\\text{plant}} = p W_{R} + (1-p) W_{r}$。$R$ 等位基因频率的递推关系 $p' = p \\frac{W_R}{\\bar{W}_{\\text{plant}}}$ 为：\n$$p^{\\prime} = \\frac{p(1-c_{R})(1-qs)}{p(1-c_{R})(1-qs) + (1-p)(1-s)}$$\n\n**食草动物适应度**\n食草动物的适应度由其相遇的期望收益减去任何固定代价决定。\n- **等位基因 $V$ 的适应度 ($W_V$)**：带有等位基因 $V$ 的食草动物是有毒性的，因此在 $R$ 和 $r$ 植物上均能成功。其期望收益为 $1$。它会产生一个固定代价 $c_{V}$。我们将其适应度建模为期望收益减去该代价。\n$$W_{V} = (p \\cdot 1 + (1-p) \\cdot 1) - c_V = 1 - c_{V}$$\n- **等位基因 $v$ 的适应度 ($W_v$)**：带有等位基因 $v$ 的食草动物是无毒性的。它在 $R$ 植物上失败（收益 $0$），在 $r$ 植物上成功（收益 $1$）。它不承担任何代价。其期望适应度为：\n$$W_{v} = p \\cdot 0 + (1-p) \\cdot 1 = 1-p$$\n食草动物种群的平均适应度为 $\\bar{W}_{\\text{herb}} = q W_{V} + (1-q) W_{v}$。$V$ 等位基因频率的递推关系 $q' = q \\frac{W_V}{\\bar{W}_{\\text{herb}}}$ 为：\n$$q^{\\prime} = \\frac{q(1-c_{V})}{q(1-c_{V}) + (1-q)(1-p)}$$\n\n**任务 2：确定内部多态平衡点**\n\n内部多态平衡点 $(p^{\\ast}, q^{\\ast})$ 是一个状态，在该状态下 $0 < p^{\\ast} < 1$ 且 $0 < q^{\\ast} < 1$，并且等位基因频率随时间保持不变（$p' = p$ 且 $q' = q$）。这种情况发生在每个物种内部竞争等位基因的边际适应度相等时。\n\n**食草动物多态性条件 ($W_V = W_v$)**\n为了使食草动物种群在两种等位基因都存在的情况下（$0 < q^* < 1$）达到平衡，等位基因 $V$ 和 $v$ 的适应度必须相等。\n$$W_{V} = W_{v}$$\n$$1 - c_{V} = 1 - p^{\\ast}$$\n求解 $p^{\\ast}$ 可得植物种群中抗性等位基因的平衡频率：\n$$p^{\\ast} = c_{V}$$\n\n**植物多态性条件 ($W_R = W_r$)**\n为了使植物种群在两种等位基因都存在的情况下（$0 < p^* < 1$）达到平衡，等位基因 $R$ 和 $r$ 的适应度必须相等。\n$$W_{R} = W_{r}$$\n$$(1-c_{R})(1-q^{\\ast}s) = 1-s$$\n我们求解 $q^{\\ast}$，即食草动物种群中毒性等位基因的平衡频率。\n$$1-q^{\\ast}s = \\frac{1-s}{1-c_{R}}$$\n$$q^{\\ast}s = 1 - \\frac{1-s}{1-c_{R}}$$\n$$q^{\\ast}s = \\frac{(1-c_{R}) - (1-s)}{1-c_{R}} = \\frac{1-c_{R}-1+s}{1-c_{R}} = \\frac{s-c_{R}}{1-c_{R}}$$\n$$q^{\\ast} = \\frac{s-c_{R}}{s(1-c_{R})}$$\n\n**内部平衡点的存在条件**\n平衡点 $(p^{\\ast}, q^{\\ast})$ 仅在 $0 < p^{\\ast} < 1$ 和 $0 < q^{\\ast} < 1$ 时具有生物学意义。\n1.  对 $p^{\\ast}$ 而言：我们需要 $0 < p^{\\ast} < 1$，这意味着 $0 < c_{V} < 1$。这个条件在问题陈述中已经给出。\n2.  对 $q^{\\ast}$ 而言：我们需要 $0 < q^{\\ast} < 1$。\n    - 分母 $s(1-c_{R})$ 总是正的，因为 $0 < s < 1$ 且 $0 < c_{R} < 1$。\n    - 条件 $q^{\\ast} > 0$ 要求分子为正：$s - c_{R} > 0$，即 $s > c_{R}$。这意味着食草造成的伤害必须超过抗性的代价。\n    - 条件 $q^{\\ast} < 1$ 要求 $\\frac{s-c_{R}}{s(1-c_{R})} < 1$。这意味着 $s-c_{R} < s(1-c_{R})$，化简为 $s-c_{R} < s - s c_{R}$。这可以进一步化简为 $-c_{R} < -s c_{R}$。由于 $c_R > 0$，我们可以用 $-c_R$ 除两边并反转不等号，得到 $1 > s$。这个条件也在问题陈述中给出。\n\n因此，存在唯一内部多态平衡点的唯一参数限制是 $s > c_{R}$。\n\n内部多态平衡点由数对 $(p^{\\ast}, q^{\\ast})$ 给出。\n$$p^{\\ast} = c_{V}$$\n$$q^{\\ast} = \\frac{s-c_{R}}{s(1-c_{R})}$$\n该点代表一个协同进化平衡，其中植物的抗性频率由食草动物的毒性代价决定，而食草动物的毒性频率由植物抗性代价和食草伤害之间的权衡决定。", "answer": "$$ \\boxed{ \\begin{pmatrix} c_{V} & \\frac{s - c_{R}}{s(1 - c_{R})} \\end{pmatrix} } $$", "id": "2554981"}, {"introduction": "群体遗传学模型中经常包含抽象的“成本”参数，但这些成本究竟从何而来？本练习将通过对化学防御物质生物合成的建模，深入探讨此类权衡的生理学基础 [@problem_id:2554952]。你将应用质量守恒定律于一个共享的代谢前体，从而推导出生产两种不同毒素之间的基本权衡关系，为理解塑造植物防御策略的内在限制提供一个具体、机理性的视角。", "problem": "一种植物与特化的植食性动物进行协同进化军备竞赛，为此投资于两类化学上不同的防御性毒素，分别记为$A$类和$B$类。两类毒素都由一种单一的限制性前体$P$生物合成而来，该前体由初级代谢以恒定速率$J$（单位生物量单位时间内的$P$的摩尔数）提供。生物合成一个$A$毒素分子需要$s_{A}$个$P$分子，生物合成一个$B$毒素分子需要$s_{B}$个$P$分子，其中$s_{A} > 0$和$s_{B} > 0$是由合成途径化学决定的化学计量系数。\n\n假设以下广为接受的基础：\n- 稳态下前体库的质量守恒：如果$P$的细胞内库很小且不积累，那么其供应速率等于所有消耗途径的总消耗速率。\n- 植物中毒素的一阶损失（稀释或降解）：对于浓度为$T_{i}$（单位生物量的摩尔数）、合成通量为$v_{i}$（单位生物量单位时间的摩尔数）以及一阶损失速率常数$d_{i} > 0$（单位时间）的毒素$i \\in \\{A,B\\}$，稳态满足$T_{i} = v_{i}/d_{i}$。\n\n植食压力使得同时维持两种毒素是有益的，但这两种毒素的生物合成途径竞争共享的前体$P$。除了这两个途径外，没有其他消耗$P$的途径，也没有$P$的储存。\n\n仅使用上述原理（质量守恒和一阶损失），推导两种稳态毒素水平之间的精确归一化权衡关系，该关系由以下无量纲变量定义：\n$$\n\\theta_{A} \\equiv \\frac{s_{A} d_{A} T_{A}}{J}\n\\quad \\text{和} \\quad\n\\theta_{B} \\equiv \\frac{s_{B} d_{B} T_{B}}{J}.\n$$\n将最终结果表示为$\\theta_{B}$关于$\\theta_{A}$的单个闭式解析表达式。不需要进行数值计算，最终表达式中不应包含单位。", "solution": "该问题陈述经过验证，被认为是科学上合理、良定且客观的。这是一个定量生物学中的标准问题，依赖于质量守恒的基本原理。它没有任何使其无效的缺陷。因此，我们可以进行推导。\n\n这个问题的核心在于对稳态下的前体分子$P$应用质量守恒原理。问题指出，前体以恒定速率$J$供应，并完全被毒素$A$和$B$的生物合成途径消耗，没有积累或其他消耗途径。\n\n设$v_{A}$和$v_{B}$分别为毒素$A$和$B$的合成通量，单位为单位生物量单位时间的摩尔数。合成一个$A$毒素分子需要$s_{A}$个$P$分子，合成一个$B$毒素分子需要$s_{B}$个$P$分子。因此，前体$P$的总消耗速率是每个途径消耗速率的总和。稳态下前体$P$的质量平衡方程为：\n$$\nJ = s_{A} v_{A} + s_{B} v_{B}\n$$\n该方程表明，前体的总流入量$J$必须等于流入两个生物合成途径的总流出量。\n\n接下来，我们使用提供的第二条信息：毒素本身的稳态条件。问题指出，对于毒素$i \\in \\{A, B\\}$，其浓度$T_{i}$处于稳态，此时合成通量$v_{i}$与速率常数为$d_{i}$的一阶损失过程相平衡。该关系式为：\n$$\nT_{i} = \\frac{v_{i}}{d_{i}}\n$$\n我们可以重排该表达式，用毒素浓度$T_{i}$和损失速率常数$d_{i}$来表示合成通量$v_{i}$：\n$$\nv_{i} = d_{i} T_{i}\n$$\n将此应用于毒素$A$和$B$，我们得到：\n$$\nv_{A} = d_{A} T_{A}\n$$\n$$\nv_{B} = d_{B} T_{B}\n$$\n现在，我们将$v_{A}$和$v_{B}$的这些表达式代入前体质量平衡方程：\n$$\nJ = s_{A} (d_{A} T_{A}) + s_{B} (d_{B} T_{B})\n$$\n这个方程代表了由固定的总资源供应$J$决定的两种毒素稳态浓度$T_{A}$和$T_{B}$之间的基本权衡关系。\n\n问题要求用归一化的无量纲变量$\\theta_{A}$和$\\theta_{B}$来表示该关系，其定义为：\n$$\n\\theta_{A} \\equiv \\frac{s_{A} d_{A} T_{A}}{J}\n$$\n$$\n\\theta_{B} \\equiv \\frac{s_{B} d_{B} T_{B}}{J}\n$$\n这些变量分别代表分配给合成毒素$A$和毒素$B$的总前体通量$J$的比例。\n\n为了将我们的权衡方程转换为这些变量，我们可以将整个方程除以恒定的总供应通量$J$（因为$J$是一个速率，所以非零）：\n$$\n\\frac{J}{J} = \\frac{s_{A} d_{A} T_{A}}{J} + \\frac{s_{B} d_{B} T_{B}}{J}\n$$\n$$\n1 = \\frac{s_{A} d_{A} T_{A}}{J} + \\frac{s_{B} d_{B} T_{B}}{J}\n$$\n通过直接替换$\\theta_{A}$和$\\theta_{B}$的定义，我们得到归一化的权衡关系：\n$$\n1 = \\theta_{A} + \\theta_{B}\n$$\n最后，问题要求给出$\\theta_{B}$作为$\\theta_{A}$函数的表达式。对上述方程进行简单的代数重排即可得到结果：\n$$\n\\theta_{B} = 1 - \\theta_{A}\n$$\n这是归一化稳态毒素水平之间权衡关系的精确解析表达式。该关系是一个简单的线性权衡，这是由支配共享有限前体的守恒定律直接导致的。", "answer": "$$\\boxed{1 - \\theta_{A}}$$", "id": "2554952"}, {"introduction": "在我们理解了遗传和生理限制之后，现在我们将转向一个更综合的框架，来研究复杂数量性状的协同进化。本练习将运用Lande方程 $\\Delta \\mathbf{z} = \\mathbf{G} \\boldsymbol{\\beta}$ 来模拟植物和植食性动物性状的演化轨迹，它整合了选择压力与潜在的遗传结构 [@problem_id:2555040]。通过实现这个模型，你将获得运用进化论中这一强大工具的实践经验，并直接观察到遗传方差-协方差矩阵（$\\mathbf{G}$）是如何调控对互惠选择压力的响应。", "problem": "本题要求您使用数量遗传学知识，为一个植物-植食者拮抗相互作用构建一个确定性的协同进化模拟。其根本基础是数量遗传学中的 Lande 方程：每一代中，数量性状向量均值的变化等于作用于选择梯度上的加性遗传方差-协方差。假设植物有两个连续性状，植食者也有两个连续性状。请使用以下定义和假设作为出发点。\n\n从 Fisher 的无穷小模型和 Lande 方程出发：对于任何平均性状向量为 $\\mathbf{z} \\in \\mathbb{R}^{2}$ 的物种，其每代响应为 $\\Delta \\mathbf{z} = \\mathbf{G} \\, \\boldsymbol{\\beta}$，其中 $\\mathbf{G} \\in \\mathbb{R}^{2 \\times 2}$ 是加性遗传方差-协方差 (G) 矩阵，$\\boldsymbol{\\beta} \\in \\mathbb{R}^{2}$ 是作用于平均性状上的选择梯度。\n\n通过对植食者与植物性状之间不匹配度的线性定向选择，结合对各物种自身性状的稳定选择，来模拟拮抗协同进化。设植物的平均性状向量为 $\\mathbf{z}_{p} \\in \\mathbb{R}^{2}$，植食者的平均性状向量为 $\\mathbf{z}_{h} \\in \\mathbb{R}^{2}$。设相互作用映射为 $\\mathbf{M} \\in \\mathbb{R}^{2 \\times 2}$。定义不匹配度为 $\\mathbf{m} = \\mathbf{z}_{h} - \\mathbf{M} \\mathbf{z}_{p}$。选择机制由四个正常量指定：$b_{p}$ 和 $b_{h}$ 分别控制拮抗定向选择，而 $s_{p}$ 和 $s_{h}$ 分别控制对植物和植食者性状的稳定选择强度。选择梯度为\n$\\boldsymbol{\\beta}_{h} = b_{h} \\, \\mathbf{m} - s_{h} \\, \\mathbf{z}_{h}$ 和 $\\boldsymbol{\\beta}_{p} = - b_{p} \\, \\mathbf{M}^{\\top} \\mathbf{m} - s_{p} \\, \\mathbf{z}_{p}$。\n假设在适用情况下所有矩阵都是对称的，并且所有参数作为实值标量和矩阵在生物学上都是合理的。\n\n使用以下公式模拟 $T$ 代的离散时间动态：\n$\\mathbf{z}_{h}^{(t+1)} = \\mathbf{z}_{h}^{(t)} + \\mathbf{G}_{h} \\, \\boldsymbol{\\beta}_{h}^{(t)}$ 和 $\\mathbf{z}_{p}^{(t+1)} = \\mathbf{z}_{p}^{(t)} + \\mathbf{G}_{p} \\, \\boldsymbol{\\beta}_{p}^{(t)}$，初始值在 $\\mathbf{z}_{h}^{(0)}$ 和 $\\mathbf{z}_{p}^{(0)}$。此过程没有随机性；这是一个纯粹的确定性递归。\n\n请实现一个程序，对每个测试用例，计算最终的平均性状向量 $\\mathbf{z}_{p}^{(T)}$ 和 $\\mathbf{z}_{h}^{(T)}$，并将它们连接并展平为 $[\\mathbf{z}_{p,1}^{(T)}, \\mathbf{z}_{p,2}^{(T)}, \\mathbf{z}_{h,1}^{(T)}, \\mathbf{z}_{h,2}^{(T)}]$ 的形式输出。将每个值四舍五入到 $6$ 位小数。不涉及物理单位。\n\n使用以下测试套件（每个案例提供 $\\mathbf{G}_{p}$、$\\mathbf{G}_{h}$、$\\mathbf{M}$、$b_{p}$、$b_{h}$、$s_{p}$、$s_{h}$、$\\mathbf{z}_{p}^{(0)}$、$\\mathbf{z}_{h}^{(0)}$ 和 $T$）：\n\n- 案例 A（一般性拮抗协同进化，中等协方差）：\n  - $\\mathbf{G}_{p} = \\begin{bmatrix} 0.08 & 0.02 \\\\ 0.02 & 0.05 \\end{bmatrix}$,\n    $\\mathbf{G}_{h} = \\begin{bmatrix} 0.06 & 0.01 \\\\ 0.01 & 0.07 \\end{bmatrix}$,\n    $\\mathbf{M} = \\begin{bmatrix} 1.0 & 0.3 \\\\ 0.2 & 0.9 \\end{bmatrix}$,\n    $b_{p} = 0.5$, $b_{h} = 0.5$, $s_{p} = 0.1$, $s_{h} = 0.1$,\n    $\\mathbf{z}_{p}^{(0)} = \\begin{bmatrix} 0.2 \\\\ 0.1 \\end{bmatrix}$,\n    $\\mathbf{z}_{h}^{(0)} = \\begin{bmatrix} 0.1 \\\\ 0.3 \\end{bmatrix}$,\n    $T = 50$.\n\n- 案例 B（边界条件：零代）：\n  - $\\mathbf{G}_{p} = \\begin{bmatrix} 0.08 & 0.02 \\\\ 0.02 & 0.05 \\end{bmatrix}$,\n    $\\mathbf{G}_{h} = \\begin{bmatrix} 0.06 & 0.01 \\\\ 0.01 & 0.07 \\end{bmatrix}$,\n    $\\mathbf{M} = \\begin{bmatrix} 1.0 & 0.3 \\\\ 0.2 & 0.9 \\end{bmatrix}$,\n    $b_{p} = 0.5$, $b_{h} = 0.5$, $s_{p} = 0.1$, $s_{h} = 0.1$,\n    $\\mathbf{z}_{p}^{(0)} = \\begin{bmatrix} 0.4 \\\\ -0.2 \\end{bmatrix}$,\n    $\\mathbf{z}_{h}^{(0)} = \\begin{bmatrix} -0.1 \\\\ 0.0 \\end{bmatrix}$,\n    $T = 0$.\n\n- 案例 C（在一个植食者性状上的近奇异响应）：\n  - $\\mathbf{G}_{p} = \\begin{bmatrix} 0.01 & 0.0 \\\\ 0.0 & 0.01 \\end{bmatrix}$,\n    $\\mathbf{G}_{h} = \\begin{bmatrix} 0.0001 & 0.0 \\\\ 0.0 & 0.02 \\end{bmatrix}$,\n    $\\mathbf{M} = \\begin{bmatrix} 1.0 & 0.0 \\\\ 0.0 & 1.0 \\end{bmatrix}$,\n    $b_{p} = 0.3$, $b_{h} = 0.6$, $s_{p} = 0.2$, $s_{h} = 0.2$,\n    $\\mathbf{z}_{p}^{(0)} = \\begin{bmatrix} 0.5 \\\\ 0.5 \\end{bmatrix}$,\n    $\\mathbf{z}_{h}^{(0)} = \\begin{bmatrix} 0.4 \\\\ 0.1 \\end{bmatrix}$,\n    $T = 100$.\n\n- 案例 D（强拮抗和强稳定选择）：\n  - $\\mathbf{G}_{p} = \\begin{bmatrix} 0.05 & -0.015 \\\\ -0.015 & 0.04 \\end{bmatrix}$,\n    $\\mathbf{G}_{h} = \\begin{bmatrix} 0.07 & 0.02 \\\\ 0.02 & 0.05 \\end{bmatrix}$,\n    $\\mathbf{M} = \\begin{bmatrix} 0.8 & 0.2 \\\\ 0.4 & 1.2 \\end{bmatrix}$,\n    $b_{p} = 1.5$, $b_{h} = 1.5$, $s_{p} = 0.8$, $s_{h} = 0.8$,\n    $\\mathbf{z}_{p}^{(0)} = \\begin{bmatrix} -0.2 \\\\ 0.2 \\end{bmatrix}$,\n    $\\mathbf{z}_{h}^{(0)} = \\begin{bmatrix} 0.0 \\\\ -0.1 \\end{bmatrix}$,\n    $T = 30$.\n\n您的程序应完全按照所述实现确定性递归，对每个案例独立执行模拟，并生成单行输出，其中包含连接成一个扁平列表的所有结果，每个浮点数四舍五入到 $6$ 位小数，并用方括号括起来。例如，格式必须像 $[\\text{result}_{1},\\text{result}_{2},\\ldots]$，其中序列是案例 A、案例 B、案例 C 和案例 D 的四维向量按此顺序连接而成。", "solution": "该问题陈述经过验证，被认为是具有科学依据、良定且客观的。它描述了基于数量遗传学中基础性的 Lande 方程的拮抗协同进化确定性模拟。所有参数、初始条件和控制方程都以数学上的精确性指定，从而允许存在唯一且可计算的解。因此，可以继续进行求解。\n\n该模型描述了两个物种——植物和植食者——的协同进化，每个物种都由一个二维平均性状向量表征，分别表示为 $\\mathbf{z}_{p} \\in \\mathbb{R}^{2}$ 和 $\\mathbf{z}_{h} \\in \\mathbb{R}^{2}$。这些性状在离散世代中的演化由 Lande 方程控制，该方程指出，每代的选择响应是加性遗传方差-协方差矩阵 $\\mathbf{G}$ 和选择梯度向量 $\\boldsymbol{\\beta}$ 的乘积。\n\n动态由离散时间递归给出：\n$$ \\mathbf{z}_{p}^{(t+1)} = \\mathbf{z}_{p}^{(t)} + \\Delta \\mathbf{z}_{p}^{(t)} = \\mathbf{z}_{p}^{(t)} + \\mathbf{G}_{p} \\, \\boldsymbol{\\beta}_{p}^{(t)} $$\n$$ \\mathbf{z}_{h}^{(t+1)} = \\mathbf{z}_{h}^{(t)} + \\Delta \\mathbf{z}_{h}^{(t)} = \\mathbf{z}_{h}^{(t)} + \\mathbf{G}_{h} \\, \\boldsymbol{\\beta}_{h}^{(t)} $$\n其中 $t$ 是世代数，$\\mathbf{G}_{p}$ 和 $\\mathbf{G}_{h}$ 分别是植物和植食者的恒定加性遗传方差-协方差矩阵，$\\boldsymbol{\\beta}_{p}^{(t)}$ 和 $\\boldsymbol{\\beta}_{h}^{(t)}$ 是第 $t$ 代的选择梯度。\n\n选择梯度源于两个方面：由性状间不匹配度驱动的拮抗选择，以及对各物种自身性状的稳定选择。不匹配度向量 $\\mathbf{m}$ 定义为植食者性状与通过相互作用矩阵 $\\mathbf{M} \\in \\mathbb{R}^{2 \\times 2}$ 介导的、从植食者角度感知的植物性状之间的差异：\n$$ \\mathbf{m}^{(t)} = \\mathbf{z}_{h}^{(t)} - \\mathbf{M} \\mathbf{z}_{p}^{(t)} $$\n\n植食者和植物的选择梯度随后被表述为：\n$$ \\boldsymbol{\\beta}_{h}^{(t)} = b_{h} \\, \\mathbf{m}^{(t)} - s_{h} \\, \\mathbf{z}_{h}^{(t)} $$\n$$ \\boldsymbol{\\beta}_{p}^{(t)} = - b_{p} \\, \\mathbf{M}^{\\top} \\mathbf{m}^{(t)} - s_{p} \\, \\mathbf{z}_{p}^{(t)} $$\n这里，$b_{h} > 0$ 和 $b_{p} > 0$ 是来自拮抗相互作用的定向选择系数，而 $s_{h} > 0$ 和 $s_{p} > 0$ 是稳定选择的系数。$\\boldsymbol{\\beta}_{p}$ 中的负号和转置矩阵 $\\mathbf{M}^{\\top}$ 反映了拮抗选择压力的相互性。\n\n问题要求在 $T$ 代之后，从初始条件 $\\mathbf{z}_{p}^{(0)}$ 和 $\\mathbf{z}_{h}^{(0)}$ 出发，计算最终的性状向量 $\\mathbf{z}_{p}^{(T)}$ 和 $\\mathbf{z}_{h}^{(T)}$。解是通过对方程组进行直接数值模拟获得的。对于从 $0$ 到 $T-1$ 的每一代 $t$，执行以下计算序列：\n$1$. 使用当前的性状向量 $\\mathbf{z}_{p}^{(t)}$ 和 $\\mathbf{z}_{h}^{(t)}$ 计算不匹配度向量 $\\mathbf{m}^{(t)}$。\n$2$. 基于 $\\mathbf{m}^{(t)}$ 和当前的性状向量计算选择梯度 $\\boldsymbol{\\beta}_{p}^{(t)}$ 和 $\\boldsymbol{\\beta}_{h}^{(t)}$。\n$3$. 确定每个物种的进化响应（性状变化），$\\Delta \\mathbf{z}_{p}^{(t)} = \\mathbf{G}_{p} \\boldsymbol{\\beta}_{p}^{(t)}$ 和 $\\Delta \\mathbf{z}_{h}^{(t)} = \\mathbf{G}_{h} \\boldsymbol{\\beta}_{h}^{(t)}$。\n$4$. 更新平均性状向量以获得下一代的状态：$\\mathbf{z}_{p}^{(t+1)} = \\mathbf{z}_{p}^{(t)} + \\Delta \\mathbf{z}_{p}^{(t)}$ 和 $\\mathbf{z}_{h}^{(t+1)} = \\mathbf{z}_{h}^{(t)} + \\Delta \\mathbf{z}_{h}^{(t)}$。\n\n该迭代过程将执行指定的世代数 $T$。对于 $T=0$ 的特殊情况，不执行任何迭代，最终状态与初始状态相同，即 $\\mathbf{z}_{p}^{(0)}$ 和 $\\mathbf{z}_{h}^{(0)}$。\n\n实现将独立处理每个测试用例。对每个案例，给定的参数（$\\mathbf{G}_p, \\mathbf{G}_h, \\mathbf{M}, b_p, b_h, s_p, s_h, \\mathbf{z}_{p}^{(0)}, \\mathbf{z}_{h}^{(0)}, T$）将用于初始化和运行模拟。最终向量 $\\mathbf{z}_{p}^{(T)}$ 和 $\\mathbf{z}_{h}^{(T)}$ 被连接成一个单一的\n$4$ 分量向量 $[\\mathbf{z}_{p,1}^{(T)}, \\mathbf{z}_{p,2}^{(T)}, \\mathbf{z}_{h,1}^{(T)}, \\mathbf{z}_{h,2}^{(T)}]$，每个分量按要求四舍五入到 $6$ 位小数。然后，所有测试用例的结果将汇总到一个单一的扁平列表中作为最终输出。所有的矩阵和向量代数运算都将使用 `numpy` 库来处理。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the coevolutionary dynamics problem for the given test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            # Case A: general antagonistic coevolution, moderate covariances\n            \"Gp\": np.array([[0.08, 0.02], [0.02, 0.05]]),\n            \"Gh\": np.array([[0.06, 0.01], [0.01, 0.07]]),\n            \"M\": np.array([[1.0, 0.3], [0.2, 0.9]]),\n            \"bp\": 0.5, \"bh\": 0.5, \"sp\": 0.1, \"sh\": 0.1,\n            \"zp0\": np.array([0.2, 0.1]),\n            \"zh0\": np.array([0.1, 0.3]),\n            \"T\": 50\n        },\n        {\n            # Case B: boundary condition: zero generations\n            \"Gp\": np.array([[0.08, 0.02], [0.02, 0.05]]),\n            \"Gh\": np.array([[0.06, 0.01], [0.01, 0.07]]),\n            \"M\": np.array([[1.0, 0.3], [0.2, 0.9]]),\n            \"bp\": 0.5, \"bh\": 0.5, \"sp\": 0.1, \"sh\": 0.1,\n            \"zp0\": np.array([0.4, -0.2]),\n            \"zh0\": np.array([-0.1, 0.0]),\n            \"T\": 0\n        },\n        {\n            # Case C: nearly singular response in one herbivore trait\n            \"Gp\": np.array([[0.01, 0.0], [0.0, 0.01]]),\n            \"Gh\": np.array([[0.0001, 0.0], [0.0, 0.02]]),\n            \"M\": np.array([[1.0, 0.0], [0.0, 1.0]]),\n            \"bp\": 0.3, \"bh\": 0.6, \"sp\": 0.2, \"sh\": 0.2,\n            \"zp0\": np.array([0.5, 0.5]),\n            \"zh0\": np.array([0.4, 0.1]),\n            \"T\": 100\n        },\n        {\n            # Case D: strong antagonism and strong stabilizing selection\n            \"Gp\": np.array([[0.05, -0.015], [-0.015, 0.04]]),\n            \"Gh\": np.array([[0.07, 0.02], [0.02, 0.05]]),\n            \"M\": np.array([[0.8, 0.2], [0.4, 1.2]]),\n            \"bp\": 1.5, \"bh\": 1.5, \"sp\": 0.8, \"sh\": 0.8,\n            \"zp0\": np.array([-0.2, 0.2]),\n            \"zh0\": np.array([0.0, -0.1]),\n            \"T\": 30\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        Gp, Gh, M = case[\"Gp\"], case[\"Gh\"], case[\"M\"]\n        bp, bh, sp, sh = case[\"bp\"], case[\"bh\"], case[\"sp\"], case[\"sh\"]\n        zp, zh = case[\"zp0\"], case[\"zh0\"]\n        T = case[\"T\"]\n        \n        # Perform the deterministic simulation for T generations\n        for _ in range(T):\n            # Calculate mismatch\n            m = zh - (M @ zp)\n            \n            # Calculate selection gradients\n            beta_h = bh * m - sh * zh\n            beta_p = -bp * (M.T @ m) - sp * zp\n            \n            # Update trait vectors\n            zp = zp + (Gp @ beta_p)\n            zh = zh + (Gh @ beta_h)\n\n        # Concatenate and flatten the final trait vectors\n        final_vector = np.concatenate((zp, zh))\n        \n        # Round the results to 6 decimal places\n        rounded_vector = np.round(final_vector, 6)\n        \n        all_results.extend(rounded_vector.tolist())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2555040"}]}