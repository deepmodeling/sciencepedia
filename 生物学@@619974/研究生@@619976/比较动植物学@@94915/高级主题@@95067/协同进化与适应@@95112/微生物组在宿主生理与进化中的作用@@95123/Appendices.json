{"hands_on_practices": [{"introduction": "在任何微生物组研究中，第一个关键决策是选择正确的测序方法。这项练习将引导您权衡扩增子测序（如 16S rRNA）与宏基因组鸟枪法测序之间的利弊。通过分析不同宿主环境（高微生物生物量的鱼肠道与高宿主 DNA 污染的植物叶际）的特点，您将学会如何根据研究目标、样本特性和预算限制，做出明智的技术选择，这是将研究设计与可靠功能推断联系起来的基础。[@problem_id:2617770]", "problem": "一项比较研究旨在表征和解释两种宿主系统中的微生物组：杂食性鱼类肠道（微生物生物量高，可获取肠腔内容物）和橡树叶际（微生物生物量低，宿主细胞丰度高，富含叶绿体）。研究人员必须在靶向细菌$16\\mathrm{S}$核糖体RNA（rRNA）基因的核糖体RNA扩增子测序与对总脱氧核糖核酸（DNA）进行的宏基因组鸟枪法测序之间做出选择。他们希望就物种分类组成和潜在功能能力得出可靠的推论，并且他们意识到在植物系统中，很大一部分DNA来源于宿主的细胞核、线粒体和叶绿体。\n\n请基于分子生物学和生态学的基本原理，推导出最合适的选择。使用这些基础知识时，无需假定任何专门的先验公式：分子生物学中心法则、核糖体RNA基因的结构和保守性及其可变区能够用于物种分类辨别、聚合酶链式反应（PCR）的扩增原理和引物退火特异性、鸟枪法宏基因组学对随机DNA片段进行测序而无需位点特异性扩增的事实，以及$16\\mathrm{S}$ rRNA基因拷贝数在细菌和古菌基因组中存在差异这一事实。假设在植物样本中，与细菌$16\\mathrm{S}$同源的质体和线粒体基因位点非常丰富，并且宿主DNA无法被完全物理去除。同时，也要认识到植物中的真菌群落成员通常很显著，使用内转录间隔区（ITS）标记比使用细菌$16\\mathrm{S}$能更好地对其进行分析。\n\n考虑到上述限制，哪个选项在物种分类和功能分辨率、主要偏差方面最好地区分了$16\\mathrm{S}$ rRNA扩增子测序与宏基因组鸟枪法测序，并为鱼类肠道和橡树叶际推荐了各自适用的方法？\n\nA. $16\\mathrm{S}$ rRNA扩增子测序提供株水平的分辨率和对代谢基因的直接测量，偏差极小，因为PCR扩增的是一个高度保守的位点，所以宿主细胞器序列的共扩增可以忽略不计。因此，为橡树叶选择$16\\mathrm{S}$扩增子，为鱼肠道选择宏基因组鸟枪法测序，因为植物宿主DNA比动物宿主DNA问题更少。\n\nB. $16\\mathrm{S}$ rRNA扩增子测序通常能将分类单元解析到属至种的水平，但在株的区分和功能推断方面能力有限，并且会受到引物错配和$16\\mathrm{S}$ rRNA基因拷贝数变化的偏差影响；除非使用阻断策略，否则它也容易受到植物质体和线粒体的共扩增影响。宏基因组鸟枪法测序可以实现种到株的分辨率，并直接恢复基因库和通路，但在低生物量样本中会受到高比例宿主DNA的限制。因此，对微生物生物量高、宿主DNA比例较低的鱼肠道使用宏基因组鸟枪法测序；对橡树叶际，则使用$16\\mathrm{S}$ rRNA扩增子（配合细胞器阻断寡核苷酸，以及针对真菌的ITS），除非有高效的宿主去除方法和充足的高深度测序预算，才能启用宏基因组鸟枪法。\n\nC. $16\\mathrm{S}$ rRNA扩增子测序以相似的分辨率统一分析细菌、古菌和真菌，且基本上没有拷贝数偏差；因此，在研究植物根系时，它比ITS更受青睐。宏基因组鸟枪法测序在没有完整参考基因组的情况下不能用于功能推断，因此对于存在许多未培养分类群的鱼肠道来说，它通常是较差的选择。\n\nD. 引物错配偏差对宏基因组鸟枪法测序和$16\\mathrm{S}$ rRNA扩增子测序的影响相同，因此方法的选择仅由期望的终点决定：使用鸟枪法进行物种分类，使用$16\\mathrm{S}$ rRNA扩增子进行功能分析。在植物中，叶绿体DNA不会干扰任何一种方法，因为它总是可以通过计算完全去除，所以鸟枪法是橡树叶际的最佳选择。\n\nE. $16\\mathrm{S}$ rRNA扩增子测序避免了富含古菌的动物肠道中的偏差，并通过插补法得出直接的通路丰度，而宏基因组鸟枪法测序在叶片中更可取，因为叶绿体基因组与细菌的差异足够大，可以防止干扰，并且宿主读数在比对过滤后不影响下游推断。因此，为鱼肠道选择$16\\mathrm{S}$ rRNA扩增子，为橡树叶际选择宏基因组鸟枪法测序。", "solution": "该问题要求对两种DNA测序方法——$16\\mathrm{S}$核糖体RNA（rRNA）扩增子测序和宏基因组鸟枪法测序——进行批判性比较，以用于表征两种不同环境中的微生物群落：高生物量的鱼类肠道和低生物量、高宿主DNA含量的植物叶际。评估必须基于题目陈述中提供的分子生物学和生态学基本原理。\n\n首先，让我们根据陈述的原理分析每种方法的核心特征。\n\n**方法1：$16\\mathrm{S}$ rRNA扩增子测序**\n该技术基于聚合酶链式反应（PCR）来选择性地扩增一个特定的标记基因，即细菌和古菌的$16\\mathrm{S}$ rRNA基因。引物靶向该基因的保守区域，这些区域侧翼是可变区域。然后，使用这些可变区域的序列进行物种分类鉴定。\n\n1.  **物种分类分辨率**：$16\\mathrm{S}$ rRNA基因片段中包含的信息通常足以进行属级分类，有时也能达到种级分类。然而，因为它只是一个单一的部分基因，所以缺乏可靠区分亲缘关系非常近的物种或区分一个物种内不同菌株的分辨率。\n2.  **功能推断**：该方法*仅*测序$16\\mathrm{S}$ rRNA基因。它不提供关于生物体基因组中存在的功能基因（例如，代谢、抗生素抗性基因）的直接信息。功能潜力可以根据物种分类谱，通过参考相关分类群的已知基因组来*推断*或*插补*，但这是间接预测，而不是对样本中基因含量的直接测量。\n3.  **偏差和局限性**：\n    a.  **PCR引物偏好**：用于PCR的引物可能不会以同等效率与所有分类群的DNA退火。引物与目标序列之间的错配可能导致差异性扩增，使得一些分类群被过度代表，而另一些则被低估或完全遗漏。\n    b.  **基因拷贝数变异**：如题所述，原核生物基因组中$16\\mathrm{S}$ rRNA基因的拷贝数各不相同（从$1$到超过$15$个）。拷贝数较高的生物体会产生更多的扩增子，导致其在群落中的相对丰度被高估。这是一个重要的定量偏差来源。\n    c.  **宿主和细胞器污染**：问题正确地指出，线粒体和叶绿体起源于细菌，并拥有自己的核糖体，其rRNA基因与细菌的$16\\mathrm{S}$ rRNA基因同源。在宿主与微生物细胞比例高的样本中，例如橡树叶际，所谓的“通用”细菌引物会扩增这些丰富的细胞器序列，可能会淹没来自真实微生物群落的信号。通常需要专门的策略，例如使用阻断寡核苷酸来结合并阻止细胞器DNA的扩增。\n    d.  **分类范围**：标准的$16\\mathrm{S}$ rRNA引物是为细菌和古菌设计的。它们不靶向真核生物，如真菌。如题所述，分析真菌群落需要一个不同的标记，通常是内转录间隔区（ITS）区域。\n\n**方法2：宏基因组鸟枪法测序**\n该方法涉及对从样本中提取的总DNA进行测序，而不靶向任何特定基因。DNA被随机片段化并测序，提供存在的所有遗传物质的样本。\n\n1.  **物种分类分辨率**：通过对整个基因组的片段进行测序，该方法为物种分类提供了更丰富的数据。它能够实现高分辨率的鉴定，直至种甚至株的水平，这通常通过从宏基因组数据中组装基因组（宏基因组组装基因组或MAGs）或使用更广泛的单拷贝标记基因来实现。\n2.  **功能推断**：这是宏基因组鸟枪法测序的主要优势。它直接测序群落的功能基因，提供了关于代谢潜力或“基因库”的全面图谱。这是直接测量，而不是推断。\n3.  **偏差和局限性**：\n    a.  **宿主DNA污染**：这是主要挑战。由于测序是随机的，任何给定来源的读段比例反映了其在初始DNA池中的比例。在像橡树叶这样由宿主DNA主导的低生物量样本中，绝大多数的测序精力和成本将用于测序宿主DNA，留给微生物基因组的读段非常少，因此覆盖度不足。正如问题所述，宿主DNA的物理去除是不完美的，虽然可以通过计算方法去除宿主读段，但这无法弥补微生物部分损失的测序深度。\n    b.  **偏差规避**：该方法避免了扩增子测序固有的特定PCR引物和$16\\mathrm{S}$拷贝数偏差。\n\n**应用于宿主系统**\n\n*   **鱼类肠道样本**：特征是“高微生物生物量”。这种微生物与宿主DNA的高比例使其成为宏基因组鸟枪法测序的绝佳候选。该方法将产生高分辨率的物种分类数据，以及至关重要的、关于肠道微生物组代谢能力的直接功能信息。这通常是肠道微生物组研究的目标。虽然也可以进行$16\\mathrm{S}$测序，但它提供的信息会少得多。\n*   **橡树叶际样本**：特征是“低微生物生物量”和“高宿主细胞丰度，富含叶绿体”。在这里，宿主和细胞器DNA的压倒性比例使得宏基因组鸟枪法测序变得成本过高且效率低下。大多数读段将是非微生物的。更务实的方法是$16\\mathrm{S}$ rRNA扩增子测序。该方法利用PCR来富集微生物信号。然而，必须解决叶绿体和线粒体大量$16\\mathrm{S}$样基因的共扩增问题，这使得使用阻断寡核苷酸成为必要。为了考虑所提到的显著的真菌群落，需要使用ITS扩增子测序进行平行分析，以获得完整的图景。\n\n现在我们基于此分析来评估给出的选项。\n\n**A. $16\\mathrm{S}$ rRNA扩增子测序提供株水平的分辨率和对代谢基因的直接测量，偏差极小，因为PCR扩增的是一个高度保守的位点，所以宿主细胞器序列的共扩增可以忽略不计。因此，为橡树叶选择$16\\mathrm{S}$扩增子，为鱼肠道选择宏基因组鸟枪法测序，因为植物宿主DNA比动物宿主DNA问题更少。**\n这个陈述根本上是错误的。$16\\mathrm{S}$测序不提供株水平的分辨率或直接的功能数据。它以显著的偏差（引物和拷贝数偏差）而闻名。细胞器DNA的共扩增在植物中是一个主要问题，而不是可以忽略不计的问题。关于植物宿主DNA“问题更少”的断言是毫无根据的，并与问题中对叶际的设定相矛盾。**不正确**。\n\n**B. $16\\mathrm{S}$ rRNA扩增子测序通常能将分类单元解析到属至种的水平，但在株的区分和功能推断方面能力有限，并且会受到引物错配和$16\\mathrm{S}$ rRNA基因拷贝数变化的偏差影响；除非使用阻断策略，否则它也容易受到植物质体和线粒体的共扩增影响。宏基因组鸟枪法测序可以实现种到株的分辨率，并直接恢复基因库和通路，但在低生物量样本中会受到高比例宿主DNA的限制。因此，对微生物生物量高、宿主DNA比例较低的鱼肠道使用宏基因组鸟枪法测序；对橡树叶际，则使用$16\\mathrm{S}$ rRNA扩增子（配合细胞器阻断寡核苷酸，以及针对真菌的ITS），除非有高效的宿主去除方法和充足的高深度测序预算，才能启用宏基因组鸟枪法。**\n该陈述是对当前技术水平的精确而准确的总结。它正确地描述了$16\\mathrm{S}$测序的分辨率、功能能力和偏差。它正确地指出了宏基因组鸟枪法测序的优势和局限性。最重要的是，它为每个生物系统做出了正确的、合乎逻辑的推荐，包括针对具有挑战性的植物样本所必需的技术考虑（阻断寡核苷酸、用于真菌的ITS）。**正确**。\n\n**C. $16\\mathrm{S}$ rRNA扩增子测序以相似的分辨率统一分析细菌、古菌和真菌，且基本上没有拷贝数偏差；因此，在研究植物根系时，它比ITS更受青睐。宏基因组鸟枪法测序在没有完整参考基因组的情况下不能用于功能推断，因此对于存在许多未培养分类群的鱼肠道来说，它通常是较差的选择。**\n这个陈述包含多个谬误。$16\\mathrm{S}$引物不靶向真菌；ITS标记用于此目的。$16\\mathrm{S}$测序受到主要的拷贝数偏差影响。宏基因组鸟枪法测序通过将基因与功能数据库进行注释来提供功能数据，这不需要完整的参考基因组。它实际上是研究未培养分类群的优越工具。**不正确**。\n\n**D. 引物错配偏差对宏基因组鸟枪法测序和$16\\mathrm{S}$ rRNA扩增子测序的影响相同，因此方法的选择仅由期望的终点决定：使用鸟枪法进行物种分类，使用$16\\mathrm{S}$ rRNA扩增子进行功能分析。在植物中，叶绿体DNA不会干扰任何一种方法，因为它总是可以通过计算完全去除，所以鸟枪法是橡树叶际的最佳选择。**\n这个陈述大错特错。引物错配偏差是基于PCR的方法（如$16\\mathrm{S}$测序）的标志，而不是宏基因组鸟枪法测序。它们的作用被颠倒了：$16\\mathrm{S}$用于物种分类（有局限性），而鸟枪法用于高分辨率的物种分类和功能分析。通过计算从鸟枪法数据中去除宿主/细胞器读段并不能解决测序深度被浪费的问题，这使得它对橡树叶来说并非最佳选择。**不正确**。\n\n**E. $16\\mathrm{S}$ rRNA扩增子测序避免了富含古菌的动物肠道中的偏差，并通过插补法得出直接的通路丰度，而宏基因组鸟枪法测序在叶片中更可取，因为叶绿体基因组与细菌的差异足够大，可以防止干扰，并且宿主读数在比对过滤后不影响下游推断。因此，为鱼肠道选择$16\\mathrm{S}$ rRNA扩增子，为橡树叶际选择宏基因组鸟枪法测序。**\n这个陈述是不正确的。$16\\mathrm{S}$测序对古菌存在已知的偏差。插补法产生的是预测的而非直接的通路丰度。宏基因组鸟枪法测序在叶片中更可取的前提是错误的；大量的宿主DNA是关键问题，在测序后对其进行过滤会导致微生物数据急剧减少。最终的建议与正确答案相反。**不正确**。\n\n基于对所提供原理的严谨分析，选项B是唯一一个提出科学上合理且完整的比较和建议的选项。", "answer": "$$\\boxed{B}$$", "id": "2617770"}, {"introduction": "获得原始测序数据后，一个关键的统计挑战是如何处理不同样本间测序深度的差异。这项练习深入探讨了“稀疏化”（rarefaction）这一常见的数据标准化方法，并要求您运用基本的统计学原理来评估其对多样性估计偏差和方差的影响。通过这个思想实验，您将更深刻地理解微生物组数据的成分性（compositionality）本质，并探索为何现代统计模型是更优越的替代方案，从而确保您的分析结果稳健可靠。[@problem_id:2617801]", "problem": "一项比较研究通过高通量测序，测量了来自两个具有不同生理机能的脊椎动物宿主谱系的肠道微生物组中，每个样本的扩增子序列变体数量。对每个样本而言，其各分类单元的观测计数由一个多项式采样过程生成，该过程具有总读数 $N$ 和潜在的真实相对丰度 $\\mathbf{p} = (p_1,\\dots,p_S)$, 其中 $S$ 是区域库中分类单元的总数。研究人员希望使用丰富度和香нон多样性来比较不同宿主谱系间的样本内多样性，同时承认样本间的测序深度存在差异。\n\n请考虑以下基本原理：\n- 多项式采样：如果 $X_i$ 表示一个总读数为 $N$ 的样本中分类单元 $i$ 的计数，则 $(X_1,\\dots,X_S) \\sim \\mathrm{Multinomial}(N,\\mathbf{p})$，并且 $\\hat{p}_i = X_i/N$ 是 $p_i$ 的插件估计。\n- 稀疏化（Rarefaction）：通过无放回子抽样将文库大小均一化至一个固定的深度 $n^\\star < N$，这等同于在给定 $(X_1,\\dots,X_S)$ 的条件下，从一个多元超几何分布中抽取 $(R_1,\\dots,R_S)$，然后使用 $R_i/n^\\star$ 替代 $\\hat{p}_i$。\n- 全方差定律：对于任意随机变量 $Y$ 和条件变量 $Z$，$\\mathrm{Var}(Y) = \\mathbb{E}[\\mathrm{Var}(Y \\mid Z)] + \\mathrm{Var}(\\mathbb{E}[Y \\mid Z])$。\n- 在一个大小为 $n$ 的多项式样本中，观测到的丰富度的期望为 $\\sum_{i=1}^S \\left(1 - (1-p_i)^n\\right)$，对于任何 $p_i \\in (0,1)$，该期望随 $n$ 严格递增。\n- 真实群落的香农熵为 $H = -\\sum_{i=1}^S p_i \\log p_i$。基于经验比例的插件估计器存在负向的小样本偏差，该偏差随着 $n$ 的减小而恶化，这是对数函数凹性的结果。\n\n仅使用这些原理，评估稀疏化如何影响具有异质性 $N$ 的样本中丰富度和香农多样性估计的方差和偏差。然后，选择一个选项，该选项既能正确描述这些影响，又能提出一种统计上合理的替代方案，该方案在控制微生物组数据的组成性的同时，保留了样本量的差异。\n\n哪个选项最合适？\n\nA. 稀疏化使 $N$ 均等化，因此降低了丰富度和香农估计的方差；通过丢弃读数，它还移除了低丰度噪声并消除了偏差。在所有情况下都应首选该方法。\n\nB. 稀疏化引入了一个额外的超几何采样阶段，这会增大方差，并且通过减小 $n$，它增加了插件式香农估计的负偏差，并降低了预期的观测丰富度；相反，应保留所有计数，并使用多项式或狄利克雷-多项式似然对其进行建模，将样本特定的文库大小作为偏移量纳入模型，使用基于覆盖度标准化的希尔数来估计alpha多样性，并通过对数比变换（例如，中心对数比）或经过验证的参考框架来解决组成性问题；这能在不丢弃数据的情况下保留 $N$ 的差异。\n\nC. 稀疏化不改变偏差，因为它是一种无偏重采样方案，并且通常会降低多样性估计的方差；一个更好的替代方法是进行总和缩放至相对丰度，然后进行欧几里得分析，这通过使所有向量总和为 $1$ 来控制组成性。\n\nD. 稀疏化通过移除大部分为测序错误的稀有分类单元来减少偏差；一种更优越的方法是过滤掉所有低计数分类单元，然后使用过滤后的数据通过标准 $t$ 检验来比较观测丰富度。\n\nE. 稀疏化增加了方差，但也通过匹配深度消除了组成性效应；一种替代方法是始终稀疏化到观测到的最小 $N$ 值，并分析未转换的比例，因为当深度均等化后，组成性就不再是问题。", "solution": "问题陈述已提交以供验证。\n\n### 步骤1：提取给定信息\n\n该问题提供了以下数据、定义和原理：\n- **系统**：一项关于两种脊椎动物宿主谱系肠道微生物组的比较研究。\n- **数据**：通过高通量测序生成的每个样本的扩增子序列变体计数。\n- **采样模型**：$S$ 个分类单元的观测计数 $(X_1, \\dots, X_S)$ 服从多项式分布 $\\mathrm{Multinomial}(N, \\mathbf{p})$，其中 $N$ 是一个样本的总读数（文库大小），$\\mathbf{p} = (p_1, \\dots, p_S)$ 是总和为 $1$ 的真实相对丰度。\n- **估计量**：真实比例 $p_i$ 的插件估计是 $\\hat{p}_i = X_i/N$。\n- **目标**：比较不同宿主谱系间的样本内多样性（丰富度和香农多样性）。\n- **挑战**：测序深度 $N$ 在样本间是异质的。\n- **待审视的技术**：稀疏化，定义为无放回子抽样至一个固定的深度 $n^\\star < N$。得到的计数 $(R_1, \\dots, R_S)$ 在给定原始计数 $(X_1, \\dots, X_S)$ 的条件下，服从多元超几何分布。稀疏化后的比例是 $R_i/n^\\star$。\n- **原理1（全方差定律）**：对于任意随机变量 $Y$ 和 $Z$，$\\mathrm{Var}(Y) = \\mathbb{E}[\\mathrm{Var}(Y \\mid Z)] + \\mathrm{Var}(\\mathbb{E}[Y \\mid Z])$。\n- **原理2（期望丰富度）**：在一个大小为 $n$ 的多项式样本中，观测到的丰富度的期望由 $\\sum_{i=1}^S \\left(1 - (1-p_i)^n\\right)$ 给出。对于任何 $p_i \\in (0,1)$，该期望是样本量 $n$ 的严格递增函数。\n- **原理3（香农多样性偏差）**：香农熵 $H = -\\sum_{i=1}^S p_i \\log p_i$ 的插件估计器存在一个负向的小样本偏差。由于对数函数的凹性，该偏差随着样本量 $n$ 的减小而变得更严重（即，更负）。\n\n### 步骤2：使用提取的给定信息进行验证\n\n必须评估问题陈述的科学依据、适定性和客观性。\n\n1.  **科学或事实上的不健全**：该问题在事实上是健全的。它描述了微生物生态学和生物信息学中的一个典型问题。所涉及的统计模型（多项式、多元超几何）和概念（稀疏化、丰富度、香农多样性、组成性）在该领域都是标准的。所提供的原理——全方差定律、期望丰富度公式以及插件式香农估计器的性质——都是数理统计中正确且公认的结果。\n2.  **不可形式化或不相关**：该问题与指定主题（*宿主生理与进化中的微生物组*）高度相关。它不是比喻性的，并且完全可以在统计框架内形式化。\n3.  **不完整或矛盾的设置**：该问题提供了一套足以分析稀疏化效应并评估所提出替代方案的原理。没有矛盾之处。\n4.  **不切实际或不可行**：异质测序深度的情景不仅是现实的，而且几乎是所有高通量测序研究中的默认情况。\n5.  **不适定或结构不良**：该问题是适定的。它要求基于给定的原理对一种特定技术（稀疏化）进行评估，并与替代方案进行比较。这项任务有一个基于统计理论的、明确且可验证的答案。\n6.  **伪深刻、琐碎或同义反复**：该问题并非琐碎。它要求正确应用和综合多个统计概念（抽样分布、偏差、方差），以剖析一种常见但常被误解的生物信息学实践。\n7.  **超出科学可验证性**：所有主张和原理都是科学上可验证的。\n\n### 步骤3：结论与行动\n\n问题陈述是**有效的**。这是一个适定的、有科学依据的生物统计学问题。我将继续进行解答。\n\n### 推导与评估\n\n任务是评估稀疏化对多样性估计的偏差和方差的影响，并找出一个更优的替代方案。我将使用所提供的原理。设一个来自稀疏化样本的多样性估计（例如，丰富度或香农多样性）为随机变量 $Y$。原始的、全深度的计数向量是条件变量 $Z = (X_1, \\dots, X_S)$。稀疏化过程是在给定 $Z$ 的条件下的第二阶段采样。\n\n**对​​方差的影响：**\n根据全方差定律，$\\mathrm{Var}(Y) = \\mathbb{E}[\\mathrm{Var}(Y \\mid Z)] + \\mathrm{Var}(\\mathbb{E}[Y \\mid Z])$。项 $\\mathbb{E}[\\mathrm{Var}(Y \\mid Z)]$ 表示由稀疏化步骤（超几何子抽样）引入的方差，该方差是在所有可能的初始样本 $Z$ 上取平均得到的。由于稀疏化是一个随机子抽样过程，对于任何非平凡的多样性估计量，该方差都是正的。这一项代表了一个额外的方差来源，如果我们使用基于完整数据 $Z$ 的估计量，这个方差来源本不会存在。因此，稀疏化丢弃了数据，这样做会*增大*在重复实验中对估计值进行恰当定义的总方差。认为它减少方差的观点是错误的；它用随机丢弃数据导致的人为方差膨胀，换掉了来自可变文库大小的真实方差分量。\n\n**对丰富度估计量偏差的影响：**\n根据原理2，预期的观测丰富度 $\\mathbb{E}[\\text{Richness}] = \\sum_{i=1}^S (1 - (1-p_i)^n)$ 是样本量 $n$ 的严格递增函数。稀疏化将每个样本 $j$ 的原始文库大小 $N_j$ 替换为一个更小的、固定的大小 $n^\\star$。这意味着对于任何给定的样本，由此产生的丰富度估计的期望值将低于基于其原始、更大文库大小的估计。它系统地将所有估计值向下推，丢失了关于测序更深的群落的信息，并使得估计任何群落的真实丰富度成为不可能。因此，它*降低了预期的观测丰富度*。\n\n**对香农多样性估计量偏差的影响：**\n根据原理3，插件式香农估计器存在一个负偏差，该偏差随着样本量 $n$ 的减小而恶化。稀疏化将样本量从 $N$ 减少到 $n^\\star < N$。因此，对于任何样本，在稀疏化数据上计算的香农估计的负偏差的绝对值将大于在完整数据上计算的估计的偏差。因此，稀疏化*增加了*插件式香农估计器的*负偏差*。\n\n**替代方案评估：**\n一个有原则的替代方案必须解决以下问题：\n1. **数据保留**：它应该使用所有可用数据，而不是丢弃数据。\n2. **可变测序深度**：它必须恰当地考虑不同文库大小（$N$）样本中可变的信息含量。\n3. **组成性**：它必须尊重数据的组成性质（即，比例总和为一个常数，因此不是独立的）。\n\n### 逐项选项分析\n\n**A. 稀疏化使 $N$ 均等化，因此降低了丰富度和香农估计的方差；通过丢弃读数，它还移除了低丰度噪声并消除了偏差。在所有情况下都应首选该方法。**\n- `降低方差`：不正确。如全方差定律所示，稀疏化引入了一个额外的采样步骤，这会增大方差。\n- `移除低丰度噪声`：不科学的语言。“噪声”没有明确定义。这相当于任意的数据过滤。许多稀有分类单元在生物学上是真实的且信息丰富。\n- `消除偏差`：不正确。对于丰富度，它系统地降低了期望值。对于香农多样性，它增加了负偏差。\n**结论：不正确。**\n\n**B. 稀疏化引入了一个额外的超几何采样阶段，这会增大方差，并且通过减小 $n$，它增加了插件式香农估计的负偏差，并降低了预期的观测丰富度；相反，应保留所有计数，并使用多项式或狄利克雷-多项式似然对其进行建模，将样本特定的文库大小作为偏移量纳入模型，使用基于覆盖度标准化的希尔数来估计alpha多样性，并通过对数比变换（例如，中心对数比）或经过验证的参考框架来解决组成性问题；这能在不丢弃数据的情况下保留 $N$ 的差异。**\n- `增大方差`：正确。这源于全方差定律。\n- `增加插件式香农估计的负偏差`：正确。这源于原理3。\n- `降低预期的观测丰富度`：正确。这源于原理2。\n- `替代方案`：所提出的替代方案是现代最佳实践的总结。\n    - 使用适当的分布（多项式、狄利克雷-多项式）对计数进行建模，并在广义线性模型框架中使用文库大小作为偏移量，是处理可变采样工作的正确方法。\n    - 基于覆盖度标准化的希尔数是比较不同文库大小样本间多样性的最新方法，取代了稀疏化。\n    - 对数比变换是分析组成性数据的理论上合理的方法。\n这个选项正确地指出了稀疏化的统计缺陷，并提出了一个全面且统计上合理的替代策略。\n**结论：正确。**\n\n**C. 稀疏化不改变偏差，因为它是一种无偏重采样方案，并且通常会降低多样性估计的方差；一个更好的替代方法是进行总和缩放至相对丰度，然后进行欧几里得分析，这通过使所有向量总和为 $1$ 来控制组成性。**\n- `不改变偏差`：不正确。根据原理可知，它改变了丰富度和香农估计量的偏差。相对于原始样本中的比例，重采样可能是“无偏的”，但随后的多样性计算是一个非线性变换，这对于最终估计的期望值来说，并不能保持这一性质。\n- `降低方差`：不正确。它增大了方差。\n- `替代方案`：总和缩放（即转换为比例）后跟假设欧几里得几何的标准方法（例如，主成分分析、对比例进行t检验）对于组成性数据在统计上是无效的，并且可能导致虚假的结论。使所有向量总和为 $1$ 是组成性问题的*定义*，而不是其解决方案。\n**结论：不正确。**\n\n**D. 稀疏化通过移除大部分为测序错误的稀有分类单元来减少偏差；一种更优越的方法是过滤掉所有低计数分类单元，然后使用过滤后的数据通过标准 $t$ 检验来比较观测丰富度。**\n- `通过移除稀有分类单元来减少偏差`：这是一个没有根据的断言。它假设稀有分类单元是错误，并将偏差的统计定义与临时的过滤程序混淆。\n- `替代方案`：这在统计上也是一种糟糕的做法。任意过滤低计数分类单元是不符合原则的。在没有考虑均值-方差关系的适当误差模型（例如，泊松分布、负二项分布）的情况下，对丰富度计数使用标准 $t$ 检验是不稳健的。\n**结论：不正确。**\n\n**E. 稀疏化增加了方差，但也通过匹配深度消除了组成性效应；一种替代方法是始终稀疏化到观测到的最小 $N$ 值，并分析未转换的比例，因为当深度均等化后，组成性就不再是问题。**\n- `增加了方差`：这部分是正确的。\n- `消除组成性效应`：这从根本上是错误的。组成性是指比例必须总和为一个常数（$1$）的约束。无论样本间的总计数（$N$）是否相等，这个约束都存在。使分母相等并不会使分子独立。\n- `替代方案`：认为组成性不再是问题的这个前提是错误的，这使得所提出的对未转换比例的分析无效。\n**结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "2617801"}, {"introduction": "超越“谁在那里”的分类学描述，微生物组研究的最终目标是理解“它们在做什么”的功能性相互作用。这项练习提供了一个关于通量平衡分析（Flux Balance Analysis, FBA）的实践入门，这是一种模拟微生物新陈代谢网络的强大计算工具。通过构建和求解一个简单的双菌种互养群落模型，您将学习如何预测在宿主环境施加的营养限制下，微生物群落的生长速率和代谢交换，从而将基因组信息与生态生理功能联系起来。[@problem_id:2617800]", "problem": "您正在为一个生活在宿主相关环境中的互养微生物对，建立一个最小的、科学上合理的、化学计量的群落代谢网络模型。微生物 $1$ 将葡萄糖发酵成乳酸，并需要乙酸来合成生物质；微生物 $2$ 利用氧气将乳酸氧化成乙酸，并同样从乳酸形成其自身的生物质。宿主对营养物供应以及胞外乙酸和乳酸的清除速率施加了限制。使用稳态质量平衡公式和通量平衡分析（FBA）来预测在几种宿主施加的约束条件下，两种微生物的比生长速率。\n\n使用的基本原理：\n- 代谢物的稳态质量平衡由 $$ S \\cdot \\mathbf{v} = \\mathbf{0}, $$ 给出，其中 $S$ 是化学计量矩阵，$\\mathbf{v}$ 是反应通量向量。\n- 反应通量的线性边界，用以表示吸收上限和宿主清除能力。\n- 线性规划，用于最大化一个线性的群落目标函数（生长速率之和）。\n\n网络规格：\n- 代谢物被分为胞外和胞内库。胞外代谢物：$\\mathrm{Glc_e}$、$\\mathrm{Lac_e}$、$\\mathrm{Ace_e}$、$\\mathrm{NH4_e}$、$\\mathrm{O2_e}$、$\\mathrm{CO2_e}$。微生物 $1$ 的胞内库：$\\mathrm{Glc1}$、$\\mathrm{Lac1}$、$\\mathrm{Ace1}$、$\\mathrm{NH4\\_1}$、$\\mathrm{ATP1}$、$\\mathrm{ADP1}$、$\\mathrm{Pi1}$、$\\mathrm{B1}$。微生物 $2$ 的胞内库：$\\mathrm{Lac2}$、$\\mathrm{Ace2}$、$\\mathrm{NH4\\_2}$、$\\mathrm{O2\\_2}$、$\\mathrm{ATP2}$、$\\mathrm{ADP2}$、$\\mathrm{Pi2}$、$\\mathrm{B2}$。\n- 反应（除非另有说明，所有反应均为不可逆反应，下界为 $0$，上界为一个大数）：\n\n外部供应与宿主清除：\n1. $\\mathrm{Glc\\_src}: \\quad \\varnothing \\rightarrow \\mathrm{Glc\\_e}$，其中 $0 \\le v \\le G$。\n2. $\\mathrm{O2\\_src}: \\quad \\varnothing \\rightarrow \\mathrm{O2\\_e}$，其中 $0 \\le v \\le O$。\n3. $\\mathrm{NH4\\_src}: \\quad \\varnothing \\rightarrow \\mathrm{NH4\\_e}$，其中 $0 \\le v \\le N$，$N$ 是一个大数（设 $N = 10^6$）。\n4. $\\mathrm{Ace\\_sink}: \\quad \\mathrm{Ace\\_e} \\rightarrow \\varnothing$，其中 $0 \\le v \\le A$。\n5. $\\mathrm{Lac\\_sink}: \\quad \\mathrm{Lac\\_e} \\rightarrow \\varnothing$，其中 $0 \\le v \\le L$。\n6. $\\mathrm{CO2\\_sink}: \\quad \\mathrm{CO2\\_e} \\rightarrow \\varnothing$，其中 $0 \\le v \\le 10^6$。\n\n微生物 $1$ 的转运：\n7. $\\mathrm{M1\\_Glc\\_upt}: \\quad \\mathrm{Glc\\_e} \\rightarrow \\mathrm{Glc1}$。\n8. $\\mathrm{M1\\_Ace\\_upt}: \\quad \\mathrm{Ace\\_e} \\rightarrow \\mathrm{Ace1}$。\n9. $\\mathrm{M1\\_Lac\\_sec}: \\quad \\mathrm{Lac1} \\rightarrow \\mathrm{Lac\\_e}$。\n10. $\\mathrm{M1\\_NH4\\_upt}: \\quad \\mathrm{NH4\\_e} \\rightarrow \\mathrm{NH4\\_1}$。\n\n微生物 $2$ 的转运：\n11. $\\mathrm{M2\\_Lac\\_upt}: \\quad \\mathrm{Lac\\_e} \\rightarrow \\mathrm{Lac2}$。\n12. $\\mathrm{M2\\_Ace\\_sec}: \\quad \\mathrm{Ace2} \\rightarrow \\mathrm{Ace\\_e}$。\n13. $\\mathrm{M2\\_O2\\_upt}: \\quad \\mathrm{O2\\_e} \\rightarrow \\mathrm{O2\\_2}$。\n14. $\\mathrm{M2\\_NH4\\_upt}: \\quad \\mathrm{NH4\\_e} \\rightarrow \\mathrm{NH4\\_2}$。\n\n微生物 $1$ 的内部代谢：\n15. $\\mathrm{M1\\_ferm}: \\quad \\mathrm{Glc1} + 2\\,\\mathrm{ADP1} + 2\\,\\mathrm{Pi1} \\rightarrow 2\\,\\mathrm{Lac1} + 2\\,\\mathrm{ATP1}$。\n16. $\\mathrm{M1\\_assim}: \\quad \\mathrm{Ace1} + \\mathrm{ATP1} \\rightarrow \\mathrm{B1} + \\mathrm{ADP1} + \\mathrm{Pi1}$。\n17. $\\mathrm{M1\\_biomass}: \\quad \\mathrm{B1} + \\mathrm{NH4\\_1} + \\mathrm{ATP1} \\rightarrow \\mathrm{ADP1} + \\mathrm{Pi1}$，该反应的通量是微生物 $1$ 的比生长速率 $\\mu_1$，单位为 $\\mathrm{h}^{-1}$。\n18. $\\mathrm{M1\\_ATPM}: \\quad \\mathrm{ATP1} \\rightarrow \\mathrm{ADP1} + \\mathrm{Pi1}$，下界为 $0$，上界为一个大数。\n\n微生物 $2$ 的内部代谢：\n19. $\\mathrm{M2\\_ox}: \\quad \\mathrm{Lac2} + \\mathrm{O2\\_2} + 3\\,\\mathrm{ADP2} + 3\\,\\mathrm{Pi2} \\rightarrow \\mathrm{Ace2} + 3\\,\\mathrm{ATP2} + \\mathrm{CO2\\_e}$。\n20. $\\mathrm{M2\\_bioprec}: \\quad \\mathrm{Lac2} + \\mathrm{ATP2} \\rightarrow \\mathrm{B2} + \\mathrm{ADP2} + \\mathrm{Pi2} + \\mathrm{CO2\\_e}$。\n21. $\\mathrm{M2\\_biomass}: \\quad \\mathrm{B2} + \\mathrm{NH4\\_2} + \\mathrm{ATP2} \\rightarrow \\mathrm{ADP2} + \\mathrm{Pi2}$，该反应的通量是微生物 $2$ 的比生长速率 $\\mu_2$，单位为 $\\mathrm{h}^{-1}$。\n22. $\\mathrm{M2\\_ATPM}: \\quad \\mathrm{ATP2} \\rightarrow \\mathrm{ADP2} + \\mathrm{Pi2}$，下界为 $0$，上界为一个大数。\n\n目标：\n- 最大化群落生长速率，由 $$\\text{maximize } \\mu_1 + \\mu_2,$$ 给出，约束条件为 $$ S \\cdot \\mathbf{v} = \\mathbf{0} $$ 和上述边界。将 $\\mu_1$ 解释为 $\\mathrm{M1\\_biomass}$ 的通量，$\\mu_2$ 解释为 $\\mathrm{M2\\_biomass}$ 的通量，单位为 $\\mathrm{h}^{-1}$。\n\n所有速率必须以 $\\mathrm{h}^{-1}$ 为单位报告。数值以浮点小数形式报告，并四舍五入到六位小数。不要使用百分号。\n\n测试套件和参数：\n设四个案例中的宿主供应和清除能力由元组 $(G,O,A,L)$ 给出，其中 $G$ 是最大葡萄糖供应量，$O$ 是最大氧气供应量，$A$ 是最大乙酸清除能力，$L$ 是最大乳酸清除能力，所有单位均为每小时一致的通量单位。在所有案例中，氨的供应量使用 $N = 10^6$。\n\n- 案例 $1$：$(G,O,A,L) = (10,10,5,5)$。\n- 案例 $2$：$(G,O,A,L) = (10,0,5,100)$。\n- 案例 $3$：$(G,O,A,L) = (2,10,0.1,0.1)$。\n- 案例 $4$：$(G,O,A,L) = (50,100,20,20)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个含四个项目的列表，每个项目对应一个测试用例，其中每个项目都是一个二元列表 $[\\mu_1,\\mu_2]$，每个值都四舍五入到六位小数。例如：`[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]]`，不含多余空格。", "solution": "所提出的问题要求应用通量平衡分析（FBA）来确定一个双物种微生物群落的稳态生长速率。FBA是系统生物学中一种标准的计算方法。该问题定义明确、有科学依据且内部一致。它提供了代谢网络的完整规格，包括代谢物、反应、化学计量和环境约束。目标被明确表述为最大化两种微生物的生长速率之和。此公式对应于一个典型的线性规划（LP）问题，对此存在稳健的求解方法。因此，该问题是有效的，并且可以构建解决方案。\n\nFBA的核心原理是假设胞内代谢物浓度处于伪稳态。这导出了系统中所有代谢物的质量平衡方程：\n$$ S \\cdot \\mathbf{v} = \\mathbf{0} $$\n其中 $S$ 是维度为 $m \\times n$（$m$ 个代谢物，$n$ 个反应）的化学计量矩阵，$\\mathbf{v}$ 是包含 $n$ 个反应通量的向量。矩阵的元素 $S_{ij}$ 代表代谢物 $i$ 在反应 $j$ 中的化学计量系数。正系数表示生产，负系数表示消耗。\n\n该系统进一步受到热力学和环境限制的约束，这些约束表示为单个通量的下界和上界：\n$$ \\mathbf{v}_{lb} \\le \\mathbf{v} \\le \\mathbf{v}_{ub} $$\n对于不可逆反应，下界通常为 $0$。上界由酶容量、宿主提供的营养物可用性（$G$，$O$）或宿主清除能力（$A$，$L$）等因素决定。\n\n生物学目标，在本例中是最大化群落生长，被公式化为一个待最大化的线性目标函数：\n$$ Z = \\mathbf{c}^T \\cdot \\mathbf{v} $$\n其中 $\\mathbf{c}$ 是一个选择目标通量（或多个通量）的向量。在这里，我们希望最大化 $\\mu_1 + \\mu_2$，其中 $\\mu_1$是微生物1的生物质反应通量（$v_{\\text{M1\\_biomass}}$），$\\mu_2$是微生物2的生物质反应通量（$v_{\\text{M2\\_biomass}}$）。\n\n结合这些元素，得到一个标准的LP问题：\n$$ \\begin{aligned} \\text{maximize} \\quad & \\mathbf{c}^T \\cdot \\mathbf{v} \\\\ \\text{subject to} \\quad & S \\cdot \\mathbf{v} = \\mathbf{0} \\\\ & \\mathbf{v}_{lb} \\le \\mathbf{v} \\le \\mathbf{v}_{ub} \\end{aligned} $$\n标准的LP求解器通常执行最小化。因此，我们将最小化 $-Z = -\\mathbf{c}^T \\cdot \\mathbf{v}$。\n\n为解决这个具体问题，我们首先根据给定的 $22$ 个反应和 $22$ 个代谢物构建化学计量矩阵 $S$。代谢物和反应被系统地排序以定义 $S$ 的行和列。假设代谢物排序如下：$6$ 种胞外（$\\mathrm{Glc_e}$, $\\mathrm{Lac_e}$, $\\mathrm{Ace_e}$, $\\mathrm{NH4_e}$, $\\mathrm{O2_e}$, $\\mathrm{CO2_e}$），接着是微生物 $1$ 的 $8$ 种（$\\mathrm{Glc1}$, $\\mathrm{Lac1}$, ..., $\\mathrm{B1}$），以及微生物 $2$ 的 $8$ 种（$\\mathrm{Lac2}$, $\\mathrm{Ace2}$, ..., $\\mathrm{B2}$）。假设反应按问题陈述中的顺序列出。最终得到的 $S$ 是一个 $22 \\times 22$ 的矩阵。\n\n例如，胞外乳酸（$\\mathrm{Lac_e}$）的质量平衡涉及其由微生物 1 分泌（$v_9$）、由宿主清除（$v_5$）以及由微生物 2 吸收（$v_{11}$）。在 $S \\cdot \\mathbf{v} = \\mathbf{0}$ 方程中对应的行是：\n$$ +1 \\cdot v_9 - 1 \\cdot v_5 - 1 \\cdot v_{11} = 0 $$\n\n目标向量 $\\mathbf{c}$ 的构建是为了表示最大化 $\\mu_1 + \\mu_2$。鉴于 $\\mu_1$ 是反应 $17$（$v_{17}$）的通量，而 $\\mu_2$ 是反应 $21$（$v_{21}$）的通量，我们希望最大化 $v_{17} + v_{21}$。对于一个最小化求解器，目标向量 $\\mathbf{c}$ 将是一个零向量，但在对应于 $v_{17}$ 和 $v_{21}$ 的位置上为 $-1$。\n\n通量边界是为每个测试案例定义的。所有反应都指定为不可逆的，因此所有下界都是 $0$。上界规定如下：\n- $v_1 \\le G$\n- $v_2 \\le O$\n- $v_3 \\le N = 10^6$\n- $v_4 \\le A$\n- $v_5 \\le L$\n- $v_6 \\le 10^6$\n- 所有其他反应通量（$v_7$ 到 $v_{22}$）都被赋予一个大的上界，我们使用 $10^6$，这与非限制性的氨供应量一致。\n\n对于四个测试案例 $(G, O, A, L)$ 中的每一个，我们组装相应的通量上界向量 $\\mathbf{v}_{ub}$，并使用数值求解器（具体为 `scipy.optimize.linprog`）来求解已定义的 LP 问题。得到的最优通量向量 $\\mathbf{v}^*$ 提供了解决方案。然后从该向量中提取生长速率 $\\mu_1$ 和 $\\mu_2$，分别为 $v_{17}^*$ 和 $v_{21}^*$。最终值按要求四舍五入到六位小数。所提供的 Python 代码实现了这整个过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves the Flux Balance Analysis problem for the microbial community.\n    \"\"\"\n    # Test cases as tuples (G, O, A, L)\n    test_cases = [\n        (10, 10, 5, 5),\n        (10, 0, 5, 100),\n        (2, 10, 0.1, 0.1),\n        (50, 100, 20, 20),\n    ]\n\n    # There are 22 metabolites and 22 reactions.\n    num_metabolites = 22\n    num_reactions = 22\n    \n    # Stoichiometric matrix S (22x22)\n    S = np.zeros((num_metabolites, num_reactions))\n\n    # Metabolite indices (0-based)\n    met_map = {\n        'Glc_e': 0, 'Lac_e': 1, 'Ace_e': 2, 'NH4_e': 3, 'O2_e': 4, 'CO2_e': 5,\n        'Glc1': 6, 'Lac1': 7, 'Ace1': 8, 'NH4_1': 9, 'ATP1': 10, 'ADP1': 11, 'Pi1': 12, 'B1': 13,\n        'Lac2': 14, 'Ace2': 15, 'NH4_2': 16, 'O2_2': 17, 'ATP2': 18, 'ADP2': 19, 'Pi2': 20, 'B2': 21\n    }\n\n    # Reaction indices (0-based)\n    rxn_map = {\n        'Glc_src': 0, 'O2_src': 1, 'NH4_src': 2, 'Ace_sink': 3, 'Lac_sink': 4, 'CO2_sink': 5,\n        'M1_Glc_upt': 6, 'M1_Ace_upt': 7, 'M1_Lac_sec': 8, 'M1_NH4_upt': 9,\n        'M2_Lac_upt': 10, 'M2_Ace_sec': 11, 'M2_O2_upt': 12, 'M2_NH4_upt': 13,\n        'M1_ferm': 14, 'M1_assim': 15, 'M1_biomass': 16, 'M1_ATPM': 17,\n        'M2_ox': 18, 'M2_bioprec': 19, 'M2_biomass': 20, 'M2_ATPM': 21\n    }\n\n    # Reaction definitions: S[met_idx, rxn_idx] = stoich_coeff\n    # 1. Glc_src: -> Glc_e\n    S[met_map['Glc_e'], rxn_map['Glc_src']] = 1\n    # 2. O2_src: -> O2_e\n    S[met_map['O2_e'], rxn_map['O2_src']] = 1\n    # 3. NH4_src: -> NH4_e\n    S[met_map['NH4_e'], rxn_map['NH4_src']] = 1\n    # 4. Ace_sink: Ace_e -> \n    S[met_map['Ace_e'], rxn_map['Ace_sink']] = -1\n    # 5. Lac_sink: Lac_e ->\n    S[met_map['Lac_e'], rxn_map['Lac_sink']] = -1\n    # 6. CO2_sink: CO2_e ->\n    S[met_map['CO2_e'], rxn_map['CO2_sink']] = -1\n    # 7. M1_Glc_upt: Glc_e -> Glc1\n    S[met_map['Glc_e'], rxn_map['M1_Glc_upt']] = -1\n    S[met_map['Glc1'], rxn_map['M1_Glc_upt']] = 1\n    # 8. M1_Ace_upt: Ace_e -> Ace1\n    S[met_map['Ace_e'], rxn_map['M1_Ace_upt']] = -1\n    S[met_map['Ace1'], rxn_map['M1_Ace_upt']] = 1\n    # 9. M1_Lac_sec: Lac1 -> Lac_e\n    S[met_map['Lac1'], rxn_map['M1_Lac_sec']] = -1\n    S[met_map['Lac_e'], rxn_map['M1_Lac_sec']] = 1\n    # 10. M1_NH4_upt: NH4_e -> NH4_1\n    S[met_map['NH4_e'], rxn_map['M1_NH4_upt']] = -1\n    S[met_map['NH4_1'], rxn_map['M1_NH4_upt']] = 1\n    # 11. M2_Lac_upt: Lac_e -> Lac2\n    S[met_map['Lac_e'], rxn_map['M2_Lac_upt']] = -1\n    S[met_map['Lac2'], rxn_map['M2_Lac_upt']] = 1\n    # 12. M2_Ace_sec: Ace2 -> Ace_e\n    S[met_map['Ace2'], rxn_map['M2_Ace_sec']] = -1\n    S[met_map['Ace_e'], rxn_map['M2_Ace_sec']] = 1\n    # 13. M2_O2_upt: O2_e -> O2_2\n    S[met_map['O2_e'], rxn_map['M2_O2_upt']] = -1\n    S[met_map['O2_2'], rxn_map['M2_O2_upt']] = 1\n    # 14. M2_NH4_upt: NH4_e -> NH4_2\n    S[met_map['NH4_e'], rxn_map['M2_NH4_upt']] = -1\n    S[met_map['NH4_2'], rxn_map['M2_NH4_upt']] = 1\n    # 15. M1_ferm: Glc1 + 2 ADP1 + 2 Pi1 -> 2 Lac1 + 2 ATP1\n    S[met_map['Glc1'], rxn_map['M1_ferm']] = -1\n    S[met_map['ADP1'], rxn_map['M1_ferm']] = -2\n    S[met_map['Pi1'], rxn_map['M1_ferm']] = -2\n    S[met_map['Lac1'], rxn_map['M1_ferm']] = 2\n    S[met_map['ATP1'], rxn_map['M1_ferm']] = 2\n    # 16. M1_assim: Ace1 + ATP1 -> B1 + ADP1 + Pi1\n    S[met_map['Ace1'], rxn_map['M1_assim']] = -1\n    S[met_map['ATP1'], rxn_map['M1_assim']] = -1\n    S[met_map['B1'], rxn_map['M1_assim']] = 1\n    S[met_map['ADP1'], rxn_map['M1_assim']] = 1\n    S[met_map['Pi1'], rxn_map['M1_assim']] = 1\n    # 17. M1_biomass: B1 + NH4_1 + ATP1 -> ADP1 + Pi1\n    S[met_map['B1'], rxn_map['M1_biomass']] = -1\n    S[met_map['NH4_1'], rxn_map['M1_biomass']] = -1\n    S[met_map['ATP1'], rxn_map['M1_biomass']] = -1\n    S[met_map['ADP1'], rxn_map['M1_biomass']] = 1\n    S[met_map['Pi1'], rxn_map['M1_biomass']] = 1\n    # 18. M1_ATPM: ATP1 -> ADP1 + Pi1\n    S[met_map['ATP1'], rxn_map['M1_ATPM']] = -1\n    S[met_map['ADP1'], rxn_map['M1_ATPM']] = 1\n    S[met_map['Pi1'], rxn_map['M1_ATPM']] = 1\n    # 19. M2_ox: Lac2 + O2_2 + 3 ADP2 + 3 Pi2 -> Ace2 + 3 ATP2 + CO2_e\n    S[met_map['Lac2'], rxn_map['M2_ox']] = -1\n    S[met_map['O2_2'], rxn_map['M2_ox']] = -1\n    S[met_map['ADP2'], rxn_map['M2_ox']] = -3\n    S[met_map['Pi2'], rxn_map['M2_ox']] = -3\n    S[met_map['Ace2'], rxn_map['M2_ox']] = 1\n    S[met_map['ATP2'], rxn_map['M2_ox']] = 3\n    S[met_map['CO2_e'], rxn_map['M2_ox']] = 1\n    # 20. M2_bioprec: Lac2 + ATP2 -> B2 + ADP2 + Pi2 + CO2_e\n    S[met_map['Lac2'], rxn_map['M2_bioprec']] = -1\n    S[met_map['ATP2'], rxn_map['M2_bioprec']] = -1\n    S[met_map['B2'], rxn_map['M2_bioprec']] = 1\n    S[met_map['ADP2'], rxn_map['M2_bioprec']] = 1\n    S[met_map['Pi2'], rxn_map['M2_bioprec']] = 1\n    S[met_map['CO2_e'], rxn_map['M2_bioprec']] = 1\n    # 21. M2_biomass: B2 + NH4_2 + ATP2 -> ADP2 + Pi2\n    S[met_map['B2'], rxn_map['M2_biomass']] = -1\n    S[met_map['NH4_2'], rxn_map['M2_biomass']] = -1\n    S[met_map['ATP2'], rxn_map['M2_biomass']] = -1\n    S[met_map['ADP2'], rxn_map['M2_biomass']] = 1\n    S[met_map['Pi2'], rxn_map['M2_biomass']] = 1\n    # 22. M2_ATPM: ATP2 -> ADP2 + Pi2\n    S[met_map['ATP2'], rxn_map['M2_ATPM']] = -1\n    S[met_map['ADP2'], rxn_map['M2_ATPM']] = 1\n    S[met_map['Pi2'], rxn_map['M2_ATPM']] = 1\n\n    # Objective function: maximize mu1 + mu2, which means minimize -(mu1 + mu2)\n    # mu1 is v_M1_biomass (rxn 16), mu2 is v_M2_biomass (rxn 20)\n    c = np.zeros(num_reactions)\n    c[rxn_map['M1_biomass']] = -1\n    c[rxn_map['M2_biomass']] = -1\n\n    # Equality constraints S*v = 0\n    b_eq = np.zeros(num_metabolites)\n\n    # N is defined as 10^6\n    N = 10**6\n    large_bound = 10**6\n    \n    results = []\n    mu1_idx = rxn_map['M1_biomass']\n    mu2_idx = rxn_map['M2_biomass']\n\n    for G, O, A, L in test_cases:\n        # Bounds for fluxes: 0 <= v <= ub. All reactions are irreversible.\n        bounds = [(0, large_bound)] * num_reactions\n        bounds[rxn_map['Glc_src']] = (0, G)\n        bounds[rxn_map['O2_src']] = (0, O)\n        bounds[rxn_map['NH4_src']] = (0, N)\n        bounds[rxn_map['Ace_sink']] = (0, A)\n        bounds[rxn_map['Lac_sink']] = (0, L)\n        bounds[rxn_map['CO2_sink']] = (0, large_bound) # Was specified as 10^6\n\n        res = linprog(c, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs')\n\n        if res.success:\n            mu1 = res.x[mu1_idx] if res.x[mu1_idx] > 1e-9 else 0.0\n            mu2 = res.x[mu2_idx] if res.x[mu2_idx] > 1e-9 else 0.0\n            results.append([mu1, mu2])\n        else:\n            # Append null result if optimization fails\n            results.append([0.0, 0.0])\n    \n    # Format the final output string\n    output_parts = [f\"[{r[0]:.6f},{r[1]:.6f}]\" for r in results]\n    print(f\"[{','.join(output_parts)}]\")\n\nsolve()\n```", "id": "2617800"}]}