{"hands_on_practices": [{"introduction": "传粉综合征的演化根植于不同传粉者赋予植物的差异性适应度。本练习将选择压力的抽象概念置于能量这一具体可感的“通货”之中，通过一个生物能量学模型来定量地审视这一过程。你将为不同传粉者类群计算访问一次花朵的能量收益与成本的比率，从而识别出哪一个类群是最有效的传粉者，并因此可能成为观察到的花部性状背后最强的选择力量。这个练习旨在阐明，传粉者的形态和生理特征如何通过觅食效率，直接转化为对植物性状的定向选择压力。[@problem_id:2571665]", "problem": "一植物谱系表现出一系列与特化传粉综合征一致的花部性状：长管状、窄口径的花冠，红色反射且紫外对比度低，以及在黄昏时开始开花。为评估哪个传粉者功能群通过访花对这些性状施加最强的定向选择，请考虑以下基于能量平衡和最优觅食的场景。假设传粉者的行为旨在最大化每次访花获得的能量回报与该次访花消耗的能量成本之比，并且影响形态和时间的植物性状通过一个提取效率因子起作用，该因子将可用的花蜜能量按比例分配给特定的传粉者。\n\n该植物每朵花提供的花蜜体积为 $v = 2.0 \\times 10^{-2}\\,\\text{mL}$，糖质量分数为 $s = 0.20$，花蜜溶液密度为 $\\rho = 1.08\\,\\text{g}\\,\\text{mL}^{-1}$。将糖视为蔗糖，其可代谢能量密度为 $e_{s} = 1.65 \\times 10^{4}\\,\\text{J}\\,\\text{g}^{-1}$。忽略提取效率之外的热力学损失。传粉者单次访花的能量成本是其悬停或采蜜的代谢功率乘以在单朵花上的处理时间。\n\n考虑三个候选传粉者功能群，以 $i \\in \\{1,2,3\\}$ 为索引，其性状相关参数如下：\n\n- $i=1$ (长舌蜂)：提取效率 $\\eta_{1} = 0.30$，处理时间 $t_{1} = 2.0\\,\\text{s}$，代谢功率 $P_{1} = 0.10\\,\\text{J}\\,\\text{s}^{-1}$。\n- $i=2$ (天蛾)：提取效率 $\\eta_{2} = 0.85$，处理时间 $t_{2} = 1.6\\,\\text{s}$，代谢功率 $P_{2} = 0.25\\,\\text{J}\\,\\text{s}^{-1}$。\n- $i=3$ (蜂鸟)：提取效率 $\\eta_{3} = 0.70$，处理时间 $t_{3} = 1.2\\,\\text{s}$，代谢功率 $P_{3} = 0.60\\,\\text{J}\\,\\text{s}^{-1}$。\n\n仅使用生物能量学和最优觅食理论的基本定义，根据上述数据计算每个功能群 $i$ 的单次访花能量回报与单次访花能量成本之比。然后确定具有最大比率的功能群索引 $k^{\\ast} \\in \\{1,2,3\\}$。最终答案仅报告整数 $k^{\\ast}$，无需单位，也无需对整数进行舍入说明。", "solution": "推导过程源于能量平衡和最优觅食的基本原理。单次访花的能量回报等于传粉者实际提取的花蜜中所含的可代谢能量。单次访花的能量成本等于觅食期间的代谢功率乘以处理单朵花所花费的时间。\n\n首先，计算每朵花的糖质量。花蜜的体积为 $v$，密度为 $\\rho$，因此每朵花的花蜜溶液质量为\n$$\nm_{\\text{solution}} = v \\,\\rho,\n$$\n其中 $v = 2.0 \\times 10^{-2}\\,\\text{mL}$ 且 $\\rho = 1.08\\,\\text{g}\\,\\text{mL}^{-1}$。糖质量分数为 $s = 0.20$，因此每朵花的糖质量为\n$$\nm_{\\text{sugar}} = s \\, m_{\\text{solution}} = s \\, v \\,\\rho.\n$$\n该糖分的总可代谢能量为\n$$\nE_{\\text{nectar}} = m_{\\text{sugar}} \\, e_{s} = s \\, v \\,\\rho \\, e_{s},\n$$\n其中 $e_{s} = 1.65 \\times 10^{4}\\,\\text{J}\\,\\text{g}^{-1}$。\n\n功能群 $i$ 的传粉者仅能提取此能量的一部分，即比例 $\\eta_{i}$，因此其单次访花回报为\n$$\nR_{i} = \\eta_{i} \\, E_{\\text{nectar}} = \\eta_{i} \\, s \\, v \\,\\rho \\, e_{s}.\n$$\n其单次访花的能量成本为代谢功率乘以处理时间，\n$$\nC_{i} = P_{i} \\, t_{i}.\n$$\n因此，功能群 $i$ 的回报成本比为\n$$\nW_{i} = \\frac{R_{i}}{C_{i}} = \\frac{\\eta_{i} \\, s \\, v \\,\\rho \\, e_{s}}{P_{i} \\, t_{i}}.\n$$\n\n现在代入给定的数值来比较不同功能群的 $W_{i}$。\n\n计算共有的花蜜能量项：\n$$\nm_{\\text{sugar}} = s \\, v \\,\\rho = (0.20)\\,(2.0 \\times 10^{-2}\\,\\text{mL})\\,(1.08\\,\\text{g}\\,\\text{mL}^{-1}) = 4.32 \\times 10^{-3}\\,\\text{g}.\n$$\n然后\n$$\nE_{\\text{nectar}} = m_{\\text{sugar}} \\, e_{s} = (4.32 \\times 10^{-3}\\,\\text{g})\\,(1.65 \\times 10^{4}\\,\\text{J}\\,\\text{g}^{-1}) = 7.128 \\times 10^{1}\\,\\text{J} = 71.28\\,\\text{J}.\n$$\n\n为每个功能群计算 $W_{i}$：\n\n- 对于 $i=1$ (长舌蜂)：$\\eta_{1} = 0.30$, $t_{1} = 2.0\\,\\text{s}$, $P_{1} = 0.10\\,\\text{J}\\,\\text{s}^{-1}$。\n  回报：\n  $$\n  R_{1} = \\eta_{1} \\, E_{\\text{nectar}} = (0.30)\\,(71.28\\,\\text{J}) = 21.384\\,\\text{J}.\n  $$\n  成本：\n  $$\n  C_{1} = P_{1}\\, t_{1} = (0.10\\,\\text{J}\\,\\text{s}^{-1})\\,(2.0\\,\\text{s}) = 0.20\\,\\text{J}.\n  $$\n  比率：\n  $$ \n  W_{1} = \\frac{21.384\\,\\text{J}}{0.20\\,\\text{J}} = 106.92.\n  $$\n\n- 对于 $i=2$ (天蛾)：$\\eta_{2} = 0.85$, $t_{2} = 1.6\\,\\text{s}$, $P_{2} = 0.25\\,\\text{J}\\,\\text{s}^{-1}$。\n  回报：\n  $$\n  R_{2} = \\eta_{2} \\, E_{\\text{nectar}} = (0.85)\\,(71.28\\,\\text{J}) = 60.588\\,\\text{J}.\n  $$\n  成本：\n  $$\n  C_{2} = P_{2}\\, t_{2} = (0.25\\,\\text{J}\\,\\text{s}^{-1})\\,(1.6\\,\\text{s}) = 0.40\\,\\text{J}.\n  $$\n  比率：\n  $$\n  W_{2} = \\frac{60.588\\,\\text{J}}{0.40\\,\\text{J}} = 151.47.\n  $$\n\n- 对于 $i=3$ (蜂鸟)：$\\eta_{3} = 0.70$, $t_{3} = 1.2\\,\\text{s}$, $P_{3} = 0.60\\,\\text{J}\\,\\text{s}^{-1}$。\n  回报：\n  $$\n  R_{3} = \\eta_{3} \\, E_{\\text{nectar}} = (0.70)\\,(71.28\\,\\text{J}) = 49.896\\,\\text{J}.\n  $$\n  成本：\n  $$\n  C_{3} = P_{3}\\, t_{3} = (0.60\\,\\text{J}\\,\\text{s}^{-1})\\,(1.2\\,\\text{s}) = 0.72\\,\\text{J}.\n  $$\n  比率：\n  $$\n  W_{3} = \\frac{49.896\\,\\text{J}}{0.72\\,\\text{J}} = 69.3.\n  $$\n\n比较这些比率，$W_{2} = 151.47$ 是最大的，其次是 $W_{1} = 106.92$，然后是 $W_{3} = 69.3$。因此，具有最大回报成本比的功能群索引是\n$$\nk^{\\ast} = 2.\n$$\n根据给定的索引，这对应于天蛾，这也与性状描述中强调的黄昏开花和长管状形态相一致。所要求的最终答案是整数索引 $k^{\\ast}$。", "answer": "$$\\boxed{2}$$", "id": "2571665"}, {"introduction": "一旦我们理解了选择的生态学基础，下一步就是在一个种群中测量其强度和方向，并预测其演化后果。本练习将带你实践应用Lande-Arnold框架，这是数量演化遗传学的基石。通过一个假设的数据集，你将亲手计算选择差异和选择梯度，并运用多变量的育种家方程($\\Delta \\bar{\\mathbf{z}}=\\mathbf{G}\\boldsymbol{\\beta}$)来预测花部性状的短期演化响应。这项实践旨在让你熟练掌握从表型和适应度数据中量化自然选择并预测进化轨迹的关键技能。[@problem_id:2571671]", "problem": "一个目标植物物种表现出两种数量花部性状，这两种性状被认为是不同传粉综合征的基础：花冠管长度 $x$（单位：毫米）和花蜜蔗糖质量分数 $y$（无量纲分数）。在一个目标种群中，测量了六朵花的这些性状，并记录了优势传粉者功能群对每朵花的访问率。访问率已被标准化为相对适合度 $w$，使得样本的 $\\bar{w}=1$。个体 $i=1,\\dots,6$ 的测量数据如下：\n- $i=1$：$x=9$， $y=0.22$， $w=0.75$\n- $i=2$：$x=10$， $y=0.25$， $w=0.95$\n- $i=3$：$x=11$， $y=0.28$， $w=1.15$\n- $i=4$：$x=9$， $y=0.20$， $w=0.70$\n- $i=5$：$x=12$， $y=0.30$， $w=1.35$\n- $i=6$：$x=11$， $y=0.27$， $w=1.10$\n\n使用 Lande–Arnold 数量遗传学框架，从以下广泛接受的基础出发：\n- 相对适合度为 $w$，且 $\\bar{w}=1$。\n- （表型）选择差向量 $\\mathbf{S}$ 由性状与相对适合度之间的协方差定义，即对于性状 $z_{1}=x$ 和 $z_{2}=y$，其分量为 $S_{j}=\\operatorname{Cov}(z_{j},w)$。\n- 方向选择梯度向量 $\\boldsymbol{\\beta}$ 是在普通最小二乘法（OLS）下，$w$ 对各性状的偏回归系数向量。\n- 每代的短期进化响应为 $\\Delta \\bar{\\mathbf{z}}=\\mathbf{G}\\boldsymbol{\\beta}$，其中 $\\mathbf{G}$ 是加性遗传方差-协方差矩阵。\n\n对于此数据集，用有限样本均值估计期望值：对于任意变量 $a$ 和 $b$，样本量为 $n=6$，样本均值为 $\\bar{a}$ 和 $\\bar{b}$，使用 $\\widehat{\\operatorname{Cov}}(a,b)=\\frac{1}{n}\\sum_{i=1}^{n}(a_{i}-\\bar{a})(b_{i}-\\bar{b})$，并根据给定条件使用相对适合度的均值 $\\bar{w}=1$。计算：\n1. 选择差向量 $\\mathbf{S}$。\n2. 由 OLS 正规方程所隐含的方向选择梯度向量 $\\boldsymbol{\\beta}$。\n3. 使用给定的加性遗传方差-协方差矩阵\n$$\n\\mathbf{G}=\\begin{pmatrix}\n\\frac{1}{2} & \\frac{1}{100} \\\\[4pt]\n\\frac{1}{100} & \\frac{1}{4000}\n\\end{pmatrix}\n$$\n预测的单代响应 $\\Delta \\bar{\\mathbf{z}}$。\n\n将您的最终结果以单行矩阵的形式报告，顺序为 $\\big(S_{x},\\,S_{y},\\,\\beta_{x},\\,\\beta_{y},\\,\\Delta \\bar{z}_{x},\\,\\Delta \\bar{z}_{y}\\big)$，使用精确值（不进行四舍五入）。以毫米表示 $\\Delta \\bar{z}_{x}$，以每代性状分数表示 $\\Delta \\bar{z}_{y}$，但不要在最终答案框中包含单位。", "solution": "该问题要求根据 $n=6$ 个个体的样本，计算两个花部性状——花冠管长度 $x$ 和花蜜蔗糖分数 $y$ 的选择差向量 $\\mathbf{S}$、方向选择梯度向量 $\\boldsymbol{\\beta}$ 和预测进化响应向量 $\\Delta \\bar{\\mathbf{z}}$。\n\n给定的数据如下：\n个体 $i$ 的性状向量：$\\mathbf{z}_i = (x_i, y_i)^T$。\n个体 $i$ 的相对适合度：$w_i$。\n$i=1$：$x_1=9$， $y_1=0.22$， $w_1=0.75$\n$i=2$：$x_2=10$， $y_2=0.25$， $w_2=0.95$\n$i=3$：$x_3=11$， $y_3=0.28$， $w_3=1.15$\n$i=4$：$x_4=9$， $y_4=0.20$， $w_4=0.70$\n$i=5$：$x_5=12$， $y_5=0.30$， $w_5=1.35$\n$i=6$：$x_6=11$， $y_6=0.27$， $w_6=1.10$\n\n问题指定使用协方差估计量 $\\widehat{\\operatorname{Cov}}(a,b)=\\frac{1}{n}\\sum_{i=1}^{n}(a_{i}-\\bar{a})(b_{i}-\\bar{b})$。样本量为 $n=6$。给定的平均相对适合度为 $\\bar{w}=1$。\n\n首先，我们计算性状 $x$ 和 $y$ 的样本均值。\n$$ \\bar{x} = \\frac{1}{6} \\sum_{i=1}^{6} x_i = \\frac{1}{6}(9+10+11+9+12+11) = \\frac{62}{6} = \\frac{31}{3} $$\n$$ \\bar{y} = \\frac{1}{6} \\sum_{i=1}^{6} y_i = \\frac{1}{6}(0.22+0.25+0.28+0.20+0.30+0.27) = \\frac{1.52}{6} = \\frac{152}{600} = \\frac{19}{75} $$\n\n第 1 部分：选择差向量 $\\mathbf{S}$\n性状 $z_j$ 的选择差定义为 $S_j = \\operatorname{Cov}(z_j, w)$。给定 $\\bar{w}=1$，协方差简化为 $\\operatorname{Cov}(z_j, w) = \\frac{1}{n}\\sum(z_{ji} - \\bar{z}_j)(w_i-1) = \\frac{1}{n}(\\sum z_{ji} w_i - \\sum z_{ji}) = \\frac{1}{n}\\sum z_{ji} w_i - \\bar{z}_j$。\n\n对于性状 $x$：\n$$ \\sum_{i=1}^{6} x_i w_i = (9)(0.75) + (10)(0.95) + (11)(1.15) + (9)(0.70) + (12)(1.35) + (11)(1.10) $$\n$$ = 6.75 + 9.5 + 12.65 + 6.3 + 16.2 + 12.1 = 63.5 = \\frac{127}{2} $$\n$$ S_x = \\operatorname{Cov}(x, w) = \\frac{1}{6} \\left(\\frac{127}{2}\\right) - \\bar{x} = \\frac{127}{12} - \\frac{31}{3} = \\frac{127 - 124}{12} = \\frac{3}{12} = \\frac{1}{4} $$\n\n对于性状 $y$：\n$$ \\sum_{i=1}^{6} y_i w_i = (0.22)(0.75) + (0.25)(0.95) + (0.28)(1.15) + (0.20)(0.70) + (0.30)(1.35) + (0.27)(1.10) $$\n$$ = 0.165 + 0.2375 + 0.322 + 0.140 + 0.405 + 0.297 = 1.5665 = \\frac{3133}{2000} $$\n$$ S_y = \\operatorname{Cov}(y, w) = \\frac{1}{6} \\left(\\frac{3133}{2000}\\right) - \\bar{y} = \\frac{3133}{12000} - \\frac{19}{75} = \\frac{3133 - 19 \\cdot 160}{12000} = \\frac{3133 - 3040}{12000} = \\frac{93}{12000} = \\frac{31}{4000} $$\n选择差向量为 $\\mathbf{S} = \\begin{pmatrix} S_x \\\\ S_y \\end{pmatrix} = \\begin{pmatrix} 1/4 \\\\ 31/4000 \\end{pmatrix}$。\n\n第 2 部分：方向选择梯度向量 $\\boldsymbol{\\beta}$\n选择梯度向量由 $\\boldsymbol{\\beta} = \\mathbf{P}^{-1} \\mathbf{S}$ 给出，其中 $\\mathbf{P}$ 是性状的表型方差-协方差矩阵。$\\mathbf{P}$ 的元素为 $P_{11} = \\operatorname{Var}(x)$，$P_{22} = \\operatorname{Var}(y)$ 和 $P_{12} = \\operatorname{Cov}(x, y)$。我们使用指定的估计量，因此 $\\operatorname{Var}(z) = \\frac{1}{n} \\sum z_i^2 - \\bar{z}^2$。\n\n$$ \\sum x_i^2 = 9^2+10^2+11^2+9^2+12^2+11^2 = 81+100+121+81+144+121 = 648 $$\n$$ P_{11} = \\operatorname{Var}(x) = \\frac{648}{6} - \\left(\\frac{31}{3}\\right)^2 = 108 - \\frac{961}{9} = \\frac{972-961}{9} = \\frac{11}{9} $$\n$$ \\sum y_i^2 = 0.22^2+0.25^2+0.28^2+0.20^2+0.30^2+0.27^2 = 0.0484+0.0625+0.0784+0.0400+0.0900+0.0729 = 0.3922 = \\frac{1961}{5000} $$\n$$ P_{22} = \\operatorname{Var}(y) = \\frac{1}{6}\\frac{1961}{5000} - \\left(\\frac{19}{75}\\right)^2 = \\frac{1961}{30000} - \\frac{361}{5625} = \\frac{1961 \\cdot 3 - 361 \\cdot 16}{90000} = \\frac{5883 - 5776}{90000} = \\frac{107}{90000} $$\n$$ \\sum x_i y_i = (9)(0.22)+(10)(0.25)+(11)(0.28)+(9)(0.20)+(12)(0.30)+(11)(0.27) = 1.98+2.5+3.08+1.8+3.6+2.97 = 15.93 = \\frac{1593}{100} $$\n$$ P_{12} = \\operatorname{Cov}(x,y) = \\frac{1}{6}\\frac{1593}{100} - \\left(\\frac{31}{3}\\right)\\left(\\frac{19}{75}\\right) = \\frac{531}{200} - \\frac{589}{225} = \\frac{531 \\cdot 9 - 589 \\cdot 8}{1800} = \\frac{4779-4712}{1800} = \\frac{67}{1800} $$\n表型方差-协方差矩阵为 $\\mathbf{P} = \\begin{pmatrix} 11/9 & 67/1800 \\\\ 67/1800 & 107/90000 \\end{pmatrix}$。\n行列式为 $\\det(\\mathbf{P}) = \\left(\\frac{11}{9}\\right)\\left(\\frac{107}{90000}\\right) - \\left(\\frac{67}{1800}\\right)^2 = \\frac{1177}{810000} - \\frac{4489}{3240000} = \\frac{4 \\cdot 1177 - 4489}{3240000} = \\frac{4708-4489}{3240000} = \\frac{219}{3240000} = \\frac{73}{1080000}$。\n逆矩阵为 $\\mathbf{P}^{-1} = \\frac{1}{\\det(\\mathbf{P})} \\begin{pmatrix} P_{22} & -P_{12} \\\\ -P_{12} & P_{11} \\end{pmatrix} = \\frac{1080000}{73} \\begin{pmatrix} 107/90000 & -67/1800 \\\\ -67/1800 & 11/9 \\end{pmatrix} = \\frac{1}{73} \\begin{pmatrix} 1284 & -40200 \\\\ -40200 & 1320000 \\end{pmatrix}$。\n现在我们计算 $\\boldsymbol{\\beta} = \\mathbf{P}^{-1} \\mathbf{S}$：\n$$ \\begin{pmatrix} \\beta_x \\\\ \\beta_y \\end{pmatrix} = \\frac{1}{73} \\begin{pmatrix} 1284 & -40200 \\\\ -40200 & 1320000 \\end{pmatrix} \\begin{pmatrix} 1/4 \\\\ 31/4000 \\end{pmatrix} = \\frac{1}{73} \\begin{pmatrix} 1284 \\cdot \\frac{1}{4} - 40200 \\cdot \\frac{31}{4000} \\\\ -40200 \\cdot \\frac{1}{4} + 1320000 \\cdot \\frac{31}{4000} \\end{pmatrix} $$\n$$ \\beta_x = \\frac{1}{73} \\left(321 - \\frac{4020 \\cdot 31}{400}\\right) = \\frac{1}{73} \\left(321 - \\frac{201 \\cdot 31}{20}\\right) = \\frac{1}{73} \\left(\\frac{6420 - 6231}{20}\\right) = \\frac{1}{73}\\left(\\frac{189}{20}\\right) = \\frac{189}{1460} $$\n$$ \\beta_y = \\frac{1}{73} \\left(-10050 + \\frac{1320 \\cdot 31}{4}\\right) = \\frac{1}{73} (-10050 + 330 \\cdot 31) = \\frac{1}{73} (-10050 + 10230) = \\frac{180}{73} $$\n选择梯度向量为 $\\boldsymbol{\\beta} = \\begin{pmatrix} 189/1460 \\\\ 180/73 \\end{pmatrix}$。\n\n第 3 部分：预测的单代响应 $\\Delta \\bar{\\mathbf{z}}$\n选择响应由 $\\Delta \\bar{\\mathbf{z}} = \\mathbf{G}\\boldsymbol{\\beta}$ 给出，其中给定的加性遗传方差-协方差矩阵为 $\\mathbf{G} = \\begin{pmatrix} 1/2 & 1/100 \\\\ 1/100 & 1/4000 \\end{pmatrix}$。\n$$ \\begin{pmatrix} \\Delta\\bar{z}_x \\\\ \\Delta\\bar{z}_y \\end{pmatrix} = \\begin{pmatrix} 1/2 & 1/100 \\\\ 1/100 & 1/4000 \\end{pmatrix} \\begin{pmatrix} 189/1460 \\\\ 180/73 \\end{pmatrix} $$\n$$ \\Delta\\bar{z}_x = \\left(\\frac{1}{2}\\right)\\left(\\frac{189}{1460}\\right) + \\left(\\frac{1}{100}\\right)\\left(\\frac{180}{73}\\right) = \\frac{189}{2920} + \\frac{180}{7300} = \\frac{189 \\cdot 5 + 180 \\cdot 2}{14600} = \\frac{945+360}{14600} = \\frac{1305}{14600} = \\frac{261}{2920} $$\n$$ \\Delta\\bar{z}_y = \\left(\\frac{1}{100}\\right)\\left(\\frac{189}{1460}\\right) + \\left(\\frac{1}{4000}\\right)\\left(\\frac{180}{73}\\right) = \\frac{189}{146000} + \\frac{180}{292000} = \\frac{2 \\cdot 189 + 180}{292000} = \\frac{378+180}{292000} = \\frac{558}{292000} = \\frac{279}{146000} $$\n预测的响应向量为 $\\Delta\\bar{\\mathbf{z}} = \\begin{pmatrix} 261/2920 \\\\ 279/146000 \\end{pmatrix}$。\n\n按要求顺序汇总的最终结果是：\n$S_x = \\frac{1}{4}$\n$S_y = \\frac{31}{4000}$\n$\\beta_x = \\frac{189}{1460}$\n$\\beta_y = \\frac{180}{73}$\n$\\Delta\\bar{z}_x = \\frac{261}{2920}$\n$\\Delta\\bar{z}_y = \\frac{279}{146000}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{4} & \\frac{31}{4000} & \\frac{189}{1460} & \\frac{180}{73} & \\frac{261}{2920} & \\frac{279}{146000} \\end{pmatrix}}\n$$", "id": "2571671"}]}