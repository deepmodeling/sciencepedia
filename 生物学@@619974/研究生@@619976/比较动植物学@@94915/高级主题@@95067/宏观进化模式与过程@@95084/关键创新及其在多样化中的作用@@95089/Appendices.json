{"hands_on_practices": [{"introduction": "要理解多样化过程，最简单的方法是从纯出生模型（或称Yule过程）开始。这个练习将帮助你建立关于随机谱系形成事件如何随时间累积的直观认识。通过计算一个谱系中下一次谱系形成事件的期望等待时间，你将亲自推导出谱系大小本身如何影响整个谱系多样化速度的基本原理，这是理解更复杂模型的基础。[@problem_id:2584181]", "problem": "一个植物支系获得了一项关键的花部创新，据推测这提高了其相对于祖先的物种形成速率。在该创新之后，物种分化被模拟为一个纯生长的尤尔过程，其中每个现存谱系都根据一个泊松过程独立地产生新谱系（物种形成），其单位谱系速率 $\\lambda$ （事件/百万年）是一个常数。假设创新后的速率估计为 $\\lambda = 0.3\\,\\mathrm{Myr}^{-1}$，并且目前有 $N$ 个现存谱系是由携带该创新的祖先繁衍而来。\n\n仅使用泊松过程和指数等待时间的基本性质，从第一性原理推导出从现在到该支系中任何地方发生下一次物种形成事件的期望等待时间。将你的最终答案以百万年（Myr）为单位，表示为一个关于 $N$ 的简化代数表达式，且不进行四舍五入。", "solution": "经评估，该问题陈述是有效的。这是一个良定的、具有科学依据的数学生物学问题，需要应用随机过程的基本原理，特别是泊松分布和指数分布的性质。\n\n让我们从第一性原理开始推导。\n\n问题陈述中有 $N$ 个现存谱系构成一个支系。每个谱系的物种形成是一个独立过程，以恒定的单位谱系速率 $\\lambda$ 发生。这被模拟为一个泊松过程。\n\n速率为 $r$ 的泊松过程的一个基本性质是，到下一个事件发生的等待时间遵循速率参数同为 $r$ 的指数分布。这种过程的概率密度函数 (PDF) 为 $f(t) = r e^{-rt}$ （当 $t \\ge 0$），其期望值为 $E[T] = \\frac{1}{r}$。\n\n设 $T_i$ 是表示谱系 $i$（其中 $i \\in \\{1, 2, \\dots, N\\}$）发生下一次物种形成事件的等待时间的随机变量。由于每个谱系都根据速率为 $\\lambda$ 的泊松过程进行物种形成，因此每个 $T_i$ 都是一个独立同分布 (i.i.d.) 的随机变量，遵循速率为 $\\lambda$ 的指数分布。\n$$T_i \\sim \\text{Exponential}(\\lambda)$$\n每个 $T_i$ 的生存函数，即等待时间大于某个时间 $t$ 的概率，由下式给出：\n$$P(T_i > t) = \\exp(-\\lambda t)$$\n这等价于在时间区间 $[0, t]$ 内观测到谱系 $i$ 发生零次物种形成事件的概率。\n\n问题要求的是直到支系中*任何地方*发生*下一次*物种形成事件的期望等待时间。设这个等待时间由随机变量 $T_{clade}$ 表示。该事件对应于所有 $N$ 个谱系中发生的*第一个*物种形成事件。因此，$T_{clade}$ 是各个独立等待时间 $T_1, T_2, \\dots, T_N$ 的最小值。\n$$T_{clade} = \\min(T_1, T_2, \\dots, T_N)$$\n为了求出 $T_{clade}$ 的分布，我们首先推导其生存函数 $P(T_{clade} > t)$。事件 $T_{clade} > t$ 发生的条件是当且仅当*每个*谱系的等待时间都大于 $t$。这意味着 $T_1 > t$ 且 $T_2 > t$ 且 ... 且 $T_N > t$。\n$$P(T_{clade} > t) = P(T_1 > t, T_2 > t, \\dots, T_N > t)$$\n由于每个谱系的物种形成过程是独立的，所以联合概率是各个独立概率的乘积：\n$$P(T_{clade} > t) = \\prod_{i=1}^{N} P(T_i > t)$$\n由于所有 $T_i$ 都是同分布的，因此对所有 $i$ 都有 $P(T_i > t) = \\exp(-\\lambda t)$。将此代入乘积中，得到：\n$$P(T_{clade} > t) = \\prod_{i=1}^{N} \\exp(-\\lambda t) = (\\exp(-\\lambda t))^N = \\exp(-N \\lambda t)$$\n这个表达式 $P(T_{clade} > t) = \\exp(-(N\\lambda)t)$ 是一个速率参数等于 $N\\lambda$ 的指数分布的生存函数。这证明了这样一个性质：$N$ 个速率为 $\\lambda$ 的独立同分布指数随机变量的最小值本身也是一个速率为 $N\\lambda$ 的指数随机变量。整个支系的组合物种形成过程是一个总速率为 $\\lambda_{clade} = N\\lambda$ 的泊松过程。\n\n速率参数为 $r$ 的指数分布的期望值（或均值）是 $\\frac{1}{r}$。因此，支系中直到下一次物种形成事件的期望等待时间是：\n$$E[T_{clade}] = \\frac{1}{N\\lambda}$$\n问题给出了单位谱系物种形成速率 $\\lambda = 0.3\\,\\mathrm{Myr}^{-1}$。我们被要求给出一个关于 $N$ 的代数表达式。代入 $\\lambda$ 的值：\n$$E[T_{clade}] = \\frac{1}{N \\cdot 0.3}$$\n为了将其表示为一个简化的代数表达式，我们可以将 $0.3$ 写成分数 $\\frac{3}{10}$：\n$$E[T_{clade}] = \\frac{1}{N \\left(\\frac{3}{10}\\right)} = \\frac{10}{3N}$$\n该表达式的单位是百万年（Myr），因为速率 $\\lambda$ 的单位是 $\\mathrm{Myr}^{-1}$。这就是从第一性原理推导出的所要求的结果。", "answer": "$$\\boxed{\\frac{10}{3N}}$$", "id": "2584181"}, {"introduction": "在现实世界中，谱系不仅经历谱系形成，也面临灭绝。该练习引入了更符合实际的出生-死亡模型，并介绍了其核心参数——净多样化速率 ($r = \\lambda - \\mu$)。通过在一个经典的植物学案例（C4与C3光合作用）中比较有无关键创新的谱系之间的净多样化速率，你将学会如何量化一项创新在宏观演化尺度上的预期影响。[@problem_id:2584173]", "problem": "在比较植物学中，C4光合途径的演化通常被视为一种可能改变宏观演化速率的关键创新。考虑一个用于分支多样化的恒定速率出生–死亡过程，其中每谱系物种形成速率表示为 $\\lambda$，每谱系灭绝速率表示为 $\\mu$。对于一个在时间 $t=0$ 时起始有 $N_{0}$ 个谱系的分支，假设在标准的出生–死亡框架下，时间 $t$ 时的预期谱系数量由每谱系出生和死亡之间的平衡决定。\n\n定义净多样化速率为 $r=\\lambda-\\mu$。一个分支类型相对于另一个分支类型的预期净多样化优势是它们净多样化速率的差值。给定以下恒定速率（单位为 $\\mathrm{Myr}^{-1}$，其中 $\\mathrm{Myr}$ 表示百万年）：$\\lambda_{\\mathrm{C4}}=0.4$，$\\mu_{\\mathrm{C4}}=0.05$，$\\lambda_{\\mathrm{C3}}=0.25$，以及 $\\mu_{\\mathrm{C3}}=0.1$。在上述假设下，计算C4相对于C3的预期净多样化优势，并以 $\\mathrm{Myr}^{-1}$ 为单位表示结果。在最终答案框中仅提供数值，不带单位。无需四舍五入。\n\n此外，请使用出生–死亡过程框架，简要讨论为什么即使不同分支的 $r$ 值相等，由于随机性，其实现的分支大小仍可能随时间产生巨大差异，并指出至少一个可以捕捉这种不确定性的量。您的讨论不影响数值答案。", "solution": "该问题要求计算两类分支（C4和C3）之间的净多样化优势，并讨论出生–死亡过程框架中的随机性。该问题陈述清晰，并基于宏观演化模型的既定原则。\n\n分析基于一个恒定速率的出生–死亡过程，其中 $\\lambda$ 表示每谱系物种形成速率，$\\mu$ 表示每谱系灭绝速率。净多样化速率 $r$ 定义为这些速率之差：\n$$r = \\lambda - \\mu$$\n这个参数 $r$ 决定了谱系数量随时间变化的预期速率。\n\n问题提供了以下恒定速率，单位为 $\\mathrm{Myr}^{-1}$：\n对于C4分支：\n$\\lambda_{\\mathrm{C4}} = 0.4$\n$\\mu_{\\mathrm{C4}} = 0.05$\n\n对于C3分支：\n$\\lambda_{\\mathrm{C3}} = 0.25$\n$\\mu_{\\mathrm{C3}} = 0.1$\n\n首先，我们计算C4分支的净多样化速率，记为 $r_{\\mathrm{C4}}$。使用给定的值：\n$$r_{\\mathrm{C4}} = \\lambda_{\\mathrm{C4}} - \\mu_{\\mathrm{C4}} = 0.4 - 0.05 = 0.35$$\n该速率的单位是 $\\mathrm{Myr}^{-1}$。\n\n接下来，我们对C3分支进行相同的计算，以求得其净多样化速率 $r_{\\mathrm{C3}}$：\n$$r_{\\mathrm{C3}} = \\lambda_{\\mathrm{C3}} - \\mu_{\\mathrm{C3}} = 0.25 - 0.1 = 0.15$$\n该速率的单位也是 $\\mathrm{Myr}^{-1}$。\n\n问题将C4相对于C3的预期净多样化优势定义为它们各自净多样化速率的差值。设此优势为 $\\Delta r$。我们计算如下：\n$$\\Delta r = r_{\\mathrm{C4}} - r_{\\mathrm{C3}}$$\n代入我们计算出的值：\n$$\\Delta r = 0.35 - 0.15 = 0.2$$\n最终的净多样化优势是 $0.2 \\, \\mathrm{Myr}^{-1}$。\n\n对于问题的第二部分，我们必须讨论为什么相等的 $r$ 值会导致实现的分支大小出现巨大差异。这是出生–死亡过程随机性的直接结果。在时间 $t$ 时的谱系数量 $N(t)$ 是一个随机变量，而不是一个确定性的量。净多样化速率 $r$ 仅决定了谱系的预期数量，对于在 $t=0$ 时有初始谱系数量 $N_0$ 的情况，其预期数量由下式给出：\n$$E[N(t)] = N_0 \\exp(rt)$$\n然而，任何单一的演化历史（过程的一次实现）都可能并且将会偏离这一平均轨迹。具有相同参数，因此具有相同 $r$ 值的两个分支，可能由于偶然性而产生截然不同的结果。一个分支可能经历一系列早期的物种形成事件并广泛辐射，而另一个则可能遭遇早期灭绝并走向消亡。\n\n一个能够捕捉此过程中内在不确定性的量是谱系数量的方差 $\\mathrm{Var}[N(t)]$。对于从单一谱系（$N_0=1$）开始的过程，方差为：\n$$\\mathrm{Var}[N(t)] = \\frac{\\lambda+\\mu}{\\lambda-\\mu} \\exp(rt) (\\exp(rt) - 1)$$\n这个方程表明，方差不仅取决于净多样化速率 $r=\\lambda-\\mu$，还取决于更替速率，即速率之和 $\\lambda+\\mu$。因此，两个分支可以有相同的净多样化速率 $r$ 但有不同的更替速率。更替速率较高的分支将经历更大的随机性，意味着其大小 $N(t)$ 的可能结果范围更广。因此，更替速率 $\\lambda+\\mu$ 是一个关键参数，它捕捉了除由 $r$ 决定的期望之外，多样化动态中的随机不确定性水平。另一个这样的量是一个谱系最终灭绝的概率 $\\frac{\\mu}{\\lambda}$，即使在净多样化速率为正（$r>0$，即 $\\lambda>\\mu$）的情况下，这个概率也非零。这突显了随机模型中固有的持续性灭绝风险。", "answer": "$$\\boxed{0.2}$$", "id": "2584173"}, {"introduction": "在构建了多样化理论模型之后，关键的下一步是用经验数据来检验这些模型。本练习将向你介绍一种强大的统计工具——贝叶斯因子 (Bayes factor)，它用于比较不同演化模型与系统发育树的拟合程度。通过计算和解释贝叶斯因子，你将学会如何正式评估统计证据，以判断一项关键创新是否真正导致了多样化速率的转变。[@problem_id:2584203]", "problem": "一项针对一个大型被子植物分支的宏观演化研究，评估了一个假定的关键创新（例如，花蜜距的起源）是否与多样化速率的单次转变相关。研究使用具有均等先验几率的贝叶斯模型比较方法，比较了两个嵌套的生死模型：模型 $\\mathcal{M}_{0}$ 假设整个系统发育史中的多样化速率恒定（无转变）；模型 $\\mathcal{M}_{1}$ 允许在推断的关键创新起源处发生一次多样化速率转变。通过热力学积分程序估计边际似然（模型证据），并总结为对数证据：模型 $\\mathcal{M}_{1}$ 为 $\\log \\mathcal{Z}_{1} = -1234.5$，模型 $\\mathcal{M}_{0}$ 为 $\\log \\mathcal{Z}_{0} = -1240.9$。从边际似然的定义和贝叶斯因子作为模型证据之比的定义出发，使用第一性原理的贝叶斯模型比较方法，计算支持模型 $\\mathcal{M}_{1}$ 相对于 $\\mathcal{M}_{0}$ 的贝叶斯因子。然后，根据贝叶斯模型选择中广泛使用的解释惯例，简要说明与该关键创新相关的单次多样化速率转变的证据是弱、中等、强还是决定性的。将贝叶斯因子以无量纲比率的形式报告，并四舍五入至三位有效数字。", "solution": "该问题要求基于提供的对数证据，计算并解释贝叶斯因子，以比较两个相互竞争的宏观演化模型 $\\mathcal{M}_{1}$ 和 $\\mathcal{M}_{0}$。我们从贝叶斯模型比较的基本原理入手。\n\n设 $D$ 表示观测数据，在本例中为系统发育树及任何相关的性状数据。模型 $\\mathcal{M}_{i}$ 的后验概率由贝叶斯定理给出：\n$$P(\\mathcal{M}_{i}|D) = \\frac{P(D|\\mathcal{M}_{i}) P(\\mathcal{M}_{i})}{P(D)}$$\n其中 $P(D|\\mathcal{M}_{i})$ 是边际似然或模型证据，$P(\\mathcal{M}_{i})$ 是模型的先验概率，$P(D)$ 是一个归一化常数。\n\n为了比较两个模型 $\\mathcal{M}_{1}$ 和 $\\mathcal{M}_{0}$，我们考察它们的后验概率之比，即后验几率：\n$$\\frac{P(\\mathcal{M}_{1}|D)}{P(\\mathcal{M}_{0}|D)} = \\frac{P(D|\\mathcal{M}_{1})}{P(D|\\mathcal{M}_{0})} \\times \\frac{P(\\mathcal{M}_{1})}{P(\\mathcal{M}_{0})}$$\n该关系可表述为：后验几率 = 贝叶斯因子 × 先验几率。\n\n贝叶斯因子（记为 $B_{10}$）是边际似然的比值：\n$$B_{10} = \\frac{P(D|\\mathcal{M}_{1})}{P(D|\\mathcal{M}_{0})}$$\n题目以符号 $\\mathcal{Z}_{i}$ 提供了模型证据，其中 $\\mathcal{Z}_{i} \\equiv P(D|\\mathcal{M}_{i})$。因此，支持 $\\mathcal{M}_{1}$ 相对于 $\\mathcal{M}_{0}$ 的贝叶斯因子是：\n$$B_{10} = \\frac{\\mathcal{Z}_{1}}{\\mathcal{Z}_{0}}$$\n题目提供了对数证据 $\\log \\mathcal{Z}_{1}$ 和 $\\log \\mathcal{Z}_{0}$。在贝叶斯统计学和诸如热力学积分等方法的背景下，符号“$\\log$”通常指自然对数 $\\ln$。我们将在此标准且必要的假设下进行计算。\n\n为计算 $B_{10}$，我们首先对该表达式取自然对数：\n$$\\ln(B_{10}) = \\ln\\left(\\frac{\\mathcal{Z}_{1}}{\\mathcal{Z}_{0}}\\right) = \\ln(\\mathcal{Z}_{1}) - \\ln(\\mathcal{Z}_{0})$$\n给定的值为 $\\ln(\\mathcal{Z}_{1}) = -1234.5$ 和 $\\ln(\\mathcal{Z}_{0}) = -1240.9$。将这些值代入方程：\n$$\\ln(B_{10}) = -1234.5 - (-1240.9) = -1234.5 + 1240.9 = 6.4$$\n为了求出贝叶斯因子 $B_{10}$，我们对结果取指数：\n$$B_{10} = \\exp(\\ln(B_{10})) = \\exp(6.4)$$\n计算数值：\n$$B_{10} \\approx 601.845$$\n题目要求答案四舍五入至三位有效数字。\n$$B_{10} \\approx 602$$\n贝叶斯因子是一个无量纲的比率。$B_{10} \\approx 602$ 的值表明，在模型 $\\mathcal{M}_{1}$（存在速率转变）下，观测数据出现的概率大约是在模型 $\\mathcal{M}_{0}$（速率恒定）下的 $602$ 倍。\n\n在解释方面，我们使用公认的惯例，例如 Kass and Raftery (1995) 提出的量表。在该量表上，贝叶斯因子 $B_{10} > 150$ 被认为提供了支持模型 $\\mathcal{M}_{1}$ 的“非常强”或“决定性”的证据。由于我们计算出的值为 $B_{10} \\approx 602$，远大于 $150$，因此与该关键创新相关的单次多样化速率转变的证据是决定性的。另一种方法是使用 $2\\ln(B_{10})$ 这个量，其值为 $2 \\times 6.4 = 12.8$。在该量表上，大于 $10$ 的值也被认为是决定性证据，这证实了我们的结论。", "answer": "$$\\boxed{602}$$", "id": "2584203"}]}