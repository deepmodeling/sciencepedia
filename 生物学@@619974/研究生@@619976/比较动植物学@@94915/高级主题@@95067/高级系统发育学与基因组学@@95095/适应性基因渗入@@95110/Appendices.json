{"hands_on_practices": [{"introduction": "在研究适应性基因渗入时，首要任务是检测其是否存在。ABBA-BABA检验和$D$-统计量是识别物种间基因流的强大工具，它通过比较基因组中两种不一致的谱系拓扑模式的数量来量化不对称性。为了确保观察到的信号不是随机波动，我们必须评估其统计显著性；本练习将引导你使用块式刀切法（block-jackknife）来估计$D$-统计量的方差并检验其显著性，这是群体基因组学中的一项核心技能。[@problem_id:2544491]", "problem": "为检验适应性基因渗入，使用全基因组范围的双等位基因单核苷酸多态性（SNPs）进行了一项四分类单元检验，这些SNPs被排列成不重叠的物理区块以考虑连锁问题。这些分类单元的排列方式为$\\left(P_{1},P_{2},P_{3};O\\right)$，其中$O$是一个外类群。在没有基因渗入而只有不完全谱系分选（ILS）的原假设下，位点模式$\\mathrm{ABBA}$和$\\mathrm{BABA}$的期望计数是相等的。D-统计量量化了这些计数中的不对称性。基因组被分割成$B=50$个等长的区块，用于区块重抽样。\n\n在整个数据集中，总计数为$\\mathrm{ABBA}=320$和$\\mathrm{BABA}=280$。为了评估不确定性，执行了删一区块刀切法（每次剔除一个区块）。设$\\hat{D}_{(-b)}$表示从移除了区块$b$的数据中计算出的D-统计量，并设$\\bar{D}_{\\mathrm{LOO}}=\\frac{1}{B}\\sum_{b=1}^{B}\\hat{D}_{(-b)}$为留一法估计值的均值。从$B=50$个留一法重抽样样本中，观测到的离差平方和为\n$$\n\\sum_{b=1}^{B}\\left(\\hat{D}_{(-b)}-\\bar{D}_{\\mathrm{LOO}}\\right)^{2}=2.296\\times 10^{-4}.\n$$\n\n仅使用$\\mathrm{ABBA}$–$\\mathrm{BABA}$框架和删一刀切法背后的基本定义，完成以下任务：\n- 从总计数中推导出全基因组D-统计量的表达式，并计算其值。\n- 从删一刀切法方差估计量的定义出发，用$B$和留一法偏差推导该估计量的表达式，然后计算刀切法标准误以及用于检验原假设$D=0$的相应$Z$-分数。\n\n将你的最终答案以行矩阵$\\left[D,\\;Z\\right]$的形式报告，其中两个元素都四舍五入到四位有效数字，并以纯小数形式表示（无单位）。", "solution": "该问题陈述具有科学依据，提法明确，客观，并包含了完整解答所需的所有必要信息。它描述了D-统计量（ABBA-BABA检验）与用于方差估计的区块刀切法程序的标准应用，这些都是群体基因组学中的成熟方法。所提供的数据是一致且合理的。因此，我们将进行完整的推导和计算。\n\n首先，我们推导并计算全基因组D-统计量，记作$\\hat{D}$。该统计量量化了由$\\mathrm{ABBA}$和$\\mathrm{BABA}$位点模式所代表的两种备选基因树拓扑计数之间的不对称性。设$n_{\\mathrm{ABBA}}$和$n_{\\mathrm{BABA}}$为整个基因组上这些模式的总计数。D-统计量定义为这些计数的归一化差异：\n$$\n\\hat{D} = \\frac{n_{\\mathrm{ABBA}} - n_{\\mathrm{BABA}}}{n_{\\mathrm{ABBA}} + n_{\\mathrm{BABA}}}\n$$\n问题提供了总计数：$n_{\\mathrm{ABBA}} = 320$和$n_{\\mathrm{BABA}} = 280$。将这些值代入公式可得：\n$$\n\\hat{D} = \\frac{320 - 280}{320 + 280} = \\frac{40}{600} = \\frac{1}{15}\n$$\n其数值为$\\hat{D} \\approx 0.066667$。\n\n接下来，我们使用删一区块刀切法来处理不确定性估计和假设检验问题。题目要求我们推导方差估计量。设$\\hat{D}$是从包含$B$个区块的完整数据集中计算出的统计量，$\\hat{D}_{(-b)}$是省略区块$b$后重新计算的统计量。对于每个区块$b \\in \\{1, 2, ..., B\\}$，刀切法伪值$J_b$定义为：\n$$\nJ_b = B \\hat{D} - (B-1)\\hat{D}_{(-b)}\n$$\n$\\hat{D}$的刀切法方差估计量由伪值的样本方差除以区块数$B$给出：\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{1}{B(B-1)} \\sum_{b=1}^{B} (J_b - \\bar{J})^2\n$$\n其中$\\bar{J}$是伪值的均值，$\\bar{J} = \\frac{1}{B}\\sum_{b=1}^{B} J_b$。为了继续推导，我们将此方差用留一法估计值$\\hat{D}_{(-b)}$来表示。首先，我们求出伪值均值$\\bar{J}$：\n$$\n\\bar{J} = \\frac{1}{B} \\sum_{b=1}^{B} [B \\hat{D} - (B-1)\\hat{D}_{(-b)}] = B \\hat{D} - \\frac{B-1}{B} \\sum_{b=1}^{B} \\hat{D}_{(-b)} = B \\hat{D} - (B-1)\\bar{D}_{\\mathrm{LOO}}\n$$\n其中$\\bar{D}_{\\mathrm{LOO}} = \\frac{1}{B}\\sum_{b=1}^{B}\\hat{D}_{(-b)}$是留一法估计值的均值。单个伪值与均值的偏差为：\n$$\nJ_b - \\bar{J} = \\left[B \\hat{D} - (B-1)\\hat{D}_{(-b)}\\right] - \\left[B \\hat{D} - (B-1)\\bar{D}_{\\mathrm{LOO}}\\right] = -(B-1)(\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}})\n$$\n将此结果代入方差公式：\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{1}{B(B-1)} \\sum_{b=1}^{B} \\left[ -(B-1)(\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}}) \\right]^2 = \\frac{(B-1)^2}{B(B-1)} \\sum_{b=1}^{B} (\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}})^2\n$$\n这可以简化为我们所需的删一刀切法方差估计量的表达式：\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{B-1}{B} \\sum_{b=1}^{B} (\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}})^2\n$$\n推导出这个式子后，我们现在可以计算其值。题目给出了$B=50$以及离差平方和$\\sum_{b=1}^{B}\\left(\\hat{D}_{(-b)}-\\bar{D}_{\\mathrm{LOO}}\\right)^{2}=2.296\\times 10^{-4}$。\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{50-1}{50} (2.296 \\times 10^{-4}) = \\frac{49}{50} (2.296 \\times 10^{-4}) = 0.98 \\times 2.296 \\times 10^{-4} = 2.25008 \\times 10^{-4}\n$$\n刀切法标准误$\\mathrm{SE}_J(\\hat{D})$是方差的平方根：\n$$\n\\mathrm{SE}_J(\\hat{D}) = \\sqrt{\\widehat{\\mathrm{Var}}_{J}(\\hat{D})} = \\sqrt{2.25008 \\times 10^{-4}} \\approx 0.01500027\n$$\n最后，我们计算用于检验原假设$H_0: D=0$的$Z$-分数。$Z$-分数是估计的统计量与其标准误的比值：\n$$\nZ = \\frac{\\hat{D} - D_{H_0}}{\\mathrm{SE}_J(\\hat{D})} = \\frac{\\hat{D}}{\\mathrm{SE}_J(\\hat{D})}\n$$\n使用$\\hat{D}$和$\\mathrm{SE}_J(\\hat{D})$的计算值：\n$$\nZ = \\frac{1/15}{0.01500027} \\approx \\frac{0.066666...}{0.01500027} \\approx 4.44439\n$$\n问题要求最终答案以行矩阵$[D, Z]$的形式报告，两个值都四舍五入到四位有效数字。\n$D = 0.066666... \\approx 0.06667$\n$Z = 4.44439... \\approx 4.444$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.06667 & 4.444\n\\end{pmatrix}\n}\n$$", "id": "2544491"}, {"introduction": "一旦检测到适应性基因渗入，接下来的问题便是这个有益等位基因在受体群体中的演化命运。本练习将带你从第一性原理出发，推导在连续时间选择模型下一个渗入等位基因的频率动态轨迹。通过求解这个经典的种群遗传学模型，你将亲身体会到正选择如何驱动一个稀有的有利变异在群体中快速扩散，并能计算其达到一半固定频率所需的时间。[@problem_id:2544560]", "problem": "一个赋予高海拔耐受性的渐渗等位基因 $A$ 通过适应性渐渗进入了两个不同的分类单元：一种山地哺乳动物和一种高山草本植物。在时刻 $t=0$ 发生一次短暂的杂交脉冲后，该等位基因在受体种群中以频率 $p_{0} \\in (0,1)$ 存在。此后，该种群数量庞大、随机交配且封闭（无迁移），因此遗传漂变和进一步的基因流可以忽略不计。假设选择在连续时间内对马尔萨斯适应度具有加性效应：每个等位基因 $A$ 的拷贝都会对人均增长率产生一个加性增量 $s>0$，因此各基因型的马尔萨斯适应度分别为 $r_{AA}=2s$、$r_{Aa}=s$ 和 $r_{aa}=0$。假设由于随机交配，每个瞬间都满足哈迪-温伯格基因型比例，并且连续时间的确定性选择动态学适用。\n\n仅使用这些假设和基因型频率的连续时间选择（复制子）动态学定义——即基因型频率 $x_{i}$ 根据 $\\dot{x}_{i}=x_{i}(r_{i}-\\bar{r})$ 变化，其中 $\\bar{r}$ 是平均马尔萨斯适应度——从第一性原理出发，推导初始条件为 $p(0)=p_{0}$ 时 $t \\ge 0$ 的预期等位基因频率轨迹 $p(t)$。然后，将半固定时间 $t_{1/2}$ 定义为 $p(t)=\\frac{1}{2}$ 的时刻，并用 $s$ 和 $p_{0}$ 表示 $t_{1/2}$。将时间 $t$ 的单位视为世代，$s$ 视为每代的马尔萨斯选择系数。以 $p(t)$ 和 $t_{1/2}$ 的闭式解析表达式形式提供你的最终答案。无需进行数值四舍五入。", "solution": "在尝试求解之前，将首先对问题陈述进行严格的验证。\n\n### 步骤1：提取已知条件\n问题陈述中明确提供的信息如下：\n- 渐渗等位基因表示为 $A$。\n- 杂交发生在时刻 $t=0$。\n- 等位基因 $A$ 的初始频率为 $p(0) = p_{0}$，其中 $p_{0} \\in (0,1)$。\n- 种群数量庞大、随机交配且封闭，因此遗传漂变和迁移可以忽略不计。\n- 选择在连续时间内对马尔萨斯适应度具有加性效应。\n- 每个等位基因 $A$ 的拷贝对人均增长率的加性增量为 $s>0$。\n- 基因型马尔萨斯适应度指定为：$r_{AA}=2s$，$r_{Aa}=s$，$r_{aa}=0$。\n- 假设每个瞬间都满足哈迪-温伯格基因型比例。\n- 基因型频率 $x_{i}$ 的动态学由微分方程 $\\dot{x}_{i}=x_{i}(r_{i}-\\bar{r})$ 控制，其中 $\\bar{r}$ 是平均马尔萨斯适应度。\n- 任务是推导 $t \\ge 0$ 时的等位基因频率轨迹 $p(t)$。\n- 任务包括定义并确定半固定时间 $t_{1/2}$，此时 $p(t_{1/2})=\\frac{1}{2}$。\n\n### 步骤2：使用提取的已知条件进行验证\n根据所需标准对问题进行评估。\n\n- **科学依据：** 该问题是确定性群体遗传学理论的经典应用。连续时间复制子方程、马尔萨斯适应度、加性选择和哈迪-温伯格原理是理论生物学中基础且成熟的概念。适应性渐渗的情景是一个已知的进化过程。该问题在科学上是合理的。\n- **适定性：** 该问题提供了一个基于一阶常微分方程的适定初值问题。它提供了推导 $p(t)$ 和随后的 $t_{1/2}$ 的唯一解所需的所有必要参数（$p_0$，$s$）和函数形式（适应度，动态学）。该问题是适定的。\n- **客观性：** 该问题使用精确、正式、客观的数学和生物学术语进行陈述。它不包含任何主观或基于观点的陈述。\n- **不完整或矛盾的设置：** 该问题提供了求解所需的一整套假设和定义。没有内部矛盾。\n- **不切实际或不可行：** 该模型是一个理想化的模型，正如所有模型一样，但它在科学上并非不合理或物理上不可能。它代表了群体遗传学理论中的一个标准极限情况。\n- **其他缺陷：** 该问题不是隐喻性的、琐碎的或同义反复的。它要求从第一性原理进行严格推导，这是一项实质性的练习。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。这是数学群体遗传学中一个标准的、适定的问题。我现在将开始推导解答。\n\n任务是从第一性原理出发推导等位基因频率 $p(t)$ 的轨迹。我们已知基因型频率的动态学，因此必须首先将等位基因频率的变化 $\\dot{p}$ 与基因型频率的变化联系起来。\n\n等位基因 $A$ 的频率（记为 $p$）与基因型 $AA$ 和 $Aa$ 的频率（分别记为 $x_{AA}$ 和 $x_{Aa}$）通过以下关系相关联：\n$$\np = x_{AA} + \\frac{1}{2}x_{Aa}\n$$\n问题假设由于随机交配，哈迪-温伯格比例在所有时刻都成立。这意味着基因型频率可以用等位基因频率 $p$ 及其相对频率 $q=1-p$ 来表示：\n$$\nx_{AA} = p^2 \\quad , \\quad x_{Aa} = 2p(1-p) \\quad , \\quad x_{aa} = (1-p)^2\n$$\n种群的平均马尔萨斯适应度 $\\bar{r}$ 是各基因型适应度按其频率加权的平均值：\n$$\n\\bar{r} = x_{AA}r_{AA} + x_{Aa}r_{Aa} + x_{aa}r_{aa}\n$$\n代入哈迪-温伯格比例和给定的适应度值（$r_{AA}=2s$，$r_{Aa}=s$，$r_{aa}=0$）：\n$$\n\\bar{r} = p^2(2s) + 2p(1-p)(s) + (1-p)^2(0) = 2sp^2 + 2sp - 2sp^2 = 2sp\n$$\n平均适应度与等位基因频率之间的这种线性关系是加性选择的一个特征属性。\n\n现在，我们推导 $p(t)$ 的微分方程。我们将 $p$ 的表达式对时间 $t$ 求导：\n$$\n\\dot{p} = \\frac{dp}{dt} = \\frac{d}{dt}\\left(x_{AA} + \\frac{1}{2}x_{Aa}\\right) = \\dot{x}_{AA} + \\frac{1}{2}\\dot{x}_{Aa}\n$$\n我们代入给定的复制子动态学 $\\dot{x}_{i}=x_{i}(r_{i}-\\bar{r})$：\n$$\n\\dot{p} = x_{AA}(r_{AA} - \\bar{r}) + \\frac{1}{2}x_{Aa}(r_{Aa} - \\bar{r})\n$$\n现在，代入哈迪-温伯格比例以及适应度和平均适应度的表达式：\n$$\n\\dot{p} = p^2(2s - 2sp) + \\frac{1}{2}[2p(1-p)](s - 2sp)\n$$\n提出公因式：\n$$\n\\dot{p} = p^2(2s(1-p)) + p(1-p)(s(1-2p))\n$$\n我们可以从两项中提出公因式 $sp(1-p)$：\n$$\n\\dot{p} = sp(1-p)[2p + (1-2p)]\n$$\n方括号中的项简化为 $1$：\n$$\n\\dot{p} = sp(1-p)\n$$\n这是加性选择下等位基因频率的逻辑斯谛微分方程。为了求出 $p(t)$，我们必须解这个方程并满足初始条件 $p(0)=p_0$。这是一个可分离变量的方程：\n$$\n\\frac{dp}{p(1-p)} = s \\, dt\n$$\n我们对两边进行积分。左边使用部分分式分解进行积分。我们令 $\\frac{1}{p(1-p)} = \\frac{C_1}{p} + \\frac{C_2}{1-p}$。这得到 $1 = C_1(1-p) + C_2 p$，解得 $C_1=1$ 和 $C_2=1$。\n$$\n\\int \\left(\\frac{1}{p} + \\frac{1}{1-p}\\right) dp = \\int s \\, dt\n$$\n进行积分得到：\n$$\n\\ln|p| - \\ln|1-p| = st + K\n$$\n其中 $K$ 是积分常数。由于 $p \\in (0,1)$，绝对值不是必需的。\n$$\n\\ln\\left(\\frac{p}{1-p}\\right) = st + K\n$$\n这个量 $\\ln(p/(1-p))$ 是频率 $p$ 的logit。为了求出 $K$，我们应用初始条件 $p(0)=p_0$：\n$$\n\\ln\\left(\\frac{p_0}{1-p_0}\\right) = s(0) + K \\implies K = \\ln\\left(\\frac{p_0}{1-p_0}\\right)\n$$\n将 $K$ 代回方程中：\n$$\n\\ln\\left(\\frac{p(t)}{1-p(t)}\\right) = st + \\ln\\left(\\frac{p_0}{1-p_0}\\right)\n$$\n为了解出 $p(t)$，我们首先对两边取指数：\n$$\n\\frac{p(t)}{1-p(t)} = \\exp\\left(st + \\ln\\left(\\frac{p_0}{1-p_0}\\right)\\right) = \\exp(st) \\exp\\left(\\ln\\left(\\frac{p_0}{1-p_0}\\right)\\right) = \\frac{p_0}{1-p_0}\\exp(st)\n$$\n设等式右边为 $Z(t)$。那么 $p(t) = Z(t)(1-p(t)) = Z(t) - Z(t)p(t)$。\n$$\np(t)(1+Z(t)) = Z(t) \\implies p(t) = \\frac{Z(t)}{1+Z(t)}\n$$\n代入 $Z(t)$ 的表达式：\n$$\np(t) = \\frac{\\frac{p_0}{1-p_0}\\exp(st)}{1 + \\frac{p_0}{1-p_0}\\exp(st)}\n$$\n将分子和分母同乘以 $(1-p_0)$ 可以将表达式简化为其最终形式：\n$$\np(t) = \\frac{p_0 \\exp(st)}{(1-p_0) + p_0 \\exp(st)}\n$$\n这是第一个要求的结果。\n\n接下来，我们必须求出半固定时间 $t_{1/2}$，定义为 $p(t_{1/2}) = \\frac{1}{2}$ 的时刻。我们将 $p(t)$ 的解设为 $\\frac{1}{2}$：\n$$\n\\frac{1}{2} = \\frac{p_0 \\exp(st_{1/2})}{(1-p_0) + p_0 \\exp(st_{1/2})}\n$$\n交叉相乘得到：\n$$\n(1-p_0) + p_0 \\exp(st_{1/2}) = 2 p_0 \\exp(st_{1/2})\n$$\n重新整理以求解指数项：\n$$\n1-p_0 = 2 p_0 \\exp(st_{1/2}) - p_0 \\exp(st_{1/2}) = p_0 \\exp(st_{1/2})\n$$\n$$\n\\exp(st_{1/2}) = \\frac{1-p_0}{p_0}\n$$\n对两边取自然对数：\n$$\nst_{1/2} = \\ln\\left(\\frac{1-p_0}{p_0}\\right)\n$$\n最后，解出 $t_{1/2}$：\n$$\nt_{1/2} = \\frac{1}{s}\\ln\\left(\\frac{1-p_0}{p_0}\\right)\n$$\n这个表达式也可以写成 $t_{1/2} = -\\frac{1}{s}\\ln\\left(\\frac{p_0}{1-p_0}\\right)$。注意，当 $p_0 < \\frac{1}{2}$ 时，对数的参数大于 $1$，因此 $t_{1/2} > 0$。如果 $p_0 = \\frac{1}{2}$，则 $t_{1/2} = 0$，与预期相符。推导到此结束。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{p_0 \\exp(st)}{(1-p_0) + p_0 \\exp(st)} & \\frac{1}{s}\\ln\\left(\\frac{1-p_0}{p_0}\\right)\n\\end{pmatrix}\n}\n$$", "id": "2544560"}, {"introduction": "适应性基因渗入不仅改变等位基因频率，还在染色体上留下了独特的物理印记，即渗入的祖先片段（tracts）。本练习探讨了重组如何随着时间的推移打断这些片段，从而形成一个可预测的中性长度分布。在此基础上，练习进一步展示了当选择偏好携带多个有利变异的长片段时，这一分布将如何被重塑，为了解适应性渗入的基因组结构提供了更精细的视角。[@problem_id:2688969]", "problem": "考虑一个单次脉冲式混合模型，其中一个供体群体在恰好 $T$ 代前向一个受体群体贡献了遗传成分。假设基因组是连续的，其遗传图谱以摩根（Morgan）为单位度量，每代每个摩根的重组率 $r$ 是均一的，跨代间的重组是独立的，并且没有基因转换。我们关注一个从该混合事件遗传下来的、在当今采样的单倍型中的一条染色体。\n\nA部分（中性片段）：仅使用以下基本事实：(i) 在单次减数分裂中，沿基因组的重组事件构成一个空间泊松过程，其速率为每个摩根 $r$；(ii) 在一个谱系中，跨越 $T$ 代的独立泊松过程的叠加会产生另一个泊松过程，其速率是各个速率的总和；(iii) 泊松过程中连续点之间的距离是独立同分布的指数随机变量，推导在中性选择条件下，今天观测到的一个连续的供体遗传片段的长度 $L$ 的分布。明确写出 $L$ 的概率密度函数及其均值，并表示为 $r$ 和 $T$ 的函数。\n\nB部分（偏好长片段的选择）：现在假设存在一种选择，它偏好渗入的片段，其方式是增加较长片段的相对权重。具体来说，假设在任何长度为 $L$（单位为摩根）的片段上，渗入的供体特有有利位点的数量 $K$ 服从均值为 $\\mu L$ 的泊松分布，其中 $\\mu$ 是此类位点的密度（每个摩根）。每个保留下来并由该单倍型携带的有利渗入位点，都会独立地将其适应度乘以一个因子 $(1+s)$，其中 $s > 0$，且各位点间的适应度效应是乘性的。假设在采样时，采样到一个单倍型的概率与其在这些位点上的预期乘性适应度成正比。在附加假设 $rT > \\mu \\ln(1+s)$（从而使得最终的分布是可归一化的）下，推导经过重新加权的片段长度密度，并以闭合形式计算其均值。\n\n答案规格：请提供一个单一的闭合形式解析表达式作为你的最终答案，该表达式表示B部分选择模型下的平均片段长度，并以 $r$、$T$、$\\mu$ 和 $s$ 为函数。最终答案中不要包含任何单位。无需进行数值四舍五入。", "solution": "所陈述的问题具有科学依据、自洽且定义明确，可以进行严格求解。我们将开始推导过程。\n\n首先，必须验证问题的有效性。\n**已知条件：**\n- $T$ 代前发生的单次脉冲式混合模型。\n- 连续基因组，遗传图谱距离以摩根为单位。\n- 每个摩根的每代重组率 $r$ 是均一的。\n- 单次减数分裂中的重组构成速率为每个摩根 $r$ 的空间泊松过程。\n- $T$ 个独立的泊松过程（对应每一代的减数分裂）的叠加产生一个泊松过程，其速率等于各个速率之和。\n- 泊松过程中连续点之间的距离是独立同分布（i.i.d.）的指数随机变量。\n- $L$：连续的供体遗传片段的长度，单位为摩根。\n- A部分要求推导中性选择下 $L$ 的分布。\n- B部分引入了选择。\n- $K$：长度为 $L$ 的片段上渗入的供体特有有利位点的数量。\n- $K \\sim \\text{Poisson}(\\mu L)$，其中 $\\mu$ 是此类位点的密度（每个摩根）。\n- 每个有利位点的适应度乘子是 $(1+s)$，其中 $s > 0$。\n- 适应度效应在位点间是乘性的。\n- 采样时，采样一个单倍型的概率与其预期乘性适应度成正比。\n- 为B部分给出了条件 $rT > \\mu \\ln(1+s)$。\n\n**验证结论：**\n该问题是有效的。它描述了群体遗传学中一个标准的混合动态模型。其假设（泊松重组、指数片段长度）是该领域的基础。B部分引入了一个易于处理的选择模型。尽管“预期乘性适应度”这一短语存在轻微的歧义，但所提供的约束条件 $rT > \\mu \\ln(1+s)$ 为其预期解释提供了明确的指引。这解决了问题可能不适定（ill-posedness）的风险，并且在该解释下问题可以被明确地解决。\n\n**A部分：中性片段长度分布**\n\n我们已知在单次减数分裂中，沿染色体的重组事件遵循速率为每个摩根 $r$ 的泊松过程。一个祖先供体片段会被分隔混合祖先与当今样本的 $T$ 代中的任何一代发生的重组事件所打断。破坏供体片段的断点是 $T$ 个独立的、速率均为 $r$ 的泊松过程叠加的结果。因此，断点的累积过程也是一个泊松过程，其速率 $\\lambda_0$ 等于各个速率之和：\n$$\n\\lambda_0 = \\sum_{i=1}^{T} r = rT\n$$\n一个连续的供体遗传片段的长度 $L$，是从其起始点到第一个断点的距离。根据泊松过程的性质，连续事件之间的距离（或从任意起点到第一个事件的距离）遵循指数分布。该指数分布的速率参数就是泊松过程的速率 $\\lambda_0$。\n\n因此，一个中性供体片段的长度 $L$ 是一个速率为 $\\lambda_0 = rT$ 的指数随机变量。\n它的概率密度函数（PDF）$p_{neutral}(L)$ 由下式给出：\n$$\np_{neutral}(L) = \\lambda_0 \\exp(-\\lambda_0 L) = rT \\exp(-rT L) \\quad \\text{for } L \\ge 0\n$$\n速率为 $\\lambda_0$ 的指数分布的均值是 $1/\\lambda_0$。因此，平均中性片段长度为：\n$$\nE[L]_{neutral} = \\frac{1}{\\lambda_0} = \\frac{1}{rT}\n$$\n\n**B部分：选择下的片段长度分布**\n\n现在我们引入选择。长度为 $L$ 的片段上的有利位点数量 $K$ 是一个遵循均值为 $\\mu L$ 的泊松分布的随机变量：\n$$\nP(K=k|L) = \\frac{(\\mu L)^k}{k!} \\exp(-\\mu L)\n$$\n具有 $K$ 个此类位点的单倍型的总适应度为 $W = (1+s)^K$，因为效应是乘性的。问题陈述，采样概率与给定片段长度 $L$ 的*预期*乘性适应度成正比。我们将这个权重因子表示为 $W(L)$。\n\n对于如何解释“预期乘性适应度”存在一个微妙的歧义。一种字面解释是计算 $E[W|L] = E[(1+s)^K|L]$。另一种解释是使用对应于位点期望数的适应度，即 $W(L) = (1+s)^{E[K|L]}$。所提供的约束条件 $rT > \\mu \\ln(1+s)$ 是关键。\n\n如果我们采用第一种，即字面解释：\n$E[(1+s)^K | L]$ 是一个泊松($\\mu L$)随机变量在 $z=1+s$ 处取值的概率生成函数。PGF为 $G(z) = \\exp(\\lambda(z-1))$。因此，\n$W(L) = E[(1+s)^K | L] = \\exp(\\mu L((1+s)-1)) = \\exp(\\mu L s)$。\n重新加权的密度将与 $\\exp(-rT L) \\exp(\\mu L s) = \\exp(-(rT - \\mu s)L)$ 成正比。此分布可归一化（即在 $L \\in [0, \\infty)$ 上的积分收敛）的条件是 $rT - \\mu s > 0$。\n\n然而，问题指定了条件 $rT > \\mu \\ln(1+s)$。这个条件源于第二种解释。让我们使用基于位点期望数 $E[K|L] = \\mu L$ 的适应度：\n$$\nW(L) = (1+s)^{E[K|L]} = (1+s)^{\\mu L} = \\exp(\\ln((1+s)^{\\mu L})) = \\exp(\\mu L \\ln(1+s))\n$$\n这种解释，尽管在形式上是一种近似（用 $f(E[K])$ 代替 $E[f(K)]$)，但从所提供的约束条件来看，显然是出题者所期望的。我们采用这个权重函数继续。\n\n在选择条件下，新的、未归一化的片段长度概率密度函数 $p'_{sel}(L)$，是中性密度与适应度权重 $W(L)$ 的乘积：\n$$\np'_{sel}(L) \\propto p_{neutral}(L) \\times W(L)\n$$\n（我们暂时可以忽略中性PDF的归一化常数 $rT$，因为之后我们会重新归一化）。\n$$\np'_{sel}(L) \\propto \\exp(-rT L) \\times \\exp(\\mu L \\ln(1+s))\n$$\n$$\np'_{sel}(L) \\propto \\exp(-(rT - \\mu \\ln(1+s)) L)\n$$\n这是指数分布的函数形式。我们定义新的速率参数 $\\lambda_{sel}$：\n$$\n\\lambda_{sel} = rT - \\mu \\ln(1+s)\n$$\n条件 $rT > \\mu \\ln(1+s)$ 确保了 $\\lambda_{sel} > 0$，这是在 $L \\in [0, \\infty)$ 上获得一个有效的、可归一化的概率分布所必需的。\n\n因此，选择下的归一化概率密度函数为：\n$$\np_{sel}(L) = \\lambda_{sel} \\exp(-\\lambda_{sel} L)\n$$\n这是一个速率为 $\\lambda_{sel}$ 的指数分布。该分布的均值是其速率参数的倒数。\n\n在此选择模型下的平均片段长度 $E[L]_{sel}$ 是：\n$$\nE[L]_{sel} = \\frac{1}{\\lambda_{sel}} = \\frac{1}{rT - \\mu \\ln(1+s)}\n$$\n这就是所要求的最终闭合形式表达式。", "answer": "$$\n\\boxed{\\frac{1}{rT - \\mu \\ln(1+s)}}\n$$", "id": "2688969"}]}