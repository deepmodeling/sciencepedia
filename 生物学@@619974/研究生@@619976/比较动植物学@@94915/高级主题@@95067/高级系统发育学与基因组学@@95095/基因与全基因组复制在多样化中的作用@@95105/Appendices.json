{"hands_on_practices": [{"introduction": "当我们观察到旁系同源基因间的同义替换发散度（$K_s$）分布呈现一个峰值时，这通常标志着过去发生过一次大规模的基因重复事件。本练习将教授一项基本技能：如何利用分子钟将这一发散度值转化为绝对的时间估算。通过这项实践，你将巩固对替换速率、发散度和进化时间之间关系的理解。[@problem_id:2577160]", "problem": "在比较动物学和植物学中，全基因组复制 (WGD) 会在保守的共线性区块中留下重复基因保留下来的特征信号。考虑一个植物谱系，其中 WGD 是从一组锚定基因对（共线性旁系同源基因）中推断出来的。据报道，这些基因对的中位同义替换分歧为 $K_s = 1.2$。假设所报道的 $K_s$ 是旁系同源序列之间经过 Jukes–Cantor (JC) 校正的同义距离。设同义替换速率为 $r = 6 \\times 10^{-9}$ 次替换/位点/年/谱系，并假设在同义位点上存在严格分子钟。在 Jukes–Cantor 核苷酸替换模型下，并假设复制事件瞬间产生了两个子拷贝，此后它们以相同的速率独立累积替换，请从第一性原理出发，推导复制后经过的时间 $t$ 的表达式，该表达式用 JC 校正的同义距离和每个谱系的速率表示。然后使用上述数值计算该表达式的值。你的最终答案需以百万年 (Ma) 为单位，并四舍五入到四位有效数字。", "solution": "必须首先验证问题陈述的科学合理性、一致性和完整性。\n\n**步骤 1：提取已知条件**\n-   主题：植物谱系中的全基因组复制 (WGD)。\n-   数据：锚定基因对的中位同义替换分歧，$K_s = 1.2$。\n-   模型：分歧 $K_s$ 是 Jukes–Cantor (JC) 校正的同义距离。\n-   常数：同义替换速率，$r = 6 \\times 10^{-9}$ 次替换/位点/年/谱系。\n-   假设 1：在同义位点上存在严格分子钟。\n-   假设 2：复制事件是瞬时发生的。\n-   假设 3：子拷贝以相同的速率 $r$ 独立累积替换。\n-   任务 1：从第一性原理推导复制后经过的时间 $t$ 的表达式。\n-   任务 2：使用给定的数值计算此表达式。\n-   输出格式：时间 $t$ 的最终答案必须以百万年 (Ma) 为单位，并四舍五入到四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估。\n-   **科学依据充分：** 该问题使用了分子进化和计算生物学的标准概念：全基因组复制 (WGD)、同义替换速率 ($r$)、同义替换分歧 ($K_s$)、Jukes-Cantor (JC) 模型和分子钟假说。这些是该领域的基本原理。提供的 $K_s$ 和 $r$ 值对于植物进化是符合实际的。该问题在科学上是合理的。\n-   **适定性：** 该问题定义明确。它要求推导一个标准公式并将其应用于具体案例。给出的已知条件和假设足以确定唯一解。\n-   **客观性：** 语言技术性强且精确。没有主观或模棱两可的陈述。\n-   **完整性和一致性：** 该问题是自洽的。所提供的信息是充分的，并且没有内部矛盾。每个谱系的速率和总分歧速率之间的区别是一个关键要素，在此已正确指明。\n\n**步骤 3：结论和行动**\n该问题被判定为**有效**。这是一个分子系统发育学中的标准、适定的问题。我将继续进行完整的推导和解答。\n\n该问题要求基于两个旁系同源基因之间的同义替换分歧 ($K_s$) 推导自复制事件发生以来的时间 ($t$)。\n\n让我们从第一性原理开始。复制事件从一个祖先基因产生两个相同的基因拷贝。设此事件发生在时间 $t=0$。我们关心的是自该事件以来经过的时间 $t$。复制后，这两个拷贝沿着两个独立的谱系独立进化。\n\n替换速率给定为 $r$，单位为 次替换/位点/年/谱系。这是在单个进化谱系中替换累积的速率。\n\n两个旁系同源序列之间的分歧是在*两个*谱系中累积替换的结果。分隔两个现存序列的总进化时间是回到它们的共同祖先（即复制节点）的两个分支长度之和。每个分支的长度为 $t$ 年。因此，两个序列之间的总进化路径长度为 $t + t = 2t$。\n\n根据严格分子钟假说，替换数与时间成正比。两个序列之间的分歧速率（我们称之为 $k_{div}$）是它们之间差异累积的速率。由于两个谱系是独立进化的，该速率是它们各自替换速率的总和。\n$$k_{div} = r_{\\text{谱系}\\,1} + r_{\\text{谱系}\\,2}$$\n鉴于两个谱系均以相同的速率 $r$ 进化，我们有：\n$$k_{div} = r + r = 2r$$\n\n总同义替换分歧 $K_s$ 表示自两个序列分歧以来，在它们之间每个同义位点上发生的预期同义替换数。它是分歧速率和所经过时间的乘积。\n$$K_s = k_{div} \\times t$$\n代入 $k_{div}$ 的表达式，我们得到基本关系：\n$$K_s = (2r)t$$\n\n需要注意的是，问题指明 $K_s$ 是 Jukes-Cantor 校正距离。这意味着所提供的值 $K_s=1.2$ 已经考虑了随时间在同一位点上发生的多次替换，并直接表示每个位点的预期替换数。因此，上面推导的线性关系是适用的。如果我们得到的是原始差异位点比例 $p$，我们首先需要使用 Jukes-Cantor 公式 $K = -\\frac{3}{4}\\ln(1-\\frac{4}{3}p)$ 来计算 $K_s$，但在这里没有这个必要。\n\n从推导出的方程中，我们现在可以解出复制后经过的时间 $t$：\n$$t = \\frac{K_s}{2r}$$\n这就是从第一性原理推导出的 $t$ 的所需表达式。\n\n现在，我们使用给定的值来计算这个表达式：\n-   $K_s = 1.2$ (无量纲，替换数/位点)\n-   $r = 6 \\times 10^{-9}$ (替换数/位点/年)\n\n将这些值代入 $t$ 的表达式中：\n$$t = \\frac{1.2}{2 \\times (6 \\times 10^{-9} \\text{ 年}^{-1})}$$\n$$t = \\frac{1.2}{12 \\times 10^{-9}} \\text{ 年}$$\n$$t = \\frac{1.2}{1.2 \\times 10^{-8}} \\text{ 年}$$\n$$t = 1 \\times 10^8 \\text{ 年}$$\n\n问题要求答案以百万年 (Ma) 为单位表示，其中 $1 \\text{ Ma} = 10^6$ 年。\n$$t = (1 \\times 10^8) \\text{ 年} \\times \\frac{1 \\text{ Ma}}{10^6 \\text{ 年}} = 100 \\text{ Ma}$$\n\n最后，答案必须四舍五入到四位有效数字。计算出的值恰好是 $100$。为了用四位有效数字表示，我们写作 $100.0$。", "answer": "$$\n\\boxed{100.0}\n$$", "id": "2577160"}, {"introduction": "真实的基因组数据往往是复杂的，其中远古全基因组复制（WGD）事件的信号与更近期的、小规模基因重复的信号交织在一起。本练习将超越单一 $K_s$ 峰值的简单情景，介绍一种强大的统计方法——混合模型，以厘清这些不同的进化历史。通过推导似然函数，你将深入了解现代古基因组学研究的基本原理。[@problem_id:2576992]", "problem": "在对被子植物和硬骨鱼的比较分析中，全基因组复制 (WGD) 事件和谱系特异性串联重复均被认为促进了物种多样化。考虑一个基因组规模的旁系同源基因对集合，您已为其计算了同义替换差异 $K_s$（每个同义位点的同义替换数）。根据经验，具有已知古老WGD的物种的 $K_s$ 直方图通常在同线性复制对中显示出一个接近 $K_s \\approx 0.8$ 的主峰，以及一个与近期串联重复一致的、接近 $K_s \\approx 0.1$ 的次峰。\n\n您决定将所有旁系同源基因对的 $K_s$ 的边际分布建模为一个双组分混合模型，其中近期串联重复（组分 $R$）和古老WGD重复（组分 $A$）各自为 $K_s$ 贡献一个不同的非负右偏分布。受速率和时间异质性的启发，您假设在每个组分 $c \\in \\{R,A\\}$ 内，$K_s$ 服从形状参数为 $\\alpha_c$、速率参数为 $\\beta_c$ 的伽马分布（因此均值为 $\\alpha_c/\\beta_c$），并且观测值在给定其潜在组分身份的条件下是独立的。令 $\\pi \\in (0,1)$ 表示近期串联重复的混合比例，因此一个随机抽取的重复对是近期的概率为 $\\pi$，是古老的概率为 $1-\\pi$。\n\n您从旁系同源基因的混合群体中观测到 $n$ 个独立的 $K_s$ 值 $x_1,\\dots,x_n$。请使用前述假设，并从混合模型和统计独立性的定义出发，推导给定数据 $x_1,\\dots,x_n$ 时，参数 $\\pi$、$\\alpha_R$、$\\beta_R$、$\\alpha_A$ 和 $\\beta_A$ 的观测数据似然函数。请将最终答案表示为关于 $x_1,\\dots,x_n$、$\\pi$、$\\alpha_R$、$\\beta_R$、$\\alpha_A$ 和 $\\beta_A$ 的单一、闭合形式的解析表达式。不要简化为对数似然函数。无需进行数值计算或舍入。$K_s$ 没有单位，因为它是每个位点的无量纲速率估计值。", "solution": "对所述问题进行验证。\n\n步骤1：提取已知条件。\n- 系统是对被子植物和硬骨鱼的旁系同源基因对的分析。\n- 数据为同义替换差异值，记为 $K_s$。\n- $K_s$ 的边际分布被建模为双组分混合模型。\n- 组分 $R$ 代表近期串联重复。\n- 组分 $A$ 代表古老全基因组复制 (WGD) 重复。\n- 组分 $R$ 的混合比例为 $\\pi \\in (0,1)$。组分 $A$ 的比例为 $1-\\pi$。\n- 对每个组分 $c \\in \\{R,A\\}$，$K_s$ 的分布为形状参数是 $\\alpha_c$、速率参数是 $\\beta_c$ 的伽马分布。\n- 问题指明伽马分布的均值为 $\\alpha_c/\\beta_c$，这与形状-速率参数化一致。\n- 数据包含 $n$ 个独立的 $K_s$ 观测值 $x_1, \\dots, x_n$。\n- 任务是推导给定数据时，参数 $\\pi$、$\\alpha_R$、$\\beta_R$、$\\alpha_A$ 和 $\\beta_A$ 的观测数据似然函数。\n- 最终表达式必须是单一的、闭合形式的解析表达式，而非对数似然函数。\n\n步骤2：使用提取的已知条件进行验证。\n- 该问题**在科学上是合理的**。使用混合模型（特别是伽马分布）来分析 $K_s$ 分布是演化生物信息学中检测和测定古多倍性事件年代的一种标准且成熟的方法。其前提在事实上是可靠的。\n- 该问题**提法得当**。它要求为一个完全指定的统计模型推导似然函数。这样的函数存在且唯一。\n- 该问题是**客观的**。它使用精确的技术语言，不包含主观或基于价值的论断。\n- 该问题的设置是**完整且一致的**。构建似然函数所需的所有要素均已提供。伽马概率密度函数的定义是数学中的标准结果，其缺失并不使问题不完整，因为指令要求从定义出发。\n- 该问题**并非浅显或伪深刻**。它是数理统计中的一个标准推导，需要对混合模型和似然理论有清晰的理解。\n\n步骤3：结论与行动。\n问题被判定为**有效**。将提供解答。\n\n推导从概率论的基本原理出发。设参数向量为 $\\theta = (\\pi, \\alpha_R, \\beta_R, \\alpha_A, \\beta_A)$。问题描述了一个有限混合模型。对于单个观测值 $x$，其概率密度函数 (PDF) $p(x | \\theta)$ 是各单个组分PDF的加权和。\n令 $p_R(x | \\alpha_R, \\beta_R)$ 为代表近期重复（$R$）的组分的PDF，令 $p_A(x | \\alpha_A, \\beta_A)$ 为代表古老重复（$A$）的组分的PDF。混合比例分别为 $\\pi$ 和 $1-\\pi$。因此，根据全概率定律，混合分布的PDF由下式给出：\n$$p(x | \\theta) = \\pi \\cdot p_R(x | \\alpha_R, \\beta_R) + (1-\\pi) \\cdot p_A(x | \\alpha_A, \\beta_A)$$\n问题指出，每个组分都服从伽马分布。一个形状参数为 $\\alpha > 0$、速率参数为 $\\beta > 0$ 的伽马分布随机变量 $X$ 的PDF定义为：\n$$f(x; \\alpha, \\beta) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} x^{\\alpha-1} \\exp(-\\beta x)$$\n对于 $x > 0$，其中 $\\Gamma(\\alpha) = \\int_0^\\infty t^{\\alpha-1} \\exp(-t) dt$ 是伽马函数。$K_s$ 值的支撑集为非负，与该分布一致。\n\n将此定义应用于我们的两个组分，得到：\n对于近期重复（组分 $R$）：\n$$p_R(x | \\alpha_R, \\beta_R) = \\frac{\\beta_R^{\\alpha_R}}{\\Gamma(\\alpha_R)} x^{\\alpha_R-1} \\exp(-\\beta_R x)$$\n对于古老重复（组分 $A$）：\n$$p_A(x | \\alpha_A, \\beta_A) = \\frac{\\beta_A^{\\alpha_A}}{\\Gamma(\\alpha_A)} x^{\\alpha_A-1} \\exp(-\\beta_A x)$$\n将这些表达式代入单个观测值 $x_i$ 的混合模型PDF，我们得到：\n$$p(x_i | \\theta) = \\pi \\frac{\\beta_R^{\\alpha_R}}{\\Gamma(\\alpha_R)} x_i^{\\alpha_R-1} \\exp(-\\beta_R x_i) + (1-\\pi) \\frac{\\beta_A^{\\alpha_A}}{\\Gamma(\\alpha_A)} x_i^{\\alpha_A-1} \\exp(-\\beta_A x_i)$$\n问题指出，我们有从该混合分布中抽取的 $n$ 个独立观测值 $x_1, \\dots, x_n$。似然函数 $L(\\theta | x_1, \\dots, x_n)$ 定义为观测到给定数据的联合概率密度，并视其为参数 $\\theta$ 的函数。由于独立性假设，这个联合密度是各单个密度的乘积：\n$$L(\\theta | x_1, \\dots, x_n) = \\prod_{i=1}^{n} p(x_i | \\theta)$$\n通过代入上面推导出的 $p(x_i | \\theta)$ 表达式，我们得到了观测数据似然函数的最终表达式。此表达式表示在给定一组特定参数 $\\theta = (\\pi, \\alpha_R, \\beta_R, \\alpha_A, \\beta_A)$ 的情况下，观测到整个数据集 $\\{x_1, ..., x_n\\}$ 的概率。结果符合要求的闭合形式解析表达式。", "answer": "$$\\boxed{\\prod_{i=1}^{n} \\left[ \\pi \\frac{\\beta_R^{\\alpha_R}}{\\Gamma(\\alpha_R)} x_i^{\\alpha_R-1} \\exp(-\\beta_R x_i) + (1-\\pi) \\frac{\\beta_A^{\\alpha_A}}{\\Gamma(\\alpha_A)} x_i^{\\alpha_A-1} \\exp(-\\beta_A x_i) \\right]}$$", "id": "2576992"}, {"introduction": "在识别和确定WGD事件的年代之后，一个关键问题是：它在功能上有什么后果？本练习要求你检验“剂量平衡假说”（dosage-balance hypothesis），该假说预测了在WGD后特定类别的基因会被优先保留。通过对假设的基因保留数据进行卡方检验，你将学习如何利用基因组数据集来对重要的进化假说进行统计评估。[@problem_id:2577002]", "problem": "剂量平衡假说的一项长期预测是，在全基因组复制（WGD）之后，剂量敏感的基因类别（如转录因子和蛋白激酶）相对于小规模复制（SSD）会被优先保留下来，因为WGD能够保持相互作用伙伴之间的化学计量平衡，而SSD则不能。考虑一个汇集了代表性脊椎动物和被子植物进化枝的比较数据集，其中保留的重复基因已按复制机制（WGD与SSD）和基因类别（转录因子、激酶、代谢酶）进行了分类。您的任务是检验WGD和SSD之间保留的重复基因在不同基因类别中的分布是否存在差异，这与剂量平衡介导的富集是否一致。\n\n观测到的保留重复基因计数如下：\n- WGD保留：转录因子 $=$ $240$，激酶 $=$ $200$，代谢酶 $=$ $160$。\n- SSD保留：转录因子 $=$ $30$，激酶 $=$ $40$，代谢酶 $=$ $230$。\n\n使用皮尔逊卡方独立性检验对由此产生的 $2 \\times 3$ 列联表结构进行分析，计算在原假设（即在保留的重复基因中，复制机制和基因类别是独立的）下的卡方检验统计量。假设所有单元格的计数都足够大，足以满足渐近近似的条件，并且不要应用连续性校正。\n\n只需报告卡方检验统计量，四舍五入至四位有效数字。无需单位。", "solution": "问题陈述具有科学依据，表述清晰，并包含了进行指定统计检验所需的所有信息。其前提基于进化基因组学中有效的剂量平衡假说，所提供的数据构成了一个完整的列联表，适合进行卡方分析。因此，该问题被认为是有效的，并将提供解答。\n\n主要任务是计算给定列联表的皮尔逊卡方独立性检验统计量，记为 $\\chi^2$。原假设 $H_0$ 指出，保留的重复基因的基因类别与复制机制（全基因组复制 WGD 与小规模复制 SSD）是独立的。备择假设 $H_A$ 是这两个分类不是独立的。\n\n首先，我们将观测频数 $O_{ij}$ 整理成一个 $2 \\times 3$ 的列联表，其中 $i$ 代表行（复制机制），$j$ 代表列（基因类别）。\n\n观测计数表如下：\n$$\n\\begin{array}{c|ccc|c}\n & \\text{转录因子} & \\text{激酶} & \\text{代谢酶} & \\text{行总计} \\\\\n\\hline\n\\text{WGD} & O_{11} = 240 & O_{12} = 200 & O_{13} = 160 & R_1 \\\\\n\\text{SSD} & O_{21} = 30  & O_{22} = 40  & O_{23} = 230 & R_2 \\\\\n\\hline\n\\text{列总计} & C_1 & C_2 & C_3 & N\n\\end{array}\n$$\n\n接下来，我们计算行总计（$R_i$）、列总计（$C_j$）和总计（$N$）。\n行总计为：\n$$R_1 = 240 + 200 + 160 = 600$$\n$$R_2 = 30 + 40 + 230 = 300$$\n\n列总计为：\n$$C_1 = 240 + 30 = 270$$\n$$C_2 = 200 + 40 = 240$$\n$$C_3 = 160 + 230 = 390$$\n\n总计 $N$ 是所有观测值的总和：\n$$N = R_1 + R_2 = 600 + 300 = 900$$\n作为检验，$N = C_1 + C_2 + C_3 = 270 + 240 + 390 = 900$。总计是一致的。\n\n在独立性原假设下，每个单元格的期望频数 $E_{ij}$ 使用以下公式计算：\n$$E_{ij} = \\frac{R_i \\times C_j}{N}$$\n\n我们计算六个单元格中每个单元格的期望频数：\n$$E_{11} = \\frac{R_1 \\times C_1}{N} = \\frac{600 \\times 270}{900} = 180$$\n$$E_{12} = \\frac{R_1 \\times C_2}{N} = \\frac{600 \\times 240}{900} = 160$$\n$$E_{13} = \\frac{R_1 \\times C_3}{N} = \\frac{600 \\times 390}{900} = 260$$\n$$E_{21} = \\frac{R_2 \\times C_1}{N} = \\frac{300 \\times 270}{900} = 90$$\n$$E_{22} = \\frac{R_2 \\times C_2}{N} = \\frac{300 \\times 240}{900} = 80$$\n$$E_{23} = \\frac{R_2 \\times C_3}{N} = \\frac{300 \\times 390}{900} = 130$$\n\n皮尔逊卡方检验统计量定义为所有单元格的观测频数与期望频数之差的平方除以期望频数的总和：\n$$\\chi^2 = \\sum_{i=1}^{2} \\sum_{j=1}^{3} \\frac{(O_{ij} - E_{ij})^2}{E_{ij}}$$\n\n现在我们计算每个单元格对 $\\chi^2$ 值的贡献：\n$$\\frac{(O_{11} - E_{11})^2}{E_{11}} = \\frac{(240 - 180)^2}{180} = \\frac{60^2}{180} = \\frac{3600}{180} = 20$$\n$$\\frac{(O_{12} - E_{12})^2}{E_{12}} = \\frac{(200 - 160)^2}{160} = \\frac{40^2}{160} = \\frac{1600}{160} = 10$$\n$$\\frac{(O_{13} - E_{13})^2}{E_{13}} = \\frac{(160 - 260)^2}{260} = \\frac{(-100)^2}{260} = \\frac{10000}{260} = \\frac{1000}{26} = \\frac{500}{13}$$\n$$\\frac{(O_{21} - E_{21})^2}{E_{21}} = \\frac{(30 - 90)^2}{90} = \\frac{(-60)^2}{90} = \\frac{3600}{90} = 40$$\n$$\\frac{(O_{22} - E_{22})^2}{E_{22}} = \\frac{(40 - 80)^2}{80} = \\frac{(-40)^2}{80} = \\frac{1600}{80} = 20$$\n$$\\frac{(O_{23} - E_{23})^2}{E_{23}} = \\frac{(230 - 130)^2}{130} = \\frac{100^2}{130} = \\frac{10000}{130} = \\frac{1000}{13}$$\n\n最后，我们将这些贡献值相加，得到总的 $\\chi^2$ 统计量：\n$$\\chi^2 = 20 + 10 + \\frac{500}{13} + 40 + 20 + \\frac{1000}{13}$$\n$$\\chi^2 = 90 + \\frac{1500}{13}$$\n为了合并这些项，我们找到一个公分母：\n$$\\chi^2 = \\frac{90 \\times 13}{13} + \\frac{1500}{13} = \\frac{1170 + 1500}{13} = \\frac{2670}{13}$$\n将这个精确分数转换为小数值，得到：\n$$\\chi^2 \\approx 205.384615...$$\n题目要求结果四舍五入至四位有效数字。\n$$\\chi^2 \\approx 205.4$$\n这个较大的 $\\chi^2$ 统计量值表明，观测值显著偏离了原假设下的期望频数，说明复制机制和基因类别不是独立的。", "answer": "$$\n\\boxed{205.4}\n$$", "id": "2577002"}]}