{"hands_on_practices": [{"introduction": "在多样性速率分析中，所有模型都建立在一个核心概念之上：单个谱系以特定速率产生新谱系。此练习将带您回到第一性原理，从最基础的定义出发，推导纯生过程（Yule 过程）中两次物种形成事件之间的预期等待时间 [@problem_id:2567064]。掌握这一基本计算是理解和构建更复杂谱系演化模型（如生灭过程）的关键第一步。", "problem": "在比较动物学和比较植物学中，通常在纯生过程（Yule 过程）下对支系多样化进行建模。在该过程中，每个现存谱系在时间上以一个恒定的单位谱系速率 $\\lambda$ 独立地产生一个新谱系（物种形成事件）。考虑在当前观察到的一个目标现存谱系。假设以下基本性质，这些性质在谱系水平上操作性地定义了 Yule 过程：在一个无穷小时间间隔 $[t,t+\\mathrm{d}t)$ 内，若到时间 $t$ 为止目标谱系上没有发生物种形成，则在该谱系上于 $[t,t+\\mathrm{d}t)$ 内发生一次物种形成事件的概率为 $\\lambda\\,\\mathrm{d}t + o(\\mathrm{d}t)$；在 $[t,t+\\mathrm{d}t)$ 内发生多于一次事件的概率为 $o(\\mathrm{d}t)$；且该过程没有超出当前状态的记忆。\n\n设 $T$ 表示从当前到目标谱系上发生下一次物种形成事件的等待时间。请仅从上述无穷小速率的刻画以及 Yule 过程所蕴含的增量独立性出发，推导期望值 $\\mathbb{E}[T]$。\n\n请将您的最终结果以只包含 $\\lambda$ 的单一闭式解析表达式形式给出。请勿在最终的方框答案中包含单位。如果您找到了多种等价形式，请选择一种并只呈现该形式。", "solution": "该问题要求基于 Yule 过程的基本性质，推导单个目标谱系上发生下一次物种形成事件的期望等待时间 $\\mathbb{E}[T]$。推导过程必须从第一性原理出发，使用所提供的无穷小速率刻画。\n\n设 $T$ 为表示从现在（$t=0$）到下一次物种形成事件发生的等待时间的随机变量。我们寻求找到 $T$ 的期望值，记为 $\\mathbb{E}[T]$。问题的核心在于首先推导出 $T$ 的概率分布。\n\n设 $S(t) = \\mathbb{P}(T  t)$ 为 $T$ 的生存函数。该函数给出了到时间 $t$ 物种形成事件尚未发生的概率。根据定义，$S(0) = \\mathbb{P}(T  0) = 1$，因为等待时间必须为正。\n\n问题陈述给出了在无穷小时间间隔 $[t, t+\\mathrm{d}t)$ 内，给定直到时间 $t$ 都没有事件发生的条件下，发生一次物种形成事件的条件概率。这就是风险率 $h(t)$ 的定义。数学上，\n$$\nh(t) = \\lim_{\\mathrm{d}t \\to 0} \\frac{\\mathbb{P}(t  T \\leq t+\\mathrm{d}t | T  t)}{\\mathrm{d}t}\n$$\n根据问题陈述，这个条件概率为 $\\lambda\\,\\mathrm{d}t + o(\\mathrm{d}t)$。因此，风险率为：\n$$\nh(t) = \\lim_{\\mathrm{d}t \\to 0} \\frac{\\lambda\\,\\mathrm{d}t + o(\\mathrm{d}t)}{\\mathrm{d}t} = \\lambda\n$$\n速率 $\\lambda$ 是恒定的，这是该过程的一个关键性质，表明它是无记忆的。\n\n风险率 $h(t)$ 与生存函数 $S(t)$ 和概率密度函数 $f(t) = -S'(t)$ 有着基本的关系。条件概率可以表示为：\n$$\n\\mathbb{P}(t  T \\leq t+\\mathrm{d}t | T  t) = \\frac{\\mathbb{P}((t  T \\leq t+\\mathrm{d}t) \\cap (T  t))}{\\mathbb{P}(T  t)} = \\frac{\\mathbb{P}(t  T \\leq t+\\mathrm{d}t)}{\\mathbb{P}(T  t)}\n$$\n对于一个无穷小间隔 $\\mathrm{d}t$，概率 $\\mathbb{P}(t  T \\leq t+\\mathrm{d}t)$ 近似为 $f(t)\\,\\mathrm{d}t$。因此，\n$$\nh(t) = \\frac{f(t)}{S(t)}\n$$\n因为 $f(t) = -\\frac{\\mathrm{d}S(t)}{\\mathrm{d}t}$，我们可以写出：\n$$\nh(t) = -\\frac{1}{S(t)}\\frac{\\mathrm{d}S(t)}{\\mathrm{d}t} = -\\frac{\\mathrm{d}}{\\mathrm{d}t} \\ln(S(t))\n$$\n我们已经确定 $h(t) = \\lambda$。将此代入方程，得到一个关于 $S(t)$ 的一阶常微分方程：\n$$\n-\\frac{1}{S(t)}\\frac{\\mathrm{d}S(t)}{\\mathrm{d}t} = \\lambda\n$$\n整理各项得：\n$$\n\\frac{\\mathrm{d}S(t)}{S(t)} = -\\lambda\\,\\mathrm{d}t\n$$\n为了求出 $S(t)$，我们对等式两边从时间 $0$ 到一个一般时间 $t$ 进行积分：\n$$\n\\int_{S(0)}^{S(t)} \\frac{1}{S} \\, \\mathrm{d}S = \\int_0^t -\\lambda \\, \\mathrm{d}\\tau\n$$\n左边的积分是 $\\ln(S(t)) - \\ln(S(0))$，右边的积分是 $-\\lambda t$。\n$$\n\\ln(S(t)) - \\ln(S(0)) = -\\lambda t\n$$\n使用初始条件 $S(0)=1$，我们有 $\\ln(1)=0$。因此：\n$$\n\\ln(S(t)) = -\\lambda t\n$$\n对两边取指数，得到生存函数：\n$$\nS(t) = \\exp(-\\lambda t)\n$$\n这是一个速率参数为 $\\lambda$ 的指数分布的生存函数。\n\n现在，我们可以计算期望值 $\\mathbb{E}[T]$。对于像等待时间 $T$ 这样的非负随机变量，其期望值可以通过对生存函数在其支撑集（从 $0$ 到 $\\infty$）上积分来计算：\n$$\n\\mathbb{E}[T] = \\int_0^\\infty S(t) \\, \\mathrm{d}t\n$$\n代入推导出的生存函数 $S(t) = \\exp(-\\lambda t)$：\n$$\n\\mathbb{E}[T] = \\int_0^\\infty \\exp(-\\lambda t) \\, \\mathrm{d}t\n$$\n这是一个标准积分。计算过程如下：\n$$\n\\mathbb{E}[T] = \\left[ -\\frac{1}{\\lambda} \\exp(-\\lambda t) \\right]_0^\\infty\n$$\n在积分上下限处对表达式求值：\n$$\n\\mathbb{E}[T] = \\lim_{t \\to \\infty} \\left(-\\frac{1}{\\lambda} \\exp(-\\lambda t)\\right) - \\left(-\\frac{1}{\\lambda} \\exp(-\\lambda \\cdot 0)\\right)\n$$\n因为 $\\lambda$ 是一个速率，它必须是正的（$\\lambda  0$）。当 $t \\to \\infty$ 时，$\\exp(-\\lambda t)$ 项趋近于 $0$。第二项的计算结果为 $-\\frac{1}{\\lambda} \\exp(0) = -\\frac{1}{\\lambda}$。\n$$\n\\mathbb{E}[T] = (0) - \\left(-\\frac{1}{\\lambda}\\right) = \\frac{1}{\\lambda}\n$$\n因此，到目标谱系上发生下一次物种形成事件的期望等待时间是物种形成速率 $\\lambda$ 的倒数。这一结果与指数分布的一般性质相一致，并且是本文从所提供的无穷小刻画严格推导出来的。", "answer": "$$\\boxed{\\frac{1}{\\lambda}}$$", "id": "2567064"}, {"introduction": "理解了单个事件的随机性后，下一步是观察这些简单规则如何通过时间累积，生成我们观察到的复杂谱系树。此练习要求您亲手构建一个随机模拟算法（Gillespie 算法），以模拟生灭过程 [@problem_id:2566990]。通过编写代码来生成演化树，您将对谱系动态（如指数增长、衰退或达到平衡）获得深刻的直观理解。", "problem": "您将使用随机模拟算法 (SSA，也称为 Gillespie 算法) 实现一个连续时间马尔可夫链 (CTMC) 生死多样化模拟器，以生成用于比较动物学和植物学的生死树。在此背景下，谱系以每个谱系 $ \\lambda $ 的速率形成新物种 (新生)，并以每个谱系 $ \\mu $ 的速率灭绝 (死亡)。状态变量是在时间 $ t $ 的现存谱系数量 $ n(t) $。推导的基本依据是标准的CTMC框架，该框架用于独立的泊松过程，这些过程支配着竞争的指数时钟，同时结合了指数分布的无记忆性以及独立泊松过程的叠加特性：当存在 $ n $ 个独立同分布的指数时钟，每个谱系的新生速率为 $ \\lambda $，死亡速率为 $ \\mu $ 时，到下一个事件发生的时间呈指数分布，其总风险率等于所有活跃风险率之和，并且下一个事件的类型根据其对总风险率的贡献成比例地选择。\n\n您的任务是根据这些原理推导出事件调度，并实现一个 SSA，该算法：\n- 在时间 $ t = 0 $ 时，以 $ n_0 $ 个谱系进行初始化。\n- 在任何时刻，当有 $ n $ 个现存谱系时，仅根据 $ \\lambda $、$ \\mu $ 和 $ n $ 来调度下一个事件的时间和类型。\n- 对于新生事件，将 $ n $ 更新为 $ +1 $；对于死亡事件，更新为 $ -1 $，并相应地更新当前时间。\n- 持续运行，直到满足停止准则。\n\n您的停止准则必须是以下条件的逻辑析取 (逻辑或)：\n- 时间超过最大时限 $ T_{\\max} $。\n- 所有谱系灭绝，因此在某个时间点 $ n = 0 $。\n- 为了计算上的可处理性，达到了安全上限，即 $ n \\ge N_{\\max} $，其中 $ N_{\\max} $ 是用户指定的现存谱系数量上限，以防止在超临界状态下出现爆炸性增长。\n\n将所有谱系视为可交换的，并且其事件风险率是独立同分布的，除了上述停止准则外，不要以存活为条件或施加任何其他约束。\n\n您将编写一个程序，该程序针对每个测试用例，使用一个固定的伪随机种子运行单次随机模拟，并返回一个包含三个整数的三元组来总结结果：\n- 终止时的现存谱系数量 $ n_{\\text{final}} $。\n- 发生的新生事件总数 $ B $。\n- 发生的死亡事件总数 $ D $。\n\n事件时间使用任意时间单位；您的输出是无量纲的计数值。输出中不要包含任何物理单位。\n\n请从第一性原理出发，推导：\n- 在给定 $ n $、$ \\lambda $ 和 $ \\mu $ 的情况下，如何调度事件之间的等待时间。\n- 如何选择事件类型和受影响的谱系 (鉴于可交换性)。\n- 为什么上述停止准则即使在超临界状态下也能确保模拟是良定义的。\n\n然后实现该算法，并在以下参数集测试套件上运行它。每个测试用例是一个元组 $ (\\lambda,\\mu,T_{\\max},n_0,N_{\\max},\\text{seed}) $:\n- 案例 A (一般超临界): $ (0.4, 0.2, 5.0, 1, 2000, 42) $。\n- 案例 B (纯新生或 Yule 极限): $ (1.0, 0.0, 1.0, 1, 2000, 7) $。\n- 案例 C (纯死亡): $ (0.0, 0.5, 3.0, 3, 2000, 123) $。\n- 案例 D (达到上限的超临界): $ (2.0, 0.1, 10.0, 1, 50, 1) $。\n- 案例 E (零动态): $ (0.0, 0.0, 2.0, 5, 100, 99) $。\n\n对于每个案例，使用给定的种子精确运行一次模拟复现，并输出单行文本，该文本包含一个由方括号括起来的、以逗号分隔的列表，其中每个元素本身是该案例的一个列表 $ [n_{\\text{final}},B,D] $，顺序与上文指定的一致。该行中不得有任何空格。例如，格式必须完全如下所示：\n[[1,2,3],[4,5,6],[7,8,9],[10,11,12],[13,14,15]]\n\n您的程序相对于所提供的种子必须是完全确定性的，并且不得需要任何用户输入或外部文件。", "solution": "我们将谱系多样化建模为一个连续时间马尔可夫链 (CTMC)，其每个谱系的新生和死亡风险率是独立同分布的。在任何时间 $ t $，如果存在 $ n(t) = n $ 个现存谱系，每个谱系贡献两种可能的事件通道：一个是以每个谱系速率 $ \\lambda $ 发生的新生事件，另一个是以每个谱系速率 $ \\mu $ 发生的死亡事件。因此，系统有 $ n $ 个独立同分布的潜在新生事件和 $ n $ 个独立同分布的潜在死亡事件。\n\n基本依据：\n- 独立的泊松过程和无记忆性意味着，如果 $ X_1, \\dots, X_k $ 是速率分别为 $ r_1, \\dots, r_k $ 的独立指数随机变量，那么 $ \\min(X_1,\\dots,X_k) $ 服从速率为 $ r_1 + \\dots + r_k $ 的指数分布，并且最小值对应于过程 $ i $ 的概率等于 $ r_i / (r_1 + \\dots + r_k) $。这是泊松过程的叠加性质，也是随机模拟算法 (SSA) 的基础。\n- CTMC 跳跃链的演化方式是：选择下一个事件时间，该时间是一个指数等待时间，其参数等于当前状态的总离开率；然后根据相对速率选择事件类型。\n\n事件调度推导：\n- 当有 $ n $ 个现存谱系时，存在 $ n $ 个速率为 $ \\lambda $ 的新生通道和 $ n $ 个速率为 $ \\mu $ 的死亡通道。因此，总速率为\n$$ R(n) = n \\lambda + n \\mu = n (\\lambda + \\mu). $$\n- 到下一个事件的等待时间 $ \\Delta t $ 服从速率为 $ R(n) $ 的指数分布，即 $ \\Delta t \\sim \\text{Exponential}(R(n)) $。\n- 在事件发生的条件下，该事件是新生事件的概率是总新生速率除以总速率，\n$$ \\mathbb{P}(\\text{birth} \\mid n) = \\frac{n \\lambda}{n (\\lambda + \\mu)} = \\frac{\\lambda}{\\lambda + \\mu}, $$\n该事件是死亡事件的概率是\n$$ \\mathbb{P}(\\text{death} \\mid n) = \\frac{n \\mu}{n (\\lambda + \\mu)} = \\frac{\\mu}{\\lambda + \\mu}. $$\n- 谱系间的可交换性意味着，在给定事件类型的情况下，受影响的谱系是从 $ n $ 个现存谱系中均匀随机选择的，因为所有谱系对风险率的贡献都相同。\n\n算法设计 (随机模拟算法):\n- 初始化时间 $ t \\leftarrow 0 $，现存谱系数量 $ n \\leftarrow n_0 $，以及新生和死亡计数器 $ B \\leftarrow 0 $ 和 $ D \\leftarrow 0 $。可以维护一个现存谱系标识符的列表，但由于所有谱系都是可交换的，并且输出只需要计数值，因此追踪 $ n $ 就足够了；不过，我们也可以维护显式标识符，以使谱系选择过程更加明确。\n- 当所有停止准则都不满足时，循环执行：计算总速率 $ R(n) = n (\\lambda + \\mu) $。\n    - 如果 $ R(n) = 0 $ (例如，$ \\lambda = 0 $ 且 $ \\mu = 0 $，或 $ n = 0 $)，则不会再有事件发生；终止。\n    - 从一个速率为 $ R(n) $ 的指数分布中抽样一个等待时间 $ \\Delta t $。如果 $ t + \\Delta t  T_{\\max} $，则意味着下一个事件将发生在时限之外；不应用该事件并终止。\n    - 否则，设置 $ t \\leftarrow t + \\Delta t $，然后选择事件类型：从 $(0,1)$ 区间抽样一个均匀随机变量 $ U $。如果 $ U  \\lambda / (\\lambda + \\mu) $，则将该事件视为新生；否则视为死亡。\n    - 对于新生事件，将 $ B \\leftarrow B + 1 $ 和 $ n \\leftarrow n + 1 $。\n    - 对于死亡事件，将 $ D \\leftarrow D + 1 $ 和 $ n \\leftarrow n - 1 $。\n- 每次事件后，检查停止准则：如果 $ n = 0 $，因灭绝而终止；如果 $ n \\ge N_{\\max} $，因达到安全上限而终止；如果 $ t \\ge T_{\\max} $，因达到时间限制而终止。由于我们在应用事件前检查 $ t + \\Delta t $，当没有更多事件能发生在时限内时，$ t \\ge T_{\\max} $ 的条件会自然满足。\n\n为何这些停止准则能确保模拟是良定义的：\n- 如果 $ \\lambda \\le \\mu $，该过程平均而言是临界或亚临界的，不会在有限时间内爆炸；时限 $ T_{\\max} $ 和灭绝边界 $ n = 0 $ 已经足够。\n- 如果 $ \\lambda  \\mu $，该过程是超临界的，可以快速增长；用 $ N_{\\max} $ 来限制 $ n $ 可以保证即使时限非常大，算法也能在有限步内终止。这起到一种截断作用，在达到上限之前保持了统计一致性。\n\n边界情况：\n- 如果 $ \\lambda = 0 $ 且 $ \\mu  0 $，该过程为纯死亡过程；如果从 $ n_0  0 $ 开始，算法最终将达到 $ n = 0 $ 或达到 $ T_{\\max} $。\n- 如果 $ \\lambda  0 $ 且 $ \\mu = 0 $，该过程为纯新生过程 (Yule)；增长可能很快，因此 $ N_{\\max} $ 可以防止计算爆炸。\n- 如果 $ \\lambda = 0 $ 且 $ \\mu = 0 $，那么对任何 $ n $ 都有 $ R(n) = 0 $，所以没有事件会发生；状态将保持为 $ n = n_0 $ 直到达到 $ T_{\\max} $；算法会检测到 $ R(n) = 0 $ 并立即终止。\n\n测试套件和输出：\n- 对于每个案例，我们使用一个固定的伪随机种子，以确保模拟是可复现的。程序输出一个不含空格的单行文本，其中包含五个案例结果的列表，按顺序排列，每个结果是一个整数列表 $ [n_{\\text{final}}, B, D] $。这些案例是：\n    - 案例 A: $ (\\lambda,\\mu,T_{\\max},n_0,N_{\\max},\\text{seed}) = (0.4, 0.2, 5.0, 1, 2000, 42) $.\n    - 案例 B: $ (\\lambda,\\mu,T_{\\max},n_0,N_{\\max},\\text{seed}) = (1.0, 0.0, 1.0, 1, 2000, 7) $.\n    - 案例 C: $ (\\lambda,\\mu,T_{\\max},n_0,N_{\\max},\\text{seed}) = (0.0, 0.5, 3.0, 3, 2000, 123) $.\n    - 案例 D: $ (\\lambda,\\mu,T_{\\max},n_0,N_{\\max},\\text{seed}) = (2.0, 0.1, 10.0, 1, 50, 1) $.\n    - 案例 E: $ (\\lambda,\\mu,T_{\\max},n_0,N_{\\max},\\text{seed}) = (0.0, 0.0, 2.0, 5, 100, 99) $.\n\n计算方面的考虑：\n- 每个事件需要 $ \\mathcal{O}(1) $ 的工作量。在上限 $ N_{\\max} $ 和有限时限 $ T_{\\max} $ 的约束下，达到 $ T_{\\max} $ 前的事件数量是随机的，但几乎必然是有限的。\n- 使用高质量的伪随机数生成器和固定的种子可以确保可复现性。\n\n程序的实现严格遵循这些步骤，并遵守指定的无空格输出格式，以进行确定性评估。", "answer": "[[2,4,3],[2,1,0],[1,0,2],[50,53,4],[5,0,0]]", "id": "2566990"}, {"introduction": "理论模型是简洁的，但真实的生物数据却充满复杂性。本练习模拟了一个在比较生物学研究中极为常见且棘手的挑战：如何区分一个真正的多样性依赖性减速与由不完全取样或谱系间速率异质性引起的伪迹 [@problem_id:2566989]？这道题将考验您的批判性思维和设计严谨分析策略的能力，帮助您从理想化的模型过渡到复杂的实证研究。", "problem": "给你一个某植物科的时间校准的系统发育树，该科有 $n = 800$ 个已识别的现存物种，其中 $n_{\\text{sampled}} = 480$ 个物种被包含在该系统发育树中。野外调查表明抽样比例 $\\rho \\in [0.5, 0.7]$。两个大的子演化支（称之为演化支 $A$ 和演化支 $B$）嵌套在该科的冠群内。演化支 $A$ 有 $N_A = 300$ 个已识别物种，其中 $N_{A,\\text{sampled}} = 210$ 个被抽样；演化支 $B$ 有 $N_B = 200$ 个已识别物种，其中 $N_{B,\\text{sampled}} = 120$ 个被抽样。其余物种属于几个较小的子演化支。整个树的谱系贯穿时间（LTT）曲线呈现出明显的凹性（即，早期谱系快速积累，随后减速）。一个基于末端分支水平的多样化速率代理指标的初步直方图显示出双峰。\n\n你的任务是确定哪种分析和诊断图的组合能够最严格地区分真正的多样性依赖性减速（即，在谱系均质动态下，物种形成速率 $\\lambda$ 随着现存多样性 $N$ 的增加而降低，因此 $\\partial \\lambda / \\partial N  0$）与由不完全抽样或子演化支间速率异质性引起的假象。\n\n请基于以下第一性原理和核心定义进行推理：\n\n- 在一个物种形成速率为 $\\lambda(t)$、绝灭速率为 $\\mu(t)$ 的时间非均质出生—死亡过程中，当抽样是随机且与性状无关时，重建的现存类群系统发育树所包含的分支时间的分布由净多样化速率 $r(t) = \\lambda(t) - \\mu(t)$ 和抽样比例 $\\rho$ 决定。\n- 多样性依赖性假设 $\\lambda$ 依赖于现存多样性 $N(t)$，例如 $\\partial \\lambda / \\partial N  0$，并且在给定时间 $t$ 整个演化支内是谱系均质的。\n- 抽样比例 $\\rho  1$ 的不完全抽样会移除一部分最近形成的谱系，并且如果没有得到适当考虑，会使像 Pybus–Harvey $\\gamma$ 统计量这样的摘要统计量偏向负值。\n- 将以不同速率（演化支异质的 $\\lambda_i(t), \\mu_i(t)$）演化的子演化支合并在一起，可能会模拟出一种早期爆发的现象——快速多样化的子演化支在早期分化，而慢速多样化的子演化支在后期贡献谱系，从而在合并的LTT中产生表观的凹性。\n\n假设你可以使用标准的比较方法工具来拟合明确包含 $\\rho$ 的、灵活的、随时间变化的出生—死亡模型；计算谱系贯穿时间（LTT）和标准化LTT（nLTT）曲线；执行后验预测检验；估计末端分支水平的速率代理指标（例如，逆均等分裂或“DR”统计量）；以及估计拉伸多样化速率函数。\n\n下列哪种组合策略和诊断图能够最严格地区分真正的多样性依赖性减速与假象？选择所有适用选项。\n\nA. 对整个树拟合一个多样性依赖性模型，同时固定 $\\rho = 1$ 以最大化统计功效；并得出结论：凹形的LTT曲线，加上多样性依赖性模型相比恒定速率模型具有显著更优的似然值，就足以推断出真正的多样性依赖性。如果整树的LTT是凹形的，则无需进行子演化支分析。\n\nB. 在合理的区间 $\\rho \\in [0.5, 0.7]$ 内对假设的抽样比例 $\\rho$ 进行剖析，并且，对于每个 $\\rho$ 值，使用赤池信息准则（AIC）的差异来比较随时间变化的出生—死亡模型和多样性依赖性模型。通过在每个 $\\rho$ 值下的最佳拟合模型下模拟系统发育树，为nLTT和分支时间分布生成置信包络，从而执行后验预测检验。与此同时，将按冠群年龄对齐的各子演化支特有的nLTT曲线叠加在一起，并绘制末端分支水平速率代理指标的分布图。只有在以下条件都满足时，才断定真正的多样性依赖性得到了支持：(i) 对多样性依赖性的支持在不同的 $\\rho$ 值下都是稳健的，(ii) 后验预测包络能够捕捉观测到的nLTT和分支时间分布，(iii) 当按时间对齐时，各子演化支显示出同步的减速，以及 (iv) 末端分支速率分布是单峰而非多峰的。\n\nC. 在几个不同的外群上重新为树定根，并迭代地修剪长的悬垂枝，以减少树的不平衡性，直到LTT在半对数坐标轴上变得近似线性；如果修剪后LTT曲线仍然是凹形的，就推断存在真正的多样性依赖性，因为修剪移除了大部分异质性。\n\nD. 在明确包含 $\\rho$ 的、基于样条的灵活模型下，为整个树以及分别为演化支 $A$ 和 $B$ 估计拉伸多样化速率 $r_p(t)$。检查 $r_p(t)$ 是否在各演化支间以时间上一致的方式随时间下降，以及这种下降对于变化的 $\\rho \\in [0.5, 0.7]$ 是否稳健。用一张相对于随时间变化的出生—死亡零模型的演化支年龄对物种丰富度残差图，以及一张叠加的子演化支速率贯穿时间曲线图来补充此分析。只有当 $r_p(t)$ 显示出跨子演化支的共同下降，并且年龄—丰富度残差表明相对于零模型存在饱和现象时，才断定存在真正的多样性依赖性。\n\nE. 仅在整个树上计算 Pybus–Harvey $\\gamma$ 统计量；如果在忽略 $\\rho$ 的恒定速率零模型下，$\\gamma  0$ 且 $p  0.05$，则推断存在真正的多样性依赖性减速，因为即使在不完全抽样的情况下，$\\gamma$ 对于早期爆发也具有诊断性。\n\n你的回答应反映出基于这些原则和在不完全抽样与子演化支速率异质性下的预期定性特征的严密推理链。特别要指明，为了避免混淆，哪些图表将最具信息价值，以及哪些模型比较/敏感性分析是必要的。选择所有适用选项。", "solution": "该问题要求确定最严格的分析策略，以区分真正的、演化支范围内的多样性依赖性多样化减速与由不完全抽样和子演化支间多样化速率异质性产生的假象。我将首先验证问题陈述，然后对每个提议的策略进行详细评估。\n\n### 问题验证\n\n**步骤1：提取已知信息**\n- 科内已识别现存物种总数：$n = 800$。\n- 系统发育树中已抽样现存物种数：$n_{\\text{sampled}} = 480$。\n- 假定的抽样比例范围：$\\rho \\in [0.5, 0.7]$。\n- 演化支 $A$ 物种总数：$N_A = 300$。\n- 演化支 $A$ 已抽样物种数：$N_{A,\\text{sampled}} = 210$。\n- 演化支 $B$ 物种总数：$N_B = 200$。\n- 演化支 $B$ 已抽样物种数：$N_{B,\\text{sampled}} = 120$。\n- 定性观察1：整个树的谱系贯穿时间（LTT）曲线是凹形的。\n- 定性观察2：一个末端分支水平多样化速率代理指标的直方图呈现双峰。\n- 核心任务：区分真正的多样性依赖性减速（$\\partial \\lambda / \\partial N  0$）与由不完全抽样或速率异质性引起的假象。\n- 给定原则：出生—死亡过程、多样性依赖性、不完全抽样对Pybus-Harvey $\\gamma$ 统计量的影响，以及合并异质子演化支造成的假象减速的定义。\n\n**步骤2：使用提取的已知信息进行验证**\n问题陈述具有科学依据、提法恰当且客观。\n1.  **科学与事实的健全性**：所呈现的概念——出生—死亡模型、LTT图、多样性依赖性、抽样比例、速率异质性——都是现代宏观演化研究的核心。数值数据内部一致。总抽样比例为 $n_{\\text{sampled}} / n = 480 / 800 = 0.6$，位于指定区间 $\\rho \\in [0.5, 0.7]$ 内。演化支 $A$ 的抽样比例为 $N_{A,\\text{sampled}} / N_A = 210 / 300 = 0.7$。演化支 $B$ 的抽样比例为 $N_{B,\\text{sampled}} / N_B = 120 / 200 = 0.6$。其余谱系的抽样比例为 $(480 - 210 - 120) / (800 - 300 - 200) = 150 / 300 = 0.5$。所有计算出的抽样比例都与给定的范围一致。该情景是系统发育学中一个现实且常见的挑战。\n2.  **完整性与一致性**：问题提供了足够的信息——定量数据、定性观察和基本原理——以支持对方法论策略进行严格评估。没有内部矛盾。观察到双峰的末端分支速率分布是一个关键信息，它指向了潜在的速率异质性，使得这个问题并非无足轻重。\n3.  **结构与客观性**：问题结构良好，对方法论的严谨性提出了一个明确的问题。语言技术性强、精确，没有歧义或主观论断。\n\n**步骤3：结论与行动**\n问题陈述有效。我将继续进行分析。\n\n### 解决方案推导与逐项分析\n\n核心挑战是厘清观察到的凹形LTT曲线的三个潜在原因：\n1.  **真正的多样性依赖性**：一种真实的生物学过程，其中物种形成速率 $\\lambda$ 随着物种丰富度 $N$ 的增加而降低。在指定的模型下，这是一个谱系均质的过程。\n2.  **不完全抽样假象**：未能抽样所有现存物种（$\\rho  1$）导致近期分支事件的丢失，这会人为地制造出一个凹形的LTT图，并使像 $\\gamma$ 这样的统计量偏向负值。\n3.  **速率异质性假象**：将来自以不同内禀速率多样化的子演化支的谱系汇集在一起，可以创建一个复合的LTT，使其看起来是凹形的。快速多样化的演化支在树的早期历史中贡献了许多谱系，而慢速多样化的演化支则更稳定地贡献谱系。总和的模式模拟了减速。\n\n一个严格的策略必须直面所有这些可能性。问题提供了两个强有力的线索：我们知道抽样是不完全的（$\\rho \\approx 0.6$），并且我们有强有力的证据表明存在速率异质性（双峰的末端分支速率分布）。\n\n**对选项A的评估**\n该策略建议对整个树拟合一个多样性依赖性模型，固定抽样比例 $\\rho = 1$，如果似然值高且LTT是凹形的，就接受该模型。这种方法存在致命缺陷。首先，它故意将 $\\rho$ 设为1，从而忽略了已知的抽样不完全问题，而真实值接近 $0.6$。如给定原则所述，不完全抽样本身就会产生一个模拟多样化减速的信号。通过忽略它，分析必然会偏向于检测到减速，即使减速并不存在。其次，它提出“无需进行子演化支分析”。这忽略了速率异质性的明确证据（双峰的末端分支速率代理指标分布），而速率异质性是导致凹形LTT的另一个众所周知的替代原因。在这种情况下，仅依赖于全树分析是天真且方法上不健全的。\n**结论：不正确**\n\n**对选项B的评估**\n该策略提出了一个全面的、多步骤的验证方案。\n1.  **处理了抽样不确定性**：它正确地建议在抽样比例的合理范围 $\\rho \\in [0.5, 0.7]$ 内进行剖析分析，以确保任何结论对这种不确定性都是稳健的。这是一项关键的敏感性分析。\n2.  **使用适当的模型比较**：它使用AIC来比较不同模型（随时间变化与多样性依赖性），这是一种标准方法。\n3.  **执行了模型充分性检查**：它包含了后验预测检验。这是确保最佳拟合模型不仅优于替代模型，而且实际上能很好地拟合数据（即，它能否模拟出与观察到的nLTT和分支时间相似的数据？）的关键步骤。\n4.  **探究了速率异质性**：它通过叠加各子演化支特有的nLTT曲线和检查末端分支速率分布，直接面对了速率异质性的可能性。\n5.  **为推断指定了严格的条件**：它正确地指出，只有在多个严格标准都满足时，才能支持真正的、谱系均质的多样性依赖性：(i) 模型支持对 $\\rho$ 稳健，(ii) 模型是充分的（通过后验预测检验），(iii) 各子演化支在按绝对时间对齐时表现出*同步*减速，表明这是一个全局性的、演化支范围內的现象，以及 (iv) 末端分支速率分布是单峰的，这将反驳存在显著潜在速率异质性的观点。鉴于问题陈述了末端分支速率分布是双峰的，该策略将正确地引导研究者拒绝均质多样性依赖性假说，转而支持速率异质性假说，这展示了其诊断能力。\n这种方法系统、详尽，并直接解决了所有已知的混淆因素。\n**结论：正确**\n\n**对选项C的评估**\n该策略主张进行临时的、随意的数据操纵。重新为树定根对内部群分支时间的分布没有实质性影响，因此对LTT形状也没有影响。“迭代地修剪长的悬垂枝”是一个无原则的操作，相当于丢弃数据。长枝包含关于谱系历史的有效信息（例如，古老谱系的存活或近期物种形成后姐妹谱系的绝灭）。为了获得期望的图表形状（线性的半对数LTT）而修剪它们，不是科学分析，而是数据伪造。声称这“移除了大部分异质性”是毫无根据的。这种方法会破坏检验目标假说所需的系统发育信息。\n**结论：不正确**\n\n**对选项D的评估**\n该策略提出了另一套但同样严格的分析方法，植根于非参数和半参数方法。\n1.  **使用稳健的速率估计**：它侧重于估计拉伸多样化速率 $r_p(t)$，这是可视化随时间变化的速率动态的强大工具。使用灵活的基于样条的模型避免了像纯线性多样性依赖模型那样的过于僵化的假设。\n2.  **正确地处理了抽样问题**：它要求模型明确包含 $\\rho$，并对 plausible range $\\rho \\in [0.5, 0.7]$ 进行敏感性分析。\n3.  **直接检验异质性与同步性**：它建议分别为整个树和主要子演化支（$A$ 和 $B$）估计 $r_p(t)$。关键的诊断方法是检查 $r_p(t)$ 的下降是否在各演化支间“时间上一致”。同步下降支持全局驱动因素（如全演化支范围的多样性依赖），而异步下降则指向演化支特有的动态或速率异质性。这是一个直接而有力的检验。\n4.  **增加了补充证据**：它包括一张演化支年龄对丰富度残差图。饱和模式（即，较老的演化支物种数少于恒定速率过程下的预期）是多样性依赖性限制的经典宏观演化信号，提供了独立的证据线。\n这整个工作流程是剖析多样化模式的一种前沿方法。\n**结论：正确**\n\n**对选项E的评估**\n该策略依赖于单一的摘要统计量，即在忽略抽样比例的情况下对整个树计算的Pybus–Harvey $\\gamma$。这在根本上是有缺陷的，原因有二。首先，如问题自身的原则所述，不完全抽样会使 $\\gamma$ 偏向负值。因此，在忽略 $\\rho$ 的情况下计算它，必然会产生一个暗示减速的结果，从而使检验无效。其次，与选项A一样，它完全忽略了仅分析全树而存在的速率异质性的强有力证据。$\\gamma$ 统计量也已知会受到谱系间速率异质性的影响。在面临多个已知混淆因素的情况下，使用单一、有偏的统计量，与严格分析背道而驰。\n**结论：不正确**\n\n总之，选项B和D描述了严格的、多方面的策略，它们正确地考虑了不完全抽样问题，并积极地探究了速率异质性的替代假说。选项A、C和E在科学上是不健全的，因为它们要么忽略了关键的混淆因素，要么依赖于有偏的统计量，要么采用了临时的、随意的数据操纵。", "answer": "$$\\boxed{BD}$$", "id": "2566989"}]}