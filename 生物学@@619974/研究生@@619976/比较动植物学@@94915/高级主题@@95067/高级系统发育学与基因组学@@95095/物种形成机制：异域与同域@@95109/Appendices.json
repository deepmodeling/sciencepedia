{"hands_on_practices": [{"introduction": "在物种形成研究中，一个基本的任务是估算两个谱系在何时分化。然而，一个简单的计算可能会产生误导，因为它忽略了分化发生时祖先群体中已存在的遗传变异。本练习将指导您推导出分化时间的天真估计值和更精确的“溯祖校正”估计值，从而揭示祖先多态性对准确推断物种形成时间线的关键影响 [@problem_id:2610664]。", "problem": "在一个火山口湖中，两种亲缘关系很近的水生被子植物表现出强烈的生态位分化，这与同域成种相符。对推定的中性四重简并位点进行全基因组分析，得出这两个物种之间的绝对分化度为每个位点 $d = 0.018$ 个替换。假设每个谱系每个位点每代的突变率是 $\\mu = 1.5 \\times 10^{-8}$，且祖先有效种群大小为 $N_{e,\\mathrm{anc}} = 2.0 \\times 10^{5}$ 个二倍体个体。将突变视为严格中性，突变过程视为泊松过程，并假设分化后没有基因流。\n\n仅从以下基本事实出发：\n- 在一个谱系中，经过 $t$ 代累积的中性替换的期望数量（每个位点）是 $\\mu t$。\n- 在一个有效种群大小为 $N_{e}$ 的二倍体 Wright–Fisher (WF) 种群中，随机抽取的两个等位基因的溯祖时间期望值为 $2N_{e}$ 代。\n\n请逐步推导两个在 $t$ 代前分离的谱系之间的期望绝对分化度的表达式，涵盖 (i) 忽略祖先多态性的情况，以及 (ii) 通过祖先溯祖过程考虑现存祖先多态性的情况。将每个表达式求解为以 $d$、$\\mu$ 和（在适用情况下）$N_{e,\\mathrm{anc}}$ 为变量的函数 $t$。使用给定的数值，计算：\n- 朴素分化时间估计值 $t_{\\mathrm{naive}}$（忽略祖先多态性），以及\n- 溯祖校正后的分化时间估计值 $t_{\\mathrm{corr}}$（通过祖先溯祖过程考虑现存祖先多态性）。\n\n最后，以无量纲的比值 $t_{\\mathrm{naive}}/t_{\\mathrm{corr}}$ 作为你的最终答案。对此量无需指定舍入规则。如果报告了中间时间，请以“代”为单位表示；如果选择对任何中间数值进行舍入，请保留三位有效数字。", "solution": "该问题要求在两种不同的分化模型下，推导并计算两个物种间的分化时间，然后计算这些时间的比值。对问题陈述的验证确认了其科学依据充分、问题设定合理，并包含了得出唯一解所需的所有信息。我们开始进行推导。\n\n该分析基于所提供的两个基本事实：\n1. 在一个谱系中，经过 $t$ 代，每个位点累积的中性替换的期望数量是 $\\mu t$，其中 $\\mu$ 是每个位点每代的突变率。\n2. 在一个有效种群大小为 $N_e$ 的二倍体 Wright-Fisher 种群中，随机抽取的两个基因拷贝的溯祖时间期望值为 $2N_e$ 代。\n\n设 $d$ 表示从两个物种中各抽取一个样本的一对同源序列之间的期望绝对分化度（每个位点的替换数）。这种分化是自它们最后一个共同祖先以来，突变在两个谱系上累积的结果。总替换数与分隔这两个序列的总进化时间成正比，该时间是将这两个序列连接到其最近共同祖先（MRCA）的基因谱系中两个分支的长度之和。如果从现在到 MRCA 的时间为 $T_{\\mathrm{MRCA}}$ 代，则总分支长度为 $2 T_{\\mathrm{MRCA}}$。那么，期望分化度为 $d = \\mu \\times (2 E[T_{\\mathrm{MRCA}}]) = 2\\mu E[T_{\\mathrm{MRCA}}]$。我们的任务是在两种情景下，确定到最近共同祖先的期望时间 $E[T_{\\mathrm{MRCA}}]$。\n\n(i) 朴素分化时间 ($t_{\\mathrm{naive}}$)，忽略祖先多态性。\n\n在这个简化模型中，我们假设两个谱系恰好在物种形成的那一刻发生溯祖合并。如果物种形成事件发生在 $t$ 代以前，那么到 MRCA 的时间就直接是这个值，即 $T_{\\mathrm{MRCA}} = t$。这个模型刻意忽略了在物种分化之前，这两个基因拷贝在祖先种群中拥有不同祖先这一事实。\n在此假设下，到共同祖先的期望时间为 $E[T_{\\mathrm{MRCA}}] = t$。因此，期望分化度 $d$ 为：\n$$d = 2\\mu t$$\n这是忽略祖先多态性时，期望绝对分化度的表达式。在此背景下，时间 $t$ 是分化时间的朴素估计值，我们将其记为 $t_{\\mathrm{naive}}$。\n将上式求解为以 $d$ 和 $\\mu$ 为变量的函数 $t_{\\mathrm{naive}}$，得到：\n$$t_{\\mathrm{naive}} = \\frac{d}{2\\mu}$$\n\n(ii) 溯祖校正分化时间 ($t_{\\mathrm{corr}}$)，考虑祖先多态性。\n\n一个更现实的模型承认，当来自不同子物种的两个谱系追溯到过去 $t$ 时间点的物种形成事件时，它们作为两个不同的谱系进入祖先种群。它们不会立即溯祖合并，而是在这个祖先种群中作为独立的谱系继续存在，直到找到它们的共同祖先。在祖先种群中这段额外的溯祖时间解释了在物种分化时就已存在的现存遗传变异（多态性）。\n\n设 $t_{\\mathrm{corr}}$ 为自物种形成事件以来的实际时间（以代为单位）。到 MRCA 的时间 $T_{\\mathrm{MRCA}}$ 是两个时间段之和：从现在回溯到物种形成事件的时间 ($t_{\\mathrm{corr}}$)，以及随后两个谱系在祖先种群中溯祖合并所需的时间 ($T_{\\mathrm{coal}}$)。\n$$T_{\\mathrm{MRCA}} = t_{\\mathrm{corr}} + T_{\\mathrm{coal}}$$\n因此，到 MRCA 的期望时间为：\n$$E[T_{\\mathrm{MRCA}}] = E[t_{\\mathrm{corr}} + T_{\\mathrm{coal}}] = t_{\\mathrm{corr}} + E[T_{\\mathrm{coal}}]$$\n$t_{\\mathrm{corr}}$ 项是一个固定参数，而非随机变量。\n根据第二个基本事实，在有效种群大小为 $N_{e, \\mathrm{anc}}$ 的祖先种群中，两个谱系的期望溯祖时间为 $E[T_{\\mathrm{coal}}] = 2N_{e, \\mathrm{anc}}$。\n将此代入 $E[T_{\\mathrm{MRCA}}]$ 的表达式中：\n$$E[T_{\\mathrm{MRCA}}] = t_{\\mathrm{corr}} + 2N_{e, \\mathrm{anc}}$$\n那么，期望分化度 $d$ 由下式给出：\n$$d = 2\\mu E[T_{\\mathrm{MRCA}}] = 2\\mu (t_{\\mathrm{corr}} + 2N_{e, \\mathrm{anc}})$$\n这是考虑了祖先多态性的期望绝对分化度的表达式。这可以展开为 $d = 2\\mu t_{\\mathrm{corr}} + 4\\mu N_{e, \\mathrm{anc}}$，其中第一项代表物种分化后累积的分化，第二项 ($4\\mu N_{e, \\mathrm{anc}}$) 代表祖先种群中已作为多态性存在的平均分化度。\n解此方程求校正后的分化时间 $t_{\\mathrm{corr}}$：\n$$t_{\\mathrm{corr}} = \\frac{d}{2\\mu} - 2N_{e, \\mathrm{anc}}$$\n\n现在，我们使用给定的数据 $d=0.018$、$\\mu=1.5 \\times 10^{-8}$ 和 $N_{e,\\mathrm{anc}}=2.0 \\times 10^{5}$ 计算数值。\n\n首先，计算朴素分化时间 $t_{\\mathrm{naive}}$：\n$$t_{\\mathrm{naive}} = \\frac{0.018}{2 \\times (1.5 \\times 10^{-8})} = \\frac{0.018}{3.0 \\times 10^{-8}} = 6.0 \\times 10^{5} \\text{ 代}$$\n\n其次，计算溯祖校正的分化时间 $t_{\\mathrm{corr}}$。我们可以使用先前推导的关系式 $t_{\\mathrm{corr}} = t_{\\mathrm{naive}} - 2N_{e, \\mathrm{anc}}$：\n$$t_{\\mathrm{corr}} = (6.0 \\times 10^{5}) - 2 \\times (2.0 \\times 10^{5}) = 6.0 \\times 10^{5} - 4.0 \\times 10^{5} = 2.0 \\times 10^{5} \\text{ 代}$$\n\n最后，我们计算无量纲比值 $t_{\\mathrm{naive}}/t_{\\mathrm{corr}}$。\n$$\\frac{t_{\\mathrm{naive}}}{t_{\\mathrm{corr}}} = \\frac{6.0 \\times 10^{5}}{2.0 \\times 10^{5}} = 3$$\n该比值表明，在这种特定情况下，忽略祖先多态性的贡献会导致分化时间被高估三倍。$2N_{e,\\mathrm{anc}}$ 项代表了谱系在祖先种群中溯祖合并所需的期望代数，对于这些近期分离的物种而言，这部分时间占总分化时间的很大一部分。", "answer": "$$\\boxed{3}$$", "id": "2610664"}, {"introduction": "当部分隔离的种群相遇时，它们可以形成杂交带，这是研究基因流和生殖隔离之间相互作用的天然实验室。本练习探讨了“张力区”的经典概念，其地理宽度由个体扩散与针对杂种的选择压力之间的动态平衡所决定。通过从第一性原理推导该区域的平衡宽度，您将对维持物种间界限的物理和生物力量有更深刻的数学理解 [@problem_id:2610720]。", "problem": "一个位于两个部分生殖隔离的分类单元之间的一维杂交带，通过对杂交后代的内源性选择以及来自亲本种群的持续扩散而得以维持。请用文字定义一个张力区，然后，仅使用扩散的扩散近似和生存力选择的弱选择复制子形式，推导平衡渐变群宽度 $w$ 作为每代扩散方差 $\\sigma^{2}$ 和杂合子劣势 $s$ 的函数的解析表达式。\n\n假设以下基本条件：\n- 个体每代根据方差为 $\\sigma^{2}$ 的对称高斯核进行扩散，因此在扩散极限下，等位基因频率场 $p(x,t)$ 服从形式为 $(\\sigma^{2}/2)\\,\\partial^{2}p/\\partial x^{2}$ 的空间平滑项。\n- 生存力选择作用于一个具有杂合子劣势的单个基因座：相对适合度为 $W_{AA}=1$、$W_{Aa}=1-s$ 和 $W_{aa}=1$，其中 $0<s\\ll 1$。\n- 在弱选择下，由选择引起的局部等位基因频率变化由复制子形式 $\\partial p/\\partial t \\approx p(1-p)\\,(w_{A}-w_{a})$ 给出，其中 $w_{A}$ 和 $w_{a}$ 分别是等位基因 $A$ 和 $a$ 的边际适合度。\n\n设渐变群中心位于 $x=0$，满足 $p(0)=1/2$，并具有渐近边界条件：当 $x\\to +\\infty$ 时 $p(x)\\to 1$，当 $x\\to -\\infty$ 时 $p(x)\\to 0$。将渐变群宽度 $w$ 定义为平衡时等位基因频率剖面的最大空间斜率的倒数：\n$$\nw \\equiv \\left(\\max_{x}\\left|\\frac{dp}{dx}\\right|\\right)^{-1}.\n$$\n推导 $w$ 关于 $\\sigma^{2}$ 和 $s$ 的表达式。将最终答案表示为单个闭式解析表达式。无需进行数值计算或四舍五入。", "solution": "首先必须验证问题陈述的科学合理性、内部一致性和完整性。\n\n**步骤 1：提取已知条件**\n- 该系统是一个一维杂交带。\n- 等位基因频率场 $p(x,t)$ 的动态由扩散和选择共同决定。\n- 扩散由扩散近似建模，贡献项为 $\\frac{\\sigma^{2}}{2}\\frac{\\partial^{2}p}{\\partial x^{2}}$，其中 $\\sigma^{2}$ 是每代扩散方差。\n- 选择由弱选择复制子形式 $\\frac{\\partial p}{\\partial t} \\approx p(1-p)\\,(w_{A}-w_{a})$ 描述。\n- 遗传基础是一个具有两个等位基因 $A$ 和 $a$ 的单个基因座。\n- 相对适合度表现为杂合子劣势：$W_{AA}=1$，$W_{Aa}=1-s$，$W_{aa}=1$，选择系数 $s$ 满足 $0<s\\ll 1$。\n- 等位基因 $A$ 和 $a$ 的边际适合度分别表示为 $w_A$ 和 $w_a$。\n- 问题寻求的是平衡状态，此时等位基因频率剖面 $p(x)$ 是静态的。\n- 平衡渐变群的边界条件为：当 $x\\to +\\infty$ 时 $p(x)\\to 1$，当 $x\\to -\\infty$ 时 $p(x)\\to 0$。\n- 渐变群的中心设定为 $p(0)=1/2$。\n- 渐变群宽度 $w$ 定义为平衡时等位基因频率最大空间梯度的倒数：$w \\equiv \\left(\\max_{x}\\left|\\frac{dp}{dx}\\right|\\right)^{-1}$。\n\n**步骤 2：使用提取的条件进行验证**\n该问题是理论群体遗传学中的一个经典练习。所描述的模型是费希尔-柯尔莫哥洛夫-彼得罗夫斯基-皮斯库诺夫（FKPP）类型的反应扩散方程，经过调整以适用于杂合子劣势的情况。所有组成部分——扩散的扩散近似、弱选择的复制子动态、特定的适合度方案、边界条件以及渐变群宽度的定义——都是该领域中标准、明确且有科学依据的概念。该问题是自洽的、可数学形式化的和客观的。它不包含科学或逻辑上的缺陷，没有缺失信息，也没有矛盾之处。\n\n**步骤 3：结论与行动**\n该问题是有效的。现在将进行严谨的推导。\n\n首先，张力区是指两个遗传上不同的种群相遇并杂交产生杂交后代的狭窄地理区域。该区域的存在和狭窄性由两种相反力量之间的动态平衡来维持：一方面是扩散，它将亲本种群的个体带入该区域，倾向于使其变宽；另一方面是针对适应性较低的杂交个体的选择，它倾向于消除这些个体并使该区域收缩。张力区的位置不受环境梯度的决定，因此可以移动。\n\n描述等位基因频率 $p(x,t)$ 演化的控制方程结合了扩散和选择的影响：\n$$\n\\frac{\\partial p}{\\partial t} = \\frac{\\sigma^{2}}{2}\\frac{\\partial^{2}p}{\\partial x^{2}} + \\Delta p_{\\text{sel}}\n$$\n选择项 $\\Delta p_{\\text{sel}}$ 由弱选择近似 $p(1-p)(w_{A}-w_{a})$ 给出。我们必须首先推导边际适合度 $w_{A}$ 和 $w_{a}$。假设局部满足哈迪-温伯格比例，基因型 $AA$、$Aa$ 和 $aa$ 的频率分别为 $p^{2}$、$2p(1-p)$ 和 $(1-p)^{2}$。\n\n等位基因 $A$ 的边际适合度是其所在基因型的适合度的加权平均值：\n$$\nw_{A} = p W_{AA} + (1-p) W_{Aa} = p(1) + (1-p)(1-s) = 1 - s(1-p)\n$$\n同样，等位基因 $a$ 的边际适合度为：\n$$\nw_{a} = p W_{Aa} + (1-p) W_{aa} = p(1-s) + (1-p)(1) = 1 - sp\n$$\n边际适合度的差异是：\n$$\nw_{A} - w_{a} = (1-s+sp) - (1-sp) = s(2p-1)\n$$\n将此代入选择项，得到：\n$$\n\\Delta p_{\\text{sel}} = p(1-p) s(2p-1)\n$$\n因此，$p(x,t)$ 的完整反应扩散方程是：\n$$\n\\frac{\\partial p}{\\partial t} = \\frac{\\sigma^{2}}{2}\\frac{\\partial^{2}p}{\\partial x^{2}} + s p(1-p)(2p-1)\n$$\n在平衡状态下，等位基因频率分布是稳态的，因此 $\\frac{\\partial p}{\\partial t} = 0$。问题简化为求解以下关于渐变群形状 $p(x)$ 的二阶常微分方程（ODE）：\n$$\n\\frac{\\sigma^{2}}{2}\\frac{d^{2}p}{dx^{2}} + s p(1-p)(2p-1) = 0\n$$\n$$\n\\frac{d^{2}p}{dx^{2}} = -\\frac{2s}{\\sigma^{2}} p(1-p)(2p-1)\n$$\n为了求解这个常微分方程，我们使用标准技巧，即两边乘以 $\\frac{dp}{dx}$ 并对 $x$ 进行积分。令 $p' = \\frac{dp}{dx}$ 且 $p'' = \\frac{d^{2}p}{dx^{2}}$。\n$$\np' p'' = -\\frac{2s}{\\sigma^{2}} p(1-p)(2p-1) p'\n$$\n注意到 $p'p'' = \\frac{d}{dx}\\left(\\frac{1}{2}(p')^{2}\\right)$ 且 $p' = \\frac{dp}{dx}$，我们可以对两边进行积分：\n$$\n\\int \\frac{d}{dx}\\left(\\frac{1}{2}\\left(\\frac{dp}{dx}\\right)^{2}\\right) dx = -\\frac{2s}{\\sigma^{2}} \\int p(1-p)(2p-1) \\frac{dp}{dx} dx\n$$\n$$\n\\frac{1}{2}\\left(\\frac{dp}{dx}\\right)^{2} = -\\frac{2s}{\\sigma^{2}} \\int (-2p^{3} + 3p^{2} - p) dp\n$$\n$$\n\\frac{1}{2}\\left(\\frac{dp}{dx}\\right)^{2} = -\\frac{2s}{\\sigma^{2}} \\left(-\\frac{1}{2}p^{4} + p^{3} - \\frac{1}{2}p^{2}\\right) + C\n$$\n其中 $C$ 是积分常数。我们可以简化括号内的多项式：\n$$\n-\\frac{1}{2}p^{4} + p^{3} - \\frac{1}{2}p^{2} = -\\frac{1}{2}p^{2}(p^{2} - 2p + 1) = -\\frac{1}{2}p^{2}(p-1)^{2}\n$$\n将其代回，得到：\n$$\n\\frac{1}{2}\\left(\\frac{dp}{dx}\\right)^{2} = -\\frac{2s}{\\sigma^{2}} \\left(-\\frac{1}{2}p^{2}(1-p)^{2}\\right) + C = \\frac{s}{\\sigma^{2}}p^{2}(1-p)^{2} + C\n$$\n为了确定 $C$，我们应用边界条件。当 $x \\to \\pm\\infty$ 时，渐变群变得平缓，因此 $\\frac{dp}{dx} \\to 0$。在这些极限处，$p \\to 0$ 或 $p \\to 1$。\n在 $p=0$ 处：$0 = \\frac{s}{\\sigma^{2}}(0)^{2}(1-0)^{2} + C \\implies C=0$。\n在 $p=1$ 处：$0 = \\frac{s}{\\sigma^{2}}(1)^{2}(1-1)^{2} + C \\implies C=0$。\n因此，积分常数 $C$ 为零。梯度的方程为：\n$$\n\\left(\\frac{dp}{dx}\\right)^{2} = \\frac{2s}{\\sigma^{2}}p^{2}(1-p)^{2}\n$$\n取平方根，我们得到：\n$$\n\\left|\\frac{dp}{dx}\\right| = \\sqrt{\\frac{2s}{\\sigma^{2}}} p(1-p)\n$$\n渐变群宽度 $w$ 被定义为最大斜率的倒数。为了求得最大斜率，我们必须找到右侧表达式的最大值。项 $\\sqrt{\\frac{2s}{\\sigma^{2}}}$ 是一个常数。项 $p(1-p)$ 是 $p$ 的函数，而 $p$ 又是 $x$ 的函数。函数 $f(p) = p(1-p)$ 是一个开口向下的抛物线，其最大值在 $p=1/2$ 处取得。\n问题陈述中指出 $p(0)=1/2$，因此最大斜率出现在渐变群的中心，即 $x=0$ 处。\n$p(1-p)$ 的最大值是 $(1/2)(1-1/2) = 1/4$。\n因此，最大斜率为：\n$$\n\\max_{x}\\left|\\frac{dp}{dx}\\right| = \\sqrt{\\frac{2s}{\\sigma^{2}}} \\max_{p}[p(1-p)] = \\sqrt{\\frac{2s}{\\sigma^{2}}}\\left(\\frac{1}{4}\\right) = \\sqrt{\\frac{2s}{16\\sigma^{2}}} = \\sqrt{\\frac{s}{8\\sigma^{2}}}\n$$\n渐变群宽度 $w$ 是该值的倒数：\n$$\nw = \\left(\\max_{x}\\left|\\frac{dp}{dx}\\right|\\right)^{-1} = \\left(\\sqrt{\\frac{s}{8\\sigma^{2}}}\\right)^{-1} = \\sqrt{\\frac{8\\sigma^{2}}{s}}\n$$\n这个表达式给出了平衡渐变群宽度作为扩散方差 $\\sigma^{2}$ 和选择系数 $s$ 的函数。", "answer": "$$ \\boxed{\\sqrt{\\frac{8\\sigma^{2}}{s}}} $$", "id": "2610720"}, {"introduction": "现代物种形成研究的核心是利用基因组数据来区分不同的地理情景，例如严格的异域物种形成与存在基因流的同域或邻域物种形成。本练习将理论与现代统计方法相结合，向您展示如何应用似然比检验来正式比较这两种模型。此过程不仅是物种形成基因组学的一块基石，还特别强调了当模型参数（如此处的迁移率 $m$）位于其取值边界（$m=0$）时，如何正确构建和解释检验，这是一个关键且微妙的统计要点 [@problem_id:2610629]。", "problem": "一项动物学-植物学比较研究对产卵于不同寄主植物的两个近缘昆虫谱系进行了抽样。研究对数千个非连锁、中性演化、双等位基因的位点进行了测序，并从 $L$ 个在无穷位点模型下演化的独立位点中总结了这两个谱系的联合折叠位点频率谱（SFS），其中每位点突变率为 $\\mu$。设两个候选的种群历史模型为：\n\n1. 严格隔离 (Strict Isolation, SI)：在过去的 $T$ 时刻，一个大小为 $N_{A}$ 的祖先种群分裂成两个子代种群，其现今大小分别为 $N_{1}$ 和 $N_{2}$；分裂后它们之间没有迁移。\n\n2. 带迁移的隔离 (Isolation-with-Migration, IM)：与 SI 模型类似，但在整个分裂后时期，允许两个子代种群之间以每代概率 $m$ 发生持续的对称迁移。\n\n为了避免对未知绝对突变率的依赖并确保从折叠 SFS 中获得可识别性，您将使用种群尺度参数并施加对称性约束。具体来说，使用以下参数化：\n- $\\theta_{1} = 4 N_{1} \\mu$，$\\theta_{2} = 4 N_{2} \\mu$ 及 $\\theta_{A} = 4 N_{A} \\mu$，\n- $\\tau = T \\mu$，\n- 对称迁移，使得 $m_{12} = m_{21} = m$，且 $m \\geq 0$，\n- 正值约束 $\\theta_{1} > 0$，$\\theta_{2} > 0$，$\\theta_{A} > 0$ 及 $\\tau > 0$。\n\n假设所有 $L$ 个位点都是非连锁的，因此在两个模型下，联合折叠 SFS 的全似然函数在各位点上均可分解；并且 SI 模型在边界 $m=0$ 处嵌套于 IM 模型中。给定使用相同 SFS 从独立拟合的模型中获得的最大对数似然值：\n- $\\ln \\hat{L}_{\\mathrm{SI}} = -1204.5$，\n- $\\ln \\hat{L}_{\\mathrm{IM}} = -1200.0$。\n\n任务：\n1. 从基本原理出发，根据 $\\{\\theta_{1}, \\theta_{2}, \\theta_{A}, \\tau, m\\}$ 陈述每个模型下的全套自由参数，并结合折叠 SFS 和模型嵌套的背景，论证上述施加的可识别性约束的合理性。\n2. 从似然的定义和广义似然比原理出发，推导一个似然比检验（LRT），用于比较 SI 和 IM 模型，以推断分化是伴随着持续的基因流（与同域分化一致）还是在严格的异域条件下发生的。明确推导在 SI 模型下 LRT 统计量的渐近零分布，并考虑到额外参数 $m$ 在 $m=0$ 处位于边界上。\n3. 使用给定的最大对数似然值和您推导的 LRT，在适当的边界零分布下计算渐近 $p$ 值。\n\n最终答案仅提供 $p$ 值的数值，四舍五入至四位有效数字。不包含任何单位。", "solution": "所呈现的问题是种群遗传学中一个标准的统计模型比较任务。该问题是良定的，具有科学依据，并为求解提供了所有必要信息。我将按要求分三部分进行分析。\n\n第 1 部分：自由参数与约束的合理性论证\n\n两个种群历史模型是严格隔离（SI）模型和带迁移的隔离（IM）模型。给出的全套可用参数为 $\\{\\theta_{1}, \\theta_{2}, \\theta_{A}, \\tau, m\\}$。\n\n在 SI 模型下，种群分裂后没有基因流。这等同于将迁移率 $m$ 设为零。因此，SI 模型的自由参数集 $\\mathcal{P}_{\\mathrm{SI}}$ 由种群尺度大小和尺度化分裂时间组成：\n$$ \\mathcal{P}_{\\mathrm{SI}} = \\{\\theta_{1}, \\theta_{2}, \\theta_{A}, \\tau\\} $$\n自由参数的数量为 $k_{\\mathrm{SI}} = 4$。\n\n在 IM 模型下，允许对称迁移。迁移率 $m$ 是一个自由参数，约束为非负（$m \\geq 0$）。IM 模型的自由参数集 $\\mathcal{P}_{\\mathrm{IM}}$ 为：\n$$ \\mathcal{P}_{\\mathrm{IM}} = \\{\\theta_{1}, \\theta_{2}, \\theta_{A}, \\tau, m\\} $$\n自由参数的数量为 $k_{\\mathrm{IM}} = 5$。\n\n指定的参数化和约束的合理性如下：\n- **种群尺度参数**：使用了参数 $\\theta_{1} = 4 N_{1} \\mu$、$\\theta_{2} = 4 N_{2} \\mu$、$\\theta_{A} = 4 N_{A} \\mu$ 和 $\\tau = T \\mu$。在作为这些模型基础的中性溯祖框架中，基因谱系的形状以及由此产生的多态性模式（由位点频率谱，即 SFS，所总结）仅通过这些复合参数依赖于种群大小和时间。绝对突变率 $\\mu$ 作为突变数量的全局标量，但不影响不同遗传构型的相对频率。使用这些尺度化参数使得模型仅从遗传数据即可识别，避免了知道真实突变率 $\\mu$ 的需要，而 $\\mu$ 几乎从无法被确定地知晓。正值约束（$\\theta_{i} > 0$，$\\tau > 0$）在生物学上是必需的，因为种群大小和时间必须为正。\n- **折叠 SFS 与可识别性**：使用折叠 SFS 意味着等位基因的祖先和衍生状态是未知的。衍生等位基因的频率 $p$ 与 $1-p$ 无法区分。这种信息损失可能导致可识别性问题。例如，交换种群 1 和种群 2 的标签（即交换 $\\theta_1$ 和 $\\theta_2$）会产生相同的联合折叠 SFS。问题陈述中提到施加对称性约束以确保可识别性；这是指对称迁移率的假设，$m_{12} = m_{21} = m$。这简化了模型，但并未完全解决标签交换问题，后者通常通过惯例处理（例如，选择 $\\theta_1 > \\theta_2$ 的解）。\n- **模型嵌套**：SI 模型是 IM 模型在 $m=0$ 时的特例。这种零模型（SI）的参数空间是备择模型（IM）参数空间的严格子集的层级关系，是应用似然比检验的必要条件。\n\n第 2 部分：似然比检验及其零分布的推导\n\n似然比检验（LRT）是一种用于比较两个嵌套模型拟合优度的统计检验。零假设 $H_0$ 对应于较简单的模型（SI），备择假设 $H_1$ 对应于较复杂的模型（IM）。\n$H_0: m = 0$（严格隔离）\n$H_1: m > 0$（带迁移的隔离）\n\nLRT 统计量，通常记为 $D$ 或 $\\lambda_{LR}$，定义为两个模型最大对数似然差值的两倍：\n$$ D = 2 \\left( \\ln \\hat{L}_{\\text{alternative}} - \\ln \\hat{L}_{\\text{null}} \\right) = 2 \\left( \\ln \\hat{L}_{\\mathrm{IM}} - \\ln \\hat{L}_{\\mathrm{SI}} \\right) $$\n其中 $\\hat{L}$ 表示在每个模型参数的最大似然估计值处计算的似然函数。\n\n在标准的正则性条件下，Wilks 定理指出，当样本量趋于无穷大时，在零假设下，$D$ 统计量的分布渐近趋向于卡方分布（$\\chi^2_k$），其中 $k$ 是备择模型和零模型自由参数数量之差。在这种情况下，$k = k_{\\mathrm{IM}} - k_{\\mathrm{SI}} = 5 - 4 = 1$。\n\n然而，本问题呈现了一个标准条件被违反的情况。零假设 $m=0$ 将参数 $m$ 置于其允许参数空间 $m \\in [0, \\infty)$ 的边界上。这是统计理论中一个众所周知的问题。\n\n根据 Chernoff (1954) 和 Self & Liang (1987) 的研究，对于在边界上检验的单个参数，LRT 统计量的渐近零分布不是一个简单的 $\\chi^2_1$ 分布，而是一个混合分布。其逻辑是，如果真实值为 $m=0$，那么在较复杂模型中，$m$ 的最大似然估计 $\\hat{m}_{\\mathrm{IM}}$ 大约有一半的概率会落在边界上（$0$），另一半的概率会落在内部（$\\hat{m}_{\\mathrm{IM}} > 0$）。\n- 如果 $\\hat{m}_{\\mathrm{IM}} = 0$，那么拟合的 IM 模型与拟合的 SI 模型相同。因此，$\\ln \\hat{L}_{\\mathrm{IM}} = \\ln \\hat{L}_{\\mathrm{SI}}$，统计量 $D=0$。\n- 如果 $\\hat{m}_{\\mathrm{IM}} > 0$，统计量 $D$ 的行为与标准情况一样，服从 $\\chi^2_1$ 分布。\n\n因此，$D$ 的渐近零分布是一个在 $0$ 处的点质量（一个 $\\chi^2_0$ 分布）和一个 $\\chi^2_1$ 分布的 $50:50$ 混合。这可以写成：\n$$ D \\xrightarrow{H_0, d} 0.5 \\chi^2_0 + 0.5 \\chi^2_1 $$\n其概率密度函数是在零点的一个狄拉克函数和 $\\chi^2_1$ 密度的组合。对于一个观测到的统计量 $D_{obs}$，$p$ 值必须从这个混合分布计算。\n\n第 3 部分：渐近 $p$ 值的计算\n\n首先，我们使用给定的最大对数似然值计算检验统计量的观测值 $D_{obs}$：\n$$ \\ln \\hat{L}_{\\mathrm{SI}} = -1204.5 $$\n$$ \\ln \\hat{L}_{\\mathrm{IM}} = -1200.0 $$\n观测到的统计量为：\n$$ D_{obs} = 2 \\left( (-1200.0) - (-1204.5) \\right) = 2(4.5) = 9.0 $$\n\n接下来，我们计算 $p$ 值，即在零假设为真的情况下，观测到等于或比 $D_{obs}$ 更极端的检验统计量的概率。\n$$ p = P(D \\geq D_{obs} | H_0) = P(D \\geq 9.0 | H_0) $$\n使用推导出的混合分布：\n$$ p = P(D \\geq 9.0 | D \\sim 0.5 \\chi^2_0 + 0.5 \\chi^2_1) $$\n$$ p = 0.5 \\times P(\\chi^2_0 \\geq 9.0) + 0.5 \\times P(\\chi^2_1 \\geq 9.0) $$\n项 $P(\\chi^2_0 \\geq 9.0)$ 是一个全部质量集中在 $0$ 的随机变量大于等于 $9.0$ 的概率。这个概率恰好是 $0$。\n表达式简化为：\n$$ p = 0.5 \\times P(\\chi^2_1 \\geq 9.0) $$\n一个自由度为一的卡方变量 $\\chi^2_1$，等价于一个标准正态变量 $Z \\sim \\mathcal{N}(0, 1)$ 的平方。\n$$ P(\\chi^2_1 \\geq 9.0) = P(Z^2 \\geq 9.0) = P(|Z| \\geq \\sqrt{9.0}) = P(|Z| \\geq 3.0) $$\n这是 Z 分数为 $3.0$ 的双尾概率。通过标准统计表或计算，$\\chi^2_1$ 分布在 $9.0$ 处的生存函数约等于 $0.0026998$。\n$$ P(\\chi^2_1 \\geq 9.0) \\approx 0.0026998 $$\n将此值代入 $p$ 值的方程中：\n$$ p = 0.5 \\times 0.0026998 \\approx 0.0013499 $$\n按要求四舍五入到四位有效数字，最终的 $p$ 值为 $0.001350$。这等价于 $1.350 \\times 10^{-3}$。如此小的 $p$ 值为拒绝严格隔离的零假设、支持包含迁移的模型提供了强有力的证据。", "answer": "$$\\boxed{1.350 \\times 10^{-3}}$$", "id": "2610629"}]}