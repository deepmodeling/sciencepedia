{"hands_on_practices": [{"introduction": "Patterson的$D$统计量，通常称为ABBA-BABA检验，是检测群体间古代基因流（基因渗入）的基石。这种强大的方法利用全基因组范围的单核苷酸多态性（SNPs）来检验非姊妹类群间共享衍生等位基因的过量情况，这是一种违反预期待物种树关系的模式。本练习提供了一个直接的动手实践机会，让您从基因组数据中计算$D$统计量，并使用区块刀切法（block jackknife procedure）评估其统计显著性，这是一种在基因组分析中估算不确定性的稳健技术。[@problem_id:2607877]", "problem": "您正在研究与同倍体杂交物种形成相关的潜在基因渗入，使用一个四分类单元检验来分析三个内群分类单元和一个外群（排列为 $((P_1,P_2),P_3)$，外群为 $O$）之间衍生等位基因共享的不对称性。在一个双等位基因的单核苷酸多态性（SNP）位点上，$ABBA$ 位点是指相对于外群的祖先等位基因 $A$，衍生等位基因 $B$ 出现在 $P_2$ 和 $P_3$ 中但未出现在 $P_1$ 中的位点，而 $BABA$ 位点是指衍生等位基因 $B$ 出现在 $P_1$ 和 $P_3$ 中但未出现在 $P_2$ 中的位点。在无基因渗入的原假设下，仅由于不完全谱系分选，预计 $ABBA$ 和 $BABA$ 的计数在所有位点上是对称的。\n\n为了处理连锁问题，您已将基因组划分为 $50$ 个不重叠的区块。在每个区块中，您统计了信息性 $ABBA$ 和 $BABA$ 位点的数量。所有区块中信息性位点的总数是相等的。数据如下：\n\n- 区块 $1$ 至 $10$：$ABBA=55$, $BABA=45$。\n- 区块 $11$ 至 $20$：$ABBA=53$, $BABA=47$。\n- 区块 $21$ 至 $30$：$ABBA=52$, $BABA=48$。\n- 区块 $31$ 至 $40$：$ABBA=51$, $BABA=49$。\n- 区块 $41$ 至 $50$：$ABBA=49$, $BABA=51$。\n\n使用 Patterson’s $D$ 统计量的标准定义（即所有位点上 $ABBA$ 和 $BABA$ 计数的归一化差异），并对 $50$ 个区块使用“删一区块”刀切法（delete-one-block jackknife）来估计 $D$ 的标准误，请计算：\n- 使用所有区块计算的 $D$ 的点估计值，\n- $D$ 的刀切法标准误，\n- 在标准正态近似下的相应 $Z$ 分数。\n\n假设每个区块贡献了相同数量的信息性位点，并使用针对比率统计量的常规“删一区块”刀切方差估计量。基于 $Z$ 分数的大小，在显著性水平 $\\alpha=0.05$ 下检验是否存在基因渗入，但仅报告数值。\n\n将您的最终数值答案表示为一个单行向量，顺序为 $D$、标准误、$Z$ 分数，并四舍五入至三位有效数字。不要包含单位。", "solution": "问题陈述已经过验证，被认为是科学可靠、问题明确且客观的。这是群体遗传学中 ABBA-BABA 检验和刀切法重采样的标准应用。我们可以开始求解。\n\n任务是计算 Patterson's $D$ 统计量、通过“删一区块”刀切法得到的标准误，以及相应的 $Z$ 分数。该系统由三个内群分类单元 $(P_1, P_2, P_3)$ 和一个外群 $O$ 组成，其指定的系统发育关系为 $((P_1,P_2),P_3)$。\n\n首先，我们将所有区块中 $ABBA$ 位点的总计数表示为 $N_{ABBA}$，将 $BABA$ 位点的总计数表示为 $N_{BABA}$。数据是针对 $n=50$ 个区块提供的，这些区块被分为五组，每组 $10$ 个区块。\n\n每组 $10$ 个区块的计数如下：\n- 第 1 组 (区块 $1-10$): $C_{ABBA}=55$, $C_{BABA}=45$。\n- 第 2 组 (区块 $11-20$): $C_{ABBA}=53$, $C_{BABA}=47$。\n- 第 3 组 (区块 $21-30$): $C_{ABBA}=52$, $C_{BABA}=48$。\n- 第 4 组 (区块 $31-40$): $C_{ABBA}=51$, $C_{BABA}=49$。\n- 第 5 组 (区块 $41-50$): $C_{ABBA}=49$, $C_{BABA}=51$。\n\n总计数通过将所有 $50$ 个区块的贡献相加计算得出：\n$$ N_{ABBA} = 10 \\times 55 + 10 \\times 53 + 10 \\times 52 + 10 \\times 51 + 10 \\times 49 $$\n$$ N_{ABBA} = 10 \\times (55 + 53 + 52 + 51 + 49) = 10 \\times 260 = 2600 $$\n$$ N_{BABA} = 10 \\times 45 + 10 \\times 47 + 10 \\times 48 + 10 \\times 49 + 10 \\times 51 $$\n$$ N_{BABA} = 10 \\times (45 + 47 + 48 + 49 + 51) = 10 \\times 240 = 2400 $$\n\nPatterson's $D$ 统计量定义为 $ABBA$ 和 $BABA$ 位点计数的归一化差异：\n$$ D = \\frac{N_{ABBA} - N_{BABA}}{N_{ABBA} + N_{BABA}} $$\n使用总计数，$D$ 的点估计值为：\n$$ D = \\frac{2600 - 2400}{2600 + 2400} = \\frac{200}{5000} = \\frac{1}{25} = 0.04 $$\n\n接下来，我们使用“删一区块”刀切法计算 $D$ 的标准误。令 $n=50$ 为区块的数量。令 $D_i$ 为移除第 $i$ 个区块后的数据集上计算出的 $D$ 统计量的估计值。$D$ 的刀切方差由下式给出：\n$$ \\text{Var}_{\\text{jack}}(D) = \\frac{n-1}{n} \\sum_{i=1}^{n} (D_i - \\bar{D}_{\\text{jack}})^2 $$\n其中 $\\bar{D}_{\\text{jack}} = \\frac{1}{n} \\sum_{i=1}^{n} D_i$。\n\n设 $C_{ABBA,i}$ 和 $C_{BABA,i}$ 为第 $i$ 个区块中的计数。问题陈述指出每个区块的信息性位点总数是恒定的。对于任何区块 $i$，这个总数是 $C_{ABBA,i} + C_{BABA,i} = 100$。令这个常数为 $s = 100$。\n所有 $n$ 个区块的信息性位点总数是 $S = N_{ABBA} + N_{BABA} = 5000$。\n\n当移除区块 $j$ 时，重新计算的 $D$ 统计量 $D_j$ 为：\n$$ D_j = \\frac{(N_{ABBA} - C_{ABBA,j}) - (N_{BABA} - C_{BABA,j})}{(N_{ABBA} - C_{ABBA,j}) + (N_{BABA} - C_{BABA,j})} = \\frac{(N_{ABBA} - N_{BABA}) - (C_{ABBA,j} - C_{BABA,j})}{(N_{ABBA} + N_{BABA}) - (C_{ABBA,j} + C_{BABA,j})} $$\n$$ D_j = \\frac{200 - (C_{ABBA,j} - C_{BABA,j})}{5000 - 100} = \\frac{200 - (C_{ABBA,j} - C_{BABA,j})}{4900} $$\n因为对所有 $j$ 来说分母都是常数，所以 $\\bar{D}_{\\text{jack}}$ 精确等于完整的估计值 $D$。\n我们来检查一下推导。对于分母贡献恒定的比率统计量，这是一个已知的性质。\n来自思考过程的原始推导是正确的：$\\sum D_i = Y/c$ 其中 $Y = N_{ABBA}-N_{BABA}$ 且 $c$ 是分母的贡献。这导致 $\\bar{D}_{jack} = Y/(nc) \\neq D$。让我们重新评估。\n设 $y_i = C_{ABBA,i}-C_{BABA,i}$ 并且 $x_i = C_{ABBA,i}+C_{BABA,i}=s=100$。设 $Y=\\sum y_i$ 并且 $X=\\sum x_i = ns$。\n$D = Y/X = Y/(ns)$。\n$D_i = (\\sum_{j \\neq i} y_j) / (\\sum_{j \\neq i} x_j) = (Y-y_i)/(X-x_i) = (Y-y_i)/((n-1)s)$。\n$\\bar{D}_{\\text{jack}} = \\frac{1}{n} \\sum D_i = \\frac{1}{n(n-1)s} \\sum(Y-y_i) = \\frac{1}{n(n-1)s} (nY-Y) = \\frac{Y(n-1)}{n(n-1)s} = \\frac{Y}{ns} = D$。\n该简化成立。方差估计量为 $\\text{Var}_{\\text{jack}}(D) = \\frac{n-1}{n} \\sum_{i=1}^{n} (D_i - D)^2$。\n\n我们有五组不同的 $D_i$ 值。设 $d_j = C_{ABBA,j} - C_{BABA,j}$。并且，$D = 0.04 = \\frac{196}{4900}$。\n- 对于区块 $1-10$：$d_j = 55-45=10$。$D_j = \\frac{200-10}{4900} = \\frac{190}{4900}$。$D_j-D = \\frac{190-196}{4900} = -\\frac{6}{4900}$。\n- 对于区块 $11-20$：$d_j = 53-47=6$。$D_j = \\frac{200-6}{4900} = \\frac{194}{4900}$。$D_j-D = \\frac{194-196}{4900} = -\\frac{2}{4900}$。\n- 对于区块 $21-30$：$d_j = 52-48=4$。$D_j = \\frac{200-4}{4900} = \\frac{196}{4900}$。$D_j-D = 0$。\n- 对于区块 $31-40$：$d_j = 51-49=2$。$D_j = \\frac{200-2}{4900} = \\frac{198}{4900}$。$D_j-D = \\frac{198-196}{4900} = \\frac{2}{4900}$。\n- 对于区块 $41-50$：$d_j = 49-51=-2$。$D_j = \\frac{200-(-2)}{4900} = \\frac{202}{4900}$。$D_j-D = \\frac{202-196}{4900} = \\frac{6}{4900}$。\n\n平方差之和为：\n$$ \\sum_{i=1}^{50} (D_i - D)^2 = 10 \\left[ \\left(-\\frac{6}{4900}\\right)^2 + \\left(-\\frac{2}{4900}\\right)^2 + (0)^2 + \\left(\\frac{2}{4900}\\right)^2 + \\left(\\frac{6}{4900}\\right)^2 \\right] $$\n$$ \\sum_{i=1}^{50} (D_i - D)^2 = \\frac{10}{4900^2} [36 + 4 + 0 + 4 + 36] = \\frac{10 \\times 80}{4900^2} = \\frac{800}{4900^2} $$\n刀切方差为：\n$$ \\text{Var}_{\\text{jack}}(D) = \\frac{50-1}{50} \\times \\frac{800}{4900^2} = \\frac{49}{50} \\times \\frac{800}{(49 \\times 100)^2} = \\frac{49}{50} \\times \\frac{800}{49^2 \\times 100^2} $$\n$$ \\text{Var}_{\\text{jack}}(D) = \\frac{1}{50} \\times \\frac{800}{49 \\times 10000} = \\frac{16}{49 \\times 10000} = \\frac{16}{490000} $$\n刀切标准误，$SE_{\\text{jack}}(D)$，是方差的平方根：\n$$ SE_{\\text{jack}}(D) = \\sqrt{\\frac{16}{490000}} = \\frac{4}{700} = \\frac{1}{175} $$\n数值上，$SE_{\\text{jack}}(D) \\approx 0.00571428...$\n\n最后，在原假设 $H_0: D=0$ 下计算 $Z$ 分数。\n$$ Z = \\frac{D - 0}{SE_{\\text{jack}}(D)} = \\frac{D}{SE_{\\text{jack}}(D)} $$\n$$ Z = \\frac{1/25}{1/175} = \\frac{175}{25} = 7 $$\n问题要求报告 $D$、标准误和 $Z$ 分数的数值，均四舍五入至三位有效数字。\n- $D = 0.04$。保留三位有效数字，结果是 $0.0400$。\n- $SE_{\\text{jack}}(D) = 1/175 \\approx 0.00571428...$。保留三位有效数字，结果是 $0.00571$。\n- $Z = 7$。保留三位有效数字，结果是 $7.00$。\n\n计算出的 $Z$ 分数 $7.00$ 在量级上远大于在显著性水平 $\\alpha = 0.05$ 下的标准临界值 $1.96$，这表明强烈拒绝无基因渗入的原假设。但是，根据指示，仅报告数值结果。\n最终结果是：\n- $D$ 的点估计值：$0.0400$\n- $D$ 的刀切法标准误：$0.00571$\n- $Z$ 分数：$7.00$", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.0400 & 0.00571 & 7.00 \\end{pmatrix} } $$", "id": "2607877"}, {"introduction": "虽然Patterson的$D$统计量可以识别等位基因共享的不对称性，但另一种互补的方法是利用整个基因组中单个基因树的拓扑结构。在标准的多物种溯祖模型下，仅由不完全谱系分选（Incomplete Lineage Sorting, ILS）产生的不一致基因树会以可预测的比例出现，具体来说，两种可能的不一致拓扑结构预期出现的频率相等。本练习挑战您像统计遗传学家一样思考：您将评估几种备选的假设检验框架，以正确地区分基因渗入的特征——即某一种不一致拓扑结构的过量——与ILS产生的对称性噪音。[@problem_id:2607882]", "problem": "您正在研究一个由三个近缘物种 $A$、$B$ 和 $C$ 组成的演化支，怀疑其中发生了同倍体杂交物种形成。一个外群 $O$ 可用于确定关系的极性。您已在 $L=600$ 个非连锁基因座（每个基因座跨越一个无重组区域）上推断出有根基因树。推断出的拓扑结构（仅限于四元组 $\\{A,B,C,O\\}$）总结如下：\n- 与物种树 $((A,B),C)$ 一致：$n_{\\text{conc}}=330$。\n- 不一致的拓扑结构 $((A,C),B)$：$n_{AC|B}=180$。\n- 不一致的拓扑结构 $((B,C),A)$：$n_{BC|A}=90$。\n假设基因树推断误差可以忽略不计，并且在不同的不一致拓扑结构之间大致对称。\n\n背景和基本原理：\n- 在多物种溯祖模型（MSC）下，即使没有基因流，不完全谱系分选（ILS）也会产生与物种树不一致的基因树。对于一个内部支长为 $t$（以溯祖单位计）的有根三分类单元物种树，MSC的一个核心特性是，在仅有ILS的情况下，两种不一致的基因树拓扑结构出现的概率相等。这是源于祖先群体中谱系的可交换性，这意味着，在内部支上未能溯祖合并的条件下，三对谱系中任意一对在更深的祖先群体中首先发生合并的概率是相等的。\n- 基因渗入引起的网状进化通过提高将发生渗入的谱系组合在一起的不一致拓扑结构的频率，打破了这种对称性。\n\n您的目标是选择一个有效的统计检验程序，该程序应：\n- 明确陈述适用于区分仅ILS与基因渗入的原假设和备择假设。\n- 指定一个具有已知或可计算的零分布的检验统计量。\n- 将I类错误控制在预设水平 $\\alpha=0.05$。\n- 当应用于上述数据集时，在有理由的情况下，能拒绝仅ILS模型。\n\n以下哪个选项满足这些要求，并且当应用于上述计数时，会在 $\\alpha=0.05$ 的水平上拒绝仅ILS模型？\n\nA. 将原假设 $H_{0}$ 定义为MSC下的仅ILS模型，这意味着两种不一致的拓扑结构以相等的概率出现。以不一致基因树的总数 $k=n_{AC|B}+n_{BC|A}$ 为条件，使用精确二项检验来检验 $H_{0}: p=\\tfrac{1}{2}$ 与 $H_{A}: p\\neq \\tfrac{1}{2}$，其中 $p$ 是一个不一致基因树属于 $((A,C),B)$ 类型的概率。使用检验统计量 $T=\\lvert n_{AC|B}-k/2\\rvert$ 和精确的二项零分布来计算双侧 $p$ 值，当 $p$ 值小于 $\\alpha=0.05$ 时拒绝原假设。为考虑任何残余连锁，将基因座划分为近似独立的基因组块，并通过对重抽样的区块重新计算 $T$ 的区块自助法来验证校准。将此检验应用于上述数据。\n\nB. 将 $H_{0}$ 定义为MSC下的仅ILS模型，且所有三种有根基因树拓扑结构具有相等的概率。对这3个拓扑类别进行卡方拟合优度检验，每个类别的期望计数为 $L/3$，当卡方 $p$ 值小于 $\\alpha=0.05$ 时拒绝原假设。将此检验应用于上述数据。\n\nC. 拟合一个带有一条基因渗入边的系统发育网络模型，并计算其在 $L$ 个基因树上的最大似然。拟合一个没有基因渗入的物种树模型，并计算其最大似然。使用似然比检验（LRT），其渐近零分布为 $\\chi^{2}$ 分布，自由度等于增加的基因渗入参数的数量，当LRT的 $p$ 值小于 $\\alpha=0.05$ 时拒绝原假设。\n\nD. 将 $H_{0}$ 定义为在物种树 $((A,B),C)$ 上、基于MSC的仅ILS模型，其参数（分化时间和有效群体大小）从数据中估计。定义检验统计量 $T=\\lvert n_{AC|B}-n_{BC|A}\\rvert$。通过参数自助法校准 $T$ 的零分布：在拟合的MSC模型下，模拟 $M=10{,}000$ 个独立的、包含 $L=600$ 个基因树的重复数据集，为每个数据集计算 $T^{*}$，并估计 $p$ 值为 $T^{*}\\ge T_{\\text{obs}}$ 的重复数据集所占的比例。如果自助法 $p$ 值小于 $\\alpha=0.05$，则拒绝原假设。将此程序应用于上述数据。\n\n选择所有适用项。", "solution": "该问题要求评估用于在不完全谱系分选（ILS）背景下，利用基因树拓扑结构计数来检测基因渗入的统计程序。该检验的基本原理源于多物种溯祖模型（MSC）。对于一个三分类单元的物种树，如本文所考虑的 $((A,B),C)$，MSC模型在无基因流的原假设（$H_0$：仅ILS）下做出了一个特定的预测。虽然对于足够长的内部支，与物种树一致的基因树拓扑结构 $((A,B),C)$ 预期是最常见的，但两种不一致的拓扑结构 $((A,C),B)$ 和 $((B,C),A)$ 被预测以相等的概率出现。这是因为，在ILS发生的条件下（即 $A$ 和 $B$ 的祖先谱系未能在其最近的共同祖先群体中合并），在更深的 $(A,B,C)$ 祖先群体中剩下的三个谱系是可交换的，意味着任意一对谱系首先合并的概率是相等的。\n\n网状进化，例如物种 $A$ 和 $C$ 之间的基因渗入，会转移遗传物质，增加它们之间共享祖先的频率，从而提高具有 $((A,C),B)$ 拓扑结构的基因树的计数。这打破了仅在ILS条件下预期的对称性。因此，基因渗入的统计检验可以被表述为检验两种不一致拓扑结构的计数是否显著偏离 $1:1$ 的比例。\n\n提供的数据是：\n-   总基因座数：$L=600$。\n-   一致拓扑结构 $((A,B),C)$ 的计数：$n_{\\text{conc}}=330$。\n-   不一致拓扑结构 $((A,C),B)$ 的计数：$n_{AC|B}=180$。\n-   不一致拓扑结构 $((B,C),A)$ 的计数：$n_{BC|A}=90$。\n\n不一致基因树的总数为 $k = n_{AC|B} + n_{BC|A} = 180 + 90 = 270$。原假设 $H_0$（仅ILS）预测，在这 $k=270$ 个不一致的树中，两种类型的期望计数是相等的：$E(n_{AC|B}) = E(n_{BC|A}) = k/2 = 135$。观测到的计数（180对90）显示出强烈的不对称性，我们现在必须使用每个选项中提出的程序，在 $\\alpha=0.05$ 的显著性水平上对其进行正式检验。\n\nA. 这个选项提出了一个基于不一致拓扑结构对称性的检验。\n-   **假设**：原假设是 $H_{0}: p=\\tfrac{1}{2}$，其中 $p$ 是随机选择一个不一致基因树其拓扑结构为 $((A,C),B)$ 的概率。备择假设是 $H_{A}: p\\neq \\tfrac{1}{2}$。这正确地形式化了检验基因渗入导致的对称性破缺。\n-   **检验和统计量**：该方法以不一致树的总数 $k=270$ 为条件，并使用精确二项检验。这是一个标准且在统计上有效的方法。它正确地将“试验”次数确定为 $k=270$，将“成功”次数（例如，拓扑结构 $((A,C),B)$）确定为 $n_{AC|B}=180$。检验统计量 $T=\\lvert n_{AC|B}-k/2\\rvert$ 衡量了与原假设期望值的偏差。\n-   **应用**：我们检验在 $270$ 次试验中观察到 $180$ 次成功是否与 $H_0: p=0.5$ 下的期望值 $135$ 有显著差异。双侧 $p$ 值是观察到至少与 $180$ 一样极端的结果的概率，即 $P(X \\ge 180) + P(X \\le 90)$，其中 $X \\sim B(270, 0.5)$。由于样本量大，我们可以使用正态分布近似二项分布并进行连续性校正。均值为 $\\mu = kp = 270 \\times 0.5 = 135$，标准差为 $\\sigma = \\sqrt{kp(1-p)} = \\sqrt{270 \\times 0.5 \\times 0.5} = \\sqrt{67.5} \\approx 8.216$。Z-分数为：\n$$ Z = \\frac{\\lvert n_{AC|B} - \\mu \\rvert - 0.5}{\\sigma} = \\frac{\\lvert 180 - 135 \\rvert - 0.5}{8.216} = \\frac{44.5}{8.216} \\approx 5.416 $$\n在 $\\alpha=0.05$ 的双侧检验中，临界Z值为 $Z_{\\alpha/2} = 1.96$。由于我们观察到的Z分数 $5.416$ 远大于 $1.96$，因此 $p$ 值极小（$p \\ll 0.05$）。因此，原假设将被拒绝。提及区块自助法是关于处理潜在连锁数据的良好实践的一个额外细节，但并不改变核心统计程序本身的有效性。\n-   **结论**：**正确**。该程序在统计上是有效的，并且根据给定的数据会导致对原假设的拒绝。\n\nB. 这个选项提出了一个卡方拟合优度检验。\n-   **假设**：$H_0$ 是所有三种有根基因树拓扑结构具有相等的概率，即 $P(((A,B),C)) = P(((A,C),B)) = P(((B,C),A)) = 1/3$。\n-   **评析**：这个原假设在科学上是不合理的。对于分岔的物种树，MSC模型并不预测三种拓扑结构具有相等的概率，除非是内部支长为 $t=0$（硬多歧分枝）的特殊情况。对于任何 $t>0$，一致拓扑结构的概率为 $P_{\\text{conc}} = 1 - \\frac{2}{3}e^{-t}$，而每个不一致拓扑结构的概率为 $P_{\\text{disc}} = \\frac{1}{3}e^{-t}$。因此，对于任何已解析的物种历史，$P_{\\text{conc}} > P_{\\text{disc}}$。针对一个错误的原假设进行检验并不构成区分指定物种树上ILS与基因渗入的有效检验。\n-   **结论**：**不正确**。该程序无效，因为其原假设错误地表述了仅ILS模型。\n\nC. 这个选项提出了一个在系统发育网络和物种树之间的似然比检验（LRT）。\n-   **程序**：这是一个功能强大、基于模型的方法，直接比较数据在有基因渗入的模型（$H_A$）和没有基因渗入的模型（$H_0$）下的似然。\n-   **评析**：该程序指定使用LRT统计量的渐近 $\\chi^{2}$ 零分布。在这种情况下，这是一个关键的统计错误。无基因渗入的原假设将基因渗入概率参数 $\\gamma$ 设置为零。由于 $\\gamma$ 不能为负，这是一个在参数空间边界上的检验。产生渐近 $\\chi^2$ 分布的标准LRT理论在这种情况下不成立。正确的渐近零分布是 $\\chi^2$ 分布的混合（例如，在0处的点质量和 $\\chi^2_1$ 分布的 $50:50$ 混合）。使用标准的 $\\chi^2$ 分布将导致检验校准不当，通常会夸大I类错误率。一个未能在指定水平 $\\alpha$ 上控制I类错误的程序是无效的。\n-   **结论**：**不正确**。由于检验统计量的零分布指定错误，所述程序在统计上是无效的。\n\nD. 这个选项提出了一个参数自助法程序。\n-   **假设和统计量**：原假设是物种树 $((A,B),C)$ 上的仅ILS模型，检验统计量是 $T=\\lvert n_{AC|B}-n_{BC|A}\\rvert$。这个统计量直接量化了作为基因渗入标志的不对称性。对于观察到的数据，$T_{\\text{obs}} = \\lvert 180 - 90 \\rvert = 90$。\n-   **程序**：使用参数自助法来生成 $T$ 的零分布。这包括（1）在 $H_0$ 下使用观察数据估计MSC模型的参数（例如，支长），（2）从此拟合的零模型中模拟大量包含 $L=600$ 个基因树的重复数据集，（3）为每个重复计算统计量 $T^*$，以及（4）通过 $T^* \\ge T_{\\text{obs}}$ 的重复所占的比例来计算 $p$ 值。\n-   **评析**：这是一个统计上严谨且有效的框架。参数自助法是复杂模型中假设检验的黄金标准方法，因为它不依赖于可能不合适的渐近理论（如选项C中）。它构建了一个能准确反映原假设的经验零分布。\n-   **应用**：在 $H_0$ 下，两种不一致拓扑结构的发生率是相等的。一致树的比例是 $330/600 = 0.55$。这允许在MSC下估计内部支长：$1 - \\frac{2}{3}e^{-t} = 0.55 \\implies t \\approx 0.393$。每个不一致拓扑结构的期望比例是 $\\frac{1}{3}e^{-t} \\approx 0.225$。因此，期望计数为 $n_{AC|B} = n_{BC|A} = 600 \\times 0.225 = 135$。观察到的统计量 $T_{\\text{obs}} = 90$ 代表了与期望差异 $0$ 的巨大偏差。几乎可以肯定，参数自助法将产生一个远小于 $0.05$ 的 $p$ 值，从而导致对 $H_0$ 的拒绝。\n-   **结论**：**正确**。该程序在统计上是有效且稳健的，并且会根据给定的数据拒绝原假设。\n\n总之，选项A和选项D都描述了检验基因渗入假说的有效统计程序，并且鉴于所提供的基因树计数中存在的巨大不对称性，两者都会导致对仅ILS原假设的强烈拒绝。", "answer": "$$\\boxed{AD}$$", "id": "2607882"}, {"introduction": "在杂交事件发生后，混合个体的基因组是由来自不同亲本物种的片段组成的嵌合体。在随后的世代中，重组会稳定地分解这些祖源片段。本练习将重点从检测杂交转移到模拟其基因组后果，要求您从第一性原理出发，推导出在一定代数后祖源片段的预期数量和长度的基本方程。掌握这个模型将为您理解杂交谱系基因组中观察到的祖源模式提供定量的基础。[@problem_id:2607831]", "problem": "一个二倍体动物谱系在 $t$ 代前，其亲本物种 $\\mathrm{A}$ 和 $\\mathrm{B}$之间经历了一次单一的杂交脉冲，产生了一个混合群体。此后，该群体在一个非常大的、无选择作用的群体中随机交配。在脉冲发生时，物种 $\\mathrm{A}$（供体）对混合基因库的贡献为 $m$，因此此后在每个基因座上，来自 $\\mathrm{A}$ 的边际祖源频率均为 $m$。假设以下基本原理：\n- 沿着遗传长度为 $L$ 摩根（Morgan）的染色体，每次减数分裂的预期交换次数等于 $L$，且交换位置遵循无干涉的泊松过程。\n- 在一个大的随机交配群体中，在没有选择或漂变的情况下，一个位点的祖源杂合性在各代中保持为 $2 m (1-m)$。\n- 当减数分裂中，在祖源杂合的位置发生交换时，会产生一个祖源连接点。\n\n给定三个常染色体的重组图，以厘摩根（cM）为单位给出遗传标记位置，其中 $1$ 厘摩根（cM）= $0.01$ 摩根（M）。对于每条染色体，标记物覆盖了从列出的第一个标记到最后一个标记的整个染色体（即，在所列范围之外没有额外的遗传长度），并且相邻标记之间的区间被完全覆盖。\n\n染色体 1 标记物（cM）：$0, 20, 55, 95, 135$。\n\n染色体 2 标记物（cM）：$0, 30, 60, 95$。\n\n染色体 3 标记物（cM）：$0, 25, 48, 70$。\n\n设供体祖源比例为 $m = 0.30$，混合脉冲至今的时间为 $t = 20$ 代。在连续基因组极限下进行计算，并忽略由染色体末端引起的末端效应。\n\n仅使用上述基本原理，从第一性原理推导出以下表达式：\n1) $t$ 代后，三个常染色体上物种 $\\mathrm{A}$ 祖源片段的期望数量。\n2) $t$ 代后，物种 $\\mathrm{A}$ 祖源片段的平均长度。\n\n然后，根据给定数据对这些表达式进行数值计算。将期望数量表示为纯数，平均长度以摩根为单位表示。两个数值结果均四舍五入至四位有效数字。按（期望数量，平均长度）的顺序提供你的最终答案。", "solution": "该问题被验证为自洽、有科学依据且定义明确。解答过程遵循所提供的基本原理，推导出所需的表达式。\n\n设 $m$ 为来自物种 A 的供体祖源比例，$t$ 为自混合脉冲以来的代数。基因组的总遗传长度为 $L_{total}$，由 $N_{chr} = 3$ 条染色体组成。\n\n**1. 祖源片段期望数量的推导**\n\n我们首先推导祖源连接点的期望密度。祖源连接点是染色体上祖源发生转换（例如，从物种 A 到 B，或从 B 到 A）的点。\n\n根据问题陈述的基本原理：\n- 当减数分裂中，在祖源杂合的位置发生交换时，会产生一个连接点。\n- 沿着长度为 $L$ 摩根的染色体，每次减数分裂的预期交换次数为 $L$。对于泊松过程，这意味着每摩根每次减数分裂的交换率为 $1$。\n- 任何位点的祖源杂合性，即二倍体个体在该位点为祖源杂合的概率，给定为一个恒定值 $H = 2m(1-m)$。\n\n每摩根、每代新连接点形成的速率是交换率与祖源杂合性概率的乘积。设 $\\rho(t)$ 为第 $t$ 代时每摩根的连接点密度。该密度的变化率为：\n$$\n\\frac{d\\rho(t)}{dt} = (\\text{交换率}) \\times (\\text{祖源杂合性}) = 1 \\times [2m(1-m)] = 2m(1-m)\n$$\n我们假设在脉冲发生时，$t=0$，染色体为纯 A 或纯 B 祖源，因此任何染色体内都没有连接点。因此，初始条件为 $\\rho(0) = 0$。\n\n对该微分方程从 $t=0$ 到当前代 $t$ 进行积分，得到累积的总连接点密度：\n$$\n\\rho(t) = \\int_{0}^{t} 2m(1-m) \\,d\\tau = 2m(1-m)t\n$$\n整个基因组中连接点的总期望数量 $E[N_J]$ 是此密度与基因组总遗传长度 $L_{total}$ 的乘积：\n$$\nE[N_J] = \\rho(t) \\times L_{total} = 2m(1-m)tL_{total}\n$$\n问题要求的是 A-祖源片段的期望数量 $E[N_A]$。我们被指示忽略由染色体末端引起的末端效应。这意味着模型假设基因组足够长，以至于染色体末端的片段不会显著改变整体统计数据。在此极限下，A-片段的数量预期与 B-片段的数量相等，因为任何从 A 到 B 的转换之后都必须有从 B 到 A 的转换才能形成下一个 A-片段。片段的总数约等于连接点的数量。因此，A-片段的数量是连接点总数的一半。\n$$\nE[N_A] = \\frac{1}{2} E[N_J]\n$$\n代入 $E[N_J]$ 的表达式，我们得到第一个所需的表达式：\n$$\nE[N_A] = \\frac{1}{2} [2m(1-m)tL_{total}] = m(1-m)tL_{total}\n$$\n\n**2. 祖源片段平均长度的推导**\n\nA-祖源片段的平均长度是所有 A-祖源区段的总期望长度除以 A-祖源片段的期望数量。\n\n在总长度为 $L_{total}$ 的基因组中，物种 A 祖源的总期望长度 $E[L_{A,total}]$ 由 A-祖源的比例 $m$ 乘以总长度给出：\n$$\nE[L_{A,total}] = m \\times L_{total}\n$$\nA-片段的平均长度 $E[\\bar{L}_A]$ 则为：\n$$\nE[\\bar{L}_A] = \\frac{E[L_{A,total}]}{E[N_A]}\n$$\n代入我们为 $E[L_{A,total}]$ 和 $E[N_A]$ 推导出的表达式：\n$$\nE[\\bar{L}_A] = \\frac{m L_{total}}{m(1-m)tL_{total}}\n$$\n$m$ 和 $L_{total}$ 项相消，得到第二个所需的表达式：\n$$\nE[\\bar{L}_A] = \\frac{1}{(1-m)t}\n$$\n此结果与基因组总长度无关，仅取决于混合后的时间以及另一祖源的比例。\n\n**3. 数值计算**\n\n首先，我们根据提供的标记物数据计算总遗传长度 $L_{total}$。单位换算为 $1 \\text{ cM} = 0.01 \\text{ M}$。\n- 染色体 $1$ 长度：$L_1 = (135 - 0) \\text{ cM} = 135 \\text{ cM} = 1.35 \\text{ M}$。\n- 染色体 $2$ 长度：$L_2 = (95 - 0) \\text{ cM} = 95 \\text{ cM} = 0.95 \\text{ M}$。\n- 染色体 $3$ 长度：$L_3 = (70 - 0) \\text{ cM} = 70 \\text{ cM} = 0.70 \\text{ M}$。\n\n三个常染色体的总长度为：\n$$\nL_{total} = L_1 + L_2 + L_3 = 1.35 \\text{ M} + 0.95 \\text{ M} + 0.70 \\text{ M} = 3.00 \\text{ M}\n$$\n给定的参数是 $m = 0.30$ 和 $t = 20$ 代。\n\n现在我们计算推导出的表达式，并按要求四舍五入至四位有效数字。\n\n物种 A 祖源片段的期望数量：\n$$\nE[N_A] = m(1-m)tL_{total} = (0.30)(1 - 0.30)(20)(3.00) = (0.30)(0.70)(60) = 0.21 \\times 60 = 12.6\n$$\n四舍五入至四位有效数字，结果为 $12.60$。\n\n物种 A 祖源片段的平均长度（以摩根为单位）：\n$$\nE[\\bar{L}_A] = \\frac{1}{(1-m)t} = \\frac{1}{(1 - 0.30)(20)} = \\frac{1}{(0.70)(20)} = \\frac{1}{14} \\text{ M}\n$$\n作为小数，这大约是 $0.07142857...$ M。四舍五入至四位有效数字，结果是 $0.07143$ M。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n12.60 & 0.07143\n\\end{pmatrix}\n}\n$$", "id": "2607831"}]}