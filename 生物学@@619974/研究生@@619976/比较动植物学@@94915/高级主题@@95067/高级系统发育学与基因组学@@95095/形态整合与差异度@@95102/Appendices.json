{"hands_on_practices": [{"introduction": "衡量形态整合的第一步是量化性状之间的共变关系。虽然协方差矩阵 ($S$) 提供了这种共变的原始度量，但其数值受性状尺度影响，不便于比较。此练习将指导你如何从协方差矩阵计算出无量纲的相关性矩阵 ($R$)，并基于相关系数来计算一个整体整合指数，这是理解和比较不同系统间整合强度的基础。", "problem": "一项关于某谱系中形态整合的比较研究，考察了在 $n=30$ 个个体中测量的 $3$ 个线性性状之间的协变关系。这些性状的样本协方差矩阵为\n$$\nS=\\begin{pmatrix}\n2 & 1 & 0 \\\\\n1 & 1 & 0.5 \\\\\n0 & 0.5 & 0.5\n\\end{pmatrix}.\n$$\n仅使用基本定义，完成以下任务：\n1) 计算由 $S$ 所蕴含的性状相关矩阵 $R$。\n2) 将两个性状之间的两两形态整合定义为其相关系数的绝对值。据此，计算总体整合指数\n$$\nI=\\frac{|r_{12}|+|r_{13}|+|r_{23}|}{3},\n$$\n其中 $r_{ij}$ 是性状 $i$ 和性状 $j$ 之间的相关系数。\n3) 基于 $R$，简要解释哪些性状对表现出更强的形态整合。\n\n最终数值答案只报告 $I$ 的值，以无单位的纯数形式表示，并四舍五入至四位有效数字。", "solution": "问题陈述连贯且在数学上是适定的。所给的样本协方差矩阵 $S$ 是对称且半正定的，这是对此类矩阵的一个必要且有效的条件。个体数量 $n=30$ 是背景信息，对于所要求的具体计算而言并非必需。我们通过完成三个指定任务来解答此题。\n\n首先，我们从给定的协方差矩阵 $S$ 计算性状相关矩阵 $R$。性状 $i$ 与性状 $j$ 之间的相关系数 $r_{ij}$ 由以下关系定义：\n$$\nr_{ij} = \\frac{s_{ij}}{\\sqrt{s_{ii}s_{jj}}}\n$$\n其中 $s_{ij}$ 是性状 $i$ 和 $j$ 之间的协方差，而 $s_{ii}$ 和 $s_{jj}$ 分别是性状 $i$ 和 $j$ 的方差。方差是协方差矩阵 $S$ 的对角线元素。\n\n从给定的矩阵\n$$\nS=\\begin{pmatrix}\n2 & 1 & 0 \\\\\n1 & 1 & 0.5 \\\\\n0 & 0.5 & 0.5\n\\end{pmatrix}\n$$\n方差为 $s_{11} = 2$，$s_{22} = 1$ 和 $s_{33} = 0.5$。相应的标准差为 $\\sigma_1 = \\sqrt{s_{11}} = \\sqrt{2}$，$\\sigma_2 = \\sqrt{s_{22}} = \\sqrt{1} = 1$ 和 $\\sigma_3 = \\sqrt{s_{33}} = \\sqrt{0.5} = \\frac{1}{\\sqrt{2}}$。\n\n现在我们计算相关矩阵 $R$ 的非对角线元素：\n对于性状 $1$ 和 $2$：\n$$\nr_{12} = \\frac{s_{12}}{\\sqrt{s_{11}s_{22}}} = \\frac{1}{\\sqrt{2 \\cdot 1}} = \\frac{1}{\\sqrt{2}}\n$$\n对于性状 $1$ 和 $3$：\n$$\nr_{13} = \\frac{s_{13}}{\\sqrt{s_{11}s_{33}}} = \\frac{0}{\\sqrt{2 \\cdot 0.5}} = \\frac{0}{\\sqrt{1}} = 0\n$$\n对于性状 $2$ 和 $3$：\n$$\nr_{23} = \\frac{s_{23}}{\\sqrt{s_{22}s_{33}}} = \\frac{0.5}{\\sqrt{1 \\cdot 0.5}} = \\frac{0.5}{\\sqrt{0.5}} = \\sqrt{0.5} = \\frac{1}{\\sqrt{2}}\n$$\n根据定义，任何相关矩阵的对角线元素都等于 $1$。因此，完整的相关矩阵 $R$ 为：\n$$\nR = \\begin{pmatrix}\n1 & \\frac{1}{\\sqrt{2}} & 0 \\\\\n\\frac{1}{\\sqrt{2}} & 1 & \\frac{1}{\\sqrt{2}} \\\\\n0 & \\frac{1}{\\sqrt{2}} & 1\n\\end{pmatrix}\n$$\n\n其次，我们计算总体整合指数 $I$。题目将该指数定义为两两形态整合的算术平均值，其中每个两两整合是相应相关系数的绝对值。\n$$\nI=\\frac{|r_{12}|+|r_{13}|+|r_{23}|}{3}\n$$\n代入计算出的值：\n$$\nI = \\frac{\\left|\\frac{1}{\\sqrt{2}}\\right| + |0| + \\left|\\frac{1}{\\sqrt{2}}\\right|}{3} = \\frac{\\frac{1}{\\sqrt{2}} + 0 + \\frac{1}{\\sqrt{2}}}{3} = \\frac{\\frac{2}{\\sqrt{2}}}{3} = \\frac{\\sqrt{2}}{3}\n$$\n题目要求数值答案保留四位有效数字。\n$$\nI = \\frac{\\sqrt{2}}{3} \\approx \\frac{1.41421356}{3} \\approx 0.4714045...\n$$\n四舍五入到四位有效数字，我们得到 $I \\approx 0.4714$。\n\n第三，我们解释哪些性状对表现出更强的形态整合。一对性状之间的整合强度由其相关系数的绝对值给出。\n两两整合的值为：\n$|r_{12}| = \\frac{1}{\\sqrt{2}} \\approx 0.7071$\n$|r_{13}| = 0$\n$|r_{23}| = \\frac{1}{\\sqrt{2}} \\approx 0.7071$\n基于这些值，性状对 $(1, 2)$ 和 $(2, 3)$ 表现出同等强度的形态整合。性状对 $(1, 3)$ 表现出零整合，意味着这两个性状不相关。这种结构表明，性状 $2$ 可能在性状 $1$ 和性状 $3$ 之间充当了发育或功能上的中介。", "answer": "$$\\boxed{0.4714}$$", "id": "2591594"}, {"introduction": "在形态学研究中，观察到的性状间共变往往由它们对生物体整体尺寸的共同响应（即异速生长）所驱动。为了揭示独立于尺寸的“真实”功能或发育整合，我们必须首先分离出这种尺寸效应。该练习将通过一个具体案例，演示如何运用线性回归计算偏相关系数，从而量化不受尺寸影响的形态整合程度。", "problem": "在一项跨越一个脊椎动物分支和一个被子植物分支的比较研究中，两个形态变量 $Z_1$ 和 $Z_2$ 概括了基于标定点构型的普氏（Procrustes）主成分分析（PCA）所得到的形态，而 $S$ 是对数中心体大小。假设所有这三个变量都经过标准化，均值为 $0$，方差为 $1$。$Z_1$、$Z_2$ 和 $S$ 之间的相关矩阵为\n$$\n\\mathbf{R} \\;=\\;\n\\begin{pmatrix}\n1 & \\frac{7}{10} & \\frac{\\sqrt{10}}{4} \\\\\n\\frac{7}{10} & 1 & \\frac{\\sqrt{10}}{4} \\\\\n\\frac{\\sqrt{10}}{4} & \\frac{\\sqrt{10}}{4} & 1\n\\end{pmatrix}.\n$$\n在形态整合与变异度的框架内，一种评估独立于体型的真实整合的常用策略是，将每个形态变量对体型进行回归，并评估所得残差之间的相关性。请仅使用线性回归、协方差和皮尔逊相关的定义，计算在将 $Z_1$ 和 $Z_2$ 分别对 $S$ 进行线性回归后，二者残差之间的皮尔逊相关性。\n\n将您的答案四舍五入至 $4$ 位有效数字。然后，基于计算出的这个值与原始相关性 $\\frac{7}{10}$ 的对比，简要解释这对于该数据集中真实整合与体型驱动的协变意味着什么。\n\n最终的数值相关值以无单位形式表示。解释部分不需要数值回答。", "solution": "首先验证问题的正确性和可解性。\n\n**步骤1：提取已知条件**\n- 形态变量: $Z_1, Z_2$\n- 体型变量: $S$ (对数中心体大小)\n- 所有变量 ($Z_1, Z_2, S$) 均已标准化，意味着均值为 $0$，方差为 $1$。\n- 这些变量的相关矩阵 $\\mathbf{R}$ 为：\n$$\n\\mathbf{R} \\;=\\;\n\\begin{pmatrix}\n1 & \\frac{7}{10} & \\frac{\\sqrt{10}}{4} \\\\\n\\frac{7}{10} & 1 & \\frac{\\sqrt{10}}{4} \\\\\n\\frac{\\sqrt{10}}{4} & \\frac{\\sqrt{10}}{4} & 1\n\\end{pmatrix}\n$$\n- 任务是计算在将 $Z_1$ 和 $Z_2$ 分别对 $S$ 进行线性回归后，二者残差之间的皮尔逊相关性。\n- 计算必须基于线性回归、协方差和相关性的基本原理。\n- 最终数值答案必须四舍五入至 $4$ 位有效数字。\n- 需要对结果进行简要解释。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上植根于形态计量学领域，特别是形态整合和异速生长的研究。所提供的相关矩阵在数学上是有效的，它是一个对角线为单位元的实对称正半定矩阵。所有必要信息均已提供。该问题是适定的、客观的、完整的。没有矛盾或歧义。\n\n**结论：该问题有效。**\n\n**步骤3：求解**\n我们的任务是计算在将 $Z_1$ 和 $Z_2$ 分别对 $S$ 回归后，二者残差之间的皮尔逊相关性。设残差分别用 $e_1$ 和 $e_2$ 表示。\n\n变量 $Z_1、Z_2$ 和 $S$ 是标准化的。这意味着它们的期望值为 $0$，方差为 $1$。\n$E[Z_1] = E[Z_2] = E[S] = 0$。\n$\\text{Var}(Z_1) = E[Z_1^2] - (E[Z_1])^2 = E[Z_1^2] = 1$。\n同理，$\\text{Var}(Z_2) = 1$ 且 $\\text{Var}(S) = 1$。\n\n对于任意两个标准化变量，例如 $X$ 和 $Y$，它们的协方差等于它们的相关性：\n$\\text{Cov}(X, Y) = E[XY] - E[X]E[Y] = E[XY]$。\n$\\text{Corr}(X, Y) = \\frac{\\text{Cov}(X, Y)}{\\sqrt{\\text{Var}(X)\\text{Var}(Y)}} = \\frac{E[XY]}{\\sqrt{1 \\cdot 1}} = E[XY]$。\n因此，$\\text{Cov}(X, Y) = \\text{Corr}(X, Y)$。给定的相关矩阵 $\\mathbf{R}$ 也是协方差矩阵。\n\n从矩阵 $\\mathbf{R}$ 中，我们得到：\n$\\rho_{12} = \\text{Corr}(Z_1, Z_2) = \\frac{7}{10}$\n$\\rho_{1S} = \\text{Corr}(Z_1, S) = \\frac{\\sqrt{10}}{4}$\n$\\rho_{2S} = \\text{Corr}(Z_2, S) = \\frac{\\sqrt{10}}{4}$\n\n首先，考虑 $Z_1$ 对 $S$ 的线性回归：$Z_1 = \\alpha_1 + \\beta_1 S + e_1$。\n斜率 $\\beta_1$ 的普通最小二乘估计由下式给出：\n$$\n\\beta_1 = \\frac{\\text{Cov}(Z_1, S)}{\\text{Var}(S)} = \\frac{\\rho_{1S}}{1} = \\rho_{1S} = \\frac{\\sqrt{10}}{4}\n$$\n截距 $\\alpha_1$ 的估计值为：\n$$\n\\alpha_1 = E[Z_1] - \\beta_1 E[S] = 0 - \\beta_1 \\cdot 0 = 0\n$$\n$Z_1$ 的预测值为 $\\hat{Z}_1 = \\beta_1 S = \\rho_{1S} S$。残差 $e_1$ 为：\n$$\ne_1 = Z_1 - \\hat{Z}_1 = Z_1 - \\rho_{1S} S\n$$\n同理，对于 $Z_2$ 对 $S$ 的回归，残差 $e_2$ 为：\n$$\ne_2 = Z_2 - \\rho_{2S} S\n$$\n现在，我们必须计算这些残差的皮尔逊相关系数 $\\text{Corr}(e_1, e_2)$：\n$$\n\\text{Corr}(e_1, e_2) = \\frac{\\text{Cov}(e_1, e_2)}{\\sqrt{\\text{Var}(e_1)\\text{Var}(e_2)}}\n$$\n我们分别计算这三个组成部分。\n\n1.  残差的协方差, $\\text{Cov}(e_1, e_2)$:\n    利用协方差算子的双线性性质：\n    $$\n    \\text{Cov}(e_1, e_2) = \\text{Cov}(Z_1 - \\rho_{1S} S, Z_2 - \\rho_{2S} S)\n    $$\n    $$\n    = \\text{Cov}(Z_1, Z_2) - \\rho_{2S}\\text{Cov}(Z_1, S) - \\rho_{1S}\\text{Cov}(S, Z_2) + \\rho_{1S}\\rho_{2S}\\text{Cov}(S, S)\n    $$\n    因为协方差等于相关性且方差为 $1$：\n    $$\n    = \\rho_{12} - \\rho_{2S}\\rho_{1S} - \\rho_{1S}\\rho_{2S} + \\rho_{1S}\\rho_{2S}\\text{Var}(S)\n    $$\n    $$\n    = \\rho_{12} - \\rho_{1S}\\rho_{2S}\n    $$\n    代入数值：\n    $$\n    \\text{Cov}(e_1, e_2) = \\frac{7}{10} - \\left(\\frac{\\sqrt{10}}{4}\\right)\\left(\\frac{\\sqrt{10}}{4}\\right) = \\frac{7}{10} - \\frac{10}{16} = \\frac{7}{10} - \\frac{5}{8} = \\frac{56 - 50}{80} = \\frac{6}{80} = \\frac{3}{40}\n    $$\n\n2.  残差 $e_1$ 的方差, $\\text{Var}(e_1)$:\n    $$\n    \\text{Var}(e_1) = \\text{Var}(Z_1 - \\rho_{1S} S) = \\text{Var}(Z_1) - 2\\rho_{1S}\\text{Cov}(Z_1, S) + \\rho_{1S}^2\\text{Var}(S)\n    $$\n    $$\n    = 1 - 2\\rho_{1S}(\\rho_{1S}) + \\rho_{1S}^2(1) = 1 - \\rho_{1S}^2\n    $$\n    代入 $\\rho_{1S}$ 的值：\n    $$\n    \\text{Var}(e_1) = 1 - \\left(\\frac{\\sqrt{10}}{4}\\right)^2 = 1 - \\frac{10}{16} = 1 - \\frac{5}{8} = \\frac{3}{8}\n    $$\n\n3.  残差 $e_2$ 的方差, $\\text{Var}(e_2)$:\n    根据对称性，由于 $\\rho_{1S} = \\rho_{2S}$：\n    $$\n    \\text{Var}(e_2) = 1 - \\rho_{2S}^2 = 1 - \\left(\\frac{\\sqrt{10}}{4}\\right)^2 = \\frac{3}{8}\n    $$\n\n最后，我们组合得到相关系数：\n$$\n\\text{Corr}(e_1, e_2) = \\frac{\\text{Cov}(e_1, e_2)}{\\sqrt{\\text{Var}(e_1)\\text{Var}(e_2)}} = \\frac{\\frac{3}{40}}{\\sqrt{\\frac{3}{8} \\cdot \\frac{3}{8}}} = \\frac{\\frac{3}{40}}{\\frac{3}{8}} = \\frac{3}{40} \\cdot \\frac{8}{3} = \\frac{8}{40} = \\frac{1}{5}\n$$\n相关性恰好为 $0.2$。为了表示为 $4$ 位有效数字，我们写成 $0.2000$。\n\n解释：\n形态变量 $Z_1$ 和 $Z_2$ 之间的原始相关性为 $\\rho_{12} = \\frac{7}{10} = 0.7$，这表示一个强的正相关关系。在剔除体型 $S$ 的线性效应后，残差之间的相关性为 $\\text{Corr}(e_1, e_2) = 0.2$，这是一个弱的正相关关系。这种从 $0.7$ 到 $0.2$ 的显著相关性降低意味着 $Z_1$ 和 $Z_2$ 之间的大部分协变是由对体型 $S$ 变化的共同响应（即异速生长效应）所驱动的。剩余的 $0.2$ 的弱相关性代表了这两个形态组分之间“真实”的或独立于体型的形态整合。因此，最初的强相关性在很大程度上是体型驱动协变的表现，而非内在的整合。", "answer": "$$\n\\boxed{0.2000}\n$$", "id": "2591593"}, {"introduction": "在分析中发现模块化模式（例如，模块间协方差低于模块内协方差）仅仅是研究的第一步；更关键的问题是，观测到的模式是否显著区别于随机预期的结果。此练习将引导你完成一个置换检验的完整逻辑，这是一种强大的非参数方法，用于评估观测到的模块化统计量（如此处的协方差比率，$\\mathrm{CR}$）的统计显著性并计算效应大小 ($z$)。", "problem": "一项关于一类草本植物形态整合的比较研究评估了两个性状集（一个叶模块和一个茎模块）之间的模块性。模块化假说认为，模块间的协变异比模块内的协变异弱。为评估此假说，该研究使用了协方差比（CR）统计量，其中较低的数值表示对模块化组织有更强的支持。观测到的协方差比为 $\\mathrm{CR}_{\\mathrm{obs}} = 0.892$。为了构建一个与无模块结构假说一致的零分布，研究人员在保持两个模块大小不变的情况下，将 $p$ 个性状的模块标签进行均匀随机置换，并为每次置换重新计算协方差比。总共进行了 $N = 10000$ 次置换。在此零分布下，经验均值为 $\\mu_{0} = 1.010$，经验标准差为 $\\sigma_{0} = 0.045$。在这些置换中，有 $k = 44$ 次得出的 $\\mathrm{CR}_{\\mathrm{perm}} \\le \\mathrm{CR}_{\\mathrm{obs}}$。假设一个用于检验模块性的单侧检验 $H_{A}$：$\\mathrm{CR}_{\\mathrm{obs}}$ 小于零假设下的期望值，并使用标准的置换 $p$ 值估计量，该估计量通过加一调整来避免零 $p$ 值。同时，计算标准化效应大小，公式为 $z = \\left(\\mathrm{CR}_{\\mathrm{obs}} - \\mu_{0}\\right)/\\sigma_{0}$。将你的 $p$ 值四舍五入到四位有效数字。最终的方框答案只写出 $p$ 值（无单位）。在你的解题过程中提供对统计显著性和效应大小的文字解释，但最终的方框答案中不包含任何解释。", "solution": "所陈述的问题在科学上是合理的，在计算上是明确定义的。它展示了非参数置换检验的一个标准应用，这是形态计量学和进化生物学等领域统计分析的基石。所有必要的数据均已提供，不存在内部矛盾或违反基本原则的情况。我们可以开始解题。\n\n该问题要求计算一个置换 $p$ 值和一个标准化效应大小，以检验形态模块性的假说。其背景是一项比较研究，其中的模块化假说认为，模块内部性状间的协变异强于不同模块间性状的协变异。协方差比（$\\mathrm{CR}$）统计量对此进行量化，其值越低，表示模块化程度越高。\n\n零假设 $H_{0}$ 是不存在模块结构。在 $H_{0}$ 之下，观测到的性状到模块的分配被认为是随机的，且观测到的统计量 $\\mathrm{CR}_{\\mathrm{obs}}$ 相对于随机置换生成的 $\\mathrm{CR}$ 值分布不应显得异常。备择假设 $H_{A}$ 是存在模块结构，对应于一个单侧检验，我们预期 $\\mathrm{CR}_{\\mathrm{obs}}$ 会显著小于来自零分布的数值。\n\n通过对性状标签进行 $N = 10000$ 次置换来经验性地构建零分布，并为每次置换计算一个 $\\mathrm{CR}_{\\mathrm{perm}}$ 值。该零分布的经验均值和标准差分别为 $\\mu_{0} = 1.010$ 和 $\\sigma_{0} = 0.045$。观测值为 $\\mathrm{CR}_{\\mathrm{obs}} = 0.892$。\n\n首先，我们计算置换 $p$ 值。该值表示在零假设为真的前提下，观测到等于或比观测值更极端的检验统计量的概率。对于这个单侧检验，“更极端”意味着小于或等于 $\\mathrm{CR}_{\\mathrm{obs}}$。问题陈述，有 $k = 44$ 次置换得出的值满足 $\\mathrm{CR}_{\\mathrm{perm}} \\le \\mathrm{CR}_{\\mathrm{obs}}$。\n\n问题指定在计算 $p$ 值时使用“加一调整”。这种方法将观测数据建模为可能的随机结果之一，可以修正对 $p$ 值的潜在低估，并避免得到零 $p$ 值的问题。其公式为：\n$$p = \\frac{k + 1}{N + 1}$$\n代入给定值：\n$$p = \\frac{44 + 1}{10000 + 1} = \\frac{45}{10001}$$\n进行除法运算：\n$$p \\approx 0.00449955...$$\n问题要求将此值四舍五入到四位有效数字。第一位有效数字是 $4$，其后是 $4$、$9$ 和 $9$。后一位数字是 $5$，所以我们将最后一位有效数字向上取整。\n$$p \\approx 0.004500$$\n$p$ 值为 $0.004500$ 远低于常规的显著性水平（例如 $\\alpha = 0.05$ 或 $\\alpha = 0.01$），表明这是一个统计上显著的结果。因此，我们将拒绝无模块性的零假设，并得出结论：数据为植物性状存在模块化结构提供了有力支持。\n\n接下来，我们计算标准化效应大小 $z$，它衡量了观测统计量偏离零分布均值的程度，以标准差为单位。公式如下：\n$$z = \\frac{\\mathrm{CR}_{\\mathrm{obs}} - \\mu_{0}}{\\sigma_{0}}$$\n代入给定值：\n$$z = \\frac{0.892 - 1.010}{0.045} = \\frac{-0.118}{0.045}$$\n$$z \\approx -2.6222...$$\n$z$ 分数约为 $-2.62$，表明观测到的协方差比比无模块性零假设下的期望分布均值低 $2.62$ 个标准差。这是一个显著的偏差，量化了反对零假设的证据强度，证实了从小 $p$ 值中得出的结论。该效应大小可被认为是中等到大，表明观测到的模块化模式不仅在统计上显著，其量级也具有生物学意义。\n\n最终要求的答案是四舍五入到四位有效数字的 $p$ 值。", "answer": "$$\\boxed{0.004500}$$", "id": "2591618"}]}