{"hands_on_practices": [{"introduction": "非同义替换率 ($d_N$) 与同义替换率 ($d_S$) 之比，即 $\\omega$ 值，是推断蛋白编码基因选择模式的关键指标。当 $\\omega > 1$ 时，通常意味着基因受到了正选择或多样化选择，这往往与适应性进化相关。本练习将引导你计算 $\\omega$ 值，检验其统计显著性，并应用多重假设检验校正，这是基因组分析中的一项基本要求 [@problem_id:2556763]。", "problem": "对极端环境适应性的比较基因组学研究，通常会探究特定基因在与极端环境压力相关的谱系上，是否表现出非同义替换的超额累积。考虑五个直系同源的离子和渗透保护基因，它们在一个盐生被子植物谱系和一个广盐性甲壳动物谱系中是保守的，这两个谱系都独立地适应了高盐环境。对于每个基因，沿着通往适应高盐环境类群的分支上发生的替换，已被映射到其编码序列比对上。对于每个基因，有效非同义位点数 $L_{N}$ 和有效同义位点数 $L_{S}$ 已通过标准密码子模型进行估算；在该数据集中，密码子用法和转换-颠换偏好导致所有五个基因的 $L_{N} = L_{S}$。映射到适应高盐环境分支上的、观测到的非同义替换数和同义替换数如下所示。\n\n- 水通道蛋白 (Aquaporin, AQP): $L_{N} = 900$, $L_{S} = 900$, $k_{N} = 8$, $k_{S} = 2$。\n- 钠-质子反向转运蛋白 (Sodium-proton antiporter, NHX/NHA): $L_{N} = 800$, $L_{S} = 800$, $k_{N} = 7$, $k_{S} = 1$。\n- 胚胎发育晚期丰富蛋白 (Late Embryogenesis Abundant protein, LEA): $L_{N} = 1100$, $L_{S} = 1100$, $k_{N} = 11$, $k_{S} = 1$。\n- 热休克蛋白 $70$ (Heat Shock Protein $70$, HSP$70$): $L_{N} = 1000$, $L_{S} = 1000$, $k_{N} = 6$, $k_{S} = 4$。\n- 液泡ATP酶亚基 (Vacuolar ATPase subunit, V-ATPase): $L_{N} = 1200$, $L_{S} = 1200$, $k_{N} = 9$, $k_{S} = 1$。\n\n任务：\n\n1) 对每个基因，计算非同义替换率 $d_{N} = k_{N}/L_{N}$、同义替换率 $d_{S} = k_{S}/L_{S}$ 以及它们的比率 $\\omega = d_{N}/d_{S}$。\n\n2) 为检验 $\\omega$ 是否偏离中性预期 ($\\omega = 1$)，请使用以下基于模型的检验，该检验基于标准的替换泊松过程观点：在中性条件下，一次替换为非同义替换的概率等于 $p_{0} = L_{N}/(L_{N} + L_{S})$。以总替换数 $K = k_{N} + k_{S}$ 为条件，非同义替换数 $k_{N}$ 是一个参数为 $(K, p_{0})$ 的二项分布随机变量。通过将相对于 $p_{0}$ 的较小尾部概率加倍，对每个基因进行精确的双边二项检验。报告每个基因的精确双边 $p$ 值。\n\n3) 使用控制错误发现率 (False Discovery Rate, FDR) 的 Benjamini–Hochberg (BH) 程序对五个 $p$ 值进行多重比较校正。计算每个基因的 BH 校正后 $p$ 值（即 $q$ 值）。\n\n作为最终答案，仅提供 LEA 基因的 BH 校正后 $p$ 值，四舍五入至四位有效数字，并以不带单位的小数形式表示。", "solution": "该问题陈述基于分子进化原理，具有科学依据，提法恰当且客观。它为提供一个完整而无歧义的解法提供了所有必要的数据和定义。因此，该问题被视为有效，并将提供完整的解法。\n\n解题过程按问题陈述中指定的三个任务进行。\n\n任务1：对每个基因计算非同义替换率 $d_{N}$、同义替换率 $d_{S}$ 及其比率 $\\omega$。\n\n替换率定义为 $d_{N} = k_{N}/L_{N}$ 和 $d_{S} = k_{S}/L_{S}$。比率为 $\\omega = d_{N}/d_{S}$。鉴于所有基因的 $L_{N} = L_{S}$，该比率简化为 $\\omega = (k_{N}/L_{N}) / (k_{S}/L_{S}) = k_{N}/k_{S}$。\n\n1.  水通道蛋白 (AQP): $L_{N} = 900$, $L_{S} = 900$, $k_{N} = 8$, $k_{S} = 2$。\n    $d_{N} = \\frac{8}{900}$, $d_{S} = \\frac{2}{900}$。\n    $\\omega = \\frac{k_{N}}{k_{S}} = \\frac{8}{2} = 4$。\n\n2.  钠-质子反向转运蛋白 (NHX/NHA): $L_{N} = 800$, $L_{S} = 800$, $k_{N} = 7$, $k_{S} = 1$。\n    $d_{N} = \\frac{7}{800}$, $d_{S} = \\frac{1}{800}$。\n    $\\omega = \\frac{k_{N}}{k_{S}} = \\frac{7}{1} = 7$。\n\n3.  胚胎发育晚期丰富蛋白 (LEA): $L_{N} = 1100$, $L_{S} = 1100$, $k_{N} = 11$, $k_{S} = 1$。\n    $d_{N} = \\frac{11}{1100} = \\frac{1}{100}$, $d_{S} = \\frac{1}{1100}$。\n    $\\omega = \\frac{k_{N}}{k_{S}} = \\frac{11}{1} = 11$。\n\n4.  热休克蛋白 $70$ (HSP$70$): $L_{N} = 1000$, $L_{S} = 1000$, $k_{N} = 6$, $k_{S} = 4$。\n    $d_{N} = \\frac{6}{1000}$, $d_{S} = \\frac{4}{1000}$。\n    $\\omega = \\frac{k_{N}}{k_{S}} = \\frac{6}{4} = 1.5$。\n\n5.  液泡ATP酶亚基 (V-ATPase): $L_{N} = 1200$, $L_{S} = 1200$, $k_{N} = 9$, $k_{S} = 1$。\n    $d_{N} = \\frac{9}{1200}$, $d_{S} = \\frac{1}{1200}$。\n    $\\omega = \\frac{k_{N}}{k_{S}} = \\frac{9}{1} = 9$。\n\n任务2：对每个基因进行精确的双边二项检验。\n\n零假设 ($H_0$) 是中性选择，即 $\\omega = 1$。这意味着一次替换为非同义替换的概率是 $p_{0} = L_{N}/(L_{N} + L_{S})$。由于 $L_{N} = L_{S}$，这个概率变为 $p_{0} = L_{N}/(L_{N} + L_{N}) = \\frac{1}{2}$。\n在 $H_0$ 条件下，观测到的非同义替换数 $k_{N}$ 服从二项分布 $X \\sim B(K, p_{0})$，其中 $K = k_{N} + k_{S}$ 是总替换数。概率质量函数为 $P(X=k) = \\binom{K}{k} p_{0}^{k} (1-p_{0})^{K-k} = \\binom{K}{k} (\\frac{1}{2})^{K}$。\n双边 $p$ 值通过将较小的尾部概率加倍来计算。非同义替换的期望数量为 $E[X] = K \\cdot p_{0} = K/2$。如果观测值 $k_{N} > E[X]$，则 $p$ 值为 $2 \\times P(X \\ge k_{N})$。如果 $k_{N} < E[X]$，则 $p$ 值为 $2 \\times P(X \\le k_{N})$。\n\n1.  AQP: $k_{N} = 8$, $k_{S} = 2$，因此 $K = 10$。观测值为 $k_{N}=8$。期望值为 $10/2 = 5$。由于 $8 > 5$，我们计算右尾概率。\n    $P(X \\ge 8) = P(X=8) + P(X=9) + P(X=10) = \\left[ \\binom{10}{8} + \\binom{10}{9} + \\binom{10}{10} \\right] (\\frac{1}{2})^{10} = (45+10+1) \\cdot \\frac{1}{1024} = \\frac{56}{1024}$。\n    $p_{\\text{AQP}} = 2 \\times \\frac{56}{1024} = \\frac{112}{1024} = 0.109375$。\n\n2.  NHX/NHA: $k_{N} = 7$, $k_{S} = 1$，因此 $K = 8$。观测值为 $k_{N}=7$。期望值为 $8/2 = 4$。由于 $7 > 4$，我们计算右尾概率。\n    $P(X \\ge 7) = P(X=7) + P(X=8) = \\left[ \\binom{8}{7} + \\binom{8}{8} \\right] (\\frac{1}{2})^{8} = (8+1) \\cdot \\frac{1}{256} = \\frac{9}{256}$。\n    $p_{\\text{NHX}} = 2 \\times \\frac{9}{256} = \\frac{18}{256} = 0.0703125$。\n\n3.  LEA: $k_{N} = 11$, $k_{S} = 1$，因此 $K = 12$。观测值为 $k_{N}=11$。期望值为 $12/2 = 6$。由于 $11 > 6$，我们计算右尾概率。\n    $P(X \\ge 11) = P(X=11) + P(X=12) = \\left[ \\binom{12}{11} + \\binom{12}{12} \\right] (\\frac{1}{2})^{12} = (12+1) \\cdot \\frac{1}{4096} = \\frac{13}{4096}$。\n    $p_{\\text{LEA}} = 2 \\times \\frac{13}{4096} = \\frac{26}{4096} \\approx 0.00634765625$。\n\n4.  HSP$70$: $k_{N} = 6$, $k_{S} = 4$，因此 $K = 10$。观测值为 $k_{N}=6$。期望值为 $10/2 = 5$。由于 $6 > 5$，我们计算右尾概率。\n    $P(X \\ge 6) = \\sum_{i=6}^{10} \\binom{10}{i} (\\frac{1}{2})^{10} = (\\binom{10}{6} + \\binom{10}{7} + \\binom{10}{8} + \\binom{10}{9} + \\binom{10}{10}) \\cdot \\frac{1}{1024} = (210+120+45+10+1) \\cdot \\frac{1}{1024} = \\frac{386}{1024}$。\n    $p_{\\text{HSP70}} = 2 \\times \\frac{386}{1024} = \\frac{772}{1024} = 0.75390625$。\n\n5.  V-ATPase: $k_{N} = 9$, $k_{S} = 1$，因此 $K = 10$。观测值为 $k_{N}=9$。期望值为 $10/2 = 5$。由于 $9 > 5$，我们计算右尾概率。\n    $P(X \\ge 9) = P(X=9) + P(X=10) = \\left[ \\binom{10}{9} + \\binom{10}{10} \\right] (\\frac{1}{2})^{10} = (10+1) \\cdot \\frac{1}{1024} = \\frac{11}{1024}$。\n    $p_{\\text{V-ATPase}} = 2 \\times \\frac{11}{1024} = \\frac{22}{1024} \\approx 0.021484375$。\n\n任务3：使用 Benjamini–Hochberg (BH) 程序校正五个 $p$ 值。\n\nBH 程序通过控制错误发现率来校正多重比较。共有 $m=5$ 个检验。\n首先，我们将原始 $p$ 值按升序排列，$p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(5)}$。\n对于排名第 $i$ 的检验，BH 校正后的 $p$ 值（或 $q$ 值）由 $q_{(i)} = \\min_{j=i}^{m} \\left( \\frac{m \\cdot p_{(j)}}{j} \\right)$ 给出。\n\n1.  原始 $p$ 值为：\n    $p_{\\text{HSP70}} = 0.75390625$\n    $p_{\\text{AQP}} = 0.109375$\n    $p_{\\text{NHX}} = 0.0703125$\n    $p_{\\text{V-ATPase}} = 0.021484375$\n    $p_{\\text{LEA}} = 0.00634765625$\n\n2.  排序后的 $p$ 值：\n    $p_{(1)} = 0.00634765625$ (LEA)\n    $p_{(2)} = 0.021484375$ (V-ATPase)\n    $p_{(3)} = 0.0703125$ (NHX/NHA)\n    $p_{(4)} = 0.109375$ (AQP)\n    $p_{(5)} = 0.75390625$ (HSP70)\n\n3.  计算 BH 校正后的 $p$ 值（$q$ 值）。我们计算每个排序 $i$ 对应的项 $\\frac{m \\cdot p_{(i)}}{i}$。\n    对于 $i=1$ (LEA): $\\frac{5 \\times 0.00634765625}{1} \\approx 0.031738$\n    对于 $i=2$ (V-ATPase): $\\frac{5 \\times 0.021484375}{2} \\approx 0.053711$\n    对于 $i=3$ (NHX/NHA): $\\frac{5 \\times 0.0703125}{3} \\approx 0.117188$\n    对于 $i=4$ (AQP): $\\frac{5 \\times 0.109375}{4} \\approx 0.136719$\n    对于 $i=5$ (HSP70): $\\frac{5 \\times 0.75390625}{5} = 0.75390625$\n\n    这些值已经是单调递增的。因此，校正后的 $p$ 值 $q_{(i)}$ 等于 $\\frac{m \\cdot p_{(i)}}{i}$，无需进一步调整。\n\n    $q_{(1)} = q_{\\text{LEA}} \\approx 0.031738$\n    $q_{(2)} = q_{\\text{V-ATPase}} \\approx 0.053711$\n    $q_{(3)} = q_{\\text{NHX}} \\approx 0.117188$\n    $q_{(4)} = q_{\\text{AQP}} \\approx 0.136719$\n    $q_{(5)} = q_{\\text{HSP70}} = 0.75390625$\n\n问题要求提供 LEA 基因的 BH 校正后 $p$ 值，它对应于 $q_{(1)}$。\n$q_{\\text{LEA}} = \\frac{5 \\times p_{\\text{LEA}}}{1} = 5 \\times (2 \\times \\frac{13}{4096}) = \\frac{130}{4096} = \\frac{65}{2048} \\approx 0.03173828125$。\n四舍五入到四位有效数字得到 $0.03174$。", "answer": "$$\\boxed{0.03174}$$", "id": "2556763"}, {"introduction": "除了序列变异，基因剂量（即拷贝数）的变化也是适应性进化的主要驱动力，因为基因重复为进化创新提供了原始素材。本实践模拟了一个常见的生物信息学工作流程：利用全基因组测序的读段深度来估算候选基因的拷贝数，并与基线进行统计比较，以检验其是否发生了扩增 [@problem_id:2556757]。", "problem": "一项比较基因组学研究旨在调查一个极端环境生物谱系是否通过增加一个候选应激反应基因的拷贝数来适应其环境。研究人员对来自该极端环境生物物种的单个个体进行了全基因组短读长测序，并将测序读长比对到了一个高质量的参考基因组上。假设对于唯一可比对区域，每碱基的读取深度与潜在的基因组拷贝数成正比，并且根据中心极限定理，将一个位点划分为足够大的窗口可以产生近似独立的抽样。\n\n关于该极端环境生物个体，您被给予了以下信息：\n- 候选基因跨度为 $8{,}000$ 个碱基对，被划分为 $m=8$ 个每个 $1{,}000$ 碱基对的非重叠窗口。在这些窗口上测得的平均每碱基覆盖度（按其在基因上的出现顺序）为：$39$, $41$, $42$, $40$, $38$, $43$, $41$, $40$。\n- 从 $500$ 个已知在每个单倍体基因组中为单拷贝、并根据鸟嘌呤-胞嘧啶（GC）含量和可比对性筛选出的常染色体位点中，估计出同一测序文库的平均每碱基覆盖度为 $28.0$。将此值定义为二倍体基因组中单拷贝位点的参考覆盖度基线。\n- 在参考单拷贝位点中，标准化的 $1{,}000$ 碱基对窗口覆盖度（每个窗口通过除以参考均值进行标准化）的经验标准差为 $\\sigma_{\\text{ref}}=0.20$。\n\n仅使用上述假设和标准统计检验：\n1. 计算候选基因的标准化覆盖度，即其窗口覆盖度的均值除以参考基线。然后通过按二倍体期望值进行缩放，将其转换为拷贝数估计值。\n2. 将候选基因的标准化窗口覆盖度均值视为从一个标准差为 $\\sigma_{\\text{ref}}$、样本量为 $m$ 的分布中抽取的样本均值，计算检验其与二倍体单拷贝期望值偏差的 $z$-分数。\n\n仅报告 $z$-分数。将您的答案四舍五入至三位有效数字。最终答案中不要包含单位。", "solution": "首先验证问题的科学性和逻辑完整性。\n\n**步骤1：提取已知条件**\n-   候选基因的非重叠窗口数：$m=8$。\n-   每个窗口的大小：$1{,}000$ 碱基对。\n-   $m=8$ 个窗口的平均每碱基覆盖度：$C_i = \\{39, 41, 42, 40, 38, 43, 41, 40\\}$。\n-   单拷贝二倍体位点的参考平均每碱基覆盖度：$\\mu_{\\text{ref}} = 28.0$。\n-   参考单拷贝位点中标准化的 $1{,}000$ 碱基对窗口覆盖度的经验标准差：$\\sigma_{\\text{ref}}=0.20$。\n-   假设：读取深度与基因组拷贝数成正比。\n-   假设：根据中心极限定理，大窗口可产生近似独立的抽样。\n\n**步骤2：使用已知条件进行验证**\n问题陈述具有科学依据，采用了生物信息学和计算生物学中用于拷贝数变异（CNV）分析的标准方法。其前提——使用标准化的读取深度推断拷贝数、将基因划分为窗口、以及针对一组参考单拷贝基因进行统计检验——是该领域的基础。所提供的数据内部一致且数值上合理。问题提法得当、客观，并包含足够的信息以得出唯一解。不存在违反科学原理、逻辑不一致或含糊不清之处。\n\n**步骤3：结论与行动**\n问题被认定为有效。将推导解答过程。\n\n**解题过程推导**\n目标是计算一个 $z$-分数，以检验候选基因的观测读取覆盖度是否显著偏离二倍体生物中单拷贝位点的期望值。零假设 $H_0$ 是：候选基因存在两个拷贝（每个单倍体基因组中一个），与参考单拷贝位点的情况一致。\n\n首先，我们通过计算其 $m=8$ 个窗口覆盖度的算术平均值，来计算候选基因的平均每碱基覆盖度 $\\bar{C}_{\\text{gene}}$。\n$$\n\\bar{C}_{\\text{gene}} = \\frac{1}{m} \\sum_{i=1}^{m} C_i\n$$\n代入给定值：\n$$\n\\bar{C}_{\\text{gene}} = \\frac{39 + 41 + 42 + 40 + 38 + 43 + 41 + 40}{8} = \\frac{324}{8} = 40.5\n$$\n\n接下来，我们用参考基线覆盖度 $\\mu_{\\text{ref}} = 28.0$ 来标准化这个观测到的平均覆盖度。该参考值代表了一个二倍体、单拷贝区域的期望覆盖度。所得结果，我们记为 $\\bar{x}_{\\text{norm}}$，是用于我们统计检验的样本均值。\n$$\n\\bar{x}_{\\text{norm}} = \\frac{\\bar{C}_{\\text{gene}}}{\\mu_{\\text{ref}}} = \\frac{40.5}{28.0}\n$$\n这个量，即标准化覆盖度，代表了相对于单拷贝二倍体状态的观测拷贝数。要估计绝对拷贝数，需要乘以 $2$，得出估计值 $2 \\times \\frac{40.5}{28.0} \\approx 2.89$，这表明发生了拷贝数增加。\n\n在零假设 $H_0$下，任何单拷贝基因的标准化覆盖度的真实均值期望为 $1$。我们将 $H_0$ 下的这个期望均值记为 $\\mu_0 = 1.0$。\n\n我们现在进行 $z$-检验。样本均值的 $z$-分数由以下公式给出：\n$$\nz = \\frac{\\bar{x} - \\mu_0}{\\text{SE}}\n$$\n其中 $\\bar{x}$ 是样本均值，$\\mu_0$ 是零假设下的总体均值，$\\text{SE}$ 是均值标准误。\n\n在此背景下：\n-   样本均值是候选基因的标准化平均覆盖度，$\\bar{x} = \\bar{x}_{\\text{norm}} = \\frac{40.5}{28.0}$。\n-   $H_0$ 下的总体均值为 $\\mu_0 = 1.0$。\n-   均值标准误计算公式为 $\\text{SE} = \\frac{\\sigma}{\\sqrt{n}}$，其中 $\\sigma$ 是单个测量值的总体标准差，$n$ 是样本量。问题给出的标准化窗口覆盖度的标准差为 $\\sigma_{\\text{ref}} = 0.20$。样本量是窗口数量 $m=8$。因此，标准误为：\n$$\n\\text{SE} = \\frac{\\sigma_{\\text{ref}}}{\\sqrt{m}} = \\frac{0.20}{\\sqrt{8}}\n$$\n\n将这些部分代入 $z$-分数公式：\n$$\nz = \\frac{\\bar{x}_{\\text{norm}} - \\mu_0}{\\frac{\\sigma_{\\text{ref}}}{\\sqrt{m}}} = \\frac{\\frac{40.5}{28.0} - 1.0}{\\frac{0.20}{\\sqrt{8}}}\n$$\n现在，我们计算数值。\n$$\nz = \\frac{\\frac{40.5 - 28.0}{28.0}}{\\frac{0.20}{\\sqrt{8}}} = \\frac{\\frac{12.5}{28.0}}{\\frac{0.20}{\\sqrt{8}}}\n$$\n$$\nz = \\frac{12.5}{28.0} \\times \\frac{\\sqrt{8}}{0.20}\n$$\n由于 $\\sqrt{8} = 2\\sqrt{2}$：\n$$\nz = \\frac{12.5}{28.0 \\times 0.20} \\times 2\\sqrt{2} = \\frac{12.5}{5.6} \\times 2\\sqrt{2} = \\frac{25\\sqrt{2}}{5.6}\n$$\n计算该值：\n$$\nz \\approx 6.31346...\n$$\n问题要求答案四舍五入至三位有效数字。因此，最终的 $z$-分数为 $6.31$。这个高的正值表明，候选基因的观测覆盖度显著高于单拷贝位点的期望值，为拷贝数扩增提供了强有力的证据。", "answer": "$$ \\boxed{6.31} $$", "id": "2556757"}, {"introduction": "比较基因组学的最终目标之一是将基因组变化与表型适应联系起来。然而，由于物种共享进化历史，它们并非独立的统计数据点。本练习将介绍“系统发育广义最小二乘法”(Phylogenetic Generalized Least Squares, PGLS)，这是一种强大的统计方法，能够在考虑物种间系统发育的非独立性的情况下，检验不同性状之间（如基因家族大小和耐热性）的关联 [@problem_id:2556728]。", "problem": "一项比较基因组学项目研究了在适应不同热环境的相关分类单元中，一个应激反应基因家族的扩张是否与耐热性相关。该基因家族是热休克蛋白 $70$ (HSP$70$) 家族，表型是临界最高温 ($\\mathrm{CT_{max}}$)，以摄氏度为单位测量。对于三个密切相关的变温物种，相对于它们最近的共同祖先，推断出的HSP$70$基因家族大小的净变化（由一个出生-死亡基因家族模型估计）和测得的$\\mathrm{CT_{max}}$如下：物种$\\mathrm{A}$的$\\Delta G = 1$，$T = 35$；物种$\\mathrm{B}$的$\\Delta G = 3$，$T = 38$；物种$\\mathrm{C}$的$\\Delta G = 0$，$T = 33$。假设系统发育关系是超度量的，拓扑结构为$\\big((\\mathrm{A},\\mathrm{B}):1,\\mathrm{C}:2\\big)$，意味着从根到每个末端的时间为$2$，从根到$\\mathrm{A}$和$\\mathrm{B}$最近共同祖先的内部分支长度为$1$，从该祖先到$\\mathrm{A}$和$\\mathrm{B}$的末端分支长度各为$1$。假设性状演化遵循布朗运动模型，其方差参数为$\\sigma^{2}$，Pagel的$\\lambda$等于$1$。\n\n使用系统发育广义最小二乘法 (PGLS)，通过拟合一个包含截距的模型，并适当考虑该进化树所蕴含的系统发育方差-协方差结构，计算$\\Delta G$和$T$之间的系统发育校正相关系数。请提供相关系数的精确解析值作为最终答案。不要四舍五入。", "solution": "该问题要求计算HSP$70$基因家族大小的净变化（记为$\\Delta G$）与临界最高温（记为$T$）之间的系统发育校正相关系数。指定的方法是系统发育广义最小二乘法 (PGLS)，并假设性状演化遵循布朗运动模型。\n\n首先，我们通过定义数据向量和系统发育方差-协方差矩阵来将问题形式化。令变量$X$代表$\\Delta G$，变量$Y$代表$T$。三个物种A、B、C的数据如下：\n物种A: $X_A = 1$, $Y_A = 35$\n物种B: $X_B = 3$, $Y_B = 38$\n物种C: $X_C = 0$, $Y_C = 33$\n\n我们可以将这些数据写成列向量，顺序为(A, B, C)：\n$$X = \\begin{pmatrix} 1 \\\\ 3 \\\\ 0 \\end{pmatrix}, \\quad Y = \\begin{pmatrix} 35 \\\\ 38 \\\\ 33 \\end{pmatrix}$$\n\n系统发育关系由拓扑结构$\\big((\\mathrm{A},\\mathrm{B}):1,\\mathrm{C}:2\\big)$给出，所有物种的根到末端的距离均为$2$。这描述了一个有根树，其中根位于时间$0$，物种A和B的最近共同祖先 (MRCA) 位于时间$1$，所有末端（A、B、C）都位于时间$2$。分支长度如下：从根到A和B的MRCA的分支长度为$1$；从这个MRCA到A和B的末端分支长度各为$1$；从根到C的分支长度为$2$。\n\n在布朗运动演化模型下，物种间性状值的期望方差-协方差矩阵与从根开始的共享进化路径长度矩阵成正比。设该矩阵为$V$。元素$V_{ij}$是从根到物种$i$和$j$的MRCA的共享路径长度。对角线元素$V_{ii}$表示从根到末端$i$的总路径长度。\n\n根据指定的树结构：\n- 每个物种的总路径长度为$2$：$V_{AA} = V_{BB} = V_{CC} = 2$。\n- A和B的共享路径长度是从根到它们MRCA的分支长度，即$1$：$V_{AB} = V_{BA} = 1$。\n- 物种A和C，以及B和C，在根部分化。因此，它们的共享路径长度为$0$：$V_{AC} = V_{CA} = 0$ 且 $V_{BC} = V_{CB} = 0$。\n\n问题陈述了Pagel的$\\lambda=1$和一个方差参数$\\sigma^2$。方差-协方差矩阵是$V_{model} = \\sigma^2 V$。在计算相关系数时，比例因子$\\sigma^2$是无关紧要的，因为它会被消掉。因此，我们可以直接使用$V$进行计算：\n$$V = \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 2 & 0 \\\\ 0 & 0 & 2 \\end{pmatrix}$$\nPGLS模型需要这个矩阵的逆矩阵$V^{-1}$。该矩阵是块对角矩阵，这简化了其求逆过程。\n$$V^{-1} = \\begin{pmatrix} \\left(\\begin{smallmatrix} 2 & 1 \\\\ 1 & 2 \\end{smallmatrix}\\right)^{-1} & \\boldsymbol{0} \\\\ \\boldsymbol{0}^T & 2^{-1} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3}\\left(\\begin{smallmatrix} 2 & -1 \\\\ -1 & 2 \\end{smallmatrix}\\right) & \\boldsymbol{0} \\\\ \\boldsymbol{0}^T & \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} & -\\frac{1}{3} & 0 \\\\ -\\frac{1}{3} & \\frac{2}{3} & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix}$$\n系统发育校正相关系数由系统发育校正的平方和与交叉乘积和计算得出。首先，我们计算性状的系统发育均值$\\bar{X}_{phy}$和$\\bar{Y}_{phy}$。令$\\mathbf{1}$为一个长度为$n=3$的全1列向量。\n$$\\bar{X}_{phy} = \\frac{\\mathbf{1}^T V^{-1} X}{\\mathbf{1}^T V^{-1} \\mathbf{1}}, \\quad \\bar{Y}_{phy} = \\frac{\\mathbf{1}^T V^{-1} Y}{\\mathbf{1}^T V^{-1} \\mathbf{1}}$$\n我们计算分母项$\\mathbf{1}^T V^{-1} \\mathbf{1}$：\n$$\\mathbf{1}^T V^{-1} = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{2}{3} & -\\frac{1}{3} & 0 \\\\ -\\frac{1}{3} & \\frac{2}{3} & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{2} \\end{pmatrix}$$\n$$\\mathbf{1}^T V^{-1} \\mathbf{1} = \\begin{pmatrix} \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{3} + \\frac{1}{3} + \\frac{1}{2} = \\frac{2}{3} + \\frac{1}{2} = \\frac{7}{6}$$\n接下来，我们计算分子：\n$$\\mathbf{1}^T V^{-1} X = \\begin{pmatrix} \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 3 \\\\ 0 \\end{pmatrix} = \\frac{1}{3} + \\frac{3}{3} + 0 = \\frac{4}{3}$$\n$$\\mathbf{1}^T V^{-1} Y = \\begin{pmatrix} \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 35 \\\\ 38 \\\\ 33 \\end{pmatrix} = \\frac{35}{3} + \\frac{38}{3} + \\frac{33}{2} = \\frac{73}{3} + \\frac{33}{2} = \\frac{146+99}{6} = \\frac{245}{6}$$\n现在我们求出系统发育均值：\n$$\\bar{X}_{phy} = \\frac{4/3}{7/6} = \\frac{4}{3} \\cdot \\frac{6}{7} = \\frac{8}{7}$$\n$$\\bar{Y}_{phy} = \\frac{245/6}{7/6} = \\frac{245}{7} = 35$$\n我们使用这些均值对数据向量进行中心化，定义$\\tilde{X} = X - \\bar{X}_{phy}\\mathbf{1}$和$\\tilde{Y} = Y - \\bar{Y}_{phy}\\mathbf{1}$：\n$$\\tilde{X} = \\begin{pmatrix} 1 - 8/7 \\\\ 3 - 8/7 \\\\ 0 - 8/7 \\end{pmatrix} = \\begin{pmatrix} -1/7 \\\\ 13/7 \\\\ -8/7 \\end{pmatrix} = \\frac{1}{7}\\begin{pmatrix} -1 \\\\ 13 \\\\ -8 \\end{pmatrix}$$\n$$\\tilde{Y} = \\begin{pmatrix} 35 - 35 \\\\ 38 - 35 \\\\ 33 - 35 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 3 \\\\ -2 \\end{pmatrix}$$\n系统发育校正的平方和 ($SS$) 和交叉乘积和 ($SCP$) 由下式给出：\n$$SS_X = \\tilde{X}^T V^{-1} \\tilde{X}, \\quad SS_Y = \\tilde{Y}^T V^{-1} \\tilde{Y}, \\quad SCP_{XY} = \\tilde{X}^T V^{-1} \\tilde{Y}$$\n计算这些值：\n$$SS_X = \\left(\\frac{1}{7}\\begin{pmatrix} -1 \\\\ 13 \\\\ -8 \\end{pmatrix}\\right)^T \\begin{pmatrix} \\frac{2}{3} & -\\frac{1}{3} & 0 \\\\ -\\frac{1}{3} & \\frac{2}{3} & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} \\left(\\frac{1}{7}\\begin{pmatrix} -1 \\\\ 13 \\\\ -8 \\end{pmatrix}\\right) = \\frac{1}{49} \\begin{pmatrix} -1 & 13 & -8 \\end{pmatrix} \\begin{pmatrix} -5 \\\\ 9 \\\\ -4 \\end{pmatrix} = \\frac{1}{49}(5+117+32) = \\frac{154}{49} = \\frac{22}{7}$$\n$$SS_Y = \\begin{pmatrix} 0 \\\\ 3 \\\\ -2 \\end{pmatrix}^T \\begin{pmatrix} \\frac{2}{3} & -\\frac{1}{3} & 0 \\\\ -\\frac{1}{3} & \\frac{2}{3} & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 3 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} 0 & 3 & -2 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 2 \\\\ -1 \\end{pmatrix} = 0 + 6 + 2 = 8$$\n$$SCP_{XY} = \\left(\\frac{1}{7}\\begin{pmatrix} -1 \\\\ 13 \\\\ -8 \\end{pmatrix}\\right)^T \\begin{pmatrix} \\frac{2}{3} & -\\frac{1}{3} & 0 \\\\ -\\frac{1}{3} & \\frac{2}{3} & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 3 \\\\ -2 \\end{pmatrix} = \\frac{1}{7} \\begin{pmatrix} -1 & 13 & -8 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 2 \\\\ -1 \\end{pmatrix} = \\frac{1}{7}(1+26+8) = \\frac{35}{7} = 5$$\n最后，系统发育校正相关系数$r$为：\n$$r = \\frac{SCP_{XY}}{\\sqrt{SS_X \\cdot SS_Y}} = \\frac{5}{\\sqrt{\\frac{22}{7} \\cdot 8}} = \\frac{5}{\\sqrt{\\frac{176}{7}}} = \\frac{5\\sqrt{7}}{\\sqrt{176}}$$\n为简化分母，我们注意到$176 = 16 \\times 11$，所以$\\sqrt{176} = 4\\sqrt{11}$。\n$$r = \\frac{5\\sqrt{7}}{4\\sqrt{11}}$$\n对分母进行有理化，得到最终的解析表达式：\n$$r = \\frac{5\\sqrt{7}}{4\\sqrt{11}} \\cdot \\frac{\\sqrt{11}}{\\sqrt{11}} = \\frac{5\\sqrt{77}}{44}$$", "answer": "$$\\boxed{\\frac{5\\sqrt{77}}{44}}$$", "id": "2556728"}]}