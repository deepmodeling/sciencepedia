{"hands_on_practices": [{"introduction": "本练习将带您进入现代比较基因组学实践的核心，模拟如何从原始的RNA-seq表达数据中挖掘基因命运的线索。您将亲手实现一种处理基因表达这类组分数据的关键归一化方法，并利用它来执行一个算法，以识别指示亚功能化的经典信号——即重复基因在不同组织中的互补性高表达。这项实践对于任何希望通过计算方法分析功能基因组学数据的人来说都至关重要。[@problem_id:2613588]", "problem": "您会获得一组独立的核糖核酸测序 (RNA-seq) 场景，每个场景由一个基因-组织计数矩阵表示。您的任务是实现一种基于中心对数比概念的组分数据归一化方法，并在每个场景中针对指定的重复基因对进行检验，判断其归一化后的表达谱是否以支持亚功能化的方式，在不同组织中表现出互斥且不重叠的表达峰值。\n\n基本原理与假设：分子生物学中心法则指出，脱氧核糖核酸 (DNA) 转录为核糖核酸 (RNA)，RNA 再翻译成蛋白质。RNA-seq 通过对测序读数进行计数来衡量转录本丰度，而这些读数受每个样本中文库总大小的限制，因此是组分数据。一种消除组分效应的稳健方法是应用中心对数比变换，并使用一个小的伪计数来处理零值。在本问题中，您必须实现一种归一化方法，该方法针对每个组织（视为一个样本），使用自然对数 ($\\ln$) 和一个伪计数 $\\epsilon$ 将原始计数转换为中心对数比值。\n\n归一化要求（您的解决方案中需包含推导过程；请勿导入任何外部数据）：对每个组织，使用伪计数 $\\epsilon$ 的中心对数比方法来转换跨基因的计数值向量；使用自然对数 ($\\ln$)。设 $\\epsilon = 0.5$。\n\n亚功能化判定规则：令 $g_1$ 和 $g_2$ 表示一个重复基因对的索引（从零开始）。对于每个基因 $g \\in \\{g_1,g_2\\}$，将其 argmax 集合 $P_g$ 定义为其归一化值达到最大值的组织索引的集合（使用浮点数比较容差 $\\tau = 10^{-12}$ 来确定集合成员）。将“最大值与次大值之差” $m_g$ 定义为基因 $g$ 在所有组织中最大归一化值与第二大归一化值之间的差值（如果最大值在至少两个组织中出现，则根据定义 $m_g = 0$）。定义 $\\gamma = 0.5$。当且仅当以下所有条件都成立时，判定该基因对支持亚功能化：\n- argmax 集合不相交，即 $P_{g_1} \\cap P_{g_2} = \\varnothing$。\n- 令 $t_1$ 为 $P_{g_1}$ 中的最小索引，$t_2$ 为 $P_{g_2}$ 中的最小索引。互斥显性成立：\n  - 基因 $g_1$ 的基因内跨组织对比满足 $y_{g_1,t_1} - y_{g_1,t_2} \\ge \\gamma$。\n  - 基因 $g_2$ 的基因内跨组织对比满足 $y_{g_2,t_2} - y_{g_2,t_1} \\ge \\gamma$。\n- 峰值锐度成立：$m_{g_1} \\ge \\gamma$ 且 $m_{g_2} \\ge \\gamma$。\n\n您的程序必须：\n- 使用 $\\epsilon = 0.5$ 和自然对数 ($\\ln$) 实现上述归一化。\n- 使用从零开始的索引、容差 $\\tau = 10^{-12}$ 和 $\\gamma = 0.5$ 实现判定规则。\n- 评估以下每个测试用例，并根据判定规则为每个用例输出一个布尔值。\n\n测试套件（每个用例指定矩阵 $C \\in \\mathbb{N}_0^{G \\times T}$，其中基因为行，组织为列；重复基因索引 $(g_1,g_2)$；并使用共享参数 $\\epsilon = 0.5$，$\\gamma = 0.5$ 和 $\\tau = 10^{-12}$）：\n\n- 用例 $1$：$G=4$，$T=3$，重复基因 $(g_1,g_2)=(0,1)$，其中\n$$\nC^{(1)} =\n\\begin{bmatrix}\n1000 & 60 & 50 \\\\\n50 & 900 & 55 \\\\\n300 & 300 & 300 \\\\\n400 & 400 & 400\n\\end{bmatrix}.\n$$\n\n- 用例 $2$：$G=4$，$T=3$，重复基因 $(g_1,g_2)=(0,1)$，其中\n$$\nC^{(2)} =\n\\begin{bmatrix}\n600 & 500 & 400 \\\\\n600 & 500 & 400 \\\\\n300 & 300 & 300 \\\\\n400 & 400 & 400\n\\end{bmatrix}.\n$$\n\n- 用例 $3$：$G=4$，$T=3$，重复基因 $(g_1,g_2)=(0,1)$，其中\n$$\nC^{(3)} =\n\\begin{bmatrix}\n200 & 200 & 50 \\\\\n80 & 300 & 290 \\\\\n100 & 100 & 100 \\\\\n110 & 110 & 110\n\\end{bmatrix}.\n$$\n\n- 用例 $4$：$G=4$，$T=3$，重复基因 $(g_1,g_2)=(0,1)$，其中\n$$\nC^{(4)} =\n\\begin{bmatrix}\n120 & 110 & 100 \\\\\n130 & 140 & 135 \\\\\n100 & 100 & 100 \\\\\n100 & 100 & 100\n\\end{bmatrix}.\n$$\n\n- 用例 $5$：$G=4$，$T=3$，重复基因 $(g_1,g_2)=(0,1)$，其中\n$$\nC^{(5)} =\n\\begin{bmatrix}\n0 & 600 & 0 \\\\\n700 & 0 & 0 \\\\\n300 & 300 & 300 \\\\\n400 & 400 & 400\n\\end{bmatrix}.\n$$\n\n最终输出规范：\n- 您的程序必须生成单行输出，其中包含五个用例的结果，形式为一个由方括号括起来、以逗号分隔的 Python 布尔字面量列表。例如，一个有效的格式如“[res1,res2,res3,res4,res5]”，其中每个“res$k$”是 True 或 False。\n- 除此单行外，不应打印任何额外的文本或空白字符。\n- 程序必须是自包含的，且不得读取任何输入。", "solution": "该问题要求基于重复基因对在多个组织中的表达谱，评估其亚功能化的证据。此评估包含两个主要部分：首先，对原始 RNA 测序计数数据进行特定的归一化处理；其次，将一个多部分判定规则应用于归一化后的数据。该问题具有科学依据，提法明确，且所有参数均已指定。因此，可以构建解决方案，并将立即着手构建。\n\n首先，我们解决归一化要求。问题指定对每个组织的计数数据应用中心对数比 (CLR) 变换。设 $C$ 是一个原始计数矩阵，有 $G$ 个基因（行）和 $T$ 个组织（列），其中 $C_{g,t}$ 是基因 $g$ 在组织 $t$ 中的计数。归一化是针对每个组织独立进行的，即对矩阵 $C$ 的每一列进行。\n\n设 $c_t$ 是组织 $t$ 的计数向量，由 $C$ 的第 $t$ 列给出，$c_t = [C_{0,t}, C_{1,t}, \\dots, C_{G-1,t}]^T$。变换过程如下：\n\n1.  **添加伪计数**：为了处理潜在的零计数（其在对数运算中会引发数学问题），将一个伪计数 $\\epsilon$ 添加到每个计数中。问题指定 $\\epsilon = 0.5$。设新向量为 $x_t$：\n    $$x_{g,t} = C_{g,t} + \\epsilon$$\n\n2.  **对数变换**：使用自然对数 ($\\ln$) 对所得向量的每个元素进行变换：\n    $$\\ln(x_{g,t}) = \\ln(C_{g,t} + \\epsilon)$$\n\n3.  **中心化**：然后通过减去其各分量的算术平均值，对经过对数变换的值向量进行中心化。这等同于在原始空间中将每个分量除以几何平均值，这也是中心对数比变换的定义。基因 $g$ 在组织 $t$ 中的归一化表达值 $y_{g,t}$ 为：\n    $$y_{g,t} = \\ln(x_{g,t}) - \\frac{1}{G} \\sum_{i=0}^{G-1} \\ln(x_{i,t})$$\n    代入前面的表达式，我们得到完整的归一化公式：\n    $$y_{g,t} = \\ln(C_{g,t} + \\epsilon) - \\frac{1}{G} \\sum_{i=0}^{G-1} \\ln(C_{i,t} + \\epsilon)$$\n    此操作应用于每个组织 $t \\in \\{0, 1, \\dots, T-1\\}$，生成一个维度为 $G \\times T$ 的归一化矩阵 $Y$。\n\n其次，我们阐述针对给定重复基因对 $(g_1, g_2)$ 的亚功能化判定规则。该规则基于归一化表达矩阵 $Y$，并包含三个强制性条件。设 $\\gamma = 0.5$，浮点数容差为 $\\tau = 10^{-12}$。\n\n对于每个基因 $g \\in \\{g_1, g_2\\}$，我们必须首先确定其峰值表达组织集合，即其 argmax 集合 $P_g$。这是在该基因的归一化表达值达到最大值（在容差 $\\tau$ 范围内）的所有组织索引的集合。\n令 $y_{g,max} = \\max_t(y_{g,t})$。则 argmax 集合为：\n$$P_g = \\{t \\mid y_{g,max} - y_{g,t} \\le \\tau\\}$$\n\n亚功能化的三个条件如下：\n\n1.  **不相交的 Argmax 集合**：两个重复基因的峰值表达组织必须完全不同。\n    $$P_{g_1} \\cap P_{g_2} = \\varnothing$$\n\n2.  **互斥显性**：每个重复基因在其自身的峰值组织中的表达水平，必须显著高于其在对应基因的峰值组织中的表达水平。令 $t_1 = \\min(P_{g_1})$ 和 $t_2 = \\min(P_{g_2})$。如果一个基因的表达在多个组织中达到峰值，则取最小索引以确保选择的唯一性。必须满足以下不等式：\n    $$y_{g_1, t_1} - y_{g_1, t_2} \\ge \\gamma$$\n    $$y_{g_2, t_2} - y_{g_2, t_1} \\ge \\gamma$$\n\n3.  **峰值锐度**：每个基因的表达峰值必须足够尖锐，即其最大表达值必须显著大于其第二高的表达值。我们将峰值锐度边际 $m_g$ 定义为最大归一化值与第二大归一化值之间的差值。如果最大值在多个组织中出现（即 $|P_g| > 1$），则根据定义 $m_g = 0$。该条件为：\n    $$m_{g_1} \\ge \\gamma \\quad \\text{and} \\quad m_{g_2} \\ge \\gamma$$\n\n当且仅当所有这三个条件都得到满足时，才判定基因对 $(g_1, g_2)$ 支持亚功能化。\n\n我们在**用例 1** 上演示此过程：\n$G=4$，$T=3$，$(g_1,g_2)=(0,1)$，$\\epsilon = 0.5$，$\\gamma = 0.5$。\n$C^{(1)} = \\begin{bmatrix} 1000 & 60 & 50 \\\\ 50 & 900 & 55 \\\\ 300 & 300 & 300 \\\\ 400 & 400 & 400 \\end{bmatrix}$。\n\n首先进行归一化：$Y^{(1)}_{g,t} = \\ln(C^{(1)}_{g,t} + 0.5) - \\frac{1}{4} \\sum_{i=0}^{3} \\ln(C^{(1)}_{i,t} + 0.5)$。这会产生归一化矩阵：\n$Y^{(1)} \\approx \\begin{bmatrix} 1.27615 & -1.54829 & -0.98712 \\\\ -1.71008 & 1.15201 & -0.89276 \\\\ 0.07333 & 0.05450 & 0.79629 \\\\ 0.36061 & 0.34178 & 1.08357 \\end{bmatrix}$。\n\n重复基因对应的行为 $y_{0} = Y^{(1)}_{0,:}$ 和 $y_{1} = Y^{(1)}_{1,:}$。\n\n1.  **不相交的 Argmax 集合**：\n    - 对于 $g_1=0$，$y_{0} \\approx [1.27615, -1.54829, -0.98712]$。最大值位于 $t=0$。$P_{g_1} = \\{0\\}$。\n    - 对于 $g_2=1$，$y_{1} \\approx [-1.71008, 1.15201, -0.89276]$。最大值位于 $t=1$。$P_{g_2} = \\{1\\}$。\n    - $P_{g_1} \\cap P_{g_2} = \\{0\\} \\cap \\{1\\} = \\varnothing$。条件满足。\n\n2.  **互斥显性**：\n    - $t_1 = 0$，$t_2 = 1$。\n    - 对于 $g_1$：$y_{0,0} - y_{0,1} \\approx 1.27615 - (-1.54829) = 2.82444 \\ge 0.5$。条件满足。\n    - 对于 $g_2$：$y_{1,1} - y_{1,0} \\approx 1.15201 - (-1.71008) = 2.86209 \\ge 0.5$。条件满足。\n\n3.  **峰值锐度**：\n    - 对于 $g_1$：其值为 $[1.27615, -1.54829, -0.98712]$。$|P_{g_1}|=1$。排序后的值为 $[1.27615, -0.98712, -1.54829]$。差值 $m_{g_1} \\approx 1.27615 - (-0.98712) = 2.26327 \\ge 0.5$。条件满足。\n    - 对于 $g_2$：其值为 $[-1.71008, 1.15201, -0.89276]$。$|P_{g_2}|=1$。排序后的值为 $[1.15201, -0.89276, -1.71008]$。差值 $m_{g_2} \\approx 1.15201 - (-0.89276) = 2.04477 \\ge 0.5$。条件满足。\n\n用例 1 的所有三个条件均得到满足。结果为 **True**。将此严格的流程应用于所有五个用例，得到以下结果：\n- 用例 1：True\n- 用例 2：False (违反条件 1：$P_{g_1} \\cap P_{g_2} \\ne \\varnothing$)\n- 用例 3：False (违反条件 3：$m_{g_1} < \\gamma$)\n- 用例 4：False (违反条件 2：$y_{g_1,t_1} - y_{g_1,t_2} < \\gamma$)\n- 用例 5：True", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the subfunctionalization problem for a suite of test cases.\n    The solution involves CLR normalization and a three-part decision rule.\n    \"\"\"\n\n    epsilon = 0.5\n    gamma = 0.5\n    tau = 1e-12\n\n    def check_subfunctionalization(C, g1, g2):\n        \"\"\"\n        Applies the full decision logic for a single test case.\n\n        Args:\n            C (np.ndarray): The GxT gene-by-tissue count matrix.\n            g1 (int): Zero-based index of the first duplicate gene.\n            g2 (int): Zero-based index of the second duplicate gene.\n\n        Returns:\n            bool: True if the gene pair supports subfunctionalization, False otherwise.\n        \"\"\"\n        # Step 1: Normalization\n        # Add pseudocount\n        X = C + epsilon\n        # Take natural logarithm\n        log_X = np.log(X)\n        # Center by subtracting the column-wise (per-tissue) mean of log values\n        Y = log_X - np.mean(log_X, axis=0, keepdims=True)\n\n        y_g1 = Y[g1, :]\n        y_g2 = Y[g2, :]\n        \n        # --- Decision Rule ---\n\n        # Condition 1: Disjoint Argmax Sets\n        max_y1 = np.max(y_g1)\n        P_g1 = np.where(np.abs(y_g1 - max_y1) = tau)[0]\n\n        max_y2 = np.max(y_g2)\n        P_g2 = np.where(np.abs(y_g2 - max_y2) = tau)[0]\n\n        if np.intersect1d(P_g1, P_g2).size > 0:\n            return False\n\n        # Condition 2: Reciprocal Dominance\n        t1 = np.min(P_g1)\n        t2 = np.min(P_g2)\n        \n        contrast_g1 = y_g1[t1] - y_g1[t2]\n        contrast_g2 = y_g2[t2] - y_g2[t1]\n\n        if not (contrast_g1 >= gamma and contrast_g2 >= gamma):\n            return False\n\n        # Condition 3: Peak Sharpness\n        # Calculate margin for g1\n        sorted_y_g1 = np.sort(y_g1)[::-1]\n        m_g1 = sorted_y_g1[0] - sorted_y_g1[1]\n\n        # Calculate margin for g2\n        sorted_y_g2 = np.sort(y_g2)[::-1]\n        m_g2 = sorted_y_g2[0] - sorted_y_g2[1]\n        \n        # The provided rule states that if the max is tied, margin is 0.\n        # This is equivalent to checking if sorted_y[0] - sorted_y[1] = tau.\n        # My m_g calculation already includes this logic effectively.\n        # If len(P_g1) > 1, m_g1 will be near zero (within tau), failing the test if gamma>tau.\n        # If m_g1 calculated as diff is less than gamma, the test fails.\n        # This implementation is correct according to the definition.\n        \n        if not (m_g1 >= gamma and m_g2 >= gamma):\n            return False\n\n        # All conditions passed\n        return True\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"C\": np.array([\n                [1000, 60, 50],\n                [50, 900, 55],\n                [300, 300, 300],\n                [400, 400, 400]\n            ]),\n            \"g1\": 0, \"g2\": 1\n        },\n        {\n            \"C\": np.array([\n                [600, 500, 400],\n                [600, 500, 400],\n                [300, 300, 300],\n                [400, 400, 400]\n            ]),\n            \"g1\": 0, \"g2\": 1\n        },\n        {\n            \"C\": np.array([\n                [200, 200, 50],\n                [80, 300, 290],\n                [100, 100, 100],\n                [110, 110, 110]\n            ]),\n            \"g1\": 0, \"g2\": 1\n        },\n        {\n            \"C\": np.array([\n                [120, 110, 100],\n                [130, 140, 135],\n                [100, 100, 100],\n                [100, 100, 100]\n            ]),\n            \"g1\": 0, \"g2\": 1\n        },\n        {\n            \"C\": np.array([\n                [0, 600, 0],\n                [700, 0, 0],\n                [300, 300, 300],\n                [400, 400, 400]\n            ]),\n            \"g1\": 0, \"g2\": 1\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = check_subfunctionalization(case[\"C\"], case[\"g1\"], case[\"g2\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2613588"}, {"introduction": "除了基因表达的变化，重复基因的命运也铭刻在其蛋白质编码序列中。本练习介绍了一个分子进化学中的基本工具——非同义替换率与同义替换率之比（$d_N/d_S$ 或 $\\omega$）的计算。通过比较旁系同源基因的 $\\omega$ 比率，我们可以发现它们进化轨迹中的不对称性，这可能暗示着新功能化或亚功能化。[@problem_id:2613574]", "problem": "一个编码细胞器靶向酶的核基因在被子植物和辐鳍鱼共同组成的进化枝的祖先中发生了一次复制。两个旁系同源基因被保留下来，分别标记为副本A和副本B。通过对每个副本的直系同源基因集进行密码子比对，并利用一个已标定复制节点的物种-基因协同进化树，最大似然法祖先状态重建识别出了紧随复制事件之后的两个主干分支（即通往副本A的分支和通往副本B的分支）上发生的替换。对于这两个分支，编码序列长度均为 $900$ 个核苷酸（$300$ 个密码子），根据 Nei–Gojobori 型方法计算的位点机会总数得出 $L_{N} = 750$ 个非同义位点和 $L_{S} = 150$ 个同义位点。在两个分支上观测到的变化计数如下：\n- 对于通往副本A的分支：$n_{N,A} = 22$ 次非同义替换和 $n_{S,A} = 4$ 次同义替换。\n- 对于通往副本B的分支：$n_{N,B} = 5$ 次非同义替换和 $n_{S,B} = 12$ 次同义替换。\n\n使用标准定义，即单位非同义位点的非同义替换率 $d_{N} = n_{N}/L_{N}$ 和单位同义位点的同义替换率 $d_{S} = n_{S}/L_{S}$，计算每个分支的非同义与同义替换率之比 $\\omega = d_{N}/d_{S}$。然后计算不对称度量 $R = \\omega_{A} / \\omega_{B}$，其中 $\\omega_{A}$ 指的是通往副本A的分支，$\\omega_{B}$ 指的是通往副本B的分支。将 $R$ 的值以四位有效数字的形式报告。无需单位。", "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于分子进化的原理，所给数据和定义完整，问题阐述清晰客观。这是一个系统发育学中的标准定量练习，与基因复制命运（如亚功能化和新功能化）的研究直接相关。\n\n目标是计算不对称度量 $R$，其定义为两个旁系同源基因副本A和B的非同义与同义替换率之比的比值。\n\n基本量是单位非同义位点的非同义替换率 $d_{N}$ 和单位同义位点的同义替换率 $d_{S}$。根据问题陈述，它们的定义如下：\n$$d_{N} = \\frac{n_{N}}{L_{N}}$$\n$$d_{S} = \\frac{n_{S}}{L_{S}}$$\n其中 $n_{N}$ 是观测到的非同义替换数，$n_{S}$ 是观测到的同义替换数，$L_{N}$ 是可用的非同义位点数，而 $L_{S}$ 是可用的同义位点数。\n\n非同义与同义替换率之比 $\\omega$ 定义为：\n$$\\omega = \\frac{d_{N}}{d_{S}} = \\frac{n_{N}/L_{N}}{n_{S}/L_{S}}$$\n\n对于两个分支，我们有以下已知数据：\n非同义位点数 $L_{N} = 750$。\n同义位点数 $L_{S} = 150$。\n\n首先，我们计算通往副本A的分支的 $\\omega$ 比率，记为 $\\omega_{A}$。\n该分支观测到的替换为：\n非同义替换数 $n_{N,A} = 22$。\n同义替换数 $n_{S,A} = 4$。\n\n将这些值代入 $\\omega$ 的公式：\n$$d_{N,A} = \\frac{n_{N,A}}{L_{N}} = \\frac{22}{750}$$\n$$d_{S,A} = \\frac{n_{S,A}}{L_{S}} = \\frac{4}{150}$$\n$$\\omega_{A} = \\frac{d_{N,A}}{d_{S,A}} = \\frac{22/750}{4/150} = \\frac{22}{750} \\times \\frac{150}{4}$$\n由于 $750 = 5 \\times 150$，我们可以简化表达式：\n$$\\omega_{A} = \\frac{22}{5 \\times 150} \\times \\frac{150}{4} = \\frac{22}{5 \\times 4} = \\frac{22}{20} = \\frac{11}{10} = 1.1$$\n\n接下来，我们计算通往副本B的分支的 $\\omega$ 比率，记为 $\\omega_{B}$。\n该分支观测到的替换为：\n非同义替换数 $n_{N,B} = 5$。\n同义替换数 $n_{S,B} = 12$。\n\n将这些值代入 $\\omega$ 的公式：\n$$d_{N,B} = \\frac{n_{N,B}}{L_{N}} = \\frac{5}{750}$$\n$$d_{S,B} = \\frac{n_{S,B}}{L_{S}} = \\frac{12}{150}$$\n$$\\omega_{B} = \\frac{d_{N,B}}{d_{S,B}} = \\frac{5/750}{12/150} = \\frac{5}{750} \\times \\frac{150}{12}$$\n同样，利用关系式 $750 = 5 \\times 150$：\n$$\\omega_{B} = \\frac{5}{5 \\times 150} \\times \\frac{150}{12} = \\frac{5}{5 \\times 12} = \\frac{1}{12}$$\n\n最后，我们计算不对称度量 $R$，即 $\\omega_{A}$ 与 $\\omega_{B}$ 的比值：\n$$R = \\frac{\\omega_{A}}{\\omega_{B}} = \\frac{1.1}{1/12} = 1.1 \\times 12 = 13.2$$\n\n问题要求结果以四位有效数字报告。为了将 $13.2$ 表示为四位有效数字，我们在末尾添加一个零。\n$$R = 13.20$$\n这个值表明在复制事件之后，两个旁系同源基因的进化速率存在显著的不对称性。副本A似乎在正选择或松弛选择下进化（$\\omega_{A}  1$），而副本B则处于强烈的纯化选择下（$\\omega_{B} \\ll 1$），这种模式与新功能化一致。", "answer": "$$\\boxed{13.20}$$", "id": "2613574"}, {"introduction": "计算预测最终必须通过功能实验来检验。这个思想实验将挑战您解释使用CRISPR、相互互补和启动子交换等复杂基因操作所产生的结果。掌握这种逻辑是区分真正的亚功能化与其他进化结果，并理解其潜在分子机制的关键。[@problem_id:2613551]", "problem": "一种脊椎动物中的保守发育调控因子和一种被子植物中的保守胁迫应答调控因子，在一个参考物种中均作为单拷贝直系同源基因存在，而在一个衍生（或演化）物种中则作为一对重复基因存在。在脊椎动物中，小鼠携带一个编码序列记为 $A$ 的单拷贝基因，该基因执行两种可分离的祖先亚功能 $F_1$（在组织 $T_1$ 中需要）和 $F_2$（在组织 $T_2$ 中需要）。在斑马鱼中，一次谱系特异性重复产生了重复基因 $D_1$ 和 $D_2$。在植物中，苔藓 *Physcomitrium patens* 携带一个编码序列记为 $M$ 的单拷贝直系同源基因，该基因执行两种可分离的祖先亚功能 $F_1$（在条件 $C_1$ 下需要）和 $F_2$（在条件 $C_2$ 下需要），而拟南芥 *Arabidopsis thaliana* 则携带重复基因 $P_1$ 和 $P_2$。你需要设计一种成簇规律间隔短回文重复序列（CRISPR）基因敲除和相互互补策略，以检验每个衍生谱系中的重复基因是否共同重构了完整的祖先功能，同时各自拯救了被分配的亚功能。\n\n可用于推理的基础原理包括：分子生物学的中心法则（脱氧核糖核酸到核糖核酸到蛋白质）、功能丧失性突变（其破坏蛋白质编码序列或关键的顺式调控元件）会消除特定基因活性的概念，以及遗传互补检验，即当一个外源编码序列在适当的启动子下表达并恢复了缺失的表型时，可推断出功能等价性。\n\n你的实验工具箱允许你：生成 $d_1^{-/-}$、$d_2^{-/-}$ 和 $d_1^{-/-}d_2^{-/-}$ 斑马鱼；生成 $p_1^{-/-}$、$p_2^{-/-}$ 和 $p_1^{-/-}p_2^{-/-}$ 拟南芥；生成 $a^{-/-}$ 小鼠和 $m^{-/-}$ 苔藓；构建表达载体，将任意编码序列（$A$, $D_1$, $D_2$, $M$, $P_1$, $P_2$）置于以下任一启动子之下：祖先启动子 $P_A$（在小鼠中驱动 $T_1$ 和 $T_2$ 的表达）、重复基因启动子 $P_{D_1}$ 或 $P_{D_2}$（斑马鱼的天然表达模式）、祖先植物启动子 $P_M$（在苔藓中驱动 $C_1$ 和 $C_2$ 条件下的表达），以及重复基因植物启动子 $P_{P_1}$ 或 $P_{P_2}$（拟南芥的天然表达模式）。假设构建的载体使用互补脱氧核糖核酸（cDNA）编码序列，并以生理水平表达。\n\n在脊椎动物和植物系统中，使用上述基因敲除和互补检验观察到的哪种（或哪些）结果模式，最有力地支持以下假说：重复基因已经亚功能化，以至于它们共同重构了完整的祖先功能，同时各自拯救了被分配的亚功能？选择所有适用的选项。\n\nA. 在斑马鱼中，$d_1^{-/-}$ 在 $T_1$ 中选择性地丧失 $F_1$ 但在 $T_2$ 中保留 $F_2$；$d_2^{-/-}$ 在 $T_2$ 中选择性地丧失 $F_2$ 但在 $T_1$ 中保留 $F_1$；$d_1^{-/-}d_2^{-/-}$ 丧失 $F_1$ 和 $F_2$。在小鼠中，$a^{-/-}$ 丧失 $F_1$ 和 $F_2$。互补实验：在 $a^{-/-}$ 中，$P_{D_1}\\!:\\!D_1$ 仅恢复 $F_1$，$P_{D_2}\\!:\\!D_2$ 仅恢复 $F_2$；共同导入 $P_{D_1}\\!:\\!D_1$ 和 $P_{D_2}\\!:\\!D_2$ 则恢复 $F_1$ 和 $F_2$。但是，将任一重复基因的编码序列置于祖先启动子下（$P_A\\!:\\!D_1$ 或 $P_A\\!:\\!D_2$）即可在 $a^{-/-}$ 中恢复 $F_1$ 和 $F_2$。相互地，$P_A\\!:\\!A$ 在 $d_1^{-/-}d_2^{-/-}$ 中恢复了 $F_1$ 和 $F_2$。在拟南芥和苔藓中，使用 $P_{P_1}\\!:\\!P_1$、$P_{P_2}\\!:\\!P_2$、$P_M\\!:\\!P_1$、$P_M\\!:\\!P_2$ 和 $P_M\\!:\\!M$ 观察到类似的组织和条件特异性结果。\n\nB. 在斑马鱼中，$d_1^{-/-}$ 和 $d_2^{-/-}$ 在 $T_1$ 和 $T_2$ 中表型正常，但 $d_1^{-/-}d_2^{-/-}$ 丧失了 $F_1$ 和 $F_2$。在小鼠中，$a^{-/-}$ 丧失了 $F_1$ 和 $F_2$。互补实验：单独的 $P_A\\!:\\!D_1$ 在 $a^{-/-}$ 中恢复了 $F_1$ 和 $F_2$，而 $P_A\\!:\\!D_2$ 既不恢复任何祖先功能，反而赋予了一种在 $a^{+/+}$ 中未见的新性状。在植物中也出现类似的结果，$P_M\\!:\\!P_1$ 拯救了 $F_1$ 和 $F_2$，而 $P_M\\!:\\!P_2$ 赋予了一个与 $M$ 无关的新表型。\n\nC. 在斑马鱼中，$d_1^{-/-}$ 和 $d_2^{-/-}$ 在 $T_1$ 中的 $F_1$ 和 $T_2$ 中的 $F_2$ 均表现出相似的部分功能减弱，而双突变体 $d_1^{-/-}d_2^{-/-}$ 则在两者中均表现出更严重的功能减弱；在小鼠中，$a^{-/-}$ 丧失了 $F_1$ 和 $F_2$。互补实验：在 $a^{-/-}$ 中，$P_A\\!:\\!D_1$ 或 $P_A\\!:\\!D_2$ 均能完全恢复 $F_1$ 和 $F_2$，且共表达不提供额外的好处。在植物系统中观察到类似的剂量效应。\n\nD. 在斑马鱼中，$d_1^{-/-}$ 选择性丧失 $F_1$，$d_2^{-/-}$ 选择性丧失 $F_2$，而 $d_1^{-/-}d_2^{-/-}$ 两者都丧失；在小鼠中，$a^{-/-}$ 两者都丧失。在祖先启动子下的互补实验揭示了编码分区：在 $a^{-/-}$ 中，$P_A\\!:\\!D_1$ 仅恢复 $F_1$，$P_A\\!:\\!D_2$ 仅恢复 $F_2$；只有共表达 $P_A\\!:\\!D_1$ 和 $P_A\\!:\\!D_2$ 才能恢复 $F_1$ 和 $F_2$。相互地，在 $d_1^{-/-}d_2^{-/-}$ 中，$P_{D_1}\\!:\\!A$ 仅恢复 $F_1$，$P_{D_2}\\!:\\!A$ 仅恢复 $F_2$；共表达 $P_{D_1}\\!:\\!A$ 和 $P_{D_2}\\!:\\!A$ 则恢复两者。在拟南芥和苔藓中，在 $P_M$ 和 $P_{P_1}/P_{P_2}$ 启动子下观察到类似的编码分区互补现象。\n\nE. 在斑马鱼和拟南芥中，$d_1^{-/-}$、$d_2^{-/-}$、$p_1^{-/-}$ 和 $p_2^{-/-}$ 没有可检测的表型，但在相应的双突变体中过表达 $D_1$ 或 $D_2$（或 $P_1$ 或 $P_2$）会加剧 $F_1$ 和 $F_2$ 的丧失。在小鼠和苔藓中，$P_A\\!:\\!D_1$ 或 $P_M\\!:\\!P_1$ 未能拯救反而恶化了各自的 $a^{-/-}$ 或 $m^{-/-}$ 表型。", "solution": "首先将对问题陈述进行严格验证。\n\n### 步骤1：提取已知条件\n\n- **问题领域**：比较动物学和植物学，特别是重复基因的进化。\n- **待检验的核心假说**：“每个衍生谱系中的重复基因共同重构了完整的祖先功能，同时各自拯救了被分配的亚功能。” 这是亚功能化的定义。\n- **模型系统**：\n    - **脊椎动物**：\n        - 参考物种：小鼠。单拷贝基因，编码序列为 $A$。\n        - 衍生（或演化）物种：斑马鱼。重复基因，编码序列为 $D_1$ 和 $D_2$。\n        - $A$ 的祖先功能：两个可分离的亚功能，$F_1$ 在组织 $T_1$ 中，$F_2$ 在组织 $T_2$ 中。\n    - **被子植物**：\n        - 参考物种：苔藓 (*Physcomitrium patens*)。单拷贝基因，编码序列为 $M$。\n        - 衍生（或演化）物种：拟南芥 (*Arabidopsis thaliana*)。重复基因，编码序列为 $P_1$ 和 $P_2$。\n        - $M$ 的祖先功能：两个可分离的亚功能，$F_1$ 在条件 $C_1$ 下，$F_2$ 在条件 $C_2$ 下。\n- **实验工具**：\n    - **基因敲除**：可以生成所有基因的无效突变体：$a^{-/-}$, $m^{-/-}$, $d_1^{-/-}$, $d_2^{-/-}$, $d_1^{-/-}d_2^{-/-}$, $p_1^{-/-}$, $p_2^{-/-}$ 和 $p_1^{-/-}p_2^{-/-}$。\n    - **表达载体**：可以使用任何指定的启动子表达任意编码序列（$A$, $D_1$, $D_2$, $M$, $P_1$, $P_2$）。载体使用互补脱氧核糖核酸（cDNA），并以生理水平表达。\n    - **启动子**：\n        - 祖先启动子：$P_A$（在 $T_1$ 和 $T_2$ 中表达），$P_M$（在 $C_1$ 和 $C_2$ 下表达）。\n        - 重复基因启动子：$P_{D_1}$，$P_{D_2}$（斑马鱼的天然表达模式），$P_{P_1}$，$P_{P_2}$（拟南芥的天然表达模式）。\n- **基础原理**：中心法则、功能丧失性诱变和遗传互补。\n\n### 步骤2：使用提取的已知条件进行验证\n\n- **科学依据**：该问题描述了重复-退化-互补（DDC）模型，这是用于解释通过亚功能化保留重复基因的进化发育生物学的基石。所提议的实验策略——在模式生物（小鼠、斑马鱼、拟南芥、苔藓）中使用基于CRISPR的基因敲除和相互互补检验——是研究基因功能和进化的标准、最先进的方法论。这些原理是可靠的。\n- **问题定义明确**：该问题提供了一个清晰的假说和一套特定的实验工具，并要求对潜在结果进行解释。问题的结构旨在根据所提供的定义引出唯一的一组正确答案。\n- **客观性**：语言是技术性的，没有主观或含糊的术语。所有元素（$A$, $F_1$, $T_1$, $P_A$ 等）都为该问题的目的进行了精确定义。\n- **缺陷分析**：\n    1.  **科学/事实不健全**：无。该情景是分子进化中的一个典型模型。\n    2.  **不可形式化/不相关**：无。该问题直接且可形式化地关于亚功能化。\n    3.  **设置不完整/矛盾**：无。该问题提供了关于基因、功能和可用实验技术的所有必要信息。\n    4.  **不切实际/不可行**：无。所描述的遗传操作在当前技术下是可行的。\n    5.  **问题提出不当/结构不良**：无。问题是明确的。\n    6.  **伪深刻/琐碎**：无。要区分这些选项，需要仔细应用遗传学和分子生物学原理，以区分亚功能化与其他结果，如新功能化、冗余或剂量效应。\n    7.  **超出科学可验证性范围**：无。这些结果是实验上可验证的表型。\n\n### 步骤3：结论和行动\n\n问题陈述在科学上是有效的、定义明确且客观的。我将继续推导解决方案。\n\n### 解决方案推导\n\n待检验的假说是**亚功能化**，该假说假定基因重复后，产生的两个旁系同源基因会分配它们之间的祖先功能。这种分配可以发生在基因调控层面（不同的表达模式）或蛋白质结构层面（蛋白质产物的不同功能能力）。一项稳健的实验测试必须能够识别这种分配，并在理想情况下区分其机制。\n\n我们必须根据亚功能化情景的预测实验结果来评估每个选项。\n\n**亚功能化预测结果分析：**\n1.  **基因敲除表型**：如果每个重复基因负责祖先功能的一个不同子集，那么敲除单个重复基因应导致部分功能丧失。例如，$d_1^{-/-}$ 应丧失功能 $F_1$ 但保留 $F_2$，而 $d_2^{-/-}$ 应丧失 $F_2$ 但保留 $F_1$。双敲除体 $d_1^{-/-}d_2^{-/-}$ 则应丧失两种功能，其表型模拟祖先的无效突变体 $a^{-/-}$。\n2.  **互补检验**：这些对于剖析机制至关重要。\n    - **相互互补**：祖先基因（$A$ 或 $M$）应能拯救衍生（或演化）物种的双突变体表型（$d_1^{-/-}d_2^{-/-}$ 或 $p_1^{-/-}p_2^{-/-}$）。反之，全套重复基因应能拯救祖先突变体表型（$a^{-/-}$ 或 $m^{-/-}$）。\n    - **启动子/编码序列交换**：通过将重复基因的编码序列置于祖先启动子（$P_A$ 或 $P_M$）下，可以测试蛋白质产物是否已分化。通过将祖先编码序列置于重复基因启动子（$P_{D_1}$、$P_{D_2}$ 等）下，可以测试调控元件的特化。\n\n### 逐项分析\n\n**选项 A：**\n- **基因敲除**：$d_1^{-/-}$ 丧失 $F_1$，$d_2^{-/-}$ 丧失 $F_2$，而 $d_1^{-/-}d_2^{-/-}$ 两者都丧失。这是功能分配的经典标志。\n- **互补实验**：\n    - $P_{D_1}\\!:\\!D_1$ 和 $P_{D_2}\\!:\\!D_2$ 的组合在 $a^{-/-}$ 中恢复了全部功能，表明重复基因共同重构了祖先状态。\n    - 关键在于，在 $a^{-/-}$ 背景下，单独的 $P_A\\!:\\!D_1$ 或 $P_A\\!:\\!D_2$ 都能完全恢复 $F_1$ 和 $F_2$。这表明 $D_1$ 和 $D_2$ 的编码序列各自仍然完全有能力执行两种祖先亚功能。因此，在天然斑马鱼中观察到的功能分配是由于其调控元件（启动子/增强子）的变化，而不是其蛋白质产物的变化。\n    - 相互地，$P_A\\!:\\!A$ 拯救了 $d_1^{-/-}d_2^{-/-}$ 双突变体，证实了功能等价性。\n- **结论**：这组结果完美而完整地证明了**调控性亚功能化**。它为该假说提供了非常强有力的支持。**正确**。\n\n**选项 B：**\n- **基因敲除**：单个敲除体（$d_1^{-/-}$ 和 $d_2^{-/-}$）表型正常，而双敲除体（$d_1^{-/-}d_2^{-/-}$）丧失了两种功能。这描述了**遗传冗余**，即任一基因都足以执行全部功能。这与亚功能化相反，亚功能化中每个基因对于一部分功能都是唯一必需的。\n- **互补实验**：$P_A\\!:\\!D_1$ 拯救了两种功能，与冗余一致。然而，$P_A\\!:\\!D_2$ 赋予了一个新性状。这表明重复基因 $D_2$ 并未分配祖先功能，而是进化出了一个新功能，这个过程被称为**新功能化**。\n- **结论**：该结果描述了冗余和新功能化，这是亚功能化之外的两种演化命运。它驳斥了该假说。**不正确**。\n\n**选项 C：**\n- **基因敲除**：单个敲除体在*两种*功能上都表现出部分减弱，双突变体则更为严重。这表明存在一种定量的，或**剂量**效应。两个基因产生的蛋白质产物总量对于两种功能的完全活性都是必需的，失去一个基因会使蛋白质总量低于两种功能的关键阈值。\n- **互补实验**：$P_A\\!:\\!D_1$ 或 $P_A\\!:\\!D_2$ 均能完全恢复两种功能，表明当在强而广泛的启动子下表达时，这两种蛋白质在功能上是相同且完全有效的。这支持一个剂量模型。虽然有时被认为是一种亚功能化，但它并不代表问题陈述中所暗示的那种性质上不同、可分离的亚功能（$T_1$ 中的 $F_1$，$T_2$ 中的 $F_2$）的分配。\n- **结论**：这描述了一个剂量共享模型，它不同于选项A和D中描述的对不同亚功能的清晰分配，因此对所提出的特定假说的支持较弱。**不正确**。\n\n**选项 D：**\n- **基因敲除**：$d_1^{-/-}$ 丧失 $F_1$，$d_2^{-/-}$ 丧失 $F_2$，而 $d_1^{-/-}d_2^{-/-}$ 两者都丧失。与选项A一样，这是功能分配的经典标志。\n- **互补实验**：\n    - 关键结果是，在广泛表达的祖先启动子 $P_A$ 下，$P_A\\!:\\!D_1$ *仅*恢复 $F_1$，而 $P_A\\!:\\!D_2$ *仅*恢复 $F_2$。这表明蛋白质产物本身已经特化了：$D_1$ 蛋白只能执行亚功能 $F_1$，$D_2$ 蛋白只能执行亚功能 $F_2$，无论它们在哪里表达。\n    - 相互检验（$P_{D_1}\\!:\\!A$ 拯救 $F_1$，$P_{D_2}\\!:\\!A$ 拯救 $F_2$）进一步证实了祖先蛋白质是双功能的，并且重复基因启动子已经分配了祖先的表达域。\n- **结论**：这组结果是**结构性（或编码性）亚功能化**的完美而完整的证明，其中退化性突变发生在重复基因的蛋白质编码区。它为该假说提供了非常强有力的支持。**正确**。\n\n**选项 E：**\n- **基因敲除**：单个敲除体没有表型，表明存在冗余。\n- **互补实验**：在突变体背景下表达一个重复基因会*恶化*表型。这表明存在**显性负效应**或其他形式的功能干扰，即引入的蛋白质干扰了细胞中剩余的功能复合体。这是一种病理结果，而不是像亚功能化那样的建设性进化过程。\n- **结论**：该结果与亚功能化不一致，并指向一种有害的相互作用。**不正确**。\n\n总之，选项 A 和 D 都描述了清晰、明确且有充分支持的亚功能化机制，完全符合假说。选项 A 代表调控性亚功能化，选项 D 代表结构性亚功能化。两者都是有效且有力的证据。", "answer": "$$\\boxed{AD}$$", "id": "2613551"}]}