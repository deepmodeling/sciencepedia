{"hands_on_practices": [{"introduction": "进化生态学的一个基石是设计实验来剖析遗传和环境对表型变异的贡献。在经历了数月甚至数年的田野和实验室工作后，关键的步骤便是解读数据。本练习将让你扮演一位生态学家的角色，分析一个经典共同园圃实验的结果，挑战你解读统计输出，以区分表型可塑性与遗传分化 [@problem_id:2565345]。通过处理这个模拟数据集，你将练习识别这些核心过程的特征，并评估支持共享发育偏向的证据。", "problem": "一位植物生态学家比较了沿海拔梯度的气孔密度，以区分表型可塑性与遗传分化。从同一物种的两个种群中收集了种子：一个低海拔来源地 ($L$) 和一个高海拔来源地 ($H$)。从每个来源地中，取样了 $n = 10$ 个母系家系，并在两个模拟低海拔 ($E_L$：较高的二氧化碳分压、较温暖、较高的饱和水汽压差) 和高海拔 ($E_H$：较低的二氧化碳分压、较凉爽、较低的饱和水汽压差) 的受控同质园环境中，采用分裂兄弟设计进行培育。每个家系在每种环境中提供 $2$ 个无性繁殖的个体。在植株成熟后，测量其完全展开叶片的气孔密度 (每 $\\mathrm{mm}^2$ 的气孔数)。\n\n作为基础，回顾以下核心定义。反应规范是给定基因型从环境到表型的映射。表型可塑性是基因型在不同环境下的表型变化，通常由其反应规范的斜率反映。当来自不同来源地的基因型在同一环境中测量时表型不同，则种群间存在遗传分化。当环境对表型的影响因基因型或来源地而异时，就存在基因型-环境交互作用，这通常由不平行的反应规范反映。发育偏向指发育过程在不同基因型和环境中倾向于优先产生某些表型变化而非其他变化的趋势，当偏向是共享的时，这预示着反应规范的方向会趋于一致或受到限制。\n\n该研究报告了气孔密度的以下总平均值 (家系间的平均值；平均值 ± 标准误)：\n- 来源地 $L$：在 $E_L$ 环境中为 $155 \\pm 5$；在 $E_H$ 环境中为 $222 \\pm 6$。\n- 来源地 $H$：在 $E_L$ 环境中为 $165 \\pm 5$；在 $E_H$ 环境中为 $232 \\pm 6$。\n\n一个包含环境 ($E$)、来源地 ($O$) 及其交互作用 ($E \\times O$) 的固定效应，以及嵌套在来源地内的家系的随机效应的线性混合模型，得出以下结果：\n- 环境主效应：$F_{1,36} = 128.4$，$p < 0.0001$。\n- 来源地主效应：$F_{1,18} = 5.6$，$p = 0.028$。\n- 交互作用 $E \\times O$：$F_{1,36} = 0.31$，$p = 0.58$。\n\n根据这些结果和上述基础定义，哪种解释得到了最强的支持？\n\nA. 该模式仅由表型可塑性解释；没有证据表明存在遗传分化或存在使响应方向一致的共享发育偏向。\n\nB. 该模式仅由遗传分化解释；没有证据表明在不同环境中存在表型可塑性。\n\nC. 表型可塑性和遗传分化都存在；不同来源地的反应规范实际上是平行的 (没有基因型-环境交互作用)，这与一种共享的发育偏向相一致，该偏向将响应引导至在高海拔条件下产生更高的气孔密度。\n\nD. 存在强烈的基因型-环境交互作用，反应规范相交；不同来源地的可塑性差异显著，这与共享发育偏向的观点相矛盾。", "solution": "首先将验证问题陈述的科学合理性、自我一致性和清晰度。\n\n**步骤1：提取已知信息**\n\n*   **实验对象：** 来自两个来源地的单一植物物种：低海拔 ($L$) 和高海拔 ($H$)。\n*   **实验设计：** 一项同质园实验，每个来源地有 $n = 10$ 个母系家系。每个家系进行无性繁殖 (每个环境 $2$ 个个体)，并采用分裂兄弟设计进行培育。\n*   **实验环境：** 两个受控的同质园，模拟低海拔 ($E_L$) 和高海拔 ($E_H$)。\n    *   $E_L$：较高的二氧化碳分压、较温暖、较高的饱和水汽压差。\n    *   $E_H$：较低的二氧化碳分压、较凉爽、较低的饱和水汽压差。\n*   **测量性状：** 气孔密度 (每 $\\mathrm{mm}^2$ 的气孔数)。\n*   **核心定义：**\n    *   反应规范：给定基因型从环境到表型的映射。\n    *   表型可塑性：基因型在不同环境下的表型变化，由其反应规范的斜率表示。\n    *   遗传分化：在同一环境中测量时，不同来源地之间的表型差异。\n    *   基因型-环境交互作用 ($G \\times E$)：不平行的反应规范，即环境的影响因基因型/来源地而异。\n    *   发育偏向：发育过程倾向于优先产生某些表型变异的趋势，导致反应规范的方向一致或受限。\n*   **平均气孔密度数据 (平均值 ± 标准误)：**\n    *   来源地 $L$：在 $E_L$ 环境中为 $155 \\pm 5$；在 $E_H$ 环境中为 $222 \\pm 6$。\n    *   来源地 $H$：在 $E_L$ 环境中为 $165 \\pm 5$；在 $E_H$ 环境中为 $232 \\pm 6$。\n*   **线性混合模型结果：**\n    *   环境 ($E$) 主效应：$F_{1,36} = 128.4$，$p < 0.0001$。\n    *   来源地 ($O$) 主效应：$F_{1,18} = 5.6$，$p = 0.028$。\n    *   交互作用效应 ($E \\times O$)：$F_{1,36} = 0.31$，$p = 0.58$。\n\n**步骤2：使用提取的已知信息进行验证**\n\n问题陈述在科学上是有效的。\n*   **科学依据：** 实验设计 (同质园) 是演化生态学中划分遗传和环境对表型影响的标准方法。表型可塑性、遗传分化、基因型-环境交互作用和发育偏向等概念是该领域的核心原则。线性混合模型的使用对于这种层级数据结构（来源地内的家系内的克隆）是合适的。观察到的趋势——高海拔条件下（较低的 $pCO_2$）气孔密度更高——与已有的植物生态生理学知识相符。\n*   **问题明确且客观：** 问题提供了清晰的定义、定量数据和正式的统计结果，并要求给出最受支持的解释。问题是客观的，并且根据所提供的信息可以推导出唯一的答案。\n*   **完整性和一致性：** 问题是自洽的。提供的统计结果与平均值和实验设计相符。$F$ 检验的自由度对于此类模型是合理的。不存在矛盾或缺失关键信息。\n\n**步骤3：结论与行动**\n\n问题是有效的。可以构建严谨的解决方案。\n\n**解决方案的推导**\n\n目标是在给定定义的背景下解释所提供的统计结果和平均值。\n\n1.  **表型可塑性分析：** 表型可塑性是表型在不同环境下的变化。环境 ($E$) 的主效应为此提供了证据。统计结果为 $F_{1,36} = 128.4$，$p < 0.0001$。这个高度显著的结果表明，平均而言，气孔密度在 $E_L$ 和 $E_H$ 两种环境之间存在差异。对于两个来源地，从 $E_L$ 迁移到 $E_H$ 都会导致气孔密度大幅增加 (来源地 $L$ 从 $155$ 增加到 $222$；来源地 $H$ 从 $165$ 增加到 $232$)。因此，有强有力的证据表明存在表型可塑性。\n\n2.  **遗传分化分析：** 如果来自不同来源地的基因型在同一环境中的表型不同，则存在遗传分化。来源地 ($O$) 的主效应为此提供了证据。统计结果为 $F_{1,18} = 5.6$，$p = 0.028$。这个显著的结果表明，在所有环境的平均水平上，来自来源地 $L$ 和来源地 $H$ 的植物具有不同的平均气孔密度。检查每个环境中的平均值证实了这一点：在 $E_L$ 中，来源地 $L$ 的平均密度为 $155$，来源地 $H$ 为 $165$；在 $E_H$ 中，来源地 $L$ 的平均密度为 $222$，来源地 $H$ 为 $232$。在这两种情况下，高海拔来源地 ($H$) 的气孔密度都高于低海拔来源地 ($L$)。这表明该性状存在遗传分化。\n\n3.  **基因型-环境交互作用 ($G \\times E$) 分析：** 当不同基因型的反应规范不平行时，就会发生 $G \\times E$ 交互作用。这通过交互项 $E \\times O$ 进行检验。统计结果为 $F_{1,36} = 0.31$，$p = 0.58$。这个高 $p$ 值表明缺乏交互作用的统计证据。因此，反应规范被认为是平行的。我们可以通过计算平均值的反应规范斜率来验证这一点。\n    *   来源地 $L$ 的斜率：$\\Delta(\\text{density})_L = 222 - 155 = 67$。\n    *   来源地 $H$ 的斜率：$\\Delta(\\text{density})_H = 232 - 165 = 67$。\n    斜率完全相同，与不显著的交互作用项完美匹配。这意味着两种来源地对环境的塑性响应幅度是相同的。\n\n4.  **发育偏向分析：** 发育偏向被定义为发育过程倾向于优先产生某些表型结果的趋势。观察到两个来源地的反应规范不仅方向一致 (斜率均为正)，而且是平行的，这是与共享发育偏向一致的有力证据。这意味着该物种的发育系统受到限制或“引导”，以一种高度特定且一致的方式响应从 $E_L$到 $E_H$ 的环境变化，而与遗传来源无关。\n\n**选项评估**\n\n*   **A. 该模式仅由表型可塑性解释；没有证据表明存在遗传分化或存在使响应方向一致的共享发育偏向。**\n    该陈述是**不正确**的。存在遗传分化的显著证据 (来源地主效应，$p = 0.028$)。平行的反应规范实际上与共享的发育偏向相符，而不是缺乏这种偏向。\n\n*   **B. 该模式仅由遗传分化解释；没有证据表明在不同环境中存在表型可塑性。**\n    该陈述是**不正确**的。存在表型可塑性的极强证据 (环境主效应，$p < 0.0001$)。\n\n*   **C. 表型可塑性和遗传分化都存在；不同来源地的反应规范实际上是平行的 (没有基因型-环境交互作用)，这与一种共享的发育偏向相一致，该偏向将响应引导至在高海拔条件下产生更高的气孔密度。**\n    该陈述是**正确**的。它准确地综合了所有证据：\n    1.  可塑性 (显著的 $E$ 效应) 和遗传分化 (显著的 $O$ 效应) 都存在。\n    2.  反应规范是平行的 (不显著的 $E \\times O$ 交互作用)。\n    3.  这种平行反应规范的模式是与共享发育偏向的运作相一致的典型例子。\n\n*   **D. 存在强烈的基因型-环境交互作用，反应规范相交；可塑性在不同来源地之间差异显著，这与共享发育偏向的观点相矛盾。**\n    该陈述是**不正确**的。统计检验显示没有基因型-环境交互作用 ($p = 0.58$)，而不是强烈的交互作用。反应规范是平行的，而不是相交的 (来源地 $H$ 的密度总是高于来源地 $L$)。可塑性在不同来源地之间没有变化；表型变化是相同的 ($67$ 个单位)。这种模式支持而非反驳了共享发育偏向的观点。", "answer": "$$\\boxed{C}$$", "id": "2565345"}, {"introduction": "前一个练习侧重于解释可塑性研究的统计结果，例如方差分量 $V_G$、$V_E$ 和 $V_{G \\times E}$。接下来的这个练习将带你进入更深的层次，要求你从第一性原理出发推导这些分量。从一个基本的线性反应范式模型开始，你将运用数量遗传学理论，在数学上分解总表型方差 $V_P$，从而精确地揭示遗传变异、环境异质性及其相互作用（$G \\times E$）是如何共同产生我们所观察到的模式的 [@problem_id:2565371]。这个基础性的推导对于深刻理解表型变异的理论至关重要。", "problem": "在一项针对多年生植物不同基因型和不同环境温度下叶面积性状的比较研究中，假设该性状遵循线性反应范式。对于通过首先抽样一个基因型然后抽样一个环境而随机抽取的个体，其表型模型为\n$P = G_{0} + G_{1} X + \\varepsilon$，\n其中，$X$ 是一个环境变量，代表以标准化单位表示的日平均温度；$G_{0}$ 是一个随机截距，捕捉基因型间在性状水平上的差异；$G_{1}$ 是一个随机斜率，捕捉基因型间在可塑性上的差异；$\\varepsilon$ 捕捉基因型内的微环境和发育噪音。假设 $(G_{0},G_{1})$ 联合分布，其均值为 $\\mu_{G_{0}}$ 和 $\\mu_{G_{1}}$，方差为 $V_{G_{0}}$ 和 $V_{G_{1}}$，协方差为 $C_{01} = \\operatorname{Cov}(G_{0},G_{1})$。环境变量 $X$ 的均值为 $\\mu_{X}$，方差为 $V_{X}$；噪音项 $\\varepsilon$ 的均值为 $0$，方差为 $V_{\\varepsilon}$。\n\n假设以下独立性结构，该结构反映了基因型在各环境间的随机分配以及独立的发育噪音：$(G_{0},G_{1})$ 独立于 $X$ 且独立于 $\\varepsilon$，$X$ 独立于 $\\varepsilon$。不假设正态性。\n\n从方差和协方差的定义出发，并且仅使用诸如 $\\operatorname{Var}(U+V)=\\operatorname{Var}(U)+\\operatorname{Var}(V)+2\\,\\operatorname{Cov}(U,V)$ 和独立性下期望可分解等熟知事实，推导在基因型和环境的联合抽样下的预期表型方差 $V_{P}=\\operatorname{Var}(P)$。然后，将 $V_{P}$ 分解为三个可解释分量的和，这三个分量分别对应于遗传方差、环境方差和基因型与环境（G×E）互作方差，其中基因型与环境（G×E）互作方差指由基因型间可塑性差异与环境变异相互作用而产生的分量。\n\n用 $V_{G_{0}}$、$V_{G_{1}}$、$C_{01}$、$\\mu_{G_{1}}$、$\\mu_{X}$、$V_{X}$ 和 $V_{\\varepsilon}$ 给出 $V_{P}$ 的单一闭式符号表达式作为最终答案。不需要数值计算，也不需要单位。最终答案必须是单一表达式，而不是方程或不等式。", "solution": "该问题陈述经过验证，被认为是科学上成立、提法得当且客观的。它代表了数量遗传学中一个关于线性反应范式模型方差分析的标准问题。所有必要的参数和假设都已提供，不存在矛盾或歧义。该问题是有效的。我们开始推导。\n\n表型 $P$ 的模型是线性反应范式：\n$$P = G_{0} + G_{1} X + \\varepsilon$$\n我们的目标是推导总表型方差 $V_{P} = \\operatorname{Var}(P)$。我们将利用方差和协方差的基本性质，以及给定的独立性假设：$(G_{0},G_{1})$ 独立于 $X$ 和 $\\varepsilon$，$X$ 独立于 $\\varepsilon$。\n\n由于噪音项 $\\varepsilon$ 与所有其他变量（$G_0, G_1, X$）独立，因此 $P$ 的方差可以分解为：\n$$\\operatorname{Var}(P) = \\operatorname{Var}(G_{0} + G_{1} X + \\varepsilon) = \\operatorname{Var}(G_{0} + G_{1} X) + \\operatorname{Var}(\\varepsilon)$$\n已知 $\\operatorname{Var}(\\varepsilon) = V_{\\varepsilon}$。现在我们必须计算 $\\operatorname{Var}(G_{0} + G_{1} X)$。使用和的方差公式，我们得到：\n$$\\operatorname{Var}(G_{0} + G_{1} X) = \\operatorname{Var}(G_{0}) + \\operatorname{Var}(G_{1} X) + 2 \\operatorname{Cov}(G_{0}, G_{1} X)$$\n我们分别分析每一项。\n\n1.  随机截距 $G_{0}$ 的方差为：\n    $$\\operatorname{Var}(G_{0}) = V_{G_{0}}$$\n\n2.  两个独立随机变量 $G_{1}$ 和 $X$ 的乘积的方差 $\\operatorname{Var}(G_{1} X)$，可由公式 $\\operatorname{Var}(Y) = E[Y^2] - (E[Y])^2$ 推导得出。\n    由于独立性，乘积的期望为 $E[G_{1} X] = E[G_{1}]E[X] = \\mu_{G_{1}}\\mu_{X}$。\n    同样由于独立性，乘积平方的期望为 $E[(G_{1}X)^2] = E[G_{1}^2 X^2] = E[G_{1}^2]E[X^2]$。\n    我们知道，对于任意随机变量 $Y$，有 $E[Y^2] = \\operatorname{Var}(Y) + (E[Y])^2$。\n    所以，$E[G_{1}^2] = V_{G_{1}} + \\mu_{G_{1}}^2$ 且 $E[X^2] = V_{X} + \\mu_{X}^2$。\n    将这些代入 $\\operatorname{Var}(G_{1} X)$ 的表达式中：\n    $$\\operatorname{Var}(G_{1} X) = E[G_{1}^2]E[X^2] - (E[G_{1}]E[X])^2$$\n    $$\\operatorname{Var}(G_{1} X) = (V_{G_{1}} + \\mu_{G_{1}}^2)(V_{X} + \\mu_{X}^2) - (\\mu_{G_{1}}\\mu_{X})^2$$\n    展开乘积：\n    $$\\operatorname{Var}(G_{1} X) = V_{G_{1}}V_{X} + V_{G_{1}}\\mu_{X}^2 + \\mu_{G_{1}}^2 V_{X} + \\mu_{G_{1}}^2 \\mu_{X}^2 - \\mu_{G_{1}}^2 \\mu_{X}^2$$\n    化简得：\n    $$\\operatorname{Var}(G_{1} X) = V_{G_{1}}V_{X} + V_{G_{1}}\\mu_{X}^2 + \\mu_{G_{1}}^2 V_{X}$$\n\n3.  协方差项 $\\operatorname{Cov}(G_{0}, G_{1} X)$ 可由定义 $\\operatorname{Cov}(A,B) = E[AB] - E[A]E[B]$ 推导。\n    $$\\operatorname{Cov}(G_{0}, G_{1} X) = E[G_{0} G_{1} X] - E[G_{0}]E[G_{1} X]$$\n    由于 $X$ 独立于 $(G_{0}, G_{1})$ 对，我们可以将 $X$ 的期望因子分解出来：\n    $$E[G_{0} G_{1} X] = E[G_{0} G_{1}] E[X] = E[G_{0} G_{1}] \\mu_{X}$$\n    我们还知道 $E[G_{0}] = \\mu_{G_{0}}$ 且 $E[G_{1} X] = E[G_{1}]E[X] = \\mu_{G_{1}}\\mu_{X}$。\n    将这些代回：\n    $$\\operatorname{Cov}(G_{0}, G_{1} X) = E[G_{0} G_{1}] \\mu_{X} - \\mu_{G_{0}}(\\mu_{G_{1}}\\mu_{X})$$\n    $$\\operatorname{Cov}(G_{0}, G_{1} X) = \\mu_{X} (E[G_{0} G_{1}] - E[G_{0}]E[G_{1}])$$\n    括号中的项是协方差的定义 $\\operatorname{Cov}(G_{0}, G_{1}) = C_{01}$。\n    因此：\n    $$\\operatorname{Cov}(G_{0}, G_{1} X) = C_{01} \\mu_{X}$$\n\n现在，我们将所有分量组合起来，求出总表型方差 $V_{P}$：\n$$V_{P} = \\operatorname{Var}(G_{0}) + \\operatorname{Var}(G_{1} X) + 2 \\operatorname{Cov}(G_{0}, G_{1} X) + \\operatorname{Var}(\\varepsilon)$$\n$$V_{P} = V_{G_{0}} + (V_{G_{1}}V_{X} + V_{G_{1}}\\mu_{X}^2 + \\mu_{G_{1}}^2 V_{X}) + 2(C_{01}\\mu_{X}) + V_{\\varepsilon}$$\n这就是总表型方差的完整表达式。\n\n问题要求将此方差分解为三个分量：遗传方差 ($V_G$)、环境方差 ($V_E$) 和基因型与环境互作方差 ($V_{G \\times E}$)。随机噪音方差 $V_{\\varepsilon}$ 通常被包含在环境分量中。\n\n给定基因型的基因型值是其在所有环境上平均的预期表型。令 $g = E[P|G_0, G_1]$。\n$$g = E[G_0 + G_1 X + \\varepsilon | G_0, G_1] = G_0 + G_1 E[X] + E[\\varepsilon] = G_0 + G_1 \\mu_X$$\n遗传方差 $V_G$ 是这些基因型值的方差：\n$$V_{G} = \\operatorname{Var}(g) = \\operatorname{Var}(G_0 + G_1 \\mu_X) = \\operatorname{Var}(G_0) + \\operatorname{Var}(G_1 \\mu_X) + 2\\operatorname{Cov}(G_0, G_1 \\mu_X)$$\n$$V_{G} = V_{G_0} + \\mu_X^2 \\operatorname{Var}(G_1) + 2\\mu_X \\operatorname{Cov}(G_0, G_1) = V_{G_0} + V_{G_1}\\mu_X^2 + 2C_{01}\\mu_X$$\n\n环境方差 $V_E$ 是由平均基因型的环境变异引起的表型方差分量。平均基因型的参数为 $\\mu_{G_0}$ 和 $\\mu_{G_1}$。其表型为 $\\mu_{G_0} + \\mu_{G_1} X$。该平均基因型的可塑性所引起的方差为 $\\operatorname{Var}(\\mu_{G_1} X) = \\mu_{G_1}^2 V_X$。总的非遗传方差还包括噪音项 $V_{\\varepsilon}$。因此，我们定义：\n$$V_{E} = \\mu_{G_1}^2 V_X + V_{\\varepsilon}$$\n\n基因型与环境互作方差 $V_{G \\times E}$ 源于基因型间可塑性的变异。它是可塑性的遗传变异 ($V_{G_1}$) 与环境变异 ($V_X$) 相互作用所产生的方差分量。在我们对 $\\operatorname{Var}(G_1 X)$ 的推导中，$V_{G_1}V_X$ 这一项恰好捕捉了这一概念。\n$$V_{G \\times E} = V_{G_1}V_X$$\n\n将这三个分量相加：\n$$V_G + V_E + V_{G \\times E} = (V_{G_0} + V_{G_1}\\mu_X^2 + 2C_{01}\\mu_X) + (\\mu_{G_1}^2 V_X + V_{\\varepsilon}) + (V_{G_1}V_X)$$\n$$V_G + V_E + V_{G \\times E} = V_{G_0} + V_{G_1}\\mu_X^2 + 2C_{01}\\mu_X + \\mu_{G_1}^2 V_X + V_{\\varepsilon} + V_{G_1}V_X$$\n这个和恰好重构了我们推导出的 $V_P$ 表达式。\n\n因此，$V_P$ 的最终表达式为：\n$$V_{P} = V_{G_{0}} + \\mu_{G_{1}}^{2} V_{X} + V_{G_{1}} \\mu_{X}^{2} + V_{G_{1}} V_{X} + 2 C_{01} \\mu_{X} + V_{\\varepsilon}$$", "answer": "$$\n\\boxed{V_{G_{0}} + \\mu_{G_{1}}^{2} V_{X} + V_{G_{1}} \\mu_{X}^{2} + V_{G_{1}} V_{X} + 2 C_{01} \\mu_{X} + V_{\\varepsilon}}\n$$", "id": "2565371"}, {"introduction": "发育偏向不仅仅是数量遗传学模型中的统计抽象概念，它源于发育系统具体的力学机制。为了弥合这一差距，我们现在将视角从统计描述转向机理建模。本练习提供了一个动手实践的机会，让你模拟一个经典的基因调控回路——“拨动开关”——并探索其分子参数中的不对称性如何能够在系统受到完全对称的环境信号挑战时，仍然创造出可预测的表型结果偏向 [@problem_id:2565363]。这个练习阐明了更高层次的偏向模式是如何从更低层次的生化相互作用中涌现出来的。", "problem": "为一个双基因相互抑制触发开关构建一个机制性的、无量纲化的常微分方程（ODE）模型，该开关的两个基因接收相同的瞬态环境输入。使用以下原则作为基本基础：(i) 每个基因产物的生产速率等于一个受调控的合成项减去一个一阶衰变项，以及 (ii) 相互抑制可以通过 Hill 型抑制函数来描述，这是一种在基因调控中经过充分检验的唯象公式。假设环境扰动是一个矩形脉冲，并相同地施加到两个合成项上。你的任务是实现该模型，针对几组参数集模拟其动力学，并将产生的表型结果定量地分类为一个基因相对于另一个基因的显性，从而展示参数不对称性如何在相同的扰动下产生有偏向的结果。\n\n模型定义。令 $x(t)$ 和 $y(t)$ 表示两种基因产物的无量纲浓度（无单位）。其动力学方程为\n$$\n\\frac{dx}{dt} = \\frac{s_1}{1 + \\left(\\frac{y}{K_1}\\right)^n} - d_1\\,x + u(t), \\qquad\n\\frac{dy}{dt} = \\frac{s_2}{1 + \\left(\\frac{x}{K_2}\\right)^n} - d_2\\,y + u(t),\n$$\n其中 $s_1,s_2$ 是最大合成参数，$d_1,d_2$ 是一阶衰变速率，$K_1,K_2$ 是抑制阈值，$n$ 是 Hill 系数。环境输入 $u(t)$ 对两个基因是相同的，由下式给出\n$$\nu(t) = \\begin{cases}\nA, & t_0 \\le t \\le t_1,\\\\\n0, & \\text{otherwise},\n\\end{cases}\n$$\n其振幅为 $A$，作用于时间 $t_0$ 和 $t_1$ 之间的矩形区间。所有变量和参数均已无量纲化；不使用物理单位。\n\n表型分类。在终点时间 $T$ 定义一个表型分类器 $\\phi$ 如下\n$$\n\\phi = \\begin{cases}\n+1, & x(T) - y(T) > \\tau,\\\\\n-1, & y(T) - x(T) > \\tau,\\\\\n0, & |x(T) - y(T)| \\le \\tau,\n\\end{cases}\n$$\n其中 $\\tau$ 是一个很小的数值容差。将 $\\phi=+1$ 解释为 $x$ 显性，$\\phi=-1$ 解释为 $y$ 显性，$\\phi=0$ 解释为对称。\n\n模拟协议。对于下方的每个参数集，使用初始条件 $x(0)=x_0$ 和 $y(0)=y_0$ 对 ODE 从 $t=0$ 积分到 $t=T$。使用任何适用于光滑右端项的数值稳定的 ODE 求解器。由于模型是无量纲的，因此不需要物理单位。确保对所有测试用例，都严格按照规定施加相同的扰动 $u(t)$。\n\n测试套件。模拟以下四组参数集，这些参数集旨在探究对称性、强不对称性以及双稳态的丧失。在指定的情况下，每个用例都使用相同的扰动参数 $A$、$t_0$ 和 $t_1$。\n\n- 用例 1（对称开关，初始条件轻微偏向 $y$）：\n  - $s_1 = 6.0$, $s_2 = 6.0$, $d_1 = 1.0$, $d_2 = 1.0$, $K_1 = 1.0$, $K_2 = 1.0$, $n = 2.0$,\n  - $x_0 = 0.2$, $y_0 = 0.2001$,\n  - $A = 0.5$, $t_0 = 5.0$, $t_1 = 10.0$, $T = 50.0$, $\\tau = 10^{-3}$.\n- 用例 2（不对称合成偏向 $x$，初始条件同样轻微偏向 $y$）：\n  - $s_1 = 8.0$, $s_2 = 6.0$, $d_1 = 1.0$, $d_2 = 1.0$, $K_1 = 1.0$, $K_2 = 1.0$, $n = 2.0$,\n  - $x_0 = 0.2$, $y_0 = 0.2001$,\n  - $A = 0.5$, $t_0 = 5.0$, $t_1 = 10.0$, $T = 50.0$, $\\tau = 10^{-3}$.\n- 用例 3（不对称衰变对 $x$ 不利，初始条件偏向 $x$）：\n  - $s_1 = 6.0$, $s_2 = 6.0$, $d_1 = 2.0$, $d_2 = 1.0$, $K_1 = 1.0$, $K_2 = 1.0$, $n = 2.0$,\n  - $x_0 = 0.2001$, $y_0 = 0.2$,\n  - $A = 0.5$, $t_0 = 5.0$, $t_1 = 10.0$, $T = 50.0$, $\\tau = 10^{-3}$.\n- 用例 4（低协同性，对称，初始条件相同）：\n  - $s_1 = 6.0$, $s_2 = 6.0$, $d_1 = 1.0$, $d_2 = 1.0$, $K_1 = 1.0$, $K_2 = 1.0$, $n = 1.0$,\n  - $x_0 = 0.2$, $y_0 = 0.2$,\n  - $A = 0.5$, $t_0 = 5.0$, $t_1 = 10.0$, $T = 50.0$, $\\tau = 10^{-3}$.\n\n要求的最终输出格式。你的程序应生成单行输出，其中包含用例 1 到 4 的四个整数表型分类结果，格式为一个用方括号括起来的逗号分隔列表（例如，`[1,-1,0,1]`）。每个用例只允许输出整数 `-1`、`0` 或 `+1`，并按顺序排列。", "solution": "声明的问题需要经过验证。\n\n给定条件被逐字提取。\n系统动力学由以下耦合常微分方程（ODE）定义：\n$$\n\\frac{dx}{dt} = \\frac{s_1}{1 + \\left(\\frac{y}{K_1}\\right)^n} - d_1\\,x + u(t)\n$$\n$$\n\\frac{dy}{dt} = \\frac{s_2}{1 + \\left(\\frac{x}{K_2}\\right)^n} - d_2\\,y + u(t)\n$$\n其中 $x(t)$ 和 $y(t)$ 是无量纲浓度。参数包括合成速率 $s_1, s_2$；衰变速率 $d_1, d_2$；抑制阈值 $K_1, K_2$；以及 Hill 系数 $n$。\n环境输入 $u(t)$ 是一个矩形脉冲：\n$$\nu(t) = \\begin{cases}\nA, & t_0 \\le t \\le t_1,\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n在终点时间 $T$ 的表型结果由 $\\phi$ 分类：\n$$\n\\phi = \\begin{cases}\n+1, & x(T) - y(T) > \\tau,\\\\\n-1, & y(T) - x(T) > \\tau,\\\\\n0, & |x(T) - y(T)| \\le \\tau.\n\\end{cases}\n$$\n指定了四个测试用例，它们具有独特的参数集（$s_1, s_2, d_1, d_2, K_1, K_2, n$）、初始条件（$x_0, y_0$），以及共享的扰动（$A, t_0, t_1$）和模拟（$T, \\tau$）参数。\n\n验证结论：该问题有效。\n该问题具有科学依据，采用了经典的 Gardner-Collins 触发开关模型，这是合成生物学和系统生物学中的一个基本范例。该模型基于已确立的生物物理学原理，即用于酶促反应的 Michaelis-Menten 型动力学（在此由用于协同调控的 Hill 函数表示）和一阶衰变。该问题是适定的：它指定了一个具有光滑右端项的常微分方程组，以及初始条件和所有必要的参数。根据 Picard-Lindelöf 定理，存在唯一的解并且该解是可计算的。该问题是客观、定量且无歧义的。这是计算建模领域一个标准的、非平凡的练习，它阐明了双稳态、对称性破缺和发育偏向等概念。\n\n解决方案通过对所提供的 ODE 系统进行直接数值积分来推进。由于方程是非线性的，通常无法获得解析解。需要使用数值求解器。SciPy 库中的 `solve_ivp` 函数是用于此目的的标准且鲁棒的工具，能够处理刚性和非刚性系统。\n\n该算法的核心是定义 ODE 系统右端项 (RHS) 的函数。这个函数，我们称之为 $\\vec{f}(t, \\vec{z})$，其中 $\\vec{z}(t) = [x(t), y(t)]^T$，必须正确地实现动力学。它以当前时间 $t$ 和状态向量 $\\vec{z}$ 作为输入，并返回导数向量 $[dx/dt, dy/dt]^T$。外部扰动 $u(t)$ 必须在此函数内根据 $t$ 相对于 $t_0$ 和 $t_1$ 的值来正确评估。\n\n总体流程如下：\n1.  定义 RHS 函数，该函数接受时间 $t$、状态向量 $\\vec{z}=[x, y]$ 以及所有模型参数（$s_1, s_2, d_1, d_2, K_1, K_2, n, A, t_0, t_1$）作为参数。\n2.  遍历四个指定的测试用例。\n3.  对每个用例，建立初始状态向量 $\\vec{z_0} = [x_0, y_0]$ 和积分的时间区间 $[0, T]$。\n4.  使用 RHS 函数、时间区间、初始状态和当前用例的参数集来调用数值 ODE 求解器 (`scipy.integrate.solve_ivp`)。求解器计算出该区间上的轨迹 $\\vec{z}(t)$。\n5.  从求解器的输出中提取系统的最终状态 $\\vec{z}(T) = [x(T), y(T)]$。\n6.  通过计算差值 $x(T) - y(T)$ 并将其与容差 $\\tau = 10^{-3}$ 进行比较，来应用表型分类器 $\\phi$。结果是一个整数：$+1$（$x$ 显性）、$-1$（$y$ 显性）或 $0$（对称）。\n7.  收集所有四个用例的分类结果，并将其格式化为用方括号括起来的单个逗号分隔列表。\n\n这四个测试用例旨在探究触发开关的不同行为：\n- 用例 1：系统参数（$s_1, s_2, d_1, d_2, K_1, K_2$）是完全对称的，Hill 系数 $n=2.0$ 确保了双稳态。初始状态有朝向 $y$ 的微小偏向（$y_0 = x_0 + 10^{-4}$）。在一个对称的双稳态系统中，微小的初始不对称性通常会被放大，将系统推向相应的稳定状态。因此，预期会得到一个 $y$ 显性的结果（$\\phi = -1$）。\n- 用例 2：在合成速率中引入不对称性，$s_1 = 8.0$ 和 $s_2 = 6.0$，从而产生朝向 $x$ 显性状态的内在偏向。这种偏向与仍然轻微偏向 $y$ 的初始条件相竞争。问题在于 $x$ 的更强合成能否克服 $y$ 的初始优势。合成速率的显著差异应足以迫使系统进入 $x$ 显性状态（$\\phi = +1$）。这说明了遗传参数如何能够产生发育偏向。\n- 用例 3：在衰变速率中引入不对称性，$d_1 = 2.0$ 和 $d_2 = 1.0$。$x$ 的较高衰变速率不利于其积累，从而产生朝向 $y$ 显性状态的内在偏向。这与现在偏向 $x$ 的初始条件相竞争。两倍高的衰变速率是一个巨大的劣势，预期系统会最终达到 $y$ 显性状态（$\\phi = -1$）。\n- 用例 4：Hill 系数降至 $n=1.0$。对于相互抑制的触发开关，当协同性较低时（$n \\le 1.5 - 2$，取决于其他参数），双稳态会消失。当 $n=1.0$ 时，系统拥有单一的全局稳定稳态。考虑到对称的参数和完全对称的初始条件（$x_0 = y_0$），在所有时间 $t \\ge 0$ 内，轨迹必须保持在直线 $x(t) = y(t)$ 上。最终状态将是 $x(T) = y(T)$，从而得到对称分类（$\\phi = 0$）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the gene toggle switch ODE model for four test cases and\n    classifies the phenotypic outcome.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: symmetric toggle, slight initial bias toward y\n        {'s1': 6.0, 's2': 6.0, 'd1': 1.0, 'd2': 1.0, 'K1': 1.0, 'K2': 1.0, 'n': 2.0,\n         'x0': 0.2, 'y0': 0.2001, 'A': 0.5, 't0': 5.0, 't1': 10.0, 'T': 50.0, 'tau': 1e-3},\n        # Case 2: asymmetric synthesis favoring x, same initial bias toward y\n        {'s1': 8.0, 's2': 6.0, 'd1': 1.0, 'd2': 1.0, 'K1': 1.0, 'K2': 1.0, 'n': 2.0,\n         'x0': 0.2, 'y0': 0.2001, 'A': 0.5, 't0': 5.0, 't1': 10.0, 'T': 50.0, 'tau': 1e-3},\n        # Case 3: asymmetric decay penalizing x, initial bias toward x\n        {'s1': 6.0, 's2': 6.0, 'd1': 2.0, 'd2': 1.0, 'K1': 1.0, 'K2': 1.0, 'n': 2.0,\n         'x0': 0.2001, 'y0': 0.2, 'A': 0.5, 't0': 5.0, 't1': 10.0, 'T': 50.0, 'tau': 1e-3},\n        # Case 4: low cooperativity, symmetric, identical initial condition\n        {'s1': 6.0, 's2': 6.0, 'd1': 1.0, 'd2': 1.0, 'K1': 1.0, 'K2': 1.0, 'n': 1.0,\n         'x0': 0.2, 'y0': 0.2, 'A': 0.5, 't0': 5.0, 't1': 10.0, 'T': 50.0, 'tau': 1e-3},\n    ]\n\n    def toggle_switch_rhs(t, z, s1, s2, d1, d2, K1, K2, n, A, t0, t1):\n        \"\"\"\n        Right-hand side of the ODE system for the toggle switch.\n        \n        Args:\n            t (float): Current time.\n            z (list or np.ndarray): State vector [x, y].\n            All other args are model parameters.\n        \n        Returns:\n            list: The derivatives [dx/dt, dy/dt].\n        \"\"\"\n        x, y = z\n        \n        # Environmental input u(t)\n        u_t = A if t0 <= t <= t1 else 0.0\n        \n        # Hill repression terms\n        repression_of_x = 1.0 + (y / K1)**n\n        repression_of_y = 1.0 + (x / K2)**n\n        \n        # ODEs\n        dxdt = (s1 / repression_of_x) - d1 * x + u_t\n        dydt = (s2 / repression_of_y) - d2 * y + u_t\n        \n        return [dxdt, dydt]\n\n    results = []\n    for case in test_cases:\n        # Initial conditions\n        z0 = [case['x0'], case['y0']]\n        \n        # Time span for integration\n        t_span = (0, case['T'])\n        \n        # Pack parameters for the solver\n        params = (case['s1'], case['s2'], case['d1'], case['d2'], \n                  case['K1'], case['K2'], case['n'], \n                  case['A'], case['t0'], case['t1'])\n        \n        # Solve the ODE\n        sol = solve_ivp(\n            fun=toggle_switch_rhs,\n            t_span=t_span,\n            y0=z0,\n            method='LSODA',  # Robust for stiff and non-stiff problems\n            args=params,\n            dense_output=False,\n            vectorized=False\n        )\n        \n        # Get final state\n        x_T, y_T = sol.y[:, -1]\n        \n        # Phenotype classification\n        diff = x_T - y_T\n        tau = case['tau']\n        \n        if diff > tau:\n            phi = 1\n        elif diff < -tau:\n            phi = -1\n        else:\n            phi = 0\n            \n        results.append(phi)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2565363"}]}