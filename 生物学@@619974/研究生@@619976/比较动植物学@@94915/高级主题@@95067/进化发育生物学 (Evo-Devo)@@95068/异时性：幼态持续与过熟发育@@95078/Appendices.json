{"hands_on_practices": [{"introduction": "让我们从一个基础练习开始。在发育生物学中，使用简单的线性增长模型来近似描述性状随时间的变化是一种常见且有效的方法。这个练习将让你直接应用该模型，通过计算一个因生长期延长而产生的后代性状变化，来量化一种被称为“过度生长” (hypermorphosis) 的过形成 (peramorphosis) 现象。通过这个实践，你将熟悉异时性分析的基本数学框架。[@problem_id:2580467]", "problem": "在比较动物学和植物学中，异时性（heterochrony）指的是发育过程的时间或速率发生演化变化，从而导致祖先与后代之间产生形态分化。考虑某个单一的形态性状，其个体发育轨迹可以通过恒定速率生长模型很好地近似，这是针对发育中期窗口的一个标准近似方法：性状值 $X(t)$ 在生长期内满足微分方程 $dX/dt=r$，初始条件为 $X(t_0)=X_0$。其解为 $X(t)=X_0+r(t-t_0)$，其中 $t\\in[t_0,t_1]$，$t_1$ 表示该性状的生长终止时间。\n\n假设一个祖先谱系的参数为 $(t_{0,\\mathrm{anc}},r_{\\mathrm{anc}},t_{1,\\mathrm{anc}})$，一个后代谱系的参数为 $(t_{0,\\mathrm{des}},r_{\\mathrm{des}},t_{1,\\mathrm{des}})$。假定两个谱系在发育开始时具有相同的基准性状值，$X_{0,\\mathrm{anc}}=X_{0,\\mathrm{des}}=X_0$。定义成体性状差异为\n$$\\Delta X \\equiv X_{\\mathrm{des}}(t_{1,\\mathrm{des}})-X_{\\mathrm{anc}}(t_{1,\\mathrm{anc}}).$$\n$\\Delta X$ 的正值表示过形成（peramorphosis），负值表示幼态延续（paedomorphosis）；当开始时间和速率不变时，后代中较晚的生长终止时间特别对应于过度生长（hypermorphosis）。\n\n对于一个具体案例，取祖先参数为 $(t_{0,\\mathrm{anc}}=0,\\ r_{\\mathrm{anc}}=1,\\ t_{1,\\mathrm{anc}}=10)$，后代参数为 $(t_{0,\\mathrm{des}}=0,\\ r_{\\mathrm{des}}=1,\\ t_{1,\\mathrm{des}}=12)$，所有参数均采用一致的时间和性状单位。计算 $\\Delta X$ 的精确值（以性状单位表示）。在最终的方框答案中不要包含单位。在你的推理过程中，根据这些参数关系下 $\\Delta X$ 的符号，确定所涉及的异时性机制。", "solution": "首先将对问题陈述进行严格验证。\n\n**步骤 1：提取已知条件**\n以下信息逐字提供如下：\n-   个体发育轨迹模型：性状值 $X(t)$ 在生长期内满足微分方程 $dX/dt=r$。\n-   初始条件：$X(t_0)=X_0$。\n-   模型的解：$X(t)=X_0+r(t-t_0)$，其中 $t\\in[t_0,t_1]$。\n-   祖先谱系的参数：$(t_{0,\\mathrm{anc}},r_{\\mathrm{anc}},t_{1,\\mathrm{anc}})$。\n-   后代谱系的参数：$(t_{0,\\mathrm{des}},r_{\\mathrm{des}},t_{1,\\mathrm{des}})$。\n-   共同的初始性状值：$X_{0,\\mathrm{anc}}=X_{0,\\mathrm{des}}=X_0$。\n-   成体性状差异的定义：$\\Delta X \\equiv X_{\\mathrm{des}}(t_{1,\\mathrm{des}})-X_{\\mathrm{anc}}(t_{1,\\mathrm{anc}})$。\n-   过形成的定义：$\\Delta X > 0$。\n-   幼态延续的定义：$\\Delta X < 0$。\n-   过度生长的定义：过形成的一种特例，其中 $t_{0,\\mathrm{des}}=t_{0,\\mathrm{anc}}$，$r_{\\mathrm{des}}=r_{\\mathrm{anc}}$，且 $t_{1,\\mathrm{des}}>t_{1,\\mathrm{anc}}$。\n-   祖先的具体参数：$(t_{0,\\mathrm{anc}}=0,\\ r_{\\mathrm{anc}}=1,\\ t_{1,\\mathrm{anc}}=10)$。\n-   后代的具体参数：$(t_{0,\\mathrm{des}}=0,\\ r_{\\mathrm{des}}=1,\\ t_{1,\\mathrm{des}}=12)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估。\n-   **科学依据**：线性生长模型 $dX/dt = r$ 是异速生长和发育生物学中用于近似特定个体发育窗口内生长的标准且有效的简化方法。异时性、过形成和过度生长的概念是演化发育生物学的基础。该问题在科学上是合理的。\n-   **适定性**：该问题在数学上是适定的。提供了计算 $\\Delta X$ 唯一值所需的所有参数和定义。\n-   **客观性**：语言精确、量化，并且没有主观或推测性内容。\n\n问题陈述没有科学或事实上的不合理之处，表述正式且相关，完整且一致，在建模背景下是现实的，是适定的，且并非无足轻重。它是对已定义原则的直接应用。\n\n**步骤 3：结论与行动**\n该问题是**有效的**。将推导求解。\n\n该问题要求计算成体性状差异 $\\Delta X$，并识别相应的异时性机制。\n\n任何谱系的成体性状值由所提供的生长方程的解在生长终止时间 $t_1$ 处求值得到：\n$$X(t_1) = X_0 + r(t_1 - t_0)$$\n\n对于祖先谱系，其成体性状值 $X_{\\mathrm{anc}}(t_{1,\\mathrm{anc}})$ 通过将其特定参数代入此方程得到：\n$$X_{\\mathrm{anc}}(t_{1,\\mathrm{anc}}) = X_0 + r_{\\mathrm{anc}}(t_{1,\\mathrm{anc}} - t_{0,\\mathrm{anc}})$$\n初始条件为 $X(t_{0,\\mathrm{anc}}) = X_0$，由共同值 $X_0$ 指定。\n\n类似地，对于后代谱系，其成体性状值 $X_{\\mathrm{des}}(t_{1,\\mathrm{des}})$ 为：\n$$X_{\\mathrm{des}}(t_{1,\\mathrm{des}}) = X_0 + r_{\\mathrm{des}}(t_{1,\\mathrm{des}} - t_{0,\\mathrm{des}})$$\n初始条件为 $X(t_{0,\\mathrm{des}}) = X_0$。\n\n成体性状差异 $\\Delta X$ 定义为这两个最终性状值之差：\n$$\\Delta X = X_{\\mathrm{des}}(t_{1,\\mathrm{des}}) - X_{\\mathrm{anc}}(t_{1,\\mathrm{anc}})$$\n代入每个成体性状值的表达式：\n$$\\Delta X = [X_0 + r_{\\mathrm{des}}(t_{1,\\mathrm{des}} - t_{0,\\mathrm{des}})] - [X_0 + r_{\\mathrm{anc}}(t_{1,\\mathrm{anc}} - t_{0,\\mathrm{anc}})]$$\n共同的初始值 $X_0$ 被消去，表达式简化为：\n$$\\Delta X = r_{\\mathrm{des}}(t_{1,\\mathrm{des}} - t_{0,\\mathrm{des}}) - r_{\\mathrm{anc}}(t_{1,\\mathrm{anc}} - t_{0,\\mathrm{anc}})$$\n\n现在，我们将给定的参数数值代入：\n-   祖先：$t_{0,\\mathrm{anc}}=0$，$r_{\\mathrm{anc}}=1$，$t_{1,\\mathrm{anc}}=10$。\n-   后代：$t_{0,\\mathrm{des}}=0$，$r_{\\mathrm{des}}=1$，$t_{1,\\mathrm{des}}=12$。\n\n计算过程如下：\n$$\\Delta X = 1 \\cdot (12 - 0) - 1 \\cdot (10 - 0)$$\n$$\\Delta X = 1 \\cdot 12 - 1 \\cdot 10$$\n$$\\Delta X = 12 - 10$$\n$$\\Delta X = 2$$\n\n计算出的性状差异值为 $\\Delta X = 2$。\n根据问题的定义，由于 $\\Delta X > 0$，观察到的演化变化是**过形成**的一种形式，即后代延伸或夸大了祖先的形态。\n\n此外，问题为**过度生长**提供了具体条件：\n1.  开始时间不变：$t_{0,\\mathrm{des}} = t_{0,\\mathrm{anc}}$。此处，$0 = 0$。此条件满足。\n2.  生长速率不变：$r_{\\mathrm{des}} = r_{\\mathrm{anc}}$。此处，$1 = 1$。此条件满足。\n3.  后代的生长终止时间更晚：$t_{1,\\mathrm{des}} > t_{1,\\mathrm{anc}}$。此处，$12 > 10$。此条件满足。\n\n由于所有三个条件都得到满足，具体的异时性机制是过度生长，这是一种由生长期延长导致的过形成过程。结果 $\\Delta X = 2$ 是这次过形成变化的量化度量。问题要求 $\\Delta X$ 的精确值。", "answer": "$$\\boxed{2}$$", "id": "2580467"}, {"introduction": "掌握了基础计算后，我们来探讨一个更深入的概念：不同的发育演化路径能否产生相同的成体形态？这个练习要求你从具体的数值计算转向符号推导。你需要找出生长速率、发育起始和终止时间之间的数学关系，以在发育时间改变的情况下维持成体大小不变。这项实践旨在揭示发育过程中的补偿性权衡（compensatory trade-offs）和殊途同归（equifinality）现象，这是理解演化多样性的关键。[@problem_id:2580473]", "problem": "在比较动物学和植物学中，一个描述发育过程中性状线性生长的简单力学模型由仿射函数给出：当 $t \\ge t_{0}$ 时为 $X(t) = X_{0} + r\\,(t - t_{0})$，当 $t < t_{0}$ 时为 $X(t) = X_{0}$。此处，$X_{0}$ 是在时间 $t_{0}$ 性状特异性生长开始前的初始性状值，$r$ 是在生长发生期间内恒定的性状生长速率。设祖先谱系的参数为 $(X_{0}, r, t_{0}, t_{1})$，其中 $t_{1} > t_{0}$ 定义了生长的终止（该性状发育的结束），因此祖先的成年体型为 $X_{\\mathrm{A}} = X_{0} + r\\,(t_{1} - t_{0})$。\n\n考虑一个后代谱系，其在生长开始和结束时间上，并可能在生长速率上，发生了异时性参数偏移，具体如下：其生长开始时间偏移了 $\\Delta_{0}$，变为 $t_{0}' = t_{0} + \\Delta_{0}$；其生长终止时间偏移了 $\\Delta_{1}$，变为 $t_{1}' = t_{1} + \\Delta_{1}$；其生长速率变为 $r'$。假定 $t_{1}' > t_{0}'$，以确保后代谱系的生长持续时间为正。\n\n仅使用第一性原理、异时性的核心定义（开始时间、结束时间和速率的变化）以及上述定义的线性生长模型，在后代与祖先达到相同成年体型的约束条件下，即 $X_{0} + r'\\,(t_{1}' - t_{0}') = X_{0} + r\\,(t_{1} - t_{0})$，推导出一个用 $r$、$t_{0}$、$t_{1}$、$\\Delta_{0}$ 和 $\\Delta_{1}$ 表示 $r'$ 的闭式解析表达式。你的推导过程应清楚地表明此模型中连接成年体型与速率和持续时间乘积的假设。\n\n然后，使用 $\\Delta_{0}$ 和 $\\Delta_{1}$ 的符号以及 $r'$ 相对于 $r$ 的大小，根据标准术语（开始时间偏移为前移或后移；结束时间偏移为过度生长或早熟；速率变化为加速或幼态发生）对产生的异时性模式进行分类。至少提供一个参数偏移 $(\\Delta_{0}, \\Delta_{1})$ 的例子，该例子能产生相同的成年体型但具有不同的发育历史（例如，延迟的开始时间由较高的速率补偿，相对于较早的开始时间由较低的速率补偿），并为每个例子证明其分类的合理性。\n\n重要提示：你的最终答案必须仅为 $r'$ 的解析表达式；最终答案中不要包含分类。无需四舍五入，也无需单位，因为该表达式是符号形式的。", "solution": "对所述问题进行验证。\n\n首先，逐字提取已知条件。\n- 祖先性状生长模型：当 $t \\ge t_{0}$ 时为 $X(t) = X_{0} + r\\,(t - t_{0})$，当 $t < t_{0}$ 时为 $X(t) = X_{0}$。\n- 祖先初始性状值：$X_{0}$。\n- 祖先性状生长速率：$r$。\n- 祖先生长开始时间：$t_{0}$。\n- 祖先生长终止时间：$t_{1}$，其中 $t_{1} > t_{0}$。\n- 祖先成年体型：$X_{\\mathrm{A}} = X_{0} + r\\,(t_{1} - t_{0})$。\n- 后代生长开始时间：$t_{0}' = t_{0} + \\Delta_{0}$。\n- 后代生长终止时间：$t_{1}' = t_{1} + \\Delta_{1}$。\n- 后代生长速率：$r'$。\n- 对后代生长持续时间的约束：$t_{1}' > t_{0}'$。\n- 推导的约束条件：后代达到与祖先相同的成年体型，表示为 $X_{0} + r'\\,(t_{1}' - t_{0}') = X_{0} + r\\,(t_{1} - t_{0})$。\n\n现根据所需标准对问题进行验证。\n1.  **科学依据**：该问题基于演化发育生物学领域，特别是关于异时性。线性生长模型是一种标准的一阶近似，参数（$\\Delta_{0}$, $\\Delta_{1}$, $r'$）是发育时间和速率变化的正式表示。该问题在科学上是合理的。\n2.  **适定性**：该问题是适定的。它提供了一个清晰的代数约束和足够的信息来推导所要求的 $r'$ 表达式。条件 $t_{1}' > t_{0}'$ 确保了生长持续时间为正，从而防止了除以零的奇点，并保证了 $r'$ 有一个唯一且有意义的解。\n3.  **客观性**：该问题以精确、客观的数学和生物学语言陈述。所用术语在相关科学学科内具有标准的、无歧义的定义。\n\n结论是该问题**有效**。这是一个关于代数操作和既定生物学原理概念应用的直接练习。现在开始推导解答。\n\n基本前提是祖先和后代的成年体型相等。总大小 $X(t)$ 是初始大小 $X_{0}$ 与发育过程中累积生长的总和。问题指出，两个谱系的初始大小 $X_0$ 相同。因此，要使最终成年体型相等，累积的总生长量也必须相等。祖先的累积生长量是其生长速率 $r$ 和其生长持续时间 $(t_{1} - t_{0})$ 的乘积。同样，后代的累积生长量是其速率 $r'$ 和持续时间 $(t_{1}' - t_{0}')$ 的乘积。\n\n约束由以下方程给出：\n$$X_{0} + r'\\,(t_{1}' - t_{0}') = X_{0} + r\\,(t_{1} - t_{0})$$\n该方程恰当地形式化了成年性状值相同的条件。我们首先简化此表达式。初始大小 $X_{0}$ 是方程两边的公有项，可以消去：\n$$r'\\,(t_{1}' - t_{0}') = r\\,(t_{1} - t_{0})$$\n该方程明确了核心假设：速率和持续时间的乘积是所考虑的演化变化中的一个不变量。\n\n问题以后代谱系的开始和结束时间由祖先的时间和参数偏移 $\\Delta_{0}$ 和 $\\Delta_{1}$ 定义：\n$$t_{0}' = t_{0} + \\Delta_{0}$$\n$$t_{1}' = t_{1} + \\Delta_{1}$$\n我们将这些定义代入简化的约束方程中：\n$$r'\\,((t_{1} + \\Delta_{1}) - (t_{0} + \\Delta_{0})) = r\\,(t_{1} - t_{0})$$\n左侧括号中的项可以重新排列，将祖先的持续时间和时间偏移组合在一起：\n$$r'\\,(t_{1} - t_{0} + \\Delta_{1} - \\Delta_{0}) = r\\,(t_{1} - t_{0})$$\n为了找到后代速率 $r'$ 的表达式，我们必须将其分离出来。这可以通过将两边同时除以后代的生长持续时间 $(t_{1} - t_{0} + \\Delta_{1} - \\Delta_{0})$ 来实现。此操作是有效的，因为问题陈述包含了约束 $t_{1}' > t_{0}'$，这意味着 $(t_{1} + \\Delta_{1}) > (t_{0} + \\Delta_{0})$，因此 $(t_{1} - t_{0} + \\Delta_{1} - \\Delta_{0}) \\neq 0$。最终得到的 $r'$ 的闭式解析表达式为：\n$$r' = r \\frac{t_{1} - t_{0}}{t_{1} - t_{0} + \\Delta_{1} - \\Delta_{0}}$$\n任务的第一部分到此结束。\n\n对于第二部分，我们对异时性模式进行分类。术语定义如下：\n- 开始时间：发育较早开始（$\\Delta_{0} < 0$）是**前移**。较晚开始（$\\Delta_{0} > 0$）是**后移**。\n- 结束时间：发育较早结束（$\\Delta_{1} < 0$）是**早熟**。较晚结束（$\\Delta_{1} > 0$）是**过度生长**。\n- 生长速率：较快的速率（$r' > r$）是**加速**。较慢的速率（$r' < r$）是**幼态发生**。\n\n速率的变化与持续时间的变化是耦合的。设祖先的持续时间为 $T = t_{1} - t_{0}$，后代的持续时间为 $T' = t_{1}' - t_{0}' = T + \\Delta_{1} - \\Delta_{0}$。我们推导出的表达式等价于 $r' = r \\frac{T}{T'}$。\n- 如果后代的生长持续时间缩短（$T' < T$，即 $\\Delta_{1} - \\Delta_{0} < 0$），则 $r' > r$。这是通过**加速**进行的补偿。\n- 如果后代的生长持续时间延长（$T' > T$，即 $\\Delta_{1} - \\Delta_{0} > 0$），则 $r' < r$。这是通过**幼态发生**进行的补偿。\n- 如果持续时间不变（$T' = T$，即 $\\Delta_{1} = \\Delta_{0}$），则 $r' = r$。这是一种没有速率变化的纯粹时间位移，称为等时性。\n\n我们现在提供两个例子，它们具有不同的发育历史，但导致相同的成年体型。让我们定义一个简单的祖先状态，其参数为 $t_{0} = 5$，$t_{1} = 15$ 和 $r = 10$。祖先的生长持续时间为 $T = t_{1} - t_{0} = 10$。总生长量为 $rT = 10 \\times 10 = 100$。\n\n例子1：延迟的开始时间由加速补偿。\n设生长的开始时间延迟了 $2$ 个时间单位，结束时间提前了 $3$ 个时间单位。\n- $\\Delta_{0} = 2$。这是**后移**。\n- $\\Delta_{1} = -3$。这是**早熟**。\n后代的新时间为 $t_{0}' = 5 + 2 = 7$ 和 $t_{1}' = 15 - 3 = 12$。新的持续时间为 $T' = 12 - 7 = 5$。\n由于持续时间减半（$T' = T/2$），为了维持相同的总生长量，速率必须加倍。我们用推导出的公式验证这一点：\n$$r' = r \\frac{T}{T'} = 10 \\frac{10}{5} = 20$$\n因为 $r' = 20 > r = 10$，这种变化构成了**加速**。总生长量为 $r'T' = 20 \\times 5 = 100$，与祖先相同。该后代表现出后移、早熟和加速。\n\n例子2：较早的开始时间由幼态发生补偿。\n设生长的开始时间提前了 $2$ 个时间单位，结束时间延迟了 $8$ 个时间单位。\n- $\\Delta_{0} = -2$。这是**前移**。\n- $\\Delta_{1} = 8$。这是**过度生长**。\n后代的新时间为 $t_{0}' = 5 - 2 = 3$ 和 $t_{1}' = 15 + 8 = 23$。新的持续时间为 $T' = 23 - 3 = 20$。\n由于持续时间加倍（$T' = 2T$），速率必须减半。我们验证如下：\n$$r' = r \\frac{T}{T'} = 10 \\frac{10}{20} = 5$$\n因为 $r' = 5 < r = 10$，这种变化构成了**幼态发生**。总生长量为 $r'T' = 5 \\times 20 = 100$，与祖先相同。该后代表现出前移、过度生长和幼态发生。\n\n两个例子都导致了成年体型的相同变化（实际上是零变化），但这是通过完全不同的发育程序修饰实现的，正如异时性术语所正确捕捉的那样。", "answer": "$$\\boxed{r \\frac{t_{1} - t_{0}}{t_{1} - t_{0} + \\Delta_{1} - \\Delta_{0}}}$$", "id": "2580473"}, {"introduction": "最后，我们将理论模型与生物数据的复杂现实联系起来。在实际研究中，我们面对的不是理想化的模型，而是充满变异和噪声的数据。这个练习模拟了一个实验场景，你将分析不同基因型在两种环境下的发育时间数据。你需要构建并应用一个统计模型来分解变异的来源，并根据一个量化标准来判断是否存在发育可塑性驱动的幼态延续（paedomorphosis），同时考虑基因型与环境互作（genotype-by-environment interaction, $G \\times E$）的关键影响。这项实践将锻炼你应用统计方法来检验演化假说的核心技能。[@problem_id:2580447]", "problem": "您将获得在两种环境中测量的多个基因型的发育事件时间 $t_1$（单位：小时）的平衡测量数据。其生物学背景是异时性：当某一环境中的发育时间提前，并且这种变化在各个基因型中表现一致，没有强烈的基因型与环境互作变异时，$t_1$ 跨环境的可塑性变化可能表明存在幼态延续。您必须构建并拟合一个线性混合模型，然后仅根据下文定义的定量标准，对可塑性下的幼态延续做出算法决策。您的任务纯粹是数学和计算性质的，除了所提供的定义外，不需要其他生物学背景知识。\n\n基本和建模假设：\n- 设 $y_{ijk}$ 为基因型 $i$（$i \\in \\{1,\\dots,G\\}$）、环境 $j$（$j \\in \\{1,2\\}$）和重复 $k$（$k \\in \\{1,\\dots,r\\}$）测量到的 $t_1$。$t_1$ 的单位是小时。\n- 使用线性混合模型 $y_{ijk} = \\mu + \\alpha_j + g_i + (g\\!:\\!e)_{ij} + \\varepsilon_{ijk}$，其中 $\\mu$ 是总均值，$\\alpha_j$ 是环境 $j$ 的固定效应（两个水平），$g_i \\sim \\mathcal{N}(0,\\sigma_G^2)$ 是随机的基因型效应，$(g\\!:\\!e)_{ij} \\sim \\mathcal{N}(0,\\sigma_{G\\times E}^2)$ 是随机的基因型与环境（GxE）互作效应，$\\varepsilon_{ijk} \\sim \\mathcal{N}(0,\\sigma_\\varepsilon^2)$ 是残差。所有随机效应相互独立。\n- 从平衡双因素布局（基因型为随机效应，环境为固定效应）的均方期望出发，推导方差分量 $\\sigma_{G\\times E}^2$ 和 $\\sigma_\\varepsilon^2$ 的无偏矩估计量，然后反解得到方差分量估计值。将任何负的方差分量估计值视为 $0$（一种标准的截断处理）。\n- 将基因型 $i$ 的反应范数斜率定义为 $s_i = \\bar{y}_{i2\\cdot} - \\bar{y}_{i1\\cdot}$，其中 $\\bar{y}_{ij\\cdot}$ 是在环境 $j$ 中各重复的均值。当环境编码为 $1$ 和 $2$ 时，该斜率是每个基因型在环境 $2$ 和环境 $1$ 之间的均值差异。\n\n可塑性下幼态延续的决策规则（操作化）：\n- 设 $\\bar{s}$ 为所有基因型 $s_i$ 的平均值。\n- 设 $\\pi_-$ 为 $s_i < 0$ 的基因型所占的比例。\n- 设 $V_{\\text{sum}} = \\sigma_G^2 + \\sigma_{G\\times E}^2 + \\sigma_\\varepsilon^2$，并定义相对GxE量级：当 $V_{\\text{sum}} > 0$ 时，$q = \\sigma_{G\\times E}^2 / V_{\\text{sum}}$；如果 $V_{\\text{sum}} = 0$，则 $q=0$。\n- 当且仅当以下所有条件均成立时，判定存在“可塑性下的幼态延续”：$\\bar{s} < 0$，$\\pi_- \\ge \\phi$ 和 $q \\le \\tau$，其中阈值 $\\phi = 0.75$ 和 $\\tau = 0.05$（两个阈值均无单位）。\n\n要求输出：\n- 对于测试集中的每个数据集，输出两个值：估计的 $\\sigma_{G\\times E}^2$（单位为 $\\text{hours}^2$，四舍五入到 $3$ 位小数）和可塑性下幼态延续的指示符（如果存在则为整数 $1$，否则为 $0$）。\n- 最终输出必须是单行文本，包含一个Python风格的列表，内含每个数据集的结果。每个结果是一个双元素列表，逗号后不带空格；例如，两个数据集的输出应如下所示：$[[x_1,y_1],[x_2,y_2]]$。\n\n数据约束和单位：\n- 所有 $t_1$ 测量值的单位均为小时。报告的 $\\sigma_{G\\times E}^2$ 单位为 $\\text{hours}^2$，四舍五入到 $3$ 位小数。指示符为整数 $0$ 或 $1$。\n\n测试集：\n- 对于每个数据集，设计都是平衡的，包含 $G=4$ 个基因型，$E=2$ 个环境，以及每个基因型-环境单元有 $r=3$ 个重复。\n\n请提供一个使用以下三个数据集的程序：\n\n- 数据集 A（环境 2 中发育时间一致提前）：\n  - 基因型 1：环境 1 重复 $[98,101,100]$，环境 2 重复 $[88,91,90]$。\n  - 基因型 2：环境 1 重复 $[105,102,104]$，环境 2 重复 $[93,95,94]$。\n  - 基因型 3：环境 1 重复 $[97,99,98]$，环境 2 重复 $[85,87,88]$。\n  - 基因型 4：环境 1 重复 $[110,108,109]$，环境 2 重复 $[97,96,98]$。\n\n- 数据集 B（环境间无系统性变化）：\n  - 基因型 1：环境 1 重复 $[100,101,99]$，环境 2 重复 $[100,99,101]$。\n  - 基因型 2：环境 1 重复 $[104,103,102]$，环境 2 重复 $[104,103,102]$。\n  - 基因型 3：环境 1 重复 $[98,97,99]$，环境 2 重复 $[98,99,97]$。\n  - 基因型 4：环境 1 重复 $[110,109,111]$，环境 2 重复 $[110,111,109]$。\n\n- 数据集 C（强烈的基因型与环境互作；混合的斜率）：\n  - 基因型 1：环境 1 重复 $[100,101,99]$，环境 2 重复 $[95,96,94]$。\n  - 基因型 2：环境 1 重复 $[102,100,101]$，环境 2 重复 $[106,107,105]$。\n  - 基因型 3：环境 1 重复 $[98,99,97]$，环境 2 重复 $[92,93,91]$。\n  - 基因型 4：环境 1 重复 $[105,104,106]$，环境 2 重复 $[110,109,111]$。\n\n实现要求：\n- 实现平衡双因素分析，计算基因型、环境、基因型与环境互作以及残差的平方和与均方。根据均方期望，构建 $\\sigma_{G\\times E}^2$ 和 $\\sigma_\\varepsilon^2$ 的无偏矩估计值，如果计算 $V_{\\text{sum}}$ 需要，也一并构建 $\\sigma_G^2$ 的估计值。将任何负的方差分量估计值截断为 $0$。\n- 计算每个基因型的 $s_i$、$\\bar{s}$ 和 $\\pi_-$。根据估计的方差分量计算 $q$。\n- 对于每个数据集，输出配对 $[\\sigma_{G\\times E}^2, I]$，其中 $I \\in \\{0,1\\}$ 是上文定义的指示符。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个数据集的结果写作 $[x,y]$ 的形式，逗号后不加空格，例如 $[[x_1,y_1],[x_2,y_2],[x_3,y_3]]$。", "solution": "该问题是有效的。它提出了一个清晰、独立且具有科学依据的数量遗传学任务，要求应用线性混合模型和指定的决策算法。问题是适定的，提供了所有必要的数据和定义。\n\n该问题需要基于以下线性混合模型进行统计分析：\n$$y_{ijk} = \\mu + \\alpha_j + g_i + (g\\!:\\!e)_{ij} + \\varepsilon_{ijk}$$\n此处，$y_{ijk}$ 是基因型 $i$（$i \\in \\{1,\\dots,G\\}$）在环境 $j$（$j \\in \\{1,2\\}$）中重复 $k$（$k \\in \\{1,\\dots,r\\}$）的发育事件时间。参数包括：$\\mu$，总均值；$\\alpha_j$，环境 $j$ 的固定效应；$g_i$，基因型 $i$ 的随机效应，其中 $g_i \\sim \\mathcal{N}(0, \\sigma_G^2)$；$(g\\!:\\!e)_{ij}$，基因型与环境（GxE）互作的随机效应，其中 $(g\\!:\\!e)_{ij} \\sim \\mathcal{N}(0, \\sigma_{G\\times E}^2)$；以及 $\\varepsilon_{ijk}$，残差，其中 $\\varepsilon_{ijk} \\sim \\mathcal{N}(0, \\sigma_\\varepsilon^2)$。设计是平衡的，具有 $G=4$，$E=2$ 和 $r=3$。\n\n方差分量 $\\sigma_G^2$、$\\sigma_{G\\times E}^2$ 和 $\\sigma_\\varepsilon^2$ 将使用矩量法（MOM）进行估计，该方法源自平衡双因素方差分析（ANOVA）的均方期望（EMS）。对于此混合模型（环境为固定效应，基因型为随机效应），EMS方程如下：\n$E(MS_\\varepsilon) = \\sigma_\\varepsilon^2$\n$E(MS_{G \\times E}) = \\sigma_\\varepsilon^2 + r\\sigma_{G\\times E}^2$\n$E(MS_G) = \\sigma_\\varepsilon^2 + Er\\sigma_G^2$\n\n通过将观测到的均方（MS）与其期望值相等，我们推导出MOM估计量。\n首先，我们必须计算平方和（SS）：\n设 $N=G \\cdot E \\cdot r$ 为观测总数。\n设 $y_{ij\\cdot} = \\sum_{k=1}^r y_{ijk}$，$y_{i\\cdot\\cdot} = \\sum_{j=1}^E \\sum_{k=1}^r y_{ijk}$，$y_{\\cdot j\\cdot} = \\sum_{i=1}^G \\sum_{k=1}^r y_{ijk}$，以及 $T = \\sum_{i=1}^G \\sum_{j=1}^E \\sum_{k=1}^r y_{ijk}$。\n校正因子为 $CF = T^2 / N$。\n$$SS_G = \\frac{\\sum_{i=1}^G y_{i\\cdot\\cdot}^2}{Er} - CF$$\n$$SS_E = \\frac{\\sum_{j=1}^E y_{\\cdot j\\cdot}^2}{Gr} - CF$$\n$$SS_{\\text{Cells}} = \\frac{\\sum_{i=1}^G \\sum_{j=1}^E y_{ij\\cdot}^2}{r} - CF$$\n$$SS_{G \\times E} = SS_{\\text{Cells}} - SS_G - SS_E$$\n$$SS_\\varepsilon = \\sum_{i,j,k} y_{ijk}^2 - \\frac{\\sum_{i,j} y_{ij\\cdot}^2}{r}$$\n\n通过将SS除以其各自的自由度（df），可以获得均方（MS）：\n$df_G = G-1$\n$df_E = E-1$\n$df_{G \\times E} = (G-1)(E-1)$\n$df_\\varepsilon = GE(r-1)$\n$$MS_G = \\frac{SS_G}{df_G}, \\quad MS_{G \\times E} = \\frac{SS_{G \\times E}}{df_{G \\times E}}, \\quad MS_\\varepsilon = \\frac{SS_\\varepsilon}{df_\\varepsilon}$$\n\n反解EMS方程可得出方差分量的估计量：\n$$\\hat{\\sigma}_\\varepsilon^2 = MS_\\varepsilon$$\n$$\\hat{\\sigma}_{G\\times E}^2 = \\frac{MS_{G \\times E} - MS_\\varepsilon}{r}$$\n$$\\hat{\\sigma}_G^2 = \\frac{MS_G - MS_\\varepsilon}{Er}$$\n根据规定，任何对方差分量的负估计值都必须截断为 $0$。\n\n“可塑性下的幼态延续”的决策规则基于三个条件。\n首先，我们将每个基因型 $i$ 的反应范数斜率定义为 $s_i = \\bar{y}_{i2\\cdot} - \\bar{y}_{i1\\cdot}$，其中 $\\bar{y}_{ij\\cdot} = y_{ij\\cdot}/r$ 是基因型 $i$ 在环境 $j$ 中的均值。\n然后我们计算三个指标：\n1. 平均斜率，$\\bar{s} = \\frac{1}{G} \\sum_{i=1}^G s_i$。\n2. 负斜率的比例，$\\pi_- = \\frac{1}{G} \\times |\\{i \\mid s_i < 0\\}|$。\n3. GxE方差的相对量级，$q = \\frac{\\hat{\\sigma}_{G\\times E}^2}{V_{\\text{sum}}}$，其中 $V_{\\text{sum}} = \\hat{\\sigma}_G^2 + \\hat{\\sigma}_{G\\times E}^2 + \\hat{\\sigma}_\\varepsilon^2$。如果 $V_{\\text{sum}}=0$，则 $q=0$。\n\n当且仅当使用给定的阈值 $\\phi=0.75$ 和 $\\tau=0.05$，满足以下所有三个条件时，才宣告存在幼态延续（$I=1$）：\n1. $\\bar{s} < 0$\n2. $\\pi_- \\ge \\phi$\n3. $q \\le \\tau$\n如果任何一个条件不满足，则指示符为 $I=0$。\n\n每个数据集的计算流程如下：\n1. 将输入数据重塑为 $G \\times E \\times r$ 数组。\n2. 计算平方和（$SS_G$, $SS_E$, $SS_{G \\times E}$, $SS_\\varepsilon$）。\n3. 计算均方（$MS_G$, $MS_{G \\times E}$, $MS_\\varepsilon$）。\n4. 估计方差分量（$\\hat{\\sigma}_G^2, \\hat{\\sigma}_{G\\times E}^2, \\hat{\\sigma}_\\varepsilon^2$），如果任何估计值为负，则应用截断至 $0$。\n5. 计算反应范数斜率（$s_i$）和决策指标（$\\bar{s}, \\pi_-, q$）。\n6. 应用决策规则确定指示符 $I \\in \\{0, 1\\}$。\n7. 数据集的输出为 $[\\text{round}(\\hat{\\sigma}_{G\\times E}^2, 3), I]$。\n此流程应用于所提供的三个数据集中的每一个。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the provided test suite of datasets.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset A\n        np.array([[[98, 101, 100], [88, 91, 90]],   # Genotype 1\n                  [[105, 102, 104], [93, 95, 94]],  # Genotype 2\n                  [[97, 99, 98], [85, 87, 88]],   # Genotype 3\n                  [[110, 108, 109], [97, 96, 98]]]),# Genotype 4\n\n        # Dataset B\n        np.array([[[100, 101, 99], [100, 99, 101]],\n                  [[104, 103, 102], [104, 103, 102]],\n                  [[98, 97, 99], [98, 99, 97]],\n                  [[110, 109, 111], [110, 111, 109]]]),\n\n        # Dataset C\n        np.array([[[100, 101, 99], [95, 96, 94]],\n                  [[102, 100, 101], [106, 107, 105]],\n                  [[98, 99, 97], [92, 93, 91]],\n                  [[105, 104, 106], [110, 109, 111]]])\n    ]\n\n    phi = 0.75\n    tau = 0.05\n    results = []\n\n    for data in test_cases:\n        # Step 1: Calculate ANOVA quantities\n        G, E, r = data.shape\n        N = G * E * r\n\n        # Sums\n        y_ijk = data\n        y_ij_dot = np.sum(data, axis=2)\n        y_i_dot_dot = np.sum(y_ij_dot, axis=1)\n        y_dot_j_dot = np.sum(y_ij_dot, axis=0)\n        T = np.sum(y_ijk)\n\n        # Correction Factor\n        CF = T**2 / N\n\n        # Sum of Squares (SS)\n        SS_total = np.sum(y_ijk**2) - CF\n        SS_G = np.sum(y_i_dot_dot**2) / (E * r) - CF\n        SS_E = np.sum(y_dot_j_dot**2) / (G * r) - CF\n        SS_cells = np.sum(y_ij_dot**2) / r - CF\n        SS_GxE = SS_cells - SS_G - SS_E\n        SS_error = SS_total - SS_cells\n\n        # Degrees of Freedom (df)\n        df_G = G - 1\n        df_E = E - 1\n        df_GxE = (G - 1) * (E - 1)\n        df_error = G * E * (r - 1)\n\n        # Mean Squares (MS)\n        MS_G = SS_G / df_G\n        MS_GxE = SS_GxE / df_GxE if df_GxE > 0 else 0\n        MS_error = SS_error / df_error\n\n        # Step 2: Estimate Variance Components\n        sigma_sq_error = MS_error\n        sigma_sq_GxE = max(0, (MS_GxE - MS_error) / r)\n        sigma_sq_G = max(0, (MS_G - MS_error) / (E * r))\n\n        # Step 3: Apply Decision Rule\n        # Reaction norm slopes\n        slopes = []\n        cell_means = y_ij_dot / r\n        for i in range(G):\n            s_i = cell_means[i, 1] - cell_means[i, 0]\n            slopes.append(s_i)\n        \n        slopes = np.array(slopes)\n        \n        # Condition 1: Average slope\n        s_bar = np.mean(slopes)\n        cond1 = s_bar < 0\n\n        # Condition 2: Fraction of negative slopes\n        pi_minus = np.sum(slopes < 0) / G\n        cond2 = pi_minus >= phi\n\n        # Condition 3: Relative GxE magnitude\n        V_sum = sigma_sq_G + sigma_sq_GxE + sigma_sq_error\n        q = sigma_sq_GxE / V_sum if V_sum > 0 else 0\n        cond3 = q <= tau\n\n        # Final decision\n        indicator = 1 if cond1 and cond2 and cond3 else 0\n\n        # Step 4: Assemble result\n        # Problem asks to round variance component to 3 decimals.\n        sigma_sq_GxE_rounded = round(sigma_sq_GxE, 3)\n        # Ensure that integer 0 variance is represented as a number, not necessarily a float string.\n        # However, the example format is [x,y]. Using native number types is best.\n        # Python's list to string conversion will handle it.\n        if sigma_sq_GxE_rounded == 0:\n            sigma_sq_GxE_rounded = 0\n            \n        results.append([sigma_sq_GxE_rounded, indicator])\n    \n    # Final print statement must be a single line in the exact specified format.\n    # The format is [[x1,y1],[x2,y2],...], without spaces.\n    result_strings = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "2580447"}]}