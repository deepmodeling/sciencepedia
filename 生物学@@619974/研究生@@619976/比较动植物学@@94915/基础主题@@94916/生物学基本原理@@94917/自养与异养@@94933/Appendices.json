{"hands_on_practices": [{"introduction": "呼吸商（$RQ$）是动物生理学中一个强有力的非侵入性工具，用于了解机体正在利用哪种代谢燃料。本练习将指导你从碳水化合物和脂质氧化的基本化学计量学原理出发，推导出理论上的 $RQ$ 值。随后，你将应用这些知识来解读一个假想的实验测量数据，从而将宏观的气体交换数据与潜在的微观代谢途径联系起来。[@problem_id:2548035]", "problem": "在比较动物学和植物学中，气体交换比率用于区分自养和异养代谢。对于处于静息状态的异养生物，呼吸商（RQ）定义为二氧化碳产生速率与氧气消耗速率之比。即 $ \\mathrm{RQ} = \\dot V_{\\mathrm{CO_2}} / \\dot V_{\\mathrm{O_2}} $，其中 $ \\dot V_{\\mathrm{CO_2}} $ 是二氧化碳产生速率，$ \\dot V_{\\mathrm{O_2}} $ 是氧气消耗速率。相比之下，进行产氧光合作用的自养生物表现出的光合商取决于营养物质的同化作用，但本题专注于异养呼吸和底物利用。\n\n测量得到，一只处于静息状态的恒温动物其稳态呼吸商为 $ 0.700 $。尿氮排泄量低于检测限，因此可以假定在测量时间段内蛋白质的氧化可以忽略不计。假定被氧化的底物仅有葡萄糖（碳水化合物）和棕榈酸（脂质），其化学式分别为 $ \\mathrm{C_6H_{12}O_6} $ 和 $ \\mathrm{C_{16}H_{32}O_2} $。\n\n从元素平衡（碳、氢、氧守恒）和呼吸商的定义出发，首先推导出葡萄糖和棕榈酸完全氧化的配平反应方程式，并由此推导出它们各自的RQ值。然后，将观察到的RQ建模为葡萄糖和棕榈酸混合氧化的结果，确定脂质氧化占总耗氧量的比例。\n\n将脂质消耗的耗氧量比例以 $ 0 $ 到 $ 1 $ 之间的小数形式报告，并将您的答案四舍五入至四位有效数字。最终答案中不要包含单位。", "solution": "问题陈述已解析并验证。其科学基础是代谢化学计量学，问题提法得当，数据充分，可得出唯一解，并采用客观、正式的语言进行表述。内容不存在事实错误、歧义或矛盾。因此，该问题被认定为有效，并将推导求解。\n\n第一步是为两种指定底物——葡萄糖（$\\mathrm{C_6H_{12}O_6}$）和棕榈酸（$\\mathrm{C_{16}H_{32}O_2}$）——确定呼吸商（$\\mathrm{RQ}$）的化学计量基础。$\\mathrm{RQ}$ 定义为产生的二氧化碳与消耗的氧气的摩尔比，即 $\\mathrm{RQ} = \\dot V_{\\mathrm{CO_2}} / \\dot V_{\\mathrm{O_2}}$，在恒温恒压下，这等同于体积比。\n\n对于葡萄糖，其完全氧化反应为：\n$$ \\mathrm{C_6H_{12}O_6} + a \\mathrm{O_2} \\rightarrow b \\mathrm{CO_2} + c \\mathrm{H_2O} $$\n为配平此方程式，我们应用元素守恒定律：\n1.  碳（$\\mathrm{C}$）：左侧有 $6$ 个碳原子，因此 $b$ 必须为 $6$。\n2.  氢（$\\mathrm{H}$）：左侧有 $12$ 个氢原子，因此 $2c=12$，解得 $c=6$。\n3.  氧（$\\mathrm{O}$）：左侧有 $6 + 2a$ 个氧原子，右侧有 $6 \\times 2 + 6 \\times 1 = 18$ 个氧原子。令二者相等可得 $6 + 2a = 18$，简化为 $2a=12$，所以 $a=6$。\n配平后的葡萄糖氧化反应为：\n$$ \\mathrm{C_6H_{12}O_6} + 6 \\mathrm{O_2} \\rightarrow 6 \\mathrm{CO_2} + 6 \\mathrm{H_2O} $$\n根据该化学计量关系，葡萄糖的呼吸商（$\\mathrm{RQ}_{\\text{glucose}}$）是产生的 $\\mathrm{CO_2}$ 摩尔数与消耗的 $\\mathrm{O_2}$ 摩尔数之比：\n$$ \\mathrm{RQ}_{\\text{glucose}} = \\frac{6}{6} = 1 $$\n\n接下来，我们对棕榈酸（一种脂质）进行同样的分析：\n$$ \\mathrm{C_{16}H_{32}O_2} + a' \\mathrm{O_2} \\rightarrow b' \\mathrm{CO_2} + c' \\mathrm{H_2O} $$\n1.  碳（$\\mathrm{C}$）：左侧有 $16$ 个碳原子，因此 $b'=16$。\n2.  氢（$\\mathrm{H}$）：左侧有 $32$ 个氢原子，因此 $2c'=32$，解得 $c'=16$。\n3.  氧（$\\mathrm{O}$）：左侧有 $2 + 2a'$ 个氧原子，右侧有 $16 \\times 2 + 16 \\times 1 = 32 + 16 = 48$ 个氧原子。令二者相等可得 $2 + 2a' = 48$，简化为 $2a'=46$，所以 $a'=23$。\n配平后的棕榈酸氧化反应为：\n$$ \\mathrm{C_{16}H_{32}O_2} + 23 \\mathrm{O_2} \\rightarrow 16 \\mathrm{CO_2} + 16 \\mathrm{H_2O} $$\n因此，棕榈酸的呼吸商（$\\mathrm{RQ}_{\\text{lipid}}$）为：\n$$ \\mathrm{RQ}_{\\text{lipid}} = \\frac{16}{23} $$\n\n问题指出，动物观察到的呼吸商 $\\mathrm{RQ}_{\\text{obs}} = 0.700$ 是葡萄糖和脂质混合氧化的结果。我们可以将总耗氧量（$\\dot V_{\\mathrm{O_2, total}}$）和总二氧化碳产生量（$\\dot V_{\\mathrm{CO_2, total}}$）表示为每种底物贡献的总和：\n$$ \\dot V_{\\mathrm{O_2, total}} = \\dot V_{\\mathrm{O_2, glucose}} + \\dot V_{\\mathrm{O_2, lipid}} $$\n$$ \\dot V_{\\mathrm{CO_2, total}} = \\dot V_{\\mathrm{CO_2, glucose}} + \\dot V_{\\mathrm{CO_2, lipid}} $$\n观察到的 $\\mathrm{RQ}$ 是这些总量的比率：\n$$ \\mathrm{RQ}_{\\text{obs}} = \\frac{\\dot V_{\\mathrm{CO_2, total}}}{\\dot V_{\\mathrm{O_2, total}}} = \\frac{\\dot V_{\\mathrm{CO_2, glucose}} + \\dot V_{\\mathrm{CO_2, lipid}}}{\\dot V_{\\mathrm{O_2, glucose}} + \\dot V_{\\mathrm{O_2, lipid}}} $$\n利用各个RQ的定义，我们可以写出 $\\dot V_{\\mathrm{CO_2, glucose}} = \\mathrm{RQ}_{\\text{glucose}} \\cdot \\dot V_{\\mathrm{O_2, glucose}}$ 和 $\\dot V_{\\mathrm{CO_2, lipid}} = \\mathrm{RQ}_{\\text{lipid}} \\cdot \\dot V_{\\mathrm{O_2, lipid}}$。将它们代入 $\\mathrm{RQ}_{\\text{obs}}$ 的方程中可得：\n$$ \\mathrm{RQ}_{\\text{obs}} = \\frac{\\mathrm{RQ}_{\\text{glucose}} \\cdot \\dot V_{\\mathrm{O_2, glucose}} + \\mathrm{RQ}_{\\text{lipid}} \\cdot \\dot V_{\\mathrm{O_2, lipid}}}{\\dot V_{\\mathrm{O_2, glucose}} + \\dot V_{\\mathrm{O_2, lipid}}} $$\n我们需要求出脂质氧化占总耗氧量的比例。设此比例为 $f_{\\text{lipid}}$：\n$$ f_{\\text{lipid}} = \\frac{\\dot V_{\\mathrm{O_2, lipid}}}{\\dot V_{\\mathrm{O_2, total}}} = \\frac{\\dot V_{\\mathrm{O_2, lipid}}}{\\dot V_{\\mathrm{O_2, glucose}} + \\dot V_{\\mathrm{O_2, lipid}}} $$\n同样，设 $f_{\\text{glucose}}$ 为葡萄糖的比例：\n$$ f_{\\text{glucose}} = \\frac{\\dot V_{\\mathrm{O_2, glucose}}}{\\dot V_{\\mathrm{O_2, total}}} = \\frac{\\dot V_{\\mathrm{O_2, glucose}}}{\\dot V_{\\mathrm{O_2, glucose}} + \\dot V_{\\mathrm{O_2, lipid}}} $$\n显然，$f_{\\text{glucose}} + f_{\\text{lipid}} = 1$。\n通过将 $\\mathrm{RQ}_{\\text{obs}}$ 表达式的分子和分母同除以 $\\dot V_{\\mathrm{O_2, total}}$，我们得到一个加权平均值：\n$$ \\mathrm{RQ}_{\\text{obs}} = \\mathrm{RQ}_{\\text{glucose}} \\cdot f_{\\text{glucose}} + \\mathrm{RQ}_{\\text{lipid}} \\cdot f_{\\text{lipid}} $$\n代入 $f_{\\text{glucose}} = 1 - f_{\\text{lipid}}$：\n$$ \\mathrm{RQ}_{\\text{obs}} = \\mathrm{RQ}_{\\text{glucose}} (1 - f_{\\text{lipid}}) + \\mathrm{RQ}_{\\text{lipid}} \\cdot f_{\\text{lipid}} $$\n现在我们求解 $f_{\\text{lipid}}$：\n$$ \\mathrm{RQ}_{\\text{obs}} = \\mathrm{RQ}_{\\text{glucose}} - \\mathrm{RQ}_{\\text{glucose}} \\cdot f_{\\text{lipid}} + \\mathrm{RQ}_{\\text{lipid}} \\cdot f_{\\text{lipid}} $$\n$$ \\mathrm{RQ}_{\\text{obs}} - \\mathrm{RQ}_{\\text{glucose}} = f_{\\text{lipid}} (\\mathrm{RQ}_{\\text{lipid}} - \\mathrm{RQ}_{\\text{glucose}}) $$\n$$ f_{\\text{lipid}} = \\frac{\\mathrm{RQ}_{\\text{obs}} - \\mathrm{RQ}_{\\text{glucose}}}{\\mathrm{RQ}_{\\text{lipid}} - \\mathrm{RQ}_{\\text{glucose}}} $$\n现在我们将已知值代入这个推导出的公式：$\\mathrm{RQ}_{\\text{obs}} = 0.700$，$\\mathrm{RQ}_{\\text{glucose}} = 1$，以及 $\\mathrm{RQ}_{\\text{lipid}} = \\frac{16}{23}$。\n$$ f_{\\text{lipid}} = \\frac{0.700 - 1}{\\frac{16}{23} - 1} $$\n$$ f_{\\text{lipid}} = \\frac{-0.300}{\\frac{16 - 23}{23}} = \\frac{-0.300}{\\frac{-7}{23}} $$\n$$ f_{\\text{lipid}} = 0.300 \\times \\frac{23}{7} = \\frac{6.9}{7} $$\n计算得出：\n$$ f_{\\text{lipid}} \\approx 0.98571428... $$\n题目要求答案四舍五入至四位有效数字。\n$$ f_{\\text{lipid}} \\approx 0.9857 $$\n此结果表明，该动物消耗的氧气中约有 $98.57\\%$ 用于脂质氧化，这与观察到的RQ值为 $0.700$ 相符，该值非常接近纯脂质代谢的理论RQ值。", "answer": "$$\n\\boxed{0.9857}\n$$", "id": "2548035"}, {"introduction": "与异养生物相对直接的分解代谢不同，光合自养生物在其核心碳固定酶RuBisCO上存在一个根本性的权衡。本练习深入探讨了这种权衡的定量影响，通过对光呼吸的化学计量进行建模。通过解决这个问题，你将计算出在有氧条件下同化$\\mathrm{CO_2}$的真实能量成本，这是限制C3光合作用效率的一个关键因素。[@problem_id:2548096]", "problem": "从比较植物-动物生理学的角度来看，产氧光合自养生物必须应对1,5-二磷酸核酮糖羧化酶/加氧酶 (RuBisCO) 的双重反应活性，该酶催化1,5-二磷酸核酮糖的羧化和氧合两种反应。这种不可避免的氧合反应会启动光呼吸补救途径，该途径释放二氧化碳并消耗细胞能量，这与不面临类似卡尔文-本森循环负担的异养生物形成对比。考虑一个典型的 $\\mathrm{C}_3$ 叶片，在 $25^{\\circ}\\mathrm{C}$ 和环境 $\\mathrm{O}_2$ 浓度下。\n\n使用以下经过充分检验的生理学事实作为基本依据：\n- RuBisCO 对 $\\mathrm{CO}_2$ 和 $\\mathrm{O}_2$ 的区分能力可以用有效专一性因子 $S^{*}$ (无量纲) 来表示，其定义使得 RuBisCO 氧合速率与羧化速率之比满足\n$$\\frac{v_{o}}{v_{c}}=\\frac{O}{C_{c}}\\cdot\\frac{1}{S^{*}},$$\n其中 $O$ 是叶绿体 $\\mathrm{O}_2$ 分压，$C_{c}$ 是叶绿体 $\\mathrm{CO}_2$ 分压。\n- 在 $25^{\\circ}\\mathrm{C}$ 时，取 $S^{*}=2600$ (无量纲)。假设 $O=21\\,\\mathrm{kPa}$ 且 $C_{c}=28\\,\\mathrm{Pa}$。\n- 卡尔文-本森循环中，将一个 $\\mathrm{CO}_2$ 羧化为碳水化合物需要 $3$ 个三磷酸腺苷 (ATP) 和 $2$ 个还原型烟酰胺腺嘌呤二核苷酸磷酸 (NADPH)。\n- 磷酸乙醇酸的光呼吸补救途径将碳返回到卡尔文-本森循环，但每发生两次 RuBisCO 氧合事件，会释放一个 $\\mathrm{CO}_2$ 并消耗 $3$ 个 ATP 和 $2$ 个 NADPH。\n\n仅从这些基本事实和定义出发，完成以下任务：\n1. 推导氧合与羧化之比 $\\varphi=\\frac{v_{o}}{v_{c}}$。\n2. 根据 RuBisCO 和光呼吸的化学计量关系，推导在光呼吸存在的情况下，每个羧化事件净释放的 $\\mathrm{CO}_2$ 以及净消耗的 ATP 和 NADPH。\n3. 由此，推导出每净同化一个 $\\mathrm{CO}_2$ 分子所需的 ATP 分子数的闭式表达式（作为 $\\varphi$ 的函数），然后根据给定条件计算其数值。\n\n将最终答案表示为每净固定一个 $\\mathrm{CO}_2$ 分子所需的 ATP 分子数。将答案四舍五入到四位有效数字。最终答案中不要包含单位。", "solution": "在尝试进行任何解答之前，将对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- RuBisCO 氧合速率 ($v_o$) 与羧化速率 ($v_c$) 之比由下式给出：$\\frac{v_{o}}{v_{c}}=\\frac{O}{C_{c}}\\cdot\\frac{1}{S^{*}}$。\n- $S^{*}$ 是有效专一性因子。在 $25^{\\circ}\\mathrm{C}$ 时，$S^{*}=2600$。\n- $O$ 是叶绿体 $\\mathrm{O}_2$ 分压，给定值为 $O=21\\,\\mathrm{kPa}$。\n- $C_{c}$ 是叶绿体 $\\mathrm{CO}_2$ 分压，给定值为 $C_{c}=28\\,\\mathrm{Pa}$。\n- 卡尔文-本森循环的化学计量关系：$1$ 次 $\\mathrm{CO}_2$ 羧化需要 $3$ 个 ATP 和 $2$ 个 NADPH。\n- 光呼吸的化学计量关系：每发生 $2$ 次氧合事件，释放 $1$ 个 $\\mathrm{CO}_2$，并消耗 $3$ 个 ATP 和 $2$ 个 NADPH。\n- 氧合与羧化之比记为 $\\varphi = \\frac{v_o}{v_c}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于成熟的 Farquhar-von Caemmerer-Berry 光合作用模型，这是植物生态生理学的基石。RuBisCO 的双重功能、光呼吸、卡尔文-本森循环以及能量成本等概念在事实上和科学上都是合理的。\n- **适定性**：该问题被构造为一系列推导。它提供了所有必需的常数和化学计量关系。给出的压力单位（$O$ 以 $\\mathrm{kPa}$ 为单位，$C_c$ 以 $\\mathrm{Pa}$ 为单位）不一致，但可以轻松转换（$1\\,\\mathrm{kPa} = 1000\\,\\mathrm{Pa}$），这是一个简单的步骤，不会使问题无效，而是对基本物理单位一致性的考验。假设意图如此转换，则该问题是适定的。\n- **客观性**：该问题以精确、客观的语言陈述，没有歧义或主观论断。\n\n**结论：** 该问题被判定为有效。将提供解答。\n\n解答将按顺序解决三个指定任务。\n\n**1. 推导氧合与羧化之比 $\\varphi$**\n\n比率 $\\varphi$ 定义为 $\\frac{v_{o}}{v_{c}}$。其控制方程为：\n$$ \\varphi = \\frac{v_{o}}{v_{c}} = \\frac{O}{C_{c}}\\cdot\\frac{1}{S^{*}} $$\n分压必须使用一致的单位。我们将 $O$ 从千帕斯卡 (kPa) 转换为帕斯卡 (Pa)。\n已知 $O = 21\\,\\mathrm{kPa}$ 且 $C_{c} = 28\\,\\mathrm{Pa}$。\n$$ O = 21\\,\\mathrm{kPa} \\times \\frac{1000\\,\\mathrm{Pa}}{1\\,\\mathrm{kPa}} = 21000\\,\\mathrm{Pa} $$\n专一性因子给定为 $S^{*} = 2600$。\n将这些值代入 $\\varphi$ 的方程中：\n$$ \\varphi = \\frac{21000\\,\\mathrm{Pa}}{28\\,\\mathrm{Pa}} \\cdot \\frac{1}{2600} = 750 \\cdot \\frac{1}{2600} = \\frac{750}{2600} = \\frac{75}{260} $$\n通过将分子和分母除以它们的最大公约数 $5$ 来化简分数：\n$$ \\varphi = \\frac{15}{52} $$\n\n**2. 推导每个羧化事件的净通量**\n\n我们将所有通量归一化到单个羧化事件。当 RuBisCO 催化一摩尔底物羧化时，有 $\\varphi$ 摩尔底物被氧合。\n\n- **净 $\\mathrm{CO}_2$ 通量：**\n羧化消耗 $1$ 摩尔 $\\mathrm{CO}_2$。氧合启动光呼吸，每 $2$ 次氧合事件释放 $1$ 摩尔 $\\mathrm{CO}_2$。因此，一次氧合事件导致释放 $\\frac{1}{2}$ 摩尔 $\\mathrm{CO}_2$。\n对于 $\\varphi$ 次氧合事件，释放的 $\\mathrm{CO}_2$ 总量是 $\\frac{1}{2}\\varphi$。\n问题要求的是每个羧化事件*净释放的 $\\mathrm{CO}_2$*。这是释放总量减去消耗总量。\n每个羧化事件净释放的 $\\mathrm{CO}_2$ = (光呼吸释放的 $\\mathrm{CO}_2$) - (羧化消耗的 $\\mathrm{CO}_2$) = $\\frac{\\varphi}{2} - 1$。\n\n- **净 ATP 消耗：**\n羧化消耗 $3$ 摩尔 ATP。光呼吸每 $2$ 次氧合事件消耗 $3$ 摩尔 ATP，即每次氧合的成本为 $\\frac{3}{2}$ ATP。\n对于 $\\varphi$ 次氧合事件，ATP 成本为 $\\frac{3}{2}\\varphi$。\n每个羧化事件消耗的总 ATP = (羧化所需 ATP) + (光呼吸所需 ATP) = $3 + \\frac{3}{2}\\varphi = 3\\left(1 + \\frac{\\varphi}{2}\\right)$。\n\n- **净 NADPH 消耗：**\n羧化消耗 $2$ 摩尔 NADPH。光呼吸每 $2$ 次氧合事件消耗 $2$ 摩尔 NADPH，即每次氧合的成本为 $1$ 个 NADPH。\n对于 $\\varphi$ 次氧合事件，NADPH 成本为 $\\varphi$。\n每个羧化事件消耗的总 NADPH = (羧化所需 NADPH) + (光呼吸所需 NADPH) = $2 + \\varphi$。\n\n**3. 推导每净同化一个 $\\mathrm{CO}_2$ 所需的 ATP 成本**\n\n所求的量是消耗的总 ATP 除以净同化的 $\\mathrm{CO}_2$。我们将其记为 $\\Gamma_{ATP}$。\n$$ \\Gamma_{ATP} = \\frac{\\text{消耗的总 ATP}}{\\text{净同化的 } \\mathrm{CO}_2} $$\n净同化的 $\\mathrm{CO}_2$ 是净释放的 $\\mathrm{CO}_2$ 的负值。根据第2部分：\n每个羧化事件净同化的 $\\mathrm{CO}_2$ = $-(\\frac{\\varphi}{2} - 1) = 1 - \\frac{\\varphi}{2}$。\n每个羧化事件消耗的总 ATP 已求得为 $3\\left(1 + \\frac{\\varphi}{2}\\right)$。\n\n因此，$\\Gamma_{ATP}$ 作为 $\\varphi$ 的函数的闭式表达式为：\n$$ \\Gamma_{ATP}(\\varphi) = \\frac{3\\left(1 + \\frac{\\varphi}{2}\\right)}{1 - \\frac{\\varphi}{2}} $$\n该表达式可以通过分子和分母同乘以 $2$ 来简化：\n$$ \\Gamma_{ATP}(\\varphi) = \\frac{3(2 + \\varphi)}{2 - \\varphi} $$\n现在，我们使用第1部分中推导出的值 $\\varphi = \\frac{15}{52}$ 对该表达式进行数值计算。\n$$ \\Gamma_{ATP} = \\frac{3\\left(2 + \\frac{15}{52}\\right)}{2 - \\frac{15}{52}} $$\n首先，计算括号中的项：\n$$ 2 + \\frac{15}{52} = \\frac{104}{52} + \\frac{15}{52} = \\frac{119}{52} $$\n$$ 2 - \\frac{15}{52} = \\frac{104}{52} - \\frac{15}{52} = \\frac{89}{52} $$\n将这些结果代回 $\\Gamma_{ATP}$ 的表达式中：\n$$ \\Gamma_{ATP} = \\frac{3\\left(\\frac{119}{52}\\right)}{\\frac{89}{52}} = 3 \\times \\frac{119}{89} = \\frac{357}{89} $$\n为得到最终的数值答案，我们进行除法运算，并按要求四舍五入到四位有效数字。\n$$ \\Gamma_{ATP} = \\frac{357}{89} \\approx 4.011235955... $$\n四舍五入到四位有效数字得到 $4.011$。这是在给定条件下，每净同化一个 $\\mathrm{CO}_2$ 分子所需的 ATP 分子数。", "answer": "$$ \\boxed{4.011} $$", "id": "2548096"}, {"introduction": "从单个过程的化学计量学转向系统层面的视角，本练习将介绍流平衡分析（FBA）作为一种预测代谢能力的强大计算框架。你将为在相同的基本培养基上生长的自养和异养生物构建并求解简化的FBA模型。这一实践为这两种核心生命策略如何受到不同资源限制提供了一个清晰的定量比较，揭示了代谢网络设计的基本逻辑。[@problem_id:2548056]", "problem": "要求您通过线性规划，形式化并求解两个简化的通量平衡分析模型，这两个模型在相同的基本培养基上比较自养和异养生长，旨在分离碳源和能源的作用。目标是计算生长速率的差异，并识别限制生长的活性约束。\n\n使用的基本原理：\n- 通量平衡分析 (FBA) 的核心定义：在稳态下，细胞内代谢物平衡由线性系统 $S \\, \\mathbf{v} = \\mathbf{0}$ 表示，其中 $S$ 是化学计量矩阵，$\\mathbf{v}$ 是反应通量向量，所有通量均满足边界约束。生长被建模为一个生物质生产反应，其通量在这些约束条件下被最大化。\n- 关于自养与异养的成熟理论：自养生物同化无机碳（此处为二氧化碳），而异养生物同化有机碳（此处为乙酸盐）。生物合成需要三磷酸腺苷（ATP）。在这个简化设定中，自养生物从光照中获得 ATP，而异养生物通过分子氧氧化乙酸盐来制造 ATP。\n\n您必须用以下的化学计量矩阵和边界来实现两个模型。除非另有说明，所有通量都约束为非负（$0 \\le v_i \\le \\text{upper bound}_i$）。每个模型的目标都是最大化生物质通量。\n\n模型 A（自养：碳来自二氧化碳，能量来自光）：\n- 代谢物（$S_{\\text{auto}}$ 的行）：$[\\text{CO}_2,\\ \\text{NH}_4^+,\\ \\text{PO}_4^{3-},\\ \\text{ATP}]$。\n- 反应（$S_{\\text{auto}}$ 的列）及其化学计量：\n  1. $\\text{CO}_2$ 摄取：$\\varnothing \\to \\text{CO}_2$，通量为 $v_1$，上界为 $U_{\\text{CO2}}$。\n  2. $\\text{NH}_4^+$ 摄取：$\\varnothing \\to \\text{NH}_4^+$，通量为 $v_2$，上界为 $U_{\\text{NH4}}$。\n  3. $\\text{PO}_4^{3-}$ 摄取：$\\varnothing \\to \\text{PO}_4^{3-}$，通量为 $v_3$，上界为 $U_{\\text{PO4}}$。\n  4. 光能合成 ATP：$\\text{light} \\to \\text{ATP}$，通量为 $v_4$，上界为 $U_{\\text{light}}$。\n  5. 生物质形成（自养）：$\\text{CO}_2 + 0.2\\,\\text{NH}_4^+ + 0.1\\,\\text{PO}_4^{3-} + 10\\,\\text{ATP} \\to \\text{biomass}$，通量为 $v_5$，无有限上界。\n- 矩阵形式，行序为 $[\\text{CO}_2,\\ \\text{NH}_4^+,\\ \\text{PO}_4^{3-},\\ \\text{ATP}]$，列序为 $[v_1,\\ v_2,\\ v_3,\\ v_4,\\ v_5]$：\n$$\nS_{\\text{auto}}=\n\\begin{bmatrix}\n1 & 0 & 0 & 0 & -1 \\\\\n0 & 1 & 0 & 0 & -0.2 \\\\\n0 & 0 & 1 & 0 & -0.1 \\\\\n0 & 0 & 0 & 1 & -10\n\\end{bmatrix}.\n$$\n- 目标：在 $S_{\\text{auto}} \\mathbf{v} = \\mathbf{0}$ 和 $0 \\le v_1 \\le U_{\\text{CO2}}$, $0 \\le v_2 \\le U_{\\text{NH4}}$, $0 \\le v_3 \\le U_{\\text{PO4}}$, $0 \\le v_4 \\le U_{\\text{light}}$, $v_5 \\ge 0$ 约束下最大化 $v_5$。\n\n模型 B（异养：碳和能量来自乙酸盐，利用氧气进行呼吸作用）：\n- 代谢物（$S_{\\text{het}}$ 的行）：$[\\text{Ac},\\ \\text{O}_2,\\ \\text{NH}_4^+,\\ \\text{PO}_4^{3-},\\ \\text{ATP},\\ \\text{CO}_2]$。\n- 反应（$S_{\\text{het}}$ 的列）及其化学计量：\n  1. 乙酸盐摄取：$\\varnothing \\to \\text{Ac}$，通量为 $w_1$，上界为 $U_{\\text{Ac}}$。\n  2. 氧气摄取：$\\varnothing \\to \\text{O}_2$，通量为 $w_2$，上界为 $U_{\\text{O2}}$。\n  3. $\\text{NH}_4^+$ 摄取：$\\varnothing \\to \\text{NH}_4^+$，通量为 $w_3$，上界为 $U_{\\text{NH4}}$。\n  4. $\\text{PO}_4^{3-}$ 摄取：$\\varnothing \\to \\text{PO}_4^{3-}$，通量为 $w_4$，上界为 $U_{\\text{PO4}}$。\n  5. 乙酸盐氧化生成 ATP：$\\text{Ac} + 2\\,\\text{O}_2 \\to 10\\,\\text{ATP} + 2\\,\\text{CO}_2$，通量为 $w_5$，无有限上界。\n  6. $\\text{CO}_2$ 输出：$\\text{CO}_2 \\to \\varnothing$，通量为 $w_6$，无有限上界。\n  7. 生物质形成（异养）：$0.5\\,\\text{Ac} + 0.2\\,\\text{NH}_4^+ + 0.1\\,\\text{PO}_4^{3-} + 10\\,\\text{ATP} \\to \\text{biomass}$，通量为 $w_7$，无有限上界。\n- 矩阵形式，行序为 $[\\text{Ac},\\ \\text{O}_2,\\ \\text{NH}_4^+,\\ \\text{PO}_4^{3-},\\ \\text{ATP},\\ \\text{CO}_2]$，列序为 $[w_1,\\ w_2,\\ w_3,\\ w_4,\\ w_5,\\ w_6,\\ w_7]$：\n$$\nS_{\\text{het}}=\n\\begin{bmatrix}\n1 & 0 & 0 & 0 & -1 & 0 & -0.5 \\\\\n0 & 1 & 0 & 0 & -2 & 0 & 0 \\\\\n0 & 0 & 1 & 0 & 0 & 0 & -0.2 \\\\\n0 & 0 & 0 & 1 & 0 & 0 & -0.1 \\\\\n0 & 0 & 0 & 0 & 10 & 0 & -10 \\\\\n0 & 0 & 0 & 0 & 2 & -1 & 0\n\\end{bmatrix}.\n$$\n- 目标：在 $S_{\\text{het}} \\mathbf{w} = \\mathbf{0}$ 和 $0 \\le w_1 \\le U_{\\text{Ac}}$, $0 \\le w_2 \\le U_{\\text{O2}}$, $0 \\le w_3 \\le U_{\\text{NH4}}$, $0 \\le w_4 \\le U_{\\text{PO4}}$, $w_5, w_6, w_7 \\ge 0$（无有限上界）约束下最大化 $w_7$。\n\n程序中需要完成的任务：\n1. 对于下面测试套件中的每一组参数，求解两个线性规划问题，以获得最优生物质通量 $v_5^\\star$（自养）和 $w_7^\\star$（异养）。\n2. 对于每个模型，通过检查在最优点处哪个资源摄取（或光）边界是紧的（即达到上界），从以下各项中识别一个限制性约束：\n   - 自养模型限制代码：\n     - $1$: $\\text{CO}_2$ 摄取边界 $U_{\\text{CO2}}$ 是活性约束。\n     - $2$: 光能合成 ATP 边界 $U_{\\text{light}}$ 是活性约束。\n     - $3$: $\\text{NH}_4^+$ 摄取边界 $U_{\\text{NH4}}$ 是活性约束。\n     - $4$: $\\text{PO}_4^{3-}$ 摄取边界 $U_{\\text{PO4}}$ 是活性约束。\n   - 异养模型限制代码：\n     - $1$: 乙酸盐摄取边界 $U_{\\text{Ac}}$ 是活性约束。\n     - $2$: 氧气摄取边界 $U_{\\text{O2}}$ 是活性约束。\n     - $3$: $\\text{NH}_4^+$ 摄取边界 $U_{\\text{NH4}}$ 是活性约束。\n     - $4$: $\\text{PO}_4^{3-}$ 摄取边界 $U_{\\text{PO4}}$ 是活性约束。\n   如果多个边界同时达到上界，则按上述顺序选择最小的代码。如果在 $10^{-9}$ 的数值容差内没有边界达到上界，则在该测试案例中为该模型返回代码 $0$。\n\n3. 将最终输出构建为单行文本：一个顶层列表，每个测试案例对应一个子列表。每个子列表必须严格包含四个条目，顺序为 $[v_5^\\star,\\ w_7^\\star,\\ \\text{auto\\_code},\\ \\text{hetero\\_code}]$。使用标准十进制表示法表示数字。\n\n单位：将所有通量视为任意一致的单位/单位时间；您必须将生长通量输出为无单位的数值浮点数（无单位字符串）。\n\n测试套件（每个元组为 $(U_{\\text{CO2}},\\ U_{\\text{Ac}},\\ U_{\\text{O2}},\\ U_{\\text{NH4}},\\ U_{\\text{PO4}},\\ U_{\\text{light}})$）：\n- 案例 $1$：$(10,\\ 5,\\ 20,\\ 10,\\ 10,\\ 100)$。\n- 案例 $2$：$(10,\\ 5,\\ 20,\\ 10,\\ 10,\\ 5)$。\n- 案例 $3$：$(10,\\ 0.5,\\ 20,\\ 10,\\ 10,\\ 100)$。\n- 案例 $4$：$(100,\\ 100,\\ 100,\\ 0.1,\\ 100,\\ 1000)$。\n- 案例 $5$：$(0.2,\\ 10,\\ 1,\\ 10,\\ 10,\\ 1000)$。\n\n您的程序应生成单行输出，其中包含一个以逗号分隔、无空格的子列表列表形式的结果，例如：\n\"[[g_auto1,g_hetero1,lim_auto_code1,lim_hetero_code1],[g_auto2,g_hetero2,lim_auto_code2,lim_hetero_code2],...]\"", "solution": "问题陈述已经过严格验证，被认为是有效的。它具有科学依据，是良定且客观的。它提出了一个标准的通量平衡分析（FBA）练习，尽管有所简化，但被形式化为两个可解的线性规划问题。我们将提供完整的解决方案。\n\n任务是确定自养和异养两种代谢模型，在不同营养和能量限制下的最大生长通量。这需要为每组给定的参数求解两个线性规划（LP）问题。\n\n在稳态下，细胞内代谢物的浓度是恒定的。该条件由线性系统 $S \\mathbf{v} = \\mathbf{0}$ 表示，其中 $S$ 是一个 $m \\times n$ 的化学计量矩阵，对应 $m$ 种代谢物和 $n$ 个反应，$\\mathbf{v}$ 是一个 $n \\times 1$ 的反应通量向量。目标是在稳态约束以及每个通量的上下界 $v_i^{\\text{min}} \\le v_i \\le v_i^{\\text{max}}$ 条件下，最大化某个特定通量（通常是生物质形成）。\n\n**模型 A：自养**\n\n自养生物的 FBA 问题是在 $S_{\\text{auto}}\\mathbf{v} = \\mathbf{0}$ 和给定的通量边界约束下，最大化 $v_5$。化学计量矩阵为：\n$$\nS_{\\text{auto}}=\n\\begin{bmatrix}\n1 & 0 & 0 & 0 & -1 \\\\\n0 & 1 & 0 & 0 & -0.2 \\\\\n0 & 0 & 1 & 0 & -0.1 \\\\\n0 & 0 & 0 & 1 & -10\n\\end{bmatrix}\n$$\n稳态条件 $S_{\\text{auto}}\\mathbf{v} = \\mathbf{0}$ 转化为以下线性方程组，其中 $\\mathbf{v} = [v_1, v_2, v_3, v_4, v_5]^T$：\n1. $v_1 - v_5 = 0 \\implies v_1 = v_5$\n2. $v_2 - 0.2 v_5 = 0 \\implies v_2 = 0.2 v_5$\n3. $v_3 - 0.1 v_5 = 0 \\implies v_3 = 0.1 v_5$\n4. $v_4 - 10 v_5 = 0 \\implies v_4 = 10 v_5$\n\n所有通量都与生物质通量 $v_5$ 成正比。为了最大化 $v_5$，我们必须考虑摄取通量 $v_1, v_2, v_3, v_4$ 的上界：\n- $v_1 \\le U_{\\text{CO2}} \\implies v_5 \\le U_{\\text{CO2}}$\n- $v_2 \\le U_{\\text{NH4}} \\implies 0.2 v_5 \\le U_{\\text{NH4}} \\implies v_5 \\le 5 U_{\\text{NH4}}$\n- $v_3 \\le U_{\\text{PO4}} \\implies 0.1 v_5 \\le U_{\\text{PO4}} \\implies v_5 \\le 10 U_{\\text{PO4}}$\n- $v_4 \\le U_{\\text{light}} \\implies 10 v_5 \\le U_{\\text{light}} \\implies v_5 \\le \\frac{U_{\\text{light}}}{10}$\n\n由于所有这些条件都必须满足，最大生物质通量 $v_5^\\star$ 是这些推导出的上界中的最小值：\n$$\nv_5^\\star = \\min\\left( U_{\\text{CO2}}, 5 U_{\\text{NH4}}, 10 U_{\\text{PO4}}, \\frac{U_{\\text{light}}}{10} \\right)\n$$\n\n**模型 B：异养**\n\n异养生物的 FBA 问题是在 $S_{\\text{het}}\\mathbf{w} = \\mathbf{0}$ 和通量边界约束下，最大化 $w_7$。化学计量矩阵为：\n$$\nS_{\\text{het}}=\n\\begin{bmatrix}\n1 & 0 & 0 & 0 & -1 & 0 & -0.5 \\\\\n0 & 1 & 0 & 0 & -2 & 0 & 0 \\\\\n0 & 0 & 1 & 0 & 0 & 0 & -0.2 \\\\\n0 & 0 & 0 & 1 & 0 & 0 & -0.1 \\\\\n0 & 0 & 0 & 0 & 10 & 0 & -10 \\\\\n0 & 0 & 0 & 0 & 2 & -1 & 0\n\\end{bmatrix}\n$$\n稳态条件 $S_{\\text{het}}\\mathbf{w} = \\mathbf{0}$ 对于 $\\mathbf{w} = [w_1, w_2, w_3, w_4, w_5, w_6, w_7]^T$ 产生以下方程：\n1. $w_1 - w_5 - 0.5 w_7 = 0$\n2. $w_2 - 2 w_5 = 0 \\implies w_2 = 2 w_5$\n3. $w_3 - 0.2 w_7 = 0 \\implies w_3 = 0.2 w_7$\n4. $w_4 - 0.1 w_7 = 0 \\implies w_4 = 0.1 w_7$\n5. $10 w_5 - 10 w_7 = 0 \\implies w_5 = w_7$\n6. $2 w_5 - w_6 = 0 \\implies w_6 = 2 w_5$\n\n根据ATP平衡（方程5），ATP生成通量（$w_5$）等于生物质合成通量（$w_7$）。将 $w_5 = w_7$ 代入其他方程，我们可以用 $w_7$ 来表示所有其他通量：\n- $w_1_ = w_7 + 0.5 w_7 = 1.5 w_7$\n- $w_2 = 2 w_7$\n- $w_3 = 0.2 w_7$\n- $w_4 = 0.1 w_7$\n- $w_6 = 2 w_7$\n\n利用摄取通量 $w_1, w_2, w_3, w_4$ 的上界：\n- $w_1 \\le U_{\\text{Ac}} \\implies 1.5 w_7 \\le U_{\\text{Ac}} \\implies w_7 \\le \\frac{U_{\\text{Ac}}}{1.5}$\n- $w_2 \\le U_{\\text{O2}} \\implies 2 w_7 \\le U_{\\text{O2}} \\implies w_7 \\le \\frac{U_{\\text{O2}}}{2}$\n- $w_3 \\le U_{\\text{NH4}} \\implies 0.2 w_7 \\le U_{\\text{NH4}} \\implies w_7 \\le 5 U_{\\text{NH4}}$\n- $w_4 \\le U_{\\text{PO4}} \\implies 0.1 w_7 \\le U_{\\text{PO4}} \\implies w_7 \\le 10 U_{\\text{PO4}}$\n\n因此，最大生物质通量 $w_7^\\star$ 为：\n$$\nw_7^\\star = \\min\\left( \\frac{U_{\\text{Ac}}}{1.5}, \\frac{U_{\\text{O2}}}{2}, 5 U_{\\text{NH4}}, 10 U_{\\text{PO4}} \\right)\n$$\n\n**计算实现**\n\n虽然这些简单模型允许解析解，但我们将按要求使用数值线性规划求解器来实现求解，这是一种适用于更复杂FBA模型的通用方法。我们使用 `scipy.optimize.linprog`。对于每个模型，问题都将转换为线性规划的标准型：最小化 $\\mathbf{c}^T \\mathbf{x}$，约束条件为 $A_{eq} \\mathbf{x} = \\mathbf{b}_{eq}$ 和 $\\mathbf{x}_{\\text{min}} \\le \\mathbf{x} \\le \\mathbf{x}_{\\text{max}}$。\n\n对于自养模型，我们最小化 $-v_5$，因此目标向量为 $\\mathbf{c} = [0, 0, 0, 0, -1]^T$。等式约束由 $A_{eq} = S_{\\text{auto}}$ 和 $\\mathbf{b}_{eq} = \\mathbf{0}$ 给出。边界为 $[(0, U_{\\text{CO2}}), (0, U_{\\text{NH4}}), (0, U_{\\text{PO4}}), (0, U_{\\text{light}}), (0, \\infty)]$。\n\n对于异养模型，我们最小化 $-w_7$，因此 $\\mathbf{c} = [0, 0, 0, 0, 0, 0, -1]^T$。等式约束为 $A_{eq} = S_{\\text{het}}$ 和 $\\mathbf{b}_{eq} = \\mathbf{0}$。边界为 $[(0, U_{\\text{Ac}}), (0, U_{\\text{O2}}), (0, U_{\\text{NH4}}), (0, U_{\\text{PO4}}), (0, \\infty), (0, \\infty), (0, \\infty)]$。\n\n在为每个模型求解出最优通量向量后，我们识别限制性约束。如果对应的摄取通量与其上界的差值在 $10^{-9}$ 的容差范围内，则该约束被认为是活性的。如果多个约束是活性的，则报告具有最小指定代码的那个。\n- 自养模型摄取通量：$v_1$ (CO2), $v_4$ (光), $v_2$ (NH4), $v_3$ (PO4)。它们的代号分别为 $1, 2, 3, 4$。\n- 异养模型摄取通量：$w_1$ (Ac), $w_2$ (O2), $w_3$ (NH4), $w_4$ (PO4)。它们的代号分别为 $1, 2, 3, 4$。\n\n程序将遍历每个测试案例，求解两个 LP 问题，确定限制性约束，并按指定格式化输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Formalizes and solves two simplified flux balance analysis models\n    for autotrophic and heterotrophic growth, calculating maximal growth rates\n    and identifying limiting constraints for a suite of test cases.\n    \"\"\"\n    \n    # Stoichiometric matrices and other fixed model parameters\n    S_auto = np.array([\n        [1, 0, 0, 0, -1],\n        [0, 1, 0, 0, -0.2],\n        [0, 0, 1, 0, -0.1],\n        [0, 0, 0, 1, -10]\n    ])\n\n    S_het = np.array([\n        [1, 0, 0, 0, -1, 0, -0.5],\n        [0, 1, 0, 0, -2, 0, 0],\n        [0, 0, 1, 0, 0, 0, -0.2],\n        [0, 0, 0, 1, 0, 0, -0.1],\n        [0, 0, 0, 0, 10, 0, -10],\n        [0, 0, 0, 0, 2, -1, 0]\n    ])\n\n    c_auto = np.array([0, 0, 0, 0, -1])\n    b_eq_auto = np.zeros(S_auto.shape[0])\n\n    c_het = np.array([0, 0, 0, 0, 0, 0, -1])\n    b_eq_het = np.zeros(S_het.shape[0])\n\n    # Numerical tolerance for checking if a constraint is binding\n    TOL = 1e-9\n\n    def solve_autotroph(U_co2, U_nh4, U_po4, U_light):\n        bounds = [\n            (0, U_co2),\n            (0, U_nh4),\n            (0, U_po4),\n            (0, U_light),\n            (0, None)\n        ]\n        \n        res = linprog(c=c_auto, A_eq=S_auto, b_eq=b_eq_auto, bounds=bounds, method='highs')\n        \n        if not res.success:\n            return 0.0, 0\n        \n        v_star = res.x\n        v5_star = v_star[4]\n        \n        # Identify limiting constraint\n        binding_codes = []\n        # Order of checks matters for tie-breaking\n        if abs(v_star[0] - U_co2) < TOL:\n            binding_codes.append(1)\n        if abs(v_star[3] - U_light) < TOL:\n            binding_codes.append(2)\n        if abs(v_star[1] - U_nh4) < TOL:\n            binding_codes.append(3)\n        if abs(v_star[2] - U_po4) < TOL:\n            binding_codes.append(4)\n            \n        auto_code = min(binding_codes) if binding_codes else 0\n        \n        return v5_star, auto_code\n\n    def solve_heterotroph(U_ac, U_o2, U_nh4, U_po4):\n        bounds = [\n            (0, U_ac),\n            (0, U_o2),\n            (0, U_nh4),\n            (0, U_po4),\n            (0, None),\n            (0, None),\n            (0, None)\n        ]\n        \n        res = linprog(c=c_het, A_eq=S_het, b_eq=b_eq_het, bounds=bounds, method='highs')\n        \n        if not res.success:\n            return 0.0, 0\n            \n        w_star = res.x\n        w7_star = w_star[6]\n        \n        # Identify limiting constraint\n        binding_codes = []\n        # Order of checks matters for tie-breaking\n        if abs(w_star[0] - U_ac) < TOL:\n            binding_codes.append(1)\n        if abs(w_star[1] - U_o2) < TOL:\n            binding_codes.append(2)\n        if abs(w_star[2] - U_nh4) < TOL:\n            binding_codes.append(3)\n        if abs(w_star[3] - U_po4) < TOL:\n            binding_codes.append(4)\n            \n        hetero_code = min(binding_codes) if binding_codes else 0\n        \n        return w7_star, hetero_code\n\n    test_cases = [\n        # (U_CO2, U_Ac, U_O2, U_NH4, U_PO4, U_light)\n        (10, 5, 20, 10, 10, 100),\n        (10, 5, 20, 10, 10, 5),\n        (10, 0.5, 20, 10, 10, 100),\n        (100, 100, 100, 0.1, 100, 1000),\n        (0.2, 10, 1, 10, 10, 1000)\n    ]\n\n    results = []\n    for case in test_cases:\n        U_co2, U_ac, U_o2, U_nh4, U_po4, U_light = case\n        \n        v5_star, auto_code = solve_autotroph(U_co2, U_nh4, U_po4, U_light)\n        w7_star, hetero_code = solve_heterotroph(U_ac, U_o2, U_nh4, U_po4)\n        \n        results.append(f\"[{v5_star},{w7_star},{auto_code},{hetero_code}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2548056"}]}