{"hands_on_practices": [{"introduction": "表型分类学根据总体相似性对生物进行分组，这需要一种量化分类单元间“距离”的方法。当处理混合类型数据（如连续的形态测量值、有序的等级和二元的有无状态）时，像高尔距离（Gower's distance）这样的通用度量标准至关重要。本练习将通过计算该距离提供实践经验，这是数值分类学中的一项基本技能，有助于理解不同类型的数据如何被标准化和加权以进行综合比较 [@problem_id:2554427]。", "problem": "在比较动物学和植物学的表型系统学中，总体相似性是在不预设共同祖先的情况下，对异质性状进行量化。当样本由混合类型性状——连续形态计量值、有序评分、二元存在或缺失——描述时，一个可解释的相异性度量应尊重性状尺度，允许合理的性状加权，并恰当处理存在或缺失状态的非对称信息含量。从以下基本要求出发：两个分类单元之间的表型相异性应为闭区间 $\\left[0,1\\right]$ 内逐性状标准化相异性的平均值；连续测量值应通过极差标准化实现线性重缩放下的尺度不变性；有序性状应根据其等级顺序而非标签进行比较；对于非对称二元状态，共同缺失不应与共同存在具有相同的证据权重。请基于这些要求，为使用 Gower 型相异性提供理由，并推导其适用于此混合数据情景的加权形式。您的推导必须明确说明如何使用权重组合逐性状相异性，以及如何通过逐性状包含指示符排除无信息量的比较。\n\n给定三个分类单元，记为 $T_{1}$、$T_{2}$ 和 $T_{3}$，每个单元由四个性状描述：\n- 连续形态计量学：叶长（厘米）：$T_{1} = 5.2$, $T_{2} = 7.1$, $T_{3} = 6.0$。\n- 有序形态学：刺密度，分为三个等级 $\\{\\text{Low}, \\text{Medium}, \\text{High}\\}$，编码为等级 $\\{1,2,3\\}$：$T_{1} = 1$ (低), $T_{2} = 3$ (高), $T_{3} = 2$ (中)。\n- 对称二元生态学：昼行性（$1$ 表示昼行，$0$ 表示夜行）：$T_{1} = 1$, $T_{2} = 1$, $T_{3} = 0$。\n- 非对称二元化学：生物碱存在（$1$ 表示存在，$0$ 表示缺失），此项被视为非对称，因此对于该性状，共同缺失的比较应被排除：$T_{1} = 0$, $T_{2} = 1$, $T_{3} = 0$。\n\n使用以下非负性状权重，这些权重反映了测量的可靠性和预期的进化不稳定性：连续形态计量权重 $w_{c} = 0.4$，有序形态学权重 $w_{o} = 0.3$，对称二元权重 $w_{b} = 0.2$，非对称二元权重 $w_{a} = 0.1$。\n\n任务：\n- 从上述基本原则出发，论证选择 Gower 型相异性的合理性，并为这四种性状推导加权的配对相异性，明确指定每种数据类型的逐性状相异性函数，以及在归一化中排除无信息量的非对称二元共同缺失的规则。\n- 计算 $T_{1}$、$T_{2}$ 和 $T_{3}$ 之间的所有三个配对相异性，以构建完整的 $3 \\times 3$ 相异性矩阵（对角线为零）。\n- 仅报告 $T_{1}$ 和 $T_{3}$ 之间的相异性作为您的最终答案。将此最终相异性表示为一个四舍五入到四位有效数字的无单位数。", "solution": "所述问题具有科学依据，提法明确且客观。它提出了一个数量分类学中的标准任务：为包含混合性状类型的数据集计算表型相异性矩阵。为相异性度量提供的原则是 Gower 通用相异性系数的定义性公理。数据、权重和目标都以足够的精度被指定，从而能够得出一个唯一且可验证的解。因此，该问题是有效的，我们可以进行推导和计算。\n\n目标是为混合数据类型构建一个广义相异性度量，并将其应用于给定的分类单元。基本要求是，两个分类单元 $T_i$ 和 $T_j$ 之间的总相异性 $D(T_i, T_j)$ 是所有 $p$ 个性状的逐性状相异性 $d_{ijk}$ 的加权平均值。每个 $d_{ijk}$ 都必须被标准化到闭区间 $[0,1]$ 内。这由 Gower 相异性的通用公式表示：\n$$\nD(T_i, T_j) = \\frac{\\sum_{k=1}^{p} \\delta_{ijk} w_k d_{ijk}}{\\sum_{k=1}^{p} \\delta_{ijk} w_k}\n$$\n此处，$k$ 是性状的索引，从 $k=1$ 到 $p=4$。$w_k$ 项代表用户为性状 $k$ 定义的权重。$d_{ijk}$ 项是分类单元 $i$ 和 $j$ 之间性状 $k$ 的相异性得分。关键部分是指示变量 $\\delta_{ijk}$，如果分类单元 $i$ 和 $j$ 之间关于性状 $k$ 的比较是有效且有信息量的，则其值为 $1$，否则为 $0$。该指示符对于处理缺失数据，或如本问题中，对于排除无信息量的比较（例如非对称二元性状的共同缺失）至关重要。\n\n现在，我们将根据问题中阐述的原则，为四种性状类型中的每一种定义 $d_{ijk}$ 和 $\\delta_{ijk}$ 的具体形式。\n\n1.  **连续形态计量性状 ($k=c$): 叶长**\n    原则是通过极差标准化实现尺度不变性。对于一个连续性状测量值 $x_k$，值 $x_{ic}$ 和 $x_{jc}$ 之间的相异性 $d_{ijc}$ 是这两个值的绝对差除以数据集中该性状的总极差 $R_c$。\n    $$\n    d_{ijc} = \\frac{|x_{ic} - x_{jc}|}{R_c}\n    $$\n    其中 $R_c = \\max_h(x_{hc}) - \\min_h(x_{hc})$。对于给定的分类单元，叶长分别为 $5.2$、$7.1$ 和 $6.0$。极差是 $R_c = 7.1 - 5.2 = 1.9$。对于此类性状，比较始终有效，因此 $\\delta_{ijc} = 1$。给定的权重是 $w_c = 0.4$。\n\n2.  **有序形态学性状 ($k=o$): 刺密度**\n    原则是基于等级顺序进行比较。该性状有 $M_o = 3$ 个等级，编码为 $\\{1, 2, 3\\}$。为将相异性标准化到 $[0,1]$ 区间，我们将等级的绝对差除以最大可能的等级差，即 $M_o - 1$。\n    $$\n    d_{ijo} = \\frac{|r_{io} - r_{jo}|}{M_o - 1}\n    $$\n    对于等级 $r_{io}$ 和 $r_{jo}$，当 $M_o=3$ 时，公式变为 $d_{ijo} = \\frac{|r_{io} - r_{jo}|}{2}$。比较始终有效，因此 $\\delta_{ijo} = 1$。权重为 $w_o = 0.3$。\n\n3.  **对称二元性状 ($k=b$): 昼行性**\n    对于对称二元性状，两种状态（$0$ 和 $1$）携带相同的信息。匹配（$0-0$ 或 $1-1$）对相异性的贡献为 $0$，而不匹配（$0-1$ 或 $1-0$）的贡献为 $1$。\n    $$\n    d_{ijb} = \\begin{cases} 0 & \\text{if } x_{ib} = x_{jb} \\\\ 1 & \\text{if } x_{ib} \\neq x_{jb} \\end{cases}\n    $$\n    这是简单匹配相异性。比较始终有效，因此 $\\delta_{ijb} = 1$。权重为 $w_b = 0.2$。\n\n4.  **非对称二元性状 ($k=a$): 生物碱存在**\n    此处的原则是，共同存在（$1-1$）是有信息量的，但共同缺失（$0-0$）则不是。这就需要使用指示符 $\\delta_{ija}$。不匹配（$0-1$ 或 $1-0$）表示相异性为 $1$。共同存在（$1-1$）表示相似，因此相异性为 $0$。\n    $$\n    d_{ija} = \\begin{cases} 0 & \\text{if } x_{ia} = 1 \\text{ and } x_{ja} = 1 \\\\ 1 & \\text{if } x_{ia} \\neq x_{ja} \\end{cases}\n    $$\n    指示符 $\\delta_{ija}$ 的定义是为了排除共同缺失这种无信息量的情况：\n    $$\n    \\delta_{ija} = \\begin{cases} 0 & \\text{if } x_{ia} = 0 \\text{ and } x_{ja} = 0 \\\\ 1 & \\text{otherwise} \\end{cases}\n    $$\n    权重为 $w_a = 0.1$。\n\n现在，我们计算所需的配对相异性 $D(T_1, T_3)$。\n分类单元 $T_1$ 和 $T_3$ 的数据如下：\n- $T_1$: $x_{1c}=5.2$, $r_{1o}=1$, $x_{1b}=1$, $x_{1a}=0$.\n- $T_3$: $x_{3c}=6.0$, $r_{3o}=2$, $x_{3b}=0$, $x_{3a}=0$.\n\n我们计算配对 $(T_1, T_3)$ 的每个性状的加权相异性。\n\n- **连续型 ($k=c$)**:\n    $d_{13c} = \\frac{|5.2 - 6.0|}{1.9} = \\frac{0.8}{1.9}$。\n    $\\delta_{13c} = 1$。\n    对分子的贡献： $\\delta_{13c} w_c d_{13c} = 1 \\times 0.4 \\times \\frac{0.8}{1.9} = \\frac{0.32}{1.9}$。\n\n- **有序型 ($k=o$)**:\n    $d_{13o} = \\frac{|1 - 2|}{3 - 1} = \\frac{1}{2} = 0.5$。\n    $\\delta_{13o} = 1$。\n    对分子的贡献： $\\delta_{13o} w_o d_{13o} = 1 \\times 0.3 \\times 0.5 = 0.15$。\n\n- **对称二元型 ($k=b$)**:\n    $x_{1b} = 1$ 且 $x_{3b} = 0$，所以这是一个不匹配。\n    $d_{13b} = 1$。\n    $\\delta_{13b} = 1$。\n    对分子的贡献： $\\delta_{13b} w_b d_{13b} = 1 \\times 0.2 \\times 1 = 0.2$。\n\n- **非对称二元型 ($k=a$)**:\n    $x_{1a} = 0$ 且 $x_{3a} = 0$。这是一个共同缺失的情况。\n    根据我们的定义，这个比较是无信息量的。\n    $\\delta_{13a} = 0$。\n    对分子的贡献： $\\delta_{13a} w_a d_{13a} = 0 \\times 0.1 \\times d_{13a} = 0$。\n\n现在，我们将这些贡献相加，构成 $D(T_1, T_3)$ 的分子和分母。\n分子：\n$$\n\\sum_{k=1}^{4} \\delta_{13k} w_k d_{13k} = \\frac{0.32}{1.9} + 0.15 + 0.2 + 0 = \\frac{0.32}{1.9} + 0.35\n$$\n分母：\n$$\n\\sum_{k=1}^{4} \\delta_{13k} w_k = (1 \\times w_c) + (1 \\times w_o) + (1 \\times w_b) + (0 \\times w_a) = 0.4 + 0.3 + 0.2 + 0 = 0.9\n$$\n相异性为：\n$$\nD(T_1, T_3) = \\frac{\\frac{0.32}{1.9} + 0.35}{0.9} = \\frac{\\frac{0.32 + 0.35 \\times 1.9}{1.9}}{0.9} = \\frac{0.32 + 0.665}{1.9 \\times 0.9} = \\frac{0.985}{1.71}\n$$\n执行最后的除法：\n$$\nD(T_1, T_3) \\approx 0.575994152...\n$$\n题目要求将此值四舍五入到四位有效数字。\n$D(T_1, T_3) \\approx 0.5760$。\n\n为完整起见，我们指出其他配对相异性将以类似方式计算，以构成完整的相异性矩阵。\n对于 $D(T_1, T_2)$：所有的 $\\delta_{12k}=1$。$D(T_1, T_2) = (0.4 \\times \\frac{|5.2-7.1|}{1.9} + 0.3 \\times \\frac{|1-3|}{2} + 0.2 \\times 0 + 0.1 \\times 1) / (0.4+0.3+0.2+0.1) = (0.4 \\times 1 + 0.3 \\times 1 + 0 + 0.1)/1 = 0.8$。\n对于 $D(T_2, T_3)$：所有的 $\\delta_{23k}=1$。$D(T_2, T_3) = (0.4 \\times \\frac{|7.1-6.0|}{1.9} + 0.3 \\times \\frac{|3-2|}{2} + 0.2 \\times 1 + 0.1 \\times 1) / 1 = 0.4 \\times \\frac{1.1}{1.9} + 0.3 \\times 0.5 + 0.2 + 0.1 \\approx 0.2316 + 0.15 + 0.3 \\approx 0.6816$。\n\n最终要求的值仅为 $D(T_1, T_3)$。", "answer": "$$\n\\boxed{0.5760}\n$$", "id": "2554427"}, {"introduction": "与表型分类学关注总体相似性不同，支序分类学通过寻找对观察到的性状状态最简洁的解释来推断进化关系。最大简约法原则（maximum parsimony）主张，最优的进化树是使性状状态总变化次数最少的那个。本练习通过为几个竞争性的系统发育假说（拓扑结构）计算简约性得分，提供了评估和选择进化树的核心技能 [@problem_id:2554471]。", "problem": "给定四个末端分类单元，记为 $A$、$B$、$C$ 和 $D$。它们从一个中等分化程度的演化支中采样，该演化支源于一项涵盖动物学和植物学数据集的比较研究。请考虑根据这些分类单元编码的以下离散形态学性状矩阵。所有性状均被视为无序、等权重，并依据最大简约法（MP）原则进行分析。数据中无缺失值，也无多态编码。\n\n性状状态：\n- 性状 $1$：$A=0$, $B=0$, $C=1$, $D=1$。\n- 性状 $2$：$A=0$, $B=1$, $C=0$, $D=1$。\n- 性状 $3$：$A=0$, $B=1$, $C=1$, $D=0$。\n- 性状 $4$：$A=0$, $B=0$, $C=1$, $D=1$。\n- 性状 $5$：$A=1$, $B=0$, $C=0$, $D=0$。\n- 性状 $6$：$A=0$, $B=2$, $C=2$, $D=0$。\n\n假设四个分类单元的标准无根二分拓扑结构。请评估以下三种不同无根分叉树中每一种的总简约分数（所有性状所需的状态变化次数最小值之和）：\n- $T_{1}$：划分 $AB|CD$，\n- $T_{2}$：划分 $AC|BD$，\n- $T_{3}$：划分 $AD|BC$。\n\n请从第一性原理出发：运用最大简约法定义，确定每个性状在每个拓扑结构上解释末端观察状态所需的最小变化次数，然后对所有性状求和，以获得该拓扑结构的总简约分数。根据这些总分，确定最简约的一棵或多棵树。\n\n重要提示：作为最终答案，仅报告最小总简约分数，记为 $S_{\\min}$，且为一个整数。最终答案中不要包含任何拓扑结构描述。无需四舍五入。", "solution": "该问题是有效的，因为它在系统发育学领域提出了一个定义明确的问题，并为获得唯一解提供了所有必要的数据和约束。该问题在科学上基于已确立的最大简约法原则。\n\n任务是根据给定的针对 $4$ 个分类单元（$A$、$B$、$C$ 和 $D$）编码的性状矩阵，确定最小总简约分数，记为 $S_{\\min}$。分析必须考虑 $4$ 个分类单元可能存在的三种不同无根二分拓扑结构。性状被指定为无序且等权重，这要求使用 Fitch 简约算法来计算每个性状在每个拓扑结构上的演化代价（步数）。\n\n这 $3$ 种拓扑结构由其中心内部分支对分类单元造成的二分法定义：\n- $T_{1}$：此拓扑结构将 $\\{A,B\\}$ 与 $\\{C,D\\}$ 分开，记为划分 $AB|CD$。\n- $T_{2}$：此拓扑结构将 $\\{A,C\\}$ 与 $\\{B,D\\}$ 分开，记为划分 $AC|BD$。\n- $T_{3}$：此拓扑结构将 $\\{A,D\\}$ 与 $\\{B,C\\}$ 分开，记为划分 $AD|BC$。\n\n任何拓扑结构的总简约分数是解释所有性状的观察状态所需的最小性状状态变化次数之和。我们将通过计算每个性状在每个拓扑结构上的分数来继续进行。对于 $4$ 分类单元的情况，一个性状的分数可以由其状态分布模式确定：\n\n- 如果一个性状是恒定的（例如，状态为 $(0,0,0,0)$），或者只有一个分类单元拥有独特的状态（一个独征，例如，状态为 $(1,0,0,0)$），则该性状在系统发育上是无信息量的。一个恒定的性状在任何树上都需要 $0$ 步。一个独征在任何树上都恰好需要 $1$ 步，因为必须有一条分支来解释这个独特的状态变化。\n- 如果一个性状至少有两个状态，且每个状态至少出现在两个分类单元中，则该性状是简约信息性状。对于 $4$ 个分类单元，这对应于 $(x,x,y,y)$ 形式的状态模式。这样的性状在将共享相同状态的分类单元分组的拓扑结构上需要 $1$ 步，在另外两种拓扑结构上需要 $2$ 步。\n\n我们现在将此逻辑应用于所提供的 $6$ 个性状。设 $S(C_i, T_j)$ 为性状 $C_i$ 在拓扑结构 $T_j$ 上的简约分数。\n\n性状 $1$：状态为 $(A=0, B=0, C=1, D=1)$。这是一个类型为 $(0,0,1,1)$ 的简约信息模式，支持划分 $AB|CD$。\n$$S(C_1, T_1) = 1, \\quad S(C_1, T_2) = 2, \\quad S(C_1, T_3) = 2$$\n\n性状 $2$：状态为 $(A=0, B=1, C=0, D=1)$。这是一个信息模式 $(0,1,0,1)$，支持划分 $AC|BD$。\n$$S(C_2, T_1) = 2, \\quad S(C_2, T_2) = 1, \\quad S(C_2, T_3) = 2$$\n\n性状 $3$：状态为 $(A=0, B=1, C=1, D=0)$。这是一个信息模式 $(0,1,1,0)$，支持划分 $AD|BC$。\n$$S(C_3, T_1) = 2, \\quad S(C_3, T_2) = 2, \\quad S(C_3, T_3) = 1$$\n\n性状 $4$：状态为 $(A=0, B=0, C=1, D=1)$。该模式与性状 $1$ 的模式相同，支持划分 $AB|CD$。\n$$S(C_4, T_1) = 1, \\quad S(C_4, T_2) = 2, \\quad S(C_4, T_3) = 2$$\n\n性状 $5$：状态为 $(A=1, B=0, C=0, D=0)$。该模式代表了分类单元 $A$ 的一个独征，是简约非信息性状。它在任何拓扑结构上都需要 $1$ 步。\n$$S(C_5, T_1) = 1, \\quad S(C_5, T_2) = 1, \\quad S(C_5, T_3) = 1$$\n\n性状 $6$：状态为 $(A=0, B=2, C=2, D=0)$。由于性状是无序的，这是一个类型为 $(x,y,y,x)$ 的信息模式，支持划分 $AD|BC$。\n$$S(C_6, T_1) = 2, \\quad S(C_6, T_2) = 2, \\quad S(C_6, T_3) = 1$$\n\n每个拓扑结构的总简约分数 $S(T_j)$ 是各个性状分数的总和：$S(T_j) = \\sum_{i=1}^{6} S(C_i, T_j)$。\n\n拓扑结构 $T_{1}$ ($AB|CD$) 的总分：\n$$S(T_1) = 1 + 2 + 2 + 1 + 1 + 2 = 9$$\n\n拓扑结构 $T_{2}$ ($AC|BD$) 的总分：\n$$S(T_2) = 2 + 1 + 2 + 2 + 1 + 2 = 10$$\n\n拓扑结构 $T_{3}$ ($AD|BC$) 的总分：\n$$S(T_3) = 2 + 2 + 1 + 2 + 1 + 1 = 9$$\n\n比较总分，我们得到 $S(T_1)=9$，$S(T_2)=10$，和 $S(T_3)=9$。最大简约法原则倾向于具有最低分数的树。在这里，拓扑结构 $T_1$ 和 $T_3$ 是同等最简约的。最小总简约分数 $S_{\\min}$ 是这些值中的最小值。\n$$S_{\\min} = \\min(9, 10, 9) = 9$$\n这是最终要求的值。", "answer": "$$\\boxed{9}$$", "id": "2554471"}, {"introduction": "在确定最优的简约树之后，下一步是重构特定性状的进化历史，但这种重构并非总是唯一的。ACCTRAN（加速转换）和DELTRAN（延迟转换）是两种解决祖先状态不明确性的优化标准，它们会导致截然不同的进化情景（如同源与同质异形）。通过应用这两种方法，本练习揭示了对同一数据的不同解释是如何产生的，从而促使我们更深入地思考性状演化的生物学意义，例如区分单一来源后的多次丢失与多次独立获得 [@problem_id:2554461]。", "problem": "一个包含 $5$ 个末端分类单元的有根系统发育树，其拓扑结构为 $T = \\big((A,B),(C,(D,E))\\big)$，根节点位于分支 $\\big(A,B\\big)$ 和分支 $\\big(C,(D,E)\\big)$ 的分裂处。考虑一个单一的无序、等权重的二态性状，其中状态 $1$ 表示存在一个推定的衍征，状态 $0$ 表示缺失。观察到的末端状态为：$A=1$，$B=0$，$C=1$，$D=0$ 和 $E=0$。根节点的状态未被预先指定。使用最大简约法 (MP) 和 Fitch 算法计算最小步数，并分别在加速转换优化 (ACCTRAN) 和延迟转换优化 (DELTRAN) 下对变化进行优化。具体要求：\n\n- 从 MP 和针对无序二态性状的 Fitch 集合并集/交集算法的基本定义出发，在给定的有根树上进行自下而上的集合计算，以确定最小简约长度。\n- 然后，在 ACCTRAN 和 DELTRAN 下进行自上而下的重建，以确定变化的位置，同时在每种情况下都保持最小步数。\n- 对于每种优化，确定状态改变的次数（最小步数），并将每次改变分类为“获得”（$0 \\to 1$）或“逆转”（$1 \\to 0$）。\n- 从生物学角度简要解释 ACCTRAN 与 DELTRAN 如何改变推断出的演化情景（单一早期起源并伴随丢失 vs. 多次独立起源），并评论这与基于总体相似性的严格表型学观点有何不同。\n\n作为您的最终数值答案，报告 $\\Delta G = G_{\\mathrm{DELTRAN}} - G_{\\mathrm{ACCTRAN}}$ 的值，其中 $G_{\\mathrm{ACCTRAN}}$ 和 $G_{\\mathrm{DELTRAN}}$ 分别是在 ACCTRAN 和 DELTRAN 下推断出的“获得”次数。无需四舍五入。以纯数字形式提供您的最终数值答案，不带单位。", "solution": "所给问题是使用最大简约法原理进行系统发育推断的一个标准练习。该问题具有科学依据，表述清晰，并包含了在指定算法下获得唯一解所需的所有信息。我们将进行形式化分析。\n\n该问题要求在一个给定的、包含五个分类单元的有根系统发育树上分析一个单一的二态性状。其拓扑结构为 $T = \\big((A,B),(C,(D,E))\\big)$，观察到的末端性状状态为 $s_A=1$，$s_B=0$，$s_C=1$，$s_D=0$ 和 $s_E=0$。该性状是无序的，意味着从状态 $0$ 变为 $1$ 的代价与从 $1$ 变为 $0$ 的代价相同，均为一步。\n\n首先，为了清晰起见，我们必须标记树的内部节点。设 $N_1$ 是分类单元 $A$ 和 $B$ 的最近共同祖先 (MRCA)。设 $N_2$ 是 $D$ 和 $E$ 的 MRCA。设 $N_3$ 是 $C$ 和演化支 $(D,E)$ 的 MRCA。最后，设 $N_4$ 是树的根节点，即所有五个分类单元的 MRCA。树的结构因此为：\n$$\n\\text{根节点 } N_4 \\rightarrow (N_1, N_3)\n$$\n$$\nN_1 \\rightarrow (A, B)\n$$\n$$\nN_3 \\rightarrow (C, N_2)\n$$\n$$\nN_2 \\rightarrow (D, E)\n$$\n\n分析分为三个部分：首先，使用 Fitch 算法进行自下而上的遍历，以确定性状状态改变的最小次数（简约分数）；其次，根据 ACCTRAN 和 DELTRAN 优化准则进行两次自上而下的遍历，以分配具体的祖先状态；第三，根据结果进行计算。\n\n**第一部分：使用 Fitch 算法进行自下而上遍历以确定简约分数**\n\nFitch 算法从末端开始向根节点移动，确定每个内部节点的可能状态集。对于任意一个有两个后代节点 $i$ 和 $j$（其状态集分别为 $S_i$ 和 $S_j$）的节点 $k$，其状态集 $S_k$ 计算如下：\n- 若 $S_i \\cap S_j \\neq \\emptyset$，则 $S_k = S_i \\cap S_j$。此节点增加的长度（步数）为 $0$。\n- 若 $S_i \\cap S_j = \\emptyset$，则 $S_k = S_i \\cup S_j$。此节点增加的长度为 $1$。\n\n我们将此过程应用于给定的树。\n\n1.  **末端节点（叶节点）：** 状态集由观测数据确定。\n    - $S_A = \\{1\\}$\n    - $S_B = \\{0\\}$\n    - $S_C = \\{1\\}$\n    - $S_D = \\{0\\}$\n    - $S_E = \\{0\\}$\n\n2.  **内部节点 $N_2$（$D, E$ 的 MRCA）：**\n    - 其后代的状态集为 $S_D=\\{0\\}$ 和 $S_E=\\{0\\}$。\n    - $S_D \\cap S_E = \\{0\\} \\cap \\{0\\} = \\{0\\}$。交集非空。\n    - 因此，$S_{N_2} = \\{0\\}$。\n    - 长度增量：$L_{N_2} = 0$。\n\n3.  **内部节点 $N_1$（$A, B$ 的 MRCA）：**\n    - 其后代的状态集为 $S_A=\\{1\\}$ 和 $S_B=\\{0\\}$。\n    - $S_A \\cap S_B = \\{1\\} \\cap \\{0\\} = \\emptyset$。交集为空。\n    - 因此，$S_{N_1} = S_A \\cup S_B = \\{0, 1\\}$。\n    - 长度增量：$L_{N_1} = 1$。\n\n4.  **内部节点 $N_3$（$C, N_2$ 的 MRCA）：**\n    - 其后代的状态集为 $S_C=\\{1\\}$ 和 $S_{N_2}=\\{0\\}$。\n    - $S_C \\cap S_{N_2} = \\{1\\} \\cap \\{0\\} = \\emptyset$。交集为空。\n    - 因此，$S_{N_3} = S_C \\cup S_{N_2} = \\{0, 1\\}$。\n    - 长度增量：$L_{N_3} = 1$。\n\n5.  **根节点 $N_4$（$N_1, N_3$ 的 MRCA）：**\n    - 其后代的状态集为 $S_{N_1}=\\{0, 1\\}$ 和 $S_{N_3}=\\{0, 1\\}$。\n    - $S_{N_1} \\cap S_{N_3} = \\{0, 1\\} \\cap \\{0, 1\\} = \\{0, 1\\}$。交集非空。\n    - 因此，$S_{N_4} = \\{0, 1\\}$。\n    - 长度增量：$L_{N_4} = 0$。\n\n该性状的总简约分数是每个内部节点长度增量的总和：\n$$\nL_{Total} = L_{N_1} + L_{N_2} + L_{N_3} + L_{N_4} = 1 + 0 + 1 + 0 = 2\n$$\n在这棵树上解释观察到的性状分布所需的最小步数为 $2$。\n\n**第二部分：ACCTRAN 和 DELTRAN 祖先状态重建**\n\nFitch 自下而上的遍历导致节点 $N_1$、$N_3$ 和 $N_4$ 的状态集存在歧义。这意味着有多种分配祖先状态的方式可以得到相同的最小分数 $2$。ACCTRAN（加速转换）和 DELTRAN（延迟转换）是次级优化准则，它们通过提供在树上确定变化位置的规则来解决这种歧义。\n\n**ACCTRAN 优化：** ACCTRAN 倾向于让转换发生在树的更早期（更靠近根节点）。该算法偏好“单一获得后多次逆转”的演化情景，而不是“多次独立获得”的情景。它通过偏好父节点的状态来解决歧义。对于没有父节点的根节点，它实际上会选择将变化推向树的更深处的那个状态。在这种情况下，它会导出一个重建结果，该结果暗示整个演化支的状态 $1$ 是单一来源的，随后发生了丢失（逆转为状态 $0$）。\n\n-   **状态分配：** ACCTRAN 将状态 $1$ 分配给根节点 $N_4$。然后该状态向下传递。\n    - $s_{N_4} = 1$。\n    - 对于 $N_1$，其父节点状态 $s_{N_4}=1$ 存在于其集合 $S_{N_1}=\\{0, 1\\}$ 中，所以 $s_{N_1}=1$。\n    - 对于 $N_3$，其父节点状态 $s_{N_4}=1$ 存在于其集合 $S_{N_3}=\\{0, 1\\}$ 中，所以 $s_{N_3}=1$。\n    - 对于 $N_2$，其父节点状态 $s_{N_3}=1$ 不在其集合 $S_{N_2}=\\{0\\}$ 中，因此必须发生一次改变。状态必须为 $s_{N_2}=0$。\n-   **ACCTRAN 下的改变：**\n    - 从 $N_1$ 到末端 $B$ 的分支需要一次从 $s_{N_1}=1$ 到 $s_B=0$ 的改变。这是一次逆转（$1 \\to 0$）。\n    - 从 $N_3$ 到节点 $N_2$ 的分支需要一次从 $s_{N_3}=1$ 到 $s_{N_2}=0$ 的改变。这也是一次逆转（$1 \\to 0$）。\n    - 其他所有分支都不需要改变。\n-   **ACCTRAN 总结：**\n    - 总步数 = $2$。\n    - “获得”次数 ($0 \\to 1$)：$G_{\\mathrm{ACCTRAN}} = 0$。\n    - “逆转”次数 ($1 \\to 0$)：$R_{\\mathrm{ACCTRAN}} = 2$。\n    - 这种情景意味着该类群的共同祖先拥有该性状（状态 $1$），之后该性状独立地丢失了两次。\n\n**DELTRAN 优化：** DELTRAN 倾向于让转换发生在树的更晚期（更靠近末端）。该算法偏好“多次独立获得”（平行演化）的情景，而不是“单一获得后多次逆转”的情景。它通过偏好与后代节点共享的状态来解决歧义。对于根节点，它实际上会选择将变化推离根节点的那个状态。\n\n-   **状态分配：** DELTRAN 将状态 $0$ 分配给根节点 $N_4$。\n    - $s_{N_4} = 0$。\n    - 对于 $N_1$，其父节点状态 $s_{N_4}=0$ 存在于其集合 $S_{N_1}=\\{0, 1\\}$ 中，所以 $s_{N_1}=0$。\n    - 对于 $N_3$，其父节点状态 $s_{N_4}=0$ 存在于其集合 $S_{N_3}=\\{0, 1\\}$ 中，所以 $s_{N_3}=0$。\n    - 对于 $N_2$，其父节点状态 $s_{N_3}=0$ 存在于其集合 $S_{N_2}=\\{0\\}$ 中，所以 $s_{N_2}=0$。所有内部节点都被分配了状态 $0$。\n-   **DELTRAN 下的改变：**\n    - 从 $N_1$ 到末端 $A$ 的分支需要一次从 $s_{N_1}=0$ 到 $s_A=1$ 的改变。这是一次“获得”（$0 \\to 1$）。\n    - 从 $N_3$ 到末端 $C$ 的分支需要一次从 $s_{N_3}=0$ 到 $s_C=1$ 的改变。这也是一次“获得”（$0 \\to 1$）。\n    - 其他所有分支都不需要改变。\n-   **DELTRAN 总结：**\n    - 总步数 = $2$。\n    - “获得”次数 ($0 \\to 1$)：$G_{\\mathrm{DELTRAN}} = 2$。\n    - “逆转”次数 ($1 \\to 0$)：$R_{\\mathrm{DELTRAN}} = 0$。\n    - 这种情景意味着共同祖先缺少该性状（状态 $0$），并且它在通往 $A$ 的谱系和通往 $C$ 的谱系中独立获得。\n\n**生物学解释及与表型学的对比**\n\n这两种同样简约的情景（$ACCTRAN$ 和 $DELTRAN$）的存在揭示了数据中固有的歧义。MP 提供了改变的最小次数，但没有提供其唯一的位置或类型。ACCTRAN 的情景（一次起源，两次丢失）支持同源性，表明 $A$ 和 $C$ 中的性状具有共同起源。DELTRAN 的情景（两次独立起源）支持同塑性（具体来说是平行演化），表明 $A$ 和 $C$ 中的性状是同功的。两者之间的选择取决于关于该性状的外部知识；例如，一个复杂的性状不太可能多次演化出来，这使得类 ACCTRAN 的解释更受青睐。\n\n一个严格的表型学分类方法（根据总体相似性对生物进行分组）会被这个性状误导。状态为 $\\{A,C\\}=\\{1\\}$ 和 $\\{B,D,E\\}=\\{0\\}$。表型学将会把 $A$ 和 $C$ 分为一组，把 $B$、$D$ 和 $E$ 分为一组，从而生成一个类似 $((A,C),(B,D,E))$ 的拓扑结构。这与给定的、基于演化关系（分支系统学）的分支图 $((A,B),(C,(D,E)))$ 直接矛盾。分支系统学通过使用树，正确地识别出，相对于给定的系统发育树，$A$ 和 $C$ 之间共享的状态 $1$ 是一种同塑性（非同源相似性），而不是亲缘关系密切的指标。\n\n**最终计算**\n\n问题要求计算 $\\Delta G = G_{\\mathrm{DELTRAN}} - G_{\\mathrm{ACCTRAN}}$。\n根据我们的分析：\n- DELTRAN 下的“获得”次数为 $G_{\\mathrm{DELTRAN}} = 2$。\n- ACCTRAN 下的“获得”次数为 $G_{\\mathrm{ACCTRAN}} = 0$。\n\n因此，$\\Delta G$ 的值为：\n$$\n\\Delta G = 2 - 0 = 2\n$$", "answer": "$$\\boxed{2}$$", "id": "2554461"}]}