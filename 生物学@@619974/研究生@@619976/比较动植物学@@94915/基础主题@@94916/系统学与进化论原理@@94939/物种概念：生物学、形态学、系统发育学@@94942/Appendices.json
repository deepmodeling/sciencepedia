{"hands_on_practices": [{"introduction": "将理论应用于实践的第一步是理解模型如何将潜在过程与可观察模式联系起来。本练习将深入探讨多物种溯祖（MSC）模型的核心。通过一个基础的计算练习，您将亲手实践如何利用物种分化时间（$T$）和有效种群大小（$N_e$）等关键参数，来预测相互单系性（reciprocal monophyly）的概率——这是系统发育物种概念的一个重要诊断标准。这个练习将帮助您建立关于不完全谱系分选（incomplete lineage sorting, ILS）的量化直觉。[@problem_id:2611208]", "problem": "在系统发育物种概念中，基因谱系的相互单系性常被用来判断物种边界。考虑两个候选物种 A 和 B，它们在 $T$ 代前分化，并且自分化以来没有经历过基因流。从每个物种中，您在一个二倍体生物的单个中性常染色体位点上，分别抽取了 $n_{A} = 2$ 和 $n_{B} = 2$ 个基因拷贝。假设后代有效群体大小恒定，为 $N_{e,A} = N_{e,B} = N_{e}$，且祖先有效群体大小为大于零的常数。我们将感兴趣的时间窗口设为每个后代群体中的分化后区间 $[0, T]$。定义深层溯祖为：在时间 $[0, T]$ 内，从某一物种抽取的谱系未能在该物种内发生溯祖的任何情况（因此在时间 $T$ 时，有不止一个谱系进入祖先群体）。使用标准的二倍体中性溯祖模型，其中在恒定大小的群体中，成对溯祖时间服从均值为 $2 N_{e}$ 代的指数分布。\n\n已知两个后代物种的 $T = 4.0 \\times 10^{5}$ 代，及 $N_{e} = 1.0 \\times 10^{5}$，请完成以下任务：\n\n1. 计算在此样本配置下，在分化时间 $T$ 时的深层溯祖期望总数。\n2. 利用您的结果，计算在时间窗口 $[0, T]$ 内，两个抽样支系（每个物种一个）呈相互单系的概率（即两个物种内的最近共同祖先都在时间 $T$ 之前形成）。\n\n将最终概率表示为保留四位有效数字的小数。最终概率无需单位。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n- 物种：两个候选物种，A 和 B。\n- 分化时间：$T$ 代前。\n- 基因流：分化后无基因流。\n- 样本量：$n_{A} = 2$ 和 $n_{B} = 2$ 个基因拷贝。\n- 位点：二倍体生物的单个中性常染色体位点。\n- 有效群体大小：后代群体大小恒定，$N_{e,A} = N_{e,B} = N_{e}$。祖先群体大小为恒定的正数。\n- 时间窗口：分化后区间 $[0, T]$。\n- 深层溯祖的定义：从一个物种抽样的谱系在时间窗口 $[0, T]$ 内未能溯祖。\n- 溯祖模型：标准的二倍体中性溯祖模型。\n- 成对溯祖时间分布：均值为 $2 N_{e}$ 代的指数分布。\n- 数值：$T = 4.0 \\times 10^{5}$ 代，$N_{e} = 1.0 \\times 10^{5}$。\n- 任务：\n    1. 计算在分化时间 $T$ 时的深层溯祖期望总数。\n    2. 计算在时间窗口 $[0, T]$ 内相互单系的概率。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题具有科学依据，依赖于标准的群体遗传学基本模型——中性溯祖理论。所有概念，如有效群体大小、深层溯祖和相互单系，在该领域内都是标准且定义明确的。问题是良定的；它提供了推导唯一解所需的所有必要参数（$T$、$N_{e}$、$n_{A}$、$n_{B}$）和清晰的定义。语言客观且技术性强。给定的值在理论背景下是物理上合理的。该问题是溯祖理论的标准应用，既不琐碎也不自相矛盾。\n\n**第 3 步：结论与行动**\n问题有效。我将继续进行解答。\n\n根据问题陈述的要求，解答分为两部分。\n\n**第 1 部分：深层溯祖的期望数量**\n\n我们在考虑一个二倍体群体中的单个中性位点。根据标准中性溯祖模型，一对谱系（$k=2$）的溯祖时间服从指数分布。$k$ 个谱系的溯祖速率为 $\\lambda_k = \\frac{\\binom{k}{2}}{2N_e}$。对于 $k=2$ 个谱系，此速率为 $\\lambda_2 = \\frac{\\binom{2}{2}}{2N_e} = \\frac{1}{2N_e}$。因此，溯祖时间 $t_{coal}$ 是一个随机变量，其分布为 $t_{coal} \\sim \\text{Exp}(\\frac{1}{2N_e})$。\n\n对于一个给定的物种，“深层溯祖”被定义为抽样谱系未能在时间区间 $[0, T]$ 内溯祖的事件，这意味着溯祖时间 $t_{coal}$ 大于 $T$。\n\n考虑物种 A，从中抽取了 $n_{A}=2$ 个谱系。群体大小为 $N_e$。物种 A 中发生深层溯祖的概率，记为 $P(D_{A})$，是两个谱系在时间 $T$ 之前没有溯祖的概率：\n$$ P(D_{A}) = P(t_{coal, A} > T) $$\n对于一个速率为 $\\lambda$ 的指数分布随机变量，其生存函数为 $P(X > x) = \\exp(-\\lambda x)$。此处，$\\lambda = \\frac{1}{2N_e}$ 且 $x = T$。\n$$ P(D_{A}) = \\exp\\left(-\\frac{T}{2N_e}\\right) $$\n设 $D_A$ 是一个指示随机变量，如果物种 A 中发生深层溯祖，则为 $1$，否则为 $0$。该指示变量的期望值就是该事件的概率：\n$$ E[D_A] = 1 \\cdot P(D_A=1) + 0 \\cdot P(D_A=0) = P(D_A=1) = \\exp\\left(-\\frac{T}{2N_e}\\right) $$\n物种 B 的情况完全相同，有 $n_B=2$ 个谱系，群体大小为 $N_e$。因此，物种 B 中深层溯祖的期望数量为：\n$$ E[D_B] = \\exp\\left(-\\frac{T}{2N_e}\\right) $$\n深层溯祖的总数是每个物种中深层溯祖数量之和，$D_{total} = D_A + D_B$。根据期望的线性性质，深层溯祖的总期望数量为：\n$$ E[D_{total}] = E[D_A + D_B] = E[D_A] + E[D_B] = 2 \\exp\\left(-\\frac{T}{2N_e}\\right) $$\n这完成了问题的第一部分。\n\n**第 2 部分：相互单系的概率**\n\n在时间窗口 $[0, T]$ 内的相互单系，是指物种 A 内的谱系在时间 $T$ 之前发生溯祖，并且物种 B 内的谱系也在时间 $T$ 之前发生溯祖的事件。这等同于发生零个深层溯祖的事件。\n\n设 $M_A$ 为物种 A 内的谱系在 $[0, T]$ 内是单系的事件。这发生在它们的溯祖时间 $t_{coal, A}$ 小于或等于 $T$ 的情况下。这是深层溯祖事件的互补事件。\n$$ P(M_A) = P(t_{coal, A} \\le T) = 1 - P(t_{coal, A} > T) = 1 - \\exp\\left(-\\frac{T}{2N_e}\\right) $$\n同样，对于物种 B，在 $[0, T]$ 内单系的概率是：\n$$ P(M_B) = P(t_{coal, B} \\le T) = 1 - \\exp\\left(-\\frac{T}{2N_e}\\right) $$\n问题陈述中提到自分化以来没有基因流。这意味着两个后代群体中的溯祖过程是独立事件。相互单系的概率 $P(RM)$ 是事件 $M_A$ 和 $M_B$ 同时发生的概率。\n$$ P(RM) = P(M_A \\text{ and } M_B) = P(M_A) \\times P(M_B) $$\n$$ P(RM) = \\left(1 - \\exp\\left(-\\frac{T}{2N_e}\\right)\\right) \\times \\left(1 - \\exp\\left(-\\frac{T}{2N_e}\\right)\\right) = \\left(1 - \\exp\\left(-\\frac{T}{2N_e}\\right)\\right)^2 $$\n现在我们代入给定的数值：$T = 4.0 \\times 10^5$ 和 $N_e = 1.0 \\times 10^5$。时间以溯祖单位来衡量，即代数除以 $2N_e$。\n$$ \\frac{T}{2N_e} = \\frac{4.0 \\times 10^5}{2 \\times (1.0 \\times 10^5)} = \\frac{4.0 \\times 10^5}{2.0 \\times 10^5} = 2 $$\n无量纲时间为 2。我们将此值代入相互单系概率的表达式中。\n$$ P(RM) = \\left(1 - \\exp(-2)\\right)^2 $$\n我们计算数值：\n$$ \\exp(-2) \\approx 0.13533528... $$\n$$ 1 - \\exp(-2) \\approx 1 - 0.13533528 = 0.86466471... $$\n$$ P(RM) \\approx (0.86466471...)^2 \\approx 0.747643... $$\n保留四位有效数字，最终概率为 $0.7476$。", "answer": "$$\\boxed{0.7476}$$", "id": "2611208"}, {"introduction": "理论为我们提供了期望，但现实世界的数据分析则需要我们量化观察到的模式。当处理从多个基因座估算出的基因树时，我们经常会遇到谱系在单系和并系之间变化的复杂情况。本练习将介绍谱系分选指数（genealogical sorting index, gsi），这是一个强大的工具，用于量化一个假定谱系在基因树中的“独占性”程度。您将从第一性原理出发推导出该指数的公式，并将其应用于一个模拟的多基因座数据集，从而将抽象的物种概念转化为可操作的度量。[@problem_id:2611143]", "problem": "一个研究团队正在使用多物种溯祖（MSC）模型，通过多位点数据对一个假定物种簇进行系统发育物种概念（PSC）的评估。目标候选簇表示为 $X$，由 $n=5$ 个采样个体组成，这些个体嵌入在每个有根基因树上一个更广泛的 $N=20$ 个个体的样本中。物种树在所有位点上是一致的，其枝长以溯祖单位表示：将 $X$ 与其姐妹谱系 $Y$ 分开的干枝长度为 $t_{XY}=1.1$，从 $X\\!+\\!Y$ 共同祖先到下一个外类群 $Z$ 的祖先枝长度为 $t_{(XY)Z}=0.3$。提供这些值是为了给不完全谱系分选的预期提供生物学背景，但不应直接代入任何计算。\n\n您的任务是使用谱系分选指数（gsi）来量化 $X$ 在每个有根基因树上的谱系排他性程度。对于一个给定的基因树，令 $s$ 表示包含 $X$ 的所有 $n$ 个成员的最小演化支中的末端（tips）数量（即最小包围演化支大小）。$X$ 的 gsi 必须满足以下从单系性和排他性的核心定义中导出的概念性约束：\n- 如果 $X$ 在基因树上是严格单系的，则 $s=n$，此时指数必须达到其最大值。\n- 如果 $X$ 是完全非排他的，以至于需要整个树才能包围其所有成员，则 $s=N$，此时指数必须达到其最小值。\n- 当 $s$ 在 $n$ 和 $N$ 之间变化时，该指数应随排他性线性变化，因此排他性损失的等量增加会导致指数的等量减少。\n\n仅使用这些约束，首先推导出 gsi 作为 $s$、$n$ 和 $N$ 的函数的显式表达式。\n\n在 $5$ 个独立的基因树（位点）上，观测到的 $X$ 的最小包围演化支大小为：\n- 位点 $1$：$s_{1}=5$\n- 位点 $2$：$s_{2}=6$\n- 位点 $3$：$s_{3}=7$\n- 位点 $4$：$s_{4}=20$\n- 位点 $5$：$s_{5}=5$\n\n通过对您推导出的每个位点的 gsi 值进行平均，计算 $X$ 的跨位点平均 gsi。然后，结合所提供的溯祖枝长，并引用多物种溯祖模型的预期，简要解释您获得的数值大小是否与 PSC 将 $X$ 识别为一个独立谱系相一致。\n\n最终答案只提供跨位点平均 gsi 的数值。将最终值表示为一个无单位的数字，并四舍五入到 $4$ 位有效数字。", "solution": "问题陈述已经过评估，并被确定为有效。它在科学上基于系统发育和群体遗传学理论的原理，特别是多物种溯祖模型和谱系分选指数（$gsi$）。该问题设定良好，有足够的约束来推导所需的函数，并有完整的数据用于后续计算。语言客观而精确。因此，我将开始解答。\n\n主要任务是推导谱系分选指数 $gsi$ 的表达式，该表达式是最小包围演化支大小 $s$、目标群体中的个体数 $n$ 以及样本中的总个体数 $N$ 的函数。问题指明了三个约束条件：\n1. 当目标群体 $X$ 是严格单系时，指数必须达到最大值，这对应于 $s=n$。\n2. 当群体完全非排他时，即最小包围演化支是整个树，指数必须达到最小值，这对应于 $s=N$。\n3. 当 $s$ 在 $n$ 到 $N$ 的范围内变化时，指数必须线性变化。\n\n$gsi$ 和 $s$ 之间的线性关系可以表示为 $gsi(s) = as + b$，其中 $a$ 和 $b$ 是常数。按照惯例，这类指数被归一化到区间 $[0, 1]$。我们将完全排他性的最大值设为 $1$，完全不具排他性的最小值设为 $0$。\n\n这根据边界条件建立了一个由两个线性方程组成的方程组：\n1. 对于 $s=n$（单系性）：$gsi(n) = an + b = 1$\n2. 对于 $s=N$（完全非排他性）：$gsi(N) = aN + b = 0$\n\n我们可以解这个方程组来求出常数 $a$ 和 $b$。从第二个方程，我们得到 $b = -aN$。将这个 $b$ 的表达式代入第一个方程，得到：\n$an - aN = 1$\n$a(n - N) = 1$\n$a = \\frac{1}{n-N}$\n\n现在，我们求解 $b$：\n$b = -aN = -N \\left( \\frac{1}{n-N} \\right) = \\frac{-N}{n-N} = \\frac{N}{N-n}$\n\n将 $a$ 和 $b$ 的表达式代回线性函数 $gsi(s) = as + b$，我们得到该指数的通用公式：\n$gsi(s) = \\left( \\frac{1}{n-N} \\right) s + \\frac{N}{N-n} = \\frac{s - N}{n-N}$\n这个公式更常规的写法是：\n$$gsi(s, n, N) = \\frac{N-s}{N-n}$$\n这个推导出的表达式正确地满足了所有三个初始约束。\n\n接下来，我们将此公式应用于所提供的数据。参数为 $n=5$ 和 $N=20$。本研究的具体公式是：\n$$gsi(s) = \\frac{20-s}{20-5} = \\frac{20-s}{15}$$\n\n现在我们使用观测到的最小包围演化支大小（$s_i$）计算 $5$ 个位点中每个位点的 $gsi$ 值：\n- 位点 $1$ ($s_1=5$): $gsi_1 = \\frac{20-5}{15} = \\frac{15}{15} = 1$\n- 位点 $2$ ($s_2=6$): $gsi_2 = \\frac{20-6}{15} = \\frac{14}{15}$\n- 位点 $3$ ($s_3=7$): $gsi_3 = \\frac{20-7}{15} = \\frac{13}{15}$\n- 位点 $4$ ($s_4=20$): $gsi_4 = \\frac{20-20}{15} = \\frac{0}{15} = 0$\n- 位点 $5$ ($s_5=5$): $gsi_5 = \\frac{20-5}{15} = \\frac{15}{15} = 1$\n\n跨位点平均 $gsi$，记为 $\\overline{gsi}$，是这些单个值的算术平均值：\n$$\\overline{gsi} = \\frac{1}{5} \\sum_{i=1}^{5} gsi_i = \\frac{1}{5} \\left( 1 + \\frac{14}{15} + \\frac{13}{15} + 0 + 1 \\right)$$\n为了计算这个值，我们将所有项转换为以 $15$ 为公分母：\n$$\\overline{gsi} = \\frac{1}{5} \\left( \\frac{15}{15} + \\frac{14}{15} + \\frac{13}{15} + \\frac{0}{15} + \\frac{15}{15} \\right) = \\frac{1}{5} \\left( \\frac{15+14+13+0+15}{15} \\right)$$\n$$\\overline{gsi} = \\frac{1}{5} \\left( \\frac{57}{15} \\right) = \\frac{57}{75}$$\n将分子和分母同时除以它们的最大公约数 $3$，我们简化分数：\n$$\\overline{gsi} = \\frac{19}{25} = 0.76$$\n\n最后，我们必须解释这个结果。平均 $gsi$ 为 $0.76$ 表明候选物种 $X$ 具有强烈的、但非绝对的谱系排他性信号。系统发育物种概念（PSC）强调可诊断的排他性。观测到的两个位点显示完全单系（$gsi=1$）、两个位点显示接近单系、一个位点显示完全非排他性（$gsi=0$）的模式是有信息量的。\n在多物种溯祖（MSC）模型下，一个物种获得单系基因树的概率是其干枝长度（以溯祖单位计）的函数。预计不完全谱系分选（ILS）会阻止一部分基因树形成单系，且这一比例随着干枝长度的增加而减少。两个谱系在长度为 $t$（以溯祖单位計）的枝上未能溯祖合并的概率是 $\\exp(-t)$。对于给定的干枝长度 $t_{XY}=1.1$，群体 $X$ 和 $Y$ 之间发生不完全谱系分选的概率是 $\\exp(-1.1) \\approx 0.33$。这表明大约三分之一的基因树预计会显示非单系性。我们的经验结果，即在 $5$ 个位点中有 $3$ 个观测到非单系性（程度不同），与这一理论预期相符。位点 4 的完全分选失败（$s=20$, $gsi=0$）表明存在深度不完全谱系分选，即来自 $X$ 的谱系甚至在长度为 $t_{(XY)Z}=0.3$ 的祖先枝上也未能溯祖合并。这种深度溯祖的概率是 $\\exp(-(t_{XY}+t_{(XY)Z})) = \\exp(-1.4) \\approx 0.25$。在五次试验中观察到一次这样的事件并非不可能。\n总之，高达 $0.76$ 的平均 $gsi$ 值，以及跨位点的特定分选模式，与 MSC 对于一个干枝长度为 $t_{XY}=1.1$ 的近期分化谱系的预测完全一致。这为在 PSC 下将 $X$ 识别为一个独立物种提供了强有力的定量支持。\n\n要求的最终数值答案是跨位点平均 $gsi$，四舍五入到 $4$ 位有效数字。\n$\\overline{gsi} = 0.7600$。", "answer": "$$\n\\boxed{0.7600}\n$$", "id": "2611143"}]}