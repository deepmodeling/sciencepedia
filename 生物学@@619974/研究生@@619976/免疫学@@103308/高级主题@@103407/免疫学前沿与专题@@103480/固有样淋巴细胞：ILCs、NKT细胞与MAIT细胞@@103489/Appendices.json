{"hands_on_practices": [{"introduction": "细胞的激活通常始于细胞表面受体与配体的结合，这是免疫应答的第一个关键步骤。理解这种相互作用的定量关系对于预测细胞行为至关重要。该练习将引导您从基本的质量作用定律出发，推导出描述受体-配体结合平衡的模型，并应用该模型来量化不同亲和力的脂质抗原如何影响不变自然杀伤 T (iNKT) 细胞的受体占据率和相对激活水平。通过这个实践，您将掌握一个核心工具，用以连接可测量的生物物理参数（如解离常数 $K_d$）与关键的生物学功能。[@problem_id:2863283]", "problem": "一个研究小组正在量化恒定自然杀伤T细胞（iNKT细胞）如何利用其恒定T细胞受体（TCR）对由分化簇1d（CD1d）呈递的三种不同脂质抗原作出响应。假设TCR与CD1d-脂质复合物之间的结合是在平衡状态下由质量作用定律支配的快速、可逆的单价相互作用，且配体耗尽可忽略不计，结合位点相互独立。测得三种脂质抗原（抗原A、抗原B、抗原C）的平衡解离常数如下：抗原A的$K_{d} = 10\\,\\mathrm{nM}$，抗原B的$K_{d} = 100\\,\\mathrm{nM}$，抗原C的$K_{d} = 1\\,\\mu\\mathrm{M}$。在受体表达和抗原呈递条件相同的情况下，将细胞暴露于每种抗原，游离配体浓度为 $[L] = 50\\,\\mathrm{nM}$。\n\n从平衡状态下的$1{:}1$受体-配体结合反应的质量作用定律出发，推导TCR占据分数（表示为$\\theta$）作为游离配体浓度$[L]$和解离常数$K_{d}$的函数表达式。然后，使用您推导的表达式，计算在$[L] = 50\\,\\mathrm{nM}$时每种抗原的分数占据率$\\theta$。\n\n假设在此范围内，与活化相关的早期信号输出与被结合的TCR分数成正比，并且所有抗原的下游耦合是相同的。通过对三种抗原中的最大分数占据率进行归一化，定义抗原$i$的相对活化指数$A_{i}$，即$A_{i} = \\theta_{i} / \\max\\{\\theta_{A}, \\theta_{B}, \\theta_{C}\\}$。\n\n将最终答案以单行矩阵的形式给出，按顺序依次列出三种占据率$(\\theta_{A}, \\theta_{B}, \\theta_{C})$和三种相对活化指数$(A_{A}, A_{B}, A_{C})$。结果请用精确分数形式表示，不要近似或四舍五入。最终答案是无量纲的。", "solution": "该问题陈述已经过评估，被确定是有效的。它在科学上基于受体-配体结合动力学原理，在数学上是适定的，并提供了客观、明确的数据和定义。该问题是自洽的，没有矛盾或逻辑缺陷。我们将着手求解。\n\nT细胞受体（TCR，记为$R$）与CD1d-脂质复合物（记为$L$）之间的相互作用被描述为一个可逆的$1{:}1$结合反应：\n$$R + L \\rightleftharpoons RL$$\n其中$RL$是受体-配体复合物。\n\n根据质量作用定律，平衡解离常数$K_{d}$定义为：\n$$K_{d} = \\frac{[R][L]}{[RL]}$$\n此处，$[R]$、$[L]$和$[RL]$分别代表平衡时游离受体、游离配体和结合复合物的摩尔浓度。\n\n受体总浓度$[R]_{\\text{total}}$是游离受体和结合受体浓度之和：\n$$[R]_{\\text{total}} = [R] + [RL]$$\n分数占据率$\\theta$定义为被配体结合的受体占总受体的分数：\n$$\\theta = \\frac{[RL]}{[R]_{\\text{total}}} = \\frac{[RL]}{[R] + [RL]}$$\n为了将$\\theta$表示为$[L]$和$K_{d}$的函数，我们首先重排平衡表达式以解出$[R]$：\n$$[R] = \\frac{K_{d} [RL]}{[L]}$$\n将这个$[R]$的表达式代入$\\theta$的方程中，得到：\n$$\\theta = \\frac{[RL]}{\\frac{K_{d} [RL]}{[L]} + [RL]}$$\n假设存在非平凡结合，即$[RL] > 0$，我们可以将分子和分母同除以$[RL]$：\n$$\\theta = \\frac{1}{\\frac{K_{d}}{[L]} + 1}$$\n将分子和分母同乘以$[L]$，得到单价相互作用结合等温线的最终标准形式，这被称为Langmuir等温线或系数为1的Hill方程：\n$$\\theta = \\frac{[L]}{[L] + K_{d}}$$\n这就是所要求的分数占据率表达式。\n\n现在，我们计算在指定的游离配体浓度$[L] = 50\\,\\mathrm{nM}$下，每种抗原的分数占据率。我们必须首先确保所有解离常数的单位一致。\n给定值为：\n$K_{d,A} = 10\\,\\mathrm{nM}$\n$K_{d,B} = 100\\,\\mathrm{nM}$\n$K_{d,C} = 1\\,\\mu\\mathrm{M} = 1 \\times 10^{3}\\,\\mathrm{nM} = 1000\\,\\mathrm{nM}$\n\n使用推导出的$\\theta$公式，我们计算每种抗原的占据率：\n对抗原A：\n$$\\theta_{A} = \\frac{[L]}{[L] + K_{d,A}} = \\frac{50}{50 + 10} = \\frac{50}{60} = \\frac{5}{6}$$\n对抗原B：\n$$\\theta_{B} = \\frac{[L]}{[L] + K_{d,B}} = \\frac{50}{50 + 100} = \\frac{50}{150} = \\frac{1}{3}$$\n对抗原C：\n$$\\theta_{C} = \\frac{[L]}{[L] + K_{d,C}} = \\frac{50}{50 + 1000} = \\frac{50}{1050} = \\frac{5}{105} = \\frac{1}{21}$$\n问题定义了相对活化指数 $A_{i} = \\theta_{i} / \\max\\{\\theta_{A}, \\theta_{B}, \\theta_{C}\\}$。为了计算它，我们首先确定最大分数占据率。我们比较$\\theta_{A} = \\frac{5}{6}$，$\\theta_{B} = \\frac{1}{3}$ 和 $\\theta_{C} = \\frac{1}{21}$。\n为了比较，我们可以使用公分母 $42$：\n$\\theta_{A} = \\frac{5 \\times 7}{6 \\times 7} = \\frac{35}{42}$\n$\\theta_{B} = \\frac{1 \\times 14}{3 \\times 14} = \\frac{14}{42}$\n$\\theta_{C} = \\frac{1 \\times 2}{21 \\times 2} = \\frac{2}{42}$\n由此可见，$\\max\\{\\theta_{A}, \\theta_{B}, \\theta_{C}\\} = \\theta_{A} = \\frac{5}{6}$。\n\n现在我们计算相对活化指数：\n对抗原A：\n$$A_{A} = \\frac{\\theta_{A}}{\\max\\{\\theta_{A}, \\theta_{B}, \\theta_{C}\\}} = \\frac{\\theta_{A}}{\\theta_{A}} = 1$$\n对抗原B：\n$$A_{B} = \\frac{\\theta_{B}}{\\theta_{A}} = \\frac{1/3}{5/6} = \\frac{1}{3} \\cdot \\frac{6}{5} = \\frac{6}{15} = \\frac{2}{5}$$\n对抗原C：\n$$A_{C} = \\frac{\\theta_{C}}{\\theta_{A}} = \\frac{1/21}{5/6} = \\frac{1}{21} \\cdot \\frac{6}{5} = \\frac{6}{105} = \\frac{2}{35}$$\n最终结果是占据率集合$(\\theta_{A}, \\theta_{B}, \\theta_{C})$和相对活化指数集合$(A_{A}, A_B, A_C)$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{5}{6} & \\frac{1}{3} & \\frac{1}{21} & 1 & \\frac{2}{5} & \\frac{2}{35} \\end{pmatrix}}$$", "id": "2863283"}, {"introduction": "在真实的生理环境中，免疫细胞并非只接触单一信号，而是暴露在由激动剂、拮抗剂和部分激动剂等多种分子组成的复杂信号海洋中。为了更真实地模拟细胞决策过程，我们需要从简单的单配体结合模型扩展至考虑竞争性抑制。本练习将挑战您构建一个多配体竞争性结合模型，以分析黏膜相关不变 T (MAIT) 细胞的激活如何被不同功能的配体精确调控。通过计算拮抗剂在何种浓度下能有效抑制激活信号，您将深入理解在复杂微环境中免疫应答是如何被精细调节的。[@problem_id:2863270]", "problem": "黏膜相关恒定T (MAIT) 细胞可识别由I类主要组织相容性复合体相关蛋白1 (MR1) 呈递的、源自核黄素生物合成途径的代谢物。某些配体作为激动剂，能够稳定细胞表面的MR1并驱动T细胞受体 (TCR) 依赖性激活，而另一些配体则作为拮抗剂，虽能稳定MR1但无法引发信号。考虑一个系统，其中MR1为配体提供单一结合位点，并与来自一个均匀混合、浓度恒定的细胞外库中的三种配体结合：激动剂 $A$、拮抗剂 $I$ 和内源性弱部分激动剂 $E$。假设遵循以下基本原则：(i) 每种配体遵循质量作用定律，在热力学平衡状态下具有各自的解离常数 $K_{d,j}$；(ii) MR1总库守恒；(iii) 只有与配体结合的MR1被转运至细胞表面，因此空的MR1对表面密度或信号传导均无贡献。设 $A$、$I$ 和 $E$ 的效能分别为 $e_{A}$、$e_{I}$ 和 $e_{E}$，其中效能用于加权与配体结合的MR1复合物对净激活信号的贡献。假设净激活信号 $S$ 与经效能加权的MR1复合物的表面密度成正比，并通过一个适当的常数（可被吸收到比例关系中）归一化到区间 $[0,1]$。\n\n1. 仅使用上述原则，推导信号 $S$ 的表达式，该表达式是配体浓度 $[A]$、$[I]$、$[E]$，其解离常数 $K_{d,A}$、$K_{d,I}$、$K_{d,E}$，以及其效能 $e_{A}$、$e_{I}$、$e_{E}$ 的函数。此推导基于以下假设：$[A]$、$[I]$ 和 $[E]$ 不会因与MR1结合而显著消耗（因此游离配体浓度等于总浓度）。\n\n2. 在一个特定的组织微环境中，假设 $e_{A}=1$，$e_{I}=0$（纯拮抗剂），$e_{E}=0.3$，$[A]=50\\,\\mathrm{nM}$，$[E]=100\\,\\mathrm{nM}$，$K_{d,A}=30\\,\\mathrm{nM}$，$K_{d,I}=20\\,\\mathrm{nM}$，以及 $K_{d,E}=500\\,\\mathrm{nM}$。为实现强劲的MAIT细胞因子产生，需要达到一个激活阈值 $S_{\\mathrm{th}}=0.5$。令 $r=[I]/[A]$ 表示拮抗剂与激动剂的摩尔比。使用您推导的表达式，确定使 $S$ 降低到 $S_{\\mathrm{th}}$ 所需的 $r$ 的最小值。\n\n将您最终的比率 $r$ 四舍五入至三位有效数字。由于 $r$ 是一个无量纲的摩尔比，报告该数值时无需单位。", "solution": "本题要求为由可结合三种不同配体（激动剂 $A$、拮抗剂 $I$ 和部分激动剂 $E$）的MR1蛋白介导的MAIT细胞激活推导一个信号转导模型。随后，利用此模型计算一个特定的配体浓度比。\n\n第1部分：信号表达式 $S$ 的推导\n\n该系统受三大原则支配：质量作用定律、MR1蛋白总库守恒、以及只有与配体结合的MR1才在细胞表面表达。设 $[MR1]_{T}$ 为MR1的总浓度，$[MR1]_{f}$ 为游离（未结合）MR1的浓度，$[MR1 \\cdot J]$ 为与配体 $J$ 结合的MR1的浓度，其中 $J \\in \\{A, I, E\\}$。\n\n根据平衡状态下的质量作用定律，每种配体的解离常数由下式给出：\n$K_{d,A} = \\frac{[MR1]_{f} [A]}{[MR1 \\cdot A]}$\n$K_{d,I} = \\frac{[MR1]_{f} [I]}{[MR1 \\cdot I]}$\n$K_{d,E} = \\frac{[MR1]_{f} [E]}{[MR1 \\cdot E]}$\n\n从这些关系中，我们可以用游离MR1的浓度来表示每种MR1-配体复合物的浓度：\n$[MR1 \\cdot A] = \\frac{[MR1]_{f} [A]}{K_{d,A}}$\n$[MR1 \\cdot I] = \\frac{[MR1]_{f} [I]}{K_{d,I}}$\n$[MR1 \\cdot E] = \\frac{[MR1]_{f} [E]}{K_{d,E}}$\n\nMR1守恒原理指出，MR1的总浓度是游离形式与所有结合形式浓度之和：\n$[MR1]_{T} = [MR1]_{f} + [MR1 \\cdot A] + [MR1 \\cdot I] + [MR1 \\cdot E]$\n\n将结合形式的表达式代入守恒方程可得：\n$[MR1]_{T} = [MR1]_{f} + \\frac{[MR1]_{f} [A]}{K_{d,A}} + \\frac{[MR1]_{f} [I]}{K_{d,I}} + \\frac{[MR1]_{f} [E]}{K_{d,E}}$\n提出 $[MR1]_{f}$：\n$[MR1]_{T} = [MR1]_{f} \\left(1 + \\frac{[A]}{K_{d,A}} + \\frac{[I]}{K_{d,I}} + \\frac{[E]}{K_{d,E}}\\right)$\n\n净激活信号 $S$ 与经效能加权的MR1复合物的表面密度成正比。根据原则（iii），只有与配体结合的MR1被转运到表面，因此能够产生信号。最简单直接的解释是，每种类型的复合物所产生的信号与其总浓度成正比。因此，总的未归一化信号 $S_{unnorm}$ 与各类复合物浓度之和成正比，并按其各自的效能 $e_J$ 加权：\n$S_{unnorm} \\propto e_{A}[MR1 \\cdot A] + e_{I}[MR1 \\cdot I] + e_{E}[MR1 \\cdot E]$\n\n我们引入一个比例常数 $C$。\n$S_{unnorm} = C \\left( e_{A}\\frac{[MR1]_{f} [A]}{K_{d,A}} + e_{I}\\frac{[MR1]_{f} [I]}{K_{d,I}} + e_{E}\\frac{[MR1]_{f} [E]}{K_{d,E}} \\right)$\n$S_{unnorm} = C [MR1]_{f} \\left( \\frac{e_{A} [A]}{K_{d,A}} + \\frac{e_{I} [I]}{K_{d,I}} + \\frac{e_{E} [E]}{K_{d,E}} \\right)$\n\n我们可以用 $[MR1]_{T}$ 来表示 $[MR1]_{f}$：\n$[MR1]_{f} = \\frac{[MR1]_{T}}{1 + \\frac{[A]}{K_{d,A}} + \\frac{[I]}{K_{d,I}} + \\frac{[E]}{K_{d,E}}}$\n\n将此式代入 $S_{unnorm}$ 的表达式中：\n$S_{unnorm} = C [MR1]_{T} \\frac{\\frac{e_{A} [A]}{K_{d,A}} + \\frac{e_{I} [I]}{K_{d,I}} + \\frac{e_{E} [E]}{K_{d,E}}}{1 + \\frac{[A]}{K_{d,A}} + \\frac{[I]}{K_{d,I}} + \\frac{[E]}{K_{d,E}}}$\n\n题目指出信号 $S$ 被归一化到区间 $[0,1]$。这需要将 $S_{unnorm}$ 除以其最大可能信号 $S_{max}$。当所有MR1分子都与具有最高效能的配体结合时，达到 $S_{max}$。我们假设这个配体是效能为 $e_A$ 的激动剂 $A$。当 $[I]$ 和 $[E]$ 为0，且 $[A] \\rightarrow \\infty$ 时，信号趋近于这个最大值。在此极限下，$[MR1 \\cdot A] \\rightarrow [MR1]_T$，信号变为 $S_{max} = C e_A [MR1]_T$。\n\n因此，归一化信号 $S$ 为：\n$S = \\frac{S_{unnorm}}{S_{max}} = \\frac{C [MR1]_{T} \\frac{\\frac{e_{A} [A]}{K_{d,A}} + \\frac{e_{I} [I]}{K_{d,I}} + \\frac{e_{E} [E]}{K_{d,E}}}{1 + \\frac{[A]}{K_{d,A}} + \\frac{[I]}{K_{d,I}} + \\frac{[E]}{K_{d,E}}}}{C e_A [MR1]_T}$\n\n假设 $e_A > 0$，我们得到信号 $S$ 的最终表达式：\n$S = \\frac{1}{e_{A}} \\frac{\\frac{e_{A} [A]}{K_{d,A}} + \\frac{e_{I} [I]}{K_{d,I}} + \\frac{e_{E} [E]}{K_{d,E}}}{1 + \\frac{[A]}{K_{d,A}} + \\frac{[I]}{K_{d,I}} + \\frac{[E]}{K_{d,E}}}$\n鉴于在题目的特定情境下 $e_{A}=1$，表达式简化为：\n$S = \\frac{\\frac{[A]}{K_{d,A}} + \\frac{e_{I} [I]}{K_{d,I}} + \\frac{e_{E} [E]}{K_{d,E}}}{1 + \\frac{[A]}{K_{d,A}} + \\frac{[I]}{K_{d,I}} + \\frac{[E]}{K_{d,E}}}$\n\n第2部分：拮抗剂与激动剂之比 $r$ 的计算\n\n给定以下数值：\n$e_{A} = 1$\n$e_{I} = 0$\n$e_{E} = 0.3$\n$[A] = 50\\,\\mathrm{nM}$\n$[E] = 100\\,\\mathrm{nM}$\n$K_{d,A} = 30\\,\\mathrm{nM}$\n$K_{d,I} = 20\\,\\mathrm{nM}$\n$K_{d,E} = 500\\,\\mathrm{nM}$\n目标信号阈值为 $S_{\\mathrm{th}} = 0.5$。我们需要找到将信号降低至此阈值的最小比率 $r = [I]/[A]$。\n\n首先，我们计算激动剂和内源性配体的归一化浓度（无量纲项）：\n$\\frac{[A]}{K_{d,A}} = \\frac{50}{30} = \\frac{5}{3}$\n$\\frac{[E]}{K_{d,E}} = \\frac{100}{500} = \\frac{1}{5}$\n\n拮抗剂 $I$ 的项取决于 $r$：\n$[I] = r[A] = r \\cdot 50\\,\\mathrm{nM}$\n$\\frac{[I]}{K_{d,I}} = \\frac{50r}{20} = \\frac{5}{2}r = 2.5r$\n\n现在，我们将这些值代入推导出的 $S$ 的表达式中。请注意，由于 $e_I=0$，分子中拮抗剂的项为零。\n$S = \\frac{e_{A} \\frac{[A]}{K_{d,A}} + e_{I} \\frac{[I]}{K_{d,I}} + e_{E} \\frac{[E]}{K_{d,E}}}{1 + \\frac{[A]}{K_{d,A}} + \\frac{[I]}{K_{d,I}} + \\frac{[E]}{K_{d,E}}}$\n$S = \\frac{(1)\\left(\\frac{5}{3}\\right) + (0)\\left(\\frac{5}{2}r\\right) + (0.3)\\left(\\frac{1}{5}\\right)}{1 + \\frac{5}{3} + \\frac{5}{2}r + \\frac{1}{5}}$\n\n我们令 $S=0.5$，然后解出 $r$：\n$0.5 = \\frac{\\frac{5}{3} + \\frac{0.3}{5}}{1 + \\frac{5}{3} + \\frac{1}{5} + \\frac{5}{2}r}$\n$0.5 = \\frac{\\frac{5}{3} + \\frac{3}{50}}{(\\frac{15+25+3}{15}) + \\frac{5}{2}r}$\n$0.5 = \\frac{\\frac{250+9}{150}}{\\frac{43}{15} + \\frac{5}{2}r}$\n$0.5 = \\frac{\\frac{259}{150}}{\\frac{43}{15} + \\frac{5}{2}r}$\n\n现在，我们求解 $r$：\n$0.5 \\left( \\frac{43}{15} + \\frac{5}{2}r \\right) = \\frac{259}{150}$\n$\\frac{1}{2} \\cdot \\frac{43}{15} + \\frac{1}{2} \\cdot \\frac{5}{2}r = \\frac{259}{150}$\n$\\frac{43}{30} + \\frac{5}{4}r = \\frac{259}{150}$\n$\\frac{5}{4}r = \\frac{259}{150} - \\frac{43}{30}$\n为进行分数减法，我们找到公分母，即 $150$：\n$\\frac{5}{4}r = \\frac{259}{150} - \\frac{43 \\times 5}{30 \\times 5} = \\frac{259 - 215}{150} = \\frac{44}{150}$\n$\\frac{5}{4}r = \\frac{22}{75}$\n$r = \\frac{22}{75} \\cdot \\frac{4}{5} = \\frac{88}{375}$\n\n为了给出最终答案，我们计算其小数值并四舍五入到三位有效数字：\n$r = \\frac{88}{375} \\approx 0.234666...$\n四舍五入到三位有效数字，我们得到 $r \\approx 0.235$。这是最小比率，因为任何更小的 $r$ 值都将导致信号 $S > 0.5$。", "answer": "$$\\boxed{0.235}$$", "id": "2863270"}, {"introduction": "细胞在接收到外界信号后，必须通过内部的基因调控网络将其转化为稳定且持久的细胞命运决定。在淋巴细胞分化中，这种决策过程通常由充当“开关”的核心转录因子网络控制。本练习将带您进入系统生物学的世界，通过构建和分析一个代表 T-bet 和 RORγt 这两个关键转录因子相互抑制的动态系统模型，来探索细胞谱系承诺的分子基础。您将通过计算方法研究该基因开关的“双稳态”特性，并阐明外部细胞因子信号（如 IL-12 和 IL-23）如何打破系统对称性，从而将细胞推向一个确定的、稳定的分化终点。[@problem_id:2863251]", "problem": "本问题要求您形式化并分析一个无量纲、确定性的双基因调控网络。该网络代表了T-box转录因子TBX21 (T-bet)和视黄酸受体相关孤儿受体γt (RORγt)之间的拮抗作用，这两者是固有样淋巴细胞中关键的谱系特异性转录因子。外部细胞因子信号白细胞介素-12 (IL-12)和白细胞介素-23 (IL-23)分别使系统偏向于表达T-bet和RORγt。您必须从以下基本原理和定义出发。\n\n1) 核心定义与建模原理：\n- 分子生物学中心法则指出，基因通过转录和翻译产生蛋白质，而蛋白质的丰度由其生成和降解过程决定。\n- 在基因调控网络中，转录因子的抑制作用通常使用Hill系数为$n$的Hill型抑制函数来建模，该函数能捕捉协同结合的特性；而线性降解则用于模拟蛋白水解和稀释。\n\n2) 模型设定：\n- 令$T(t) \\ge 0$表示在时间$t$时T-bet的无量纲丰度，令$R(t) \\ge 0$表示RORγt的无量纲丰度。\n- 相互抑制由Hill系数为$n=2$的Hill型抑制函数表示。\n- 细胞因子输入IL-12和IL-23贡献了恒定的正偏置项$s_{12} \\ge 0$和$s_{23} \\ge 0$，它们分别加到$T$和$R$的生成项上。\n- 动力学由以下自治系统定义：\n$$\n\\frac{dT}{dt} \\;=\\; \\alpha_T\\,\\frac{1}{1+\\left(\\frac{R}{K_{TR}}\\right)^{2}} \\;+\\; s_{12} \\;-\\; \\delta_T\\,T,\n\\qquad\n\\frac{dR}{dt} \\;=\\; \\alpha_R\\,\\frac{1}{1+\\left(\\frac{T}{K_{RT}}\\right)^{2}} \\;+\\; s_{23} \\;-\\; \\delta_R\\,R,\n$$\n其中参数$\\alpha_T>0$, $\\alpha_R>0$为最大调控生产幅度，$K_{TR}>0$, $K_{RT}>0$为抑制阈值，$\\delta_T>0$, $\\delta_R>0$为降解率。所有变量和参数均为无量纲。Hill系数固定为$n=2$。\n\n3) 任务：\n- 对于每个指定的参数集，确定系统在非负象限内不同渐近稳定稳态$(T^\\ast,R^\\ast)$的数量。一个稳态$(T^\\ast,R^\\ast)$满足$\\frac{dT}{dt}=\\frac{dR}{dt}=0$，并且如果其在$(T^\\ast,R^\\ast)$点的雅可比矩阵的所有特征值的实部均为负，则该稳态是渐近稳定的。\n- 您的程序可以使用任何数学上合理且自洽的数值方法（例如，从一组初始条件积分轨迹并对极限点进行聚类，然后通过雅可比矩阵检查稳定性）。\n- 将每个结果表示为一个整数，该整数等于为该参数集找到的不同渐近稳定稳态的数量。\n\n4) 测试套件：\n针对以下六个参数集评估该系统。对于每个集合，Hill系数均为$n=2$。\n- 情况 1：$\\alpha_T=\\alpha_R=3.0$, $K_{TR}=K_{RT}=0.5$, $\\delta_T=\\delta_R=1.0$, $s_{12}=0.0$, $s_{23}=0.0$.\n- 情况 2：$\\alpha_T=\\alpha_R=3.0$, $K_{TR}=K_{RT}=0.5$, $\\delta_T=\\delta_R=1.0$, $s_{12}=1.0$, $s_{23}=0.0$.\n- 情况 3：$\\alpha_T=\\alpha_R=3.0$, $K_{TR}=K_{RT}=0.5$, $\\delta_T=\\delta_R=1.0$, $s_{12}=0.0$, $s_{23}=1.0$.\n- 情况 4：$\\alpha_T=\\alpha_R=0.5$, $K_{TR}=K_{RT}=0.5$, $\\delta_T=\\delta_R=1.0$, $s_{12}=0.0$, $s_{23}=0.0$.\n- 情况 5：$\\alpha_T=\\alpha_R=1.5$, $K_{TR}=K_{RT}=0.5$, $\\delta_T=\\delta_R=1.0$, $s_{12}=0.3$, $s_{23}=0.3$.\n- 情况 6：$\\alpha_T=\\alpha_R=3.0$, $K_{TR}=0.3$, $K_{RT}=0.7$, $\\delta_T=\\delta_R=1.0$, $s_{12}=0.0$, $s_{23}=0.0$.\n\n5) 输出规范：\n- 对每种情况，计算渐近稳定稳态的整数数量。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按情况1到情况6的顺序排列结果，例如$\\left[\\text{结果}_1,\\text{结果}_2,\\text{结果}_3,\\text{结果}_4,\\text{结果}_5,\\text{结果}_6\\right]$。\n\n不涉及角度或物理单位；所有量均为无量纲。在整个分析过程中，请遵守非负约束$T(t)\\ge 0$, $R(t)\\ge 0$以确保科学真实性，并使用数值稳定的程序来确定稳态及其稳定性。", "solution": "我们的任务是确定一个代表遗传双稳态开关的二维动力系统的渐近稳定稳态数量。该问题定义明确，科学上根植于系统生物学原理，并为分析提供了所有必要的参数。我们将进行严格的数学和计算研究。\n\n该系统的动力学由以下耦合常微分方程描述：\n$$\n\\frac{dT}{dt} \\;=\\; f_T(T, R) \\;=\\; \\alpha_T\\,\\frac{1}{1+\\left(\\frac{R}{K_{TR}}\\right)^{2}} \\;+\\; s_{12} \\;-\\; \\delta_T\\,T\n$$\n$$\n\\frac{dR}{dt} \\;=\\; f_R(T, R) \\;=\\; \\alpha_R\\,\\frac{1}{1+\\left(\\frac{T}{K_{RT}}\\right)^{2}} \\;+\\; s_{23} \\;-\\; \\delta_R\\,R\n$$\n其中$T(t)$和$R(t)$分别是两种相互抑制的转录因子T-bet和ROR$\\gamma$t的非负浓度。\n\n系统的稳态或不动点是相空间中的一个点$(T^*, R^*)$，在该点两种浓度的变化率都为零。在数学上，这对应于以下非线性代数方程组的解：\n$$\nf_T(T^*, R^*) = 0\n$$\n$$\nf_R(T^*, R^*) = 0\n$$\n这些方程定义了系统的零斜线，它们的交点即为稳态。\n\n稳态$(T^*, R^*)$的稳定性由在该点计算的雅可比矩阵$J$的特征值决定。雅可比矩阵由下式给出：\n$$\nJ(T, R) = \\begin{pmatrix} \\frac{\\partial f_T}{\\partial T} & \\frac{\\partial f_T}{\\partial R} \\\\ \\frac{\\partial f_R}{\\partial T} & \\frac{\\partial f_R}{\\partial R} \\end{pmatrix}\n$$\n计算偏导数，我们得到雅可比矩阵的元素：\n$$\n\\frac{\\partial f_T}{\\partial T} = -\\delta_T\n$$\n$$\n\\frac{\\partial f_T}{\\partial R} = \\alpha_T \\frac{d}{dR} \\left(1 + \\left(\\frac{R}{K_{TR}}\\right)^2\\right)^{-1} = -2\\alpha_T \\frac{R/K_{TR}^2}{\\left(1 + (R/K_{TR})^2\\right)^2}\n$$\n$$\n\\frac{\\partial f_R}{\\partial T} = \\alpha_R \\frac{d}{dT} \\left(1 + \\left(\\frac{T}{K_{RT}}\\right)^2\\right)^{-1} = -2\\alpha_R \\frac{T/K_{RT}^2}{\\left(1 + (T/K_{RT})^2\\right)^2}\n$$\n$$\n\\frac{\\partial f_R}{\\partial R} = -\\delta_R\n$$\n如果$J(T^*, R^*)$的所有特征值的实部均为负，则该稳态是渐近稳定的。对于一个$2 \\times 2$矩阵，这个条件等价于劳斯-赫尔维茨判据：$\\mathrm{Tr}(J) < 0$且$\\mathrm{Det}(J) > 0$。\n\n让我们首先检查雅可比矩阵的迹：\n$$\n\\mathrm{Tr}(J) = \\frac{\\partial f_T}{\\partial T} + \\frac{\\partial f_R}{\\partial R} = -\\delta_T - \\delta_R\n$$\n根据问题陈述，所有降解率$\\delta_T$和$\\delta_R$都是严格为正的。因此，对于相空间中的任何点$(T, R)$，$\\mathrm{Tr}(J)$始终为负。这带来一个重要的推论：根据Bendixson-Dulac定理，该系统不能表现出周期轨道（极限环）。所有轨迹都必须收敛到一个稳态。\n\n在保证$\\mathrm{Tr}(J) < 0$的情况下，渐近稳定性的条件简化为要求雅可比矩阵的行列式为正：\n$$\n\\mathrm{Det}(J) = (-\\delta_T)(-\\delta_R) - \\left(\\frac{\\partial f_T}{\\partial R}\\right)\\left(\\frac{\\partial f_R}{\\partial T}\\right) > 0\n$$\n代入偏导数的表达式，稳态$(T^*, R^*)$处的稳定性条件变为：\n$$\n\\mathrm{Det}(J) = \\delta_T \\delta_R - 4\\alpha_T \\alpha_R \\frac{R^*/K_{TR}^2}{\\left(1 + (R^*/K_{TR})^2\\right)^2} \\frac{T^*/K_{RT}^2}{\\left(1 + (T^*/K_{RT})^2\\right)^2} > 0\n$$\n通常情况下，解析地求解稳态方程组是不可行的。因此，我们将采用一种稳健的数值方法。所有轨迹都收敛到稳态这一基本性质使我们能够通过从大量初始条件模拟系统来找到所有稳定稳态（吸引子）。\n\n数值计算的步骤如下：\n$1$. 对于六个参数集中的每一个，我们定义相应的ODE系统。\n$2$. 我们建立一个初始条件$(T_0, R_0)$的网格，该网格覆盖了相空间非负象限的一个相关部分。该区域的选择要大于可能的最大稳态值，其上界可由$\\max(T) \\le \\alpha_T/\\delta_T + s_{12}/\\delta_T$和$\\max(R) \\le \\alpha_R/\\delta_R + s_{23}/\\delta_R$来估计。\n$3$. 对于每个初始条件，我们使用高精度求解器（`scipy.integrate.solve_ivp`）对ODE系统进行足够长时间的数值积分，以确保其收敛到一个稳态。\n$4$. 收集所有轨迹的最终状态。然后，我们通过欧几里得距离（使用一个小的容差，例如$10^{-4}$）对它们进行聚类，以识别出唯一的最终状态。这些唯一的最终状态是我们的候选稳定稳态。\n$5$. 对每个候选状态，我们执行两个验证步骤：首先，通过确认该点的矢量场$(dT/dt, dR/dt)$在数值上接近于零，来证实它是一个真正的稳态。其次，通过计算雅可比矩阵的行列式并确保其为正，来确认其稳定性。\n$6$. 满足这两个验证条件的唯一状态的数量，即为给定参数集的渐近稳定稳态的最终计数。\n\n这种方法是可靠的，因为稳定稳态的吸引盆将捕获从初始点网格出发的轨迹，而我们基于雅可比行列式的稳定性条件既是必要的也是充分的。此过程在所提供的Python代码中实现，以计算所有六个测试用例的结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves for the number of asymptotically stable steady states for six\n    different parameter sets of a genetic toggle switch model.\n    \"\"\"\n\n    test_cases = [\n        # (alpha_T, alpha_R, K_TR, K_RT, delta_T, delta_R, s_12, s_23)\n        (3.0, 3.0, 0.5, 0.5, 1.0, 1.0, 0.0, 0.0),  # Case 1\n        (3.0, 3.0, 0.5, 0.5, 1.0, 1.0, 1.0, 0.0),  # Case 2\n        (3.0, 3.0, 0.5, 0.5, 1.0, 1.0, 0.0, 1.0),  # Case 3\n        (0.5, 0.5, 0.5, 0.5, 1.0, 1.0, 0.0, 0.0),  # Case 4\n        (1.5, 1.5, 0.5, 0.5, 1.0, 1.0, 0.3, 0.3),  # Case 5\n        (3.0, 3.0, 0.3, 0.7, 1.0, 1.0, 0.0, 0.0),  # Case 6\n    ]\n\n    results = []\n    for params in test_cases:\n        num_stable = count_stable_states(params)\n        results.append(num_stable)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef count_stable_states(params):\n    \"\"\"\n    Counts the number of asymptotically stable steady states for a given\n    parameter set using numerical integration from a grid of initial conditions.\n    \"\"\"\n    alpha_T, alpha_R, K_TR, K_RT, delta_T, delta_R, s_12, s_23 = params\n\n    def system_ode(t, y):\n        T, R = y\n        dTdt = alpha_T / (1.0 + (R / K_TR)**2) + s_12 - delta_T * T\n        dRdt = alpha_R / (1.0 + (T / K_RT)**2) + s_23 - delta_R * R\n        return [dTdt, dRdt]\n\n    def jacobian_determinant(y):\n        T, R = y\n        # Off-diagonal elements of the Jacobian\n        # d(dT/dt)/dR\n        J_TR = -2.0 * alpha_T * (R / K_TR**2) / (1.0 + (R / K_TR)**2)**2\n        # d(dR/dt)/dT\n        J_RT = -2.0 * alpha_R * (T / K_RT**2) / (1.0 + (T / K_RT)**2)**2\n        \n        # Determinant = J_TT * J_RR - J_TR * J_RT\n        # J_TT = -delta_T, J_RR = -delta_R\n        det_J = (-delta_T) * (-delta_R) - J_TR * J_RT\n        return det_J\n\n    # Define a sufficiently large phase space to explore\n    max_T = alpha_T / delta_T + s_12 / delta_T + 2.0\n    max_R = alpha_R / delta_R + s_23 / delta_R + 2.0\n    \n    # Generate a grid of initial conditions\n    grid_size = 20\n    T_initials = np.linspace(0, max_T, grid_size)\n    R_initials = np.linspace(0, max_R, grid_size)\n    \n    t_span = (0, 200) # Integration time sufficient for convergence\n    \n    converged_points = []\n    for T0 in T_initials:\n        for R0 in R_initials:\n            y0 = [T0, R0]\n            # Integrate the ODEs until they converge\n            sol = solve_ivp(\n                system_ode, t_span, y0, method='RK45', atol=1e-9, rtol=1e-9\n            )\n            final_state = sol.y[:, -1]\n            converged_points.append(final_state)\n\n    stable_states = []\n    tolerance = 1e-4\n\n    for point in converged_points:\n        # Check if this point corresponds to a new steady state\n        is_new = True\n        for state in stable_states:\n            if np.linalg.norm(point - state) < tolerance:\n                is_new = False\n                break\n        \n        if is_new:\n            # Verify it is a steady state (derivatives are close to zero)\n            derivatives = system_ode(0, point)\n            if np.linalg.norm(derivatives) < 1e-6:\n                # Verify stability (Jacobian determinant is positive)\n                # The trace is always negative, so this is sufficient.\n                if jacobian_determinant(point) > 0:\n                    stable_states.append(point)\n\n    return len(stable_states)\n\nsolve()\n```", "id": "2863251"}]}