{"hands_on_practices": [{"introduction": "为了被细胞毒性T细胞识别，受感染的细胞必须在主要组织相容性复合体I类 (MHC I) 分子上呈递病毒肽。许多病毒已经进化出破坏这一抗原呈递途径的机制。本练习将挑战你建立一个简单的动力学模型，以量化病毒抑制剂如何通过靶向TAP转运体来减少病毒抗原的表面呈递，从而使病毒能够躲避T细胞的监视。[@problem_id:2879485]", "problem": "一种胞质病毒蛋白被加工成肽，这些肽可以呈递在I类主要组织相容性复合物（MHC I）上，以供细胞毒性T淋巴细胞识别。考虑一个最小化的、充分混合的模型，其中蛋白酶体在胞质中以恒定速率 $\\lambda$（单位时间内产生的肽数量）生成抗原肽。肽由抗原加工相关转运体（TAP）转运至内质网（ER），其有效转运参数为 $t$（无量纲，表示单位时间内成功递送的生成肽的比例）。在内质网中，假设肽负载到MHC I上的过程是迅速的且非限速的，因此每个成功转运的肽都恰好产生一个肽-MHC I复合物。已负载的复合物通过一个有效的一级过程从内质网区室中损失（通过输出和净周转），其速率常数为 $\\delta$（单位时间分之一），该常数综合了所有从内质网中移除肽-MHC I复合物的过程。\n\n一种病毒抑制剂特异性地降低了TAP的功能，使得有效转运参数按因子 $\\theta$（$0  \\theta  1$）进行缩放，而所有其他过程保持不变。假设空的MHC I和分子伴侣是大大过量的，因此肽的供应和转运是形成肽-MHC I复合物的唯一限制因素，并忽略肽的编辑和解离过程。\n\n在这些假设下，从通量守恒（稳态时负载复合物的流入量等于流出量）和一级损失动力学出发，推导内质网中肽-MHC I复合物稳态数量的闭式解析表达式，用 $\\lambda$、$t$、$\\delta$ 和 $\\theta$ 表示。将您的答案以符号形式表示为 $\\lambda$、$t$、$\\delta$ 和 $\\theta$ 的函数。", "solution": "该问题要求推导内质网（ER）中肽-I类主要组织相容性复合物（MHC I）稳态数量的表达式。我将首先验证问题陈述。\n\n步骤1：提取已知条件\n- `$\\lambda$`: 胞质中抗原肽生成的恒定速率（肽数/时间）。\n- `$t$`: 抗原加工相关转运体（TAP）的有效转运参数，一个无量纲分数。\n- `$\\delta$`: 从内质网中损失已负载MHC I复合物的一级速率常数（1/时间）。\n- `$\\theta$`: 由于病毒抑制剂导致的TAP功能无量纲缩放因子，满足 `$0  \\theta  1$`。\n- 条件：问题需要在稳态下求解，此时复合物的流入量等于流出量。\n- 假设1：肽负载到MHC I上的过程是迅速的且非限速的。\n- 假设2：每个成功转运的肽都恰好产生一个肽-MHC I复合物。\n- 假设3：已负载复合物的损失是一个一级过程。\n- 假设4：空的MHC I和分子伴侣是大大过量的。\n- 假设5：肽的供应和转运是唯一的限制因素。\n- 假设6：肽的编辑和解离过程被忽略。\n\n步骤2：使用提取的已知条件进行验证\n该问题描述了一个简化的但符合动力学标准的抗原呈递模型。参数定义清晰，其量纲一致。`$\\lambda$` 的单位是 [数量]/[时间]。`$t$` 和 `$\\theta$` 是无量纲的效率。`$\\delta$` 的单位是 [1]/[时间]。目标是求出复合物的稳态数量，这将是一个代表计数的无量纲量。形成速率为 `$\\lambda t \\theta$`，单位为 [数量]/[时间]。损失速率为 `$\\delta N$`，其中 `$N$` 是复合物的数量，其单位也为 [数量]/[时间]。物理和数学设置是自洽且一致的。这些假设虽然是理想化的，但对于创建一个易于处理的模型是标准的，并且没有引入科学谬误。在数学免疫学的背景下，该问题是适定的、客观的且有科学依据的。\n\n步骤3：结论与行动\n问题有效。将推导解答。\n\n令 `$N_{ss}$` 代表稳态时内质网中肽-MHC I复合物的数量。问题要求从稳态时的通量守恒原理出发，该原理规定了这些复合物的生成速率必须等于其移除速率。\n\n我们必须首先构建生成速率（流入）的表达式。\n胞质中肽的生成速率为 `$\\lambda$`。\n这些肽由TAP转运至内质网。正常的转运效率由无量纲参数 `$t$` 给出。病毒抑制剂将此效率降低了一个因子 `$\\theta$`。\n因此，受抑制剂影响的转运效率是乘积 `$t\\theta$`。\n肽成功转运至内质网的速率是生成速率与有效转运效率的乘积：`$\\lambda t \\theta$`。\n根据问题陈述，肽负载是迅速的，并且每个转运的肽都恰好产生一个肽-MHC I复合物。因此，肽-MHC I复合物的生成速率等于肽的转运速率。\n$$\n\\text{生成速率} = \\lambda t \\theta\n$$\n\n接下来，我们构建损失速率（流出）的表达式。\n问题陈述，已负载复合物从内质网的损失是一个一级过程，其速率常数为 `$\\delta$`。对于一级过程，损失速率与存在的物质数量成正比。在这种情况下，该数量是复合物的数量 `$N_{ss}$`。\n因此，肽-MHC I复合物的损失速率为：\n$$\n\\text{损失速率} = \\delta N_{ss}\n$$\n\n在稳态下，系统不随时间变化，这意味着生成速率必须与损失速率相平衡。\n$$\n\\text{生成速率} = \\text{损失速率}\n$$\n代入上面推导出的表达式，我们得到平衡方程：\n$$\n\\lambda t \\theta = \\delta N_{ss}\n$$\n\n最后一步是解这个代数方程，求出 `$N_{ss}$`，即肽-MHC I复合物的稳态数量。通过重新整理各项，我们分离出 `$N_{ss}$`。\n$$\nN_{ss} = \\frac{\\lambda t \\theta}{\\delta}\n$$\n该表达式按要求给出了复合物的稳态数量，表示为给定参数 `$\\lambda$`、`$t$`、`$\\theta$` 和 `$\\delta$` 的函数。", "answer": "$$\\boxed{\\frac{\\lambda t \\theta}{\\delta}}$$", "id": "2879485"}, {"introduction": "I型干扰素反应是抗病毒先天免疫的基石，但其信号通路同时包含冗余和瓶颈。这为病毒拮抗剂创造了一个复杂的博弈环境。本问题要求你运用通路逻辑，比较两种不同的病毒策略——一种靶向冗余的激酶，另一种靶向非冗余的核输入步骤——以判断哪种策略能更有效地关闭宿主的抗病毒程序。[@problem_id:2879459]", "problem": "感染人类成纤维细胞的病毒面临着一种先天免疫系统，其中胞质模式识别受体信号通路汇集于接头蛋白，这些接头蛋白招募并激活TANK结合激酶1 (TBK1)，以磷酸化干扰素调节因子3 (IRF3)，从而使IRF3能够二聚化并易位至细胞核。在大多数非浆细胞样树突状细胞中，基础干扰素调节因子7 (IRF7)的水平很低，因此第一波I型干扰素的产生主要依赖于IRF3。通过干扰素-α/β受体的自分泌I型干扰素信号传导驱动Janus激酶(JAK)和信号转导与转录激活子(STAT)的活化，形成干扰素刺激基因因子3 (ISGF3)复合物(STAT1/STAT2/IRF9)，该复合物会放大干扰素刺激基因(ISGs)的表达。在这种细胞类型中，诸如干扰素基因刺激蛋白(STING)、线粒体抗病毒信号蛋白(MAVS)和含TIR结构域的接头蛋白诱导干扰素-β (TRIF)等接头蛋白，其拷贝数相对于上游受体和下游激酶来说较低，因此接头蛋白的可用性限制了信号的通量。\n\n该病毒可以编码两种拮抗剂中的一种：\n- 拮抗剂X与TBK1结合，阻止其在Ser172位点的活化环磷酸化，但不会降解TBK1或接头蛋白。\n- 拮抗剂Y与核转运蛋白-β(importin-β)结合，特异性地阻止磷酸化的IRF3二聚体进入细胞核，而不影响NF-κB或丝裂原活化蛋白激酶通路。\n\n假设以下基本事实：\n- 在IRF3磷酸化水平上存在激酶冗余（当有适当的支架蛋白时，核因子kappa-B激酶抑制剂的激酶epsilon，IKKε，可以磷酸化IRF3），而IRF3二聚体的核输入对于IRF3依赖的转录是必需的。\n- 在缺乏核内IRF3的情况下，仅激活NF-κB不足以驱动干扰素-β的转录。\n- 在接头蛋白受限的条件下，任何能够磷酸化IRF3的残留激酶仍必须通过与接头蛋白相关的复合物进行招募或搭建支架，但即使是少量进入细胞核的IRF3二聚体也足以启动自分泌干扰素的放大环路。\n\n当接头蛋白丰度受限时，以下哪个陈述最好地对比了这两种病毒策略的后果，并正确推断出哪种策略能更有效地抑制全局ISG的诱导？\n\nA. 抑制TBK1磷酸化会更有效，因为它能阻止所有接头蛋白平台上的IRF3和IRF7的活化，从而完全消除I型干扰素，不受接头蛋白限制的影响。\n\nB. 抑制IRF3核转运会更有效，因为它绕过了激酶水平的冗余（TBK1和IKKε），同时阻断了最初的干扰素-β波和干扰素受体介导的放大环路，这在接头蛋白丰度受限时尤为关键。\n\nC. 这两种干预措施在抑制ISGs方面的效果基本相同，因为它们位于单一的线性通路中，因此在任何接头蛋白丰度下，它们对产出的削减程度都一样。\n\nD. 当接头蛋白丰度受限时，限速步骤位于上游，因此像阻断IRF3核输入这样的下游扰动影响甚微；因此，抑制TBK1磷酸化在抑制ISGs方面更为优越。\n\nE. 阻断TBK1磷酸化保留了NF-κB的活化，使得干扰素-β的转录得以进行；因此，它不如阻断IRF3核转运有效。", "solution": "在进行求解之前，对问题陈述的有效性进行严格评估。\n\n### 步骤1：提取已知条件\n- **细胞背景**：人类成纤维细胞。\n- **信号通路**：胞质模式识别受体信号通路汇集于接头蛋白，这些接头蛋白招募并激活TANK结合激酶1 (TBK1)。\n- **TBK1功能**：磷酸化干扰素调节因子3 (IRF3)。\n- **IRF3活化**：磷酸化使IRF3能够二聚化并易位至细胞核。\n- **初始干扰素波**：由于基础干扰素调节因子7 (IRF7)水平低，主要依赖于IRF3。\n- **放大环路**：通过干扰素-α/β受体的自分泌I型干扰素信号传导激活Janus激酶(JAK)和信号转导与转录激活子(STAT)，形成干扰素刺激基因因子3 (ISGF3)复合物(STAT1/STAT2/IRF9)。\n- **ISGF3功能**：放大干扰素刺激基因(ISGs)的表达。\n- **限速步骤**：接头蛋白（干扰素基因刺激蛋白(STING)、线粒体抗病毒信号蛋白(MAVS)、含TIR结构域的接头蛋白诱导干扰素-β(TRIF))拷贝数低，使得接头蛋白的可用性限制了信号通量。\n- **拮抗剂X**：与TBK1结合，阻止其在Ser172位点的活化环磷酸化。不降解TBK1或接头蛋白。\n- **拮抗剂Y**：与核转运蛋白-β结合，特异性地阻止磷酸化的IRF3二聚体进入细胞核。不影响NF-κB或丝裂原活化蛋白激酶通路。\n- **基本事实1**：存在激酶冗余；当有支架时，核因子kappa-B激酶抑制剂的激酶epsilon (IKKε)也可以磷酸化IRF3。\n- **基本事实2**：IRF3二聚体的核输入对于IRF3依赖的转录是必需的。\n- **基本事实3**：在没有核内IRF3的情况下，仅NF-κB活化不足以驱动干扰素-β的转录。\n- **基本事实4**：即使是少量的核内IRF3二聚体也可以启动自分泌干扰素放大环路。\n\n### 步骤2：使用提取的已知条件进行验证\n问题陈述描述了一个详细但简化的免疫信号场景。\n- **科学依据**：所描述的通路——从PRR识别到TBK1/IKKε活化、IRF3磷酸化、干扰素-β产生，以及JAK-STAT放大——是先天抗病毒免疫的基石。所提及的所有蛋白质（TBK1、 IRF3、 STING、 MAVS、 TRIF、 IKKε、 STATs等）的作用与已确立的分子免疫学知识一致。病毒拮抗剂靶向此通路中特定节点的概念是病毒学的核心主题。\n- **问题定义明确**：问题在特定的生物物理约束（接头蛋白浓度受限）下，对两种不同的病毒策略进行了清晰的比较。提供的基本事实为推导出关于两种策略相对功效的唯一且有意义的答案提供了必要的规则。\n- **客观性**：语言精确且专业。所有陈述在问题背景下均作为事实呈现，没有主观性或模糊性。\n\n### 步骤3：结论与行动\n问题有效。这是一个结构良好、科学合理的题目，考验对信号通路逻辑、冗余性和限速步骤的理解。将推导解答。\n\n### 解题推导\n核心任务是，在接头蛋白是限制性资源这一关键条件下，比较两种病毒拮抗剂X和Y在抑制宿主干扰素反应方面的功效。\n\n初始I型干扰素反应的通路可概括如下：\n1. 病毒检测 → 接头蛋白支架形成 (STING/MAVS/TRIF)\n2. 接头蛋白支架形成 → 激酶（TBK1或IKKε）的招募与活化\n3. 激酶活化 → IRF3磷酸化\n4. IRF3磷酸化 → IRF3二聚化\n5. IRF3二聚化 → 通过核转运蛋白-β进入细胞核\n6. 核内IRF3 → 初始干扰素-β (IFN-β)的转录\n7. IFN-β分泌 → 通过IFNAR的自分泌信号\n8. IFNAR信号 → JAK/STAT活化 → ISGF3形成\n9. ISGF3形成 → 干扰素刺激基因(ISGs)的大量转录\n\n让我们在此背景下分析这两种拮抗剂。\n\n**拮抗剂X的分析：**\n拮抗剂X抑制TBK1的活化。然而，问题明确指出存在激酶冗余：当有适当支架时，IKKε也可以磷酸化IRF3。由于拮抗剂X对TBK1具有特异性，它使得IKKε介导的通路保持完整。因为接头蛋白是受限的，所以只能形成少量的信号复合物。这些复合物中任何招募IKKε（而非TBK1或除TBK1外还招募IKKε）的复合物都将能够磷酸化IRF3。问题指出，即使是少量到达细胞核的磷酸化IRF3二聚体也足以启动强大的正反馈放大环路。因此，由拮抗剂X提供的抑制作用由于激酶冗余而存在“泄漏”，而这种泄漏足以触发全面的反应。\n\n**拮抗剂Y的分析：**\n拮抗剂Y抑制磷酸化的IRF3二聚体进入细胞核。这一步发生在IRF3磷酸化之后。关键的是，问题指出这一步对于IRF3依赖的转录是*必需的*，并且没有提到该输入机制存在冗余。这意味着拮抗剂Y造成了一个完全的瓶颈。无论IRF3是由TBK1还是由冗余的激酶IKKε磷酸化的，其产生的磷酸化IRF3二聚体都无法进入细胞核。通过阻止IRF3进入细胞核，拮抗剂Y完全阻止了IFN-β的初始转录。如果初始的IFN-β波不存在，那么涉及ISGF3和全局ISG诱导的整个放大环路就无法启动。\n\n**比较与结论：**\n拮抗剂Y靶向通路中一个下游的、非冗余的、必需的步骤。这为整个干扰素反应提供了一个完全而有力的阻断。拮抗剂X靶向一个存在冗余机制的步骤，使其阻断作用天生就是不完全或“泄漏”的。鉴于即使微小的信号也可能被大规模放大，一个有泄漏的抑制剂远不如一个完全的抑制剂有效。因此，阻断IRF3核输入（拮抗剂Y）的策略在抑制全局ISG诱导方面比阻断TBK1活化（拮抗剂X）更有效，尤其是在接头蛋白受限的特定条件下。\n\n### 逐项分析\n\n**A. 抑制TBK1磷酸化会更有效，因为它能阻止所有接头蛋白平台上的IRF3和IRF7的活化，从而完全消除I型干扰素，不受接头蛋白限制的影响。**\n该陈述不正确。它没有考虑到与IKKε的指定激酶冗余，后者仍然可以磷酸化IRF3以及后续的IRF7。因此，抑制不是“完全”的。声称“不受接头蛋白限制的影响”也与问题的重点相悖。\n\n**结论：不正确**\n\n**B. 抑制IRF3核转运会更有效，因为它绕过了激酶水平的冗余（TBK1和IKKε），同时阻断了最初的干扰素-β波和干扰素受体介导的放大环路，这在接头蛋白丰度受限时尤为关键。**\n该陈述正确。它精确地指出了拮抗剂Y机制的关键优势：它靶向冗余激酶下游的一个单一、必要的步骤，从而造成完全的阻断。它正确地将阻止初始波与阻止放大环路联系起来，并正确地指出，当一个微弱的初始信号（由于接头蛋白受限）仍然可以被放大时，一个完全的阻断尤为重要。\n\n**结论：正确**\n\n**C. 这两种干预措施在抑制ISGs方面的效果基本相同，因为它们位于单一的线性通路中，因此在任何接头蛋白丰度下，它们对产出的削减程度都一样。**\n该陈述不正确。由于IKKε的并行、冗余的激酶活性，该通路并非“单一线性”的。因为一个干预措施靶向冗余步骤，而另一个靶向非冗余步骤，所以它们的效果并不等同。\n\n**结论：不正确**\n\n**D. 当接头蛋白丰度受限时，限速步骤位于上游，因此像阻断IRF3核输入这样的下游扰动影响甚微；因此，抑制TBK1磷酸化在抑制ISGs方面更为优越。**\n该陈述显示出有缺陷的逻辑。虽然接头蛋白浓度限制了信号传导的*最大速率*，但这并不会使下游抑制失效。恰恰相反，因为放大环路可由非常微弱的信号触发，在下游瓶颈处进行完全阻断是防止任何信号启动此放大的*最*有效策略。关于扰动“影响甚微”的结论是错误的。\n\n**结论：不正确**\n\n**E. 阻断TBK1磷酸化保留了NF-κB的活化，使得干扰素-β的转录得以进行；因此，它不如阻断IRF3核转运有效。**\n该陈述包含错误的推理。虽然“不如...有效”的结论是正确的，但给出的理由是错误的。问题明确指出，“在缺乏核内IRF3的情况下，仅激活NF-κB不足以驱动干扰素-β的转录”。由于两种拮抗剂都会导致核内IRF3的缺失（Y是完全缺失，X是大部分缺失），因此NF-κB是否被激活与此情境下的IFN-β转录无关。功效差异的核心原因是激酶冗余，而不是NF-κB的状态。\n\n**结论：不正确**", "answer": "$$\\boxed{B}$$", "id": "2879459"}, {"introduction": "一些病原体，如布氏锥虫 (Trypanosoma brucei)，并不直接对抗免疫系统，而是通过不断更换其表面抗原来逃避免疫识别。这场动态的“猫鼠游戏”可以被建模为随机事件之间的竞争：寄生虫“创新”出新抗原与宿主“清除”现有抗原的竞争。这最后一个练习将挑战你从第一性原理出发，推导免疫逃逸的期望时间，并实现一个计算模型，以探索抗原库大小、转换速率和清除速率等因素如何决定这场进化竞赛的结果。[@problem_id:2879483]", "problem": "要求您将一个抗原变异的生物学场景转化为一个可定量精确检验的计算。在原生动物寄生虫布氏锥虫（Trypanosoma brucei）中，免疫逃避是通过在变异表面糖蛋白（Variant Surface Glycoprotein, VSG）基因之间进行切换来介导的。假设存在一个大小为$N$的变异表面糖蛋白（VSG）基因库，其中包含可能的抗原性不同基因；基因转换率为每个谱系每天$\\gamma$，该转换会产生切换尝试；对于表达已识别VSG的谱系，免疫清除率为每个谱系每天$c$。此处，一个已识别谱系指当前表达的VSG曾暴露于免疫系统的寄生虫；此类谱系以速率$c$被清除。一次切换尝试产生一个新的、未被识别的VSG的概率等于剩余未使用VSG的比例，若已有一个VSG在使用中，则初始时该概率为$(N-1)/N$。将早期动态建模为关于已识别谱系数量的线性出生-死亡-创新过程，其中“出生”事件对应于成功的创新（出现一个表达先前未使用VSG的谱系），“死亡”事件对应于已识别谱系的免疫清除。从时间$t=0$时的一个已识别谱系开始。\n\n仅使用以下基本依据：\n- 抗原切换和免疫清除事件可以建模为独立的泊松过程，在小的时间间隔内具有恒定的风险率（无记忆性）。\n- 在线性出生-死亡过程中，若每个谱系的出生率为$b$，每个谱系的死亡率为$d$，则从一个谱系的初始种群开始，到第一个事件（出生或死亡）发生的时间服从速率为$b + d$的指数分布。\n\n将免疫逃逸时间$T$定义为到第一次成功创新事件发生为止的时间（即，一个表达先前未使用VSG的谱系出现的瞬间）。如果初始谱系的免疫清除发生在任何创新之前，则免疫逃逸永不发生，并且对于这些轨迹，其对无条件期望免疫逃逸时间的贡献计为$0$。假设基因库足够大，以至于单次成功创新所造成的消耗在第一次逃逸事件发生前不会产生反馈影响；因此，在初始时，每个谱系的创新风险率为$b = \\gamma \\cdot \\frac{N-1}{N}$，每个谱系的清除风险率为$d = c$。\n\n任务：\n- 从第一性原理出发，推导无条件期望免疫逃逸时间$\\mathbb{E}[T]$（以天为单位）的显式表达式，该表达式仅用$N$、$\\gamma$和$c$表示。除上述内容外，不要假设任何额外的模型结构，并确保您的推导明确了无记忆性和全期望定律的作用。\n- 实现一个程序，为一组固定的参数集计算$\\mathbb{E}[T]$。所有速率单位均为每天，最终答案必须以浮点数形式给出，单位为天。\n\n测试集（每个三元组为$(N, \\gamma, c)$，其中$N$无单位，$\\gamma$和$c$的单位为$\\text{day}^{-1}$）：\n- Case A: $(N, \\gamma, c) = (1000, 0.02, 0.1)$\n- Case B: $(N, \\gamma, c) = (1, 0.1, 0.1)$\n- Case C: $(N, \\gamma, c) = (100, 0.0, 0.5)$\n- Case D: $(N, \\gamma, c) = (100, 0.5, 0.0)$\n- Case E: $(N, \\gamma, c) = (50, 0.05, 0.5)$\n- Case F: $(N, \\gamma, c) = (1000, 0.5, 5.0)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容为计算结果，顺序与测试集相同。每个条目都是计算出的$\\mathbb{E}[T]$（以天为单位），格式化为小数点后恰好有六位数字的浮点数。例如，一个有效的输出格式是$[x_1,x_2,x_3,x_4,x_5,x_6]$，其中每个$x_i$是小数点后有六位数字的浮点数。", "solution": "问题陈述已经过评估，并被确定为有效。它具有科学依据，内容自洽，且定量精确。它描述了两个随机过程之间的经典竞争，并将其置于生物学相关背景下。因此，我们可以进行严谨的推导。\n\n系统在时间$t=0$时始于一个已识别的寄生虫谱系。该谱系受到两个独立的、相互竞争的随机事件的影响，这些事件被建模为泊松过程：\n$1$. **成功创新（出生）：** 寄生虫切换到一个新的、未被识别的变异表面糖蛋白（VSG）。此事件对应于免疫逃逸。该事件的每个谱系发生率被指定为$b$。\n$2$. **免疫清除（死亡）：** 现有的已识别谱系被宿主免疫系统摧毁。该事件的每个谱系发生率被指定为$d$。\n\n问题提供了定义这些速率的参数。切换尝试的速率是$\\gamma$。一次切换成功（即产生一个新的VSG）的概率是大小为$N$的基因库中未使用VSG的比例。在当前有一个VSG被使用的情况下，这个概率是$\\frac{N-1}{N}$。此处做一个简化假设，即对于第一个事件，该概率保持不变。因此，成功创新的有效速率是：\n$$b = \\gamma \\cdot \\frac{N-1}{N}$$\n对于一个已识别谱系，免疫清除的速率直接由$c$给出。因此：\n$$d = c$$\n\n设$T_b$是到第一次创新事件发生时间的随机变量，$T_d$是到第一次清除事件发生时间的随机变量。根据泊松过程的假设，两者都是独立的，且服从指数分布：\n- $T_b \\sim \\text{Exponential}(b)$\n- $T_d \\sim \\text{Exponential}(d)$\n\n免疫逃逸时间$T$被定义为第一次成功创新的发生时间。然而，一个关键条件被施加：如果清除发生在创新之前（$T_d  T_b$），则该轨迹不会导致免疫逃逸，其对无条件期望时间$\\mathbb{E}[T]$的贡献被定义为$0$。这意味着我们要计算一个随机变量$T_{eff}$的期望，其定义如下：\n$$\nT_{eff} =\n\\begin{cases}\nT_b  \\text{if } T_b \\leq T_d \\\\\n0  \\text{if } T_d  T_b\n\\end{cases}\n$$\n我们寻求$\\mathbb{E}[T_{eff}]$。使用全期望定律，我们可以写出：\n$$\\mathbb{E}[T_{eff}] = \\mathbb{E}[T_{eff} | T_b \\leq T_d] P(T_b \\leq T_d) + \\mathbb{E}[T_{eff} | T_d  T_b] P(T_d  T_b)$$\n根据$T_{eff}$的定义：\n- 如果$T_d  T_b$，那么$T_{eff} = 0$，所以其期望为$\\mathbb{E}[0] = 0$。第二项消失。\n- 如果$T_b \\leq T_d$，那么$T_{eff} = T_b$。\n\n因此，表达式简化为：\n$$\\mathbb{E}[T_{eff}] = \\mathbb{E}[T_b | T_b \\leq T_d] P(T_b \\leq T_d)$$\n\n我们接下来计算这个乘积的两个部分。\n\n首先，概率$P(T_b \\leq T_d)$是一个速率为$b$的指数随机变量小于或等于一个速率为$d$的独立指数随机变量的概率。这是竞争指数分布的一个标准结果：\n$$P(T_b \\leq T_d) = \\frac{b}{b+d}$$\n这个项代表了谱系在被清除前成功创新的概率。\n\n其次，我们必须求出条件期望$\\mathbb{E}[T_b | T_b \\leq T_d]$。令$T_{min} = \\min(T_b, T_d)$为第一个事件发生的时间，不管是哪个事件。由于独立指数随机变量的性质，$T_{min}$也服从指数分布，其速率等于各个速率之和：\n$$T_{min} \\sim \\text{Exponential}(b+d)$$\n因此，到这个首个事件发生的期望时间是$\\mathbb{E}[T_{min}] = \\frac{1}{b+d}$。\n指数分布无记忆性的一个基本推论是，第一个事件发生的时间$T_{min}$与哪个事件先发生（即是$T_b \\leq T_d$还是$T_d  T_b$）是独立的。\n在条件$T_b \\leq T_d$下，创新时间$T_b$恰好就是第一个事件发生的时间$T_{min}$。因此：\n$$\\mathbb{E}[T_b | T_b \\leq T_d] = \\mathbb{E}[T_{min} | T_b \\leq T_d]$$\n由于第一个事件的发生时间与事件的类型是独立的，因此对事件类型的条件化不会改变对时间的期望：\n$$\\mathbb{E}[T_{min} | T_b \\leq T_d] = \\mathbb{E}[T_{min}] = \\frac{1}{b+d}$$\n这是在逃逸发生的前提下，到逃逸的条件期望时间。\n\n最后，我们结合这些部分，求出问题所定义的无条件期望。问题将此量称为$\\mathbb{E}[T]$，因此我们采纳该记法。\n$$\\mathbb{E}[T] = \\left(\\frac{1}{b+d}\\right) \\cdot \\left(\\frac{b}{b+d}\\right) = \\frac{b}{(b+d)^2}$$\n\n将$b$和$d$的表达式用给定的参数$N$、$\\gamma$和$c$代入：\n$$\\mathbb{E}[T] = \\frac{\\gamma \\frac{N-1}{N}}{\\left(\\gamma \\frac{N-1}{N} + c\\right)^2}$$\n这就是从第一性原理推导出的最终表达式。如果创新不可能（即$\\gamma=0$或$N=1$，这使得$b=0$），它正确地计算为$0$。在没有免疫清除（$c=0$）的情况下，该表达式正确地简化为$\\mathbb{E}[T] = \\frac{1}{b}$，这是到第一次创新事件的平均时间，因为此时逃逸是必然发生的。该公式是稳健的，并概括了所指定的动态过程。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the unconditional expected immune escape time for a series of test cases.\n    \"\"\"\n    # Test suite: each tuple is (N, gamma, c)\n    # N: size of VSG archive (unitless)\n    # gamma: gene conversion rate (per day)\n    # c: immune clearance rate (per day)\n    test_cases = [\n        (1000, 0.02, 0.1),  # Case A\n        (1, 0.1, 0.1),      # Case B\n        (100, 0.0, 0.5),    # Case C\n        (100, 0.5, 0.0),    # Case D\n        (50, 0.05, 0.5),    # Case E\n        (1000, 0.5, 5.0),   # Case F\n    ]\n\n    results = []\n    for case in test_cases:\n        N, gamma, c = case\n        \n        # Per-lineage innovation hazard (birth rate 'b').\n        # This is the product of the switching attempt rate (gamma) and the\n        # probability of choosing a novel antigen ((N-1)/N).\n        # We handle N=1, where (N-1)/N = 0, leading to b=0.\n        if N = 1:\n            b = 0.0\n        else:\n            b = gamma * (N - 1) / N\n        \n        # Per-lineage clearance hazard (death rate 'd').\n        d = c\n        \n        # The denominator of the derived formula is (b+d)^2.\n        # A denominator of zero occurs only if b=0 and d=0. In this case,\n        # the numerator b is also 0, and no event can occur. The escape\n        # probability is zero, so the expected time (as defined) is 0.\n        denominator = (b + d)**2\n        \n        if denominator == 0.0:\n            expected_time = 0.0\n        else:\n            # The derived expression for the unconditional expected immune escape time E[T]\n            # is b / (b + d)^2.\n            expected_time = b / denominator\n            \n        results.append(expected_time)\n\n    # Format the final output as a comma-separated list of floating-point numbers\n    # with six digits after the decimal point, enclosed in square brackets.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2879483"}]}