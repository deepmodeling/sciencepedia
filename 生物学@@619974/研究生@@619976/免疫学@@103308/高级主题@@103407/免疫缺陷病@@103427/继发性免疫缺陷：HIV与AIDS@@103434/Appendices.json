{"hands_on_practices": [{"introduction": "HIV-1的高突变率是其能够逃避免疫系统和产生耐药性的核心机制。本练习将引导你运用基本的概率论原理来量化这种遗传变异性。通过将基因组上的突变事件建模为一系列罕见的独立事件，你可以使用泊松分布来计算单个复制周期内预期发生的突变数量 [@problem_id:2887993]，这项技能是理解病原体演化动力学的基础。", "problem": "人类免疫缺陷病毒（HIV）通过快速产生遗传多样性以实现免疫逃避，从而部分导致了获得性免疫缺陷综合征（AIDS）。考虑人类免疫缺陷病毒1型（HIV-1）的一个复制周期，在此期间，逆转录酶将一个长度为 $9.7 \\times 10^{3}$ 个核苷酸的单链RNA基因组复制成互补DNA。设每个碱基每次复制的点突变概率为 $3 \\times 10^{-5}$，并假设不同碱基上的突变独立发生，且每个碱基在每个周期内最多发生一次突变。仅使用以下基本原理：(i) 一个周期内整个基因组的点突变总数可以建模为独立的伯努利随机变量（每个碱基一个）之和，以及 (ii) 在稀有事件、多次试验的极限情况下，此和可以通过一个泊松分布很好地近似，其均值等于伯努利均值之和，请从第一性原理推导出每个复制周期的预期点突变数以及在单个周期内发生至少一个点突变的概率。\n\n将您的最终答案以行矩阵 $\\begin{pmatrix} \\lambda & \\Pr(\\text{at least one}) \\end{pmatrix}$ 的形式报告，其中 $\\lambda$ 是预期的突变数，$\\Pr(\\text{at least one})$ 是发生至少一个点突变的概率。将您的数值答案四舍五入至 $4$ 位有效数字。将概率表示为小数（而非百分比）。无需单位。", "solution": "该问题陈述具有科学依据，提法明确且客观。提供的HIV-1基因组长度和逆转录酶错误率数据与已发表的生物学文献一致。该建模方法，即使用伯努利试验之和，并在多次试验的稀有事件情况下使用泊松分布对其进行近似，是概率论的一个标准且正确的应用。因此，该问题是有效的，并且可以按要求从第一性原理进行求解。\n\n设 $N$ 为HIV-1基因组中的核苷酸碱基数，设 $p$ 为每个碱基在每个复制周期中的点突变概率。\n给定值为：\n- 基因组长度, $N = 9.7 \\times 10^{3}$。\n- 突变概率, $p = 3 \\times 10^{-5}$。\n\n根据提供的第一条原理，我们将 $N$ 个碱基中每个碱基上突变的发生建模为一次独立的伯努利试验。设 $X_i$ 为第 $i$ 个碱基上发生突变的指示随机变量，其中 $i$ 的范围从 $1$ 到 $N$。\n如果发生突变，变量 $X_i$ 取值为 $1$，否则取值为 $0$。\n$$\nX_i = \\begin{cases} 1 & \\text{with probability } p \\\\ 0 & \\text{with probability } 1-p \\end{cases}\n$$\n单次伯努利试验 $X_i$ 的期望值由 $E[X_i] = (1 \\times p) + (0 \\times (1-p)) = p$ 给出。\n\n整个基因组的点突变总数（我们记为 $K$）是这些独立指示变量的总和：\n$$\nK = \\sum_{i=1}^{N} X_i\n$$\n第一个要推导的量是每个复制周期的预期点突变数，我们称之为 $\\lambda$。根据期望的线性性质，随机变量之和的期望等于它们各自的期望之和。\n$$\n\\lambda = E[K] = E\\left[\\sum_{i=1}^{N} X_i\\right] = \\sum_{i=1}^{N} E[X_i]\n$$\n由于对所有 $i$ 都有 $E[X_i] = p$，这可以简化为：\n$$\n\\lambda = \\sum_{i=1}^{N} p = Np\n$$\n代入给定的数值：\n$$\n\\lambda = (9.7 \\times 10^{3}) \\times (3 \\times 10^{-5}) = 29.1 \\times 10^{-2} = 0.291\n$$\n这是每个周期的预期突变数。\n\n根据提供的第二条原理，对于大量的试验（$N = 9700$ 很大）和每次试验中很小的成功概率（$p = 3 \\times 10^{-5}$ 很小），总和 $K$ 的分布（其形式上为二项分布 $B(N, p)$）可以被均值为 $\\lambda = Np$ 的泊松分布精确近似。\n因此，我们将随机变量 $K$ 建模为服从泊松分布, $K \\sim \\text{Poisson}(\\lambda)$，其中 $\\lambda = 0.291$。泊松分布的概率质量函数为：\n$$\n\\Pr(K=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}\n$$\n其中 $k$ 是事件发生的次数。\n\n第二个要推导的量是在单个周期内发生至少一个点突变的概率，$\\Pr(K \\ge 1)$。计算其互补事件的概率（即发生零次突变，$\\Pr(K=0)$）然后用 $1$ 减去这个概率，在计算上更为简单。\n$$\n\\Pr(K \\ge 1) = 1 - \\Pr(K=0)\n$$\n使用 $k=0$ 时的泊松概率质量函数：\n$$\n\\Pr(K=0) = \\frac{\\lambda^{0} \\exp(-\\lambda)}{0!} = \\frac{1 \\cdot \\exp(-\\lambda)}{1} = \\exp(-\\lambda)\n$$\n因此，发生至少一次突变的概率是：\n$$\n\\Pr(K \\ge 1) = 1 - \\exp(-\\lambda)\n$$\n代入计算出的值 $\\lambda = 0.291$：\n$$\n\\Pr(K \\ge 1) = 1 - \\exp(-0.291)\n$$\n现在我们来计算数值：\n$$\n\\exp(-0.291) \\approx 0.74751040\n$$\n$$\n\\Pr(K \\ge 1) \\approx 1 - 0.74751040 = 0.25248960\n$$\n问题要求将结果四舍五入到 $4$ 位有效数字。\n预期的突变数是 $\\lambda = 0.291$。保留 $4$ 位有效数字，即为 $0.2910$。\n发生至少一次突变的概率是 $\\Pr(K \\ge 1) \\approx 0.25248960$。保留 $4$ 位有效数字，即为 $0.2525$。\n\n最终答案需以包含这两个值的行矩阵形式报告。", "answer": "$$\\boxed{\\begin{pmatrix} 0.2910 & 0.2525 \\end{pmatrix}}$$", "id": "2887993"}, {"introduction": "准确的诊断是控制HIV感染的关键，但诊断测试并非绝对完美，其结果的解读需要一个严谨的概率框架。本练习将运用贝叶斯推断，在一个真实的临床情境下，结合检测的敏感性和特异性以及患者的先验风险，计算出阴性检测结果后的感染概率 [@problem_id:2887976]。这项实践能够锻炼循证医学中的一项关键技能：根据新证据更新判断。", "problem": "一名患者在单次高风险暴露后$21$天就诊，其人类免疫缺陷病毒 (HIV) 感染的检测前概率为 $p_{0} = 0.025$，该概率是根据一个整合了当地流行率和特定行为传播风险的暴露风险模型估算得出的。在第$21$天进行了一次第四代抗原/抗体联合免疫测定（该检测旨在检测HIV p$24$抗原和抗HIV抗体，用于早期诊断以防止病情发展为获得性免疫缺陷综合征(AIDS)），结果为阴性。在暴露后第$21$天，该检测对于此时已发生的感染具有时间依赖性灵敏度 $S_{e} = 0.93$，对未感染样本的分析特异性为 $S_{p} = 0.999$。\n\n使用贝叶斯推断，计算在第$21$天检测结果为阴性的情况下，该患者当前感染HIV的检测后概率。将答案表示为小数，并四舍五入至四位有效数字。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n步骤1：提取已知条件\n- 暴露后检测时间：$21$天\n- HIV感染的检测前概率（先验概率）：$p_{0} = P(D) = 0.025$\n- 检测类型：第四代抗原/抗体联合免疫测定\n- 检测结果：阴性\n- 第$21$天的时间依赖性灵敏度：$S_{e} = 0.93$\n- 分析特异性：$S_{p} = 0.999$\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，采用了医学诊断和贝叶斯统计的标准原理。所提供的参数（$p_{0}$、$S_{e}$、$S_{p}$）在指定的临床背景（暴露后$21$天进行第四代HIV检测）下处于合理范围内。该问题提法明确，提供了计算唯一后验概率所需的所有数据。问题是客观的，没有不一致、歧义或逻辑缺陷。\n\n步骤3：结论与行动\n该问题有效。将推导求解。\n\n任务是计算在检测结果为阴性的条件下，当前感染HIV的检测后概率。这是贝叶斯定理的直接应用。我们定义以下事件：\n- $D$：患者感染了HIV。\n- $D^c$：患者未感染HIV。\n- $T^-$：检测结果为阴性。\n- $T^+$：检测结果为阳性。\n\n根据已知条件，我们有感染的先验概率：\n$$ P(D) = p_{0} = 0.025 $$\n因此，未感染的先验概率为：\n$$ P(D^c) = 1 - P(D) = 1 - 0.025 = 0.975 $$\n\n检测的特性以灵敏度和特异性给出。\n灵敏度 $S_{e}$ 是在疾病存在的情况下检测结果为阳性的概率：\n$$ S_{e} = P(T^+|D) = 0.93 $$\n特异性 $S_{p}$ 是在疾病不存在的情况下检测结果为阴性的概率：\n$$ S_{p} = P(T^-|D^c) = 0.999 $$\n\n我们需要假阴性概率，即在疾病存在的情况下检测结果为阴性的概率。这是灵敏度的补集：\n$$ P(T^-|D) = 1 - S_{e} = 1 - 0.93 = 0.07 $$\n\n我们旨在求出在检测结果为阴性的条件下感染的后验概率，记为 $P(D|T^-)$。根据贝叶斯定理：\n$$ P(D|T^-) = \\frac{P(T^-|D) P(D)}{P(T^-)} $$\n分母 $P(T^-)$ 是获得阴性检测结果的总概率。它使用全概率公式计算：\n$$ P(T^-) = P(T^-|D) P(D) + P(T^-|D^c) P(D^c) $$\n将已知值代入此方程：\n$$ P(T^-) = (0.07)(0.025) + (0.999)(0.975) $$\n让我们计算每一项：\n第一项对应于感染者检测结果为阴性（假阴性）的情况：\n$$ P(T^-|D) P(D) = 0.07 \\times 0.025 = 0.00175 $$\n第二项对应于未感染者检测结果为阴性（真阴性）的情况：\n$$ P(T^-|D^c) P(D^c) = 0.999 \\times 0.975 = 0.974025 $$\n阴性检测的总概率是这两项之和：\n$$ P(T^-) = 0.00175 + 0.974025 = 0.975775 $$\n现在我们可以计算后验概率 $P(D|T^-)$：\n$$ P(D|T^-) = \\frac{P(T^-|D) P(D)}{P(T^-)} = \\frac{0.00175}{0.975775} $$\n进行除法运算：\n$$ P(D|T^-) \\approx 0.001793460... $$\n问题要求答案四舍五入至四位有效数字。前四位有效数字是$1$、$7$、$9$和$3$。后面的数字是$4$，小于$5$，所以我们舍去。\n$$ P(D|T^-) \\approx 0.001793 $$\n这就是在第$21$天检测结果为阴性的情况下，患者感染的检测后概率。", "answer": "$$\\boxed{0.001793}$$", "id": "2887976"}, {"introduction": "为了理解HIV感染的长期病程以及艾滋病的发病机制，我们可以使用数学模型来描述病毒与免疫系统之间的相互作用。本练习将探究一个经典的靶细胞限制模型，你将从中推导出慢性期病毒载量设定点（viral set point）的表达式，这是预测疾病进展的关键指标 [@problem_id:2888047]。通过分析该模型，你将深入了解免疫反应强度和T细胞再生等因素如何从数量上决定宿主内的长期病毒负担。", "problem": "宿主体内的人类免疫缺陷病毒 (HIV) 动力学可由一个靶细胞有限模型近似，该模型包含三个状态变量：未感染的靶CD4$^{+}$ T细胞 $T(t)$、产毒性感染细胞 $I(t)$ 和游离病毒 $V(t)$。令 $s$ 表示新靶细胞的恒定补给率，$d$ 表示未感染靶细胞的人均死亡率，$\\beta$ 表示感染率常数，$p$ 表示每个感染细胞的人均病毒粒子产生率，$c$ 表示游离病毒粒子的人均清除率。感染细胞的人均死亡率是基础病毒细胞病变效应 $\\delta_{b}$ 和归因于细胞毒性T淋巴细胞 (CTL) 介导的杀伤作用的免疫介导增量 $\\Delta$ 之和，因此总的感染细胞损失率为 $\\delta = \\delta_{b} + \\Delta$，其中 $\\Delta \\ge 0$。考虑以下系统：\n$$\n\\frac{dT}{dt} = s - d\\,T - \\beta\\,V\\,T,\\qquad\n\\frac{dI}{dt} = \\beta\\,V\\,T - \\delta\\,I,\\qquad\n\\frac{dV}{dt} = p\\,I - c\\,V.\n$$\n假设所有参数值均为严格正值，并且存在一个满足 $V^{\\ast} > 0$ 的慢性感染平衡点。将慢性感染病毒载量设定点定义为稳态值 $V^{\\ast}$。\n\n任务：\n- 仅从上述模型和定义出发，推导 $V^{\\ast}$ 的闭式表达式，使其作为靶细胞补给 $s$ 和免疫介导增量 $\\Delta$ 的显式函数，并用 $s$、$\\Delta$、$\\delta_{b}$、$\\beta$、$d$、$p$ 和 $c$ 表示。\n- 定义绝对灵敏度系数 $S_{s} = \\partial V^{\\ast} / \\partial s$ 和 $S_{\\Delta} = \\partial V^{\\ast} / \\partial \\Delta$，并用相同的参数为每个系数推导闭式表达式。\n- 以包含元素 $\\big[V^{\\ast},\\,S_{s},\\,S_{\\Delta}\\big]$ 的单行矩阵形式给出您的最终结果。将答案表示为代数表达式，不代入数值，且最终表达式中不包含单位。", "solution": "所给问题是数学生物学中动力系统分析的一个标准练习，且完全有效。它有科学依据、是适定的、客观的，并包含了得到唯一解所需的全部信息。我们将着手进行推导。\n\n该系统由以下常微分方程描述：\n$$\n\\frac{dT}{dt} = s - d\\,T - \\beta\\,V\\,T\n$$\n$$\n\\frac{dI}{dt} = \\beta\\,V\\,T - \\delta\\,I\n$$\n$$\n\\frac{dV}{dt} = p\\,I - c\\,V\n$$\n一个慢性感染平衡点，记为 $(T^{\\ast}, I^{\\ast}, V^{\\ast})$，是一个时间导数为零且 $V^{\\ast} > 0$ 的稳态解。令方程组左侧等于零，得到以下代数方程组：\n$$\ns - d\\,T^{\\ast} - \\beta\\,V^{\\ast}\\,T^{\\ast} = 0 \\quad (1)\n$$\n$$\n\\beta\\,V^{\\ast}\\,T^{\\ast} - \\delta\\,I^{\\ast} = 0 \\quad (2)\n$$\n$$\np\\,I^{\\ast} - c\\,V^{\\ast} = 0 \\quad (3)\n$$\n问题规定了存在一个 $V^{\\ast} > 0$ 的平衡点。所有参数均为严格正值。\n\n从方程 $(3)$，我们求解稳态感染细胞数量 $I^{\\ast}$，用游离病毒数量 $V^{\\ast}$ 表示：\n$$\np\\,I^{\\ast} = c\\,V^{\\ast} \\implies I^{\\ast} = \\frac{c}{p}V^{\\ast}\n$$\n因为 $p > 0$，$c > 0$ 且 $V^{\\ast} > 0$，可得 $I^{\\ast} > 0$。\n\n接下来，将 $I^{\\ast}$ 的这个表达式代入方程 $(2)$：\n$$\n\\beta\\,V^{\\ast}\\,T^{\\ast} - \\delta\\left(\\frac{c}{p}V^{\\ast}\\right) = 0\n$$\n因为 $V^{\\ast} > 0$，我们可以用 $V^{\\ast}$ 除以该方程，以求解稳态未感染靶细胞数量 $T^{\\ast}$：\n$$\n\\beta\\,T^{\\ast} - \\frac{\\delta c}{p} = 0 \\implies T^{\\ast} = \\frac{\\delta c}{\\beta p}\n$$\n现在，将定义 $\\delta = \\delta_{b} + \\Delta$ 代入 $T^{\\ast}$ 的表达式中：\n$$\nT^{\\ast} = \\frac{(\\delta_{b} + \\Delta)c}{\\beta p}\n$$\n最后，我们使用方程 $(1)$ 来找到病毒载量设定点 $V^{\\ast}$ 的表达式。我们重排方程 $(1)$ 以分离出 $V^{\\ast}$：\n$$\n\\beta\\,V^{\\ast}\\,T^{\\ast} = s - d\\,T^{\\ast} \\implies V^{\\ast} = \\frac{s - d\\,T^{\\ast}}{\\beta\\,T^{\\ast}} = \\frac{s}{\\beta T^{\\ast}} - \\frac{d}{\\beta}\n$$\n将推导出的 $T^{\\ast}$ 表达式代入这个 $V^{\\ast}$ 的方程中：\n$$\nV^{\\ast} = \\frac{s}{\\beta \\left( \\frac{(\\delta_{b} + \\Delta)c}{\\beta p} \\right)} - \\frac{d}{\\beta}\n$$\n化简第一项，得到 $V^{\\ast}$ 作为 $s$ 和 $\\Delta$ 的函数的最终表达式：\n$$\nV^{\\ast}(s, \\Delta) = \\frac{sp}{c(\\delta_{b} + \\Delta)} - \\frac{d}{\\beta}\n$$\n这是第一个要求的结果。\n\n第二个任务是推导绝对灵敏度系数 $S_{s} = \\frac{\\partial V^{\\ast}}{\\partial s}$ 和 $S_{\\Delta} = \\frac{\\partial V^{\\ast}}{\\partial \\Delta}$。\n\n为了求 $S_{s}$，我们将 $V^{\\ast}$ 对 $s$ 求导，同时保持所有其他参数为常数：\n$$\nS_{s} = \\frac{\\partial V^{\\ast}}{\\partial s} = \\frac{\\partial}{\\partial s} \\left( \\frac{sp}{c(\\delta_{b} + \\Delta)} - \\frac{d}{\\beta} \\right)\n$$\n第二项 $-\\frac{d}{\\beta}$ 关于 $s$ 是常数。其导数为：\n$$\nS_{s} = \\frac{p}{c(\\delta_{b} + \\Delta)}\n$$\n这是关于靶细胞补给率的灵敏度。\n\n为了求 $S_{\\Delta}$，我们将 $V^{\\ast}$ 对 $\\Delta$ 求导，同时保持所有其他参数为常数：\n$$\nS_{\\Delta} = \\frac{\\partial V^{\\ast}}{\\partial \\Delta} = \\frac{\\partial}{\\partial \\Delta} \\left( \\frac{sp}{c(\\delta_{b} + \\Delta)} - \\frac{d}{\\beta} \\right)\n$$\n第二项同样是常数。对于第一项，我们对 $(\\delta_{b} + \\Delta)^{-1}$ 应用链式法则或幂法则进行求导：\n$$\nS_{\\Delta} = \\frac{sp}{c} \\frac{\\partial}{\\partial \\Delta} \\left( (\\delta_{b} + \\Delta)^{-1} \\right) = \\frac{sp}{c} \\left( -1 \\cdot (\\delta_{b} + \\Delta)^{-2} \\cdot \\frac{\\partial}{\\partial \\Delta}(\\delta_{b} + \\Delta) \\right)\n$$\n由于 $\\frac{\\partial}{\\partial \\Delta}(\\delta_{b} + \\Delta) = 1$，该表达式简化为：\n$$\nS_{\\Delta} = - \\frac{sp}{c(\\delta_{b} + \\Delta)^{2}}\n$$\n这是关于免疫介导杀伤率增量的灵敏度。\n\n最终结果是由这三个推导出的表达式组成的行矩阵： $[V^{\\ast}, S_{s}, S_{\\Delta}]$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{sp}{c(\\delta_{b} + \\Delta)} - \\frac{d}{\\beta} & \\frac{p}{c(\\delta_{b} + \\Delta)} & -\\frac{sp}{c(\\delta_{b} + \\Delta)^{2}}\n\\end{pmatrix}\n}\n$$", "id": "2888047"}]}