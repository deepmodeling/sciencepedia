{"hands_on_practices": [{"introduction": "过敏反应的第一步是肥大细胞的“致敏”过程，即 IgE 抗体与细胞表面的高亲和力受体 FcεRI 结合。本练习将通过应用质量作用定律，建立一个量化模型，将环境中 IgE 的浓度 $[\\mathrm{IgE}]$ 与受体占据分数 $\\theta$ 联系起来 [@problem_id:2855073]。掌握这一基础计算，有助于我们理解细胞为响应抗原做好准备所需的阈值条件。", "problem": "一个肥大细胞在质膜上表达免疫球蛋白E (IgE) Fc区的高亲和力受体 (FcεRI)。在一个充分混合的细胞外环境中，单体免疫球蛋白E (IgE) 通过可逆反应 $\\mathrm{IgE} + R \\rightleftharpoons \\mathrm{IgE}\\!\\cdot\\!R$ 与FcεRI结合，其中$R$表示未占据的受体，$\\mathrm{IgE}\\!\\cdot\\!R$表示IgE-受体复合物。假设：\n- 结合位点是独立且相同的。\n- 细胞外IgE浓度实际上是恒定的（因结合造成的配体耗尽可忽略不计）。\n- 系统处于热力学平衡状态，其特征在于平衡解离常数$K_{D}$，定义为 $K_{D} = \\dfrac{[\\mathrm{IgE}][R]}{[\\mathrm{IgE}\\!\\cdot\\!R]}$。\n- 总受体浓度为 $R_{T} = [R] + [\\mathrm{IgE}\\!\\cdot\\!R]$。\n将占据分数定义为 $\\theta = \\dfrac{[\\mathrm{IgE}\\!\\cdot\\!R]}{R_{T}}$。\n\n仅从上述定义和假设出发，首先推导$\\theta$作为游离IgE浓度$[\\mathrm{IgE}]$和$K_{D}$的函数。当占据分数达到阈值$\\theta_{\\mathrm{th}}$，足以在膜微区内形成可交联的受体对时，称该肥大细胞已为抗原触发的交联“致敏”。取$\\theta_{\\mathrm{th}} = 0.2$（无量纲）作为操作阈值，并取$K_{D} = 5$ nM作为生理温度下生物物理上合理的值。\n\n计算达到$\\theta = \\theta_{\\mathrm{th}}$的IgE浓度$[\\mathrm{IgE}]_{\\mathrm{sens}}$。您的最终答案以纳摩尔（nM）表示，并四舍五入到四位有效数字。最终答案仅提供对应nM的数值。", "solution": "问题陈述已经过审查，并被认为是有效的。这是一个基于受体-配体结合动力学基本原理的、科学上合理且适定的问题。我将开始解题。\n\n该任务由两部分组成：首先，推导受体占据分数$\\theta$作为游离免疫球蛋白E浓度$[\\mathrm{IgE}]$和平衡解离常数$K_{D}$的函数；其次，计算达到阈值占据率$\\theta_{\\mathrm{th}}$所需的特定浓度$[\\mathrm{IgE}]_{\\mathrm{sens}}$。\n\n占据分数$\\theta$定义为已占据受体浓度$[\\mathrm{IgE}\\!\\cdot\\!R]$与总受体浓度$R_{T}$的比率：\n$$ \\theta = \\frac{[\\mathrm{IgE}\\!\\cdot\\!R]}{R_{T}} $$\n总受体浓度$R_{T}$是游离（未占据）受体浓度$[R]$和已占据受体浓度$[\\mathrm{IgE}\\!\\cdot\\!R]$之和：\n$$ R_{T} = [R] + [\\mathrm{IgE}\\!\\cdot\\!R] $$\n将$R_{T}$的这个表达式代入$\\theta$的定义中，得到：\n$$ \\theta = \\frac{[\\mathrm{IgE}\\!\\cdot\\!R]}{[R] + [\\mathrm{IgE}\\!\\cdot\\!R]} $$\n系统处于热力学平衡状态，由解离常数$K_{D}$决定：\n$$ K_{D} = \\frac{[\\mathrm{IgE}][R]}{[\\mathrm{IgE}\\!\\cdot\\!R]} $$\n从这个关系式中，我们可以表示出游离受体浓度$[R]$：\n$$ [R] = \\frac{K_{D} [\\mathrm{IgE}\\!\\cdot\\!R]}{[\\mathrm{IgE}]} $$\n现在我们将$[R]$的这个表达式代入我们的$\\theta$方程中：\n$$ \\theta = \\frac{[\\mathrm{IgE}\\!\\cdot\\!R]}{\\left(\\frac{K_{D} [\\mathrm{IgE}\\!\\cdot\\!R]}{[\\mathrm{IgE}]}\\right) + [\\mathrm{IgE}\\!\\cdot\\!R]} $$\n项$[\\mathrm{IgE}\\!\\cdot\\!R]$是分母中的一个公因子。将其提取出来，我们得到：\n$$ \\theta = \\frac{[\\mathrm{IgE}\\!\\cdot\\!R]}{[\\mathrm{IgE}\\!\\cdot\\!R] \\left(\\frac{K_{D}}{[\\mathrm{IgE}]} + 1\\right)} $$\n假设复合物浓度非零，即$[\\mathrm{IgE}\\!\\cdot\\!R] \\neq 0$，我们可以从分子和分母中消去这一项：\n$$ \\theta = \\frac{1}{\\frac{K_{D}}{[\\mathrm{IgE}]} + 1} $$\n为了将其简化为标准形式，我们将分子和分母同乘以$[\\mathrm{IgE}]$：\n$$ \\theta([\\mathrm{IgE}], K_{D}) = \\frac{[\\mathrm{IgE}]}{K_{D} + [\\mathrm{IgE}]} $$\n推导到此完成。这是针对单一、非协同结合位点的Hill-Langmuir方程。\n\n接下来，我们必须计算对应于致敏阈值占据分数$\\theta = \\theta_{\\mathrm{th}} = 0.2$的IgE浓度$[\\mathrm{IgE}]_{\\mathrm{sens}}$。我们使用推导出的方程：\n$$ \\theta_{\\mathrm{th}} = \\frac{[\\mathrm{IgE}]_{\\mathrm{sens}}}{K_{D} + [\\mathrm{IgE}]_{\\mathrm{sens}}} $$\n我们必须解此方程求出$[\\mathrm{IgE}]_{\\mathrm{sens}}$。我们首先将方程两边同乘以分母来整理方程：\n$$ \\theta_{\\mathrm{th}}(K_{D} + [\\mathrm{IgE}]_{\\mathrm{sens}}) = [\\mathrm{IgE}]_{\\mathrm{sens}} $$\n展开左边得到：\n$$ \\theta_{\\mathrm{th}} K_{D} + \\theta_{\\mathrm{th}} [\\mathrm{IgE}]_{\\mathrm{sens}} = [\\mathrm{IgE}]_{\\mathrm{sens}} $$\n我们将含有$[\\mathrm{IgE}]_{\\mathrm{sens}}$的项收集到一边：\n$$ \\theta_{\\mathrm{th}} K_{D} = [\\mathrm{IgE}]_{\\mathrm{sens}} - \\theta_{\\mathrm{th}} [\\mathrm{IgE}]_{\\mathrm{sens}} $$\n提取出$[\\mathrm{IgE}]_{\\mathrm{sens}}$得到：\n$$ \\theta_{\\mathrm{th}} K_{D} = [\\mathrm{IgE}]_{\\mathrm{sens}} (1 - \\theta_{\\mathrm{th}}) $$\n分离出$[\\mathrm{IgE}]_{\\mathrm{sens}}$，得到最终的解析表达式：\n$$ [\\mathrm{IgE}]_{\\mathrm{sens}} = \\frac{\\theta_{\\mathrm{th}} K_{D}}{1 - \\theta_{\\mathrm{th}}} $$\n现在，我们代入给定的数值：$\\theta_{\\mathrm{th}} = 0.2$ 和 $K_{D} = 5$ nM。\n$$ [\\mathrm{IgE}]_{\\mathrm{sens}} = \\frac{0.2 \\times 5 \\text{ nM}}{1 - 0.2} $$\n$$ [\\mathrm{IgE}]_{\\mathrm{sens}} = \\frac{1.0 \\text{ nM}}{0.8} $$\n$$ [\\mathrm{IgE}]_{\\mathrm{sens}} = 1.25 \\text{ nM} $$\n题目要求答案四舍五入到四位有效数字。计算值$1.25$必须表示为$1.250$以满足此要求。问题只要求提供数字。", "answer": "$$\n\\boxed{1.250}\n$$", "id": "2855073"}, {"introduction": "在抗原介导的受体交联之后，细胞内会触发一系列复杂的信号级联反应。本练习将深入探讨这一过程的核心，通过构建一个关键信号枢纽——磷脂酰肌醇-4,5-二磷酸 ($PIP_2$) 代谢的计算模型 [@problem_id:2855010]。通过编程实现该模型，您将获得系统生物学方法的实践经验，并探索细胞在激活过程中如何动态调控这些关键的信号中间产物。", "problem": "要求您形式化一个用于IgE介导的肥大细胞脱颗粒信号传导的最小机制性底物循环模型，该模型关注刺激过程中由磷脂酶C (PLC) 引起的4,5-二磷酸磷脂酰肌醇 (PIP2) 耗竭以及由磷脂酰肌醇-4-磷酸-5-激酶 (PIP5K) 介导的再合成。您的模型必须构建为一个源于质量作用动力学的常微分方程组，并必须实现为一个可运行的程序，用以计算指定的量化输出。\n\n从以下基本依据出发：\n- 质量作用定律：对于一个速率常数为 $k$ 的基元转化 $A \\to B$，反应速率为 $v = k [A]$，其中 $[A]$ 表示浓度。\n- 在关注的时间尺度内，一个封闭的磷脂酰肌醇池内守恒（即无输入/输出）：磷脂酰肌醇 (PI)、4-磷酸磷脂酰肌醇 (PI4P)、PIP2以及PIP2的集总水解产物（记作 $H$，代表二酰基甘油 $+$ 1,4,5-三磷酸肌醇对）的总量 $T$ 在数值误差范围内是恒定的。\n- IgE-Fcε受体I (FcεRI) 的交联会瞬时激活PLC活性；将其表示为一个随时间变化的标量 $u(t)$，该标量在刺激窗口期间调节PLC的速率常数。\n\n模型物种和单位：\n- 物种：$[\\mathrm{PI}]$, $[\\mathrm{PI4P}]$, $[\\mathrm{PIP2}]$, $[H]$，单位均为微摩尔 (µM)。\n- 时间 $t$ 的单位为秒。\n- 所有速率常数的单位均为 $\\text{s}^{-1}$。\n\n反应方案（所有反应均为基元反应并遵循质量作用动力学）：\n1. $\\mathrm{PI} \\xrightarrow{k_4} \\mathrm{PI4P}$，速率为 $v_1 = k_4 [\\mathrm{PI}]$。\n2. $\\mathrm{PI4P} \\xrightarrow{k_5} \\mathrm{PIP2}$，速率为 $v_2 = k_5 [\\mathrm{PI4P}]$。\n3. $\\mathrm{PIP2} \\xrightarrow{k_{\\mathrm{PLC}} u(t)} H$，速率为 $v_3 = k_{\\mathrm{PLC}} u(t) [\\mathrm{PIP2}]$。\n4. $H \\xrightarrow{k_r} \\mathrm{PI}$，速率为 $v_4 = k_r [H]$。\n5. $\\mathrm{PI4P} \\xrightarrow{k_{p4}} \\mathrm{PI}$，速率为 $v_5 = k_{p4} [\\mathrm{PI4P}]$。\n6. $\\mathrm{PIP2} \\xrightarrow{k_{p5}} \\mathrm{PI4P}$，速率为 $v_6 = k_{p5} [\\mathrm{PIP2}]$。\n\n将刺激函数 $u(t)$ 定义为分段常数函数：\n- 基线：当 $t < t_0$ 时，$u(t) = u_0$。\n- 刺激态：当 $t_0 \\le t \\le t_1$ 时，$u(t) = u_1$。\n- 刺激后：当 $t > t_1$ 时，$u(t) = u_0$。\n\n在 $t = 0$ 时的初始条件（单位 µM）：\n- $[\\mathrm{PI}](0) = 80$, $[\\mathrm{PI4P}](0) = 15$, $[\\mathrm{PIP2}](0) = 5$, $[H](0) = 0$。\n- 总量 $T_0 = 80 + 15 + 5 + 0 = 100$。\n\n您的任务：\n1. 根据反应方案和质量作用动力学，推导出关于 $[\\mathrm{PI}]$、$[\\mathrm{PI4P}]$、$[\\mathrm{PIP2}]$ 和 $[H]$ 的常微分方程组。\n2. 实现一个数值求解器，以足够精确的方法对该系统从 $t=0$ 到 $t=t_{\\mathrm{end}}$ 进行积分，将数值上的质量不守恒误差控制在一个小的容差范围内。\n3. 对于下文定义的每个测试用例，计算所要求的量化输出，并遵循指定的单位和格式。\n\n测试套件（每个用例均使用 $t_0 = 30\\,\\text{s}$，$t_1 = 120\\,\\text{s}$，$t_{\\mathrm{end}} = 300\\,\\text{s}$，以及如上所述的初始条件）：\n- 用例1（基线底物循环）：\n  - 参数：$k_4 = 0.02\\,\\text{s}^{-1}$，$k_5 = 0.05\\,\\text{s}^{-1}$，$k_{\\mathrm{PLC}} = 1\\,\\text{s}^{-1}$，$u_0 = 0.005$，$u_1 = 0.25$，$k_r = 0.02\\,\\text{s}^{-1}$，$k_{p4} = 0.01\\,\\text{s}^{-1}$，$k_{p5} = 0.05\\,\\text{s}^{-1}$。\n  - 待计算的输出：在刺激窗口期间，$\\mathrm{PIP2}$ 相对于初始总量 $T_0$ 的最小分数 $f_{\\min}$，即 $f_{\\min} = \\min_{t \\in [t_0,t_1]} \\frac{[\\mathrm{PIP2}](t)}{T_0}$。以四舍五入到4位小数的小数表示（无单位分数）。\n- 用例2（无PIP5K介导的PIP2再合成）：\n  - 参数：与用例1相同，但 $k_5 = 0$。\n  - 待计算的输出：一个布尔指标，表示在 $t_{\\mathrm{end}}$ 时PIP2是否恢复到其初始浓度的至少 $0.8$。形式上，计算 $R = \\mathbf{1}\\left(\\frac{[\\mathrm{PIP2}](t_{\\mathrm{end}})}{[\\mathrm{PIP2}](0)} \\ge 0.8\\right)$。如果为真，输出整数 $1$，否则输出 $0$。\n- 用例3（增强的5-磷酸酶驱动的循环）：\n  - 参数：与用例1相同，但 $k_{p5} = 0.20\\,\\text{s}^{-1}$。\n  - 待计算的输出：刺激期间的PIP5K积分通量，$J_{5} = \\int_{t_0}^{t_1} v_2(t)\\, dt = \\int_{t_0}^{t_1} k_5 [\\mathrm{PI4P}](t)\\, dt$。以微摩尔 (µM) 为单位表示 $J_{5}$，并四舍五入到3位小数。\n- 用例4（数值质量守恒检验）：\n  - 参数：与用例1相同。\n  - 待计算的输出：在整个模拟过程中，总物种池与 $T_0$ 的最大绝对偏差，即 $E_{\\max} = \\max_{t\\in[0,t_{\\mathrm{end}}]} \\left|([\\mathrm{PI}]+[\\mathrm{PI4P}]+[\\mathrm{PIP2}]+[H])(t) - T_0\\right|$。以微摩尔 (µM) 为单位表示，并四舍五入到6位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4]$），$r_1$ 是用例1的结果，$r_2$ 是用例2的结果，$r_3$ 是用例3的结果，$r_4$ 是用例4的结果，按此顺序排列。", "solution": "所提出的问题是计算系统生物学中一个适定性任务，要求对一个机制模型进行形式化和数值求解。该模型描述了磷脂酰肌醇代谢的动力学，这是细胞信号传导中的一个关键途径。该问题具有科学依据，在数学上是一致的，并且所有参数和目标都已明确定义。因此，该问题是有效的，并允许进行严格的求解。\n\n问题的核心是分析一个耦合一阶常微分方程(ODEs)系统的行为，该系统是根据给定的反应网络利用质量作用定律推导出来的。设物种 $\\mathrm{PI}$、$\\mathrm{PI4P}$、$\\mathrm{PIP2}$ 和 $H$ 的浓度分别用状态变量 $y_1(t)$、$y_2(t)$、$y_3(t)$ 和 $y_4(t)$ 表示，其中 $t$ 是以秒为单位的时间。\n\n反应方案是：\n1.  $\\mathrm{PI} \\xrightarrow{k_4} \\mathrm{PI4P}$，速率为 $v_1 = k_4 y_1$。\n2.  $\\mathrm{PI4P} \\xrightarrow{k_5} \\mathrm{PIP2}$，速率为 $v_2 = k_5 y_2$。\n3.  $\\mathrm{PIP2} \\xrightarrow{k_{\\mathrm{PLC}} u(t)} H$，速率为 $v_3 = k_{\\mathrm{PLC}} u(t) y_3$。\n4.  $H \\xrightarrow{k_r} \\mathrm{PI}$，速率为 $v_4 = k_r y_4$。\n5.  $\\mathrm{PI4P} \\xrightarrow{k_{p4}} \\mathrm{PI}$，速率为 $v_5 = k_{p4} y_2$。\n6.  $\\mathrm{PIP2} \\xrightarrow{k_{p5}} \\mathrm{PI4P}$，速率为 $v_6 = k_{p5} y_3$。\n\n根据这些基元反应，我们通过考虑每个物种的生成和消耗速率来构建常微分方程组：\n-   $\\frac{dy_1}{dt} = (\\text{生成速率}) - (\\text{消耗速率}) = v_4 + v_5 - v_1$\n-   $\\frac{dy_2}{dt} = v_1 + v_6 - v_2 - v_5$\n-   $\\frac{dy_3}{dt} = v_2 - v_3 - v_6$\n-   $\\frac{dy_4}{dt} = v_3 - v_4$\n\n代入速率表达式，得到显式的常微分方程组：\n$$\n\\begin{cases}\n    \\frac{dy_1}{dt} &= k_r y_4 + k_{p4} y_2 - k_4 y_1 \\\\\n    \\frac{dy_2}{dt} &= k_4 y_1 + k_{p5} y_3 - (k_5 + k_{p4}) y_2 \\\\\n    \\frac{dy_3}{dt} &= k_5 y_2 - (k_{p5} + k_{\\mathrm{PLC}} u(t)) y_3 \\\\\n    \\frac{dy_4}{dt} &= k_{\\mathrm{PLC}} u(t) y_3 - k_r y_4\n\\end{cases}\n$$\n刺激函数 $u(t)$ 是一个分段常数函数：\n$$\nu(t) = \\begin{cases}\n    u_0 & \\text{当 } t < t_0 \\\\\n    u_1 & \\text{当 } t_0 \\le t \\le t_1 \\\\\n    u_0 & \\text{当 } t > t_1\n\\end{cases}\n$$\n总磷脂酰肌醇池 $T(t) = y_1(t) + y_2(t) + y_3(t) + y_4(t)$ 是守恒的，因为 $\\frac{d}{dt}(y_1+y_2+y_3+y_4) = 0$。初始总浓度为 $T_0 = T(0) = 80 + 15 + 5 + 0 = 100 \\, \\mu\\text{M}$。\n\n为求解此初值问题，我们采用一种数值方法。SciPy库中的`scipy.integrate.solve_ivp`函数是一个合适的选择，因为它提供了一套鲁棒的、自适应步长的求解器。我们将使用默认的`RK45`方法（一种5(4)阶的显式龙格-库塔方法），该方法适用于如此处的非刚性问题。为确保高精度，特别是在用例4的质量守恒检验中，我们将设置严格的相对和绝对误差容限（例如，`rtol`=$10^{-12}$, `atol`=$10^{-12}$）。我们将利用`dense_output=True`选项来获得连续的解表示，这对于寻找极值和在特定区间上进行数值积分是必需的。\n\n求解过程如下，依次处理每个测试用例：\n\n**用例1：PIP2最小分数**\n我们使用指定的参数在区间 $[0, t_{\\mathrm{end}}]$ 上求解该常微分方程组。利用获得的连续解，我们在刺激窗口 $[t_0, t_1]$ 内的一个精细时间点网格上评估 $[\\mathrm{PIP2}](t)$，即 $y_3(t)$。然后确定该网格上比率 $\\frac{y_3(t)}{T_0}$ 的最小值。\n-   $f_{\\min} = \\min_{t \\in [t_0, t_1]} \\frac{y_3(t)}{T_0}$\n-   参数：$k_4=0.02, k_5=0.05, k_{\\mathrm{PLC}}=1, u_0=0.005, u_1=0.25, k_r=0.02, k_{p4}=0.01, k_{p5}=0.05$。时间点 $t_0=30, t_1=120$。\n\n**用例2：恢复指标**\n再次求解该系统，但将PIP5K的速率常数 $k_5$ 设为 $0$。在最终时间点 $t=t_{\\mathrm{end}}$ 对 $\\mathrm{PIP2}$ 的浓度 $y_3(t)$ 进行求值。将此值与初始浓度 $y_3(0)=5\\,\\mu\\text{M}$ 进行比较。\n-   $R = \\mathbf{1}\\left(\\frac{y_3(t_{\\mathrm{end}})}{y_3(0)} \\ge 0.8\\right)$\n-   参数：与用例1相同，但 $k_5=0$。指示函数 $\\mathbf{1}(\\cdot)$ 在条件为真时为 $1$，否则为 $0$。\n\n**用例3：PIP5K积分通量**\n使用一个提高的5-磷酸酶速率常数 $k_{p5} = 0.20\\,\\text{s}^{-1}$ 求解该系统。待计算的量是刺激期间由PIP5K产生的 $\\mathrm{PIP2}$ 总量，即通量 $v_2(t) = k_5 y_2(t)$ 的时间积分。\n-   $J_5 = \\int_{t_0}^{t_1} v_2(t)\\, dt = \\int_{t_0}^{t_1} k_5 y_2(t)\\, dt$\n-   参数：与用例1相同，但 $k_{p5}=0.20$。\n该积分使用`scipy.integrate.quad`函数进行数值计算，该函数应用于区间 $[t_0, t_1]$ 上 $y_2(t)$ 的连续解。\n\n**用例4：数值质量守恒检验**\n使用与用例1相同的参数，以非常高的精度设置求解该系统。在整个模拟区间 $[0, t_{\\mathrm{end}}]$ 的一个精细网格上，对总物种池浓度 $T(t) = y_1(t)+y_2(t)+y_3(t)+y_4(t)$ 进行求值。然后找出与初始总物种池 $T_0$ 的最大绝对偏差。\n-   $E_{\\max} = \\max_{t \\in [0, t_{\\mathrm{end}}]} |T(t) - T_0|$\n-   这可作为对积分过程数值完整性的关键验证。\n\n实现过程将把这些步骤整合到一个独立的自包含程序中，该程序顺序执行每个用例，并按要求格式化最终结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp, quad\n\ndef solve():\n    \"\"\"\n    Solves the four test cases for the phosphoinositide signaling model.\n    \"\"\"\n\n    # --- Common parameters and initial conditions ---\n    ic = [80.0, 15.0, 5.0, 0.0]  # [PI, PI4P, PIP2, H] in µM\n    T0 = sum(ic)\n    t_span = (0.0, 300.0)\n    t0, t1, tend = 30.0, 120.0, 300.0\n\n    # --- Test case definitions ---\n    case_params = [\n        # Case 1: Baseline\n        {'k4': 0.02, 'k5': 0.05, 'k_plc': 1.0, 'u0': 0.005, 'u1': 0.25, \n         'kr': 0.02, 'kp4': 0.01, 'kp5': 0.05},\n        # Case 2: No PIP2 resynthesis by PIP5K\n        {'k4': 0.02, 'k5': 0.0, 'k_plc': 1.0, 'u0': 0.005, 'u1': 0.25, \n         'kr': 0.02, 'kp4': 0.01, 'kp5': 0.05},\n        # Case 3: Enhanced 5-phosphatase\n        {'k4': 0.02, 'k5': 0.05, 'k_plc': 1.0, 'u0': 0.005, 'u1': 0.25, \n         'kr': 0.02, 'kp4': 0.01, 'kp5': 0.20},\n        # Case 4: Conservation check (same parameters as Case 1)\n        {'k4': 0.02, 'k5': 0.05, 'k_plc': 1.0, 'u0': 0.005, 'u1': 0.25, \n         'kr': 0.02, 'kp4': 0.01, 'kp5': 0.05},\n    ]\n\n    results = []\n\n    # --- ODE system definition ---\n    def model(t, y, p):\n        \"\"\"\n        Defines the system of ODEs for the phosphoinositide cycle.\n        y = [PI, PI4P, PIP2, H]\n        p = dictionary of parameters\n        \"\"\"\n        y1, y2, y3, y4 = y\n        \n        # Stimulation function u(t)\n        u_t = p['u1'] if t0 <= t <= t1 else p['u0']\n        \n        # Rates of change\n        dy1dt = p['kr'] * y4 + p['kp4'] * y2 - p['k4'] * y1\n        dy2dt = p['k4'] * y1 + p['kp5'] * y3 - (p['k5'] + p['kp4']) * y2\n        dy3dt = p['k5'] * y2 - (p['kp5'] + p['k_plc'] * u_t) * y3\n        dy4dt = p['k_plc'] * u_t * y3 - p['kr'] * y4\n        \n        return [dy1dt, dy2dt, dy3dt, dy4dt]\n\n    # --- Process each test case ---\n    for i, params in enumerate(case_params):\n        case_num = i + 1\n        \n        # Use high accuracy for all cases, especially Case 4\n        rtol, atol = (1e-12, 1e-12) if case_num == 4 else (1e-9, 1e-9)\n\n        # Solve the ODE system\n        sol = solve_ivp(\n            fun=model,\n            t_span=t_span,\n            y0=ic,\n            method='RK45',\n            args=(params,),\n            dense_output=True,\n            rtol=rtol,\n            atol=atol\n        )\n\n        if case_num == 1:\n            # Output: minimum fraction f_min of PIP2 during stimulation\n            t_eval_stim = np.linspace(t0, t1, 1000)\n            y_eval_stim = sol.sol(t_eval_stim)\n            pip2_stim = y_eval_stim[2]\n            f_min = np.min(pip2_stim) / T0\n            results.append(f\"{f_min:.4f}\")\n            \n        elif case_num == 2:\n            # Output: boolean indicator of recovery\n            pip2_end = sol.sol(tend)[2]\n            pip2_initial = ic[2]\n            recovery_ratio = pip2_end / pip2_initial\n            R = 1 if recovery_ratio >= 0.8 else 0\n            results.append(str(R))\n            \n        elif case_num == 3:\n            # Output: integrated PIP5K flux during stimulation\n            # v2(t) = k5 * [PI4P](t)\n            v2 = lambda t: params['k5'] * sol.sol(t)[1]\n            J5, _ = quad(v2, t0, t1, epsabs=1e-9, epsrel=1e-9)\n            results.append(f\"{J5:.3f}\")\n            \n        elif case_num == 4:\n            # Output: maximum absolute deviation of total pool from T0\n            t_eval_full = np.linspace(t_span[0], t_span[1], 2000)\n            y_eval_full = sol.sol(t_eval_full)\n            total_pool_t = np.sum(y_eval_full, axis=0)\n            error = np.abs(total_pool_t - T0)\n            E_max = np.max(error)\n            results.append(f\"{E_max:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2855010"}, {"introduction": "肥大细胞激活的最终效应是脱颗粒，即从细胞内囊泡中释放出如组胺等强效炎症介质。最后的这个实践练习将挑战您对这一复杂的脱颗粒过程进行定量建模 [@problem_id:2855067]。通过综合考虑不同颗粒群体的特性、多样化的囊泡融合模式以及组胺含量，您将计算产生特定生物学效应所需的细胞事件数量，从而将单细胞层面的力学机制与组织层面的生理响应联系起来。", "problem": "在免疫球蛋白E (IgE) 介导的肥大细胞活化过程中，免疫球蛋白E (IgE) 的高亲和力受体——Fcε受体I (FcεRI) 的交联会触发钙依赖性的分泌颗粒胞吐作用，这些颗粒具有不同的大小和释放模式。考虑一个肥大细胞，其含有两种颗粒群体：“成熟”颗粒和“未成熟”颗粒。这些颗粒会经历完全融合胞吐或短暂的“亲吻-运行”式融合。假设以下具有科学依据的事实和参数。\n\n- 基本原理：\n  - 颗粒内包含的组胺分子数量是颗粒内游离组胺浓度、颗粒腔体积和阿伏伽德罗常数的乘积。\n  - 颗粒体积为 $V = \\frac{4}{3}\\pi r^{3}$，其中 $r$ 是颗粒半径。\n  - 在完全融合事件中，颗粒中固定比例的组胺被释放；在“亲吻-运行”事件中，释放的比例较小。\n  - 每个融合事件根据下述的群体比例，从细胞的颗粒池中独立地、均匀随机地选择一个颗粒。\n\n- 颗粒群体和胞吐参数：\n  - 成熟颗粒的比例 $p_{m} = 0.65$；未成熟颗粒的比例 $p_{i} = 0.35$。\n  - 成熟颗粒半径 $r_{m} = 220 \\ \\mathrm{nm}$；未成熟颗粒半径 $r_{i} = 160 \\ \\mathrm{nm}$。\n  - 两种群体的颗粒内游离组胺浓度均为 $c_{g} = 0.60 \\ \\mathrm{mol \\ L^{-1}}$。\n  - 成熟颗粒完全融合的概率 $f_{m} = 0.55$；未成熟颗粒完全融合的概率 $f_{i} = 0.35$。\n  - 完全融合中释放的内容物比例：成熟颗粒 $\\alpha_{m} = 0.75$，未成熟颗粒 $\\alpha_{i} = 0.85$。\n  - “亲吻-运行”中释放的内容物比例：成熟颗粒 $\\beta_{m} = 0.20$，未成熟颗粒 $\\beta_{i} = 0.30$。\n\n- 细胞外混合目标：\n  - 与释放的组胺混合的细胞周细胞外微域体积为 $V_{e} = 12 \\ \\mathrm{pL}$。\n  - 在该微域中要达到的目标组胺浓度为 $c^{\\ast} = 12 \\ \\mu \\mathrm{M}$。\n  - 使用阿伏伽德罗常数 $N_{A} = 6.022 \\times 10^{23} \\ \\mathrm{mol^{-1}}$。\n  - 取 $1 \\ \\mathrm{nm} = 10^{-9} \\ \\mathrm{m}$ 和 $1 \\ \\mathrm{m^{3}} = 10^{3} \\ \\mathrm{L}$。\n\n假设在所考虑的时间尺度内，释放的组胺在微域内瞬时混合，没有重摄取，且融合事件之间相互独立。从第一性原理推导所需的颗粒融合事件的期望数量 $N$，使得释放的组胺分子总数的期望值等于在体积 $V_{e}$ 中达到浓度 $c^{\\ast}$ 所需的量。将 $N$ 以无量纲数的形式报告，并将您的答案四舍五入到三位有效数字。", "solution": "该问题要求我们确定颗粒融合事件的数量 $N$，使得释放的组胺分子总数的期望值等于一个目标量。该目标量定义为在细胞外体积 $V_{e}$ 中达到浓度 $c^{\\ast}$ 所需的分子数量。该问题可以通过计算目标分子数，然后除以单次融合事件释放分子的期望数来解决。为方便和清晰起见，我们将首先以组胺的摩尔数为单位进行推导，因为阿伏伽德罗常数 $N_{A}$ 将在最终的比率中被抵消。\n\n首先，让我们计算在细胞外体积 $V_{e}$ 中所需的目标组胺摩尔数 $n_{target}$。它由目标浓度 $c^{\\ast}$ 和体积 $V_{e}$ 的乘积给出。\n$$n_{target} = c^{\\ast} V_{e}$$\n代入给定值：\n$c^{\\ast} = 12 \\ \\mu \\mathrm{M} = 12 \\times 10^{-6} \\ \\mathrm{mol \\ L^{-1}}$\n$V_{e} = 12 \\ \\mathrm{pL} = 12 \\times 10^{-12} \\ \\mathrm{L}$\n$$n_{target} = (12 \\times 10^{-6} \\ \\mathrm{mol \\ L^{-1}}) \\cdot (12 \\times 10^{-12} \\ \\mathrm{L}) = 1.44 \\times 10^{-16} \\ \\mathrm{mol}$$\n\n接下来，我们必须确定在单次随机融合事件中释放的组胺的期望摩尔数，我们将其表示为 $E[n_{event}]$。一次融合事件可能涉及一个成熟颗粒或一个未成熟颗粒，它们分别以概率 $p_{m}$ 和 $p_{i}$ 被选中。根据全期望定律：\n$$E[n_{event}] = p_{m} E[n_{m}] + p_{i} E[n_{i}]$$\n此处，$E[n_{m}]$ 是当一个成熟颗粒发生融合时释放的组胺的期望摩尔数，$E[n_{i}]$ 是从未成熟颗粒融合中释放的期望摩尔数。\n\n我们首先分析成熟颗粒的情况。一个成熟颗粒中所含组胺的总摩尔数 $n_{total, m}$ 是颗粒内浓度 $c_{g}$ 和颗粒体积 $V_{m}$ 的乘积。半径为 $r_{m}$ 的球形颗粒的体积是 $V_{m} = \\frac{4}{3}\\pi r_{m}^{3}$。我们必须确保单位一致。半径 $r_m$ 以 $\\mathrm{nm}$ 为单位给出，我们将其转换为 $\\mathrm{m}$。浓度 $c_g$ 的单位是 $\\mathrm{mol \\ L^{-1}}$。我们使用转换因子 $1 \\ \\mathrm{m^3} = 10^3 \\ \\mathrm{L}$。\n$r_{m} = 220 \\ \\mathrm{nm} = 2.2 \\times 10^{-7} \\ \\mathrm{m}$\n$V_{m} = \\frac{4}{3}\\pi (2.2 \\times 10^{-7} \\ \\mathrm{m})^{3} \\cdot (10^{3} \\ \\mathrm{L \\ m^{-3}})$\n$$n_{total, m} = c_{g} V_{m} = (0.60 \\ \\mathrm{mol \\ L^{-1}}) \\cdot \\left( \\frac{4}{3}\\pi (2.2 \\times 10^{-7})^{3} \\cdot 10^{3} \\ \\mathrm{L} \\right)$$\n一个成熟颗粒的融合可以是概率为 $f_{m}$ 的完全融合，释放其内容物的 $\\alpha_{m}$ 比例；也可以是概率为 $(1-f_{m})$ 的“亲吻-运行”式融合，释放其内容物的 $\\beta_{m}$ 比例。因此，从一次成熟颗粒融合中释放的期望摩尔数为：\n$$E[n_{m}] = n_{total, m} \\cdot [ f_{m}\\alpha_{m} + (1-f_{m})\\beta_{m} ]$$\n让我们将成熟颗粒的有效释放分数定义为 $R_{m} = f_{m}\\alpha_{m} + (1-f_{m})\\beta_{m}$。\n$R_{m} = (0.55)(0.75) + (1-0.55)(0.20) = 0.4125 + (0.45)(0.20) = 0.4125 + 0.09 = 0.5025$。\n\n同样，对于半径为 $r_{i}$ 的未成熟颗粒：\n$r_{i} = 160 \\ \\mathrm{nm} = 1.6 \\times 10^{-7} \\ \\mathrm{m}$\n$V_{i} = \\frac{4}{3}\\pi (1.6 \\times 10^{-7} \\ \\mathrm{m})^{3} \\cdot (10^{3} \\ \\mathrm{L \\ m^{-3}})$\n$$n_{total, i} = c_{g} V_{i} = (0.60 \\ \\mathrm{mol \\ L^{-1}}) \\cdot \\left( \\frac{4}{3}\\pi (1.6 \\times 10^{-7})^{3} \\cdot 10^{3} \\ \\mathrm{L} \\right)$$\n从一次未成熟颗粒融合中释放的期望摩尔数为：\n$$E[n_{i}] = n_{total, i} \\cdot [ f_{i}\\alpha_{i} + (1-f_{i})\\beta_{i} ]$$\n未成熟颗粒的有效释放分数为 $R_{i} = f_{i}\\alpha_{i} + (1-f_{i})\\beta_{i}$。\n$R_{i} = (0.35)(0.85) + (1-0.35)(0.30) = 0.2975 + (0.65)(0.30) = 0.2975 + 0.195 = 0.4925$。\n\n现在我们结合这些来求 $E[n_{event}]$：\n$$E[n_{event}] = p_{m} n_{total,m} R_{m} + p_{i} n_{total,i} R_{i}$$\n代入 $n_{total,m}$ 和 $n_{total,i}$ 的表达式：\n$$E[n_{event}] = p_{m} \\left(c_{g} \\frac{4}{3}\\pi r_{m}^{3} \\cdot 10^3 \\right) R_{m} + p_{i} \\left(c_{g} \\frac{4}{3}\\pi r_{i}^{3} \\cdot 10^3 \\right) R_{i}$$\n我们可以提出公因式：\n$$E[n_{event}] = c_{g} \\cdot \\frac{4}{3}\\pi \\cdot 10^3 \\cdot (p_{m}r_{m}^{3}R_{m} + p_{i}r_{i}^{3}R_{i})$$\n让我们计算括号中的值（半径单位为米）：\n$p_{m}r_{m}^{3}R_{m} = (0.65) \\cdot (2.2 \\times 10^{-7})^{3} \\cdot (0.5025) \\approx 3.483 \\times 10^{-21} \\ \\mathrm{m^3}$\n$p_{i}r_{i}^{3}R_{i} = (0.35) \\cdot (1.6 \\times 10^{-7})^{3} \\cdot (0.4925) \\approx 7.068 \\times 10^{-22} \\ \\mathrm{m^3}$\n和 = $3.483 \\times 10^{-21} + 0.7068 \\times 10^{-21} = 4.1898 \\times 10^{-21} \\ \\mathrm{m^3}$\n现在，我们计算 $E[n_{event}]$：\n$$E[n_{event}] = (0.60 \\ \\mathrm{mol \\ L^{-1}}) \\cdot \\frac{4}{3}\\pi \\cdot (10^3 \\ \\mathrm{L \\ m^{-3}}) \\cdot (4.1898 \\times 10^{-21} \\ \\mathrm{m^3})$$\n$$E[n_{event}] \\approx 1.053 \\times 10^{-17} \\ \\mathrm{mol}$$\n\n问题陈述，N次事件后释放的总摩尔数的期望值等于目标量。由于每个事件都是独立同分布的，总释放量的期望值为 $N \\cdot E[n_{event}]$。\n$$N \\cdot E[n_{event}] = n_{target}$$\n因此，所需的事件数量 $N$ 是：\n$$N = \\frac{n_{target}}{E[n_{event}]}$$\n代入计算出的值：\n$$N = \\frac{1.44 \\times 10^{-16} \\ \\mathrm{mol}}{1.053 \\times 10^{-17} \\ \\mathrm{mol}} \\approx 13.675$$\n问题要求将答案四舍五入到三位有效数字。\n$$N \\approx 13.7$$\n正如预期的那样，这是一个无量纲数。逻辑步骤合理，计算在算术上是正确的。", "answer": "$$\\boxed{13.7}$$", "id": "2855067"}]}