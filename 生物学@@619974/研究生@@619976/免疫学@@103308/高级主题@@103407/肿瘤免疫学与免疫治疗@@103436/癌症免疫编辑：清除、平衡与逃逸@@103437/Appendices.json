{"hands_on_practices": [{"introduction": "免疫系统要对肿瘤发起攻击，首先必须能够将其识别为“异物”。这种识别能力的关键在于肿瘤细胞表面呈现的新抗原 (neoantigen)，它们是基因突变产生的异常蛋白质片段。这个练习将通过一个基础的概率模型，帮助你量化一个肿瘤的“新抗原负荷” ($N$)，从而揭示其免疫原性的来源。掌握这个计算是理解整个免疫编辑过程的第一步。[@problem_id:2838619]", "problem": "一个实体瘤含有总共 $M$ 个非同义点突变。对于每个突变，假设在基于抗原处理与呈递生物学的标准假设下，以下条件成立：\n- 突变有 $f_{e}$ 的概率位于一个转录和翻译活跃的基因中，从而产生一个跨越该突变的多肽。\n- 在多肽产生的前提下，它有 $p_{b}$ 的概率含有一个或多个能够与患者的人类白细胞抗原 (HLA) 分子以足够亲和力结合的表位，从而被呈递在细胞表面。\n- 不同突变的事件是相互独立的，并且在单个突变内部，表达和结合事件也是相互独立的。\n\n将新抗原载荷 $N$ 定义为在肿瘤细胞表面产生被呈递的新抗原表位的突变的期望数量。仅使用上述假设和基础概率，用 $M$、$f_{e}$ 和 $p_{b}$ 表达 $N$，然后为一个 $M = 1500$、$f_{e} = 0.4$ 和 $p_{b} = 0.01$ 的肿瘤计算 $N$。提供 $N$ 的精确值。\n\n然后，在癌症免疫编辑（清除、平衡和逃逸）的框架内，使用第一性原理的概率论证来解释 $N$ 的变化如何调节针对克隆的免疫选择强度。为了进行这一解释，将“免疫选择强度”定义为在一个简单的“单次命中”识别模型中，一个克隆在固定时间窗口内被清除与存活的几率的自然对数，其中如果至少发生一次有效的T淋巴细胞识别并杀伤事件，则发生清除。对于此解释部分，不要进行任何额外的数值计算；重点是从假设中推导其对 $N$ 的函数依赖关系。您最终提交的答案必须是根据给定数值参数计算出的 $N$ 值（无单位）。", "solution": "所提出的问题已经过验证，被认为是定义明确、有科学依据且内部一致的。它在一个简化但有效的癌症免疫学框架内提出了一个标准的概率问题。我们将继续进行正式求解。\n\n问题分为两部分。首先，我们必须计算新抗原载荷 $N$。其次，我们必须推导免疫选择强度对 $N$ 的函数依赖关系。\n\n第一部分：新抗原载荷 $N$ 的计算\n\n设 $M$ 为肿瘤中非同义点突变的总数。对于每个突变 $i \\in \\{1, 2, \\dots, M\\}$，我们定义一个伯努利随机变量 $X_i$，使得当该突变产生一个被呈递的新抗原表位时，$X_i = 1$，否则 $X_i = 0$。\n\n问题陈述，对于一个给定的突变要成为新抗原，必须满足两个相继的条件：\n1.  突变必须位于一个表达的基因中，从而产生一个突变肽。设此为事件 $\\mathcal{E}$。该事件的概率为 $P(\\mathcal{E}) = f_e$。\n2.  在多肽产生的前提下，它必须与 HLA 分子结合并被呈递。设此为事件 $\\mathcal{B}$。该条件概率为 $P(\\mathcal{B} | \\mathcal{E}) = p_b$。\n\n问题陈述这些事件在单个突变内部是独立的，这与使用条件概率的表述相符。单个突变 $i$ 产生一个被呈递的新抗原的概率是联合事件 $\\mathcal{E} \\cap \\mathcal{B}$ 的概率。使用条件概率的定义，可得：\n$$P(X_i = 1) = P(\\mathcal{E} \\cap \\mathcal{B}) = P(\\mathcal{B} | \\mathcal{E}) P(\\mathcal{E})$$\n代入给定的概率：\n$$P(X_i = 1) = p_b f_e$$\n新抗原的总数是这些伯努利变量的总和：$S = \\sum_{i=1}^{M} X_i$。新抗原载荷 $N$ 被定义为这个总和的期望值，$N = E[S]$。\n\n根据期望的线性性质，我们有：\n$$N = E\\left[\\sum_{i=1}^{M} X_i\\right] = \\sum_{i=1}^{M} E[X_i]$$\n对于任何伯努利随机变量 $X_i$，其期望就是成功的概率，$E[X_i] = P(X_i = 1)$。由于这些突变被视为独立同分布的试验，我们有：\n$$N = \\sum_{i=1}^{M} (p_b f_e) = M p_b f_e$$\n这就是新抗原载荷的通用表达式。\n\n我们被给予了具体的数值：\n-   总突变数，$M = 1500$\n-   表达概率，$f_e = 0.4$\n-   结合概率，$p_b = 0.01$\n\n将这些值代入我们推导出的公式：\n$$N = 1500 \\times 0.4 \\times 0.01$$\n$$N = 600 \\times 0.01$$\n$$N = 6$$\n新抗原的期望数量恰好是 $6$。\n\n第二部分：免疫选择强度\n\n接下来，我们推导“免疫选择强度”（我们用 $I$ 表示）对新抗原载荷 $N$ 的函数依赖关系。强度 $I$ 定义为一个克隆被清除与存活的几率的自然对数：\n$$I = \\ln\\left(\\frac{P(\\text{elimination})}{P(\\text{survival})}\\right)$$\n由于 $P(\\text{survival}) = 1 - P(\\text{elimination})$，几率可以写成 $\\frac{P(\\text{elimination})}{1 - P(\\text{elimination})}$。\n\n问题指定了一个“单次命中”识别模型，其中如果*至少发生一次*有效的T细胞识别并杀伤事件，则发生清除。存活是其互补事件：*零次*此类事件发生。\n我们将 $N$ 个新抗原视为免疫系统的独立目标。设 $p_{kill}$ 为任何单个新抗原在指定时间窗口内被T淋巴细胞成功识别并导致杀伤事件的概率。这个概率 $p_{kill}$ 是一个未明确说明的常数，它概括了T细胞频率、亲和力和细胞毒性的复杂性。\n\n单个特定的新抗原*不*导致杀伤事件的概率是 $(1 - p_{kill})$。\n由于存在 $N$ 个新抗原，并且我们假设它们作为独立目标，那么它们中*没有任何一个*导致杀伤事件的概率是它们各自不被识别的概率的乘积。这就是克隆存活的概率：\n$$P(\\text{survival}) = (1 - p_{kill})^{N}$$\n因此，清除的概率是：\n$$P(\\text{elimination}) = 1 - P(\\text{survival}) = 1 - (1 - p_{kill})^{N}$$\n现在，我们将这些表达式代回免疫选择强度 $I$ 的定义中：\n$$I = \\ln\\left(\\frac{1 - (1 - p_{kill})^{N}}{(1 - p_{kill})^{N}}\\right)$$\n这个表达式可以简化为：\n$$I = \\ln\\left(\\frac{1}{(1 - p_{kill})^{N}} - 1\\right)$$\n或者，利用指数的性质：\n$$I = \\ln\\left((1 - p_{kill})^{-N} - 1\\right)$$\n这个最终表达式将免疫选择强度 $I$ 对新抗原载荷 $N$ 的函数依赖关系形式化了。它表明，假设 $p_{kill} \\in (0,1)$，随着 $N$ 的增加，$(1 - p_{kill})^{N}$ 项减小，从而导致对数的参数以及 $I$ 本身单调增加。这与生物学原理相符，即更高的新抗原负荷会引发更强的抗肿瘤免疫反应，从而增加清除的选择压力。\n\n问题只要求第一部分的最终数值 $N$。", "answer": "$$\\boxed{6}$$", "id": "2838619"}, {"introduction": "在免疫系统识别出新抗原后，一场“战斗”随之打响。这个练习利用一个基础的数学模型，来探索这场初始战斗的动态过程。通过推导“基本免疫控制数” ($R_I$)，你将学习到肿瘤生长和免疫杀伤之间的平衡如何决定肿瘤是否被清除，从而为免疫编辑的“清除”(Elimination) 阶段提供一个定量的分析框架。[@problem_id:2838646]", "problem": "一个实体瘤细胞群 $T(t)$ 在基线条件下，早期根据指数定律 $dT/dt = r\\,T$ 扩张，其中 $r$ 是肿瘤内源性的人均生长速率。在癌症免疫编辑的清除阶段，密度为 $E(t)$ 的细胞毒性T淋巴细胞 (CTL) 会杀死肿瘤细胞。假设以下基本且广泛使用的模型假设：\n- 在强力启动或过继性转移后的短暂时间窗内，CTL密度近似恒定为 $E(t) \\approx E_{0}$。\n- CTL介导的肿瘤细胞杀伤遵循质量作用动力学，速率常数为 $k$，因此施加于肿瘤细胞的人均死亡速率为 $k\\,E_{0}$。\n\n在这些假设下，早期肿瘤动力学由 $dT/dt = \\big(r - k\\,E_{0}\\big)\\,T$ 给出。清除对应于 $T(t)$ 从任何正的初始条件开始，对于所有 $t \\ge 0$ 都是递减的。\n\n任务：\n1) 从上述模型和指数增长/衰减的基本性质出发，推导出表征癌症免疫编辑清除机制的关于 $r$、$k$ 和 $E_{0}$ 的量化条件。\n2) 使用你的结果，将基本免疫控制数 $R_{I}$ 定义为一个无量纲量，用于比较肿瘤内源性扩张与基线水平的免疫介导杀伤，并用 $r$、$k$ 和 $E_{0}$ 表示它。\n3) 对于一个肿瘤，其 $r = 0.028\\,\\text{day}^{-1}$，与基线密度为 $E_{0} = 4.0 \\times 10^{5}\\,\\text{cells}\\,\\text{mL}^{-1}$ 的CTL相互作用，质量作用杀伤常数为 $k = 1.2 \\times 10^{-7}\\,\\text{mL}\\,\\text{cell}^{-1}\\,\\text{day}^{-1}$，计算 $R_{I}$ 的值。根据你的标准，说明是否预测会发生清除，并将你报告的 $R_{I}$ 值四舍五入到3位有效数字。将最终报告的数字表示为一个无量纲量（无单位）。", "solution": "问题陈述具有科学依据、内容自洽，并且在数学上是适定的。我将按要求进行推导和计算。分析过程根据问题中提出的三个任务进行组织。\n\n1) 清除条件的推导。\n肿瘤细胞群 $T(t)$ 的动力学由以下常微分方程描述：\n$$\n\\frac{dT}{dt} = \\left(r - k E_{0}\\right) T\n$$\n其中 $r$ 是肿瘤内源性生长速率，$k$ 是质量作用杀伤速率常数，$E_{0}$ 是细胞毒性T淋巴细胞（CTL）的恒定密度。这是一个线性、齐次、一阶微分方程。对于给定的初始肿瘤群体 $T(0)$（在时间 $t=0$ 时），其解为：\n$$\nT(t) = T(0) \\exp\\left(\\left(r - k E_{0}\\right)t\\right)\n$$\n问题将清除定义为：从任何正的初始群体 $T(0) > 0$ 开始，$T(t)$ 在所有时间 $t \\ge 0$ 内是一个单调递减函数。对于形式为 $A \\exp(\\lambda t)$ 的指数函数（其中 $A > 0$），该函数严格递减当且仅当速率常数 $\\lambda$ 为负。在我们的模型中，有效速率常数为 $\\lambda = r - k E_{0}$。\n\n因此，要发生清除，我们必须有：\n$$\nr - k E_{0} < 0\n$$\n重新整理这个不等式，可得到清除机制下各参数的量化条件：\n$$\nr < k E_{0}\n$$\n这个条件有清晰的生物学解释：当肿瘤的内源性人均生长速率（$r$）严格小于免疫系统施加的人均杀伤速率（$k E_{0}$）时，肿瘤便可被清除。\n\n2) 基本免疫控制数 $R_I$ 的定义。\n第二个任务是定义一个无量纲量 $R_{I}$，它比较了肿瘤内源性扩张速率与免疫介导的杀伤速率。扩张速率由 $r$ 表征，其单位为 $\\text{time}^{-1}$。杀伤速率由乘积 $k E_{0}$ 表征。$k$ 的量纲是 $\\text{volume} \\cdot \\text{cell}^{-1} \\cdot \\text{time}^{-1}$，$E_{0}$ 的量纲是 $\\text{cells} \\cdot \\text{volume}^{-1}$，因此乘积 $k E_{0}$ 的单位也是 $\\text{time}^{-1}$。\n\n通过取这两个速率的比值可以构成一个无量纲数。为了建立一个清晰的控制阈值，我们使用清除条件 $r < k E_{0}$。将不等式两边同除以正量 $k E_{0}$，得到：\n$$\n\\frac{r}{k E_{0}} < 1\n$$\n这种不等式结构启发我们将基本免疫控制数定义为肿瘤生长速率与免疫杀伤速率的比值。这类似于流行病学中的基本再生数 $R_{0}$，其值小于1表示群体数量下降。因此，我们定义 $R_{I}$ 如下：\n$$\nR_{I} = \\frac{r}{k E_{0}}\n$$\n根据这个定义，清除机制的特征是 $R_{I} < 1$。平衡机制和逃逸机制则分别对应 $R_{I} = 1$ 和 $R_{I} > 1$。\n\n3) $R_I$ 的计算与解释。\n第三个任务是使用给定的参数值计算 $R_{I}$：\n- $r = 0.028\\,\\text{day}^{-1}$\n- $E_{0} = 4.0 \\times 10^{5}\\,\\text{cells}\\,\\text{mL}^{-1}$\n- $k = 1.2 \\times 10^{-7}\\,\\text{mL}\\,\\text{cell}^{-1}\\,\\text{day}^{-1}$\n\n首先，我们计算免疫杀伤速率 $k E_{0}$：\n$$\nk E_{0} = (1.2 \\times 10^{-7}\\,\\text{mL}\\,\\text{cell}^{-1}\\,\\text{day}^{-1}) \\times (4.0 \\times 10^{5}\\,\\text{cells}\\,\\text{mL}^{-1})\n$$\n$$\nk E_{0} = (1.2 \\times 4.0) \\times 10^{-7+5}\\,\\text{day}^{-1} = 4.8 \\times 10^{-2}\\,\\text{day}^{-1}\n$$\n所以，$k E_{0} = 0.048\\,\\text{day}^{-1}$。\n\n接下来，我们根据其定义计算无量纲数 $R_{I}$：\n$$\nR_{I} = \\frac{r}{k E_{0}} = \\frac{0.028\\,\\text{day}^{-1}}{0.048\\,\\text{day}^{-1}}\n$$\n这可以简化为分数：\n$$\nR_{I} = \\frac{28}{48} = \\frac{7}{12}\n$$\n为了获得所需的数值，我们进行除法运算：\n$$\nR_{I} \\approx 0.58333...\n$$\n问题要求将结果四舍五入到3位有效数字。这得到：\n$$\nR_{I} \\approx 0.583\n$$\n由于 $R_{I} \\approx 0.583 < 1$，清除条件得到满足。因此，根据此模型和给定的参数，预测免疫系统将成功清除该肿瘤。", "answer": "$$\\boxed{0.583}$$", "id": "2838646"}, {"introduction": "免疫编辑理论预测，免疫系统的成功攻击会在肿瘤的基因组上留下可被检测的“伤疤”——即那些能产生免疫原性新抗原的突变会因负向选择而减少。最后一个练习将让你扮演一名计算免疫学家的角色，使用真实世界中的统计方法来分析一组假设的基因组数据。通过应用费雪精确检验 (Fisher’s exact test)，你将学会如何寻找免疫选择留下的证据，并直接检验免疫编辑假说。[@problem_id:2838574]", "problem": "肿瘤免疫编辑的一个核心预测是，细胞毒性T淋巴细胞（CTL）介导的负选择会耗竭那些在预测能与I类主要组织相容性复合体（MHC）结合的多肽中产生新抗原决定簇的免疫原性非同义突变，而同义突变不受免疫选择影响，可作为中性比较物。\n\n在没有免疫编辑的零假设下，非同义突变与同义突变的比例应与预测的MHC结合状态无关。\n\n你对一个肿瘤外显子组进行了测序，并根据每个单核苷酸变异是非同义还是同义突变，以及它是否位于预测能与I类MHC结合的多肽（结合肽）或非此类多肽（非结合肽）中，对变异进行分类。观测到的计数如下：结合肽中有$1$个非同义突变和$4$个同义突变；非结合肽中有$9$个非同义突变和$6$个同义突变。\n\n仅使用列联表的基本定义和Fisher精确检验所基于的精确超几何抽样模型，计算一个单侧Fisher精确检验的$p$值。该检验的假设是：结合肽中非同义突变的比例低于非结合肽（即，一种与CTL介导的清除相符的耗竭现象）。将最终答案表示为四舍五入到四位有效数字的小数。无需单位。", "solution": "该问题首先需要进行严格的有效性验证。\n\n步骤1：提取已知条件。\n所提供的数据被组织成一个$2 \\times 2$列联表结构：\n-   组1：预测能与I类MHC结合的多肽（“结合肽”）。\n    -   非同义突变：$1$\n    -   同义突变：$4$\n-   组2：预测不能与I类MHC结合的多肽（“非结合肽”）。\n    -   非同义突变：$9$\n    -   同义突变：$6$\n-   统计检验：单侧Fisher精确检验。\n-   假设：结合肽中非同义突变的比例低于非结合肽。\n-   基础模型：精确超几何抽样模型。\n-   要求输出：表示为四舍五入到四位有效数字的小数的$p$值。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，因为它描述了一个在免疫基因组学中用于检测免疫选择信号（肿瘤免疫编辑）的标准假设检验框架。非同义突变与同义突变、MHC结合预测，以及它们分别作为免疫原性和中性进化的代理指标等概念，是该领域的基石。这个问题提法得当；它为构建一个$2 \\times 2$列联表提供了所有必要数据，并指明了要执行的精确统计检验（Fisher精确检验）以及假设的方向。语言客观而精确。数据虽然数值较小，但对于生物学实验来说并非不切实际，并且足以进行指定的计算。该问题并非提法不当、自相矛盾或微不足道。它需要直接应用一个基本的统计学原理。\n\n步骤3：结论与行动。\n问题被认为是有效的。将推导解答。\n\n问题要求使用Fisher精确检验计算一个单侧$p$值。该检验适用于分析列联表，尤其是在样本量较小的情况下，因为它计算在行变量和列变量独立的零假设（$H_0$）下，观测到给定数据或更极端数据的精确概率。在此背景下，$H_0$ 陈述了突变类型（非同义/同义）与MHC结合状态（结合肽/非结合肽）之间没有关联。\n\n首先，我们必须根据给定数据构建$2 \\times 2$列联表并计算边际总计。让行代表突变类型，列代表MHC结合状态。\n\n|               | 结合肽 | 非结合肽 | 行总计 |\n|---------------|---------|-------------|-----------|\n| 非同义 | $a = 1$ | $b = 9$     | $a+b = 10$  |\n| 同义    | $c = 4$ | $d = 6$     | $c+d = 10$  |\n| 列总计  | $a+c = 5$ | $b+d = 15$    | $N = 20$    |\n\n突变总数为 $N = 1+4+9+6 = 20$。\n行总计是非同义突变的总数（$10$）和同义突变的总数（$10$）。\n列总计是结合肽中的突变总数（$5$）和非结合肽中的突变总数（$15$）。\n\n在Fisher精确检验中，我们认为边际总计是固定的。在这些固定边际下，观测到任何特定表格的概率由超几何分布给出。具有单元格计数 $a, b, c, d$ 的表格的概率是：\n$$ P(a, b, c, d) = \\frac{\\binom{a+b}{a}\\binom{c+d}{c}}{\\binom{N}{a+c}} = \\frac{\\binom{a+c}{a}\\binom{b+d}{b}}{\\binom{N}{a+b}} $$\n让我们使用标准公式：\n$$ P(\\text{table}) = \\frac{(\\text{row 1 total})! (\\text{row 2 total})! (\\text{col 1 total})! (\\text{col 2 total})!}{N! a! b! c! d!} $$\n一个更直接的计算方法是使用基于单个单元格（例如单元格$a$）的二项式系数：\n$$ P(a) = \\frac{\\binom{a+b}{a}\\binom{c+d}{c}}{\\binom{N}{a+c}} = \\frac{\\binom{10}{a}\\binom{10}{5-a}}{\\binom{20}{5}} $$\n问题陈述了一个单侧假设，即结合肽中非同义突变的比例*更低*。这对应于检验“结合肽”类别中非同义突变的耗竭，意味着我们关心观测值$a=1$是否异常小。单侧$p$值是观测到给定表格的概率，以及所有其他更能支持此备择假设的更极端表格的概率之和。这里的“更极端”指的是单元格$a$的值小于或等于观测值$1$的表格。\n\n给定边际总计，$a$的最小可能值为 $\\max(0, (a+b)+(a+c)-N) = \\max(0, 10+5-20) = 0$。最大值为 $\\min(a+b, a+c) = \\min(10, 5) = 5$。所以，$a$的可能值为 $0, 1, 2, 3, 4, 5$。\n$p$值为 $p = P(a \\le 1) = P(a=1) + P(a=0)$。\n\n我们首先计算观测表格的概率，其中$a=1$。计数为$a=1, b=9, c=4, d=6$。\n$$ P(a=1) = \\frac{\\binom{10}{1}\\binom{10}{4}}{\\binom{20}{5}} $$\n我们计算二项式系数：\n$\\binom{10}{1} = 10$\n$\\binom{10}{4} = \\frac{10!}{4!6!} = \\frac{10 \\times 9 \\times 8 \\times 7}{4 \\times 3 \\times 2 \\times 1} = 210$\n$\\binom{20}{5} = \\frac{20!}{5!15!} = \\frac{20 \\times 19 \\times 18 \\times 17 \\times 16}{5 \\times 4 \\times 3 \\times 2 \\times 1} = 15504$\n所以，观测表格的概率是：\n$$ P(a=1) = \\frac{10 \\times 210}{15504} = \\frac{2100}{15504} $$\n\n接下来，我们计算更极端表格的概率，其中$a=0$。如果$a=0$，其他单元格由固定的边际总计决定：$c = 5-0=5$, $b = 10-0=10$, 以及 $d = 10-5=5$。计数为$a=0, b=10, c=5, d=5$。\n$$ P(a=0) = \\frac{\\binom{10}{0}\\binom{10}{5}}{\\binom{20}{5}} $$\n我们计算新的二项式系数：\n$\\binom{10}{0} = 1$\n$\\binom{10}{5} = \\frac{10!}{5!5!} = \\frac{10 \\times 9 \\times 8 \\times 7 \\times 6}{5 \\times 4 \\times 3 \\times 2 \\times 1} = 252$\n所以，这个更极端表格的概率是：\n$$ P(a=0) = \\frac{1 \\times 252}{15504} = \\frac{252}{15504} $$\n\n单侧$p$值是这些概率的总和：\n$$ p = P(a=1) + P(a=0) = \\frac{2100}{15504} + \\frac{252}{15504} = \\frac{2352}{15504} $$\n现在我们将此分数转换为小数，并按要求四舍五入到四位有效数字。\n$$ p \\approx 0.151702786... $$\n四舍五入到四位有效数字得到$0.1517$。\n这个$p$值$0.1517$大于常规的显著性水平（例如$0.05$），因此我们不拒绝零假设。在这样小的样本量下，观测到的耗竭在统计上不显著。", "answer": "$$\\boxed{0.1517}$$", "id": "2838574"}]}