{"hands_on_practices": [{"introduction": "模式识别的核心是受体与配体之间的生物物理相互作用。本练习将超越简单的“开/关”模型，带你定量地理解竞争性结合的动态过程。通过运用质量作用定律和平衡解离常数 $K_d$ 的第一性原理，你将计算在内源性损伤相关分子模式（DAMPs）存在的情况下，激活免疫反应所需的病原体相关分子模式（PAMPs）的最低浓度，从而深入理解免疫系统如何在高背景噪声的生理环境中精确地感知威胁 [@problem_id:2879814]。", "problem": "巨噬细胞上的一个单价模式识别受体 (PRR) 在同一结合位点识别两种相互排斥的配体：一种是病原体相关分子模式 (PAMP) 配体，其浓度表示为 $[P]$；另一种是损伤相关分子模式 (DAMP) 配体，其浓度表示为 $[D]$。该系统处于热力学平衡状态，配体相对于受体处于大的摩尔过量，因此游离配体浓度等于其总浓度，并且结合事件是独立的，没有协同性。PAMP的平衡解离常数为 $K_{d,P} = 10\\,\\text{nM}$，DAMP的平衡解离常数为 $K_{d,D} = 200\\,\\text{nM}$。在炎性组织微环境中，DAMP的游离浓度为 $[D] = 100\\,\\text{nM}$。\n\n只有当PRR被PAMP占据的分数占据率（而不仅仅是被任何配体占据）达到至少一个阈值 $\\tau = 0.60$ 时，下游的活化B细胞核因子$\\kappa$-轻链增强子 (NF-$\\kappa$B) 信号模块才会被触发。仅使用平衡解离常数和平衡时质量作用的基本定义，并从第一性原理出发，确定在存在竞争性DAMP的情况下，达到该占据率阈值所需的PAMP的最低游离浓度 $[P]_{\\min}$。\n\n将您的最终结果四舍五入至三位有效数字，并以 $\\text{nM}$ 为单位表示。计算出最低浓度后，简要解释竞争性DAMP对信号阈值的影响，即 $[P]_{\\min}$ 如何随 $[D]$、$K_{d,D}$ 和阈值 $\\tau$ 变化。", "solution": "我们从质量作用定律和平衡解离常数的定义开始。令 $[R]$ 表示游离受体浓度，$[RP]$ 表示与PAMP结合的受体浓度，$[RD]$ 表示与DAMP结合的受体浓度。对于在单一结合位点上相互排斥的单价结合，解离常数定义为\n$$\nK_{d,P} = \\frac{[R][P]}{[RP]}, \\qquad K_{d,D} = \\frac{[R][D]}{[RD]}.\n$$\n整理后得到结合与游离之比\n$$\n\\frac{[RP]}{[R]} = \\frac{[P]}{K_{d,P}}, \\qquad \\frac{[RD]}{[R]} = \\frac{[D]}{K_{d,D}}.\n$$\n总受体浓度是这三种状态的总和：\n$$\n[R]_{\\text{tot}} = [R] + [RP] + [RD] = [R]\\!\\left(1 + \\frac{[P]}{K_{d,P}} + \\frac{[D]}{K_{d,D}}\\right).\n$$\nPAMP的分数占据率是处于 $[RP]$ 状态的受体所占的比例：\n$$\nf_{P} \\equiv \\frac{[RP]}{[R]_{\\text{tot}}} = \\frac{\\dfrac{[P]}{K_{d,P}}}{1 + \\dfrac{[P]}{K_{d,P}} + \\dfrac{[D]}{K_{d,D}}}.\n$$\n设 $\\tau$ 为信号传导所需的占据率阈值。我们寻求满足 $f_{P} \\ge \\tau$ 的最小 $[P]$。由于函数对 $[P]$ 的单调性，我们可以通过求解等式 $f_{P} = \\tau$ 来找到最低浓度。设 $x \\equiv [P]$ 并定义 $\\beta \\equiv \\dfrac{[D]}{K_{d,D}}$。则\n$$\n\\tau = \\frac{\\dfrac{x}{K_{d,P}}}{1 + \\dfrac{x}{K_{d,P}} + \\beta}.\n$$\n将分子和分母相乘来求解 $x$：\n$$\n\\tau\\!\\left(1 + \\frac{x}{K_{d,P}} + \\beta\\right) = \\frac{x}{K_{d,P}} \\quad \\Longrightarrow \\quad \\tau + \\tau\\beta + \\tau\\frac{x}{K_{d,P}} = \\frac{x}{K_{d,P}}.\n$$\n整理含 $x$ 的项：\n$$\n\\left(1 - \\tau\\right)\\frac{x}{K_{d,P}} = \\tau\\left(1 + \\beta\\right),\n$$\n因此，达到该阈值的最低浓度是\n$$\nx_{\\min} = [P]_{\\min} = \\frac{\\tau}{1 - \\tau}\\,K_{d,P}\\left(1 + \\beta\\right) = \\frac{\\tau}{1 - \\tau}\\,K_{d,P}\\left(1 + \\frac{[D]}{K_{d,D}}\\right).\n$$\n现在代入给定的参数值 $K_{d,P} = 10\\,\\text{nM}$，$K_{d,D} = 200\\,\\text{nM}$，$[D] = 100\\,\\text{nM}$ 和 $\\tau = 0.60$：\n$$\n\\beta = \\frac{[D]}{K_{d,D}} = \\frac{100\\,\\text{nM}}{200\\,\\text{nM}} = 0.5, \\qquad \\frac{\\tau}{1-\\tau} = \\frac{0.60}{0.40} = 1.5,\n$$\n$$\n[P]_{\\min} = \\left(1.5\\right)\\left(10\\,\\text{nM}\\right)\\left(1 + 0.5\\right) = 1.5 \\times 10\\,\\text{nM} \\times 1.5 = 22.5\\,\\text{nM}.\n$$\n四舍五入至三位有效数字并以 $\\text{nM}$ 为单位表示，最低PAMP浓度为 $22.5\\,\\text{nM}$。\n\n对下游信号阈值的影响：表达式\n$$\n[P]_{\\min} = \\frac{\\tau}{1 - \\tau}\\,K_{d,P}\\left(1 + \\frac{[D]}{K_{d,D}}\\right)\n$$\n表明，竞争性DAMP的存在通过一个乘法因子 $\\left(1 + \\dfrac{[D]}{K_{d,D}}\\right)$ 提高了对PAMP的需求。相对于没有竞争的情况，即 $[P]_{\\min}^{(0)} = \\dfrac{\\tau}{1-\\tau}K_{d,P}$，DAMP将阈值提高到 $[P]_{\\min} = [P]_{\\min}^{(0)}\\left(1 + \\dfrac{[D]}{K_{d,D}}\\right)$。因此，更高的 $[D]$ 或更弱的DAMP亲和力（即更大的 $K_{d,D}$ 导致 $\\dfrac{[D]}{K_{d,D}}$ 减小）分别会增加或减少触发NF-$\\kappa$B所需的PAMP浓度，而更高的 $\\tau$ 则通过因子 $\\dfrac{\\tau}{1-\\tau}$ 施加超线性的增长。", "answer": "$$\\boxed{22.5}$$", "id": "2879814"}, {"introduction": "在免疫学研究中，鉴定一个新的 DAMP 是一项关键任务，但由于无处不在的、极其有效的 PAMP（如脂多糖）污染风险，这项工作充满了挑战。本练习是一个关于实验设计的思想实验，要求你组合一系列“金标准”实验，以令人信服地证明一个候选分子的 DAMP 功能 [@problem_id:2879779]。这项实践旨在磨练你作为研究科学家的核心技能：批判性思维以及设计严谨、对照完善的实验的能力。", "problem": "一名研究人员分离出一种人类核蛋白候选物，记为 $\\mathcal{D}$，它从坏死细胞中释放，并被假设可作为一种损伤相关分子模式 (DAMP) 发挥功能。目标是通过应用相关标准来验证 $\\mathcal{D}$ 是一种真正的 DAMP，这些标准需要能够排除潜在的病原体相关分子模式 (PAMP) 污染物，并证明其对特定模式识别受体 (PRR) 的依赖性。研究人员可以使用原代髓系细胞的体外刺激和体内无菌损伤模型，并结合生物化学纯化、酶处理、药理学抑制剂和遗传扰动等方法。综合来看，以下哪些实验标准能最令人信服地证明 $\\mathcal{D}$ 是一种内源性 DAMP，而非 PAMP 污染物的效应，并且其活性是受体依赖的？请选择所有适用项。\n\n注意：所有缩略语在首次使用时均已定义。DAMP 指损伤相关分子模式 (Damage-Associated Molecular Pattern)，PAMP 指病原体相关分子模式 (Pathogen-Associated Molecular Pattern)，PRR 指模式识别受体 (Pattern Recognition Receptor)。鲎阿米巴样细胞裂解物 (Limulus Amebocyte Lysate, LAL) 是一种用于检测内毒素的分析方法。内毒素单位 (Endotoxin Units, EU) 是 LAL 的读数单位。脱氧核糖核酸酶 (Deoxyribonuclease, DNase) 和核糖核酸酶 (Ribonuclease, RNase) 是核酸酶。晚期糖基化终末产物受体 (Receptor for Advanced Glycation Endproducts, RAGE) 是一种候选 DAMP 受体。Toll 样受体 $4$ (Toll-like Receptor $4$, TLR$4$) 和 Toll 样受体 $2$ (Toll-like Receptor $2$, TLR$2$) 是典型的 PAMP 传感器。人胚肾 293 (Human Embryonic Kidney 293, HEK$293$) 细胞用于报告基因检测。环 GMP-AMP 合酶 (Cyclic GMP-AMP synthase, cGAS) 和干扰素基因刺激因子 (Stimulator of Interferon Genes, STING) 介导胞质 DNA 感应。\n\nA. 纯化的 $\\mathcal{D}$ 在原代小鼠巨噬细胞中诱导剂量依赖性的细胞因子反应；其活性可被蛋白酶K和热变性消除，但不受 DNase 和 RNase 的影响。通过 LAL 和重组C因子检测法，内毒素均低于检测限（$0.01$ EU 每 $\\mu$g 蛋白），并且其活性不受多粘菌素B (polymyxin B) 的影响。\n\nB. 在 $Tlr4^{-/-}$ 和 $Tlr2^{-/-}$ 巨噬细胞中，对 $\\mathcal{D}$ 的细胞因子反应没有变化，但在 $Rage^{-/-}$ 巨噬细胞中该反应消失，并通过重新表达 RAGE 得以恢复；一种中和性抗 RAGE 抗体可阻断该反应。\n\nC. 无菌小鼠对注射的 $\\mathcal{D}$ 未能产生炎症反应，这表明其对微生物群有依赖性，从而排除了 DAMP 机制。\n\nD. 在体外刺激过程中添加广谱抗生素可消除 PAMP 污染物；在抗生素存在下活性持续存在足以断定其具有 DAMP 功能。\n\nE. 在一个无菌肝脏缺血再灌注损伤模型中，血浆中的细胞外 $\\mathcal{D}$ 在 $1$ 小时内升高，并与中性粒细胞浸润相关；施用针对假定受体的阻断性抗体可使炎症细胞因子减少 $>80\\%$，且不改变细胞外 $\\mathcal{D}$ 的水平。\n\nF. 在一个过表达 TLR$4$ 的 HEK$293$ 细胞系中，$\\mathcal{D}$ 触发了报告基因活化，并且多粘菌素B (polymyxin B) 阻断了该反应；因此，结论是 TLR$4$ 是该 DAMP 的受体。\n\nG. 超速离心和 Triton X-$100$ 处理不会降低 $\\mathcal{D}$ 的活性，从而排除了刺激 TLR$2$ 的脂蛋白或脂肽污染物；$Tlr2^{-/-}$ 细胞对 $\\mathcal{D}$ 的反应正常。\n\nH. 活性不需要转染试剂，并且 $cGas^{-/-}$ 和 $Sting^{-/-}$ 巨噬细胞对细胞外添加的 $\\mathcal{D}$ 反应正常，从而排除了胞质核酸感应作为其激活机制。", "solution": "必须首先评估问题陈述的有效性。\n\n### 步骤1：提取已知信息\n- 一种人类核蛋白候选物记为 $\\mathcal{D}$。\n- $\\mathcal{D}$ 从坏死细胞中释放，并被假设为一种损伤相关分子模式 (DAMP)。\n- 目标是通过排除病原体相关分子模式 (PAMP) 污染物并证明其对特定模式识别受体 (PRR) 的依赖性，来验证 $\\mathcal{D}$ 是一种 DAMP。\n- 可用方法包括：原代髓系细胞的*体外*刺激、*体内*无菌损伤模型、生物化学纯化、酶处理（脱氧核糖核酸酶 (DNase)、核糖核酸酶 (RNase)）、药理学抑制剂和遗传扰动。\n- 提供的定义：鲎阿米巴样细胞裂解物 (LAL)、内毒素单位 (EU)、晚期糖基化终末产物受体 (RAGE)、Toll 样受体 $4$ (TLR$4$)、Toll 样受体 $2$ (TLR$2$)、人胚肾 293 (HEK$293$) 细胞、环 GMP-AMP 合酶 (cGAS)、干扰素基因刺激因子 (STING)。\n\n### 步骤2：使用提取的已知信息进行验证\n该问题具有科学依据，提出了免疫学中一个经典且关键的问题：如何区分真正的内源性危险信号 (DAMP) 与具有干扰性的微生物污染物 (PAMP)。其中涉及的概念、分子（如 TLR$4$、RAGE）和实验技术（如基因敲除细胞、酶降解、内毒素检测）都是该领域的标准和基础内容。该问题提问得当、客观且信息自足，提供了足够的信息，可以根据既定的科学原理来评估所提出的实验标准。该问题不违反任何有效性标准。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。将通过分析每个选项来推导解决方案。\n\n---\n\n为了令人信服地证明 $\\mathcal{D}$ 是一种通过特定受体起作用的真正 DAMP，实验证据必须严格满足以下几个主要标准：\n$1$. 生物活性必须是蛋白 $\\mathcal{D}$ 本身固有的，而不是PAMP（如内毒素、细菌脂蛋白、微生物核酸）或其他DAMP（如宿主DNA）污染的结果。\n$2$. 活性必须由特定的 PRR 介导，并通过遗传学和药理学的功能丧失和功能获得实验来证明。\n$3$. DAMP-受体轴必须被证明在无菌组织损伤的生理性*体内*环境中具有相关性。\n\n现在将根据这些严格的标准评估每个选项。\n\n**选项 A：** 纯化的 $\\mathcal{D}$ 在原代小鼠巨噬细胞中诱导剂量依赖性的细胞因子反应；其活性可被蛋白酶K和热变性消除，但不受 DNase 和 RNase 的影响。通过 LAL 和重组C因子检测法，内毒素均低于检测限（$0.01$ EU 每 $\\mu$g 蛋白），并且其活性不受多粘菌素B (polymyxin B) 的影响。\n*   **分析**：该选项为标准 $1$ 提供了坚实的基础。剂量依赖性反应是预期的。对蛋白酶K和热的敏感性证实了活性剂是一种具有特定三级结构的蛋白质。对 DNase 和 RNase 的不敏感性排除了污染性核酸是活性部分的可能性。至关重要的是，它通过两种独立的定量检测（显示水平可忽略不计）和一种使用多粘菌素B (polymyxin B) 的功能性检测（证实这一痕量并非活性的原因），解决了最常见的污染物——内毒素 (LPS) 的问题。这是一套设计良好的初步验证实验。\n*   **结论**：**正确**。这套对照实验对于确定活性配体的生化性质至关重要。\n\n**选项 B：** 在 $Tlr4^{-/-}$ 和 $Tlr2^{-/-}$ 巨噬细胞中，对 $\\mathcal{D}$ 的细胞因子反应没有变化，但在 $Rage^{-/-}$ 巨噬细胞中该反应消失，并通过重新表达 RAGE 得以恢复；一种中和性抗 RAGE 抗体可阻断该反应。\n*   **分析**：该选项为标准 $2$ 提供了极强的证据，并进一步加强了标准 $1$。$Tlr4^{-/-}$ 和 $Tlr2^{-/-}$ 巨噬细胞的正常反应为排除 TLR$4$ 配体 (LPS) 和 TLR$2$ 配体 (脂蛋白) 的污染提供了遗传学上的“金标准”。$Rage^{-/-}$ 巨噬细胞反应的丧失是证明 RAGE 为其受体的明确遗传学功能丧失证据。这一点通过功能获得“拯救”实验（重新表达 RAGE）得到了有力证实，并通过使用抗 RAGE 抗体进行药理学阻断得到佐证。这种遗传学和药理学证据的组合是受体鉴定的最高标准。\n*   **结论**：**正确**。这些实验明确地鉴定了受体，并为排除 PAMP 污染提供了强有力的正交证据。\n\n**选项 C：** 无菌小鼠对注射的 $\\mathcal{D}$ 未能产生炎症反应，这表明其对微生物群有依赖性，从而排除了 DAMP 机制。\n*   **分析**：该选项描述了一个假设性的结果，并得出了一个可疑的结论。无菌小鼠没有反应并不自动“排除 DAMP 机制”。微生物群可能是预激活免疫系统所必需的，其缺失可能使系统对包括 DAMP 在内的多种刺激反应低下。这一发现需要进一步研究；它本身不是一个能够确立或否定 DAMP 功能的标准，所提出的结论在逻辑上是跳跃的。\n*   **结论**：**错误**。\n\n**选项 D：** 在体外刺激过程中添加广谱抗生素可消除 PAMP 污染物；在抗生素存在下活性持续存在足以断定其具有 DAMP 功能。\n*   **分析**：这个对照实验存在根本性缺陷。抗生素能杀死活细菌，但不能消除或灭活纯化的 $\\mathcal{D}$ 制剂中预先存在的、稳定的 PAMP，如内毒素或脂蛋白。因此，在抗生素存在下活性持续存在并不“足以断定其具有 DAMP 功能”。这是一项薄弱、易受干扰的实验，容易导致假阳性结论。\n*   **结论**：**错误**。\n\n**选项 E：** 在一个无菌肝脏缺血再灌注损伤模型中，血浆中的细胞外 $\\mathcal{D}$ 在 $1$ 小时内升高，并与中性粒细胞浸润相关；施用针对假定受体的阻断性抗体可使炎症细胞因子减少 $>80\\%$，且不改变细胞外 $\\mathcal{D}$ 的水平。\n*   **分析**：该选项提供了必要的*体内*验证（标准 $3$）。它证明了候选 DAMP $\\mathcal{D}$ 在相关的无菌损伤过程中会内源性释放，并且其水平与炎症病理相关。最重要的是，它表明阻断已识别的受体（如选项 B 中的 RAGE）能在*体内*显著减轻炎症。抗体不影响 $\\mathcal{D}$ 水平的对照证实了该效果是由于信号阻断所致。这便将分子机制与生理或病理结果联系了起来。\n*   **结论**：**正确**。该实验对于证明生理相关性至关重要。\n\n**选项 F：** 在一个过表达 TLR$4$ 的 HEK$293$ 细胞系中，$\\mathcal{D}$ 触发了报告基因活化，并且多粘菌素B (polymyxin B) 阻断了该反应；因此，结论是 TLR$4$ 是该 DAMP 的受体。\n*   **分析**：此处描述的实验结果是内毒素 (LPS) 污染的典型特征。HEK$293$ 细胞是报告细胞，仅在过表达 TLR$4$（及其共受体）时才对 TLR$4$ 激动剂产生反应。多粘菌素B (polymyxin B) 这种 LPS 特异性拮抗剂能阻断该信号，是其为 LPS 污染的明确证据。所作出的“TLR$4$ 是该 DAMP 的受体”的结论与正确解释恰恰相反。这个结果将证伪 $\\mathcal{D}$ 是活性分子的假说，反而证明该制剂受到了污染。\n*   **结论**：**错误**。\n\n**选项 G：** 超速离心和 Triton X-$100$ 处理不会降低 $\\mathcal{D}$ 的活性，从而排除了刺激 TLR$2$ 的脂蛋白或脂肽污染物；$Tlr2^{-/-}$ 细胞对 $\\mathcal{D}$ 的反应正常。\n*   **分析**：该选项提供了针对第二大类 PAMP 污染物——激活 TLR$2$ 的细菌脂蛋白——的严格对照。它将生化方法（超速离心和去垢剂处理以去除/破坏脂化分子）与遗传学金标准对照（$Tlr2^{-/-}$ 细胞反应正常）相结合。这是满足标准 $1$ 的一个关键步骤。这也补充了选项 B 中的证据，后者也使用了 $Tlr2^{-/-}$ 细胞。\n*   **结论**：**正确**。这是排除脂蛋白污染所必需的、可靠的对照。\n\n**选项 H：** 活性不需要转染试剂，并且 $cGas^{-/-}$ 和 $Sting^{-/-}$ 巨噬细胞对细胞外添加的 $\\mathcal{D}$ 反应正常，从而排除了胞质核酸感应作为其激活机制。\n*   **分析**：该选项解决了 DNA 污染的可能性，DNA 既可以作为 DAMP（线粒体 DNA），也可以作为 PAMP（细菌 DNA）。由于 $\\mathcal{D}$ 是一种核蛋白，与 DNA 共纯化是极有可能的。cGAS-STING 通路是胞质 DNA 的主要传感器。证明活性不需要转染（即强制进入胞质），并且更明确的是，在 $cGas^{-/-}$ 和 $Sting^{-/-}$ 细胞中活性不受影响，这严格排除了这一主要的替代激活途径。\n*   **结论**：**正确**。考虑到候选蛋白 $\\mathcal{D}$ 的核来源，这是一个关键的对照。\n\n**总结：**\n一个“令人信服的”案例需要一种多管齐下的方法，该方法能彻底确定配体的生化性质，严格排除所有可能的污染物，明确鉴定受体，并证明其*体内*生理相关性。选项 A、B、E、G 和 H 共同达到了这一高标准。", "answer": "$$\\boxed{ABEGH}$$", "id": "2879779"}, {"introduction": "现代免疫学将单个细胞视为一个复杂的信息处理系统，它必须整合来自多个传感器的信号才能做出可靠的决策。本练习将介绍一种强大的定量框架——贝叶斯推断，来形式化这一概念 [@problem_id:2879739]。你将构建一个分类器，学习如何整合来自不同模式识别受体（每个受体对 PAMPs 和 DAMPs 有着不同的偏好）的模糊信号，以计算出关于威胁性质（例如，病毒感染或无菌性损伤）的最终后验概率，从而体验系统免疫学和计算生物学的交叉魅力。", "problem": "您将设计并实现一个贝叶斯分类器，该分类器整合三种模式识别受体的输出，用以估计观察到的细胞状态是由病毒感染而非无菌性损伤引起的后验概率。这三种受体是 Toll-like receptor 4 (TLR4)、Retinoic acid-inducible gene I (RIG-I) 和 cyclic GMP-AMP synthase (cGAS)。从免疫学角度来看，RIG-I 和 cGAS 倾向于对病毒感染期间产生的病原体相关分子模式 (PAMPs) 产生强烈反应，而 TLR4 和 cGAS 则可被无菌性损伤期间释放的损伤相关分子模式 (DAMPs) 激活。\n\n使用的基本原理：\n- 用于两个竞争性假设的贝叶斯定理，其中病毒感染由假设 $H_{\\mathrm{V}}$ 表示，无菌性损伤由 $H_{\\mathrm{S}}$ 表示。\n- 对数正态分布的定义：如果 $X \\sim \\mathrm{LogNormal}(\\mu,\\sigma^{2})$，则当 $x0$ 时，$p(x \\mid \\mu,\\sigma) = \\dfrac{1}{x \\sigma \\sqrt{2\\pi}} \\exp\\!\\left(-\\dfrac{(\\ln x - \\mu)^{2}}{2\\sigma^{2}}\\right)$。\n- 在给定真实潜在状态 $H \\in \\{H_{\\mathrm{V}}, H_{\\mathrm{S}}\\}$ 的条件下，各受体输出是条件独立的。\n\n基于免疫学和测量实践的建模假设：\n- 每个受体的输出是一个相对于静息基线的严格为正的无量纲倍数变化 $s_{i}  0$。\n- 给定一个假设 $H \\in \\{H_{\\mathrm{V}}, H_{\\mathrm{S}}\\}$，三个受体的输出是条件独立的，并且每个都服从对数正态分布。对于某个受体，假定其受体特异性标准差在不同假设下是相等的，这反映了两种条件下相当的检测噪声。\n- 具体来说，对于受体 $i \\in \\{\\mathrm{TLR4}, \\mathrm{RIGI}, \\mathrm{cGAS}\\}$，我们假设 $s_{i} \\mid H \\sim \\mathrm{LogNormal}(\\mu_{i,H}, \\sigma_{i}^{2})$，其参数为：\n  - TLR4: $(\\mu_{\\mathrm{TLR4},H_{\\mathrm{V}}}, \\mu_{\\mathrm{TLR4},H_{\\mathrm{S}}}, \\sigma_{\\mathrm{TLR4}}) = (\\ln(1.4), \\ln(3.0), 0.4)$。\n  - RIG-I: $(\\mu_{\\mathrm{RIGI},H_{\\mathrm{V}}}, \\mu_{\\mathrm{RIGI},H_{\\mathrm{S}}}, \\sigma_{\\mathrm{RIGI}}) = (\\ln(5.0), \\ln(1.2), 0.35)$。\n  - cGAS: $(\\mu_{\\mathrm{cGAS},H_{\\mathrm{V}}}, \\mu_{\\mathrm{cGAS},H_{\\mathrm{S}}}, \\sigma_{\\mathrm{cGAS}}) = (\\ln(3.0), \\ln(1.8), 0.5)$。\n- 病毒感染的先验概率：$\\Pr(H_{\\mathrm{V}}) = 0.35$，且 $\\Pr(H_{\\mathrm{S}}) = 1 - 0.35 = 0.65$。\n\n任务：\n- 给定一组观察到的倍数变化三元组 $(s_{\\mathrm{TLR4}}, s_{\\mathrm{RIGI}}, s_{\\mathrm{cGAS}})$，使用贝叶斯定理和上述模型计算后验概率 $\\Pr(H_{\\mathrm{V}} \\mid s_{\\mathrm{TLR4}}, s_{\\mathrm{RIGI}}, s_{\\mathrm{cGAS}})$。将最终的后验概率表示为闭区间 $[0,1]$ 内的一个小数。\n\n实现的数值细节：\n- 使用条件独立性假设，将似然函数分解为各受体的乘积。\n- 使用指定的 $(\\mu,\\sigma)$ 参数的对数正态似然函数。\n- 为保证数值稳定性，如果需要，可通过对数优势比形式计算后验概率：后验对数优势比等于先验对数优势比加上各受体对数似然比的总和。\n\n测试套件：\n- 使用以下五个测试用例，每个都是一个由严格为正的浮点数构成的元组 $(s_{\\mathrm{TLR4}}, s_{\\mathrm{RIGI}}, s_{\\mathrm{cGAS}})$：\n  - 案例 $1$：$(1.2, 6.0, 3.2)$。\n  - 案例 $2$：$(3.8, 1.1, 1.9)$。\n  - 案例 $3$：$(3.0, 4.5, 2.5)$。\n  - 案例 $4$：$(1.0, 1.0, 1.0)$。\n  - 案例 $5$：$(1.0, 10.0, 6.0)$。\n\n要求的程序输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的后验概率列表（每个测试用例一个），每个概率都四舍五入到小数点后六位，例如 $[0.123456,0.654321]$。", "solution": "该问题陈述是应用贝叶斯推断中的一个有效练习。它具有科学依据，问题定义明确，客观，并包含了推导唯一解所需的所有必要信息。该模型虽然是对复杂免疫学的简化，但基于合理的假设和公认的统计方法。我们将继续进行推导和计算。\n\n我们的目标是，在给定一组三个受体的测量值 $\\mathbf{s} = (s_{\\mathrm{TLR4}}, s_{\\mathrm{RIGI}}, s_{\\mathrm{cGAS}})$ 的情况下，计算病毒感染 $H_{\\mathrm{V}}$ 的后验概率。与之竞争的假设是无菌性损伤 $H_{\\mathrm{S}}$。后验概率记为 $\\Pr(H_{\\mathrm{V}} \\mid \\mathbf{s})$。\n\n根据贝叶斯定理，后验概率由下式给出：\n$$\n\\Pr(H_{\\mathrm{V}} \\mid \\mathbf{s}) = \\frac{\\Pr(\\mathbf{s} \\mid H_{\\mathrm{V}}) \\Pr(H_{\\mathrm{V}})}{\\Pr(\\mathbf{s})}\n$$\n分母 $\\Pr(\\mathbf{s})$ 是证据的边缘概率，通过全概率定律展开为：\n$$\n\\Pr(\\mathbf{s}) = \\Pr(\\mathbf{s} \\mid H_{\\mathrm{V}}) \\Pr(H_{\\mathrm{V}}) + \\Pr(\\mathbf{s} \\mid H_{\\mathrm{S}}) \\Pr(H_{\\mathrm{S}})\n$$\n将此代入主表达式可得：\n$$\n\\Pr(H_{\\mathrm{V}} \\mid \\mathbf{s}) = \\frac{\\Pr(\\mathbf{s} \\mid H_{\\mathrm{V}}) \\Pr(H_{\\mathrm{V}})}{\\Pr(\\mathbf{s} \\mid H_{\\mathrm{V}}) \\Pr(H_{\\mathrm{V}}) + \\Pr(\\mathbf{s} \\mid H_{\\mathrm{S}}) \\Pr(H_{\\mathrm{S}})}\n$$\n直接用较小的概率值进行计算存在数值下溢的风险。一种更稳健的方法是使用对数优势比公式。支持 $H_{\\mathrm{V}}$ 而非 $H_{\\mathrm{S}}$ 的后验优势比为：\n$$\n\\frac{\\Pr(H_{\\mathrm{V}} \\mid \\mathbf{s})}{\\Pr(H_{\\mathrm{S}} \\mid \\mathbf{s})} = \\frac{\\Pr(\\mathbf{s} \\mid H_{\\mathrm{V}})}{\\Pr(\\mathbf{s} \\mid H_{\\mathrm{S}})} \\times \\frac{\\Pr(H_{\\mathrm{V}})}{\\Pr(H_{\\mathrm{S}})}\n$$\n对此表达式取自然对数，得到后验对数优势比，我们记为 $\\Lambda$：\n$$\n\\Lambda = \\ln\\left(\\frac{\\Pr(\\mathbf{s} \\mid H_{\\mathrm{V}})}{\\Pr(\\mathbf{s} \\mid H_{\\mathrm{S}})}\\right) + \\ln\\left(\\frac{\\Pr(H_{\\mathrm{V}})}{\\Pr(H_{\\mathrm{S}})}\\right)\n$$\n第一项是对数似然比 (LLR)，第二项是先验对数优势比。\n\n问题陈述指出，在给定假设 $H \\in \\{H_{\\mathrm{V}}, H_{\\mathrm{S}}\\}$ 的条件下，三个受体的输出 $s_{i}$ (其中 $i \\in \\{\\mathrm{TLR4}, \\mathrm{RIGI}, \\mathrm{cGAS}\\}$）是条件独立的。这个关键性质允许我们将联合似然函数分解为：\n$$\n\\Pr(\\mathbf{s} \\mid H) = \\prod_{i} \\Pr(s_i \\mid H)\n$$\n因此，总对数似然比是每个受体各自的对数似然比之和：\n$$\n\\text{LLR}_{\\text{total}} = \\ln\\left(\\frac{\\prod_{i} \\Pr(s_i \\mid H_{\\mathrm{V}})}{\\prod_{i} \\Pr(s_i \\mid H_{\\mathrm{S}})}\\right) = \\sum_{i} \\ln\\left(\\frac{\\Pr(s_i \\mid H_{\\mathrm{V}})}{\\Pr(s_i \\mid H_{\\mathrm{S}})}\\right) = \\sum_{i} \\left[ \\ln(\\Pr(s_i \\mid H_{\\mathrm{V}})) - \\ln(\\Pr(s_i \\mid H_{\\mathrm{S}})) \\right]\n$$\n每个观测值 $s_i$ 都通过对数正态分布 $s_i \\mid H \\sim \\mathrm{LogNormal}(\\mu_{i,H}, \\sigma_i^2)$ 进行建模，其概率密度函数为：\n$$\n\\Pr(s_i \\mid H) = \\frac{1}{s_i \\sigma_i \\sqrt{2\\pi}} \\exp\\left( -\\frac{(\\ln s_i - \\mu_{i,H})^2}{2\\sigma_i^2} \\right)\n$$\n该似然函数的自然对数为：\n$$\n\\ln(\\Pr(s_i \\mid H)) = -\\ln(s_i) - \\ln(\\sigma_i) - \\frac{1}{2}\\ln(2\\pi) - \\frac{(\\ln s_i - \\mu_{i,H})^2}{2\\sigma_i^2}\n$$\n单个受体 $i$ 的对数似然比即为：\n$$\n\\text{LLR}_i = \\ln(\\Pr(s_i \\mid H_{\\mathrm{V}})) - \\ln(\\Pr(s_i \\mid H_{\\mathrm{S}})) = \\frac{(\\ln s_i - \\mu_{i,H_{\\mathrm{S}}})^2}{2\\sigma_i^2} - \\frac{(\\ln s_i - \\mu_{i,H_{\\mathrm{V}}})^2}{2\\sigma_i^2}\n$$\n后验对数优势比 $\\Lambda$ 的计算方法是：将所有三个受体的这些项相加，再加上先验对数优势比：\n$$\n\\Lambda = \\ln\\left(\\frac{\\Pr(H_{\\mathrm{V}})}{\\Pr(H_{\\mathrm{S}})}\\right) + \\sum_{i \\in \\{\\mathrm{TLR4}, \\mathrm{RIGI}, \\mathrm{cGAS}\\}} \\text{LLR}_i\n$$\n最后，使用 logistic (sigmoid) 函数从后验对数优势比中恢复后验概率 $\\Pr(H_{\\mathrm{V}} \\mid \\mathbf{s})$：\n$$\n\\Pr(H_{\\mathrm{V}} \\mid \\mathbf{s}) = \\frac{1}{1 + \\exp(-\\Lambda)}\n$$\n计算步骤如下：\n$1$. 计算先验对数优势比：$\\ln(\\frac{0.35}{0.65})$。\n$2$. 对于每个测试用例 $(s_{\\mathrm{TLR4}}, s_{\\mathrm{RIGI}}, s_{\\mathrm{cGAS}})$：\n    a. 将总对数似然比初始化为 $0$。\n    b. 对于每个受体 $i \\in \\{\\mathrm{TLR4}, \\mathrm{RIGI}, \\mathrm{cGAS}\\}$，使用相应的测量值 $s_i$ 和提供的参数 $(\\mu_{i,H_{\\mathrm{V}}}, \\mu_{i,H_{\\mathrm{S}}}, \\sigma_{i})$ 计算其对 LLR 的贡献。这通过计算观测值在每个假设 $H_{\\mathrm{V}}$ 和 $H_{\\mathrm{S}}$ 下的对数似然，并求其差值来实现。\n    c. 将各个 LLR 相加。\n    d. 加上先验对数优势比，从而得到后验对数优势比 $\\Lambda$。\n    e. 使用 logistic 函数计算后验概率 $\\Pr(H_{\\mathrm{V}} \\mid \\mathbf{s})$。\n\n此过程将针对给定的测试用例实施。我们将使用提供的参数值：\n- 先验概率： $\\Pr(H_{\\mathrm{V}}) = 0.35$, $\\Pr(H_{\\mathrm{S}}) = 0.65$.\n- TLR4: $(\\mu_{\\mathrm{V}}, \\mu_{\\mathrm{S}}, \\sigma) = (\\ln(1.4), \\ln(3.0), 0.4)$.\n- RIG-I: $(\\mu_{\\mathrm{V}}, \\mu_{\\mathrm{S}}, \\sigma) = (\\ln(5.0), \\ln(1.2), 0.35)$.\n- cGAS: $(\\mu_{\\mathrm{V}}, \\mu_{\\mathrm{S}}, \\sigma) = (\\ln(3.0), \\ln(1.8), 0.5)$.\n\n该实现将利用数值库来确保对数和指数函数的精确计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import lognorm\n\ndef solve():\n    \"\"\"\n    Computes the posterior probability of viral infection for five test cases using a Bayesian classifier.\n    \"\"\"\n    \n    # Define the five test cases as triples of receptor fold-changes.\n    # Format: (s_TLR4, s_RIGI, s_cGAS)\n    test_cases = [\n        (1.2, 6.0, 3.2),\n        (3.8, 1.1, 1.9),\n        (3.0, 4.5, 2.5),\n        (1.0, 1.0, 1.0),\n        (1.0, 10.0, 6.0),\n    ]\n\n    # Define the parameters for the log-normal distributions for each receptor.\n    # H_V: Viral infection hypothesis\n    # H_S: Sterile injury hypothesis\n    params = {\n        'TLR4': {'mu_V': np.log(1.4), 'mu_S': np.log(3.0), 'sigma': 0.4},\n        'RIGI': {'mu_V': np.log(5.0), 'mu_S': np.log(1.2), 'sigma': 0.35},\n        'cGAS': {'mu_V': np.log(3.0), 'mu_S': np.log(1.8), 'sigma': 0.5},\n    }\n\n    # Define the prior probabilities for the hypotheses.\n    prior_V = 0.35\n    prior_S = 1.0 - prior_V\n\n    # Calculate the log-prior odds, ln(P(H_V) / P(H_S)).\n    log_prior_odds = np.log(prior_V / prior_S)\n    \n    results = []\n    \n    # Iterate through each test case to compute the posterior probability.\n    for case in test_cases:\n        s_tlr4, s_rigi, s_cgas = case\n        s_values = {'TLR4': s_tlr4, 'RIGI': s_rigi, 'cGAS': s_cgas}\n        \n        # Initialize the total log-likelihood ratio (LLR).\n        total_llr = 0.0\n        \n        # Calculate the LLR by summing the contributions from each receptor.\n        for receptor, p in params.items():\n            s_val = s_values[receptor]\n            \n            # The scale parameter for scipy's lognorm is exp(mu).\n            # The shape parameter 's' is our sigma.\n            \n            # Log-likelihood of the observation given viral infection (H_V).\n            log_lik_V = lognorm.logpdf(s_val, s=p['sigma'], scale=np.exp(p['mu_V']))\n            \n            # Log-likelihood of the observation given sterile injury (H_S).\n            log_lik_S = lognorm.logpdf(s_val, s=p['sigma'], scale=np.exp(p['mu_S']))\n            \n            # Add the individual LLR for this receptor to the total.\n            total_llr += log_lik_V - log_lik_S\n            \n        # The log-posterior odds is the sum of the log-prior odds and the total LLR.\n        log_posterior_odds = log_prior_odds + total_llr\n        \n        # Convert the log-posterior odds to a posterior probability using the logistic function.\n        # P(H_V | s) = 1 / (1 + exp(-log_posterior_odds))\n        posterior_V = 1.0 / (1.0 + np.exp(-log_posterior_odds))\n        \n        # Store the result formatted to six decimal places.\n        results.append(f\"{posterior_V:.6f}\")\n\n    # Print the final output in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2879739"}]}