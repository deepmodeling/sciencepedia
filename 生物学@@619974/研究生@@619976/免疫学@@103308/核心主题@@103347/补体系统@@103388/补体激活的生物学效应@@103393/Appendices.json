{"hands_on_practices": [{"introduction": "理解补体激活的后果不仅仅是理论知识的记忆，更是解决实际临床问题的关键技能。这个练习将你置于一名临床医生的角色，面对一位有特定症状的患者和一系列补体检测结果。你的任务是解读复杂的实验数据模式，例如低 $C3$ 水平但 $C4$ 水平正常，从而精确定位失调的补体途径，并构建一个科学严谨的鉴别诊断列表 [@problem_id:2836540]。这项实践旨在磨练你从基础免疫学原理到临床应用的转化能力。", "problem": "一名$17$岁既往健康的男性，因咽炎发作$2$周后出现新发的肉眼血尿和眶周水肿而就诊。生命体征平稳；无皮疹或关节炎。尿液分析显示血液$3+$，并有红细胞管型。进行了以下补体研究，并提供了参考范围：\n\n- 补体成分$3$ ($C3$): $38$ mg/dL (参考范围 $90$–$180$ mg/dL)\n- 补体成分$4$ ($C4$): $26$ mg/dL (参考范围 $10$–$40$ mg/dL)\n- 总溶血补体 (CH50): $12$ U/mL (参考范围 $60$–$140$ U/mL)\n- 旁路途径溶血补体 (AH50): $9$ U/mL (参考范围 $60$–$140$ U/mL)\n\n哪个选项最能确定主要涉及的补体途径，并提出一个科学上一致的、既包括遗传缺陷又包括消耗状态的鉴别诊断？\n\nA. 旁路途径激活和消耗为主；鉴别诊断包括由C3肾炎因子驱动的C3肾小球病、补体因子H或因子I缺乏，以及感染后肾小球肾炎\n\nB. 经典途径缺乏或消耗为主；鉴别诊断包括C2缺乏和活动性系统性红斑狼疮（SLE）发作\n\nC. 末端途径缺乏为主；鉴别诊断集中于遗传性C5–C9缺乏伴复发性Neisseria感染\n\nD. 因C1抑制物缺乏导致的孤立性经典途径过度激活为主；鉴别诊断包括遗传性血管性水肿和获得性C1抑制物缺乏\n\nE. 旁路途径成分缺乏为主；鉴别诊断包括factor B、factor D或properdin缺乏伴上游成分正常", "solution": "首先将对问题陈述进行严格的验证过程。\n\n**步骤1：提取已知信息**\n\n*   **患者人口统计学信息：** 一名$17$岁、既往健康的男性。\n*   **临床表现：** 新发的肉眼血尿和眶周水肿。\n*   **时间病史：** 症状出现于咽炎发作$2$周后。\n*   **体格检查发现：** 生命体征平稳；无皮疹或关节炎。\n*   **尿液分析结果：** 血液$3+$，并存在红细胞管型。\n*   **补体实验室数据（附参考范围）：**\n    *   补体成分$3$ ($C3$): $38$ mg/dL (参考范围 $90$–$180$ mg/dL)。\n    *   补体成分$4$ ($C4$): $26$ mg/dL (参考范围 $10$–$40$ mg/dL)。\n    *   总溶血补体 ($CH50$): $12$ U/mL (参考范围 $60$–$140$ U/mL)。\n    *   旁路途径溶血补体 ($AH50$): $9$ U/mL (参考范围 $60$–$140$ U/mL)。\n\n**步骤2：使用提取的已知信息进行验证**\n\n1.  **科学依据：** 该问题描述了急性肾炎综合征的典型临床表现。近期咽炎、伴有红细胞管型的血尿和水肿的组合是感染后肾小球肾炎（PIGN）（通常是链球菌感染后）的教科书式情景。使用补体研究来探查肾小球肾炎的潜在免疫病理学是免疫学和肾脏病学的标准和基本实践。所提供的实验室数值与此类疾病中已知的补体激活模式一致。该问题牢固地植根于已确立的医学科学。\n2.  **问题的适定性：** 该问题提供了特定的临床背景和一套完整的相关实验室数据及参考范围。问题要求对这些数据进行解读，以确定所涉及的补体途径并制定鉴别诊断。这是一个定义明确的任务，具有唯一的、有科学支持的解决方案。\n3.  **客观性：** 问题陈述由客观的临床观察和定量的实验室测量组成。没有主观、模糊或基于意见的陈述。\n4.  **完整性和一致性：** 数据足以进行有效的分析。临床病史（咽炎）和实验室特征（低$C3$，正常$C4$）内部一致，并指向一类特定的免疫病理学。\n\n**步骤3：结论与行动**\n\n问题陈述科学合理、适定、客观且内部一致。它代表了一个现实且不简单的诊断挑战。因此，该问题是**有效的**。我们可以继续进行完整解答。\n\n**基于原理的推导**\n\n补体系统是先天免疫系统的一个关键部分。它的激活可以通过三个主要途径发生：经典途径、凝集素途径和旁路途径，所有这些途径最终都会汇合以裂解补体成分$C3$并激活末端途径（$C5-C9$）。\n\n1.  **经典途径**通常由抗原-抗体复合物启动。其激活会消耗早期成分$C1q$、$C1r$、$C1s$、$C4$和$C2$，进而导致$C3$的消耗。因此，显著的经典途径激活的特征是$C4$和$C3$水平均降低。\n2.  **凝集素途径**由甘露糖结合凝集素（MBL）与病原体表面的碳水化合物结合启动。它也通过裂解$C4$和$C2$进行，导致$C3$消耗。因此，它的激活特征同样涉及低$C4$和低$C3$。\n3.  **旁路途径**可由某些病原体表面直接激活，或通过$C3$的自发性低水平水解（tick-over）激活。它绕过$C1$、$C4$和$C2$，在Factor B、Factor D和Properdin的帮助下直接消耗$C3$。因此，旁路途径的孤立或主要激活的特征是**低$C3$伴正常$C4$**。\n\n提供的功能性检测是：\n*   **$CH50$ (总溶血补体):** 该检测测量整个经典途径和末端途径的功能。低值表明从$C1$到$C9$的任何一个成分存在缺乏或消耗。\n*   **$AH50$ (旁路途径溶血补体):** 该检测测量旁路途径和末端途径的功能。低值表明旁路途径成分（Factor B、Factor D、Properdin）或共享的末端成分（$C3$、$C5-C9$）存在缺乏或消耗。\n\n**患者数据分析**\n\n*   **$C3 = 38$ mg/dL (低):** 这表明存在显著且持续的补体激活，导致$C3$消耗。\n*   **$C4 = 26$ mg/dL (正常):** 这是最具鉴别意义的发现。一个正常的$C4$水平有效地排除了经典途径或凝集素途径的显著激活，因为这两种途径都会消耗$C4$。\n*   **$CH50 = 12$ U/mL (低):** 经典途径功能性检测值低。由于经典途径本身并未被激活（$C4$正常），这个低值必定是由于所有途径共有的下游成分（即$C3$）被消耗所致。$C3$的严重耗竭使得经典途径在这个*in vitro*检测中无法进行到底。\n*   **$AH50 = 9$ U/mL (低):** 旁路途径功能性检测值低。这证实了该途径存在缺陷，在低$C3$的背景下，这是由于包括$C3$本身在内的旁路途径成分被消耗所致。\n\n**结论：**上述模式——低$C3$、正常$C4$、低$CH50$和低$AH50$——是**旁路途径激活和消耗为主**的明确标志。\n\n咽炎后急性肾炎综合征的临床表现，加上这种补体特征，将鉴别诊断引向由旁路途径失调驱动的疾病。这包括：\n1.  **感染后肾小球肾炎 (PIGN):** 在此背景下最可能的诊断。某些细菌抗原可以直接触发并放大旁路途径。这种情况通常是自限性的。\n2.  **$C3$肾小球病 ($C3G$):** 一类以旁路途径失调为特征的罕见肾脏疾病。这可能由获得性因素（例如，$C3$肾炎因子，一种稳定旁路途径$C3$转化酶的自身抗体）或补体调节蛋白（例如，Factor H、Factor I）的基因突变引起。急性感染可能是一个触发因素，暴露了潜在的$C3G$易感性。\n\n**逐项分析**\n\n**A. 旁路途径激活和消耗为主；鉴别诊断包括由C3肾炎因子驱动的C3肾小球病、补体因子H或因子I缺乏，以及感染后肾小球肾炎**\n此选项根据低$C3$和正常$C4$的特征正确地确定了途径。提供的鉴别诊断在科学上是无可挑剔的。它包括了最可能的急性、消耗驱动状态（PIGN），并正确地指出了表现相同的旁路途径失调的慢性/遗传状态（由$C3$肾炎因子引起的$C3G$，以及调节因子Factor H或I的缺乏）。\n**结论：正确。**\n\n**B. 经典途径缺乏或消耗为主；鉴别诊断包括C2缺乏和活动性系统性红斑狼疮（SLE）发作**\n这个选项存在根本性错误。经典途径激活的定义是$C4$的消耗。该患者的$C4$水平是正常的。SLE肾炎通常表现为低$C3$**和**低$C4$。孤立的$C2$缺乏会导致$CH50$降低，但其本身不会导致$C3$的消耗。患者的临床体征（无皮疹，无关节炎）也不支持SLE。\n**结论：不正确。**\n\n**C. 末端途径缺乏为主；鉴别诊断集中于遗传性C5–C9缺乏伴复发性Neisseria感染**\n这个选项是错误的。末端成分（$C5–C9$）的孤立缺乏会导致$CH50$和$AH50$降低，因为这些检测无法完成。然而，上游成分（特别是$C3$和$C4$）的水平将是正常的。该患者的$C3$严重耗竭。此外，末端途径缺乏的临床表现是对*Neisseria*感染的易感性，而不是肾小球肾炎。\n**结论：不正确。**\n\n**D. 因C1抑制物缺乏导致的孤立性经典途径过度激活为主；鉴别诊断包括遗传性血管性水肿和获得性C1抑制物缺乏**\n这个选项在多个逻辑层面上都是不正确的。首先，$C1$抑制物缺乏会导致$C4$和$C2$的不受控制的裂解，导致$C4$水平非常低，这与患者的数据相矛盾。$C3$通常不被消耗。其次，临床表现是由于缓激肽过度产生引起的血管性水肿，而不是该患者所见的肾炎综合征。这里的眶周水肿是由于肾性液体潴留所致。\n**结论：不正确。**\n\n**E. 旁路途径成分缺乏为主；鉴别诊断包括factor B、factor D或properdin缺乏伴上游成分正常**\n这个选项显示了对补体病理学的误解。旁路途径激活成分（factor B、D或properdin）的缺乏会*损害*其功能，而不是导致过度激活。这种缺乏会导致$AH50$降低，但$C3$水平会正常，因为该途径无法消耗$C3$。患者的数据显示了显著的$C3$*消耗*，表明途径*过度激活*。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2836540"}, {"introduction": "在诊断出补体介导的疾病后，下一步关键是制定有效的治疗策略。这个练习提出了一个高级临床决策情景：在级联反应的不同节点（$C3$ 与 $C5$）之间选择抑制靶点。这要求你对不同生物效应分子（如调理素 $C3b$ 与溶细胞的膜攻击复合物）如何驱动不同病理过程有深刻的理解，从而为特定疾病选择最精准、副作用最小的治疗方案 [@problem_id:2836510]。通过这个练习，你将学会如何将对补体生物学后果的精细理解应用于现代靶向药物的设计原则。", "problem": "一位临床医生正在为两位不同的患者设计补体靶向疗法。患者 X 患有阵发性睡眠性血红蛋白尿症 (PNH)，实验室证据显示存在血管内溶血，流式细胞术显示其红细胞上缺失补体调节蛋白 CD55 和 CD59。患者 Y 患有自身免疫性溶血过程，主要表现为通过补体调理作用实现的红细胞血管外清除；其直接抗球蛋白试验 (DAT) 显示红细胞表面 $C3d$ 呈阳性，且脾脏巨噬细胞对 C$3$b 包被的细胞的摄取增加。该临床医生希望在抑制补体成分 C$5$ 与 C$3$ 之间做出选择，并预测这两种策略在感染和免疫病理风险方面最可能的差异。仅根据补体激活的基本定义（即，C$3$ 裂解产生调理素 C$3$b 和过敏毒素 C$3$a，而 C$5$ 裂解通过 C$5$b–C$9$ 启动膜攻击复合物 (MAC) 的组装，导致直接裂解，同时产生一种强效化学引诱物 C$5$a），以下哪种策略最符合每位患者的主要病理生理机制，并最准确地预测其差异化的副作用特征？\n\nA. 对患者 X 优先选择抑制 C$5$，以防止 MAC 介导的血管内溶血，同时保留 C$3$b 介导的调理吞噬作用；接受对脑膜炎奈瑟菌（Neisseria meningitidis）的易感性增加，但调理作用和免疫复合物清除功能基本保持完整。对患者 Y 优先选择抑制 C$3$，以阻断 C$3$b 沉积和脾脏清除；预期对有荚膜细菌的易感性将更广，且免疫复合物清除功能会受损。\n\nB. 对患者 X 优先选择抑制 C$3$，以完全抑制补体从而防止溶血；预期感染风险将主要限于因 MAC 缺失导致的奈瑟菌感染，而调理吞噬作用则得以保留。对患者 Y 优先选择抑制 C$5$，以减少血管外调理作用，且感染风险最小。\n\nC. 对患者 Y 优先选择抑制 C$5$，因为它能防止 C$3$b 沉积，同时保留过敏毒素信号传导；主要副作用是因清除功能受损而导致的免疫复合物介导疾病风险增高。对患者 X 优先选择抑制 C$3$，以保留 MAC 功能并避免细菌感染。\n\nD. 对患者 Y 优先选择抑制 C$3$，但预期主要是选择性地丧失 C$5$a，而 C$3$b 调理作用得以保留；风险主要是中性粒细胞趋化作用减弱，但对有荚膜细菌的感染不会增加。对患者 X 优先选择抑制 C$5$，以减少血管内溶血，且无有意义的感染风险。\n\nE. 对患者 X 优先选择抑制 C$5$，以防止血管内溶血，但预期会因 C$3$b 缺失而导致病毒中和作用严重受损，细菌感染风险则最小。对患者 Y 优先选择抑制 C$3$，以减少血管外调理作用，同时保留 MAC 的形成和对奈瑟菌的抵抗力。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知信息**\n- **患者 X：** 诊断为阵发性睡眠性血红蛋白尿症 (PNH)，有血管内溶血的证据。流式细胞术显示红细胞上缺失补体调节蛋白 CD55 和 CD59。\n- **患者 Y：** 诊断为自身免疫性溶血过程，特征为红细胞的血管外清除。其机制被陈述为补体调理作用。实验室发现包括红细胞上$C3d$呈阳性的直接抗球蛋白试验 (DAT) 结果，以及脾脏巨噬细胞对C$3$b包被的细胞摄取增加的证据。\n- **治疗方案：** 抑制补体成分C$3$与抑制补体成分C$5$的对比。\n- **目标：** 为每位患者确定最佳治疗策略，并预测其差异化的感染和免疫病理风险。\n- **基本原则（作为基础定义提供）：**\n    1.  C$3$的裂解产生调理素C$3$b和过敏毒素C$3$a。\n    2.  C$5$的裂解通过C$5$b–C$9$启动膜攻击复合物 (MAC) 的组装，导致直接细胞裂解。\n    3.  C$5$的裂解也产生C$5$a，一种强效的化学引诱物。\n\n**步骤2：使用提取的已知信息进行验证**\n该问题具有科学依据。为患者 X (PNH) 和患者 Y（补体介导的自身免疫性溶血性贫血）描述的临床情景准确地反映了现实世界中的病理状况。PNH的病理生理学被正确地与CD55和CD59等调节蛋白的缺失联系起来，这导致了MAC介导的血管内溶血。对患者Y病情的描述，即C$3$b介导的调理作用导致脾脏巨噬细胞的血管外溶血，是自身免疫性溶血的典型机制。关于C$3$和C$5$功能的基础定义是免疫学中一个正确但简化的总结。\n\n该问题提法得当。它提供了两个不同的临床案例和一套清晰的规则（基础定义），可以从中推导出最合乎逻辑的治疗干预及其后果。它要求进行比较分析，这是临床推理问题的标准格式。该问题是自洽的，不包含矛盾信息。所有术语在免疫学背景下都是客观且定义明确的。\n\n**步骤3：结论与行动**\n问题陈述有效。将根据所提供的原则推导出解决方案。\n\n**解决方案的推导**\n\n补体系统有两个与此问题相关的主要效应途径：\n1.  **用于吞噬作用的调理化：** 主要由C$3$b在目标表面的沉积介导。\n2.  **终末细胞裂解：** 由膜攻击复合物（MAC，由C$5$b–C$9$组成）的形成介导。\n\n该级联反应是顺序性的：激活导致C$3$转化酶的形成，该酶将C$3$裂解为C$3$a和C$3$b。然后C$3$b成分可参与形成C$5$转化酶，该酶将C$5$裂解为C$5$a和C$5$b。C$5$b启动MAC的形成。因此，抑制C$3$将阻断所有下游事件，包括C$3$b介导的调理作用和MAC依赖的裂解。抑制C$5$的作用位点更靠后；它只会阻断MAC的形成和C$5$a的产生，同时保留上游C$3$b和C$3$a的功能。\n\n**对患者 X (PNH) 的分析：**\n病理被明确指出为**血管内溶血**。红细胞缺乏保护性蛋白（CD55和CD59），使其易受补体系统的攻击。根据所提供的定义，直接细胞裂解是由MAC引起的。因此，主要的治疗目标是防止MAC的形成。抑制C$5$裂解直接阻断了MAC组装的初始步骤（C$5$b的形成），是防止血管内溶血的最具靶向性的方法。该策略保留了上游的补体功能，包括调理素C$3b$的生成。抑制C$5$的主要不良反应是丧失MAC介导的杀菌活性，这对于防御奈瑟菌属，尤其是*脑膜炎奈瑟菌*（*Neisseria meningitidis*）至关重要。\n\n**对患者 Y (自身免疫性溶血性贫血) 的分析：**\n病理被明确指出为通过**补体调理作用**实现的**血管外清除**，脾脏巨噬细胞摄取**C$3$b包被的细胞**。该病理是由调理素C$3$b驱动的，而非MAC。治疗目标是防止红细胞被C$3$b调理化。因此，合乎逻辑的干预措施是抑制C$3$的裂解。这可以防止C$3$b的形成，从而中止脾脏巨噬细胞的吞噬信号。抑制C$5$将是无效的，因为它不会阻止C$3$b的沉积。抑制C$3$的后果是导致严重而广泛的补体缺陷。C$3$b的缺失严重损害了调理吞噬作用，导致对多种有荚膜细菌的易感性增加。此外，C$3$b对于清除免疫复合物至关重要；其缺失会增加免疫复合物介导疾病的风险。\n\n**选项评估**\n\n**A. 对患者 X 优先选择抑制 C$5$，以防止 MAC 介导的血管内溶血，同时保留 C$3$b 介导的调理吞噬作用；接受对脑膜炎奈瑟菌的易感性增加，但调理作用和免疫复合物清除功能基本保持完整。对患者 Y 优先选择抑制 C$3$，以阻断 C$3$b 沉积和脾脏清除；预期对有荚膜细菌的易感性将更广，且免疫复合物清除功能会受损。**\n- 对于患者 X：该陈述正确地将抑制 C$5$ 确定为针对 MAC 介导的裂解的靶向疗法，正确地指出了 C$3$b 功能（调理作用、免疫复合物清除）的保留，并正确地识别了*奈瑟菌属*感染的特定风险。\n- 对于患者 Y：该陈述正确地将抑制 C$3$ 确定为阻断 C$3$b 介导的调理作用的适当疗法，并正确地预测了广泛补体阻断的后果：对有荚膜细菌的易感性和免疫复合物清除功能受损。\n- **结论：正确。**\n\n**B. 对患者 X 优先选择抑制 C$3$，以完全抑制补体从而防止溶血；预期感染风险将主要限于因 MAC 缺失导致的奈瑟菌感染，而调理吞噬作用则得以保留。对患者 Y 优先选择抑制 C$5$，以减少血管外调理作用，且感染风险最小。**\n- 对于患者 X：这是不正确的。抑制 C$3$ 会严重削弱调理吞噬作用，与“保留”的说法相反。感染风险将是广泛的，而非“主要限于*奈瑟菌属*”。\n- 对于患者 Y：这是不正确的。抑制 C$5$ 不影响 C$3$b 的沉积，因此不会减少血管外调理作用。\n- **结论：不正确。**\n\n**C. 对患者 Y 优先选择抑制 C$5$，因为它能防止 C$3$b 沉积，同时保留过敏毒素信号传导；主要副作用是因清除功能受损而导致的免疫复合物介导疾病风险增高。对患者 X 优先选择抑制 C$3$，以保留 MAC 功能并避免细菌感染。**\n- 对于患者 Y：这是不正确的。抑制 C$5$ 并不能防止 C$3$b 沉积。免疫复合物清除功能受损是 C$3$ 缺陷的标志，而非 C$5$ 缺陷。\n- 对于患者 X：这是不正确的。抑制 C$3$ 会阻止 C$5$ 转化酶的形成，因此绝对不会“保留 MAC 功能”。它会导致而非避免细菌感染。\n- **结论：不正确。**\n\n**D. 对患者 Y 优先选择抑制 C$3$，但预期主要是选择性地丧失 C$5$a，而 C$3$b 调理作用得以保留；风险主要是中性粒细胞趋化作用减弱，但对有荚膜细菌的感染不会增加。对患者 X 优先选择抑制 C$5$，以减少血管内溶血，且无有意义的感染风险。**\n- 对于患者 Y：这是不正确的。抑制 C$3$ 使 C$3$b 的形成成为不可能。声称 C$3$b 调理作用“得以保留”是直接矛盾的。因此，关于有荚膜细菌感染风险不增加的说法是错误的。\n- 对于患者 X：这是不正确的。抑制 C$5$ 具有公认的、临床上显著的脑膜炎球菌病风险。“无有意义的感染风险”的说法是错误的。\n- **结论：不正确。**\n\n**E. 对患者 X 优先选择抑制 C$5$，以防止血管内溶血，但预期会因 C$3$b 缺失而导致病毒中和作用严重受损，细菌感染风险则最小。对患者 Y 优先选择抑制 C$3$，以减少血管外调理作用，同时保留 MAC 的形成和对奈瑟菌的抵抗力。**\n- 对于患者 X：这是不正确的。抑制 C$5$ 会保留 C$3$b，而不是导致其缺失。细菌感染风险并非最小。\n- 对于患者 Y：这是不正确的。抑制 C$3$ 会阻止 MAC 的形成，因为 C$3$b 是 C$5$ 转化酶的必要组成部分。\n- **结论：不正确。**\n\n基于对所提供原则的严格应用，只有选项 A 为两位患者提供了逻辑上和免疫学上都合理的分析。", "answer": "$$\\boxed{A}$$", "id": "2836510"}, {"introduction": "为了对补体系统获得真正深入和可预测的理解，我们可以将其复杂的反应网络转化为数学模型。这项高级实践挑战你构建一个常微分方程（ODE）系统，以捕捉激活、放大和调节之间动态的相互作用。这种系统生物学方法使我们能够模拟系统在不同条件下的行为，并提供了仅靠静态图表无法获得的洞见 [@problem_id:2836590]。完成这项任务不仅能巩固你对补体动力学的认识，还能让你具备使用计算工具探索复杂生物过程的能力。", "problem": "您需要推导并实现一个补体在靶标表面激活的最小动力学模型，并以质量作用定律为基本依据。该模型应追踪以下几种表面局域的组分：天然补体成分 C3、其活化并沉积的片段 C3b、其失活的片段 iC3b、表面 C3 转化酶的活性，以及一种通用的可溶性抑制剂，该抑制剂既能使 C3b 失活，也能中和转化酶。所有浓度都应在靶标表面附近进行局部建模，并以微摩尔（micromolar）为单位，记作 $\\mu$M。时间单位为秒，记作 s。\n\n基本依据和定义：\n- 使用质量作用定律：对于双分子相互作用 $A + B \\xrightarrow{k} \\text{产物}$，正向速率为 $v = k\\,A\\,B$，其中 $k$ 的单位与浓度和时间一致；对于单分子步骤 $A \\xrightarrow{k} \\text{产物}$，速率为 $v = k\\,A$。\n- 使用浓度为 $B_0$ 的恒定局部补体因子 B 池来参数化转化酶的形成，从而抽象掉中间步骤，并假设因子 D 恒定存在，其作用已隐式包含在速率常数中。\n- 将抑制剂视为一种可溶性组分，其在局部被供给和移除，并通过双分子失活步骤进行反应。\n\n需作为时间 $t$ 的函数进行建模的组分：\n- $C_3(t)$：近表面 C3 天然蛋白的局部浓度，单位为 $\\mu$M。\n- $C3b(t)$：表面结合的活性 C3b 浓度，单位为 $\\mu$M。\n- $iC3b(t)$：表面结合的非活性 iC3b 浓度，单位为 $\\mu$M。\n- $E(t)$：有效的表面 C3 转化酶活性，单位为 $\\mu$M-等效值。\n- $I(t)$：局部抑制剂浓度，单位为 $\\mu$M。\n\n使用质量作用定律编码的最小反应方案：\n- 裂解与沉积：$C_3 + E \\xrightarrow{k_{\\mathrm{cleave}}} C3b + E$，沉积产率因子为 $f_{\\mathrm{deposit}} \\in [0,1]$，意味着只有一部分被裂解的 $C_3$ 作为 $C3b$ 出现在表面上；其余部分在此最小模型中被忽略。\n- 转化酶形成：$C3b + B \\xrightarrow{k_{\\mathrm{form}}} E$，其中 B 被抽象为一个恒定的池 $B_0$，因此有效形成速率为 $k_{\\mathrm{form}}\\,B_0\\,C3b$。\n- 转化酶衰变：$E \\xrightarrow{k_{\\mathrm{decay}}} C3b$，将一个 $C3b$ 返回到表面。\n- C3b 的失活：$I + C3b \\xrightarrow{k_{\\mathrm{inact}}} iC3b$。\n- 转化酶的中和：$I + E \\xrightarrow{k_{\\mathrm{Ibind}}} \\varnothing$，移除 E 的活性。\n- 供给与损失项：$C_3$ 有一个来源 $s$ 和一级损失 $k_{\\mathrm{out}}\\,C_3$；$iC3b$ 有一级清除 $k_{\\mathrm{clear}}\\,iC3b$；$I$ 有一个来源 $s_I$ 和一级损失 $k_{\\mathrm{Iout}}\\,I$。\n\n任务第 1 部分（推导）：从质量作用定律和上述反应方案出发，为 $C_3(t)$, $C3b(t)$, $iC3b(t)$, $E(t)$ 和 $I(t)$ 的时间演化推导一个封闭的常微分方程组。您的推导必须考虑反应所指示的产生和消耗项，并且在维度上必须与 $\\mu$M 和 s 保持一致。\n\n任务第 2 部分（实现）：实现一个程序，该程序使用一个合适的刚性求解器，在每个测试案例中对您推导的常微分方程组在固定的时间区间 $[0, T]$（其中 $T = 3600$ s）上进行数值积分，并为每个测试案例返回表面浓度三元组 $[C3b(T), iC3b(T), E(T)]$（单位为 $\\mu$M），四舍五入到三位小数。\n\n使用以下基本参数值，除非在特定测试案例中被覆盖：\n- $k_{\\mathrm{cleave}} = 1 \\times 10^{-3}$ $\\mu$M$^{-1}$ s$^{-1}$,\n- $f_{\\mathrm{deposit}} = 0.8$ (无单位),\n- $k_{\\mathrm{form}} = 3 \\times 10^{-3}$ $\\mu$M$^{-1}$ s$^{-1}$,\n- $k_{\\mathrm{decay}} = 5 \\times 10^{-4}$ s$^{-1}$,\n- $k_{\\mathrm{inact}} = 2 \\times 10^{-3}$ $\\mu$M$^{-1}$ s$^{-1}$,\n- $k_{\\mathrm{Ibind}} = 2 \\times 10^{-3}$ $\\mu$M$^{-1}$ s$^{-1}$,\n- $k_{\\mathrm{clear}} = 1 \\times 10^{-4}$ s$^{-1}$,\n- $k_{\\mathrm{out}} = 1 \\times 10^{-4}$ s$^{-1}$,\n- $k_{\\mathrm{Iout}} = 1 \\times 10^{-3}$ s$^{-1}$,\n- $s = 1 \\times 10^{-2}$ $\\mu$M s$^{-1}$,\n- $s_I = 1 \\times 10^{-3}$ $\\mu$M s$^{-1}$,\n- $B_0 = 1.0$ $\\mu$M.\n\n所有测试案例的初始条件，除非另有覆盖：\n- $C_3(0) = C3\\_0$ $\\mu$M,\n- $C3b(0) = 0$ $\\mu$M,\n- $iC3b(0) = 0$ $\\mu$M,\n- $E(0) = E\\_0$ $\\mu$M,\n- $I(0) = I\\_0$ $\\mu$M.\n\n测试套件：\n为 5 个说明不同机制的测试案例提供结果。对于每个案例，请指明 $(C3\\_0, I\\_0, E\\_0, B_0)$ 和任何参数覆盖。\n\n- 案例 1 (基线)：$C3\\_0 = 6.0$ $\\mu$M, $I\\_0 = 0.2$ $\\mu$M, $E\\_0 = 0.0$ $\\mu$M, $B_0 = 1.0$ $\\mu$M, 无覆盖。\n- 案例 2 (无抑制剂)：$C3\\_0 = 6.0$ $\\mu$M, $I\\_0 = 0.0$ $\\mu$M, $E\\_0 = 0.0$ $\\mu$M, $B_0 = 1.0$ $\\mu$M, 其中 $s_I = 0.0$ $\\mu$M s$^{-1}$。\n- 案例 3 (强抑制)：$C3\\_0 = 6.0$ $\\mu$M, $I\\_0 = 1.0$ $\\mu$M, $E\\_0 = 0.0$ $\\mu$M, $B_0 = 1.0$ $\\mu$M, 其中 $k_{\\mathrm{inact}} = 4 \\times 10^{-3}$ $\\mu$M$^{-1}$ s$^{-1}$, $k_{\\mathrm{Ibind}} = 4 \\times 10^{-3}$ $\\mu$M$^{-1}$ s$^{-1}$, $s_I = 2 \\times 10^{-3}$ $\\mu$M s$^{-1}$。\n- 案例 4 (因子 B 有限)：$C3\\_0 = 6.0$ $\\mu$M, $I\\_0 = 0.2$ $\\mu$M, $E\\_0 = 0.0$ $\\mu$M, $B_0 = 0.05$ $\\mu$M, 无其他覆盖。\n- 案例 5 (预先形成的转化酶和更快的衰变)：$C3\\_0 = 6.0$ $\\mu$M, $I\\_0 = 0.2$ $\\mu$M, $E\\_0 = 0.1$ $\\mu$M, $B_0 = 1.0$ $\\mu$M, 其中 $k_{\\mathrm{decay}} = 5 \\times 10^{-3}$ s$^{-1}$。\n\n输出规格：\n- 对于每个案例，从 $t = 0$ s 到 $t = 3600$ s 进行积分，并记录 $[C3b(3600), iC3b(3600), E(3600)]$（单位 $\\mu$M）。\n- 将每个记录值四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含 5 个案例的结果，格式为逗号分隔的 Python 风格列表的列表，例如，形式为 $[[x\\_{11}, x\\_{12}, x\\_{13}], [x\\_{21}, x\\_{22}, x\\_{23}], \\dots]$，不含额外文本。所有条目都是代表 $\\mu$M 的浮点数。", "solution": "该问题已经过验证，被认为是科学上合理的、适定的和自洽的。所提供的参数和反应方案构成了推导常微分方程组（ODE）以模拟补体激活过程动力学的有效基础。该问题是系统生物学中的一个标准练习，并且可以按照陈述的方式解决。\n\n### 第 1 部分：动力学系统的推导\n\n该系统由五种组分浓度的时间演化来描述：$C_3(t)$、$C_{\\text{3b}}(t)$、$iC_{\\text{3b}}(t)$、$E(t)$ 和 $I(t)$。我们将通过对指定的反应方案应用质量作用定律，来为每种组分推导其 ODE。对于任何组分 $X$，其变化率 $\\frac{d[X]}{dt}$ 是所有产生它的反应速率之和减去所有消耗它的反应速率之和。所有浓度单位均为 $\\mu$M，时间单位为秒 (s)。\n\n设状态变量向量为 $y(t) = [C_3(t), C_{\\text{3b}}(t), iC_{\\text{3b}}(t), E(t), I(t)]^T$。\n\n**1. 天然 C3 的变化率, $\\frac{dC_3}{dt}$**\n局部天然 $C_3$ 的浓度由三个过程决定：\n- 一个恒定的流入（源）项 $s$，单位为 $\\mu\\text{M s}^{-1}$。\n- 通过转化酶 $E(t)$ 催化的裂解而被消耗。反应为 $C_3 + E \\xrightarrow{k_{\\mathrm{cleave}}} C_{\\text{3b}} + E$。此反应的速率为 $v_{\\text{cleave}} = k_{\\mathrm{cleave}} C_3(t) E(t)$。\n- 一个一级损失项 $-k_{\\mathrm{out}} C_3(t)$，代表从表面扩散离开。\n\n将这些贡献相加，得到第一个 ODE：\n$$ \\frac{dC_3}{dt} = s - k_{\\mathrm{cleave}} C_3(t) E(t) - k_{\\mathrm{out}} C_3(t) $$\n\n**2. 活性 C3b 的变化率, $\\frac{dC_{\\text{3b}}}{dt}$**\n表面结合的活性 $C_{\\text{3b}}(t)$ 的浓度变化由四个过程决定：\n- 由 $C_3$ 裂解产生。只有一部分 ($f_{\\mathrm{deposit}}$) 被裂解的 $C_3$ 成功地作为活性 $C_{\\text{3b}}$ 沉积在表面上。生成速率为 $+f_{\\mathrm{deposit}} v_{\\text{cleave}} = +f_{\\mathrm{deposit}} k_{\\mathrm{cleave}} C_3(t) E(t)$。\n- 由转化酶 $E(t)$ 通过反应 $E \\xrightarrow{k_{\\mathrm{decay}}} C_{\\text{3b}}$ 自发衰变而产生。速率为 $+k_{\\mathrm{decay}} E(t)$。\n- 为形成新的转化酶而消耗，反应为 $C_{\\text{3b}} + B \\xrightarrow{k_{\\mathrm{form}}} E$。由于因子 B 假定为恒定值 $B_0$，这对于 $C_{\\text{3b}}$ 来说是一个准一级反应。消耗速率为 $-k_{\\mathrm{form}} B_0 C_{\\text{3b}}(t)$。\n- 通过抑制剂 $I(t)$ 使其失活而被消耗，反应为 $I + C_{\\text{3b}} \\xrightarrow{k_{\\mathrm{inact}}} iC_{\\text{3b}}$。消耗速率为 $-k_{\\mathrm{inact}} I(t) C_{\\text{3b}}(t)$。\n\n将这些贡献相加，得到第二个 ODE：\n$$ \\frac{dC_{\\text{3b}}}{dt} = f_{\\mathrm{deposit}} k_{\\mathrm{cleave}} C_3(t) E(t) + k_{\\mathrm{decay}} E(t) - k_{\\mathrm{form}} B_0 C_{\\text{3b}}(t) - k_{\\mathrm{inact}} I(t) C_{\\text{3b}}(t) $$\n\n**3. 非活性 iC3b 的变化率, $\\frac{diC_{\\text{3b}}}{dt}$**\n表面结合的非活性 $iC_{\\text{3b}}(t)$ 的浓度由两个过程决定：\n- 由抑制剂 $I(t)$ 失活 $C_{\\text{3b}}(t)$ 而产生。速率为 $+k_{\\mathrm{inact}} I(t) C_{\\text{3b}}(t)$。\n- 一个一级清除项，代表从表面移除，速率为 $-k_{\\mathrm{clear}} iC_{\\text{3b}}(t)$。\n\n将这些贡献相加，得到第三个 ODE：\n$$ \\frac{diC_{\\text{3b}}}{dt} = k_{\\mathrm{inact}} I(t) C_{\\text{3b}}(t) - k_{\\mathrm{clear}} iC_{\\text{3b}}(t) $$\n\n**4. 转化酶活性的变化率, $\\frac{dE}{dt}$**\n有效转化酶活性 $E(t)$ 由三个过程决定：\n- 由 $C_{\\text{3b}}(t)$ 和因子 $B_0$ 产生。速率为 $+k_{\\mathrm{form}} B_0 C_{\\text{3b}}(t)$。\n- 自发衰变回 $C_{\\text{3b}}(t)$。速率为 $-k_{\\mathrm{decay}} E(t)$。\n- 通过反应 $I + E \\xrightarrow{k_{\\mathrm{Ibind}}} \\varnothing$ 被抑制剂 $I(t)$ 中和。速率为 $-k_{\\mathrm{Ibind}} I(t) E(t)$。\n注意，$E$ 在 $C_3$ 裂解反应中作为催化剂，因此其浓度在该步骤中不发生改变。\n\n将这些贡献相加，得到第四个 ODE：\n$$ \\frac{dE}{dt} = k_{\\mathrm{form}} B_0 C_{\\text{3b}}(t) - k_{\\mathrm{decay}} E(t) - k_{\\mathrm{Ibind}} I(t) E(t) $$\n\n**5. 抑制剂的变化率, $\\frac{dI}{dt}$**\n局部抑制剂 $I(t)$ 的浓度由四个过程决定：\n- 一个恒定的流入（源）项 $s_I$，单位为 $\\mu\\text{M s}^{-1}$。\n- 一个一级损失项 $-k_{\\mathrm{Iout}} I(t)$，代表扩散离开或降解。\n- 通过使 $C_{\\text{3b}}(t)$ 失活而被消耗。速率为 $-k_{\\mathrm{inact}} I(t) C_{\\text{3b}}(t)$。\n- 通过中和 $E(t)$ 而被消耗。速率为 $-k_{\\mathrm{Ibind}} I(t) E(t)$。\n\n将这些贡献相加，得到第五个也是最后一个 ODE：\n$$ \\frac{dI}{dt} = s_I - k_{\\mathrm{Iout}} I(t) - k_{\\mathrm{inact}} I(t) C_{\\text{3b}}(t) - k_{\\mathrm{Ibind}} I(t) E(t) $$\n\n这个由五个耦合、一阶、非线性的常微分方程组成的方程组，构成了完整的动力学模型。\n\n### 第 2 部分：数值实现策略\n\n推导出的 ODE 系统很可能是刚性的，因为反应速率可能跨越几个数量级，导致在截然不同的时间尺度上出现动力学行为。根据要求，需要一个适用于刚性问题的数值求解器。我们将使用 `scipy.integrate` 库中的 `solve_ivp` 函数，并采用 `Radau` 方法，这是一种隐式 Runge-Kutta 方法，非常适合求解刚性 ODE。\n\n实现将按以下步骤进行：\n1.  定义一个实现 ODE 系统的函数。它将接收当前时间 $t$、状态向量 $y(t)$ 和一个参数字典作为输入，并返回导数向量 $dy/dt$。\n2.  基本参数集将存储在一个字典中。\n3.  五个测试案例中的每一个都将在一个循环中处理。对于每个案例：\n    a. 通过用任何指定的覆盖值更新基本参数集，来创建特定的参数集。\n    b. 根据给定的初始条件构造初始状态向量 $y(0) = [C_3(0), C_{\\text{3b}}(0), iC_{\\text{3b}}(0), E(0), I(0)]$。\n    c. 调用 `solve_ivp` 在时间区间 $[0, 3600]$ s 上对该系统进行积分。\n    d. 从解中提取 $C_{\\text{3b}}(3600)$、$iC_{\\text{3b}}(3600)$ 和 $E(3600)$ 的最终值。\n    e. 将这些值四舍五入到三位小数并存储。\n4.  最后，将从所有测试案例中收集到的结果格式化为列表的列表形式的单个字符串，并打印到标准输出。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and numerically solves a minimal dynamical model of complement activation.\n    \"\"\"\n\n    # Base parameter values\n    params_base = {\n        'k_cleave': 1e-3,   # uM^-1 s^-1\n        'f_deposit': 0.8,   # unitless\n        'k_form': 3e-3,     # uM^-1 s^-1\n        'k_decay': 5e-4,    # s^-1\n        'k_inact': 2e-3,    # uM^-1 s^-1\n        'k_Ibind': 2e-3,    # uM^-1 s^-1\n        'k_clear': 1e-4,    # s^-1\n        'k_out': 1e-4,      # s^-1\n        'k_Iout': 1e-3,     # s^-1\n        's': 1e-2,          # uM s^-1\n        's_I': 1e-3,        # uM s^-1\n        'B0': 1.0,          # uM\n    }\n\n    # Test suite definition\n    test_cases = [\n        # Case 1 (baseline)\n        {\n            'initials': {'C3_0': 6.0, 'I_0': 0.2, 'E_0': 0.0},\n            'params_override': {'B0': 1.0}\n        },\n        # Case 2 (no inhibitor)\n        {\n            'initials': {'C3_0': 6.0, 'I_0': 0.0, 'E_0': 0.0},\n            'params_override': {'B0': 1.0, 's_I': 0.0}\n        },\n        # Case 3 (strong inhibition)\n        {\n            'initials': {'C3_0': 6.0, 'I_0': 1.0, 'E_0': 0.0},\n            'params_override': {'B0': 1.0, 'k_inact': 4e-3, 'k_Ibind': 4e-3, 's_I': 2e-3}\n        },\n        # Case 4 (limited factor B)\n        {\n            'initials': {'C3_0': 6.0, 'I_0': 0.2, 'E_0': 0.0},\n            'params_override': {'B0': 0.05}\n        },\n        # Case 5 (preformed convertase and faster decay)\n        {\n            'initials': {'C3_0': 6.0, 'I_0': 0.2, 'E_0': 0.1},\n            'params_override': {'B0': 1.0, 'k_decay': 5e-3}\n        },\n    ]\n\n    def complement_ode(t, y, params):\n        \"\"\"\n        System of ODEs for the complement activation model.\n        y = [C3, C3b, iC3b, E, I]\n        \"\"\"\n        C3, C3b, iC3b, E, I = y\n\n        # Unpack parameters for clarity\n        s, s_I = params['s'], params['s_I']\n        k_out, k_Iout, k_clear = params['k_out'], params['k_Iout'], params['k_clear']\n        k_cleave, f_deposit = params['k_cleave'], params['f_deposit']\n        k_form, B0 = params['k_form'], params['B0']\n        k_decay = params['k_decay']\n        k_inact = params['k_inact']\n        k_Ibind = params['k_Ibind']\n\n        # Rates of reactions based on the Law of Mass Action\n        v_cleave = k_cleave * C3 * E\n        v_form = k_form * B0 * C3b\n        v_decay = k_decay * E\n        v_inact = k_inact * I * C3b\n        v_Ibind = k_Ibind * I * E\n\n        # Differentials for each species\n        dC3_dt = s - v_cleave - k_out * C3\n        dC3b_dt = f_deposit * v_cleave + v_decay - v_form - v_inact\n        diC3b_dt = v_inact - k_clear * iC3b\n        dE_dt = v_form - v_decay - v_Ibind\n        dI_dt = s_I - k_Iout * I - v_inact - v_Ibind\n\n        return [dC3_dt, dC3b_dt, diC3b_dt, dE_dt, dI_dt]\n\n    results = []\n    T_final = 3600.0\n    t_span = [0, T_final]\n\n    for case in test_cases:\n        # Set up parameters for the current case\n        current_params = params_base.copy()\n        current_params.update(case['params_override'])\n\n        # Set up initial conditions for the current case\n        y0 = [\n            case['initials']['C3_0'],  # C3(0)\n            0.0,                      # C3b(0)\n            0.0,                      # iC3b(0)\n            case['initials']['E_0'],   # E(0)\n            case['initials']['I_0']    # I(0)\n        ]\n\n        # Solve the ODE system\n        sol = solve_ivp(\n            complement_ode,\n            t_span,\n            y0,\n            method='Radau',\n            t_eval=[T_final],\n            args=(current_params,)\n        )\n\n        # Extract final state [C3, C3b, iC3b, E, I]\n        final_state = sol.y[:, -1]\n        \n        # Species indices: C3=0, C3b=1, iC3b=2, E=3\n        C3b_T = final_state[1]\n        iC3b_T = final_state[2]\n        E_T = final_state[3]\n\n        # Round and append the required results\n        results.append([round(C3b_T, 3), round(iC3b_T, 3), round(E_T, 3)])\n\n    # Format output according to specification\n    print(f\"[[{results[0][0]}, {results[0][1]}, {results[0][2]}], [{results[1][0]}, {results[1][1]}, {results[1][2]}], [{results[2][0]}, {results[2][1]}, {results[2][2]}], [{results[3][0]}, {results[3][1]}, {results[3][2]}], [{results[4][0]}, {results[4][1]}, {results[4][2]}]]\")\n\nsolve()\n```", "id": "2836590"}]}