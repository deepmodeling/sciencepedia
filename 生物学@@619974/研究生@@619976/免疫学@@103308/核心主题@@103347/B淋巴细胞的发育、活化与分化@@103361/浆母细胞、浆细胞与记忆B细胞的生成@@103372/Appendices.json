{"hands_on_practices": [{"introduction": "B细胞的激活并非一个简单的“开-关”转换，而是一个受多种信号调控的概率性事件。本练习通过一个简化的数学模型，探讨抗原信号（通过B细胞受体$BCR$）和先天免疫信号（通过Toll样受体$TLR9$）如何协同作用以增强激活效率。通过将这些随机的信号事件建模为泊松过程，你将能从量上分析协同刺激对B细胞激活概率的贡献，这是将生物学假设转化为可检验预测的核心实践。[@problem_id:2850066]", "problem": "在淋巴结滤泡中，初始B细胞扫描滤泡树突状细胞上呈递的抗原。早期的滤泡外浆母细胞的产生取决于B细胞是否在由细胞内信号动力学设定的一个短暂决策窗口期内被激活。将B细胞受体(BCR)参与和Toll样受体9(TLR9)信号传导所引发的具备激活能力的微簇的形成，建模为在该窗口期内的独立泊松过程。设BCR来源的具备激活能力的事件的期望数为 $\\lambda_{\\text{BCR}}=\\beta_{\\text{BCR}} D$，TLR9来源的具备激活能力的事件的期望数为 $\\lambda_{\\text{TLR}}=\\beta_{\\text{TLR}} D$，其中 $D$ 是扫描膜上的抗原表面密度，$\\beta_{\\text{BCR}}$ 和 $\\beta_{\\text{TLR}}$ 是比例常数，TLR9表示Toll样受体9，BCR表示B细胞受体。假设当且仅当窗口期内至少发生一个具备激活能力的事件时，激活才会发生。在没有TLR9激动剂的情况下，只有BCR驱动的过程起作用；在有TLR9激动剂（例如CpG寡脱氧核苷酸）的情况下，两个过程都起作用。\n\n从泊松过程的性质和“至少一个事件”概率的互补法则出发，首先推导在无激动剂和有激动剂条件下，激活概率作为 $D$ 的函数。然后，对于抗原密度 $D=100$（分子/$\\mu\\text{m}^2$），$\\beta_{\\text{BCR}}=0.01$ 和 $\\beta_{\\text{TLR}}=0.02$ 的情况，计算添加TLR9激动剂后激活概率的变化，定义为 $\\Delta P = P_{\\text{with}}(D)-P_{\\text{without}}(D)$。将您的答案四舍五入到四位有效数字，并以小数形式表示（无单位）。", "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- B细胞受体(BCR)参与和Toll样受体9(TLR9)信号传导所引发的具备激活能力的微簇的形成，被建模为独立的泊松过程。\n- BCR来源事件的期望数为 $\\lambda_{\\text{BCR}}=\\beta_{\\text{BCR}} D$。\n- TLR9来源事件的期望数为 $\\lambda_{\\text{TLR}}=\\beta_{\\text{TLR}} D$。\n- $D$ 是抗原表面密度。\n- $\\beta_{\\text{BCR}}$ 和 $\\beta_{\\text{TLR}}$ 是比例常数。\n- 当且仅当在一个固定的决策窗口期内至少发生一个具备激活能力的事件时，激活才会发生。\n- 在没有TLR9激动剂的情况下，只有BCR驱动的过程起作用。\n- 在有TLR9激动剂的情况下，两个过程都起作用。\n- 为特定计算提供的数值：$D=100$ 分子/$\\mu\\text{m}^2$，$\\beta_{\\text{BCR}}=0.01$ 和 $\\beta_{\\text{TLR}}=0.02$。\n- 目标是推导激活概率函数 $P_{\\text{without}}(D)$ 和 $P_{\\text{with}}(D)$，然后根据给定的数值计算变化量 $\\Delta P = P_{\\text{with}}(D)-P_{\\text{without}}(D)$，并四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题采用标准的定量生物学方法，用一个易于理解的统计模型（泊松过程）来建模一个随机的细胞过程（B细胞激活）。BCR和TLR9在B细胞免疫学中的作用是既定事实。该模型是一个简化模型，但在科学上是合理的，并非基于伪科学。\n- **适定性**：该问题是适定的。它提供了一个清晰的理论框架、所有必要的参数，以及对需要推导和计算的量有明确的定义。存在唯一解。\n- **客观性**：问题以精确、客观的语言陈述。\n- **完整性和一致性**：提供了所有必要的信息。明确指出了两个泊松过程相互独立的假设，这对求解至关重要。没有矛盾之处。\n\n### 步骤3：结论与行动\n问题有效。我们继续进行求解。\n\n对于一个期望事件数（均值）为 $\\lambda$ 的泊松过程，观察到恰好 $k$ 个事件的概率由其概率质量函数给出：\n$$P(N=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$$\n激活被定义为发生至少一个事件，即 $N \\ge 1$。更直接的方法是计算其互补事件的概率，即发生零个事件（$N=0$），然后用1减去这个概率。\n发生零个事件的概率是：\n$$P(N=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)$$\n因此，激活概率 $P_{\\text{act}}$，即 $P(N \\ge 1)$，是：\n$$P_{\\text{act}} = 1 - P(N=0) = 1 - \\exp(-\\lambda)$$\n\n首先，我们推导在没有TLR9激动剂的情况下的激活概率，记为 $P_{\\text{without}}(D)$。在这种情况下，只有BCR驱动的过程是活跃的。事件的平均数是 $\\lambda_{\\text{BCR}} = \\beta_{\\text{BCR}} D$。\n激活概率为：\n$$P_{\\text{without}}(D) = 1 - \\exp(-\\lambda_{\\text{BCR}}) = 1 - \\exp(-\\beta_{\\text{BCR}} D)$$\n\n接下来，我们推导在存在TLR9激动剂的情况下的激活概率，记为 $P_{\\text{with}}(D)$。此时，BCR和TLR9过程都起作用。问题陈述它们是独立的。只有当*两个*过程都产生零个事件时，激活才会失败。设 $N_{\\text{BCR}}$ 和 $N_{\\text{TLR}}$ 分别为来自每个过程的事件数。不激活的概率是：\n$$P(\\text{不激活}) = P(N_{\\text{BCR}}=0 \\text{ and } N_{\\text{TLR}}=0)$$\n由于过程的独立性：\n$$P(\\text{不激活}) = P(N_{\\text{BCR}}=0) \\times P(N_{\\text{TLR}}=0) = \\exp(-\\lambda_{\\text{BCR}}) \\times \\exp(-\\lambda_{\\text{TLR}})$$\n$$P(\\text{不激活}) = \\exp(-(\\lambda_{\\text{BCR}} + \\lambda_{\\text{TLR}}))$$\n激活概率 $P_{\\text{with}}(D)$ 是其互补概率：\n$$P_{\\text{with}}(D) = 1 - P(\\text{不激活}) = 1 - \\exp(-(\\lambda_{\\text{BCR}} + \\lambda_{\\text{TLR}}))$$\n代入 $\\lambda_{\\text{BCR}}$ 和 $\\lambda_{\\text{TLR}}$ 的给定表达式：\n$$P_{\\text{with}}(D) = 1 - \\exp(-(\\beta_{\\text{BCR}} D + \\beta_{\\text{TLR}} D)) = 1 - \\exp(-(\\beta_{\\text{BCR}} + \\beta_{\\text{TLR}})D)$$\n请注意，这等同于将总激活事件视为一个单一的组合泊松过程，其速率等于各个独立泊松过程速率之和，即 $\\lambda_{\\text{total}} = \\lambda_{\\text{BCR}} + \\lambda_{\\text{TLR}}$，这是独立泊松过程的一个已知性质。\n\n现在，我们使用推导出的表达式来计算激活概率的变化量 $\\Delta P = P_{\\text{with}}(D) - P_{\\text{without}}(D)$：\n$$\\Delta P = \\left(1 - \\exp(-(\\beta_{\\text{BCR}} + \\beta_{\\text{TLR}})D)\\right) - \\left(1 - \\exp(-\\beta_{\\text{BCR}} D)\\right)$$\n$$\\Delta P = 1 - \\exp(-(\\beta_{\\text{BCR}} + \\beta_{\\text{TLR}})D) - 1 + \\exp(-\\beta_{\\text{BCR}} D)$$\n$$\\Delta P = \\exp(-\\beta_{\\text{BCR}} D) - \\exp(-(\\beta_{\\text{BCR}} + \\beta_{\\text{TLR}})D)$$\n\n我们给定的数值为 $D=100$，$\\beta_{\\text{BCR}}=0.01$ 和 $\\beta_{\\text{TLR}}=0.02$。首先，我们计算泊松均值 $\\lambda$ 的值：\n$$\\lambda_{\\text{BCR}} = \\beta_{\\text{BCR}} D = 0.01 \\times 100 = 1$$\n$$\\lambda_{\\text{TLR}} = \\beta_{\\text{TLR}} D = 0.02 \\times 100 = 2$$\n在有激动剂的情况下，总速率为 $\\lambda_{\\text{total}} = \\lambda_{\\text{BCR}} + \\lambda_{\\text{TLR}} = 1 + 2 = 3$。\n\n现在我们将这些值代入 $\\Delta P$ 的表达式中：\n$$\\Delta P = \\exp(-\\lambda_{\\text{BCR}}) - \\exp(-(\\lambda_{\\text{BCR}} + \\lambda_{\\text{TLR}}))$$\n$$\\Delta P = \\exp(-1) - \\exp(-3)$$\n我们计算其数值：\n$$\\exp(-1) \\approx 0.36787944...$$\n$$\\exp(-3) \\approx 0.04978707...$$\n$$\\Delta P \\approx 0.36787944 - 0.04978707 = 0.31809237...$$\n将结果四舍五入到四位有效数字，得到 $0.3181$。", "answer": "$$\\boxed{0.3181}$$", "id": "2850066"}, {"introduction": "免疫应答的最终产物之一是分泌抗体的浆细胞，但我们如何精确地计数这些在庞大细胞群体中“千里挑一”的细胞呢？本练习将带你深入了解酶联免疫斑点（ELISPOT）分析背后的核心统计原理——极限稀释法。通过从第一性原理出发，利用泊松分布推导出从实验数据中估算抗体分泌细胞频率的方法，你将能真正掌握这一经典免疫学技术背后的定量逻辑，并架起理论模型与实验数据之间的桥梁。[@problem_id:2850138]", "problem": "一只小鼠经T细胞依赖性蛋白质抗原免疫后，在第7天，其脾脏内含有多种抗原经验性B细胞的后代：短寿命浆母细胞、新生浆细胞和一些早期记忆B细胞。采用酶联免疫斑点 (ELISPOT) 检测法对抗原特异性抗体分泌细胞进行计数，其原理是，如果一个孔中存在至少一个抗原特异性抗体分泌细胞（浆母细胞或浆细胞）并产生一个斑点，则该孔将被计为阳性。您将脾细胞充分混合后，铺入 $12$ 个孔中，每孔含有 $c = 100{,}000$ 个活脾细胞。您观察到 $9$ 个阳性孔和 $3$ 个阴性孔。假设抗原特异性抗体分泌细胞是稀有的，在各孔中独立且随机分布，因此每孔中抗原特异性细胞的数量遵循泊松过程，并且铺板和检测过程是完美的。此前的流式细胞术估计，在类似的小鼠中，大约每 $10{,}000$ 个脾细胞中含有 $1$ 个抗原特异性抗体分泌细胞，但您将根据极限稀释法原理，直接从ELISPOT数据中推断其频率。\n\n仅使用这些假设，并从稀有独立事件的泊松分布定义出发，推导抗原特异性抗体分泌细胞在总脾细胞中所占频率 $f$ 的最大似然估计。请以包含自然对数的单个闭式解析表达式形式给出最终答案；请勿进行数值近似。无需单位。", "solution": "首先对问题陈述进行严格验证。\n\n**提取的已知条件：**\n- 铺板总孔数：$N=12$。\n- 观察到的阳性孔数：$k_{pos}=9$。\n- 观察到的阴性孔数：$k_{neg}=3$。\n- 每孔铺板的脾细胞数：$c = 100{,}000 = 10^5$。\n- 假设每孔的抗原特异性抗体分泌细胞 (ASC) 数量遵循泊松过程。\n- 目标是推导 ASC 频率的最大似然估计 (MLE)，记为 $f$。\n\n**验证结论：**\n该问题是有效的。它代表了极限稀释分析的一个典型案例，这是定量免疫学中的一种标准技术。所提供的数据是完整且内部一致的，因为阳性孔和阴性孔之和等于总孔数（$k_{pos} + k_{neg} = 9+3 = 12 = N$）。稀有事件、随机分布和泊松过程等假设都已明确陈述，构成了一个数学上适定的问题。不存在科学不准确、矛盾或模糊之处。我们可以继续进行推导。\n\n**最大似然估计的推导：**\n\n设 $f$ 为 ASC 在总脾细胞群体中的真实频率。设 $c$ 为每孔中铺板的脾细胞数量。每孔中 ASC 的平均数或期望数，记为 $\\lambda$，是频率与每孔细胞数的乘积：\n$$\n\\lambda = f \\cdot c\n$$\n根据问题陈述，任何给定孔中的 ASC 数量（由随机变量 $X$ 表示）遵循均值为 $\\lambda$ 的泊松分布。$X$ 的概率质量函数由下式给出：\n$$\nP(X=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}\n$$\n其中 $k$ 是一个非负整数（$k=0, 1, 2, \\dots$）。\n\n当且仅当一个孔包含零个 ASC（$X=0$）时，该孔被观察为阴性。因此，单个孔为阴性的概率 $P_{\\text{neg}}$ 为：\n$$\nP_{\\text{neg}} = P(X=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)\n$$\n通过代入 $\\lambda = fc$，我们将此概率用频率 $f$ 表示：\n$$\nP_{\\text{neg}} = \\exp(-fc)\n$$\n该实验涉及 $N$ 个独立的孔。每个孔代表一个只有两个结果的伯努利试验：阴性（概率为 $P_{\\text{neg}}$）或阳性（概率为 $P_{\\text{pos}} = 1 - P_{\\text{neg}}$）。在总共 $N$ 个孔中观察到 $k_{neg}$ 个阴性孔和 $k_{pos}$ 个阳性孔的事件遵循二项分布。此结果的似然函数 $L(f)$ 为：\n$$\nL(f) = \\binom{N}{k_{neg}} (P_{\\text{neg}})^{k_{neg}} (1 - P_{\\text{neg}})^{k_{pos}}\n$$\n将 $P_{\\text{neg}}$ 的表达式用 $f$ 代入，我们得到：\n$$\nL(f) = \\binom{N}{k_{neg}} (\\exp(-fc))^{k_{neg}} (1 - \\exp(-fc))^{k_{pos}}\n$$\n为了找到 $f$ 的最大似然估计 (MLE)，记为 $\\hat{f}$，我们必须找到使 $L(f)$ 最大化的 $f$ 值。在数学上，最大化似然函数的自然对数 $\\mathcal{L}(f) = \\ln(L(f))$ 更为方便，因为对数是严格单调递增函数。\n$$\n\\mathcal{L}(f) = \\ln\\left(\\binom{N}{k_{neg}}\\right) + \\ln\\left((\\exp(-fc))^{k_{neg}}\\right) + \\ln\\left((1 - \\exp(-fc))^{k_{pos}}\\right)\n$$\n$$\n\\mathcal{L}(f) = \\ln\\left(\\binom{N}{k_{neg}}\\right) - k_{neg}fc + k_{pos}\\ln(1 - \\exp(-fc))\n$$\n为了求最大值，我们计算 $\\mathcal{L}(f)$ 关于 $f$ 的导数，并令其为零。\n$$\n\\frac{d\\mathcal{L}}{df} = 0 - k_{neg}c + k_{pos} \\left( \\frac{1}{1 - \\exp(-fc)} \\right) \\frac{d}{df}(1 - \\exp(-fc))\n$$\n$$\n\\frac{d\\mathcal{L}}{df} = -k_{neg}c + k_{pos} \\left( \\frac{1}{1 - \\exp(-fc)} \\right) (c\\exp(-fc))\n$$\n将导数设为零以求得 MLE $\\hat{f}$：\n$$\n-k_{neg}c + \\frac{k_{pos}c\\exp(-\\hat{f}c)}{1 - \\exp(-\\hat{f}c)} = 0\n$$\n由于 $c \\neq 0$，我们可以将方程两边同除以 $c$：\n$$\nk_{neg} = \\frac{k_{pos}\\exp(-\\hat{f}c)}{1 - \\exp(-\\hat{f}c)}\n$$\n现在我们求解 $\\hat{f}$。\n$$\nk_{neg}(1 - \\exp(-\\hat{f}c)) = k_{pos}\\exp(-\\hat{f}c)\n$$\n$$\nk_{neg} - k_{neg}\\exp(-\\hat{f}c) = k_{pos}\\exp(-\\hat{f}c)\n$$\n$$\nk_{neg} = (k_{pos} + k_{neg})\\exp(-\\hat{f}c)\n$$\n认识到 $k_{pos} + k_{neg} = N$，即总孔数：\n$$\nk_{neg} = N\\exp(-\\hat{f}c)\n$$\n这导出了一个直观的结果：一个孔为阴性概率的 MLE，即 $\\exp(-\\hat{f}c)$，等于观察到的阴性孔的比例，$k_{neg}/N$。\n$$\n\\exp(-\\hat{f}c) = \\frac{k_{neg}}{N}\n$$\n为了分离出 $\\hat{f}$，我们对两边取自然对数：\n$$\n-\\hat{f}c = \\ln\\left(\\frac{k_{neg}}{N}\\right)\n$$\n求解 $\\hat{f}$：\n$$\n\\hat{f} = -\\frac{1}{c}\\ln\\left(\\frac{k_{neg}}{N}\\right) = \\frac{1}{c}\\ln\\left(\\left(\\frac{k_{neg}}{N}\\right)^{-1}\\right) = \\frac{1}{c}\\ln\\left(\\frac{N}{k_{neg}}\\right)\n$$\n这是 MLE 的通用表达式。现在我们代入给定的数值：$N=12$，$k_{neg}=3$，以及 $c=100{,}000$。\n$$\n\\hat{f} = \\frac{1}{100000} \\ln\\left(\\frac{12}{3}\\right)\n$$\n$$\n\\hat{f} = \\frac{1}{100000} \\ln(4)\n$$\n这就是估计频率的最终闭式解析表达式。", "answer": "$$\n\\boxed{\\frac{\\ln(4)}{100000}}\n$$", "id": "2850138"}, {"introduction": "B细胞活化后的命运抉择——是快速分化为法外滤泡（$EF$）浆母细胞，还是进入生发中心（$GC$）进行亲和力成熟——是一个动态且随时间演变的过程。这个综合性练习要求你构建一个描述这两个细胞群动态变化的常微分方程（$ODE$）模型。通过从基本假设出发建立模型、求解方程并进行计算，你将掌握使用系统生物学方法来模拟和预测免疫应答动力学的强大工具，从而将静态的细胞命运概念转化为动态的系统行为。[@problem_id:2850147]", "problem": "您的任务是推导、分析和计算一个用于抗体分泌细胞生成的最小机制模型，该模型区分了滤泡外（EF）浆母细胞和生发中心（GC）B细胞。您的推导必须从下述核心免疫学事实和建模假设出发，推导出一组常微分方程（ODEs），然后求出其精确解析解。最后，您必须实现一个程序来对指定的测试集评估这些解，并按要求的格式输出结果。\n\n核心事实与建模假设：\n- 抗原 $A(t)$ 是激活初始B细胞的上游信号；根据克隆选择理论，激活强度与 $A(t)$ 成比例。\n- 抗原因清除而衰减，其形式为指数衰减 $A(t)=A_0 e^{-\\lambda t}$，其中 $A_0 > 0$ 且 $\\lambda > 0$。\n- 活化的B细胞可以沿EF路径分化为浆母细胞，或被招募到GC中。我们将其建模为两个独立的区室：EF浆母细胞 $E(t)$ 和GC B细胞 $G(t)$。\n- 进入EF和GC区室的瞬时流入量与激活强度和通路特异性速率成正比。设 $\\alpha$ 为激活速率常数，$\\beta$ 为EF分化速率常数，$\\gamma$ 为GC招募速率常数。因此，EF和GC的流入量分别被视为与 $\\alpha \\beta A(t)$ 和 $\\alpha \\gamma A(t)$ 成正比。\n- EF浆母细胞和GC B细胞分别以一阶死亡速率 $\\delta_E$ 和 $\\delta_G$ 减少。\n\n任务：\n1) 仅从上述核心事实与建模假设出发（而非任何预先给定的目标公式），为由 $A(t)=A_0 e^{-\\lambda t}$ 驱动的 $E(t)$ 和 $G(t)$ 建立一个最小线性ODE系统，其参数为 $\\alpha$、$\\beta$、$\\gamma$、$\\delta_E$ 和 $\\delta_G$。\n\n2) 在任意非负初始条件 $E(0)=E_0$ 和 $G(0)=G_0$ 下，精确求解该ODE组。您的解必须处理通用情况 $\\delta_E \\neq \\lambda$ 和 $\\delta_G \\neq \\lambda$，以及共振情况 $\\delta_E=\\lambda$ 和/或 $\\delta_G=\\lambda$。\n\n3) 通过将 $A(t)$ 固定在时刻 $t$ 的当前值并将时间导数设为零，来定义瞬时准稳态。推导出 $E_{\\mathrm{ss}}(t)$ 和 $G_{\\mathrm{ss}}(t)$ 关于 $A(t)$ 和各参数的闭式表达式。\n\n4) 在给定的抗原衰减条件下，确定长时间稳态 $\\lim_{t\\to\\infty}(E(t),G(t))$。\n\n5) 实现任务。使用您推导出的公式，编写一个程序，对下述每个测试用例，在单个评估时间 $t_{\\mathrm{eval}}$ 进行评估，返回一个包含六个浮点数的列表：\n- $E(t_{\\mathrm{eval}})$\n- $G(t_{\\mathrm{eval}})$\n- $E_{\\mathrm{ss}}(t_{\\mathrm{eval}})$\n- $G_{\\mathrm{ss}}(t_{\\mathrm{eval}})$\n- $E_{\\infty}=\\lim_{t\\to\\infty}E(t)$\n- $G_{\\infty}=\\lim_{t\\to\\infty}G(t)$\n\n科学真实性和可解释性约束：\n- 除时间以天为单位外，所有变量都已无量纲化。输出中不应打印任何单位。所有参数均为非负实数。\n- 您的解应从上述第一性原理推导得出，不使用任何预先指定的目标公式。\n\n测试集：\n为以下三组参数集提供结果。对于每种情况，在指定的 $t_{\\mathrm{eval}}$ 进行计算。\n\n- 情况1（通用非相等速率）：$A_0=1.0$, $\\lambda=0.3$, $\\alpha=0.8$, $\\beta=0.5$, $\\gamma=0.2$, $\\delta_E=0.6$, $\\delta_G=0.4$, $E_0=0.0$, $G_0=0.0$, $t_{\\mathrm{eval}}=2.0$。\n- 情况2（共振EF损失）：$A_0=2.0$, $\\lambda=0.5$, $\\alpha=1.2$, $\\beta=0.7$, $\\gamma=0.4$, $\\delta_E=0.5$, $\\delta_G=0.9$, $E_0=0.3$, $G_0=0.1$, $t_{\\mathrm{eval}}=1.0$。\n- 情况3（无EF分化和共振GC损失）：$A_0=1.5$, $\\lambda=0.2$, $\\alpha=0.9$, $\\beta=0.0$, $\\gamma=0.6$, $\\delta_E=0.7$, $\\delta_G=0.2$, $E_0=0.0$, $G_0=0.5$, $t_{\\mathrm{eval}}=3.0$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个含三个内部列表（每个情况一个）的列表，每个内部列表按上述顺序包含六个浮点数。具体而言，输出必须是以下形式的单行：\n$[ [E_1,G_1,E_{\\mathrm{ss},1},G_{\\mathrm{ss},1},E_{\\infty,1},G_{\\infty,1}], [E_2,\\dots], [E_3,\\dots] ]$\n不含任何附加文本。将每个符号替换为计算出的浮点数。", "solution": "问题陈述经评估具有科学依据、是良定的、客观且完整的。它描述了数学生物学中的一个标准练习，涉及基于一组清晰、最小化的假设来建立和求解一个常微分方程（ODE）系统。该问题是有效的。\n\n求解过程遵循问题陈述中指定的任务，分四个步骤展开。\n\n任务1：ODE系统的建立\n\n该模型描述了两个细胞群体——滤泡外（EF）浆母细胞 $E(t)$ 和生发中心（GC）B细胞 $G(t)$ 的动力学。每个群体的变化率是流入（生成）和流出（损失）之间的平衡。\n\n每个区室的流入量与抗原驱动的激活强度成正比。抗原浓度由 $A(t) = A_0 e^{-\\lambda t}$ 给出。问题陈述指出，EF流入量与 $\\alpha \\beta A(t)$ 成正比，GC流入量与 $\\alpha \\gamma A(t)$ 成正比。最直接和最简约的解释是，这些就是流入速率。\n每个区室的损失是一个一阶过程，速率常数分别为 $\\delta_E$ 和 $\\delta_G$。\n\n因此，EF浆母细胞群体的变化率 $\\frac{dE}{dt}$ 由流入量 $\\alpha \\beta A(t)$ 减去流出量 $\\delta_E E(t)$ 给出。\n$$\n\\frac{dE(t)}{dt} = \\alpha \\beta A_0 e^{-\\lambda t} - \\delta_E E(t)\n$$\n类似地，GC B细胞群体的变化率 $\\frac{dG}{dt}$ 由流入量 $\\alpha \\gamma A(t)$ 减去流出量 $\\delta_G G(t)$ 给出。\n$$\n\\frac{dG(t)}{dt} = \\alpha \\gamma A_0 e^{-\\lambda t} - \\delta_G G(t)\n$$\n这两个方程构成了一个包含两个解耦的、一阶、线性、非齐次ODE的系统。初始条件为 $E(0) = E_0$ 和 $G(0) = G_0$。\n\n任务2：ODE的解析解\n\n这两个ODE具有相同的一般形式：\n$$\n\\frac{dy(t)}{dt} + \\delta y(t) = C e^{-\\lambda t}\n$$\n初始条件为 $y(0) = y_0$。对于 $E(t)$ 方程，我们有 $y = E$, $\\delta = \\delta_E$, $C = \\alpha \\beta A_0$ 和 $y_0 = E_0$。对于 $G(t)$ 方程，我们有 $y = G$, $\\delta = \\delta_G$, $C = \\alpha \\gamma A_0$ 和 $y_0 = G_0$。\n\n我们使用积分因子法求解此一般形式。积分因子为 $I(t) = e^{\\int \\delta dt} = e^{\\delta t}$。将ODE两边乘以 $I(t)$ 得：\n$$\ne^{\\delta t} \\frac{dy}{dt} + \\delta e^{\\delta t} y(t) = C e^{\\delta t} e^{-\\lambda t}\n$$\n左侧是乘积 $e^{\\delta t} y(t)$ 的导数：\n$$\n\\frac{d}{dt} \\left( e^{\\delta t} y(t) \\right) = C e^{(\\delta - \\lambda) t}\n$$\n对 $t$ 进行积分：\n$$\ne^{\\delta t} y(t) = \\int C e^{(\\delta - \\lambda) t} dt + K\n$$\n其中 $K$ 是积分常数。我们必须考虑积分的两种情况。\n\n情况A：非共振情况，$\\delta \\neq \\lambda$。\n积分得出：\n$$\ne^{\\delta t} y(t) = \\frac{C}{\\delta - \\lambda} e^{(\\delta - \\lambda) t} + K\n$$\n求解 $y(t)$：\n$$\ny(t) = \\frac{C}{\\delta - \\lambda} e^{-\\lambda t} + K e^{-\\delta t}\n$$\n使用初始条件 $y(0) = y_0$：\n$$\ny_0 = \\frac{C}{\\delta - \\lambda} e^0 + K e^0 = \\frac{C}{\\delta - \\lambda} + K \\implies K = y_0 - \\frac{C}{\\delta - \\lambda}\n$$\n将 $K$ 代回，解为：\n$$\ny(t) = y_0 e^{-\\delta t} + \\frac{C}{\\delta - \\lambda} (e^{-\\lambda t} - e^{-\\delta t})\n$$\n\n情况B：共振情况，$\\delta = \\lambda$。\n积分中的指数变为零，$e^0 = 1$。积分为：\n$$\n\\int C dt = Ct\n$$\n因此：\n$$\ne^{\\delta t} y(t) = Ct + K\n$$\n求解 $y(t)$：\n$$\ny(t) = (Ct + K) e^{-\\delta t}\n$$\n使用初始条件 $y(0) = y_0$：\n$$\ny_0 = (C \\cdot 0 + K) e^0 = K\n$$\n将 $K = y_0$ 代回，解为：\n$$\ny(t) = (y_0 + Ct) e^{-\\delta t}\n$$\n\n将这些通解应用于 $E(t)$ 和 $G(t)$：\n\n$E(t)$ 的解：\n如果 $\\delta_E \\neq \\lambda$：\n$$\nE(t) = E_0 e^{-\\delta_E t} + \\frac{\\alpha \\beta A_0}{\\delta_E - \\lambda} (e^{-\\lambda t} - e^{-\\delta_E t})\n$$\n如果 $\\delta_E = \\lambda$：\n$$\nE(t) = (E_0 + \\alpha \\beta A_0 t) e^{-\\delta_E t}\n$$\n\n$G(t)$ 的解：\n如果 $\\delta_G \\neq \\lambda$：\n$$\nG(t) = G_0 e^{-\\delta_G t} + \\frac{\\alpha \\gamma A_0}{\\delta_G - \\lambda} (e^{-\\lambda t} - e^{-\\delta_G t})\n$$\n如果 $\\delta_G = \\lambda$：\n$$\nG(t) = (G_0 + \\alpha \\gamma A_0 t) e^{-\\delta_G t}\n$$\n\n任务3：瞬时准稳态\n\n瞬时准稳态是通过将ODE中的时间导数设为零，同时将在给定时间 $t$ 的抗原浓度 $A(t)$ 视为常数来找到的。我们将这些状态表示为 $E_{\\mathrm{ss}}(t)$ 和 $G_{\\mathrm{ss}}(t)$。\n对于 $E(t)$，我们设 $\\frac{dE}{dt} = 0$：\n$$\n0 = \\alpha \\beta A(t) - \\delta_E E_{\\mathrm{ss}}(t)\n$$\n假设 $\\delta_E > 0$，我们求解 $E_{\\mathrm{ss}}(t)$：\n$$\nE_{\\mathrm{ss}}(t) = \\frac{\\alpha \\beta}{\\delta_E} A(t) = \\frac{\\alpha \\beta A_0}{\\delta_E} e^{-\\lambda t}\n$$\n对于 $G(t)$，我们设 $\\frac{dG}{dt} = 0$：\n$$\n0 = \\alpha \\gamma A(t) - \\delta_G G_{\\mathrm{ss}}(t)\n$$\n假设 $\\delta_G > 0$，我们求解 $G_{\\mathrm{ss}}(t)$：\n$$\nG_{\\mathrm{ss}}(t) = \\frac{\\alpha \\gamma}{\\delta_G} A(t) = \\frac{\\alpha \\gamma A_0}{\\delta_G} e^{-\\lambda t}\n$$\n\n任务4：长时间稳态\n\n长时间稳态是解在 $t \\to \\infty$ 时的极限。我们将其表示为 $E_\\infty = \\lim_{t\\to\\infty} E(t)$ 和 $G_\\infty = \\lim_{t\\to\\infty} G(t)$。\n参数 $\\lambda$、$\\delta_E$ 和 $\\delta_G$ 被给定或假定为正常数（抗原衰减和细胞死亡速率）。\n\n在 $E(t)$ 的非共振情况下（$\\delta_E \\neq \\lambda$）：\n$$\n\\lim_{t\\to\\infty} E(t) = \\lim_{t\\to\\infty} \\left( E_0 e^{-\\delta_E t} + \\frac{\\alpha \\beta A_0}{\\delta_E - \\lambda} (e^{-\\lambda t} - e^{-\\delta_E t}) \\right)\n$$\n由于对于任何 $k > 0$，$e^{-kt}$ 在 $t \\to \\infty$ 时趋向于0，所有项都消失了。\n$$\nE_\\infty = 0 + \\frac{\\alpha \\beta A_0}{\\delta_E - \\lambda} (0 - 0) = 0\n$$\n\n在 $E(t)$ 的共振情况下（$\\delta_E = \\lambda$）：\n$$\n\\lim_{t\\to\\infty} E(t) = \\lim_{t\\to\\infty} (E_0 + \\alpha \\beta A_0 t) e^{-\\lambda t} = \\lim_{t\\to\\infty} E_0 e^{-\\lambda t} + \\lim_{t\\to\\infty} \\alpha \\beta A_0 t e^{-\\lambda t}\n$$\n第一项为0。第二项是 $\\infty \\cdot 0$ 的形式。对 $\\frac{t}{e^{\\lambda t}}$ 应用 L'Hôpital's rule：\n$$\n\\lim_{t\\to\\infty} \\frac{t}{e^{\\lambda t}} = \\lim_{t\\to\\infty} \\frac{\\frac{d}{dt}t}{\\frac{d}{dt}e^{\\lambda t}} = \\lim_{t\\to\\infty} \\frac{1}{\\lambda e^{\\lambda t}} = 0\n$$\n因此，$E_\\infty = 0$。\n\n同样的分析也适用于 $G(t)$。在所有 $\\lambda > 0$、$\\delta_E > 0$ 和 $\\delta_G > 0$ 的有效场景中，长时间稳态都是平凡的：\n$$\nE_\\infty = 0\n$$\n$$\nG_\\infty = 0\n$$\n这在生物学上是符合预期的：没有持续的抗原刺激，特异性B细胞群体最终将衰减至零。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the B cell differentiation model for the given test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (generic distinct rates)\n        {\n            'params': (1.0, 0.3, 0.8, 0.5, 0.2, 0.6, 0.4, 0.0, 0.0),\n            't_eval': 2.0\n        },\n        # Case 2 (resonant EF loss)\n        {\n            'params': (2.0, 0.5, 1.2, 0.7, 0.4, 0.5, 0.9, 0.3, 0.1),\n            't_eval': 1.0\n        },\n        # Case 3 (no EF differentiation and resonant GC loss)\n        {\n            'params': (1.5, 0.2, 0.9, 0.0, 0.6, 0.7, 0.2, 0.0, 0.5),\n            't_eval': 3.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        A0, lam, alpha, beta, gamma, delta_E, delta_G, E0, G0 = case['params']\n        t = case['t_eval']\n        \n        # Calculate E(t)\n        c_E = alpha * beta * A0\n        # Using a small tolerance for floating point comparison of rates\n        if abs(delta_E - lam)  1e-9:\n            # Resonant case for E\n            E_t = (E0 + c_E * t) * np.exp(-delta_E * t)\n        else:\n            # Non-resonant case for E\n            term1 = E0 * np.exp(-delta_E * t)\n            term2 = (c_E / (delta_E - lam)) * (np.exp(-lam * t) - np.exp(-delta_E * t))\n            E_t = term1 + term2\n\n        # Calculate G(t)\n        c_G = alpha * gamma * A0\n        if abs(delta_G - lam)  1e-9:\n            # Resonant case for G\n            G_t = (G0 + c_G * t) * np.exp(-delta_G * t)\n        else:\n            # Non-resonant case for G\n            term1 = G0 * np.exp(-delta_G * t)\n            term2 = (c_G / (delta_G - lam)) * (np.exp(-lam * t) - np.exp(-delta_G * t))\n            G_t = term1 + term2\n            \n        # Antigen level at t_eval\n        A_t = A0 * np.exp(-lam * t)\n\n        # Calculate instantaneous quasi-steady state E_ss(t)\n        # Handle case where delta_E could be zero, though not in test cases.\n        E_ss_t = (alpha * beta / delta_E) * A_t if delta_E > 0 else 0.0\n\n        # Calculate instantaneous quasi-steady state G_ss(t)\n        # Handle case where delta_G could be zero.\n        G_ss_t = (alpha * gamma / delta_G) * A_t if delta_G > 0 else 0.0\n\n        # Long-time steady state\n        E_inf = 0.0\n        G_inf = 0.0\n\n        results.append([E_t, G_t, E_ss_t, G_ss_t, E_inf, G_inf])\n\n    # Format output string to match the required format without spaces inside inner lists.\n    outer_parts = []\n    for inner_list in results:\n        # Using f-string formatting to control float representation if needed,\n        # but str() is generally sufficient.\n        inner_str = ','.join(map(str, inner_list))\n        outer_parts.append(f\"[{inner_str}]\")\n    \n    final_output_string = f\"[{','.join(outer_parts)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "2850147"}]}