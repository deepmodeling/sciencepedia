{"hands_on_practices": [{"introduction": "将理论知识应用于实际是检验理解的关键。本练习将带您进入一个典型的免疫学实验场景，要求您解读流式细胞术数据，这是研究细胞群体的核心技术之一。\n\n通过这个练习，您将学习如何从包含瞬时中间态（$IgM^+$ $IgG1^+$ 双阳性细胞）的复杂数据中，精确地量化已完成类别转换（即仅表达 $IgG1$ 的细胞）的 B 细胞比例，从而计算出类别转换重组 (CSR) 的频率 [@problem_id:2858720]。这培养了将原始实验输出转化为有意义的生物学参数的关键能力。", "problem": "一个纯化的鼠源初始B淋巴细胞群体在体外受到刺激，刺激条件可诱导其发生向免疫球蛋白G亚类1 (IgG1)的类别转换重组 (CSR)。类别转换重组 (CSR) 定义为一种由重组驱动的免疫球蛋白重链恒定区的替换过程，该过程会改变同种型（例如，从免疫球蛋白M (IgM) 转换为免疫球蛋白G亚类1 (IgG1)），但不会改变抗原结合可变区。使用流式细胞术在基线和刺激后对表面免疫球蛋白重链同种型进行定量。假设以下科学标准测量和生物学前提作为定量的基础：\n- CSR 会导致在同一重链基因座上获得IgG1恒定区，并在完成后失去IgM恒定区。\n- 流式细胞术检测表面蛋白；正在进行CSR的细胞可以瞬时共表达两种同种型，从而产生一个IgM阳性且IgG1阳性的双阳性群体。\n- 某一同种型门控报告的百分比包括落入该门控内的所有双阳性细胞。\n- 在整个测量区间内，总的活B细胞比例保持稳定，并且终点出现的免疫球蛋白G亚类1 (IgG1)阳性细胞是由初始的免疫球蛋白M (IgM)阳性B细胞经过CSR产生的。\n- 基线的免疫球蛋白G亚类1 (IgG1)阳性率可忽略不计。\n\n给定以下流式细胞术观察结果：\n- 在基线时，免疫球蛋白M (IgM)阳性细胞的比例为 $90\\%$。\n- 在 $72$ 小时，免疫球蛋白M (IgM)阳性细胞的比例为 $40\\%$，免疫球蛋白G亚类1 (IgG1)阳性细胞的比例为 $50\\%$，而免疫球蛋白M (IgM)阳性和免疫球蛋白G亚类1 (IgG1)阳性的双阳性细胞比例为 $10\\%$。\n\n将向免疫球蛋白G亚类1 (IgG1)的CSR频率操作性地定义为：到 $72$ 小时时间点，初始免疫球蛋白M (IgM)阳性群体中已完成向免疫球蛋白G亚类1 (IgG1)进行CSR的细胞所占的比例，其中，完成的标志是细胞在 $72$ 小时为免疫球蛋白G亚类1 (IgG1)阳性且免疫球蛋白M (IgM)阴性。仅使用给定的测量值计算此CSR频率。将最终答案表示为无单位小数。将答案四舍五入至三位有效数字。", "solution": "本题要求根据体外B淋巴细胞培养的流式细胞术数据，计算向免疫球蛋白G亚类1 (IgG1)的类别转换重组 (CSR) 频率。该问题陈述经核实，科学上成立、逻辑一致且定义明确。我们可以开始求解。\n\n设活B淋巴细胞总群体归一化为 $1$。问题中给出的比例代表了相对于此总体的亚群。我们根据所提供的数据定义以下变量：\n\n- $M_0$：基线时间点 ($t=0$) 时，免疫球蛋白M (IgM)阳性细胞的比例。根据题意，$M_0 = 0.90$。\n- $M_{72}$：$72$ 小时时间点时，IgM阳性细胞的比例。根据题意，$M_{72} = 0.40$。\n- $G_{72}$：$72$ 小时时间点时，IgG1阳性细胞的比例。根据题意，$G_{72} = 0.50$。\n- $(M \\cap G)_{72}$：$72$ 小时时间点时，IgM和IgG1双阳性细胞的比例。根据题意，$(M \\cap G)_{72} = 0.10$。\n\nCSR频率，我们记为 $F_{CSR}$，操作性地定义为到 $72$ 小时时间点，初始IgM阳性群体中已完成CSR的细胞所占的比例。CSR的完成标志是细胞为IgG1阳性且IgM阴性。\n\n首先，我们必须确定已完成CSR的细胞占总细胞群体的比例。这些细胞是在 $t=72$ 小时为IgG1阳性但IgM阴性的细胞。我们用 $G_{sp}$ 表示这一比例，其中‘sp’代表IgG1‘单阳性’(single-positive)。该群体是所有IgG1阳性细胞中排除了双阳性（IgM阳性且IgG1阳性）细胞后的集合。\n\nIgG1阳性细胞的总比例 $G_{72}$ 是两个不相交群体的和：IgG1单阳性细胞 ($G_{sp}$) 和IgG1与IgM双阳性细胞 ($(M \\cap G)_{72}$)。这可以表示为：\n$$G_{72} = G_{sp} + (M \\cap G)_{72}$$\n我们可以解出 $G_{sp}$，即已完成CSR的细胞比例：\n$$G_{sp} = G_{72} - (M \\cap G)_{72}$$\n代入给定值：\n$$G_{sp} = 0.50 - 0.10 = 0.40$$\n因此，总活B细胞群体中有 $40\\%$ 的细胞已完成向IgG1的CSR。\n\n接下来，我们必须构建CSR频率 $F_{CSR}$ 的分数。定义指出，此频率是相对于*初始*IgM阳性群体的。该初始群体的大小，作为总群体的比例，由 $M_0$ 给出。\n$$M_0 = 0.90$$\n问题陈述指出，IgG1阳性细胞源于初始IgM阳性群体。因此，我们频率计算的分子是已完成CSR的细胞比例 ($G_{sp}$)，分母是初始为IgM阳性的细胞比例 ($M_0$)。\n\n因此，CSR频率计算为以下比率：\n$$F_{CSR} = \\frac{G_{sp}}{M_0}$$\n代入计算出的值和给定值：\n$$F_{CSR} = \\frac{0.40}{0.90} = \\frac{4}{9}$$\n为了以四舍五入到三位有效数字的小数形式提供最终答案，我们进行除法运算：\n$$F_{CSR} \\approx 0.4444...$$\n四舍五入到三位有效数字，我们得到：\n$$F_{CSR} \\approx 0.444$$\n该值代表了在 $72$ 小时标记点，原始表达IgM的B细胞中，已成功转换以产生IgG1并停止产生IgM的细胞所占的比例。", "answer": "$$\\boxed{0.444}$$", "id": "2858720"}, {"introduction": "理解免疫球蛋白类别转换重组 (CSR) 的核心在于掌握其背后的分子机器。本练习挑战您扮演一名分子免疫学家的角色，基于已知的蛋白质功能来预测遗传扰动的后果。\n\n您需要分析 $53\\mathrm{BP}1$ 和 $\\mathrm{BRCA}1$ 这两个在 DNA 双链断裂修复中起着拮抗作用的关键蛋白，并推断它们各自缺失后，对 DNA 末端切除、修复通路选择及最终 CSR 效率的影响 [@problem_id:2858689]。这个思想实验将极大地锻炼您从基因型推导表型的逻辑推理能力。", "problem": "一群小鼠原代B淋巴细胞在体外用抗-CD$40$和白细胞介素-$4$进行刺激，以诱导免疫球蛋白类别转换重组（CSR），从$\\mathrm{S}\\mu$转换到$\\mathrm{S}\\gamma 1$（从而产生免疫球蛋白G$1$）。给定三个其他方面均为同基因型的分组：野生型、$\\mathrm{53BP1^{-/-}}$和$\\mathrm{BRCA1^{-/-}}$。活化诱导性胞苷脱氨酶（AID）将转换区（S区）内的胞嘧啶脱氨基为尿嘧啶，这些尿嘧啶由碱基切除修复和错配修复进行加工，产生交错的双链断裂（DSBs）。在细胞周期的G$1$期，CSR主要通过经典的非同源末端连接（c-NHEJ）进行，当DNA末端被保护免于过度的$5^{\\prime}\\to 3^{\\prime}$末端切除时，该途径更受青睐。当切除范围扩大时，微同源介导的末端连接（MMEJ；也称为替代性末端连接）变得更具竞争力，通常产生具有更高微同源性使用率的连接点，并常常降低有效的CSR。蛋白质p53结合蛋白1（$\\mathrm{53BP1}$）与其下游效应子（例如，RIF$1$–Shieldin轴）一起限制DSBs处的末端切除，从而在CSR期间促进c-NHEJ，而乳腺癌易感蛋白1（$\\mathrm{BRCA1}$）则拮抗$\\mathrm{53BP1}$介导的末端保护，以实现末端切除。\n\n仅使用这些关于AID诱导的DSB形成、细胞周期阶段特异性的途径选择以及$\\mathrm{53BP1}$与$\\mathrm{BRCA1}$对末端切除的拮抗控制的基本事实，预测与野生型相比，$\\mathrm{53BP1^{-/-}}$与$\\mathrm{BRCA1^{-/-}}$ B细胞在$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$转换过程中的以下三个方面的定性结果：(i) 末端切除的程度，(ii) $\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性使用情况，以及 (iii) 总体转换效率（成功完成CSR至免疫球蛋白G$1$的细胞比例）。选择最准确地描述这两种基因型所有三个特征的选项。\n\nA. $\\mathrm{53BP1^{-/-}}$：末端切除增加，$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性增加，总体转换效率降低。$\\mathrm{BRCA1^{-/-}}$：末端切除减少，$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性减少，总体转换效率接近正常至轻度降低。\n\nB. $\\mathrm{53BP1^{-/-}}$：末端切除减少，$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性减少，总体转换效率增加。$\\mathrm{BRCA1^{-/-}}$：末端切除增加，$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性增加，总体转换效率降低。\n\nC. $\\mathrm{53BP1^{-/-}}$ 和 $\\mathrm{BRCA1^{-/-}}$：两者都表现出末端切除增加和$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性增加，总体转换效率同样降低。\n\nD. $\\mathrm{53BP1^{-/-}}$：末端切除增加和$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性增加，总体转换效率增加。$\\mathrm{BRCA1^{-/-}}$：末端切除减少和$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性减少，总体转换效率显著增加。", "solution": "对问题陈述进行验证。\n\n**第一步：提取已知条件**\n-   一群小鼠原代B淋巴细胞在体外用抗-CD$40$和白细胞介素-$4$进行刺激。\n-   该刺激诱导免疫球蛋白类别转换重组（CSR），从$\\mathrm{S}\\mu$转换到$\\mathrm{S}\\gamma 1$，产生免疫球蛋白G$1$（IgG$1$）。\n-   存在三个同基因型分组：野生型（WT）、$\\mathrm{53BP1^{-/-}}$和$\\mathrm{BRCA1^{-/-}}$。\n-   活化诱导性胞苷脱氨酶（AID）将转换区（S区）内的胞嘧啶转化为尿嘧啶。\n-   碱基切除修复和错配修复加工尿嘧啶，产生交错的双链断裂（DSBs）。\n-   在细胞周期的G$1$期，CSR主要使用经典的非同源末端连接（c-NHEJ）。\n-   当DNA末端被保护免于过度的$5^{\\prime}\\to 3^{\\prime}$末端切除时，c-NHEJ更受青睐。\n-   扩大的切除使微同源介导的末端连接（MMEJ）更具竞争力。\n-   MMEJ导致连接点的微同源性增加，并常常降低有效的CSR效率。\n-   p53结合蛋白1（$\\mathrm{53BP1}$）限制DSBs处的末端切除，促进c-NHEJ。\n-   乳腺癌易感蛋白1（$\\mathrm{BRCA1}$）拮抗$\\mathrm{53BP1}$介导的末端保护，以实现末端切除。\n\n**第二步：使用提取的已知条件进行验证**\n该问题在科学上是合理的，基于分子免疫学和DNA修复的既定原理。对AID、CSR、c-NHEJ、MMEJ、$\\mathrm{53BP1}$和$\\mathrm{BRCA1}$作用的描述符合当前的科学认识。该问题提法恰当，提供了一组清晰的前提，并要求对基因敲除模型中可预测的结果进行逻辑推导。语言客观且专业。设定是自洽的，不包含矛盾。实验背景（B细胞的体外刺激）是现实的。\n\n**第三步：结论与行动**\n该问题有效。将根据所提供的前提推导出解决方案。\n\n**解决方案的推导**\n\n问题要求对$\\mathrm{53BP1^{-/-}}$和$\\mathrm{BRCA1^{-/-}}$ B细胞相对于野生型的三个参数——(i)末端切除的程度、(ii)微同源性使用情况和(iii)总体转换效率——进行定性预测。逻辑推导从蛋白质$\\mathrm{53BP1}$和$\\mathrm{BRCA1}$的已知功能出发。\n\n**问题陈述中的基本原理：**\n1.  **末端切除控制：** $\\mathrm{53BP1}$ *限制* 切除，而$\\mathrm{BRCA1}$通过拮抗$\\mathrm{53BP1}$来 *启动*（促进）切除。\n2.  **途径选择：** 有限的切除有利于c-NHEJ（主要的CSR途径）。扩大的切除有利于MMEJ。\n3.  **途径选择的后果：** 与c-NHEJ相比，MMEJ与修复连接点处微同源性的增加和总体CSR效率的降低相关。\n\n**对野生型（WT）基线的分析：**\n在WT细胞中，$\\mathrm{BRCA1}$的促切除活性和$\\mathrm{53BP1}$的抗切除活性之间存在功能性平衡。这种平衡在G$1$期精细调节DSB末端切除的水平，以利于高效的c-NHEJ途径进行CSR，从而为切除、微同源性和转换效率建立了基线。\n\n**对 $\\mathrm{53BP1^{-/-}}$ 基因型的分析：**\n1.  **末端切除：** 问题陈述指出$\\mathrm{53BP1}$ *限制* 末端切除。在缺少这种限制（$\\mathrm{53BP1^{-/-}}$）的情况下，$\\mathrm{BRCA1}$的促切除活性不受拮抗。因此，相对于WT，$5^{\\prime}\\to 3^{\\prime}$末端切除的程度将会**增加**。\n2.  **微同源性使用：** 问题陈述指出，扩大的切除使MMEJ更具竞争力，而MMEJ产生的连接点具有增加的微同源性。由于在$\\mathrm{53BP1^{-/-}}$细胞中末端切除增加，修复将转向MMEJ。因此，$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性使用将会**增加**。\n3.  **总体转换效率：** 问题陈述指出，MMEJ会降低有效的CSR，而$\\mathrm{53BP1}$促进c-NHEJ，后者是CSR的主要途径。在缺少$\\mathrm{53BP1}$的情况下，高效的c-NHEJ途径受损，细胞更多地依赖效率较低的MMEJ途径。这导致总体转换效率**降低**。\n\n**$\\mathrm{53BP1^{-/-}}$总结：** 末端切除增加，微同源性增加，效率降低。\n\n**对 $\\mathrm{BRCA1^{-/-}}$ 基因型的分析：**\n1.  **末端切除：** 问题陈述指出，$\\mathrm{BRCA1}$ *拮抗* $\\mathrm{53BP1}$以 *启动* 末端切除。在缺少这种促切除蛋白（$\\mathrm{BRCA1^{-/-}}$）的情况下，$\\mathrm{53BP1}$的抗切除活性不受拮抗。因此，末端切除将受到更严格的限制，导致相对于WT，末端切除**减少**。\n2.  **微同源性使用：** 问题陈述指出，当末端被保护免于切除时，c-NHEJ更受青睐。随着$\\mathrm{BRCA1^{-/-}}$细胞中切除的减少，c-NHEJ的条件得到增强，而替代的MMEJ途径被抑制。由于MMEJ是微同源性增加的来源，$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性使用将会**减少**。\n3.  **总体转换效率：** 随着末端切除的减少，途径选择强烈偏向c-NHEJ，即CSR的主要途径。然而，WT状态代表了一种优化的平衡。完全丧失“启动”切除的$\\mathrm{BRCA1}$可能会损害整个过程，即使它有利于“正确”的途径选择，例如，通过阻止对DSB末端进行必要的清理。一个脱离其稳态平衡的生物系统很少能表现得更好。因此，“显著增加”的效率是极不可能的。一个更合乎逻辑的结果是效率要么基本不受影响，要么轻微受损。因此，**接近正常至轻度降低**的总体转换效率是最合理的预测。\n\n**$\\mathrm{BRCA1^{-/-}}$总结：** 末端切除减少，微同源性减少，效率接近正常至轻度降低。\n\n**评估选项**\n\n**A. $\\mathrm{53BP1^{-/-}}$：末端切除增加，$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性增加，总体转换效率降低。$\\mathrm{BRCA1^{-/-}}$：末端切除减少，$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性减少，总体转换效率接近正常至轻度降低。**\n该选项与基于问题陈述中提供的原理对两种基因型得出的预测完全匹配。\n**结论：正确。**\n\n**B. $\\mathrm{53BP1^{-/-}}$：末端切除减少，$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性减少，总体转换效率增加。$\\mathrm{BRCA1^{-/-}}$：末端切除增加，$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性增加，总体转换效率降低。**\n该选项错误地陈述了每种基因型的相反表型。例如，它声称$\\mathrm{53BP1^{-/-}}$细胞中的切除减少，这与$\\mathrm{53BP1}$作为切除拮抗剂的既定功能相矛盾。两种基因敲除的表型似乎被互换了。\n**结论：不正确。**\n\n**C. $\\mathrm{53BP1^{-/-}}$ 和 $\\mathrm{BRCA1^{-/-}}$：两者都表现出末端切除增加和$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性增加，总体转换效率同样降低。**\n该选项声称两种基因敲除具有相似的表型。这与$\\mathrm{53BP1}$和$\\mathrm{BRCA1}$具有拮抗功能的前提相矛盾。它们的缺失应该导致相反的，而不是相似的，关于切除及其下游后果的影响。\n**结论：不正确。**\n\n**D. $\\mathrm{53BP1^{-/-}}$：末端切除增加和$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性增加，总体转换效率增加。$\\mathrm{BRCA1^{-/-}}$：末端切除减少和$\\mathrm{S}\\mu$–$\\mathrm{S}\\gamma 1$连接点的微同源性减少，总体转换效率显著增加。**\n该选项错误地预测$\\mathrm{53BP1^{-/-}}$基因型的总体转换效率会增加，这与由此导致的向MMEJ的转变会降低有效CSR的前提相矛盾。它还预测$\\mathrm{BRCA1^{-/-}}$基因型的效率会显著增加，这在生物学上是不太可能的，因为敲除一个精细平衡系统的关键调节因子不太可能提高其效率。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2858689"}, {"introduction": "现代生物学研究越来越依赖于计算模型来形式化和检验我们的假设。这项前沿实践将指导您使用编程模拟来验证一个关于 CSR 修复机制的关键预测。\n\n您将把关于 Ku 蛋白在 DNA 末端保护中作用的生物学原理，转化为一个离散的概率模型，并通过模拟来量化 Ku 蛋白缺失对 DNA 连接处缺失长度和微同源性使用的影响 [@problem_id:2858641]。这不仅能加深您对 CSR 机制的理解，还能让您亲身体验计算生物学是如何将假说变为可检验的预测的。", "problem": "您的任务是形式化并检验一个关于免疫球蛋白类别转换重组的机理预测，方法是使用一个可复现的模拟，将生物学假说映射到一个离散概率模型。其生物学基础是，免疫球蛋白类别转换重组在转换区产生双链断裂，在野生型条件下，这些断裂主要由经典非同源末端连接（c-NHEJ）修复。Ku 异二聚体与 DNA 末端结合，保护它们免受过度切除。在 Ku 缺陷的情况下，修复转向替代性末端连接（也称为微同源介导的末端连接），该机制依赖于短同源序列的退火，并倾向于产生更长的缺失和增加连接点处的微同源性。从这些原理和基本概率定义出发，您将实现一个模拟来验证“Ku 缺陷会增加缺失大小和微同源性使用”这一预测。\n\n待使用的建模假设：\n- 在条件 $C \\in \\{\\text{WT},\\ \\text{Ku-def}\\}$ 下，设缺失大小（以碱基对为单位）为一个非负整数随机变量 $D_C$，微同源长度为一个非负整数随机变量 $M_C$。\n- 对于每个连接点，通过 $D_C = G\\!\\left(p^{(D)}_C\\right) - 1$ 和 $M_C = G\\!\\left(p^{(M)}_C\\right) - 1$ 对 $D_C$ 和 $M_C$ 进行抽样，其中 $G(p)$ 是定义在 $\\{1,2,3,\\dots\\}$ 上的几何随机变量，其参数为 $p \\in (0,1]$，使得 $\\mathbb{P}[G(p)=k] = (1-p)^{k-1}p$，且 $\\mathbb{E}[G(p)-1] = \\dfrac{1-p}{p}$。这一选择反映了在停止事件发生前，对切除或退火延伸步骤的无记忆性计数，降低 $p$ 会增加平均长度。\n- 对于每个测试用例，在每种条件下使用相同的伪随机数生成器种子精确模拟 $N$ 个连接点，以确保可复现性。\n\n每个测试用例需计算的验证指标：\n- 设 $\\overline{D}_{\\text{WT}}$ 和 $\\overline{D}_{\\text{Ku}}$ 分别为 $D_{\\text{WT}}$ 和 $D_{\\text{Ku}}$ 的样本均值；定义布尔值 $B_D = \\left[\\overline{D}_{\\text{Ku}} > \\overline{D}_{\\text{WT}}\\right]$。\n- 设 $\\overline{M}_{\\text{WT}}$ 和 $\\overline{M}_{\\text{Ku}}$ 分别为 $M_{\\text{WT}}$ 和 $M_{\\text{Ku}}$ 的样本均值；定义布尔值 $B_M = \\left[\\overline{M}_{\\text{Ku}} > \\overline{M}_{\\text{WT}}\\right]$。\n- 对每个特征执行单侧 Mann–Whitney $U$ 检验，备择假设为 Ku 缺陷型分布随机大于野生型分布。将 $p$ 值记为 $p_D$ 和 $p_M$。使用显著性阈值 $\\alpha = 0.01$ 并定义布尔值 $S_D = \\left[p_D < \\alpha\\right]$ 和 $S_M = \\left[p_M < \\alpha\\right]$。\n- 报告四舍五入到 $6$ 位小数的 $p_D$ 和 $p_M$。\n\n实现约束：\n- 为每个测试用例使用一个带有指定整数种子 $\\sigma$ 的伪随机数生成器，以使模拟具有确定性和可复现性。\n- 如下文所述，每个测试用例的每种条件下，精确使用 $N$ 个模拟的连接点。\n\n测试套件：\n对于以下每个测试用例，使用给定的参数为野生型（WT）和 Ku 缺陷型（Ku-def）条件模拟 $N$ 个连接点。所有参数均为 $(0,1]$ 内的无单位概率，计数为无单位整数。\n- 测试用例 A（理想路径）：$N=500$，$\\sigma=137$，$p^{(D)}_{\\text{WT}}=0.60$，$p^{(D)}_{\\text{Ku}}=0.20$，$p^{(M)}_{\\text{WT}}=0.85$，$p^{(M)}_{\\text{Ku}}=0.30$。\n- 测试用例 B（中等效应）：$N=500$，$\\sigma=271828$，$p^{(D)}_{\\text{WT}}=0.50$，$p^{(D)}_{\\text{Ku}}=0.35$，$p^{(M)}_{\\text{WT}}=0.65$，$p^{(M)}_{\\text{Ku}}=0.45$。\n- 测试用例 C（近零边界）：$N=500$，$\\sigma=314159$，$p^{(D)}_{\\text{WT}}=0.50$，$p^{(D)}_{\\text{Ku}}=0.48$，$p^{(M)}_{\\text{WT}}=0.55$，$p^{(M)}_{\\text{Ku}}=0.53$。\n- 测试用例 D（极端偏移）：$N=500$，$\\sigma=42$，$p^{(D)}_{\\text{WT}}=0.70$，$p^{(D)}_{\\text{Ku}}=0.15$，$p^{(M)}_{\\text{WT}}=0.90$，$p^{(M)}_{\\text{Ku}}=0.25$。\n\n要求的最终输出格式：\n- 您的程序应产生单行输出，包含一个由方括号括起来的逗号分隔列表形式的结果。\n- 每个测试用例的结果本身必须是一个列表，顺序为 $[B_D,\\ B_M,\\ p_D,\\ p_M,\\ S_D,\\ S_M]$，其中 $p_D$ 和 $p_M$ 是四舍五入到恰好 $6$ 位小数的浮点数。\n- 因此，对于完整的测试套件，输出必须是一个包含 $4$ 个列表的列表，每个测试用例一个，例如：`[[\\dots],[\\dots],[\\dots],[\\dots]]`，打印在单行上。\n\n计算说明：\n- 此问题不涉及角度和物理单位。", "solution": "该问题要求通过概率模拟来验证一项生物学假说。该假说提出，在 Ku 缺陷细胞中，免疫球蛋白类别转换重组过程中的 DNA 双链断裂修复会转向一种导致更大范围缺失和更多微同源性使用的机制，与野生型细胞相比。这将通过一个离散概率模型进行形式化和检验。\n\n**问题验证**\n\n首先，我评估问题陈述的有效性。\n\n1.  **已知条件提取**：\n    *   **模型**：对于条件 $C \\in \\{\\text{WT}, \\text{Ku-def}\\}$，缺失大小 $D_C$ 和微同源长度 $M_C$ 是随机变量。\n    *   **分布**：$D_C$ 和 $M_C$ 被建模为移位的几何随机变量：$D_C = G(p^{(D)}_C) - 1$ 和 $M_C = G(p^{(M)}_C) - 1$。随机变量 $G(p)$ 服从定义在 $\\{1, 2, 3, \\dots\\}$ 上的几何分布，其概率质量函数为 $\\mathbb{P}[G(p)=k] = (1-p)^{k-1}p$。其期望值给出为 $\\mathbb{E}[G(p)-1] = (1-p)/p$。\n    *   **模拟参数**：每个测试用例都指定了要模拟的连接点数量 $N$、一个伪随机数生成器种子 $\\sigma$ 以及成功概率 $p^{(D)}_{\\text{WT}}$、$p^{(D)}_{\\text{Ku}}$、$p^{(M)}_{\\text{WT}}$、$p^{(M)}_{\\text{Ku}}$。\n    *   **指标**：对于每个测试用例，我们必须计算：\n        *   $B_D = [\\overline{D}_{\\text{Ku}} > \\overline{D}_{\\text{WT}}]$ 和 $B_M = [\\overline{M}_{\\text{Ku}} > \\overline{M}_{\\text{WT}}]$，其中 $\\overline{D}$ 和 $\\overline{M}$ 是样本均值。\n        *   $p_D$ 和 $p_M$，来自单侧 Mann-Whitney U 检验的 $p$ 值。\n        *   $S_D = [p_D < 0.01]$ 和 $S_M = [p_M < 0.01]$。\n    *   **测试套件**：提供了四个测试用例（A, B, C, D），附有具体的参数值。\n    *   **输出格式**：单行打印一个包含四个列表的列表，其中每个内部列表的格式为 $[B_D, B_M, p_D, p_M, S_D, S_M]$，其中 $p$ 值为四舍五入到 6 位小数的浮点数。\n\n2.  **有效性检查**：\n    *   **科学依据**：该问题在免疫学和分子生物学方面有坚实的基础。Ku 在非同源末端连接中的作用及其缺陷的后果是已确立的科学概念。使用概率模型来模拟这些效应是计算生物学中一种标准且有效的方法。\n    *   **良构性**：问题被完全指定。模拟所需的所有参数（$N, \\sigma, p$ 值）都已提供。统计指标定义明确。使用种子确保了可复现性，从而得到唯一的解。移位几何分布的均值公式 $\\mathbb{E}[G(p)-1] = (1-p)/p$ 是正确的，因为 $\\mathbb{E}[G(p)] = 1/p$。\n    *   **客观性**：语言精确、量化，没有主观偏见。\n\n3.  **结论**：问题陈述是**有效的**。它在科学上合理，数学上良构，客观且完整。我将继续进行解答。\n\n**基于原理的解决方案设计**\n\n解决方案将遵循从问题原理中推导出的逻辑步骤序列来实现。\n\n**1. 模型实现**\n问题的核心是模拟随机变量 $D_C$ 和 $M_C$。模型指定它们服从移位几何分布。定义在 $\\{1, 2, 3, \\ldots\\}$ 上的几何随机变量 $G(p)$ 计算了直到第一次成功所需的伯努利试验次数。因此， resultante 的随机变量 $G(p)-1$ 计算了第一次成功之前的失败次数。这是一个无记忆过程，对于像 DNA 末端切除或微同源性退火这样的生物过程来说，这是一个合理的一阶近似，在这些过程中，过程持续进行，直到在每一步以概率 $p$ 发生一个随机的“停止”事件。\n\nKu 缺陷增加缺失和微同源长度的生物学假说，通过设置停止概率使得 $p_{\\text{Ku}} < p_{\\text{WT}}$ 来编码。这意味着在终止前预期的步数更多，因为 $\\mathbb{E}[G(p)-1] = (1-p)/p$ 是 $p \\in (0, 1]$ 的单调递减函数。\n\n对于每个测试用例，我们将执行以下模拟步骤：\n*   使用指定的种子 $\\sigma$ 初始化一个伪随机数生成器以确保可复现性。\n*   使用各自的概率参数（$p^{(D)}_{\\text{WT}}, p^{(D)}_{\\text{Ku}}, p^{(M)}_{\\text{WT}}, p^{(M)}_{\\text{Ku}}$）为四个随机变量（$D_{\\text{WT}}, D_{\\text{Ku}}, M_{\\text{WT}}, M_{\\text{Ku}}$）中的每一个生成 $N$ 个样本。这通过从几何分布中抽样并从每个变量中减去 1 来实现。`numpy.random.Generator.geometric` 函数适合此任务。\n\n**2. 统计验证**\n一旦生成了模拟数据集，我们必须计算指定的验证指标，以在模拟数据上检验假说。\n*   **样本均值**：将计算样本均值（$\\overline{D}_{\\text{WT}}, \\overline{D}_{\\text{Ku}}, \\overline{M}_{\\text{WT}}, \\overline{M}_{\\text{Ku}}$）。然后通过将 Ku 缺陷样本的均值与野生型样本的均值进行比较来确定布尔值 $B_D$ 和 $B_M$。这些布尔值直接检验了模拟是否在样本平均值上产生了预期的趋势。\n*   **假设检验**：需要使用 Mann-Whitney U 检验进行更严格的统计比较。这是一种非参数检验，适用于比较两个独立样本，并且不假设数据遵循特定分布（例如正态分布），这在这里是合适的。该检验评估一个分布是否随机性地大于另一个。问题指定了一个单侧备择假设：Ku 缺陷分布随机性地大于野生型分布。这对应于 `scipy.stats.mannwhitneyu` 中的 `alternative='greater'` 选项。\n*   从这些检验中获得的 $p$ 值，$p_D$ 和 $p_M$，量化了反对零假设（即分布相同）的证据。我们将这些 $p$ 值与给定的显著性水平 $\\alpha = 0.01$ 进行比较，以确定布尔值 $S_D$ 和 $S_M$，指示观察到的增加是否具有统计显著性。\n\n**3. 算法结构**\n一个主函数将遍历提供的四个测试用例。对于每个用例，一个辅助函数将执行模拟和分析逻辑：\n*   接收参数 $N, \\sigma$ 和四个 $p$ 值。\n*   生成四个大小为 $N$ 的数据集。\n*   计算样本均值和布尔值 $B_D, B_M$。\n*   执行两个 Mann-Whitney U 检验以获得 $p_D, p_M$。\n*   计算显著性布尔值 $S_D, S_M$。\n*   以指定的列表格式 $[B_D, B_M, \\text{round}(p_D, 6), \\text{round}(p_M, 6), S_D, S_M]$ 返回结果。\n\n所有测试用例的结果将被收集到一个列表的列表中。这个最终的数据结构将被转换为一个紧凑的字符串表示，并作为单行打印到标准输出，严格遵守指定的格式。到字符串的转换将仔细进行，以匹配所需的视觉格式 `[[...],[...]]`，不含多余字符。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the final result.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case A (happy path)\n        {'N': 500, 'sigma': 137,    'p_d_wt': 0.60, 'p_d_ku': 0.20, 'p_m_wt': 0.85, 'p_m_ku': 0.30},\n        # Test case B (moderate effect)\n        {'N': 500, 'sigma': 271828, 'p_d_wt': 0.50, 'p_d_ku': 0.35, 'p_m_wt': 0.65, 'p_m_ku': 0.45},\n        # Test case C (near-null boundary)\n        {'N': 500, 'sigma': 314159, 'p_d_wt': 0.50, 'p_d_ku': 0.48, 'p_m_wt': 0.55, 'p_m_ku': 0.53},\n        # Test case D (extreme shift)\n        {'N': 500, 'sigma': 42,     'p_d_wt': 0.70, 'p_d_ku': 0.15, 'p_m_wt': 0.90, 'p_m_ku': 0.25},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = simulate_and_analyze(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The str() of a list of lists creates the desired [[...], [...]] structure.\n    # .replace(\" \", \"\") makes the output compact as is common for machine-readable formats.\n    output_string = str(results).replace(\" \", \"\")\n    print(output_string)\n\ndef simulate_and_analyze(params):\n    \"\"\"\n    Performs the simulation and statistical analysis for a single test case.\n\n    Args:\n        params (dict): A dictionary containing all parameters for the case.\n\n    Returns:\n        list: A list of results in the format [B_D, B_M, p_D, p_M, S_D, S_M].\n    \"\"\"\n    N = params['N']\n    sigma = params['sigma']\n    p_d_wt = params['p_d_wt']\n    p_d_ku = params['p_d_ku']\n    p_m_wt = params['p_m_wt']\n    p_m_ku = params['p_m_ku']\n    alpha = 0.01\n\n    # Initialize the pseudorandom number generator with the specified seed for reproducibility.\n    rng = np.random.default_rng(seed=sigma)\n\n    # Generate samples from the shifted geometric distribution G(p)-1.\n    # The numpy.random.Generator.geometric function samples from G(p) on {1, 2, ...}.\n    d_wt = rng.geometric(p=p_d_wt, size=N) - 1\n    d_ku = rng.geometric(p=p_d_ku, size=N) - 1\n    m_wt = rng.geometric(p=p_m_wt, size=N) - 1\n    m_ku = rng.geometric(p=p_m_ku, size=N) - 1\n\n    # Calculate sample means for deletion size and microhomology length.\n    mean_d_wt = np.mean(d_wt)\n    mean_d_ku = np.mean(d_ku)\n    mean_m_wt = np.mean(m_wt)\n    mean_m_ku = np.mean(m_ku)\n\n    # Determine B_D and B_M, the booleans for whether Ku-def mean is greater than WT mean.\n    B_D = bool(mean_d_ku > mean_d_wt)\n    B_M = bool(mean_m_ku > mean_m_wt)\n\n    # Perform one-sided Mann–Whitney U tests.\n    # Alternative hypothesis: the distribution of the first sample (Ku-def) is\n    # stochastically greater than the distribution of the second sample (WT).\n    res_d = stats.mannwhitneyu(d_ku, d_wt, alternative='greater')\n    p_D = res_d.pvalue\n\n    res_m = stats.mannwhitneyu(m_ku, m_wt, alternative='greater')\n    p_M = res_m.pvalue\n\n    # Determine S_D and S_M, the booleans for statistical significance.\n    S_D = bool(p_D  alpha)\n    S_M = bool(p_M  alpha)\n    \n    # Round p-values to 6 decimal places as specified.\n    p_D_rounded = round(p_D, 6)\n    p_M_rounded = round(p_M, 6)\n\n    return [B_D, B_M, p_D_rounded, p_M_rounded, S_D, S_M]\n\nsolve()\n```", "id": "2858641"}]}