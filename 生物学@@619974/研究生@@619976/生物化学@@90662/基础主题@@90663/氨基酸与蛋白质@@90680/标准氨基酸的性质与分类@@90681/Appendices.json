{"hands_on_practices": [{"introduction": "我们对氨基酸性质的定量探索始于最基本的构件：单个可电离基团。本练习旨在通过从第一性原理出发，为甘氨酸的 $\\alpha$-氨基推导其质子化分数的表达式，从而巩固您对酸碱平衡核心概念的理解。掌握如何应用亨德森-哈塞尔巴尔赫方程来量化特定 $pH$ 值下功能基团的电离状态，是分析更复杂的肽和蛋白质电荷性质的一项基本技能 [@problem_id:2590636]。", "problem": "考虑甘氨酸，其 $\\alpha$-氨基可以以质子化形式 $\\mathrm{NH_3^+}$ 和去质子化（中性）碱基形式 $\\mathrm{NH_2}$ 存在。假设溶液为理想稀水溶液，其中活度系数为1，并且所提供的酸度常数反映了在工作 $\\mathrm{pH}$ 下的相关微观状态。$\\alpha$-氨基的酸解离过程可以写为 $\\mathrm{NH_3^+} \\rightleftharpoons \\mathrm{NH_2} + \\mathrm{H^+}$。仅从酸解离常数的热力学定义和氢离子浓度指数（$\\mathrm{pH}$）的定义出发，推导一个关于 $\\alpha$-氨基位点去质子化分数作为 $\\mathrm{pH}$ 和酸解离常数的负常用对数（$\\mathrm{p}K_a$）函数的表达式。然后，在给定甘氨酸 $\\mathrm{p}K_a(\\mathrm{NH_3^+})=9.6$ 的条件下，计算在 $\\mathrm{pH}=8$ 时该分数的值。将您计算出的去质子化分数的最终答案四舍五入至四位有效数字，并以无单位的纯数形式报告。", "solution": "该问题是有效的，因为它有科学依据，提法恰当，并包含获得唯一解所需的所有信息。它要求从第一性原理出发推导酸碱化学中的一个标准关系式，并进行后续的数值计算。\n\n甘氨酸 $\\alpha$-氨基的酸解离平衡如下所示：\n$$\n\\mathrm{NH_3^+} \\rightleftharpoons \\mathrm{NH_2} + \\mathrm{H^+}\n$$\n质子化形式是共轭酸，表示为 $[\\mathrm{NH_3^+}]$，去质子化形式是共轭碱，表示为 $[\\mathrm{NH_2}]$。\n\n问题要求从酸解离常数 $K_a$ 的热力学定义出发。对于给定的平衡，在理想溶液中活度等于摩尔浓度的假设下，$K_a$ 定义为：\n$$\nK_a = \\frac{[\\mathrm{NH_2}][\\mathrm{H^+}]}{[\\mathrm{NH_3^+}]}\n$$\n去质子化的 $\\alpha$-氨基位点的分数，我们将其表示为 $f_{\\mathrm{NH_2}}$，是去质子化物种的浓度与氨基所有物种总浓度的比率：\n$$\nf_{\\mathrm{NH_2}} = \\frac{[\\mathrm{NH_2}]}{[\\mathrm{NH_3^+}] + [\\mathrm{NH_2}]}\n$$\n为了将 $f_{\\mathrm{NH_2}}$ 表示为与 $\\mathrm{pH}$ 和 $\\mathrm{p}K_a$ 相关的量的函数，我们必须消去浓度项 $[\\mathrm{NH_2}]$ 和 $[\\mathrm{NH_3^+}]$。根据 $K_a$ 的定义，我们可以用去质子化形式 $[\\mathrm{NH_2}]$ 来表示质子化形式 $[\\mathrm{NH_3^+}]$ 的浓度：\n$$\n[\\mathrm{NH_3^+}] = \\frac{[\\mathrm{NH_2}][\\mathrm{H^+}]}{K_a}\n$$\n现在，将 $[\\mathrm{NH_3^+}]$ 的这个表达式代入 $f_{\\mathrm{NH_2}}$ 方程的分母中：\n$$\nf_{\\mathrm{NH_2}} = \\frac{[\\mathrm{NH_2}]}{\\left(\\frac{[\\mathrm{NH_2}][\\mathrm{H^+}]}{K_a}\\right) + [\\mathrm{NH_2}]}\n$$\n项 $[\\mathrm{NH_2}]$ 是分母中的一个公因子，可以被提取出来：\n$$\nf_{\\mathrm{NH_2}} = \\frac{[\\mathrm{NH_2}]}{[\\mathrm{NH_2}]\\left(\\frac{[\\mathrm{H^+}]}{K_a} + 1\\right)}\n$$\n假设氨基的总浓度不为零，那么除非 $\\mathrm{pH}$ 是无限酸性的，$[\\mathrm{NH_2}]$ 不能为零，所以我们可以从分子和分母中消去 $[\\mathrm{NH_2}]$ 项：\n$$\nf_{\\mathrm{NH_2}} = \\frac{1}{\\frac{[\\mathrm{H^+}]}{K_a} + 1}\n$$\n为了简化这个繁分数，我们将分子和分母同乘以 $K_a$：\n$$\nf_{\\mathrm{NH_2}} = \\frac{K_a}{[\\mathrm{H^+}] + K_a}\n$$\n问题要求最终表达式用 $\\mathrm{pH}$ 和 $\\mathrm{p}K_a$ 来表示。我们使用它们的定义：\n$$\n\\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}]) \\implies [\\mathrm{H^+}] = 10^{-\\mathrm{pH}}\n$$\n$$\n\\mathrm{p}K_a = -\\log_{10}(K_a) \\implies K_a = 10^{-\\mathrm{p}K_a}\n$$\n将这些代入 $f_{\\mathrm{NH_2}}$ 的表达式中：\n$$\nf_{\\mathrm{NH_2}} = \\frac{10^{-\\mathrm{p}K_a}}{10^{-\\mathrm{pH}} + 10^{-\\mathrm{p}K_a}}\n$$\n这个表达式是正确的，但可以写成一种更标准的形式。将分子和分母同乘以 $10^{\\mathrm{p}K_a}$：\n$$\nf_{\\mathrm{NH_2}} = \\frac{10^{-\\mathrm{p}K_a} \\cdot 10^{\\mathrm{p}K_a}}{ (10^{-\\mathrm{pH}} + 10^{-\\mathrm{p}K_a}) \\cdot 10^{\\mathrm{p}K_a} } = \\frac{1}{10^{\\mathrm{p}K_a - \\mathrm{pH}} + 1}\n$$\n这就是最终推导出的关于去质子化位点分数作为 $\\mathrm{pH}$ 和 $\\mathrm{p}K_a$ 函数的表达式。\n\n现在，我们必须在给定甘氨酸 $\\mathrm{p}K_a(\\mathrm{NH_3^+})=9.6$ 的条件下，计算在 $\\mathrm{pH}=8$ 时该分数的值。\n代入给定值：\n$$\n\\mathrm{pH} = 8\n$$\n$$\n\\mathrm{p}K_a = 9.6\n$$\n分母中的指数是：\n$$\n\\mathrm{p}K_a - \\mathrm{pH} = 9.6 - 8 = 1.6\n$$\n所以该分数为：\n$$\nf_{\\mathrm{NH_2}} = \\frac{1}{10^{1.6} + 1}\n$$\n我们计算其数值：\n$$\n10^{1.6} \\approx 39.810717\n$$\n$$\nf_{\\mathrm{NH_2}} = \\frac{1}{39.810717 + 1} = \\frac{1}{40.810717} \\approx 0.02450338\n$$\n将结果四舍五入到四位有效数字得到 $0.02450$。结尾的零是有效数字。", "answer": "$$\n\\boxed{0.02450}\n$$", "id": "2590636"}, {"introduction": "在前一个练习的基础上，我们现在将分析扩展到含有多个可电离基团的分子。本练习以组氨酸为例，这是一个经典的生物化学问题，因为其侧链的 $pK_a$ 值接近中性，使得等电点（$pI$）的计算变得不那么直观。通过这个实践，您将学会如何识别决定分子净电荷为零的关键电离平衡，并精确计算碱性氨基酸的等电点，这对于理解蛋白质在不同 $pH$ 环境下的行为至关重要 [@problem_id:2590656]。", "problem": "氨基酸两性电解质表现出多种电离状态，这由其酸解离常数决定。等电点 ($pI$) 定义为分子净电荷为零时的氢离子浓度标度 $pH$ 值。考虑组氨酸，它有三个可滴定基团：$\\alpha$-羧基、咪唑侧链和 $\\alpha$-氨基。相关的酸解离常数（以 $pK_a$ 值表示）分别为：$\\alpha$-羧基为 $1.80$，咪唑鎓侧链为 $6.04$，$\\alpha$-$\\mathrm{NH_3^+}$ 基团为 $9.33$。仅使用酸解离常数 $pK_a$ 和等电点 $pI$ 的定义、质量作用定律以及标准酸碱平衡，确定哪两个 $pK_a$ 值在 $pH$ 标度上跨越组氨酸的电中性微观状态，并计算组氨酸的等电点 $pI$。将最终的 $pI$ 报告为单个数字，精确到四位有效数字。不要包含单位。", "solution": "该问题陈述具有科学依据、提法明确且客观。所有必要的数据，特别是组氨酸三个可滴定基团的酸解离常数（$pK_a$），均已提供。该问题是生物化学和物理化学中的一个标准练习题，可通过应用酸碱平衡的基本原理解答。因此，该问题被认定为有效。\n\n氨基酸组氨酸拥有三个可电离基团：$\\alpha$-羧基（$pK_{a1} = 1.80$）、咪唑侧链（$pK_{a2} = 6.04$）和 $\\alpha$-氨基（$pK_{a3} = 9.33$）。我们将组氨酸的各种质子化形式表示为 $H_3A^{2+}$、$H_2A^{+}$、$HA^{0}$ 和 $A^{-}$。随着溶液 $pH$ 值的升高，其电离状态会依次改变。\n\n在非常低的 $pH$ 值下，所有三个基团都被质子化。分子以 $H_3A^{2+}$ 形式存在，净电荷为 $+2$（来自质子化的氨基，$+1$，和质子化的咪唑环，$+1$）。\n\n第一次去质子化发生在酸性最强的基团，即 $\\alpha$-羧基上，并由 $pK_{a1}$ 控制：\n$$H_3A^{2+} \\rightleftharpoons H_2A^{+} + H^+ \\quad (pK_{a1} = 1.80)$$\n生成的物质 $H_2A^{+}$ 净电荷为 $+1$（来自质子化的氨基，$+1$；质子化的咪唑环，$+1$；以及去质子化的羧酸根基团，$-1$）。\n\n第二次去质子化发生在咪唑侧链上，由 $pK_{a2}$ 控制：\n$$H_2A^{+} \\rightleftharpoons HA^{0} + H^+ \\quad (pK_{a2} = 6.04)$$\n生成的物质 $HA^0$ 净电荷为 $0$。这就是两性离子或电中性微观状态。其官能团的电荷为：质子化的氨基（$+1$）、中性的咪唑环（$0$）和去质子化的羧酸根基团（$-1$）。\n\n第三次去质子化发生在酸性最弱的基团，即 $\\alpha$-氨基上，并由 $pK_{a3}$ 控制：\n$$HA^{0} \\rightleftharpoons A^{-} + H^+ \\quad (pK_{a3} = 9.33)$$\n生成的物质 $A^{-}$ 净电荷为 $-1$（来自去质子化的羧酸根基团）。\n\n等电点（$pI$）是分子群体的平均净电荷为零时的 $pH$ 值。电中性物质 $HA^0$ 是由 $H_2A^{+}$ 形成并解离为 $A^{-}$ 的。因此，“跨越”中性物质的两个平衡是由 $K_{a2}$ 和 $K_{a3}$ 描述的平衡。相应的 $pK_a$ 值为 $pK_{a2} = 6.04$ 和 $pK_{a3} = 9.33$。\n\n在 $pI$ 时，正电荷的总浓度必须等于负电荷的总浓度。在该体系中，这个条件形式上写为：\n$$2[H_3A^{2+}] + [H_2A^{+}] = [A^{-}]$$\n然而，由于 $pI$ 将远高于 $pK_{a1}$（$1.80$），双正电荷物质 $[H_3A^{2+}]$ 的浓度与单正电荷物质 $[H_2A^{+}]$ 的浓度相比可以忽略不计。因此，等电点的条件可以很好地近似简化为：\n$$[H_2A^{+}] \\approx [A^{-}]$$\n这个近似表明，在 $pI$ 时，紧邻两性离子的带电物质的浓度相等。\n\n我们现在对两个相关平衡使用质量作用定律，通过它们的酸解离常数 $K_{a2}$ 和 $K_{a3}$ 来表示：\n$$K_{a2} = \\frac{[HA^0][H^+]}{[H_2A^{+}]} \\implies [H_2A^{+}] = \\frac{[HA^0][H^+]}{K_{a2}}$$\n$$K_{a3} = \\frac{[A^{-}][H^+]}{[HA^0]} \\implies [A^{-}] = \\frac{K_{a3}[HA^0]}{[H^+]}$$\n我们将这些表达式代入我们简化的电荷平衡方程 $[H_2A^{+}] = [A^{-}]$ 中：\n$$\\frac{[HA^0][H^+]}{K_{a2}} = \\frac{K_{a3}[HA^0]}{[H^+]}$$\n在 $pI$ 时，中性物质的浓度 $[HA^0]$ 非零，可以从等式两边消去：\n$$\\frac{[H^+]}{K_{a2}} = \\frac{K_{a3}}{[H^+]}$$\n设 $[H^+]_{pI}$ 为等电点时的氢离子浓度。重排方程以求解 $[H^+]_{pI}$：\n$$[H^+]_{pI}^2 = K_{a2} K_{a3}$$\n$$[H^+]_{pI} = \\sqrt{K_{a2} K_{a3}}$$\n为了求出 $pI$，我们对等式两边取以 10 为底的负对数。根据定义，$pI = -\\log_{10}([H^+]_{pI})$ 且 $pK_a = -\\log_{10}(K_a)$：\n$$pI = -\\log_{10}(\\sqrt{K_{a2} K_{a3}}) = -\\frac{1}{2} \\log_{10}(K_{a2} K_{a3})$$\n$$pI = -\\frac{1}{2} (\\log_{10}(K_{a2}) + \\log_{10}(K_{a3}))$$\n$$pI = \\frac{1}{2} (pK_{a2} + pK_{a3})$$\n这个结果表明，对于一个带有可电离侧链的碱性氨基酸，其等电点是包夹中性两性离子形式的两个 $pK_a$ 值的算术平均值。\n\n现在我们将给定的数值 $pK_{a2} = 6.04$ 和 $pK_{a3} = 9.33$ 代入推导出的公式中：\n$$pI = \\frac{1}{2} (6.04 + 9.33)$$\n$$pI = \\frac{1}{2} (15.37)$$\n$$pI = 7.685$$\n问题要求最终答案保留四位有效数字。计算出的值 $7.685$ 已经包含四位有效数字。", "answer": "$$\\boxed{7.685}$$", "id": "2590656"}, {"introduction": "最后的这项动手实践将我们的分析提升到一个新的层次，要求您将手动计算 $pI$ 的过程推广为一个通用的计算算法。对于真实的、含有许多可电离位点的肽和蛋白质，逐一手动计算是不切实际的，因此开发自动化工具显得尤为重要。本练习的任务是设计一个稳健的程序，能够根据任意肽序列及其组分的标准 $pK_a$ 值来预测其等电点，从而将基础化学原理与实用的生物信息学工具联系起来 [@problem_id:2590652]。", "problem": "构建一个通用的、有原则的算法，该算法仅根据肽的氨基酸组成，在以下假设条件下计算其等电点。每个可电离位点的行为都像一个独立的单质子酸或碱，并且在无限稀释和标准温度下的水溶液中遵循酸碱平衡。使用 Henderson-Hasselbalch 关系作为基本事实。你的推导必须从酸解离常数、等电点和 Henderson-Hasselbalch 方程的定义开始，并得出一个从肽序列到作为 pH 函数的净电荷的可计算映射，然后到定义为该函数根的等电点。然后，你必须将推导出的算法实现为一个程序，通过在 pH 区间 $[0,14]$ 中寻找净电荷函数的唯一根来数值计算等电点。\n\n使用的基本事实：\n- 对于单质子酸 $\\mathrm{HA}$，酸解离常数定义为 $K_a = \\dfrac{[\\mathrm{A^-}][\\mathrm{H^+}]}{[\\mathrm{HA}]}$。\n- Henderson-Hasselbalch 方程为 $ \\mathrm{pH} = \\mathrm{p}K_a + \\log_{10}\\!\\left(\\dfrac{[\\mathrm{A^-}]}{[\\mathrm{HA}]}\\right)$，其中 $\\mathrm{p}K_a = -\\log_{10} K_a$。\n- 等电点是分子预期净电荷等于 $0$ 时的 $pH^*$ 值。\n\n肽的建模假设：\n- 考虑一个由标准氨基酸组成、带有自由末端基团的肽。可电离位点是 N-末端（α-氨基，碱性）、C-末端（α-羧基，酸性）以及以下侧链：天冬氨酸（酸性）、谷氨酸（酸性）、组氨酸（碱性）、赖氨酸（碱性）、精氨酸（碱性）、半胱氨酸（酸性硫醇）和酪氨酸（酸性酚）。\n- 将每个位点视为一个独立的单质子基团，它要么处于质子化形式，要么处于去质子化形式，其分数布居由 $\\mathrm{pH}$ 和其 $\\mathrm{p}K_a$ 决定。\n- 忽略 $\\mathrm{p}K_a$ 的环境和序列上下文位移；对所有序列使用以下标准值：N-末端 $p K_a = 9.69$，C-末端 $p K_a = 2.34$，天冬氨酸侧链 $p K_a = 3.65$，谷氨酸侧链 $p K_a = 4.25$，组氨酸侧链 $p K_a = 6.00$，半胱氨酸侧链 $p K_a = 8.18$，酪氨酸侧链 $p K_a = 10.07$，赖氨酸侧链 $p K_a = 10.53$，精氨酸侧链 $p K_a = 12.48$。\n- 使用以下约定：碱性位点在质子化时带 $+1$ 电荷，去质子化时带 $0$ 电荷；酸性位点在质子化时带 $0$ 电荷，去质子化时带 $-1$ 电荷。\n\n推导和算法要求：\n- 从基本事实出发，不使用任何领域特定的快捷公式，推导单个酸性位点和单个碱性位点作为 $\\mathrm{pH}$ 和 $\\mathrm{p}K_a$ 函数的预期电荷贡献的显式表达式。然后，将任意肽的净电荷函数 $Z(\\mathrm{pH})$ 推导为所有可电离位点的总和。\n- 从第一性原理论证，在所述模型下，为什么 $Z(\\mathrm{pH})$ 是 $\\mathrm{pH}$ 的严格递减函数，以及为什么对于任何带有自由末端的肽，在 $[0,14]$ 区间内存在唯一的根。\n- 设计一个稳健的数值算法，仅使用 $Z(\\mathrm{pH})$ 的函数求值和标准算术运算来界定和分离 $Z(\\mathrm{pH})=0$ 的根 $pH^*$。该算法必须：\n  - 在闭区间 $[0,14]$ 内搜索；\n  - 使用一种对单调函数保证收敛的区间求根方法，例如二分法；\n  - 当 pH 区间宽度小于 $10^{-6}$ 或当前迭代的 $\\lvert Z(\\mathrm{pH}) \\rvert \\le 10^{-12}$ 时终止。\n\n输入模型和实现约束：\n- 肽序列以连字符分隔的三字母代码形式在程序内部提供（例如，“Ala-His-Asp”），你必须将它们视为具有一个 N-末端和一个 C-末端的未修饰肽。\n- 你的实现必须能正确处理任何可电离侧链的混合物以及长度至少为 $1$ 的任何肽。\n- 仅使用上面列出的标准 $\\mathrm{p}K_a$ 值和 Henderson-Hasselbalch 模型来计算 $Z(\\mathrm{pH})$。\n\n要求的单位、测试套件和输出规范：\n- 以 pH 单位（无量纲）报告所有等电点，并精确到 $4$ 位小数。\n- 在以下序列测试套件上验证你的实现：\n  - 测试 $1$：“Ala-His-Asp”。\n  - 测试 $2$：“Gly”。\n  - 测试 $3$：“Lys”。\n  - 测试 $4$：“Asp-Glu”。\n  - 测试 $5$：“Arg-Lys”。\n  - 测试 $6$：“Tyr-Cys”。\n- 你的程序应生成单行输出，其中包含 6 个结果，格式为方括号内用逗号分隔的列表，顺序与上文相同（例如，“[x1,x2,x3,x4,x5,x6]”），其中每个 $x_i$ 是一个小数点后恰好有 4 位数字的浮点数。", "solution": "问题陈述经评估有效。它在科学上基于酸碱化学原理，问题提出得当，信息充足，可得到唯一解，并采用客观、正式的语言进行表述。该模型虽然简化，却是生物化学中一个标准且具有指导意义的工具。因此，我们可以继续进行推导和求解。\n\n目标是构建一个用于计算肽的等电点（$pI$ 或 $pH^*$）的算法。等电点被定义为分子净电荷为零时的 $pH$ 值。推导将按要求从第一性原理开始。\n\n首先，我们必须推导单个可电离基团作为 $pH$ 函数的预期电荷贡献。需要考虑两种类型的可电离基团：酸性和碱性。\n\n对于一个酸性位点，模型为单质子酸 $\\mathrm{HA}$，在水中的解离平衡为：\n$$ \\mathrm{HA} \\rightleftharpoons \\mathrm{A}^- + \\mathrm{H}^+ $$\n质子化形式 $\\mathrm{HA}$ 的电荷为 $0$，去质子化形式 $\\mathrm{A}^-$ 的电荷为 $-1$。该位点的预期电荷 $z_{\\text{acidic}}$ 是这些电荷的加权平均值，权重是每种物质的分数布居：\n$$ z_{\\text{acidic}} = (0) \\cdot f_{\\mathrm{HA}} + (-1) \\cdot f_{\\mathrm{A}^-} = -f_{\\mathrm{A}^-} $$\n其中 $f_{\\mathrm{A}^-} = \\dfrac{[\\mathrm{A}^-]}{[\\mathrm{HA}] + [\\mathrm{A}^-]}$。为了将其表示为 $pH$ 的函数，我们使用 Henderson-Hasselbalch 方程：\n$$ \\mathrm{pH} = \\mathrm{p}K_a + \\log_{10}\\left(\\frac{[\\mathrm{A}^-]}{[\\mathrm{HA}]}\\right) $$\n对该比例进行重排可得：\n$$ \\frac{[\\mathrm{A}^-]}{[\\mathrm{HA}]} = 10^{\\mathrm{pH} - \\mathrm{p}K_a} $$\n由此可得 $\\dfrac{[\\mathrm{HA}]}{[\\mathrm{A}^-]} = 10^{\\mathrm{p}K_a - \\mathrm{pH}}$。我们现在可以写出 $f_{\\mathrm{A}^-}$：\n$$ f_{\\mathrm{A}^-} = \\frac{[\\mathrm{A}^-]}{[\\mathrm{HA}] + [\\mathrm{A}^-]} = \\frac{1}{\\frac{[\\mathrm{HA}]}{[\\mathrm{A}^-]} + 1} = \\frac{1}{10^{\\mathrm{p}K_a - \\mathrm{pH}} + 1} $$\n因此，单个酸性位点的电荷贡献为：\n$$ z_{\\text{acidic}}(\\mathrm{pH}) = \\frac{-1}{1 + 10^{\\mathrm{p}K_a - \\mathrm{pH}}} $$\n\n对于一个碱性位点，例如氨基，相关的平衡涉及其共轭酸 $\\mathrm{BH}^+$：\n$$ \\mathrm{BH}^+ \\rightleftharpoons \\mathrm{B} + \\mathrm{H}^+ $$\n质子化形式 $\\mathrm{BH}^+$ 的电荷为 $+1$，去质子化形式 $\\mathrm{B}$ 的电荷为 $0$。预期电荷 $z_{\\text{basic}}$ 为：\n$$ z_{\\text{basic}} = (+1) \\cdot f_{\\mathrm{BH}^+} + (0) \\cdot f_{\\mathrm{B}} = f_{\\mathrm{BH}^+} $$\n其中 $f_{\\mathrm{BH}^+} = \\dfrac{[\\mathrm{BH}^+]}{[\\mathrm{BH}^+] + [\\mathrm{B}]}$。碱性基团的 $\\mathrm{p}K_a$ 指的是其共轭酸的这种解离。因此，Henderson-Hasselbalch 方程为：\n$$ \\mathrm{pH} = \\mathrm{p}K_a + \\log_{10}\\left(\\frac{[\\mathrm{B}]}{[\\mathrm{BH}^+]}\\right) $$\n对该比例进行重排可得：\n$$ \\frac{[\\mathrm{B}]}{[\\mathrm{BH}^+]} = 10^{\\mathrm{pH} - \\mathrm{p}K_a} $$\n我们现在可以写出 $f_{\\mathrm{BH}^+}$：\n$$ f_{\\mathrm{BH}^+} = \\frac{[\\mathrm{BH}^+]}{[\\mathrm{BH}^+] + [\\mathrm{B}]} = \\frac{1}{1 + \\frac{[\\mathrm{B}]}{[\\mathrm{BH}^+]}} = \\frac{1}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_a}} $$\n因此，单个碱性位点的电荷贡献为：\n$$ z_{\\text{basic}}(\\mathrm{pH}) = \\frac{1}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_a}} $$\n\n整个肽的净电荷 $Z(\\mathrm{pH})$ 是其所有可电离位点贡献的总和。假设位点是独立的，则为：\n$$ Z(\\mathrm{pH}) = \\sum_{i \\in \\text{碱性位点}} \\frac{1}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_{a,i}}} + \\sum_{j \\in \\text{酸性位点}} \\frac{-1}{1 + 10^{\\mathrm{p}K_{a,j} - \\mathrm{pH}}} $$\n肽中的可电离位点是其 N-末端（碱性，$pK_a = 9.69$）、其 C-末端（酸性，$pK_a = 2.34$），以及七种氨基酸的侧链：天冬氨酸（酸性，$pK_a = 3.65$）、谷氨酸（酸性，$pK_a = 4.25$）、半胱氨酸（酸性，$pK_a = 8.18$）、酪氨酸（酸性，$pK_a = 10.07$）、组氨酸（碱性，$pK_a = 6.00$）、赖氨酸（碱性，$pK_a = 10.53$）和精氨酸（碱性，$pK_a = 12.48$）。\n\n我们现在必须证明 $Z(\\mathrm{pH})$ 在区间 $[0, 14]$ 内有唯一的根。这需要证明该函数是严格单调的，并且其在区间端点的值符号相反。\n为了显示单调性，我们考察 $Z(\\mathrm{pH})$ 相对于 $pH$ 的导数。令 $x = \\mathrm{pH}$。\n对于一个碱性位点：\n$$ \\frac{d}{dx} z_{\\text{basic}}(x) = \\frac{d}{dx} \\left( (1 + 10^{x - \\mathrm{p}K_a})^{-1} \\right) = -(1 + 10^{x - \\mathrm{p}K_a})^{-2} \\cdot (10^{x - \\mathrm{p}K_a} \\ln 10) < 0 $$\n对于一个酸性位点：\n$$ \\frac{d}{dx} z_{\\text{acidic}}(x) = \\frac{d}{dx} \\left( -(1 + 10^{\\mathrm{p}K_a - x})^{-1} \\right) = (1 + 10^{\\mathrm{p}K_a - x})^{-2} \\cdot (10^{\\mathrm{p}K_a - x} \\ln 10 \\cdot (-1)) < 0 $$\n由于 $Z(\\mathrm{pH})$ 总和中每一项的导数对于所有 $pH$ 都严格为负，所以 $Z(\\mathrm{pH})$ 本身的导数，作为这些导数的总和，也严格为负。因此，$Z(\\mathrm{pH})$ 是 $pH$ 的一个严格递减函数。这保证了如果存在根，则该根是唯一的。\n\n为了证明在 $[0, 14]$ 区间内存在根，我们计算 $Z(\\mathrm{pH})$ 在边界处的值。\n在 $pH=0$ 时：对于任何 $pK_{a,i} > 0$ 的碱性位点，其电荷 $z_{\\text{basic}}(0) = (1 + 10^{-\\mathrm{p}K_a})^{-1}$ 为正且接近 $1$。对于任何 $pK_{a,j} > 0$ 的酸性位点，其电荷 $z_{\\text{acidic}}(0) = -(1 + 10^{\\mathrm{p}K_a})^{-1}$ 是一个小的负数。任何肽都至少包含一个 N-末端，它是一个碱性基团。正电荷的总和将占主导地位，确保 $Z(0) > 0$。\n在 $pH=14$ 时：对于任何 $pK_{a,i} < 14$ 的碱性位点，其电荷 $z_{\\text{basic}}(14) = (1 + 10^{14-\\mathrm{p}K_a})^{-1}$ 是一个小的正数，接近 $0$。对于任何 $pK_{a,j} < 14$ 的酸性位点，其电荷 $z_{\\text{acidic}}(14) = -(1 + 10^{\\mathrm{p}K_a-14})^{-1}$ 为负且接近 $-1$。任何肽都至少包含一个 C-末端，它是一个酸性基团。负电荷的总和将占主导地位，确保 $Z(14) < 0$。\n根据介值定理 (Intermediate Value Theorem)，由于 $Z(\\mathrm{pH})$ 在 $[0, 14]$ 上是连续的，且 $Z(0) > 0$ 和 $Z(14) < 0$，所以在 $(0, 14)$ 区间内必须存在至少一个根 $pH^*$。结合严格单调性，这个根是唯一的。\n\n为了找到根 $pH^*$，我们将实现二分法。对于一个连续函数，在其定义区间两端函数值符号相反的情况下，该方法保证收敛。\n算法如下：\n1.  初始化搜索区间 $a_0 = 0$ 和 $b_0 = 14$。\n2.  对于 $k = 0, 1, 2, ...$，计算中点 $c_k = (a_k + b_k) / 2$。\n3.  计算净电荷 $Z(c_k)$。\n4.  检查终止条件：\n    - 如果 $\\lvert Z(c_k) \\rvert \\le 10^{-12}$，则根已找到，我们终止并返回 $c_k$。\n    - 如果 $(b_k - a_k) < 10^{-6}$，则区间足够小，我们终止并返回 $c_k$。\n5.  为下一次迭代更新区间：\n    - 如果 $Z(c_k) > 0$，则根必在 $(c_k, b_k]$ 内，所以设 $a_{k+1} = c_k$ 和 $b_{k+1} = b_k$。\n    - 如果 $Z(c_k) < 0$，则根必在 $[a_k, c_k)$ 内，所以设 $a_{k+1} = a_k$ 和 $b_{k+1} = c_k$。\n    - $Z(c_k)=0$ 的情况由第一个终止条件处理。\n这个迭代过程系统地缩小包含根的区间，直到达到所需的精度。实现将解析肽序列，组合相应的酸性和碱性 $pK_a$ 值列表，并应用此数值程序来找到等电点 $pH^*$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the isoelectric point of peptides based on a Henderson-Hasselbalch model.\n    \"\"\"\n\n    # Standard pKa values for ionizable groups in a peptide.\n    PKA_VALUES = {\n        'N_terminus': 9.69,\n        'C_terminus': 2.34,\n        'Asp': 3.65,\n        'Glu': 4.25,\n        'His': 6.00,\n        'Cys': 8.18,\n        'Tyr': 10.07,\n        'Lys': 10.53,\n        'Arg': 12.48,\n    }\n\n    # Classification of amino acid side chains as acidic or basic.\n    IONIZABLE_SIDE_CHAINS = {\n        'Asp': 'acidic', 'Glu': 'acidic', 'Cys': 'acidic', 'Tyr': 'acidic',\n        'Lys': 'basic', 'Arg': 'basic', 'His': 'basic'\n    }\n\n    def calculate_net_charge(ph, pkas_acidic, pkas_basic):\n        \"\"\"\n        Calculates the net charge of a peptide at a given pH.\n        \n        Args:\n            ph (float): The pH of the solution.\n            pkas_acidic (list): List of pKa values for acidic groups.\n            pkas_basic (list): List of pKa values for basic groups.\n        \n        Returns:\n            float: The net charge of the peptide.\n        \"\"\"\n        charge = 0.0\n        \n        # Contribution from acidic groups\n        for pka in pkas_acidic:\n            charge += -1.0 / (1.0 + np.power(10.0, pka - ph))\n            \n        # Contribution from basic groups\n        for pka in pkas_basic:\n            charge += 1.0 / (1.0 + np.power(10.0, ph - pka))\n            \n        return charge\n\n    def find_isoelectric_point(sequence_str):\n        \"\"\"\n        Calculates the isoelectric point (pI) of a peptide sequence.\n\n        Args:\n            sequence_str (str): A hyphen-separated string of 3-letter amino acid codes.\n\n        Returns:\n            float: The calculated isoelectric point (pI).\n        \"\"\"\n        amino_acids = sequence_str.split('-')\n        \n        pkas_acidic = [PKA_VALUES['C_terminus']]\n        pkas_basic = [PKA_VALUES['N_terminus']]\n        \n        for aa in amino_acids:\n            if aa in IONIZABLE_SIDE_CHAINS:\n                group_type = IONIZABLE_SIDE_CHAINS[aa]\n                if group_type == 'acidic':\n                    pkas_acidic.append(PKA_VALUES[aa])\n                elif group_type == 'basic':\n                    pkas_basic.append(PKA_VALUES[aa])\n                    \n        low_ph, high_ph = 0.0, 14.0\n        \n        # Bisection method to find the root of the net charge function\n        while (high_ph - low_ph) >= 1e-6:\n            mid_ph = (low_ph + high_ph) / 2.0\n            \n            charge = calculate_net_charge(mid_ph, pkas_acidic, pkas_basic)\n            \n            if abs(charge) <= 1e-12:\n                return mid_ph\n            \n            if charge > 0:\n                low_ph = mid_ph\n            else:\n                high_ph = mid_ph\n        \n        return (low_ph + high_ph) / 2.0\n\n    # Test suite of peptide sequences\n    test_cases = [\n        \"Ala-His-Asp\",\n        \"Gly\",\n        \"Lys\",\n        \"Asp-Glu\",\n        \"Arg-Lys\",\n        \"Tyr-Cys\",\n    ]\n\n    results = []\n    for seq in test_cases:\n        pi = find_isoelectric_point(seq)\n        results.append(f\"{pi:.4f}\")\n\n    # Print the final results in the specified format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2590652"}]}