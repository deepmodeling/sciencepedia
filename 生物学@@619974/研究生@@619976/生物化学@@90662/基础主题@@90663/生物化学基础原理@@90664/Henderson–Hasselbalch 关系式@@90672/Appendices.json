{"hands_on_practices": [{"introduction": "掌握缓冲液的制备是生物化学实验中的一项基本功。本练习将引导你摒弃直接套用亨德森-哈塞尔巴尔赫（Henderson-Hasselbalch, HH）方程的便捷路径，回归到化学平衡、质量守恒和电荷守恒这三大基本原则，从头计算特定 $pH$ 缓冲液的配制方案。这种第一性原理的训练能够加深你对缓冲系统内在化学本质的理解，并为你处理更复杂的缓冲体系打下坚实的理论基础 [@problem_id:2611463]。", "problem": "您正在使用一种单质子弱酸（表示为 $HA$）的储备溶液和一种标准化的强碱——氢氧化钠（$\\mathrm{NaOH}$）来配制缓冲液。目标缓冲液的最终体积为 $1.000$ L，分析浓度 $C_T$（稀释后定义为 $C_T \\equiv [HA] + [A^{-}]$）为 $50$ mM，氢离子浓度指数（pH）为 $7.20$。在 $25\\,^{\\circ}\\mathrm{C}$ 时，该酸的 $pK_a = 7.20$。您有浓度为 $0.500$ M 的纯酸储备溶液和浓度为 $0.1000$ M 的标准化 $\\mathrm{NaOH}$ 溶液。实验方案是：取一定体积的酸储备溶液注入一个 $1.000$ L 的容量瓶中，加入足量的 $\\mathrm{NaOH}$ 滴定剂以部分中和该酸，然后用 $25\\,^{\\circ}\\mathrm{C}$ 的水稀释至刻度线。\n\n请仅从酸解离平衡、电中性和质量平衡出发，不使用任何现成的缓冲液公式，确定需要加入多少 $\\mathrm{NaOH}$ 才能在指定的 pH 值下达到目标组分。假设在这些条件下，$HA$ 和 $A^{-}$ 的活度系数相等，因此活度比可以用浓度比代替，并忽略相对于缓冲液浓度的水的自偶电离。\n\n请将最终答案表示为需要加入的 $\\mathrm{NaOH}$ 溶液的体积，单位为毫升。将您的答案四舍五入至四位有效数字。", "solution": "在尝试求解之前，将根据所需标准对所述问题进行验证。\n\n### 步骤1：提取已知条件\n-   **酸的类型**：单质子弱酸，$HA$。\n-   **滴定剂**：强碱，氢氧化钠（$\\mathrm{NaOH}$）。\n-   **目标分析浓度**：$C_T \\equiv [HA] + [A^{-}] = 50$ mM。\n-   **目标最终体积**：$V_f = 1.000$ L。\n-   **目标pH**：$7.20$。\n-   **酸解离常数**：$25\\,^{\\circ}\\mathrm{C}$ 时 $pK_a = 7.20$。\n-   **酸储备溶液浓度**：$C_{\\text{stock}, HA} = 0.500$ M。\n-   **碱滴定剂浓度**：$C_{NaOH} = 0.1000$ M。\n-   **约束条件**：\n    -   必须从酸解离平衡、电中性和质量平衡出发推导解法。\n    -   不能使用现成的缓冲液公式（例如，亨德森-哈塞尔巴尔赫方程）。\n-   **假设**：\n    -   $HA$ 和 $A^{-}$ 的活度系数相等。\n    -   相对于缓冲液浓度，水的自偶电离可以忽略。\n-   **目标**：确定需要加入的 $\\mathrm{NaOH}$ 溶液的体积 $V_{NaOH}$，单位毫升，四舍五入至四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题是定量化学分析中的一个标准练习，具体涉及缓冲液的配制。\n-   **科学依据**：该问题基于酸碱化学的基本原理，包括平衡、质量平衡和电荷平衡。所有数值在实验室环境中都是物理上现实的。\n-   **问题明确**：该问题提供了充分、一致的数据和明确的约束条件，足以确定唯一的 $\\mathrm{NaOH}$ 体积值。\n-   **客观性**：问题以精确、定量的术语陈述，没有歧义或主观内容。\n\n该问题未违反任何指定的无效标准。明确要求将最终答案四舍五入至四位有效数字，这意味着输入值“$50$ mM”应被视为具有足够的精度，即为 $50.00$ mM 或 $0.05000$ M。\n\n### 步骤3：结论与行动\n问题有效。将根据要求从第一性原理推导严谨的解法。\n\n### 求解推导\n解法必须从三个基本原理推导得出：酸解离平衡、酸物种的质量平衡以及最终溶液的电中性原理。\n\n1.  **酸解离平衡**：弱酸 $HA$ 在水中的解离由以下平衡描述：\n    $$HA \\rightleftharpoons H^+ + A^-$$\n    酸解离常数 $K_a$ 定义为：\n    $$K_a = \\frac{[H^+][A^{-}]}{[HA]}$$\n    问题陈述，$HA$ 和 $A^-$ 的活度系数相等，这证明了使用浓度代替活度的合理性。整理此表达式可得到共轭碱与酸的比率：\n    $$\\frac{[A^{-}]}{[HA]} = \\frac{K_a}{[H^+]}$$\n    已知 $pH = 7.20$ 且 $pK_a = 7.20$。根据定义，$pH = -\\log_{10}([H^+])$ 且 $pK_a = -\\log_{10}(K_a)$。因此，$[H^+] = 10^{-7.20}$ M 且 $K_a = 10^{-7.20}$。将这些值代入比率表达式：\n    $$\\frac{[A^{-}]}{[HA]} = \\frac{10^{-7.20}}{10^{-7.20}} = 1$$\n    这从第一性原理证明了，要达到目标 pH 值，弱酸及其共轭碱的浓度必须相等：$[A^{-}] = [HA]$。\n\n2.  **质量平衡**：缓冲液组分的总分析浓度 $C_T$ 是未解离的酸及其共轭碱的浓度之和。\n    $$C_T = [HA] + [A^{-}]$$\n    给定 $C_T = 50$ mM $= 0.050$ M。根据验证，为满足输出精度要求，我们取 $C_T = 0.05000$ M。\n    将平衡分析的结果 $[HA] = [A^{-}]$ 代入质量平衡方程：\n    $$C_T = [A^{-}] + [A^{-}] = 2[A^{-}]$$\n    求解所需的共轭碱浓度 $[A^{-}]$：\n    $$[A^{-}] = \\frac{C_T}{2} = \\frac{0.05000 \\text{ M}}{2} = 0.02500 \\text{ M}$$\n\n3.  **电中性与化学计量**：电中性原理要求溶液中总的正电荷浓度等于总的负电荷浓度。溶液中存在的离子有 $Na^+$（来自 $\\mathrm{NaOH}$）、$H^+$（来自酸和水）、$A^-$（来自酸解离）和 $OH^-$（来自水）。电荷平衡方程为：\n    $$[Na^+] + [H^+] = [A^{-}] + [OH^-]$$\n    问题允许忽略水的自偶电离。在 $pH = 7.20$ 时，我们有 $[H^+] = 10^{-7.20}$ M $\\approx 6.31 \\times 10^{-8}$ M 且 $[OH^-] = 10^{-(14.00 - 7.20)}$ M $= 10^{-6.80}$ M $\\approx 1.58 \\times 10^{-7}$ M。这两个浓度都比目标缓冲液物种浓度 $0.02500$ M 小几个数量级。因此该近似是合理的。电荷平衡方程简化为：\n    $$[Na^+] \\approx [A^{-}]$$\n    最终溶液中的钠离子完全来自加入的 $\\mathrm{NaOH}$ 溶液，其体积为 $V_{NaOH}$。$Na^+$ 的总摩尔数为 $n_{Na^+} = C_{NaOH} \\times V_{NaOH}$。在最终体积 $V_f$ 中的浓度为：\n    $$[Na^+] = \\frac{C_{NaOH} V_{NaOH}}{V_f}$$\n    将此与简化的电荷平衡和所需的 $[A^{-}]$ 浓度结合：\n    $$[A^{-}] = \\frac{C_{NaOH} V_{NaOH}}{V_f}$$\n    该方程将所需的共轭碱浓度与必须加入的强碱体积联系起来。我们现在可以求解 $V_{NaOH}$：\n    $$V_{NaOH} = \\frac{[A^{-}] V_f}{C_{NaOH}}$$\n    代入已知值：\n    $$V_{NaOH} = \\frac{(0.02500 \\text{ M})(1.000 \\text{ L})}{0.1000 \\text{ M}}$$\n    $$V_{NaOH} = \\frac{0.02500}{0.1000} \\text{ L} = 0.2500 \\text{ L}$$\n    问题要求以毫升为单位给出答案。要将升转换为毫升，我们乘以 $1000$：\n    $$V_{NaOH} = 0.2500 \\text{ L} \\times 1000 \\frac{\\text{mL}}{\\text{L}} = 250.0 \\text{ mL}$$\n    此结果有四位有效数字，符合要求。", "answer": "$$\\boxed{250.0}$$", "id": "2611463"}, {"introduction": "生物体内的缓冲系统，如磷酸盐和氨基酸，通常是多质子系统，其行为比单质子酸碱对更为复杂。本练习将以一个二元弱酸为例，要求你在特定 $pH$ 条件下，评估其不同质子化形式的相对浓度，并从第一性原理出发，严谨地论证是否可以将该体系简化为单一的、由一个共轭酸碱对主导的平衡 [@problem_id:2611483]。掌握这种做出合理简化的判断能力，对于有效建模和理解复杂的生化反应网络至关重要。", "problem": "一个实验室在 $25\\,^{\\circ}\\mathrm{C}$ 下制备了一种水溶液，其中含有一种通用的二元弱酸，记为 $ \\mathrm{H}_2\\mathrm{A} $，其总分析浓度 $C_T$ 已知（即 $C_T = [\\mathrm{H}_2\\mathrm{A}] + [\\mathrm{H}\\mathrm{A}^{-}] + [\\mathrm{A}^{2-}]$）。通过加入强碱将溶液的 $pH$ 值调节至 $9.0$。在这些条件下，$ \\mathrm{H}_2\\mathrm{A} $ 的逐级酸解离常数由 $pK_{a1} = 6.35$ 和 $pK_{a2} = 10.33$ 表征。\n\n请仅从逐级酸解离平衡的定义和 $C_T$ 的物料平衡出发，推导比值 $[\\mathrm{H}\\mathrm{A}^{-}]/[\\mathrm{A}^{2-}]$ 的表达式，该表达式用 $C_T$、$K_{a1}$、$K_{a2}$ 和 $[\\mathrm{H}^{+}]$ 表示。然后，使用给定的 $pK_{a}$ 值，在 $pH = 9.0$ 时计算该比值。在您的推导过程中，请明确说明 $C_T$ 是否以及如何从该比值中消去。除了平衡常数和物料平衡定义中固有的假设外，不要假定任何特定的近似。将您最终的数值比值四舍五入到四位有效数字。将该比值表示为无量纲数。\n\n最后，根据您的推导以及在 $pH = 9.0$ 时 $pH - pK_{a1}$ 和 $pH - pK_{a2}$ 的大小，评论在这些条件下将系统视为 $\\mathrm{H}\\mathrm{A}^{-}$ 和 $\\mathrm{A}^{2-}$ 之间的单一去质子化平衡是否合适，并从第一性原理出发证明您的推理，无需援引任何预先给出的缓冲方程式。", "solution": "该问题要求推导一个二元酸共轭碱物种浓度比的表达式，对其进行数值计算，并对一个常用近似进行评论。分析必须从第一性原理开始，不预设任何简化的缓冲方程式。\n\n该系统涉及水溶液中的二元弱酸 $\\mathrm{H}_2\\mathrm{A}$，它经历两个连续的去质子化步骤。这些平衡由逐级酸解离常数 $K_{a1}$ 和 $K_{a2}$ 描述。\n\n第一个平衡为：\n$$ \\mathrm{H}_2\\mathrm{A} \\rightleftharpoons \\mathrm{H}^{+} + \\mathrm{H}\\mathrm{A}^{-} $$\n相应的平衡常数定义为：\n$$ K_{a1} = \\frac{[\\mathrm{H}^{+}][\\mathrm{H}\\mathrm{A}^{-}]}{[\\mathrm{H}_2\\mathrm{A}]} \\quad (1) $$\n\n第二个平衡为：\n$$ \\mathrm{H}\\mathrm{A}^{-} \\rightleftharpoons \\mathrm{H}^{+} + \\mathrm{A}^{2-} $$\n相应的平衡常数定义为：\n$$ K_{a2} = \\frac{[\\mathrm{H}^{+}][\\mathrm{A}^{2-}]}{[\\mathrm{H}\\mathrm{A}^{-}]} \\quad (2) $$\n\n酸的总分析浓度 $C_T$ 由物料平衡方程给出：\n$$ C_T = [\\mathrm{H}_2\\mathrm{A}] + [\\mathrm{H}\\mathrm{A}^{-}] + [\\mathrm{A}^{2-}] \\quad (3) $$\n\n问题要求计算比值 $[\\mathrm{H}\\mathrm{A}^{-}]/[\\mathrm{A}^{2-}]$。根据第二个酸解离常数的定义，即方程 $(2)$，我们可以直接重新整理以得到该比值的表达式：\n$$ \\frac{[\\mathrm{H}\\mathrm{A}^{-}]}{[\\mathrm{A}^{2-}]} = \\frac{[\\mathrm{H}^{+}]}{K_{a2}} \\quad (4) $$\n该表达式已经用 $[\\mathrm{H}^{+}]$ 和 $K_{a2}$ 给出了比值。然而，为了按要求严格证明其与 $C_T$ 和 $K_{a1}$ 无关，我们将推导 $[\\mathrm{H}\\mathrm{A}^{-}]$ 和 $[\\mathrm{A}^{2-}]$ 各自浓度作为 $C_T$ 分数的形式，然后计算它们的比值。\n\n为此，我们使用方程 $(1)$ 和 $(2)$ 将 $[\\mathrm{H}_2\\mathrm{A}]$ 和 $[\\mathrm{A}^{2-}]$ 用 $[\\mathrm{H}\\mathrm{A}^{-}]$ 来表示：\n由 $(1)$: $[\\mathrm{H}_2\\mathrm{A}] = \\frac{[\\mathrm{H}^{+}][\\mathrm{H}\\mathrm{A}^{-}]}{K_{a1}}$\n由 $(2)$: $[\\mathrm{A}^{2-}] = \\frac{K_{a2}[\\mathrm{H}\\mathrm{A}^{-}]}{[\\mathrm{H}^{+}]}$\n\n将这些代入物料平衡方程 $(3)$:\n$$ C_T = \\frac{[\\mathrm{H}^{+}][\\mathrm{H}\\mathrm{A}^{-}]}{K_{a1}} + [\\mathrm{H}\\mathrm{A}^{-}] + \\frac{K_{a2}[\\mathrm{H}\\mathrm{A}^{-}]}{[\\mathrm{H}^{+}]} $$\n提取公因子 $[\\mathrm{H}\\mathrm{A}^{-}]$:\n$$ C_T = [\\mathrm{H}\\mathrm{A}^{-}] \\left( \\frac{[\\mathrm{H}^{+}]}{K_{a1}} + 1 + \\frac{K_{a2}}{[\\mathrm{H}^{+}]} \\right) $$\n由此，我们解出 $[\\mathrm{H}\\mathrm{A}^{-}]$:\n$$ [\\mathrm{H}\\mathrm{A}^{-}] = \\frac{C_T}{\\frac{[\\mathrm{H}^{+}]}{K_{a1}} + 1 + \\frac{K_{a2}}{[\\mathrm{H}^{+}]}} \\quad (5) $$\n\n现在，使用 $[\\mathrm{A}^{2-}] = \\frac{K_{a2}}{[\\mathrm{H}^{+}]}[\\mathrm{H}\\mathrm{A}^{-}]$，我们求得 $[\\mathrm{A}^{2-}]$:\n$$ [\\mathrm{A}^{2-}] = \\frac{K_{a2}}{[\\mathrm{H}^{+}]} \\left( \\frac{C_T}{\\frac{[\\mathrm{H}^{+}]}{K_{a1}} + 1 + \\frac{K_{a2}}{[\\mathrm{H}^{+}]}} \\right) = \\frac{\\frac{K_{a2}}{[\\mathrm{H}^{+}]} C_T}{\\frac{[\\mathrm{H}^{+}]}{K_{a1}} + 1 + \\frac{K_{a2}}{[\\mathrm{H}^{+}]}} \\quad (6) $$\n\n现在我们利用表达式 $(5)$ 和 $(6)$ 构建比值 $[\\mathrm{H}\\mathrm{A}^{-}]/[\\mathrm{A}^{2-}]$:\n$$ \\frac{[\\mathrm{H}\\mathrm{A}^{-}]}{[\\mathrm{A}^{2-}]} = \\frac{\\frac{C_T}{\\frac{[\\mathrm{H}^{+}]}{K_{a1}} + 1 + \\frac{K_{a2}}{[\\mathrm{H}^{+}]}}}{\\frac{\\frac{K_{a2}}{[\\mathrm{H}^{+}]} C_T}{\\frac{[\\mathrm{H}^{+}]}{K_{a1}} + 1 + \\frac{K_{a2}}{[\\mathrm{H}^{+}]}}} $$\n简化后，总浓度 $C_T$ 和整个分母项 $\\left( \\frac{[\\mathrm{H}^{+}]}{K_{a1}} + 1 + \\frac{K_{a2}}{[\\mathrm{H}^{+}]} \\right)$ 都被消去，剩下：\n$$ \\frac{[\\mathrm{H}\\mathrm{A}^{-}]}{[\\mathrm{A}^{2-}]} = \\frac{1}{\\frac{K_{a2}}{[\\mathrm{H}^{+}]}} = \\frac{[\\mathrm{H}^{+}]}{K_{a2}} $$\n这一严格的推导证实了比值 $[\\mathrm{H}\\mathrm{A}^{-}]/[\\mathrm{A}^{2-}]$ 与总浓度 $C_T$ 和第一解离常数 $K_{a1}$ 均无关。它仅取决于氢离子浓度 $[\\mathrm{H}^{+}]$ 和第二解离常数 $K_{a2}$。\n\n接下来，我们对该比值进行数值计算。\n给定数据：$pH = 9.0$, $pK_{a1} = 6.35$, $pK_{a2} = 10.33$。\n首先，将 $pH$ 和 $pK_{a2}$ 转换为浓度和平衡常数：\n$[\\mathrm{H}^{+}] = 10^{-pH} = 10^{-9.0}$\n$K_{a2} = 10^{-pK_{a2}} = 10^{-10.33}$\n\n现在将这些值代入推导出的比值表达式中：\n$$ \\frac{[\\mathrm{H}\\mathrm{A}^{-}]}{[\\mathrm{A}^{2-}]} = \\frac{10^{-9.0}}{10^{-10.33}} = 10^{(-9.0) - (-10.33)} = 10^{1.33} $$\n计算数值并四舍五入到四位有效数字：\n$$ 10^{1.33} \\approx 21.3796... \\approx 21.38 $$\n\n最后，我们被要求评论将系统视为 $\\mathrm{H}\\mathrm{A}^{-}$ 和 $\\mathrm{A}^{2-}$ 之间的单一去质子化平衡是否合适。如果其他物种 $\\mathrm{H}_2\\mathrm{A}$ 的浓度与 $\\mathrm{H}\\mathrm{A}^{-}$ 和 $\\mathrm{A}^{2-}$ 的浓度相比可以忽略不计，则该近似是合适的。我们可以从第一性原理出发，利用给定的条件来评估这一点。\n其理由取决于溶液 $pH$ 与两个 $pK_a$ 值之差的大小。\n相关的差异为：\n$pH - pK_{a1} = 9.0 - 6.35 = 2.65$\n$pH - pK_{a2} = 9.0 - 10.33 = -1.33$\n\n从 $K_{a1}$ 的定义中，我们可以确定 $[\\mathrm{H}_2\\mathrm{A}]$ 与 $[\\mathrm{H}\\mathrm{A}^{-}]$ 的比值：\n$$ \\frac{[\\mathrm{H}_2\\mathrm{A}]}{[\\mathrm{H}\\mathrm{A}^{-}]} = \\frac{[\\mathrm{H}^{+}]}{K_{a1}} = \\frac{10^{-9.0}}{10^{-6.35}} = 10^{-2.65} $$\n或者，这可以表示为 $\\log_{10}\\left(\\frac{[\\mathrm{H}\\mathrm{A}^{-}]}{[\\mathrm{H}_2\\mathrm{A}]}\\right) = pH - pK_{a1} = 2.65$。\n这意味着 $\\frac{[\\mathrm{H}\\mathrm{A}^{-}]}{[\\mathrm{H}_2\\mathrm{A}]} = 10^{2.65} \\approx 447$。\n因此，$[\\mathrm{H}_2\\mathrm{A}] \\approx \\frac{1}{447}[\\mathrm{H}\\mathrm{A}^{-}] \\approx 0.0022[\\mathrm{H}\\mathrm{A}^{-}]$。\n完全质子化的物种 $\\mathrm{H}_2\\mathrm{A}$ 的浓度不到中间物种 $\\mathrm{H}\\mathrm{A}^{-}$ 浓度的 $0.25\\%$。由于 $pH - pK_{a2}$ 的绝对值不大（为 $-1.33$），$[\\mathrm{H}\\mathrm{A}^{-}]$ 和 $[\\mathrm{A}^{2-}]$ 均以显著的量存在。具体来说，我们发现 $[\\mathrm{H}\\mathrm{A}^{-}]$ 的浓度大约是 $[\\mathrm{A}^{2-}]$ 的 $21$ 倍。因为 $[\\mathrm{H}_2\\mathrm{A}]$ 即使与 $[\\mathrm{H}\\mathrm{A}^{-}]$（该对物种中的优势物种）相比也可以忽略不计，其对总物料平衡 $C_T$ 的贡献是微不足道的。\n$pH - pK_{a1}$ 的较大的正值（$2.65$）表明，第一个平衡向右移动的程度非常大，以至于物种 $\\mathrm{H}_2\\mathrm{A}$ 基本上被耗尽。因此，物料平衡可以准确地近似为 $C_T \\approx [\\mathrm{H}\\mathrm{A}^{-}] + [\\mathrm{A}^{2-}]$，这是将系统视为由共轭对 $\\mathrm{H}\\mathrm{A}^{-}/\\mathrm{A}^{2-}$ 组成的简单单质子缓冲体系的前提。在这些条件下，该近似是完全合理的。", "answer": "$$\\boxed{21.38}$$", "id": "2611483"}, {"introduction": "经典的亨德森-哈塞尔巴尔赫方程建立在理想溶液的假设之上，然而，真实的细胞环境是离子强度很高的非理想体系。本项高级计算实践旨在弥合理论与现实之间的鸿沟，它要求你设计一个计算实验，将活度系数（activity coefficients）纳入考量，以修正离子强度对 $pH$ 的影响 [@problem_id:2611480]。你将通过将戴维斯（Davies）方程等活度模型与模拟的实验数据进行拟合，来反演热力学参数，这一过程完美复现了从实验观测到理论建模的现代科研精髓。", "problem": "您将设计一个计算实验，通过拟合一个考虑活度的 Henderson–Hasselbalch 模型，从氢离子活度指数 (pH) 作为离子强度的函数测量值中，估算单质子酸体系的单离子活度系数。目标是将此工作流程形式化为一个程序，该程序以测量的 pH 值和已知的组成为输入，推导出共轭碱的活度系数，并通过拟合一个 Davies 型活度模型来估算 Debye–Hückel 常数。\n\n从单质子弱酸 $\\mathrm{HA}$ 解离的基本质量作用定律（使用活度）开始：\n$$\\mathrm{HA} \\rightleftharpoons \\mathrm{H}^+ + \\mathrm{A}^-$$\n其标准态下的热力学平衡常数 $K_\\mathrm{a}^\\circ$ 定义为\n$$K_\\mathrm{a}^\\circ \\equiv \\frac{a_{\\mathrm{H}^+} a_{\\mathrm{A}^-}}{a_{\\mathrm{HA}}},$$\n以及氢离子活度指数 (pH) 的定义，\n$$\\mathrm{pH} \\equiv -\\log_{10} a_{\\mathrm{H}^+}.$$\n假设中性酸分子 $\\mathrm{HA}$ 的活度系数 $\\gamma_{\\mathrm{HA}} \\approx 1$，因此 $a_{\\mathrm{HA}} \\approx [\\mathrm{HA}]$，并定义组成比 $R \\equiv [\\mathrm{A}^-]/[\\mathrm{HA}]$，该比例由制备条件决定，并在通过添加惰性盐调节离子强度时保持固定。仅使用这些定义和质量作用定律作为出发点；不得调用任何预先推导的缓冲方程式。\n\n使用温度 $T \\approx 298.15\\,\\mathrm{K}$ 下的 Davies 方程对单价共轭碱 $\\mathrm{A}^-$ 的活度系数进行建模：\n$$\\log_{10} \\gamma_{\\mathrm{A}^-}(I) = -A \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I \\right),$$\n其中 $I$ 是离子强度，单位为 $\\mathrm{mol\\,L^{-1}}$，$\\gamma_{\\mathrm{A}^-}$ 是无量纲的，$A$ 是一个待从数据中估算的未知常数（在 $25^\\circ\\mathrm{C}$ 时，典型值接近 $0.509$，但在拟合步骤中不要假设此值）。\n\n对于下方的每个测试用例，您的程序必须：\n1) 使用包含活度的质量作用定律和 pH 的定义，推导出一个表达式，该表达式将 $\\log_{10}\\gamma_{\\mathrm{A}^-}$ 从测量的 $\\mathrm{pH}$、已知的 $\\mathrm{p}K_\\mathrm{a}^\\circ \\equiv -\\log_{10} K_\\mathrm{a}^\\circ$ 和已知的比率 $R \\equiv [\\mathrm{A}^-]/[\\mathrm{HA}]$ 中分离出来。您必须在您的内部逻辑中清晰地陈述您的假设（例如，$\\gamma_{\\mathrm{HA}} \\approx 1$）。基于该推导关系，为测试用例中的每个离子强度点计算 $\\log_{10}\\gamma_{\\mathrm{A}^-}$。\n2) 定义 Davies 基函数\n$$f(I) \\equiv \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I,$$\n并拟合线性模型\n$$y_i = -A\\, f(I_i), \\quad \\text{其中} \\quad y_i \\equiv \\log_{10}\\gamma_{\\mathrm{A}^-}(I_i),$$\n该拟合通过约束过原点的最小二乘法（即，无截距项）进行，得到估计量\n$$\\hat{A} = -\\frac{\\sum_i f(I_i)\\, y_i}{\\sum_i f(I_i)^2}.$$\n3) 对于每个测试用例，返回拟合值 $\\hat{A}$，形式为一个四舍五入到六位小数的浮点数。\n\n物理和数值单位：离子强度 $I$ 的单位为 $\\mathrm{mol\\,L^{-1}}$；活度系数和常数 $A$ 是无量纲的；pH 和 $\\mathrm{p}K_\\mathrm{a}^\\circ$ 是无量纲的。\n\n程序的测试套件和数据（请精确使用所提供的这些数字）：\n- 测试用例 1（一般情况；中等离子强度，等摩尔缓冲液）：\n  - $\\mathrm{p}K_\\mathrm{a}^\\circ = 4.760$\n  - $R = 1.0$\n  - 离子强度 $I$ (单位 $\\mathrm{mol\\,L^{-1}}$): $[0.01, 0.04, 0.09]$\n  - 测量的 $\\mathrm{pH}$: $[4.7152542727274, 4.68127466666665, 4.6562814615385]$\n- 测试用例 2（边界情况；极低离子强度，等摩尔缓冲液）：\n  - $\\mathrm{p}K_\\mathrm{a}^\\circ = 6.500$\n  - $R = 1.0$\n  - 离子强度 $I$ (单位 $\\mathrm{mol\\,L^{-1}}$): $[0.0001, 0.0004, 0.0025]$\n  - 测量的 $\\mathrm{pH}$: $[6.494975666039604, 6.490080687843137, 6.476143654761905]$\n- 测试用例 3（组成边缘情况；$R \\neq 1$）：\n  - $\\mathrm{p}K_\\mathrm{a}^\\circ = 7.200$\n  - $R = 0.1$\n  - 离子强度 $I$ (单位 $\\mathrm{mol\\,L^{-1}}$): $[0.01, 0.04, 0.16]$\n  - 测量的 $\\mathrm{pH}$: $[6.155254272727273, 6.121274666666667, 6.079003428571429]$\n\n最终输出格式：您的程序应生成单行输出，其中包含三个测试用例的拟合 $\\hat{A}$ 值，形式为方括号括起来的逗号分隔列表，每个值都四舍五入到六位小数。例如，输出必须看起来像 $[a_1,a_2,a_3]$，其中每个 $a_j$ 是一个小数点后有六位数字的十进制数，并且不打印任何其他字符。\n\n您的程序必须是自包含的，不需要用户输入，并且仅依赖于指定的运行时环境。", "solution": "问题陈述经过评估，被认定是有效的。它在科学上基于化学热力学原理，数学上一致，并为一个计算任务提供了完整且适定的描述。解决方案推导并实现如下。\n\n问题的核心是从实验测量中确定单离子活度系数 $\\gamma_{\\mathrm{A}^-}$。这需要基于基本原理，推导出测量量 $\\mathrm{pH}$ 与目标量 $\\gamma_{\\mathrm{A}^-}$ 之间的函数关系。\n\n出发点是单质子酸 $\\mathrm{HA}$ 解离的质量作用定律：\n$$\n\\mathrm{HA} \\rightleftharpoons \\mathrm{H}^+ + \\mathrm{A}^-\n$$\n热力学平衡常数 $K_\\mathrm{a}^\\circ$ 以活度（$a_i$）定义：\n$$\nK_\\mathrm{a}^\\circ = \\frac{a_{\\mathrm{H}^+} a_{\\mathrm{A}^-}}{a_{\\mathrm{HA}}}\n$$\n为了线性化此表达式，我们对两边取以 10 为底的负对数：\n$$\n-\\log_{10}(K_\\mathrm{a}^\\circ) = -\\log_{10}\\left(\\frac{a_{\\mathrm{H}^+} a_{\\mathrm{A}^-}}{a_{\\mathrm{HA}}}\\right)\n$$\n$$\n-\\log_{10}(K_\\mathrm{a}^\\circ) = -\\log_{10}(a_{\\mathrm{H}^+}) - \\log_{10}(a_{\\mathrm{A}^-}) + \\log_{10}(a_{\\mathrm{HA}})\n$$\n根据定义，$\\mathrm{p}K_\\mathrm{a}^\\circ \\equiv -\\log_{10}(K_\\mathrm{a}^\\circ)$ 且 $\\mathrm{pH} \\equiv -\\log_{10}(a_{\\mathrm{H}^+})$。将这些代入方程得到：\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ = \\mathrm{pH} - \\log_{10}(a_{\\mathrm{A}^-}) + \\log_{10}(a_{\\mathrm{HA}})\n$$\n活度 $a_i$ 与摩尔浓度 $[i]$ 和无量纲的活度系数 $\\gamma_i$ 通过关系 $a_i = \\gamma_i [i]$ 相关。将此关系代入酸及其共轭碱：\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ = \\mathrm{pH} - \\log_{10}(\\gamma_{\\mathrm{A}^-} [\\mathrm{A}^-]) + \\log_{10}(\\gamma_{\\mathrm{HA}} [\\mathrm{HA}])\n$$\n问题指定了一个标准且物理上合理的假设，即中性酸物种的活度系数为 1，$\\gamma_{\\mathrm{HA}} \\approx 1$。应用这个假设简化了最后一项：\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ \\approx \\mathrm{pH} - \\log_{10}(\\gamma_{\\mathrm{A}^-} [\\mathrm{A}^-]) + \\log_{10}([\\mathrm{HA}])\n$$\n使用对数性质 $\\log(xy) = \\log(x) + \\log(y)$，我们展开共轭碱的项：\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ = \\mathrm{pH} - (\\log_{10}(\\gamma_{\\mathrm{A}^-}) + \\log_{10}([\\mathrm{A}^-])) + \\log_{10}([\\mathrm{HA}])\n$$\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ = \\mathrm{pH} - \\log_{10}(\\gamma_{\\mathrm{A}^-}) - \\log_{10}([\\mathrm{A}^-]) + \\log_{10}([\\mathrm{HA}])\n$$\n整理并使用性质 $\\log(x) - \\log(y) = \\log(x/y)$：\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ = \\mathrm{pH} - \\log_{10}(\\gamma_{\\mathrm{A}^-}) - (\\log_{10}([\\mathrm{A}^-]) - \\log_{10}([\\mathrm{HA}]))\n$$\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ = \\mathrm{pH} - \\log_{10}(\\gamma_{\\mathrm{A}^-}) - \\log_{10}\\left(\\frac{[\\mathrm{A}^-]}{[\\mathrm{HA}]}\\right)\n$$\n问题将组成比定义为 $R \\equiv [\\mathrm{A}^-]/[\\mathrm{HA}]$。将 $R$ 代入方程，得到一个活度校正形式的 Henderson-Hasselbalch 关系：\n$$\n\\mathrm{p}K_\\mathrm{a}^\\circ = \\mathrm{pH} - \\log_{10}(R) - \\log_{10}(\\gamma_{\\mathrm{A}^-})\n$$\n这个方程是连接测量值 $\\mathrm{pH}$、已知系统参数 $\\mathrm{p}K_\\mathrm{a}^\\circ$ 和 $R$，以及未知量 $\\gamma_{\\mathrm{A}^-}$ 的关键。我们现在可以分离出活度系数的项：\n$$\n\\log_{10}(\\gamma_{\\mathrm{A}^-}) = \\mathrm{pH} - \\mathrm{p}K_\\mathrm{a}^\\circ - \\log_{10}(R)\n$$\n这个推导出的表达式允许为每个数据点 $(I_i, \\mathrm{pH}_i)$ 计算 $\\log_{10}(\\gamma_{\\mathrm{A}^-})$ 的实验值。我们将此计算值表示为 $y_i$：\n$$\ny_i \\equiv \\log_{10}(\\gamma_{\\mathrm{A}^-}(I_i)) = \\mathrm{pH}_i - \\mathrm{p}K_\\mathrm{a}^\\circ - \\log_{10}(R)\n$$\n问题指定将这些值 $y_i$ 拟合到 Davies 方程，该方程将单价离子 $\\mathrm{A}^-$ 的活度系数建模为离子强度 $I$ 的函数：\n$$\n\\log_{10} \\gamma_{\\mathrm{A}^-}(I) = -A \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I \\right)\n$$\n我们定义 Davies 基函数 $f(I)$ 为：\n$$\nf(I) \\equiv \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I\n$$\n因此，待拟合的模型是一个没有截距的简单线性关系：\n$$\ny_i = -A\\, f(I_i)\n$$\n目标是找到参数 $A$ 的最佳拟合估计值，表示为 $\\hat{A}$。问题提供了强制通过原点的直线（形式为 $y=mx$，其中 $m = -A$ 且 $x = f(I)$）的普通最小二乘估计量的公式：\n$$\n\\hat{A} = -\\frac{\\sum_i f(I_i)\\, y_i}{\\sum_i f(I_i)^2}\n$$\n每个测试用例的计算流程如下：\n1.  对于给定的离子强度集 $I_i$ 和测量的 $\\mathrm{pH}$ 值 $\\mathrm{pH}_i$，以及固定的 $\\mathrm{p}K_\\mathrm{a}^\\circ$ 和 $R$，计算实验值向量 $y_i = \\mathrm{pH}_i - \\mathrm{p}K_\\mathrm{a}^\\circ - \\log_{10}(R)$。\n2.  对于相同的离子强度集 $I_i$，计算基函数值向量 $f(I_i) = \\frac{\\sqrt{I_i}}{1+\\sqrt{I_i}} - 0.3 I_i$。\n3.  计算估计量所需的两个总和：点积 $\\sum_i f(I_i) y_i$ 和平方和 $\\sum_i f(I_i)^2$。\n4.  使用提供的公式计算估计值 $\\hat{A}$。\n5.  报告四舍五入到六位小数的 $\\hat{A}$ 值。\n\n这个流程针对指定的三个测试用例中的每一个实施。使用 `numpy` 数组可以高效地完成这些向量和求和操作。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Davies parameter A by fitting an activity-aware\n    Henderson-Hasselbalch model to pH-ionic strength data.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"pKa_circ\": 4.760,\n            \"R\": 1.0,\n            \"I_values\": np.array([0.01, 0.04, 0.09]),\n            \"pH_values\": np.array([4.7152542727274, 4.68127466666665, 4.6562814615385])\n        },\n        {\n            \"pKa_circ\": 6.500,\n            \"R\": 1.0,\n            \"I_values\": np.array([0.0001, 0.0004, 0.0025]),\n            \"pH_values\": np.array([6.494975666039604, 6.490080687843137, 6.476143654761905])\n        },\n        {\n            \"pKa_circ\": 7.200,\n            \"R\": 0.1,\n            \"I_values\": np.array([0.01, 0.04, 0.16]),\n            \"pH_values\": np.array([6.155254272727273, 6.121274666666667, 6.079003428571429])\n        }\n    ]\n\n    results = []\n    \n    # Define the Davies basis function f(I)\n    def davies_basis_function(I):\n        \"\"\"\n        Calculates the Davies basis function f(I) = sqrt(I)/(1+sqrt(I)) - 0.3*I\n        Args:\n            I (np.ndarray): Ionic strength(s) in mol/L.\n        Returns:\n            np.ndarray: The value(s) of the basis function.\n        \"\"\"\n        sqrt_I = np.sqrt(I)\n        return (sqrt_I / (1.0 + sqrt_I)) - 0.3 * I\n\n    for case in test_cases:\n        pKa_circ = case[\"pKa_circ\"]\n        R = case[\"R\"]\n        I_vals = case[\"I_values\"]\n        pH_vals = case[\"pH_values\"]\n\n        # Step 1: Compute experimental y_i = log10(gamma_A_minus)\n        # y_i = pH_i - pKa_circ - log10(R)\n        log10_R = np.log10(R)\n        y_i = pH_vals - pKa_circ - log10_R\n        \n        # Step 2: Compute the Davies basis function f(I_i) for each ionic strength\n        f_I_i = davies_basis_function(I_vals)\n        \n        # Step 3: Fit the linear model y_i = -A * f(I_i) using the provided OLS estimator\n        # A_hat = - (sum(f_i * y_i)) / (sum(f_i^2))\n        sum_f_y = np.sum(f_I_i * y_i)\n        sum_f_sq = np.sum(f_I_i**2)\n        \n        A_hat = -sum_f_y / sum_f_sq\n        \n        # Round the result to six decimal places and append\n        results.append(round(A_hat, 6))\n\n    # Final print statement in the exact required format.\n    # The format f-string with .6f ensures correct rounding and decimal places.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2611480"}]}