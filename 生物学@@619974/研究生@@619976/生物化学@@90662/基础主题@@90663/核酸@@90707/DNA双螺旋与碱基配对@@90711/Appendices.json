{"hands_on_practices": [{"introduction": "本练习旨在巩固对B型DNA双螺旋基本几何参数的理解。通过从基本定义出发推导螺旋螺距，您可以深刻体会局部碱基对台阶参数（扭转角 $\\langle \\Delta \\varphi \\rangle$ 和上升高度 $\\langle \\Delta z \\rangle$）与全局螺旋特性（螺距 $P$）之间的定量关系。这个基础计算对于任何深入研究DNA结构与功能的人来说都是一项至关重要的技能。[@problem_id:2557046]", "id": "2557046", "problem": "一个右手螺旋聚合物在几何上由每个单体步长的恒定角旋转和恒定轴向平移来定义。在B型脱氧核糖核酸（B-DNA）的背景下，一个平均化的聚合物模型是适用的，其中每个碱基对步长沿螺旋轴旋转一个平均扭转角并平移一个平均上升高度。从螺旋螺距的基本几何定义——即完成 $2\\pi$ 弧度的一整圈旋转所对应的轴向行进距离——出发，推导B-DNA的螺旋螺距 $P$ 关于每个碱基对步长的平均扭转角 $\\langle \\Delta \\varphi \\rangle$ 和每步长的平均上升高度 $\\langle \\Delta z \\rangle$ 的表达式，除这些定义外不使用任何特殊公式。\n\n然后，使用在水溶液、近生理条件下B-DNA的每个碱基对步长平均扭转角为 $34.3^{\\circ}$ 和平均轴向\b上升高度 $\\langle \\Delta z \\rangle = 0.3400\\,\\text{nm}$ 的数据，计算螺旋螺距的数值。将最终螺距以纳米为单位表示，并将您的答案四舍五入到四位有效数字。如果需要，您可以使用 $2\\pi\\,\\text{弧度} = 360^{\\circ}$ 的恒等式进行角度转换。", "solution": "该问题要求推导B-DNA的螺旋螺距 $P$ 的表达式，然后基于所提供的平均结构参数进行数值计算。该问题是适定的且科学上合理的，允许基于基本定义直接求解。\n\n我们从所给的定义开始。B-DNA聚合物被建模为一个螺旋，其中每个碱基对步长都与一个平均轴向平移（或上升高度）$\\langle \\Delta z \\rangle$ 和一个平均角旋转（或扭转角）$\\langle \\Delta \\varphi \\rangle$相关联。螺旋螺距 $P$ 被定义为在沿螺旋轴完成一圈 $360^{\\circ}$ (或 $2\\pi$ 弧度) 的完整旋转过程中所前进的总轴向距离。\n\n为了推导 $P$ 的表达式，我们必须首先确定完成一整圈旋转所需的碱基对步数。我们将此数记为 $N_{bp/turn}$。这是一个无量纲量，由一整圈的总角度（$360^{\\circ}$）与每个碱基对步长的平均扭转角（$\\langle \\Delta \\varphi \\rangle$）之比给出：\n$$\nN_{bp/turn} = \\frac{360^{\\circ}}{\\langle \\Delta \\varphi \\rangle}\n$$\n根据定义，一整圈旋转的总轴向前进距离即为螺距 $P$，它等于每圈的步数 $N_{bp/turn}$ 与每步长的轴向\b上升高度 $\\langle \\Delta z \\rangle$ 的乘积。\n$$\nP = N_{bp/turn} \\times \\langle \\Delta z \\rangle\n$$\n将 $N_{bp/turn}$ 的表达式代入此方程，我们得到以平均步长参数表示的螺旋螺距的通用表达式：\n$$\nP = \\left( \\frac{360^{\\circ}}{\\langle \\Delta \\varphi \\rangle} \\right) \\langle \\Delta z \\rangle\n$$\n此表达式完全按要求仅从基本几何定义推导得出。\n\n现在，我们进行数值计算。问题提供了B-DNA在水溶液中的以下平均值：\n每个碱基对步长的平均扭转角：$\\langle \\Delta \\varphi \\rangle = 34.3^{\\circ}$\n每个碱基对步长的平均轴向\b上升高度：$\\langle \\Delta z \\rangle = 0.3400\\,\\text{nm}$\n\n首先，我们计算每螺旋周的碱基对数， $N_{bp/turn}$：\n$$\nN_{bp/turn} = \\frac{360^{\\circ}}{34.3^{\\circ}} \\approx 10.49562682\n$$\n接下来，我们使用推导出的公式计算螺距 $P$：\n$$\nP = N_{bp/turn} \\times \\langle \\Delta z \\rangle \\approx 10.49562682 \\times 0.3400\\,\\text{nm}\n$$\n$$\nP \\approx 3.568513119\\,\\text{nm}\n$$\n问题明确指示最终答案需四舍五入到四位有效数字。前四位有效数字是 $3$、$5$、$6$ 和 $8$。第五位有效数字是 $5$，这要求将第四位数字向上舍入。\n$$\nP \\approx 3.569\\,\\text{nm}\n$$\n这就是在指定条件下B-DNA螺旋螺距的最终数值。", "answer": "$$\n\\boxed{3.569}\n$$"}, {"introduction": "这个实践将引导您探索DNA双链体的热力学稳定性。您将学习如何将基础热力学理论（范特霍夫方程）与实验数据（浓度依赖的熔解温度 $T_m$）相结合，从而确定形成双螺旋的一个关键能量参数——标准焓变 $\\Delta H^{\\circ}$。这个练习突显了生物物理学方法在量化维持双螺旋结构稳定性的各种力方面的强大能力。[@problem_id:2557043]", "id": "2557043", "problem": "通过在总单链浓度 $C_t$（$[S]$ 与 $[S']$ 的总和）下，以等摩尔量杂交两条不同的互补单链 $S$ 和 $S'$，形成一条非自互补的脱氧核糖核酸（DNA）双链体。假设这是一个双态转变 $S + S' \\rightleftharpoons D$，其结合反应的标准热力学参数为 $\\Delta H^{\\circ}$ 和 $\\Delta S^{\\circ}$。同时假设压力恒定，离子强度固定，使得 $\\Delta H^{\\circ}$ 和 $\\Delta S^{\\circ}$ 在转变区间内不随温度变化。解链温度 $T_m$ 定义为所有单链中有一半在双链体中完成碱基配对时的温度。\n\n请仅从以下三点出发：(i) 平衡常数 $K = \\dfrac{[D]}{[S][S']}$ 的质量作用定律，(ii) 解链中点的质量守恒，以及 (iii) 范特霍夫关系式 $\\dfrac{d \\ln K}{d(1/T)} = -\\dfrac{\\Delta H^{\\circ}}{R}$，为这种双分子双链体的形成过程推导出 $1/T_m$ 和 $\\ln C_t$ 之间的线性关系。并用 $\\Delta H^{\\circ}$ 确定其斜率。\n\n实验上，对 $1/T_m$（单位为 $\\mathrm{K}^{-1}$）与 $\\ln C_t$（$C_t$ 单位为 $\\mathrm{M}$）进行线性回归，得到的斜率 $m = -\\,2.00 \\times 10^{-5}\\ \\mathrm{K}^{-1}$。利用您推导出的关系式，计算双链体形成过程的标准范特霍夫焓变 $\\Delta H^{\\circ}$。最终结果以 $\\mathrm{kJ\\ mol^{-1}}$ 为单位表示，包含适当的符号，并四舍五入至 $3$ 位有效数字。", "solution": "所述问题在科学上是合理的、自洽的且表述清晰的。它基于化学热力学的基本原理及其在核酸生物物理化学中的应用。该问题是有效的，并允许进行严格求解。\n\n问题要求为形成非自互补DNA双链体的过程，推导解链温度的倒数 $1/T_m$ 与总链浓度的自然对数 $\\ln C_t$ 之间的线性关系。然后，要求利用实验数据计算标准焓变 $\\Delta H^{\\circ}$。\n\n两条不同的互补链 $S$ 和 $S'$ 结合形成双链体 $D$ 的反应由以下平衡式给出：\n$$S + S' \\rightleftharpoons D$$\n此结合反应的平衡常数 $K$ 由质量作用定律定义为：\n$$K = \\frac{[D]}{[S][S']}$$\n其中 $[S]$、$[S']$ 和 $[D]$ 分别是平衡时单链和双链体的摩尔浓度。\n\n每种链的总浓度由质量守恒定义。由于两种链是以等摩尔量加入的，因此每种链的初始总浓度为 $C_t/2$。因此：\n$$[S]_{total} = [S] + [D] = \\frac{C_t}{2}$$\n$$[S']_{total} = [S'] + [D] = \\frac{C_t}{2}$$\n从这两个方程可以清楚地看出，在平衡状态下的任何时刻，游离单链的浓度都相等：$[S] = [S']$。\n\n解链温度 $T_m$ 被定义为总链中有一半结合成双链体时的温度。若将链视为单体单元，总浓度为 $C_t$。双链体中的链浓度为 $2[D]$。在 $T = T_m$ 时，处于双链体形式的链的分数为 $1/2$。\n$$\\frac{2[D]}{C_t} = \\frac{1}{2}$$\n根据这个条件，解链温度下的双链体浓度为：\n$$[D] = \\frac{C_t}{4}$$\n现在，我们可以利用质量守恒方程来确定在 $T = T_m$ 时游离单链的浓度：\n$$[S] = [S]_{total} - [D] = \\frac{C_t}{2} - \\frac{C_t}{4} = \\frac{C_t}{4}$$\n并且由于 $[S] = [S']$：\n$$[S'] = \\frac{C_t}{4}$$\n现在，我们可以用总浓度 $C_t$ 来表示解链温度下的平衡常数 $K(T_m)$：\n$$K(T_m) = \\frac{[D]}{[S][S']} = \\frac{C_t/4}{(C_t/4)(C_t/4)} = \\frac{1}{C_t/4} = \\frac{4}{C_t}$$\n这个方程建立了平衡常数与总链浓度之间的关系，该关系仅在对应于该浓度的解链温度 $T_m$ 时有效。\n\n为了将 $T_m$ 与 $C_t$ 联系起来，我们使用范特霍夫关系式。假设 $\\Delta H^{\\circ}$ 和 $\\Delta S^{\\circ}$ 是常数，范特霍夫方程的积分形式将平衡常数 $K$ 与温度 $T$ 联系起来：\n$$\\ln K = -\\frac{\\Delta H^{\\circ}}{RT} + \\frac{\\Delta S^{\\circ}}{R}$$\n该方程在任何温度下都成立，包括 $T_m$。问题要求从微分形式出发，即：\n$$\\frac{d \\ln K}{d(1/T)} = -\\frac{\\Delta H^{\\circ}}{R}$$\n我们已经确定，在解链温度下，$K(T_m) = 4/C_t$。取自然对数得到：\n$$\\ln K(T_m) = \\ln(4) - \\ln(C_t)$$\n由于 $T_m$ 是 $C_t$ 的函数，我们可以对这个表达式求导。让我们考虑 $C_t$ 的无穷小变化以及 $T_m$ 的相应变化。对 $\\ln K(T_m)$ 的表达式求微分，得到：\n$$d(\\ln K) = -d(\\ln C_t)$$\n根据范特霍夫方程，温度的无穷小变化 $d(1/T_m)$ 对应于平衡常数的变化 $d(\\ln K)$，关系如下：\n$$d(\\ln K) = -\\frac{\\Delta H^{\\circ}}{R} d(1/T_m)$$\n将 $d(\\ln K)$ 的两个表达式相等：\n$$-d(\\ln C_t) = -\\frac{\\Delta H^{\\circ}}{R} d(1/T_m)$$\n整理这个微分方程，得到 $1/T_m$ 关于 $\\ln C_t$ 的导数：\n$$\\frac{d(1/T_m)}{d(\\ln C_t)} = \\frac{R}{\\Delta H^{\\circ}}$$\n这个结果表明 $1/T_m$ 关于 $\\ln C_t$ 的作图是线性的，其斜率 $m$ 由下式给出：\n$$m = \\frac{R}{\\Delta H^{\\circ}}$$\n这就是推导出的线性关系以及对斜率的确定。\n\n问题的第二部分要求使用实验测定的斜率 $m = -2.00 \\times 10^{-5}\\ \\mathrm{K}^{-1}$ 来计算 $\\Delta H^{\\circ}$。理想气体常数 $R = 8.314\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$。\n从斜率的表达式中，我们求解 $\\Delta H^{\\circ}$：\n$$\\Delta H^{\\circ} = \\frac{R}{m}$$\n代入给定值：\n$$\\Delta H^{\\circ} = \\frac{8.314\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}}{-2.00 \\times 10^{-5}\\ \\mathrm{K}^{-1}}$$\n$$\\Delta H^{\\circ} = -415700\\ \\mathrm{J\\ mol^{-1}}$$\n结果为负，这是预料之中的，因为双链体的形成是一个放热过程，由氢键的形成和碱基堆积作用驱动。\n问题要求答案以 $\\mathrm{kJ\\ mol^{-1}}$ 为单位，并四舍五入到 $3$ 位有效数字。\n$$\\Delta H^{\\circ} = -415700\\ \\mathrm{J\\ mol^{-1}} \\times \\frac{1\\ \\mathrm{kJ}}{1000\\ \\mathrm{J}} = -415.7\\ \\mathrm{kJ\\ mol^{-1}}$$\n四舍五入到三位有效数字，我们得到：\n$$\\Delta H^{\\circ} \\approx -416\\ \\mathrm{kJ\\ mol^{-1}}$$\n这样就完成了所要求的计算。", "answer": "$$ \\boxed{-416} $$"}, {"introduction": "这是一项计算生物物理学领域的前沿实践，它超越了静态结构和宏观热力学。本练习深入探讨了碱基对“呼吸”的微观动力学过程，即碱基对的瞬时打开和关闭。您将通过构建和分析马尔可夫状态模型来学习如何从分子动力学模拟中提取关键的动力学速率常数（$k_\\mathrm{op}$ 和 $k_\\mathrm{cl}$），并用它们来预测可实验观测的量，例如亚氨基质子交换速率 $k_\\mathrm{ex}$，从而获得对DNA稳定性的更深层次的机理理解。[@problem_id:2557089]", "id": "2557089", "problem": "给定一组物理上合理的马尔可夫状态模型 (MSM) 规格，这些模型代表了单个脱氧核糖核酸 (DNA) 碱基对的分子动力学 (MD) 粗粒化微观状态，该碱基对可以在闭合与开放构象之间相互转换。构象的开放使亚氨基质子暴露于溶剂中，从而实现交换。您的任务是，对于每个 MSM，利用马尔可夫过程的第一性原理和 Linderstrøm–Lang 两步交换机制，计算开放宏观状态的平衡布居以及预测的亚氨基质子交换速率。所有要求的输出均为无量纲或按指定的以秒的倒数为单位，最终程序必须输出一行包含所有测试用例结果的内容。\n\n使用的基本原理和定义：\n- 延迟时间为 $\\tau$ 的离散时间 MSM 由一个行随机转移矩阵 $T(\\tau)$ 定义，该矩阵通过 $T(\\tau) = \\exp(\\tau K)$ 从一个连续时间生成元（速率）矩阵 $K$ 获得，其中 $\\exp$ 表示矩阵指数。生成元 $K$ 的非对角元素 $K_{ij} \\ge 0$（对于 $i \\ne j$），对角元素 $K_{ii} = -\\sum_{j \\ne i} K_{ij}$。\n- 稳态分布 $\\boldsymbol{\\pi}$ 满足 $\\boldsymbol{\\pi}^\\top T(\\tau) = \\boldsymbol{\\pi}^\\top$ 和 $\\sum_i \\pi_i = 1$。当 $K$ 相对于能量 $E_i$（以热能 $k_\\mathrm{B}T$ 为单位）满足细致平衡时，则有 $\\pi_i \\propto \\exp(-E_i)$。\n- 将系统粗粒化为两个宏观状态，即闭合 $\\mathcal{C}$ 和开放 $\\mathcal{O}$，定义了平衡布居 $p_\\mathcal{C} = \\sum_{i \\in \\mathcal{C}} \\pi_i$ 和 $p_\\mathcal{O} = \\sum_{i \\in \\mathcal{O}} \\pi_i$。在延迟时间 $\\tau$ 处的宏观状态转移概率由稳态分布加权平均定义：\n$$\nP_{\\mathcal{C}\\to \\mathcal{O}}(\\tau) = \\frac{1}{p_\\mathcal{C}} \\sum_{i \\in \\mathcal{C}} \\pi_i \\sum_{j \\in \\mathcal{O}} T_{ij}(\\tau), \\quad\nP_{\\mathcal{O}\\to \\mathcal{C}}(\\tau) = \\frac{1}{p_\\mathcal{O}} \\sum_{i \\in \\mathcal{O}} \\pi_i \\sum_{j \\in \\mathcal{C}} T_{ij}(\\tau).\n$$\n- 假设粗粒化的两状态动力学可以由一个连续时间两状态过程很好地描述，该过程具有开放速率常数 $k_\\mathrm{op}$ 和闭合速率常数 $k_\\mathrm{cl}$（单位均为 $\\mathrm{s}^{-1}$），并且该过程能重现在延迟时间 $\\tau$ 处的宏观状态转移概率。\n- Linderstrøm–Lang 亚氨基质子交换两步模型假设交换仅从开放状态发生，其内禀化学速率为 $k_\\mathrm{ch}$（单位为 $\\mathrm{s}^{-1}$）。可观测的交换速率常数 $k_\\mathrm{ex}$（单位为 $\\mathrm{s}^{-1}$）是开放/闭合过程与化学步骤耦合的结果。\n\n您的任务：\n1. 对于每个测试用例，根据给定的微观状态能量和具有基础尝试速率 $a_{ij}$ 的对称连接性来构建连续时间生成元 $K$，具体如下。对于每个基础速率为 $a_{ij}$ 的无向边 $(i,j)$：\n   - 设置 $K_{ij} = a_{ij}\\,\\exp\\!\\left( -\\frac{E_j - E_i}{2} \\right)$ 和 $K_{ji} = a_{ij}\\,\\exp\\!\\left( -\\frac{E_i - E_j}{2} \\right)$ 以强制满足相对于 $E_i$ 的细致平衡。\n   - 对每个 $i$ 设置 $K_{ii} = -\\sum_{j\\ne i} K_{ij}$。\n2. 计算 $T(\\tau) = \\exp(\\tau K)$，然后从 $T(\\tau)$ 计算稳态分布 $\\boldsymbol{\\pi}$。\n3. 计算平衡开放布居 $p_\\mathcal{O}$。\n4. 使用上述稳态分布加权的定义，计算宏观状态转移概率 $P_{\\mathcal{C}\\to \\mathcal{O}}(\\tau)$ 和 $P_{\\mathcal{O}\\to \\mathcal{C}}(\\tau)$。\n5. 推断有效连续时间两状态过程的速率常数 $k_\\mathrm{op}$ 和 $k_\\mathrm{cl}$ (单位为 $\\mathrm{s}^{-1}$)，该过程能精确重现在延迟时间 $\\tau$ 处的宏观状态转移概率。\n6. 使用 Linderstrøm–Lang 两步机制，从获得的 $k_\\mathrm{op}$、$k_\\mathrm{cl}$ 以及提供的 $k_\\mathrm{ch}$ 计算预测的亚氨基质子交换速率 $k_\\mathrm{ex}$ (单位为 $\\mathrm{s}^{-1}$)。\n\n将 $p_\\mathcal{O}$ 表示为无量纲分数，将 $k_\\mathrm{op}$ 和 $k_\\mathrm{ex}$ 以 $\\mathrm{s}^{-1}$ 为单位表示。将所有报告的数字四舍五入到六位小数。\n\n测试套件（所有用例的微观状态标记为 $0,1,2,3,4$，其中闭合宏观状态为 $\\mathcal{C}=\\{0,1,2\\}$，开放宏观状态为 $\\mathcal{O}=\\{3,4\\}$；延迟时间 $\\tau$ 的单位是秒；能量 $E_i$ 的单位是 $k_\\mathrm{B}T$；基础速率 $a_{ij}$ 的单位是 $\\mathrm{s}^{-1}$）：\n\n- 用例 A（稀有开放，交换受闭合限制；预期的交换机制为 $\\mathrm{EX2}$）：\n  - 能量：$[\\,0.0,\\; 0.2,\\; 0.3,\\; 4.0,\\; 4.1\\,]$。\n  - 具有基础尝试速率 $a_{ij}$ 的无向边：\n    - $\\mathcal{C}$ 内部： $(0,1):\\, 2.0\\times 10^{6}$; $(1,2):\\, 1.5\\times 10^{6}$; $(0,2):\\, 5.0\\times 10^{5}$。\n    - $\\mathcal{O}$ 内部： $(3,4):\\, 5.0\\times 10^{5}$。\n    - $\\mathcal{C}$ 和 $\\mathcal{O}$ 之间： $(2,3):\\, 2.0\\times 10^{2}$。\n  - 延迟时间： $\\tau = 1.0\\times 10^{-6}$。\n  - 内禀化学交换速率： $k_\\mathrm{ch} = 1.0\\times 10^{1}$。\n\n- 用例 B（中等程度开放，化学过程限制；预期的交换机制为 $\\mathrm{EX1}$）：\n  - 能量： $[\\,0.0,\\; 0.2,\\; 0.3,\\; 2.0,\\; 2.2\\,]$。\n  - 具有基础尝试速率 $a_{ij}$ 的无向边：\n    - $\\mathcal{C}$ 内部： $(0,1):\\, 2.0\\times 10^{6}$; $(1,2):\\, 1.5\\times 10^{6}$; $(0,2):\\, 5.0\\times 10^{5}$。\n    - $\\mathcal{O}$ 内部： $(3,4):\\, 8.0\\times 10^{5}$。\n    - $\\mathcal{C}$ 和 $\\mathcal{O}$ 之间： $(2,3):\\, 1.0\\times 10^{3}$。\n  - 延迟时间： $\\tau = 1.0\\times 10^{-6}$。\n  - 内禀化学交换速率： $k_\\mathrm{ch} = 1.0\\times 10^{5}$。\n\n- 用例 C（极其稀有的开放；预期的交换机制为 $\\mathrm{EX2}$）：\n  - 能量： $[\\,0.0,\\; 0.2,\\; 0.3,\\; 7.0,\\; 7.2\\,]$。\n  - 具有基础尝试速率 $a_{ij}$ 的无向边：\n    - $\\mathcal{C}$ 内部： $(0,1):\\, 2.0\\times 10^{6}$; $(1,2):\\, 1.5\\times 10^{6}$; $(0,2):\\, 5.0\\times 10^{5}$。\n    - $\\mathcal{O}$ 内部： $(3,4):\\, 3.0\\times 10^{5}$。\n    - $\\mathcal{C}$ 和 $\\mathcal{O}$ 之间： $(2,3):\\, 5.0\\times 10^{1}$。\n  - 延迟时间： $\\tau = 1.0\\times 10^{-6}$。\n  - 内禀化学交换速率： $k_\\mathrm{ch} = 1.0$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，包含一个结果列表，每个测试用例对应一个结果，其中每个结果本身是按 $[\\,p_\\mathcal{O},\\; k_\\mathrm{op},\\; k_\\mathrm{ex}\\,]$ 顺序排列的包含三个数字的列表。\n- 所有数字必须四舍五入到六位小数。\n- 整个输出必须以确切的格式显示在单行上：\n  - 示例结构（仅为说明）： $[[0.012345,1.234567,0.123456],[\\dots],[\\dots]]$。\n\n不应打印任何额外的文本或格式。\n\n您的程序必须实现 $K$ 的构建、 $T(\\tau)$ 的计算、 $\\boldsymbol{\\pi}$ 的评估、粗粒化、与连续时间两状态简化一致的 $k_\\mathrm{op}$ 和 $k_\\mathrm{cl}$ 的推断，以及最后 $k_\\mathrm{ex}$ 的计算，所有这些都需如上所述，基于第一性原理。所有速率必须以 $\\mathrm{s}^{-1}$ 报告，$p_\\mathcal{O}$ 是无量纲的。不涉及角度。不要使用百分号；如果需要任何小数，它们必须是无量纲的十进制小数。", "solution": "问题陈述已经过严格审查，并被确定为有效。这是一个在生物物理化学领域内良构的、有科学依据的问题，需要应用马尔可夫状态模型和化学动力学的第一性原理。所有必要的数据和定义都已提供，不存在内部矛盾或逻辑谬误。我们现在将着手提供一个完整的、合理的解决方案。\n\n该解决方案针对每个测试用例遵循一个系统性的六步流程，正如问题陈述中所描述的。微观状态的索引从 $0$ 到 $4$，其中闭合宏观状态 $\\mathcal{C}$ 包含微观状态 $\\{0, 1, 2\\}$，开放宏观状态 $\\mathcal{O}$ 包含微观状态 $\\{3, 4\\}$。\n\n第 1 步：构建连续时间生成元矩阵 K\n\n生成元矩阵 $K$，也称为速率矩阵，控制着连续时间马尔可夫过程。其非对角元素 $K_{ij}$ ($i \\ne j$) 代表从状态 $i$ 到状态 $j$ 的转移速率。对角元素 $K_{ii}$ 代表从状态 $i$ 离开的总速率，由 $K_{ii} = -\\sum_{j \\ne i} K_{ij}$ 给出。\n\n问题指定了从微观状态能量 $E_i$（以热能 $k_\\mathrm{B}T$ 为单位）和每个连接状态对 $(i,j)$ 的基础尝试速率 $a_{ij}$（单位为 $\\mathrm{s}^{-1}$）来构建 $K$。这种构建方式旨在满足细致平衡原理。对于每个基础速率为 $a_{ij}$ 的无向边 $(i,j)$， $K$ 的相应元素为：\n$$\nK_{ij} = a_{ij}\\,\\exp\\!\\left( -\\frac{E_j - E_i}{2} \\right)\n$$\n$$\nK_{ji} = a_{ij}\\,\\exp\\!\\left( -\\frac{E_i - E_j}{2} \\right)\n$$\n所有其他未指定边的非对角元素 $K_{ij}$ 均为零。在填充所有非对角元素后，对角元素计算为 $K_{ii} = -\\sum_{j \\ne i} K_{ij}$。这种构建确保系统如果任其演化，将达到一个与玻尔兹曼统计一致的平衡状态。\n\n第 2 步：计算稳态分布 $\\boldsymbol{\\pi}$ 和转移矩阵 $T(\\tau)$\n\n稳态分布 $\\boldsymbol{\\pi} = (\\pi_0, \\pi_1, \\dots, \\pi_4)$ 给出了占据每个微观状态的平衡概率。因为生成元 $K$ 的构建遵循了关于能量 $E_i$ 的细致平衡，所以稳态分布是玻尔兹曼分布。处于状态 $i$ 的概率 $\\pi_i$ 与 $\\exp(-E_i)$ 成正比。通过强制执行归一化条件 $\\sum_i \\pi_i = 1$，我们得到：\n$$\n\\pi_i = \\frac{\\exp(-E_i)}{\\sum_{j} \\exp(-E_j)}\n$$\n这种直接从能量进行的计算比数值计算转移矩阵的主特征向量更稳健、更基本。\n\n离散时间转移矩阵 $T(\\tau)$ 描述了在有限延迟时间 $\\tau$ 内状态之间转移的概率。它通过矩阵指数与生成元 $K$ 相关联：\n$$\nT(\\tau) = \\exp(\\tau K)\n$$\n其中 $\\tau$ 是给定的延迟时间。这将通过数值方法计算。\n\n第 3 步：计算平衡开放布居 $p_\\mathcal{O}$\n\n系统被粗粒化为两个宏观状态：闭合（$\\mathcal{C}$）和开放（$\\mathcal{O}$）。开放宏观状态的平衡布居 $p_\\mathcal{O}$ 是所有属于 $\\mathcal{O}$ 的微观状态的稳态概率之和。类似地，闭合宏观状态的布居是 $p_\\mathcal{C}$。\n$$\np_\\mathcal{O} = \\sum_{i \\in \\mathcal{O}} \\pi_i = \\sum_{i=3}^{4} \\pi_i\n$$\n$$\np_\\mathcal{C} = \\sum_{i \\in \\mathcal{C}} \\pi_i = \\sum_{i=0}^{2} \\pi_i = 1 - p_\\mathcal{O}\n$$\n$p_\\mathcal{O}$ 是一个关键的可观测量，代表了碱基对处于易于发生质子交换的构象的时间分数。\n\n第 4 步：计算宏观状态转移概率\n\n宏观状态转移概率 $P_{\\mathcal{C}\\to \\mathcal{O}}(\\tau)$ 和 $P_{\\mathcal{O}\\to \\mathcal{C}}(\\tau)$ 量化了在延迟时间 $\\tau$ 内，在系统处于平衡状态时，在闭合和开放宏观状态之间转换的可能性。它们使用所提供的稳态分布加权公式计算：\n$$\nP_{\\mathcal{C}\\to \\mathcal{O}}(\\tau) = \\frac{1}{p_\\mathcal{C}} \\sum_{i \\in \\mathcal{C}} \\pi_i \\sum_{j \\in \\mathcal{O}} T_{ij}(\\tau) = \\frac{\\sum_{i=0}^{2} \\sum_{j=3}^{4} \\pi_i T_{ij}(\\tau)}{p_\\mathcal{C}}\n$$\n$$\nP_{\\mathcal{O}\\to \\mathcal{C}}(\\tau) = \\frac{1}{p_\\mathcal{O}} \\sum_{i \\in \\mathcal{O}} \\pi_i \\sum_{j \\in \\mathcal{C}} T_{ij}(\\tau) = \\frac{\\sum_{i=3}^{4} \\sum_{j=0}^{2} \\pi_i T_{ij}(\\tau)}{p_\\mathcal{O}}\n$$\n细致平衡的一个推论是，宏观状态之间的总平衡通量在两个方向上是相等的，这意味着关系式 $p_\\mathcal{C} P_{\\mathcal{C}\\to \\mathcal{O}}(\\tau) = p_\\mathcal{O} P_{\\mathcal{O}\\to \\mathcal{C}}(\\tau)$ 成立。这可以作为一个有用的一致性检查。\n\n第 5 步：推断有效的两状态速率常数 $k_\\mathrm{op}$ 和 $k_\\mathrm{cl}$\n\n复杂的多状态动力学被投影到一个简单的两状态连续时间马尔可夫过程：$\\mathcal{C} \\underset{k_\\mathrm{cl}}{\\stackrel{k_\\mathrm{op}}{\\rightleftharpoons}} \\mathcal{O}$。速率 $k_\\mathrm{op}$ 和 $k_\\mathrm{cl}$ 是通过要求这个简单模型能重现在第 4 步中计算的宏观状态转移概率来推断的。对于一个两状态连续过程，在时间 $\\tau$ 内从 $\\mathcal{C}$ 转移到 $\\mathcal{O}$ 的概率由下式给出：\n$$\nP_{\\mathcal{C}\\to \\mathcal{O}}(\\tau) = p_\\mathcal{O} \\left(1 - \\exp\\left(-(k_\\mathrm{op} + k_\\mathrm{cl})\\tau\\right)\\right)\n$$\n解出速率之和 $S = k_\\mathrm{op} + k_\\mathrm{cl}$，得到：\n$$\nS = k_\\mathrm{op} + k_\\mathrm{cl} = -\\frac{1}{\\tau} \\ln\\left(1 - \\frac{P_{\\mathcal{C}\\to \\mathcal{O}}(\\tau)}{p_\\mathcal{O}}\\right)\n$$\n在宏观状态层面，细致平衡要求 $p_\\mathcal{C} k_\\mathrm{op} = p_\\mathcal{O} k_\\mathrm{cl}$。利用这个关系以及它们的和 $S$ 的表达式，我们可以解出各个速率：\n$$\nk_\\mathrm{op} = S \\cdot p_\\mathcal{O} \\quad \\text{和} \\quad k_\\mathrm{cl} = S \\cdot p_\\mathcal{C}\n$$\n这些方程提供了单位为 $\\mathrm{s}^{-1}$ 的有效开放和闭合速率。\n\n第 6 步：计算预测的亚氨基质子交换速率 $k_\\mathrm{ex}$\n\n最后一步是使用 Linderstrøm-Lang 两步模型预测实验上可观测的亚氨基质子交换速率 $k_\\mathrm{ex}$。该模型假设交换只能从开放状态发生，其内禀化学速率为 $k_\\mathrm{ch}$。动力学方案是：\n$$\n\\text{闭合} \\underset{k_\\mathrm{cl}}{\\stackrel{k_\\mathrm{op}}{\\rightleftharpoons}} \\text{开放} \\xrightarrow{k_\\mathrm{ch}} \\text{已交换}\n$$\n对瞬态的“开放”中间体应用稳态近似，我们推导出可观测交换速率常数 $k_\\mathrm{ex}$ 的表达式：\n$$\nk_\\mathrm{ex} = \\frac{k_\\mathrm{op} k_\\mathrm{ch}}{k_\\mathrm{cl} + k_\\mathrm{ch}}\n$$\n该公式将构象动力学（$k_\\mathrm{op}$、$k_\\mathrm{cl}$）与化学反应步骤（$k_\\mathrm{ch}$）耦合起来。我们可以区分两种极限情况：\n- EX2 机制（$k_\\mathrm{cl} \\gg k_\\mathrm{ch}$）：$k_\\mathrm{ex} \\approx k_\\mathrm{op} (k_\\mathrm{ch}/k_\\mathrm{cl}) = K_\\mathrm{eq} k_\\mathrm{ch} = (p_\\mathcal{O}/p_\\mathcal{C}) k_\\mathrm{ch}$，其中交换受限于开放-闭合平衡。\n- EX1 机制（$k_\\mathrm{cl} \\ll k_\\mathrm{ch}$）：$k_\\mathrm{ex} \\approx k_\\mathrm{op}$，其中每一次开放事件都会导致成功的交换，总速率受限于开放速率。\n\n通过对每个给定的测试用例实施这六个步骤，我们可以计算出所需的量：$p_\\mathcal{O}$、$k_\\mathrm{op}$ 和 $k_\\mathrm{ex}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all specified test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"energies\": np.array([0.0, 0.2, 0.3, 4.0, 4.1]),\n            \"edges\": [\n                (0, 1, 2.0e6), (1, 2, 1.5e6), (0, 2, 5.0e5),  # Within C\n                (3, 4, 5.0e5),                               # Within O\n                (2, 3, 2.0e2)                                # Between C and O\n            ],\n            \"lag_time\": 1.0e-6,\n            \"k_ch\": 1.0e1\n        },\n        {\n            \"name\": \"Case B\",\n            \"energies\": np.array([0.0, 0.2, 0.3, 2.0, 2.2]),\n            \"edges\": [\n                (0, 1, 2.0e6), (1, 2, 1.5e6), (0, 2, 5.0e5),  # Within C\n                (3, 4, 8.0e5),                               # Within O\n                (2, 3, 1.0e3)                                # Between C and O\n            ],\n            \"lag_time\": 1.0e-6,\n            \"k_ch\": 1.0e5\n        },\n        {\n            \"name\": \"Case C\",\n            \"energies\": np.array([0.0, 0.2, 0.3, 7.0, 7.2]),\n            \"edges\": [\n                (0, 1, 2.0e6), (1, 2, 1.5e6), (0, 2, 5.0e5),  # Within C\n                (3, 4, 3.0e5),                               # Within O\n                (2, 3, 5.0e1)                                # Between C and O\n            ],\n            \"lag_time\": 1.0e-6,\n            \"k_ch\": 1.0\n        }\n    ]\n\n    # Common parameters for all cases\n    num_states = 5\n    closed_states = [0, 1, 2]\n    open_states = [3, 4]\n\n    results = []\n    for case in test_cases:\n        energies = case[\"energies\"]\n        edges = case[\"edges\"]\n        tau = case[\"lag_time\"]\n        k_ch = case[\"k_ch\"]\n\n        # Step 1: Construct the generator matrix K\n        K = np.zeros((num_states, num_states))\n        for i, j, a_ij in edges:\n            delta_E = energies[j] - energies[i]\n            K[i, j] = a_ij * np.exp(-delta_E / 2.0)\n            K[j, i] = a_ij * np.exp(delta_E / 2.0)\n        \n        for i in range(num_states):\n            K[i, i] = -np.sum(K[i, :])\n\n        # Step 2: Compute stationary distribution pi and transition matrix T(tau)\n        boltzmann_factors = np.exp(-energies)\n        partition_func = np.sum(boltzmann_factors)\n        pi = boltzmann_factors / partition_func\n        \n        T_tau = expm(K * tau)\n\n        # Step 3: Compute equilibrium open population p_O\n        p_O = np.sum(pi[open_states])\n        p_C = 1.0 - p_O\n\n        # Step 4: Compute macrostate transition probabilities\n        flux_C_to_O = 0.0\n        for i in closed_states:\n            for j in open_states:\n                flux_C_to_O += pi[i] * T_tau[i, j]\n        \n        # Guard against division by zero if a macrostate is unpopulated\n        if p_C > 0:\n            P_C_to_O_tau = flux_C_to_O / p_C\n        else:\n            P_C_to_O_tau = 0.0\n\n        # Step 5: Infer rate constants k_op and k_cl\n        # The argument to log must be positive.\n        # This requires P_C_to_O_tau < p_O.\n        # This is guaranteed by the physics of the model as long as states are connected\n        # and populations are non-zero.\n        if p_O > 0 and (1.0 - P_C_to_O_tau / p_O) > 0:\n            sum_of_rates = - (1.0 / tau) * np.log(1.0 - P_C_to_O_tau / p_O)\n        else: # Handle limit cases if necessary\n            sum_of_rates = 0.0\n            \n        k_op = sum_of_rates * p_O\n        k_cl = sum_of_rates * p_C\n\n        # Step 6: Compute exchange rate k_ex\n        if (k_cl + k_ch) > 0:\n            k_ex = (k_op * k_ch) / (k_cl + k_ch)\n        else:\n            k_ex = 0.0\n            \n        results.append([p_O, k_op, k_ex])\n\n    # Format the final output string as required\n    results_str = [f\"[{r[0]:.6f},{r[1]:.6f},{r[2]:.6f}]\" for r in results]\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"}]}