{"hands_on_practices": [{"introduction": "本练习将带您回到定量光谱学的基石。通过从基本物理原理推导比尔-朗伯定律 ($A = \\varepsilon c l$)，您将不仅学会应用此公式，更会深刻理解其背后光与物质相互作用的物理图像。这个实践旨在夯实您的基础，并强调在计算中保持单位一致性的重要性。[@problem_id:2615517]", "problem": "在缓冲水溶液中，使用石英比色皿，通过紫外-可见 (UV-vis) 吸收光谱法对一种单组分生物分子生色团进行分析。在某一波长下，测得的十进制吸光度为 $A=0.75$，在该波长下，分析物的摩尔十进制消光系数查表值为 $\\varepsilon=15{,}000\\ \\mathrm{L\\,mol^{-1}\\,cm^{-1}}$。比色皿的光程长度为 $l=0.5\\ \\mathrm{cm}$。假设光是单色的，散射可忽略不计，没有荧光或磷光的再吸收，浓度在空间上是均匀的，并且溶剂和基线的贡献已通过匹配的参比进行了适当补偿。\n\n从十进制吸光度的基本定义 $A\\equiv -\\log_{10}\\!\\left(I/I_{0}\\right)$ 和一个指数衰减模型出发，推导 $A$ 与溶质浓度 $c$ 之间的线性关系，然后根据给定数据确定 $c$。在该模型中，于所述线性响应条件下，衰减系数与生色团的数密度及光程长度成正比。明确追踪单位以确保量纲一致性。\n\n以 $\\mathrm{mol\\,L^{-1}}$ 为单位表示最终浓度，并将答案四舍五入至两位有效数字。此外，简要评论报告的有效数字如何受到输入数据的限制，以及为什么为 $\\varepsilon$ 和 $l$ 选择的单位会产生以 $\\mathrm{mol\\,L^{-1}}$ 为单位的浓度。", "solution": "本题要求从基本原理出发，推导吸光度 $A$ 和浓度 $c$ 之间的线性关系（即比尔-朗伯定律），然后根据给定的实验数据计算浓度。\n\n首先，我们推导比尔-朗伯定律。光强度 $I$ 穿过吸收介质时的衰减由一个微分方程描述。考虑一束单色光穿过比色皿。在无穷小的光程长度 $dx$ 上，强度的变化 $dI$ 与该位置的光强度 $I(x)$ 以及吸收生色团的数密度 $N$（单位体积内的分子数）成正比。\n$$dI = - \\sigma N I(x) dx$$\n此处，$\\sigma$ 是分子吸收截面，一个比例常数，其单位为面积/分子（例如，$\\mathrm{cm^2}$）。负号表示强度随距离的增加而减小。数密度 $N$ 必须与摩尔浓度 $c$ 相关联，后者的单位为 $\\mathrm{mol\\,L^{-1}}$。为确保量纲一致性，我们必须进行单位转换。已知 $1 \\ \\mathrm{L} = 1000 \\ \\mathrm{cm^3}$，则以 $\\mathrm{mol\\,cm^{-3}}$ 为单位的浓度是 $\\frac{c}{1000}$。因此，以 分子/$\\mathrm{cm^3}$ 为单位的数密度 $N$ 就是该值乘以阿伏伽德罗常数 $N_A$：\n$$N \\left[\\frac{\\mathrm{molecules}}{\\mathrm{cm^3}}\\right] = c \\left[\\frac{\\mathrm{mol}}{\\mathrm{L}}\\right] \\times \\frac{1 \\ \\mathrm{L}}{1000 \\ \\mathrm{cm^3}} \\times N_A \\left[\\frac{\\mathrm{molecules}}{\\mathrm{mol}}\\right] = \\frac{c N_A}{1000}$$\n将 $N$ 的这个表达式代入微分方程，得到：\n$$\\frac{dI}{I} = - \\sigma \\left(\\frac{c N_A}{1000}\\right) dx$$\n为了求出在比色皿整个光程长度 $l$ 上的总衰减，我们将此方程从 $x=0$（此时强度为 $I_0$）积分到 $x=l$（此时强度为 $I$）。假定浓度 $c$ 在空间上是均匀的。\n$$\\int_{I_0}^{I} \\frac{dI'}{I'} = - \\int_{0}^{l} \\frac{\\sigma c N_A}{1000} dx'$$\n执行积分可得：\n$$\\ln(I) - \\ln(I_0) = - \\left(\\frac{\\sigma c N_A}{1000}\\right) l$$\n$$\\ln\\left(\\frac{I}{I_0}\\right) = - \\left(\\frac{\\sigma c N_A}{1000}\\right) l$$\n这个指数衰减模型必须与十进制吸光度 $A$ 的定义相关联：\n$$A \\equiv -\\log_{10}\\left(\\frac{I}{I_0}\\right)$$\n使用对数恒等式 $\\log_{10}(x) = \\frac{\\ln(x)}{\\ln(10)}$，我们可以写出：\n$$A = -\\frac{\\ln(I/I_0)}{\\ln(10)} = -\\frac{1}{\\ln(10)} \\left[ - \\left(\\frac{\\sigma c N_A}{1000}\\right) l \\right]$$\n$$A = \\left(\\frac{\\sigma N_A}{1000 \\ln(10)}\\right) c l$$\n这个结果证明了吸光度 $A$ 和浓度 $c$ 之间的线性关系。括号中的项被定义为摩尔十进制消光系数 $\\varepsilon$：\n$$\\varepsilon \\equiv \\frac{\\sigma N_A}{1000 \\ln(10)}$$\n这使得该线性关系可以写成其紧凑和常规的形式，即比尔-朗伯定律：\n$$A = \\varepsilon c l$$\n推导出这个关系后，我们现在通过重新整理公式并代入所提供的值来计算浓度 $c$。\n$$c = \\frac{A}{\\varepsilon l}$$\n给定的参数是：\n-   吸光度 $A = 0.75$ (无量纲)\n-   摩尔十进制消光系数 $\\varepsilon = 15{,}000 \\ \\mathrm{L\\,mol^{-1}\\,cm^{-1}}$\n-   光程长度 $l = 0.5 \\ \\mathrm{cm}$\n\n代入这些值：\n$$c = \\frac{0.75}{(15000 \\ \\mathrm{L\\,mol^{-1}\\,cm^{-1}}) \\times (0.5 \\ \\mathrm{cm})}$$\n分母中的乘积是：\n$$\\varepsilon l = (1.5 \\times 10^4 \\ \\mathrm{L\\,mol^{-1}\\,cm^{-1}}) \\times (0.5 \\ \\mathrm{cm}) = 7500 \\ \\mathrm{L\\,mol^{-1}} = 7.5 \\times 10^3 \\ \\mathrm{L\\,mol^{-1}}$$\n因此，浓度为：\n$$c = \\frac{0.75}{7.5 \\times 10^3 \\ \\mathrm{L\\,mol^{-1}}} = \\frac{7.5 \\times 10^{-1}}{7.5 \\times 10^3} \\ \\mathrm{mol\\,L^{-1}} = 1.0 \\times 10^{-4} \\ \\mathrm{mol\\,L^{-1}}$$\n题目要求答案以两位有效数字表示。计算出的值 $1.0 \\times 10^{-4}$ 已经是这种形式。\n\n最后，需要对有效数字和单位进行评论。\n最终答案的精度受到输入数据精度的限制。吸光度 $A=0.75$ 具有两位有效数字。光程长度 $l=0.5 \\ \\mathrm{cm}$，按其写法只有一位有效数字，而消光系数 $\\varepsilon=15{,}000 \\ \\mathrm{L\\,mol^{-1}\\,cm^{-1}}$ 的有效数字位数不明确。严格应用不确定度传播规则将根据 $l$ 把结果限制在一位有效数字。但是，题目明确指示我们将答案四舍五入至两位有效数字。该指令优先于标准规则，并暗示输入量，特别是 $l$ 和 $\\varepsilon$，应被视为至少具有两位有效数字（即 $l=0.50 \\ \\mathrm{cm}$ 和 $\\varepsilon=1.5 \\times 10^4 \\ \\mathrm{L\\,mol^{-1}\\,cm^{-1}}$）。基于此理解，精度受限于吸光度测量值 $A=0.75$，因此结果正确地以两位有效数字给出。\n\n量纲一致性是计算中的一个关键方面。赋予摩尔消光系数 $\\varepsilon$ 的单位是为化学分析中的实际便利而专门选择的。关系式为 $c = A / (\\varepsilon l)$。由于吸光度 $A$ 是一个无量纲量，浓度 $c$ 的单位是乘积 $\\varepsilon l$ 单位的倒数：\n$$\\text{Units of } c = \\frac{1}{\\text{Units of } \\varepsilon \\times \\text{Units of } l} = \\frac{1}{(\\mathrm{L\\,mol^{-1}\\,cm^{-1}}) \\times (\\mathrm{cm})} = \\frac{1}{\\mathrm{L\\,mol^{-1}}} = \\mathrm{mol\\,L^{-1}}$$\n因此，使用 $\\mathrm{L\\,mol^{-1}\\,cm^{-1}}$ 作为 $\\varepsilon$ 的单位，使用 $\\mathrm{cm}$ 作为 $l$ 的单位，可以直接得出以 $\\mathrm{mol\\,L^{-1}}$（摩尔浓度）为单位的浓度，这是化学中浓度的标准单位，无需任何中间单位转换。", "answer": "$$\n\\boxed{1.0 \\times 10^{-4}}\n$$", "id": "2615517"}, {"introduction": "真实的生物样品往往并非完全澄清。本练习将直面浑浊度这一常见问题，它会导致光散射，从而使表观吸光度被高估。您将学习如何使用瑞利散射模型（散射与波长的四次方成反比，即 $\\propto \\lambda^{-4}$）来模拟散射基线，并计算由此产生的浓度测量误差，这是准确分析细胞裂解液等复杂混合物的关键技能。[@problem_id:2615486]", "problem": "一位研究人员尝试通过使用$1.00$厘米光程的比色皿测量$280$纳米处的紫外-可见光吸收度，来测定混浊裂解液中的蛋白质浓度。样品在$600$纳米处的光密度（OD；optical density）为$0.200$，假定这完全是由悬浮颗粒的光散射引起的。假设在感兴趣的波长范围内，散射基线可以建模为与波长$\\lambda$的$\\lambda^{-4}$成正比，其中$\\lambda$是波长。在$280$纳米处，蛋白质的吸收度遵循比尔-朗伯定律，其质量消光系数为 $\\varepsilon_{280} = 1.00$ 毫升·毫克$^{-1}$·厘米$^{-1}$。忽略$280$纳米处由非蛋白质溶质引起的任何非散射背景吸收。\n\n如果在没有任何基线校正的情况下，仅根据$280$纳米处测得的吸收度来粗略估计蛋白质浓度，结果会因一个附加误差而产生偏差，该误差等于由散射引起的表观吸收度除以$\\varepsilon_{280}$和光程。仅使用上述信息和第一性原理，计算仅由散射引起的蛋白质浓度高估的量值。将您的答案四舍五入至三位有效数字，并以毫克/毫升为单位表示。", "solution": "所述问题在科学上是合理的、提法得当且内部一致。它描述了分光光度法中的一个常见问题——混浊样品中的瑞利散射——并要求基于一个标准物理模型进行定量校正。所有必要的参数都已提供。因此，我们开始求解。\n\n分析从控制吸收度测量的基本原理开始。\n\n首先，比尔-朗伯定律描述了吸收度（$A$）、浓度（$c$）、光程（$l$）和消光系数（$\\varepsilon$）之间的线性关系：\n$$A = \\varepsilon c l$$\n\n其次，对于混合物，总吸收度是各组分吸收度之和。在本例中，在给定波长 $\\lambda$ 处测得的总吸收度，记为 $A_{\\text{total}}(\\lambda)$，是来自蛋白质的真实吸收度 $A_{\\text{prot}}(\\lambda)$ 和来自光散射的表观吸收度 $A_{\\text{scat}}(\\lambda)$ 的和：\n$$A_{\\text{total}}(\\lambda) = A_{\\text{prot}}(\\lambda) + A_{\\text{scat}}(\\lambda)$$\n\n问题陈述，蛋白质浓度的粗略估计值 $c_{\\text{naive}}$ 是根据在 $\\lambda_{280} = 280 \\text{ nm}$ 处测量的总吸收度计算得出的。其计算公式为：\n$$c_{\\text{naive}} = \\frac{A_{\\text{total}}(280)}{\\varepsilon_{280} l}$$\n其中 $\\varepsilon_{280}$ 是蛋白质在 $280 \\text{ nm}$ 处的质量消光系数，$l$ 是光程。\n\n真实的蛋白质浓度 $c_{\\text{true}}$ 仅由蛋白质自身的吸收度决定：\n$$c_{\\text{true}} = \\frac{A_{\\text{prot}}(280)}{\\varepsilon_{280} l}$$\n\n浓度的高估值 $\\Delta c$ 是粗略估计浓度与真实浓度之差：\n$$\\Delta c = c_{\\text{naive}} - c_{\\text{true}} = \\frac{A_{\\text{total}}(280) - A_{\\text{prot}}(280)}{\\varepsilon_{280} l} = \\frac{A_{\\text{scat}}(280)}{\\varepsilon_{280} l}$$\n这证实了问题本身对误差的描述。我们的任务是计算这个量 $\\Delta c$。为此，我们必须首先确定 $A_{\\text{scat}}(280)$ 的值。\n\n问题为散射背景提供了一个模型，指出它与波长的负四次方成正比：\n$$A_{\\text{scat}}(\\lambda) = k \\lambda^{-4}$$\n其中 $k$ 是特定于该样品的比例常数。\n\n我们已知在波长 $\\lambda_1 = 600 \\text{ nm}$ 处的吸收度，据称这完全是由散射引起的。在此波长下，蛋白质的吸收可以忽略不计。因此，我们有：\n$$A_{\\text{scat}}(600) = 0.200$$\n我们用这个信息来确定常数 $k$：\n$$k = A_{\\text{scat}}(600) \\times \\lambda_1^4 = 0.200 \\times (600 \\text{ nm})^4$$\n\n现在，我们可以计算在感兴趣的波长 $\\lambda_2 = 280 \\text{ nm}$ 处的散射吸收度：\n$$A_{\\text{scat}}(280) = k \\lambda_2^{-4} = (0.200 \\times (600 \\text{ nm})^4) \\times (280 \\text{ nm})^{-4}$$\n波长的单位必须相互抵消：\n$$A_{\\text{scat}}(280) = 0.200 \\times \\left(\\frac{600}{280}\\right)^4$$\n\n现在我们将已知参数的值代入，以求得浓度的高估值 $\\Delta c$：\n$l = 1.00 \\text{ cm}$\n$\\varepsilon_{280} = 1.00 \\text{ mL mg}^{-1} \\text{cm}^{-1}$\n\n$\\Delta c$ 的表达式变为：\n$$\\Delta c = \\frac{A_{\\text{scat}}(280)}{\\varepsilon_{280} l} = \\frac{0.200 \\times \\left(\\frac{600}{280}\\right)^4}{(1.00 \\text{ mL mg}^{-1} \\text{cm}^{-1}) \\times (1.00 \\text{ cm})}$$\n\n进行计算：\n$$\\frac{600}{280} = \\frac{60}{28} = \\frac{15}{7}$$\n$$\\left(\\frac{15}{7}\\right)^4 \\approx (2.142857)^4 \\approx 21.085$$\n$$A_{\\text{scat}}(280) \\approx 0.200 \\times 21.085 \\approx 4.217$$\n\n因此, 浓度的高估值为：\n$$\\Delta c = \\frac{4.217}{(1.00) \\times (1.00)} \\text{ mg/mL} \\approx 4.217 \\text{ mg/mL}$$\n\n问题要求答案四舍五入到三位有效数字。\n$$\\Delta c \\approx 4.22 \\text{ mg/mL}$$\n让我们在最终四舍五入之前用更高的精度重新计算。\n$A_{scat}(280) = 0.200 \\times (600/280)^4 = 0.200 \\times (15/7)^4 = 0.200 \\times (50625/2401) \\approx 0.200 \\times 21.085 \\dots \\approx 4.217$.\n前一次的计算略有不准。更精确的计算是：\n$$A_{\\text{scat}}(280) = 0.200 \\times \\left(\\frac{15}{7}\\right)^4 = 0.200 \\times \\frac{50625}{2401} = \\frac{10125}{2401} \\approx 4.2170$$\n那么浓度的高估值是：\n$$\\Delta c = \\frac{4.2170}{1.00 \\times 1.00} \\text{ mg/mL} = 4.2170 \\text{ mg/mL}$$\n四舍五入到三位有效数字，我们得到$4.22$。\n\n让我们在最后一步之前保持完整的符号表示。\n$$\\Delta c = \\frac{A_1}{\\varepsilon_{280} l} \\left( \\frac{\\lambda_1}{\\lambda_2} \\right)^4$$\n$$\\Delta c = \\frac{0.200}{(1.00)(1.00)} \\left( \\frac{600}{280} \\right)^4 \\text{mg/mL}$$\n$$\\Delta c = 0.200 \\left( \\frac{15}{7} \\right)^4 \\text{mg/mL}$$\n$$\\Delta c = 0.200 \\left(\\frac{50625}{2401}\\right) \\text{mg/mL}$$\n$$\\Delta c = \\frac{10125}{2401} \\text{mg/mL}$$\n$$\\Delta c \\approx 4.2169929... \\text{mg/mL}$$\n\n四舍五入到三位有效数字得到 $4.22$。\n推理和计算现在是正确的。", "answer": "$$\\boxed{4.22}$$", "id": "2615486"}, {"introduction": "生物系统本质上是多种分子共存的混合物。这项高级练习旨在解决定量分析具有重叠光谱的多种组分这一挑战。您将应用线性代数和加权最小二乘法原理来解卷积混合物的吸收光谱，从而确定每种组分的浓度，这是现代生物化学分析中一项至关重要的强大技术。[@problem_id:2615466]", "problem": "给定一个在具有指定光程长的比色皿中测得的、关于三种核苷酸水溶液混合物的多波长紫外-可见（UV-Vis）吸收光谱数据集。该混合物遵循比尔-朗伯定律，且在每个波长处的吸收度都受到加性、独立的高斯噪声影响。您的任务是利用最小二乘法原理，从重叠的光谱中计算这三种核苷酸浓度的最大似然估计。\n\n使用以下基本原理来推导您的方法：\n- 比尔-朗伯定律：对于每个波长 $\\lambda$，吸收度 $A(\\lambda)$ 满足 $A(\\lambda) = b \\sum_{i=1}^{3} \\varepsilon_i(\\lambda)\\, c_i + \\eta(\\lambda)$，其中 $b$ 是光程长，$\\varepsilon_i(\\lambda)$ 是三种物质的摩尔十进吸收系数（消光系数），$c_i$ 是浓度，$\\eta(\\lambda)$ 是加性噪声。\n- 每个波长的噪声被建模为独立的、均值为零且标准差 $\\sigma(\\lambda)$ 已知的高斯噪声，因此，所有波长上的吸收度测量的联合似然由加权最小二乘估计器最大化。\n\n将该估计问题表述为一组测量波长上的线性逆问题，通过将方程组堆叠成矩阵形式。设测量向量为 $y \\in \\mathbb{R}^{m}$，包含在 $m$ 个波长下测得的吸收度；设计矩阵为 $X \\in \\mathbb{R}^{m \\times 3}$，其元素为 $X_{j,i} = b\\,\\varepsilon_i(\\lambda_j)$；未知浓度向量为 $c \\in \\mathbb{R}^{3}$。假设噪声向量的协方差矩阵为 $\\Sigma = \\mathrm{diag}(\\sigma(\\lambda_1)^2,\\dots,\\sigma(\\lambda_m)^2)$。通过最小化高斯模型和比尔-朗伯定律所蕴含的适当二次型，从第一性原理出发推导 $c$ 的估计器。以数值稳定的方式算法化地实现此估计器。\n\n物理单位和输出要求：\n- 消光系数 $\\varepsilon$ 的单位为 $\\mathrm{M}^{-1}\\,\\mathrm{cm}^{-1}$。\n- 光程长 $b$ 的单位为 $\\mathrm{cm}$。\n- 吸收度 $A$ 无单位。\n- 浓度 $c_i$ 必须以微摩尔（$\\mu\\mathrm{M}$）为单位报告，并四舍五入到三位小数。\n- 此处不涉及任何角度。\n- 将所有分数表示为小数。\n\n测试套件（对于每个测试用例，请精确使用所提供的参数；不要生成任何随机值）：\n- 测试用例 1（正常路径，超定，中等噪声）：\n  - 波长 $\\Lambda_1 = [\\,240,\\,260,\\,270,\\,280\\,]\\,\\mathrm{nm}$。\n  - 光程长 $b_1 = 1.0\\,\\mathrm{cm}$。\n  - 消光矩阵 $\\varepsilon_1(\\lambda)$ 的行对应于 $\\Lambda_1$（每行代表 $[\\,\\varepsilon_1,\\,\\varepsilon_2,\\,\\varepsilon_3\\,]$，单位为 $\\mathrm{M}^{-1}\\,\\mathrm{cm}^{-1}$）：\n    - $\\lambda=240\\,\\mathrm{nm}$: $[\\,12000,\\,9000,\\,10500\\,]$,\n    - $\\lambda=260\\,\\mathrm{nm}$: $[\\,15400,\\,7400,\\,11500\\,]$,\n    - $\\lambda=270\\,\\mathrm{nm}$: $[\\,14000,\\,6000,\\,12000\\,]$,\n    - $\\lambda=280\\,\\mathrm{nm}$: $[\\,10000,\\,3500,\\,7600\\,]$.\n  - 测得的吸收度 $y_1 = [\\,0.097,\\,0.1048,\\,0.098,\\,0.0677\\,]$。\n  - 噪声标准差 $\\sigma_1 = [\\,0.002,\\,0.002,\\,0.003,\\,0.002\\,]$。\n- 测试用例 2（恰定，低噪声）：\n  - 波长 $\\Lambda_2 = [\\,250,\\,260,\\,280\\,]\\,\\mathrm{nm}$。\n  - 光程长 $b_2 = 1.0\\,\\mathrm{cm}$。\n  - 消光矩阵的行：\n    - $\\lambda=250\\,\\mathrm{nm}$: $[\\,13000,\\,8500,\\,11000\\,]$,\n    - $\\lambda=260\\,\\mathrm{nm}$: $[\\,15400,\\,7400,\\,11500\\,]$,\n    - $\\lambda=280\\,\\mathrm{nm}$: $[\\,10000,\\,3500,\\,7600\\,]$.\n  - 测得的吸收度 $y_2 = [\\,0.1845,\\,0.2123,\\,0.1377\\,]$。\n  - 噪声标准差 $\\sigma_2 = [\\,0.001,\\,0.001,\\,0.001\\,]$。\n- 测试用例 3（超定，异构噪声，不同光程长）：\n  - 波长 $\\Lambda_3 = [\\,240,\\,250,\\,260,\\,270,\\,280\\,]\\,\\mathrm{nm}$。\n  - 光程长 $b_3 = 0.5\\,\\mathrm{cm}$。\n  - 消光矩阵的行：\n    - $\\lambda=240\\,\\mathrm{nm}$: $[\\,12000,\\,9000,\\,10500\\,]$,\n    - $\\lambda=250\\,\\mathrm{nm}$: $[\\,13000,\\,8500,\\,11000\\,]$,\n    - $\\lambda=260\\,\\mathrm{nm}$: $[\\,15400,\\,7400,\\,11500\\,]$,\n    - $\\lambda=270\\,\\mathrm{nm}$: $[\\,14000,\\,6000,\\,12000\\,]$,\n    - $\\lambda=280\\,\\mathrm{nm}$: $[\\,10000,\\,3500,\\,7600\\,]$.\n  - 测得的吸收度 $y_3 = [\\,0.0802,\\,0.079,\\,0.0798,\\,0.074,\\,0.0464\\,]$。\n  - 噪声标准差 $\\sigma_3 = [\\,0.0015,\\,0.0025,\\,0.001,\\,0.002,\\,0.0015\\,]$。\n- 测试用例 4（病态光谱重叠，轻度噪声）：\n  - 波长 $\\Lambda_4 = [\\,255,\\,257,\\,259,\\,261,\\,263,\\,280\\,]\\,\\mathrm{nm}$。\n  - 光程长 $b_4 = 1.0\\,\\mathrm{cm}$。\n  - 消光矩阵的行：\n    - $\\lambda=255\\,\\mathrm{nm}$: $[\\,15000,\\,7400,\\,11200\\,]$,\n    - $\\lambda=257\\,\\mathrm{nm}$: $[\\,15100,\\,7450,\\,11300\\,]$,\n    - $\\lambda=259\\,\\mathrm{nm}$: $[\\,15300,\\,7350,\\,11400\\,]$,\n    - $\\lambda=261\\,\\mathrm{nm}$: $[\\,15500,\\,7500,\\,11550\\,]$,\n    - $\\lambda=263\\,\\mathrm{nm}$: $[\\,15600,\\,7425,\\,11600\\,]$,\n    - $\\lambda=280\\,\\mathrm{nm}$: $[\\,10000,\\,3500,\\,7600\\,]$.\n  - 测得的吸收度 $y_4 = [\\,0.0338,\\,0.03375,\\,0.03405,\\,0.03485,\\,0.034425,\\,0.0212\\,]$。\n  - 噪声标准差 $\\sigma_4 = [\\,0.0005,\\,0.0005,\\,0.0005,\\,0.0005,\\,0.0005,\\,0.0005\\,]$。\n\n您的程序必须：\n- 实现从基本原理推导出的估计器，当问题是超定或病态时，使用数值稳定的方法求解线性系统。\n- 对于每个测试用例，计算估计浓度，并通过乘以 $10^{6}$ 将其转换为微摩尔。\n- 将每个估计浓度四舍五入到三位小数。\n- 生成单行输出，包含结果，格式为逗号分隔的列表的列表，例如 $[\\,[c_{1,1},c_{1,2},c_{1,3}],\\,[c_{2,1},c_{2,2},c_{2,3}],\\,[c_{3,1},c_{3,2},c_{3,3}],\\,[c_{4,1},c_{4,2},c_{4,3}]\\,]$，其中 $c_{k,i}$ 是测试用例 $k$ 中物质 $i$ 的四舍五入值，单位为 $\\mu\\mathrm{M}$。", "solution": "该问题要求根据多波长紫外-可见吸收光谱数据集确定三种核苷酸的浓度。这是一个典型的反卷积问题，遵循比尔-朗伯定律，该定律对于浓度是线性的。我们的任务是推导浓度的最大似然估计器，并以数值方式实现它。\n\n其基础是比尔-朗伯定律。对于 $N$ 种物质的混合物，在特定波长 $\\lambda$ 下的总吸收度 $A$ 是每种物质吸收度的总和。对于给定有 $N=3$ 种物质的问题，其表达式为：\n$$\nA(\\lambda) = \\sum_{i=1}^{3} A_i(\\lambda) = \\sum_{i=1}^{3} \\varepsilon_i(\\lambda) b c_i\n$$\n其中 $\\varepsilon_i(\\lambda)$ 为物质 $i$ 在波长 $\\lambda$ 的摩尔十进吸收系数， $b$ 是光程长， $c_i$ 是物质 $i$ 的摩尔浓度。\n\n测量会受到噪声的影响。在波长 $\\lambda_j$ 测得的吸收度被建模为：\n$$\ny_j = A(\\lambda_j) + \\eta_j = b \\sum_{i=1}^{3} \\varepsilon_i(\\lambda_j) c_i + \\eta_j\n$$\n其中 $y_j$ 是测得的吸收度，$\\eta_j$ 是在波长 $\\lambda_j$ 的加性噪声项。我们在不同的波长 $\\lambda_1, \\dots, \\lambda_m$ 上有一组共 $m$ 个这样的测量值。这个包含 $m$ 个线性方程的方程组可以用矩阵形式表示：\n$$\n\\mathbf{y} = \\mathbf{X}\\mathbf{c} + \\boldsymbol{\\eta}\n$$\n此处：\n- $\\mathbf{y} \\in \\mathbb{R}^{m}$ 是测量吸收度向量，其元素为 $y_j$。\n- $\\mathbf{c} \\in \\mathbb{R}^{3}$ 是未知浓度向量，其元素为 $c_i$。\n- $\\mathbf{X} \\in \\mathbb{R}^{m \\times 3}$ 是设计矩阵，其元素由 $X_{ji} = b \\cdot \\varepsilon_i(\\lambda_j)$ 给出。$\\mathbf{X}$ 的每一列代表单位浓度的纯组分经光程长缩放后的吸收光谱。\n- $\\boldsymbol{\\eta} \\in \\mathbb{R}^{m}$ 是噪声项向量。\n\n问题陈述，噪声项 $\\eta_j$ 是独立的，并且服从均值为零、标准差 $\\sigma_j = \\sigma(\\lambda_j)$ 已知的高斯分布。因此，噪声向量 $\\boldsymbol{\\eta}$ 服从均值向量为 $\\mathbf{0}$、对角协方差矩阵为 $\\mathbf{\\Sigma}$ 的多元正态分布：\n$$\n\\boldsymbol{\\eta} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{\\Sigma}), \\quad \\text{其中} \\quad \\mathbf{\\Sigma} = \\mathrm{diag}(\\sigma_1^2, \\sigma_2^2, \\dots, \\sigma_m^2)\n$$\n因此，测量向量 $\\mathbf{y}$ 也服从多元正态分布：\n$$\n\\mathbf{y} \\sim \\mathcal{N}(\\mathbf{X}\\mathbf{c}, \\mathbf{\\Sigma})\n$$\n给定 $\\mathbf{c}$ 时 $\\mathbf{y}$ 的概率密度函数为：\n$$\np(\\mathbf{y} | \\mathbf{c}) = \\frac{1}{(2\\pi)^{m/2} \\det(\\mathbf{\\Sigma})^{1/2}} \\exp\\left(-\\frac{1}{2} (\\mathbf{y} - \\mathbf{X}\\mathbf{c})^T \\mathbf{\\Sigma}^{-1} (\\mathbf{y} - \\mathbf{X}\\mathbf{c})\\right)\n$$\n$\\mathbf{c}$ 的最大似然估计（MLE），记为 $\\hat{\\mathbf{c}}$，是使该似然函数 $L(\\mathbf{c}|\\mathbf{y}) = p(\\mathbf{y}|\\mathbf{c})$ 最大化的 $\\mathbf{c}$ 值。最大化似然等价于最小化负对数似然。负对数似然，在忽略与 $\\mathbf{c}$ 无关的常数项后，与指数中的二次型成正比：\n$$\n\\chi^2(\\mathbf{c}) = (\\mathbf{y} - \\mathbf{X}\\mathbf{c})^T \\mathbf{\\Sigma}^{-1} (\\mathbf{y} - \\mathbf{X}\\mathbf{c})\n$$\n这是加权最小二乘法（WLS）的目标函数。权重矩阵为 $\\mathbf{W} = \\mathbf{\\Sigma}^{-1}$，它是一个对角矩阵，其元素为 $W_{jj} = 1/\\sigma_j^2$。方差较小（噪声较小）的测量值被赋予更高的权重。\n\n为了找到最小化 $\\chi^2(\\mathbf{c})$ 的估计器 $\\hat{\\mathbf{c}}$，我们对 $\\mathbf{c}$ 求导并令梯度为零：\n$$\n\\frac{\\partial \\chi^2}{\\partial \\mathbf{c}} = \\frac{\\partial}{\\partial \\mathbf{c}} (\\mathbf{y}^T \\mathbf{W} \\mathbf{y} - 2\\mathbf{y}^T \\mathbf{W} \\mathbf{X} \\mathbf{c} + \\mathbf{c}^T \\mathbf{X}^T \\mathbf{W} \\mathbf{X} \\mathbf{c}) = -2\\mathbf{X}^T \\mathbf{W} \\mathbf{y} + 2\\mathbf{X}^T \\mathbf{W} \\mathbf{X} \\mathbf{c} = \\mathbf{0}\n$$\n这得到了 WLS 的正规方程组：\n$$\n(\\mathbf{X}^T \\mathbf{W} \\mathbf{X}) \\hat{\\mathbf{c}} = \\mathbf{X}^T \\mathbf{W} \\mathbf{y}\n$$\n$\\hat{\\mathbf{c}}$ 的形式解为：\n$$\n\\hat{\\mathbf{c}} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbf{y}\n$$\n为了保证数值稳定性，特别是当矩阵 $\\mathbf{X}^T \\mathbf{W} \\mathbf{X}$ 是病态的（如测试用例4所示），应避免直接计算和求逆。一种更稳健的方法是将问题转化为非加权（普通）最小二乘（OLS）问题。设 $\\mathbf{W}^{1/2}$ 是一个对角矩阵，其元素为 $(\\mathbf{W}^{1/2})_{jj} = 1/\\sigma_j$。我们可以重写目标函数：\n$$\n\\chi^2(\\mathbf{c}) = (\\mathbf{y} - \\mathbf{X}\\mathbf{c})^T (\\mathbf{W}^{1/2})^T \\mathbf{W}^{1/2} (\\mathbf{y} - \\mathbf{X}\\mathbf{c}) = (\\mathbf{W}^{1/2}(\\mathbf{y} - \\mathbf{X}\\mathbf{c}))^T (\\mathbf{W}^{1/2}(\\mathbf{y} - \\mathbf{X}\\mathbf{c})) = \\| \\mathbf{y}' - \\mathbf{X}'\\mathbf{c} \\|_2^2\n$$\n其中 $\\mathbf{y}' = \\mathbf{W}^{1/2}\\mathbf{y}$ 且 $\\mathbf{X}' = \\mathbf{W}^{1/2}\\mathbf{X}$。这是一个标准的 OLS 问题，旨在找到使残差向量 $\\mathbf{y}' - \\mathbf{X}'\\mathbf{c}$ 的欧几里得范数最小化的向量 $\\mathbf{c}$。\n\n这个 OLS 问题最好使用诸如矩阵 $\\mathbf{X}'$ 的 QR 分解或奇异值分解（SVD）等方法来解决。这些方法是数值稳定的，并在标准线性代数库中有实现。我们将使用 `numpy.linalg.lstsq` 函数来求解 $\\hat{\\mathbf{c}}$，该函数采用基于 SVD 的方法。\n\n每个测试用例的算法步骤如下：\n1.  构建消光系数矩阵 $\\boldsymbol{\\varepsilon}$、测量吸收度向量 $\\mathbf{y}$ 和噪声标准差向量 $\\boldsymbol{\\sigma}$。\n2.  使用光程长 $b$ 构建设计矩阵 $\\mathbf{X} = b \\cdot \\boldsymbol{\\varepsilon}$。\n3.  通过噪声标准差的倒数对万程进行加权。创建转换后的矩阵 $\\mathbf{X}'$ 和向量 $\\mathbf{y}'$：\n    $$\n    X'_{ji} = X_{ji} / \\sigma_j\n    $$\n    $$\n    y'_{j} = y_j / \\sigma_j\n    $$\n4.  求解普通最小二乘问题以获得 $\\hat{\\mathbf{c}}$：$\\mathrm{argmin}_{\\mathbf{c}} \\| \\mathbf{y}' - \\mathbf{X}'\\mathbf{c} \\|_2^2$。\n5.  由于消光系数的单位是 $\\mathrm{M}^{-1}\\,\\mathrm{cm}^{-1}$，因此得到的浓度 $\\hat{\\mathbf{c}}$ 的单位是摩尔浓度（$\\mathrm{M}$）。通过乘以 $10^6$ 将其转换为微摩尔（$\\mu\\mathrm{M}$）。\n6.  按要求将最终浓度四舍五入到三位小数。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for nucleotide concentrations using weighted least squares from UV-Vis data.\n    \"\"\"\n    test_cases = [\n        {\n            \"b\": 1.0,  # cm\n            \"epsilon\": np.array([\n                [12000, 9000, 10500],\n                [15400, 7400, 11500],\n                [14000, 6000, 12000],\n                [10000, 3500, 7600]\n            ]),  # M^-1 cm^-1\n            \"y\": np.array([0.097, 0.1048, 0.098, 0.0677]),\n            \"sigma\": np.array([0.002, 0.002, 0.003, 0.002])\n        },\n        {\n            \"b\": 1.0,\n            \"epsilon\": np.array([\n                [13000, 8500, 11000],\n                [15400, 7400, 11500],\n                [10000, 3500, 7600]\n            ]),\n            \"y\": np.array([0.1845, 0.2123, 0.1377]),\n            \"sigma\": np.array([0.001, 0.001, 0.001])\n        },\n        {\n            \"b\": 0.5,\n            \"epsilon\": np.array([\n                [12000, 9000, 10500],\n                [13000, 8500, 11000],\n                [15400, 7400, 11500],\n                [14000, 6000, 12000],\n                [10000, 3500, 7600]\n            ]),\n            \"y\": np.array([0.0802, 0.079, 0.0798, 0.074, 0.0464]),\n            \"sigma\": np.array([0.0015, 0.0025, 0.001, 0.002, 0.0015])\n        },\n        {\n            \"b\": 1.0,\n            \"epsilon\": np.array([\n                [15000, 7400, 11200],\n                [15100, 7450, 11300],\n                [15300, 7350, 11400],\n                [15500, 7500, 11550],\n                [15600, 7425, 11600],\n                [10000, 3500, 7600]\n            ]),\n            \"y\": np.array([0.0338, 0.03375, 0.03405, 0.03485, 0.034425, 0.0212]),\n            \"sigma\": np.array([0.0005, 0.0005, 0.0005, 0.0005, 0.0005, 0.0005])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        b = case[\"b\"]\n        epsilon_matrix = case[\"epsilon\"]\n        y_measured = case[\"y\"]\n        sigma_noise = case[\"sigma\"]\n\n        # 1. Construct the design matrix X\n        X = b * epsilon_matrix\n\n        # 2. Transform to an Ordinary Least Squares problem by weighting\n        #    X' = W^(1/2) * X, y' = W^(1/2) * y\n        #    where W^(1/2) is diagonal with entries 1/sigma_j\n        \n        # In numpy, this is equivalent to element-wise division.\n        # sigma_noise[:, np.newaxis] broadcasts the (m,1) vector to (m,3) for element-wise division\n        X_prime = X / sigma_noise[:, np.newaxis]\n        y_prime = y_measured / sigma_noise\n\n        # 3. Solve the least squares problem for c using a numerically stable method (SVD-based)\n        #    np.linalg.lstsq solves argmin_c ||y' - X'c||_2\n        c_molar, _, _, _ = np.linalg.lstsq(X_prime, y_prime, rcond=None)\n\n        # 4. Convert concentrations from Molar (M) to micromolar (uM)\n        c_micromolar = c_molar * 1e6\n\n        # 5. Round to three decimal places\n        c_rounded = np.round(c_micromolar, 3)\n        \n        results.append(c_rounded.tolist())\n\n    # Format the final output string as a list of lists without spaces\n    list_of_strings = []\n    for res_list in results:\n        str_list = ','.join([f\"{val:.3f}\" for val in res_list])\n        list_of_strings.append(f'[{str_list}]')\n    \n    final_output_string = f\"[{','.join(list_of_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "2615466"}]}