{"hands_on_practices": [{"introduction": "量化色谱柱的效率是评估其性能的基础。本练习将引导您将被分析物在柱内经历的物理扩散与其在色谱图上最终呈现的峰形联系起来。通过从第一性原理出发，结合柱长（$L$）和流动相线速度（$u$）等基本参数推导理论塔板数（$N$）的表达式，您将对决定色谱柱效率的因素获得超越最终峰形的更深层次理解。[@problem_id:2589535]", "problem": "一溶质从长度为 $L$ 的等度色谱柱中洗脱，其峰形可很好地用高斯形状近似。谱带沿色谱柱在空间域中的方差记为 $\\sigma_{x}^{2}$。塔板高度 $H$ 由基本关系式 $H = \\sigma_{x}^{2}/L$ 定义，塔板数则为 $N = L/H$。在色谱图上，峰的基线宽度（定义为高斯函数返回到基线的两点之间的宽度）在时间域中测量为 $w_{b}$。流动相的间隙线速度为 $u$，且柱外和检测器展宽可忽略不计。假设为线性传输，使得轴向坐标和时间满足 $x = u\\,t$，并使用将时间域中的基线宽度和标准差联系起来的高斯恒等式 $w_{b} = 4\\,\\sigma_{t}$。\n\n已知 $L = 0.1000\\ \\mathrm{m}$，$u = 0.002000\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$，$w_{b} = 5.000\\ \\mathrm{s}$，请仅使用上述基本定义和假设，推导用 $L$、$u$ 和 $w_{b}$ 表示 $N$ 的表达式，然后计算其值。将最终结果四舍五入至四位有效数字。将 $N$ 表示为无单位的纯数。", "solution": "根据严格的规程对题目陈述进行验证。\n\n首先，逐字提取已知条件。\n- 溶质从长度为 $L$ 的等度色谱柱中洗脱。\n- 峰形可很好地用高斯形状近似。\n- 谱带在空间域中的方差为 $\\sigma_{x}^{2}$。\n- 塔板高度定义为 $H = \\sigma_{x}^{2}/L$。\n- 塔板数定义为 $N = L/H$。\n- 峰在时间域中的基线宽度为 $w_{b}$。\n- 流动相的间隙线速度为 $u$。\n- 柱外和检测器展宽可忽略不计。\n- 线性传输假设将轴向坐标 $x$ 和时间 $t$ 通过 $x = u\\,t$ 联系起来。\n- 一个高斯恒等式将时间域中的基线宽度和标准差联系起来： $w_{b} = 4\\,\\sigma_{t}$。\n- 提供的数值为：$L = 0.1000\\ \\mathrm{m}$，$u = 0.002000\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$，$w_{b} = 5.000\\ \\mathrm{s}$。\n- 任务是推导用 $L$、$u$ 和 $w_{b}$ 表示 $N$ 的表达式，并计算其值至四位有效数字。\n\n接下来，验证题目的科学合理性和一致性。\n该题目基于色谱理论的基本原理。塔板高度 $H$ 和塔板数 $N$ 的定义是标准的。使用高斯模型描述峰形是一种常见且有效的近似方法。线性关系 $x = u\\,t$ 是理想色谱中的一个正确假设。基线宽度的描述性文本（“高斯函数返回到基线的两点之间的宽度”）中存在一个微小的不精确之处，因为真正的高斯函数仅渐近地接近基线。然而，题目立即通过提供明确的定量定义 $w_{b} = 4\\,\\sigma_{t}$ 纠正了这一点，这是该领域的标准惯例。这使得该问题适定且无歧义。所提供的数据是完整的、一致的且符合物理现实的。因此，该问题被认为是有效的，可以构建解答。\n\n目标是求出塔板数 $N$。我们从给定的定义开始：\n$$N = \\frac{L}{H}$$\n$$H = \\frac{\\sigma_{x}^{2}}{L}$$\n将 $H$ 的表达式代入 $N$ 的表达式，得到一个用柱长 $L$ 和空间方差 $\\sigma_{x}^{2}$ 表示塔板数的替代表达式：\n$$N = \\frac{L}{(\\sigma_{x}^{2}/L)} = \\frac{L^{2}}{\\sigma_{x}^{2}}$$\n该方程使用空间域中的方差（单位为长度的平方）来表示 $N$。而测量量 $w_{b}$ 是在时间域中。因此需要在两个域之间进行转换。题目指出空间坐标 $x$ 和时间坐标 $t$ 之间的关系是线性的：\n$$x = u\\,t$$\n其中 $u$ 是恒定的线速度。对于一个由随机变量描述的分布，这种线性变换将两个域中的方差关联如下：\n$$\\sigma_{x}^{2} = \\mathrm{Var}(x) = \\mathrm{Var}(u\\,t) = u^{2}\\mathrm{Var}(t) = u^{2}\\sigma_{t}^{2}$$\n现在，我们必须将时间方差 $\\sigma_{t}^{2}$ 与给定的可观测量 $w_{b}$ 联系起来。题目指明了高斯峰的关系：\n$$w_{b} = 4\\,\\sigma_{t}$$\n由此，我们求解时间标准差 $\\sigma_{t}$ 和时间方差 $\\sigma_{t}^{2}$：\n$$\\sigma_{t} = \\frac{w_{b}}{4}$$\n$$\\sigma_{t}^{2} = \\left(\\frac{w_{b}}{4}\\right)^{2} = \\frac{w_{b}^{2}}{16}$$\n现在我们将 $\\sigma_{t}^{2}$ 的表达式代入关联空间和时间方差的方程中：\n$$\\sigma_{x}^{2} = u^{2} \\left(\\frac{w_{b}^{2}}{16}\\right) = \\frac{u^{2}w_{b}^{2}}{16}$$\n最后，我们将空间方差 $\\sigma_{x}^{2}$ 的表达式代入塔板数 $N$ 的方程中：\n$$N = \\frac{L^{2}}{\\sigma_{x}^{2}} = \\frac{L^{2}}{(u^{2}w_{b}^{2}/16)}$$\n简化此表达式，得到用 $L$、$u$ 和 $w_{b}$ 表示 $N$ 的所需关系式：\n$$N = 16\\left(\\frac{L}{u w_{b}}\\right)^{2}$$\n符号表达式的推导至此完成。\n\n下一步是使用所提供的数据计算 $N$ 的数值：\n$L = 0.1000\\ \\mathrm{m}$\n$u = 0.002000\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$w_{b} = 5.000\\ \\mathrm{s}$\n\n首先，我们计算乘积 $u w_{b}$：\n$$u w_{b} = (0.002000\\ \\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (5.000\\ \\mathrm{s}) = 0.01000\\ \\mathrm{m}$$\n单位正确地得到米，与 $L$ 的单位相匹配。\n现在，我们将这些值代入推导出的 $N$ 表达式中：\n$$N = 16\\left(\\frac{0.1000\\ \\mathrm{m}}{0.01000\\ \\mathrm{m}}\\right)^{2}$$\n括号内的比值是无量纲的：\n$$\\frac{0.1000}{0.01000} = 10.00$$\n继续计算 $N$：\n$$N = 16 \\times (10.00)^{2} = 16 \\times 100.0 = 1600$$\n输入值 $L$、$u$ 和 $w_{b}$ 均给出四位有效数字。常数 16 是由定义 $w_b = 4\\sigma_t$ 推导出的精确数。因此，乘积 $u w_b$ 有四位有效数字（$0.01000$），比值 $L/(uw_b)$ 有四位有效数字（$10.00$），其平方有四位有效数字（$100.0$），最终结果应报告为四位有效数字。计算值恰好为 1600。在这种情况下，这个数字有四位有效数字。\n塔板数 $N$ 是一个无量纲的量。计算值为 1600。", "answer": "$$\n\\boxed{1600}\n$$", "id": "2589535"}, {"introduction": "实现分离是色谱分析的首要目标，而分离度（$R_s$）由三个关键因素决定：柱效（$N$）、保留（$k$）和选择性（$\\alpha$）。本练习聚焦于一个关键挑战——峰的完全共流出，并要求您从根本上分析为何调整选择性是首要策略。通过推导和计算，您将深刻领会为何简单地更换一根更高效率的色谱柱往往无法解决问题，而调整 $\\alpha$ 才是解决复杂分离难题的根本出发点。[@problem_id:2589559]", "problem": "在两种结构相似的肽分析物的反相高效液相色谱（RP-HPLC）分析中，您观察到在当前条件下它们完全共流出。您计划通过改变溶液的pH值或固定相的化学性质来调节选择性因子 $\\alpha$，同时保持塔板数 $N$ 和特征容量因子 $k$ 基本不变。\n\n严格地从保留时间、容量因子、理论塔板和色谱分离度的基本定义出发，完成以下任务：\n\n1) 利用以下关系式：(i) 分析物 $i$ 的保留时间为 $t_{R,i} = t_{0}\\,(1 + k_{i})$，其中 $t_{0}$ 为死时间，$k_{i}$ 为容量因子；(ii) 高斯峰的基线宽度为 $w_{b,i} \\approx 4\\,\\sigma_{i}$，其中 $\\sigma_{i}$ 为时间标准偏差；(iii) 理论塔板数满足 $N_{i} = \\left(t_{R,i}/\\sigma_{i}\\right)^{2}$；以及 (iv) 色谱分离度为 $R_{s} = \\dfrac{t_{R,2} - t_{R,1}}{\\tfrac{1}{2}\\left(w_{b,1} + w_{b,2}\\right)}$，推导出 $R_{s}$ 关于 $N$（假设 $N_{1} = N_{2} = N$）、$k_{1}$ 和选择性因子 $\\alpha \\equiv k_{2}/k_{1}$ 的显式表达式。\n\n2) 使用您推导出的表达式，从第一性原理的层面解释，为什么当分析物共流出时（即 $\\alpha = 1$），要实现分离必须优先调节 $\\alpha$，而不是改变 $N$ 和 $k$。\n\n3) 在 $N = 16000$ 和 $k_{1} = 2.00$ 的条件下，定量评估当选择性因子乘以因子1.05（即新的 $\\alpha = 1.05$）后预期的分离度。假设 $N$ 和 $k_{1}$ 在调节选择性后保持不变，并且上述高斯峰假设仍然成立。以无单位的纯数形式报告 $R_{s}$，并四舍五入到四位有效数字。", "solution": "对所述问题进行严格验证。\n\n步骤1：提取已知条件。\n- 该系统涉及两种分析物（索引为 $i=1$ 和 $i=2$）的反相高效液相色谱（RP-HPLC）分析。\n- 初始条件：分析物完全共流出。\n- 目标是调节选择性因子 $\\alpha$。\n- 假定塔板数 $N$ 和容量因子 $k$ “基本不变”。\n- 关系 (i)：保留时间为 $t_{R,i} = t_{0}\\,(1 + k_{i})$，其中 $t_{0}$ 为死时间，$k_{i}$ 为容量因子。\n- 关系 (ii)：高斯峰基线宽度为 $w_{b,i} \\approx 4\\,\\sigma_{i}$，其中 $\\sigma_{i}$ 为时间标准偏差。\n- 关系 (iii)：理论塔板数为 $N_{i} = \\left(t_{R,i}/\\sigma_{i}\\right)^{2}$。\n- 关系 (iv)：色谱分离度为 $R_{s} = \\dfrac{t_{R,2} - t_{R,1}}{\\tfrac{1}{2}\\left(w_{b,1} + w_{b,2}\\right)}$。\n- 推导所用假设：$N_{1} = N_{2} = N$。\n- 选择性因子定义：$\\alpha \\equiv k_{2}/k_{1}$。\n- 共流出的初始条件对应于 $\\alpha = 1$。\n- 用于定量评估的参数：新 $\\alpha = 1.05$，$N = 16000$，$k_{1} = 2.00$。\n\n步骤2：问题陈述的验证。\n该问题具有科学依据，提法明确且客观。它完全基于色谱理论的基本、标准定义和原理。所给出的方程式和参数在分析化学领域是标准的。该问题是自洽的，没有信息缺失或内部矛盾。所提供的数值（$N=16000$, $k=2.00$）对于HPLC系统是物理上现实的。该任务是一个标准的教科书练习，旨在测试对控制色谱分离度的因素的理解。\n\n步骤3：结论。\n该问题被认定为有效。将构建一个解决方案。\n\n按照要求，问题分三部分进行解答。\n\n1) 分离度表达式的推导。\n我们从给定的色谱分离度 $R_{s}$ 的定义开始：\n$$R_{s} = \\dfrac{t_{R,2} - t_{R,1}}{\\tfrac{1}{2}\\left(w_{b,1} + w_{b,2}\\right)}$$\n分子代表峰顶的分离程度。使用给定关系式 $t_{R,i} = t_{0}\\,(1 + k_{i})$，分子变为：\n$$t_{R,2} - t_{R,1} = t_{0}(1+k_{2}) - t_{0}(1+k_{1}) = t_{0}(k_{2} - k_{1})$$\n分母代表平均峰宽。首先，我们必须用塔板数 $N_i$ 来表示基线宽度 $w_{b,i}$。从定义式 $N_{i} = (t_{R,i}/\\sigma_{i})^{2}$，我们得到标准偏差 $\\sigma_{i} = t_{R,i}/\\sqrt{N_{i}}$。将此代入基线宽度的表达式 $w_{b,i} = 4\\sigma_{i}$，得到：\n$$w_{b,i} = \\frac{4t_{R,i}}{\\sqrt{N_{i}}}$$\n现在，我们将此表达式用于分离度方程的分母，并应用所述假设 $N_{1} = N_{2} = N$：\n$$\\tfrac{1}{2}\\left(w_{b,1} + w_{b,2}\\right) = \\tfrac{1}{2}\\left(\\frac{4t_{R,1}}{\\sqrt{N}} + \\frac{4t_{R,2}}{\\sqrt{N}}\\right) = \\frac{2}{\\sqrt{N}}(t_{R,1} + t_{R,2})$$\n将分子和分母的表达式代回分离度方程，得到：\n$$R_{s} = \\dfrac{t_{0}(k_{2} - k_{1})}{\\frac{2}{\\sqrt{N}}(t_{R,1} + t_{R,2})} = \\frac{\\sqrt{N}}{2} \\frac{t_{0}(k_{2} - k_{1})}{t_{R,1} + t_{R,2}}$$\n为了只用 $N$、$k_1$ 和 $\\alpha$ 来表示 $R_{s}$，我们将 $t_{R,i} = t_{0}(1+k_i)$ 代入此中间表达式的分母：\n$$t_{R,1} + t_{R,2} = t_{0}(1+k_{1}) + t_{0}(1+k_{2}) = t_{0}(2 + k_{1} + k_{2})$$\n这导出：\n$$R_{s} = \\frac{\\sqrt{N}}{2} \\frac{t_{0}(k_{2} - k_{1})}{t_{0}(2 + k_{1} + k_{2})} = \\frac{\\sqrt{N}}{2} \\frac{k_{2} - k_{1}}{2 + k_{1} + k_{2}}$$\n最后，我们引入选择性因子 $\\alpha = k_{2}/k_{1}$，这意味着 $k_{2} = \\alpha k_{1}$。将其代入方程，得到最终表达式：\n$$R_{s} = \\frac{\\sqrt{N}}{2} \\frac{\\alpha k_{1} - k_{1}}{2 + k_{1} + \\alpha k_{1}} = \\frac{\\sqrt{N}}{2} \\frac{k_{1}(\\alpha-1)}{2 + k_{1}(1+\\alpha)}$$\n这就是严格从所给定义推导出的 $R_{s}$ 的表达式。\n\n2) 关于选择性因子 $\\alpha$ 首要性的解释。\n推导出的分离度表达式是与柱效（$N$）、分析物保留（$k_1$）和选择性（$\\alpha$）相关的项的乘积：\n$$R_{s} = \\left(\\frac{\\sqrt{N}}{2}\\right) \\left(\\frac{k_{1}}{2 + k_{1}(1+\\alpha)}\\right) \\left(\\alpha-1\\right)$$\n根据定义，共流出意味着分析物具有相同的保留时间，因此具有相同的容量因子：$k_{1} = k_{2}$。因此，选择性因子 $\\alpha = k_{2}/k_{1}$ 精确等于1。\n如果我们将 $\\alpha=1$ 代入推导出的分离度表达式中：\n$$R_{s} = \\frac{\\sqrt{N}}{2} \\frac{k_{1}(1-1)}{2 + k_{1}(1+1)} = \\frac{\\sqrt{N}}{2} \\frac{k_{1} \\cdot 0}{2 + 2k_{1}} = 0$$\n这个结果是决定性的。无论塔板数 $N$ 或容量因子 $k_1$ 的值是多少（只要它们是有限的），分离度都为零。$(\\alpha-1)$ 项起到了分离的乘法开关的作用。如果 $\\alpha=1$，该项为零，迫使整个乘积 $R_s$ 为零。人们可以想象无限高效的色谱柱（$N \\to \\infty$）产生无限窄的峰，但如果没有选择性（$\\alpha=1$），这些峰仍然会完全重叠，导致分离度为零。因此，要实现任何程度的分离（即，使 $R_{s} > 0$），绝对必要的是使 $\\alpha \\neq 1$。增加 $N$ 或优化 $k$ 是改善现有分离的次要调整；它们无法从完全共流出的状态中创造出分离。建立选择性（$\\alpha > 1$）是基本先决条件。\n\n3) 分离度的定量评估。\n我们使用第(1)部分推导的表达式，并代入所给的数值：$N = 16000$，$k_{1} = 2.00$，以及新的选择性因子 $\\alpha = 1.05$。\n表达式为：\n$$R_{s} = \\frac{\\sqrt{N}}{2} \\frac{k_{1}(\\alpha-1)}{2 + k_{1}(1+\\alpha)}$$\n代入数值：\n$$R_{s} = \\frac{\\sqrt{16000}}{2} \\frac{2.00(1.05-1)}{2 + 2.00(1+1.05)}$$\n我们分别计算各项。塔板数的平方根是：\n$$\\sqrt{16000} = \\sqrt{1600 \\times 10} = 40\\sqrt{10} \\approx 126.4911$$\n分数项的分子是：\n$$2.00(1.05-1) = 2.00(0.05) = 0.100$$\n分数项的分母是：\n$$2 + 2.00(1+1.05) = 2 + 2.00(2.05) = 2 + 4.10 = 6.10$$\n合并这些结果：\n$$R_{s} = \\frac{126.4911}{2} \\left(\\frac{0.100}{6.10}\\right) \\approx 63.24555 \\times 0.01639344 \\approx 1.03669$$\n按照要求将结果四舍五入到四位有效数字，我们得到分离度的最终数值答案。\n$$R_s \\approx 1.037$$", "answer": "$$\\boxed{1.037}$$", "id": "2589559"}, {"introduction": "现代色谱方法开发是一种系统性工程，需要在分离质量与分析时间、系统压力等实际限制之间取得平衡。这个综合性顶石练习要求您构建一个计算模型来描绘可行的“设计空间”。通过整合塔板高度（van Deemter）、保留（线性溶剂强度）和压力（Kozeny-Carman）的理论模型，您将模拟如何寻找满足分离度和压力双重标准的最佳操作条件（$u$, $\\phi$），这是高级色谱实践中的一项核心技能。[@problem_id:2589640]", "problem": "要求您编写一个完整的程序，通过将基于物理的塔板模型与标准仪器约束相结合，来绘制填充柱上二元等度分离的色谱设计空间。请从以下基本原理出发，您必须使用这些原理来推导您在程序中实现的任何关系。\n\n- 塔板模型中的定义：理论塔板高度 $H$ 和塔板数 $N$ 满足 $H = L/N$，其中 $L$ 是填充床长度。\n- 等度条件下填充床的 van Deemter 关系式：塔板高度取决于间隙线性速度 $u_i$，其关系为 $H(u_i) = A + \\frac{B}{u_i} + C \\, u_i$。\n- 用于反相等度保留的线性溶剂强度模型：对于参数为 $\\log_{10} k_{0,i}$ 和 $S_i$ 的分析物 $i$，其保留因子满足 $\\log_{10} k_i(\\phi) = \\log_{10} k_{0,i} - S_i \\, \\phi$，其中 $\\phi$ 是有机相的体积分数。\n- 选择性和洗脱顺序的定义：对于在给定 $\\phi$ 下具有保留因子 $k_1(\\phi)$ 和 $k_2(\\phi)$ 的两种分析物，早洗脱组分的保留因子为 $k_{\\text{early}}(\\phi) = \\min\\{k_1(\\phi), k_2(\\phi)\\}$，晚洗脱组分的保留因子为 $k_{\\text{late}}(\\phi) = \\max\\{k_1(\\phi), k_2(\\phi)\\}$，选择性为 $\\alpha(\\phi) = \\frac{k_{\\text{late}}(\\phi)}{k_{\\text{early}}(\\phi)}$。\n- 使用 Kozeny–Carman 形式计算填充床中层流的压降：对于孔隙率为 $\\varepsilon$、颗粒直径为 $d_p$ 的填充床，在表观（Darcy）流速为 $u$ 时的压降 $\\Delta P$ 为 $\\Delta P(u,\\phi) = f(\\varepsilon) \\, \\eta(\\phi) \\, \\frac{L}{d_p^2} \\, u$，其中 $f(\\varepsilon) = 180 \\, \\frac{(1-\\varepsilon)^2}{\\varepsilon^3}$，$\\eta(\\phi)$ 是流动相的动力粘度。间隙流速和表观流速的关系为 $u_i = \\frac{u}{\\varepsilon}$。\n- 水-乙腈混合物的粘度模型，适用于粘度非理想性可用对数混合表示的温度条件：$\\ln \\eta(\\phi) = (1 - \\phi) \\, \\ln \\eta_w + \\phi \\, \\ln \\eta_a$，其中 $\\eta_w$ 和 $\\eta_a$ 分别是水和乙腈的纯组分动力粘度。所有粘度单位必须是帕斯卡-秒。\n\n仅使用上述基本原理，推导一个色谱分离度 $R_s$ 的可计算表达式，该表达式依赖于塔板数 $N$、选择性 $\\alpha$ 和晚洗脱分析物的保留因子 $k_{\\text{late}}$。然后，将其与 van Deemter 关系式和线性溶剂强度模型相结合，以表达 $R_s$ 作为 $u$ 和 $\\phi$ 的函数，并将 Kozeny–Carman 关系式与粘度模型相结合，以表达 $\\Delta P$ 作为 $u$ 和 $\\phi$ 的函数。您的最终程序必须：\n\n- 为每个测试用例在 $(u,\\phi)$ 平面上构建一个均匀的矩形网格。\n- 在每个网格点 $(u,\\phi)$，使用 $u_i = \\frac{u}{\\varepsilon}$ 通过 van Deemter 关系式计算塔板数 $N(u)$，通过线性溶剂强度模型计算 $k_1(\\phi)$ 和 $k_2(\\phi)$，并由此确定 $k_{\\text{late}}(\\phi)$ 和 $\\alpha(\\phi)$，然后根据您推导的表达式计算 $R_s(u,\\phi)$。同时，根据对数混合规则计算 $\\eta(\\phi)$，并计算单位为帕斯卡的 $\\Delta P(u,\\phi)$。\n- 确定由 $R_s(u,\\phi) \\geq 1.5$ 和 $\\Delta P(u,\\phi) \\leq \\Delta P_{\\max}$ 这两个同步约束条件定义的设计空间区域，其中 $\\Delta P_{\\max}$ 是一个固定的仪器极限。使用 $\\Delta P_{\\max} = 600$ bar。使用 $1$ bar $= 10^5$ 帕斯卡将此极限转换为帕斯卡，即与 $6 \\times 10^7$ 帕斯卡进行比较。\n- 对于每个测试用例，返回一个标量值，该值等于满足两个约束条件的网格点所占的比例。此比例是无量纲的，并且必须以闭区间 $[0,1]$ 内的浮点数形式报告。\n\n科学和计算要求：\n\n- 所有计算都必须使用统一的单位制：长度单位为米，速度单位为米/秒，粘度单位为帕斯卡-秒，压力单位为帕斯卡。\n- 计算中不涉及角度，最终输出中也没有百分比；任何分数形式的量都必须以小数表示。\n- 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[0.42,0.07,1.0]$），列表中的结果与下面给出的测试用例一一对应。\n\n测试套件（每个用例都是独立的；请严格使用所提供的参数）：\n\n- 测试用例1（理想路径，中等柱效，在 $\\phi$ 范围中间有具挑战性的选择性交叉）：\n  - 柱与填充床：$L = 0.10$ m, $d_p = 1.7 \\times 10^{-6}$ m, $\\varepsilon = 0.40$。\n  - van Deemter：$A = 2.0 \\times 10^{-6}$ m, $B = 1.6 \\times 10^{-9}$ m$^2$ s$^{-1}$, $C = 4.0 \\times 10^{-3}$ s。\n  - 分析物1：$\\log_{10} k_{0,1} = 1.30$, $S_1 = 3.00$。\n  - 分析物2：$\\log_{10} k_{0,2} = 1.60$, $S_2 = 4.00$。\n  - 粘度端点值：$\\eta_w = 8.90 \\times 10^{-4}$ Pa s, $\\eta_a = 3.70 \\times 10^{-4}$ Pa s。\n  - 网格：$\\phi \\in [0.10, 0.60]$，含 $41$ 个均等间隔点；$u \\in [2.0 \\times 10^{-4}, 1.2 \\times 10^{-3}]$ m s$^{-1}$，含 $41$ 个均等间隔点。\n\n- 测试用例2（边界条件，柱长减半）：\n  - 柱与填充床：$L = 0.050$ m, $d_p = 1.7 \\times 10^{-6}$ m, $\\varepsilon = 0.40$。\n  - van Deemter、分析物和粘度端点值与测试用例1相同。\n  - 网格与测试用例1相同。\n\n- 测试用例3（较大颗粒和略有不同的弥散参数）：\n  - 柱与填充床：$L = 0.10$ m, $d_p = 2.6 \\times 10^{-6}$ m, $\\varepsilon = 0.40$。\n  - van Deemter：$A = 3.0 \\times 10^{-6}$ m, $B = 2.0 \\times 10^{-9}$ m$^2$ s$^{-1}$, $C = 3.0 \\times 10^{-3}$ s。\n  - 分析物与测试用例1相同。\n  - 粘度端点值与测试用例1相同。\n  - 网格：$\\phi \\in [0.05, 0.60]$，含 $36$ 个均等间隔点；$u \\in [3.0 \\times 10^{-4}, 1.5 \\times 10^{-3}]$ m s$^{-1}$，含 $41$ 个均等间隔点。\n\n- 测试用例4（边缘案例，选择性对比度弱）：\n  - 柱与填充床：$L = 0.10$ m, $d_p = 1.7 \\times 10^{-6}$ m, $\\varepsilon = 0.40$。\n  - van Deemter 与测试用例1相同。\n  - 分析物1：$\\log_{10} k_{0,1} = 1.40$, $S_1 = 3.20$。\n  - 分析物2：$\\log_{10} k_{0,2} = 1.41$, $S_2 = 3.30$。\n  - 粘度端点值与测试用例1相同。\n  - 网格：$\\phi \\in [0.05, 0.60]$，含 $36$ 个均等间隔点；$u \\in [2.0 \\times 10^{-4}, 1.0 \\times 10^{-3}]$ m s$^{-1}$，含 $41$ 个均等间隔点。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4]$），其中 $r_j$ 是测试用例 $j$ 中同时满足 $R_s \\ge 1.5$ 和 $\\Delta P \\le 600$ bar 的网格点所占的比例。不应打印任何其他文本。", "solution": "问题陈述已经过严格验证，被认定为具有科学依据、提法明确且内部一致。它基于色谱科学和流体动力学的既有基本原理。唯一数值解所需的所有必要参数和约束均已提供。因此，我将开始进行推导和计算实现。\n\n首先，我们必须推导色谱分离度 $R_s$ 的表达式，使其作为理论塔板数 $N$、选择性 $\\alpha$ 和晚洗脱分析物保留因子 $k_{\\text{late}}$ 的函数。\n\n两个高斯峰之间分离度的定义由其峰顶最大值的分离程度除以其峰底宽度的平均值给出：\n$$\nR_s = \\frac{2(t_{R,2} - t_{R,1})}{w_1 + w_2}\n$$\n其中 $t_{R,i}$ 是分析物 $i$ 的保留时间，$w_i$ 是其峰底宽度。保留时间通过 $t_{R,i} = t_0(1+k_i)$ 与柱死时间 $t_0$ 和保留因子 $k_i$ 相关联。峰底宽度通过 $w_i = 4 \\frac{t_{R,i}}{\\sqrt{N_i}}$ 与理论塔板数 $N_i$ 相关联。\n\n我们做出一个标准且合理的近似，即对于两个紧密洗脱的峰，其塔板数近似相等，$N_1 \\approx N_2 = N$。将这些关系代入分离度方程：\n$$\nR_s = \\frac{2(t_0(1+k_2) - t_0(1+k_1))}{\\frac{4 t_0(1+k_1)}{\\sqrt{N}} + \\frac{4 t_0(1+k_2)}{\\sqrt{N}}} = \\frac{\\sqrt{N}}{2} \\frac{k_2 - k_1}{2 + k_1 + k_2}\n$$\n在这里，我们指定分析物2为晚洗脱物质，因此 $k_2 = k_{\\text{late}}$，$k_1 = k_{\\text{early}}$。根据定义，选择性为 $\\alpha = \\frac{k_{\\text{late}}}{k_{\\text{early}}}$，这意味着 $k_{\\text{early}} = \\frac{k_{\\text{late}}}{\\alpha}$。将这些代入方程得到：\n$$\nR_s = \\frac{\\sqrt{N}}{2} \\frac{k_{\\text{late}} - \\frac{k_{\\text{late}}}{\\alpha}}{2 + \\frac{k_{\\text{late}}}{\\alpha} + k_{\\text{late}}} = \\frac{\\sqrt{N}}{2} \\frac{k_{\\text{late}} \\left(1-\\frac{1}{\\alpha}\\right)}{2 + k_{\\text{late}}\\left(1+\\frac{1}{\\alpha}\\right)} = \\frac{\\sqrt{N}}{2} \\frac{k_{\\text{late}} \\left(\\frac{\\alpha-1}{\\alpha}\\right)}{2 + k_{\\text{late}}\\left(\\frac{\\alpha+1}{\\alpha}\\right)} = \\frac{\\sqrt{N}}{2} \\frac{k_{\\text{late}}(\\alpha-1)}{2\\alpha + k_{\\text{late}}(\\alpha+1)}\n$$\n这是一个有效的表达式。然而，一个更进一步且非常普遍的近似将其简化为著名的 Purnell 方程。这个近似是，在分母项中，由于峰很接近，它们的保留因子相似，$k_{\\text{early}} \\approx k_{\\text{late}}$。这将 $2+k_{\\text{early}}+k_{\\text{late}}$ 简化为 $2 + 2k_{\\text{late}} = 2(1+k_{\\text{late}})$。应用此近似：\n$$\nR_s \\approx \\frac{\\sqrt{N}}{2} \\frac{k_{\\text{late}} - k_{\\text{early}}}{2(1+k_{\\text{late}})} = \\frac{\\sqrt{N}}{4} \\frac{k_{\\text{late}} - \\frac{k_{\\text{late}}}{\\alpha}}{1+k_{\\text{late}}} = \\frac{\\sqrt{N}}{4} \\frac{k_{\\text{late}}\\left(1-\\frac{1}{\\alpha}\\right)}{1+k_{\\text{late}}}\n$$\n这就得到了我们将用于计算的 Purnell 方程的最终标准形式：\n$$\nR_s(N, \\alpha, k_{\\text{late}}) = \\frac{\\sqrt{N}}{4} \\left(\\frac{\\alpha-1}{\\alpha}\\right) \\left(\\frac{k_{\\text{late}}}{1+k_{\\text{late}}}\\right)\n$$\n\n接下来，我们整合绘制设计空间所需的完整方程组。自变量是表观流速 $u$ 和流动相有机相体积分数 $\\phi$。\n\n1.  **塔板数，$N(u)$**：塔板数取决于间隙流速 $u_i = u/\\varepsilon$，其中 $\\varepsilon$ 是床层孔隙率。使用给定的 van Deemter 关系式计算塔板高度 $H(u_i)$ 和柱长 $L$：\n    $$\n    H(u_i) = A + \\frac{B}{u_i} + C u_i = A + \\frac{B \\varepsilon}{u} + \\frac{C u}{\\varepsilon}\n    $$\n    $$\n    N(u) = \\frac{L}{H(u)} = \\frac{L}{A + \\frac{B \\varepsilon}{u} + \\frac{C u}{\\varepsilon}}\n    $$\n    注意，对于给定的柱填料，$N$ 仅是 $u$ 的函数。\n\n2.  **保留与选择性，$k_i(\\phi), \\alpha(\\phi)$**：两种分析物的保留因子由线性溶剂强度模型给出：\n    $$\n    \\log_{10} k_1(\\phi) = \\log_{10} k_{0,1} - S_1 \\phi \\implies k_1(\\phi) = 10^{\\log_{10} k_{0,1} - S_1 \\phi}\n    $$\n    $$\n    \\log_{10} k_2(\\phi) = \\log_{10} k_{0,2} - S_2 \\phi \\implies k_2(\\phi) = 10^{\\log_{10} k_{0,2} - S_2 \\phi}\n    $$\n    由此，我们在每个 $\\phi$ 值下确定晚洗脱物质和选择性：\n    $$\n    k_{\\text{late}}(\\phi) = \\max\\{k_1(\\phi), k_2(\\phi)\\}\n    $$\n    $$\n    k_{\\text{early}}(\\phi) = \\min\\{k_1(\\phi), k_2(\\phi)\\}\n    $$\n    $$\n    \\alpha(\\phi) = \\frac{k_{\\text{late}}(\\phi)}{k_{\\text{early}}(\\phi)}\n    $$\n    这些量仅取决于 $\\phi$。\n\n3.  **压降，$\\Delta P(u, \\phi)$**：压降使用 Kozeny-Carman 方程计算。首先，我们使用提供的对数混合规则计算水-乙腈混合物的流动相粘度 $\\eta(\\phi)$：\n    $$\n    \\ln \\eta(\\phi) = (1 - \\phi) \\ln \\eta_w + \\phi \\ln \\eta_a \\implies \\eta(\\phi) = \\exp\\left((1 - \\phi) \\ln \\eta_w + \\phi \\ln \\eta_a\\right)\n    $$\n    对于给定的色谱柱，几何因子 $f(\\varepsilon)$ 是恒定的：\n    $$\n    f(\\varepsilon) = 180 \\frac{(1-\\varepsilon)^2}{\\varepsilon^3}\n    $$\n    压降则为：\n    $$\n    \\Delta P(u, \\phi) = f(\\varepsilon) \\, \\eta(\\phi) \\, \\frac{L}{d_p^2} \\, u\n    $$\n    其中 $d_p$ 是颗粒直径。\n\n4.  **计算步骤**：对于每个测试用例，我们在 $(u, \\phi)$ 平面上构建一个均匀网格。在每个网格点：\n    a. 根据网格的 $u$ 值计算 $N(u)$。\n    b. 根据网格的 $\\phi$ 值计算 $k_1(\\phi)$、$k_2(\\phi)$、$k_{\\text{late}}(\\phi)$ 和 $\\alpha(\\phi)$。\n    c. 结合这些值，使用 Purnell 方程计算分离度 $R_s(u, \\phi)$。\n    d. 根据网格的 $\\phi$ 值计算 $\\eta(\\phi)$。\n    e. 结合这些值计算压降 $\\Delta P(u, \\phi)$。\n    f. 当且仅当 $R_s(u, \\phi) \\geq 1.5$ 和 $\\Delta P(u, \\phi) \\leq 6 \\times 10^7$ Pa 这两个约束条件都满足时，一个网格点才被认为是有效设计空间的一部分。\n    g. 该测试用例的最终结果是满足这两个条件的总网格点所占的比例。此比例通过将有效点的数量相加后除以网格中的总点数来计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the chromatographic design space problem for multiple test cases.\n    \"\"\"\n    \n    # Test cases defined in the problem statement.\n    test_cases = [\n        {\n            # Test case 1\n            \"L\": 0.10, \"dp\": 1.7e-6, \"eps\": 0.40,\n            \"A\": 2.0e-6, \"B\": 1.6e-9, \"C\": 4.0e-3,\n            \"logk0_1\": 1.30, \"S1\": 3.00,\n            \"logk0_2\": 1.60, \"S2\": 4.00,\n            \"eta_w\": 8.90e-4, \"eta_a\": 3.70e-4,\n            \"phi_range\": (0.10, 0.60, 41),\n            \"u_range\": (2.0e-4, 1.2e-3, 41),\n        },\n        {\n            # Test case 2\n            \"L\": 0.050, \"dp\": 1.7e-6, \"eps\": 0.40,\n            \"A\": 2.0e-6, \"B\": 1.6e-9, \"C\": 4.0e-3,\n            \"logk0_1\": 1.30, \"S1\": 3.00,\n            \"logk0_2\": 1.60, \"S2\": 4.00,\n            \"eta_w\": 8.90e-4, \"eta_a\": 3.70e-4,\n            \"phi_range\": (0.10, 0.60, 41),\n            \"u_range\": (2.0e-4, 1.2e-3, 41),\n        },\n        {\n            # Test case 3\n            \"L\": 0.10, \"dp\": 2.6e-6, \"eps\": 0.40,\n            \"A\": 3.0e-6, \"B\": 2.0e-9, \"C\": 3.0e-3,\n            \"logk0_1\": 1.30, \"S1\": 3.00,\n            \"logk0_2\": 1.60, \"S2\": 4.00,\n            \"eta_w\": 8.90e-4, \"eta_a\": 3.70e-4,\n            \"phi_range\": (0.05, 0.60, 36),\n            \"u_range\": (3.0e-4, 1.5e-3, 41),\n        },\n        {\n            # Test case 4\n            \"L\": 0.10, \"dp\": 1.7e-6, \"eps\": 0.40,\n            \"A\": 2.0e-6, \"B\": 1.6e-9, \"C\": 4.0e-3,\n            \"logk0_1\": 1.40, \"S1\": 3.20,\n            \"logk0_2\": 1.41, \"S2\": 3.30,\n            \"eta_w\": 8.90e-4, \"eta_a\": 3.70e-4,\n            \"phi_range\": (0.05, 0.60, 36),\n            \"u_range\": (2.0e-4, 1.0e-3, 41),\n        },\n    ]\n\n    # Constraints\n    RS_MIN = 1.5\n    DP_MAX = 6e7  # 600 bar in Pascals\n\n    results = []\n\n    for case in test_cases:\n        # Unpack parameters\n        L, dp, eps = case[\"L\"], case[\"dp\"], case[\"eps\"]\n        A, B, C = case[\"A\"], case[\"B\"], case[\"C\"]\n        logk0_1, S1 = case[\"logk0_1\"], case[\"S1\"]\n        logk0_2, S2 = case[\"logk0_2\"], case[\"S2\"]\n        eta_w, eta_a = case[\"eta_w\"], case[\"eta_a\"]\n        \n        # Construct grid\n        phi_vec = np.linspace(*case[\"phi_range\"])\n        u_vec = np.linspace(*case[\"u_range\"])\n        U, PHI = np.meshgrid(u_vec, phi_vec)\n\n        # 1. Plate Number Calculation (depends on u)\n        ui = U / eps\n        H = A + (B / ui) + (C * ui)\n        N = L / H\n\n        # 2. Retention and Selectivity Calculation (depends on phi)\n        logk1 = logk0_1 - S1 * PHI\n        logk2 = logk0_2 - S2 * PHI\n        k1 = 10**logk1\n        k2 = 10**logk2\n        \n        k_late = np.maximum(k1, k2)\n        k_early = np.minimum(k1, k2)\n        \n        # Avoid division by zero if k_early is zero\n        alpha = np.divide(k_late, k_early, out=np.ones_like(k_late), where=k_early!=0)\n\n        # 3. Resolution Calculation\n        # Purnell equation: Rs = (sqrt(N)/4) * ((alpha-1)/alpha) * (k_late/(1+k_late))\n        term_N = np.sqrt(N) / 4.0\n        term_alpha = np.divide(alpha - 1.0, alpha, out=np.zeros_like(alpha), where=alpha!=0)\n        term_k = k_late / (1.0 + k_late)\n        Rs = term_N * term_alpha * term_k\n        # Ensure Rs is non-negative\n        Rs[Rs  0] = 0\n\n        # 4. Pressure Drop Calculation\n        f_eps = 180.0 * (1.0 - eps)**2 / eps**3\n        log_eta_w = np.log(eta_w)\n        log_eta_a = np.log(eta_a)\n        log_eta = (1.0 - PHI) * log_eta_w + PHI * log_eta_a\n        eta = np.exp(log_eta)\n        \n        DeltaP = f_eps * eta * (L / dp**2) * U\n\n        # 5. Apply constraints and calculate fraction\n        valid_points = (Rs >= RS_MIN)  (DeltaP = DP_MAX)\n        fraction = np.sum(valid_points) / valid_points.size\n        results.append(fraction)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2589640"}]}