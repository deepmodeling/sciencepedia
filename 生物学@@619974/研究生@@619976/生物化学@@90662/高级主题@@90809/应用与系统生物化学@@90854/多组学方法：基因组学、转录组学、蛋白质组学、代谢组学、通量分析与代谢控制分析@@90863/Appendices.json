{"hands_on_practices": [{"introduction": "在代谢分析中，理解系统如何响应环境变化至关重要。本练习将指导您为一个线性代谢途径构建一个动态模型，该模型基于质量守恒和可逆的米氏-门顿动力学。通过为底物供应的突然变化设置初始条件并计算瞬时响应，您将亲身体验如何使用常微分方程 ($ODEs$) 来描述和预测代谢物浓度的瞬态行为 [@problem_id:2579659]。", "problem": "一个细胞通过由酶 $E_0$、$E_1$ 和 $E_2$ 催化的、包含细胞内代谢物 $A$ 和 $B$ 的线性三步途径，将外部底物 $S$ 转化为最终产物 $P$：\n$$\nS \\xrightleftharpoons[E_0]{} A \\xrightleftharpoons[E_1]{} B \\xrightleftharpoons[E_2]{} P.\n$$\n边界代谢物 $S$ 和 $P$ 的浓度是化学恒定的（其浓度由环境控制，不因细胞内反应而改变）。每一步都遵循可逆的 Michaelis–Menten 便利动力学速率方程，这是一种在代谢通量分析中广泛使用且经过充分检验的唯象法则：\n$$\nv \\;=\\; \\frac{V_{f}\\,\\frac{S}{K_{S}} \\;-\\; V_{r}\\,\\frac{P}{K_{P}}}{1 \\;+\\; \\frac{S}{K_{S}} \\;+\\; \\frac{P}{K_{P}}}.\n$$\n此处，$S$ 和 $P$ 分别代表该步骤的底物和产物浓度，$V_{f}$ 和 $V_{r}$ 分别是正向和反向最大速率，$K_{S}$ 和 $K_{P}$ 分别是底物和产物的米氏常数。\n\n任务 1 (模型构建)：根据质量守恒（变化速率等于总流入速率减去总流出速率）和上述速率方程，为该途径写出关于 $A(t)$ 和 $B(t)$ 的常微分方程 (ODEs)，其中 $S$ 和 $P$ 在每个时间点 $t$ 均被视为固定参数。\n\n任务 2 (底物供给变化的初始条件)：系统在变化前一直处于底物 $S = S_{\\mathrm{old}}$ 的稳态环境中，在时间 $t=0$ 时，环境瞬时变化，并在 $t \\ge 0$ 的时间段内保持 $S = S_{\\mathrm{new}}$。产物浓度在所有时间点均保持为 $P = P^{*}$。在变化前测得的细胞内浓度为 $A(0^{-}) = A^{*}$ 和 $B(0^{-}) = B^{*}$。请为常微分方程指定在 $t=0$ 时的适当初始条件，以反映这一变化过程。\n\n任务 3 (瞬时响应计算)：给定以下参数值\n- 步骤 $S \\rightleftharpoons A$ ($E_0$): $V_{0f} = 1.5 \\ \\mathrm{mM\\,min^{-1}}$, $K_{0S} = 0.5 \\ \\mathrm{mM}$, $V_{0r} = 0.5 \\ \\mathrm{mM\\,min^{-1}}$, $K_{0A} = 0.2 \\ \\mathrm{mM}$.\n- 步骤 $A \\rightleftharpoons B$ ($E_1$): $V_{1f} = 2.0 \\ \\mathrm{mM\\,min^{-1}}$, $K_{1A} = 0.3 \\ \\mathrm{mM}$, $V_{1r} = 1.0 \\ \\mathrm{mM\\,min^{-1}}$, $K_{1B} = 0.4 \\ \\mathrm{mM}$.\n- 步骤 $B \\rightleftharpoons P$ ($E_2$): $V_{2f} = 1.8 \\ \\mathrm{mM\\,min^{-1}}$, $K_{2B} = 0.2 \\ \\mathrm{mM}$, $V_{2r} = 0.9 \\ \\mathrm{mM\\,min^{-1}}$, $K_{2P} = 0.5 \\ \\mathrm{mM}$.\n- 边界浓度: $S_{\\mathrm{old}} = 0.10 \\ \\mathrm{mM}$, $S_{\\mathrm{new}} = 1.00 \\ \\mathrm{mM}$, $P^{*} = 0.20 \\ \\mathrm{mM}$.\n- 变化前细胞内测量值: $A^{*} = 0.15 \\ \\mathrm{mM}$ 和 $B^{*} = 0.25 \\ \\mathrm{mM}$。\n\n计算在变化发生后瞬间 $B$ 的瞬时累积速率，即使用您的常微分方程，在 $S = S_{\\mathrm{new}}$、$P = P^{*}$、$A(0) = A^{*}$ 和 $B(0) = B^{*}$ 的条件下，计算 $\\left.\\frac{dB}{dt}\\right|_{t=0^{+}}$。以 $\\mathrm{mM\\,min^{-1}}$ 为单位表示最终结果，并将答案四舍五入至四位有效数字。", "solution": "问题陈述已被验证，并被确认为生物化学动力学和代谢建模领域中一个定义良好、科学合理的问题。它包含了所有必要信息，没有矛盾之处，并基于既定原则提出了一个具体的、可计算的问题。我们将开始解答。\n\n该问题需要进行三部分分析：首先，构建数学模型；其次，确定特定场景下的初始条件；第三，计算瞬时变化率。\n\n**任务 1：模型构建**\n\n该系统是一个线性酶促途径：\n$$\nS \\xrightleftharpoons[E_0]{v_0} A \\xrightleftharpoons[E_1]{v_1} B \\xrightleftharpoons[E_2]{v_2} P\n$$\n内部代谢物 $A$ 和 $B$ 的浓度随时间变化，遵循质量守恒原理。一个代谢物浓度的变化速率等于所有生成该代谢物的反应速率之和（流入）减去所有消耗该代谢物的反应速率之和（流出）。\n\n对于代谢物 $A$，它由反应 $v_0$ 生成，并由反应 $v_1$ 消耗。因此，其变化速率为：\n$$\n\\frac{d[A]}{dt} = v_0 - v_1\n$$\n对于代谢物 $B$，它由反应 $v_1$ 生成，并由反应 $v_2$ 消耗。其变化速率为：\n$$\n\\frac{d[B]}{dt} = v_1 - v_2\n$$\n通量 $v_0$、 $v_1$ 和 $v_2$ 由给定的可逆 Michaelis–Menten 便利动力学描述。令 $[X]$ 代表物质 $X$ 的浓度。\n\n第一步的通量 $v_0$（由酶 $E_0$ 催化，$S \\rightleftharpoons A$）为：\n$$\nv_0 = \\frac{V_{0f}\\,\\frac{[S]}{K_{0S}} - V_{0r}\\,\\frac{[A]}{K_{0A}}}{1 + \\frac{[S]}{K_{0S}} + \\frac{[A]}{K_{0A}}}\n$$\n第二步的通量 $v_1$（由酶 $E_1$ 催化，$A \\rightleftharpoons B$）为：\n$$\nv_1 = \\frac{V_{1f}\\,\\frac{[A]}{K_{1A}} - V_{1r}\\,\\frac{[B]}{K_{1B}}}{1 + \\frac{[A]}{K_{1A}} + \\frac{[B]}{K_{1B}}}\n$$\n第三步的通量 $v_2$（由酶 $E_2$ 催化，$B \\rightleftharpoons P$）为：\n$$\nv_2 = \\frac{V_{2f}\\,\\frac{[B]}{K_{2B}} - V_{2r}\\,\\frac{[P]}{K_{2P}}}{1 + \\frac{[B]}{K_{2B}} + \\frac{[P]}{K_{2P}}}\n$$\n将这些表达式代入质量平衡方程，得到关于 $[A](t)$ 和 $[B](t)$ 的完整常微分方程 (ODEs) 系统：\n$$\n\\frac{d[A]}{dt} = \\left( \\frac{V_{0f}\\,\\frac{[S]}{K_{0S}} - V_{0r}\\,\\frac{[A]}{K_{0A}}}{1 + \\frac{[S]}{K_{0S}} + \\frac{[A]}{K_{0A}}} \\right) - \\left( \\frac{V_{1f}\\,\\frac{[A]}{K_{1A}} - V_{1r}\\,\\frac{[B]}{K_{1B}}}{1 + \\frac{[A]}{K_{1A}} + \\frac{[B]}{K_{1B}}} \\right)\n$$\n$$\n\\frac{d[B]}{dt} = \\left( \\frac{V_{1f}\\,\\frac{[A]}{K_{1A}} - V_{1r}\\,\\frac{[B]}{K_{1B}}}{1 + \\frac{[A]}{K_{1A}} + \\frac{[B]}{K_{1B}}} \\right) - \\left( \\frac{V_{2f}\\,\\frac{[B]}{K_{2B}} - V_{2r}\\,\\frac{[P]}{K_{2P}}}{1 + \\frac{[B]}{K_{2B}} + \\frac{[P]}{K_{2P}}} \\right)\n$$\n\n**任务 2：初始条件**\n\n问题描述了一个实验，在时间 $t=0$ 时，外部底物浓度 $[S]$ 从 $[S]_{\\mathrm{old}}$ 瞬时变为 $[S]_{\\mathrm{new}}$。细胞内代谢物 $[A]$ 和 $[B]$ 的浓度是系统的状态变量。在任何物理现实系统中，状态变量都不能瞬时改变。因此，$[A]$ 和 $[B]$ 的浓度在时间点 $t=0$ 必须是连续的。\n\n这意味着变化后动力学（对于 $t \\ge 0$）的初始条件即为变化前状态（在 $t=0^{-}$ 时）的最终值。\n问题给出了变化前瞬间测得的浓度：\n$$\n[A](0^{-}) = A^{*} = 0.15 \\ \\mathrm{mM}\n$$\n$$\n[B](0^{-}) = B^{*} = 0.25 \\ \\mathrm{mM}\n$$\n根据连续性，在 $t=0$ 时常微分方程的初始条件为：\n$$\n[A](0) = [A](0^{+}) = A^{*} = 0.15 \\ \\mathrm{mM}\n$$\n$$\n[B](0) = [B](0^{+}) = B^{*} = 0.25 \\ \\mathrm{mM}\n$$\n对于所有时间 $t \\ge 0$，外部浓度固定为：\n$$\n[S] = S_{\\mathrm{new}} = 1.00 \\ \\mathrm{mM}\n$$\n$$\n[P] = P^{*} = 0.20 \\ \\mathrm{mM}\n$$\n\n**任务 3：瞬时响应计算**\n\n我们需要计算变化发生后瞬间代谢物 $B$ 的瞬时累积速率，即 $\\left.\\frac{d[B]}{dt}\\right|_{t=0^{+}}$。这需要使用在 $t=0^{+}$ 时的条件来评估 $B$ 的常微分方程：即新的外部浓度 $[S]=S_{\\mathrm{new}}$、$[P]=P^{*}$ 和初始内部浓度 $[A](0)=A^{*}$、$[B](0)=B^{*}$。\n\n控制方程为：\n$$\n\\left.\\frac{d[B]}{dt}\\right|_{t=0^{+}} = v_1(0^{+}) - v_2(0^{+})\n$$\n我们必须计算在 $t=0^{+}$ 时的通量 $v_1$ 和 $v_2$ 的值。\n\n首先，我们使用 $[A] = A^{*} = 0.15 \\ \\mathrm{mM}$ 和 $[B] = B^{*} = 0.25 \\ \\mathrm{mM}$ 计算 $v_1(0^{+})$：\n$$\nv_1(0^{+}) = \\frac{V_{1f}\\,\\frac{A^{*}}{K_{1A}} - V_{1r}\\,\\frac{B^{*}}{K_{1B}}}{1 + \\frac{A^{*}}{K_{1A}} + \\frac{B^{*}}{K_{1B}}}\n$$\n使用步骤1的给定参数：$V_{1f} = 2.0$, $K_{1A} = 0.3$, $V_{1r} = 1.0$, $K_{1B} = 0.4$：\n$$\n\\frac{A^{*}}{K_{1A}} = \\frac{0.15}{0.3} = 0.5\n$$\n$$\n\\frac{B^{*}}{K_{1B}} = \\frac{0.25}{0.4} = 0.625\n$$\n将这些值代入 $v_1$ 的表达式中：\n$$\nv_1(0^{+}) = \\frac{(2.0)(0.5) - (1.0)(0.625)}{1 + 0.5 + 0.625} = \\frac{1.0 - 0.625}{2.125} = \\frac{0.375}{2.125}\n$$\n$v_1(0^{+}) \\approx 0.1764705... \\ \\mathrm{mM\\,min^{-1}}$\n\n接下来，我们使用 $[B] = B^{*} = 0.25 \\ \\mathrm{mM}$ 和 $[P] = P^{*} = 0.20 \\ \\mathrm{mM}$ 计算 $v_2(0^{+})$：\n$$\nv_2(0^{+}) = \\frac{V_{2f}\\,\\frac{B^{*}}{K_{2B}} - V_{2r}\\,\\frac{P^{*}}{K_{2P}}}{1 + \\frac{B^{*}}{K_{2B}} + \\frac{P^{*}}{K_{2P}}}\n$$\n使用步骤2的给定参数：$V_{2f} = 1.8$, $K_{2B} = 0.2$, $V_{2r} = 0.9$, $K_{2P} = 0.5$：\n$$\n\\frac{B^{*}}{K_{2B}} = \\frac{0.25}{0.2} = 1.25\n$$\n$$\n\\frac{P^{*}}{K_{2P}} = \\frac{0.20}{0.5} = 0.4\n$$\n将这些值代入 $v_2$ 的表达式中：\n$$\nv_2(0^{+}) = \\frac{(1.8)(1.25) - (0.9)(0.4)}{1 + 1.25 + 0.4} = \\frac{2.25 - 0.36}{2.65} = \\frac{1.89}{2.65}\n$$\n$v_2(0^{+}) \\approx 0.7132075... \\ \\mathrm{mM\\,min^{-1}}$\n\n最后，我们计算 $[B]$ 的变化速率：\n$$\n\\left.\\frac{d[B]}{dt}\\right|_{t=0^{+}} = v_1(0^{+}) - v_2(0^{+}) \\approx 0.1764705... - 0.7132075...\n$$\n$$\n\\left.\\frac{d[B]}{dt}\\right|_{t=0^{+}} \\approx -0.536737... \\ \\mathrm{mM\\,min^{-1}}\n$$\n问题要求将结果四舍五入到四位有效数字。\n$$\n\\left.\\frac{d[B]}{dt}\\right|_{t=0^{+}} \\approx -0.5367 \\ \\mathrm{mM\\,min^{-1}}\n$$\n负号表示在底物浓度上调后的一瞬间，通过代谢物 $B$ 的净通量为负，意味着其浓度开始下降。这是因为消耗通量 $v_2$ 瞬时大于生产通量 $v_1$。", "answer": "$$\\boxed{-0.5367}$$", "id": "2579659"}, {"introduction": "量化代谢途径中的通量是系统生物学的核心任务，而同位素示踪是实现这一目标的最有力工具之一。本练习模拟了一个稳态同位素标记实验，您需要追踪一个 $[\\text{U-}^{13}\\text{C}]$ 标记的底物如何在一个线性途径中流动。通过计算在有未标记通量稀释的情况下，代谢物池中同位素体的稳态比例，您将掌握同位素质量平衡的基本原理，这是解析复杂网络中代谢通量的关键技能 [@problem_id:2579693]。", "problem": "一条线性代谢途径 $A \\to B \\to C$ 传递三碳单元，在各步骤之间没有碳损失，也没有碳位置的重排。细胞被供给均匀标记的葡萄糖 $[\\text{U-}^{13}\\text{C}_6]$，并让系统达到同位素稳态。假设所有代谢物池都处于稳态（每个代谢物的总流入等于总流出），并且从标记来源进入该途径的唯一同位素形式是全标记的三碳单元 ($M+3$)。在每个节点通过特定的未标记流入发生未标记稀释。\n\n流入如下：\n- $A$ 的形成有两个来源：一个来自 $[\\text{U-}^{13}\\text{C}_6]$ 葡萄糖的标记来源，其通量为 $v_{L} = 8$ nmol min$^{-1}$（产生 $M+3$ 形式的 $A$）；以及一个未标记来源，其通量为 $v_{U} = 2$ nmol min$^{-1}$（产生 $M+0$ 形式的 $A$）。\n- $A \\to B$ 的转化通量等于 $A$ 的总形成通量。此外，$B$ 接收到一个未标记流入 $v_{B,u} = 5$ nmol min$^{-1}$。\n- $B \\to C$ 的转化通量等于 $B$ 的总形成通量。此外，$C$ 接收到一个未标记流入 $v_{C,u} = 5$ nmol min$^{-1}$。\n\n假设不存在其他源或汇，并且同位素标记在 $A \\to B \\to C$ 的转化过程中被保留。使用同位素稳态下的质量守恒和同位素标记守恒，计算 $C$ 中 $M+3$ 同位素体的稳态分数。将您的答案表示为无单位的小数，并四舍五入到三位有效数字。", "solution": "所提出的问题具有科学依据、提法恰当且客观。它描述了一个通过质量平衡原理（代谢通量分析中的一项基本技术）进行分析的标准同位素标记实验。所有必要的参数都已提供，且不存在内部矛盾。因此，该问题是有效的，我们将着手解决。\n\n解决此问题的基本原理是在稳态下的质量和同位素标记守恒。对于任何给定的代谢物池，总质量流入速率必须等于总质量流出速率。同样，特定同位素体（在本例中为全标记的 $M+3$ 形式）的流入速率必须等于其流出速率。池中同位素体的分数丰度定义为该同位素体的流入通量与进入该池的总流入通量之比。\n\n设 $f_X(M+3)$ 表示代谢物 $X$（其中 $X \\in \\{A, B, C\\}$）池中 $M+3$ 同位素体的摩尔分数。我们得到的通量单位是 nmol min$^{-1}$，但由于我们计算的是无单位的分数，因此在计算比率时，我们可以将它们视为无量纲量。\n\n我们将依次分析每个代谢物池。\n\n首先，考虑代谢物 $A$。\n$A$ 池由两个来源形成：一个标记来源，通量为 $v_{L} = 8$，仅产生 $A$ 的 $M+3$ 同位素体；以及一个未标记来源，通量为 $v_{U} = 2$，仅产生 $M+0$ 同位素体。\n进入 $A$ 池的总通量，记为 $v_{in,A}$，是这两个通量之和：\n$$ v_{in,A} = v_{L} + v_{U} = 8 + 2 = 10 $$\n进入 $A$ 池的标记物种 ($M+3$) 的通量恰好是 $v_{L}$。\n在同位素稳态下，$A$ 池中 $M+3$ 同位素体的分数丰度 $f_A(M+3)$ 是标记流入与总流入之比：\n$$ f_A(M+3) = \\frac{v_{L}}{v_{in,A}} = \\frac{8}{10} = 0.8 $$\n根据问题陈述，从 $A$ 到 $B$ 的通量，记为 $v_{A \\to B}$，等于 $A$ 的总形成速率。因此，$v_{A \\to B} = v_{in,A} = 10$。\n\n接下来，我们分析代谢物 $B$。\n$B$ 池由两个来源形成：来自代谢物 $A$ 的转化，通量为 $v_{A \\to B} = 10$；以及一个额外的未标记流入 $v_{B,u} = 5$。\n进入 $B$ 池的总通量，记为 $v_{in,B}$，是：\n$$ v_{in,B} = v_{A \\to B} + v_{B,u} = 10 + 5 = 15 $$\n进入 $B$ 池的标记 ($M+3$) 物种的流入完全来自代谢物 $A$。该通量是来自 $A$ 的总通量与 $A$ 中 $M+3$ 分数丰度的乘积：\n$$ v_{in,B}^{(M+3)} = v_{A \\to B} \\times f_A(M+3) = 10 \\times 0.8 = 8 $$\n$B$ 池中 $M+3$ 同位素体的分数丰度 $f_B(M+3)$ 则是：\n$$ f_B(M+3) = \\frac{v_{in,B}^{(M+3)}}{v_{in,B}} = \\frac{8}{15} $$\n从 $B$ 到 $C$ 的总通量，记为 $v_{B \\to C}$，等于 $B$ 的总形成速率。因此，$v_{B \\to C} = v_{in,B} = 15$。\n\n最后，我们分析代谢物 $C$。\n$C$ 池由两个来源形成：来自代谢物 $B$ 的转化，通量为 $v_{B \\to C} = 15$；以及一个额外的未标记流入 $v_{C,u} = 5$。\n进入 $C$ 池的总通量，记为 $v_{in,C}$，是：\n$$ v_{in,C} = v_{B \\to C} + v_{C,u} = 15 + 5 = 20 $$\n进入 $C$ 池的标记 ($M+3$) 物种的流入完全来自代谢物 $B$。该通量是来自 $B$ 的总通量与 $B$ 中 $M+3$ 分数丰度的乘积：\n$$ v_{in,C}^{(M+3)} = v_{B \\to C} \\times f_B(M+3) = 15 \\times \\frac{8}{15} = 8 $$\n$C$ 池中 $M+3$ 同位素体的分数丰度 $f_C(M+3)$ 是我们必须计算的量。它是 $C$ 池的标记流入与总流入之比：\n$$ f_C(M+3) = \\frac{v_{in,C}^{(M+3)}}{v_{in,C}} = \\frac{8}{20} = 0.4 $$\n问题要求答案表示为四舍五入到三位有效数字的小数。数值 $0.4$ 表示为三位有效数字是 $0.400$。", "answer": "$$ \\boxed{0.400} $$", "id": "2579693"}, {"introduction": "当我们将分析从简单的线性途径扩展到全基因组尺度的代谢网络时，动力学建模变得不切实际。约束基础的建模方法，如通量平衡分析 ($Flux Balance Analysis$, $FBA$)，提供了一个强大的替代方案来预测网络在稳态下的最优功能。本练习要求您实现通量可变性分析 ($Flux Variability Analysis$, $FVA$)，以探索在达到最优目标（如最大化生长）时所有可能通量分布的范围，并阐释替代最优解是如何产生的 [@problem_id:2579719]。", "problem": "您将获得三个稳态代谢网络模型，这些模型由一个化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$、一个通量向量 $v \\in \\mathbb{R}^n$、下界 $l \\in \\mathbb{R}^n$、上界 $u \\in \\mathbb{R}^n$ 和一个目标向量 $c \\in \\mathbb{R}^n$ 定义。基本基础是稳态假设和质量守恒，这要求 $S v = 0$，同时每个反应通量都受到边界约束 $l \\le v \\le u$。优化目标是在通量平衡分析 (FBA) 中最大化代表生物质生产的线性泛函 $c^\\top v$。通量变异性分析 (FVA) 对每个反应 $j$ 计算，在目标保持其最优值的条件下，可行的 $v_j$ 的最小值和最大值。您必须将 FVA 实现为一系列线性规划。\n\n从以下基本定义和定律开始：\n- 稳态：$S v = 0$。\n- 通量边界：$l \\le v \\le u$。\n- 目标：在可行域上最大化 $c^\\top v$。\n- 通量变异性分析：对每个反应索引 $j$，计算\n  $$ v_j^{\\min} = \\min_{v} \\; e_j^\\top v \\;\\; \\text{subject to} \\;\\; S v = 0, \\; l \\le v \\le u, \\; c^\\top v \\ge Z^\\* - \\delta, $$\n  $$ v_j^{\\max} = \\max_{v} \\; e_j^\\top v \\;\\; \\text{subject to} \\;\\; S v = 0, \\; l \\le v \\le u, \\; c^\\top v \\ge Z^\\* - \\delta, $$\n  其中 $e_j$ 是第 $j$ 个标准基向量，$Z^\\*$ 是最优目标值，$\\delta$ 是为避免数值问题而设置的一个小容差。在此问题中，在所有 FVA 子问题中使用双侧区间 $Z^\\* - \\delta \\le c^\\top v \\le Z^\\* + \\delta$。设 $\\delta = \\max\\{10^{-9}, 10^{-9}\\cdot \\lvert Z^\\* \\rvert\\}$。\n\n解释多重最优解是如何因满足 $S d = 0$、$c^\\top d = 0$ 且相对于边界保持可行性的可行方向 $d$ 而产生的。\n\n所有通量必须以毫摩尔/克干重/小时 $(\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1})$ 为单位表示。您的程序必须报告四舍五入到六位小数的 FVA 范围。\n\n测试套件。对于下面的每个测试用例，您都会获得完整的模型。反应顺序是 $S$ 的列顺序，并且必须与 $l$、$u$ 和 $c$ 匹配。\n\n- 测试用例 $1$ (具有多重最优解的平行通路):\n  - 代谢物 (行): $[S, A, B, \\mathrm{Biomass}]$。\n  - 反应 (列): $[v_0, v_{1a}, v_{2a}, v_{1b}, v_{2b}, v_{bm}]$。\n  - 化学计量 $S \\in \\mathbb{R}^{4 \\times 6}$:\n    $$ S = \\begin{bmatrix}\n    1 & -1 & 0 & -1 & 0 & 0 \\\\\n    0 & 1 & -1 & 0 & 0 & 0 \\\\\n    0 & 0 & 0 & 1 & -1 & 0 \\\\\n    0 & 0 & 1 & 0 & 1 & -1\n    \\end{bmatrix}.$$\n  - 边界: $l = [0, 0, 0, 0, 0, 0]$, $u = [10, 1000, 1000, 1000, 1000, 1000]$。\n  - 目标: $c = [0, 0, 0, 0, 0, 1]$。\n\n- 测试用例 $2$ (唯一最优流加上一个内部可逆循环):\n  - 代谢物 (行): $[S, P, \\mathrm{Biomass}, C, D]$。\n  - 反应 (列): $[v_0, v_1, v_2, v_{bm}, r_3, r_4]$。\n  - 化学计量 $S \\in \\mathbb{R}^{5 \\times 6}$:\n    $$ S = \\begin{bmatrix}\n    1 & -1 & 0 & 0 & 0 & 0 \\\\\n    0 & 1 & -1 & 0 & 0 & 0 \\\\\n    0 & 0 & 1 & -1 & 0 & 0 \\\\\n    0 & 0 & 0 & 0 & -1 & 1 \\\\\n    0 & 0 & 0 & 0 & 1 & -1\n    \\end{bmatrix}.$$\n  - 边界: $l = [0, 0, 0, 0, -5, -5]$, $u = [10, 1000, 1000, 1000, 5, 5]$。\n  - 目标: $c = [0, 0, 0, 1, 0, 0]$。\n\n- 测试用例 $3$ (具有一个受阻反应的容量限制分支):\n  - 代谢物 (行): $[S, X, Y, \\mathrm{Biomass}, E, F]$。\n  - 反应 (列): $[v_0, v_1, v_2, v_3, v_4, v_{bm}, r_{block}]$。\n  - 化学计量 $S \\in \\mathbb{R}^{6 \\times 7}$:\n    $$ S = \\begin{bmatrix}\n    1 & -1 & 0 & -1 & 0 & 0 & 0 \\\\\n    0 & 1 & -1 & 0 & 0 & 0 & 0 \\\\\n    0 & 0 & 0 & 1 & -1 & 0 & 0 \\\\\n    0 & 0 & 1 & 0 & 1 & -1 & 0 \\\\\n    0 & 0 & 0 & 0 & 0 & 0 & -1 \\\\\n    0 & 0 & 0 & 0 & 0 & 0 & 1\n    \\end{bmatrix}.$$\n  - 边界: $l = [0, 0, 0, 0, 0, 0, 0]$, $u = [8, 1000, 3, 1000, 1000, 1000, 1000]$。\n  - 目标: $c = [0, 0, 0, 0, 0, 1, 0]$。\n\n算法要求:\n- 首先为每个测试用例计算最优目标值 $Z^\\* = \\max\\{c^\\top v \\mid S v = 0, l \\le v \\le u\\}$。\n- 然后，对每个反应索引 $j$，通过求解两个带有 $S v = 0$、$l \\le v \\le u$ 和区间约束 $Z^\\* - \\delta \\le c^\\top v \\le Z^\\* + \\delta$ 的线性规划来计算 $v_j^{\\min}$ 和 $v_j^{\\max}$。\n- 使用 $\\delta = \\max\\{10^{-9}, 10^{-9}\\cdot \\lvert Z^\\* \\rvert\\}$。\n- 报告每一对 $[v_j^{\\min}, v_j^{\\max}]$，四舍五入到六位小数。\n\n最终输出格式:\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。列表的第 $k$ 个元素是测试用例 $k$ 的 $n_k$ 个双元素列表 $[v_j^{\\min}, v_j^{\\max}]$ 的列表，顺序与上面指定的反应顺序完全相同。例如，字符串应类似于 $[[[a,b],[c,d]],[[e,f],\\dots],\\dots]$，所有数字四舍五入到六位小数。单位是 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$。\n\n您的程序必须是自包含的，不接受任何输入，并严格按照规定生成一行输出。", "solution": "所提供的问题定义严谨、科学上合理且计算上是可行的。它是一个适定问题，提供了执行通量平衡分析 (FBA) 和通量变异性分析 (FVA) 所需的所有必要矩阵、向量和常数。约束条件是一致的，目标也已明确指定。该问题有效，并将按所述方式解决。\n\n此问题的核心在于应用线性规划来分析稳态假设下的代谢网络化学计量模型。该假设通过方程 $S v = 0$ 形式化，规定了每个内部代谢物的生产速率等于其消耗速率，从而导致代谢物浓度随时间没有净变化。在这里，$S \\in \\mathbb{R}^{m \\times n}$ 是一个拥有 $m$ 个代谢物和 $n$ 个反应的网络的化学计量矩阵，$v \\in \\mathbb{R}^n$ 是反应通量向量。\n\n可行通量分布的集合受到稳态条件以及反应速率的热力学和生理学限制的约束，表示为下界和上界 $l \\le v \\le u$。这定义了一个称为可行通量空间的凸多胞体。\n\n通量平衡分析 (FBA) 旨在在这个可行空间中找到一个点，以优化给定的生物学目标。该目标通常被表述为通量的线性组合，$Z = c^\\top v$，其中 $c$ 是系数向量。一个常见的目标是最大化生物质生产，这通过一个以化学计量学上适当的比例消耗代谢前体的伪反应来表示。FBA 问题是一个线性规划 (LP) 问题：\n$$ Z^\\* = \\max_{v} \\;\\; c^\\top v \\quad \\text{subject to} \\quad S v = 0, \\;\\; l \\le v \\le u $$\n\n在许多生物系统中，FBA 问题的最优解并不唯一。这种被称为多重最优解存在的现象，发生在可行空间包含一个解的子空间，这些解都能产生相同的最大目标值 $Z^\\*$ 时。从分析角度看，如果存在一个非零方向向量 $d \\in \\mathbb{R}^n$，使得对于一个最优通量分布 $v^\\*$，新的分布 $v = v^\\* + \\alpha d$ (对于某个标量 $\\alpha \\neq 0$) 也是一个最优解，那么多重最优解就存在。这需要方向向量 $d$ 满足三个条件：\n$1$. $S d = 0$：方向向量必须位于化学计量矩阵的零空间中，以维持稳态条件。此类向量代表网络内的平衡循环或替代途径。\n$2$. $c^\\top d = 0$：方向向量必须与目标向量 $c$ 正交。这确保了沿 $d$ 方向移动不会改变目标函数的值。\n$3$. $l \\le v^\\* + \\alpha d \\le u$：新的通量向量必须保持在指定的通量边界内。\n\n通量变异性分析 (FVA) 是一种计算方法，旨在描述多重最优解的全部范围。对于每个反应 $j$，FVA 确定在所有达到最优目标值 $Z^\\*$ 的解集中，通量 $v_j$ 可能的最小值和最大值。为了解决浮点运算中固有的数值不精确性，实际操作中允许通量达到真实最优值 $Z^\\*$ 的一个小容差 $\\delta$ 内的目标值。按规定，我们将目标通量约束在区间 $[Z^\\* - \\delta, Z^\\* + \\delta]$ 内。容差 $\\delta$ 定义为 $\\delta = \\max\\{10^{-9}, 10^{-9}\\cdot \\lvert Z^\\* \\rvert\\}$。\n\n对于每个反应 $j \\in \\{1, \\dots, n\\}$，FVA 需要求解两个线性规划问题：\n$$ v_j^{\\min} = \\min_{v} \\; e_j^\\top v \\quad \\text{subject to} \\quad S v = 0, \\;\\; l \\le v \\le u, \\;\\; Z^\\* - \\delta \\le c^\\top v \\le Z^\\* + \\delta $$\n$$ v_j^{\\max} = \\max_{v} \\; e_j^\\top v \\quad \\text{subject to} \\quad S v = 0, \\;\\; l \\le v \\le u, \\;\\; Z^\\* - \\delta \\le c^\\top v \\le Z^\\* + \\delta $$\n其中 $e_j$ 是第 $j$ 个标准基向量（一个在位置 $j$ 为 $1$ 其余为零的向量）。\n\n为每个测试用例解决该问题的计算步骤如下：\n$1$. 求解 FBA 问题以找到最优目标值 $Z^\\*$。最大化 $c^\\top v$ 等同于最小化 $(-c)^\\top v$。\n$2$. 计算容差 $\\delta$。\n$3$. 对每个反应 $j=1, \\ldots, n$：\n    a. 求解一个 LP 以找到 $v_j^{\\min}$。目标是最小化 $e_j^\\top v$。约束条件是 $S v = 0$、$l \\le v \\le u$ 以及关于原始目标的双侧区间约束，这可以表示为两个线性不等式：$c^\\top v \\le Z^\\* + \\delta$ 和 $-c^\\top v \\le -(Z^\\* - \\delta)$。\n    b. 求解第二个 LP 以找到 $v_j^{\\max}$。目标是最大化 $e_j^\\top v$，这等同于最小化 $(-e_j)^\\top v$，约束条件与步骤 3a 相同。\n$4$. 收集所有反应的 $[v_j^{\\min}, v_j^{\\max}]$ 对，形成给定模型的完整 FVA 结果。\n\n此过程将使用 `scipy.optimize.linprog` 函数来实现，该函数为线性规划问题提供了一个鲁棒的求解器。将计算三个测试用例的每一个的结果，并按规定格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run FVA on them, and print results.\n    \"\"\"\n    # Test case 1: Parallel pathways with alternative optima\n    S1 = np.array([\n        [1, -1, 0, -1, 0, 0],\n        [0, 1, -1, 0, 0, 0],\n        [0, 0, 0, 1, -1, 0],\n        [0, 0, 1, 0, 1, -1]\n    ], dtype=float)\n    l1 = np.array([0, 0, 0, 0, 0, 0], dtype=float)\n    u1 = np.array([10, 1000, 1000, 1000, 1000, 1000], dtype=float)\n    c1 = np.array([0, 0, 0, 0, 0, 1], dtype=float)\n    \n    # Test case 2: Unique optimal flow plus an internal reversible cycle\n    S2 = np.array([\n        [1, -1, 0, 0, 0, 0],\n        [0, 1, -1, 0, 0, 0],\n        [0, 0, 1, -1, 0, 0],\n        [0, 0, 0, 0, -1, 1],\n        [0, 0, 0, 0, 1, -1]\n    ], dtype=float)\n    l2 = np.array([0, 0, 0, 0, -5, -5], dtype=float)\n    u2 = np.array([10, 1000, 1000, 1000, 5, 5], dtype=float)\n    c2 = np.array([0, 0, 0, 1, 0, 0], dtype=float)\n\n    # Test case 3: Capacity-limited branch with a blocked reaction\n    S3 = np.array([\n        [1, -1, 0, -1, 0, 0, 0],\n        [0, 1, -1, 0, 0, 0, 0],\n        [0, 0, 0, 1, -1, 0, 0],\n        [0, 0, 1, 0, 1, -1, 0],\n        [0, 0, 0, 0, 0, 0, -1],\n        [0, 0, 0, 0, 0, 0, 1]\n    ], dtype=float)\n    l3 = np.array([0, 0, 0, 0, 0, 0, 0], dtype=float)\n    u3 = np.array([8, 1000, 3, 1000, 1000, 1000, 1000], dtype=float)\n    c3 = np.array([0, 0, 0, 0, 0, 1, 0], dtype=float)\n    \n    test_cases = [\n        (S1, l1, u1, c1),\n        (S2, l2, u2, c2),\n        (S3, l3, u3, c3)\n    ]\n\n    all_results = []\n    for S, l, u, c in test_cases:\n        fva_result = perform_fva(S, l, u, c)\n        all_results.append(fva_result)\n\n    # Format the final output string\n    formatted_cases = []\n    for case_results in all_results:\n        # Round and format each [min, max] pair\n        formatted_pairs = [f\"[{round(v_min, 6):.6f},{round(v_max, 6):.6f}]\" for v_min, v_max in case_results]\n        formatted_cases.append(f\"[{','.join(formatted_pairs)}]\")\n    \n    final_output = f\"[{','.join(formatted_cases)}]\"\n    print(final_output)\n\ndef perform_fva(S, l, u, c):\n    \"\"\"\n    Performs Flux Balance Analysis (FBA) followed by Flux Variability Analysis (FVA).\n    Args:\n        S (np.ndarray): Stoichiometric matrix.\n        l (np.ndarray): Lower bounds for fluxes.\n        u (np.ndarray): Upper bounds for fluxes.\n        c (np.ndarray): Objective function vector.\n    Returns:\n        list: A list of [min_flux, max_flux] pairs for each reaction.\n    \"\"\"\n    m, n = S.shape\n    bounds = list(zip(l, u))\n    b_eq = np.zeros(m)\n    \n    # 1. Perform FBA to find the optimal objective value Z*\n    # We maximize c'v, which is equivalent to minimizing -c'v\n    res_fba = linprog(c=-c, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs-ds')\n    \n    if not res_fba.success:\n        # Return empty/error if initial problem is infeasible\n        return [[None, None]] * n\n    \n    z_opt = -res_fba.fun\n\n    # 2. Perform FVA for each reaction\n    delta = max(1e-9, 1e-9 * abs(z_opt))\n    fva_ranges = []\n    \n    # Define the additional band constraint for FVA: Z* - delta <= c'v <= Z* + delta\n    # This becomes two inequality constraints:\n    # 1. c'v <= Z* + delta\n    # 2. -c'v <= -(Z* - delta)\n    A_ub_fva = np.vstack([c, -c])\n    b_ub_fva = np.array([z_opt + delta, -(z_opt - delta)])\n\n    for j in range(n):\n        # Minimize v_j\n        c_min = np.zeros(n)\n        c_min[j] = 1.0\n        res_min = linprog(c=c_min, A_ub=A_ub_fva, b_ub=b_ub_fva, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs-ds')\n        v_min = res_min.fun if res_min.success else 0.0\n\n        # Maximize v_j (by minimizing -v_j)\n        c_max = np.zeros(n)\n        c_max[j] = -1.0\n        res_max = linprog(c=c_max, A_ub=A_ub_fva, b_ub=b_ub_fva, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs-ds')\n        v_max = -res_max.fun if res_max.success else 0.0\n        \n        # Handle potential small negative values that should be zero\n        if abs(v_min)  1e-9: v_min = 0.0\n        if abs(v_max)  1e-9: v_max = 0.0\n\n        fva_ranges.append([v_min, v_max])\n        \n    return fva_ranges\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2579719"}]}