{"hands_on_practices": [{"introduction": "许多信号通路的第一步是配体与受体的结合。虽然简单的教学模型常常假设配体过量，但在真实的细胞环境中，受体浓度可能与配体浓度相当，导致配体被大量消耗。本练习 [@problem_id:2605662] 要求你基于质量作用定律和质量守恒定律，精确计算考虑了配体消耗（ligand depletion）效应的平衡状态下受体-配体复合物的比例，为理解信号起始的定量基础打下坚实根基。", "problem": "在充分混合的细胞外室中，单一类型的细胞膜受体响应可溶性配体并介导信号起始。假设为单价结合，每个受体有一个结合位点，不存在受体二聚化、内吞、竞争性结合伴侣或脱靶汇（即没有网络串扰）。该反应是热力学可逆的，并达到平衡。总受体浓度为 $R_T = 100\\,\\mathrm{nM}$，总配体浓度为 $L_T = 50\\,\\mathrm{nM}$，平衡解离常数为 $K_d = 10\\,\\mathrm{nM}$。仅使用质量作用定律、平衡解离常数的定义和质量守恒，计算与配体结合的受体在平衡状态下的分数，并正确考虑配体耗尽的影响。将最终答案表示为无量纲小数，并四舍五入到$4$位有效数字。", "solution": "我们考虑游离受体 $R$ 和游离配体 $L$ 之间形成复合物 $C$ 的单一可逆结合反应：\n$$\nR + L \\rightleftharpoons C.\n$$\n根据平衡时的质量作用定律，平衡解离常数 $K_d$ 定义为\n$$\nK_d = \\frac{[R][L]}{[C]}.\n$$\n质量守恒得出\n$$\nR_T = [R] + [C], \\quad L_T = [L] + [C],\n$$\n其中 $R_T$ 和 $L_T$ 分别表示总受体浓度和总配体浓度。设 $x = [C]$ 为复合物的平衡浓度。则 $[R] = R_T - x$ 且 $[L] = L_T - x$。代入 $K_d$ 的定义式得到\n$$\nK_d = \\frac{(R_T - x)(L_T - x)}{x}.\n$$\n整理得，\n$$\nK_d x = (R_T - x)(L_T - x) = R_T L_T - (R_T + L_T)x + x^2,\n$$\n由此得到关于 $x$ 的二次方程：\n$$\nx^2 - (R_T + L_T + K_d)x + R_T L_T = 0.\n$$\n物理上允许的根（即介于 $0$ 和 $\\min\\{R_T, L_T\\}$ 之间的根）为\n$$\nx = \\frac{(R_T + L_T + K_d) - \\sqrt{(R_T + L_T + K_d)^2 - 4 R_T L_T}}{2}.\n$$\n与配体结合的受体在平衡时的分数为\n$$\nf = \\frac{[C]}{R_T} = \\frac{x}{R_T}.\n$$\n现在我们代入给定值 $R_T = 100\\,\\mathrm{nM}$、$L_T = 50\\,\\mathrm{nM}$ 和 $K_d = 10\\,\\mathrm{nM}$：\n$$\nR_T + L_T + K_d = 100 + 50 + 10 = 160\\,\\mathrm{nM},\n$$\n$$\n4 R_T L_T = 4 \\times 100 \\times 50 = 20000\\,\\mathrm{nM}^2,\n$$\n$$\n(R_T + L_T + K_d)^2 = 160^2 = 25600\\,\\mathrm{nM}^2,\n$$\n所以判别式为\n$$\n\\Delta = 25600 - 20000 = 5600\\,\\mathrm{nM}^2,\n$$\n且\n$$\n\\sqrt{\\Delta} = \\sqrt{5600} \\approx 74.83314773547883\\,\\mathrm{nM}.\n$$\n因此\n$$\nx = \\frac{160 - 74.83314773547883}{2}\\,\\mathrm{nM} \\approx 42.58342613226058\\,\\mathrm{nM},\n$$\n结合分数为\n$$\nf = \\frac{x}{R_T} \\approx \\frac{42.58342613226058}{100} = 0.4258342613226058.\n$$\n作为无量纲小数四舍五入到 $4$ 位有效数字，\n$$\nf \\approx 0.4258.\n$$", "answer": "$$\\boxed{0.4258}$$", "id": "2605662"}, {"introduction": "信号通路并非简单的线性链条，而是由反馈回路等多种调控“基序”（motif）构成的复杂网络。本练习 [@problem_id:2605591] 将引导你通过解析推导，深入分析负反馈如何调节一个具有超敏性（ultrasensitivity）的信号模块。你将亲自推导负反馈如何削弱系统的表观灵敏度（有效Hill系数，$n_{\\mathrm{eff}}$）并改变其半数有效浓度（$\\mathrm{EC}_{50}$），从而掌握分析网络结构如何塑造系统稳态响应的核心技能。", "problem": "一个单输入单输出的生物化学信号模块表现出超敏性，其在稳态下的特性可以用希尔输入-输出关系来描述。设该模块接收有效刺激 $x$ 并产生输出 $Y$，其最大值为 $Y_{\\max}$。定义分数输出 $y \\equiv Y/Y_{\\max}$。该超敏性模块由希尔函数描述\n$$\ny \\;=\\; \\frac{x^{n}}{K^{n} + x^{n}},\n$$\n其中 $K$ 是半最大常数，$n$ 是希尔系数。由于网络串扰，输出对输入产生负反馈，根据以下关系式降低有效刺激：\n$$\nx \\;=\\; \\frac{S}{1 + \\gamma y},\n$$\n其中 $S$ 是外部刺激，$\\gamma \\ge 0$ 是一个无量纲的反馈强度参数，用于量化串扰介导的对输入的负反馈强度。\n\n仅使用上面给出的希尔函数和负反馈的定义，以及标准微积分，推导在稳态条件下以下两个量的闭合形式解析表达式：\n\n- 有效希尔系数 $n_{\\mathrm{eff}}$，定义为希尔图相对于外部刺激 $S$ 的局部斜率，\n$$\nn_{\\mathrm{eff}} \\;\\equiv\\; \\left.\\frac{d\\,\\ln\\!\\left(\\frac{y}{1-y}\\right)}{d\\,\\ln S}\\right|_{y=1/2}.\n$$\n\n- 闭环半最大输入 $\\mathrm{EC}_{50}^{\\mathrm{(cl)}}$，定义为在反馈条件下产生 $y=1/2$ 的 $S$ 值。\n\n将您的最终答案表示为一个行矩阵，其中按顺序包含用 $n$、$K$ 和 $\\gamma$ 表示的 $n_{\\mathrm{eff}}$ 和 $\\mathrm{EC}_{50}^{\\mathrm{(cl)}}$ 的表达式。无需进行数值计算，也无需单位。", "solution": "该问题是良定的，有科学依据，并包含了完整推导所需的所有信息。超敏性和负反馈的模型在生物化学系统分析领域是标准模型。我们将开始推导有效希尔系数 $n_{\\mathrm{eff}}$ 和闭环半最大输入 $\\mathrm{EC}_{50}^{\\mathrm{(cl)}}$ 的闭合形式表达式。\n\n首先，我们确定闭环半最大输入 $\\mathrm{EC}_{50}^{\\mathrm{(cl)}}$。该量被定义为当分数输出 $y$ 等于 $1/2$ 时外部刺激 $S$ 的值。我们将 $y=1/2$ 代入描述模块输出的希尔函数中：\n$$\n\\frac{1}{2} = \\frac{x^{n}}{K^{n} + x^{n}}\n$$\n对此方程进行代数变换可得：\n$$\nK^{n} + x^{n} = 2 x^{n}\n$$\n$$\nK^{n} = x^{n}\n$$\n由于有效刺激 $x$ 和半最大常数 $K$ 均为正实数，我们可以得出结论，在半最大输出时，有效刺激等于半最大常数：\n$$\nx = K\n$$\n现在，我们使用描述负反馈回路的方程，该方程将有效刺激 $x$ 与外部刺激 $S$ 和分数输出 $y$ 联系起来：\n$$\nx = \\frac{S}{1 + \\gamma y}\n$$\n我们代入半最大输出的条件，即 $y=1/2$ 和 $x=K$。根据定义，在这些条件下，外部刺激 $S$ 即为 $\\mathrm{EC}_{50}^{\\mathrm{(cl)}}$。\n$$\nK = \\frac{\\mathrm{EC}_{50}^{\\mathrm{(cl)}}}{1 + \\gamma \\left(\\frac{1}{2}\\right)}\n$$\n求解 $\\mathrm{EC}_{50}^{\\mathrm{(cl)}}$ 得到第一个所需表达式：\n$$\n\\mathrm{EC}_{50}^{\\mathrm{(cl)}} = K \\left(1 + \\frac{\\gamma}{2}\\right)\n$$\n\n其次，我们推导有效希尔系数 $n_{\\mathrm{eff}}$ 的表达式。它被定义为希尔图相对于外部刺激 $S$ 的局部斜率，在半最大输出点进行计算：\n$$\nn_{\\mathrm{eff}} \\equiv \\left.\\frac{d\\,\\ln\\!\\left(\\frac{y}{1-y}\\right)}{d\\,\\ln S}\\right|_{y=1/2}\n$$\n首先，我们来寻找项 $\\ln(y/(1-y))$ 的一个更方便的表达式。使用给定的希尔函数 $y = x^{n}/(K^{n} + x^{n})$，我们有：\n$$\n1-y = 1 - \\frac{x^{n}}{K^{n} + x^{n}} = \\frac{K^{n} + x^{n} - x^{n}}{K^{n} + x^{n}} = \\frac{K^{n}}{K^{n} + x^{n}}\n$$\n因此，比值 $y/(1-y)$ 为：\n$$\n\\frac{y}{1-y} = \\frac{x^{n}/(K^{n} + x^{n})}{K^{n}/(K^{n} + x^{n})} = \\frac{x^{n}}{K^{n}} = \\left(\\frac{x}{K}\\right)^{n}\n$$\n对该表达式取自然对数，得到一个简化的关系式：\n$$\n\\ln\\left(\\frac{y}{1-y}\\right) = n \\ln\\left(\\frac{x}{K}\\right) = n(\\ln x - \\ln K)\n$$\n现在我们可以将其代入 $n_{\\mathrm{eff}}$ 的定义中：\n$$\nn_{\\mathrm{eff}} = \\frac{d}{d\\,\\ln S} \\left[ n(\\ln x - \\ln K) \\right]\n$$\n由于 $n$ 和 $K$ 是常数，导数变为：\n$$\nn_{\\mathrm{eff}} = n \\frac{d(\\ln x)}{d(\\ln S)}\n$$\n为了计算这个导数，我们必须将 $x$与 $S$ 联系起来。我们使用反馈方程 $x = S / (1 + \\gamma y)$。对两边取自然对数可得：\n$$\n\\ln x = \\ln S - \\ln(1 + \\gamma y)\n$$\n我们现在对整个方程关于 $\\ln S$ 求导：\n$$\n\\frac{d(\\ln x)}{d(\\ln S)} = \\frac{d(\\ln S)}{d(\\ln S)} - \\frac{d}{d(\\ln S)}[\\ln(1 + \\gamma y)]\n$$\n右边的第一项为 1。对于第二项，我们应用链式法则：\n$$\n\\frac{d(\\ln x)}{d(\\ln S)} = 1 - \\frac{d}{dy}[\\ln(1 + \\gamma y)] \\cdot \\frac{dy}{d(\\ln S)} = 1 - \\frac{\\gamma}{1+\\gamma y} \\frac{dy}{d(\\ln S)}\n$$\n为了求出 $\\frac{dy}{d(\\ln S)}$，我们再次使用链式法则，通过中间变量 $x$ 将 $y$ 与 $S$ 联系起来：\n$$\n\\frac{dy}{d(\\ln S)} = \\frac{dy}{d(\\ln x)} \\frac{d(\\ln x)}{d(\\ln S)}\n$$\n项 $\\frac{dy}{d(\\ln x)}$ 是开环模块的局部灵敏度。我们已经证明了 $\\ln(y/(1-y)) = n \\ln(x/K)$。对该式关于 $\\ln x$ 求导：\n$$\n\\frac{d}{d(\\ln x)}\\left[\\ln y - \\ln(1-y)\\right] = \\frac{d}{d(\\ln x)}[n(\\ln x - \\ln K)]\n$$\n$$\n\\frac{1}{y}\\frac{dy}{d(\\ln x)} - \\frac{1}{1-y}\\left(-\\frac{dy}{d(\\ln x)}\\right) = n\n$$\n$$\n\\frac{dy}{d(\\ln x)}\\left(\\frac{1}{y} + \\frac{1}{1-y}\\right) = n \\implies \\frac{dy}{d(\\ln x)}\\left(\\frac{1-y+y}{y(1-y)}\\right) = n\n$$\n这给出了众所周知的结果：\n$$\n\\frac{dy}{d(\\ln x)} = n y (1-y)\n$$\n将其代回，我们得到：\n$$\n\\frac{dy}{d(\\ln S)} = n y (1-y) \\frac{d(\\ln x)}{d(\\ln S)}\n$$\n现在我们将这个表达式代入我们关于 $\\frac{d(\\ln x)}{d(\\ln S)}$ 的方程中：\n$$\n\\frac{d(\\ln x)}{d(\\ln S)} = 1 - \\frac{\\gamma}{1+\\gamma y} \\left[ n y (1-y) \\frac{d(\\ln x)}{d(\\ln S)} \\right]\n$$\n为了简化符号，设 $A = \\frac{d(\\ln x)}{d(\\ln S)}$。我们可以重新整理以求解 $A$：\n$$\nA \\left[1 + \\frac{n \\gamma y (1-y)}{1+\\gamma y}\\right] = 1\n$$\n$$\nA = \\frac{1}{1 + \\frac{n \\gamma y (1-y)}{1+\\gamma y}} = \\frac{1+\\gamma y}{1+\\gamma y + n \\gamma y (1-y)}\n$$\n回想一下 $n_{\\mathrm{eff}} = n A$，我们有：\n$$\nn_{\\mathrm{eff}} = n \\left( \\frac{1+\\gamma y}{1+\\gamma y + n \\gamma y (1-y)} \\right)\n$$\n问题要求在 $y=1/2$ 处计算该量。在该点：\n$$\ny=1/2, \\quad 1-y=1/2, \\quad y(1-y)=1/4\n$$\n代入这些值：\n$$\nn_{\\mathrm{eff}} = n \\left( \\frac{1+\\gamma/2}{1+\\gamma/2 + n \\gamma (1/4)} \\right) = n \\left( \\frac{1+\\gamma/2}{1+\\gamma/2 + n\\gamma/4} \\right)\n$$\n为了简化这个表达式，我们将分数的分子和分母同乘以 $4$：\n$$\nn_{\\mathrm{eff}} = n \\left( \\frac{4(1+\\gamma/2)}{4(1+\\gamma/2) + 4(n\\gamma/4)} \\right) = n \\left( \\frac{4+2\\gamma}{4+2\\gamma+n\\gamma} \\right)\n$$\n这可以写成一个更加因子化的形式：\n$$\nn_{\\mathrm{eff}} = \\frac{2n(2+\\gamma)}{4+(n+2)\\gamma}\n$$\n这就是有效希尔系数的最终表达式。\n所求两个量的最终结果是：\n$\\mathrm{EC}_{50}^{\\mathrm{(cl)}} = K(1 + \\gamma/2)$ 和 $n_{\\mathrm{eff}} = \\frac{2n(2+\\gamma)}{4+(n+2)\\gamma}$。\n我们将按照要求将它们以行矩阵的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2n(2+\\gamma)}{4+(n+2)\\gamma} & K\\left(1+\\frac{\\gamma}{2}\\right) \\end{pmatrix}}\n$$", "id": "2605591"}, {"introduction": "稳态分析为我们提供了系统在特定条件下的静态快照，但要全面理解信号通路的功能，必须探究其动态行为。这项计算生物学练习 [@problem_id:2605661] 邀请你通过编程来模拟经典的NF-κB信号通路。你将构建一个包含延迟负反馈的动力学模型，并通过改变上游激酶IKK信号的持续时间，观察并分析核内NF-κB如何产生振荡行为，从而直观地理解信号的“编码”与“解码”过程。", "problem": "提供一个活化B细胞核因子κ轻链增强子 (NF-$\\kappa$B) 信号通路的极简动力学模型，该模型包含κB抑制蛋白 (I$\\kappa$B) 负反馈和脉冲式κB抑制蛋白激酶 (IKK) 输入。该模型基于质量作用动力学和Hill型转录调控，这在生化反应网络建模中是标准方法。您将需要实现该模型，针对一组IKK脉冲持续时间进行模拟，并计算每种情况下NF-$\\kappa$B核转运的峰值数量。最后，您将使用时间尺度论证来解释观察到的对脉冲持续时间的依赖性。\n\n基本原理和假设：\n- 使用源自质量平衡和类质量作用动力学的常微分方程来描述物种的相互转化和降解。\n- 使用Hill函数来表示核内NF-$\\kappa$B对I$\\kappa$B信使核糖核酸(mRNA)的转录激活，这是一种对协同性启动子激活的标准粗粒化表示。\n- 保持NF-$\\kappa$B总丰度为一个固定值，并通过减少可用于核输入的库来表示I$\\kappa$B对胞质NF-$\\kappa$B的隔离。\n\n状态变量：\n- $N_n(t)$：核内NF-$\\kappa$B丰度（任意单位）。\n- $I_m(t)$：I$\\kappa$B mRNA丰度（任意单位）。\n- $I(t)$：I$\\kappa$B蛋白质丰度（任意单位）。\n\n输入：\n- $u(t)$：IKK活性，建模为振幅为$A$、持续时间为$D$分钟的矩形脉冲，其中当$0 \\le t \\le D$时，$u(t) = A$，否则$u(t) = 0$。\n\n模型方程：\n- $$\\frac{d I_m}{dt} = k_{\\mathrm{tx}} \\cdot \\frac{N_n(t)^h}{K^h + N_n(t)^h} - k_{\\mathrm{mdeg}} \\cdot I_m(t)$$\n- $$\\frac{d I}{dt} = k_{\\mathrm{tl}} \\cdot I_m(t) - \\left(k_{\\mathrm{deg0}} + k_{\\mathrm{deg1}} \\cdot u(t)\\right) \\cdot I(t)$$\n- $$\\frac{d N_n}{dt} = k_{\\mathrm{in}} \\cdot N_{\\mathrm{free}}(t) - k_{\\mathrm{out}} \\cdot N_n(t)$$\n其中：\n- $$N_{\\mathrm{free}}(t) = \\frac{N_{\\mathrm{tot}} - N_n(t)}{1 + \\alpha \\cdot I(t)}$$\n该式从现象学上捕捉了I$\\kappa$B对胞质NF-$\\kappa$B的隔离。\n\n使用的参数（时间单位为分钟，所有其他量均使用一致的任意单位）：\n- $N_{\\mathrm{tot}} = 1.0$\n- $k_{\\mathrm{in}} = 0.5$\n- $k_{\\mathrm{out}} = 0.05$\n- $\\alpha = 50.0$\n- $k_{\\mathrm{tx}} = 0.5$\n- $K = 0.2$\n- $h = 4$\n- $k_{\\mathrm{mdeg}} = 0.01$\n- $k_{\\mathrm{tl}} = 0.1$\n- $k_{\\mathrm{deg0}} = 0.002$\n- $k_{\\mathrm{deg1}} = 0.01$\n- $A = 1.0$\n\n模拟方案：\n- 通过在$t = 0$到$t = T_{\\mathrm{pre}}$（其中$T_{\\mathrm{pre}} = 1000$分钟）的时间段内，以$u(t) \\equiv 0$进行模拟，在无刺激条件下对系统进行预平衡。使用任意合理的非负初始条件，并将结束状态作为脉冲模拟在$t = 0$时的稳态初始条件。\n- 对于每个脉冲持续时间$D$，使用如上定义的输入$u(t)$，在$t = 0$到$t = T_{\\mathrm{sim}}(D)$的时间段内模拟系统，其中$T_{\\mathrm{sim}}(D) = D + T_{\\mathrm{post}}$且$T_{\\mathrm{post}} = 360$分钟。时间单位为分钟。\n- 以足以检测峰值的均匀分辨率对核内NF-$\\kappa$B轨迹$N_n(t)$进行采样；$\\Delta t = 0.5$分钟的步长是足够的。\n\n峰值计数：\n- 定义一个核转运峰值为$N_n(t)$的局部最大值，该最大值需满足最小高度条件$N_n \\ge N_{\\mathrm{th}}$和最小突出度，以避免计算噪声，其中$N_{\\mathrm{th}} = 0.15$，最小突出度为$0.05$（与$N_n$使用相同的任意单位）。\n- 为避免计算时程开始时可能出现的数值伪影，舍弃任何在$t_{\\mathrm{min}} = 1.0$分钟之前出现的峰值。\n- 施加峰值之间最小时间间隔为$\\Delta t_{\\mathrm{min}} = 20$分钟，以反映与I$\\kappa$B再合成相关的生物不应期。\n\n所需输出：\n- 对于每个脉冲持续时间$D$，根据上述标准计算在区间$t \\in [0, T_{\\mathrm{sim}}(D)]$内核内NF-$\\kappa$B轨迹$N_n(t)$的整数峰值数量。\n\n测试套件：\n- 使用以下IKK脉冲持续时间（单位：分钟）：$[0.0, 5.0, 30.0, 120.0, 480.0]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如，$”[r_1,r_2,r_3,r_4,r_5]”$，其中每个$r_i$是按给定顺序对应的测试用例的整数峰值数量。\n\n交付成果：\n- 一个完整的程序，该程序执行预平衡，针对指定的脉冲持续时间运行模拟，按规定计数峰值，并以上述确切格式打印单行输出。在注释或文档中，包含一个简要的基于时间尺度的论证，解释为什么增加IKK脉冲持续时间$D$会倾向于增加这个负反馈系统中核转运峰值的数量。所有时间量必须解释为分钟，输出为无单位整数。", "solution": "该问题已通过验证。\n\n**第1步：提取给定信息**\n所提供的信息包括一个常微分方程（ODE）系统、参数和一个模拟方案。\n- 状态变量：$I_m(t)$（I$\\kappa$B mRNA）、$I(t)$（I$\\kappa$B蛋白质）、$N_n(t)$（核内NF-$\\kappa$B）。\n- 输入信号：$u(t)$表示IKK活性，其中当$0 \\le t \\le D$时，$u(t) = A$，否则$u(t) = 0$。\n- 模型方程：\n$$ \\frac{d I_m}{dt} = k_{\\mathrm{tx}} \\cdot \\frac{N_n(t)^h}{K^h + N_n(t)^h} - k_{\\mathrm{mdeg}} \\cdot I_m(t) $$\n$$ \\frac{d I}{dt} = k_{\\mathrm{tl}} \\cdot I_m(t) - \\left(k_{\\mathrm{deg0}} + k_{\\mathrm{deg1}} \\cdot u(t)\\right) \\cdot I(t) $$\n$$ \\frac{d N_n}{dt} = k_{\\mathrm{in}} \\cdot N_{\\mathrm{free}}(t) - k_{\\mathrm{out}} \\cdot N_n(t) $$\n- 辅助方程：\n$$ N_{\\mathrm{free}}(t) = \\frac{N_{\\mathrm{tot}} - N_n(t)}{1 + \\alpha \\cdot I(t)} $$\n- 参数：$N_{\\mathrm{tot}} = 1.0$，$k_{\\mathrm{in}} = 0.5 \\text{ min}^{-1}$，$k_{\\mathrm{out}} = 0.05 \\text{ min}^{-1}$，$\\alpha = 50.0$，$k_{\\mathrm{tx}} = 0.5 \\text{ min}^{-1}$，$K = 0.2$，$h = 4$，$k_{\\mathrm{mdeg}} = 0.01 \\text{ min}^{-1}$，$k_{\\mathrm{tl}} = 0.1 \\text{ min}^{-1}$，$k_{\\mathrm{deg0}} = 0.002 \\text{ min}^{-1}$，$k_{\\mathrm{deg1}} = 0.01 \\text{ min}^{-1}$，$A = 1.0$。\n- 模拟方案：\n  - 预平衡：$T_{\\mathrm{pre}} = 1000$ 分钟，其中 $u(t)=0$。\n  - 模拟：对于每个持续时间$D$，从$t=0$积分到$T_{\\mathrm{sim}}(D) = D + 360$ 分钟。\n  -采样时间步长：$\\Delta t = 0.5$ 分钟。\n- 峰值计数标准：\n  - 最小高度：$N_{\\mathrm{th}} = 0.15$。\n  - 最小突出度：$0.05$。\n  - 最小起始时间：$t_{\\mathrm{min}} = 1.0$ 分钟。\n  - 最小间隔：$\\Delta t_{\\mathrm{min}} = 20$ 分钟。\n- $D$的测试用例：$[0.0, 5.0, 30.0, 120.0, 480.0]$ 分钟。\n\n**第2步：使用提取的给定信息进行验证**\n对问题进行有效性分析。\n- **科学基础**：该模型是NF-$\\kappa$B信号通路的标准表示，是生物振荡器由负反馈回路驱动的典型例子。使用质量作用动力学和Hill函数的数学公式是系统生物学中公认且科学合理的方法。\n- **适定性**：该问题定义了一个带有指定参数和确定初始条件程序的一阶非自治常微分方程系统。ODE系统的右侧由在生物学相关域（非负浓度）上连续可微（利普希茨连续）的初等函数组成。这保证了对于给定的初始条件，解的存在性和唯一性，使其成为一个适定的初值问题。\n- **完整性和一致性**：该问题是自洽的。所有必需的方程、常数、初始/边界条件和分析程序都已明确提供。没有矛盾之处。单位是一致的（时间单位为分钟，浓度单位为任意单位）。\n\n**第3步：结论与行动**\n该问题是**有效的**。这是一个定义明确、具有科学依据的计算系统生物学问题。我将继续进行求解。\n\n**求解步骤**\n\n求解过程包括三个主要阶段：系统预平衡、刺激-响应模拟和用于峰值计数的轨迹分析。\n\n1.  **系统预平衡**：为了建立系统的基础、未受刺激的状态，我们必须首先在没有IKK刺激的情况下找到所有物种的稳态浓度。这是通过在所有时间将输入$u(t)$设置为零来求解ODE系统实现的。\n    需要求解的系统是：\n    $$ \\frac{d I_m}{dt} = k_{\\mathrm{tx}} \\frac{N_n^h}{K^h + N_n^h} - k_{\\mathrm{mdeg}} I_m $$\n    $$ \\frac{d I}{dt} = k_{\\mathrm{tl}} I_m - k_{\\mathrm{deg0}} I $$\n    $$ \\frac{d N_n}{dt} = k_{\\mathrm{in}} \\frac{N_{\\mathrm{tot}} - N_n}{1 + \\alpha I} - k_{\\mathrm{out}} N_n $$\n    我们从一个非负初始条件（例如，$[I_m, I, N_n] = [0, 0, 0]$）开始，对该系统进行数值积分，持续时间为$T_{\\mathrm{pre}} = 1000$分钟。这个时间足够长，可以使系统收敛到其不动点。在$t = T_{\\mathrm{pre}}$时的状态向量随后被用作后续模拟的初始条件，$\\vec{y}_0 = [I_m(0), I(0), N_n(0)]$。\n\n2.  **刺激-响应模拟**：对于所提供的测试套件中的每个脉冲持续时间$D$，模拟包含时变输入$u(t)$的完整系统。从预平衡状态$\\vec{y}_0$开始，将ODE系统从$t=0$积分到$T_{\\mathrm{sim}}(D) = D + 360$分钟。输入$u(t)$实现为分段函数：\n    $$ u(t) = \\begin{cases} A, & \\text{if } 0 \\le t \\le D \\\\ 0, & \\text{if } t > D \\end{cases} $$\n    使用鲁棒的ODE求解器（如`scipy.integrate.solve_ivp`）执行数值积分，并在$\\Delta t = 0.5$分钟的均匀时间间隔内评估解，以生成$N_n(t)$的时间序列。\n\n3.  **峰值检测和计数**：分析模拟的核内NF-$\\kappa$B轨迹$N_n(t)$以量化易位事件的数量。峰值定义为$N_n(t)$信号中的局部最大值。我们使用标准的峰值检测算法，例如`scipy.signal.find_peaks`，来识别这些最大值。然后根据以下严格标准对识别出的峰值进行过滤：\n    - 峰值高度必须为$N_n(t_{\\text{peak}}) \\ge N_{\\mathrm{th}} = 0.15$。\n    - 峰值必须具有至少$0.05$的突出度。突出度衡量一个峰值从周围信号中脱颖而出的程度。\n    - 舍弃在$t_{\\mathrm{min}} = 1.0$分钟之前出现的峰值，以避免模拟开始时的数值伪影。\n    - 在连续峰值之间强制执行$\\Delta t_{\\mathrm{min}} = 20$分钟的最小时间间隔。这反映了生物学上的不应期。\n    对于给定的脉冲持续时间$D$，通过所有过滤器的最终峰值计数即为结果。\n\n对于测试套件中的每个$D$值，重复此整个过程，以生成最终的结果列表。在实现代码的文档中提供了对结果趋势的解释。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.signal import find_peaks\n\ndef solve():\n    \"\"\"\n    本程序求解一个NF-kB信号通路的极简动力学模型，以确定\n    核转运峰值数量与刺激持续时间的关系。\n\n    对观察到的行为的基于时间尺度的论证：\n    这里建模的NF-kB信号系统是一个经典的负反馈振荡器。\n    1.  刺激开始：IKK刺激`u(t)`增强了抑制剂`I`(IkB)的降解。\n        这使得NF-kB从细胞质的隔离中释放出来。\n    2.  第一个峰值：游离的NF-kB转运到细胞核，导致`N_n`上升并形成一个峰值。\n    3.  负反馈：高水平的`N_n`通过一个中间产物`I_m`(IkB mRNA)，转录上调其自身的抑制剂`I`。\n        由于转录和翻译的顺序过程，这个反馈具有内在的时间延迟。\n    4.  抑制：随着新合成的`I`蛋白积累，它再次在细胞质中隔离NF-kB，\n        并且核输出进一步降低`N_n`，导致信号下降。\n    5.  持续振荡：如果刺激持续时间`D`足够长，超过了反馈延迟，\n        IKK活性将降解新合成的抑制剂，重新启动这个循环，\n        从而导致后续的峰值。系统的固有振荡周期由转录、翻译\n        和核转运的时间尺度决定。\n    6.  对D的依赖性：因此，峰值的数量取决于刺激持续时间`D`与\n        系统固有反馈周期`tau_fb`的比值。\n        - 如果`D`非常短（短于到达第一个峰值的时间），则不会发生显著响应。\n        - 如果`D`足够长，可以产生一次响应，但短于`tau_fb`，则观察到一个峰值。\n        - 随着`D`的增加，它可以包含`tau_fb`的多个周期，从而允许系统振荡\n          并在刺激被移除、系统衰减回稳态之前产生更多的峰值。\n          因此，峰值的数量预期是`D`的非递减函数。\n    \"\"\"\n\n    # 定义模型参数\n    params = {\n        'N_tot': 1.0,\n        'k_in': 0.5,\n        'k_out': 0.05,\n        'alpha': 50.0,\n        'k_tx': 0.5,\n        'K': 0.2,\n        'h': 4.0,\n        'k_mdeg': 0.01,\n        'k_tl': 0.1,\n        'k_deg0': 0.002,\n        'k_deg1': 0.01,\n        'A': 1.0,  # u(t) 的振幅\n    }\n\n    # 模拟和分析参数\n    T_pre = 1000.0  # 分钟\n    T_post = 360.0  # 分钟\n    dt = 0.5  # 分钟\n\n    # 峰值计数参数\n    N_th = 0.15\n    prominence = 0.05\n    t_min_peak = 1.0  # 分钟\n    delta_t_min_peak = 20.0  # 分钟\n    \n    # 脉冲持续时间D的测试套件\n    test_cases = [0.0, 5.0, 30.0, 120.0, 480.0]\n\n    # --- 第1步：预平衡 ---\n    def odes_pre(t, y, p):\n        I_m, I, N_n = y\n        # 无刺激, u(t) = 0\n        N_free = (p['N_tot'] - N_n) / (1.0 + p['alpha'] * I)\n        \n        dIm_dt = p['k_tx'] * (N_n**p['h']) / (p['K']**p['h'] + N_n**p['h']) - p['k_mdeg'] * I_m\n        dI_dt = p['k_tl'] * I_m - p['k_deg0'] * I\n        dNn_dt = p['k_in'] * N_free - p['k_out'] * N_n\n        \n        return [dIm_dt, dI_dt, dNn_dt]\n\n    y0_initial = [0.0, 0.0, 0.0]\n    sol_pre = solve_ivp(\n        odes_pre,\n        [0, T_pre],\n        y0_initial,\n        args=(params,),\n        dense_output=True\n    )\n    y0_ss = sol_pre.sol(T_pre)\n\n    # --- 第2步和第3步：模拟与峰值计数循环 ---\n    \n    def odes_pulse(t, y, p, D):\n        I_m, I, N_n = y\n        \n        u_t = p['A'] if 0 = t = D else 0.0\n        \n        N_free = (p['N_tot'] - N_n) / (1.0 + p['alpha'] * I)\n        \n        dIm_dt = p['k_tx'] * (N_n**p['h']) / (p['K']**p['h'] + N_n**p['h']) - p['k_mdeg'] * I_m\n        dI_dt = p['k_tl'] * I_m - (p['k_deg0'] + p['k_deg1'] * u_t) * I\n        dNn_dt = p['k_in'] * N_free - p['k_out'] * N_n\n        \n        return [dIm_dt, dI_dt, dNn_dt]\n\n    results = []\n    for D in test_cases:\n        T_sim = D + T_post\n        t_eval = np.arange(0, T_sim + dt, dt)\n        \n        sol = solve_ivp(\n            odes_pulse,\n            [0, T_sim],\n            y0_ss,\n            args=(params, D),\n            t_eval=t_eval,\n            method='RK45'\n        )\n        \n        t_traj = sol.t\n        Nn_traj = sol.y[2, :]\n\n        # 峰值计数\n        distance_indices = int(delta_t_min_peak / dt)\n        \n        peaks, _ = find_peaks(\n            Nn_traj,\n            height=N_th,\n            prominence=prominence,\n            distance=distance_indices\n        )\n        \n        # 按最小时间过滤峰值\n        final_peaks = [p for p in peaks if t_traj[p] >= t_min_peak]\n        \n        num_peaks = len(final_peaks)\n        results.append(num_peaks)\n\n    # 按照确切要求的格式打印最终结果。\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2605661"}]}