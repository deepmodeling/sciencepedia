{"hands_on_practices": [{"introduction": "磷酸戊糖途径的非氧化阶段是代谢灵活性的一个杰出典范，它允许细胞将戊糖磷酸转化回糖酵解中间产物。这个基础练习要求你从第一性原理出发，利用转酮醇酶（transketolase）和转醛醇酶（transaldolase）的已知酶促步骤，推导出净反应方程式。掌握这种碳骨架重排对于理解细胞如何平衡 $\\text{NADPH}$ 的产生与生物合成前体的需求至关重要。[@problem_id:2584949]", "problem": "一个正在进行磷酸戊糖途径非氧化阶段的细胞，只能利用由异构酶/差向异构酶、转酮醇酶和转醛醇酶催化的可逆碳骨架重排反应。请使用以下基本生化原理：\n\n- 磷酸糖异构酶/差向异构酶在不改变碳原子数或磷酸化状态的情况下相互转化磷酸戊糖；这些步骤是氧化还原中性的，不消耗三磷酸腺苷（$\\text{ATP}$）。\n- 转酮醇酶（需要焦磷酸硫胺素（ThDP）作为催化辅因子）将一个二碳单元从酮糖供体转移到醛糖受体；该反应是可逆的、氧化还原中性的，并保守磷酸基团。\n- 转醛醇酶与酮糖供体形成一个希夫碱，以将一个三碳单元转移到醛糖受体；该反应是可逆的、氧化还原中性的，并保守磷酸基团。\n\n从 $3$ 个 5-磷酸核糖分子出发，根据第一性原理推导出一个平衡的净化学计量式，其产物仅为属于核心糖酵解中间产物的磷酸己糖和磷酸丙糖。然后，从机理上论证为什么在此转化过程中没有氧化态的净变化，也没有$\\text{ATP}$的净消耗或产生。\n\n最后，报告所要求的单一数值：在此净转化中，最终进入6-磷酸果糖的总输入碳的比例。请用最简分数表示您的答案。无需四舍五入，最终数值答案中不应包含单位。", "solution": "该问题陈述科学严谨、表述清晰且客观。它描述了一个典型的生化转化过程——磷酸戊糖途径的非氧化阶段——并要求基于既定原理进行化学计量和机理分析。我们将开始推导。\n\n目标是将 $3$ 个 5-磷酸核糖（$R5P$，一种磷酸戊糖，$C_5P$）分子转化为糖酵解的中间产物，特别是磷酸己糖（$C_6P$）和磷酸丙糖（$C_3P$）。起始的总碳原子数为 $3 \\times 5 = 15$。整个过程必须在碳原子和磷酸基团上保持平衡。\n\n提供的酶是异构酶/差向异构酶、转酮醇酶和转醛醇酶。转酮醇酶和转醛醇酶需要一个磷酸酮糖作为碳单元转移的供体底物。5-磷酸核糖是一种磷酸醛糖。因此，需要先进行异构化和差向异构化反应以产生所需的酮糖底物。我们从 $3$ 个 $R5P$ 分子开始。我们将其中 $2$ 个分子转化为酮戊糖 5-磷酸木酮糖（$Xu5P$），剩下 $1$ 个 $R5P$ 分子。\n\n步骤 0：异构化和差向异构化\n1. 5-磷酸核糖异构酶将一个 $R5P$ 分子转化为 5-磷酸核酮糖（$Ru5P$）。\n$$ \\text{Ribose-5-phosphate} \\rightleftharpoons \\text{Ribulose-5-phosphate} $$\n2. 5-磷酸核酮糖差向异构酶接着将这个 $Ru5P$ 转化为 5-磷酸木酮糖（$Xu5P$）。\n$$ \\text{Ribulose-5-phosphate} \\rightleftharpoons \\text{Xylulose-5-phosphate} $$\n对第二个 $R5P$ 分子重复这两个步骤。净结果是 $2$ 个 $R5P$ 分子转化为 $2$ 个 $Xu5P$ 分子。因此，重排反应的起始分子库是 $2$ 个 $Xu5P$ 分子和 $1$ 个 $R5P$ 分子。\n\n现在，我们进行碳骨架重排。\n\n步骤 1：第一次转酮醇酶反应\n转酮醇酶将一个 $2$-碳（$C_2$）单元从酮糖供体转移到醛糖受体。\n在这里，供体是一个 $Xu5P$（一种 $C_5$ 酮糖）分子，受体是那一个 $R5P$（一种 $C_5$ 醛糖）分子。\n$$ \\underset{(C_5)}{\\text{Xylulose-5-P}} + \\underset{(C_5)}{\\text{Ribose-5-P}} \\xrightarrow{\\text{Transketolase}} \\underset{(C_7)}{\\text{Sedoheptulose-7-P}} + \\underset{(C_3)}{\\text{Glyceraldehyde-3-P}} $$\n产物是 7-磷酸景天庚酮糖（$S7P$，一种 $C_7$ 酮糖）和 3-磷酸甘油醛（$G3P$，一种 $C_3$ 醛糖）。此时，我们已消耗 $1$ 个 $Xu5P$ 和 $1$ 个 $R5P$。我们还剩下 $1$ 个 $Xu5P$，并生成了 $1$ 个 $S7P$ 和 $1$ 个 $G3P$。\n\n步骤 2：转醛醇酶反应\n转醛醇酶将一个 $3$-碳（$C_3$）单元从酮糖供体转移到醛糖受体。\n供体是 $S7P$（步骤 1 中的 $C_7$ 酮糖），受体是 $G3P$（步骤 1 中的 $C_3$ 醛糖）。\n$$ \\underset{(C_7)}{\\text{Sedoheptulose-7-P}} + \\underset{(C_3)}{\\text{Glyceraldehyde-3-P}} \\xrightarrow{\\text{Transaldolase}} \\underset{(C_6)}{\\text{Fructose-6-P}} + \\underset{(C_4)}{\\text{Erythrose-4-P}} $$\n产物是 6-磷酸果糖（$F6P$，一种 $C_6$ 酮糖）和 4-磷酸赤藓糖（$E4P$，一种 $C_4$ 醛糖）。$F6P$ 是一个糖酵解中间产物。步骤 1 中产生的中间产物 $S7P$ 和 $G3P$ 现已消耗完毕。我们现在有 $1$ 个 $Xu5P$（来自初始分子库）、$1$ 个 $F6P$ 和 $1$ 个 $E4P$。\n\n步骤 3：第二次转酮醇酶反应\n发生第二次转酮醇酶反应。供体是剩余的 $Xu5P$ 分子（一种 $C_5$ 酮糖），受体是 $E4P$（步骤 2 中的 $C_4$ 醛糖）。\n$$ \\underset{(C_5)}{\\text{Xylulose-5-P}} + \\underset{(C_4)}{\\text{Erythrose-4-P}} \\xrightarrow{\\text{Transketolase}} \\underset{(C_6)}{\\text{Fructose-6-P}} + \\underset{(C_3)}{\\text{Glyceraldehyde-3-P}} $$\n该反应产生第二个 $F6P$ 分子和一个 $G3P$ 分子。两者都是糖酵解中间产物。\n\n总结与净化学计量\n让我们将所有反应相加（不包括初始的异构化反应，因为从 $2$ 个 $Xu5P$ 和 $1$ 个 $R5P$ 开始已经隐含了这些反应）：\n1. $Xu5P + R5P \\rightarrow S7P + G3P$\n2. $S7P + G3P \\rightarrow F6P + E4P$\n3. $Xu5P + E4P \\rightarrow F6P + G3P$\n\n将左右两侧相加：\n$$ (Xu5P + R5P) + (S7P + G3P) + (Xu5P + E4P) \\rightarrow (S7P + G3P) + (F6P + E4P) + (F6P + G3P) $$\n消去两侧都出现的中间产物（$S7P$、一个 $G3P$ 和 $E4P$）：\n$$ 2 \\text{ } Xu5P + 1 \\text{ } R5P \\rightarrow 2 \\text{ } F6P + 1 \\text{ } G3P $$\n由于 $2$ 个 $Xu5P$ 和 $1$ 个 $R5P$ 是从初始的 $3$ 个 $R5P$ 分子库中衍生出来的，因此总的净反应是：\n$$ 3 \\text{ Ribose-5-phosphate} \\rightarrow 2 \\text{ Fructose-6-phosphate} + 1 \\text{ Glyceraldehyde-3-phosphate} $$\n碳平衡检查：输入 $3 \\times C_5 = 15$ 个碳原子。输出 $2 \\times C_6 + 1 \\times C_3 = 12 + 3 = 15$ 个碳原子。化学计量是正确的。\n\n中性的机理阐述\n1. 氧化态无净变化：整个途径是氧化还原中性的，因为其组成的酶促反应均不涉及氧化或还原。异构酶和差向异构酶只重排原子。转酮醇酶和转醛醇酶反应是 C-C 键的断裂和形成事件，由稳定的碳负离子中间体（对于转酮醇酶是在 ThDP 上）或希夫碱中间体（对于转醛醇酶）介导。这些机理促进了碳单元的转移，而不会改变所涉及碳原子的氧化态总和。没有像 $\\text{NAD}^+$ 或 $\\text{NADP}^+$ 这样的氧化还原辅因子参与，而这些辅因子是生物氧化还原反应的标志。因此，整个净过程是氧化还原中性的。\n\n2. 无$\\text{ATP}$的净消耗或产生：这些反应是简单的重排和转移。在任何步骤中，$\\text{ATP}$既不是底物也不是产物。每个糖分子上的磷酸基团都被保留，并与其碳骨架片段一起转移。没有激酶反应（会消耗$\\text{ATP}$来添加磷酸基团）或底物水平磷酸化反应（会通过将磷酸基团转移到$\\text{ADP}$来产生$\\text{ATP}$）。因此，该途径是$\\text{ATP}$中性的。\n\n6-磷酸果糖中的碳比例\n最后的任务是计算进入产物 6-磷酸果糖（$F6P$）中的碳原子占总输入碳原子的比例。\n来自 $3$ 个 5-磷酸核糖分子的总输入碳：\n$$ C_{\\text{total}} = 3 \\text{ molecules} \\times 5 \\text{ carbons/molecule} = 15 \\text{ carbons} $$\n来自净反应的产物 6-磷酸果糖中的总碳量：\n$$ C_{F6P} = 2 \\text{ molecules} \\times 6 \\text{ carbons/molecule} = 12 \\text{ carbons} $$\n该比例是 $F6P$ 中的碳与总输入碳的比值：\n$$ \\text{Fraction} = \\frac{C_{F6P}}{C_{\\text{total}}} = \\frac{12}{15} $$\n将此分数化为最简形式：\n$$ \\frac{12}{15} = \\frac{4 \\times 3}{5 \\times 3} = \\frac{4}{5} $$\n因此，来自磷酸戊糖的初始碳中有 $4/5$ 被转化为了磷酸己糖。", "answer": "$$\\boxed{\\frac{4}{5}}$$", "id": "2584949"}, {"introduction": "除了净化学计量，理解代谢网络还需要追踪单个原子的实际去向，而稳定同位素示踪是完成此任务的首要工具。本思想实验模拟了一项 $^{13}\\text{C}$ 标记研究，旨在厘清糖酵解与磷酸戊糖途径之间的碳流。通过预测丙酮酸（pyruvate）中产生的同位素模式，你将获得关于如何量化通量分配以及代谢途径如何在原子水平上相互关联的实践性见解。[@problem_id:2584887]", "problem": "一个细胞悬浮液仅由双标记葡萄糖 $[1,2\\text{-}^{13}\\text{C}_{2}]\\text{glucose}$ 供养。假设以下机理和化学计量学基础为普遍接受的事实：\n\n- 在磷酸戊糖途径 (PPP) 的氧化分支中，6-磷酸葡萄糖以二氧化碳的形式失去其 $1$ 号碳原子，每分子 6-磷酸葡萄糖生成两分子的烟酰胺腺嘌呤二核苷酸磷酸（还原型）(NADPH)，同时转化为 5-磷酸核酮糖。碳原子映射关系为：6-磷酸葡萄糖的 $2$ 号碳原子成为 5-磷酸核酮糖的 $1$ 号碳原子。\n- 在非氧化分支中，三个磷酸戊糖通过经典的转酮醇酶、转醛醇酶和转酮醇酶反应序列，重排为两个 6-磷酸果糖和一个 3-磷酸甘油醛，其中两个 5-磷酸木酮糖和一个 5-磷酸核糖作为功能底物。\n- 醛缩酶裂解 1,6-二磷酸果糖，由 1,6-二磷酸果糖的 $1$–$3$ 号碳原子生成磷酸二羟丙酮，由 $4$–$6$ 号碳原子生成 3-磷酸甘油醛。磷酸丙糖异构酶 (TPI) 快速地使磷酸二羟丙酮和 3-磷酸甘油醛达到平衡，且在稳态下磷酸丙糖池混合均匀。\n- 3-磷酸甘油醛的碳原子映射到丙酮酸如下：3-磷酸甘油醛的 $1$ 号碳 $\\rightarrow$ 丙酮酸的 $3$ 号碳， $2$ 号碳 $\\rightarrow$ 丙酮酸的 $2$ 号碳， $3$ 号碳 $\\rightarrow$ 丙酮酸的 $1$ 号碳。\n- 所有代谢物池都很大且混合均匀，不与其他未标记底物发生交换，且不存在同位素歧视效应。\n\n考虑 6-磷酸葡萄糖消耗的两条并行途径：\n- 比例为 $p$ 的部分进入氧化性 PPP，并仅通过上述非氧化分支返回糖酵解途径。\n- 剩余比例为 $1-p$ 的部分不进入 PPP，而直接进行糖酵解。\n\n设 $p=0.4$。仅使用上述机理基础和碳原子衡算，从第一性原理出发，推导由两条途径合并生成的总丙酮酸池中，质量同位素体为 $M+2$（即恰好含有两个 $^{13}\\text{C}$ 原子）的丙酮酸所占的总分数。请用无量纲小数表示您的答案，并将最终结果四舍五入至四位有效数字。", "solution": "该问题要求计算当细胞由 $[1,2\\text{-}^{13}\\text{C}_{2}]\\text{glucose}$ 供养时，双标记（$M+2$）丙酮酸的质量同位素体分数。源自所供给葡萄糖的 6-磷酸葡萄糖 (G6P) 的流向分为两条途径：比例为 $p$ 的部分进入磷酸戊糖途径 (PPP)，比例为 $1-p$ 的部分直接进入糖酵解。\n\n我们用星号（$*$）表示一个 $^{13}\\text{C}$ 原子。初始的 6-磷酸葡萄糖 (G6P) 分子在其 $1$ 号和 $2$ 号碳原子上被标记。我们可以将其标记模式表示为 $[*,*,0,0,0,0]$，其中位置对应于碳原子 $C_1$ 到 $C_6$。\n\n我们将分别分析每条途径产生的丙酮酸的标记情况，然后根据通量分数 $p$ 合并结果。\n\n首先，考虑直接糖酵解途径，该途径占总 G6P 通量的比例为 $1-p$。\n1.  标记模式为 $[*,*,0,0,0,0]$ 的 G6P 异构化为 6-磷酸果糖 (F6P)，然后磷酸化为 1,6-二磷酸果糖 (FBP)。糖酵解的这些初始步骤不改变碳骨架，因此 FBP 具有相同的标记模式：$[*,*,0,0,0,0]$。\n2.  醛缩酶将一分子 FBP 裂解为两个磷酸丙糖：来自碳原子 $1-3$ 的磷酸二羟丙酮 ($\\text{DHAP}$) 和来自碳原子 $4-6$ 的 3-磷酸甘油醛 ($\\text{GAP}$)。\n    -   $\\text{DHAP}$ 由 FBP 的 $[C_1, C_2, C_3]$ 形成，因此其标记模式为 $[*,*,0]$。这是一个 $M+2$ 分子。\n    -   $\\text{GAP}$ 由 FBP 的 $[C_4, C_5, C_6]$ 形成，因此其标记模式为 $[0,0,0]$。这是一个 $M+0$ 分子。\n3.  磷酸丙糖异构酶 (TPI) 快速地使 $\\text{DHAP}$ 和 $\\text{GAP}$ 达到平衡。每摩尔进入糖酵解的 G6P 产生一摩尔 $\\text{DHAP}$ 和一摩尔 $\\text{GAP}$。它们达到平衡，形成一个单一的磷酸丙糖池。由于下游糖酵解和糖异生都从这个共同的池中汲取底物，因此继续沿糖酵解途径形成两个丙酮酸分子的两个磷酸丙糖分子，一个源自原始的 $\\text{DHAP}$，另一个源自原始的 $\\text{GAP}$。\n    -   第一个 $\\text{GAP}$ 分子，通过 TPI 由 $\\text{DHAP}$ $[*,*,0]$ 转化而来，保留了标记模式 $[*,*,0]$（一个 $M+2$ 分子）。\n    -   第二个 $\\text{GAP}$ 分子是 FBP 裂解产生的原始 $\\text{GAP}$，标记模式为 $[0,0,0]$（一个 $M+0$ 分子）。\n4.  每个 $\\text{GAP}$ 分子都转化为一个丙酮酸分子。碳原子映射关系为：$\\text{GAP}$ 的 $C_1 \\rightarrow$ 丙酮酸的 $C_3$，$\\text{GAP}$ 的 $C_2 \\rightarrow$ 丙酮酸的 $C_2$，以及 $\\text{GAP}$ 的 $C_3 \\rightarrow$ 丙酮酸的 $C_1$。\n    -   标记模式为 $[*,*,0]$ 的 $M+2$ $\\text{GAP}$（在 $C_1$ 和 $C_2$ 处标记）产生一个标记模式为 $[0,*,*]$ 的丙酮酸（在 $C_2$ 和 $C_3$ 处标记）。这是一个 $M+2$ 丙酮酸。\n    -   标记模式为 $[0,0,0]$ 的 $M+0$ $\\text{GAP}$ 产生一个标记模式为 $[0,0,0]$ 的 $M+0$ 丙酮酸。\n5.  因此，对于每个仅通过糖酵解途径处理的 G6P 分子，会形成两个丙酮酸分子：一个 $M+2$ 和一个 $M+0$。来自该途径的 $M+2$ 丙酮酸的分数为 $1/2$。\n此途径的丙酮酸摩尔产率为每摩尔 G6P 产 $2$ 摩尔。$M+2$ 丙酮酸的摩尔产率为每摩尔 G6P 产 $1$ 摩尔。\n\n其次，考虑磷酸戊糖途径，该途径占 G6P 通量的比例为 $p$。\n1.  氧化分支：标记模式为 $[*,*,0,0,0,0]$ 的 G6P 进入氧化性 PPP。被标记的 $C_1$ 碳原子以 $^{13}\\text{CO}_2$ 的形式丢失。剩余的 $5$ 碳骨架形成 5-磷酸核酮糖 (Ru5P)。G6P 的 $C_2$ 成为 Ru5P 的 $C_1$。因此，生成的 Ru5P 在其 $1$ 号碳原子上为单标记：$[*,0,0,0,0]$。这是一个 $M+1$ 磷酸戊糖。\n2.  非氧化分支：问题陈述 $3$ 个磷酸戊糖 (PP) 重排形成 $2$ 个 F6P 和 $1$ 个 $\\text{GAP}$。由于所有的磷酸戊糖都源自 $M+1$ Ru5P 池，我们可以假设进入非氧化分支的输入物——两个 5-磷酸木酮糖 ($\\text{Xu5P}$) 和一个 5-磷酸核糖 ($\\text{R5P}$)——都是 $M+1$ 且具有标记模式 $[*,0,0,0,0]$。\n3.  我们通过经典的转酮醇酶 (TK) 和转醛醇酶 (TA) 反应来追踪标记：\n    -   TK1: $\\text{Xu5P}_1 \\text{[*,0,0,0,0]} + \\text{R5P} \\text{[*,0,0,0,0]} \\rightarrow \\text{GAP}_1 + \\text{S7P}$。\n        -   $\\text{GAP}_1$ 由 $\\text{Xu5P}$ 的 $C_{3-5}$ 形成，这些碳原子未被标记。所以，$\\text{GAP}_1$ 是 $M+0$。\n        -   7-磷酸景天庚酮糖 (S7P) 由 $\\text{Xu5P}$ 的 $C_{1-2}$ 和 $\\text{R5P}$ 的 $C_{1-5}$ 形成。$\\text{Xu5P}$ 的 $C_1$ 成为 S7P 的 $C_1$。$\\text{R5P}$ 的 $C_1$ 成为 S7P 的 $C_3$。因此，S7P 是双标记的：$[*,0,*,0,0,0,0]$，一个 $M+2$ 分子。\n    -   TA: $\\text{S7P} \\text{[*,0,*,0,0,0,0]} + \\text{GAP}_1 \\text{[0,0,0]} \\rightarrow \\text{F6P}_1 + \\text{E4P}$。\n        -   $\\text{F6P}_1$ 接收来自 S7P 的 $C_{1-3}$ 和来自 $\\text{GAP}_1$ 的所有碳原子。S7P 在 $C_1$ 和 $C_3$ 处被标记。因此 $\\text{F6P}_1$ 是双标记的：$[*,0,*,0,0,0]$，一个 $M+2$ 分子。\n        -   4-磷酸赤藓糖 (E4P) 由 S7P 的 $C_{4-7}$ 形成，这些碳原子未被标记。所以，E4P 是 $M+0$。\n    -   TK2: $\\text{Xu5P}_2 \\text{[*,0,0,0,0]} + \\text{E4P} \\text{[0,0,0,0]} \\rightarrow \\text{F6P}_2 + \\text{GAP}_2$。\n        -   $\\text{F6P}_2$ 接收来自 $\\text{Xu5P}$ 的 $C_{1-2}$ 和来自 E4P 的所有碳原子。$\\text{Xu5P}$ 在 $C_1$ 处被标记。因此 $\\text{F6P}_2$ 是单标记的：$[*,0,0,0,0,0]$，一个 $M+1$ 分子。\n        -   $\\text{GAP}_2$ 由 $\\text{Xu5P}$ 的 $C_{3-5}$ 形成，这些碳原子未被标记。所以，$\\text{GAP}_2$ 是 $M+0$。\n4.  消耗 $3$ 摩尔 $M+1$ 磷酸戊糖的净结果是产生：\n    -   一摩尔 $M+2$ F6P ($[*,0,*,0,0,0]$)。\n    -   一摩尔 $M+1$ F6P ($[*,0,0,0,0,0]$)。\n    -   一摩尔 $M+0$ $\\text{GAP}$。\n5.  这些分子现在通过糖酵解途径生成丙酮酸。\n    -   $M+2$ F6P 分子 ($[*,0,*,0,0,0]$) 被裂解为 $\\text{DHAP}$ $[*,0,*]$ ($M+2$) 和 $\\text{GAP}$ $[0,0,0]$ ($M+0$)。经过 TPI 平衡后，这两个磷酸丙糖产生一个 $M+2$ 丙酮酸（来自 $\\text{GAP}$ $[*,0,*]$，生成丙酮酸 $[*,0,*]$）和一个 $M+0$ 丙酮酸。总计：$1$ 个 $M+2$ 丙酮酸，$1$ 个 $M+0$ 丙酮酸。\n    -   $M+1$ F6P 分子 ($[*,0,0,0,0,0]$) 被裂解为 $\\text{DHAP}$ $[*,0,0]$ ($M+1$) 和 $\\text{GAP}$ $[0,0,0]$ ($M+0$)。它们产生一个 $M+1$ 丙酮酸（来自 $\\text{GAP}$ $[*,0,0]$，生成丙酮酸 $[0,0,*]$）和一个 $M+0$ 丙酮酸。总计：$1$ 个 $M+1$ 丙酮酸，$1$ 个 $M+0$ 丙酮酸。\n    -   $M+0$ $\\text{GAP}$ 分子直接产生一个 $M+0$ 丙酮酸。\n6.  $3$ 个 G6P 分子进入 PPP 的总产物是 $3$ 个 $\\text{CO}_2$ 加以总共形成 $5$ 个丙酮酸分子的代谢物（$2$ 个来自 $\\text{F6P}_1$，$2$ 个来自 $\\text{F6P}_2$，$1$ 个来自 $\\text{GAP}_2$）。\n    -   这 $5$ 个丙酮酸分子的分布是：$1$ 个 $M+2$，$1$ 个 $M+1$，和 $3$ 个 $M+0$。\n    -   因此，来自此途径的 $M+2$ 丙酮酸的分数为 $1/5$。\n    -   丙酮酸的摩尔产率为每摩尔进入 PPP 的 G6P 产 $5/3$ 摩尔。$M+2$ 丙酮酸的摩尔产率为每摩尔进入 PPP 的 G6P 产 $(1/5) \\times (5/3) = 1/3$ 摩尔。\n\n最后，我们合并两条途径。设 $Pyr_{\\text{total}}$ 为丙酮酸的总摩尔数，$Pyr_{M+2}$ 为 $M+2$ 丙酮酸的摩尔数，两者均以每摩尔消耗的 G6P 进行归一化。\n-   丙酮酸的总摩尔产率是两条途径产率之和：\n    $$Pyr_{\\text{total}} = 2(1-p) + \\frac{5}{3}p = 2 - 2p + \\frac{5}{3}p = 2 - \\frac{1}{3}p$$\n-   同样地，$M+2$ 丙酮酸的总摩尔产率也是两条途径产率之和：\n    $$Pyr_{M+2} = 1 \\cdot (1-p) + \\frac{1}{3}p = 1 - p + \\frac{1}{3}p = 1 - \\frac{2}{3}p$$\n-   $M+2$ 丙酮酸所占的分数，记为 $f_{M+2}$，是这两个量的比值：\n    $$f_{M+2} = \\frac{Pyr_{M+2}}{Pyr_{\\text{total}}} = \\frac{1 - \\frac{2}{3}p}{2 - \\frac{1}{3}p}$$\n\n现在，我们代入给定值 $p = 0.4$。\n$$p = 0.4 = \\frac{2}{5}$$\n$$f_{M+2} = \\frac{1 - \\frac{2}{3}\\left(\\frac{2}{5}\\right)}{2 - \\frac{1}{3}\\left(\\frac{2}{5}\\right)} = \\frac{1 - \\frac{4}{15}}{2 - \\frac{2}{15}} = \\frac{\\frac{15-4}{15}}{\\frac{30-2}{15}} = \\frac{\\frac{11}{15}}{\\frac{28}{15}} = \\frac{11}{28}$$\n将此分数转换为小数并四舍五入至四位有效数字：\n$$f_{M+2} = \\frac{11}{28} \\approx 0.392857... \\approx 0.3929$$", "answer": "$$\\boxed{0.3929}$$", "id": "2584887"}, {"introduction": "现代生物化学越来越依赖计算模型来预测细胞如何响应遗传或环境变化。本实践通过构建和求解一个中央碳代谢模型，向你介绍通量平衡分析（Flux Balance Analysis, FBA）这一强大的系统生物学技术。你将模拟细胞如何补偿磷酸戊糖途径（PPP）的限速酶 G6PD 活性丧失的情况，这为理解代谢重塑和代谢工程的原理提供了一个切实的例子。[@problem_id:2584917]", "problem": "要求您形式化、求解和模拟一个稳态通量优化问题，该问题旨在捕捉抑制葡萄糖-6-磷酸脱氢酶 (G6PD) 如何通过苹果酸-丙酮酸循环和还原性羧化作用重构碳流，以维持胞质溶胶中烟酰胺腺嘌呤二核苷酸磷酸（还原型）(NADPH) 的水平。请使用以下基础，从质量平衡（稳态）和反应不可逆性的第一性原理出发，建立一个线性优化模型。\n\n- 对胞内代谢物使用稳态假设：对于每种内部代谢物，其净生成速率等于净消耗速率，这为化学计量矩阵 $\\mathbf{S}$ 和通量向量 $\\mathbf{v}$ 施加了形式为 $\\mathbf{S}\\,\\mathbf{v}=\\mathbf{0}$ 的线性约束。与环境的交换及排泄通量被建模为具有非负界限的单向通量。所有通量的单位均为 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$。\n\n- 模型中包含以下不可逆反应（所有通量变量均为非负，并用 $v_{\\cdot}$ 表示）：\n  1. 葡萄糖摄取生成葡萄糖-6-磷酸 (G6P)：通量为 $v_{\\mathrm{Gin}}$。\n  2. 糖酵解（集总反应）：$\\mathrm{G6P} \\rightarrow 2\\,\\mathrm{Pyruvate} + 2\\,\\mathrm{NADH}_{\\mathrm{c}}$，通量为 $v_{\\mathrm{Gly}}$。\n  3. 戊糖磷酸途径 (PPP) 的氧化分支（G6PD 步骤与 $6$-磷酸葡萄糖酸脱氢酶集总）：$\\mathrm{G6P} + 2\\,\\mathrm{NADP}^{+}_{\\mathrm{c}} \\rightarrow \\mathrm{CO}_{2} + 2\\,\\mathrm{NADPH}_{\\mathrm{c}} + \\text{pentose}$，通量为 $v_{\\mathrm{PPP}}$（忽略非氧化性戊糖互变；将戊糖视为外部产物）。\n  4. 丙酮酸羧化酶：$\\mathrm{Pyruvate} + \\mathrm{CO}_{2} \\rightarrow \\mathrm{OAA}$，通量为 $v_{\\mathrm{PC}}$。\n  5. 胞质溶胶苹果酸脱氢酶：$\\mathrm{OAA} + \\mathrm{NADH}_{\\mathrm{c}} \\rightarrow \\mathrm{Malate}$，通量为 $v_{\\mathrm{MDH1}}$。\n  6. 胞质溶胶苹果酸酶（苹果酸-丙酮酸循环的 NADPH 生成器）：$\\mathrm{Malate} + \\mathrm{NADP}^{+}_{\\mathrm{c}} \\rightarrow \\mathrm{Pyruvate} + \\mathrm{CO}_{2} + \\mathrm{NADPH}_{\\mathrm{c}}$，通量为 $v_{\\mathrm{ME1}}$。\n  7. 谷氨酰胺补缺反应（集总至 $\\alpha$-酮戊二酸，$\\alpha\\mathrm{KG}$）：摄取通量 $v_{\\mathrm{Qin}}$ 补给 $\\alpha\\mathrm{KG}$ 池。\n  8. 还原性羧化作用（线粒体异柠檬酸脱氢酶的逆向反应）：$\\alpha\\mathrm{KG} + \\mathrm{CO}_{2} \\rightarrow \\mathrm{Isocitrate}_{\\mathrm{m}}$，通量为 $v_{\\mathrm{IDH2}^{\\mathrm{red}}}$；此步骤由模型中未明确表示的线粒体还原当量驱动；因此，施加一个上界参数以反映可用的还原能力预算。\n  9. 柠檬酸/异柠檬酸向胞质溶胶的输出（集总）：$\\mathrm{Isocitrate}_{\\mathrm{m}} \\rightarrow \\mathrm{Isocitrate}_{\\mathrm{c}}$，通量为 $v_{\\mathrm{CITexp}}$。\n  10. 胞质溶胶异柠檬酸脱氢酶（NADP依赖性，氧化型）：$\\mathrm{Isocitrate}_{\\mathrm{c}} + \\mathrm{NADP}^{+}_{\\mathrm{c}} \\rightarrow \\alpha\\mathrm{KG} + \\mathrm{CO}_{2} + \\mathrm{NADPH}_{\\mathrm{c}}$，通量为 $v_{\\mathrm{IDH1}}$。\n\n- 包含必要的排泄/输出变量，以确保模型可行性，同时保持内部（代谢物）池的质量平衡：\n  - 丙酮酸排泄 $v_{\\mathrm{PyrDrain}}$，胞质溶胶 NADH 排泄 $v_{\\mathrm{NADH\\_drain}}$，$\\alpha\\mathrm{KG}$ 排泄 $v_{\\alpha\\mathrm{KG}\\_\\mathrm{drain}}$，线粒体异柠檬酸排泄 $v_{\\mathrm{ICITm\\_drain}}$，胞质溶胶异柠檬酸排泄 $v_{\\mathrm{ICITc\\_drain}}$；均为非负值，代表向未建模的汇点的容许损失。\n  - 一个 NADPH 短缺松弛变量 $s \\ge 0$ 用于捕捉未满足的 NADPH 需求。\n\n- 对内部代谢物施加以下稳态平衡约束（每个方程均为等式）：\n  1. G6P: $v_{\\mathrm{Gin}} - v_{\\mathrm{Gly}} - v_{\\mathrm{PPP}} = 0$。\n  2. 丙酮酸 (Pyruvate): $2\\,v_{\\mathrm{Gly}} + v_{\\mathrm{ME1}} - v_{\\mathrm{PC}} - v_{\\mathrm{PyrDrain}} = 0$。\n  3. 草酰乙酸 (OAA): $v_{\\mathrm{PC}} - v_{\\mathrm{MDH1}} = 0$。\n  4. 苹果酸 (Malate): $v_{\\mathrm{MDH1}} - v_{\\mathrm{ME1}} = 0$。\n  5. 线粒体异柠檬酸: $v_{\\mathrm{IDH2}^{\\mathrm{red}}} - v_{\\mathrm{CITexp}} - v_{\\mathrm{ICITm\\_drain}} = 0$。\n  6. 胞质溶胶异柠檬酸: $v_{\\mathrm{CITexp}} - v_{\\mathrm{IDH1}} - v_{\\mathrm{ICITc\\_drain}} = 0$。\n  7. $\\alpha\\mathrm{KG}$ 池: $v_{\\mathrm{Qin}} + v_{\\mathrm{IDH1}} - v_{\\mathrm{IDH2}^{\\mathrm{red}}} - v_{\\alpha\\mathrm{KG}\\_\\mathrm{drain}} = 0$。\n  8. 胞质溶胶 NADPH: $2\\,v_{\\mathrm{PPP}} + v_{\\mathrm{ME1}} + v_{\\mathrm{IDH1}} + s = d$，其中 $d$ 是在稳态下需要满足的胞质溶胶 NADPH 需求量。\n  9. 胞质溶胶 NADH: $2\\,v_{\\mathrm{Gly}} - v_{\\mathrm{MDH1}} - v_{\\mathrm{NADH\\_drain}} = 0$。\n\n- 对选定通量设置参数化边界，以模拟营养物供应、酶容量和 G6PD 受抑制的情况：\n  - $0 \\le v_{\\mathrm{Gin}} \\le G_{\\max}$, $0 \\le v_{\\mathrm{Qin}} \\le Q_{\\max}$。\n  - $0 \\le v_{\\mathrm{PPP}} \\le P_{\\max}$，其中 $P_{\\max} = 0$ 强制 G6PD 抑制。\n  - $0 \\le v_{\\mathrm{ME1}} \\le M_{\\max}$, $0 \\le v_{\\mathrm{IDH2}^{\\mathrm{red}}} \\le R_{\\max}$, $0 \\le v_{\\mathrm{IDH1}} \\le I_{\\max}$。\n  - $0 \\le v_{\\mathrm{PC}} \\le C_{\\max}$, $0 \\le v_{\\mathrm{MDH1}} \\le H_{\\max}$, $0 \\le v_{\\mathrm{Gly}} \\le Y_{\\max}$, $0 \\le v_{\\mathrm{CITexp}} \\le X_{\\max}$。\n  - 所有排泄变量和 $s$ 的边界为 $0 \\le \\cdot < \\infty$。\n\n- 优化目标：在满足上述所有约束的条件下，最小化 NADPH 短缺量 $s$。最优值 $s^{\\star}$ 是最小的未满足的胞质溶胶 NADPH 需求量。\n\n实现一个程序，使用线性规划求解器为下面的每个测试用例建立并求解此线性规划问题。对于每个用例，报告 $s^{\\star}$ 的值，单位为 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$，并四舍五入到小数点后 $3$ 位。\n\n测试套件（每个元组提供 $(d, G_{\\max}, Q_{\\max}, P_{\\max}, M_{\\max}, R_{\\max}, I_{\\max}, C_{\\max}, H_{\\max}, Y_{\\max}, X_{\\max})$，所有值的单位均为 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$）：\n- 用例 A（基线，PPP 可用）：$(12.0,\\,10.0,\\,0.0,\\,10.0,\\,4.0,\\,0.0,\\,0.0,\\,4.0,\\,4.0,\\,10.0,\\,0.0)$。\n- 用例 B（G6PD 受抑制，苹果酸-丙酮酸循环代偿）：$(6.0,\\,10.0,\\,0.0,\\,0.0,\\,6.0,\\,0.0,\\,0.0,\\,6.0,\\,6.0,\\,10.0,\\,0.0)$。\n- 用例 C（G6PD 受抑制，低葡萄糖，还原性羧化作用通过胞质溶胶异柠檬酸脱氢酶代偿）：$(4.0,\\,1.0,\\,10.0,\\,0.0,\\,1.0,\\,5.0,\\,5.0,\\,1.0,\\,1.0,\\,1.0,\\,5.0)$。\n- 用例 D（G6PD 受抑制，高需求超过替代途径容量）：$(18.0,\\,8.0,\\,6.0,\\,0.0,\\,6.0,\\,5.0,\\,4.0,\\,6.0,\\,6.0,\\,8.0,\\,4.0)$。\n- 用例 E（无营养物，完全抑制）：$(2.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0)$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含五个最优 NADPH 短缺量 $[s^{\\star}_{A},s^{\\star}_{B},s^{\\star}_{C},s^{\\star}_{D},s^{\\star}_{E}]$，格式为方括号括起来的逗号分隔列表，每个条目均四舍五入到小数点后 $3$ 位，单位为 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$。例如，一个输出行可能如下所示：$[0.000,0.000,0.000,8.000,2.000]$（此示例仅用于说明）。", "solution": "问题陈述提出了一个有效且定义明确的线性优化问题，该问题基于代谢通量平衡分析的既定原则。它在科学上是合理的、自洽的且客观的。没有可识别的缺陷；因此，下面将给出一种解决方案。\n\n问题在于确定在各种代谢条件下，由松弛变量 $s$ 表示的最小未满足的胞质溶胶NADPH需求量。这被构建为一个线性规划 (LP) 问题。该LP的核心是在稳态假设下针对胞内代谢物的一组质量平衡方程，以及对反应通量的约束。\n\n系统的状态由一个通量向量 $\\mathbf{v}$ 描述。设变量排序如下：\n$$\n\\mathbf{v} = [v_{\\mathrm{Gin}}, v_{\\mathrm{Gly}}, v_{\\mathrm{PPP}}, v_{\\mathrm{PC}}, v_{\\mathrm{MDH1}}, v_{\\mathrm{ME1}}, v_{\\mathrm{Qin}}, v_{\\mathrm{IDH2}^{\\mathrm{red}}}, v_{\\mathrm{CITexp}}, v_{\\mathrm{IDH1}}, v_{\\mathrm{PyrDrain}}, v_{\\mathrm{NADH\\_drain}}, v_{\\alpha\\mathrm{KG}\\_\\mathrm{drain}}, v_{\\mathrm{ICITm\\_drain}}, v_{\\mathrm{ICITc\\_drain}}, s]^T\n$$\n这是一个 $\\mathbb{R}^{16}$ 中的向量。所有通量变量，包括松弛变量 $s$，都受非负约束，即对所有 $i$ 都有 $v_i \\ge 0$。\n\n目标是最小化 NADPH 短缺量 $s$。这是一个线性目标函数 $z = \\mathbf{c}^T \\mathbf{v}$，其中成本向量 $\\mathbf{c}$ 为：\n$$\n\\mathbf{c}^T = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]\n$$\n该问题受一个包含 $9$ 个线性等式约束的系统制约，可以写成矩阵形式 $\\mathbf{A}_{eq} \\mathbf{v} = \\mathbf{b}_{eq}$。大小为 $9 \\times 16$ 的化学计量矩阵 $\\mathbf{A}_{eq}$ 和大小为 $9 \\times 1$ 的向量 $\\mathbf{b}_{eq}$ 根据所提供的稳态平衡方程构建：\n1.  G6P: $1 \\cdot v_{\\mathrm{Gin}} - 1 \\cdot v_{\\mathrm{Gly}} - 1 \\cdot v_{\\mathrm{PPP}} = 0$\n2.  丙酮酸 (Pyruvate): $2 \\cdot v_{\\mathrm{Gly}} + 1 \\cdot v_{\\mathrm{ME1}} - 1 \\cdot v_{\\mathrm{PC}} - 1 \\cdot v_{\\mathrm{PyrDrain}} = 0$\n3.  草酰乙酸 (OAA): $1 \\cdot v_{\\mathrm{PC}} - 1 \\cdot v_{\\mathrm{MDH1}} = 0$\n4.  苹果酸 (Malate): $1 \\cdot v_{\\mathrm{MDH1}} - 1 \\cdot v_{\\mathrm{ME1}} = 0$\n5.  线粒体异柠檬酸: $1 \\cdot v_{\\mathrm{IDH2}^{\\mathrm{red}}} - 1 \\cdot v_{\\mathrm{CITexp}} - 1 \\cdot v_{\\mathrm{ICITm\\_drain}} = 0$\n6.  胞质溶胶异柠檬酸: $1 \\cdot v_{\\mathrm{CITexp}} - 1 \\cdot v_{\\mathrm{IDH1}} - 1 \\cdot v_{\\mathrm{ICITc\\_drain}} = 0$\n7.  $\\alpha\\mathrm{KG}$: $1 \\cdot v_{\\mathrm{Qin}} + 1 \\cdot v_{\\mathrm{IDH1}} - 1 \\cdot v_{\\mathrm{IDH2}^{\\mathrm{red}}} - 1 \\cdot v_{\\alpha\\mathrm{KG}\\_\\mathrm{drain}} = 0$\n8.  胞质溶胶 NADPH: $2 \\cdot v_{\\mathrm{PPP}} + 1 \\cdot v_{\\mathrm{ME1}} + 1 \\cdot v_{\\mathrm{IDH1}} + 1 \\cdot s = d$\n9.  胞质溶胶 NADH: $2 \\cdot v_{\\mathrm{Gly}} - 1 \\cdot v_{\\mathrm{MDH1}} - 1 \\cdot v_{\\mathrm{NADH\\_drain}} = 0$\n\n因此，向量 $\\mathbf{b}_{eq}$ 的常数部分是 $[0, 0, 0, 0, 0, 0, 0, d, 0]^T$，其中 $d$ 是 NADPH 需求参数。\n\n矩阵 $\\mathbf{A}_{eq}$ 为：\n$$\n\\mathbf{A}_{eq} = \\begin{pmatrix}\n1 & -1 & -1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 2 & 0 & -1 & 0 & 1 & 0 & 0 & 0 & 0 & -1 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & -1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 1 & -1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & -1 & 0 & 0 & 0 & 0 & -1 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & -1 & 0 & 0 & 0 & 0 & -1 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 1 & -1 & 0 & 1 & 0 & 0 & -1 & 0 & 0 & 0 \\\\\n0 & 0 & 2 & 0 & 0 & 1 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 1 \\\\\n0 & 2 & 0 & 0 & -1 & 0 & 0 & 0 & 0 & 0 & 0 & -1 & 0 & 0 & 0 & 0\n\\end{pmatrix}\n$$\n\n此外，每个通量变量 $v_i$ 都受到形式为 $0 \\le v_i \\le v_i^{\\max}$ 的箱式约束（边界）。每个测试用例都指定了上界：\n- $0 \\le v_{\\mathrm{Gin}} \\le G_{\\max}$\n- $0 \\le v_{\\mathrm{Gly}} \\le Y_{\\max}$\n- $0 \\le v_{\\mathrm{PPP}} \\le P_{\\max}$\n- $0 \\le v_{\\mathrm{PC}} \\le C_{\\max}$\n- $0 \\le v_{\\mathrm{MDH1}} \\le H_{\\max}$\n- $0 \\le v_{\\mathrm{ME1}} \\le M_{\\max}$\n- $0 \\le v_{\\mathrm{Qin}} \\le Q_{\\max}$\n- $0 \\le v_{\\mathrm{IDH2}^{\\mathrm{red}}} \\le R_{\\max}$\n- $0 \\le v_{\\mathrm{CITexp}} \\le X_{\\max}$\n- $0 \\le v_{\\mathrm{IDH1}} \\le I_{\\max}$\n- 排泄通量（$v_{\\mathrm{PyrDrain}}, v_{\\mathrm{NADH\\_drain}}, \\dots$）和松弛变量 $s$ 的下界为 $0$，上界无限制（$v_i < \\infty$）。\n\n对于每个测试用例，我们将给定的参数 $(d, G_{\\max}, Q_{\\max}, \\dots)$ 代入向量 $\\mathbf{b}_{eq}$ 和边界约束中。然后，使用标准求解器求解该 LP。目标函数的最优值 $s^{\\star}$ 代表了可能的最小 NADPH 短缺量。\n\n-   **用例 A** 模拟了一个基线场景，其中戊糖磷酸途径 (PPP) 完全活跃，能够满足 $12.0$ 单位的 NADPH 需求，因此短缺量为 $0.0$。\n-   **用例 B** 模拟了 G6PD 抑制 ($P_{\\max}=0$)，迫使细胞依赖苹果酸-丙酮酸循环。该循环的容量恰好足以满足 $6.0$ 单位的需求，导致短缺量为 $0.0$。\n-   **用例 C** 模拟了 G6PD 抑制和低葡萄糖情况，这限制了 PPP 和苹果酸-丙酮酸循环。细胞通过激活由谷氨酰胺驱动的还原性羧化作用进行代偿，该作用通过胞质溶胶异柠檬酸脱氢酶提供 NADPH。组合容量足以满足 $4.0$ 单位的需求，导致短缺量为 $0.0$。\n-   **用例 D** 模拟了 G6PD 抑制下的高需求场景。来自苹果酸-丙酮酸循环（$6.0$ 单位）和还原性羧化作用（$4.0$ 单位）的总最大 NADPH 生产能力为 $10.0$ 单位。这不足以满足 $18.0$ 单位的需求，导致短缺量为 $18.0 - 10.0 = 8.0$。\n-   **用例 E** 模拟了完全营养剥夺的情况。没有输入通量是可能的，因此无法生产 NADPH。短缺量等于全部需求量 $2.0$ 单位。\n\n实现部分将为每组参数构建并求解此 LP。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Sets up and solves the metabolic flux optimization problem for five test cases.\n    \"\"\"\n    # Test cases: (d, G_max, Q_max, P_max, M_max, R_max, I_max, C_max, H_max, Y_max, X_max)\n    test_cases = [\n        # Case A (baseline, PPP available)\n        (12.0, 10.0, 0.0, 10.0, 4.0, 0.0, 0.0, 4.0, 4.0, 10.0, 0.0),\n        # Case B (G6PD inhibited, malate–pyruvate cycle compensates)\n        (6.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 6.0, 6.0, 10.0, 0.0),\n        # Case C (G6PD inhibited, low glucose, reductive carboxylation compensates)\n        (4.0, 1.0, 10.0, 0.0, 1.0, 5.0, 5.0, 1.0, 1.0, 1.0, 5.0),\n        # Case D (G6PD inhibited, high demand exceeds alternative capacities)\n        (18.0, 8.0, 6.0, 0.0, 6.0, 5.0, 4.0, 6.0, 6.0, 8.0, 4.0),\n        # Case E (no nutrients, full inhibition)\n        (2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0),\n    ]\n\n    # Variable order: 16 variables\n    # 0: v_Gin, 1: v_Gly, 2: v_PPP, 3: v_PC, 4: v_MDH1, 5: v_ME1, 6: v_Qin,\n    # 7: v_IDH2_red, 8: v_CITexp, 9: v_IDH1, 10: v_PyrDrain, 11: v_NADH_drain,\n    # 12: v_aKG_drain, 13: v_ICITm_drain, 14: v_ICITc_drain, 15: s\n    \n    # Objective function: minimize s\n    c = np.zeros(16)\n    c[15] = 1.0\n\n    # Stoichiometric matrix for equality constraints (A_eq * v = b_eq)\n    A_eq = np.zeros((9, 16))\n    # G6P: v_Gin - v_Gly - v_PPP = 0\n    A_eq[0, [0, 1, 2]] = [1, -1, -1]\n    # Pyruvate: 2*v_Gly + v_ME1 - v_PC - v_PyrDrain = 0\n    A_eq[1, [1, 5, 3, 10]] = [2, 1, -1, -1]\n    # OAA: v_PC - v_MDH1 = 0\n    A_eq[2, [3, 4]] = [1, -1]\n    # Malate: v_MDH1 - v_ME1 = 0\n    A_eq[3, [4, 5]] = [1, -1]\n    # Mito isocitrate: v_IDH2_red - v_CITexp - v_ICITm_drain = 0\n    A_eq[4, [7, 8, 13]] = [1, -1, -1]\n    # Cyto isocitrate: v_CITexp - v_IDH1 - v_ICITc_drain = 0\n    A_eq[5, [8, 9, 14]] = [1, -1, -1]\n    # aKG: v_Qin + v_IDH1 - v_IDH2_red - v_aKG_drain = 0\n    A_eq[6, [6, 9, 7, 12]] = [1, 1, -1, -1]\n    # NADPH: 2*v_PPP + v_ME1 + v_IDH1 + s = d\n    A_eq[7, [2, 5, 9, 15]] = [2, 1, 1, 1]\n    # NADH: 2*v_Gly - v_MDH1 - v_NADH_drain = 0\n    A_eq[8, [1, 4, 11]] = [2, -1, -1]\n\n    results = []\n    for case in test_cases:\n        d, G_max, Q_max, P_max, M_max, R_max, I_max, C_max, H_max, Y_max, X_max = case\n\n        # Right-hand side of equality constraints\n        b_eq = np.zeros(9)\n        b_eq[7] = d\n\n        # Bounds for each variable (lower, upper)\n        # All lower bounds are 0. Upper bounds are None for infinity.\n        bounds = [\n            (0, G_max),       # v_Gin\n            (0, Y_max),       # v_Gly\n            (0, P_max),       # v_PPP\n            (0, C_max),       # v_PC\n            (0, H_max),       # v_MDH1\n            (0, M_max),       # v_ME1\n            (0, Q_max),       # v_Qin\n            (0, R_max),       # v_IDH2_red\n            (0, X_max),       # v_CITexp\n            (0, I_max),       # v_IDH1\n            (0, None),        # v_PyrDrain\n            (0, None),        # v_NADH_drain\n            (0, None),        # v_aKG_drain\n            (0, None),        # v_ICITm_drain\n            (0, None),        # v_ICITc_drain\n            (0, None),        # s\n        ]\n\n        # Solve the linear program\n        res = linprog(c, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n\n        # res.fun is the optimal value of the objective function (s*)\n        if res.success:\n            s_star = res.fun\n        else:\n            # Should not happen for this well-posed problem\n            s_star = np.nan \n\n        results.append(s_star)\n\n    # Format the results for output\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2584917"}]}