{"hands_on_practices": [{"introduction": "原核生物中的转录起始需要由核心酶和 sigma 因子亚基组装成 RNA 聚合酶（RNAP）全酶。本实践题提供了一个基础练习，将化学平衡原理应用于计算活性全酶的浓度。掌握这种计算是定量理解和模拟后续转录步骤的关键第一步。[@problem_id:2590276]", "problem": "在细菌中，核心RNA聚合酶（RNAP）必须与一个sigma因子结合，形成能够识别典型的-10和-35启动子元件的全酶。考虑核心RNA聚合酶与单一一种sigma因子的可逆、一对一结合，该过程在稳态下受热力学平衡支配。设结合反应为核心RNAP加sigma因子形成全酶。在固定温度下，于模拟胞质溶胶的条件下测量得到以下参数：\n- 核心RNA聚合酶总浓度 $R_{\\mathrm{tot}} = 2.5\\,\\mu\\text{M}$。\n- sigma因子总浓度 $S_{\\mathrm{tot}} = 1.3\\,\\mu\\text{M}$。\n- sigma因子与核心酶结合的解离常数 $K_{d} = 0.08\\,\\mu\\text{M}$。\n\n假设：\n- 核心RNA聚合酶与sigma因子之间为一对一的化学计量关系。\n- 不存在其他结合伴侣（例如，没有抗sigma因子或启动子对全酶的隔离）。\n- 均匀混合并处于热力学平衡状态。\n\n计算稳态下，以全酶形式存在的RNA聚合酶占总RNA聚合酶的比例。将最终答案表示为无量纲小数，并四舍五入至四位有效数字。最终答案中不要包含任何单位。", "solution": "所述问题描述了一个经典的双分子结合平衡，这是生物化学和物理化学中的一个基本概念。验证其前提是必要的第一步。\n\n明确给出的已知条件如下：\n- 核心RNA聚合酶的总浓度， $R_{\\mathrm{tot}} = 2.5\\,\\mu\\text{M}$。\n- sigma因子的总浓度， $S_{\\mathrm{tot}} = 1.3\\,\\mu\\text{M}$。\n- 该结合相互作用的解离常数， $K_{d} = 0.08\\,\\mu\\text{M}$。\n假设该反应是在热力学平衡下的可逆一对一结合，没有其他相互作用的物质。\n\n这个问题在科学上是合理的，它基于公认的质量作用定律。题目提供的浓度和解离常数数值对于像 *E. coli* 这样的原核系统来说，在生物学上是合理的。这个问题是适定的；它提供了一套完整的参数来确定平衡浓度的唯一且具有物理意义的解。问题的语言客观明确。因此，该问题被认为是有效的，我将继续推导解答。\n\n该结合反应可以表示为：\n$$\n\\text{R} + \\text{S} \\rightleftharpoons \\text{H}\n$$\n其中 $\\text{R}$ 是游离的核心RNA聚合酶，$\\text{S}$ 是游离的sigma因子，$\\text{H}$ 是全酶复合物。\n\n解离常数 $K_d$ 由各物质的平衡浓度定义：\n$$\nK_d = \\frac{[\\text{R}][\\text{S}]}{[\\text{H}]}\n$$\n此处，$[\\text{R}]$、$[\\text{S}]$ 和 $[\\text{H}]$ 代表平衡时的摩尔浓度。\n\n总浓度 $R_{\\mathrm{tot}}$ 和 $S_{\\mathrm{tot}}$ 是守恒的。质量平衡方程为：\n$$\nR_{\\mathrm{tot}} = [\\text{R}] + [\\text{H}]\n$$\n$$\nS_{\\mathrm{tot}} = [\\text{S}] + [\\text{H}]\n$$\n根据这些守恒定律，我们可以用全酶浓度 $[\\text{H}]$ 来表示游离物质的浓度：\n$$\n[\\text{R}] = R_{\\mathrm{tot}} - [\\text{H}]\n$$\n$$\n[\\text{S}] = S_{\\mathrm{tot}} - [\\text{H}]\n$$\n让我们将未知的全酶平衡浓度表示为 $x$，即 $x = [\\text{H}]$。将这些表达式代入 $K_d$ 的定义中：\n$$\nK_d = \\frac{(R_{\\mathrm{tot}} - x)(S_{\\mathrm{tot}} - x)}{x}\n$$\n为了解出 $x$，必须将此方程重排成标准的一元二次方程形式 $ax^2 + bx + c = 0$。\n$$\nK_d x = R_{\\mathrm{tot}}S_{\\mathrm{tot}} - R_{\\mathrm{tot}}x - S_{\\mathrm{tot}}x + x^2\n$$\n$$\nx^2 - (R_{\\mathrm{tot}} + S_{\\mathrm{tot}} + K_d)x + R_{\\mathrm{tot}}S_{\\mathrm{tot}} = 0\n$$\n$x$ 的解由一元二次方程求根公式给出：\n$$\nx = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}\n$$\n对于我们的方程，系数为 $a=1$，$b = -(R_{\\mathrm{tot}} + S_{\\mathrm{tot}} + K_d)$，以及 $c = R_{\\mathrm{tot}}S_{\\mathrm{tot}}$。\n将这些代入公式中，得到：\n$$\nx = \\frac{(R_{\\mathrm{tot}} + S_{\\mathrm{tot}} + K_d) \\pm \\sqrt{(R_{\\mathrm{tot}} + S_{\\mathrm{tot}} + K_d)^2 - 4R_{\\mathrm{tot}}S_{\\mathrm{tot}}}}{2}\n$$\n现在我们代入给定的数值：$R_{\\mathrm{tot}} = 2.5$，$S_{\\mathrm{tot}} = 1.3$，以及 $K_d = 0.08$。所有浓度的单位均为 $\\mu\\text{M}$。\n首先，我们计算聚合项：\n$$\nR_{\\mathrm{tot}} + S_{\\mathrm{tot}} + K_d = 2.5 + 1.3 + 0.08 = 3.88\n$$\n$$\nR_{\\mathrm{tot}}S_{\\mathrm{tot}} = 2.5 \\times 1.3 = 3.25\n$$\n将这些值代入 $x$ 的解中：\n$$\nx = \\frac{3.88 \\pm \\sqrt{(3.88)^2 - 4(1)(3.25)}}{2}\n$$\n$$\nx = \\frac{3.88 \\pm \\sqrt{15.0544 - 13.0}}{2}\n$$\n$$\nx = \\frac{3.88 \\pm \\sqrt{2.0544}}{2}\n$$\n平方根约等于 $\\sqrt{2.0544} \\approx 1.4333178$。这会得到 $x$ 的两个数学解：\n$$\nx_1 = \\frac{3.88 + 1.4333178}{2} = \\frac{5.3133178}{2} \\approx 2.6567\n$$\n$$\nx_2 = \\frac{3.88 - 1.4333178}{2} = \\frac{2.4466822}{2} \\approx 1.2233\n$$\n一个具有物理意义的解必须满足质量守恒施加的约束。复合物的浓度 $x$ 不能超过其任何组分的总浓度。因此，$x \\le R_{\\mathrm{tot}}$ 且 $x \\le S_{\\mathrm{tot}}$。更严格的条件是 $x \\le S_{\\mathrm{tot}}$，即 $x \\le 1.3\\,\\mu\\text{M}$。\n\n解 $x_1 \\approx 2.6567\\,\\mu\\text{M}$ 在物理上是不可能的，因为它超过了 $R_{\\mathrm{tot}}$ 和 $S_{\\mathrm{tot}}$。\n解 $x_2 \\approx 1.2233\\,\\mu\\text{M}$ 在物理上是有效的，因为它小于 $R_{\\mathrm{tot}}$ 和 $S_{\\mathrm{tot}}$。\n因此，全酶的平衡浓度为 $[\\text{H}] \\approx 1.2233411\\,\\mu\\text{M}$。\n\n问题要求的是以全酶形式存在的RNA聚合酶占总RNA聚合酶的比例。这个比例 $f_H$ 是全酶浓度与核心RNA聚合酶总浓度的比值：\n$$\nf_H = \\frac{[\\text{H}]}{R_{\\mathrm{tot}}}\n$$\n代入数值：\n$$\nf_H = \\frac{1.2233411}{2.5} \\approx 0.48933644\n$$\n按要求四舍五入到四位有效数字，该比例为 $0.4893$。", "answer": "$$\n\\boxed{0.4893}\n$$", "id": "2590276"}, {"introduction": "启动子的强度编码在其 DNA 序列中。本练习演示了如何使用定量模型——位置权重矩阵（PWM）——来预测启动子内部的基因变异如何影响其对 RNAP 的结合亲和力，并因此影响其转录输出。这种实践将抽象的序列信息世界与控制基因表达的具体生物物理参数联系起来，这是现代分子生物学和合成生物学的一项核心技能。[@problem_id:2590264]", "problem": "一个由细菌主要sigma因子识别的启动子具有一个特征明确的六聚体元件。给定一个位置权重矩阵（PWM），该矩阵编码了这个六聚体的位置特异性核苷酸概率，以及一个背景核苷酸分布。PWM被指定为位置特异性概率 $\\{p_{i,b}\\}$，其中 $i \\in \\{1,\\dots,6\\}$ 表示位置索引，$b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}$ 表示碱基索引。背景频率为 $\\{q_b\\}$。PWM和背景如下：\n- 背景频率：$q_{\\mathrm{A}}=0.3$，$q_{\\mathrm{C}}=0.2$，$q_{\\mathrm{G}}=0.2$，$q_{\\mathrm{T}}=0.3$。\n- 位置 $1$：$\\mathrm{A}:0.1$，$\\mathrm{C}:0.1$，$\\mathrm{G}:0.1$，$\\mathrm{T}:0.7$。\n- 位置 $2$：$\\mathrm{A}:0.1$，$\\mathrm{C}:0.1$，$\\mathrm{G}:0.1$，$\\mathrm{T}:0.7$。\n- 位置 $3$：$\\mathrm{A}:0.15$，$\\mathrm{C}:0.1$，$\\mathrm{G}:0.6$，$\\mathrm{T}:0.15$。\n- 位置 $4$：$\\mathrm{A}:0.6$，$\\mathrm{C}:0.2$，$\\mathrm{G}:0.1$，$\\mathrm{T}:0.1$。\n- 位置 $5$：$\\mathrm{A}:0.1$，$\\mathrm{C}:0.6$，$\\mathrm{G}:0.2$，$\\mathrm{T}:0.1$。\n- 位置 $6$：$\\mathrm{A}:0.6$，$\\mathrm{C}:0.1$，$\\mathrm{G}:0.1$，$\\mathrm{T}:0.2$。\n\n假设使用自然对数似然比对序列 $s$ 进行评分，分值为 $S(s)=\\sum_{i=1}^{6}\\ln\\!\\big(p_{i,s_i}/q_{s_i}\\big)$，其中 $s_i$ 是位置 $i$ 处的碱基。并假设在热力学平衡状态下，RNA聚合酶（RNAP）与该位点的结合自由能与此分值的负数成正比，比例常数等于Boltzmann常数与绝对温度的乘积 $k_{\\mathrm{B}}T$。考虑同一启动子中的一个野生型六聚体 $s_{\\mathrm{WT}}=\\mathrm{TTGACA}$ 和一个变体 $s_{\\mathrm{var}}=\\mathrm{TCTACA}$。\n\n设野生型的解离常数为 $K_d^{\\mathrm{WT}}=10\\,\\mathrm{nM}$，RNA聚合酶（RNAP）全酶的游离浓度为 $[R]=50\\,\\mathrm{nM}$。使用一个标准的热力学占有模型，其中RNAP与启动子结合的概率为 $P_{\\mathrm{bound}}=[R]/(K_d+[R])$，并假定转录起始速率与 $P_{\\mathrm{bound}}$ 成正比，计算变体相对于野生型的 $K_d$ 预测变化量，并用其估算变体相对于野生型的起始速率的倍数变化。\n\n仅报告变体相对于野生型的起始速率的倍数变化，结果为无单位的小数，并四舍五入到三位有效数字。使用自然对数，并在需要时以 $k_{\\mathrm{B}}T$ 的形式符号化表示任何中间能量值，但最终报告的值必须是按规定格式的无单位数值。在最终报告值中不要包含任何单位。", "solution": "该问题要求计算一个变体启动子序列相对于野生型序列的转录起始速率的倍数变化。该变化由RNA聚合酶（RNAP）与启动子结合亲和力的变化决定，而结合亲和力又与根据位置权重矩阵（PWM）计算出的序列分值相关。该问题具有科学依据且提法严谨，提供了所有必要信息。我们开始进行求解。\n\n问题陈述，对于一个六聚体序列 $s = s_1s_2s_3s_4s_5s_6$，其分值 $S$ 由对数似然比给出：\n$$\nS(s) = \\sum_{i=1}^{6} \\ln\\left(\\frac{p_{i,s_i}}{q_{s_i}}\\right)\n$$\n其中 $p_{i,s_i}$ 是在启动子基元中位置 $i$ 观察到碱基 $s_i$ 的概率，而 $q_{s_i}$ 是碱基 $s_i$ 的背景频率。\n\n结合自由能 $\\Delta G$ 被陈述为与此分值的负数成正比，比例常数为 $k_{\\mathrm{B}}T$。这建立了如下关系：\n$$\n\\Delta G = -k_{\\mathrm{B}}T \\cdot S(s)\n$$\n结合自由能与解离常数 $K_d$ 之间的标准热力学关系是：\n$$\n\\Delta G = k_{\\mathrm{B}}T \\ln(K_d / C^{\\circ})\n$$\n其中 $C^{\\circ}$ 是标准态浓度，我们可以将其设置为 $1\\,\\mathrm{M}$ 或任何其他常数值。由于我们将处理能量差和常数比，该项将会抵消。为简化表示，我们将其并入并写作 $\\Delta G \\propto k_{\\mathrm{B}}T \\ln(K_d)$。\n\n变体（$s_{\\mathrm{var}}$）相对于野生型（$s_{\\mathrm{WT}}$）的结合自由能变化记为 $\\Delta \\Delta G$：\n$$\n\\Delta \\Delta G = \\Delta G^{\\mathrm{var}} - \\Delta G^{\\mathrm{WT}}\n$$\n使用 $\\Delta G$ 的两个关系式，我们可以用两种方式表达 $\\Delta \\Delta G$：\n$$\n\\Delta \\Delta G = \\left(-k_{\\mathrm{B}}T S(s_{\\mathrm{var}})\\right) - \\left(-k_{\\mathrm{B}}T S(s_{\\mathrm{WT}})\\right) = -k_{\\mathrm{B}}T \\left(S(s_{\\mathrm{var}}) - S(s_{\\mathrm{WT}})\\right)\n$$\n$$\n\\Delta \\Delta G = k_{\\mathrm{B}}T \\ln(K_d^{\\mathrm{var}}) - k_{\\mathrm{B}}T \\ln(K_d^{\\mathrm{WT}}) = k_{\\mathrm{B}}T \\ln\\left(\\frac{K_d^{\\mathrm{var}}}{K_d^{\\mathrm{WT}}}\\right)\n$$\n将这两个表达式相等，可以让我们从序列分值的变化中确定解离常数的变化：\n$$\nk_{\\mathrm{B}}T \\ln\\left(\\frac{K_d^{\\mathrm{var}}}{K_d^{\\mathrm{WT}}}\\right) = -k_{\\mathrm{B}}T \\left(S(s_{\\mathrm{var}}) - S(s_{\\mathrm{WT}})\\right)\n$$\n$$\n\\ln\\left(\\frac{K_d^{\\mathrm{var}}}{K_d^{\\mathrm{WT}}}\\right) = S(s_{\\mathrm{WT}}) - S(s_{\\mathrm{var}})\n$$\n$$\n\\frac{K_d^{\\mathrm{var}}}{K_d^{\\mathrm{WT}}} = \\exp\\left(S(s_{\\mathrm{WT}}) - S(s_{\\mathrm{var}})\\right)\n$$\n野生型序列是 $s_{\\mathrm{WT}} = \\mathrm{TTGACA}$，变体序列是 $s_{\\mathrm{var}} = \\mathrm{TCTACA}$。这两个序列在位置 $i=2$（$s_{2,\\mathrm{WT}}=\\mathrm{T}$，$s_{2,\\mathrm{var}}=\\mathrm{C}$）和位置 $i=3$（$s_{3,\\mathrm{WT}}=\\mathrm{G}$，$s_{3,\\mathrm{var}}=\\mathrm{T}$）处不同。所有其他位置都相同。因此，分值的差异为：\n$$\nS(s_{\\mathrm{WT}}) - S(s_{\\mathrm{var}}) = \\left[ \\ln\\left(\\frac{p_{2,\\mathrm{T}}}{q_{\\mathrm{T}}}\\right) + \\ln\\left(\\frac{p_{3,\\mathrm{G}}}{q_{\\mathrm{G}}}\\right) \\right] - \\left[ \\ln\\left(\\frac{p_{2,\\mathrm{C}}}{q_{\\mathrm{C}}}\\right) + \\ln\\left(\\frac{p_{3,\\mathrm{T}}}{q_{\\mathrm{T}}}\\right) \\right]\n$$\n将此代入解离常数比值的表达式中：\n$$\n\\frac{K_d^{\\mathrm{var}}}{K_d^{\\mathrm{WT}}} = \\exp\\left( \\ln\\left(\\frac{p_{2,\\mathrm{T}}}{q_{\\mathrm{T}}}\\right) + \\ln\\left(\\frac{p_{3,\\mathrm{G}}}{q_{\\mathrm{G}}}\\right) - \\ln\\left(\\frac{p_{2,\\mathrm{C}}}{q_{\\mathrm{C}}}\\right) - \\ln\\left(\\frac{p_{3,\\mathrm{T}}}{q_{\\mathrm{T}}}\\right) \\right) = \\frac{ \\left(\\frac{p_{2,\\mathrm{T}}}{q_{\\mathrm{T}}}\\right) \\left(\\frac{p_{3,\\mathrm{G}}}{q_{\\mathrm{G}}}\\right) }{ \\left(\\frac{p_{2,\\mathrm{C}}}{q_{\\mathrm{C}}}\\right) \\left(\\frac{p_{3,\\mathrm{T}}}{q_{\\mathrm{T}}}\\right) }\n$$\n现在我们代入给定的概率值：\n- 背景：$q_{\\mathrm{T}}=0.3$，$q_{\\mathrm{G}}=0.2$，$q_{\\mathrm{C}}=0.2$。\n- 位置 $2$：$p_{2,\\mathrm{T}}=0.7$，$p_{2,\\mathrm{C}}=0.1$。\n- 位置 $3$：$p_{3,\\mathrm{G}}=0.6$，$p_{3,\\mathrm{T}}=0.15$。\n各个似然比为：\n$$\n\\frac{p_{2,\\mathrm{T}}}{q_{\\mathrm{T}}} = \\frac{0.7}{0.3} = \\frac{7}{3} \\quad, \\quad \\frac{p_{3,\\mathrm{G}}}{q_{\\mathrm{G}}} = \\frac{0.6}{0.2} = 3\n$$\n$$\n\\frac{p_{2,\\mathrm{C}}}{q_{\\mathrm{C}}} = \\frac{0.1}{0.2} = \\frac{1}{2} \\quad, \\quad \\frac{p_{3,\\mathrm{T}}}{q_{\\mathrm{T}}} = \\frac{0.15}{0.3} = \\frac{1}{2}\n$$\n解离常数的比值为：\n$$\n\\frac{K_d^{\\mathrm{var}}}{K_d^{\\mathrm{WT}}} = \\frac{\\left(\\frac{7}{3}\\right)(3)}{\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right)} = \\frac{7}{\\frac{1}{4}} = 28\n$$\n给定 $K_d^{\\mathrm{WT}}=10\\,\\mathrm{nM}$，我们求得 $K_d^{\\mathrm{var}}$：\n$$\nK_d^{\\mathrm{var}} = 28 \\times K_d^{\\mathrm{WT}} = 28 \\times 10\\,\\mathrm{nM} = 280\\,\\mathrm{nM}\n$$\n转录起始速率被假定与启动子占有率 $P_{\\mathrm{bound}}$ 成正比。占有率由热力学模型给出：\n$$\nP_{\\mathrm{bound}} = \\frac{[R]}{K_d + [R]}\n$$\n其中 $[R]=50\\,\\mathrm{nM}$ 是RNAP的游离浓度。起始速率的倍数变化是占有率的比值：\n$$\n\\text{倍数变化} = \\frac{\\text{速率}_{\\mathrm{var}}}{\\text{速率}_{\\mathrm{WT}}} = \\frac{P_{\\mathrm{bound}}^{\\mathrm{var}}}{P_{\\mathrm{bound}}^{\\mathrm{WT}}} = \\frac{[R]/(K_d^{\\mathrm{var}} + [R])}{[R]/(K_d^{\\mathrm{WT}} + [R])} = \\frac{K_d^{\\mathrm{WT}} + [R]}{K_d^{\\mathrm{var}} + [R]}\n$$\n代入数值：\n$$\nP_{\\mathrm{bound}}^{\\mathrm{WT}} = \\frac{50\\,\\mathrm{nM}}{10\\,\\mathrm{nM} + 50\\,\\mathrm{nM}} = \\frac{50}{60} = \\frac{5}{6}\n$$\n$$\nP_{\\mathrm{bound}}^{\\mathrm{var}} = \\frac{50\\,\\mathrm{nM}}{280\\,\\mathrm{nM} + 50\\,\\mathrm{nM}} = \\frac{50}{330} = \\frac{5}{33}\n$$\n倍数变化是这些概率的比值：\n$$\n\\text{倍数变化} = \\frac{P_{\\mathrm{bound}}^{\\mathrm{var}}}{P_{\\mathrm{bound}}^{\\mathrm{WT}}} = \\frac{5/33}{5/6} = \\frac{5}{33} \\times \\frac{6}{5} = \\frac{6}{33} = \\frac{2}{11}\n$$\n换算成小数，约等于 $0.181818...$。四舍五入到三位有效数字，结果是 $0.182$。", "answer": "$$\n\\boxed{0.182}\n$$", "id": "2590264"}, {"introduction": "DNA 的三维结构深刻影响着基因调控。这个问题让你扮演一位定量生物学家的角色，任务是分析实验数据以揭示 DNA 结构的一个基本参数——螺旋重复周期。通过将正弦模型拟合到具有不同间隔区长度的启动子的活性数据，你将直接观察到螺旋相位效应的后果，并练习从实验测量中提取生物物理参数的基本技能。[@problem_id:2590199]", "problem": "结合在细菌启动子上游的转录激活子通常通过直接的蛋白质-蛋白质接触来刺激RNA聚合酶的招募。在脱氧核糖核酸 (DNA) 中，B型螺旋大约每转 $R$ 个碱基对旋转一周，因此增加激活子位点与RNA聚合酶接触表面之间的中心间距 $L$ 会使其相对朝向旋转一个与 $L/R$ 成正比的角度。在这种旋转朝向主导接触构型且其他效应随 $L$ 缓慢变化的条件下，稳态转录产出（例如，标准化的活性）可以近似为一个关于 $L$ 的正弦函数，其基线、振幅、螺旋周期 $R$（单位：碱基对/转）和相位偏移 $\\phi$（单位：弧度）均未知。你的任务是根据给定的活性与间距长度的数据集来估计 $R$ 和 $\\phi$。\n\n出发于以下基本事实：\n- 分子生物学的中心法则确立了从DNA到核糖核酸(RNA)再到蛋白质的信息流链条，而转录起始是原核生物中的主要调控步骤。\n- 在生理条件下，B型DNA是一种右手螺旋，每转具有近乎恒定的重复周期（螺旋螺距），这导致当间距长度 $L$ 以单个碱基对为单位变化时，其旋转朝向会呈周期性变化。\n\n基于这些事实，你必须：\n- 将活性视为一个关于 $L$ 的周期函数，其周期 $R$ 和相位 $\\phi$ 未知，其中一个缓慢变化的偏移量被抽象为一个恒定的基线，一个缩放因子被抽象为振幅。\n- 仅使用提供的离散测量值来推断 $R$（单位：碱基对/转）和 $\\phi$（单位：弧度），且不预先假设 $R$ 或 $\\phi$ 的任何固定值。\n\n程序要求：\n- 对每个数据集，估计螺旋周期 $R$（单位：碱基对/转）和相位偏移 $\\phi$（单位：弧度）。\n- 报告的 $\\phi$ 值需归一化到区间 $(-\\pi,\\pi]$ 内。\n- 在最终输出中，将 $R$ 和 $\\phi$ 均四舍五入到三位小数。\n- 由于 $R$ 带有物理单位，需明确以“碱基对/转 (bp/turn)”为单位报告 $R$，并以“弧度”为单位报告 $\\phi$。\n- 最终的程序输出必须是单行，包含一个由三个项目组成的逗号分隔列表，每个数据集对应一个项目，每个项目都是一个双元素列表 $[R,\\phi]$。整行必须用方括号括起来，且没有多余的空格。示例格式：$[[r_1,\\phi_1],[r_2,\\phi_2],[r_3,\\phi_3]]$。\n- 角度应以弧度处理和报告。\n\n测试套件（请完全按照给定的方式使用这些数据集）：\n\n数据集 $1$ （理想情况；覆盖超过一个周期的宽范围，中等振幅）：\n- 间距长度（单位：碱基对）：$L_1 = [12,13,14,15,16,17,18,19,20,21,22,23]$。\n- 测量活性（无量纲）：$A_1 = [1.71961524,1.5,1.2,0.9,0.68038476,0.6,0.68038476,0.9,1.2,1.5,1.71961524,1.8]$。\n\n数据集 $2$ （边界条件；强调制，包含接近基线的值和宽泛的 $L$ 范围）：\n- 间距长度（单位：碱基对）：$L_2 = [11,12,13,14,15,16,17,18,19,20,21,22]$。\n- 测量活性（无量纲）：$A_2 = [1.77942286,1.9,1.77942286,1.45,1.0,0.55,0.22057714,0.1,0.22057714,0.55,1.0,1.45]$。\n\n数据集 $3$ （边缘情况；$L$ 范围窄，振幅低）：\n- 间距长度（单位：碱基对）：$L_3 = [14,15,16,17,18]$。\n- 测量活性（无量纲）：$A_3 = [0.925,1.0,1.075,1.12990381,1.15]$。\n\n答案规范：\n- 你的程序必须为每个数据集推断出这两个参数，并生成一个包含三个项目的列表的单行输出，其中每个项目都是列表 $[R,\\phi]$，$R$ 的单位是“碱基对/转 (bp/turn)”，$\\phi$ 的单位是“弧度”，两者均四舍五入到三位小数。例如，如果这些是计算出的值，则打印的行应如下所示：$[[12.000,0.524],[12.000,0.000],[12.000,3.142]]$。实际值必须由你的程序根据所提供的数据计算得出。", "solution": "用户提出了一个基于原核生物基因调控的生物物理学原理，从实验数据中进行参数估计的问题。在继续之前，需要进行严格的验证。\n\n**问题验证**\n\n1.  **已提取的已知条件**：\n    *   **现象**：转录活性受到转录激活子结合位点和RNA聚合酶之间间距长度 $L$ 的调制。\n    *   **物理基础**：该调制源于B型DNA的螺旋性质，其螺旋周期为每转 $R$ 个碱基对。\n    *   **数学模型**：活性 $A$ 可由函数 $A(L) = C + B \\cos\\left(\\frac{2\\pi}{R}L + \\phi\\right)$ 近似。\n    *   **未知参数**：基线 $C$、振幅 $B$、螺旋周期 $R$ 和相位偏移 $\\phi$ 均为未知。\n    *   **目标**：从给定的数据集中估计 $R$（单位：bp/turn）和 $\\phi$（单位：弧度）。\n    *   **数据**：提供了三个离散测量值 $(L_i, A_i)$ 的数据集。\n    *   **输出约束**：对于每个数据集，报告 $[R, \\phi]$，两个值都四舍五入到三位小数。相位 $\\phi$ 必须在区间 $(-\\pi, \\pi]$内。最终输出是这些数对的列表。\n\n2.  **验证结论**：\n    *   **科学依据**：该问题在科学上是合理的。DNA上的螺旋相位影响蛋白质-蛋白质相互作用的前提是分子生物学中一个公认的概念。使用正弦模型是对该现象的标准且有效的一阶近似。\n    *   **适定性**：该任务是一个适定的参数估计问题。它需要将一个非线性模型拟合到数据，对此存在标准的数值方法。从有限数据（如数据集 $3$）中准确估计参数的潜在困难反映了现实世界中的科学挑战，而不是问题陈述中的缺陷。\n    *   **客观性**：问题以精确、客观的语言陈述，不含主观或非科学内容。\n\n所有有效科学问题的标准均已满足。该问题被判定为**有效**。\n\n**解法推导**\n\n问题在于确定模型\n$$ A(L) = C + B \\cos\\left(\\frac{2\\pi}{R}L + \\phi\\right) $$\n的参数，以最佳拟合所提供的数据对 $(L_i, A_i)$。这是一个非线性最小二乘优化问题。在四维参数空间 $(C, B, R, \\phi)$ 中进行朴素搜索可能不稳定。一个更稳健的方法是分离模型的线性和非线性部分。\n\n使用三角恒等式 $\\cos(x+y) = \\cos(x)\\cos(y) - \\sin(x)\\sin(y)$，我们可以重写该模型。令角频率为 $\\omega = 2\\pi/R$。模型变为：\n$$ A(L) = C + B (\\cos(\\omega L)\\cos(\\phi) - \\sin(\\omega L)\\sin(\\phi)) $$\n这可以表示为对于一个固定 $\\omega$ 的基函数的线性组合：\n$$ A(L) = C + B_1 \\cos(\\omega L) + B_2 \\sin(\\omega L) $$\n其中线性参数为 $C$、$B_1 = B \\cos(\\phi)$ 和 $B_2 = -B \\sin(\\phi)$。\n\n对于非线性参数 $R$（以及 $\\omega$）的任意给定值，问题简化为线性最小二乘拟合。我们可以找到最优参数 $C$、$B_1$ 和 $B_2$ 来最小化该特定 $R$ 的残差平方和 (SSR)。SSR由下式给出：\n$$ \\text{SSR}(R) = \\sum_{i=1}^{N} \\left( A_i - \\left( \\hat{C} + \\hat{B}_1 \\cos\\left(\\frac{2\\pi}{R}L_i\\right) + \\hat{B}_2 \\sin\\left(\\frac{2\\pi}{R}L_i\\right) \\right) \\right)^2 $$\n其中 $(\\hat{C}, \\hat{B}_1, \\hat{B}_2)$ 是给定 $R$ 的线性最小二乘问题的解。\n\n这将多维优化问题转化为一个更易于处理的、旨在最小化 $\\text{SSR}(R)$ 的一维搜索问题，以寻找最优的螺旋周期 $R^*$。对 $R^*$ 的搜索将在一个物理上合理的范围内进行。在生理条件下，B型DNA的螺旋周期通常在 $10.5$ bp/turn 附近。因此，搜索区间 $R \\in [8.0, 14.0]$ bp/turn 是合适的。我们将采用一个数值优化程序来找到该区间内使SSR最小化的 $R$ 值。\n\n总体算法如下：\n1.  定义一个目标函数，它接受 $R$ 的候选值、间距长度 $L$ 和活性 $A$ 作为输入。\n2.  在此函数内部：\n    a.  计算 $\\omega = 2\\pi/R$。\n    b.  为线性模型构建设计矩阵 $\\mathbf{X}$，其列为 $1$、$\\cos(\\omega L_i)$ 和 $\\sin(\\omega L_i)$。\n    c.  使用标准的最小二乘求解器求解线性系统 $\\mathbf{X}\\boldsymbol{\\beta} = \\mathbf{A}$，以得到参数向量 $\\boldsymbol{\\beta} = [C, B_1, B_2]^T$。\n    d.  返回此拟合的残差平方和。\n3.  使用标量最小化算法，在区间 $[8.0, 14.0]$ 的边界内，找到最小化该目标函数的最优 $R^*$。\n4.  使用最优的 $R^*$，执行最后一次线性最小二乘拟合，以获得最优系数 $\\hat{C}$、$\\hat{B}_1$ 和 $\\hat{B}_2$。\n5.  从线性系数中恢复相位偏移 $\\phi$。根据它们的定义，我们有 $\\hat{B}_1 = B \\cos(\\phi)$ 和 $\\hat{B}_2 = -B \\sin(\\phi)$。相位 $\\phi$ 可以使用双参数反正切函数稳健地计算出来：\n    $$ \\phi^* = \\mathrm{atan2}(-\\hat{B}_2, \\hat{B}_1) $$\n    该函数能正确解析象限，并返回所需区间 $(-\\pi, \\pi]$ 内的值。\n6.  按要求将最终参数 $R^*$ 和 $\\phi^*$ 四舍五入到三位小数。此过程独立应用于所提供的三个数据集中的每一个。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves the parameter estimation problem for three datasets of transcriptional activity.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"L\": np.array([12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]),\n            \"A\": np.array([1.71961524, 1.5, 1.2, 0.9, 0.68038476, 0.6, 0.68038476, 0.9, 1.2, 1.5, 1.71961524, 1.8]),\n        },\n        {\n            \"L\": np.array([11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]),\n            \"A\": np.array([1.77942286, 1.9, 1.77942286, 1.45, 1.0, 0.55, 0.22057714, 0.1, 0.22057714, 0.55, 1.0, 1.45]),\n        },\n        {\n            \"L\": np.array([14, 15, 16, 17, 18]),\n            \"A\": np.array([0.925, 1.0, 1.075, 1.12990381, 1.15]),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        L_data, A_data = case[\"L\"], case[\"A\"]\n        \n        # Estimate parameters R (helical repeat) and phi (phase offset)\n        R_est, phi_est = estimate_params(L_data, A_data)\n        \n        results.append([round(R_est, 3), round(phi_est, 3)])\n        \n    # Format and print the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef estimate_params(L, A):\n    \"\"\"\n    Estimates the helical repeat (R) and phase (phi) from activity data.\n\n    This function implements a variable projection-like method. It separates the\n    non-linear parameter R from the linear parameters of the model. It then\n    performs a 1D optimization for R.\n\n    Args:\n        L (np.array): Array of spacer lengths.\n        A (np.array): Array of measured activities.\n\n    Returns:\n        tuple[float, float]: A tuple containing the estimated R and phi.\n    \"\"\"\n\n    def objective_function(R, L_data, A_data):\n        \"\"\"\n        Objective function to be minimized. It calculates the sum of squared\n        residuals for a given R after optimizing the linear parameters.\n        \"\"\"\n        if R <= 0:\n            return np.inf\n            \n        omega = 2 * np.pi / R\n        \n        # Design matrix for the linear part of the model: A = C + B1*cos(wL) + B2*sin(wL)\n        X = np.vstack([np.ones_like(L_data), np.cos(omega * L_data), np.sin(omega * L_data)]).T\n        \n        # Solve the linear least-squares problem for the coefficients [C, B1, B2]\n        # beta, residuals, rank, s = np.linalg.lstsq(...)\n        # The second return value `residuals` is the sum of squared residuals.\n        _, ssr, _, _ = np.linalg.lstsq(X, A_data, rcond=None)\n        \n        # If the fit is exact, ssr is an empty array.\n        if ssr.size == 0:\n            return 0.0\n        \n        return ssr[0]\n\n    # Perform a bounded 1D minimization to find the optimal R.\n    # The bounds [8, 14] are based on physical knowledge of B-DNA.\n    res = minimize_scalar(\n        objective_function,\n        bounds=(8.0, 14.0),\n        args=(L, A),\n        method='bounded'\n    )\n    \n    R_opt = res.x\n    \n    # With the optimal R, calculate the linear parameters one last time.\n    omega_opt = 2 * np.pi / R_opt\n    X_opt = np.vstack([np.ones_like(L), np.cos(omega_opt * L), np.sin(omega_opt * L)]).T\n    \n    beta_opt, _, _, _ = np.linalg.lstsq(X_opt, A, rcond=None)\n    C_opt, B1_opt, B2_opt = beta_opt\n    \n    # Recover phase phi from B1 = B*cos(phi) and B2 = -B*sin(phi)\n    # phi = atan2(-B2, B1) correctly handles quadrants and gives range (-pi, pi]\n    phi_opt = np.arctan2(-B2_opt, B1_opt)\n    \n    return R_opt, phi_opt\n\nsolve()\n```", "id": "2590199"}]}