{"hands_on_practices": [{"introduction": "本次实践是理解酶动力学的基础。我们将通过它连接微观的分子事件（结合、解离与催化）和宏观可测的动力学参数。这个练习要求你从基本原理出发，推导米氏方程，并验证稳态近似的适用性 [@problem_id:2607500]，这对于深刻理解 $K_m$ 和 $k_{\\text{cat}}$ 的物理意义至关重要。", "problem": "一种酶在恒温的稀水溶液中催化单底物反应 $E + S \\rightleftharpoons ES \\rightarrow E + P$。假设系统混合均匀，遵循质量作用动力学。令正向结合速率常数为 $k_1$（单位为 $\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$），解离速率常数为 $k_{-1}$（单位为 $\\mathrm{s}^{-1}$），催化转换速率常数为 $k_2$（单位为 $\\mathrm{s}^{-1}$）。总酶浓度为 $[E]_T = [E] + [ES]$，其中 $[E]$ 是游离酶，$[ES]$ 是酶-底物复合物。如果给定条件能够证明其合理性，你可以对中间复合物 $ES$ 使用准稳态近似（QSSA）。\n\n从质量作用动力学和总酶守恒出发，推导米氏常数 $K_m$ 和催化常数 $k_{\\text{cat}}$ 关于 $k_1$、$k_{-1}$ 和 $k_2$ 的表达式，并求出反应初速度 $v$（单位为 $\\mathrm{M}\\,\\mathrm{s}^{-1}$）作为 $[S]$、$[E]_T$、$K_m$ 和 $k_{\\text{cat}}$ 的函数。然后根据以下参数值，数值计算 $v$：\n- $k_1 = 2.5 \\times 10^{7}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$，\n- $k_{-1} = 1.5 \\times 10^{2}\\ \\mathrm{s}^{-1}$，\n- $k_2 = 3.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$，\n- $[E]_T = 5.0 \\times 10^{-8}\\ \\mathrm{M}$，\n- $[S] = 9.0 \\times 10^{-6}\\ \\mathrm{M}$。\n\n在进行计算之前，根据给定数据证明准稳态近似的适用性。\n\n将 $v$ 的最终数值结果四舍五入至 $4$ 位有效数字。以 $\\mathrm{M}\\,\\mathrm{s}^{-1}$ 为单位表示 $v$。最终报告量只提供 $v$ 的值。", "solution": "问题陈述科学严谨、自成体系且定义明确。这是一个酶动力学中的标准练习，可以使用既定原理解决。所有必要的参数均已提供，其数值在物理上是现实的。我们继续进行推导和数值计算。\n\n酶促反应由反应式 $E + S \\rightleftharpoons ES \\rightarrow E + P$ 给出，速率常数分别为 $k_1$、$k_{-1}$ 和 $k_2$。根据混合均匀系统的质量作用定律，各物质浓度的变化速率由以下常微分方程组描述：\n$$ \\frac{d[S]}{dt} = -k_1 [E][S] + k_{-1} [ES] $$\n$$ \\frac{d[E]}{dt} = -k_1 [E][S] + (k_{-1} + k_2) [ES] $$\n$$ \\frac{d[ES]}{dt} = k_1 [E][S] - (k_{-1} + k_2) [ES] $$\n$$ \\frac{d[P]}{dt} = k_2 [ES] $$\n此外，总酶浓度 $[E]_T$ 是守恒的：\n$$ [E]_T = [E] + [ES] $$\n这使我们能够将游离酶浓度表示为 $[E] = [E]_T - [ES]$。\n\n问题要求对酶-底物复合物 $[ES]$ 使用准稳态近似（QSSA）。该近似假设中间复合物的浓度能非常迅速地达到稳态，因此其变化速率与底物和产物的变化速率相比可以忽略不计。我们设 $\\frac{d[ES]}{dt} \\approx 0$：\n$$ k_1 [E][S] - (k_{-1} + k_2) [ES] = 0 $$\n将 $[E] = [E]_T - [ES]$ 代入此方程，得到：\n$$ k_1 ([E]_T - [ES])[S] - (k_{-1} + k_2) [ES] = 0 $$\n现在我们求解复合物的稳态浓度 $[ES]_{ss}$：\n$$ k_1 [E]_T [S] - k_1 [ES][S] - (k_{-1} + k_2) [ES] = 0 $$\n$$ k_1 [E]_T [S] = [ES] (k_1 [S] + k_{-1} + k_2) $$\n$$ [ES]_{ss} = \\frac{k_1 [E]_T [S]}{k_1 [S] + k_{-1} + k_2} $$\n为了得到标准的米氏方程形式，我们将分子和分母同时除以 $k_1$：\n$$ [ES]_{ss} = \\frac{[E]_T [S]}{\\frac{k_{-1} + k_2}{k_1} + [S]} $$\n反应初速度 $v$ 是产物的生成速率，即 $v = \\frac{d[P]}{dt} = k_2 [ES]$。使用稳态浓度 $[ES]_{ss}$，我们得到：\n$$ v = k_2 [ES]_{ss} = \\frac{k_2 [E]_T [S]}{\\frac{k_{-1} + k_2}{k_1} + [S]} $$\n米氏方程的标准形式是 $v = \\frac{k_{\\text{cat}} [E]_T [S]}{K_m + [S]}$，其中 $k_{\\text{cat}} [E]_T$ 是最大速度 $V_{\\max}$。通过将我们推导的表达式与标准形式进行比较，我们可以确定催化常数 $k_{\\text{cat}}$ 和米氏常数 $K_m$ 的表达式：\n$$ k_{\\text{cat}} = k_2 $$\n$$ K_m = \\frac{k_{-1} + k_2}{k_1} $$\n这就完成了问题的推导部分。\n\n接下来，我们必须证明使用QSSA的合理性，然后数值计算初速度 $v$。当形成复合物的物质（酶）的浓度远低于其底物的相关浓度标度时，QSSA是有效的。一个广泛使用的QSSA有效性条件是 $[E]_T \\ll K_m + [S]_0$，其中 $[S]_0$ 是初始底物浓度。\n\n我们给定的参数值如下：\n$k_1 = 2.5 \\times 10^{7}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$\n$k_{-1} = 1.5 \\times 10^{2}\\ \\mathrm{s}^{-1}$\n$k_2 = 3.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$\n$[E]_T = 5.0 \\times 10^{-8}\\ \\mathrm{M}$\n$[S] = 9.0 \\times 10^{-6}\\ \\mathrm{M}$ (这是 $[S]_0$)\n\n首先，我们计算米氏常数 $K_m$：\n$$ K_m = \\frac{k_{-1} + k_2}{k_1} = \\frac{1.5 \\times 10^{2}\\ \\mathrm{s}^{-1} + 3.0 \\times 10^{2}\\ \\mathrm{s}^{-1}}{2.5 \\times 10^{7}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}} = \\frac{4.5 \\times 10^{2}}{2.5 \\times 10^{7}}\\ \\mathrm{M} = 1.8 \\times 10^{-5}\\ \\mathrm{M} $$\n现在我们检查QSSA的有效性条件：\n$$ [E]_T \\ll K_m + [S]_0 $$\n$$ 5.0 \\times 10^{-8}\\ \\mathrm{M} \\ll 1.8 \\times 10^{-5}\\ \\mathrm{M} + 9.0 \\times 10^{-6}\\ \\mathrm{M} $$\n$$ 5.0 \\times 10^{-8}\\ \\mathrm{M} \\ll 2.7 \\times 10^{-5}\\ \\mathrm{M} $$\n比率 $\\frac{[E]_T}{K_m + [S]_0} = \\frac{5.0 \\times 10^{-8}}{2.7 \\times 10^{-5}} \\approx 1.85 \\times 10^{-3}$，远小于 $1$。因此，总酶浓度比浓度项 $K_m + [S]_0$ 小两个数量级以上，准稳态近似是合理的。\n\n我们现在开始计算初速度 $v$。催化常数为 $k_{\\text{cat}} = k_2 = 3.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$。使用米氏方程：\n$$ v = \\frac{k_{\\text{cat}} [E]_T [S]}{K_m + [S]} = \\frac{(3.0 \\times 10^{2}\\ \\mathrm{s}^{-1})(5.0 \\times 10^{-8}\\ \\mathrm{M})(9.0 \\times 10^{-6}\\ \\mathrm{M})}{1.8 \\times 10^{-5}\\ \\mathrm{M} + 9.0 \\times 10^{-6}\\ \\mathrm{M}} $$\n$$ v = \\frac{1.35 \\times 10^{-10}\\ \\mathrm{M}^2\\cdot\\mathrm{s}^{-1}}{2.7 \\times 10^{-5}\\ \\mathrm{M}} = 0.5 \\times 10^{-5}\\ \\mathrm{M}\\cdot\\mathrm{s}^{-1} = 5.0 \\times 10^{-6}\\ \\mathrm{M}\\cdot\\mathrm{s}^{-1} $$\n问题要求将最终结果四舍五入至 $4$ 位有效数字。然而，输入参数仅给出 $2$ 位有效数字。此指令与不确定性传播规则不一致。结果的精度不能高于用于计算它的精度最低的输入数据。为了完成本练习，我们将输入值视为精确值，并按要求的精度提供结果。\n精确计算值为 $5 \\times 10^{-6}$。以 $4$ 位有效数字表示，即为 $5.000 \\times 10^{-6}$。", "answer": "$$\\boxed{5.000 \\times 10^{-6}}$$", "id": "2607500"}, {"introduction": "在基础模型之上，本次实践将引导你探索如何定量分析竞争性抑制剂——一种普遍的酶调控机制。你将推导修正后的速率方程，并运用该模型从一组模拟实验数据中提取抑制剂的关键参数 $K_i$。这项练习旨在模拟从实验数据到阐明分子相互作用机制的真实研究过程 [@problem_id:2607501]。", "problem": "一种酶在存在可逆竞争性抑制剂的情况下，于初始速率、稳态条件下催化底物的转化。最小动力学机制为 $E + S \\rightleftharpoons ES \\rightarrow E + P$ 和 $E + I \\rightleftharpoons EI$，其中 $E$ 是游离酶，$S$ 是底物，$P$ 是产物，$I$ 是抑制剂，$ES$ 和 $EI$ 是相应的酶复合物。假设准稳态近似对 $ES$ 的形成成立，且抑制剂的结合是快速的，其特征由解离常数 $K_i$ 描述，定义为 $K_i = [E][I]/[EI]$。定义 $K_m = (k_{-1} + k_{\\mathrm{cat}})/k_1$ 和 $V_{\\max} = k_{\\mathrm{cat}} [E]_T$，其中 $[E]_T$ 是总酶浓度，并忽略产物抑制和逆反应。\n\n仅从上述定义、酶守恒和质量作用动力学出发，推导该竞争性抑制机制下初始速率 $v$ 对 $[S]$ 和 $[I]$ 的依赖关系，然后证明 Lineweaver–Burk (LB) 图（$1/v$ 对 $1/[S]$ 的双倒数图）的斜率如何线性依赖于抑制剂浓度 $[I]$。利用这种线性依赖关系，提出一个用 LB 斜率对 $[I]$ 回归的截距和斜率来表示抑制剂解离常数 $K_i$ 的估计量。\n\n然后，向您提供在几个固定的抑制剂浓度 $[I]$ 下实验测定的 LB 斜率 $m([I])$，每个斜率都是在相同温度、pH 和总酶浓度 $[E]_T$ 下，使用多个底物浓度通过对 $1/v$ 与 $1/[S]$ 进行线性拟合得出的。数据如下：\n- $[I]$ (单位 $\\mu\\mathrm{M}$): $0$, $5$, $10$, $20$, $40$。\n- LB 斜率 $m([I])$ (单位 $\\mathrm{s}$): $2.01$, $2.83$, $3.68$, $5.31$, $8.65$。\n\n假设 $m([I])$ 中的统计误差是方差齐性的，并且远大于 $[I]$ 中的误差，因此对 $m([I])$ 关于 $[I]$ 进行普通最小二乘回归是合适的。使用所有数据点，进行回归以获得最佳拟合的截距和斜率，使用您推导的估计量计算 $K_i$，并报告最终的数值估计。\n\n以微摩尔（$\\mu\\mathrm{M}$）表示您的最终 $K_i$ 估计值，并将答案四舍五入到三位有效数字。", "solution": "问题陈述完全有效。它在经典酶动力学方面有科学依据，问题提出得当且客观。它提供了一套完整的定义、假设和数据，足以得出一个唯一的解，且无任何内部矛盾。我们现在将进行严谨的推导和计算。\n\n该问题要求推导竞争性抑制的初始速率方程，分析所得的 Lineweaver-Burk (LB) 图，并利用实验数据估算抑制剂解离常数 $K_i$。\n\n首先，我们推导速率定律。总酶浓度 $[E]_T$ 是守恒的，分布于游离酶 $E$、酶-底物复合物 $ES$ 和酶-抑制剂复合物 $EI$ 之间。\n$$[E]_T = [E] + [ES] + [EI]$$\n抑制剂 $I$ 以快速平衡过程可逆地与游离酶结合，由解离常数 $K_i$ 定义：\n$$K_i = \\frac{[E][I]}{[EI]}$$\n由此，酶-抑制剂复合物的浓度为 $[EI] = \\frac{[E][I]}{K_i}$。将此式代入酶守恒方程得到：\n$$[E]_T = [E] + [ES] + \\frac{[E][I]}{K_i} = [E]\\left(1 + \\frac{[I]}{K_i}\\right) + [ES]$$\n求解游离酶浓度 $[E]$，得到：\n$$[E] = \\frac{[E]_T - [ES]}{1 + \\frac{[I]}{K_i}}$$\n将准稳态近似 (QSSA) 应用于酶-底物复合物 $ES$。这意味着其变化率近似为零：\n$$\\frac{d[ES]}{dt} = k_1[E][S] - k_{-1}[ES] - k_{\\mathrm{cat}}[ES] = 0$$\n其中 $k_1$、$k_{-1}$ 和 $k_{\\mathrm{cat}}$ 分别是底物结合、解离和催化的速率常数。重新整理此式得到：\n$$k_1[E][S] = (k_{-1} + k_{\\mathrm{cat}})[ES]$$\n我们将 $[E]$ 的表达式代入 QSSA 方程：\n$$k_1 \\left( \\frac{[E]_T - [ES]}{1 + \\frac{[I]}{K_i}} \\right) [S] = (k_{-1} + k_{\\mathrm{cat}})[ES]$$\n使用米氏常数 $K_m = (k_{-1} + k_{\\mathrm{cat}})/k_1$ 的定义，我们简化该方程：\n$$\\left( \\frac{[E]_T - [ES]}{1 + \\frac{[I]}{K_i}} \\right) [S] = K_m [ES]$$\n我们的目标是求解 $[ES]$。重新整理各项：\n$$([E]_T - [ES])[S] = K_m \\left(1 + \\frac{[I]}{K_i}\\right) [ES]$$\n$$[E]_T[S] = [ES][S] + K_m \\left(1 + \\frac{[I]}{K_i}\\right) [ES]$$\n$$[E]_T[S] = [ES] \\left( [S] + K_m \\left(1 + \\frac{[I]}{K_i}\\right) \\right)$$\n$$[ES] = \\frac{[E]_T[S]}{K_m \\left(1 + \\frac{[I]}{K_i}\\right) + [S]}$$\n初始反应速率 $v$ 由 $v = k_{\\mathrm{cat}}[ES]$ 给出。代入 $[ES]$ 的表达式，并使用最大速率 $V_{\\max} = k_{\\mathrm{cat}}[E]_T$ 的定义：\n$$v = \\frac{k_{\\mathrm{cat}}[E]_T[S]}{K_m \\left(1 + \\frac{[I]}{K_i}\\right) + [S]} = \\frac{V_{\\max}[S]}{K_m \\left(1 + \\frac{[I]}{K_i}\\right) + [S]}$$\n该方程描述了初始速率对底物和抑制剂浓度的依赖关系。\n\n接下来，我们使用双倒数形式，即 Lineweaver–Burk 形式，对该方程进行线性化。我们取速率方程的倒数：\n$$\\frac{1}{v} = \\frac{K_m \\left(1 + \\frac{[I]}{K_i}\\right) + [S]}{V_{\\max}[S]}$$\n$$\\frac{1}{v} = \\frac{K_m \\left(1 + \\frac{[I]}{K_i}\\right)}{V_{\\max}[S]} + \\frac{[S]}{V_{\\max}[S]}$$\n$$\\frac{1}{v} = \\left( \\frac{K_m}{V_{\\max}} \\left(1 + \\frac{[I]}{K_i}\\right) \\right) \\frac{1}{[S]} + \\frac{1}{V_{\\max}}$$\n这是一个形如 $y = m x + c$ 的线性方程，其中 $y = 1/v$，$x = 1/[S]$。Lineweaver-Burk 图的斜率，我们记为 $m([I])$，是：\n$$m([I]) = \\frac{K_m}{V_{\\max}} \\left(1 + \\frac{[I]}{K_i}\\right)$$\ny 轴截距是 $1/V_{\\max}$。对于竞争性抑制，截距与 $[I]$ 无关，而斜率 $m([I])$ 发生变化。\n\n我们现在必须证明 LB 斜率对 $[I]$ 的依赖性是线性的。我们展开 $m([I])$ 的表达式：\n$$m([I]) = \\frac{K_m}{V_{\\max}} + \\left(\\frac{K_m}{V_{\\max} K_i}\\right)[I]$$\n这显然是 $[I]$ 的一个线性函数。$m([I])$ 对 $[I]$ 的作图将是一条直线，其：\n$$\\text{截距} = a = \\frac{K_m}{V_{\\max}}$$\n$$\\text{斜率} = b = \\frac{K_m}{V_{\\max} K_i}$$\n为了从这些参数中找到 $K_i$ 的估计量，我们可以取它们的比值：\n$$\\frac{a}{b} = \\frac{K_m/V_{\\max}}{K_m/(V_{\\max}K_i)} = K_i$$\n因此，$K_i$ 可以通过 LB 斜率对抑制剂浓度的二次作图的截距与斜率之比来估计。\n\n现在，我们对所提供的数据进行普通最小二乘回归，以找到截距 $a$ 和斜率 $b$ 的最佳拟合值。模型为 $y_i = a + b x_i$，其中 $y_i$ 表示 LB 斜率 $m([I]_i)$，$x_i$ 表示抑制剂浓度 $[I]_i$。\n数据点 $(x_i, y_i)$ 为：$(0, 2.01)$、$(5, 2.83)$、$(10, 3.68)$、$(20, 5.31)$、$(40, 8.65)$。数据点数量为 $n=5$。$x_i$ 的单位是 $\\mu\\mathrm{M}$，$y_i$ 的单位是 $\\mathrm{s}$。\n\n我们计算回归公式所需的各项总和：\n$\\sum x_i = 0 + 5 + 10 + 20 + 40 = 75$\n$\\sum y_i = 2.01 + 2.83 + 3.68 + 5.31 + 8.65 = 22.48$\n$\\sum x_i^2 = 0^2 + 5^2 + 10^2 + 20^2 + 40^2 = 0 + 25 + 100 + 400 + 1600 = 2125$\n$\\sum x_i y_i = (0)(2.01) + (5)(2.83) + (10)(3.68) + (20)(5.31) + (40)(8.65) = 0 + 14.15 + 36.8 + 106.2 + 346 = 503.15$\n\n平均值为：\n$\\bar{x} = \\frac{\\sum x_i}{n} = \\frac{75}{5} = 15$\n$\\bar{y} = \\frac{\\sum y_i}{n} = \\frac{22.48}{5} = 4.496$\n\n回归线的斜率 $b$ 由下式给出：\n$$b = \\frac{\\sum x_i y_i - n \\bar{x} \\bar{y}}{\\sum x_i^2 - n \\bar{x}^2} = \\frac{503.15 - 5(15)(4.496)}{2125 - 5(15)^2} = \\frac{503.15 - 337.2}{2125 - 1125} = \\frac{165.95}{1000} = 0.16595 \\ \\mathrm{s} \\cdot \\mu\\mathrm{M}^{-1}$$\n截距 $a$ 由下式给出：\n$$a = \\bar{y} - b \\bar{x} = 4.496 - (0.16595)(15) = 4.496 - 2.48925 = 2.00675 \\ \\mathrm{s}$$\n使用我们推导的估计量 $K_i = a/b$：\n$$K_i = \\frac{2.00675 \\ \\mathrm{s}}{0.16595 \\ \\mathrm{s} \\cdot \\mu\\mathrm{M}^{-1}} \\approx 12.0925 \\ \\mu\\mathrm{M}$$\n问题要求将最终答案四舍五入到三位有效数字。\n$$K_i = 12.1 \\ \\mu\\mathrm{M}$$\n至此，所需分析已完成。", "answer": "$$\\boxed{12.1}$$", "id": "2607501"}, {"introduction": "优秀的实验设计与数据分析同等重要，它能让实验结果的信息量最大化。这项高级实践将引导你进入最优实验设计的领域，学习如何运用计算方法来规划动力学实验。你将通过构建并最小化一个基于费雪信息矩阵 (Fisher Information Matrix) 的目标函数，来确定一组能够最精确、最低相关性地估算出 $K_m$ 和 $V_{\\max}$ 的底物浓度，这代表了现代定量生物学中理论指导实验的前沿方法 [@problem_id:2607490]。", "problem": "给定一个基于米-门氏动力学的典型稳态生物催化模型。假设一个单底物酶系统，其反应速率由函数 $v(\\,S\\,;\\,\\theta\\,)$ 建模，其中 $S$ 表示底物浓度，$\\theta = (K_m, V_{\\max})$ 是动力学参数：米氏常数 $K_m$ 和最大速率 $V_{\\max}$。该模型为 $v(\\,S\\,;\\,\\theta\\,) = \\dfrac{V_{\\max} S}{K_m + S}$。在底物浓度为 $S_i$ 时，每个观测到的初始速率 $y_i$ 都受到独立的加性噪声 $\\varepsilon_i$ 的干扰，该噪声均值为零且方差恒定，即 $y_i = v(\\,S_i\\,;\\,\\theta\\,) + \\varepsilon_i$，其中对于所有 $i$，$\\varepsilon_i \\sim \\mathcal{N}(\\,0, \\sigma^2\\,)$ 独立同分布。所有底物浓度 $S$ 以微摩尔（micromolar）为单位，所有速率 $v$ 和 $y$ 以微摩尔每秒（micromolar per second）为单位，噪声标准差 $\\sigma$ 也以微摩尔每秒为单位。\n\n从以下几点出发： \n- 标准的米-门氏定义 $v(\\,S\\,;\\,\\theta\\,) = \\dfrac{V_{\\max} S}{K_m + S}$，\n- 测量噪声为独立、同方差（homoscedastic）的高斯噪声，其方差为 $\\sigma^2$ 的假设，\n- 在高斯噪声下，对于一个给定的设计 $\\{S_i\\}_{i=1}^n$，非线性模型的费雪信息矩阵（FIM）是模型对参数的灵敏度（梯度）的外积之和，并由 $\\sigma^{-2}$ 进行缩放，\n推导出一个算法，用于选择一组底物浓度，使得在 $(K_m, V_{\\max})$ 的指定均匀先验期望下，$K_m$ 和 $V_{\\max}$ 的估计值尽可能地去相关。\n\n你的任务是编写一个完整的、确定性的程序。对于每个测试用例，该程序在一个有限的候选底物浓度集合中进行搜索，并选择一个大小为 $n$ 的无序多重集（允许重复），该多重集在以下框架下最小化 $K_m$ 和 $V_{\\max}$ 之间的预期绝对相关性：\n\n1. 对于一个固定的参数抽取 $\\theta = (K_m, V_{\\max})$，费雪信息矩阵为 \n$$\n\\mathcal{I}(\\theta; \\{S_i\\}_{i=1}^n) \\;=\\; \\sum_{i=1}^n \\sigma^{-2} \\,\\nabla_{\\theta} v(\\,S_i\\,;\\,\\theta\\,)\\,\\nabla_{\\theta} v(\\,S_i\\,;\\,\\theta\\,)^{\\top},\n$$\n其中 $\\nabla_{\\theta} v$ 是关于 $(K_m, V_{\\max})$ 的梯度。\n\n2. 估计量的渐近协方差矩阵由费雪信息矩阵的逆 $\\mathcal{I}(\\theta; \\{S_i\\})^{-1}$ 近似。$K_m$ 和 $V_{\\max}$ 之间的相关性是相应的非对角线元素，通过对角线元素的几何平均值进行归一化。对于任何给定的 $\\theta$，将绝对相关性定义为\n$$\n\\rho_{\\lvert\\cdot\\rvert}(\\theta; \\{S_i\\}) \\;=\\; \\left| \\dfrac{[\\mathcal{I}(\\theta; \\{S_i\\})^{-1}]_{1,2}}{\\sqrt{[\\mathcal{I}(\\theta; \\{S_i\\})^{-1}]_{1,1}\\,[\\mathcal{I}(\\theta; \\{S_i\\})^{-1}]_{2,2}}} \\right|.\n$$\n\n3. 在一个矩形区域上的均匀先验分布 $K_m \\sim \\mathcal{U}([K_m^{\\min}, K_m^{\\max}])$，$V_{\\max} \\sim \\mathcal{U}([V_{\\max}^{\\min}, V_{\\max}^{\\max}])$ 下，将目标函数定义为 $\\rho_{\\lvert\\cdot\\rvert}(\\theta; \\{S_i\\})$ 的先验期望。使用从先验分布中抽取的 $N_{\\text{mc}}$ 个独立样本，通过蒙特卡洛方法来近似这个期望。使用固定的伪随机种子以确保确定性。\n\n4. 如果对于任何抽取的 $\\theta$，$\\mathcal{I}(\\theta; \\{S_i\\})$ 都是不可逆的，则为该设计分配一个严格大于 $1$ 的高惩罚目标值（例如，$10^6$），因为此时相关性未定义。否则，目标值必须位于 $[0,1]$ 区间内。\n\n5. 在绝对容差 $10^{-12}$ 内达到相同最小目标值的设计中，选择按升序排序后字典序最小的底物浓度列表。\n\n程序必须仅使用指定的执行环境实现上述要求，并为以下测试套件生成输出。所有浓度必须以微摩尔（micromolar）表示，所有速率以微摩尔每秒（micromolar per second）表示，噪声标准差也以微摩尔每秒表示。每个测试用例的最终输出是所选的、按升序排序的底物浓度多重集。\n\n测试套件：\n\n- 案例1（一般情况）： \n  - 先验分布：$K_m \\in [5, 50]$, $V_{\\max} \\in [0.5, 5]$。\n  - 候选底物浓度（微摩尔）：$\\{1, 3, 10, 30, 100\\}$。\n  - 实验次数：$n = 4$。\n  - 噪声标准差：$\\sigma = 0.05$。\n  - 蒙特卡洛抽样次数：$N_{\\text{mc}} = 200$。\n  - 随机种子：$12345$。\n\n- 案例2（关注边界的窄先验分布）：\n  - 先验分布：$K_m \\in [1, 3]$, $V_{\\max} \\in [1, 2]$。\n  - 候选底物浓度（微摩尔）：$\\{0.1, 0.3, 1, 3, 10\\}$。\n  - 实验次数：$n = 3$。\n  - 噪声标准差：$\\sigma = 0.05$。\n  - 蒙特卡洛抽样次数：$N_{\\text{mc}} = 300$。\n  - 随机种子：$54321$。\n\n- 案例3（非常宽的先验分布）：\n  - 先验分布：$K_m \\in [1, 1000]$, $V_{\\max} \\in [0.1, 100]$。\n  - 候选底物浓度（微摩尔）：$\\{0.5, 2, 10, 50, 200, 800\\}$。\n  - 实验次数：$n = 5$。\n  - 噪声标准差：$\\sigma = 0.05$。\n  - 蒙特卡洛抽样次数：$N_{\\text{mc}} = 150$。\n  - 随机种子：$777$。\n\n要求的最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素本身是一个按升序排序的逗号分隔列表，代表所选的微摩尔浓度，并精确到三位小数。例如，格式必须是 $[\\,[s_{1,1}, s_{1,2}, \\dots], [s_{2,1}, s_{2,2}, \\dots], [s_{3,1}, s_{3,2}, \\dots]\\,]$，并作为单行打印，如 \"[[0.300,1.000,3.000],[...],[...]]\"。", "solution": "所述问题是有效的。它在科学上基于酶动力学和统计参数估计的原理，问题设定良好，具有明确的目标和约束，并以精确、客观的语言表述。它代表了最优实验设计中的一个标准计算问题。我们将着手对解决方案进行形式化推导。\n\n目标是从给定的候选集合中选择一个底物浓度的多重集 $\\{S_i\\}_{i=1}^n$，以最小化米-门氏参数 $K_m$ 和 $V_{\\max}$ 估计量之间的预期绝对相关性。\n\n首先，我们推导必要的解析表达式。反应速率 $v$ 作为底物浓度 $S$ 和参数 $\\theta = (K_m, V_{\\max})$ 的函数的米-门氏模型是：\n$$ v(S; \\theta) = \\frac{V_{\\max} S}{K_m + S} $$\n\n费雪信息矩阵（FIM）$\\mathcal{I}$ 是根据模型对参数的梯度构建的。梯度向量 $\\nabla_{\\theta} v$ 包含 $v$ 对 $K_m$ 和 $V_{\\max}$ 的偏导数：\n$$ \\frac{\\partial v}{\\partial K_m} = V_{\\max} S \\frac{-1}{(K_m + S)^2} = -\\frac{V_{\\max} S}{(K_m + S)^2} $$\n$$ \\frac{\\partial v}{\\partial V_{\\max}} = \\frac{S}{K_m + S} $$\n因此，梯度是：\n$$ \\nabla_{\\theta} v(S; \\theta) = \\begin{pmatrix} -\\frac{V_{\\max} S}{(K_m + S)^2} \\\\ \\frac{S}{K_m + S} \\end{pmatrix} $$\n\n对于一个由在底物浓度 $\\{S_i\\}_{i=1}^n$ 处的 $n$ 次测量组成的设计，FIM 由梯度的外积之和给出，并按噪声方差的倒数 $\\sigma^{-2}$ 进行缩放：\n$$ \\mathcal{I}(\\theta; \\{S_i\\}) = \\frac{1}{\\sigma^2} \\sum_{i=1}^n \\nabla_{\\theta} v(S_i; \\theta) \\nabla_{\\theta} v(S_i; \\theta)^{\\top} $$\n我们定义一个矩阵 $\\mathcal{M} = \\sigma^2 \\mathcal{I}$。这个 $2 \\times 2$ 对称矩阵的元素是：\n$$ \\mathcal{M}_{11} = \\sum_{i=1}^n \\left(\\frac{\\partial v_i}{\\partial K_m}\\right)^2 = \\sum_{i=1}^n \\frac{V_{\\max}^2 S_i^2}{(K_m + S_i)^4} $$\n$$ \\mathcal{M}_{12} = \\mathcal{M}_{21} = \\sum_{i=1}^n \\frac{\\partial v_i}{\\partial K_m} \\frac{\\partial v_i}{\\partial V_{\\max}} = \\sum_{i=1}^n -\\frac{V_{\\max} S_i^2}{(K_m + S_i)^3} $$\n$$ \\mathcal{M}_{22} = \\sum_{i=1}^n \\left(\\frac{\\partial v_i}{\\partial V_{\\max}}\\right)^2 = \\sum_{i=1}^n \\frac{S_i^2}{(K_m + S_i)^2} $$\n其中 $v_i = v(S_i; \\theta)$。\n\n估计量 $(\\hat{K}_m, \\hat{V}_{\\max})$ 的渐近协方差矩阵由 FIM 的逆 $\\mathcal{I}^{-1} = \\sigma^2 \\mathcal{M}^{-1}$ 近似。两个参数估计量之间的相关系数 $\\rho$ 从协方差矩阵的元素中导出：\n$$ \\rho = \\frac{[\\mathcal{I}^{-1}]_{1,2}}{\\sqrt{[\\mathcal{I}^{-1}]_{1,1} [\\mathcal{I}^{-1}]_{2,2}}} $$\n由于 $\\mathcal{I}^{-1}$ 与 $\\mathcal{M}^{-1}$ 成正比，标量项 $\\sigma^2$ 和来自矩阵求逆的行列式项会相互抵消，得到：\n$$ \\rho = \\frac{- \\mathcal{M}_{12}}{\\sqrt{\\mathcal{M}_{11} \\mathcal{M}_{22}}} $$\n代入 $\\mathcal{M}$ 元素的表达式：\n$$ \\rho = \\frac{- \\left( \\sum_{i=1}^n -\\frac{V_{\\max} S_i^2}{(K_m + S_i)^3} \\right)}{\\sqrt{\\left( \\sum_{i=1}^n \\frac{V_{\\max}^2 S_i^2}{(K_m + S_i)^4} \\right) \\left( \\sum_{i=1}^n \\frac{S_i^2}{(K_m + S_i)^2} \\right)}} = \\frac{V_{\\max} \\sum_{i=1}^n \\frac{S_i^2}{(K_m + S_i)^3}}{\\sqrt{V_{\\max}^2 \\left( \\sum_{i=1}^n \\frac{S_i^2}{(K_m + S_i)^4} \\right) \\left( \\sum_{i=1}^n \\frac{S_i^2}{(K_m + S_i)^2} \\right)}} $$\n一个关键的简化出现了：参数 $V_{\\max}$ 从 $\\rho$ 的表达式中消掉了：\n$$ \\rho(\\theta; \\{S_i\\}) = \\frac{\\sum_{i=1}^n \\frac{S_i^2}{(K_m + S_i)^3}}{\\sqrt{\\left(\\sum_{i=1}^n \\frac{S_i^2}{(K_m + S_i)^4}\\right) \\left(\\sum_{i=1}^n \\frac{S_i^2}{(K_m + S_i)^2}\\right)}} $$\n这表明 $\\hat{K}_m$ 和 $\\hat{V}_{\\max}$ 之间的相关性与 $V_{\\max}$ 的真实值以及噪声标准差 $\\sigma$ 无关。问题要求对 $K_m$ 和 $V_{\\max}$ 的先验分布进行平均。虽然用于计算相关性的 $V_{\\max}$ 的蒙特卡洛抽样在计算上是多余的，但问题规定了这一点，因此需要生成这些样本以确保伪随机数生成器的状态按规定演进。然而，目标函数的计算将正确地仅依赖于 $K_m$ 的样本。要最小化的目标函数是绝对相关性的期望值 $\\mathbb{E}_{K_m}[\\rho_{\\lvert\\cdot\\rvert}]$，通过对 $K_m$ 的先验进行蒙特卡洛积分来近似。\n\nFIM 以及 $\\mathcal{M}$ 是奇异的，当且仅当其行列式为零。行列式 $\\det(\\mathcal{M}) = \\mathcal{M}_{11}\\mathcal{M}_{22} - \\mathcal{M}_{12}^2$ 为零，当且仅当对于所有 $i=1, \\dots, n$，梯度向量 $\\nabla_{\\theta}v(S_i; \\theta)$ 都是共线的。梯度向量的方向取决于 $S_i$。因此，仅当设计中所有选择的底物浓度 $S_i$ 相同时，才会发生共线性。这样的设计对于区分这两个参数是无信息的，并且相关性是未定义的。根据问题陈述，为此类奇异设计的目标函数分配一个大的惩罚值 $10^6$。\n\n寻找最优设计的算法如下：\n1.  枚举所有可能的实验设计。一个设计是从候选底物浓度中有放回地抽样，形成的大小为 $n$ 的多重集。此类设计的数量足够少，可以进行穷举搜索。\n2.  对于每个候选设计 $\\{S_i\\}_{i=1}^n$：\n    a. 检查奇异性。如果所有 $S_i$ 都相同，则分配惩罚目标值 $10^6$ 并处理下一个设计。\n    b. 如果设计非奇异，则估计目标函数。使用指定的随机种子，从其均匀先验分布 $\\mathcal{U}[K_m^{\\min}, K_m^{\\max}]$ 中生成 $N_{\\text{mc}}$ 个 $K_m$ 样本。\n    c. 对于每个抽样的 $K_m$，使用推导出的公式计算绝对相关性 $\\rho_{\\lvert\\cdot\\rvert}$。\n    d. 该设计的目标值是这 $N_{\\text{mc}}$ 个相关性值的平均值。\n3.  追踪迄今为止找到的具有最小目标值的设计。应用平局决胜规则：如果一个设计产生的目标值与当前最小值之差在 $10^{-12}$ 的绝对容差内，则选择其浓度按升序排序后字典序较小的那个。\n4.  在评估完所有可能的设计后，存储的最优设计即为给定测试用例的结果。\n\n此过程是确定性的，并保证能找到指定的最优设计。实现将遵循此逻辑。", "answer": "[[3.000,3.000,30.000,100.000],[0.300,1.000,3.000],[2.000,10.000,50.000,200.000,800.000]]", "id": "2607490"}]}