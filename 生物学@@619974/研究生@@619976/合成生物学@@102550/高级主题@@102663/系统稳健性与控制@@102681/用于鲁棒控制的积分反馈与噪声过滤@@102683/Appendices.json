{"hands_on_practices": [{"introduction": "生物系统纷繁复杂，我们如何从实验数据中构建简洁而有效的模型呢？这项练习将让你扮演系统生物学家的角色，通过分析一个生物电路的频率响应数据，来辨识其动态特性 [@problem_id:2747991]。你将应用线性系统理论的基本概念，特别是关于一阶和二阶低通滤波器的知识，并使用赤池信息量准则（Akaike Information Criterion, $AIC$）来定量地权衡模型的准确性与复杂性，最终为该电路选择最合适的模型。这项实践旨在训练系统辨识的核心技能，这对于构建和验证生物控制系统的预测模型至关重要。", "problem": "您将要执行一项建模任务，该任务基于对一个生物分子调控回路的闭环频率响应分析，该回路采用积分反馈以实现鲁棒控制和噪声滤波。假设该回路表现为一个稳定的线性时不变 (LTI) 系统。您必须通过拟合模型并使用 Akaike 信息准则 (AIC) 进行比较，来确定一阶或二阶低通模型中哪一个能更好地解释经验幅度响应数据。您的程序必须生成一行输出，其中包含每个数据集所选的模型阶数，格式为一个方括号内以逗号分隔的列表。\n\n从以下基本原理出发：\n- 分子生物学的中心法则将转录和翻译确立为动态过程，在合适的工作区间下，围绕稳态的微小偏差可以通过 LTI 近似进行建模。\n- 一个稳定的一阶低通 LTI 系统可以由一个单状态的线性常微分方程 (ODE) 表示。\n- 一个稳定的二阶低通 LTI 系统可以由一个具有两个状态和阻尼的线性 ODE 表示。\n- 脉冲响应的傅里叶变换产生频率响应，频率响应的幅度是其与自身复共轭乘积的平方根。\n- 在独立同分布 (i.i.d.)、零均值、恒定方差的高斯测量噪声下，未知参数的最大似然估计简化为最小二乘法，而 Akaike 信息准则 (AIC) 为数据拟合度和模型复杂度之间提供了一个有原则的权衡。\n\n使用的定义：\n- 一阶模型对应于形式为 $ \\tau \\, \\frac{dx}{dt} + x = K \\, u $ 的 ODE，其中 $K > 0$ 是静态增益，$\\tau > 0$ 是时间常数，输入为 $u$，输出为 $x$。其频率响应由传递函数 $ G(s) = \\frac{X(s)}{U(s)} $ 在 $ s = j \\omega $ 处求值得到。\n- 二阶模型对应于形式为 $ \\frac{d^2 x}{dt^2} + 2 \\zeta \\omega_n \\frac{dx}{dt} + \\omega_n^2 x = K \\, \\omega_n^2 \\, u $ 的 ODE，其中 $K > 0$ 是静态增益，$\\omega_n > 0$ 是自然频率，$\\zeta > 0$ 是阻尼比。其频率响应由传递函数 $ G(s) = \\frac{X(s)}{U(s)} $ 在 $ s = j \\omega $ 处求值得到。\n\n对于此问题，您必须将以下内容视为既定事实：\n- 频率以弧度/秒为单位提供，您必须将所有角度视为弧度。频率 $\\omega$ 的单位是 $\\text{rad}\\cdot \\text{s}^{-1}$。幅度响应是无量纲的。\n- 对于每个数据集，经验幅度响应 $M(\\omega)$ 是由上述两个模型之一使用指定参数生成的。所提供的测试套件中没有添加测量噪声。\n\n您的任务：\n1. 对于每个数据集，在指定的离散频率上，使用指定的模型结构和参数构建经验幅度响应。然后，通过最小化模型预测幅度与经验幅度在频率网格上的残差平方和，将两个候选模型（一阶和二阶）独立地拟合到该经验幅度响应上。\n2. 假设残差是独立同分布的高斯分布，并使用 Akaike 信息准则 (AIC) 来选择模型阶数。您必须基于残差平方和以及每个模型中的自由参数数量来计算 AIC，并且必须选择 AIC 较低的模型。\n3. 所有计算必须以 $\\text{rad}\\cdot \\text{s}^{-1}$ 为单位处理频率。没有其他物理单位需要报告。最终输出必须是每个数据集的模型阶数（整数）：如果首选一阶模型，则输出 $1$；如果首选二阶模型，则输出 $2$。\n\n测试套件（数据集）：\n- 数据集 A（具有积分反馈的闭环，在测量频带内有效表现为一阶低通）：一阶模型，参数为 $K = 1.7$，$\\tau = 1.8$。频率网格：从 $10^{-2}$ 到 $10^{2}$ 对数均匀分布的 $\\omega$ 值，共 $31$ 个点（含端点）。\n- 数据集 B（具有积分作用和附加动态模式的闭环，导致欠阻尼二阶行为）：二阶模型，参数为 $K = 1.0$，$\\omega_n = 0.9$，$\\zeta = 0.25$。频率网格：从 $10^{-2}$ 到 $10^{2}$ 对数均匀分布的 $\\omega$ 值，共 $31$ 个点（含端点）。\n- 数据集 C（在带宽受限的测量下观察到的一阶噪声滤波行为）：一阶模型，参数为 $K = 2.0$，$\\tau = 0.8$。频率网格：$\\omega \\in \\{0.05, 0.1, 0.2, 0.5, 2.0, 5.0, 20.0\\}$。\n- 数据集 D（具有中等阻尼的二阶闭环衰减）：二阶模型，参数为 $K = 1.2$，$\\omega_n = 1.3$，$\\zeta = 0.7$。频率网格：从 $10^{-2}$ 到 $10^{1.5}$ 对数均匀分布的 $\\omega$ 值，共 $20$ 个点（含端点）。\n\n拟合与模型选择细节：\n- 对于一阶候选模型，将参数向量视为 $[K, \\tau]$，且两者均严格为正。\n- 对于二阶候选模型，将参数向量视为 $[K, \\omega_n, \\zeta]$，且所有参数均严格为正。\n- 对于每个数据集和每个候选模型，使用非线性最小二乘法来最小化经验幅度与模型预测幅度在数据集频率网格上的残差平方和。\n- 在独立同分布高斯残差的假设下，为每个拟合模型计算 Akaike 信息准则 (AIC)，并选择 AIC 较低的模型。如果残差平方和在数值上恰好为零，则通过用一个小的正数下限替换零来安全地正则化对数，以避免未定义的值。\n\n要求的最终输出格式：\n- 您的程序应生成一行输出，其中包含一个方括号内以逗号分隔的列表。该列表应精确包含 $4$ 个整数，每个数据集一个，按 A、B、C、D 的顺序排列，其中每个整数若为 $1$ 则表示选择了一阶模型，若为 $2$ 则表示选择了二阶模型。例如，一个有效的输出看起来像 $[1,2,1,2]$。\n\n角度单位和物理单位：\n- 频率必须以弧度/秒为单位处理。幅度是无量纲的。输出中不需要其他单位，它纯粹是一个整数列表。\n\n约束条件：\n- 在选择模型时，您不能假定任何关于真实生成模型的先验知识；选择必须完全基于从拟合残差和参数数量计算出的 AIC。\n- 在拟合过程中，所有参数必须保持严格为正。\n\n您的程序必须是完全自包含的，并生成确切要求的输出行，不得包含任何额外文本。", "solution": "本任务是针对给定的几个经验频率响应数据集，在一阶和二阶低通滤波器模型之间进行模型选择。选择必须基于 Akaike 信息准则 (AIC)，该准则提供了一种在拟合优度与模型复杂度之间进行权衡的原则性方法。整个分析在线性时不变 (LTI) 系统理论的框架内进行。\n\n首先，我们对候选模型进行形式化描述。\n\n一个稳定的一阶低通系统由以下常微分方程描述：\n$$ \\tau \\frac{dx(t)}{dt} + x(t) = K u(t) $$\n其中 $K > 0$ 是静态增益，$\\tau > 0$ 是时间常数。应用拉普拉斯变换得到传递函数 $G_1(s) = \\frac{X(s)}{U(s)}$：\n$$ G_1(s) = \\frac{K}{\\tau s + 1} $$\n通过代入 $s = j\\omega$ 获得频率响应，其中 $\\omega$ 是角频率，单位为 $\\text{rad}\\cdot\\text{s}^{-1}$，$j = \\sqrt{-1}$。\n$$ G_1(j\\omega) = \\frac{K}{1 + j\\omega\\tau} $$\n频率响应的幅度，我们记为 $M_1(\\omega)$，是这个复数的模：\n$$ M_1(\\omega; K, \\tau) = |G_1(j\\omega)| = \\frac{|K|}{|1 + j\\omega\\tau|} = \\frac{K}{\\sqrt{1^2 + (\\omega\\tau)^2}} = \\frac{K}{\\sqrt{1 + (\\omega\\tau)^2}} $$\n该模型有 $k_1 = 2$ 个自由参数：$\\theta_1 = [K, \\tau]$。\n\n一个稳定的二阶低通系统由以下 ODE 描述：\n$$ \\frac{d^2 x(t)}{dt^2} + 2 \\zeta \\omega_n \\frac{dx(t)}{dt} + \\omega_n^2 x(t) = K \\omega_n^2 u(t) $$\n其中 $K > 0$ 是静态增益，$\\omega_n > 0$ 是自然频率，$\\zeta > 0$ 是阻尼比。相应的传递函数 $G_2(s)$ 是：\n$$ G_2(s) = \\frac{K \\omega_n^2}{s^2 + 2\\zeta\\omega_n s + \\omega_n^2} $$\n频率响应是 $G_2(j\\omega)$：\n$$ G_2(j\\omega) = \\frac{K \\omega_n^2}{(j\\omega)^2 + 2\\zeta\\omega_n (j\\omega) + \\omega_n^2} = \\frac{K \\omega_n^2}{(\\omega_n^2 - \\omega^2) + j(2\\zeta\\omega_n\\omega)} $$\n幅度响应 $M_2(\\omega)$ 是：\n$$ M_2(\\omega; K, \\omega_n, \\zeta) = |G_2(j\\omega)| = \\frac{|K \\omega_n^2|}{|(\\omega_n^2 - \\omega^2) + j(2\\zeta\\omega_n\\omega)|} = \\frac{K \\omega_n^2}{\\sqrt{(\\omega_n^2 - \\omega^2)^2 + (2\\zeta\\omega_n\\omega)^2}} $$\n该模型有 $k_2 = 3$ 个自由参数：$\\theta_2 = [K, \\omega_n, \\zeta]$。\n\n对于每个数据集，我们在离散频率 $\\omega_i$ 处给定一组包含 $N$ 个经验幅度测量值 $M_{emp}(\\omega_i)$。模型选择的步骤如下：\n\n1.  **参数估计**：对于每个候选模型（$m \\in \\{1, 2\\}$），我们找到最优参数集 $\\hat{\\theta}_m$，以最小化模型预测幅度和经验数据之间的残差平方和 (RSS)。这是一个非线性最小二乘优化问题。\n    $$ RSS_m = \\min_{\\theta_m} \\sum_{i=1}^{N} \\left( M_m(\\omega_i; \\theta_m) - M_{emp}(\\omega_i) \\right)^2 $$\n    优化必须在所有参数（$K, \\tau, \\omega_n, \\zeta$）严格为正的约束下进行。\n\n2.  **使用 AIC 进行模型选择**：使用 Akaike 信息准则来比较模型。假设残差是独立同分布的高斯分布，模型 $m$ 的 AIC 计算如下：\n    $$ AIC_m = N \\ln\\left(\\frac{RSS_m}{N}\\right) + 2k_m $$\n    在此，$N$ 是数据点的数量，$k_m$ 是模型 $m$ 中的自由参数数量（$k_1=2$, $k_2=3$），$RSS_m$ 是拟合得到的最小化残差平方和。第一项量化了拟合优度，而第二项 $2k_m$ 是对模型复杂度的惩罚。较低的 AIC 值表示更优的模型。\n\n    一个关键的考虑点是，问题规定了经验数据是在没有噪声的情况下生成的。因此，在拟合真实的基础模型时，$RSS$ 在数值上将为零。$\\ln(0)$ 项是未定义的。按照指示，我们必须通过用一个小的正机器精度值 $\\epsilon > 0$ 替换任何为 $0$ 的 $RSS$ 值来正则化此计算。这确保了 AIC 是可计算的，同时仍然能通过一个大的负对数似然项来反映近乎完美的拟合。公式变为：\n    $$ AIC_m = N \\ln\\left(\\frac{\\max(RSS_m, \\epsilon)}{N}\\right) + 2k_m $$\n\n最后一步是比较 $AIC_1$ 和 $AIC_2$。如果 $AIC_1 < AIC_2$，则选择一阶模型（输出 $1$）。否则，选择二阶模型（输出 $2$）。对提供的四个数据集中的每一个都重复此过程。\n\n**每个数据集的执行计划：**\n-   **数据生成**：构建频率网格 $\\omega$，并使用指定的真实模型及其参数计算经验幅度 $M_{emp}(\\omega)$。\n-   **拟合一阶模型**：使用数值优化器找到使 $RSS_1$ 最小化的 $\\hat{K}_1$ 和 $\\hat{\\tau}_1$，并满足正值约束。\n-   **拟合二阶模型**：使用数值优化器找到使 $RSS_2$ 最小化的 $\\hat{K}_2$、$\\hat{\\omega}_n$ 和 $\\hat{\\zeta}$，并满足正值约束。\n-   **计算 AIC**：使用 $RSS_1$ 和 $k_1=2$ 计算 $AIC_1$。使用 $RSS_2$ 和 $k_2=3$ 计算 $AIC_2$。\n-   **选择并记录**：比较 $AIC_1$ 和 $AIC_2$ 以确定首选的模型阶数（$1$ 或 $2$）。\n\n此过程根据所提供的数据和标准，得出一个明确、客观的选择。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Solves the model selection problem for four datasets by fitting first-order and\n    second-order models and comparing them using the Akaike Information Criterion (AIC).\n    \"\"\"\n\n    # --- Model Definitions ---\n    def model_1_mag(omega, K, tau):\n        \"\"\"Magnitude of the first-order low-pass filter.\"\"\"\n        return K / np.sqrt(1 + (omega * tau)**2)\n\n    def model_2_mag(omega, K, wn, zeta):\n        \"\"\"Magnitude of the second-order low-pass filter.\"\"\"\n        return (K * wn**2) / np.sqrt((wn**2 - omega**2)**2 + (2 * zeta * wn * omega)**2)\n\n    # --- Test Suite ---\n    test_cases = {\n        'A': {\n            'gen_model': 'first',\n            'params': {'K': 1.7, 'tau': 1.8},\n            'omega': np.logspace(-2, 2, 31)\n        },\n        'B': {\n            'gen_model': 'second',\n            'params': {'K': 1.0, 'wn': 0.9, 'zeta': 0.25},\n            'omega': np.logspace(-2, 2, 31)\n        },\n        'C': {\n            'gen_model': 'first',\n            'params': {'K': 2.0, 'tau': 0.8},\n            'omega': np.array([0.05, 0.1, 0.2, 0.5, 2.0, 5.0, 20.0])\n        },\n        'D': {\n            'gen_model': 'second',\n            'params': {'K': 1.2, 'wn': 1.3, 'zeta': 0.7},\n            'omega': np.logspace(-2, 1.5, 20)\n        }\n    }\n\n    results = []\n    \n    # A small positive number to regularize the logarithm in AIC for RSS=0.\n    epsilon = np.finfo(float).eps\n\n    for key in sorted(test_cases.keys()): # Process in order A, B, C, D\n        case = test_cases[key]\n        omega_grid = case['omega']\n        params = case['params']\n        \n        # 1. Generate empirical magnitude data\n        if case['gen_model'] == 'first':\n            empirical_mag = model_1_mag(omega_grid, params['K'], params['tau'])\n        else:\n            empirical_mag = model_2_mag(omega_grid, params['K'], params['wn'], params['zeta'])\n\n        N = len(omega_grid)\n\n        # --- Fit Candidate Models and Calculate AIC ---\n\n        # Fit First-Order Model\n        def cost_func_1(p):\n            K, tau = p\n            model_mag = model_1_mag(omega_grid, K, tau)\n            return np.sum((model_mag - empirical_mag)**2)\n\n        p0_1 = [1.0, 1.0] # Initial guess for [K, tau]\n        bounds_1 = ((1e-9, None), (1e-9, None)) # Positivity constraints\n        res_1 = minimize(cost_func_1, p0_1, method='L-BFGS-B', bounds=bounds_1)\n        rss_1 = res_1.fun\n        k_1 = 2\n        aic_1 = N * np.log(max(rss_1, epsilon) / N) + 2 * k_1\n\n        # Fit Second-Order Model\n        def cost_func_2(p):\n            K, wn, zeta = p\n            model_mag = model_2_mag(omega_grid, K, wn, zeta)\n            return np.sum((model_mag - empirical_mag)**2)\n\n        p0_2 = [1.0, 1.0, 1.0] # Initial guess for [K, wn, zeta]\n        bounds_2 = ((1e-9, None), (1e-9, None), (1e-9, None)) # Positivity constraints\n        res_2 = minimize(cost_func_2, p0_2, method='L-BFGS-B', bounds=bounds_2)\n        rss_2 = res_2.fun\n        k_2 = 3\n        aic_2 = N * np.log(max(rss_2, epsilon) / N) + 2 * k_2\n\n        # 3. Model Selection\n        if aic_1 < aic_2:\n            results.append(1)\n        else:\n            results.append(2)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2747991"}, {"introduction": "除了从数据中拟合模型，仅通过观察系统的“接线图”来预测其动态行为是一项更深刻的技能。本问题将引导你分析一个常见的信号网络基序——相干前馈环路（coherent feedforward loop），它通过巧妙的结构设计来控制细胞响应的持续时间 [@problem_id:2592181]。你将通过分析一个包含不同时间尺度的数学模型，理解激酶如何在磷酸化其靶标的同时抑制相应的磷酸酶，从而揭示这种简单基序如何实现复杂的时域信息处理，例如信号持续性的延长和对输入信号时长的筛选。", "problem": "一个细胞表达蛋白磷酸酶 $1$ (PP$1$) 及其内源性抑制剂——抑制剂-$1$ (I-$1$) 和抑制剂-$2$ (I-$2$)。环腺苷酸依赖性蛋白激酶 (PKA) 磷酸化 I-$1$，将其转化为 PP$1$ 的高亲和力抑制剂。抑制剂-$2$ 与 PP$1$ 形成紧密复合物；糖原合酶激酶 $3$ (GSK$3$) 在 I-$2$ 的一个调节位点上对其进行磷酸化，从而调节 PP$1$–I-$2$ 复合物，使得磷酸化的 I-$2$ 有利于更高的 PP$1$ 活性，而未磷酸化的 I-$2$ 则有利于更强的抑制。蛋白激酶 A (PKA) 可通过一个缓慢的下游通路抑制 GSK$3$，从而在持续的 PKA 信号传导过程中，间接使 I-$2$ 转向抑制状态。考虑一个通用的 PKA 底物 $S$，其磷酸化分数为 $x(t)$。令 $y(t)$ 表示 I-$1$ 的磷酸化分数，令 $q(t)$ 表示 I-$2$ 在 GSK$3$ 位点上的磷酸化分数。假设在 PKA 输入 $u(t)$（任意单位）作用下，有以下最小质量作用模型。该输入是一个振幅为 $u_{0}$、持续时间为 $T$ 的方波脉冲，之后返回基线：\n\n$$\n\\frac{dx}{dt} \\;=\\; k_{p}\\,u(t)\\,\\big(1 - x\\big)\\;-\\;k_{d}\\,a_{\\mathrm{PP1}}(t)\\,x,\n$$\n\n\n$$\n\\frac{dy}{dt} \\;=\\; k_{y}^{+}\\,u(t)\\,\\big(1 - y\\big)\\;-\\;k_{y}^{-}\\,y,\n$$\n\n\n$$\n\\frac{dq}{dt} \\;=\\; -\\,k_{q}^{+}\\,u(t)\\,q\\;+\\;k_{q}^{-}\\,\\big(1 - q\\big).\n$$\n\n这里，$k_{p},k_{d},k_{y}^{+},k_{y}^{-},k_{q}^{+},k_{q}^{-} > 0$。PP$1$ 的有效活性被唯象地建模为\n\n$$\na_{\\mathrm{PP1}}(t) \\;=\\; \\frac{a_{0}}{1 + \\alpha\\,y(t) + \\gamma\\,\\big(1 - q(t)\\big)},\n$$\n\n其中 $a_{0},\\alpha,\\gamma > 0$。该模型反映了 I-$1$ 的磷酸化会增强对 PP$1$ 的抑制（$y$ 越大，$a_{\\mathrm{PP1}}$ 越小），而 I-$2$ 磷酸化的丧失（$q$ 越小）同样会增强对 PP$1$ 的抑制。假设存在与实验一致的时间尺度分离：$k_{y}^{+}\\,u_{0} \\gg k_{d}\\,a_{0}$ 且 $k_{y}^{-} \\ll k_{d}\\,a_{0}$，因此 I-$1$ 的磷酸化在 PKA 脉冲期间迅速上升，之后缓慢衰减；而 I-$2$ 支路更慢，$k_{q}^{\\pm} \\ll k_{y}^{\\pm}$。所有物质在 $t=0^{-}$ 时都从其基础稳态开始，此时 $u(0^{-})=0$。\n\n关于响应 PKA 脉冲的 $S$ 的去磷酸化时间调控，以下哪个网络层面的预测与上述模型和所述生化机制最为一致？\n\nA. PKA 对 I-$1$ 的磷酸化形成了一个非相coherent前馈环路，瞬时加速了 $S$ 的磷酸化和去磷酸化，使 $x(t)$ 的峰值变尖锐但加速了恢复；I-$2$ 的磷酸化只改变 $a_{\\mathrm{PP1}}$ 的振幅而不影响其时序。\n\nB. PKA 对 I-$1$ 的磷酸化实现了对 PP$1$ 的快速双负调控，这延迟了 $S$ 的去磷酸化，并在 PKA 脉冲结束后延长了升高的 $x(t)$；缓慢的 PKA 介导的对 GSK$3$ 的抑制降低了 $q(t)$，在延迟的时间尺度上进一步降低了 $a_{\\mathrm{PP1}}(t)$。这两者共同作用，产生了持续时间依赖的持久性（对短脉冲的低通滤波），并且如果 PP$1$ 的抑制达到饱和，可以产生开关样的恢复，从而将去磷酸化时间常数延长到超过由 $k_{d}\\,a_{0}$ 设定的值。\n\nC. PKA 对 I-$1$ 和 I-$2$ 的磷酸化组成性地激活 PP$1$，确保了在脉冲期间和之后 $S$ 的快速去磷酸化，将任何输入持续时间都转换为 $x(t)$ 的统一短暂响应。\n\nD. 因为 I-$1$ 是由不同于 PP$1$ 的另一种磷酸酶去磷酸化的，所以磷酸化 I-$1$ 不能影响 $S$ 的去磷酸化时序；只有 $k_{d}$ 或 $a_{0}$ 的变化会影响恢复动力学，因此 $x(t)$ 的时间曲线不受 I-$1$ 或 I-$2$ 动力学的影响。\n\nE. I-$1$ 和 I-$2$ 的联合作用通过积分反馈实现了完美适应，将 $x(t)$ 驱动回其刺激前的稳态，这与 PKA 脉冲的幅度和持续时间无关，且恢复时间是仅由 $k_{y}^{-}$决定的单一固定值。", "solution": "首先，我们分析系统对 PKA 脉冲 $u(t)$ 的响应行为。\n\n**1. 基础状态 (t < 0)**\n当 $u(t) = 0$ 时，我们通过将所有时间导数设为零来找到稳态：\n- $\\frac{dx}{dt} = 0 \\implies -k_{d}\\,a_{\\mathrm{PP1}}(0)\\,x(0) = 0$。由于 $k_{d} > 0$ 且 $a_{\\mathrm{PP1}}(0) > 0$，必有 $x(0) = 0$。\n- $\\frac{dy}{dt} = 0 \\implies -k_{y}^{-}\\,y(0) = 0 \\implies y(0) = 0$。\n- $\\frac{dq}{dt} = 0 \\implies k_{q}^{-}\\,(1 - q(0)) = 0 \\implies q(0) = 1$。\n初始的 PP1 活性为 $a_{\\mathrm{PP1}}(0) = \\frac{a_{0}}{1 + \\alpha y(0) + \\gamma(1 - q(0))} = \\frac{a_{0}}{1 + 0 + 0} = a_{0}$。\n因此，最初底物未磷酸化，抑制剂处于其非抑制形式，PP1 具有其基础活性 $a_{0}$。\n\n**2. PKA 脉冲期间 (0 ≤ t ≤ T)**\n施加 PKA 信号 $u(t) = u_{0}$。\n- **I-1 动力学 ($y(t)$)**: $\\frac{dy}{dt} = k_{y}^{+} u_{0} (1-y) - k_{y}^{-} y$。鉴于时间尺度分离 $k_{q}^{\\pm} \\ll k_{y}^{\\pm}$，$y$ 的动力学相对较快。$y(t)$ 从 $0$ 上升至其新稳态 $y_{ss} = \\frac{k_{y}^{+}u_{0}}{k_{y}^{+}u_{0} + k_{y}^{-}}$。\n- **I-2 动力学 ($q(t)$)**: $\\frac{dq}{dt} = -k_{q}^{+} u_{0} q + k_{q}^{-} (1-q)$。由于 $k_{q}^{\\pm} \\ll k_{y}^{\\pm}$，这些动力学非常缓慢。对于不是特别长的脉冲持续时间 $T$，$q(t)$ 将仅从其初始值 $1$ 略微下降。对于持续的 PKA 信号，它将缓慢接近其新稳态 $q_{ss} = \\frac{k_{q}^{-}}{k_{q}^{-} + k_{q}^{+}u_{0}}$。\n- **PP1 活性 ($a_{\\mathrm{PP1}}(t)$)**: 随着 $y(t)$ 迅速上升，$a_{\\mathrm{PP1}}$ 分母中的 $\\alpha y(t)$ 项增加，导致 PP1 活性迅速下降。如果脉冲足够长以使 $q(t)$ 下降，则 $\\gamma(1-q(t))$ 项将增加，导致 PP1 活性进一步、更缓慢地下降。\n- **底物动力学 ($x(t)$)**: PKA 通过两条平行通路作用于 $x$，形成一个相干前馈环路：\n    1.  **直接磷酸化**: $k_{p} u_{0} (1-x)$ 项直接驱动 S 的磷酸化。\n    2.  **间接去抑制**: PKA 启动对 PP1 的抑制（通过 $y$ 和 $q$）。降低的 $a_{\\mathrm{PP1}}(t)$ 降低了去磷酸化速率 $-k_{d} a_{\\mathrm{PP1}}(t) x$。\n两条通路协同作用以增加 $x(t)$。\n\n**3. PKA 脉冲之后 (t > T)**\nPKA 信号返回零，$u(t) = 0$。\n- **直接磷酸化停止**: $k_{p} u(t) (1-x)$ 项变为零。$x$ 的动力学现在仅由去磷酸化控制：$\\frac{dx}{dt} = -k_{d}\\,a_{\\mathrm{PP1}}(t)\\,x$。\n- **抑制剂动力学**:\n    - $y(t)$ 根据 $\\frac{dy}{dt} = -k_{y}^{-}y$ 从 $y(T)$ 指数衰减回 $0$。此衰减的时间常数为 $1/k_{y}^{-}$。问题陈述 $k_{y}^{-} \\ll k_{d}a_{0}$，意味着这是一个缓慢的衰减过程。\n    - $q(t)$ 根据 $\\frac{dq}{dt} = k_{q}^{-}(1-q)$ 从 $q(T)$ 恢复至 $1$。由于 $k_q^-$ 很小，这个恢复过程非常缓慢。\n- **PP1 活性恢复**: 因为 $y(t)$ 和 $q(t)$ 都缓慢地返回基线，PP1 活性 $a_{\\mathrm{PP1}}(t)$ 也从其被抑制的状态缓慢恢复到 $a_0$。\n- **底物去磷酸化**: 由于 $a_{\\mathrm{PP1}}(t)$ 在脉冲后的一段很长时间内保持低水平，因此 $x$ 的去磷酸化受到抑制。这导致 $x(t)$ 在比 PKA 脉冲本身长得多的时间内保持升高状态。系统表现出对刺激的持久性或“记忆”。\n\n**4. 网络层面功能**\n- **信号延长**: 该网络的主要功能是延长磷酸化信号。通过 I-1 支路对 PP1 的快速启动、缓慢解除的抑制确保了即使在激酶 (PKA) 关闭后，磷酸酶 (PP1) 仍然保持关闭状态，从而保留底物的磷酸化状态。\n- **持续时间依赖性 / 低通滤波**: 响应的程度取决于脉冲的持续时间 $T$。非常短的脉冲可能不足以显著增加 $y$，导致 $x$ 的响应微弱且短暂。较长的脉冲将完全激活 I-1 支路，导致强烈的持久性。非常长的脉冲还将激活更慢的 I-2 支路，导致对 PP1 更深远、更持久的抑制，从而使 $x$ 的持久性更长。系统滤除短时噪声，并对持续信号作出稳健响应。\n- **开关样恢复**: 函数形式 $a_{\\mathrm{PP1}}(t) = \\frac{a_{0}}{1 + \\text{Inhibition}}$，其中“抑制” = $\\alpha y + \\gamma(1-q)$，可以变得非常大。这意味着 $a_{\\mathrm{PP1}}$ 可以被驱动到接近零的值（可饱和抑制）。这会产生一个阈值效应：去磷酸化实际上是“关闭”的，直到来自 $y$ 和 $q$ 的总抑制下降到某个水平以下。这可以使 $x$ 的恢复呈开关样，并可以将其去磷酸化时间常数（有效值为 $(k_{d} a_{\\mathrm{PP1}}(t))^{-1}$）延长到远大于基础时间常数 $(k_{d} a_{0})^{-1}$。\n\n### 逐项分析\n\n**A. PKA 对 I-$1$ 的磷酸化形成了一个非相干前馈环路，瞬时加速了 $S$ 的磷酸化和去磷酸化，使 $x(t)$ 的峰值变尖锐但加速了恢复；I-$2$ 的磷酸化只改变 $a_{\\mathrm{PP1}}$ 的振幅而不影响其时序。**\n- 该前馈环路是相干的，而非非相干的，因为 PKA 的两个分支都促进 $x$ 的增加。\n- 该机制*延迟*去磷酸化并*减缓*恢复，与所述内容相反。\n- I-2 的动力学被明确设定为缓慢的，这意味着它们深刻影响 PP1 恢复的*时序*。\n- **结论**: 错误。\n\n**B. PKA 对 I-$1$ 的磷酸化实现了对 PP$1$ 的快速双负调控，这延迟了 $S$ 的去磷酸化，并在 PKA 脉冲结束后延长了升高的 $x(t)$；缓慢的 PKA 介导的对 GSK$3$ 的抑制降低了 $q(t)$，在延迟的时间尺度上进一步降低了 $a_{\\mathrm{PP1}}(t)$。这两者共同作用，产生了持续时间依赖的持久性（对短脉冲的低通滤波），并且如果 PP$1$ 的抑制达到饱和，可以产生开关样的恢复，从而将去磷酸化时间常数延长到超过由 $k_{d}\\,a_{0}$ 设定的值。**\n- **机制**: 虽然“双负调控”不是最精确的术语，但所描述的效应——PKA 激活 PP1 的抑制剂 (I-1-P)——确实延迟了去磷酸化并延长了信号 $x(t)$。这与我们的分析相符。\n- **I-2 作用**: 对 $q(t)$ 缓慢减少导致进一步、延迟的 PP1 抑制的描述是准确的。\n- **网络功能**: 关于持续时间依赖的持久性、低通滤波以及由于饱和抑制可能产生的开关样恢复的论断，都是该模型的直接推论，如上文推导所述。去磷酸化时间常数的延长也是正确的。\n- **结论**: 正确。该选项对系统的动力学提供了全面而准确的总结。\n\n**C. PKA 对 I-$1$ 和 I-$2$ 的磷酸化组成性地激活 PP$1$，确保了在脉冲期间和之后 $S$ 的快速去磷酸化，将任何输入持续时间都转换为 $x(t)$ 的统一短暂响应。**\n- PKA 信号*激活* PP1 的前提与问题陈述直接矛盾，后者明确指出磷酸化的 I-1 和未磷酸化的 I-2 是抑制剂。\n- 因此，关于快速去磷酸化和短暂响应的结论也是错误的。\n- **结论**: 错误。\n\n**D. 因为 I-$1$ 是由不同于 PP$1$ 的另一种磷酸酶去磷酸化的，所以磷酸化 I-$1$ 不能影响 $S$ 的去磷酸化时序；只有 $k_{d}$ 或 $a_{0}$ 的变化会影响恢复动力学，因此 $x(t)$ 的时间曲线不受 I-$1$ 或 I-$2$ 动力学的影响。**\n- 这个陈述包含一个严重的逻辑缺陷。$S$ 的去磷酸化速率明确依赖于 $a_{\\mathrm{PP1}}(t)$，而 $a_{\\mathrm{PP1}}(t)$ 是 $y(t)$（磷酸化的 I-1）的函数。I-1 本身如何被去磷酸化，与其在被磷酸化时抑制 PP1 的能力无关。I-1 和 I-2 的动力学对 $S$ 的时间调控至关重要。\n- **结论**: 错误。\n\n**E. I-$1$ 和 I-$2$ 的联合作用通过积分反馈实现了完美适应，将 $x(t)$ 驱动回其刺激前的稳态，这与 PKA 脉冲的幅度和持续时间无关，且恢复时间是仅由 $k_{y}^{-}$决定的单一固定值。**\n- 该网络基序是前馈环路，而非积分反馈。不会发生完美适应；对于持续输入 $u_0 > 0$，$x$ 的稳态值非零且依赖于 $u_0$。\n- 恢复时间不是固定的；它明确地依赖于持续时间，并涉及 $y$ 和 $q$ 两个变量的时间常数。\n- **结论**: 错误。", "answer": "$$\\boxed{B}$$", "id": "2592181"}, {"introduction": "为什么某些特定的电路设计，即“网络基序”（network motifs），在进化过程中被反复地选择和使用？这项练习将挑战你像进化工程师一样思考，跨越不同生物层级（如转录调控与信号转导）来比较各种控制策略的优劣 [@problem_id:2753875]。你将从响应时间、分子噪声和能量代谢等生物物理学第一性原理出发，推理为何前馈环路在转录网络中更为富集，而反馈环路在信号网络中占据主导地位。这项思辨练习旨在将你的理解从分析单个电路的功能提升到欣赏普适性的生物设计原则。", "problem": "考虑实现信息处理的两个细胞网络层：转录基因调控网络和基于蛋白质的信号网络。网络基序（network motif）是一种小的子图，其在网络中重复出现的频率显著高于在保持节点度的零模型中的预期频率。两种典型的基序是前馈环（feedforward loop, FFL），其中一个输入通过直接方式和通过一个中间调节物来调节一个输出；以及反馈环，其中一个组分通过一个调控相互作用的循环（正向或负向）来调节自身的活动。经验性的基序谱分析通常表明，FFL在转录网络中富集，而反馈环在信号网络中更占主导地位。仅以基础原理和广泛接受的事实作为出发点——例如分子生物学中心法则、基本化学动力学、低拷贝数下分子相互作用的随机性以及线性控制中的基本稳定性概念——请评估哪些陈述能从生物物理约束的角度最合理地解释基序谱中的这种差异。\n\n为具体起见，假设存在以下被广泛观察到的尺度分离和约束，并且不从一开始就假设任何特定的定量公式：转录和翻译共同导致的响应时间在 $10$ 到 $60$ 分钟的量级，并且通常在每个基因产物几十个分子的水平上运作；而共价修饰信号传导（例如磷酸化）的运作时间在 $1$ 到 $10$ 秒的量级，有效拷贝数约为 $10^3$，并由可逆酶动力学主导。假设用于蛋白质合成的资源比用于翻译后修饰的资源受到的限制要大得多，并且环境或上游的波动可以驱动持续时间为 $T_p$ 的短输入脉冲，而 $T_p$ 常常短于转录时间尺度。考虑保持入度和出度的零网络随机化是基序富集的标准基线。\n\n选择所有能够最令人信服地、从机理上解释在转录网络中观察到的前馈环富集以及在信号网络中观察到的反馈环富集的陈述：\n\nA. 在转录网络中，缓慢的生成-降解动力学和低拷贝数引入了长的有效延迟和阵发性。在这种延迟下，直接负反馈容易引起振荡或迟缓响应，而相干前馈环则充当持续性检测器，拒绝持续时间 $T_p \\ll \\tau_t$（其中 $\\tau_t$ 为转录时间尺度）的短输入脉冲，从而防止浪费性的蛋白质合成。这有利于FFL在转录网络中的富集。\n\nB. 在信号网络中，共价修饰循环速度快、拷贝数高，使得负反馈能够在不引起延迟诱导的不稳定性的情况下增加带宽和线性化响应，而正反馈则可以在需要时产生鲁棒的开关。由于这些反馈既快速又稳定，反馈基序在信号传导中被优先保留。\n\nC. 前馈环在转录网络中富集，主要是因为与固定资源成本下的单步调控相比，它们能加速响应，从而增加对短暂瞬变的敏感性。\n\nD. 信号网络在很大程度上缺乏前馈调控，因为酶饱和从根本上排除了两条会聚的调控路径作用于一个共同靶点的可能性。\n\nE. 不对称的基序谱是在没有任何选择压力的情况下，仅由度分布产生的：保持度的随机化已经能重现转录网络中的FFL富集和信号网络中的反馈富集，因此不需要进一步的生物物理解释。\n\nF. 在转录网络中，当启动子占据遵循希尔式结合时，非相干前馈环可以实现近似的倍数变化检测，使输出主要取决于输入的比率而非绝对水平；这在全球转录因子丰度波动的情况下是有利的。在信号传导中，精确适应和比例感应通过具有类积分作用的负反馈可以更有效地实现，从而进一步促进了反馈基序在该网络中的应用。\n\n选择所有适用的选项。", "solution": "本题旨在基于生物物理第一性原理，解释为何前馈环（FFL）在转录网络中富集，而反馈环在信号网络中更为普遍。分析的核心在于比较两类网络在时间尺度、分子数量和能量成本上的根本差异。\n\n**选项 A 分析：**\n该陈述假定，转录固有的长延迟（生成-降解动力学）使得负反馈容易变得不稳定，而相干FFL则充当持续性检测器，以滤除瞬态的、噪声般的信号，从而防止浪费性的蛋白质合成。\n让我们从第一性原理来审视这一点。转录和翻译的时间尺度被给定为 $\\tau_t \\in [10, 60]$ 分钟。在控制理论中，负反馈环中的时间延迟 $d$ 会引起振荡和不稳定性。对于一个简单的线性系统 $\\dot{x}(t) = -k x(t-d)$，其稳定性取决于增益 $k$ 和延迟 $d$ 的乘积。鉴于生物学上的延迟 $d=\\tau_t$ 非常大，维持稳定需要一个非常低的反​​馈增益，但这会使反馈变得微弱而迟缓。因此，在转录回路中实现有效、快速作用的负反馈在生物物理上是具有挑战性的。\n相反，一个相干前馈环（C1-FFL），其中转录因子 $X$ 同时通过直接路径 ($X \\rightarrow Y$) 和通过中间激活物 $Z$ 的间接路径 ($X \\rightarrow Z \\rightarrow Y$) 激活目标基因 $Y$，可以充当持续性检测器。如果 $Y$ 的激活需要来自两条路径的输入（一个“与”门逻辑），那么一个持续时间 $T_p \\ll \\tau_t$ 的短脉冲 $X$ 将是不够的。在中间产物 $Z$ 合成到足以共同激活 $Y$ 的水平之前，沿直接路径的信号就已经消失了。这种机制有效地滤除了虚假信号，考虑到蛋白质合成被明确指出是资源密集型的，这一点非常有利。在短暂、无意义的信号上浪费资源是适应不良的。\n这个推理是合理的，并直接使用了所提供的时间尺度和资源成本约束。\n结论：**正确**。\n\n**选项 B 分析：**\n这个陈述声称，快速、高拷贝数的信号网络是反馈控制的合适基底。负反馈可以在不产生不稳定的情况下增加带宽并线性化响应，而正反馈可以创建鲁棒的开关。\n给定的信号传导时间尺度在 $1$ 到 $10$ 秒的量级。这种短延迟允许存在稳定的高增益负反馈环。从控制理论可知，此类环路提供了几个好处：它们加速系统响应，增加系统能响应的频率范围（带宽），并通过使输出对组分参数的变化不那么敏感来赋予鲁棒性。这些都是高保真信息处理系统的理想特性。\n高拷贝数（$\\sim 10^3$）降低了随机波动的相对影响，使系统的行为更具确定性和可预测性，这是可靠反馈控制的一个先决条件。\n在此类系统中，正反馈可以产生双稳态，从而导致鲁棒的、不可逆的、类似开关的决策，这是细胞命运决定和信号阈值中的一个常见要求。\n信号通路的快速动力学和低噪声使其成为实现这些强大控制范式的理想选择。\n结论：**正确**。\n\n**选项 C 分析：**\n该陈述声称，FFL在转录网络中富集是因为它们能*加速*响应并增加对*短暂瞬变*的敏感性。\n这是对最常见的FFL，即C1-FFL，其主要功能的错误描述。如对选项A的分析，C1-FFL充当一个持续性检测器，其本质是*拒绝*短暂瞬变，而不是增加对其的敏感性。它的功能是引入一个延迟和一个过滤条件。虽然存在其他FFL变体，例如可以加速响应关闭的非相干FFL（I1-FFL），但在使其对转录最有用武之地的背景下，关于FFL加速响应以*增加对短暂瞬变敏感性*的普遍说法从根本上是错误的。该陈述的核心与公认的“持续性检测器”功能相矛盾。\n结论：**不正确**。\n\n**选项 D 分析：**\n该陈述认为，信号网络缺乏前馈调控是因为酶饱和从根本上阻止了两条会聚的调控路径在共同靶点上共存。\n这个前提在两个方面是事实性错误的。首先，即使FFL不是主导的基序类别，它们也存在于信号网络中。一个经典的例子是单个激酶磷酸化两种不同的底物，其中一个底物随后作用于另一个。其次，酶饱和并不妨碍多个调控输入。一个蛋白质可以作为多种酶的底物（例如，被两种不同的激酶磷酸化），或者可以是一种其活性受多个上游信号变构调节的酶。饱和动力学将决定这些信号如何被整合的定量性质（例如，加性、乘性、减性），但它不会使网络拓扑结构变得不可能。在单个节点上进行复杂的信号整合是蛋白质信号传导的一个标志。\n结论：**不正确**。\n\n**选项 E 分析：**\n该陈述声称，所观察到的基序谱是度分布的非适应性结果，意味着保持度的随机化会重现观察到的富集现象。\n这个论点在逻辑上是有缺陷的，并且与问题陈述本身提供的网络基序定义相矛盾。基序被定义为*相对于*一个保持度的随机化零模型是富集的。如果随机化网络已经显示出FFL的高流行率，那么根据定义，FFL将不被视为“基序”，因为它们的出现不具有统计显著性。基序分析的整个前提是寻找出现频率比随机预期（由零模型定义）更高的子图，这意味着它们的结构因特定功能而受到选择压力。\n结论：**不正确**。\n\n**选项 F 分析：**\n该陈述提出了更高级的功能：在转录网络中，非相干FFL（I1-FFL）可以实现近似的倍数变化检测（FCD），而在信号网络中，带有积分作用的负反馈可以实现精确适应。\n让我们分析第一部分。一个I1-FFL，其中 $X$ 激活 $Y$ 并且也激活 $Y$ 的一个抑制子 $Z$ ($X \\rightarrow Y$, $X \\rightarrow Z \\dashv Y$)，可以在响应 $X$ 的阶跃增加时产生一个 $Y$ 的脉冲。在特定的动力学条件下，这个脉冲的振幅可能依赖于输入 $X$ 的相对变化（倍数变化），而不是其绝对浓度。这使得系统对可能在不改变特定输入信号的情况下上下调整 $X$ 绝对水平的全局波动具有鲁棒性。这在转录背景下是一个非常有价值的功能。\n现在看第二部分。感知比率或适应背景水平的能力在信号传导中也至关重要。一个著名的实现完美适应的机制是积分反馈控制，通常通过一个涉及共价修饰循环的负反馈环来实现。细菌趋化系统就是一个典型例子。这样的系统可以被调整为对信号的倍数变化做出响应并返回到基线状态，使它们具有高度的鲁棒性。考虑到信号传导的快速动力学，实现这种精确的积分反馈比依赖于在慢速转录时间尺度上运行的I1-FFL中实现FCD所需的特定动力学调谐更有效、更直接。这为信号传导中偏好基于反馈的适应机制提供了有力的理由。\n该陈述提供了一个复杂且机理上合理的论点，补充了A和B中的推理。\n结论：**正确**。", "answer": "$$\\boxed{ABF}$$", "id": "2753875"}]}