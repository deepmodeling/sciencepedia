{"hands_on_practices": [{"introduction": "形式验证的一个核心目标是计算系统达到理想状态与陷入不良状态之间的可能性。本练习提供了一个基础但极具启发性的案例：一个由激活剂和阻遏剂竞争调控的启动子模型。通过求解这个参数化的连续时间马尔可夫链（CTMC）模型，我们不仅能计算出转录成功提交的精确概率，还能推导出一个解析表达式，它揭示了系统的成功率如何依赖于各个生化反应速率，从而为理性设计基因线路提供深刻的洞见 [@problem_id:2739288]。", "problem": "一个合成启动子由竞争性的激活子和阻遏子调控，其随机的结合、解离和承诺事件被建模为一个连续时间马尔可夫链 (Continuous-Time Markov Chain, CTMC)。该启动子可以处于五种状态之一：未结合的基态 $S_{0}$、激活子结合态 $S_{A}$、阻遏子结合态 $S_{R}$、一个吸收性的转录承诺态 $G$（目标），以及一个吸收性的阻遏承诺态 $F$（失败）。CTMC的转换参数如下，所有参数均为严格正值：\n- 从 $S_{0}$：以速率 $k_{a}$ 发生激活子结合，转换到 $S_{A}$；以速率 $k_{r}$ 发生阻遏子结合，转换到 $S_{R}$。\n- 从 $S_{A}$：以速率 $u_{a}$ 发生激活子解离，转换到 $S_{0}$；以速率 $c_{a}$ 发生转录承诺，转换到 $G$。\n- 从 $S_{R}$：以速率 $u_{r}$ 发生阻遏子解离，转换到 $S_{0}$；以速率 $c_{r}$ 发生阻遏承诺，转换到 $F$。\n- 状态 $G$ 和 $F$ 是吸收态。\n\n假设系统从 $S_{0}$ 开始。在一个CTMC中，先于 $F$ 到达 $G$ 的概率仅取决于其内嵌离散时间马尔可夫链 (Discrete-Time Markov Chain, DTMC)，该DTMC是通过对每个非吸收态的出射速率进行归一化而导出的。以此事实为基础出发点，结合马尔可夫链的定义和用于可达性的标准状态消除构造法，完成以下任务：\n1. 为瞬时状态 $\\{S_{0}, S_{A}, S_{R}\\}$ 和吸收状态 $\\{G, F\\}$ 构建内嵌DTMC，将每个转移概率表示为CTMC速率 $k_{a}, k_{r}, u_{a}, u_{r}, c_{a}, c_{r}$ 的有理函数。\n2. 在内嵌DTMC上使用状态消除法，先消除 $S_{A}$ 再消除 $S_{R}$，以获得一个在 $\\{S_{0}, G, F\\}$ 上的等效DTMC，其转移是参数的有理函数。然后，从得到的单瞬时状态DTMC中，推导出可达性概率 $\\Pr(\\lozenge G \\text{ before } F \\mid S_{0})$ 的闭式解析表达式，该表达式为 $k_{a}, k_{r}, u_{a}, u_{r}, c_{a}, c_{r}$ 的单一简化有理函数。\n\n将最终答案以单一闭式表达式的形式给出。不要求数值计算。不要包含单位。你的最终答案必须是单一表达式。", "solution": "对问题陈述进行验证。\n\n**第一步：提取已知条件**\n-   系统：一个合成启动子的连续时间马尔可夫链（CTMC）模型。\n-   状态：$S_{0}$（未结合）、$S_{A}$（激活子结合）、$S_{R}$（阻遏子结合）、$G$（目标，吸收态）、$F$（失败，吸收态）。\n-   初始状态：系统从状态 $S_{0}$ 开始。\n-   CTMC转移速率（所有参数均为严格正值）：\n    -   从 $S_{0}$：以速率 $k_{a}$ 转换到 $S_{A}$；以速率 $k_{r}$ 转换到 $S_{R}$。\n    -   从 $S_{A}$：以速率 $u_{a}$ 转换到 $S_{0}$；以速率 $c_{a}$ 转换到 $G$。\n    -   从 $S_{R}$：以速率 $u_{r}$ 转换到 $S_{0}$；以速率 $c_{r}$ 转换到 $F$。\n-   目标：推导可达性概率 $\\Pr(\\lozenge G \\text{ before } F \\mid S_{0})$ 的闭式解析表达式。\n-   方法论：\n    1.  为瞬时状态 $\\{S_{0}, S_{A}, S_{R}\\}$ 构建内嵌离散时间马尔可夫链（DTMC）。\n    2.  在DTMC上使用状态消除法，先消除 $S_{A}$，再消除 $S_{R}$，以求出概率。\n\n**第二步：使用提取的已知条件进行验证**\n根据验证标准评估问题。\n-   **科学依据**：该问题描述了一个在合成生物学和系统生物学中使用的标准随机模型。CTMC是分析生化反应网络的基本工具。该模型是启动子调控的一个有效（尽管简化）的表示。\n-   **适定性**：该问题在数学上是精确的。状态、转移、速率和初始条件都已明确定义。目标是计算一个可达性概率，这是马尔可夫链理论中的一个标准问题。唯一解的存在性得到保证。\n-   **客观性**：语言正式且无歧义。参数已通过数学方式定义。\n-   **完整性**：该问题是自包含的，提供了推导解所需的所有必要信息。不存在矛盾。\n\n**第三步：结论与行动**\n该问题有效。现在开始求解过程。\n\n该问题要求从内嵌离散时间马尔可夫链（DTMC）出发，计算一个CTMC中的可达性概率。对于一个CTMC及其内嵌DTMC，先于一个不相交状态集到达目标状态集的概率是相同的。\n\n**第一部分：构建内嵌DTMC**\n内嵌DTMC的转移概率通过对每个非吸收态的出射速率进行归一化得到。\n瞬时状态为 $\\{S_{0}, S_{A}, S_{R}\\}$，吸收状态为 $\\{G, F\\}$。\n\n从状态 $S_{0}$，总出射速率为 $\\lambda_{0} = k_{a} + k_{r}$。转移概率为：\n-   $P(S_{A} | S_{0}) = \\frac{k_{a}}{k_{a} + k_{r}}$\n-   $P(S_{R} | S_{0}) = \\frac{k_{r}}{k_{a} + k_{r}}$\n\n从状态 $S_{A}$，总出射速率为 $\\lambda_{A} = u_{a} + c_{a}$。转移概率为：\n-   $P(S_{0} | S_{A}) = \\frac{u_{a}}{u_{a} + c_{a}}$\n-   $P(G | S_{A}) = \\frac{c_{a}}{u_{a} + c_{a}}$\n\n从状态 $S_{R}$，总出射速率为 $\\lambda_{R} = u_{r} + c_{r}$。转移概率为：\n-   $P(S_{0} | S_{R}) = \\frac{u_{r}}{u_{r} + c_{r}}$\n-   $P(F | S_{R}) = \\frac{c_{r}}{u_{r} + c_{r}}$\n\n**第二部分：状态消除与概率计算**\n设 $\\pi_{i}$ 为从状态 $i$ 出发最终到达状态 $G$ 的概率。根据定义，对于吸收态，我们有 $\\pi_{G} = 1$ 和 $\\pi_{F} = 0$。对于瞬时状态，我们可以通过对第一次转移进行条件化来建立一个线性方程组：\n$$\n\\pi_{i} = \\sum_{j} P(j|i) \\pi_{j}\n$$\n这得到以下方程组：\n1.  $\\pi_{S_{0}} = P(S_{A} | S_{0}) \\pi_{S_{A}} + P(S_{R} | S_{0}) \\pi_{S_{R}} = \\left(\\frac{k_{a}}{k_{a} + k_{r}}\\right) \\pi_{S_{A}} + \\left(\\frac{k_{r}}{k_{a} + k_{r}}\\right) \\pi_{S_{R}}$\n2.  $\\pi_{S_{A}} = P(S_{0} | S_{A}) \\pi_{S_{0}} + P(G | S_{A}) \\pi_{G} = \\left(\\frac{u_{a}}{u_{a} + c_{a}}\\right) \\pi_{S_{0}} + \\left(\\frac{c_{a}}{u_{a} + c_{a}}\\right)(1)$\n3.  $\\pi_{S_{R}} = P(S_{0} | S_{R}) \\pi_{S_{0}} + P(F | S_{R}) \\pi_{F} = \\left(\\frac{u_{r}}{u_{r} + c_{r}}\\right) \\pi_{S_{0}} + \\left(\\frac{c_{r}}{u_{r} + c_{r}}\\right)(0) = \\left(\\frac{u_{r}}{u_{r} + c_{r}}\\right) \\pi_{S_{0}}$\n\n该问题要求使用状态消除程序。这等同于通过代入法求解该方程组。\n\n首先，我们将方程（2）代入方程（1）以消除 $\\pi_{S_{A}}$：\n$$\n\\pi_{S_{0}} = \\left(\\frac{k_{a}}{k_{a} + k_{r}}\\right) \\left[ \\left(\\frac{u_{a}}{u_{a} + c_{a}}\\right) \\pi_{S_{0}} + \\frac{c_{a}}{u_{a} + c_{a}} \\right] + \\left(\\frac{k_{r}}{k_{a} + k_{r}}\\right) \\pi_{S_{R}}\n$$\n$$\n\\pi_{S_{0}} = \\frac{k_{a} u_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} \\pi_{S_{0}} + \\frac{k_{a} c_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} + \\frac{k_{r}}{k_{a} + k_{r}} \\pi_{S_{R}}\n$$\n接下来，我们将方程（3）代入上述表达式以消除 $\\pi_{S_{R}}$：\n$$\n\\pi_{S_{0}} = \\frac{k_{a} u_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} \\pi_{S_{0}} + \\frac{k_{a} c_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} + \\frac{k_{r}}{k_{a} + k_{r}} \\left[ \\left(\\frac{u_{r}}{u_{r} + c_{r}}\\right) \\pi_{S_{0}} \\right]\n$$\n这就得到了一个关于 $\\pi_{S_{0}}$ 的单一方程，它代表了所要求的在 $\\{S_{0}, G, F\\}$ 上的等效DTMC。\n$$\n\\pi_{S_{0}} = \\left( \\frac{k_{a} u_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} + \\frac{k_{r} u_{r}}{(k_{a} + k_{r})(u_{r} + c_{r})} \\right) \\pi_{S_{0}} + \\frac{k_{a} c_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})}\n$$\n现在，我们求解 $\\pi_{S_{0}}$：\n$$\n\\pi_{S_{0}} \\left[ 1 - \\frac{k_{a} u_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} - \\frac{k_{r} u_{r}}{(k_{a} + k_{r})(u_{r} + c_{r})} \\right] = \\frac{k_{a} c_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})}\n$$\n让我们简化括号中的项：\n$$\n1 - \\frac{k_{a} u_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} - \\frac{k_{r} u_{r}}{(k_{a} + k_{r})(u_{r} + c_{r})} = \\frac{(k_{a} + k_{r})(u_{a} + c_{a})(u_{r} + c_{r}) - k_{a} u_{a}(u_{r} + c_{r}) - k_{r} u_{r}(u_{a} + c_{a})}{(k_{a} + k_{r})(u_{a} + c_{a})(u_{r} + c_{r})}\n$$\n展开分子：\n$$\n(k_{a} + k_{r})(u_{a} + c_{a}) = k_{a}u_{a} + k_{a}c_{a} + k_{r}u_{a} + k_{r}c_{a}\n$$\n$$\n(k_{a}u_{a} + k_{a}c_{a} + k_{r}u_{a} + k_{r}c_{a})(u_{r} + c_{r}) = k_{a}u_{a}u_{r} + k_{a}u_{a}c_{r} + k_{a}c_{a}u_{r} + k_{a}c_{a}c_{r} + k_{r}u_{a}u_{r} + k_{r}u_{a}c_{r} + k_{r}c_{a}u_{r} + k_{r}c_{a}c_{r}\n$$\n减去其他项 $k_{a} u_{a}(u_{r} + c_{r}) = k_{a}u_{a}u_{r} + k_{a}u_{a}c_{r}$ 和 $k_{r} u_{r}(u_{a} + c_{a}) = k_{r}u_{a}u_{r} + k_{r}c_{a}u_{r}$：\n$$\n\\text{Numerator} = (k_{a}u_{a}u_{r} + k_{a}u_{a}c_{r} + k_{a}c_{a}u_{r} + k_{a}c_{a}c_{r} + k_{r}u_{a}u_{r} + k_{r}u_{a}c_{r} + k_{r}c_{a}u_{r} + k_{r}c_{a}c_{r}) - (k_{a}u_{a}u_{r} + k_{a}u_{a}c_{r}) - (k_{r}u_{a}u_{r} + k_{r}c_{a}u_{r})\n$$\n$k_{a}u_{a}u_{r}$、$k_{a}u_{a}c_{r}$、$k_{r}u_{a}u_{r}$ 和 $k_{r}c_{a}u_{r}$ 这些项相互抵消。简化后的分子是：\n$$\nk_{a}c_{a}u_{r} + k_{a}c_{a}c_{r} + k_{r}u_{a}c_{r} + k_{r}c_{a}c_{r}\n$$\n这可以因式分解为：\n$$\nk_{a}c_{a}(u_{r} + c_{r}) + k_{r}c_{r}(u_{a} + c_{a})\n$$\n将此代回关于 $\\pi_{S_{0}}$ 的方程：\n$$\n\\pi_{S_{0}} \\left[ \\frac{k_{a}c_{a}(u_{r} + c_{r}) + k_{r}c_{r}(u_{a} + c_{a})}{(k_{a} + k_{r})(u_{a} + c_{a})(u_{r} + c_{r})} \\right] = \\frac{k_{a} c_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})}\n$$\n求解 $\\pi_{S_{0}}$：\n$$\n\\pi_{S_{0}} = \\frac{k_{a} c_{a}}{(k_{a} + k_{r})(u_{a} + c_{a})} \\cdot \\frac{(k_{a} + k_{r})(u_{a} + c_{a})(u_{r} + c_{r})}{k_{a}c_{a}(u_{r} + c_{r}) + k_{r}c_{r}(u_{a} + c_{a})}\n$$\n$(k_{a} + k_{r})(u_{a} + c_{a})$ 项从分子和分母中约去：\n$$\n\\pi_{S_{0}} = \\frac{k_{a} c_{a} (u_{r} + c_{r})}{k_{a}c_{a}(u_{r} + c_{r}) + k_{r}c_{r}(u_{a} + c_{a})}\n$$\n这就是可达性概率 $\\Pr(\\lozenge G \\text{ before } F \\mid S_{0})$ 的最终闭式表达式。根据要求，它是给定CTMC速率参数的简单有理函数。", "answer": "$$\n\\boxed{\\frac{k_{a} c_{a} (u_{r} + c_{r})}{k_{a} c_{a} (u_{r} + c_{r}) + k_{r} c_{r} (u_{a} + c_{a})}}\n$$", "id": "2739288"}, {"introduction": "在掌握了如何分析简单的可达性问题之后，下一步是学习如何表达和验证更复杂的定量性能指标。要有效利用PRISM或Storm等强大的概率模型检验工具，我们必须首先掌握它们的规范语言。本练习聚焦于一项关键的实践技能：将一个关于系统性能的自然语言需求（例如，“在时间$T$内，mRNA的预期总产量至多为$M$”）精确地翻译成带奖励的连续随机逻辑（CSL）的形式化规约 [@problem_id:2739299]。", "problem": "一个单基因的遗传电路被建模为连续时间马尔可夫链 (CTMC)。CTMC 的状态 $s \\in S$ 记录了启动子状态和离散的分子数量，包括信使 RNA (mRNA)。其生成元矩阵为 $Q = (q(s,s'))_{s,s' \\in S}$，其中的转移对应于化学主方程语义下的随机反应事件。具体来说，转录被建模为一个反应 $R_1$，当它发生时，mRNA 数量增加 1，并且在状态 $s$ 下具有倾向性（风险率）$a_1(s)$。降解会减少 mRNA 的数量，但不影响曾经产生过的 mRNA 分子总数。令 $N_1(t)$ 表示到时间 $t$ 为止反应 $R_1$ 的发生次数。\n\nCTMC 的奖励结构包括一个状态奖励 $r: S \\to \\mathbb{R}_{\\ge 0}$ 和一个脉冲（转移）奖励 $\\iota: S \\times S \\to \\mathbb{R}_{\\ge 0}$。对于一个样本路径 $\\omega$，到时间 $T$ 为止的累积奖励为\n$$\n\\mathcal{C}_T(\\omega) \\;=\\; \\int_0^T r\\!\\left(X(t,\\omega)\\right)\\, dt \\;+\\; \\sum_{0 < t \\le T} \\iota\\!\\left(X(t^- ,\\omega), X(t,\\omega)\\right),\n$$\n其期望值为 $\\mathbb{E}[\\mathcal{C}_T]$。\n\n您感兴趣的是，使用带奖励的连续随机逻辑 (CSL) 来验证此遗传电路的 CTMC 模型的以下需求：“到时间 $T$ 为止产生的 mRNA 分子总数的期望值至多为 $M$。”“产生的总数”这一短语指的是到时间 $T$ 为止转录事件的累积次数（即 $N_1(T)$），而不是在时间 $T$ 时存在的 mRNA 分子数，也不是任何时间平均的占据量。\n\n哪个选项正确定义了一个奖励结构和一个 CSL 奖励属性来捕捉这一需求？\n\nA. 定义脉冲奖励 $\\iota(s,s') = 1$（如果转移 $(s \\to s')$ 是转录反应 $R_1$ 的一次发生）和 $\\iota(s,s') = 0$（其他情况），并且对所有 $s$ 都有 $r(s)=0$。检查 CSL 奖励属性 $R\\{\\text{mRNA\\_prod}\\} \\le M \\,[\\, C \\le T \\,]$。\n\nB. 定义状态奖励 $r(s) = a_1(s)$（转录倾向性）且 $\\iota \\equiv 0$。检查 CSL 奖励属性 $R\\{\\text{mRNA\\_rate}\\} \\le M \\,[\\, C \\le T \\,]$。\n\nC. 定义脉冲奖励 $\\iota(s,s') = 1$（对于转录转移）和 $0$（其他情况），且 $r \\equiv 0$。检查 CSL 奖励属性 $R\\{\\text{mRNA\\_prod}\\} \\le M \\,[\\, I = T \\,]$。\n\nD. 定义状态奖励 $r(s)$ 等于状态 $s$ 中的当前 mRNA 数量，且 $\\iota \\equiv 0$。检查 CSL 奖励属性 $R\\{\\text{mRNA\\_count}\\} \\le M \\,[\\, C \\le T \\,]$。\n\nE. 在不定义奖励的情况下，检查 CTMC 的概率属性 $P_{\\le M}\\big[\\, F^{\\le T}\\, (N_1 \\ge M) \\,\\big]$，其中 $F^{\\le T}$ 表示“最终在时间 $T$ 内”。", "solution": "在尝试解决方案之前，将对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n-   **模型**：连续时间马尔可夫链 (CTMC)\n-   **状态空间**：$S$，其中每个状态 $s \\in S$ 记录启动子状态和离散分子数量，包括 mRNA。\n-   **生成元矩阵**：$Q = (q(s,s'))_{s,s' \\in S}$\n-   **语义**：化学主方程。\n-   **转录反应 ($R_1$)**：一个使 mRNA 数量增加 1 的事件。\n-   **转录倾向性**：$a_1(s)$ 是反应 $R_1$ 在状态 $s$ 下的风险率（速率）。\n-   **降解反应**：减少 mRNA 数量；不影响曾经产生过的 mRNA 分子总数。\n-   **累积生产数量**：$N_1(t)$ 是到时间 $t$ 为止反应 $R_1$ 的发生次数。\n-   **奖励结构**：包括一个状态奖励 $r: S \\to \\mathbb{R}_{\\ge 0}$ 和一个脉冲奖励 $\\iota: S \\times S \\to \\mathbb{R}_{\\ge 0}$。\n-   **累积奖励公式**：对于样本路径 $\\omega$，$\\mathcal{C}_T(\\omega) = \\int_0^T r(X(t,\\omega))\\, dt + \\sum_{0 < t \\le T} \\iota(X(t^- ,\\omega), X(t,\\omega))$。\n-   **期望累积奖励**：$\\mathbb{E}[\\mathcal{C}_T]$。\n-   **待验证需求**：“到时间 $T$ 为止产生的 mRNA 分子总数的期望值至多为 $M$。”这被明确定义为验证 $\\mathbb{E}[N_1(T)] \\le M$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题描述了随机生物系统形式化验证中的一个标准场景。在概率模型检测和系统生物学中，使用基于化学主方程的 CTMC 模型、倾向性函数和奖励结构进行分析是一种成熟且科学合理的方法。连续随机逻辑 (CSL) 的术语使用正确。该问题是自包含的，提供了所有必要的定义。目标清晰明确：将用自然语言表达的需求转换为一个具有适当定义的奖励结构的形式化 CSL 属性。该问题是适定的、客观的。它没有违反任何有效性标准。\n\n### 步骤 3：结论与行动\n问题陈述有效。将推导解决方案。\n\n该问题要求使用奖励结构和 CSL 查询来形式化陈述 $\\mathbb{E}[N_1(T)] \\le M$。我们感兴趣的量是 $N_1(T)$ 的期望值，即到时间 $T$ 为止转录反应 ($R_1$) 的总发生次数。目标是定义一个奖励结构 $(r, \\iota)$，使得期望累积奖励 $\\mathbb{E}[\\mathcal{C}_T]$ 等于 $\\mathbb{E}[N_1(T)]$。\n\n期望累积奖励由下式给出：\n$$\n\\mathbb{E}[\\mathcal{C}_T] = \\mathbb{E}\\left[ \\int_0^T r(X(t))\\, dt \\right] + \\mathbb{E}\\left[ \\sum_{0 < t \\le T} \\iota(X(t^-), X(t)) \\right]\n$$\n在此框架中，有两种标准的、正确的方法来计算反应事件的期望数量。\n\n**方法 1：通过脉冲奖励直接计数**\n计数事件最直接的方法是使用脉冲奖励。项 $\\sum_{0 < t \\le T} \\iota(X(t^-), X(t))$ 对路径上每次离散转移（反应发生）的奖励进行求和。如果我们希望这个和等于 $N_1(T)$，我们必须为反应 $R_1$ 的每次发生分配 1 的奖励，并为所有其他事件分配 0 的奖励。\n这意味着以下脉冲奖励定义：\n$$\n\\iota(s, s') = \\begin{cases} 1 & \\text{如果转移 } s \\to s' \\text{ 是 } R_1 \\text{ 的一次发生} \\\\ 0 & \\text{其他情况} \\end{cases}\n$$\n为确保总累积奖励仅反映此计数，状态奖励的积分必须为零。这通过将所有状态 $s \\in S$ 的状态奖励函数设置为 $r(s) = 0$ 来实现。\n有了这种结构，$\\mathcal{C}_T = N_1(T)$，因此 $\\mathbb{E}[\\mathcal{C}_T] = \\mathbb{E}[N_1(T)]$。然后，CSL 查询必须检查在时间区间 $[0, T]$ 内的这个期望累积奖励是否至多为 $M$。用于有限时间范围内累积属性的 CSL 路径算子是 $C \\le T$。因此，CSL 属性为 $R\\{\\text{label}\\} \\le M \\,[\\, C \\le T \\,]$。\n\n**方法 2：通过状态奖励对速率进行积分**\n一个关于与 CTMC 相关的计数过程的基本定理指出，事件的期望数量是期望事件速率的积分。反应 $R_1$ 在状态 $s$ 的瞬时速率是其倾向性 $a_1(s)$。因此，到时间 $T$ 为止 $R_1$ 发生的期望次数为：\n$$\n\\mathbb{E}[N_1(T)] = \\int_0^T \\mathbb{E}[a_1(X(t))] dt\n$$\n根据期望的线性性质（或 Fubini 定理），这可以改写为：\n$$\n\\mathbb{E}[N_1(T)] = \\mathbb{E}\\left[ \\int_0^T a_1(X(t)) dt \\right]\n$$\n右侧对应于一个奖励结构的期望累积奖励 $\\mathbb{E}[\\mathcal{C}_T]$，其中状态奖励为 $r(s) = a_1(s)$，并且对于所有转移，脉冲奖励 $\\iota(s, s')$ 恒为零。这为计算 $\\mathbb{E}[N_1(T)]$ 提供了另一种同样正确的方法。查询的 CSL 部分保持不变：$R\\{\\text{label}\\} \\le M \\,[\\, C \\le T \\,]$。\n\n在确定了这两种有效方法后，我们分析给定的选项。\n\n**逐项分析**\n\n**A. 定义脉冲奖励 $\\iota(s,s') = 1$（如果转移 $(s \\to s')$ 是转录反应 $R_1$ 的一次发生）和 $\\iota(s,s') = 0$（其他情况），并且对所有 $s$ 都有 $r(s)=0$。检查 CSL 奖励属性 $R\\{\\text{mRNA\\_prod}\\} \\le M \\,[\\, C \\le T \\,]$。**\n该选项与方法 1 中的推导完全匹配。它使用脉冲奖励直接对转录事件进行计数。状态奖励被设置为 0 以避免混淆计数。CSL 属性使用了正确的算子 $R$（用于期望）和正确的路径公式 $C \\le T$（用于有限时间范围内的累积奖励）。标签 `mRNA_prod` 只是为这个奖励结构命名。这是一个正确的形式化。\n结论：**正确**。\n\n**B. 定义状态奖励 $r(s) = a_1(s)$（转录倾向性）且 $\\iota \\equiv 0$。检查 CSL 奖励属性 $R\\{\\text{mRNA\\_rate}\\} \\le M \\,[\\, C \\le T \\,]$。**\n该选项与方法 2 中的推导完全匹配。它正确地利用了数学性质，即事件的期望数量是期望倾向性的时间积分。奖励结构设置了 $r(s) = a_1(s)$ 和 $\\iota \\equiv 0$。CSL 属性的表述也是正确的。这是对同一需求的一个有效的、尽管可能不那么直接的形式化。\n结论：**正确**。\n\n**C. 定义脉冲奖励 $\\iota(s,s') = 1$（对于转录转移）和 $0$（其他情况），且 $r \\equiv 0$。检查 CSL 奖励属性 $R\\{\\text{mRNA\\_prod}\\} \\le M \\,[\\, I = T \\,]$。**\n这个选项使用了方法 1 中正确的奖励结构。然而，CSL 路径公式是 $I = T$。该公式涉及在特定时间点 $T$ 的期望奖励，而不是在区间 $[0, T]$ 上的累积奖励。需求关注的是“到时间 $T$ 为止产生的总数”，这是一个累积量。因此，使用 $I=T$ 是一个语义错误。\n结论：**不正确**。\n\n**D. 定义状态奖励 $r(s)$ 等于状态 $s$ 中的当前 mRNA 数量，且 $\\iota \\equiv 0$。检查 CSL 奖励属性 $R\\{\\text{mRNA\\_count}\\} \\le M \\,[\\, C \\le T \\,]$。**\n这个选项计算了期望累积奖励 $\\mathbb{E}[\\int_0^T m(X(t)) dt]$，其中 $m(s)$ 是状态 $s$ 中的 mRNA 数量。这个量是期望的时间积分 mRNA 种群大小。问题陈述明确要求的是生产事件的累积次数 $N_1(T)$，并将其与“在时间 $T$ 时存在的 mRNA 分子数”和“时间平均的占据量”进行了对比，而后者正是此选项所计算的。它未能区分生产和降解。\n结论：**不正确**。\n\n**E. 在不定义奖励的情况下，检查 CTMC 的概率属性 $P_{\\le M}\\big[\\, F^{\\le T}\\, (N_1 \\ge M) \\,\\big]$，其中 $F^{\\le T}$ 表示“最终在时间 $T$ 内”。**\n这个选项因多种原因而无效。首先，需求是关于一个*期望值*，这由 CSL 算子 $R$ 处理，而不是概率算子 $P$。其次，语法 $P_{\\le M}[\\ldots]$ 是格式错误的；概率算子的界限必须是 $[0, 1]$ 中的一个值，但 $M$ 是一个分子数。第三，公式 $(N_1 \\ge M)$ 不是一个有效的状态属性，因为根据问题定义，累积计数 $N_1(t)$ 并不属于状态向量 $s \\in S$ 的一部分。该选项在语法和语义上与需求不一致。\n结论：**不正确**。\n\n选项 A 和 B 都为所需属性提供了有效且数学上合理的的形式化。", "answer": "$$\\boxed{AB}$$", "id": "2739299"}, {"introduction": "对于许多大规模或非线性的复杂生物系统，精确的解析或数值分析往往是不可行的。在这种情况下，统计模型检验（Statistical Model Checking, SMC）提供了一种可扩展且极为实用的替代方案。本练习将指导您应用统计学中经典的序贯概率比检验（Sequential Probability Ratio Test, SPRT）来验证系统属性，这正是SMC的核心算法之一。通过本练习，您将学习如何基于有限次数的计算机模拟，在控制错误率的前提下，对系统的行为做出具有统计学意义的可靠判断 [@problem_id:2739310]。", "problem": "考虑一个由两个阻遏蛋白控制的双稳态基因拨动开关的随机化学主方程模型。在概率模型检验中，您希望验证时间属性 $\\phi$：“在时间 $T$ 之前，报告蛋白处于开启状态”，这意味着报告蛋白的拷贝数在时间 $T$ 或之前超过一个预设的阈值。一个统计上可靠的验证框架会模拟独立的轨迹，并记录指示变量 $X_i \\in \\{0,1\\}$，以表示属性 $\\phi$ 在轨迹 $i$ 上是否成立。在平稳性和跨次运行独立采样的条件下，$X_i$ 是独立同分布的伯努利随机变量，其成功概率为 $\\theta = \\Pr(\\phi)$。\n\n您的目标是在给定的 $p \\in (0,1)$ 和 $\\delta \\in (0,p)$ 的情况下，使用贯序概率比检验 (SPRT) 在假设 $H_0: \\theta \\ge p$ 和 $H_1: \\theta \\le p - \\delta$ 之间做出决策，其中定义检验的两个“简单”假设被固定在边界值上：$H_0$ 为 $p_0 = p$，$H_1$ 为 $p_1 = p - \\delta$。该检验必须满足 I 型错误界限 $\\alpha$ 和 II 型错误界限 $\\beta$，这意味着在 $H_0$ 成立的情况下错误地拒绝 $H_0$ 的概率最多为 $\\alpha$，而在 $H_1$ 成立的情况下错误地接受 $H_0$ 的概率最多为 $\\beta$。\n\n从第一性原理（伯努利似然、独立性以及似然比的定义）出发，推导用于此验证任务的 SPRT 决策统计量和停止法则。然后，推导保证错误界限的似然比阈值的闭式解，该解完全用 $\\alpha$ 和 $\\beta$ 表示。\n\n最后，对具体的设计参数 $\\alpha = 0.01$ 和 $\\beta = 0.05$ 计算自然对数阈值。将您的数值结果四舍五入到四位有效数字，并以行矩阵的形式报告数对 $\\big(\\ln A, \\ln B\\big)$。最终答案不需要物理单位。", "solution": "该问题陈述清晰且具有科学依据。它涉及将统计决策理论中的标准方法——贯序概率比检验 (SPRT) 应用于合成生物学中随机模型的验证。所有必需的信息均已提供。我们将开始推导。\n\n该问题要求我们分析一个关于伯努利试验成功概率 $\\theta$ 的假设检验。随机基因回路单次轨迹的模拟被视为一次试验。其结果由一个随机变量 $X_i$ 表示，如果属性 $\\phi$ 成立（一次“成功”），则 $X_i=1$，否则（一次“失败”）$X_i=0$。这些试验是独立同分布的，因此 $X_i \\sim \\text{Bernoulli}(\\theta)$，其中 $\\theta = \\Pr(X_i=1)$。\n\n待检验的假设是复合假设：\n$H_0: \\theta \\ge p$\n$H_1: \\theta \\le p - \\delta$\n\nSPRT 框架通过考虑边界情况将这些复合假设简化为两个简单假设：一个原假设 $H'_0: \\theta = p_0$ 对一个备择假设 $H'_1: \\theta = p_1$。问题将它们指定为 $p_0 = p$ 和 $p_1 = p - \\delta$。\n\n设来自 $n$ 次独立模拟的结果序列为 $x_1, x_2, \\ldots, x_n$。在真实参数为 $\\theta^*$ 的假设下，观测到这个特定序列的似然由下式给出：\n$$ L(\\theta^*) = \\prod_{i=1}^{n} P(X_i=x_i | \\theta=\\theta^*) = \\prod_{i=1}^{n} (\\theta^*)^{x_i} (1-\\theta^*)^{1-x_i} $$\n令 $S_n = \\sum_{i=1}^{n} x_i$ 为 $n$ 次试验后的成功次数。似然函数可以更紧凑地写为：\n$$ L(\\theta^*) = (\\theta^*)^{S_n} (1-\\theta^*)^{n-S_n} $$\n\nSPRT 的核心是似然比 $\\Lambda_n$，其定义为备择假设 ($H'_1$)下的似然与原假设($H'_0$)下的似然之比：\n$$ \\Lambda_n = \\frac{L(p_1)}{L(p_0)} = \\frac{p_1^{S_n} (1-p_1)^{n-S_n}}{p_0^{S_n} (1-p_0)^{n-S_n}} $$\n这可以重新整理为：\n$$ \\Lambda_n = \\left(\\frac{p_1}{p_0}\\right)^{S_n} \\left(\\frac{1-p_1}{1-p_0}\\right)^{n-S_n} $$\n此表达式即为 SPRT 的决策统计量。\n\n停止法则由两个阈值 $A$ 和 $B$ 定义，这两个阈值由期望的错误概率决定。标准约定是 $0 < B < 1 < A$。在每次观测 $X_n$ 之后，计算似然比 $\\Lambda_n$ 并与阈值进行比较：\n1. 如果 $\\Lambda_n \\ge A$，检验停止，拒绝 $H'_0$ 而采纳 $H'_1$。在原始复合假设的背景下，我们接受 $H_1$。\n2. 如果 $\\Lambda_n \\le B$，检验停止，接受 $H'_0$。在原始复合假设的背景下，我们接受 $H_0$。\n3. 如果 $B < \\Lambda_n < A$，证据不足以做出决策，并进行下一次观测 $X_{n+1}$。\n\n在计算上，处理似然比的自然对数通常更方便，因为它将乘积转换为求和。对数似然比 $Z_n = \\ln(\\Lambda_n)$ 为：\n$$ Z_n = S_n \\ln\\left(\\frac{p_1}{p_0}\\right) + (n-S_n) \\ln\\left(\\frac{1-p_1}{1-p_0}\\right) $$\n用 $Z_n$ 表示的停止法则变为：\n1. 如果 $Z_n \\ge \\ln A$，停止并接受 $H_1$。\n2. 如果 $Z_n \\le \\ln B$，停止并接受 $H_0$。\n3. 如果 $\\ln B < Z_n < \\ln A$，继续抽样。\n\n接下来，我们根据指定的 I 型错误界限 $\\alpha$ 和 II 型错误界限 $\\beta$ 来推导阈值 $A$ 和 $B$ 的表达式。\n- 当 $H_0$ 为真时拒绝 $H_0$，则发生 I 型错误。此事件的概率最多为 $\\alpha$。在 SPRT 的背景下，这是 $\\Pr(\\text{拒绝 } H'_0 | \\theta=p_0) = \\Pr(\\Lambda_N \\ge A | \\theta=p_0)$，其中 $N$ 是检验的随机停止时间。\n- 当 $H_1$ 为真时接受 $H_0$，则发生 II 型错误。此事件的概率最多为 $\\beta$。在 SPRT 的背景下，这是 $\\Pr(\\text{接受 } H'_0 | \\theta=p_1) = \\Pr(\\Lambda_N \\le B | \\theta=p_1)$。\n\n阈值的推导由 Abraham Wald 首创，它使用了一个近似，忽略了统计量 $\\Lambda_N$ 对边界的“过冲”。也就是说，在做出决策的时刻，我们近似认为拒绝时 $\\Lambda_N \\approx A$，接受时 $\\Lambda_N \\approx B$。\n\n令 $\\mathcal{R}$ 为所有检验停止并拒绝 $H_0$（即 $\\Lambda_N \\ge A$）的样本路径集合。那么 I 型错误的概率为 $\\alpha \\approx \\sum_{\\text{路径} \\in \\mathcal{R}} P(\\text{路径}|p_0)$。当 $H_1$ 为真时正确拒绝 $H_0$ 的概率是 $1-\\beta \\approx \\sum_{\\text{路径} \\in \\mathcal{R}} P(\\text{路径}|p_1)$。\n对于 $\\mathcal{R}$ 中的任意路径，我们有 $\\Lambda_N = \\frac{P(\\text{路径}|p_1)}{P(\\text{路径}|p_0)} \\approx A$。因此，$P(\\text{路径}|p_1) \\approx A \\cdot P(\\text{路径}|p_0)$。\n对 $\\mathcal{R}$ 中的所有路径求和：\n$$ \\sum_{\\text{路径} \\in \\mathcal{R}} P(\\text{路径}|p_1) \\approx A \\sum_{\\text{路径} \\in \\mathcal{R}} P(\\text{路径}|p_0) $$\n$$ 1-\\beta \\approx A \\cdot \\alpha $$\n这给出了上阈值的近似：$A \\approx \\frac{1-\\beta}{\\alpha}$。\n\n类似地，令 $\\mathcal{A}$ 为所有检验停止并接受 $H_0$（即 $\\Lambda_N \\le B$）的样本路径集合。II 型错误的概率为 $\\beta \\approx \\sum_{\\text{路径} \\in \\mathcal{A}} P(\\text{路径}|p_1)$。正确接受 $H_0$ 的概率是 $1-\\alpha \\approx \\sum_{\\text{路径} \\in \\mathcal{A}} P(\\text{路径}|p_0)$。\n对于 $\\mathcal{A}$ 中的任意路径，我们有 $\\Lambda_N = \\frac{P(\\text{路径}|p_1)}{P(\\text{路径}|p_0)} \\approx B$。因此，$P(\\text{路径}|p_1) \\approx B \\cdot P(\\text{路径}|p_0)$。\n对 $\\mathcal{A}$ 中的所有路径求和：\n$$ \\sum_{\\text{路径} \\in \\mathcal{A}} P(\\text{路径}|p_1) \\approx B \\sum_{\\text{路径} \\in \\mathcal{A}} P(\\text{路径}|p_0) $$\n$$ \\beta \\approx B \\cdot (1-\\alpha) $$\n这给出了下阈值的近似：$B \\approx \\frac{\\beta}{1-\\alpha}$。\n\n为保证实际错误概率 $\\alpha'$ 和 $\\beta'$ 满足 $\\alpha' \\le \\alpha$ 和 $\\beta' \\le \\beta$，这些近似被视为等式并用于设定阈值。因此，阈值的闭式表达式为：\n$$ A = \\frac{1-\\beta}{\\alpha} \\quad \\text{和} \\quad B = \\frac{\\beta}{1-\\alpha} $$\n\n最后，我们对具体的设计参数 $\\alpha = 0.01$ 和 $\\beta = 0.05$ 计算自然对数阈值。\n上对数阈值为：\n$$ \\ln A = \\ln\\left(\\frac{1-\\beta}{\\alpha}\\right) = \\ln\\left(\\frac{1 - 0.05}{0.01}\\right) = \\ln\\left(\\frac{0.95}{0.01}\\right) = \\ln(95) $$\n$$ \\ln(95) \\approx 4.55387689 $$\n四舍五入到四位有效数字，我们得到 $\\ln A \\approx 4.554$。\n\n下对数阈值为：\n$$ \\ln B = \\ln\\left(\\frac{\\beta}{1-\\alpha}\\right) = \\ln\\left(\\frac{0.05}{1 - 0.01}\\right) = \\ln\\left(\\frac{0.05}{0.99}\\right) $$\n$$ \\ln\\left(\\frac{0.05}{0.99}\\right) \\approx \\ln(0.050505...) \\approx -2.98567735 $$\n四舍五入到四位有效数字，我们得到 $\\ln B \\approx -2.986$。\n\n这对自然对数阈值为 $(\\ln A, \\ln B) = (4.554, -2.986)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 4.554 & -2.986 \\end{pmatrix}}\n$$", "id": "2739310"}]}