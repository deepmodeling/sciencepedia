{"hands_on_practices": [{"introduction": "在定量生物学中，分析单细胞数据的统计矩（如均值 $\\langle X \\rangle$ 和方差 $\\mathrm{Var}(X)$）是理解细胞异质性的基石。这个练习将指导你如何使用这些基本的统计量来区分基因表达中的主要噪音来源。通过计算一个简单的指标——变异系数的平方（$\\mathrm{CV}^2$），并将其与理论预期进行比较，你将学会从实验数据中洞察转录爆发等关键生物学现象，这是解读实验结果的一项基本技能。[@problem_id:2759682]", "problem": "在一个从组成型启动子表达荧光报告基因的工程细胞克隆群体中，通过校准过的显微镜检查在稳态下对单细胞蛋白质拷贝数进行量化。测得的群体均值和方差分别为 $\\langle X \\rangle = 100$ 和 $\\mathrm{Var}(X) = 5000$。使用变异系数（CV）的定义，即 $\\mathrm{CV} \\equiv \\sqrt{\\mathrm{Var}(X)}/\\langle X \\rangle$，根据这些测量值计算变异系数的平方 $\\mathrm{CV}^{2}$。\n\n然后，根据分子生物学中心法则中随机基因表达的第一性原理（转录和翻译作为随机生灭过程），判断以下哪项更有可能是观察到的蛋白质拷贝数异质性的主要贡献者：转录爆发或翻译散粒噪声。你可以使用以下广为接受的事实作为基本出发点：对于泊松生灭过程，方差等于均值；而方差显著超过均值的过度离散计数是爆发式产生的标志。\n\n请提供 $\\mathrm{CV}^{2}$ 的精确值，该值是一个无单位的无量纲数，无需四舍五入。在给出数值之后，请用文字定性地证明你的选择（你的证明将与数值答案分开评估）。", "solution": "该问题要求根据提供的实验数据计算变异系数的平方 $\\mathrm{CV}^{2}$，并随后进行合理论证，以确定蛋白质表达中噪声的主要来源。\n\n首先，必须验证问题的有效性。\n已知条件如下：\n- 一个带有报告基因的克隆细胞群体。\n- 稳态下的单细胞蛋白质拷贝数是一个随机变量 $X$。\n- 测得的蛋白质拷贝数群体均值为 $\\langle X \\rangle = 100$。\n- 测得的蛋白质拷贝数群体方差为 $\\mathrm{Var}(X) = 5000$。\n- 变异系数的定义是 $\\mathrm{CV} \\equiv \\frac{\\sqrt{\\mathrm{Var}(X)}}{\\langle X \\rangle}$。\n- 基本原理：对于泊松生灭过程，方差等于均值。过度离散（方差显著超过均值）是爆发式产生的标志。\n\n该问题具有科学依据，提法恰当，客观且内部一致。它描述了定量生物学中的一个标准问题，并使用了符合实际的参数。解决问题所需的所有信息均已提供。该问题是有效的。\n\n我们开始解答。\n\n第1部分：计算 $\\mathrm{CV}^{2}$。\n变异系数定义为 $\\mathrm{CV} = \\frac{\\sqrt{\\mathrm{Var}(X)}}{\\langle X \\rangle}$。\n将此表达式平方，得到变异系数平方的公式：\n$$\n\\mathrm{CV}^{2} = \\left( \\frac{\\sqrt{\\mathrm{Var}(X)}}{\\langle X \\rangle} \\right)^2 = \\frac{\\mathrm{Var}(X)}{\\langle X \\rangle^2}\n$$\n我们已知均值和方差的实验值：\n$$\n\\langle X \\rangle = 100\n$$\n$$\n\\mathrm{Var}(X) = 5000\n$$\n将这些值代入 $\\mathrm{CV}^{2}$ 的表达式中：\n$$\n\\mathrm{CV}^{2} = \\frac{5000}{(100)^2} = \\frac{5000}{10000} = \\frac{1}{2} = 0.5\n$$\n变异系数的平方是一个无量纲量。\n\n第2部分：确定主要噪声来源。\n中心法则将基因表达描述为一个两阶段过程：转录（DNA到mRNA）和翻译（mRNA到蛋白质）。这两个步骤本质上都是随机的，导致了细胞间蛋白质数量 $X$ 的变异性。我们必须确定是转录噪声还是翻译噪声占主导地位。\n\n让我们考虑提出的两种可能性：\n假设A：主要噪声来源是“翻译散粒噪声”。这个术语描述了单个蛋白质分子合成和降解过程中固有的随机性。如果mRNA模板浓度稳定且无波动，蛋白质合成将是一个简单的生灭过程。根据给定的基本原理，这样一个过程（如果是泊松过程）会产生一个蛋白质分布，其方差等于均值。\n$$\n\\mathrm{Var}(X) = \\langle X \\rangle\n$$\n这对应于法诺因子（定义为 $F \\equiv \\frac{\\mathrm{Var}(X)}{\\langle X \\rangle}$）等于 $1$。\n\n假设B：主要噪声来源是“转录爆发”。这意味着转录过程本身是高度间歇性的。基因启动子在产生大量mRNA分子的“开启”状态和“关闭”状态之间随机切换。这导致mRNA拷贝数出现大的、零星的波动。mRNA模板的这些上游波动在翻译过程中被传递和放大，从而导致蛋白质分布“过度离散”——即其方差远大于其均值。\n$$\n\\mathrm{Var}(X) \\gg \\langle X \\rangle\n$$\n这对应于法诺因子 $F \\gg 1$。\n\n现在，我们根据实验数据评估这些假设。测得的均值为 $\\langle X \\rangle = 100$，方差为 $\\mathrm{Var}(X) = 5000$。\n让我们计算观测到的蛋白质分布的法诺因子：\n$$\nF = \\frac{\\mathrm{Var}(X)}{\\langle X \\rangle} = \\frac{5000}{100} = 50\n$$\n我们的结果是 $F = 50$。这个值远大于 $1$。方差是均值的 $50$ 倍。\n\n将这个结果与我们的假设进行比较：\n- 假设A预测 $F=1$。数据显示 $F=50$。这是一个严重的差异。因此，数据强烈反驳了来自稳定mRNA池的翻译散粒噪声是异质性主要贡献者的假设。\n- 假设B预测 $F \\gg 1$。数据显示 $F=50$，这与该预测一致。观察到 $\\mathrm{Var}(X)$ 远超过 $\\langle X \\rangle$ 是爆发式基因表达的典型标志，其中噪声的主要来源是mRNA的随机产生。\n\n结论：观察到的相对于均值的巨大方差与简单的蛋白质生产泊松模型不相容。然而，它是一个爆发式生产机制的直接标志。大的波动必定起源于翻译的上游。因此，转录爆发是观察到的表型异质性更可能的主要贡献者。", "answer": "$$\n\\boxed{0.5}\n$$", "id": "2759682"}, {"introduction": "在我们从概念上识别了噪音来源之后，下一步是建立一个数学模型来精确描述它。这个练习引导你从第一性原理出发，推导在稳态下，蛋白质生产的随机事件和细胞分裂时的随机分配如何共同构成蛋白质数量的总方差。这种理论推导为你先前练习中形成的直觉提供了严谨的数学基础，并加深了对异质性成分的理解。[@problem_id:2759671]", "problem": "在一个细菌合成回路中，一个组成性基因表达一种稳定的蛋白质，其在指数生长的异步种群中唯一的损失机制是通过细胞分裂的稀释。假设以下具有生物物理学基础的模型。\n\n1.  蛋白质的生成是一个无记忆的出生过程，每个细胞的恒定速率为 $k$，因此在无穷小时间间隔 $\\mathrm{d}t$ 内，生成一个新蛋白质的概率为 $k\\,\\mathrm{d}t$，而多重出生对于 $\\mathrm{d}t$ 的一阶项是可忽略的。\n2.  细胞分裂是一个无记忆过程，每个细胞的速率为 $\\lambda$（分裂间期时间呈指数分布，均值为 $1/\\lambda$）。在每次分裂时，蛋白质拷贝独立地分配给两个子细胞，因此，对于一个含有 $x$ 个蛋白质的母细胞，在一个随机追踪的子细胞中的拷贝数 $Y$ 服从 $\\mathrm{Binomial}(x, 1/2)$ 分布。\n3.  通过在每次分裂事件中均匀选择一个子细胞，你追踪一个随机的细胞谱系。该蛋白质不会主动降解。\n\n仅从上述随机规则、化学主方程(CME)和条件期望的标准定义出发，推导异步种群中蛋白质拷贝数 $X$ 的精确稳态方差 $\\mathrm{Var}[X]$。你的推导必须明确地解释来自生成噪声和分配噪声的贡献，并应通过编写和求解一阶矩和二阶矩的演化方程，从第一性原理出发进行。\n\n将你的最终答案表示为仅包含 $k$ 和 $\\lambda$ 的单一闭式解析表达式。最终答案中不要包含单位。不需要进行数值取整。", "solution": "我们将单细胞蛋白质数量 $X(t)$ 建模为一个具有两个反应通道的连续时间跳跃过程：\n\n1.  生成（出生）：$X \\to X+1$，速率为 $k$。\n2.  伴随二项分配的分裂：$X \\to Y$，其中 $Y \\mid X=x \\sim \\mathrm{Binomial}(x, 1/2)$，速率为 $\\lambda$。\n\n设 $m(t) \\equiv \\mathbb{E}[X(t)]$ 和 $s(t) \\equiv \\mathbb{E}[X(t)^{2}]$。对于一般的跳跃过程，Dynkin 公式（等价于从化学主方程（CME）推导出的矩方程）给出，对于状态的任意函数 $f$，\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\,\\mathbb{E}[f(X)] \\;=\\; \\mathbb{E}\\Big[ \\sum_{\\text{events}} \\text{rate} \\times \\big(f(\\text{post-state}) - f(\\text{pre-state})\\big) \\Big].\n$$\n\n一阶矩。选择 $f(X)=X$。\n\n- 生成的贡献为 $k \\times \\big((X+1)-X\\big)=k \\times 1$。\n- 分裂的贡献为 $\\lambda \\times \\mathbb{E}[Y - X \\mid X]$。由于 $Y \\mid X=x \\sim \\mathrm{Binomial}(x, 1/2)$，我们有 $\\mathbb{E}[Y \\mid X=x]=x/2$，所以 $\\mathbb{E}[Y - X \\mid X=x] = -x/2$。\n\n取期望得\n$$\n\\frac{\\mathrm{d}m}{\\mathrm{d}t} \\;=\\; k \\;+\\; \\lambda \\,\\mathbb{E}\\!\\left[-\\frac{X}{2}\\right] \\;=\\; k \\;-\\; \\frac{\\lambda}{2}\\,m.\n$$\n在稳态下，$\\mathrm{d}m/\\mathrm{d}t=0$，所以\n$$\nm_{\\ast} \\;=\\; \\frac{2k}{\\lambda}.\n$$\n\n二阶矩。选择 $f(X)=X^{2}$。\n\n- 生成：$(X+1)^{2}-X^{2} = 2X+1$，所以贡献为 $k\\,\\mathbb{E}[2X+1]=2k\\,m + k$。\n- 分裂：我们需要 $\\mathbb{E}[Y^{2} - X^{2} \\mid X]$。对于 $Y \\mid X=x \\sim \\mathrm{Binomial}(x, 1/2)$，我们有 $\\mathbb{E}[Y \\mid x]=x/2$ 和 $\\mathrm{Var}(Y \\mid x)=x\\cdot \\tfrac{1}{2}\\cdot \\tfrac{1}{2} = x/4$。因此\n$$\n\\mathbb{E}[Y^{2} \\mid x] \\;=\\; \\mathrm{Var}(Y \\mid x) + \\big(\\mathbb{E}[Y \\mid x]\\big)^{2} \\;=\\; \\frac{x}{4} + \\frac{x^{2}}{4}.\n$$\n所以，\n$$\n\\mathbb{E}[Y^{2} - X^{2} \\mid X=x] \\;=\\; \\left(\\frac{x}{4} + \\frac{x^{2}}{4}\\right) - x^{2} \\;=\\; \\frac{x}{4} - \\frac{3x^{2}}{4}.\n$$\n取期望，\n$$\n\\frac{\\mathrm{d}s}{\\mathrm{d}t} \\;=\\; 2k\\,m + k \\;+\\; \\lambda\\left(\\frac{1}{4}m - \\frac{3}{4}s\\right).\n$$\n在稳态下，$\\mathrm{d}s/\\mathrm{d}t=0$，所以\n$$\n0 \\;=\\; 2k\\,m + k \\;+\\; \\frac{\\lambda}{4}m \\;-\\; \\frac{3\\lambda}{4}s.\n$$\n代入 $m_{\\ast} = 2k/\\lambda$ 以求解 $s_{\\ast}$：\n$$\n0 \\;=\\; 2k\\left(\\frac{2k}{\\lambda}\\right) + k + \\frac{\\lambda}{4}\\left(\\frac{2k}{\\lambda}\\right) - \\frac{3\\lambda}{4}s_{\\ast}\n\\;=\\; \\frac{4k^{2}}{\\lambda} + k + \\frac{k}{2} - \\frac{3\\lambda}{4}s_{\\ast}.\n$$\n因此\n$$\n\\frac{3\\lambda}{4}s_{\\ast} \\;=\\; \\frac{4k^{2}}{\\lambda} + \\frac{3k}{2}\n\\quad\\Longrightarrow\\quad\ns_{\\ast} \\;=\\; \\frac{4}{3\\lambda}\\left(\\frac{4k^{2}}{\\lambda} + \\frac{3k}{2}\\right)\n\\;=\\; \\frac{16k^{2}}{3\\lambda^{2}} + \\frac{2k}{\\lambda}.\n$$\n\n方差。稳态方差为 $v_{\\ast} \\equiv \\mathrm{Var}[X]_{\\ast} = s_{\\ast} - m_{\\ast}^{2}$。使用 $m_{\\ast}=2k/\\lambda$，\n$$\nv_{\\ast}\n\\;=\\; \\left(\\frac{16k^{2}}{3\\lambda^{2}} + \\frac{2k}{\\lambda}\\right) - \\left(\\frac{2k}{\\lambda}\\right)^{2}\n\\;=\\; \\frac{16k^{2}}{3\\lambda^{2}} + \\frac{2k}{\\lambda} - \\frac{4k^{2}}{\\lambda^{2}}\n\\;=\\; \\frac{4k^{2}}{3\\lambda^{2}} + \\frac{2k}{\\lambda}.\n$$\n\n解释为来自生成噪声和分配噪声的贡献。记 $m_{\\ast} = 2k/\\lambda$。则\n$$\nv_{\\ast} \\;=\\; m_{\\ast} \\;+\\; \\frac{1}{3}m_{\\ast}^{2}.\n$$\n关于 $m_{\\ast}$ 的线性项来自泊松生成的散粒噪声，而二次项 $(1/3)m_{\\ast}^{2}$ 则源于分裂时的随机二项分配（其系数取决于由 $\\lambda$ 编码的指数分裂间期时间统计特性）。\n\n仅用 $k$ 和 $\\lambda$ 表示，稳态方差为\n$$\nv_{\\ast} \\;=\\; \\frac{2k}{\\lambda} \\;+\\; \\frac{4}{3}\\left(\\frac{k}{\\lambda}\\right)^{2}.\n$$", "answer": "$$\\boxed{\\frac{2k}{\\lambda}+\\frac{4}{3}\\left(\\frac{k}{\\lambda}\\right)^{2}}$$", "id": "2759671"}, {"introduction": "我们已经学习了解读数据和构建模型，但在科学研究中，我们常常面临多个竞争性模型的挑战。这个练习将向你介绍一个强大的计算工具——Kullback-Leibler (KL) 散度，它源于信息论。通过这个实践，你将学会如何定量地比较不同的机理假设与观测到的实验分布的吻合程度，从而在多个假说中做出选择。[@problem_id:2759675]", "problem": "在一项研究同基因细胞群体中表型异质性的合成生物学实验中，单细胞报告基因测量得到了跨越一组有限离散表达类别（区间）的基因表达水平的经验计数直方图。关于噪声来源（内在、外在或混合）的机制性假说由候选模型表示，这些模型在相同的区间上导出离散分布。为了比较这些假说，请实现一个程序，仅使用信息论和概率论的基本定义，为一组测试用例计算经验分布与每个候选机制分布之间的库尔贝克-莱布勒（KL）散度。\n\n假设与定义：\n- 分子生物学的中心法则和成熟的随机基因表达模型表明，细胞间的变异性源于概率过程；在这里，这种变异性由表达区间上的离散分布来概括。\n- 设经验直方图为 $n$ 个区间上的非负计数向量 $\\{C_i\\}_{i=1}^n$，候选模型为相同区间上的非负原始强度向量 $\\{R_i\\}_{i=1}^n$。原始强度无需进行归一化。\n- 为避免任何模型对具有非零经验概率的区间分配零概率时出现未定义行为，通过使用一个小的正伪计数 $\\alpha$ 进行加法平滑来强制实现绝对连续性。\n- 在归一化之前，对经验计数和候选模型强度的每个区间都加上一个单一的全局伪计数 $\\alpha = 10^{-12}$。\n- 根据总概率法则将平滑后的计数和强度转换为概率质量函数：对每个区间 $i$，定义 $P_i = \\dfrac{C_i + \\alpha}{\\sum_{j=1}^n (C_j + \\alpha)}$ 和 $Q_i = \\dfrac{R_i + \\alpha}{\\sum_{j=1}^n (R_j + \\alpha)}$。\n- 使用信息论中库尔贝克-莱布勒散度的定义，为每个测试用例计算经验分布 $P$ 和候选模型分布 $Q$ 之间的散度 $D_{\\mathrm{KL}}(P \\Vert Q)$，使用自然对数，结果以奈特（nats）为单位。\n\n实现约束：\n- 独立处理每个测试用例。\n- 对每个测试用例，计算一个等于 $D_{\\mathrm{KL}}(P \\Vert Q)$ 的实数。\n- 将每个结果以奈特（nats）为单位表示为一个浮点数，四舍五入到六位小数。\n- 你的程序应生成单行输出，包含一个由方括号括起来的逗号分隔的结果列表（例如，$\\left[\\text{result}_1,\\text{result}_2,\\dots\\right]$）。\n\n测试套件（每个用例是一对：经验计数，候选模型原始强度）：\n- 用例 $\\#1$：经验计数 $[50, 100, 150, 125, 75]$，候选模型原始强度 $[0.5, 1.0, 1.5, 1.25, 0.75]$。\n- 用例 $\\#2$：经验计数 $[80, 0, 0, 0, 20]$，候选模型原始强度 $[0.0, 1.0, 0.0, 1.0, 0.0]$。\n- 用例 $\\#3$：经验计数 $[5, 40, 10, 40, 5]$，候选模型原始强度 $[0.05, 0.2, 0.5, 0.2, 0.05]$。\n- 用例 $\\#4$：经验计数 $[0, 0, 100, 0, 0]$，候选模型原始强度 $[1, 1, 1, 1, 1]$。\n- 用例 $\\#5$：经验计数 $[1, 2, 3, 0, 0]$，候选模型原始强度 $[1000, 2000, 3000, 0, 0]$。\n\n角度单位不适用。不涉及物理单位。最终输出必须是单行，格式严格为 $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5\\right]$，每个值都四舍五入到六位小数，并以奈特（nats）为单位，表示为不带百分号的小数。", "solution": "问题陈述是连贯的、有科学依据且适定的。执行此任务所需的所有必要定义、常数和数据均已提供。这是将信息论的基本原理直接应用于定量生物学中一个标准问题的实例。因此，该问题是有效的，并将在此提出解决方案。\n\n目标是计算经验概率分布 $P$ 与模型导出的概率分布 $Q$ 之间的库尔贝克-莱布勒（$D_{\\mathrm{KL}}$）散度。这两个分布都定义在一个包含 $n$ 个区间的离散集合上。\n\n设经验数据由计数向量 $C = \\{C_i\\}_{i=1}^n$ 给出，候选模型由原始、未归一化的强度向量 $R = \\{R_i\\}_{i=1}^n$ 给出。问题陈述指定了一个加法平滑的程序以确保绝对连续性，这对于防止在 $D_{\\mathrm{KL}}$ 公式中出现除以零或对零取对数是必要的。对 $C$ 和 $R$ 的每个区间都加上一个单一伪计数 $\\alpha = 10^{-12}$。\n\n首先，我们定义平滑后的计数 $C'_i$ 和平滑后的强度 $R'_i$：\n$$ C'_i = C_i + \\alpha $$\n$$ R'_i = R_i + \\alpha $$\n对于从 $1$ 到 $n$ 的每个区间 $i$。\n\n接下来，将这些平滑值进行归一化，以形成有效的概率质量函数 $P = \\{P_i\\}_{i=1}^n$ 和 $Q = \\{Q_i\\}_{i=1}^n$。根据总概率法则，通过除以所有平滑值的总和来进行归一化。\n\n区间 $i$ 的经验概率 $P_i$ 为：\n$$ P_i = \\frac{C'_i}{\\sum_{j=1}^n C'_j} = \\frac{C_i + \\alpha}{\\sum_{j=1}^n (C_j + \\alpha)} $$\n\n区间 $i$ 的模型概率 $Q_i$ 为：\n$$ Q_i = \\frac{R'_i}{\\sum_{j=1}^n R'_j} = \\frac{R_i + \\alpha}{\\sum_{j=1}^n (R_j + \\alpha)} $$\n\n在定义了分布 $P$ 和 $Q$ 之后，就可以计算从 $Q$ 到 $P$ 的库尔贝克-莱布勒散度，记为 $D_{\\mathrm{KL}}(P \\Vert Q)$。它衡量了当使用 $Q$ 来近似 $P$ 时所损失的信息。问题指定使用自然对数，因此散度的单位将是奈特（nats）。其定义为：\n$$ D_{\\mathrm{KL}}(P \\Vert Q) = \\sum_{i=1}^n P_i \\ln\\left(\\frac{P_i}{Q_i}\\right) $$\n使用平滑常数 $\\alpha > 0$ 确保了对于所有的 $i$（只要不是所有输入计数或强度都为零），都有 $P_i > 0$ 和 $Q_i > 0$，因此比率 $P_i/Q_i$ 总是良定义且为正，其对数也总是有定义的。\n\n每个测试用例的计算步骤如下：\n1. 给定经验计数向量 $C$ 和模型强度向量 $R$。\n2. 定义伪计数 $\\alpha = 10^{-12}$。\n3. 通过给每个元素加上 $\\alpha$ 来创建平滑后的向量 $C'$ 和 $R'$。\n4. 计算平滑后向量的总和：$S_P = \\sum C'_i$ 和 $S_Q = \\sum R'_i$。\n5. 进行归一化以获得概率分布：$P_i = C'_i / S_P$ 和 $Q_i = R'_i / S_Q$。\n6. 通过对所有区间 $i$ 求和项 $P_i \\times (\\ln(P_i) - \\ln(Q_i))$ 来计算 $D_{\\mathrm{KL}}(P \\Vert Q)$。\n7. 将最终结果四舍五入到六位小数。\n\n例如，我们考虑用例 $4$：$C = [0, 0, 100, 0, 0]$ 和 $R = [1, 1, 1, 1, 1]$。这里，$n=5$。\n- 平滑后的计数 $C' = [10^{-12}, 10^{-12}, 100+10^{-12}, 10^{-12}, 10^{-12}]$。\n- 平滑后的计数总和 $S_P = 100 + 5 \\times 10^{-12}$。\n- 平滑后的强度 $R' = [1+10^{-12}, 1+10^{-12}, 1+10^{-12}, 1+10^{-12}, 1+10^{-12}]$。\n- 平滑后的强度总和 $S_Q = 5 + 5 \\times 10^{-12}$。\n- 分布 $P$ 和 $Q$ 是通过对 $C'$ 和 $R'$ 进行归一化计算得出的。\n- $P$ 将是一个在第三个区间上呈尖峰的分布，其中 $P_3 \\approx 1$。\n- $Q$ 将是一个近似均匀的分布，其中对所有 $i$ 都有 $Q_i \\approx 0.2$。\n- 散度将主要由第三项决定：$D_{\\mathrm{KL}}(P \\Vert Q) \\approx P_3 \\ln(P_3/Q_3) \\approx 1 \\times \\ln(1/0.2) = \\ln(5) \\approx 1.609438$。$P_i$ 值非常小的其他区间的贡献将可以忽略不计。\n\n此程序将被应用于所有提供的测试用例，以生成最终的结果列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Kullback-Leibler divergence for a set of test cases comparing\n    empirical and model distributions in a synthetic biology context.\n    \"\"\"\n    # Define the pseudocount for additive smoothing.\n    alpha = 1e-12\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (empirical_counts, model_raw_intensities)\n    test_cases = [\n        # Case #1\n        ([50, 100, 150, 125, 75], [0.5, 1.0, 1.5, 1.25, 0.75]),\n        # Case #2\n        ([80, 0, 0, 0, 20], [0.0, 1.0, 0.0, 1.0, 0.0]),\n        # Case #3\n        ([5, 40, 10, 40, 5], [0.05, 0.2, 0.5, 0.2, 0.05]),\n        # Case #4\n        ([0, 0, 100, 0, 0], [1, 1, 1, 1, 1]),\n        # Case #5\n        ([1, 2, 3, 0, 0], [1000, 2000, 3000, 0, 0]),\n    ]\n\n    results = []\n    for counts, intensities in test_cases:\n        # Convert lists to NumPy arrays for vectorized operations.\n        # Ensure float type for precision.\n        C = np.array(counts, dtype=np.float64)\n        R = np.array(intensities, dtype=np.float64)\n\n        # 1. Apply additive smoothing with the pseudocount alpha.\n        C_smoothed = C + alpha\n        R_smoothed = R + alpha\n\n        # 2. Normalize to get the probability mass functions P and Q.\n        # The law of total probability is applied.\n        P = C_smoothed / np.sum(C_smoothed)\n        Q = R_smoothed / np.sum(R_smoothed)\n        \n        # 3. Compute the Kullback-Leibler divergence D_KL(P || Q).\n        # The formula is sum(P_i * log(P_i / Q_i)).\n        # We must handle the case where P_i is near zero due to smoothing.\n        # The term P_i * log(P_i) approaches 0 as P_i -> 0.\n        # Modern numerical libraries handle this gracefully.\n        # The use of np.log implies the natural logarithm, giving a result in \"nats\".\n        \n        # A stable way to compute this is Sum(P * (log(P) - log(Q))).\n        # The problem statement ensures P and Q are strictly positive due to alpha.\n        kl_divergence = np.sum(P * (np.log(P) - np.log(Q)))\n\n        # 4. Round the result to six decimal places as required.\n        rounded_result = round(kl_divergence, 6)\n        results.append(rounded_result)\n\n    # Format the final output as a comma-separated list in brackets.\n    output_string = f\"[{','.join(map(str, results))}]\"\n    print(output_string)\n\nsolve()\n```", "id": "2759675"}]}