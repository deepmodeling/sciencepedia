{"hands_on_practices": [{"introduction": "微生物学的一项基本技能是设计简洁的实验来区分不同的生物学机制。本练习旨在挑战你像实验科学家一样思考，通过解读经典的 DNase 敏感性实验结果来辨析基因转移的途径。通过分析 DNase 这种能降解 DNA 的酶如何影响基因转移，你将能够明确地区分转化（涉及裸露的 DNA）和转导（DNA 被包裹在病毒衣壳内而受到保护） [@problem_id:1531230]。", "problem": "一位遗传学学生正在研究*Escherichia coli*的水平基因转移机制。该实验涉及一个能合成色氨酸（`trp+`）的供体菌株和一个不能合成色氨酸（`trp-`）的受体菌株。实验的目的是确定哪些机制可以将`trp+`基因转移到`trp-`受体中，使其能够在缺乏色氨酸的基本培养基上生长。\n\n该学生在不同的试管中设置了四种实验条件：\n\n- **试管1：** 将受体细胞与从`trp+`供体菌株的裂解培养物中获得的无细胞滤液混合。\n- **试管2：** 与试管1相同，但添加了脱氧核糖核酸酶（DNase），这是一种降解DNA的酶。\n- **试管3：** 将受体细胞与先前和`trp+`供体菌株一起培养的P1噬菌体混合。\n- **试管4：** 与试管3相同，但添加了DNase。\n\n经过适当的孵育后，将每支试管中的细胞接种到不含色氨酸的基本培养基琼脂平板上。只有`trp+`重组细胞才能形成菌落。结果总结在下表中。\n\n| 试管 | 实验条件 | 结果（菌落生长） |\n|:----:|:---------------------------------------------------------|:-----------------------|\n| 1 | 受体细胞 + 供体滤液 | 大量菌落 |\n| 2 | 受体细胞 + 供体滤液 + DNase | 无菌落 |\n| 3 | 受体细胞 + P1噬菌体（来自供体） | 大量菌落 |\n| 4 | 受体细胞 + P1噬菌体（来自供体） + DNase | 大量菌落 |\n\n根据这些结果，以下哪个结论最准确？\n\nA. 试管1和2证明了成功的转化，而试管3和4表明P1噬菌体无法进行转导。\n\nB. 转化（试管1、2）和转导（试管3、4）都对DNase的作用敏感。\n\nC. 实验证明转化对DNase敏感，而由P1噬菌体介导的转导对DNase具有抗性。\n\nD. 实验证明转导对DNase敏感，而转化对DNase具有抗性。\n\nE. 两组实验都成功了，表明转化和转导在功能上是相同的过程。", "solution": "我们利用水平基因转移的原理来分析每种机制以及DNase的影响：\n\n1) 转化原理：受体细胞可以通过从环境中摄取裸露的供体DNA来获得新性状。来自裂解的供体细胞的无细胞滤液含有可以被感受态受体摄取的游离DNA。DNase会降解细胞外的DNA，从而阻止转化。\n\n- 试管1（受体 + 供体滤液）在缺乏色氨酸的基本培养基上长出大量菌落。解释：携带`trp+`基因的游离供体DNA被受体摄取，通过转化恢复了色氨酸原养型。\n- 试管2（受体 + 供体滤液 + DNase）没有长出菌落。解释：DNase降解了细胞外的供体DNA，从而消除了转化。因此，转化对DNase敏感。\n\n2) 转导原理：像P1这样的普遍性转导噬菌体可以将供体细菌DNA的片段（包括`trp+`）包装到噬菌体头部，并在感染过程中将其递送给受体。完整的噬菌体颗粒内部的DNA受到保护，不受细胞外DNase的影响；DNase无法穿透衣壳。因此，转导通常对外部的DNase具有抗性。\n\n- 试管3（受体 + 来自`trp+`供体的P1）长出大量菌落。解释：P1介导了`trp+` DNA到受体的转导，产生了能够生长的重组体。\n- 试管4（受体 + 来自`trp+`供体的P1 + DNase）仍然长出大量菌落。解释：DNase没有减少菌落的形成，因为供体DNA在噬菌体颗粒内受到了保护；因此，转导对DNase具有抗性。\n\n根据数据评估各个选项：\n\n- A是错误的：试管2没有菌落，因此它没有证明成功的转化；试管3和4清楚地表明了成功的转导。\n- B是错误的：转导（试管3、4）对DNase不敏感。\n- C是正确的：转化对DNase敏感（试管1与试管2对比），而由P1噬菌体介导的转导对DNase具有抗性（试管3与试管4对比）。\n- D是错误的：这颠倒了实际的敏感性。\n- E是错误的：尽管两个过程都产生了重组体，但它们在功能上并不相同；它们在对DNase的敏感性和机制上有所不同。\n\n因此，最准确的结论是，转化对DNase敏感，而P1介导的转导对DNase具有抗性。", "answer": "$$\\boxed{C}$$", "id": "1531230"}, {"introduction": "在基因组学时代，识别历史上的水平基因转移事件越来越不依赖于试管实验，而是更倾向于“基因组取证”——即在 DNA 序列中发现其留下的特殊信号。本练习将锻炼你扮演基因组侦探的能力。你将学会通过识别基因转移因子（GTAs）和接合性质粒在染色体上留下的独特且对比鲜明的“足迹”，来区分由这两种不同机制介导的转移事件 [@problem_id:2385146]。", "problem": "在一项细菌的比较基因组学研究中，您希望区分由基因转移因子（GTA；一种包装产生菌染色体随机片段的病毒样颗粒）介导的水平基因转移（HGT）事件和由接合性质粒介导的事件。您拥有一个物种内多个分离株以及近缘外群的全基因组序列，但没有实体质粒制备物。基于关于机制、包装和整合的基本原理，哪种基因组学特征最能强烈表明是由GTA介导的转移，而非质粒介导的转移？\n\nA. 在核心染色体上散布着大量近乎相同的短同源区段（长度约 $3$–$10$ 千碱基（kb）），它们替换了受体的等位基因，但没有引入新的移动基因；片段边界缺少直接重复序列（DR）或插入序列疤痕；这些区段的鸟嘌呤-胞嘧啶（GC）含量与局部染色体背景相匹配，且系统发育不一致性仅限于被替换的等位基因。\n\nB. 一个单一的、大的、连续的基因组岛（至少 $\\geq 50$ kb），携带接合（tra）和复制（rep）功能以及一个整合酶，两侧是插入序列和短的直接重复序列；该岛的鸟嘌呤-胞嘧啶（GC）含量和密码子使用偏好与宿主染色体不同。\n\nC. 从基因组组装中复原出环状重叠群，其上编码转移起始点（oriT）、分配和维持系统（例如，par，毒素-抗毒素），以及一个在分离株间基因共线性保守的连续辅助基因块。\n\nD. 获得的区域显著富集以连续簇形式排列的抗生素抗性决定簇和代谢操纵子，并且在相同的重叠群中存在典型的质粒骨架序列基序。\n\nE. 在获得片段的边缘重复检测到相同的原噬菌体附着位点（att），这与温和噬菌体整合酶介导的位点特异性整合相一致。", "solution": "问题陈述在科学上是有效的。它在计算生物学领域提出了一个定义明确的问题，即如何区分两种不同的水平基因转移（HGT）机制：基因转移因子（GTA）和接合性质粒。所提供的背景——使用全基因组序列进行比较基因组学分析——是此类研究的标准方法。对这些机制的描述与已确立的生物学原理相符。该问题是客观、自洽的，并允许根据这些原理进行演绎推理，从而得出一个唯一的解。\n\n为了区分GTA介导和质粒介导的HGT，我们必须首先确定每种机制的基本特征。\n\n**1. 基因转移因子（GTA）机制：**\n*   **性质：** GTA是由某些细菌产生的病毒样颗粒，它们包装宿主染色体的片段。\n*   **包装：** 包装过程很大程度上是随机的。GTA从产生菌染色体的任意位置封装小的线性DNA片段。这些片段的大小受GTA衣壳容积的限制，通常在几千碱基（kb）的量级，例如，在 *Rhodobacter capsulatus* 中约为 $\\approx 4.5$ kb，在 *Bartonella* 中可达 $\\approx 14$ kb。\n*   **内容：** 这些片段是供体染色体的一个随机样本。它们不优先包含用于其自身转移或复制的基因。\n*   **整合：** 注入受体细胞后，线性DNA片段缺乏其自身的复制或整合机制。其稳定遗传的唯一途径是通过同源重组与受体染色体整合，这一过程由宿主自身的重组机制（例如，`RecA`系统）介导。这导致受体的同源等位基因被供体的等位基因*替换*。\n*   **基因组学特征：**\n    *   结果是一小段与其周围染色体在系统发育上不一致的DNA。\n    *   在群体中，多次独立的GTA事件将导致染色体上散布着大量此类区段。\n    *   整合过程不会像转座常见的那样，产生插入位点重复（直接重复序列，DRs）或留下插入序列（IS元件）的残余物。\n    *   转移的DNA源自相同或近缘物种细菌的染色体，其鸟嘌呤-胞嘧啶（GC）含量和密码子使用谱通常与受体染色体无法区分。\n    *   转移的片段不携带移动性基因（例如，用于接合的 `tra` 基因）。\n\n**2. 接合性质粒机制：**\n*   **性质：** 接合性质粒是自我复制的染色体外DNA元件，编码将自身从供体细胞转移到受体细胞的机制。一些质粒可以整合到宿主染色体中；这些通常被称为整合性接合元件（ICEs）。\n*   **包装/转移：** 整个质粒（或ICE）是一个单一、庞大、可移动的单元。转移是一个高度特异性的过程，在转移起始点 (`oriT`) 启动，并由转移 (`tra`) 基因编码的专用蛋白质复合物执行。\n*   **内容：** 质粒和ICE的定义特征是存在对其自身复制、维持（例如，分配 (`par`) 系统、毒素-抗毒素系统）和转移 (`tra` 基因) 至关重要的基因。它们是“自私”的遗传元件。它们还携带辅助基因（例如，用于抗生素抗性或代谢）。\n*   **整合：** 质粒可以作为环状分子在染色体外存在。ICE和一些质粒整合到染色体中，通常通过位点特异性整合酶（产生 `attL` 和 `attR` 位点）或转座酶（在元件两侧产生标志性的直接重复序列）。这导致*添加*一大块新的DNA。\n*   **基因组学特征：**\n    *   存在一个大的、连续的DNA块（一个基因组岛），大小通常为几十到几百kb。\n    *   该岛包含可识别的质粒相关基因（`tra`，`rep`，`oriT`，`par`）。\n    *   整合元件的边界通常由直接重复序列、插入序列或噬菌体样的附着 (`att`) 位点标记。\n    *   由于在不同的宿主中进化，与宿主染色体相比，该岛通常表现出非典型的GC含量和密码子使用偏好。\n    *   如果未整合，它在基因组组装中会以一个具有这些特征的独立环状重叠群出现。\n\n基于这些原理，我们来评估各个选项。\n\n**A. 在核心染色体上散布着大量近乎相同的短同源区段（长度约 $3$–$10$ 千碱基（kb）），它们替换了受体的等位基因，但没有引入新的移动基因；片段边界缺少直接重复序列（DR）或插入序列疤痕；这些区段的鸟嘌呤-胞嘧啶（GC）含量与局部染色体背景相匹配，且系统发育不一致性仅限于被替换的等位基因。**\n该选项提出了一系列完全符合GTA介导转移预期特征的标志。\n*   `大量短的同源区段...散布`：与小DNA片段的随机包装一致。\n*   `$3$–$10$ 千碱基（kb）`：与GTA有限的衣壳大小一致。\n*   `替换受体的等位基因`：线性片段同源重组的关键结果。\n*   `没有引入新的移动基因`：这是随机包装染色体DNA的预期结果，与自我动员的质粒形成鲜明对比。\n*   `缺少直接重复序列（DR）或插入序列疤痕`：排除了转座的可能性，指向同源重组。\n*   `GC含量...相匹配`：对于来源是染色体的近缘生物体之间的转移，这是预期的结果。\n*   `系统发育不一致性仅限于被替换的等位基因`：这是通过等位基因替换实现的局部HGT的精确特征。\n所描述的每一个特征都是GTA机制的直接结果，且与典型的质粒/ICE机制不一致。\n结论：**正确**。\n\n**B. 一个单一的、大的、连续的基因组岛（至少 $\\geq 50$ kb），携带接合（tra）和复制（rep）功能以及一个整合酶，两侧是插入序列和短的直接重复序列；该岛的鸟嘌呤-胞嘧啶（GC）含量和密码子使用偏好与宿主染色体不同。**\n这是整合性接合元件（ICE）或大型整合性质粒的教科书式描述。其巨大的尺寸、`tra` 和 `rep` 基因的存在、整合酶、插入疤痕（IS元件、DRs）以及非典型的GC含量都是移动遗传元件的标志，这在机制上与GTA截然相反。\n结论：**错误**。\n\n**C. 从基因组组装中复原出环状重叠群，其上编码转移起始点（oriT）、分配和维持系统（例如，par，毒素-抗毒素），以及一个在分离株间基因共线性保守的连续辅助基因块。**\n这描述了一种经典的、染色体外的接合性质粒。GTA转移的是会整合的线性染色体片段；它不转移或创建一个独立的环状复制子。`oriT` 和 `par` 系统的存在是质粒的决定性特征。\n结论：**错误**。\n\n**D. 获得的区域显著富集以连续簇形式排列的抗生素抗性决定簇和代谢操纵子，并且在相同的重叠群中存在典型的质粒骨架序列基序。**\n尽管其携带的货物（抗性/代谢基因）可以通过多种HGT机制移动，但这里的诊断性特征是存在`典型的质粒骨架序列基序`。这明确指向携带这些基因的重叠群源于质粒，而不是GTA。\n结论：**错误**。\n\n**E. 在获得片段的边缘重复检测到相同的原噬菌体附着位点（att），这与温和噬菌体整合酶介导的位点特异性整合相一致。**\n这描述了由温和噬菌体介导的HGT，该机制被称为转导。虽然GTA是“病毒样”的，但它们与真正的温和噬菌体不同。它们缺乏特异性整合酶，不使用会留下`att`位点的位点特异性整合。此特征指向噬菌体介导的事件，而非GTA介导的事件。\n结论：**错误**。\n\n总而言之，选项A提供了唯一一个独特且强烈地表征基因转移因子转移的描述，与接合性质粒、ICEs和温和噬菌体的特征形成鲜明对比。", "answer": "$$\\boxed{A}$$", "id": "2385146"}, {"introduction": "为了真正掌握水平基因转移的进化影响，我们必须从静态描述转向动态模型，以捕捉基因转移、选择压力和环境变化之间复杂的相互作用。这项高级练习将挑战你从基本原理出发，建立一个动态模型来研究周期性的抗生素暴露如何决定一个抗性基因质粒的最终命运。这个问题不仅考验你的量化分析能力，还将引导你接触非线性动力学中的强大概念，例如解释了为何“历史”在进化中至关重要的“迟滞现象” [@problem_id:2745239]。", "problem": "考虑一个处于生态学准稳态总密度的充分混合微生物种群，该种群由两个亚群组成：含质粒细胞和无质粒细胞。一个抗性质粒是可水平转移的，在无抗生素环境下携带它是有代价的，但在抗生素暴露期间则是有益的。假设以下在种群遗传学和水平基因转移（HGT, Horizontal Gene Transfer）的质量作用动力学中属于标准的基本基础和模型要素：\n\n- 中心法则和经典选择：表型映射到适应度差异，这可以用一个选择系数 $s(t)$ 来表示。当存在抗生素时，该系数为正，不存在时为负，分别反映了携带质粒的益处和代价。\n- 质量作用接合：含质粒供体以质量作用速率参数 $\\beta$ 将无质粒受体转化为含质粒细胞，产生一个与供体和受体频率乘积成正比的净频率流。\n- 分离丢失：含质粒细胞以速率 $\\mu$ 丢失质粒，转化回无质粒细胞。\n- 快速生态调节：在所考虑的时间尺度上，总种群数量近似恒定，因此动力学可以投影到含质粒细胞的频率 $f(t)$ 上。\n\n基于这些基础，推导在方波抗生素暴露方案下的频率动力学：在每个长度为 $T$ 的周期中，抗生素“开启”的时间占比例 $d$，“关闭”的时间占剩余比例。设存在抗生素时的选择系数为 $s_{\\mathrm{on}}$，不存在时的选择系数为 $s_{\\mathrm{off}}$。参数 $\\beta$ 和 $\\mu$ 不随时间变化。所有变量和参数均为无量纲。方波从 $t=0$ 时的“开启”阶段开始，然后周期性交替。\n\n你的任务是：\n\n1) 从上述基本基础出发，推导控制含质粒细胞频率 $f(t)$ 的封闭形式常微分方程。证明该方程可以写成如下形式：\n$$\n\\frac{df}{dt} = r(t)\\, f - k(t)\\, f^2,\n$$\n对于分段常数系数 $r(t)$ 和 $k(t)$，你必须用 $s(t)$、$\\beta$ 和 $\\mu$ 来确定它们。不要假设任何未提及的公式。\n\n2) 对于 $r$ 和 $k$ 为常数的任意固定阶段，求解方程\n$$\n\\frac{df}{dt} = r f - k f^2\n$$\n以获得映射 $\\Phi_{\\tau}(f_0)$，该映射将频率 $f$ 从初始值 $f(0)=f_0$ 向前传播一个时长 $\\tau$。使用此映射构建周期映射 $M(f)$，它将系统推进一个长度为 $T$ 的完整抗生素周期，该周期由一个时长为 $dT$ 的“开启”阶段和一个时长为 $(1-d)T$ 的“关闭”阶段组成。周期映射应为两个阶段映射的复合：\n$$\nM(f) = \\Phi_{\\,(1-d)T}^{\\mathrm{off}}\\!\\big(\\,\\Phi_{\\,dT}^{\\mathrm{on}}(f)\\,\\big).\n$$\n\n3) 分析周期映射的不动点。不动点 $f^\\ast$ 满足 $M(f^\\ast)=f^\\ast$。根据构造，不动点 $f^\\ast=0$ 总是存在的。其线性稳定性由乘子\n$$\n\\Lambda_0 \\equiv M'(0) = \\exp\\!\\Big(\\, r_{\\mathrm{on}}\\, dT + r_{\\mathrm{off}}\\, (1-d)T \\Big),\n$$\n决定，其中 $r_{\\mathrm{on}}$ 和 $r_{\\mathrm{off}}$ 是在任务1中确定的 $r(t)$ 在“开启”和“关闭”阶段的值。不动点 $f^\\ast=0$ 是稳定的当且仅当 $\\Lambda_0 < 1$。一个非零不动点 $f^\\ast \\in (0,1)$ 是稳定的当且仅当 $\\lvert M'(f^\\ast)\\rvert < 1$。当 $f^\\ast=0$ 是稳定的，并且至少存在一个稳定的非零不动点 $f^\\ast \\in (0,1)$ 时，周期性强迫下存在迟滞现象，这意味着存在多个吸引子，并且在一个作为阈值的不稳定不动点 $f_{\\mathrm{thr}} \\in (0,1)$ 处存在一个吸引盆边界。\n\n4) 对于下面测试套件中的每个参数集，计算以下量：\n- 指示是否存在迟滞现象的布尔值（即，$f^\\ast=0$ 是稳定的，并且在 $(0,1)$ 中存在一个稳定的非零不动点）。\n- 阈值 $f_{\\mathrm{thr}}$，定义如下：如果存在迟滞现象，则为 $M$ 在 $(0,1)$ 内的最小正不动点（该点不稳定）；如果 $f^\\ast=0$ 不稳定（即 $\\Lambda_0 > 1$）且存在一个稳定的非零 $f^\\ast$，则返回 $0$；如果不存在稳定的非零不动点，则返回 $1$。\n- 在 $(0,1)$ 内最大的稳定非零不动点 $f^\\ast$（如果存在），否则返回 $0$。\n- 如上定义的零点附近的线性乘子 $\\Lambda_0$。\n- 一个周期内的时间平均选择系数 $\\bar{s} = d\\, s_{\\mathrm{on}} + (1-d)\\, s_{\\mathrm{off}}$。\n\n数值要求：\n- 所有浮点数输出必须四舍五入到小数点后六位。\n- 最终程序不得要求任何用户输入，并且必须嵌入测试套件。\n\n测试套件（每种情况是一个6元组 $(s_{\\mathrm{on}}, s_{\\mathrm{off}}, \\beta, \\mu, T, d)$ ）：\n- 情况 A（旨在允许迟滞现象）：$(\\,0.6,\\,-0.08,\\,0.02,\\,0.03,\\,10.0,\\,0.1\\,)$。\n- 情况 B（旨在使 $f^\\ast=0$ 不稳定并具有全局持续性）：$(\\,0.6,\\,-0.08,\\,0.02,\\,0.03,\\,10.0,\\,0.3\\,)$。\n- 情况 C（旨在导致灭绝）：$(\\,0.05,\\,-0.1,\\,0.01,\\,0.05,\\,10.0,\\,0.1\\,)$。\n- 情况 D（旨在无迟滞地持续存在，并具有正的“关闭”期增长）：$(\\,0.2,\\,-0.01,\\,0.05,\\,0.02,\\,5.0,\\,0.1\\,)$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个由方括号括起来的、由逗号分隔的四种情况的结果列表，且不含空格。每种情况的结果本身必须是按上述顺序排列的五个值的列表：$[\\text{hysteresis}, f_{\\mathrm{thr}}, f^\\ast, \\Lambda_0, \\bar{s}]$。例如，一个语法上有效的输出行看起来像 `[[\\mathrm{True},0.123456,0.234567,1.345679,0.052000],[\\mathrm{False},1.000000,0.000000,0.900000,-0.040000],\\ldots]`。确保打印的字符串中没有任何空格。", "solution": "问题陈述经评估是有效的。它在科学上基于种群遗传学和微生物动力学的标准原理，是良定的，并包含了完整推导和求解所需的所有信息。不存在逻辑矛盾、事实不准确或含糊不清之处。\n\n任务是分析周期性抗生素胁迫下含质粒微生物亚群的动力学。这将按照要求分四个阶段完成：首先，推导控制微分方程；其次，求解该方程以构建一个强迫周期的离散时间映射；第三，分析该映射的不动点以确定长期行为；第四，对指定测试用例进行此分析的数值实现。\n\n**任务1：控制性常微分方程（ODE）的推导**\n\n设 $N_D(t)$ 为含质粒细胞（供体）的种群密度，$N_R(t)$ 为无质粒细胞（受体）的种群密度。总种群密度为 $N = N_D + N_R$。问题陈述指出 $N$ 处于准稳态，因此我们视其为常数。含质粒细胞的频率为 $f(t) = N_D(t) / N$，无质粒细胞的频率为 $1-f(t) = N_R(t) / N$。\n\n我们使用一个标准框架来模拟种群动力学，该框架考虑了选择、水平基因转移（HGT）和分离丢失，同时强制总种群数量恒定。设无质粒细胞的人均增长率为 $g_R$，含质粒细胞的人均增长率为 $g_D$。选择系数 $s(t) = g_D - g_R$ 代表适应度差异。总种群的平均增长率为 $\\bar{g}(t) = f(t) g_D + (1-f(t)) g_R$。为保持总种群数量恒定，必须对两个亚群施加一个等于平均增长率 $\\bar{g}(t)$ 的稀释或死亡项。\n\n含质粒细胞密度 $N_D$ 的动力学由以下因素决定：\n1.  选择引起的增长：$(g_D - \\bar{g}) N_D$。这是标准的复制子方程项。\n2.  从HGT获得的增益：当供体与受体接合时，会形成新的含质粒细胞。这以与它们密度乘积成正比的速率发生，即 $\\beta N_D N_R$。\n3.  分离导致的损失：含质粒细胞以人均速率 $\\mu$ 丢失质粒并变为无质粒细胞，贡献一个损失项 $-\\mu N_D$。\n\n综合这些效应，$N_D$ 的变化速率为：\n$$\n\\frac{dN_D}{dt} = (g_D - \\bar{g}) N_D + \\beta N_D N_R - \\mu N_D\n$$\n现在，我们推导频率 $f = N_D / N$ 的方程。由于 $N$ 是常数，$\\frac{df}{dt} = \\frac{1}{N} \\frac{dN_D}{dt}$。\n$$\n\\frac{df}{dt} = \\frac{1}{N} \\left( (g_D - \\bar{g}) N_D + \\beta N_D N_R - \\mu N_D \\right)\n$$\n代入 $N_D = fN$、$N_R = (1-f)N$ 和 $\\bar{g} = f g_D + (1-f) g_R$：\n$$\n\\frac{df}{dt} = (g_D - (f g_D + (1-f) g_R)) f + \\beta f N(1-f) / N - \\mu f\n$$\n$$\n\\frac{df}{dt} = ( (1-f)g_D - (1-f)g_R ) f + \\beta f(1-f) - \\mu f\n$$\n$$\n\\frac{df}{dt} = (1-f)(g_D - g_R)f + \\beta f(1-f) - \\mu f\n$$\n使用选择系数的定义 $s(t) = g_D - g_R$：\n$$\n\\frac{df}{dt} = s(t) f(1-f) + \\beta f(1-f) - \\mu f\n$$\n$$\n\\frac{df}{dt} = (s(t) + \\beta) f - (s(t) + \\beta) f^2 - \\mu f\n$$\n重新整理成所要求的形式 $\\frac{df}{dt} = r(t) f - k(t) f^2$：\n$$\n\\frac{df}{dt} = (s(t) - \\mu + \\beta) f - (s(t) + \\beta) f^2\n$$\n由此，我们确定分段常数系数：\n$r(t) = s(t) - \\mu + \\beta$\n$k(t) = s(t) + \\beta$\n\n在抗生素“开启”阶段，$s(t)=s_{\\mathrm{on}}$，所以 $r_{\\mathrm{on}} = s_{\\mathrm{on}} - \\mu + \\beta$ 且 $k_{\\mathrm{on}} = s_{\\mathrm{on}} + \\beta$。\n在抗生素“关闭”阶段，$s(t)=s_{\\mathrm{off}}$，所以 $r_{\\mathrm{off}} = s_{\\mathrm{off}} - \\mu + \\beta$ 且 $k_{\\mathrm{off}} = s_{\\mathrm{off}} + \\beta$。\n\n**任务2：ODE的求解与周期映射的构建**\n\n方程 $\\frac{df}{dt} = r f - k f^2$ 是一个伯努利微分方程，也可识别为逻辑斯谛增长方程。对于常数系数 $r$ 和 $k$，以及初始条件 $f(0)=f_0$，给出在时间 $\\tau$ 的频率的解为：\n$$\n\\Phi_{\\tau}(f_0) = \\frac{r f_0 e^{r\\tau}}{r + k f_0 (e^{r\\tau} - 1)}\n$$\n该解可以通过分离变量法和部分分式分解推导得出。这个映射 $\\Phi_{\\tau}(f_0)$ 将频率 $f$ 向前传播一个时长 $\\tau$。\n\n抗生素暴露方案是一个周期为 $T$、占空比为 $d$ 的方波。一个完整周期由一个时长为 $dT$ 的“开启”阶段和一个时长为 $(1-d)T$ 的“关闭”阶段组成。周期映射 $M(f)$ 将频率从一个周期的开始推进到下一个周期的开始。它是每个阶段映射的复合：\n$$\nM(f) = \\Phi^{\\mathrm{off}}_{(1-d)T} \\left( \\Phi^{\\mathrm{on}}_{dT}(f) \\right)\n$$\n其中：\n$$\n\\Phi^{\\mathrm{on}}_{dT}(f) = \\frac{r_{\\mathrm{on}} f e^{r_{\\mathrm{on}}dT}}{r_{\\mathrm{on}} + k_{\\mathrm{on}} f (e^{r_{\\mathrm{on}}dT} - 1)}\n$$\n$$\n\\Phi^{\\mathrm{off}}_{(1-d)T}(f_1) = \\frac{r_{\\mathrm{off}} f_1 e^{r_{\\mathrm{off}}(1-d)T}}{r_{\\mathrm{off}} + k_{\\mathrm{off}} f_1 (e^{r_{\\mathrm{off}}(1-d)T} - 1)}\n$$\n将前者代入后者即可得到 $M(f)$ 的完整表达式。\n\n**任务3：不动点分析**\n\n系统的长期行为由周期映射 $M(f)$ 的不动点决定。一个不动点 $f^\\ast$ 满足方程 $M(f^\\ast) = f^\\ast$。通过观察 $\\Phi$ 的形式可知，$f=0$ 始终是一个不动点，即 $M(0)=0$。非零不动点必须通过数值求解超越方程 $M(f) - f = 0$ 在 $f \\in (0, 1)$ 范围内的解来找到。\n\n不动点 $f^\\ast$ 的稳定性由映射在该点的导数 $M'(f^\\ast)$ 的大小决定。如果 $|M'(f^\\ast)| < 1$，则不动点是稳定的；如果 $|M'(f^\\ast)| > 1$，则是不稳定的。根据链式法则，$M'(f) = (\\Phi^{\\mathrm{off}})'(\\Phi^{\\mathrm{on}}(f)) \\cdot (\\Phi^{\\mathrm{on}})'(f)$。流映射 $\\Phi_{\\tau}(f_0)$ 的导数为：\n$$\n\\Phi'_{\\tau}(f_0) = \\frac{r^2 e^{r\\tau}}{(r + k f_0 (e^{r\\tau} - 1))^2}\n$$\n平凡不动点 $f^\\ast=0$ 的稳定性由乘子 $\\Lambda_0 = M'(0)$ 决定。在 $f=0$ 处，我们有 $\\Phi'_{\\tau}(0) = e^{r\\tau}$。因此，\n$$\n\\Lambda_0 = M'(0) = e^{r_{\\mathrm{off}}(1-d)T} \\cdot e^{r_{\\mathrm{on}}dT} = \\exp(r_{\\mathrm{on}}dT + r_{\\mathrm{off}}(1-d)T)\n$$\n这证实了问题陈述中提供的表达式。无质粒状态 $f^\\ast=0$ 是稳定的当且仅当 $\\Lambda_0 < 1$。\n\n当系统具有多个稳定状态（吸引子）时，就会出现迟滞现象。在此背景下，它被定义为无质粒状态 $f^\\ast = 0$ 是稳定的（即 $\\Lambda_0 < 1$），并且至少存在一个稳定的非零不动点 $f^\\ast \\in (0,1)$ 与之共存。这种双稳态意味着在吸引子之间存在一个不稳定不动点，它构成了它们吸引盆之间的边界，并充当一个阈值。\n\n**任务4：数值计算策略**\n\n对每个参数集，执行以下数值计算步骤：\n1.  计算系数 $r_{\\mathrm{on}}, k_{\\mathrm{on}}, r_{\\mathrm{off}}, k_{\\mathrm{off}}$。\n2.  使用上述推导的公式定义周期映射 $M(f)$ 及其导数 $M'(f)$ 的函数，并注意处理潜在的数值不稳定性（例如，当 $r$ 接近零时，或指数函数的自变量很大时）。\n3.  计算入侵乘子 $\\Lambda_0 = M'(0)$。\n4.  通过求解 $M(f) - f = 0$ 的根，以数值方式找到在 $(0, 1)$ 内的所有不动点 $f^\\ast$。这通过在 $(0, 1)$ 区间上的一个精细网格上搜索符号变化，并在检测到根的任何区间内使用鲁棒的求根算法（例如 Brent 方法）来完成。\n5.  对找到的每个非零不动点，计算 $M'(f^\\ast)$ 以确定其稳定性。收集在 $(0, 1)$ 内的所有稳定不动点。\n6.  使用不动点集合及其稳定性，根据问题陈述中给出的精确定义，计算所需的输出量（$hysteresis$、$f_{\\mathrm{thr}}$、$f^\\ast$、$\\Lambda_0$、$\\bar{s}$）。\n7.  所有浮点结果都四舍五入到六位小数。最终输出被格式化为指定的列表的列表结构。", "answer": "```\n[[True,0.061763,0.781615,0.802513,0.002000],[False,0.000000,0.880905,3.126915,0.124000],[False,1.000000,0.000000,0.286505,-0.085000],[False,0.000000,0.871795,1.227546,0.011000]]\n```", "id": "2745239"}]}