{"hands_on_practices": [{"introduction": "在合成生物学领域，筛选是防范技术滥用的第一道防线，例如基因合成公司会对订单进行序列筛查。本练习 [@problem_id:2738604] 旨在探讨任何筛查测试背后的基本统计学原理，包括灵敏度 ($s$)、特异性 ($t$) 以及至关重要的“真阳性”基础比率 ($p$)。通过亲手推导阳性预测值和预期误报数，您将深刻理解评估筛查方案有效性的关键，并学会如何在发现真实威胁与处理大量虚假警报之间进行权衡。", "problem": "一家基因合成提供商实施了一套自动化筛选系统，以识别可能涉及伦理、法律和社会影响（ELSI）以及关切的两用研究（DURC）的问题订单。令 $s$ 表示灵敏度（一个真正有问题订单被标记的概率），$t$ 表示特异度（一个真正没有问题的订单未被标记的概率），$p$ 表示所有订单中真正有问题订单的基础比率（流行率）。假设每个订单的结果都根据这些参数独立同分布。\n\n仅使用灵敏度、特异度、基础比率的基本定义以及概率的基本法则，推导出一个精确的解析表达式，用于表示：\n- 阳性预测值（在订单被标记的情况下，该订单确实有问题的概率），以及\n- 在 $10000$ 个被筛选的订单中假警报的期望数量。\n\n将您的最终答案表示为关于 $s$、$t$ 和 $p$ 的精确闭式表达式。不要代入数值。将假警报的期望数表示为 $10000$ 个订单中的一个计数（无单位）。最终答案必须以行矩阵的形式呈现，阳性预测值在前，假警报的期望数量在后。", "solution": "需对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- $s$：灵敏度，一个真正有问题订单被标记的概率。\n- $t$：特异度，一个真正没有问题的订单未被标记的概率。\n- $p$：真正有问题订单的基础比率（流行率）。\n- 被筛选的订单总数为 $10000$。\n- 每个订单是一次独立同分布的试验。\n- 目标是推导以下各项的表达式：\n    1. 阳性预测值（PPV）。\n    2. $10000$ 个订单中假警报的期望数量。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上有其依据，植根于概率论及其在诊断筛选中的应用，这是一个标准的统计学课题。合成生物学和DURC的背景是相关的，且未带来任何科学上的不一致性。这个问题是适定的，提供了推导所求量所需的所有参数（$s$、$t$、$p$）。定义是标准的，语言是客观和精确的。该问题没有违反任何有效性标准。它是基本原理的直接应用。\n\n**步骤 3：结论与行动**\n该问题是**有效的**。将推导解答。\n\n让我们为单个订单定义事件：\n- $C$：订单确实有问题的事件。\n- $C^c$：订单确实没有问题的事件。\n- $F$：订单被筛选系统标记的事件。\n- $F^c$：订单未被筛选系统标记的事件。\n\n根据问题陈述，我们将给定的概率形式化：\n- 有问题订单的基础比率是 $P(C) = p$。\n- 因此，没有问题的订单的概率是 $P(C^c) = 1 - P(C) = 1 - p$。\n- 灵敏度是标记一个有问题订单的概率，即条件概率 $P(F|C) = s$。这是真阳性率。\n- 特异度是不标记一个没有问题订单的概率，即条件概率 $P(F^c|C^c) = t$。这是真阴性率。\n\n根据特异度的定义，我们可以推导出假阳性率，即标记一个没有问题订单的概率：\n$$ P(F|C^c) = 1 - P(F^c|C^c) = 1 - t $$\n\n**1. 阳性预测值（PPV）的推导**\n\n阳性预测值是在一个订单被标记的情况下，该订单确实有问题的概率。这对应于条件概率 $P(C|F)$。我们应用贝叶斯定理：\n$$ P(C|F) = \\frac{P(F|C)P(C)}{P(F)} $$\n分子是一个订单既有问题又被标记的联合概率，$P(F \\cap C)$。我们有 $P(F|C) = s$ 和 $P(C) = p$，所以分子是 $sp$。\n\n分母 $P(F)$ 是一个订单被标记的总概率。我们使用全概率公式计算，对互斥的状态——有问题（$C$）或没有问题（$C^c$）——进行求和：\n$$ P(F) = P(F|C)P(C) + P(F|C^c)P(C^c) $$\n代入我们已经定义的表达式：\n$$ P(F) = (s)(p) + (1-t)(1-p) $$\n现在，我们将分子和分母的表达式代回 PPV 的公式中：\n$$ \\text{PPV} = P(C|F) = \\frac{sp}{sp + (1-t)(1-p)} $$\n这是阳性预测值的最终表达式。\n\n**2. 假警报期望数量的推导**\n\n“假警报”是指一个订单在并非真正有问题（$C^c$）的情况下被标记（$F$）的事件。这对应于联合事件 $F \\cap C^c$。\n单个订单导致假警报的概率，我们称之为 $p_{FA}$，由下式给出：\n$$ p_{FA} = P(F \\cap C^c) $$\n使用条件概率的定义，我们可以将其写为：\n$$ p_{FA} = P(F|C^c)P(C^c) $$\n我们已经确定 $P(F|C^c) = 1-t$ 和 $P(C^c) = 1-p$。因此，单个假警报的概率是：\n$$ p_{FA} = (1-t)(1-p) $$\n设 $N = 10000$ 为被筛选的订单总数。设 $X$ 为代表这 $N$ 个订单中假警报总数的随机变量。我们可以将 $X$ 定义为 $N$ 个独立同分布的伯努利指示变量 $X_i$（$i=1, \\dots, N$）的和。如果订单 $i$ 是一个假警报，则 $X_i=1$，否则 $X_i=0$。\n每次伯努利试验成功的概率是 $P(X_i=1) = p_{FA}$。\n单次试验的期望值是 $E[X_i] = 1 \\cdot P(X_i=1) + 0 \\cdot P(X_i=0) = p_{FA}$。\n根据期望的线性性质，假警报的总期望数量是各个期望值的和：\n$$ E[X] = E\\left[\\sum_{i=1}^{N} X_i\\right] = \\sum_{i=1}^{N} E[X_i] = N \\cdot E[X_1] = N \\cdot p_{FA} $$\n代入 $N = 10000$ 和 $p_{FA}$ 的表达式：\n$$ E[\\text{False Alarms}] = 10000(1-t)(1-p) $$\n这是在 $10000$ 个订单中假警报期望数量的最终表达式。\n两个所求的表达式都已推导得出。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{sp}{sp + (1-t)(1-p)} & 10000(1-t)(1-p)\n\\end{pmatrix}\n}\n$$", "id": "2738604"}, {"introduction": "当研究项目进入实验室阶段，机构生物安全委员会（IBC）需要对各项研究活动的风险进行量化评估和排序。本练习 [@problem_id:2738608] 运用数学期望的基本概念，构建了一个简洁而实用的实验室定量风险评估模型。通过这个实践，您将学会如何汇总来自不同活动的总预期风险，并辨析“总风险贡献”与“边际风险”这两个关键概念，这对于将有限的安全资源配置到最关键环节至关重要。", "problem": "一个在“伦理、法律和社会影响”(ELSI)以及“两用研究关切”(DURC)监督下运作的大学机构生物安全委员会，要求对实验室暴露事件进行定量估计，以便为风险优先级排序提供信息。考虑一个每年进行几类重复性活动的合成生物学实验室。对于每个活动类别，假设每年有 $N_i$ 个独立事件，每个事件都建模为伯努利试验，其导致可报告暴露事件（在所有工程控制和个人防护设备都已就位的情况下）的概率为 $p_i$。假设事件之间和类别之间是独立的，并且可报告的暴露事件是罕见的 ($p_i \\ll 1$)，因此跨类别期望值的可加性是合适的。\n\n四个活动类别是：\n- 活动 A (使用非致病性底盘生物进行液体处理): $N_A = 2.0 \\times 10^{5}$, $p_A = 1.0 \\times 10^{-6}$。\n- 活动 B (在生物安全 2 级控制下，使用减毒载体进行产生气溶胶的操作): $N_B = 3.0 \\times 10^{3}$, $p_B = 8.0 \\times 10^{-6}$。\n- 活动 C (在生物安全 2 级强化措施下，更换带有可气溶胶化垫料的动物笼具): $N_C = 1.5 \\times 10^{3}$, $p_C = 3.0 \\times 10^{-5}$。\n- 活动 D (准备重组 DNA 货运): $N_D = 8.0 \\times 10^{2}$, $p_D = 2.0 \\times 10^{-6}$。\n\n将年度预期暴露事件数定义为 $E$，并将活动类别 $i$ 的边际风险定义为在保持其他 $N_j$ 固定的情况下计算的偏导数 $\\partial E / \\partial N_i$。\n\n计算该实验室的年度预期暴露事件数 $E$，并确定在此模型下哪个单一活动类别具有最高的边际风险。以每年事件数表示 $E$，并将您的数值结果四舍五入到 $4$ 位有效数字。您提交的最终答案必须仅为 $E$ 的数值，单位为每年事件数（请勿在框中包含单位）。", "solution": "首先将对问题进行严格验证，以确保其科学上合理、内容自洽且提法得当。\n\n**步骤1：提取给定条件**\n问题陈述中提供了以下数据和定义：\n-   一个针对合成生物学实验室中四种活动类别的暴露事件模型。\n-   每个事件都是伯努利试验，事件发生的概率为 $p_i$。\n-   活动 A 每年事件数：$N_A = 2.0 \\times 10^{5}$。\n-   活动 A 事件概率：$p_A = 1.0 \\times 10^{-6}$。\n-   活动 B 每年事件数：$N_B = 3.0 \\times 10^{3}$。\n-   活动 B 事件概率：$p_B = 8.0 \\times 10^{-6}$。\n-   活动 C 每年事件数：$N_C = 1.5 \\times 10^{3}$。\n-   活动 C 事件概率：$p_C = 3.0 \\times 10^{-5}$。\n-   活动 D 每年事件数：$N_D = 8.0 \\times 10^{2}$。\n-   活动 D 事件概率：$p_D = 2.0 \\times 10^{-6}$。\n-   假设：事件和类别是独立的。\n-   假设：概率很小（$p_i \\ll 1$），证明了期望值可加的合理性。\n-   定义：$E$ 是年度预期暴露事件数。\n-   定义：活动类别 $i$ 的边际风险是 $\\frac{\\partial E}{\\partial N_i}$。\n-   目标1：计算 $E$ 并四舍五入到 $4$ 位有效数字。\n-   目标2：确定哪个活动类别具有最高的边际风险。\n\n**步骤2：使用提取的给定条件进行验证**\n根据验证标准对问题进行评估：\n1.  **科学或事实不健全**：问题在科学上是健全的。它采用了一个标准的概率模型（伯努利试验、期望值），并将其应用于生物安全领域中一个现实的风险评估场景。ELSI 和 DURC 监督的背景对于合成生物学是合适的。\n2.  **不可形式化或不相关**：问题可以使用基础概率论和微积分进行形式化。它与指定领域内的定量风险评估主题直接相关。\n3.  **设置不完整或矛盾**：问题是自洽的。所有必要的数值（$N_i$，$p_i$）和定义都已提供。没有矛盾之处。\n4.  **不切实际或不可行**：所提供的数据对于一个大型研究机构来说是合理的。高事件计数（$N_i$）与低事件概率（$p_i$）相结合是已实施安全控制的常规实验室程序的特点。\n5.  **提法不当或结构不良**：问题提法得当。上述模型和数据允许计算出 $E$ 的唯一值，并明确确定最高的边际风险。\n6.  **伪深刻、琐碎或同义反复**：问题并非琐碎。它要求将数学期望和微分学的概念正确应用于一个实际场景。\n7.  **超出科学可验证性**：计算过程在数学上是可验证的。\n\n**步骤3：结论与行动**\n问题是**有效的**。这是一个将概率论直接应用于定量风险评估问题的案例。将提供解答。\n\n**解题推导**\n对于每个活动类别 $i$，每年的事件数是一个随机变量，我们称之为 $X_i$。由于 $N_i$ 个事件中的每一个都是成功概率为 $p_i$ 的独立伯努利试验，随机变量 $X_i$ 服从二项分布，$X_i \\sim \\text{Binomial}(N_i, p_i)$。\n\n单个类别 $i$ 的预期事件数由其二项分布的期望值给出：\n$$E[X_i] = N_i p_i$$\n\n年度总预期事件数 $E$ 是每个类别期望值的总和。这是期望算子线性性质的直接结果，无论随机变量是否独立，该性质都成立。\n$$E = E[X_A + X_B + X_C + X_D] = E[X_A] + E[X_B] + E[X_C] + E[X_D]$$\n因此，$E$ 的表达式为：\n$$E = N_A p_A + N_B p_B + N_C p_C + N_D p_D$$\n\n我们现在代入给定的数值来计算 $E$。\n对于活动 A：\n$$E_A = N_A p_A = (2.0 \\times 10^{5}) \\times (1.0 \\times 10^{-6}) = 0.2$$\n对于活动 B：\n$$E_B = N_B p_B = (3.0 \\times 10^{3}) \\times (8.0 \\times 10^{-6}) = 24.0 \\times 10^{-3} = 0.024$$\n对于活动 C：\n$$E_C = N_C p_C = (1.5 \\times 10^{3}) \\times (3.0 \\times 10^{-5}) = 4.5 \\times 10^{-2} = 0.045$$\n对于活动 D：\n$$E_D = N_D p_D = (8.0 \\times 10^{2}) \\times (2.0 \\times 10^{-6}) = 1.6 \\times 10^{-3} = 0.0016$$\n\n年度总预期事件数是这些值的总和：\n$$E = E_A + E_B + E_C + E_D = 0.2 + 0.024 + 0.045 + 0.0016 = 0.2706$$\n问题要求将此结果四舍五入到 $4$ 位有效数字。计算出的值 $0.2706$ 已经恰好有 $4$ 位有效数字。\n\n接下来，我们确定具有最高边际风险的活动类别。类别 $i$ 的边际风险定义为总期望 $E$ 相对于事件数 $N_i$ 的偏导数：\n$$\\text{Marginal Risk}_i = \\frac{\\partial E}{\\partial N_i}$$\n使用 $E$ 的表达式：\n$$\\frac{\\partial E}{\\partial N_i} = \\frac{\\partial}{\\partial N_i} (N_A p_A + N_B p_B + N_C p_C + N_D p_D)$$\n由于各项是可加的，并且对于 $j \\neq i$ 的 $N_j$ 保持不变，导数简化为：\n$$\\frac{\\partial E}{\\partial N_i} = p_i$$\n这个结果是合乎逻辑的：边际风险，即给定类别再增加一个事件所增加的预期事件数，就是该事件类型的事件概率。\n\n为了找到边际风险最高的类别，我们必须比较概率 $p_i$：\n-   $p_A = 1.0 \\times 10^{-6}$\n-   $p_B = 8.0 \\times 10^{-6}$\n-   $p_C = 3.0 \\times 10^{-5} = 30.0 \\times 10^{-6}$\n-   $p_D = 2.0 \\times 10^{-6}$\n\n通过比较，$p_C$ 是最大值。\n$$30.0 \\times 10^{-6} > 8.0 \\times 10^{-6} > 2.0 \\times 10^{-6} > 1.0 \\times 10^{-6}$$\n因此，活动类别 C 具有最高的边际风险。\n\n问题要求提供一个最终答案：$E$ 的数值。\n计算出的值为 $E = 0.2706$。", "answer": "$$\\boxed{0.2706}$$", "id": "2738608"}, {"introduction": "针对高风险研究，我们常采用基因生物遏制等工程化安全措施，但这些系统并非完美无缺，其自身也可能带来成本或次生风险。本练习 [@problem_id:2738528] 构建了一个典型的风险-效益权衡模型，其中包含了遏制系统的有效性 ($\\eta$)、失效率 ($f$) 乃至其引入的次生风险 ($r_c$)。通过推导出一个安全系统能够实现“有意义的风险降低”所需的性能阈值，您将掌握一套评估新型安全技术的量化框架，从而能够严谨地分析一项控制措施的利弊得失。", "problem": "一个开发工程微生物的大学研究小组，根据伦理、法律和社会影响（ELSI）审查和两用研究关切（DURC）政策的要求，需要量化在添加基因生物遏制系统时的风险变化。采用“预期损害等于概率乘以后果”的标准风险定义，并假设不同损害路径相互独立，且期望值在其上具有线性关系。设基线预期损害由单一主导路径确定，其年环境定植概率为 $p_{\\mathrm{est}}$，社会损害量为 $H$（以美元计），因此在没有基因生物遏制的情况下，年预期损害为 $E_{0} = H \\, p_{\\mathrm{est}}$。该基因生物遏制系统具有两个特性：(i) 如果它在逃逸事件中起作用，它会以乘法方式将定植概率降低一个分数 $\\eta$（因此定植概率被缩放为 $(1-\\eta)$）；(ii) 它在逃逸事件中失效的概率为 $f$，且与其他事件独立。此外，添加生物遏制系统会通过与基线定植途径无关的次要路径，引入一个独立的、与遏制相关的年预期损害 $r_{c}$（例如，因增加监视和合规负担而产生的虽小但非零的社会成本）。\n将预期损害的“有意义的降低”定义为相对于基线至少实现分数 $\\beta$ 的降低，即实现的年预期损害不大于 $(1-\\beta) E_{0}$。仅使用上述定义，从第一性原理出发推导出阈值失效概率 $f^{\\star}$ 的表达式，使得任何严格小于 $f^{\\star}$ 的 $f$ 都能实现有意义的降低。然后，使用以下参数计算 $f^{\\star}$：$p_{\\mathrm{est}} = 3.0 \\times 10^{-7}$ 每年，$H = 3.0 \\times 10^{8}$ 美元，$\\eta = 0.60$，$r_{c} = 9.0$ 美元每年，以及 $\\beta = 0.25$。将 $f^{\\star}$ 的最终数值答案四舍五入到三位有效数字。将答案表示为一个无单位的纯数。", "solution": "问题陈述已经过验证，并被认定为有效。这是一个在定量风险评估领域中自洽、一致且有科学依据的问题，它借鉴了概率论的基本原理。没有可识别的缺陷；该问题是适定且客观的。\n\n任务是推导基因生物遏制系统阈值失效概率 $f^{\\star}$ 的表达式，然后计算其数值。如果带有该系统的年预期损害（记为 $E_{\\text{new}}$）比基线年预期损害 $E_{0}$ 至少小一个分数 $\\beta$，则实现了有意义的风险降低。\n\n首先，我们定义给定的基线年预期损害 $E_{0}$：\n$$E_{0} = H \\, p_{\\mathrm{est}}$$\n其中 $p_{\\mathrm{est}}$ 是年环境定植概率，$H$ 是社会损害的量级。\n\n接下来，我们构建实施生物遏制系统后的总年预期损害 $E_{\\text{new}}$ 的表达式。总预期损害是所有不同损害路径的期望之和。\n该系统由一个失效概率 $f$ 和一个效能 $\\eta$ 来表征。对于原始损害路径，存在两种情景：\n1. 生物遏制系统失效。这种情况发生的概率为 $f$。在这种情况下，定植概率仍然是 $p_{\\mathrm{est}}$，来自此事件分支的相应预期损害为 $(H \\, p_{\\mathrm{est}}) \\cdot f = E_{0} f$。\n2. 生物遏制系统正常工作。这种情况发生的概率为 $(1-f)$。定植概率降低一个因子 $\\eta$，变为 $p_{\\mathrm{est}}(1-\\eta)$。来自此分支的预期损害为 $(H \\, p_{\\mathrm{est}}(1-\\eta)) \\cdot (1-f) = E_{0}(1-\\eta)(1-f)$。\n\n除了被修改的原始路径外，还引入了一个新的、独立的损害路径，每年贡献一个恒定的预期损害 $r_c$。\n\n根据期望的线性性质，新的总年预期损害 $E_{\\text{new}}$ 是这些组成部分之和：\n$$E_{\\text{new}} = E_{0} f + E_{0}(1-\\eta)(1-f) + r_{c}$$\n我们可以简化这个表达式：\n$$E_{\\text{new}} = E_{0} f + E_{0}(1 - f - \\eta + \\eta f) + r_{c}$$\n$$E_{\\text{new}} = E_{0} f + E_{0} - E_{0} f - E_{0}\\eta + E_{0}\\eta f + r_{c}$$\n$$E_{\\text{new}} = E_{0}(1-\\eta) + E_{0}\\eta f + r_{c}$$\n这个表达式表示了总年预期损害作为失效概率 $f$ 的函数。\n\n损害“有意义的降低”的条件是，新的预期损害不大于基线损害的 $(1-\\beta)$ 倍：\n$$E_{\\text{new}} \\le (1-\\beta) E_{0}$$\n问题要求的是阈值 $f^{\\star}$，使得任何严格小于 $f^{\\star}$ 的失效概率 $f$ 都满足此条件。这意味着我们必须求解不等式：\n$$E_{\\text{new}} < (1-\\beta) E_{0}$$\n代入我们关于 $E_{\\text{new}}$ 的表达式：\n$$E_{0}(1-\\eta) + E_{0}\\eta f + r_{c} < (1-\\beta) E_{0}$$\n我们现在求解这个关于 $f$ 的不等式：\n$$E_{0}\\eta f < (1-\\beta) E_{0} - E_{0}(1-\\eta) - r_{c}$$\n$$E_{0}\\eta f < E_{0} - \\beta E_{0} - E_{0} + \\eta E_{0} - r_{c}$$\n$$E_{0}\\eta f < \\eta E_{0} - \\beta E_{0} - r_{c}$$\n假设 $\\eta E_{0} > 0$，这是成立的，因为 $H, p_{\\mathrm{est}}, \\eta$ 都是正实数，我们可以除以 $\\eta E_{0}$ 而不改变不等号的方向：\n$$f < \\frac{\\eta E_{0} - \\beta E_{0} - r_{c}}{\\eta E_{0}}$$\n$$f < 1 - \\frac{\\beta E_{0} + r_{c}}{\\eta E_{0}}$$\n因此，阈值 $f^{\\star}$ 是此区间的上界：\n$$f^{\\star} = 1 - \\frac{\\beta E_{0} + r_{c}}{\\eta E_{0}}$$\n代入 $E_{0} = H p_{\\mathrm{est}}$，我们得到完整的解析表达式：\n$$f^{\\star} = 1 - \\frac{\\beta H p_{\\mathrm{est}} + r_{c}}{\\eta H p_{\\mathrm{est}}}$$\n现在，我们使用给定的参数计算 $f^{\\star}$ 的数值：\n$p_{\\mathrm{est}} = 3.0 \\times 10^{-7}$\n$H = 3.0 \\times 10^{8}$\n$\\eta = 0.60$\n$r_{c} = 9.0$\n$\\beta = 0.25$\n\n首先，我们计算基线预期损害 $E_{0}$：\n$$E_{0} = H p_{\\mathrm{est}} = (3.0 \\times 10^{8}) \\cdot (3.0 \\times 10^{-7}) = 9.0 \\times 10^{1} = 90.0$$\n单位是美元/年，但在计算无量纲量 $f^{\\star}$ 时不需要。\n\n接下来，我们将 $E_{0}$ 和其他参数代入 $f^{\\star}$ 的表达式中：\n$$f^{\\star} = 1 - \\frac{(0.25)(90.0) + 9.0}{(0.60)(90.0)}$$\n$$f^{\\star} = 1 - \\frac{22.5 + 9.0}{54.0}$$\n$$f^{\\star} = 1 - \\frac{31.5}{54.0}$$\n该分数可简化为：\n$$\\frac{31.5}{54.0} = \\frac{315}{540} = \\frac{63 \\times 5}{108 \\times 5} = \\frac{63}{108} = \\frac{7 \\times 9}{12 \\times 9} = \\frac{7}{12}$$\n所以，我们有：\n$$f^{\\star} = 1 - \\frac{7}{12} = \\frac{5}{12}$$\n将此分数转换为小数：\n$$f^{\\star} = \\frac{5}{12} \\approx 0.41666...$$\n按要求四舍五入到三位有效数字：\n$$f^{\\star} \\approx 0.417$$\n这就是阈值失效概率。对于任何 $f < 0.417$ 的情况，该生物遏制系统都能提供有意义的风险降低。", "answer": "$$\\boxed{0.417}$$", "id": "2738528"}]}