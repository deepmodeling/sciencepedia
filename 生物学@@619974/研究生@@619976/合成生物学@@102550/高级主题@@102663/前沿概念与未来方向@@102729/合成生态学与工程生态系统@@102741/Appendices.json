{"hands_on_practices": [{"introduction": "在合成生态学中，一个基本问题是预测不同工程菌株在资源有限的环境中如何相互作用。恒化器（chemostat）是研究微生物竞争的理想模型系统。本练习将指导您应用资源竞争理论的基石——$R^\\ast$ 原理，通过分析两种菌株的 Monod 生长动力学，来确定哪一种菌株将在单一限制性底物的竞争中胜出 [@problem_id:2779692]。这个练习将加深您对微生物生长、资源消耗和竞争排斥原则之间定量关系的理解。", "problem": "在一个以恒定稀释速率运行的恒定体积的连续搅拌釜式生物反应器（恒化器）中，两种工程菌株为一个以固定流入浓度供应的单一限制性底物进行竞争。每个菌株的净生长速率都遵循带有明确维持项的Monod动力学。设底物浓度为 $S$，稀释速率为 $D$。对于菌株 $i \\in \\{A,B\\}$，其比生长速率为 $\\mu_{i}(S) = \\mu_{i,\\max}\\,\\dfrac{S}{K_{i} + S}$，净生长速率为 $\\mu_{i}(S) - m_{i}$，其中 $\\mu_{i,\\max}$ 是最大比生长速率，$K_{i}$ 是半饱和常数，$m_{i}$ 是维持（内源性损失）速率。恒化器中每种菌株的生物量动态由良好混合的流通式反应器的标准质量平衡所控制。流入底物浓度为 $S_{\\mathrm{in}}$。\n\n您被给予以下参数（所有速率单位为 $\\mathrm{h}^{-1}$，所有浓度单位为 $\\mathrm{mg}\\,\\mathrm{L}^{-1}$）：\n- 稀释速率：$D = 0.18$。\n- 流入底物浓度：$S_{\\mathrm{in}} = 12$。\n- 菌株 $A$：$\\mu_{A,\\max} = 0.62$，$K_{A} = 0.015$，$m_{A} = 0.03$。\n- 菌株 $B$：$\\mu_{B,\\max} = 0.44$，$K_{B} = 0.004$，$m_{B} = 0.01$。\n\n从恒化器质量平衡原理和持存种群在稳态时净生长为零的定义出发，推导出每个菌株 $i$ 的资源需求 $R_{i}^{\\ast}$，即其净生长速率恰好与稀释损失相平衡时的底物浓度。使用所给参数计算 $R_{A}^{\\ast}$ 和 $R_{B}^{\\ast}$。假设在单一限制性资源上发生竞争排斥，并且 $S_{\\mathrm{in}}$ 允许至少一个菌株存活，确定在这两种菌株的长期竞争下，恒化器将收敛到的唯一稳态底物浓度 $S^{\\ast}$。\n\n以 $\\mathrm{mg}\\,\\mathrm{L}^{-1}$ 为单位，将你的最终答案表示为 $S^{\\ast}$ 的数值，并四舍五入到四位有效数字。", "solution": "所提出的问题在科学上是合理的，设定良好，且无矛盾。所有必要的参数都已提供，以确定两种微生物菌株在恒化器中为单一限制性资源竞争的结果。该框架依赖于微生物生态学和生物反应器工程的既定原理，特别是Monod生长模型和资源竞争理论（$R^{\\ast}$理论）。因此，该问题是有效的，并且可以推导出严谨的解。\n\n在稀释速率为 $D$ 的恒化器中，生物量浓度为 $X_i$ 的微生物种群动态由质量平衡方程描述：\n$$\n\\frac{dX_i}{dt} = (\\text{净比生长速率}) \\cdot X_i - (\\text{稀释速率}) \\cdot X_i\n$$\n问题指明，菌株 $i$ 的净比生长速率是其比生长速率 $\\mu_i(S)$ 减去一个维持项 $m_i$。因此，菌株 $i \\in \\{A, B\\}$ 的生物量动态由下式给出：\n$$\n\\frac{dX_i}{dt} = (\\mu_i(S) - m_i - D) X_i\n$$\n其中 $S$ 是限制性底物的浓度。\n\n为了使一个菌株能在恒化器中以非平凡稳态（即 $X_i^{\\ast} > 0$）持续存在，其种群不能被洗出。这要求其生物量的变化率为零，即 $\\frac{dX_i}{dt} = 0$。由于 $X_i^{\\ast} > 0$，这意味着括号中的项必须为零：\n$$\n\\mu_i(S^{\\ast}) - m_i - D = 0\n$$\n这个方程定义了如果一个菌株在单一培养中生长，它将在恒化器中维持的稳态底物浓度 $S^{\\ast}$。这个浓度就是该菌株的资源需求，记为 $R_i^{\\ast}$。因此，$R_i^{\\ast}$ 的定义是满足以下条件的底物浓度 $S$：\n$$\n\\mu_i(R_i^{\\ast}) = D + m_i\n$$\n比生长速率 $\\mu_i(S)$ 由Monod方程给出：$\\mu_i(S) = \\mu_{i,\\max} \\frac{S}{K_i + S}$。将此代入稳态条件得到：\n$$\n\\mu_{i,\\max} \\frac{R_i^{\\ast}}{K_i + R_i^{\\ast}} = D + m_i\n$$\n为了解出 $R_i^{\\ast}$，我们进行代数变换：\n$$\n\\frac{R_i^{\\ast}}{K_i + R_i^{\\ast}} = \\frac{D + m_i}{\\mu_{i,\\max}}\n$$\n$$\n\\mu_{i,\\max} R_i^{\\ast} = (D + m_i)(K_i + R_i^{\\ast})\n$$\n$$\n\\mu_{i,\\max} R_i^{\\ast} = (D + m_i)K_i + (D + m_i)R_i^{\\ast}\n$$\n$$\nR_i^{\\ast} (\\mu_{i,\\max} - (D + m_i)) = (D + m_i)K_i\n$$\n这就得出了资源需求 $R_i^{\\ast}$ 的显式表达式：\n$$\nR_i^{\\ast} = \\frac{(D + m_i)K_i}{\\mu_{i,\\max} - D - m_i}\n$$\n为了使一个种群能在稀释速率 $D$ 下持续存在，其最大净生长速率必须超过 $D$，即 $\\mu_{i,\\max} - m_i > D$，这保证了分母为正。\n\n现在我们使用所给参数计算 $R_A^{\\ast}$ 和 $R_B^{\\ast}$：\n$D = 0.18\\,\\mathrm{h}^{-1}$，$S_{\\mathrm{in}} = 12\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}$。\n对于菌株 A：$\\mu_{A,\\max} = 0.62\\,\\mathrm{h}^{-1}$，$K_{A} = 0.015\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}$，$m_{A} = 0.03\\,\\mathrm{h}^{-1}$。\n$$\nR_A^{\\ast} = \\frac{(0.18 + 0.03) \\cdot 0.015}{0.62 - 0.18 - 0.03} = \\frac{0.21 \\cdot 0.015}{0.41} = \\frac{0.00315}{0.41} \\approx 0.0076829\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}\n$$\n对于菌株 B：$\\mu_{B,\\max} = 0.44\\,\\mathrm{h}^{-1}$，$K_{B} = 0.004\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}$，$m_{B} = 0.01\\,\\mathrm{h}^{-1}$。\n$$\nR_B^{\\ast} = \\frac{(0.18 + 0.01) \\cdot 0.004}{0.44 - 0.18 - 0.01} = \\frac{0.19 \\cdot 0.004}{0.25} = \\frac{0.00076}{0.25} = 0.00304\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}\n$$\n竞争排斥原理（$R^{\\ast}$理论）指出，当两个或多个物种为单一限制性资源竞争时，能够在最低资源浓度下生存并因此将资源浓度降低至该水平的物种，将通过竞争排斥所有其他物种。获胜的竞争者是具有最小 $R^{\\ast}$ 值的那个。\n\n比较两个资源需求：\n$$\nR_B^{\\ast} = 0.00304\\,\\mathrm{mg}\\,\\mathrm{L}^{-1} \\quad < \\quad R_A^{\\ast} \\approx 0.00768\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}\n$$\n由于 $R_B^{\\ast} < R_A^{\\ast}$，菌株 B 是优势竞争者。在恒化器的长期竞争中，菌株 B 将胜过菌株 A。菌株 B 的种群将会增长，消耗底物，直到将底物浓度降低到其自身的收支平衡水平 $R_B^{\\ast}$。在此底物水平下，菌株 B 的净生长速率与其被洗出的速率相平衡。对于菌株 A，由于底物浓度 $R_B^{\\ast}$ 低于其自身的收支平衡需求 $R_A^{\\ast}$，其净生长速率将为负（$\\mu_A(R_B^{\\ast}) - m_A - D < 0$），因此它将被从系统中洗出。\n\n因此，在两种菌株都存在的情况下，恒化器中唯一的稳态底物浓度 $S^{\\ast}$ 将由获胜的竞争者——菌株 B 决定。\n$$\nS^{\\ast} = R_B^{\\ast} = 0.00304\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}\n$$\n问题指明 $S_{\\mathrm{in}}$ 足以维持生存，这一点得到了确认，因为 $S^{\\ast} = 0.00304\\,\\mathrm{mg}\\,\\mathrm{L}^{-1} < S_{\\mathrm{in}} = 12\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}$。\n\n最终答案必须四舍五入到四位有效数字。计算出的值为 0.00304。为了用四位有效数字表示，我们在末尾加一个零。\n$$\nS^{\\ast} = 0.003040\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}\n$$", "answer": "$$\n\\boxed{0.003040}\n$$", "id": "2779692"}, {"introduction": "种群水平的动态最终是由细胞内的代谢活动驱动的。为了更深入地设计和优化合成生态系统，我们必须考虑其成员的代谢网络。通量平衡分析 (Flux Balance Analysis, FBA) 是一种强大的约束优化方法，用于在稳态假设下预测代谢通量。在本练习中，您将把 FBA 应用于一个群落尺度的模型，通过求解一个线性规划问题来最大化总生物量，并识别限制系统性能的“瓶颈”交换反应 [@problem_id:2779666]。这项实践对于理解如何通过靶向性地修改资源供应来提升工程生态系统的生产力至关重要。", "problem": "在通量平衡分析（FBA）范式下，给定一个双种群合成生态系统的群落尺度线性稳态代谢模型。该模型假设细胞内代谢物浓度处于准稳态，因此质量平衡作为一个线性约束成立。令 $S \\in \\mathbb{R}^{m \\times n}$ 为化学计量矩阵，$v \\in \\mathbb{R}^{n}$ 为反应通量向量。稳态约束为 $S v = 0$，以及逐个反应的下界和上界 $l \\le v \\le u$。群落目标是一个需要被最大化的线性函数 $c^{\\top} v$。交换反应是任何介导群落与外部区室之间质量传递的反应，并受有限边界的约束。\n\n您的任务是：\n- 对于每个测试用例，计算在约束 $S v = 0$ 和 $l \\le v \\le u$ 下使 $c^{\\top} v$ 最大化的最优通量向量 $v^{\\star}$。\n- 根据以下操作性定义，识别限制性交换反应：一个交换反应索引 $j$ 是限制性的，如果 (i) 其对应的边界在最优点处是活跃的，即对于给定的容差 $\\tau$，满足 $|v^{\\star}_j - l_j| \\le \\tau$ 或 $|v^{\\star}_j - u_j| \\le \\tau$，并且 (ii) 当通过有限差分灵敏度量化时，将该活跃边界沿着扩大可行性的方向放宽一个微小量 $\\epsilon$，使得最优目标值的增加量严格大于一个斜率阈值 $\\sigma$，即\n$$\n\\frac{c^{\\top} v^{\\star}(\\text{perturbed}) - c^{\\top} v^{\\star}}{\\epsilon} > \\sigma,\n$$\n其中 $v^{\\star}(\\text{perturbed})$ 是在将活跃边界沿着扩大方向扰动 $\\epsilon$ 后重新优化的通量向量。\n\n基本公式：\n- 稳态质量平衡：$S v = 0$。\n- 线性反应边界：$l \\le v \\le u$。\n- 线性群落目标：最大化 $c^{\\top} v$。\n- 交换反应：具有有限边界、与外部区室交互的一部分反应。\n\n反应排序与解释（所有测试通用）：\n- 反应排序为 $[r_0, r_1, r_2, r_3, r_4]$，其中：\n    - $r_0$：向共享外部池供应外部底物（交换）。\n    - $r_1$：种群 A 吸收共享外部底物（跨区室交换）。\n    - $r_2$：种群 A 的生物质生成。\n    - $r_3$：种群 B 吸收共享外部底物（跨区室交换）。\n    - $r_4$：种群 B 的生物质生成。\n- 代谢物排序为 $[E, S_A, S_B]$，其中 $E$是共享外部池，$S_A$ 和 $S_B$ 分别是种群 A 和 B 的内部底物。\n- 化学计量矩阵具有以下结构\n$$\nS =\n\\begin{bmatrix}\n+1 & -1 & 0 & -1 & 0 \\\\\n0 & +1 & -\\alpha_A & 0 & 0 \\\\\n0 & 0 & 0 & +1 & -\\alpha_B\n\\end{bmatrix},\n$$\n其中产率参数 $\\alpha_A > 0$ 和 $\\alpha_B > 0$。所有通量的下界均被约束为非负，因此 $l = \\mathbf{0}$。\n\n目标：\n- 最大化生物质生成通量之和：\n$$\nc = \\begin{bmatrix} 0 & 0 & 1 & 0 & 1 \\end{bmatrix}^{\\top}.\n$$\n\n需要评估限制性的交换反应索引：\n- $\\mathcal{E} = \\{0, 1, 3\\}$。\n\n活跃边界容差、扰动幅度和斜率阈值：\n- 使用 $\\tau = 10^{-7}$，$\\epsilon = 10^{-4}$ 和 $\\sigma = 10^{-6}$。\n\n测试套件：\n- 有 $3$ 个独立的测试用例。对于每个用例，所有量都是无量纲的，应被视为没有物理单位的纯数。\n    1. 测试 $1$：\n        - 参数：$\\alpha_A = 1$，$\\alpha_B = 2$。\n        - 化学计量：\n        $$\n        S^{(1)} =\n        \\begin{bmatrix}\n        1 & -1 & 0 & -1 & 0 \\\\\n        0 & 1 & -1 & 0 & 0 \\\\\n        0 & 0 & 0 & 1 & -2\n        \\end{bmatrix}.\n        $$\n        - 边界 $l^{(1)} = \\begin{bmatrix} 0 & 0 & 0 & 0 & 0 \\end{bmatrix}^{\\top}$，$u^{(1)} = \\begin{bmatrix} 10 & 10^6 & 6 & 10^6 & 10^6 \\end{bmatrix}^{\\top}$。\n    2. 测试 $2$：\n        - 参数：$\\alpha_A = 1.5$，$\\alpha_B = 1$。\n        - 化学计量：\n        $$\n        S^{(2)} =\n        \\begin{bmatrix}\n        1 & -1 & 0 & -1 & 0 \\\\\n        0 & 1 & -1.5 & 0 & 0 \\\\\n        0 & 0 & 0 & 1 & -1\n        \\end{bmatrix}.\n        $$\n        - 边界 $l^{(2)} = \\begin{bmatrix} 0 & 0 & 0 & 0 & 0 \\end{bmatrix}^{\\top}$，$u^{(2)} = \\begin{bmatrix} 100 & 10^6 & 3 & 10^6 & 2 \\end{bmatrix}^{\\top}$。\n    3. 测试 $3$：\n        - 参数：$\\alpha_A = 1$，$\\alpha_B = 2$。\n        - 化学计量：\n        $$\n        S^{(3)} =\n        \\begin{bmatrix}\n        1 & -1 & 0 & -1 & 0 \\\\\n        0 & 1 & -1 & 0 & 0 \\\\\n        0 & 0 & 0 & 1 & -2\n        \\end{bmatrix}.\n        $$\n        - 边界 $l^{(3)} = \\begin{bmatrix} 0 & 0 & 0 & 0 & 0 \\end{bmatrix}^{\\top}$，$u^{(3)} = \\begin{bmatrix} 8 & 5 & 10^6 & 10^6 & 10^6 \\end{bmatrix}^{\\top}$。\n\n每个测试用例所需的结果：\n- 计算最优目标值 $c^{\\top} v^{\\star}$。\n- 使用上述定义，从 $\\mathcal{E}$ 中识别出限制性交换反应索引的集合。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个测试用例的结果，格式为逗号分隔的 Python 风格列表。每个测试用例的结果是一个形式为 $[o, L]$ 的双元素列表，其中 $o$ 是四舍五入到恰好 $6$ 位小数的最优目标值，$L$ 是一个按非递减顺序排列的整数组成的 Python 风格列表，代表限制性交换反应索引。例如，一个有效的最终输出可能看起来像 $[[o_1,[\\dots]],[o_2,[\\dots]],[o_3,[\\dots]]]$，其中每个 $o_k$ 都四舍五入到 $6$ 位小数。", "solution": "所提出的问题是通量平衡分析（FBA）在一个双物种合成微生物生态系统中的一个明确定义的应用。核心任务是求解一个线性规划（LP）问题，以找到最大化群落级目标的最优通量分布，并随后确定哪些外部资源约束正在限制这一最优性能。该公式在科学上是合理的，在数学上是一致的。我们将进行严谨的、分步的求解。\n\n该问题被构建为一个标准的线性规划问题：\n$$\n\\text{最大化 } Z = c^{\\top} v\n$$\n$$\n\\text{约束条件 } S v = 0\n$$\n$$\nl \\le v \\le u\n$$\n其中 $v \\in \\mathbb{R}^n$ 是反应通量向量，$c \\in \\mathbb{R}^n$ 是目标向量，$S \\in \\mathbb{R}^{m \\times n}$ 是化学计量矩阵，$l, u \\in \\mathbb{R}^n$ 分别是通量的下界和上界。目标是最大化总生物质生成量 $Z = v_2 + v_4$，因此目标向量是 $c = [0, 0, 1, 0, 1]^{\\top}$。\n\n这个最大化问题将使用数值 LP 求解器进行计算求解。标准求解器是为最小化问题制定的；因此，我们将等价地最小化 $-Z = (-c)^{\\top} v$。\n\n问题的关键部分是识别“限制性”交换反应。一个交换反应 $j \\in \\mathcal{E}=\\{0, 1, 3\\}$ 被定义为限制性的，如果满足两个条件：\n1.  其在最优点处的通量 $v^{\\star}_j$ 位于其边界之一，即对于容差 $\\tau = 10^{-7}$，满足 $|v^{\\star}_j - l_j| \\le \\tau$ 或 $|v^{\\star}_j - u_j| \\le \\tau$。\n2.  将此活跃边界沿着扩大可行空间的方向放宽一个微小量 $\\epsilon = 10^{-4}$，会导致目标函数严格且显著的增加。计算出的灵敏度 $\\frac{\\Delta Z^{\\star}}{\\epsilon}$ 必须大于阈值 $\\sigma = 10^{-6}$。\n\n需要澄清的一点是：问题陈述所有下界均为零，$l=\\mathbf{0}$，这意味着所有通量都是不可逆的。在这种情况下，通量处于其零下界（$v^{\\star}_j \\approx 0$）意味着相应的反应未被使用。这并不代表消耗资源瓶颈意义上的限制因素。真正的瓶颈发生在资源被最大化利用时，这对应于通量处于其*上界*。因此，我们的分析将正确地把“限制性”解释为仅适用于其通量在最优点处活跃于其上界的交换反应。\n\n我们现在分析每个测试用例。\n\n**测试用例 1**\n- 参数：$\\alpha_A = 1$，$\\alpha_B = 2$。\n- 化学计量：$S^{(1)} = \\begin{bmatrix} 1 & -1 & 0 & -1 & 0 \\\\ 0 & 1 & -1 & 0 & 0 \\\\ 0 & 0 & 0 & 1 & -2 \\end{bmatrix}$。\n- 边界：$l^{(1)} = \\mathbf{0}$，$u^{(1)} = \\begin{bmatrix} 10 & 10^6 & 6 & 10^6 & 10^6 \\end{bmatrix}^{\\top}$。\n\n系统动力学由以下公式描述：\n$v_0 = v_1 + v_3$\n$v_1 = v_2$\n$v_3 = 2v_4$\n\n单位底物的生物质产率对于物种 A 是 $1/\\alpha_A = 1$，对于物种 B 是 $1/\\alpha_B = 0.5$。物种 A 效率更高。为了最大化总生物质 $Z = v_2 + v_4$，我们应该优先将底物分配给物种 A。\n\n通量的约束条件是：\n$v_0 \\le 10$\n$v_2 \\le 6 \\implies v_1 \\le 6$\n$v_1 + v_3 \\le 10$\n\n我们尽可能多地将底物分配给物种 A，直到其极限。$v_1$ 的最大通量由其自身的生物质生成极限决定，$v_1 = v_2 \\le 6$。我们设定 $v^{\\star}_1 = 6$，这意味着 $v^{\\star}_2 = 6$。\n剩余的底物容量可以分配给物种 B。使用的总底物是 $v_1 + v_3$，受限于 $v_0 \\le 10$。因此，$6 + v_3 \\le 10 \\implies v_3 \\le 4$。我们设定 $v^{\\star}_3 = 4$。\n这得到 $v^{\\star}_4 = v_3/2 = 2$。\n所需的总底物供应量为 $v^{\\star}_0 = v^{\\star}_1 + v^{\\star}_3 = 6 + 4 = 10$。\n最优通量向量为 $v^{\\star} = [10, 6, 6, 4, 2]^{\\top}$。\n最优目标值为 $Z^{\\star} = v^{\\star}_2 + v^{\\star}_4 = 6 + 2 = 8$。\n\n现在，我们评估 $\\mathcal{E}=\\{0, 1, 3\\}$ 中的交换反应是否具有限制性：\n- 索引 $j=0$：$v^{\\star}_0 = 10$，等于其上界 $u_0 = 10$。该边界是活跃的。将 $u_0$ 放宽到 $u'_0 = 10 + \\epsilon$ 意味着约束 $v_1+v_3 \\le 10+\\epsilon$ 适用。遵循相同的逻辑，我们设定 $v_1=6$，剩下 $v_3 \\le 4+\\epsilon$。这得到 $v_4 = v_3/2 \\le 2+\\epsilon/2$。新的目标值为 $Z'_{pert} = 6 + (2+\\epsilon/2) = 8 + \\epsilon/2$。灵敏度为 $(Z'_{pert} - Z^{\\star})/\\epsilon = 0.5$，大于 $\\sigma=10^{-6}$。因此，反应 0 是限制性的。\n- 索引 $j=1$：$v^{\\star}_1 = 6$，但其上界 $u_1 = 10^6$ 不是活跃的。非限制性。\n- 索引 $j=3$：$v^{\\star}_3 = 4$，但其上界 $u_3 = 10^6$ 不是活跃的。非限制性。\n测试 1 的结果：$Z^{\\star} = 8.0$，限制性索引为 $\\{0\\}$。\n\n**测试用例 2**\n- 参数：$\\alpha_A = 1.5$，$\\alpha_B = 1$。\n- 化学计量：$S^{(2)} = \\begin{bmatrix} 1 & -1 & 0 & -1 & 0 \\\\ 0 & 1 & -1.5 & 0 & 0 \\\\ 0 & 0 & 0 & 1 & -1 \\end{bmatrix}$。\n- 边界：$l^{(2)} = \\mathbf{0}$，$u^{(2)} = \\begin{bmatrix} 100 & 10^6 & 3 & 10^6 & 2 \\end{bmatrix}^{\\top}$。\n\n这里，产率为 $1/\\alpha_A \\approx 0.67$ 和 $1/\\alpha_B = 1$。物种 B 效率更高。我们优先将底物分配给 B。\n系统动力学：$v_0 = v_1 + v_3$, $v_1 = 1.5v_2$, $v_3 = v_4$。\n通量的约束条件：\n$v_0 \\le 100$\n$v_2 \\le 3 \\implies v_1 \\le 1.5 \\times 3 = 4.5$\n$v_4 \\le 2 \\implies v_3 \\le 2$\n\n系统受限于内部生物质生成能力，而非外部供应。\n对于物种 B，最大生物质为 $v^{\\star}_4 = 2$，需要底物 $v^{\\star}_3 = 2$。\n对于物种 A，最大生物质为 $v^{\\star}_2 = 3$，需要底物 $v^{\\star}_1 = 4.5$。\n所需的总底物为 $v^{\\star}_0 = v^{\\star}_1 + v^{\\star}_3 = 4.5 + 2 = 6.5$。这远在供应极限 $u_0 = 100$ 之内。\n最优通量向量为 $v^{\\star} = [6.5, 4.5, 3, 2, 2]^{\\top}$。\n最优目标值为 $Z^{\\star} = v^{\\star}_2 + v^{\\star}_4 = 3 + 2 = 5$。\n\n交换反应评估：\n- 对于 $j \\in \\{0, 1, 3\\}$，通量 $v^{\\star}_0=6.5$，$v^{\\star}_1=4.5$，$v^{\\star}_3=2$ 均未达到其各自的上界（$100$，$10^6$，$10^6$）。没有边界是活跃的。\n测试 2 的结果：$Z^{\\star} = 5.0$，没有限制性索引。\n\n**测试用例 3**\n- 参数：$\\alpha_A = 1$，$\\alpha_B = 2$。（与测试 1 相同，物种 A 效率更高）。\n- 化学计量：$S^{(3)} = \\begin{bmatrix} 1 & -1 & 0 & -1 & 0 \\\\ 0 & 1 & -1 & 0 & 0 \\\\ 0 & 0 & 0 & 1 & -2 \\end{bmatrix}$。\n- 边界：$l^{(3)} = \\mathbf{0}$，$u^{(3)} = \\begin{bmatrix} 8 & 5 & 10^6 & 10^6 & 10^6 \\end{bmatrix}^{\\top}$。\n\n动力学与测试 1 相同：$v_1=v_2$, $v_3=2v_4$。物种 A 效率更高。我们最大化 $v_1$。\n新的通量约束是：\n$v_0 \\le 8$\n$v_1 \\le 5$\n$v_1$ 的最大可能通量是 $\\min(5, 8) = 5$。我们设定 $v^{\\star}_1 = 5$，因此 $v^{\\star}_2 = 5$。\n总供应受限于 $v_0 \\le 8$。我们利用全部供应，因此 $v^{\\star}_0 = 8$。\n物种 B 的剩余底物为 $v^{\\star}_3 = v^{\\star}_0 - v^{\\star}_1 = 8 - 5 = 3$。\n这产生生物质 $v^{\\star}_4 = v^{\\star}_3/2 = 1.5$。\n最优通量向量为 $v^{\\star} = [8, 5, 5, 3, 1.5]^{\\top}$。\n最优目标值为 $Z^{\\star} = v^{\\star}_2 + v^{\\star}_4 = 5 + 1.5 = 6.5$。\n\n交换反应评估：\n- 索引 $j=0$：$v^{\\star}_0 = 8$，等于其上界 $u_0 = 8$。该边界是活跃的。将 $u_0 \\to 8+\\epsilon$ 允许 $v_1+v_3 \\le 8+\\epsilon$。由于 $v_1$ 仍受限于 $v_1\\le 5$，我们设定 $v_1=5$。这得到 $v_3 \\le 3+\\epsilon$，所以 $v_4 \\le 1.5+\\epsilon/2$。新的目标值为 $Z'_{pert} = 5 + (1.5+\\epsilon/2) = 6.5+\\epsilon/2$。灵敏度为 $0.5 > \\sigma$。反应 0 是限制性的。\n- 索引 $j=1$：$v^{\\star}_1 = 5$，等于其上界 $u_1 = 5$。该边界是活跃的。将 $u_1$ 放宽至 $5+\\epsilon$ 允许 $v_1 \\le 5+\\epsilon$。由于物种 A 效率更高，我们希望增加 $v_1$。总底物仍受 $v_0 \\le 8$ 的限制。我们希望最大化 $Z = v_2+v_4 = v_1 + (8-v_1)/2 = 0.5v_1 + 4$。为最大化此值，我们将 $v_1$ 设为其新的最大值 $v_1=5+\\epsilon$。这会违反 $v_0 \\le 8$ 的约束，因为 $v_3$ 不能为负。因此，当 $v_1$ 增加时，$v_3$ 必须减少，$v_3=8-v_1$。新的目标值为 $Z'_{pert} = (5+\\epsilon) + (8-(5+\\epsilon))/2 = 5+\\epsilon + 1.5 - \\epsilon/2 = 6.5 + \\epsilon/2$。灵敏度为 $0.5 > \\sigma$。反应 1 是限制性的。\n- 索引 $j=3$：$v^{\\star}_3 = 3$，但其上界 $u_3 = 10^6$ 不是活跃的。非限制性。\n测试 3 的结果：$Z^{\\star} = 6.5$，限制性索引为 $\\{0, 1\\}$。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves a series of Flux Balance Analysis problems for a synthetic ecosystem\n    and identifies limiting exchange reactions based on sensitivity analysis.\n    \"\"\"\n    \n    # Common parameters\n    c = np.array([0, 0, 1, 0, 1])\n    exchange_indices_to_assess = [0, 1, 3]\n    tau = 1e-7  # Active bound tolerance\n    epsilon = 1e-4  # Perturbation magnitude\n    sigma = 1e-6  # Slope threshold\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {\n            \"alpha_A\": 1.0,\n            \"alpha_B\": 2.0,\n            \"u\": np.array([10.0, 1e6, 6.0, 1e6, 1e6]),\n        },\n        {\n            \"alpha_A\": 1.5,\n            \"alpha_B\": 1.0,\n            \"u\": np.array([100.0, 1e6, 3.0, 1e6, 2.0]),\n        },\n        {\n            \"alpha_A\": 1.0,\n            \"alpha_B\": 2.0,\n            \"u\": np.array([8.0, 5.0, 1e6, 1e6, 1e6]),\n        },\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        alpha_A = case[\"alpha_A\"]\n        alpha_B = case[\"alpha_B\"]\n        u_bounds = case[\"u\"]\n        l_bounds = np.zeros_like(u_bounds)\n\n        S = np.array([\n            [1, -1, 0, -1, 0],\n            [0, 1, -alpha_A, 0, 0],\n            [0, 0, 0, 1, -alpha_B],\n        ])\n\n        # Objective for scipy's minimizer\n        c_min = -c\n        \n        # Equality constraints: Sv = 0\n        A_eq = S\n        b_eq = np.zeros(S.shape[0])\n        \n        # Bounds: l = v = u\n        bounds = list(zip(l_bounds, u_bounds))\n\n        # --- Step 1: Solve the baseline FBA problem ---\n        res = linprog(c=c_min, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n        \n        if not res.success:\n            raise RuntimeError(\"Baseline LP failed to solve.\")\n        \n        v_star = res.x\n        obj_star = -res.fun\n        \n        # --- Step 2: Identify limiting exchange reactions ---\n        limiting_indices = []\n        for j in exchange_indices_to_assess:\n            # Check if the upper bound is active\n            if abs(v_star[j] - u_bounds[j]) = tau:\n                # Perturb the active upper bound\n                perturbed_bounds = list(bounds)\n                perturbed_bounds[j] = (l_bounds[j], u_bounds[j] + epsilon)\n                \n                # Re-solve the LP with the perturbed bound\n                res_pert = linprog(c=c_min, A_eq=A_eq, b_eq=b_eq, bounds=perturbed_bounds, method='highs')\n                \n                if not res_pert.success:\n                    continue\n\n                obj_pert = -res_pert.fun\n                \n                # Calculate sensitivity\n                sensitivity = (obj_pert - obj_star) / epsilon\n                \n                # Check if the sensitivity exceeds the threshold\n                if sensitivity > sigma:\n                    limiting_indices.append(j)\n\n        limiting_indices.sort()\n        \n        # Store results for this case\n        all_results.append([obj_star, limiting_indices])\n\n    # Format the final output string exactly as required by the problem description.\n    # The problem asks for a string representation of a Python list, with\n    # optimal values formatted to exactly 6 decimal places.\n    output_parts = []\n    for o, L in all_results:\n        o_str = f\"{o:.6f}\"\n        L_str = str(L)\n        output_parts.append(f\"[{o_str}, {L_str}]\")\n    \n    final_string = f\"[{', '.join(output_parts)}]\"\n    print(final_string.replace(\" \", \"\"))\n\nsolve()\n```", "id": "2779666"}]}