{"hands_on_practices": [{"introduction": "反应扩散系统和图灵不稳定性是自组织生物学图案形成的基本机制。本练习探讨了在工程化特定尺寸的组织时，边界条件和区域大小如何限制可能的图案，这是一个关键的考虑因素。通过这个实践，你将学习如何将线性稳定性分析的抽象数学理论与具体的、可观察的结果（如条纹数量）联系起来，从而为从头设计图案奠定基础 [@problem_id:2779124]。", "problem": "一个长度为 $L$ 的一维工程化组织中存在一个激活-抑制反应扩散（Reaction-Diffusion, RD）系统，该系统对于空间均匀扰动是线性稳定的，但对于一定范围的非零空间波数表现出扩散驱动（图灵）不稳定性。考虑关于均匀稳态的标准线性化，这为具有空间波数 $k$ 的简正模给出了一个增长率 $\\sigma(k)$。在 $x=0$ 和 $x=L$ 处的无通量（诺伊曼）边界条件模拟了不可渗透的组织边界。在不稳定性发生初期，色散关系的主导分支可以很好地用一个以最不稳定波数为中心的凹二次函数来近似，\n$$\n\\sigma(k)=\\sigma_{0}-\\gamma\\,(k-k_{c})^{2},\n$$\n其中 $\\sigma_{0}>0$ 和 $\\gamma>0$ 由反应动力学的雅可比矩阵和扩散系数决定。在一个实验中，通过参数推断得出 $\\sigma_{0}=0.50$，$\\gamma=1.00$ 和 $k_{c}=2.60$（无量纲）。测得组织长度为 $L=\\pi$（无量纲）。\n\n从无通量边界下的线性简正模的定义出发，并利用早期图案选择由具有最大正增长率的模式决定的事实，完成以下任务：\n\n- 确定在 $[0,L]$ 上的诺伊曼问题的离散容许波数集合，并找出哪个容许模式指数 $n\\in\\mathbb{N}_{0}$ 在此离散集合上使 $\\sigma(k)$ 最大化。\n\n- 将条纹数定义为在 $[0,L]$ 上对应于空间本征函数的激活剂场的局部最大值的总数（包括可能在边界上的最大值）。使用此定义，预测早期将观察到的激活剂条纹数量。\n\n将最终预测的条纹数表示为单个整数。无需四舍五入。在你的答案中仅表达最终的整数。", "solution": "首先必须验证问题陈述的科学性和逻辑完整性。\n\n**步骤 1：提取已知条件**\n- **系统**：一个长度为 $L$ 的一维工程化组织。\n- **模型**：一个激活-抑制反应扩散系统。\n- **线性化**：具有空间波数 $k$ 的简正模的增长率由色散关系 $\\sigma(k) = \\sigma_{0} - \\gamma (k-k_{c})^{2}$ 给出。\n- **参数**：$\\sigma_{0} = 0.50$，$\\gamma = 1.00$，$k_{c} = 2.60$。\n- **定义域**：长度 $L = \\pi$。\n- **边界条件**：在 $x=0$ 和 $x=L$ 处为无通量（诺伊曼）边界条件。\n- **任务 1**：确定离散的容许波数集合，并找到使增长率 $\\sigma(k)$ 最大化的模式指数 $n$。\n- **任务 2**：将条纹数定义为在 $[0,L]$ 上对应空间本征函数的局部最大值的数量，并预测此数量。\n\n**步骤 2：验证**\n该问题具有科学依据，描述了经典的图灵不稳定性分析，这是图案形成中的一个基本概念。色散关系是在不稳定性带峰值附近的标准二次近似。参数已给出，边界条件明确。问题是自洽的，可以进行数学形式化，并且是客观的。它也与所述的合成发育生物学主题直接相关。没有矛盾、歧义或事实不准确之处。该问题是有效的。\n\n**步骤 3：求解**\n我们开始求解。该问题要求我们分析一个激活-抑制系统在长度为 $L=\\pi$ 的一维域上的行为。其动力学由反应扩散方程控制，均匀稳态的稳定性由线性化系统确定。\n\n首先，我们确定在无通量（诺伊曼）边界条件下的容许空间波数 $k$ 的集合。这些条件规定，在边界 $x=0$ 和 $x=L$ 处，浓度场的空间导数必须为零。\n$$\n\\frac{\\partial u}{\\partial x}\\bigg|_{x=0} = 0 \\quad \\text{和} \\quad \\frac{\\partial u}{\\partial x}\\bigg|_{x=L} = 0\n$$\n对于拉普拉斯算子 $\\frac{\\partial^2}{\\partial x^2}$，满足这些边界条件的空间本征函数形式为 $\\cos(k x)$。我们来验证一下。其导数为 $-\\sin(k x)$ 乘以 $k$。在 $x=0$ 处，$-\\sin(k \\cdot 0) = 0$，这个条件总是满足的。在 $x=L$ 处，我们要求 $-\\sin(k L) = 0$。对于任意非负整数 $n \\in \\mathbb{N}_0 = \\{0, 1, 2, \\dots\\}$，当 $k L = n \\pi$ 时，该条件得到满足。\n\n因此，离散的容许波数集合由下式给出：\n$$\nk_n = \\frac{n \\pi}{L}\n$$\n鉴于组织长度为 $L=\\pi$，容许波数简化为：\n$$\nk_n = \\frac{n \\pi}{\\pi} = n, \\quad \\text{其中 } n = 0, 1, 2, \\dots\n$$\n早期出现的图案由具有最高增长率 $\\sigma(k_n)$ 的模式决定。我们已知色散关系为：\n$$\n\\sigma(k) = \\sigma_{0} - \\gamma (k - k_{c})^{2}\n$$\n参数为 $\\sigma_{0}=0.50$，$\\gamma=1.00$ 和 $k_{c}=2.60$。为了找到主导模式，我们必须找到整数 $n$，使得 $k_n = n$ 能最大化 $\\sigma(k_n)$。函数 $\\sigma(k)$ 是一个开口向下的抛物线，其最大值在 $k=k_c$ 处。因此，当离散波数 $k_n$ 最接近最不稳定的波数 $k_c$ 时，$\\sigma(k_n)$ 的值最大。\n\n我们必须找到一个整数 $n \\ge 0$，使得距离 $|k_n - k_c| = |n - 2.60|$ 最小。我们对 $2.60$ 周围的整数进行评估：\n- 对于 $n=2$，距离为 $|2 - 2.60| = 0.60$。\n- 对于 $n=3$，距离为 $|3 - 2.60| = 0.40$。\n\n$n=3$ 的距离更小。因此，在所有容许模式中，指数为 $n=3$ 的模式具有最大的正增长率。对应的波数为 $k_3 = 3$。这是在早期图案形成中起主导作用的模式。\n作为检查，问题陈述该系统对均匀扰动（$k=0$）是稳定的。让我们计算一下 $\\sigma(k_0=0)$：\n$$\n\\sigma(0) = 0.50 - 1.00(0 - 2.60)^2 = 0.50 - 6.76 = -6.26 < 0\n$$\n这证实了均匀稳态的稳定性，符合要求。竞争模式的增长率为 $\\sigma(2) = 0.50 - 1.00(2-2.60)^2 = 0.50 - 0.36 = 0.14$ 和 $\\sigma(3) = 0.50 - 1.00(3-2.60)^2 = 0.50 - 0.16 = 0.34$。由于 $\\sigma(3) > \\sigma(2)$ 且 $\\sigma(3)>0$，模式 $n=3$ 确实是增长最快的不稳定模式。\n\n接下来，我们必须预测激活剂条纹的数量。问题将其定义为“在 $[0,L]$ 上对应于空间本征函数的激活剂场的局部最大值的总数（包括可能在边界上的最大值）”。\n主导模式 $n=3$ 的空间本征函数是：\n$$\n\\phi_3(x) = \\cos(k_3 x) = \\cos(3x)\n$$\n我们需要找到该函数在定义域 $x \\in [0, \\pi]$ 上的局部最大值的数量。局部最大值可以出现在区间内部的临界点或边界上。\n\n通过将一阶导数设为零来找到临界点：\n$$\n\\frac{d}{dx} \\cos(3x) = -3 \\sin(3x) = 0\n$$\n这意味着 $3x = m\\pi$，其中 $m$ 是任意整数。因此，临界点为 $x_m = \\frac{m\\pi}{3}$。\n我们只考虑定义域 $[0, \\pi]$ 内的点：\n$$\n0 \\le \\frac{m\\pi}{3} \\le \\pi \\implies 0 \\le m \\le 3\n$$\n在定义域中的临界点对应于 $m \\in \\{0, 1, 2, 3\\}$，即 $x=0$, $x=\\frac{\\pi}{3}$, $x=\\frac{2\\pi}{3}$ 和 $x=\\pi$。\n\n现在我们使用二阶导数检验来对这些点进行分类。二阶导数是：\n$$\n\\frac{d^2}{dx^2} \\cos(3x) = -9 \\cos(3x)\n$$\n如果二阶导数为负，则该点为局部最大值。\n- 在 $x=0$ 处：$-9 \\cos(3 \\cdot 0) = -9 \\cos(0) = -9 < 0$。这是一个局部最大值。\n- 在 $x=\\frac{\\pi}{3}$ 处：$-9 \\cos(3 \\cdot \\frac{\\pi}{3}) = -9 \\cos(\\pi) = 9 > 0$。这是一个局部最小值。\n- 在 $x=\\frac{2\\pi}{3}$ 处：$-9 \\cos(3 \\cdot \\frac{2\\pi}{3}) = -9 \\cos(2\\pi) = -9 < 0$。这是一个局部最大值。\n- 在 $x=\\pi$ 处：$-9 \\cos(3 \\cdot \\pi) = -9 \\cos(3\\pi) = 9 > 0$。这是一个局部最小值。\n\n局部最大值出现在 $x=0$ 和 $x=\\frac{2\\pi}{3}$ 处。定义中明确包含了边界。计算这些最大值，我们发现正好有两个。\n因此，预测的激活剂条纹数量是 2。", "answer": "$$\n\\boxed{2}\n$$", "id": "2779124"}, {"introduction": "一旦空间图案（如形态发生素梯度）建立起来，细胞必须解释它以做出命运决定。遗传双稳态开关是将连续梯度信号转换为离散细胞状态的经典合成生物学基序。本练习深入探讨了该开关的非线性动力学，要求你分析一个关键设计参数——希尔系数 $n$——如何影响其切换阈值 $\\alpha_{\\mathrm{sn}}$ [@problem_id:2779052]。这为你提供了分析和设计基因调控网络稳定性的宝贵实践。", "problem": "一个合成多细胞图案形成系统在每个细胞内使用一个对称的双基因触发开关，以响应一种可扩散的形态发生素来编码离散的细胞命运。每个基因都通过一个以Hill函数为特征的协同结合来抑制另一个基因。在无量纲单位下，细胞内基因调控网络 (GRN) 的动力学由以下方程描述：\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1 + y^{n}} - x, \\qquad \\frac{dy}{dt} = \\frac{\\alpha}{1 + x^{n}} - y,\n$$\n其中 $x$ 和 $y$ 表示两种抑制剂的无量纲浓度，$\\alpha$ 是一个随形态发生素水平单调增加的无量纲有效合成参数，而 $n \\geq 1$ 是抑制Hill系数。细胞命运的转换阈值被确定为值 $\\alpha_{\\mathrm{sn}}(n)$，在该值下，一个鞍结分岔会湮灭两个稳定稳态中的一个，从而触发命运的转换。假设由于工程构建中的对称性，转换事件发生在 $x=y$ 的对称分支上。\n\n请仅使用关于平衡和分岔的基本动力学系统原理以及上面给出的标准Hill抑制非线性，推导对称分支上的鞍结条件，并计算转换阈值相对于Hill系数 $n$ 的灵敏度，即导数 $d\\alpha_{\\mathrm{sn}}/dn$，得出一个关于 $n$ 的闭式解析表达式。请将您的最终答案表示为仅依赖于 $n$ 的单个解析表达式。不需要进行数值计算，也不应进行四舍五入。最终答案必须是无量纲的，并以闭式形式给出。", "solution": "问题要求在一个合成触发开关模型中，计算转换阈值 $\\alpha_{\\mathrm{sn}}$ 相对于Hill系数 $n$ 的灵敏度。该灵敏度由导数 $d\\alpha_{\\mathrm{sn}}/dn$ 给出。\n\n系统的动力学由以下耦合常微分方程组给出：\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1 + y^{n}} - x\n$$\n$$\n\\frac{dy}{dt} = \\frac{\\alpha}{1 + x^{n}} - y\n$$\n其中 $x$ 和 $y$ 是无量纲浓度，$\\alpha$ 是合成参数， $n$ 是Hill系数。\n\n首先，我们通过将时间导数设为零来确定系统的稳态（不动点）：\n$$\nx = \\frac{\\alpha}{1 + y^{n}}\n$$\n$$\ny = \\frac{\\alpha}{1 + x^{n}}\n$$\n问题指出，转换事件发生在由条件 $x=y$ 定义的对称分支上。将此条件代入任一个稳态方程，得到对称稳态浓度（我们简记为 $x$）与参数 $\\alpha$ 之间的关系：\n$$\nx = \\frac{\\alpha}{1 + x^{n}} \\implies \\alpha = x(1 + x^{n})\n$$\n这个方程描述了对称不动点在 $(x, \\alpha)$ 参数空间中的位置。\n\n接下来，我们建立分岔的条件。当一个稳态的稳定性发生改变时，就会发生分岔，这对应于系统雅可比矩阵的某个特征值穿过零。雅可比矩阵 $J$ 由下式给出：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(\\frac{\\alpha}{1 + y^{n}} - x) & \\frac{\\partial}{\\partial y}(\\frac{\\alpha}{1 + y^{n}} - x) \\\\ \\frac{\\partial}{\\partial x}(\\frac{\\alpha}{1 + x^{n}} - y) & \\frac{\\partial}{\\partial y}(\\frac{\\alpha}{1 + x^{n}} - y) \\end{pmatrix} = \\begin{pmatrix} -1 & -\\frac{\\alpha n y^{n-1}}{(1+y^n)^2} \\\\ -\\frac{\\alpha n x^{n-1}}{(1+x^n)^2} & -1 \\end{pmatrix}\n$$\n我们在对称稳态 $(x, x)$ 处计算雅可比矩阵：\n$$\nJ(x,x) = \\begin{pmatrix} -1 & -\\frac{\\alpha n x^{n-1}}{(1+x^n)^2} \\\\ -\\frac{\\alpha n x^{n-1}}{(1+x^n)^2} & -1 \\end{pmatrix}\n$$\n当雅可比矩阵变为奇异时，即其行列式为零时，发生分岔。\n$$\n\\det(J) = (-1)(-1) - \\left(-\\frac{\\alpha n x^{n-1}}{(1+x^n)^2}\\right)^2 = 1 - \\left(\\frac{\\alpha n x^{n-1}}{(1+x^n)^2}\\right)^2 = 0\n$$\n这意味着 $\\frac{\\alpha n x^{n-1}}{(1+x^n)^2} = \\pm 1$。由于 $\\alpha, n, x$ 都是正量，左边的项必须是正的。因此，分岔条件是：\n$$\n\\frac{\\alpha n x^{n-1}}{(1+x^n)^2} = 1\n$$\n现在我们有了一个关于分岔点 $(\\alpha_{\\mathrm{sn}}, x_{\\mathrm{sn}})$ 的两个代数方程组成的方程组：\n1. 稳态： $\\alpha_{\\mathrm{sn}} = x_{\\mathrm{sn}}(1 + x_{\\mathrm{sn}}^n)$\n2. 分岔： $\\frac{\\alpha_{\\mathrm{sn}} n x_{\\mathrm{sn}}^{n-1}}{(1+x_{\\mathrm{sn}}^n)^2} = 1$\n\n我们求解这个方程组。将第一个方程中 $\\alpha_{\\mathrm{sn}}$ 的表达式代入第二个方程：\n$$\n\\frac{x_{\\mathrm{sn}}(1 + x_{\\mathrm{sn}}^n) n x_{\\mathrm{sn}}^{n-1}}{(1+x_{\\mathrm{sn}}^n)^2} = 1\n$$\n$$\n\\frac{n x_{\\mathrm{sn}}^n}{1 + x_{\\mathrm{sn}}^n} = 1\n$$\n这可以简化为 $n x_{\\mathrm{sn}}^n = 1 + x_{\\mathrm{sn}}^n$，从而得到 $(n-1)x_{\\mathrm{sn}}^n = 1$。分析要求 $n>1$，因为当 $n=1$ 时不存在这样的分岔。由此，我们求得临界浓度 $x_{\\mathrm{sn}}$：\n$$\nx_{\\mathrm{sn}}^n = \\frac{1}{n-1} \\implies x_{\\mathrm{sn}} = \\left(\\frac{1}{n-1}\\right)^{1/n} = (n-1)^{-1/n}\n$$\n现在我们将 $x_{\\mathrm{sn}}$ 代回稳态方程，求出相应的转换阈值 $\\alpha_{\\mathrm{sn}}$：\n$$\n\\alpha_{\\mathrm{sn}} = x_{\\mathrm{sn}}(1 + x_{\\mathrm{sn}}^n) = (n-1)^{-1/n} \\left(1 + \\frac{1}{n-1}\\right)\n$$\n$$\n\\alpha_{\\mathrm{sn}} = (n-1)^{-1/n} \\left(\\frac{n-1+1}{n-1}\\right) = (n-1)^{-1/n} \\frac{n}{n-1}\n$$\n$$\n\\alpha_{\\mathrm{sn}}(n) = n(n-1)^{-1 - 1/n} = n(n-1)^{-\\frac{n+1}{n}}\n$$\n这就是转换阈值作为Hill系数 $n$ 的函数的闭式表达式。\n\n最后一步是计算导数 $d\\alpha_{\\mathrm{sn}}/dn$。为了方便，我们使用对数求导法。令 $A(n) = \\alpha_{\\mathrm{sn}}(n)$。\n$$\n\\ln(A) = \\ln\\left(n(n-1)^{-\\frac{n+1}{n}}\\right) = \\ln(n) - \\frac{n+1}{n}\\ln(n-1) = \\ln(n) - \\left(1 + \\frac{1}{n}\\right)\\ln(n-1)\n$$\n两边对 $n$ 求导：\n$$\n\\frac{1}{A}\\frac{dA}{dn} = \\frac{d}{dn}\\left[\\ln(n) - \\left(1 + \\frac{1}{n}\\right)\\ln(n-1)\\right]\n$$\n对第二项使用乘法法则：\n$$\n\\frac{1}{A}\\frac{dA}{dn} = \\frac{1}{n} - \\left[ \\left(-\\frac{1}{n^2}\\right)\\ln(n-1) + \\left(1+\\frac{1}{n}\\right)\\frac{1}{n-1} \\right]\n$$\n$$\n\\frac{1}{A}\\frac{dA}{dn} = \\frac{1}{n} + \\frac{\\ln(n-1)}{n^2} - \\frac{n+1}{n(n-1)}\n$$\n合并有理项：\n$$\n\\frac{1}{n} - \\frac{n+1}{n(n-1)} = \\frac{n-1 - (n+1)}{n(n-1)} = \\frac{-2}{n(n-1)}\n$$\n因此，对数导数为：\n$$\n\\frac{1}{A}\\frac{dA}{dn} = \\frac{\\ln(n-1)}{n^2} - \\frac{2}{n(n-1)}\n$$\n为了求得 $\\frac{dA}{dn} = \\frac{d\\alpha_{\\mathrm{sn}}}{dn}$，我们乘以 $A(n) = \\alpha_{\\mathrm{sn}}(n) = n(n-1)^{-\\frac{n+1}{n}}$：\n$$\n\\frac{d\\alpha_{\\mathrm{sn}}}{dn} = n(n-1)^{-\\frac{n+1}{n}} \\left( \\frac{\\ln(n-1)}{n^2} - \\frac{2}{n(n-1)} \\right)\n$$\n将因子 $n(n-1)^{-\\frac{n+1}{n}}$ 分配到括号内：\n$$\n\\frac{d\\alpha_{\\mathrm{sn}}}{dn} = (n-1)^{-\\frac{n+1}{n}} \\left( n \\cdot \\frac{\\ln(n-1)}{n^2} - n \\cdot \\frac{2}{n(n-1)} \\right)\n$$\n$$\n\\frac{d\\alpha_{\\mathrm{sn}}}{dn} = (n-1)^{-\\frac{n+1}{n}} \\left( \\frac{\\ln(n-1)}{n} - \\frac{2}{n-1} \\right)\n$$\n这就是转换阈值相对于Hill系数 $n$ 的灵敏度的最终闭式解析表达式，在 $n > 1$ 时有效。", "answer": "$$\n\\boxed{(n-1)^{-\\frac{n+1}{n}} \\left( \\frac{\\ln(n-1)}{n} - \\frac{2}{n-1} \\right)}\n$$", "id": "2779052"}, {"introduction": "合成生物学中的一个终极工程挑战是按需创建模式，而不仅仅是分析它们。光遗传学是利用光以高时空精度控制基因表达的强大工具。这项计算练习涉及解决一个逆问题：计算所需的输入（光照模式 $\\mathbf{u}$）以达到期望的输出（特定的形态发生素浓度分布 $\\mathbf{c}^{\\star}$）[@problem_id:2779025]。这项实践综合了反应扩散建模、数值方法和优化的概念，模拟了真实的合成生物学设计工作流程。", "problem": "您将设计并实现一个算法，该算法计算最优的一维光照模式，以便在线性扩散-降解系统中产生目标稳态形态发生素浓度分布，该系统由光遗传学源驱动。正向生物物理模型源自 Fick 定律和一阶降解。在一维域上，其长度为 $L$，空间坐标为 $x \\in [0,L]$，形态发生素浓度 $c(x)$ 满足稳态方程\n$$\nD \\,\\frac{d^2 c}{dx^2} - k\\,c + s\\,u(x) = 0,\n$$\n其中 $D$ 是扩散系数，$k$ 是降解速率常数，$s$ 是单位光照的源强度，$u(x)$ 是非负的光照强度。两端均满足零通量 (Neumann) 边界条件：\n$$\n\\frac{dc}{dx}(0) = 0, \\quad \\frac{dc}{dx}(L) = 0.\n$$\n定义一个包含 $N$ 个点的均匀网格，点间距为 $h = L/(N-1)$。使用标准的二阶中心有限差分格式对二阶导数进行离散化，该方法通过经典的虚拟点消除法在端点处强制执行零通量边界条件，从而得到一个三对角的二阶导数矩阵 $L_N \\in \\mathbb{R}^{N \\times N}$，其内部行使用三点模板，其边界行一致地施加零空间导数。稳态离散化正向模型可以写为\n$$\n\\left(k I - D L_N\\right)\\, \\mathbf{c} = s\\, \\mathbf{u},\n$$\n其中 $\\mathbf{c}, \\mathbf{u} \\in \\mathbb{R}^N$ 分别是离散化的浓度和光照，$I$ 是 $N \\times N$ 的单位矩阵。光照的分量受到约束 $0 \\le u_i \\le u_{\\max}$。\n\n给定一个目标浓度分布 $\\mathbf{c}^{\\star} \\in \\mathbb{R}^N$，将逆问题设定为寻找能最小化凸二次目标函数 $J(\\mathbf{u})$ 的 $\\mathbf{u}$\n$$\nJ(\\mathbf{u}) = \\left\\| G \\mathbf{u} - \\mathbf{c}^{\\star} \\right\\|_2^2 \\;+\\; \\alpha \\left\\| D_1 \\mathbf{u} \\right\\|_2^2\n$$\n并服从所有 $i$ 的箱式约束 $0 \\le u_i \\le u_{\\max}$，其中 $G = \\left(k I - D L_N\\right)^{-1} s I$ 是将光照映射到浓度的离散正向算子，$D_1 \\in \\mathbb{R}^{(N-1)\\times N}$ 是由 $(D_1 \\mathbf{u})_i = u_{i+1} - u_i$ 定义的一阶差分矩阵（适用于 $i=1,\\dots,N-1$），$\\alpha \\ge 0$ 是一个平滑参数。对于下方的每个测试案例，计算最优的 $\\mathbf{u}^{\\star}$，然后评估生成的浓度 $\\widehat{\\mathbf{c}} = G \\mathbf{u}^{\\star}$，并报告均方根误差\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^N \\left(\\widehat{c}_i - c_i^{\\star}\\right)^2 }.\n$$\n以浓度任意单位 (a.u.) 报告 $\\mathrm{RMSE}$。\n\n实现要求：\n- 在内部使用标准三点模板，并为边界行设置一致的零通量条件来构建 $L_N$。\n- 通过数值方法求逆 $k I - D L_N$ 或通过求解以该矩阵为系数的线性系统来构建 $G$。\n- 使用一阶差分 $D_1$ 进行平滑，并使用保持凸性的标准技术来合并平滑项。\n- 强制执行 $0 \\le u_i \\le u_{\\max}$。\n\n测试套件。根据每个案例指定使用 $N$ 和 $L$，并通过在均匀网格 $x_j = j h$，$j=0,\\dots,N-1$ 上对指定的连续函数进行采样来定义目标 $\\mathbf{c}^{\\star}$：\n\n- 案例 A（中等扩散下的平滑目标）：$L = 500\\,\\mu\\mathrm{m}$，$N = 64$，$D = 10\\,\\mu\\mathrm{m}^2/\\mathrm{s}$，$k = 0.01\\,\\mathrm{s}^{-1}$，$s = 1.0\\,\\mathrm{(a.u.)/(\\mathrm{W}\\,\\mathrm{m}^{-2})}$，$\\alpha = 10^{-2}$，$u_{\\max} = 5.0\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$，目标 $c^{\\star}(x) = 1.0\\,\\mathrm{a.u.}\\cdot \\exp\\!\\left(-\\frac{(x - L/2)^2}{2 \\cdot (60\\,\\mu\\mathrm{m})^2}\\right)$。\n\n- 案例 B（用于探测边界处理的均匀目标）：$L = 400\\,\\mu\\mathrm{m}$，$N = 50$，$D = 5\\,\\mu\\mathrm{m}^2/\\mathrm{s}$，$k = 0.05\\,\\mathrm{s}^{-1}$，$s = 1.0$，$\\alpha = 10^{-3}$，$u_{\\max} = 5.0$，对所有 $x$，目标 $c^{\\star}(x) = 0.2\\,\\mathrm{a.u.}$。\n\n- 案例 C（具有更强平滑的阶跃目标）：$L = 600\\,\\mu\\mathrm{m}$，$N = 80$，$D = 8\\,\\mu\\mathrm{m}^2/\\mathrm{s}$，$k = 0.02\\,\\mathrm{s}^{-1}$，$s = 1.0$，$\\alpha = 5\\times 10^{-2}$，$u_{\\max} = 10.0$，当 $x \\le L/3$ 时目标 $c^{\\star}(x) = 1.0\\,\\mathrm{a.u.}$，当 $x > L/3$ 时目标 $c^{\\star}(x) = 0.1\\,\\mathrm{a.u.}$。\n\n- 案例 D（高扩散和弱降解，窄特征）：$L = 500\\,\\mu\\mathrm{m}$，$N = 64$，$D = 50\\,\\mu\\mathrm{m}^2/\\mathrm{s}$，$k = 0.005\\,\\mathrm{s}^{-1}$，$s = 1.0$，$\\alpha = 10^{-2}$，$u_{\\max} = 10.0$，目标 $c^{\\star}(x) = 1.0\\,\\mathrm{a.u.}\\cdot \\exp\\!\\left(-\\frac{(x - L/2)^2}{2 \\cdot (20\\,\\mu\\mathrm{m})^2}\\right)$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含案例 A、B、C 和 D 的 $\\mathrm{RMSE}$ 值，按此顺序以逗号分隔的浮点数列表形式放在方括号内（例如，“[$r_A$,$r_B$,$r_C$,$r_D$]”）。每个 $\\mathrm{RMSE}$ 必须以浓度任意单位 (a.u.) 表示。\n- 程序必须完全自包含，不接受任何输入，并在内部执行所有计算。", "solution": "该问题是合成发育生物学领域一个适定的逆问题，具体涉及通过光遗传学控制多细胞模式。其目标是确定一个最优的光照模式 $\\mathbf{u}$，以生成一个期望的稳态形态发生素浓度分布 $\\mathbf{c}^{\\star}$。这需要对一个基于反应-扩散动力学的生物物理模型进行求逆。该问题被表述为一个带箱式约束的凸优化问题，这在计算上是可行的。\n\n正向模型描述了形态发生素在一维域（长度为 $L$）上的稳态浓度 $c(x)$，由以下微分方程给出：\n$$\nD \\,\\frac{d^2 c}{dx^2} - k\\,c + s\\,u(x) = 0\n$$\n这里，$D$ 是扩散系数，$k$ 是一阶降解速率，$s$ 是源产生速率，$u(x)$ 是空间变化的光照输入。系统是封闭的，这通过零通量（Neumann）边界条件来强制执行：\n$$\n\\frac{dc}{dx}(0) = 0, \\quad \\frac{dc}{dx}(L) = 0\n$$\n为了数值求解此问题，我们首先将空间域 $x \\in [0, L]$ 离散化为一个包含 $N$ 个点 $\\{x_i\\}_{i=0}^{N-1}$ 的均匀网格，点间距为 $h = L/(N-1)$。浓度和光照分布由向量 $\\mathbf{c}, \\mathbf{u} \\in \\mathbb{R}^N$ 表示。\n\n二阶导数算子 $\\frac{d^2}{dx^2}$ 使用二阶中心有限差分格式进行近似。对于内部网格点 $x_i$，这表示为：\n$$\n\\frac{d^2 c}{dx^2}\\bigg|_{x_i} \\approx \\frac{c_{i-1} - 2c_i + c_{i+1}}{h^2}\n$$\n为了在边界处保持二阶精度，我们引入虚拟点 $c_{-1}$ 和 $c_{N}$，并应用零通量边界条件的中心差分近似：\n- 在 $x_0 = 0$ 处：$\\frac{dc}{dx}(0) \\approx \\frac{c_1 - c_{-1}}{2h} = 0 \\implies c_{-1} = c_1$。\n- 在 $x_{N-1} = L$ 处：$\\frac{dc}{dx}(L) \\approx \\frac{c_{N} - c_{N-2}}{2h} = 0 \\implies c_{N} = c_{N-2}$。\n将这些代入边界节点的二阶导数近似中，可得：\n- 在 $x_0$ 处：$\\frac{d^2 c}{dx^2}\\bigg|_{x_0} \\approx \\frac{c_{-1} - 2c_0 + c_1}{h^2} = \\frac{2c_1 - 2c_0}{h^2}$。\n- 在 $x_{N-1}$ 处：$\\frac{d^2 c}{dx^2}\\bigg|_{x_{N-1}} \\approx \\frac{c_{N-2} - 2c_{N-1} + c_{N}}{h^2} = \\frac{2c_{N-2} - 2c_{N-1}}{h^2}$。\n这导致了离散拉普拉斯矩阵 $L_N \\in \\mathbb{R}^{N \\times N}$ 的构建：\n$$\nL_N = \\frac{1}{h^2} \\begin{pmatrix}\n-2 & 2 & 0 & \\dots & 0 \\\\\n1 & -2 & 1 & \\dots & 0 \\\\\n\\vdots & \\ddots & \\ddots & \\ddots & \\vdots \\\\\n0 & \\dots & 1 & -2 & 1 \\\\\n0 & \\dots & 0 & 2 & -2\n\\end{pmatrix}\n$$\n控制方程的离散形式是一个线性系统：\n$$\n\\left( D L_N - k I \\right) \\mathbf{c} + s \\mathbf{u} = \\mathbf{0}\n$$\n其中 $I$ 是 $N \\times N$ 的单位矩阵。整理后，我们得到离散化的正向模型：\n$$\n\\left( k I - D L_N \\right) \\mathbf{c} = s \\mathbf{u}\n$$\n当 $D, k > 0$ 时，矩阵 $A = (k I - D L_N)$ 是正定的，因此是可逆的。我们因此可以定义一个线性正向算子 $G$，它将一个光照向量 $\\mathbf{u}$ 映射到一个浓度向量 $\\mathbf{c}$：\n$$\n\\mathbf{c} = \\left(k I - D L_N\\right)^{-1} s I \\, \\mathbf{u} = G \\mathbf{u}\n$$\n逆问题是找到一个光照模式 $\\mathbf{u}$，使其产生的浓度分布尽可能接近目标分布 $\\mathbf{c}^{\\star}$。这被表述为一个正则化优化问题，以确保解的稳定性和物理意义。我们最小化以下凸二次目标函数：\n$$\nJ(\\mathbf{u}) = \\underbrace{\\left\\| G \\mathbf{u} - \\mathbf{c}^{\\star} \\right\\|_2^2}_{\\text{保真项}} + \\underbrace{\\alpha \\left\\| D_1 \\mathbf{u} \\right\\|_2^2}_{\\text{平滑项}}\n$$\n第一项衡量了产生的浓度 $G\\mathbf{u}$ 与目标 $\\mathbf{c}^{\\star}$ 之间的欧几里得距离的平方。第二项是 Tikhonov 正则化项，它惩罚光照模式中相邻点之间的巨大变化，由平滑参数 $\\alpha \\ge 0$ 控制。这里，$D_1 \\in \\mathbb{R}^{(N-1)\\times N}$ 是一阶差分矩阵。此外，光照必须满足物理约束 $0 \\le u_i \\le u_{\\max}$ 对所有网格点 $i$ 成立。\n\n这个问题的结构等价于一个带边界约束的线性最小二乘问题。我们可以通过堆叠矩阵和向量来重写目标函数：\n$$\nJ(\\mathbf{u}) = \\left\\| \\begin{pmatrix} G \\\\ \\sqrt{\\alpha} D_1 \\end{pmatrix} \\mathbf{u} - \\begin{pmatrix} \\mathbf{c}^{\\star} \\\\ \\mathbf{0} \\end{pmatrix} \\right\\|_2^2\n$$\n其形式为 $\\min_{\\mathbf{u}} \\| M\\mathbf{u} - \\mathbf{d} \\|_2^2$，约束条件为 $0 \\le \\mathbf{u} \\le u_{\\max}$，其中 $M = \\begin{pmatrix} G \\\\ \\sqrt{\\alpha} D_1 \\end{pmatrix}$ 且 $\\mathbf{d} = \\begin{pmatrix} \\mathbf{c}^{\\star} \\\\ \\mathbf{0} \\end{pmatrix}$。这种形式可以使用标准的数值优化程序（如 `scipy.optimize.lsq_linear`）高效求解。\n\n对每个测试案例，求解算法按以下步骤进行：\n1.  设置物理参数 $L, N, D, k, s, \\alpha, u_{\\max}$。\n2.  构建空间网格 $\\mathbf{x}$ 和目标浓度向量 $\\mathbf{c}^{\\star}$。\n3.  组装离散拉普拉斯矩阵 $L_N$ 和正向算子矩阵 $G$。\n4.  组装一阶差分矩阵 $D_1$。\n5.  为最小二乘问题构建增广矩阵 $M$ 和向量 $\\mathbf{d}$。\n6.  求解带边界约束的最小二乘问题，找到最优光照向量 $\\mathbf{u}^{\\star}$。\n7.  计算得到的浓度分布 $\\widehat{\\mathbf{c}} = G \\mathbf{u}^{\\star}$。\n8.  计算 $\\widehat{\\mathbf{c}}$ 和 $\\mathbf{c}^{\\star}$ 之间的均方根误差 (RMSE)，公式为 $\\sqrt{\\frac{1}{N} \\sum_{i=1}^N (\\widehat{c}_i - c_i^{\\star})^2}$。\n对所有指定的测试案例重复此过程，以评估控制策略在不同物理条件下的性能。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import lsq_linear\n\ndef solve():\n    \"\"\"\n    Computes the optimal illumination pattern for target morphogen profiles\n    and reports the root mean squared error for several test cases.\n    \"\"\"\n    test_cases = [\n        # Case A\n        {'name': 'A', 'L': 500.0, 'N': 64, 'D': 10.0, 'k': 0.01, 's': 1.0, 'alpha': 1e-2, 'u_max': 5.0,\n         'c_star_func': lambda x, L: 1.0 * np.exp(-(x - L/2)**2 / (2 * 60**2))},\n        # Case B\n        {'name': 'B', 'L': 400.0, 'N': 50, 'D': 5.0, 'k': 0.05, 's': 1.0, 'alpha': 1e-3, 'u_max': 5.0,\n         'c_star_func': lambda x, L: 0.2 * np.ones_like(x)},\n        # Case C\n        {'name': 'C', 'L': 600.0, 'N': 80, 'D': 8.0, 'k': 0.02, 's': 1.0, 'alpha': 5e-2, 'u_max': 10.0,\n         'c_star_func': lambda x, L: np.where(x <= L/3, 1.0, 0.1)},\n        # Case D\n        {'name': 'D', 'L': 500.0, 'N': 64, 'D': 50.0, 'k': 0.005, 's': 1.0, 'alpha': 1e-2, 'u_max': 10.0,\n         'c_star_func': lambda x, L: 1.0 * np.exp(-(x - L/2)**2 / (2 * 20**2))}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # 1. Unpack parameters and set up the domain\n        L, N, D, k, s, alpha, u_max = case['L'], case['N'], case['D'], case['k'], case['s'], case['alpha'], case['u_max']\n        \n        x_grid = np.linspace(0, L, N)\n        h = L / (N - 1)\n        h2_inv = 1.0 / (h**2)\n        \n        # 2. Construct the second-derivative matrix L_N with Neumann BCs\n        diag_main = -2.0 * np.ones(N)\n        diag_off = np.ones(N - 1)\n        \n        L_N = h2_inv * (np.diag(diag_main) + np.diag(diag_off, k=1) + np.diag(diag_off, k=-1))\n        \n        # Apply zero-flux (Neumann) boundary conditions\n        L_N[0, 0] = -2.0 * h2_inv\n        L_N[0, 1] = 2.0 * h2_inv\n        L_N[N-1, N-2] = 2.0 * h2_inv\n        L_N[N-1, N-1] = -2.0 * h2_inv\n        \n        # 3. Construct matrices for the inverse problem\n        # Forward operator matrix G\n        A_op = k * np.eye(N) - D * L_N\n        G = s * np.linalg.inv(A_op)\n        \n        # First-difference matrix D1 for regularization\n        D1 = np.eye(N, k=1) - np.eye(N)\n        D1 = D1[:-1, :]\n\n        # Target concentration profile\n        c_star = case['c_star_func'](x_grid, L)\n\n        # 4. Set up and solve the bound-constrained least-squares problem\n        # The objective is to minimize ||M*u - d||^2_2\n        # where M = vstack([G, sqrt(alpha)*D1]) and d = concatenate([c_star, 0s])\n        M = np.vstack((G, np.sqrt(alpha) * D1))\n        d = np.concatenate((c_star, np.zeros(N - 1)))\n        \n        bounds = (0, u_max)\n        \n        # Solve for the optimal illumination u_star\n        opt_result = lsq_linear(M, d, bounds=bounds)\n        u_star = opt_result.x\n        \n        # 5. Compute the resulting concentration and RMSE\n        c_hat = G @ u_star\n        rmse = np.sqrt(np.mean((c_hat - c_star)**2))\n        results.append(rmse)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2779025"}]}