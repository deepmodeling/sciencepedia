{"hands_on_practices": [{"introduction": "在合成生物学中，构建空间模式的最直接方式是建立一个稳定的形态发生素梯度。这个练习将引导你解决一个核心的实践问题：如何从离散的、带有噪声的实验数据中，提取出描述梯度形态的关键生物物理参数。通过将稳态反应-扩散方程的模型与实验测量相结合，你将亲手计算出特征长度尺度 $\\ell$ 和扩散系数 $D$，这对于验证和迭代合成回路设计至关重要。[@problem_id:2758441]", "problem": "您正在一个均匀介质中对一维形态发生素（morphogen）稳态梯度进行建模，这与合成生物学中的模式形成（patterning）相关。一种浓度为 $c(x)$ 的可扩散形态发生素，其扩散系数为 $D$（单位为 $\\mu\\mathrm{m}^2/\\mathrm{s}$），并以一级速率常数 $\\lambda$（单位为 $\\mathrm{s}^{-1}$）降解。在远离任何局部源区域的地方，扩散和降解的稳态平衡由以下反应-扩散方程描述\n$$D\\,\\frac{d^2 c}{dx^2} - \\lambda\\,c = 0,$$\n其约束条件为，当 $x \\to +\\infty$ 时，$c(x)$ 保持有限值。\n\n您的任务是：\n\n- 从上述稳态平衡定律和线性常微分方程的基本性质出发，推导 $c(x)$ 的函数形式，并确定一个控制空间衰减的特征长度尺度 $\\ell$。根据您的推导，给出 $\\ell$、$D$ 和 $\\lambda$ 之间的关系。\n- 假设您有离散测量值 $\\{(x_i, c_i)\\}_{i=1}^N$，以及每个浓度测量值（单位与 $c$ 相同）的已知标准差 $\\{\\sigma_{c,i}\\}_{i=1}^N$，这些测量值是在位置 $\\{x_i\\}$（单位为 $\\mu\\mathrm{m}$）处获取的。假设 $c_i$ 的测量噪声是独立且服从高斯分布的，并且偏差足够小，可以通过对数进行一阶误差传播，请使用加权最小二乘法（WLS）对模型隐含的函数形式进行拟合，从而实现一个 $\\ell$ 的估计器。使用线性化 $y_i = \\ln c_i$ 和一阶传播的标准差 $\\sigma_{y,i} \\approx \\sigma_{c,i}/c_i$ 来定义权重 $w_i = 1/\\sigma_{y,i}^2$，用于对线性模型 $y_i = a + b\\,x_i$ 进行WLS拟合，其中 $b$ 与 $\\ell$ 相关。使用设计矩阵 $X$（一列全为1，一列为 $x_i$）和权重矩阵 $W = \\mathrm{diag}(w_i)$ 的正规方程 $(X^\\top W X)\\,\\theta = X^\\top W y$ 来获得参数矢量 $\\theta = (a,b)^\\top$，并通过 $\\mathrm{Cov}(\\theta) = (X^\\top W X)^{-1}$ 获得参数的协方差（将 $\\sigma_{y,i}$ 视为已知）。\n- 通过一阶（delta方法）误差传播，将拟合斜率的不确定性传播到 $\\ell$ 以获得其标准不确定度。然后，在 $\\lambda$ 精确已知的假设下，使用您推导的 $\\ell$、$D$ 和 $\\lambda$ 之间的关系计算 $D$。使用一阶误差传播将 $\\ell$ 的不确定性传播到 $D$。报告 $\\ell$ 和 $D$ 及其标准不确定度。\n- 实现一个完整的程序，对下面的测试套件执行这些计算，并按要求的格式打印输出。\n\n测试套件（每个案例提供位置 $x_i$（单位 $\\mu\\mathrm{m}$）、测量的浓度 $c_i$（单位任意但一致）、浓度标准差 $\\sigma_{c,i}$（单位与 $c_i$ 相同）以及已知的降解速率 $\\lambda$（单位 $\\mathrm{s}^{-1}$））：\n\n- 案例 1（常规良态情况）：\n  - $x = [0, 10, 20, 30, 40, 50]$\n  - $c = [121.0, 89.3, 68.5, 49.8, 39.1, 28.0]$\n  - $\\sigma_c = [2.0, 2.0, 2.0, 2.0, 2.0, 2.0]$\n  - $\\lambda = 0.01$\n- 案例 2（短长度尺度，快速衰减）：\n  - $x = [0, 5, 10, 15, 20]$\n  - $c = [60.5, 21.5, 8.3, 2.8, 1.0]$\n  - $\\sigma_c = [0.3, 0.3, 0.3, 0.3, 0.3]$\n  - $\\lambda = 0.04$\n- 案例 3（长长度尺度，平缓梯度）：\n  - $x = [0, 50, 100, 150, 200, 250, 300]$\n  - $c = [99.0, 78.2, 60.1, 47.9, 36.2, 28.9, 22.0]$\n  - $\\sigma_c = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]$\n  - $\\lambda = 0.0025$\n\n数值和输出要求：\n\n- 使用上述指定的线性化WLS估计器来估计 $y_i = a + b\\,x_i$ 的斜率 $b$ 和截距 $a$，然后计算 $\\ell$ 及其标准不确定度。接着计算 $D$ 及其标准不确定度。\n- 将最终的 $\\ell$ 以 $\\mu\\mathrm{m}$ 为单位表示，$D$ 以 $\\mu\\mathrm{m}^2/\\mathrm{s}$ 为单位表示，它们的标准不确定度也使用各自相同的单位。将所有报告的数字四舍五入到恰好 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表中的每个元素是对应案例的结果列表，格式为 $[\\ell, \\sigma_\\ell, D, \\sigma_D]$。所有结果包含在一对方括号内。例如：$[[\\ell_1,\\sigma_{\\ell,1},D_1,\\sigma_{D,1}],[\\ell_2,\\sigma_{\\ell,2},D_2,\\sigma_{D,2}],\\dots]$。", "solution": "所提出的问题是生物物理建模和数据分析中的一个标准练习，重点关注一维反应-扩散系统。在给出解决方案之前，必须对问题陈述的科学性和逻辑完整性进行验证。\n\n**问题验证**\n\n已知条件如下：\n1.  稳态浓度 $c(x)$ 的控制微分方程为 $D\\,\\frac{d^2 c}{dx^2} - \\lambda\\,c = 0$。\n2.  边界条件是当 $x \\to +\\infty$ 时，$c(x)$ 保持有限值。\n3.  实验数据以集合 $\\{x_i, c_i, \\sigma_{c,i}\\}$ 的形式提供，同时给出已知的降解速率 $\\lambda$。\n4.  估计过程被指定为对线性化模型 $y_i = \\ln c_i$ 进行加权最小二乘（WLS）拟合，权重由一阶误差传播导出，$w_i = 1/\\sigma_{y,i}^2$，其中 $\\sigma_{y,i} \\approx \\sigma_{c,i}/c_i$。\n5.  给出了参数估计的公式 $\\theta = (X^\\top W X)^{-1} X^\\top W y$ 和参数协方差的公式 $\\mathrm{Cov}(\\theta) = (X^\\top W X)^{-1}$。\n6.  目标是求出特征长度尺度 $\\ell$、扩散系数 $D$ 以及它们各自的标准不确定度。\n\n该问题具有科学依据，因为反应-扩散方程是物理学和生物学中的一个基本模型。该问题是适定的（well-posed），提供了一个清晰的数学和统计框架，可以导出一个唯一的解。其语言客观、精确。数据和参数在生物系统的物理现实范围内。没有矛盾、歧义或逻辑缺陷。问题有效。我们开始求解。\n\n**第1部分：形态发生素分布和特征长度的推导**\n\n控制方程是一个二阶线性齐次常微分方程，系数为常数：\n$$D\\,\\frac{d^2 c}{dx^2} - \\lambda\\,c = 0$$\n我们可以将其重写为：\n$$\\frac{d^2 c}{dx^2} - \\frac{\\lambda}{D}\\,c = 0$$\n通过代入 $c(x) = e^{rx}$ 得到特征方程，即：\n$$r^2 - \\frac{\\lambda}{D} = 0$$\n该方程的根为 $r_{1,2} = \\pm\\sqrt{\\frac{\\lambda}{D}}$。通解是两个独立解的线性组合：\n$$c(x) = A\\,e^{\\sqrt{\\lambda/D}\\,x} + B\\,e^{-\\sqrt{\\lambda/D}\\,x}$$\n其中 $A$ 和 $B$ 是由边界条件决定的常数。问题陈述，当 $x \\to +\\infty$ 时，浓度 $c(x)$ 必须保持有限。由于 $D > 0$ 且 $\\lambda > 0$，项 $\\sqrt{\\lambda/D}$ 是实数且为正。项 $e^{\\sqrt{\\lambda/D}\\,x}$ 在 $x \\to +\\infty$ 时发散。为满足边界条件，其系数必须为零，即 $A=0$。\n\n因此，解简化为：\n$$c(x) = B\\,e^{-\\sqrt{\\lambda/D}\\,x}$$\n常数 $B$ 对应于 $x=0$ 处的浓度，即 $c(0) = c_0$。其函数形式为指数衰减：\n$$c(x) = c_0\\,e^{-x/\\ell}$$\n通过将此形式与推导出的解进行比较，我们可以确定特征长度尺度 $\\ell$，它描述了浓度下降到 $e$ 分之一的距离。\n$$\\frac{1}{\\ell} = \\sqrt{\\frac{\\lambda}{D}}$$\n由此，我们推导出 $\\ell$、$D$ 和 $\\lambda$ 之间的关系：\n$$\\ell = \\sqrt{\\frac{D}{\\lambda}} \\quad \\implies \\quad D = \\lambda\\,\\ell^2$$\n\n**第2部分：通过加权最小二乘法进行参数估计**\n\n为了从离散数据 $\\{(x_i, c_i)\\}$ 中估计 $\\ell$，我们通过取自然对数来线性化模型：\n$$y(x) = \\ln c(x) = \\ln(c_0 e^{-x/\\ell}) = \\ln c_0 - \\frac{1}{\\ell} x$$\n这对应于我们数据点 $(x_i, y_i = \\ln c_i)$ 的线性模型 $y_i = a + b x_i$，其中截距为 $a = \\ln c_0$，斜率为 $b = -1/\\ell$。\n\n浓度测量的不确定度 $\\sigma_{c,i}$ 会传播到线性化变量 $y_i = \\ln c_i$ 上。使用一阶泰勒展开（delta方法），$y_i$ 的方差约为：\n$$\\sigma_{y,i}^2 \\approx \\left( \\frac{d(\\ln c_i)}{dc_i} \\right)^2 \\sigma_{c,i}^2 = \\left( \\frac{1}{c_i} \\right)^2 \\sigma_{c,i}^2 = \\frac{\\sigma_{c,i}^2}{c_i^2}$$\n由于 $y_i$ 的方差不相等，因此适合使用加权最小二乘（WLS）回归。最佳权重是方差的倒数：\n$$w_i = \\frac{1}{\\sigma_{y,i}^2} = \\frac{c_i^2}{\\sigma_{c,i}^2}$$\nWLS问题旨在找到参数矢量 $\\theta = [a, b]^\\top$，以最小化加权残差平方和 $\\sum w_i (y_i - (a+bx_i))^2$。解由正规方程给出：\n$$(X^\\top W X)\\,\\theta = X^\\top W y$$\n其中 $y$ 是 $[\\ln c_i]$ 的矢量，$X$ 是设计矩阵（一列为1，一列为 $x_i$），$W$ 是权重 $w_i$ 的对角矩阵。参数的解为：\n$$\\theta = (X^\\top W X)^{-1} X^\\top W y$$\n假设模型正确且权重已知，估计参数的协方差矩阵由下式给出：\n$$\\mathrm{Cov}(\\theta) = (X^\\top W X)^{-1}$$\n斜率的方差 $\\sigma_b^2$ 是元素 $\\mathrm{Cov}(\\theta)_{2,2}$。\n\n**第3部分：$\\ell$ 和 $D$ 的不确定性传播**\n\n一旦我们得到了斜率 $b$ 及其方差 $\\sigma_b^2$ 的估计值，我们就可以确定 $\\ell$ 及其不确定度。\n由 $b = -1/\\ell$ 可得 $\\ell = -1/b$。\n使用一阶误差传播：\n$$\\sigma_\\ell^2 \\approx \\left( \\frac{d\\ell}{db} \\right)^2 \\sigma_b^2 = \\left( \\frac{1}{b^2} \\right)^2 \\sigma_b^2 = (\\ell^2)^2 \\sigma_b^2 = \\ell^4 \\sigma_b^2$$\n标准不确定度为 $\\sigma_\\ell = \\sqrt{\\sigma_\\ell^2} \\approx \\ell^2 \\sigma_b$。\n\n接下来，我们计算扩散系数 $D = \\lambda \\ell^2$。问题陈述 $\\lambda$ 是精确已知的，因此 $D$ 的不确定性完全来自 $\\ell$ 的不确定性。再次应用误差传播：\n$$\\sigma_D^2 \\approx \\left( \\frac{\\partial D}{\\partial \\ell} \\right)^2 \\sigma_\\ell^2 = (2\\lambda \\ell)^2 \\sigma_\\ell^2$$\n标准不确定度为 $\\sigma_D = \\sqrt{\\sigma_D^2} \\approx 2\\lambda \\ell \\sigma_\\ell$。\n\n以下程序为所提供的测试案例实现了这一完整过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the characteristic length and diffusion coefficient for a series of\n    reaction-diffusion system measurement test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: general well-conditioned case\n        {\n            \"x\": np.array([0, 10, 20, 30, 40, 50], dtype=float),\n            \"c\": np.array([121.0, 89.3, 68.5, 49.8, 39.1, 28.0], dtype=float),\n            \"sigma_c\": np.array([2.0, 2.0, 2.0, 2.0, 2.0, 2.0], dtype=float),\n            \"lambda\": 0.01\n        },\n        # Case 2: short length scale, rapidly decaying\n        {\n            \"x\": np.array([0, 5, 10, 15, 20], dtype=float),\n            \"c\": np.array([60.5, 21.5, 8.3, 2.8, 1.0], dtype=float),\n            \"sigma_c\": np.array([0.3, 0.3, 0.3, 0.3, 0.3], dtype=float),\n            \"lambda\": 0.04\n        },\n        # Case 3: long length scale, shallow gradient\n        {\n            \"x\": np.array([0, 50, 100, 150, 200, 250, 300], dtype=float),\n            \"c\": np.array([99.0, 78.2, 60.1, 47.9, 36.2, 28.9, 22.0], dtype=float),\n            \"sigma_c\": np.array([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], dtype=float),\n            \"lambda\": 0.0025\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        x = case[\"x\"]\n        c = case[\"c\"]\n        sigma_c = case[\"sigma_c\"]\n        lambda_val = case[\"lambda\"]\n\n        # Linearize the concentration data\n        y = np.log(c)\n\n        # Calculate weights for WLS. w_i = 1/sigma_y_i^2 = (c_i/sigma_c_i)^2\n        weights = (c / sigma_c)**2\n\n        # Construct the design matrix X\n        # Column of ones, column of x_i\n        X = np.vstack((np.ones_like(x), x)).T\n\n        # Construct the diagonal weight matrix W\n        W = np.diag(weights)\n\n        # Solve the normal equations for WLS: theta = (X.T @ W @ X)^-1 @ (X.T @ W @ y)\n        # First, calculate X.T @ W @ X\n        XT_W_X = X.T @ W @ X\n        \n        # Then, calculate X.T @ W @ y\n        XT_W_y = X.T @ W @ y\n\n        # Invert XT_W_X to get the parameter covariance matrix\n        # and solve for the parameter vector theta\n        try:\n            param_cov_matrix = np.linalg.inv(XT_W_X)\n            theta = param_cov_matrix @ XT_W_y\n        except np.linalg.LinAlgError:\n            # Handle cases where the matrix is singular, although not expected for valid inputs\n            all_results.append([float('nan')] * 4)\n            continue\n\n        # Extract intercept 'a', slope 'b', and variance of slope 'var_b'\n        # a = theta[0] # not needed for further calculations\n        b = theta[1]\n        var_b = param_cov_matrix[1, 1]\n        sigma_b = np.sqrt(var_b)\n\n        # Calculate characteristic length l = -1/b\n        ell = -1.0 / b\n\n        # Propagate uncertainty to l: sigma_l = l^2 * sigma_b\n        sigma_ell = (ell**2) * sigma_b\n\n        # Calculate diffusion coefficient D = lambda * l^2\n        D = lambda_val * (ell**2)\n        \n        # Propagate uncertainty to D: sigma_D = 2 * lambda * l * sigma_l\n        sigma_D = 2.0 * lambda_val * ell * sigma_ell\n\n        # Round results to 6 decimal places and store\n        results = [\n            round(ell, 6),\n            round(sigma_ell, 6),\n            round(D, 6),\n            round(sigma_D, 6)\n        ]\n        all_results.append(results)\n\n    # Format the final output string\n    # e.g., [[l1,sl1,D1,sD1],[l2,sl2,D2,sD2],...]\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, res))}]\" for res in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2758441"}, {"introduction": "在上一个练习中，我们看到了扩散在形成浓度梯度中的作用。现在，我们将更深入地探究扩散这一物理过程的本质。本练习要求你不仅仅是应用菲克定律（Fick's law），而是要从化学势和线性不可逆热力学等第一性原理出发，推导出描述粒子流动的扩散通量 $J_{u}$。掌握这一推导过程将加深你对分子随机运动如何产生宏观定向输运的理解，这是精确设计和调控物质运输的基础。[@problem_id:2758450]", "problem": "在一个沿一维区域 $x \\in [0,L]$ 构建的、处于恒定温度下的工程合成形态发生素系统中，一个形态发生素浓度场在稳态下维持着 $u(x) = u_{0} + \\alpha x$ 的空间分布，其中 $u_{0}$ 和 $\\alpha$ 是常数。该形态发生素稀释于水性介质中，并以恒定的扩散系数 $D_{u}$ 进行被动扩散。\n\n假设系统为等温稀溶液，并处于非平衡热力学的线性响应区，其中通量由理想稀溶液溶质的化学势梯度驱动。$x=0$ 处的边界代表一个汇区（例如，细胞吸收区），与一个开放微环境相接，需要在此处评估通量。\n\n仅使用这些假设和基本本构推理（理想稀溶液化学势、线性不可逆热力学以及连接迁移率和扩散的爱因斯坦关系式），推导一维扩散通量 $J_{u}(x)$，并针对给定的 $u(x)$ 计算其在 $x=0$ 处的值。解释 $J_{u}(0)$ 的符号和大小，说明其相对于 $+x$ 方向以及相对于 $x=0$ 处的汇区的单位时间单位面积上的形态发生素净流量。\n\n以 $D_{u}$ 和 $\\alpha$ 的代数表达式报告通量。使用国际单位制（SI）：浓度单位为 $\\text{分子}\\cdot\\mathrm{m}^{-3}$，长度单位为 $\\mathrm{m}$，时间单位为 $\\mathrm{s}$，因此通量的单位为 $\\text{分子}\\cdot\\mathrm{m}^{-2}\\cdot\\mathrm{s}^{-1}$。最终的方框答案中不要包含单位。无需进行数值四舍五入；请提供精确的符号表达式。", "solution": "该问题要求从基本原理出发，为给定的形态发生素浓度分布 $u(x)$ 推导其扩散通量 $J_{u}(x)$，并在边界 $x=0$ 处计算其值。\n\n首先，我们验证问题陈述的有效性。已知条件如下：\n- 一个一维区域 $x \\in [0,L]$。\n- 一个稳态浓度分布 $u(x) = u_{0} + \\alpha x$。\n- 一个恒定的扩散系数 $D_{u}$。\n- 系统是等温的理想稀溶液。\n- 推导必须使用理想稀溶液化学势、线性不可逆热力学以及爱因斯坦关系式的概念。\n- $x=0$ 处的边界是一个汇。\n该问题具有科学依据，提法恰当，且自成体系。它描述了一个标准的物理情景，并要求基于基本原理进行推导，这是一项有效且并非无足轻重的任务。因此，该问题是有效的，我们可以继续进行解答。\n\n推导从理想稀溶液中某物种的化学势 $\\mu$ 开始。在位置 $x$ 处，每个粒子的化学势由下式给出：\n$$\n\\mu(x) = \\mu^{\\circ} + k_{B} T \\ln(u(x))\n$$\n其中 $\\mu^{\\circ}$ 是标准化学势（对于等温系统为常数），$k_{B}$ 是玻尔兹曼常数， $T$ 是绝对温度， $u(x)$ 是形态发生素的局部浓度。\n\n根据线性非平衡热力学的原理，粒子的净通量是由热力学力驱动的。对于不带电物种的扩散输运，该力是化学势的负梯度。作用于单个粒子上的力为 $F_{\\text{particle}}(x) = -\\frac{d\\mu}{dx}$。\n\n通量 $J_{u}(x)$ 是局部浓度 $u(x)$ 与粒子的平均漂移速度 $v_{d}(x)$ 的乘积。漂移速度通过迁移率系数 $b$ 与作用在粒子上的力相关，即 $v_{d}(x) = b \\cdot F_{\\text{particle}}(x)$。\n将这些关系合并，我们可将通量表示为：\n$$\nJ_{u}(x) = u(x) v_{d}(x) = u(x) \\cdot b \\cdot \\left(-\\frac{d\\mu}{dx}\\right)\n$$\n该关系式是斯莫鲁霍夫斯基方程的一种形式。现在，我们必须计算化学势的梯度。对 $\\mu(x)$ 关于 $x$ 求导：\n$$\n\\frac{d\\mu}{dx} = \\frac{d}{dx} \\left( \\mu^{\\circ} + k_{B} T \\ln(u(x)) \\right) = 0 + k_{B} T \\frac{1}{u(x)} \\frac{du}{dx}\n$$\n恒定的标准化学势 $\\mu^{\\circ}$ 的导数为零。将此化学势梯度的表达式代回到通量方程中：\n$$\nJ_{u}(x) = u(x) \\cdot b \\cdot \\left(-k_{B} T \\frac{1}{u(x)} \\frac{du}{dx}\\right)\n$$\n分子和分母中的浓度 $u(x)$ 相互抵消，从而显著简化了表达式：\n$$\nJ_{u}(x) = -(b k_{B} T) \\frac{du}{dx}\n$$\n此推导的最后一步是应用爱因斯坦关系式，它将热环境中的粒子迁移率 $b$ 与扩散系数 $D_{u}$ 联系起来：\n$$\nD_{u} = b k_{B} T\n$$\n将爱因斯坦关系式代入我们的通量表达式中，得到菲克第一扩散定律：\n$$\nJ_{u}(x) = -D_{u} \\frac{du}{dx}\n$$\n至此，完成了从指定的基本原理推导通量方程的过程。\n\n现在，我们将此结果应用于问题中给出的特定浓度分布：$u(x) = u_{0} + \\alpha x$。我们计算浓度梯度：\n$$\n\\frac{du}{dx} = \\frac{d}{dx}(u_{0} + \\alpha x) = \\alpha\n$$\n梯度是一个常数 $\\alpha$。将其代入我们的通量方程：\n$$\nJ_{u}(x) = -D_{u} \\alpha\n$$\n此结果表明，在区域 $[0,L]$ 内的所有 $x$ 处，扩散通量都是恒定的，这是没有内部源或汇的一维稳态扩散问题的一个典型特征。\n\n问题要求计算边界 $x=0$ 处的通量。由于通量是恒定的，其在 $x=0$ 处的值与其它任何地方的值都相同：\n$$\nJ_{u}(0) = -D_{u} \\alpha\n$$\n这就是通量的最终符号表达式。\n\n最后，我们必须解释 $J_u(0)$ 的符号和大小。通量矢量的定义是，正通量对应于沿正 $x$ 方向的净移动。\n问题指出 $x=0$ 处的区域是一个汇。物理上的汇是指有粒子净流入的区域。对于来自 $x>0$ 区域的粒子，流入位于 $x=0$ 的汇意味着净流动方向为负 $x$ 方向。因此，通量 $J_u(0)$ 必须为负。\n鉴于 $J_{u}(0) = -D_{u} \\alpha$ 且扩散系数 $D_{u}$ 总是正的，要使 $J_{u}(0)$ 为负，常数 $\\alpha$ 必须是正的（$\\alpha>0$）。这个物理约束与浓度分布 $u(x)=u_0+\\alpha x$ 是一致的：一个正的 $\\alpha$ 意味着浓度随 $x$ 增加而增加，从而产生一个梯度，驱动扩散从高 $x$ 处（高浓度）向低 $x$ 处（低浓度）进行，即朝向位于 $x=0$ 的汇。\n通量的大小为 $|J_{u}(0)| = D_{u}\\alpha$（对于 $\\alpha > 0$）。这个大小表示单位时间单位面积上流入 $x=0$ 处汇的形态发生素分子数量。它与浓度梯度的陡峭程度 $\\alpha$ 以及由扩散系数 $D_u$ 所表征的形态发生素分子在介质中的内在迁移能力成正比。", "answer": "$$\n\\boxed{-D_{u}\\alpha}\n$$", "id": "2758450"}, {"introduction": "从简单的浓度梯度到复杂的、自发形成的斑图，是模式形成研究中的一个巨大飞跃。本练习将带你进入 Alan Turing 的开创性理论的核心，通过分析一个经典的双组分“激活子-抑制子”系统来揭示图灵斑图（Turing patterns）的形成机制。你将执行线性稳定性分析，推导色散关系，并最终确定在没有外部指令的情况下，哪个空间模式会自发地被选择并最先涌现。这项技能是预测和设计能够自组织形成复杂结构的合成生物系统的关键所在。[@problem_id:2758478]", "problem": "一个合成的双基因激活-抑制回路通过其蛋白质产物在长度为 $L$ 的一维组织中扩散来驱动模式形成，该组织在 $x=0$ 和 $x=L$ 处具有零通量（Neumann）边界条件。激活剂和抑制剂的浓度相对于空间均匀稳态 $(u^{\\ast},v^{\\ast})$ 的小扰动 $u(x,t)$ 和 $v(x,t)$ 的时空动力学由以下反应-扩散偏微分方程（PDE）建模\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; D_u \\,\\frac{\\partial^2 u}{\\partial x^2} \\;+\\; f_u\\,u \\;+\\; f_v\\,v,\n\\qquad\n\\frac{\\partial v}{\\partial t} \\;=\\; D_v \\,\\frac{\\partial^2 v}{\\partial x^2} \\;+\\; g_u\\,u \\;+\\; g_v\\,v,\n$$\n其中 $D_u$ 和 $D_v$ 是扩散系数，$f_u, f_v, g_u, g_v$ 是在 $(u^{\\ast},v^{\\ast})$ 处求值的充分混合动力学的雅可比矩阵的元素。假设在没有扩散的情况下，充分混合稳态是线性稳定的。\n\n在一个设计的构建体中，在 $(u^{\\ast},v^{\\ast})$ 处的参数为\n$$\nD_u \\;=\\; 1, \\qquad D_v \\;=\\; 20, \\qquad\n\\begin{pmatrix}\nf_u & f_v \\\\\ng_u & g_v\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n0.5 & -1 \\\\\n1 & -1\n\\end{pmatrix},\n$$\n组织长度为 $L=20$（任意长度单位）。在 $[0,L]$ 上具有零通量边界条件下，空间拉普拉斯算子的本征模是余弦模，其离散波数为 $k_n = n\\pi/L$，其中整数 $n \\ge 0$。\n\n从反应-扩散偏微分方程和充分混合雅可比矩阵的线性稳定性定义出发，从第一性原理推导波数为 $k$ 的空间傅里叶模的时间增长率 $\\lambda(k)$ 的色散关系，然后在离散的容许波数 $k_n = n\\pi/L$ 中，确定哪个整数模数 $n$ 在 $t=0^{+}$ 时达到最大实部 $\\mathrm{Re}(\\lambda(k_n))$，并因此被初始选择。给出使 $\\mathrm{Re}(\\lambda(k_n))$ 最大化的单个整数 $n$。最终答案中不要包含任何其他文本。", "solution": "该问题要求推导线性化的一维反应-扩散系统的色散关系，并识别初始选择的不稳定空间模。\n\n描述偏离均匀稳态的小扰动 $u(x,t)$ 和 $v(x,t)$ 的控制方程由以下线性偏微分方程组（PDE）给出：\n$$\n\\frac{\\partial u}{\\partial t} = D_u \\frac{\\partial^2 u}{\\partial x^2} + f_u u + f_v v\n$$\n$$\n\\frac{\\partial v}{\\partial t} = D_v \\frac{\\partial^2 v}{\\partial x^2} + g_u u + g_v v\n$$\n这可以写成向量形式：\n$$\n\\frac{\\partial \\mathbf{c}}{\\partial t} = \\mathbf{D} \\frac{\\partial^2 \\mathbf{c}}{\\partial x^2} + \\mathbf{J} \\mathbf{c}\n$$\n其中 $\\mathbf{c} = \\begin{pmatrix} u \\\\ v \\end{pmatrix}$，$\\mathbf{D} = \\begin{pmatrix} D_u & 0 \\\\ 0 & D_v \\end{pmatrix}$，$\\mathbf{J} = \\begin{pmatrix} f_u & f_v \\\\ g_u & g_v \\end{pmatrix}$。\n\n域是一维区间 $[0, L]$，具有零通量（Neumann）边界条件。满足这些边界条件的空间拉普拉斯算子 $\\frac{\\partial^2}{\\partial x^2}$ 的本征函数是余弦模 $\\cos(k_n x)$，对应的本征值为 $-k_n^2$，其中波数 $k_n = \\frac{n\\pi}{L}$，整数 $n \\ge 0$。任何解 $\\mathbf{c}(x,t)$ 都可以分解为这些空间模的级数。我们通过考虑以下形式的解来单独分析每个模的稳定性：\n$$\n\\mathbf{c}(x,t) = \\mathbf{c}_n \\exp(\\lambda(k_n)t) \\cos(k_n x)\n$$\n其中 $\\mathbf{c}_n$ 是一个振幅常数向量，$\\lambda(k_n)$ 是与波数为 $k_n$ 的模相关的时间增长率（一个本征值）。将此试探解代入偏微分方程组，得到关于 $\\lambda$ 的代数本征值问题。对于一个一般的波数 $k$：\n$$\n\\lambda \\mathbf{c}_k \\exp(\\lambda t) \\cos(kx) = \\mathbf{D} (-k^2) \\mathbf{c}_k \\exp(\\lambda t) \\cos(kx) + \\mathbf{J} \\mathbf{c}_k \\exp(\\lambda t) \\cos(kx)\n$$\n除以时空项，我们得到：\n$$\n\\lambda \\mathbf{c}_k = (-k^2 \\mathbf{D} + \\mathbf{J}) \\mathbf{c}_k\n$$\n这是一个本征值问题，其中 $\\lambda$ 是矩阵 $\\mathbf{J}_k = \\mathbf{J} - k^2 \\mathbf{D}$ 的一个本征值。为了使 $\\mathbf{c}_k$ 有非平凡解，矩阵 $(\\mathbf{J}_k - \\lambda \\mathbf{I})$ 的行列式必须为零，其中 $\\mathbf{I}$ 是单位矩阵。\n$$\n\\det(\\mathbf{J}_k - \\lambda \\mathbf{I}) = \\det\\begin{pmatrix} f_u - D_u k^2 - \\lambda & f_v \\\\ g_u & g_v - D_v k^2 - \\lambda \\end{pmatrix} = 0\n$$\n展开行列式得到关于 $\\lambda$ 的特征方程：\n$$\n(f_u - D_u k^2 - \\lambda)(g_v - D_v k^2 - \\lambda) - f_v g_u = 0\n$$\n$$\n\\lambda^2 - (f_u + g_v - (D_u + D_v)k^2)\\lambda + ((f_u - D_u k^2)(g_v - D_v k^2) - f_v g_u) = 0\n$$\n这个关于 $\\lambda$ 的二次方程就是色散关系。使用反应雅可比矩阵 $\\mathbf{J}$ 的迹和行列式，可以更紧凑地写出此方程：\n$$\n\\mathrm{Tr}(\\mathbf{J}) = f_u + g_v \\qquad \\det(\\mathbf{J}) = f_u g_v - f_v g_u\n$$\n方程变为：\n$$\n\\lambda^2 - (\\mathrm{Tr}(\\mathbf{J}) - (D_u+D_v)k^2)\\lambda + (\\det(\\mathbf{J}) - (D_u g_v + D_v f_u)k^2 + D_u D_v k^4) = 0\n$$\n设 $T(k^2) = \\mathrm{Tr}(\\mathbf{J}) - (D_u+D_v)k^2$ 且 $\\Delta(k^2) = \\det(\\mathbf{J}) - (D_u g_v + D_v f_u)k^2 + D_u D_v k^4$。$\\lambda(k)$ 的解为：\n$$\n\\lambda_{\\pm}(k) = \\frac{T(k^2) \\pm \\sqrt{T(k^2)^2 - 4\\Delta(k^2)}}{2}\n$$\n波数为 $k$ 的模的稳定性由最大本征值的实部 $\\mathrm{Re}(\\lambda_+(k))$ 的符号决定。如果 $\\mathrm{Re}(\\lambda_+(k)) > 0$，则出现不稳定性。\n\n首先，我们验证给定条件，即充分混合系统（$k=0$）是稳定的。参数为：\n$D_u = 1$， $D_v = 20$， $L=20$。\n$\\mathbf{J} = \\begin{pmatrix} 0.5 & -1 \\\\ 1 & -1 \\end{pmatrix}$。所以，$f_u=0.5, f_v=-1, g_u=1, g_v=-1$。\n\n对于 $k=0$，如果 $\\mathrm{Tr}(\\mathbf{J}) < 0$ 且 $\\det(\\mathbf{J}) > 0$，则系统是稳定的。\n$\\mathrm{Tr}(\\mathbf{J}) = 0.5 + (-1) = -0.5 < 0$。\n$\\det(\\mathbf{J}) = (0.5)(-1) - (-1)(1) = -0.5 + 1 = 0.5 > 0$。\n条件得到满足，因此空间均匀稳态是稳定的。\n\n对于扩散驱动（Turing）不稳定性，我们需要对于某个 $k > 0$ 有 $\\mathrm{Re}(\\lambda_+(k)) > 0$。\n由于对于 $k \\ge 0$，$T(k^2) = \\mathrm{Tr}(\\mathbf{J}) - (D_u+D_v)k^2$ 总是负的（因为 $\\mathrm{Tr}(\\mathbf{J}) < 0$），只有当判别式 $T(k^2)^2 - 4\\Delta(k^2)$ 为实数且足够大时，才会出现正的增长率。这要求 $\\Delta(k^2)$ 变为负值，从而保证判别式为正。因此，当本征值为实数时发生不稳定性，且不稳定性条件简化为 $\\lambda_+(k) > 0$。这要求 $\\Delta(k^2) < 0$。\n\n让我们分析函数 $\\Delta(k^2)$：\n$$\n\\Delta(k^2) = D_u D_v k^4 - (D_u g_v + D_v f_u) k^2 + \\det(\\mathbf{J})\n$$\n代入参数值：\n$D_uD_v = (1)(20) = 20$。\n$D_u g_v + D_v f_u = (1)(-1) + (20)(0.5) = -1 + 10 = 9$。\n$\\det(\\mathbf{J}) = 0.5$。\n所以，$\\Delta(k^2) = 20 k^4 - 9 k^2 + 0.5$。\n如果这个关于 $k^2$ 的二次函数的最小值为负，则存在一个不稳定模的范围。最小值出现在 $k^2 = -(-9)/(2 \\cdot 20) = 9/40$，最小值为 $20(9/40)^2 - 9(9/40) + 0.5 = -0.6125 < 0$，证实了存在一个不稳定的波数带。\n\n初始选择的模是具有最大增长率的模，即对应于使 $\\mathrm{Re}(\\lambda_+(k))$ 最大化的波数 $k_{max}$ 的模。需要最大化的函数是 $\\lambda_+(k) = \\frac{1}{2}\\left(T(k^2) + \\sqrt{T(k^2)^2 - 4\\Delta(k^2)}\\right)$。最大化这个复杂的函数并非易事。然而，在图灵系统的标准分析中，增长率的最大值可以通过行列式函数 $\\Delta(k^2)$ 的最小值来很好地近似。这是因为 $\\Delta(k^2)$ 的变化（它与 $k^2$ 呈二次依赖关系）通常在其最大值附近主导增长率的行为，相比之下 $T(k^2)$ 呈线性依赖关系。\n\n因此，我们通过最小化关于 $k^2$ 的 $\\Delta(k^2)$ 来找到使不稳定性最大化的波数 $k_{max}$。\n$$\n\\frac{d}{d(k^2)} \\Delta(k^2) = \\frac{d}{d(k^2)} (20(k^2)^2 - 9k^2 + 0.5) = 40k^2 - 9\n$$\n将导数设为零，得到最优的波数平方：\n$$\n40 k_{max}^2 - 9 = 0 \\implies k_{max}^2 = \\frac{9}{40} = 0.225\n$$\n对应的波数是 $k_{max} = \\sqrt{0.225} \\approx 0.474$。\n\n系统仅支持离散的波数 $k_n = \\frac{n\\pi}{L}$，其中整数 $n \\ge 0$。当 $L=20$ 时，即为 $k_n = \\frac{n\\pi}{20}$。\n波数的平方为 $k_n^2 = \\frac{n^2\\pi^2}{400}$。\n我们必须找到整数 $n \\ge 1$（因为 $n=0$ 是稳定的），使得 $k_n^2$ 最接近 $k_{max}^2 = 0.225$。\n$$\n\\frac{n^2\\pi^2}{400} \\approx 0.225\n$$\n$$\nn^2 \\approx \\frac{400 \\times 0.225}{\\pi^2} = \\frac{90}{\\pi^2}\n$$\n使用 $\\pi \\approx 3.14159$，我们有 $\\pi^2 \\approx 9.8696$。\n$$\nn^2 \\approx \\frac{90}{9.8696} \\approx 9.1189\n$$\n$$\nn \\approx \\sqrt{9.1189} \\approx 3.0198\n$$\n最接近此值的整数是 $n=3$。\n为了确认，让我们将 $n=2, 3, 4$ 时的 $k_n^2$ 与 $k_{max}^2=0.225$ 进行比较：\n- 对于 $n=2$：$k_2^2 = \\frac{4\\pi^2}{400} = \\frac{\\pi^2}{100} \\approx 0.0987$。$|0.0987 - 0.225| = 0.1263$。\n- 对于 $n=3$：$k_3^2 = \\frac{9\\pi^2}{400} \\approx \\frac{9 \\times 9.8696}{400} \\approx 0.2221$。$|0.2221 - 0.225| = 0.0029$。\n- 对于 $n=4$：$k_4^2 = \\frac{16\\pi^2}{400} = \\frac{\\pi^2}{25} \\approx 0.3948$。$|0.3948 - 0.225| = 0.1698$。\n\n$k_3^2$ 的值比任何其他模都显著更接近最优值 $k_{max}^2$。因此，整数模数为 $n=3$ 的模将具有最大的增长率，并将成为初始选择以形成空间模式的模。", "answer": "$$\\boxed{3}$$", "id": "2758478"}]}