{"hands_on_practices": [{"introduction": "我们将从构建单个分子编辑事件的基础数学描述开始。本练习将不可逆的编辑过程视为一个连续时间马尔可夫过程（continuous-time Markov process），这是对生物学中随机事件进行建模的基石 [@problem_id:2752006]。通过掌握这一核心模型，你将能够量化一个记录位点在任意时间间隔 $t$ 内从“未编辑”状态转变为“已编辑”状态的概率。", "problem": "在一个用于细胞谱系追踪的脱氧核糖核酸 (DNA) 分子事件记录器中，每个靶位点初始时是未编辑状态，当腺嘌呤碱基编辑器被激活时，可以发生不可逆的编辑。经验证据表明，单个位点上的编辑事件是具有恒定风险率的独立泊松事件。考虑一个基因组位点，其状态空间为 $\\{\\text{未编辑}, \\text{已编辑}\\}$。假设一旦进入$\\text{已编辑}$状态，该位点将无限期地保持该状态（无逆转），并且从$\\text{未编辑}$状态到$\\text{已编辑}$状态的瞬时转移率是一个常数 $\\mu$，单位为$\\text{时间}^{-1}$。令 $t$ 表示经过的时间，其时间单位与 $\\mu$ 相同。\n\n仅从以下基本原理出发：\n- 对于风险恒为 $\\mu$ 的泊松事件，其等待时间服从指数分布，生存函数为 $\\exp(-\\mu t)$。\n- 时间齐次的连续时间马尔可夫链 (CTMC) 满足马尔可夫性质和柯尔莫哥洛夫方程，其生成元矩阵的非对角线元素为非负速率，且各行之和为零。\n\n将此单位点编辑过程建模为一个双态 CTMC，并从第一性原理出发，按照 $\\{\\text{未编辑}, \\text{已编辑}\\}$ 的状态顺序，推导出在时间 $t$ 的 $2 \\times 2$ 转移概率矩阵 $P(t)$。你的最终答案必须是一个以 $\\mu$ 和 $t$ 表示的单一闭式解析表达式。由于 $P(t)$ 的元素是概率，最终答案中无需包含物理单位。请勿对答案进行四舍五入。", "solution": "题目要求我们为一个代表单个分子记录器位点不可逆编辑过程的双态时间齐次连续时间马尔可夫链 (CTMC) 推导转移概率矩阵 $P(t)$。状态为 $\\{\\text{未编辑}, \\text{已编辑}\\}$，我们将按照这个顺序为 $P(t)$ 的行和列建立索引。\n\n根据题目陈述，该过程是一个泊松事件过程，从$\\text{未编辑}$到$\\text{已编辑}$的转移具有恒定风险 $\\mu$，且没有逆向转移。用 CTMC 的术语来说，生成元矩阵 $Q$ 的非对角线元素必须是非负速率，且各行之和为零。因此，在状态顺序为 $\\{\\text{未编辑}, \\text{已编辑}\\}$ 的情况下，我们有\n$$\nQ \\;=\\; \\begin{pmatrix}\n-\\mu & \\mu \\\\\n0 & 0\n\\end{pmatrix}.\n$$\n这反映出从$\\text{未编辑}$状态的离开率为 $\\mu$，且全部转移到$\\text{已编辑}$状态，而$\\text{已编辑}$状态是吸收态。\n\n从第一性原理出发，有两条互补的路径可以求得 $P(t)$：(i) 使用泊松过程的指数等待时间特征，为相关的转移概率写出并求解柯尔莫哥洛夫前向方程；或 (ii) 使用由时间齐次 CTMC 的柯尔莫哥洛夫方程所保证的矩阵指数 $P(t) = \\exp(Q t)$。我们采用路径 (i) 以便更贴近生物化学解释，然后验证其与路径 (ii) 的一致性。\n\n令 $p_{ij}(t)$ 表示在时间 $t$ 从初始状态 $i$ 转移到状态 $j$ 的概率，其中 $i,j \\in \\{\\text{未编辑}, \\text{已编辑}\\}$。我们要求解的是元素为 $p_{ij}(t)$ 的 $2 \\times 2$ 矩阵 $P(t)$。\n\n根据速率为 $\\mu$ 的首次编辑事件等待时间的指数生存函数，一个位点从“未编辑”状态开始，直到时间 $t$ 仍然保持未编辑状态的概率为\n$$\np_{\\text{未编辑},\\text{未编辑}}(t) \\;=\\; \\exp(-\\mu t).\n$$\n因为没有逆转过程，如果过程从“已编辑”状态开始，它将永远保持在该状态，所以\n$$\np_{\\text{已编辑},\\text{已编辑}}(t) \\;=\\; 1,\n\\qquad\np_{\\text{已编辑},\\text{未编辑}}(t) \\;=\\; 0.\n$$\n剩下的元素 $p_{\\text{未编辑},\\text{已编辑}}(t)$ 可以通过第一行的概率守恒得到，因为从“未编辑”状态出发，在时间 $t$ 只有两种可能：处于“未编辑”状态或“已编辑”状态：\n$$\np_{\\text{未编辑},\\text{已编辑}}(t) \\;=\\; 1 - p_{\\text{未编辑},\\text{未编辑}}(t) \\;=\\; 1 - \\exp(-\\mu t).\n$$\n\n按照行和列的指定状态顺序 $\\{\\text{未编辑}, \\text{已编辑}\\}$ 收集这些元素，我们得到\n$$\nP(t) \\;=\\; \\begin{pmatrix}\np_{\\text{未编辑},\\text{未编辑}}(t) & p_{\\text{未编辑},\\text{已编辑}}(t) \\\\\np_{\\text{已编辑},\\text{未编辑}}(t) & p_{\\text{已编辑},\\text{已编辑}}(t)\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\exp(-\\mu t) & 1 - \\exp(-\\mu t) \\\\\n0 & 1\n\\end{pmatrix}.\n$$\n\n为求完整，我们验证该解满足柯尔莫哥洛夫前向方程 $ \\frac{d}{dt} P(t) = P(t) Q$，初始条件为 $P(0)=I$，其中 $I$ 是单位矩阵。首先，注意到 $P(0) = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$，符合要求。接下来，计算时间导数：\n$$\n\\frac{d}{dt} P(t) \\;=\\; \\begin{pmatrix}\n-\\mu \\exp(-\\mu t) & \\mu \\exp(-\\mu t) \\\\\n0 & 0\n\\end{pmatrix}.\n$$\n计算 $P(t) Q$：\n$$\nP(t) Q \\;=\\; \n\\begin{pmatrix}\n\\exp(-\\mu t) & 1 - \\exp(-\\mu t) \\\\\n0 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n-\\mu & \\mu \\\\\n0 & 0\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n-\\mu \\exp(-\\mu t) & \\mu \\exp(-\\mu t) \\\\\n0 & 0\n\\end{pmatrix}.\n$$\n因此 $\\frac{d}{dt} P(t) = P(t) Q$，这证实了其与 CTMC 框架的一致性。根据该线性系统在初始条件 $P(0)=I$ 下解的唯一性，所推导的 $P(t)$ 即为转移概率矩阵。\n\n因此，在时间 $t$ 和速率 $\\mu$ 下的转移矩阵为\n$$\n\\begin{pmatrix}\n\\exp(-\\mu t) & 1 - \\exp(-\\mu t) \\\\\n0 & 1\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\exp(-\\mu t) & 1-\\exp(-\\mu t) \\\\ 0 & 1\\end{pmatrix}}$$", "id": "2752006"}, {"introduction": "一个模型最有价值之处在于它能够拟合真实数据。此练习直接建立在前一个练习的模型之上，展示了如何利用连续时间马尔可夫过程为在细胞谱系树上观察到的数据构建似然函数 [@problem_id:2752064]。你将把这个框架应用到一个具体场景中，通过观察到的编辑事件数量，对系统的关键参数——记录速率 $\\mu$ 进行最大似然估计（Maximum Likelihood Estimation）。", "problem": "一个实验室使用基于成簇规律间隔短回文重复序列 (CRISPR) 的分子事件记录器来追踪细胞谱系。该记录器由 $L$ 个独立的基因组条形码位点组成，在时间 $t=0$ 的根细胞中，这些位点初始状态均为未编辑。每个位点被建模为一个具有状态 $\\{0,1\\}$ 的双态连续时间过程，其中 $0$ 表示未编辑， $1$ 表示不可逆地编辑。在任何持续时间为 $t$ 的谱系分支上，转变 $0 \\to 1$ 遵循一个泊松过程，其恒定速率为每个位点每个单位时间 $\\mu$，且逆向突变 $1 \\to 0$ 是不可能的。细胞谱系形成一个具有已知分支时长的有根树拓扑结构 $\\mathcal{T}$。所有采样得到的叶节点都在同一最终时间被观测。观测数据是每个位点的叶节点状态（已编辑或未编辑）。\n\n仅从泊松过程和连续时间马尔可夫链的定义出发，并假设位点独立且所有位点速率相同：\n\n- 推导在给定拓扑结构 $\\mathcal{T}$ 和速率 $\\mu$ 的条件下，观测到的叶节点状态的单一位点似然，推导过程需要对内部节点上未观测到的祖先状态进行求和。然后写出 $L$ 个独立位点的完整似然。\n\n- 现在将问题特化到 $\\mathcal{T}$ 是一个具有 $m$ 个叶节点的有根星形拓扑结构，每个分支具有相同的持续时间 $t$。在这种情况下，对于每个位点，叶节点都从已知的根状态 $0$ 独立演化。假设 $m=4$， $t=20$ h，且 $L=1000$。在所有 $mL$ 个叶节点-位点对中，你观测到总共 $K=1230$ 个已编辑状态 ($1$) 和 $mL-K$ 个未编辑状态 ($0$)。计算这个星形拓扑结构数据集下 $\\mu$ 的最大似然估计 $\\hat{\\mu}$。将最终速率以 h$^{-1}$ 表示，并四舍五入到四位有效数字。", "solution": "问题分为两部分。第一部分，推导树上分子记录器的一般似然函数。第二部分，在特定的实验场景下计算记录速率 $\\mu$ 的最大似然估计。\n\n第一部分：似然函数的推导\n\n单个条形码位点的状态被建模为一个双态连续时间马尔可夫链，状态为 $\\{0, 1\\}$，分别代表未编辑和已编辑。从状态 $0$ 到状态 $1$ 的转变以恒定速率 $\\mu$ 发生。反向转变 $1 \\to 0$ 是禁止的，这使得状态 $1$ 成为一个吸收态。此过程的速率矩阵（或称生成元） $Q$ 为：\n$$\nQ = \\begin{pmatrix} -\\mu & \\mu \\\\ 0 & 0 \\end{pmatrix}\n$$\n在时间间隔 $t$ 内的概率转移矩阵 $P(t)$ 由矩阵指数 $P(t) = \\exp(Qt)$ 给出。元素 $P_{ij}(t)$ 给出在时间 $0$ 状态为 $i$ 的条件下，在时间 $t$ 处于状态 $j$ 的概率。主方程 $\\frac{d P(t)}{dt} = P(t)Q$ 的解给出了这些概率。具体来说，对于保持在状态 $0$ 的概率 $P_{00}(t)$：\n$$\n\\frac{d P_{00}(t)}{dt} = -\\mu P_{00}(t)\n$$\n在初始条件 $P_{00}(0) = 1$ 下，解为：\n$$\nP_{00}(t) = \\exp(-\\mu t)\n$$\n这是在时间间隔 $t$ 内发生零次编辑事件的概率，与泊松过程一致。由于只有两个状态，从 $0$ 转变到 $1$ 的概率为：\n$$\nP_{01}(t) = 1 - P_{00}(t) = 1 - \\exp(-\\mu t)\n$$\n因为状态 $1$ 是吸收态，我们有：\n$$\nP_{11}(t) = 1\n$$\n$$\nP_{10}(t) = 0\n$$\n现在，考虑在给定的具有已知分支时长的有根树拓扑结构 $\\mathcal{T}$ 上的单个位点。在时间 $t=0$ 的根细胞中，该位点处于状态 $0$。令叶节点集合为 $\\mathcal{L}$，内部节点集合为 $\\mathcal{I}$（包括根节点 $r$）。该位点的观测数据是状态集合 $D = \\{s_v | v \\in \\mathcal{L}\\}$，其中 $s_v \\in \\{0, 1\\}$。\n\n在给定速率 $\\mu$ 的条件下，观测到数据 $D$ 的似然是概率 $P(D | \\mu, \\mathcal{T})$。这通过对所有分配给未观测到的内部节点（不包括根节点，其状态固定为 $0$）的可能状态求和来得到。\n令 $s_{\\mathcal{I} \\setminus \\{r\\}}$ 为除根节点外内部节点的一种特定状态分配。单个位点的似然为：\n$$\nL_{\\text{site}}(\\mu) = P(D | s_r=0, \\mu, \\mathcal{T}) = \\sum_{s_{\\mathcal{I} \\setminus \\{r\\}}} P(D, s_{\\mathcal{I} \\setminus \\{r\\}} | s_r=0, \\mu, \\mathcal{T})\n$$\n对树中所有节点进行完整状态分配的联合概率是沿每个分支的转移概率的乘积。令 $u$ 为节点 $v$ 的父节点， $t_{uv}$ 为连接它们的分支的持续时间。\n$$\nP(D, s_{\\mathcal{I} \\setminus \\{r\\}} | s_r=0, \\mu, \\mathcal{T}) = \\prod_{(u,v) \\in \\text{edges}} P_{s_u s_v}(t_{uv})\n$$\n这个求和可以使用一种动态规划方法高效计算，该方法通常称为Felsenstein剪枝算法。对于每个节点 $v$ 和每个状态 $i \\in \\{0, 1\\}$，定义一个条件似然 $L_v(i)$，表示在 $v$ 处于状态 $i$ 的条件下，从 $v$ 派生的子树中观测到状态的概率。计算从叶节点向根节点进行。该位点的最终似然是在根节点 $v=r$ 处计算的 $L_v(0)$。\n\n由于 $L$ 个条形码位点是独立的，并且具有相同的速率 $\\mu$，因此所有位点观测状态的总似然是各个位点似然的乘积。令 $D_j$ 为位点 $j$ 的数据。\n$$\nL_{\\text{total}}(\\mu) = \\prod_{j=1}^{L} L_{\\text{site}, j}(\\mu)\n$$\n其中 $L_{\\text{site}, j}(\\mu)$ 是位点 $j$ 的似然，如上所述计算得出。\n\n第二部分：星形拓扑结构的最大似然估计\n\n现在问题特化为具有 $m$ 个叶节点的有根星形拓扑结构，其中每个叶节点通过一个持续时间为 $t$ 的分支与根节点相连。所有位点的根状态已知为 $0$。这种结构极大地简化了似然计算。鉴于根状态为 $0$， $m$ 个叶节点的状态沿着各自的分支彼此独立演化。\n\n对于任何给定叶节点上的任何给定位点，其状态是从状态 $0$ 开始、持续时间为 $t$ 的过程的结果。此叶节点-位点为未编辑（状态 $0$）的概率是：\n$$\np_0 = P(\\text{state}=0) = P_{00}(t) = \\exp(-\\mu t)\n$$\n此叶节点-位点为已编辑（状态 $1$）的概率是：\n$$\np_1 = P(\\text{state}=1) = P_{01}(t) = 1 - \\exp(-\\mu t)\n$$\n我们总共有 $N = m \\times L$ 个叶节点-位点对。每一个都构成了一个独立的伯努利试验，其成功概率为 $p_1$ （其中成功定义为处于已编辑状态 $1$）。\n数据被概括为观测到 $K$ 个总已编辑状态 ($1$) 和 $N-K$ 个未编辑状态 ($0$)。在 $N$ 次独立试验中观测到 $K$ 次成功的似然遵循二项分布：\n$$\nL(\\mu) = \\binom{N}{K} (p_1)^K (p_0)^{N-K}\n$$\n代入 $p_0$ 和 $p_1$ 的表达式：\n$$\nL(\\mu) = \\binom{N}{K} (1 - \\exp(-\\mu t))^K (\\exp(-\\mu t))^{N-K}\n$$\n为了找到最大似然估计（MLE） $\\hat{\\mu}$，我们对 $L(\\mu)$ 关于 $\\mu$ 进行最大化。最大化对数似然 $\\ln L(\\mu)$ 更为方便：\n$$\n\\ln L(\\mu) = \\ln\\binom{N}{K} + K \\ln(1 - \\exp(-\\mu t)) + (N-K) \\ln(\\exp(-\\mu t))\n$$\n$$\n\\ln L(\\mu) = \\ln\\binom{N}{K} + K \\ln(1 - \\exp(-\\mu t)) - (N-K)\\mu t\n$$\n我们对 $\\mu$ 求导，并令结果为零：\n$$\n\\frac{d}{d\\mu} \\ln L(\\mu) = K \\left( \\frac{1}{1 - \\exp(-\\mu t)} \\right) ( - \\exp(-\\mu t) ) (-t) - (N-K)t = 0\n$$\n$$\n\\frac{K t \\exp(-\\mu t)}{1 - \\exp(-\\mu t)} - (N-K)t = 0\n$$\n假设 $t \\neq 0$，我们可以两边同除以 $t$：\n$$\n\\frac{K \\exp(-\\mu t)}{1 - \\exp(-\\mu t)} = N-K\n$$\n$$\nK \\exp(-\\mu t) = (N-K)(1 - \\exp(-\\mu t))\n$$\n$$\nK \\exp(-\\mu t) = N - K - (N-K)\\exp(-\\mu t)\n$$\n$$\n(K + N - K) \\exp(-\\mu t) = N - K\n$$\n$$\nN \\exp(-\\mu t) = N - K\n$$\n$$\n\\exp(-\\mu t) = \\frac{N-K}{N} = 1 - \\frac{K}{N}\n$$\n求解 $\\mu$ 得到最大似然估计(MLE) $\\hat{\\mu}$：\n$$\n-\\hat{\\mu} t = \\ln\\left(1 - \\frac{K}{N}\\right)\n$$\n$$\n\\hat{\\mu} = -\\frac{1}{t} \\ln\\left(1 - \\frac{K}{N}\\right)\n$$\n现在我们代入给定的数值：\n$m = 4$\n$L = 1000$\n$t = 20$ h\n$K = 1230$\n观测总数为 $N = m \\times L = 4 \\times 1000 = 4000$。\n\n将这些值代入 $\\hat{\\mu}$ 的公式中：\n$$\n\\hat{\\mu} = -\\frac{1}{20} \\ln\\left(1 - \\frac{1230}{4000}\\right)\n$$\n$$\n\\hat{\\mu} = -\\frac{1}{20} \\ln\\left(1 - 0.3075\\right)\n$$\n$$\n\\hat{\\mu} = -\\frac{1}{20} \\ln(0.6925)\n$$\n计算该值：\n$$\n\\hat{\\mu} \\approx -\\frac{1}{20} (-0.3674608) \\approx 0.01837304 \\, \\text{h}^{-1}\n$$\n按要求四舍五入到四位有效数字：\n$$\n\\hat{\\mu} \\approx 0.01837 \\, \\text{h}^{-1}\n$$", "answer": "$$\n\\boxed{0.01837}\n$$", "id": "2752064"}, {"introduction": "在推断出谱系树并估计了参数之后，我们如何确定模型没有对数据产生过拟合？最后的这个练习将探讨模型验证这一关键步骤 [@problem_id:2752017]。由于谱系数据中固有的相关性（细胞并非相互独立），标准的交叉验证方法会失效；本练习要求你识别出能够尊重数据依赖结构的、在统计上有效的交叉验证方案，这是进行严谨计算分析的一项至关重要的技能。", "problem": "给定一个由基于CRISPR（成簇规律间隔短回文重复序列）的编辑技术生成的合成谱系记录器数据集。设$N$表示细胞（叶节点）的数量，$S$表示记录位点的数量，$X \\in \\mathcal{X}^{N \\times S}$是观测到的细胞各位点状态矩阵。假设一个生成模型，其中一个具有分支长度$\\{b_{e}\\}$的潜在一棵有根树$T$控制着遗传过程，并且每个位点$s \\in \\{1,\\dots,S\\}$都沿着$T$根据一个参数为$\\theta_{s}$的、参数化的、时间齐次的、位点特异性的随机过程演化（例如，一个速率为$\\lambda_{s}$、结果概率为$\\pi_{s}$的不可逆编辑过程）。在给定$(T,\\{\\theta_{s}\\}_{s=1}^{S})$的条件下，各位点是独立的，因此似然函数可以分解为\n$$\np(X \\mid T,\\{\\theta_{s}\\}_{s=1}^{S}) \\;=\\; \\prod_{s=1}^{S} p\\big(X_{\\cdot s} \\mid T,\\theta_{s}\\big).\n$$\n进一步假设，(i) 要么位点是可交换的，其中$\\theta_{s} \\stackrel{\\text{i.i.d.}}{\\sim} F$，$F$为某个分布；(ii) 要么位点被划分为$G$个已知的组（例如，盒或阵列），组索引为$g(s) \\in \\{1,\\dots,G\\}$，其中各组之间条件独立，且组内参数是可交换的：$\\theta_{s} \\mid g(s)=g \\stackrel{\\text{i.i.d.}}{\\sim} F_{g}$。\n\n你的目标是通过交叉验证来评估和防止谱系树推断中的过拟合。考虑评估的目标是在相同数据生成过程下的样本外预测对数似然。当按位点划分时，目标是在从相同过程中抽取的新位点上的表现。当按细胞划分时，目标是在由相同谱系和编辑过程生成的未观测到的叶节点上的表现。\n\n在所述假设下，以下哪种交叉验证设计能够对相应的样本外预测对数似然目标产生渐近无偏估计量？为什么？\n\nA. 随机将$N$个细胞分成$K$折。对每一折，使用所有$S$个位点在训练细胞上拟合$(\\hat{T},\\hat{\\Theta})$。对每个测试细胞$c$，首先使用$X_{c\\cdot}$将其连接到$\\hat{T}$上的最大似然位置，然后计算$\\log p\\big(X_{c\\cdot} \\mid \\hat{T},\\hat{\\Theta}, \\widehat{\\text{attach}}(c)\\big)$，并对所有测试细胞和所有折取平均值。\n\nB. 对位点进行$K$折交叉验证：将$\\{1,\\dots,S\\}$划分为$K$折。对每一折，仅使用训练位点推断$(\\hat{T},\\hat{\\Theta}_{\\text{shared}})$，其中$\\hat{\\Theta}_{\\text{shared}}$表示跨位点共享的任何参数（例如，$F$的超参数或过程约束）；然后评估留出位点的预测对数似然$\\sum_{s \\in \\text{test}} \\log p\\big(X_{\\cdot s} \\mid \\hat{T},\\hat{\\theta}_{s}^{\\star}\\big)$，其中$\\hat{\\theta}_{s}^{\\star}$通过仅在训练集上进行经验贝叶斯估计，或在从训练位点估计出的先验下对$\\theta_{s}$进行积分得到。对所有折取平均值。\n\nC. 如果位点被分组成$G$个相互依赖的盒，则对位点组进行分组$K$折交叉验证：将$\\{1,\\dots,G\\}$划分为多折，仅在训练组上拟合$(\\hat{T},\\{\\hat{F}_{g}\\})$，并通过在对应的$\\hat{F}_{g}$下对留出组中的$s$的$\\theta_{s}$进行积分，来评估留出组的预测对数似然。对所有折取平均值。\n\nD. 对细胞进行进化支块交叉验证：在指定的深度范围内对内部节点进行采样，并将整个后代叶节点集作为测试进化支留出。使用所有位点在剩余的细胞上拟合$(\\hat{T},\\hat{\\Theta})$。对于一个留出的进化支$C$，通过后验预测密度\n$$\n\\log p\\big(X_{C} \\mid X_{-C}\\big) \\;=\\; \\log \\int p\\big(X_{C} \\mid T,\\Theta\\big) \\, p\\big(T,\\Theta \\mid X_{-C}\\big) \\,\\mathrm{d}T\\,\\mathrm{d}\\Theta,\n$$\n来对其数据进行评分，在实践中，该值可通过插件式$\\log p\\big(X_{C} \\mid \\hat{T},\\hat{\\Theta}\\big)$或通过从$p\\big(T,\\Theta \\mid X_{-C}\\big)$进行蒙特卡洛采样来近似。对所有留出的进化支取平均值。\n\nE. 为减少依赖性，在每个位点列$X_{\\cdot s}$内部跨细胞随机置换条目，然后执行如选项B中所示的随机位点级$K$折交叉验证。\n\n选择所有在上述意义上统计有效的选项，并利用似然分解、可交换性和分层模型下适当预测评分的基本原理来证明你的选择。你的证明必须明确地将数据划分与独立性或可交换性结构联系起来，并解释为什么由此产生的估计量能够针对所期望的样本外数量。", "solution": "一个交叉验证方案的有效性取决于一个关键的基本原则：将数据划分为训练集和测试集的程序必须能产生在统计上代表“新”数据的测试集，这里的“新”数据是根据一个特定定义而言的。只有当数据划分尊重生成模型的潜在依赖结构时，才能实现对样本外预测性能的渐近无偏估计。在本问题的背景下，数据$X$的行（细胞）和列（位点）之间都表现出依赖性，这种依赖性是由潜在树$T$和位点参数$\\Theta$的分层结构介导的。我们根据这一原则评估每种提议的设计。\n\nA. 随机将$N$个细胞分成$K$折。对每一折，使用所有$S$个位点在训练细胞上拟合$(\\hat{T},\\hat{\\Theta})$。对每个测试细胞$c$，首先使用$X_{c\\cdot}$将其连接到$\\hat{T}$上的最大似然位置，然后计算$\\log p\\big(X_{c\\cdot} \\mid \\hat{T},\\hat{\\Theta}, \\widehat{\\text{attach}}(c)\\big)$，并对所有测试细胞和所有折取平均值。\n\n此程序在统计上是无效的。细胞作为单个系统发育树$T$的叶节点，它们不是独立同分布（$i.i.d.$）的样本。由于共同的祖先，它们的状态是相关的。将细胞随机划分为训练折和测试折忽略了这种基本的依赖性。一个测试细胞很可能与一个或多个训练细胞亲缘关系很近。来自这些相关训练细胞的信息将使对测试细胞数据的预测变得人为地容易，从而导致在估计的预测对数似然中出现乐观偏差。由此产生的估计量测量的不是对谱系中真正“新”部分的泛化能力，而是在已知拓扑结构中插入单个叶节点的性能。这是将标准交叉验证应用于系统发育相关数据时的典型错误。\n\n**结论：不正确**\n\nB. 对位点进行$K$折交叉验证：将$\\{1,\\dots,S\\}$划分为$K$折。对每一折，仅使用训练位点推断$(\\hat{T},\\hat{\\Theta}_{\\text{shared}})$，其中$\\hat{\\Theta}_{\\text{shared}}$表示跨位点共享的任何参数（例如，$F$的超参数或过程约束）；然后评估留出位点的预测对数似然$\\sum_{s \\in \\text{test}} \\log p\\big(X_{\\cdot s} \\mid \\hat{T},\\hat{\\theta}_{s}^{\\star}\\big)$，其中$\\hat{\\theta}_{s}^{\\star}$通过仅在训练集上进行经验贝叶斯估计，或在从训练位点估计出的先验下对$\\theta_{s}$进行积分得到。对所有折取平均值。\n\n此程序在统计上是有效的。问题陈述中指出，位点是从一个使它们变得可交换的过程中抽取的：要么$\\theta_s \\stackrel{\\text{i.i.d.}}{\\sim} F$，要么它们在组内是可交换的。这种可交换性意味着数据矩阵的列$X_{\\cdot s}$，就位点属性而言，是“实验”的基本、可重复单元。按位点划分能够正确地创建出从该位点生成过程中独立抽取的训练集和测试集。训练位点用于学习共享结构（树$\\hat{T}$）和位点演化的群体水平参数（$\\hat{\\Theta}_{\\text{shared}}$，例如$F$的超参数）。该程序随后正确地评估了模型在给定推断出的共享结构下，预测来自相同分布的新位点数据的能力。这与评估“在从相同过程中抽取的新位点上的表现”这一既定目标完全匹配。使用经验贝叶斯或边缘化来获得$\\hat{\\theta}_{s}^{\\star}$是恰当的分层建模方法。\n\n**结论：正确**\n\nC. 如果位点被分组成$G$个相互依赖的盒，则对位点组进行分组$K$折交叉验证：将$\\{1,\\dots,G\\}$划分为多折，仅在训练组上拟合$(\\hat{T},\\{\\hat{F}_{g}\\})$，并通过在对应的$\\hat{F}_{g}$下对留出组中的$s$的$\\theta_{s}$进行积分，来评估留出组的预测对数似然。对所有折取平均值。\n\n此程序在统计上也是有效的，并且当存在已知的组结构时，它是对方法B的必要改进。问题陈述中指出，在情况(ii)下，参数在组*内*是可交换的，而在组*间*是条件独立的。这确立了组（盒）作为可交换单元。如果组*内*的位点之间存在未建模的依赖关系，那么像B中那样的标准位点级交叉验证将是无效的，因为它会破坏这些依赖关系，从而导致乐观的性能估计。通过将整个组留出，该程序正确地考虑了任何此类组内相关性。它评估了模型泛化到全新位点组的能力，当存在这种组结构时，这是一个正确的目标。这是分块交叉验证的一个标准且稳健的应用，对于具有分层依赖性的数据至关重要。\n\n**结论：正确**\n\nD. 对细胞进行进化支块交叉验证：在指定的深度范围内对内部节点进行采样，并将整个后代叶节点集作为测试进化支留出。使用所有位点在剩余的细胞上拟合$(\\hat{T},\\hat{\\Theta})$。对于一个留出的进化支$C$，通过后验预测密度$\\log p\\big(X_{C} \\mid X_{-C}\\big)$来对其数据进行评分，在实践中，该值可被近似计算。对所有留出的进化支取平均值。\n\n对于评估在未观测到的叶节点上的性能这一目标，此程序在统计上是有效的。这是一种专门为解决细胞非独立性问题而设计的复杂方法。与A中的朴素随机划分不同，将整个进化支留出尊重了系统发育的依赖结构。它模拟了一个更真实的缺失数据场景，即谱系的整个分支未被采样。评估指标，即给定训练数据下测试数据的后验预测概率$p\\big(X_{C} \\mid X_{-C}\\big)$，是用于预测模型检查的原则性贝叶斯度量。该方法正确地评估了一个在部分谱系上训练的模型，预测同一谱系中一个独立的、未观测到部分的演化历史和最终状态的能力。这是一种针对结构化数据的成熟技术，类似于时间序列的前向链或分块交叉验证。\n\n**结论：正确**\n\nE. 为减少依赖性，在每个位点列$X_{\\cdot s}$内部跨细胞随机置换条目，然后执行如选项B中所示的随机位点级$K$折交叉验证。\n\n这个程序是荒谬的，表明了对建模目标的根本误解。核心的科学任务是推断谱系树$T$，该树的信息编码在不同位点（列）上*细胞之间*（行）的相关性中。在每个列$X_{\\cdot s}$内随机置换条目会完全破坏这种系统发育信号。由此产生的数据矩阵与真实的潜在树$T$没有任何关系。对这个被置换过的数据进行交叉验证，将评估模型拟合每个位点上字符状态边缘分布的能力，这个任务与谱系重建完全脱节。其宣称的目的“减少依赖性”是反常的；由树引起的依赖性正是需要建模的信号，而不是需要消除的干扰因素。该程序没有以任何有意义的方式评估指定的模型。\n\n**结论：不正确**", "answer": "$$\\boxed{BCD}$$", "id": "2752017"}]}