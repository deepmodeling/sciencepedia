{"hands_on_practices": [{"introduction": "双稳态是设计生物记忆模块的核心机制，它能使细胞在“开”和“关”两种稳定状态之间切换。本练习将深入探讨产生这种行为的数学原理，特别是正反馈回路如何产生迟滞效应，从而赋予系统记忆功能 [@problem_id:2037230]。通过分析描述基因开关的动力学方程，你将动手计算触发状态转换所需的临界诱导物浓度 $[S]_{up}$，从而将抽象的理论与定量的预测联系起来。", "problem": "一位合成生物学家正在一个细菌菌株中设计一个基因“记忆”电路。该记忆的状态由一种荧光蛋白P的浓度决定。该电路的设计使得编码P的基因以一个恒定的低基础速率表达。此外，蛋白P可以作为其自身基因的转录激活因子，从而形成一个正反馈回路。这种自我激活是协同的，需要两个P分子结合到启动子上，并且依赖于一种化学诱导剂S的存在。\n\n蛋白浓度$[P]$的动力学可以用以下微分方程描述：\n$$\n\\frac{d[P]}{dt} = k_{basal} + V_{max}([S]) \\frac{[P]^2}{K^2 + [P]^2} - \\gamma [P]\n$$\n其中，最大激活产出速率$V_{max}$根据类似米氏方程的函数依赖于诱导剂浓度$[S]$：\n$$\nV_{max}([S]) = V_{peak} \\frac{[S]}{K_S + [S]}\n$$\n该系统被设计用来表现出记忆效应（迟滞现象）。当诱导剂浓度$[S]$从零缓慢增加时，系统保持在低表达状态，直到$[S]$达到一个临界值$[S]_{up}$，此时蛋白浓度会突然转换到高表达状态。实验已确定，当蛋白浓度达到临界值$[P]_{up} = 2.00 \\text{ }\\mu\\text{M}$时，会恰好发生这种向上转换。\n\n使用下面提供的参数，计算触发此转换所需的临界诱导剂浓度$[S]_{up}$。\n\n- 基础产出速率, $k_{basal} = 0.075 \\text{ }\\mu\\text{M} \\cdot \\text{min}^{-1}$\n- 峰值激活产出速率, $V_{peak} = 2.00 \\text{ }\\mu\\text{M} \\cdot \\text{min}^{-1}$\n- 蛋白降解速率常数, $\\gamma = 0.100 \\text{ min}^{-1}$\n- 蛋白P的激活常数, $K = 4.00 \\text{ }\\mu\\text{M}$\n- 诱导剂S的激活常数, $K_S = 10.0 \\text{ }\\mu\\text{M}$\n\n将您计算的$[S]_{up}$答案以$\\mu\\text{M}$为单位表示，并四舍五入到三位有效数字。", "solution": "蛋白质动力学由下式给出\n$$\n\\frac{d[P]}{dt} = k_{basal} + V_{max}([S]) \\frac{[P]^{2}}{K^{2} + [P]^{2}} - \\gamma [P].\n$$\n定义 $f(P;S) = k_{basal} + V_{max}([S]) \\frac{P^{2}}{K^{2} + P^{2}} - \\gamma P$。在向上转换点（一个鞍-节分岔点），稳态条件和相切条件同时成立：\n$$\nf(P_{up}; S_{up}) = 0, \\quad \\frac{\\partial f}{\\partial P}(P_{up}; S_{up}) = 0.\n$$\n计算导数：\n$$\n\\frac{\\partial f}{\\partial P} = V_{max}([S]) \\cdot \\frac{2 K^{2} P}{(K^{2} + P^{2})^{2}} - \\gamma.\n$$\n因此，相切条件给出\n$$\nV_{max}([S_{up}]) = \\gamma \\frac{(K^{2} + P_{up}^{2})^{2}}{2 K^{2} P_{up}}.\n$$\n将此代入稳态条件：\n$$\n0 = k_{basal} + \\left[\\gamma \\frac{(K^{2} + P_{up}^{2})^{2}}{2 K^{2} P_{up}}\\right] \\frac{P_{up}^{2}}{K^{2} + P_{up}^{2}} - \\gamma P_{up}\n= k_{basal} + \\gamma \\frac{(K^{2} + P_{up}^{2}) P_{up}}{2 K^{2}} - \\gamma P_{up}.\n$$\n这可以简化为一致性条件\n$$\nk_{basal} + \\gamma P_{up} \\frac{P_{up}^{2} - K^{2}}{2 K^{2}} = 0,\n$$\n给定的$P_{up}$和参数满足此条件（下文将进行验证）。\n\n现在将$V_{max}$与诱导剂联系起来：\n$$\nV_{max}([S]) = V_{peak} \\frac{[S]}{K_{S} + [S]} \\quad \\Rightarrow \\quad [S] = \\frac{K_{S} V_{max}}{V_{peak} - V_{max}}.\n$$\n使用给定的$P_{up}$计算转换点处的$V_{max}$：\n$$\nV_{max}([S_{up}]) = \\gamma \\frac{(K^{2} + P_{up}^{2})^{2}}{2 K^{2} P_{up}}.\n$$\n当$P_{up} = 2.00$，$K = 4.00$，$\\gamma = 0.100$（使用所述单位）时，\n$$\nK^{2} = 16,\\quad P_{up}^{2} = 4,\\quad K^{2} + P_{up}^{2} = 20,\\quad (K^{2} + P_{up}^{2})^{2} = 400,\n$$\n$$\nV_{max}([S_{up}]) = 0.100 \\cdot \\frac{400}{2 \\cdot 16 \\cdot 2} = 0.100 \\cdot \\frac{400}{64} = 0.625.\n$$\n检验稳态一致性：\n$$\nk_{basal} + V_{max}\\frac{P_{up}^{2}}{K^{2} + P_{up}^{2}} - \\gamma P_{up} = 0.075 + 0.625 \\cdot \\frac{4}{20} - 0.100 \\cdot 2.00 = 0.075 + 0.125 - 0.200 = 0,\n$$\n证实了条件得到满足。\n\n最后，使用$V_{peak} = 2.00$和$K_{S} = 10.0$求解$[S]_{up}$：\n$$\n[S]_{up} = \\frac{K_{S} V_{max}([S_{up}])}{V_{peak} - V_{max}([S_{up}])} = \\frac{10.0 \\cdot 0.625}{2.00 - 0.625} = \\frac{6.25}{1.375} = \\frac{50}{11} \\approx 4.54545.\n$$\n四舍五入到三位有效数字，$[S]_{up} = 4.55$（单位符合要求）。", "answer": "$$\\boxed{4.55}$$", "id": "2037230"}, {"introduction": "在构建了基本的记忆元件后，下一步是利用它来记录随时间变化的信号，并准确地回溯这段历史。然而，从细胞DNA中读取记录并非直接观察，而是一个充满噪声的推理过程。本练习将引导你使用强大的概率模型——隐马尔可夫模型（HMM），来解决这个解码难题 [@problem_id:2734309]。你将推导并实现前向-后向算法，从一系列不完美的、不可逆的编辑观测值 $O_{1:T}$ 中，推断出最有可能的隐藏输入信号序列 $I_{1:T}$。", "problem": "您正在为一个基因组编辑生物记忆设备建模，在该设备中，细胞在每个离散时间步的分子输入是隐藏的，但会通过在基因组位点中累积的编辑留下记录。该系统由一个离散时间概率模型描述，该模型包含两个隐藏过程：一个二元输入过程和一个二元记忆状态过程。观测值是在每个时间点检测到编辑与否的读出结果。您需要从第一性原理出发，推导计算给定观测值下输入过程的后验边际概率所需的前向和后向递归，然后实现一个程序，将这些递归应用于指定的测试套件。最终程序的输出必须是单行文本，其中包含每个测试用例的解码后输入序列列表。\n\n模型规范。时间从 $t=1$ 到 $t=T$。隐藏的输入过程是 $I_t \\in \\{0,1\\}$，其中 $I_t=1$ 表示外部输入存在，$I_t=0$ 表示其不存在。隐藏的记忆状态是 $S_t \\in \\{0,1\\}$，其中 $S_t=0$ 表示未编辑的位点，$S_t=1$ 表示已编辑的位点。观测值是 $O_t \\in \\{0,1\\}$，其中 $O_t=1$ 表示在测序中检测到编辑，$O_t=0$ 表示未检测到编辑。第一个时间步之前的初始记忆状态几乎必然地固定为 $S_0=0$。\n\n该模型遵循以下条件独立性和因子分解，这些都基于隐马尔可夫模型和动态贝叶斯网络的标准假设：输入过程是一个一阶马尔可夫链，其转移矩阵为 $A_I$，初始分布为 $\\pi_I$；记忆状态的转移取决于当前输入和前一个记忆状态；观测值仅取决于当前记忆状态。形式上：\n- $P(I_1=i) = \\pi_I[i]$ 且当 $t \\ge 2$ 时，$P(I_t=i \\mid I_{t-1}=j) = A_I[j,i]$。\n- $P(S_t \\mid S_{t-1}, I_t)$ 由一个输入调控的、符合生物学现实的不可逆编辑过程指定：一旦编辑，位点将保持编辑状态。具体来说，对于 $S_{t-1}=0$ 的情况，$P(S_t=1 \\mid S_{t-1}=0, I_t=0) = p_{\\mathrm{off}}$ 且 $P(S_t=1 \\mid S_{t-1}=0, I_t=1) = p_{\\mathrm{on}}$，对于 $i \\in \\{0,1\\}$，$P(S_t=0 \\mid S_{t-1}=0, I_t=i) = 1 - P(S_t=1 \\mid S_{t-1}=0, I_t=i)$。对于 $S_{t-1}=1$ 的情况，对于 $i \\in \\{0,1\\}$ 两种情况，都有 $P(S_t=1 \\mid S_{t-1}=1, I_t=i) = 1$。\n- 在给定记忆状态的情况下，观测值由跨时间独立的测序噪声生成：$P(O_t=1 \\mid S_t=1) = q$ 和 $P(O_t=1 \\mid S_t=0) = r$，对于 $s \\in \\{0,1\\}$，$P(O_t=0 \\mid S_t=s) = 1 - P(O_t=1 \\mid S_t=s)$。\n\n任务。\n1. 仅使用概率的乘法法则、全概率定律、贝叶斯定理和上述规定的马尔可夫性质，推导前向和后向递归，以计算对于每个 $t \\in \\{1,\\dots,T\\}$ 和 $i \\in \\{0,1\\}$ 的平滑后验边际概率 $P(I_t=i \\mid O_{1:T})$，其中 $O_{1:T}$ 表示观测序列。您的推导不得假设任何预先给出的隐马尔可夫模型公式；它必须从这些基本原理开始。推导应以联合隐过程 $(S_t, I_t)$ 和给定的条件分布来表示。\n2. 设计一个算法，该算法能够以数值稳定的方式实现这些递归，适用于任意 $T$，并使用缩放或对数变换来避免下溢。您的算法应能生成由 $\\hat{I}_t = \\arg\\max_{i \\in \\{0,1\\}} P(I_t=i \\mid O_{1:T})$ 定义的每个时间点 $t$ 的解码后输入历史。\n3. 将该算法实现为一个程序，该程序在下面提供的测试套件上运行，并以单行列表的形式输出解码后的输入历史。不涉及物理单位。所有概率必须表示为 $[0,1]$ 区间内的小数。\n\n测试套件。对于每个测试用例，您将获得 $T$、输入转移矩阵 $A_I$、输入先验 $\\pi_I$、记忆转移编辑概率 $p_{\\mathrm{off}}$ 和 $p_{\\mathrm{on}}$、观测参数 $q$ 和 $r$，以及观测序列 $O_{1:T}$。\n\n- 测试用例 1:\n  - $T=6$\n  - $A_I = \\begin{bmatrix} 0.95 & 0.05 \\\\ 0.10 & 0.90 \\end{bmatrix}$\n  - $\\pi_I = \\begin{bmatrix} 0.90 & 0.10 \\end{bmatrix}$\n  - $p_{\\mathrm{off}} = 0.01$, $p_{\\mathrm{on}} = 0.20$\n  - $q = 0.95$, $r = 0.05$\n  - $O_{1:6} = [0,0,1,1,1,1]$\n- 测试用例 2:\n  - $T=4$\n  - $A_I = \\begin{bmatrix} 0.98 & 0.02 \\\\ 0.02 & 0.98 \\end{bmatrix}$\n  - $\\pi_I = \\begin{bmatrix} 0.95 & 0.05 \\end{bmatrix}$\n  - $p_{\\mathrm{off}} = 0.005$, $p_{\\mathrm{on}} = 0.15$\n  - $q = 0.98$, $r = 0.02$\n  - $O_{1:4} = [0,0,0,0]$\n- 测试用例 3:\n  - $T=5$\n  - $A_I = \\begin{bmatrix} 0.90 & 0.10 \\\\ 0.10 & 0.90 \\end{bmatrix}$\n  - $\\pi_I = \\begin{bmatrix} 0.50 & 0.50 \\end{bmatrix}$\n  - $p_{\\mathrm{off}} = 0.001$, $p_{\\mathrm{on}} = 0.30$\n  - $q = 0.95$, $r = 0.05$\n  - $O_{1:5} = [1,1,1,1,1]$\n- 测试用例 4:\n  - $T=5$\n  - $A_I = \\begin{bmatrix} 0.90 & 0.10 \\\\ 0.10 & 0.90 \\end{bmatrix}$\n  - $\\pi_I = \\begin{bmatrix} 0.80 & 0.20 \\end{bmatrix}$\n  - $p_{\\mathrm{off}} = 0.05$, $p_{\\mathrm{on}} = 0.10$\n  - $q = 0.90$, $r = 0.10$\n  - $O_{1:5} = [0,1,0,1,0]$\n\n最终输出格式。您的程序应生成单行输出，其中包含四个测试用例的解码后输入序列，格式为用方括号括起来的、逗号分隔的列表，其中每个解码序列本身是按时间顺序排列的整数 $0$ 或 $1$ 的列表。例如，所需格式为 $[\\,[0,1,1],\\,[0,0],\\,[1,1,1],\\,[0,1]\\,]$，适用于四个用例。程序不得读取任何输入，也不得打印任何其他文本。每个用例的答案是解码后的整数列表，可以直接进行测试。", "solution": "该问题要求推导并实现一个算法，以从一个带噪声的观测序列 $O_{1:T}$ 推断出隐藏的输入序列 $I_{1:T}$。该系统是一个离散时间概率模型，涉及两个耦合的隐藏过程：输入 $I_t \\in \\{0, 1\\}$ 和记忆状态 $S_t \\in \\{0, 1\\}$。这种结构是动态贝叶斯网络的一个特例，而推断任务是一个经典的平滑问题。我们将系统地进行，从第一性原理开始进行形式化推导。\n\n令时间 $t$ 的联合隐状态为 $X_t = (S_t, I_t)$。$X_t$ 的状态空间由 4 个状态组成：$\\{(0,0), (0,1), (1,0), (1,1)\\}$。问题现在是给定观测序列 $O_{1:T}$，推断隐藏状态序列 $X_{1:T}$ 的 $I_t$分量。这可以通过前向-后向算法实现，我们从概率论的基本公理推导出该算法。\n\n**根据联合状态 $X_t = (S_t, I_t)$ 的模型规范**\n\n1.  **初始状态概率**: $P(X_1 = (s,i))$。\n    给定固定的初始条件 $S_0=0$ 以及 $I_1$ 独立于 $S_0$，我们有：\n    $$P(X_1=(s,i)) = P(S_1=s, I_1=i) = P(S_1=s \\mid I_1=i, S_0=0) P(I_1=i) = P(S_1=s \\mid S_0=0, I_1=i) \\pi_I[i]$$\n\n2.  **状态转移概率**: $P(X_t=(s,i) \\mid X_{t-1}=(s',j))$。\n    使用链式法则和指定的条件独立性：\n    $$P(X_t=(s,i) \\mid X_{t-1}=(s',j)) = P(S_t=s, I_t=i \\mid S_{t-1}=s', I_{t-1}=j)$$\n    $$= P(S_t=s \\mid I_t=i, S_{t-1}=s') P(I_t=i \\mid I_{t-1}=j)$$\n    第一项，$P(S_t=s \\mid S_{t-1}=s', I_t=i)$，由具有概率 $p_{\\mathrm{off}}$ 和 $p_{\\mathrm{on}}$ 的不可逆编辑过程定义。第二项是输入马尔可夫链的转移，$A_I[j,i]$。\n\n3.  **观测（发射）概率**: $P(O_t=o \\mid X_t=(s,i))$。\n    观测值 $O_t$ 仅取决于记忆状态 $S_t$：\n    $$P(O_t=o \\mid X_t=(s,i)) = P(O_t=o \\mid S_t=s)$$\n    这由测序噪声参数 $q$ 和 $r$ 定义。\n\n**前向-后向算法的推导**\n\n我们的目标是计算 $P(I_t=i \\mid O_{1:T})$。我们首先找到联合平滑后验概率 $P(S_t=s, I_t=i \\mid O_{1:T})$，然后对 $S_t$ 进行边缘化。\n\n**前向递归**\n令 $\\alpha_t(s,i) \\equiv P(S_t=s, I_t=i, O_{1:t})$ 为在时间 $t$ 的隐状态与截至时间 $t$ 的观测序列的联合概率。\n\n-   **初始化 ($t=1$):**\n    根据乘法法则和模型定义：\n    $$\\alpha_1(s,i) = P(O_1 \\mid S_1=s, I_1=i) P(S_1=s, I_1=i) = P(O_1 \\mid S_1=s) P(S_1=s \\mid S_0=0, I_1=i) \\pi_I[i]$$\n\n-   **递归 ($t > 1$):**\n    我们用 $\\alpha_{t-1}$ 表示 $\\alpha_t(s,i)$。\n    $$\\alpha_t(s,i) = P(S_t=s, I_t=i, O_{1:t}) = P(O_t \\mid S_t=s, I_t=i, O_{1:t-1}) P(S_t=s, I_t=i, O_{1:t-1})$$\n    根据条件独立性，$P(O_t \\mid S_t=s, I_t=i, O_{1:t-1}) = P(O_t \\mid S_t=s)$。对于第二项，我们对 $t-1$ 时刻的状态进行边缘化：\n    $$P(S_t=s, I_t=i, O_{1:t-1}) = \\sum_{s' \\in \\{0,1\\}} \\sum_{j \\in \\{0,1\\}} P(S_t=s, I_t=i, S_{t-1}=s', I_{t-1}=j, O_{1:t-1})$$\n    $$= \\sum_{s'} \\sum_{j} P(S_t=s, I_t=i \\mid S_{t-1}=s', I_{t-1}=j, O_{1:t-1}) P(S_{t-1}=s', I_{t-1}=j, O_{1:t-1})$$\n    状态转移独立于过去的观测，因此 $P(\\dots \\mid S_{t-1}, I_{t-1}, O_{1:t-1}) = P(S_t=s, I_t=i \\mid S_{t-1}=s', I_{t-1}=j)$。最后一项恰好是 $\\alpha_{t-1}(s',j)$。\n    将这些结合起来得到递归式：\n    $$\\alpha_t(s,i) = P(O_t \\mid S_t=s) \\sum_{s'} \\sum_{j} P(S_t=s \\mid S_{t-1}=s', I_t=i) P(I_t=i \\mid I_{t-1}=j) \\alpha_{t-1}(s',j)$$\n\n**后向递归**\n令 $\\beta_t(s,i) \\equiv P(O_{t+1:T} \\mid S_t=s, I_t=i)$ 为给定时间 $t$ 状态下未来观测序列的概率。\n\n-   **初始化 ($t=T$):**\n    未来观测序列为空，这是一个概率为 $1$ 的事件。\n    $$\\beta_T(s,i) = 1 \\quad \\forall s,i$$\n\n-   **递归 ($t < T$):**\n    我们通过对 $t+1$ 时刻的状态进行边缘化，用 $\\beta_{t+1}$ 表示 $\\beta_t(s,i)$：\n    $$\\beta_t(s,i) = \\sum_{s''} \\sum_{k} P(O_{t+1:T}, S_{t+1}=s'', I_{t+1}=k \\mid S_t=s, I_t=i)$$\n    $$= \\sum_{s''} \\sum_{k} P(O_{t+1:T} \\mid S_{t+1}=s'', I_{t+1}=k, S_t=s, I_t=i) P(S_{t+1}=s'', I_{t+1}=k \\mid S_t=s, I_t=i)$$\n    根据模型的马尔可夫性质，给定当前状态，未来观测独立于过去的状态。\n    $$P(O_{t+1:T} \\mid \\dots) = P(O_{t+1} \\mid S_{t+1}=s'') P(O_{t+2:T} \\mid S_{t+1}=s'', I_{t+1}=k) = P(O_{t+1} \\mid S_{t+1}=s'') \\beta_{t+1}(s'',k)$$\n    第二项是状态转移概率。结合得到：\n    $$\\beta_t(s,i) = \\sum_{s''} \\sum_{k} \\beta_{t+1}(s'',k) P(O_{t+1} \\mid S_{t+1}=s'') P(S_{t+1}=s'' \\mid S_t=s, I_{t+1}=k) P(I_{t+1}=k \\mid I_t=i)$$\n\n**平滑后验概率的计算**\n联合隐状态的平滑后验概率 $\\gamma_t(s,i) = P(S_t=s, I_t=i \\mid O_{1:T})$ 由以下公式给出：\n$$\\gamma_t(s,i) = \\frac{P(S_t=s, I_t=i, O_{1:T})}{P(O_{1:T})} = \\frac{P(O_{t+1:T} \\mid S_t=s, I_t=i, O_{1:t}) P(S_t=s, I_t=i, O_{1:t})}{P(O_{1:T})}$$\n利用条件独立性，$P(O_{t+1:T} \\mid \\dots) = P(O_{t+1:T} \\mid S_t=s, I_t=i) = \\beta_t(s,i)$。另一项是 $\\alpha_t(s,i)$。\n因此，$P(S_t=s, I_t=i, O_{1:T}) = \\alpha_t(s,i) \\beta_t(s,i)$。证据的似然是 $P(O_{1:T}) = \\sum_{s'} \\sum_{j'} \\alpha_T(s',j')$。\n后验概率为：\n$$\\gamma_t(s,i) = \\frac{\\alpha_t(s,i) \\beta_t(s,i)}{\\sum_{s'} \\sum_{j'} \\alpha_t(s', j') \\beta_t(s', j')}$$\n最后，我们通过对记忆状态求和来获得输入的边际后验概率：\n$$P(I_t=i \\mid O_{1:T}) = \\sum_{s \\in \\{0,1\\}} \\gamma_t(s,i)$$\n解码后的输入即为 $\\hat{I}_t = \\arg\\max_{i \\in \\{0,1\\}} P(I_t=i \\mid O_{1:T})$。\n\n**数值稳定性**\n直接计算 $\\alpha_t$ 和 $\\beta_t$ 容易出现数值下溢，因为概率会随着时间累乘。我们引入缩放因子。定义缩放后的前向概率 $\\hat{\\alpha}_t(s,i) = P(S_t=s, I_t=i \\mid O_{1:t})$。递归关系保持不变，但在每步之后，值都会被归一化。令 $c_t = P(O_t \\mid O_{1:t-1})$ 为缩放因子。\n-   **前向传递**：使用 $\\hat{\\alpha}_{t-1}$ 通过递归计算临时的未缩放 $\\alpha'_t(s,i)$，然后找到 $c_t = \\sum_{s,i} \\alpha'_t(s,i)$，最后设置 $\\hat{\\alpha}_t(s,i) = \\alpha'_t(s,i) / c_t$。\n-   **后向传递**：一个缩放后的后向变量 $\\hat{\\beta}_t(s,i)$ 通过递归 $\\hat{\\beta}_t(s,i) = \\frac{1}{c_{t+1}} \\sum_{s'',k} \\dots \\hat{\\beta}_{t+1}(s'',k)$ 计算。\n于是，平滑后验概率与缩放后量的乘积成正比：$\\gamma_t(s,i) \\propto \\hat{\\alpha}_t(s,i) \\hat{\\beta}_t(s,i)$。在每个时间步 $t$ 对这个乘积进行归一化，就得到了正确的平滑分布。\n这个过程是前向-后向算法的标准且数值稳健的实现。", "answer": "[[0, 0, 1, 1, 1, 1],[0, 0, 0, 0],[1, 1, 1, 1, 1],[0, 1, 0, 1, 0]]", "id": "2734309"}, {"introduction": "一个合成生物学系统在真实细胞环境中的表现，远比在理想模型中复杂，其可靠性是工程设计的关键。本练习着眼于一个核心的实际挑战：基因组整合位点的“邻里效应”如何影响记忆模块的稳定性 [@problem_id:2734336]。你将构建一个精密的生物物理模型，该模型综合了DNA超螺旋、转录干扰等基本分子机制，来定量预测记忆开关的长期可靠性 $R$。这个实践将训练你如何将底层物理原理与系统级性能指标联系起来，这是设计稳健生物器件的关键一步。", "problem": "设计一个程序，该程序模拟基因组整合环境如何通过局部DNA超螺旋和转录干扰来调节转录起始，并预测一个双稳态记忆在有限观测时间内的可靠性。该系统由两个启动子组成，记为启动子A和启动子B，它们形成一个对称的双态记忆（例如，相互抑制或基于重组酶的锁存器）。该模型必须源自基本的生物学和物理学原理，并以开发者能够根据此处给出的定义、无需其他领域特定启发式方法即可实现的方式进行表述。\n\n使用以下基本依据：\n- 分子生物学中心法则（转录以由启动子可及性决定的速率产生RNA）。\n- 起始的统计热力学：随着有效自由能垒的降低，转录起始速率呈指数增长。\n- 双超螺旋域模型：进行转录的RNA聚合酶在其前方产生正超螺旋，后方产生负超螺旋；在稳态下，来自多个源的局部超螺旋贡献会累加，并因松弛过程而随基因组距离衰减。\n- 启动子阻断的泊松过程：干扰性聚合酶的通过被视为具有平均到达通量的泊松过程；启动子处于空闲状态的时间比例等于一个阻断窗口内零事件发生的概率。\n- 恒定风险下的双态可靠性：到时间 $T$ 为止不发生翻转的概率，是一个速率等于自发翻转率的泊松过程的生存函数。\n\n模型规格：\n1) 启动子 $X \\in \\{\\mathrm{A}, \\mathrm{B}\\}$ 处的局部超螺旋密度为\n$$\\sigma_X = \\sigma_0 + \\sum_{j=1}^{n_X} \\left( \\xi \\, r_{j,X} \\, e^{-d_{j,X}/\\ell} \\, o_{j,X} \\right),$$\n其中 $\\sigma_0$ 是背景超螺旋密度（无量纲），$\\xi$ 是一个比例常数（单位为每 $\\mathrm{s}^{-1}$ 的超螺旋密度），$r_{j,X}$ 是邻居 $j$ 的转录起始速率（单位为 $\\mathrm{s}^{-1}$），$d_{j,X}$ 是从邻居 $j$ 到启动子 $X$ 的基因组距离（单位为碱基对），$\\ell$ 是特征衰减长度（单位为碱基对），$o_{j,X} \\in \\{-1,+1\\}$ 是一个方向/符号因子，编码邻居在启动子上沉积的是净负（-1）超螺旋还是净正（+1）超螺旋。\n\n2) 启动子 $X$ 处的内在起始速率（无阻断时）为\n$$r_{i,X} = r_{\\mathrm{base},X} \\, \\exp\\!\\left(-\\kappa \\, \\sigma_X\\right),$$\n其中 $r_{\\mathrm{base},X}$ 是零超螺旋时的基线起始速率（单位为 $\\mathrm{s}^{-1}$），$\\kappa$ 是一个无量纲的敏感度常数。负超螺旋（$\\sigma_X < 0$）会降低能垒并增加 $r_{i,X}$。\n\n3) 转录干扰被建模为由穿过启动子 $X$ 的RNA聚合酶干扰通量 $J_X$（单位为 $\\mathrm{s}^{-1}$）引起的启动子阻断。有效起始速率变为\n$$r_{\\mathrm{eff},X} = r_{i,X} \\, \\exp\\!\\left(-\\tau \\, J_X\\right),$$\n其中 $\\tau$ 是每次通过的阻断时间（单位为 $\\mathrm{s}$）。干扰通量为\n$$J_X = r_{\\mathrm{int},X} \\, f_X \\, \\exp\\!\\left(-d_{\\mathrm{int},X}/\\lambda_{\\mathrm{occ}}\\right),$$\n其中 $r_{\\mathrm{int},X}$ 是干扰启动子的起始速率（单位为 $\\mathrm{s}^{-1}$），$f_X \\in [0,1]$是到达启动子 $X$ 的通读分数（无量纲），$d_{\\mathrm{int},X}$ 是从干扰启动子到 $X$ 的距离（单位为碱基对），$\\lambda_{\\mathrm{occ}}$ 是遍历概率的特征衰减长度（单位为碱基对）。\n\n4) 离开状态 $X$ 的自发翻转率建模为\n$$k_{\\mathrm{flip},X} = k_0 \\, \\exp\\!\\left(-\\eta \\, r_{\\mathrm{eff},X}\\right),$$\n其中 $k_0$ 是一个基线翻转率（单位为 $\\mathrm{s}^{-1}$），$\\eta$ 是一个敏感度常数（单位为 $\\mathrm{s}$），它捕捉了增加的稳定表达如何降低翻转风险。\n\n5) 如果记忆以相等的先验概率存储任一状态，且风险是时间均匀的，则在时间范围 $T$（单位为 $\\mathrm{s}$）内的可靠性为\n$$R = \\tfrac{1}{2} \\left[\\exp\\!\\left(-k_{\\mathrm{flip},\\mathrm{A}} \\, T\\right) + \\exp\\!\\left(-k_{\\mathrm{flip},\\mathrm{B}} \\, T\\right)\\right],$$\n这是在两种可能存储状态下不发生翻转的平均生存概率。\n\n单位与常数：\n- 所有速率 $r$ 和 $k$ 的单位均为 $\\mathrm{s}^{-1}$。\n- 距离 $d$ 和 $d_{\\mathrm{int}}$ 的单位均为碱基对。\n- 时间常数 $\\tau$, $\\eta$ 和时间范围 $T$ 的单位均为 $\\mathrm{s}$。\n- 超螺旋密度 $\\sigma$ 是无量纲的。\n对所有测试用例使用以下固定常数：\n- $\\sigma_0 = -0.055$,\n- $\\kappa = 25.0$,\n- $\\xi = 0.01$,\n- $\\ell = 1500.0$,\n- $\\tau = 1.5$,\n- $\\lambda_{\\mathrm{occ}} = 800.0$,\n- $k_0 = 1.0 \\times 10^{-4}$,\n- $\\eta = 10.0$.\n\n每个测试用例的输入规格：\n- 启动子A参数：$r_{\\mathrm{base},\\mathrm{A}}$、邻居列表 $\\{(r_{j,\\mathrm{A}}, d_{j,\\mathrm{A}}, o_{j,\\mathrm{A}})\\}_{j=1}^{n_\\mathrm{A}}$ 和干扰集 $(r_{\\mathrm{int},\\mathrm{A}}, d_{\\mathrm{int},\\mathrm{A}}, f_\\mathrm{A})$。\n- 启动子B参数：$r_{\\mathrm{base},\\mathrm{B}}$、邻居列表 $\\{(r_{j,\\mathrm{B}}, d_{j,\\mathrm{B}}, o_{j,\\mathrm{B}})\\}_{j=1}^{n_\\mathrm{B}}$ 和干扰集 $(r_{\\mathrm{int},\\mathrm{B}}, d_{\\mathrm{int},\\mathrm{B}}, f_\\mathrm{B})$。\n- 时间范围 $T$。\n\n你的程序必须为每个测试用例计算 $R$ 并输出结果。\n\n测试套件：\n使用以下参数提供恰好 $5$ 个测试用例。\n\n- 测试用例 $1$ （中度负超螺旋和轻度干扰，$T = 3600.0$）：\n  - 启动子A：$r_{\\mathrm{base},\\mathrm{A}} = 0.05$，邻居 $\\{(0.3, 600, -1)\\}$，干扰 $(0.4, 500, 0.2)$。\n  - 启动子B：$r_{\\mathrm{base},\\mathrm{B}} = 0.05$，邻居 $\\{(0.2, 800, -1)\\}$，干扰 $(0.3, 700, 0.15)$。\n  - $T = 3600.0$。\n\n- 测试用例 $2$ （A处强正超螺旋和阻断，B处条件有利，$T = 3600.0$）：\n  - 启动子A：$r_{\\mathrm{base},\\mathrm{A}} = 0.05$，邻居 $\\{(0.6, 300, +1), (0.5, 500, +1)\\}$，干扰 $(1.0, 200, 0.6)$。\n  - 启动子B：$r_{\\mathrm{base},\\mathrm{B}} = 0.05$，邻居 $\\{(0.4, 1000, -1)\\}$，干扰 $(0.2, 900, 0.1)$。\n  - $T = 3600.0$。\n\n- 测试用例 $3$ （无邻居，无干扰，$T = 3600.0$）：\n  - 启动子A：$r_{\\mathrm{base},\\mathrm{A}} = 0.05$，邻居 $\\{\\}$，干扰 $(0.0, 1000, 0.0)$。\n  - 启动子B：$r_{\\mathrm{base},\\mathrm{B}} = 0.05$，邻居 $\\{\\}$，干扰 $(0.0, 1000, 0.0)$。\n  - $T = 3600.0$。\n\n- 测试用例 $4$ （距离很长导致耦合可忽略不计，$T = 7200.0$）：\n  - 启动子A：$r_{\\mathrm{base},\\mathrm{A}} = 0.05$，邻居 $\\{(0.8, 5000, +1)\\}$，干扰 $(0.5, 4000, 0.1)$。\n  - 启动子B：$r_{\\mathrm{base},\\mathrm{B}} = 0.05$，邻居 $\\{(1.0, 6000, -1)\\}$，干扰 $(0.5, 6000, 0.05)$。\n  - $T = 7200.0$。\n\n- 测试用例 $5$ （强有益负超螺旋，无干扰，$T = 3600.0$）：\n  - 启动子A：$r_{\\mathrm{base},\\mathrm{A}} = 0.05$，邻居 $\\{(1.2, 200, -1), (1.0, 400, -1)\\}$，干扰 $(0.0, 500, 0.0)$。\n  - 启动子B：$r_{\\mathrm{base},\\mathrm{B}} = 0.05$，邻居 $\\{(1.2, 300, -1)\\}$，干扰 $(0.0, 500, 0.0)$。\n  - $T = 3600.0$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含可靠性结果。结果为一个逗号分隔的十进制数列表，用方括号括起，每个可靠性值四舍五入到恰好六位小数，并与测试用例顺序相同。例如，包含三个假设结果的输出必须如下所示：\n“[0.912345,0.876543,0.999000]”。", "solution": "问题陈述经过验证，并被确定为有效。它是自洽的，提供了一整套方程、参数和常数。该模型在计算上是适定的，对于每组输入都会产生唯一的解。其基本原理植根于分子生物学和生物物理学，具有充分的科学依据，特别涉及双超螺旋域模型、转录的统计力学以及随机分子事件的泊松过程建模。问题陈述中没有逻辑矛盾、事实错误或含糊之处。因此，我将着手构建解决方案。\n\n目标是计算一个双稳态基因记忆系统在时间范围 $T$ 内的可靠性 $R$。可靠性由其两个状态（由启动子 A 和 B 代表）的稳定性决定。每个状态的稳定性通过自发翻转率 $k_{\\mathrm{flip},X}$ 来量化，其中 $X \\in \\{A, B\\}$。计算遵循一个清晰的因果链，从基因组环境到最终的系统可靠性，我将在下面详细说明。\n\n首先，对于每个启动子 $X$，我们必须计算局部DNA超螺旋密度 $\\sigma_X$。它等于背景超螺旋 $\\sigma_0$ 与来自 $n_X$ 个邻近转录基因贡献的总和。公式为：\n$$\n\\sigma_X = \\sigma_0 + \\sum_{j=1}^{n_X} \\left( \\xi \\, r_{j,X} \\, e^{-d_{j,X}/\\ell} \\, o_{j,X} \\right)\n$$\n在此，$\\xi$ 是一个比例常数，$r_{j,X}$ 是邻居 $j$ 的转录速率，$d_{j,X}$ 是到它的基因组距离，$\\ell$ 是超螺旋的特征衰减长度，$o_{j,X}$ 是一个方向因子（$+1$ 表示正超螺旋，$-1$ 表示负超螺旋）。\n\n其次，局部超螺旋密度 $\\sigma_X$ 直接影响启动子的内在转录起始速率 $r_{i,X}$。DNA解旋是转录起始的一部分，因此负超螺旋（$\\sigma_X < 0$）通常会增强这一过程。该模型通过指数依赖关系来捕捉这一点：\n$$\nr_{i,X} = r_{\\mathrm{base},X} \\, \\exp(-\\kappa \\, \\sigma_X)\n$$\n其中 $r_{\\mathrm{base},X}$ 是零超螺旋时的基线速率，$\\kappa$ 是启动子对超螺旋的敏感度。\n\n第三，我们考虑转录干扰。穿过启动子 $X$ 的RNA聚合酶通量 $J_X$ 会阻断它，阻止其自身的机制结合。这个干扰通量建模为：\n$$\nJ_X = r_{\\mathrm{int},X} \\, f_X \\, \\exp(-d_{\\mathrm{int},X}/\\lambda_{\\mathrm{occ}})\n$$\n其中 $r_{\\mathrm{int},X}$ 是干扰启动子的速率，$f_X$ 是通读至启动子 $X$ 的转录本比例，$d_{\\mathrm{int},X}$ 是距离，$\\lambda_{\\mathrm{occ}}$ 是聚合酶到达启动子 $X$ 概率的衰减长度。\n\n第四，超螺旋和干扰的综合效应产生了有效起始速率 $r_{\\mathrm{eff},X}$。阻断效应将内在速率 $r_{i,X}$ 乘以一个对应于启动子未被阻断概率的因子。这被建模为一个泊松过程：\n$$\nr_{\\mathrm{eff},X} = r_{i,X} \\, \\exp(-\\tau \\, J_X)\n$$\n其中 $\\tau$ 是每次干扰聚合酶通过时启动子被阻断的特征时间。\n\n第五，由启动子 $X$ 维持的记忆状态的稳定性与其有效表达速率 $r_{\\mathrm{eff},X}$ 成反比。更高的表达会加固该状态，降低其翻转的概率。这被建模为一个恒定的风险，即自发翻转率 $k_{\\mathrm{flip},X}$：\n$$\nk_{\\mathrm{flip},X} = k_0 \\, \\exp(-\\eta \\, r_{\\mathrm{eff},X})\n$$\n其中 $k_0$ 是一个基线翻转率，$\\eta$ 是一个量化表达稳定效应的敏感度常数。\n\n最后，利用两个状态的翻转率 $k_{\\mathrm{flip},A}$ 和 $k_{\\mathrm{flip},B}$，我们可以计算在时间范围 $T$ 内的整体系统可靠性 $R$。假设初始时每个状态的可能性相等，可靠性即为平均生存概率：\n$$\nR = \\frac{1}{2} \\left[\\exp(-k_{\\mathrm{flip},A} \\, T) + \\exp(-k_{\\mathrm{flip},B} \\, T)\\right]\n$$\n这就完成了计算序列。所提供的程序为每个给定的测试用例实现了这些步骤，使用指定的常数来生成最终的可靠性值列表。", "answer": "[0.985651,0.672314,0.982181,0.964958,0.999719]", "id": "2734336"}]}