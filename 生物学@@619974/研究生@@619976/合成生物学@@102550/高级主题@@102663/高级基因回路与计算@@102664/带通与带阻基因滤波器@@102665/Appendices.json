{"hands_on_practices": [{"introduction": "复杂的基因滤波器通常由更简单的模块构成。本练习将分析最基本的模块——单个基因的表达，并揭示其为何本质上充当一个低通滤波器。这项实践对于理解合成电路中基本元件的动态特性至关重要，它为构建更高级的频率选择性系统奠定了基础。[@problem_id:2715245]", "problem": "考虑一个单基因生产-降解模块，该模块常在带通和带阻基因滤波器中用作低通阶段。蛋白质浓度表示为 $x(t)$，输入转录激活物浓度为 $u(t)$，最大生产速率为 $\\alpha$，半饱和常数为 $K$，一级降解-稀释速率为 $\\gamma$。其动力学遵循以下常微分方程\n$$\n\\dot{x}(t) \\;=\\; \\frac{\\alpha\\,u(t)}{K+u(t)} \\;-\\; \\gamma\\,x(t).\n$$\n从稳态和小信号线性化的定义出发，完成以下任务：\n\n1) 对于恒定输入 $u(t)\\equiv u$，推导其稳态输入-输出关系 $x_{\\mathrm{ss}}(u)$。\n\n2) 固定一个恒定的基线输入 $u_{0} > 0$，它设定了一个稳态 $x_{0}=x_{\\mathrm{ss}}(u_{0})$。现在考虑一个叠加在 $u_{0}$ 上的微小正弦扰动 $\\delta u(t)$，即 $u(t)=u_{0}+\\delta u(t)$，其中 $\\delta u(t)$ 的幅度足够小，可以在 $(u_{0},x_{0})$ 点进行一阶泰勒展开。在稳态点附近对动力学进行线性化，并推导从 $\\delta u$ 到 $\\delta x$ 的线性化输入-输出映射的频率响应幅值 $|G(j\\omega)|$，该幅值在角频率 $\\omega$ （单位：弧度/单位时间）下计算。用 $\\alpha$、$K$、$\\gamma$、$u_{0}$ 和 $\\omega$ 表示 $|G(j\\omega)|$。\n\n最终答案应给出 $x_{\\mathrm{ss}}(u)$ 和 $|G(j\\omega)|$ 这两个表达式。无需进行数值计算，也无需四舍五入。最终答案必须以单行矩阵的形式给出这两个表达式，并按此顺序排列。", "solution": "问题陈述具有科学依据，提法恰当且完整。这是一个生物学中动力学系统分析的标准练习，具体涉及稳态行为的推导和线性化模型的频率响应。陈述中没有不一致、歧义或违反基本原则之处。我们开始求解。\n\n蛋白质浓度 $x(t)$ 的动力学由以下常微分方程给出：\n$$\n\\dot{x}(t) = \\frac{\\alpha u(t)}{K+u(t)} - \\gamma x(t)\n$$\n其中 $x(t)$ 是蛋白质浓度，$u(t)$ 是输入激活物浓度，$\\alpha$ 是最大生产速率，$K$ 是半饱和常数，$\\gamma$ 是一级降解-稀释速率。\n\n第1部分：推导稳态输入-输出关系 $x_{\\mathrm{ss}}(u)$。\n在稳态时，所有时间导数均为零，即 $\\dot{x}(t) = 0$。输入为一个我们记为 $u$ 的恒定值。蛋白质浓度达到一个恒定的稳态值 $x_{\\mathrm{ss}}$。将这些条件代入控制方程，得到：\n$$\n0 = \\frac{\\alpha u}{K+u} - \\gamma x_{\\mathrm{ss}}\n$$\n现在我们可以解出 $x_{\\mathrm{ss}}$ 作为 $u$ 的函数。\n$$\n\\gamma x_{\\mathrm{ss}} = \\frac{\\alpha u}{K+u}\n$$\n分离出 $x_{\\mathrm{ss}}$ 即可得到稳态输入-输出关系：\n$$\nx_{\\mathrm{ss}}(u) = \\frac{\\alpha u}{\\gamma(K+u)}\n$$\n\n第2部分：对动力学进行线性化并推导频率响应幅值 $|G(j\\omega)|$。\n我们在一个稳态工作点 $(u_0, x_0)$ 附近对系统进行线性化，其中 $u_0 > 0$ 是一个恒定输入，且 $x_0 = x_{\\mathrm{ss}}(u_0)$。输入和输出信号表示为稳态值与微小扰动之和：\n$$\nu(t) = u_0 + \\delta u(t)\n$$\n$$\nx(t) = x_0 + \\delta x(t)\n$$\n将这些代入原始微分方程，我们得到：\n$$\n\\frac{d}{dt}(x_0 + \\delta x(t)) = \\frac{\\alpha (u_0 + \\delta u(t))}{K + (u_0 + \\delta u(t))} - \\gamma (x_0 + \\delta x(t))\n$$\n由于 $x_0$ 是一个常数，其导数为零，所以 $\\frac{d}{dt}(x_0 + \\delta x(t)) = \\dot{\\delta x}(t)$。方程变为：\n$$\n\\dot{\\delta x}(t) = \\frac{\\alpha (u_0 + \\delta u(t))}{K + u_0 + \\delta u(t)} - \\gamma x_0 - \\gamma \\delta x(t)\n$$\n我们对非线性生产项 $f(u) = \\frac{\\alpha u}{K+u}$ 在 $u=u_0$ 附近进行一阶泰勒级数展开。\n$$\nf(u_0 + \\delta u(t)) \\approx f(u_0) + \\left. \\frac{df}{du} \\right|_{u=u_0} \\delta u(t)\n$$\n首先，计算 $f(u)$ 对 $u$ 的导数：\n$$\n\\frac{df}{du} = \\frac{d}{du}\\left(\\frac{\\alpha u}{K+u}\\right) = \\frac{\\alpha(K+u) - \\alpha u(1)}{(K+u)^2} = \\frac{\\alpha K}{(K+u)^2}\n$$\n在 $u_0$ 处计算该导数的值：\n$$\n\\left. \\frac{df}{du} \\right|_{u=u_0} = \\frac{\\alpha K}{(K+u_0)^2}\n$$\n生产项的展开式为：\n$$\n\\frac{\\alpha (u_0 + \\delta u(t))}{K + u_0 + \\delta u(t)} \\approx \\frac{\\alpha u_0}{K+u_0} + \\frac{\\alpha K}{(K+u_0)^2} \\delta u(t)\n$$\n将此代回扰动的动力学方程：\n$$\n\\dot{\\delta x}(t) \\approx \\left( \\frac{\\alpha u_0}{K+u_0} + \\frac{\\alpha K}{(K+u_0)^2} \\delta u(t) \\right) - \\gamma x_0 - \\gamma \\delta x(t)\n$$\n根据稳态的定义，我们知道 $\\frac{\\alpha u_0}{K+u_0} - \\gamma x_0 = 0$。这些项相互抵消，留下了扰动的线性化方程：\n$$\n\\dot{\\delta x}(t) = \\frac{\\alpha K}{(K+u_0)^2} \\delta u(t) - \\gamma \\delta x(t)\n$$\n为求得频率响应，我们在频域中分析这个线性时不变 (LTI) 系统。我们对该方程进行拉普拉斯变换，令 $\\Delta X(s) = \\mathcal{L}\\{\\delta x(t)\\}$ 且 $\\Delta U(s) = \\mathcal{L}\\{\\delta u(t)\\}$。\n$$\ns \\Delta X(s) = \\frac{\\alpha K}{(K+u_0)^2} \\Delta U(s) - \\gamma \\Delta X(s)\n$$\n整理各项以求解传递函数 $G(s) = \\frac{\\Delta X(s)}{\\Delta U(s)}$：\n$$\ns \\Delta X(s) + \\gamma \\Delta X(s) = \\frac{\\alpha K}{(K+u_0)^2} \\Delta U(s)\n$$\n$$\n(s + \\gamma) \\Delta X(s) = \\frac{\\alpha K}{(K+u_0)^2} \\Delta U(s)\n$$\n$$\nG(s) = \\frac{\\Delta X(s)}{\\Delta U(s)} = \\frac{\\frac{\\alpha K}{(K+u_0)^2}}{s + \\gamma}\n$$\n通过代入 $s = j\\omega$ 得到频率响应 $G(j\\omega)$，其中 $j$ 是虚数单位，$\\omega$ 是角频率。\n$$\nG(j\\omega) = \\frac{\\frac{\\alpha K}{(K+u_0)^2}}{j\\omega + \\gamma}\n$$\n题目要求的是频率响应的幅值 $|G(j\\omega)|$。形式为 $\\frac{A}{B}$ 的复数，其幅值为 $\\frac{|A|}{|B|}$。由于 $\\alpha > 0$、$K > 0$ 且 $u_0 > 0$，分子是一个实正常数。复数分母 $\\gamma+j\\omega$ 的幅值为 $\\sqrt{\\gamma^2 + \\omega^2}$。\n$$\n|G(j\\omega)| = \\frac{\\left| \\frac{\\alpha K}{(K+u_0)^2} \\right|}{|\\gamma + j\\omega|} = \\frac{\\frac{\\alpha K}{(K+u_0)^2}}{\\sqrt{\\gamma^2 + \\omega^2}}\n$$\n这可化简为：\n$$\n|G(j\\omega)| = \\frac{\\alpha K}{(K+u_0)^2 \\sqrt{\\gamma^2 + \\omega^2}}\n$$\n该表达式表示线性化系统对于频率为 $\\omega$ 的正弦输入扰动的增益。它显示了典型的低通滤波器行为，即增益随着频率 $\\omega$ 的增加而减小。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\alpha u}{\\gamma(K+u)} & \\frac{\\alpha K}{(K+u_0)^{2} \\sqrt{\\gamma^{2} + \\omega^{2}}}\n\\end{pmatrix}\n}\n$$", "id": "2715245"}, {"introduction": "在掌握了简单模块的基础上，本练习将探索如何组合这些模块以实现更复杂的功能。我们将分析一个经典的非相干前馈环 (I1-FFL) 电路基序，并推导其充当带通滤波器的条件，从而能够选择性地响应特定频率的信号。该练习揭示了通过平衡相反的调控路径来实现频率选择性的核心设计原理。[@problem_id:2715264]", "problem": "一个非相干1型前馈环路 (I1-FFL) 是一种三节点基因模体，其中输入转录因子 $x$ 同时激活中间调控子 $v$ 和输出基因产物 $z$，而 $v$ 则抑制 $z$。考虑稳定稳态周围的小扰动，以便应用线性响应理论。令 $v$ 和 $z$ 表示相应物种浓度偏离稳态的量，令 $x$ 表示输入转录因子浓度的小偏离量。假设在工作点附近为一阶生成和衰减，因此小信号动力学由以下方程组支配\n$$\n\\frac{dv}{dt} = -\\gamma_{v}\\, v + k_{v}\\, x, \\quad \\frac{dz}{dt} = -\\gamma_{z}\\, z + k_{x}\\, x - k_{vz}\\, v,\n$$\n其中 $\\gamma_{v}>0$ 和 $\\gamma_{z}>0$ 是有效的一阶稀释-降解速率（等效于特征时间的倒数），而 $k_{v}>0$、$k_{x}>0$、$k_{vz}>0$ 是由调控相互作用的线性化产生的有效小信号增益。令 $G(s)$ 表示在拉普拉斯域中从 $x$ 到 $z$ 的传递函数，令 $|G(j\\omega)|$ 表示其在角频率 $\\omega$ 处的幅值。\n\n从分子生物学中心法则和一阶质量作用降解出发，并使用线性系统理论作为分析基因线路中小扰动的成熟分析框架，完成以下任务：\n\n- 推导出上述 I1-FFL 的传递函数 $G(s)$。\n- 从第一性原理出发，推导出稳态（零频）小信号增益恰好为零（即 $z$ 对 $x$ 的阶跃输入实现完美适应）的条件。\n- 在该条件下，确定 $|G(j\\omega)|$ 是否在某个有限非零频率处出现峰值，如果存在，则计算其幅值达到最大值时的角频率 $\\omega_{\\text{peak}}$。用 $\\gamma_{v}$ 和 $\\gamma_{z}$ 表示 $\\omega_{\\text{peak}}$。角频率的单位使用弧度。\n\n你最终报告的答案必须是 $\\omega_{\\text{peak}}$ 关于 $\\gamma_{v}$ 和 $\\gamma_{z}$ 的单个闭式表达式。最终的方框答案中不要包含单位，也不要对表达式进行四舍五入或近似。", "solution": "所述问题具有科学依据，内容自洽且提法明确。它描述了一个典型的非相干1型前馈环路 (I1-FFL)，并要求在完美适应的条件下分析其小信号频率响应。使用线性化动力学和传递函数分析是完成此项任务的标准且合适的方法。我们开始求解。\n\n系统动力学由以下线性常微分方程组给出：\n$$\n\\frac{dv}{dt} = -\\gamma_{v}\\, v + k_{v}\\, x\n$$\n$$\n\\frac{dz}{dt} = -\\gamma_{z}\\, z + k_{x}\\, x - k_{vz}\\, v\n$$\n其中所有参数 $\\gamma_v, \\gamma_z, k_v, k_x, k_{vz}$ 均为正常数。\n\n我们的第一个任务是推导从输入 $x$ 到输出 $z$ 的传递函数 $G(s)$。我们对该方程组进行拉普拉斯变换，并假设初始条件为零。令 $X(s)$、$V(s)$ 和 $Z(s)$ 分别为 $x(t)$、$v(t)$ 和 $z(t)$ 的拉普拉斯变换。\n变换后的方程为：\n$$\nsV(s) = -\\gamma_{v} V(s) + k_{v} X(s)\n$$\n$$\nsZ(s) = -\\gamma_{z} Z(s) + k_{x} X(s) - k_{vz} V(s)\n$$\n从第一个方程中，我们求解出 $V(s)$ 关于 $X(s)$ 的表达式：\n$$\n(s + \\gamma_{v}) V(s) = k_{v} X(s) \\implies V(s) = \\frac{k_{v}}{s + \\gamma_{v}} X(s)\n$$\n接下来，我们将 $V(s)$ 的表达式代入第二个变换后的方程：\n$$\n(s + \\gamma_{z}) Z(s) = k_{x} X(s) - k_{vz} \\left( \\frac{k_{v}}{s + \\gamma_{v}} \\right) X(s)\n$$\n传递函数 $G(s)$ 定义为比值 $Z(s)/X(s)$。我们整理方程以求得此比值：\n$$\nG(s) = \\frac{Z(s)}{X(s)} = \\frac{1}{s + \\gamma_{z}} \\left( k_{x} - \\frac{k_{vz} k_{v}}{s + \\gamma_{v}} \\right)\n$$\n为了将其表示为单个有理函数，我们进行通分：\n$$\nG(s) = \\frac{k_{x}(s + \\gamma_{v}) - k_{vz} k_{v}}{(s + \\gamma_{z})(s + \\gamma_{v})}\n$$\n$$\nG(s) = \\frac{k_{x}s + k_{x}\\gamma_{v} - k_{vz}k_{v}}{(s + \\gamma_{z})(s + \\gamma_{v})}\n$$\n这就是所求的从 $x$ 到 $z$ 的传递函数。\n\n第二个任务是找到完美适应的条件。完美适应意味着输出 $z$ 对输入 $x$ 的恒定阶跃变化的稳态响应为零。在线性系统的背景下，这对应于稳态增益（或零频增益）为零。稳态增益由 $G(s)$ 在 $s=0$ 处的值给出。\n$$\nG(0) = \\frac{k_{x}(0) + k_{x}\\gamma_{v} - k_{vz}k_{v}}{(0 + \\gamma_{z})(0 + \\gamma_{v})} = \\frac{k_{x}\\gamma_{v} - k_{vz}k_{v}}{\\gamma_{z}\\gamma_{v}}\n$$\n为实现完美适应，必须有 $G(0) = 0$。由于 $\\gamma_z > 0$ 和 $\\gamma_v > 0$，分母不为零。因此，分子必须为零：\n$$\nk_{x}\\gamma_{v} - k_{vz}k_{v} = 0\n$$\n这就得出了完美适应的条件：\n$$\nk_{x}\\gamma_{v} = k_{vz}k_{v}\n$$\n\n最后的任务是在完美适应的条件下，确定幅值响应 $|G(j\\omega)|$ 的峰值频率。我们将条件 $k_{x}\\gamma_{v} = k_{vz}k_{v}$ 代回到 $G(s)$ 的表达式中：\n$$\nG(s) = \\frac{k_{x}s + k_{x}\\gamma_{v} - k_{x}\\gamma_{v}}{(s + \\gamma_{z})(s + \\gamma_{v})} = \\frac{k_{x}s}{(s + \\gamma_{z})(s + \\gamma_{v})}\n$$\n该传递函数在原点（$s=0$）有一个零点，在 $s=-\\gamma_z$ 和 $s=-\\gamma_v$ 有两个实数极点。这种结构是带通滤波器的典型特征。其增益在 $\\omega=0$ 和 $\\omega \\to \\infty$ 时为零，这意味着如果对于 $\\omega > 0$ 存在最大值，那么它必定出现在一个有限的非零频率上。\n\n为了找到这个峰值频率 $\\omega_{\\text{peak}}$，我们分析频率响应的幅值 $|G(j\\omega)|$。通过令 $s=j\\omega$ 来获得频率响应：\n$$\nG(j\\omega) = \\frac{k_{x}j\\omega}{(j\\omega + \\gamma_{z})(j\\omega + \\gamma_{v})}\n$$\n为了求最大值，处理幅值的平方会更方便：\n$$\n|G(j\\omega)|^2 = G(j\\omega)G(-j\\omega) = \\frac{k_{x}j\\omega}{(j\\omega + \\gamma_{z})(j\\omega + \\gamma_{v})} \\cdot \\frac{k_{x}(-j\\omega)}{(-j\\omega + \\gamma_{z})(-j\\omega + \\gamma_{v})}\n$$\n$$\n|G(j\\omega)|^2 = \\frac{k_{x}^2 \\omega^2}{(\\gamma_{z}^2 + \\omega^2)(\\gamma_{v}^2 + \\omega^2)}\n$$\n使 $|G(j\\omega)|$ 最大化的频率 $\\omega_{\\text{peak}}$ 同样也使 $|G(j\\omega)|^2$ 最大化。为了找到这个最大值，我们可以最小化 $|G(j\\omega)|^2$ 中与频率相关的部分的倒数。让我们定义一个函数 $H(\\omega)$：\n$$\nH(\\omega) = \\frac{(\\gamma_{z}^2 + \\omega^2)(\\gamma_{v}^2 + \\omega^2)}{\\omega^2}\n$$\n我们旨在寻找使 $H(\\omega)$ 最小化的 $\\omega > 0$ 的值。将分子展开并除以 $\\omega^2$ 得：\n$$\nH(\\omega) = \\frac{\\omega^4 + (\\gamma_{z}^2 + \\gamma_{v}^2)\\omega^2 + \\gamma_{z}^2\\gamma_{v}^2}{\\omega^2} = \\omega^2 + (\\gamma_{z}^2 + \\gamma_{v}^2) + \\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^2}\n$$\n为了求最小值，我们计算 $H(\\omega)$ 对 $\\omega$ 的导数，并将其设为零：\n$$\n\\frac{dH}{d\\omega} = 2\\omega - 2\\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^3}\n$$\n对于 $\\omega \\neq 0$，将导数设为零：\n$$\n2\\omega = 2\\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^3}\n$$\n$$\n\\omega^4 = \\gamma_{z}^2\\gamma_{v}^2\n$$\n由于 $\\omega$ 必须是一个实数正频率，我们两次取正平方根：\n$$\n\\omega^2 = \\sqrt{\\gamma_{z}^2\\gamma_{v}^2} = \\gamma_{z}\\gamma_{v} \\quad (\\text{因为 } \\gamma_z > 0, \\gamma_v > 0)\n$$\n$$\n\\omega = \\sqrt{\\gamma_{z}\\gamma_{v}}\n$$\n该驻点对应于 $H(\\omega)$ 的一个最小值（因此是 $|G(j\\omega)|^2$ 的一个最大值），因为其二阶导数 $\\frac{d^2H}{d\\omega^2} = 2 + 6\\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^4}$ 对于所有实数 $\\omega \\neq 0$ 都是严格为正的。因此，峰值角频率是两个降解速率的几何平均值。\n$$\n\\omega_{\\text{peak}} = \\sqrt{\\gamma_{v}\\gamma_{z}}\n$$", "answer": "$$\\boxed{\\sqrt{\\gamma_{v}\\gamma_{z}}}$$", "id": "2715264"}, {"introduction": "从分析理论走向实际应用，本练习要求你对一个带通滤波器的性能进行数值表征。你将编写代码来模拟给定基因电路的频率响应，确定其峰值频率 $\\omega_0$ 和带宽等关键特征，甚至检验不完美设计带来的影响。这项计算实践弥合了数学模型与生物系统工程实际所需的定量分析之间的鸿沟。[@problem_id:2715289]", "problem": "给定一个用于基因网络的小信号线性化模型，该网络实现了一个自适应非相干前馈模体，其作用类似于对输入诱导剂浓度的微小扰动进行带通滤波。推导应从以下基本原理出发：靠近稳定稳态的生物化学反应网络可以通过对质量作用动力学或希尔型动力学进行小信号线性化，从而近似为线性常微分方程（ODE），而线性时不变（LTI）系统的频率响应可以通过应用拉普拉斯变换并沿虚轴计算所得的传递函数来求得。该模型包含两个内部状态，在小信号极限下，其生成和降解均为一阶；输出被定义为两个内部物种的差值，以编码非相干前馈作用。具体来说，令 $u(t)$ 表示小信号输入，$x(t)$ 和 $z(t)$ 表示内部小信号状态（例如，转录因子活性），$y(t)$ 表示小信号输出（例如，以线性单位计的报告基因荧光）。线性化动力学方程如下：\n$$\n\\frac{dx}{dt} = -\\alpha\\, x + \\beta\\, u, \\quad\n\\frac{dz}{dt} = -\\gamma\\, z + \\delta\\, x, \\quad\ny = x - z,\n$$\n其中 $\\alpha > 0$ 和 $\\gamma > 0$ 是有效的一阶降解或稀释率（单位为 $\\mathrm{s}^{-1}$），$\\beta > 0$ 和 $\\delta \\ge 0$ 是有效生产增益（单位经选择以使 $y$ 在小信号归一化下为无量纲）。当两条非相干路径的稳态增益达到平衡时，在零频率处发生完美适应，这对应于一个参数条件，您应在推导过程中找到该条件。您的任务是计算此 LTI 系统的频率响应幅值，方法是首先通过第一性原理（对 ODE 进行拉普拉斯变换，求解输出-输入比的线性代数解）推导出从 $u$ 到 $y$ 的传递函数 $G(s)$，然后在一个覆盖三个十倍频程的对数角频率网格上数值计算 $|G(j\\omega)|$。\n\n对于测试套件中提供的每个参数集，请执行以下操作：\n- 从给定的 ODE 推导出传递函数 $G(s)$，不要套用任何预先记忆的滤波器公式，并将 $|G(j\\omega)|$ 写成关于 $\\omega$、$\\alpha$、$\\beta$、$\\gamma$ 和 $\\delta$ 的函数。\n- 为进行数值计算，定义一个估计中心频率 $\\omega_0^{\\mathrm{est}} = \\sqrt{\\alpha\\,\\gamma}$（单位为 $\\mathrm{s}^{-1}$）。通过选择\n$$\n\\omega_{\\min} = \\frac{\\omega_0^{\\mathrm{est}}}{\\sqrt{1000}}, \\quad\n\\omega_{\\max} = \\omega_0^{\\mathrm{est}} \\sqrt{1000},\n$$\n构建一个包含 $N = 121$ 个对数间隔角频率 $\\omega_k$ 的网格，该网格以 $\\omega_0^{\\mathrm{est}}$ 为中心，精确跨越三个十倍频程。在 $\\log_{10}\\omega_{\\min}$ 和 $\\log_{10}\\omega_{\\max}$ 之间对 $\\log_{10} \\omega$ 进行均匀采样 $N$ 个点。\n- 计算每个网格点上的 $|G(j\\omega_k)|$。\n- 确定峰值幅值 $|G|_{\\max}$ 及出现峰值处的相应频率 $\\omega_0$（如果峰值落在网格点之间，则使用具有最大幅值的网格点；无需进行子网格优化）。\n- 定义半功率幅值阈值 $|G|_{\\mathrm{hp}} = |G|_{\\max} / \\sqrt{2}$。将下截止频率 $\\omega_L$ 和上截止频率 $\\omega_H$ 分别确定为 $\\omega_0$ 左侧和右侧 $|G(j\\omega)|$ 穿过 $|G|_{\\mathrm{hp}}$ 的频率。在每一侧跨越阈值的两个最近采样点之间，使用 $\\log_{10}\\omega$ 对 $\\ln |G|$ 的线性插值来估计 $\\omega_L$ 和 $\\omega_H$。如果一个截止频率超出了采样范围，则将该情况视为不适定；但是，提供的测试套件避免了此类情况。\n- 所有频率均以 $\\mathrm{s}^{-1}$ 为单位表示，并四舍五入到六位小数。\n\n测试套件（每个案例以 $(\\alpha, \\gamma, \\beta, \\delta)$ 形式给出，单位均为 $\\mathrm{s}^{-1}$）：\n1. (案例 A) $(\\alpha, \\gamma, \\beta, \\delta) = (0.02, 0.2, 1.0, 0.2)$。\n2. (案例 B) $(\\alpha, \\gamma, \\beta, \\delta) = (0.1, 0.1, 1.0, 0.1)$。\n3. (案例 C) $(\\alpha, \\gamma, \\beta, \\delta) = (0.005, 0.5, 2.0, 0.5)$。\n4. (案例 D) 不完美适应: $(\\alpha, \\gamma, \\beta, \\delta) = (0.02, 0.2, 1.0, 0.198)$。\n\n您的程序必须为每个测试案例计算三元组 $[\\omega_L, \\omega_0, \\omega_H]$，单位为 $\\mathrm{s}^{-1}$，每个值都四舍五入到六位小数，并使用上述流程。您的程序应生成单行输出，其中包含按测试套件顺序排列的结果，格式为逗号分隔的 Python 风格的列表的列表，例如：\n[[wL_A,w0_A,wH_A],[wL_B,w0_B,wH_B],[wL_C,w0_C,wH_C],[wL_D,w0_D,wH_D]]\n不应打印任何额外文本。", "solution": "我们从以下原理开始：在稳定稳态附近，由质量作用动力学或饱和希尔动力学控制的生物化学反应网络可以用描述小信号偏差的线性常微分方程（ODE）来近似。对于线性时不变（LTI）系统，频率响应由传递函数 $G(s)$ 捕捉，该函数是输出与输入的拉普拉斯域比值，并在 $s = j\\omega$ 处求值以进行正弦稳态分析。这种方法基于线性系统理论以及拉普拉斯变换对稳定线性ODE的有效性。\n\n给定线性化动力学方程\n$$\n\\frac{dx}{dt} = -\\alpha\\, x + \\beta\\, u, \\quad\n\\frac{dz}{dt} = -\\gamma\\, z + \\delta\\, x, \\quad\ny = x - z,\n$$\n我们应用拉普拉斯变换（使用适用于频率响应分析的零初始条件）得到\n$$\ns X(s) = -\\alpha X(s) + \\beta U(s), \\quad\ns Z(s) = -\\gamma Z(s) + \\delta X(s), \\quad\nY(s) = X(s) - Z(s).\n$$\n解第一个方程得到\n$$\nX(s) = \\frac{\\beta}{s + \\alpha} U(s).\n$$\n代入第二个方程得到\n$$\nZ(s) = \\frac{\\delta}{s + \\gamma} X(s) = \\frac{\\beta \\delta}{(s + \\alpha)(s + \\gamma)} U(s).\n$$\n因此，\n$$\nY(s) = X(s) - Z(s) = \\left( \\frac{\\beta}{s + \\alpha} - \\frac{\\beta \\delta}{(s + \\alpha)(s + \\gamma)} \\right) U(s) = \\frac{\\beta\\big[(s+\\gamma) - \\delta\\big]}{(s+\\alpha)(s+\\gamma)} U(s).\n$$\n因此，传递函数为\n$$\nG(s) \\equiv \\frac{Y(s)}{U(s)} = \\frac{\\beta\\big(s + \\gamma - \\delta\\big)}{(s+\\alpha)(s+\\gamma)}.\n$$\n由此可得出两个关键事实：\n- 零频率（稳态）增益是 $G(0) = \\dfrac{\\beta(\\gamma - \\delta)}{\\alpha \\gamma}$，在完美适应条件 $\\delta = \\gamma$ 下为零，从而在低频区域产生高通特性。\n- 位于 $s = -\\alpha$ 和 $s = -\\gamma$ 处的极点定义了在高频区域的双极点低通行为。结合在 $\\delta = \\gamma$ 条件下的低频零点，这会产生带通响应。当 $\\delta$ 接近（但不等于）$\\gamma$ 时，定性的带通行为仍然存在，尽管低频增益为有限值。\n\n为计算幅度响应，在 $s = j\\omega$ 处求值：\n$$\nG(j\\omega) = \\frac{\\beta\\big(j\\omega + \\gamma - \\delta\\big)}{(j\\omega + \\alpha)(j\\omega + \\gamma)}.\n$$\n其幅值为\n$$\n\\left|G(j\\omega)\\right| = \\frac{\\beta\\left|j\\omega + \\gamma - \\delta\\right|}{\\left|(j\\omega + \\alpha)(j\\omega + \\gamma)\\right|} = \\frac{\\beta\\sqrt{\\omega^2 + (\\gamma - \\delta)^2}}{\\sqrt{(\\omega^2 + \\alpha^2)(\\omega^2 + \\gamma^2)}}.\n$$\n对于完美适应情况 $\\delta = \\gamma$，上式简化为\n$$\n\\left|G(j\\omega)\\right| = \\frac{\\beta \\omega}{\\sqrt{(\\omega^2 + \\alpha^2)(\\omega^2 + \\gamma^2)}}.\n$$\n然而，为了保持通用性，我们将在数值算法中使用未简化的表达式。\n\n数值算法设计：\n1. 对于每个参数集 $(\\alpha, \\gamma, \\beta, \\delta)$，基于极点率的几何平均值定义一个估计中心频率 $\\omega_0^{\\mathrm{est}} = \\sqrt{\\alpha \\gamma}$。这样做是基于以下观察：许多具有分离一阶过程的二阶带通系统，其峰值幅值出现在其主导速率的几何平均值附近。\n2. 通过取\n$$\n\\omega_{\\min} = \\frac{\\omega_0^{\\mathrm{est}}}{\\sqrt{1000}}, \\quad\n\\omega_{\\max} = \\omega_0^{\\mathrm{est}}\\sqrt{1000},\n$$\n并在这两个边界之间对 $\\log_{10}\\omega$ 进行均匀采样，构建一个以 $\\omega_0^{\\mathrm{est}}$ 为中心、精确跨越三个十倍频程的包含 $N = 121$ 个点的对数网格。这种对数对称范围确保了对各种 $(\\alpha,\\gamma)$ 组合的预期峰值周围区域的覆盖。\n3. 使用精确的复数表达式在网格上计算 $\\left|G(j\\omega_k)\\right|$。通过取具有最大幅值的网格点来确定离散的峰值幅值及其频率 $\\omega_0$。\n4. 计算半功率阈值 $|G|_{\\mathrm{hp}} = |G|_{\\max}/\\sqrt{2}$。为确定下截止频率 $\\omega_L$，在峰值左侧找到连续的网格索引 $(k,k+1)$，使得 $\\left|G(j\\omega_k)\\right| \\le |G|_{\\mathrm{hp}}$ 且 $\\left|G(j\\omega_{k+1})\\right| \\ge |G|_{\\mathrm{hp}}$。类似地，对于上截止频率 $\\omega_H$，在峰值右侧找到连续的索引 $(k,k+1)$，使得幅值以相反方向穿过阈值。为了数值稳定性，在 $\\log_{10}\\omega$ 对 $\\ln\\left|G\\right|$ 上进行线性插值：\n   - 令 $x = \\log_{10}\\omega$ 和 $y = \\ln\\left|G\\right|$。如果阈值 $y^\\star = \\ln(|G|_{\\mathrm{hp}})$ 位于 $(x_0,y_0)$ 和 $(x_1,y_1)$ 之间，则在以下位置估计穿越点\n     $$\n     x^\\star = x_0 + (x_1 - x_0)\\frac{y^\\star - y_0}{y_1 - y_0}, \\quad \\omega^\\star = 10^{x^\\star}.\n     $$\n   这种插值方法平衡了生物滤波器响应中通常遇到的频率和幅值的宽动态范围。\n5. 将 $\\omega_L$、$\\omega_0$ 和 $\\omega_H$ 四舍五入到六位小数。所有频率单位均为 $\\mathrm{s}^{-1}$。\n\n应用于测试套件：\n- 案例 A $(\\alpha, \\gamma, \\beta, \\delta) = (0.02, 0.2, 1.0, 0.2)$ 匹配完美适应条件，时间尺度分离，产生一个清晰的带通响应，峰值约在 $\\omega_0 \\approx \\sqrt{0.02 \\cdot 0.2}$。\n- 案例 B $(0.1, 0.1, 1.0, 0.1)$ 具有相同的速率，产生对称响应，峰值约在 $\\omega_0 \\approx 0.1$。\n- 案例 C $(0.005, 0.5, 2.0, 0.5)$ 增加了增益并加宽了极点间距，影响了峰值幅值，但对截止频率的相对位置影响不大。\n- 案例 D $(0.02, 0.2, 1.0, 0.198)$ 轻微扰动了完美适应条件，引入了有限的低频增益，同时保持了一个具有可识别的 $-3\\,\\mathrm{dB}$ 截止频率的明确带通。\n\n附带的程序精确地实现了该算法，并为四个案例输出一个包含三元组 $[\\omega_L, \\omega_0, \\omega_H]$ 的 Python 风格列表，所有值均按要求四舍五入到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef magnitude_G(omega, alpha, gamma, beta, delta):\n    \"\"\"\n    Compute |G(j*omega)| for the linearized genetic band-pass model:\n    G(s) = beta * (s + gamma - delta) / ((s + alpha) * (s + gamma))\n    \"\"\"\n    s = 1j * omega\n    num = beta * (s + (gamma - delta))\n    den = (s + alpha) * (s + gamma)\n    G = num / den\n    return np.abs(G)\n\ndef find_cutoff_log_interp(freqs, mags, peak_index):\n    \"\"\"\n    Find omega_L and omega_H as -3 dB cutoffs around the peak magnitude.\n    Interpolate linearly in log10(freq) vs ln(mag).\n    \"\"\"\n    peak_mag = mags[peak_index]\n    target = peak_mag / np.sqrt(2.0)\n    ln_target = np.log(target)\n    logf = np.log10(freqs)\n    lnm = np.log(mags)\n\n    # Find left cutoff: increasing magnitude on the left\n    omega_L = None\n    for k in range(peak_index - 1, -1, -1):\n        if mags[k] = target = mags[k + 1]:\n            x0, x1 = logf[k], logf[k + 1]\n            y0, y1 = lnm[k], lnm[k + 1]\n            if y1 == y0:\n                x_star = x0\n            else:\n                x_star = x0 + (x1 - x0) * (ln_target - y0) / (y1 - y0)\n            omega_L = 10.0 ** x_star\n            break\n\n    # Find right cutoff: decreasing magnitude on the right\n    omega_H = None\n    n = len(freqs)\n    for k in range(peak_index, n - 1):\n        if mags[k] >= target >= mags[k + 1]:\n            x0, x1 = logf[k], logf[k + 1]\n            y0, y1 = lnm[k], lnm[k + 1]\n            if y1 == y0:\n                x_star = x0\n            else:\n                x_star = x0 + (x1 - x0) * (ln_target - y0) / (y1 - y0)\n            omega_H = 10.0 ** x_star\n            break\n\n    return omega_L, omega_H\n\ndef analyze_case(alpha, gamma, beta, delta, N=121):\n    # Estimated center frequency based on pole geometric mean\n    omega0_est = np.sqrt(alpha * gamma)\n    # Three decades total span centered on omega0_est\n    span = np.sqrt(1000.0)\n    wmin = omega0_est / span\n    wmax = omega0_est * span\n    freqs = np.logspace(np.log10(wmin), np.log10(wmax), N)\n\n    mags = magnitude_G(freqs, alpha, gamma, beta, delta)\n\n    # Identify discrete peak\n    peak_index = int(np.argmax(mags))\n    omega0 = freqs[peak_index]\n\n    # Find -3 dB cutoffs\n    omega_L, omega_H = find_cutoff_log_interp(freqs, mags, peak_index)\n\n    # Round to six decimals as required\n    def rnd(x):\n        return round(float(x), 6)\n\n    return rnd(omega_L), rnd(omega0), rnd(omega_H)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (alpha, gamma, beta, delta) in s^-1\n    test_cases = [\n        (0.02, 0.2, 1.0, 0.2),     # Case A: perfect adaptation\n        (0.1, 0.1, 1.0, 0.1),      # Case B: equal rates\n        (0.005, 0.5, 2.0, 0.5),    # Case C: wider separation, higher gain\n        (0.02, 0.2, 1.0, 0.198),   # Case D: imperfect adaptation\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, gamma, beta, delta = case\n        wL, w0, wH = analyze_case(alpha, gamma, beta, delta, N=121)\n        results.append([wL, w0, wH])\n\n    # Final print statement in the exact required format.\n    # Python-style list of lists with comma-separated entries, single line.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "2715289"}]}