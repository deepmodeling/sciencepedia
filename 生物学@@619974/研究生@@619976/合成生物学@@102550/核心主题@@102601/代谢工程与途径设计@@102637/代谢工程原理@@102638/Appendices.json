{"hands_on_practices": [{"introduction": "通量平衡分析 (FBA) 是预测全基因组尺度代谢网络在稳态下行为的基石。这个练习将 FBA 剥离至其线性代数的核心，让您亲手解决一个微型网络的通量问题。通过从第一性原理出发，您将深入理解化学计量矩阵 $S$ 如何定义一个可行的代谢状态空间，并学会如何识别和处理无界解，这是理解更复杂 FBA 模型的重要一步。[@problem_id:2762811]", "problem": "考虑一个稳态代谢网络，其化学计量矩阵 $S \\in \\mathbb{R}^{2 \\times 3}$ 表示为\n$$\nS=\\begin{bmatrix}\n1 & -1 & 0 \\\\\n0 & 1 & -1\n\\end{bmatrix},\n$$\n以及一个满足稳态质量平衡 $S\\mathbf{v}=\\mathbf{0}$ 的通量向量 $\\mathbf{v}\\in\\mathbb{R}^{3}$。在通量平衡分析（FBA; Flux Balance Analysis）中，目标是在稳态和边界约束下最大化一个线性细胞目标 $z=\\mathbf{c}^{\\top}\\mathbf{v}$。设目标系数向量为\n$$\n\\mathbf{c}=\\begin{bmatrix}0 \\\\ 0 \\\\ 1\\end{bmatrix},\n$$\n并施加非负下界和无有限上界，\n$$\n\\mathbf{l}=\\mathbf{0},\\quad \\mathbf{u}=\\boldsymbol{\\infty},\n$$\n使得可行集由以下条件定义\n$$\nS\\mathbf{v}=\\mathbf{0},\\quad \\mathbf{v}\\ge \\mathbf{0}.\n$$\n从稳态质量平衡和线性规划可行性的定义出发，不使用任何预先推导的捷径，并依据第一性原理进行推理。\n\n任务：\n- 判断 FBA 问题 $\\max_{\\mathbf{v}}\\{\\mathbf{c}^{\\top}\\mathbf{v}\\mid S\\mathbf{v}=\\mathbf{0},\\ \\mathbf{v}\\ge \\mathbf{0}\\}$ 是否有界。使用 $S$ 的线性代数性质和可行集的几何性质来证明你的结论。\n- 如果问题是无界的，确定使目标函数增加的可行锥的最优极射线，然后施加归一化条件 $v_{1}=1$（一个用于报告最优射线唯一代表的缩放条件）。在此归一化条件下，计算相应的通量向量 $\\mathbf{v}$。\n\n使用 $\\mathrm{pmatrix}$ 将你的最终答案表示为一个不带单位的单行矩阵。无需进行四舍五入。", "solution": "所述问题是在通量平衡分析（FBA）背景下的一个线性规划问题。在进行求解之前，需要对问题陈述进行验证。\n\n已知条件如下：\n- 一个化学计量矩阵 $S \\in \\mathbb{R}^{2 \\times 3}$，由 $S=\\begin{bmatrix} 1 & -1 & 0 \\\\ 0 & 1 & -1 \\end{bmatrix}$ 给出。\n- 一个通量向量 $\\mathbf{v} \\in \\mathbb{R}^{3}$。\n- 稳态质量平衡条件 $S\\mathbf{v}=\\mathbf{0}$。\n- 一个需要最大化的目标函数 $z=\\mathbf{c}^{\\top}\\mathbf{v}$。\n- 目标系数向量 $\\mathbf{c}=\\begin{bmatrix}0 \\\\ 0 \\\\ 1\\end{bmatrix}$。\n- 由 $\\mathbf{v} \\ge \\mathbf{0}$ 定义的通量边界，这意味着下界 $\\mathbf{l}=\\mathbf{0}$ 且无有限上界 $\\mathbf{u}=\\boldsymbol{\\infty}$。\n- FBA 问题被表述为 $\\max_{\\mathbf{v}}\\{\\mathbf{c}^{\\top}\\mathbf{v}\\mid S\\mathbf{v}=\\mathbf{0},\\ \\mathbf{v}\\ge \\mathbf{0}\\}$。\n- 如果问题无界，则应用归一化条件：$v_{1}=1$。\n\n该问题具有科学依据、是良定且客观的。它代表了FBA（代谢工程中的一个核心方法）的一个标准的、基本的应用。所有组成部分在数学上都是良定义的，且约束条件是一致的。没有违反科学原理之处，没有歧义，也没有缺失信息。因此，该问题被认为是有效的，可以构建一个解。\n\n任务是确定目标函数在可行集上是否有界，如果无界，则找到沿着最优射线的代表性通量向量。可行集是 $\\mathbb{R}^{3}$ 中由约束条件 $S\\mathbf{v}=\\mathbf{0}$ 和 $\\mathbf{v} \\ge \\mathbf{0}$ 定义的区域。这个集合是一个多面锥，因为其约束由齐次线性等式和非负边界组成。\n\n首先，我们必须刻画矩阵 $S$ 的零空间，它是满足 $S\\mathbf{v}=\\mathbf{0}$ 的所有向量 $\\mathbf{v}$ 的集合。该矩阵方程为：\n$$\n\\begin{bmatrix}\n1 & -1 & 0 \\\\\n0 & 1 & -1\n\\end{bmatrix}\n\\begin{pmatrix}\nv_{1} \\\\\nv_{2} \\\\\nv_{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\n这展开为一个由两个线性方程组成的方程组：\n$$(1) \\quad 1 \\cdot v_{1} - 1 \\cdot v_{2} + 0 \\cdot v_{3} = 0$$\n$$(2) \\quad 0 \\cdot v_{1} + 1 \\cdot v_{2} - 1 \\cdot v_{3} = 0$$\n从方程 $(1)$，我们得到 $v_{1} = v_{2}$。从方程 $(2)$，我们得到 $v_{2} = v_{3}$。因此，零空间中的任何向量都必须满足 $v_{1} = v_{2} = v_{3}$。我们可以将任何这样的向量表示为一个基向量的标量倍数。设 $v_{3} = k$，其中 $k \\in \\mathbb{R}$ 为某个标量。那么 $v_{1} = v_{2} = v_{3} = k$。$S$ 的零空间，记作 $\\text{ker}(S)$，是由向量 $\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$ 张成的一维子空间。任何向量 $\\mathbf{v} \\in \\text{ker}(S)$ 都可以写成：\n$$\n\\mathbf{v} = k \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n\n接下来，我们应用非负约束 $\\mathbf{v} \\ge \\mathbf{0}$。这要求 $\\mathbf{v}$ 的每个分量都是非负的：\n$$\nv_{1} = k \\ge 0\n$$\n$$\nv_{2} = k \\ge 0\n$$\n$$\nv_{3} = k \\ge 0\n$$\n所有三个条件都满足当且仅当 $k \\ge 0$。因此，可行集是从原点出发，沿向量 $\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$ 方向的射线。任何可行通量向量 $\\mathbf{v}$ 的形式为 $\\mathbf{v} = k \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$，其中 $k \\ge 0$。\n\n现在，我们为可行集中的任何向量计算目标函数 $z = \\mathbf{c}^{\\top}\\mathbf{v}$：\n$$\nz = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix} \\left( k \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) = k \\left( \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) = k(0 \\cdot 1 + 0 \\cdot 1 + 1 \\cdot 1) = k\n$$\n目标函数的值为 $z=k$。由于 $k$ 可以是任何非负实数（$k \\ge 0$），通过增加 $k$ 可以使 $z$ 的值变得任意大。因此，该最大化问题没有有限最大值，FBA 问题是无界的。\n\n该问题是无界的，因为可行锥拥有一条极射线，其方向向量为 $\\mathbf{d} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$，目标函数沿此射线增加。通过检查 $\\mathbf{c}^{\\top}\\mathbf{d} = 1 > 0$ 可以证实这一点。由于这是可行锥中唯一的射线（除了原点），因此它就是最优极射线。\n\n最后的任务是找到位于这条最优射线上并满足归一化条件 $v_{1}=1$ 的特定通量向量 $\\mathbf{v}$。射线上的一个通用点由 $\\mathbf{v} = \\begin{pmatrix} k \\\\ k \\\\ k \\end{pmatrix}$ 给出。应用条件 $v_{1}=1$ 得到 $k=1$。将 $k$ 的这个值代回到 $\\mathbf{v}$ 的一般形式中，我们得到归一化后的通量向量：\n$$\n\\mathbf{v} = 1 \\cdot \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n这个向量代表了最优射线上满足指定缩放条件的唯一点。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1 & 1\n\\end{pmatrix}\n}\n$$", "id": "2762811"}, {"introduction": "在用 FBA 确定了可能的通量分布后，一个自然而然的问题是如何调控这些通量。代谢控制分析 (MCA) 为此提供了定量的框架，用于理解对网络中单个酶的扰动如何影响整个系统的行为。本练习将引导您应用 MCA 的基本定理，在一个简单的线性途径中，计算浓度控制系数 $C_{E_1}^{S_1}$，从而精确量化酶活性变化与代谢物浓度变化之间的关系。[@problem_id:2762794]", "problem": "一个单一代谢中间产物的线性途径通过两个酶促步骤将外部底物 $S_0$ 转化为外部产物 $S_2$：$S_0 \\xrightarrow{v_1} S_1 \\xrightarrow{v_2} S_2$。代谢中间产物是 $S_1$。系统处于稳态，所有变量都在代谢控制分析的框架下使用标度化（无量纲）量来考虑。每个速率 $v_i$ 相对于代谢中间产物浓度 $S_1$ 的标度化弹性系数如下所示：$\\varepsilon_{S_1}^{v_1} = -\\frac{1}{2}$ 和 $\\varepsilon_{S_1}^{v_2} = 1$。仅使用代谢控制分析中关于非分支途径稳态的基本原理，确定 $S_1$ 相对于酶 $E_1$ 的浓度控制系数，记为 $C_{E_1}^{S_1}$，其定义为稳态浓度 $S_1$ 对酶 $E_1$ 活性（浓度）变化的标度化灵敏度。请用一个无单位的精确数表示您的最终答案。无需四舍五入。", "solution": "所给问题是代谢控制分析（MCA）中的一个标准练习，并可进行严格验证。\n\n**步骤1：提取已知条件**\n-   代谢途径是一条线性链：$S_0 \\xrightarrow{v_1} S_1 \\xrightarrow{v_2} S_2$。\n-   代谢物 $S_0$ 和 $S_2$ 是具有固定浓度的外部边界物种。\n-   代谢物 $S_1$ 是唯一的代谢中间产物。\n-   系统处于稳态。\n-   分析使用标度化的无量纲量进行。\n-   速率 $v_1$ 相对于 $S_1$ 浓度的弹性系数为 $\\varepsilon_{S_1}^{v_1} = -\\frac{1}{2}$。\n-   速率 $v_2$ 相对于 $S_1$ 浓度的弹性系数为 $\\varepsilon_{S_1}^{v_2} = 1$。\n-   目标是确定 $S_1$ 相对于酶 $E_1$ 的浓度控制系数，记为 $C_{E_1}^{S_1}$。酶 $E_1$ 催化速率为 $v_1$ 的反应。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它完全基于代谢控制分析已建立的数学框架。这是一个适定问题，它提供了所有必要信息——途径结构和相关的弹性系数——以便使用MCA的基本定理来确定所求的控制系数。语言精确、客观。所提供的弹性数值在物理上是现实的：$\\varepsilon_{S_1}^{v_1} < 0$ 对应于 $S_1$ 对酶 $E_1$ 的产物抑制，这是一种常见的动力学机制；而 $\\varepsilon_{S_1}^{v_2} > 0$ 表明速率 $v_2$ 随着其底物 $S_1$ 浓度的增加而增加，这是标准行为。该问题是自洽的、一致的，并且需要直接应用基本原理。\n\n**步骤3：结论与行动**\n此问题被判定为有效。将提供完整的解答。\n\n**解题推导**\n分析从代谢中间产物 $S_1$ 的稳态基本条件开始。在稳态下，$S_1$ 的浓度是恒定的，这要求其生产速率 $v_1$ 等于其消耗速率 $v_2$。设 $S_1$ 表示稳态浓度。\n$$v_1 = v_2$$\n反应速率 $v_1$ 和 $v_2$ 分别是反应物浓度以及催化它们的酶 $E_1$ 和 $E_2$ 浓度的函数。对于此系统，我们可以将稳态条件写为：\n$$v_1(S_1, E_1) = v_2(S_1, E_2)$$\n浓度控制系数 $C_{E_1}^{S_1}$ 量化了由于酶 $E_1$ 浓度（或活性）的相对变化而引起的 $S_1$ 稳态浓度的相对变化。其定义为：\n$$C_{E_1}^{S_1} = \\frac{\\partial \\ln(S_1)}{\\partial \\ln(E_1)} = \\frac{E_1}{S_1} \\frac{\\partial S_1}{\\partial E_1}$$\n为了求得该系数，我们研究 $E_1$ 的一个扰动如何影响稳态条件。我们对稳态方程关于 $E_1$ 进行全微分：\n$$\\frac{d}{dE_1} [v_1(S_1, E_1)] = \\frac{d}{dE_1} [v_2(S_1, E_2)]$$\n应用链式法则进行微分得到：\n$$\\frac{\\partial v_1}{\\partial S_1} \\frac{\\partial S_1}{\\partial E_1} + \\frac{\\partial v_1}{\\partial E_1} \\frac{\\partial E_1}{\\partial E_1} = \\frac{\\partial v_2}{\\partial S_1} \\frac{\\partial S_1}{\\partial E_1} + \\frac{\\partial v_2}{\\partial E_2} \\frac{\\partial E_2}{\\partial E_1}$$\n由于酶浓度 $E_1$ 和 $E_2$ 是独立参数，因此 $\\frac{\\partial E_2}{\\partial E_1} = 0$。该方程简化为：\n$$\\frac{\\partial v_1}{\\partial S_1} \\frac{\\partial S_1}{\\partial E_1} + \\frac{\\partial v_1}{\\partial E_1} = \\frac{\\partial v_2}{\\partial S_1} \\frac{\\partial S_1}{\\partial E_1}$$\n我们重排此方程以求解未标度化的响应系数 $\\frac{\\partial S_1}{\\partial E_1}$：\n$$\\left( \\frac{\\partial v_2}{\\partial S_1} - \\frac{\\partial v_1}{\\partial S_1} \\right) \\frac{\\partial S_1}{\\partial E_1} = \\frac{\\partial v_1}{\\partial E_1}$$\n$$\\frac{\\partial S_1}{\\partial E_1} = \\frac{\\frac{\\partial v_1}{\\partial E_1}}{\\frac{\\partial v_2}{\\partial S_1} - \\frac{\\partial v_1}{\\partial S_1}}$$\n为了用标度化系数表示此结果，我们使用弹性系数 ($\\varepsilon$) 的定义和酶弹性的性质。速率 $v_i$ 相对于代谢物浓度 $S_j$ 的弹性系数由下式给出：\n$$\\varepsilon_{S_j}^{v_i} = \\frac{S_j}{v_i} \\frac{\\partial v_i}{\\partial S_j}$$\nMCA 的一个基本假设是反应速率与催化酶的浓度成正比，即 $v_i \\propto E_i$。因此，偏导数 $\\frac{\\partial v_i}{\\partial E_i}$ 等于 $\\frac{v_i}{E_i}$。\n使用这些定义，我们可以重写 $\\frac{\\partial S_1}{\\partial E_1}$ 表达式中的各项：\n$$\\frac{\\partial v_1}{\\partial E_1} = \\frac{v_1}{E_1}$$\n$$\\frac{\\partial v_1}{\\partial S_1} = \\frac{v_1}{S_1} \\varepsilon_{S_1}^{v_1}$$\n$$\\frac{\\partial v_2}{\\partial S_1} = \\frac{v_2}{S_1} \\varepsilon_{S_1}^{v_2}$$\n将这些代入 $\\frac{\\partial S_1}{\\partial E_1}$ 的方程中：\n$$\\frac{\\partial S_1}{\\partial E_1} = \\frac{\\frac{v_1}{E_1}}{\\frac{v_2}{S_1} \\varepsilon_{S_1}^{v_2} - \\frac{v_1}{S_1} \\varepsilon_{S_1}^{v_1}}$$\n在稳态下，$v_1 = v_2$。我们将其稳态流量记为 $J$。\n$$\\frac{\\partial S_1}{\\partial E_1} = \\frac{\\frac{J}{E_1}}{\\frac{J}{S_1} (\\varepsilon_{S_1}^{v_2} - \\varepsilon_{S_1}^{v_1})} = \\frac{J}{E_1} \\frac{S_1}{J (\\varepsilon_{S_1}^{v_2} - \\varepsilon_{S_1}^{v_1})} = \\frac{S_1}{E_1} \\frac{1}{\\varepsilon_{S_1}^{v_2} - \\varepsilon_{S_1}^{v_1}}$$\n现在，我们可以计算所求的控制系数 $C_{E_1}^{S_1}$：\n$$C_{E_1}^{S_1} = \\frac{E_1}{S_1} \\frac{\\partial S_1}{\\partial E_1} = \\frac{E_1}{S_1} \\left( \\frac{S_1}{E_1} \\frac{1}{\\varepsilon_{S_1}^{v_2} - \\varepsilon_{S_1}^{v_1}} \\right)$$\n代数简化后得到适用于这类途径的通用公式：\n$$C_{E_1}^{S_1} = \\frac{1}{\\varepsilon_{S_1}^{v_2} - \\varepsilon_{S_1}^{v_1}}$$\n最后一步是代入给定的弹性系数值：\n$$\\varepsilon_{S_1}^{v_1} = -\\frac{1}{2}$$\n$$\\varepsilon_{S_1}^{v_2} = 1$$\n将这些值代入推导出的公式中：\n$$C_{E_1}^{S_1} = \\frac{1}{1 - (-\\frac{1}{2})} = \\frac{1}{1 + \\frac{1}{2}} = \\frac{1}{\\frac{3}{2}}$$\n$$C_{E_1}^{S_1} = \\frac{2}{3}$$\n此结果表明，酶 $E_1$ 的活性增加 $1\\%$ 将导致代谢物 $S_1$ 的稳态浓度增加 $\\frac{2}{3}\\%$。", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "2762794"}, {"introduction": "真实的生物过程是动态的，细胞内代谢与不断变化的外部环境相互作用。这个顶石实践将稳态分析和调控的概念整合到一个动态模拟框架中。通过亲手实现一个动态通量平衡分析 (dFBA) 模型，您将学习细胞内决策（通过 FBA 计算）如何与细胞外底物和产物浓度随时间的变化相互耦合，从而模拟一个完整的批次培养过程。[@problem_id:2762813]", "problem": "实现一个动态通量平衡分析 (dFBA) 模拟器，该模拟器在离散时间步长上将胞外质量平衡与胞内准稳态 FBA 和一个简单的调控规则耦合起来。该模拟必须基于以下基本原理：质量守恒、胞内准稳态通量平衡以及底物摄取的饱和转运激力学。\n\n您需要模拟一个分批培养过程，其中包含一种限制性胞外底物和一种分泌的副产物。胞内网络由一个最小集总化学计量模型表示，该模型包含一种平衡碳当量的前体代谢物。假定在每个时间步长，胞内代谢都处于准稳态。\n\n定义和假设：\n- 设 $S(t)$ 为胞外底物浓度（单位 $\\mathrm{mmol}/\\mathrm{L}$），$X(t)$ 为生物质浓度（单位 $\\mathrm{gDW}/\\mathrm{L}$），$P(t)$ 为胞外产物浓度（单位 $\\mathrm{mmol}/\\mathrm{L}$）。时间 $t$ 的单位为 $\\mathrm{h}$。\n- 胞内通量向量为 $v = [v_1, v_2, v_3, v_4]^\\top$。对于 $v_1$、$v_3$、$v_4$，单位为 $\\mathrm{mmol}/(\\mathrm{gDW}\\cdot\\mathrm{h})$；对于 $v_2$，单位为 $\\mathrm{h}^{-1}$。反应如下：\n  - $v_1$：底物摄取，生成一个集总的胞内前体碳库。\n  - $v_2$：生物质合成（即生长速率）。\n  - $v_3$：对前体库的非生长相关维持消耗。\n  - $v_4$：消耗前体库的副产物分泌。\n- 胞内准稳态（前体碳库的质量平衡）施加了以下线性约束\n  $$\n  v_1 - a\\,v_2 - b\\,v_4 - v_3 = 0,\n  $$\n  其中 $a$ 和 $b$ 是无量纲的正化学计量系数，分别指定了生物质和产物形成所需的前体碳。\n- 底物摄取对胞外底物浓度是饱和的，使用 Michaelis–Menten 型上界：\n  $$\n  0 \\le v_1 \\le V_{\\max,\\mathrm{g}} \\,\\frac{S}{K_{\\mathrm{g}} + S}.\n  $$\n- 维持消耗有一个下界，该下界受到调控以避免在严重饥饿条件下出现不可行解：\n  $$\n  v_3 \\ge m_{\\mathrm{eff}}(S) \\equiv \\min\\!\\left(m,\\,V_{\\max,\\mathrm{g}} \\,\\frac{S}{K_{\\mathrm{g}} + S}\\right).\n  $$\n- 副产物分泌同时受到两个因素的调控：与摄取耦合的最小溢流通量，以及一个依赖于胞外产物的转录抑制规则：\n  $$\n  v_4 - r_{\\mathrm{of}}\\,v_1 \\ge 0,\\quad 0 \\le v_4 \\le V_{\\max,\\mathrm{p}}\\,R(P),\n  $$\n  其中 $r_{\\mathrm{of}}$ 是必需的溢流分数，$R(P)$ 是一个调控因子，定义如下\n  $$\n  R(P) = \\begin{cases}\n  1 & \\text{if } P \\le P_{\\mathrm{thr}},\\\\\n  \\alpha & \\text{if } P > P_{\\mathrm{thr}},\n  \\end{cases}\n  $$\n  其中 $0 < \\alpha \\le 1$。\n- 在每个时间点 $t$，通过求解一个线性规划问题来计算胞内通量 $v$，该问题在上述约束条件下最大化生长速率：\n  $$\n  \\max_{v} \\; v_2 \\quad \\text{subject to linear equalities and inequalities defined above.}\n  $$\n- 胞外质量平衡（分批，恒定体积）由以下方程给出：\n  $$\n  \\frac{dS}{dt} = -\\,v_1\\,X,\\qquad \\frac{dX}{dt} = v_2\\,X,\\qquad \\frac{dP}{dt} = v_4\\,X.\n  $$\n- 使用前向欧拉法，在大小为 $\\Delta t$ 的均匀时间步长上对系统进行离散化：\n  $$\n  S_{k+1} = \\max\\!\\left(0,\\,S_k - \\Delta t\\,v_{1,k}\\,X_k\\right),\\quad\n  X_{k+1} = \\max\\!\\left(0,\\,X_k + \\Delta t\\,v_{2,k}\\,X_k\\right),\\quad\n  P_{k+1} = \\max\\!\\left(0,\\,P_k + \\Delta t\\,v_{4,k}\\,X_k\\right).\n  $$\n  因子 $\\max(0,\\cdot)$ 用于确保非负性。\n\n所有测试用例使用的全局参数：\n- 生物质前体系数 $a = 20$。\n- 产物前体系数 $b = 1$。\n- 底物摄取饱和参数：$V_{\\max,\\mathrm{g}} = 10\\,\\mathrm{mmol}/(\\mathrm{gDW}\\cdot\\mathrm{h})$，$K_{\\mathrm{g}} = 0.5\\,\\mathrm{mmol}/\\mathrm{L}$。\n- 维持消耗下界 $m = 1\\,\\mathrm{mmol}/(\\mathrm{gDW}\\cdot\\mathrm{h})$。\n- 溢流分数 $r_{\\mathrm{of}} = 0.1$。\n- 产物分泌上界参数：$V_{\\max,\\mathrm{p}} = 5\\,\\mathrm{mmol}/(\\mathrm{gDW}\\cdot\\mathrm{h})$，抑制因子 $\\alpha = 0.5$，抑制阈值 $P_{\\mathrm{thr}} = 50\\,\\mathrm{mmol}/\\mathrm{L}$。\n\n每个时间步长 $k \\mapsto k+1$ 需实现的算法：\n- 计算 $v_{1,\\max} = V_{\\max,\\mathrm{g}}\\,S_k/(K_{\\mathrm{g}} + S_k)$ 和 $m_{\\mathrm{eff}} = \\min(m, v_{1,\\max})$。\n- 如果 $P_k \\le P_{\\mathrm{thr}}$，则计算 $R_k = 1$，否则 $R_k = \\alpha$；设置 $v_{4,\\max} = V_{\\max,\\mathrm{p}}\\,R_k$。\n- 求解线性规划\n  $$\n  \\max v_2 \\;\\;\\text{s.t.}\\;\\;\n  v_1 - a v_2 - b v_4 - v_3 = 0,\\;\n  0 \\le v_1 \\le v_{1,\\max},\\;\n  v_3 \\ge m_{\\mathrm{eff}},\\;\n  v_4 - r_{\\mathrm{of}} v_1 \\ge 0,\\;\n  0 \\le v_4 \\le v_{4,\\max},\\;\n  v_2 \\ge 0.\n  $$\n  如果该步骤的线性规划问题不可行，则将该步骤的 $v_1, v_2, v_3, v_4$ 均设置为 0。\n- 如上文所述，使用前向欧拉法更新 $(S,X,P)$ 并确保非负性。\n\n测试套件：\n提供三个独立的模拟（均从 $t=0$ 开始），使用以下初始条件和数值设置。所有浓度单位，$S$ 和 $P$ 为 $\\mathrm{mmol}/\\mathrm{L}$，$X$ 为 $\\mathrm{gDW}/\\mathrm{L}$。时间单位为 $\\mathrm{h}$。\n- 案例 1（中等接种量的常规生长）：$S(0) = 100$, $X(0) = 0.05$, $P(0) = 0$, 最终时间 $T = 10$, 步长 $\\Delta t = 0.01$。\n- 案例 2（底物限制边界）：$S(0) = 2$, $X(0) = 0.1$, $P(0) = 0$, 最终时间 $T = 5$, 步长 $\\Delta t = 0.01$。\n- 案例 3（初始产物高于抑制阈值）：$S(0) = 50$, $X(0) = 0.01$, $P(0) = 60$, 最终时间 $T = 10$, 步长 $\\Delta t = 0.01$。\n\n要求输出：\n- 对于每个案例，返回保留 $6$ 位小数的三元组 $\\big[S(T), X(T), P(T)\\big]$，$S(T)$ 和 $P(T)$ 的单位为 $\\mathrm{mmol}/\\mathrm{L}$，$X(T)$ 的单位为 $\\mathrm{gDW}/\\mathrm{L}$。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个案例按上述顺序贡献一个子列表。例如：$\\big[\\,[s_1,x_1,p_1],[s_2,x_2,p_2],[s_3,x_3,p_3]\\,\\big]$。", "solution": "该问题被确定为有效。它提出了一个关于动态通量平衡分析（dFBA）的适定且有科学依据的练习，dFBA 是代谢工程和计算系统生物学中的一种标准方法。所提供的模型是自洽的，所有参数、初始条件、控制方程和数值程序都得到了明确且一致的定义。该模型将准稳态的胞内代谢与动态的胞外质量平衡相结合，这是一种正确且广泛使用的表述方式。包括 Michaelis-Menten 摄取动力学、维持能量和简单基因调控在内的约束条件，都是该领域的标准表示法。该问题要求实现一个数值模拟，这是一个非平凡的任务，能够正确地检验优化和微分方程求解的整合能力。\n\n动态模拟的核心是在每个离散时间步长重复求解一个优化问题，以找到最大化生物学目标（此处假定为生物质生长速率）的胞内通量分布。然后，基于计算出的通量，对胞外状态变量进行积分。\n\n完整的系统由以下几个部分描述：\n\n1.  **状态变量**：在任意时间 $t$，分批培养的状态由向量 $[S(t), X(t), P(t)]^\\top$ 定义，分别代表底物浓度、生物质浓度和产物浓度。\n\n2.  **胞内通量**：胞内代谢状态由通量向量 $v = [v_1, v_2, v_3, v_4]^\\top$ 描述。假定相对于胞外环境的变化，这些通量能瞬时达到准稳态。\n\n3.  **优化问题**：在状态为 $(S_k, X_k, P_k)$ 的每个时间步长 $k$，我们必须求解一个线性规划（LP）问题，以找到最优通量分布 $v_k = [v_{1,k}, v_{2,k}, v_{3,k}, v_{4,k}]^\\top$。目标是最大化比生长速率 $v_2$。\n    $$\n    \\max_{v} v_2\n    $$\n    这个最大化问题受到几个基于化学计量、热力学和动力学的约束：\n    - **化学计量平衡**：集总的胞内前体库处于稳态。\n      $$v_1 - a v_2 - b v_4 - v_3 = 0$$\n    - **物理和动力学边界**：\n      \\begin{align*}\n      & 0 \\le v_1 \\le v_{1,\\max,k} \\quad \\text{其中} \\quad v_{1,\\max,k} = V_{\\max,\\mathrm{g}} \\frac{S_k}{K_{\\mathrm{g}} + S_k} \\\\\n      & v_2 \\ge 0 \\\\\n      & v_3 \\ge m_{\\mathrm{eff},k} \\quad \\text{其中} \\quad m_{\\mathrm{eff},k} = \\min(m, v_{1,\\max,k}) \\\\\n      & r_{\\mathrm{of}} v_1 \\le v_4 \\le v_{4,\\max,k} \\quad \\text{其中} \\quad v_{4,\\max,k} = V_{\\max,\\mathrm{p}} R(P_k) \\\\\n      & 0 \\le v_4\n      \\end{align*}\n    调控函数 $R(P_k)$ 是一个阶跃函数：如果 $P_k \\le P_{\\mathrm{thr}}$ 则为 $1$，如果 $P_k > P_{\\mathrm{thr}}$ 则为 $\\alpha$。\n\n4.  **线性规划的解析解**：尽管该问题可以在每一步使用通用 LP 求解器来解决，但其结构足够简单，允许采用更高效的解析解。目标是最大化 $v_2$。从等式约束中，我们可以将 $v_2$ 写为：\n    $$\n    v_2 = \\frac{1}{a} (v_1 - v_3 - b v_4)\n    $$\n    为了最大化 $v_2$（给定 $a > 0$），我们必须最大化 $(v_1 - v_3 - b v_4)$ 这一项。这可以通过最大化 $v_1$ 并同时最小化 $v_3$ 和 $v_4$ 来实现。\n    - $v_3$ 的最小值为其下界 $m_{\\mathrm{eff},k}$。\n    - 目标函数中 $v_1$ 的乘数因子可以通过观察耦合关系 $v_4 \\ge r_{\\mathrm{of}} v_1$ 来看出。为了最大化表达式，我们应选择尽可能小的 $v_4$，即 $v_4 = r_{\\mathrm{of}} v_1$。将其代入目标函数得到：$v_1 - v_3 - b (r_{\\mathrm{of}} v_1) = v_1(1 - b r_{\\mathrm{of}}) - v_3$。由于全局参数为 $b=1$ 和 $r_{\\mathrm{of}}=0.1$，项 $(1 - b r_{\\mathrm{of}}) = 0.9$ 是正的。因此，要最大化目标函数，我们必须最大化 $v_1$。\n\n    对 $v_1$ 的约束是：\n    i) 直接摄取限制：$v_1 \\le v_{1,\\max,k}$\n    ii) 来自产物分泌的间接限制：$v_4 = r_{\\mathrm{of}} v_1$ 必须满足 $v_4 \\le v_{4,\\max,k}$。这意味着 $r_{\\mathrm{of}} v_1 \\le v_{4,\\max,k}$，或者 $v_1 \\le v_{4,\\max,k} / r_{\\mathrm{of}}$。\n    结合这两点，$v_1$ 的有效上界是 $\\hat{v}_{1,k} = \\min(v_{1,\\max,k}, v_{4,\\max,k} / r_{\\mathrm{of}})$。策略是设定 $v_{1,k} = \\hat{v}_{1,k}$。\n\n    然而，必须存在一个可行解。只有当细胞能够摄取足够的底物以满足其强制性需求时，解才是可行的。对于任何非负生长（$v_2 \\ge 0$），我们必须有 $v_1 - v_3 - b v_4 \\ge 0$。使用 $v_3$ 和 $v_4$ 作为 $v_1$ 函数的最小值，我们得到：\n    $$\n    v_1 - m_{\\mathrm{eff},k} - b (r_{\\mathrm{of}} v_1) \\ge 0 \\implies v_1(1 - b r_{\\mathrm{of}}) \\ge m_{\\mathrm{eff},k}\n    $$\n    这建立了一个维持生存所需的最小摄取速率：$v_1 \\ge \\frac{m_{\\mathrm{eff},k}}{1 - b r_{\\mathrm{of}}}$。我们将这个阈值表示为 $v_{1,k}^0$。\n    为了存在可行解，最大可能摄取速率 $\\hat{v}_{1,k}$ 必须至少与最小所需摄取速率 $v_{1,k}^0$ 一样大。也就是说，$\\hat{v}_{1,k} \\ge v_{1,k}^0$。\n    - 如果 $\\hat{v}_{1,k} < v_{1,k}^0$，则 LP 不可行。根据问题陈述，所有通量都设置为零：$v_k = [0, 0, 0, 0]^\\top$。\n    - 如果 $\\hat{v}_{1,k} \\ge v_{1,k}^0$，则 LP 可行，最优通量分布通过最大化摄取得到：\n      \\begin{align*}\n      v_{1,k} &= \\hat{v}_{1,k} \\\\\n      v_{3,k} &= m_{\\mathrm{eff},k} \\\\\n      v_{4,k} &= r_{\\mathrm{of}} v_{1,k} \\\\\n      v_{2,k} &= \\frac{1}{a} (v_{1,k}(1 - b r_{\\mathrm{of}}) - m_{\\mathrm{eff},k})\n      \\end{align*}\n\n5.  **数值积分**：使用步长为 $\\Delta t$ 的前向欧拉法，将胞外浓度从时间步长 $k$ 更新到 $k+1$。\n    \\begin{align*}\n    S_{k+1} &= \\max(0, S_k - \\Delta t \\cdot v_{1,k} \\cdot X_k) \\\\\n    X_{k+1} &= \\max(0, X_k + \\Delta t \\cdot v_{2,k} \\cdot X_k) \\\\\n    P_{k+1} &= \\max(0, P_k + \\Delta t \\cdot v_{4,k} \\cdot X_k)\n    \\end{align*}\n    $\\max(0, \\cdot)$ 运算确保浓度保持非负，这是一个必要的物理约束。\n\n模拟过程通过在指定数量的时间步长内迭代应用 LP 解析解和欧拉更新来进行。", "answer": "[[66.690892,1.48805,14.733579],[0.0,0.178877,0.198947],[32.417036,0.06354,60.858005]]", "id": "2762813"}]}