{"hands_on_practices": [{"introduction": "指导RNA (gRNA) 与DNA双链的稳定性是CRISPR系统功能的核心。在预测gRNA的活性或特异性之前，我们必须首先理解其与目标序列结合的热力学原理。本练习 [@problem_id:2727934] 将指导你使用最近邻模型推导杂交自由能（ $\\Delta G_{\\mathrm{hyb}}$ ），这是生物物理学中的一个基本框架，它构成了大多数预测算法的基础。掌握这种方法能让你从第一性原理出发，构建gRNA结合的定量模型。", "problem": "在为成簇规律间隔短回文重复序列(CRISPR)相关核酸酶理性设计导向RNA (gRNA; 导向核糖核酸)间隔序列时，一个核心目标是估算长度为 $L$ 的间隔序列与其互补的脱氧核糖核酸(DNA)原间隔序列之间的杂交热力学。考虑一个核糖核酸(RNA)字母表 $\\{ \\mathrm{A}, \\mathrm{U}, \\mathrm{C}, \\mathrm{G} \\}$ 中的间隔序列 $\\{r_{k}\\}_{k=1}^{L}$，以及一个DNA字母表 $\\{ \\mathrm{A}, \\mathrm{T}, \\mathrm{C}, \\mathrm{G} \\}$ 中的靶标序列 $\\{d_{k}\\}_{k=1}^{L}$。假设形成了一个没有凸起或缺口的连续双链体（即，每个位置 $k$ 都已配对，允许沃森-克里克配对或错配），并且标准态杂交自由能可以由一个基于短程碱基堆积可加性的最近邻堆积模型很好地近似。\n\n设该模型包含：\n- 一个与序列长度 $L$ 无关的引发项 $\\Delta G_{\\mathrm{init}}$。\n- 一组二核苷酸步长参数 $\\Delta G_{ij}$，其中索引 $i$ 表示RNA步长 $(r_{k}, r_{k+1})$ 的二核苷酸类别，索引 $j$ 表示DNA步长 $(d_{k}, d_{k+1})$ 的二核苷酸类别。参数 $\\Delta G_{ij}$ 对每个允许的步长类别都有定义，包括沃森-克里克和错配情境。\n- 对于每个步长位置 $k \\in \\{1,\\ldots,L-1\\}$ 和每个二核苷酸类别对 $(i,j)$，一个指示变量 $x_{ij}^{(k)} \\in \\{0,1\\}$，如果位置 $k$ 处的步长属于类别 $(i,j)$，则其值为1，否则为0。根据定义，对于每个 $k$，$\\sum_{i}\\sum_{j} x_{ij}^{(k)} = 1$。\n\n仅从以下几点出发：\n- 标准自由能与平衡常数之间的统计力学关系，$\\Delta G^{\\circ} = - R T \\ln K$。\n- 最近邻可加性假设，该假设使双链体配分函数可分解为局部二核苷酸堆积相互作用的贡献和一个序列无关的引发因子的乘积。\n\n推导间隔序列-靶标双链体的总标准态杂交自由能 $\\Delta G_{\\mathrm{hyb}}$ 的一个闭式符号表达式，该表达式应使用 $L$、$\\Delta G_{\\mathrm{init}}$、指示变量 $x_{ij}^{(k)}$ 和二核苷酸参数 $\\Delta G_{ij}$ 来表示。将最终结果表示为单个解析表达式。不要代入数值。答案中不要包含单位。", "solution": "提交分析的问题陈述被认为是有效的。它在科学上基于生物物理化学的既定原理，特别是核酸热力学的最近邻模型。该问题提法得当、客观，并包含足够的信息以进行唯一、严谨的推导。其中不存在科学缺陷、矛盾或模糊之处。因此，我们将着手进行推导。\n\n目标是推导一个长度为 $L$ 的RNA-DNA双链体的总标准态杂交自由能 $\\Delta G_{\\mathrm{hyb}}$ 的表达式。推导必须从所提供的基本原理开始。\n\n第一个原理是反应的标准自由能变 $\\Delta G^{\\circ}$ 和平衡常数 $K$ 之间的关系：\n$$ \\Delta G^{\\circ} = - R T \\ln K $$\n此处，$R$ 是普适气体常数，$T$ 是绝对温度。对于RNA间隔序列和DNA靶标之间的杂交反应，该关系变为 $\\Delta G_{\\mathrm{hyb}} = - R T \\ln K_{\\mathrm{hyb}}$，其中 $K_{\\mathrm{hyb}}$ 是双链体形成的平衡常数。\n\n第二个原理是最近邻可加性，在统计力学框架中，这意味着双链体状态的配分函数 $Z_{\\mathrm{duplex}}$ 可分解为局部的、独立的贡献项的乘积。一个长度为 $L$ 的双链体的形成可以被概念化为一系列事件：一个形成第一个碱基对的初始成核或引发步骤，随后是 $L-1$ 个形成完整双链体的延伸或堆积步骤。\n\n设引发步骤的平衡常数为 $K_{\\mathrm{init}}$。设在步骤 $k$ 处堆积的平衡常数为 $K_{\\mathrm{stack},k}$，该步骤涉及从位置 $k$ 到 $k+1$ 的二核苷酸。基于独立最近邻相互作用的假设，杂交的总平衡常数是这些连续步骤各自平衡常数的乘积：\n$$ K_{\\mathrm{hyb}} = K_{\\mathrm{init}} \\times \\prod_{k=1}^{L-1} K_{\\mathrm{stack},k} $$\n这种因式分解是配分函数可分解性假设的直接结果。\n\n将 $K_{\\mathrm{hyb}}$ 的表达式代入 $\\Delta G_{\\mathrm{hyb}}$ 的热力学方程可得：\n$$ \\Delta G_{\\mathrm{hyb}} = - R T \\ln \\left( K_{\\mathrm{init}} \\times \\prod_{k=1}^{L-1} K_{\\mathrm{stack},k} \\right) $$\n使用对数的性质 $\\ln(ab) = \\ln(a) + \\ln(b)$ 和 $\\ln(a^n) = n\\ln(a)$，我们可以将此表达式展开为自由能项的和：\n$$ \\Delta G_{\\mathrm{hyb}} = - R T \\ln(K_{\\mathrm{init}}) - R T \\ln \\left( \\prod_{k=1}^{L-1} K_{\\mathrm{stack},k} \\right) $$\n$$ \\Delta G_{\\mathrm{hyb}} = - R T \\ln(K_{\\mathrm{init}}) - R T \\sum_{k=1}^{L-1} \\ln(K_{\\mathrm{stack},k}) $$\n我们现在定义每一步的自由能贡献。引发自由能是 $\\Delta G_{\\mathrm{init}} = - R T \\ln(K_{\\mathrm{init}})$。位置 $k$ 处步骤的堆积自由能是 $\\Delta G_{\\mathrm{stack},k} = - R T \\ln(K_{\\mathrm{stack},k})$。根据这些定义，总杂交自由能变成一个加和：\n$$ \\Delta G_{\\mathrm{hyb}} = \\Delta G_{\\mathrm{init}} + \\sum_{k=1}^{L-1} \\Delta G_{\\mathrm{stack},k} $$\n这个方程是在最近邻模型中自由能可加性的正式表述。\n\n最后一步是用问题中给出的特定参数来表示 $\\Delta G_{\\mathrm{stack},k}$。模型提供了一组二核苷酸步长自由能参数 $\\Delta G_{ij}$，其中索引 $i$ 对应于给定步长的RNA二核苷酸类别，而 $j$ 对应于DNA二核苷酸类别。位置 $k$ 处步长的特性由指示变量 $x_{ij}^{(k)}$ 给出，其定义为如果 $k$ 处的步长属于类别 $(i,j)$，则值为1，否则为0。\n\n对于任意给定的步长 $k$，只会存在一个特定的二核苷酸类别对 $(i,j)$。因此，该步长的堆积自由能 $\\Delta G_{\\mathrm{stack},k}$ 精确地等于对应于该特定类别对的值 $\\Delta G_{ij}$。我们可以将这个选择过程正式地写成对所有可能类别的加权和。因为对于每个 $k$ ，只有一个 $x_{ij}^{(k)}$ 为1，其它所有都为0（由约束 $\\sum_{i}\\sum_{j} x_{ij}^{(k)} = 1$ 保证），所以这个和能正确地分离出唯一相关的项：\n$$ \\Delta G_{\\mathrm{stack},k} = \\sum_{i} \\sum_{j} x_{ij}^{(k)} \\Delta G_{ij} $$\n此表达式对从1到 $L-1$ 的每个堆积步长 $k$ 都成立。\n\n将单个步长的堆积自由能表达式代回到总杂交自由能的方程中，我们便得到最终的闭式表达式：\n$$ \\Delta G_{\\mathrm{hyb}} = \\Delta G_{\\mathrm{init}} + \\sum_{k=1}^{L-1} \\left( \\sum_{i} \\sum_{j} x_{ij}^{(k)} \\Delta G_{ij} \\right) $$\n该表达式将总标准态杂交自由能表示为一个恒定引发项，加上对所有 $L-1$ 个二核苷酸步长的堆积自由能的总和，其中每一步的贡献由所涉及的特定RNA和DNA二核苷酸决定。推导至此完成。", "answer": "$$\n\\boxed{\\Delta G_{\\mathrm{init}} + \\sum_{k=1}^{L-1} \\sum_{i} \\sum_{j} x_{ij}^{(k)} \\Delta G_{ij}}\n$$", "id": "2727934"}, {"introduction": "虽然强的靶向结合至关重要，但一个成功的gRNA还必须具有高特异性，以避免在非预期的基因组位点发生切割。本练习 [@problem_id:2727956] 将生物物理学洞见（如“种子”区域的关键作用）转化为一个实用的加权评分模型，用于评估脱靶风险。你将练习设定决策阈值这一关键任务，这需要在有效滤除真实脱靶位点与避免错误标记潜在可用gRNA之间取得平衡。", "problem": "一个设计团队正在构建一种用于成簇规律间隔短回文重复序列 (CRISPR) 靶向的向导核糖核酸 (gRNA)，并希望通过一个加权错配模型来控制脱靶结合。该模型基于中心法则原理，即碱基互补配对决定杂交，而错配会降低有效结合亲和力。假设 gRNA 长度为 $20$ 个核苷酸 (nt)，其位置索引为 $i \\in \\{1,\\dots,20\\}$，其中原型间隔子邻近基序 (PAM) 邻近的种子区域为 $i \\in \\{1,\\dots,10\\}$，而远端区域为 $i \\in \\{11,\\dots,20\\}$。脱靶分数的定义为\n$$\nS \\;=\\; \\sum_{i=1}^{20} w_i\\, m_i,\n$$\n其中 $m_i \\in \\{0,1\\}$ 是一个指示符，表示位置 $i$ 是否发生错配，而 $w_i \\ge 0$ 是一个位置罚分权重，用以量化位置 $i$ 处错配的能量罚分贡献。决策规则是：当且仅当 $S \\le \\tau$ 时，将一个潜在的脱靶位点视为可接受，其中 $\\tau \\ge 0$ 是用户选择的阈值。\n\n假设经验生物物理学表明，种子区域的错配比远端区域的错配产生更大的罚分，因此团队采用了如下简化的、按位置分组的权重：\n$$\nw_i \\;=\\; \\begin{cases}\n0.6, & i \\in \\{1,\\dots,10\\} \\\\\n0.25, & i \\in \\{11,\\dots,20\\}.\n\\end{cases}\n$$\n\n他们希望选择一个单一的阈值 $\\tau$，以同时满足以下所有设计要求：\n- 接受所有在任何位置最多有 $1$ 个错配的候选序列（即，所有满足 $\\sum_i m_i \\le 1$ 的模式都应满足 $S \\le \\tau$）。\n- 拒绝任何在远端区域内至少有 $3$ 个错配的候选序列（即，任何对于 $i \\in \\{1,\\dots,10\\}$ 有 $m_i = 0$ 且 $\\sum_{i=11}^{20} m_i \\ge 3$ 的模式都应满足 $S > \\tau$）。\n- 拒绝任何在种子区域至少有 $2$ 个错配的候选序列（即，任何满足 $\\sum_{i=1}^{10} m_i \\ge 2$ 的模式都应满足 $S > \\tau$），无论远端区域是否有错配。\n\n下列哪个 $\\tau$ 的区间能满足所有这三个要求？\n\nA. $0.25 \\le \\tau < 0.75$\n\nB. $0.6 \\le \\tau < 0.75$\n\nC. $0.6 \\le \\tau < 1.2$\n\nD. $0.75 \\le \\tau < 1.2$", "solution": "首先必须验证问题陈述的科学性和逻辑完整性。\n\n步骤 1：提取已知条件\n- 向导 RNA (gRNA) 长度：$20$ 个核苷酸 (nt)。\n- 位置索引：$i \\in \\{1, \\dots, 20\\}$。\n- PAM 邻近的种子区域：位置 $i \\in \\{1, \\dots, 10\\}$。\n- 远端区域：位置 $i \\in \\{11, \\dots, 20\\}$。\n- 脱靶分数：$S = \\sum_{i=1}^{20} w_i m_i$。\n- 错配指示符：$m_i \\in \\{0, 1\\}$，其中 $m_i=1$ 表示存在错配。\n- 位置罚分权重：$w_i \\ge 0$。\n- 具体权重：\n$$\nw_i = \\begin{cases}\n0.6, & i \\in \\{1, \\dots, 10\\} \\\\\n0.25, & i \\in \\{11, \\dots, 20\\}.\n\\end{cases}\n$$\n- 决策规则：一个潜在的脱靶位点是可接受的，当且仅当其分数 $S$ 满足 $S \\le \\tau$，其中 $\\tau \\ge 0$ 是一个阈值。如果 $S > \\tau$，则被拒绝。\n- 对 $\\tau$ 的设计要求：\n    1. 接受所有在任何位置最多有 $1$ 个错配的候选序列（$\\sum_i m_i \\le 1$）。\n    2. 拒绝任何在远端区域内至少有 $3$ 个错配的候选序列（对于 $i \\in \\{1, \\dots, 10\\}$，$m_i = 0$ 且 $\\sum_{i=11}^{20} m_i \\ge 3$）。\n    3. 拒绝任何在种子区域至少有 $2$ 个错配的候选序列（$\\sum_{i=1}^{10} m_i \\ge 2$），无论远端区域是否有错配。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据。它提出了一个用于 gRNA 脱靶预测的简化但标准的生物物理模型，该模型基于一个公认的原则，即错配罚分是位置依赖的，其中种子区域最为关键。在生物信息学评分函数中，使用加权和是一种常见方法。该问题是适定的；它提供了一个清晰的数学公式和一组约束条件，用以确定参数 $\\tau$ 的有效范围。所有术语都有定义，数据内部一致。该问题是客观且可形式化的。\n\n步骤 3：结论与行动\n问题有效。我们将继续推导解决方案。\n\n任务是找到能同时满足所有三个设计要求的阈值 $\\tau$ 的区间。每个要求都对 $\\tau$ 施加一个约束。我们将按顺序分析它们。\n\n要求 1：“接受所有在任何位置最多有 $1$ 个错配的候选序列。”\n这意味着对于任何总错配数 $\\sum_{i=1}^{20} m_i \\le 1$ 的错配模式，其分数 $S$ 必须满足接受条件 $S \\le \\tau$。为了保证对*所有*此类模式都成立，$\\tau$ 必须大于或等于它们之中的最大可能分数。\n- $0$ 个错配的情况：$\\sum m_i = 0$。分数为 $S = \\sum w_i (0) = 0$。这要求 $0 \\le \\tau$，这是已知的。\n- $1$ 个错配的情况：$\\sum m_i = 1$。\n    - 如果错配在种子区域（$i \\in \\{1, \\dots, 10\\}$），分数为 $S = 1 \\times w_{seed} = 0.6$。\n    - 如果错配在远端区域（$i \\in \\{11, \\dots, 20\\}$），分数为 $S = 1 \\times w_{distal} = 0.25$。\n单个错配的最大分数为 $\\max(0.6, 0.25) = 0.6$。因此，为接受所有单个错配的候选序列，$\\tau$ 必须至少这么大。\n这给出了我们的第一个不等式：\n$$ \\tau \\ge 0.6 $$\n\n要求 2：“拒绝任何在远端区域内至少有 $3$ 个错配的候选序列。”\n这意味着对于任何在 $i \\in \\{1, \\dots, 10\\}$ 处 $m_i = 0$ 且 $\\sum_{i=11}^{20} m_i \\ge 3$ 的模式，其分数 $S$ 必须满足拒绝条件 $S > \\tau$。为了保证对*所有*此类模式都成立，$\\tau$ 必须严格小于它们之中的最小可能分数。\n这种模式的分数为 $S = (\\sum_{i=11}^{20} m_i) \\times w_{distal}$。\n远端错配的数量至少为 $3$。这类模式的最低分数出现在恰好有 $3$ 个远端错配时。\n$S_{min} = 3 \\times w_{distal} = 3 \\times 0.25 = 0.75$。\n该类中的任何其他模式都将有超过 $3$ 个远端错配，因此分数会更高。所以，为了拒绝所有这些模式，$\\tau$ 必须严格小于这个最低分数。\n这给出了我们的第二个不等式：\n$$ \\tau < 0.75 $$\n\n要求 3：“拒绝任何在种子区域至少有 $2$ 个错配的候选序列。”\n这意味着对于任何种子区域错配数 $\\sum_{i=1}^{10} m_i \\ge 2$ 的模式，其分数 $S$ 必须满足拒绝条件 $S > \\tau$。这必须在不考虑远端区域错配数量的情况下成立。为了保证对*所有*此类模式都成立，$\\tau$ 必须严格小于它们之中的最小可能分数。\n分数为 $S = (\\sum_{i=1}^{10} m_i) \\times w_{seed} + (\\sum_{i=11}^{20} m_i) \\times w_{distal}$。\n种子区域错配的最小数量是 $2$。远端区域错配的最小数量是 $0$。这类模式的最低分数出现在恰好有 $2$ 个种子区域错配和 $0$ 个远端区域错配时。\n$S_{min} = 2 \\times w_{seed} + 0 \\times w_{distal} = 2 \\times 0.6 = 1.2$。\n该类中的任何其他模式都将至少有 $2$ 个种子区域错配或额外的远端区域错配，导致分数大于或等于 $1.2$。为了拒绝所有这些模式，$\\tau$ 必须严格小于这个最低分数。\n这给出了我们的第三个不等式：\n$$ \\tau < 1.2 $$\n\n合并所有三个不等式：\n1. $\\tau \\ge 0.6$\n2. $\\tau < 0.75$\n3. $\\tau < 1.2$\n\n$\\tau < 0.75$ 和 $\\tau < 1.2$ 的交集是更严格的条件，即 $\\tau < 0.75$。将其与第一个不等式结合，我们得到 $\\tau$ 的有效区间：\n$$ 0.6 \\le \\tau < 0.75 $$\n\n现在我们评估给定的选项。\n\nA. $0.25 \\le \\tau < 0.75$\n该区间允许 $\\tau$ 的值小于 $0.6$，例如 $\\tau = 0.5$。如果 $\\tau = 0.5$，一个在种子区域有单个错配的候选序列的分数 $S=0.6$。由于 $S > \\tau$，该候选序列将被拒绝。这违反了要求 1，该要求规定所有只有一个错配的候选序列都必须被接受。因此，此选项 **不正确**。\n\nB. $0.6 \\le \\tau < 0.75$\n该区间与我们推导出的结果相符。我们来验证一下。此范围内的任何 $\\tau$ 都满足所有三个条件：\n- $\\tau \\ge 0.6$：这满足要求 1。单个错配的最高分是 $0.6$，由于 $S=0.6 \\le \\tau$，它被接受。\n- $\\tau < 0.75$：这满足要求 2。$\\ge 3$ 个远端错配的最低分是 $0.75$，由于 $S \\ge 0.75 > \\tau$，它被拒绝。\n- $\\tau < 0.75 < 1.2$：这满足要求 3。$\\ge 2$ 个种子区域错配的最低分是 $1.2$，由于 $S \\ge 1.2 > \\tau$，它被拒绝。\n因此，此选项 **正确**。\n\nC. $0.6 \\le \\tau < 1.2$\n该区间允许 $\\tau$ 的值大于或等于 $0.75$，例如 $\\tau = 0.8$。如果 $\\tau = 0.8$，一个在远端区域恰好有 $3$ 个错配（且种子区域没有错配）的候选序列的分数为 $S = 3 \\times 0.25 = 0.75$。由于 $S \\le \\tau$（$0.75 \\le 0.8$），该候选序列将被接受。这违反了要求 2，该要求规定此类候选序列必须被拒绝。因此，此选项 **不正确**。\n\nD. $0.75 \\le \\tau < 1.2$\n该区间无效，原因有二。首先，如选项 C 的解释，任何 $\\tau \\ge 0.75$ 都违反了要求 2。对于边界情况 $\\tau = 0.75$，一个有 $3$ 个远端错配的候选序列的分数 $S=0.75$。拒绝条件是 $S > \\tau$，即 $0.75 > 0.75$。这是错误的，因此该候选序列被接受，违反了要求。其次，它以一种微妙的方式违反了要求 1，因为它强制下限为 $0.75$，而实际上只需要 $0.6$。然而，对要求 2 的违反是决定性的。因此，此选项 **不正确**。", "answer": "$$\\boxed{B}$$", "id": "2727956"}, {"introduction": "现代gRNA设计已经超越了静态预测，转向整合多样化的数据来源。这个高级练习 [@problem_id:2727874] 将向你介绍贝叶斯建模，这是一个强大的统计框架，能根据新证据更新我们的预测。你将学习构建一个模型，该模型结合了源自序列和染色质特征的脱靶活性先验概率与来自实验测定的似然信息，从而计算出更精确的后验概率。", "problem": "在为成簇规律间隔短回文重复序列 (CRISPR) 核酸内切酶设计引导RNA (gRNA) 序列时，一个核心目标是在保持靶向效率的同时，最大限度地减少脱靶切割。考虑一个给定 gRNA 的单个候选脱靶基因组位点。令潜变量 $O \\in \\{0,1\\}$ 表示该位点是否可被脱靶切割（$O=1$）或不可被脱靶切割（$O=0$）。你将构建一个贝叶斯框架，其中脱靶活性的先验概率取决于序列相似性和染色质环境，而后验概率则根据测序实验的证据进行更新。\n\n以贝叶斯定理和由线性预测变量推导概率的标准逻辑连接函数为基础。假设模型包含以下组成部分。\n\n1. 将序列和染色质特征与脱靶概率联系起来的先验模型。令 $m_{s}$ 为种子区域的错配数，$m_{n}$ 为非种子区域的错配数，$A \\in [0,1]$ 为候选位点的染色质可及性（例如，来自转座酶可及染色质测序分析 Assay for Transposase-Accessible Chromatin sequencing），$I_{\\text{ncPAM}} \\in \\{0,1\\}$ 表示原型间隔子邻近基序 (protospacer adjacent motif, PAM) 是否为非典型。令先验脱靶概率为 $p_{0} \\equiv \\mathbb{P}(O=1 \\mid m_{s}, m_{n}, A, I_{\\text{ncPAM}})$，其逻辑斯谛设定如下\n$$\n\\operatorname{logit}(p_{0}) \\equiv \\ln\\!\\left(\\frac{p_{0}}{1-p_{0}}\\right) \\;=\\; \\alpha \\;-\\; \\beta_{s}\\, m_{s} \\;-\\; \\beta_{n}\\, m_{n} \\;+\\; \\beta_{A}\\, A \\;-\\; \\beta_{P}\\, I_{\\text{ncPAM}}.\n$$\n\n2. 基于测序的双链断裂检测分析（例如，可通过测序实现的无偏全基因组双链断裂识别 Genome-wide Unbiased Identification of DSBs Enabled by Sequencing）的证据模型，该模型通过候选位点的读数计数 $R \\in \\{0,1,2,\\ldots\\}$ 进行概括。假设在给定 $O$ 的条件下，读数计数服从泊松模型，当 $O=1$ 时均值为 $\\lambda_{1}$，当 $O=0$ 时均值为 $\\lambda_{0}$：\n$$\nR \\mid (O=1) \\sim \\operatorname{Poisson}(\\lambda_{1}), \\qquad R \\mid (O=0) \\sim \\operatorname{Poisson}(\\lambda_{0}).\n$$\n\n(a) 从贝叶斯定理和上述定义出发，推导后验概率 $\\mathbb{P}(O=1 \\mid R=r, m_{s}, m_{n}, A, I_{\\text{ncPAM}})$ 的闭式表达式，该表达式应由 $\\alpha$、$\\beta_{s}$、$\\beta_{n}$、$\\beta_{A}$、$\\beta_{P}$、$m_{s}$、$m_{n}$、$A$、$I_{\\text{ncPAM}}$、$\\lambda_{1}$、$\\lambda_{0}$ 和 $r$ 表示。\n\n(b) 使用你推导的表达式，根据以下参数值、\n$$\n\\alpha = -2.5,\\;\\; \\beta_{s} = 1.0,\\;\\; \\beta_{n} = 0.3,\\;\\; \\beta_{A} = 2.0,\\;\\; \\beta_{P} = 0.8,\n$$\n观测特征、\n$$\nm_{s} = 1,\\;\\; m_{n} = 2,\\;\\; A = 0.6,\\;\\; I_{\\text{ncPAM}} = 1,\n$$\n以及分析模型和观测值，计算后验概率。\n$$\n\\lambda_{1} = 6.0,\\;\\; \\lambda_{0} = 0.5,\\;\\; r = 3.\n$$\n以 $[0,1]$ 区间内的小数形式报告后验概率。将你的答案四舍五入到四位有效数字。不要使用百分号。", "solution": "该问题具有科学依据，提法明确且客观。它展示了贝叶斯统计建模在计算生物学相关问题上的一个标准应用，特别是预测 CRISPR-Cas9 的脱靶活性。唯一解所需的所有要素均已提供，不存在矛盾或歧义。因此，该问题是有效的，我们可以开始求解。\n\n设特征集表示为 $\\mathcal{F} = \\{m_{s}, m_{n}, A, I_{\\text{ncPAM}}\\}$。我们的任务是推导脱靶切割的后验概率 $\\mathbb{P}(O=1 \\mid R=r, \\mathcal{F})$，然后针对一组给定的参数和观测值计算其数值。\n\n(a) 后验概率的推导。\n\n我们从贝叶斯定理开始。处理几率最为方便。一个事件的后验几率是其后验概率与其补集事件的后验概率之比。\n$$ \\frac{\\mathbb{P}(O=1 \\mid R=r, \\mathcal{F})}{\\mathbb{P}(O=0 \\mid R=r, \\mathcal{F})} = \\frac{\\mathbb{P}(R=r \\mid O=1, \\mathcal{F})}{\\mathbb{P}(R=r \\mid O=0, \\mathcal{F})} \\times \\frac{\\mathbb{P}(O=1 \\mid \\mathcal{F})}{\\mathbb{P}(O=0 \\mid \\mathcal{F})} $$\n该方程表明，后验几率是贝叶斯因子和先验几率的乘积。\n\n问题陈述，给定状态 $O$，观测值 $R$ 与特征 $\\mathcal{F}$ 条件独立。因此，$\\mathbb{P}(R=r \\mid O, \\mathcal{F}) = \\mathbb{P}(R=r \\mid O)$。\n\n先验概率定义为 $p_{0} \\equiv \\mathbb{P}(O=1 \\mid \\mathcal{F})$。因此，先验几率为 $\\frac{p_{0}}{1-p_{0}}$。问题给出了此概率的 logit 值：\n$$ \\operatorname{logit}(p_{0}) = \\ln\\left(\\frac{p_{0}}{1-p_{0}}\\right) = \\alpha - \\beta_{s} m_{s} - \\beta_{n} m_{n} + \\beta_{A} A - \\beta_{P} I_{\\text{ncPAM}} $$\n设该线性预测变量为 $L_0$。先验几率可表示为：\n$$ \\frac{\\mathbb{P}(O=1 \\mid \\mathcal{F})}{\\mathbb{P}(O=0 \\mid \\mathcal{F})} = \\exp(L_0) = \\exp(\\alpha - \\beta_{s} m_{s} - \\beta_{n} m_{n} + \\beta_{A} A - \\beta_{P} I_{\\text{ncPAM}}) $$\n\n贝叶斯因子 $BF$ 是在两个假设（$O=1$ 和 $O=0$）下观测值 $R=r$ 的似然之比。似然由泊松概率质量函数 $P(k; \\lambda) = \\frac{\\lambda^k e^{-\\lambda}}{k!}$ 给出。\n$$ BF = \\frac{\\mathbb{P}(R=r \\mid O=1)}{\\mathbb{P}(R=r \\mid O=0)} = \\frac{\\frac{\\lambda_{1}^{r} \\exp(-\\lambda_{1})}{r!}}{\\frac{\\lambda_{0}^{r} \\exp(-\\lambda_{0})}{r!}} = \\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right)^{r} \\exp(-\\lambda_{1} + \\lambda_{0}) $$\n\n后验几率是先验几率和贝叶斯因子的乘积：\n$$ \\text{Odds}_{\\text{post}} = \\frac{\\mathbb{P}(O=1 \\mid R=r, \\mathcal{F})}{\\mathbb{P}(O=0 \\mid R=r, \\mathcal{F})} = \\left[ \\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right)^{r} \\exp(\\lambda_{0} - \\lambda_{1}) \\right] \\times \\exp(L_0) $$\n后验几率的对数，即后验 logit，为：\n$$ \\ln(\\text{Odds}_{\\text{post}}) = r \\ln\\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right) + (\\lambda_{0} - \\lambda_{1}) + L_{0} $$\n\n为了获得后验概率，我们记为 $P_{\\text{post}} = \\mathbb{P}(O=1 \\mid R=r, \\mathcal{F})$，我们使用概率 $p$ 与其几率之间的关系，$p = \\frac{\\text{Odds}}{1 + \\text{Odds}}$。这等价于将标准逻辑斯谛函数(sigmoid) $\\sigma(z) = \\frac{1}{1 + \\exp(-z)}$ 应用于对数几率。\n设 $Z = \\ln(\\text{Odds}_{\\text{post}})$。则 $P_{\\text{post}} = \\sigma(Z) = \\frac{1}{1 + \\exp(-Z)}$。\n\n代入完整表达式，后验概率的闭式表达式为：\n$$ \\mathbb{P}(O=1 \\mid R=r, m_{s}, m_{n}, A, I_{\\text{ncPAM}}) = \\frac{1}{1 + \\exp\\left(-\\left( r \\ln\\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right) + \\lambda_{0} - \\lambda_{1} + \\alpha - \\beta_{s} m_{s} - \\beta_{n} m_{n} + \\beta_{A} A - \\beta_{P} I_{\\text{ncPAM}} \\right)\\right)} $$\n(a) 部分至此完成。\n\n(b) 后验概率的计算。\n\n我们被赋予以下值：\n参数: $\\alpha = -2.5$, $\\beta_{s} = 1.0$, $\\beta_{n} = 0.3$, $\\beta_{A} = 2.0$, $\\beta_{P} = 0.8$。\n特征: $m_{s} = 1$, $m_{n} = 2$, $A = 0.6$, $I_{\\text{ncPAM}} = 1$。\n分析模型和观测值: $\\lambda_{1} = 6.0$, $\\lambda_{0} = 0.5$, $r = 3$。\n\n首先，我们计算先验对数几率 $L_0$：\n$$ L_0 = \\alpha - \\beta_{s} m_{s} - \\beta_{n} m_{n} + \\beta_{A} A - \\beta_{P} I_{\\text{ncPAM}} $$\n$$ L_0 = -2.5 - (1.0)(1) - (0.3)(2) + (2.0)(0.6) - (0.8)(1) $$\n$$ L_0 = -2.5 - 1.0 - 0.6 + 1.2 - 0.8 $$\n$$ L_0 = -3.7 $$\n\n接下来，我们计算对数贝叶斯因子 $\\ln(BF)$：\n$$ \\ln(BF) = r \\ln\\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right) + \\lambda_{0} - \\lambda_{1} $$\n$$ \\ln(BF) = 3 \\ln\\left(\\frac{6.0}{0.5}\\right) + 0.5 - 6.0 $$\n$$ \\ln(BF) = 3 \\ln(12) - 5.5 $$\n使用 $\\ln(12) \\approx 2.4849066$，\n$$ \\ln(BF) \\approx 3 \\times 2.4849066 - 5.5 = 7.45472 - 5.5 = 1.95472 $$\n\n现在，我们通过将先验对数几率和对数贝叶斯因子相加来计算后验对数几率 $Z$：\n$$ Z = L_0 + \\ln(BF) $$\n$$ Z \\approx -3.7 + 1.95472 = -1.74528 $$\n\n最后，我们使用逻辑斯谛函数计算后验概率 $P_{\\text{post}}$：\n$$ P_{\\text{post}} = \\frac{1}{1 + \\exp(-Z)} $$\n$$ P_{\\text{post}} \\approx \\frac{1}{1 + \\exp(-(-1.74528))} = \\frac{1}{1 + \\exp(1.74528)} $$\n$$ P_{\\text{post}} \\approx \\frac{1}{1 + 5.72745} = \\frac{1}{6.72745} \\approx 0.148648 $$\n\n按照要求，将结果四舍五入至四位有效数字，得到 $0.1486$。", "answer": "$$\\boxed{0.1486}$$", "id": "2727874"}]}