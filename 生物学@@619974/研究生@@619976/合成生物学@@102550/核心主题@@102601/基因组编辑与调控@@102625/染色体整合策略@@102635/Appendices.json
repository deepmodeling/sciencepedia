{"hands_on_practices": [{"introduction": "在染色体整合策略中，最基本的问题是评估整合的保真度。即使是最高效的同源重组或位点特异性重组系统，也可能因非同源末端连接（NHEJ）等错误修复途径的竞争而产生不完美的产物。本练习通过一个简化的概率模型，帮助我们量化在需要精确形成多个连接点（例如，一个基因盒的左右两个同源臂）时，获得完美整合克隆的理论比例，从而为评估和优化实验方案提供一个定量的基准。[@problem_id:2721167]", "problem": "一位合成生物学家在成簇规律间隔短-回文重复序列（CRISPR）的引导下，正使用同源介导修复（HDR）技术，将一个基因盒整合到染色体中。该基因盒需要精确形成两个染色体连接点（一个左同源臂和一个右同源臂），并且只有当两个连接点在核苷酸水平上都正确时，一个克隆才被视为完美整合。假设对于一个给定的整合平台和设计，每个独立的连接点正确形成的概率为 $q$，且与另一个连接点的形成相互独立。任何具有至少一个不正确连接点的克隆都被归类为易错型，这反映了偏离模板化HDR的错误修复过程，如非同源末端连接（NHEJ）或微同源介导修复。\n\n从独立伯努利事件的概率论基本原理和重复独立试验的期望标准定义出发，推导以下表达式：\n- 两个连接点均完美正确的克隆比例，\n- 易错型克隆（即至少有一个不正确连接点）的比例，\n- 以及在筛选的 $N$ 个独立菌落中，完美整合克隆的期望数量。\n\n然后，代入 $q = 0.92$ 和 $N = 480$ 计算这些表达式的值。所有概率均以小数形式表示（而非百分比）。所有报告的数值结果均四舍五入至四位有效数字。按以下顺序提供最终的数值结果：完美整合的比例、易错的比例、完美整合克隆的期望数量。您的最终数值输出必须是一个单行矩阵。", "solution": "所呈现的问题是将初等概率论应用于一个生物过程简化模型的标准应用。该问题具有科学依据，提法明确，并包含得出唯一解所需的所有信息。因此，该问题被认定为有效。我们将着手进行推导。\n\n设 $L$ 为左侧染色体连接点正确形成的事件。\n设 $R$ 为右侧染色体连接点正确形成的事件。\n\n根据题目描述，任何单个连接点正确形成的概率为 $q$。因此，我们有以下概率：\n$$ P(L) = q $$\n$$ P(R) = q $$\n\n题目指明两个连接点的形成是独立事件。\n\n首先，我们必须推导两个连接点都完美正确的克隆比例的表达式。一个克隆是完美整合的，当且仅当左连接点和右连接点都正确。这对应于事件 $L$ 和 $R$ 的交集。设 $P_{perfect}$ 表示此概率。由于 $L$ 和 $R$ 的独立性，它们交集的概率是它们各自概率的乘积：\n$$ P_{perfect} = P(L \\cap R) = P(L) \\times P(R) = q \\times q = q^2 $$\n\n其次，我们需要推导易错型克隆比例的表达式。一个易错型克隆被定义为至少有一个不正确的连接点。这个事件是一个克隆完美整合（即两个连接点都正确）的逻辑补集。因此，一个克隆是易错型的概率，记为 $P_{error}$，是：\n$$ P_{error} = 1 - P_{perfect} $$\n代入我们上面推导的 $P_{perfect}$ 表达式，我们得到：\n$$ P_{error} = 1 - q^2 $$\n\n第三，我们必须推导在 $N$ 个独立菌落中完美整合克隆的期望数量。设 $X$ 为一个代表 $N$ 个菌落样本中完美整合克隆数量的随机变量。对 $N$ 个菌落中的每一个进行筛选都是一次独立的伯努利试验，其中“成功”是指发现一个完美整合的克隆。在任何一次试验中，成功的概率是 $p = P_{perfect} = q^2$。\n\n因此，随机变量 $X$ 服从二项分布，$X \\sim B(N, p)$，其中 $p = q^2$。一个服从二项分布的随机变量的期望值由试验次数与每次试验成功概率的乘积给出。设 $E[X_{perfect}]$ 表示此期望。\n$$ E[X_{perfect}] = N \\times p = N \\times q^2 $$\n这也可以使用指示变量从基本原理推导得出。设 $X_i$ 为第 $i$ 个菌落的指示变量，其中 $i = 1, 2, \\dots, N$。我们定义，如果第 $i$ 个菌落是完美整合的，则 $X_i = 1$，否则 $X_i = 0$。$X_i$ 的期望值为：\n$$ E[X_i] = 1 \\cdot P(X_i=1) + 0 \\cdot P(X_i=0) = P(X_i=1) = q^2 $$\n完美克隆的总数是和 $X = \\sum_{i=1}^{N} X_i$。根据期望的线性性：\n$$ E[X_{perfect}] = E\\left[\\sum_{i=1}^{N} X_i\\right] = \\sum_{i=1}^{N} E[X_i] = \\sum_{i=1}^{N} q^2 = Nq^2 $$\n推导现已完成。\n\n给定具体数值 $q = 0.92$ 和 $N = 480$。我们现在将计算这些推导出的表达式，并将结果四舍五入至四位有效数字。\n\n完美整合克隆的比例是：\n$$ P_{perfect} = q^2 = (0.92)^2 = 0.8464 $$\n\n易错型克隆的比例是：\n$$ P_{error} = 1 - q^2 = 1 - 0.8464 = 0.1536 $$\n\n完美整合克隆的期望数量是：\n$$ E[X_{perfect}] = Nq^2 = 480 \\times (0.92)^2 = 480 \\times 0.8464 = 406.272 $$\n将此结果四舍五入至四位有效数字，得到 $406.3$。\n\n最终的数值结果是：完美整合克隆的比例为 $0.8464$，易错型克隆的比例为 $0.1536$，在 $480$ 个样本中完美整合克隆的期望数量为 $406.3$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.8464 & 0.1536 & 406.3 \\end{pmatrix}}$$", "id": "2721167"}, {"introduction": "除了保真度，整合的特异性——即确保整合事件发生在预期的靶位点而非基因组中的其他位置——是另一个核心挑战。基因组中可能存在大量与靶位点序列相似的“伪位点”，整合酶可能会错误地识别它们。本练习构建了一个基于竞争速率的动力学模型，通过该模型，我们可以推导出脱靶整合的预期数量如何取决于整合酶的特异性 $s$、基因组大小 $G$ 以及伪位点的普遍性 $m$。这个模型清晰地揭示了在设计高特异性整合系统时需要考虑的关键参数。[@problem_id:2721255]", "problem": "使用一种位点特异性整合酶，将DNA插入到单倍体微生物基因组中的一个工程改造的单一着陆垫上。该基因组的大小为 $G$（单位为碱基对）。由于序列的简并性和结合的松弛性，基因组中存在多个脱靶伪位点，这些位点能够以较低的单位点催化效率进行有效整合。这类伪位点的出现频率为 $m$（单位为位点/碱基对），因此脱靶伪位点的期望数量为 $m G$。唯一的靶向着陆垫以单拷贝形式存在。\n\n假设以下基于生物物理学的位点竞争模型：\n- 每个潜在位点（靶向或脱靶）均根据指数等待时间过程启动整合事件，其单位点速率常数与其催化效率成正比。\n- 设靶向位点的单位点速率常数为 $k_{\\text{on}}$，任何脱靶伪位点的单位点速率常数为 $k_{\\text{off}}$。\n- 定义整合酶特异性 $s$ 为比率 $s = k_{\\text{on}}/k_{\\text{off}}$。\n- 在实验窗口期内，每个细胞只发生一次整合事件，且任何位点的整合都会终止该过程。\n\n在这些假设下，从第一性原理出发，推导出每个细胞发生脱靶整合的期望数量，并用 $G$、$m$ 和 $s$ 表示为一个闭式表达式。将最终答案表示为单个解析表达式。无需四舍五入，最终答案中不应包含单位。", "solution": "此问题经确认为具有科学依据、提法明确且客观。这是一个化学动力学和生物物理建模中的标准问题，具体涉及竞争性一级过程。我们将开始解答。\n\n问题要求的是每个细胞发生脱靶整合的期望数量。该系统由一组潜在的整合位点组成，每个位点都在竞争成为唯一的、决定性的整合事件发生地。该过程被建模为多个独立的指数等待时间过程之间的竞争。\n\n首先，我们确定竞争实体及其相关速率。\n有一个靶向位点。在该位点发生整合的单位点速率常数给定为 $k_{\\text{on}}$。因此，靶向整合的总速率 $R_{\\text{on}}$ 为：\n$$R_{\\text{on}} = 1 \\times k_{\\text{on}} = k_{\\text{on}}$$\n\n此外，还存在脱靶伪位点。这些位点的出现频率为 $m$ 位点/碱基对，基因组大小为 $G$ 碱基对。问题指出，脱靶伪位点的期望数量为 $mG$。在生物物理建模的背景下，特别是对于一个 $mG \\gg 1$ 的大基因组，使用此期望值作为脱靶位点的实际数量 $N_{\\text{off}}$ 是一种标准且有效的简化。\n$$N_{\\text{off}} = mG$$\n这些脱靶位点中任意一个的单位点整合速率常数为 $k_{\\text{off}}$。由于每个位点的整合事件是独立的，脱靶整合的总速率 $R_{\\text{off}}$ 是所有单个脱靶位点速率的总和：\n$$R_{\\text{off}} = N_{\\text{off}} \\times k_{\\text{off}} = mG k_{\\text{off}}$$\n\n一旦发生单次整合事件——无论是靶向还是脱靶——整个过程即告终止。任何整合事件的总速率 $R_{\\text{total}}$ 是所有可能的独立事件速率的总和：\n$$R_{\\text{total}} = R_{\\text{on}} + R_{\\text{off}} = k_{\\text{on}} + mG k_{\\text{off}}$$\n\n对于一组相互竞争的独立指数过程（或泊松过程），某一特定类型事件最先发生的概率等于其速率与所有事件总速率之比。设 $P_{\\text{off}}$ 为观测到的整合事件为脱靶事件的概率。该概率为：\n$$P_{\\text{off}} = \\frac{R_{\\text{off}}}{R_{\\text{total}}} = \\frac{mG k_{\\text{off}}}{k_{\\text{on}} + mG k_{\\text{off}}}$$\n\n问题要求的是每个细胞发生脱靶整合的期望数量。设随机变量 $X$ 表示单个细胞中脱靶整合的次数。根据问题描述，“每个细胞只发生一次整合事件”。这意味着 $X$ 的取值只能是 $1$（如果事件是脱靶的）或 $0$（如果事件是靶向的）。因此，$X$ 是一个伯努利随机变量，其成功概率为 $P(X=1) = P_{\\text{off}}$。伯努利随机变量的期望值等于其成功概率：\n$$E[X] = 1 \\cdot P(X=1) + 0 \\cdot P(X=0) = P_{\\text{off}}$$\n因此，我们必须计算的量正是 $P_{\\text{off}}$。\n\n最终表达式必须用基因组大小 $G$、伪位点出现频率 $m$ 和整合酶特异性 $s$ 来表示。特异性定义为 $s = k_{\\text{on}}/k_{\\text{off}}$。我们利用这个关系式从 $P_{\\text{off}}$ 的表达式中消去速率常数 $k_{\\text{on}}$ 和 $k_{\\text{off}}$。\n根据 $s$ 的定义，我们有 $k_{\\text{on}} = s \\cdot k_{\\text{off}}$。将此代入 $P_{\\text{off}}$ 的表达式中：\n$$P_{\\text{off}} = \\frac{mG k_{\\text{off}}}{s \\cdot k_{\\text{off}} + mG k_{\\text{off}}}$$\n我们可以从分母中提出公因子 $k_{\\text{off}}$。我们假设 $k_{\\text{off}} > 0$；否则，如果 $k_{\\text{off}} = 0$，并且给定 $s$ 是有限的，那么 $k_{\\text{on}}$ 也将为 $0$，这意味着整合永远不会发生，这与前提相矛盾。\n$$P_{\\text{off}} = \\frac{mG k_{\\text{off}}}{k_{\\text{off}}(s + mG)}$$\n约去公因子 $k_{\\text{off}}$，得到最终表达式：\n$$P_{\\text{off}} = \\frac{mG}{s + mG}$$\n这就是每个细胞发生脱靶整合的期望数量，表示为所需参数 $G$、$m$ 和 $s$ 的闭式解析函数。", "answer": "$$\\boxed{\\frac{mG}{s + mG}}$$", "id": "2721255"}, {"introduction": "在基于同源重组的整合策略中，一个关键的设计参数是同源臂的长度 $L$。直观上，更长的同源臂可以提高整合效率，但具体关系是怎样的？本练习引导我们从一个基本的生物物理假设出发——将重组起始事件建模为沿DNA的泊松过程——来推导整合效率 $E(L)$ 与同源臂长度之间的函数关系。更重要的是，它展示了如何利用最大似然估计这一强大的统计工具，从真实的实验数据中推断出模型的关键参数 $\\alpha$，从而将理论模型与实验验证紧密结合起来。[@problem_id:2721188]", "problem": "在芽殖酵母中，通过同源重组（HR）进行的染色体整合，转化子具有期望整合的概率随着总有效同源长度的增加而增加。考虑一个基于以下假设的机理模型：(i) 沿同源DNA的有效重组起始事件作为空间泊松过程发生，其恒定的线性速率密度为每个碱基对（bp）$\\alpha$，(ii) 如果在长度为 $L$ 的可用有效同源区域内的任何位置发生至少一次有效的起始事件，则实现成功整合，以及(iii) 每个转化子代表一次独立的伯努利试验，其成功概率等于整合效率 $E(L)$。您被给予在其他条件相同的情况下，于四种同源长度下收集的独立数据：\n- $L_1 = 40$ bp，在 $n_1 = 100$ 个转化子中，有 $k_1 = 26$ 次整合，\n- $L_2 = 80$ bp，在 $n_2 = 100$ 个转化子中，有 $k_2 = 52$ 次整合，\n- $L_3 = 160$ bp，在 $n_3 = 100$ 个转化子中，有 $k_3 = 80$ 次整合，\n- $L_4 = 320$ bp，在 $n_4 = 100$ 个转化子中，有 $k_4 = 94$ 次整合。\n\n任务：\n1. 从沿长度为 $L$ 的区域上，起始事件服从速率密度为 $\\alpha$（单位为 $\\mathrm{bp}^{-1}$）的泊松模型出发，并将同源重组成功定义为在 $L$ 范围内至少发生一次起始事件，推导整合效率 $E(L)$ 作为 $L$ 和 $\\alpha$ 的函数表达式。\n2. 对每个长度为 $L_i$ 的数据点 $(k_i, n_i)$ 使用二项抽样模型，写出关于 $\\alpha$ 的对数似然函数，并通过求解相应的一阶条件来获得 $\\alpha$ 的最大似然估计。\n3. 使用您估计的 $\\alpha$ 值，计算在 $L^{\\star} = 200$ bp 处的预测整合效率。将您的最终答案四舍五入到四位有效数字。将最终效率表示为无单位的小数。不要报告中间结果。仅报告预测效率的最终数值。", "solution": "必须首先严格验证问题陈述。\n\n步骤1：提取给定信息。\n问题提供了以下模型假设和数据：\n(i) 有效的重组起始事件沿同源DNA以空间泊松过程发生，其恒定的线性速率密度为每个碱基对（bp）$\\alpha$。\n(ii) 如果在长度为 $L$ 的可用有效同源区域内发生至少一次有效的起始事件，则实现成功整合。\n(iii) 每个转化子代表一次独立的伯努利试验，其成功概率等于整合效率 $E(L)$。\n\n所提供的数据包括四组独立的数据集：\n- $L_1 = 40$ bp, $k_1 = 26$ 次整合, $n_1 = 100$ 个转化子。\n- $L_2 = 80$ bp, $k_2 = 52$ 次整合, $n_2 = 100$ 个转化子。\n- $L_3 = 160$ bp, $k_3 = 80$ 次整合, $n_3 = 100$ 个转化子。\n- $L_4 = 320$ bp, $k_4 = 94$ 次整合, $n_4 = 100$ 个转化子。\n\n任务是：\n1. 推导整合效率 $E(L)$ 的表达式。\n2. 获得 $\\alpha$ 的最大似然估计（MLE）。\n3. 计算在 $L^{\\star} = 200$ bp 处的预测整合效率，四舍五入到四位有效数字。\n\n步骤2：使用提取的给定信息进行验证。\n根据验证标准对问题进行评估。\n- **科学基础：** 该模型是一个“单次命中”动力学过程的标准简化表示，在生物物理学和分子生物学中很常见。使用泊松过程描述空间维度上的随机事件，以及使用二项抽样描述实验结果，是科学领域中公认的统计方法。该问题是科学上现实的。\n- **良态问题：** 问题提供了足够的信息来推导模型、构建似然函数和估计参数。预测请求是所推导模型的直接应用。预计最大似然估计（MLE）存在唯一解。\n- **客观性：** 问题以精确、定量的术语陈述，没有主观或模糊的语言。\n- **完整性和一致性：** 提供了所有必要的数据（$L_i, k_i, n_i$）和模型假设。没有矛盾之处。\n该问题是一个应用于生物学问题的数学建模和统计推断的标准练习。它满足有效问题的所有标准。\n\n步骤3：结论和行动。\n该问题被认为是有效的。将提供完整的解决方案。\n\n**第1部分：整合效率 $E(L)$ 的推导**\n设 $N(L)$ 为表示在长度为 $L$ 的DNA片段上发生的有效重组起始事件数量的随机变量。根据假设(i)，$N(L)$ 服从泊松分布，其均值参数为 $\\lambda = \\alpha L$，其中 $\\alpha$ 是以 $\\mathrm{bp}^{-1}$ 为单位的速率密度。其概率质量函数为：\n$$P(N(L) = m) = \\frac{(\\alpha L)^m \\exp(-\\alpha L)}{m!}$$\n对于 $m = 0, 1, 2, \\dots$。\n\n根据假设(ii)，如果至少发生一次起始事件，即 $N(L) \\ge 1$，则发生成功整合。该事件的概率即为整合效率 $E(L)$。\n$$E(L) = P(N(L) \\ge 1)$$\n计算其互补事件的概率更为直接，即整合失败，对应于零次起始事件，$N(L) = 0$。\n$$P(N(L) = 0) = \\frac{(\\alpha L)^0 \\exp(-\\alpha L)}{0!} = \\exp(-\\alpha L)$$\n根据全概率定律，效率为：\n$$E(L) = 1 - P(N(L) = 0) = 1 - \\exp(-\\alpha L)$$\n这就是整合效率作为 $L$ 和 $\\alpha$ 的函数所需表达式。\n\n**第2部分：$\\alpha$ 的最大似然估计**\n根据假设(iii)，对于每个同源长度 $L_i$，在 $n_i$ 个总转化子中成功整合的次数 $k_i$ 服从二项分布，$k_i \\sim \\mathrm{Binomial}(n_i, p_i)$，其中成功概率为 $p_i = E(L_i) = 1 - \\exp(-\\alpha L_i)$。\n\n对于长度为 $L_i$ 的单个数据点 $(k_i, n_i)$，其似然函数为：\n$$L_i(\\alpha; k_i, n_i, L_i) = \\binom{n_i}{k_i} p_i^{k_i} (1 - p_i)^{n_i - k_i} = \\binom{n_i}{k_i} (1 - \\exp(-\\alpha L_i))^{k_i} (\\exp(-\\alpha L_i))^{n_i - k_i}$$\n由于四个实验是独立的，完整数据集的总似然函数 $L(\\alpha)$ 是各个似然函数的乘积：\n$$L(\\alpha) = \\prod_{i=1}^{4} L_i(\\alpha) = \\prod_{i=1}^{4} \\binom{n_i}{k_i} (1 - \\exp(-\\alpha L_i))^{k_i} \\exp(-\\alpha L_i(n_i - k_i))$$\n为求得 $\\alpha$ 的最大似然估计（MLE），我们最大化对数似然函数 $\\ell(\\alpha) = \\ln(L(\\alpha))$。\n$$\\ell(\\alpha) = \\sum_{i=1}^{4} \\left[ \\ln\\binom{n_i}{k_i} + k_i \\ln(1 - \\exp(-\\alpha L_i)) - \\alpha L_i (n_i - k_i) \\right]$$\nMLE，记为 $\\hat{\\alpha}$，通过对 $\\ell(\\alpha)$ 关于 $\\alpha$ 求导并令其为零得到。\n$$\\frac{d\\ell}{d\\alpha} = \\sum_{i=1}^{4} \\left[ k_i \\frac{1}{1 - \\exp(-\\alpha L_i)} \\cdot (L_i \\exp(-\\alpha L_i)) - L_i(n_i - k_i) \\right] = 0$$\n这可以重排为：\n$$\\sum_{i=1}^{4} \\frac{k_i L_i \\exp(-\\alpha L_i)}{1 - \\exp(-\\alpha L_i)} = \\sum_{i=1}^{4} L_i(n_i - k_i)$$\n或者，等价地：\n$$\\sum_{i=1}^{4} \\frac{k_i L_i}{\\exp(\\alpha L_i) - 1} = \\sum_{i=1}^{4} L_i(n_i - k_i)$$\n这是一个关于 $\\alpha$ 的非线性方程，必须数值求解。我们代入给定的数据：\n$L_1=40, k_1=26, n_1=100$\n$L_2=80, k_2=52, n_2=100$\n$L_3=160, k_3=80, n_3=100$\n$L_4=320, k_4=94, n_4=100$\n\n右侧（RHS）计算如下：\n$\\mathrm{RHS} = (40)(100-26) + (80)(100-52) + (160)(100-80) + (320)(100-94)$\n$\\mathrm{RHS} = (40)(74) + (80)(48) + (160)(20) + (320)(6) = 2960 + 3840 + 3200 + 1920 = 11920$\n\n左侧（LHS）为：\n$\\mathrm{LHS}(\\alpha) = \\frac{(26)(40)}{\\exp(40\\alpha) - 1} + \\frac{(52)(80)}{\\exp(80\\alpha) - 1} + \\frac{(80)(160)}{\\exp(160\\alpha) - 1} + \\frac{(94)(320)}{\\exp(320\\alpha) - 1}$\n$\\mathrm{LHS}(\\alpha) = \\frac{1040}{\\exp(40\\alpha) - 1} + \\frac{4160}{\\exp(80\\alpha) - 1} + \\frac{12800}{\\exp(160\\alpha) - 1} + \\frac{30080}{\\exp(320\\alpha) - 1}$\n\n使用数值求根算法（例如牛顿-拉弗森法或二分法）求解方程 $\\mathrm{LHS}(\\alpha) = 11920$，得到 $\\alpha$ 的最大似然估计：\n$$\\hat{\\alpha} \\approx 0.009080875 \\, \\mathrm{bp}^{-1}$$\n\n**第3部分：在 $L^{\\star} = 200$ bp 处的整合效率预测**\n使用估计的参数 $\\hat{\\alpha}$，我们可以预测新的同源长度 $L^{\\star} = 200$ bp 的整合效率。\n预测效率 $E(L^{\\star})$ 由第1部分推导的模型给出：\n$$E(L^{\\star}) = 1 - \\exp(-\\hat{\\alpha} L^{\\star})$$\n代入数值 $\\hat{\\alpha} \\approx 0.009080875$ 和 $L^{\\star} = 200$：\n$$E(200) = 1 - \\exp(-0.009080875 \\times 200) = 1 - \\exp(-1.816175)$$\n计算该值：\n$$\\exp(-1.816175) \\approx 0.162645$$\n$$E(200) \\approx 1 - 0.162645 = 0.837355$$\n问题要求将最终答案四舍五入到四位有效数字。\n$$E(200) \\approx 0.8374$$\n这就是在同源长度为 $200$ bp 时的预测整合效率。", "answer": "$$\\boxed{0.8374}$$", "id": "2721188"}]}