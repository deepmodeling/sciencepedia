{"hands_on_practices": [{"introduction": "CRISPR-Cas系统面临的一个基本挑战是区分自身与非自身，以避免自身免疫。这项练习将引导你运用概率论的基本原理，来量化一个假设的CRISPR系统错误地靶向宿主基因组的风险。通过推导自身靶向率的解析表达式，你将深刻理解间隔序列（spacer）长度和原型间隔序列邻近基序（PAM）的特异性在确保系统安全性方面的关键作用。", "problem": "一个细菌宿主使用成簇规律间隔短回文重复序列 (CRISPR) 和 CRISPR 相关 (Cas) 核酸酶的适应性免疫系统，该系统通过与一个长度为 $L$ 的间隔子 (spacer) 的完全互补来识别外源 DNA，并且需要一个长度为 $m$ 的相邻的原型间隔子邻近基序 (Protospacer Adjacent Motif, PAM)。为避免自身免疫，宿主基因组中不得含有任何既能与间隔子完全匹配又拥有有效 PAM 的位点。考虑一个长度为 $N$ 个核苷酸的单环状染色体，其被建模为一个独立同分布的序列，核苷酸频率为 $\\mathbf{p}=(p_{\\mathrm{A}},p_{\\mathrm{C}},p_{\\mathrm{G}},p_{\\mathrm{T}})$，其中 $\\sum_{b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}} p_b = 1$。一个新获得的间隔子从相同的核苷酸分布 $\\mathbf{p}$ 中独立抽取。PAM 的定义由一个位置特异性的简并模式给出：对于每个 PAM 位置 $i \\in \\{1,\\dots,m\\}$，一个集合 $S_i \\subseteq \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}$ 指定了该位置允许的核苷酸。一个长度为 $L+m$ 的基因组窗口被称为自我靶向窗口，如果其前 $L$ 个核苷酸与间隔子序列完全匹配，且其后 $m$ 个核苷酸满足 PAM 的简并性要求，即对于所有 $i \\in \\{1,\\dots,m\\}$，第 $i$ 个 PAM 位置的核苷酸属于集合 $S_i$。假设核酸酶只识别这一种方向（PAM 紧邻在原型间隔子的下游），并且作用于单链。\n\n将基因组建模为从 $\\mathbf{p}$ 中独立抽取的序列，并在稀有事件机制下将不同的长度为 $L+m$ 的窗口视为近似独立的试验。仅使用基础概率原理（独立性、乘法法则和稀有事件的泊松近似），推导错误自我靶向率的闭式解析表达式。错误自我靶向率定义为在基因组中任何位置存在至少一个自我靶向窗口的概率。你的表达式必须写成 $N$、$L$、$m$、$\\mathbf{p}$ 和简并模式 $\\{S_i\\}_{i=1}^{m}$ 的函数。请以单个解析表达式的形式提供最终答案。不要引入任何额外的参数或经验常数。不需要进行数值计算。", "solution": "该问题已经过严格验证，被认为可以进行分析。\n\n**步骤1：提取已知条件**\n- 宿主基因组：长度为 $N$ 的单环状染色体。\n- 基因组模型：独立同分布 (i.i.d.) 序列。\n- 核苷酸频率: $\\mathbf{p}=(p_{\\mathrm{A}},p_{\\mathrm{C}},p_{\\mathrm{G}},p_{\\mathrm{T}})$，且 $\\sum_{b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}} p_b = 1$。\n- 间隔子 (Spacer)：长度为 $L$，从与基因组相同的分布 $\\mathbf{p}$ 中独立抽取。\n- 原型间隔子邻近基序 (Protospacer Adjacent Motif, PAM)：长度为 $m$。\n- PAM 定义：对于每个位置 $i \\in \\{1,\\dots,m\\}$，存在一个允许的核苷酸集合 $S_i \\subseteq \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}$。\n- 自我靶向窗口：一个长度为 $L+m$ 的基因组窗口，其前 $L$ 个核苷酸与间隔子匹配，后 $m$ 个核苷酸满足 PAM 的简并性要求。\n- 建模假设：\n    1. 核酸酶仅识别原型间隔子下游的 PAM。\n    2. 不同的长度为 $L+m$ 的窗口被视为近似独立的试验。\n    3. 系统处于稀有事件机制下，为泊松近似提供了依据。\n- 目标：推导错误自我靶向率的闭式解析表达式，该率定义为基因组中存在至少一个自我靶向窗口的概率。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，代表了 CRISPR-Cas9 靶标识别的一个标准且简化的概率模型，这是合成生物学中的一个基础课题。该问题提法明确，所有必要参数（$N$、$L$、$m$、$\\mathbf{p}$、$\\{S_i\\}$）和建模假设都已清晰定义。语言客观且正式。该问题避免了所有形式的无效性：它在事实上是成立的，可形式化且相关，内容完整，在给定的理想化条件下科学上可信，并且结构良好。\n\n**步骤3：结论与行动**\n问题有效。将推导一个形式化解。\n\n**推导**\n目标是求出基因组中出现至少一个自我靶向位点的概率。我们将此概率表示为 $P(\\text{self-target})$。这对应于 $P(X \\ge 1)$，其中 $X$ 是表示基因组中自我靶向位点总数的随机变量。\n\n问题指定使用稀有事件的泊松近似。根据这个框架，如果我们有 $K$ 次独立或弱相关的试验，每次成功的概率很小，为 $p$，那么总的成功次数可以用均值为 $\\lambda = Kp$ 的泊松分布来建模。观察到至少一次成功的概率则为 $1 - P(X=0) = 1 - \\exp(-\\lambda)$。\n\n首先，我们必须确定一个随机选择的长度为 $L+m$ 的基因组窗口是自我靶向位点的概率，我们称之为 $p_{st}$。一个窗口是自我靶向的，需要满足两个独立的条件：\n1.  其前 $L$ 个核苷酸（原型间隔子）必须与一个新获得的间隔子的序列完全匹配。\n2.  其后 $m$ 个核苷酸必须满足 PAM 识别标准。\n\n让我们计算每个条件的概率。\n\n**1. 间隔子匹配概率 ($P_{\\text{spacer}}$)**\n间隔子序列和基因组序列都是从相同的核苷酸分布 $\\mathbf{p} = (p_{\\mathrm{A}}, p_{\\mathrm{C}}, p_{\\mathrm{G}}, p_{\\mathrm{T}})$ 中抽取的独立同分布序列。我们需要计算基因组中一个特定的长度为 L 的序列与一个特定的长度为 L 的间隔子匹配的概率。考虑单个位置。基因组中的一个核苷酸与间隔子中的一个核苷酸匹配，如果它们都是'A'，或都是'C'等。由于间隔子和基因组的抽取是独立的，在单个位置上匹配的概率是：\n$$ P(\\text{match at 1 position}) = p_{\\mathrm{A}} \\cdot p_{\\mathrm{A}} + p_{\\mathrm{C}} \\cdot p_{\\mathrm{C}} + p_{\\mathrm{G}} \\cdot p_{\\mathrm{G}} + p_{\\mathrm{T}} \\cdot p_{\\mathrm{T}} = \\sum_{b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}} p_b^2 $$\n由于原型间隔子-间隔子比对中的所有 $L$ 个位置都是独立的试验，因此基因组窗口中整个长度为 $L$ 的原型间隔子与间隔子匹配的概率为：\n$$ P_{\\text{spacer}} = \\left( \\sum_{b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}} p_b^2 \\right)^L $$\n\n**2. 有效 PAM 的概率 ($P_{\\text{PAM}}$)**\nPAM 具有固定的长度 $m$，并由位置特异性的简并模式 $\\{S_i\\}_{i=1}^m$ 定义。对于基因组窗口中 PAM 序列的每个位置 $i$，其核苷酸必须属于集合 $S_i$。在给定的基因组位置，一个核苷酸满足 PAM 位置 $i$ 的约束的概率是允许的核苷酸的频率之和：\n$$ P(\\text{valid nucleotide at PAM position } i) = \\sum_{b \\in S_i} p_b $$\n由于 PAM 中 $m$ 个位置的核苷酸是独立的，一个随机选择的长度为 m 的序列满足 PAM 定义的总概率是每个位置概率的乘积：\n$$ P_{\\text{PAM}} = \\prod_{i=1}^{m} \\left( \\sum_{b \\in S_i} p_b \\right) $$\n\n**3. 单个自我靶向窗口的概率 ($p_{st}$)**\n基因组窗口的原型间隔子区域和 PAM 区域是相邻的，它们的序列是由独立的核苷酸抽取决定的。因此，间隔子匹配和 PAM 匹配事件是独立的。单个窗口成为自我靶向窗口的总概率 $p_{st}$ 是它们各自概率的乘积：\n$$ p_{st} = P_{\\text{spacer}} \\times P_{\\text{PAM}} = \\left( \\sum_{b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}} p_b^2 \\right)^L \\prod_{i=1}^{m} \\left( \\sum_{b \\in S_i} p_b \\right) $$\n\n**4. 应用泊松近似**\n细菌染色体是环状的，长度为 $N$。一个长度为 $L+m$ 的窗口有 $N$ 个可能的起始位置。我们将这 $N$ 个窗口视为 $N$ 次近似独立的试验。整个基因组中自我靶向窗口的期望数量 $\\lambda$ 是试验次数乘以单次试验的成功概率：\n$$ \\lambda = N \\cdot p_{st} = N \\left( \\sum_{b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}} p_b^2 \\right)^L \\prod_{i=1}^{m} \\left( \\sum_{b \\in S_i} p_b \\right) $$\n自我靶向窗口的数量 $X$ 假定服从参数为 $\\lambda$ 的泊松分布，即 $X \\sim \\text{Poisson}(\\lambda)$。\n\n错误自我靶向率是找到至少一个此类窗口的概率，即 $P(X \\ge 1)$。这与找到零个此类窗口的事件 $P(X=0)$ 互补。对于泊松分布，$P(X=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$。\n$$ P(X=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda) $$\n因此，错误自我靶向率为：\n$$ P(\\text{self-target}) = P(X \\ge 1) = 1 - P(X=0) = 1 - \\exp(-\\lambda) $$\n代入 $\\lambda$ 的完整表达式，我们得到错误自我靶向率的最终闭式表达式。", "answer": "$$ \\boxed{1 - \\exp\\left( -N \\left( \\sum_{b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}} p_b^2 \\right)^L \\prod_{i=1}^{m} \\left( \\sum_{b \\in S_i} p_b \\right) \\right)} $$", "id": "2725171"}, {"introduction": "在靶标识别之后，CRISPR-Cas复合物的命运并非简单的二元选择，而是一个动态的竞争过程。本练习构建了一个基于指数等待时间的随机动力学模型，来模拟干扰（interference）、解离（dissociation）和适应（priming）这几个相互竞争的生物物理过程。通过计算在特定错配条件下触发适应性免疫的概率，你将探索错配，尤其是在“种子”区域的错配，是如何精细调控系统从即时防御转向长期免疫记忆的。", "problem": "一个细菌的成簇规律间隔短回文重复序列 (CRISPR) 和 CRISPR 相关 (Cas) I-E 型系统利用 CRISPR 相关抗病毒防御复合体 (Cascade) 来结合邻近原间隔序列邻近基序 (PAM) 的一个原间隔序列。在 Cascade 结合后，可能发生两个相互竞争的随机事件：解离（R 环的丢失）和通过干扰进行的靶标降解（Cas3 介导的切割）。当 CRISPR RNA 和原间隔序列之间存在错配时，干扰可能会受损，而如果 Cascade 保持足够长的结合时间，则可以触发一个较慢的适应性途径（“引导”）。\n\n假设以下基于大分子结合中无记忆跃迁的、经充分检验的生物物理学事实的最小动力学模型：\n- 解离时间是一个指数随机变量 $T_{\\mathrm{off}} \\sim \\mathrm{Exp}(k_{\\mathrm{off}})$，其速率为 $k_{\\mathrm{off}}$。\n- 干扰切割时间是一个指数随机变量 $T_{\\mathrm{int}} \\sim \\mathrm{Exp}(k_{\\mathrm{int}})$，其速率为 $k_{\\mathrm{int}}$。\n- 在错配依赖性速率的条件下，$T_{\\mathrm{off}}$ 和 $T_{\\mathrm{int}}$ 是独立的。\n- 如果结合的复合体持续存在至少一个驻留时间阈值 $\\tau_{p}$，则引导被确定性地触发，也就是说，如果在 $\\tau_{p}$ 时刻之前既未发生解离也未发生干扰，则引导在该时刻发生。如果干扰先发生，则引导不被触发。如果在 $\\tau_{p}$ 之前发生解离，则引导不被触发。\n\n设原间隔序列长度为 $L = 32$ 个核苷酸，其“种子”区域位于位置 $1$ 到 $8$。设错配图谱由错配位置集合 $\\{2,7,10,15,23,28\\}$ 给出。使用以下与种子区增强的敏感性和远端较弱效应一致的错配到速率的映射：\n- 加权非种子区错配使用位置权重 $w_{i}$，定义如下：\n  - 对于 $i \\in \\{9,\\dots,20\\}$，$w_{i} = 0.5$。\n  - 对于 $i \\in \\{21,\\dots,32\\}$，$w_{i} = 0.2$。\n- 定义种子区错配计数 $M_{s} = \\sum_{i=1}^{8} x_{i}$ 和加权非种子区错配总和 $M_{n} = \\sum_{i=9}^{32} w_{i} x_{i}$，其中 $x_{i} \\in \\{0,1\\}$ 表示在位置 $i$ 处存在错配。\n\n假设一个次优 PAM，它通过固定因子降低干扰并使结合不稳定，以及完美匹配的基线速率：\n- 基线解离速率 $k_{\\mathrm{off}}^{0} = 0.02\\,\\mathrm{s}^{-1}$。\n- 基线干扰速率 $k_{\\mathrm{int}}^{0} = 0.20\\,\\mathrm{s}^{-1}$。\n- PAM 不稳定化因子 $\\delta_{\\mathrm{PAM}} = 1.5$，乘以 $k_{\\mathrm{off}}$。\n- PAM 干扰衰减因子 $\\gamma_{\\mathrm{PAM}} = 0.70$，乘以 $k_{\\mathrm{int}}$。\n- 种子区惩罚和非种子区惩罚：\n  - $k_{\\mathrm{off}} = k_{\\mathrm{off}}^{0} \\,\\exp\\!\\big(\\alpha_{s} M_{s} + \\alpha_{n} M_{n}\\big)\\,\\delta_{\\mathrm{PAM}}$，其中 $\\alpha_{s} = \\ln(5)$ 且 $\\alpha_{n} = \\ln(2)$。\n  - $k_{\\mathrm{int}} = k_{\\mathrm{int}}^{0} \\,\\exp\\!\\big(-\\beta_{s} M_{s} - \\beta_{n} M_{n}\\big)\\,\\gamma_{\\mathrm{PAM}}$，其中 $\\beta_{s} = \\ln(4)$ 且 $\\beta_{n} = \\ln(1.5)$。\n- 引导驻留时间阈值 $\\tau_{p} = 8\\,\\mathrm{s}$。\n\n从独立指数等待时间（无记忆过程）的定义出发，不使用任何预先推导的快捷公式，推导在单个 Cascade 结合事件中，干扰不足但引导被触发的概率的解析表达式。在此模型中，将“干扰不足但引导被触发”定义为引导发生且在解离前没有发生干扰切割的事件。然后，根据给定的错配图谱和参数，计算该概率的数值。将最终概率四舍五入到三位有效数字，并以小数形式表示（而非百分比）。", "solution": "首先将对所述问题的科学和逻辑一致性进行验证。\n\n**问题验证**\n\n**第 1 步：提取的已知条件**\n- **系统**：CRISPR-Cas I-E 型。\n- **竞争过程**：解离（时间 $T_{\\mathrm{off}}$）和干扰（时间 $T_{\\mathrm{int}}$）。\n- **随机模型**：\n    - $T_{\\mathrm{off}} \\sim \\mathrm{Exp}(k_{\\mathrm{off}})$。\n    - $T_{\\mathrm{int}} \\sim \\mathrm{Exp}(k_{\\mathrm{int}})$。\n    - $T_{\\mathrm{off}}$ 和 $T_{\\mathrm{int}}$ 是独立的随机变量。\n- **引导条件**：如果 Cascade 复合体持续到 $\\tau_{p}$，则引导在 $\\tau_{p}$ 时刻被触发。持续意味着既未发生解离也未发生干扰。\n- **原间隔序列几何结构**：长度 $L = 32$。种子区域为位置 $1$ 至 $8$。\n- **错配图谱**：错配位于位置 $\\{2, 7, 10, 15, 23, 28\\}$。\n- **错配权重**：\n    - 对于 $i \\in \\{9,\\dots,20\\}$，$w_{i} = 0.5$。\n    - 对于 $i \\in \\{21,\\dots,32\\}$，$w_{i} = 0.2$。\n- **错配定义**：\n    - 种子区错配计数 $M_{s} = \\sum_{i=1}^{8} x_{i}$。\n    - 加权非种子区错配总和 $M_{n} = \\sum_{i=9}^{32} w_{i} x_{i}$，其中 $x_{i} \\in \\{0,1\\}$。\n- **速率参数和方程**：\n    - $k_{\\mathrm{off}}^{0} = 0.02\\,\\mathrm{s}^{-1}$。\n    - $k_{\\mathrm{int}}^{0} = 0.20\\,\\mathrm{s}^{-1}$。\n    - $\\delta_{\\mathrm{PAM}} = 1.5$。\n    - $\\gamma_{\\mathrm{PAM}} = 0.70$。\n    - $\\alpha_{s} = \\ln(5)$，$\\alpha_{n} = \\ln(2)$。\n    - $\\beta_{s} = \\ln(4)$，$\\beta_{n} = \\ln(1.5)$。\n    - $k_{\\mathrm{off}} = k_{\\mathrm{off}}^{0} \\,\\exp(\\alpha_{s} M_{s} + \\alpha_{n} M_{n})\\,\\delta_{\\mathrm{PAM}}$。\n    - $k_{\\mathrm{int}} = k_{\\mathrm{int}}^{0} \\,\\exp(-\\beta_{s} M_{s} - \\beta_{n} M_{n})\\,\\gamma_{\\mathrm{PAM}}$。\n- **引导阈值**：$\\tau_{p} = 8\\,\\mathrm{s}$。\n- **目标**：推导并计算定义为“干扰不足但引导被触发”的事件的概率，该事件具体为“引导发生且在解离前没有发生干扰切割的事件”。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题具有科学依据，代表了一种简化的、但标准的用于生物物理学中竞争性随机过程的动力学模型。对无记忆事件的等待时间使用指数分布是此类模型的基石。这种参数化方法使速率依赖于错配的数量和位置，与 CRISPR-Cas9及相关系统的实验观察结果一致。该问题是适定的，提供了计算唯一概率所需的所有必要定义、参数和函数形式。语言客观且定量。问题不包含科学谬误、矛盾或含糊之处。\n\n**第 3 步：结论与行动**\n问题被判定为**有效**。将推导解答。\n\n**推导与解答**\n\n目标是计算在引导被触发且复合体的最终命运是解离而非干扰的事件的概率。设此事件为 $A$。我们根据问题陈述将条件形式化。\n\n1.  **“引导发生”**：这种情况发生于复合体保持结合的时间至少为 $\\tau_p$。复合体的寿命由两个事件中首先发生的那个决定：解离或干扰。因此，复合体保持结合直到时间 $T_{\\mathrm{bound}} = \\min(T_{\\mathrm{off}}, T_{\\mathrm{int}})$。引导的条件是 $T_{\\mathrm{bound}} \\ge \\tau_p$，这等价于两个条件的合取：$T_{\\mathrm{off}} \\ge \\tau_p$ 和 $T_{\\mathrm{int}} \\ge \\tau_p$。\n2.  **“在解离前没有发生干扰切割”**：这是关于两个随机事件顺序的陈述。这意味着解离时间小于干扰时间：$T_{\\mathrm{off}} < T_{\\mathrm{int}}$。\n\n结合这些条件，事件 $A$ 是交集：\n$$A = \\{ (T_{\\mathrm{off}} \\ge \\tau_p) \\cap (T_{\\mathrm{int}} \\ge \\tau_p) \\cap (T_{\\mathrm{off}} < T_{\\mathrm{int}}) \\}$$\n时间 $T_{\\mathrm{off}}$ 和 $T_{\\mathrm{int}}$ 是独立的指数随机变量，其速率分别为 $k_{\\mathrm{off}}$ 和 $k_{\\mathrm{int}}$。它们的概率密度函数 (PDF) 分别是 $f_{\\mathrm{off}}(t) = k_{\\mathrm{off}} \\exp(-k_{\\mathrm{off}} t)$（对于 $t \\ge 0$）和 $f_{\\mathrm{int}}(t) = k_{\\mathrm{int}} \\exp(-k_{\\mathrm{int}} t)$（对于 $t \\ge 0$）。由于独立性，它们的联合概率密度函数是 $f(t_{\\mathrm{off}}, t_{\\mathrm{int}}) = k_{\\mathrm{off}} k_{\\mathrm{int}} \\exp(-k_{\\mathrm{off}} t_{\\mathrm{off}} - k_{\\mathrm{int}} t_{\\mathrm{int}})$（对于 $t_{\\mathrm{off}}, t_{\\mathrm{int}} \\ge 0$）。\n\n概率 $P(A)$ 通过在 $(t_{\\mathrm{off}}, t_{\\mathrm{int}})$ 平面上对联合概率密度函数进行积分求得，积分区域 $D$ 由事件 $A$ 的不等式定义：$t_{\\mathrm{off}} \\ge \\tau_p$，$t_{\\mathrm{int}} \\ge \\tau_p$ 和 $t_{\\mathrm{off}} < t_{\\mathrm{int}}$。积分区域可以表示为 $t_{\\mathrm{off}} \\in [\\tau_p, \\infty)$ 和 $t_{\\mathrm{int}} \\in (t_{\\mathrm{off}}, \\infty)$，注意到由于 $t_{\\mathrm{off}} \\ge \\tau_p$，条件 $t_{\\mathrm{int}} > t_{\\mathrm{off}}$ 自动保证了 $t_{\\mathrm{int}} > \\tau_p$。\n\n积分建立如下：\n$$P(A) = \\int_{\\tau_p}^{\\infty} \\int_{t_{\\mathrm{off}}}^{\\infty} f(t_{\\mathrm{off}}, t_{\\mathrm{int}}) \\, dt_{\\mathrm{int}} \\, dt_{\\mathrm{off}} = \\int_{\\tau_p}^{\\infty} \\int_{t_{\\mathrm{off}}}^{\\infty} k_{\\mathrm{off}} k_{\\mathrm{int}} \\exp(-k_{\\mathrm{off}} t_{\\mathrm{off}} - k_{\\mathrm{int}} t_{\\mathrm{int}}) \\, dt_{\\mathrm{int}} \\, dt_{\\mathrm{off}}$$\n\n首先，我们求解关于 $t_{\\mathrm{int}}$ 的内层积分：\n$$ \\int_{t_{\\mathrm{off}}}^{\\infty} k_{\\mathrm{int}} \\exp(-k_{\\mathrm{int}} t_{\\mathrm{int}}) \\, dt_{\\mathrm{int}} = \\left[ -\\exp(-k_{\\mathrm{int}} t_{\\mathrm{int}}) \\right]_{t_{\\mathrm{off}}}^{\\infty} = 0 - (-\\exp(-k_{\\mathrm{int}} t_{\\mathrm{off}})) = \\exp(-k_{\\mathrm{int}} t_{\\mathrm{off}}) $$\n\n接着，将此结果代入外层积分：\n$$ P(A) = \\int_{\\tau_p}^{\\infty} k_{\\mathrm{off}} \\exp(-k_{\\mathrm{off}} t_{\\mathrm{off}}) \\, \\exp(-k_{\\mathrm{int}} t_{\\mathrm{off}}) \\, dt_{\\mathrm{off}} = \\int_{\\tau_p}^{\\infty} k_{\\mathrm{off}} \\exp(-(k_{\\mathrm{off}} + k_{\\mathrm{int}}) t_{\\mathrm{off}}) \\, dt_{\\mathrm{off}} $$\n\n现在，我们求解这个积分：\n$$ P(A) = k_{\\mathrm{off}} \\left[ \\frac{-\\exp(-(k_{\\mathrm{off}} + k_{\\mathrm{int}}) t_{\\mathrm{off}})}{k_{\\mathrm{off}} + k_{\\mathrm{int}}} \\right]_{\\tau_p}^{\\infty} $$\n$$ P(A) = \\frac{-k_{\\mathrm{off}}}{k_{\\mathrm{off}} + k_{\\mathrm{int}}} \\left( \\lim_{t_{\\mathrm{off}} \\to \\infty} \\exp(-(k_{\\mathrm{off}} + k_{\\mathrm{int}}) t_{\\mathrm{off}}) - \\exp(-(k_{\\mathrm{off}} + k_{\\mathrm{int}}) \\tau_p) \\right) $$\n由于 $k_{\\mathrm{off}} > 0$ 和 $k_{\\mathrm{int}} > 0$，极限为 $0$。\n$$ P(A) = \\frac{-k_{\\mathrm{off}}}{k_{\\mathrm{off}} + k_{\\mathrm{int}}} \\left( 0 - \\exp(-(k_{\\mathrm{off}} + k_{\\mathrm{int}}) \\tau_p) \\right) $$\n这就得出了概率的最终解析表达式：\n$$ P(A) = \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{off}} + k_{\\mathrm{int}}} \\exp(-(k_{\\mathrm{off}} + k_{\\mathrm{int}}) \\tau_p) $$\n\n现在，我们必须计算速率 $k_{\\mathrm{off}}$ 和 $k_{\\mathrm{int}}$ 的数值。\n首先，我们根据给定的错配图谱 $\\{2, 7, 10, 15, 23, 28\\}$ 计算错配计数 $M_s$ 和 $M_n$。\n- 种子区错配（位置 $1-8$）：$\\{2, 7\\}$。因此，$M_s = 2$。\n- 非种子区错配：$\\{10, 15, 23, 28\\}$。我们应用位置权重。\n    - 位置 $10$ 和 $15$ 在范围 $\\{9, \\dots, 20\\}$ 内，所以它们的权重为 $w_i = 0.5$。\n    - 位置 $23$ 和 $28$ 在范围 $\\{21, \\dots, 32\\}$ 内，所以它们的权重为 $w_i = 0.2$。\n- 加权非种子区错配总和是 $M_n = 1 \\cdot 0.5 + 1 \\cdot 0.5 + 1 \\cdot 0.2 + 1 \\cdot 0.2 = 1.0 + 0.4 = 1.4$。\n\n接下来，我们使用提供的公式计算速率：\n$k_{\\mathrm{off}} = k_{\\mathrm{off}}^{0} \\,\\exp(\\alpha_{s} M_{s} + \\alpha_{n} M_{n})\\,\\delta_{\\mathrm{PAM}}$\n$k_{\\mathrm{off}} = k_{\\mathrm{off}}^{0} \\cdot 5^{M_s} \\cdot 2^{M_n} \\cdot \\delta_{\\mathrm{PAM}} = (0.02) \\cdot (5^{2}) \\cdot (2^{1.4}) \\cdot (1.5) = (0.02) \\cdot (25) \\cdot (2^{1.4}) \\cdot (1.5) = 0.75 \\cdot 2^{1.4} \\, \\mathrm{s}^{-1}$。\n$k_{\\mathrm{off}} \\approx 0.75 \\cdot (2.6390158) \\approx 1.97926185 \\, \\mathrm{s}^{-1}$。\n\n$k_{\\mathrm{int}} = k_{\\mathrm{int}}^{0} \\,\\exp(-\\beta_{s} M_{s} - \\beta_{n} M_{n})\\,\\gamma_{\\mathrm{PAM}}$\n$k_{\\mathrm{int}} = k_{\\mathrm{int}}^{0} \\cdot 4^{-M_s} \\cdot 1.5^{-M_n} \\cdot \\gamma_{\\mathrm{PAM}} = (0.20) \\cdot (4^{-2}) \\cdot (1.5^{-1.4}) \\cdot (0.70)$。\n$k_{\\mathrm{int}} = (0.20) \\cdot \\left(\\frac{1}{16}\\right) \\cdot (1.5^{-1.4}) \\cdot (0.70) = (0.0125) \\cdot (0.70) \\cdot (1.5^{-1.4}) = 0.00875 \\cdot 1.5^{-1.4} \\, \\mathrm{s}^{-1}$。\n$k_{\\mathrm{int}} \\approx 0.00875 / (1.760778) \\approx 0.00496939 \\, \\mathrm{s}^{-1}$。\n\n最后，我们将这些值和 $\\tau_p=8\\,\\mathrm{s}$ 代入概率表达式中：\n$k_{\\mathrm{off}} + k_{\\mathrm{int}} \\approx 1.97926185 + 0.00496939 = 1.98423124 \\, \\mathrm{s}^{-1}$。\n前置因子是：\n$\\frac{k_{\\mathrm{off}}}{k_{\\mathrm{off}} + k_{\\mathrm{int}}} \\approx \\frac{1.97926185}{1.98423124} \\approx 0.9974955$。\n指数项是：\n$\\exp(-(k_{\\mathrm{off}} + k_{\\mathrm{int}}) \\tau_p) \\approx \\exp(-1.98423124 \\cdot 8) = \\exp(-15.8738499) \\approx 1.2766 \\times 10^{-7}$。\n\n最终概率是这两项的乘积：\n$P(A) \\approx (0.9974955) \\cdot (1.2766 \\times 10^{-7}) \\approx 1.27341 \\times 10^{-7}$。\n\n四舍五入到三位有效数字，概率是 $1.27 \\times 10^{-7}$。", "answer": "$$\\boxed{1.27 \\times 10^{-7}}$$", "id": "2725185"}, {"introduction": "CRISPR-Cas系统的分子特性如何影响整个生态系统的宏观动态？这项练习将视角从单个分子事件提升到种群层面，要求你构建常微分方程（ODE）模型来描述细菌与噬菌体之间的军备竞赛。通过分析该模型并推导噬菌体入侵的阈值条件，你将学习如何将CRISPR的效率（$\\epsilon$）等微观参数与种群共存或排除等宏观生态学结局联系起来，为设计和预测合成生物系统在复杂环境中的行为提供了理论框架。", "problem": "一个充分混合的细菌种群由两个亚群组成：无成簇规律间隔短回文重复序列（CRISPR）免疫的细菌，记为 $B_{s}(t)$，和具有CRISPR免疫的细菌，记为 $B_{r}(t)$。存在一个密度为 $P(t)$ 的单一裂解性噬菌体种群。假设：\n- 两个细菌亚群都依赖共享资源进行逻辑斯谛增长，其内禀人均增长率分别为 $r_{s}$ 和 $r_{r}$，总细菌生物量 $B_{s}+B_{r}$ 的共同环境承载力为 $K$。\n- 噬菌体以质量作用速率常数 $\\phi$ 吸附到细菌上。当吸附到非CRISPR细菌 $B_{s}$ 上时，感染总是成功的，伴随瞬时裂解，每次感染事件的裂解量为 $b$ 个噬菌体（每次吸附到 $B_{s}$ 上的净变化为 $b-1$ 个噬菌体）。当吸附到CRISPR细菌 $B_{r}$ 上时，感染以 $1-\\epsilon$ 的概率成功（瞬时裂解，净产生 $b-1$ 个噬菌体），并以 $\\epsilon$ 的概率被中和（被吸附的噬菌体被摧毁，不发生裂解，也不产生新的噬菌体）。游离噬菌体以速率 $m$ 衰变。\n- 存在从 $B_{s}$ 到 $B_{r}$ 的组成性间隔序列获取，人均速率为 $\\mu$；以及从 $B_{r}$ 到 $B_{s}$ 的间隔序列丢失，人均速率为 $\\sigma$。这些转换过程保持总细菌生物量不变。\n- 所有参数均为正常数，且 $b>1$，$ \\epsilon \\in [0,1]$。\n\n1. 从质量作用感染动力学和逻辑斯谛增长出发，为 $(B_{s},B_{r},P)$ 写出一个与上述假设一致的常微分方程（ODE）模型。从质量作用感染和逻辑斯谛资源限制的第一性原理出发，仔细论证每一项。\n\n2. 考虑 $P=0$ 的无病毒平衡点。在没有噬菌体的情况下细菌的增长使环境承载力达到饱和的假设下，用 $K,\\mu,\\sigma$ 表示平衡值 $(B_{s}^{0},B_{r}^{0})$，并利用方程的结构论证总细菌生物量在 $K$ 处的稳定性。\n\n3. 使用噬菌体方程在无病毒平衡点 $(B_{s}^{0},B_{r}^{0},P=0)$ 附近的线性化，推导出明确的阈值效力 $\\epsilon_{c}$，使得当噬菌体稀有时其种群既不增长也不减少。从生物学上将此阈值解释为噬菌体排斥（对于 $\\epsilon>\\epsilon_{c}$）与所有三个种群可能共存（对于 $\\epsilon<\\epsilon_{c}$）之间的界限，并指出使 $\\epsilon_{c}$ 位于区间 $[0,1]$ 内所需的任何参数条件。\n\n以 $b,\\phi,m,K,\\mu,\\sigma$ 的单个闭式解析表达式形式给出 $\\epsilon_{c}$ 的最终答案。无需进行数值评估，最终答案框中不应包含单位。如果使用了任何中间近似，必须根据所述假设进行论证。确保每个符号和数字都用LaTeX书写。", "solution": "已对问题陈述的科学性和数学有效性进行了分析。它提出了一个标准的、尽管简化的宿主-寄生者系统种群动态模型，该系统具有演化防御机制。逻辑斯谛增长、质量作用动力学和组成性转换的假设是理论生态学中常见的理想化处理。该问题是自洽的、逻辑一致且适定的。因此，它被认为是有效的，可以构建一个正式的解决方案。\n\n该问题要求完成三项任务：推导控制性常微分方程（ODEs）、分析无病毒平衡点、以及推导临界CRISPR效力阈值。我们将依次解决这些问题。\n\n1. ODE模型的推导\n\n该系统由三个种群组成：易感细菌 $B_s(t)$、抗性（具有CRISPR功能的）细菌 $B_r(t)$ 和噬菌体 $P(t)$。其动力学是从第一性原理构建的。\n\n易感种群的变化率 $\\frac{dB_s}{dt}$ 是三个效应的总和：\n-   逻辑斯谛增长：该种群以其内禀速率 $r_s$ 增长，受总细菌种群 $B_s+B_r$ 相对于环境承载力 $K$ 的限制。该项为 $r_s B_s \\left(1 - \\frac{B_s+B_r}{K}\\right)$。\n-   噬菌体捕食：噬菌体以与其密度成正比的速率吸附到易感细菌上，由质量作用动力学给出为 $\\phi B_s P$。每个此类事件都会导致细菌死亡。这是一个损失项，$-\\phi P B_s$。\n-   种群转换：细菌以人均速率 $\\mu$ 获取间隔序列并变得具有抗性，导致一个损失项 $-\\mu B_s$。相反，抗性细菌以人均速率 $\\sigma$ 丢失间隔序列并变得易感，导致一个增益项 $\\sigma B_r$。\n结合这些项得到第一个ODE：\n$$ \\frac{dB_s}{dt} = r_s B_s \\left(1 - \\frac{B_s+B_r}{K}\\right) - \\phi P B_s - \\mu B_s + \\sigma B_r $$\n\n抗性种群的变化率 $\\frac{dB_r}{dt}$ 的确定方式类似：\n-   逻辑斯谛增长：该种群以其内禀速率 $r_r$ 增长，受相同的总环境承载力限制。该项为 $r_r B_r \\left(1 - \\frac{B_s+B_r}{K}\\right)$。\n-   噬菌体捕食：噬菌体以速率 $\\phi B_r P$ 吸附到抗性细菌上。感染仅以概率 $1-\\epsilon$ 成功，导致裂解。因此 $B_r$ 的损失率为 $-(1-\\epsilon)\\phi P B_r$。以概率 $\\epsilon$，感染被中和，细菌存活。\n-   种群转换：该种群从易感池中以速率 $\\mu B_s$ 获得个体，并因间隔序列丢失以速率 $\\sigma B_r$ 失去个体。净变化为 $\\mu B_s - \\sigma B_r$。\n结合这些项得到第二个ODE：\n$$ \\frac{dB_r}{dt} = r_r B_r \\left(1 - \\frac{B_s+B_r}{K}\\right) - (1-\\epsilon)\\phi P B_r + \\mu B_s - \\sigma B_r $$\n\n噬菌体种群的变化率 $\\frac{dP}{dt}$ 由感染产生的噬菌体和自然衰变决定：\n-   来自 $B_s$ 的产生：对 $B_s$ 的吸附事件以速率 $\\phi P B_s$ 发生。每个事件产生裂解量为 $b$ 的新噬菌体，同时消耗一个，净产生 $b-1$ 个。变化率为 $(b-1)\\phi P B_s$。\n-   来自 $B_r$ 的净产生：对 $B_r$ 的吸附事件以速率 $\\phi P B_r$ 发生。以概率 $1-\\epsilon$，感染成功，产生 $b-1$ 个噬菌体的净变化。以概率 $\\epsilon$，噬菌体被摧毁，净变化为 $-1$。每次吸附到 $B_r$ 上的平均净变化是 $(1-\\epsilon)(b-1) + \\epsilon(-1) = b-1-\\epsilon b$。因此变化率为 $(b-1-\\epsilon b)\\phi P B_r$。\n-   噬菌体衰变：游离噬菌体颗粒以人均速率 $m$ 衰变。这是一个损失项，$-mP$。\n结合这些项并提出因子 $P$ 得到第三个ODE：\n$$ \\frac{dP}{dt} = (b-1)\\phi P B_s + (b-1-\\epsilon b)\\phi P B_r - mP = P\\left[\\phi(b-1)B_s + \\phi(b-1-\\epsilon b)B_r - m\\right] $$\n\n2. 无病毒平衡点的分析\n\n在无病毒平衡点， $P=0$ 且种群恒定，因此 $\\frac{dB_s}{dt}=0$ 和 $\\frac{dB_r}{dt}=0$。系统简化为：\n$$ 0 = r_s B_s \\left(1 - \\frac{B_s+B_r}{K}\\right) - \\mu B_s + \\sigma B_r $$\n$$ 0 = r_r B_r \\left(1 - \\frac{B_s+B_r}{K}\\right) + \\mu B_s - \\sigma B_r $$\n问题陈述的假设是总细菌生物量使环境承载力达到饱和，这意味着在平衡点，$B_s^0 + B_r^0 = K$。将此代入平衡方程，逻辑斯谛增长项 $r_s B_s^0(1-K/K)$ 和 $r_r B_r^0(1-K/K)$ 均变为零。系统简化为：\n$$ 0 = -\\mu B_s^0 + \\sigma B_r^0 $$\n$$ 0 = \\mu B_s^0 - \\sigma B_r^0 $$\n两个方程都得出相同的条件，$\\mu B_s^0 = \\sigma B_r^0$，这证实了与初始假设的一致性。我们现在求解线性系统以获得平衡值 $(B_s^0, B_r^0)$：\n1.  $B_s^0 + B_r^0 = K$\n2.  $\\mu B_s^0 = \\sigma B_r^0$\n从第二个方程，我们有 $B_r^0 = \\frac{\\mu}{\\sigma}B_s^0$。将其代入第一个方程：\n$B_s^0 + \\frac{\\mu}{\\sigma}B_s^0 = K \\implies B_s^0\\left(1+\\frac{\\mu}{\\sigma}\\right) = K \\implies B_s^0\\left(\\frac{\\sigma+\\mu}{\\sigma}\\right) = K$。\n这给出了 $B_s^0$ 的平衡值：\n$$ B_s^0 = K \\frac{\\sigma}{\\mu+\\sigma} $$\n然后，从 $B_r^0 = K - B_s^0$ 可以求出 $B_r^0$：\n$$ B_r^0 = K - K \\frac{\\sigma}{\\mu+\\sigma} = K\\left(\\frac{\\mu+\\sigma-\\sigma}{\\mu+\\sigma}\\right) = K \\frac{\\mu}{\\mu+\\sigma} $$\n为论证在没有噬菌体的情况下总生物量 $N(t) = B_s(t)+B_r(t)$ 在 $K$ 处的稳定性，我们将 $P=0$ 时 $B_s$ 和 $B_r$ 的ODE相加：\n$$ \\frac{dN}{dt} = \\frac{dB_s}{dt} + \\frac{dB_r}{dt} = r_s B_s \\left(1 - \\frac{N}{K}\\right) - \\mu B_s + \\sigma B_r + r_r B_r \\left(1 - \\frac{N}{K}\\right) + \\mu B_s - \\sigma B_r $$\n转换项 $-\\mu B_s + \\sigma B_r$ 和 $+\\mu B_s - \\sigma B_r$ 相互抵消，正如转换过程中生物量守恒所规定的。我们剩下：\n$$ \\frac{dN}{dt} = \\left(1 - \\frac{N}{K}\\right)(r_s B_s + r_r B_r) $$\n定义平均增长率 $\\bar{r}(t) = \\frac{r_s B_s(t) + r_r B_r(t)}{N(t)}$，方程变为 $\\frac{dN}{dt} = N\\bar{r}(t)\\left(1 - \\frac{N}{K}\\right)$。由于 $r_s, r_r > 0$，$\\bar{r}(t)$ 总是正的。这是总生物量 $N$ 的逻辑斯谛方程。对于任何正的初始条件，不动点 $N=K$ 是全局稳定的，因为当 $N<K$ 时 $\\frac{dN}{dt} > 0$ 且当 $N>K$ 时 $\\frac{dN}{dt} < 0$。因此，总细菌种群将总是趋向于 $K$。\n\n3. 临界效力 $\\epsilon_c$ 的推导\n\n为确定噬菌体入侵的条件，我们在无病毒平衡点 $(B_s^0, B_r^0, P=0)$ 附近对噬菌体方程进行线性稳定性分析。当噬菌体稀有时，如果其初始人均增长率为正，则噬菌体种群可以入侵。这个增长率 $\\lambda_P$ 由下式给出：\n$$ \\lambda_P = \\left. \\frac{1}{P}\\frac{dP}{dt} \\right|_{(B_s^0, B_r^0, 0)} = \\phi(b-1)B_s^0 + \\phi(b-1-\\epsilon b)B_r^0 - m $$\n阈值效力 $\\epsilon_c$ 是使噬菌体种群既不增长也不减少的 $\\epsilon$ 值，即 $\\lambda_P = 0$。\n$$ \\phi(b-1)B_s^0 + \\phi(b-1-\\epsilon_c b)B_r^0 - m = 0 $$\n代入 $B_s^0$ 和 $B_r^0$ 的平衡值：\n$$ \\phi(b-1)\\left(K \\frac{\\sigma}{\\mu+\\sigma}\\right) + \\phi(b-1-\\epsilon_c b)\\left(K \\frac{\\mu}{\\mu+\\sigma}\\right) - m = 0 $$\n为了求解 $\\epsilon_c$，我们首先分离与噬菌体相关的项：\n$$ \\frac{\\phi K}{\\mu+\\sigma}\\left[(b-1)\\sigma + (b-1-\\epsilon_c b)\\mu\\right] = m $$\n展开方括号中的项：\n$$ (b-1)\\sigma + (b-1)\\mu - \\epsilon_c b \\mu = (b-1)(\\mu+\\sigma) - \\epsilon_c b\\mu $$\n将此代回方程：\n$$ \\frac{\\phi K}{\\mu+\\sigma}\\left[(b-1)(\\mu+\\sigma) - \\epsilon_c b\\mu\\right] = m $$\n除以 $\\frac{\\mu+\\sigma}{\\phi K}$:\n$$ (b-1)(\\mu+\\sigma) - \\epsilon_c b\\mu = \\frac{m(\\mu+\\sigma)}{\\phi K} $$\n这简化为：\n$$ \\phi K \\left[ (b-1) - \\frac{\\epsilon_c b\\mu}{\\mu+\\sigma} \\right] = m $$\n现在，我们求解 $\\epsilon_c$：\n$$ (b-1) - \\frac{\\epsilon_c b\\mu}{\\mu+\\sigma} = \\frac{m}{\\phi K} $$\n$$ \\frac{\\epsilon_c b\\mu}{\\mu+\\sigma} = b-1 - \\frac{m}{\\phi K} $$\n$$ \\epsilon_c = \\left(b-1 - \\frac{m}{\\phi K}\\right)\\frac{\\mu+\\sigma}{b\\mu} $$\n从生物学上讲，$\\epsilon_c$ 代表CRISPR效力的盈亏平衡点。如果实际效力 $\\epsilon$ 大于 $\\epsilon_c$，则噬菌体净增长率 $\\lambda_P$ 变为负，噬菌体种群将从系统中清除（噬菌体排斥）。如果 $\\epsilon < \\epsilon_c$，则 $\\lambda_P > 0$，允许噬菌体种群入侵并可能与细菌共存。\n为了使 $\\epsilon_c$ 成为一个有意义的概率，它必须位于区间 $[0,1]$ 内。条件 $\\epsilon_c \\ge 0$ 要求 $b-1 - \\frac{m}{\\phi K} \\ge 0$，这简化为 $\\phi K (b-1) \\ge m$。这意味着最大噬菌体产生率（如果整个细菌种群 $K$ 都是易感的话）必须超过噬菌体衰变率。如果不满足此条件，噬菌体甚至无法入侵一个完全易感的种群，CRISPR效力的问题就无关紧要了。条件 $\\epsilon_c \\le 1$ 确保在某些参数体系下，完全免疫 ($\\epsilon=1$) 足以阻止入侵。", "answer": "$$\\boxed{\\frac{\\mu+\\sigma}{b\\mu}\\left(b-1 - \\frac{m}{\\phi K}\\right)}$$", "id": "2725290"}]}