{"hands_on_practices": [{"introduction": "定向进化的第一步是创造多样性，而控制诱变率是其中的关键。突变率过低，你可能无法充分探索序列空间；突变率过高，则可能因累积过多有害突变而破坏蛋白质功能。本练习将引导你从第一性原理出发，计算在易错PCR（error-prone PCR）中实现目标突变负荷所需的基础错误率，这是校准任何诱变实验的基础定量工具。[@problem_id:2761288]", "problem": "在一项定向进化项目中，您计划使用易错聚合酶链式反应 (PCR) 来生成单个基因的突变体文库。假设每个基因拷贝只有一个有效的诱变掺入步骤，这意味着在整个基因长度上，每个位置都经历一次诱变掺入事件，该事件可以以相同的概率独立地引入一个错误。设基因长度为 $1.2\\,\\mathrm{kb}$，目标文库平均每个基因拷贝有 $1.5$ 个核苷酸替换。\n\n仅使用以下基本原则：\n- 基因有 $L$ 个位置（碱基对），此处 $L = 1.2\\,\\mathrm{kb}$。\n- 每个碱基都是一次独立的伯努利试验，在每个有效的诱变掺入步骤中，每个碱基的错误概率为 $p$。\n- 每个基因的总突变数是 $L$ 次独立伯努利试验的总和，其期望值是各个期望值的总和。\n\n从第一性原理出发，推导出在每个有效的诱变掺入步骤中，为达到每个基因指定的平均突变数所需的每个碱基的错误概率 $p$。将最终答案表示为无单位小数，并四舍五入到四位有效数字。", "solution": "对所述问题进行验证。\n\n**步骤 1：提取的已知条件**\n- 基因长度: $L = 1.2\\,\\mathrm{kb}$\n- 目标平均每个基因拷贝的核苷酸替换数: $\\mu = 1.5$\n- 假设：每个基因拷贝只有一个有效的诱变掺入步骤。\n- 原则：基因有 $L$ 个位置。\n- 原则：每个碱基都是一次独立的伯努利试验，每个碱基的错误概率为 $p$。\n- 原则：总突变数是 $L$ 次独立伯努利试验的总和，其期望值是各个期望值的总和。\n- 目标：推导每个碱基的错误概率 $p$。\n- 最终格式：无单位小数，四舍五入到四位有效数字。\n\n**步骤 2：验证结论**\n该问题在科学上基于分子生物学和概率论的原理。所呈现的诱变模型——一系列独立的伯努利试验——是定向进化领域中使用的标准且有效的简化模型。给定的参数，即一个 $1.2\\,\\mathrm{kb}$ 的基因和平均 $1.5$ 个突变，对于易错 PCR 实验是符合实际的。这个问题提法恰当，信息充分，语言清晰客观。它不包含任何矛盾、歧义或事实性错误。\n\n因此，该问题被判定为**有效**。我们继续进行求解。\n\n推导必须按要求从第一性原理开始。该问题涉及在每个碱基具有特定突变概率的过程中，给定长度的基因所产生的期望突变数。\n\n设 $L$ 为基因的长度（单位为碱基对）。问题陈述 $L = 1.2\\,\\mathrm{kb}$。由于 $1\\,\\mathrm{kb}$ 等于 $1000$ 个碱基对，所以长度为：\n$$L = 1.2 \\times 1000 = 1200 \\text{ base pairs}$$\n设 $p$ 为每个有效诱变掺入步骤中每个碱基的错误概率。这是我们必须确定的量。\n\n根据问题的原则，在任何单个碱基位置发生突变的事件都是一次独立的伯努利试验。我们定义一组随机变量 $\\{X_i\\}_{i=1}^{L}$，其中 $X_i$ 对应于第 $i$ 个碱基位置的结果。\n变量 $X_i$ 可以取两个值：\n- 如果在位置 $i$ 发生突变，则 $X_i = 1$。\n- 如果在位置 $i$ 没有发生突变，则 $X_i = 0$。\n\n在任何给定位置发生突变的概率是 $p$。因此，每个 $X_i$ 的概率质量函数为：\n$$P(X_i = 1) = p$$\n$$P(X_i = 0) = 1 - p$$\n单个伯努利试验的期望值 $E[X_i]$ 根据定义是：\n$$E[X_i] = (1 \\times P(X_i = 1)) + (0 \\times P(X_i = 0)) = (1 \\times p) + (0 \\times (1-p)) = p$$\n\n单个基因拷贝中的总突变数 $M$ 是这 $L$ 次独立试验结果的总和：\n$$M = \\sum_{i=1}^{L} X_i$$\n问题要求找到使每个基因拷贝的平均突变数达到目标值 $\\mu = 1.5$ 的条件。随机变量的“平均值”即为其期望值 $E[M]$。因此，我们必须计算 $M$ 的期望值。\n\n根据期望的线性性质，即随机变量之和的期望等于它们各自期望之和，我们有：\n$$E[M] = E\\left[\\sum_{i=1}^{L} X_i\\right] = \\sum_{i=1}^{L} E[X_i]$$\n由于假设每个位置具有相同的每个碱基错误概率 $p$，所以对于所有的 $i=1, 2, \\dots, L$，期望值 $E[X_i]$ 都是相同的。\n$$E[X_i] = p$$\n将此代入总和中：\n$$E[M] = \\sum_{i=1}^{L} p = L \\cdot p$$\n问题指定目标平均突变数为 $\\mu = 1.5$。因此，我们令 $E[M] = \\mu$：\n$$\\mu = L \\cdot p$$\n我们被要求找出满足此条件的 $p$ 值。我们可以重新整理方程以解出 $p$：\n$$p = \\frac{\\mu}{L}$$\n现在，我们代入给定的数值：$\\mu = 1.5$ 和 $L = 1200$。\n$$p = \\frac{1.5}{1200}$$\n进行计算：\n$$p = 0.00125$$\n问题要求最终答案四舍五入到四位有效数字。数字 $0.00125$ 有三位有效数字（数字 $1$、$2$ 和 $5$）。为了用四位有效数字表示这个结果，我们必须在末尾添加一个零。\n$$p = 0.001250$$\n这就是在每个 $1.2\\,\\mathrm{kb}$ 基因上实现平均 $1.5$ 个突变所需的、每个有效诱变掺入步骤中每个碱基的错误概率。", "answer": "$$\\boxed{0.001250}$$", "id": "2761288"}, {"introduction": "选择是定向进化的核心引擎，它将功能微弱的改进放大为显著的优势。本练习通过一个简化的生存选择模型，生动地展示了功能性变体和非功能性变体之间即使存在微小的存活概率差异，在经过多轮选择后也能导致戏剧性的富集。理解这种指数级的富集动力学，对于设计有效的选择策略至关重要。[@problem_id:2761248]", "problem": "一场基于存活的定向进化活动筛选了一个包含两类变体（催化活性和非活性）的大型文库。在每一轮筛选中，每个分子以其类别条件概率独立存活，存活下来的分子随后被无偏向地扩增并归一化至相同的总群体数量，因此轮次后的类别频率仅反映存活情况。设活性变体的初始比例为 $f_{A,0}$，非活性变体的初始比例为 $f_{I,0} = 1 - f_{A,0}$。活性变体的每轮存活概率为 $p_{A} = 0.3$，非活性变体的每轮存活概率为 $p_{I} = 0.01$，且这些概率在所有轮次中保持不变。假设在不同轮次和变体间的存活事件是独立的，没有类别间的相互转换，并且扩增相对于活性是无偏向的。\n\n定义第 $r$ 轮后活性与非活性的比值为 $R_{r} = f_{A,r} / f_{I,r}$，其中 $f_{A,r}$ 和 $f_{I,r}$ 分别是该轮次后活性和非活性变体的频率。定义 $r$ 轮后的富集度为比值相对于初始比值的倍数变化，即 $E_{r} = R_{r} / R_{0}$。\n\n从这些定义和条件概率的基本规则出发，推导 $E_{3}$ 的表达式，并计算当 $p_{A} = 0.3$ 和 $p_{I} = 0.01$ 时的数值。请将最终答案表示为一个无四舍五入且无单位的精确值。", "solution": "首先，将对所述问题进行严格验证，以确保其科学合理、良定且客观。\n\n步骤1：提取已知条件。\n提供的明确数据和定义如下：\n- 两类变体：活性和非活性。\n- 存活是独立的且取决于类别。\n- 筛选后的扩增是无偏向的，并将总群体数量归一化。\n- 活性变体的初始比例：$f_{A,0}$。\n- 非活性变体的初始比例：$f_{I,0} = 1 - f_{A,0}$。\n- 活性变体的每轮存活概率：$p_{A} = 0.3$。\n- 非活性变体的每轮存活概率：$p_{I} = 0.01$。\n- 这些概率在所有轮次中保持不变。\n- 第 $r$ 轮后活性与非活性比值的定义：$R_{r} = f_{A,r} / f_{I,r}$。\n- $r$ 轮后富集度的定义：$E_{r} = R_{r} / R_{0}$。\n任务是推导 $E_{3}$ 的表达式并计算其数值。\n\n步骤2：验证。\n该问题描述了定向进化中筛选过程的一个简化数学模型，这是合成生物学和生物化学中的一项标准技术。该模型基于概率论的基本原理。所有术语都经过了精确的数学定义。给定的概率 $p_{A} = 0.3$ 和 $p_{I} = 0.01$ 对于一个严苛的筛选过程在物理上是合理的。该问题是自洽且逻辑一致的；虽然初始比例 $f_{A,0}$ 未指定，但后续将证明它与富集度 $E_{r}$ 的计算无关。该问题不违反任何科学或逻辑原理。它是良定且客观的。\n\n结论：问题有效。将推导解答。\n\n推导从所提供的定义开始。设 $N$ 为任何一轮归一化后文库中的分子总数。在第 $r-1$ 轮后，活性变体的数量为 $N_{A, r-1} = N \\cdot f_{A, r-1}$，非活性变体的数量为 $N_{I, r-1} = N \\cdot f_{I, r-1}$。\n\n在第 $r$ 轮的筛选步骤中，这些群体将接受筛选。每一类存活分子的期望数量是：\n- 活性变体的期望存活数量：$N_{A, \\text{surv}} = N_{A, r-1} \\cdot p_{A}$\n- 非活性变体的期望存活数量：$N_{I, \\text{surv}} = N_{I, r-1} \\cdot p_{I}$\n\n问题陈述扩增是无偏向的。这意味着在扩增过程中，活性与非活性分子的数量比保持不变。因此，第 $r$ 轮后的频率比完全由存活者的比例决定。第 $r$ 轮后活性变体的频率 $f_{A,r}$ 与 $N_{A, \\text{surv}}$ 成正比，非活性变体的频率 $f_{I,r}$ 与 $N_{I, \\text{surv}}$ 成正比。\n\n第 $r$ 轮后的比值 $R_{r}$ 定义为频率之比：\n$$R_{r} = \\frac{f_{A,r}}{f_{I,r}}$$\n因为频率与各类分子的数量成正比，所以这个比值等同于分子数量之比：\n$$R_{r} = \\frac{N_{A,r}}{N_{I,r}}$$\n第 $r$ 轮扩增后的分子数量 $N_{A,r}$ 和 $N_{I,r}$ 与筛选步骤中存活者的数量成正比。因此，它们的比值为：\n$$R_{r} = \\frac{N_{A,r}}{N_{I,r}} = \\frac{N_{A, \\text{surv}}}{N_{I, \\text{surv}}} = \\frac{N_{A, r-1} \\cdot p_{A}}{N_{I, r-1} \\cdot p_{I}}$$\n我们认识到比率 $N_{A, r-1} / N_{I, r-1}$ 正是上一轮结束后的比值 $R_{r-1}$。这得出了一个关于比值的递推关系：\n$$R_{r} = \\left(\\frac{N_{A, r-1}}{N_{I, r-1}}\\right) \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right) = R_{r-1} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right)$$\n这是一个等比数列。我们可以通过递归应用此关系，用初始比值 $R_{0}$ 来表示 $R_{r}$：\n$$R_{1} = R_{0} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right)$$\n$$R_{2} = R_{1} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right) = \\left(R_{0} \\cdot \\frac{p_{A}}{p_{I}}\\right) \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right) = R_{0} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right)^{2}$$\n通过归纳法，可得 $r$ 轮后的比值为：\n$$R_{r} = R_{0} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right)^{r}$$\n富集度 $E_{r}$ 定义为比值相对于初始比值的倍数变化，即 $E_{r} = R_{r} / R_{0}$。代入 $R_{r}$ 的表达式：\n$$E_{r} = \\frac{R_{0} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right)^{r}}{R_{0}}$$\n初始比值 $R_{0}$ 被消掉了，这证实了初始活性变体比例 $f_{A,0}$ 不是必需的。$r$ 轮后富集度的通用公式是：\n$$E_{r} = \\left(\\frac{p_{A}}{p_{I}}\\right)^{r}$$\n问题要求计算 $r=3$ 轮后的富集度 $E_{3}$。我们代入 $r=3$：\n$$E_{3} = \\left(\\frac{p_{A}}{p_{I}}\\right)^{3}$$\n现在，我们代入给定的存活概率数值 $p_{A} = 0.3$ 和 $p_{I} = 0.01$。\n$$E_{3} = \\left(\\frac{0.3}{0.01}\\right)^{3}$$\n概率之比为：\n$$\\frac{0.3}{0.01} = \\frac{3 \\times 10^{-1}}{1 \\times 10^{-2}} = 3 \\times 10^{1} = 30$$\n将此值代回 $E_{3}$ 的表达式中：\n$$E_{3} = (30)^{3} = 30 \\times 30 \\times 30 = 900 \\times 30 = 27000$$\n3轮后的富集度为 $27000$。这是一个精确值。", "answer": "$$\n\\boxed{27000}\n$$", "id": "2761248"}, {"introduction": "现代定向进化严重依赖于液滴微流控等高通量筛选技术，这些技术允许我们在单个隔室中分析数百万个变体。本练习解决了一个关键的实践问题：如何优化装载密度以最大化包含单个变体的“单克隆”液滴的比例？通过应用泊松分布模型，你将推导出这一随机包封过程中的最佳条件，这是连接理论与尖端实验平台的关键一步。[@problem_id:2761318]", "problem": "在一项基于液滴的定向进化实验中，一个包含 $N$ 个独立变体（例如，展示酶的细胞或微珠）的文库通过随机混合被区室化到 $M$ 个相同大小的液滴中。每个变体独立地进入任何给定液滴的概率为 $1/M$。设 $K$ 表示加载到某个特定液滴中的变体数量。单克隆区室被定义为恰好含有 $1$ 个变体的区室，即 $K=1$。在固定加载密度 $\\lambda = N/M$ 的大文库、多液滴极限下，单个液滴的占有率统计可以很好地用泊松过程来近似，这可以由独立随机封装条件下二项分布的极限来证明。\n\n从独立放置模型出发，并仅使用在 $N$ 和 $M$ 很大且 $\\lambda = N/M$ 固定的情况下有效的基本概率极限，推导单克隆区室的比例 $P(K=1)$ 作为 $\\lambda$ 函数的解析表达式。然后，确定使该比例最大化的 $\\lambda \\ge 0$ 的值。仅报告使 $P(K=1)$ 最大化的 $\\lambda$ 的值作为你的最终答案。以精确数形式提供最优值；无需四舍五入，也无需单位。", "solution": "问题要求推导单克隆区室比例作为加载密度 $\\lambda$ 函数的表达式，然后确定使该比例最大化的 $\\lambda$ 值。推导必须从指定的独立放置模型开始。\n\n设 $N$ 是变体的总数， $M$ 是液滴的总数。一个变体进入特定液滴的过程是一个随机事件。对于任何单个变体，假设所有液滴都是等可能的目的地，其被封装到一个特定液滴中的概率是 $p = 1/M$。\n\n我们考虑一个任意选择的单个液滴。在该液滴中发现的变体数量（用随机变量 $K$ 表示）可以用二项分布来建模。$N$ 个变体中的每一个都代表一次独立的伯努利试验，其中“成功”对应于变体进入指定的液滴。每次试验的成功概率是 $p = 1/M$。因此，$K$ 的概率质量函数（PMF）由二项式公式给出：\n$$P(K=k) = \\binom{N}{k} p^k (1-p)^{N-k}$$\n问题指出我们关心的是 $N$ 和 $M$ 很大，而它们的比率，即平均加载密度 $\\lambda = N/M$，保持为固定常数的极限情况。这正是泊松分布作为二项分布极限出现的条件。我们将对此进行正式证明。\n\n我们代入 $p = 1/M$，并且由于 $M=N/\\lambda$，我们有 $p=\\lambda/N$。二项分布的 PMF 变为：\n$$P(K=k) = \\binom{N}{k} \\left(\\frac{\\lambda}{N}\\right)^k \\left(1-\\frac{\\lambda}{N}\\right)^{N-k}$$\n我们可以展开二项式系数 $\\binom{N}{k} = \\frac{N!}{k!(N-k)!} = \\frac{N(N-1)\\cdots(N-k+1)}{k!}$。于是 PMF 为：\n$$P(K=k) = \\frac{N(N-1)\\cdots(N-k+1)}{k!} \\left(\\frac{\\lambda}{N}\\right)^k \\left(1-\\frac{\\lambda}{N}\\right)^{N-k}$$\n重新整理各项，我们得到：\n$$P(K=k) = \\frac{\\lambda^k}{k!} \\left( \\frac{N(N-1)\\cdots(N-k+1)}{N^k} \\right) \\left(1-\\frac{\\lambda}{N}\\right)^N \\left(1-\\frac{\\lambda}{N}\\right)^{-k}$$\n现在，对于一个固定的整数 $k$，我们计算当 $N \\to \\infty$ 时每一部分的极限：\n1.  $\\lim_{N\\to\\infty} \\frac{N(N-1)\\cdots(N-k+1)}{N^k} = \\lim_{N\\to\\infty} \\left(1 \\cdot \\left(1-\\frac{1}{N}\\right) \\cdots \\left(1-\\frac{k-1}{N}\\right)\\right) = 1$。\n2.  $\\lim_{N\\to\\infty} \\left(1-\\frac{\\lambda}{N}\\right)^N = \\exp(-\\lambda)$，根据指数函数的基本极限定义。\n3.  $\\lim_{N\\to\\infty} \\left(1-\\frac{\\lambda}{N}\\right)^{-k} = (1-0)^{-k} = 1$。\n\n将这些极限相乘，得到泊松分布的 PMF：\n$$\\lim_{N\\to\\infty} P(K=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$$\n因此，单个液滴中的变体数 $K$ 服从均值为 $\\lambda$ 的泊松分布。\n\n单克隆区室被定义为恰好含有一个变体的区室，即 $K=1$。这类区室的比例由 $P(K=1)$ 给出。我们将这个比例定义为 $\\lambda$ 的函数，记作 $f(\\lambda)$：\n$$f(\\lambda) = P(K=1) = \\frac{\\lambda^1 \\exp(-\\lambda)}{1!} = \\lambda \\exp(-\\lambda)$$\n为了找到使这个比例在 $\\lambda \\ge 0$ 上最大化的 $\\lambda$ 值，我们必须使用微积分。我们计算 $f(\\lambda)$ 关于 $\\lambda$ 的一阶导数：\n$$\\frac{df}{d\\lambda} = \\frac{d}{d\\lambda} \\left( \\lambda \\exp(-\\lambda) \\right)$$\n使用乘法法则，我们发现：\n$$\\frac{df}{d\\lambda} = (1)\\exp(-\\lambda) + \\lambda(-\\exp(-\\lambda)) = (1-\\lambda)\\exp(-\\lambda)$$\n为了找到临界点，我们将导数设为零：\n$$(1-\\lambda)\\exp(-\\lambda) = 0$$\n由于对所有实数 $\\lambda$，$\\exp(-\\lambda)$ 都严格为正，所以该方程仅在 $1-\\lambda = 0$ 时成立，这得到临界点 $\\lambda=1$。\n\n为了确认这是一个最大值，我们使用二阶导数检验。我们计算 $f(\\lambda)$ 的二阶导数：\n$$\\frac{d^2f}{d\\lambda^2} = \\frac{d}{d\\lambda} \\left( (1-\\lambda)\\exp(-\\lambda) \\right) = (-1)\\exp(-\\lambda) + (1-\\lambda)(-\\exp(-\\lambda)) = (\\lambda-2)\\exp(-\\lambda)$$\n在临界点 $\\lambda=1$ 处计算二阶导数：\n$$\\left.\\frac{d^2f}{d\\lambda^2}\\right|_{\\lambda=1} = (1-2)\\exp(-1) = -\\exp(-1) = -\\frac{1}{e}$$\n因为二阶导数为负 ($-\\frac{1}{e}  0$)，所以函数 $f(\\lambda)$ 在 $\\lambda=1$ 处有一个局部最大值。\n\n最后，我们必须检查定义域 $\\lambda \\ge 0$ 的边界。在 $\\lambda=0$ 处，$f(0) = 0 \\cdot \\exp(0) = 0$。在极限 $\\lambda \\to \\infty$ 时，$f(\\lambda) = \\lambda \\exp(-\\lambda) \\to 0$。临界点处的值为 $f(1) = 1 \\cdot \\exp(-1) = 1/e  0$。由于函数在下边界处为零，在无穷远处趋于零，并且在两者之间为正，因此 $\\lambda=1$ 处的局部最大值是定义域 $\\lambda \\ge 0$ 上的全局最大值。\n\n因此，使单克隆区室比例最大化的加载密度是 $\\lambda=1$。", "answer": "$$\\boxed{1}$$", "id": "2761318"}]}