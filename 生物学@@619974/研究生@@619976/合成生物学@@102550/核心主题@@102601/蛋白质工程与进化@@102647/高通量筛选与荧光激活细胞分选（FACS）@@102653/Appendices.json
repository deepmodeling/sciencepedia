{"hands_on_practices": [{"introduction": "在设计高通量筛选实验时，构建一个高质量的基因文库是成功的基石。为了建立明确的基因型-表型关联，至关重要的是确保大多数细胞只携带一个基因变体。这项练习将引导你使用泊松分布这一强大的概率工具来对慢病毒感染过程进行建模和优化，这是实验设计中一个至关重要的理论步骤。[@problem_id:2743973]", "problem": "一项汇集的合成生物学筛选通过慢病毒递送一个大型的遗传构建体文库到哺乳动物细胞群体中，随后进行荧光激活细胞分选 (FACS) 来执行。假设一个标准的感染模型，其中每个细胞中的整合事件是独立的，并且每个细胞的成功整合数（用随机变量 $K$ 表示）遵循泊松分布，其平均感染复数 (MOI) 为 $\\lambda$。为了在下游的 FACS 分析中保持基因型到表型映射的可解释性，你希望最大化携带恰好一个构建体的细胞的比例。\n\n从泊松分布的定义和基础微分学出发，完成以下任务：\n\n1) 推导出一个表达式 $f_{1}(\\lambda)$，表示携带恰好一个整合事件的细胞的预期分数，该表达式是关于 $\\lambda$ 的函数。\n\n2) 确定在 $\\lambda \\ge 0$ 范围内使 $f_{1}(\\lambda)$ 最大化的值 $\\lambda^{\\star}$，并计算相应的最大分数 $f_{1}(\\lambda^{\\star})$。\n\n以行矩阵 $\\bigl(\\lambda^{\\star}, f_{1}(\\lambda^{\\star})\\bigr)$ 的形式报告你的最终答案，使用精确形式。答案是无量纲的，无需四舍五入。", "solution": "首先必须验证问题陈述的科学和数学完整性。\n\n第1步：提取已知信息。\n问题提供了以下信息：\n- 背景是使用慢病毒递送和荧光激活细胞分选 (FACS) 的汇集式合成生物学筛选。\n- 每个细胞的成功整合数 $K$ 是一个随机变量。\n- $K$ 的分布是泊松分布，其平均感染复数 (MOI) 为 $\\lambda$。\n- 感染模型假设每个细胞中的整合事件是独立的。\n- 目标是最大化携带恰好一个构建体的细胞的分数。\n- 任务1要求推导函数 $f_{1}(\\lambda)$，它是携带恰好一个整合事件的细胞的预期分数，作为 $\\lambda$ 的函数。\n- 任务2要求找到在 $\\lambda \\ge 0$ 条件下使 $f_{1}(\\lambda)$ 最大化的值 $\\lambda^{\\star}$，以及相应的最大值 $f_{1}(\\lambda^{\\star})$。\n\n第2步：使用提取的已知信息进行验证。\n- **科学基础**：该问题具有科学依据。在分子生物学和病毒学中，使用泊松分布来模拟在给定 MOI 下每个细胞的慢病毒整合数是一个标准的、经过经验验证的模型。在设计遗传筛选时，最大化单整合体群体是一个关键且实际的考虑因素，以确保基因型（整合的构建体）和表型（测量的信号，例如荧光）之间存在明确的联系。\n- **适定性**：该问题是适定的。它要求对一个从标准概率分布推导出的定义明确的函数进行优化。约束条件是明确的（$\\lambda \\ge 0$），并且预期可以通过标准的微积分技术得到唯一解。\n- **客观性**：该问题陈述客观，使用了概率论和分子生物学的精确术语。\n\n第3步：结论和行动。\n该问题被认为是有效的，因为它是科学合理的、适定的和客观的。没有矛盾、模糊或事实不准确之处。可以构建一个严谨的解决方案。\n\n进入解答过程。\n\n问题陈述，每个细胞的整合事件数 $K$ 遵循平均值为 $\\lambda$ 的泊松分布。一个服从泊松分布的随机变量 $K$ 的概率质量函数 (PMF) 由下式给出：\n$$ P(K=k) = \\frac{\\lambda^{k} \\exp(-\\lambda)}{k!} $$\n其中 $k$ 是一个非负整数（$k=0, 1, 2, \\dots$），代表事件发生的次数，而 $\\lambda$ 是事件的平均发生率，在此背景下即为 MOI。\n\n第1部分：推导 $f_{1}(\\lambda)$ 的表达式。\n函数 $f_{1}(\\lambda)$ 代表携带恰好一个整合事件的细胞的预期分数。这对应于随机变量 $K$ 取值为 $1$ 的概率。我们可以通过将 $k=1$ 代入泊松 PMF 来找到这个概率：\n$$ f_{1}(\\lambda) = P(K=1) = \\frac{\\lambda^{1} \\exp(-\\lambda)}{1!} $$\n由于 $1! = 1$，该表达式简化为：\n$$ f_{1}(\\lambda) = \\lambda \\exp(-\\lambda) $$\n这就是作为 MOI $\\lambda$ 的函数的、具有单个整合事件的细胞分数的所求表达式。\n\n第2部分：确定 $\\lambda^{\\star}$ 和最大分数 $f_{1}(\\lambda^{\\star})$。\n为了找到在 $\\lambda \\ge 0$ 条件下使 $f_{1}(\\lambda)$ 最大化的 $\\lambda$ 值，我们必须使用微分学。我们需要通过求 $f_{1}(\\lambda)$ 关于 $\\lambda$ 的导数并将其设为零来找到其临界点。\n\n需要最大化的函数是 $f_{1}(\\lambda) = \\lambda \\exp(-\\lambda)$。\n使用乘法法则求导，$\\frac{d}{d\\lambda}(uv) = u\\frac{dv}{d\\lambda} + v\\frac{du}{d\\lambda}$，其中 $u=\\lambda$ 且 $v=\\exp(-\\lambda)$：\n$$ \\frac{d f_{1}}{d\\lambda} = \\frac{d}{d\\lambda} \\left( \\lambda \\exp(-\\lambda) \\right) = (1) \\cdot \\exp(-\\lambda) + \\lambda \\cdot (-\\exp(-\\lambda)) $$\n$$ \\frac{d f_{1}}{d\\lambda} = \\exp(-\\lambda) - \\lambda \\exp(-\\lambda) = (1-\\lambda)\\exp(-\\lambda) $$\n为了找到临界点，我们将导数设为零：\n$$ (1-\\lambda)\\exp(-\\lambda) = 0 $$\n对于所有实数值的 $\\lambda$，$\\exp(-\\lambda)$ 项都严格为正。因此，只有当 $(1-\\lambda)$ 项为零时，方程才成立：\n$$ 1 - \\lambda = 0 \\implies \\lambda = 1 $$\n这给出了在 $\\lambda = 1$ 处的一个临界点。\n\n为了确认该点对应于一个最大值，我们应用二阶导数检验。我们将 $\\frac{d f_{1}}{d\\lambda}$ 关于 $\\lambda$ 求导：\n$$ \\frac{d^{2} f_{1}}{d\\lambda^{2}} = \\frac{d}{d\\lambda} \\left( (1-\\lambda)\\exp(-\\lambda) \\right) = (-1) \\cdot \\exp(-\\lambda) + (1-\\lambda) \\cdot (-\\exp(-\\lambda)) $$\n$$ \\frac{d^{2} f_{1}}{d\\lambda^{2}} = -\\exp(-\\lambda) - \\exp(-\\lambda) + \\lambda \\exp(-\\lambda) = (\\lambda-2)\\exp(-\\lambda) $$\n现在，我们计算在临界点 $\\lambda=1$ 处的二阶导数值：\n$$ \\left. \\frac{d^{2} f_{1}}{d\\lambda^{2}} \\right|_{\\lambda=1} = (1-2)\\exp(-1) = -1 \\cdot \\exp(-1) = -\\exp(-1) $$\n由于 $\\exp(-1)$ 是一个正常数，所以在 $\\lambda=1$ 处的二阶导数为负。这证实了 $f_{1}(\\lambda)$ 在 $\\lambda=1$ 处有一个局部最大值。\n\n该函数的定义域是 $\\lambda \\ge 0$。我们必须检查边界处的行为。在 $\\lambda=0$ 处，$f_{1}(0) = 0 \\cdot \\exp(0) = 0$。当 $\\lambda \\to \\infty$ 时，$f_{1}(\\lambda) = \\lambda \\exp(-\\lambda) \\to 0$（因为指数衰减主导了线性增长）。由于函数在边界处和无穷远处的极限均为零，并且只有一个作为局部最大值的临界点，因此这个局部最大值必定是定义域 $\\lambda \\ge 0$ 上的全局最大值。\n因此，最佳 MOI 为 $\\lambda^{\\star} = 1$。\n\n最后，我们将 $\\lambda^{\\star}=1$ 代入 $f_{1}(\\lambda)$ 的表达式中，计算相应的单整合体细胞的最大分数：\n$$ f_{1}(\\lambda^{\\star}) = f_{1}(1) = 1 \\cdot \\exp(-1) = \\exp(-1) $$\n这意味着在 MOI 为 1 时，含有恰好一个遗传构建体的细胞分数达到最大值，这个最大分数为 $\\exp(-1)$，约等于 $0.368$。\n\n最终答案由数对 $(\\lambda^{\\star}, f_{1}(\\lambda^{\\star}))$ 组成。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & \\exp(-1)\n\\end{pmatrix}\n}\n$$", "id": "2743973"}, {"introduction": "从实验准备阶段过渡到数据采集，我们必须面对仪器本身带来的复杂性。多色流式细胞术虽然功能强大，但容易产生荧光信号的串扰，即“溢出效应”。这项练习将演示如何运用线性代数模型来理解、诊断和校正补偿误差，从而保证我们采集到的数据的准确性和可靠性。[@problem_id:2743961]", "problem": "一个合成生物学团队正在通过荧光激活细胞分选 (FACS) 进行高通量筛选，以富集一个共表达两种荧光报告基因（表示为通道 $\\mathrm{A}$ 和通道 $\\mathrm{B}$）的遗传回路。由于光学溢出，测得的荧光向量 $\\mathbf{y} \\in \\mathbb{R}^{2}$ 是真实潜在荧光团发射 $\\mathbf{x} \\in \\mathbb{R}^{2}$ 根据一个溢出矩阵 $\\mathbf{M}$ 的线性混合，因此 $\\mathbf{y} = \\mathbf{M}\\mathbf{x}$，其中\n$$\n\\mathbf{M} = \\begin{pmatrix}\n1 & s_{12} \\\\\ns_{21} & 1\n\\end{pmatrix},\n$$\n$s_{12}$ 是通道 $\\mathrm{B}$ 溢出到检测器 $\\mathrm{A}$ 的比例，$s_{21}$ 是通道 $\\mathrm{A}$ 溢出到检测器 $\\mathrm{B}$ 的比例。补偿操作是基于一个带有元素 $\\hat{s}_{12}$ 和 $\\hat{s}_{21}$ 的估计溢出矩阵 $\\hat{\\mathbf{M}}$，应用其估计的逆矩阵 $\\hat{\\mathbf{M}}^{-1}$。该团队在检查二元图后怀疑存在补偿错误。\n\n仅从线性混合模型、矩阵求逆的定义和线性变换出发，完成以下任务：\n\n1) 当将 $\\hat{\\mathbf{M}}^{-1}$ 应用于仅存在通道 $\\mathrm{A}$ 的单染对照（即 $\\mathbf{x} = (A, 0)^{\\top}$，其中 $A \\ge 0$）时，推导补偿后二元图斜率 $m_{\\mathrm{A}\\text{-only}}$ 的解析表达式。请用 $s_{21}$、$\\hat{s}_{21}$ 和 $\\hat{s}_{12}$ 表示 $m_{\\mathrm{A}\\text{-only}}$。\n\n2) 使用您的表达式，从数学上解释 $m_{\\mathrm{A}\\text{-only}}$ 的符号如何揭示对 $s_{21}$ 的欠补偿与过补偿，并使用仅 $\\mathrm{B}$ 通道对照为 $s_{12}$ 陈述对称的标准。\n\n3) 在双染实验样本中，提供以方程或不等式形式写出的诊断标准，用以区分补偿错误与真实的生物共表达。您的标准必须依赖于单染对照，并能从推导的表达式中得到证明。\n\n4) 在一次特定实验中，真实溢出值为 $s_{12} = 0.18$ 和 $s_{21} = 0.09$。补偿中使用了一个估计值 $\\hat{s}_{12} = 0.20$ 和一个未知的 $\\hat{s}_{21}$。在仅 A 通道对照中，观测到的补偿后二元图斜率为 $m_{\\mathrm{A}\\text{-only}} = -0.05$（测量为沿对照轨迹的补偿后 $\\mathrm{B}$ 坐标与补偿后 $\\mathrm{A}$ 坐标之比）。计算此观测所隐含的 $\\hat{s}_{21}$ 的数值。以无单位小数形式报告您的答案，并四舍五入到四位有效数字。", "solution": "该问题要求对荧光溢出及其补偿的线性模型进行严谨的数学分析。我们将从第一性原理出发。\n\n线性混合模型由 $\\mathbf{y} = \\mathbf{M}\\mathbf{x}$ 给出，其中 $\\mathbf{x} = \\begin{pmatrix} x_A \\\\ x_B \\end{pmatrix}$ 是真实荧光团发射向量，$\\mathbf{y} = \\begin{pmatrix} y_A \\\\ y_B \\end{pmatrix}$ 是测量到的荧光向量，而 $\\mathbf{M}$ 是真实的溢出矩阵。补偿是通过将一个估计的溢出矩阵的逆矩阵 $\\hat{\\mathbf{M}}^{-1}$ 应用于测量数据 $\\mathbf{y}$ 来执行的，从而获得一个补偿后的信号 $\\mathbf{z} = \\hat{\\mathbf{M}}^{-1}\\mathbf{y}$。\n\n真实和估计的溢出矩阵为：\n$$\n\\mathbf{M} = \\begin{pmatrix}\n1 & s_{12} \\\\\ns_{21} & 1\n\\end{pmatrix}, \\quad\n\\hat{\\mathbf{M}} = \\begin{pmatrix}\n1 & \\hat{s}_{12} \\\\\n\\hat{s}_{21} & 1\n\\end{pmatrix}\n$$\n需要估计矩阵 $\\hat{\\mathbf{M}}$ 的逆矩阵。对于一个一般的 $2 \\times 2$ 矩阵 $\\mathbf{A} = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$，其逆矩阵是 $\\mathbf{A}^{-1} = \\frac{1}{ad-bc} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$。将此应用于 $\\hat{\\mathbf{M}}$：\n$$\n\\hat{\\mathbf{M}}^{-1} = \\frac{1}{1 - \\hat{s}_{12}\\hat{s}_{21}} \\begin{pmatrix}\n1 & -\\hat{s}_{12} \\\\\n-\\hat{s}_{21} & 1\n\\end{pmatrix}\n$$\n只要行列式 $\\det(\\hat{\\mathbf{M}}) = 1 - \\hat{s}_{12}\\hat{s}_{21} \\neq 0$，这个逆矩阵就是良定义的。在任何真实的物理系统中，溢出系数 $s_{ij}$ 都是小于1的正分数，这保证了矩阵的非奇异性。\n\n**1) A-only 对照斜率的推导**\n\n对于仅存在通道 $\\mathrm{A}$ 的单染对照，真实发射向量为 $\\mathbf{x} = \\begin{pmatrix} A \\\\ 0 \\end{pmatrix}$，其中荧光强度 $A > 0$。\n测得的信号是：\n$$\n\\mathbf{y} = \\mathbf{M}\\mathbf{x} = \\begin{pmatrix} 1 & s_{12} \\\\ s_{21} & 1 \\end{pmatrix} \\begin{pmatrix} A \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} A \\\\ s_{21}A \\end{pmatrix}\n$$\n补偿后的信号 $\\mathbf{z} = \\begin{pmatrix} z_A \\\\ z_B \\end{pmatrix}$ 通过应用补偿矩阵 $\\hat{\\mathbf{M}}^{-1}$ 获得：\n$$\n\\mathbf{z} = \\hat{\\mathbf{M}}^{-1}\\mathbf{y} = \\frac{1}{1 - \\hat{s}_{12}\\hat{s}_{21}} \\begin{pmatrix} 1 & -\\hat{s}_{12} \\\\ -\\hat{s}_{21} & 1 \\end{pmatrix} \\begin{pmatrix} A \\\\ s_{21}A \\end{pmatrix}\n$$\n补偿后向量 $\\mathbf{z}$ 的分量是：\n$$\nz_A = \\frac{1}{1 - \\hat{s}_{12}\\hat{s}_{21}} (A - \\hat{s}_{12}s_{21}A) = \\frac{A(1 - \\hat{s}_{12}s_{21})}{1 - \\hat{s}_{12}\\hat{s}_{21}}\n$$\n$$\nz_B = \\frac{1}{1 - \\hat{s}_{12}\\hat{s}_{21}} (-\\hat{s}_{21}A + s_{21}A) = \\frac{A(s_{21} - \\hat{s}_{21})}{1 - \\hat{s}_{12}\\hat{s}_{21}}\n$$\n补偿后二元图的斜率 $m_{\\mathrm{A}\\text{-only}}$ 是补偿后的 $\\mathrm{B}$ 坐标与补偿后的 $\\mathrm{A}$ 坐标之比，即 $m_{\\mathrm{A}\\text{-only}} = z_B / z_A$。\n$$\nm_{\\mathrm{A}\\text{-only}} = \\frac{\\frac{A(s_{21} - \\hat{s}_{21})}{1 - \\hat{s}_{12}\\hat{s}_{21}}}{\\frac{A(1 - \\hat{s}_{12}s_{21})}{1 - \\hat{s}_{12}\\hat{s}_{21}}} = \\frac{s_{21} - \\hat{s}_{21}}{1 - \\hat{s}_{12}s_{21}}\n$$\n这个表达式给出了用真实溢出 $s_{21}$ 和估计溢出 $\\hat{s}_{21}$、$\\hat{s}_{12}$ 表示的斜率，符合要求。\n\n**2) 补偿错误的解释和对称标准**\n\n$m_{\\mathrm{A}\\text{-only}}$ 表达式的分母 $1 - \\hat{s}_{12}s_{21}$ 对于所有物理上合理的溢出值（$0 \\le s_{ij} < 1$，$0 \\le \\hat{s}_{ij} < 1$）都是正的。因此，$m_{\\mathrm{A}\\text{-only}}$ 的符号由其分子 $s_{21} - \\hat{s}_{21}$ 的符号决定。\n\n- **$s_{21}$ 的欠补偿**：如果估计的溢出小于真实的溢出，即 $\\hat{s}_{21} < s_{21}$，那么 $s_{21} - \\hat{s}_{21} > 0$。这会导致一个正斜率，$m_{\\mathrm{A}\\text{-only}} > 0$。\n- **$s_{21}$ 的过补偿**：如果估计的溢出大于真实的溢出，即 $\\hat{s}_{21} > s_{21}$，那么 $s_{21} - \\hat{s}_{21} < 0$。这会导致一个负斜率，$m_{\\mathrm{A}\\text{-only}} < 0$。\n- **$s_{21}$ 的完美补偿**：如果 $\\hat{s}_{21} = s_{21}$，斜率为 $m_{\\mathrm{A}\\text{-only}} = 0$。A-only 对照的补偿后数据位于水平轴上（$z_B = 0$）。\n\n对于 $s_{12}$ 的对称标准，我们考虑一个 B-only 对照，$\\mathbf{x} = \\begin{pmatrix} 0 \\\\ B \\end{pmatrix}$，其中 $B > 0$。测得的信号是 $\\mathbf{y} = \\begin{pmatrix} s_{12}B \\\\ B \\end{pmatrix}$。应用补偿：\n$$\n\\mathbf{z} = \\hat{\\mathbf{M}}^{-1}\\mathbf{y} = \\frac{1}{1-\\hat{s}_{12}\\hat{s}_{21}} \\begin{pmatrix} 1 & -\\hat{s}_{12} \\\\ -\\hat{s}_{21} & 1 \\end{pmatrix} \\begin{pmatrix} s_{12}B \\\\ B \\end{pmatrix} = \\frac{B}{1-\\hat{s}_{12}\\hat{s}_{21}} \\begin{pmatrix} s_{12} - \\hat{s}_{12} \\\\ 1 - \\hat{s}_{21}s_{12} \\end{pmatrix}\n$$\n对此对照进行完美补偿将得到位于垂直轴上的数据（$z_A = 0$）。斜率 $m = z_B / z_A$ 将趋近于无穷大。分析倒数斜率 $m'_{\\mathrm{B}\\text{-only}} = z_A / z_B$ 更为稳健：\n$$\nm'_{\\mathrm{B}\\text{-only}} = \\frac{z_A}{z_B} = \\frac{s_{12} - \\hat{s}_{12}}{1 - \\hat{s}_{21}s_{12}}\n$$\n分母 $1 - \\hat{s}_{21}s_{12}$ 是正的。$m'_{\\mathrm{B}\\text{-only}}$ 的符号由 $s_{12} - \\hat{s}_{12}$ 决定。\n- **$s_{12}$ 的欠补偿**：$\\hat{s}_{12} < s_{12} \\implies m'_{\\mathrm{B}\\text{-only}} > 0$。\n- **$s_{12}$ 的过补偿**：$\\hat{s}_{12} > s_{12} \\implies m'_{\\mathrm{B}\\text{-only}} < 0$。\n- **$s_{12}$ 的完美补偿**：$\\hat{s}_{12} = s_{12} \\implies m'_{\\mathrm{B}\\text{-only}} = 0$。\n\n**3) 共表达与补偿错误的诊断标准**\n\n真实表达 $\\mathbf{x}$ 与补偿后信号 $\\mathbf{z}$ 之间的关系由线性变换 $\\mathbf{z} = (\\hat{\\mathbf{M}}^{-1}\\mathbf{M})\\mathbf{x}$ 给出。根据线性性质，一个双阳性细胞 $\\mathbf{x} = \\begin{pmatrix} A \\\\ B \\end{pmatrix}$ 的补偿后向量是其组成部分 $\\begin{pmatrix} A \\\\ 0 \\end{pmatrix}$ 和 $\\begin{pmatrix} 0 \\\\ B \\end{pmatrix}$ 的补偿信号之和。\n令 $\\mathbf{z}_{\\mathrm{A}}(A)$ 为 $\\mathbf{x}=\\begin{pmatrix}A \\\\ 0\\end{pmatrix}$ 的补偿信号，$\\mathbf{z}_{\\mathrm{B}}(B)$ 为 $\\mathbf{x}=\\begin{pmatrix}0 \\\\ B\\end{pmatrix}$ 的补偿信号。\n那么 $\\mathbf{z} = \\mathbf{z}_{\\mathrm{A}}(A) + \\mathbf{z}_{\\mathrm{B}}(B)$。\n从单染对照中，我们有以下关系：\n$(\\mathbf{z}_{\\mathrm{A}})_B = m_{\\mathrm{A}\\text{-only}} (\\mathbf{z}_{\\mathrm{A}})_A$\n$(\\mathbf{z}_{\\mathrm{B}})_A = m'_{\\mathrm{B}\\text{-only}} (\\mathbf{z}_{\\mathrm{B}})_B$\n总补偿信号为 $\\begin{pmatrix} z_A \\\\ z_B \\end{pmatrix} = \\begin{pmatrix} (\\mathbf{z}_{\\mathrm{A}})_A + (\\mathbf{z}_{\\mathrm{B}})_A \\\\ (\\mathbf{z}_{\\mathrm{A}})_B + (\\mathbf{z}_{\\mathrm{B}})_B \\end{pmatrix} = \\begin{pmatrix} (\\mathbf{z}_{\\mathrm{A}})_A + m'_{\\mathrm{B}\\text{-only}} (\\mathbf{z}_{\\mathrm{B}})_B \\\\ m_{\\mathrm{A}\\text{-only}} (\\mathbf{z}_{\\mathrm{A}})_A + (\\mathbf{z}_{\\mathrm{B}})_B \\end{pmatrix}$。\n量 $(\\mathbf{z}_{\\mathrm{A}})_A$ 和 $(\\mathbf{z}_{\\mathrm{B}})_B$ 是补偿信号的“解混”分量。它们分别与真实的荧光水平 $A$ 和 $B$ 成正比。我们可以求解这些量：\n$$\n(\\mathbf{z}_{\\mathrm{A}})_A = \\frac{z_A - m'_{\\mathrm{B}\\text{-only}} z_B}{1 - m_{\\mathrm{A}\\text{-only}}m'_{\\mathrm{B}\\text{-only}}}\n$$\n$$\n(\\mathbf{z}_{\\mathrm{B}})_B = \\frac{z_B - m_{\\mathrm{A}\\text{-only}} z_A}{1 - m_{\\mathrm{A}\\text{-only}}m'_{\\mathrm{B}\\text{-only}}}\n$$\n这些解混分量的比率，我们称之为 $K_{bio}$，与真实的生物共表达比率 $B/A$ 成正比。\n$$\nK_{bio} = \\frac{(\\mathbf{z}_{\\mathrm{B}})_B}{(\\mathbf{z}_{\\mathrm{A}})_A} = \\frac{z_B - m_{\\mathrm{A}\\text{-only}} z_A}{z_A - m'_{\\mathrm{B}\\text{-only}} z_B}\n$$\n这导出了以下诊断标准：\n1.  **存在补偿错误**：如果从单染对照中测得的斜率不为零，即 $m_{\\mathrm{A}\\text{-only}} \\neq 0$ 或 $m'_{\\mathrm{B}\\text{-only}} \\neq 0$，则存在补偿错误。\n2.  **真实生物共表达的证据**：对于出现在双阳性象限 $(z_A > 0, z_B > 0)$ 的给定细胞群体，必须使用从单染对照中导出的斜率为每个细胞计算 $K_{bio}$。如果该群体代表了来自单个遗传构件的真实生物共表达，则 $K_{bio}$ 的值应为正且在整个群体中近似恒定。$K_{bio} > 0$ 表明，在校正已知的补偿伪影后，荧光团之间仍然存在正相关性。\n3.  **作为伪影的表观相关性**：如果一个群体在 $(z_A, z_B)$ 平面上看起来相关，但其 $K_{bio} \\approx 0$，则这是一个由补偿错误的 A-only 群体倾斜进入正象限所引起的伪影（即，其 B 分量完全由伪影斜率 $m_{\\mathrm{A}\\text{-only}}$ 解释）。反之，如果 $1/K_{bio} \\approx 0$，则这是由补偿错误的 B-only 群体引起的伪影。\n\n**4) $\\hat{s}_{21}$的计算**\n\n我们已知以下数值：$s_{12} = 0.18$，$s_{21} = 0.09$，$\\hat{s}_{12} = 0.20$ 以及 $m_{\\mathrm{A}\\text{-only}} = -0.05$。\n我们使用第1部分推导的表达式：\n$$\nm_{\\mathrm{A}\\text{-only}} = \\frac{s_{21} - \\hat{s}_{21}}{1 - \\hat{s}_{12}s_{21}}\n$$\n代入已知值：\n$$\n-0.05 = \\frac{0.09 - \\hat{s}_{21}}{1 - (0.20)(0.09)}\n$$\n$$\n-0.05 = \\frac{0.09 - \\hat{s}_{21}}{1 - 0.018}\n$$\n$$\n-0.05 = \\frac{0.09 - \\hat{s}_{21}}{0.982}\n$$\n现在，我们求解 $\\hat{s}_{21}$：\n$$\n-0.05 \\times 0.982 = 0.09 - \\hat{s}_{21}\n$$\n$$\n-0.0491 = 0.09 - \\hat{s}_{21}\n$$\n$$\n\\hat{s}_{21} = 0.09 + 0.0491\n$$\n$$\n\\hat{s}_{21} = 0.1391\n$$\n$m_{\\mathrm{A}\\text{-only}} < 0$ 的观测结果表明存在过补偿，这与我们的结果，即估计值 $\\hat{s}_{21} = 0.1391$ 大于真实值 $s_{21} = 0.09$，是一致的。$\\hat{s}_{21}$ 的数值，四舍五入到四位有效数字，是 $0.1391$。", "answer": "$$\\boxed{0.1391}$$", "id": "2743961"}, {"introduction": "筛选实验的最终目标是从庞大的文库中富集出具有期望功能的变体。在获得排序后群体的测序数据后，下一个关键任务便是量化富集效果。这项练习将带你处理这一核心分析任务：不仅要从测序读数中计算富集因子 $E = p_{\\mathrm{post}}/p_{\\mathrm{pre}}$，更重要的是评估该测量值的统计置信度，从而完成从原始数据到可靠生物学结论的跨越。[@problem_id:2743984]", "problem": "在一个对诱变蛋白库进行的荧光激活细胞分选术 (FACS) 筛选实验中，通过深度测序来量化一个特定变体在分选前 (pre-sort) 和收集FACS阳性门控的细胞后 (post-sort) 的频率。\n\n假设测序读数是相应细胞群体的无偏随机样本，并且总体足够大，因此抽样可以被建模为独立的二项式抽样。\n\n您观察到目标变体的以下计数：\n- 分选前测序：总读数 $n_{\\mathrm{pre}} = 500{,}000$，其中变体读数为 $x_{\\mathrm{pre}} = 50$。\n- 分选后测序：总读数 $n_{\\mathrm{post}} = 200{,}000$，其中变体读数为 $x_{\\mathrm{post}} = 400$。\n\n将 $X_{\\mathrm{pre}} \\sim \\mathrm{Binomial}(n_{\\mathrm{pre}}, p_{\\mathrm{pre}})$ 和 $X_{\\mathrm{post}} \\sim \\mathrm{Binomial}(n_{\\mathrm{post}}, p_{\\mathrm{post}})$，其中 $p_{\\mathrm{pre}}$ 和 $p_{\\mathrm{post}}$ 分别是该变体在分选前和分选后群体中的真实频率。定义富集因子为 $E = p_{\\mathrm{post}}/p_{\\mathrm{pre}}$。\n\n仅从二项模型、二项分布比例最大似然估计量的大样本正态近似以及用于平滑变换的delta方法出发，推导出富集因子 $E$ 的一个置信水平为 $0.95$ 的近似双侧置信区间。使用方差稳定变换或另一个从第一性原理证明其合理性的平滑变换，并证明您所引用的任何独立性假设的合理性。\n\n然后计算：\n1. 使用观测数据计算点估计值 $\\hat{E}$。\n2. 通过您的推导获得的 $E$ 的 $0.95$ 置信区间的端点。\n\n将您的最终数值结果以行矩阵 $\\begin{pmatrix}\\hat{E} & \\text{lower} & \\text{upper}\\end{pmatrix}$ 的形式报告，其中每个条目都表示为小数并四舍五入到三位有效数字。富集因子是无量纲的；不包含任何单位。不要报告百分比。", "solution": "所述问题具有科学依据、适定、客观，并包含足够的信息以得到唯一且有意义的解。它描述了合成生物学中的一个标准生物统计分析。所有必需的数据均已提供，任务是使用指定的统计方法为一个明确定义的参数推导和计算置信区间。因此，该问题是有效的。\n\n目标是计算富集因子 $E = p_{\\mathrm{post}}/p_{\\mathrm{pre}}$ 的点估计值和一个 $0.95$ 置信区间。数据是来自两个独立二项实验的计数：\n$X_{\\mathrm{pre}} \\sim \\mathrm{Binomial}(n_{\\mathrm{pre}}, p_{\\mathrm{pre}})$，观测值为 $x_{\\mathrm{pre}} = 50$，总读数为 $n_{\\mathrm{pre}} = 500{,}000$。\n$X_{\\mathrm{post}} \\sim \\mathrm{Binomial}(n_{\\mathrm{post}}, p_{\\mathrm{post}})$，观测值为 $x_{\\mathrm{post}} = 400$，总读数为 $n_{\\mathrm{post}} = 200{,}000$。\n\n真实总体比例 $p_{\\mathrm{pre}}$ 和 $p_{\\mathrm{post}}$ 的最大似然估计量 (MLE) 是样本比例：\n$$ \\hat{p}_{\\mathrm{pre}} = \\frac{x_{\\mathrm{pre}}}{n_{\\mathrm{pre}}} = \\frac{50}{500{,}000} = 10^{-4} $$\n$$ \\hat{p}_{\\mathrm{post}} = \\frac{x_{\\mathrm{post}}}{n_{\\mathrm{post}}} = \\frac{400}{200{,}000} = \\frac{2}{1000} = 2 \\times 10^{-3} $$\n由此，富集因子 $E$ 的点估计值是估计比例的比值：\n$$ \\hat{E} = \\frac{\\hat{p}_{\\mathrm{post}}}{\\hat{p}_{\\mathrm{pre}}} = \\frac{2 \\times 10^{-3}}{10^{-4}} = 20 $$\n\n为了构建 $E$ 的置信区间，我们首先考虑它的对数，$\\theta = \\ln(E) = \\ln(p_{\\mathrm{post}}) - \\ln(p_{\\mathrm{pre}})$。这种变换是有利的，因为估计量 $\\hat{\\theta} = \\ln(\\hat{E})$ 的分布比 $\\hat{E}$ 的分布更对称、更接近正态分布，尤其是在处理比率时。它还有助于稳定方差。$\\theta$ 的估计量是 $\\hat{\\theta} = \\ln(\\hat{p}_{\\mathrm{post}}) - \\ln(\\hat{p}_{\\mathrm{pre}})$。\n\n根据二项比例的大样本正态近似，估计量 $\\hat{p}$ 近似服从正态分布：\n$$ \\hat{p} \\approx \\mathcal{N}\\left(p, \\frac{p(1-p)}{n}\\right) $$\n我们使用delta方法来求 $\\ln(\\hat{p})$ 的近似方差。设 $f(p) = \\ln(p)$，其导数为 $f'(p) = 1/p$。变换后估计量的方差是：\n$$ \\mathrm{Var}(\\ln(\\hat{p})) \\approx [f'(p)]^2 \\mathrm{Var}(\\hat{p}) = \\left(\\frac{1}{p}\\right)^2 \\frac{p(1-p)}{n} = \\frac{1-p}{np} $$\n通过将MLE $\\hat{p}$ 代替 $p$ 来估计方差：\n$$ \\widehat{\\mathrm{Var}}(\\ln(\\hat{p})) = \\frac{1-\\hat{p}}{n\\hat{p}} = \\frac{1-x/n}{n(x/n)} = \\frac{n-x}{nx} $$\n在此问题中，观测比例 $\\hat{p}_{\\mathrm{pre}} = 10^{-4}$ 和 $\\hat{p}_{\\mathrm{post}} = 2 \\times 10^{-3}$ 都非常小。因此，$(1-\\hat{p}_{\\mathrm{pre}})$ 和 $(1-\\hat{p}_{\\mathrm{post}})$ 两项都非常接近 $1$。因此，我们可以做出一个合理的近似，即 $1-p \\approx 1$。这简化了估计方差：\n$$ \\widehat{\\mathrm{Var}}(\\ln(\\hat{p})) \\approx \\frac{1}{n\\hat{p}} = \\frac{1}{x} $$\n对于低频计数数据（如测序实验中的常见情况），这种近似是标准且稳健的。\n\n分选前和分选后测序是独立的实验。因此，随机变量 $\\hat{p}_{\\mathrm{pre}}$ 和 $\\hat{p}_{\\mathrm{post}}$ 是独立的。从而，它们的变换 $\\ln(\\hat{p}_{\\mathrm{pre}})$ 和 $\\ln(\\hat{p}_{\\mathrm{post}})$ 也是独立的。差值 $\\hat{\\theta} = \\ln(\\hat{p}_{\\mathrm{post}}) - \\ln(\\hat{p}_{\\mathrm{pre}})$ 的方差是各个方差之和：\n$$ \\widehat{\\mathrm{Var}}(\\hat{\\theta}) = \\widehat{\\mathrm{Var}}(\\ln(\\hat{p}_{\\mathrm{post}})) + \\widehat{\\mathrm{Var}}(\\ln(\\hat{p}_{\\mathrm{pre}})) \\approx \\frac{1}{x_{\\mathrm{post}}} + \\frac{1}{x_{\\mathrm{pre}}} $$\n$\\hat{\\theta}$ 的标准误 (SE) 是该方差的平方根：\n$$ \\widehat{\\mathrm{SE}}(\\hat{\\theta}) = \\sqrt{\\frac{1}{x_{\\mathrm{post}}} + \\frac{1}{x_{\\mathrm{pre}}}} $$\n根据中心极限定理和delta方法，$\\hat{\\theta}$ 近似服从正态分布。$\\theta = \\ln(E)$ 的一个双侧 $0.95$ 置信区间由下式给出：\n$$ \\hat{\\theta} \\pm z_{1-0.05/2} \\cdot \\widehat{\\mathrm{SE}}(\\hat{\\theta}) $$\n其中 $z_{0.975}$ 是标准正态分布的 $0.975$ 分位数，其值约为 $1.96$。\n\n让我们计算数值：\n对数富集因子的点估计值为：\n$$ \\hat{\\theta} = \\ln(\\hat{E}) = \\ln(20) \\approx 2.9957 $$\n标准误为：\n$$ \\widehat{\\mathrm{SE}}(\\hat{\\theta}) = \\sqrt{\\frac{1}{400} + \\frac{1}{50}} = \\sqrt{0.0025 + 0.02} = \\sqrt{0.0225} = 0.15 $$\n$0.95$ 置信区间的误差范围是：\n$$ ME = 1.96 \\times 0.15 = 0.294 $$\n$\\theta = \\ln(E)$ 的 $0.95$ 置信区间是：\n$$ 2.9957 \\pm 0.294 $$\n这给出了区间 $[2.7017, 3.2897]$。\n\n为了获得富集因子 $E$ 的置信区间，我们对 $\\ln(E)$ 区间的端点取指数：\n$$ \\text{Lower bound for } E = \\exp(2.7017) \\approx 14.906 $$\n$$ \\text{Upper bound for } E = \\exp(3.2897) \\approx 26.835 $$\n或者，我们可以将 E 的区间表示为：\n$$ \\hat{E} \\cdot \\exp\\left(\\pm z_{0.975} \\sqrt{\\frac{1}{x_{\\mathrm{pre}}} + \\frac{1}{x_{\\mathrm{post}}}}\\right) $$\n$$ 20 \\cdot \\exp(\\pm 0.294) $$\n下限： $20 \\cdot \\exp(-0.294) \\approx 20 \\times 0.74528 = 14.906$。\n上限： $20 \\cdot \\exp(0.294) \\approx 20 \\times 1.34177 = 26.835$。\n\n要求的最终结果是一个行矩阵，包含点估计值 $\\hat{E}$、置信下限和置信上限，每个值都四舍五入到三位有效数字。\n$\\hat{E} = 20 \\to 20.0$\n下限 $= 14.906 \\to 14.9$\n上限 $= 26.835 \\to 26.8$\n最终答案以行矩阵 $\\begin{pmatrix} 20.0 & 14.9 & 26.8 \\end{pmatrix}$ 的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} 20.0 & 14.9 & 26.8 \\end{pmatrix}}\n$$", "id": "2743984"}]}