{"hands_on_practices": [{"introduction": "理论分析是理解复杂生物系统的第一步。本练习将指导您使用线性化这一强大的数学工具来剖析基因回路中的负载效应。通过推导一个“小信号”模型，您将学习如何量化下游负载对上游模块信号传递的衰减作用，从而将反作用力（retroactivity）的概念与一个可测量的系统参数——增益联系起来 [@problem_id:2770393]。这个过程对于培养将抽象概念转化为具体解析表达式的能力至关重要。", "problem": "一个浓度为 $x(t)$ 的转录因子由一个上游模块以输入控制的生产速率 $u(t)$ 产生，并因细胞生长而以速率常数 $\\gamma$ 被稀释。该转录因子可逆地结合到一组总浓度为 $S_T$ 的下游启动子位点上，形成浓度为 $c(t)$ 的复合物。假设如下：\n\n- 游离转录因子与启动子位点之间的结合与稀释相比是快速的，因此结合反应在每一瞬间都处于准稳态。\n- 速率为 $\\gamma$ 的稀释同等地作用于游离和结合的转录因子（即总转录因子被稀释）。\n- 不存在其他汇或源。\n\n设 $K_d$ 表示结合反应的平衡解离常数，设 $s(t)$ 表示未结合启动子位点的浓度。基本关系是启动子位点的质量守恒，$S_T = s(t) + c(t)$，以及平衡时解离常数的定义，$K_d = \\frac{x(t)\\,s(t)}{c(t)}$。总转录因子的上游质量平衡为 $d(x(t) + c(t))/dt = u(t) - \\gamma \\left(x(t) + c(t)\\right)$。\n\n考虑在游离转录因子浓度为 $\\bar{x}$ 的稳态附近的操作点，并定义小信号扰动 $\\tilde{x}(t) = x(t) - \\bar{x}$ 和 $\\tilde{u}(t) = u(t) - \\bar{u}$，其中 $\\bar{u}$ 是稳态输入。仅使用上述关系，推导 $\\tilde{u}(t)$ 和 $\\tilde{x}(t)$ 之间的线性化小信号关系，并确定由负载引起的小信号输入衰减因子 $g_{\\mathrm{load}}$，其定义为有负载与无负载时从 $u$ 到 $x$ 的稳态增益之比。然后，在由 $\\bar{x} = 30\\,\\mathrm{nM}$、$S_T = 100\\,\\mathrm{nM}$ 和 $K_d = 20\\,\\mathrm{nM}$ 表征的操作点上，数值计算 $g_{\\mathrm{load}}$。将您的最终答案四舍五入到4位有效数字。所求的 $g_{\\mathrm{load}}$ 是无量纲的，应以纯数形式报告。", "solution": "我们从控制可逆结合和守恒的基本关系开始。在结合的准稳态下，解离常数 $K_d$ 满足\n$$\nK_d \\;=\\; \\frac{x(t)\\,s(t)}{c(t)} \\,,\n$$\n其中 $s(t)$ 是未结合启动子位点的浓度，$c(t)$ 是结合复合物的浓度。启动子位点的质量守恒给出\n$$\nS_T \\;=\\; s(t) + c(t) \\,.\n$$\n消去 $s(t)$ 得到\n$$\nK_d \\;=\\; \\frac{x(t)\\,\\big(S_T - c(t)\\big)}{c(t)} \\,,\n$$\n这可以被重新整理，以 $x(t)$ 的形式解出 $c(t)$：\n$$\nx(t)\\,S_T \\;=\\; c(t)\\,\\big(K_d + x(t)\\big) \\quad \\Longrightarrow \\quad c(t) \\;=\\; \\frac{S_T\\,x(t)}{K_d + x(t)} \\,.\n$$\n在结合反应的准稳态下，对于总位点浓度 $S_T$ 固定的情况，该关系对于一对一结合是精确的。\n\n接下来，考虑总转录因子库（游离加结合）的上游质量平衡，根据所述假设，其表达式为\n$$\n\\frac{d}{dt}\\big(x(t) + c(t)\\big) \\;=\\; u(t) \\;-\\; \\gamma\\,\\big(x(t) + c(t)\\big) \\,.\n$$\n通过 $\\tilde{x}(t) = x(t) - \\bar{x}$ 和 $\\tilde{u}(t) = u(t) - \\bar{u}$ 在稳态操作点 $\\bar{x}$ 和 $\\bar{u}$ 周围定义小扰动。因为结合是准静态的，$c(t)$ 是 $x(t)$ 的一个瞬时函数，所以其小信号变化为\n$$\n\\tilde{c}(t) \\;=\\; \\left.\\frac{d c}{d x}\\right|_{x=\\bar{x}} \\tilde{x}(t) \\;\\equiv\\; r\\,\\tilde{x}(t) \\,,\n$$\n其中小信号反作用系数是\n$$\nr \\;=\\; \\left.\\frac{d}{d x}\\left(\\frac{S_T\\,x}{K_d + x}\\right)\\right|_{x=\\bar{x}} \\;=\\; \\left.\\frac{S_T\\,K_d}{\\big(K_d + x\\big)^{2}}\\right|_{x=\\bar{x}} \\;=\\; \\frac{S_T\\,K_d}{\\big(K_d + \\bar{x}\\big)^{2}} \\,.\n$$\n将总质量平衡在稳态点附近线性化，我们写出\n$$\n\\frac{d}{dt}\\big(\\tilde{x}(t) + \\tilde{c}(t)\\big) \\;=\\; \\tilde{u}(t) \\;-\\; \\gamma\\,\\big(\\tilde{x}(t) + \\tilde{c}(t)\\big) \\,,\n$$\n或者，代入 $\\tilde{c}(t) = r\\,\\tilde{x}(t)$，\n$$\n(1 + r)\\,\\frac{d \\tilde{x}(t)}{dt} \\;=\\; \\tilde{u}(t) \\;-\\; \\gamma\\,(1 + r)\\,\\tilde{x}(t) \\,.\n$$\n这个一阶线性方程表明，在这些假设下，负载以一个因子 $1/(1+r)$ 影响输入路径，同时保持内在稀释时间尺度不变。关注稳态小信号增益（即，对于一个慢变化，通过设置 $d\\tilde{x}/dt=0$ 得到的稳态 $\\tilde{x}$ 与稳态 $\\tilde{u}$ 的比值），我们有\n$$\n0 \\;=\\; \\tilde{u} \\;-\\; \\gamma\\,(1 + r)\\,\\tilde{x} \\quad \\Longrightarrow \\quad \\frac{\\tilde{x}}{\\tilde{u}} \\;=\\; \\frac{1}{\\gamma\\,(1 + r)} \\,.\n$$\n无负载时的稳态增益（即没有下游结合，即 $r=0$）是 $\\frac{1}{\\gamma}$。因此，由负载引起的小信号输入衰减因子是\n$$\ng_{\\mathrm{load}} \\;=\\; \\frac{\\text{有负载增益}}{\\text{无负载增益}} \\;=\\; \\frac{\\frac{1}{\\gamma\\,(1 + r)}}{\\frac{1}{\\gamma}} \\;=\\; \\frac{1}{1 + r} \\,.\n$$\n\n剩下的就是在指定的操作点上计算 $r$ 的值，然后计算 $g_{\\mathrm{load}}$。使用 $\\bar{x} = 30\\,\\mathrm{nM}$、$S_T = 100\\,\\mathrm{nM}$ 和 $K_d = 20\\,\\mathrm{nM}$，我们发现\n$$\nr \\;=\\; \\frac{S_T\\,K_d}{\\big(K_d + \\bar{x}\\big)^{2}} \\;=\\; \\frac{100 \\times 20}{(20 + 30)^{2}} \\;=\\; \\frac{2000}{50^{2}} \\;=\\; \\frac{2000}{2500} \\;=\\; 0.8 \\,.\n$$\n因此，\n$$\ng_{\\mathrm{load}} \\;=\\; \\frac{1}{1 + r} \\;=\\; \\frac{1}{1 + 0.8} \\;=\\; \\frac{1}{1.8} \\;=\\; 0.555\\overline{5} \\,.\n$$\n四舍五入到4位有效数字，结果是 $0.5556$。", "answer": "$$\\boxed{0.5556}$$", "id": "2770393"}, {"introduction": "在掌握了线性近似分析之后，我们转向对完整非线性模型的计算探索，以获得更全面的认识。该练习模拟了一个无细胞系统中的反作用力，要求您通过编程计算在不同参数条件（例如，不同的负载大小和结合亲和力）下系统的关键稳态指标 [@problem_id:2770386]。通过这种方式，您将建立起关于负载如何具体影响游离蛋白浓度和系统灵敏度的定量直觉，从而弥合理论分析与实际系统行为之间的差距。", "problem": "您将处理一个物理真实、数学适定的无细胞转录翻译环境中的输出端回溯活性模型。一个上游遗传模块产生一种转录因子，其总浓度表示为 $X_T(t)$。该总浓度是自由转录因子 $X(t)$ 与其通过可逆结合作用于一个固定的下游靶点池 $D(t)$ 而形成的结合复合物 $C(t)$ 的总和。结合反应为 $X + D \\rightleftharpoons C$，其质量作用定律的结合速率为 $k_+$，解离速率为 $k_-$。下游靶点的总数 $D_T$ 是守恒的，因此有 $D(t) = D_T - C(t)$。上游模块以恒定的零级速率 $k_p$ 产生 $X_T$，而其移除（例如，降解、稀释或被资源池隔离）则以一级速率常数 $k_d$ 发生。这两个过程均在充分混合、恒定体积的无细胞反应体系中进行。请遵循以下基本和建模假设：\n\n- 结合与解离遵循质量作用动力学。\n- 下游靶点总物种守恒：$D_T = D + C$。\n- 时间尺度分离：与 $X_T$ 的产生和移除相比，结合-解离动力学过程要快得多，因此在任何给定时间，结合反应都处于准稳态（QSS）。\n- 移除作用于总转录因子 $X_T$（因此自由和结合形式的转录因子都遵循相同的一级有效移除速率）。\n- 解离常数为 $K_d = k_- / k_+$。\n\n基于这些假设和输出端回溯活性的定义，由于 $X_T(t)$ 在恒定产生和一级移除作用下达到稳态，而结合反应在任何时候都处于准平衡状态，因此自由浓度 $X(t)$ 在稳态下遵循一个代数关系。您的任务是，对于给定的参数，计算稳态自由浓度 $X^\\ast$（单位为纳摩尔）、占据分数 $\\phi = X^\\ast / X_T^\\ast$（无量纲），以及稳态灵敏度 $s = \\frac{d X^\\ast}{d D_T}$（无量纲，以小数值表示）。灵敏度 $s$ 用于量化下游负载 $D_T$ 的微小变化如何回溯性地扰动上游自由输出 $X^\\ast$。\n\n请从上述基本定律和核心定义出发。在推导和计算中，仅使用以下事实作为基础：\n- 上游总浓度动态方程为 $\\frac{d X_T}{d t} = k_p - k_d X_T$。\n- 准稳态下的快速可逆结合满足 $K_d = \\frac{[X][D]}{[C]}$，其中 $D = D_T - C$ 且 $X_T = X + C$。\n\n算法要求：\n- 对于每个测试用例，根据稳态下的上游总量平衡计算 $X_T^\\ast$。\n- 然后，利用结合和守恒所隐含的代数稳态约束计算 $X^\\ast$，不得引入任何非由所述假设推导出的临时或简化公式。\n- 计算 $\\phi = X^\\ast / X_T^\\ast$。\n- 使用第一性原理计算稳态灵敏度 $s = \\frac{d X^\\ast}{d D_T}$（可接受对稳态代数关系进行隐式微分）。\n- 数值输出必须是实值且具有物理意义，满足 $X^\\ast \\ge 0$，$0 \\le \\phi \\le 1$，以及 $s \\le 0$。\n- 将 $X^\\ast$ 以纳摩尔表示，$\\phi$ 和 $s$ 为纯数。将这三个量全部四舍五入至 $6$ 位小数。\n\n输入和单位：\n- 无需读取输入；请使用下方的固定测试套件。\n- 浓度单位为纳摩尔（nM）。\n- 产生速率 $k_p$ 的单位为纳摩尔/分钟（nM/min）。\n- 移除速率常数 $k_d$ 的单位为每分钟（min$^{-1}$）。\n- 解离常数 $K_d$ 的单位为纳摩尔（nM）。\n- 下游靶点总数 $D_T$ 的单位为纳摩尔（nM）。\n\n测试套件（每个用例是一个元组 $(k_p, k_d, K_d, D_T)$，单位如上所述）：\n- 用例A（基准，中等负载和亲和力）：$(k_p = 10,\\ k_d = 0.1,\\ K_d = 10,\\ D_T = 100)$。\n- 用例B（无下游负载）：$(k_p = 10,\\ k_d = 0.1,\\ K_d = 10,\\ D_T = 0)$。\n- 用例C（强结合和高负载）：$(k_p = 10,\\ k_d = 0.1,\\ K_d = 1,\\ D_T = 500)$。\n- 用例D（弱结合和高负载）：$(k_p = 10,\\ k_d = 0.1,\\ K_d = 1000,\\ D_T = 500)$。\n- 用例E（大上游容量）：$(k_p = 100,\\ k_d = 0.1,\\ K_d = 10,\\ D_T = 100)$。\n\n您的程序必须按照 A、B、C、D、E 的顺序，为每个用例计算并收集一个列表 $[X^\\ast,\\ \\phi,\\ s]$，四舍五入到 $6$ 位小数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个元素是对应测试用例的列表 $[X^\\ast,\\phi,s]$，顺序与给定顺序相同。例如，最终输出格式必须看起来像一个单行的 Python 风格的列表的列表，该行上没有任何其他文本。\n\n注意：不涉及角度或百分比。所有答案都是以小数表示的实数。请确保数值的鲁棒性，并在存在多个数学解时选择具有物理意义的解分支。", "solution": "在尝试任何解决方案之前，需对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 上游总转录因子浓度：$X_T(t)$。\n- 自由转录因子浓度：$X(t)$。\n- 结合复合物浓度：$C(t)$。\n- 自由下游靶点浓度：$D(t)$。\n- 下游靶点总浓度：$D_T$。\n- 结合反应：$X + D \\rightleftharpoons C$。\n- 质量作用定律结合速率：$k_+$。\n- 质量作用定律解离速率：$k_-$。\n- 靶点守恒：$D(t) = D_T - C(t)$。\n- 总转录因子与自由转录因子的关系：$X_T(t) = X(t) + C(t)$。\n- 上游产生速率（零级）：$k_p$。\n- 上游移除速率常数（一级）：$k_d$。\n- 总转录因子动态方程：$\\frac{d X_T}{d t} = k_p - k_d X_T$。\n- 移除作用于总转录因子 $X_T$。\n- 结合-解离动力学处于准稳态（QSS）。\n- 解离常数：$K_d = k_- / k_+$。\n- QSS 结合关系：$K_d = \\frac{[X][D]}{[C]}$。\n- 待计算量：稳态自由浓度 $X^\\ast$、占据分数 $\\phi = X^\\ast / X_T^\\ast$ 和灵敏度 $s = \\frac{d X^\\ast}{d D_T}$。\n- 测试用例 $(k_p, k_d, K_d, D_T)$:\n    - 用例 A: $(10, 0.1, 10, 100)$\n    - 用例 B: $(10, 0.1, 10, 0)$\n    - 用例 C: $(10, 0.1, 1, 500)$\n    - 用例 D: $(10, 0.1, 1000, 500)$\n    - 用例 E: $(100, 0.1, 10, 100)$\n- 单位：浓度单位为 nM，$k_p$ 单位为 nM/min，$k_d$ 单位为 min$^{-1}$。\n- 输出四舍五入：$6$ 位小数。\n\n**第2步：使用提取的已知条件进行验证**\n根据验证标准对问题进行评估。\n\n- **科学依据**：该模型是遗传线路中回溯活性的经典表示，基于质量作用动力学、守恒定律和准稳态近似。这些是化学动力学和系统生物学中基本且成熟的原理。该模型在科学上是合理的。\n- **适定性**：问题提供了一套完整的耦合代数和微分方程。参数已指定，目标已明确定义。该系统导出了一个关于稳态浓度的二次方程，该方程有唯一、具有物理意义（非负）的解。灵敏度计算是隐式微分的标准应用。问题是适定的。\n- **客观性**：问题以精确、定量和无偏见的语言陈述。没有主观或基于意见的元素。\n- **完整性**：为每个用例提供了所有必要的参数（$k_p, k_d, K_d, D_T$）和控制方程。问题是自包含的。\n- **真实性**：参数值在无细胞生化系统的物理合理范围内。\n- **结构性**：问题结构逻辑清晰。它要求从第一性原理进行推导，以证明对底层模型的清晰理解，而不仅仅是公式应用。\n\n**第3步：结论与行动**\n问题评估为**有效**。它在科学上合理、适定、完整且客观。将推导并计算解答。\n\n**解答推导**\n\n目标是求得稳态值 $X^\\ast$、$\\phi$ 和 $s$。\n\n**1. 稳态总浓度, $X_T^\\ast$**\n上游总蛋白质浓度 $X_T$ 的动态由以下常微分方程给出：\n$$\n\\frac{d X_T}{d t} = k_p - k_d X_T\n$$\n在稳态下，浓度不发生变化，即 $\\frac{d X_T}{d t} = 0$。这给出：\n$$\n0 = k_p - k_d X_T^\\ast\n$$\n求解稳态总浓度 $X_T^\\ast$ 可得：\n$$\nX_T^\\ast = \\frac{k_p}{k_d}\n$$\n此量仅取决于上游的产生和移除速率，而与下游负载 $D_T$ 无关。\n\n**2. 稳态自由浓度, $X^\\ast$**\n稳态自由浓度 $X^\\ast$ 由总蛋白质的可得性与下游靶点结合之间的相互作用决定。我们使用所提供的关系式，并在稳态下进行评估（为清晰起见，我们省略了显式的时间依赖性，并使用星号上标）：\n(i) $X_T^\\ast = X^\\ast + C^\\ast$\n(ii) $D_T = D^\\ast + C^\\ast$\n(iii) $K_d = \\frac{X^\\ast D^\\ast}{C^\\ast}$\n\n从 (i) 式，我们将结合复合物浓度表示为 $C^\\ast = X_T^\\ast - X^\\ast$。\n从 (ii) 式，我们将自由靶点浓度表示为 $D^\\ast = D_T - C^\\ast$。代入 $C^\\ast$ 的表达式：\n$$\nD^\\ast = D_T - (X_T^\\ast - X^\\ast) = D_T - X_T^\\ast + X^\\ast\n$$\n现在，将 $C^\\ast$ 和 $D^\\ast$ 的表达式代入解离常数方程 (iii)：\n$$\nK_d = \\frac{X^\\ast (D_T - X_T^\\ast + X^\\ast)}{X_T^\\ast - X^\\ast}\n$$\n为了求解 $X^\\ast$，我们将其重新排列成一个多项式形式：\n$$\nK_d (X_T^\\ast - X^\\ast) = X^\\ast (D_T - X_T^\\ast + X^\\ast)\n$$\n$$\nK_d X_T^\\ast - K_d X^\\ast = D_T X^\\ast - X_T^\\ast X^\\ast + (X^\\ast)^2\n$$\n$$\n(X^\\ast)^2 + (D_T - X_T^\\ast + K_d) X^\\ast - K_d X_T^\\ast = 0\n$$\n这是一个关于 $X^\\ast$ 的二次方程，形式为 $a(X^\\ast)^2 + bX^\\ast + c = 0$，其系数为：\n$a = 1$\n$b = D_T - X_T^\\ast + K_d$\n$c = -K_d X_T^\\ast$\n\n解由二次公式给出：\n$$\nX^\\ast = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} = \\frac{-(D_T - X_T^\\ast + K_d) \\pm \\sqrt{(D_T - X_T^\\ast + K_d)^2 + 4K_d X_T^\\ast}}{2}\n$$\n由于 $X^\\ast$ 必须代表一个物理浓度，它必须是非负的。所有参数 $K_d, X_T^\\ast$ 都是正数。平方根下的项 $(D_T - X_T^\\ast + K_d)^2 + 4K_d X_T^\\ast$ 是严格正数。此外，$\\sqrt{(D_T - X_T^\\ast + K_d)^2 + 4K_d X_T^\\ast} > \\sqrt{(D_T - X_T^\\ast + K_d)^2} = |D_T - X_T^\\ast + K_d|$。为确保 $X^\\ast \\ge 0$，我们必须选择正根。\n$$\nX^\\ast = \\frac{-(D_T - X_T^\\ast + K_d) + \\sqrt{(D_T - X_T^\\ast + K_d)^2 + 4K_d X_T^\\ast}}{2}\n$$\n这是唯一的、具有物理意义的解。\n\n**3. 占据分数, $\\phi$**\n占据分数定义为稳态下自由浓度与总浓度的比率：\n$$\n\\phi = \\frac{X^\\ast}{X_T^\\ast}\n$$\n\n**4. 灵敏度, $s$**\n灵敏度 $s$ 量化了自由浓度 $X^\\ast$ 相对于下游总负载 $D_T$ 变化的程度。它定义为导数 $s = \\frac{d X^\\ast}{d D_T}$。我们通过对稳态代数关系应用隐式微分来求得此值：\n$$\n(X^\\ast)^2 + (D_T - X_T^\\ast + K_d) X^\\ast - K_d X_T^\\ast = 0\n$$\n我们将整个方程对 $D_T$ 求导，将 $X^\\ast$ 视为 $D_T$ 的函数，而 $X_T^\\ast = k_p/k_d$ 和 $K_d$ 是相对于 $D_T$ 的常数。\n$$\n\\frac{d}{dD_T} \\left[ (X^\\ast)^2 + (D_T - X_T^\\ast + K_d) X^\\ast - K_d X_T^\\ast \\right] = 0\n$$\n$$\n2X^\\ast \\frac{dX^\\ast}{dD_T} + \\left( \\frac{d}{dD_T}[D_T - X_T^\\ast + K_d] \\cdot X^\\ast + (D_T - X_T^\\ast + K_d) \\cdot \\frac{dX^\\ast}{dD_T} \\right) - 0 = 0\n$$\n$[D_T - X_T^\\ast + K_d]$ 项对 $D_T$ 的导数是 $1$。\n$$\n2X^\\ast \\frac{dX^\\ast}{dD_T} + (1) \\cdot X^\\ast + (D_T - X_T^\\ast + K_d) \\frac{dX^\\ast}{dD_T} = 0\n$$\n合并含有 $\\frac{dX^\\ast}{dD_T}$ 的项：\n$$\n\\frac{dX^\\ast}{dD_T} \\left[ 2X^\\ast + D_T - X_T^\\ast + K_d \\right] = -X^\\ast\n$$\n求解 $s = \\frac{dX^\\ast}{dD_T}$：\n$$\ns = \\frac{-X^\\ast}{2X^\\ast + D_T - X_T^\\ast + K_d}\n$$\n一旦稳态值 $X^\\ast$ 和 $X_T^\\ast$ 已知，此表达式即可直接计算灵敏度。由于 $X^\\ast \\ge 0$，并且可以证明对于物理上的解，分母是正的，因此灵敏度 $s$ 总是小于或等于 $0$。这是符合预期的：增加负载 $D_T$ 会隔离更多的蛋白质，从而降低自由浓度 $X^\\ast$。\n\n**计算算法**\n对于每个测试用例 $(k_p, k_d, K_d, D_T)$：\n1.  计算 $X_T^\\ast = k_p / k_d$。\n2.  使用推导出的二次公式解计算 $X^\\ast$。\n3.  计算 $\\phi = X^\\ast / X_T^\\ast$。\n4.  计算 $s = \\frac{-X^\\ast}{2X^\\ast + D_T - X_T^\\ast + K_d}$。\n5.  将所有三个结果四舍五入到 $6$ 位小数，并组合成一个列表。\n\n此过程将为提供的测试套件实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the steady-state free concentration (X*), occupancy fraction (phi),\n    and sensitivity (s) for a model of genetic circuit retroactivity.\n    \"\"\"\n    \n    # Test suite (each case is a tuple (kp, kd, Kd, DT) in specified units)\n    # kp: nM/min, kd: min^-1, Kd: nM, DT: nM\n    test_cases = [\n        # Case A (baseline, moderate load and affinity)\n        (10.0, 0.1, 10.0, 100.0),\n        # Case B (no downstream load)\n        (10.0, 0.1, 10.0, 0.0),\n        # Case C (strong binding and high load)\n        (10.0, 0.1, 1.0, 500.0),\n        # Case D (weak binding at high load)\n        (10.0, 0.1, 1000.0, 500.0),\n        # Case E (large upstream capacity)\n        (100.0, 0.1, 10.0, 100.0),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        kp, kd, Kd, DT = case\n\n        # 1. Compute steady-state total concentration, X_T_star\n        # dX_T/dt = kp - kd * X_T => X_T_star = kp / kd\n        X_T_star = kp / kd\n\n        # 2. Compute steady-state free concentration, X_star\n        # This requires solving the quadratic equation:\n        # (X*)^2 + (DT - X_T* + Kd)X* - Kd*X_T* = 0\n        # which is of the form a*x^2 + b*x + c = 0 with:\n        a = 1.0\n        b = DT - X_T_star + Kd\n        c = -Kd * X_T_star\n\n        # Use the quadratic formula, selecting the physically meaningful (positive) root.\n        # X* = (-b + sqrt(b^2 - 4ac)) / 2a\n        discriminant = b**2 - 4 * a * c\n        \n        # The physically meaningful solution must be non-negative.\n        # Since a=1 and the discriminant is guaranteed to be non-negative, and\n        # sqrt(b^2-4ac) > |b| if c < 0, we select the '+' sign.\n        if discriminant < 0:\n            # This should not happen with the given model and positive parameters.\n            # It would indicate a physically impossible scenario.\n            X_star = float('nan') \n        else:\n            X_star = (-b + np.sqrt(discriminant)) / (2.0 * a)\n\n        # 3. Compute the occupancy fraction, phi\n        # The problem statement defines phi = X* / X_T*\n        # Handle the case where X_T_star might be zero, although not with these inputs.\n        if X_T_star == 0:\n            phi = 1.0 if X_star == 0 else float('nan')\n        else:\n            phi = X_star / X_T_star\n        \n        # 4. Compute the sensitivity, s\n        # s = dX*/dDT = -X* / (2*X* + DT - X_T* + Kd)\n        denominator_s = 2 * X_star + DT - X_T_star + Kd\n        if denominator_s == 0:\n            # This is mathematically possible but unlikely in this physical model.\n            s = float('nan')\n        else:\n            s = -X_star / denominator_s\n            \n        # 5. Round results to 6 decimal places and store.\n        # The problem requires numerical outputs. We use round() for this.\n        # str().format() would be for display formatting, but storing rounded values is fine.\n        result_list = [\n            round(X_star, 6),\n            round(phi, 6),\n            round(s, 6)\n        ]\n        all_results.append(result_list)\n        \n    # Final print statement in the exact required format.\n    # The output should be a single Python-style list of lists.\n    # Direct printing of the list gives the correct format.\n    print(all_results)\n\nsolve()\n```", "id": "2770386"}, {"introduction": "合成生物学的最终目标之一是理性设计。本练习将前面的分析和计算技能应用于一个实际的工程设计挑战：优化基因回路的性能。您需要在满足特定输出通量要求的同时，通过调整启动子拷贝数 $N$ 和解离常数 $K_D$ 来最小化负载引起的响应时间延迟 [@problem_id:2770397]。解决这个问题不仅能加深您对设计权衡（trade-offs）的理解，还能让您体验到如何运用系统性的方法来构建更稳定、更高效的生物回路。", "problem": "一个转录激活蛋白，其游离分子数为 $x(t)$，以速率 $\\alpha$（分子/单位时间）组成性地产生，并以速率 $\\delta$（/单位时间）被稀释/降解。在孤立状态下（无下游连接），其动力学由常微分方程 (ODE) $dx/dt=\\alpha-\\delta x$ 描述，其稳定稳态为 $x^{\\ast}=\\alpha/\\delta$。现在连接一个下游模块，该模块由 $N$ 个相同的启动子结合位点（每个细胞）组成，每个位点通过可逆反应 $P+X \\rightleftharpoons PX$ 以一对一的化学计量关系结合一个激活蛋白分子 $X$。该反应受质量作用动力学控制，结合速率常数为 $k_{\\text{on}}$，解离速率常数为 $k_{\\text{off}}$。解离常数为 $K_D=k_{\\text{off}}/k_{\\text{on}}$。假设结合-解离反应远快于产生和稀释，因此结合复合物处于准稳态 (QSS)。令 $b(x)$ 表示被启动子隔离的 $X$ 分子数（在一对一结合条件下，这等于被占据的启动子位点数）。在准稳态下，$b(x)=N\\,\\dfrac{x}{K_D+x}$。\n\n当上游和下游连接时，总 $X$ 分子 $x_T=x+b(x)$ 的质量平衡为 $d x_T/dt=\\alpha-\\delta x_T$。利用准稳态关系，可以得出游离分子动力学的有效一阶时间常数被一个因子 $\\tau_{\\text{eff}}/\\tau_0=1+\\left.\\dfrac{d b}{d x}\\right|_{x^{\\ast}}$ 重标，其中 $\\tau_0=1/\\delta$ 是孤立上游模块的内在时间常数。量 $r=\\left.\\dfrac{d b}{d x}\\right|_{x^{\\ast}}$ 是对输出的反向活性（负载）的无量纲度量。\n\n每个被占据的启动子以速率 $\\beta$（转录本/单位时间/被占据位点）产生转录本。要求在工作点的下游平均转录通量指定为 $R^{\\ast}$（转录本/单位时间）。已知结合亲和力不能任意增加：$K_D$ 必须满足 $K_D\\ge K_{\\min}>0$，其中 $K_{\\min}$ 是一个给定的、反映物理/生物化学约束的正常数。\n\n从上述基本定义出发，并仅使用质量作用动力学、$X$ 总量守恒和时间尺度分离（QSS），推导并求解此约束设计问题：选择启动子拷贝数 $N$ 和解离常数 $K_D$，以最小化有效时间常数放大因子 $\\tau_{\\text{eff}}/\\tau_0$，同时在工作点 $x^{\\ast}=\\alpha/\\delta$ 处达到所需通量 $R^{\\ast}$ 并满足 $K_D\\ge K_{\\min}$。将你的最终答案表示为一个单行矩阵，该矩阵按顺序包含最优值 $N^{\\ast}$、$K_D^{\\ast}$ 和最小化后的因子 $\\left(\\tau_{\\text{eff}}/\\tau_0\\right)^{\\ast}$。答案应为以符号 $\\alpha$、$\\delta$、$\\beta$、$R^{\\ast}$ 和 $K_{\\min}$ 表示的闭合形式解析表达式。最终答案中不要包含单位。无需进行数值四舍五入。", "solution": "所给问题是合成生物学领域的一个约束优化问题。它具有坚实的科学基础，内容自洽，并且在数学上是适定的。其目标是选择遗传回路的物理参数，具体来说是启动子拷贝数 $N$ 和解离常数 $K_D$，以在特定的性能约束下最小化回路的响应时间。我现在将进行形式化推导。\n\n待最小化的量是有效时间常数放大因子，由以下表达式给出：\n$$F(N, K_D) = \\frac{\\tau_{\\text{eff}}}{\\tau_0} = 1 + \\left.\\frac{db}{dx}\\right|_{x^{\\ast}}$$\n这里，$b(x)$ 是被隔离的激活蛋白分子数，定义为 $b(x) = N \\frac{x}{K_D+x}$，$x^{\\ast} = \\alpha/\\delta$ 是在无负载情况下游离激活蛋白的稳态浓度。\n\n首先，我们必须计算导数 $\\frac{db}{dx}$。使用微分的商法则：\n$$ \\frac{db}{dx} = \\frac{d}{dx} \\left( N \\frac{x}{K_D+x} \\right) = N \\left( \\frac{(K_D+x)(1) - x(1)}{(K_D+x)^2} \\right) = N \\frac{K_D}{(K_D+x)^2} $$\n反向活性 $r$ 是此导数在工作点 $x = x^{\\ast}$ 处的值：\n$$ r = \\left.\\frac{db}{dx}\\right|_{x^{\\ast}} = N \\frac{K_D}{(K_D+x^{\\ast})^2} = N \\frac{K_D}{(K_D + \\alpha/\\delta)^2} $$\n因此，待最小化的目标函数是：\n$$ F(N, K_D) = 1 + N \\frac{K_D}{(K_D + \\alpha/\\delta)^2} $$\n此最小化必须在两个约束条件下进行。\n\n第一个约束是关于输出通量。在工作点的总转录通量 $R(x^{\\ast})$ 必须等于一个指定值 $R^{\\ast}$：\n$$ R^{\\ast} = \\beta \\cdot b(x^{\\ast}) = \\beta N \\frac{x^{\\ast}}{K_D+x^{\\ast}} $$\n代入 $x^{\\ast} = \\alpha/\\delta$，我们得到：\n$$ R^{\\ast} = \\beta N \\frac{\\alpha/\\delta}{K_D + \\alpha/\\delta} $$\n这个约束耦合了两个设计变量 $N$ 和 $K_D$。我们可以将 $N$ 表示为 $K_D$ 的函数：\n$$ N(K_D) = \\frac{R^{\\ast}}{\\beta} \\frac{K_D + \\alpha/\\delta}{\\alpha/\\delta} $$\n\n第二个约束是对结合亲和力的物理限制：\n$$ K_D \\ge K_{\\min} $$\n其中 $K_{\\min}$ 是一个给定的正常数。\n\n我们现在将问题表述为单变量函数的最小化问题。将通量约束中 $N(K_D)$ 的表达式代入目标函数 $F(N, K_D)$：\n$$ F(K_D) = 1 + \\left( \\frac{R^{\\ast}}{\\beta} \\frac{K_D + \\alpha/\\delta}{\\alpha/\\delta} \\right) \\left( \\frac{K_D}{(K_D + \\alpha/\\delta)^2} \\right) $$\n简化此表达式可得：\n$$ F(K_D) = 1 + \\frac{R^{\\ast}}{\\beta (\\alpha/\\delta)} \\frac{K_D}{K_D + \\alpha/\\delta} $$\n现在的任务是在可行域 $K_D \\ge K_{\\min}$ 上关于 $K_D$ 最小化 $F(K_D)$。\n\n为了找到最小值，我们分析 $F(K_D)$ 关于 $K_D$ 的导数：\n$$ \\frac{dF}{dK_D} = \\frac{d}{dK_D} \\left( 1 + \\frac{R^{\\ast}\\delta}{\\beta\\alpha} \\frac{K_D}{K_D + \\alpha/\\delta} \\right) $$\n$$ \\frac{dF}{dK_D} = \\frac{R^{\\ast}\\delta}{\\beta\\alpha} \\left( \\frac{(K_D + \\alpha/\\delta)(1) - K_D(1)}{(K_D + \\alpha/\\delta)^2} \\right) $$\n$$ \\frac{dF}{dK_D} = \\frac{R^{\\ast}\\delta}{\\beta\\alpha} \\frac{\\alpha/\\delta}{(K_D + \\alpha/\\delta)^2} = \\frac{R^{\\ast}}{\\beta(K_D + \\alpha/\\delta)^2} $$\n参数 $\\alpha$、$\\beta$、$\\delta$ 和 $R^{\\ast}$ 都是正的物理量。解离常数 $K_D$ 也是正的。因此，对于所有具有物理意义的 $K_D$ 值，导数 $\\frac{dF}{dK_D}$ 都是严格为正的。\n\n一个一阶导数严格为正的函数是单调递增的。要在区间 $[K_{\\min}, \\infty)$ 上最小化一个单调递增函数，必须为自变量选择可能的最小值。在这种情况下，$F(K_D)$ 的最小值在约束域的下边界处达到。\n因此，解离常数的最优值为：\n$$ K_D^{\\ast} = K_{\\min} $$\n\n在确定最优值 $K_D^{\\ast}$ 之后，我们现在可以通过将 $K_D^{\\ast}$ 代回 $N(K_D)$ 的表达式中，找到相应的最优启动子拷贝数 $N^{\\ast}$：\n$$ N^{\\ast} = N(K_D^{\\ast}) = \\frac{R^{\\ast}}{\\beta} \\frac{K_{\\min} + \\alpha/\\delta}{\\alpha/\\delta} $$\n这可以重写为：\n$$ N^{\\ast} = \\frac{R^{\\ast}}{\\beta} \\left( \\frac{K_{\\min}\\delta}{\\alpha} + 1 \\right) $$\n\n最后，我们通过在 $K_D = K_D^{\\ast} = K_{\\min}$ 处计算目标函数 $F(K_D)$ 来求得最小化的时间常数放大因子 $(\\tau_{\\text{eff}}/\\tau_0)^{\\ast}$：\n$$ \\left(\\frac{\\tau_{\\text{eff}}}{\\tau_0}\\right)^{\\ast} = F(K_D^{\\ast}) = 1 + \\frac{R^{\\ast}\\delta}{\\beta\\alpha} \\frac{K_{\\min}}{K_{\\min} + \\alpha/\\delta} $$\n此表达式也可以写成：\n$$ \\left(\\frac{\\tau_{\\text{eff}}}{\\tau_0}\\right)^{\\ast} = 1 + \\frac{R^{\\ast}\\delta K_{\\min}}{\\beta\\alpha(K_{\\min} + \\alpha/\\delta)} $$\n这三个表达式 $N^{\\ast}$、$K_D^{\\ast}$ 和 $(\\tau_{\\text{eff}}/\\tau_0)^{\\ast}$ 提供了该设计问题的完整解。", "answer": "$$\\boxed{\\pmatrix{ \\frac{R^{\\ast}}{\\beta} \\left(1 + \\frac{K_{\\min}\\delta}{\\alpha}\\right) & K_{\\min} & 1 + \\frac{R^{\\ast}\\delta K_{\\min}}{\\beta\\alpha\\left(K_{\\min} + \\frac{\\alpha}{\\delta}\\right)} }}$$", "id": "2770397"}]}