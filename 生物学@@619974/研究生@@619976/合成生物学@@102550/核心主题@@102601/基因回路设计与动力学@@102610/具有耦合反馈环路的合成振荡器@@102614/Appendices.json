{"hands_on_practices": [{"introduction": "我们的第一个动手实践是合成振荡器分析的基石。我们将使用经典的“抑制振荡器”(repressilator)模型，练习如何通过数学方法精确预测一个稳定的基因线路在何种条件下会自发地开始振荡。这个练习将锻炼你在线性化和稳定性分析方面的技能，这些是任何系统生物学家都必须掌握的基础工具。[@problem_id:2781529]", "problem": "考虑一个对称的三基因环形振荡器，其中每个基因依次抑制下一个基因，其动力学在粗粒化的蛋白质水平上通过常微分方程 (ODE) 进行建模。每个节点都具有基础的一阶降解和遵循从标准基因调控现象学推导出的 Hill 抑制函数的受调控产生。具体来说，设 $x_{1}(t)$、$x_{2}(t)$ 和 $x_{3}(t)$ 表示三个节点的蛋白质浓度，并假设\n$$\n\\frac{d x_{1}}{d t} \\;=\\; -\\gamma x_{1} \\;+\\; \\frac{\\alpha}{1 + \\left( \\frac{x_{3}}{K} \\right)^{n}},\\qquad\n\\frac{d x_{2}}{d t} \\;=\\; -\\gamma x_{2} \\;+\\; \\frac{\\alpha}{1 + \\left( \\frac{x_{1}}{K} \\right)^{n}},\\qquad\n\\frac{d x_{3}}{d t} \\;=\\; -\\gamma x_{3} \\;+\\; \\frac{\\alpha}{1 + \\left( \\frac{x_{2}}{K} \\right)^{n}},\n$$\n其中 $\\alpha>0$ 是最大产生速率，$\\gamma>0$ 是一阶降解/稀释速率，$K>0$ 是解离常数，$n>0$ 是 Hill 系数。假设转录和翻译延迟可忽略不计，从而使该描述是恰当的。\n\n存在一个唯一的对称稳态 $x_{1}^{\\ast}=x_{2}^{\\ast}=x_{3}^{\\ast}=s$，满足 $-\\gamma s + \\alpha/(1+(s/K)^{n})=0$。从上述基本建模假设和线性化的定义出发，执行以下步骤：\n\n- 在稳态 $\\left(s,s,s\\right)$ 附近对系统进行线性化，并写出雅可比矩阵。\n- 利用线性系统的第一原理和环的对称性来分析雅可比矩阵的特征值，并根据稳态抑制斜率 $f'(s)$（其中 $f(x)=\\alpha/(1+(x/K)^{n})$）推导出通过霍普夫分岔产生自持振荡的解析条件。\n- 仅使用稳态条件和您推导出的起始条件来消去稳态 $s$，以获得振荡首次出现时的临界最大产生速率 $\\alpha_{c}$ 的闭式表达式，该表达式仅用 $\\gamma$、$K$ 和 $n$ 表示。\n\n答案规格：\n- 以仅包含 $\\gamma$、$K$ 和 $n$ 的单个精确解析表达式的形式提供 $\\alpha_{c}$ 的最终结果。\n- 在方框内的最终答案中不要包含单位。参数 $\\alpha_{c}$ 的单位是浓度/时间。", "solution": "问题陈述具有科学依据、适定且客观。它提出了合成生物学中的一个经典模型——repressilator，并要求进行标准的稳定性分析以找到振荡起始的条件。所有必要信息均已提供，问题没有矛盾或歧义。因此，我们着手进行解答。\n\n该常微分方程组由下式给出：\n$$\n\\frac{d x_{1}}{d t} = -\\gamma x_{1} + f(x_{3})\n$$\n$$\n\\frac{d x_{2}}{d t} = -\\gamma x_{2} + f(x_{1})\n$$\n$$\n\\frac{d x_{3}}{d t} = -\\gamma x_{3} + f(x_{2})\n$$\n其中 $f(x) = \\frac{\\alpha}{1 + (x/K)^{n}}$。该系统将在对称稳态 $\\mathbf{x}^{\\ast} = (s, s, s)$ 处进行分析。\n\n首先，我们通过计算雅可比矩阵 $J$ 在该稳态附近对系统进行线性化。雅可比矩阵的元素为 $J_{ij} = \\frac{\\partial}{\\partial x_j} (\\frac{dx_i}{dt})$。\n$$\nJ =\n\\begin{pmatrix}\n\\frac{\\partial}{\\partial x_1}(-\\gamma x_1 + f(x_3)) & \\frac{\\partial}{\\partial x_2}(-\\gamma x_1 + f(x_3)) & \\frac{\\partial}{\\partial x_3}(-\\gamma x_1 + f(x_3)) \\\\\n\\frac{\\partial}{\\partial x_1}(-\\gamma x_2 + f(x_1)) & \\frac{\\partial}{\\partial x_2}(-\\gamma x_2 + f(x_1)) & \\frac{\\partial}{\\partial x_3}(-\\gamma x_2 + f(x_1)) \\\\\n\\frac{\\partial}{\\partial x_1}(-\\gamma x_3 + f(x_2)) & \\frac{\\partial}{\\partial x_2}(-\\gamma x_3 + f(x_2)) & \\frac{\\partial}{\\partial x_3}(-\\gamma x_3 + f(x_2))\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\gamma & 0 & f'(x_3) \\\\\nf'(x_1) & -\\gamma & 0 \\\\\n0 & f'(x_2) & -\\gamma\n\\end{pmatrix}\n$$\n在稳态 $\\mathbf{x}^{\\ast} = (s, s, s)$ 处计算雅可比矩阵，我们得到：\n$$\nJ\\rvert_{\\mathbf{x}^{\\ast}} =\n\\begin{pmatrix}\n-\\gamma & 0 & f'(s) \\\\\nf'(s) & -\\gamma & 0 \\\\\n0 & f'(s) & -\\gamma\n\\end{pmatrix}\n$$\n为简化符号，令 $a = f'(s)$。雅可比矩阵是一个循环矩阵：\n$$\nJ =\n\\begin{pmatrix}\n-\\gamma & 0 & a \\\\\na & -\\gamma & 0 \\\\\n0 & a & -\\gamma\n\\end{pmatrix}\n$$\n接下来，我们通过求解特征方程 $\\det(J - \\lambda I) = 0$ 来求出 $J$ 的特征值 $\\lambda$：\n$$\n\\det \\begin{pmatrix} -\\gamma - \\lambda & 0 & a \\\\ a & -\\gamma - \\lambda & 0 \\\\ 0 & a & -\\gamma - \\lambda \\end{pmatrix} = 0\n$$\n展开行列式可得：\n$$\n(-\\gamma - \\lambda)^{3} + a^{3} = 0 \\implies (\\gamma + \\lambda)^{3} = a^{3}\n$$\n该方程的根为 $\\gamma + \\lambda = a \\cdot \\omega^{k}$，其中 $\\omega = \\exp(i 2\\pi/3)$ 是单位的立方本原根，且 $k \\in \\{0, 1, 2\\}$。因此，特征值为：\n$$\n\\lambda_k = a \\cdot \\omega^{k} - \\gamma\n$$\n具体来说，这三个特征值是：\n$$\n\\lambda_0 = a \\cdot \\omega^{0} - \\gamma = a - \\gamma\n$$\n$$\n\\lambda_1 = a \\cdot \\omega^{1} - \\gamma = a \\left(-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}\\right) - \\gamma = \\left(-\\gamma - \\frac{a}{2}\\right) + i \\frac{a\\sqrt{3}}{2}\n$$\n$$\n\\lambda_2 = a \\cdot \\omega^{2} - \\gamma = a \\left(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}\\right) - \\gamma = \\left(-\\gamma - \\frac{a}{2}\\right) - i \\frac{a\\sqrt{3}}{2}\n$$\n霍普夫分岔标志着自持振荡的开始，它发生于一对共轭复特征值穿过虚轴之时。这要求其实部变为零，同时虚部保持非零。复特征值为 $\\lambda_1$ 和 $\\lambda_2$。\n对实部的要求是 $\\text{Re}(\\lambda_{1,2}) = 0$：\n$$\n-\\gamma - \\frac{a}{2} = 0 \\implies a = -2\\gamma\n$$\n虚部为 $\\text{Im}(\\lambda_{1}) = \\frac{a\\sqrt{3}}{2}$。由于 $\\gamma > 0$，所以 $a = -2\\gamma$ 非零，这意味着在分岔点虚部非零。此外，抑制函数 $f(x)$ 是单调递减的，因此其导数 $a = f'(s)$ 必须为负，这与条件 $a = -2\\gamma$ 一致。\n此时的实特征值为 $\\lambda_0 = a - \\gamma = -2\\gamma - \\gamma = -3\\gamma$，它严格为负。因此，稳定性的改变完全由穿过虚轴的复数对决定，这证实了霍普夫分岔的发生。\n\n现在我们在分岔点有两个条件：\n1. 分岔条件：$f'(s) = -2\\gamma$。\n2. 稳态条件：$\\gamma s = f(s)$。在临界点，该条件为 $\\gamma s = \\frac{\\alpha_c}{1 + (s/K)^{n}}$。\n\n让我们计算导数 $f'(s)$：\n$$\nf'(x) = \\frac{d}{dx} \\left[ \\alpha \\left(1 + \\left(\\frac{x}{K}\\right)^n\\right)^{-1} \\right] = -\\alpha \\left(1 + \\left(\\frac{x}{K}\\right)^n\\right)^{-2} \\cdot n \\left(\\frac{x}{K}\\right)^{n-1} \\cdot \\frac{1}{K}\n$$\n$$\nf'(s) = -\\frac{\\alpha_c n}{K} \\frac{(s/K)^{n-1}}{(1 + (s/K)^{n})^2}\n$$\n现在我们使用这两个条件来消去 $s$ 并求解 $\\alpha_c$：\n$$\n-2\\gamma = -\\frac{\\alpha_c n}{K} \\frac{(s/K)^{n-1}}{(1 + (s/K)^{n})^2} \\implies 2\\gamma = \\frac{\\alpha_c n}{K} \\frac{(s/K)^{n-1}}{(1 + (s/K)^{n})^2}\n$$\n从稳态条件，我们有 $\\alpha_c = \\gamma s (1 + (s/K)^{n})$。将此代入上述方程：\n$$\n2\\gamma = \\frac{[\\gamma s (1 + (s/K)^{n})] n}{K} \\frac{(s/K)^{n-1}}{(1 + (s/K)^{n})^2}\n$$\n我们可以消去 $\\gamma$（因为 $\\gamma > 0$）：\n$$\n2 = \\frac{s n}{K} \\frac{(s/K)^{n-1}}{1 + (s/K)^{n}} = \\frac{n (s/K)^n}{1 + (s/K)^{n}}\n$$\n令 $u = (s/K)^n$。方程变为：\n$$\n2 = \\frac{nu}{1+u} \\implies 2(1+u) = nu \\implies 2 + 2u = nu \\implies 2 = u(n-2)\n$$\n求解 $u$：\n$$\nu = \\left(\\frac{s}{K}\\right)^n = \\frac{2}{n-2}\n$$\n对于正的稳态 $s$，我们需要 $u > 0$，这意味着该系统中广为人知的振荡条件：$n > 2$。\n由此，我们求出分岔点的稳态值：\n$$\ns = K \\left(\\frac{2}{n-2}\\right)^{1/n}\n$$\n最后，我们将 $s$ 和 $(s/K)^n$ 的表达式代回稳态方程，以求出临界产生速率 $\\alpha_c$：\n$$\n\\alpha_c = \\gamma s \\left(1 + \\left(\\frac{s}{K}\\right)^n\\right)\n$$\n我们有 $1 + (s/K)^n = 1 + \\frac{2}{n-2} = \\frac{n-2+2}{n-2} = \\frac{n}{n-2}$。\n$$\n\\alpha_c = \\gamma \\left[ K \\left(\\frac{2}{n-2}\\right)^{1/n} \\right] \\left[ \\frac{n}{n-2} \\right]\n$$\n这可以化简为用给定参数表示的 $\\alpha_c$ 的最终闭式表达式：\n$$\n\\alpha_c = \\frac{\\gamma K n}{n-2} \\left(\\frac{2}{n-2}\\right)^{1/n}\n$$\n这是最大产生速率的阈值，高于此值，稳态将变得不稳定并出现自持振荡。", "answer": "$$\\boxed{\\frac{\\gamma K n}{n-2} \\left(\\frac{2}{n-2}\\right)^{1/n}}$$", "id": "2781529"}, {"introduction": "生物系统的行为往往比简单的“开/关”转换更为复杂。本练习将探讨一种引人入胜的现象——“双节律性”(birhythmicity)，即系统可以同时存在于稳定的静息态和稳定的振荡态。通过分析一个简化的振幅方程，你将确定这种共存现象的条件，并理解“迟滞效应”(hysteresis)的概念，这是高级生物开关的一个关键特征。[@problem_id:2781540]", "problem": "一个由耦合反馈回路构成的最小双基因合成振荡器构建如下：蛋白质 $A$ 转录激活其自身的启动子（快速正反馈），同时也激活蛋白质 $R$ 的转录；蛋白质 $R$ 抑制 $A$ 的转录（通过较慢的 $R$ 累积实现延迟负反馈）。浓度 $a(t)$ 和 $r(t)$ 的确定性动力学可以用具有单调 Hill 型产生和一阶降解的常微分方程 (ODEs) 来描述，并表现出一个平衡点 $(a^{\\ast}, r^{\\ast})$，当净回路增益超过一个阈值时，该平衡点会发生振荡不稳定性。在这种振荡起始点附近，通过中心流形约化和广义 Hopf（也称为 Bautin）分岔的范式理论，可以推导出主导振荡模式的慢时间振幅 $r(t)$ 在无量纲化和相位解耦后，满足一个五次振幅方程\n$$\n\\frac{dr}{dt} \\;=\\; r\\left(\\mu \\;+\\; \\beta\\, r^{2} \\;-\\; r^{4}\\right),\n$$\n其中 $r \\ge 0$ 衡量与 $a(t)$ 关联的报告基因的振荡振幅，参数 $\\mu \\in \\mathbb{R}$ 是与 Hopf 分岔点的有符号距离（在实验中通过调节有效转录增益的诱导剂来控制），$\\beta \\in \\mathbb{R}$ 是三次非线性系数，由激活和抑制的 Hill 非线性以及分子饱和的综合形状决定。通过无量纲化，五次项系数已被缩放为 $-1$，这与有限的蛋白质合成能力相符。在耦合反馈架构中，对于振荡的硬激励（hard excitation）有研究价值的区域，实验系统辨识得出 $\\beta > 0$。\n\n仅使用上述振幅方程和标准稳定性分析，确定参数 $\\mu$ 和 $\\beta$ 在何种条件下，一个位于 $r=0$ 的稳定不动点能与一个稳定的非零极限环共存（即静态和持续振荡状态共存意义上的双节律性）。然后，计算双节律性窗口 $\\Delta \\mu$ 的宽度，表示为关于 $\\beta$ 的封闭形式解析表达式。将最终答案报告为此宽度 $\\Delta \\mu$。\n\n最后，基于含噪声单细胞动力学的第一性原理，简要解释在单细胞延时摄影追踪中，哪两种可实验观测的特征与该系统中的这种双节律性相符。你的解释应是定性的；不要将其包含在最终的数值或符号答案中。无需进行数值计算；请以精确解析形式提供 $\\Delta \\mu$，不进行四舍五入且不带单位。", "solution": "首先必须纠正问题陈述中的一个不一致之处。所给的振幅方程为\n$$\n\\frac{dr}{dt} = r\\left(\\mu + \\beta r^{2} - r^{4}\\right)\n$$\n展开后，右侧是一个五次多项式 $\\mu r + \\beta r^{3} - r^{5}$。最高次项 $r^{5}$ 的系数明确为 $-1$。然而，问题文本错误地声称“五次项系数已被缩放为 $+1$”。这存在直接矛盾。“有限的蛋白质合成能力”这一物理论证要求存在一个限制无限增长的稳定非线性项，这在动力学方程的括号中被 $-r^{4}$ 项正确地表示了。因此，我们将继续分析所给的微分方程，该方程是适定的且有物理动机的，并将相互冲突的文本描述视为一个疏忽错误而不予理会。\n\n问题要求找到双节律性的条件，其定义为一个稳定的静态和一个稳定的振荡态共存。在给定的 $r(t) \\ge 0$ 的一维振幅方程的背景下，这对应于一个在 $r=0$ 的稳定不动点和一个在某个 $r > 0$ 的稳定不动点的共存。\n\n通过设 $\\frac{dr}{dt}=0$ 来找到系统的平衡点（或不动点）$r^{\\ast}$：\n$$\nr^{\\ast}\\left(\\mu + \\beta (r^{\\ast})^{2} - (r^{\\ast})^{4}\\right) = 0\n$$\n该方程给出了不动点的两种可能性。\n\n1. 静态：$r^{\\ast}_{0} = 0$。该不动点始终存在。\n\n2. 振荡态：对于 $r^{\\ast} > 0$，不动点是括号内多项式的正实根：\n$$\n(r^{\\ast})^{4} - \\beta (r^{\\ast})^{2} - \\mu = 0\n$$\n令 $x = (r^{\\ast})^{2}$。由于 $r^{\\ast} > 0$，我们要求 $x > 0$。方程变为关于 $x$ 的二次方程：\n$$\nx^{2} - \\beta x - \\mu = 0\n$$\n使用二次方程求根公式，$x$ 的解为：\n$$\nx_{\\pm} = \\frac{\\beta \\pm \\sqrt{\\beta^{2} + 4\\mu}}{2}\n$$\n为了使 $x$ 存在实数解，判别式必须为非负：$\\beta^{2} + 4\\mu \\ge 0$，这意味着 $\\mu \\ge -\\frac{\\beta^{2}}{4}$。由于给定 $\\beta > 0$，根 $x_{+} = \\frac{\\beta + \\sqrt{\\beta^{2} + 4\\mu}}{2}$ 在其为实数时（$\\mu \\ge -\\frac{\\beta^{2}}{4}$）总是正的。另一个根 $x_{-} = \\frac{\\beta - \\sqrt{\\beta^{2} + 4\\mu}}{2}$ 只有在 $\\beta > \\sqrt{\\beta^{2} + 4\\mu}$ 时才为正，这可以简化为 $\\mu < 0$。因此，对于 $-\\frac{\\beta^{2}}{4} \\le \\mu < 0$，$x$ 有两个不同的正根，从而产生两个非零的 $r$ 不动点。对于 $\\mu \\ge 0$，只存在一个正根 $x_{+}$。\n\n接下来，我们进行线性稳定性分析以确定这些不动点的稳定性。设 $f(r) = \\mu r + \\beta r^{3} - r^{5}$。如果 $f'(r^{\\ast}) < 0$，不动点 $r^{\\ast}$ 是稳定的；如果 $f'(r^{\\ast}) > 0$，则是不稳定的。其导数为：\n$$\nf'(r) = \\frac{d}{dr}f(r) = \\mu + 3\\beta r^{2} - 5r^{4}\n$$\n- $r^{\\ast}_{0} = 0$ 的稳定性：\n其稳定性由 $f'(0) = \\mu$ 决定。静态 $r^{\\ast}_{0} = 0$ 在 $\\mu < 0$ 时稳定，在 $\\mu > 0$ 时不稳定。\n\n- 非零不动点 $r^{\\ast} > 0$ 的稳定性：\n对于这样的不动点，它满足 $\\mu = (r^{\\ast})^{4} - \\beta(r^{\\ast})^{2}$。将此代入 $f'(r^{\\ast})$ 的表达式中：\n$$\nf'(r^{\\ast}) = \\left((r^{\\ast})^{4} - \\beta(r^{\\ast})^{2}\\right) + 3\\beta(r^{\\ast})^{2} - 5(r^{\\ast})^{4} = 2\\beta(r^{\\ast})^{2} - 4(r^{\\ast})^{4} = 2(r^{\\ast})^{2}(\\beta - 2(r^{\\ast})^{2})\n$$\n由于 $2(r^{\\ast})^{2} > 0$，$f'(r^{\\ast})$ 的符号由 $(\\beta - 2(r^{\\ast})^{2})$ 的符号决定。如果 $(r^{\\ast})^{2} > \\frac{\\beta}{2}$，不动点是稳定的；如果 $(r^{\\ast})^{2} < \\frac{\\beta}{2}$，则是不稳定的。\n\n我们来分析对应于 $x_{\\pm} = (r^{\\ast})^{2}_{\\pm}$ 的不动点的稳定性。\n对应于 $x_{+} = \\frac{\\beta + \\sqrt{\\beta^{2} + 4\\mu}}{2}$ 的不动点在 $x_{+} > \\frac{\\beta}{2}$ 时是稳定的：\n$$\n\\frac{\\beta + \\sqrt{\\beta^{2} + 4\\mu}}{2} > \\frac{\\beta}{2} \\implies \\sqrt{\\beta^{2} + 4\\mu} > 0\n$$\n这对所有 $\\mu > -\\frac{\\beta^{2}}{4}$ 均成立。因此，当较大幅度的振荡态存在且与另一分支不同时，它总是稳定的。\n对应于 $x_{-} = \\frac{\\beta - \\sqrt{\\beta^{2} + 4\\mu}}{2}$ 的不动点在 $x_{-} > \\frac{\\beta}{2}$ 时是稳定的：\n$$\n\\frac{\\beta - \\sqrt{\\beta^{2} + 4\\mu}}{2} > \\frac{\\beta}{2} \\implies -\\sqrt{\\beta^{2} + 4\\mu} > 0\n$$\n这永远不成立。因此，较小幅度的振荡态总是不稳定的。\n\n双节律性要求在 $r=0$ 处的稳定不动点和一个稳定的非零不动点共存。其条件为：\n1. $r^{\\ast}_{0} = 0$ 稳定 $\\implies \\mu < 0$。\n2. 存在一个稳定的正不动点。这是对应于 $x_{+}$ 的不动点，其存在性和稳定性要求 $\\mu > -\\frac{\\beta^{2}}{4}$。\n\n结合这两个条件，双节律性的参数区域为：\n$$\n-\\frac{\\beta^{2}}{4} < \\mu < 0\n$$\n这个区间定义了双节律性窗口。下界 $\\mu = -\\frac{\\beta^{2}}{4}$ 对应于一个鞍结分岔，在此分岔点上，稳定和不稳定的极限环一同产生。上界 $\\mu = 0$ 对应于亚临界 Hopf 分岔点，在该点，不稳定的极限环与静态相撞，使其变得不稳定。\n\n该双节律性窗口的宽度 $\\Delta\\mu$ 是该区间的上界和下界之差：\n$$\n\\Delta\\mu = (0) - \\left(-\\frac{\\beta^{2}}{4}\\right) = \\frac{\\beta^{2}}{4}\n$$\n这就是所要求的解析表达式。\n\n最后，基于含噪声单细胞动力学的第一性原理，延时显微镜数据中这种双节律性的两个可实验观测的特征是：\n1.  **群体双峰性**：在双节律性参数窗口 ($-\\beta^{2}/4 < \\mu < 0$) 内的固定条件下培养的同基因细胞群体，将分化为两个不同的亚群。一个亚群将保持在静态（低而稳定的报告基因信号），而另一个亚群将表现出持续的大幅度振荡（高且周期性波动的报告基因信号）。因此，在任何给定时间，整个群体中报告基因强度的直方图将呈现双峰分布。\n2.  **随机的全或无切换**：当对单个细胞进行长期追踪时，它们可以在静态和振荡态之间表现出离散的自发切换。由于固有的分子噪声，处于静态的细胞可能会被随机地“踢”过分界线（不稳定的极限环），从而触发向稳定振荡态的突变。这是一种全或无现象，而不是振荡振幅的逐渐增加，并且是由亚临界分岔所致的硬激励系统的一个关键特征。反向转换也是可能的，尽管其发生速率可能不同。", "answer": "$$ \\boxed{\\frac{\\beta^{2}}{4}} $$", "id": "2781540"}, {"introduction": "虽然解析方法在理解局部-分岔方面非常强大，但现代合成生物学在很大程度上依赖于计算探索来绘制复杂线路的全局行为图。在这个实践中，你将编写一个程序来数值模拟一个耦合反馈振荡器，并在一系列参数范围内自动对其动态行为进行分类。这将为你提供构建“相图”的实践经验，以揭示稳定性、振荡和双稳态等不同行为区域。[@problem_id:2781485]", "problem": "一个耦合环路遗传振荡器可以由两种基因产物——一个激活物和一个阻遏物——来建模，它们的浓度演化遵循常微分方程（ODEs）。从质量平衡和具有希尔型 (Hill-type) 非线性的转录调控（一种经过充分检验的经验描述）出发，考虑以下关于激活物浓度 $x(t)$ 和阻遏物浓度 $y(t)$ 的无量纲模型：\n$$\n\\frac{dx}{dt} \\;=\\; k_x\\left[\\alpha_0 + \\alpha\\,\\frac{x^n}{K_x^n + x^n}\\right]\\cdot\\frac{1}{1 + R\\left(\\frac{y}{K_y}\\right)^m} \\;-\\; d_x\\,x,\n$$\n$$\n\\frac{dy}{dt} \\;=\\; k_y\\,\\frac{x^p}{K_{xy}^p + x^p} \\;-\\; d_y\\,y.\n$$\n第一个方程的右侧捕捉了一个正反馈环路（激活物自激活，希尔系数为 $n$），该环路乘以一个负反馈环路（由 $y$ 进行的阻遏，希尔系数为 $m$，可调强度为 $R$）。第二个方程的右侧捕捉了 $x$ 对阻遏物的激活，协同性为 $p$。所有参数均为非负值。固定以下参数：\n- $n = 3$, $m = 2$, $p = 2$,\n- $K_x = 1$, $K_y = 1$, $K_{xy} = 1$,\n- $k_x = 1$, $k_y = 1$,\n- $d_x = 1$, $d_y = 0.2$,\n- $\\alpha_0 = 0.01$,\n并将 $(\\alpha, R)$ 视为两个控制参数。\n\n您的任务是编写一个完整的、可运行的程序，对于给定的 $(\\alpha, R)$ 对集合，确定其长期动力学行为是稳态（单一吸引子不动点）、持续振荡（极限环），还是双稳态（从不同初始条件达到的两个不同的稳定不动点）。您必须仅使用数值模拟和信号分析来实现该分类，从业已给出的 ODEs 和以下基于动力系统的定义出发：\n\n- 一条轨迹被认为是稳态的，如果在暂态过程之后，$x(t)$ 和 $y(t)$ 的波动具有较小的相对振幅，并且瞬时导数的范数很小。\n- 一条轨迹被认为是振荡的，如果在暂态过程之后，它表现出具有足够大相对振幅和多个峰值的持续、非衰减的振荡。\n- 一个参数对 $(\\alpha, R)$ 被认为是双稳态的，如果两个不同的初始条件均产生趋向于不同稳定水平的非振荡轨迹。\n\n实施以下具体的数值方案，它精确地定义了分类方法：\n- 对于每个 $(\\alpha, R)$，在时间区间 $t \\in [0, T]$（其中 $T=300$）上，从两个初始条件 $z_1(0) = (x_0^{(1)}, y_0^{(1)}) = (10^{-2}, 10^{-2})$ 和 $z_2(0) = (x_0^{(2)}, y_0^{(2)}) = (5, 5)$ 对 ODEs 进行积分。在该区间内以 $N = 4000$ 个均匀间隔的时间点上对解进行采样。\n- 将每个时间序列的前 $60\\%$ 作为暂态丢弃。在剩余的 $40\\%$ 数据上：\n  - 令 $\\bar{x}$ 为 $x(t)$ 的均值，并定义相对振幅 $A_x = \\dfrac{\\max(x) - \\min(x)}{\\max(10^{-8}, \\bar{x})}$；对 $y(t)$ 类似地定义 $A_y$。\n  - 计算 $x(t)$ 中的局部最大值（峰值）数量：如果一个样本 $x_i$ 满足 $x_{i-1} < x_i > x_{i+1}$，则它是一个峰值。\n  - 如果 $A_x \\ge 0.15$ 并且分析窗口内的峰值数至少为 $3$，则单条轨迹被分类为振荡。\n  - 如果 $A_x < 0.05$、$A_y < 0.05$ 且 $\\left\\|\\left.\\frac{d}{dt}(x,y)\\right|_{t=T}\\right\\|_2 < 10^{-5}$，则单条轨迹被分类为稳态。\n- 结合两个初始条件的结果，对 $(\\alpha, R)$ 进行最终分类：\n  - 如果两条轨迹都是稳态，并且它们的最终段均值在 $x$ 或 $y$ 上相差至少 $0.2$，则分类为双稳态。\n  - 否则，如果至少有一条轨迹是振荡的，则分类为振荡。\n  - 否则，分类为稳态。\n\n为了与分岔理论建立联系，可以将稳态、振荡和双稳态区域理解为被局部稳定性通过典型分岔发生变化的曲线所分隔。特别是在 $(\\alpha,R)$-平面中，唯一稳定平衡点让位于振荡的边界预计与霍普夫 (Hopf) 分岔相关，而一个稳定平衡点变为两个的边界则与鞍结 (saddle-node) 分岔相关。平面上这些分岔曲线相交的点是余维-2 (codimension-2) 点，在二维系统中，当满足适当的非退化条件时，这些点可以包括 Bogdanov–Takens 点。\n\n实施该模型和上述分类方案，并将其应用于以下 $(\\alpha, R)$ 对的测试套件：\n- $(\\alpha, R) = (1.5, 2)$,\n- $(\\alpha, R) = (3.5, 20)$,\n- $(\\alpha, R) = (7.0, 1.0)$,\n- $(\\alpha, R) = (5.0, 30)$,\n- $(\\alpha, R) = (8.0, 0.2)$.\n\n每个测试用例所需的输出是一个整数代码：\n- $0$ 代表稳态，\n- $1$ 代表振荡，\n- $2$ 代表双稳态。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，$[0,1,2,1,2]$）。没有使用物理单位；所有量都是无量纲的。不涉及角度。本问题中的所有数值阈值和常数都是精确的，必须按规定实现。", "solution": "所提出的问题是一项计算任务，要求对给定常微分方程（ODE）系统的动力学行为进行分类，该系统模拟了一个合成遗传振荡器。问题陈述是有效的，因为它在科学上是合理的、适定的 (well-posed)、完全指定且客观的。它为这种分类提供了一个精确的数值方案，必须无偏差地实现。我的任务是执行这个方案。我不会进行超出实现要求之外的理论推测。\n\n该模型描述了激活物蛋白浓度 $x(t)$ 和阻遏物蛋白浓度 $y(t)$ 的时间演化。其动力学由以下无量纲 ODE 系统给出：\n$$\n\\frac{dx}{dt} \\;=\\; k_x\\left[\\alpha_0 + \\alpha\\,\\frac{x^n}{K_x^n + x^n}\\right]\\cdot\\frac{1}{1 + R\\left(\\frac{y}{K_y}\\right)^m} \\;-\\; d_x\\,x,\n$$\n$$\n\\frac{dy}{dt} \\;=\\; k_y\\,\\frac{x^p}{K_{xy}^p + x^p} \\;-\\; d_y\\,y.\n$$\n问题提供了一组固定参数：希尔系数 $n=3, m=2, p=2$；解离常数 $K_x=1, K_y=1, K_{xy}=1$；合成速率 $k_x=1, k_y=1$；降解速率 $d_x=1, d_y=0.2$；以及一个基础激活物表达率 $\\alpha_0=0.01$。参数 $(\\alpha, R)$ 是待变化的控制参数。\n\n任务的核心是实现一个基于数值积分的分类算法。对于每个给定的控制参数对 $(\\alpha, R)$，我们执行以下步骤：\n\n1.  **数值积分**：我们在时间区间 $t \\in [0, T]$（其中 $T=300$）上求解 ODE 系统。我们必须在 $N=4000$ 个均匀间隔的时间点上生成解。对于每个 $(\\alpha, R)$ 对，此过程执行两次，分别从两个不同的初始条件开始：$z_1(0) = (x_0^{(1)}, y_0^{(1)}) = (10^{-2}, 10^{-2})$ 和 $z_2(0) = (x_0^{(2)}, y_0^{(2)}) = (5, 5)$。这需要一个数值 ODE 求解器，SciPy 库中的 `solve_ivp` 函数很适合此用途。\n\n2.  **轨迹分析**：对于计算出的两条轨迹中的每一条，我们分析其长期行为。方案规定，丢弃时间序列数据的前 $60\\%$ 作为暂态。分析在数据的最后 $40\\%$ 上进行，即从 $t=180$ 到 $t=300$。\n    在该分析窗口内，我们为每条轨迹计算几个度量：\n    - 均值浓度 $\\bar{x}$ 和 $\\bar{y}$。\n    - 振荡的相对振幅，定义为 $A_x = \\frac{\\max(x) - \\min(x)}{\\max(10^{-8}, \\bar{x})}$ 和 $A_y = \\frac{\\max(y) - \\min(y)}{\\max(10^{-8}, \\bar{y})}$。分母经过正则化以防止除以零。\n    - $x(t)$ 时间序列中局部最大值（峰值）的数量。在时间 $t_i$ 的点 $x_i$ 如果其值大于其直接相邻点，即 $x_{i-1} < x_i > x_{i+1}$，则为一个峰值。\n    - 时间导数向量的欧几里得范数，$\\left\\|\\frac{d}{dt}(x,y)\\right\\|_2$，在最终时间点 $t=T=300$ 处计算。\n\n3.  **单轨迹分类**：基于这些度量，对每个单轨迹进行初步分类。\n    - 如果其相对振幅 $A_x$ 至少为 $0.15$ 并且 $x(t)$ 分析窗口中的峰值数量至少为 $3$，则认为轨迹是**振荡的**。\n    - 如果 $A_x < 0.05$，$A_y < 0.05$，并且最终时间导数的范数小于 $10^{-5}$，则认为轨迹是**稳态的**。\n    注意，如果一条轨迹不满足这些严格标准，它可能既不被分类为振荡也不被分类为稳态。\n\n4.  **最终系统分类**：参数对 $(\\alpha, R)$ 的最终分类是通过根据以下有序逻辑组合两个初始条件的结果来确定的：\n    - 如果两条轨迹都被分类为稳态，并且它们的分析窗口的均值差异显著，则系统被分类为**双稳态**（代码 $2$）。差异显著的条件是 $|\\bar{x}_1 - \\bar{x}_2| \\ge 0.2$ 或 $|\\bar{y}_1 - \\bar{y}_2| \\ge 0.2$。\n    - 如果不满足双稳态的条件，那么如果两条轨迹中至少有一条被分类为振荡，则系统被分类为**振荡**（代码 $1$）。\n    - 否则，系统被分类为**稳态**（代码 $0$）。\n\n这个严谨的多步骤方案将“稳态”、“振荡”和“双稳态”等定性概念转化为一个具体、确定性的算法。实现将为每个指定的测试用例精确遵循此程序。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the synthetic oscillator classification problem by implementing the\n    specified numerical protocol.\n    \"\"\"\n\n    # --- Fixed model parameters ---\n    n = 3.0\n    m = 2.0\n    p = 2.0\n    K_x = 1.0\n    K_y = 1.0\n    K_xy = 1.0\n    k_x = 1.0\n    k_y = 1.0\n    d_x = 1.0\n    d_y = 0.2\n    alpha_0 = 0.01\n\n    def ode_system(t, z, alpha, R):\n        \"\"\"\n        Defines the system of ordinary differential equations for the synthetic oscillator.\n        z = [x, y], where x is activator and y is repressor concentration.\n        \"\"\"\n        x, y = z\n        \n        # Avoid division by zero or negative concentrations, though solver should handle it\n        x = max(0, x)\n        y = max(0, y)\n\n        # Activator equation\n        positive_feedback = alpha * (x**n) / (K_x**n + x**n)\n        repression = 1.0 / (1.0 + R * (y / K_y)**m)\n        dxdt = k_x * (alpha_0 + positive_feedback) * repression - d_x * x\n\n        # Repressor equation\n        activation_of_repressor = k_y * (x**p) / (K_xy**p + x**p)\n        dydt = activation_of_repressor - d_y * y\n\n        return [dxdt, dydt]\n\n    def analyze_trajectory(t, z, alpha, R):\n        \"\"\"\n        Analyzes a single trajectory according to the problem's protocol.\n        \"\"\"\n        x, y = z\n        N = len(t)\n        \n        # Define the analysis window (last 40% of the data)\n        analysis_start_index = int(0.6 * N)\n        x_analysis = x[analysis_start_index:]\n        y_analysis = y[analysis_start_index:]\n        \n        # --- Calculate metrics for classification ---\n\n        # 1. Relative amplitudes\n        mean_x = np.mean(x_analysis)\n        mean_y = np.mean(y_analysis)\n        \n        # Denominator regularized as per problem statement\n        ax_denom = np.max([1e-8, mean_x])\n        ay_denom = np.max([1e-8, mean_y])\n        \n        A_x = (np.max(x_analysis) - np.min(x_analysis)) / ax_denom\n        A_y = (np.max(y_analysis) - np.min(y_analysis)) / ay_denom\n        \n        # 2. Number of peaks in x(t)\n        # A peak is x_i where x_{i-1} < x_i > x_{i+1}\n        peaks = np.sum((x_analysis[1:-1] > x_analysis[:-2]) & (x_analysis[1:-1] > x_analysis[2:]))\n\n        # 3. Norm of the derivative at the final time point\n        z_final = z[:, -1]\n        dzdt_final = ode_system(t[-1], z_final, alpha, R)\n        norm_deriv = np.linalg.norm(dzdt_final)\n        \n        # --- Classify the single trajectory ---\n        is_oscillatory = (A_x >= 0.15 and peaks >= 3)\n        is_steady = (A_x  0.05 and A_y  0.05 and norm_deriv  1e-5)\n        \n        return is_oscillatory, is_steady, mean_x, mean_y\n\n    # --- Simulation setup ---\n    T = 300.0\n    N = 4000\n    t_span = [0, T]\n    t_eval = np.linspace(t_span[0], t_span[1], N)\n    \n    # Initial conditions\n    z0_1 = [1e-2, 1e-2]\n    z0_2 = [5.0, 5.0]\n\n    # Test cases from the problem statement\n    test_cases = [\n        (1.5, 2),\n        (3.5, 20),\n        (7.0, 1.0),\n        (5.0, 30),\n        (8.0, 0.2),\n    ]\n\n    results = []\n\n    # --- Main loop to process each test case ---\n    for alpha, R in test_cases:\n        # --- Run simulation for initial condition 1 ---\n        sol1 = solve_ivp(\n            fun=lambda t, z: ode_system(t, z, alpha, R),\n            t_span=t_span,\n            y0=z0_1,\n            t_eval=t_eval,\n            method='RK45', \n            rtol=1e-6, \n            atol=1e-9\n        )\n        is_osc1, is_steady1, mean_x1, mean_y1 = analyze_trajectory(sol1.t, sol1.y, alpha, R)\n\n        # --- Run simulation for initial condition 2 ---\n        sol2 = solve_ivp(\n            fun=lambda t, z: ode_system(t, z, alpha, R),\n            t_span=t_span,\n            y0=z0_2,\n            t_eval=t_eval,\n            method='RK45',\n            rtol=1e-6,\n            atol=1e-9\n        )\n        is_osc2, is_steady2, mean_x2, mean_y2 = analyze_trajectory(sol2.t, sol2.y, alpha, R)\n        \n        # --- Final classification based on the two trajectories ---\n        # The logic follows the if-elif-else structure specified in the problem.\n        \n        # Condition for bistability: both steady and means are different.\n        means_are_different = (abs(mean_x1 - mean_x2) >= 0.2 or abs(mean_y1 - mean_y2) >= 0.2)\n        \n        if is_steady1 and is_steady2 and means_are_different:\n            # Code 2 for bistable\n            result = 2\n        elif is_osc1 or is_osc2:\n            # Code 1 for oscillatory\n            result = 1\n        else:\n            # Code 0 for steady state\n            result = 0\n            \n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2781485"}]}