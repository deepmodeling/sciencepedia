{"hands_on_practices": [{"introduction": "转录调控的核心在于调控蛋白（如阻遏蛋白）与 DNA 上特定算子序列的相互作用。利用统计力学框架，我们可以将不同结合构象的自由能与它们的统计权重联系起来，从而量化基因的阻遏水平。这个练习 [@problem_id:2755180] 将引导您从基本原理出发，构建一个热力学模型，通过比较单体和二聚体阻遏蛋白的调控效果，来深入理解蛋白质的寡聚化状态如何直接影响其调控功能。", "problem": "您正在一个细菌合成基因回路中设计一种转录阻遏蛋白。该操纵子由两个相邻的回文半位点组成，它们共同与核心启动子重叠，因此阻遏蛋白的任何占据都会排斥核糖核酸聚合酶 (RNAP) 并阻止转录起始。最初，该阻遏蛋白是单体形式，能以相同的每个半位点的结合自由能 $\\epsilon_{h}$（以 $k_{B} T$ 为单位）独立地结合到每个半位点上，其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。细胞中阻遏蛋白的有效可用性由一个标准热力学模型描述，该模型包含一个大小为 $N_{ns}$ 的非特异性脱氧核糖核酸 (DNA) 库和总数为 $R$ 的阻遏蛋白分子，因此无量纲浓度参数为 $\\rho \\equiv R/N_{ns}$。假设 $R \\ll N_{ns}$，因此 $\\rho$ 很小但为有限值。在单体状态下，操纵子可以处于三种排斥 RNAP 的阻遏蛋白结合构象：左半位点被占据，右半位点被占据，或两个半位点都被占据。\n\n然后，您通过融合一个具有二聚化自由能 $\\Delta \\epsilon_{dim}$（以 $k_{B} T$ 为单位）的二聚化结构域，将该阻遏蛋白转化为二聚体。在所设计的二聚体方案中，阻遏作用主要通过一个跨越并同时结合两个半位点的二聚体发生；在此设计中，单个单体与一个半位点的结合可以忽略不计。在转录调控的平衡统计力学框架内，假设二聚体与两个半位点的结合状态，等效于两个单体的双占据状态在两个亚基都存在于操纵子上时获得了一个额外的相互作用自由能 $\\Delta \\epsilon_{dim}$，因此二聚体结合态的总结合自由能为 $2 \\epsilon_{h} + \\Delta \\epsilon_{dim}$。\n\n将阻遏因子 $\\mathcal{R}$ 定义为相对于无阻遏蛋白参照系的表达量倍数变化的倒数，即 $\\mathcal{R} \\equiv 1/\\text{fold-change}$。对于一个简单的阻遏结构，该因子等于 $1$ 加上所有排斥 RNAP 的阻遏蛋白结合态的统计权重之和。利用此定义和上述假设，推导出一个关于 $\\rho$、$\\epsilon_{h}$ 和 $\\Delta \\epsilon_{dim}$ 的封闭形式解析表达式，用于表示转化为二聚体设计后阻遏作用的变化，该变化量化为比率 $\\mathcal{R}_{dimer}/\\mathcal{R}_{mono}$。将您的最终答案表示为单个简化的解析表达式。无需进行数值计算。", "solution": "我们从一个简单阻遏结构的转录调控平衡热力学模型开始。启动子具有转录活性的概率，与操纵子未被阻遏蛋白占据的概率成正比。在 RNAP 弱结合极限下，表达量的倍数变化由操纵子未被阻遏蛋白结合的概率给出，该概率等于未结合态的统计权重除以所有与阻遏蛋白排斥 RNAP 相容的状态的总统计权重。将未结合态的权重归一化为1，则定义为 $\\mathcal{R} \\equiv 1/\\text{fold-change}$ 的阻遏因子变为\n$$\n\\mathcal{R} = 1 + \\sum_{\\text{repressor-bound states}} \\text{(statistical weight)}.\n$$\n\n我们采用标准的非特异性 DNA 库模型，其中将一个阻遏蛋白单体放置在特定半位点上的统计权重为 $\\rho \\exp(-\\epsilon_{h})$，其中 $\\rho \\equiv R/N_{ns}$，且所有能量都以 $k_{B} T$ 为单位表示，因此玻尔兹曼因子为 $\\exp(-\\text{energy})$。\n\n单体阻遏蛋白（基线）：\n- 有两个半位点，每个都可以被单个占据，从而产生两种不同的单占据状态。每个单占据状态的权重为 $\\rho \\exp(-\\epsilon_{h})$，因此单占据状态的总权重为\n$$\n2 \\, \\rho \\exp(-\\epsilon_{h}).\n$$\n- 两个半位点可以同时被两个单体占据。假设对于单体基线，结合是独立的，没有额外的相互作用能，则双占据状态的权重是两个位点权重的乘积，\n$$\n\\left[\\rho \\exp(-\\epsilon_{h})\\right]^{2} = \\rho^{2} \\exp(-2 \\epsilon_{h}).\n$$\n所有这些阻遏蛋白结合态都排斥核糖核酸聚合酶 (RNAP)，因此单体情况下的阻遏因子为\n$$\n\\mathcal{R}_{mono} = 1 + 2 \\rho \\exp(-\\epsilon_{h}) + \\rho^{2} \\exp(-2 \\epsilon_{h}).\n$$\n\n设计的二聚体阻遏蛋白：\n- 在设计的二聚体方案中，阻遏作用主要通过一个跨越两个相邻半位点的二聚体发生。该状态可以看作是双占据构象被赋予了一个额外的相互作用（二聚化）自由能 $\\Delta \\epsilon_{dim}$。因此，二聚体结合的操纵子的统计权重是双占据权重乘以该相互作用的玻尔兹曼因子：\n$$\n\\rho^{2} \\exp\\!\\left[-2 \\epsilon_{h} - \\Delta \\epsilon_{dim}\\right].\n$$\n- 根据该工程设计，与二聚体结合相比，单个单体与一个半位点的结合可以忽略不计。\n\n因此，二聚体情况下的阻遏因子为\n$$\n\\mathcal{R}_{dimer} = 1 + \\rho^{2} \\exp\\!\\left(-2 \\epsilon_{h} - \\Delta \\epsilon_{dim}\\right).\n$$\n\n所要求的阻遏作用变化是以下比率\n$$\n\\frac{\\mathcal{R}_{dimer}}{\\mathcal{R}_{mono}} \\;=\\; \\frac{1 + \\rho^{2} \\exp\\!\\left(-2 \\epsilon_{h} - \\Delta \\epsilon_{dim}\\right)}{1 + 2 \\rho \\exp(-\\epsilon_{h}) + \\rho^{2} \\exp(-2 \\epsilon_{h})}.\n$$\n\n该表达式完全由 $\\rho$、$\\epsilon_{h}$ 和 $\\Delta \\epsilon_{dim}$ 定义，所有能量均以 $k_{B} T$ 为单位。它描述了有利的二聚化（即 $\\Delta \\epsilon_{dim} < 0$）如何相对于单体基线增加二聚体结合态的统计权重，从而改变阻遏因子。", "answer": "$$\\boxed{\\frac{1+\\rho^{2}\\,\\exp\\!\\left(-2\\epsilon_{h}-\\Delta\\epsilon_{dim}\\right)}{1+2\\rho\\,\\exp\\!\\left(-\\epsilon_{h}\\right)+\\rho^{2}\\,\\exp\\!\\left(-2\\epsilon_{h}\\right)}}$$", "id": "2755180"}, {"introduction": "在合成生物学中，设计可预测的基因开关是实现复杂功能的关键，这通常通过变构调控来实现，即利用小分子诱导剂来控制阻遏蛋白的活性。剂量-响应曲线的陡峭程度（即开关的“灵敏性”）是一个核心设计参数，通常用希尔系数 ($n_H$) 来表征。本练习 [@problem_id:2755183] 旨在揭示开关行为的分子起源，它将指导您推导诱导剂结合的微观协同性 ($\\omega$) 如何决定宏观可测量的希尔系数 ($n_H$)，从而将分子设计与系统行为联系起来。", "problem": "一个合成的阻遏转录因子 (TF) 是一个同源二聚体，具有两个相同的诱导物结合位点，用于结合浓度为 $[L]$ 的小分子配体。根据质量作用定律，每个位点以微观结合常数 $K_{\\ell}$ 与配体结合。这两个配体结合事件通过一个无量纲的协同参数 $\\omega$ 耦合，使得双配体结合状态的统计权重相对于独立位点情况乘以 $\\omega$。该 TF 仅在未结合配体时才与脱氧核糖核酸 (DNA) 上的操纵子结合；任何结合了配体的 TF 都被认为不具有 DNA 结合活性。在具有单个操纵子和低 DNA 拷贝数的热力学平衡状态下，相对于非阻遏水平的基因表达倍数变化由 $y = 1/(1 + \\Lambda f_{\\mathrm{A}})$ 建模，其中 $f_{\\mathrm{A}}$ 是处于有 DNA 结合能力的 TF 分子所占的比例，$\\Lambda = R_{\\mathrm{T}}/K_{\\mathrm{O}}$，$R_{\\mathrm{T}}$ 是 TF 的总丰度，$K_{\\mathrm{O}}$ 是操纵子解离常数。假设 $K_{\\ell}$、$\\omega$ 和 $\\Lambda$ 相对于 $[L]$ 是常数，并且与转录起始相比，所有平衡都很快，这与转录调控的准平衡控制一致。\n\n仅使用基本原理（质量作用定律、通过结合多项式描述的结合统计热力学以及用于阻遏的平衡占据模型），推导由操纵子介导的剂量反应 $y([L])$ 的表观 Hill 系数 $n_{\\mathrm{H}}$，其定义为半最大激活时 Hill 变换的斜率：\n$$\nn_{\\mathrm{H}} \\equiv \\left.\\frac{d \\ln\\!\\left(\\frac{y}{1-y}\\right)}{d \\ln [L]}\\right|_{y=1/2}.\n$$\n考虑一个具有协同配体结合 $\\omega = 10$ 的野生型 TF 和一个破坏了协同性使得配体结合位点独立的突变体 $\\omega = 1$。对于这两种情况，取 $\\Lambda = 10$。计算半最大激活时的表观 Hill 系数之比，\n$$\n\\frac{n_{\\mathrm{H}}(\\omega=10)}{n_{\\mathrm{H}}(\\omega=1)},\n$$\n并将其报告为一个纯数字。将您的答案四舍五入到三位有效数字。", "solution": "该问题要求为一个简单的转录阻遏模型推导表观 Hill 系数，并计算配体结合协同参数 $\\omega$ 取两个不同值时该系数的比率。整个推导过程必须按照规定从第一性原理出发。\n\n首先，我们必须确定转录因子 (TF) 二聚体的状态及其统计权重。该 TF 是一个具有两个相同配体结合位点的同源二聚体。设 $P$ 代表 TF 二聚体，$L$ 代表配体。该系统涉及以下处于平衡状态的物种：未结合配体的 TF ($P$)、单配体结合的 TF ($PL$) 和双配体结合的 TF ($PL_2$)。根据统计热力学原理，我们定义一个结合多项式 $\\mathcal{Z}$，它是所有可能状态的统计权重之和。未结合配体状态 $P$ 的权重被作为参考，其值为 $1$。\n\n单配体结合状态 $PL$ 可以通过 $\\binom{2}{1} = 2$ 种方式形成。每个结合事件都与项 $K_{\\ell}[L]$ 相关，其中 $K_{\\ell}$ 是微观结合常数，$[L]$ 是配体浓度。因此，$PL$ 状态的统计权重是 $2 K_{\\ell} [L]$。\n\n双配体结合状态 $PL_2$ 是通过结合两个配体形成的。在位点独立的情况下，其权重应为 $(K_{\\ell}[L])^2$。问题指出，一个协同参数 $\\omega$ 会乘以这个权重。因此，$PL_2$ 状态的统计权重是 $\\omega (K_{\\ell}[L])^2$。\n\n结合多项式是配体结合过程的配分函数，它是这些权重之和：\n$$\n\\mathcal{Z}([L]) = 1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2\n$$\n\n问题指出，只有未结合配体的 TF 才具有 DNA 结合能力。这种形式是“活性”阻遏物，我们将其表示为状态 $A$。处于此活性状态的 TF 比例 $f_{\\mathrm{A}}$ 是活性状态的权重与所有权重之和的比值：\n$$\nf_{\\mathrm{A}}([L]) = \\frac{1}{\\mathcal{Z}([L])} = \\frac{1}{1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2}\n$$\n\n基因表达的倍数变化 $y$ 由热力学阻遏模型给出：\n$$\ny([L]) = \\frac{1}{1 + \\Lambda f_{\\mathrm{A}}([L])}\n$$\n其中 $\\Lambda = R_{\\mathrm{T}}/K_{\\mathrm{O}}$ 是一个代表阻遏物效力的常数。\n\n表观 Hill 系数 $n_{\\mathrm{H}}$ 在半最大激活点 $y=1/2$ 处定义为：\n$$\nn_{\\mathrm{H}} \\equiv \\left.\\frac{d \\ln\\!\\left(\\frac{y}{1-y}\\right)}{d \\ln [L]}\\right|_{y=1/2}\n$$\n为了计算这个值，我们首先找到 Hill 变换 $\\ln\\left(\\frac{y}{1-y}\\right)$ 的表达式。根据 $y$ 的表达式，我们有：\n$$\n1-y = 1 - \\frac{1}{1 + \\Lambda f_{\\mathrm{A}}} = \\frac{1 + \\Lambda f_{\\mathrm{A}} - 1}{1 + \\Lambda f_{\\mathrm{A}}} = \\frac{\\Lambda f_{\\mathrm{A}}}{1 + \\Lambda f_{\\mathrm{A}}}\n$$\n那么比值为：\n$$\n\\frac{y}{1-y} = \\frac{1/(1 + \\Lambda f_{\\mathrm{A}})}{\\Lambda f_{\\mathrm{A}}/(1 + \\Lambda f_{\\mathrm{A}})} = \\frac{1}{\\Lambda f_{\\mathrm{A}}}\n$$\n取自然对数得到 Hill 变换：\n$$\n\\ln\\left(\\frac{y}{1-y}\\right) = \\ln\\left(\\frac{1}{\\Lambda f_{\\mathrm{A}}}\\right) = -\\ln(\\Lambda) - \\ln(f_{\\mathrm{A}})\n$$\n代入 $f_{\\mathrm{A}}$ 的表达式：\n$$\n\\ln\\left(\\frac{y}{1-y}\\right) = -\\ln(\\Lambda) - \\ln\\left((1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2)^{-1}\\right) = -\\ln(\\Lambda) + \\ln(1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2)\n$$\n现在，我们对 $\\ln[L]$ 求导以求得 $n_{\\mathrm{H}}$。使用链式法则，$\\frac{d}{d\\ln[L]} = [L]\\frac{d}{d[L]}$：\n$$\nn_{\\mathrm{H}} = \\frac{d}{d \\ln [L]} \\left[-\\ln(\\Lambda) + \\ln(1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2)\\right]\n$$\n常数项 $-\\ln(\\Lambda)$ 的导数为零。\n$$\nn_{\\mathrm{H}} = [L] \\frac{d}{d[L]} \\ln(1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2)\n$$\n$$\nn_{\\mathrm{H}} = [L] \\frac{2 K_{\\ell} + 2 \\omega K_{\\ell}^2 [L]}{1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2} = \\frac{2 K_{\\ell} [L] + 2 \\omega (K_{\\ell} [L])^2}{1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2}\n$$\n我们定义一个无量纲浓度 $u = K_{\\ell}[L]$。$n_{\\mathrm{H}}$ 的表达式简化为：\n$$\nn_{\\mathrm{H}}(u) = \\frac{2u + 2\\omega u^2}{1 + 2u + \\omega u^2}\n$$\n该表达式必须在 $y = 1/2$ 的点进行计算。条件 $y=1/2$ 意味着 $\\frac{y}{1-y}=1$，即 $\\frac{1}{\\Lambda f_{\\mathrm{A}}} = 1$，或 $\\Lambda f_{\\mathrm{A}} = 1$。代入 $f_{\\mathrm{A}}$：\n$$\n\\frac{\\Lambda}{1 + 2 K_{\\ell} [L] + \\omega (K_{\\ell} [L])^2} = 1\n$$\n用 $u$ 表示，此条件为 $1 + 2u + \\omega u^2 = \\Lambda$。设 $u_{1/2}$ 是满足此条件的 $u$ 值。这是一个关于 $u_{1/2}$ 的二次方程：\n$$\n\\omega u_{1/2}^2 + 2u_{1/2} + (1 - \\Lambda) = 0\n$$\n使用二次公式求解 $u_{1/2}$，并取有物理意义的正根（因为 $u=K_{\\ell}[L] > 0$）：\n$$\nu_{1/2} = \\frac{-2 + \\sqrt{4 - 4\\omega(1-\\Lambda)}}{2\\omega} = \\frac{-1 + \\sqrt{1 + \\omega(\\Lambda-1)}}{\\omega}\n$$\n在这个特定的点， $n_{\\mathrm{H}}$ 表达式的分母就是 $\\Lambda$。对于分子，我们可以使用二次方程：$\\omega u_{1/2}^2 = \\Lambda - 1 - 2u_{1/2}$。\n$$\nn_{\\mathrm{H}}|_{y=1/2} = \\frac{2u_{1/2} + 2\\omega u_{1/2}^2}{\\Lambda} = \\frac{2u_{1/2} + 2(\\Lambda - 1 - 2u_{1/2})}{\\Lambda} = \\frac{2\\Lambda - 2 - 2u_{1/2}}{\\Lambda} = 2 - \\frac{2(1+u_{1/2})}{\\Lambda}\n$$\n代入 $u_{1/2}$ 的表达式：\n$$\nn_{\\mathrm{H}} = 2 - \\frac{2}{\\Lambda}\\left(1 + \\frac{\\sqrt{1 + \\omega(\\Lambda-1)} - 1}{\\omega}\\right) = 2 - \\frac{2}{\\omega\\Lambda}\\left(\\omega + \\sqrt{1 + \\omega(\\Lambda-1)} - 1\\right)\n$$\n一个等价的，也许更直接的表示方法是：\n$$\nn_{\\mathrm{H}} = \\frac{2(\\Lambda - 1 - u_{1/2})}{\\Lambda} = \\frac{2}{\\Lambda} \\left( \\Lambda-1 - \\frac{\\sqrt{1+\\omega(\\Lambda-1)}-1}{\\omega} \\right) = \\frac{2}{\\omega\\Lambda} \\left( \\omega(\\Lambda-1) - \\sqrt{1+\\omega(\\Lambda-1)} + 1 \\right)\n$$\n现在我们使用这个最终公式来计算给定两种情况下（$\\Lambda=10$）的 $n_{\\mathrm{H}}$。公式变为：\n$$\nn_{\\mathrm{H}}(\\omega) = \\frac{2}{10\\omega} (9\\omega - \\sqrt{1+9\\omega} + 1) = \\frac{1}{5\\omega} (9\\omega + 1 - \\sqrt{1+9\\omega})\n$$\n情况 1：具有独立位点的突变体，$\\omega=1$。\n$$\nn_{\\mathrm{H}}(\\omega=1) = \\frac{1}{5(1)} (9(1) + 1 - \\sqrt{1+9(1)}) = \\frac{1}{5} (10 - \\sqrt{10})\n$$\n情况 2：具有协同结合的野生型，$\\omega=10$。\n$$\nn_{\\mathrm{H}}(\\omega=10) = \\frac{1}{5(10)} (9(10) + 1 - \\sqrt{1+9(10)}) = \\frac{1}{50} (91 - \\sqrt{91})\n$$\n问题要求计算这两个值的比率：\n$$\n\\frac{n_{\\mathrm{H}}(\\omega=10)}{n_{\\mathrm{H}}(\\omega=1)} = \\frac{\\frac{1}{50} (91 - \\sqrt{91})}{\\frac{1}{5} (10 - \\sqrt{10})} = \\frac{5}{50} \\frac{91 - \\sqrt{91}}{10 - \\sqrt{10}} = \\frac{1}{10} \\frac{91 - \\sqrt{91}}{10 - \\sqrt{10}}\n$$\n现在，我们计算数值。\n$$\n\\sqrt{10} \\approx 3.16227766\n$$\n$$\n\\sqrt{91} \\approx 9.53939201\n$$\n$$\n\\frac{n_{\\mathrm{H}}(\\omega=10)}{n_{\\mathrm{H}}(\\omega=1)} = \\frac{1}{10} \\frac{91 - 9.53939201}{10 - 3.16227766} = \\frac{1}{10} \\frac{81.46060799}{6.83772234} \\approx \\frac{1}{10} (11.91341) \\approx 1.191341\n$$\n四舍五入到三位有效数字，结果是 $1.19$。", "answer": "$$\\boxed{1.19}$$", "id": "2755183"}, {"introduction": "基因调控并非孤立发生，DNA 分子本身的物理特性也扮演着至关重要的角色，尤其是在涉及多个算子位点的情况下。DNA 成环是一种常见的调控机制，其间DNA的力学性质会直接影响阻遏强度。这个动手编程练习 [@problem_id:2755169] 将指导您建立一个生物物理模型，该模型能够捕捉DNA的螺旋周期性与弯曲弹性之间的相互作用，并解释为何阻遏水平会随算子间距呈周期性振荡。通过将该模型拟合到合成数据，您将实践一项定量生物学的关键技能：从实验数据中提取如DNA螺旋周期 ($P$) 等基本物理参数。", "problem": "一种与两个算子序列结合的蛋白质阻遏物可以形成一个DNA环。转录阻遏的强度作为算子间距的函数，受脱氧核糖核酸（DNA）力学的两个基本方面控制：算子的螺旋扭转对齐和成环概率。在合成生物学领域，这种效应的物理基础可以从分子生物学的中心法则（脱氧核糖核酸到核糖核酸到蛋白质）、结合的平衡统计力学以及用于描述DNA弹性的蠕虫状链模型中推导出来。螺旋扭转引入了对算子间距的周期性依赖，而成环概率则因弯曲能量成本和构象熵的损失而随着环长度的增加而降低。综合这些考虑，阻遏与算子间距的关系应由一个模型来描述，该模型结合了一个周期性的螺旋项（具有以碱基对为单位的特征性螺旋重复周期）和一个捕捉成环惩罚的衰减包络。\n\n您的任务是：\n- 根据上述基本原理，推导一个最小参数模型，该模型结合了对间距的周期性螺旋依赖和用于成环的衰减包络，以及一个捕捉未阻遏水平的基线。该模型必须包含以下可识别参数：螺旋重复周期 $P$（单位：碱基对）、衰减长度 $L_{d}$（单位：碱基对）、相位偏移 $\\phi$（单位：弧度）、振幅 $A$（无量纲）和基线 $B$（无量纲）。\n- 使用您推导的模型，对多个测试用例的阻遏与间距关系的合成数据集进行拟合，并报告拟合后的参数值。\n\n用于指导推导和建模的假设：\n- 螺旋扭转对齐贡献一个单一的主导周期性分量，其周期等于DNA的螺旋重复周期 $P$，并带有一个由算子的相对旋转朝向决定的未知相位 $\\phi$。\n- 形成长度为 $s$ 的环的概率根据一个有效衰减长度 $L_{d}$ 随 $s$ 衰减，这个衰减长度捕捉了在所探测的环尺寸范围内弯曲弹性和熵的综合效应。\n- 测量的阻遏是一个无量纲量。\n- 角度必须以弧度而非度来处理。报告 $P$ 和 $L_{d}$ 的单位为碱基对，报告 $\\phi$ 的单位为弧度。报告 $A$ 和 $B$ 为无量纲量。\n- 您不得导入任何外部数据；所有计算必须是自包含的。\n\n测试套件规范：\n- 对于下面的每个测试用例，通过将您推导的模型应用于指定算子间距 $s$（单位：碱基对）下的给定参数值，来合成无噪声测量值。也就是说，每个间距处的测量值是使用所列参数值在该间距处评估您推导的模型得到的值。然后将您的模型拟合回这些合成数据，以恢复参数估计值。\n\n测试用例 1 (理想情况):\n- 真实参数: $P = 10.5$ (bp), $L_{d} = 120.0$ (bp), $\\phi = 0.5$ (rad), $A = 2.0$, $B = 10.0$。\n- 间距 $s$ (bp): $[60, 66, 72, 78, 84, 90, 96, 102, 108, 114, 120, 126, 132, 138, 144]$。\n\n测试用例 2 (小振荡幅度):\n- 真实参数: $P = 10.7$ (bp), $L_{d} = 80.0$ (bp), $\\phi = -1.0$ (rad), $A = 0.2$, $B = 5.0$。\n- 间距 $s$ (bp): $[40, 46, 52, 58, 64, 70, 76, 82, 88, 94, 100, 106, 112, 118, 124]$。\n\n测试用例 3 (快速衰减的成环概率):\n- 真实参数: $P = 11.0$ (bp), $L_{d} = 30.0$ (bp), $\\phi = 1.2$ (rad), $A = 3.0$, $B = 8.0$。\n- 间距 $s$ (bp): $[30, 36, 42, 48, 54, 60, 66, 72, 78, 84, 90, 96, 102, 108, 114]$。\n\n要求输出：\n- 对每个测试用例，将您的模型拟合到合成数据，并估计参数向量 $[P, L_{d}, \\phi, A, B]$。\n- 您的程序应生成单行输出，其中包含一个由三个列表组成的逗号分隔列表，每个测试用例一个列表，并用方括号括起来。每个内部列表必须按 $[P, L_{d}, \\phi, A, B]$ 的顺序排列，其中 $P$ 和 $L_{d}$ 的单位是碱基对，$\\phi$ 的单位是弧度，而 $A$ 和 $B$ 是无量纲的。将报告的每个数字四舍五入到恰好三位小数。例如，输出应类似于 $[[x_{11},x_{12},x_{13},x_{14},x_{15}],[x_{21},x_{22},x_{23},x_{24},x_{25}],[x_{31},x_{32},x_{33},x_{34},x_{35}]]$，其中每个 $x_{ij}$ 是一个四舍五入到三位小数的十进制字面量。\n\n评分和覆盖范围：\n- 测试套件涵盖：一个具有中等衰减和清晰周期性的典型案例（测试用例 $1$），一个小振幅振荡，对螺旋周期的恢复构成挑战（测试用例 $2$），以及一个短衰减长度，其中只有前几个振荡是可见的（测试用例 $3$）。\n- 考虑到无噪声合成和正确推导，预期的正确结果是与每个案例的生成参数接近的浮点数。\n\n实现约束：\n- 最终答案必须是一个完整的、可在Python中运行的程序，该程序能根据上述参数值构建合成数据集，使用有数学依据的算法拟合您推导的模型，并以确切要求的格式打印出拟合的参数。", "solution": "该问题已经过严格验证，被认为是有效的。它在DNA生物物理学方面有科学依据，问题定义明确，并以客观、可形式化的术语表达。它不违反任何无效标准。该任务是生物物理建模中的一个标准练习：从第一性原理推导唯象模型，并对合成数据进行参数估计。\n\n作为算子间距 $s$ 函数的阻遏水平 $R(s)$ 模型的推导，源于问题陈述中概述的基本原理。总阻遏被认为是基线水平和来自DNA成环的依赖于间距的贡献的叠加。\n\n$1$. **模型结构**：总阻遏 $R(s)$ 是一个恒定基线 $B$ 与一个描述DNA成环效应的项 $R_{\\text{looping}}(s)$ 的和。基线 $B$ 代表未阻遏状态或基础转录水平。\n$$\nR(s) = B + R_{\\text{looping}}(s)\n$$\n\n$2$. **成环贡献**：一个稳定的、具有阻遏作用的DNA环的形成，取决于两个协同作用的主要物理因素：DNA链末端在空间中相遇的统计概率，以及它们相遇时的相对螺旋朝向。因此，成环项 $R_{\\text{looping}}(s)$ 与一个模拟成环概率的衰减项和一个模拟螺旋对齐的周期项的乘积成正比。该效应的幅度由一个振幅参数 $A$ 进行缩放。\n\n$3$. **衰减包络（成环概率）**：问题陈述指出，形成长度为 $s$ 的DNA环的概率随一个有效衰减长度 $L_d$ 而衰减。这种衰减唯象地捕捉了弯曲能量惩罚（不利于短环）和构象熵损失（不利于长环）的综合效应。表示由特征长度控制的衰减过程的最简单数学形式是指数衰减。因此，衰减包络建模为：\n$$\n\\text{Envelope}(s) \\propto e^{-s/L_d}\n$$\n其中 $L_d$ 是以碱基对为单位的衰减长度。\n\n$4$. **周期项（螺旋对齐）**：B型DNA具有螺旋结构。为了使两个算子共面对齐以进行蛋白质结合和成环，它们沿螺旋线的角分离必须是 $2\\pi$ 弧度的整数倍。在每个匝有 $P$ 个碱基对的螺旋上，相距 $s$ 个碱基对的两个位点之间的相对角度是 $\\frac{2\\pi s}{P}$。余弦函数自然地描述了这种对最佳对齐的周期性要求。引入一个额外的相位偏移 $\\phi$，以解释算子序列在DNA骨架上的特定旋转朝向。因此，周期性分量为：\n$$\n\\text{Periodic}(s) = \\cos\\left(\\frac{2\\pi s}{P} + \\phi\\right)\n$$\n\n$5$. **完整模型组装**：结合这些分量，依赖于成环的阻遏项是振幅、衰减包络和周期项的乘积。将其与基线 $B$ 相加，得到关于算子间距 $s$ 的阻遏 $R(s)$ 的最终最小参数模型：\n$$\nR(s) = A \\cdot e^{-s/L_d} \\cdot \\cos\\left(\\frac{2\\pi s}{P} + \\phi\\right) + B\n$$\n该模型包含五个所需的可识别参数：螺旋重复周期 $P$（碱基对）、衰减长度 $L_d$（碱基对）、相位偏移 $\\phi$（弧度）、无量纲振幅 $A$ 和无量纲基线 $B$。\n\n**参数估计**：为了找到每个测试用例的参数 $[P, L_d, \\phi, A, B]$，我们必须将推导的模型 $R(s)$ 拟合到所提供的数据。由于参数和因变量 $R(s)$ 之间的关系是非线性的，需要使用非线性最小二乘拟合算法。目标是找到一组参数 $\\theta = \\{P, L_d, \\phi, A, B\\}$，使得在间距 $s_i$ 处的合成测量值 $y_i$ 与模型预测值 $R(s_i; \\theta)$ 之间差值的平方和最小。要最小化的目标函数是残差平方和 $\\chi^2$：\n$$\n\\chi^2(\\theta) = \\sum_{i} \\left( y_i - R(s_i; \\theta) \\right)^2\n$$\n`scipy.optimize.curve_fit` 函数实现了Levenberg-Marquardt算法，是完成此任务的合适工具。为确保收敛到物理上有意义的解，需要提供初始参数猜测值和边界。\n- **初始猜测值**：DNA的螺旋周期 $P$ 已知约为 $10.5$ bp。基线 $B$ 可从数据的平均值估计，振幅 $A$ 可从数据的范围估计。衰减长度 $L_d$ 可从算子间距的跨度粗略估计。相位偏移为 $0$ 是一个中性的起始点。\n- **边界**：必须遵守物理约束。参数 $P$, $L_d$, $A$ 和 $B$ 必须为正。螺旋周期 $P$ 位于一个已知的生物学范围内（例如，8 到 12 bp）。相位 $\\phi$ 是周期性的，可以被约束在一个长度为 $2\\pi$ 的区间内，例如 $[-\\pi, \\pi]$，以确保解的唯一性。根据提供的测试用例，振幅 $A$ 被约束为非负值。\n\n每个测试用例的步骤如下：\n$1$. 使用提供的真实参数和推导的模型 $R(s)$ 生成无噪声的合成数据点 $(s_i, y_i)$。\n$2$. 使用 `scipy.optimize.curve_fit` 将模型 $R(s)$ 拟合到合成数据，提供一组合理的初始猜测值和边界，以找到最优参数估计。\n$3$. 报告拟合的参数，四舍五入到指定的精度。鉴于数据是无噪声的且由模型本身生成，该过程预期能够准确地恢复真实参数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Derives a biophysical model for DNA looping-mediated repression,\n    generates synthetic data, and fits the model to recover parameters.\n    \"\"\"\n\n    # Define the derived parametric model for transcriptional repression.\n    # The model describes a periodic signal with a decaying envelope on a baseline.\n    # s: operator spacing (bp)\n    # P: helical repeat (bp)\n    # Ld: decay length (bp)\n    # phi: phase offset (radians)\n    # A: amplitude (dimensionless)\n    # B: baseline (dimensionless)\n    def repression_model(s, P, Ld, phi, A, B):\n        \"\"\"\n        Calculates repression R(s) based on the derived biophysical model.\n        R(s) = A * exp(-s/Ld) * cos(2*pi*s/P + phi) + B\n        \"\"\"\n        return A * np.exp(-s / Ld) * np.cos(2 * np.pi * s / P + phi) + B\n\n    # Test cases with true parameters and measurement spacings.\n    # Each case is a dictionary containing 'params' (P, Ld, phi, A, B)\n    # and 'spacings' (array of operator spacings in bp).\n    test_cases = [\n        {\n            \"params\": [10.5, 120.0, 0.5, 2.0, 10.0],\n            \"spacings\": np.array([60, 66, 72, 78, 84, 90, 96, 102, 108, 114, 120, 126, 132, 138, 144])\n        },\n        {\n            \"params\": [10.7, 80.0, -1.0, 0.2, 5.0],\n            \"spacings\": np.array([40, 46, 52, 58, 64, 70, 76, 82, 88, 94, 100, 106, 112, 118, 124])\n        },\n        {\n            \"params\": [11.0, 30.0, 1.2, 3.0, 8.0],\n            \"spacings\": np.array([30, 36, 42, 48, 54, 60, 66, 72, 78, 84, 90, 96, 102, 108, 114])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        true_params = case[\"params\"]\n        s_data = case[\"spacings\"]\n\n        # 1. Synthesize noiseless measurement data using the true parameters.\n        y_data = repression_model(s_data, *true_params)\n\n        # 2. Set up initial guesses and bounds for the fitting algorithm.\n        # A data-driven approach for initial guesses improves robustness.\n        p0 = [\n            10.5,                               # P_guess: known biophysical value\n            (s_data[-1] - s_data[0]) / 2,       # Ld_guess: decay over half the range\n            0.0,                                # phi_guess: neutral phase\n            (np.max(y_data) - np.min(y_data)) / 2,  # A_guess: half the peak-to-peak range\n            np.mean(y_data)                     # B_guess: mean of the signal\n        ]\n\n        # Bounds enforce physical constraints on the parameters.\n        bounds = (\n            [8.0, 1.0, -np.pi, 0.0, 0.0],        # Lower bounds\n            [12.0, 1000.0, np.pi, np.inf, np.inf] # Upper bounds\n        )\n\n        # 3. Fit the model to the synthetic data to recover parameters.\n        # curve_fit returns the optimal parameters (popt) and the covariance matrix (pcov).\n        popt, _ = curve_fit(\n            repression_model,\n            s_data,\n            y_data,\n            p0=p0,\n            bounds=bounds,\n            maxfev=5000  # Increase iterations for robustness\n        )\n        \n        # Handle potential phase wrapping for consistency if A is not constrained\n        # to be positive, but here A>0 is a bound, so this is not required.\n        # If popt[3] < 0: # Amplitude A\n        #    popt[3] = -popt[3]\n        #    popt[2] = popt[2] + np.pi # phi\n        # while popt[2] > np.pi:\n        #    popt[2] -= 2*np.pi\n        # while popt[2] < -np.pi:\n        #    popt[2] += 2*np.pi\n\n        results.append(popt)\n\n    # 4. Format the final output as specified.\n    # Each parameter is rounded to exactly three decimal places.\n    formatted_results = []\n    for res in results:\n        # Order is [P, Ld, phi, A, B]\n        formatted_case = (f\"[{res[0]:.3f},{res[1]:.3f},{res[2]:.3f},\"\n                          f\"{res[3]:.3f},{res[4]:.3f}]\")\n        formatted_results.append(formatted_case)\n\n    # The final print statement produces a single line in the required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2755169"}]}