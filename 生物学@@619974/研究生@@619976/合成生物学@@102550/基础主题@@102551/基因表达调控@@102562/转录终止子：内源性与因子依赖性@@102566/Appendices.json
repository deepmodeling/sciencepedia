{"hands_on_practices": [{"introduction": "本次练习将理论与实践相结合，展示了生物物理模型如何将序列层面的特征（如此处的U-tract区域的碱基组成）转化为对功能的定量预测。通过应用一个基于速率的终止动力学模型，您将计算U-tract中的特定突变如何影响内源性终止子的效率，这是理性生物设计中的一项基本技能。[@problem_id:2785306]", "problem": "在细菌的内在转录终止过程中，在RNA聚合酶（RNAP；核糖核酸聚合酶）活性位点附近，新生转录本中形成一个核糖核酸（RNA）发夹结构，其后紧随着一个富含尿苷的序列（U序列）。U序列会削弱RNA-脱氧核糖核酸（DNA）杂交体，因为rU:dA碱基对相对较弱，这促进了RNAP的去稳定化和转录本的释放。考虑一个经过工程改造的内在终止子，其发夹的茎和环结构保持不变，但长度为 $n = 7$ 个核苷酸的 $3^{\\prime}$端U序列被系统性地改变，通过将RNA中的一部分尿苷（U）替换为腺嘌呤（A）或胞嘧啶（C），同时DNA模板链也做相应改变，使得在那些位置上的杂交体碱基对变为rA:dT或rC:dG。假设RNA-DNA杂交体有以下基于物理原理的碱基配对自由能贡献（在标准单价盐条件下，每对碱基的平均值）：rU:dA为 $\\epsilon_U = 1.0\\,\\mathrm{kcal/mol}$，rA:dT为 $\\epsilon_A = 1.5\\,\\mathrm{kcal/mol}$，rC:dG为 $\\epsilon_C = 2.5\\,\\mathrm{kcal/mol}$。发夹稳定自由能为 $\\Delta G_{\\mathrm{hp}} = -9.0\\,\\mathrm{kcal/mol}$，并且存在一个与序列无关的额外释放结构惩罚 $\\Delta G_0 = +4.0\\,\\mathrm{kcal/mol}$（反映了如钳夹区打开等构象变化）。温度为 $T = 310\\,\\mathrm{K}$，因此 $k_B T \\approx 0.616\\,\\mathrm{kcal/mol}$，其中 $k_B$ 是玻尔兹曼常数。\n\n将终止子处的暂停复合物建模为一个无记忆的双路径系统：终止（转录本释放），其速率常数遵循与有效自由能垒相关的阿伦尼乌斯标度，指前因子为 $k_0 = 10^{4}\\,\\mathrm{s^{-1}}$；以及向前逃逸（恢复延伸），其速率为与序列无关的 $k_{\\mathrm{esc}} = 40\\,\\mathrm{s^{-1}}$。转录本释放的有效能垒是破坏RNA-DNA杂交体所需的能量减去发夹稳定作用再加上 $\\Delta G_0$。考虑三种构建体：\n- WT：U序列为 $\\mathrm{U}_7$。\n- MutA：序列中两个内部的U被A替换，得到 $\\mathrm{U}_5\\mathrm{A}_2$。\n- MutC：序列中两个内部的U被C替换，得到 $\\mathrm{U}_5\\mathrm{C}_2$。\n\n仅使用分子生物学的中心法则（碱基互补）、公认的相对碱基对稳定性以及热激活速率理论，分析这些替换如何影响RNA-DNA杂交体的弱化和RNAP的去稳定化。下列哪（些）陈述与该模型和所述物理原理一致？\n\nA. 从数量上看，终止效率大约为 $\\mathrm{WT} \\approx 0.91$，$\\mathrm{MutA} \\approx 0.66$，$\\mathrm{MutC} \\approx 0.07$，这表明用A或C替换U会通过稳定RNA-DNA杂交体和减弱RNAP的去稳定化来逐步降低终止效率。\n\nB. 因为腺嘌呤（A）只形成两个氢键，所以在U序列内用A替换U会比rU:dA进一步削弱RNA-DNA杂交体，因此相对于 $\\mathrm{U}_7$ 增加了终止效率。\n\nC. 用C替换U的主要影响是通过rC:dG对中更强的堆积作用和三个氢键来加强RNA-DNA杂交体，这会降低转录本释放速率并增加平均暂停寿命；在给定参数下，$\\mathrm{U}_5\\mathrm{C}_2$ 的平均寿命约为 $0.023\\,\\mathrm{s}$，比 $\\mathrm{U}_7$ 的更长。\n\nD. 如果向前逃逸速率保持不变，终止效率之比 $\\mathrm{TE}(\\mathrm{MutA})/\\mathrm{TE}(\\mathrm{WT})$ 约等于 $\\exp(-\\Delta\\Delta G/(k_B T))$，其中 $\\Delta\\Delta G$ 是由替换引起的杂交体稳定化；使用所提供的能量，这得出 $\\mathrm{TE}(\\mathrm{MutA})/\\mathrm{TE}(\\mathrm{WT}) \\approx \\exp(-1.0/0.616) \\approx 0.20$。", "solution": "必须首先验证问题陈述的科学性和逻辑一致性。\n\n### 第一步：提取已知条件\n\n-   **系统**：细菌内在转录终止。\n-   **组分**：RNA发夹结构、富含尿苷的序列（U序列）、RNA-DNA杂交体。\n-   **U序列长度**：$n = 7$ 个核苷酸。\n-   **碱基配对自由能贡献（破坏每个碱基对的能量）**：\n    -   rU:dA: $\\epsilon_U = 1.0\\,\\mathrm{kcal/mol}$\n    -   rA:dT: $\\epsilon_A = 1.5\\,\\mathrm{kcal/mol}$\n    -   rC:dG: $\\epsilon_C = 2.5\\,\\mathrm{kcal/mol}$\n-   **发夹稳定自由能**：$\\Delta G_{\\mathrm{hp}} = -9.0\\,\\mathrm{kcal/mol}$。\n-   **与序列无关的释放结构惩罚**：$\\Delta G_0 = +4.0\\,\\mathrm{kcal/mol}$。\n-   **温度**：$T = 310\\,\\mathrm{K}$。\n-   **热能**：$k_B T \\approx 0.616\\,\\mathrm{kcal/mol}$。\n-   **终止速率模型**：阿伦尼乌斯标度，$k_{\\mathrm{term}} = k_0 \\exp(-\\Delta G_{\\mathrm{eff}} / (k_B T))$。\n    -   指前因子：$k_0 = 10^{4}\\,\\mathrm{s^{-1}}$。\n    -   有效能垒：$\\Delta G_{\\mathrm{eff}} = (\\text{破坏RNA-DNA杂交体的能量}) - (\\text{发夹稳定作用}) + \\Delta G_0$。\n-   **向前逃逸速率**：$k_{\\mathrm{esc}} = 40\\,\\mathrm{s^{-1}}$（与序列无关）。\n-   **构建体**：\n    -   WT: U序列为 $\\mathrm{U}_7$。RNA-DNA杂交体由7个rU:dA对组成。\n    -   MutA: U序列为 $\\mathrm{U}_5\\mathrm{A}_2$。杂交体有5个rU:dA对和2个rA:dT对。\n    -   MutC: U序列为 $\\mathrm{U}_5\\mathrm{C}_2$。杂交体有5个rU:dA对和2个rC:dG对。\n\n### 第二步：使用提取的已知条件进行验证\n\n根据验证标准对问题进行评估。\n\n1.  **具有科学依据**：该问题描述了一个简化但物理和生物学上合理的内在转录终止模型。终止和延伸之间的动力学竞争、发夹和U序列的作用，以及使用阿伦尼乌斯模型计算速率常数，都是生物物理学和分子生物学中的标准概念。相对稳定性 $\\epsilon_C > \\epsilon_A > \\epsilon_U$ 与RNA-DNA杂交体的实验数据一致（rC:dG最强，rU:dA最弱）。该模型是自洽的，并基于已建立的原则。\n2.  **定义明确**：该问题提供了所有必要的参数和一套清晰的规则来计算感兴趣的量（终止速率和效率）。可以从给定信息中推导出唯一解。\n3.  **客观性**：语言精确且定量。没有主观或基于观点的陈述。\n4.  **缺陷**：问题陈述在有效能垒的定义中包含一个微小的歧义：“减去发夹稳定作用”。鉴于发夹结构*促进*终止（即降低动力学能垒），并且提供的“稳定自由能” $\\Delta G_{\\mathrm{hp}}$ 是负值（$-9.0\\,\\mathrm{kcal/mol}$），这个短语必须被解释为减去稳定能量的绝对值，即 $|\\Delta G_{\\mathrm{hp}}| = 9.0\\,\\mathrm{kcal/mol}$。另一种解释，即减去一个负值（也就是在能垒上增加 $9.0\\,\\mathrm{kcal/mol}$），在生物学上是荒谬的。通过这个合理的消歧，该问题完全可以形式化。\n\n### 第三步：结论与行动\n\n该问题是**有效的**。这个微小的语言歧义可以通过上下文和所模拟过程的基本原理来解决。我将继续进行解答。\n\n### 求解推导\n\n终止效率 $\\mathrm{TE}$ 是指从暂停状态发生终止的概率，由终止速率与离开暂停状态的总速率之比给出：\n$$\n\\mathrm{TE} = \\frac{k_{\\mathrm{term}}}{k_{\\mathrm{term}} + k_{\\mathrm{esc}}}\n$$\n终止速率由 $k_{\\mathrm{term}} = k_0 \\exp(-\\Delta G_{\\mathrm{eff}} / (k_B T))$ 给出，其中 $k_0 = 10^4\\,\\mathrm{s^{-1}}$ 且 $k_B T = 0.616\\,\\mathrm{kcal/mol}$。向前逃逸速率是恒定的，$k_{\\mathrm{esc}} = 40\\,\\mathrm{s^{-1}}$。\n\n关键任务是计算每个构建体的有效活化能垒 $\\Delta G_{\\mathrm{eff}}$。问题陈述：\n$\\Delta G_{\\mathrm{eff}} = \\Delta G_{\\mathrm{hybrid}} - (\\text{发夹稳定作用}) + \\Delta G_0$。\n如上文所推理，这被解释为：\n$\\Delta G_{\\mathrm{eff}} = \\Delta G_{\\mathrm{hybrid}} - |\\Delta G_{\\mathrm{hp}}| + \\Delta G_0$。\n使用 $\\Delta G_{\\mathrm{hp}} = -9.0\\,\\mathrm{kcal/mol}$ 和 $\\Delta G_0 = 4.0\\,\\mathrm{kcal/mol}$，这变为：\n$\\Delta G_{\\mathrm{eff}} = \\Delta G_{\\mathrm{hybrid}} - 9.0\\,\\mathrm{kcal/mol} + 4.0\\,\\mathrm{kcal/mol} = \\Delta G_{\\mathrm{hybrid}} - 5.0\\,\\mathrm{kcal/mol}$。\n\n接下来，我们通过对每个碱基对的贡献求和，计算破坏每个构建体的7个碱基对的RNA-DNA杂交体所需的能量 $\\Delta G_{\\mathrm{hybrid}}$。\n\n**1. WT构建体 ($\\mathrm{U}_7$)**\n杂交体由7个rU:dA对组成。\n$\\Delta G_{\\mathrm{hybrid, WT}} = 7 \\times \\epsilon_U = 7 \\times 1.0\\,\\mathrm{kcal/mol} = 7.0\\,\\mathrm{kcal/mol}$。\n有效能垒是：\n$\\Delta G_{\\mathrm{eff, WT}} = 7.0 - 5.0 = 2.0\\,\\mathrm{kcal/mol}$。\n终止速率是：\n$k_{\\mathrm{term, WT}} = 10^4 \\exp\\left(-\\frac{2.0}{0.616}\\right) \\approx 10^4 \\exp(-3.2468) \\approx 10^4 \\times 0.0389 = 389\\,\\mathrm{s^{-1}}$。\n终止效率是：\n$\\mathrm{TE}_{\\mathrm{WT}} = \\frac{389}{389 + 40} = \\frac{389}{429} \\approx 0.9067$。\n\n**2. MutA构建体 ($\\mathrm{U}_5\\mathrm{A}_2$)**\n杂交体由5个rU:dA对和2个rA:dT对组成。\n$\\Delta G_{\\mathrm{hybrid, MutA}} = 5 \\times \\epsilon_U + 2 \\times \\epsilon_A = 5 \\times 1.0 + 2 \\times 1.5 = 5.0 + 3.0 = 8.0\\,\\mathrm{kcal/mol}$。\n有效能垒是：\n$\\Delta G_{\\mathrm{eff, MutA}} = 8.0 - 5.0 = 3.0\\,\\mathrm{kcal/mol}$。\n终止速率是：\n$k_{\\mathrm{term, MutA}} = 10^4 \\exp\\left(-\\frac{3.0}{0.616}\\right) \\approx 10^4 \\exp(-4.8701) \\approx 10^4 \\times 0.00767 = 76.7\\,\\mathrm{s^{-1}}$。\n终止效率是：\n$\\mathrm{TE}_{\\mathrm{MutA}} = \\frac{76.7}{76.7 + 40} = \\frac{76.7}{116.7} \\approx 0.6572$。\n\n**3. MutC构建体 ($\\mathrm{U}_5\\mathrm{C}_2$)**\n杂交体由5个rU:dA对和2个rC:dG对组成。\n$\\Delta G_{\\mathrm{hybrid, MutC}} = 5 \\times \\epsilon_U + 2 \\times \\epsilon_C = 5 \\times 1.0 + 2 \\times 2.5 = 5.0 + 5.0 = 10.0\\,\\mathrm{kcal/mol}$。\n有效能垒是：\n$\\Delta G_{\\mathrm{eff, MutC}} = 10.0 - 5.0 = 5.0\\,\\mathrm{kcal/mol}$。\n终止速率是：\n$k_{\\mathrm{term, MutC}} = 10^4 \\exp\\left(-\\frac{5.0}{0.616}\\right) \\approx 10^4 \\exp(-8.1169) \\approx 10^4 \\times 0.00030 = 3.0\\,\\mathrm{s^{-1}}$。\n终止效率是：\n$\\mathrm{TE}_{\\mathrm{MutC}} = \\frac{3.0}{3.0 + 40} = \\frac{3.0}{43.0} \\approx 0.0698$。\n\n### 逐项分析选项\n\n**A. 从数量上看，终止效率大约为 $\\mathrm{WT} \\approx 0.91$，$\\mathrm{MutA} \\approx 0.66$，$\\mathrm{MutC} \\approx 0.07$，这表明用A或C替换U会通过稳定RNA-DNA杂交体和减弱RNAP的去稳定化来逐步降低终止效率。**\n我们的计算得出 $\\mathrm{TE}_{\\mathrm{WT}} \\approx 0.907 \\approx 0.91$，$\\mathrm{TE}_{\\mathrm{MutA}} \\approx 0.657 \\approx 0.66$，以及 $\\mathrm{TE}_{\\mathrm{MutC}} \\approx 0.070 \\approx 0.07$。这些值与陈述相符。定性推理也是正确的。替换U $\\rightarrow$ A和U $\\rightarrow$ C增加了杂交体的稳定性（$\\Delta G_{\\mathrm{hybrid}}$ 从 $7.0$ 增加到 $8.0$ 再到 $10.0\\,\\mathrm{kcal/mol}$），这增加了终止能垒，降低了终止速率，从而降低了终止效率。“减弱RNAP的去稳定化”是对降低终止概率的正确描述。\n**结论：正确。**\n\n**B. 因为腺嘌呤（A）只形成两个氢键，所以在U序列内用A替换U会比rU:dA进一步削弱RNA-DNA杂交体，因此相对于 $\\mathrm{U}_7$ 增加了终止效率。**\n根据问题提供的数据，这个陈述包含一个事实上不正确的前提。问题给出的rA:dT的破坏能为 $\\epsilon_A = 1.5\\,\\mathrm{kcal/mol}$，而rU:dA为 $\\epsilon_U = 1.0\\,\\mathrm{kcal/mol}$。由于 $\\epsilon_A > \\epsilon_U$，rA:dT碱基对要比rU:dA碱基对*更强*，而不是更弱。这种增强的稳定性加强了杂交体，从而*降低*了终止效率，正如对MutA的计算所示。该陈述的主张和结论都与模型和数据相悖。\n**结论：不正确。**\n\n**C. 用C替换U的主要影响是通过rC:dG对中更强的堆积作用和三个氢键来加强RNA-DNA杂交体，这会降低转录本释放速率并增加平均暂停寿命；在给定参数下，$\\mathrm{U}_5\\mathrm{C}_2$ 的平均寿命约为 $0.023\\,\\mathrm{s}$，比 $\\mathrm{U}_7$ 的更长。**\n定性推理是合理的：rC:dG对 ($\\epsilon_C = 2.5\\,\\mathrm{kcal/mol}$) 远强于rU:dA对 ($\\epsilon_U = 1.0\\,\\mathrm{kcal/mol}$)，这加强了杂交体并降低了终止速率。平均暂停寿命 $\\tau$ 是离开暂停状态总速率的倒数，$\\tau = 1/(k_{\\mathrm{term}} + k_{\\mathrm{esc}})$。\n对于MutC构建体 ($\\mathrm{U}_5\\mathrm{C}_2$)：$k_{\\mathrm{total, MutC}} = k_{\\mathrm{term, MutC}} + k_{\\mathrm{esc}} \\approx 3.0 + 40 = 43.0\\,\\mathrm{s^{-1}}$。平均寿命是 $\\tau_{\\mathrm{MutC}} = 1/43.0 \\approx 0.02326\\,\\mathrm{s}$，约等于 $0.023\\,\\mathrm{s}$。\n对于WT构建体 ($\\mathrm{U}_7$)：$k_{\\mathrm{total, WT}} = k_{\\mathrm{term, WT}} + k_{\\mathrm{esc}} \\approx 389 + 40 = 429\\,\\mathrm{s^{-1}}$。平均寿命是 $\\tau_{\\mathrm{WT}} = 1/429 \\approx 0.00233\\,\\mathrm{s}$。\nMutC的寿命 ($0.023\\,\\mathrm{s}$) 确实比WT的 ($0.0023\\,\\mathrm{s}$) 更长。陈述的所有部分都与我们的推导一致。\n**结论：正确。**\n\n**D. 如果向前逃逸速率保持不变，终止效率之比 $\\mathrm{TE}(\\mathrm{MutA})/\\mathrm{TE}(\\mathrm{WT})$ 约等于 $\\exp(-\\Delta\\Delta G/(k_B T))$，其中 $\\Delta\\Delta G$ 是由替换引起的杂交体稳定化；使用所提供的能量，这得出 $\\mathrm{TE}(\\mathrm{MutA})/\\mathrm{TE}(\\mathrm{WT}) \\approx \\exp(-1.0/0.616) \\approx 0.20$。**\n此选项中提供的公式是终止*速率*之比，而不是效率之比。\n$\\frac{k_{\\mathrm{term, MutA}}}{k_{\\mathrm{term, WT}}} = \\frac{k_0 \\exp(-\\Delta G_{\\mathrm{eff, MutA}} / k_B T)}{k_0 \\exp(-\\Delta G_{\\mathrm{eff, WT}} / k_B T)} = \\exp(-(\\Delta G_{\\mathrm{eff, MutA}} - \\Delta G_{\\mathrm{eff, WT}})/k_B T)$。\n有效能垒的变化是 $\\Delta\\Delta G_{\\mathrm{eff}} = \\Delta G_{\\mathrm{eff, MutA}} - \\Delta G_{\\mathrm{eff, WT}} = \\Delta G_{\\mathrm{hybrid, MutA}} - \\Delta G_{\\mathrm{hybrid, WT}} = 8.0 - 7.0 = 1.0\\,\\mathrm{kcal/mol}$。\n所以速率之比是 $\\exp(-1.0/0.616) \\approx 0.197 \\approx 0.20$。选项中的计算对于速率之比是正确的。\n然而，效率之比是 $\\frac{\\mathrm{TE}(\\mathrm{MutA})}{\\mathrm{TE}(\\mathrm{WT})} = \\frac{k_{\\mathrm{term, MutA}}/(k_{\\mathrm{term, MutA}} + k_{\\mathrm{esc}})}{k_{\\mathrm{term, WT}}/(k_{\\mathrm{term, WT}} + k_{\\mathrm{esc}})}$。只有当两个构建体的 $k_{\\mathrm{term}} \\ll k_{\\mathrm{esc}}$ 时，这个比率才约等于速率之比，而这个条件被严重违反了，特别是对于WT，其 $k_{\\mathrm{term, WT}} \\approx 389\\,\\mathrm{s^{-1}}$ 而 $k_{\\mathrm{esc}} = 40\\,\\mathrm{s^{-1}}$。\n效率的实际比率是 $\\frac{0.6572}{0.9067} \\approx 0.725$。这与选项中声称的 $0.20$ 值有显著差异。因此，在这个参数范围内，认为效率之比可以用这种方式近似的断言是根本性错误的。\n**结论：不正确。**", "answer": "$$\\boxed{AC}$$", "id": "2785306"}, {"introduction": "从预测转向测量，这项练习挑战您设计一个可靠的实验来表征终止子。它强调了设置恰当对照的重要性，以便将终止子的转录效应与翻译效率、蛋白质稳定性等混杂因素分离开来。这确保了我们收集的数据是准确且可解释的，是严谨科学研究的基石。[@problem_id:2785294]", "problem": "您的任务是设计并分析一种双报告基因检测法，以量化置于单个转录本上两个开放阅读框之间的细菌序列的转录终止子强度。设上游报告基因表示为 $U$，下游报告基因表示为 $D$。在转录水平上，终止子强度定义为 $S = 1 - R$，其中 $R$ 是延伸中的 RNA 聚合酶通读候选终止子的概率。您将测量来自两个报告基因的稳态荧光，并使用估计量 $S = 1 - \\text{(下游报告基因)}/\\text{(上游报告基因)}$ 来计算终止子强度。您的目标是选择一种检测设计和控制策略，使得该估计量对于转录终止是无偏的，不受翻译效应或报告蛋白特性的干扰，并能够区分内在终止和因子依赖性终止（例如，Rho 依赖性终止）。\n\n仅使用以下基本原理：分子生物学的中心法则（DNA 到 RNA 到蛋白质）、恒定生长条件下稳态蛋白质水平与蛋白质生产速率除以有效蛋白质损失速率（稀释加降解）成正比、稳态信使 RNA 水平与转录速率除以有效信使 RNA 损失速率成正比、以及内在终止子（一个稳定的 RNA 发夹结构后跟一个多聚尿苷酸序列）和因子依赖性终止子（依赖于 Rho 和 Nus 因子等蛋白质）的典型特征。假设在背景扣除和正确的光谱分离后，荧光与成熟蛋白质的丰度成正比，并且测量是在相同生长条件下的稳态下进行的。\n\n哪个选项描述了一种设计和控制方案，可以从稳态荧光中得到 $S$ 的无偏估计量，并允许您区分内在终止和因子依赖性终止？\n\nA. 将候选终止子置于单个转录本上的 $U$ 和 $D$ 之间，其结构为：启动子–转录绝缘子（例如，自剪切核酶）–标准化的核糖体结合位点–$U$–终止密码子–间隔区–待测终止子或其发夹结构被破坏的对照–间隔区–嵌入双顺反子设计元件中的标准化核糖体结合位点–$D$。使用两种密码子用法匹配且光谱可分离的荧光蛋白，并通过绝缘子保持相同的上游非翻译区。量化稳态下扣除背景后的荧光 $F_U$ 和 $F_D$，并计算归一化估计量\n$$\n\\hat S \\;=\\; 1 \\;-\\; \\frac{\\left(F_D/F_U\\right)_{\\mathrm{T}}}{\\left(F_D/F_U\\right)_{\\mathrm{NT}}} \\,,\n$$\n其中下标 $\\mathrm{T}$ 表示带有活性终止子的构建体，而 $\\mathrm{NT}$ 是通过破坏发夹结构的点突变创建的无终止子对照，该突变保留了长度和碱基组成。包括跨信使 RNA 连接区的逆转录定量聚合酶链式反应以验证通读，一个无启动子的阴性对照来测量自发荧光和泄露，一个反向终止子对照来检测非终止性结构对下游核糖体结合位点的干扰，以及因子依赖性对照：添加 bicyclomycin 或敲低 Rho 以测试 Rho 依赖性，并通过改变 NusA 水平来调节内在终止。将分析限制在稳态，以避免成熟动力学的干扰。\n\nB. 将终止子置于 $U$ 和 $D$ 之间，并计算 $S$ 为 $1 - F_D/F_U$。仅通过计算设计来使核糖体结合位点均等。为了解耦翻译，在测量过程中添加氯霉素（chloramphenicol）以停止翻译，从而消除翻译伪影。通过比较添加利福平（rifampicin）以阻断转录延伸前后的 $S$ 值来定义因子依赖性。\n\nC. 测量信使 RNA 丰度而非蛋白质：将终止子置于 $U$ 和 $D$ 之间，通过突变起始密码子完全省略翻译，并计算 $S$ 为 $1 - M_D/M_U$，其中 $M_D$ 和 $M_U$ 是通过逆转录定量聚合酶链式反应测得的稳态连接区特异性信使 RNA 水平。通过添加 bicyclomycin 并将 $S$ 降低的终止子分类为因子依赖性，来区分 Rho 依赖性。\n\nD. 为 $U$ 和 $D$ 使用相同的荧光蛋白以匹配成熟过程，并将 $F_D$ 对一个单独质粒上的管家基因荧光报告基因进行归一化，同时将 $F_U$ 对光密度进行归一化。计算 $S$ 为 $1 - \\left(F_D/\\text{管家基因}\\right)/\\left(F_U/\\text{光密度}\\right)$。通过过表达 Rho 并观察 $S$ 是否增加来识别因子依赖性。\n\n选择唯一的最佳选项。", "solution": "任务是为双报告基因检测法确定最佳的实验设计和控制策略，以测量转录终止子强度 $S$，其定义为 $S = 1 - R$，其中 $R$ 是通读概率。$S$ 的估计量必须对转录终止是无偏的，不受翻译或蛋白质特性的干扰，并且必须能够区分内在终止和因子依赖性终止。\n\n首先，我们必须根据所提供的原理建立系统的数学模型。设转录起始速率为 $k_{txn}$。终止子置于单个转录单元上游报告基因 ($U$) 和下游报告基因 ($D$) 之间。\n一部分转录本（比例为 $(1-R)$）将在 $U$ 顺反子后终止，而另一部分（比例为 $R$）将通读终止子，产生包含 $U$ 和 $D$ 的全长转录本。\n\n设 $M_U$ 和 $M_D$ 分别为对应 $U$ 和 $D$ 编码序列的稳态 mRNA 水平。\n包含 $U$ 编码序列的 mRNA 分子由短的、已终止的转录本和长的、全长的转录本组成。设这些物质的降解速率分别为 $\\delta_{mRNA,short}$ 和 $\\delta_{mRNA,full}$。可用于翻译蛋白质 $U$ 的 mRNA 总量为：\n$$ M_{U,total} \\propto \\frac{k_{txn}(1-R)}{\\delta_{mRNA,short}} + \\frac{k_{txn}R}{\\delta_{mRNA,full}} $$\n可用于翻译蛋白质 $D$ 的 mRNA 仅来自全长转录本：\n$$ M_{D,total} \\propto \\frac{k_{txn}R}{\\delta_{mRNA,full}} $$\n\n蛋白质 $U$ 和 $D$ 的生产速率与其各自的 mRNA 水平和翻译起始速率 $k_{tln,U}$ 和 $k_{tln,D}$ 成正比。\n$$ \\text{Prod}_U = k_{tln,U} M_{U,total} $$\n$$ \\text{Prod}_D = k_{tln,D} M_{D,total} $$\n在稳态下，蛋白质浓度 $P$ 与生产速率除以有效损失速率 $\\delta_{prot}$（稀释加降解）成正比。荧光 $F$ 与成熟蛋白质浓度成正比，比例常数为 $c$，该常数考虑了光谱特性。\n$$ F_U = c_U P_U \\propto c_U \\frac{\\text{Prod}_U}{\\delta_{prot,U}} = c_U \\frac{k_{tln,U} M_{U,total}}{\\delta_{prot,U}} $$\n$$ F_D = c_D P_D \\propto c_D \\frac{\\text{Prod}_D}{\\delta_{prot,D}} = c_D \\frac{k_{tln,D} M_{D,total}}{\\delta_{prot,D}} $$\n\n下游与上游荧光的简单比率为：\n$$ \\frac{F_D}{F_U} = \\left( \\frac{c_D}{c_U} \\cdot \\frac{k_{tln,D}}{k_{tln,U}} \\cdot \\frac{\\delta_{prot,U}}{\\delta_{prot,D}} \\right) \\cdot \\frac{M_{D,total}}{M_{U,total}} $$\n$$ \\frac{F_D}{F_U} = \\left( \\frac{c_D k_{tln,D} \\delta_{prot,U}}{c_U k_{tln,U} \\delta_{prot,D}} \\right) \\cdot \\frac{\\frac{k_{txn}R}{\\delta_{mRNA,full}}}{\\frac{k_{txn}(1-R)}{\\delta_{mRNA,short}} + \\frac{k_{txn}R}{\\delta_{mRNA,full}}} $$\n设括号中的项为偏置因子 $B$。\n$$ \\frac{F_D}{F_U} = B \\cdot \\frac{R/\\delta_{mRNA,full}}{(1-R)/\\delta_{mRNA,short} + R/\\delta_{mRNA,full}} $$\n所提出的估计量 $S = 1 - F_D/F_U$ 显然是有偏的。对于 $S$ 的无偏估计量要求 $F_D/F_U = R$。这将需要偏置因子 $B=1$（即，相同的报告基因、翻译速率和蛋白质稳定性），并且 mRNA 降解速率相等, $\\delta_{mRNA,short} = \\delta_{mRNA,full}$。这些是强假设，且通常不成立。\n\n一个稳健的实验设计必须通过归一化来消除这些偏置。一种标准方法是使用一个没有活性终止子的对照构建体（$S=0$, $R=1$）。我们称之为无终止子（NT）构建体，而带有终止子的构建体称为（T）构建体。对于 NT 构建体，理想情况下只产生一种 mRNA。\n$$ \\left(\\frac{F_D}{F_U}\\right)_{NT} = B \\cdot \\frac{M_{D,total,NT}}{M_{U,total,NT}} = B $$\n这假设对于 NT 构建体，在考虑了任何序列特异性降解效应后，$U$ 和 $D$ 的 mRNA 量实际上是相同的，这是一个合理的设计目标。\n通过计算比率的比率，我们得到：\n$$ \\frac{(F_D/F_U)_T}{(F_D/F_U)_{NT}} = \\frac{R/\\delta_{mRNA,full}}{(1-R)/\\delta_{mRNA,short} + R/\\delta_{mRNA,full}} $$\n这种归一化消除了包含所有翻译和蛋白质特异性干扰的偏置因子 $B$。估计量 $\\hat{S} = 1 - \\frac{(F_D/F_U)_T}{(F_D/F_U)_{NT}}$ 现在没有了这些偏置。然而，它仍然受到不同 mRNA 稳定性（$\\delta_{mRNA,short}$ vs. $\\delta_{mRNA,full}$）的干扰。如果我们能够设计 NT 对照，使其转录本的稳定性（$\\delta_{mRNA,NT}$）与 $\\delta_{mRNA,full}$ 和 $\\delta_{mRNA,short}$ 非常相似，或者如果我们能假设 $\\delta_{mRNA,short} \\approx \\delta_{mRNA,full}$，那么估计量就简化为 $\\hat{S} \\approx 1-R = S$。一个设计良好的发夹结构被破坏的突变体作为 NT 对照有助于满足这一条件。\n\n为了区分终止子类型：\n- **Rho 依赖性**：抑制 Rho 因子（例如，使用 bicyclomycin 或通过基因敲低）应降低终止强度 $S$。\n- **内在性**：该机制依赖于特定的 RNA 二级结构（发夹）。终止强度通常受 NusA 等因子调节。一个发夹结构被破坏的对照应该能消除终止。\n\n有了这个框架，我们现在来评估每个选项。\n\n**选项 A**：\n该选项提出了一个复杂的构建体结构：`启动子–转录绝缘子–标准化的核糖体结合位点–U–终止密码子–间隔区–待测终止子或其发夹结构被破坏的对照–间隔区–嵌入双顺反子设计元件中的标准化核糖体结合位点–D`。这个设计非常出色。\n- `转录绝缘子`（例如，核酶）使 mRNA 的 5' 端标准化，最大限度地减少了来自启动子的变异性。\n- 为 $U$ 设计的`标准化的核糖体结合位点`和为 $D$ 设计的`双顺反子设计元件`解决了高效和可预测翻译的挑战。\n- 使用两种密码子用法匹配且光谱上可区分的荧光报告基因适合于同步测量。\n- 估计量 $\\hat{S} = 1 - \\frac{\\left(F_D/F_U\\right)_{\\mathrm{T}}}{\\left(F_D/F_U\\right)_{\\mathrm{NT}}}$ 正是消除翻译和蛋白质水平偏置所需的比率归一化方法。\n- `发夹结构被破坏的对照`是 NT 构建体的正确选择，因为它保留了序列长度和组成，从而最大限度地减少了与 mRNA 稳定性差异相关的伪影。\n- 附加的对照组全面而严谨：用于直接验证的`跨连接区 RT-qPCR`，用于测量背景的`无启动子对照`，用于排除非终止子 RNA 结构干扰翻译的`反向对照`，以及用于探测因子依赖性的正确方法（用 `bicyclomycin`/`Rho 敲低`来检测 Rho，以及通过调节 `NusA` 来检测内在终止子）。\n此选项满足了无偏和特异性检测的所有要求。\n**结论：正确**\n\n**选项 B**：\n此选项建议在没有归一化对照的情况下将 $S$ 计算为 $1 - F_D/F_U$。如上所述，这个估计量是幼稚的，并且充满了偏置。\n- `计算设计`的核糖体结合位点是不够的；需要实验归一化。\n- 使用`氯霉素 (chloramphenicol)`是没有意义的。它会停止所有翻译；不能通过停止生产来测量稳态生产速率。这将测量蛋白质的衰变，而不是终止效率。\n- 使用`利福平 (rifampicin)`来探测因子依赖性是错误的。利福平抑制所有基因的转录起始，它对任何终止机制都不是特异性的。Bicyclomycin 是 Rho 的特异性抑制剂。\n这个选项显示了对实验原理的根本性误解。\n**结论：错误**\n\n**选项 C**：\n这个选项建议通过 RT-qPCR直接测量 mRNA 水平，这正确地避免了翻译和蛋白质水平的干扰。然而，其实施是有缺陷的。\n- 它将 $S$ 计算为 $1 - M_D/M_U$。如推导所示，$M_U$ 量测量的是来自已终止和通读转录本的 mRNA，而 $M_D$ 仅测量通读的 mRNA。因此，比率 $M_D/M_U$ 不是通读率 $R$ 的直接度量，并且与基于蛋白质的比率一样，受到不同 mRNA 稳定性的同样偏置的影响。\n- 至关重要的是，该选项省略了归一化对照（如选项 A 中的发夹结构被破坏的 NT 构建体）。没有这样的对照，任何序列特异性伪影或 qPCR 引物效率的差异都无法被校正。\n- 虽然使用 bicyclomycin 测试 Rho 依赖性是正确的，但核心测量方法是有缺陷的。\n**结论：错误**\n\n**选项 D**：\n此选项包含多个严重的设计缺陷。\n- 为 $U$ 和 $D$ 使用`相同的荧光蛋白`，使得在同一个细胞中无法在光谱上区分它们的信号，这使得双报告基因概念在标准荧光测定法中无法用于同步测量。\n- 归一化方案 $1 - \\left(F_D/\\text{管家基因}\\right)/\\left(F_U/\\text{光密度}\\right)$ 在数学上是不连贯的。分母不同，而且这种特定的比率组合没有逻辑基础。在取其内部比率之前，必须将两个报告基因都归一化到相同的外部量（如光密度）。\n- 在单独的质粒上使用管家基因引入了另一个变异源（例如，质粒拷贝数差异），这使得解释复杂化，而不是简化。\n- 虽然使用 Rho 过表达来识别因子依赖性是一种有效的方法，但主要的测量策略是根本上错误的。\n**结论：错误**\n\n总之，选项 A 描述了一个完整且科学严谨的实验方案，正确地解决了这类测量中固有的多种潜在偏置来源和干扰因素。它采用了适当的归一化、最先进的构建体设计和一套全面的对照，以确保结果的有效性和特异性。其他选项则包含足以使其被否决的概念或方法学错误。", "answer": "$$\\boxed{A}$$", "id": "2785294"}, {"introduction": "科学研究的闭环是数据分析。本练习将介绍一个强大的贝叶斯框架，用于从实验计数数据中估计终止子强度，并对估计的不确定性进行原则性量化。这反映了现代生物学研究中向概率思维和严谨统计建模转变的趋势。[@problem_id:2785265]", "problem": "您正在设计一个计算估计量，用于根据在转录终止子上游和下游收集的重复报告基因测量数据，估计转录终止子的强度。其生物学基础是分子生物学中心法则，即转录产生 RNA，而转录终止子会减少读过并进入下游区域的 RNA 聚合酶的比例。定义通读概率为 $p \\in [0,1]$，终止子强度为 $TS = 1 - p$。您将实现两种基于计数实验的似然族下的贝叶斯估计量。\n\n基本和建模假设：\n- 对于二项约束计数，在第 $i$ 次重复实验中，您观察到一个上游计数值 $U_i$（代表总试验次数）和一个下游计数值 $D_i$（代表通读成功次数），其中 $D_i \\le U_i$。给定所有重复实验共享的通读概率 $p$，其似然为 $D_i \\sim \\mathrm{Binomial}(U_i, p)$，且各重复实验之间独立。为 $p$ 设置一个 Beta 先验：$p \\sim \\mathrm{Beta}(a_0,b_0)$，其中 $a_0 > 0$ 且 $b_0 > 0$。\n- 对于过度离散的独立计数，在第 $i$ 次重复实验中，您观察到在匹配暴露度的检测中测得的上游计数值 $U_i$ 和下游计数值 $D_i$。将这些计数建模为条件独立的泊松随机变量 $U_i \\mid \\lambda_i \\sim \\mathrm{Poisson}(\\lambda_i \\mu_u)$ 和 $D_i \\mid \\lambda_i \\sim \\mathrm{Poisson}(\\lambda_i \\mu_d)$，其中 $\\lambda_i$ 捕获了重复特异性暴露度，而 $\\mu_u, \\mu_d > 0$ 是全局均值。通过对 $\\lambda_i$ 设置一个具有有限均值和方差的 Gamma 先验来捕获重复实验间的过度离散，这意味着 $U_i$ 和 $D_i$ 的边际分布为负二项分布。定义通读比率 $r = \\mu_d / \\mu_u$，它通过 $q = \\mu_d / (\\mu_u + \\mu_d) = r/(1+r)$ 与条件于总数之上的通读概率相关联。为 $q$ 设置一个 Beta 先验 $q \\sim \\mathrm{Beta}(a_0,b_0)$，其中 $a_0 > 0$ 且 $b_0 > 0$。终止子强度为 $TS = 1 - r$。\n\n需要从贝叶斯定理和上述定义出发，实现以下任务：\n1) 对于二项模型，通过充分统计量 $S_U = \\sum_{i=1}^n U_i$ 和 $S_D = \\sum_{i=1}^n D_i$ 合并 $n$ 次重复实验的数据。推导 $p$ 的后验分布，并计算 $TS = 1 - p$ 的后验均值以及 $TS$ 的中心 $100 \\times 0.95$ 可信区间。先验必须是 $p \\sim \\mathrm{Beta}(a_0,b_0)$，其中 $a_0 = 1$ 且 $b_0 = 1$。通过 $p$ 的后验分布的精确分位数以及变换 $TS = 1 - p$ 来表示下界和上界。\n2) 对于具有匹配暴露度的过度离散独立计数模型，使用条件二项性质 $D_i \\mid T_i \\sim \\mathrm{Binomial}(T_i, q)$，其中 $T_i = U_i + D_i$，该性质可从每次重复具有共享暴露参数的泊松模型中推导得出。通过 $S_U = \\sum_{i=1}^n U_i$ 和 $S_D = \\sum_{i=1}^n D_i$ 合并 $n$ 次重复实验的数据，以获得后验分布 $q \\mid \\{(U_i,D_i)\\} \\sim \\mathrm{Beta}(a_0 + S_D, b_0 + S_U)$，其中 $a_0 = 1$ 且 $b_0 = 1$。将其转换为终止子强度 $TS = 1 - r$，其中 $r = q/(1 - q)$。计算：\n- 当存在精确表达式时，使用该表达式计算 $TS$ 的后验均值。\n- 使用对 $q$ 的 Beta 后验分布的单调分位数变换计算中心 $100 \\times 0.95$ 可信区间。\n\n数值和输出要求：\n- 所有测试用例均使用 $a_0 = 1$ 和 $b_0 = 1$ 以及 $0.95$ 的可信水平。\n- 对于二项模型，假设对所有重复实验 $i$ 都有 $D_i \\le U_i$。\n- 对于过度离散模型，根据泊松-伽马构造，假设每次重复实验内部具有匹配的暴露度；不要求 $D_i \\le U_i$ 的约束，但为了科学真实性，测试套件中的数据被选择为满足 $D_i \\le U_i$。\n- 您的程序必须生成单行输出，其中包含一个结果列表，每个测试用例对应一个结果。每个结果都是一个包含三个浮点数的列表：$TS$ 的后验均值，中心 $0.95$ 可信区间的下界和上界。将每个值四舍五入到 $6$ 位小数。最终输出必须是 `[[m1,l1,u1],[m2,l2,u2],...]` 形式的单行。\n\n测试套件：\n- 案例 1（二项模型，理想路径）：重复数据 $[(100,20),(120,30),(80,12)]$。\n- 案例 2（二项模型，边界情况：完全终止）：重复数据 $[(50,0),(75,0),(60,0)]$。\n- 案例 3（二项模型，边界情况：完全通读）：重复数据 $[(30,30),(40,40),(25,25)]$。\n- 案例 4（过度离散独立计数，理想路径）：重复数据 $[(1000,210),(850,180),(1200,250)]$。\n- 案例 5（过度离散独立计数，含零的稀疏数据）：重复数据 $[(5,0),(0,0),(3,1),(2,0)]$。\n\n所有计算都必须从建模假设和贝叶斯定理推导得出。不允许外部输入。唯一可接受的输出是上述单行列表。", "solution": "该问题要求在两种不同的重复计数数据生成模型下，推导和实现转录终止子强度（$TS$）的贝叶斯估计量。分析从第一性原理出发，将贝叶斯定理应用于指定的似然和先验。所需的量是 $TS$ 的后验均值和中心 $100 \\times (1-\\alpha)\\%$ 可信区间，其中 $\\alpha = 0.05$。\n\n首先，我们建立共享的贝叶斯框架。后验分布与似然和先验的乘积成正比：$P(\\theta|\\text{data}) \\propto P(\\text{data}|\\theta) P(\\theta)$，其中 $\\theta$ 代表模型参数。\n\n**模型 1：约束计数的二项模型**\n\n该模型适用于上游测量值 $U_i$ 代表转录本总群体，而下游测量值 $D_i$ 代表“通读”终止子的子群体的实验。\n\n**1. 通读概率 $p$ 的后验分布**\n\n模型假定：\n- 关于通读概率 $p$ 的先验信念：$p \\sim \\mathrm{Beta}(a_0, b_0)$。\n- 对于单次重复实验 $i$，在给定 $U_i$ 个上游计数的情况下，观察到 $D_i$ 个下游计数的似然为：$D_i | U_i, p \\sim \\mathrm{Binomial}(U_i, p)$。似然函数是 $L(p; D_i, U_i) = \\binom{U_i}{D_i} p^{D_i} (1-p)^{U_i-D_i}$。\n\n对于一组 $n$ 次独立重复实验 $\\{(U_i, D_i)\\}_{i=1}^n$，总似然是各次似然的乘积：\n$$L(p; \\{\\text{data}\\}) = \\prod_{i=1}^n \\binom{U_i}{D_i} p^{D_i} (1-p)^{U_i-D_i} \\propto p^{\\sum D_i} (1-p)^{\\sum(U_i-D_i)}$$\n令 $S_D = \\sum_{i=1}^n D_i$ 和 $S_U = \\sum_{i=1}^n U_i$ 为充分统计量。似然简化为 $L(p; S_D, S_U) \\propto p^{S_D} (1-p)^{S_U-S_D}$。\n\n$p$ 的后验分布可通过似然与先验相乘得到：\n$$P(p|S_D, S_U) \\propto p^{S_D} (1-p)^{S_U-S_D} \\times p^{a_0-1}(1-p)^{b_0-1}$$\n$$P(p|S_D, S_U) \\propto p^{a_0+S_D-1} (1-p)^{b_0+S_U-S_D-1}$$\n这是 Beta 分布的核。因此，$p$ 的后验分布为：\n$$p | S_D, S_U \\sim \\mathrm{Beta}(a_n, b_n)$$\n其中后验参数为 $a_n = a_0 + S_D$ 和 $b_n = b_0 + S_U - S_D$。\n\n**2. 终止子强度 $TS$ 的后验估计量**\n\n终止子强度定义为 $TS = 1 - p$。\n\n$TS$ 的后验均值由期望的线性性质推导得出：\n$$E[TS|\\text{data}] = E[1 - p|\\text{data}] = 1 - E[p|\\text{data}]$$\n一个 $\\mathrm{Beta}(a_n, b_n)$ 分布的均值为 $E[p|\\text{data}] = \\frac{a_n}{a_n+b_n}$。因此，\n$$E[TS|\\text{data}] = 1 - \\frac{a_n}{a_n+b_n} = \\frac{b_n}{a_n+b_n} = \\frac{b_0+S_U-S_D}{a_0+b_0+S_U}$$\n\n$TS$ 的一个中心 $100 \\times (1-\\alpha)\\%$ 可信区间可通过变换 $p$ 的区间得到。令 $F_p^{-1}(\\cdot; a_n, b_n)$ 为 $\\mathrm{Beta}(a_n, b_n)$ 后验分布的分位数函数。$p$ 的一个可信区间是 $[L_p, U_p]$，其中 $L_p = F_p^{-1}(\\alpha/2; a_n, b_n)$ 和 $U_p = F_p^{-1}(1-\\alpha/2; a_n, b_n)$。\n由于 $TS = 1 - p$ 是 $p$ 的严格单调递减函数，因此 $TS$ 对应的可信区间为 $[1-U_p, 1-L_p]$。\n下界是 $L_{TS} = 1 - F_p^{-1}(1-\\alpha/2; a_n, b_n)$，上界是 $U_{TS} = 1 - F_p^{-1}(\\alpha/2; a_n, b_n)$。对于本问题，$a_0 = 1$，$b_0 = 1$，且 $\\alpha = 0.05$。\n\n**模型 2：过度离散的独立计数模型**\n\n此模型将上游和下游计数视为独立的泊松变量，适用于这些计数是并行测量而非严格的整体与部分关系的检测。\n\n**1. 通读参数 $q$ 的后验分布**\n\n问题提供了一个源于伽马-泊松混合模型的关键结果：参数 $q = \\mu_d/(\\mu_u+\\mu_d)$ 的后验分布由下式给出\n$$q | \\{(U_i, D_i)\\} \\sim \\mathrm{Beta}(a_n', b_n')$$\n其中后验参数为 $a_n' = a_0 + S_D$ 和 $b_n' = b_0 + S_U$，其中 $S_D = \\sum D_i$ 和 $S_U = \\sum U_i$。该结果源于以总计数 $T_i = U_i+D_i$ 为条件，这会为 $D_i$ 产生一个二项似然，即 $D_i|T_i,q \\sim \\mathrm{Binomial}(T_i, q)$。汇总所有重复实验数据即可得到所述的 Beta 后验分布。\n\n**2. 终止子强度 $TS$ 的后验估计量**\n\n对于此模型，终止子强度根据通读比率 $r = \\mu_d/\\mu_u$ 定义。$q$ 和 $r$ 之间的关系是 $r = q/(1-q)$。终止子强度为 $TS = 1-r = 1 - q/(1-q)$。\n\n$TS$ 的后验均值为 $E[TS|\\text{data}] = 1 - E[r|\\text{data}] = 1 - E[q/(1-q)|\\text{data}]$。我们必须计算变换后的随机变量 $q$ 的期望：\n$$E\\left[\\frac{q}{1-q}\\right] = \\int_0^1 \\frac{q}{1-q} \\frac{q^{a_n'-1}(1-q)^{b_n'-1}}{B(a_n', b_n')} dq = \\frac{1}{B(a_n', b_n')} \\int_0^1 q^{a_n'}(1-q)^{b_n'-2} dq$$\n该积分为 $B(a_n'+1, b_n'-1)$，并且仅当 $b_n'-1 > 0$ 或 $b_n' > 1$ 时收敛。期望值为：\n$$E\\left[\\frac{q}{1-q}\\right] = \\frac{B(a_n'+1, b_n'-1)}{B(a_n', b_n')} = \\frac{\\Gamma(a_n'+1)\\Gamma(b_n'-1)}{\\Gamma(a_n'+b_n')} \\frac{\\Gamma(a_n'+b_n')}{\\Gamma(a_n')\\Gamma(b_n')} = \\frac{a_n'}{b_n'-1}$$\n因此，若满足 $b_n' = b_0 + S_U > 1$，则 $TS$ 的后验均值为：\n$$E[TS|\\text{data}] = 1 - \\frac{a_n'}{b_n'-1} = 1 - \\frac{a_0+S_D}{b_0+S_U-1}$$\n\n$TS$ 的中心 $100 \\times (1-\\alpha)\\%$ 可信区间通过变换 $q$ 的区间得到。函数 $g(q) = 1 - q/(1-q)$ 在 $q \\in [0, 1)$ 上是严格单调递减的，因为其导数为 $g'(q) = -1/(1-q)^2 < 0$。\n令 $q$ 的可信区间为 $[L_q, U_q]$，其中 $L_q = F_q^{-1}(\\alpha/2; a_n', b_n')$ 和 $U_q = F_q^{-1}(1-\\alpha/2; a_n', b_n')$。\n$TS$ 的可信区间为 $[g(U_q), g(L_q)]$。其边界为：\n$L_{TS} = g(U_q) = 1 - \\frac{U_q}{1-U_q}$\n$U_{TS} = g(L_q) = 1 - \\frac{L_q}{1-L_q}$\n对于本问题，$a_0=1$，$b_0=1$，且 $\\alpha=0.05$。存在条件 $b_n' > 1$ 变为 $1+S_U > 1$，即 $S_U > 0$，这对于指定的测试用例是成立的。\n\n这些推导出的公式被用于实现计算，以得出每个测试用例所需的值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import beta\n\ndef solve():\n    \"\"\"\n    Computes Bayesian estimates for terminator strength (TS) for a suite of test cases.\n    Two models are implemented: a binomial model and an overdispersed independent-counts model.\n    For each case, it calculates the posterior mean of TS and the 95% credible interval.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': 'binomial', 'replicates': [(100, 20), (120, 30), (80, 12)]},\n        {'type': 'binomial', 'replicates': [(50, 0), (75, 0), (60, 0)]},\n        {'type': 'binomial', 'replicates': [(30, 30), (40, 40), (25, 25)]},\n        {'type': 'overdispersed', 'replicates': [(1000, 210), (850, 180), (1200, 250)]},\n        {'type': 'overdispersed', 'replicates': [(5, 0), (0, 0), (3, 1), (2, 0)]}\n    ]\n\n    # Prior hyperparameters and credible level, as per problem specification.\n    a0 = 1.0\n    b0 = 1.0\n    credibility_level = 0.95\n    alpha = 1.0 - credibility_level\n    \n    final_results = []\n\n    for case in test_cases:\n        replicates = np.array(case['replicates'], dtype=float)\n        # Sufficient statistics: sum of upstream (U) and downstream (D) counts.\n        S_U = np.sum(replicates[:, 0])\n        S_D = np.sum(replicates[:, 1])\n\n        if case['type'] == 'binomial':\n            # Posterior parameters for p ~ Beta(a_n, b_n)\n            a_n = a0 + S_D\n            b_n = b0 + S_U - S_D\n\n            # Posterior mean of TS = 1 - p\n            # E[TS] = E[1-p] = 1 - E[p] = 1 - a_n/(a_n+b_n) = b_n/(a_n+b_n)\n            mean_ts = b_n / (a_n + b_n)\n\n            # 95% credible interval for TS\n            # TS = 1 - p is a decreasing function of p.\n            # CI for TS is [1 - U_p, 1 - L_p], where [L_p, U_p] is the CI for p.\n            l_p = beta.ppf(alpha / 2.0, a_n, b_n)\n            u_p = beta.ppf(1.0 - alpha / 2.0, a_n, b_n)\n            \n            lower_ts = 1.0 - u_p\n            upper_ts = 1.0 - l_p\n            \n        elif case['type'] == 'overdispersed':\n            # Posterior parameters for q ~ Beta(a_n', b_n')\n            a_n_prime = a0 + S_D\n            b_n_prime = b0 + S_U\n            \n            # Posterior mean of TS = 1 - r = 1 - q/(1-q)\n            # E[TS] = 1 - E[q/(1-q)]\n            # E[q/(1-q)] = a_n' / (b_n' - 1) is valid if b_n' > 1.\n            if b_n_prime <= 1.0:\n                # This should not happen with the given test cases and b0=1.\n                raise ValueError(\"Posterior mean of r is not defined for b_n' <= 1.\")\n\n            mean_ts = 1.0 - (a_n_prime / (b_n_prime - 1.0))\n            \n            # 95% Credible interval for TS\n            # g(q) = 1 - q/(1-q) is a decreasing function of q.\n            # CI for TS is [g(U_q), g(L_q)], where [L_q, U_q] is the CI for q.\n            l_q = beta.ppf(alpha / 2.0, a_n_prime, b_n_prime)\n            u_q = beta.ppf(1.0 - alpha / 2.0, a_n_prime, b_n_prime)\n\n            # Transformation g(q). Handle u_q -> 1 limit.\n            # If u_q == 1.0, r -> infinity, TS -> -infinity.\n            if u_q >= 1.0 - 1e-12: # Safety for floating point\n                 lower_ts = -np.inf\n            else:\n                 lower_ts = 1.0 - u_q / (1.0 - u_q)\n            \n            upper_ts = 1.0 - l_q / (1.0 - l_q)\n        \n        # Round results to 6 decimal places as required.\n        mean_ts_r = round(mean_ts, 6)\n        lower_ts_r = round(lower_ts, 6)\n        upper_ts_r = round(upper_ts, 6)\n        \n        final_results.append([mean_ts_r, lower_ts_r, upper_ts_r])\n\n    # Final print statement in the exact required format.\n    print(final_results)\n\nsolve()\n```", "id": "2785265"}]}