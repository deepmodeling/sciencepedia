{"hands_on_practices": [{"introduction": "启动子强度的基本量化可以通过RNA聚合酶（RNAP）结合的热力学来理解。在一个简单的可加模型中，总结合自由能 $\\Delta G$ 是各个独立启动子元件（如-10和-35盒）贡献的代数和。本练习旨在通过一个假设场景，帮助您应用这一基本原理，通过计算不同模块的能量贡献来评估整体启动子亲和力，这是设计合成启动子的核心技能之一 [@problem_id:2764635]。", "problem": "在一个用于细菌启动子的转录起始的热力学占有模型中，RNA聚合酶（RNAP）的结合被视为一个可逆的平衡过程，其中RNAP结合态的统计权重由Boltzmann统计决定。当不同的启动子接触是相互独立的时，每个接触对自由能的贡献是广延的。考虑一个启动子结构，其对RNAP结合自由能有四种贡献：-10元件、-35元件、-10和-35之间的间隔区长度/几何结构，以及上游启动子（UP）元件。一个缺少所有这四种特征的参考启动子被用作定义结合自由能标度的零点。对于一个特定的工程化启动子，测量得到的各特征对RNAP结合自由能的贡献（相对于参考启动子）如下：\n- -10元件：$-4\\,k_{\\mathrm{B}}T$\n- -35元件：$-3\\,k_{\\mathrm{B}}T$\n- 间隔区错配罚分：$+2\\,k_{\\mathrm{B}}T$\n- 上游启动子（UP）元件：$-1\\,k_{\\mathrm{B}}T$\n这里 $k_{\\mathrm{B}}$ 是Boltzmann常数，$T$ 是绝对温度。在这些接触满足标准独立性假设的情况下，该工程化启动子相对于参考启动子的RNAP结合自由能的净变化是多少？请用一个带符号的数字表示答案，单位为 $k_{\\mathrm{B}}T$（最终输入中不包含单位）。请提供精确值，无需四舍五入。", "solution": "其理论基础是结合平衡的统计力学。对于一个大分子与某个位点的结合，能量为 $E$ 的微观态的统计权重正比于 $\\exp(-\\beta E)$，其中 $\\beta = 1/(k_{\\mathrm{B}}T)$。结合自由能变化 $\\Delta G$ 通过 $\\Delta G = -k_{\\mathrm{B}}T \\ln K$ 定义了平衡常数。对于独立的子系统，总配分函数可以因子分解。\n\n具体来说，如果不同的、非相互作用的接触在形成时各自贡献一个自由能变化 $\\Delta G_{i}$，那么结合复合物相对于未结合状态的总统计权重是每个接触权重的乘积：\n$$\nw_{\\text{bound}} = \\prod_{i} \\exp\\!\\left(-\\beta \\Delta G_{i}\\right) = \\exp\\!\\left(-\\beta \\sum_{i} \\Delta G_{i}\\right).\n$$\n对上式取 $-k_{\\mathrm{B}}T \\ln(\\cdot)$ 运算可得总自由能变化：\n$$\n\\Delta G_{\\text{total}} = \\sum_{i} \\Delta G_{i}.\n$$\n因此，在独立性假设下，自由能是可加的。\n\n在本问题中，各特征的贡献已经以 $k_{\\mathrm{B}}T$ 为单位的自由能形式给出：\n- -10元件：$\\Delta G_{-10} = -4\\,k_{\\mathrm{B}}T$，\n- -35元件：$\\Delta G_{-35} = -3\\,k_{\\mathrm{B}}T$，\n- 间隔区错配罚分：$\\Delta G_{\\text{spacer}} = +2\\,k_{\\mathrm{B}}T$，\n- 上游启动子（UP）元件：$\\Delta G_{\\text{UP}} = -1\\,k_{\\mathrm{B}}T$。\n\n相对于参考启动子，RNAP结合自由能的净变化为\n$$\n\\Delta G_{\\text{total}} \\;=\\; \\Delta G_{-10} + \\Delta G_{-35} + \\Delta G_{\\text{spacer}} + \\Delta G_{\\text{UP}}\n\\;=\\; (-4 - 3 + 2 - 1)\\,k_{\\mathrm{B}}T\n\\;=\\; -6\\,k_{\\mathrm{B}}T.\n$$\n题目要求以 $k_{\\mathrm{B}}T$ 为单位，用一个带符号的数字表示答案（最终输入中省略单位），因此所需的数值是-6。", "answer": "$$\\boxed{-6}$$", "id": "2764635"}, {"introduction": "超越静态的热力学平衡模型，转录起始实际上是一个动态的多步骤过程。本练习将引导您分析一个更符合实际的动力学模型，该模型包括了RNAP的结合、形成开放复合体（异构化）以及启动子逃逸等关键步骤。通过从基本原理推导平均首通时间，您将能够计算出整体的转录起始速率，从而更深入地理解启动子动力学如何决定基因表达的速率 [@problem_id:2764691]。", "problem": "一位合成生物学家正在量化核心启动子元件如何调控脱氧核糖核酸(DNA)上的核糖核酸(RNA)聚合酶(RNAP)的转录起始动力学。考虑一个核心启动子的最小、机制上可解释的模型，其中启动子在起始过程中经历三个动力学上定义的状态循环：\n- 自由启动子状态，记为 $F$。\n- RNAP已结合但DNA尚未解旋的闭合复合物状态，记为 $C$。\n- DNA已解旋且复合物能够进行启动子逃逸的开放复合物状态，记为 $O$。\n\n假设存在以下转变：\n- 结合：$F \\xrightarrow{k_{\\mathrm{on}}[P]} C$，其中 $[P]$ 是RNAP浓度，而 $k_{\\mathrm{on}}$ 是双分子结合速率常数。在伪一级反应条件下，$k_{\\mathrm{on}}[P]$ 是一个有效的一级速率。\n- 解离（从 $C$ 开始）：$C \\xrightarrow{k_{\\mathrm{off}}} F$。\n- 异构化为开放复合物：$C \\xrightarrow{k_{\\mathrm{iso}}} O$。\n- 启动子逃逸（生产性起始）：$O \\xrightarrow{k_{\\mathrm{esc}}} F + \\text{转录本}$。\n\n假设在所关心的时间尺度上，异构化是有效不可逆的（不存在逆反应 $O \\to C$），并且每次启动子逃逸都会产生一个起始转录本，并使启动子返回到 $F$ 状态。有效起始速率 $r$ 定义为，在稳态下，从 $F$ 状态到下一次启动子逃逸事件的平均等待时间的倒数。\n\n从化学动力学和连续时间马尔可夫过程中的平均首达时间的第一性原理出发，推导出一个用 $k_{\\mathrm{on}}[P]$、$k_{\\mathrm{off}}$、$k_{\\mathrm{iso}}$ 和 $k_{\\mathrm{esc}}$ 表示的 $r$ 的表达式。然后，使用 $k_{\\mathrm{on}}[P]=1\\,\\mathrm{s}^{-1}$、$k_{\\mathrm{off}}=0.5\\,\\mathrm{s}^{-1}$、$k_{\\mathrm{iso}}=0.1\\,\\mathrm{s}^{-1}$ 和 $k_{\\mathrm{esc}}=0.2\\,\\mathrm{s}^{-1}$ 计算 $r$ 的数值。\n\n将你的最终数值答案以 $\\mathrm{s}^{-1}$ 为单位表示为精确分数（无需四舍五入）。在你最终的方框答案中不要包含单位。", "solution": "必须首先严格验证问题陈述。\n\n第1步：提取给定条件。\n系统包含一个启动子的三种状态：\n- $F$：自由启动子状态。\n- $C$：闭合复合物状态。\n- $O$：开放复合物状态。\n\n动力学转变被给定为一个连续时间马尔可夫过程：\n1.  结合：$F \\xrightarrow{k_{\\mathrm{on}}[P]} C$，其中 $[P]$ 是RNA聚合酶(RNAP)的浓度，而 $k_{\\mathrm{on}}$ 是双分子速率常数。有效的一级速率是 $k_{\\mathrm{on}}[P]$。\n2.  解离：$C \\xrightarrow{k_{\\mathrm{off}}} F$。\n3.  异构化：$C \\xrightarrow{k_{\\mathrm{iso}}} O$。题目陈述其为有效不可逆的。\n4.  启动子逃逸：$O \\xrightarrow{k_{\\mathrm{esc}}} F + \\text{转录本}$。此步是生产性的，并将系统重置到状态 $F$。\n\n目标是求出有效起始速率 $r$，其定义为从状态 $F$ 到下一次启动子逃逸事件的平均等待时间的倒数。这是一个平均首达时间(MFPT)问题。\n\n提供的速率常数值为：\n- $k_{\\mathrm{on}}[P] = 1\\,\\mathrm{s}^{-1}$\n- $k_{\\mathrm{off}} = 0.5\\,\\mathrm{s}^{-1}$\n- $k_{\\mathrm{iso}} = 0.1\\,\\mathrm{s}^{-1}$\n- $k_{\\mathrm{esc}} = 0.2\\,\\mathrm{s}^{-1}$\n\n第2步：使用已提取的给定条件进行验证。\n根据验证标准对问题进行分析：\n- **科学依据**：该三态模型($F \\rightleftharpoons C \\to O \\to F$) 是一个标准的，尽管是简化的，转录起始动力学模型。它是定量分子生物学和生物物理学中的一个基本概念。该模型是科学上合理的。\n- **适定性**：问题定义清晰。它要求为一个给定的随机过程计算一个特定的、明确定义的量（平均首达时间的倒数）。所有必要的参数均已提供。\n- **客观性**：问题使用了精确、客观和正式的科学语言进行陈述。没有模糊性或主观性。\n\n该问题满足一个有效科学问题的所有标准。它是自洽的、一致的，并基于化学动力学和随机过程的既定原理。没有任何缺陷。\n\n第3步：结论与行动。\n该问题是有效的。将推导一个完整的解。\n\n问题要求计算有效起始速率 $r$，该速率定义为启动子从自由状态 $F$ 开始经历一次启动子逃逸事件所需的平均首达时间(MFPT) $\\tau_F$ 的倒数。启动子逃逸从状态 $O$ 发生。\n\n设 $\\tau_i$ 为系统从状态 $i \\in \\{F, C, O\\}$ 开始到达逃逸事件的MFPT。我们可以根据连续时间马尔可夫过程的原理，为这些平均时间建立一个线性方程组。\n\n从状态 $i$ 到达吸收态的平均时间，是在任何转变发生前停留在状态 $i$ 的平均时间，加上从其可以转变到的状态 $j$ 开始的MFPT的加权平均值。停留在状态 $i$ 的平均时间是离开 $i$ 的所有速率之和的倒数。\n\n1.  对于状态 $F$：唯一的离开路径是到状态 $C$，速率为 $k_{\\mathrm{on}}[P]$。在 $F$ 中停留的平均时间是 $1/(k_{\\mathrm{on}}[P])$。此后，系统进入状态 $C$。因此，从 $F$ 开始的MFPT是：\n    $$ \\tau_F = \\frac{1}{k_{\\mathrm{on}}[P]} + \\tau_C $$\n\n2.  对于状态 $C$：有两个离开路径：以速率 $k_{\\mathrm{off}}$ 到 $F$ 和以速率 $k_{\\mathrm{iso}}$ 到 $O$。总离开速率为 $k_{\\mathrm{off}} + k_{\\mathrm{iso}}$。在 $C$ 中停留的平均时间是 $1/(k_{\\mathrm{off}} + k_{\\mathrm{iso}})$。从 $C$ 开始，过程以概率 $P_{C \\to F} = \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}}$ 转变到状态 $F$，以概率 $P_{C \\to O} = \\frac{k_{\\mathrm{iso}}}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}}$ 转变到状态 $O$。关于 $\\tau_C$ 的方程是：\n    $$ \\tau_C = \\frac{1}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}} + \\left(\\frac{k_{\\mathrm{off}}}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}}\\right)\\tau_F + \\left(\\frac{k_{\\mathrm{iso}}}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}}\\right)\\tau_O $$\n\n3.  对于状态 $O$：唯一的离开路径是启动子逃逸，速率为 $k_{\\mathrm{esc}}$。这是目标“吸收”事件。从状态 $O$ 逃逸的平均时间就是该状态的平均寿命。\n    $$ \\tau_O = \\frac{1}{k_{\\mathrm{esc}}} $$\n\n我们现在有了一个三元线性方程组。我们的目标是解出 $\\tau_F$。\n首先，将 $\\tau_O$ 的表达式代入 $\\tau_C$ 的方程中：\n$$ \\tau_C = \\frac{1}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}} + \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}}\\tau_F + \\frac{k_{\\mathrm{iso}}}{(k_{\\mathrm{off}} + k_{\\mathrm{iso}})k_{\\mathrm{esc}}} $$\n\n接下来，将这个 $\\tau_C$ 的表达式代入 $\\tau_F$ 的方程中：\n$$ \\tau_F = \\frac{1}{k_{\\mathrm{on}}[P]} + \\left( \\frac{1}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}} + \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}}\\tau_F + \\frac{k_{\\mathrm{iso}}}{(k_{\\mathrm{off}} + k_{\\mathrm{iso}})k_{\\mathrm{esc}}} \\right) $$\n\n现在，我们必须用代数方法分离出 $\\tau_F$：\n$$ \\tau_F - \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}}\\tau_F = \\frac{1}{k_{\\mathrm{on}}[P]} + \\frac{1}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}} + \\frac{k_{\\mathrm{iso}}}{(k_{\\mathrm{off}} + k_{\\mathrm{iso}})k_{\\mathrm{esc}}} $$\n\n在等式左边提出因子 $\\tau_F$：\n$$ \\tau_F \\left( 1 - \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}} \\right) = \\tau_F \\left( \\frac{k_{\\mathrm{off}} + k_{\\mathrm{iso}} - k_{\\mathrm{off}}}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}} \\right) = \\tau_F \\left( \\frac{k_{\\mathrm{iso}}}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}} \\right) $$\n\n因此，方程变为：\n$$ \\tau_F \\left( \\frac{k_{\\mathrm{iso}}}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}} \\right) = \\frac{1}{k_{\\mathrm{on}}[P]} + \\frac{1}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}} + \\frac{k_{\\mathrm{iso}}}{(k_{\\mathrm{off}} + k_{\\mathrm{iso}})k_{\\mathrm{esc}}} $$\n\n为了解出 $\\tau_F$，两边同乘以 $\\frac{k_{\\mathrm{off}} + k_{\\mathrm{iso}}}{k_{\\mathrm{iso}}}$：\n$$ \\tau_F = \\frac{k_{\\mathrm{off}} + k_{\\mathrm{iso}}}{k_{\\mathrm{iso}}} \\left( \\frac{1}{k_{\\mathrm{on}}[P]} + \\frac{1}{k_{\\mathrm{off}} + k_{\\mathrm{iso}}} + \\frac{k_{\\mathrm{iso}}}{(k_{\\mathrm{off}} + k_{\\mathrm{iso}})k_{\\mathrm{esc}}} \\right) $$\n将此项展开得到：\n$$ \\tau_F = \\frac{k_{\\mathrm{off}} + k_{\\mathrm{iso}}}{k_{\\mathrm{on}}[P]k_{\\mathrm{iso}}} + \\frac{1}{k_{\\mathrm{iso}}} + \\frac{1}{k_{\\mathrm{esc}}} $$\n\n这个 $\\tau_F$ 的表达式是从启动子处于状态 $F$ 到第一个转录本产生所需的平均时间。有效起始速率 $r$ 是这个时间的倒数：\n$$ r = \\frac{1}{\\tau_F} = \\left( \\frac{k_{\\mathrm{off}} + k_{\\mathrm{iso}}}{k_{\\mathrm{on}}[P]k_{\\mathrm{iso}}} + \\frac{1}{k_{\\mathrm{iso}}} + \\frac{1}{k_{\\mathrm{esc}}} \\right)^{-1} $$\n通过对 $\\tau_F$ 的各项进行通分，可以找到一个更紧凑的 $r$ 的表达式：\n$$ \\tau_F = \\frac{(k_{\\mathrm{off}} + k_{\\mathrm{iso}})k_{\\mathrm{esc}} + k_{\\mathrm{on}}[P]k_{\\mathrm{esc}} + k_{\\mathrm{on}}[P]k_{\\mathrm{iso}}}{k_{\\mathrm{on}}[P]k_{\\mathrm{iso}}k_{\\mathrm{esc}}} = \\frac{k_{\\mathrm{off}}k_{\\mathrm{esc}} + k_{\\mathrm{iso}}k_{\\mathrm{esc}} + k_{\\mathrm{on}}[P]k_{\\mathrm{esc}} + k_{\\mathrm{on}}[P]k_{\\mathrm{iso}}}{k_{\\mathrm{on}}[P]k_{\\mathrm{iso}}k_{\\mathrm{esc}}} $$\n因此，速率 $r$ 为：\n$$ r = \\frac{k_{\\mathrm{on}}[P]k_{\\mathrm{iso}}k_{\\mathrm{esc}}}{k_{\\mathrm{off}}k_{\\mathrm{esc}} + k_{\\mathrm{iso}}k_{\\mathrm{esc}} + k_{\\mathrm{on}}[P]k_{\\mathrm{esc}} + k_{\\mathrm{on}}[P]k_{\\mathrm{iso}}} $$\n\n现在，我们使用所提供的数据计算数值：\n$k_{\\mathrm{on}}[P] = 1\\,\\mathrm{s}^{-1}$\n$k_{\\mathrm{off}} = 0.5\\,\\mathrm{s}^{-1}$\n$k_{\\mathrm{iso}} = 0.1\\,\\mathrm{s}^{-1}$\n$k_{\\mathrm{esc}} = 0.2\\,\\mathrm{s}^{-1}$\n\n先计算 $\\tau_F$ 会更简单：\n$$ \\tau_F = \\frac{k_{\\mathrm{off}} + k_{\\mathrm{iso}}}{k_{\\mathrm{on}}[P]k_{\\mathrm{iso}}} + \\frac{1}{k_{\\mathrm{iso}}} + \\frac{1}{k_{\\mathrm{esc}}} $$\n$$ \\tau_F = \\frac{0.5 + 0.1}{1 \\times 0.1} + \\frac{1}{0.1} + \\frac{1}{0.2} $$\n$$ \\tau_F = \\frac{0.6}{0.1} + 10 + 5 $$\n$$ \\tau_F = 6 + 10 + 5 = 21\\,\\mathrm{s} $$\n\n有效起始速率 $r$ 是 $\\tau_F$ 的倒数：\n$$ r = \\frac{1}{\\tau_F} = \\frac{1}{21}\\,\\mathrm{s}^{-1} $$\n问题要求以精确分数作答。结果已经是这种形式。", "answer": "$$\\boxed{\\frac{1}{21}}$$", "id": "2764691"}, {"introduction": "在合成生物学实践中，一个关键挑战是区分元件的“内在”功能与“背景”效应，即其在细胞中所处基因组位置的影响。本练习将理论付诸实践，要求您设计一个计算流程，以从模拟的表达数据中分离出启动子的内在强度和基因组位置效应。通过在一个可加的对数线性模型下解决这个反演问题，您将掌握一种在现代定量生物学中至关重要的数据分析方法 [@problem_id:2764696]。", "problem": "设计并实现一个程序，该程序能够在给定一组启动子在多个独立基因组插入位点整合后的转录输出测量值的情况下，利用多个独立的基因组插入位点，从基因组环境效应中解卷积出内在的启动子强度。从以下基本依据出发：分子生物学中心法则（脱氧核糖核酸到核糖核酸到蛋白质），以及一个广泛使用的观察结果：在稳态报告基因分析中，信使核糖核酸的翻译和降解速度很快，其时间尺度长于转录起始，此时稳态报告信号与转录起始速率成正比。在合成生物学中，对于核心启动子功能，一个标准且经过充分检验的假设是，内在启动子强度和基因组环境对转录速率的贡献是乘性的，因此经过对数变换后，其贡献是加性的。在此基础上，在重复实验 $r$ 中，位于插入位点 $j$ 的启动子 $i$ 的测量对数表达量可以建模为一个内在启动子项、一个位点环境项和一个均值为零的残差之和。\n\n您的任务是，针对以下每个测试用例，从基于已知真实值构建的合成数据集中，恢复内在启动子强度和位点效应。仅使用线性代数推理，并实现一个在可识别性约束下最小化残差平方和的估计量。\n\n数学模型与可识别性：\n- 假设有 $P$ 个启动子，$S$ 个位点，每个启动子-位点组合有 $R$ 次重复实验。\n- 设 $\\alpha_i$ 为启动子 $i \\in \\{0,1,\\ldots,P-1\\}$ 在对数尺度上的内在强度。\n- 设 $\\beta_j$ 为位点 $j \\in \\{0,1,\\ldots,S-1\\}$ 在对数尺度上的位点效应。\n- 设 $\\varepsilon_{i,j,r}$ 为根据每个测试用例指定方式构建的确定性均值为零的残差。\n- 测量的对数表达量为\n$$\ny_{i,j,r} = \\alpha_i + \\beta_j + \\varepsilon_{i,j,r}。\n$$\n- 施加可识别性约束\n$$\n\\sum_{i=0}^{P-1} \\alpha_i = 0, \\qquad \\sum_{j=0}^{S-1} \\beta_j = 0。\n$$\n- 通过最小化以下表达式来估计 $(\\alpha_i)_{i=0}^{P-1}$ 和 $(\\beta_j)_{j=0}^{S-1}$\n$$\n\\sum_{i=0}^{P-1} \\sum_{j=0}^{S-1} \\sum_{r=0}^{R-1} \\left(y_{i,j,r} - \\alpha_i - \\beta_j\\right)^2\n$$\n并服从上述两个线性等式约束。\n\n测试套件（所有值均为无单位的对数表达单位）：\n\n情况 A（一般情况，平衡）：\n- $P = 5$, $S = 4$, $R = 2$。\n- 真实内在启动子向量\n$$\n\\boldsymbol{\\alpha}^{\\star} = (-0.40, -0.10, 0.00, 0.20, 0.30),\n$$\n其满足 $\\sum_i \\alpha_i^{\\star} = 0$。\n- 真实位点环境向量\n$$\n\\boldsymbol{\\beta}^{\\star} = (-0.30, -0.10, 0.15, 0.25),\n$$\n其满足 $\\sum_j \\beta_j^{\\star} = 0$。\n- 残差由以下公式确定性地定义\n$$\n\\varepsilon_{i,j,r} = \\delta \\cdot (-1)^r \\cdot \\frac{i - j}{P+S}, \\quad \\delta = 0.02,\n$$\n对于 $i \\in \\{0,1,2,3,4\\}$, $j \\in \\{0,1,2,3\\}$, $r \\in \\{0,1\\}$。\n\n情况 B（边界情况：无位点效应）：\n- $P = 4$, $S = 3$, $R = 3$。\n- 真实内在启动子向量\n$$\n\\boldsymbol{\\alpha}^{\\star} = (-0.30, -0.05, 0.10, 0.25), \\quad \\sum_i \\alpha_i^{\\star} = 0.\n$$\n- 真实位点环境向量\n$$\n\\boldsymbol{\\beta}^{\\star} = (0.00, 0.00, 0.00).\n$$\n- 残差：\n$$\n\\varepsilon_{i,j,r} = \\delta \\cdot (-1)^r \\cdot \\frac{i - j}{P+S}, \\quad \\delta = 0.015,\n$$\n对于 $i \\in \\{0,1,2,3\\}$, $j \\in \\{0,1,2\\}$, $r \\in \\{0,1,2\\}$。\n\n情况 C（极端情况：单次重复，更强的位点变异）：\n- $P = 6$, $S = 5$, $R = 1$。\n- 真实内在启动子向量\n$$\n\\boldsymbol{\\alpha}^{\\star} = (-0.50, -0.20, -0.05, 0.10, 0.25, 0.40), \\quad \\sum_i \\alpha_i^{\\star} = 0.\n$$\n- 真实位点环境向量\n$$\n\\boldsymbol{\\beta}^{\\star} = (-0.40, -0.15, -0.05, 0.20, 0.40), \\quad \\sum_j \\beta_j^{\\star} = 0.\n$$\n- 残差：\n$$\n\\varepsilon_{i,j,0} = \\delta \\cdot \\frac{i - j}{P+S}, \\quad \\delta = 0.03,\n$$\n对于 $i \\in \\{0,1,2,3,4,5\\}$, $j \\in \\{0,1,2,3,4\\}$。\n\n程序要求：\n- 对于每种情况，根据上述定义构建所有的 $y_{i,j,r}$。\n- 在和为零的约束下，为 $(\\alpha_i)$ 和 $(\\beta_j)$ 构建并求解约束最小二乘估计问题。\n- 对于每种情况，计算启动子估计值和位点估计值的均方根误差（RMSE）：\n$$\n\\operatorname{RMSE}_{\\alpha} = \\sqrt{\\frac{1}{P}\\sum_{i=0}^{P-1} \\left(\\widehat{\\alpha}_i - \\alpha_i^{\\star}\\right)^2}, \\quad\n\\operatorname{RMSE}_{\\beta} = \\sqrt{\\frac{1}{S}\\sum_{j=0}^{S-1} \\left(\\widehat{\\beta}_j - \\beta_j^{\\star}\\right)^2}.\n$$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。\n- 条目必须按顺序为：\n$$\n[\\operatorname{RMSE}_{\\alpha}^{(A)}, \\operatorname{RMSE}_{\\beta}^{(A)}, \\operatorname{RMSE}_{\\alpha}^{(B)}, \\operatorname{RMSE}_{\\beta}^{(B)}, \\operatorname{RMSE}_{\\alpha}^{(C)}, \\operatorname{RMSE}_{\\beta}^{(C)}].\n$$\n- 每个值必须四舍五入到六位小数，并以不带任何单位的小数形式打印。", "solution": "该问题要求从模拟的基因表达数据中解卷积出内在的启动子强度和基因组环境效应。所提供的模型是定量生物学中的一个标准线性模型，其中测量量的对数是各贡献因素的总和。我将首先验证问题陈述，然后提出一个完整的解析解，该解将以计算方式实现。\n\n该问题已经过验证，被认为是科学上合理、适定且完整的。它代表了统计遗传学和合成生物学中的一个标准参数估计任务，被表述为一个约束最小二乘优化问题。\n\n用于测量启动子 $i$ 在位点 $j$ 的重复实验 $r$ 中的对数表达量 $y_{i,j,r}$ 的模型由下式给出：\n$$\ny_{i,j,r} = \\alpha_i + \\beta_j + \\varepsilon_{i,j,r}\n$$\n其中 $\\alpha_i$ 是内在启动子强度，$\\beta_j$ 是位点效应，$\\varepsilon_{i,j,r}$ 是残差项。给定 $P$ 个启动子，$S$ 个位点，以及每个组合的 $R$ 次重复实验。参数 $(\\alpha_i)_{i=0}^{P-1}$ 和 $(\\beta_j)_{j=0}^{S-1}$ 将通过最小化残差平方和（RSS）来估计：\n$$\n\\text{RSS} = \\sum_{i=0}^{P-1} \\sum_{j=0}^{S-1} \\sum_{r=0}^{R-1} \\left(y_{i,j,r} - \\alpha_i - \\beta_j\\right)^2\n$$\n此估计受可识别性约束的限制，这些约束消除了加性模型中固有的模糊性（例如，将一个常数加到所有 $\\alpha_i$ 上，同时从所有 $\\beta_j$ 中减去它，并不会改变它们的和）。约束条件为：\n$$\n\\sum_{i=0}^{P-1} \\alpha_i = 0, \\qquad \\sum_{j=0}^{S-1} \\beta_j = 0\n$$\n这是一个经典的约束优化问题，可以使用拉格朗日乘子法求解。拉格朗日函数 $\\mathcal{L}$ 构建如下：\n$$\n\\mathcal{L}(\\boldsymbol{\\alpha}, \\boldsymbol{\\beta}, \\lambda_1, \\lambda_2) = \\sum_{i=0}^{P-1} \\sum_{j=0}^{S-1} \\sum_{r=0}^{R-1} (y_{i,j,r} - \\alpha_i - \\beta_j)^2 - \\lambda_1 \\sum_{i=0}^{P-1} \\alpha_i - \\lambda_2 \\sum_{j=0}^{S-1} \\beta_j\n$$\n为了找到最优参数，我们将 $\\mathcal{L}$ 对每个 $\\alpha_k$ 和 $\\beta_l$ 的偏导数设为零。\n\n对 $\\alpha_k$ 求导：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\alpha_k} = -2 \\sum_{j=0}^{S-1} \\sum_{r=0}^{R-1} (y_{k,j,r} - \\alpha_k - \\beta_j) - \\lambda_1 = 0\n$$\n$$\n\\sum_{j=0}^{S-1} \\sum_{r=0}^{R-1} (y_{k,j,r} - \\alpha_k - \\beta_j) = -\\frac{\\lambda_1}{2}\n$$\n$$\nSR\\alpha_k + R\\sum_{j=0}^{S-1}\\beta_j = \\sum_{j,r}y_{k,j,r} + \\frac{\\lambda_1}{2}\n$$\n使用约束 $\\sum_j \\beta_j = 0$，这可以简化为：\n$$\nSR\\alpha_k = y_{k..} + \\frac{\\lambda_1}{2}\n$$\n其中 $y_{k..} = \\sum_{j,r} y_{k,j,r}$。\n\n对 $\\beta_l$ 求导：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\beta_l} = -2 \\sum_{i=0}^{P-1} \\sum_{r=0}^{R-1} (y_{i,l,r} - \\alpha_i - \\beta_l) - \\lambda_2 = 0\n$$\n$$\n PR\\beta_l + R\\sum_{i=0}^{P-1}\\alpha_i = \\sum_{i,r}y_{i,l,r} + \\frac{\\lambda_2}{2}\n$$\n使用约束 $\\sum_i \\alpha_i = 0$，这可以简化为：\n$$\nPR\\beta_l = y_{.l.} + \\frac{\\lambda_2}{2}\n$$\n其中 $y_{.l.} = \\sum_{i,r} y_{i,l,r}$。\n\n现在，我们再次使用约束来求解拉格朗日乘子 $\\lambda_1$ 和 $\\lambda_2$。将关于 $\\alpha_k$ 的方程对所有 $k$ 求和：\n$$\nSR\\sum_{k=0}^{P-1}\\alpha_k = \\sum_{k=0}^{P-1} y_{k..} + P\\frac{\\lambda_1}{2}\n$$\n$$\n0 = y_{...} + P\\frac{\\lambda_1}{2} \\implies \\lambda_1 = -\\frac{2y_{...}}{P}\n$$\n其中 $y_{...} = \\sum_{i,j,r} y_{i,j,r}$。\n\n将关于 $\\beta_l$ 的方程对所有 $l$ 求和：\n$$\nPR\\sum_{l=0}^{S-1}\\beta_l = \\sum_{l=0}^{S-1} y_{.l.} + S\\frac{\\lambda_2}{2}\n$$\n$$\n0 = y_{...} + S\\frac{\\lambda_2}{2} \\implies \\lambda_2 = -\\frac{2y_{...}}{S}\n$$\n将 $\\lambda_1$ 代回到关于 $\\alpha_k$ 的方程中：\n$$\nSR\\hat{\\alpha}_k = y_{k..} - \\frac{y_{...}}{P} \\implies \\hat{\\alpha}_k = \\frac{y_{k..}}{SR} - \\frac{y_{...}}{PSR}\n$$\n设 $\\bar{y}_{k..} = \\frac{y_{k..}}{SR}$ 为启动子 $k$ 的平均表达量，$\\bar{y}_{...} = \\frac{y_{...}}{PSR}$ 为总平均值。$\\alpha_k$ 的估计量为：\n$$\n\\hat{\\alpha}_k = \\bar{y}_{k..} - \\bar{y}_{...}\n$$\n同理，将 $\\lambda_2$ 代回到关于 $\\beta_l$ 的方程中：\n$$\nPR\\hat{\\beta}_l = y_{.l.} - \\frac{y_{...}}{S} \\implies \\hat{\\beta}_l = \\frac{y_{.l.}}{PR} - \\frac{y_{...}}{PSR}\n$$\n设 $\\bar{y}_{.l.} = \\frac{y_{.l.}}{PR}$ 为位点 $l$ 的平均表达量。$\\beta_l$ 的估计量为：\n$$\n\\hat{\\beta}_l = \\bar{y}_{.l.} - \\bar{y}_{...}\n$$\n这些估计量是带有和为零约束的双因素方差分析（ANOVA）模型中的标准解。它们很直观：给定启动子的效应是其平均表达量，并根据总体平均表达水平进行了校正。\n\n实现计划如下：\n1. 对于每个测试用例，使用提供的真实值参数 $\\boldsymbol{\\alpha}^{\\star}$、$\\boldsymbol{\\beta}^{\\star}$ 和指定的确定性残差函数 $\\varepsilon_{i,j,r}$，生成大小为 $(P, S, R)$ 的完整数据张量 $y_{i,j,r}$。\n2. 计算所需的均值：总均值 $\\bar{y}_{...}$，各启动子的均值 $\\bar{y}_{i..}$，以及各位点的均值 $\\bar{y}_{.j.}$。\n3. 应用推导出的公式计算估计参数 $\\widehat{\\boldsymbol{\\alpha}}$ 和 $\\widehat{\\boldsymbol{\\beta}}$。\n4. 计算启动子和位点估计值相对于其真实值的均方根误差（RMSE）：\n$$\n\\operatorname{RMSE}_{\\alpha} = \\sqrt{\\frac{1}{P}\\sum_{i=0}^{P-1} \\left(\\widehat{\\alpha}_i - \\alpha_i^{\\star}\\right)^2}\n$$\n$$\n\\operatorname{RMSE}_{\\beta} = \\sqrt{\\frac{1}{S}\\sum_{j=0}^{S-1} \\left(\\widehat{\\beta}_j - \\beta_j^{\\star}\\right)^2}\n$$\n5. 将所有测试用例的结果整合到指定的输出格式中。这是一个基于上述解析解的纯计算过程。", "answer": "$$\\boxed{[0.000000,0.000000,0.000722,0.000962,0.000996,0.001195]}$$", "id": "2764696"}]}