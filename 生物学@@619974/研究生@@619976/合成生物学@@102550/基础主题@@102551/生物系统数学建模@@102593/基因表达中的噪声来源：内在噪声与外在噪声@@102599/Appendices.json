{"hands_on_practices": [{"introduction": "在基因表达的研究中，一个关键特征是即使在基因完全相同的细胞群体中，蛋白质水平也存在显著的细胞间差异。为了系统地研究这种现象，我们需要一个标准化的度量来量化其总体变异性，即“总噪音”。本练习将引导您计算变异系数的平方（$CV^2$），这是一个用于衡量总噪音的关键指标，帮助您将抽象的统计概念与具体的生物学可变性联系起来 [@problem_id:1440232]。", "problem": "在一项合成生物学实验中，一个由遗传上相同的大肠杆菌（E. coli）组成的菌群被改造以组成型表达一种荧光蛋白。由于生化过程的内在随机性，每个细胞中的蛋白质分子数量并不相同。一位研究人员使用荧光显微技术和单细胞分析，对大量这些细胞中蛋白质数量的统计分布进行了表征。\n\n分析得出以下结果：\n- 每个细胞的蛋白质分子平均数为200。\n- 细胞群体中蛋白质分子数量的方差为4000分子$^2$。\n\n基因表达中的总噪声通常用变异系数的平方来量化，即方差与平均值平方的比值。计算这个值，并选择下面同时提供正确数值和最准确物理解释的选项。\n\nA. 该值为0.1。这代表了总噪声，量化了所有随机性来源综合作用下蛋白质水平的整体细胞间变异性。\n\nB. 该值为20。这表明系统的噪声是纯粹泊松过程的20倍，在泊松过程中方差等于均值。\n\nC. 该值为0.1。这仅代表内在噪声，其源于该特定基因转录和翻译事件的随机时机。\n\nD. 该值为0.005。这代表外在噪声，其源于共享细胞组分（如核糖体和聚合酶）的变动。\n\nE. 该值为10。这是总噪声的倒数，表明蛋白质表达具有高度的精确性。", "solution": "我们已知每个细胞的平均蛋白质数量（用 $\\mu$ 表示）和群体中的方差（用 $\\sigma^{2}$ 表示）。具体来说，$\\mu=200$ 且 $\\sigma^{2}=4000$ 分子$^{2}$。\n\n量化总噪声的变异系数的平方定义为\n$$\n\\mathrm{CV}^{2}=\\frac{\\sigma^{2}}{\\mu^{2}}.\n$$\n代入给定值，\n$$\n\\mathrm{CV}^{2}=\\frac{4000}{(200)^{2}}=\\frac{4000}{40000}=0.1.\n$$\n\n解释：\n- $\\mathrm{CV}^{2}$ 衡量了经平均值平方归一化后的总细胞间变异性，从而捕捉了所有随机性来源（内在和外在）的综合效应。\n- 对于泊松过程，$\\sigma^{2}=\\mu$，因此 $\\mathrm{CV}^{2}=\\frac{\\mu}{\\mu^{2}}=\\frac{1}{\\mu}=\\frac{1}{200}=0.005$。观测值 $0.1$ 是这个泊松基线的 $20$ 倍，但噪声值本身是 $0.1$，而不是 $20$。\n- 因此，正确的选项必须报告数值为 $0.1$ 并将其识别为总噪声，而不是单独的内在噪声或外在噪声。\n\n因此，正确选项是A。", "answer": "$$\\boxed{A}$$", "id": "1440232"}, {"introduction": "在量化了总噪音之后，系统生物学的一个核心挑战是将其分解为“内在”和“外在”两个部分。本练习将向您介绍一种强大的实验分析技术——双报告基因分析法，它利用两个由相同启动子驱动的报告基因之间的协方差来特异性地分离外在噪音。通过这个实践，您将学会如何从模拟的实验数据中计算出外在噪音的大小，这是理解细胞环境波动如何影响基因表达的关键一步 [@problem_id:1444520]。", "problem": "一位合成生物学家正在研究一个细菌种群中基因表达的随机性。实验使用了一个双报告系统，其中单个质粒携带两个相同的基因启动子。每个启动子驱动一种不同的荧光蛋白的表达：蛋白C（青色）和蛋白Y（黄色）。使用流式细胞术测量单个细胞的荧光强度，从而提供整个种群蛋白质表达水平的统计快照。\n\n每种蛋白质表达水平的总变异性来自两个来源：‘内在噪声’（intrinsic noise），它特定于每个基因拷贝的生物化学反应；以及‘外在噪声’（extrinsic noise），它源于共享细胞环境的波动并同时影响两个基因。\n\n对流式细胞术数据的分析得出了以下统计矩，强度以任意荧光单位（AFU）测量：\n- 蛋白C的平均强度：$\\mu_C = 1550$ AFU\n- 蛋白Y的平均强度：$\\mu_Y = 1620$ AFU\n- 蛋白C强度的方差：$\\sigma_C^2 = 1.95 \\times 10^5 \\text{ (AFU)}^2$\n- 蛋白Y强度的方差：$\\sigma_Y^2 = 2.05 \\times 10^5 \\text{ (AFU)}^2$\n- 蛋白C和蛋白Y强度的协方差：$\\text{Cov}(C, Y) = 8.50 \\times 10^4 \\text{ (AFU)}^2$\n\n根据双报告系统中噪声分解的理论，计算由外在噪声引起的变异系数的平方，记为 $\\eta_{ext}^2$。这个量是衡量外在噪声大小的一个关键无量纲指标。将您的最终答案四舍五入到三位有效数字。", "solution": "在双报告系统框架中，令 $C$ 和 $Y$ 表示由两个相同的启动子驱动不同报告基因所产生的荧光强度。将表达分解为其均值周围的乘法涨落：\n$$\nC = \\mu_{C}\\left(1 + E + I_{C}\\right), \\quad Y = \\mu_{Y}\\left(1 + E + I_{Y}\\right),\n$$\n其中 $E$ 是两个报告基因共享的外在涨落，满足 $\\mathbb{E}[E]=0$，而 $I_{C}, I_{Y}$ 是各自特有的、独立的、零均值的内在涨落。假设 $E$、$I_C$ 和 $I_Y$ 相互不相关，且 $\\text{Cov}(I_{C}, I_{Y})=0$。\n\n那么 $C$ 和 $Y$ 之间的协方差为\n$$\n\\text{Cov}(C,Y) = \\mu_{C}\\mu_{Y}\\,\\text{Cov}(1+E+I_{C},\\,1+E+I_{Y})\n= \\mu_{C}\\mu_{Y}\\,\\text{Var}(E).\n$$\n将由外在噪声引起的变异系数的平方定义为 $\\eta_{ext}^{2} \\equiv \\text{Var}(E)$。因此，\n$$\n\\eta_{ext}^{2} = \\frac{\\text{Cov}(C,Y)}{\\mu_{C}\\mu_{Y}}.\n$$\n代入给定值 $\\mu_{C}=1550$、$\\mu_{Y}=1620$ 和 $\\text{Cov}(C,Y)=8.50\\times 10^{4}$：\n$$\n\\eta_{ext}^{2} = \\frac{8.50\\times 10^{4}}{1550\\times 1620}\n= \\frac{8.50\\times 10^{4}}{2.511\\times 10^{6}}\n= \\frac{85}{2511}\n\\approx 0.033851056\\ldots\n$$\n四舍五入到三位有效数字，得到\n$$\n\\eta_{ext}^{2} \\approx 0.0339.\n$$\n此结果为无量纲量，符合要求。", "answer": "$$\\boxed{0.0339}$$", "id": "1444520"}, {"introduction": "外在噪音不仅贡献了细胞的整体变异性，更重要的是，它会系统性地扭曲我们对实验数据的解读，从而可能导致对分子机制的错误推断。这个高级练习将深入探讨一个关键问题：当我们在分析转录数据时忽略外在噪音，我们对转录“脉冲”大小和频率等基本参数的估计会产生怎样的偏差。通过数学推导和计算，您将学习如何诊断并校正这种偏差，这是在系统生物学中进行严谨定量建模所必需的一项关键技能 [@problem_id:2774339]。", "problem": "给定一个细胞群体，其中每个细胞的信使核糖核酸（mRNA）计数（表示为 $X$）来自于突发性转录。在给定一个外在细胞状态 $A$（代表每个mRNA生命周期内有效突发频率的细胞间变异）的条件下，mRNA计数 $X \\mid A = a$ 服从负二项（NB）分布（Negative Binomial (NB)），其形状参数为 $a$，均值为 $a b$，其中 $b$ 是平均突发大小（每次突发的分子数）。以下经过充分检验的事实是本问题的基础：(i) 条件均值 $\\mathbb{E}[X \\mid A = a] = a b$，以及 (ii) 条件方差 $\\mathrm{Var}(X \\mid A = a) = a b + a b^{2}$，因此条件法诺因子等于 $1 + b$。外在状态 $A$ 是一个正随机变量，其均值为 $\\bar a$，变异系数的平方为 $\\mathrm{CV}_{A}^{2} = \\mathrm{Var}(A)/\\bar a^{2}$，并且在细胞间是独立的。除了要求 $A$ 的分布存在一阶矩和二阶矩外，无需其他任何假设。\n\n一位从业者通过将观测到的均值 $\\mu_{\\mathrm{obs}}$ 和观测到的方差 $\\sigma_{\\mathrm{obs}}^{2}$与NB分布的矩关系进行匹配，天真地拟合了一个忽略外在变异性的NB模型：对于一个均值为 $\\mu$、形状参数为 $k$ 的NB分布，其方差为 $\\mu + \\mu^{2}/k$。使用观测到的矩，基于矩的天真估计量为 $\\hat{k}_{\\mathrm{NB}} = \\mu_{\\mathrm{obs}}^{2}/(\\sigma_{\\mathrm{obs}}^{2} - \\mu_{\\mathrm{obs}})$ 和 $\\hat{b}_{\\mathrm{NB}} = \\sigma_{\\mathrm{obs}}^{2}/\\mu_{\\mathrm{obs}} - 1$。在突发性NB模型的解释下，当映射回突发参数 $(a, b)$ 时，有 $\\hat{a}_{\\mathrm{NB}} = \\mu_{\\mathrm{obs}}/\\hat{b}_{\\mathrm{NB}}$。\n\n任务1（推导）：仅从给定的基础（条件NB均值和方差，以及期望和方差的定义）出发，使用全期望定律和全方差定律，推导出观测均值 $\\mu_{\\mathrm{obs}}$ 和观测方差 $\\sigma_{\\mathrm{obs}}^{2}$ 关于 $\\bar a$、$b$ 和 $\\mathrm{CV}_{A}^{2}$ 的公式。然后分析忽略外在变异性的天真NB拟合所产生的偏差：用真实参数 $\\bar a$、$b$ 和 $\\mathrm{CV}_{A}^{2}$ 来表示 $\\hat{a}_{\\mathrm{NB}}$ 和 $\\hat{b}_{\\mathrm{NB}}$。\n\n任务2（校正）：从你得到的偏差表达式出发，通过代数方法推导出校正因子，以便在 $\\mathrm{CV}_{A}^{2}$ 已知的情况下，从天真的NB矩估计量 $(\\hat{a}_{\\mathrm{NB}}, \\hat{b}_{\\mathrm{NB}})$ 中恢复真实参数 $(\\bar a, b)$。你最终的校正估计量必须仅是 $\\hat{a}_{\\mathrm{NB}}$、$\\hat{b}_{\\mathrm{NB}}$ 和 $\\mathrm{CV}_{A}^{2}$ 的显式函数。说明使校正有效所需的任何定义域条件。\n\n编程任务：实现一个程序，对每个测试用例 $(\\bar a, b, \\mathrm{CV}_{A}^{2})$ 执行以下步骤：\n- 使用你在任务1中推导的公式计算观测均值 $\\mu_{\\mathrm{obs}}$ 和观测方差 $\\sigma_{\\mathrm{obs}}^{2}$。\n- 从 $(\\mu_{\\mathrm{obs}}, \\sigma_{\\mathrm{obs}}^{2})$ 计算天真的NB矩估计量 $\\hat{a}_{\\mathrm{NB}}$ 和 $\\hat{b}_{\\mathrm{NB}}$。\n- 应用你在任务2中得到的校正公式，获得仅用 $(\\hat{a}_{\\mathrm{NB}}, \\hat{b}_{\\mathrm{NB}}, \\mathrm{CV}_{A}^{2})$ 表示的校正估计量 $(\\hat{a}_{\\mathrm{corr}}, \\hat{b}_{\\mathrm{corr}})$。\n- 对每个测试用例，输出列表 $[\\hat{a}_{\\mathrm{NB}}, \\hat{b}_{\\mathrm{NB}}, \\hat{a}_{\\mathrm{corr}}, \\hat{b}_{\\mathrm{corr}}]$，所有四个数字都四舍五入到六位小数。\n\n测试集（每个元组列出 $(\\bar a, b, \\mathrm{CV}_{A}^{2})$）：\n- 情况A（理想路径）：$(5.0, 2.0, 0.3)$。\n- 情况B（无外在变异性）：$(10.0, 0.5, 0.0)$。\n- 情况C（相对于 $\\bar a$ 处于边界状态的高外在变异性）：$(50.0, 1.0, 1.0)$。\n- 情况D（低突发频率和高突发大小）：$(0.8, 5.0, 0.5)$。\n- 情况E（参数适中，突发大小为非整数）：$(3.2, 1.7, 0.25)$。\n\n最终输出格式：你的程序应生成单行输出，其中包含一个用方括号括起来的、由逗号分隔的子列表组成的列表，顺序与测试集相同。例如，一个有效的输出行格式为 $[[x_{1},y_{1},z_{1},w_{1}],[x_{2},y_{2},z_{2},w_{2}],\\dots]$，其中每个 $x_{i}, y_{i}, z_{i}, w_{i}$ 都是四舍五入到六位小数的十进制数。不应打印任何其他文本。", "solution": "该问题要求推导在忽略外在变异性时，突发性转录模型参数估计中的偏差，并随后推导消除此偏差的校正因子。本分析将从第一性原理出发，使用全期望定律和全方差定律进行。\n\n**任务1：观测矩和天真估计量偏差的推导**\n\n模型假定，对于给定的细胞状态 $A=a$，mRNA计数 $X$ 服从负二项分布，$X \\mid A=a \\sim \\mathrm{NB}(\\text{shape}=a, \\text{mean}=ab)$。条件矩如下所示：\n$$\n\\mathbb{E}[X \\mid A=a] = ab\n$$\n$$\n\\mathrm{Var}(X \\mid A=a) = ab + ab^2\n$$\n外在状态 $A$ 是一个随机变量，其均值为 $\\mathbb{E}[A] = \\bar{a}$，方差为 $\\mathrm{Var}(A)$。$A$ 的变异系数平方为 $\\mathrm{CV}_{A}^{2} = \\mathrm{Var}(A) / \\bar{a}^2$。\n\n首先，我们推导 $X$ 的无条件（观测）均值 $\\mu_{\\mathrm{obs}}$ 和方差 $\\sigma_{\\mathrm{obs}}^{2}$。\n\n**观测均值 $\\mu_{\\mathrm{obs}}$**\n\n根据全期望定律，观测均值是条件均值的期望：\n$$\n\\mu_{\\mathrm{obs}} = \\mathbb{E}[X] = \\mathbb{E}_{A}[\\mathbb{E}[X \\mid A]]\n$$\n代入条件均值的表达式 $\\mathbb{E}[X \\mid A] = Ab$：\n$$\n\\mu_{\\mathrm{obs}} = \\mathbb{E}_{A}[Ab] = b \\cdot \\mathbb{E}[A]\n$$\n因此，观测均值为：\n$$\n\\mu_{\\mathrm{obs}} = \\bar{a}b\n$$\n\n**观测方差 $\\sigma_{\\mathrm{obs}}^{2}$**\n\n根据全方差定律，观测方差是条件方差的期望与条件均值的方差之和：\n$$\n\\sigma_{\\mathrm{obs}}^{2} = \\mathrm{Var}(X) = \\mathbb{E}_{A}[\\mathrm{Var}(X \\mid A)] + \\mathrm{Var}_{A}(\\mathbb{E}[X \\mid A])\n$$\n我们分别计算每一项。\n\n第一项是条件方差 $\\mathrm{Var}(X \\mid A) = Ab + Ab^2$ 的期望：\n$$\n\\mathbb{E}_{A}[\\mathrm{Var}(X \\mid A)] = \\mathbb{E}_{A}[A(b+b^2)] = (b+b^2)\\mathbb{E}[A] = \\bar{a}(b+b^2) = \\bar{a}b + \\bar{a}b^2\n$$\n第二项是条件均值 $\\mathbb{E}[X \\mid A] = Ab$ 的方差：\n$$\n\\mathrm{Var}_{A}(\\mathbb{E}[X \\mid A]) = \\mathrm{Var}_{A}(Ab) = b^2 \\mathrm{Var}(A)\n$$\n使用定义 $\\mathrm{Var}(A) = \\bar{a}^2 \\mathrm{CV}_{A}^{2}$，该项变为：\n$$\n\\mathrm{Var}_{A}(Ab) = b^2 \\bar{a}^2 \\mathrm{CV}_{A}^{2} = (\\bar{a}b)^2 \\mathrm{CV}_{A}^{2}\n$$\n结合这两项，我们得到观测方差：\n$$\n\\sigma_{\\mathrm{obs}}^{2} = (\\bar{a}b + \\bar{a}b^2) + (\\bar{a}b)^2 \\mathrm{CV}_{A}^{2} = \\bar{a}b(1+b) + \\bar{a}^2 b^2 \\mathrm{CV}_{A}^{2}\n$$\n\n**天真估计量的偏差**\n\n天真的分析忽略了外在变异性，通过将观测矩 $(\\mu_{\\mathrm{obs}}, \\sigma_{\\mathrm{obs}}^{2})$ 与简单NB分布的矩进行匹配来估计参数 $\\hat{a}_{\\mathrm{NB}}$ 和 $\\hat{b}_{\\mathrm{NB}}$。天真估计量由以下公式给出：\n$$\n\\hat{b}_{\\mathrm{NB}} = \\frac{\\sigma_{\\mathrm{obs}}^{2}}{\\mu_{\\mathrm{obs}}} - 1\n$$\n$$\n\\hat{a}_{\\mathrm{NB}} = \\frac{\\mu_{\\mathrm{obs}}}{\\hat{b}_{\\mathrm{NB}}}\n$$\n我们将推导出的 $\\mu_{\\mathrm{obs}}$ 和 $\\sigma_{\\mathrm{obs}}^{2}$ 的表达式代入，以求得偏差。首先，我们计算比值 $\\sigma_{\\mathrm{obs}}^{2}/\\mu_{\\mathrm{obs}}$：\n$$\n\\frac{\\sigma_{\\mathrm{obs}}^{2}}{\\mu_{\\mathrm{obs}}} = \\frac{\\bar{a}b(1+b) + \\bar{a}^2 b^2 \\mathrm{CV}_{A}^{2}}{\\bar{a}b} = (1+b) + \\frac{\\bar{a}^2 b^2 \\mathrm{CV}_{A}^{2}}{\\bar{a}b} = 1+b + \\bar{a}b\\mathrm{CV}_{A}^{2}\n$$\n现在我们求出天真突发大小估计量 $\\hat{b}_{\\mathrm{NB}}$ 的表达式：\n$$\n\\hat{b}_{\\mathrm{NB}} = \\left(1+b + \\bar{a}b\\mathrm{CV}_{A}^{2}\\right) - 1 = b + \\bar{a}b\\mathrm{CV}_{A}^{2} = b(1 + \\bar{a}\\mathrm{CV}_{A}^{2})\n$$\n这一结果表明，只要存在外在变异性（$\\mathrm{CV}_{A}^{2} > 0$），$\\hat{b}_{\\mathrm{NB}}$ 就是对真实平均突发大小 $b$ 的高估。\n\n接下来，我们求出天真突发频率参数 $\\hat{a}_{\\mathrm{NB}}$ 的表达式：\n$$\n\\hat{a}_{\\mathrm{NB}} = \\frac{\\mu_{\\mathrm{obs}}}{\\hat{b}_{\\mathrm{NB}}} = \\frac{\\bar{a}b}{b(1 + \\bar{a}\\mathrm{CV}_{A}^{2})} = \\frac{\\bar{a}}{1 + \\bar{a}\\mathrm{CV}_{A}^{2}}\n$$\n这一结果表明，当 $\\mathrm{CV}_{A}^{2} > 0$ 时，$\\hat{a}_{\\mathrm{NB}}$ 是对真实平均突发频率参数 $\\bar{a}$ 的低估。\n\n**任务2：校正因子的推导**\n\n目标是逆转偏差，并从天真估计量 $(\\hat{a}_{\\mathrm{NB}}, \\hat{b}_{\\mathrm{NB}})$ 和已知的外在变异性 $\\mathrm{CV}_{A}^{2}$ 中恢复真实参数 $(\\bar{a}, b)$。我们有以下方程组：\n$$\n(1) \\quad \\hat{a}_{\\mathrm{NB}} = \\frac{\\bar{a}}{1 + \\bar{a}\\mathrm{CV}_{A}^{2}}\n$$\n$$\n(2) \\quad \\hat{b}_{\\mathrm{NB}} = b(1 + \\bar{a}\\mathrm{CV}_{A}^{2})\n$$\n我们必须求解该方程组以得到 $\\bar{a}$ 和 $b$。\n\n**对 $\\bar{a}$ 的校正**\n\n从方程(1)中，我们求解 $\\bar{a}$：\n$$\n\\hat{a}_{\\mathrm{NB}} (1 + \\bar{a}\\mathrm{CV}_{A}^{2}) = \\bar{a}\n$$\n$$\n\\hat{a}_{\\mathrm{NB}} + \\hat{a}_{\\mathrm{NB}}\\bar{a}\\mathrm{CV}_{A}^{2} = \\bar{a}\n$$\n$$\n\\hat{a}_{\\mathrm{NB}} = \\bar{a} - \\hat{a}_{\\mathrm{NB}}\\bar{a}\\mathrm{CV}_{A}^{2} = \\bar{a}(1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2})\n$$\n这给出了 $\\bar{a}$ 的校正估计量，我们记为 $\\hat{a}_{\\mathrm{corr}}$：\n$$\n\\hat{a}_{\\mathrm{corr}} = \\bar{a} = \\frac{\\hat{a}_{\\mathrm{NB}}}{1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}}\n$$\n\n**对 $b$ 的校正**\n\n为了求解 $b$，我们首先重新整理方程(2)：\n$$\nb = \\frac{\\hat{b}_{\\mathrm{NB}}}{1 + \\bar{a}\\mathrm{CV}_{A}^{2}}\n$$\n我们可以利用我们关于 $\\bar{a}$ 的结果来找到项 $(1 + \\bar{a}\\mathrm{CV}_{A}^{2})$ 的表达式。从 $\\hat{a}_{\\mathrm{corr}}$ 的推导中，我们有 $\\hat{a}_{\\mathrm{NB}} = \\bar{a}(1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2})$。这似乎不是一个直接的方法。\n\n让我们改用一个代数恒等式。从 $\\bar{a}$ 的推导中，我们有 $1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2} = \\hat{a}_{\\mathrm{NB}}/\\bar{a}$。让我们对其求倒数。等等。\n让我们重新审视 $\\bar{a}$ 的表达式：$\\bar{a}(1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}) = \\hat{a}_{\\mathrm{NB}}$。现在再看方程(1)：$1 + \\bar{a}\\mathrm{CV}_{A}^{2} = \\bar{a}/\\hat{a}_{\\mathrm{NB}}$。这是正确的。\n将此代入 $b$ 的表达式中：\n$$\nb = \\frac{\\hat{b}_{\\mathrm{NB}}}{\\bar{a}/\\hat{a}_{\\mathrm{NB}}} = \\frac{\\hat{a}_{\\mathrm{NB}}\\hat{b}_{\\mathrm{NB}}}{\\bar{a}}\n$$\n这只是 $\\mu_{\\mathrm{obs}}/\\bar{a} = b$，这是一个同义反复，没有帮助。\n\n一个更有效的方法是，用天真估计量来表示分母 $(1 + \\bar{a}\\mathrm{CV}_{A}^{2})$。从方程(1)我们有 $1 + \\bar{a}\\mathrm{CV}_{A}^{2} = \\frac{\\bar{a}}{\\hat{a}_{\\mathrm{NB}}}$。代入校正后的 $\\bar{a}$ 的表达式，$\\bar{a} = \\frac{\\hat{a}_{\\mathrm{NB}}}{1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}}$：\n$$\n1 + \\bar{a}\\mathrm{CV}_{A}^{2} = 1 + \\left(\\frac{\\hat{a}_{\\mathrm{NB}}}{1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}}\\right)\\mathrm{CV}_{A}^{2} = \\frac{1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2} + \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}}{1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}} = \\frac{1}{1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}}\n$$\n现在将此代回 $b$ 的表达式中：\n$$\nb = \\frac{\\hat{b}_{\\mathrm{NB}}}{1 / (1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2})} = \\hat{b}_{\\mathrm{NB}}(1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2})\n$$\n这给出了 $b$ 的校正估计量，记为 $\\hat{b}_{\\mathrm{corr}}$：\n$$\n\\hat{b}_{\\mathrm{corr}} = b = \\hat{b}_{\\mathrm{NB}}(1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2})\n$$\n\n**校正公式和条件总结**\n\n校正后的估计量为：\n$$\n\\hat{a}_{\\mathrm{corr}} = \\frac{\\hat{a}_{\\mathrm{NB}}}{1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}}\n$$\n$$\n\\hat{b}_{\\mathrm{corr}} = \\hat{b}_{\\mathrm{NB}}(1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2})\n$$\n为使这些估计量具有物理意义（即为正数），我们需要校正因子 $(1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2})$ 为正。这意味着定义域条件为：\n$$\n\\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2} < 1\n$$\n用真实参数表示，该条件为 $\\frac{\\bar{a}\\mathrm{CV}_{A}^{2}}{1 + \\bar{a}\\mathrm{CV}_{A}^{2}} < 1$，对于非负参数，该条件总是满足的，因为它简化为 $0 < 1$。因此，对于总体矩，该校正是始终定义良好的。\n\n推导完成。该逻辑-数学过程揭示了外在变异性的精确量化影响，并建立了校正它的方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes naive and corrected estimates for bursty transcription parameters\n    across several test cases.\n    \"\"\"\n\n    # Test suite: each tuple contains (a_bar, b, CV_A^2)\n    test_cases = [\n        (5.0, 2.0, 0.3),   # Case A (happy path)\n        (10.0, 0.5, 0.0),  # Case B (no extrinsic variability)\n        (50.0, 1.0, 1.0),  # Case C (high extrinsic variability)\n        (0.8, 5.0, 0.5),   # Case D (low burst frequency, large burst size)\n        (3.2, 1.7, 0.25),  # Case E (moderate parameters)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        a_bar, b, cv2_A = case\n\n        # Step 1: Compute observed moments using derived formulas from Task 1\n        # mu_obs = a_bar * b\n        # sigma2_obs = a_bar*b + a_bar*b^2 + (a_bar*b)^2 * CV_A^2\n        mu_obs = a_bar * b\n        sigma2_obs = a_bar * b * (1 + b) + (a_bar**2) * (b**2) * cv2_A\n\n        # Step 2: Compute naive NB moment estimates\n        # These will be biased if cv2_A > 0\n        \n        # The condition sigma2_obs > mu_obs must hold for b_nb_hat > 0.\n        # sigma2_obs - mu_obs = a_bar*b^2 + (a_bar*b)^2*cv2_A\n        # This is > 0 for a_bar > 0, b > 0.\n        if mu_obs == 0:\n            # Avoid division by zero, though not expected with given test cases.\n            if sigma2_obs == 0:\n                # If mean and variance are 0, this is a degenerate case.\n                b_nb_hat = 0\n            else:\n                # A positive variance with a zero mean is not possible for this model.\n                b_nb_hat = float('inf')\n        else:\n            b_nb_hat = (sigma2_obs / mu_obs) - 1\n\n        # The condition b_nb_hat > 0 must hold for a_nb_hat to be well-defined.\n        if b_nb_hat <= 0:\n            # Handle cases that might arise with real, noisy data,\n            # though not with the perfect data from these test cases.\n            a_nb_hat = float('nan')\n        else:\n            a_nb_hat = mu_obs / b_nb_hat\n\n        # Step 3: Apply correction formulas from Task 2 to obtain corrected estimates\n        # Correction factor term\n        correction_factor = 1 - a_nb_hat * cv2_A\n\n        # Check domain condition for correction; correction_factor must be > 0.\n        # As derived, this holds for the true parameters. With sample estimates,\n        # it might be violated. For this problem, it is always satisfied.\n        \n        a_corr = a_nb_hat / correction_factor\n        b_corr = b_nb_hat * correction_factor\n\n        # Step 4: Collect and format the results\n        # Round all four numbers to six decimal places.\n        result_tuple = [\n            round(a_nb_hat, 6),\n            round(b_nb_hat, 6),\n            round(a_corr, 6),\n            round(b_corr, 6)\n        ]\n        results.append(result_tuple)\n\n    # Convert the list of lists to the required string format\n    # [[x1,y1,z1,w1],[x2,y2,z2,w2],...]\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, r))}]\" for r in results]) + \"]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "2774339"}]}