{"hands_on_practices": [{"introduction": "在神经科学研究中，一个核心任务是将单个神经元精确地分配到预定义的细胞类别中。本练习将通过一个实际的编码任务，指导你构建一个朴素贝叶斯分类器——这是完成此类任务的基础工具。你将学习如何融合先验知识（例如，来自特定脑区的解剖学信息）和观测证据（来自标志基因的表达数据），来计算一个细胞属于不同类别的后验概率，从而量化我们对分类结果的置信度[@problem_id:2705477]。", "problem": "您的任务是形式化并实现一个用于神经递质身份识别的贝叶斯分类器，该分类器使用区域特异性先验和针对标记信使核糖核酸（mRNA）读数的基因特异性检测概率。分类器必须基于观测到的标记读数计数进行操作，并返回神经递质类别的后验概率。设定如下。\n\n考虑一个有限的神经递质类别集合 $\\mathcal{C} = \\{\\text{GLU}, \\text{GABA}, \\text{ACh}\\}$，分别代表谷氨酸能神经元、γ-氨基丁酸（GABA）能神经元和释放乙酰胆碱（ACh）的神经元。考虑一个有限的标记基因集合 $\\mathcal{G} = \\{\\text{SLC17A7}, \\text{GAD1}, \\text{CHAT}\\}$。对于单个神经元，其所处的解剖区域 $R \\in \\{\\text{Cortex}, \\text{Striatum}, \\text{BasalForebrain}\\}$ 是已知的。假设以下基础理论。\n\n- 贝叶斯法则：对于任何类别 $c \\in \\mathcal{C}$、观测向量 $o = (o_g)_{g \\in \\mathcal{G}}$（其中 $o_g \\in \\{0,1\\}$）以及区域 $r$，后验概率为\n$$\nP(C=c \\mid O=o, R=r) \\;=\\; \\frac{P(C=c \\mid R=r)\\,P(O=o \\mid C=c)}{\\sum_{c' \\in \\mathcal{C}} P(C=c' \\mid R=r)\\,P(O=o \\mid C=c')}.\n$$\n- 给定类别，标记检测条件独立：对于 $o = (o_g)_{g \\in \\mathcal{G}}$，\n$$\nP(O=o \\mid C=c) \\;=\\; \\prod_{g \\in \\mathcal{G}_{\\text{measured}}} P(O_g = o_g \\mid C=c),\n$$\n其中 $\\mathcal{G}_{\\text{measured}} \\subseteq \\mathcal{G}$ 是实验中实际测量的标记基因子集。如果 $\\mathcal{G}_{\\text{measured}} = \\emptyset$，则对于所有 $c \\in \\mathcal{C}$，$P(O=o \\mid C=c) = 1$。\n- 每个测量的标记基因 $g$ 的伯努利测量模型：对于类别 $c$，\n$$\nP(O_g = 1 \\mid C=c) = \\pi_{g,c}, \\qquad P(O_g = 0 \\mid C=c) = 1 - \\pi_{g,c},\n$$\n其中已知的检测概率 $\\pi_{g,c} \\in (0,1)$ 包含了真实表达、假阳性和脱落效应。\n\n区域特异性先验 $P(C=c \\mid R=r)$ 由矩阵 $\\rho_{c,r}$ 给出（每个区域对应的列向量元素之和为1）：\n- 对于 $\\text{Cortex}$: $\\rho_{\\text{GLU},\\text{Cortex}} = 0.7$, $\\rho_{\\text{GABA},\\text{Cortex}} = 0.29$, $\\rho_{\\text{ACh},\\text{Cortex}} = 0.01$。\n- 对于 $\\text{Striatum}$: $\\rho_{\\text{GLU},\\text{Striatum}} = 0.1$, $\\rho_{\\text{GABA},\\text{Striatum}} = 0.89$, $\\rho_{\\text{ACh},\\text{Striatum}} = 0.01$。\n- 对于 $\\text{BasalForebrain}$: $\\rho_{\\text{GLU},\\text{BasalForebrain}} = 0.15$, $\\rho_{\\text{GABA},\\text{BasalForebrain}} = 0.2$, $\\rho_{\\text{ACh},\\text{BasalForebrain}} = 0.65$。\n\n检测概率 $\\pi_{g,c}$ 是基因和类别特异性的，并且对所有区域都是固定的：\n- 对于 $\\text{SLC17A7}$: $\\pi_{\\text{SLC17A7},\\text{GLU}} = 0.85$, $\\pi_{\\text{SLC17A7},\\text{GABA}} = 0.05$, $\\pi_{\\text{SLC17A7},\\text{ACh}} = 0.05$。\n- 对于 $\\text{GAD1}$: $\\pi_{\\text{GAD1},\\text{GLU}} = 0.05$, $\\pi_{\\text{GAD1},\\text{GABA}} = 0.9$, $\\pi_{\\text{GAD1},\\text{ACh}} = 0.05$。\n- 对于 $\\text{CHAT}$: $\\pi_{\\text{CHAT},\\text{GLU}} = 0.05$, $\\pi_{\\text{CHAT},\\text{GABA}} = 0.05$, $\\pi_{\\text{CHAT},\\text{ACh}} = 0.8$。\n\n观测数据是每个测量的基因 $g \\in \\mathcal{G}_{\\text{measured}}$ 的原始读数计数 $x_g \\in \\mathbb{N}_0$。通过一个固定阈值将计数转换为二元检测结果：\n$$\no_g = \\mathbf{1}[x_g \\ge 1],\n$$\n对于每个测量的基因 $g \\in \\mathcal{G}_{\\text{measured}}$。未测量的基因从似然计算中排除（即，不作计数为 $0$ 处理）。\n\n您的任务是实现一个程序，该程序：\n1. 对每个测试用例，使用上述模型和参数计算后验向量 $\\big(P(C=\\text{GLU}\\mid O=o,R=r), P(C=\\text{GABA}\\mid O=o,R=r), P(C=\\text{ACh}\\mid O=o,R=r)\\big)$。\n2. 演示贝叶斯法则的序贯更新：给定在不相交的测量标记子集 $\\mathcal{G}^{(1)}$ 和 $\\mathcal{G}^{(2)}$ 上的分裂观测值 $o^{(1)}$ 和 $o^{(2)}$，从先验概率开始，用 $o^{(1)}$ 更新得到一个后验概率，然后用 $o^{(2)}$ 再次更新，并验证该结果与直接从联合观测 $o = (o^{(1)}, o^{(2)})$ 计算出的后验概率在数值容差范围内相等。\n\n测试套件：\n- 用例 1（理想路径）：区域 $R = \\text{Cortex}$，测量标记 $\\mathcal{G}_{\\text{measured}} = \\{\\text{SLC17A7}, \\text{GAD1}, \\text{CHAT}\\}$，计数为 $x_{\\text{SLC17A7}} = 3$, $x_{\\text{GAD1}} = 0$, $x_{\\text{CHAT}} = 0$。\n- 用例 2（冲突的标记）：区域 $R = \\text{Striatum}$，$\\mathcal{G}_{\\text{measured}} = \\{\\text{SLC17A7}, \\text{GAD1}, \\text{CHAT}\\}$，计数为 $x_{\\text{SLC17A7}} = 1$, $x_{\\text{GAD1}} = 2$, $x_{\\text{CHAT}} = 0$。\n- 用例 3（罕见类别有强指示）：区域 $R = \\text{Cortex}$，$\\mathcal{G}_{\\text{measured}} = \\{\\text{SLC17A7}, \\text{GAD1}, \\text{CHAT}\\}$，计数为 $x_{\\text{SLC17A7}} = 0$, $x_{\\text{GAD1}} = 0$, $x_{\\text{CHAT}} = 4$。\n- 用例 4（无测量边界情况）：区域 $R = \\text{Striatum}$，$\\mathcal{G}_{\\text{measured}} = \\emptyset$（未测量标记），未提供计数。此用例必须返回区域先验作为后验。\n- 用例 5（序贯更新等价性）：区域 $R = \\text{BasalForebrain}$。第一批 $\\mathcal{G}^{(1)} = \\{\\text{SLC17A7}\\}$，计数为 $x_{\\text{SLC17A7}} = 2$。第二批 $\\mathcal{G}^{(2)} = \\{\\text{GAD1}, \\text{CHAT}\\}$，计数为 $x_{\\text{GAD1}} = 0$, $x_{\\text{CHAT}} = 1$。通过返回一个布尔值，验证序贯更新的结果与联合观测 $\\mathcal{G}^{(1)} \\cup \\mathcal{G}^{(2)}$ 的结果在容差 $\\epsilon = 10^{-12}$ 内相等。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于用例 1-4，返回一个包含三个浮点数的列表，对应于 $\\big(P(\\text{GLU}), P(\\text{GABA}), P(\\text{ACh})\\big)$，每个浮点数四舍五入到六位小数。对于用例 5，返回一个布尔值，指示序贯更新和联合更新是否在 $\\epsilon$ 内一致。\n- 因此，最终打印的输出应为单行，格式如下：\n$[\\,[p_{1,\\text{GLU}},p_{1,\\text{GABA}},p_{1,\\text{ACh}}],\\,[p_{2,\\text{GLU}},p_{2,\\text{GABA}},p_{2,\\text{ACh}}],\\,[p_{3,\\text{GLU}},p_{3,\\text{GABA}},p_{3,\\text{ACh}}],\\,[p_{4,\\text{GLU}},p_{4,\\text{GABA}},p_{4,\\text{ACh}}],\\,\\text{True/False}\\,]$，其中所有浮点数都四舍五入到六位小数。", "solution": "问题陈述需经过验证。\n\n**步骤1：提取给定条件**\n- **类别 (Classes):** 一个神经递质类型集合 $\\mathcal{C} = \\{\\text{GLU}, \\text{GABA}, \\text{ACh}\\}$。\n- **基因 (Genes):** 一个标记基因集合 $\\mathcal{G} = \\{\\text{SLC17A7}, \\text{GAD1}, \\text{CHAT}\\}$。\n- **区域 (Regions):** 一个解剖区域集合 $R \\in \\{\\text{Cortex}, \\text{Striatum}, \\text{BasalForebrain}\\}$。\n- **模型 (Model):** 一个贝叶斯分类器，其后验概率由贝叶斯法则给出：$P(C=c \\mid O=o, R=r) = \\frac{P(C=c \\mid R=r) P(O=o \\mid C=c)}{\\sum_{c' \\in \\mathcal{C}} P(C=c' \\mid R=r) P(O=o \\mid C=c')}$。\n- **似然 (Likelihood):** 假设在给定类别下，标记检测是条件独立的，$P(O=o \\mid C=c) = \\prod_{g \\in \\mathcal{G}_{\\text{measured}}} P(O_g = o_g \\mid C=c')$。对于 $\\mathcal{G}_{\\text{measured}} = \\emptyset$，似然被定义为 $1$。\n- **观测模型 (Observation Model):** 每个标记基因 $g$ 的伯努利模型：$P(O_g = 1 \\mid C=c) = \\pi_{g,c}$ 和 $P(O_g = 0 \\mid C=c) = 1 - \\pi_{g,c}$。二元观测值 $o_g$ 由原始读数计数 $x_g$ 通过阈值转换得到：$o_g = \\mathbf{1}[x_g \\ge 1]$。\n- **先验 (Priors):** 为所有类别 $c$ 和区域 $r$ 的组合提供了区域特异性先验 $P(C=c \\mid R=r) = \\rho_{c,r}$。所提供的每个区域的值总和正确地为 $1$。\n- **检测概率 (Detection Probabilities):** 为所有基因 $g$ 和类别 $c$ 的组合提供了类别和基因特异性的检测概率 $\\pi_{g,c}$。所有值都在有效范围 $(0,1)$ 内。\n- **测试用例 (Test Cases):** 提供了五个特定的测试用例，包含所有必要的输入（区域、测量的基因和计数），并要求对其中一个用例进行验证。\n\n**步骤2：使用提取的给定条件进行验证**\n根据验证标准对问题进行评估。\n- **科学上合理:** 该问题牢固地植根于统计推断（贝叶斯分类）和细胞神经科学的既定原理。使用标记基因（例如，$SLC17A7$ 用于谷氨酸能神经元，$GAD1$ 用于GABA能神经元）对神经元类型进行分类是一种标准且有效的方法。所用模型，即朴素贝叶斯分类器，是此类任务的常用且适当的选择。参数虽然是理想化的，但在生物学上是合理的。\n- **定义明确:** 该问题为每个案例提供了一套完整的先验、一个完全指定的似然函数以及数据。贝叶斯法则的结构确保了可以计算出唯一且有意义的后验概率分布。分母（证据）保证为非零，因为所有先验概率和条件概率都严格为正。\n- **客观:** 语言正式、精确且完全客观。任务是基于给定模型和参数的数学计算。\n\n该问题不存在验证清单中所列的任何缺陷。它不是不健全、不完整、矛盾、不切实际、病态或琐碎的。\n\n**步骤3：结论与行动**\n问题是有效的。将提供一个解决方案。\n\n**基于原理的解决方案**\n\n目标是计算单个神经元的一组神经递质类别 $\\mathcal{C}$ 的后验概率分布，给定其解剖区域 $R=r$ 和从标记基因表达水平导出的观测向量 $O=o$。这是一个贝叶斯推断中的经典问题。\n\n一个类别 $c \\in \\mathcal{C}$ 的后验概率由贝叶斯定理给出：\n$$\nP(C=c \\mid O=o, R=r) = \\frac{P(O=o \\mid C=c) \\, P(C=c \\mid R=r)}{P(O=o \\mid R=r)}\n$$\n项 $P(C=c \\mid R=r)$ 是在区域 $r$ 中观察到类别 $c$ 的神经元的先验概率。这些值，表示为 $\\rho_{c,r}$，是已知的。\n\n项 $P(O=o \\mid C=c)$ 是给定神经元属于类别 $c$ 时，观测向量 $o$ 的似然。问题陈述指出，单个标记的检测在给定细胞类别下是条件独立的。这将似然简化为在所有测量的基因 $g \\in \\mathcal{G}_{\\text{measured}}$ 上的乘积：\n$$\nP(O=o \\mid C=c) = \\prod_{g \\in \\mathcal{G}_{\\text{measured}}} P(O_g = o_g \\mid C=c)\n$$\n观测值 $o_g$ 是二元的（$0$ 或 $1$），由原始计数 $x_g$ 通过规则 $o_g = \\mathbf{1}[x_g \\ge 1]$ 导出。单个二元观测值 $o_g$ 的概率由伯努利模型给出：\n$$\nP(O_g=o_g \\mid C=c) = (\\pi_{g,c})^{o_g} (1 - \\pi_{g,c})^{1-o_g}\n$$\n其中 $\\pi_{g,c}$ 是在类别 $c$ 的细胞中检测到基因 $g$ (即，$o_g=1$) 的概率。如果一个基因未被测量，它将被排除在乘积之外，这等同于其似然项为 $1$。如果没有测量任何基因（$\\mathcal{G}_{\\text{measured}} = \\emptyset$），则对所有类别，总似然 $P(O=o \\mid C=c)$ 定义为 $1$，后验分布等于先验分布。\n\n分母 $P(O=o \\mid R=r)$ 是边缘似然或证据。它通过对所有可能类别的分子求和来计算，以确保后验概率之和为 $1$：\n$$\nP(O=o \\mid R=r) = \\sum_{c' \\in \\mathcal{C}} P(O=o \\mid C=c') \\, P(C=c' \\mid R=r)\n$$\n在计算上，对于每个测试用例，过程如下：\n1. 识别区域 $r$ 并检索相应的先验概率向量 $[P(C=\\text{GLU}|R=r), P(C=\\text{GABA}|R=r), P(C=\\text{ACh}|R=r)]$。\n2. 对于每个测量的基因 $g$，将计数 $x_g$ 转换为二元观测值 $o_g$。\n3. 对于每个类别 $c \\in \\mathcal{C}$，通过将所有测量基因的单个条件概率 $P(O_g=o_g \\mid C=c)$ 相乘，计算总似然 $L_c = P(O=o \\mid C=c)$。这将产生一个似然向量 $[L_{\\text{GLU}}, L_{\\text{GABA}}, L_{\\text{ACh}}]$。\n4. 通过先验向量和似然向量的逐元素相乘，计算未归一化的后验。\n5. 通过将每个元素除以所有元素的总和来归一化该向量。结果是最终的后验概率向量。\n\n对于序贯更新验证（用例5），我们必须展示贝叶斯推断的一个基本属性。给定两个不相交的观测集 $o^{(1)}$ 和 $o^{(2)}$，后验可以序贯计算：\n$$\nP(C \\mid o^{(1)}, o^{(2)}, r) \\propto P(o^{(2)} \\mid C) \\, P(C \\mid o^{(1)}, r)\n$$\n在这里，第一次更新的后验 $P(C \\mid o^{(1)}, r)$ 成为第二次更新的先验。由于观测的条件独立性，这等同于联合更新：\n$$\nP(C \\mid o^{(1)}, o^{(2)}, r) \\propto P(o^{(1)}, o^{(2)} \\mid C) \\, P(C \\mid r) = P(o^{(1)} \\mid C) \\, P(o^{(2)} \\mid C) \\, P(C \\mid r)\n$$\n实现将使用联合方法（一次性处理所有观测）和序贯方法（两次连续更新）来计算后验。将比较得到的后验向量是否近似相等，绝对容差为 $\\epsilon = 10^{-12}$，以确认它们的数学等价性。这证实了证据整合的顺序不影响最终的信念状态，这是一致性推断的标志。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Bayesian neuron classification problem for the given test suite.\n    \"\"\"\n    \n    # --- Define model parameters ---\n    CLASSES = {'GLU': 0, 'GABA': 1, 'ACh': 2}\n    CLASS_NAMES = ['GLU', 'GABA', 'ACh']\n    GENES = {'SLC17A7': 0, 'GAD1': 1, 'CHAT': 2}\n    REGIONS = {'Cortex': 0, 'Striatum': 1, 'BasalForebrain': 2}\n\n    # Region-specific priors P(C=c | R=r), shape (n_classes, n_regions)\n    priors = np.array([\n        # Cortex, Striatum, BasalForebrain\n        [0.70,   0.10,     0.15],  # GLU\n        [0.29,   0.89,     0.20],  # GABA\n        [0.01,   0.01,     0.65],  # ACh\n    ])\n\n    # Detection probabilities P(O_g=1 | C=c), shape (n_genes, n_classes)\n    pis = np.array([\n        # GLU,  GABA, ACh\n        [0.85, 0.05, 0.05],  # SLC17A7\n        [0.05, 0.90, 0.05],  # GAD1\n        [0.05, 0.05, 0.80],  # CHAT\n    ])\n\n    def calculate_posterior(region_name, observations, initial_prior=None):\n        \"\"\"\n        Calculates the posterior probability vector.\n\n        Args:\n            region_name (str): The name of the anatomical region.\n            observations (dict): A dict of {gene_name: count}.\n            initial_prior (np.ndarray, optional): An initial prior vector. \n                If None, uses the region-specific prior.\n\n        Returns:\n            np.ndarray: The posterior probability vector over classes.\n        \"\"\"\n        if initial_prior is None:\n            region_idx = REGIONS[region_name]\n            posterior = priors[:, region_idx].copy()\n        else:\n            posterior = initial_prior.copy()\n\n        # If no observations, the posterior is the prior\n        if not observations:\n            return posterior\n\n        # Calculate likelihood vector L = [P(O|C=c1), P(O|C=c2), ...]\n        likelihood_vec = np.ones(len(CLASSES))\n        for gene_name, count in observations.items():\n            gene_idx = GENES[gene_name]\n            # Convert count to binary observation\n            obs_binary = 1 if count >= 1 else 0\n            \n            # P(O_g=o_g | C=c) for all c\n            if obs_binary == 1:\n                gene_likelihood = pis[gene_idx, :]\n            else: # obs_binary == 0\n                gene_likelihood = 1 - pis[gene_idx, :]\n            \n            # Multiply into total likelihood using conditional independence\n            likelihood_vec *= gene_likelihood\n\n        # Update posterior: P(C|O) ~ P(O|C) * P(C)\n        posterior *= likelihood_vec\n        \n        # Normalize to get final posterior\n        norm_constant = np.sum(posterior)\n        if norm_constant > 0:\n            posterior /= norm_constant\n            \n        return posterior\n\n    # --- Test Cases ---\n    test_cases = [\n        # Case 1: Happy path\n        {'type': 'direct', 'region': 'Cortex', 'obs': {'SLC17A7': 3, 'GAD1': 0, 'CHAT': 0}},\n        # Case 2: Conflicting markers\n        {'type': 'direct', 'region': 'Striatum', 'obs': {'SLC17A7': 1, 'GAD1': 2, 'CHAT': 0}},\n        # Case 3: Rare class strongly indicated\n        {'type': 'direct', 'region': 'Cortex', 'obs': {'SLC17A7': 0, 'GAD1': 0, 'CHAT': 4}},\n        # Case 4: No measurements boundary\n        {'type': 'direct', 'region': 'Striatum', 'obs': {}},\n        # Case 5: Sequential update\n        {'type': 'sequential', 'region': 'BasalForebrain', 'obs1': {'SLC17A7': 2}, 'obs2': {'GAD1': 0, 'CHAT': 1}},\n    ]\n\n    string_results = []\n    \n    for case in test_cases:\n        if case['type'] == 'direct':\n            result = calculate_posterior(case['region'], case['obs'])\n            # Format to 6 decimal places, no spaces\n            formatted_res = f\"[{','.join([f'{p:.6f}' for p in result])}]\"\n            string_results.append(formatted_res)\n        \n        elif case['type'] == 'sequential':\n            region = case['region']\n            obs1 = case['obs1']\n            obs2 = case['obs2']\n            \n            # --- Joint update ---\n            joint_obs = {**obs1, **obs2}\n            joint_posterior = calculate_posterior(region, joint_obs)\n            \n            # --- Sequential update ---\n            # Step 1: Update with first batch\n            region_idx = REGIONS[region]\n            prior = priors[:, region_idx]\n            posterior_step1 = calculate_posterior(region, obs1, initial_prior=prior)\n            \n            # Step 2: Update with second batch, using posterior_step1 as prior\n            sequential_posterior = calculate_posterior(region, obs2, initial_prior=posterior_step1)\n\n            # --- Verification ---\n            # Compare joint vs sequential posteriors within tolerance\n            tolerance = 1e-12\n            are_equal = np.allclose(joint_posterior, sequential_posterior, atol=tolerance, rtol=0)\n            string_results.append(str(are_equal))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(string_results)}]\")\n\n\nsolve()\n```", "id": "2705477"}, {"introduction": "当我们掌握了将细胞分入*已知*类型的方法后，下一个挑战便是如何从大规模、无偏见的单细胞数据中系统性地*发现*这些细胞类型。本练习将引导你从单个细胞的分类思维，跃升到构建完整细胞谱系的宏观视角。你将需要设计一个从原始测序数据处理到最终识别稳健细胞簇及其标志基因的完整计算流程，这是现代神经科学研究者必备的关键技能之一[@problem_id:2705551]。", "problem": "您获得了一个来自成年小鼠皮层的单细胞RNA测序 (scRNA-seq) 数据集，其中包含在多个生物学重复和处理批次中分析的解离神经元。设原始计数矩阵表示为 $X \\in \\mathbb{N}_0^{G \\times N}$，其中 $G$ 是基因数量，$N$ 是细胞数量。每个细胞 $j$ 都有一个未知的文库大小 $s_j$，代表测序分子的总数；每个基因 $i$ 的表达水平都受到技术和生物学因素的共同影响。对于scRNA-seq计数，一个广受支持的经验模型是，$X_{ij}$ 近似服从均值为 $\\mu_{ij}$、过离散度为 $\\phi_i$ 的负二项 (NB) 分布，因此 $\\operatorname{Var}(X_{ij}) = \\mu_{ij} + \\phi_i \\mu_{ij}^2$。批次和供体会在文库大小之外引入结构化变异，而细胞周期状态和线粒体含量会引入额外的混杂效应，这些对于构建一个稳定的神经元分类体系而言并非研究重点。\n\n您的目标是使用一个始于上述模型假设和标准定义的、有原则的分析流程，来构建一个尽可能不受技术变异影响、并能捕获具有生物学意义的细胞群落的神经元类型转录组分类体系。具体来说，请选择最符合以下基于上述基础推导出的原则的选项：校正文库大小和批次效应，同时不破坏真实的生物学差异；稳定方差，以便为线性降维获得近似同方差的残差；通过对均值-方差趋势建模来选择信息丰富的特征；在一个距离对于生物学流形具有意义的空间中构建邻域图；使用定义明确的目标和稳定性评估来检测细胞群落；以及通过尊重生物学重复并控制错误发现率 (FDR) 的、统计上有效的差异表达分析来发现标记基因。\n\n哪个选项最恰当地指定了这样一个用于构建稳健的转录组分类体系的流程？\n\nA. 通过对相似细胞进行基于池的解卷积来估计每个细胞的大小因子 $\\{s_j\\}$，执行负二项回归以消除测序深度依赖性，并计算正则化的皮尔逊残差 $r_{ij} = \\dfrac{X_{ij} - \\hat{\\mu}_{ij}}{\\sqrt{\\hat{\\mu}_{ij} + \\hat{\\phi}_i \\hat{\\mu}_{ij}^2}}$，并通过将残差方差建模为均值的函数来选择高可变基因，同时排除由线粒体或核糖体含量驱动的基因。回归去除细胞周期阶段和线粒体分数的得分，以消除无用的协变。对高可变基因的缩放后残差执行主成分分析 (PCA)，并在低维空间中使用一种能够保留局部结构同时对齐重复样本的方法整合批次（例如，使用 Harmony 并将供体作为协变量）。在 PCA 空间中使用余弦距离构建一个 k-最近邻 (kNN) 图，将其转换为共享最近邻 (SNN) 图，权重为 $w(u,v) = \\lvert N_k(u) \\cap N_k(v) \\rvert$，并使用 Leiden 算法，通过优化一个类似模块度的质量函数来检测群落，并通过跨自助重采样的稳定性来选择分辨率参数。为了发现标记基因，为每个假定的聚类形成每个供体的伪批量计数，拟合一个包含聚类和供体效应的设计的负二项广义线性模型 (GLM)，检验聚类间的对比，并通过 Benjamini–Hochberg 方法调整 $p$ 值，以在 $\\alpha = 0.05$ 水平控制 FDR，报告同时具有统计显著性和最小对数倍数变化的基因。\n\nB. 通过除以总计数并乘以 $10^6$，以每百万计数 (CPM) 标准化每个细胞，对所有基因应用 $\\log(1+x)$ 转换，对所有基因计算 t-分布随机邻域嵌入 (t-SNE)，并在 t-SNE 空间中进行 $k$-均值聚类。构建一个以细胞间的皮尔逊相关性为边权重的完全图，并以高分辨率运行 Louvain 算法以获得许多小聚类。对于标记基因，在每个聚类与所有其他聚类之间应用基于单个细胞的 Wilcoxon 秩和检验，而不考虑供体或批次，并选择具有最小未校正 $p$ 值的基因作为标记。\n\nC. 在任何标准化之前，减去每个基因的批次均值以去除批次效应，然后选择低方差基因以减少噪音。直接对未缩放的计数矩阵应用独立成分分析 (ICA)，在完整的基因空间中使用欧几里得距离构建一个图，并通过凝聚式层次聚类进行聚类，聚类数量通过目视检查固定。对于标记基因，将计数转换为每百万转录本 (TPM)，在单细胞水平上，对聚类间的 log-TPM 应用双样本 $t$ 检验，并报告 $p0.05$ 的基因，不进行多重检验校正。\n\nD. 对细胞进行分位数标准化，使它们的边缘分布相同，然后假设泊松噪声，使用平方根方差稳定变换。在分位数标准化后选择高可变基因，运行 PCA，并在 PCA 空间中使用基于 z-score 标准化的主成分的欧几里得距离构建一个相互 kNN 图。使用 Leiden 算法，在单一分辨率下进行聚类，该分辨率的选择旨在最大化聚类数量。对于差异表达，为每个聚类形成每个供体的伪批量计数，拟合一个负二项 GLM 用于聚类对比，并在 $\\alpha = 0.05$ 水平控制 FDR 以定义标记基因。\n\n选择唯一的最佳选项。", "solution": "问题陈述要求根据一组给定的数据特征和六项反映该领域最佳实践的指导原则，确定用于构建神经元分类体系的最合适的单细胞RNA测序 (scRNA-seq) 分析流程。\n\n首先，需要对问题陈述进行验证。\n给定条件如下：\n- 一个原始计数矩阵 $X \\in \\mathbb{N}_0^{G \\times N}$，其中 $G$ 是基因数量，$N$ 是细胞数量。\n- 数据来自成年小鼠皮层，包含解离的神经元。\n- 每个细胞 $j$ 都有一个未知的文库大小 $s_j$。\n- 计数 $X_{ij}$ 通过均值为 $\\mu_{ij}$、过离散度为 $\\phi_i$ 的负二项 (NB) 分布进行建模。\n- 方差由 $\\operatorname{Var}(X_{ij}) = \\mu_{ij} + \\phi_i \\mu_{ij}^2$ 给出。\n- 已知的混杂因素是批次、供体、细胞周期状态和线粒体含量。\n- 目标是构建一个不受技术噪音影响的、稳健的神经元分类体系。\n- 提供了六项原则来指导流程设计，涵盖标准化、方差稳定、特征选择、图构建、群落检测和标记基因发现。\n\n问题陈述具有科学依据，提法明确且客观。它准确地描述了 scRNA-seq 分析中使用的挑战和最先进的统计模型。负二项模型的使用、特定的方差结构以及混杂因素列表都是现代计算生物学中的标准配置。所列出的原则对应于实现稳健分析公认的最佳实践。该问题是对一个复杂、多阶段的生物信息学工作流程理解能力的有效检验。因此，可以推导出解决方案。\n\n解决方案通过根据六项既定原则评估每个选项来进行。\n\n**原则1：校正文库大小和批次效应，同时不破坏真实的生物学差异。**\n该原则倾向于基于模型的标准化，而不是简单的缩放，并提倡保留局部数据结构的整合方法。\n\n**原则2：稳定方差，以便为线性降维获得近似同方差的残差。**\n该原则要求一种能解释负二项分布指定均值-方差关系 $\\operatorname{Var}(X_{ij}) = \\mu_{ij} + \\phi_i \\mu_{ij}^2$ 的转换。\n\n**原则3：通过对均值-方差趋势建模来选择信息丰富的特征。**\n这要求一种通过识别比预期更具变异性的基因来区分生物学变异与技术噪音的方法。\n\n**原则4：在一个距离对于生物学流形具有意义的空间中构建邻域图。**\n该原则倾向于在去噪的、低维的空间中使用稳健的度量和图表示来构建图。\n\n**原则5：使用定义明确的目标和稳定性评估来检测细胞群落。**\n这要求一种现代的群落检测算法和一种非武断的参数选择方法。\n\n**原则6：通过尊重生物学重复并控制错误发现率 (FDR) 的、统计上有效的差异表达分析来发现标记基因。**\n这要求一个能够正确建模数据、考虑实验设计（重复/供体）并恰当校正多重检验的统计检验。\n\n### 选项评估\n\n**选项 A:**\n- **标准化与批次校正**：使用基于池的解卷积来获取大小因子，并使用负二项回归来解释文库大小。这是一种复杂的、基于模型的方法，符合原则1。然后，它在低维空间中使用 Harmony 进行批次整合，这是一种在对齐批次的同时保留生物异质性的最先进方法。这完全满足原则1。\n- **方差稳定**：计算正则化的皮尔逊残差 $r_{ij} = \\dfrac{X_{ij} - \\hat{\\mu}_{ij}}{\\sqrt{\\hat{\\mu}_{ij} + \\hat{\\phi}_i \\hat{\\mu}_{ij}^2}}$。这种转换直接源自陈述的负二项方差模型，旨在产生近似同方差的残差，完美符合原则2。\n- **特征选择**：通过对残差方差进行建模来选择高可变基因。这是皮尔逊残差框架内的正确方法，因为它识别了超出负二项模型所能解释的变异的基因。排除线粒体和核糖体基因也是一种最佳实践。这满足原则3。\n- **图构建**：在 PCA 空间中构建 k-最近邻 (kNN) 图，并将其转换为共享最近邻 (SNN) 图。这使用了去噪空间和一种稳健的图表示（SNN），该表示强调了流形的密集区域。这满足原则4。\n- **群落检测**：使用 Leiden 算法（对 Louvain 的改进），并基于自举法的稳定性评估来选择分辨率参数。这是一种严谨且客观的聚类方法，满足原则5。\n- **标记基因发现**：通过按聚类和供体汇总计数，采用伪批量策略。然后使用包含供体效应的负二项广义线性模型 (GLM)，恰当地考虑了生物学重复。它通过 Benjamini-Hochberg 控制 FDR，并使用对数倍数变化阈值。这整个过程代表了多供体 scRNA-seq 实验中差异表达的黄金标准，并完美满足原则6。\n\n**对A的判决：**该选项描述了一个现代的、统计上严谨且内部一致的流程，遵循了所有六项原则。**正确**。\n\n**选项 B:**\n- **标准化**：使用每百万计数 (CPM) 和 $\\log(1+x)$ 变换。这是一种简单但有偏差的方法，不能恰当地稳定方差或解释组成效应，违反了原则1和原则2。\n- **特征选择与降维**：对所有基因使用 t-SNE。没有进行特征选择（违反原则3）。t-SNE 是一种可视化工具，而不是用于保留结构的聚类或降维工具；在其输出上进行聚类是一种已知的反模式。\n- **图构建与聚类**：完全图在计算上不可行，在概念上也有缺陷。Louvain 是一种有效的算法，但输入很差。这违反了原则4。\n- **标记基因发现**：在单细胞水平使用 Wilcoxon 检验，错误地假设细胞是独立的重复样本。它没有考虑供体，也没有对多重检验进行校正。这种方法在统计上是无效的，会产生大量的假阳性，严重违反原则6。\n\n**对B的判决：**这个流程在多个关键步骤上已经过时并且在统计上存在缺陷。**不正确**。\n\n**选项 C:**\n- **标准化与批次校正**：减去每个基因的批次均值是一种激进的方法，可能会移除与批次相关的生物信号，违反了原则1。它忽略了文库大小的标准化。\n- **特征选择**：选择*低方差*基因，这与正确程序的做法相反。这保留了噪音并丢弃了信号，违反了原则3。\n- **降维与图构建**：对原始计数应用 ICA，并在完整的高维基因空间中构建图。这两个步骤都是非标准的，并且受到噪音和维度诅咒的影响，违反了原则4。\n- **群落检测**：层次聚类不具可扩展性，通过目视检查选择聚类数量是主观的，违反了原则5。\n- **标记基因发现**：使用 $t$ 检验，该检验假设正态性，但计数数据不满足此假设，忽略了实验设计，并省略了多重检验校正。这违反了原则6。\n\n**对C的判决：**该选项表现出对 scRNA-seq 数据和分析原则的根本性误解。**不正确**。\n\n**选项 D:**\n- **标准化**：采用分位数标准化，这是一种强制使细胞分布完全相同的严苛方法，可能移除真实的生物学变异。这违反了原则1。\n- **方差稳定**：使用平方根变换，该变换适用于泊松数据，而不适用于问题陈述中指定的负二项数据。这违反了原则2。\n- **群落检测**：使用 Leiden 算法，但选择分辨率以最大化聚类数量。这是一个武断的目标函数，不能保证产生有生物学意义的群落，并违背了原则5的精神。\n- **标记基因发现**：使用带有负二项 GLM 和 FDR 控制的伪批量方法是极好的，并遵守原则6。然而，这最后一步的正确性无法挽救之前数据处理步骤中的严重缺陷。上游的错误会向下游传播并损害最终结果。**不正确**。\n\n### 结论\n\n选项A是唯一一个提出的流程与所提供的数据统计模型完全一致，并遵循了稳健分析的所有六项原则。它代表了 scRNA-seq 分析的最先进工作流程。", "answer": "$$\\boxed{A}$$", "id": "2705551"}, {"introduction": "然而，细胞类型的分类并非总是一帆风顺。随着多模态技术的发展，我们能从同一个细胞中测量其转录组、电生理和表观遗传组等多个维度的特征，但也因此常常会遇到身份特征相互矛盾的“疑难”细胞。本练习将你置于这样一个充满挑战的情境中，要求你设计一套严谨的科学策略来解决这种分类上的模糊性。这是一个关于批判性思维和实验设计的高级实践，它将推动你超越简单的分类任务，深入探究细胞身份的生物学本质[@problem_id:2705573]。", "problem": "一个研究小组将一种多模态单细胞工作流程应用于小鼠初级体感皮层的抑制性中间神经元。其中一个通过基于膜片钳的单细胞测序（Patch-seq）捕获的细胞，在转录组学和电生理学模态之间表现出差异：其信使核糖核酸（mRNA）图谱包含经典的生长抑素（Sst）标记转录本，但其电生理特性为快速发放型，具有窄动作电位和低尖峰频率适应，这是小白蛋白（Pvalb）篮状细胞的特征。\n\n该小组希望确定这个细胞的最佳解释是：由于技术或分析错误导致的错误分类细胞，是一个稳定地共同特化了 Sst 和 Pvalb 程序的罕见混合类型，还是一个 Pvalb 神经元表现出暂时性 Sst 样转录的瞬时状态。\n\n仅使用细胞和分子神经科学的基本原理以及基本统计推断，来推理合适的决策标准和验证实验：\n\n- 分子生物学中心法则（脱氧核糖核酸到核糖核酸到蛋白质）以及从离子通道蛋白丰度通过 Hodgkin–Huxley 型电导到电生理表型的因果联系。\n- 表观遗传程序在小时到天的时间尺度上相对于 mRNA 波动的稳定性。\n- 使用贝叶斯法则，将跨模态的独立证据作为似然因子进行整合，以在不同假设之间做出裁决。\n\n假设以下描述模态可靠性和生物学时间尺度的、源自先前基准研究的、基于经验的数量级参数：\n\n- 在低环境核糖核酸条件下，一个用于区分 Sst 与 Pvalb 转录组类别的单细胞核糖核酸测序（scRNA-seq）监督分类器的准确率约为 $0.95$；在含有高环境核糖核酸的液滴中，Sst 标记读数污染一个非 Sst 细胞的概率约为 $0.05$。\n- 基于电生理学区分快速发放型与非快速发放型的分类器对成熟中间神经元的准确率约为 $0.98$。\n- 单细胞转座酶可及性染色质测序分析（scATAC-seq）对谱系水平中间神经元亚类的分类准确率约为 $0.97$。\n- 在优化的抗原修复条件下，针对 Sst 肽的免疫染色灵敏度约为 $0.90$，特异性约为 $0.99$。\n- 中间神经元 mRNA 的典型半衰期约为 $t_{1/2,\\text{mRNA}} \\sim 5$ 小时，而塑造快速发放特性的主要电压门控离子通道蛋白（例如，钾电压门控通道亚家族 C 成员 1 (Kv3.1b)）的半衰期约为 $t_{1/2,\\text{protein}} \\sim 50$ 小时。\n\n在目标细胞中，观察到以下现象：\n\n- scRNA-seq 报告高 Sst mRNA 和低 Pvalb mRNA。\n- 电生理学显示出典型的 Pvalb 神经元的快速发放特性。\n- 对膜片钳记录细胞的细胞质抽吸物的 Sst 肽免疫染色结果为阴性。\n- 来自同一细胞核的 scATAC-seq 显示，Pvalb 特异性增强子处的染色质开放且具有高可及性，而 Sst 增强子部分可及。\n- 实验室可以在类器官脑片中，使用核糖核酸原位杂交（RNAscope）检测 Sst 和 Pvalb，并进行重复的膜片钳记录，在相隔约 $48$ 小时的两个时间点进行纵向测量。\n- 实验室还可以使用与报告基因杂交的 Sst-Cre 和 Pvalb-Flp 品系进行双重组酶谱系示踪，并使用基于成簇规律间隔短回文重复序列（CRISPR）的条形码技术进行谱系追踪。\n\n哪个选项为该细胞描述了最严谨且有原则的一套标准和验证实验，以区分三种假设——错误分类、罕见混合类型和瞬时状态？请选择唯一最佳选项。\n\nA. 通过对各模态进行简单多数投票来决定：因为电生理学和 scATAC-seq 支持 Pvalb，只有 scRNA-seq 支持 Sst，所以将该细胞标记为 Pvalb 并得出错误分类的结论；仅通过在不进行环境核糖核酸校正的情况下重新聚类 scRNA-seq 数据来进行验证。\n\nB. 使用显式的贝叶斯模型和时间尺度推理来整合各模态，为每个假设建立决策阈值，并使用正交的、纵向的和谱系感知的分析方法进行验证：定义三个假设 $H_{M}$（错误分类或样本交换）、$H_{H}$（罕见混合类型）和 $H_{T}$（瞬时状态）。对于 $H_{M}$，预测时间稳定模态（与离子通道蛋白相关的电生理学、scATAC-seq、谱系报告基因）对于 Pvalb 的一致性，以及技术污染的证据（环境核糖核酸估计、条形码完整性检查）；对于 $H_{H}$，预测 Sst 和 Pvalb 调控元件的稳定共同可及性，Sst 和 Pvalb 转录本和蛋白质在不同时间点和同一谱系的多个细胞中的稳定共表达，以及双重组酶交集标记；对于 $H_{T}$，预测与 Pvalb 一致的 scATAC-seq和谱系，维持快速发放的电生理特性，但 Sst mRNA 出现瞬时脉冲，该脉冲在 $t_{1/2,\\text{mRNA}}$ 时间尺度上衰减，且没有相应的 Sst 肽增加，也没有持续的电生理学重塑。使用从给定准确率得出的每个模态的似然来设置贝叶斯因子阈值（例如，贝叶斯因子大于 $10$），并通过在 0 和 48 小时进行的纵向 RNAscope 和重复膜片钳记录、对 Sst 和 Kv3.1b 的免疫染色、环境核糖核酸定量，以及双重组酶谱系示踪加上多个推定混合细胞间的 CRISPR 谱系一致性来进行验证。\n\nC. 使用组合特征的无监督流形嵌入，如果细胞位于 Sst 和 Pvalb 簇之间，则称其为混合型；仅通过轴突和树突的形态重建进行验证，因为形态学反映了稳定的亚型身份，并且足以排除瞬时状态。\n\nD. 仅通过 scRNA-seq 图谱中升高的即刻早期基因（如 Fos 和 Arc）表达来识别瞬时状态；如果这些基因表达量高，则断定在 Pvalb 细胞中发生了瞬时 Sst 诱导，而无需进一步的表观遗传学分析、纵向测量或技术污染控制。", "solution": "在尝试任何解决方案之前，将首先对问题陈述进行严格验证。\n\n### 步骤 1：提取给定信息\n\n提供的如下信息如下：\n- **系统**：小鼠初级体感皮层中的抑制性中间神经元。\n- **技术**：多模态单细胞工作流程，特别是基于膜片钳的单细胞测序（Patch-seq）。\n- **目标细胞观察结果**：\n    - **mRNA 图谱 (scRNA-seq)**：包含经典的生长抑素 ($Sst$) 标记转录本；高 $Sst$ mRNA 和低小白蛋白 ($Pvalb$) mRNA。\n    - **电生理学 (Ephys)**：快速发放型，具有窄动作电位和低尖峰频率适应，这是 $Pvalb$ 篮状细胞的特征。\n    - **免疫染色**：细胞质抽吸物中的 $Sst$ 肽为阴性。\n    - **表观基因组 (scATAC-seq)**：$Pvalb$ 特异性增强子处的染色质开放，具有高可及性；$Sst$ 增强子部分可及。\n- **待区分的假设**：\n    1.  $H_{M}$：由于技术或分析错误导致的错误分类细胞。\n    2.  $H_{H}$：一种罕见的、稳定的混合细胞类型，具有 $Sst$ 和 $Pvalb$ 程序的共同特化。\n    3.  $H_{T}$：一个瞬时状态，其中一个 $Pvalb$ 神经元表现出暂时的 $Sst$ 样转录。\n- **要求的推理原则**：\n    1.  分子生物学中心法则（DNA $\\rightarrow$ RNA $\\rightarrow$ 蛋白质）以及从离子通道蛋白到电生理学的联系。\n    2.  表观遗传程序相对于 mRNA 波动的稳定性。\n    3.  用于整合证据的贝叶斯法则。\n- **经验参数**：\n    - scRNA-seq 分类器准确率（Sst vs. Pvalb，低环境 RNA）：$\\approx 0.95$。\n    - 在非 $Sst$ 细胞中 $Sst$ 标记污染的概率（高环境 RNA）：$\\approx 0.05$。\n    - 电生理学分类器准确率（快速发放型 vs. 非快速发放型）：$\\approx 0.98$。\n    - scATAC-seq 分类器准确率（谱系水平）：$\\approx 0.97$。\n    - $Sst$ 肽免疫染色灵敏度：$\\approx 0.90$。\n    - $Sst$ 肽免疫染色特异性：$\\approx 0.99$。\n    - mRNA 半衰期：$t_{1/2,\\text{mRNA}} \\sim 5$ 小时。\n    - 蛋白质半衰期（例如，Kv3.1b）：$t_{1/2,\\text{protein}} \\sim 50$ 小时。\n- **可用的验证实验**：\n    - 在 $t=0$ 和 $t=48$ 小时的纵向测量（RNAscope，重复膜片钳记录）。\n    - 双重组酶谱系示踪（$Sst$-Cre 和 $Pvalb$-Flp）。\n    - 基于 CRISPR 的谱系追踪。\n\n### 步骤 2：问题陈述的验证\n\n根据提取的给定信息评估问题的有效性。\n- **有科学依据**：该问题牢固地植根于当代细胞和分子神经科学。具有不一致多模态数据的细胞是单细胞基因组学中一个真实而重大的挑战。所提到的所有概念——Patch-seq、scRNA-seq、scATAC-seq、中心法则、表观遗传稳定性、神经元电生理学、贝叶斯推断以及像 Cre/Flp 这样的遗传工具——都是标准的，并且描述准确。给定的参数对于生物系统和实验分析来说是合理的数量级估计。\n- **提法恰当**：该问题提法恰当。它提出了一个由相互冲突的数据引起的明确模糊性，并要求从一组选项中找出最严谨的方法来解决它。它提供了足够的信息（原则、参数、可用技术）以做出合理的决策。\n- **客观性**：语言客观、技术性强，没有主观论断或偏见。\n\n问题陈述没有违反任何指定的无效标准。它在科学上是合理的、可形式化的、自洽的，并提出了一个需要整合不同生物学尺度和时间领域概念的非凡挑战。\n\n### 步骤 3：结论与行动\n\n问题陈述是**有效的**。将通过分析选项来推导解决方案。\n\n### 推导与选项分析\n\n问题的核心是为一个具有冲突身份标记（mRNA 水平的 $Sst$ 与电生理学水平的 $Pvalb$）的细胞区分三种假设（$H_{M}$、$H_{H}$、$H_{T}$）。一个严谨的解决方案必须利用所提供的原则和数据。\n\n基本原则指导我们的推理：\n1.  **中心法则和时间尺度**：电生理学是由离子通道蛋白的整体组成决定的。蛋白质具有较长的半衰期（$t_{1/2,\\text{protein}} \\sim 50$ 小时）。因此，快速发放表型反映了数天内蛋白质表达的稳定、整合的历史。相比之下，mRNA 的半衰期很短（$t_{1/2,\\text{mRNA}} \\sim 5$ 小时），反映了更为近期的转录状态。观察到高 $Sst$ mRNA 但具有 $Pvalb$ 样的电生理学，这与最近的转录变化尚未——也可能永远不会——转化为蛋白质组成和功能的改变是一致的。阴性的 $Sst$ 肽染色结果进一步支持了这一点，因为显著的蛋白质尚未积累。\n2.  **表观遗传稳定性**：表观基因组（染色质可及性）相对稳定，反映了细胞的谱系和长期转录潜能。scATAC-seq 数据显示 $Pvalb$ 增强子具有高可及性，而 $Sst$ 增强子仅部分可及，这表明其主要的身份或谱系定型为 $Pvalb$，并带有一些表达 $Sst$ 的潜在或次要潜能。这一证据不利于一个稳定的、完全共同特化的混合类型，因为在这种类型中，两组增强子都应具有高且稳定的可及性。\n3.  **贝叶斯整合**：一种正式的方法不会将每个模态视为平等的“一票”。相反，人们会使用贝叶斯法则，根据每个模态的证据来更新每个假设的概率。一个观察（例如，快速发放的电生理学）在某个假设（例如，该细胞确实是 $Sst$ 类型）下的似然性，可以使用给定的分类器准确率（例如，电生理学分类器的错误率，$1 - 0.98 = 0.02$）来计算。跨独立模态的这些似然的乘积，由假设的先验概率加权，决定了后验概率。\n\n基于这些原则，我们为每个假设制定预测：\n- **$H_{M}$（错误分类/错误）**：核心身份是 $Pvalb$。$Sst$ mRNA 是一种假象。我们预测稳定特征（电生理学、表观基因组、谱系）都将指向 $Pvalb$。应该有技术错误的证据，例如已知会导致虚假转录本检测的高环境 RNA 水平，或遗传条形码的差异。\n- **$H_{H}$（稳定混合型）**：该细胞具有稳定的双重身份。我们预测所有生物学水平的特征都将显示共表达。表观基因组应同时具有 $Sst$ 和 $Pvalb$ 的稳定开放增强子。mRNA 和蛋白质都应持续共表达。关键是，这种状态应该随时间稳定，因此纵向测量（$48$ 小时）应显示持续的共表达。谱系追踪应该能识别出这样一群细胞，双重组酶报告基因应该能标记它们。\n- **$H_{T}$（瞬时状态）**：该细胞具有核心的 $Pvalb$ 身份，但暂时表达 $Sst$ mRNA。我们预测稳定特征（电生理学、表观基因组、谱系）将是 $Pvalb$ 样的。$Sst$ mRNA 的表达将是短暂的，并以其特征性半衰期（约 5 小时）衰减。在 $48$ 小时（近 10 个半衰期）后的测量应显示 $Sst$ mRNA 信号消失，而 $Pvalb$ 样的电生理特性得以维持。不会产生显著的 $Sst$ 肽。\n\n现在我们根据这个严谨的框架来评估所提供的选项。\n\n**A. 通过对各模态进行简单多数投票来决定：因为电生理学和 scATAC-seq 支持 Pvalb，只有 scRNA-seq 支持 Sst，所以将该细胞标记为 Pvalb 并得出错误分类的结论；仅通过在不进行环境核糖核酸校正的情况下重新聚类 scRNA-seq 数据来进行验证。**\n这种方法从根本上就是有缺陷的。“多数投票”是一种无原则的启发式方法，它忽略了不同数据类型的生物学意义、时间尺度和可靠性。它错误地将来自稳定表观基因组的证据与来自动态转录组的证据等同起来。此外，通过*不*进行环境 RNA 校正来“验证”，在科学上是疏忽的；环境 RNA 是该选项声称要识别的技术错误的主要候选者。这种方法过于简单且不充分。\n**结论：不正确。**\n\n**B. 使用显式的贝叶斯模型和时间尺度推理来整合各模态，为每个假设建立决策阈值，并使用正交的、纵向的和谱系感知的分析方法进行验证：定义三个假设 $H_{M}$（错误分类或样本交换）、$H_{H}$（罕见混合类型）和 $H_{T}$（瞬时状态）。对于 $H_{M}$，预测时间稳定模态...对于 $H_{H}$，预测稳定共同可及性...对于 $H_{T}$，预测与 Pvalb 一致的 scATAC-seq和谱系，维持快速发放的电生理特性，但 Sst mRNA 出现瞬时脉冲...设置贝叶斯因子阈值...并通过在 0 和 48 小时进行的纵向 RNAscope 和重复膜片钳记录、对 Sst 和 Kv3.1b 的免疫染色、环境核糖核酸定量，以及双重组酶谱系示踪加上多个推定混合细胞间的 CRISPR 谱系一致性来进行验证。**\n该选项提出了一个全面且方法学上合理的策略。它明确援引了所需的推理原则：贝叶斯整合（使用给定准确率的似然）、时间尺度推理（使用半衰期区分稳定身份与瞬时 mRNA 脉冲）和表观遗传稳定性。其对每个假设（$H_{M}$、$H_{H}$、$H_{T}$）的预测是精确的，并直接源于这些原则。提议的验证实验是详尽的，并且完美地设计用于测试这些预测：纵向分析测试稳定性（$H_{H}$）与瞬时性（$H_{T}$）；环境 RNA 定量和条形码检查测试技术错误（$H_{M}$）；谱系追踪测试稳定细胞类型的存在（$H_{H}$）。这代表了最严谨和最有原则的方法。\n**结论：正确。**\n\n**C. 使用组合特征的无监督流形嵌入，如果细胞位于 Sst 和 Pvalb 簇之间，则称其为混合型；仅通过轴突和树突的形态重建进行验证，因为形态学反映了稳定的亚型身份，并且足以排除瞬时状态。**\n这种方法不充分。在低维嵌入（如 UMAP 或 t-SNE）中的中间位置是一种观察，而不是一种解释。技术假象（$H_{M}$）、瞬时状态（$H_{T}$）和真正的混合型（$H_{H}$）都可能导致这样的嵌入。仅依赖形态学进行验证是一个严重的局限。虽然形态学是一个稳定的特征，但它只是细胞类型的一个方面，本身无法解决转录组与其他模态之间的差异，也无法排除技术错误。该选项未能处理问题的时间动态和多层次性质。\n**结论：不正确。**\n\n**D. 仅通过 scRNA-seq 图谱中升高的即刻早期基因（如 Fos 和 Arc）表达来识别瞬时状态；如果这些基因表达量高，则断定在 Pvalb 细胞中发生了瞬时 Sst 诱导，而无需进一步的表观遗传学分析、纵向测量或技术污染控制。**\n这是一个过早和鲁莽的结论。虽然即刻早期基因（IEGs）的表达是近期活动的标志，但它不能唯一地证明 $H_{T}$。高活性可能是瞬时状态的触发因素，但也可能参与维持混合状态（$H_{H}$）。最重要的是，该选项明确主张忽略其他关键的调查方向。在“无需进一步”进行技术控制、表观遗传数据或纵向验证的情况下得出任何结论，都与科学方法背道而驰。必须始终排除技术错误（$H_{M}$），并收集足够的证据来区分相互竞争的生物学假设。\n**结论：不正确。**\n\n总之，选项 B 是唯一描述了一种科学严谨、多方面、有原则的方法的选项，该方法正确地使用了所有可用信息和概念工具来解决问题的复杂性。它通过定量建模和靶向验证实验的结合，为区分这三种假设提出了一条清晰的路径。", "answer": "$$\\boxed{B}$$", "id": "2705573"}]}