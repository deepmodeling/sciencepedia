{"hands_on_practices": [{"introduction": "戈德曼-霍奇金-卡茨（GHK）电压方程的威力在于它能精确描述多种离子如何共同决定膜电位。这个练习将引导你从第一性原理出发，处理一个同时对阳离子（$Na^+$）和阴离子（$Cl^-$）通透的通道 [@problem_id:2763559]。通过推导并计算其反转电位，你将掌握处理带负电荷的阴离子时的关键区别，这是理解离子对膜电位贡献的一个基本且至关重要的技能。", "problem": "一个膜片上表达一种离子通道，该通道仅对单价钠离子和氯离子通透。将膜电位定义为 $V_{m} = V_{\\text{inside}} - V_{\\text{outside}}$。细胞外和细胞内的浓度如下：$[\\mathrm{Na}^{+}]_{o} = 145\\,\\mathrm{mM}$，$[\\mathrm{Na}^{+}]_{i} = 15\\,\\mathrm{mM}$，$[\\mathrm{Cl}^{-}]_{o} = 120\\,\\mathrm{mM}$，$[\\mathrm{Cl}^{-}]_{i} = 10\\,\\mathrm{mM}$。相对通透性为 $P_{\\mathrm{Na}} = 1.0$ 和 $P_{\\mathrm{Cl}} = 0.20$（单位一致但任意）。绝对温度为 $T = 310\\,\\mathrm{K}$。使用普适气体常数 $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 和法拉第常数 $F = 96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$。\n\n从物种 $i$ 的稳态 Nernst–Planck 通量出发，\n$$\nJ_{i}(x) \\;=\\; -D_{i}\\left(\\frac{d C_{i}}{dx} + \\frac{z_{i} F}{R T}\\,C_{i}\\,\\frac{d\\phi}{dx}\\right),\n$$\n并假设膜是一维的，厚度为 $d$，内部电场均匀（因此 $\\phi(x)$ 从外到内线性变化），在恒定场近似下，通过施加跨膜净电流为零的条件，推导该混合 $\\mathrm{Na}^{+}/\\mathrm{Cl}^{-}$ 通道的反转电位 $V_{\\text{rev}}$ 的表达式。在你的推导中，需明确考虑离子价 $z_{\\mathrm{Na}} = +1$ 和 $z_{\\mathrm{Cl}} = -1$，并论证阴离子的符号如何影响最终电压表达式中出现的细胞内浓度与细胞外浓度。\n\n然后，使用上述参数对你推导的表达式进行数值计算，以获得 $V_{\\text{rev}}$ 的单个数值。你的最终数值答案以 $\\mathrm{mV}$ 为单位，并四舍五入到四位有效数字。\n\n最后，在钳制电位 $V_{m} = 0\\,\\mathrm{mV}$ 时，确定通过该通道的净电流的符号，并使用你的恒定场表达式简要解释 $\\mathrm{Cl}^{-}$ 的负价如何决定其相对于 $\\mathrm{Na}^{+}$ 的贡献方向。你的解释不应改变上面要求的最终数值答案。", "solution": "该问题需要进行验证。\n\n逐字提取已知条件：\n- 膜通道仅对单价钠离子（$\\mathrm{Na}^{+}$）和氯离子（$\\mathrm{Cl}^{-}$）通透。\n- 膜电位定义：$V_{m} = V_{\\text{inside}} - V_{\\text{outside}}$。\n- 细胞外钠离子浓度：$[\\mathrm{Na}^{+}]_{o} = 145\\,\\mathrm{mM}$。\n- 细胞内钠离子浓度：$[\\mathrm{Na}^{+}]_{i} = 15\\,\\mathrm{mM}$。\n- 细胞外氯离子浓度：$[\\mathrm{Cl}^{-}]_{o} = 120\\,\\mathrm{mM}$。\n- 细胞内氯离子浓度：$[\\mathrm{Cl}^{-}]_{i} = 10\\,\\mathrm{mM}$。\n- 相对通透性：$P_{\\mathrm{Na}} = 1.0$ 和 $P_{\\mathrm{Cl}} = 0.20$。\n- 绝对温度：$T = 310\\,\\mathrm{K}$。\n- 普适气体常数：$R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- 法拉第常数：$F = 96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$。\n- Nernst–Planck 通量方程：$J_{i}(x) \\;=\\; -D_{i}\\left(\\frac{d C_{i}}{dx} + \\frac{z_{i} F}{R T}\\,C_{i}\\,\\frac{d\\phi}{dx}\\right)$。\n- 假设：一维膜，厚度为 $d$，电场均匀。\n- 离子价：$z_{\\mathrm{Na}} = +1$ 和 $z_{\\mathrm{Cl}} = -1$。\n- 任务：\n    1. 在恒定场近似下，通过施加净电流为零的条件推导反转电位 $V_{\\text{rev}}$。\n    2. 论证阴离子的符号如何影响最终表达式。\n    3. 以 $\\mathrm{mV}$ 为单位，计算 $V_{\\text{rev}}$ 的数值，保留四位有效数字。\n    4. 在 $V_{m} = 0\\,\\mathrm{mV}$ 时，确定净电流的符号并解释 $\\mathrm{Cl}^{-}$ 的负价所起的作用。\n\n该问题有效。这是一个生物物理学中的标准、适定问题，基于已确立的物理化学原理（Nernst-Planck 方程）。所有必要数据均已提供，且数值具有生理学上的真实性。该问题是自洽的、客观的，需要严谨的推导和计算，适合科学探究。\n\n我们现在开始求解。\n\n推导始于离子物种 $i$ 穿过一维膜的 Nernst–Planck 方程：\n$$\nJ_{i}(x) = -D_{i}\\left(\\frac{d C_{i}}{dx} + \\frac{z_{i} F}{R T}\\,C_{i}\\,\\frac{d\\phi}{dx}\\right)\n$$\n此处，$J_{i}$ 是通量（单位面积单位时间的摩尔数），$D_{i}$ 是扩散系数，$C_{i}(x)$ 是膜内位置 $x$ 处的浓度，$z_{i}$ 是离子价，$F$ 是法拉第常数，$R$ 是普适气体常数，$T$ 是绝对温度，$\\phi(x)$ 是电位。空间坐标 $x$ 的范围从 $x=0$（外部）到 $x=d$（内部）。\n\n恒定场近似假设电场 $E = -d\\phi/dx$ 在整个膜上是均匀的。因此，$d\\phi/dx = (\\phi(d) - \\phi(0))/d = (V_{\\text{inside}} - V_{\\text{outside}})/d = V_{m}/d$。\n将此代入 Nernst-Planck 方程：\n$$\nJ_{i} = -D_{i}\\left(\\frac{d C_{i}}{dx} + \\frac{z_{i} F V_{m}}{R T d}\\,C_{i}\\right)\n$$\n在稳态下，通量 $J_{i}$ 必须不随 $x$ 变化。我们可以将其重排为关于 $C_{i}(x)$ 的一阶线性常微分方程：\n$$\n\\frac{d C_{i}}{dx} + \\left(\\frac{z_{i} F V_{m}}{R T d}\\right) C_{i} = -\\frac{J_{i}}{D_{i}}\n$$\n该方程通过在膜上从 $x=0$ 到 $x=d$ 进行积分求解，边界条件为 $C_{i}(0) = [C_{i}]_{o}$ 和 $C_{i}(d) = [C_{i}]_{i}$。稳态通量 $J_i$ 的解为：\n$$\nJ_i = - \\frac{P_i z_i F V_m}{RT} \\frac{[C_i]_i \\exp\\left(\\frac{z_i F V_m}{RT}\\right) - [C_i]_o}{\\exp\\left(\\frac{z_i F V_m}{RT}\\right) - 1}\n$$\n其中通透性 $P_i$ 定义为 $P_i = D_i/d$。\n\n反转电位 $V_{\\text{rev}}$ 是指总电流密度 $I_{\\text{total}}$ 为零时的膜电位 $V_m$。离子 $i$ 承载的电流密度为 $I_i = z_i F J_i$。净电流为零的条件是：\n$$\nI_{\\text{total}} = \\sum_{i} I_i = \\sum_{i} z_i F J_i = 0\n$$\n对于给定的包含 $\\mathrm{Na}^{+}$ 和 $\\mathrm{Cl}^{-}$ 的系统，在 $V_m \\ne 0$ 时，总电流为零的条件可以简化为：\n$$\nP_{\\text{Na}} \\frac{[\\text{Na}]_i \\exp\\left(\\frac{F V_m}{RT}\\right) - [\\text{Na}]_o}{\\exp\\left(\\frac{F V_m}{RT}\\right) - 1} + P_{\\text{Cl}} \\frac{[\\text{Cl}]_i \\exp\\left(-\\frac{F V_m}{RT}\\right) - [\\text{Cl}]_o}{\\exp\\left(-\\frac{F V_m}{RT}\\right) - 1} = 0\n$$\n这里我们代入了 $z_{\\text{Na}}=+1$ 和 $z_{\\text{Cl}}=-1$，并注意到对于这两种离子 $z_i^2 = 1$。\n\n一个关键步骤是处理阴离子 $\\mathrm{Cl}^{-}$ 的项。我们对其进行变换，以便与 $\\mathrm{Na}^{+}$ 项创建公共分母。令 $u = \\frac{F V_m}{RT}$。$\\mathrm{Cl}^{-}$ 项为：\n$$\nP_{\\text{Cl}} \\frac{[\\text{Cl}]_i \\exp(-u) - [\\text{Cl}]_o}{\\exp(-u) - 1} = P_{\\text{Cl}} \\frac{[\\text{Cl}]_i \\exp(-u) - [\\text{Cl}]_o}{-\\exp(-u)(\\exp(u) - 1)} = P_{\\text{Cl}} \\frac{[\\text{Cl}]_o \\exp(u) - [\\text{Cl}]_i}{\\exp(u) - 1}\n$$\n这一变换明确地显示了负价 $z_{\\text{Cl}}=-1$ 的结果。与阳离子相比，它有效地交换了分子中细胞内浓度和细胞外浓度的角色。\n\n在 $V_m = V_{\\text{rev}}$ 时，令分子之和为零：\n$$\nP_{\\text{Na}} \\left([\\text{Na}]_i \\exp\\left(\\frac{F V_{\\text{rev}}}{RT}\\right) - [\\text{Na}]_o\\right) + P_{\\text{Cl}} \\left([\\text{Cl}]_o \\exp\\left(\\frac{F V_{\\text{rev}}}{RT}\\right) - [\\text{Cl}]_i\\right) = 0\n$$\n我们将包含 $\\exp\\left(\\frac{F V_{\\text{rev}}}{RT}\\right)$ 的项组合在一起：\n$$\n\\exp\\left(\\frac{F V_{\\text{rev}}}{RT}\\right) (P_{\\text{Na}}[\\text{Na}]_i + P_{\\text{Cl}}[\\text{Cl}]_o) = P_{\\text{Na}}[\\text{Na}]_o + P_{\\text{Cl}}[\\text{Cl}]_i\n$$\n求解 $V_{\\text{rev}}$ 得到该系统的 Goldman-Hodgkin-Katz (GHK) 电压方程：\n$$\nV_{\\text{rev}} = \\frac{RT}{F} \\ln\\left( \\frac{P_{\\text{Na}}[\\mathrm{Na}^{+}]_{o} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_{i}}{P_{\\text{Na}}[\\mathrm{Na}^{+}]_{i} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_{o}} \\right)\n$$\n正如推导中所论证的，$\\mathrm{Cl}^{-}$ 的负价导致其细胞内浓度 $[\\mathrm{Cl}^{-}]_{i}$ 出现在对数参数的分子中，而其细胞外浓度 $[\\mathrm{Cl}^{-}]_{o}$ 出现在分母中，这与阳离子 $\\mathrm{Na}^{+}$ 的排列方式相反。\n\n接下来，我们对该表达式进行数值计算。首先，我们计算前置因子 $\\frac{RT}{F}$：\n$$\n\\frac{RT}{F} = \\frac{(8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) \\times (310\\,\\mathrm{K})}{96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}} \\approx 0.0267134\\,\\mathrm{V}\n$$\n现在，我们使用给定的通透性和浓度计算对数的参数。浓度单位 (mM) 会被约掉。\n$$\n\\frac{P_{\\text{Na}}[\\mathrm{Na}^{+}]_{o} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_{i}}{P_{\\text{Na}}[\\mathrm{Na}^{+}]_{i} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_{o}} = \\frac{(1.0 \\times 145) + (0.20 \\times 10)}{(1.0 \\times 15) + (0.20 \\times 120)} = \\frac{145 + 2}{15 + 24} = \\frac{147}{39} = \\frac{49}{13}\n$$\n现在，我们计算 $V_{\\text{rev}}$：\n$$\nV_{\\text{rev}} = (0.0267134\\,\\mathrm{V}) \\times \\ln\\left(\\frac{49}{13}\\right) \\approx (0.0267134\\,\\mathrm{V}) \\times 1.32680 \\approx 0.035445\\,\\mathrm{V}\n$$\n转换为毫伏 (mV) 并四舍五入到四位有效数字：\n$$\nV_{\\text{rev}} \\approx 35.45\\,\\mathrm{mV}\n$$\n\n最后，我们确定在 $V_{m} = 0\\,\\mathrm{mV}$ 时净电流的符号。在 $V_m = 0$ 时，电驱动力消失，通量纯粹由扩散驱动。此时的离子通量 $J_i$（定义内流为正）为 $J_i(0) = P_i ([C_i]_o - [C_i]_i)$。\n对于 $\\mathrm{Na}^{+}$：$J_{\\text{Na}}(0) = 1.0 \\times (145-15) = 130$（单位为浓度 $\\times$ 速度）。为正，因此是内流。\n对于 $\\mathrm{Cl}^{-}$：$J_{\\text{Cl}}(0) = 0.20 \\times (120-10) = 22$。为正，因此是内流。\n净电流密度为 $I_{\\text{net}} = I_{\\text{Na}} + I_{\\text{Cl}} = z_{\\text{Na}} F J_{\\text{Na}} + z_{\\text{Cl}} F J_{\\text{Cl}}$。\n$$\nI_{\\text{net}}(0) = (+1)F(130) + (-1)F(22) = 130F - 22F = 108F\n$$\n由于 $F > 0$，净电流 $I_{\\text{net}}(0)$ 的符号为正。这对应于正电荷的净内流。\n\n$\\mathrm{Cl}^{-}$ 的负价是至关重要的。对于 $\\mathrm{Na}^{+}$ 和 $\\mathrm{Cl}^{-}$，外部浓度都更高，因此扩散驱动这两种物质流入细胞（内流）。正的 $\\mathrm{Na}^{+}$ 离子的内流贡献了一个向内的电流分量。负的 $\\mathrm{Cl}^{-}$ 离子的内流等效于一个正电荷向外的电流。因此，$\\mathrm{Cl}^{-}$ 电流与 $\\mathrm{Na}^{+}$ 电流方向相反。负价 $z_{\\text{Cl}} = -1$ 使氯离子通量对电流的贡献相对于钠离子通量的贡献符号反转，正如最终求和中的 $-22F$ 项所示。净电流是一个较大的向内 $\\mathrm{Na}^{+}$ 分量和一个较小的向外 $\\mathrm{Cl}^{-}$ 分量的总和，导致正电荷的净内向电流（在我们的物理推导中为正号）。", "answer": "$$\n\\boxed{35.45}\n$$", "id": "2763559"}, {"introduction": "在前一个练习的基础上，本次实践将GHK原理应用于一个至关重要的生理场景：GABA_A受体，它同时对氯离子（$Cl^-$）和碳酸氢根离子（$HCO_3^-$）通透 [@problem_id:2763536]。这个练习将展示如何扩展GHK方程来处理多种同电荷的通透离子，并计算出一个决定GABA能输入是抑制性还是兴奋性的反转电位。这体现了GHK方程在神经科学中的直接预测能力。", "problem": "一个单室神经元通过一个A型γ-氨基丁酸（GABA_A）受体通道接收突触输入，该通道仅对氯离子和碳酸氢根离子通透。该通道的碳酸氢根离子对氯离子的相对渗透率比为 $P_{\\mathrm{HCO_3}}/P_{\\mathrm{Cl}} = 0.2$。细胞内和细胞外的浓度为：\n- $[\\mathrm{Cl}^-]_i = 10~\\mathrm{mM}$，$[\\mathrm{Cl}^-]_o = 130~\\mathrm{mM}$，\n- $[\\mathrm{HCO_3}^-]_i = 15~\\mathrm{mM}$，$[\\mathrm{HCO_3}^-]_o = 24~\\mathrm{mM}$。\n假设两种阴离子的化合价均为 $z=-1$，活度等于浓度，温度为 $T=310~\\mathrm{K}$，且跨孔道的膜电场在空间上是均匀的（恒定场近似）。同时假设通过该通道的离子渗透遵循独立性原则。\n\n从 Nernst–Planck 电扩散框架出发，并利用反转电位 $E_{\\mathrm{rev}}$ 是指通过该通道的净电流为零时的膜电位这一条件，推导出一个适用于通透两种单价阴离子的通道的 $E_{\\mathrm{rev}}$ 表达式，并根据上述参数对其进行数值计算。在不失一般性的前提下，你可以用相对于 $P_{\\mathrm{Cl}}$ 的渗透率来表示。\n\n将最终数值结果四舍五入至三位有效数字，并以毫伏（mV）为单位表示。最终答案必须是一个实数。", "solution": "本题的任务是，在给定氯离子和碳酸氢根离子这两种单价阴离子的浓度以及相对渗透率 $P_{\\mathrm{HCO_3}}/P_{\\mathrm{Cl}}=0.2$ 的条件下，求出通道的反转电位 $E_{\\mathrm{rev}}$。我们从第一性原理出发进行推导。\n\n出发点是描述价态为 $z_j$ 的离子物种 $j$ 在电势 $V(x)$ 和浓度 $C_j(x)$ 下的离子通量的 Nernst–Planck 方程。在恒定场近似和稳态条件下，对 Nernst–Planck 方程进行跨膜积分，可以得到单价离子的 Goldman 通量形式。\n\n反转电位 $E_{\\mathrm{rev}}$ 由通过通道的净电流为零的条件定义：$\\sum_j I_j = 0$。对于价态为 $z_j=-1$ 的阴离子，总电流为零意味着总通量也为零 $\\sum_j J_j = 0$。对于离子 $j$，其通量为：\n$$\nJ_j \\;=\\; P_j \\,\\frac{C_{j,i} - C_{j,o} \\exp\\!\\left(-\\frac{F V_m}{R T}\\right)}{1 - \\exp\\!\\left(-\\frac{F V_m}{R T}\\right)}\n$$\n将 $V_m = E_{\\mathrm{rev}}$ 代入并设总通量为零，对两种可渗透阴离子 $j \\in \\{\\mathrm{Cl}^-, \\mathrm{HCO_3}^-\\}$进行求和：\n$$\n\\sum_j P_j \\left( C_{j,i} - C_{j,o} \\exp\\!\\left(-\\frac{F E_{\\mathrm{rev}}}{R T}\\right) \\right) \\;=\\; 0\n$$\n整理得到：\n$$\n\\sum_j P_j C_{j,i} \\;=\\; \\exp\\!\\left(-\\frac{F E_{\\mathrm{rev}}}{R T}\\right) \\sum_j P_j C_{j,o}.\n$$\n解出 $E_{\\mathrm{rev}}$，得到专门适用于单价阴离子的 Goldman–Hodgkin–Katz (GHK) 电压表达式：\n$$\nE_{\\mathrm{rev}} \\;=\\; -\\frac{R T}{F} \\,\\ln\\!\\left( \\frac{\\sum\\limits_{j} P_j C_{j,i}}{\\sum\\limits_{j} P_j C_{j,o}} \\right),\n$$\n其中 $j \\in \\{\\mathrm{Cl}^-, \\mathrm{HCO_3}^-\\}$。\n\n代入给定的渗透率比 $P_{\\mathrm{HCO_3}}/P_{\\mathrm{Cl}} = 0.2$。不失一般性，设 $P_{\\mathrm{Cl}} = 1$ 和 $P_{\\mathrm{HCO_3}} = 0.2$（任何公共的乘法因子都会在比值中被约掉）。代入给定的浓度：\n- $C_{\\mathrm{Cl},i} = [\\mathrm{Cl}^-]_i = 10~\\mathrm{mM}$,\n- $C_{\\mathrm{Cl},o} = [\\mathrm{Cl}^-]_o = 130~\\mathrm{mM}$,\n- $C_{\\mathrm{HCO_3},i} = [\\mathrm{HCO_3}^-]_i = 15~\\mathrm{mM}$,\n- $C_{\\mathrm{HCO_3},o} = [\\mathrm{HCO_3}^-]_o = 24~\\mathrm{mM}$。\n\n计算加权和：\n$$\n\\sum_j P_j C_{j,i} \\;=\\; P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_i + P_{\\mathrm{HCO_3}}[\\mathrm{HCO_3}^-]_i \\;=\\; 1 \\cdot 10 + 0.2 \\cdot 15 \\;=\\; 13,\n$$\n$$\n\\sum_j P_j C_{j,o} \\;=\\; P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_o + P_{\\mathrm{HCO_3}}[\\mathrm{HCO_3}^-]_o \\;=\\; 1 \\cdot 130 + 0.2 \\cdot 24 \\;=\\; 134.8.\n$$\n因此，\n$$\nE_{\\mathrm{rev}} \\;=\\; -\\frac{R T}{F} \\,\\ln\\!\\left(\\frac{13}{134.8}\\right).\n$$\n\n在 $T=310~\\mathrm{K}$ 时，$\\frac{R T}{F}$ 的数值为\n$$\n\\frac{R T}{F} \\;=\\; \\frac{8.314462618~\\mathrm{J\\,mol^{-1}\\,K^{-1}}\\times 310~\\mathrm{K}}{96485.33212~\\mathrm{C\\,mol^{-1}}} \\;\\approx\\; 0.02672~\\mathrm{V} \\;=\\; 26.72~\\mathrm{mV}.\n$$\n计算对数值：\n$$\n\\ln\\!\\left(\\frac{13}{134.8}\\right) \\;=\\; \\ln(0.09645\\ldots) \\;\\approx\\; -2.33884.\n$$\n因此，\n$$\nE_{\\mathrm{rev}} \\;\\approx\\; -(26.72~\\mathrm{mV}) \\times (-2.33884) \\;\\approx\\; 62.5~\\mathrm{mV}.\n$$\n四舍五入至三位有效数字并以毫伏表示，结果为 $62.5~\\mathrm{mV}$。", "answer": "$$\\boxed{62.5}$$", "id": "2763536"}, {"introduction": "本次实践将挑战标准GHK电压方程的边界，该方程仅适用于单价离子。我们将处理一个更复杂也更贴近真实的场景：一个同时对不同价态离子——单价的钠离子（$Na^+$）和二价的钙离子（$Ca^{2+}$）——通透的通道 [@problem_id:2763525]。你将发现，在这种情况下，一个简单的封闭形式解已不复存在，必须采用更基本的方法：通过数值求解GHK *电流* 方程，找到净电流为零时的电位。这个练习将引入一种强大的计算技术，这对于现代生物物理建模至关重要。", "problem": "要求您使用第一性原理电扩散模型，计算一个对钙离子和钠离子通透的膜通道的翻转电位。从恒定场假设下的稳态 Nernst–Planck 描述出发，并施加跨膜净电流为零的条件。考虑两种离子：化合价为 $z_{\\mathrm{Ca}}=+2$ 的钙离子和化合价为 $z_{\\mathrm{Na}}=+1$ 的钠离子。绝对温度为 $T=310\\,\\mathrm{K}$，气体常数为 $R=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，法拉第常数为 $F=96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$。细胞外和细胞内的活度（此处用浓度近似）如下：$[\\mathrm{Ca}]_o=2\\,\\mathrm{mM}$，$[\\mathrm{Ca}]_i=100\\,\\mathrm{nM}$，$[\\mathrm{Na}]_o=140\\,\\mathrm{mM}$，以及 $[\\mathrm{Na}]_i=12\\,\\mathrm{mM}$。确保所有浓度使用一致的单位；必要时将纳摩尔浓度 (nM) 转换为毫摩尔浓度 (mM)。设通透性比率为 $r=P_{\\mathrm{Ca}}/P_{\\mathrm{Na}}$，其中 $P_{\\mathrm{Na}}>0$ 是任意的，因为在净电流为零时，只有该比率有意义。翻转电位 $E_{\\mathrm{rev}}$ 被定义为总离子电流为零时的膜电位 $V_m$（内部相对于外部）。\n\n你的任务是：\n- 从恒定场假设下的稳态 Nernst–Planck 方程出发，推导出在膜电位为 $V_m$ 时，化合价为 $z_i$、通透性为 $P_i$ 的离子种类 $i$ 的跨膜离子电流表达式，该表达式是 $[\\mathrm{ion}]_i$、$[\\mathrm{ion}]_o$、$z_i$、$P_i$、$R$、$T$ 和 $F$ 的函数。\n- 对双离子系统 $\\{\\mathrm{Ca}^{2+},\\mathrm{Na}^+\\}$ 施加净电流为零的条件，并证明对于给定的 $r$ 和浓度，$E_{\\mathrm{rev}}$ 是唯一确定的，过程中不使用任何预先记下的简化公式。\n- 实现一个数值求根算法，通过找到使给定 $r$ 下总电流为零的 $V_m$ 来求解 $E_{\\mathrm{rev}}$（以伏特为单位）。\n- 以毫伏为单位表示最终答案，并四舍五入到三位小数。\n\n使用以下通透性比率测试组来评估您的程序：\n- $r=0$\n- $r=0.01$\n- $r=0.1$\n- $r=1$\n- $r=10$\n- $r=1000$\n\n所有其他参数均按上文规定固定。您的程序应将对应这六个测试用例的六个翻转电位输出为单行、逗号分隔的浮点数列表（单位为 $\\mathrm{mV}$，四舍五入到三位小数），并用方括号括起来，例如：$[\\dots]$。\n\n物理单位要求：以 $\\mathrm{mV}$ 为单位表示最终的膜电位，四舍五入到三位小数。\n\n角度单位不适用。百分比不适用。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[x_1,x_2,x_3,x_4,x_5,x_6]$），其中每个 $x_k$ 是一个以 $\\mathrm{mV}$ 为单位、四舍五入到三位小数的浮点数。", "solution": "提交分析的问题陈述被认为是有效的。它具有科学依据，是良定的，并为电生理学中的一个非平凡问题提供了一套完整且一致的参数。它要求推导和应用基本原理，特别是恒定场假设下的 Nernst-Planck 电扩散模型。\n\n我们首先推导单个离子种类的电流-电压关系，即 Goldman-Hodgkin-Katz (GHK) 电流方程。出发点是 Nernst-Planck 方程，它描述了离子种类 $i$ 在跨膜位置 $x$ 处的通量 $J_i(x)$：\n$$J_i(x) = -D_i \\left( \\frac{dC_i(x)}{dx} + \\frac{z_i F}{RT} C_i(x) \\frac{d\\phi(x)}{dx} \\right)$$\n此处，$D_i$ 是扩散系数，$C_i(x)$ 是浓度，$z_i$ 是化合价，$F$ 是法拉第常数，$R$ 是气体常数，$T$ 是绝对温度，$\\phi(x)$ 是电势。\n\n我们施加两个关键假设：\n1.  **稳态**：系统处于稳态，意味着在膜内所有位置 $x$ 的通量 $J_i$ 都是恒定的，即 $dJ_i/dx = 0$。\n2.  **恒定场**：电场 $E = -d\\phi/dx$ 在整个膜厚度 $L$ 上是恒定的。如果跨膜电势差为 $V_m = \\phi_{in} - \\phi_{out}$，则 $d\\phi/dx = V_m/L$。\n\n将这些假设代入并对 Nernst-Planck 方程积分，得到 GHK 电流方程，即离子 $i$ 的总电流 $I_i$ 与膜电位 $V_m$ 的关系：\n$$I_i(V_m) = P_i \\frac{z_i^2 F^2 V_m}{RT} \\frac{[i]_i - [i]_o e^{-z_i F V_m / (RT)}}{1 - e^{-z_i F V_m / (RT)}}$$\n其中 $P_i$ 是通透性系数。正电流对应于正电荷的净向外流动。\n\n翻转电位 $E_{\\mathrm{rev}}$ 是指跨膜总电流为零时的膜电位 $V_m$。对于给定的对钠离子（$\\mathrm{Na}^+$）和钙离子（$\\mathrm{Ca}^{2+}$）通透的系统，该条件为：\n$$I_{\\mathrm{total}}(E_{\\mathrm{rev}}) = I_{\\mathrm{Na}}(E_{\\mathrm{rev}}) + I_{\\mathrm{Ca}}(E_{\\mathrm{rev}}) = 0$$\n对于非零翻转电位（$E_{\\mathrm{rev}} \\ne 0$），可以将总电流方程简化。定义通透性比率 $r = P_{\\mathrm{Ca}}/P_{\\mathrm{Na}}$，并代入化合价 $z_{\\mathrm{Na}}=+1$ 和 $z_{\\mathrm{Ca}}=+2$，得到一个关于 $E_{\\mathrm{rev}}$ 的超越方程：\n$$(1)^2 \\frac{[\\mathrm{Na}]_i - [\\mathrm{Na}]_o e^{-E_{\\mathrm{rev}}F/(RT)}}{1 - e^{-E_{\\mathrm{rev}}F/(RT)}} + r (2)^2 \\frac{[\\mathrm{Ca}]_i - [\\mathrm{Ca}]_o e^{-2E_{\\mathrm{rev}}F/(RT)}}{1 - e^{-2E_{\\mathrm{rev}}F/(RT)}} = 0$$\n由于该方程没有简单的封闭形式解，我们采用数值求根方法来求解。\n\n为实现数值求解，我们定义一个函数 $f(V_m, r)$ 来表示 GHK 电流方程（除去公共正因子后）的和，并寻求其根：\n$$f(V_m, r) = \\frac{[\\mathrm{Na}]_i - [\\mathrm{Na}]_o e^{-z_{\\mathrm{Na}} V_m F / RT}}{1 - e^{-z_{\\mathrm{Na}} V_m F / RT}} + 4r \\frac{[\\mathrm{Ca}]_i - [\\mathrm{Ca}]_o e^{-z_{\\mathrm{Ca}} V_m F / RT}}{1 - e^{-z_{\\mathrm{Ca}} V_m F / RT}}$$\n参数如下：\n$T = 310\\,\\mathrm{K}$\n$R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n$F = 96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$\n$z_{\\mathrm{Na}} = +1$, $z_{\\mathrm{Ca}} = +2$\n$[\\mathrm{Na}]_o = 140\\,\\mathrm{mM}$, $[\\mathrm{Na}]_i = 12\\,\\mathrm{mM}$\n$[\\mathrm{Ca}]_o = 2\\,\\mathrm{mM}$, $[\\mathrm{Ca}]_i = 100\\,\\mathrm{nM} = 0.0001\\,\\mathrm{mM}$\n\n一个鲁棒的数值搜索需要界定根的范围。翻转电位 $E_{\\mathrm{rev}}$ 受通透离子的 Nernst 电位所界定。我们计算这些边界：\n$$E_{\\mathrm{Na}} = \\frac{RT}{z_{\\mathrm{Na}}F} \\ln\\frac{[\\mathrm{Na}]_o}{[\\mathrm{Na}]_i} = \\frac{(8.314...)(310)}{(1)(96485...)} \\ln\\frac{140}{12} \\approx +65.623\\,\\mathrm{mV}$$\n$$E_{\\mathrm{Ca}} = \\frac{RT}{z_{\\mathrm{Ca}}F} \\ln\\frac{[\\mathrm{Ca}]_o}{[\\mathrm{Ca}]_i} = \\frac{(8.314...)(310)}{(2)(96485...)} \\ln\\frac{2}{0.0001} \\approx +132.255\\,\\mathrm{mV}$$\n对于任何通透性比率 $r \\geq 0$，翻转电位 $E_{\\mathrm{rev}}$ 必须位于区间 $[E_{\\mathrm{Na}}, E_{\\mathrm{Ca}}]$ 内。这为诸如 Brent-Dekker 方法等求根算法提供了一个安全的界定范围。\n\n该算法按以下步骤进行：\n1. 定义待求解的函数 $f(V_m, r)$。\n2. 对于测试组 $\\{0, 0.01, 0.1, 1, 10, 1000\\}$ 中每个给定的 $r$ 值：\n   a. 处理 $r=0$ 的特殊情况，此时 $E_{\\mathrm{rev}} = E_{\\mathrm{Na}}$。\n   b. 对于 $r > 0$，使用区间 $[E_{\\mathrm{Na}}, E_{\\mathrm{Ca}}]$（以伏特为单位）和数值求根算法来找到根 $V_m = E_{\\mathrm{rev}}$。\n3. 将所得电位从伏特转换为毫伏，四舍五入到三位小数，并收集结果。\n\n此过程将按要求得出正确的翻转电位。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the reversal potential for a membrane permeable to Na+ and Ca2+ ions\n    using the Goldman-Hodgkin-Katz (GHK) formalism.\n    The reversal potential is found numerically by solving I_total(V_m) = 0.\n    \"\"\"\n    # Physical Constants\n    R = 8.314462618  # Gas constant in J / (mol * K)\n    T = 310.0         # Absolute temperature in Kelvin\n    F = 96485.33212   # Faraday const in Coulombs / mol\n\n    # Ionic Concentrations in mM\n    conc_Na_o = 140.0 # Extracellular Sodium\n    conc_Na_i = 12.0  # Intracellular Sodium\n    conc_Ca_o = 2.0   # Extracellular Calcium\n    conc_Ca_i = 100.0e-6 # Intracellular Calcium (100 nM = 0.0001 mM)\n\n    # Ionic Valences\n    z_Na = 1.0\n    z_Ca = 2.0\n\n    # Test suite for permeability ratio r = P_Ca / P_Na\n    r_values = [0.0, 0.01, 0.1, 1.0, 10.0, 1000.0]\n\n    # Pre-calculate the thermal voltage term in Volts\n    RT_F = R * T / F\n\n    def get_reversal_potential(r: float, bracket: tuple) -> float:\n        \"\"\"\n        Calculates the reversal potential for a given permeability ratio r.\n        \n        Args:\n            r: The permeability ratio P_Ca / P_Na.\n            bracket: A tuple (a, b) providing an interval to search for the root.\n\n        Returns:\n            The reversal potential in Volts.\n        \"\"\"\n        \n        # The function to find the root of. This represents the sum of GHK current terms.\n        # It is derived from the zero total current condition: I_Na + I_Ca = 0,\n        # after dividing out common non-zero factors.\n        def total_current_function(V_m: float) -> float:\n            if abs(V_m)  1e-12:\n                # Use L'Hopital's rule for the limit as V_m -> 0 to avoid division by zero\n                # The limit of the GHK current equation at Vm=0 is I_i = P_i * z_i * F * ( [i]_o - [i]_i )\n                # Not using this, as brentq won't hit exact zero unless it's the root.\n                # A small non-zero V_m is fine.\n                pass\n\n            # Full GHK current equation terms\n            # I_i(V_m) = P_i * (z_i^2 * F^2 * V_m / RT) * ([i]_i - [i]_o * exp(-z_i*F*V_m/RT)) / (1 - exp(-z_i*F*V_m/RT))\n            # I_Na + I_Ca = 0. We can divide by P_Na and common factors F^2*V_m/RT (for Vm!=0)\n            \n            # Simplified function for root finding (from I_Na/P_Na + I_Ca/P_Na = 0)\n            term_Na_numerator = z_Na**2 * (conc_Na_i - conc_Na_o * np.exp(-z_Na * V_m / RT_F))\n            term_Na_denominator = (1 - np.exp(-z_Na * V_m / RT_F))\n            term_Na = term_Na_numerator / term_Na_denominator\n            \n            term_Ca_numerator = z_Ca**2 * r * (conc_Ca_i - conc_Ca_o * np.exp(-z_Ca * V_m / RT_F))\n            term_Ca_denominator = (1 - np.exp(-z_Ca * V_m / RT_F))\n            term_Ca = term_Ca_numerator / term_Ca_denominator\n            \n            return term_Na + term_Ca\n\n        # The Brent-Dekker method is a robust root-finding algorithm.\n        E_rev_V = brentq(total_current_function, bracket[0], bracket[1], xtol=1e-15, rtol=1e-15)\n        return E_rev_V\n\n    # Calculate Nernst potentials to define the search bracket for the root-finder.\n    # The reversal potential must lie between these two values.\n    E_Na_V = (RT_F / z_Na) * np.log(conc_Na_o / conc_Na_i)\n    E_Ca_V = (RT_F / z_Ca) * np.log(conc_Ca_o / conc_Ca_i)\n\n    # Ensure the bracket is ordered correctly for brentq, adding a small margin for safety.\n    search_bracket = (min(E_Na_V, E_Ca_V) - 0.01, max(E_Na_V, E_Ca_V) + 0.01)\n    \n    results = []\n    for r in r_values:\n        if r == 0.0:\n            # If the membrane is only permeable to Sodium, the reversal potential\n            # is the Nernst potential for Sodium.\n            E_rev_V = E_Na_V\n        else:\n            E_rev_V = get_reversal_potential(r, search_bracket)\n\n        # Convert result from Volts to Millivolts and round to 3 decimal places.\n        E_rev_mV = E_rev_V * 1000\n        results.append(round(E_rev_mV, 3))\n    \n    # Python's default float-to-string conversion might drop trailing zeros.\n    # We format them to ensure 3 decimal places are always shown.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Expected output from running this script locally:\n# [65.623,65.811,67.424,78.204,107.828,131.905]\n# Running the function to generate the output string\n# solve()\n# For the final answer, we just provide the code as requested. The execution would yield the result.\n```", "id": "2763525"}]}