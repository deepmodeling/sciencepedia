{"hands_on_practices": [{"introduction": "本练习将带你深入电缆理论的核心，从第一性原理出发推导长度常数 $\\lambda$。通过定量比较有髓鞘与无髓鞘轴突，你将揭示髓鞘为何能显著提高被动信号传播效率的根本原因。这个实践旨在锻炼你将轴突半径和膜电阻等微观物理参数与宏观电生理功能联系起来的能力。[@problem_id:2764081]", "problem": "一个内半径为 $a$ 的长直圆柱形轴突在稳态下被建模为一个被动、均匀的一维电缆。胞内介质的比轴向电阻率为 $R_{i}$ (单位为 $\\Omega \\cdot \\mathrm{m}$）。该膜的特征是单位面积的比膜电阻。对于无髓鞘轴突，单位面积的比膜电阻为 $r_{\\mathrm{ax}}$ (单位为 $\\Omega \\cdot \\mathrm{m}^{2}$）。对于有髓鞘的结间区，轴膜 ($r_{\\mathrm{ax}}$) 被 $n(a)$ 层髓鞘板层包裹。每层髓鞘板层贡献一个单位面积的比膜电阻 $r_{\\ell}$ (单位为 $\\Omega \\cdot \\mathrm{m}^{2}$)，且这些板层在径向上作为串联电阻叠加。包裹层数根据一个恒定的g比随轴突尺寸变化：如果 $g$ 是轴突内半径与神经纤维外半径之比，$d_{\\ell}$ 是髓鞘的周期性（单位为 $\\mathrm{m}$），那么髓鞘厚度为 $a\\left(\\frac{1}{g}-1\\right)$ 且\n$$\nn(a) \\;=\\; \\frac{a\\left(\\frac{1}{g}-1\\right)}{d_{\\ell}}.\n$$\n假设在稳态下电容电流可忽略不计，且外部介质是等势的。单位长度的膜电阻是单位长度的膜电导的倒数，而单位长度的轴向电阻是胞内电阻率除以横截面积。\n\n1) 从应用于无限小电缆段的基尔霍夫电流定律和稳态一维电缆方程出发，用单位长度的膜电阻和单位长度的轴向电阻表示沿电缆电压衰减的长度常数 $\\lambda$。据此，推导在以下情况下 $\\lambda$ 随 $a$ 变化的标度关系：\n- 对于无髓鞘轴突，用 $r_{\\mathrm{ax}}$ 和 $R_{i}$ 表示，\n- 对于有髓鞘的结间区，用 $r_{\\mathrm{ax}}$、 $r_{\\ell}$、 $g$、 $d_{\\ell}$ 和 $R_{i}$ 表示。\n\n明确说明在每种情况下，当 $a$ 加倍时 $\\lambda$ 如何变化。\n\n2) 使用参数值\n$$\nR_{i} = 0.70 \\;\\Omega \\cdot \\mathrm{m},\\quad r_{\\mathrm{ax}} = 0.50 \\;\\Omega \\cdot \\mathrm{m}^{2},\\quad r_{\\ell} = 1.00 \\;\\Omega \\cdot \\mathrm{m}^{2},\\\\\ng = 0.90,\\quad d_{\\ell} = 2.00 \\times 10^{-8} \\;\\mathrm{m},\n$$\n确定当 $a$ 加倍导致有髓鞘结间区长度常数 $\\lambda$ 增加 $0.95$ (即 $\\lambda(2a) = (1+0.95)\\,\\lambda(a)$）时，对应的轴突内径。将最终数值答案以微米为单位表示，并四舍五入到三位有效数字。", "solution": "该问题是有效的，因为它在科学上基于标准的一维电缆理论，是一个目标明确的适定问题，并包含一套完整且一致的数据和定义。\n\n稳态下被动电缆理论的基础是一维电缆方程。我们通过将基尔霍夫电流定律应用于长度为 $dx$ 的无限小轴突段来推导该方程。在轴突内部流动的轴向电流是 $I_i(x)$。沿该段电流的变化量 $dI_i$ 必须等于通过膜漏出的电流 $i_m dx$，其中 $i_m$ 是单位长度的膜电流。这给出了关系式 $-\\frac{dI_i}{dx} = i_m$。\n根据欧姆定律，轴向电流本身是由沿轴突内部电阻的电压梯度驱动的：$\\frac{dV}{dx} = -I_i r_i$，其中 $r_i$ 是单位长度的轴向电阻。对此表达式求导得出 $\\frac{d^2V}{dx^2} = -r_i \\frac{dI_i}{dx}$。代入基尔霍夫定律的表达式，我们得到 $\\frac{d^2V}{dx^2} = r_i i_m$。\n对于稳态下的被动膜，单位长度的膜电流与膜电压 $V$（相对于外部等势面）成正比，比例常数为单位长度的膜电阻 $r_m$：$V = i_m r_m$。因此，$i_m = \\frac{V}{r_m}$。\n将此代入我们的微分方程，得到稳态电缆方程：\n$$ \\frac{d^2V}{dx^2} = \\frac{r_i}{r_m} V $$\n该方程通常写成 $\\lambda^2 \\frac{d^2V}{dx^2} - V = 0$ 的形式，由此定义长度常数 $\\lambda$ 为：\n$$ \\lambda = \\sqrt{\\frac{r_m}{r_i}} $$\n这就是所要求的用单位长度的膜电阻 ($r_m$) 和单位长度的轴向电阻 ($r_i$) 表示的长度常数表达式。\n\n我们现在通过首先用微观参数表示 $r_i$ 和 $r_m$，来推导在两种指定情况下 $\\lambda$ 随内半径 $a$ 变化的标度关系。\n单位长度的轴向电阻 $r_i$ 是比胞内电阻率 $R_i$ 除以轴突的横截面积 $A = \\pi a^2$。\n$$ r_i = \\frac{R_i}{A} = \\frac{R_i}{\\pi a^2} $$\n单位长度的膜电阻 $r_m$ 是单位面积的比膜电阻 $R_m$ 除以轴突的周长 $C = 2\\pi a$。\n$$ r_m = \\frac{R_m}{C} = \\frac{R_m}{2\\pi a} $$\n\n**第1部分：无髓鞘轴突**\n对于无髓鞘轴突，单位面积的比膜电阻就是 $R_m = r_{\\mathrm{ax}}$。\n我们将 $r_i$ 和 $r_m$ 的表达式代入 $\\lambda$ 的方程中：\n$$ \\lambda_{\\text{unmyelinated}} = \\sqrt{\\frac{r_m}{r_i}} = \\sqrt{\\frac{r_{\\mathrm{ax}}/(2\\pi a)}{R_i/(\\pi a^2)}} = \\sqrt{\\frac{r_{\\mathrm{ax}}}{2\\pi a} \\cdot \\frac{\\pi a^2}{R_i}} = \\sqrt{\\frac{r_{\\mathrm{ax}} a}{2 R_i}} $$\n从此表达式可知，长度常数随半径的标度关系为 $\\lambda \\propto \\sqrt{a}$。\n如果半径 $a$ 加倍到 $2a$，新的长度常数 $\\lambda'$ 变为 $\\lambda'(2a) = \\sqrt{\\frac{r_{\\mathrm{ax}} (2a)}{2 R_i}} = \\sqrt{2} \\cdot \\sqrt{\\frac{r_{\\mathrm{ax}} a}{2 R_i}} = \\sqrt{2} \\lambda(a)$。因此，半径加倍会使长度常数增加 $\\sqrt{2}$ 倍。\n\n**第1部分：有髓鞘的结间区**\n对于有髓鞘的结间区，总的单位面积比膜电阻 $R_m$是轴膜电阻和髓鞘电阻之和，因为它们是串联的。髓鞘由 $n(a)$ 层板层组成，每层的比电阻为 $r_{\\ell}$。\n$$ R_m = r_{\\mathrm{ax}} + n(a) r_{\\ell} $$\n代入给定的 $n(a)$ 表达式：\n$$ R_m = r_{\\mathrm{ax}} + \\left(\\frac{a\\left(\\frac{1}{g}-1\\right)}{d_{\\ell}}\\right) r_{\\ell} = r_{\\mathrm{ax}} + \\frac{a(1-g)r_{\\ell}}{g d_{\\ell}} $$\n那么单位长度的膜电阻为：\n$$ r_m = \\frac{R_m}{2\\pi a} = \\frac{1}{2\\pi a} \\left( r_{\\mathrm{ax}} + \\frac{a(1-g)r_{\\ell}}{g d_{\\ell}} \\right) = \\frac{r_{\\mathrm{ax}}}{2\\pi a} + \\frac{(1-g)r_{\\ell}}{2\\pi g d_{\\ell}} $$\n单位长度的轴向电阻 $r_i$ 仍然是 $\\frac{R_i}{\\pi a^2}$。\n有髓鞘结间区的长度常数为：\n$$ \\lambda_{\\text{myelinated}} = \\sqrt{\\frac{r_m}{r_i}} = \\sqrt{ \\left( \\frac{r_{\\mathrm{ax}}}{2\\pi a} + \\frac{(1-g)r_{\\ell}}{2\\pi g d_{\\ell}} \\right) \\cdot \\frac{\\pi a^2}{R_i} } = \\sqrt{\\frac{a^2}{2R_i} \\left( \\frac{r_{\\mathrm{ax}}}{a} + \\frac{(1-g)r_{\\ell}}{g d_{\\ell}} \\right) } $$\n$$ \\lambda_{\\text{myelinated}}(a) = \\sqrt{\\frac{r_{\\mathrm{ax}} a}{2R_i} + \\frac{(1-g)r_{\\ell} a^2}{2R_i g d_{\\ell}}} $$\n$\\lambda$ 随 $a$ 变化的标度关系形式为 $\\sqrt{C_1 a + C_2 a^2}$。当 $a$ 加倍时，新的长度常数为 $\\lambda(2a) = \\sqrt{C_1 (2a) + C_2 (2a)^2} = \\sqrt{2 C_1 a + 4 C_2 a^2}$。增加的因子 $\\frac{\\lambda(2a)}{\\lambda(a)} = \\sqrt{\\frac{2C_1a + 4C_2a^2}{C_1a+C_2a^2}} = \\sqrt{\\frac{2(C_1+2C_2a)}{C_1+C_2a}}$ 不是一个常数，而是取决于 $a$。它的界限在 $\\sqrt{2}$ (对于非常小的 $a$) 和 $\\sqrt{4} = 2$ (对于非常大的 $a$) 之间。\n\n**第2部分：数值计算**\n我们给定的条件是 $\\lambda(2a) = (1+0.95)\\lambda(a) = 1.95\\lambda(a)$。这等价于 $\\frac{\\lambda(2a)}{\\lambda(a)} = 1.95$。两边平方，我们得到：\n$$ \\frac{\\lambda^2(2a)}{\\lambda^2(a)} = (1.95)^2 = 3.8025 $$\n使用 $\\lambda_{\\text{myelinated}}^2(a) = \\frac{r_{\\mathrm{ax}} a}{2R_i} + \\frac{(1-g)r_{\\ell} a^2}{2R_i g d_{\\ell}}$ 的表达式，我们可以写出：\n$$ \\frac{\\frac{r_{\\mathrm{ax}} (2a)}{2R_i} + \\frac{(1-g)r_{\\ell} (2a)^2}{2R_i g d_{\\ell}}}{\\frac{r_{\\mathrm{ax}} a}{2R_i} + \\frac{(1-g)r_{\\ell} a^2}{2R_i g d_{\\ell}}} = 3.8025 $$\n项 $\\frac{1}{2R_i}$ 和因子 $a$ 从分子和分母中约去：\n$$ \\frac{2 r_{\\mathrm{ax}} + 4 a \\frac{(1-g)r_{\\ell}}{g d_{\\ell}}}{r_{\\mathrm{ax}} + a \\frac{(1-g)r_{\\ell}}{g d_{\\ell}}} = 3.8025 $$\n我们定义 $C = \\frac{(1-g)r_{\\ell}}{g d_{\\ell}}$ 来简化代数运算。\n$$ \\frac{2 r_{\\mathrm{ax}} + 4 C a}{r_{\\mathrm{ax}} + C a} = 3.8025 $$\n$$ 2 r_{\\mathrm{ax}} + 4 C a = 3.8025 (r_{\\mathrm{ax}} + C a) = 3.8025 r_{\\mathrm{ax}} + 3.8025 C a $$\n$$ (4 - 3.8025) C a = (3.8025 - 2) r_{\\mathrm{ax}} $$\n$$ 0.1975 C a = 1.8025 r_{\\mathrm{ax}} $$\n$$ a = \\frac{1.8025}{0.1975} \\frac{r_{\\mathrm{ax}}}{C} = \\frac{1.8025}{0.1975} \\frac{r_{\\mathrm{ax}} g d_{\\ell}}{(1-g)r_{\\ell}} $$\n现在，我们代入给定的参数值：$r_{\\mathrm{ax}} = 0.50 \\;\\Omega \\cdot \\mathrm{m}^{2}$，$r_{\\ell} = 1.00 \\;\\Omega \\cdot \\mathrm{m}^{2}$，$g = 0.90$，以及 $d_{\\ell} = 2.00 \\times 10^{-8} \\;\\mathrm{m}$。\n$$ a = \\left(\\frac{1.8025}{0.1975}\\right) \\frac{(0.50)(0.90)(2.00 \\times 10^{-8})}{(1-0.90)(1.00)} $$\n$$ a = (9.12658\\dots) \\frac{0.90 \\times 10^{-8}}{0.10} = (9.12658\\dots) (9.0 \\times 10^{-8}) \\;\\mathrm{m} $$\n$$ a \\approx 8.2139 \\times 10^{-7} \\;\\mathrm{m} $$\n问题要求的是轴突内径，即 $D = 2a$。\n$$ D = 2 \\times 8.2139 \\times 10^{-7} \\;\\mathrm{m} = 1.64278 \\times 10^{-6} \\;\\mathrm{m} $$\n为了以微米表示，我们使用换算关系 $1 \\;\\mu\\mathrm{m} = 10^{-6} \\;\\mathrm{m}$。\n$$ D \\approx 1.64278 \\;\\mu\\mathrm{m} $$\n四舍五入到三位有效数字，我们得到 $1.64 \\;\\mu\\mathrm{m}$。", "answer": "$$\n\\boxed{1.64}\n$$", "id": "2764081"}, {"introduction": "虽然长度常数 $\\lambda$ 是在无限长电缆的假设下定义的，但真实的树突和轴突都是有限的。本练习旨在探索神经突的物理末端——即边界条件——如何影响其电学特性，特别是输入电阻 $R_{\\text{in}}$。通过分析“密封端”和“短路端”这两种极端情况，你将深入理解神经元的局部结构如何决定其对突触输入的响应。[@problem_id:2764083]", "problem": "一段物理长度为 $\\ell$ 的直的、无源的、无分支的树突电缆，其在稳态（直流，DC）电生理学条件下可用一维空间模型来描述。设 $r_{i}$ 表示单位长度的轴向电阻（单位为 $\\Omega\\,\\text{m}^{-1}$），$r_{m}$ 表示单位长度的膜电阻（单位为 $\\Omega\\,\\text{m}$）。单位长度的膜电流为 $i_{m}(x)=V(x)/r_{m}$，轴向电流满足欧姆定律 $dV/dx=-r_{i} i_{i}(x)$。在稳态下，电流守恒意味着 $di_{i}/dx + i_{m} = 0$。长度常数定义为 $\\lambda=\\sqrt{r_{m}/r_{i}}$。\n\n在电缆的近端 $x=0$ 处注入一个恒定的直流电流 $I$。位于 $x=\\ell$ 的远端以下列两种方式之一端接：\n- 密封端：没有轴向电流流出，因此 $i_{i}(\\ell)=0$。\n- 短路端：远端电位被钳制在参考电位上，因此 $V(\\ell)=0$。\n\n仅从上述陈述和 $\\lambda$ 的定义出发，推导每种端接方式下直流输入电阻 $R_{\\text{in}}=\\frac{V(0)}{I}$ 的表达式。然后，使用这些表达式，确定使得两种输入电阻差异小于 $5\\%$ 的最小无量纲长度 $\\ell/\\lambda$，其中以密封端输入电阻作为计算百分比差异的参考。将你的最终答案表示为一个无量纲数，并四舍五入到四位有效数字。不要包含单位。", "solution": "本题要求推导在两种不同边界条件下无源树突电缆的输入电阻，然后找出使这两种电阻值在指定公差范围内的最小电缆长度。整个分析将基于所提供的稳态电缆方程。\n\n首先，我们必须推导膜电位 $V(x)$ 的控制微分方程。题目给出了以下关系：\n1.  电流守恒：$\\frac{di_{i}}{dx} + i_{m} = 0$，可以写成 $\\frac{di_{i}}{dx} = -i_{m}(x)$。\n2.  膜电流：$i_{m}(x) = \\frac{V(x)}{r_{m}}$。\n3.  轴向电流（欧姆定律）：$\\frac{dV}{dx} = -r_{i} i_{i}(x)$。\n\n我们将第三个方程对 $x$ 求导：\n$$ \\frac{d^2V}{dx^2} = -r_{i} \\frac{di_{i}}{dx} $$\n将第一个方程代入此结果，得到：\n$$ \\frac{d^2V}{dx^2} = -r_{i} (-i_{m}(x)) = r_{i} i_{m}(x) $$\n现在，代入第二个方程中的 $i_{m}(x)$：\n$$ \\frac{d^2V}{dx^2} = r_{i} \\frac{V(x)}{r_{m}} = \\frac{r_{i}}{r_{m}} V(x) $$\n题目定义了长度常数 $\\lambda = \\sqrt{r_{m}/r_{i}}$。因此，$\\frac{r_{i}}{r_{m}} = \\frac{1}{\\lambda^2}$。沿电缆的稳态电压的控制方程是一维亥姆霍兹方程，通常称为稳态电缆方程：\n$$ \\frac{d^2V}{dx^2} - \\frac{1}{\\lambda^2} V(x) = 0 $$\n这是一个二阶线性齐次常微分方程。其通解可以用双曲函数表示，这对于有限长度的电缆很方便：\n$$ V(x) = A \\cosh\\left(\\frac{x}{\\lambda}\\right) + B \\sinh\\left(\\frac{x}{\\lambda}\\right) $$\n其中 $A$ 和 $B$ 是由边界条件确定的常数。\n\n轴向电流 $i_i(x)$ 通过对 $V(x)$ 求导得到：\n$$ i_{i}(x) = -\\frac{1}{r_{i}} \\frac{dV}{dx} = -\\frac{1}{r_{i}\\lambda} \\left[ A \\sinh\\left(\\frac{x}{\\lambda}\\right) + B \\cosh\\left(\\frac{x}{\\lambda}\\right) \\right] $$\n在近端（$x=0$），注入电流 $I$。该电流必须作为轴向电流流入电缆，因此 $i_{i}(0) = I$。\n$$ I = i_{i}(0) = -\\frac{1}{r_{i}\\lambda} \\left[ A \\sinh(0) + B \\cosh(0) \\right] = -\\frac{B}{r_{i}\\lambda} $$\n这给出了其中一个常数：$B = -I r_{i} \\lambda$。另一个常数 $A$ 由远端（$x=\\ell$）的条件确定。\n\n情况1：密封端\n边界条件是无轴向电流流出，$i_{i}(\\ell)=0$。\n$$ 0 = i_{i}(\\ell) = -\\frac{1}{r_{i}\\lambda} \\left[ A \\sinh\\left(\\frac{\\ell}{\\lambda}\\right) + B \\cosh\\left(\\frac{\\ell}{\\lambda}\\right) \\right] $$\n$$ A \\sinh\\left(\\frac{\\ell}{\\lambda}\\right) = -B \\cosh\\left(\\frac{\\ell}{\\lambda}\\right) \\implies A = -B \\coth\\left(\\frac{\\ell}{\\lambda}\\right) $$\n代入 $B = -I r_{i} \\lambda$，我们得到 $A = I r_{i} \\lambda \\coth(\\ell/\\lambda)$。\n输入端的电压为 $V(0) = A \\cosh(0) + B \\sinh(0) = A$。\n密封端情况下的输入电阻 $R_{\\text{in, sealed}}$ 为：\n$$ R_{\\text{in, sealed}} = \\frac{V(0)}{I} = \\frac{A}{I} = \\frac{I r_{i} \\lambda \\coth(\\ell/\\lambda)}{I} = r_{i} \\lambda \\coth\\left(\\frac{\\ell}{\\lambda}\\right) $$\n\n情况2：短路端\n边界条件是电压为零，$V(\\ell)=0$。\n$$ 0 = V(\\ell) = A \\cosh\\left(\\frac{\\ell}{\\lambda}\\right) + B \\sinh\\left(\\frac{\\ell}{\\lambda}\\right) $$\n$$ A \\cosh\\left(\\frac{\\ell}{\\lambda}\\right) = -B \\sinh\\left(\\frac{\\ell}{\\lambda}\\right) \\implies A = -B \\tanh\\left(\\frac{\\ell}{\\lambda}\\right) $$\n代入 $B = -I r_{i} \\lambda$，我们得到 $A = I r_{i} \\lambda \\tanh(\\ell/\\lambda)$。\n输入端的电压为 $V(0) = A$。\n短路端情况下的输入电阻 $R_{\\text{in, short}}$ 为：\n$$ R_{\\text{in, short}} = \\frac{V(0)}{I} = \\frac{A}{I} = \\frac{I r_{i} \\lambda \\tanh(\\ell/\\lambda)}{I} = r_{i} \\lambda \\tanh\\left(\\frac{\\ell}{\\lambda}\\right) $$\n\n现在我们必须找到最小的无量纲长度 $L = \\ell/\\lambda$，使得两种输入电阻的差异小于 $5\\%$，并以 $R_{\\text{in, sealed}}$ 作为参考。条件是：\n$$ \\frac{|R_{\\text{in, sealed}} - R_{\\text{in, short}}|}{R_{\\text{in, sealed}}} < 0.05 $$\n对于任意正长度 $\\ell/\\lambda > 0$，我们有 $\\coth(\\ell/\\lambda) > 1$ 且 $0 < \\tanh(\\ell/\\lambda) < 1$，因此 $R_{\\text{in, sealed}} > R_{\\text{in, short}}$。绝对值是多余的。\n$$ 1 - \\frac{R_{\\text{in, short}}}{R_{\\text{in, sealed}}} < 0.05 $$\n代入电阻的表达式：\n$$ 1 - \\frac{r_{i} \\lambda \\tanh(\\ell/\\lambda)}{r_{i} \\lambda \\coth(\\ell/\\lambda)} < 0.05 $$\n设 $L = \\ell/\\lambda$。由于 $\\coth(L) = 1/\\tanh(L)$，表达式简化为：\n$$ 1 - \\tanh^2(L) < 0.05 $$\n整理不等式可得：\n$$ \\tanh^2(L) > 0.95 $$\n因为 $L > 0$，$\\tanh(L)$ 为正，所以我们可以对两边取平方根：\n$$ \\tanh(L) > \\sqrt{0.95} $$\n函数 $\\tanh(L)$ 在 $L > 0$ 时是单调递增的。对于所有大于等式成立时的 $L$ 值，该条件都满足。题目要求的是“最小的无量纲长度”，这对应于这个边界值。\n$$ L = \\arctanh\\left(\\sqrt{0.95}\\right) $$\n使用反双曲正切的对数定义，$\\arctanh(z) = \\frac{1}{2}\\ln\\left(\\frac{1+z}{1-z}\\right)$：\n$$ L = \\frac{1}{2}\\ln\\left(\\frac{1+\\sqrt{0.95}}{1-\\sqrt{0.95}}\\right) $$\n为了计算数值，我们计算对数的自变量。对分数进行有理化：\n$$ \\frac{1+\\sqrt{0.95}}{1-\\sqrt{0.95}} = \\frac{(1+\\sqrt{0.95})(1+\\sqrt{0.95})}{(1-\\sqrt{0.95})(1+\\sqrt{0.95})} = \\frac{1 + 2\\sqrt{0.95} + 0.95}{1 - 0.95} = \\frac{1.95 + 2\\sqrt{0.95}}{0.05} = 39 + 40\\sqrt{0.95} $$\n所以 $L$ 的表达式为：\n$$ L = \\frac{1}{2}\\ln\\left(39 + 40\\sqrt{0.95}\\right) $$\n现在我们计算其值：\n$$ \\sqrt{0.95} \\approx 0.97467943 $$\n$$ L \\approx \\frac{1}{2}\\ln\\left(39 + 40 \\times 0.97467943\\right) = \\frac{1}{2}\\ln\\left(39 + 38.9871772\\right) = \\frac{1}{2}\\ln(77.9871772) $$\n$$ L \\approx \\frac{1}{2} \\times 4.356550 \\approx 2.178275 $$\n四舍五入到四位有效数字，我们得到 $L = 2.178$。", "answer": "$$\\boxed{2.178}$$", "id": "2764083"}, {"introduction": "这项实践旨在连接解析理论与计算神经科学，这是现代研究中的一项关键技能。你将亲手实现一个“房室模型”（compartmental model）——一种模拟复杂神经元的核心技术——以数值方式求解输入电阻。通过将你的数值结果与之前推导的解析解进行比对验证，你不仅能建立编程的信心，还能更深刻地理解连续的生物物理过程是如何在计算机中被近似模拟的。[@problem_id:2764063]", "problem": "给定一个均一、被动的一维圆柱形神经突，其在直流（DC）稳态下可由电缆理论描述。该电缆的半径为 $a$（单位：$\\mathrm{m}$），比膜电阻为 $R_m$（单位：$\\Omega\\cdot\\mathrm{m}^2$），比轴向电阻率为 $R_a$（单位：$\\Omega\\cdot\\mathrm{m}$），长度为 $L$（单位：$\\mathrm{m}$）。在近端 $x=0$ 处注入恒定电流 $I$（单位：$\\mathrm{A}$），输入电阻 $R_{\\mathrm{in}}$ 定义为 $R_{\\mathrm{in}} = V(0)/I$，其中 $V(0)$ 是 $x=0$ 处相对于远处接地的稳态电位。\n\n您的任务是：\n- 从第一性原理出发，以单位长度的膜电阻和轴向电阻的定义以及直流电缆方程为起点，推导：\n  1. 用 $R_m$、$R_a$ 和 $a$ 表示的长度常数 $\\lambda$。\n  2. 在 $x=L$ 处两种不同远端边界条件下，$x=0$ 处输入电阻 $R_{\\mathrm{in}}$ 的解析表达式：\n     - 封口端（在 $x=L$ 处无轴向电流）。\n     - 短路端（在 $x=L$ 处电位钳制为零）。\n- 独立地，使用基尔霍夫电流定律（KCL）实现一个数值房室模型，通过均匀离散化来近似相同的稳态解。在房室系统中强制施加两种远端边界条件，并对每种情况数值计算 $R_{\\mathrm{in}}$。通过报告相对误差，将数值计算的 $R_{\\mathrm{in}}$ 与推导的解析表达式进行比较。\n\n建模与实现要求：\n- 使用以下单位长度电阻的定义：\n  - 单位长度轴向电阻 $r_a = \\dfrac{R_a}{\\pi a^2}$（单位：$\\Omega/\\mathrm{m}$）。\n  - 单位长度膜电阻 $r_m = \\dfrac{R_m}{2\\pi a}$（单位：$\\Omega\\cdot\\mathrm{m}$）。\n- 将电缆离散为 $N$ 个节点，节点间距均匀为 $\\Delta x$，使得 $(N-1)\\Delta x = L$。对于每个内部节点 $i$，关联一个膜电导 $g_m = \\Delta x / r_m$；对于每个末端节点，关联一个半膜电导 $g_m^{\\mathrm{end}} = (\\Delta x/2)/r_m$。对于相邻节点之间的每个连接，使用轴向电导 $g_a = 1/(r_a \\Delta x)$。在每个节点应用 KCL，以获得关于节点电压的三对角线性系统。在 $x=0$ 处，向节点0注入电流 $I$。对于 $x=L$ 处的远端边界，实现：\n  - 封口：最后一个节点之外没有轴向电流（最后一个节点只有一个轴向邻居）。\n  - 短路：施加 $V(L)=0$（在最后一个节点施加狄利克雷条件）。\n- 为了保证跨案例的数值准确性和可复现性，按如下方式使用推导出的 $\\lambda$ 选择空间步长：设置 $\\Delta x = \\lambda/800$ 和 $N = \\lceil L/\\Delta x \\rceil + 1$，然后重置 $\\Delta x = L/(N-1)$ 以精确覆盖整个电缆。这要求您从第一性原理计算 $\\lambda$（在推导中不要假设或使用任何预先给出的简化公式）。\n- 使用 $I = 1.0$（单位：$\\mathrm{A}$）。虽然中间量带有物理单位，但您最终报告的量是相对误差，无量纲。\n- 测试套件（参数在科学上是合理且一致的）：\n  - 所有测试的通用参数：$a = 1.0\\times 10^{-6}\\ \\mathrm{m}$，$R_m = 1.0\\ \\Omega\\cdot\\mathrm{m}^2$，$R_a = 1.0\\ \\Omega\\cdot\\mathrm{m}$，$I = 1.0\\ \\mathrm{A}$。\n  - 相对于 $\\lambda$ 指定的三种电缆长度：$L \\in \\{0.1\\lambda,\\ \\lambda,\\ 4\\lambda\\}$。\n  - 对每个 $L$，评估两种边界条件（封口和短路），并报告数值计算的 $R_{\\mathrm{in}}$ 与您从第一性原理推导的解析 $R_{\\mathrm{in}}$ 之间的相对误差。\n- 输出规格：\n  - 您的程序应生成单行输出，其中包含六个相对误差，格式为方括号内逗号分隔的列表，顺序如下：\n    - $[ \\mathrm{err}_{\\mathrm{sealed}}(0.1\\lambda),\\ \\mathrm{err}_{\\mathrm{shorted}}(0.1\\lambda),\\ \\mathrm{err}_{\\mathrm{sealed}}(\\lambda),\\ \\mathrm{err}_{\\mathrm{shorted}}(\\lambda),\\ \\mathrm{err}_{\\mathrm{sealed}}(4\\lambda),\\ \\mathrm{err}_{\\mathrm{shorted}}(4\\lambda) ]$。\n  - 每个值必须以科学计数法浮点数形式打印，小数点后保留六位数字（例如，$1.234567\\mathrm{e}{-04}$）。\n  - 这些是无量纲量（没有单位）。\n\n交付成果：\n- 一个完整、可运行的程序，该程序：\n  1. 仅使用基本定义，根据给定的物理参数计算 $\\lambda$。\n  2. 按照规定，构建并求解实现了封口和短路远端边界条件的三对角系统。\n  3. 从第一性原理计算两种边界条件下的解析 $R_{\\mathrm{in}}$。\n  4. 按照指定的顺序和格式，生成包含六个相对误差的单行输出。", "solution": "对所提出的问题进行了严格的验证。\n\n### 步骤1：提取已知条件\n- **物理参数**：圆柱形神经突半径 $a$（$\\mathrm{m}$），比膜电阻 $R_m$（$\\Omega\\cdot\\mathrm{m}^2$），比轴向电阻率 $R_a$（$\\Omega\\cdot\\mathrm{m}$），电缆长度 $L$（$\\mathrm{m}$）。\n- **电学条件**：在 $x=0$ 处注入恒定电流 $I$（$\\mathrm{A}$）。\n- **定义**：\n  - 输入电阻：$R_{\\mathrm{in}} = V(0)/I$，其中 $V(0)$ 是 $x=0$ 处的稳态电位。\n  - 单位长度轴向电阻：$r_a = \\dfrac{R_a}{\\pi a^2}$（$\\Omega/\\mathrm{m}$）。\n  - 单位长度膜电阻：$r_m = \\dfrac{R_m}{2\\pi a}$（$\\Omega\\cdot\\mathrm{m}$）。\n- **边界条件（解析）**：\n  - $x=L$ 处为封口端：无轴向电流，意味着 $\\frac{dV}{dx}|_{x=L}=0$。\n  - $x=L$ 处为短路端：电位钳制为零，$V(L)=0$。\n- **数值离散化**：\n  - $N$ 个节点，间距均匀为 $\\Delta x$，使得 $(N-1)\\Delta x = L$。\n  - 内部节点（$i$）膜电导：$g_m = \\Delta x / r_m$。\n  - 末端节点膜电导：$g_m^{\\mathrm{end}} = (\\Delta x/2)/r_m$。\n  - 相邻节点间的轴向电导：$g_a = 1/(r_a \\Delta x)$。\n  - 电流 $I$ 在节点 0 处注入。\n- **数值空间步长规则**：\n  1. 从第一性原理计算 $\\lambda$。\n  2. 设置初始步长 $\\Delta x = \\lambda/800$。\n  3. 设置节点数 $N = \\lceil L/\\Delta x \\rceil + 1$。\n  4. 重新定义最终步长 $\\Delta x = L/(N-1)$。\n- **测试用例参数**：\n  - $a = 1.0\\times 10^{-6}\\ \\mathrm{m}$\n  - $R_m = 1.0\\ \\Omega\\cdot\\mathrm{m}^2$\n  - $R_a = 1.0\\ \\Omega\\cdot\\mathrm{m}$\n  - $I = 1.0\\ \\mathrm{A}$\n  - $L$ 被指定为 $\\{0.1\\lambda,\\ \\lambda,\\ 4\\lambda\\}$。\n\n### 步骤2：使用提取的已知条件进行验证\n对问题的有效性进行评估。\n- **科学依据**：该问题是电缆理论的经典应用，是定量细胞电生理学的基石。所有概念、定义和方程都是标准的，并源于电学基本原理（欧姆定律、Kirchhoff电流定律）。这是一个教科书式的问题，而非推测。\n- **适定性**：该问题是适定的。解析部分涉及求解一个带有明确边界条件的二阶线性常微分方程，这保证了唯一解的存在。数值部分涉及求解一个线性代数方程组，该方程组非奇异，因此也存在唯一解。\n- **客观性**：问题以精确、客观和定量的语言陈述，没有任何主观或模棱两可的术语。\n- **完整性**：所有必需的参数、定义和模型规范都已明确提供。数值方法（房室建模）也进行了详细说明，包括电导的离散化和边界节点的处理。\n- **一致性**：定义和要求在内部是一致的。明确要求从第一性原理进行推导，防止依赖未经声明的假设。数值方案是连续模型的一个已知的、稳健的有限差分近似。\n\n### 步骤3：结论与行动\n该问题是**有效的**。它是计算神经科学中一个标准的、适定的问题，正确地结合了解析推导、数值实现和验证。将提供一个解决方案。\n\n### 解析推导\n\n**1. 长度常数 $\\lambda$**\n\n我们从第一性原理开始。考虑一段长度为 $dx$ 的电缆微元。沿该段的轴向电流变化量 $di_a$ 必须等于通过膜漏出的电流 $i_m dx$，其中 $i_m$ 是单位长度的膜电流。根据稳态下的电荷守恒：\n$$\n-di_a= i_m dx\n$$\n轴向电流 $i_a(x)$ 和膜电流 $i_m(x)$ 由欧姆定律给出：\n$$\ni_a(x) = -\\frac{1}{r_a} \\frac{dV(x)}{dx}\n$$\n$$\ni_m(x) = \\frac{V(x)}{r_m}\n$$\n其中 $V(x)$ 是位置 $x$ 处的电压。对轴向电流求关于 $x$ 的导数：\n$$\n\\frac{di_a}{dx} = -\\frac{1}{r_a} \\frac{d^2V(x)}{dx^2}\n$$\n将这些代入电荷守恒定律 $-di_a/dx = i_m$ 中：\n$$\n\\frac{1}{r_a} \\frac{d^2V(x)}{dx^2} = \\frac{V(x)}{r_m} \\implies \\frac{d^2V}{dx^2} - \\frac{r_a}{r_m} V = 0\n$$\n标准的直流电缆方程写作 $\\lambda^2 \\frac{d^2V}{dx^2} - V = 0$。通过比较，长度常数 $\\lambda$ 定义为：\n$$\n\\lambda^2 = \\frac{r_m}{r_a} \\implies \\lambda = \\sqrt{\\frac{r_m}{r_a}}\n$$\n使用所提供的 $r_m$ 和 $r_a$ 以基本参数表示的定义：\n$$\nr_m = \\frac{R_m}{2\\pi a} \\quad \\text{and} \\quad r_a = \\frac{R_a}{\\pi a^2}\n$$\n将这些代入 $\\lambda$ 的表达式中：\n$$\n\\lambda = \\sqrt{\\frac{R_m / (2\\pi a)}{R_a / (\\pi a^2)}} = \\sqrt{\\frac{R_m}{2\\pi a} \\cdot \\frac{\\pi a^2}{R_a}} = \\sqrt{\\frac{R_m a}{2 R_a}}\n$$\n这就是所要求的长度常数 $\\lambda$ 的推导过程。\n\n**2. 输入电阻 $R_{\\mathrm{in}}$**\n\n电缆方程 $\\lambda^2 V'' - V = 0$ 的通解是：\n$$\nV(x) = A e^{x/\\lambda} + B e^{-x/\\lambda}\n$$\n在 $x=L$ 处施加边界条件时，使用以远端为中心的双曲函数形式更为方便。令 $y = L-x$。通解为 $V(x) = C \\cosh((L-x)/\\lambda) + D \\sinh((L-x)/\\lambda)$。则轴向电流为：\n$$\ni_a(x) = -\\frac{1}{r_a}\\frac{dV}{dx} = -\\frac{1}{r_a} \\left( -\\frac{C}{\\lambda}\\sinh\\frac{L-x}{\\lambda} - \\frac{D}{\\lambda}\\cosh\\frac{L-x}{\\lambda} \\right) = \\frac{1}{r_a\\lambda} \\left( C\\sinh\\frac{L-x}{\\lambda} + D\\cosh\\frac{L-x}{\\lambda} \\right)\n$$\n在近端 ($x=0$)，注入电流 $I$：$I = i_a(0)$。输入电阻为 $R_{\\mathrm{in}} = V(0)/I$。\n\n**情况1：封口端**\n$x=L$ 处的边界条件是无轴向电流：$i_a(L) = 0$。\n$$\ni_a(L) = \\frac{1}{r_a\\lambda} \\left( C\\sinh(0) + D\\cosh(0) \\right) = \\frac{D}{r_a\\lambda} = 0 \\implies D=0\n$$\n解简化为 $V(x) = C \\cosh((L-x)/\\lambda)$。在 $x=0$ 处：\n$$\nV(0) = C\\cosh(L/\\lambda)\n$$\n$$\nI = i_a(0) = \\frac{1}{r_a\\lambda} \\left( C\\sinh(L/\\lambda) \\right)\n$$\n输入电阻为：\n$$\nR_{\\mathrm{in, sealed}} = \\frac{V(0)}{I} = \\frac{C\\cosh(L/\\lambda)}{C\\sinh(L/\\lambda) / (r_a\\lambda)} = r_a\\lambda \\coth(L/\\lambda)\n$$\n代入 $\\lambda = \\sqrt{r_m/r_a}$，我们得到 $R_{\\mathrm{in, sealed}} = r_a\\sqrt{r_m/r_a} \\coth(L/\\lambda) = \\sqrt{r_m r_a} \\coth(L/\\lambda)$。$\\sqrt{r_m r_a}$ 是特性阻抗 $Z_c$。\n\n**情况2：短路端**\n$x=L$ 处的边界条件为 $V(L) = 0$。\n$$\nV(L) = C\\cosh(0) + D\\sinh(0) = C = 0\n$$\n解简化为 $V(x) = D \\sinh((L-x)/\\lambda)$。在 $x=0$ 处：\n$$\nV(0) = D\\sinh(L/\\lambda)\n$$\n$$\nI = i_a(0) = \\frac{1}{r_a\\lambda} \\left( D\\cosh(L/\\lambda) \\right)\n$$\n输入电阻为：\n$$\nR_{\\mathrm{in, shorted}} = \\frac{V(0)}{I} = \\frac{D\\sinh(L/\\lambda)}{D\\cosh(L/\\lambda) / (r_a\\lambda)} = r_a\\lambda \\tanh(L/\\lambda) = \\sqrt{r_m r_a} \\tanh(L/\\lambda)\n$$\n\n### 数值模型\n神经突被离散成 $N$ 个节点，索引为 $i=0, ..., N-1$，位于位置 $x_i = i \\Delta x$。我们在每个节点应用基尔霍夫电流定律（KCL）。\n\n- **内部节点 ($0 < i < N-1$)**：流向邻居的轴向电流与膜电流之和为零。\n  $g_a(V_i - V_{i-1}) + g_a(V_i - V_{i+1}) + g_m V_i = 0 \\implies -g_a V_{i-1} + (2g_a + g_m)V_i - g_a V_{i+1} = 0$。\n- **近端节点 ($i=0$)**：注入的电流 $I$ 与流向右侧邻居和流过膜的电流相平衡。\n  $g_a(V_0 - V_1) + g_m^{\\mathrm{end}} V_0 = I \\implies (g_a + g_m^{\\mathrm{end}})V_0 - g_a V_1 = I$。\n\n这些方程构成一个线性系统 $A\\mathbf{V} = \\mathbf{b}$，其中 $\\mathbf{V}=[V_0, ..., V_{N-1}]^T$。系统的最后一行取决于远端边界条件。\n\n- **封口端**：在节点 $i=N-1$ 应用 KCL。右侧没有邻居。\n  $g_a(V_{N-1} - V_{N-2}) + g_m^{\\mathrm{end}} V_{N-1} = 0 \\implies -g_a V_{N-2} + (g_a + g_m^{\\mathrm{end}})V_{N-1} = 0$。\n  矩阵 $A$ 是三对角的。$\\mathbf{b} = [I, 0, \\dots, 0]^T$。\n- **短路端**：电压固定为 $V_{N-1}=0$。这是一个狄利克雷条件，取代了最后一个节点的 KCL 方程。系统对 $V_0, ..., V_{N-1}$ 仍然有效。\n  KCL 方程对 $i=0, \\dots, N-2$ 成立。最后一个方程就是 $V_{N-1} = 0$。\n  这导致一个矩阵 $A$，其中第 0 到 N-2 行是三对角的，最后一行是 $[0, \\dots, 0, 1]$。向量 $\\mathbf{b}$ 是 $[I, 0, \\dots, 0]^T$。\n\n求解系统 $A\\mathbf{V}=\\mathbf{b}$ 以得到 $\\mathbf{V}$。由于 $I=1\\ \\mathrm{A}$，数值输入电阻为 $R_{\\mathrm{in}}^{\\mathrm{num}} = V_0/I = V_0$。然后，相对误差计算为 $|R_{\\mathrm{in}}^{\\mathrm{num}} - R_{\\mathrm{in}}^{\\mathrm{ana}}| / R_{\\mathrm{in}}^{\\mathrm{ana}}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the cable theory problem by deriving analytical solutions and implementing \n    a numerical compartmental model to find the input resistance of a neurite \n    under sealed and shorted boundary conditions, and computes the relative error.\n    \"\"\"\n    \n    # Common physical parameters from the problem statement\n    a = 1.0e-6  # radius (m)\n    Rm = 1.0   # specific membrane resistance (Ohm * m^2)\n    Ra = 1.0   # specific axial resistivity (Ohm * m)\n    I_inj = 1.0  # injected current (A)\n\n    # --- Step 1: Derive lambda and related parameters from first principles ---\n    # r_a = R_a / (pi * a^2)\n    # r_m = R_m / (2 * pi * a)\n    # lambda = sqrt(r_m / r_a) = sqrt( (Rm / (2*pi*a)) / (Ra / (pi*a^2)) )\n    # lambda = sqrt(Rm * pi * a^2 / (2 * pi * a * Ra)) = sqrt(Rm * a / (2 * Ra))\n    lambda_val = math.sqrt((Rm * a) / (2 * Ra))\n\n    # Calculate r_a and r_m which are needed for analytical and numerical solutions\n    r_a = Ra / (math.pi * a**2)\n    r_m = Rm / (2 * math.pi * a)\n    \n    # Characteristic impedance Z_c = sqrt(r_m * r_a)\n    Z_c = math.sqrt(r_m * r_a)\n\n    # Test cases for cable length as a factor of lambda\n    L_factors = [0.1, 1.0, 4.0]\n    results = []\n\n    for L_factor in L_factors:\n        # --- Step 2: Set up discretization for the current case ---\n        L = L_factor * lambda_val\n        \n        # Follow the problem's rule for determining N and dx\n        dx_initial = lambda_val / 800.0\n        if L == 0:\n            N = 1\n            dx = 0\n        else:\n            N = math.ceil(L / dx_initial) + 1\n            dx = L / (N - 1)\n        \n        if N = 1:\n            # Handle trivial case of zero-length or single-node cable\n            # Sealed: R_in is just the membrane resistance of the single compartment\n            R_in_ana_s = r_m / L if L > 0 else np.inf # Limit as L->0: inf\n            R_in_num_s = 1 / ((dx/2)/r_m) if dx > 0 else np.inf\n            # Shorted: R_in is 0 as it's shorted at x=0\n            R_in_ana_sh = 0.0\n            R_in_num_sh = 0.0\n            \n            err_s = 0.0 if np.isinf(R_in_ana_s) else abs(R_in_num_s - R_in_ana_s) / R_in_ana_s\n            err_sh = 0.0\n            results.extend([err_s, err_sh])\n            continue\n            \n        # Compartmental model parameters\n        g_a = 1.0 / (r_a * dx)\n        g_m = dx / r_m\n        g_m_end = (dx / 2.0) / r_m\n\n        # --- Case 1: Sealed End ---\n        # Analytical solution\n        R_in_ana_s = Z_c * (1.0 / math.tanh(L / lambda_val)) # coth(x) = 1/tanh(x)\n\n        # Numerical solution\n        A_s = np.zeros((N, N))\n        b_s = np.zeros(N)\n        b_s[0] = I_inj\n\n        # KCL at node 0\n        A_s[0, 0] = g_a + g_m_end\n        A_s[0, 1] = -g_a\n        # KCL at internal nodes\n        for i in range(1, N - 1):\n            A_s[i, i - 1] = -g_a\n            A_s[i, i] = 2 * g_a + g_m\n            A_s[i, i + 1] = -g_a\n        # KCL at sealed end node N-1\n        A_s[N - 1, N - 2] = -g_a\n        A_s[N - 1, N - 1] = g_a + g_m_end\n\n        V_s = np.linalg.solve(A_s, b_s)\n        R_in_num_s = V_s[0] / I_inj\n        \n        error_s = abs(R_in_num_s - R_in_ana_s) / R_in_ana_s\n        results.append(error_s)\n\n        # --- Case 2: Shorted End ---\n        # Analytical solution\n        R_in_ana_sh = Z_c * math.tanh(L / lambda_val)\n\n        # Numerical solution\n        A_sh = np.zeros((N, N))\n        b_sh = np.zeros(N)\n        b_sh[0] = I_inj\n\n        # KCL at node 0\n        A_sh[0, 0] = g_a + g_m_end\n        A_sh[0, 1] = -g_a\n        # KCL at internal nodes (up to N-2)\n        for i in range(1, N - 1):\n            A_sh[i, i - 1] = -g_a\n            A_sh[i, i] = 2 * g_a + g_m\n            A_sh[i, i + 1] = -g_a\n        # Dirichlet condition at shorted end node N-1\n        A_sh[N - 1, N - 1] = 1.0\n\n        V_sh = np.linalg.solve(A_sh, b_sh)\n        R_in_num_sh = V_sh[0] / I_inj\n        \n        error_sh = abs(R_in_num_sh - R_in_ana_sh) / R_in_ana_sh\n        results.append(error_sh)\n\n    # Format and print the final output as a single line\n    formatted_results = [\"{:.6e}\".format(res) for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2764063"}]}