{"hands_on_practices": [{"introduction": "动作电位的快速上升阶段是其最显著的特征之一，由强大的内向净离子电流驱动。这个练习将带我们深入到这一瞬间，通过计算膜电位在去极化过程中的某一特定时刻的净离子流，来量化驱动这一过程的力量。通过这个计算，你将亲身体会到钠离子和钾离子电流之间的“拔河”，并理解为何在这一阶段钠离子的内流占据了绝对主导地位，从而为动作电位的爆发式上升提供动力。[@problem_id:2719330]", "problem": "一个神经元在其动作电位早期上升相期间，当电压门控钠通道和钾通道部分激活时，被电压钳制在膜电位 $V = -40\\,\\mathrm{mV}$。在此瞬间，测得的最大弦电导分别为钠电导 $g_{\\mathrm{Na}} = 20\\,\\mathrm{mS/cm^2}$、钾电导 $g_{\\mathrm{K}} = 10\\,\\mathrm{mS/cm^2}$ 和一个漏电导 $g_{\\mathrm{L}} = 0.3\\,\\mathrm{mS/cm^2}$。相应的反转电位为 $E_{\\mathrm{Na}} = +60\\,\\mathrm{mV}$、$E_{\\mathrm{K}} = -90\\,\\mathrm{mV}$ 和 $E_{\\mathrm{L}} = -65\\,\\mathrm{mV}$。采用标准的电生理学惯例，即正电荷的外向移动为正电流。\n\n从电化学驱动力和欧姆电导的基本原理出发，且不假设任何特定的门控动力学模型，通过适当组合钠、钾和漏泄通路的贡献，计算在该电压下穿过膜的瞬时净离子电流。\n\n最终答案以微安每平方厘米为单位表示，并四舍五入至四位有效数字。", "solution": "该问题被认为是有效的，因为它具有科学依据、提法明确且客观。它提出了一个基于神经元膜平行电导模型的标准电生理学计算。所提供的参数在生理学上是合理的范围内。\n\n计算跨膜净离子电流的基本原理是，细胞膜可以被建模为一个具有多个平行支路的电路。每个支路对应一种特定类型的离子通道（钠、钾、漏泄），并由一个电导和一个反转电位（电动势）来表征。总电流密度 $I_{\\mathrm{net}}$ 是每种离子类型的单个电流密度的代数和。\n\n$$I_{\\mathrm{net}} = I_{\\mathrm{Na}} + I_{\\mathrm{K}} + I_{\\mathrm{L}}$$\n\n每个单独的离子电流 $I_{\\mathrm{ion}}$ 遵循欧姆定律，其中电流是离子电导 $g_{\\mathrm{ion}}$ 与电化学驱动力的乘积。离子的驱动力是膜电位 $V$ 与该离子的能斯特电位或反转电位 $E_{\\mathrm{ion}}$ 之间的差值。\n\n$$I_{\\mathrm{ion}} = g_{\\mathrm{ion}} (V - E_{\\mathrm{ion}})$$\n\n问题指明了电生理学惯例，即正电荷的外向移动为正电流。这个惯例与上述公式一致。对于一个正离子，如果 $V > E_{\\mathrm{ion}}$，驱动力为正，导致电荷向外流出，从而产生正电流。\n\n问题提供了以下数值：\n膜电位：$V = -40\\,\\mathrm{mV}$\n钠电导：$g_{\\mathrm{Na}} = 20\\,\\mathrm{mS/cm^2}$\n钾电导：$g_{\\mathrm{K}} = 10\\,\\mathrm{mS/cm^2}$\n漏电导：$g_{\\mathrm{L}} = 0.3\\,\\mathrm{mS/cm^2}$\n钠反转电位：$E_{\\mathrm{Na}} = +60\\,\\mathrm{mV}$\n钾反转电位：$E_{\\mathrm{K}} = -90\\,\\mathrm{mV}$\n漏泄反转电位：$E_{\\mathrm{L}} = -65\\,\\mathrm{mV}$\n\n问题要求计算净电流密度。术语“最大弦电导”对于 $g_{\\mathrm{Na}}$ 和 $g_{\\mathrm{K}}$ 被解释为测量瞬间的瞬时电导，因为若无门控变量的信息，任何其他解释都将使问题无法解决。\n\n净电流密度的表达式为：\n$$I_{\\mathrm{net}} = g_{\\mathrm{Na}} (V - E_{\\mathrm{Na}}) + g_{\\mathrm{K}} (V - E_{\\mathrm{K}}) + g_{\\mathrm{L}} (V - E_{\\mathrm{L}})$$\n\n现在我们代入给定的数值。正确处理单位非常重要。电流密度由电导密度($\\mathrm{S/cm^2}$)和电位($\\mathrm{V}$)计算得出。在这里，单位是 $\\mathrm{mS/cm^2}$ 和 $\\mathrm{mV}$。让我们分析这些单位的乘积：\n$$(1\\,\\mathrm{mS/cm^2}) \\times (1\\,\\mathrm{mV}) = (10^{-3}\\,\\mathrm{S/cm^2}) \\times (10^{-3}\\,\\mathrm{V}) = 10^{-6}\\,\\mathrm{A/cm^2} = 1\\,\\mathrm{\\mu A/cm^2}$$\n因此，直接将给定的数值相乘，结果的单位将是 $\\mathrm{\\mu A/cm^2}$，这正是最终答案所要求的单位。\n\n首先，计算每种离子的驱动力：\n$\\mathrm{Na}^+$ 的驱动力：$V - E_{\\mathrm{Na}} = -40\\,\\mathrm{mV} - 60\\,\\mathrm{mV} = -100\\,\\mathrm{mV}$\n$\\mathrm{K}^+$ 的驱动力：$V - E_{\\mathrm{K}} = -40\\,\\mathrm{mV} - (-90\\,\\mathrm{mV}) = -40\\,\\mathrm{mV} + 90\\,\\mathrm{mV} = 50\\,\\mathrm{mV}$\n漏泄的驱动力：$V - E_{\\mathrm{L}} = -40\\,\\mathrm{mV} - (-65\\,\\mathrm{mV}) = -40\\,\\mathrm{mV} + 65\\,\\mathrm{mV} = 25\\,\\mathrm{mV}$\n\n接下来，计算各个电流密度：\n钠电流密度：$I_{\\mathrm{Na}} = g_{\\mathrm{Na}} (V - E_{\\mathrm{Na}}) = (20\\,\\mathrm{mS/cm^2}) \\times (-100\\,\\mathrm{mV}) = -2000\\,\\mathrm{\\mu A/cm^2}$。负号表示正钠离子的净内流。\n钾电流密度：$I_{\\mathrm{K}} = g_{\\mathrm{K}} (V - E_{\\mathrm{K}}) = (10\\,\\mathrm{mS/cm^2}) \\times (50\\,\\mathrm{mV}) = 500\\,\\mathrm{\\mu A/cm^2}$。正号表示正钾离子的净外流。\n漏泄电流密度：$I_{\\mathrm{L}} = g_{\\mathrm{L}} (V - E_{\\mathrm{L}}) = (0.3\\,\\mathrm{mS/cm^2}) \\times (25\\,\\mathrm{mV}) = 7.5\\,\\mathrm{\\mu A/cm^2}$。正号表示正电荷的净外流。\n\n最后，将各个电流密度相加，求得净电流密度：\n$$I_{\\mathrm{net}} = I_{\\mathrm{Na}} + I_{\\mathrm{K}} + I_{\\mathrm{L}} = -2000\\,\\mathrm{\\mu A/cm^2} + 500\\,\\mathrm{\\mu A/cm^2} + 7.5\\,\\mathrm{\\mu A/cm^2}$$\n$$I_{\\mathrm{net}} = -1492.5\\,\\mathrm{\\mu A/cm^2}$$\n\n这个结果证实了所描述的生理状态。在动作电位的上升相期间，一个大的净内向（负）电流导致了快速的去极化。该电流主要由钠离子的内流主导，其超过了较小的钾离子和漏泄离子的外向电流。\n\n问题要求答案四舍五入至四位有效数字。计算值为 $-1492.5$。将其四舍五入至四位有效数字得到 $-1493$。", "answer": "$$\\boxed{-1493}$$", "id": "2719330"}, {"introduction": "动作电位的上升并非无限，它会在一个峰值电位（$V_{\\text{peak}}$）处达到顶峰。这个峰值是如何确定的呢？本练习将揭示其背后的基本原理：在峰值点，膜电位的时间变化率 $dV/dt$ 为零，这意味着跨膜的总离子电流为零。通过在一个假设的场景下计算峰值电位，你将学会如何利用不同离子通道的瞬时电导来预测 $V_{\\text{peak}}$，并从根本上理解为何动作电位峰值总是低于钠离子的平衡电位 $E_{\\text{Na}}$。[@problem_id:2719338]", "problem": "一个具有符合生理学现实的钠、钾和漏泄通路的电压钳制神经元被转为电流钳制模式，以产生单个动作电位。在动作电位峰值瞬间，膜电位的时间导数为零，并且此时没有外部注入电流。假设此刻只有欧姆性的钠、钾和漏泄电流起作用，其反转电位分别为 $E_{\\mathrm{Na}} = +60$ mV、$E_{\\mathrm{K}} = -90$ mV 和 $E_{\\mathrm{L}} = -65$ mV。由于钠通道的功能丧失性突变以及延迟整流钾通道的同时上调，峰值时的瞬时电导比为 $g_{\\mathrm{Na}} : g_{\\mathrm{K}} : g_{\\mathrm{L}} = 5 : 3 : 0.3$。\n\n仅使用峰值时的第一性原理电流平衡和标准生物物理学定义，计算峰值时的膜电位，$V_{\\mathrm{peak}}$。将您的答案四舍五入到四位有效数字，并以 mV 为单位表示。只需提供 $V_{\\mathrm{peak}}$ 的最终数值（以 mV 为单位）作为答案。", "solution": "该问题要求计算动作电位峰值时的膜电位，记作 $V_{\\mathrm{peak}}$。分析始于单室神经元的基本电流平衡方程，该方程是 Kirchhoff 电流定律在细胞膜上的应用。总膜电流，它与膜电位 $V_m$ 的变化率成正比，是外部注入电流 $I_{\\mathrm{ext}}$ 与总离子电流 $I_{\\mathrm{ion}}$ 的和。\n\n膜方程由下式给出：\n$$C_m \\frac{dV_m}{dt} = I_{\\mathrm{ext}} - I_{\\mathrm{ion}}$$\n其中 $C_m$ 是膜电容。\n\n问题指出，在峰值瞬间，膜电位的时间导数为零，即 $\\frac{dV_m}{dt} = 0$。问题还指明，此时没有外部电流注入，因此 $I_{\\mathrm{ext}} = 0$。将这些条件代入膜方程得到：\n$$C_m \\cdot 0 = 0 - I_{\\mathrm{ion}}$$\n$$I_{\\mathrm{ion}} = 0$$\n\n这意味着在动作电位峰值时，流过膜的所有离子电流之和为零。问题指出了三种起作用的电流：钠电流 ($I_{\\mathrm{Na}}$)、钾电流 ($I_{\\mathrm{K}}$) 和漏泄电流 ($I_{\\mathrm{L}}$)。因此，总离子电流为：\n$$I_{\\mathrm{ion}} = I_{\\mathrm{Na}} + I_{\\mathrm{K}} + I_{\\mathrm{L}}$$\n将此和设为零，我们得到：\n$$I_{\\mathrm{Na}} + I_{\\mathrm{K}} + I_{\\mathrm{L}} = 0$$\n\n这些电流被假定为欧姆性电流，意味着每种电流 $I_x$ 都遵循 $I_x = g_x (V_m - E_x)$ 的形式，其中 $g_x$ 是离子种类 x 的瞬时电导，$E_x$ 是其 Nernst（反转）电位。在峰值时，膜电位为 $V_{\\mathrm{peak}}$。因此，电流平衡方程变为：\n$$g_{\\mathrm{Na}}(V_{\\mathrm{peak}} - E_{\\mathrm{Na}}) + g_{\\mathrm{K}}(V_{\\mathrm{peak}} - E_{\\mathrm{K}}) + g_{\\mathrm{L}}(V_{\\mathrm{peak}} - E_{\\mathrm{L}}) = 0$$\n\n我们现在必须求解这个方程以得到 $V_{\\mathrm{peak}}$。我们展开各项：\n$$g_{\\mathrm{Na}}V_{\\mathrm{peak}} - g_{\\mathrm{Na}}E_{\\mathrm{Na}} + g_{\\mathrm{K}}V_{\\mathrm{peak}} - g_{\\mathrm{K}}E_{\\mathrm{K}} + g_{\\mathrm{L}}V_{\\mathrm{peak}} - g_{\\mathrm{L}}E_{\\mathrm{L}} = 0$$\n\n合并含有 $V_{\\mathrm{peak}}$ 的项：\n$$V_{\\mathrm{peak}}(g_{\\mathrm{Na}} + g_{\\mathrm{K}} + g_{\\mathrm{L}}) = g_{\\mathrm{Na}}E_{\\mathrm{Na}} + g_{\\mathrm{K}}E_{\\mathrm{K}} + g_{\\mathrm{L}}E_{\\mathrm{L}}$$\n\n解出 $V_{\\mathrm{peak}}$ 得到通用表达式：\n$$V_{\\mathrm{peak}} = \\frac{g_{\\mathrm{Na}}E_{\\mathrm{Na}} + g_{\\mathrm{K}}E_{\\mathrm{K}} + g_{\\mathrm{L}}E_{\\mathrm{L}}}{g_{\\mathrm{Na}} + g_{\\mathrm{K}} + g_{\\mathrm{L}}}$$\n这表明 $V_{\\mathrm{peak}}$ 是反转电位的加权平均值，其权重分别是相应的瞬时电导。\n\n问题给出了峰值时的电导比：$g_{\\mathrm{Na}} : g_{\\mathrm{K}} : g_{\\mathrm{L}} = 5 : 3 : 0.3$。我们可以用一个比例常数 $k$ 来表示各个电导：\n$$g_{\\mathrm{Na}} = 5k$$\n$$g_{\\mathrm{K}} = 3k$$\n$$g_{\\mathrm{L}} = 0.3k$$\n将这些代入 $V_{\\mathrm{peak}}$ 的表达式中：\n$$V_{\\mathrm{peak}} = \\frac{(5k)E_{\\mathrm{Na}} + (3k)E_{\\mathrm{K}} + (0.3k)E_{\\mathrm{L}}}{5k + 3k + 0.3k}$$\n常数 $k$ 非零，可以作为公因子从分子和分母中提出，从而被约去：\n$$V_{\\mathrm{peak}} = \\frac{k(5E_{\\mathrm{Na}} + 3E_{\\mathrm{K}} + 0.3E_{\\mathrm{L}})}{k(5 + 3 + 0.3)} = \\frac{5E_{\\mathrm{Na}} + 3E_{\\mathrm{K}} + 0.3E_{\\mathrm{L}}}{5 + 3 + 0.3}$$\n这表明，要确定净电流为零时的电位，只需要电导的相对比例。\n\n现在，我们代入给定的反转电位数值：$E_{\\mathrm{Na}} = +60$ mV、$E_{\\mathrm{K}} = -90$ mV 和 $E_{\\mathrm{L}} = -65$ mV。\n$$V_{\\mathrm{peak}} = \\frac{5(60) + 3(-90) + 0.3(-65)}{5 + 3 + 0.3}$$\n\n计算分子：\n$$ 5 \\times 60 = 300 $$\n$$ 3 \\times (-90) = -270 $$\n$$ 0.3 \\times (-65) = -19.5 $$\n$$ \\text{分子} = 300 - 270 - 19.5 = 30 - 19.5 = 10.5 $$\n\n计算分母：\n$$ \\text{分母} = 5 + 3 + 0.3 = 8.3 $$\n\n因此，$V_{\\mathrm{peak}}$ 的值为：\n$$V_{\\mathrm{peak}} = \\frac{10.5}{8.3} \\approx 1.26506024... \\text{ mV}$$\n\n问题要求答案四舍五入到四位有效数字。\n$$V_{\\mathrm{peak}} \\approx 1.265 \\text{ mV}$$", "answer": "$$\\boxed{1.265}$$", "id": "2719338"}, {"introduction": "在前两个练习中，我们对动作电位的特定瞬间进行了“快照”分析。现在，我们将从静态计算跃升到动态模拟，构建一个完整的 Hodgkin-Huxley 模型，来观察整个动作电位的生命周期。这个实践是一个虚拟的电生理学实验，你将通过编写代码来模拟神经元如何对刺激产生反应，并探究药物（如钠离子通道阻断剂）如何改变动作电位的幅度和上升时间。这不仅能让你深入理解构成动作电位的复杂离子动力学，还能让你掌握现代神经科学研究中至关重要的计算建模技能。[@problem_id:2719381]", "problem": "构建一个程序，使用 Hodgkin–Huxley (HH) 单室神经元模型，预测降低最大钠电导如何影响动作电位的上升时间和幅度。请从以下基本且经过充分检验的公式开始。\n\n1) 膜动力学。膜电位 $V$ 遵循电流平衡方程\n$$ C_m \\frac{dV}{dt} = I_{\\text{inj}}(t) - I_{\\text{Na}}(V,m,h) - I_{\\text{K}}(V,n) - I_{\\text{L}}(V), $$\n其中 $C_m$ 是膜电容，$I_{\\text{inj}}(t)$ 是外部注入电流。离子电流为\n$$ I_{\\text{Na}} = \\bar{g}_{\\text{Na}} \\, m^3 h \\, (V - E_{\\text{Na}}), \\quad I_{\\text{K}} = \\bar{g}_{\\text{K}} \\, n^4 \\, (V - E_{\\text{K}}), \\quad I_{\\text{L}} = \\bar{g}_{\\text{L}} \\, (V - E_{\\text{L}}), $$\n其中 $m, h, n$ 是取值范围为 $[0,1]$ 的门控变量。\n\n2) 门控动力学。每个门控变量 $x \\in \\{m,h,n\\}$ 遵循一级动力学演化\n$$ \\frac{dx}{dt} = \\alpha_x(V) \\, (1-x) - \\beta_x(V) \\, x。 $$\n使用经典的 Hodgkin–Huxley 速率函数（所有电压单位为毫伏，时间单位为毫秒）：\n- $$ \\alpha_m(V) = 0.1 \\cdot \\frac{V+40}{1 - e^{-(V+40)/10}} $$\n- $$ \\alpha_h(V) = 0.07 \\, e^{-(V+65)/20} $$\n- $$ \\alpha_n(V) = 0.01 \\cdot \\frac{V+55}{1 - e^{-(V+55)/10}} $$\n- $$ \\beta_m(V) = 4 \\, e^{-(V+65)/18} $$\n- $$ \\beta_h(V) = \\frac{1}{1 + e^{-(V+35)/10}} $$\n- $$ \\beta_n(V) = 0.125 \\, e^{-(V+65)/80} $$\n为保证数值稳定性，当形如 $\\frac{x}{1-e^{-x/k}}$ 的表达式遇到 $x \\approx 0$ 时，使用洛必达法则求其连续极限。\n\n3) 参数和单位。使用 $C_m = 1$ 微法每平方厘米 ($\\mu$F/cm$^2$)，$\\bar{g}_{\\text{Na}} = 120$ 毫西门子每平方厘米 (mS/cm$^2$)，$\\bar{g}_{\\text{K}} = 36$ mS/cm$^2$，$\\bar{g}_{\\text{L}} = 0.3$ mS/cm$^2$， $E_{\\text{Na}} = 50$ 毫伏 (mV)，$E_{\\text{K}} = -77$ mV，以及 $E_{\\text{L}} = -54.4$ mV。在 $V(0) = -65$ mV 进行初始化，并将 $m(0), h(0), n(0)$ 设置为它们在 $V=-65$ mV 时的稳态值，即 $x(0) = \\alpha_x(V)/(\\alpha_x(V)+\\beta_x(V))$。\n\n4) 刺激方案。注入一个方波脉冲电流：\n- 幅度 $I_0 = 10$ 微安每平方厘米 ($\\mu$A/cm$^2$)，\n- 起始时间 $t_{\\text{on}} = 10$ 毫秒 (ms)，\n- 结束时间 $t_{\\text{off}} = 11$ ms。\n在此区间之外，$I_{\\text{inj}}(t) = 0$。\n\n5) 数值积分。使用稳定、显式的常微分方程求解方法，以 $\\Delta t = 0.01$ ms 的固定时间步长，从 $t=0$ ms 积分到 $t=30$ ms。所有计算均使用上述单位。将 $t \\in [5,10]$ ms 时间段内 $V(t)$ 的时间平均值作为静息电位 $V_{\\text{rest}}$。\n\n6) 测量定义。动作电位的幅度和上升时间定义如下：\n- 幅度 $A$ 等于刺激后的第一个峰值电压与静息电位之差，即 $A = V_{\\text{peak}} - V_{\\text{rest}}$（单位mV）。\n- 上升时间 $T_{\\text{rise}}$ 等于上升支开始时刻与峰值时刻之间的时间差（单位ms）。操作上，将上升支的起始点检测为 $t_{\\text{on}}$ 或之后，数值时间导数满足 $\\frac{dV}{dt} \\ge s_{\\theta}$ 的第一个时间点 $t_{\\theta}$，其中斜率阈值 $s_{\\theta} = 20$ mV/ms。则 $T_{\\text{rise}} = t_{\\text{peak}} - t_{\\theta}$，其中 $t_{\\text{peak}}$ 是 $t_{\\theta}$ 之后 $10$ ms 内 $V(t)$ 的后续局部最大值对应的时间。\n- 锋电位存在判据：仅当检测到的峰值满足 $V_{\\text{peak}} \\ge 0$ mV 时，才报告为一次动作电位。如果未找到这样的峰值，或未检测到上升支的起始点，则该测试用例返回数值对 $[-1.0,-1.0]$。\n\n7) 钠通道阻断方案。通过将 $\\bar{g}_{\\text{Na}}$ 乘以一个因子 $s \\in (0,1]$ 来模拟钠通道的部分阻断，即使用 $\\bar{g}_{\\text{Na,eff}} = s \\cdot \\bar{g}_{\\text{Na}}$。\n\n测试套件：\n- 用例 1：$s = 1.0$（无阻断）。\n- 用例 2：$s = 0.5$（减少百分之五十）。\n- 用例 3：$s = 0.2$（强阻断）。\n- 用例 4：$s = 0.1$（接近完全阻断）。\n\n要求输出：\n- 对于每个用例，计算 $[A, T_{\\text{rise}}]$，其中 $A$ 的单位是 mV，$T_{\\text{rise}}$ 的单位是 ms，结果保留三位小数。\n- 你的程序应生成单行输出，包含一个由方括号括起来的、逗号分隔的列表。其中每个用例本身也表示为一个双元素列表，并按上述测试套件的顺序排列。例如，一个有效的输出格式是\n$$ [[A_1,T_{\\text{rise},1}],[A_2,T_{\\text{rise},2}],[A_3,T_{\\text{rise},3}],[A_4,T_{\\text{rise},4}]]。 $$\n不应打印任何其他文本。", "solution": "我们的目标是预测钠通道的部分阻断（通过降低最大钠电导 $\\bar{g}_{\\text{Na}}$ 来实现）如何影响动作电位的上升时间和幅度。本解决方案基于 Hodgkin–Huxley (HH) 形式体系，这是一个经过充分检验、具有生物物理基础的动作电位离子机制模型。\n\n1) 基本方程。膜电位 $V$ 的动力学遵循电容电流平衡方程\n$$ C_m \\frac{dV}{dt} = I_{\\text{inj}}(t) - I_{\\text{Na}}(V,m,h) - I_{\\text{K}}(V,n) - I_{\\text{L}}(V), $$\n其中 $C_m$ 是单位面积的膜电容，$I_{\\text{inj}}(t)$ 是外部注入的电流密度。离子电流为\n$$ I_{\\text{Na}} = \\bar{g}_{\\text{Na}} m^3 h (V - E_{\\text{Na}}), \\quad I_{\\text{K}} = \\bar{g}_{\\text{K}} n^4 (V - E_{\\text{K}}), \\quad I_{\\text{L}} = \\bar{g}_{\\text{L}} (V - E_{\\text{L}}). $$\n门控变量 $m, h, n$ 遵循具有电压依赖性速率的一级动力学：\n$$ \\frac{dx}{dt} = \\alpha_x(V) (1-x) - \\beta_x(V) x, \\quad x \\in \\{m,h,n\\}. $$\n速率函数是经典的 Hodgkin–Huxley 表达式：\n- $$ \\alpha_m(V) = 0.1 \\cdot \\frac{V+40}{1 - e^{-(V+40)/10}}, \\quad \\beta_m(V) = 4 \\, e^{-(V+65)/18}, $$\n- $$ \\alpha_h(V) = 0.07 \\, e^{-(V+65)/20}, \\quad \\beta_h(V) = \\frac{1}{1 + e^{-(V+35)/10}}, $$\n- $$ \\alpha_n(V) = 0.01 \\cdot \\frac{V+55}{1 - e^{-(V+55)/10}}, \\quad \\beta_n(V) = 0.125 \\, e^{-(V+65)/80}. $$\n当分母趋近于零时，我们通过洛必达法则使用其连续极限，从而得到有限值（例如，对于 $V=-40$ mV 时的 $\\alpha_m$，极限值为 $1.0$ ms$^{-1}$）。这确保了数值稳定性。\n\n2) 参数和单位。我们使用 $C_m = 1$ $\\mu$F/cm$^2$，$\\bar{g}_{\\text{Na}} = 120$ mS/cm$^2$，$\\bar{g}_{\\text{K}} = 36$ mS/cm$^2$，$\\bar{g}_{\\text{L}} = 0.3$ mS/cm$^2$，$E_{\\text{Na}} = 50$ mV，$E_{\\text{K}} = -77$ mV，$E_{\\text{L}} = -54.4$ mV。初始条件为 $V(0) = -65$ mV，并且当 $V=-65$ mV 时，对于 $x \\in \\{m,h,n\\}$，$x(0) = \\alpha_x(V)/(\\alpha_x(V)+\\beta_x(V))$。注入电流是一个方波脉冲，幅度为 $I_0 = 10$ $\\mu$A/cm$^2$，在 $t_{\\text{on}}=10$ ms 时开启，在 $t_{\\text{off}}=11$ ms 时关闭。我们以 $\\Delta t = 0.01$ ms 的固定步长从 $t=0$ ms 积分到 $t=30$ ms。\n\n3) 数值方法。我们使用显式固定步长积分器（前向欧拉法）。当 $\\Delta t$ 相对于最快的门控动力学足够小时，该方法适用于这些时间尺度。在每一步中，我们使用微分方程更新 $m, h, n$，然后使用膜方程更新 $V$。注入电流函数 $I_{\\text{inj}}(t)$ 按规定为分段常数。\n\n4) 测量。我们通过对 $t \\in [5,10]$ ms 区间内的 $V(t)$ 进行平均来计算静息电位 $V_{\\text{rest}}$；这个刺激前的时间窗口允许初始化产生的瞬态响应衰减。我们在 $t_{\\theta} \\ge t_{\\text{on}}$ 的第一个时间点检测上升支的起始，该点的导数的有限差分估计满足 $\\frac{dV}{dt} \\ge s_{\\theta}$，其中 $s_{\\theta}=20$ mV/ms。然后，我们在 $t_{\\theta}$ 之后的 $10$ ms 内搜索后续的局部最大值 $V_{\\text{peak}}$，并计算幅度 $A = V_{\\text{peak}} - V_{\\text{rest}}$ 和上升时间 $T_{\\text{rise}} = t_{\\text{peak}} - t_{\\theta}$。我们仅在 $V_{\\text{peak}} \\ge 0$ mV 时才判定为一次成功的锋电位。如果未检测到上升支起始点，未找到峰值，或 $V_{\\text{peak}} < 0$ mV，我们返回失败标志对 $[-1.0,-1.0]$。\n\n5) 钠通道阻断建模。通过将最大钠电导按比例缩放 $\\bar{g}_{\\text{Na,eff}} = s \\cdot \\bar{g}_{\\text{Na}}$（其中 $s \\in (0,1]$）来模拟部分阻断。减小 $s$ 会降低最大内向钠电流 $I_{\\text{Na}}$，从膜方程可以推导出这会产生两个主要影响：\n- 在上升相期间，它会减小 $\\frac{dV}{dt}$，因为对于给定的 $V$ 和门控状态，净内向电流更小，导致达到峰值所需的时间更长。因此，上升时间 $T_{\\text{rise}}$ 随着 $s$ 的减小而增加。\n- 它会降低可达到的峰值电压，因为钠驱动项 $\\bar{g}_{\\text{Na}} m^3 h (V - E_{\\text{Na}})$ 在一个较低的值饱和，而外向的钾电流和漏电流则对抗去极化。因此，幅度 $A$ 随着 $s$ 的减小而减小，并且当 $s$ 足够小时，可能不会产生锋电位（满足失败判据）。\n\n6) 测试套件和输出。我们评估四种情况 $s \\in \\{1.0, 0.5, 0.2, 0.1\\}$。对于每种情况，我们进行模拟，测量以 mV 和 ms 为单位的 $[A, T_{\\text{rise}}]$，结果保留三位小数，并输出包含该列表的单行\n$$ [[A_1,T_{\\text{rise},1}],[A_2,T_{\\text{rise},2}],[A_3,T_{\\text{rise},3}],[A_4,T_{\\text{rise},4}]]。 $$\n\n这个算法流程直接体现了阈值和动作电位各时相的离子基础：当净内向钠电流超过外向电流，使得 $\\frac{dV}{dt}$ 产生一个超过指定斜率的正值时，就发生了阈值穿越；上升相由钠激活变量 $m$ 和 $h$ 的失活主导，下降相和后超极化（undershoot）由延迟整流钾激活变量 $n$ 和 $h$ 的恢复所控制，而幅度和上升时间则由微分方程中编码的 $\\bar{g}_{\\text{Na}}$ 和 $\\bar{g}_{\\text{K}}$ 之间的相互作用共同决定。因此，可以预见，降低 $\\bar{g}_{\\text{Na}}$ 会减慢上升支并降低峰值，在足够强的阻断下，会在固定刺激下阻止锋电位的发放。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef vtrap(x, y):\n    # Safe evaluation of x / (1 - exp(-x/y)) with limit as x->0 being y\n    # Using series: as x->0, 1 - exp(-x/y) ~ x/y => ratio ~ y\n    # Implement a threshold to avoid numerical issues.\n    thresh = 1e-6\n    out = np.empty_like(x, dtype=float) if isinstance(x, np.ndarray) else None\n    if isinstance(x, np.ndarray):\n        mask = np.abs(x)  thresh\n        out[mask] = y\n        out[~mask] = x[~mask] / (1.0 - np.exp(-x[~mask] / y))\n        return out\n    else:\n        xv = float(x)\n        if abs(xv)  thresh:\n            return y\n        return xv / (1.0 - np.exp(-xv / y))\n\ndef alpha_m(V):\n    return 0.1 * vtrap(V + 40.0, 10.0)\n\ndef beta_m(V):\n    return 4.0 * np.exp(-(V + 65.0) / 18.0)\n\ndef alpha_h(V):\n    return 0.07 * np.exp(-(V + 65.0) / 20.0)\n\ndef beta_h(V):\n    return 1.0 / (1.0 + np.exp(-(V + 35.0) / 10.0))\n\ndef alpha_n(V):\n    return 0.01 * vtrap(V + 55.0, 10.0)\n\ndef beta_n(V):\n    return 0.125 * np.exp(-(V + 65.0) / 80.0)\n\ndef hh_simulation(gNa_scale,\n                  T=30.0, dt=0.01,\n                  Cm=1.0,\n                  gNa_base=120.0, gK=36.0, gL=0.3,\n                  ENa=50.0, EK=-77.0, EL=-54.4,\n                  I0=10.0, ton=10.0, toff=11.0):\n    # Time vector\n    nsteps = int(np.round(T / dt)) + 1\n    t = np.linspace(0.0, T, nsteps)\n    # Allocate\n    V = np.zeros(nsteps, dtype=float)\n    m = np.zeros(nsteps, dtype=float)\n    h = np.zeros(nsteps, dtype=float)\n    n = np.zeros(nsteps, dtype=float)\n    # Initial conditions\n    V[0] = -65.0\n    am = alpha_m(V[0]); bm = beta_m(V[0])\n    ah = alpha_h(V[0]); bh = beta_h(V[0])\n    an = alpha_n(V[0]); bn = beta_n(V[0])\n    m[0] = am / (am + bm)\n    h[0] = ah / (ah + bh)\n    n[0] = an / (an + bn)\n\n    gNa = gNa_base * gNa_scale\n\n    # Injected current as function\n    def I_inj(time):\n        return I0 if (time >= ton and time = toff) else 0.0\n\n    # Forward Euler integration\n    for i in range(nsteps - 1):\n        Vi = V[i]\n        mi = m[i]\n        hi = h[i]\n        ni = n[i]\n\n        Ina = gNa * (mi**3) * hi * (Vi - ENa)\n        Ik = gK * (ni**4) * (Vi - EK)\n        Il = gL * (Vi - EL)\n        Iion = Ina + Ik + Il\n\n        dVdt = (I_inj(t[i]) - Iion) / Cm\n\n        am = alpha_m(Vi); bm = beta_m(Vi)\n        ah = alpha_h(Vi); bh = beta_h(Vi)\n        an = alpha_n(Vi); bn = beta_n(Vi)\n\n        dmdt = am * (1.0 - mi) - bm * mi\n        dhdt = ah * (1.0 - hi) - bh * hi\n        dndt = an * (1.0 - ni) - bn * ni\n\n        V[i+1] = Vi + dt * dVdt\n        m[i+1] = mi + dt * dmdt\n        h[i+1] = hi + dt * dhdt\n        n[i+1] = ni + dt * dndt\n\n        # Clamp gating variables to [0,1] to avoid numeric drift\n        if m[i+1]  0.0: m[i+1] = 0.0\n        if m[i+1] > 1.0: m[i+1] = 1.0\n        if h[i+1]  0.0: h[i+1] = 0.0\n        if h[i+1] > 1.0: h[i+1] = 1.0\n        if n[i+1]  0.0: n[i+1] = 0.0\n        if n[i+1] > 1.0: n[i+1] = 1.0\n\n    # Compute resting potential as mean over [5,10] ms\n    rest_start = 5.0\n    rest_end = 10.0\n    idx_rest = np.where((t >= rest_start)  (t = rest_end))[0]\n    Vrest = float(np.mean(V[idx_rest])) if idx_rest.size > 0 else float(V[0])\n\n    # Compute derivative dV/dt by central difference\n    dVdt_num = np.zeros_like(V)\n    dVdt_num[1:-1] = (V[2:] - V[:-2]) / (2.0 * dt)\n    dVdt_num[0] = (V[1] - V[0]) / dt\n    dVdt_num[-1] = (V[-1] - V[-2]) / dt\n\n    # Detect upstroke onset after ton using slope threshold\n    slope_thresh = 20.0  # mV/ms\n    start_idx = np.searchsorted(t, ton, side='left')\n    onset_idx_candidates = np.where((dVdt_num >= slope_thresh)  (np.arange(nsteps) >= start_idx))[0]\n    if onset_idx_candidates.size == 0:\n        return -1.0, -1.0\n    onset_idx = int(onset_idx_candidates[0])\n    t_onset = t[onset_idx]\n\n    # Find peak within 10 ms after onset\n    peak_window_ms = 10.0\n    end_time = t_onset + peak_window_ms\n    end_idx = np.searchsorted(t, end_time, side='right')\n    if end_idx = onset_idx + 1:\n        return -1.0, -1.0\n    seg = V[onset_idx:end_idx]\n    peak_rel_idx = int(np.argmax(seg))\n    peak_idx = onset_idx + peak_rel_idx\n    Vpeak = float(V[peak_idx])\n    t_peak = float(t[peak_idx])\n\n    # Spike existence criterion: require overshoot to >= 0 mV\n    if Vpeak  0.0:\n        return -1.0, -1.0\n\n    amplitude = Vpeak - Vrest\n    rise_time = t_peak - t_onset\n    return amplitude, rise_time\n\ndef solve():\n    # Define the test cases from the problem statement: gNa scaling factors\n    test_cases = [1.0, 0.5, 0.2, 0.1]\n\n    results = []\n    for scale in test_cases:\n        amp, rise = hh_simulation(scale)\n        # Round to three decimals as required\n        amp_rounded = round(amp, 3)\n        rise_rounded = round(rise, 3)\n        results.append([amp_rounded, rise_rounded])\n\n    # Final print statement in the exact required format.\n    # Produce a single line: list of [amplitude, rise_time] pairs.\n    # Ensure there is no extra text.\n    # Convert to string manually to avoid spaces variability\n    out = \"[\" + \",\".join(f\"[{pair[0]},{pair[1]}]\" for pair in results) + \"]\"\n    print(out)\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2719381"}]}