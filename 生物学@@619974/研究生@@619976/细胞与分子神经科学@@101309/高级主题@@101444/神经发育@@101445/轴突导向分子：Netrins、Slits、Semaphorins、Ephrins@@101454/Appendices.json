{"hands_on_practices": [{"introduction": "神经发育的一个核心问题是引导信号如何在组织中形成稳定的浓度梯度。本练习将引导您从基本物理化学原理出发，推导出一个从点源释放并经历一级降解的引导分子的稳态浓度分布。通过求解反应-扩散方程 [@problem_id:2699082]，您将掌握描述神经营养因子（如Netrin-1）等可溶性分子如何在细胞外空间形成化学地图的数学工具，为理解轴突如何“读取”这些空间坐标奠定基础。", "problem": "在发育中的神经环路中，一种分泌的引导信号的细胞外浓度场决定了生长锥的行为。考虑Netrin-1由一个小的源分泌，该源在无限、均匀、各向同性的组织中可近似为位于原点的数学点。假设遵循以下基本原理：质量守恒、菲克第一扩散定律 $J = -D \\nabla c$，以及速率常数为 $\\lambda$ 的一级移除（集总了有效吸收和降解），因此移除项为 $-\\lambda c$。设该源以恒定速率 $Q$（分子/秒）发射配体，模型化为一个点源项。在稳态下，浓度场 $c(\\mathbf{r})$ 仅取决于径向距离 $r = |\\mathbf{r}|$。\n\n仅从质量守恒和菲克定律出发，写出在3维空间中原点处存在点源时 $c(\\mathbf{r})$ 的稳态反应扩散方程，并施加符合物理实际的边界条件。求解该边值问题，以推导出 $r>0$ 时的径向稳态浓度分布 $c(r)$。\n\n将您推导的表达式应用于Netrin-1，参数如下：\n- 发射速率 $Q = 1.0 \\times 10^{5}$ 分子/秒，\n- 扩散系数 $D = 50\\,\\mu\\mathrm{m}^{2}/\\mathrm{s}$，\n- 一级衰变，其特征为组织中的半衰期 $t_{1/2} = 30\\,\\mathrm{min}$，\n- 距源距离 $r = 100\\,\\mu\\mathrm{m}$。\n\n使用阿伏伽德罗常数 $N_{A} = 6.022 \\times 10^{23}\\,\\mathrm{mol}^{-1}$ 将分子数转换为摩尔数。将 $r = 100\\,\\mu\\mathrm{m}$ 处的稳态Netrin-1浓度以纳摩尔/升（nM）为单位表示，并将您的答案四舍五入到四位有效数字。", "solution": "该问题要求推导一种可扩散物质Netrin-1的稳态浓度分布。该物质在一个三维介质中由一个点源发射，并经历一级降解。这是一个经典的反应扩散问题。\n\n首先，我们根据质量守恒原理建立控制偏微分方程。在一个微分体积内表达质量平衡的通用连续性方程为：\n$$\n\\frac{\\partial c}{\\partial t} = -\\nabla \\cdot \\mathbf{J} + S\n$$\n其中 $c(\\mathbf{r}, t)$ 是浓度，$\\mathbf{J}$ 是通量矢量，而 $S$ 代表单位体积内物质的净生成或移除速率。\n\n我们已知以下本构关系：\n1.  菲克第一扩散定律：$\\mathbf{J} = -D \\nabla c$，其中 $D$ 是扩散系数，假定为常数。\n2.  一级移除：移除速率与局部浓度成正比，由 $-\\lambda c$ 给出，其中 $\\lambda$ 是速率常数。\n3.  点源：物质以恒定速率 $Q$ 从原点处的一个点发射，这在数学上使用狄拉克δ函数表示为 $Q\\delta(\\mathbf{r})$。\n\n结合这些，净源项为 $S = Q\\delta(\\mathbf{r}) - \\lambda c$。将这些关系代入连续性方程，我们得到反应扩散方程：\n$$\n\\frac{\\partial c}{\\partial t} = -\\nabla \\cdot (-D \\nabla c) - \\lambda c + Q\\delta(\\mathbf{r})\n$$\n由于 $D$ 是常数，该方程简化为：\n$$\n\\frac{\\partial c}{\\partial t} = D \\nabla^2 c - \\lambda c + Q\\delta(\\mathbf{r})\n$$\n问题要求的是稳态浓度分布，这意味着浓度不再随时间变化。因此，我们令 $\\frac{\\partial c}{\\partial t} = 0$。稳态浓度场 $c(\\mathbf{r})$ 的控制方程为：\n$$\nD \\nabla^2 c(\\mathbf{r}) - \\lambda c(\\mathbf{r}) + Q\\delta(\\mathbf{r}) = 0\n$$\n这是具有点源和一级衰变的稳态反应扩散方程。\n\n现在我们必须在符合物理实际的边界条件下求解此方程。对于 $r > 0$，源项 $Q\\delta(\\mathbf{r})$ 为零，方程变为：\n$$\n\\nabla^2 c - \\frac{\\lambda}{D} c = 0\n$$\n考虑到点源在各向同性介质中的球对称性，浓度 $c$ 将仅取决于径向距离 $r = |\\mathbf{r}|$。在球坐标系中，对于球对称函数，拉普拉斯算子为 $\\nabla^2 = \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{d}{dr} \\right)$。因此，该方程成为一个二阶常微分方程：\n$$\n\\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dc}{dr} \\right) - \\frac{\\lambda}{D} c = 0\n$$\n为了解此方程，我们引入替换 $c(r) = \\frac{u(r)}{r}$。其导数为：\n$$\n\\frac{dc}{dr} = \\frac{1}{r} \\frac{du}{dr} - \\frac{u}{r^2} \\implies r^2 \\frac{dc}{dr} = r \\frac{du}{dr} - u\n$$\n$$\n\\frac{d}{dr} \\left( r^2 \\frac{dc}{dr} \\right) = \\frac{d}{dr} \\left( r \\frac{du}{dr} - u \\right) = \\left( \\frac{du}{dr} + r \\frac{d^2u}{dr^2} \\right) - \\frac{du}{dr} = r \\frac{d^2u}{dr^2}\n$$\n将此代回关于 $c(r)$ 的常微分方程中：\n$$\n\\frac{1}{r^2} \\left( r \\frac{d^2u}{dr^2} \\right) - \\frac{\\lambda}{D} \\frac{u}{r} = 0 \\implies \\frac{1}{r} \\frac{d^2u}{dr^2} - \\frac{\\lambda}{D} \\frac{u}{r} = 0\n$$\n对于 $r>0$，该方程简化为一个标准的线性二阶常系数常微分方程：\n$$\n\\frac{d^2u}{dr^2} - \\frac{\\lambda}{D} u = 0\n$$\n其通解为 $u(r) = A \\exp(-r\\sqrt{\\lambda/D}) + B \\exp(r\\sqrt{\\lambda/D})$，其中 $A$ 和 $B$ 是积分常数。\n因此，浓度分布为：\n$$\nc(r) = \\frac{A}{r} \\exp\\left(-\\frac{r}{\\sqrt{D/\\lambda}}\\right) + \\frac{B}{r} \\exp\\left(\\frac{r}{\\sqrt{D/\\lambda}}\\right)\n$$\n我们定义特征衰减长度 $L = \\sqrt{D/\\lambda}$，因此解为 $c(r) = \\frac{A}{r} \\exp(-r/L) + \\frac{B}{r} \\exp(r/L)$。\n\n现在，我们应用边界条件。\n1.  远离源头，当 $r \\to \\infty$ 时，浓度必须趋于零：$c(r) \\to 0$。当 $r \\to \\infty$ 时，项 $\\frac{B}{r} \\exp(r/L)$ 发散。为满足这一物理要求，常数 $B$ 必须为零。这样剩下 $c(r) = \\frac{A}{r} \\exp(-r/L)$。\n2.  常数 $A$ 由源强度 $Q$ 决定。源的总发射速率必须与通过扩散和降解从系统中移除的总速率相平衡。通过对整个空间积分完整的稳态方程并应用散度定理，可以证明，当包围原点的任意球体的半径趋于零时，流出该球体的总通量必须等于源速率 $Q$。\n$$\nQ = \\lim_{r \\to 0} \\int_{S_r} \\mathbf{J} \\cdot d\\mathbf{S}\n$$\n其中 $S_r$ 是半径为 $r$ 的球面。通量为 $\\mathbf{J} = -D \\nabla c = -D \\frac{dc}{dr} \\hat{\\mathbf{r}}$。因此，\n$$\nQ = \\lim_{r \\to 0} \\left( -D \\frac{dc}{dr} \\cdot 4\\pi r^2 \\right)\n$$\n我们计算解的导数：\n$$\n\\frac{dc}{dr} = \\frac{d}{dr} \\left( \\frac{A}{r} e^{-r/L} \\right) = A \\left( -\\frac{1}{r^2} e^{-r/L} - \\frac{1}{rL} e^{-r/L} \\right) = -A e^{-r/L} \\left( \\frac{1}{r^2} + \\frac{1}{rL} \\right)\n$$\n将此代入 $Q$ 的极限表达式中：\n$$\nQ = \\lim_{r \\to 0} \\left( -4\\pi D r^2 \\left[ -A e^{-r/L} \\left( \\frac{1}{r^2} + \\frac{1}{rL} \\right) \\right] \\right) = \\lim_{r \\to 0} \\left( 4\\pi D A e^{-r/L} \\left( 1 + \\frac{r}{L} \\right) \\right)\n$$\n计算极限得到 $Q = 4\\pi D A$。因此，常数 $A$ 为 $A = \\frac{Q}{4\\pi D}$。\n\n对于 $r>0$，径向稳态浓度分布的最终表达式为：\n$$\nc(r) = \\frac{Q}{4\\pi D r} \\exp\\left(-r\\sqrt{\\frac{\\lambda}{D}}\\right)\n$$\n\n接下来，我们应用给定的参数来计算 $r = 100\\,\\mu\\mathrm{m}$ 处的浓度。\n参数如下：\n$Q = 1.0 \\times 10^{5}\\,\\mathrm{molecules/s}$\n$D = 50\\,\\mu\\mathrm{m}^{2}/\\mathrm{s}$\n$t_{1/2} = 30\\,\\mathrm{min} = 30 \\times 60\\,\\mathrm{s} = 1800\\,\\mathrm{s}$\n$r = 100\\,\\mu\\mathrm{m}$\n$N_{A} = 6.022 \\times 10^{23}\\,\\mathrm{mol}^{-1}$\n\n首先，我们根据半衰期 $t_{1/2}$ 确定衰变常数 $\\lambda$。对于一级过程，$\\lambda = \\frac{\\ln(2)}{t_{1/2}}$。\n$$\n\\lambda = \\frac{\\ln(2)}{1800\\,\\mathrm{s}} \\approx 3.8508 \\times 10^{-4}\\,\\mathrm{s}^{-1}\n$$\n现在我们计算指数的参数，即 $-r\\sqrt{\\lambda/D}$：\n$$\n-r\\sqrt{\\frac{\\lambda}{D}} = -100\\,\\mu\\mathrm{m} \\times \\sqrt{\\frac{3.8508 \\times 10^{-4}\\,\\mathrm{s}^{-1}}{50\\,\\mu\\mathrm{m}^{2}/\\mathrm{s}}} \\approx -100 \\times \\sqrt{7.7016 \\times 10^{-6}\\,\\mu\\mathrm{m}^{-2}}\n$$\n$$\n\\approx -100 \\times (2.7752 \\times 10^{-3}\\,\\mu\\mathrm{m}^{-1}) = -0.27752\n$$\n指数项为 $\\exp(-0.27752) \\approx 0.75774$。\n\n接下来，我们计算指前因子 $\\frac{Q}{4\\pi D r}$：\n$$\n\\frac{Q}{4\\pi D r} = \\frac{1.0 \\times 10^{5}\\,\\mathrm{molecules/s}}{4\\pi (50\\,\\mu\\mathrm{m}^{2}/\\mathrm{s})(100\\,\\mu\\mathrm{m})} = \\frac{1.0 \\times 10^{5}}{20000\\pi} \\frac{\\mathrm{molecules}}{\\mu\\mathrm{m}^3} = \\frac{5}{\\pi} \\frac{\\mathrm{molecules}}{\\mu\\mathrm{m}^3} \\approx 1.59155\\,\\frac{\\mathrm{molecules}}{\\mu\\mathrm{m}^3}\n$$\n以分子数/立方微米为单位的浓度是：\n$$\nc(100\\,\\mu\\mathrm{m}) \\approx 1.59155 \\times 0.75774 \\approx 1.20596\\,\\frac{\\mathrm{molecules}}{\\mu\\mathrm{m}^3}\n$$\n最后，我们将其转换为纳摩尔/升（nM），即 $10^{-9}\\,\\mathrm{mol/L}$。我们使用关系式 $1\\,\\mathrm{L} = 10^{15}\\,\\mu\\mathrm{m}^3$ 和 $1\\,\\mathrm{mol} = N_A\\,\\mathrm{molecules}$。\n$$\nc\\,[\\mathrm{nM}] = c\\,\\left[\\frac{\\mathrm{molecules}}{\\mu\\mathrm{m}^3}\\right] \\times \\frac{1\\,\\mathrm{mol}}{N_A\\,\\mathrm{molecules}} \\times \\frac{10^{15}\\,\\mu\\mathrm{m}^3}{1\\,\\mathrm{L}} \\times \\frac{1\\,\\mathrm{nM}}{10^{-9}\\,\\mathrm{mol/L}}\n$$\n$$\nc\\,[\\mathrm{nM}] = c\\,\\left[\\frac{\\mathrm{molecules}}{\\mu\\mathrm{m}^3}\\right] \\times \\frac{10^{24}}{N_A}\n$$\n$$\nc(100\\,\\mu\\mathrm{m}) \\approx 1.20596 \\times \\frac{10^{24}}{6.022 \\times 10^{23}} \\approx 1.20596 \\times 1.66058 \\approx 2.0026\\,\\mathrm{nM}\n$$\n四舍五入到四位有效数字，稳态Netrin-1浓度为 $2.003\\,\\mathrm{nM}$。", "answer": "$$\n\\boxed{2.003}\n$$", "id": "2699082"}, {"introduction": "在引导梯度建立之后，生长锥如何精确地“感知”并解读这个梯度以确定方向？本练习将生长锥模型化为一个分子探测器，通过计算其朝向梯度源和背离梯度源的两侧所结合的受体数量差异 ($\\Delta B$) 来量化这一过程。这个实践将帮助您理解细胞如何将微弱的细胞外化学浓度差异，通过基本的配体-受体结合动力学 [@problem_id:2699100]，转化为一个明确的、可用于驱动细胞骨架重组的内部不对称信号。", "problem": "在一个发育中的脊髓连合神经元中，生长锥表达结直肠癌缺失基因 (DCC) 受体，该受体用于接收引导线索netrin。将生长锥模型化为一个半径为 $r$ 的扁平圆盘，其上受体表面密度 $\\rho$（单位面积的受体数量）均匀分布。胞外netrin浓度在整个生长锥上呈线性场分布 $c(\\mathbf{x}) = c_0 + \\nabla c \\cdot \\mathbf{x}$，其中 $c_0$ 是生长锥中心的浓度，$\\nabla c$ 是一个恒定的空间梯度矢量，其大小为 $|\\nabla c|$。假设在平衡状态下，配体-受体之间发生可逆的 $1{:}1$ 结合，其解离常数 $K_D$ 由质量作用定律定义为 $K_D = \\frac{[R][L]}{[RL]}$。定义“近”侧为面向浓度增加方向的半圆（即满足 $\\nabla c \\cdot \\mathbf{x} \\ge 0$ 的半圆盘），“远”侧为相对的另一半圆。\n\n令 $B_{\\text{near}}$ 和 $B_{\\text{far}}$ 分别表示近侧和远侧半圆上结合受体的总数。在浅梯度假设 $|\\nabla c|\\, r \\ll c_0 + K_D$ 下，对 $|\\nabla c|$ 的一阶近似有效，请从第一性原理出发，推导结合受体数量之差\n$$\\Delta B \\equiv B_{\\text{near}} - B_{\\text{far}}$$\n的主导项表达式，该表达式仅用 $\\rho$、$r$、$K_D$、$c_0$ 和 $|\\nabla c|$ 表示。请将您的最终答案表示为单一的闭式解析表达式。最终方框内的答案不要包含单位。", "solution": "该问题已经过验证，被认为是有效的。它具有科学依据，问题陈述清晰，客观，并包含了在给定近似下推导出唯一解所需的所有信息。我们开始推导。\n\n第一步是建立局部配体浓度与受体占有率之间的关系。问题指出，结合遵循可逆的 $1{:}1$ 反应的质量作用定律，其特征是解离常数 $K_D$。令 $[R]$ 为游离受体的浓度（或表面密度），$[L]$ 为配体（netrin）的局部体积浓度，$[RL]$ 为结合受体的浓度（表面密度）。总受体密度 $\\rho$ 是恒定的，由 $\\rho = [R] + [RL]$ 给出。\n\n解离常数定义为 $K_D = \\frac{[R][L]}{[RL]}$。我们可以将 $[R]$ 表示为 $\\rho - [RL]$。将其代入 $K_D$ 的定义中，得到：\n$$ K_D = \\frac{(\\rho - [RL])[L]}{[RL]} $$\n设局部配体浓度为 $c$，因此 $[L] = c$。我们关心的是已结合受体的分数，记为 $\\theta = \\frac{[RL]}{\\rho}$。游离受体的分数为 $1-\\theta = \\frac{[R]}{\\rho}$。重排平衡方程：\n$$ K_D \\theta \\rho = (1-\\theta)\\rho c \\implies K_D \\theta = (1-\\theta)c = c - c\\theta $$\n$$ \\theta(K_D + c) = c \\implies \\theta(c) = \\frac{c}{c + K_D} $$\n这个表达式被称为朗缪尔等温线，它给出了在配体浓度为 $c$ 时受体被结合的概率。\n\n在生长锥上位置 $\\mathbf{x}$ 处的局部结合受体表面密度 $\\rho_b(\\mathbf{x})$，是总受体密度 $\\rho$ 乘以在局部netrin浓度 $c(\\mathbf{x})$ 下计算的该概率：\n$$ \\rho_b(\\mathbf{x}) = \\rho \\cdot \\theta(c(\\mathbf{x})) = \\rho \\frac{c(\\mathbf{x})}{c(\\mathbf{x}) + K_D} $$\n问题指明了一个线性浓度场 $c(\\mathbf{x}) = c_0 + \\nabla c \\cdot \\mathbf{x}$，其中 $c_0$ 是生长锥中心（$\\mathbf{x} = \\mathbf{0}$）的浓度，$\\nabla c$ 是一个恒定梯度。将此代入 $\\rho_b(\\mathbf{x})$ 的表达式中：\n$$ \\rho_b(\\mathbf{x}) = \\rho \\frac{c_0 + \\nabla c \\cdot \\mathbf{x}}{c_0 + \\nabla c \\cdot \\mathbf{x} + K_D} $$\n我们已知浅梯度条件 $|\\nabla c|\\, r \\ll c_0 + K_D$。该条件意味着对于圆盘上的所有点（因为 $|\\mathbf{x}| \\le r$），$\\nabla c \\cdot \\mathbf{x}$ 这一项与 $c_0 + K_D$ 相比很小。这为在 $\\mathbf{x}=\\mathbf{0}$ 附近对 $\\rho_b(\\mathbf{x})$ 进行一阶泰勒展开提供了依据。设 $f(c) = \\rho \\frac{c}{c+K_D}$。我们对小的 $\\delta c = \\nabla c \\cdot \\mathbf{x}$ 展开 $f(c_0 + \\delta c)$：\n$$ f(c_0 + \\delta c) \\approx f(c_0) + f'(c_0) \\delta c $$\n导数 $f'(c)$ 是：\n$$ f'(c) = \\frac{d}{dc}\\left(\\rho \\frac{c}{c+K_D}\\right) = \\rho \\left( \\frac{(c+K_D) \\cdot 1 - c \\cdot 1}{(c+K_D)^2} \\right) = \\rho \\frac{K_D}{(c+K_D)^2} $$\n在 $c=c_0$ 处，导数为 $f'(c_0) = \\rho \\frac{K_D}{(c_0+K_D)^2}$。\n因此，线性化的结合受体密度为：\n$$ \\rho_b(\\mathbf{x}) \\approx \\rho \\frac{c_0}{c_0+K_D} + \\rho \\frac{K_D}{(c_0+K_D)^2} (\\nabla c \\cdot \\mathbf{x}) $$\n此表达式是结合受体密度的主导项近似。\n\n“近”侧的总结合受体数 $B_{\\text{near}}$ 和“远”侧的总结合受体数 $B_{\\text{far}}$，可通过将 $\\rho_b(\\mathbf{x})$ 在各自的半圆区域上积分得到。令 $\\mathcal{A}_{\\text{near}}$ 为 $\\nabla c \\cdot \\mathbf{x} \\ge 0$ 的半圆，$\\mathcal{A}_{\\text{far}}$ 为 $\\nabla c \\cdot \\mathbf{x} < 0$ 的半圆。\n$$ B_{\\text{near}} = \\int_{\\mathcal{A}_{\\text{near}}} \\rho_b(\\mathbf{x}) \\, dA \\quad \\text{和} \\quad B_{\\text{far}} = \\int_{\\mathcal{A}_{\\text{far}}} \\rho_b(\\mathbf{x}) \\, dA $$\n差值为 $\\Delta B = B_{\\text{near}} - B_{\\text{far}}$。代入 $\\rho_b(\\mathbf{x})$ 的线性化表达式：\n$$ \\Delta B \\approx \\int_{\\mathcal{A}_{\\text{near}}} \\left( \\rho \\frac{c_0}{c_0+K_D} + \\rho \\frac{K_D}{(c_0+K_D)^2} (\\nabla c \\cdot \\mathbf{x}) \\right) dA - \\int_{\\mathcal{A}_{\\text{far}}} \\left( \\rho \\frac{c_0}{c_0+K_D} + \\rho \\frac{K_D}{(c_0+K_D)^2} (\\nabla c \\cdot \\mathbf{x}) \\right) dA $$\n被积函数中的第一项是一个常数。由于两个半圆的面积相等（$|\\mathcal{A}_{\\text{near}}| = |\\mathcal{A}_{\\text{far}}| = \\frac{1}{2}\\pi r^2$），由该常数项产生的贡献相互抵消。\n$$ \\Delta B \\approx \\rho \\frac{K_D}{(c_0+K_D)^2} \\left( \\int_{\\mathcal{A}_{\\text{near}}} (\\nabla c \\cdot \\mathbf{x}) \\, dA - \\int_{\\mathcal{A}_{\\text{far}}} (\\nabla c \\cdot \\mathbf{x}) \\, dA \\right) $$\n为了计算积分，我们建立一个坐标系。不失一般性，我们将 $x$ 轴与梯度矢量 $\\nabla c$ 对齐，因此 $\\nabla c = (|\\nabla c|, 0)$。那么，对于一个点 $\\mathbf{x} = (x, y)$，点积为 $\\nabla c \\cdot \\mathbf{x} = |\\nabla c| x$。圆盘由 $x^2+y^2 \\le r^2$ 定义。\n“近”侧对应于 $x \\ge 0$，“远”侧对应于 $x < 0$。$\\Delta B$ 的表达式变为：\n$$ \\Delta B \\approx \\rho \\frac{K_D |\\nabla c|}{(c_0+K_D)^2} \\left( \\int_{\\mathcal{A}_{\\text{near}}} x \\, dA - \\int_{\\mathcal{A}_{\\text{far}}} x \\, dA \\right) $$\n积分 $\\int_{\\mathcal{A}} x \\, dA$ 是面积一阶矩。根据对称性，$\\int_{\\mathcal{A}_{\\text{far}}} x \\, dA = - \\int_{\\mathcal{A}_{\\text{near}}} x \\, dA$。因此，括号中的项简化为 $2 \\int_{\\mathcal{A}_{\\text{near}}} x \\, dA$。\n现在我们计算这个在右半圆上的积分。使用极坐标会很方便，其中 $x = s\\cos\\phi$，$y=s\\sin\\phi$，面积元为 $dA = s \\, ds \\, d\\phi$。近侧的定义域为 $0 \\le s \\le r$ 和 $-\\frac{\\pi}{2} \\le \\phi \\le \\frac{\\pi}{2}$。\n$$ \\int_{\\mathcal{A}_{\\text{near}}} x \\, dA = \\int_{-\\pi/2}^{\\pi/2} \\int_0^r (s\\cos\\phi) \\, s \\, ds \\, d\\phi $$\n$$ = \\left( \\int_0^r s^2 \\, ds \\right) \\left( \\int_{-\\pi/2}^{\\pi/2} \\cos\\phi \\, d\\phi \\right) $$\n$$ = \\left[ \\frac{s^3}{3} \\right]_0^r \\left[ \\sin\\phi \\right]_{-\\pi/2}^{\\pi/2} $$\n$$ = \\left( \\frac{r^3}{3} \\right) \\left( \\sin(\\frac{\\pi}{2}) - \\sin(-\\frac{\\pi}{2}) \\right) = \\left( \\frac{r^3}{3} \\right) (1 - (-1)) = \\frac{2r^3}{3} $$\n因此，$\\Delta B$ 主表达式中的项为 $2 \\times \\frac{2r^3}{3} = \\frac{4r^3}{3}$。\n将此结果代回 $\\Delta B$ 的表达式中：\n$$ \\Delta B = \\rho \\frac{K_D |\\nabla c|}{(c_0+K_D)^2} \\left( \\frac{4r^3}{3} \\right) $$\n整理各项，得到结合受体数量之差的最终主导项表达式：\n$$ \\Delta B = \\frac{4 \\rho r^3 K_D |\\nabla c|}{3(c_0 + K_D)^2} $$\n这一结果量化了浅化学梯度如何转化为生长锥上结合受体的不对称分布，从而为细胞迁移提供方向性线索。", "answer": "$$ \\boxed{\\frac{4 \\rho r^3 K_D |\\nabla c|}{3(c_0 + K_D)^2}} $$", "id": "2699100"}, {"introduction": "单个轴突的引导决策最终如何汇集成一个功能性的、高度有序的神经回路？本练习将带您从单个分子的相互作用跃升到系统级的神经系统构建，通过编程模拟来探索基于化学亲和力假说的拓扑图形成。您将亲手实现梯度匹配规则，并观察改变引导分子梯度形态如何影响神经连接的精确性 [@problem_id:2699070]，从而深入理解从分子指令到宏观神经结构的基本原理。", "problem": "考虑一个一维拓扑映射问题，其灵感来源于视网膜拓扑图形成过程中的 Eph 受体（EphA）和 ephrinA 梯度。令视网膜轴突位置由 $x \\in [0,1]$ 索引，目标位置由 $X \\in [0,1]$ 索引。假设沿视网膜轴的 EphA 受体水平是连续严格单调函数 $E(x)$，而沿靶标轴的 ephrinA 配体水平是连续严格单调函数 $L(X)$。生长锥的化学趋向性决策由局部失配成本 $C(x,X) = \\left(E(x) - L(X)\\right)^{2}$ 建模，这与化学亲和性原理以及排斥性的 EphA–ephrinA 信号传导相一致。以下任务要求您基于这些定义，推导出一个基于原理的梯度匹配规则，并模拟在 ephrinA 梯度变化下的映射扭曲。\n从第一性原理出发，且不援引任何目标公式，推导以下内容：\n1) 绝对梯度匹配规则：对于每个轴突位置 $x$，定义匹配的目标 $X_{\\mathrm{abs}}(x)$，该目标使得 $C(x,X)$ 在 $X \\in [0,1]$ 上最小化。\n2) 相对梯度匹配规则：生物学读出通常依赖于相对水平。定义仿射归一化梯度 $\\tilde{E}(x) = \\dfrac{E(x) - E_{\\min}}{E_{\\max} - E_{\\min}}$ 和 $\\tilde{L}(X) = \\dfrac{L(X) - L_{\\min}}{L_{\\max} - L_{\\min}}$，其中 $E_{\\min} = \\min_{x \\in [0,1]} E(x)$，$E_{\\max} = \\max_{x \\in [0,1]} E(x)$，$L_{\\min} = \\min_{X \\in [0,1]} L(X)$，以及 $L_{\\max} = \\max_{X \\in [0,1]} L(X)$。对于每个轴突位置 $x$，定义 $X_{\\mathrm{rel}}(x)$，该目标使得 $\\left(\\tilde{E}(x) - \\tilde{L}(X)\\right)^{2}$ 在 $X \\in [0,1]$ 上最小化。\n您的程序必须通过插值求逆的方法，对任意单调梯度在数值上实现这两种规则，并在所请求的受体水平超出靶标配体范围时，将结果钳位到边界。然后，通过均方根误差来量化与完美拓扑 $X = x$ 相比的映射扭曲\n$$R = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N} \\left( \\hat{X}(x_{i}) - x_{i} \\right)^{2}},$$\n其中 $\\{x_{i}\\}_{i=1}^{N}$ 是在 $[0,1]$ 区间内 $N$ 个均匀分布的视网膜位置，而 $\\hat{X}$ 是 $X_{\\mathrm{abs}}$ 或 $X_{\\mathrm{rel}}$。\n模拟协议和约束：\n- 使用 $[0,1]$ 区间内 $N = 1001$ 个均匀间隔的点来计算 $R$ 和评估 $E(x)$。\n- 使用 $[0,1]$ 区间内 $M = 10001$ 个均匀间隔点的密集网格来制表 $L(X)$，并为绝对和相对匹配执行单调插值求逆。\n- 对于任何超出制表范围的值，相应地将逆运算结果钳位到 $X = 0$ 或 $X = 1$。\n- 每个测试用例返回两个值：绝对规则扭曲 $R_{\\mathrm{abs}}$ 和相对规则扭曲 $R_{\\mathrm{rel}}$。\n测试套件：\n使用以下参数化族群实现 $E(x)$ 和 $L(X)$。线性梯度：$E(x) = a_{E}\\,x + b_{E}$ 和 $L(X) = a_{L}\\,X + b_{L}$，其中 $a_{E} > 0$ 和 $a_{L} > 0$。指数-S型梯度：$G(z;\\alpha,\\beta,k) = \\alpha + \\beta \\,\\dfrac{e^{k z} - 1}{e^{k} - 1}$，其中 $z \\in [0,1]$，$\\beta > 0$ 且 $k > 0$。使用以下 $5$ 个测试用例（每个用例产生两个输出，$R_{\\mathrm{abs}}$ 和 $R_{\\mathrm{rel}}$）：\n- 用例 1（基线线性匹配）：$E(x) = 1.0 \\cdot x + 0.0$，$L(X) = 1.0 \\cdot X + 0.0$。\n- 用例 2（更陡峭的目标配体）：$E(x) = 1.0 \\cdot x + 0.0$，$L(X) = 2.0 \\cdot X + 0.0$。\n- 用例 3（更平缓的目标配体）：$E(x) = 1.0 \\cdot x + 0.0$，$L(X) = 0.5 \\cdot X + 0.0$。\n- 用例 4（非线性目标配体）：$E(x) = 1.0 \\cdot x + 0.0$，$L(X) = G(X;\\alpha=0.0,\\beta=1.0,k=3.0)$。\n- 用例 5（相对水平不变性测试）：$E(x) = G(x;\\alpha=0.0,\\beta=0.8,k=3.0)$，$L(X) = G(X;\\alpha=0.0,\\beta=1.0,k=3.0)$。\n数值和输出要求：\n- 按上述定义为每个用例计算 $R_{\\mathrm{abs}}$ 和 $R_{\\mathrm{rel}}$。\n- 报告所有结果，四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表包含 $10$ 个结果，顺序为 $[R_{\\mathrm{abs},1},R_{\\mathrm{rel},1},R_{\\mathrm{abs},2},R_{\\mathrm{rel},2},R_{\\mathrm{abs},3},R_{\\mathrm{rel},3},R_{\\mathrm{abs},4},R_{\\mathrm{rel},4},R_{\\mathrm{abs},5},R_{\\mathrm{rel},5}]$。\n不需要物理单位。不使用角度。不得使用百分比；任何类似比率的量都应保留为无量纲小数。该问题已用数学术语完全指定，并且可以通过在给定测试套件下实现基于插值的单调函数求逆来解决。", "solution": "在尝试任何解决方案之前，需对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **定义域**：视网膜轴突位置 $x \\in [0,1]$，目标位置 $X \\in [0,1]$。\n- **受体/配体函数**：EphA 受体水平 $E(x)$，一个连续严格单调函数。ephrinA 配体水平 $L(X)$，一个连续严格单调函数。\n- **成本函数**：失配成本 $C(x,X) = \\left(E(x) - L(X)\\right)^{2}$。\n- **绝对匹配规则**：找到 $X_{\\mathrm{abs}}(x)$，使得 $C(x,X)$ 在 $X \\in [0,1]$ 上最小化。\n- **相对匹配规则**：定义仿射归一化梯度 $\\tilde{E}(x) = \\frac{E(x) - E_{\\min}}{E_{\\max} - E_{\\min}}$ 和 $\\tilde{L}(X) = \\frac{L(X) - L_{\\min}}{L_{\\max} - L_{\\min}}$，其中 $E_{\\min} = \\min_{x} E(x)$，$E_{\\max} = \\max_{x} E(x)$，$L_{\\min} = \\min_{X} L(X)$，以及 $L_{\\max} = \\max_{X} L(X)$。找到 $X_{\\mathrm{rel}}(x)$，使得 $\\left(\\tilde{E}(x) - \\tilde{L}(X)\\right)^{2}$ 在 $X \\in [0,1]$ 上最小化。\n- **扭曲度量**：均方根误差 $R = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N} \\left( \\hat{X}(x_{i}) - x_{i} \\right)^{2}}$，其中 $\\hat{X}$ 是 $X_{\\mathrm{abs}}$ 或 $X_{\\mathrm{rel}}$。\n- **数值参数**：\n    - $N = 1001$ 个均匀分布的点用于视网膜位置 $x_i$。\n    - $M = 10001$ 个均匀分布的点用于目标位置 $X_j$ 以进行插值。\n- **边界条件**：如果受体水平超出目标的配体范围，则将逆运算结果钳位到 $X=0$ 或 $X=1$。\n- **函数族群**：\n    - 线性：$E(x) = a_{E}\\,x + b_{E}$，$L(X) = a_{L}\\,X + b_{L}$，其中 $a_{E} > 0, a_{L} > 0$。\n    - 指数-S型：$G(z;\\alpha,\\beta,k) = \\alpha + \\beta \\,\\dfrac{e^{k z} - 1}{e^{k} - 1}$，其中 $\\beta > 0, k > 0$。\n- **测试用例**：\n    - 用例 1：$E(x) = 1.0 \\cdot x + 0.0$，$L(X) = 1.0 \\cdot X + 0.0$。\n    - 用例 2：$E(x) = 1.0 \\cdot x + 0.0$，$L(X) = 2.0 \\cdot X + 0.0$。\n    - 用例 3：$E(x) = 1.0 \\cdot x + 0.0$，$L(X) = 0.5 \\cdot X + 0.0$。\n    - 用例 4：$E(x) = 1.0 \\cdot x + 0.0$，$L(X) = G(X; \\alpha=0.0, \\beta=1.0, k=3.0)$。\n    - 用例 5：$E(x) = G(x; \\alpha=0.0, \\beta=0.8, k=3.0)$，$L(X) = G(X; \\alpha=0.0, \\beta=1.0, k=3.0)$。\n- **输出**：包含 $10$ 个逗号分隔值的单行，格式为 $[R_{\\mathrm{abs},1}, R_{\\mathrm{rel},1}, \\dots, R_{\\mathrm{abs},5}, R_{\\mathrm{rel},5}]$，四舍五入到 $6$ 位小数。\n\n### 步骤 2：使用提取的已知条件进行验证\n这是一个定义明确的理论神经科学计算练习。\n- **科学基础**：该模型基于已确立的用于拓扑图形成的化学亲和性假说，特别是使用 Eph/ephrin 信号梯度，这是发育神经科学中的一个典型例子。成本函数代表了一种貌似合理的排斥性引导的生物学机制。\n- **适定性**：该问题的结构保证了其拥有唯一且稳定的解。函数 $E(x)$ 和 $L(X)$ 的严格单调性保证了唯一反函数的存在，从而为每个匹配规则带来唯一的映射。数值过程也定义明确。\n- **客观性**：问题以精确的数学语言陈述，没有歧义或主观论断。\n- **完整性**：所有必要的函数、参数、数值方法和测试用例都已明确提供。\n- **一致性**：内部没有矛盾。数值约束是可行的。\n\n### 步骤 3：结论与行动\n问题有效。将提供解决方案。\n\n### 匹配规则的推导与解题策略\n\n该问题要求推导两种梯度匹配规则。两者都基于最小化平方差成本函数。\n\n**1. 绝对梯度匹配规则**\n\n对于每个位于位置 $x$ 的视网膜轴突，我们寻求目标位置 $X_{\\mathrm{abs}}(x)$，使得成本函数 $C(x,X)$ 最小化：\n$$\nX_{\\mathrm{abs}}(x) = \\arg\\min_{X \\in [0,1]} C(x,X) = \\arg\\min_{X \\in [0,1]} \\left(E(x) - L(X)\\right)^{2}\n$$\n函数 $f(y) = y^2$ 在 $y=0$ 处有全局最小值。因此，当差值 $E(x) - L(X)$ 尽可能接近零时，成本 $C(x,X)$ 被最小化。如果存在一个 $X$ 的值使得 $L(X) = E(x)$，这将是全局最小值。由于函数 $L(X)$ 在紧区间 $[0,1]$ 上被定义为连续且严格单调的，其值域 $[L_{\\min}, L_{\\max}]$ 也是一个紧区间。\n- 如果受体水平 $E(x)$ 落在配体水平的值域内，即 $E(x) \\in [L_{\\min}, L_{\\max}]$，那么根据介值定理，至少存在一个 $X \\in [0,1]$ 使得 $L(X) = E(x)$。因为 $L(X)$ 是严格单调的，所以这个 $X$ 是唯一的。我们可以通过对 $E(x)$ 应用 $L$ 的反函数（表示为 $L^{-1}$）来找到它。\n- 如果 $E(x)$ 落在 $L(X)$ 的值域之外，即 $E(x) < L_{\\min}$ 或 $E(x) > L_{\\max}$，那么在 $X \\in [0,1]$ 上，$(E(x) - L(X))^2$ 的最小值将出现在 $L(X)$ 值域的边界上。如果 $E(x) < L_{\\min}$，则在 $L(X) = L_{\\min} = L(0)$ 处达到最小距离（假设 $L$ 是递增的）。如果 $E(x) > L_{\\max}$，则在 $L(X) = L_{\\max} = L(1)$ 处达到。这对应于将映射进行钳位处理。\n\n因此，绝对梯度匹配规则规定，对于给定的轴突 $x$，其目标位置 $X_{\\mathrm{abs}}(x)$ 由水平匹配条件确定：\n$$\nL(X_{\\mathrm{abs}}(x)) = E(x) \\quad \\implies \\quad X_{\\mathrm{abs}}(x) = L^{-1}(E(x))\n$$\n其中，对于值域之外的 $E(x)$ 值，$L^{-1}$ 的应用包括钳位到边界 $[0,1]$。\n\n**2. 相对梯度匹配规则**\n\n此规则作用于受体和配体梯度的仿射归一化版本。归一化梯度为：\n$$\n\\tilde{E}(x) = \\frac{E(x) - E_{\\min}}{E_{\\max} - E_{\\min}} \\quad \\text{和} \\quad \\tilde{L}(X) = \\frac{L(X) - L_{\\min}}{L_{\\max} - L_{\\min}}\n$$\n$\\tilde{E}(x)$ 和 $\\tilde{L}(X)$ 都被映射到 $[0,1]$ 范围内。目标位置 $X_{\\mathrm{rel}}(x)$ 最小化基于这些归一化量的成本：\n$$\nX_{\\mathrm{rel}}(x) = \\arg\\min_{X \\in [0,1]} \\left(\\tilde{E}(x) - \\tilde{L}(X)\\right)^{2}\n$$\n根据与绝对规则相同的逻辑，当归一化梯度的水平匹配时，达到最小成本：\n$$\n\\tilde{L}(X_{\\mathrm{rel}}(x)) = \\tilde{E}(x)\n$$\n由于 $L(X)$ 是严格单调的，并且用于创建 $\\tilde{L}(X)$ 的仿射变换是保序的，所以 $\\tilde{L}(X)$ 也是严格单调的。因此，它拥有一个唯一的反函数 $\\tilde{L}^{-1}$。最终的映射是：\n$$\nX_{\\mathrm{rel}}(x) = \\tilde{L}^{-1}(\\tilde{E}(x))\n$$\n由于 $\\tilde{E}(x)$ 通过构造总是在 $[0,1]$ 区间内，并且 $\\tilde{L}(X)$ 的值域也是 $[0,1]$，因此原则上不需要钳位，因为总能在定义域内找到匹配。\n\n**3. 数值实现**\n\n推导为映射提供了一种解析形式 $X = f^{-1}(y)$，这需要找到函数 $f$ 的反函数。解析地求给定的指数-S型函数的反函数是可能的，但需要一种通用的数值方法。问题指定了通过插值求逆。\n为了数值计算 $X(x) = L^{-1}(E(x))$：\n1. 在 $[0,1]$ 中创建 $M$ 个点的密集网格 $\\{X_j\\}_{j=1}^M$。\n2. 计算相应的配体水平 $\\{L(X_j)\\}_{j=1}^M$。令此数组为 `L_vals`。\n3. 数组对 `(L_vals, X_grid)` 提供了反函数 $L^{-1}$ 的表格表示。\n4. 对于来自视网膜网格的每个视网膜位置 $x_i$，计算受体水平 $e_i = E(x_i)$。\n5. 使用一维插值来找到与每个 $e_i$ 对应的 $X$ 值。具体来说，我们在 `L_vals` 数组中查找 $e_i$，并从 `X_grid` 中找到相应的 $X_j$。这计算出 $X_{\\mathrm{abs}}(x_i) \\approx L^{-1}(E(x_i))$。对于超出范围的值进行钳位是数值插值程序的标准功能。\n\n对于相对匹配，遵循相同的过程，使用制表的归一化函数 $\\tilde{L}^{-1}$ 和归一化的受体水平 $\\tilde{E}(x_i)$。\n\n**4. 扭曲计算**\n\n映射扭曲通过计算出的目标位置 $\\hat{X}(x_i)$ 和理想拓扑位置 $x_i$ 之间的均方根误差 (RMSE) 进行量化：\n$$\nR = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N} \\left( \\hat{X}(x_{i}) - x_{i} \\right)^{2}}\n$$\n对每个测试用例的 $X_{\\mathrm{abs}}$ 和 $X_{\\mathrm{rel}}$ 都执行此计算。实现将遵循这些步骤来计算所需的 10 个值。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the retinotopic mapping problem for the given test cases.\n    \"\"\"\n    \n    # Simulation parameters\n    N = 1001  # Number of retinal grid points\n    M = 10001 # Number of target grid points for interpolation\n\n    x_grid = np.linspace(0, 1, N)\n    X_grid = np.linspace(0, 1, M)\n\n    def linear_grad(z, a, b):\n        \"\"\"Computes a linear gradient.\"\"\"\n        return a * z + b\n\n    def exp_sigmoid_grad(z, alpha, beta, k):\n        \"\"\"Computes an exponential-sigmoid gradient.\"\"\"\n        if k == 0:\n            # Handle the limit k->0, which corresponds to linear gradient\n            return alpha + beta * z\n        return alpha + beta * (np.exp(k * z) - 1) / (np.exp(k) - 1)\n\n    # Test suite definition\n    test_cases = [\n        # Case 1: baseline linear match\n        {'E_func': linear_grad, 'E_params': (1.0, 0.0), \n         'L_func': linear_grad, 'L_params': (1.0, 0.0)},\n        # Case 2: steeper target ligand\n        {'E_func': linear_grad, 'E_params': (1.0, 0.0), \n         'L_func': linear_grad, 'L_params': (2.0, 0.0)},\n        # Case 3: shallower target ligand\n        {'E_func': linear_grad, 'E_params': (1.0, 0.0), \n         'L_func': linear_grad, 'L_params': (0.5, 0.0)},\n        # Case 4: nonlinear target ligand\n        {'E_func': linear_grad, 'E_params': (1.0, 0.0),\n         'L_func': exp_sigmoid_grad, 'L_params': (0.0, 1.0, 3.0)},\n        # Case 5: relative-level invariance test\n        {'E_func': exp_sigmoid_grad, 'E_params': (0.0, 0.8, 3.0),\n         'L_func': exp_sigmoid_grad, 'L_params': (0.0, 1.0, 3.0)}\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # 1. Evaluate E(x) on the retinal grid\n        E_vals = case['E_func'](x_grid, *case['E_params'])\n        \n        # 2. Evaluate L(X) on the dense target grid for interpolation\n        L_vals = case['L_func'](X_grid, *case['L_params'])\n        \n        # --- Absolute Gradient Matching ---\n        # 3. Find target positions X_abs by inverting L(X) via interpolation\n        # np.interp performs clamping automatically for values outside the L_vals range\n        X_abs = np.interp(E_vals, L_vals, X_grid)\n        \n        # 4. Calculate absolute RMSE\n        R_abs = np.sqrt(np.mean((X_abs - x_grid)**2))\n        \n        # --- Relative Gradient Matching ---\n        # 5. Normalize E(x) and L(X)\n        E_min, E_max = E_vals[0], E_vals[-1]\n        L_min, L_max = L_vals[0], L_vals[-1]\n        \n        # Avoid division by zero if gradient is flat (not the case here but good practice)\n        E_range = E_max - E_min if E_max > E_min else 1.0\n        L_range = L_max - L_min if L_max > L_min else 1.0\n        \n        tilde_E_vals = (E_vals - E_min) / E_range\n        tilde_L_vals = (L_vals - L_min) / L_range\n        \n        # 6. Find target positions X_rel by inverting tilde_L(X) via interpolation\n        #tilde_L_vals is guaranteed to be monotonic, as it's an affine transform of L_vals.\n        X_rel = np.interp(tilde_E_vals, tilde_L_vals, X_grid)\n        \n        # 7. Calculate relative RMSE\n        R_rel = np.sqrt(np.mean((X_rel - x_grid)**2))\n\n        # 8. Append results for the current case\n        results.append(round(R_abs, 6))\n        results.append(round(R_rel, 6))\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2699070"}]}