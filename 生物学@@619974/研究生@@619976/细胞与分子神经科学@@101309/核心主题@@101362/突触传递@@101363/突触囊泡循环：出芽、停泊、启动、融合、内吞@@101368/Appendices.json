{"hands_on_practices": [{"introduction": "理解神经递质释放的一个核心问题是，在连续的神经活动中，即时可释放囊泡池（RRP）是如何被消耗的。本练习将引导你从基本概率论原理出发，建立一个简化的囊泡池消耗模型，用于计算在一连串动作电位后预期被释放的囊泡数量 [@problem_id:2767720]。这个推导过程将为你提供一个关于囊泡耗竭性突触抑制的坚实定量基础。", "problem": "一个中枢突触在时间 $t=0$ 时包含一个大小为 $R_0$ 的易释放池 (RRP)，池中有已启动的突触囊泡。一个突触前动作电位序列以频率 $f$ 发放，包含 $N$ 个脉冲，持续时间为 $T = N/f$。假设以下源于突触囊泡循环的、有生物学基础的条件：(i) RRP 中的囊泡处于启动状态，可在动作电位到达时发生融合；(ii) 每个动作电位以概率 $p$ 引起任何给定已启动囊泡的融合，该概率对于所有脉冲和囊泡都是恒定的（$p$ 没有短期易化或抑制）；(iii) 融合后，囊泡从 RRP 中移除，在该脉冲序列中不能再次融合；(iv) 在脉冲序列期间，储备池没有通过停泊和启动来补充囊泡（在时间尺度 $T$ 上，内吞和再启动可忽略不计）。仅使用概率论的第一性原理和这些关于突触囊泡循环的机制性假设，推导 RRP 在 $N$ 个脉冲后的期望耗竭量。请将您的最终答案表示为关于 $R_0$、$p$ 和 $N$ 的单一闭式解析表达式，并以囊泡为单位报告。无需进行数值计算。", "solution": "问题陈述已通过验证，并被认为是有效的。它具有科学依据、良定、客观且内部一致。它代表了一个突触囊泡池动力学的标准简化模型，这是细胞和分子神经科学的一个核心课题。因此，我们可以进行形式推导。\n\n我们的目标是推导在 $N$ 个动作电位序列后，易释放池 (RRP) 中突触囊泡的期望耗竭量。设 RRP 的初始大小为 $R_0$。总耗竭量，我们用随机变量 $D$ 表示，是在 $N$ 个脉冲的序列中发生融合的囊泡总数。我们旨在计算 $D$ 的期望，记为 $E[D]$。\n\n让我们考虑最初存在于 RRP 中的 $R_0$ 个囊泡。我们可以将这些囊泡从 $i=1$ 标记到 $i=R_0$。对于每个囊泡 $i$，我们定义一个指示随机变量 $F_i$ 如下：\n$$\nF_i =\n\\begin{cases}\n1 & \\text{if vesicle } i \\text{ fuses during the } N \\text{ spikes} \\\\\n0 & \\text{if vesicle } i \\text{ does not fuse during the } N \\text{ spikes}\n\\end{cases}\n$$\n融合囊泡的总数 $D$ 是初始池中所有囊泡的这些指示变量之和：\n$$ D = \\sum_{i=1}^{R_0} F_i $$\n根据期望的线性性质，期望总耗竭量是各个指示变量的期望之和：\n$$ E[D] = E\\left[\\sum_{i=1}^{R_0} F_i\\right] = \\sum_{i=1}^{R_0} E[F_i] $$\n指示随机变量的期望等于其所指示事件的概率。因此，$E[F_i] = P(F_i=1)$，其中 $P(F_i=1)$ 是囊泡 $i$ 在 $N$ 个脉冲序列中的某个时刻融合的概率。\n\n根据问题的假设 (ii)，对于任何给定的已启动囊泡和每个动作电位，融合概率 $p$ 是恒定的。在此模型中，RRP 中的所有囊泡在功能上都是相同的。因此，在脉冲序列中任何单个囊泡 $i$ 的融合概率 $P(F_i=1)$ 对于所有 $i \\in \\{1, 2, \\dots, R_0\\}$ 都是相同的。我们把这个共同的概率记为 $P_{\\text{fuse}}$。期望耗竭量的表达式简化为：\n$$ E[D] = \\sum_{i=1}^{R_0} P_{\\text{fuse}} = R_0 \\cdot P_{\\text{fuse}} $$\n我们的任务现在简化为计算 $P_{\\text{fuse}}$。更直接的方法是首先计算其互补概率 $P_{\\text{survive}}$，即单个囊泡在整个 $N$ 个脉冲序列中*不*融合的概率。如果一个囊泡没有存活下来，它就会融合。因此，$P_{\\text{fuse}} = 1 - P_{\\text{survive}}$。\n\n让我们考虑初始 RRP 中的单个囊泡。在第一个脉冲时，该囊泡融合的概率是 $p$。它不融合的概率是 $1-p$。\n如果囊泡在第一个脉冲时没有融合，它将保留在已启动的 RRP 中。在第二个脉冲时，它融合的概率仍然是 $p$，而它在这次脉冲中存活的概率也仍然是 $1-p$。这个过程对所有 $N$ 个脉冲重复进行。\n\n一个囊泡在整个 $N$ 个脉冲序列中存活下来，当且仅当它在第一个脉冲中存活，并且在第二个脉冲中存活，...，并且在第 $N$ 个脉冲中存活。对于一个囊泡来说，在每个脉冲时的结果是一个独立事件，条件是它存活到那个时刻。一个囊泡在整个脉冲序列中存活的概率是它在每个单独脉冲中存活的概率的乘积：\n$$ P_{\\text{survive}} = \\underbrace{(1-p) \\times (1-p) \\times \\dots \\times (1-p)}_{N \\text{ times}} = (1-p)^N $$\n现在，我们可以求出囊泡在脉冲序列中某个时刻融合的概率 $P_{\\text{fuse}}$。这个事件是囊泡在整个序列中存活下来的补事件。\n$$ P_{\\text{fuse}} = 1 - P_{\\text{survive}} = 1 - (1-p)^N $$\n最后，我们将 $P_{\\text{fuse}}$ 的这个表达式代回我们的期望耗竭量 $E[D]$ 的方程中：\n$$ E[D] = R_0 \\cdot \\left(1 - (1-p)^N\\right) $$\n这就是 RRP 期望耗竭量的闭式解析表达式，单位为囊泡。它是直接从概率论的第一性原理和所提供的突触囊泡循环模型的明确假设推导出来的。", "answer": "$$\n\\boxed{R_0 \\left(1 - (1-p)^N\\right)}\n$$", "id": "2767720"}, {"introduction": "理论模型如何与实验数据分析相结合，是神经科学研究中的一个关键环节。本练习将向你介绍一种经典的累积EPSC分析方法，该方法广泛用于从高频刺激下的电生理记录中估算突触的关键参数，如即时可释放囊泡池（RRP）的大小和初始释放概率$p$ [@problem_id:2767708]。掌握这种技术对于定量解读突触传递的实验数据至关重要，它使我们能够从宏观的电流信号中窥探微观的囊泡动力学。", "problem": "估算兴奋性突触中易释放囊泡池（RRP）的大小和初始释放概率的一种核心方法，是在高频刺激期间进行累积兴奋性突触后电流（EPSC）分析。考虑一个突触，用一串频率为 $100\\,\\mathrm{Hz}$ 的 $50$ 次刺激进行刺激，同时通过药理学方法将突触后受体的饱和和脱敏降至最低，并保持驱动力恒定。对每次刺激的EPSC进行积分，以获得每次EPSC的电荷，对于第 $i$ 次EPSC，记为 $Q_i$。累积电荷定义为 $C(N) = \\sum_{i=1}^{N} Q_i$。对 $C(N)$ 与刺激次数 $N$ 的关系在晚期稳定抑制阶段（刺激 $26$ 到 $50$）进行线性回归，得到一条斜率为 $m = 0.210\\,\\mathrm{pC/stimulus}$、反向外推的y轴截距为 $b = 5.40\\,\\mathrm{pC}$ 的直线。测得第一次EPSC的电荷为 $Q_1 = 1.52\\,\\mathrm{pC}$。每个囊泡的平均量子电荷被独立校准为 $q = 0.270\\,\\mathrm{pC/vesicle}$。\n\n从量子假说和单个均一易释放囊泡池的质量平衡出发，通过推导累积图的晚期线性区与刺激序列开始时RRP之间的关系，来论证高频刺激下反向外推法的有效性。在您的推理中明确使用以下模型假设：\n\n- 在刺激序列开始时，突触包含一个由 $N$ 个囊泡组成的均一易释放囊泡池，每个囊泡以单次刺激释放概率 $p$ 和量子电荷 $q$ 独立释放，因此 $Q_i \\approx p q R_i$，其中 $R_i$ 是在第 $i$ 次刺激前瞬间可用的囊泡数量。\n- 在刺激之间，囊泡补充到易释放囊泡池中，在高频刺激下的晚期阶段，其平均速率变为恒定。\n- 在晚期阶段，每次刺激的释放量等于每次刺激的补充量（稳态），并且累积图变为线性，其斜率等于每次刺激的补充贡献。\n- 在所选频率下，晚期阶段刺激前瞬间易释放囊泡池的任何稳态残留占据量与刺激序列开始时的囊泡池相比很小，这使得标准的反向外推近似法得以应用。\n\n基于这些前提：\n\n1) 推导为什么晚期线性拟合的反向外推y轴截距能近似于刺激序列开始时易释放囊泡池中最初包含的总电荷。\n\n2) 根据给定的回归参数和 $q$ 计算易释放囊泡池的大小（以囊泡为单位）。\n\n3) 根据 $Q_1$ 和估算的RRP电荷计算初始单次刺激释放概率 $p$。\n\n4) 根据斜率和 $q$ 计算稳态补充速率（以囊泡/秒为单位）。\n\n以囊泡为单位表示易释放囊泡池的大小。将您最终报告的答案四舍五入至三位有效数字。最终答案框内不要包含任何单位；但是，对于所有中间结果，请使用适当的物理单位（例如，$\\mathrm{pC}$、$\\mathrm{vesicles}$、$\\mathrm{vesicles/s}$）。对于 $p$，请以小数表示（而非百分比）。", "solution": "该问题是有效的，因为它科学地基于突触生理学原理，问题阐述清晰，具有足够的数据和明确的假设，并且陈述客观。我们可以进行正式求解。\n\n该问题要求进行推导以论证用于估算突触囊泡易释放囊泡池（RRP）大小的反向外推法的有效性，然后计算几个关键的突触参数。\n\n1) 反向外推法有效性的推导。\n\n设 $N_0$ 为刺激序列开始时（$t=0$）易释放囊泡池（RRP）中的初始囊泡数量。设 $p$ 为单个动作电位（刺激）到达时RRP中每个囊泡的释放概率。设 $q$ 为量子电荷，即单个囊泡融合所对应的电荷。设 $r$ 为一个刺激间隔期间补充到RRP中的囊泡数量。根据为此分析简化的标准模型，我们假设在高频刺激序列中 $p$ 和 $r$ 是恒定的。\n\n设 $R_i$ 为第 $i$ 次刺激前瞬间RRP中的囊泡数量。初始条件为 $R_1 = N_0$。\n第 $i$ 次刺激释放的电荷 $Q_i$ 由量子假说给出：\n$$ Q_i = q p R_i $$\n在第 $i$ 次和第 $i+1$ 次刺激之间，RRP因释放而耗竭，又因补充而再填充。下一次刺激前囊泡池中的囊泡数量 $R_{i+1}$ 由质量平衡差分方程描述：\n$$ R_{i+1} = R_i - pR_i + r = (1-p)R_i + r $$\n这是一个线性一阶非齐次差分方程。其解在初始条件 $R_1 = N_0$ 下为：\n$$ R_i = (N_0 - \\frac{r}{p})(1-p)^{i-1} + \\frac{r}{p} $$\n将此代入 $Q_i$ 的方程中：\n$$ Q_i = qp \\left[ (N_0 - \\frac{r}{p})(1-p)^{i-1} + \\frac{r}{p} \\right] = qp(N_0 - \\frac{r}{p})(1-p)^{i-1} + qr $$\n$N$ 次刺激后的累积电荷 $C(N)$ 是各个EPSC电荷的总和：\n$$ C(N) = \\sum_{i=1}^{N} Q_i = \\sum_{i=1}^{N} \\left[ qp(N_0 - \\frac{r}{p})(1-p)^{i-1} + qr \\right] $$\n这个和可以分为两部分：\n$$ C(N) = qp(N_0 - \\frac{r}{p}) \\sum_{i=1}^{N} (1-p)^{i-1} + \\sum_{i=1}^{N} qr $$\n第一个和是一个几何级数。求和可得：\n$$ C(N) = qp(N_0 - \\frac{r}{p}) \\frac{1-(1-p)^N}{1-(1-p)} + Nqr $$\n$$ C(N) = q(N_0 - \\frac{r}{p})[1-(1-p)^N] + Nqr $$\n问题指出，对 $C(N)$ 与 $N$ 的关系图的晚期稳定抑制阶段进行线性回归。在此阶段，对于大的 $N$，由于 $0 < p < 1$，项 $(1-p)^N$ 趋近于零。因此，$C(N)$ 的方程趋近于一条线性渐近线：\n$$ C_{asym}(N) = \\lim_{N\\to\\infty, (1-p)^N\\to 0} C(N) \\approx q(N_0 - \\frac{r}{p})(1) + Nqr $$\n$$ C_{asym}(N) = (qr)N + q(N_0 - \\frac{r}{p}) $$\n这是一条直线方程 $y = mx+b$，其中刺激次数 $N$ 是自变量。通过比较各项，我们可以确定这条渐近线的斜率和y轴截距：\n- 斜率为 $m = qr$。这是稳态下每个刺激间隔内补充然后释放的电荷。\n- y轴截距为 $b = q(N_0 - \\frac{r}{p})$。\n\n项 $R_{ss} = r/p$ 代表了RRP中稳态的囊泡数量（此时释放量 $pR_{ss}$ 与补充量 $r$ 相平衡）。因此，截距可以写为 $b = qN_0 - qR_{ss}$。这意味着反向外推的截距是初始RRP电荷（$qN_0$）减去稳态残留池电荷（$qR_{ss}$）的估计值。\n\n问题提供了一个关键的模型假设：“易释放囊泡池的任何稳态残留占据量……与刺激序列开始时的囊泡池相比很小”。这可以表示为 $R_{ss} \\ll N_0$。因此，稳态池的电荷与初始池的电荷相比可以忽略不计：$qR_{ss} \\ll qN_0$。\n在这个特定近似下，截距 $b$ 成为初始RRP总电荷的直接估计：\n$$ b = qN_0 - qR_{ss} \\approx qN_0 $$\n这样就完成了论证。只要稳态池的大小可以忽略不计，反向外推的y轴截距就提供了初始RRP总电荷的估计值。\n\n2) 计算易释放囊泡池的大小（$N_0$）（以囊泡为单位）。\n\n从推导出的近似式 $b \\approx qN_0$，我们可以计算RRP的大小 $N_0$。\n已知：$b = 5.40\\,\\mathrm{pC}$ 和 $q = 0.270\\,\\mathrm{pC/vesicle}$。\n$$ N_0 \\approx \\frac{b}{q} = \\frac{5.40\\,\\mathrm{pC}}{0.270\\,\\mathrm{pC/vesicle}} = 20\\,\\mathrm{vesicles} $$\n问题要求将最终答案四舍五入至三位有效数字。\n\n3) 计算初始单次刺激释放概率 ($p$)。\n\n第一次EPSC的电荷由 $Q_1 = q p R_1$ 给出。由于 $R_1=N_0$，我们有 $Q_1 = q p N_0 = p(qN_0)$。使用近似式 $qN_0 \\approx b$，我们得到 $Q_1 \\approx p b$。我们可以解出 $p$：\n$$ p \\approx \\frac{Q_1}{b} $$\n已知：$Q_1 = 1.52\\,\\mathrm{pC}$ 和 $b = 5.40\\,\\mathrm{pC}$。\n$$ p \\approx \\frac{1.52\\,\\mathrm{pC}}{5.40\\,\\mathrm{pC}} \\approx 0.28148... $$\n所以，初始释放概率约为 $0.281$。\n\n4) 计算稳态补充速率（以囊泡/秒为单位）。\n\n根据第 (1) 部分的推导，晚期线性拟合的斜率为 $m = qr$，其中 $r$ 是每个刺激间隔内的补充速率（以囊泡/刺激间隔为单位）。\n已知：$m = 0.210\\,\\mathrm{pC/stimulus}$ 和 $q = 0.270\\,\\mathrm{pC/vesicle}$。\n$$ r = \\frac{m}{q} = \\frac{0.210\\,\\mathrm{pC/stimulus}}{0.270\\,\\mathrm{pC/vesicle}} = \\frac{7}{9} \\approx 0.778\\,\\mathrm{vesicles/stimulus} $$\n刺激频率为 $f = 100\\,\\mathrm{Hz}$。每秒的补充速率 $r_{rate}$ 是每个间隔的速率乘以每秒的间隔数（$f$）。\n$$ r_{rate} = r \\times f = (\\frac{7}{9}\\,\\mathrm{vesicles/interval}) \\times (100\\,\\mathrm{intervals/s}) = \\frac{700}{9}\\,\\mathrm{vesicles/s} \\approx 77.8\\,\\mathrm{vesicles/s} $$\n\n问题要求以囊泡为单位计算易释放囊泡池的大小，并将最终答案四舍五入至三位有效数字，作为最终答案。\n$N_0 = 20$。表示为三位有效数字是 $20.0$。", "answer": "$$\n\\boxed{20.0}\n$$", "id": "2767708"}, {"introduction": "现代成像技术使我们能够实时观察囊泡循环的完整过程，但这需要复杂的动力学模型来解读数据。本练习将指导你构建一个用于分析pHluorin荧光数据的双室动力学模型，该模型描述了囊泡在外吐（exocytosis）和内吞（endocytosis）之间的转换 [@problem_id:2767742]。通过将模型拟合到模拟数据中，你将学习如何提取囊泡运输过程中的核心动力学速率常数$k_{\\mathrm{exo}}$和$k_{\\mathrm{endo}}$，这是定量细胞生物学中的一项关键技能。", "problem": "您将获得一个通过pH敏感的绿色荧光蛋白 (GFP) 报告基因 (pHluorin) 测量的、简化的、具有生物物理动机的突触囊泡循环双室模型。该模型将囊泡动力学抽象为一个内部的、酸性的、无荧光的囊泡池和一个质膜表面的、中性的、有荧光的囊泡池。内化和外化过程分别对应于内吞作用和外排作用。假设荧光轨迹已经进行了漂白校正。\n\n推导过程需基于以下基本原理和定义：\n- 用于两个室之间一级转换的质量作用定律。\n- 在没有合成和降解的情况下，在观察时间尺度内两个室中的囊泡总数守恒。\n- 在恒定的光学条件下，pHluorin 成像中表面（中性）室的囊泡数量与测得的荧光强度之间存在线性比例关系。\n\n定义：\n- 令 $R(t)$ 表示在时间 $t$ 时，表面（中性，有荧光）室中囊泡的期望数量。\n- 令 $I(t)$ 表示在时间 $t$ 时，内部（酸性，无荧光）室中囊泡的期望数量。\n- 令 $T$ 表示守恒的囊泡总数，因此在实验的所有时间 $t$ 中，均有 $T = R(t) + I(t)$。\n- 令 $k_{\\mathrm{exo}}$ 表示在刺激窗口内的恒定外排速率（单位为 $\\mathrm{s}^{-1}$），在窗口外为零。\n- 令 $k_{\\mathrm{endo}}$ 表示在所有时间下恒定的内吞速率（单位为 $\\mathrm{s}^{-1}$）。\n- 假设经过漂白校正后，测得的荧光强度 $F(t)$ 与 $R(t)$ 成正比，比例系数为 $1$，即在任意的、无量纲的荧光单位下 $F(t) = R(t)$。\n\n用作基本出发点的模型假设（请勿使用任何简便公式）：\n- 在外排作用以恒定速率 $k_{\\mathrm{exo}}$ 激活的任何区间内，动力学遵循常微分方程 (ODE) $\\,\\frac{dR}{dt} = k_{\\mathrm{exo}} \\, I(t) - k_{\\mathrm{endo}} \\, R(t)$，其中 $I(t) = T - R(t)$。\n- 在外排作用未激活的任何区间内，该 ODE 简化为 $\\,\\frac{dR}{dt} = -\\,k_{\\mathrm{endo}} \\, R(t)$。\n- 解在切换时间点必须是连续的。\n- 初始条件为 $R(0) = 0$。\n\n您的计算任务：\n- 根据以上原理推导出一个前向模型，该模型将参数 $\\{k_{\\mathrm{exo}}, k_{\\mathrm{endo}}\\}$、刺激时间 $\\{t_{\\mathrm{on}}, t_{\\mathrm{off}}\\}$、总数 $T$ 和时间网格 $\\{t_i\\}_{i=1}^N$ 映射到预测的荧光轨迹 $\\{\\hat{F}(t_i)\\}_{i=1}^N$。\n- 给定一个由模型加上零均值、已知标准差 $\\sigma$ 的独立同分布高斯噪声生成的含噪声荧光轨迹 $\\{F(t_i)\\}_{i=1}^N$，通过最小化 $\\{\\hat{F}(t_i)\\}$ 和 $\\{F(t_i)\\}$ 之间的平方误差和 (SSE) 来估计 $\\{k_{\\mathrm{exo}}, k_{\\mathrm{endo}}\\}$。\n- 约束两个速率均为非负值。\n- 以 $\\mathrm{s}^{-1}$ 为单位表示速率的最终答案，并四舍五入到三位小数。\n\n测试套件规范：\n对于每个测试用例，通过首先使用真实参数从模型中计算出无噪声轨迹，然后添加具有指定种子和标准差的高斯噪声来合成荧光轨迹。所有测试用例使用以下共享设置：\n- 时间网格：$t_i = i \\,\\Delta t$，其中 $i = 0, 1, \\dots, N$，$\\Delta t = 0.05\\,\\mathrm{s}$，最终时间 $t_N = 10.00\\,\\mathrm{s}$。\n- 初始条件：$R(0) = 0$。\n- 囊泡总数：$T = 1$（无量纲）。\n- 刺激窗口：在 $t \\in [t_{\\mathrm{on}}, t_{\\mathrm{off}}]$ 期间，外排作用以恒定速率 $k_{\\mathrm{exo}}$ 激活，在此窗口外则不激活。\n- 噪声模型：加性高斯噪声 $\\mathcal{N}(0, \\sigma^2)$，具有指定的 $\\sigma$ 和种子。\n\n提供三个测试用例：\n- A用例（典型速率）：$t_{\\mathrm{on}} = 1.00\\,\\mathrm{s}$，$t_{\\mathrm{off}} = 3.00\\,\\mathrm{s}$，$k_{\\mathrm{exo}}^{\\mathrm{true}} = 1.20\\,\\mathrm{s}^{-1}$，$k_{\\mathrm{endo}}^{\\mathrm{true}} = 0.60\\,\\mathrm{s}^{-1}$，$\\sigma = 0.01$，随机种子 $13$。\n- B用例（慢速内吞）：$t_{\\mathrm{on}} = 1.00\\,\\mathrm{s}$，$t_{\\mathrm{off}} = 3.00\\,\\mathrm{s}$，$k_{\\mathrm{exo}}^{\\mathrm{true}} = 0.80\\,\\mathrm{s}^{-1}$，$k_{\\mathrm{endo}}^{\\mathrm{true}} = 0.15\\,\\mathrm{s}^{-1}$，$\\sigma = 0.01$，随机种子 $42$。\n- C用例（快速内吞）：$t_{\\mathrm{on}} = 1.00\\,\\mathrm{s}$，$t_{\\mathrm{off}} = 3.00\\,\\mathrm{s}$，$k_{\\mathrm{exo}}^{\\mathrm{true}} = 0.60\\,\\mathrm{s}^{-1}$，$k_{\\mathrm{endo}}^{\\mathrm{true}} = 2.00\\,\\mathrm{s}^{-1}$，$\\sigma = 0.01$，随机种子 $7$。\n\n您的程序必须：\n- 根据上述规范构建时间网格。\n- 对于每个测试用例，完全按照规定（包括随机种子）合成含噪声的荧光轨迹，然后使用推导出的前向模型，通过带有非负性约束的非线性最小二乘法来拟合 $k_{\\mathrm{exo}}$ 和 $k_{\\mathrm{endo}}$，过程中不使用数值积分（而是使用原理所蕴含的分段常系数 ODE 的解析解）。\n- 返回每个用例的拟合参数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由三个项目组成的逗号分隔列表，每个项目是一个测试用例的双元素列表 $[k_{\\mathrm{exo}}, k_{\\mathrm{endo}}]$。所有数字必须四舍五入到三位小数，单位隐含为 $\\mathrm{s}^{-1}$，例如：\n[[kexo_A,kendo_A],[kexo_B,kendo_B],[kexo_C,kendo_C]]", "solution": "问题陈述已经过验证，并被认为是有效的。它在科学上基于化学动力学和生物物理学原理，代表了一个良态的参数估计任务，并以客观、明确的语言进行阐述。唯一解所需的所有必要条件、参数和定义均已提供。因此，我们可以着手进行推导和求解。\n\n任务是首先为荧光信号 $F(t)$ 推导出一个解析前向模型，该信号与细胞表面囊泡数量 $R(t)$ 成正比，然后使用此模型从含噪声的数据中估计动力学速率 $k_{\\mathrm{exo}}$ 和 $k_{\\mathrm{endo}}$。\n\n$R(t)$ 的动力学由分段常系数线性常微分方程 (ODE) 描述。我们将针对三个不同的时间区间求解该系统。\n\n1.  **刺激前区间：$t \\in [0, t_{\\mathrm{on}}]$**\n    在此区间内，外排作用未激活 ($k_{\\mathrm{exo}} = 0$)。控制方程为：\n    $$\n    \\frac{dR}{dt} = -k_{\\mathrm{endo}} R(t)\n    $$\n    初始条件为 $R(0) = 0$。对于这个具有零初始条件的齐次一阶 ODE，其唯一解是一个常数零函数。\n    $$\n    R_1(t) = 0 \\quad \\text{for } t \\in [0, t_{\\mathrm{on}}]\n    $$\n    在刺激开始时，我们有 $R(t_{\\mathrm{on}}) = 0$。\n\n2.  **刺激期间：$t \\in (t_{\\mathrm{on}}, t_{\\mathrm{off}}]$**\n    在刺激期间，外排作用和内吞作用均被激活。控制方程为：\n    $$\n    \\frac{dR}{dt} = k_{\\mathrm{exo}} I(t) - k_{\\mathrm{endo}} R(t)\n    $$\n    利用守恒原理 $I(t) = T - R(t)$，我们得到关于 $R(t)$ 的一个非齐次线性一阶 ODE：\n    $$\n    \\frac{dR}{dt} = k_{\\mathrm{exo}} (T - R(t)) - k_{\\mathrm{endo}} R(t) = k_{\\mathrm{exo}} T - (k_{\\mathrm{exo}} + k_{\\mathrm{endo}}) R(t)\n    $$\n    令 $k_{\\mathrm{sum}} = k_{\\mathrm{exo}} + k_{\\mathrm{endo}}$。方程为 $\\frac{dR}{dt} + k_{\\mathrm{sum}} R(t) = k_{\\mathrm{exo}} T$。通解是特解与齐次解之和。稳态（特）解为 $R_{\\mathrm{p}} = \\frac{k_{\\mathrm{exo}} T}{k_{\\mathrm{sum}}}$。齐次解为 $R_{\\mathrm{h}}(t) = C e^{-k_{\\mathrm{sum}} (t - t_{\\mathrm{on}})}$。通解为：\n    $$\n    R_2(t) = \\frac{k_{\\mathrm{exo}} T}{k_{\\mathrm{sum}}} + C e^{-k_{\\mathrm{sum}} (t - t_{\\mathrm{on}})}\n    $$\n    我们要求在 $t = t_{\\mathrm{on}}$ 处连续，因此 $R_2(t_{\\mathrm{on}}) = R_1(t_{\\mathrm{on}}) = 0$。\n    $$\n    0 = \\frac{k_{\\mathrm{exo}} T}{k_{\\mathrm{sum}}} + C \\implies C = -\\frac{k_{\\mathrm{exo}} T}{k_{\\mathrm{sum}}}\n    $$\n    因此，此区间内的解为：\n    $$\n    R_2(t) = \\frac{k_{\\mathrm{exo}} T}{k_{\\mathrm{sum}}} \\left(1 - e^{-k_{\\mathrm{sum}} (t - t_{\\mathrm{on}})}\\right) \\quad \\text{for } t \\in (t_{\\mathrm{on}}, t_{\\mathrm{off}}]\n    $$\n\n3.  **刺激后区间：$t \\in (t_{\\mathrm{off}}, \\infty)$**\n    刺激停止后，外排作用再次失活 ($k_{\\mathrm{exo}} = 0$)，ODE 回归到其齐次形式：\n    $$\n    \\frac{dR}{dt} = -k_{\\mathrm{endo}} R(t)\n    $$\n    通解为 $R_3(t) = C' e^{-k_{\\mathrm{endo}} (t - t_{\\mathrm{off}})}$。常数 $C'$ 由 $t = t_{\\mathrm{off}}$ 处的连续性条件确定，该条件要求 $R_3(t_{\\mathrm{off}}) = R_2(t_{\\mathrm{off}})$。\n    令 $R_{\\mathrm{off}} = R_2(t_{\\mathrm{off}}) = \\frac{k_{\\mathrm{exo}} T}{k_{\\mathrm{sum}}} \\left(1 - e^{-k_{\\mathrm{sum}} (t_{\\mathrm{off}} - t_{\\mathrm{on}})}\\right)$。\n    则 $C' = R_{\\mathrm{off}}$。解为：\n    $$\n    R_3(t) = R_{\\mathrm{off}} \\cdot e^{-k_{\\mathrm{endo}} (t - t_{\\mathrm{off}})} \\quad \\text{for } t > t_{\\mathrm{off}}\n    $$\n\n**前向模型总结**\n期望荧光轨迹 $\\hat{F}(t) = R(t)$ 的完整解析模型由以下分段函数给出：\n$$\n\\hat{F}(t; k_{\\mathrm{exo}}, k_{\\mathrm{endo}}) =\n\\begin{cases}\n0 & 0 \\le t \\le t_{\\mathrm{on}} \\\\\n\\frac{k_{\\mathrm{exo}} T}{k_{\\mathrm{exo}} + k_{\\mathrm{endo}}} \\left(1 - e^{-(k_{\\mathrm{exo}} + k_{\\mathrm{endo}}) (t - t_{\\mathrm{on}})}\\right) & t_{\\mathrm{on}} < t \\le t_{\\mathrm{off}} \\\\\nR_{\\mathrm{off}} \\cdot e^{-k_{\\mathrm{endo}} (t - t_{\\mathrm{off}})} & t > t_{\\mathrm{off}}\n\\end{cases}\n$$\n其中 $R_{\\mathrm{off}} = \\hat{F}(t_{\\mathrm{off}})$。\n\n**参数估计**\n为了从含噪声的数据轨迹 $\\{F(t_i)\\}$ 中估计参数 $\\{k_{\\mathrm{exo}}, k_{\\mathrm{endo}}\\}$，我们通过最小化模型预测值 $\\{\\hat{F}(t_i)\\}$ 与数据之间的平方误差和 (SSE) 来实现。目标函数 $L$ 为：\n$$\nL(k_{\\mathrm{exo}}, k_{\\mathrm{endo}}) = \\sum_{i} \\left(\\hat{F}(t_i; k_{\\mathrm{exo}}, k_{\\mathrm{endo}}) - F(t_i)\\right)^2\n$$\n这是一个非线性优化问题，我们在物理约束 $k_{\\mathrm{exo}} \\ge 0$ 和 $k_{\\mathrm{endo}} \\ge 0$ 下对其进行数值求解。\n\n**计算策略**\n该解决方案在 Python 中实现。对于每个测试用例：\n1.  使用给定的参数和推导的解析模型计算真实轨迹，并添加具有指定随机种子的高斯噪声 $\\mathcal{N}(0, \\sigma^2)$，从而合成含噪声的荧光轨迹。\n2.  使用 `scipy.optimize.minimize` 函数及其 `L-BFGS-B` 算法来寻找使 SSE 目标函数最小化的 $k_{\\mathrm{exo}}$ 和 $k_{\\mathrm{endo}}$ 的值。选择该算法是因为其效率高且能够处理箱式约束（即 $k_{\\mathrm{exo}} \\ge 0, k_{\\mathrm{endo}} \\ge 0$）。\n3.  将估计出的参数四舍五入到三位小数，并按规定格式化。\n对问题描述中提供的所有三个测试用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Solves the vesicle cycle modeling problem by deriving a forward model,\n    synthesizing noisy data, and fitting parameters via least squares.\n    \"\"\"\n\n    # Define shared settings from the problem statement.\n    dt = 0.05\n    t_final = 10.0\n    t_values = np.linspace(0.0, t_final, int(t_final / dt) + 1)\n    T_vesicles = 1.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'name': 'Case A',\n            't_on': 1.00, 't_off': 3.00,\n            'k_exo_true': 1.20, 'k_endo_true': 0.60,\n            'sigma': 0.01, 'seed': 13\n        },\n        {\n            'name': 'Case B',\n            't_on': 1.00, 't_off': 3.00,\n            'k_exo_true': 0.80, 'k_endo_true': 0.15,\n            'sigma': 0.01, 'seed': 42\n        },\n        {\n            'name': 'Case C',\n            't_on': 1.00, 't_off': 3.00,\n            'k_exo_true': 0.60, 'k_endo_true': 2.00,\n            'sigma': 0.01, 'seed': 7\n        },\n    ]\n\n    # Store results for final output\n    results = []\n\n    for case in test_cases:\n        t_on = case['t_on']\n        t_off = case['t_off']\n\n        def forward_model(params, t):\n            \"\"\"\n            Computes the fluorescence trace based on the analytical solution.\n            \"\"\"\n            k_exo, k_endo = params\n            \n            # The optimizer bounds should prevent negative rates, but as a safeguard:\n            if k_exo < 0 or k_endo < 0:\n                return np.full_like(t, np.inf)\n\n            F_hat = np.zeros_like(t, dtype=float)\n\n            # --- During stimulus phase ---\n            stim_mask = (t > t_on) & (t <= t_off)\n            t_stim = t[stim_mask]\n            k_sum = k_exo + k_endo\n            \n            # Use small epsilon to avoid division by zero\n            if k_sum > 1e-9:\n                R_inf_on = (k_exo * T_vesicles) / k_sum\n                F_hat[stim_mask] = R_inf_on * (1 - np.exp(-k_sum * (t_stim - t_on)))\n            else: # If k_sum is zero, rates are zero, so fluorescence is zero.\n                F_hat[stim_mask] = 0.0\n\n            # --- Post stimulus phase ---\n            post_stim_mask = t > t_off\n            t_post = t[post_stim_mask]\n            \n            # Value at the end of stimulation\n            if k_sum > 1e-9:\n                R_inf_on = (k_exo * T_vesicles) / k_sum\n                R_off_val = R_inf_on * (1 - np.exp(-k_sum * (t_off - t_on)))\n            else:\n                R_off_val = 0.0\n\n            # Calculate decay\n            if k_endo > 1e-9:\n                F_hat[post_stim_mask] = R_off_val * np.exp(-k_endo * (t_post - t_off))\n            else: # If k_endo is zero, fluorescence remains constant post-stimulus\n                F_hat[post_stim_mask] = R_off_val\n                \n            return F_hat\n\n        # Objective function for the optimizer (Sum of Squared Errors)\n        def sse_objective(params, t_data, f_data):\n            predicted_trace = forward_model(params, t_data)\n            return np.sum((predicted_trace - f_data)**2)\n\n        # 1. Synthesize noisy data\n        rng = np.random.default_rng(case['seed'])\n        true_params = [case['k_exo_true'], case['k_endo_true']]\n        true_trace = forward_model(true_params, t_values)\n        noise = rng.normal(loc=0.0, scale=case['sigma'], size=len(t_values))\n        noisy_trace = true_trace + noise\n\n        # 2. Fit the model to the noisy data\n        initial_guess = [1.0, 1.0]  # A reasonable starting point\n        bounds = [(0, None), (0, None)]  # Non-negativity constraints\n\n        opt_result = minimize(\n            sse_objective,\n            initial_guess,\n            args=(t_values, noisy_trace),\n            method='L-BFGS-B',\n            bounds=bounds,\n            options={'ftol': 1e-12, 'gtol': 1e-8} # Stricter tolerance for accuracy\n        )\n\n        k_exo_fit, k_endo_fit = opt_result.x\n        \n        # 3. Store rounded results\n        results.append([round(k_exo_fit, 3), round(k_endo_fit, 3)])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists will have spaces,\n    # so we construct the string manually.\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2767742"}]}