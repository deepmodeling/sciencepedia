{"hands_on_practices": [{"introduction": "理解细胞内钙信号调控的第一步是掌握钙离子与缓冲蛋白的相互作用。本练习将引导你从基本原理出发，应用质量作用定律来量化在不同钙离子浓度下缓冲蛋白的结合比例。这项基本技能对于领会缓冲蛋白如何塑造自由钙信号的幅度和动力学至关重要 [@problem_id:2746473]。", "problem": "一个神经元的胞质溶胶中含有一种可移动的钙离子结合缓冲剂，该缓冲剂具有单个结合位点，根据热力学平衡下的一对一可逆反应与钙离子 $\\mathrm{Ca^{2+}}$ 结合。设游离缓冲剂浓度为 $[B]$，与钙离子结合的缓冲剂浓度为 $[BC]$，总缓冲剂浓度为 $B_T$，游离钙离子浓度为 $[ \\mathrm{Ca}^{2+} ]_f$。该结合平衡由质量作用定律定义的解离常数 $K_d$ 来表征。假设不存在协同性，只有单一类型的结合位点，并且 $[ \\mathrm{Ca}^{2+} ]_f$ 由外部控制（例如，通过钳制的钙离子微域条件），因此缓冲剂的结合不会改变 $[ \\mathrm{Ca}^{2+} ]_f$。\n\n仅从质量作用定律定义的解离常数和缓冲剂的质量守恒出发，推导结合分数 $f_B \\equiv [BC]/B_T$ 作为 $[ \\mathrm{Ca}^{2+} ]_f$ 和 $K_d$ 的函数表达式。然后，当 $B_T = 50\\,\\mu\\text{M}$，$K_d = 200\\,\\text{nM}$ 时，在两个游离钙离子水平下（$[\\mathrm{Ca}^{2+}]_f = 100\\,\\text{nM}$ 和 $[\\mathrm{Ca}^{2+}]_f = 1\\,\\mu\\text{M}$）计算该分数的值。\n\n将你的两个 $f_B$ 数值结果按 $\\big(100\\,\\text{nM},\\,1\\,\\mu\\text{M}\\big)$ 的顺序以一个双元素的行向量形式报告。将最终答案表示为无量纲分数，并四舍五入到四位有效数字。", "solution": "所述问题是基础生物物理化学领域一个有效且适定的练习。它具有科学依据、内部一致，并且需要应用第一性原理。我们将进行推导和后续计算。\n\n该问题描述了缓冲剂 $B$ 和钙离子 $\\mathrm{Ca^{2+}}$ 之间形成复合物 $BC$ 的可逆结合反应。该反应表示为：\n$$\nB + \\mathrm{Ca^{2+}} \\rightleftharpoons BC\n$$\n该反应受两个基本原理支配：平衡时的质量作用定律和缓冲剂物种的质量守恒。\n\n$1$. 质量作用定律：\n平衡状态由解离常数 $K_d$ 表征，其定义为：\n$$\nK_d = \\frac{[B] [\\mathrm{Ca}^{2+}]_f}{[BC]}\n$$\n此处，$[B]$ 是游离缓冲剂的浓度，$[\\mathrm{Ca}^{2+}]_f$ 是游离钙离子浓度，$[BC]$ 是与钙离子结合的缓冲剂浓度。\n\n$2$. 质量守恒：\n缓冲剂的总浓度 $B_T$ 是其游离形式和结合形式的浓度之和：\n$$\nB_T = [B] + [BC]\n$$\n\n目标是推导结合分数 $f_B$ 的表达式，它定义为结合的缓冲剂浓度与总缓冲剂浓度的比值：\n$$\nf_B \\equiv \\frac{[BC]}{B_T}\n$$\n该表达式必须用 $[\\mathrm{Ca}^{2+}]_f$ 和 $K_d$ 来表示。\n\n我们首先重排质量守恒方程，用 $B_T$ 和 $[BC]$ 表示游离缓冲剂浓度 $[B]$：\n$$\n[B] = B_T - [BC]\n$$\n接下来，我们将这个 $[B]$ 的表达式代入解离常数 $K_d$ 的方程中：\n$$\nK_d = \\frac{(B_T - [BC]) [\\mathrm{Ca}^{2+}]_f}{[BC]}\n$$\n该方程建立了浓度、游离钙离子水平和解离常数之间的关系。我们的目标是求解比值 $\\frac{[BC]}{B_T}$。为此，我们进行代数变换。首先，两边同乘以 $[BC]$：\n$$\nK_d [BC] = (B_T - [BC]) [\\mathrm{Ca}^{2+}]_f\n$$\n将右侧的项 $[\\mathrm{Ca}^{2+}]_f$ 展开：\n$$\nK_d [BC] = B_T [\\mathrm{Ca}^{2+}]_f - [BC] [\\mathrm{Ca}^{2+}]_f\n$$\n为了解出 $[BC]$，我们将所有包含 $[BC]$ 的项移到等式的一边：\n$$\nK_d [BC] + [BC] [\\mathrm{Ca}^{2+}]_f = B_T [\\mathrm{Ca}^{2+}]_f\n$$\n从左侧提出公因子 $[BC]$：\n$$\n[BC] (K_d + [\\mathrm{Ca}^{2+}]_f) = B_T [\\mathrm{Ca}^{2+}]_f\n$$\n最后，为了得到所求的结合分数 $f_B = \\frac{[BC]}{B_T}$，我们将两边同除以 $B_T$ 和 $(K_d + [\\mathrm{Ca}^{2+}]_f)$：\n$$\nf_B = \\frac{[BC]}{B_T} = \\frac{[\\mathrm{Ca}^{2+}]_f}{K_d + [\\mathrm{Ca}^{2+}]_f}\n$$\n这就是所求的结合分数表达式。它是 Hill-Langmuir 方程在具有单一一类非协同性结合位点系统下的一个特例。值得注意的是，总缓冲剂浓度 $B_T$ 并未出现在分数 $f_B$ 的最终公式中。因此，给定的值 $B_T = 50\\,\\mu\\text{M}$ 与此计算无关。\n\n现在，我们用给定的数值来计算这个表达式。解离常数为 $K_d = 200\\,\\text{nM}$。我们必须在两个不同的游离钙离子浓度下计算 $f_B$。\n\n情况1：$[\\mathrm{Ca}^{2+}]_f = 100\\,\\text{nM}$\n将数值代入推导出的表达式中：\n$$\nf_B = \\frac{100\\,\\text{nM}}{200\\,\\text{nM} + 100\\,\\text{nM}} = \\frac{100}{300} = \\frac{1}{3}\n$$\n表示为四舍五入到四位有效数字的小数，结果为 $0.3333$。\n\n情况2：$[\\mathrm{Ca}^{2+}]_f = 1\\,\\mu\\text{M}$\n首先，我们必须确保单位一致。我们将 $1\\,\\mu\\text{M}$ 转换为纳摩尔浓度：$1\\,\\mu\\text{M} = 1000\\,\\text{nM}$。\n代入数值：\n$$\nf_B = \\frac{1000\\,\\text{nM}}{200\\,\\text{nM} + 1000\\,\\text{nM}} = \\frac{1000}{1200} = \\frac{10}{12} = \\frac{5}{6}\n$$\n表示为四舍五入到四位有效数字的小数，结果为 $0.8333$。\n\n最终答案应按指定顺序报告为一个包含这两个结果的双元素行向量。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3333 & 0.8333 \\end{pmatrix}}\n$$", "id": "2746473"}, {"introduction": "在静态平衡的基础上，我们进一步探讨动态稳态的概念，这对于维持细胞内环境的稳定至关重要。像内质网这样的细胞器通过主动泵入和被动泄漏之间的持续“拉锯战”来维持其高钙浓度。本练习让你能够模拟这一过程，计算最终的稳态浓度，并理解泵和泄漏参数如何共同决定内质网的钙储存能力 [@problem_id:2746401]。", "problem": "一个单室神经元内质网 (ER) 被一层膜与胞质溶胶隔开，钙离子通过这层膜进行转运。假设通过强大的排出和缓冲机制，胞质溶胶游离钙离子浓度被钳制在一个恒定值。设胞质溶胶游离钙离子浓度为 $[\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}} = 0.2\\,\\mu\\text{M}$。肌浆/内质网钙ATP酶 (SERCA) 泵将钙离子从胞质溶胶泵入内质网腔，其摄取通量密度 $J_{\\mathrm{SERCA}}$ 通过协同结合依赖于胞质溶胶的钙离子浓度；而被动泄漏通量密度 $J_{\\mathrm{leak}}$ 则由浓度差驱动，将钙离子从内质网腔运回胞质溶胶。对于单位膜面积的通量密度，使用以下生物物理学标准本构关系：\n- SERCA摄取：$J_{\\mathrm{SERCA}} = V_{\\max} \\dfrac{[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}{K^{n} + [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}$，\n- 被动泄漏：$J_{\\mathrm{leak}} = P_{\\mathrm{leak}} \\left( [ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} - [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}} \\right)$，\n\n其中 $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}}$ 是内质网腔中的游离钙离子浓度。进入通量公式的所有浓度都必须以 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$ 为单位表示。参数如下：\n- SERCA最大摄取速率 $V_{\\max} = 1.6 \\times 10^{-8}\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，\n- 半活化常数 $K = 0.3\\,\\mu\\text{M}$，\n- Hill系数 $n = 2$，\n- 被动渗透率 $P_{\\mathrm{leak}} = 1.0 \\times 10^{-8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n\n假设系统处于稳态，内质网中没有钙离子的净积累（即跨膜通量达到平衡）。从膜上的质量守恒和上述定义出发，推导并计算稳态下的 $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}}$。将最终数值答案以 $\\mu\\mathrm{M}$ 为单位表示，并四舍五入至四位有效数字。", "solution": "所述问题是一个适定的生物物理建模练习，在科学上是合理的。问题提供了获得唯一解所需的所有必要参数和条件。我们将开始推导。\n\n基本原理是质量守恒。在稳态下，穿过内质网 (ER) 膜的钙离子净通量为零。这意味着流入内质网的通量必须与流出内质网的通量完全平衡。流入是由SERCA泵介导的，其通量密度为 $J_{\\mathrm{SERCA}}$；而流出是被动泄漏，其通量密度为 $J_{\\mathrm{leak}}$。因此，稳态条件为：\n$$\nJ_{\\mathrm{SERCA}} = J_{\\mathrm{leak}}\n$$\n问题给出了这些通量的本构关系：\n$$\nJ_{\\mathrm{SERCA}} = V_{\\max} \\frac{[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}{K^{n} + [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}\n$$\n$$\nJ_{\\mathrm{leak}} = P_{\\mathrm{leak}} \\left( [ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} - [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}} \\right)\n$$\n此处，$[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}$ 是胞质溶胶游离钙离子浓度，$[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}}$ 是内质网腔中的游离钙离子浓度，$V_{\\max}$ 是SERCA泵的最大速率，$K$ 是SERCA的半活化常数，$n$ 是Hill系数，而 $P_{\\mathrm{leak}}$ 是膜的泄漏渗透率。\n\n将这些表达式代入稳态平衡方程，我们得到：\n$$\nV_{\\max} \\frac{[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}{K^{n} + [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}} = P_{\\mathrm{leak}} \\left( [ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} - [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}} \\right)\n$$\n我们的目标是确定 $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}}$ 的稳态值。我们重排方程以求解该变量。首先，两边同除以 $P_{\\mathrm{leak}}$：\n$$\n\\frac{V_{\\max}}{P_{\\mathrm{leak}}} \\frac{[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}{K^{n} + [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}} = [ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} - [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}\n$$\n接下来，我们在等式两边同时加上 $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}$ 来分离出 $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}}$：\n$$\n[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} = [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}} + \\frac{V_{\\max}}{P_{\\mathrm{leak}}} \\frac{[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}{K^{n} + [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}\n$$\n这就是稳态内质网钙离子浓度的符号解。\n\n现在我们必须进行数值计算。一个关键点是单位的处理。问题指明，在通量方程中，浓度必须使用国际单位制 (SI) 中的 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。给定的浓度值单位是微摩尔 ($\\mu\\text{M}$)。换算关系为 $1\\,\\mu\\text{M} = 10^{-6}\\,\\text{mol/L} = 10^{-6}\\,\\text{mol}\\,(10^{-3}\\,\\text{m}^3)^{-1} = 10^{-3}\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n\n给定的参数如下：\n- $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}} = 0.2\\,\\mu\\text{M} = 0.2 \\times 10^{-3}\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$\n- $K = 0.3\\,\\mu\\text{M} = 0.3 \\times 10^{-3}\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$\n- $n = 2$\n- $V_{\\max} = 1.6 \\times 10^{-8}\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n- $P_{\\mathrm{leak}} = 1.0 \\times 10^{-8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n\n让我们首先计算无量纲的Hill项，$\\mathcal{H} = \\frac{[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}{K^{n} + [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}$。由于这是具有相同单位的项的比值，我们可以直接使用以 $\\mu\\text{M}$ 为单位的数值进行计算：\n$$\n\\mathcal{H} = \\frac{(0.2)^{2}}{(0.3)^{2} + (0.2)^{2}} = \\frac{0.04}{0.09 + 0.04} = \\frac{0.04}{0.13} = \\frac{4}{13}\n$$\n接下来，我们计算 $\\frac{V_{\\max}}{P_{\\mathrm{leak}}}$ 这一项：\n$$\n\\frac{V_{\\max}}{P_{\\mathrm{leak}}} = \\frac{1.6 \\times 10^{-8}\\,\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}}{1.0 \\times 10^{-8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}} = 1.6\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n该项的单位正确地为浓度单位，这证实了我们推导的符号表达式在量纲上的一致性。\n\n现在我们将这些值代入 $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}}$ 的方程中，确保所有项都使用国际单位制 (SI) 单位 ($\\mathrm{mol}\\,\\mathrm{m}^{-3}$)：\n$$\n[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} = (0.2 \\times 10^{-3}) + (1.6) \\times \\left(\\frac{4}{13}\\right)\n$$\n所有项的单位均为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n$$\n[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} = 0.0002 + \\frac{6.4}{13} \\approx 0.0002 + 0.49230769\n$$\n$$\n[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} \\approx 0.49250769\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n问题要求最终答案以 $\\mu\\mathrm{M}$ 为单位。我们使用换算因子 $1\\,\\mathrm{mol}\\,\\mathrm{m}^{-3} = 10^3\\,\\mu\\text{M}$。\n$$\n[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} \\approx 0.49250769 \\times 10^3\\,\\mu\\text{M} = 492.50769\\,\\mu\\text{M}\n$$\n最后，我们按要求将答案四舍五入至四位有效数字：\n$$\n[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} \\approx 492.5\\,\\mu\\text{M}\n$$\n这个结果在生物物理学上是合理的，因为内质网腔的钙离子浓度通常在数百微摩尔的范围内，而静息状态的胞质溶胶钙离子水平要低几个数量级。", "answer": "$$\\boxed{492.5}$$", "id": "2746401"}, {"introduction": "最后，我们将这些原理整合到一个更复杂的空间模型中，以模拟真实神经元中钙信号的时空动态。这项高级实践要求你模拟包含胞体和树突的神经元内的钙动力学，综合考虑了钙内流、外排、缓冲和扩散等多个过程。通过执行参数敏感性分析，你将学习一种强大的计算方法，以识别对信号形态影响最大的关键生物学参数，这是理解和预测神经元功能的核心步骤 [@problem_id:2746415]。", "problem": "要求您编写一个完整、可运行的程序，对一个双室神经元模型中的胞质钙离子浓度的峰值振幅和衰减时间进行局部的、一次一参数的敏感性分析。这两个室分别代表胞体和树突，它们之间存在扩散耦合。目标是为每个给定的参数集，确定哪个单一参数对两个指标（胞体的峰值振幅和衰减时间）影响最大。\n\n基本基础与模型构建：\n- 从每个室的质量平衡出发：变化率等于所有源项和汇项的总和。使用菲克定律（Fick's law）描述室间扩散，使用一级动力学描述膜泵（如质膜钙ATP酶PMCA和钠钙交换体NCX）的泵出过程。通过一个恒定的缓冲能力来表示快速缓冲作用，该作用会降低有效的游离钙变化。\n- 令 $c_s(t)$ 和 $c_d(t)$ 分别表示胞体和树突中游离胞质钙离子的浓度，单位为微摩尔（记作 $\\mu$M）。令 $c_0$ 为静息状态的游离钙水平，单位为 $\\mu$M。\n- 令 $J_{\\text{in},s}(t)$ 和 $J_{\\text{in},d}(t)$ 分别为进入胞体和树突的外部钙离子内流，用于模拟电压门控钙离子通道（VGCC）的短暂开放。使用一个带有单一参数 $\\tau_{\\text{in}}$ 的 $\\alpha$-函数时间进程 $g(t)$ 来塑造内流：$$g(t) = \\begin{cases}\\dfrac{t}{\\tau_{\\text{in}}}\\exp\\!\\left(1-\\dfrac{t}{\\tau_{\\text{in}}}\\right), & t \\ge 0 \\\\ 0, & t<0\\end{cases}$$ 该函数在 $t=\\tau_{\\text{in}}$ 时达到无量纲的峰值 $1$。然后设置 $$J_{\\text{in},s}(t) = V_{\\text{in},s}\\, g(t), \\quad J_{\\text{in},d}(t) = V_{\\text{in},d}\\, g(t),$$ 其中 $V_{\\text{in},s}$ 和 $V_{\\text{in},d}$ 是内流振幅，单位为 $\\mu$M/s。\n- 令 $k_{\\text{out},s}$ 和 $k_{\\text{out},d}$ 为一级泵出速率常数（单位为 s$^{-1}$），用于模拟PMCA和NCX，对于室 $x\\in\\{s,d\\}$，其泵出通量为 $J_{\\text{out},x} = k_{\\text{out},x}\\,(c_x - c_0)$。\n- 令 $\\kappa_s$ 和 $\\kappa_d$ 分别为胞体和树突的无量纲缓冲能力。快速缓冲使每个室的有效时间导数减小一个因子 $(1+\\kappa_x)$。\n- 令 $D_{sd}$ 为室间的有效扩散耦合速率（单位为 s$^{-1}$），产生通量 $J_{\\text{diff},s} = D_{sd}\\,(c_d - c_s)$ 和 $J_{\\text{diff},d} = D_{sd}\\,(c_s - c_d)$。\n- 最终得到的系统是\n$$\\frac{dc_s}{dt} = \\frac{1}{1+\\kappa_s}\\left[J_{\\text{in},s}(t) - k_{\\text{out},s}\\,\\big(c_s-c_0\\big) + D_{sd}\\,\\big(c_d - c_s\\big)\\right],$$\n$$\\frac{dc_d}{dt} = \\frac{1}{1+\\kappa_d}\\left[J_{\\text{in},d}(t) - k_{\\text{out},d}\\,\\big(c_d-c_0\\big) + D_{sd}\\,\\big(c_s - c_d\\big)\\right],$$\n初始条件为 $c_s(0)=c_d(0)=c_0$。\n\n从胞体轨迹 $c_s(t)$ 计算的指标：\n- 相较于基线的峰值振幅：$$A = \\max_{t\\in[0,T_{\\max}]} c_s(t) - c_0,$$ 以 $\\mu$M 表示。\n- 衰减到峰值 $1/e$ 分数所需的时间：如果峰值在时间 $t_{\\text{peak}}$ 出现，振幅为 $A$，则设置阈值 $c_{\\text{thr}} = c_0 + A/e$。衰减时间为 $$\\tau_{\\text{decay}} = t_{\\text{cross}} - t_{\\text{peak}},$$ 其中 $t_{\\text{cross}}$ 是满足 $c_s(t) \\le c_{\\text{thr}}$ 的第一个时间 $t\\ge t_{\\text{peak}}$。$\\tau_{\\text{decay}}$ 以秒表示。如果在模拟时程 $[0,T_{\\max}]$ 内未达到阈值，则视为不可测量。\n\n敏感性定义：\n- 对于一个标量指标 $M$（$A$ 或 $\\tau_{\\text{decay}}$）和一个参数 $p$，定义无量纲局部敏感性系数为 $$S_M(p) = \\frac{p}{M}\\,\\frac{dM}{dp},$$ 用一个小的相对扰动 $\\delta>0$ 的中心有限差分进行数值近似：\n$$S_M(p) \\approx \\frac{p}{M(p)}\\cdot \\frac{M\\big(p(1+\\delta)\\big) - M\\big(p(1-\\delta)\\big)}{2\\,\\delta\\,p} = \\frac{M\\big(p(1+\\delta)\\big) - M\\big(p(1-\\delta)\\big)}{2\\,\\delta\\,M(p)}.$$\n通过扰动单个参数并保持其他参数在基线值不变，来计算一次一参数的敏感性。\n\n模拟协议和常数：\n- 使用 $c_0 = 0.1\\,\\mu\\text{M}$（在代码中写作 $c_0 = 0.1$，因为浓度单位是 $\\mu$M）。\n- 使用 $\\tau_{\\text{in}} = 0.02\\,\\text{s}$（在代码中写作 $\\tau_{\\text{in}} = 0.02$）。\n- 在 $[0,T_{\\max}]$ 上进行模拟，其中 $T_{\\max} = 4.0\\,\\text{s}$（在代码中写作 $T_{\\max} = 4.0$）。\n- 使用相对扰动 $\\delta = 0.05$（在代码中写作 $\\delta = 0.05$）。\n- 使用初始条件 $c_s(0)=c_d(0)=c_0$。\n\n参数向量与索引：\n- 参数向量的顺序为 $$\\mathbf{p} = \\big[V_{\\text{in},s},\\, V_{\\text{in},d},\\, k_{\\text{out},s},\\, k_{\\text{out},d},\\, \\kappa_s,\\, \\kappa_d,\\, D_{sd}\\big].$$\n- 使用从零开始的索引：索引 $0$ 对应 $V_{\\text{in},s}$，$1$ 对应 $V_{\\text{in},d}$，$2$ 对应 $k_{\\text{out},s}$，$3$ 对应 $k_{\\text{out},d}$，$4$ 对应 $\\kappa_s$，$5$ 对应 $\\kappa_d$，$6$ 对应 $D_{sd}$。\n\n测试套件：\n提供以下四个基线参数集（所有浓度单位为 $\\mu$M，时间单位为 s）：\n- 情况 1: $[6.0,\\,3.0,\\,3.0,\\,3.0,\\,20.0,\\,20.0,\\,1.0]$。\n- 情况 2: $[6.0,\\,6.0,\\,3.5,\\,3.5,\\,60.0,\\,60.0,\\,10.0]$。\n- 情况 3: $[6.0,\\,3.0,\\,3.0,\\,3.0,\\,300.0,\\,50.0,\\,1.0]$。\n- 情况 4: $[6.0,\\,3.0,\\,3.0,\\,0.5,\\,80.0,\\,50.0,\\,2.0]$。\n\n您的程序需要完成的任务：\n- 对每个测试情况，模拟模型，计算如上定义的胞体峰值振幅 $A$ 和衰减时间 $\\tau_{\\text{decay}}$。\n- 使用中心差分近似和 $\\delta$ 值，为所有七个参数 $p_i$ 计算一次一参数的、无量纲的局部敏感性 $S_A(p_i)$ 和 $S_{\\tau}(p_i)$。\n- 对每个指标，确定具有最大绝对敏感性值的单一参数的索引 $i$。\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的 Python 风格整数列表。按上述顺序，为每个测试用例连接两个整数：首先是具有最大 $|S_A|$ 的参数索引，然后是具有最大 $|S_{\\tau}|$ 的参数索引。例如，输出应具有以下形式：$$[i_{A,1},i_{\\tau,1},i_{A,2},i_{\\tau,2},i_{A,3},i_{\\tau,3},i_{A,4},i_{\\tau,4}],$$ 其中每个 $i$ 是集合 $\\{0,1,2,3,4,5,6\\}$ 中的一个整数索引。", "solution": "### 步骤 1：提取已知条件\n\n- **模型变量**: 胞体和树突中游离胞质钙离子浓度 $c_s(t)$ 和 $c_d(t)$。\n- **模型方程**:\n$$\n\\frac{dc_s}{dt} = \\frac{1}{1+\\kappa_s}\\left[J_{\\text{in},s}(t) - k_{\\text{out},s}\\,\\big(c_s-c_0\\big) + D_{sd}\\,\\big(c_d - c_s\\big)\\right]\n$$\n$$\n\\frac{dc_d}{dt} = \\frac{1}{1+\\kappa_d}\\left[J_{\\text{in},d}(t) - k_{\\text{out},d}\\,\\big(c_d-c_0\\big) + D_{sd}\\,\\big(c_s - c_d\\big)\\right]\n$$\n- **内流项**:\n$J_{\\text{in},x}(t) = V_{\\text{in},x}\\, g(t)$，对于 $x \\in \\{s, d\\}$，其时间剖面由 $\\alpha$-函数给出：\n$$\ng(t) = \\begin{cases}\\dfrac{t}{\\tau_{\\text{in}}}\\exp\\!\\left(1-\\dfrac{t}{\\tau_{\\text{in}}}\\right), & t \\ge 0 \\\\ 0, & t<0\\end{cases}\n$$\n- **初始条件**: $c_s(0) = c_0$, $c_d(0) = c_0$。\n- **常数**:\n    - 静息钙浓度: $c_0 = 0.1\\,\\mu\\text{M}$。\n    - 内流时间常数: $\\tau_{\\text{in}} = 0.02\\,\\text{s}$。\n    - 模拟时间范围: $T_{\\max} = 4.0\\,\\text{s}$。\n    - 敏感性分析的相对扰动: $\\delta = 0.05$。\n- **参数向量**: $\\mathbf{p} = \\big[V_{\\text{in},s},\\, V_{\\text{in},d},\\, k_{\\text{out},s},\\, k_{\\text{out},d},\\, \\kappa_s,\\, \\kappa_d,\\, D_{sd}\\big]$。参数索引从 $0$ 到 $6$，基于零。\n- **指标**:\n    - 峰值振幅: $A = \\max_{t\\in[0,T_{\\max}]} c_s(t) - c_0$。\n    - 衰减时间: $\\tau_{\\text{decay}} = t_{\\text{cross}} - t_{\\text{peak}}$，其中 $t_{\\text{peak}}$ 是峰值时间，$t_{\\text{cross}}$ 是 $c_s(t) \\le c_0 + A/e$ 的第一个时间 $t \\ge t_{\\text{peak}}$。\n- **敏感性定义**:\n$$\nS_M(p) \\approx \\frac{M\\big(p(1+\\delta)\\big) - M\\big(p(1-\\delta)\\big)}{2\\,\\delta\\,M(p)}\n$$\n- **测试用例（基线参数集）**:\n    - 情况 1: $[6.0,\\,3.0,\\,3.0,\\,3.0,\\,20.0,\\,20.0,\\,1.0]$。\n    - 情况 2: $[6.0,\\,6.0,\\,3.5,\\,3.5,\\,60.0,\\,60.0,\\,10.0]$。\n    - 情况 3: $[6.0,\\,3.0,\\,3.0,\\,3.0,\\,300.0,\\,50.0,\\,1.0]$。\n    - 情况 4: $[6.0,\\,3.0,\\,3.0,\\,0.5,\\,80.0,\\,50.0,\\,2.0]$。\n- **任务**: 对每个测试用例，确定对峰值振幅 $A$ 和衰减时间 $\\tau_{\\text{decay}}$ 具有最大绝对敏感性的参数的索引。\n- **输出格式**: 单行 Python 风格的 8 个整数列表：$[i_{A,1},i_{\\tau,1},i_{A,2},i_{\\tau,2},i_{A,3},i_{\\tau,3},i_{A,4},i_{\\tau,4}]$。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n- **科学依据**: 该问题描述了一个标准的双室钙动力学模型，基于质量平衡原理、离子传输的一级动力学和扩散耦合（菲克定律）。快速缓冲近似和用于突触输入的 $\\alpha$-函数是计算神经科学中常见且有效的简化方法。该模型在科学上是合理的。\n- **适定性**: 该问题是一个由两个耦合的、线性的、带有时变强迫项的一阶常微分方程（ODEs）组成的系统。给定初始条件，对于任何给定的参数集，都存在唯一解。指标和敏感性分析的定义明确。该问题是适定的。\n- **客观性**: 所有术语、变量、参数和任务都经过了数学上的精确定义。该问题是客观的，没有主观解释的余地。\n- **不完整或矛盾的设置**: 该问题是自洽的。所有必要的方程、常数、参数值、初始条件和过程定义都已提供。没有矛盾之处。\n- **不切实际或不可行**: 参数值在简化神经元模型的生理学合理范围内。该设置是可行的。\n\n### 步骤 3：结论与行动\n\n问题有效。它具有科学依据、适定、客观且完整。将构建解决方案。\n\n该任务要求对一个常微分方程组系统执行一次一参数的局部敏感性分析。整体计算流程如下：\n1.  对所提供的四个基线参数集中的每一个，执行一系列数值模拟。\n2.  程序的核心是一个函数，该函数针对给定的参数向量 $\\mathbf{p} = [p_0, \\dots, p_6]$，求解常微分方程组并计算两个输出指标：胞体钙浓度 $c_s(t)$ 的峰值振幅（$A$）和衰减时间（$\\tau_{\\text{decay}}$）。\n3.  常微分方程组由以下公式给出：\n    $$\n    \\frac{d}{dt}\\begin{pmatrix} c_s \\\\ c_d \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{1+p_4} \\left[ p_0 g(t) - p_2(c_s - c_0) + p_6(c_d - c_s) \\right] \\\\ \\frac{1}{1+p_5} \\left[ p_1 g(t) - p_3(c_d - c_0) + p_6(c_s - c_d) \\right] \\end{pmatrix}\n    $$\n    初始条件为 $c_s(0) = c_d(0) = c_0$。该系统将在时间区间 $[0, T_{\\max}]$ 上使用标准的 ODE 求解器进行数值求解，具体使用 `scipy.integrate.solve_ivp`，它适用于此类非刚性系统。\n4.  从得到的胞体轨迹 $c_s(t)$ 中计算指标：\n    -   峰值时间 $t_{\\text{peak}}$ 为 $\\arg\\max_t c_s(t)$。\n    -   峰值振幅为 $A = c_s(t_{\\text{peak}}) - c_0$。\n    -   衰减阈值为 $c_{\\text{thr}} = c_0 + A/e$。\n    -   穿越时间 $t_{\\text{cross}}$ 是 $c_s(t) \\le c_{\\text{thr}}$ 的第一个时间 $t \\ge t_{\\text{peak}}$。\n    -   衰减时间为 $\\tau_{\\text{decay}} = t_{\\text{cross}} - t_{\\text{peak}}$。如果在 $T_{\\max}$ 前未穿越阈值，则该指标视为不可测量。\n5.  使用基线参数向量 $\\mathbf{p}_{\\text{base}}$，计算基线指标 $A_{\\text{base}}$ 和 $\\tau_{\\text{decay},\\text{base}}$。\n6.  敏感性分析通过遍历每个参数 $p_i$ (其中 $i \\in \\{0, 1, \\dots, 6\\}$) 进行。对每个 $p_i$，创建两个扰动参数向量：\n    -   $\\mathbf{p}^+$，其中 $p_i$ 被替换为 $p_i(1+\\delta)$。\n    -   $\\mathbf{p}^-$，其中 $p_i$ 被替换为 $p_i(1-\\delta)$。\n7.  为每个扰动向量计算指标，得到 $(A^+, \\tau_{\\text{decay}}^+)$ 和 $(A^-, \\tau_{\\text{decay}}^-)$。\n8.  然后使用中心有限差分公式近似计算 $A$ 和 $\\tau_{\\text{decay}}$ 相对于参数 $p_i$ 的无量纲局部敏感性系数：\n    $$\n    S_A(p_i) \\approx \\frac{A^+ - A^-}{2\\,\\delta\\,A_{\\text{base}}}\n    $$\n    $$\n    S_{\\tau}(p_i) \\approx \\frac{\\tau_{\\text{decay}}^+ - \\tau_{\\text{decay}}^-}{2\\,\\delta\\,\\tau_{\\text{decay},\\text{base}}}\n    $$\n9.  在为每个指标计算出七个敏感性值（$S_A(p_0), \\dots, S_A(p_6)$ 和 $S_{\\tau}(p_0), \\dots, S_{\\tau}(p_6)$）之后，取其绝对值。\n10. 对 $A$ 和 $\\tau_{\\text{decay}}$，分别确定产生最大绝对敏感性的参数索引。对于指标 $M$，即 $\\arg\\max_i |S_M(p_i)|$。\n11. 对所有四个测试用例重复此过程。将得到的八个索引集合并格式化为所需的输出字符串。\n实现将封装在单个 Python 脚本中，并遵循指定的执行环境和库。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Performs a one-at-a-time sensitivity analysis on a two-compartment neuronal\n    calcium model for four different parameter sets.\n    \"\"\"\n\n    # --- Define constants and test cases ---\n    c0 = 0.1  # Resting [Ca2+], uM\n    tau_in = 0.02  # Influx time constant, s\n    t_max = 4.0  # Simulation time horizon, s\n    delta = 0.05  # Relative perturbation for sensitivity analysis\n\n    test_cases = [\n        [6.0, 3.0, 3.0, 3.0, 20.0, 20.0, 1.0],   # Case 1\n        [6.0, 6.0, 3.5, 3.5, 60.0, 60.0, 10.0],  # Case 2\n        [6.0, 3.0, 3.0, 3.0, 300.0, 50.0, 1.0],  # Case 3\n        [6.0, 3.0, 3.0, 0.5, 80.0, 50.0, 2.0],   # Case 4\n    ]\n\n    # --- Helper function for influx time course ---\n    def influx_g(t):\n        if t  0:\n            return 0.0\n        # The alpha-function is implemented such that its peak is 1.\n        # This requires the factor exp(1-t/tau_in)\n        return (t / tau_in) * np.exp(1 - t / tau_in)\n\n    # --- ODE system definition ---\n    def model(t, y, params):\n        cs, cd = y\n        v_in_s, v_in_d, k_out_s, k_out_d, kappa_s, kappa_d, d_sd = params\n        \n        g_t = influx_g(t)\n        \n        # dcs/dt\n        dcs_dt = (1 / (1 + kappa_s)) * (\n            v_in_s * g_t - k_out_s * (cs - c0) + d_sd * (cd - cs)\n        )\n        # dcd/dt\n        dcd_dt = (1 / (1 + kappa_d)) * (\n            v_in_d * g_t - k_out_d * (cd - c0) + d_sd * (cs - cd)\n        )\n        \n        return [dcs_dt, dcd_dt]\n\n    # --- Function to run simulation and compute metrics ---\n    def get_metrics(current_params):\n        sol = solve_ivp(\n            model,\n            [0, t_max],\n            [c0, c0],\n            args=(current_params,),\n            dense_output=True,\n            method='RK45',\n            t_eval=np.linspace(0, t_max, 2000) # Ensure sufficient time resolution\n        )\n        t = sol.t\n        cs = sol.y[0]\n\n        # Metric 1: Peak amplitude A\n        if len(cs) == 0:\n            return np.nan, np.nan\n        \n        peak_idx = np.argmax(cs)\n        t_peak = t[peak_idx]\n        c_peak = cs[peak_idx]\n        amplitude = c_peak - c0\n\n        # Metric 2: Decay time tau_decay\n        if amplitude = 0: # Should not happen with positive influx\n            return amplitude, np.nan\n            \n        threshold = c0 + amplitude / np.e\n        \n        # Find first time t >= t_peak where cs(t) = threshold\n        decay_indices = np.where((t >= t_peak)  (cs = threshold))[0]\n        \n        if len(decay_indices) == 0:\n            # Threshold not reached\n            tau_decay = np.nan\n        else:\n            t_cross_idx = decay_indices[0]\n            \n            # Linear interpolation for better accuracy\n            if t_cross_idx > 0:\n                t1, c1 = t[t_cross_idx - 1], cs[t_cross_idx - 1]\n                t2, c2 = t[t_cross_idx], cs[t_cross_idx]\n                if c1 - c2 > 1e-9: # Avoid division by zero\n                    t_cross = t1 + (t2 - t1) * (threshold - c1) / (c2 - c1)\n                else:\n                    t_cross = t2\n            else:\n                 t_cross = t[t_cross_idx]\n            \n            tau_decay = t_cross - t_peak\n\n        return amplitude, tau_decay\n\n    # --- Main analysis loop ---\n    final_results = []\n    \n    for base_params in test_cases:\n        # Calculate baseline metrics\n        A_base, tau_base = get_metrics(base_params)\n\n        sens_A = []\n        sens_tau = []\n\n        for i in range(len(base_params)):\n            # Perturb parameter p_i\n            p_val = base_params[i]\n            \n            # Positive perturbation\n            params_plus = list(base_params)\n            params_plus[i] = p_val * (1 + delta)\n            A_plus, tau_plus = get_metrics(params_plus)\n\n            # Negative perturbation\n            params_minus = list(base_params)\n            params_minus[i] = p_val * (1 - delta)\n            A_minus, tau_minus = get_metrics(params_minus)\n            \n            # Calculate sensitivity for Amplitude\n            if A_base > 1e-9 and not np.isnan(A_plus) and not np.isnan(A_minus):\n                s_A = (A_plus - A_minus) / (2 * delta * A_base)\n            else:\n                s_A = 0.0\n            sens_A.append(s_A)\n\n            # Calculate sensitivity for Decay Time\n            if tau_base > 1e-9 and not np.isnan(tau_plus) and not np.isnan(tau_minus):\n                s_tau = (tau_plus - tau_minus) / (2 * delta * tau_base)\n            else:\n                s_tau = 0.0 # If baseline or perturbed is invalid, sensitivity is zero\n            sens_tau.append(s_tau)\n\n        # Find index of parameter with max absolute sensitivity\n        # Use np.nanargmax to handle potential NaNs safely, though logic above avoids them\n        idx_max_sens_A = np.argmax(np.abs(sens_A))\n        idx_max_sens_tau = np.argmax(np.abs(sens_tau))\n        \n        final_results.extend([idx_max_sens_A, idx_max_sens_tau])\n\n    # --- Format and print final output ---\n    print(f\"[{','.join(map(str, final_results))}]\")\n\n\nsolve()\n```", "id": "2746415"}]}