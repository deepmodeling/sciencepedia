{"hands_on_practices": [{"introduction": "理解细胞如何维持像环磷酸腺苷 ($cAMP$) 这样的信号分子的特定浓度是至关重要的。本练习将让你实践质量平衡的核心原理，即稳态浓度是由其合成速率和降解速率之间的平衡决定的 [@problem_id:2761780]。通过使用米氏方程对酶动力学进行建模，你将推导并计算出 $cAMP$ 的精确浓度，这是分析任何信号通路的一项基础技能。", "problem": "一个充分混合的神经元隔室通过腺苷酸环化酶 (AC) 的产生和磷酸二酯酶 (PDE) 的降解之间的平衡，将环磷酸腺苷 (cAMP) 维持在稳态。假设 AC 以不依赖于 cAMP 浓度的恒定零级速率产生 cAMP，并且每种 PDE 亚型均遵循 Michaelis-Menten 动力学催化 cAMP 水解。cAMP 没有其他来源或去路，且隔室体积恒定。\n\n存在两种 PDE 亚型，其动力学参数如下：\n- 亚型 1：最大速度 $V_{\\max,1} = 0.80$，单位为微摩尔/秒；Michaelis 常数 $K_{M,1} = 2.00$，单位为微摩尔。\n- 亚型 2：最大速度 $V_{\\max,2} = 0.60$，单位为微摩尔/秒；Michaelis 常数 $K_{M,2} = 10.0$，单位为微摩尔。\n\nAC 的产生速率为 $v_{\\mathrm{AC}} = 0.50$，单位为微摩尔/秒。\n\n利用稳态下的质量平衡和 PDE 介导降解的 Michaelis-Menten 动力学，推导并求解隔室中的稳态 cAMP 浓度，记为 $[{\\mathrm{cAMP}}]$。\n\n最终答案以微摩尔表示，并四舍五入至四位有效数字。", "solution": "首先对问题陈述进行验证。\n\n逐字提取已知条件：\n- 系统：一个处于稳态的充分混合的神经元隔室。\n- 产生：腺苷酸环化酶 (AC) 以恒定的零级速率 $v_{\\mathrm{AC}} = 0.50$ 微摩尔/秒产生 cAMP。\n- 降解：两种磷酸二酯酶 (PDE) 亚型通过 Michaelis-Menten 动力学降解 cAMP。\n- PDE 亚型 1 参数：$V_{\\max,1} = 0.80$ 微摩尔/秒，$K_{M,1} = 2.00$ 微摩尔。\n- PDE 亚型 2 参数：$V_{\\max,2} = 0.60$ 微摩尔/秒，$K_{M,2} = 10.0$ 微摩尔。\n- 约束：cAMP 没有其他来源或去路。\n- 目标：求稳态 cAMP 浓度 $[{\\mathrm{cAMP}}]$。\n\n验证结论：该问题具有科学依据，采用了化学动力学的标准原理（质量平衡和 Michaelis-Menten 酶动力学）。问题阐述清晰，提供了所有必需的参数，目标明确。语言精确客观。设定自洽，没有矛盾或不科学的前提。因此，该问题被认定为有效，并将提供解答。\n\n决定环磷酸腺苷（记为 $[\\mathrm{cAMP}]$）浓度的基本原理是质量作用定律。$[\\mathrm{cAMP}]$ 的变化速率是其产生速率与降解速率之差。\n\n$$\n\\frac{d[\\mathrm{cAMP}]}{dt} = v_{\\mathrm{production}} - v_{\\mathrm{degradation}}\n$$\n\n在稳态下，浓度不随时间变化，因此 $\\frac{d[\\mathrm{cAMP}]}{dt} = 0$。这意味着产生速率必须等于降解速率。\n\n$$\nv_{\\mathrm{production}} = v_{\\mathrm{degradation}}\n$$\n\ncAMP 的产生由腺苷酸环化酶 (AC) 以恒定的零级速率 $v_{\\mathrm{AC}}$ 催化。降解由两种不同的磷酸二酯酶 (PDE) 亚型催化，总降解速率是每种亚型速率的总和。两种亚型都遵循 Michaelis-Menten 动力学。\n\n令 $C$ 代表稳态浓度 $[\\mathrm{cAMP}]$。稳态条件表示为：\n$$\nv_{\\mathrm{AC}} = v_{\\mathrm{PDE},1} + v_{\\mathrm{PDE},2}\n$$\n将每种 PDE 亚型的 Michaelis-Menten 方程代入，我们得到：\n$$\nv_{\\mathrm{AC}} = \\frac{V_{\\max,1} C}{K_{M,1} + C} + \\frac{V_{\\max,2} C}{K_{M,2} + C}\n$$\n为求解 $C$，我们必须将此方程重排为多项式形式。我们首先将右侧的项合并到一个共同的分母上：\n$$\nv_{\\mathrm{AC}} = \\frac{V_{\\max,1} C (K_{M,2} + C) + V_{\\max,2} C (K_{M,1} + C)}{(K_{M,1} + C)(K_{M,2} + C)}\n$$\n两边同乘以分母得到：\n$$\nv_{\\mathrm{AC}} (K_{M,1} + C)(K_{M,2} + C) = V_{\\max,1} C (K_{M,2} + C) + V_{\\max,2} C (K_{M,1} + C)\n$$\n展开方程两边：\n$$\nv_{\\mathrm{AC}} (K_{M,1} K_{M,2} + (K_{M,1} + K_{M,2})C + C^2) = V_{\\max,1} K_{M,2} C + V_{\\max,1} C^2 + V_{\\max,2} K_{M,1} C + V_{\\max,2} C^2\n$$\n我们收集各项，形成标准二次方程 $aC^2 + bC + c = 0$ 的形式。\n$$\n(v_{\\mathrm{AC}}) C^2 + (v_{\\mathrm{AC}}(K_{M,1} + K_{M,2})) C + v_{\\mathrm{AC}} K_{M,1} K_{M,2} = (V_{\\max,1} + V_{\\max,2}) C^2 + (V_{\\max,1} K_{M,2} + V_{\\max,2} K_{M,1}) C\n$$\n重新整理得到：\n$$\n(v_{\\mathrm{AC}} - V_{\\max,1} - V_{\\max,2}) C^2 + (v_{\\mathrm{AC}}(K_{M,1} + K_{M,2}) - V_{\\max,1} K_{M,2} - V_{\\max,2} K_{M,1}) C + v_{\\mathrm{AC}} K_{M,1} K_{M,2} = 0\n$$\n现在，我们将给定的数值代入这个二次方程的系数中。单位是一致的，因此我们可以使用无量纲的数值进行计算。\n已知：\n$v_{\\mathrm{AC}} = 0.50$\n$V_{\\max,1} = 0.80$, $K_{M,1} = 2.00$\n$V_{\\max,2} = 0.60$, $K_{M,2} = 10.0$\n\n系数计算如下：\n系数 $a$：\n$$\na = v_{\\mathrm{AC}} - V_{\\max,1} - V_{\\max,2} = 0.50 - 0.80 - 0.60 = -0.90\n$$\n系数 $b$：\n$$\nb = v_{\\mathrm{AC}}(K_{M,1} + K_{M,2}) - (V_{\\max,1} K_{M,2} + V_{\\max,2} K_{M,1}) = 0.50(2.00 + 10.0) - (0.80 \\times 10.0 + 0.60 \\times 2.00)\n$$\n$$\nb = 0.50(12.0) - (8.00 + 1.20) = 6.0 - 9.20 = -3.20\n$$\n系数 $c$：\n$$\nc = v_{\\mathrm{AC}} K_{M,1} K_{M,2} = 0.50 \\times 2.00 \\times 10.0 = 10.0\n$$\n得到的关于 $C$ 的二次方程是：\n$$\n-0.90 C^2 - 3.20 C + 10.0 = 0\n$$\n为方便起见，两边同乘以 $-1$：\n$$\n0.90 C^2 + 3.20 C - 10.0 = 0\n$$\n我们使用二次公式 $C = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 来求解 $C$：\n$$\nC = \\frac{-3.20 \\pm \\sqrt{(3.20)^2 - 4(0.90)(-10.0)}}{2(0.90)}\n$$\n$$\nC = \\frac{-3.20 \\pm \\sqrt{10.24 + 36.0}}{1.80}\n$$\n$$\nC = \\frac{-3.20 \\pm \\sqrt{46.24}}{1.80}\n$$\n平方根为 $\\sqrt{46.24} = 6.80$。\n$$\nC = \\frac{-3.20 \\pm 6.80}{1.80}\n$$\n这给出了 $C$ 的两个可能的数学解：\n$$\nC_1 = \\frac{-3.20 + 6.80}{1.80} = \\frac{3.60}{1.80} = 2.00\n$$\n$$\nC_2 = \\frac{-3.20 - 6.80}{1.80} = \\frac{-10.0}{1.80} \\approx -5.56\n$$\n浓度必须是一个非负量。因此，第二个解 $C_2$ 在物理上是不现实的，必须舍弃。唯一有效的解是 $C = 2.00 \\, \\mu\\text{M}$。\n\n为了验证这个解，我们将 $C = 2.00$ 代回到最初的速率平衡方程中：\n总降解速率 $v_{\\mathrm{PDE}} = \\frac{0.80 \\times 2.00}{2.00 + 2.00} + \\frac{0.60 \\times 2.00}{10.0 + 2.00} = \\frac{1.60}{4.00} + \\frac{1.20}{12.0} = 0.40 + 0.10 = 0.50 \\, \\mu\\text{M/s}$。\n这与产生速率 $v_{\\mathrm{AC}} = 0.50 \\, \\mu\\text{M/s}$ 相匹配，证实了解的正确性。\n\n题目要求答案以四位有效数字表示。精确答案是 $2$。因此，我们将其写为 $2.000$。", "answer": "$$\\boxed{2.000}$$", "id": "2761780"}, {"introduction": "细胞信号通路很少以简单的线性方式运作；它们富含反馈回路，这些回路塑造了动态响应。本问题挑战你分析一个更真实的模型，其中效应物 PKA 通过负反馈来调节其自身的激活通路 [@problem_id:2761693]。通过分析该系统的微分方程，你将研究像双稳态和灵敏度这样的基本属性，从而深入了解反馈如何确保细胞行为的鲁棒性和适应性。", "problem": "一种神经递质激活G蛋白偶联受体 (GPCR)，该受体刺激腺苷酸环化酶 (AC) 产生环磷酸腺苷 (cAMP)。cAMP激活蛋白激酶A (PKA)，PKA产生两种反馈效应：它磷酸化GPCR从而使其脱敏，并增加降解cAMP的磷酸二酯酶 (PDE) 的最大活性。考虑在恒定激动剂输入 $u$ 下，胞质cAMP浓度 $x(t)$ 的以下最小生物物理模型：\n\n- 活性受体分数为 $r(u,p)=\\dfrac{s(u)}{1+\\beta p}$，其中 $s(u)=\\dfrac{u}{K_{R}+u}$ 表示配体占据饱和度，$p \\in [0,1]$ 是PKA的活性分数，而 $\\beta \\ge 0$ 量化了PKA依赖的脱敏作用。\n- AC产生的cAMP为 $v_{a} r(u,p)$，其中 $v_{a} > 0$ 是一个最大速率常数。\n- PDE降解的cAMP为 $v_{d0}\\bigl(1+\\alpha p\\bigr)\\dfrac{x}{K_{M}+x}$，其中 $v_{d0} > 0$ 是一个基线最大速率常数，$\\alpha \\ge 0$ 量化了PKA依赖的PDE激活作用，而 $K_{M} > 0$ 是Michaelis常数。\n- PKA的激活相对于 $x(t)$ 是快速的，并遵循协同的Hill关系式 $p(x)=\\dfrac{x^{n}}{K_{P}^{n}+x^{n}}$，其中Hill系数 $n \\ge 1$，半激活常数 $K_{P} > 0$。\n\n因此，cAMP的动力学方程为\n$$\n\\frac{dx}{dt}=v_{a}\\,\\frac{s(u)}{1+\\beta\\,p(x)}-v_{d0}\\,\\bigl(1+\\alpha\\,p(x)\\bigr)\\,\\frac{x}{K_{M}+x}.\n$$\n\n任务：\n1) 通过令 $\\dfrac{dx}{dt}=0$，推导稳态浓度 $x^{\\ast}$ 作为 $u$ 和各参数的函数的条件。\n\n2) 仅使用上述生化定义所蕴含的符号和单调性，推导一维系统中存在多稳态时稳态斜率 $\\dfrac{d}{dx}\\left[v_{a}\\dfrac{s(u)}{1+\\beta p(x)}-v_{d0}\\left(1+\\alpha p(x)\\right)\\dfrac{x}{K_{M}+x}\\right]$ 必须满足的必要条件，并评估当所有速率和亲和力参数为正，且 $\\alpha \\ge 0$，$\\beta \\ge 0$，$n \\ge 1$ 时，此条件是否可以满足。结论该最小模型中双稳态是否可能。\n\n3) 使用隐函数定理，将稳态灵敏度 $\\dfrac{dx^{\\ast}}{du}$ 表示为方程右侧关于 $u$ 和 $x$ 的偏导数，然后计算当 $u \\to \\infty$（受体占据饱和状态）时 $\\dfrac{dx^{\\ast}}{du}$ 的极限。以 $\\displaystyle \\lim_{u \\to \\infty} \\frac{dx^{\\ast}}{du}$ 的闭式表达式形式给出最终答案。", "solution": "该问题提出了一个关于环磷酸腺苷 (cAMP) 浓度 $x(t)$ 的动力学系统，该系统由以下常微分方程描述：\n$$\n\\frac{dx}{dt} = v_{a}\\,\\frac{s(u)}{1+\\beta\\,p(x)} - v_{d0}\\,\\bigl(1+\\alpha\\,p(x)\\bigr)\\,\\frac{x}{K_{M}+x}\n$$\n所有参数 $v_a, v_{d0}, K_R, K_M, K_P$ 均为正值，反馈强度 $\\alpha, \\beta$ 为非负值。Hill系数 $n \\ge 1$。激动剂输入 $u$ 是一个非负常数。\n\n该问题具有科学依据、良定、客观且内容完整，是生化系统分析中的一个标准问题。该模型使用已建立的动力学形式（Michaelis-Menten、Hill函数）来描述一个众所周知的信号通路。所提任务是关于此模型性质的精确数学问题。因此，该问题是有效的，我们着手进行解答。\n\n令微分方程的右侧为 $F(x, u)$。\n$$\nF(x, u) = v_{a}\\,\\frac{s(u)}{1+\\beta\\,p(x)} - v_{d0}\\,\\bigl(1+\\alpha\\,p(x)\\bigr)\\,\\frac{x}{K_{M}+x}\n$$\n\n**1) 稳态条件**\n\n稳态浓度 $x^{\\ast}$ 是通过将 $x$ 的变化率设为零得到的，即 $\\frac{dx}{dt} = 0$。这给出了条件 $F(x^{\\ast}, u) = 0$。\n$$\nv_{a}\\,\\frac{s(u)}{1+\\beta\\,p(x^{\\ast})} - v_{d0}\\,\\bigl(1+\\alpha\\,p(x^{\\ast})\\bigr)\\,\\frac{x^{\\ast}}{K_{M}+x^{\\ast}} = 0\n$$\n该方程可以重写以表示稳态时产生与降解之间的平衡：\n$$\nv_{a}\\,\\frac{s(u)}{1+\\beta\\,p(x^{\\ast})} = v_{d0}\\,\\bigl(1+\\alpha\\,p(x^{\\ast})\\bigr)\\,\\frac{x^{\\ast}}{K_{M}+x^{\\ast}}\n$$\n其中 $s(u) = \\frac{u}{K_R + u}$ 且 $p(x^{\\ast}) = \\frac{(x^{\\ast})^{n}}{K_P^{n}+(x^{\\ast})^{n}}$。这是一个隐式方程，它将稳态浓度 $x^{\\ast}$ 定义为输入 $u$ 和系统参数的函数。\n\n**2) 多稳态（双稳态）分析**\n\n在由 $\\frac{dx}{dt} = F(x, u)$ 描述的一维系统中，存在多稳态要求方程 $F(x, u) = 0$ 对 $x$ 有多个解。对于一个连续函数 $F(x, u)$，这意味着该函数相对于 $x$ 必须是非单调的。这种非单调性的一个必要条件是存在至少一个点 $x_0 > 0$，使得 $F(x, u)$ 对 $x$ 的导数在该点变号。具体来说，为了存在一个负斜率区域（产生一个被两个稳定稳态包围的不稳定稳态），必须存在某个 $x_0$ 使得斜率为正：$\\frac{\\partial F}{\\partial x}\\Big|_{x=x_0} > 0$。\n\n我们现在来计算这个导数。让我们分别对 $F(x, u)$ 的两项进行求导。首先，需要PKA激活函数 $p(x)$ 的导数：\n$$\np'(x) = \\frac{d}{dx}\\left(\\frac{x^{n}}{K_{P}^{n}+x^{n}}\\right) = \\frac{n x^{n-1}(K_{P}^{n}+x^{n}) - x^{n}(n x^{n-1})}{(K_{P}^{n}+x^{n})^2} = \\frac{n K_{P}^{n} x^{n-1}}{(K_{P}^{n}+x^{n})^2}\n$$\n由于 $n \\ge 1$ 且所有参数均为正，因此对于所有 $x \\ge 0$，$p'(x) \\ge 0$。\n\n产生项关于 $x$ 的导数是：\n$$\n\\frac{\\partial}{\\partial x}\\left(v_{a}\\,\\frac{s(u)}{1+\\beta\\,p(x)}\\right) = v_{a} s(u) \\frac{-\\beta p'(x)}{(1+\\beta p(x))^2} = -v_{a} s(u) \\frac{\\beta p'(x)}{(1+\\beta p(x))^2}\n$$\n鉴于 $v_a > 0$、$s(u) \\ge 0$、$\\beta \\ge 0$ 和 $p'(x) \\ge 0$，该项总是非正的（$\\le 0$）。\n\n降解项关于 $x$ 的导数是：\n$$\n\\frac{\\partial}{\\partial x}\\left(v_{d0}\\,\\bigl(1+\\alpha\\,p(x)\\bigr)\\,\\frac{x}{K_{M}+x}\\right) = v_{d0} \\left[ \\left(\\frac{d}{dx}(1+\\alpha p(x))\\right) \\frac{x}{K_M+x} + (1+\\alpha p(x)) \\left(\\frac{d}{dx}\\frac{x}{K_M+x}\\right) \\right]\n$$\n对Michaelis-Menten项使用乘法法则和除法法则 $\\frac{d}{dx}\\frac{x}{K_M+x} = \\frac{K_M}{(K_M+x)^2}$，我们得到：\n$$\n= v_{d0} \\left[ \\alpha p'(x) \\frac{x}{K_M+x} + (1+\\alpha p(x)) \\frac{K_M}{(K_M+x)^2} \\right]\n$$\n鉴于 $v_{d0}>0$、$\\alpha \\ge 0$、$p'(x) \\ge 0$、$x \\ge 0$、$p(x) \\ge 0$ 和 $K_M > 0$，此表达式中的每个分量都是非负的。因此，降解项的导数总是非负的（$\\ge 0$）。\n\n综合这些结果，$F(x, u)$ 关于 $x$ 的全导数为：\n$$\n\\frac{\\partial F}{\\partial x} = \\underbrace{-v_{a} s(u) \\frac{\\beta p'(x)}{(1+\\beta p(x))^2}}_{\\le 0} - \\underbrace{v_{d0} \\left[ \\alpha p'(x) \\frac{x}{K_M+x} + (1+\\alpha p(x)) \\frac{K_M}{(K_M+x)^2} \\right]}_{\\ge 0}\n$$\n导数 $\\frac{\\partial F}{\\partial x}$ 是一个非正项与一个非正项（一个非负项的相反数）之和。因此，对于所有 $x \\ge 0$ 和所有有效的参数值，$\\frac{\\partial F}{\\partial x} \\le 0$。\n\n双稳态的必要条件，即对于某个 $x$ 有 $\\frac{\\partial F}{\\partial x} > 0$，永远无法满足。函数 $F(x, u)$ 在 $x$ 上是单调不增的。对于任何 $u > 0$，我们有 $F(0, u) = v_a s(u) > 0$ 且 $\\lim_{x\\to\\infty} F(x, u) = -\\infty$。一个连续的单调递减函数最多只能穿过x轴一次。\n结论：在此最小模型中，双稳态是不可能的。对于任何恒定的输入 $u$，该系统拥有一个唯一的、全局稳定的稳态。所描述的两种反馈机制——受体脱敏和PKA对PDE的激活——都是对cAMP浓度 $x$ 的负反馈，这排除了出现多重稳定状态的可能性。\n\n**3) 稳态灵敏度及其极限**\n\ncAMP浓度对激动剂输入的稳态灵敏度由导数 $\\frac{dx^{\\ast}}{du}$ 给出。我们对稳态条件 $F(x^{\\ast}, u) = 0$ 应用隐函数定理。对该恒等式关于 $u$ 求导，得到：\n$$\n\\frac{\\partial F}{\\partial x}\\frac{dx^{\\ast}}{du} + \\frac{\\partial F}{\\partial u} = 0 \\implies \\frac{dx^{\\ast}}{du} = -\\frac{\\partial F / \\partial u}{\\partial F / \\partial x}\n$$\n我们已经计算了分母 $\\frac{\\partial F}{\\partial x}$。分子是 $F(x, u)$ 关于 $u$ 的偏导数：\n$$\n\\frac{\\partial F}{\\partial u} = \\frac{\\partial}{\\partial u} \\left(v_{a}\\,\\frac{s(u)}{1+\\beta\\,p(x)}\\right) = \\frac{v_a}{1+\\beta p(x)} \\frac{ds}{du}\n$$\n饱和函数 $s(u) = \\frac{u}{K_R+u}$ 的导数是：\n$$\n\\frac{ds}{du} = \\frac{1(K_R+u) - u(1)}{(K_R+u)^2} = \\frac{K_R}{(K_R+u)^2}\n$$\n所以，关于 $u$ 的偏导数是：\n$$\n\\frac{\\partial F}{\\partial u} = \\frac{v_a K_R}{(1+\\beta p(x))(K_R+u)^2}\n$$\n将这些表达式代入 $\\frac{dx^{\\ast}}{du}$ 的公式中（在稳态 $x=x^{\\ast}$ 处取值）：\n$$\n\\frac{dx^{\\ast}}{du} = - \\frac{\\frac{v_a K_R}{(1+\\beta p(x^{\\ast}))(K_R+u)^2}}{-v_{a} s(u) \\frac{\\beta p'(x^{\\ast})}{(1+\\beta p(x^{\\ast}))^2} - v_{d0} \\left[ \\alpha p'(x^{\\ast}) \\frac{x^{\\ast}}{K_M+x^{\\ast}} + (1+\\alpha p(x^{\\ast})) \\frac{K_M}{(K_M+x^{\\ast})^2} \\right]}\n$$\n我们求当 $u \\to \\infty$ 时此表达式的极限。让我们分析在此极限下其各分量的行为。\n当 $u \\to \\infty$ 时，饱和函数 $s(u) = \\frac{u}{K_R+u} \\to 1$。稳态浓度 $x^{\\ast}$ 将趋近于一个有限极限 $x_{\\infty}^{\\ast}$，它是当 $s(u)=1$ 时稳态方程的唯一正解：\n$$\nv_{a}\\,\\frac{1}{1+\\beta\\,p(x_{\\infty}^{\\ast})} = v_{d0}\\,\\bigl(1+\\alpha\\,p(x_{\\infty}^{\\ast})\\bigr)\\,\\frac{x_{\\infty}^{\\ast}}{K_{M}+x_{\\infty}^{\\ast}}\n$$\n现在，我们来计算 $\\frac{dx^{\\ast}}{du}$ 表达式中分子和分母的极限。\n\n分子项（来自 $\\frac{\\partial F}{\\partial u}$）的极限：\n$$\n\\lim_{u \\to \\infty} \\frac{v_a K_R}{(1+\\beta p(x^{\\ast}))(K_R+u)^2} = \\frac{v_a K_R}{(1+\\beta p(x_{\\infty}^{\\ast})) \\cdot \\lim_{u \\to \\infty}(K_R+u)^2} = 0\n$$\n因为分母趋于无穷大，而其他因子趋于有限常数。\n\n分母项（$\\frac{\\partial F}{\\partial x}$ 的相反数）的极限：\n$$\n\\lim_{u \\to \\infty} \\left( v_{a} s(u) \\frac{\\beta p'(x^{\\ast})}{(1+\\beta p(x^{\\ast}))^2} + v_{d0} \\left[ \\alpha p'(x^{\\ast}) \\frac{x^{\\ast}}{K_M+x^{\\ast}} + (1+\\alpha p(x^{\\ast})) \\frac{K_M}{(K_M+x^{\\ast})^2} \\right] \\right)\n$$\n当 $u \\to \\infty$ 时，$x^{\\ast} \\to x_{\\infty}^{\\ast}$ 且 $s(u) \\to 1$。分母趋近于一个有限的正的常数 $C$：\n$$\nC = v_{a} \\frac{\\beta p'(x_{\\infty}^{\\ast})}{(1+\\beta p(x_{\\infty}^{\\ast}))^2} + v_{d0} \\left[ \\alpha p'(x_{\\infty}^{\\ast}) \\frac{x_{\\infty}^{\\ast}}{K_M+x_{\\infty}^{\\ast}} + (1+\\alpha p(x_{\\infty}^{\\ast})) \\frac{K_M}{(K_M+x_{\\infty}^{\\ast})^2} \\right] > 0\n$$\n该值为严格正，因为我们已经证明对于 $x > 0$ 的稳定稳态，$\\frac{\\partial F}{\\partial x} < 0$。\n\n因此，灵敏度的极限是：\n$$\n\\lim_{u \\to \\infty} \\frac{dx^{\\ast}}{du} = \\frac{0}{C} = 0\n$$\n这个结果在生物学上是直观的：当激动剂浓度变得非常大时，受体变得完全饱和（$s(u) \\to 1$）。激动剂浓度的进一步增加对受体激活的影响递减，因此对下游cAMP浓度的影响也变得微乎其微。系统对输入的灵敏度趋近于零。", "answer": "$$\\boxed{0}$$", "id": "2761693"}, {"introduction": "虽然确定性模型描述了大量分子的平均行为，但真实的生物过程在根本上是随机的，尤其是在像树突棘这样的小隔室中。这个计算练习要求你通过实现 Gillespie 算法来模拟单个 $cAMP$分子的随机产生和消亡，从而弥合这两种观点之间的差距 [@problem_id:2761842]。通过将你的随机模拟结果与确定性微分方程的预测进行比较，你将对内在噪声及其在细胞信号传导中的重要性获得切实的理解。", "problem": "你的任务是通过对腺苷酸环化酶和磷酸二酯酶的动力学进行建模，来定量比较树突棘中环磷酸腺苷 (cAMP) 脉冲的随机预测与确定性预测。随机模型必须使用 Gillespie 直接算法进行模拟，而确定性预测必须通过生灭过程的质量作用常微分方程计算得出。该生物系统概述如下：活性腺苷酸环化酶 ($\\mathrm{AC}^\\ast$) 在一个固定的刺激窗口期内催化 cAMP 的合成，而磷酸二酯酶 ($\\mathrm{PDE}$) 则持续降解 cAMP。三磷酸腺苷 (ATP) 的量很丰富，因此其浓度可视为常数，这使得 cAMP 的合成实际上仅对 $\\mathrm{AC}^\\ast$ 是一阶反应。尽管此处未显式模拟蛋白激酶 A (PKA)，但 cAMP 脉冲的比较是下游 PKA 活化的一个有意义的代理指标。\n\n基本和核心定义：\n- 化学主方程 (CME) 与适用于均匀混合体积的质量作用倾向：反应发生率与反应物数量成正比，比例常数源于动力学速率。Gillespie 直接算法从一个指数分布中抽样反应时间，该分布的总发生率等于所有倾向之和；并通过与各别倾向成比例的分类抽样来选择下一个发生的反应。\n- 在大数定律下，CME 的确定性极限给出了关于 cAMP 浓度 $C(t)$ 的常微分方程 (ODE)。\n- 阿伏伽德罗常数 $N_A = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n- 在体积 $V$（单位：升）中的浓度-数量转换：如果 $N$ 是 cAMP 的分子数量，则其微摩尔浓度为 $C_{\\mu\\mathrm{M}} = \\dfrac{N}{N_A V} \\times 10^6$。\n\n模型规格：\n- 物种：cAMP 分子数量 $N_{\\mathrm{cAMP}}(t)$。\n- 参数：活性环化酶数量 $N_{\\mathrm{AC}^\\ast}$（无量纲，分子数），催化速率 $k_{\\mathrm{cat}}$（单位：$\\mathrm{s^{-1}}$ 每 $\\mathrm{AC}^\\ast$），降解速率 $k_{\\mathrm{deg}}$（单位：$\\mathrm{s^{-1}}$），刺激持续时间 $T_{\\mathrm{pulse}}$（单位：$\\mathrm{s}$），模拟时程 $T_{\\mathrm{end}}$（单位：$\\mathrm{s}$），以及区室体积 $V$（单位：$\\mathrm{L}$）。\n- 反应与倾向：\n  1. 在脉冲窗口 $t \\in [0, T_{\\mathrm{pulse}})$ 期间的合成：\n     $$\\varnothing \\xrightarrow{\\mathrm{AC}^\\ast} \\mathrm{cAMP}, \\quad a_1(t) = k_{\\mathrm{cat}}\\, N_{\\mathrm{AC}^\\ast}} \\quad \\text{for } t < T_{\\mathrm{pulse}}, \\quad a_1(t)=0 \\text{ for } t \\ge T_{\\mathrm{pulse}}.$$\n  2. 在所有时间 $t$ 发生的降解：\n     $$\\mathrm{cAMP} \\xrightarrow{\\mathrm{PDE}} \\varnothing, \\quad a_2(t) = k_{\\mathrm{deg}}\\, N_{\\mathrm{cAMP}}(t).$$\n\n确定性预测：\n- 设 $C(t)$ 是以微摩尔为单位的 cAMP 浓度。在脉冲期间 ($0 \\le t \\le T_{\\mathrm{pulse}}$)，\n  $$\\frac{dC}{dt} = r - k_{\\mathrm{deg}} C, \\quad r = \\frac{k_{\\mathrm{cat}}\\, N_{\\mathrm{AC}^\\ast}}{N_A V} \\times 10^6.$$\n  在初始条件 $C(0)=0$ 下，脉冲期间的解为\n  $$C(t) = \\frac{r}{k_{\\mathrm{deg}}}\\left(1 - e^{-k_{\\mathrm{deg}} t}\\right)。$$\n  脉冲结束后 ($t \\ge T_{\\mathrm{pulse}}$)，合成停止，$C(t)$ 呈指数衰减。确定性峰值出现在 $t = T_{\\mathrm{pulse}}$ 时：\n  $$C_{\\mathrm{det,peak}} = \\frac{r}{k_{\\mathrm{deg}}}\\left(1 - e^{-k_{\\mathrm{deg}} T_{\\mathrm{pulse}}}\\right)。$$\n\n随机预测：\n- 使用带有分段常数倾向的 Gillespie 直接算法。模拟两个阶段：\n  - 阶段 1：对于 $t < T_{\\mathrm{pulse}}$，如上所述使用 $a_1 = k_{\\mathrm{cat}} N_{\\mathrm{AC}^\\ast}$ 和 $a_2 = k_{\\mathrm{deg}} N_{\\mathrm{cAMP}}$。如果抽样的反应间隔时间会越过 $T_{\\mathrm{pulse}}$，则将时间推進到 $T_{\\mathrm{pulse}}$ 而不执行反应，然后进入阶段 2。\n  - 阶段 2：对于 $t \\in [T_{\\mathrm{pulse}}, T_{\\mathrm{end}}]$，设置 $a_1=0$，并仅在降解事件下继续模拟。\n- 通过随时间监测 $N_{\\mathrm{cAMP}}$ 并使用上述公式将其转换为微摩尔浓度，来追踪随机峰值濃度 $C_{\\mathrm{stoch,peak}}$。因为在 $T_{\\mathrm{pulse}}$ 之后没有合成发生，所以峰值必须出现在 $T_{\\mathrm{pulse}}$ 或之前。\n\n任务：\n- 对于下面的每一组参数，计算比率\n  $$R = \\frac{C_{\\mathrm{stoch,peak}}}{C_{\\mathrm{det,peak}}}.$$\n- 初始化：$N_{\\mathrm{cAMP}}(0) = 0$ 和 $C(0)=0$。\n- 随机性：使用以 $1729$ 为种子的伪随机数生成器以确保可复现性；例如，你可以通过测试用例索引 $i$ 将种子偏移为 $1729 + i$，以获得每个用例的可复现随机流。\n- 单位：时间单位为秒（$\\mathrm{s}$），体积单位为升（$\\mathrm{L}$），速率单位为每秒（$\\mathrm{s^{-1}}$），浓度单位为微摩尔（$\\mu\\mathrm{M}$）。\n- 输出：对于每个测试用例，将比率 $R$ 作为浮点小数输出，并四舍五入到六位小数。\n\n测试套件（四个用例）：\n1. 典型的小树突棘：\n   - $N_{\\mathrm{AC}^\\ast} = 50$, $k_{\\mathrm{cat}} = 20\\ \\mathrm{s^{-1}}$, $k_{\\mathrm{deg}} = 2\\ \\mathrm{s^{-1}}$, $T_{\\mathrm{pulse}}=0.5\\ \\mathrm{s}$, $T_{\\mathrm{end}}=3.0\\ \\mathrm{s}$, $V = 1.0\\times 10^{-16}\\ \\mathrm{L}$。\n2. 极小树突棘（更强的内在噪声），缩放 $\\mathrm{AC}^\\ast$ 以维持相似的单位体积确定性驱动力：\n   - $N_{\\mathrm{AC}^\\ast} = 10$, $k_{\\mathrm{cat}} = 20\\ \\mathrm{s^{-1}}$, $k_{\\mathrm{deg}} = 2\\ \\mathrm{s^{-1}}$, $T_{\\mathrm{pulse}}=0.5\\ \\mathrm{s}$, $T_{\\mathrm{end}}=3.0\\ \\mathrm{s}$, $V = 2.0\\times 10^{-17}\\ \\mathrm{L}$。\n3. 大型类树突棘区室（大数定律状态），缩放 $\\mathrm{AC}^\\ast$：\n   - $N_{\\mathrm{AC}^\\ast} = 500$, $k_{\\mathrm{cat}} = 20\\ \\mathrm{s^{-1}}$, $k_{\\mathrm{deg}} = 2\\ \\mathrm{s^{-1}}$, $T_{\\mathrm{pulse}}=0.5\\ \\mathrm{s}$, $T_{\\mathrm{end}}=3.0\\ \\mathrm{s}$, $V = 1.0\\times 10^{-15}\\ \\mathrm{L}$。\n4. 快速降解，短脉冲（具有小预期峰值的边界条件）：\n   - $N_{\\mathrm{AC}^\\ast} = 50$, $k_{\\mathrm{cat}} = 20\\ \\mathrm{s^{-1}}$, $k_{\\mathrm{deg}} = 10\\ \\mathrm{s^{-1}}$, $T_{\\mathrm{pulse}}=0.1\\ \\mathrm{s}$, $T_{\\mathrm{end}}=1.0\\ \\mathrm{s}$, $V = 1.0\\times 10^{-16}\\ \\mathrm{L}$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如，“[r1,r2,r3,r4]”），其中每个 $r_i$ 是测试用例 $i$ 的比率 $R$，四舍五入到六位小数。不应打印任何其他文本。", "solution": "该问题要求对细胞微区室中环磷酸腺苷 (cAMP) 峰值浓度的确定性预测和随机预测进行定量比较。为实现此目的，首先，通过质量作用常微分方程 (ODE) 的解析解计算峰值浓度；其次，使用 Gillespie 随机模拟算法 (SSA) 模拟单个轨迹以找到随机峰值。这两个峰值的比率可作为衡量系统随机波动（即内在噪声）大小的指标。\n\n对问题陈述的验证表明，该问题在科学上是合理的、良定的且客观的。它为获得严谨的解提供了完整且一致的定义、参数和物理常数。该模型是一个典型的生灭过程，是随机化学动力学中的一个基本構造，并应用于一个与生物学相关的信号通路。因此，我们可以着手求解。\n\n分析分为两个主要部分：确定性模型和随机模型。\n\n**确定性模型**\n\n根据大数定律，对于一个含有大量分子的系统，随机化学主方程会收敛到一组确定性速率方程。对于本系统，cAMP 的浓度（以微摩尔 ($\\mu\\mathrm{M}$) 为单位，记为 $C(t)$）由一个线性一阶常微分方程控制。\n\n在刺激窗口 $t \\in [0, T_{\\mathrm{pulse}}]$ 期间，cAMP 以恒定速率合成，并以与其当前浓度成正比的速率降解。控制方程为：\n$$\n\\frac{dC}{dt} = r - k_{\\mathrm{deg}} C(t)\n$$\n此处, $k_{\\mathrm{deg}}$ 是一阶降解速率常数（单位为 $\\mathrm{s^{-1}}$）。$r$ 项代表以 $\\mu\\mathrm{M} \\cdot \\mathrm{s^{-1}}$ 为单位的恒定合成速率。它由微观参数推導而来：活性腺苷酸环化酶的分子数 $N_{\\mathrm{AC}^\\ast}$；每个酶的催化速率 $k_{\\mathrm{cat}}$（单位为 $\\mathrm{s^{-1}}$）；区室体积 $V$（单位为 $\\mathrm{L}$）；以及阿伏伽德罗常数 $N_A$。从分子产率到浓度变化率的转换得出：\n$$\nr = \\frac{k_{\\mathrm{cat}} N_{\\mathrm{AC}^\\ast}}{N_A V} \\times 10^6\n$$\n因子 $10^6$将浓度单位从 $\\mathrm{mol \\cdot L^{-1}}$ 转换为 $\\mu\\mathrm{mol \\cdot L^{-1}}$ ($\\mu\\mathrm{M}$)。\n\n在初始条件 $C(0) = 0$ 下，此 ODE 的解为：\n$$\nC(t) = \\frac{r}{k_{\\mathrm{deg}}} \\left(1 - e^{-k_{\\mathrm{deg}} t}\\right)\n$$\n由于合成速率 $r$ 在 $t \\in [0, T_{\\mathrm{pulse}}]$ 区间内为正常数，浓度 $C(t)$ 在此区间内是单调递增函数。因此，确定性峰值浓度 $C_{\\mathrm{det,peak}}$ 恰好在刺激脉冲结束时，即 $t = T_{\\mathrm{pulse}}$ 时达到。\n$$\nC_{\\mathrm{det,peak}} = C(T_{\\mathrm{pulse}}) = \\frac{r}{k_{\\mathrm{deg}}} \\left(1 - e^{-k_{\\mathrm{deg}} T_{\\mathrm{pulse}}}\\right)\n$$\n对于 $t > T_{\\mathrm{pulse}}$，合成项 $r$ 变为零，浓度从其在 $T_{\\mathrm{pulse}}$ 时的值开始指数衰減。\n\n**随机模型**\n\n在随机框架下，我们对 cAMP 分子的离散数量 $N_{\\mathrm{cAMP}}(t)$ 进行建模。系统通过一系列化学反应进行演化，每个反应都在随机的时间点发生。这是一个经典的生灭过程。\n\n反应及其对应的质量作用倾向 $a_j$ 如下：\n1.  **合成（生）**：$\\varnothing \\xrightarrow{\\mathrm{AC}^\\ast} \\mathrm{cAMP}$。这代表一个 cAMP 分子的生成。其倾向是时间依赖的：\n    $$\n    a_1(t) = \\begin{cases} k_{\\mathrm{cat}} N_{\\mathrm{AC}^\\ast} & \\text{if } t < T_{\\mathrm{pulse}} \\\\ 0 & \\text{if } t \\ge T_{\\mathrm{pulse}} \\end{cases}\n    $$\n    就 cAMP 而言，这是一个零阶反应，因为其速率不依赖于 $N_{\\mathrm{cAMP}}$。\n\n2.  **降解（灭）**：$\\mathrm{cAMP} \\xrightarrow{\\mathrm{PDE}} \\varnothing$。这代表一个 cAMP 分子的降解。其倾向是：\n    $$\n    a_2(t) = k_{\\mathrm{deg}} N_{\\mathrm{cAMP}}(t)\n    $$\n    这是一个一阶反应，其速率与反应物分子数成正比。\n\n此随机过程的模拟将使用 Gillespie 直接算法进行。在任何给定时间 $t$ 和状态 $N_{\\mathrm{cAMP}}(t)$ 下，该算法按如下步骤进行：\n1.  计算所有可能反应的倾向，$a_1$ 和 $a_2$。\n2.  计算总倾向，$a_0 = a_1 + a_2$。\n3.  从速率为 $a_0$ 的指数分布中抽样下一次反应发生前的时间间隔 $\\tau$：\n    $$\n    \\tau = -\\frac{\\ln(u_1)}{a_0}\n    $$\n    其中 $u_1$ 是从 (0, 1) 的均匀分布中抽取的随机数。\n4.  确定发生哪个反应。反应 $j$ 以概率 $a_j / a_0$ 被选择。这可以通过抽取第二个均匀分布的随机数 $u_2$ 并找到满足 $\\sum_{i=1}^{j} a_i \\ge u_2 a_0$ 的最小整数 $j$ 来实现。对于我们的双反应系统，如果 $u_2 a_0 \\le a_1$，则反应 1 发生；否则，反应 2 发生。\n5.  根据所选反应更新系统状态（合成时 $N_{\\mathrm{cAMP}} \\rightarrow N_{\\mathrm{cAMP}}+1$，降解时 $N_{\\mathrm{cAMP}} \\rightarrow N_{\\mathrm{cAMP}}-1$），并将时间推进到 $t + \\tau$。\n\n需要一项特定的修改来处理时间依赖的合成速率。当抽样的时间步長 $\\tau$ 会使时钟前进超过 $T_{\\mathrm{pulse}}$ 时，模拟将以 $a_1 = k_{\\mathrm{cat}} N_{\\mathrm{AC}^\\ast}$ 进行，直到 $t+\\tau \\ge T_{\\mathrm{pulse}}$。此时，算法将时间直接推进到 $t=T_{\\mathrm{pulse}}$ 而不执行任何反应，然后将 $a_1$ 永久设置为 0 继续模拟。\n\n随机峰值 $C_{\\mathrm{stoch,peak}}$ 是通过追踪模拟过程中观察到的 cAMP 分子最大数量 $N_{\\mathrm{peak}}$ 来确定的。由于在 $t=T_{\\mathrm{pulse}}$ 之后合成事件停止，分子数量只能减少。因此，分子数量的峰值必须出现在 $t=T_{\\mathrmpulse}}$ 或之前。只需将系统模拟到 $T_{\\mathrm{pulse}}$，记录遇到的 $N_{\\mathrm{cAMP}}$ 的最大值即可。这个最大数量 $N_{\\mathrm{peak}}$ Subsequently被转换为浓度：\n$$\nC_{\\mathrm{stoch,peak}} = \\frac{N_{\\mathrm{peak}}}{N_A V} \\times 10^6\n$$\n\n**比率的计算**\n\n对于测试套件中提供的每组参数，我们将首先使用其解析公式计算 $C_{\\mathrm{det,peak}}$。然后，我们将执行一次为保证可复现性而设置了种子的 Gillespie 模拟，以找到 $C_{\\mathrm{stoch,peak}}$。最终结果是该比率：\n$$\nR = \\frac{C_{\\mathrm{stoch,peak}}}{C_{\\mathrm{det,peak}}}\n$$\n该比率量化了随机峰值与确定性平均值之间的偏差。比率大于 1 表示该特定随机轨迹的峰值高于平均场预测，反之亦然。对于体积更小、分子数更少的系统，预计 $|R-1|$ 的值会更大，因为在这些系统中，内在噪声的影响更为显著。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It calculates the ratio of stochastic to deterministic peak cAMP concentrations.\n    \"\"\"\n\n    # Avogadro constant\n    N_A = 6.02214076e23  # mol^-1\n\n    # Test suite from the problem statement\n    test_cases = [\n        # (N_AC*, k_cat, k_deg, T_pulse, T_end, V)\n        (50, 20.0, 2.0, 0.5, 3.0, 1.0e-16),\n        (10, 20.0, 2.0, 0.5, 3.0, 2.0e-17),\n        (500, 20.0, 2.0, 0.5, 3.0, 1.0e-15),\n        (50, 20.0, 10.0, 0.1, 1.0, 1.0e-16),\n    ]\n\n    base_seed = 1729\n    results = []\n\n    for i, params in enumerate(test_cases):\n        n_ac_star, k_cat, k_deg, t_pulse, _, v = params\n        seed = base_seed + i\n\n        #\n        # Step 1: Deterministic Calculation\n        #\n        \n        # Synthesis rate in uM/s\n        r = (k_cat * n_ac_star) / (N_A * v) * 1e6\n        \n        # Peak deterministic concentration (at t = T_pulse)\n        if k_deg > 0:\n            c_det_peak = (r / k_deg) * (1 - np.exp(-k_deg * t_pulse))\n        else: # Edge case for k_deg = 0\n            c_det_peak = r * t_pulse\n\n        #\n        # Step 2: Stochastic Simulation (Gillespie Algorithm)\n        #\n        \n        rng = np.random.default_rng(seed)\n        \n        t = 0.0\n        n_cAMP = 0\n        n_cAMP_peak = 0\n\n        # Propensity for synthesis is constant during the pulse\n        a1 = k_cat * n_ac_star\n\n        while t  t_pulse:\n            # Propensity for degradation depends on current molecule count\n            a2 = k_deg * n_cAMP\n            \n            a0 = a1 + a2\n\n            if a0 == 0:\n                # No more reactions can occur\n                t = t_pulse # Advance time to end of pulse window\n                break\n\n            # Sample time to next reaction\n            u1 = rng.random()\n            # Ensure u1 is not zero for log, although highly improbable\n            if u1 == 0.0:\n                u1 = np.finfo(float).tiny\n            tau = -np.log(u1) / a0\n            \n            # If next reaction occurs after T_pulse, advance time to T_pulse and stop.\n            if t + tau >= t_pulse:\n                t = t_pulse\n                break\n            \n            # Advance time\n            t += tau\n\n            # Choose which reaction occurs\n            u2 = rng.random()\n            if u2 * a0 = a1:\n                # Synthesis reaction\n                n_cAMP += 1\n            else:\n                # Degradation reaction\n                n_cAMP -= 1\n            \n            # Update peak molecule count\n            if n_cAMP > n_cAMP_peak:\n                n_cAMP_peak = n_cAMP\n        \n        # Convert peak molecule count to concentration\n        c_stoch_peak = (n_cAMP_peak / (N_A * v)) * 1e6\n\n        #\n        # Step 3: Compute the Ratio\n        #\n        \n        if c_det_peak > 0:\n            ratio = c_stoch_peak / c_det_peak\n        elif c_stoch_peak == 0 and c_det_peak == 0:\n            ratio = 1.0 # Or undefined, but 1.0 is a reasonable convention\n        else:\n            ratio = np.inf\n            \n        results.append(round(ratio, 6))\n\n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2761842"}]}