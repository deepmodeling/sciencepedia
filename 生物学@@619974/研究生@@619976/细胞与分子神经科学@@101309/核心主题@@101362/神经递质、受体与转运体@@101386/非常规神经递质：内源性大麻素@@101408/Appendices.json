{"hands_on_practices": [{"introduction": "像 $2$-AG 这样的逆行信使的功能取决于它们从突触后神经元移动到突触前末梢的能力。本练习旨在带你深入探究控制这一过程的基本生物物理学原理。通过推导和求解反应-扩散方程，你将建立一个数学模型来预测 $2$-AG 在稳态下的浓度如何随距其来源的距离而变化，从而对内源性大麻素信号作用的空间尺度有一个定量的理解。[@problem_id:2770084]", "problem": "2-花生四烯酸甘油（$2$-AG）是一种在突触后产生并能逆向扩散至突触前大麻素受体的内源性大麻素。考虑一个沿垂直于突触膜的轴的有效一维胞外半空间，其坐标为 $x \\ge 0$，其中 $x=0$ 表示产生 $2$-AG 的膜表面。假设：\n- 在 $x=0$ 处，一个恒定的 $2$-AG 面生产通量 $J_{0}$（单位面积单位时间的分子数）被注入到胞外空间。\n- $2$-AG 的扩散系数 $D$ 在空间上是均匀的。\n- $2$-AG 的体内降解遵循一级动力学，其速率常数为 $k_{\\mathrm{deg}}$，且在空间上是均匀的。\n- 该系统在平行于膜的方向上是不变的，因此浓度 $C(x,t)$ 仅依赖于 $x$ 和 $t$。\n\n从局部质量守恒和菲克第一扩散定律出发，并考虑由降解引起的一级体积汇，推导在 $x>0$ 区域内浓度 $C(x,t)$ 的主导反应-扩散方程。明确陈述在 $x=0$ 和 $x \\to \\infty$ 处的物理适用边界条件，并约定 $x$ 轴正方向指向膜外。\n\n然后，在这些条件下求解 $x \\ge 0$ 上的稳态浓度分布 $C(x)$。最终答案应以仅包含 $J_{0}$、$D$、$k_{\\mathrm{deg}}$ 和 $x$ 的闭合形式符号表达式给出。不要代入数值，最终表达式中也不要包含单位。", "solution": "所述问题构成了一个适定的、有科学依据的生物物理建模练习，因此被认为是有效的。我们将进行其形式化的推导和求解。\n\n首先，我们推导主导的反应-扩散方程。我们将局部质量守恒原理应用于一个一维控制体元，其横截面积为 $A$，从坐标 $x$ 延伸到 $x + \\Delta x$。该体积 $V = A \\Delta x$ 内 $2$-AG 分子的总数为 $N(t) = C(x,t) V = C(x,t) A \\Delta x$。此体积内分子数的变化率等于穿过其边界的净通量与因降解造成的损失速率之和。\n\n质量平衡方程为：\n$$ \\frac{dN}{dt} = (\\text{Flux in at } x) - (\\text{Flux out at } x + \\Delta x) - (\\text{Degradation rate}) $$\n用分子通量 $J(x,t)$（单位面积单位时间的分子数）和浓度 $C(x,t)$ 表示，可写为：\n$$ \\frac{\\partial}{\\partial t} (C(x,t) A \\Delta x) = J(x,t) A - J(x+\\Delta x, t) A - k_{\\mathrm{deg}} C(x,t) A \\Delta x $$\n两边同除以体积 $A \\Delta x$ 并重新整理可得：\n$$ \\frac{\\partial C(x,t)}{\\partial t} = - \\frac{J(x+\\Delta x, t) - J(x,t)}{\\Delta x} - k_{\\mathrm{deg}} C(x,t) $$\n当 $\\Delta x \\to 0$ 时取极限，我们得到带汇项的一维连续性方程：\n$$ \\frac{\\partial C(x,t)}{\\partial t} = - \\frac{\\partial J(x,t)}{\\partial x} - k_{\\mathrm{deg}} C(x,t) $$\n接下来，我们引用菲克第一扩散定律，它将通量与浓度梯度联系起来：\n$$ J(x,t) = -D \\frac{\\partial C(x,t)}{\\partial x} $$\n其中 $D$ 是扩散系数，假设为常数。将菲克定律代入连续性方程可得：\n$$ \\frac{\\partial C(x,t)}{\\partial t} = - \\frac{\\partial}{\\partial x} \\left(-D \\frac{\\partial C(x,t)}{\\partial x}\\right) - k_{\\mathrm{deg}} C(x,t) $$\n由于 $D$ 在空间上是均匀的，上式可简化为在域 $x > 0$ 内 $C(x,t)$ 的主导反应-扩散方程：\n$$ \\frac{\\partial C(x,t)}{\\partial t} = D \\frac{\\partial^2 C(x,t)}{\\partial x^2} - k_{\\mathrm{deg}} C(x,t) $$\n边界条件由系统的物理约束决定。\n$1$. 在膜表面 $x=0$ 处，有一个恒定的生产通量 $J_{0}$ 注入到胞外空间。这个源通量必须等于离开膜的扩散通量。在 $x=0$ 处的扩散通量是 $J(0,t) = -D \\frac{\\partial C}{\\partial x}\\Big|_{x=0}$。令二者相等，得到诺伊曼边界条件：\n$$ -D \\frac{\\partial C}{\\partial x}\\Bigg|_{x=0} = J_{0} $$\n$2$. 远离源头，在 $x \\to \\infty$ 处，由于无穷远处没有源且分子因降解而被持续移除，扩散物质的浓度必须趋于零。这提供了第二个边界条件：\n$$ \\lim_{x \\to \\infty} C(x,t) = 0 $$\n现在，我们求解稳态浓度分布 $C(x)$。在稳态下，浓度不随时间变化，因此 $\\frac{\\partial C}{\\partial t} = 0$。该偏微分方程简化为一个二阶、线性、齐次常微分方程 (ODE)：\n$$ D \\frac{d^2 C(x)}{dx^2} - k_{\\mathrm{deg}} C(x) = 0 $$\n这可以重写为：\n$$ \\frac{d^2 C}{dx^2} - \\frac{k_{\\mathrm{deg}}}{D} C = 0 $$\n其特征方程为 $r^2 - \\frac{k_{\\mathrm{deg}}}{D} = 0$，根为 $r = \\pm \\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}$。因此，通解为：\n$$ C(x) = A_{1} \\exp\\left(x\\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right) + A_{2} \\exp\\left(-x\\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right) $$\n其中 $A_{1}$ 和 $A_{2}$ 是待由边界条件确定的积分常数。\n\n应用无穷远处的边界条件 $\\lim_{x \\to \\infty} C(x) = 0$：\n当 $x \\to \\infty$ 时，项 $A_{1} \\exp\\left(x\\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right)$ 会无界增长。为满足该条件，其系数必须为零，即 $A_{1}=0$。解简化为：\n$$ C(x) = A_{2} \\exp\\left(-x\\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right) $$\n现在，我们应用在 $x=0$ 处的通量边界条件：\n$$ -D \\frac{dC}{dx}\\Bigg|_{x=0} = J_{0} $$\n首先，我们计算 $C(x)$ 的导数：\n$$ \\frac{dC}{dx} = -A_{2} \\sqrt{\\frac{k_{\\mathrm{deg}}}{D}} \\exp\\left(-x\\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right) $$\n计算此导数在 $x=0$ 处的值：\n$$ \\frac{dC}{dx}\\Bigg|_{x=0} = -A_{2} \\sqrt{\\frac{k_{\\mathrm{deg}}}{D}} $$\n将此结果代入边界条件方程：\n$$ -D \\left(-A_{2} \\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right) = J_{0} $$\n$$ A_{2} D \\sqrt{\\frac{k_{\\mathrm{deg}}}{D}} = J_{0} $$\n$$ A_{2} \\sqrt{D^2 \\frac{k_{\\mathrm{deg}}}{D}} = J_{0} $$\n$$ A_{2} \\sqrt{D k_{\\mathrm{deg}}} = J_{0} $$\n求解常数 $A_{2}$：\n$$ A_{2} = \\frac{J_{0}}{\\sqrt{D k_{\\mathrm{deg}}}} $$\n最后，我们将 $A_{2}$ 的值代回到 $C(x)$ 的表达式中，以获得稳态浓度分布：\n$$ C(x) = \\frac{J_{0}}{\\sqrt{D k_{\\mathrm{deg}}}} \\exp\\left(-x\\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right) $$\n该表达式按要求给出了 $2$-AG 浓度作为离膜距离的函数，并由生产通量、扩散系数和降解速率决定。", "answer": "$$\n\\boxed{\\frac{J_{0}}{\\sqrt{D k_{\\mathrm{deg}}}} \\exp\\left(-x\\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right)}\n$$", "id": "2770084"}, {"introduction": "当像 $2$-AG 这样的信号分子到达其靶点后，我们如何通过实验确定其确切效果？本实践将带你从理论建模转向数据分析，让你扮演电生理学家的角色来分析突触记录。你将运用一个强大的统计学框架来检验相互竞争的假设：所观察到的突触抑制是由突触前神经递质释放的改变（突触前机制）还是由突触后受体敏感性的改变（突触后机制）所引起的，在神经科学中做出这种区分至关重要。[@problem_id:2770153]", "problem": "一个齿状回颗粒细胞被电压钳制在一个维持电位上，此电位下可记录到内向且良好分离的微小兴奋性突触后电流 (mEPSCs)。内源性大麻素信号在突触后被招募，并通过一种去极化诱导的、能升高细胞内钙离子浓度的机制，激活突触前的1型大麻素受体 (CB1)。您在两种持续时间相等且不重叠的条件下收集了连续记录：基线条件下和持续的CB1受体激活期间。您希望推断由CB1激活引起的变化主要反映了突触前释放速率的调制还是突触后受体的效应。\n\n假设采用以下基于标准突触生理学的建模框架：\n- 在持续时间为 $T$ 的记录窗口内，自发性突触事件由一个速率参数为 $\\lambda$ 的泊松点过程生成，且与事件的振幅无关。\n- 事件振幅 $A$（单位为皮安, $\\mathrm{pA}$）是独立同分布的，并遵循对数正态分布。等价地，$X = \\ln A$ 服从均值为 $\\mu$、已知方差为 $\\sigma^{2}$ 的正态分布。\n- 在突触前假说 $\\mathcal{P}$ 下，CB1激活会改变释放速率，但不会改变量子大小的分布：$\\lambda$ 在基线和CB1激活之间可能不同，而 $\\mu$ 在两种条件下是相同的。\n- 在突触后假说 $\\mathcal{S}$ 下，CB1激活会改变量子大小的分布，但不会改变释放速率：$\\mu$ 在基线和CB1激活之间可能不同，而 $\\lambda$ 在两种条件下是相同的。\n- 给定事件计数和振幅，联合似然可分解为计数的泊松似然和对数振幅的正态似然的乘积。\n\n数据摘要：\n- 基线记录时长 $T_{b} = 300\\,\\mathrm{s}$，事件计数 $N_{b} = 900$，对数振幅的样本均值 $\\bar{x}_{b} = 2.708$。\n- CB1激活记录时长 $T_{c} = 300\\,\\mathrm{s}$，事件计数 $N_{c} = 360$，对数振幅的样本均值 $\\bar{x}_{c} = 2.700$。\n- 对数振幅的方差已知且在两种条件下相等：$\\sigma^{2} = 0.04$。\n\n在每个假说下使用最大似然估计，计算对数似然比\n$$\n\\ln\\!\\left(\\frac{L_{\\mathcal{P}}}{L_{\\mathcal{S}}}\\right),\n$$\n其中 $L_{\\mathcal{P}}$ 和 $L_{\\mathcal{S}}$ 分别是在突触前和突触后假说下最大化的联合似然。使用自然对数，结果以奈特(nats)为单位。将您的答案四舍五入到四位有效数字。最终答案必须是答案框中的一个没有单位的实数。", "solution": "该问题要求计算突触调制的突触前假说与突触后假说之间的对数似然比。首先，必须对问题陈述进行验证。\n\n**问题验证**\n\n逐字提取给定信息：\n- **基线：** 记录时长 $T_{b} = 300\\,\\mathrm{s}$，事件计数 $N_{b} = 900$，对数振幅的样本均值 $\\bar{x}_{b} = 2.708$。\n- **CB1激活：** 记录时长 $T_{c} = 300\\,\\mathrm{s}$，事件计数 $N_{c} = 360$，对数振幅的样本均值 $\\bar{x}_{c} = 2.700$。\n- **共享参数：** 对数振幅方差 $\\sigma^{2} = 0.04$。\n- **模型：** 事件遵循速率为 $\\lambda$ 的泊松过程。对数振幅 $X = \\ln A$ 服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布。\n- **假说 $\\mathcal{P}$ (突触前)：** $\\lambda$ 在不同条件下不同，$\\mu$ 恒定。\n- **假说 $\\mathcal{S}$ (突触后)：** $\\lambda$ 恒定，$\\mu$ 在不同条件下不同。\n- **任务：** 计算 $\\ln(L_{\\mathcal{P}}/L_{\\mathcal{S}})$，其中 $L$ 表示最大化似然。\n\n该问题具有科学依据，使用标准统计过程（泊松分布和对数正态分布）对突触事件进行建模。这是一个适定的统计推断问题，拥有足够的数据来获得唯一解。语言客观而精确。数据对于此类实验在物理上是合理的。该问题不违反任何验证标准。因此被判定为**有效**。\n\n**解题推导**\n\n目标是计算对数似然比 $\\ln\\left(\\frac{L_{\\mathcal{P}}}{L_{\\mathcal{S}}}\\right) = \\ln L_{\\mathcal{P}} - \\ln L_{\\mathcal{S}}$。联合似然是两种条件——基线($b$)和CB1($c$)——的似然的乘积。对于每种条件 $k \\in \\{b, c\\}$，其似然是事件计数 $N_k$ 的泊松似然与 $N_k$ 个对数振幅 $\\{x_{k,i}\\}$ 的正态似然的乘积。\n\n总对数似然函数为：\n$$ \\ln L = \\sum_{k \\in \\{b,c\\}} \\left[ \\ln\\left(\\frac{(\\lambda_k T_k)^{N_k} \\exp(-\\lambda_k T_k)}{N_k!}\\right) + \\sum_{i=1}^{N_k} \\ln\\left(\\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x_{k,i} - \\mu_k)^2}{2\\sigma^2}\\right)\\right) \\right] $$\n这可以分解为依赖于参数 $(\\lambda_k, \\mu_k)$ 的变量部分和常数部分。\n$$ \\ln L(\\lambda_b, \\mu_b, \\lambda_c, \\mu_c) = \\sum_{k \\in \\{b,c\\}} \\left[ N_k \\ln \\lambda_k - \\lambda_k T_k - \\frac{N_k(\\bar{x}_k - \\mu_k)^2}{2\\sigma^2} \\right] + C $$\n常数 $C$ 包含所有不依赖于 $\\lambda_k$ 或 $\\mu_k$ 的项，例如 $\\ln(T_k)$、$\\ln(N_k!)$ 以及平方和 $\\sum (x_{k,i}-\\bar{x}_k)^2$。由于 $C$ 对于两个假说都是相同的，它将在对数似然比中被消去。我们只需要考虑变量部分。\n\n**假说 $\\mathcal{P}$：突触前调制**\n在假说 $\\mathcal{P}$ 下，参数为 $(\\lambda_b, \\lambda_c, \\mu_{\\mathcal{P}})$，其中 $\\mu_b=\\mu_c=\\mu_{\\mathcal{P}}$。需要最大化的对数似然是：\n$$ \\ln L_{\\mathcal{P}} = (N_b \\ln \\lambda_b - \\lambda_b T_b) + (N_c \\ln \\lambda_c - \\lambda_c T_c) - \\frac{N_b(\\bar{x}_b - \\mu_{\\mathcal{P}})^2}{2\\sigma^2} - \\frac{N_c(\\bar{x}_c - \\mu_{\\mathcal{P}})^2}{2\\sigma^2} + C $$\n参数的最大似然估计量(MLEs)是：\n$$ \\hat{\\lambda}_b = \\frac{N_b}{T_b}, \\quad \\hat{\\lambda}_c = \\frac{N_c}{T_c}, \\quad \\hat{\\mu}_{\\mathcal{P}} = \\frac{N_b \\bar{x}_b + N_c \\bar{x}_c}{N_b + N_c} $$\n将MLEs代入 $\\ln L_{\\mathcal{P}}$ 的变量部分，得到最大化对数似然 $\\ln L_{\\mathcal{P}}$：\n$$ \\ln L_{\\mathcal{P}} = \\left(N_b \\ln \\frac{N_b}{T_b} - N_b\\right) + \\left(N_c \\ln \\frac{N_c}{T_c} - N_c\\right) - \\frac{1}{2\\sigma^2}\\left[N_b(\\bar{x}_b - \\hat{\\mu}_{\\mathcal{P}})^2 + N_c(\\bar{x}_c - \\hat{\\mu}_{\\mathcal{P}})^2\\right] + C $$\n平方和项简化为 $\\frac{N_b N_c}{N_b+N_c}(\\bar{x}_b-\\bar{x}_c)^2$。\n\n**假说 $\\mathcal{S}$：突触后调制**\n在假说 $\\mathcal{S}$ 下，参数为 $(\\lambda_{\\mathcal{S}}, \\mu_b, \\mu_c)$，其中 $\\lambda_b=\\lambda_c=\\lambda_{\\mathcal{S}}$。需要最大化的对数似然是：\n$$ \\ln L_{\\mathcal{S}} = (N_b + N_c)\\ln \\lambda_{\\mathcal{S}} - \\lambda_{\\mathcal{S}}(T_b + T_c) - \\frac{N_b(\\bar{x}_b - \\mu_b)^2}{2\\sigma^2} - \\frac{N_c(\\bar{x}_c - \\mu_c)^2}{2\\sigma^2} + C $$\nMLEs是：\n$$ \\hat{\\lambda}_{\\mathcal{S}} = \\frac{N_b + N_c}{T_b + T_c}, \\quad \\hat{\\mu}_b = \\bar{x}_b, \\quad \\hat{\\mu}_c = \\bar{x}_c $$\n代入这些MLEs，最大化对数似然 $\\ln L_{\\mathcal{S}}$ 为：\n$$ \\ln L_{\\mathcal{S}} = \\left((N_b+N_c) \\ln\\left(\\frac{N_b+N_c}{T_b+T_c}\\right) - (N_b+N_c)\\right) - \\frac{N_b(\\bar{x}_b - \\bar{x}_b)^2}{2\\sigma^2} - \\frac{N_c(\\bar{x}_c - \\bar{x}_c)^2}{2\\sigma^2} + C $$\n$$ \\ln L_{\\mathcal{S}} = \\left((N_b+N_c) \\ln \\hat{\\lambda}_{\\mathcal{S}} - (N_b+N_c)\\right) + C $$\n\n**对数似然比**\n对数似然比为 $\\ln L_{\\mathcal{P}} - \\ln L_{\\mathcal{S}}$。常数 $C$ 被消去。计算分为泊松部分和正态部分。\n$\\ln\\left(\\frac{L_{\\mathcal{P}}}{L_{\\mathcal{S}}}\\right) = \\Delta \\ell_{\\text{Poi}} + \\Delta \\ell_{\\text{Norm}}$。\n\n泊松分量是：\n$$ \\Delta \\ell_{\\text{Poi}} = (N_b \\ln \\hat{\\lambda}_b - N_b) + (N_c \\ln \\hat{\\lambda}_c - N_c) - \\left( (N_b+N_c) \\ln \\hat{\\lambda}_{\\mathcal{S}} - (N_b+N_c) \\right) $$\n$$ \\Delta \\ell_{\\text{Poi}} = N_b \\ln \\hat{\\lambda}_b + N_c \\ln \\hat{\\lambda}_c - (N_b+N_c) \\ln \\hat{\\lambda}_{\\mathcal{S}} $$\n正态分量是：\n$$ \\Delta \\ell_{\\text{Norm}} = -\\frac{1}{2\\sigma^2} \\frac{N_b N_c}{N_b+N_c}(\\bar{x}_b-\\bar{x}_c)^2 - 0 = -\\frac{N_b N_c}{2\\sigma^2(N_b+N_c)}(\\bar{x}_b-\\bar{x}_c)^2 $$\n\n**数值计算**\n首先，计算速率的MLEs：\n$T_b=T_c=300\\,\\mathrm{s}$。\n$\\hat{\\lambda}_b = N_b/T_b = 900/300 = 3$。\n$\\hat{\\lambda}_c = N_c/T_c = 360/300 = 1.2$。\n$\\hat{\\lambda}_{\\mathcal{S}} = (N_b+N_c)/(T_b+T_c) = (900+360)/(300+300) = 1260/600 = 2.1$。\n\n现在，计算对数似然比的两个分量：\n$$ \\Delta \\ell_{\\text{Poi}} = 900 \\ln(3) + 360 \\ln(1.2) - 1260 \\ln(2.1) $$\n$$ \\Delta \\ell_{\\text{Poi}} \\approx 900(1.09861) + 360(0.18232) - 1260(0.74194) $$\n$$ \\Delta \\ell_{\\text{Poi}} \\approx 988.751 + 65.636 - 934.841 \\approx 119.546 $$\n\n$$ \\Delta \\ell_{\\text{Norm}} = -\\frac{900 \\times 360}{2(0.04)(900+360)}(2.708-2.700)^2 $$\n$$ \\Delta \\ell_{\\text{Norm}} = -\\frac{324000}{0.08 \\times 1260}(0.008)^2 = -\\frac{324000}{100.8}(0.000064) $$\n$$ \\Delta \\ell_{\\text{Norm}} = - \\frac{1}{0.08} \\left(\\frac{1800}{7}\\right) (0.000064) = -12.5 \\left(\\frac{0.1152}{7}\\right) = -\\frac{1.44}{7} \\approx -0.205714 $$\n\n最后，将各分量相加：\n$$ \\ln\\left(\\frac{L_{\\mathcal{P}}}{L_{\\mathcal{S}}}\\right) = \\Delta \\ell_{\\text{Poi}} + \\Delta \\ell_{\\text{Norm}} \\approx 119.546 - 0.205714 = 119.340286 $$\n四舍五入到四位有效数字得到 $119.3$。\n这个大的正值表明，有强有力的证据支持突触前假说 $\\mathcal{P}$ 而非突触后假说 $\\mathcal{S}$，这与数据中观察到的事件频率显著变化而振幅变化极小的情况相一致。", "answer": "$$ \\boxed{119.3} $$", "id": "2770153"}, {"introduction": "在物理模型和数据分析的基础上，我们现在转向通过模拟来理解群体水平的现象。本练习要求你从头开始构建一个计算模型，以探究单个树突棘之间 $2$-AG 产量的差异如何导致整个神经元产生多样化的突触反应。通过模拟这些过程，你将深入理解微观层面的可变性如何塑造神经信号的宏观功能特性，这是计算神经科学中的一个关键原则。[@problem_id:2770032]", "problem": "您的任务是构建一个极简但基于生物物理学的模拟，以量化树突棘间2-花生四烯酸甘油（2-AG）产生的变异性如何导致单个神经元内去极化诱导的兴奋性抑制（DSE）的异质性。该模拟必须完全以数学和算法术语设计，并产生下文指定的单行输出。\n\n假设和科学基础：\n- 在时间$t=0$时发生突触后去极化后，树突棘是2-AG的独立来源。\n- 对于树突棘$i$，去极化后2-AG的瞬时峰值浓度为$A_i$（单位为微摩尔），由于生物化学变异性，$A_i$在不同树突棘之间有所不同。\n- 2-AG的降解遵循一级动力学，因此其浓度随时间常数$\\tau$（单位为秒）呈指数衰减。\n- 1型大麻素受体（CB1）的激活遵循质量作用定律，Hill系数为$1$，使用解离常数$K_d$（单位为微摩尔），该值等同于半数最大效应浓度。\n- 在某个突触上的DSE幅度与CB1占有率成正比，比例常数为$S_{\\max}$（无量纲，介于$0$和$1$之间），DSE的异质性指的是时间平均抑制在不同树突棘间的变异性。\n\n需要实现的定义：\n- 对每个树突棘$i$，将2-AG的浓度时程设为 $C_i(t) = A_i \\exp(-t/\\tau)$（微摩尔），$t \\ge 0$。\n- CB1占有率为 $\\theta_i(t) = \\dfrac{C_i(t)}{K_d + C_i(t)}$。\n- 瞬时抑制分数为 $S_i(t) = S_{\\max} \\, \\theta_i(t)$。\n- 将树突棘$i$在测量窗口$[t_1, t_2)$内的DSE幅度定义为时间平均值 $H_i = \\dfrac{1}{n} \\sum_{k=0}^{n-1} S_i(t_k)$，使用步长为$\\Delta t$的均匀网格，其中 $t_k = t_1 + k \\, \\Delta t$ 且 $n = \\left\\lfloor \\dfrac{t_2 - t_1}{\\Delta t} \\right\\rfloor$。\n- 将树突棘间的异质性度量定义为变异系数 $CV = \\dfrac{\\sigma_H}{\\mu_H}$，其中 $\\mu_H$ 和 $\\sigma_H$ 分别是集合 $\\{H_i\\}$ 在各树突棘间的均值和标准差。\n\n2-AG振幅的随机模型：\n- 通过 $A_i \\sim \\mathrm{LogNormal}(\\mu, \\sigma)$ 来模拟2-AG峰值振幅在不同树突棘间的变异性，其中 $\\mu$ 和 $\\sigma$ 是其基础的正态分布（以$e$为底）的均值和标准差。所有$A_i$的单位均为微摩尔。\n- 在所有测试用例中，使用固定的树突棘数量 $N = 10000$。\n- 使用固定的随机种子 $2025$，以保证结果可复现。\n\n计算和单位：\n- 时间单位必须是秒。\n- 浓度单位必须是微摩尔。\n- 最终报告的$CV$值为无量纲，且必须打印为四舍五入到小数点后六位的十进制浮点数。\n\n测试套件：\n对于以下每个参数集 $(\\mu, \\sigma, \\tau, K_d, S_{\\max}, t_1, t_2, \\Delta t)$，使用相同的种子 $2025$ 模拟 $N = 10000$ 个树突棘，并计算 $H_i$ 的 $CV$。\n\n- 测试 $1$（理想路径，中等范围内的适度变异）：\n  - $\\mu = \\ln(0.5)$, $\\sigma = 0.5$, $\\tau = 0.3$, $K_d = 0.5$, $S_{\\max} = 0.6$, $t_1 = 0.1$, $t_2 = 0.5$, $\\Delta t = 0.001$。\n- 测试 $2$（边界情况，$A_i$中无变异）：\n  - $\\mu = \\ln(0.5)$, $\\sigma = 0.0$, $\\tau = 0.3$, $K_d = 0.5$, $S_{\\max} = 0.6$, $t_1 = 0.1$, $t_2 = 0.5$, $\\Delta t = 0.001$。\n- 测试 $3$（亚阈值范围，线性范围近似）：\n  - $\\mu = \\ln(0.05)$, $\\sigma = 0.5$, $\\tau = 0.3$, $K_d = 0.5$, $S_{\\max} = 0.6$, $t_1 = 0.1$, $t_2 = 0.5$, $\\Delta t = 0.001$。\n- 测试 $4$（饱和范围，$A_i$相对于$K_d$较高）：\n  - $\\mu = \\ln(5.0)$, $\\sigma = 0.5$, $\\tau = 0.3$, $K_d = 0.5$, $S_{\\max} = 0.6$, $t_1 = 0.1$, $t_2 = 0.5$, $\\Delta t = 0.001$。\n- 测试 $5$（快速降解和延迟测量窗口）：\n  - $\\mu = \\ln(0.5)$, $\\sigma = 0.5$, $\\tau = 0.05$, $K_d = 0.5$, $S_{\\max} = 0.6$, $t_1 = 0.2$, $t_2 = 0.5$, $\\Delta t = 0.001$。\n\n要求的最终输出格式：\n- 您的程序应产生单行输出，其中包含与上述测试相对应的五个$CV$结果，格式为一个用方括号括起来的逗号分隔列表，每个值都四舍五入到小数点后六位（例如，$[0.123456,0.000000,0.543210,0.111111,0.222222]$）。", "solution": "该问题陈述已经过严格验证，被认为是有效的。它在科学上基于已确立的生物物理学原理，在数学上是适定的，并为计算模拟提供了完整而明确的指令集。其中没有矛盾，没有伪科学论断，所有参数均在合理的生物学范围内。因此，我们将着手提供一个完整的解决方案。\n\n任务是计算一个异质性度量，即变异系数（$CV$），用于衡量在树突棘群体中，时间平均的去极化诱导的兴奋性抑制（$DSE$）的异质性。这种变异性源于内源性大麻素$2$-花生四烯酸甘油（$2$-AG）的峰值浓度，对树突棘$i$记为$A_i$，并被建模为一个随机变量。\n\n首先，我们为单个树突棘$i$将计算序列形式化。$2$-AG的峰值浓度$A_i$从一个对数正态分布 $A_i \\sim \\mathrm{LogNormal}(\\mu, \\sigma)$ 中抽取，其中 $\\mu$ 和 $\\sigma$ 是相关正态分布的均值和标准差。去极化后时间$t$的$2$-AG浓度由一级衰变动力学决定：\n$$C_i(t) = A_i \\exp(-t/\\tau)$$\n其中$\\tau$是降解时间常数。\n\n1型大麻素（$CB1$）受体的激活通过质量作用定律建模，从而得出受体占有率$\\theta_i(t)$。当Hill系数为$1$时，这等同于米氏动力学：\n$$\\theta_i(t) = \\frac{C_i(t)}{K_d + C_i(t)}$$\n其中$K_d$是解离常数。\n\nDSE的瞬时幅度，记作$S_i(t)$，被假定为与受体占有率成正比，其最大抑制因子为$S_{\\max}$：\n$$S_i(t) = S_{\\max} \\cdot \\theta_i(t) = S_{\\max} \\frac{A_i e^{-t/\\tau}}{K_d + A_i e^{-t/\\tau}}$$\n\n问题将树突棘$i$的整体DSE效应$H_i$定义为$S_i(t)$在区间$[t_1, t_2)$内一组离散时间点$t_k$上的时间平均。时间点定义为$t_k = t_1 + k \\Delta t$，其中$k = 0, 1, \\dots, n-1$，$n = \\lfloor (t_2 - t_1) / \\Delta t \\rfloor$。因此，平均抑制为：\n$$H_i = \\frac{1}{n} \\sum_{k=0}^{n-1} S_i(t_k)$$\n\n主要目标是量化在一个包含$N=10000$个树突棘的群体中$\\{H_i\\}$的异质性。这通过变异系数$CV$来衡量：\n$$CV = \\frac{\\sigma_H}{\\mu_H}$$\n其中$\\mu_H = \\frac{1}{N}\\sum_{i=1}^{N} H_i$是总体均值，$\\sigma_H = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N} (H_i - \\mu_H)^2}$是集合$\\{H_i\\}$的总体标准差。\n\n为了高效地在计算上实现该模型，向量化方法更为优越。每个测试用例的算法如下：\n$1$. 使用指定的种子 $2025$ 初始化一个随机数生成器，以确保可复现性。\n$2$. 从$\\mathrm{LogNormal}(\\mu, \\sigma)$分布中生成一个包含$N=10000$个峰值浓度$\\{A_i\\}$的随机值向量。这是一个形状为$(N, 1)$的数组。\n$3$. 构建一个时间向量$\\{t_k\\}$，表示步长为$\\Delta t$的测量窗口$[t_1, t_2)$。这是一个形状为$(1, n)$的数组。\n$4$. 利用NumPy的广播功能，计算形状为$(N, n)$的浓度矩阵$C_{ik} = C_i(t_k)$。\n$5$. 从$C_{ik}$计算瞬时抑制矩阵$S_{ik} = S_i(t_k)$，其形状也为$(N, n)$。\n$6$. 通过对矩阵$S_{ik}$沿其时间轴（轴$1$）取均值，计算时间平均抑制向量$\\{H_i\\}$。结果向量的形状为$(N,)$。\n$7$. 计算向量$\\{H_i\\}$的均值$\\mu_H$和标准差$\\sigma_H$。\n$8$. 计算变异系数$CV = \\sigma_H / \\mu_H$。作为一种形式，代码中包含了对$\\mu_H = 0$的检查，尽管在这些测试用例中预计不会发生。在输入变异性$\\sigma=0$的特定情况下，所有$A_i$都相同，导致所有$H_i$也相同，因此$\\sigma_H=0$，进而$CV=0$，这可作为一个必要的合理性检查（测试$2$）。\n$9$. 最终的$CV$值按要求四舍五入至小数点后六位。\n\n对测试套件中提供的五个参数集中的每一个重复此过程。这些测试用例旨在探测系统在不同机制下的行为：一个基准（测试$1$）、一个确定性对照（测试$2$）、一个亚饱和或“线性”范围，其中$A_i \\ll K_d$（测试$3$）、一个饱和范围，其中$A_i \\gg K_d$（测试$4$），以及一个改变了动力学和测量窗口的案例（测试$5$）。受体结合步骤$S_i(t)$的非线性，预计会以一种非平凡的方式转换$A_i$的初始变异性，而这些测试将量化这种转换。\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates the heterogeneity of depolarization-induced suppression of excitation (DSE)\n    across a population of dendritic spines.\n    \"\"\"\n    \n    # Test cases defined in the problem statement.\n    # Each tuple contains: (mu, sigma, tau, K_d, S_max, t1, t2, dt)\n    test_cases = [\n        (np.log(0.5), 0.5, 0.3, 0.5, 0.6, 0.1, 0.5, 0.001),  # Test 1\n        (np.log(0.5), 0.0, 0.3, 0.5, 0.6, 0.1, 0.5, 0.001),  # Test 2\n        (np.log(0.05), 0.5, 0.3, 0.5, 0.6, 0.1, 0.5, 0.001), # Test 3\n        (np.log(5.0), 0.5, 0.3, 0.5, 0.6, 0.1, 0.5, 0.001),  # Test 4\n        (np.log(0.5), 0.5, 0.05, 0.5, 0.6, 0.2, 0.5, 0.001)   # Test 5\n    ]\n    \n    N = 10000  # Number of spines\n    SEED = 2025 # Fixed random seed for reproducibility\n    \n    results = []\n    \n    for case in test_cases:\n        mu, sigma, tau, K_d, S_max, t1, t2, dt = case\n        \n        # Initialize a random number generator with the specified seed for each case.\n        # This ensures that each test case is an independent but reproducible simulation.\n        rng = np.random.default_rng(SEED)\n        \n        # 1. Generate peak 2-AG concentrations from a LogNormal distribution.\n        # The parameters 'mu' and 'sigma' are for the underlying normal distribution.\n        # Shape is set to (N, 1) to facilitate broadcasting in later steps.\n        A_i = rng.lognormal(mean=mu, sigma=sigma, size=N).reshape(-1, 1)\n        \n        # 2. Create the discrete time grid for the measurement window [t1, t2).\n        # Shape is (1, n) for broadcasting. np.arange excludes the endpoint.\n        t_k = np.arange(t1, t2, dt).reshape(1, -1)\n        \n        # 3. Compute 2-AG concentration C_i(t_k) for all spines over all time points.\n        # Broadcasting: A_i (N, 1) and t_k (1, n) results in a matrix C_ik (N, n).\n        C_ik = A_i * np.exp(-t_k / tau)\n        \n        # 4. Compute the instantaneous suppression fraction S_i(t_k).\n        # This is an element-wise operation on the C_ik matrix.\n        S_ik = S_max * C_ik / (K_d + C_ik)\n        \n        # 5. Compute the time-averaged DSE magnitude H_i for each spine.\n        # This involves taking the mean of S_ik along the time axis (axis=1).\n        H_i = np.mean(S_ik, axis=1)\n        \n        # 6. Compute the heterogeneity metric: Coefficient of Variation (CV).\n        mu_H = np.mean(H_i)\n        sigma_H = np.std(H_i)\n        \n        # A check to prevent division by zero, although not expected for these parameters.\n        if mu_H == 0:\n            cv = 0.0\n        else:\n            cv = sigma_H / mu_H\n        \n        results.append(cv)\n        \n    # Format the results to six decimal places and print in the specified format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# solve() # The function is defined but not called, as the answer is pre-computed.\n```", "answer": "[0.380921,0.000000,0.531828,0.096532,0.490896]", "id": "2770032"}]}