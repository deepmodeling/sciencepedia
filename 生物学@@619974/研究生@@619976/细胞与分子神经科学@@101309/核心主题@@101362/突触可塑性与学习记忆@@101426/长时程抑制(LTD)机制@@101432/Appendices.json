{"hands_on_practices": [{"introduction": "许多形式的长时程抑制 (LTD) 的最终表达是突触后受体数量的减少。这个练习通过一个基础但功能强大的双室模型，让你能够亲手计算受体运输速率的变化——特别是内吞作用 ($k_{\\mathrm{endo}}$) 的增加——如何导致表面受体 ($R_s$) 达到一个新的、更低的稳态水平。通过完成这个计算 [@problem_id:2722066]，你将为突触强度如何通过受体插入和移除的动态平衡来调节建立一个基础的、定量的直觉。", "problem": "兴奋性突触中长时程抑制 (LTD) 的一个典型机制是，在表达的时间窗口内，突触后膜上的α-氨基-3-羟基-5-甲基-4-异恶唑丙酸 (AMPA) 受体由网格蛋白介导的内吞作用持续增加，而胞吐作用相对不变。考虑一个AMPA型谷氨酸受体的双室运输模型，其中包含一个表面受体池 $R_{s}(t)$ 和一个内部受体池 $R_{i}(t)$，并假设在相关时间尺度上，受体总数 $R_{T}$ 是守恒的。表面池的动力学由以下质量作用平衡给出\n$$\n\\frac{dR_{s}}{dt} \\;=\\; k_{\\mathrm{exo}}\\,R_{i} \\;-\\; k_{\\mathrm{endo}}\\,R_{s},\n$$\n其中 $k_{\\mathrm{exo}}$ 和 $k_{\\mathrm{endo}}$ 分别是胞吐和内吞速率常数。在LTD诱导后，内吞速率从 $k_{\\mathrm{endo}}=0.01\\,\\mathrm{s^{-1}}$ 翻倍至 $k_{\\mathrm{endo}}=0.02\\,\\mathrm{s^{-1}}$，而胞吐速率保持为 $k_{\\mathrm{exo}}=0.005\\,\\mathrm{s^{-1}}$。受体总数为 $R_{T}=1000$。\n\n请仅使用受体总数守恒和 $R_{s}$ 的稳态通量平衡条件，推导一个用 $R_{T}$、$k_{\\mathrm{exo}}$ 和 $k_{\\mathrm{endo}}$ 表示的稳态表面受体数 $R_{s}^{*}$ 的表达式，然后计算LTD后的新稳态值。请以单个数字（无单位）报告最终答案。无需四舍五入。", "solution": "在尝试任何求解之前，本问题将首先经过严格的验证过程。\n\n已知条件逐字从问题陈述中提取如下：\n- 该系统是一个双室模型，包含一个表面受体池 $R_{s}(t)$ 和一个内部受体池 $R_{i}(t)$。\n- 受体总数 $R_{T}$ 是守恒的：$R_{T} = R_{s}(t) + R_{i}(t)$。\n- 表面池的动力学由以下微分方程控制：$\\frac{dR_{s}}{dt} = k_{\\mathrm{exo}}\\,R_{i} - k_{\\mathrm{endo}}\\,R_{s}$。\n- 胞吐速率常数为 $k_{\\mathrm{exo}}=0.005\\,\\mathrm{s^{-1}}$。\n- LTD诱导后，内吞速率常数为 $k_{\\mathrm{endo}}=0.02\\,\\mathrm{s^{-1}}$。\n- 受体总数为 $R_{T}=1000$。\n\n该问题被评估为有效。它具有科学依据，利用了一个基于质量作用动力学的AMPA受体运输的标准且广为接受的简化模型。该问题是适定的，因为其控制性常系数线性常微分方程具有唯一且稳定的稳态解。该问题是客观的，并为得出唯一解提供了所有必要的数据，不包含任何矛盾、事实错误或歧义。\n\n目标是首先推导一个用 $R_{T}$、$k_{\\mathrm{exo}}$ 和 $k_{\\mathrm{endo}}$ 表示的稳态表面受体数 $R_{s}^{*}$ 的通用代数表达式。然后，该表达式将用于计算长时程抑制 (LTD) 诱导后的 $R_{s}^{*}$ 的具体值。\n\n在稳态下，表面受体的数量是恒定的，这意味着其时间导数为零：\n$$\n\\frac{dR_{s}}{dt} = 0\n$$\n将此条件应用于控制性微分方程，得到通量平衡方程，该方程表明胞吐速率等于内吞速率：\n$$\nk_{\\mathrm{exo}}\\,R_{i}^{*} = k_{\\mathrm{endo}}\\,R_{s}^{*}\n$$\n此处，$R_{s}^{*}$ 和 $R_{i}^{*}$ 分别代表稳态下表面和内部池中的受体数量。\n\n第二个控制原则是受体总数 $R_{T}$ 守恒：\n$$\nR_{T} = R_{s}^{*} + R_{i}^{*}\n$$\n我们可以用总受体和表面受体来表示内部受体的数量 $R_{i}^{*}$：\n$$\nR_{i}^{*} = R_{T} - R_{s}^{*}\n$$\n现在，将这个 $R_{i}^{*}$ 的表达式代入通量平衡方程。这使我们能够构建一个仅包含 $R_{s}^{*}$ 和系统参数的方程。\n$$\nk_{\\mathrm{exo}}(R_{T} - R_{s}^{*}) = k_{\\mathrm{endo}}\\,R_{s}^{*}\n$$\n我们继续求解这个关于 $R_{s}^{*}$ 的线性代数方程。首先，展开 $k_{\\mathrm{exo}}$ 项：\n$$\nk_{\\mathrm{exo}}R_{T} - k_{\\mathrm{exo}}R_{s}^{*} = k_{\\mathrm{endo}}\\,R_{s}^{*}\n$$\n接下来，将所有包含 $R_{s}^{*}$ 的项移到方程的一侧：\n$$\nk_{\\mathrm{exo}}R_{T} = k_{\\mathrm{endo}}R_{s}^{*} + k_{\\mathrm{exo}}R_{s}^{*}\n$$\n提取公因子 $R_{s}^{*}$：\n$$\nk_{\\mathrm{exo}}R_{T} = (k_{\\mathrm{exo}} + k_{\\mathrm{endo}})R_{s}^{*}\n$$\n最后，通过分离出 $R_{s}^{*}$，我们得到稳态表面受体数的通用表达式：\n$$\nR_{s}^{*} = \\frac{k_{\\mathrm{exo}}R_{T}}{k_{\\mathrm{exo}} + k_{\\mathrm{endo}}}\n$$\n至此，问题的推导部分完成。\n\n现在，我们必须使用给定的数值计算LTD诱导后 $R_{s}^{*}$ 的新稳态值：\n- $R_{T} = 1000$\n- $k_{\\mathrm{exo}} = 0.005\\,\\mathrm{s^{-1}}$\n- $k_{\\mathrm{endo}} = 0.02\\,\\mathrm{s^{-1}}$\n\n将这些值代入我们推导出的表达式中：\n$$\nR_{s}^{*} = \\frac{(0.005)(1000)}{0.005 + 0.02}\n$$\n进行算术运算：\n$$\nR_{s}^{*} = \\frac{5}{0.025}\n$$\n为简化此分数，我们可以将分子和分母同乘以 $1000$：\n$$\nR_{s}^{*} = \\frac{5000}{25}\n$$\n化简为：\n$$\nR_{s}^{*} = 200\n$$\n因此，在内吞速率翻倍后，系统达到一个新的稳态，此时突触后膜上有 $200$ 个受体。", "answer": "$$\n\\boxed{200}\n$$", "id": "2722066"}, {"introduction": "在理解了受体移除是 LTD 的核心结果后，本实践将探究其上游触发因素：细胞内钙离子 ($\\mathrm{Ca^{2+}}$) 信号的具体性质。突触可塑性的“钙离子假说”提出，$\\mathrm{Ca^{2+}}$ 瞬变的动态特性决定了可塑性的方向。这项计算练习 [@problem_id:2722045] 要求你模拟并比较由 NMDARs 和 VGCCs 两种不同来源产生的 $\\mathrm{Ca^{2+}}$ 信号，重点关注那种被认为能优先激活驱动 LTD 的磷酸酶的“缓慢、低振幅”信号特征。", "problem": "设计并实现一个程序，该程序模拟由一串突触脉冲诱发的胞浆钙离子($\\mathrm{Ca}^{2+}$)瞬变，并比较两种$\\mathrm{Ca}^{2+}$流入源：N-甲基-D-天冬氨酸受体(NMDAR)和电压门控钙离子通道(VGCC)。目标是针对每组指定的参数集，确定哪种来源产生的$\\mathrm{Ca}^{2+}$信号同时具有缓慢衰减和低峰值振幅的特点，这些特征与长时程抑制(LTD)的诱导相关。在给定指定的随机种子的情况下，程序必须是完全确定性的。\n\n基本和建模假设：\n- 使用线性时不变叠加来模拟由单个脉冲产生的$\\mathrm{Ca}^{2+}$浓度瞬变。对于一个来源 $s \\in \\{\\mathrm{N}, \\mathrm{V}\\}$ (NMDAR或VGCC)，在时间 $t_i$ 由单个脉冲诱发的瞬变由双指数核函数建模\n$$\nh_s(t; \\tau_{r,s}, \\tau_{d,s}) = \\begin{cases}\n\\exp(-t/\\tau_{d,s}) - \\exp(-t/\\tau_{r,s}), & t \\ge 0,\\\\\n0, & t < 0,\n\\end{cases}\n$$\n其中 $\\tau_{r,s} > 0$ 且 $\\tau_{d,s} > \\tau_{r,s}$。\n- 将每个核函数归一化至单位峰值，使得振幅参数直接缩放单个孤立脉冲的峰值贡献。令\n$$\nt_{\\mathrm{peak},s} = \\frac{\\tau_{d,s}\\,\\tau_{r,s}}{\\tau_{d,s}-\\tau_{r,s}} \\ln\\!\\left(\\frac{\\tau_{d,s}}{\\tau_{r,s}}\\right), \\quad\nH_{\\max,s} = h_s(t_{\\mathrm{peak},s}; \\tau_{r,s}, \\tau_{d,s}),\n$$\n并定义归一化核函数\n$$\n\\tilde{h}_s(t) = \\frac{h_s(t; \\tau_{r,s}, \\tau_{d,s})}{H_{\\max,s}}.\n$$\n- 模拟一串包含5个脉冲的爆发，其名义时间为 $t_n^{(0)} = n \\cdot 50\\,\\mathrm{ms}$，其中 $n \\in \\{0,1,2,3,4\\}$ (即 $20\\,\\mathrm{Hz}$)。通过添加独立的、单位为毫秒的高斯抖动 $\\epsilon_n \\sim \\mathcal{N}(0,\\sigma_{\\mathrm{jit}}^2)$ 来引入时间随机性，然后对扰动后的时间进行排序以保持因果性：\n$$\nt_n = \\mathrm{sort}\\left(t_n^{(0)} + \\epsilon_n\\right).\n$$\n- 使用均值为1、变异系数为$CV_s$的独立对数正态乘子 $w_{n,s}$ 来模拟每个脉冲的振幅变异性。若 $\\ln w_{n,s} \\sim \\mathcal{N}(\\mu_s,\\sigma_s^2)$ 且 $\\mathbb{E}[w_{n,s}] = 1$ 和 $\\mathrm{CV}[w_{n,s}] = CV_s$，则 $\\sigma_s^2 = \\ln(1+CV_s^2)$ 且 $\\mu_s = -\\sigma_s^2/2$。\n- 来源 $s$ 的总$\\mathrm{Ca}^{2+}$浓度轨迹为\n$$\nC_s(t) = \\sum_{n=0}^{4} A_s \\, w_{n,s} \\, \\tilde{h}_s(t - t_n),\n$$\n该轨迹在均匀时间网格 $t = 0, \\Delta t, 2\\Delta t, \\ldots, T_{\\max}$ 上进行评估，其中 $\\Delta t$ 和 $T_{\\max}$ 是给定的。\n\nLTD样信号特征的决策规则：\n- 对于每个来源 $s$，计算峰值浓度和峰后半衰期：\n  - 峰值振幅：$C_{\\mathrm{peak},s} = \\max_t C_s(t)$，及其对应的峰值时间 $t_{\\mathrm{peak},s}^{\\mathrm{obs}} = \\arg\\max_t C_s(t)$。\n  - 半衰期：$t_{\\frac{1}{2},s}$ 是满足 $C_s(t_{\\mathrm{peak},s}^{\\mathrm{obs}} + \\Delta t') \\le \\tfrac{1}{2} C_{\\mathrm{peak},s}$ 的最小 $\\Delta t' \\ge 0$；如果在 $[0,T_{\\max}]$ 范围内不存在这样的时间，则取 $t_{\\frac{1}{2},s} = T_{\\max} - t_{\\mathrm{peak},s}^{\\mathrm{obs}}$。\n- 如果一个来源的峰值严格小于且半衰期严格长于另一个来源，则该来源被认为更具LTD样特征。如果只有一个来源满足这两个不等式，则选择该来源。否则，计算LTD分数\n$$\nS_s = \\frac{t_{\\frac{1}{2},s}}{C_{\\mathrm{peak},s}},\n$$\n并选择具有较大 $S_s$ 的来源。如果 $|S_{\\mathrm{N}} - S_{\\mathrm{V}}| \\le \\varepsilon$ 且 $\\varepsilon = 10^{-9}$，则按惯例选择NMDAR。\n\n程序要求：\n- 完全按照上述说明实现模型和决策规则。\n- 使用提供的随机种子来初始化伪随机数生成器，以便每个测试用例的抖动和对数正态乘子都是可复现的。\n- 时间单位必须是毫秒。所有模拟都必须使用每个案例指定的 $\\Delta t$ 和 $T_{\\max}$。\n- 程序的最终输出必须是单行，包含一个整数列表，每个测试用例对应一个整数，其中1表示预测NMDAR会产生具有LTD特征的缓慢、低振幅的$\\mathrm{Ca}^{2+}$升高，而0表示VGCC。\n\n测试套件（每个元组是一个测试用例）：\n- 案例A（典型动力学；中等噪声和抖动）：\n  - Seed: $12345$\n  - $\\sigma_{\\mathrm{jit}} = 2\\,\\mathrm{ms}$\n  - $CV_{\\mathrm{N}} = 0.2$, $CV_{\\mathrm{V}} = 0.2$\n  - NMDAR: $A_{\\mathrm{N}} = 0.4$, $\\tau_{r,\\mathrm{N}} = 10\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{N}} = 150\\,\\mathrm{ms}$\n  - VGCC: $A_{\\mathrm{V}} = 1.0$, $\\tau_{r,\\mathrm{V}} = 1\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{V}} = 25\\,\\mathrm{ms}$\n  - $\\Delta t = 0.1\\,\\mathrm{ms}$, $T_{\\max} = 1000\\,\\mathrm{ms}$\n- 案例B（振幅边界情况；动力学与案例A相同）：\n  - Seed: $24680$\n  - $\\sigma_{\\mathrm{jit}} = 2\\,\\mathrm{ms}$\n  - $CV_{\\mathrm{N}} = 0.2$, $CV_{\\mathrm{V}} = 0.2$\n  - NMDAR: $A_{\\mathrm{N}} = 0.8$, $\\tau_{r,\\mathrm{N}} = 10\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{N}} = 150\\,\\mathrm{ms}$\n  - VGCC: $A_{\\mathrm{V}} = 0.9$, $\\tau_{r,\\mathrm{V}} = 1\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{V}} = 25\\,\\mathrm{ms}$\n  - $\\Delta t = 0.1\\,\\mathrm{ms}$, $T_{\\max} = 1000\\,\\mathrm{ms}$\n- 案例C（VGCC具有延长衰减和较低振幅；测试VGCC作为潜在LTD样来源）：\n  - Seed: $13579$\n  - $\\sigma_{\\mathrm{jit}} = 3\\,\\mathrm{ms}$\n  - $CV_{\\mathrm{N}} = 0.25$, $CV_{\\mathrm{V}} = 0.25$\n  - NMDAR: $A_{\\mathrm{N}} = 0.6$, $\\tau_{r,\\mathrm{N}} = 8\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{N}} = 120\\,\\mathrm{ms}$\n  - VGCC: $A_{\\mathrm{V}} = 0.25$, $\\tau_{r,\\mathrm{V}} = 1\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{V}} = 200\\,\\mathrm{ms}$\n  - $\\Delta t = 0.1\\,\\mathrm{ms}$, $T_{\\max} = 1200\\,\\mathrm{ms}$\n- 案例D（边缘案例：相同的动力学和振幅，确定性的时间和振幅）：\n  - Seed: $777$\n  - $\\sigma_{\\mathrm{jit}} = 0\\,\\mathrm{ms}$\n  - $CV_{\\mathrm{N}} = 0.0$, $CV_{\\mathrm{V}} = 0.0$\n  - NMDAR: $A_{\\mathrm{N}} = 0.5$, $\\tau_{r,\\mathrm{N}} = 5\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{N}} = 150\\,\\mathrm{ms}$\n  - VGCC: $A_{\\mathrm{V}} = 0.5$, $\\tau_{r,\\mathrm{V}} = 5\\,\\mathrm{ms}$, $\\tau_{d,\\mathrm{V}} = 150\\,\\mathrm{ms}$\n  - $\\Delta t = 0.1\\,\\mathrm{ms}$, $T_{\\max} = 1000\\,\\mathrm{ms}$\n\n最终输出格式：\n- 你的程序应生成一行输出，其中包含一个用方括号括起来、以逗号分隔的结果列表（例如，$[1,0,1,1]$），其中第 $k$ 个条目对应于按 A、B、C、D 顺序排列的第 $k$ 个测试用例，每个条目若为 $1$ 则表示选择 NMDAR，若为 $0$ 则表示选择 VGCC。", "solution": "所提出的问题是计算神经科学领域一个有效且适定的练习。它要求基于已建立的生物物理模型实现一个确定性模拟，以研究N-甲基-D-天冬氨酸受体(NMDAR)和电压门控钙离子通道(VGCC)在塑造胞浆钙离子($\\mathrm{Ca}^{2+}$)信号中的不同作用，而这些信号是诸如长时程抑制(LTD)等突触可塑性现象的基础。该问题具有科学依据，其数学描述无歧义，并包含了获得唯一解所需的所有参数和条件。因此，我的分析将直接着手构建解决方案。\n\n解决方案是通过严格按照规定实现模型来构建的。模型的核心是线性时不变(LTI)叠加原理，这是一种标准近似方法，适用于单个输入产生的效应可以线性相加的系统。\n\n首先，我们为每个钙来源 $s \\in \\{\\mathrm{N}, \\mathrm{V}\\}$ 定义基本响应，即核函数。问题指定了一个双指数函数：\n$$\nh_s(t; \\tau_{r,s}, \\tau_{d,s}) = \\begin{cases}\n\\exp(-t/\\tau_{d,s}) - \\exp(-t/\\tau_{r,s}), & t \\ge 0\\\\\n0, & t < 0\n\\end{cases}\n$$\n其中 $\\tau_{r,s}$ 是上升时间常数，$\\tau_{d,s}$ 是衰减时间常数。条件 $\\tau_{d,s} > \\tau_{r,s}$ 确保了与物理现实一致的正向脉冲形状。\n\n为在同等基础上比较不同动力学的信号，将核函数归一化，使其峰值振幅为1。峰值时间 $t_{\\mathrm{peak},s}$可通过求解 $dh_s/dt = 0$ 获得：\n$$\nt_{\\mathrm{peak},s} = \\frac{\\tau_{d,s}\\,\\tau_{r,s}}{\\tau_{d,s}-\\tau_{r,s}} \\ln\\!\\left(\\frac{\\tau_{d,s}}{\\tau_{r,s}}\\right)\n$$\n未归一化核函数的峰值为 $H_{\\max,s} = h_s(t_{\\mathrm{peak},s}; \\tau_{r,s}, \\tau_{d,s})$。归一化的核函数 $\\tilde{h}_s(t)$ 则为：\n$$\n\\tilde{h}_s(t) = \\frac{h_s(t; \\tau_{r,s}, \\tau_{d,s})}{H_{\\max,s}}\n$$\n这种归一化确保了振幅参数 $A_s$ 直接缩放单个孤立突触事件的峰值贡献。为提高计算效率，这个归一化核函数 $\\tilde{h}_s(t)$ 将在模拟时间网格上被预先计算。\n\n接下来，我们对突触输入进行建模，该输入是一串包含5个脉冲的爆发。名义脉冲时间由 $t_n^{(0)} = n \\cdot 50\\,\\mathrm{ms}$ ($n \\in \\{0, 1, 2, 3, 4\\}$) 给出，对应于20 Hz的发放频率。通过两个随机过程引入生物学真实性，其可复现性由每个测试用例指定的随机种子保证。\n1.  **时间抖动**：通过添加独立高斯噪声 $\\epsilon_n \\sim \\mathcal{N}(0, \\sigma_{\\mathrm{jit}}^2)$ 来扰动脉冲时间。对得到的时间进行排序以保持因果顺序：$t_n = \\mathrm{sort}(t_n^{(0)} + \\epsilon_n)$。\n2.  **振幅变异性**：每个脉冲贡献的有效振幅由一个独立的随机权重 $w_{n,s}$ 进行缩放。这些权重从一个对数正态分布中抽取，使其均值为 $\\mathbb{E}[w_{n,s}] = 1$，变异系数为 $\\mathrm{CV}[w_{n,s}] = CV_s$。其底层正态分布 $\\ln w_{n,s} \\sim \\mathcal{N}(\\mu_s, \\sigma_s^2)$ 的参数由关系式 $\\sigma_s^2 = \\ln(1+CV_s^2)$ 和 $\\mu_s = -\\sigma_s^2/2$ 决定。\n\n来源 $s$ 的总$\\mathrm{Ca}^{2+}$浓度 $C_s(t)$ 是对脉冲串中每个脉冲响应的线性叠加：\n$$\nC_s(t) = \\sum_{n=0}^{4} A_s \\, w_{n,s} \\, \\tilde{h}_s(t - t_n)\n$$\n该求和在时间步长为 $\\Delta t$、从 $t=0$ 到 $t=T_{\\max}$ 的离散时间网格上进行评估。实现将采用一种计算上高效的移位-累加方法，这是一种卷积的离散近似方法，其中预计算的核函数 $\\tilde{h}_s(t)$ 根据每个脉冲时间 $t_n$ 进行移位、缩放和累加。\n\n最后，必须为每个参数集做出决策。这需要从每个模拟的轨迹 $C_s(t)$ 中提取两个关键指标：\n1.  **峰值振幅**：$C_{\\mathrm{peak},s} = \\max_t C_s(t)$。\n2.  **半衰期**：$t_{\\frac{1}{2},s}$，即信号从其峰值下降到峰值一半所需的时间。我们找到峰值时间 $t_{\\mathrm{peak},s}^{\\mathrm{obs}} = \\arg\\max_t C_s(t)$，然后搜索满足 $C_s(t_{\\mathrm{peak},s}^{\\mathrm{obs}} + \\Delta t') \\le \\frac{1}{2} C_{\\mathrm{peak},s}$ 的最小时间 $\\Delta t' \\ge 0$。这个 $\\Delta t'$ 就是 $t_{\\frac{1}{2},s}$。如果在 $T_{\\max}$ 之前浓度没有衰减到这个水平，我们则取 $t_{\\frac{1}{2},s} = T_{\\max} - t_{\\mathrm{peak},s}^{\\mathrm{obs}}$。\n\n将低振幅、慢衰减信号与LTD关联的决策规则如下：\n- 当且仅当一个来源同时展现出比另一个来源严格更小的峰值 ($C_{\\mathrm{peak}}$) 和严格更长的半衰期 ($t_{\\frac{1}{2}}$) 时，才选择该来源。\n- 否则，选择具有更高LTD分数 $S_s = t_{\\frac{1}{2},s} / C_{\\mathrm{peak},s}$ 的来源。\n- 在分数持平的情况下，即 $|S_{\\mathrm{N}} - S_{\\mathrm{V}}| \\le \\varepsilon$（其中容差 $\\varepsilon=10^{-9}$），按惯例选择NMDAR来源。\n\n将实现一个程序来为四个指定的测试用例中的每一个执行这一完整过程，并报告每个案例的最终确定性结果（1代表NMDAR，0代表VGCC）。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Case A\n        {'seed': 12345, 'sigma_jit': 2.0, 'CV_N': 0.2, 'CV_V': 0.2, \n         'A_N': 0.4, 'tau_r_N': 10.0, 'tau_d_N': 150.0,\n         'A_V': 1.0, 'tau_r_V': 1.0, 'tau_d_V': 25.0,\n         'dt': 0.1, 'T_max': 1000.0},\n        # Case B\n        {'seed': 24680, 'sigma_jit': 2.0, 'CV_N': 0.2, 'CV_V': 0.2,\n         'A_N': 0.8, 'tau_r_N': 10.0, 'tau_d_N': 150.0,\n         'A_V': 0.9, 'tau_r_V': 1.0, 'tau_d_V': 25.0,\n         'dt': 0.1, 'T_max': 1000.0},\n        # Case C\n        {'seed': 13579, 'sigma_jit': 3.0, 'CV_N': 0.25, 'CV_V': 0.25,\n         'A_N': 0.6, 'tau_r_N': 8.0, 'tau_d_N': 120.0,\n         'A_V': 0.25, 'tau_r_V': 1.0, 'tau_d_V': 200.0,\n         'dt': 0.1, 'T_max': 1200.0},\n        # Case D\n        {'seed': 777, 'sigma_jit': 0.0, 'CV_N': 0.0, 'CV_V': 0.0,\n         'A_N': 0.5, 'tau_r_N': 5.0, 'tau_d_N': 150.0,\n         'A_V': 0.5, 'tau_r_V': 5.0, 'tau_d_V': 150.0,\n         'dt': 0.1, 'T_max': 1000.0}\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = _solve_single_case(case_params)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef _solve_single_case(params):\n    \"\"\"\n    Solves for a single test case configuration.\n    \"\"\"\n    # Initialize RNG and simulation parameters\n    rng = np.random.default_rng(params['seed'])\n    time_vec = np.arange(0, params['T_max'] + params['dt'], params['dt'])\n    num_spikes = 5\n    \n    # Generate spike times with jitter, then sort\n    nominal_times = np.arange(num_spikes) * 50.0\n    jitter = rng.normal(loc=0.0, scale=params['sigma_jit'], size=num_spikes)\n    spike_times = np.sort(nominal_times + jitter)\n    \n    source_metrics = {}\n    \n    source_configs = {\n        'N': {'A': params['A_N'], 'CV': params['CV_N'], 'tau_r': params['tau_r_N'], 'tau_d': params['tau_d_N']},\n        'V': {'A': params['A_V'], 'CV': params['CV_V'], 'tau_r': params['tau_r_V'], 'tau_d': params['tau_d_V']}\n    }\n\n    for s_name, s_config in source_configs.items():\n        A = s_config['A']\n        CV = s_config['CV']\n        tau_r = s_config['tau_r']\n        tau_d = s_config['tau_d']\n\n        # Generate lognormal amplitude weights\n        if CV > 0:\n            sigma_sq = np.log(1 + CV**2)\n            mu = -sigma_sq / 2.0\n            weights = rng.lognormal(mean=mu, sigma=np.sqrt(sigma_sq), size=num_spikes)\n        else:\n            weights = np.ones(num_spikes)\n\n        # Define and normalize the bi-exponential kernel\n        # An unnormalized kernel h(t) = exp(-t/tau_d) - exp(-t/tau_r) is used.\n        # Its peak time and max value are calculated for normalization.\n        t_peak_kernel = (tau_d * tau_r) / (tau_d - tau_r) * np.log(tau_d / tau_r)\n        H_max = np.exp(-t_peak_kernel/tau_d) - np.exp(-t_peak_kernel/tau_r)\n        \n        # H_max should be > 0 given tau_d > tau_r > 0\n        norm_factor = 1.0 / H_max if H_max > 0 else 0.0\n\n        def h_tilde_func(t):\n            # The normalized kernel function for a vector of time points t.\n            # It is zero for t < 0.\n            res = np.zeros_like(t, dtype=float)\n            positive_t_mask = t >= 0\n            t_pos = t[positive_t_mask]\n            res[positive_t_mask] = (np.exp(-t_pos / tau_d) - np.exp(-t_pos / tau_r)) * norm_factor\n            return res\n        \n        # Pre-calculate the normalized kernel on the time grid for efficiency\n        norm_kernel_on_grid = h_tilde_func(time_vec)\n\n        # Superposition: Sum the contributions of all spikes.\n        # We implement this via a computationally efficient shift-and-add of the \n        # pre-calculated kernel, a standard discrete approximation of convolution.\n        total_ca_trace = np.zeros_like(time_vec)\n        for i in range(num_spikes):\n            t_spike = spike_times[i]\n            # Approximate spike time to the nearest grid point\n            start_idx = int(np.round(t_spike / params['dt']))\n            \n            if start_idx < 0: start_idx = 0\n            if start_idx >= len(time_vec): continue\n            \n            len_to_add = len(time_vec) - start_idx\n            total_ca_trace[start_idx:] += A * weights[i] * norm_kernel_on_grid[:len_to_add]\n\n        # Calculate metrics: peak and half-decay time\n        C_peak = np.max(total_ca_trace)\n        peak_idx = np.argmax(total_ca_trace)\n        half_peak_val = 0.5 * C_peak\n\n        post_peak_trace = total_ca_trace[peak_idx:]\n        indices_below_half = np.where(post_peak_trace <= half_peak_val)[0]\n        \n        if len(indices_below_half) > 0:\n            first_idx_below = indices_below_half[0]\n            t_half_decay = first_idx_below * params['dt']\n        else:\n            t_peak_obs = peak_idx * params['dt']\n            t_half_decay = params['T_max'] - t_peak_obs\n        \n        source_metrics[s_name] = {'peak': C_peak, 'half_decay': t_half_decay}\n\n    # Apply the decision rule\n    C_peak_N = source_metrics['N']['peak']\n    t_half_N = source_metrics['N']['half_decay']\n    C_peak_V = source_metrics['V']['peak']\n    t_half_V = source_metrics['V']['half_decay']\n    \n    is_N_ltd_candidate = (C_peak_N < C_peak_V) and (t_half_N > t_half_V)\n    is_V_ltd_candidate = (C_peak_V < C_peak_N) and (t_half_V > t_half_N)\n\n    if is_N_ltd_candidate:\n        return 1\n    elif is_V_ltd_candidate:\n        return 0\n    else:\n        # Use LTD score as fallback\n        S_N = t_half_N / C_peak_N if C_peak_N > 1e-12 else 0.0\n        S_V = t_half_V / C_peak_V if C_peak_V > 1e-12 else 0.0\n        \n        if np.abs(S_N - S_V) <= 1e-9:\n            return 1  # Tie-break to NMDAR\n        elif S_N > S_V:\n            return 1\n        else:\n            return 0\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2722045"}, {"introduction": "在模拟了诱导 LTD 的一般性 $\\mathrm{Ca^{2+}}$ 信号后，我们现在来检验这一原理如何应用于具体的生物通路中。这个思想实验 [@problem_id:2722030] 挑战你预测快速 $\\mathrm{Ca^{2+}}$ 螯合剂 BAPTA 对 NMDAR 依赖性与 mGluR 依赖性 LTD 的不同影响。解决这个问题需要你深刻理解这两种通路对 $\\mathrm{Ca^{2+}}$ 信号在空间和时间上的不同需求，从而区分一个弥散的、激活磷酸酶的信号与一个主要由 G 蛋白介导的级联反应。这项练习能够锻炼你的批判性思维，并提升你通过分析特定分子干预来剖析不同信号通路内在逻辑的能力。", "problem": "对海马CA1区锥体神经元进行全细胞膜片钳记录。内液含有$10$ mM的1,2-双(邻氨基苯氧基)乙烷-N,N,N',N'-四乙酸（BAPTA），这是一种快速、高亲和力的$\\mathrm{Ca^{2+}}$螯合剂。在同一细胞中，通过独立的实验应用了两种标准的长时程抑制（LTD）诱导方案：(i) 通常能产生N-甲基-D-天冬氨酸受体（NMDAR）依赖性LTD（NMDAR-LTD）的低频突触刺激，以及 (ii) 短暂浴施I组激动剂以激活1/5亚型的代谢型谷氨酸受体（mGluR1/5），这通常能产生mGluR依赖性LTD（mGluR-LTD）。要求您预测$10$ mM BAPTA对每种LTD形式的定性影响，并根据门控诱导的初始酶在空间和时间上的$\\mathrm{Ca^{2+}}$需求，从基本原理出发证明您的答案。\n\n使用以下内容作为基本依据：(a) 反应-扩散和结合：胞质$\\mathrm{Ca^{2+}}$遵循 $d[\\mathrm{Ca^{2+}}]/dt = J_{\\mathrm{in}} - k_{\\mathrm{on}}[\\mathrm{B}]_{\\mathrm{free}}[\\mathrm{Ca^{2+}}] + k_{\\mathrm{off}}[\\mathrm{CaB}] - J_{\\mathrm{removal}}$，其中$[\\mathrm{B}]$是缓冲剂（此处为BAPTA），$k_{\\mathrm{on}}$是结合速率常数，$k_{\\mathrm{off}}$是解离速率常数；快速、高$k_{\\mathrm{on}}$的缓冲剂会降低游离$\\mathrm{Ca^{2+}}$的幅度和扩散范围。(b) CA1区的NMDAR-LTD诱导需要突触后激活钙调蛋白（CaM）和蛋白磷酸酶2B（PP2B，钙调神经磷酸酶），从而导致蛋白磷酸酶1（PP1）的招募。(c) I组mGluR是Gq偶联的，能激活磷脂酶C-β（PLC$\\beta$），增加三磷酸肌醇（$\\mathrm{IP_3}$）和二酰基甘油（DAG），并且可以在不需要突触后$\\mathrm{Ca^{2+}}$大幅升高的情况下，驱动一种依赖于蛋白质合成的突触后LTD。\n\n哪个选项最能预测结果，并提供了基于空间微域需求的、与机制一致的合理解释？\n\nA. $10$ mM BAPTA消除了NMDAR-LTD，但保留了mGluR-LTD；快速缓冲作用瓦解了激活NMDAR-LTD所需的CaM/PP2B所必需的、弥散的、全棘范围的$\\mathrm{Ca^{2+}}$信号，而mGluR-LTD的启动主要通过G蛋白-PLC信号通路和局部翻译进行，对胞质$\\mathrm{Ca^{2+}}$升高的依赖性极小。\n\nB. $10$ mM BAPTA阻断了mGluR-LTD，但未阻断NMDAR-LTD；NMDAR-LTD依赖于与NMDAR孔道紧密偶联的、能抵抗缓冲作用的纳米域$\\mathrm{Ca^{2+}}$信号，而mGluR-LTD需要弥散的$\\mathrm{Ca^{2+}}$升高，而这种升高被BAPTA抑制。\n\nC. $10$ mM BAPTA通过降低$\\mathrm{Ca^{2+}}$水平以偏向磷酸酶而非激酶的激活，从而增强了NMDAR-LTD，并且对mGluR-LTD没有影响；降低的$\\mathrm{Ca^{2+}}$水平选择性地使信号通路偏向抑制。\n\nD. NMDAR-LTD和mGluR-LTD均被$10$ mM BAPTA消除；CA1区所有的LTD诱导机制都需要胞质$\\mathrm{Ca^{2+}}$的大幅增加，而这种增加被快速缓冲作用所阻止。\n\nE. NMDAR-LTD不受影响，而mGluR-LTD被$10$ mM BAPTA增强；螯合作用解除了$\\mathrm{Ca^{2+}}$对$\\mathrm{IP_3}$受体的自抑制，从而促进了mGluR-LTD，同时保持了NMDAR驱动的LTD完整。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- **实验：**对海马CA1区锥体神经元进行全细胞膜片钳记录。\n- **内液：**含有$10$ mM的1,2-双(邻氨基苯氧基)乙烷-N,N,N',N'-四乙酸（BAPTA），一种快速、高亲和力的$\\mathrm{Ca^{2+}}$螯合剂。\n- **方案(i)：**低频突触刺激以诱导N-甲基-D-天冬氨酸受体（NMDAR）依赖性长时程抑制（NMDAR-LTD）。\n- **方案(ii)：**短暂浴施I组激动剂以激活1/5亚型的代谢型谷氨酸受体（mGluR1/5），诱导mGluR依赖性LTD（mGluR-LTD）。\n- **问题：**根据初始诱导酶在空间和时间上的$\\mathrm{Ca^{2+}}$需求，预测$10$ mM BAPTA对每种LTD形式的影响。\n- **基本原理(a)：**胞质$\\mathrm{Ca^{2+}}$动力学由反应-扩散方程描述：$d[\\mathrm{Ca^{2+}}]/dt = J_{\\mathrm{in}} - k_{\\mathrm{on}}[\\mathrm{B}]_{\\mathrm{free}}[\\mathrm{Ca^{2+}}] + k_{\\mathrm{off}}[\\mathrm{CaB}] - J_{\\mathrm{removal}}$。像BAPTA这样快速、高$k_{\\mathrm{on}}$的缓冲剂会降低游离$\\mathrm{Ca^{2+}}$的幅度和空间扩散范围。\n- **基本原理(b)：**CA1区的NMDAR-LTD诱导需要突触后激活钙调蛋白（CaM）和蛋白磷酸酶2B（PP2B，钙调神经磷酸酶），后者随后招募蛋白磷酸酶1（PP1）。\n- **基本原理(c)：**I组mGluR是Gq偶联的，能激活磷脂酶C-β（PLC$\\beta$），并增加三磷酸肌醇（$\\mathrm{IP_3}$）和二酰基甘油（DAG）。这可以驱动一种依赖于蛋白质合成的LTD，而不需要突触后$\\mathrm{Ca^{2+}}$的大幅升高。\n\n**步骤2：使用提取的已知条件进行验证**\n评估问题的有效性。\n- **科学依据：**该问题牢固地建立在细胞和分子神经科学的既定原理之上。所描述的实验设置、方案、分子通路（NMDAR-LTD和mGluR-LTD）以及BAPTA的作用都是对该主题的标准和事实准确的表述。\n- **合理设定：**该问题提供了一个清晰的实验情景和一套基本原理。它要求根据这些原理做出具体预测，从而得出一个唯一的、合理的解决方案。\n- **客观性：**语言技术性强、精确，没有主观或含糊的术语。\n- **结论：**问题陈述在科学上是合理的、设定是恰当的、客观的、自洽的且有意义的。它没有违反任何无效标准。\n\n**步骤3：判定和行动**\n该问题是 **有效的**。可以推导出严谨的解决方案。\n\n**解决方案的推导**\n\n目标是预测高浓度（$10$ mM）的快速$\\mathrm{Ca^{2+}}$螯合剂BAPTA对两种不同形式的LTD（NMDAR-LTD和mGluR-LTD）的影响。分析必须基于所提供的基本原理，特别是对$\\mathrm{Ca^{2+}}$信号传导的不同要求。\n\n**1. NMDAR-LTD的分析**\n\nNMDAR-LTD由低频刺激诱导，这会导致适度但持久的$\\mathrm{Ca^{2+}}$通过NMDAR通道流入突触后棘。根据原理(b)，NMDAR-LTD的诱导受$\\mathrm{Ca^{2+}}$依赖性酶钙调蛋白（CaM）和蛋白磷酸酶2B（PP2B，或称钙调神经磷酸酶）的激活所门控。这些酶，特别是PP2B，需要胞质$\\mathrm{Ca^{2+}}$持续升高到数百纳摩尔至低微摩尔的水平。这种$\\mathrm{Ca^{2+}}$信号必须在空间上分布于大部分棘内细胞质中，才能有效启动磷酸酶级联反应。它不是一种高度局域化的“纳米域”信号，而是一种更弥散的“微域”信号。\n\n已知内液含有$10$ mM BAPTA，这是一个非常高的浓度。原理(a)阐明了这种缓冲剂如何影响$\\mathrm{Ca^{2+}}$动力学。作为一种快速（$k_{\\mathrm{on}}$大）、高亲和力（$K_d = k_{\\mathrm{off}}/k_{\\mathrm{on}}$小）且高浓度的螯合剂，BAPTA会迅速结合任何进入棘内的游离$\\mathrm{Ca^{2+}}$离子。高浓度的缓冲剂确保了对$\\mathrm{Ca^{2+}}$的巨大“吸收池”，有效防止游离胞质$\\mathrm{Ca^{2+}}$浓度显著高于静息水平，并使其空间扩散范围瓦解。因此，激活CaM和PP2B所需的弥散的、全棘范围的$\\mathrm{Ca^{2+}}$信号将无法建立。没有这个磷酸酶级联反应的激活，导致LTD的下游事件就不会发生。\n\n因此，预测$10$ mM BAPTA将消除NMDAR-LTD。\n\n**2. mGluR-LTD的分析**\n\nmGluR-LTD由Gq偶联的I组mGluR的激活诱导。根据原理(c)，这种激活通过PLC$\\beta$启动一个信号级联，导致第二信使$\\mathrm{IP_3}$和DAG的产生。该原理明确指出，这条通路驱动一种依赖于蛋白质合成的LTD，并且*不*需要*大幅*的突触后$\\mathrm{Ca^{2+}}$升高。\n\n主要的信号机制是化学性的，而非离子性的。关键的效应器位于PLC$\\beta$的下游。例如，DAG激活蛋白激酶C（PKC），整个通路会触发快速的、局部的蛋白质合成，这是这种LTD形式的一个标志。虽然$\\mathrm{IP_3}$可以作用于内质网上的$\\mathrm{IP_3}$受体以释放$\\mathrm{Ca^{2+}}$，但原理(c)强调，胞质$\\mathrm{Ca^{2+}}$的大幅增加不是mGluR-LTD诱导的先决条件。核心机制可以通过G蛋白/PLC$\\beta$/DAG/PKC/蛋白质合成轴线进行。\n\n在$10$ mM BAPTA的存在下，任何从内部储存释放的$\\mathrm{Ca^{2+}}$都会被迅速螯合。然而，由于诱导机制并不严重依赖于这种$\\mathrm{Ca^{2+}}$的升高，BAPTA对其的缓冲作用应该不会阻止LTD的发生。主要的G蛋白信号通路仍然完整。\n\n因此，预测$10$ mM BAPTA将保留（即不阻断）mGluR-LTD。\n\n**综合分析：**\n分析表明，NMDAR-LTD将被消除，因为它严格依赖于弥散的胞质$\\mathrm{Ca^{2+}}$信号，而该信号被BAPTA抑制。相比之下，mGluR-LTD将被保留，因为其主要诱导机制是一个不需要胞质$\\mathrm{Ca^{2+}}$大幅升高的G蛋白偶联通路。\n\n**选项评估**\n\n**A. $10$ mM BAPTA消除了NMDAR-LTD，但保留了mGluR-LTD；快速缓冲作用瓦解了激活NMDAR-LTD所需的CaM/PP2B所必需的、弥散的、全棘范围的$\\mathrm{Ca^{2+}}$信号，而mGluR-LTD的启动主要通过G蛋白-PLC信号通路和局部翻译进行，对胞质$\\mathrm{Ca^{2+}}$升高的依赖性极小。**\n该陈述与推导出的结论完全一致。它正确地预测了两种LTD形式的不同结果，并基于所提供的原理给出了正确的生物物理和生物化学生理。NMDAR-LTD所需的弥散$\\mathrm{Ca^{2+}}$信号与mGluR-LTD以G蛋白为中心的机制之间的区别被准确地捕捉到。**正确**。\n\n**B. $10$ mM BAPTA阻断了mGluR-LTD，但未阻断NMDAR-LTD；NMDAR-LTD依赖于与NMDAR孔道紧密偶联的、能抵抗缓冲作用的纳米域$\\mathrm{Ca^{2+}}$信号，而mGluR-LTD需要弥散的$\\mathrm{Ca^{2+}}$升高，而这种升高被BAPTA抑制。**\n该陈述不正确。它颠倒了两种通路的$\\mathrm{Ca^{2+}}$依赖性。NMDAR-LTD所需的持久而适度的$\\mathrm{Ca^{2+}}$信号易受高浓度快速缓冲剂的影响。声称这种信号是抵抗缓冲作用的“纳米域”信号通常与非常靠近通道孔的传感器相关，例如用于LTP的传感器，而不是用于LTD的磷酸酶激活。它还错误地假设mGluR-LTD需要强烈的$\\mathrm{Ca^{2+}}$信号，这与原理(c)相悖。**不正确**。\n\n**C. $10$ mM BAPTA通过降低$\\mathrm{Ca^{2+}}$水平以偏向磷酸酶而非激酶的激活，从而增强了NMDAR-LTD，并且对mGluR-LTD没有影响；降低的$\\mathrm{Ca^{2+}}$水平选择性地使信号通路偏向抑制。**\n该陈述不正确。虽然较低的$\\mathrm{Ca^{2+}}$水平确实有利于磷酸酶而非激酶（Bienenstock-Cooper-Munro或“BCM”理论），但$10$ mM BAPTA的浓度不会简单地将信号“降低”到LTD的最佳范围。它会将$\\mathrm{Ca^{2+}}$浓度钳制在静息水平附近，从而完全消除磷酸酶激活所需的信号。在这种情况下，缓冲不是增强，而是消除。**不正确**。\n\n**D. NMDAR-LTD和mGluR-LTD均被$10$ mM BAPTA消除；CA1区所有的LTD诱导机制都需要胞质$\\mathrm{Ca^{2+}}$的大幅增加，而这种增加被快速缓冲作用所阻止。**\n该陈述不正确。声称*所有*LTD机制都需要$\\mathrm{Ca^{2+}}$的大幅增加是一个错误的概括。它直接与原理(c)矛盾，该原理指出mGluR-LTD可以在没有突触后$\\mathrm{Ca^{2+}}$大幅升高的情况下进行。因此，虽然它正确地预测了NMDAR-LTD的阻断，但对mGluR-LTD的判断是错误的。**不正确**。\n\n**E. NMDAR-LTD不受影响，而mGluR-LTD被$10$ mM BAPTA增强；螯合作用解除了$\\mathrm{Ca^{2+}}$对$\\mathrm{IP_3}$受体的自抑制，从而促进了mGluR-LTD，同时保持了NMDAR驱动的LTD完整。**\n该陈述不正确。它错误地声称NMDAR-LTD不受影响；如前所述，它对BAPTA高度敏感。提出的mGluR-LTD增强机制（解除$\\mathrm{IP_3}$R的自抑制）是一个真实但次要的效应；它不代表主要结果，更重要的是，关于NMDAR-LTD的前提是根本错误的。**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2722030"}]}