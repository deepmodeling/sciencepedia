{"hands_on_practices": [{"introduction": "要理解短期突触易化，首先需要掌握突触前末梢的钙离子动力学。本练习通过第一性原理带您审视“残余钙假说”，对钙离子浓度随时间衰减的过程进行建模。通过推导并应用钙离子清除方程，您将对生物物理记忆获得定量的理解，正是这种记忆使得第二个动作电位能比第一个释放更多的神经递质。这是对活动依赖性突触增强进行建模的基础性计算。[@problem_id:2751422]", "problem": "在短期突触可塑性和双脉冲易化的残余钙假说背景下，考虑一个单室突触前末梢，其中细胞内钙（$\\text{Ca}^{2+}$）通过一级清除机制恢复到其静息水平。假设在时间 $t=0$ 时，一个动作电位产生了一个相对于静息基线的、幅度为 $[Ca]_0$ 的有效瞬时游离钙增量，并且随后的动力学由具有有效时间常数 $\\tau_{\\text{eff}}$ 的线性清除机制决定，该常数包含了缓冲和外排作用。设 $t>0$ 时，高于基线的残余钙为 $[Ca]_{\\text{res}}(t)$。\n\n从 $t=0$ 时具有一级清除和脉冲样流入的单室平衡出发，推导 $t>0$ 时 $[Ca]_{\\text{res}}(t)$ 的闭合形式时间进程。然后，使用您推导的表达式，计算当 $[Ca]_0 = 0.5\\ \\mu\\text{M}$ 且 $\\tau_{\\text{eff}} = 50\\ \\text{ms}$ 时，在脉冲间间隔 $\\Delta t = 20\\ \\text{ms}$ 处的残余钙浓度。\n\n将最终数值答案四舍五入到四位有效数字。以 $\\mu\\text{M}$ 为单位表示最终浓度。仅提供最终数值（不带单位）作为答案。", "solution": "所陈述的问题定义明确，具有科学依据，是生物物理动力学建模中的一个标准练习。我们直接进行求解。\n\n该问题描述了动作电位后，突触前末梢中残余钙浓度 $[Ca]_{\\text{res}}(t)$ 的时间演化过程。该动力学过程由一个具有一级清除机制的单室模型控制。这一物理情景可用一个一阶线性齐次常微分方程来描述。\n\n钙浓度的变化率 $\\frac{d}{dt}[Ca]_{\\text{res}}(t)$ 与其自身浓度成正比，比例常数为负。该常数是有效时间常数 $\\tau_{\\text{eff}}$ 的倒数。因此，控制方程为：\n$$\n\\frac{d[Ca]_{\\text{res}}(t)}{dt} = -\\frac{1}{\\tau_{\\text{eff}}} [Ca]_{\\text{res}}(t)\n$$\n该方程对时间 $t > 0$ 成立。\n\n问题陈述，在时间 $t=0$ 时，一个动作电位产生了一个“幅度为 $[Ca]_0$ 的有效瞬时游离钙增量”。这构成了该微分方程的初始条件。假设静息钙水平归一化为零，则脉冲后瞬间的浓度为：\n$$\n[Ca]_{\\text{res}}(0) = [Ca]_0\n$$\n现在我们有了一个完整的初值问题。方程 $\\frac{dy}{dt} = -ky$ 在初始条件 $y(0) = y_0$ 下的解是众所周知的 $y(t) = y_0 \\exp(-kt)$。通过直接类比，代入我们的特定变量和常数，我们得到残余钙浓度的闭合形式时间进程：\n$$\n[Ca]_{\\text{res}}(t) = [Ca]_0 \\exp\\left(-\\frac{t}{\\tau_{\\text{eff}}}\\right)\n$$\n该表达式给出了初始流入后任意时间 $t > 0$ 的残余钙浓度。\n\n问题的第二部分要求计算在特定脉冲间间隔 $\\Delta t$ 处的残余钙浓度。给定的参数是：\n- 初始钙增量：$[Ca]_0 = 0.5\\ \\mu\\text{M}$\n- 有效时间常数：$\\tau_{\\text{eff}} = 50\\ \\text{ms}$\n- 脉冲间间隔：$\\Delta t = 20\\ \\text{ms}$\n\n我们将这些值代入推导出的 $[Ca]_{\\text{res}}(t)$ 表达式，并令 $t = \\Delta t$：\n$$\n[Ca]_{\\text{res}}(\\Delta t) = [Ca]_0 \\exp\\left(-\\frac{\\Delta t}{\\tau_{\\text{eff}}}\\right)\n$$\n$$\n[Ca]_{\\text{res}}(20\\ \\text{ms}) = (0.5\\ \\mu\\text{M}) \\times \\exp\\left(-\\frac{20\\ \\text{ms}}{50\\ \\text{ms}}\\right)\n$$\n指数中的单位相互抵消，这是量纲一致性的必要条件。计算简化为：\n$$\n[Ca]_{\\text{res}}(20\\ \\text{ms}) = 0.5 \\times \\exp\\left(-\\frac{2}{5}\\right)\\ \\mu\\text{M} = 0.5 \\times \\exp(-0.4)\\ \\mu\\text{M}\n$$\n现在，我们计算数值：\n$$\n\\exp(-0.4) \\approx 0.670320046\n$$\n因此，\n$$\n[Ca]_{\\text{res}}(20\\ \\text{ms}) \\approx 0.5 \\times 0.670320046\\ \\mu\\text{M} \\approx 0.335160023\\ \\mu\\text{M}\n$$\n问题要求将最终答案四舍五入到四位有效数字。前四位有效数字是 $3$、$3$、$5$ 和 $1$。第五位有效数字是 $6$，大于或等于 $5$，因此我们将第四位数字向上取整。\n$$\n[Ca]_{\\text{res}}(20\\ \\text{ms}) \\approx 0.3352\\ \\mu\\text{M}\n$$\n按要求以 $\\mu\\text{M}$ 表示的最终数值答案是 $0.3352$。", "answer": "$$\\boxed{0.3352}$$", "id": "2751422"}, {"introduction": "与易化增强突触强度相反，抑制则会削弱它，尤其是在高频活动期间。本实践深入探讨了短期抑制的经典模型：可释放囊泡池的耗竭。您将推导稳态下的突触强度与刺激频率之间的函数关系，这是理解突触如何作为信息动态滤波器的关键技能。这个练习阐明了在持续信号传递过程中，囊泡消耗与恢复之间的平衡如何决定突触的效能。[@problem_id:2751407]", "problem": "在兴奋性突触中，短期突触抑制的一个核心机制是突触囊泡的易释放囊泡池（RRP）的耗竭。考虑一个由频率为 $f$（周期 $\\Delta = 1/f$）的周期性突触前锋电位序列驱动的单个突触。令 $R(t)$ 表示在时间 $t$ 可用的待释放资源的分数，该值已通过最大池大小 $R_{\\max}$ 进行归一化。该突触遵循以下经过充分检验的事实和核心定义：\n- 在每个突触前动作电位处，当前可用资源的期望分数 $p$ 被释放，产生一个与释放分数成正比的兴奋性突触后电流（EPSC）振幅。\n- 在时间 $t_{n}$ 的锋电位之后，可用分数立即从锋电位前的值 $R(t_{n}^{-})$ 跳变到锋电位后的值 $R(t_{n}^{+}) = R(t_{n}^{-})(1 - p)$。\n- 在锋电位之间，资源以时间常数 $\\tau_{\\mathrm{rec}}$ 向 $R_{\\max}$ 指数恢复，遵循方程 $\\,\\frac{dR}{dt} = \\frac{R_{\\max} - R}{\\tau_{\\mathrm{rec}}}\\,$，其中 $t \\in (t_{n}, t_{n+1})$。\n\n假设不存在易化、增强或强直后增强；也就是说，释放概率 $p$ 是恒定的，只有耗竭和恢复决定了响应。将周期性刺激下的稳态归一化EPSC振幅 $A_{\\infty}(f)$ 定义为稳态下每次锋电位期望释放的资源分数，该值已通过 $R_{\\max}$ 归一化。\n\n仅以上述陈述为出发点，推导出 $A_{\\infty}(f)$ 作为 $p$、$R_{\\max}$、$\\tau_{\\mathrm{rec}}$ 和 $f$ 的函数，然后针对 $p = 0.3$，$R_{\\max} = 1$，$\\tau_{\\mathrm{rec}} = 1\\ \\mathrm{s}$ 在刺激频率 $f \\in \\{1, 5, 10, 50\\}\\ \\mathrm{Hz}$ 下对其进行求值。将最终的归一化振幅表示为无量纲数，并将您的值四舍五入到四位有效数字。以行向量的形式报告您的答案，顺序为 $f = 1, 5, 10, 50\\ \\mathrm{Hz}$。", "solution": "在尝试求解之前，将对问题陈述进行验证。\n\n首先，按要求逐字提取已知条件。\n- 频率为 $f$、周期为 $\\Delta = 1/f$ 的周期性突触前锋电位序列。\n- $R(t)$ 表示在时间 $t$ 可用的待释放资源的分数，已通过最大池大小 $R_{\\max}$ 归一化。\n- 在每个突触前动作电位处，当前可用资源的期望分数 $p$ 被释放。\n- EPSC振幅与释放分数成正比。\n- 锋电位后资源水平由 $R(t_{n}^{+}) = R(t_{n}^{-})(1 - p)$ 给出。\n- 锋电位之间的资源恢复由微分方程 $\\frac{dR}{dt} = \\frac{R_{\\max} - R}{\\tau_{\\mathrm{rec}}}$ 控制，其中 $t \\in (t_{n}, t_{n+1})$。\n- 假设：$p$ 是恒定的（无易化、增强或强直后增强PTP）。\n- 稳态归一化EPSC振幅 $A_{\\infty}(f)$ 定义为稳态下每次锋电位期望释放的资源分数，已通过 $R_{\\max}$ 归一化。\n- 用于求值的数值参数：$p = 0.3$， $R_{\\max} = 1$， $\\tau_{\\mathrm{rec}} = 1\\ \\mathrm{s}$，以及频率 $f \\in \\{1, 5, 10, 50\\}\\ \\mathrm{Hz}$。\n\n接下来，评估问题的有效性。该问题描述了一个短期突触抑制的经典模型（Tsodyks-Markram 模型的简化形式，仅考虑抑制），这是细胞和分子神经科学中的一个基本概念。该模型在科学上是合理的、适定的和客观的。关于变量 $R(t)$，问题陈述中存在轻微的不精确之处。它被定义为一个归一化的分数，但微分方程 $\\frac{dR}{dt} = \\frac{R_{\\max} - R}{\\tau_{\\mathrm{rec}}}$ 表明 $R$ 与 $R_{\\max}$ 具有相同的单位。然而，通过将 $R(t)$ 解释为资源的绝对量，将 $R_{\\max}$ 解释为最大量，可以解决这个歧义。后续使用 $R_{\\max}=1$ 的要求使得这种解释与一个归一化模型完全一致，在归一化模型中 $\\frac{dR}{dt} = \\frac{1 - R}{\\tau_{\\mathrm{rec}}}$。采用这种标准解释，该问题是内部一致且可解的。因此，该问题被认为是有效的。\n\n求解过程如下。我们寻求稳态归一化EPSC振幅 $A_{\\infty}(f)$。根据定义，这是稳态下释放的资源量 $p R_{\\infty}^{-}$ 除以最大池大小 $R_{\\max}$。因此，$A_{\\infty}(f) = \\frac{p R_{\\infty}^{-}}{R_{\\max}}$，其中 $R_{\\infty}^{-}$ 是稳态下锋电位发生前的资源水平。\n\n步骤 1：求解锋电位之间的恢复动力学。\n在时间 $t_n$ 的第 $n$ 个锋电位和时间 $t_{n+1} = t_n + \\Delta$ 的第 $n+1$ 个锋电位之间，资源的恢复由以下线性一阶常微分方程描述：\n$$\n\\frac{d R}{d t} = \\frac{R_{\\max} - R}{\\tau_{\\mathrm{rec}}}\n$$\n该方程可通过分离变量法求解：\n$$\n\\int_{R(t_n^+)}^{R(t_{n+1}^-)} \\frac{dR}{R_{\\max} - R} = \\int_{t_n}^{t_{n+1}} \\frac{dt}{\\tau_{\\mathrm{rec}}}\n$$\n此区间内的初始条件是锋电位后的资源水平 $R(t_n^+)$。我们在锋电位间隔 $\\Delta = t_{n+1} - t_n$ 上进行积分。\n$$\n\\left[-\\ln(R_{\\max} - R)\\right]_{R(t_n^+)}^{R(t_{n+1}^-)} = \\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\n$$\n$$\n\\ln\\left(\\frac{R_{\\max} - R(t_n^+)}{R_{\\max} - R(t_{n+1}^-)}\\right) = \\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\n$$\n求解下一个锋电位前的资源水平 $R(t_{n+1}^-)$，我们得到：\n$$\nR_{\\max} - R(t_{n+1}^-) = (R_{\\max} - R(t_n^+))\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\n$$\n$$\nR(t_{n+1}^-) = R_{\\max} - (R_{\\max} - R(t_n^+))\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right) = R_{\\max}\\left(1 - \\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\\right) + R(t_n^+)\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\n$$\n\n步骤 2：建立锋电位前资源水平的递推关系。\n令 $R_n^{-} \\equiv R(t_n^-)$ 为第 $n$ 个锋电位前的资源水平。耗竭规则为 $R(t_n^+) = R_n^{-}(1 - p)$。将此代入步骤 1 中推导的方程：\n$$\nR_{n+1}^{-} = R_{\\max}\\left(1 - \\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\\right) + R_n^{-}(1 - p)\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\n$$\n这是一个关于锋电位前资源水平序列的线性递推关系。\n\n步骤 3：求稳态解。\n在稳态下，每次锋电位前的资源水平是恒定的，因此 $R_{n+1}^{-} = R_n^{-} = R_{\\infty}^{-}$。\n$$\nR_{\\infty}^{-} = R_{\\max}\\left(1 - \\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\\right) + R_{\\infty}^{-}(1 - p)\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\n$$\n我们求解 $R_{\\infty}^{-}$：\n$$\nR_{\\infty}^{-}\\left[1 - (1 - p)\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\\right] = R_{\\max}\\left(1 - \\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\\right)\n$$\n$$\nR_{\\infty}^{-} = \\frac{R_{\\max}\\left(1 - \\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\\right)}{1 - (1 - p)\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)}\n$$\n\n步骤 4：推导 $A_{\\infty}(f)$ 的表达式。\n使用定义 $A_{\\infty}(f) = \\frac{p R_{\\infty}^{-}}{R_{\\max}}$ 并代入 $R_{\\infty}^{-}$ 的表达式，我们得到：\n$$\nA_{\\infty}(f) = \\frac{p}{R_{\\max}} \\left[ \\frac{R_{\\max}\\left(1 - \\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\\right)}{1 - (1 - p)\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)} \\right]\n$$\n$R_{\\max}$ 项相互抵消，这是符合预期的，因为归一化振幅不应依赖于绝对的池大小。代入 $\\Delta = 1/f$：\n$$\nA_{\\infty}(f) = \\frac{p\\left(1 - \\exp\\left(-\\frac{1}{f \\tau_{\\mathrm{rec}}}\\right)\\right)}{1 - (1 - p)\\exp\\left(-\\frac{1}{f \\tau_{\\mathrm{rec}}}\\right)}\n$$\n这是稳态归一化振幅作为 $p$、$\\tau_{\\mathrm{rec}}$ 和 $f$ 的函数的通用解析表达式。\n\n步骤 5：进行数值计算。\n给定参数为 $p = 0.3$ 和 $\\tau_{\\mathrm{rec}} = 1\\ \\mathrm{s}$。表达式变为：\n$$\nA_{\\infty}(f) = \\frac{0.3\\left(1 - \\exp\\left(-\\frac{1}{f}\\right)\\right)}{1 - 0.7\\exp\\left(-\\frac{1}{f}\\right)}\n$$\n我们对每个指定的频率 $f$ 进行求值：\n- 对于 $f = 1\\ \\mathrm{Hz}$：\n  $A_{\\infty}(1) = \\frac{0.3(1 - \\exp(-1))}{1 - 0.7\\exp(-1)} \\approx \\frac{0.3(1 - 0.367879)}{1 - 0.7(0.367879)} = \\frac{0.189636}{0.742485} \\approx 0.255407$\n  四舍五入到四位有效数字，结果是 $0.2554$。\n\n- 对于 $f = 5\\ \\mathrm{Hz}$：\n  $A_{\\infty}(5) = \\frac{0.3(1 - \\exp(-0.2))}{1 - 0.7\\exp(-0.2)} \\approx \\frac{0.3(1 - 0.818731)}{1 - 0.7(0.818731)} = \\frac{0.0543807}{0.426888} \\approx 0.127387$\n  四舍五入到四位有效数字，结果是 $0.1274$。\n\n- 对于 $f = 10\\ \\mathrm{Hz}$：\n  $A_{\\infty}(10) = \\frac{0.3(1 - \\exp(-0.1))}{1 - 0.7\\exp(-0.1)} \\approx \\frac{0.3(1 - 0.904837)}{1 - 0.7(0.904837)} = \\frac{0.0285489}{0.366614} \\approx 0.077873$\n  四舍五入到四位有效数字，结果是 $0.07787$。\n\n- 对于 $f = 50\\ \\mathrm{Hz}$：\n  $A_{\\infty}(50) = \\frac{0.3(1 - \\exp(-0.02))}{1 - 0.7\\exp(-0.02)} \\approx \\frac{0.3(1 - 0.980199)}{1 - 0.7(0.980199)} = \\frac{0.0059403}{0.313861} \\approx 0.018926$\n  四舍五入到四位有效数字，结果是 $0.01893$。\n\n最终结果以行向量形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2554 & 0.1274 & 0.07787 & 0.01893\n\\end{pmatrix}\n}\n$$", "id": "2751407"}, {"introduction": "真实的突触反应是由易化和抑制之间动态相互作用共同塑造的。本综合性练习将向您介绍一个经典的唯象模型（Tsodyks-Markram模型），该模型成功地捕捉了这种相互作用。通过推导其更新规则并进行模拟，您将探索不同参数如何导致以易化为主、以抑制为主或两者混合的突触活动模式。这项实践为您提供了一个强大的框架，用以分析和预测突触传递的复杂时间动态。[@problem_id:2751339]", "problem": "给定一个短期突触可塑性的机制模型，该模型将易化和抑制捕获为相互作用的动力学过程。考虑一个由基于资源模型控制的单个突触，其中两个状态变量随时间演化：瞬时释放概率 $u(t)$ 和可用资源分数 $x(t)$。在间隔为 $\\Delta t$ 的突触前脉冲之间，这些变量遵循由内在弛豫驱动的一阶线性常微分方程：\n1. $u(t)$ 根据 $\\dfrac{du}{dt} = -\\dfrac{u}{\\tau_f}$ 向 $0$ 弛豫，其中 $\\tau_f$ 是易化时间常数。\n2. $x(t)$ 根据 $\\dfrac{dx}{dt} = \\dfrac{1 - x}{\\tau_d}$ 向 $1$ 恢复，其中 $\\tau_d$ 是抑制恢复时间常数。\n\n在每个突触前脉冲到达时间 $t_k$，变量通过突触释放和易化被瞬时更新：\n1. 释放概率跳变为 $u \\leftarrow u + U \\left(1 - u\\right)$，其中 $U$ 是基线利用参数。\n2. 可用资源根据更新后的释放概率按比例消耗，$x \\leftarrow x \\left(1 - u\\right)$。\n\n假设初始静息状态为 $u(0^{-}) = 0$ 和 $x(0^{-}) = 1$，以及频率为 $f$ 的周期性脉冲序列，因此 $\\Delta t = 1/f$。将第 $k$ 个脉冲处的归一化突触后响应定义为 $y_k = u_k x_k$，其中 $u_k$ 表示 $u$ 在第 $k$ 个脉冲处跳变后瞬间的值，$x_k$ 表示 $x$ 在第 $k$ 个脉冲处消耗前瞬间的值。所有响应 $y_k$ 都是无量纲的。\n\n任务：\n1. 从给定的微分方程和跳变规则出发，推导离散时间更新关系，从而能够仅使用参数 $\\Delta t$、$U$、$\\tau_f$ 和 $\\tau_d$ 以及前一个脉冲的状态来计算连续脉冲的 $y_k$。\n2. 实现这些更新，为下面测试套件中的每个参数集计算前五个响应 $\\left(y_1, y_2, y_3, y_4, y_5\\right)$。使用毫秒（ms）为单位的 $\\tau_f$ 和 $\\tau_d$，并在内部将其转换为秒。使用赫兹（Hz）为单位的 $f$，以便 $\\Delta t$ 以秒为单位。\n3. 根据以下规则，判断在前五个响应中是易化还是抑制占主导地位。设 $\\epsilon = 10^{-9}$。对于 $k = 2,3,4,5$，如果 $y_k - y_{k-1} > \\epsilon$，则记为一次增加；如果 $y_k - y_{k-1} < -\\epsilon$，则记为一次减少。令 $I$ 为增加次数，$D$ 为减少次数。定义主导整数 $S$ 如下：\n   - $S = 1$（易化主导），如果 $I \\ge 3$ 且 $y_5 - y_1 > \\epsilon$，\n   - $S = -1$（抑制主导），如果 $D \\ge 3$ 且 $y_5 - y_1 < -\\epsilon$，\n   - $S = 0$（混合或不明确），其他情况。\n\n数值输出要求：\n- 将五个响应表示为四舍五入到六位小数的浮点数。\n- 对于每个参数集，输出一个包含六个条目的列表：五个四舍五入的响应，后跟整数 $S$。\n- 你的程序应生成单行输出，其中包含所有测试用例的结果，格式为一个由逗号分隔的列表组成的列表，并用方括号括起来，例如：`[[y11,y12,y13,y14,y15,S1],[y21,y22,y23,y24,y25,S2],...]`。\n\n测试套件：\n为以下四个参数集提供结果。在所有情况下，都计算前五个响应。当提到脉冲序列持续时间时，这只是为了提供频率的上下文；你应该假设周期性脉冲序列会持续足够长的时间以获得五个脉冲。\n1. 中等频率下的基线相互作用：$f = 20\\ \\text{Hz}$，$U = 0.2$，$\\tau_f = 200\\ \\text{ms}$，$\\tau_d = 800\\ \\text{ms}$。\n2. 强初始利用率，伴随更快的易化衰减和中等程度的恢复：$f = 20\\ \\text{Hz}$，$U = 0.5$，$\\tau_f = 50\\ \\text{ms}$，$\\tau_d = 400\\ \\text{ms}$。\n3. 低初始利用率，伴随长时程易化和快速恢复：$f = 20\\ \\text{Hz}$，$U = 0.05$，$\\tau_f = 1000\\ \\text{ms}$，$\\tau_d = 200\\ \\text{ms}$。\n4. 低频边界情况：$f = 1\\ \\text{Hz}$，$U = 0.2$，$\\tau_f = 200\\ \\text{ms}$，$\\tau_d = 800\\ \\text{ms}$。\n\n最终输出格式：\n- 单行输出，包含一个类似JSON的列表，内含四个列表，每个列表对应一个测试用例，其中每个内部列表的格式为 [y1,y2,y3,y4,y5,S]，使用上述的四舍五入和整数规则。", "solution": "本问题已经过验证。\n\n**1. 已知条件提取**\n- 状态变量：瞬时释放概率 $u(t)$，可用资源分数 $x(t)$。\n- 脉冲之间（脉冲间隔 $\\Delta t$）的动力学：\n    - $\\dfrac{du}{dt} = -\\dfrac{u}{\\tau_f}$\n    - $\\dfrac{dx}{dt} = \\dfrac{1 - x}{\\tau_d}$\n- 脉冲时间 $t_k$ 的动力学：\n    - $u \\leftarrow u + U \\left(1 - u\\right)$\n    - $x \\leftarrow x \\left(1 - u\\right)$（使用更新后的 $u$）\n- 初始状态：$u(0^{-}) = 0$, $x(0^{-}) = 1$。\n- 刺激：频率为 $f$ 的周期性脉冲序列，因此 $\\Delta t = 1/f$。\n- 输出变量：归一化突触后响应 $y_k = u_k x_k$，其中 $u_k$ 是第 $k$ 个脉冲处 $u$ 跳变后瞬间的值，$x_k$ 是第 $k$ 个脉冲处 $x$ 消耗前瞬间的值。\n- 任务：推导离散时间更新关系，实现它们以计算前五个响应（$y_1$ 到 $y_5$），并使用主导整数 $S$ 对动力学进行分类。\n- 主导规则：$\\epsilon = 10^{-9}$。对于 $k \\in \\{2,3,4,5\\}$，$I$ 是增加（$y_k - y_{k-1} > \\epsilon$）的计数，$D$ 是减少（$y_k - y_{k-1} < -\\epsilon$）的计数。如果 $I \\ge 3$ 且 $y_5 - y_1 > \\epsilon$，则 $S=1$；如果 $D \\ge 3$ 且 $y_5 - y_1 < -\\epsilon$，则 $S=-1$；否则 $S=0$。\n- 测试用例：提供了四个涉及 $f$、$U$、$\\tau_f$、$\\tau_d$ 的参数集。\n\n**2. 验证结论**\n本问题是**有效的**。它描述了一个已被广泛认可、有科学依据的短期突触可塑性模型（Tsodyks-Markram模型）。该问题在数学上是适定的，提供了所有必要的微分方程、更新规则、初始条件和参数。目标陈述清晰，并且在计算上是可行的。不存在矛盾、歧义或事实错误。\n\n**3. 推导与求解方法**\n\n任务是计算由周期性突触前脉冲序列生成的突触后响应序列 $y_k$。这需要从给定的连续时间动力学和瞬时脉冲时间更新中推导出离散时间的递推关系。\n\n我们将第 $k$ 个脉冲前瞬间的突触状态定义为 $(u_{k}^{\\text{pre}}, x_{k}^{\\text{pre}})$。将第 $k$ 个脉冲更新和消耗后瞬间的状态定义为 $(u_k, x_{k}^{\\text{post}})$，其中 $u_k$ 是易化后的释放概率。\n\n**步骤1：脉冲间的演化**\n在第 $k-1$ 个脉冲和第 $k$ 个脉冲之间，系统演化持续时间 $\\Delta t = 1/f$。其控制方程为一阶线性常微分方程。\n$u(t)$ 的方程是 $\\dfrac{du}{dt} = -u/\\tau_f$。对于初始条件 $u(t_{k-1}) = u_{k-1}$，其解为 $u(t) = u_{k-1} e^{-(t - t_{k-1})/\\tau_f}$。因此，在第 $k$ 个脉冲前瞬间 $u$ 的值为：\n$$u_{k}^{\\text{pre}} = u_{k-1} e^{-\\Delta t / \\tau_f}$$\n\n$x(t)$ 的方程是 $\\dfrac{dx}{dt} = (1 - x)/\\tau_d$。我们定义一个变量 $z(t) = 1 - x(t)$，则 $\\dfrac{dz}{dt} = -\\dfrac{z}{\\tau_d}$。对于初始条件 $x(t_{k-1}) = x_{k-1}^{\\text{post}}$，我们有 $z(t_{k-1}) = 1 - x_{k-1}^{\\text{post}}$。$z(t)$ 的解为 $z(t) = z(t_{k-1}) e^{-(t - t_{k-1})/\\tau_d}$。代回 $x(t)$，我们得到 $1-x(t) = (1 - x_{k-1}^{\\text{post}}) e^{-(t - t_{k-1})/\\tau_d}$，即 $x(t) = 1 - (1 - x_{k-1}^{\\text{post}}) e^{-(t - t_{k-1})/\\tau_d}$。在第 $k$ 个脉冲前瞬间 $x$ 的值为：\n$$x_{k}^{\\text{pre}} = 1 - (1 - x_{k-1}^{\\text{post}}) e^{-\\Delta t / \\tau_d}$$\n\n**步骤2：脉冲时刻的更新**\n在第 $k$ 个脉冲到达时，变量被瞬时更新。\n首先，释放概率 $u$ 被易化。问题将 $u_k$ 定义为跳变后的值：\n$$u_k = u_{k}^{\\text{pre}} + U (1 - u_{k}^{\\text{pre}})$$\n问题将 $x_k$ 定义为资源在消耗*前*的值，这恰好是 $x_{k}^{\\text{pre}}$。因此：\n$$x_k = x_{k}^{\\text{pre}}$$\n然后，归一化突触后响应 $y_k$ 计算如下：\n$$y_k = u_k x_k = u_k x_{k}^{\\text{pre}}$$\n最后，可用资源 $x$ 使用新更新的释放概率 $u_k$ 被消耗。消耗后 $x$ 的状态是：\n$$x_{k}^{\\text{post}} = x_{k}^{\\text{pre}} (1 - u_k)$$\n\n**步骤3：递推关系与算法**\n我们现在可以组合这些步骤，形成一套完整的递推关系。系统的状态可以通过变量 $(u_k, x_{k}^{\\text{post}})$ 来跟踪。\n从第 $k-1$ 步到第 $k$ 步的更新过程如下：\n1. 在脉冲之间演化，以找到第 $k$ 个脉冲的脉冲前状态：\n   $$u_{k}^{\\text{pre}} = u_{k-1} e^{-\\Delta t / \\tau_f}$$\n   $$x_{k}^{\\text{pre}} = 1 - (1 - x_{k-1}^{\\text{post}}) e^{-\\Delta t / \\tau_d}$$\n2. 在第 $k$ 个脉冲处更新并计算响应：\n   $$u_k = u_{k}^{\\text{pre}} + U(1 - u_{k}^{\\text{pre}})$$\n   $$y_k = u_k x_{k}^{\\text{pre}}$$\n3. 计算下一个时间间隔的消耗后资源状态：\n   $$x_{k}^{\\text{post}} = x_{k}^{\\text{pre}} (1 - u_k)$$\n\n**初始条件：**\n系统从静息状态 $u(0^-)=0$ 和 $x(0^-)=1$ 开始。这对应于在 $t=-\\infty$ 处一个假设性脉冲之后的状态。因此，对于第一个脉冲（$k=1$），我们可以将“前一个”状态值设为 $u_0 = 0$ 和 $x_0^{\\text{post}} = 1$。\n模拟过程如下：\n用 $u_{\\text{prev}} = 0$ 和 $x_{\\text{post_prev}} = 1$ 初始化。\n对于 $k = 1, 2, 3, 4, 5$：\n- 计算 $u_{k}^{\\text{pre}} = u_{\\text{prev}} \\exp(-\\Delta t / \\tau_f)$。\n- 计算 $x_{k}^{\\text{pre}} = 1 - (1 - x_{\\text{post_prev}}) \\exp(-\\Delta t / \\tau_d)$。\n- 计算 $u_k = u_{k}^{\\text{pre}} + U(1 - u_{k}^{\\text{pre}})$。\n- 计算 $y_k = u_k x_{k}^{\\text{pre}}$。\n- 计算 $x_{k}^{\\text{post}} = x_{k}^{\\text{pre}} (1 - u_k)$。\n- 为下一次迭代更新：$u_{\\text{prev}} = u_k$ 和 $x_{\\text{post_prev}} = x_{k}^{\\text{post}}$。\n- 存储 $y_k$。\n\n时间常数 $\\tau_f$ 和 $\\tau_d$ 以毫秒（ms）为单位提供，必须通过除以1000转换为秒，以便与 $\\Delta t = 1/f$（其中 $f$ 的单位是赫兹）在量纲上保持一致。\n\n**步骤4：主导性分类**\n在计算出序列 $(y_1, y_2, y_3, y_4, y_5)$ 后，确定主导整数 $S$。设 $\\epsilon = 10^{-9}$。\n- 初始化增加计数器 $I=0$ 和减少计数器 $D=0$。\n- 对于 $k$ 从 $2$ 到 $5$，比较 $y_k$ 和 $y_{k-1}$：\n  - 如果 $y_k - y_{k-1} > \\epsilon$，则 $I$ 增加1。\n  - 如果 $y_k - y_{k-1} < -\\epsilon$，则 $D$ 增加1。\n- 应用规则：\n  - 如果 $I \\ge 3$ 且 $y_5 - y_1 > \\epsilon$，则设 $S = 1$。\n  - 否则，如果 $D \\ge 3$ 且 $y_5 - y_1 < -\\epsilon$，则设 $S = -1$。\n  - 否则，设 $S = 0$。\n\n这样就完成了解决该问题所需的理论和算法框架。具体实现将精确遵循这一逻辑。", "answer": "[[0.200000, 0.222343, 0.224108, 0.220199, 0.214030, 0], [0.500000, 0.353381, 0.252671, 0.198275, 0.166164, -1], [0.050000, 0.069969, 0.084478, 0.095450, 0.103986, 1], [0.200000, 0.161042, 0.133742, 0.114758, 0.101373, -1]]", "id": "2751339"}]}