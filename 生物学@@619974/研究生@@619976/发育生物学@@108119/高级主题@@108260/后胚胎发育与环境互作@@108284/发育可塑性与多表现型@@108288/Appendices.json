{"hands_on_practices": [{"introduction": "有力的科学结论源于严谨的实验设计。在研究发育可塑性时，一个关键的挑战是如何区分表型变异的不同来源。本练习将引导你像实验生物学家一样思考，设计一个能够厘清遗传、母体效应和环境因素对可塑性状复杂影响的实验方案 [@problem_id:2629992]。通过评估不同的设计，你将学会如何预见并控制混杂变量，这是进行任何定量遗传学研究的基础。", "problem": "一种蝾螈的兼性同类相食形态是在幼体发育过程中由资源和同种个体信号环境诱导产生的。您希望估计一个数量形态指标 $Y$ 在 $E = 2$ 种饲养环境（对照组 vs. 食肉性诱导信号组）下的反应规范，并量化可塑性是否存在遗传变异（基因型-环境互作），同时控制母体效应和共同环境效应。您可以收集野生蝾螈成体并进行体外受精控制实验。\n\n您可以假设以下基本原理：(i) 表型方差可以分解为 $V_P = V_G + V_E + V_{G \\times E} + V_M + V_{CE} + V_\\varepsilon$，其中 $V_G$ 是遗传方差， $V_E$ 是环境方差， $V_{G \\times E}$ 是基因型-环境互作方差（反应规范的变异）， $V_M$ 是母体效应方差， $V_{CE}$ 是共享的共同环境方差， $V_\\varepsilon$ 是残差方差；(ii) 反应规范是某个基因型从环境到表型的映射，反应规范的遗传变异在统计上表现为不同遗传群体间斜率的变异；(iii) 线性混合效应模型可以表示分层抽样以及截距和斜率在不同分组因子间的随机变异。\n\n您将实施分窝设计。每个全同胞家系都被分开并在两种环境中饲养。水箱是环境内的实验单元。您可以测量每个卵群产卵时的卵湿重等协变量。\n\n以下哪个选项提出了一个科学严谨的分窝实验设计和一个线性混合效应模型，该模型能够估计种群水平的反应规范、将加性遗传效应与母体效应分开、并估计可塑性的遗传方差，同时控制水箱水平的共同环境效应？\n\nA. 实验设计：父系半同胞分窝设计。将 $S \\ge 10$ 个父本分别与 $D \\ge 2$ 个母本交配（总全同胞家系数量为 $F = S \\times D$）。对于每个家系，在 $E = 2$ 个环境中的每一个环境中，将数量相等的卵随机分配到 $R \\ge 2$ 个水箱中。记录卵群的平均卵湿重。随机化家系在水箱中的分配，以在不同环境和水箱间取得平衡。模型：\n$$\nY_{ijklmn} \\;=\\; \\mu \\;+\\; \\alpha_E\\,E_l \\;+\\; \\beta\\,\\text{EggMass}_{ij} \\;+\\; s_i \\;+\\; d_{j(i)} \\;+\\; (sE)_{il} \\;+\\; (dE)_{j(i)l} \\;+\\; t_{k(l)} \\;+\\; \\varepsilon_{ijklmn},\n$$\n其中 $i \\in \\{1,\\dots,S\\}$ 为父本索引，$j \\in \\{1,\\dots,D\\}$ 为嵌套在父本 $i$ 内的母本索引，$l \\in \\{1,2\\}$ 为环境索引，$k$ 为嵌套在环境 $l$ 内的水箱索引，$n$ 为个体索引。固定效应：截距 $\\mu$，环境效应 $\\alpha_E\\,E_l$，协变量 $\\beta\\,\\text{EggMass}_{ij}$。随机效应：$s_i \\sim \\mathcal{N}(0,\\sigma^2_{s})$（通过父本得到的加性遗传截距），$d_{j(i)} \\sim \\mathcal{N}(0,\\sigma^2_{d})$（父本内的母本，捕捉母体及非加性家系效应），$(sE)_{il} \\sim \\mathcal{N}(0,\\sigma^2_{sE})$（反应规范斜率的加性遗传方差），$(dE)_{j(i)l} \\sim \\mathcal{N}(0,\\sigma^2_{dE})$（母体/家系特异性可塑性），$t_{k(l)} \\sim \\mathcal{N}(0,\\sigma^2_{t})$（环境内的水箱），以及 $\\varepsilon_{ijklmn} \\sim \\mathcal{N}(0,\\sigma^2_{\\varepsilon})$。\n\nB. 实验设计：仅全同胞分窝设计。将 $S$ 个父本中的每一个与一个母本交配（$D = 1$），创建 $F = S$ 个全同胞家系。将每个家系分到 $E = 2$ 个环境中，每个环境有 $R \\ge 2$ 个水箱。不记录卵重。模型：\n$$\nY_{ijkl} \\;=\\; \\mu \\;+\\; \\alpha_E\\,E_l \\;+\\; f_k \\;+\\; (fE)_{kl} \\;+\\; \\varepsilon_{ijkl},\n$$\n其中家系 $f_k$ 和家系-环境互作 $(fE)_{kl}$ 为随机效应，但没有父本或母本的分离，也没有水箱效应。\n\nC. 实验设计：采用与A中相同的父系半同胞分窝设计，但将一个家系的所有后代集中放入每个环境的单个水箱中（$R = 1$），以最大化每个水箱的样本量，并且不测量卵重。模型：\n$$\nY_{ijl} \\;=\\; \\mu \\;+\\; E_l \\;+\\; s_i \\;+\\; d_{j(i)} \\;+\\; (sdE)_{ij l} \\;+\\; \\varepsilon_{ijl},\n$$\n其中 $(sdE)_{ij l}$ 是一个随机的家系-环境互作项；没有包含明确的水箱效应或母体协变量。\n\nD. 实验设计：采用与A中相同的父系半同胞分窝设计，另外将每个家系一半的卵交叉抚养到含有不相关幼体的水箱中，以“洗掉”母体效应。忽略卵重。模型：\n$$\nY_{ijklm} \\;=\\; \\mu \\;+\\; \\alpha_E\\,E_l \\;+\\; \\alpha_F\\,F_m \\;+\\; (EF)_{lm} \\;+\\; t_k \\;+\\; \\varepsilon_{ijklm},\n$$\n将家系 $F_m$ 和家系-环境互作 $(EF)_{lm}$ 作为固定效应处理， $t_k$ 作为随机水箱效应，且没有父本或母本的随机项。", "solution": "对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **系统：** 一种蝾螈的兼性同类相食形态。\n- **表型：** 一个数量形态学指标，记为 `$Y$`。\n- **环境：** `$E = 2$` 种饲养环境（对照组 vs. 食肉性诱导信号组）。\n- **主要目标：**\n    1. 估计 `$Y$` 在两种环境下的种群水平反应规范。\n    2. 量化可塑性的遗传变异（基因型-环境互作，`$V_{G \\times E}$`）。\n    3. 将加性遗传效应（`$V_G$`）与母体效应（`$V_M$`）分离开来。\n    4. 控制水箱水平上的共同环境效应（`$V_{CE}$`）。\n- **可用的方法和限制：**\n    1. 使用野生捕获的成体。\n    2. 可以进行受控的体外受精。\n    3. 实施分窝设计，每个全同胞家系被分开并在两种环境中饲养。\n    4. 水箱是环境内的实验单元。\n    5. 可以测量每个卵群的卵湿重等协变量。\n- **假设的基础理论：**\n    1. 方差分解：`$V_P = V_G + V_E + V_{G \\times E} + V_M + V_{CE} + V_\\varepsilon$`。\n    2. 反应规范的定义，以及 `$V_{G \\times E}$` 定义为基因型间斜率的变异。\n    3. 线性混合效应模型适用于分析此类数据。\n\n### 步骤2：使用提取的已知条件进行验证\n对问题陈述的有效性进行审视。\n1.  **科学依据：** 该问题牢固地建立在数量遗传学和发育生物学的既定原则之上。兼性多表现型、反应规范、基因型-环境互作以及表型方差的分解是进化生物学的核心概念。所提出的实验框架（父系半同胞、分窝设计）是解决此类问题的标准而强大的方法。该问题具有科学合理性。\n2.  **良构性：** 目标陈述清晰且可量化：估计一个种群水平的效应，分离特定的方差组分（`$V_G$`、`$V_M$`、`$V_{G \\times E}$`），并控制一个混杂因素（`$V_{CE}$`）。问题要求根据这些明确的目标来评估特定的实验设计和统计模型。可以确定一个唯一的最佳选项。该问题是良构的。\n3.  **客观性：** 语言技术性强、精确，没有主观或含糊的术语。所使用的所有术语（`父系半同胞`、`反应规范`、`线性混合效应模型`）在该领域都有严格的定义。该问题是客观的。\n4.  **其他缺陷：** 问题陈述是自洽的、一致的，并描述了一个可行（尽管复杂）的生物学实验。根据验证标准，它并非无足轻重、隐喻性或存在其他缺陷。\n\n### 步骤3：结论与行动\n问题陈述有效。将通过根据既定的科学目标评估每个选项来推导出完整解决方案。\n\n### 选项分析\n\n目标是找到一个能够同时实现以下几点的实验设计和统计模型：\n1.  估计平均可塑性（种群水平反应规范的斜率）。\n2.  将加性遗传方差（`$V_A$`，`$V_G$` 的一个组分）与母体效应方差（`$V_M$`）分离开。\n3.  估计可塑性中的加性遗传方差（`$V_{A \\times E}$`，`$V_{G \\times E}$` 的一个组分）。\n4.  控制共享水箱引起的共同环境效应（`$V_{CE}$）。\n\n#### 选项 A\n该选项提出了一个父系半同胞分窝设计和相应的线性混合效应模型。\n- **设计：** 父系半同胞设计，其中每个父本（`$s_i$`）与多个母本（`$d_{j(i)}$`）交配，是区分加性遗传效应与母体及其他非加性遗传效应的经典方法。不同父本后代均值之间的方差可以用来估计 `$\\frac{1}{4}V_A$`。嵌套在父本内的母本均值之间的方差可以用来估计 `$\\frac{1}{4}V_A + \\frac{1}{4}V_D + V_{M}$`（其中 `$V_D$` 是显性遗传方差）。这种结构对于实现**目标2**至关重要。\n- 分窝设计方面，即每个家系都暴露于两种环境中，是研究可塑性及其遗传基础所必需的。\n- 在每个家系-环境组合中使用重复水箱（`$R \\ge 2$`）是一个关键特征。这种重复允许将水箱水平的共同环境方差（`$V_{CE}$`）与家系-环境互作方差（`$V_{G \\times E}$`）和残差方差（`$V_\\varepsilon`）分开。这实现了**目标4**。\n- 测量卵重并将其作为协变量纳入模型，为产前母体效应的一个主要来源提供了直接的统计控制，进一步改善了估计。\n- **模型：** 所提出的模型是全面的且设定正确。\n    - `$\\alpha_E\\,E_l$`: 环境的固定效应估计了两种环境之间的平均差异，即种群水平反应规范的斜率。这实现了**目标1**。\n    - `$s_i$`: 随机父本效应估计了表型截距的加性遗传方差。\n    - `$d_{j(i)}$`: 父本内母本的随机效应估计了母体方差和剩余的遗传方差。与`$s_i$`一起，这实现了**目标2**。\n    - `$(sE)_{il}$`: 随机的父本-环境互作效应。其方差 `$\\sigma^2_{sE}$` 直接估计了反应规范斜率的加性遗传方差（`$\\frac{1}{4}V_{A \\times E}$`）。这是可塑性中遗传变异的明确度量，实现了**目标3**。\n    - `$t_{k(l)}$`: 随机水箱效应。其方差 `$\\sigma^2_t$` 直接估计了 `$V_{CE}$`，实现了**目标4**。\n该选项提供了一个科学严谨的设计和正确指定的模型，满足了问题的所有要求。\n\n**对A的结论：正确**\n\n#### 选项 B\n该选项提出了一个全同胞分窝设计。\n- **设计：** 全同胞设计（`$S$` 个父本与 `$S$` 个母本交配，`$D=1$`）意味着所有的遗传效应和亲代效应都混杂在单个“家系”效应（`$f_k$`）中。无法将父本的贡献（加性遗传）与母本的贡献（加性遗传加母体效应）分离开来。因此，**目标2**无法实现。\n- **模型：** 模型 `$$Y_{ijkl} \\;=\\; \\mu \\;+\\; \\alpha_E\\,E_l \\;+\\; f_k \\;+\\; (fE)_{kl} \\;+\\; \\varepsilon_{ijkl}$$` 反映了这种混杂。`$f_k$` 的方差将 `$V_G$`、`$V_M$` 和家系特有的共同环境效应混杂在一起。互作项 `$(fE)_{kl}$` 的方差混淆了 `$V_{G \\times E}$` 和 `$V_{M \\times E}$`。\n- 最重要的是，该模型完全忽略了水箱效应项。由于实验设计明确指出有重复的水箱（`$R \\ge 2$`），不模拟水箱效应构成了一个严重的模型设定错误。任何真实的水箱效应都会被混入其他方差组分中，从而使估计产生偏差。这未能实现**目标4**。\n\n**对B的结论：不正确**\n\n#### 选项 C\n该选项修改了A中的设计，每个家系-环境组合只使用一个水箱（`$R=1$`）。\n- **设计：** 使用单个水箱（`$R=1$`）是一个致命的设计缺陷，称为伪重复。在这种设计下，水箱的效应与家系-环境互作完全混杂。无法确定一个家系在特定环境中的独特表型是由于其遗传特性（`$G \\times E$`）还是其被饲养的单个水箱的特定、独特条件（`$V_{CE}$`）。这种设计使得**目标4**无法实现。\n- **模型：** 模型 `$$Y_{ijl} \\;=\\; \\mu \\;+\\; E_l \\;+\\; s_i \\;+\\; d_{j(i)} \\;+\\; (sdE)_{ij l} \\;+\\; \\varepsilon_{ijl}$$` 忽略了水箱效应项，因为它无法被估计。`$(sdE)_{ij l}` 项的方差会同时吸收真实的遗传-环境互作效应和水箱的共同环境方差（`$\\sigma^2_{sdE} = \\sigma^2_{G \\times E} + \\sigma^2_{M \\times E} + \\sigma^2_{CE}$`），导致对可塑性方差的估计值偏高且无法解释。这未能满足将 `$V_{G \\times E}` 从 `$V_{CE}$` 中分离出来的核心要求。\n\n**对C的结论：不正确**\n\n#### 选项 D\n该选项提出了一个描述含糊的“交叉抚养”部分的设计，以及最关键的，一个设定不当的模型。\n- **设计：** 虽然交叉抚养是一种有效的技术，但这里的描述不清楚。更重要的问题在于模型。\n- **模型：** 模型 `$$Y_{ijklm} \\;=\\; \\mu \\;+\\; \\alpha_E\\,E_l \\;+\\; \\alpha_F\\,F_m \\;+\\; (EF)_{lm} \\;+\\; t_k \\;+\\; \\varepsilon_{ijklm}$$` 将家系（`$F_m$`）和家系-环境互作（`$(EF)_{lm}$`）指定为**固定效应**。数量遗传学研究的目标是对一个种群做出推断，而不仅仅是实验中的特定家系。要做到这一点，必须估计方差组分（`$V_G$`、`$V_{G \\times E}$` 等），这需要将家系（或父本和母本）作为**随机效应**处理。将家系作为固定效应处理，可以检验*这些特定的家系*是否不同，但不能估计家系所抽样自的种群的方差。因此，该模型无法量化 `$VG$` 或 `$V_{G \\times E}$`，从根本上未能实现**目标2和3**。\n- 此外，通过将父本和母本合并为单个家系项 `$F_m$`，即使它被指定为随机效应，该模型也失去了分离加性遗传效应和母体效应的能力。\n\n**对D的结论：不正确**\n\n### 结论\n只有选项A提出了一个完整且正确的实验和统计框架。父系半同胞设计允许将加性遗传效应与母体效应分开。在每个家系-环境组合内设置重复的水箱，对于分离共同环境效应和基因型-环境互作至关重要。所提出的混合效应模型正确地反映了这种分层设计，并包含了所有必要的随机效应来估计目标方差组分（`$\\sigma^2_s$`、`$\\sigma^2_{sE}$`、`$\\sigma^2_t$`），从而实现了问题中陈述的所有科学目标。", "answer": "$$\\boxed{A}$$", "id": "2629992"}, {"introduction": "从精心设计的实验中收集数据后，下一步是量化观察到的模式。本练习将深入探讨可塑性研究的统计核心，即利用混合效应模型来描述特定基因型的反应规范 [@problem_id:2630142]。更重要的是，你将学习如何将表型方差分解为遗传、环境以及两者交互作用的组分，并推导出如何从数学上定义和计算基因型-环境互作（$V_{G \\times E}$）方差。", "problem": "将发育可塑性和多酚现象形式化的一个常用方法是使用基因型特异性反应规范，它将一个环境指数映射到一个表型。考虑一个实验，该实验包含一组 $n$ 个克隆基因型，在 $m$ 个受控环境中培养。这些环境由一个连续的环境指数 $z$ 来表征，该指数已经过均值中心化处理，因此 $\\sum_{j=1}^{m} z_{j} = 0$。对于每个基因型 $g \\in \\{1,\\dots,n\\}$ 和每个环境 $j \\in \\{1,\\dots,m\\}$，都有 $r_{gj} \\ge 2$ 个由 $i$ 索引的重复个体，其表型为 $y_{igj}$。假设每个基因型都具有线性的反应规范，其截距和斜率是基因型特异性的，并带有重复水平的噪声。\n\n仅使用反应规范、线性混合效应模型的核心定义以及线性变换的基本概率法则，完成以下任务：\n\n1) 构建一个分层混合效应模型来估计基因型特异性的截距和斜率。您的模型必须指明：\n- 关于 $y_{igj}$ 的个体水平方程，用一个固定截距、一个关于 $z_j$ 的固定斜率、随机的基因型特异性截距和斜率以及残差噪声来表示。\n- 随机的基因型特异性效应的联合分布和残差的分布，包括所有必需的方差组分和任何协方差。\n- 为保证可识别性和有效推断所需的独立性假设。\n\n2) 从您的模型出发，仅使用线性组合的方差和协方差性质，推导出在任意环境值 $x$ 下表型的遗传方差的显式表达式，记为 $V_{G}(x)$，用随机截距和随机斜率的方差组分及其协方差来表示。然后，将“在 $x$ 处的基因型与环境互作(GxE)方差”$V_{G\\times E}(x)$，有原则地定义为 $V_{G}(x)$ 中源于相对于平均环境 $x=0$ 的基因型间环境依赖性差异的部分，并以闭合形式表示 $V_{G\\times E}(x)$。\n\n3) 假设对完整数据集进行限制性最大似然 (REML) 估计，得到随机截距、随机斜率及其协方差以及残差方差的以下方差组分估计值：$\\sigma_{b0}^{2} = 0.20$，$\\sigma_{b1}^{2} = 0.10$，$\\sigma_{b0b1} = -0.02$，以及 $\\sigma_{e}^{2} = 0.50$。使用您在第 (2) 部分的推导，计算在环境值 $x^{\\star} = 1.5$ 时，可归因于 GxE 的总表型方差的比例，定义为 $V_{G\\times E}(x^{\\star})/\\left[V_{G}(x^{\\star}) + \\sigma_{e}^{2}\\right]$。将您的答案四舍五入到四位有效数字，并以无单位的小数形式报告。", "solution": "科学基础包括反应规范的定义、线性混合效应（随机系数）模型以及线性组合的方差法则。反应规范将每个基因型的环境指数映射到表型。一个包含跨基因型的随机截距和随机斜率的线性混合效应模型，能够在捕捉基因型特异性反应规范的同时，在不同基因型间“借力”。使用的方差法则包括 $\\,\\operatorname{Var}(aX+bY)=a^{2}\\operatorname{Var}(X)+b^{2}\\operatorname{Var}(Y)+2ab\\,\\operatorname{Cov}(X,Y)\\,$ 以及独立组分的方差线性性质。\n\n1) 模型构建。令 $z_j$ 为均值中心化的。分层模型为\n$$\ny_{igj} \\;=\\; \\big(\\beta_{0} + \\beta_{1} z_{j}\\big) \\;+\\; \\big(b_{0g} + b_{1g} z_{j}\\big) \\;+\\; \\varepsilon_{igj},\n$$\n其中 $\\,\\beta_{0}\\,$ 和 $\\,\\beta_{1}\\,$ 是固定效应，代表反应规范的种群平均截距和斜率；而 $\\,b_{0g}\\,$ 和 $\\,b_{1g}\\,$ 是基因型特异性的随机偏差（随机截距和随机斜率）。我们假设随机效应服从联合高斯分布：\n$$\n\\begin{pmatrix}\nb_{0g}\\\n$$4pt]\nb_{1g}\n\\end{pmatrix}\n\\sim \\mathcal{N}\\!\\left(\n\\begin{pmatrix}\n0\\\n$$2pt]\n0\n\\end{pmatrix},\n\\;\\;\n\\boldsymbol{\\Sigma}_{b}\n\\right),\n\\qquad\n\\boldsymbol{\\Sigma}_{b} \\;=\\;\n\\begin{pmatrix}\n\\sigma_{b0}^{2} & \\sigma_{b0b1}\\\n$$4pt]\n\\sigma_{b0b1} & \\sigma_{b1}^{2}\n\\end{pmatrix}.\n$$\n残差是独立同分布的，满足\n$$\n\\varepsilon_{igj} \\sim \\mathcal{N}(0,\\sigma_{e}^{2}).\n$$\n独立性假设：$\\,\\{(b_{0g},b_{1g})\\}\\,$ 在基因型之间是独立的，残差 $\\,\\varepsilon_{igj}\\,$ 在所有个体之间是独立的，并且与所有随机效应独立，而 $\\,z_{j}\\,$ 被视为设计固定的（受控环境），并进行均值中心化以提高 $\\,\\beta_{0}\\,$ 和 $\\,\\sigma_{b0b1}\\,$ 的可解释性和可识别性。\n\n这是一个随机系数（随机回归）混合效应模型，通过随机效应 $\\,b_{0g}\\,$ 和 $\\,b_{1g}\\,$ 来估计基因型特异性的斜率和截距。\n\n2) 环境值 $x$ 处的遗传方差。在环境值 $x$ 处，对表型的基因型特异性贡献是随机线性预测变量\n$$\n\\eta_{g}(x) \\;=\\; b_{0g} + b_{1g} x.\n$$\n根据线性组合的方差公式，\n$$\nV_{G}(x) \\;\\equiv\\; \\operatorname{Var}\\!\\big(\\eta_{g}(x)\\big)\n\\;=\\; \\operatorname{Var}(b_{0g}) \\;+\\; x^{2}\\operatorname{Var}(b_{1g}) \\;+\\; 2x\\,\\operatorname{Cov}(b_{0g},b_{1g})\n\\;=\\; \\sigma_{b0}^{2} \\;+\\; x^{2}\\sigma_{b1}^{2} \\;+\\; 2x\\,\\sigma_{b0b1}.\n$$\n因为 $\\,z\\,$ 是均值中心化的，所以平均环境下的遗传方差为\n$$\nV_{G}(0) \\;=\\; \\sigma_{b0}^{2}.\n$$\n一种合乎原理的方式来定义在 $x$ 处的基因型与环境互作(GxE)方差，是将其定义为遗传方差中源于相对于平均环境的基因型间环境依赖性分化的那一部分。即，\n$$\nV_{G\\times E}(x) \\;\\equiv\\; V_{G}(x) \\;-\\; V_{G}(0)\n\\;=\\; \\big(\\sigma_{b0}^{2} + x^{2}\\sigma_{b1}^{2} + 2x\\,\\sigma_{b0b1}\\big) \\;-\\; \\sigma_{b0}^{2}\n\\;=\\; x^{2}\\sigma_{b1}^{2} \\;+\\; 2x\\,\\sigma_{b0b1}.\n$$\n因此，$\\,\\sigma_{b1}^{2}\\,$ 是捕捉斜率异质性（GxE的一个核心标志）的方差组分，而 $\\,\\sigma_{b0b1}\\,$ 则捕捉具有较高截距的基因型是否倾向于随环境更陡峭地增加或减少，从而在线性于 $x$ 的层面上调节 $\\,V_{G\\times E}(x)\\,$。\n\n在此模型下，$x$ 处的总表型方差为\n$$\nV_{P}(x) \\;=\\; V_{G}(x) \\;+\\; \\sigma_{e}^{2}.\n$$\n\n3) 使用给定的方差组分在 $\\,x^{\\star}=1.5\\,$ 处进行数值计算。首先计算\n$$\nV_{G}(x^{\\star}) \\;=\\; \\sigma_{b0}^{2} \\;+\\; (x^{\\star})^{2}\\sigma_{b1}^{2} \\;+\\; 2x^{\\star}\\sigma_{b0b1}\n\\;=\\; 0.20 \\;+\\; (1.5)^{2}\\cdot 0.10 \\;+\\; 2\\cdot 1.5 \\cdot (-0.02).\n$$\n计算各项：\n- $(1.5)^{2}\\cdot 0.10 \\;=\\; 2.25 \\cdot 0.10 \\;=\\; 0.225$，\n- $2\\cdot 1.5 \\cdot (-0.02) \\;=\\; -0.06$。\n因此，\n$$\nV_{G}(1.5) \\;=\\; 0.20 + 0.225 - 0.06 \\;=\\; 0.365.\n$$\n接着\n$$\nV_{G\\times E}(1.5) \\;=\\; V_{G}(1.5) - V_{G}(0) \\;=\\; 0.365 - 0.20 \\;=\\; 0.165.\n$$\n在 $\\,x^{\\star}\\,$ 处的总表型方差是\n$$\nV_{P}(1.5) \\;=\\; V_{G}(1.5) + \\sigma_{e}^{2} \\;=\\; 0.365 + 0.50 \\;=\\; 0.865.\n$$\n因此，所求的比例为\n$$\n\\frac{V_{G\\times E}(1.5)}{V_{P}(1.5)} \\;=\\; \\frac{0.165}{0.865} \\;=\\; \\frac{33}{173} \\;\\approx\\; 0.190751\\ldots\n$$\n四舍五入到四位有效数字，结果为 $\\,0.1908\\,$，是一个无单位的小数。", "answer": "$$\\boxed{0.1908}$$", "id": "2630142"}, {"introduction": "并非所有的可塑性都是渐进式的；许多生物体表现出在不同表型之间的离散转换，即多酚现象。本练习聚焦于如何为这些“全或无”的反应建模，以内分泌干预实验的数据为例 [@problem_id:2630130]。你将运用在生物化学中至关重要的希尔方程（Hill function），来量化发育开关的敏感度（$K$）和陡峭度（$n$），从而将分子层面的机制与群体水平的表型结果联系起来。", "problem": "一项内分泌操纵实验测量了响应单一激素外源浓度而表达一种离散替代形态（记为 B 形态）的个体比例。该系统中的发育可塑性很可能是由受体介导的、具有潜在协同性的信号传导所介导，从而产生一个从激素浓度到 B 形态出现概率的单调、饱和、开关样的映射。假设以下基本依据：(i) 配体-受体结合遵循质量作用定律，(ii) 协同结合可由一个控制陡度的 Hill 型参数概括，以及 (iii) 每个个体的形态结果是一次伯努利试验，因此固定剂量下的计数来自一个二项抽样过程。使用这些依据来构建一个参数化的、归一化的、单调的剂量反应函数，其下渐近线为 $0$，上渐近线为 $1$，有一个半激活浓度 $K$（单位为纳摩尔，nM），在该浓度下响应等于 $0.5$，还有一个陡度参数 $n$（无量纲），它控制围绕 $K$ 的开关的急剧程度。通过最大化给定以下数据的二项似然来拟合 $K$ 和 $n$。\n\n数据以剂量反应数据集的形式提供，每个数据集都列出了激素浓度（单位为纳摩尔，nM）、B 形态个体的数量（成功次数）以及在该剂量下检测的个体总数。概率必须以小数形式处理，而不是百分比。\n\n为保证数值稳定性，您的算法必须确保模型在任何剂量下预测的概率都严格介于 $0$ 和 $1$ 之间。如果需要，应用一个小的数值偏移量 $\\epsilon$（其中 $0 < \\epsilon \\ll 1$）以避免在似然计算中对 $0$ 或 $1$ 进行对数运算。\n\n测试套件（四个数据集，涵盖典型、平缓、急剧和和小样本情况）：\n- 数据集 A（典型的急剧开关）：\n  - 浓度 [nM]: $[0.5, 1, 2, 5, 10, 20, 50]$\n  - 成功次数: $[0, 1, 6, 50, 89, 98, 100]$\n  - 总数: $[100, 100, 100, 100, 100, 100, 100]$\n- 数据集 B（平缓的开关）：\n  - 浓度 [nM]: $[1, 3, 10, 30, 100]$\n  - 成功次数: $[18, 46, 100, 150, 182]$\n  - 总数: $[200, 200, 200, 200, 200]$\n- 数据集 C（非常急剧的开关）：\n  - 浓度 [nM]: $[4, 8, 12, 16, 24, 48]$\n  - 成功次数: $[0, 12, 75, 127, 148, 150]$\n  - 总数: $[150, 150, 150, 150, 150, 150]$\n- 数据集 D（小样本覆盖）：\n  - 浓度 [nM]: $[0.25, 0.5, 1, 2, 4, 8]$\n  - 成功次数: $[0, 1, 4, 10, 16, 19]$\n  - 总数: $[20, 20, 20, 20, 20, 20]$\n\n任务：\n1.  在一个二项抽样模型下为每个剂量的形态计数构建一个似然函数，该模型由两个参数 $K$（单位 nM）和 $n$（无量纲）的 Hill 型开关所表征，并满足约束条件 $K > 0$ 和 $n > 0$。\n2.  实现一个数值优化程序，为每个数据集获取 $K$ 和 $n$ 的最大似然估计。使用多个起始值或重参数化方法，以合理地减小局部最优解的影响。\n3.  生物学解释要求（在您的解题说明中报告，而不是在程序输出中）：将 $K$ 解释为半最大概率时的浓度，将 $n$ 解释为开关锐度（协同性）的度量，将较大的 $n$ 与更突然的转变和围绕 $K$ 的更高局部敏感性关联起来。\n\n角度单位不适用。物理单位：所有浓度单位均为纳摩尔（nM），您必须以 nM 为单位报告 $K$。陡度参数 $n$ 是无量纲的。以小数形式报告概率。将所有报告的参数估计值四舍五入到恰好 $3$ 位小数。\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表应按顺序包含每个数据集的拟合参数，格式为 $[K_{\\mathrm{A}}, n_{\\mathrm{A}}, K_{\\mathrm{B}}, n_{\\mathrm{B}}, K_{\\mathrm{C}}, n_{\\mathrm{C}}, K_{\\mathrm{D}}, n_{\\mathrm{D}}]$，每个值四舍五入到 $3$ 位小数，并且 $K$ 的单位默认为 nM。", "solution": "问题陈述已提交以供验证。\n\n### 步骤 1：提取已知条件\n已知条件如下：\n- **模型框架**:\n    - 系统将激素浓度映射到表达替代形态（B 形态）的概率。\n    - 映射函数是一个参数化的、归一化的、单调的剂量反应函数。\n    - 下渐近线为 $0$，上渐近线为 $1$。\n    - 函数有一个半激活浓度参数 $K$（单位为纳摩尔，nM），在该浓度下响应为 $0.5$。\n    - 函数有一个陡度参数 $n$（无量纲）。\n    - 潜在过程由具有 Hill 型协同性的配体-受体结合所描述。\n    - 形态确定是一次伯努利试验，给定剂量下的形态计数遵循二项分布。\n- **约束条件**:\n    - $K > 0$\n    - $n > 0$\n- **数据（四个数据集）**:\n    - 数据集 A:\n        - 浓度 C [nM]: $[0.5, 1, 2, 5, 10, 20, 50]$\n        - 成功次数 s: $[0, 1, 6, 50, 89, 98, 100]$\n        - 总数 t: $[100, 100, 100, 100, 100, 100, 100]$\n    - 数据集 B:\n        - 浓度 C [nM]: $[1, 3, 10, 30, 100]$\n        - 成功次数 s: $[18, 46, 100, 150, 182]$\n        - 总数 t: $[200, 200, 200, 200, 200]$\n    - 数据集 C:\n        - 浓度 C [nM]: $[4, 8, 12, 16, 24, 48]$\n        - 成功次数 s: $[0, 12, 75, 127, 148, 150]$\n        - 总数 t: $[150, 150, 150, 150, 150, 150]$\n    - 数据集 D:\n        - 浓度 C [nM]: $[0.25, 0.5, 1, 2, 4, 8]$\n        - 成功次数 s: $[0, 1, 4, 10, 16, 19]$\n        - 总数 t: $[20, 20, 20, 20, 20, 20]$\n- **任务**:\n    - 构建二项似然函数。\n    - 为每个数据集找到最大似然估计（$\\hat{K}, \\hat{n}$）。\n    - 对参数 $K$ 和 $n$ 进行生物学解释。\n- **数值要求**:\n    - 使用数值偏移量 $\\epsilon$ 来确保对数计算的稳定性。\n    - 将参数估计值四舍五入到 $3$ 位小数进行报告。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据指定标准对问题进行评估。\n\n- **科学上合理**: 问题是合理的。它使用了 Hill 方程，这是生物化学和药理学中描述协同结合现象的一个标准和基础模型。将此模型与用于计数数据的二项似然相结合，代表了生物学中分析定量剂量反应实验的一种经典方法。在发育生物学和内分泌学的背景下，这些假设是明确且科学有效的。\n- **良态 (Well-Posed)**: 问题是良态的。它要求通过最大化一个明确定义的目标函数（似然函数）来估计两个参数（$K$, $n$）。数据和模型都已指定，因此解是存在的。问题要求减小局部最优解的影响，认识到数值优化中可能存在的不良态方面，并提供了解决它的合理指令。\n- **客观性**: 问题是以客观、正式的语言表述的。它提供了定量数据，并要求执行标准的数学和统计程序（最大似然估计）。没有主观或基于意见的成分。\n\n该问题没有表现出任何列出的缺陷。它在科学上并非不合理、不可形式化、不完整、不切实际、不良态、微不足道或超出科学可验证范围。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供一个解决方案。\n\n---\n\n### 解题推导\n\n任务是根据实验数据估计剂量反应模型的参数。这是一个统计推断问题，我们将使用最大似然估计 (Maximum Likelihood Estimation, MLE) 方法来解决。\n\n**1. 剂量反应模型构建**\n\n问题要求一个S型剂量反应曲线，该曲线将激素浓度 $C$ 映射到个体发育成 B 形态的概率 $P$。该函数必须具有 $0$ 的下渐近线，$1$ 的上渐近线，一个半最大浓度 $K$，以及一个协同性参数 $n$。标准的 Hill 方程精确地满足了这些要求：\n$$ P(C; K, n) = \\frac{C^n}{K^n + C^n} $$\n这个方程可以重写为一种在数值上更优的形式，以减轻大 $C$ 或 $K$ 值可能引起的溢出问题：\n$$ P(C; K, n) = \\frac{(C/K)^n}{1 + (C/K)^n} $$\n在此模型中，$K$ 代表概率为 $0.5$ 时的浓度，因为 $P(K; K, n) = \\frac{(K/K)^n}{1 + (K/K)^n} = \\frac{1^n}{1+1^n} = \\frac{1}{2}$。参数 $n$，即 Hill 系数，控制着开关样响应的陡峭程度。\n\n**2. 似然函数**\n\n每个浓度 $C_i$ 的数据包括在总共 $t_i$ 个个体中出现成功（B 形态个体）的次数 $s_i$。问题指出这是一个二项抽样过程。在给定成功概率 $p_i = P(C_i; K, n)$ 的情况下，在 $t_i$ 次试验中观察到 $s_i$ 次成功的概率由二项概率质量函数给出：\n$$ \\mathcal{L}_i(K, n | C_i, s_i, t_i) = \\binom{t_i}{s_i} p_i^{s_i} (1 - p_i)^{t_i - s_i} $$\n假设不同浓度下的结果是独立的，整个数据集的总似然是各个似然的乘积：\n$$ \\mathcal{L}(K, n) = \\prod_{i} \\mathcal{L}_i = \\prod_{i} \\binom{t_i}{s_i} p_i^{s_i} (1 - p_i)^{t_i - s_i} $$\n为了分析和计算的方便，我们处理对数似然函数 $\\ln(\\mathcal{L})$。最大化 $\\mathcal{L}$ 等同于最大化 $\\ln(\\mathcal{L})$。\n$$ \\ln \\mathcal{L}(K, n) = \\sum_{i} \\left[ \\ln\\binom{t_i}{s_i} + s_i \\ln(p_i) + (t_i - s_i) \\ln(1 - p_i) \\right] $$\n二项系数组合项 $\\ln\\binom{t_i}{s_i}$ 不依赖于参数 $K$ 和 $n$。因此，在优化过程中可以忽略它。需要最大化的目标函数，即对数似然的核心部分是：\n$$ \\ell(K, n) = \\sum_{i} \\left[ s_i \\ln(p_i) + (t_i - s_i) \\ln(1 - p_i) \\right] $$\n其中 $p_i = P(C_i; K, n)$。\n\n**3. 最大似然估计与优化**\n\n最大似然估计 $(\\hat{K}, \\hat{n})$ 是在满足约束条件 $K > 0$ 和 $n > 0$ 的情况下，使 $\\ell(K, n)$ 最大化的 $(K, n)$ 值。这是一个非线性优化问题。标准的数值优化算法旨在最小化一个函数。因此，我们将问题重新表述为最小化负对数似然：\n$$ (\\hat{K}, \\hat{n}) = \\arg\\min_{K>0, n>0} \\left( -\\ell(K, n) \\right) $$\n为了强制执行 $K$ 和 $n$ 的正值约束，我们采用重参数化方法。我们定义新的无约束参数 $\\alpha$ 和 $\\beta$ 使得：\n$$ K = e^{\\alpha} \\quad \\text{且} \\quad n = e^{\\beta} $$\n然后对 $\\alpha, \\beta \\in \\mathbb{R}$ 进行优化。目标函数变为：\n$$ f(\\alpha, \\beta) = - \\sum_{i} \\left[ s_i \\ln(p_i) + (t_i - s_i) \\ln(1 - p_i) \\right] $$\n其中 $p_i$ 现在是 $\\alpha$ 和 $\\beta$ 的函数。\n\n为保证数值稳定性，如建议所述，概率 $p_i$ 必须严格限制在远离 $0$ 和 $1$ 的范围内，以防止出现 $\\ln(0)$ 或 $\\ln(1-1)$ 的计算。我们将计算出的概率限制在一个小区间 $[\\epsilon, 1-\\epsilon]$ 内，其中 $\\epsilon$ 是一个小的正数（例如 $10^{-9}$）。\n\n为了降低收敛到局部最小值的风险，优化程序将从多个起始点启动。一个合理的策略是使用对 $K$ 的有根据的猜测（例如浓度的几何平均值），并测试几个合理的陡度参数 $n$ 的起始值（例如 $1, 2, 5, 10$）。在所有运行中产生负对数似然最小值的参数集被选为最终估计。\n\n**4. 参数的生物学解释**\n\n- **参数 $K$（半最大浓度）**: 这个参数，在药理学中通常表示为 EC$_{50}$，代表引起 $0.5$ 响应概率的激素浓度。在此背景下，它是导致群体中一半个体转变为 B 形态所需的浓度。它作为发育系统对激素信号敏感性的基本度量。较低的 $K$ 值表示较高的敏感性。\n\n- **参数 $n$（Hill 系数）**: 这个无量纲参数量化了响应曲线的陡峭程度。它是协同性的一个指标。\n    - $n = 1$ 意味着非协同的、渐进的响应，类似于 Michaelis-Menten 动力学。\n    - $n > 1$ 意味着正协同性，即初始的结合事件增加了系统对后续事件的亲和力。这导致在狭窄的激素浓度范围内，从低概率状态到高概率状态的急剧、开关样的转变。较大的 $n$ 表示更超敏、更具开关特性的行为。\n    - $0 < n < 1$ 意味着负协同性，这在发育开关中较不常见，并导致响应比非协同情况更平缓。\n\n从实验数据中估计这些参数可以对发育开关进行定量表征，从而深入了解其潜在调控网络的特性。", "answer": "[5.003,5.093,10.000,1.250,12.008,8.016,2.000,3.003]", "id": "2630130"}]}