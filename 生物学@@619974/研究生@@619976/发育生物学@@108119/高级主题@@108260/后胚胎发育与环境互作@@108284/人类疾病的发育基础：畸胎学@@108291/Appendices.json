{"hands_on_practices": [{"introduction": "剂量-反应关系是毒理学的核心概念，它描述了暴露于化学物质的剂量与所产生效应的严重程度之间的关系。本练习将指导您使用经典的希尔（Hill）方程来拟合一个假设的致畸剂的剂量反应数据，该方程常用于描述协同效应。通过对数据进行线性化处理，您将估算出关键参数，并最终计算出基准剂量（BMD），这是现代风险评估中用于确定安全暴露水平的关键指标[@problem_id:2679562]。", "problem": "一项发育毒理学研究测量了在妊娠第 $8$ 天单次给药一种候选致畸剂后，母体暴露下小鼠胚胎发生结构畸形的概率。为避免窝别效应，每只母鼠提供一个胚胎。定性结局在足月时被记为畸形或正常。数据总结如下（剂量 $d$ 单位为 $\\mathrm{mg/kg}$，样本量 $N$，畸形计数 $M$，观测风险 $\\hat{P}(d) = M/N$）：\n- $d = 0$， $N = 200$， $M = 10$。\n- $d = 10$， $N = 100$， $M = 24$。\n- $d = 20$， $N = 40$， $M = 21$。\n- $d = 40$， $N = 100$， $M = 81$。\n\n假定一个饱和协同的剂量-反应关系，该关系符合具有非零背景风险且上限不超过 $1$ 的希尔型（Hill-type）机制。设背景风险为 $P_0 = P(0)$，半数最大效应浓度（EC50）为 $EC_{50}$，希尔系数为 $n$。仅使用定性风险、背景风险和额外风险的基本定义，并对考虑了背景 $P_0$ 的希尔型关系进行适当的线性化，完成以下操作：\n\n1. 根据对照组数据估计 $P_0$。\n2. 使用三个非零剂量组，应用线性化方法，在 $\\ln$–$\\ln$ 空间中得到一个直线关系，通过直线拟合来估计 $n$ 和 $EC_{50}$。为了进行点估计，可以假定抽样变异性可以忽略不计。\n3. 将剂量 $d$ 下的额外风险定义为 $r(d) = \\dfrac{P(d) - P_0}{1 - P_0}$。对于基准反应水平 $r^{\\star} = 0.1$，计算在拟合的希尔型模型下满足 $r(BMD) = r^{\\star}$ 的基准剂量 $BMD$。\n\n将最终的 $BMD$ 四舍五入到 $3$ 位有效数字，并以 $\\mathrm{mg/kg}$ 为单位表示。最终答案必须是单个实数。", "solution": "首先将验证问题的科学性和逻辑完整性。\n\n**步骤1：提取已知条件**\n- 剂量 $d$（单位 $\\mathrm{mg/kg}$）、样本量 $N$ 和畸形计数 $M$ 的数据：\n  - $d = 0$， $N = 200$， $M = 10$。\n  - $d = 10$， $N = 100$， $M = 24$。\n  - $d = 20$， $N = 40$， $M = 21$。\n  - $d = 40$， $N = 100$， $M = 81$。\n- 观测风险的定义：$\\hat{P}(d) = M/N$。\n- 假定的剂量-反应模型：一个具有非零背景风险 $P_0 = P(0)$、半数最大效应浓度 $EC_{50}$ 和希尔系数 $n$ 的希尔型机制。最大反应不超过 $1$。\n- 分析要求：对三个非零剂量组使用 $\\ln$–$\\ln$ 空间中的线性化方法，通过直线拟合来估计 $n$ 和 $EC_{50}$。在点估计中，抽样变异性可忽略不计。\n- 额外风险的定义：$r(d) = \\dfrac{P(d) - P_0}{1 - P_0}$。\n- 任务：计算与基准反应水平 $r^{\\star} = 0.1$ 相对应的基准剂量 $BMD$。\n- 最终答案格式：将 $BMD$ 四舍五入到 $3$ 位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题是剂量-反应模型的一个应用，这是毒理学和药理学中的一个基本概念。希尔方程是描述协同现象的标准模型，而基准剂量（BMD）方法是现代定量风险评估的基石。该问题牢固地植根于既定的科学原理。\n- **适定性**：该问题提供了所有必要的数据、一个指定的模型形式和一种清晰的方法（线性化），以确定模型参数和最终的目标量（$BMD$）。忽略抽样变异性的指令使得估计成为一个确定性计算，确保了解的唯一性。\n- **客观性**：该问题的陈述精确、客观且定量，没有任何主观或模棱两可的语言。\n\n**步骤3：结论与行动**\n该问题在科学上是合理的，适定的，客观的，并且不含任何不一致或模糊之处。因此，它被判定为**有效**。将提供一个分步解答。\n\n**求解过程**\n\n该问题需要一个三部分的解答：估计背景风险、估计模型参数和计算基准剂量。\n\n**1. 估计背景风险 $P_0$**\n背景风险 $P_0$ 是在没有致畸剂（$d=0$）的情况下发生畸形的概率。这可以从对照组数据中估计。\n已知：对于 $d=0 \\, \\mathrm{mg/kg}$，样本量 $N=200$，畸形计数 $M=10$。\n背景风险的点估计是观测到的比例：\n$$ P_0 = \\hat{P}(0) = \\frac{M}{N} = \\frac{10}{200} = 0.05 $$\n\n**2. 估计希尔系数 $n$ 和 $EC_{50}$**\n剂量-反应由一个具有背景风险 $P_0$ 和最大风险为 $1$ 的希尔型模型描述。在剂量 $d$ 下的畸形概率 $P(d)$ 由下式给出：\n$$ P(d) = P_0 + (1 - P_0) \\frac{d^n}{EC_{50}^n + d^n} $$\n额外风险 $r(d)$ 的定义为 $r(d) = \\frac{P(d) - P_0}{1 - P_0}$。将 $P(d)$ 的表达式代入此定义中，得到：\n$$ r(d) = \\frac{\\left(P_0 + (1 - P_0) \\frac{d^n}{EC_{50}^n + d^n}\\right) - P_0}{1 - P_0} = \\frac{(1 - P_0) \\frac{d^n}{EC_{50}^n + d^n}}{1 - P_0} = \\frac{d^n}{EC_{50}^n + d^n} $$\n为了线性化这个关系，我们重新排列方程以分离剂量项。这被称为希尔图变换。\n$$ r(d)(EC_{50}^n + d^n) = d^n $$\n$$ r(d)EC_{50}^n = d^n(1 - r(d)) $$\n$$ \\frac{r(d)}{1 - r(d)} = \\left(\\frac{d}{EC_{50}}\\right)^n $$\n对两边取自然对数，得到一个线性方程：\n$$ \\ln\\left(\\frac{r(d)}{1 - r(d)}\\right) = n \\ln(d) - n \\ln(EC_{50}) $$\n该方程的形式为 $Y = mX + c$，其中 $Y = \\ln\\left(\\frac{r(d)}{1 - r(d)}\\right)$，$X = \\ln(d)$，斜率为 $m=n$，y轴截距为 $c = -n \\ln(EC_{50})$。\n\n现在我们为三个非零剂量组计算 $(X, Y)$ 坐标，将观测风险 $\\hat{P}(d)$ 视为真实风险 $P(d)$。\n- 对于 $d = 10 \\, \\mathrm{mg/kg}$：$\\hat{P}(10) = \\frac{24}{100} = 0.24$。\n  $r(10) = \\frac{0.24 - 0.05}{1 - 0.05} = \\frac{0.19}{0.95} = 0.2$。\n  $X_1 = \\ln(10)$。\n  $Y_1 = \\ln\\left(\\frac{0.2}{1 - 0.2}\\right) = \\ln\\left(\\frac{0.2}{0.8}\\right) = \\ln(0.25) = -\\ln(4)$。\n\n- 对于 $d = 20 \\, \\mathrm{mg/kg}$：$\\hat{P}(20) = \\frac{21}{40} = 0.525$。\n  $r(20) = \\frac{0.525 - 0.05}{1 - 0.05} = \\frac{0.475}{0.95} = 0.5$。\n  $X_2 = \\ln(20)$。\n  $Y_2 = \\ln\\left(\\frac{0.5}{1 - 0.5}\\right) = \\ln(1) = 0$。\n\n- 对于 $d = 40 \\, \\mathrm{mg/kg}$：$\\hat{P}(40) = \\frac{81}{100} = 0.81$。\n  $r(40) = \\frac{0.81 - 0.05}{1 - 0.05} = \\frac{0.76}{0.95} = 0.8$。\n  $X_3 = \\ln(40)$。\n  $Y_3 = \\ln\\left(\\frac{0.8}{1 - 0.8}\\right) = \\ln\\left(\\frac{0.8}{0.2}\\right) = \\ln(4)$。\n\n用于线性拟合的数据点是 $(\\ln(10), -\\ln(4))$、$(\\ln(20), 0)$ 和 $(\\ln(40), \\ln(4))$。斜率 $n$ 可以通过任意两点计算。使用第1和第2个点：\n$$ n = \\frac{Y_2 - Y_1}{X_2 - X_1} = \\frac{0 - (-\\ln(4))}{\\ln(20) - \\ln(10)} = \\frac{\\ln(4)}{\\ln(20/10)} = \\frac{\\ln(2^2)}{\\ln(2)} = \\frac{2\\ln(2)}{\\ln(2)} = 2 $$\n希尔系数为 $n=2$。\n\n根据定义，$EC_{50}$ 是产生半数最大效应的剂量。在额外风险 $r(d)$（范围从 $0$ 到 $1$）的背景下，半数最大反应是 $r(d)=0.5$。根据我们的数据，当 $d=20$ 时，$r(20)=0.5$。因此，$EC_{50}$ 恰好是 $20 \\, \\mathrm{mg/kg}$。\n另外，也可以使用线性拟合的截距：$c = -n \\ln(EC_{50})$。使用第2个点 $(\\ln(20), 0)$：\n$0 = (2)\\ln(20) + c \\implies c = -2\\ln(20)$。\n$-2\\ln(20) = -n \\ln(EC_{50}) = -2 \\ln(EC_{50})$，得出 $EC_{50} = 20$。\n\n拟合的参数是 $n = 2$ 和 $EC_{50} = 20 \\, \\mathrm{mg/kg}$。\n\n**3. 计算基准剂量 $BMD$**\n基准剂量 $BMD$ 是与指定的额外风险水平 $r^{\\star} = 0.1$ 相对应的剂量。我们在额外风险方程中求解 $d=BMD$：\n$$ r^{\\star} = \\frac{BMD^n}{EC_{50}^n + BMD^n} $$\n重新排列方程以求解 $BMD$：\n$$ r^{\\star}(EC_{50}^n + BMD^n) = BMD^n $$\n$$ r^{\\star}EC_{50}^n = BMD^n(1 - r^{\\star}) $$\n$$ BMD^n = EC_{50}^n \\left(\\frac{r^{\\star}}{1 - r^{\\star}}\\right) $$\n$$ BMD = EC_{50} \\left(\\frac{r^{\\star}}{1 - r^{\\star}}\\right)^{1/n} $$\n代入已知值：$EC_{50} = 20$，$n = 2$ 和 $r^{\\star} = 0.1$。\n$$ BMD = 20 \\left(\\frac{0.1}{1 - 0.1}\\right)^{1/2} = 20 \\left(\\frac{0.1}{0.9}\\right)^{1/2} = 20 \\left(\\frac{1}{9}\\right)^{1/2} $$\n$$ BMD = 20 \\times \\frac{1}{\\sqrt{9}} = 20 \\times \\frac{1}{3} = \\frac{20}{3} $$\n数值上，这等于 $BMD \\approx 6.666... \\, \\mathrm{mg/kg}$。\n将结果四舍五入到 $3$ 位有效数字，得到 $6.67 \\, \\mathrm{mg/kg}$。", "answer": "$$\\boxed{6.67}$$", "id": "2679562"}, {"introduction": "要准确评估致畸风险，仅仅了解母体的外部暴露剂量是不够的；真正的风险取决于致畸物在胚胎组织中的实际浓度。本练习将带您深入一步，通过多室药代动力学（PK）模型，模拟一种药物从母体摄入到最终在胚胎靶组织中达到特定浓度的完整过程[@problem_id:2679492]。掌握这种从外部剂量到内部暴露的转化，对于精确预测和预防发育异常至关重要。", "problem": "一名怀孕患者在器官形成期间意外暴露于异维A酸。假设以下经过科学验证和充分测试的药代动力学及发育学原理作为出发点：(i) 在线性、时不变、一级消除动力学条件下，平均稳态血浆浓度 $C_{\\text{ss,avg}}$ 在稳态时满足质量平衡，即平均消除速率等于平均输入速率，也就是 $CL \\times C_{\\text{ss,avg}} = R_{\\text{in}}$，其中 $CL$ 是表观清除率，$R_{\\text{in}}$ 是平均输入速率；(ii) 口服给药的平均输入速率为 $R_{\\text{in}} = F \\times \\text{dose rate}$，其中 $F$ 是口服生物利用度；(iii) 在胎盘两边的准平衡状态下，平均胎儿血浆浓度 $C_{\\text{f,plasma}}$ 与母体游离药物浓度成正比，比例系数为一个无量纲的胎盘转运因子 $P_{\\text{pl}}$，因此 $C_{\\text{f,plasma}} = P_{\\text{pl}} \\times f_{u} \\times C_{\\text{ss,avg}}$，其中 $f_{u}$ 是母体药物未结合分数；(iv) 平均胚胎组织浓度 $C_{\\text{tissue}}$ 通过一个无量纲的组织:血浆分配系数 $K_{p}$ 与胎儿血浆浓度相关，因此 $C_{\\text{tissue}} = K_{p} \\times C_{\\text{f,plasma}}$；以及 (v) 在持续时间为 $\\Delta t$ 的窗口内，当平均浓度 $C$ 恒定时，浓度-时间曲线下面积 (AUC) 为 $\\text{AUC} = C \\times \\Delta t$。在发育上，依赖于颅神经嵴细胞的颅面原基的敏感期大约为妊娠第 $28$ 天至第 $42$ 天，心脏流出道中隔形成的敏感期大约为妊娠第 $28$ 天至第 $35$ 天。\n\n患者的用药方案和参数如下：\n- 口服剂量 $D = 40$ mg，每 $12$ 小时一次，随餐服用（每天两次）。\n- 口服生物利用度 $F = 0.5$。\n- 表观清除率 $CL = 12$ L/h。\n- 母体药物未结合分数 $f_{u} = 0.02$。\n- 胎盘转运因子 $P_{\\text{pl}} = 0.8$。\n- 颅神经嵴衍生的颅面组织的组织:血浆分配系数 $K_{p,\\text{cf}} = 3.0$。\n- 心脏流出道组织的组织:血浆分配系数 $K_{p,\\text{card}} = 1.5$。\n\n致畸决策阈值（类视黄醇等效暴露水平）定义如下：\n- 颅面畸形阈值 $\\Theta_{\\text{cf}} = 1.5$ mg·h/L，在颅面关键窗口期内。\n- 心脏流出道畸形阈值 $\\Theta_{\\text{card}} = 0.8$ mg·h/L，在心脏关键窗口期内。\n\n假设在妊娠第 $28$ 天前已达到稳态，并在指定的窗口期内将平均浓度视为恒定。根据以下规则定义畸形预测代码 $S$：如果两个窗口的 AUC 均未超过其阈值，则 $S = 0$；如果只有颅面窗口的 AUC 超过其阈值，则 $S = 1$；如果只有心脏窗口的 AUC 超过其阈值，则 $S = 2$；如果两者都超过其阈值，则 $S = 3$。\n\n仅使用上述原理，计算：\n- 平均母体稳态血浆浓度 $C_{\\text{ss,avg}}$。\n- 平均胎儿血浆浓度 $C_{\\text{f,plasma}}$。\n- 颅面组织和心脏流出道组织的平均胚胎组织浓度 $C_{\\text{cf}}$ 和 $C_{\\text{card}}$。\n- 妊娠第 $28$ 天至第 $42$ 天（持续时间 $\\Delta t_{\\text{cf}} = 14$ 天 $= 336$ 小时）的颅面窗口 AUC，以及妊娠第 $28$ 天至第 $35$ 天（持续时间 $\\Delta t_{\\text{card}} = 7$ 天 $= 168$ 小时）的心脏窗口 AUC。\n- 使用阈值 $\\Theta_{\\text{cf}}$ 和 $\\Theta_{\\text{card}}$ 计算畸形预测代码 $S$。\n\n最后，仅报告 $S$ 的值，作为一个无单位的整数。无需四舍五入。作为解释，颅面畸形对应于影响颅神经嵴衍生物的维A酸胚胎病（例如，小耳畸形和下颌发育不全），心脏畸形对应于圆锥动脉干畸形；但是，您必须只报告 $S$ 作为最终答案。", "solution": "首先对问题进行验证。\n\n**第1步：提取已知条件**\n- 原理：\n  - (i) 稳态质量平衡：$CL \\times C_{\\text{ss,avg}} = R_{\\text{in}}$\n  - (ii) 平均口服输入速率：$R_{\\text{in}} = F \\times \\text{dose rate}$\n  - (iii) 胎盘转运：$C_{\\text{f,plasma}} = P_{\\text{pl}} \\times f_{u} \\times C_{\\text{ss,avg}}$\n  - (iv) 组织分配：$C_{\\text{tissue}} = K_{p} \\times C_{\\text{f,plasma}}$\n  - (v) 曲线下面积 (AUC)：$\\text{AUC} = C \\times \\Delta t$\n- 发育关键窗口期：\n  - 颅面：妊娠第 $28$ 天至第 $42$ 天。\n  - 心脏流出道：妊娠第 $28$ 天至第 $35$ 天。\n- 患者用药方案和参数：\n  - 口服剂量 $D = 40$ mg，每 $12$ 小时一次。\n  - 口服生物利用度 $F = 0.5$。\n  - 表观清除率 $CL = 12$ L/h。\n  - 母体药物未结合分数 $f_{u} = 0.02$。\n  - 胎盘转运因子 $P_{\\text{pl}} = 0.8$。\n  - 颅面组织:血浆分配系数 $K_{p,\\text{cf}} = 3.0$。\n  - 心脏组织:血浆分配系数 $K_{p,\\text{card}} = 1.5$。\n- 致畸阈值：\n  - 颅面畸形阈值 $\\Theta_{\\text{cf}} = 1.5$ mg·h/L。\n  - 心脏畸形阈值 $\\Theta_{\\text{card}} = 0.8$ mg·h/L。\n- AUC 计算的时间持续长度：\n  - 颅面窗口持续时间 $\\Delta t_{\\text{cf}} = 14$ 天 $= 336$ 小时。\n  - 心脏窗口持续时间 $\\Delta t_{\\text{card}} = 7$ 天 $= 168$ 小时。\n- 畸形预测代码 $S$ 的定义：\n  - $S = 0$：两个 AUC 均未超过阈值。\n  - $S = 1$：只有颅面 AUC 超过阈值。\n  - $S = 2$：只有心脏 AUC 超过阈值。\n  - $S = 3$：两个 AUC 都超过阈值。\n\n**第2步：使用提取的已知条件进行验证**\n该问题是毒理学和药代动力学中的一个定量练习，具体应用于发育致畸学。它在科学上基于线性药代动力学模型的标准框架。该问题提法明确，提供了求解所需的全部原理和参数。其语言客观而精确。该问题并非无足轻重，因为它需要多步计算，但它也并非过度复杂或故作高深。它直接探讨了人类疾病的发育基础这一主题。因此，该问题被认定为有效。\n\n**第3步：结论与行动**\n问题有效。将推导解答。\n\n解答过程是按顺序计算所需量。所有计算将首先以符号形式进行，然后代入数值。\n\n首先，我们确定平均给药速率。患者在给药间隔 $\\tau = 12$ 小时内接受剂量 $D = 40$ mg。给药速率为：\n$$\n\\text{dose rate} = \\frac{D}{\\tau} = \\frac{40 \\text{ mg}}{12 \\text{ h}} = \\frac{10}{3} \\text{ mg/h}\n$$\n\n接下来，我们使用口服生物利用度 $F = 0.5$ 来计算平均输入速率 $R_{\\text{in}}$：\n$$\nR_{\\text{in}} = F \\times \\text{dose rate} = 0.5 \\times \\frac{10}{3} \\text{ mg/h} = \\frac{1}{2} \\times \\frac{10}{3} \\text{ mg/h} = \\frac{5}{3} \\text{ mg/h}\n$$\n\n使用质量平衡原理，我们计算平均母体稳态血浆浓度 $C_{\\text{ss,avg}}$，已知表观清除率 $CL = 12$ L/h：\n$$\nC_{\\text{ss,avg}} = \\frac{R_{\\text{in}}}{CL} = \\frac{\\frac{5}{3} \\text{ mg/h}}{12 \\text{ L/h}} = \\frac{5}{3 \\times 12} \\text{ mg/L} = \\frac{5}{36} \\text{ mg/L}\n$$\n\n现在，我们使用母体药物未结合分数 $f_{u} = 0.02$ 和胎盘转运因子 $P_{\\text{pl}} = 0.8$ 来计算平均胎儿血浆浓度 $C_{\\text{f,plasma}}$：\n$$\nC_{\\text{f,plasma}} = P_{\\text{pl}} \\times f_{u} \\times C_{\\text{ss,avg}} = 0.8 \\times 0.02 \\times \\frac{5}{36} \\text{ mg/L}\n$$\n$$\nC_{\\text{f,plasma}} = \\frac{8}{10} \\times \\frac{2}{100} \\times \\frac{5}{36} \\text{ mg/L} = \\frac{80}{36000} \\text{ mg/L} = \\frac{1}{450} \\text{ mg/L}\n$$\n\n在确定了胎儿血浆浓度后，我们可以使用各自的分配系数 $K_{p,\\text{cf}} = 3.0$ 和 $K_{p,\\text{card}} = 1.5$ 来计算颅面 ($C_{\\text{cf}}$) 和心脏 ($C_{\\text{card}}$) 组织的平均胚胎组织浓度。\n对于颅面组织：\n$$\nC_{\\text{cf}} = K_{p,\\text{cf}} \\times C_{\\text{f,plasma}} = 3.0 \\times \\frac{1}{450} \\text{ mg/L} = \\frac{3}{450} \\text{ mg/L} = \\frac{1}{150} \\text{ mg/L}\n$$\n对于心脏流出道组织：\n$$\nC_{\\text{card}} = K_{p,\\text{card}} \\times C_{\\text{f,plasma}} = 1.5 \\times \\frac{1}{450} \\text{ mg/L} = \\frac{3/2}{450} \\text{ mg/L} = \\frac{3}{900} \\text{ mg/L} = \\frac{1}{300} \\text{ mg/L}\n$$\n\n接下来，我们计算每个组织在其各自关键窗口期内的浓度-时间曲线下面积 (AUC)。颅面窗口的持续时间为 $\\Delta t_{\\text{cf}} = 336$ 小时，心脏窗口的持续时间为 $\\Delta t_{\\text{card}} = 168$ 小时。\n颅面窗口的 AUC 为：\n$$\n\\text{AUC}_{\\text{cf}} = C_{\\text{cf}} \\times \\Delta t_{\\text{cf}} = \\frac{1}{150} \\text{ mg/L} \\times 336 \\text{ h} = \\frac{336}{150} \\text{ mg}\\cdot\\text{h/L} = 2.24 \\text{ mg}\\cdot\\text{h/L}\n$$\n心脏窗口的 AUC 为：\n$$\n\\text{AUC}_{\\text{card}} = C_{\\text{card}} \\times \\Delta t_{\\text{card}} = \\frac{1}{300} \\text{ mg/L} \\times 168 \\text{ h} = \\frac{168}{300} \\text{ mg}\\cdot\\text{h/L} = 0.56 \\text{ mg}\\cdot\\text{h/L}\n$$\n\n最后，我们将这些 AUC 值与其致畸阈值进行比较，以确定畸形预测代码 $S$。\n阈值为 $\\Theta_{\\text{cf}} = 1.5$ mg·h/L 和 $\\Theta_{\\text{card}} = 0.8$ mg·h/L。\n对于颅面窗口：\n$$\n\\text{AUC}_{\\text{cf}} = 2.24 \\text{ mg}\\cdot\\text{h/L} > \\Theta_{\\text{cf}} = 1.5 \\text{ mg}\\cdot\\text{h/L}\n$$\n此条件满足。暴露量超过阈值。\n对于心脏窗口：\n$$\n\\text{AUC}_{\\text{card}} = 0.56 \\text{ mg}\\cdot\\text{h/L}  \\Theta_{\\text{card}} = 0.8 \\text{ mg}\\cdot\\text{h/L}\n$$\n此条件不满足。暴露量未超过阈值。\n\n根据定义 $S$ 的规则，因为只有颅面窗口的 AUC 超过了其阈值，所以 $S$ 的值为 $1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "2679492"}, {"introduction": "致畸物通过干扰关键的细胞过程（如增殖、分化和迁移）来破坏正常的胚胎发育。本练习将您置于现代定量细胞生物学家的角色，您将通过分析模拟的细胞追踪数据，来量化一种可疑致畸物对神经嵴细胞迁移行为的影响[@problem_id:2679479]。通过计算迁移速度和方向性等指标，您不仅可以识别出细胞水平的缺陷，还能根据这些定量表型推断出潜在的分子靶点。", "problem": "给定两组条件下（对照组和暴露于疑似致畸剂组）单个颅神经嵴细胞的平面延时摄影轨迹。每条轨迹是在均匀时间间隔 $\\Delta t$ 内采样的一系列平面坐标 $(x_t, y_t)$。您的任务是计算每种条件下的平均迁移速度和方向性（以路径持久性衡量），量化处理组与对照组之间的分数变化，并基于对运动表型的原则性、规则化解释，推断可能的初级分子靶点类别。\n\n需使用的基本定义：\n- 连续帧之间的瞬时步长向量为 $\\Delta \\mathbf{r}_t = \\mathbf{r}_{t+1} - \\mathbf{r}_t$，其中 $\\mathbf{r}_t = (x_t, y_t)$。\n- 瞬时步长为 $\\ell_t = \\|\\Delta \\mathbf{r}_t\\|_2$。\n- 单个细胞的平均速度为 $v = \\frac{1}{N-1}\\sum_{t=1}^{N-1} \\frac{\\ell_t}{\\Delta t}$，其中 $N$ 是轨迹中记录的位置数。\n- 单个细胞的路径长度为 $L = \\sum_{t=1}^{N-1} \\ell_t$。\n- 单个细胞的净位移为 $D = \\|\\mathbf{r}_N - \\mathbf{r}_1\\|_2$。\n- 单个细胞的方向性（持久性）为 $p = \\frac{D}{L}$，约定当 $L = 0$ 时 $p = 0$。\n\n每个条件下的聚合指标定义为该条件下所有细胞的算术平均值：$\\bar{v}$ 和 $\\bar{p}$。比较处理组与对照组的分数变化定义为：\n$$\\Delta v_{\\mathrm{frac}} = \\frac{\\bar{v}_{\\mathrm{treated}} - \\bar{v}_{\\mathrm{control}}}{\\max(\\bar{v}_{\\mathrm{control}}, \\varepsilon)}, \\quad \\Delta p_{\\mathrm{frac}} = \\frac{\\bar{p}_{\\mathrm{treated}} - \\bar{p}_{\\mathrm{control}}}{\\max(\\bar{p}_{\\mathrm{control}}, \\varepsilon)},$$\n其中 $\\varepsilon = 10^{-9}$ 是一个小的正则化项，用以避免除以零。\n\n用于推断可能的初级分子靶点类别的规则集，使用分数变化幅度的阈值 $\\theta_v = 0.2$ 和 $\\theta_p = 0.2$：\n- 如果 $|\\Delta v_{\\mathrm{frac}}|  \\theta_v$ 且 $|\\Delta p_{\\mathrm{frac}}|  \\theta_p$：无显著运动表型，类别 ID 为 $0$。\n- 如果 $\\Delta v_{\\mathrm{frac}} \\le -\\theta_v$ 且 $|\\Delta p_{\\mathrm{frac}}|  \\theta_p$：初级收缩功能缺陷，与 RhoA/Rho 相关激酶/肌球蛋白 II 轴相符，类别 ID 为 $1$。\n- 如果 $|\\Delta v_{\\mathrm{frac}}|  \\theta_v$ 且 $\\Delta p_{\\mathrm{frac}} \\le -\\theta_p$：引导极性或平面细胞极性（PCP）核心信号传导中断（例如，趋化因子受体或 PCP 缺陷），类别 ID 为 $2$。\n- 如果 $\\Delta v_{\\mathrm{frac}} \\le -\\theta_v$ 且 $\\Delta p_{\\mathrm{frac}} \\le -\\theta_p$：与细胞外基质的粘附或整合素介导的耦合缺陷，导致路径缓慢且不规则，类别 ID 为 $3$。\n- 如果 $\\Delta v_{\\mathrm{frac}} \\ge \\theta_v$ 且 $\\Delta p_{\\mathrm{frac}} \\le -\\theta_p$：高度突出、低持久性表型，与 Rac1/肌动蛋白相关蛋白 2/3 复合物（Arp2/3）偏向性相符，类别 ID 为 $4$。\n\n假设和单位：\n- 使用 $\\Delta t = 1$ 分钟。\n- 空间坐标单位为微米。\n- 速度以微米/分钟报告，方向性为无量纲比率。\n- 所有浮点数输出必须四舍五入到三位小数。\n\n测试套件：\n对于每个测试用例，您将获得两组轨迹：对照组和处理组。每条轨迹是一个按时间排序的平面位置序列 $(x_t, y_t)$。\n\n- 测试用例 $1$ (方向性降低但速度无变化；预期映射到类别 ID $2$)：\n  - 对照组轨迹：\n    - 细胞 A: $(0,0) \\to (10,0) \\to (20,0) \\to (30,0) \\to (40,0) \\to (50,0)$\n    - 细胞 B: $(0,0) \\to (9,1) \\to (19,1) \\to (29,0) \\to (39,-1) \\to (49,-1)$\n    - 细胞 C: $(0,0) \\to (7,7) \\to (14,14) \\to (21,21) \\to (28,28) \\to (35,35)$\n  - 处理组轨迹：\n    - 细胞 A: $(0,0) \\to (7,7) \\to (14,0) \\to (21,7) \\to (28,0) \\to (35,7)$\n    - 细胞 B: $(0,0) \\to (10,0) \\to (20,0) \\to (20,10) \\to (30,10) \\to (30,0)$\n    - 细胞 C: $(0,0) \\to (8,6) \\to (16,0) \\to (24,6) \\to (32,0) \\to (40,6)$\n\n- 测试用例 $2$ (速度降低但方向性无变化；预期映射到类别 ID $1$)：\n  - 对照组轨迹：\n    - 细胞 A: $(0,0) \\to (10,0) \\to (20,0) \\to (30,0) \\to (40,0)$\n    - 细胞 B: $(0,0) \\to (9,2) \\to (18,4) \\to (27,6) \\to (36,8)$\n    - 细胞 C: $(0,0) \\to (0,10) \\to (0,20) \\to (0,30) \\to (0,40)$\n  - 处理组轨迹：\n    - 细胞 A: $(0,0) \\to (6,0) \\to (12,0) \\to (18,0) \\to (24,0)$\n    - 细胞 B: $(0,0) \\to (5,3) \\to (10,6) \\to (15,9) \\to (20,12)$\n    - 细胞 C: $(0,0) \\to (0,6) \\to (0,12) \\to (0,18) \\to (0,24)$\n\n- 测试用例 $3$ (速度和方向性均降低，包括一个静止的处理组细胞作为边界情况；预期映射到类别 ID $3$)：\n  - 对照组轨迹：\n    - 细胞 A: $(0,0) \\to (8,0) \\to (16,0) \\to (24,0) \\to (32,0)$\n    - 细胞 B: $(0,0) \\to (6,4) \\to (12,8) \\to (18,12) \\to (24,16)$\n    - 细胞 C: $(0,0) \\to (8,1) \\to (16,2) \\to (24,3) \\to (32,4)$\n  - 处理组轨迹：\n    - 细胞 A: $(0,0) \\to (3,0) \\to (6,0) \\to (5,1) \\to (8,1)$\n    - 细胞 B: $(0,0) \\to (0,2) \\to (1,2) \\to (1,3) \\to (2,3)$\n    - 细胞 C: $(0,0) \\to (0,0) \\to (0,0) \\to (0,0) \\to (0,0)$\n\n- 测试用例 $4$ (速度增加但方向性降低；预期映射到类别 ID $4$)：\n  - 对照组轨迹：\n    - 细胞 A: $(0,0) \\to (6,0) \\to (12,0) \\to (18,0) \\to (24,0)$\n    - 细胞 B: $(0,0) \\to (4,4) \\to (8,8) \\to (12,12) \\to (16,16)$\n    - 细胞 C: $(0,0) \\to (6,1) \\to (12,2) \\to (18,3) \\to (24,4)$\n  - 处理组轨迹：\n    - 细胞 A: $(0,0) \\to (10,0) \\to (20,0) \\to (20,10) \\to (30,10)$\n    - 细胞 B: $(0,0) \\to (8,6) \\to (16,0) \\to (24,6) \\to (32,0)$\n    - 细胞 C: $(0,0) \\to (9,0) \\to (18,0) \\to (27,0) \\to (27,-9)$\n\n要求的计算和输出：\n- 对于每个测试用例，计算 $\\bar{v}_{\\mathrm{control}}$、$\\bar{v}_{\\mathrm{treated}}$（单位为微米/分钟），$\\bar{p}_{\\mathrm{control}}$、$\\bar{p}_{\\mathrm{treated}}$（无量纲），以及分数变化 $\\Delta v_{\\mathrm{frac}}$、$\\Delta p_{\\mathrm{frac}}$。\n- 根据上述规则集推断类别 ID。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为逗号分隔的列表并用方括号括起，其中每个测试用例的结果本身是一个列表，形式为 $[\\bar{v}_{\\mathrm{control}}, \\bar{v}_{\\mathrm{treated}}, \\bar{p}_{\\mathrm{control}}, \\bar{p}_{\\mathrm{treated}}, \\Delta v_{\\mathrm{frac}}, \\Delta p_{\\mathrm{frac}}, \\mathrm{class\\_id}]$。所有浮点值必须四舍五入到三位小数，并且最终打印的行不得包含任何额外文本。", "solution": "所述问题是有效的。这是一个定量细胞生物学中定义明确、具有科学依据的问题，需要分析细胞迁移轨迹。所有定义、参数和数据均已提供，逻辑结构自成体系且一致。未发现有关科学合理性、完整性或客观性的缺陷。我们将继续进行求解。\n\n任务是分析对照和处理条件下的二维细胞轨迹集合 $\\mathbf{r}(t) = (x(t), y(t))$，以量化运动性的变化并推断生物学机制。解决方案通过一个系统化、分步的计算过程来执行。\n\n首先，我们定义一个函数来计算单个细胞轨迹的基本运动指标。一条轨迹由 $N$ 个在均匀时间间隔 $\\Delta t$ 记录的位置向量 $\\mathbf{r}_1, \\mathbf{r}_2, \\ldots, \\mathbf{r}_N$ 给出。\n\n每个时间间隔的瞬时步长向量计算为 $\\Delta \\mathbf{r}_t = \\mathbf{r}_{t+1} - \\mathbf{r}_t$，其中 $t = 1, \\ldots, N-1$。相应的步长是其欧几里得范数，$\\ell_t = \\|\\Delta \\mathbf{r}_t\\|_2$。\n\n细胞的总路径长度 $L$ 是所有步长的总和：\n$$L = \\sum_{t=1}^{N-1} \\ell_t$$\n\n细胞的平均速度 $v$ 是瞬时速度的平均值。根据问题的定义和恒定的时间间隔 $\\Delta t = 1$，这可以简化为总路径长度除以总迁移持续时间：\n$$v = \\frac{1}{N-1}\\sum_{t=1}^{N-1} \\frac{\\ell_t}{\\Delta t} = \\frac{L}{(N-1)\\Delta t}$$\n\n净位移 $D$ 是连接轨迹起点和终点的向量的模：\n$$D = \\|\\mathbf{r}_N - \\mathbf{r}_1\\|_2$$\n\n方向性（或持久性）$p$ 是净位移与总路径长度之比。该指标量化了细胞路径的笔直程度，其中 $p=1$ 表示一条完美的直线。\n$$p = \\frac{D}{L}$$\n按照惯例，对于一个静止的细胞，其 $L=0$，位移 $D$ 也为 $0$，我们定义 $p=0$。\n\n其次，我们为每个实验条件（对照和处理）聚合这些指标。对于一个有 $M$ 个细胞的给定条件，平均速度 $\\bar{v}$ 和平均持久性 $\\bar{p}$ 是单个细胞指标的算术平均值：\n$$\\bar{v} = \\frac{1}{M} \\sum_{i=1}^{M} v_i, \\quad \\bar{p} = \\frac{1}{M} \\sum_{i=1}^{M} p_i$$\n\n第三，我们通过计算这些平均指标的分数变化来量化致畸剂暴露的影响。速度的分数变化 $\\Delta v_{\\mathrm{frac}}$ 和持久性的分数变化 $\\Delta p_{\\mathrm{frac}}$ 定义如下：\n$$\\Delta v_{\\mathrm{frac}} = \\frac{\\bar{v}_{\\mathrm{treated}} - \\bar{v}_{\\mathrm{control}}}{\\max(\\bar{v}_{\\mathrm{control}}, \\varepsilon)}, \\quad \\Delta p_{\\mathrm{frac}} = \\frac{\\bar{p}_{\\mathrm{treated}} - \\bar{p}_{\\mathrm{control}}}{\\max(\\bar{p}_{\\mathrm{control}}, \\varepsilon)}$$\n其中 $\\varepsilon = 10^{-9}$ 是一个小的正则化常数，以防止在计算工作中出现除以零的情况，这是一种必要的预防措施。\n\n最后，我们使用提供的确定性规则集对观察到的运动表型进行分类。该推理引擎将计算出的分数变化映射到一个特定的类别标识符，该标识符对应一个假设的初级分子靶点。该决策基于将 $\\Delta v_{\\mathrm{frac}}$ 和 $\\Delta p_{\\mathrm{frac}}$ 的绝对值或符号与给定的阈值 $\\theta_v = 0.2$ 和 $\\theta_p = 0.2$ 进行比较。\n\n- 如果 $|\\Delta v_{\\mathrm{frac}}|  0.2$ 且 $|\\Delta p_{\\mathrm{frac}}|  0.2$，则效果不显著（类别 ID $0$）。\n- 如果 $\\Delta v_{\\mathrm{frac}} \\le -0.2$ 且 $|\\Delta p_{\\mathrm{frac}}|  0.2$，则表明存在初级收缩功能缺陷（类别 ID $1$）。\n- 如果 $|\\Delta v_{\\mathrm{frac}}|  0.2$ 且 $\\Delta p_{\\mathrm{frac}} \\le -0.2$，则意味着引导或极性中断（类别 ID $2$）。\n- 如果 $\\Delta v_{\\mathrm{frac}} \\le -0.2$ 且 $\\Delta p_{\\mathrm{frac}} \\le -0.2$，则表明存在粘附或基质耦合缺陷（类别 ID $3$）。\n- 如果 $\\Delta v_{\\mathrm{frac}} \\ge 0.2$ 且 $\\Delta p_{\\mathrm{frac}} \\le -0.2$，则与高度突出表型一致（类别 ID $4$）。\n\n这个完整的计算流程针对每个测试用例进行实现。所有浮点结果均按要求四舍五入到三位小数。将提供一个使用 `numpy` 库进行高效向量和矩阵运算的 Python 脚本作为实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_single_trajectory_metrics(trajectory_points):\n    \"\"\"\n    Calculates speed and persistence for a single cell trajectory.\n    \n    Args:\n        trajectory_points (list): A list of (x, y) coordinate tuples.\n        \n    Returns:\n        tuple: (speed, persistence) for the trajectory.\n    \"\"\"\n    trajectory = np.array(trajectory_points, dtype=float)\n    \n    if trajectory.shape[0]  2:\n        return 0.0, 0.0\n\n    # Calculate step vectors and lengths\n    steps = np.diff(trajectory, axis=0)\n    step_lengths = np.linalg.norm(steps, axis=1)\n    \n    # Calculate path length (L)\n    path_length = np.sum(step_lengths)\n    \n    # Handle stationary cells\n    if path_length  1e-9:\n        return 0.0, 0.0\n        \n    # Calculate mean speed (v) with delta_t = 1\n    num_steps = trajectory.shape[0] - 1\n    speed = path_length / num_steps\n    \n    # Calculate net displacement (D)\n    displacement_vector = trajectory[-1] - trajectory[0]\n    net_displacement = np.linalg.norm(displacement_vector)\n    \n    # Calculate persistence (p)\n    persistence = net_displacement / path_length\n    \n    return speed, persistence\n\ndef analyze_condition(trajectories):\n    \"\"\"\n    Calculates average speed and persistence for a set of trajectories.\n    \n    Args:\n        trajectories (list): A list of individual cell trajectories.\n        \n    Returns:\n        tuple: (mean_speed, mean_persistence).\n    \"\"\"\n    if not trajectories:\n        return 0.0, 0.0\n        \n    speeds = []\n    persistences = []\n    \n    for traj in trajectories:\n        speed, persistence = calculate_single_trajectory_metrics(traj)\n        speeds.append(speed)\n        persistences.append(persistence)\n        \n    mean_speed = np.mean(speeds) if speeds else 0.0\n    mean_persistence = np.mean(persistences) if persistences else 0.0\n    \n    return mean_speed, mean_persistence\n\ndef infer_class(dv_frac, dp_frac, theta_v=0.2, theta_p=0.2):\n    \"\"\"\n    Infers the molecular target class based on fractional changes in motility.\n    \n    Args:\n        dv_frac (float): Fractional change in speed.\n        dp_frac (float): Fractional change in persistence.\n        theta_v (float): Threshold for speed change.\n        theta_p (float): Threshold for persistence change.\n        \n    Returns:\n        int: The inferred class ID.\n    \"\"\"\n    if abs(dv_frac)  theta_v and abs(dp_frac)  theta_p:\n        return 0\n    elif dv_frac = -theta_v and abs(dp_frac)  theta_p:\n        return 1\n    elif abs(dv_frac)  theta_v and dp_frac = -theta_p:\n        return 2\n    elif dv_frac = -theta_v and dp_frac = -theta_p:\n        return 3\n    elif dv_frac = theta_v and dp_frac = -theta_p:\n        return 4\n    else:\n        # This case is not defined in the problem's rule set.\n        # Assuming valid test cases will not fall here.\n        return -1 \n\ndef solve():\n    \"\"\"\n    Main function to run the analysis on all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        (\n            [ # Control\n                [(0,0), (10,0), (20,0), (30,0), (40,0), (50,0)],\n                [(0,0), (9,1), (19,1), (29,0), (39,-1), (49,-1)],\n                [(0,0), (7,7), (14,14), (21,21), (28,28), (35,35)],\n            ],\n            [ # Treated\n                [(0,0), (7,7), (14,0), (21,7), (28,0), (35,7)],\n                [(0,0), (10,0), (20,0), (20,10), (30,10), (30,0)],\n                [(0,0), (8,6), (16,0), (24,6), (32,0), (40,6)],\n            ]\n        ),\n        # Test case 2\n        (\n            [ # Control\n                [(0,0), (10,0), (20,0), (30,0), (40,0)],\n                [(0,0), (9,2), (18,4), (27,6), (36,8)],\n                [(0,0), (0,10), (0,20), (0,30), (0,40)],\n            ],\n            [ # Treated\n                [(0,0), (6,0), (12,0), (18,0), (24,0)],\n                [(0,0), (5,3), (10,6), (15,9), (20,12)],\n                [(0,0), (0,6), (0,12), (0,18), (0,24)],\n            ]\n        ),\n        # Test case 3\n        (\n            [ # Control\n                [(0,0), (8,0), (16,0), (24,0), (32,0)],\n                [(0,0), (6,4), (12,8), (18,12), (24,16)],\n                [(0,0), (8,1), (16,2), (24,3), (32,4)],\n            ],\n            [ # Treated\n                [(0,0), (3,0), (6,0), (5,1), (8,1)],\n                [(0,0), (0,2), (1,2), (1,3), (2,3)],\n                [(0,0), (0,0), (0,0), (0,0), (0,0)],\n            ]\n        ),\n        # Test case 4\n        (\n            [ # Control\n                [(0,0), (6,0), (12,0), (18,0), (24,0)],\n                [(0,0), (4,4), (8,8), (12,12), (16,16)],\n                [(0,0), (6,1), (12,2), (18,3), (24,4)],\n            ],\n            [ # Treated\n                [(0,0), (10,0), (20,0), (20,10), (30,10)],\n                [(0,0), (8,6), (16,0), (24,6), (32,0)],\n                [(0,0), (9,0), (18,0), (27,0), (27,-9)],\n            ]\n        )\n    ]\n    \n    results = []\n    epsilon = 1e-9\n\n    for control_trajs, treated_trajs in test_cases:\n        v_control, p_control = analyze_condition(control_trajs)\n        v_treated, p_treated = analyze_condition(treated_trajs)\n        \n        dv_frac = (v_treated - v_control) / max(v_control, epsilon)\n        dp_frac = (p_treated - p_control) / max(p_control, epsilon)\n        \n        class_id = infer_class(dv_frac, dp_frac)\n        \n        case_result = [\n            round(v_control, 3), round(v_treated, 3),\n            round(p_control, 3), round(p_treated, 3),\n            round(dv_frac, 3), round(dp_frac, 3),\n            class_id\n        ]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2679479"}]}