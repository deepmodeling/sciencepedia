{"hands_on_practices": [{"introduction": "异时性（Heterochrony）的本质是发育过程中时间（起始$t_{\\text{on}}$、终止$t_{\\text{off}}$）和速率（$k$）的改变。第一个练习将提供一个基础实践，帮助您将一个具体的发育情景分解为这些核心要素。通过分析一组关于两栖动物生长和成熟的假想数据，您将学习如何应用经典框架来准确分类例如“早熟”（progenesis）这样的异时性模式，这是解读比较发育数据的一项关键技能。[@problem_id:2641852]", "problem": "一个两栖动物谱系的比较数据集记录了一个体细胞性状（体长）的个体发育轨迹和首次繁殖年龄。对于祖先种群，设其成熟前的体细胞发育轨迹可由一个定义在 $t \\in [t_{\\mathrm{on,anc}}, t_{\\mathrm{off,anc}}]$ 上的分段平滑函数 $S_{\\mathrm{anc}}(t)$ 近似表示，其中 $t_{\\mathrm{on,anc}}$ 是性状发育的起始时间，$t_{\\mathrm{off,anc}}$ 与首次繁殖年龄 $t_{\\mathrm{m,anc}}$ 一致。对于后代种群，相应的量为 $S_{\\mathrm{desc}}(t)$、$t_{\\mathrm{on,desc}}$、$t_{\\mathrm{off,desc}}$ 和 $t_{\\mathrm{m,desc}}$。\n\n经验分析表明：\n- 在成熟前的时间段内，$S_{\\mathrm{anc}}(t)$ 和 $S_{\\mathrm{desc}}(t)$ 以相同的平均体细胞生长速率 $k$ 增长（即，对于 $t < t_{\\mathrm{m}}$，$\\mathrm{d}S_{\\mathrm{anc}}/\\mathrm{d}t \\approx k$ 且 $\\mathrm{d}S_{\\mathrm{desc}}/\\mathrm{d}t \\approx k$）。\n- 在测量误差范围内，起始时间无法区分，$t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$。\n- 后代种群更早达到性成熟，$t_{\\mathrm{m,desc}} < t_{\\mathrm{m,anc}}$，并且在两个种群中，性状生长都在 $t_{\\mathrm{off,desc}} \\approx t_{\\mathrm{m,desc}}$ 时停止（也就是说，体细胞生长在繁殖时有效终止）。\n\n使用将发育变化分解为目标性状的起始（$t_{\\mathrm{on}}$）、终止（$t_{\\mathrm{off}}$）和速率（$k$）三个轴的经典异时发生框架，对最能解释这些观察结果的异时发生形式进行分类，并通过指明哪些轴发生了变化以及变化方向来证明你的分类。\n\n选择唯一最佳选项：\n\nA. 幼态延续中的早熟：由于性成熟提前导致发育终止提前，即 $t_{\\mathrm{off,desc}} < t_{\\mathrm{off,anc}}$，$k_{\\mathrm{desc}} = k_{\\mathrm{anc}}$，且 $t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$；预测繁殖时 $S_{\\mathrm{desc}}(t_{\\mathrm{off,desc}})$ 相对于 $S_{\\mathrm{anc}}(t_{\\mathrm{off,anc}})$ 减小，并保留幼年体细胞特征。\n\nB. 幼态延续中的幼态发育：体细胞发育速率减慢，即 $k_{\\mathrm{desc}} < k_{\\mathrm{anc}}$，且 $t_{\\mathrm{off,desc}} \\approx t_{\\mathrm{off,anc}}$，$t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$；预测在相同繁殖年龄时，由于速率降低导致 $S$ 减小。\n\nC. 过形成中的超期发育：由于性成熟延迟导致发育终止推迟，即 $t_{\\mathrm{off,desc}} > t_{\\mathrm{off,anc}}$，$k_{\\mathrm{desc}} = k_{\\mathrm{anc}}$，$t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$；预测繁殖时 $S$ 增大。\n\nD. 过形成中的前移：体细胞发育起始提前，即 $t_{\\mathrm{on,desc}} < t_{\\mathrm{on,anc}}$，$k_{\\mathrm{desc}} = k_{\\mathrm{anc}}$，$t_{\\mathrm{off,desc}} \\approx t_{\\mathrm{off,anc}}$；预测在相同繁殖年龄时，由于繁殖前发育持续时间延长导致 $S$ 增大。", "solution": "在尝试解答之前，必须首先验证问题陈述的科学性和逻辑完整性。\n\n**步骤 1：提取已知条件**\n\n问题提供了关于一个祖先和一个后代两栖动物种群的以下信息：\n\n- **祖先种群：**\n    - 体细胞性状轨迹：$S_{\\mathrm{anc}}(t)$\n    - 发育起始：$t_{\\mathrm{on,anc}}$\n    - 发育终止：$t_{\\mathrm{off,anc}}$\n    - 首次繁殖年龄：$t_{\\mathrm{m,anc}}$\n    - 条件：$t_{\\mathrm{off,anc}} = t_{\\mathrm{m,anc}}$\n\n- **后代种群：**\n    - 体细胞性状轨迹：$S_{\\mathrm{desc}}(t)$\n    - 发育起始：$t_{\\mathrm{on,desc}}$\n    - 发育终止：$t_{\\mathrm{off,desc}}$\n    - 首次繁殖年龄：$t_{\\mathrm{m,desc}}$\n    - 条件：$t_{\\mathrm{off,desc}} \\approx t_{\\mathrm{m,desc}}$\n\n- **比较数据：**\n    1. 两个种群的平均体细胞生长速率 $k$ 大致相同：$\\mathrm{d}S_{\\mathrm{anc}}/\\mathrm{d}t \\approx k$ 且 $\\mathrm{d}S_{\\mathrm{desc}}/\\mathrm{d}t \\approx k$。这意味着 $k_{\\mathrm{anc}} \\approx k_{\\mathrm{desc}}$。\n    2. 起始时间大致相等：$t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$。\n    3. 后代种群更早成熟：$t_{\\mathrm{m,desc}} < t_{\\mathrm{m,anc}}$。\n\n任务是使用异时发生的框架来对这种演化变化进行分类，该框架分析三个发育参数的变化：起始时间（$t_{\\mathrm{on}}$）、终止时间（$t_{\\mathrm{off}}$）和发育速率（$k$）。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n该问题在科学上基于演化发育生物学中已确立的异时发生理论。参数（$t_{\\mathrm{on}}$、$t_{\\mathrm{off}}$、$k$）是该领域的标准参数。所描述的情景对于两栖动物是生物学上合理的。所有提供的信息都是自洽、一致且足以形成唯一解的。语言精确客观。没有违反科学原则、逻辑矛盾或含糊不清之处。\n\n**步骤 3：结论与行动**\n\n问题陈述有效。将推导解答。\n\n**解答推导**\n\n问题的核心是确定一个体细胞性状的发育参数从祖先到后代是如何变化的。我们根据给定信息分析异时发生的三个轴。\n\n1.  **发育速率（$k$）**：问题明确指出两个种群的平均体细胞生长速率相同。因此，速率没有变化：\n    $$k_{\\mathrm{desc}} \\approx k_{\\mathrm{anc}}$$\n\n2.  **发育起始（$t_{\\mathrm{on}}$）**：问题明确指出起始时间无法区分。因此，起始时间没有变化：\n    $$t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$$\n\n3.  **发育终止（$t_{\\mathrm{off}}$）**：问题将体细胞生长的终止与两个种群的性成熟年龄联系起来（$t_{\\mathrm{off}} \\approx t_{\\mathrm{m}}$）。已知后代种群比祖先种群更早达到性成熟：\n    $$t_{\\mathrm{m,desc}} < t_{\\mathrm{m,anc}}$$\n    从发育终止和性成熟的耦合关系可以直接得出，后代种群的体细胞生长终止也更早：\n    $$t_{\\mathrm{off,desc}} < t_{\\mathrm{off,anc}}$$\n\n**异时发生的分类**\n\n我们已经确定了以下变化：速率无变化，起始无变化，以及终止提前。现在我们必须对这种模式进行分类。\n\n根据后代成体形态与祖先个体发育的比较，异时发生大致分为两大类：\n- **幼态延续**：后代成体类似于祖先的幼年阶段。这发生在发育被截断或减慢时。\n- **过形成**：后代成体发育超越了祖先的成体形态。这发生在发育被延长或加速时。\n\n为了确定适用哪一类别，我们必须评估发育终止时的最终体细胞性状大小 $S$。假设如指定的线性近似，终止时的大小是初始大小 $S(t_{\\mathrm{on}})$、速率 $k$ 和生长时间 $(t_{\\mathrm{off}} - t_{\\mathrm{on}})$ 的函数。\n祖先在发育终止时的大小为：\n$$S_{\\mathrm{anc}}(t_{\\mathrm{off,anc}}) \\approx S(t_{\\mathrm{on,anc}}) + k_{\\mathrm{anc}} \\cdot (t_{\\mathrm{off,anc}} - t_{\\mathrm{on,anc}})$$\n后代在发育终止时的大小为：\n$$S_{\\mathrm{desc}}(t_{\\mathrm{off,desc}}) \\approx S(t_{\\mathrm{on,desc}}) + k_{\\mathrm{desc}} \\cdot (t_{\\mathrm{off,desc}} - t_{\\mathrm{on,desc}})$$\n鉴于 $k_{\\mathrm{desc}} \\approx k_{\\mathrm{anc}}$，$t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$，并假设初始大小相当，最终大小的差异由生长时间决定。由于 $t_{\\mathrm{off,desc}} < t_{\\mathrm{off,anc}}$，后代的生长时间更短：\n$$(t_{\\mathrm{off,desc}} - t_{\\mathrm{on,desc}}) < (t_{\\mathrm{off,anc}} - t_{\\mathrm{on,anc}})$$\n这导致后代的最终体细胞尺寸更小：\n$$S_{\\mathrm{desc}}(t_{\\mathrm{off,desc}}) < S_{\\mathrm{anc}}(t_{\\mathrm{off,anc}})$$\n后代成体比祖先成体小，在体型上类似于祖先的幼年（亚成体）阶段。根据定义，这属于**幼态延续**。\n\n接下来，我们必须确定幼态延续的具体机制。\n- **早熟**：通过提早停止体细胞发育实现的幼态延续，由性早熟引起。其特征性变化是发育终止提前（$t_{\\mathrm{off,desc}} < t_{\\mathrm{off,anc}}$），而速率或起始没有变化。\n- **幼态发育**：通过在相似发育时期内降低体细胞发育速率（$k_{\\mathrm{desc}} < k_{\\mathrm{anc}}$）实现的幼态延续。\n- **后移**：通过延迟体细胞发育起始（$t_{\\mathrm{on,desc}} > t_{\\mathrm{on,anc}}$）实现的幼态延续。\n\n我们推导出的变化——$t_{\\mathrm{on}}$ 无变化，$k$ 无变化，以及 $t_{\\mathrm{off}}$ 提前——完全符合**早熟**的定义。\n\n**逐项分析**\n\n- **A. 幼态延续中的早熟：由于性成熟提前导致发育终止提前，即 $t_{\\mathrm{off,desc}} < t_{\\mathrm{off,anc}}$，$k_{\\mathrm{desc}} = k_{\\mathrm{anc}}$，且 $t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$；预测繁殖时 $S_{\\mathrm{desc}}(t_{\\mathrm{off,desc}})$ 相对于 $S_{\\mathrm{anc}}(t_{\\mathrm{off,anc}})$ 减小，并保留幼年体细胞特征。**\n该选项正确地将结果识别为幼态延续，机制为早熟。它正确地列出了参数变化：终止提前（$t_{\\mathrm{off,desc}} < t_{\\mathrm{off,anc}}$）、速率相同（$k_{\\mathrm{desc}} = k_{\\mathrm{anc}}$）和起始相同（$t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$），所有这些都与我们的推导一致。它还正确预测了成体体型较小的形态学结果。这个描述完全正确。\n结论：**正确**。\n\n- **B. 幼态延续中的幼态发育：体细胞发育速率减慢，即 $k_{\\mathrm{desc}} < k_{\\mathrm{anc}}$，且 $t_{\\mathrm{off,desc}} \\approx t_{\\mathrm{off,anc}}$，$t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$；预测在相同繁殖年龄时，由于速率降低导致 $S$ 减小。**\n该选项提出了幼态发育，这要求发育速率减慢（$k_{\\mathrm{desc}} < k_{\\mathrm{anc}}$）。这与问题陈述中 $k_{\\mathrm{desc}} \\approx k_{\\mathrm{anc}}$ 相矛盾。它还错误地假设 $t_{\\mathrm{off,desc}} \\approx t_{\\mathrm{off,anc}}$，这与给定的提前成熟的条件相矛盾。\n结论：**错误**。\n\n- **C. 过形成中的超期发育：由于性成熟延迟导致发育终止推迟，即 $t_{\\mathrm{off,desc}} > t_{\\mathrm{off,anc}}$，$k_{\\mathrm{desc}} = k_{\\mathrm{anc}}$，$t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$；预测繁殖时 $S$ 增大。**\n该选项提出了过形成，这与观察到的幼态延续结果相反。它还假设发育终止推迟（$t_{\\mathrm{off,desc}} > t_{\\mathrm{off,anc}}$），这直接与条件 $t_{\\mathrm{m,desc}} < t_{\\mathrm{m,anc}}$ 相矛盾。\n结论：**错误**。\n\n- **D. 过形成中的前移：体细胞发育起始提前，即 $t_{\\mathrm{on,desc}} < t_{\\mathrm{on,anc}}$，$k_{\\mathrm{desc}} = k_{\\mathrm{anc}}$，$t_{\\mathrm{off,desc}} \\approx t_{\\mathrm{off,anc}}$；预测在相同繁殖年龄时，由于繁殖前发育持续时间延长导致 $S$ 增大。**\n该选项提出了过形成，再次与幼态延续的结果相矛盾。前移机制要求发育起始提前（$t_{\\mathrm{on,desc}} < t_{\\mathrm{on,anc}}$），这与给定的信息 $t_{\\mathrm{on,desc}} \\approx t_{\\mathrm{on,anc}}$ 相矛盾。\n结论：**错误**。\n\n唯一完全符合问题陈述和异时发生原理的选项是 A。", "answer": "$$\\boxed{A}$$", "id": "2641852"}, {"introduction": "除了速率或持续时间的简单变化，异时性常常表现为发育事件序列的重排。本实践将介绍一种称为“事件对分析”（event-pair analysis）的规范性定量方法，用于分析此类序列变化。通过将发育序列转化为成对顺序的矩阵，您可以计算出两个物种之间的“距离”，为严谨地衡量发育程序中的演化差异提供了途径。[@problem_id:2641815]", "problem": "在比较发育生物学中，保守的发育事件可以表示为有限标记事件集上的一个全序。考虑两个物种，每个物种都有四个相同的保守发育事件，标记为 $E_{1}, E_{2}, E_{3}, E_{4}$。在物种 $A$ 中，时间顺序为 $E_{1} < E_{2} < E_{3} < E_{4}$。在物种 $B$ 中，顺序为 $E_{2} < E_{1} < E_{3} < E_{4}$。\n\n你将使用事件对分析来形式化异时性（即发育时间上的变化），具体如下：\n\n- 对于每个 $i \\neq j$ 的无序对 $\\{i,j\\}$，定义物种 $X \\in \\{A,B\\}$ 中的事件对方向为\n$$\ns_{X}(i,j) =\n\\begin{cases}\n+1, & \\text{如果 } E_{i} \\text{ 在物种 } X \\text{ 中先于 } E_{j} \\text{ 发生}, \\\\\n-1, & \\text{如果 } E_{i} \\text{ 在物种 } X \\text{ 中后于 } E_{j} \\text{ 发生}。\n\\end{cases}\n$$\n\n- 定义事件对差异编码为\n$$\nd(i,j) \\equiv \\frac{1}{2}\\left| s_{A}(i,j) - s_{B}(i,j) \\right| \\in \\{0,1\\},\n$$\n使得如果 $E_i$ 和 $E_j$ 的相对顺序在两个物种中相同，则 $d(i,j) = 0$；如果相对顺序反转，则 $d(i,j) = 1$。\n\n- “事件翻转”是一种基本操作，它交换一个物种的按时间排序的列表中两个相邻事件的顺序。将每次事件翻转解释为单个异时性事件。\n\n任务：\n\n1. 为所有 $\\binom{4}{2}$ 个无序事件对构建事件对差异编码 $d(i,j)$。\n\n2. 仅使用上述定义，确定将物种 $A$ 的顺序转换为物种 $B$ 的顺序所需的最少事件翻转次数。\n\n最终答案仅报告最少的事件翻转次数，以纯数字形式表示，不带单位。无需四舍五入。", "solution": "该问题要求通过将发育事件的时间顺序形式化为排列来分析异时性。给定两个物种 $A$ 和 $B$ 以及一组四个保守事件 $\\{E_1, E_2, E_3, E_4\\}$。其时间顺序是这些事件的排列。\n\n在物种 $A$ 中，顺序为 $E_{1} < E_{2} < E_{3} < E_{4}$。这对应于索引的单位排列 $(1, 2, 3, 4)$。\n在物种 $B$ 中，顺序为 $E_{2} < E_{1} < E_{3} < E_{4}$。这对应于排列 $(2, 1, 3, 4)$。\n\n第一个任务是为所有 $\\binom{4}{2} = 6$ 个无序事件对构建事件对差异编码 $d(i,j)$，其中 $\\{i,j\\} \\subset \\{1, 2, 3, 4\\}$ 且 $i \\neq j$。$d(i,j)$ 的定义由 $d(i,j) \\equiv \\frac{1}{2}\\left| s_{A}(i,j) - s_{B}(i,j) \\right|$ 给出。我们必须首先计算事件对方向 $s_{X}(i,j)$。对于每一对，我们不失一般性地取 $i<j$。\n\n1.  对 $\\{1,2\\}$:\n    在物种 $A$ 中，$E_1$ 先于 $E_2$，所以 $s_A(1,2) = +1$。\n    在物种 $B$ 中，$E_2$ 先于 $E_1$，所以 $E_1$ 后于 $E_2$，这意味着 $s_B(1,2) = -1$。\n    差异编码为 $d(1,2) = \\frac{1}{2}|(+1) - (-1)| = \\frac{1}{2}|2| = 1$。\n\n2.  对 $\\{1,3\\}$:\n    在物种 $A$ 中，$E_1$ 先于 $E_3$，所以 $s_A(1,3) = +1$。\n    在物种 $B$ 中，$E_1$ 先于 $E_3$，所以 $s_B(1,3) = +1$。\n    差异编码为 $d(1,3) = \\frac{1}{2}|(+1) - (+1)| = \\frac{1}{2}|0| = 0$。\n\n3.  对 $\\{1,4\\}$:\n    在物种 $A$ 中，$E_1$ 先于 $E_4$，所以 $s_A(1,4) = +1$。\n    在物种 $B$ 中，$E_1$ 先于 $E_4$，所以 $s_B(1,4) = +1$。\n    差异编码为 $d(1,4) = \\frac{1}{2}|(+1) - (+1)| = \\frac{1}{2}|0| = 0$。\n\n4.  对 $\\{2,3\\}$:\n    在物种 $A$ 中，$E_2$ 先于 $E_3$，所以 $s_A(2,3) = +1$。\n    在物种 $B$ 中，$E_2$ 先于 $E_3$，所以 $s_B(2,3) = +1$。\n    差异编码为 $d(2,3) = \\frac{1}{2}|(+1) - (+1)| = \\frac{1}{2}|0| = 0$。\n\n5.  对 $\\{2,4\\}$:\n    在物种 $A$ 中，$E_2$ 先于 $E_4$，所以 $s_A(2,4) = +1$。\n    在物种 $B$ 中，$E_2$ 先于 $E_4$，所以 $s_B(2,4) = +1$。\n    差异编码为 $d(2,4) = \\frac{1}{2}|(+1) - (+1)| = \\frac{1}{2}|0| = 0$。\n\n6.  对 $\\{3,4\\}$:\n    在物种 $A$ 中，$E_3$ 先于 $E_4$，所以 $s_A(3,4) = +1$。\n    在物种 $B$ 中，$E_3$ 先于 $E_4$，所以 $s_B(3,4) = +1$。\n    差异编码为 $d(3,4) = \\frac{1}{2}|(+1) - (+1)| = \\frac{1}{2}|0| = 0$。\n\n这就完成了第一个任务。唯一的非零差异编码是 $d(1,2) = 1$，这表明事件 $E_1$ 和 $E_2$ 的相对顺序在两个物种之间是反转的。所有其他事件对都保持其相对顺序。\n\n第二个任务是确定将物种 $A$ 的顺序转换为物种 $B$ 的顺序所需的最少“事件翻转”次数。事件翻转定义为序列中两个相邻事件的交换。这是一个组合数学中的标准问题，即求将一个排列转换为另一个排列所需的最少相邻交换次数。\n\n这个最小次数恰好是一个排列相对于另一个排列的逆序数。一个逆序对是指在两个排列中顺序相反的一对元素。事件对差异编码 $d(i,j)$ 的构造恰好是这种逆序的指示符：如果 $\\{E_i, E_j\\}$ 对的顺序反转，则 $d(i,j)=1$，否则为 $d(i,j)=0$。\n\n因此，逆序对的总数是所有不同对 $\\{i,j\\}$ 的 $d(i,j)$ 之和。\n$$ \\text{逆序数} = \\sum_{1 \\le i < j \\le 4} d(i,j) $$\n使用第一个任务的结果：\n$$ \\sum_{1 \\le i < j \\le 4} d(i,j) = d(1,2) + d(1,3) + d(1,4) + d(2,3) + d(2,4) + d(3,4) $$\n$$ = 1 + 0 + 0 + 0 + 0 + 0 = 1 $$\n因此，所需的最少相邻交换次数为 $1$。\n\n我们可以直接验证这一点。物种 $A$ 的序列是 $(E_1, E_2, E_3, E_4)$。物种 $B$ 的目标序列是 $(E_2, E_1, E_3, E_4)$。通过交换前两个相邻事件 $E_1$ 和 $E_2$，我们得到：\n$$ (E_1, E_2, E_3, E_4) \\xrightarrow{\\text{交换}(E_1, E_2)} (E_2, E_1, E_3, E_4) $$\n这个单一操作就将物种 $A$ 的序列转换为了物种 $B$ 的序列。由于序列不相同，至少需要一次交换，因此所需的最少事件翻转次数恰好是 $1$。", "answer": "$$\\boxed{1}$$", "id": "2641815"}, {"introduction": "异时性变化并非随机发生，它们出现在特定的系统发育背景下，其速率在不同演化支系中可能存在差异。这个高级实践将异时性与系统发育学和统计模型相结合，让您接触该领域的前沿方法。您将利用映射到系统发育树上的事件对数据，来检验一个具体的演化假说：异时性变化的爆发是否集中在某个特定分支上，这将使您从描述模式转向检验产生这些模式的过程。[@problem_id:2641849]", "problem": "一个包含四个物种的支系已经发表了其四个同源事件（$E_{1}$、$E_{2}$、$E_{3}$ 和 $E_{4}$）的颅骨骨化序列。这些序列记录了物种内部首次骨化的发育顺序。一个外群 $O$ 用于极化祖先性状状态。有根系统发育树是平衡的，包含两个姐妹亚支 $\\{A,B\\}$ 和 $\\{C,D\\}$，并具有以下以百万年（Myr）为单位的分支长度：从根到 $\\{A,B\\}$ 祖先的主干分支长度为 $10$ Myr，从根到 $\\{C,D\\}$ 祖先的主干分支长度为 $10$ Myr，每个到 $A$、$B$、$C$和$D$的末端分支长度为 $5$ Myr。假设外群分支仅用于极化性状状态，不参与速率分析。\n\n观测到的骨化顺序（从最早到最晚）为：\n- $O$: $E_{1} \\prec E_{2} \\prec E_{3} \\prec E_{4}$，\n- $A$: $E_{1} \\prec E_{2} \\prec E_{3} \\prec E_{4}$，\n- $B$: $E_{1} \\prec E_{2} \\prec E_{3} \\prec E_{4}$，\n- $C$: $E_{1} \\prec E_{3} \\prec E_{4} \\prec E_{2}$，\n- $D$: $E_{1} \\prec E_{3} \\prec E_{4} \\prec E_{2}$，\n\n其中 $X \\prec Y$ 表示 $X$ 在 $Y$ 之前骨化。\n\n事件对简约法将每个 $i<j$ 的无序对 $(E_{i},E_{j})$ 编码为一个二态性状，表示 $E_{i}$ 是否先于 $E_{j}$。该二态性状沿某一分支的变化对应于该分支上 $E_{i}$ 和 $E_{j}$ 相对顺序的一次倒置。假设以下建模前提：\n- 对于每个事件对，变化是沿分支独立发生的事件。\n- 在分支时长给定的条件下，一个分支上的倒置次数服从泊松过程，其速率与时间成正比。\n\n任务：\n1. 使用事件对简约法和外群来极化状态，重建内群树每个分支上事件对倒置的最小次数，并找出具有最大倒置次数的分支。\n2. 考虑两个用于描述各分支上倒置计数的嵌套模型：\n   - 模型 $\\mathcal{M}_{0}$（均一全局速率）：单一速率 $\\lambda$（每百万年）适用于所有分支。\n   - 模型 $\\mathcal{M}_{1}$（集中爆发）：一个指定分支 $b^{\\ast}$ 拥有其自身的速率 $\\lambda_{b}$，而所有其他分支共享一个共同的背景速率 $\\lambda_{\\mathrm{bg}}$。\n   两种模型均假设各分支之间以及各事件对之间相互独立。\n3. 计算对数似然比检验统计量 $\\Lambda = 2\\left[\\ln L(\\widehat{\\theta}_{1}\\mid \\mathcal{M}_{1}) - \\ln L(\\widehat{\\theta}_{0}\\mid \\mathcal{M}_{0})\\right]$，其中 $\\widehat{\\theta}_{0}$ 和 $\\widehat{\\theta}_{1}$ 分别表示在 $\\mathcal{M}_{0}$ 和 $\\mathcal{M}_{1}$ 模型下的最大似然估计值。令 $b^{\\ast}$ 为任务1中确定的分支。以包含 $\\ln$ 的闭式表达式报告 $\\Lambda$ 的精确值。无需单位。\n\n注：您必须从第一性原理推导所使用的任何估计量。不要假设任何现成的公式。最终答案必须是单一的闭式表达式。如果您选择提供数值近似值，请四舍五入到四位有效数字，但首选精确形式。", "solution": "该问题被认为是有效的。其科学基础在于演化发育生物学领域，具体使用了系统发育比较分析方法，如简约法和最大似然法。问题陈述清晰，提供了推导唯一、有意义解所需的所有必要定义、数据和约束。\n\n求解过程如下。首先，我们必须按照指定，使用事件对简约法确定具有最大演化变化数的分支。其次，我们将为两个嵌套统计模型 $\\mathcal{M}_{0}$ 和 $\\mathcal{M}_{1}$ 的参数推导最大似然估计量。第三，我们将使用这些估计值计算两个模型的最大化对数似然，并随后计算对数似然比检验统计量。\n\n**任务1：简约法重建**\n\n同源事件集为 {$E_{1}$、$E_{2}$、$E_{3}$、$E_{4}$}。$i < j$ 的唯一无序事件对 $(E_i, E_j)$ 的数量为 $\\binom{4}{2} = 6$。这些对是 $(E_1, E_2)$、$(E_1, E_3)$、$(E_1, E_4)$、$(E_2, E_3)$、$(E_2, E_4)$ 和 $(E_3, E_4)$。每一对构成一个二态性状，其中状态 $0$ 代表顺序 $E_i \\prec E_j$，状态 $1$ 代表倒置顺序 $E_j \\prec E_i$。\n\n外群序列 $O$ 为 $E_{1} \\prec E_{2} \\prec E_{3} \\prec E_{4}$，这意味着对于所有 $6$ 个性状，内群树根节点的祖先状态均为 $0$。\n内群物种的序列为：\n- $A, B$：$E_{1} \\prec E_{2} \\prec E_{3} \\prec E_{4}$。所有 $6$ 个性状的状态均为 $0$。\n- $C, D$：$E_{1} \\prec E_{3} \\prec E_{4} \\prec E_{2}$。我们为每一对编码状态：\n    - $(E_1, E_2)$: $E_1 \\prec E_2 \\implies$ 状态 $0$。\n    - $(E_1, E_3)$: $E_1 \\prec E_3 \\implies$ 状态 $0$。\n    - $(E_1, E_4)$: $E_1 \\prec E_4 \\implies$ 状态 $0$。\n    - $(E_2, E_3)$: $E_3 \\prec E_2 \\implies$ 状态 $1$。\n    - $(E_2, E_4)$: $E_4 \\prec E_2 \\implies$ 状态 $1$。\n    - $(E_3, E_4)$: $E_3 \\prec E_4 \\implies$ 状态 $0$。\n物种 $C$ 和 $D$ 的性状状态向量为 $(0, 0, 0, 1, 1, 0)$。\n\n我们将 Fitch 简约法算法应用于系统发育树 $( (A,B), (C,D) )$ 上的每一个性状（共 $6$ 个）。\n- 对于性状 $(E_1, E_2)$、$(E_1, E_3)$、$(E_1, E_4)$ 和 $(E_3, E_4)$，根节点和所有末端分类单元的状态都为 $0$。因此，这些性状在所有分支上的最小倒置次数为 $0$。\n- 对于性状 $(E_2, E_3)$，状态为：根节点=$0$，$A=0$，$B=0$，$C=1$，$D=1$。根据简约法，$\\{A,B\\}$ 的祖先节点被赋予状态 $0$，而 $\\{C,D\\}$ 的祖先节点被赋予状态 $1$。这种配置要求在通往 $\\{C,D\\}$ 支系的主干分支上发生一次变化（$0 \\to 1$）。不需要其他变化。\n- 对于性状 $(E_2, E_4)$，状态分布与 $(E_2, E_3)$ 相同。同样，在通往 $\\{C,D\\}$ 支系的主干分支上推断出一次变化。\n\n将每个分支上所有 $6$ 个性状的最小倒置次数相加，我们得到：\n- 通往 $\\{A,B\\}$ 的主干分支（记作 $b_{AB}$）：$0$ 次倒置。\n- 通往 $\\{C,D\\}$ 的主干分支（记作 $b_{CD}$）：$1+1=2$ 次倒置。\n- 通往 $A, B, C, D$ 的末端分支：各 $0$ 次倒置。\n推断出的倒置次数最多的分支是 $b_{CD}$。该分支将在后续分析中被指定为 $b^{\\ast}$。此分支上观测到的倒置计数为 $k_{b^{\\ast}} = 2$。对于所有其他分支 $b \\neq b^{\\ast}$，计数为 $k_b = 0$。\n\n**任务2和3：似然比检验**\n\n在一个时长为 $t_b$ 的分支 $b$ 上的倒置次数 $K_b$ 被建模为一个泊松分布的随机变量。鉴于有 $N_{pairs}=6$ 个独立的事件对，每个事件对的倒置速率为 $\\lambda$ 每百万年，一个分支上的总倒置次数为 $K_b \\sim \\text{Poisson}(N_{pairs}\\lambda t_b)$。数据是分支长度（$t_{AB}=10$，$t_{CD}=10$，$t_A=t_B=t_C=t_D=5$ Myr）和相应的倒置计数（$k_{CD}=2$，所有其他 $k_b=0$）。\n\n**模型 $\\mathcal{M}_{0}$（均一全局速率）**\n单一速率 $\\lambda$ 适用于所有分支。对数似然函数为：\n$$ \\ln L(\\lambda \\mid \\{k_b\\}) = \\sum_{b} \\left( k_b \\ln(N_{pairs}\\lambda t_b) - N_{pairs}\\lambda t_b - \\ln(k_b!) \\right) $$\n为了找到最大似然估计（MLE）$\\hat{\\lambda}$，我们求解 $\\frac{d \\ln L}{d\\lambda} = 0$：\n$$ \\frac{d \\ln L}{d\\lambda} = \\sum_{b} \\left( \\frac{k_b}{\\lambda} - N_{pairs}t_b \\right) = \\frac{1}{\\lambda}\\sum_b k_b - N_{pairs}\\sum_b t_b = 0 $$\n$$ \\hat{\\lambda} = \\frac{\\sum_b k_b}{N_{pairs}\\sum_b t_b} = \\frac{2}{6 \\times (10+10+5+5+5+5)} = \\frac{2}{6 \\times 40} = \\frac{1}{120} $$\n将 $\\hat{\\lambda}$ 代回对数似然函数即可得到最大化对数似然 $\\ln L(\\widehat{\\theta}_{0})$。总倒置次数为 $\\sum_b k_b = 2$，总分支时长为 $\\sum_b t_b = 40$ Myr。\n$$ \\ln L(\\widehat{\\theta}_{0}) = \\sum_b \\left( k_b \\ln(N_{pairs}\\hat{\\lambda} t_b) - N_{pairs}\\hat{\\lambda} t_b - \\ln(k_b!) \\right) $$\n注意到 $N_{pairs}\\hat{\\lambda} = \\frac{\\sum k_b}{\\sum t_b} = \\frac{2}{40} = \\frac{1}{20}$：\n$$ \\ln L(\\widehat{\\theta}_{0}) = \\left( 2\\ln\\left(\\frac{1}{20} \\cdot 10\\right) - \\frac{1}{20}\\cdot 10 - \\ln(2!) \\right) + \\sum_{b\\neq CD} \\left( 0 - \\frac{1}{20}t_b - \\ln(0!) \\right) $$\n$$ \\ln L(\\widehat{\\theta}_{0}) = \\left( 2\\ln\\left(\\frac{1}{2}\\right) - \\frac{1}{2} - \\ln(2) \\right) - \\frac{1}{20}\\sum_{b\\neq CD} t_b $$\n其他分支长度之和为 $40-10=30$ Myr。\n$$ \\ln L(\\widehat{\\theta}_{0}) = \\left( -2\\ln(2) - \\frac{1}{2} - \\ln(2) \\right) - \\frac{30}{20} = -3\\ln(2) - \\frac{1}{2} - \\frac{3}{2} = -3\\ln(2) - 2 $$\n\n**模型 $\\mathcal{M}_{1}$（集中爆发）**\n该模型有两个速率：$b^{\\ast}=b_{CD}$ 的速率 $\\lambda_b$ 和所有其他分支的速率 $\\lambda_{\\mathrm{bg}}$。对数似然是可分的：\n$$ \\ln L(\\lambda_b, \\lambda_{\\mathrm{bg}}) = \\left(k_{b^{\\ast}} \\ln(N_{pairs}\\lambda_b t_{b^{\\ast}}) - N_{pairs}\\lambda_b t_{b^{\\ast}} - \\ln(k_{b^{\\ast}}!)\\right) + \\sum_{b \\neq b^{\\ast}} \\left(k_b \\ln(N_{pairs}\\lambda_{\\mathrm{bg}} t_b) - N_{pairs}\\lambda_{\\mathrm{bg}} t_b - \\ln(k_b!)\\right) $$\n我们独立地为每个部分找到最大似然估计。\n对于 $b^{\\ast}=b_{CD}$：$\\hat{\\lambda}_b = \\frac{k_{b^{\\ast}}}{N_{pairs}t_{b^{\\ast}}} = \\frac{2}{6 \\times 10} = \\frac{1}{30}$。期望计数为 $\\hat{E}_{b^{\\ast}} = N_{pairs}\\hat{\\lambda}_b t_{b^{\\ast}} = 2 = k_{b^{\\ast}}$。\n该分支的最大化对数似然为：\n$$ \\ln L(\\hat{\\lambda}_b) = k_{b^{\\ast}}\\ln(k_{b^{\\ast}}) - k_{b^{\\ast}} - \\ln(k_{b^{\\ast}}!) = 2\\ln(2) - 2 - \\ln(2!) = 2\\ln(2) - 2 - \\ln(2) = \\ln(2) - 2 $$\n对于背景分支，$\\sum_{b \\neq b^{\\ast}} k_b = 0$。最大似然估计为 $\\hat{\\lambda}_{\\mathrm{bg}} = 0$。则对数似然为：\n$$ \\ln L(\\hat{\\lambda}_{\\mathrm{bg}}) = \\sum_{b \\neq b^{\\ast}} \\left(0 \\cdot \\ln(0) - 0 - \\ln(0!)\\right) = 0 $$\n这里我们使用约定 $0\\ln(0)=0$。\n$\\mathcal{M}_1$ 的总最大化对数似然为 $\\ln L(\\widehat{\\theta}_{1}) = (\\ln(2) - 2) + 0 = \\ln(2) - 2$。\n\n**对数似然比统计量**\n检验统计量 $\\Lambda$ 为：\n$$ \\Lambda = 2\\left[\\ln L(\\widehat{\\theta}_{1}) - \\ln L(\\widehat{\\theta}_{0})\\right] $$\n$$ \\Lambda = 2\\left[ (\\ln(2) - 2) - (-3\\ln(2) - 2) \\right] $$\n$$ \\Lambda = 2\\left[ \\ln(2) - 2 + 3\\ln(2) + 2 \\right] $$\n$$ \\Lambda = 2\\left[ 4\\ln(2) \\right] = 8\\ln(2) $$\n这是该统计量的最终闭式表达式。", "answer": "$$\\boxed{8\\ln(2)}$$", "id": "2641849"}]}