{"hands_on_practices": [{"introduction": "保守的转录因子（TF）面临的一个关键挑战是在浩瀚的基因组中定位其特异性靶位点。本练习使用生物信息学中的常用工具——位置权重矩阵（PWM）来模拟转录因子的结合特异性[@problem_id:2680490]。通过这项实践，您将量化随机出现的“伪”结合位点的期望数量，从而更深入地理解基因调控中的“信噪比”问题以及塑造增强子结构的进化压力。", "problem": "Pax6（配对盒基因6）是一种在动物发育中深度保守的转录因子（TF），其DNA识别通常使用位置权重矩阵（PWM）进行建模。考虑一个简化的、用于教学目的Pax6 PWM，其长度为$m=8$个位置。在每个位置$i \\in \\{1,\\dots,8\\}$，该PWM为一个指定的共有碱基（选择共有序列为$W=\\text{ACGTACGT}$）分配概率$0.7$，并为其余三种非共有碱基各分配概率$0.1$。基因组背景模型是独立同分布（i.i.d.）的，核苷酸频率为$q_{A}=q_{C}=q_{G}=q_{T}=0.25$。一个长度为$8$的序列$s=s_{1}\\dots s_{8}$的对数似然比分数（单位为比特）为\n$$\nS(s) \\;=\\; \\sum_{i=1}^{8} \\log_{2}\\!\\left(\\frac{p_{i,s_{i}}}{q_{s_{i}}}\\right),\n$$\n其中$p_{i,b}$是位置$i$上碱基$b$的PWM概率，$q_{b}$是碱基$b$的背景概率。如果一个序列的$S(s)\\geq T$（阈值$T=4$比特），则称该序列为一个匹配（hit）。您使用一个核苷酸的步长扫描一个长度为$L=1{,}000{,}000$碱基对的连续基因组片段的双链。\n\n仅使用上述定义、独立同分布背景模型和标准概率原理，推导并计算此次扫描将报告的伪匹配（即，由背景生成且得分至少为$T$的序列）的期望数量。将最终数值答案四舍五入至四位有效数字。以纯数字形式表示答案（无单位）。\n\n最后，从发育基因调控的角度简要论证，为什么伪匹配的期望数量对于理解增强子在Pax6等保守转录因子约束下的进化至关重要。", "solution": "该问题要求计算在扫描一个大的基因组片段时，一个简化的Pax6结合位点位置权重矩阵（PWM）模型的伪匹配期望数量。伪匹配被定义为由基因组背景模型生成，但其对数似然比分数却达到或超过给定阈值的序列。该问题还要求对这个数字的重要性给出生物学上的论证。\n\n首先，我们必须确定单个核苷酸的分数值。位置$i$上碱基$b$的对数似然比分数为$S_{i,b} = \\log_{2}(p_{i,b}/q_{b})$。背景概率是均一的，即$q_{A}=q_{C}=q_{G}=q_{T}=0.25$。PWM概率仅取决于一个碱基是否是该位置的共有碱基。设$W = \\text{ACGTACGT}$为共有序列。\n\n在任意位置$i \\in \\{1, \\dots, 8\\}$，如果碱基$s_i$是共有碱基（$s_i = W_i$），其概率为$p_{i,s_i} = 0.7$。共有碱基匹配的分数（我们记为$S_C$）为：\n$$S_C = \\log_{2}\\left(\\frac{0.7}{0.25}\\right) = \\log_{2}(2.8)$$\n如果碱基$s_i$是非共有碱基，其概率为$p_{i,s_i} = 0.1$。非共有碱基的分数（$S_N$）为：\n$$S_N = \\log_{2}\\left(\\frac{0.1}{0.25}\\right) = \\log_{2}(0.4)$$\n\n长度为$m = 8$的序列$s$的总分$S(s)$是各个位置分数的总和。由于分数$S_C$和$S_N$在所有位置上都是恒定的，总分仅取决于与共有序列$W$匹配的位置数量$k$。其余的$8-k$个位置将是非共有碱基。一个有$k$个共有匹配的序列的总分为：\n$$S(k) = k \\cdot S_C + (8-k) \\cdot S_N = k \\cdot \\log_{2}(2.8) + (8-k) \\cdot \\log_{2}(0.4)$$\n如果一个序列的分数$S(s)$大于或等于阈值$T=4$比特，则该序列被视为一个“匹配”。我们需要找到满足此条件的最小整数值$k$。\n$$k \\cdot \\log_{2}(2.8) + (8-k) \\cdot \\log_{2}(0.4) \\geq 4$$\n整理不等式以求解$k$：\n$$k \\cdot (\\log_{2}(2.8) - \\log_{2}(0.4)) \\geq 4 - 8 \\cdot \\log_{2}(0.4)$$\n$$k \\cdot \\log_{2}\\left(\\frac{2.8}{0.4}\\right) \\geq 4 - 8 \\cdot \\log_{2}(0.4)$$\n$$k \\cdot \\log_{2}(7) \\geq 4 - 8 \\cdot \\log_{2}(0.4)$$\n$$k \\geq \\frac{4 - 8 \\cdot \\log_{2}(0.4)}{\\log_{2}(7)}$$\n代入近似值$\\log_{2}(7) \\approx 2.80735$和$\\log_{2}(0.4) \\approx -1.32193$：\n$$k \\geq \\frac{4 - 8(-1.32193)}{2.80735} \\approx \\frac{4 + 10.57544}{2.80735} \\approx \\frac{14.57544}{2.80735} \\approx 5.192$$\n由于$k$必须是整数，因此成为一个匹配所需的最小共有匹配数为$k_{\\text{min}} = 6$。因此，如果一个序列与共有序列$W$有$k=6$、$k=7$或$k=8$个匹配，则它是一个匹配。\n\n接下来，我们计算从背景模型中随机生成的8-mer成为一个匹配的概率$P(\\text{hit})$。在独立同分布的背景模型中，每个核苷酸的概率为$0.25$。因此，在一个给定位置上随机选择的核苷酸与该位置的共有碱基匹配的概率为$p_{match} = 0.25$。一个8-mer中的匹配数$k$服从参数为$n=8$和$p=0.25$的二项分布。\n$$P(k) = \\binom{8}{k} (0.25)^k (1-0.25)^{8-k} = \\binom{8}{k} (0.25)^k (0.75)^{8-k}$$\n一个匹配的概率是$k=6$、$k=7$和$k=8$的概率之和：\n$$P(\\text{hit}) = P(k=6) + P(k=7) + P(k=8)$$\n$$P(k=6) = \\binom{8}{6} (0.25)^6 (0.75)^2 = 28 \\cdot \\left(\\frac{1}{4}\\right)^6 \\left(\\frac{3}{4}\\right)^2 = 28 \\cdot \\frac{9}{4^8} = \\frac{252}{65536}$$\n$$P(k=7) = \\binom{8}{7} (0.25)^7 (0.75)^1 = 8 \\cdot \\left(\\frac{1}{4}\\right)^7 \\left(\\frac{3}{4}\\right)^1 = 8 \\cdot \\frac{3}{4^8} = \\frac{24}{65536}$$\n$$P(k=8) = \\binom{8}{8} (0.25)^8 (0.75)^0 = 1 \\cdot \\left(\\frac{1}{4}\\right)^8 = \\frac{1}{65536}$$\n将这些概率相加：\n$$P(\\text{hit}) = \\frac{252 + 24 + 1}{65536} = \\frac{277}{65536}$$\n\n现在，我们计算伪匹配的期望数量。扫描是在一个长度为$L=1,000,000$ bp的连续基因组的双链上进行的，步长为一个核苷酸。单链上的8-mer窗口数量为$N_{windows.strand} = L - m + 1 = 1,000,000 - 8 + 1 = 999,993$。由于扫描了双链，窗口总数为$N_{total} = 2 \\cdot N_{windows.strand} = 2 \\cdot 999,993 = 1,999,986$。\n\n根据期望的线性性质，匹配的期望数量$E[\\text{hits}]$是窗口总数乘以单个窗口成为匹配的概率。\n$$E[\\text{hits}] = N_{total} \\cdot P(\\text{hit}) = 1,999,986 \\cdot \\frac{277}{65536}$$\n$$E[\\text{hits}] = \\frac{553,996,122}{65536} \\approx 8453.2849$$\n问题要求将答案四舍五入至四位有效数字。\n$$E[\\text{hits}] \\approx 8453$$\n\n最后，我们讨论其生物学意义。伪匹配的高期望数量（在一个仅有一兆碱基的区域内就有大约$8453$个）凸显了发育基因调控中一个根本性的“信噪比”问题。基因组中充满了偶然匹配转录因子（TF）结合谱的低亲和力序列。为了实现像Pax6这类保守TF的稳健而精确的调控，增强子内的功能性结合位点必须能够与这个庞大的伪位点背景区分开来。这种选择压力驱动了多种机制的进化，以增强结合特异性和调控的可靠性。这些机制包括：（1）真正的结合位点进化出比“匹配”的最低阈值高得多的亲和力（因此分数也更高）；（2）多个TF结合位点在顺式调控模块（增强子）内聚集，通过协同结合极大地增加了对目标区域的整体亲合力（avidity）和特异性，从而有效滤除孤立的、低亲和力的伪位点；（3）将功能位点定位于开放的染色质区域内，这可以防止TF与可能深埋在抑制性异染色质中的伪位点结合。大量潜在的低亲和力位点也为进化提供了原材料，因为少数突变就可以创建或破坏结合位点，从而在保守TF工具箱的约束下，促进了增强子结构和功能的快速进化。", "answer": "$$\\boxed{8453}$$", "id": "2680490"}, {"introduction": "在理解了寻找结合位点的挑战之后，我们现在关注功能性位点内部序列的重要性。本练习将演示如何定量预测单个核苷酸突变对基因表达的功能性后果[@problem_id:2680422]。通过将PWM分值的变化与结合亲和力（$K_a$）以及最终与协同的希尔（Hill）响应曲线的输出联系起来，您将构建一个强大的分析框架，用于理解顺式调控元件的变异如何影响发育过程。", "problem": "一个脊椎动物发育基因中的保守增强子依赖于一个转录因子（TF）的单一高信息量结合位点。该位点由一个位置权重矩阵（PWM）建模，其PWM分数是通过相对于均匀背景的自然对数对数优势比方案计算的。具体来说，对于长度为 $L$ 的序列，其对数优势比分数 $S$ 为\n$$\nS \\;=\\; \\sum_{i=1}^{L} \\ln\\!\\left(\\frac{p_i(b_i)}{q(b_i)}\\right),\n$$\n其中 $p_i(b)$ 是在位置 $i$ 处碱基 $b$ 的PWM概率，而 $q(b)$ 是背景概率。假设背景是均匀的，即 $q(A)=q(C)=q(G)=q(T)=0.25$。逐位独立近似成立，且野生型和突变型之间除了一个位置外，所有其他位置都相同。\n\n在结合位点的一个单一位置 $i^{\\ast}$ 处发生了一个单核苷酸替换。在此位置，野生型碱基的PWM概率为 $p_{i^{\\ast}}(b_{\\mathrm{wt}})=0.60$，而突变型碱基的PWM概率为 $p_{i^{\\ast}}(b_{\\mathrm{mut}})=0.15$。所有其他位置保持不变。在标准假设下，即转录因子与该位点结合的平衡结合常数 $K_{a}$ 与相对于背景的PWM似然比成正比，突变型与野生型之间的结合常数之比等于它们各自的似然比之比。\n\n该结合位点输入到一个表现出协同Hill响应的增强子，其Hill系数为 $n=2$，因此分数激活（相对于最大输出）为\n$$\n\\frac{E}{E_{\\max}} \\;=\\; \\frac{x^{n}}{1+x^{n}},\n$$\n其中 $x\\equiv K_{a}[\\mathrm{TF}]$ 是结合常数与TF浓度的无量纲乘积，并假设TF浓度在野生型和突变型中是固定的。在感兴趣的TF浓度下，野生型的有效输入为 $x_{\\mathrm{wt}}=2.0$。\n\n仅使用上述定义以及在独立性和背景模型下将PWM对数优势比分数与结合亲和力相关联的成熟原理，计算预测的突变型分数增强子激活 $E_{\\mathrm{mut}}/E_{\\max}$。\n\n请以四位有效数字的十进制形式提供您的最终数值答案。不要包含单位。", "solution": "问题要求计算突变等位基因的分数增强子激活 $E_{\\mathrm{mut}}/E_{\\max}$。此计算分三步进行：第一，确定由突变引起的转录因子（TF）结合亲和力的变化；第二，计算增强子响应函数的相应输入变化；第三，评估突变体的增强子响应。\n\n根据问题陈述，平衡结合常数 $K_a$ 与在位置权重矩阵（PWM）模型下结合位点序列相对于背景模型的似然比成正比。突变型位点和野生型位点的结合常数之比被陈述为等于它们各自的似然比 $R_{\\mathrm{mut}}$ 和 $R_{\\mathrm{wt}}$ 之比。\n$$\n\\frac{K_{a, \\mathrm{mut}}}{K_{a, \\mathrm{wt}}} = \\frac{R_{\\mathrm{mut}}}{R_{\\mathrm{wt}}}\n$$\n对于一个长度为 $L$、碱基为 $\\{b_i\\}$ 的序列，其似然比 $R$ 定义为逐位概率比的乘积：\n$$\nR = \\prod_{i=1}^{L} \\frac{p_i(b_i)}{q(b_i)}\n$$\n其中 $p_i(b_i)$ 是来自PWM的在位置 $i$ 处碱基 $b_i$ 的概率，而 $q(b_i)$ 是该碱基的背景概率。\n\n我们可以将似然比之比 $R_{\\mathrm{mut}}/R_{\\mathrm{wt}}$ 表示为：\n$$\n\\frac{R_{\\mathrm{mut}}}{R_{\\mathrm{wt}}} = \\frac{\\prod_{i=1}^{L} \\frac{p_i(b_{i, \\mathrm{mut}})}{q(b_{i, \\mathrm{mut}})}}{\\prod_{i=1}^{L} \\frac{p_i(b_{i, \\mathrm{wt}})}{q(b_{i, \\mathrm{wt}})}}\n$$\n问题指明，野生型和突变型序列仅在单个位置 $i^{\\ast}$ 上有所不同。对于所有其他位置 $i \\neq i^{\\ast}$，碱基是相同的，即 $b_{i, \\mathrm{mut}} = b_{i, \\mathrm{wt}}$。因此，相应的项 $p_i(b_i)/q(b_i)$ 在分子和分母中是相同的，可以相互抵消。表达式简化为单个改变位置 $i^{\\ast}$ 的项之比：\n$$\n\\frac{R_{\\mathrm{mut}}}{R_{\\mathrm{wt}}} = \\frac{\\frac{p_{i^{\\ast}}(b_{\\mathrm{mut}})}{q(b_{\\mathrm{mut}})}}{\\frac{p_{i^{\\ast}}(b_{\\mathrm{wt}})}{q(b_{\\mathrm{wt}})}}\n$$\n背景模型是均匀的，对于任何碱基 $b$ 都有 $q(b) = 0.25$。因此，背景概率 $q(b_{\\mathrm{mut}})$ 和 $q(b_{\\mathrm{wt}})$ 相等，也相互抵消。该比率进一步简化为仅是位置 $i^{\\ast}$ 处突变型和野生型碱基的PWM概率之比：\n$$\n\\frac{K_{a, \\mathrm{mut}}}{K_{a, \\mathrm{wt}}} = \\frac{p_{i^{\\ast}}(b_{\\mathrm{mut}})}{p_{i^{\\ast}}(b_{\\mathrm{wt}})}\n$$\n问题提供了必要的概率： $p_{i^{\\ast}}(b_{\\mathrm{wt}}) = 0.60$ 和 $p_{i^{\\ast}}(b_{\\mathrm{mut}}) = 0.15$。代入这些值得到：\n$$\n\\frac{K_{a, \\mathrm{mut}}}{K_{a, \\mathrm{wt}}} = \\frac{0.15}{0.60} = \\frac{1}{4} = 0.25\n$$\nHill响应函数的输入是无量纲量 $x = K_a[\\mathrm{TF}]$。由于假设TF浓度 $[\\mathrm{TF}]$ 是恒定的，突变型与野生型的输入变量之比等于它们的结合常数之比：\n$$\n\\frac{x_{\\mathrm{mut}}}{x_{\\mathrm{wt}}} = \\frac{K_{a, \\mathrm{mut}}[\\mathrm{TF}]}{K_{a, \\mathrm{wt}}[\\mathrm{TF}]} = \\frac{K_{a, \\mathrm{mut}}}{K_{a, \\mathrm{wt}}} = 0.25\n$$\n我们已知野生型的输入为 $x_{\\mathrm{wt}} = 2.0$。现在我们可以计算突变型的输入 $x_{\\mathrm{mut}}$：\n$$\nx_{\\mathrm{mut}} = 0.25 \\times x_{\\mathrm{wt}} = 0.25 \\times 2.0 = 0.5\n$$\n最后，我们使用提供的Hill方程，其中Hill系数 $n=2$，并使用计算出的 $x_{\\mathrm{mut}}$ 值，来计算突变型的分数增强子激活 $E_{\\mathrm{mut}}/E_{\\max}$：\n$$\n\\frac{E_{\\mathrm{mut}}}{E_{\\max}} = \\frac{x_{\\mathrm{mut}}^{n}}{1 + x_{\\mathrm{mut}}^{n}} = \\frac{(0.5)^{2}}{1 + (0.5)^{2}}\n$$\n计算此表达式：\n$$\n\\frac{E_{\\mathrm{mut}}}{E_{\\max}} = \\frac{0.25}{1 + 0.25} = \\frac{0.25}{1.25} = \\frac{1}{5} = 0.2\n$$\n问题要求答案以四位有效数字的十进制形式表示。因此，$0.2$ 写作 $0.2000$。", "answer": "$$\n\\boxed{0.2000}\n$$", "id": "2680422"}, {"introduction": "现实世界中的增强子通常包含多个协同作用的结合位点。本练习在前述练习的原理基础上，利用热力学模型来模拟这样一个多位点系统[@problem_id:2680488]。通过这个动手模拟，您将探索“补偿性进化”的概念，即一个突变的影响可以被另一个突变所缓冲，从而在序列发生漂移的情况下保持增强子的整体功能，这一现象也被称为发育系统漂变。", "problem": "要求您形式化并实现一个由单一转录因子 (TF) 调控的双位点脱氧核糖核酸 (DNA) 增强子的热力学平衡模型。其目标是模拟改变两个 TF 结合位点结合能的成对补偿性突变的影响，并计算在突变参数空间中，相对于野生型增强子，在一组指定的 TF 浓度下能产生不变表达的区域。您的程序必须实现该模型，并评估一个成对突变的有限网格，将那些在规定容差范围内产生不变表达的突变进行分类。每个测试用例的最终数值结果是突变空间中产生不变表达的网格点的比例。所有模型参数均为无量纲，能量单位为玻尔兹曼常数乘以绝对温度 ($k_{\\mathrm{B}} T$) 。\n\n基本原理和定义：\n- 假设系统处于热力学平衡并遵循 Boltzmann 统计。一个具有无量纲化学势 $\\mu$ 的 TF 与两个结合能分别为 $E_1$ 和 $E_2$（单位为 $k_{\\mathrm{B}} T$）的位点结合。设两个已结合的 TF 分子之间的协同相互作用能为 $J$（单位为 $k_{\\mathrm{B}} T$），对于正协同性，$J$ 为正；对于拮抗作用，$J$ 为负；对于独立作用，$J$ 为零。\n- 无量纲化学势定义为 $\\mu = \\ln(c/c_0)$，其中参考浓度 $c_0 = 1$，因此当 $c$ 以无量纲浓度形式给出时，$\\mu = \\ln c$。\n- 该增强子有四种占据状态：无 TF 结合、仅位点 1 结合、仅位点 2 结合、以及两位点均结合。这些状态的 Boltzmann 权重分别为：\n  $$\n  w_{00} = 1,\\quad\n  w_{10} = e^{\\mu - E_1},\\quad\n  w_{01} = e^{\\mu - E_2},\\quad\n  w_{11} = e^{2\\mu - E_1 - E_2 + J}.\n  $$\n  配分函数为 $Z = w_{00} + w_{10} + w_{01} + w_{11}$。\n- 将表达输出定义为至少有一个 TF 结合的概率（一种激活子逻辑），即：\n  $$\n  P_{\\mathrm{on}}(\\mu; E_1,E_2,J) = \\frac{w_{10} + w_{01} + w_{11}}{Z}.\n  $$\n\n成对的补偿性突变：\n- 一对补偿性突变将 $(\\Delta E_1, \\Delta E_2)$ 加到野生型能量 $(E_1,E_2)$ 上，产生突变能量 $(E_1 + \\Delta E_1,\\, E_2 + \\Delta E_2)$，而在此问题中 $J$ 保持不变。\n- 给定一组由浓度 $\\{c_i\\}_{i=1}^{M}$ 通过 $\\mu_i = \\ln c_i$ 导出的化学势 $\\{\\mu_i\\}_{i=1}^{M}$，将野生型表达谱定义为 $\\{P_{\\mathrm{on}}(\\mu_i; E_1,E_2,J)\\}_{i=1}^{M}$，突变型表达谱定义为 $\\{P_{\\mathrm{on}}(\\mu_i; E_1+\\Delta E_1, E_2+\\Delta E_2, J)\\}_{i=1}^{M}$。\n- 定义一个不变性容差 $\\varepsilon > 0$。如果一个突变对 $(\\Delta E_1, \\Delta E_2)$ 满足以下条件，则将其分类为不变的：\n  $$\n  \\max_{1 \\le i \\le M} \\left| P_{\\mathrm{on}}(\\mu_i; E_1+\\Delta E_1, E_2+\\Delta E_2, J) - P_{\\mathrm{on}}(\\mu_i; E_1,E_2,J) \\right| \\le \\varepsilon.\n  $$\n\n参数空间区域与定量输出：\n- 考虑突变空间中的一个矩形网格，其中 $\\Delta E_1 \\in [\\Delta E_{\\min}, \\Delta E_{\\max}]$ 和 $\\Delta E_2 \\in [\\Delta E_{\\min}, \\Delta E_{\\max}]$ 在一个步长为 $h > 0$ 的均匀网格上取样，且包含端点。设网格点的集合为 $\\mathcal{G}$，其基数为 $|\\mathcal{G}|$。\n- 一个测试用例的输出是以下比例\n  $$\n  f = \\frac{\\left|\\{(\\Delta E_1,\\Delta E_2) \\in \\mathcal{G} \\,:\\, \\text{invariance holds}\\}\\right|}{|\\mathcal{G}|},\n  $$\n  该比例必须以浮点数形式报告，并四舍五入到六位小数。\n\n测试套件：\n对于下面的每个测试用例，按要求计算 $f$。\n\n- 测试用例 1 (一般协同激活子)：\n  - 野生型参数：$E_1 = 2.0$, $E_2 = 2.0$, $J = 1.0$。\n  - 浓度：$c \\in \\{0.01, 0.1, 1.0, 10.0, 100.0\\}$，因此 $\\mu = \\{\\ln 0.01, \\ln 0.1, \\ln 1.0, \\ln 10.0, \\ln 100.0\\}$。\n  - 不变性容差：$\\varepsilon = 0.02$。\n  - 网格：$\\Delta E_{\\min} = -3.0$, $\\Delta E_{\\max} = 3.0$，步长 $h = 0.5$。\n\n- 测试用例 2 (只有精确不变性的边界)：\n  - 野生型参数：$E_1 = 2.0$, $E_2 = 2.0$, $J = 1.0$。\n  - 浓度：$c \\in \\{0.1, 1.0, 10.0\\}$。\n  - 不变性容差：$\\varepsilon = 0.0$。\n  - 网格：$\\Delta E_{\\min} = -1.0$, $\\Delta E_{\\max} = 1.0$，步长 $h = 0.5$。\n\n- 测试用例 3 (低占据区，独立位点)：\n  - 野生型参数：$E_1 = 3.0$, $E_2 = 3.0$, $J = 0.0$。\n  - 浓度：$c \\in \\{0.001, 0.003, 0.01\\}$。\n  - 不变性容差：$\\varepsilon = 0.005$。\n  - 网格：$\\Delta E_{\\min} = -2.0$, $\\Delta E_{\\max} = 2.0$，步长 $h = 0.5$。\n\n- 测试用例 4 (强协同性)：\n  - 野生型参数：$E_1 = 2.5$, $E_2 = 2.5$, $J = 2.0$。\n  - 浓度：$c \\in \\{0.2, 0.5, 1.0, 2.0, 5.0\\}$。\n  - 不变性容差：$\\varepsilon = 0.02$。\n  - 网格：$\\Delta E_{\\min} = -2.0$, $\\Delta E_{\\max} = 2.0$，步长 $h = 0.25$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个结果，以逗号分隔的列表形式包含在方括号内，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是测试用例 $i$ 的比例 $f$，四舍五入到六位小数，无附加文本。不应打印任何物理单位。不涉及角度。百分比必须以小数形式表示，不得带有百分号。", "solution": "该模型的核心是计算一个双位点增强子被至少一个转录因子 (TF) 占据的概率，该概率可作为基因表达水平的代理指标。这个概率 $P_{\\mathrm{on}}$ 是 TF 化学势 $\\mu$ 和系统能量参数（两个位点的结合能 $E_1$ 和 $E_2$ 以及协同相互作用能 $J$）的函数。\n\n系统可以存在于由两个结合位点的占据情况定义的四种不同状态。每个状态的 Boltzmann 权重，与其概率成正比，由其相对于参考状态（未结合）的能量决定。无量纲化学势由 $\\mu = \\ln c$ 给出，其中 $c$ 是无量纲的 TF 浓度。这些状态及其对应的 Boltzmann 权重是：\n-   状态 (0,0) (未结合): 权重 $w_{00} = 1$。\n-   状态 (1,0) (位点 1 结合): 权重 $w_{10} = e^{\\mu - E_1}$。\n-   状态 (0,1) (位点 2 结合): 权重 $w_{01} = e^{\\mu - E_2}$。\n-   状态 (1,1) (两位点均结合): 权重 $w_{11} = e^{2\\mu - E_1 - E_2 + J}$。\n\n配分函数 $Z$ 是这些权重的总和，代表了状态概率分布的归一化常数：\n$$\nZ(\\mu; E_1, E_2, J) = 1 + e^{\\mu-E_1} + e^{\\mu-E_2} + e^{2\\mu - E_1 - E_2 + J}\n$$\n表达输出 $P_{\\mathrm{on}}$ 是系统处于除未结合状态以外任何状态的概率。这对应于一种激活子逻辑，即至少一个 TF 分子的结合导致表达。\n$$\nP_{\\mathrm{on}}(\\mu; E_1,E_2,J) = \\frac{w_{10} + w_{01} + w_{11}}{Z} = \\frac{e^{\\mu-E_1} + e^{\\mu-E_2} + e^{2\\mu - E_1 - E_2 + J}}{1 + e^{\\mu-E_1} + e^{\\mu-E_2} + e^{2\\mu - E_1 - E_2 + J}}\n$$\n该问题研究了成对补偿性突变的影响，这些突变将结合能从野生型值 $(E_1, E_2)$ 改变为突变状态 $(E_1 + \\Delta E_1, E_2 + \\Delta E_2)$。协同性 $J$ 假定为常数。目标是找到能在指定的一组 $M$ 个 TF 化学势 $\\{\\mu_i\\}_{i=1}^M$ 范围内保持表达谱不变的突变 $(\\Delta E_1, \\Delta E_2)$。\n\n如果突变表达谱与野生型表达谱之间，在所有指定的化学势下的最大绝对差值在给定的容差 $\\varepsilon$ 之内，则该突变被认为是“不变的”。\n$$\n\\max_{1 \\le i \\le M} \\left| P_{\\mathrm{on}}(\\mu_i; E_1+\\Delta E_1, E_2+\\Delta E_2, J) - P_{\\mathrm{on}}(\\mu_i; E_1,E_2,J) \\right| \\le \\varepsilon\n$$\n计算任务是在一个离散的参数空间内，量化此类不变突变的区域。该空间是一个 $(\\Delta E_1, \\Delta E_2)$ 值的均匀网格，其中 $\\Delta E_1, \\Delta E_2 \\in [\\Delta E_{\\min}, \\Delta E_{\\max}]$，步长为 $h$。最终输出是满足不变性判据的网格点的比例 $f$。\n\n计算每个测试用例的 $f$ 的算法如下：\n\n1.  **初始化**：定义测试用例的参数：野生型能量 $(E_1, E_2, J)$、浓度集 $\\{c_i\\}$、容差 $\\varepsilon$ 以及网格参数 $(\\Delta E_{\\min}, \\Delta E_{\\max}, h)$。\n\n2.  **野生型表达谱计算**：\n    a. 使用关系式 $\\mu_i = \\ln(c_i)$ 将浓度 $\\{c_i\\}$ 转换为化学势 $\\{\\mu_i\\}$。\n    b. 使用 $P_{\\mathrm{on}}$ 的公式计算野生型表达水平向量 $\\vec{P}_{\\mathrm{wt}} = [P_{\\mathrm{on}}(\\mu_1; E_1,E_2,J), \\dots, P_{\\mathrm{on}}(\\mu_M; E_1,E_2,J)]$。\n\n3.  **网格生成**：\n    a. 构建单个能量参数的突变值的一维集合。该集合由范围 $[\\Delta E_{\\min}, \\Delta E_{\\max}]$ 和步长 $h$ 定义，包含端点。点数为 $N = (\\Delta E_{\\max} - \\Delta E_{\\min}) / h + 1$。\n    b. 二维网格 $\\mathcal{G}$ 中的总点数为 $|\\mathcal{G}| = N^2$。\n\n4.  **迭代搜索**：\n    a. 初始化不变点计数器 $C_{\\mathrm{inv}} = 0$。\n    b. 遍历网格 $\\mathcal{G}$ 中的每个点 $(\\Delta E_1, \\Delta E_2)$。\n    c. 对于每个点：\n        i.  计算突变能量：$E'_1 = E_1 + \\Delta E_1$ 和 $E'_2 = E_2 + \\Delta E_2$。\n        ii. 计算突变表达水平向量 $\\vec{P}_{\\mathrm{mut}} = [P_{\\mathrm{on}}(\\mu_1; E'_1, E'_2, J), \\dots, P_{\\mathrm{on}}(\\mu_M; E'_1, E'_2, J)]$。\n        iii. 计算最大绝对偏差：$d_{\\max} = \\max_i |P_{\\mathrm{mut},i} - P_{\\mathrm{wt},i}|$。\n        iv. 如果 $d_{\\max} \\le \\varepsilon$，则计数器加一：$C_{\\mathrm{inv}} = C_{\\mathrm{inv}} + 1$。\n\n5.  **最终计算**：\n    a. 计算不变点的比例：$f = C_{\\mathrm{inv}} / |\\mathcal{G}|$。\n    b. 对四个指定的测试用例中的每一个重复此过程。\n\n该算法在提供的 Python 代码中实现，利用 `numpy` 库对表达谱及其差异进行高效的向量化计算。", "answer": "[0.124260,0.200000,0.197531,0.096886]", "id": "2680488"}]}