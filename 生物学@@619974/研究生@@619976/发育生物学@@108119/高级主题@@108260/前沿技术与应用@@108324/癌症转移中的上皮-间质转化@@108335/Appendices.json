{"hands_on_practices": [{"introduction": "要理解上皮-间质转化（EMT）是如何被启动的，我们首先需要为那些解读外界信号（如转化生长因子-β，即 $TGF-\\beta$）的信号通路建立模型。这项练习将引导你推导 SMAD 信号通路的时间动态，该通路是 $TGF-\\beta$ 响应的核心介质 [@problem_id:2635835]。通过运用化学动力学和准稳态近似的原理，你将学会如何用数学语言描述和预测细胞对信号脉冲的瞬时响应。", "problem": "转化生长因子-β ($TGF-\\beta$) 信号通路是通过磷酸化 mothers against decapentaplegic homolog 2/3 (SMAD2/3) 及其快速的核内积累，在癌症转移中驱动上皮-间质转化的经典通路。考虑一次 $TGF-\\beta$ 的单脉冲刺激，其中细胞外配体浓度在 $0 \\le t  \\tau$ 时为 $L(t) = L_{0}$，在 $t \\ge \\tau$ 时为 $L(t) = 0$。受体占据源于基元可逆结合反应 $R + L \\rightleftharpoons RL$，该反应受质量作用定律支配，其结合速率常数为 $k_{\\mathrm{on}}$，解离速率常数为 $k_{\\mathrm{off}}$，且总受体浓度 $R_{T}$ 为常数。假设受体的结合-解离过程远快于 SMAD 的磷酸化和去磷酸化过程，因此在每个时间点 $t$，相对于 SMAD 的修饰和穿梭，受体-配体复合物 $RL(t)$ 处于准稳态。\n\nSMAD2/3 的磷酸化由被占据的受体催化，催化速率常数为 $k_{p}$（相对于 $RL$ 的浓度），而细胞核内的去磷酸化以一级速率常数 $k_{d}$ 发生。假设磷酸化的 SMAD2/3 的二聚化和核转运相对于磷酸化和去磷酸化过程是快速的，因此核内 SMAD 库 $N(t)$ 等于总磷酸化 SMAD 库。初始条件为 $RL(0)=0$ 和 $N(0)=0$。\n\n从质量作用定律和这些假设出发，推导在所有 $t \\ge 0$ 条件下 $N(t)$ 的时间变化解析表达式，如有必要，可使用 Heaviside 阶跃函数 $H(t)$ 将其表示为关于 $t$ 的单一闭合形式函数。所有浓度应以纳摩尔（nM）表示，时间以分钟表示。在最终的解析表达式中不要包含单位；将该表达式解读为得出以纳摩尔为单位的 $N(t)$。你的最终答案必须是一个以 $k_{\\mathrm{on}}$、$k_{\\mathrm{off}}$、$R_{T}$、$L_{0}$、$k_{p}$、$k_{d}$、$\\tau$、$t$ 和 $H(\\cdot)$ 表示的单一闭合形式解析表达式。", "solution": "该问题陈述是化学动力学和系统生物学中的一个有效练习。它具有科学依据，提法恰当，客观，并包含了推导所要求的解析表达式所需的所有信息。我们将开始求解。\n\n目标是求在 TGF-β 脉冲刺激下，核内磷酸化 SMAD 浓度（记为 $N(t)$）的时间变化曲线。\n\n首先，我们确定受体-配体复合物 $[RL](t)$ 的浓度。问题陈述指出，配体浓度 $L(t)$ 是一个持续时间为 $\\tau$、振幅为 $L_0$ 的脉冲：\n$$\nL(t) = \n\\begin{cases} \nL_0  0 \\le t  \\tau \\\\\n0  t \\ge \\tau \n\\end{cases}\n$$\n这可以用 Heaviside 阶跃函数 $H(t)$ 表示为 $L(t) = L_0 (H(t) - H(t-\\tau))$。\n\n结合反应为 $R + L \\rightleftharpoons RL$。根据质量作用定律，复合物浓度的变化速率为：\n$$\n\\frac{d[RL]}{dt} = k_{\\mathrm{on}} [R][L] - k_{\\mathrm{off}} [RL]\n$$\n总受体浓度为常数，$R_T = [R] + [RL]$，这意味着 $[R] = R_T - [RL]$。将此代入速率方程得到：\n$$\n\\frac{d[RL]}{dt} = k_{\\mathrm{on}} (R_T - [RL])[L] - k_{\\mathrm{off}} [RL]\n$$\n一个关键假设是受体的结合-解离动力学远快于随后的 SMAD 磷酸化。这使我们可以对受体-配体复合物采用准稳态近似（QSSA）。在此近似下，我们设定在所有时间 $t$ 都有 $\\frac{d[RL]}{dt} \\approx 0$。\n$$\nk_{\\mathrm{on}} (R_T - [RL])[L] \\approx k_{\\mathrm{off}} [RL]\n$$\n解此关于 $[RL]$ 的代数方程，得到：\n$$\nk_{\\mathrm{on}} R_T [L] \\approx (k_{\\mathrm{off}} + k_{\\mathrm{on}}[L]) [RL]\n$$\n$$\n[RL](t) = \\frac{k_{\\mathrm{on}} R_T L(t)}{k_{\\mathrm{off}} + k_{\\mathrm{on}}L(t)}\n$$\n由于 $L(t)$ 是一个分段常数函数，$[RL](t)$ 也将是一个分段常数函数。\n对于 $0 \\le t  \\tau$，$L(t) = L_0$，复合物的浓度为：\n$$\n[RL]_{\\mathrm{on}} = \\frac{k_{\\mathrm{on}} R_T L_0}{k_{\\mathrm{off}} + k_{\\mathrm{on}} L_0}\n$$\n对于 $t \\ge \\tau$，$L(t) = 0$，复合物的浓度为：\n$$\n[RL]_{\\mathrm{off}} = \\frac{k_{\\mathrm{on}} R_T (0)}{k_{\\mathrm{off}} + k_{\\mathrm{on}}(0)} = 0\n$$\n因此，我们可以将所有 $t \\ge 0$ 的 $[RL](t)$ 写为：\n$$\n[RL](t) = \\left( \\frac{k_{\\mathrm{on}} R_T L_0}{k_{\\mathrm{off}} + k_{\\mathrm{on}} L_0} \\right) (H(t) - H(t-\\tau))\n$$\n让我们将刺激期间复合物浓度的恒定振幅定义为 $C_{RL} = \\frac{k_{\\mathrm{on}} R_T L_0}{k_{\\mathrm{off}} + k_{\\mathrm{on}} L_0}$。那么，$[RL](t) = C_{RL} (H(t) - H(t-\\tau))$。\n\n接下来，我们为核内磷酸化 SMAD 浓度 $N(t)$ 建立微分方程。$N(t)$ 的变化速率是磷酸化速率减去去磷酸化速率。\n问题陈述指出，磷酸化由被占据的受体催化，速率常数为 $k_p$（相对于 $RL$ 的浓度）。这意味着磷酸化速率为 $k_p [RL](t)$。\n去磷酸化是一个一级过程，速率常数为 $k_d$，因此其速率为 $k_d N(t)$。\n由此得到的关于 $N(t)$ 的常微分方程（ODE）是：\n$$\n\\frac{dN}{dt} = k_p [RL](t) - k_d N(t)\n$$\n代入 $[RL](t)$ 的表达式，我们得到：\n$$\n\\frac{dN}{dt} + k_d N(t) = k_p C_{RL} (H(t) - H(t-\\tau))\n$$\n这是一个初始条件为 $N(0)=0$ 的一阶线性非齐次常微分方程。我们可以通过分别考虑两个时间区间来求解。\n\n对于区间 $0 \\le t  \\tau$：\nODE 为 $\\frac{dN}{dt} + k_d N = k_p C_{RL}$。\n通解为 $N(t) = \\frac{k_p C_{RL}}{k_d} + A \\exp(-k_d t)$，其中 $A$ 是一个积分常数。\n应用初始条件 $N(0)=0$：\n$0 = \\frac{k_p C_{RL}}{k_d} + A \\implies A = -\\frac{k_p C_{RL}}{k_d}$。\n所以，对于 $0 \\le t  \\tau$，解为：\n$$\nN_1(t) = \\frac{k_p C_{RL}}{k_d} (1 - \\exp(-k_d t))\n$$\n\n对于区间 $t \\ge \\tau$：\nODE 为 $\\frac{dN}{dt} + k_d N = 0$。\n通解为 $N_2(t) = B \\exp(-k_d t)$，其中 $B$ 是一个积分常数。\n为了求出 $B$，我们保证解在 $t = \\tau$ 处的连续性，即 $N_2(\\tau) = N_1(\\tau)$。\n$$\nN_1(\\tau) = \\frac{k_p C_{RL}}{k_d} (1 - \\exp(-k_d \\tau))\n$$\n$$\nN_2(\\tau) = B \\exp(-k_d \\tau)\n$$\n令两者相等，得到：\n$$\nB \\exp(-k_d \\tau) = \\frac{k_p C_{RL}}{k_d} (1 - \\exp(-k_d \\tau))\n$$\n$$\nB = \\frac{k_p C_{RL}}{k_d} (1 - \\exp(-k_d \\tau)) \\exp(k_d \\tau) = \\frac{k_p C_{RL}}{k_d} (\\exp(k_d \\tau) - 1)\n$$\n所以，对于 $t \\ge \\tau$，解为：\n$$\nN_2(t) = \\frac{k_p C_{RL}}{k_d} (\\exp(k_d \\tau) - 1) \\exp(-k_d t)\n$$\n\n为了写出适用于所有 $t \\ge 0$ 的 $N(t)$ 的单一闭合形式表达式，我们利用线性系统的叠加原理和 Heaviside 阶跃函数。对脉冲输入 $F(t) = F_0 (H(t) - H(t-\\tau))$ 的响应是始于 $t=0$ 的阶跃响应与始于 $t=\\tau$ 的延迟阶跃响应之差。\n对于输入 $k_p C_{RL} H(t)$ 的阶跃响应 $N_{step}(t)$ 正是 $N_1(t)$：\n$$\nN_{step}(t) = \\frac{k_p C_{RL}}{k_d} (1 - \\exp(-k_d t))\n$$\n那么，完整解是 $N(t) = N_{step}(t) - N_{step}(t-\\tau)H(t-\\tau)$。\n$$\nN(t) = \\frac{k_p C_{RL}}{k_d} (1 - \\exp(-k_d t)) - \\left( \\frac{k_p C_{RL}}{k_d} (1 - \\exp(-k_d(t-\\tau))) \\right) H(t-\\tau)\n$$\n这可以被因式分解：\n$$\nN(t) = \\frac{k_p C_{RL}}{k_d} \\left[ (1 - \\exp(-k_d t)) - (1 - \\exp(-k_d(t-\\tau))) H(t-\\tau) \\right]\n$$\n最后，我们代回 $C_{RL}$ 的表达式：\n$$\nC_{RL} = \\frac{k_{\\mathrm{on}} R_T L_0}{k_{\\mathrm{off}} + k_{\\mathrm{on}} L_0}\n$$\n这就给出了 $N(t)$ 的最终解析表达式：\n$$\nN(t) = \\frac{k_p}{k_d} \\left( \\frac{k_{\\mathrm{on}} R_T L_0}{k_{\\mathrm{off}} + k_{\\mathrm{on}} L_0} \\right) \\left[ (1 - \\exp(-k_d t)) - (1 - \\exp(-k_d(t-\\tau))) H(t-\\tau) \\right]\n$$\n该表达式是 $N(t)$ 在所有 $t \\ge 0$ 时的完整解，满足了问题陈述的所有要求。", "answer": "$$\n\\boxed{\n\\frac{k_p}{k_d} \\left( \\frac{k_{\\mathrm{on}} R_T L_0}{k_{\\mathrm{off}} + k_{\\mathrm{on}} L_0} \\right) \\left[ \\left(1 - \\exp(-k_d t)\\right) - \\left(1 - \\exp(-k_d(t-\\tau))\\right) H(t-\\tau) \\right]\n}\n$$", "id": "2635835"}, {"introduction": "上皮-间质转化（EMT）决策的核心是一个如同开关一样工作的基因调控网络。本练习聚焦于经典的 ZEB/miR-200 双负反馈环路，该环路能够产生双稳态，使细胞能够稳定地处于上皮或间质状态 [@problem_id:2635848]。通过进行线性稳定性分析，你将识别系统的平衡点并确定其稳定性，从而从定量的角度理解细胞如何做出稳健的、开关般的命运决策。", "problem": "考虑一个最小化的、无量纲化的双变量调控回路，该回路捕捉了转录因子锌指E-盒结合同源异形盒（ZEB，记为$Z$）与微小RNA miR-200（记为$R$）之间的双负反馈。这是一个与癌症转移相关的经典上皮-间质转化（EMT）模块。其动力学由具有希尔型抑制的常微分方程（ODEs）建模：\n$$\n\\frac{dZ}{dt} \\;=\\; \\frac{a}{1+\\left(\\frac{R}{K}\\right)^{n}} \\;-\\; d\\,Z, \n\\qquad\n\\frac{dR}{dt} \\;=\\; \\frac{a}{1+\\left(\\frac{Z}{K}\\right)^{n}} \\;-\\; d\\,R,\n$$\n其中 $a$ 是最大调控生产速率，$K$ 是抑制阈值，$n$ 是希尔系数，$d$ 是一阶周转率。此类希尔函数是发育生物学中经过充分检验的基因调控唯象描述，而常微分方程的形式源于生产和周转之间的质量平衡。\n\n假设对称参数集 $a=2$，$K=1$，$n=2$，$d=1$。仅从核心的动力学系统和生物化学调控原理（稳态、雅可比矩阵以及基于特征值的线性稳定性的定义）出发，完成以下任务：\n\n1. 确定满足 $Z^{\\ast}>0$ 和 $R^{\\ast}>0$ 的生物学相关平衡点 $(Z^{\\ast},R^{\\ast})$。\n\n2. 计算向量场在点 $(Z^{\\ast},R^{\\ast})$ 处的雅可比矩阵及其特征值。\n\n你最终报告的量必须是一个实数：谱横坐标，其定义为雅可比矩阵在 $(Z^{\\ast},R^{\\ast})$ 处特征值实部的最大值。请将你的最终答案表示为一个精确值，无单位（该系统已无量纲化）。请勿四舍五入。", "solution": "首先验证问题的科学性、适定性和客观性。该问题使用标准的常微分方程（ODEs）和希尔函数描述了一个典型的双变量调控回路，这是系统生物学中用于模拟基因调控的成熟范式。问题给定了参数，并提出了数学上精确的任务，要求计算一个平衡点、一个雅可比矩阵、其特征值以及谱横坐标。该问题是自洽的、一致的，并且需要将动力学系统理论标准地应用于一个生物模型。因此，该问题被认为是有效的，并将构建解答。\n\n常微分方程组如下：\n$$\n\\frac{dZ}{dt} = \\frac{a}{1+\\left(\\frac{R}{K}\\right)^{n}} - dZ \\equiv f(Z, R)\n$$\n$$\n\\frac{dR}{dt} = \\frac{a}{1+\\left(\\frac{Z}{K}\\right)^{n}} - dR \\equiv g(Z, R)\n$$\n提供的参数为 $a=2$, $K=1$, $n=2$, $d=1$。将这些值代入方程中得到：\n$$\n\\frac{dZ}{dt} = \\frac{2}{1+R^2} - Z\n$$\n$$\n\\frac{dR}{dt} = \\frac{2}{1+Z^2} - R\n$$\n\n首先，我们确定满足 $Z^{\\ast}0$ 和 $R^{\\ast}0$ 的生物学相关平衡点 $(Z^{\\ast}, R^{\\ast})$。通过将时间导数设为零来找到平衡点：\n$$\n\\frac{dZ}{dt} = 0 \\implies Z^{\\ast} = \\frac{2}{1+(R^{\\ast})^2}\n$$\n$$\n\\frac{dR}{dt} = 0 \\implies R^{\\ast} = \\frac{2}{1+(Z^{\\ast})^2}\n$$\n由于方程的对称性，我们可以寻找一个对称平衡点，其中 $Z^{\\ast}=R^{\\ast}$。将 $R^{\\ast}=Z^{\\ast}$ 代入第一个方程得到：\n$$\nZ^{\\ast} = \\frac{2}{1+(Z^{\\ast})^2}\n$$\n两边乘以 $1+(Z^{\\ast})^2$ 得到一个关于 $Z^{\\ast}$ 的三次方程：\n$$\nZ^{\\ast}(1+(Z^{\\ast})^2) = 2\n$$\n$$\n(Z^{\\ast})^3 + Z^{\\ast} - 2 = 0\n$$\n为了找到该多项式的实根，令 $P(Z) = Z^3 + Z - 2$。通过检验，我们可以测试常数项 $-2$ 的整数因子。对于 $Z=1$：\n$$\nP(1) = (1)^3 + 1 - 2 = 1+1-2=0\n$$\n因此，$Z^{\\ast}=1$ 是一个根。为了找到其他可能的实根，我们用 $(Z-1)$ 对 $P(Z)$ 进行多项式除法：\n$$\n\\frac{Z^3 + Z - 2}{Z - 1} = Z^2 + Z + 2\n$$\n所以，该方程可以因式分解为 $(Z-1)(Z^2 + Z + 2) = 0$。二次因子 $Z^2 + Z + 2 = 0$ 的根由求根公式给出，$Z = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$。其判别式为 $\\Delta = 1^2 - 4(1)(2) = 1 - 8 = -7$。由于 $\\Delta  0$，另外两个根是复数。因此，唯一的正实根是 $Z^{\\ast}=1$。\n对称平衡点是 $(Z^{\\ast}, R^{\\ast}) = (1, 1)$，它满足 $Z^{\\ast}0$ 和 $R^{\\ast}0$ 的条件。\n\n接下来，我们计算向量场在该平衡点处的雅可比矩阵。雅可比矩阵 $J$ 定义为：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f}{\\partial Z}  \\frac{\\partial f}{\\partial R} \\\\ \\frac{\\partial g}{\\partial Z}  \\frac{\\partial g}{\\partial R} \\end{pmatrix}\n$$\n偏导数由带有一般参数的系统计算得出：\n$$\n\\frac{\\partial f}{\\partial Z} = -d\n$$\n$$\n\\frac{\\partial f}{\\partial R} = \\frac{\\partial}{\\partial R} \\left( a \\left(1+\\left(\\frac{R}{K}\\right)^n\\right)^{-1} \\right) = -a \\left(1+\\left(\\frac{R}{K}\\right)^n\\right)^{-2} \\left( n \\frac{R^{n-1}}{K^n} \\right) = \\frac{-anR^{n-1}}{K^n \\left(1+(R/K)^n\\right)^2}\n$$\n$$\n\\frac{\\partial g}{\\partial Z} = \\frac{\\partial}{\\partial Z} \\left( a \\left(1+\\left(\\frac{Z}{K}\\right)^n\\right)^{-1} \\right) = -a \\left(1+\\left(\\frac{Z}{K}\\right)^n\\right)^{-2} \\left( n \\frac{Z^{n-1}}{K^n} \\right) = \\frac{-anZ^{n-1}}{K^n \\left(1+(Z/K)^n\\right)^2}\n$$\n$$\n\\frac{\\partial g}{\\partial R} = -d\n$$\n代入具体参数值 $a=2$, $K=1$, $n=2$, $d=1$：\n$$\n\\frac{\\partial f}{\\partial Z} = -1\n$$\n$$\n\\frac{\\partial f}{\\partial R} = \\frac{-2(2)R^{2-1}}{1^2 \\left(1+(R/1)^2\\right)^2} = \\frac{-4R}{(1+R^2)^2}\n$$\n$$\n\\frac{\\partial g}{\\partial Z} = \\frac{-2(2)Z^{2-1}}{1^2 \\left(1+(Z/1)^2\\right)^2} = \\frac{-4Z}{(1+Z^2)^2}\n$$\n$$\n\\frac{\\partial g}{\\partial R} = -1\n$$\n作为 $(Z, R)$ 函数的雅可比矩阵是：\n$$\nJ(Z, R) = \\begin{pmatrix} -1  \\frac{-4R}{(1+R^2)^2} \\\\ \\frac{-4Z}{(1+Z^2)^2}  -1 \\end{pmatrix}\n$$\n现在，我们在平衡点 $(Z^{\\ast}, R^{\\ast}) = (1, 1)$ 处计算该矩阵：\n$$\nJ(1, 1) = \\begin{pmatrix} -1  \\frac{-4(1)}{(1+1^2)^2} \\\\ \\frac{-4(1)}{(1+1^2)^2}  -1 \\end{pmatrix} = \\begin{pmatrix} -1  \\frac{-4}{4} \\\\ \\frac{-4}{4}  -1 \\end{pmatrix} = \\begin{pmatrix} -1  -1 \\\\ -1  -1 \\end{pmatrix}\n$$\n\n最后，我们通过求解特征方程 $\\det(J - \\lambda I) = 0$ 来求雅可比矩阵 $J(1, 1)$ 的特征值 $\\lambda$，其中 $I$ 是单位矩阵。\n$$\n\\det \\begin{pmatrix} -1-\\lambda  -1 \\\\ -1  -1-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(-1-\\lambda)(-1-\\lambda) - (-1)(-1) = 0\n$$\n$$\n(1+\\lambda)^2 - 1 = 0\n$$\n$$\n\\lambda^2 + 2\\lambda + 1 - 1 = 0\n$$\n$$\n\\lambda^2 + 2\\lambda = 0\n$$\n$$\n\\lambda(\\lambda+2) = 0\n$$\n特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = -2$。\n\n谱横坐标定义为特征值实部的最大值。\n$$\n\\text{Re}(\\lambda_1) = \\text{Re}(0) = 0\n$$\n$$\n\\text{Re}(\\lambda_2) = \\text{Re}(-2) = -2\n$$\n这些实部的最大值是：\n$$\n\\max(\\text{Re}(\\lambda_1), \\text{Re}(\\lambda_2)) = \\max(0, -2) = 0\n$$\n这个值是在指定平衡点处雅可比矩阵的谱横坐标。", "answer": "$$\\boxed{0}$$", "id": "2635848"}, {"introduction": "当理论模型的参数根植于实验数据时，它们才能成为强大的预测工具。这项练习通过参数估计，弥合了 ZEB/miR-200 环路抽象模型与定量测量数据之间的鸿沟 [@problem_id:2635850]。你将使用非线性回归方法，将希尔函数（Hill function）模型与剂量-反应数据进行拟合，从而提取出关键参数，例如抑制系数 ($K$) 和希尔系数 ($n$)，这些都是先前稳定性分析的基础。", "problem": "您正在模拟癌症转移背景下，上皮-间质转化 (EMT) 过程中，微小RNA-200 (miR-200) 对锌指E-盒结合同源异形盒 (ZEB) 转录因子水平的调控效应。在稳态下，协同性转录抑制通常用一个Hill型抑制函数来表示，该函数是根据平衡结合假设下的配体-操纵子占有率推导出来的。在此设定中，标准化的ZEB蛋白水平可以被建模为一个关于miR-200模拟物浓度的双参数函数。从协同结合产生Hill型剂量-反应曲线这一标准基因调控原理出发，您需要用一个关于miR-200模拟物浓度的函数来表示标准化的ZEB水平，并通过数据拟合来推断其参数。\n\n假设以下基础原理：\n- 分子生物学的中心法则指出，基因通过转录和翻译进行表达。\n- 抑制物与调控DNA或信使RNA的结合以浓度依赖的方式影响蛋白质的产出。\n- 对于协同结合，稳态下的分数产出通常遵循Hill形式，其中Hill系数表示协同程度，有效抑制系数表示响应达到半最大值时的浓度。\n\n将标准化的ZEB水平定义为关于miR-200模拟物浓度 $c$ （单位为纳摩尔 (nM)）的函数模型如下\n$$\ny(c;K,n) \\;=\\; \\frac{1}{1 + \\left(\\frac{c}{K}\\right)^{n}},\n$$\n其中 $K$ 是有效抑制系数（单位为纳摩尔 (nM)），$n$ 是Hill系数（无量纲）。$K$ 和 $n$ 均为待推断的正未知数，通过最小化观测到的标准化ZEB值与模型预测值之间的残差平方和来推断。\n\n您的任务是实现一个程序，对每个提供的数据集（测试用例），通过非线性最小二乘法估计 $K$ 和 $n$ 并报告估计值。请使用下面给出的精确数据集，这些数据集包含miR-200模拟物浓度 $c_i$ （单位为纳摩尔 (nM)）和相应的标准化ZEB水平 $y_i$ （无量纲）。所有输出必须是浮点数；报告 $K$ 的数值（单位为纳摩尔 (nM)，仅报告数值）和无量纲的 $n$。将每个报告值四舍五入到三位小数。\n\n测试套件（三个数据集）：\n- 测试用例 A：\n  - 浓度 (nM)：$[\\,0,\\,1,\\,2,\\,5,\\,10,\\,20,\\,50,\\,100\\,]$\n  - 标准化ZEB：$[\\,1.0,\\,0.9900990099009901,\\,0.9615384615384616,\\,0.8,\\,0.5,\\,0.2,\\,0.038461538461538464,\\,0.009900990099009901\\,]$\n- 测试用例 B：\n  - 浓度 (nM)：$[\\,0,\\,1,\\,2,\\,5,\\,10,\\,20,\\,50\\,]$\n  - 标准化ZEB：$[\\,1.0,\\,0.8333333333333334,\\,0.7142857142857143,\\,0.5,\\,0.3333333333333333,\\,0.2,\\,0.09090909090909091\\,]$\n- 测试用例 C：\n  - 浓度 (nM)：$[\\,0,\\,5,\\,10,\\,25,\\,50,\\,75,\\,100\\,]$\n  - 标准化ZEB：$[\\,1.0,\\,0.9984031986127729,\\,0.975,\\,0.5,\\,0.058823529411764705,\\,0.012195121951219513,\\,0.0038910505836575876\\,]$\n\n算法要求：\n- 通过最小化目标函数，将模型 $y(c;K,n)$ 拟合到每个数据集\n$$\nS(K,n) \\;=\\; \\sum_{i} \\big(y_i - y(c_i;K,n)\\big)^2,\n$$\n约束条件为 $K  0$ 和 $n  0$。\n- 使用一个数值稳定的非线性最小二乘法程序，并提供合理的初始猜测值和正值约束。\n- 对于每个数据集，报告四舍五入到三位小数的参数对 $(K,n)$。\n\n角度单位不适用。物理单位：$K$ 的单位为纳摩尔 (nM)，报告其数值；$n$ 是无量纲的。所有输出都应为不带单位符号的数值浮点数。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。按 $[K_A, n_A, K_B, n_B, K_C, n_C]$ 的顺序连接四舍五入后的估计值，其中下标表示测试用例。例如，一个可接受的格式是 $[\\,1.234,2.345,3.456,4.567,5.678,6.789\\,]$ （这纯粹是为了说明；您必须输出您为给定数据集计算出的值）。", "solution": "该问题陈述已经过严格验证，并被确定为有效。它具有科学依据，数学上是适定的，内部一致，并且计算上是可行的。它提出了定量系统生物学中的一个标准任务：从观测数据中为动态模型进行参数推断。\n\n目标是估计一个Hill型抑制模型的参数，该模型描述了标准化的ZEB蛋白水平 $y$ 作为miR-200模拟物浓度 $c$ 的函数。该模型由以下函数给出：\n$$\ny(c; K, n) = \\frac{1}{1 + \\left(\\frac{c}{K}\\right)^n}\n$$\n在这里，$K$ 代表有效抑制系数，即响应达到半最大值时的浓度；$n$ 是Hill系数，表示抑制机制中的协同程度。参数 $K$ 和 $n$ 是未知的，必须从提供的实验数据集中推断出来，并满足物理约束 $K  0$ 和 $n  0$。\n\n参数估计的方法被指定为非线性最小二乘法。这涉及找到参数值 $(\\hat{K}, \\hat{n})$，以最小化模型的预测值与观测数据点 $(c_i, y_i)$ 之间的残差平方和 $S(K, n)$。要最小化的目标函数是：\n$$\nS(K, n) = \\sum_{i} \\left( y_i - y(c_i; K, n) \\right)^2\n$$\n这是一个经典的数值优化问题。我们将采用一个稳健的算法，例如Levenberg-Marquardt算法，该算法在SciPy库的 `scipy.optimize.curve_fit` 函数中实现。这个程序非常适合此类曲线拟合问题。\n\n对于每个提供的数据集，其流程如下：\n1.  以适合数值求解器的形式定义模型函数 $y(c; K, n)$。\n2.  提供实验数据点，即浓度数组 $c_i$ 和相应的标准化ZEB水平数组 $y_i$。\n3.  为参数 $(K_0, n_0)$ 设定合理的初始猜测值。对于 $K_0$，一个合乎逻辑的选择是观测响应 $y_i$ 最接近0.5时的浓度 $c_i$，因为这正是有效抑制系数 $K$ 的定义。对于Hill系数 $n_0$，一个合理的初始猜测是1或2，分别代表非协同或简单协同结合。\n4.  指定参数边界 $([0, 0], [\\infty, \\infty])$ 以强制执行正值约束 $K  0$ 和 $n  0$。一个小的正数epsilon，例如 $10^{-9}$，将用作实际的下界，以避免在恰好为零时出现数值问题。\n5.  执行 `curve_fit` 函数，该函数从初始猜测值开始迭代调整 $K$ 和 $n$，以找到使残差平方和 $S(K,n)$ 最小化的值。\n6.  算法返回的优化参数 $(\\hat{K}, \\hat{n})$ 即为给定数据集的估计值。\n\n此程序独立应用于三个测试用例（A、B、C）中的每一个。然后收集每个用例得到的参数估计值 $(\\hat{K}_A, \\hat{n}_A)$、$(\\hat{K}_B, \\hat{n}_B)$ 和 $(\\hat{K}_C, \\hat{n}_C)$。根据问题规范，$K$ 和 $n$ 的数值被四舍五入到三位小数，并呈现在一个最终连接的列表中。问题中提供的数据异常“干净”，似乎是直接从具有整数或简单有理数参数的模型函数生成的。这确保了正确实现的数值拟合程序将精确收敛到真实的潜在参数值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves for the Hill equation parameters K and n for three datasets\n    using nonlinear least squares fitting.\n    \"\"\"\n\n    # Define the Hill-type repression function to be fitted.\n    # The function signature f(x, p1, p2, ...) is required by scipy.optimize.curve_fit,\n    # where x is the independent variable and p_i are the parameters to fit.\n    def hill_repression_model(c, K, n):\n        \"\"\"\n        Calculates the normalized ZEB level based on the Hill repression model.\n        Args:\n            c (np.ndarray): miR-200 mimic concentration (nM).\n            K (float): Effective repression coefficient (nM).\n            n (float): Hill coefficient (dimensionless).\n        Returns:\n            np.ndarray: Normalized ZEB level.\n        \"\"\"\n        # Using np.power is safe for c=0.\n        # To prevent division by zero or warnings if K is ever zero during optimization,\n        # a small epsilon could be added, but the bounds constraint makes this unnecessary.\n        term = np.power(c / K, n)\n        return 1.0 / (1.0 + term)\n\n    # Define the test cases from the problem statement.\n    # Each case includes concentrations, ZEB levels, and a sensible initial guess [K_0, n_0].\n    # The initial guess for K is based on the concentration where the response is near 0.5.\n    test_cases = [\n        {\n            \"c\": np.array([0, 1, 2, 5, 10, 20, 50, 100]),\n            \"y\": np.array([1.0, 0.9900990099009901, 0.9615384615384616, 0.8, 0.5, 0.2, 0.038461538461538464, 0.009900990099009901]),\n            \"p0\": [10.0, 2.0]  # K is approx. 10 since y(10) = 0.5\n        },\n        {\n            \"c\": np.array([0, 1, 2, 5, 10, 20, 50]),\n            \"y\": np.array([1.0, 0.8333333333333334, 0.7142857142857143, 0.5, 0.3333333333333333, 0.2, 0.09090909090909091]),\n            \"p0\": [5.0, 1.0]   # K is approx. 5 since y(5) = 0.5\n        },\n        {\n            \"c\": np.array([0, 5, 10, 25, 50, 75, 100]),\n            \"y\": np.array([1.0, 0.9984031986127729, 0.975, 0.5, 0.058823529411764705, 0.012195121951219513, 0.0038910505836575876]),\n            \"p0\": [25.0, 2.0]  # K is approx. 25 since y(25) = 0.5. n_guess=2 is standard.\n        }\n    ]\n\n    results = []\n    # Define bounds for the parameters K and n to be positive.\n    # A small positive number is used for the lower bound to strictly enforce K  0, n  0.\n    bounds = ([1e-9, 1e-9], [np.inf, np.inf])\n\n    # Process each test case.\n    for case in test_cases:\n        # Perform the nonlinear least squares fit.\n        # popt contains the optimal parameter values.\n        # pcov contains the estimated covariance of popt.\n        popt, pcov = curve_fit(\n            f=hill_repression_model,\n            xdata=case[\"c\"],\n            ydata=case[\"y\"],\n            p0=case[\"p0\"],\n            bounds=bounds\n        )\n        \n        K_fit, n_fit = popt\n        results.append(K_fit)\n        results.append(n_fit)\n\n    # Final print statement in the exact required format.\n    # The format string '{x:.3f}' ensures each value is rounded to three decimal places.\n    print(f\"[{','.join([f'{x:.3f}' for x in results])}]\")\n\nsolve()\n```", "id": "2635850"}]}