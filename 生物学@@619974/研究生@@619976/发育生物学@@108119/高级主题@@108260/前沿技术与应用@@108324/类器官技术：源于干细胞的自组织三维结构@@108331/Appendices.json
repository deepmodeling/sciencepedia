{"hands_on_practices": [{"introduction": "类器官作为三维细胞培养系统，其生长和功能不可避免地受到物理定律的制约。这个练习将引导我们直面一个核心的实际问题：营养和氧气的供应极限。我们将通过一个简化的物理模型，运用菲克扩散定律（Fick's law of diffusion）来推导一个球形类器官在中心开始缺氧之前所能达到的最大理论半径 $R_{\\text{max}}$ [@problem_id:2659228]。掌握这种建模方法不仅有助于我们理解类器官尺寸的内在限制，也为优化培养条件和解读生长相关的实验数据提供了坚实的理论基础。", "problem": "一个半径为 $R$ 的三维（3D）球形类器官，在充分混合的培养基中培养，其表面氧气浓度维持在一个固定值 $C_{0}$。在类器官内部，氧气以扩散系数 $D$ 进行扩散，并以空间上均匀的零级速率 $q$（单位体积单位时间内的摩尔数）被细胞消耗。假设系统处于稳态并具有球对称性。请仅使用质量守恒和 Fick 扩散第一定律，推导类器官内部的稳态径向氧气浓度分布 $C(r)$。在 $r=0$ 和 $r=R$ 处施加物理上合理的边界条件。将中心缺氧的发生操作性地定义为 $C(0)=0$。根据您推导的分布，确定能维持 $C(0)\\geq 0$ 的最大存活半径 $R_{\\text{max}}$。请用 $C_{0}$、$D$ 和 $q$ 将最终答案表示为一个解析闭式解。无需进行数值计算或四舍五入。最终答案中不包含单位。", "solution": "所述问题在科学上合理、提法明确，并包含获得唯一解所需的所有信息。这是生物物理输运现象中的一个标准问题。我将着手进行推导。\n\n问题要求推导球形类器官内的稳态氧气浓度分布 $C(r)$，并随后确定最大存活半径 $R_{\\text{max}}$。该推导基于稳态下的质量守恒原理，并结合 Fick 扩散第一定律。\n\n让我们考虑类器官内部一个从径向距离 $r$ 延伸到 $r+dr$ 的薄球壳。该球壳的体积为 $dV = 4\\pi r^{2}dr$。\n在稳态下，任何控制体积内氧气质量的变化率均为零。这意味着，进入该体积的氧气净扩散速率必须等于该体积内的氧气消耗速率。\n\n氧气通量 $J(r)$ 由 Fick 扩散第一定律描述。对于球坐标系中的一维扩散，该定律可表示为：\n$$\nJ(r) = -D \\frac{dC}{dr}\n$$\n其中 $D$ 为氧气的扩散系数。穿过半径为 $r$、面积为 $A(r) = 4\\pi r^{2}$ 的球面的总氧气流速 $N(r)$ 由下式给出：\n$$\nN(r) = A(r) J(r) = -4\\pi r^{2} D \\frac{dC}{dr}\n$$\n\n从 $r$ 到 $r+dr$ 的球壳内的氧气消耗速率由零级消耗速率 $q$ 与球壳体积 $dV$ 的乘积给出：\n$$\n\\text{消耗速率} = q \\cdot dV = q \\cdot 4\\pi r^{2}dr\n$$\n\n对于稳态下球壳内的质量平衡：\n(在 $r$ 处流入的氧气速率) - (在 $r+dr$ 处流出的氧气速率) = (球壳内的消耗速率)\n$$\nN(r) - N(r+dr) = 4\\pi q r^{2}dr\n$$\n$N(r) - N(r+dr)$ 项等价于 $-dN$。因此，我们有：\n$$\n-dN = 4\\pi q r^{2}dr\n$$\n两边同除以 $dr$ 得到微分形式：\n$$\n\\frac{dN}{dr} = -4\\pi q r^{2}\n$$\n现在，我们代入 $N(r)$ 的表达式：\n$$\n\\frac{d}{dr} \\left( -4\\pi r^{2} D \\frac{dC}{dr} \\right) = -4\\pi q r^{2}\n$$\n假设扩散系数 $D$ 为常数，我们可以将方程两边同除以 $-4\\pi D$ 来进行简化：\n$$\n\\frac{d}{dr} \\left( r^{2} \\frac{dC}{dr} \\right) = \\frac{q}{D} r^{2}\n$$\n这就是描述氧气浓度分布 $C(r)$ 的控制性二阶常微分方程。\n\n为求得 $C(r)$，我们将此方程对 $r$ 积分两次。第一次积分：\n$$\nr^{2} \\frac{dC}{dr} = \\int \\frac{q}{D} r^{2} dr = \\frac{q}{D} \\frac{r^{3}}{3} + k_{1}\n$$\n其中 $k_{1}$ 是第一个积分常数。\n我们分离出梯度项 $\\frac{dC}{dr}$：\n$$\n\\frac{dC}{dr} = \\frac{q}{3D} r + \\frac{k_{1}}{r^{2}}\n$$\n第二次对 $r$ 积分：\n$$\nC(r) = \\int \\left( \\frac{q}{3D} r + \\frac{k_{1}}{r^{2}} \\right) dr = \\frac{q}{6D} r^{2} - \\frac{k_{1}}{r} + k_{2}\n$$\n其中 $k_{2}$ 是第二个积分常数。这就是通解。\n\n接下来，我们应用物理上合理的边界条件来确定常数 $k_{1}$ 和 $k_{2}$。\n1.  在类器官中心 $r=0$ 处：由于球对称性，中心处的浓度分布必须是平坦的。这意味着此处不能有浓度梯度，否则会从一个单点产生无限大的通量，这在物理上是不可能的。因此，边界条件为：\n    $$\n    \\left. \\frac{dC}{dr} \\right|_{r=0} = 0\n    $$\n    将此条件应用于梯度表达式 $\\frac{dC}{dr} = \\frac{q}{3D} r + \\frac{k_{1}}{r^{2}}$。当 $r \\to 0$ 时，$\\frac{k_{1}}{r^{2}}$ 项会发散，除非 $k_{1}=0$。为保持梯度有限，我们必须设定 $k_{1}=0$。\n\n2.  当 $k_{1}=0$ 时，解简化为 $C(r) = \\frac{q}{6D} r^{2} + k_{2}$。第二个边界条件位于类器官表面 $r=R$ 处，该处的氧气浓度维持在一个固定值 $C_{0}$。\n    $$\n    C(R) = C_{0}\n    $$\n    应用此条件：\n    $$\n    C_{0} = \\frac{q}{6D} R^{2} + k_{2}\n    $$\n    解出 $k_{2}$：\n    $$\n    k_{2} = C_{0} - \\frac{q R^{2}}{6D}\n    $$\n最后，将 $k_{2}$ 代回 $C(r)$ 的解中，得到特定的稳态氧气浓度分布：\n$$\nC(r) = \\frac{q}{6D} r^{2} + \\left( C_{0} - \\frac{q R^{2}}{6D} \\right)\n$$\n$$\nC(r) = C_{0} - \\frac{q}{6D} (R^{2} - r^{2})\n$$\n这就是类器官内部氧气浓度随径向位置变化的抛物线型分布。\n\n最后的任务是求解最大存活半径 $R_{\\text{max}}$。只要各处浓度均为非负值，即 $C(r) \\geq 0$，细胞就能存活。由于浓度分布是抛物线型的，且从表面向中心递减，因此最低浓度出现在中心 $r=0$ 处。所以，存活条件可以简化为 $C(0) \\geq 0$。\n问题指出，当 $C(0)=0$ 时，出现中心缺氧。我们使用这个条件来求解最大半径。\n根据我们推导的分布，中心处的浓度为：\n$$\nC(0) = C_{0} - \\frac{q}{6D} (R^{2} - 0^{2}) = C_{0} - \\frac{q R^{2}}{6D}\n$$\n令 $C(0)=0$ 并将半径记为 $R_{\\text{max}}$：\n$$\n0 = C_{0} - \\frac{q R_{\\text{max}}^{2}}{6D}\n$$\n解出 $R_{\\text{max}}$：\n$$\n\\frac{q R_{\\text{max}}^{2}}{6D} = C_{0}\n$$\n$$\nR_{\\text{max}}^{2} = \\frac{6D C_{0}}{q}\n$$\n$$\nR_{\\text{max}} = \\sqrt{\\frac{6D C_{0}}{q}}\n$$\n这就是在类器官中心氧气完全耗尽前的最大半径的解析表达式。", "answer": "$$\\boxed{\\sqrt{\\frac{6DC_{0}}{q}}}$$", "id": "2659228"}, {"introduction": "在克服了基本的物理限制之后，下一个核心问题是，细胞是如何遵循内在的“程序”来自我组织成复杂结构的？这个练习将我们带入发育生物学的经典领域——遗传通路分析。通过分析一系列假想的基因敲除实验数据（包括单基因和双基因敲除），你将学习如何运用遗传互作逻辑，如上位性（epistasis）、协同致死（synthetic loss-of-function）和遗传抑制（suppression），来重建控制类器官形态发生（如中央管腔形成）的基因调控网络[@problem_id:2659255]。这种从表型推断分子通路的逻辑推理能力，是每一位发育生物学研究者的基本功。", "problem": "您正在研究嵌入细胞外基质中的多能干细胞衍生的自组织类器官中的管腔形态发生。在野生型 (WT) 培养物中，上皮球状体在早期形态发生过程中极化并形成一个单一的中央管腔。此处的相关基本原理包括：管腔形成通常需要建立顶-基底极性 (apical-basal polarity) 和形成顶膜起始位点 (apical membrane initiation site, AMIS)，通过连接封闭 (junctional sealing) 将顶膜域与基底外侧域分开，通过囊泡运输 (vesicle trafficking) 进行靶向的顶膜递送，以及随后由离子转运和水内流驱动的液体积聚；遗传上位性 (genetic epistasis) 是根据单一和组合扰动中的表型显性推断出来的，当上游步骤被阻断时，上游组分会使下游缺陷不可见；双重扰动中的合成性缺失 (synthetic loss) 表明存在平行的、部分冗余的通路汇集于一个共同过程；遗传抑制 (genetic suppression) 可以指示作用于下游定量输出（如管腔扩张）的拮抗通路。\n\n您为五个调控因子（A、B、C、D 和 E）生成了功能缺失的类器官。它们的分子身份对您来说是未知的，但您从现有文献中得知，管腔起始需要极性和连接组织，而扩张则依赖于由皮层收缩性 (cortical contractility) 对抗的离子驱动的液体转运。您使用顶膜标记物、连接标记物和管腔形态来评估表型。定性表型如下。\n\n单一扰动：\n- A 敲除：无序的上皮团块，无可见的顶膜富集，无连续的连接带，无管腔。\n- B 敲除：极化的上皮，具有不连续的连接和多个未能合并成单一中央管腔的小微管腔。\n- C 敲除：极化的上皮，具有正常的连接带，但有异位的顶膜灶点和多个未能合并的微管腔。\n- D 敲除：极化的上皮，有一个单一的中央管腔，但该管腔起始后保持很小且未能扩张。\n- E 敲除：极化的上皮，有一个单一的中央管腔，相对于野生型该管腔增大，这与对抗管腔扩张的皮层收缩减弱相符。\n\n双重扰动：\n- A 与 B 双敲除：与单独敲除 A 的表型无法区分。\n- A 与 C 双敲除：与单独敲除 A 的表型无法区分。\n- A 与 D 双敲除：与单独敲除 A 的表型无法区分。\n- A 与 E 双敲除：与单独敲除 A 的表型无法区分。\n- B 与 C 双敲除：无序的极化上皮，无可见的管腔起始。\n- B 与 D 双敲除：多个未能合并的小微管腔，与单独敲除 B 的表型相似。\n- C 与 D 双敲除：多个未能合并的小微管腔，与单独敲除 C 的表型相似。\n- B 与 E 双敲除：极化的上皮，有多个保持分离的微管腔；微管腔比单独敲除 B 时稍大，但未形成单一的中央管腔。\n- C 与 E 双敲除：极化的上皮，有多个保持分离的微管腔；微管腔比单独敲除 C 时稍大，但未形成单一的中央管腔。\n- D 与 E 双敲除：极化的上皮，有一个大小与野生型近似的单一中央管腔。\n\n仅使用上述定义以及上位性和通路拓扑推断的逻辑，选择与所有观察结果一致的最小通路布线。“最小”意味着没有超出解释数据所需的、多余的节点或边；仅在必要时才应援引平行关系。\n\nA. A 作用于 B 和 C 的上游以促成管腔起始；B 和 C 代表平行的、部分冗余的模块，当其中一个缺失时，另一个可以支持管腔起始，并且两者都汇聚于一个管腔起始节点。D 和 E 作用于该起始节点的下游来调控管腔扩张，其中 D 促进液体驱动的扩张，E 通过收缩性对抗扩张；D 和 E 平行作用于扩张过程，并可以相互抗衡。\n\nB. B 作用于 A 的上游以控制整体上皮极性；C 在线性序列中作用于 A 的下游，D 作用于 B 和 C 之间以触发管腔起始；E 作用于所有因子的上游，通过设定组织力学来决定是否能建立极性。\n\nC. A、B、C、D 和 E 按照 A、B、C、D、E 的顺序在一个单一的线性序列中起作用，每一步都严格为下一步所必需，没有平行或拮抗的分支。\n\nD. B 和 C 作用于 A 的上游以产生顶膜极性；A 和 D 平行作用于管腔起始；E 作用于下游以扩张管腔，并且是扩张所必需的。\n\nE. A 仅在 D 的下游作用于管腔扩张；B 和 C 冗余地驱动离子转运；E 作用于 B 和 C 的上游以促进对极性和起始至关重要的连接封闭，而 D 作用于极性建立。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知信息**\n- **系统**：来自多能干细胞的自组织 $3D$ 类器官。\n- **过程**：上皮球状体中的管腔形态发生。\n- **野生型 (WT) 表型**：具有单一中央管腔的极化上皮球状体。\n- **关键原理**：\n    1. 管腔形成涉及：顶-基底极性、顶膜起始位点 (AMIS) 形成、连接封闭、囊泡运输，以及通过离子转运和水内流实现的液体积聚。\n    2. 遗传上位性：上游组分的敲除表型会掩盖下游组分的敲除表型。\n    3. 合成性缺失：对平行的、冗余的通路进行双重扰动，会导致比任一单一扰动更严重的表型。\n    4. 遗传抑制：双突变体的表型比单突变体表型更弱，这表明存在拮抗通路。\n- **调控因子**：五个基因，表示为 $A$、$B$、$C$、$D$ 和 $E$。\n- **先验知识**：管腔起始需要极性和连接。管腔扩张依赖于由皮层收缩性对抗的离子驱动的液体转运。\n\n- **单一扰动表型**：\n    - $A$ 敲除 ($A^-$)：无序的上皮团块，无顶膜富集，无连续连接，无管腔。\n    - $B$ 敲除 ($B^-$)：极化的上皮，不连续的连接，多个未能合并的小微管腔。\n    - $C$ 敲除 ($C^-$)：极化的上皮，正常的连接，异位的顶膜灶点，多个未能合并的微管腔。\n    - $D$ 敲除 ($D^-$)：极化的上皮，单一中央管腔，但未能扩张（保持很小）。\n    - $E$ 敲除 ($E^-$)：极化的上皮，单一中央管腔，但比 WT 增大。\n\n- **双重扰动表型**：\n    - $A^- B^-$：与单独的 $A^-$ 无法区分。\n    - $A^- C^-$：与单独的 $A^-$ 无法区分。\n    - $A^- D^-$：与单独的 $A^-$ 无法区分。\n    - $A^- E^-$：与单独的 $A^-$ 无法区分。\n    - $B^- C^-$：无序的极化上皮，无可见的管腔起始。\n    - $B^- D^-$：多个小微管腔，与单独的 $B^-$ 相似。\n    - $C^- D^-$：多个小微管腔，与单独的 $C^-$ 相似。\n    - $B^- E^-$：多个微管腔，比单独的 $B^-$ 中稍大。\n    - $C^- E^-$：多个微管腔，比单独的 $C^-$ 中稍大。\n    - $D^- E^-$：大小与野生型近似的单一中央管腔。\n\n**步骤2：使用提取的已知信息进行验证**\n根据验证标准对问题进行评估。\n- **科学依据充分**：该问题描述了一项在类器官形态发生背景下的经典遗传相互作用研究，这是发育生物学的一个关键课题。所使用的概念——顶-基底极性、连接复合体、管腔形成、上位性、合成性相互作用和抑制——都是遗传学和细胞生物学的基本原理。所描述的表型是合理的，并且在此类研究中很常见。该问题在科学上是合理的。\n- **定义明确**：该问题提供了一套完整的定性数据（单一和双重敲除的表型），并要求逻辑推断出与所有数据一致的通路模型。这是一个定义明确的逻辑问题，根据遗传相互作用的标准解释，在选项中有唯一解。\n- **客观**：表型描述虽然是定性的，但被表述为客观观察（“无序的”、“多个小微管腔”）。解释遗传相互作用的规则已明确提供。该问题不含主观论断。\n\n**步骤3：结论和行动**\n问题陈述有效。这是一个在生物通路推断方面定义明确且有科学依据的问题。我将继续进行解答。\n\n**通路的推导**\n\n该解答需要根据遗传相互作用分析的规则，通过解释所提供的单一和双重敲除表型，来构建一个最小的管腔形态发生遗传通路。\n\n1. **基因 A 的定位**：\n    - $A^-$ 单一敲除的表型最为严重：完全无法形成极化的上皮，导致无序的团块且没有管腔。这表明 A 作用于所观察到的最早步骤，即建立基本的上皮极性和组织。\n    - 在所有涉及 $A$ 的双重敲除（$A^-B^-$、$A^-C^-$、$A^-D^-$、$A^-E^-$）中，表型与 $A^-$ 单一敲除相同。这是**上位性**的定义。基因 $A$ 对基因 $B$、$C$、$D$ 和 $E$ 具有上位性。这证实了 $A$ 在通路中作用于所有其他基因的上游。如果建立极性的初始步骤失败，那么后续步骤（如管腔起始或扩张）的缺陷就无法被观察到。\n    - 结论：$A$ 是最上游的调控因子，对上皮极性至关重要。\n\n2. **基因 B 和 C 之间的关系**：\n    - 单一敲除 $B^-$ 和 $C^-$ 都会产生具有多个微管腔的极化上皮。这表明极性已经建立，但形成单一中央管腔的过程存在缺陷。$B$ 似乎与连接的连续性有关，而 $C$ 则与限制顶膜域的位置有关。两种缺陷都导致了相似的结果：多个管腔而非一个。\n    - 双重敲除 $B^-C^-$ 导致“无序的极化上皮，无可见的管腔起始”。该表型显著重于任一单一敲除。这是**合成性功能缺失**（或在发育背景下的合成致死）的经典例子。它意味着 $B$ 和 $C$ 在平行的、部分冗余的通路中起作用。当其中一个缺失时，另一个可以部分补偿以允许形成一些管腔。当两者都缺失时，它们所控制的过程——管腔起始——完全失败。\n    - 结论：$B$ 和 $C$ 在 $A$ 的下游以平行方式作用，以确保形成单一管腔。\n\n3. **基因 D 的定位**：\n    - $D^-$ 单一敲除产生一个单一的小管腔。这意味着极性、连接形成和单一管腔起始都是成功的，但随后的管腔扩张存在缺陷。这将 $D$ 定位在管腔扩张阶段。文献背景表明 $D$ 促进扩张，可能通过离子转运和液体内流。\n    - $B^-D^-$ 双重敲除的表型与 $B^-$（多个小管腔）相同。这表明 $B$ 对 $D$ 具有上位性。未能合并成单一管腔（$B^-$ 缺陷）妨碍了观察其扩张的缺陷（$D^-$ 缺陷）。\n    - 同样，$C^-D^-$ 双重敲除的表型与 $C^-$ 相同。$C$ 对 $D$ 具有上位性。\n    - 结论：$D$ 作用于 $B$ 和 $C$ 的下游，特别是在管腔起始和合并之后的管腔扩张阶段。$D$ 是管腔扩张的正调控因子。\n\n4. **基因 E 的定位**：\n    - $E^-$ 单一敲除导致一个单一的、增大的管腔。这意味着 $E$ 通常作用于限制或对抗管腔扩张。文献背景表明这是通过皮层收缩性实现的。\n    - $B^-E^-$ 和 $C^-E^-$ 双重敲除显示出累加表型。例如，在 $B^-E^-$ 中，存在多个管腔（$B^-$ 表型），并且它们比单独的 $B^-$ 中的要大（$E^-$ 表型）。这意味着 $B$（管腔数量）和 $E$（管腔大小）的功能是可分离的，并且发生时一个不会掩盖另一个。这与 B 作用于起始/合并，而 E 作用于后续形成的任何管腔的扩张是一致的。\n    - 结论：$E$ 是管腔扩张的负调控因子，作用于管腔起始的下游。\n\n5. **基因 D 和 E 之间的关系**：\n    - $D^-E^-$ 双重敲除导致一个大小与野生型近似的管腔。$D^-$ 表型是小管腔（扩张失败），而 $E^-$ 表型是大管腔（过度扩张）。在双突变体中恢复到接近野生型的表型是**遗传抑制**的经典案例。\n    - 这表明 $D$ 和 $E$ 具有作用于同一过程（管腔大小控制）的相反（拮抗）功能。$D$ 促进扩张，而 $E$ 抑制扩张。当两者都被移除时，相反的力量被消除，导致一个平衡的中间结果。\n    - 结论：$D$ 和 $E$ 拮抗地作用，以调控管腔扩张的最后一步。\n\n**综合通路模型**：\n基于以上分析，最小通路如下：\n1. 基因 $A$ 首先作用以建立上皮极性。\n2. 在极性的下游，基因 $B$ 和 $C$ 在平行的、部分冗余的通路中作用，以确保单一管腔的起始和合并。\n3. 在起始的下游，基因 $D$ 和 $E$ 拮抗地作用，以控制管腔扩张的程度。$D$ 是扩张的正调控因子（促进），而 $E$ 是负调控因子（抑制）。\n\n`通路: A -> 极性建立 -> (B || C) -> 单一管腔起始 -> (D 促进 <-> E 抑制) -> 管腔扩张`\n\n**逐项分析选项**\n\n- **A**：“A 作用于 B 和 C 的上游以促成管腔起始；B 和 C 代表平行的、部分冗余的模块，当其中一个缺失时，另一个可以支持管腔起始，并且两者都汇聚于一个管腔起始节点。D 和 E 作用于该起始节点的下游来调控管腔扩张，其中 D 促进液体驱动的扩张，E 通过收缩性对抗扩张；D 和 E 平行作用于扩张过程，并可以相互抗衡。”\n    - 该陈述准确反映了所有的逻辑推论。$A$ 在上游（上位性）。$B$ 和 $C$ 是平行的/冗余的（合成性相互作用）。$D$ 和 $E$ 在下游并且对扩张起拮抗作用（抑制）。术语“相互抗衡”正确描述了 $D^-E^-$ 抑制实验的结果。\n    - **结论：正确**\n\n- **B**：“B 作用于 A 的上游以控制整体上皮极性；C 在线性序列中作用于 A 的下游，D 作用于 B 和 C 之间以触发管腔起始；E 作用于所有因子的上游，通过设定组织力学来决定是否能建立极性。”\n    - “B 作用于 A 的上游”：不正确。数据显示 $A$ 对 $B$ 具有上位性。\n    - “C 在线性序列中作用于 A 的下游”：虽然 $C$ 在 $A$ 的下游，但其与 $B$ 的关系是平行的，而非线性的。\n    - “E 作用于所有因子的上游”：不正确。数据显示 $A$ 对 $E$ 具有上位性。\n    - **结论：不正确**\n\n- **C**：“A、B、C、D 和 E 按照 A、B、C、D、E 的顺序在一个单一的线性序列中起作用，每一步都严格为下一步所必需，没有平行或拮抗的分支。”\n    - “单一的线性序列”：不正确。$B^-C^-$ 的合成性相互作用证明了 $B$ 和 $C$ 之间的平行关系。$D^-E^-$ 的抑制作用证明了拮抗关系，而非简单的线性关系。\n    - **结论：不正确**\n\n- **D**：“B 和 C 作用于 A 的上游以产生顶膜极性；A 和 D 平行作用于管腔起始；E 作用于下游以扩张管腔，并且是扩张所必需的。”\n    - “B 和 C 作用于 A 的上游”：不正确。数据显示 $A$ 对 $B$ 和 $C$ 具有上位性。\n    - “A 和 D 平行作用于管腔起始”：不正确。$A$ 作用于极性，位于所有其他因子的上游。$D$ 作用于扩张，位于起始的下游。\n    - “E ... 是扩张所必需的”：不正确。$E^-$ 敲除显示过度扩张，意味着 $E$ *抑制*扩张。\n    - **结论：不正确**\n\n- **E**：“A 仅在 D 的下游作用于管腔扩张；B 和 C 冗余地驱动离子转运；E 作用于 B 和 C 的上游以促进对极性和起始至关重要的连接封闭，而 D 作用于极性建立。”\n    - “A 作用于 ... D 的下游”：不正确。$A$ 是最上游的基因，是极性所必需的。其表型远比 $D^-$ 表型严重。\n    - “B 和 C 冗余地驱动离子转运”：不正确。离子转运与管腔扩张有关，这是 $D$ 的功能。$B$ 和 $C$ 参与管腔的起始/合并。\n    - “E 作用于 B 和 C 的上游”：不正确。表型是累加的，并且 $A$ 位于所有这些因子的上游。\n    - **结论：不正确**", "answer": "$$\\boxed{A}$$", "id": "2659255"}, {"introduction": "现代类器官研究产生了海量的复杂数据，尤其是单细胞转录组数据，如何从中提取有意义的生物学见解是一项关键挑战。本练习聚焦于细胞发育轨迹的计算分析，这是一个前沿且重要的领域。你将学习如何应用信息论中的互信息（mutual information, $\\hat{I}(T;X)$）来量化基因表达与发育“伪时间”（pseudotime）之间的依赖关系，并将其与单调性指标（如Spearman相关系数, $\\hat{\\rho}_S$）进行比较，从而识别出发育过程中的关键分岔点[@problem_id:2659223]。这项实践旨在训练你从高维数据中发现非线性关系和细胞命运决定事件的计算思维和数据分析技能。", "problem": "您正在分析类器官系统中的分化轨迹，其中干细胞衍生的细胞沿着发育路径自组织。在此类系统中，基因模块得分（功能相关基因的信使核糖核酸(mRNA)表达量的集合）通常会随着一种称为伪时间的推断发育顺序而变化。当不同的亚谱系表现出相反的趋势时，一个谱系分支点预计会在基因模块和伪时间之间产生非单调的依赖关系。您将从第一性原理出发，形式化一个定量测试，该测试将一个信息论依赖性度量与一个单调性度量进行比较，并标记出依赖性超过单调性的程度达到一个阈值的情况，将此解释为存在分支点的证据。\n\n使用的基本原理：\n- 分子生物学中心法则：基因表达是受调控的，并可通过mRNA丰度进行量化；基因模块概括了共调控的基因集。\n- 伪时间的核心定义：沿着推断的发育轴对细胞进行的排序，被视为一个标量潜变量。\n- 信息论中熵和互信息的定义。\n- 基于秩的相关性，作为单调关联的度量。\n\n数学定义与所需计算：\n- 给定长度均为 $n$ 的配对数组：伪时间 $T = (t_1,\\dots,t_n)$ 和基因模块得分 $X = (x_1,\\dots,x_n)$，通过在每个轴上离散化为 $b$ 个区间来构建经验联合分布，其中 $b = \\max\\{4,\\lfloor \\sqrt{n} \\rfloor\\}$，且区间边缘在观测范围 $[\\min(T),\\max(T)]$ 和 $[\\min(X),\\max(X)]$ 内等距分布。设 $\\hat{p}_{ij}$ 为第 $i$ 个 $T$ 区间和第 $j$ 个 $X$ 区间的经验联合概率，$\\hat{p}_{i\\cdot}$ 和 $\\hat{p}_{\\cdot j}$ 为相应的边际概率。\n- 计算经验互信息（使用自然对数）如下\n$$\n\\hat{I}(T;X) \\;=\\; \\sum_{i=1}^{b}\\sum_{j=1}^{b} \\hat{p}_{ij} \\,\\log\\!\\left(\\frac{\\hat{p}_{ij}}{\\hat{p}_{i\\cdot}\\,\\hat{p}_{\\cdot j}}\\right),\n$$\n约定当 $\\hat{p}_{ij}=0$ 时，相应项对总和的贡献为零。\n- 计算熵\n$$\n\\hat{H}(T) \\;=\\; -\\sum_{i=1}^{b} \\hat{p}_{i\\cdot}\\,\\log \\hat{p}_{i\\cdot},\\quad\n\\hat{H}(X) \\;=\\; -\\sum_{j=1}^{b} \\hat{p}_{\\cdot j}\\,\\log \\hat{p}_{\\cdot j}.\n$$\n- 计算归一化互信息\n$$\n\\widehat{\\mathrm{NMI}} \\;=\\; \\begin{cases}\n\\frac{\\hat{I}(T;X)}{\\min\\{\\hat{H}(T),\\hat{H}(X)\\}} & \\text{if } \\min\\{\\hat{H}(T),\\hat{H}(X)\\} > 0,\\\\\n0 & \\text{otherwise}.\n\\end{cases}\n$$\n- 计算Spearman秩相关的绝对值作为单调性度量。设 $R_T$ 和 $R_X$ 分别为 $T$ 和 $X$ 的平均秩（平级值取平均秩）。设\n$$\n\\hat{\\rho}_S \\;=\\; \\mathrm{corr}(R_T, R_X),\n$$\n并取 $M \\,=\\, |\\hat{\\rho}_S|$。\n- 定义分支证据得分 $S \\;=\\; \\max\\{0,\\, \\widehat{\\mathrm{NMI}} - M\\}$。将 $S \\ge \\tau$ 解释为存在分支点的证据，其中阈值固定为 $\\tau = 0.1$。\n\n实现一个程序，对以下每个合成测试用例，根据指定流程生成 $(T,X)$，计算 $\\widehat{\\mathrm{NMI}}$ 和 $M$，然后在 $S \\ge \\tau$ 时输出整数决策 $1$，否则输出 $0$。所有随机抽样必须使用指定的种子以确保可复现性。\n\n测试套件（每个用例提供 $(n,\\sigma,\\text{seed})$ 和一个数据生成规则）：\n1. 理想路径单调模块：$n=400$, $\\sigma=0.05$, $\\text{seed}=13$。对 $k=1,\\dots,n$，独立地从 $\\mathrm{Uniform}(0,1)$ 分布中抽样 $t_k$。设 $x_k = t_k + \\epsilon_k$，其中 $\\epsilon_k \\sim \\mathcal{N}(0,\\sigma^2)$ 独立。\n2. 分叉对跖趋势（平衡）：$n=400$, $\\sigma=0.05$, $\\text{seed}=7$。对每个 $k$，从 $\\mathrm{Uniform}(0,1)$ 分布中抽样 $t_k$，并独立地从 $\\mathrm{Bernoulli}(0.5)$ 分布中抽样分支标签 $b_k$。如果 $b_k=0$，则设 $x_k = t_k + \\epsilon_k$；如果 $b_k=1$，则设 $x_k = (1 - t_k) + \\epsilon_k$，其中 $\\epsilon_k \\sim \\mathcal{N}(0,\\sigma^2)$ 独立。\n3. 空独立性：$n=400$, $\\sigma$ 未使用, $\\text{seed}=42$。对每个 $k$，独立地从 $\\mathrm{Uniform}(0,1)$ 分布中抽样 $t_k$ 和 $x_k$。\n4. 分叉对跖趋势（非平衡）：$n=400$, $\\sigma=0.05$, $\\text{seed}=99$。从 $\\mathrm{Uniform}(0,1)$ 分布中抽样 $t_k$，并从 $\\mathrm{Bernoulli}(0.7)$ 分布中抽样 $b_k$。如果 $b_k=1$，则设 $x_k = t_k + \\epsilon_k$；如果 $b_k=0$，则设 $x_k = (1 - t_k) + \\epsilon_k$，其中 $\\epsilon_k \\sim \\mathcal{N}(0,\\sigma^2)$ 独立。\n5. 伪时间中存在结的单调性：$n=120$, $\\sigma=0.05$, $\\text{seed}=21$。通过在 $[0,1]$ 中取12个等间距值，并将每个值精确重复10次，以产生 $n=120$ 个条目，来构建 $T$。独立地从 $\\mathcal{N}(0,\\sigma^2)$ 分布中抽样 $\\epsilon_k$，并设 $x_k = t_k + \\epsilon_k$。\n\n角度单位不相关。不涉及物理单位。概率必须按小数处理。所有对数均为自然对数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔的整数决策列表（例如，“[1,0,1,0,1]”）。第 $k$ 个整数对应第 $k$ 个测试用例，其中 $1$ 表示 $S \\ge \\tau$，$0$ 表示 $S < \\tau$。", "solution": "所述问题具有科学依据，定义明确且内部一致。它基于发育生物学和信息论的既定原则提出了一个清晰的问题，并为可复现的计算解决方案提供了所有必要的数学定义和参数。因此，该问题被认为是有效的。以下是所需算法的详细阐述。\n\n目标是实现一个定量测试，用于识别发育轨迹数据中潜在的谱系分支点。数据由伪时间 $T$ 和基因模块得分 $X$ 的配对观测值组成。核心假设是，分支点会在 $T$ 和 $X$ 之间引发一种强但非单调的关系。这可以通过比较总统计依赖性度量——归一化互信息（$\\widehat{\\mathrm{NMI}}$）与单调关联度量——Spearman秩相关的绝对值（$M$）来进行量化。一个大的正差值 $S = \\widehat{\\mathrm{NMI}} - M$ 被解释为存在分支的证据。\n\n每个测试用例的流程如下：\n\n首先，根据该用例的指定规则生成配对数据数组 $T = (t_1, \\dots, t_n)$ 和 $X = (x_1, \\dots, x_n)$。每个生成过程都使用特定的整数作为种子，以确保随机抽样的可复现性。\n\n其次，将连续数据 $(T, X)$ 离散化以估计经验联合概率分布。每个变量的区间数 $b$ 由样本大小 $n$ 决定，即 $b = \\max\\{4, \\lfloor \\sqrt{n} \\rfloor\\}$。对于一个给定样本大小为 $n$ 的测试用例，$T$ 的范围 $[\\min(T), \\max(T)]$ 和 $X$ 的范围 $[\\min(X), \\max(X)]$ 都被划分为 $b$ 个等距的区间。构建一个二维直方图，得到一个 $b \\times b$ 的计数矩阵。将这些计数除以数据点总数 $n$ 进行归一化，得到经验联合概率矩阵 $\\hat{P} = (\\hat{p}_{ij})$，其中 $\\hat{p}_{ij}$ 是一个数据点落入 $T$ 的第 $i$ 个区间和 $X$ 的第 $j$ 个区间的概率。然后，通过分别对 $\\hat{P}$ 的行和列求和来计算经验边际概率 $\\hat{p}_{i\\cdot} = \\sum_{j=1}^{b} \\hat{p}_{ij}$ 和 $\\hat{p}_{\\cdot j} = \\sum_{i=1}^{b} \\hat{p}_{ij}$。\n\n第三，从这些概率中计算信息论量。离散化变量的经验熵由以下公式给出：\n$$\n\\hat{H}(T) = -\\sum_{i=1}^{b} \\hat{p}_{i\\cdot}\\,\\log \\hat{p}_{i\\cdot}\n$$\n$$\n\\hat{H}(X) = -\\sum_{j=1}^{b} \\hat{p}_{\\cdot j}\\,\\log \\hat{p}_{\\cdot j}\n$$\n联合熵为：\n$$\n\\hat{H}(T, X) = -\\sum_{i=1}^{b}\\sum_{j=1}^{b} \\hat{p}_{ij}\\,\\log \\hat{p}_{ij}\n$$\n在这些求和中，概率为 $0$ 的项被视为 $0$，这遵循极限 $\\lim_{p\\to 0^+} p\\log p = 0$。经验互信息 $\\hat{I}(T;X)$ 衡量了在已知一个变量的情况下另一个变量不确定性的减少量，其计算公式为：\n$$\n\\hat{I}(T;X) = \\hat{H}(T) + \\hat{H}(X) - \\hat{H}(T, X)\n$$\n然后将该值归一化，以产生一个介于 $0$ 和 $1$ 之间的得分：\n$$\n\\widehat{\\mathrm{NMI}} = \\begin{cases}\n\\frac{\\hat{I}(T;X)}{\\min\\{\\hat{H}(T),\\hat{H}(X)\\}} & \\text{if } \\min\\{\\hat{H}(T),\\hat{H}(X)\\} > 0, \\\\\n0 & \\text{otherwise}.\n\\end{cases}\n$$\n\n第四，计算单调依赖性度量 $M$。这是Spearman等级相关系数 $\\hat{\\rho}_S$ 的绝对值。数组 $T$ 和 $X$ 都被转换成秩 $R_T$ 和 $R_X$。对于存在结（相同值）的情况，分配平均秩。系数 $\\hat{\\rho}_S$ 随后是这些秩数组的Pearson相关系数：$\\hat{\\rho}_S = \\mathrm{corr}(R_T, R_X)$。单调性度量为 $M = |\\hat{\\rho}_S|$。\n\n最后，分支证据得分 $S$ 计算为总依赖性超出单调依赖性的量：\n$$\nS = \\max\\{0, \\widehat{\\mathrm{NMI}} - M\\}\n$$\n将该得分与固定阈值 $\\tau = 0.1$ 进行比较。如果 $S \\ge \\tau$，则认为存在分支点的证据，该测试用例的决策为 $1$。否则，决策为 $0$。\n\n将这整个流程系统地应用于五个指定的测试用例中的每一个，以生成最终的二进制决策列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import spearmanr\n\ndef solve():\n    \"\"\"\n    Solves the problem by analyzing synthetic gene expression data for branch points.\n    \n    For each test case, the function:\n    1. Generates pseudotime (T) and gene module score (X) data based on specified rules.\n    2. Computes the number of bins 'b' for discretization.\n    3. Discretizes the data and calculates the joint and marginal probability distributions.\n    4. Computes entropies H(T), H(X), and mutual information I(T;X).\n    5. Calculates the Normalized Mutual Information (NMI).\n    6. Computes the absolute Spearman rank correlation 'M'.\n    7. Calculates the branch-evidence score S = max(0, NMI - M).\n    8. Makes a decision (1 if S >= 0.1, else 0).\n    The final output is a list of these decisions for all test cases.\n    \"\"\"\n    \n    test_cases = [\n        {'name': 'monotonic', 'n': 400, 'sigma': 0.05, 'seed': 13, 'rule': 1},\n        {'name': 'bifurcating_balanced', 'n': 400, 'sigma': 0.05, 'seed': 7, 'rule': 2},\n        {'name': 'null_independence', 'n': 400, 'sigma': None, 'seed': 42, 'rule': 3},\n        {'name': 'bifurcating_unbalanced', 'n': 400, 'sigma': 0.05, 'seed': 99, 'rule': 4},\n        {'name': 'monotonic_with_ties', 'n': 120, 'sigma': 0.05, 'seed': 21, 'rule': 5},\n    ]\n\n    tau = 0.1\n    results = []\n\n    for case in test_cases:\n        n = case['n']\n        sigma = case['sigma']\n        seed = case['seed']\n        rule = case['rule']\n        \n        rng = np.random.default_rng(seed)\n\n        # Step 1: Generate data (T, X)\n        if rule == 1:\n            # Happy-path monotonic module\n            T = rng.uniform(0, 1, n)\n            eps = rng.normal(0, sigma, n)\n            X = T + eps\n        elif rule == 2:\n            # Bifurcating antipodal trends (balanced)\n            T = rng.uniform(0, 1, n)\n            b_k = rng.binomial(1, 0.5, n)\n            eps = rng.normal(0, sigma, n)\n            X = np.where(b_k == 0, T, 1 - T) + eps\n        elif rule == 3:\n            # Null independence\n            T = rng.uniform(0, 1, n)\n            X = rng.uniform(0, 1, n)\n        elif rule == 4:\n            # Bifurcating antipodal trends (unbalanced)\n            T = rng.uniform(0, 1, n)\n            b_k = rng.binomial(1, 0.7, n)\n            eps = rng.normal(0, sigma, n)\n            # b_k=1 -> monotonic, b_k=0 -> anti-monotonic\n            X = np.where(b_k == 1, T, 1 - T) + eps\n        elif rule == 5:\n            # Monotonic with ties in pseudotime\n            t_vals = np.linspace(0, 1, 12)\n            T = np.repeat(t_vals, 10)\n            eps = rng.normal(0, sigma, n)\n            X = T + eps\n\n        # Step 2: Discretize and compute probabilities\n        b = max(4, int(np.floor(np.sqrt(n))))\n        \n        # Define bin edges to be inclusive of max values\n        t_bins = np.linspace(T.min(), T.max(), b + 1)\n        x_bins = np.linspace(X.min(), X.max(), b + 1)\n        \n        counts, _, _ = np.histogram2d(T, X, bins=[t_bins, x_bins])\n        \n        p_ij = counts / n\n\n        # Step 3: Compute information-theoretic quantities\n        # Marginals\n        p_i = np.sum(p_ij, axis=1)\n        p_j = np.sum(p_ij, axis=0)\n\n        # Entropies H(T), H(X), H(T,X)\n        h_t = -np.sum(p_i * np.log(p_i, out=np.zeros_like(p_i), where=p_i > 0))\n        h_x = -np.sum(p_j * np.log(p_j, out=np.zeros_like(p_j), where=p_j > 0))\n        h_tx = -np.sum(p_ij * np.log(p_ij, out=np.zeros_like(p_ij), where=p_ij > 0))\n        \n        # Mutual Information I(T;X)\n        mi = h_t + h_x - h_tx\n\n        # Normalized Mutual Information (NMI)\n        min_h = min(h_t, h_x)\n        nmi = mi / min_h if min_h > 0 else 0\n\n        # Step 4: Compute monotonicity measure M\n        rho_s, _ = spearmanr(T, X)\n        M = np.abs(rho_s)\n\n        # Step 5: Compute branch-evidence score S and decide\n        S = max(0, nmi - M)\n        decision = 1 if S >= tau else 0\n        results.append(decision)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2659223"}]}