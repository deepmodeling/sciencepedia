{"hands_on_practices": [{"introduction": "合成胚胎模型，如同其天然对应物，依赖于被称为形态发生素的信号分子的空间梯度来调控模式形成。反应-扩散模型提供了一个强大的数学框架，用以理解形态发生素（如 Wnt）的局部源如何在组织中建立稳定的浓度梯度。本练习 [@problem_id:2676456] 将指导您推导并应用特征长度尺度（$\\lambda$）这一概念，它是一个决定了形态发生素有效作用范围及其为类原肠胚等发育中结构建立图案能力的基本参数。", "problem": "在类囊胚和类原腸胚等合成胚胎模型中，可扩散的形态发生素有助于建立空间模式。考虑将Wingless/Integrated (Wnt) 作为一种在细胞聚集体中经历菲克扩散和一级降解的可扩散形态发生素。设其浓度场由以下反应扩散偏微分方程（PDE）控制\n$$\n\\frac{\\partial c(\\mathbf{x},t)}{\\partial t} \\;=\\; D\\,\\nabla^{2} c(\\mathbf{x},t) \\;-\\; k\\,c(\\mathbf{x},t) \\;+\\; s(\\mathbf{x},t),\n$$\n其中，$c(\\mathbf{x},t)$ 是浓度，$D$ 是扩散系数，$k$ 是一级降解速率，$s(\\mathbf{x},t)$ 是源项。在稳态且远离源的情况下，空间分布由该方程产生的一个特征长度尺度决定。\n\n(a) 从该方程的稳態、无源形式出发，推导Wnt的特征稳态扩散长度尺度（用 $D$ 和 $k$ 表示）。说明你所作的任何假设。\n\n(b) 对于一个由局部Wnt源供给的直径为 $300\\,\\mu\\mathrm{m}$ 的类原肠胚球形聚集体，使用你推导出的长度尺度来判断单个局部源能否在整个聚集体上形成梯度，还是主要在局部邻域内形成梯度。根据跨越聚集体的特征长度数量来证明你的推理。\n\n给定参数值 $D_{W} = 80\\,\\mu\\mathrm{m}^{2}\\!/\\mathrm{min}$ 和 $k_{W} = 0.02\\,\\mathrm{min}^{-1}$，计算Wnt的特征稳态扩散长度的数值。最终值以微米表示，并四舍五入到 $3$ 位有效数字。仅报告长度的数值（不带单位）作为最终答案。", "solution": "该问题要求从给定的反应扩散方程推导并应用特征长度尺度。我们从控制形态发生素浓度 $c(\\mathbf{x},t)$ 的偏微分方程（PDE）开始：\n$$\n\\frac{\\partial c(\\mathbf{x},t)}{\\partial t} \\;=\\; D\\,\\nabla^{2} c(\\mathbf{x},t) \\;-\\; k\\,c(\\mathbf{x},t) \\;+\\; s(\\mathbf{x},t)\n$$\n这里，$D$ 是扩散系数，$k$ 是一级降解速率，$s(\\mathbf{x},t)$ 是源项。\n\n(a) 为了推导特征稳态扩散长度尺度，我们应用问题陳述中指定的条件。首先，我们假设系统已达到稳态，这意味着浓度不再随时间变化。在数学上，这对应于将时间导数设为零：\n$$\n\\frac{\\partial c}{\\partial t} = 0\n$$\n其次，我们考虑在远离形态发生素源的区域，源项可以忽略不计：\n$$\ns(\\mathbf{x},t) = 0\n$$\n将这两个条件应用于控制PDE，可将其简化为以下不依赖时间、无源的方程：\n$$\nD\\,\\nabla^{2} c(\\mathbf{x}) \\;-\\; k\\,c(\\mathbf{x}) = 0\n$$\n这可以重写为：\n$$\n\\nabla^{2} c(\\mathbf{x}) = \\frac{k}{D} c(\\mathbf{x})\n$$\n这是亥姆霍兹方程的一种形式。我们记为 $\\lambda$ 的特征长度尺度是该方程解所变化的内在空间尺度。我们可以通过量纲分析或对方程进行无量纲化来确定该尺度。让我们通过引入无量纲坐标 $\\tilde{\\mathbf{x}} = \\mathbf{x}/\\lambda$ 来对空间坐标 $\\mathbf{x}$ 进行无量纲化。根据微分的链式法则，可得 $\\nabla_{\\mathbf{x}} = (1/\\lambda)\\nabla_{\\tilde{\\mathbf{x}}}$，因此拉普拉斯算子变换为 $\\nabla_{\\mathbf{x}}^2 = (1/\\lambda^2)\\nabla_{\\tilde{\\mathbf{x}}}^2$。將此代入簡化的PDE $D\\,\\nabla^{2} c - k c = 0$ 中，得到：\n$$\nD \\left( \\frac{1}{\\lambda^2} \\nabla_{\\tilde{\\mathbf{x}}}^{2} c \\right) - k c = 0\n$$\n重新整理该方程以组合无量纲项，得到：\n$$\n\\nabla_{\\tilde{\\mathbf{x}}}^{2} c - \\frac{k \\lambda^2}{D} c = 0\n$$\n为使该方程处于其标准的无量纲形式，第二项的系数必须为1。因此，我们通过设定以下条件来定义特征长度 $\\lambda$：\n$$\n\\frac{k \\lambda^2}{D} = 1\n$$\n求解 $\\lambda$ 得到特征稳态扩散长度尺度：\n$$\n\\lambda = \\sqrt{\\frac{D}{k}}\n$$\n此推導中作出的主要假設是：\n$1$. 系统处于稳态，即 $\\frac{\\partial c}{\\partial t} = 0$。\n$2$. 分析在无源区域进行，即 $s(\\mathbf{x},t) = 0$。\n$3$. 介质是均匀且各向同性的，这意味着扩散系数 $D$ 和降解速率 $k$ 在空间中是常数且与方向无关。\n\n(b) 我们需要评估一个局部Wnt源能否在一个直径为 $L_{agg} = 300\\,\\mu\\mathrm{m}$ 的球形聚集体上建立梯度，或者其影响是否局限于局部邻域。这需要将聚集体的大小与特征长度尺度 $\\lambda$ 进行比较。我们将首先使用给定的Wnt参数计算 $\\lambda$ 的数值：$D_W = 80\\,\\mu\\mathrm{m}^{2}\\!/\\mathrm{min}$ 和 $k_W = 0.02\\,\\mathrm{min}^{-1}$。\n\n将这些值代入我们推导出的 $\\lambda$ 表达式中：\n$$\n\\lambda_W = \\sqrt{\\frac{D_W}{k_W}} = \\sqrt{\\frac{80\\,\\mu\\mathrm{m}^2/\\mathrm{min}}{0.02\\,\\mathrm{min}^{-1}}} = \\sqrt{4000\\,\\mu\\mathrm{m}^2} = \\sqrt{400 \\times 10}\\,\\mu\\mathrm{m} = 20\\sqrt{10}\\,\\mu\\mathrm{m}\n$$\n其数值为：\n$$\n\\lambda_W \\approx 63.2455...\\,\\mu\\mathrm{m}\n$$\n四舍五入到 $3$ 位有效数字，特征长度为 $63.2\\,\\mu\\mathrm{m}$。\n\n该长度尺度 $\\lambda$ 代表了形态发生素浓度衰减到其初始值 $1/e$（$e \\approx 2.718$）的大致距离。为了评估梯度的跨度，我们计算聚集体直径与该特征长度的比率：\n$$\n\\text{Ratio} = \\frac{L_{agg}}{\\lambda_W} = \\frac{300\\,\\mu\\mathrm{m}}{63.2\\,\\mu\\mathrm{m}} \\approx 4.75\n$$\n类原肠胚的直径大约是Wnt特征扩散长度的 $4.75$ 倍。这意味着存在一个陡峭的浓度梯度。在一个简化的一维几何模型中，远离位于 $x=0$ 的源的浓度分布会按照 $c(x) = c_0 \\exp(-x/\\lambda_W)$ 的形式衰减。位于聚集体直径另一端的细胞（距离源的距离为 $L_{agg} = 300\\,\\mu\\mathrm{m}$）将感受到浓度为 $c(300) = c_0 \\exp(-300/63.2) \\approx c_0 \\exp(-4.75) \\approx 0.0087 c_0$。\n\n该浓度低于源附近浓度的 $1\\%$。在生物系统中，如此低的浓度通常低于引发细胞反应所需的阈值。因此，形态发生素的有效信号范围被限制在几个特征长度之内（例如，在 $2\\lambda_W \\approx 126\\,\\mu\\mathrm{m}$ 至 $3\\lambda_W \\approx 190\\,\\mu\\mathrm{m}$ 的范围内），超出此范围，浓度可以忽略不计。因此，单个局部源主要在源的局部邻域内施加具有生理学意义的梯度，而不是在整个聚集体上。远离源的区域将经历一个均匀低、很可能不具功能的Wnt浓度。\n\n最后，我们报告所要求的数值。如上所计算，特征长度尺度是：\n$$\n\\lambda_W = 20\\sqrt{10}\\,\\mu\\mathrm{m} \\approx 63.2\\,\\mu\\mathrm{m}\n$$", "answer": "$$\n\\boxed{63.2}\n$$", "id": "2676456"}, {"introduction": "合成胚胎模型虽然功能强大，但其生长和复杂性受到基本物理定律的制约，尤其是营养和氧气的扩散。随着这些三维结构尺寸的增加，其内部细胞将面临缺氧和营养不足的风险，这可能导致细胞死亡和发育异常。本练习 [@problem_id:2676424] 提供了一个情境，让您能定量地评估球形类原肠胚内部的氧气扩散极限，并计算在特定培养条件下是否可能形成坏死或“缺氧”的核心。", "problem": "一个拟胚体（一种模拟植入后早期模式形成的合成胚胎模型）在充分混合的培养基中作为自由悬浮球体进行培养。考虑一个直径为 $600~\\mu\\text{m}$、由 $10{,}000$ 个细胞组成的球形拟胚体。每个细胞以 $q = 5~\\text{fmol}\\cdot\\text{cell}^{-1}\\cdot\\text{s}^{-1}$ 的恒定速率消耗氧气，该速率在相关浓度范围内与氧气浓度无关。氧气在拟胚体组织中的分子扩散系数为 $D_{O_2} = 2000~\\mu\\text{m}^2\\cdot\\text{s}^{-1}$。假设培养基在拟胚体表面维持一个固定的氧气浓度（狄利克雷边界条件），其值为 $C_s = 0.200~\\text{mM}$。\n\n将稳态下拟胚体内部的氧气浓度场 $C(r)$ 视为受菲克第二定律支配，其中均匀的体积消耗率源于单个细胞的消耗速率 $q$ 和均匀分布在球形体积内的总细胞数。在球对称性下对系统进行建模，并使用适用于球体稳态的适当边界条件。\n\n将缺氧核心半径 $r_0$ 定义为满足 $C(r_0)=0$ 的最大半径（如果存在这样的半径）。仅使用第一性原理和所述假设，确定 $r_0$ 的数值（以微米为单位）。如果不存在缺氧核心，则报告 $r_0=0$。将最终数值答案四舍五入至三位有效数字。最终结果以微米表示。", "solution": "稳态下球形拟胚体内的氧气输运由反应-扩散方程描述。假设球对称性，该方程简化为：\n$$ \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 D_{O_2} \\frac{dC}{dr} \\right) - Q = 0 $$\n其中 $C(r)$ 是径向位置 $r$ 处的氧气浓度，$D_{O_2}$ 是扩散系数，$Q$ 是恒定的体积耗氧速率。由于假设 $D_{O_2}$ 是常数，方程为：\n$$ \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dC}{dr} \\right) = \\frac{Q}{D_{O_2}} $$\n首先，我们计算体积消耗速率 $Q$。$N = 10,000$ 个细胞均匀分布在半径为 $R = d/2 = 600~\\mu\\text{m} / 2 = 300~\\mu\\text{m}$ 的球体内。该球体的体积是 $V = \\frac{4}{3}\\pi R^3$。总消耗速率是 $qN$，因此体积速率是：\n$$ Q = \\frac{qN}{V} = \\frac{qN}{\\frac{4}{3}\\pi R^3} $$\n我们必须在一致的单位制下进行计算。我们选择微米（$\\mu\\text{m}$）、秒（s）和摩尔（mol）。\n给定的参数是：\n-   $R = 300~\\mu\\text{m}$\n-   $N = 10^4$ 个细胞\n-   $q = 5~\\text{fmol}\\cdot\\text{cell}^{-1}\\cdot\\text{s}^{-1} = 5 \\times 10^{-15}~\\text{mol}\\cdot\\text{cell}^{-1}\\cdot\\text{s}^{-1}$\n-   $D_{O_2} = 2000~\\mu\\text{m}^2\\cdot\\text{s}^{-1}$\n-   $C_s = 0.200~\\text{mM} = 0.200 \\times 10^{-3}~\\text{mol}\\cdot\\text{L}^{-1}$。我们将升转换为立方微米：$1~\\text{L} = 1~\\text{dm}^3 = (10^5~\\mu\\text{m})^3 = 10^{15}~\\mu\\text{m}^3$。因此，$C_s = 0.200 \\times 10^{-3}~\\text{mol} / (10^{15}~\\mu\\text{m}^3) = 2 \\times 10^{-19}~\\text{mol}\\cdot\\mu\\text{m}^{-3}$。\n\n现在，我们计算 $Q$ 的数值：\n$$ Q = \\frac{(5 \\times 10^{-15}~\\text{mol}\\cdot\\text{s}^{-1}) \\cdot 10^4}{\\frac{4}{3}\\pi (300~\\mu\\text{m})^3} = \\frac{5 \\times 10^{-11}}{\\frac{4}{3}\\pi (2.7 \\times 10^7)}~\\frac{\\text{mol}}{\\mu\\text{m}^3 \\cdot \\text{s}} = \\frac{5 \\times 10^{-11}}{3.6\\pi \\times 10^7}~\\frac{\\text{mol}}{\\mu\\text{m}^3 \\cdot \\text{s}} = \\frac{125}{9\\pi} \\times 10^{-19}~\\frac{\\text{mol}}{\\mu\\text{m}^3 \\cdot \\text{s}} $$\n我们现在求解该微分方程。重新整理并对 $r$ 积分一次：\n$$ \\frac{d}{dr} \\left( r^2 \\frac{dC}{dr} \\right) = \\frac{Q}{D_{O_2}} r^2 \\implies r^2 \\frac{dC}{dr} = \\frac{Q}{3D_{O_2}} r^3 + k_1 $$\n除以 $r^2$ 并进行第二次积分：\n$$ \\frac{dC}{dr} = \\frac{Q}{3D_{O_2}} r + \\frac{k_1}{r^2} \\implies C(r) = \\frac{Q}{6D_{O_2}} r^2 - \\frac{k_1}{r} + k_2 $$\n积分常数 $k_1$ 和 $k_2$ 由边界条件确定。\n1.  在球心（$r=0$）处，浓度必须是有限的。除非 $k_1=0$，否则 $-k_1/r$ 项会发散。这等效于物理上由于对称性导致的球心通量为零的条件，即 $\\frac{dC}{dr}|_{r=0}=0$。\n2.  在球体表面（$r=R$），浓度被指定为 $C(R)=C_s$。\n当 $k_1=0$ 时，解为 $C(r) = \\frac{Q}{6D_{O_2}} r^2 + k_2$。应用表面边界条件：\n$$ C(R) = C_s = \\frac{Q}{6D_{O_2}} R^2 + k_2 $$\n解出 $k_2$：$k_2 = C_s - \\frac{Q}{6D_{O_2}} R^2$。\n将 $k_2$ 代回，得到拟胚体内部的浓度分布：\n$$ C(r) = \\frac{Q}{6D_{O_2}} r^2 + C_s - \\frac{Q}{6D_{O_2}} R^2 = C_s - \\frac{Q}{6D_{O_2}}(R^2 - r^2) $$\n缺氧核心半径 $r_0$ 由条件 $C(r_0)=0$ 定义。根据此模型，这仅在中心浓度 $C(0)$ 小于零时才有意义。\n$$ C(0) = C_s - \\frac{QR^2}{6D_{O_2}} $$\n如果 $C(0) \\geq 0$，则不存在缺氧核心，且 $r_0=0$。如果 $C(0)  0$，则存在缺氧核心，其半径 $r_0$ 通过设置 $C(r_0) = 0$ 来求得：\n$$ 0 = C_s - \\frac{Q}{6D_{O_2}}(R^2 - r_0^2) $$\n$$ R^2 - r_0^2 = \\frac{6D_{O_2}C_s}{Q} \\implies r_0^2 = R^2 - \\frac{6D_{O_2}C_s}{Q} $$\n现在我们代入数值来计算 $r_0^2$。\n首先，计算项 $\\frac{6D_{O_2}C_s}{Q}$：\n$$ \\frac{6D_{O_2}C_s}{Q} = \\frac{6 \\cdot (2000~\\mu\\text{m}^2 \\cdot \\text{s}^{-1}) \\cdot (2 \\times 10^{-19}~\\text{mol}\\cdot\\mu\\text{m}^{-3})}{\\frac{125}{9\\pi} \\times 10^{-19}~\\text{mol}\\cdot\\mu\\text{m}^{-3} \\cdot \\text{s}^{-1}} $$\n$$ \\frac{6D_{O_2}C_s}{Q} = \\frac{2.4 \\times 10^{-15}}{\\frac{125}{9\\pi} \\times 10^{-19}}~\\mu\\text{m}^2 = \\frac{2.4 \\times 9\\pi}{125} \\times 10^4~\\mu\\text{m}^2 = \\frac{21.6\\pi}{125} \\times 10^4~\\mu\\text{m}^2 $$\n$$ \\frac{6D_{O_2}C_s}{Q} \\approx 0.542866 \\times 10^4~\\mu\\text{m}^2 = 5428.66~\\mu\\text{m}^2 $$\n现在计算 $r_0^2$：\n$$ r_0^2 = (300~\\mu\\text{m})^2 - 5428.66~\\mu\\text{m}^2 = 90000~\\mu\\text{m}^2 - 5428.66~\\mu\\text{m}^2 = 84571.34~\\mu\\text{m}^2 $$\n由于 $r_0^2 > 0$，存在缺氧核心。其半径为：\n$$ r_0 = \\sqrt{84571.34}~\\mu\\text{m} \\approx 290.8115~\\mu\\text{m} $$\n按要求将结果四舍五入到三位有效数字，得到 $r_0 = 291~\\mu\\text{m}$。\n最终结果以微米为单位提供。", "answer": "$$\n\\boxed{291}\n$$", "id": "2676424"}, {"introduction": "理解单个细胞如何解读形态发生素梯度及其他线索来做出命运决定，是发育生物学的核心目标之一。随着单细胞技术的出现，我们现在能够构建连接分子状态与细胞行为的定量模型。本练习 [@problem_id:2676393] 将提供一个参与此过程的机会：您将通过对一个假设的单细胞数据集拟合逻辑回归模型，来估计描述核内 YAP 蛋白水平如何调控细胞在类囊胚模型中分化为滋养外胚层（trophectoderm）命运的概率的参数。", "problem": "您正在研究合成胚胎模型（拟胚泡和拟原肠胚）中的谱系定型，重点关注单细胞中Yes相关蛋白（YAP）的核定位与滋养外胚层（TE）标记物表达之间的关系。在此类系统中，细胞命运决定通常可以建模为对上游转录效应子的S型响应，这与基因调控网络中经过充分检验的观察结果一致，并且二元结果可以被视为独立的伯努利试验。假设以下基础：观测结果为独立同分布的伯努利分布，其中，TE命运的概率是单个连续预测变量的logistic函数。具体来说，给定核内YAP时，TE的概率模型如下：\n$$\nP(\\mathrm{TE}\\mid \\mathrm{YAP}=y)=\\frac{1}{1+\\exp[-k(y - Y_0)]},\n$$\n其中，$k$ 是斜率参数，$Y_0$ 是TE概率为 $0.5$ 时的YAP强度。设每个细胞 $i$ 具有一个测得的YAP强度 $x_i$ 和一个二元TE标签 $t_i \\in \\{0,1\\}$。假设细胞间相互独立，并使用伯努利模型下的最大似然估计来推断参数。为了进行数值优化，请根据需要将logistic函数表示为标准线性预测变量形式 $z_i = a x_i + b$，但最终答案必须以 $k$ 和 $Y_0$ 的形式报告。\n\n任务：\n- 对于下文测试套件中的每个数据集，从中心性初始条件开始，使用稳定的数值方法，通过最大化上述模型所蕴含的伯努利对数似然来估计 $k$ 和 $Y_0$。不要假设对真实参数有任何先验知识。\n- 您可以使用任何数学上等价的参数化形式进行优化，但您必须报告由模型 $P(\\mathrm{TE}\\mid \\mathrm{YAP}=y)=1/(1+\\exp[-k(y - Y_0)])$ 定义的 $k$ 和 $Y_0$。如果您拟合了带有线性预测变量 $z_i=a x_i + b$ 的标准logistic回归，那么当 $a \\neq 0$ 时，有 $k=a$ 和 $Y_0=-b/a$。\n- 将报告的 $k$ 和 $Y_0$ 四舍五入到三位小数。此处不需要物理单位；报告无单位的值。\n\n使用的基本原理：\n- 对于二元标签 $t_i \\in \\{0,1\\}$，使用成功概率为 $p_i$ 的独立伯努利试验。\n- 伯努利似然函数 $L=\\prod_i p_i^{t_i} (1-p_i)^{1-t_i}$ 及其对数。\n- 使用线性预测变量 $z_i$ 的logistic链接函数 $p_i = 1/(1+\\exp[-z_i])$。\n\n测试套件（每个数据集是一个 $(x_i,t_i)$ 对的列表，其中 $x_i$ 是测得的核YAP强度，$t_i$ 是TE标记物标签）：\n- 数据集A: $[(0.35,0),(0.50,0),(0.72,0),(0.88,1),(1.05,0),(1.20,1),(1.45,1),(1.60,1),(1.85,1),(2.10,1)]$\n- 数据集B: $[(0.30,1),(0.60,1),(0.90,1),(1.20,0),(1.50,1),(1.80,0),(2.10,0),(2.40,0)]$\n- 数据集C: $[(0.40,0),(0.80,0),(1.20,1),(1.60,0),(2.00,1),(2.40,1),(2.80,1),(3.20,1),(3.60,1),(4.00,1)]$\n\n角度单位不适用。不需要物理单位。如果考虑百分比，必须以小数形式表示；但是，您只需返回 $k$ 和 $Y_0$。\n\n您的程序应生成单行输出，其中包含结果，格式为逗号分隔的列表的列表，每个内部列表为对应数据集的 $[k,Y_0]$，四舍五入到三位小数，并且没有多余的空格。例如，输出格式必须为\n$$\n[[k_A,Y_{0,A}],[k_B,Y_{0,B}],[k_C,Y_{0,C}]]\n$$\n的形式，每个值都四舍五入到三位小数。最终输出必须精确地打印为一行。", "solution": "该问题要求为一个用于二元细胞命运结果的logistic模型估计参数 $k$ 和 $Y_0$。指定的方法是最大似然估计（MLE）。\n\n模型指出，给定细胞 $i$ 的YAP强度 $x_i$，其具有TE命运（$t_i=1$）的概率 $p_i$ 为：\n$$p_i = P(t_i=1 \\mid x_i) = \\frac{1}{1+\\exp[-k(x_i - Y_0)]}$$\n这是sigmoid函数 $\\sigma(z_i)$，其中线性预测变量是 $z_i = k(x_i - Y_0)$。每个细胞的命运决定都是一个成功概率为 $p_i$ 的独立伯努利试验。\n\n对于一组 $N$ 个独立观测值 $(x_i, t_i)$，似然函数 $L$ 是观测到每个结果的概率的乘积：\n$$L(k, Y_0) = \\prod_{i=1}^{N} p_i^{t_i} (1 - p_i)^{1-t_i}$$\n为了数值稳定性和分析便利性，我们使用对数似然函数 $\\mathcal{L} = \\log L$：\n$$\\mathcal{L}(k, Y_0) = \\sum_{i=1}^{N} [t_i \\log(p_i) + (1-t_i) \\log(1-p_i)]$$\n代入 $p_i$ 和 $1-p_i$ 的表达式并化简，对数似然可以写成包含线性预测变量 $z_i$ 的标准形式：\n$$\\mathcal{L}(k, Y_0) = \\sum_{i=1}^{N} [t_i z_i - \\log(1 + e^{z_i})]$$\n其中 $z_i = k(x_i - Y_0)$。关于 $k$ 和 $Y_0$ 最大化此函数，即可得到最大似然估计。\n\n为便于实际优化，使用标准线性参数化 $z_i = a x_i + b$ 更为方便。在这种形式下，对数似然为：\n$$\\mathcal{L}(a, b) = \\sum_{i=1}^{N} [t_i (a x_i + b) - \\log(1 + e^{a x_i + b})]$$\n任务是找到使该函数最大化的参数 $(a,b)$。这是一个标准的logistic回归问题。通过最小化负对数似然 $J(a,b) = -\\mathcal{L}(a,b)$ 来执行优化，这是一个凸函数。\n$$J(a, b) = \\sum_{i=1}^{N} [\\log(1 + e^{a x_i + b}) - t_i (a x_i + b)]$$\n我们将使用一种数值优化算法，特别是Broyden–Fletcher–Goldfarb–Shanno（BFGS）算法，来找到最小化 $J$ 的参数 $(a,b)$。优化将从“中性初始条件”开始初始化，这被正确地解释为 $a=0$ 和 $b=0$。这个起始点对应于所有细胞的 $p_i=0.5$，表示最大不确定性状态。\n\n一旦找到最优参数 $\\hat{a}$ 和 $\\hat{b}$，就使用所提供的关系将它们转换回具有物理意义的参数 $k$ 和 $Y_0$：\n$$z_i = a x_i + b = a(x_i + b/a)$$\n与 $z_i = k(x_i - Y_0)$ 相比较，我们确定：\n$$k = a \\quad \\text{and} \\quad Y_0 = -\\frac{b}{a}$$\n此转换在 $a \\neq 0$ 时有效。如果 $a=0$，则意味着YAP强度对TE概率没有影响，且 $Y_0$ 未定义。对于所提供的数据集，优化会产生一个非零的斜率参数 $a$。\n\n每个数据集的流程如下：\n1.  为给定的数据 $(x_i, t_i)$ 定义负对数似然函数 $J(a,b)$。为防止 $z_i$ 过大时发生溢出，将使用数值稳定的 `logaddexp` 函数，将 $\\log(1+e^{z_i})$ 计算为 $\\log(\\exp(0) + \\exp(z_i))$。\n2.  使用 `scipy.optimize.minimize`，以初始猜测值 $(a,b) = (0,0)$ 开始，找到最小化 $J(a,b)$ 的 $a$ 和 $b$ 的值。\n3.  计算 $k = a$ 和 $Y_0 = -b/a$。\n4.  将 $k$ 和 $Y_0$ 四舍五入到三位小数。\n5.  将所有数据集的结果汇总成所需的输出格式。```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Solves for the logistic regression parameters k and Y0 for multiple datasets\n    using maximum likelihood estimation.\n    \"\"\"\n    \n    # Define the datasets as provided in the problem statement.\n    test_cases = {\n        'A': [(0.35,0),(0.50,0),(0.72,0),(0.88,1),(1.05,0),(1.20,1),(1.45,1),(1.60,1),(1.85,1),(2.10,1)],\n        'B': [(0.30,1),(0.60,1),(0.90,1),(1.20,0),(1.50,1),(1.80,0),(2.10,0),(2.40,0)],\n        'C': [(0.40,0),(0.80,0),(1.20,1),(1.60,0),(2.00,1),(2.40,1),(2.80,1),(3.20,1),(3.60,1),(4.00,1)]\n    }\n\n    results = []\n\n    # The datasets are processed in alphabetical order of their keys (A, B, C)\n    for key in sorted(test_cases.keys()):\n        data = test_cases[key]\n        # Unpack data into numpy arrays for vectorization\n        x_data = np.array([item[0] for item in data])\n        t_data = np.array([item[1] for item in data])\n\n        def negative_log_likelihood(params, x, t):\n            \"\"\"\n            Calculates the negative log-likelihood for logistic regression.\n            params: A list or array [a, b] for the linear predictor z = a*x + b.\n            x: Predictor variable data (YAP intensity).\n            t: Binary outcome data (TE label).\n            \"\"\"\n            a, b = params\n            z = a * x + b\n            \n            # Use np.logaddexp for numerical stability to compute log(1 + exp(z))\n            # This is equivalent to log(exp(0) + exp(z))\n            log_likelihood_terms = t * z - np.logaddexp(0, z)\n            \n            # The sum gives the total log-likelihood, and we return its negative\n            return -np.sum(log_likelihood_terms)\n\n        # Initial guess corresponds to \"neutral initial conditions\" (a=0, b=0),\n        # where probability is 0.5 for all inputs.\n        initial_params = [0.0, 0.0]\n\n        # Perform the optimization to minimize the negative log-likelihood\n        optimization_result = minimize(\n            fun=negative_log_likelihood,\n            x0=initial_params,\n            args=(x_data, t_data),\n            method='BFGS'  # A standard and stable quasi-Newton method\n        )\n\n        # Extract the optimal parameters a and b\n        a_opt, b_opt = optimization_result.x\n\n        # Convert from (a, b) to (k, Y0) parameterization\n        # k = a\n        # Y0 = -b/a\n        k = a_opt\n        \n        # Handle the case where a_opt is very close to zero to avoid division issues,\n        # although for these datasets it is not expected.\n        if np.abs(k)  1e-9:\n             # If k is effectively zero, Y0 is undefined. This case indicates\n             # no dependency on x, which is not the case for the given data.\n             # We can set Y0 to NaN or handle as an error, but for this problem,\n             # a non-zero k is expected.\n            y0 = np.nan\n        else:\n            y0 = -b_opt / k\n\n        # Round the results to three decimal places as required.\n        k_rounded = round(k, 3)\n        y0_rounded = round(y0, 3)\n\n        results.append([k_rounded, y0_rounded])\n\n    # Format the final output string exactly as specified in the problem statement.\n    # The string representation of a list includes spaces, which must be removed.\n    # Then items are joined by commas, and enclosed in an outer pair of brackets.\n    output_str = f\"[{','.join([str(res).replace(' ', '') for res in results])}]\"\n    \n    print(output_str)\n\nsolve()\n```", "answer": "[[2.686,0.994],[-1.547,1.353],[2.052,1.456]]", "id": "2676393"}]}