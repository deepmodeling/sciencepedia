{"hands_on_practices": [{"introduction": "随着类器官体积的增大，其内部深处的细胞可能会因缺氧等必需营养物质的匮乏而坏死。本练习将引导您运用物理学第一性原理——具体而言，是菲克扩散定律（Fick's law of diffusion）与细胞消耗模型——来推导一个关键参数：球形类器官的最大存活半径 $R_{max}$。掌握该推导过程能让您将基本输运现象与三维组织培养中的一个关键实践限制紧密联系起来。[@problem_id:2622583]", "problem": "在一个充分混合的生物反应器中培养的脑类器官近似为球形，半径为 $R$。氧气从类器官表面的培养基中供应，由于快速的外部输运，表面的溶解氧浓度维持在 $c_{0}$。在类器官内部没有对流，氧气以分子扩散系数 $D$ 在均匀的细胞基质中扩散，该基质以一个均匀的零级体积速率 $q$（摩尔/单位体积·单位时间）消耗氧气，这反映了在操作浓度下饱和的细胞内动力学特性。假设系统处于准稳态。\n\n仅从菲克第一扩散定律 $J=-D \\nabla c$ 和稳态下的质量守恒定律出发，推导当中心恰好达到无氧状态（即 $c(0)=0$ 且 $c(R_{\\max})=c_{0}$）时，类器官的最大半径 $R_{\\max}$ 的解析表达式。你可以假设球对称性以及由对称性决定的中心点的正则性条件。将 $R_{\\max}$ 的最终答案表示为仅包含 $D$、$q$ 和 $c_{0}$ 的单个解析表达式。不要引入任何额外的经验公式或拟合参数。", "solution": "该问题要求在给定恒定的表面氧浓度 $c_0$、均匀的零级消耗速率 $q$ 和恒定的氧扩散系数 $D$ 的条件下，推导球形类器官中心恰好达到无氧状态时的最大半径 $R_{\\max}$。推导必须从菲克第一定律和稳态下的质量守恒原理开始。\n\n我们从控制体积中浓度为 $c$ 的物种的通用微分质量平衡方程开始：\n$$\n\\frac{\\partial c}{\\partial t} = -\\nabla \\cdot \\mathbf{J} + S\n$$\n此处，$\\frac{\\partial c}{\\partial t}$ 是该物种的累积速率，$\\mathbf{J}$ 是摩尔通量矢量， $S$ 是单位体积的净生成速率。\n\n问题指定了几个条件：\n1.  **准稳态：** 系统不随时间变化，因此累积项为零：$\\frac{\\partial c}{\\partial t} = 0$。\n2.  **菲克第一定律：** 通量 $\\mathbf{J}$ 是由扩散引起的，由 $\\mathbf{J} = -D \\nabla c$ 给出，其中 $D$ 是分子扩散系数，假定为常数。\n3.  **零级消耗：** 氧气以均匀速率 $q$ 被消耗。这对应于一个汇项 $S = -q$。\n\n将这些条件代入质量平衡方程，得到：\n$$\n0 = -\\nabla \\cdot (-D \\nabla c) - q\n$$\n假设扩散系数 $D$ 是一个常数，我们可以将其移到散度算子之外：\n$$\n0 = D (\\nabla \\cdot \\nabla c) - q\n$$\n这简化为反应-扩散的泊松方程：\n$$\nD \\nabla^2 c = q\n$$\n\n问题指出类器官是球形的，我们可以假设球对称性。因此，浓度 $c$ 仅是径向坐标 $r$ 的函数，即 $c = c(r)$。在球坐标系中，作用于仅与 $r$ 相关的函数的拉普拉斯算子 $\\nabla^2$ 为：\n$$\n\\nabla^2 c = \\frac{1}{r^2}\\frac{d}{dr}\\left(r^2 \\frac{dc}{dr}\\right)\n$$\n将此代入我们的控制方程，得到浓度分布的常微分方程（ODE）：\n$$\n\\frac{D}{r^2}\\frac{d}{dr}\\left(r^2 \\frac{dc}{dr}\\right) = q\n$$\n\n为了求解这个关于 $c(r)$ 的常微分方程，我们对 $r$ 进行积分。首先，我们整理方程：\n$$\n\\frac{d}{dr}\\left(r^2 \\frac{dc}{dr}\\right) = \\frac{q}{D} r^2\n$$\n对 $r$ 进行一次积分，得到：\n$$\nr^2 \\frac{dc}{dr} = \\int \\frac{q}{D} r^2 \\, dr = \\frac{q}{3D} r^3 + C_1\n$$\n其中 $C_1$ 是第一个积分常数。为了求出 $C_1$，我们在球心 $r=0$ 处应用一个边界条件。由于球对称性，浓度分布在中心必须是平滑的，这意味着浓度梯度必须为零。一个非零的梯度将意味着在原点存在一个物理上不可能的源或汇。这就是正则性条件。\n$$\n\\left. \\frac{dc}{dr} \\right|_{r=0} = 0\n$$\n为了应用这个条件，我们首先求解梯度 $\\frac{dc}{dr}$：\n$$\n\\frac{dc}{dr} = \\frac{q}{3D} r + \\frac{C_1}{r^2}\n$$\n在 $r=0$ 处，除非 $C_1=0$，否则 $\\frac{C_1}{r^2}$ 项是奇异的。因此，必须有 $C_1=0$。\n梯度表达式简化为：\n$$\n\\frac{dc}{dr} = \\frac{q}{3D} r\n$$\n现在，我们进行第二次积分来求得浓度分布 $c(r)$：\n$$\nc(r) = \\int \\frac{q}{3D} r \\, dr = \\frac{q}{6D} r^2 + C_2\n$$\n其中 $C_2$ 是第二个积分常数。\n\n我们现在使用临界半径 $R_{\\max}$ 的特定条件。该半径被定义为中心恰好变为无氧状态时的大小。这为我们的特定情况提供了两个边界条件：\n1.  在中心 $r=0$ 处，浓度为零：$c(0) = 0$。\n2.  在表面 $r=R_{\\max}$ 处，浓度维持在 $c_0$：$c(R_{\\max}) = c_0$。\n\n使用第一个条件 $c(0)=0$：\n$$\nc(0) = \\frac{q}{6D} (0)^2 + C_2 = 0 \\implies C_2 = 0\n$$\n因此，对于具有无氧核心的类器官，其浓度分布为：\n$$\nc(r) = \\frac{q}{6D} r^2\n$$\n现在我们在表面 $r=R_{\\max}$ 处应用第二个条件：\n$$\nc(R_{\\max}) = c_0\n$$\n将 $r=R_{\\max}$ 代入浓度分布方程，得到：\n$$\nc_0 = \\frac{q}{6D} R_{\\max}^2\n$$\n最后，我们通过整理方程来求解最大半径 $R_{\\max}$：\n$$\nR_{\\max}^2 = \\frac{6 D c_0}{q}\n$$\n取平方根，并注意半径必须为正，我们得到最终的表达式：\n$$\nR_{\\max} = \\sqrt{\\frac{6 D c_0}{q}}\n$$\n这个表达式代表了在指定的模型条件下，球形组织在其中心出现完全缺氧（无氧）区域之前所能拥有的最大半径。", "answer": "$$\\boxed{\\sqrt{\\frac{6 D c_{0}}{q}}}$$", "id": "2622583"}, {"introduction": "细胞外基质不仅是一个被动的支架，更是一个能主动指导形态发生的信号环境。本练习要求您预测改变基质刚度 $E$ 如何影响肠道类器官中的关键发育事件——即管腔形成与隐窝出芽。通过运用力学生物学的核心原理，您将深入思考机械力如何影响细胞行为和组织结构，这是类器官科学的一个前沿领域。[@problem_id:2622412]", "problem": "一个实验室比较了在两种仅体弹性模量不同的合成水凝胶中生长了$t=5$天的人肠道上皮类器官：一种的体弹性模量为$E \\approx 0.3\\,\\mathrm{kPa}$，另一种为$E \\approx 3\\,\\mathrm{kPa}$。两种基质呈现相同密度的整合素结合肽，且培养基成分和生长因子供应保持恒定。类器官以单细胞来源的上皮球状体形式接种。量化了两个指标：(i) 形成单一、连续中央管腔的类器官比例（腔化效率），以及 (ii) 每个类器官的平均隐窝样芽数量（隐窝出芽频率）。\n\n基于上皮形态发生和力学转导的基本原理，包括管腔扩张过程中的力平衡、顶-底极性建立，以及Yes相关蛋白（YAP）和带PDZ结合基序的转录共激活因子（TAZ）信号通路的刚度依赖性调控，以下哪个选项最能预测两种条件下的相对结果，并提供最准确的机理阐释？\n\nA. 较软的基质（$E \\approx 0.3\\,\\mathrm{kPa}$）比更硬的基质（$E \\approx 3\\,\\mathrm{kPa}$）产生更高的腔化效率和更高的隐窝出芽频率，因为较低的基质弹性阻力降低了管腔扩张的压力阈值，并减弱了核内YAP/TAZ的活性，从而有利于分化和形态发生。\n\nB. 更硬的基质（$E \\approx 3\\,\\mathrm{kPa}$）产生更高的腔化效率和更高的隐窝出芽频率，因为更大的外部阻力稳定了管腔形状，并放大了形态发生所需的整合素信号。\n\nC. 在更硬的基质（$E \\approx 3\\,\\mathrm{kPa}$）中，由于密封性和液体保留性得到改善，腔化效率更高；而在较软的基质（$E \\approx 0.3\\,\\mathrm{kPa}$）中，由于核内YAP/TAZ活性降低，隐窝出芽频率更高。\n\nD. 两种条件之间没有显著差异，因为配体密度相同且生长因子未改变。\n\nE. 较软的基质（$E \\approx 0.3\\,\\mathrm{kPa}$）产生更高的腔化效率但更低的隐窝出芽频率，因为尽管有利于管腔扩张，但降低的刚度限制了隐窝外凸所必需的牵引力。", "solution": "按照程序，首先将验证问题陈述。\n\n步骤1：提取的已知条件\n- 系统：人肠道上皮类器官。\n- 初始状态：以单细胞来源的上皮球状体形式接种。\n- 实验持续时间：$t = 5$天。\n- 自变量：合成水凝胶基质的体弹性模量$E$。比较两种条件：\n    - 条件1（软）：$E \\approx 0.3\\,\\mathrm{kPa}$。\n    - 条件2（硬）：$E \\approx 3\\,\\mathrm{kPa}$。\n- 控制参数：\n    - 水凝胶*仅*在体弹性模量上有所不同。\n    - 两种基质中整合素结合肽的密度相同。\n    - 培养基成分和生长因子供应保持恒定。\n- 因变量（量化指标）：\n    - 腔化效率：形成单一、连续中央管腔的类器官比例。\n    - 隐窝出芽频率：每个类器官的平均隐窝样芽数量。\n- 分析所需的理论框架：\n    - 上皮形态发生原理。\n    - 力学转导。\n    - 管腔扩张过程中的力平衡。\n    - 顶-底极性建立。\n    - Yes相关蛋白（YAP）和带PDZ结合基序的转录共激活因子（TAZ）信号通路的刚度依赖性调控。\n\n步骤2：问题陈述的验证\n该问题具有科学依据。它描述了发育生物学和组织工程领域一个明确定义的实验，重点关注基质力学在类器官发育中的作用。指定的弹性模量$E \\approx 0.3\\,\\mathrm{kPa}$和$E \\approx 3\\,\\mathrm{kPa}$在软组织生物材料的典型范围内，并代表了生理学上相关的刚度差异。测量指标（腔化、隐窝出芽）是肠道类器官形态学的标准读数。所要求的分析基于已确立的力学-生物学原理，特别是力平衡和YAP/TAZ信号传导，已知这些在这些过程中至关重要。该问题提法恰当、客观、自洽，且没有任何科学或逻辑缺陷。\n\n步骤3：结论\n问题陈述有效。将推导解决方案。\n\n解决方案的推导\n该问题要求基于基质刚度的差异，预测两个指标——腔化效率和隐窝出芽频率——的结果。分析必须基于所提供的生物物理和分子原理。\n\n1.  腔化效率分析\n上皮球状体中的管腔形成是一个由液体积聚驱动的空腔形成过程。位于顶端的离子泵将离子转运到新生的管腔空间中，产生渗透压梯度，从而吸入水分。这会产生一个内部流体静压，$P_{lumen}$。要使管腔扩张，这个压力必须克服周围上皮层和外部水凝胶基质的机械阻力。扩张的管腔施加在基质上的机械应力受到基质弹性恢复力的抵抗，该恢复力与其弹性模量$E$成正比。\n\n根据无限弹性介质中球形空腔的弹性理论，扩张阻力与剪切模量成比例，而剪切模量又与杨氏模量$E$直接相关。较高的基质刚度（$E \\approx 3\\,\\mathrm{kPa}$）比更低的刚度（$E \\approx 0.3\\,\\mathrm{kPa}$）对扩张构成了显著更大的机械障碍。如果细胞产生的压力$P_{lumen}$不足以克服这种阻力，管腔扩张将会失败或不完全，导致形成多个小的、不连通的原始管腔，或者根本没有管腔。因此，较软的基质（$E \\approx 0.3\\,\\mathrm{kPa}$）通过提供较低的机械阻力来促进管腔扩张。这直接导向一个预测：**在较软的（$0.3\\,\\mathrm{kPa}$）基质中腔化效率更高**。\n\n2.  隐窝出芽频率分析\n隐窝出芽是一个复杂的形态发生事件，涉及局部增殖、细胞重排和细胞形状改变，从而导致隐窝样结构的外凸。这一过程受控制增殖与分化平衡的信号通路调控。问题陈述特别指导我们考虑YAP/TAZ信号传导的作用。\n\nYAP和TAZ是力学敏感的转录共激活因子。它们的活性受基质刚度调控，如下所示：\n- **硬基质 ($E \\approx 3\\,\\mathrm{kPa}$):** 高基质刚度促进黏着斑的形成并增加细胞骨架张力。这种张力抑制LATS1/2激酶，使得YAP/TAZ保持未磷酸化状态，转位到细胞核中，并促进靶基因的表达。核内YAP/TAZ信号传导与细胞增殖和未分化状态密切相关，而通常它作为复杂分化和形态发生程序的抑制剂。\n- **软基质 ($E \\approx 0.3\\,\\mathrm{kPa}$):** 低基质刚度导致较低的细胞骨架张力。这会激活LATS1/2激酶，使YAP/TAZ磷酸化。磷酸化的YAP/TAZ被保留在细胞质中并被靶向降解。由此导致的核内YAP/TAZ信号传导减弱，解除了其对分化的抑制作用，允许细胞执行复杂的形态发生程序。\n\n隐窝出芽是肠道上皮分化和组织化的一个关键特征。因此，较软基质中核内YAP/TAZ活性的降低预计会促进这一过程。这导向一个预测：**在较软的（$0.3\\,\\mathrm{kPa}$）基质中隐窝出芽频率更高**。\n\n结合这两项分析，理论预测是，与更硬的基质（$E \\approx 3\\,\\mathrm{kPa}$）相比，较软的基质（$E \\approx 0.3\\,\\mathrm{kPa}$）将表现出更高的腔化效率和更高的隐窝出芽频率。\n\n选项评估\n\nA. 较软的基质（$E \\approx 0.3\\,\\mathrm{kPa}$）比更硬的基质（$E \\approx 3\\,\\mathrm{kPa}$）产生更高的腔化效率和更高的隐窝出芽频率，因为较低的基质弹性阻力降低了管腔扩张的压力阈值，并减弱了核内YAP/TAZ，从而有利于分化和形态发生。\n- 此选项正确预测了在较软基质中腔化效率和隐窝出芽频率都会更高。\n- 所提供的机理阐释根据上述推导是精确且正确的。它正确地将较低的阻力与改善的腔化联系起来，并将减弱的核内YAP/TAZ活性与增强的形态发生（出芽）联系起来。\n- 结论：**正确**。\n\nB. 更硬的基质（$E \\approx 3\\,\\mathrm{kPa}$）产生更高的腔化效率和更高的隐窝出芽频率，因为更大的外部阻力稳定了管腔形状，并放大了形态发生所需的整合素信号。\n- 关于更硬基质在两个指标上都更优的预测与我们的推导相反。\n- 其机理阐释存在缺陷。虽然可能需要一些最小的阻力，但$3\\,\\mathrm{kPa}$基质的高阻力对于管腔扩张是抑制性的，而不是稳定性的。此外，虽然整合素信号被放大，但这会导致高水平的核内YAP/TAZ，从而抑制而非促进隐窝出芽所需的分化。\n- 结论：**不正确**。\n\nC. 在更硬的基质（$E \\approx 3\\,\\mathrm{kPa}$）中，由于密封性和液体保留性得到改善，腔化效率更高；而在较软的基质（$E \\approx 0.3\\,\\mathrm{kPa}$）中，由于核内YAP/TAZ活性降低，隐窝出芽频率更高。\n- 此选项呈现了一个混合的结果。对隐窝出芽的预测及其机理阐释是正确的。\n- 然而，关于在更硬基质中腔化效率更高的预测是不正确的。高刚度的主要作用是扩张的机械阻抗，而不是改善密封性，后者是细胞-细胞连接的属性。\n- 结论：**不正确**。\n\nD. 两种条件之间没有显著差异，因为配体密度相同且生长因子未改变。\n- 此选项错误地忽略了力学的作用。该问题明确旨在测试机械线索（刚度）的影响，细胞独立于可溶性因子或配体密度（当高于饱和阈值时）来转导这些信号。在力学生物学的背景下，认为恒定的配体密度和生长因子会抵消十倍刚度变化的影响是根本错误的。\n- 结论：**不正确**。\n\nE. 较软的基质（$E \\approx 0.3\\,\\mathrm{kPa}$）产生更高的腔化效率但更低的隐窝出芽频率，因为尽管有利于管腔扩张，但降低的刚度限制了隐窝外凸所必需的牵引力。\n- 此选项也呈现了一个混合的结果。对腔化效率的预测是正确的。\n- 基于指定的YAP/TAZ原理，对隐窝出芽的预测是不正确的。虽然细胞确实需要能够抵抗牵引力的基底来进行机械功，但在这种情况下，YAP/TAZ通路提供了一个更具体和主导的机制。问题通过YAP/TAZ指导分析，其中较低的刚度允许形态发生。因此，这个机理阐释，尽管在其他情况下可能是合理的，但与指定的主要机制相矛盾。\n- 结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2622412"}, {"introduction": "任何类器官系统的一个关键验证步骤是证明其在多大程度上忠实地再现了体内的发育时间进程。这项计算实践介绍了动态时间规整（Dynamic Time Warping, DTW）算法，这是一种强大的工具，用于对齐两个可能以不同速率演变的时间序列。通过实现DTW算法，将类器官的基因表达轨迹与其体内对应物进行映射，您将亲身体验一种对评估和比较类器官模型至关重要的定量分析方法。[@problem_id:2622535]", "problem": "您的任务是构建一个完整的时序对齐分析，使用动态时间规整（DTW）将类器官的基因表达轨迹映射到体内的发育时间线上。目标是，在单调、连续的时间规整约束下，为每个类器官采样时间点计算出能最佳对齐多维基因表达谱的相应体内发育时间。\n\n使用的科学基础：\n- 分子生物学的中心法则指出，DNA转录为RNA，再翻译为蛋白质；信使RNA丰度随时间变化的图谱为器官发生过程中的时序性基因调控状态提供了一个经过充分检验的代理指标。\n- 在发育生物学中，异时性是常见的现象：类器官系统在重现体内基因表达程序时，常伴有相位偏移或时间伸缩。DTW是一种公认的方法，通过在单调路径约束下最小化累积距离，来对齐两个可能存在相位差或采样密度不同的序列。\n\n需要实现的数学公式：\n- 设体内轨迹为时间点序列 $\\{t_j^{\\mathrm{in}}\\}_{j=0}^{m-1}$（单位：天）及其对应的G个基因的表达向量 $\\{\\mathbf{x}_j^{\\mathrm{in}}\\in\\mathbb{R}^G\\}_{j=0}^{m-1}$，类器官轨迹为 $\\{t_i^{\\mathrm{org}}\\}_{i=0}^{n-1}$ 及其表达向量 $\\{\\mathbf{x}_i^{\\mathrm{org}}\\in\\mathbb{R}^G\\}_{i=0}^{n-1}$。将点对点成本定义为欧几里得距离 $d(i,j)=\\lVert \\mathbf{x}_i^{\\mathrm{org}}-\\mathbf{x}_j^{\\mathrm{in}}\\rVert_2$。\n- 使用动态规划计算DTW累积成本矩阵 $D\\in\\mathbb{R}^{n\\times m}$，允许的步进为 $\\{(1,0),(0,1),(1,1)\\}$，强制路径从 $(0,0)$ 到 $(n-1,m-1)$ 的单调性和连续性。初始化 $D_{0,0}=d(0,0)$，并相应地在首行和首列使用有效的前驱节点进行计算。在每个 $(i,j)$ 位置，递推关系将 $d(i,j)$ 加到可接受的最小前驱成本上。当多个前驱节点成本相同时，按优先选择 $(1,1)$、其次 $(0,1)$、再次 $(1,0)$ 的顺序打破平局。\n- 从 $(n-1,m-1)$ 回溯至 $(0,0)$，以提取最优规整路径 $\\mathcal{P}=\\{(i_k,j_k)\\}_{k=0}^{K-1}$，其中 $i_{k+1}-i_k\\in\\{0,1\\}$, $j_{k+1}-j_k\\in\\{0,1\\}$ 且 $(i_{k+1}-i_k)+(j_{k+1}-j_k)\\in\\{1,2\\}$。\n- 通过对最优路径上与每个类器官索引配对的体内时间进行平均，定义类器官到体内的映射 $f:\\{0,\\dots,n-1\\}\\to\\mathbb{R}$：对于每个类器官索引 $i$，令 $J(i)=\\{j\\mid (i,j)\\in\\mathcal{P}\\}$，并设置 $f(i)=\\frac{1}{|J(i)|}\\sum_{j\\in J(i)} t_j^{\\mathrm{in}}$。将 $f(i)$ 以天为单位表示，结果为四舍五入到三位小数的实数。\n\n您的程序必须：\n- 以数值稳健的方式实现上述DTW算法。\n- 将其应用于下方的测试套件。\n- 对于每个测试用例，输出列表 $[f(0),f(1),\\dots,f(n-1)]$，单位为天，每个值四舍五入到三位小数。\n- 将三个测试用例的结果聚合成一个列表的列表，并在一行内输出：例如，如果有三个测试用例，结果分别为 $\\mathrm{R}_1$、$\\mathrm{R}_2$、$\\mathrm{R}_3$，则输出必须是 $[\\mathrm{R}_1,\\mathrm{R}_2,\\mathrm{R}_3]$ 形式的单行文本，其中每个 $\\mathrm{R}_k$ 都是一个由方括号括起、逗号分隔的小数列表。\n\n距离度量：\n- 在基因表达空间 $\\mathbb{R}^G$ 中使用欧几里得范数。\n\n平局打破规则：\n- 当前驱节点的累积成本在浮点数容差范围内完全相等时，优先选择对角步进(1,1)，然后是垂直步进(0,1)，最后是水平步进(1,0)。\n\n物理单位：\n- 所有时间必须以天为单位表示。报告的每个映射时间都应是以天为单位、四舍五入到三位小数的实数。\n\n测试套件（所有数组都已明确给出，必须严格按所给数据使用）：\n\n测试用例1（脑类器官到体内类皮层轨迹；$G=3$个基因；体内时间6个点；类器官时间6个点）：\n- 体内时间（天）：$[0.0,10.0,20.0,30.0,40.0,50.0]$\n- 类器官时间（天）：$[0.0,3.0,8.0,15.0,28.0,40.0]$\n- 体内表达量 $\\mathbf{x}_j^{\\mathrm{in}}=[g_1,g_2,g_3]$:\n  - $t=0.0$: $[1.000,0.027,0.017]$\n  - $t=10.0$: $[0.717,0.105,0.360]$\n  - $t=20.0$: $[0.513,0.328,1.000]$\n  - $t=30.0$: $[0.368,0.671,0.360]$\n  - $t=40.0$: $[0.264,0.895,0.017]$\n  - $t=50.0$: $[0.189,0.973,0.0001]$\n- 类器官表达量 $\\mathbf{x}_i^{\\mathrm{org}}=[g_1,g_2,g_3]$:\n  - $t=0.0$: $[1.000,0.027,0.017]$\n  - $t=3.0$: $[0.905,0.042,0.052]$\n  - $t=8.0$: $[0.766,0.081,0.230]$\n  - $t=15.0$: $[0.607,0.193,0.775]$\n  - $t=28.0$: $[0.394,0.606,0.520]$\n  - $t=40.0$: $[0.264,0.895,0.017]$\n\n测试用例2（肠类器官到体内类肠道轨迹；$G=3$个基因；体内时间6个点；类器官时间6个点）：\n- 体内时间（天）：$[0.0,5.0,10.0,15.0,25.0,35.0]$\n- 类器官时间（天）：$[0.0,2.0,6.0,12.0,18.0,30.0]$\n- 体内表达量 $\\mathbf{x}_j^{\\mathrm{in}}=[g_1,g_2,g_3]$:\n  - $t=0.0$: $[0.066,0.249,0.011]$\n  - $t=5.0$: $[0.269,1.000,0.037]$\n  - $t=10.0$: $[0.661,0.249,0.119]$\n  - $t=15.0$: $[0.911,0.0039,0.321]$\n  - $t=25.0$: $[0.997,0.000,0.852]$\n  - $t=35.0$: $[1.000,0.000,0.986]$\n- 类器官表达量 $\\mathbf{x}_i^{\\mathrm{org}}=[g_1,g_2,g_3]$:\n  - $t=0.0$: $[0.066,0.249,0.011]$\n  - $t=2.0$: $[0.119,0.607,0.018]$\n  - $t=6.0$: $[0.339,0.946,0.047]$\n  - $t=12.0$: $[0.791,0.066,0.183]$\n  - $t=18.0$: $[0.966,0.0001,0.500]$\n  - $t=30.0$: $[0.999,0.000,0.953]$\n\n测试用例3（恒定表达量的边缘案例；$G=2$个基因；体内时间4个点；类器官时间3个点）：\n- 体内时间（天）：$[0.0,1.0,2.0,3.0]$\n- 类器官时间（天）：$[0.0,1.0,2.0]$\n- 所有时间点的体内表达量 $\\mathbf{x}_j^{\\mathrm{in}}=[g_1,g_2]$：$[0.5,0.5]$\n- 所有时间点的类器官表达量 $\\mathbf{x}_i^{\\mathrm{org}}=[g_1,g_2]$：$[0.5,0.5]$\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含三个结果列表，形式为由逗号分隔并用方括号括起来的列表。例如：`[[1.000,2.000],[3.000,4.000,5.000],[6.000]]`（这只是格式示例，并非正确答案）。每个值都必须是以天为单位、四舍五入到三位小数的实数，且每个测试用例的结果必须按照上面列出的测试用例顺序出现。", "solution": "问题陈述已通过严格验证，被认为是有效的。它在分子和发育生物学方面有科学依据，在数学上是适定的，并为一项计算任务提供了完整、自洽的规范。所定义的任务是实现一个动态时间规整（DTW）算法，以对齐类器官培养物的时序基因表达数据与相应的体内发育数据。尽管平局打破规则的描述中存在轻微的术语不一致，但从所提供的向量表示法来看，其预期逻辑是明确的，并且可以在不损害问题完整性的情况下得以解决。\n\n解决方案通过实现指定的时序对齐分析来展开。该分析的核心是DTW算法，这是一种用于比较两个可能速度不同的时间序列的标准方法。\n\n**方法论**\n\n设体内参考轨迹为一个由 $m$ 个基因表达向量组成的序列 $\\{\\mathbf{x}_j^{\\mathrm{in}} \\in \\mathbb{R}^G\\}_{j=0}^{m-1}$，采样于时间点 $\\{t_j^{\\mathrm{in}}\\}_{j=0}^{m-1}$。设类器官轨迹为一个由 $n$ 个向量组成的序列 $\\{\\mathbf{x}_i^{\\mathrm{org}} \\in \\mathbb{R}^G\\}_{i=0}^{n-1}$，采样于时间点 $\\{t_i^{\\mathrm{org}}\\}_{i=0}^{n-1}$。目标是找到一个映射函数 $f: \\{0, \\dots, n-1\\} \\to \\mathbb{R}$，其中 $f(i)$ 代表与第 $i$ 个类器官时间点相对应的体内发育时间。\n\n该过程分四步执行：\n\n**1. 点对点成本矩阵构建**\n首先，我们构建一个点对点成本矩阵 $C \\in \\mathbb{R}^{n \\times m}$。每个元素 $C_{i,j}$ 量化了类器官的第 $i$ 个状态与体内参考的第 $j$ 个状态之间的不相似性。按照规定，此成本是相应 $G$ 维基因表达向量之间的欧几里得距离：\n$$C_{i,j} = d(i,j) = \\lVert \\mathbf{x}_i^{\\mathrm{org}} - \\mathbf{x}_j^{\\mathrm{in}} \\rVert_2$$\n\n**2. 累积成本矩阵计算**\n接下来，我们使用动态规划计算累积成本矩阵 $D \\in \\mathbb{R}^{n \\times m}$。一个条目 $D_{i,j}$ 表示从起点 $(0,0)$ 到点 $(i,j)$ 的对齐路径的最小总成本。该矩阵的构建如下：\n\n*   **初始化：**\n    *   原点的成本就是局部成本：$D_{0,0} = C_{0,0}$。\n    *   第一行通过水平累加成本来填充：$D_{0,j} = C_{0,j} + D_{0,j-1}$，对于 $j=1, \\dots, m-1$。\n    *   第一列通过垂直累加成本来填充：$D_{i,0} = C_{i,0} + D_{i-1,0}$，对于 $i=1, \\dots, n-1$。\n\n*   **递推关系：**\n    对于所有其他条目（$i>0, j>0$），累积成本是局部成本 $C_{i,j}$ 与允许的前驱节点的最小累积成本之和：\n    $$D_{i,j} = C_{i,j} + \\min(D_{i-1,j-1}, D_{i,j-1}, D_{i-1,j})$$\n    从前驱节点到 $(i,j)$ 的允许步进类型为：从 $(i-1,j-1)$ 出发的对角步进，从 $(i,j-1)$ 出发的水平步进，以及从 $(i-1,j)$ 出发的垂直步进。\n\n*   **平局打破规则：** 为确保路径唯一，`min` 操作中的平局根据指定的偏好解决：对角步进 $(1,1)$ 优先于水平步进 $(0,1)$，水平步进优先于垂直步进 $(1,0)$。就前驱单元格而言，这意味着选择顺序是 $(i-1,j-1)$ 优先于 $(i,j-1)$，$(i,j-1)$ 优先于 $(i-1,j)$。维持一个前驱矩阵 $P$，用于存储在每个点 $(i,j)$ 的决策，以供后续回溯使用。\n\n**3. 最优路径回溯**\n最优规整路径 $\\mathcal{P}$ 是一个索引对序列 $\\{(i_k, j_k)\\}_{k=0}^{K-1}$，它以最低的总累积成本 $D_{n-1,m-1}$ 连接了 $(0,0)$ 和 $(n-1,m-1)$。该路径通过从 $(n-1,m-1)$ 回溯到 $(0,0)$，并遵循存储在矩阵 $P$ 中的前驱节点来提取。最终得到的路径是两个时间序列的时间点之间的一组对应关系。\n\n**4. 类器官到体内的映射**\n最后，使用最优路径 $\\mathcal{P}$ 来定义时间映射 $f(i)$。对于每个类器官索引 $i \\in \\{0, \\dots, n-1\\}$，我们识别出路径上与 $i$ 配对的所有体内索引集合 $J(i) = \\{j \\mid (i,j) \\in \\mathcal{P}\\}$。对应的映射时间 $f(i)$ 是这些索引对应的体内时间的算术平均值：\n$$f(i) = \\frac{1}{|J(i)|} \\sum_{j \\in J(i)} t_j^{\\mathrm{in}}$$\n$f(i)$ 的最终值以天为单位报告，并四舍五入到三位小数。将此过程应用于每个测试用例以生成所需的结果。", "answer": "[[0.000,3.333,6.667,15.000,30.000,40.000],[0.000,5.000,5.000,12.500,25.000,35.000],[0.500,1.500,2.500]]", "id": "2622535"}]}