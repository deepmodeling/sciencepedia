{"hands_on_practices": [{"introduction": "干细胞生物学中的核心概念，如多能性（multipotency）和自我更新（self-renewal），必须通过功能性实验来严格验证。本练习将带你进入造血干细胞（HSC）研究的核心，通过分析经典的连续移植实验数据，学习如何将这些抽象定义转化为可量化的评估标准。这个实践旨在训练你将理论概念与实验数据分析联系起来的关键技能，让你能够根据严格的、预先设定的阈值来判断一个候选细胞群体是否真正具备干细胞特性 [@problem_id:2675589]。", "problem": "一个研究小组正在前瞻性地从成年小鼠骨髓中分离候选造血干细胞 (HSCs)，并通过连续移植来测试其功能。他们采用的功能性基本定义如下：多能性在操作上定义为在一代受体中实现长期多谱系重建，具体指在一个晚期时间点，供体来源的髓系、B淋巴系和T淋巴系的嵌合率均达到或超过一个固定阈值；自我更新定义为从一代受体进行二次移植后，在二代受体中能够维持这种多谱系重建。所有谱系的贡献均以移植后第 16 周外周血中的供体分数（嵌合率）进行量化。\n\n为了将决策形式化，基于这些功能性定义，规定以下阈值和决策规则：\n- 如果一代受体在第 16 周时，供体来源的髓系、B系和T系嵌合率均 $\\geq 0.01$，则该受体被视为已实现多谱系重建（多能性输出）。\n- 如果二代受体在第 16 周时，供体来源的髓系、B系和T系嵌合率均 $\\geq 0.01$，则该受体被视为已实现多谱系重建。\n- 设 $f_{\\text{primary}}$ 为所有一代受体中满足多谱系标准的比例，设 $f_{\\text{secondary}}$ 为所有源自满足多谱系标准的一代受体的二代受体中，满足多谱系标准的比例。\n- 如果 $f_{\\text{primary}} \\geq 0.75$ 且 $f_{\\text{secondary}} \\geq 0.50$，则认为该候选HSC群体达到了预设的功能阈值。\n\n给定以下第 16 周的供体嵌合率数据（数值为小数）：\n\n一代受体（每只均接受了相同剂量的候选HSCs）：\n- $P1$：髓系 $0.12$，B系 $0.08$，T系 $0.04$。\n- $P2$：髓系 $0.02$，B系 $0.009$，T系 $0.015$。\n- $P3$：髓系 $0.06$，B系 $0.05$，T系 $0.03$。\n- $P4$：髓系 $0.011$，B系 $0.013$，T系 $0.012$。\n\n对于每只在第 16 周被认定为多谱系的合格一代受体，取其骨髓等分试样移植给两只二代受体，并在第 16 周进行检测：\n\n来自 $P1$：\n- $S11$：髓系 $0.02$，B系 $0.015$，T系 $0.006$。\n- $S12$：髓系 $0.017$，B系 $0.012$，T系 $0.011$。\n\n来自 $P3$：\n- $S31$：髓系 $0.018$，B系 $0.014$，T系 $0.013$。\n- $S32$：髓系 $0.019$，B系 $0.016$，T系 $0.004$。\n\n来自 $P4$：\n- $S41$：髓系 $0.012$，B系 $0.010$，T系 $0.010$。\n- $S42$：髓系 $0.009$，B系 $0.008$，T系 $0.011$。\n\n定义二元决策变量 $X$，如果候选HSC群体同时满足上述多能性和自我更新阈值，则 $X=1$，否则 $X=0$。计算 $X$。无需四舍五入。以纯数字形式报告 $X$，不带单位。", "solution": "该问题提出了一个基于实验血液学原理的、设定良好的定量任务。它要求基于一个两级功能性检测来评估一个候选造血干细胞 (HSC) 群体：首先在一代受体中进行多谱系重建评估，然后通过连续移植来评估其自我更新能力。最终决策被形式化为一个二元变量 $X$，我们必须计算出它的值。问题陈述在科学上是合理的，内部是一致的，并且是完整的。我们开始进行解答。\n\n分析过程分三个必要步骤执行：第一，评估一代受体以确定多能性比例 $f_{\\text{primary}}$；第二，评估二代受体以确定自我更新比例 $f_{\\text{secondary}}$；第三，应用最终决策规则计算 $X$。\n\n步骤1：评估一代受体\n\n问题陈述有 $4$ 只一代受体，标记为 $P1$、$P2$、$P3$ 和 $P4$。如果一只一代受体在第 16 周时，其供体来源的髓系、B淋巴系和T淋巴系的嵌合率均大于或等于阈值 $0.01$，则认为其已实现多谱系重建。设 $C_M$、$C_B$ 和 $C_T$ 分别代表髓系、B系和T系的嵌合率值。一只合格的一代受体所需满足的条件是逻辑与命题：$ (C_M \\geq 0.01) \\land (C_B \\geq 0.01) \\land (C_T \\geq 0.01) $。\n\n我们将此标准应用于 $4$ 只一代受体中的每一只：\n- 对于受体 $P1$：$C_M = 0.12$，$C_B = 0.08$，$C_T = 0.04$。所有三个值均 $\\geq 0.01$。因此，$P1$ 满足标准。\n- 对于受体 $P2$：$C_M = 0.02$，$C_B = 0.009$，$C_T = 0.015$。B淋巴系嵌合率 $C_B = 0.009$ 小于 $0.01$。因此，$P2$ 不满足标准。\n- 对于受体 $P3$：$C_M = 0.06$，$C_B = 0.05$，$C_T = 0.03$。所有三个值均 $\\geq 0.01$。因此，$P3$ 满足标准。\n- 对于受体 $P4$：$C_M = 0.011$，$C_B = 0.013$，$C_T = 0.012$。所有三个值均 $\\geq 0.01$。因此，$P4$ 满足标准。\n\n满足多谱系标准的一代受体数量为 $3$ 只（即 $P1$、$P3$ 和 $P4$）。一代受体的总数为 $4$ 只。因此，比例 $f_{\\text{primary}}$ 为：\n$$f_{\\text{primary}} = \\frac{\\text{Number of multilineage primary recipients}}{\\text{Total number of primary recipients}} = \\frac{3}{4} = 0.75$$\n\n细胞群体通过的第一个条件是 $f_{\\text{primary}} \\geq 0.75$。由于我们计算出的值为 $f_{\\text{primary}} = 0.75$，该条件被满足：$0.75 \\geq 0.75$。\n\n步骤2：评估二代受体\n\n问题指明，二代受体是使用被认定为多谱系的合格一代受体的骨髓进行移植的。在我们的案例中，这些是 $P1$、$P3$ 和 $P4$。对于这 $3$ 只成功的一代受体，每只都生成了 $2$ 只二代受体。因此，需要评估的二代受体总数为 $3 \\times 2 = 6$。这些受体是 $S11, S12$（来自 $P1$），$S31, S32$（来自 $P3$），以及 $S41, S42$（来自 $P4$）。\n\n二代受体中多谱系重建的标准与一代受体相同：$ (C_M \\geq 0.01) \\land (C_B \\geq 0.01) \\land (C_T \\geq 0.01) $。我们将此标准应用于 $6$ 只二代受体中的每一只：\n- 来自 $P1$：\n  - $S11$：$C_M = 0.02$，$C_B = 0.015$，$C_T = 0.006$。不合格，因为 $C_T < 0.01$。\n  - $S12$：$C_M = 0.017$，$C_B = 0.012$，$C_T = 0.011$。满足标准。\n- 来自 $P3$：\n  - $S31$：$C_M = 0.018$，$C_B = 0.014$，$C_T = 0.013$。满足标准。\n  - $S32$：$C_M = 0.019$，$C_B = 0.016$，$C_T = 0.004$。不合格，因为 $C_T < 0.01$。\n- 来自 $P4$：\n  - $S41$：$C_M = 0.012$，$C_B = 0.010$，$C_T = 0.010$。满足标准。\n  - $S42$：$C_M = 0.009$，$C_B = 0.008$，$C_T = 0.011$。不合格，因为 $C_M < 0.01$ 且 $C_B < 0.01$。\n\n满足多谱系标准的二代受体数量为 $3$ 只（即 $S12$、$S31$ 和 $S41$）。被检测的二代受体总数为 $6$ 只。因此，比例 $f_{\\text{secondary}}$ 为：\n$$f_{\\text{secondary}} = \\frac{\\text{Number of multilineage secondary recipients}}{\\text{Total number of secondary recipients}} = \\frac{3}{6} = 0.50$$\n\n细胞群体通过的第二个条件是 $f_{\\text{secondary}} \\geq 0.50$。由于我们计算出的值为 $f_{\\text{secondary}} = 0.50$，该条件同样被满足：$0.50 \\geq 0.50$。\n\n步骤3：对变量 $X$ 的最终决策\n\n决策变量 $X$ 被定义为，当且仅当两个功能阈值同时被满足时，$X=1$。这两个条件是：\n1. $f_{\\text{primary}} \\geq 0.75$\n2. $f_{\\text{secondary}} \\geq 0.50$\n\n根据我们的分析，第一个条件被满足（$0.75 \\geq 0.75$），第二个条件也被满足（$0.50 \\geq 0.50$）。由于该逻辑合取的两个部分都为真，因此认为该候选HSC群体达到了预设的功能阈值。\n\n因此，二元决策变量 $X$ 的值为 $1$。", "answer": "$$\\boxed{1}$$", "id": "2675589"}, {"introduction": "掌握了如何解读效能实验数据之后，下一步是学习如何设计严谨的实验。检验全能性（totipotency）——发展的最高潜能——尤其需要无懈可击的实验逻辑。本练习要求你扮演一名发育生物学家，评估多种实验方案，以确定哪一种能够最严格地检验单个细胞在正常、未受干扰的发育过程中形成完整生物体的能力 [@problem_id:2675602]。通过这个过程，你将学会区分证明全能性、多能性（pluripotency）与调节能力的实验，并认识到功能验证相对于分子标记的决定性意义。", "problem": "一个发育生物学实验室希望确定，在正常的、未经操控的发育条件下，小鼠2细胞期卵裂球中具备个体全能性的细胞所占的比例，记为 $p$。此处，全能性根据其第一性原理被定义为：单个细胞能够生成所有胚内和胚外谱系，从而完成足月发育的能力。在小鼠早期受孕体中，最初的谱系分化会产生滋养外胚层、内细胞团外胚层和原始内胚层；因此，一种与全能性定义一致的可操作的体内检测方法是：观察到单个2细胞期卵裂球的克隆后代分布于所有三个围着床期区室（滋养外胚层、外胚层和原始内胚层），并在之后同时分布于胚内和胚外组织（例如，胚胎本体和胎盘），且不干扰胚胎的正常发育。该实验室的限制条件是：实验方案必须保持原位正常发育（不能分离卵裂球或使用外源性支持进行补救），必须是一种直接的谱系追踪读出（不仅仅是预测性的转录组状态），并且必须能在众多胚胎中得出一个无偏估计量 $\\hat{p}$。\n\n请考虑以下候选实验设计。哪一个最能满足这些限制条件，并得出对 $p$ 的严谨、无偏的估计？\n\nA. 构建携带泛在性Cre依赖性报告基因（例如，Rosa26-loxP-STOP-loxP-tdTomato）的小鼠。向合子中注射编码光激活Cre重组酶（PA-Cre）的信使核糖核酸（mRNA），让其发育至2细胞阶段，然后通过局限光照（例如，用 405 nm 激光穿过针孔）特异性地在单个卵裂球中激活Cre。将胚胎移植到假孕受体中进行正常发育。在围着床期（E$4.5$）和着床后阶段（例如，E$6.5$ 和 E$10.5$），通过对谱系标记（例如，Cdx$2$ 用于滋养外胚层，Nanog 或 Sox$2$ 用于外胚层，Gata$6$ 或 Sox$17$ 用于原始内胚层；以及在更晚阶段的滋养层标记和胚胎本体）进行免疫染色，来检测被永久标记的克隆后代。如果在所有三个围着床期谱系以及之后的胚内和胚外区室中都检测到标记后代，且胚胎形态和活力正常，则将该卵裂球记为具有类全能性。在 $N$ 个仅有一个2细胞期卵裂球被标记的胚胎中，计算 $\\hat{p} = k/N$，其中 $k$ 是满足评分标准的胚胎数量。包含用于检测标记特异性（排除两个卵裂球均被标记的胚胎）、重组效率和光毒性的对照组。\n\nB. 在2细胞阶段，机械分离姐妹卵裂球，并将每个卵裂球单独培养至囊胚期，然后移植到代孕母体中。量化发育至足月的比例，并将其推断为在正常发育条件下具备个体全能性的2细胞期卵裂球的比例。\n\nC. 将绿色荧光蛋白（GFP）的信使核糖核酸（mRNA）显微注射到合子中，使两个卵裂球及其后代均一地表达绿色荧光蛋白。在E$4.5$和E$6.5$阶段追踪标记细胞的空间分布，并根据整体图案的对称性来推断每个卵裂球是否具有全能性。\n\nD. 将一个标记的2细胞期卵裂球与一个四倍体宿主胚胎进行聚合，移植到受体中，并评估标记细胞是否贡献于胚胎本体，而由四倍体细胞形成胚外组织。根据形成胚胎本体的比例来估计 $p$，因为胚外组织将由宿主提供。\n\nE. 对2细胞期卵裂球进行单细胞核糖核酸测序（scRNA-seq），通过与合子和类全能细胞的转录组特征进行比较来计算“全能性得分”，并将超过预定阈值的细胞比例作为 $p$ 的估计值。在E$4.5$阶段，用一小部分样本通过免疫染色进行验证。\n\n选择那个能够最佳地实践全能性在正常发育下的定义、使用直接谱系追踪，并能通过适当的对照得出对 $p$ 的无偏估计的选项。只有一个选项是最佳的。", "solution": "问题陈述在科学上和逻辑上都是有效的。它提出了一个发育生物学中明确定义的问题，并为评估潜在的实验设计提供了一套清晰的约束条件。目标是确定小鼠发育过程中2细胞期卵裂球中具有全能性的细胞所占的比例 $p$。所提供的全能性定义——单个细胞在正常发育过程中生成所有胚内和胚外谱系的能力——是一个严谨的、基于第一性原理的定义。对实验方案的约束条件也是明确的，并且对于正确解读结果至关重要：（１）保持*原位*正常发育，（２）使用直接的谱系追踪读出，以及（３）生成一个无偏估计量 $\\hat{p}$。\n\n现在我们将根据这些基本要求来评估每个提议的实验设计。\n\n**对选项A的分析**\n\n该方案提议使用光激活Cre重组酶（$PA-Cre$）系统，在一个完整的2细胞胚胎中的单个目标卵裂球中诱导一个永久性的遗传标记（例如，tdTomato表达）。胚胎在子宫移植后进行*原位*发育。来源于单个被标记卵裂球的细胞克隆的命运，随后在后续发育阶段（例如，围着床期E$4.5$，着床后E$6.5$和E$10.5$）被直接可视化。如果其标记后代被发现存在于所有三个主要谱系（滋养外胚层、外胚层、原始内胚层）中，并随后同时存在于胚内和胚外组织中，这与问题的定义一致，那么该卵裂球就被评定为具有操作上的全能性。\n\n- **保持正常发育：**该方法是微创的。使用聚焦的光脉冲（$405$ nm）在一个非常小的体积内激活Cre重组酶。胚胎的结构未受干扰，满足了*原位*要求。该提议正确地包含了光毒性对照，以确保标记过程本身不会干扰正常的发育过程。\n- **直接谱系追踪：**使用基于Cre/lox的遗传重组在目标细胞及其所有后代中创建一个永久的、可遗传的标记。这是直接谱系追踪的金标准。其读出不是基于瞬时标记或转录组谱的推断，而是对细胞命运的直接观察。\n- **无偏估计量：**通过分析大量的胚胎（$N$），并计算单个标记卵裂球的克隆后代满足全能性标准的案例数（$k$），可以计算出比例 $\\hat{p} = k/N$。假设对标记效率和特异性有适当的控制（例如，排除那些两个卵裂球都被意外标记的胚胎），该方法提供了一个对 $p$ 的直接、定量且统计上稳健的估计。\n\n这个设计完美地遵守了所有陈述的约束条件，并使用严谨和适当的方法直接检验了假说。因此，它是一个强有力的候选者。\n\n**选项A的结论：** **正确**。\n\n**对选项B的分析**\n\n该方案涉及在2细胞阶段机械分离两个姐妹卵裂球，并在单独培养并移植到代孕母体后评估它们各自发育至足月的能力。\n\n- **保持正常发育：**这个设计从根本上违反了保持*原位*正常发育的核心约束。问题明确禁止“卵裂球分离”。对卵裂球进行物理分离是一种深刻的扰动。随后的发育展示的是细胞在人工环境下的*调节能力*，而不是其在完整、未经操控的胚胎内的实际命运贡献。这个实验回答的是一个不同的问题，关乎损伤或解离后的发育潜能，而不是正常个体发育过程中的全能性。\n\n**选项B的结论：** **错误**。它违反了非扰动和*原位*分析的主要约束。\n\n**对选项C的分析**\n\n该方案建议将绿色荧光蛋白（GFP）的信使核糖核酸（mRNA）显微注射到合子中，然后观察后续阶段荧光的“图案对称性”来推断其潜能。\n\n- **直接谱系追踪：**该方法不符合直接谱系追踪的标准。mRNA及其翻译产生的蛋白质不是永久可遗传的遗传标记。它们会随着每次细胞分裂而被稀释。在囊胚期（包含约$\\sim32-64$个细胞）经过几次分裂后，每个细胞的GFP信号将显著减弱和扩散，从而无法明确地将一个细胞的起源归属于最初的两个卵裂球之一。此外，从“整体图案对称性”推断谱系贡献是一种主观、定性且不可靠的方法，不是严谨的科学读出。\n\n**选项C的结论：** **错误**。它没有采用有效的谱系追踪技术。\n\n**对选项D的分析**\n\n该方案描述了四倍体补偿实验，即单个标记的卵裂球与一个四倍体宿主胚胎进行聚合。其基本原理是，四倍体细胞优先形成胚外组织，而二倍体的测试细胞则形成胚胎本体。\n\n- **全能性与多能性的测试：**该实验是测试*多能性*（形成胚胎本体所有组织的能力）的既定金标准。它不测试*全能性*。全能性的定义明确要求能够生成*胚内*和*胚外*两种谱系。该实验的设计通过四倍体宿主提供胚外组织，从而有意地回避了对测试细胞形成胚外组织的要求。\n- **保持正常发育：**通过将二倍体细胞与四倍体宿主聚合来创建嵌合胚胎是一种高度人工的构建体。它不代表“正常的、未经操控的发育”，并且属于“通过外源性支持进行补救”的范畴，而这是被明确禁止的。\n\n**选项D的结论：** **错误**。它测试了错误的生物学特性（多能性，而非全能性），并违反了*原位*发育的约束。\n\n**对选项E的分析**\n\n该方案提议使用单细胞核糖核酸测序（scRNA-seq）来分析单个卵裂球的转录组，然后基于这些数据赋予一个“全能性得分”。\n\n- **直接谱系追踪：**该方法直接违背了实验方案“必须是一种直接的谱系追踪读出（不仅仅是预测性的转录组状态）”的约束。这是一种间接的、相关性的方法。它基于分子特征来预测潜能，而不是观察细胞的实际命运。“全能性得分”的有效性是一种假设，而非直接测量。\n- **保持正常发育：**scRNA-seq程序是终结性的。必须破坏细胞以提取其RNA。因此，无法追踪被分析的同一个细胞的命运，这违反了观察*原位*发育的原则。\n\n**选项E的结论：** **错误**。它是一种间接的、预测性的方法，而不是所要求的直接谱系追踪实验。\n\n**结论**\n\n经过严谨评估，只有选项A满足问题陈述中列出的所有关键约束条件。它提供了一种微创方法，在未受扰动的发育背景下进行直接、永久的谱系追踪，从而可以对具有全能性的卵裂球的比例进行定量和无偏的估计。其他选项存在缺陷，因为它们要么测试了不同的生物学问题（B, D），要么使用了不适当的谱系追踪方法（C），要么依赖于间接的预测模型而非直接观察（E）。", "answer": "$$\\boxed{A}$$", "id": "2675602"}, {"introduction": "对干细胞的理解不止于功能分析，更在于探索其背后的分子调控机制。以Oct4、Sox2和Nanog等关键转录因子为核心的基因调控网络（GRN）是维持细胞多能性状态的基石。本练习将引导你进行一次计算生物学的实践：使用常微分方程（ODEs）来构建并分析这一核心多能性网络的动态行为 [@problem_id:2675630]。你将通过此过程理解基因网络内部的相互作用如何产生稳定的细胞状态（即系统的稳态），以及外界信号（如FGF/ERK通路）如何驱动细胞在不同状态间转换，从而体验系统生物学在揭示生命过程动态特性中的强大作用。", "problem": "要求您构建并分析一个由胚胎干细胞中的 Oct4、Sox2 和 Nanog 组成的最小但科学上合理的多能性回路动力学模型，该模型将成纤维细胞生长因子/细胞外信号调节激酶 (FGF/ERK) 信号通路作为抑制性输入整合在内。您的任务是使用带有希尔型调控函数的常微分方程 (ODE) 组来形式化该模型，计算指定输入水平下的不动点，并确定这些不动点的稳定性。\n\n使用的基本和建模假设如下：\n- 中心法则与基因调控：转录因子通过调控相互作用调节转录输出；在快速中间步骤的准稳态假设下，使用常微分方程在粗粒度尺度上对分子水平的产生和降解进行建模。\n- 产生与降解平衡：对于每种分子，其时间导数等于产生项减去降解项，其中降解近似为一阶衰变。\n- 希尔型调控函数：激活由一个希尔函数建模，其指数捕捉协同性；抑制由一个抑制性希尔函数建模；用于组合调控的“与”门由多个希尔激活函数的乘积来建模。\n\n令 $O(t)$、$S(t)$ 和 $N(t)$ 分别表示 Oct4、Sox2 和 Nanog 的浓度。令 $E$ 表示 FGF/ERK 输入水平的无量纲代理变量。定义标准激活希尔函数\n$$H_{\\mathrm{act}}(x;K,n) \\equiv \\frac{x^n}{K^n + x^n},$$\n和标准抑制希尔函数\n$$H_{\\mathrm{rep}}(E;K,m) \\equiv \\frac{1}{1 + \\left(\\frac{E}{K}\\right)^m}.$$\n\n使用以下从上述假设推导得出的最小 ODE 模型：\n- Oct4 接受基础产生以及来自 Nanog 的激活：\n$$\\frac{dO}{dt} \\equiv \\beta_O \\cdot \\frac{w_{O0} + w_{ON}\\,H_{\\mathrm{act}}(N;K_{ON},n_{ON})}{w_{O0}+w_{ON}} - \\gamma_O\\, O.$$\n- Sox2 接受基础产生以及来自 Nanog 的激活：\n$$\\frac{dS}{dt} \\equiv \\beta_S \\cdot \\frac{w_{S0} + w_{SN}\\,H_{\\mathrm{act}}(N;K_{SN},n_{SN})}{w_{S0}+w_{SN}} - \\gamma_S\\, S.$$\n- Nanog 由 Oct4 和 Sox2 的“与”门激活，也通过自我激活，并受 FGF/ERK 抑制：\n$$\\frac{dN}{dt} \\equiv \\beta_N \\cdot \\left(\\frac{w_{NO}\\,H_{\\mathrm{act}}(O;K_{NO},n_{NO})\\,H_{\\mathrm{act}}(S;K_{NS},n_{NS}) + w_{NN}\\,H_{\\mathrm{act}}(N;K_{NN},n_{NN})}{w_{NO}+w_{NN}}\\right)\\cdot H_{\\mathrm{rep}}(E;K_{EN},m_{EN}) - \\gamma_N\\, N.$$\n\n用于所有计算的参数值：\n- 产生速率：$\\beta_O=\\beta_S=\\beta_N=1.0$。\n- 降解速率：$\\gamma_O=\\gamma_S=\\gamma_N=1.0$。\n- 激活权重：$w_{O0}=0.05$，$w_{ON}=0.95$；$w_{S0}=0.05$，$w_{SN}=0.95$；$w_{NO}=0.6$，$w_{NN}=0.4$。\n- 希尔阈值：$K_{ON}=K_{SN}=K_{NO}=K_{NS}=K_{NN}=0.5$；抑制阈值 $K_{EN}=1.0$。\n- 希尔指数（协同性）：$n_{ON}=n_{SN}=n_{NO}=n_{NS}=n_{NN}=4$；抑制指数 $m_{EN}=3$。\n\n用于分析的定义：\n- 不动点是满足代数系统 $\\frac{dO}{dt}=\\frac{dS}{dt}=\\frac{dN}{dt}=0$ 的任意点 $(O^\\ast,S^\\ast,N^\\ast)$。\n- 在不动点处的雅可比矩阵 $J$ 的元素为 $J_{ij} \\equiv \\frac{\\partial f_i}{\\partial x_j}$，其中 $\\mathbf{f}=(\\frac{dO}{dt},\\frac{dS}{dt},\\frac{dN}{dt})$ 且 $\\mathbf{x}=(O,S,N)$。\n- 如果雅可比矩阵 $J$ 的所有特征值都具有严格为负的实部，则该不动点是线性稳定的。\n- 定义在完全激活且无抑制条件下的最大稳态水平为 $O_{\\max}\\equiv \\beta_O/\\gamma_O$，$S_{\\max}\\equiv \\beta_S/\\gamma_S$ 和 $N_{\\max}\\equiv \\beta_N/\\gamma_N$。一个“类多能性”稳定不动点是指满足 $N^\\ast \\ge 0.6\\,N_{\\max}$、$O^\\ast \\ge 0.4\\,O_{\\max}$ 和 $S^\\ast \\ge 0.4\\,S_{\\max}$ 的不动点。\n\n计算任务：\n- 对于每个指定的输入 $E$，通过从多个初始条件求解代数系统来数值计算所有不同的不动点，通过 $\\ell_2$ 距离容差对解进行去重，在每个不动点处评估雅可比矩阵及其特征值，并确定其稳定性。\n- 根据上述阈值，判断对于该 $E$ 是否存在至少一个“类多能性”稳定不动点。\n\n测试集 (FGF/ERK 输入)：\n- $E \\in \\{0.0, 0.5, 2.0, 10.0\\}$。\n\n输出规范：\n- 对于每个 $E$，计算并报告一个包含三个整数的列表 $[n_{\\mathrm{all}}, n_{\\mathrm{stable}}, h_{\\mathrm{pluri}}]$，其中 $n_{\\mathrm{all}}$ 是找到的不同不动点的总数，$n_{\\mathrm{stable}}$ 是线性稳定不动点的数量，如果至少有一个稳定不动点是类多能性的，则 $h_{\\mathrm{pluri}}$ 等于 1，否则等于 0。\n- 您的程序应生成单行输出，其中包含测试集的结果，形式为针对每个 $E$ 的列表的逗号分隔列表，并用方括号括起来。例如：$[[1,1,1],[2,1,0],[\\dots],[\\dots]]$。由于所有报告的量均为无量纲的计数或二元指标，因此不需要单位。", "solution": "问题陈述已经过严格验证，被认为是科学上合理、适定且完整的。所有必要的数学定义、模型方程和参数值均已明确提供。我们将着手进行形式化分析。\n\n目标是分析一个建模了多能性基因调控网络的动力学系统的不动点。该系统由一组针对转录因子 Oct4 ($O(t)$)、Sox2 ($S(t)$) 和 Nanog ($N(t)$) 浓度的三个耦合常微分方程 (ODE) 描述。系统的行为受一个记为 $E$ 的外部抑制信号 FGF/ERK 调节。\n\n系统的状态由向量 $\\mathbf{x}(t) = (O(t), S(t), N(t))$ 给出。其动力学由 $\\frac{d\\mathbf{x}}{dt} = \\mathbf{f}(\\mathbf{x}; E)$ 控制，其中：\n$$ \\frac{dO}{dt} = f_O(O,S,N;E) = \\beta_O \\cdot \\frac{w_{O0} + w_{ON}\\,H_{\\mathrm{act}}(N;K_{ON},n_{ON})}{w_{O0}+w_{ON}} - \\gamma_O\\, O $$\n$$ \\frac{dS}{dt} = f_S(O,S,N;E) = \\beta_S \\cdot \\frac{w_{S0} + w_{SN}\\,H_{\\mathrm{act}}(N;K_{SN},n_{SN})}{w_{S0}+w_{SN}} - \\gamma_S\\, S $$\n$$ \\frac{dN}{dt} = f_N(O,S,N;E) = \\beta_N \\cdot \\left(\\frac{w_{NO}\\,H_{\\mathrm{act}}(O;K_{NO},n_{NO})\\,H_{\\mathrm{act}}(S;K_{NS},n_{NS}) + w_{NN}\\,H_{\\mathrm{act}}(N;K_{NN},n_{NN})}{w_{NO}+w_{NN}}\\right)\\cdot H_{\\mathrm{rep}}(E;K_{EN},m_{EN}) - \\gamma_N\\, N $$\n\n一个不动点，记为 $\\mathbf{x}^\\ast = (O^\\ast, S^\\ast, N^\\ast)$，是一个稳态解，在该解中各物质浓度不随时间变化，满足 $\\frac{d\\mathbf{x}}{dt} = \\mathbf{0}$。这转化为求解代数系统 $\\mathbf{f}(\\mathbf{x}^\\ast; E) = \\mathbf{0}$。\n\n代入给定的参数值 $\\beta_O=\\beta_S=1.0$，$\\gamma_O=\\gamma_S=1.0$，$w_{O0}=w_{S0}=0.05$，$w_{ON}=w_{SN}=0.95$，$K_{ON}=K_{SN}=0.5$ 以及 $n_{ON}=n_{SN}=4$，我们观察到 $O$ 和 $S$ 的产生项是关于 $N$ 的相同函数。在不动点处，我们有：\n$$ O^\\ast = \\frac{\\beta_O}{\\gamma_O} \\cdot \\frac{w_{O0} + w_{ON}\\,H_{\\mathrm{act}}(N^\\ast;K_{ON},n_{ON})}{w_{O0}+w_{ON}} $$\n$$ S^\\ast = \\frac{\\beta_S}{\\gamma_S} \\cdot \\frac{w_{S0} + w_{SN}\\,H_{\\mathrm{act}}(N^\\ast;K_{SN},n_{SN})}{w_{S0}+w_{SN}} $$\n鉴于 $O$ 和 $S$ 方程的参数相同，任何不动点都必须满足 $O^\\ast = S^\\ast$。这一关键观察显著简化了问题，将寻找三维不动点的问题简化为在由 $(O, N)$ 定义的二维空间中进行搜索。不动点方程组变为：\n$$ O = \\frac{1.0}{1.0} \\cdot \\frac{0.05 + 0.95\\,H_{\\mathrm{act}}(N;0.5,4)}{0.05+0.95} = 0.05 + 0.95\\,H_{\\mathrm{act}}(N;0.5,4) $$\n$$ N = \\frac{1.0}{1.0} \\cdot \\left(\\frac{0.6\\,H_{\\mathrm{act}}(O;0.5,4)^2 + 0.4\\,H_{\\mathrm{act}}(N;0.5,4)}{0.6+0.4}\\right)\\cdot H_{\\mathrm{rep}}(E;1.0,3) $$\n\n为找到给定 $E$ 的所有不动点，我们数值求解这个关于 $(O, N)$ 的二元非线性方程组。由于可能存在多重解（多稳态），我们采用一种数值求根算法（`scipy.optimize.root`），并从一个覆盖了可能状态空间（例如 $ [0, 1.2] \\times [0, 1.2] $）的网格起始点进行初始化。所得的解会根据其物理有效性（非负浓度）进行筛选，并基于一个小的 $\\ell_2$ 距离容差进行去重。\n\n每个唯一不动点 $\\mathbf{x}^\\ast$ 的线性稳定性由在该点评估的雅可比矩阵 $J$ 的特征值决定，其中 $J_{ij} = \\frac{\\partial f_i}{\\partial x_j}|_{\\mathbf{x}^\\ast}$。该不动点是稳定的当且仅当 $J$ 的所有特征值都具有严格为负的实部。偏导数可从 ODE 系统解析计算。例如：\n$$ J_{11} = \\frac{\\partial f_O}{\\partial O} = -\\gamma_O = -1.0 $$\n$$ J_{13} = \\frac{\\partial f_O}{\\partial N} = \\frac{\\beta_O w_{ON}}{w_{O0}+w_{ON}} \\frac{d H_{\\mathrm{act}}(N;K_{ON},n_{ON})}{dN} $$\n其他元素也以类似方式推导。我们为每个不动点计算这个 $3 \\times 3$ 矩阵及其特征值。\n\n最后，我们将每个稳定不动点分类为“类多能性”或非“类多能性”。首先，我们计算最大稳态水平：\n$O_{\\max} = \\beta_O/\\gamma_O = 1.0$，$S_{\\max} = \\beta_S/\\gamma_S = 1.0$，$N_{\\max} = \\beta_N/\\gamma_N = 1.0$。\n如果一个稳定不动点 $(O^\\ast, S^\\ast, N^\\ast)$ 满足 $N^\\ast \\ge 0.6\\,N_{\\max} = 0.6$、$O^\\ast \\ge 0.4\\,O_{\\max} = 0.4$ 和 $S^\\ast \\ge 0.4\\,S_{\\max} = 0.4$，则它是类多能性的。\n\n对于测试集中的每个 $E$ 值，计算流程如下：\n1. 数值求解所有不同的不动点 $(O^\\ast, N^\\ast)$，然后重构 $S^\\ast=O^\\ast$。这可以得到 $n_{\\mathrm{all}}$。\n2. 对于每个不动点，计算雅可比矩阵 $J$ 及其特征值。统计稳定不动点的数量，即 $n_{\\mathrm{stable}}$。\n3. 检查是否有任何稳定不动点满足多能性标准。如果至少有一个满足，则设置 $h_{\\mathrm{pluri}}=1$，否则设置 $h_{\\mathrm{pluri}}=0$。\n4. 报告三元组 $[n_{\\mathrm{all}}, n_{\\mathrm{stable}}, h_{\\mathrm{pluri}}]$。\n\n该流程在提供的 Python 代码中实现，代码会遍历指定的 $E$ 值，执行分析，并按要求格式化输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root\nfrom scipy.linalg import eigvals\n\ndef solve():\n    \"\"\"\n    Constructs and analyzes a dynamical model of the pluripotency circuit.\n    For each specified FGF/ERK input level E, it computes the number of\n    fixed points, the number of stable fixed points, and whether a stable\n    pluripotent-like state exists.\n    \"\"\"\n\n    # --- Parameter Definition ---\n    # These are fixed as per the problem statement.\n    p = {\n        'beta_O': 1.0, 'beta_S': 1.0, 'beta_N': 1.0,\n        'gamma_O': 1.0, 'gamma_S': 1.0, 'gamma_N': 1.0,\n        'w_O0': 0.05, 'w_ON': 0.95,\n        'w_S0': 0.05, 'w_SN': 0.95,\n        'w_NO': 0.6, 'w_NN': 0.4,\n        'K_ON': 0.5, 'K_SN': 0.5, 'K_NO': 0.5, 'K_NS': 0.5, 'K_NN': 0.5, 'K_EN': 1.0,\n        'n_ON': 4, 'n_SN': 4, 'n_NO': 4, 'n_NS': 4, 'n_NN': 4, 'm_EN': 3,\n    }\n\n    # --- Helper Functions ---\n    def H_act(x, K, n):\n        \"\"\"Standard activating Hill function.\"\"\"\n        # Add a small epsilon to prevent division by zero for x=K=0, though not the case here.\n        x_n = x**n\n        return x_n / (K**n + x_n)\n\n    def H_rep(E, K, m):\n        \"\"\"Standard inhibitory Hill function.\"\"\"\n        return 1.0 / (1.0 + (E / K)**m)\n\n    def H_act_deriv(x, K, n):\n        \"\"\"Derivative of the activating Hill function w.r.t. x.\"\"\"\n        K_n = K**n\n        x_n = x**n\n        return (n * K_n * x**(n - 1)) / (K_n + x_n)**2\n\n    # --- Core Logic Functions ---\n    def find_fixed_points(E, params, grid_size=12, tolerance=1e-6):\n        \"\"\"\n        Numerically finds all distinct fixed points for a given E.\n        Leverages the simplification O*=S* to solve a 2D system.\n        \"\"\"\n        def system_2d(variables):\n            O, N = variables\n            # Production terms (normalized by design since sum of weights is 1)\n            prod_O = params['beta_O'] * (params['w_O0'] + params['w_ON'] * H_act(N, params['K_ON'], params['n_ON']))\n            rep_term = H_rep(E, params['K_EN'], params['m_EN'])\n            prod_N = params['beta_N'] * (params['w_NO'] * H_act(O, params['K_NO'], params['n_NO'])**2 +\n                                         params['w_NN'] * H_act(N, params['K_NN'], params['n_NN'])) * rep_term\n            \n            # Fixed point equations: production = degradation\n            eq1 = prod_O - params['gamma_O'] * O\n            eq2 = prod_N - params['gamma_N'] * N\n            return [eq1, eq2]\n\n        initial_guesses = np.linspace(0.0, 1.2, grid_size)\n        solutions = []\n        for o_guess in initial_guesses:\n            for n_guess in initial_guesses:\n                sol = root(system_2d, [o_guess, n_guess], method='hybr')\n                if sol.success and np.all(sol.x >= 0):\n                    solutions.append(sol.x)\n        \n        if not solutions:\n            return []\n\n        # Deduplicate solutions\n        unique_solutions = []\n        solutions = np.array(solutions)\n        while solutions.shape[0] > 0:\n            base_sol = solutions[0]\n            unique_solutions.append(base_sol)\n            distances = np.linalg.norm(solutions - base_sol, axis=1)\n            solutions = solutions[distances > tolerance]\n        \n        # Reconstruct 3D points [O, S, N]\n        unique_3d = []\n        for s in unique_solutions:\n            O_star, N_star = s\n            # S* = O* due to identical parameters\n            unique_3d.append(np.array([O_star, O_star, N_star]))\n            \n        return unique_3d\n\n    def get_jacobian(fp, E, params):\n        \"\"\"Computes the 3x3 Jacobian matrix at a given fixed point.\"\"\"\n        O, S, N = fp\n        J = np.zeros((3, 3))\n        \n        # J[0,:] (d(dO/dt)/d(O,S,N))\n        J[0, 0] = -params['gamma_O']\n        J[0, 1] = 0.0\n        J[0, 2] = params['beta_O'] * (params['w_ON'] / (params['w_O0'] + params['w_ON'])) * H_act_deriv(N, params['K_ON'], params['n_ON'])\n\n        # J[1,:] (d(dS/dt)/d(O,S,N))\n        J[1, 0] = 0.0\n        J[1, 1] = -params['gamma_S']\n        J[1, 2] = params['beta_S'] * (params['w_SN'] / (params['w_S0'] + params['w_SN'])) * H_act_deriv(N, params['K_SN'], params['n_SN'])\n\n        # J[2,:] (d(dN/dt)/d(O,S,N))\n        rep_term = H_rep(E, params['K_EN'], params['m_EN'])\n        norm_N = params['w_NO'] + params['w_NN']\n        J[2, 0] = params['beta_N'] * (params['w_NO'] * H_act(S, params['K_NS'], params['n_NS']) * H_act_deriv(O, params['K_NO'], params['n_NO']) / norm_N) * rep_term\n        J[2, 1] = params['beta_N'] * (params['w_NO'] * H_act(O, params['K_NO'], params['n_NO']) * H_act_deriv(S, params['K_NS'], params['n_NS']) / norm_N) * rep_term\n        J[2, 2] = params['beta_N'] * (params['w_NN'] * H_act_deriv(N, params['K_NN'], params['n_NN']) / norm_N) * rep_term - params['gamma_N']\n\n        return J\n\n    def analyze_fixed_point_system(E, params):\n        \"\"\"\n        Performs the full analysis for a single E value: finds fixed points,\n        analyzes stability, and checks for pluripotency.\n        \"\"\"\n        fixed_points = find_fixed_points(E, params)\n        \n        n_all = len(fixed_points)\n        n_stable = 0\n        h_pluri = 0\n\n        O_max = params['beta_O'] / params['gamma_O']\n        S_max = params['beta_S'] / params['gamma_S']\n        N_max = params['beta_N'] / params['gamma_N']\n\n        for fp in fixed_points:\n            jacobian = get_jacobian(fp, E, params)\n            eigenvalues = eigvals(jacobian)\n            \n            is_stable = np.all(np.real(eigenvalues) < 0.0)\n            \n            if is_stable:\n                n_stable += 1\n                O_star, S_star, N_star = fp\n                is_pluri = (N_star >= 0.6 * N_max) and (O_star >= 0.4 * O_max) and (S_star >= 0.4 * S_max)\n                if is_pluri:\n                    h_pluri = 1\n                    \n        return [n_all, n_stable, h_pluri]\n\n    # --- Main Execution ---\n    test_cases = [0.0, 0.5, 2.0, 10.0]\n    results = [analyze_fixed_point_system(E, p) for E in test_cases]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\".replace(\" \", \"\"))\n\nsolve()\n```", "id": "2675630"}]}