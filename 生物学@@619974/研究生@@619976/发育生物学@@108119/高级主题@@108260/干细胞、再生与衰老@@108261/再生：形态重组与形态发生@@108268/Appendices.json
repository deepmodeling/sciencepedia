{"hands_on_practices": [{"introduction": "科学研究的一项核心技能是基于理论模型提出可证伪的预测。本练习旨在挑战你将位置信息、形态重组（重塑模式）和增补再生（间质生长）等抽象规则，应用于经典的蝾螈肢体嫁接实验范式中。通过预测操纵维甲酸（$RA$）后不同嫁接组合的再生结果，你将深入理解这两种基本再生策略之间复杂的相互作用，这是一次检验你概念掌握程度的“思维实验”。[@problem_id:2668027]", "problem": "研究人员利用墨西哥钝口螈的肢体再生来剖析形态重组（morphallaxis，以最小生长进行重新模式化）和新形态发生（epimorphosis，由再生芽介导的生长和间插添加）对近远轴模式形成的贡献。考虑一个位置信息框架，其中每个细胞都带有一个近远轴坐标 $x \\in [0,1]$，$x=0$ 代表最近端的身份，$x=1$ 代表最远端的身份。维甲酸（RA）是一种梯度形态发生素，它通过维甲酸受体（RARs）在转录上将细胞的位置身份重新指定为更近端的值（即降低 $x$ 值），其机制是上调近端标记物（如 Meis homeobox $1/2$ (Meis$1/2$)）并下调远端标记物（如 Homeobox A$13$ (Hoxa$13$)）。当两个具有不同位置身份的组织并置时，会产生一个位置不连续性 $\\Delta x$；广为接受的蝾螈肢体再生模型假设，大的 $\\Delta x$ 会通过间插再生来解决，该过程通过新形态发生（epimorphosis）产生中间身份；而小的 $\\Delta x$ 需要较少的间插，并可能主要通过形态重组（morphallactic repatterning）来解决。\n\n您将早期芽的远端再生芽（名义上 $x \\approx 1$）移植到近端残肢上（名义上 $x \\approx 0$），并进行三种实验操作：\n- V组（溶剂对照组）：远端再生芽未经RA处理直接移植。\n- R-pre组：远端再生芽在移植前接受短暂的RA脉冲处理以使其位置身份近端化；宿主接受溶剂处理。\n- R-wash组：远端再生芽接受与R-pre组相同的RA脉冲处理，但在移植前的一段确定时间内将RA洗脱，以便在与残肢并置时仍保留部分、分级的近端化状态。\n\n假设RA的剂量和时机足以在R-pre组中稳定地改变标记物表达，并在R-wash组中部分改变标记物，且不会引起毒性。您将在移植后的指定时间点评估以下观测指标：移植物中 Meis$1/2$ 和 Hoxa$13$ 的表达，移植物-残端界面的有丝分裂指数，通过软骨染色解析的间插生成的骨骼元件的存在与身份，以及与对照组相比远端肢端（autopod）形成的定性时间。您还将通过在界面处短暂施用有丝分裂抑制剂来测试对增殖阻断的敏感性。\n\n以下哪个选项提出了一组跨越这些组的可证伪的预测，且该预测最符合位置信息框架、RA的近端化作用以及形态重组与新形态发生之间的区别？\n\nA. V组表现出强烈的界面增殖峰，并在残端和远端移植物之间间插形成一个类似中肢/腿骨（zeugopod）的元件；Meis$1/2$ 在远端保持低水平，而 Hoxa$13$ 在移植物中保持高水平。R-pre组在移植物内表现出快速的近端化（$<48$ 小时内 Meis$1/2$ 上升，Hoxa$13$ 下降），与V组相比界面有丝分裂指数降低，在连接处频繁出现类似上肢/腿骨（stylopod）软骨的重复或肥大，以及肢端（autopod）形成延迟，这与移植物内的形态重组和间插减弱相一致。短暂的有丝分裂抑制选择性地抑制了V组中间插元件的形成，但对R-pre组的近端重复表型几乎没有影响。\n\nB. V组表现出可忽略的间插生长，因为远端组织仅通过形态重组进行自我重塑；R-pre组表现出界面增殖增加和间插加速，在连接处产生重复的远端（肢端）元件。RA在移植物中下调 Meis$1/2$ 并上调 Hoxa$13$。有丝分裂抑制在任何组中都没有效果。\n\nC. V组如经典实验一样表现出间插再生，但R-pre组尽管移植物已近端化，却表现出过度的间插，产生重复的中肢/腿骨（zeugopods），因为RA增加了形态发生素水平，从而增加了 $\\Delta x$。两组都显示出相同的 Meis$1/2$ 和 Hoxa$13$ 动态。有丝分裂抑制对R-pre组重复表型的减少程度大于对V组间插的减少程度。\n\nD. V组表现出间插再生，具有高界面增殖和在残端与移植物之间有序插入单个类似中肢/腿骨（zeugopod）的元件。在R-wash组中，部分近端化产生一个中等大小的 $\\Delta x$，从而导致间插幅度减小：界面增殖低于V组但高于R-pre组，Meis$1/2$ 在移植物中在一个中等时间窗内保持升高，Hoxa$13$ 部分受抑制，并形成一个较短或近端移位的间插元件。远端肢端（autopod）的形成相对于V组有适度延迟。短暂的有丝分裂抑制减小了R-wash组中间插的程度，但不会消除移植物内残留的形态重组标记物变化。\n\nE. V组和R-pre组产生相同的结果，因为位置身份完全由残端环境决定；移植物内在的RA处理历史无关紧要。间插和标记物表达动态无法区分，有丝分裂抑制没有组特异性效应。\n\n选择所有适用选项。", "solution": "在尝试解答之前，对问题陈述的有效性进行了严格评估。\n\n**问题有效性验证**\n\n问题陈述是有效的。它在科学上基于发育生物学的既定原则，特别是两栖动物肢体再生中的位置信息框架。所提出的概念——形态重组（morphallaxis）、新形态发生（epimorphosis）、维甲酸（RA）的近端化效应、位置不连续性（$\\Delta x$）的作用，以及像'$Meis1/2$'和'$Hoxa13$'这样的标记基因的功能——在该领域内都是标准且事实正确的。实验设计是测试这些概念之间相互作用的一种经典且合乎逻辑的方法。该问题设置合理，提供了从初始条件和操作到一组所需的可证伪预测的清晰映射。不存在会妨碍对预期结果进行严格、基于原则的推导的内部矛盾、歧义或信息缺失。\n\n**解答推导**\n\n解答是根据问题陈述中提供的基本原则推导出来的。\n\n1.  **位置信息：** 细胞沿近远轴具有位置身份，由坐标'$x \\in [0,1]$'表示，其中'$x=0$'为最近端（上肢/腿骨/残肢），'$x=1$'为最远端（肢端/再生芽尖端）。\n2.  **维甲酸（RA）作用：** RA作为一种形态发生素，可使位置身份近端化，有效降低被处理细胞的'$x$'值。这是形态重组（morphallaxis）的一种形式，因为它涉及细胞身份的重新模式化。这种变化在生物化学上反映为近端标记物（如'$Meis1/2$'）的上调和远端标记物（如'$Hoxa13$'）的下调。\n3.  **间插再生（新形态发生）：** 当两个具有不同位置值 '$x_{stump}$' 和 '$x_{graft}$' 的组织并置时，会产生一个位置不连续性 '$\\Delta x = |x_{graft} - x_{stump}|$'。该模型假设，对这种不连续性的生物学反应是间插再生，这是一个涉及细胞增殖以产生缺失的中间位置值的新形态发生过程。这种增殖性、新形态发生反应的强度与 '$\\Delta x$' 成正比。\n4.  **生长与重塑：** 大的 '$\\Delta x$' 需要广泛的细胞增殖（新形态发生）来填补模式。小的 '$\\Delta x$' 几乎不需要增殖，可以通过局部重塑（形态重组）来解决。\n\n基于这些原则，我们可以预测每个实验组的结果。在所有组中，残肢的位置值均为 '$x_{stump} \\approx 0$'。\n\n*   **V组（溶剂对照组）：** 将一个远端再生芽（'$x_{graft} \\approx 1$'）移植到一个近端残肢（'$x_{stump} \\approx 0$'）上。位置不连续性最大：'$\\Delta x = |1 - 0| = 1$'。这种大的不连续性会引发强烈的新形态发生反应。我们预计在移植物-残端界面会有高水平的细胞增殖，以生成全套的间插结构，即中肢/腿骨（zeugopod，具有中间 '$x$' 值的元件）。移植物本身是远端的，将保持低 '$Meis1/2$' 和高 '$Hoxa13$' 的表达，并继续形成肢端（autopod）。由于此过程依赖于增殖，因此它对有丝分裂抑制剂敏感。\n\n*   **R-pre组（RA预处理组）：** 将一个远端再生芽用RA处理，直到其被稳定地近端化（'$x_{graft} \\approx 0$'），然后再移植到近端残肢（'$x_{stump} \\approx 0$'）上。位置不连续性最小：'$\\Delta x = |0 - 0| = 0$'。由于没有不连续性，因此没有触发间插再生的因素。我们预计界面处的增殖极少。移植物组织经历了形态重组，其身份转变为近端，这将以高 '$Meis1/2$' 和低 '$Hoxa13$' 表达为标志。当这个已变为近端的移植物再生时，它将根据其新身份进行，试图从一个近端元件开始形成一个完整的肢体。这将导致在移植物-残端连接处出现上肢/腿骨（stylopod）的重复或肥大。由于移植物现在必须再生整个缺失的远端肢体（中肢/腿骨和肢端），末端肢端的形成将比V组显著延迟。这种重复表型是形态重组的结果，而非界面生长的结果，因此它应该对在界面处施用的有丝分裂抑制剂基本不敏感。\n\n*   **R-wash组（RA洗脱组）：** 再生芽被部分近端化，在移植到近端残肢（'$x_{stump} \\approx 0$'）前获得一个中间位置身份（'$0 < x_{graft} < 1$'）。不连续性是中等的：'$\\Delta x = |x_{graft} - 0| = x_{graft}$'。我们预计会有一个中等程度的新形态发生反应：界面处的增殖将低于V组但高于R-pre组。相应地，将形成一套较短或不完整的间插结构。移植物中的标记物表达将反映其 G 中间身份（例如，'$Meis1/2$' 升高，但不如R-pre组高）。间插过程虽然减弱，但仍然是新形态发生性的，因此对有丝分裂抑制剂敏感。\n\n**选项评估**\n\n*   **A. V组表现出强烈的界面增殖峰，并在残端和远端移植物之间间插形成一个类似中肢/腿骨（zeugopod）的元件；Meis$1/2$ 在远端保持低水平，而 Hoxa$13$ 在移植物中保持高水平。R-pre组在移植物内表现出快速的近端化（$<48$ 小时内 Meis$1/2$ 上升，Hoxa$13$ 下降），与V组相比界面有丝分裂指数降低，在连接处频繁出现类似上肢/腿骨（stylopod）软骨的重复或肥大，以及肢端（autopod）形成延迟，这与移植物内的形态重组和间插减弱相一致。短暂的有丝分裂抑制选择性地抑制了V组中间插元件的形成，但对R-pre组的近端重复表型几乎没有影响。**\n    该选项与为V组和R-pre组推导出的预测完全匹配。它正确地指出了V组中强烈的新形态发生，以及R-pre组中消除位置不连续性的后果：移植物内的形态重组、无间插、近端重复、远端发育延迟以及对有丝分裂抑制剂的差异敏感性。\n    **结论：正确。**\n\n*   **B. V组表现出可忽略的间插生长，因为远端组织仅通过形态重组进行自我重塑；R-pre组表现出界面增殖增加和间插加速，在连接处产生重复的远端（肢端）元件。RA在移植物中下调 Meis$1/2$ 并上调 Hoxa$13$。有丝分裂抑制在任何组中都没有效果。**\n    此选项在多个基本点上都是错误的。它错误地声称V组发生的是形态重组而非新形态发生。当 '$\\Delta x$' 最小时，它错误地预测R-pre组的增殖会增加。它错误地指出RA会上调远端标记物（'$Hoxa13$'）并下调近端标记物（'$Meis1/2$'），这与已知的RA作用相反。声称有丝分裂抑制没有效果也是错误的，因为新形态发生是依赖于生长的。\n    **结论：错误。**\n\n*   **C. V组如经典实验一样表现出间插再生，但R-pre组尽管移植物已近端化，却表现出过度的间插，产生重复的中肢/腿骨（zeugopods），因为RA增加了形态发生素水平，从而增加了 $\\Delta x$。两组都显示出相同的 Meis$1/2$ 和 Hoxa$13$ 动态。有丝分裂抑制对R-pre组重复表型的减少程度大于对V组间插的减少程度。**\n    此选项是错误的。RA使移植物近端化，这将 '$\\Delta x$' 从 `~1` *减少*到 `~0`。它不会增加 '$\\Delta x$'。因此，间插应该被减弱或消除，而不是被夸大。声称标记物动态相同是错误的，因为根据定义，RA处理会改变标记物表达。\n    **结论：错误。**\n\n*   **D. V组表现出间插再生，具有高界面增殖和在残端与移植物之间有序插入单个类似中肢/腿骨（zeugopod）的元件。在R-wash组中，部分近端化产生一个中等大小的 $\\Delta x$，从而导致间插幅度减小：界面增殖低于V组但高于R-pre组，Meis$1/2$ 在移植物中在一个中等时间窗内保持升高，Hoxa$13$ 部分受抑制，并形成一个较短或近端移位的间插元件。远端肢端（autopod）的形成相对于V组有适度延迟。短暂的有丝分裂抑制减小了R-wash组中间插的程度，但不会消除移植物内残留的形态重组标记物变化。**\n    此选项为V组和中间情况R-wash组的预期结果提供了详细而准确的描述。关于中等 '$\\Delta x$'、减弱但非零的间插、中等增殖水平、相应的标记物表达以及有丝分裂抑制的具体效果的预测，都符合所提供框架的逻辑。\n    **结论：正确。**\n\n*   **E. V组和R-pre组产生相同的结果，因为位置身份完全由残端环境决定；移植物内在的RA处理历史无关紧要。间插和标记物表达动态无法区分，有丝分裂抑制没有组特异性效应。**\n    此选项否定了移植物的内在位置身份至关重要这一核心前提，这与该领域嫁接实验的全部证据相悖。RA预处理的目的就是修改这种内在状态。因此，结果不可能是相同的。\n    **结论：错误。**\n\n选项A和D都提出了一组与所提供模型完全一致的预测。它们描述了不同实验组对之间的比较，且两种描述都是正确的推论。", "answer": "$$\\boxed{AD}$$", "id": "2668027"}, {"introduction": "从实验预测转向数据分析，本练习侧重于如何解读实验数据。你将使用一组简化的细胞增殖率数据，并通过贝叶斯模型比较这一强大的统计工具，来定量评估增补再生（epimorphosis）或形态重组（morphallaxis）哪种模型得到了證據更強的支持。此练习演示了如何将生物学假说形式化为数学模型，并利用数据在不同假说之间做出抉择。[@problem_id:2668085]", "problem": "蝾螈的断肢通过以下两种机制模式之一进行再生：形态重组（主要是组织重塑，新细胞增殖极少）或表层再生（由增殖性芽基驱动再生长出）。溴脱氧尿苷 (BrdU) 标记指数是指在一次短暂的 BrdU 脉冲标记中，处于 S 期的细胞所占的比例；当脉冲时间相对于细胞周期很短时，该标记指数近似于瞬时的S期细胞比例。已确定的事实是：(i) 表层再生涉及芽基局部的细胞增殖显著增加，该增殖水平在截肢后数天内上升并趋于一个平台期；(ii) 形态重组的特点是增殖水平低，接近基线，且随时间变化很小。\n\n您在一个标准化的伤口近端区域，于截肢后 (dpa) 的时间点 $t \\in \\{1, 2, 3, 4\\}$ 天测量了 BrdU 标记指数。观测到的标记指数为\n- $y(1) = 0.10$,\n- $y(2) = 0.23$,\n- $y(3) = 0.29$,\n- $y(4) = 0.33$.\n\n假设每个时间点的测量误差为独立高斯分布，已知标准差为 $\\sigma = 0.12$。考虑以下两种关于平均标记指数 $\\mu(t)$ 的机制模型：\n\n- 表层再生模型 $\\mathcal{E}$（芽基生长）：对于 $t \\ge \\tau$，$\\mu_{\\mathcal{E}}(t) = L_{\\infty}\\left(1 - \\exp\\!\\left(-k\\left(t - \\tau\\right)\\right)\\right)$；对于 $t < \\tau$，$\\mu_{\\mathcal{E}}(t) = 0$。使用参数 $L_{\\infty} = 0.35$，$k = 0.80\\,\\mathrm{d}^{-1}$ 和 $\\tau = 0.50\\,\\mathrm{d}$。\n- 形态重组模型 $\\mathcal{M}$（低增殖性重塑）：对于所有 $t$，$\\mu_{\\mathcal{M}}(t) = L_{b}$。使用参数 $L_{b} = 0.05$。\n\n假定在给定一个模型的情况下，四次测量是条件独立的，其似然函数为\n$$\np\\!\\left(\\{y(t)\\}\\mid \\mathcal{X}\\right) \\;=\\; \\prod_{t \\in \\{1,2,3,4\\}} \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{\\left(y(t) - \\mu_{\\mathcal{X}}(t)\\right)^{2}}{2\\sigma^{2}}\\right), \\quad \\mathcal{X} \\in \\{\\mathcal{E}, \\mathcal{M}\\}.\n$$\n\n计算贝叶斯因子\n$$\n\\mathrm{BF} \\;=\\; \\frac{p\\!\\left(\\{y(t)\\}\\mid \\mathcal{E}\\right)}{p\\!\\left(\\{y(t)\\}\\mid \\mathcal{M}\\right)}\n$$\n，其结果为一个无量纲数，并将您的答案四舍五入至三位有效数字。将最终值表示为一个无量纲数。", "solution": "对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 数据：一组在截肢后 (dpa) 时间点 $t \\in \\{1, 2, 3, 4\\}$ 天测量的四个溴脱氧尿苷 (BrdU) 标记指数 $\\{y(t)\\}$。\n- 观测值：$y(1) = 0.10$，$y(2) = 0.23$，$y(3) = 0.29$，$y(4) = 0.33$。\n- 误差模型：独立高斯测量误差，已知标准差 $\\sigma = 0.12$。\n- 模型 $\\mathcal{E}$（表层再生）：平均标记指数为，当 $t \\ge \\tau$ 时，$\\mu_{\\mathcal{E}}(t) = L_{\\infty}(1 - \\exp(-k(t - \\tau)))$；当 $t < \\tau$ 时，$\\mu_{\\mathcal{E}}(t) = 0$。\n- 模型 $\\mathcal{E}$ 的参数：$L_{\\infty} = 0.35$，$k = 0.80\\,\\mathrm{d}^{-1}$，$\\tau = 0.50\\,\\mathrm{d}$。\n- 模型 $\\mathcal{M}$（形态重组）：平均标记指数为常数，$\\mu_{\\mathcal{M}}(t) = L_{b}$。\n- 模型 $\\mathcal{M}$ 的参数：$L_{b} = 0.05$。\n- 似然函数：对于模型 $\\mathcal{X} \\in \\{\\mathcal{E}, \\mathcal{M}\\}$，观测到数据 $\\{y(t)\\}$ 的似然由下式给出\n$$ p(\\{y(t)\\}\\mid \\mathcal{X}) = \\prod_{t \\in \\{1,2,3,4\\}} \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(y(t) - \\mu_{\\mathcal{X}}(t))^{2}}{2\\sigma^{2}}\\right) $$\n- 目标：计算贝叶斯因子 $\\mathrm{BF} = \\frac{p(\\{y(t)\\}\\mid \\mathcal{E})}{p(\\{y(t)\\}\\mid \\mathcal{M})}$，并将结果四舍五入至三位有效数字。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，描述了发育生物学中模型比较的一种标准方法。表层再生模型（饱和指数增长）和形态重组模型（恒定基线）是对生物过程的合​​理简化。该统计框架基于贝叶斯模型比较，这是一种严谨且成熟的方法。该问题定义明确，提供了计算唯一解所需的所有参数、数据和方程。其陈述客观，不含矛盾或歧义。该问题有效。\n\n步骤3：结论与行动。\n该问题有效。将推导求解。\n\n贝叶斯因子 $\\mathrm{BF}$ 是两个竞争模型 $\\mathcal{E}$ 和 $\\mathcal{M}$ 的似然之比。\n$$\n\\mathrm{BF} = \\frac{p(\\{y(t)\\}\\mid \\mathcal{E})}{p(\\{y(t)\\}\\mid \\mathcal{M})} = \\frac{\\prod_{t=1}^{4} \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(y(t) - \\mu_{\\mathcal{E}}(t))^{2}}{2\\sigma^{2}}\\right)}{\\prod_{t=1}^{4} \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(y(t) - \\mu_{\\mathcal{M}}(t))^{2}}{2\\sigma^{2}}\\right)}\n$$\n归一化常数项 $(\\frac{1}{\\sigma\\sqrt{2\\pi}})^{4}$ 同时出现在分子和分母中，因此可以消去。表达式简化为：\n$$\n\\mathrm{BF} = \\frac{\\exp\\left(-\\frac{1}{2\\sigma^{2}}\\sum_{t=1}^{4} (y(t) - \\mu_{\\mathcal{E}}(t))^{2}\\right)}{\\exp\\left(-\\frac{1}{2\\sigma^{2}}\\sum_{t=1}^{4} (y(t) - \\mu_{\\mathcal{M}}(t))^{2}\\right)}\n$$\n利用指数的性质，这可以写成：\n$$\n\\mathrm{BF} = \\exp\\left\\{ -\\frac{1}{2\\sigma^{2}} \\left[ \\sum_{t=1}^{4} (y(t) - \\mu_{\\mathcal{E}}(t))^{2} - \\sum_{t=1}^{4} (y(t) - \\mu_{\\mathcal{M}}(t))^{2} \\right] \\right\\}\n$$\n令 $\\mathrm{SSE}_{\\mathcal{X}} = \\sum_{t=1}^{4} (y(t) - \\mu_{\\mathcal{X}}(t))^{2}$ 为模型 $\\mathcal{X}$ 的误差平方和。那么贝叶斯因子为：\n$$\n\\mathrm{BF} = \\exp\\left( \\frac{\\mathrm{SSE}_{\\mathcal{M}} - \\mathrm{SSE}_{\\mathcal{E}}}{2\\sigma^{2}} \\right)\n$$\n计算过程首先确定每个模型的预测值 $\\mu_{\\mathcal{X}}(t)$，然后计算相应的误差平方和 SSE。\n\n1.  计算表层再生模型 ($\\mathcal{E}$) 的预测值和 $\\mathrm{SSE}_{\\mathcal{E}}$。\n参数为 $L_{\\infty} = 0.35$，$k = 0.80$ 和 $\\tau = 0.50$。对于所有测量时间 $t \\in \\{1, 2, 3, 4\\}$，都有 $t > \\tau$，因此我们使用 $\\mu_{\\mathcal{E}}(t) = L_{\\infty}(1 - \\exp(-k(t - \\tau)))$。\n-   对于 $t=1$: $\\mu_{\\mathcal{E}}(1) = 0.35 \\times (1 - \\exp(-0.80(1 - 0.50))) = 0.35 \\times (1 - \\exp(-0.40)) \\approx 0.115388$\n-   对于 $t=2$: $\\mu_{\\mathcal{E}}(2) = 0.35 \\times (1 - \\exp(-0.80(2 - 0.50))) = 0.35 \\times (1 - \\exp(-1.20)) \\approx 0.244584$\n-   对于 $t=3$: $\\mu_{\\mathcal{E}}(3) = 0.35 \\times (1 - \\exp(-0.80(3 - 0.50))) = 0.35 \\times (1 - \\exp(-2.00)) \\approx 0.302633$\n-   对于 $t=4$: $\\mu_{\\mathcal{E}}(4) = 0.35 \\times (1 - \\exp(-0.80(4 - 0.50))) = 0.35 \\times (1 - \\exp(-2.80)) \\approx 0.328716$\n\n误差平方和为：\n$\\mathrm{SSE}_{\\mathcal{E}} = (y(1) - \\mu_{\\mathcal{E}}(1))^{2} + (y(2) - \\mu_{\\mathcal{E}}(2))^{2} + (y(3) - \\mu_{\\mathcal{E}}(3))^{2} + (y(4) - \\mu_{\\mathcal{E}}(4))^{2}$\n$\\mathrm{SSE}_{\\mathcal{E}} \\approx (0.10 - 0.115388)^{2} + (0.23 - 0.244584)^{2} + (0.29 - 0.302633)^{2} + (0.33 - 0.328716)^{2}$\n$\\mathrm{SSE}_{\\mathcal{E}} \\approx (-0.015388)^{2} + (-0.014584)^{2} + (-0.012633)^{2} + (0.001284)^{2}$\n$\\mathrm{SSE}_{\\mathcal{E}} \\approx 0.0002368 + 0.0002127 + 0.0001596 + 0.0000016 = 0.0006107$\n\n2.  计算形态重组模型 ($\\mathcal{M}$) 的预测值和 $\\mathrm{SSE}_{\\mathcal{M}}$。\n参数为 $L_{b} = 0.05$。平均值为常数：对于所有 $t$，$\\mu_{\\mathcal{M}}(t) = 0.05$。\n-   对于 $t=1$: $\\mu_{\\mathcal{M}}(1) = 0.05$\n-   对于 $t=2$: $\\mu_{\\mathcal{M}}(2) = 0.05$\n-   对于 $t=3$: $\\mu_{\\mathcal{M}}(3) = 0.05$\n-   对于 $t=4$: $\\mu_{\\mathcal{M}}(4) = 0.05$\n\n误差平方和为：\n$\\mathrm{SSE}_{\\mathcal{M}} = (0.10 - 0.05)^{2} + (0.23 - 0.05)^{2} + (0.29 - 0.05)^{2} + (0.33 - 0.05)^{2}$\n$\\mathrm{SSE}_{\\mathcal{M}} = (0.05)^{2} + (0.18)^{2} + (0.24)^{2} + (0.28)^{2}$\n$\\mathrm{SSE}_{\\mathcal{M}} = 0.0025 + 0.0324 + 0.0576 + 0.0784 = 0.1709$\n\n3.  计算贝叶斯因子。\n我们已知 $\\sigma = 0.12$，所以 $\\sigma^{2} = 0.0144$。\n指数项为：\n$$\n\\frac{\\mathrm{SSE}_{\\mathcal{M}} - \\mathrm{SSE}_{\\mathcal{E}}}{2\\sigma^{2}} \\approx \\frac{0.1709 - 0.0006107}{2 \\times 0.0144} = \\frac{0.1702893}{0.0288} \\approx 5.91282\n$$\n最后，贝叶斯因子是：\n$$\n\\mathrm{BF} = \\exp(5.91282) \\approx 369.753\n$$\n四舍五入到三位有效数字，我们得到 $370$。为明确有效数字，这可以表示为科学记数法 $3.70 \\times 10^{2}$。该结果远大于 $1$，表明数据为表层再生模型 $\\mathcal{E}$ 提供了比形态重组模型 $\\mathcal{M}$ 强有力的证据。", "answer": "$$\\boxed{3.70 \\times 10^{2}}$$", "id": "2668085"}, {"introduction": "最后一个练习将定量方法提升到新的层次，要求你通过编写代码来实现一个完整的模型选择流程。你将把指数和逻辑斯蒂等不同的生长模型拟合到模拟的芽基尺寸数据上，并使用赤池信息准则（$AIC_c$）等统计标准来挑选最佳模型。这项动手编程练习反映了现代生物学家不仅需要理解统计概念，更需要具备计算能力以分析复杂的生物动力学过程。[@problem_id:2668052]", "problem": "您正在为增补再生（epimorphic regeneration）过程中的芽基（blastema）大小的时间演化进行建模，并将其与形态重组（morphallaxis）进行对比，后者的尺寸变化极小，其模式形成主要通过组织重塑产生。您将获得两个基于细胞群体动力学和组织约束的机制性生长模型：一个代表无限制增殖性生长的指数模型，以及一个代表具有承载容量的生长的逻辑斯谛模型。假设测量误差是独立同分布的高斯误差。您的任务是将这两个模型拟合到数据上，计算信息准则，检查残差的时间结构，并使用一个有原则的决策规则来选择偏好的模型。\n\n基本原理：\n- 增补再生涉及增殖性生长；一个最小的无界模型是指数增长模型。指数增长模型由 $S(t)=S_{0}\\exp(rt)$ 给出，其中 $S(t)$ 是时间 $t$ 时的芽基大小，$S_{0}$ 是 $t=0$ 时的大小，$r$ 是指数增长率。\n- 受约束的增补再生可以很好地用逻辑斯谛模型来近似。逻辑斯谛增长模型由 $S(t)=\\dfrac{K}{1+\\left(\\dfrac{K-S_{0}}{S_{0}}\\right)\\exp(-rt)}$ 给出，其中 $K$ 是承载容量，$r$ 是逻辑斯谛增长率。两个模型在 $t=0$ 时都简化为 $S(0)=S_{0}$。\n- 形态重组的特征是净增长极小（总大小近似恒定），这意味着在逻辑斯谛模型中 $r \\approx 0$ 且 $K \\approx S_{0}$，或在指数模型中 $r \\approx 0$。\n- 对于方差为 $\\sigma^{2}$ 的独立高斯误差，一个具有残差平方和 $\\mathrm{RSS}$ 和 $n$ 个观测值的模型的负对数似然与 $n\\ln(\\mathrm{RSS}/n)$ 成正比。Akaike信息准则（AIC）为 $AIC = 2k + n\\ln(\\mathrm{RSS}/n)$，其中 $k$ 是均值函数中拟合参数的数量。小样本校正准则为 $AIC_{c} = AIC + \\dfrac{2k(k+1)}{n-k-1}$，条件是 $n>k+1$。\n\n您必须实现的决策规则：\n- 使用非线性最小二乘法拟合两个模型，将 $S_{0}$ 固定为第一个观测值（因此指数模型的参数为 $r$，即 $k_{\\mathrm{exp}}=1$；逻辑斯谛模型的参数为 $r$ 和 $K$，即 $k_{\\mathrm{log}}=2$）。\n- 计算两种拟合的 $AIC_{c}$ 值。如果差值 $\\Delta = |AIC_{c,\\mathrm{exp}} - AIC_{c,\\mathrm{log}}|$ 超过 $2$，则选择 $AIC_{c}$ 值较小的模型。\n- 如果 $\\Delta \\le 2$，则使用残差结构作为决胜标准：\n  - 计算每个模型的时间 $t$ 和残差之间的Pearson相关系数；将其表示为 $\\rho_{\\mathrm{exp}}$ 和 $\\rho_{\\mathrm{log}}$。\n  - 如果 $|\\rho_{\\mathrm{exp}}|$ 和 $|\\rho_{\\mathrm{log}}|$ 都小于 $0.2$，则根据简约性原则选择更简单的模型（指数模型）。\n  - 否则，选择绝对相关性 $|\\rho|$ 较小的模型（即剩余的时间结构更少）。如果数值相关性未定义，则将其视为 $0$。\n\n数据和单位：\n- 芽基大小是一个无量纲的相对大小指数（无单位）。时间单位为天，但您无需报告时间；它仅在内部用于拟合。您无需报告任何物理量；您的程序必须仅以整数形式输出模型选择。\n\n测试套件：\n对于下方的每个测试用例，通过在给定时间点上评估指定的生成模型，并使用给定的随机种子添加标准差为 $\\sigma$ 的独立高斯噪声，来生成合成观测值 $y_{i}$。所有数字均采用上述单位。请使用以下五个案例：\n\n- 案例1（具有明显饱和现象的增补再生）：\n  - 时间 $t = [0,1,2,3,4,5]$。\n  - 生成模型：逻辑斯谛模型，参数为 $S_{0}=1.0$, $r=1.0$, $K=10.0$。\n  - 噪声标准差 $\\sigma=0.02$，随机种子 $11$。\n\n- 案例2（早期增补再生，在观测窗口内近似无界）：\n  - 时间 $t = [0,1,2,3,4]$。\n  - 生成模型：指数模型，参数为 $S_{0}=1.0$, $r=0.6$。\n  - 噪声标准差 $\\sigma=0.02$，随机种子 $22$。\n\n- 案例3（类形态重组的近似恒定大小）：\n  - 时间 $t = [0,1,2,3,4,5,6]$。\n  - 生成模型：恒定大小，参数为 $S_{0}=5.0$（等效于 $r=0$ 和 $K=S_{0}$ 的逻辑斯谛模型）。\n  - 噪声标准差 $\\sigma=0.03$，随机种子 $33$。\n\n- 案例4（接近饱和且具有强曲率的短时间序列）：\n  - 时间 $t = [0,0.5,1.0,1.5]$。\n  - 生成模型：逻辑斯谛模型，参数为 $S_{0}=0.5$, $r=1.2$, $K=3.0$。\n  - 噪声标准差 $\\sigma=0.02$，随机种子 $44$。\n\n- 案例5（观测窗口内具有极大承载容量的逻辑斯谛模型；实际上等效于指数模型）：\n  - 时间 $t = [0,1,2,3,4]$。\n  - 生成模型：逻辑斯谛模型，参数为 $S_{0}=1.0$, $r=0.5$, $K=100.0$。\n  - 噪声标准差 $\\sigma=0.02$，随机种子 $55$。\n\n输出规格：\n- 对于每个案例，将您选择的模型编码为一个整数：指数模型 $\\rightarrow 0$，逻辑斯谛模型 $\\rightarrow 1$。\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，例如 $[0,1,0,1,0]$。", "solution": "该问题要求实现一个有原则的模型选择程序，以区分两种再生长模型：无界指数模型和受约束的逻辑斯谛模型。选择过程在合成生成的数据集上进行，这些数据集模拟了各种生物学场景，从纯指数增长到饱和的逻辑斯谛增长，再到近似静态的形态调整式再生。\n\n该分析基于成熟的统计方法，即非线性最小二乘拟合和使用小样本校正的Akaike信息准则（$AIC_c$）进行模型比较。当主要准则无法做出明确判断时，则采用基于残差分析的次要决胜规则。\n\n首先，我们定义两个用于描述芽基大小 $S(t)$ 随时间 $t$ 变化的确定性生长模型。\n指数增长模型由下式给出：\n$$S_{\\text{exp}}(t; r, S_0) = S_0 e^{rt}$$\n其中 $S_0$ 是 $t=0$ 时的初始大小，$r$ 是指数增长率。该模型只有一个自由参数 $r$，因为 $S_0$ 是根据数据固定的。\n\n逻辑斯谛增长模型由下式给出：\n$$S_{\\text{log}}(t; r, K, S_0) = \\frac{K}{1 + \\left(\\frac{K-S_0}{S_0}\\right)e^{-rt}}$$\n其中 $K$ 是承载容量，$r$ 是逻辑斯谛增长率。该模型有两个自由参数 $r$和 $K$，因为 $S_0$ 同样是固定的。\n\n对于一个包含 $n$ 个观测值 $\\{(t_i, y_i)\\}_{i=1}^n$ 的给定数据集，我们首先根据指定的生成模型和噪声特性生成数据。然后，我们将两个模型拟合到这些观测值上。拟合过程使用非线性最小二乘法，以找到使残差平方和（$\\mathrm{RSS}$）最小化的参数值：\n$$\\mathrm{RSS} = \\sum_{i=1}^{n} (y_i - S(t_i))^2$$\n在此任务中，初始大小 $S_0$ 不是一个拟合参数；它被固定为第一个观测值 $y_1$（在 $t_1=0$ 时）的值。因此，指数模型的拟合参数数量为 $k_{\\text{exp}} = 1$，逻辑斯谛模型的拟合参数数量为 $k_{\\text{log}} = 2$。\n\n模型选择的核心是小样本校正的Akaike信息准则（$AIC_c$），它在模型的拟合优度（由$\\mathrm{RSS}$衡量）和模型复杂度（由$k$衡量）之间取得了平衡。其定义如下：\n$$AIC_c = n \\ln\\left(\\frac{\\mathrm{RSS}}{n}\\right) + 2k + \\frac{2k(k+1)}{n-k-1}$$\n该公式在 $n > k+1$ 时有效，所有测试用例均满足此条件。我们为每个数据集计算 $AIC_{c, \\text{exp}}$ 和 $AIC_{c, \\text{log}}$。\n\n指定的决策规则是一个两阶段过程：\n1.  计算绝对差值 $\\Delta = |AIC_{c, \\text{exp}} - AIC_{c, \\text{log}}|$。如果 $\\Delta > 2$，则认为一个模型优于另一个的证据是显著的。我们选择 $AIC_c$ 值较小的模型。指数模型编码为 $0$，逻辑斯谛模型编码为 $1$。\n\n2.  如果 $\\Delta \\le 2$，则基于 $AIC_c$ 认为这两个模型在统计上是可比较的。此时启用基于残差 $e_i = y_i - \\hat{S}(t_i)$ 结构的决胜规则。我们通过计算时间 $t_i$ 与相应残差 $e_i$ 之间的Pearson相关系数 $\\rho$ 来分析残差中的时间趋势。将这些相关系数表示为 $\\rho_{\\text{exp}}$ 和 $\\rho_{\\text{log}}$。\n    - 如果两个模型产生的残差都具有可忽略的时间结构（定义为 $|\\rho_{\\text{exp}}| < 0.2$ 且 $|\\rho_{\\text{log}}| < 0.2$），我们应用简约性原则，选择更简单的模型，即指数模型（选择 $0$）。\n    - 否则，我们选择在其残差中留下更少时间结构的模型，即绝对相关性 $|\\rho|$ 较小的模型。如果相关性在数值上未定义（例如，由于残差方差为零），则将其视为 $0$。\n\n对五个测试用例中的每一个执行此程序。对于每个案例，我们：\na. 使用指定的生成模型、参数、噪声水平 $\\sigma$ 和随机种子，生成时间点 $t$ 和带噪声的观测值 $y$。\nb. 固定用于拟合的初始大小，$S_{0,\\text{fit}} = y_1$。\nc. 执行非线性最小二乘优化，以找到最佳拟合参数，并计算 $\\mathrm{RSS}_{\\text{exp}}$ 和 $\\mathrm{RSS}_{\\text{log}}$。\nd. 计算 $AIC_{c,\\text{exp}}$ 和 $AIC_{c,\\text{log}}$。\ne. 应用完整的决策逻辑来选择模型，并记录相应的整数代码。\n\n这种系统性的方法确保了基于所提供标准的客观且可复现的选择。最终的实现将这整个工作流程封装在一个单独的程序中。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Implements a model selection procedure to choose between exponential and\n    logistic growth models for synthetic regeneration data.\n    \"\"\"\n\n    # Model equations\n    def exponential_model(t, s0, r):\n        return s0 * np.exp(r * t)\n\n    def logistic_model(t, s0, r, k):\n        # Add a small epsilon to s0 in the denominator to avoid division by zero\n        # if s0 happens to be exactly 0, though not expected in these cases.\n        s0_safe = s0 if s0 != 0 else 1e-9\n        return k / (1 + ((k - s0) / s0_safe) * np.exp(-r * t))\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {\n            \"name\": \"Case 1: epimorphosis with clear saturation\",\n            \"times\": np.array([0, 1, 2, 3, 4, 5], dtype=float),\n            \"gen_model\": \"logistic\",\n            \"params\": {\"S0\": 1.0, \"r\": 1.0, \"K\": 10.0},\n            \"sigma\": 0.02,\n            \"seed\": 11,\n        },\n        {\n            \"name\": \"Case 2: early-phase epimorphosis\",\n            \"times\": np.array([0, 1, 2, 3, 4], dtype=float),\n            \"gen_model\": \"exponential\",\n            \"params\": {\"S0\": 1.0, \"r\": 0.6},\n            \"sigma\": 0.02,\n            \"seed\": 22,\n        },\n        {\n            \"name\": \"Case 3: morphallaxis-like near-constant size\",\n            \"times\": np.array([0, 1, 2, 3, 4, 5, 6], dtype=float),\n            \"gen_model\": \"constant\",\n            \"params\": {\"S0\": 5.0},\n            \"sigma\": 0.03,\n            \"seed\": 33,\n        },\n        {\n            \"name\": \"Case 4: short series near saturation\",\n            \"times\": np.array([0, 0.5, 1.0, 1.5], dtype=float),\n            \"gen_model\": \"logistic\",\n            \"params\": {\"S0\": 0.5, \"r\": 1.2, \"K\": 3.0},\n            \"sigma\": 0.02,\n            \"seed\": 44,\n        },\n        {\n            \"name\": \"Case 5: logistic with very large carrying capacity\",\n            \"times\": np.array([0, 1, 2, 3, 4], dtype=float),\n            \"gen_model\": \"logistic\",\n            \"params\": {\"S0\": 1.0, \"r\": 0.5, \"K\": 100.0},\n            \"sigma\": 0.02,\n            \"seed\": 55,\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # 1. Generate synthetic data\n        rng = np.random.default_rng(case[\"seed\"])\n        t_data = case[\"times\"]\n        n = len(t_data)\n        s0_true = case[\"params\"][\"S0\"]\n\n        if case[\"gen_model\"] == \"exponential\":\n            r_true = case[\"params\"][\"r\"]\n            y_true = exponential_model(t_data, s0_true, r_true)\n        elif case[\"gen_model\"] == \"logistic\":\n            r_true, k_true = case[\"params\"][\"r\"], case[\"params\"][\"K\"]\n            y_true = logistic_model(t_data, s0_true, r_true, k_true)\n        else: # constant\n            y_true = np.full_like(t_data, s0_true)\n\n        y_obs = y_true + rng.normal(0, case[\"sigma\"], size=n)\n        s0_fit = y_obs[0]\n\n        # 2. Fit models\n        # Exponential model fitting (k=1)\n        def exp_fit_func(t, r):\n            return exponential_model(t, s0_fit, r)\n        \n        try:\n            popt_exp, _ = curve_fit(exp_fit_func, t_data, y_obs, p0=[0.5], bounds=(0, np.inf))\n            y_pred_exp = exp_fit_func(t_data, *popt_exp)\n            rss_exp = np.sum((y_obs - y_pred_exp)**2)\n        except RuntimeError:\n            rss_exp = np.inf\n\n\n        # Logistic model fitting (k=2)\n        def log_fit_func(t, r, K):\n            return logistic_model(t, s0_fit, r, K)\n\n        # Robust bounds and initial guess for logistic fit\n        k_lower_bound = max(y_obs) if max(y_obs) > s0_fit else s0_fit\n        log_bounds = ([0, k_lower_bound], [np.inf, np.inf])\n        log_p0 = [0.5, k_lower_bound * 1.5]\n\n        try:\n            popt_log, _ = curve_fit(log_fit_func, t_data, y_obs, p0=log_p0, bounds=log_bounds, maxfev=5000)\n            y_pred_log = log_fit_func(t_data, *popt_log)\n            rss_log = np.sum((y_obs - y_pred_log)**2)\n        except RuntimeError:\n            rss_log = np.inf\n        \n        # 3. Compute AICc\n        def calculate_aicc(k, n_obs, rss):\n            if rss <= 0 or n_obs <= k + 1:\n                return np.inf\n            aic = n_obs * np.log(rss / n_obs) + 2 * k\n            aicc = aic + (2 * k * (k + 1)) / (n_obs - k - 1)\n            return aicc\n        \n        k_exp = 1\n        aicc_exp = calculate_aicc(k_exp, n, rss_exp)\n\n        k_log = 2\n        aicc_log = calculate_aicc(k_log, n, rss_log)\n\n        # 4. Apply decision rule\n        delta_aicc = abs(aicc_exp - aicc_log)\n        \n        if delta_aicc > 2:\n            choice = 0 if aicc_exp < aicc_log else 1\n        else:\n            # Tie-breaker rule based on residual correlation\n            def get_residual_correlation(y_obs_data, y_pred_data, t_points):\n                residuals = y_obs_data - y_pred_data\n                if np.std(residuals) < 1e-9: # Treat as zero variance\n                    return 0.0\n                # np.corrcoef can return nan if std is zero\n                corr_matrix = np.corrcoef(t_points, residuals)\n                return corr_matrix[0, 1] if not np.isnan(corr_matrix[0, 1]) else 0.0\n\n            rho_exp = get_residual_correlation(y_obs, y_pred_exp, t_data)\n            rho_log = get_residual_correlation(y_obs, y_pred_log, t_data)\n            \n            if abs(rho_exp) < 0.2 and abs(rho_log) < 0.2:\n                choice = 0  # Parsimony: select simpler model\n            else:\n                choice = 0 if abs(rho_exp) < abs(rho_log) else 1\n        \n        results.append(choice)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2668052"}]}