{"hands_on_practices": [{"introduction": "Waddington 景观是细胞命运决定的一个强有力的视觉隐喻。本练习将此隐喻转化为一个具体的数学模型，让你能够探索多能性的动态。通过定义一个势能函数 $U(x)$，你将分析像 Oct4 剂量和外部信号这样的关键因素如何创建一个代表原始态（naive）和始发态（primed）多能性状态的双稳态系统 [@problem_id:2644820]。这项实践有助于建立对细胞命运如何被视为动力学系统中的稳定吸引子，以及它们的相对稳定性如何被调控的基本理解。", "problem": "诱导性多能干细胞 (iPSCs) 是通过异位表达多能性转录因子（如八聚体结合转录因子4 (Oct4)）来重编程体细胞而产生的，其命运决定可受细胞外信号的影响，这些信号使细胞偏向原始或始发多能性吸引子状态。考虑一个用于描述重编程决策的最小化Waddington式景观模型，该模型沿着一个一维序参量 $x$ 展开，此序参量在始发 ($x<0$) 和原始 ($x>0$) 吸引子之间进行插值。假设梯度动力学为 $dx/dt=-dU/dx$，其势函数为\n$$\nU(x)=\\alpha x^{4}-\\beta x^{2}-\\gamma x,\n$$\n其中 $\\alpha>0$ 确保了景观从下方有界，而 $\\beta>0$ 则编码了核心多能性网络的内在双稳态能力。线性倾斜项 $\\gamma$ 聚合了细胞内Oct4剂量和外源信号的影响。具体来说，令\n$$\n\\gamma=\\kappa_{O}\\,O+\\kappa_{N}\\,S_{N}-\\kappa_{P}\\,S_{P},\n$$\n其中 $O$ 是Oct4剂量，$S_{N}$ 是净原始态促进信号输入（例如，白血病抑制因子 (LIF) 以及MEK/ERK和GSK3激酶的双重抑制，通常表示为“$2i$”），$S_{P}$ 是净始发态促进信号输入（例如，成纤维细胞生长因子 (FGF) 和Activin/Nodal），而 $\\kappa_{O},\\kappa_{N},\\kappa_{P}>0$ 是敏感性系数。\n\n仅从梯度流假设和驻点微积分出发，完成以下任务：\n- 推导势函数 $U(x)$ 拥有两个由一个排斥最大值分隔的吸引最小值（即一个真正的双盆区域）时，参数 $\\alpha$、$\\beta$ 和 $\\gamma$ 需要满足的条件。\n- 在该双盆区域中，确定唯一的临界Oct4剂量 $O^{\\ast}$，在该剂量下，原始和始发吸引子的深度完全相等（即它们的势能相等）。将 $O^{\\ast}$ 表示为 $S_{N}$、$S_{P}$ 和敏感性系数的函数。\n\n仅报告 $O^{\\ast}$ 的闭式解析表达式作为最终答案。不包括任何单位。如果得到多个代数上等价的形式，请提供一个简化的形式。不需要进行数值评估或四舍五入。", "solution": "对问题陈述进行验证。\n\n第一步：提取已知条件\n- 系统动力学由梯度流控制：$dx/dt = -dU/dx$。\n- 势能景观由以下函数给出：$U(x) = \\alpha x^{4} - \\beta x^{2} - \\gamma x$。\n- 参数 $\\alpha$ 和 $\\beta$ 是正常数：$\\alpha>0$, $\\beta>0$。\n- 参数 $\\gamma$ 代表一个线性倾斜，定义为：$\\gamma = \\kappa_{O}\\,O + \\kappa_{N}\\,S_{N} - \\kappa_{P}\\,S_{P}$。\n- 敏感性系数是正常数：$\\kappa_{O}>0$, $\\kappa_{N}>0$, $\\kappa_{P}>0$。\n- 变量 $O$、$S_N$ 和 $S_P$ 分别代表Oct4剂量、原始态促进信号和始发态促进信号。\n- 任务是首先推导势函数具有两个最小值和一个最大值的条件，然后找到特定的Oct4剂量 $O^{\\ast}$，使得两个最小值（吸引子）具有相等的势能。\n\n第二步：使用已知条件进行验证\n- **科学依据：** 该问题使用了一个标准的Ginzburg-Landau型势函数 $\\alpha x^4 - \\beta x^2$，并受到线性对称破缺项 $-\\gamma x$ 的扰动。这是一个用于描述双稳态和一阶相变的典范模型，在理论物理、化学和生物学中被广泛且恰当地用于为具有两个稳定状态的系统建模。参数的生物学解释与Oct4、LIF/2i信号 ($S_N$) 和FGF/Activin信号 ($S_P$) 在多能性调控中的已知作用一致。该模型是对Waddington景观的一个有效（尽管简化了）的表示。\n- **适定性：** 该问题要求两个明确定义的数学对象：使得存在三个不同实驻点（两个最小值，一个最大值）的参数 $(\\alpha, \\beta, \\gamma)$ 条件，以及一个满足在最小值处势能值的代数约束的参数 ($O$) 的特定值。这些是分岔分析中的标准且可解的问题。\n- **客观性：** 该问题以精确的数学语言表述，没有主观性或模糊性。\n\n第三步：结论与行动\n该问题具有科学依据、适定、客观且内部一致。它是一个有效的数学生物学问题。我将继续进行求解。\n\n势函数 $U(x)$ 的驻点是力 $F = -dU/dx$ 为零的位置。这些是势的临界点，通过求解 $dU/dx = 0$ 得到。\n$$\n\\frac{dU}{dx} = 4\\alpha x^{3} - 2\\beta x - \\gamma = 0\n$$\n这是一个关于 $x$ 的降次三次方程。要使势函数具有两个最小值（吸引不动点）和一个最大值（排斥不动点），这个三次方程必须有三个不同的实根。让我们记函数 $f(x) = 4\\alpha x^{3} - 2\\beta x$。我们方程的根是曲线 $y=f(x)$ 与水平线 $y=\\gamma$ 的交点。函数 $f(x)$ 在 $f'(x) = 12\\alpha x^{2} - 2\\beta = 0$ 处有局部极值，即在 $x = \\pm\\sqrt{2\\beta / (12\\alpha)} = \\pm\\sqrt{\\beta / (6\\alpha)}$ 处。\n在这些极值点处 $f(x)$ 的值为：\n$$\nf\\left(\\pm\\sqrt{\\frac{\\beta}{6\\alpha}}\\right) = 4\\alpha \\left(\\pm\\left(\\frac{\\beta}{6\\alpha}\\right)^{3/2}\\right) - 2\\beta \\left(\\pm\\sqrt{\\frac{\\beta}{6\\alpha}}\\right) = \\pm\\left( \\frac{4\\alpha\\beta^{3/2}}{6\\sqrt{6}\\alpha^{3/2}} - \\frac{2\\beta^{3/2}}{\\sqrt{6\\alpha}} \\right) = \\pm\\left( \\frac{2\\beta^{3/2}}{3\\sqrt{6\\alpha}} - \\frac{2\\beta^{3/2}}{\\sqrt{6\\alpha}} \\right) = \\mp \\frac{4\\beta^{3/2}}{3\\sqrt{6\\alpha}}\n$$\n为了存在三个不同的实根，$\\gamma$ 必须严格位于这两个极值之间：\n$$\n-\\frac{4\\beta^{3/2}}{3\\sqrt{6\\alpha}} < \\gamma < \\frac{4\\beta^{3/2}}{3\\sqrt{6\\alpha}}\n$$\n这等价于 $\\gamma^2 < \\left(\\frac{4\\beta^{3/2}}{3\\sqrt{6\\alpha}}\\right)^2$，简化后得到：\n$$\n\\gamma^2 < \\frac{16\\beta^3}{9 \\cdot 6\\alpha} = \\frac{16\\beta^3}{54\\alpha} = \\frac{8\\beta^3}{27\\alpha}\n$$\n因此，存在双盆区域的条件是 $27\\alpha\\gamma^2 < 8\\beta^3$。\n\n接下来，我们必须找到两个最小值深度相等的条件。设 $dU/dx = 0$ 的三个根为 $x_p$、$x_b$ 和 $x_n$，分别对应始发最小值、势垒最大值和原始最小值。在最小值处势能相等的条件是 $U(x_p) = U(x_n)$。\n$$\n\\alpha x_p^4 - \\beta x_p^2 - \\gamma x_p = \\alpha x_n^4 - \\beta x_n^2 - \\gamma x_n\n$$\n整理各项可得：\n$$\n\\alpha(x_n^4 - x_p^4) - \\beta(x_n^2 - x_p^2) = \\gamma(x_n - x_p)\n$$\n由于 $x_n$ 和 $x_p$ 是不同的最小值，所以 $x_n \\neq x_p$，我们可以除以 $(x_n - x_p)$：\n$$\n\\alpha(x_n+x_p)(x_n^2+x_p^2) - \\beta(x_n+x_p) = \\gamma\n$$\n这个表达式将 $\\gamma$ 与根联系起来。我们可以建立一个更直接的条件。势函数 $U(x)$ 可以分解为一个偶部 $U_{even}(x) = \\alpha x^4 - \\beta x^2$ 和一个奇部 $U_{odd}(x) = -\\gamma x$。偶部关于 $x=0$ 对称，并且当 $\\beta > 0$ 时，拥有两个深度相等的最小值。奇部，一个线性倾斜，会抬高 $x<0$ 处的势（如果 $\\gamma>0$），并降低 $x>0$ 处的势，反之亦然（如果 $\\gamma<0$）。要使总势 $U(x)$ 的最小值深度相等，这个对称破缺的倾斜必须不存在。这恰好在 $\\gamma=0$ 时发生。\n\n我们可以正式证明这一点。根据三次方程 $x^3 - \\frac{\\beta}{2\\alpha}x - \\frac{\\gamma}{4\\alpha} = 0$ 的韦达定理，根之和为零：\n$$\nx_p + x_b + x_n = 0\n$$\n可以从条件 $U(x_p) = U(x_n)$ 推导出另一个关系，该条件等价于 $\\int_{x_p}^{x_n} (dU/dx) dx = 0$。一个更高级的结果，即该势的麦克斯韦条件，证实了等深度条件就是 $\\gamma = 0$。让我们来证明这一点。\n如果 $\\gamma = 0$，势函数变为 $U(x) = \\alpha x^4 - \\beta x^2$。最小值可通过求解 $4\\alpha x^3 - 2\\beta x = 2x(2\\alpha x^2 - \\beta) = 0$ 找到。根为 $x=0$（最大值）和 $x = \\pm\\sqrt{\\beta/(2\\alpha)}$。令 $x_n = \\sqrt{\\beta/(2\\alpha)}$ 和 $x_p = -\\sqrt{\\beta/(2\\alpha)}$。\n在这些最小值处的势为：\n$$\nU(x_{p,n}) = \\alpha \\left(\\frac{\\beta}{2\\alpha}\\right)^2 - \\beta \\left(\\frac{\\beta}{2\\alpha}\\right) = \\frac{\\beta^2}{4\\alpha} - \\frac{\\beta^2}{2\\alpha} = -\\frac{\\beta^2}{4\\alpha}\n$$\n深度是相等的。反之，如果深度相等，任何非零的 $\\gamma$ 都会打破势能景观的对称性，使一个势阱比另一个更深。两个势阱具有相同能量的唯一方式是势函数完全对称，这要求 $\\gamma=0$。这在双盆区域内部严格成立。唯一的其他解对应于一个最小值和一个最大值合并的尖点边界，而该边界不“在”双盆区域内。\n\n因此，原始和始发吸引子深度相等的条件是 $\\gamma = 0$。我们用这个条件来求临界Oct4剂量 $O^{\\ast}$。\n$$\n\\gamma = \\kappa_{O}\\,O^{\\ast} + \\kappa_{N}\\,S_{N} - \\kappa_{P}\\,S_{P} = 0\n$$\n求解 $O^{\\ast}$：\n$$\n\\kappa_{O}\\,O^{\\ast} = \\kappa_{P}\\,S_{P} - \\kappa_{N}\\,S_{N}\n$$\n$$\nO^{\\ast} = \\frac{\\kappa_{P}\\,S_{P} - \\kappa_{N}\\,S_{N}}{\\kappa_{O}}\n$$\n该表达式给出了临界Oct4剂量，在此剂量下，原始态促进信号和始发态促进信号的相反影响相互平衡，从而形成一个对称的双稳态景观。", "answer": "$$\n\\boxed{\\frac{\\kappa_{P}S_{P} - \\kappa_{N}S_{N}}{\\kappa_{O}}}\n$$", "id": "2644820"}, {"introduction": "虽然静态的 Waddington 景观向我们展示了可能的终点，但它并未完全解释其间的旅程。细胞过程本质上是随机的，这意味着状态之间的转换是概率性事件。本练习在我们的景观模型中引入了噪声，并使用最小作用量路径这一强大框架来计算最可能的重编程轨迹 [@problem_id:2644797]。通过计算克服细胞状态之间能量壁垒所需的“作用量”($S^{\\star}$)，你将对重编程效率和分子瓶颈的性质获得定量的把握。", "problem": "您正在一个一维粗粒化 Waddington 式景观中为从分化态到诱导性多能干细胞 (iPSC) 态的重编程过程建模，这与基因调控网络中细胞命运动力学在吸引子附近可由随机梯度系统近似的观点相符。假设以下基本基础：\n- 一个代表低维重编程坐标的状态变量 $x(t)$ 的时间演化由一个形式为 $dx = f(x)\\,dt + \\sqrt{2D}\\,dW_t$ 的随机微分方程 (SDE) 控制，其中 $D \\gt 0$ 是由分子涨落引起的有效噪声强度，而 $W_t$ 是一个标准维纳过程。\n- 在一个梯度系统中，漂移为 $f(x) = -\\frac{dU}{dx}(x)$，对应一个平滑势 $U(x)$。吸引子对应于 $U(x)$ 的局部极小值，而不稳定鞍点在一维情况下对应于 $U(x)$ 的局部极大值。\n- 两个吸引子之间的小噪声最概然转变是通过在所有连接初始吸引子到目标吸引子的路径 $x(t)$ 上（以及在所有 $T \\gt 0$ 上）最小化 Freidlin–Wentzell 作用量泛函 $S[x(\\cdot)] = \\frac{1}{4D}\\int_{0}^{T}\\left(\\dot{x}(t)-f(x(t))\\right)^{2}\\,dt$ 来获得的。该泛函的极小值 $S^{\\star}$ 控制了转变概率的主指数标度。\n\n考虑以下特定势\n$$\nU(x) \\;=\\; \\tfrac{1}{4}\\left(x^{2}-1\\right)^{2} \\;+\\; h\\,x,\n$$\n其中参数为 $h \\in \\mathbb{R}$。只要 $|h|$ 足够小，该势就有两个极小值（$x \\approx -1$ 附近的分化态和 $x \\approx +1$ 附近的诱导性多能干细胞 (iPSC) 态），由一个局部极大值（鞍点）分隔。设 $x_{L}$ 表示左侧极小值（分化态）的 $x$ 坐标，$x_{R}$ 表示右侧极小值（iPSC 态）的坐标，$x_{S}$ 表示它们之间的鞍点。确定性漂移为 $f(x)=-U'(x) = -\\left(x(x^{2}-1)+h\\right)$。\n\n任务：\n- 对于下面测试套件中的每个参数对 $(h,D)$，确定从 $x_{L}$ 到 $x_{R}$ 的最概然重编程轨迹（在一维最小作用量路径的意义上），并计算从左到右转变对应的最小作用量 $S^{\\star}$。您的程序应：\n  1. 通过求解 $U'(x)=0$ 并使用 $U''(x)$ 对临界点进行分类，来确定 $x_{L}$、$x_{S}$ 和 $x_{R}$。\n  2. 使用梯度系统中作用量最小化的定义，得到 $S^{\\star}$ 作为从左到右转变中 $U$ 和 $D$ 的函数。\n  3. 对每个测试用例，仅报告 $S^{\\star}$ 的值，该值应为精确到六位小数的浮点数。\n\n解释说明（供您推理，非程序输出）：在这个一维梯度设定中，最概然的重编程路径是逆着确定性漂移从 $x_{L}$ 爬升到 $x_{S}$，然后确定性地下降到 $x_{R}$。能垒高度 $\\Delta U = U(x_{S})-U(x_{L})$ 对应于一个分子瓶颈：在固定的 $D$ 下，较大的 $\\Delta U$ 意味着一个更稀有、瓶颈化更严重的转变。\n\n测试套件（每个用例为 $(h,D)$）：\n- 用例 1：$(h,D) = (\\,0.2,\\,0.05\\,)$\n- 用例 2：$(h,D) = (\\,0.0,\\,0.05\\,)$\n- 用例 3：$(h,D) = (\\,0.35,\\,0.05\\,)$\n- 用例 4：$(h,D) = (\\,0.2,\\,0.10\\,)$\n\n输出规格：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的四个 $S^{\\star}$ 值的列表，顺序与上述测试套件用例的顺序相同，每个值都四舍五入到恰好六位小数，并用方括号括起来。例如，格式必须像 $[s_1,s_2,s_3,s_4]$，其中每个 $s_i$ 是小数点后有六位数字的小数。", "solution": "首先必须对所述问题的科学和逻辑完整性进行验证。\n\n**第 1 步：提取的已知条件**\n- 状态变量 $x(t)$ 遵循随机微分方程 (SDE)：$dx = f(x)\\,dt + \\sqrt{2D}\\,dW_t$。\n- 噪声强度为 $D > 0$。\n- $W_t$ 是标准维纳过程。\n- 该系统是梯度系统，漂移为 $f(x) = -\\frac{dU}{dx}(x)$。\n- 势函数由 $U(x) = \\tfrac{1}{4}\\left(x^{2}-1\\right)^{2} + h\\,x$ 给出，其中 $h \\in \\mathbb{R}$。\n- 具体漂移为 $f(x) = -U'(x) = -(x(x^2-1) + h) = -x^3 + x - h$。\n- 吸引子（极小值）记为 $x_L$（分化态）和 $x_R$（iPSC 态）。\n- 鞍点（局部极大值）记为 $x_S$。\n- 任务是对于给定的 $(h, D)$ 对，计算从 $x_L$ 到 $x_R$ 转变的最小作用量 $S^{\\star}$。\n- 最小作用量 $S^{\\star}$ 是 Freidlin–Wentzell 作用量泛函 $S[x(\\cdot)] = \\frac{1}{4D}\\int_{0}^{T}\\left(\\dot{x}(t)-f(x(t))\\right)^{2}\\,dt$ 的最小值。\n- 计算步骤规定如下：\n  1. 通过求解 $U'(x)=0$ 找到临界点 $x_L$、$x_S$、$x_R$。\n  2. 使用作用量最小化的定义找到 $S^{\\star}$。\n  3. 对每个测试用例，报告四舍五入到六位小数的 $S^{\\star}$。\n- 测试套件：用例 1：$(h,D) = (0.2, 0.05)$；用例 2：$(h,D) = (0.0, 0.05)$；用例 3：$(h,D) = (0.35, 0.05)$；用例 4：$(h,D) = (0.2, 0.10)$。\n\n**第 2 步：使用提取的已知条件进行验证**\n根据所需标准评估问题。\n- **有科学依据**：问题是在随机梯度系统和 Freidlin-Wentzell 理论的既定框架内提出的，这是统计物理学的基石。将其应用于 Waddington 式景观以模拟细胞重编程是理论生物学中一种标准且科学有效的方法。该模型是一个简化，但并非基于错误的假设或伪科学。\n- **适定的**：势 $U(x)$ 是一个受线性项 $h x$ 扰动的双阱势。对于足够小的 $|h|$，势保证有两个极小值和一个极大值。临界点是三次方程 $U'(x) = x^3 - x + h = 0$ 的根。这个三次方程的判别式是 $\\Delta = 4 - 27h^2$。对于三个不同的实根，需要 $\\Delta > 0$，这意味着 $|h| < \\sqrt{4/27} \\approx 0.3849$。所有给定的 $h$ 值（$0.0$、$0.2$、$0.35$）都满足这个条件。一维转变的最小作用量计算是一个标准、明确定义且有唯一解的问题。\n- **客观的**：问题以精确的数学术语陈述，没有歧义或主观论断。\n\n该问题不违反任何无效标准。它是科学合理的、适定的、客观的、完整的和可验证的。\n\n**第 3 步：结论与操作**\n问题被判定为**有效**。将提供一个解决方案。\n\n问题要求计算从一个稳定态 $x_{L}$ 到另一个稳定态 $x_{R}$ 的最小作用量 $S^{\\star}$。对于由小噪声驱动的一维梯度系统，最概然转变路径（或称瞬子）是最小化 Freidlin-Wentzell 作用量泛函的路径。该路径涉及系统通过遵循时间反向的确定性动力学从初始极小值 $x_{L}$ 移动到分离的鞍点 $x_S$。一旦到达鞍点，系统将确定性地演化到另一个极小值 $x_R$，对作用量的贡献可以忽略不计。\n\n最小作用量 $S^{\\star}$ 由沿此最优路径的拉格朗日量积分给出。Freidlin-Wentzell 理论对于梯度系统 $dx = -U'(x) dt + \\sqrt{2D} dW_t$ 的一个标准结果指出，从一个极小值 $x_A$ 到相邻鞍点 $x_S$ 的最小作用量是势垒高度的两倍，再除以噪声的方差。作用量由以下公式给出：\n$S^{\\star} = \\frac{2}{4D} \\int_{x_A}^{x_S} |U'(x)| dx = \\frac{1}{2D} \\int_{x_A}^{x_S} (-U'(x)) dx = \\frac{1}{2D} [-U(x)]_{x_A}^{x_S} = \\frac{U(x_A) - U(x_S)}{2D}$\n不，这是不正确的。必须仔细进行论证。最优路径满足 $\\dot{x} = -f(x) = U'(x)$ 以从 $x_L$ 到达 $x_S$。\n将 $\\dot{x} = -f(x)$ 代入作用量泛函得到：\n$S^{\\star} = \\frac{1}{4D}\\int_{0}^{\\infty}\\left(-f(x(t)) - f(x(t))\\right)^{2}\\,dt = \\frac{1}{D}\\int_{0}^{\\infty} f(x(t))^2 dt$\n我们将积分变量从时间 $t$ 变为空间 $x$。由于 $\\frac{dx}{dt} = -f(x)$，我们有 $dt = -\\frac{dx}{f(x)}$。路径从 $x_L$ 延伸到 $x_S$。\n$S^{\\star} = \\frac{1}{D}\\int_{x_L}^{x_S} f(x)^2 \\left(-\\frac{dx}{f(x)}\\right) = -\\frac{1}{D} \\int_{x_L}^{x_S} f(x) dx$\n代入 $f(x) = -U'(x)$：\n$S^{\\star} = -\\frac{1}{D} \\int_{x_L}^{x_S} (-U'(x)) dx = \\frac{1}{D} \\int_{x_L}^{x_S} U'(x) dx = \\frac{1}{D} [U(x)]_{x_L}^{x_S}$\n因此，最小作用量的正确公式是：\n$$S^{\\star} = \\frac{U(x_S) - U(x_L)}{D}$$\n这是转变的势能垒，除以噪声强度 $D$。其步骤如下：\n1.  对于给定的 $h$，求三次多项式 $p(x) = x^3 - x + h = 0$ 的三个实根。这些是临界点。\n2.  将根按升序排序：$x_1 < x_2 < x_3$。\n3.  使用二阶导数检验 $U''(x) = 3x^2 - 1$ 来确定临界点的性质。\n    -   对于 $x_1$（接近 $-1$），$U''(x_1) > 0$，所以 $x_1$ 是一个极小值。这是 $x_L$。\n    -   对于 $x_2$（接近 $0$），$U''(x_2) < 0$，所以 $x_2$ 是一个极大值。这是 $x_S$。\n    -   对于 $x_3$（接近 $+1$），$U''(x_3) > 0$，所以 $x_3$ 是一个极小值。这是 $x_R$。\n4.  使用函数 $U(x) = \\frac{1}{4}(x^2-1)^2 + hx$ 计算势差 $\\Delta U = U(x_S) - U(x_L)$。\n5.  计算作用量 $S^{\\star} = \\Delta U / D$。\n\n我们现在将此过程应用于每个测试用例。\n\n**用例 1：$(h,D) = (0.2, 0.05)$**\n1.  解方程 $x^3 - x + 0.2 = 0$。根约为 $x_1 \\approx -1.094535$，$x_2 \\approx 0.202324$，$x_3 \\approx 0.892211$。\n2.  我们确定 $x_L = x_1 \\approx -1.094535$ 和 $x_S = x_2 \\approx 0.202324$。\n3.  计算势：\n    $U(x_L) = \\frac{1}{4}((-1.094535)^2 - 1)^2 + 0.2(-1.094535) \\approx -0.209141$\n    $U(x_S) = \\frac{1}{4}((0.202324)^2 - 1)^2 + 0.2(0.202324) \\approx 0.270428$\n4.  计算作用量：\n    $\\Delta U = U(x_S) - U(x_L) \\approx 0.270428 - (-0.209141) = 0.479569$\n    $S^{\\star} = \\frac{0.479569}{0.05} = 9.59138$\n\n**用例 2：$(h,D) = (0.0, 0.05)$**\n1.  解方程 $x^3 - x = x(x-1)(x+1) = 0$。根恰好是 $x_1 = -1$，$x_2 = 0$，$x_3 = 1$。\n2.  我们确定 $x_L = -1$ 和 $x_S = 0$。\n3.  计算势：\n    $U(x_L) = U(-1) = \\frac{1}{4}((-1)^2 - 1)^2 + 0(-1) = 0$\n    $U(x_S) = U(0) = \\frac{1}{4}((0)^2 - 1)^2 + 0(0) = 0.25$\n4.  计算作用量：\n    $\\Delta U = U(x_S) - U(x_L) = 0.25 - 0 = 0.25$\n    $S^{\\star} = \\frac{0.25}{0.05} = 5.0$\n\n**用例 3：$(h,D) = (0.35, 0.05)$**\n1.  解方程 $x^3 - x + 0.35 = 0$。根约为 $x_1 \\approx -1.157604$，$x_2 \\approx 0.368832$，$x_3 \\approx 0.788772$。\n2.  我们确定 $x_L = x_1 \\approx -1.157604$ 和 $x_S = x_2 \\approx 0.368832$。\n3.  计算势：\n    $U(x_L) = \\frac{1}{4}((-1.157604)^2-1)^2 + 0.35(-1.157604) \\approx -0.376263$\n    $U(x_S) = \\frac{1}{4}((0.368832)^2-1)^2 + 0.35(0.368832) \\approx 0.315700$\n4.  计算作用量：\n    $\\Delta U = U(x_S) - U(x_L) \\approx 0.315700 - (-0.376263) = 0.691963$\n    $S^{\\star} = \\frac{0.691963}{0.05} = 13.83926$\n\n**用例 4：$(h,D) = (0.2, 0.10)$**\n1.  参数 $h=0.2$ 与用例 1 相同。因此，临界点 $x_L$、$x_S$ 和势垒 $\\Delta U$ 与用例 1 中的相同。\n2.  $\\Delta U \\approx 0.479569$。\n3.  噪声强度为 $D = 0.10$。\n4.  计算作用量：\n    $S^{\\star} = \\frac{\\Delta U}{D} = \\frac{0.479569}{0.10} = 4.79569$\n\n结果将按要求报告到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the minimal action for a stochastic transition in a 1D potential.\n\n    The problem models cellular reprogramming as a noise-induced transition between\n    attractors (minima) of a potential U(x). The state x evolves according to\n    the stochastic differential equation dx = -U'(x)dt + sqrt(2D)dW_t.\n\n    The potential is given by U(x) = (1/4)*(x^2 - 1)^2 + h*x.\n    The critical points are the roots of U'(x) = x^3 - x + h = 0.\n\n    According to Freidlin-Wentzell theory for 1D gradient systems, the minimal\n    action S_star for a transition from a left minimum (x_L) to a right\n    minimum (x_R) over a saddle point (x_S) is given by the potential\n    barrier height divided by the noise intensity D:\n    S_star = (U(x_S) - U(x_L)) / D.\n\n    This program calculates S_star for several (h, D) pairs.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.2, 0.05),  # Case 1\n        (0.0, 0.05),  # Case 2\n        (0.35, 0.05), # Case 3\n        (0.2, 0.10)   # Case 4\n    ]\n\n    results = []\n    \n    # Define the potential function U(x, h)\n    def potential(x, h):\n        \"\"\"Calculates the potential U(x) for a given x and h.\"\"\"\n        return 0.25 * (x**2 - 1)**2 + h * x\n\n    for h, D in test_cases:\n        # Step 1: Find the critical points by solving U'(x) = x^3 - x + h = 0.\n        # The coefficients of the polynomial x^3 + 0*x^2 - 1*x + h are [1, 0, -1, h].\n        coeffs = [1, 0, -1, h]\n        critical_points = np.roots(coeffs)\n        \n        # The problem setup guarantees three real roots for the given h values.\n        # We take the real part to handle any small imaginary noise from numerical computation.\n        real_roots = np.real(critical_points)\n        \n        # Step 2: Sort the roots to identify x_L, x_S, and x_R.\n        # x_L is the smallest root, x_S is the middle, and x_R is the largest.\n        sorted_roots = np.sort(real_roots)\n        x_L = sorted_roots[0]\n        x_S = sorted_roots[1]\n        \n        # Step 3: Calculate the potential energy at the minimum x_L and the saddle x_S.\n        U_L = potential(x_L, h)\n        U_S = potential(x_S, h)\n        \n        # Step 4: Calculate the potential barrier (delta U).\n        delta_U = U_S - U_L\n        \n        # Step 5: Compute the minimal action S_star.\n        S_star = delta_U / D\n        \n        # Append the result formatted to exactly six decimal places.\n        results.append(f\"{S_star:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2644797"}, {"introduction": "理论模型提供了强有力的预测，但它们必须通过实验数据得到验证。这最后一个练习将我们的焦点从建模重编程之旅转移到评估其结果上。你将扮演一位实验科学家的角色，任务是筛选潜在的 iPSC 克隆，并使用统计工具来评估不同检测方法的性能 [@problem_id:2644808]。通过计算精确率和召回率等指标，并考虑实验误差在现实世界中的成本，你将学习如何批判性地解读数据，并在研究背景下做出理性的、基于证据的决策。", "problem": "一个实验室正在对由人类成纤维细胞生成的诱导性多能干细胞（iPSCs）进行克隆筛选。在进行最终的体内畸胎瘤形成实验之前，使用了两种筛选分析方法。畸胎瘤形成是多能性（生成所有三个胚层衍生物的能力）的金标准功能性读出。分析M是一种基于标记物的免疫染色panel，用于检测OCT4、SOX2和NANOG，而分析F是一种基于胚状体（EB）形成和随后的谱系标记物定量的短期体外功能性分析。两种筛选分析都与金标准在同一组 $N=240$ 个克隆上进行了比较，得到以下混淆矩阵（计数是相对于畸胎瘤金标准给出的）：\n\n对于分析M（基于标记物）：真阳性 $TP_{M}=60$，假阳性 $FP_{M}=60$，真阴性 $TN_{M}=108$，假阴性 $FN_{M}=12$。\n\n对于分析F（体外功能性）：真阳性 $TP_{F}=54$，假阳性 $FP_{F}=12$，真阴性 $TN_{F}=156$，假阴性 $FN_{F}=18$。\n\n假设每个假阳性的下游预期边际成本为 $c_{FP}$，每个假阴性的下游预期边际成本为 $c_{FN}$，且 $c_{FP}/c_{FN}=3$。请从第一性原理出发，基于这些量的定义以及它们对观测计数的依赖性，完成以下步骤：\n\n1) 仅使用将这些指标与混淆矩阵条目相关联的定义，计算每种分析的精确率、召回率（灵敏度）和 $F_{1}$ 分数。\n\n2) 根据给定的成本比率 $c_{FP}/c_{FN}=3$，确定在分析选择和阈值调整中应强调哪个单一数值摘要：精确率、召回率或 $F_{1}$ 分数。为报告一个数值答案，请将您的选择编码为：精确率 $s=1$，召回率 $s=2$，或 $F_{1}$ 分数 $s=3$。\n\n将每个指标表示为最简精确分数（不要小数化），并按以下顺序将最终结果表示为单个行向量\n[ 分析M的精确率, 分析M的召回率, 分析M的 $F_{1}$ 分数, 分析F的精确率, 分析F的召回率, 分析F的 $F_{1}$ 分数, $s$ ]。\n无需单位。不要四舍五入。", "solution": "对问题陈述进行验证。\n\n步骤1：提取已知条件。\n克隆总数：$N=240$。\n分析M的混淆矩阵计数：真阳性 $TP_{M}=60$，假阳性 $FP_{M}=60$，真阴性 $TN_{M}=108$，假阴性 $FN_{M}=12$。\n分析F的混淆矩阵计数：真阳性 $TP_{F}=54$，假阳性 $FP_{F}=12$，真阴性 $TN_{F}=156$，假阴性 $FN_{F}=18$。\n成本比率：$c_{FP}/c_{FN}=3$。\n任务：\n1) 计算每种分析的精确率、召回率和 $F_{1}$ 分数。\n2) 根据成本比率确定应强调哪个指标，并将选择编码为：精确率 $s=1$，召回率 $s=2$，或 $F_{1}$ 分数 $s=3$。\n最终答案将以单个行向量的形式呈现。\n\n步骤2：验证。\n该问题具有科学依据，描述了在生物学背景下评估诊断或筛选分析的标准程序。所提供的数据是完整且自洽的。对于分析M，计数总和为 $60+60+108+12 = 240$。对于分析F，总和为 $54+12+156+18 = 240$。两个总和均与克隆总数 $N=240$ 相匹配。根据金标准，实际为阳性的克隆数量为 $P = TP_{M} + FN_{M} = 60+12 = 72$，这与分析F的数据一致，$P = TP_{F} + FN_{F} = 54+18=72$。实际为阴性的克隆数量为 $N_{neg} = FP_{M} + TN_{M} = 60+108 = 168$，这与分析F的数据一致，$N_{neg} = FP_{F} + TN_{F} = 12+156=168$。该问题提法明确，客观，且不含逻辑或事实错误。\n\n步骤3：结论。\n问题有效。将提供解答。\n\n这些指标是使用混淆矩阵的组成部分从第一性原理定义的：真阳性（$TP$）、假阳性（$FP$）和假阴性（$FN$）。\n精确率，或称阳性预测值（$PPV$），是阳性预测中实际正确的比例：\n$$ \\text{Precision} = \\frac{TP}{TP + FP} $$\n召回率，或称灵敏度，是实际为阳性的样本中被正确识别的比例：\n$$ \\text{Recall} = \\frac{TP}{TP + FN} $$\n$F_1$ 分数是精确率和召回率的调和平均数，提供了一个平衡的度量：\n$$ F_{1} = 2 \\cdot \\frac{\\text{Precision} \\cdot \\text{Recall}}{\\text{Precision} + \\text{Recall}} = \\frac{2 \\cdot TP}{2 \\cdot TP + FP + FN} $$\n\n第1部分：计算每种分析的指标。\n\n对于分析M：\n给定 $TP_{M}=60$，$FP_{M}=60$ 和 $FN_{M}=12$。\n分析M的精确率为：\n$$ \\text{Precision}_{M} = \\frac{TP_{M}}{TP_{M} + FP_{M}} = \\frac{60}{60 + 60} = \\frac{60}{120} = \\frac{1}{2} $$\n分析M的召回率为：\n$$ \\text{Recall}_{M} = \\frac{TP_{M}}{TP_{M} + FN_{M}} = \\frac{60}{60 + 12} = \\frac{60}{72} = \\frac{5 \\cdot 12}{6 \\cdot 12} = \\frac{5}{6} $$\n分析M的 $F_{1}$ 分数为：\n$$ F_{1, M} = \\frac{2 \\cdot TP_{M}}{2 \\cdot TP_{M} + FP_{M} + FN_{M}} = \\frac{2 \\cdot 60}{2 \\cdot 60 + 60 + 12} = \\frac{120}{120 + 72} = \\frac{120}{192} = \\frac{5 \\cdot 24}{8 \\cdot 24} = \\frac{5}{8} $$\n\n对于分析F：\n给定 $TP_{F}=54$，$FP_{F}=12$ 和 $FN_{F}=18$。\n分析F的精确率为：\n$$ \\text{Precision}_{F} = \\frac{TP_{F}}{TP_{F} + FP_{F}} = \\frac{54}{54 + 12} = \\frac{54}{66} = \\frac{9 \\cdot 6}{11 \\cdot 6} = \\frac{9}{11} $$\n分析F的召回率为：\n$$ \\text{Recall}_{F} = \\frac{TP_{F}}{TP_{F} + FN_{F}} = \\frac{54}{54 + 18} = \\frac{54}{72} = \\frac{3 \\cdot 18}{4 \\cdot 18} = \\frac{3}{4} $$\n分析F的 $F_{1}$ 分数为：\n$$ F_{1, F} = \\frac{2 \\cdot TP_{F}}{2 \\cdot TP_{F} + FP_{F} + FN_{F}} = \\frac{2 \\cdot 54}{2 \\cdot 54 + 12 + 18} = \\frac{108}{108 + 30} = \\frac{108}{138} = \\frac{18 \\cdot 6}{23 \\cdot 6} = \\frac{18}{23} $$\n\n第2部分：基于成本选择摘要指标。\n问题陈述了成本比率为 $c_{FP}/c_{FN}=3$，意味着假阳性（$c_{FP}$）的边际成本是假阴性（$c_{FN}$）的三倍。一个理性的决策过程必须优先考虑最小化成本更高的错误类型。在这种情况下，我们必须特别严格地避免假阳性。\n\n让我们研究一下这些指标与错误类型的关系：\n- 精确率定义为 $TP / (TP + FP)$。它对假阳性的数量直接且负相关地敏感。大量的 $FP$ 会严重拉低精确率分数。\n- 召回率定义为 $TP / (TP + FN)$。它对假阴性敏感，而对假阳性不敏感。\n- $F_1$ 分数同等地平衡了精确率和召回率，这隐含地假设了 $FP$ 和 $FN$ 的成本相等。\n\n由于假阳性的成本要高得多，因此必须强调最能直接反映最小化 $FP$ 这一目标的性能指标。这个指标是精确率。因此，在这种成本结构下比较分析或调整分类阈值时，应优先考虑实现更高的精确率。对此的通用框架是 $F_{\\beta}$ 分数，其中 $\\beta^2$ 是假阴性成本与假阳性成本的比率，即 $\\beta^2 = c_{FN}/c_{FP}$。这里，$\\beta^2 = 1/3$，所以 $\\beta = 1/\\sqrt{3} < 1$。当 $\\beta < 1$ 时，$F_{\\beta}$ 分数给予精确率比召回率更高的权重。问题要求在三个标准指标（精确率、召回率、$F_1$）中选择应强调哪一个。鉴于假阳性的高成本，精确率是正确的选择。\n精确率的编码是 $s=1$。\n\n最终结果向量由六个计算出的指标和选择参数 $s$ 组成：\n$[\\text{Precision}_{M}, \\text{Recall}_{M}, F_{1, M}, \\text{Precision}_{F}, \\text{Recall}_{F}, F_{1, F}, s]$。\n代入计算出的值：\n$[\\frac{1}{2}, \\frac{5}{6}, \\frac{5}{8}, \\frac{9}{11}, \\frac{3}{4}, \\frac{18}{23}, 1]$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} & \\frac{5}{6} & \\frac{5}{8} & \\frac{9}{11} & \\frac{3}{4} & \\frac{18}{23} & 1 \\end{pmatrix}}\n$$", "id": "2644808"}]}