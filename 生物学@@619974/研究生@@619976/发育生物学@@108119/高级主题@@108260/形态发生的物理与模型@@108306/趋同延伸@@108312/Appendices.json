{"hands_on_practices": [{"introduction": "趋同延伸是剧烈的组织重塑过程。然而，在其核心，这个复杂的生物过程必须遵守基本的物理定律。第一个练习将系统简化为其几何本质，要求您应用面积守恒原理——在此背景下是质量守恒的直接推论——来预测组织尺寸的变化。通过掌握这个基本计算 [@problem_id:2625506]，您将为理解形态发生的宏观约束建立一个坚实的基础。", "problem": "一个位于脊椎动物胚胎背侧中胚层中的矩形上皮组织块，在平面细胞极性（Planar Cell Polarity, PCP）的协调下，由内外侧细胞嵌入驱动，经历汇聚延伸。在所关注的时间尺度上，假设没有净细胞增殖、分层或内陷/外移，并且组织厚度保持恒定，因此面细胞密度实际上是恒定的。将该组织块视为具有恒定质量密度的连续体，并应用二维薄片中的质量守恒，这意味着面内速度场是无散度的并保持面积元不变。设初始前后长度为 $L_0 = 1$ mm，初始内外侧宽度为 $W_0 = 0.5$ mm。经过细胞嵌入后，宽度减小到 $W = 0.35$ mm。\n\n仅使用基本守恒论证和矩形面积的几何定义，确定该组织块新的前后长度 $L$。以毫米为单位表示你的最终答案。无需四舍五入；提供一个精确值。", "solution": "该问题需要基于基本守恒原理进行分析。我们首先验证问题陈述的合理性。\n\n已知条件如下：\n- 组织块是矩形的。\n- 初始前后长度：$L_0 = 1$ mm。\n- 初始内外侧宽度：$W_0 = 0.5$ mm。\n- 最终内外侧宽度：$W = 0.35$ mm。\n- 没有净细胞增殖、分层或内陷/外移。\n- 组织厚度保持恒定。\n- 面细胞密度实际上是恒定的。\n- 该组织块可被视为具有恒定质量密度 $\\rho$ 的连续体。\n- 在二维薄片中质量守恒，这意味着面积守恒。\n\n该问题具有科学依据，描述了汇聚延伸的过程，这是形态发生中的一个关键机制。诸如厚度恒定和无细胞增殖等假设，是在特定时间尺度上对此现象进行建模时使用的标准简化。该问题提法严谨、客观，并提供了一套完整且一致的信息来推导唯一解。质量守恒与面积守恒之间的联系，由密度恒定和厚度恒定的前提明确证明。因此，该问题被认为是有效的，可以构建解答。\n\n解决此问题的核心原理是质量守恒。问题陈述该组织可以被建模为具有恒定质量密度 $\\rho$ 和恒定厚度 $h$ 的连续体。组织块的总质量 $M$ 是其密度、体积 $V$ 的乘积，而体积 $V$ 又是其面积 $A$ 和厚度 $h$ 的乘积。\n\n组织块的初始质量为 $M_0 = \\rho A_0 h$，其中 $A_0$ 是初始面积。\n组织块的最终质量为 $M = \\rho A h$，其中 $A$ 是最终面积。\n\n问题指出质量是守恒的，即 $M_0 = M$。\n$$\n\\rho A_0 h = \\rho A h\n$$\n由于 $\\rho$ 和 $h$ 是非零常数，我们可以在等式两边同除以 $\\rho h$，从而得到面积守恒原理：\n$$\nA_0 = A\n$$\n这个结论在问题中也直接陈述了：“面内速度场是无散度的并保持面积元不变”。\n\n该组织块被指定为矩形。矩形的面积是其长度和宽度的乘积。\n初始面积为 $A_0 = L_0 W_0$。\n最终面积为 $A = L W$。\n\n将初始面积和最终面积相等，可得到该过程的控制方程：\n$$\nL_0 W_0 = L W\n$$\n我们的任务是求新的前后长度 $L$。我们可以重新整理方程来求解 $L$：\n$$\nL = \\frac{L_0 W_0}{W}\n$$\n现在，我们将给定值代入此表达式。这些值为 $L_0 = 1$ mm, $W_0 = 0.5$ mm, $W = 0.35$ mm。\n$$\nL = \\frac{1 \\times 0.5}{0.35}\n$$\n为了得到不含小数的精确值，我们可以将数字表示为分数：$0.5 = \\frac{1}{2}$ 和 $0.35 = \\frac{35}{100} = \\frac{7}{20}$。\n$$\nL = \\frac{1 \\times \\frac{1}{2}}{\\frac{7}{20}} = \\frac{\\frac{1}{2}}{\\frac{7}{20}} = \\frac{1}{2} \\times \\frac{20}{7} = \\frac{20}{14}\n$$\n通过将分子和分母同除以最大公约数 $2$ 来简化分数：\n$$\nL = \\frac{10}{7}\n$$\n最终的长度是 $\\frac{10}{7}$ mm。这表明，当组织在内外侧方向汇聚（宽度从 $0.5$ mm 减小到 $0.35$ mm）时，它必须在前后方向延伸（长度从 $1$ mm 增加到约 $1.43$ mm）以保持其面积守恒。", "answer": "$$\\boxed{\\frac{10}{7}}$$", "id": "2625506"}, {"introduction": "组织尺度的形变，例如在趋同延伸中观察到的剪切，并非一个整体过程，而是无数微观细胞事件涌现出的特性。下一个练习要求您推导连接单个 T1 细胞邻居交换速率与宏观组织剪切率之间的数学关系。这项练习 [@problem_id:2625556] 对于理解如何从第一性原理建立形态发生的定量预测模型至关重要。", "problem": "考虑一个平面上皮组织，它通过称为 T1 转换的拓扑邻居交换发生汇聚延伸。假设以下最小粗粒化描述成立：\n\n* 组织近似不可压缩且为二维，变形很小，因此剪切增量线性相加。\n* T1 转换作为空间均匀的泊松过程发生，其单位面积单位时间的恒定速率为 $r$。在观测时间增量 $\\mathrm{d}t$ 内，对于任何足够大的面积为 $A$ 的区域，T1 转换的期望数量为 $r A \\,\\mathrm{d}t$。\n* 平均线性细胞尺寸为 $\\ell$，根据 $\\ell$ 作为长度尺度的定义，平均细胞面积与 $\\ell^{2}$ 成正比。为简化计算，取比例常数为 $1$，因此特征细胞面积为 $\\ell^{2}$。\n* 每个 T1 转换都受到平面细胞极性 (PCP) 信号的强定向，因此在固定的实验室参考系中，所有事件都对相同的宏观工程剪切分量有贡献。每个事件在一个面积为 $a_c=\\alpha\\,\\ell^{2}$ 的紧凑“核心”区域内产生一个大小为 $\\gamma_{0}$ 的局部、均匀的工程剪切增量，其中 $\\alpha$ 是一个量级为1的无量纲常数，表示单个事件显著变形了多少个细胞面积。在此核心之外，该事件对局部剪切增量的瞬时贡献可以忽略不计。\n* 事件在时间上是稀疏的，因此可以忽略在 $\\mathrm{d}t$ 期间核心区域的重叠；线性叠加原理适用。\n\n仅使用这些假设，从宏观（面积平均）工程剪切的定义和均匀泊松过程的性质出发，推导由 T1 转换产生的宏观组织剪切率 $\\dot{\\gamma}$。你的推导应清楚地说明为什么 $\\dot{\\gamma}$ 与 $r\\,\\ell^{2}$ 成比例，并用 $\\alpha$ 和 $\\gamma_{0}$ 表示比例常数。\n\n以 $\\mathrm{s}^{-1}$ 为单位表示最终剪切率。你的最终答案必须是仅包含 $r$、$\\ell$、$\\alpha$ 和 $\\gamma_{0}$ 的单个闭式解析表达式。不需要进行数值计算。", "solution": "问题要求推导正在经历汇聚延伸的平面上皮组织的宏观组织剪切率 $\\dot{\\gamma}$。该推导必须基于一系列关于底层细胞过程（特别是 T1 转换）的粗粒化假设。\n\n我们从宏观工程剪切 $\\gamma$ 的定义开始，它是局部工程剪切 $\\gamma_{local}$ 在一个足够大的代表性组织区域 $A$ 上的空间平均值。\n$$\n\\gamma(t) = \\frac{1}{A} \\int_{A} \\gamma_{local}(\\vec{x}, t) \\,dA\n$$\n宏观剪切率 $\\dot{\\gamma}$ 是宏观剪切的时间导数：\n$$\n\\dot{\\gamma} = \\frac{d\\gamma}{dt}\n$$\n为计算此速率，我们考虑在无穷小时间间隔 $dt$ 内宏观剪切的变化量 $d\\gamma$。\n$$\nd\\gamma = \\gamma(t+dt) - \\gamma(t) = \\frac{1}{A} \\int_{A} [\\gamma_{local}(\\vec{x}, t+dt) - \\gamma_{local}(\\vec{x}, t)] \\,dA = \\frac{1}{A} \\int_{A} d\\gamma_{local}(\\vec{x}) \\,dA\n$$\n局部剪切的变化量 $d\\gamma_{local}$ 是由在时间间隔 $dt$ 内发生的 T1 转换引起的。问题指出，T1 转换以单位面积单位时间速率为 $r$ 的均匀泊松过程发生。这意味着在时间间隔 $dt$ 内，区域 $A$ 中发生的事件的期望数量 $\\langle N \\rangle$ 由下式给出：\n$$\n\\langle N \\rangle = r A \\,dt\n$$\n每个 T1 事件在一个面积为 $a_c = \\alpha \\ell^2$ 的核心区域上产生一个大小为 $\\gamma_0$ 的均匀工程剪切增量。在此核心区域之外，对剪切增量的贡献为零。问题还指出，所有事件都朝向同一方向，因此它们对剪切的贡献是相长叠加的。事件稀疏的假设允许我们使用线性叠加，这意味着我们可以忽略在同一时间间隔 $dt$ 内发生的事件的核心区域的空间重叠。\n\n设在时间间隔 $t$ 到 $t+dt$ 期间组织中发生的 T1 事件集合由 $i = 1, 2, \\dots, N$ 索引，其中 $N$ 是区域 $A$ 内的总事件数。第 $i$ 个事件的核心区域表示为 $C_i$。在点 $\\vec{x}$ 处的局部剪切的总变化是所有核心区域覆盖该点的事件贡献的总和。\n$$\nd\\gamma_{local}(\\vec{x}) = \\sum_{i=1}^{N} \\gamma_0 \\, \\mathbb{I}_{C_i}(\\vec{x})\n$$\n其中 $\\mathbb{I}_{C_i}(\\vec{x})$ 是指示函数，如果点 $\\vec{x}$ 在核心区域 $C_i$ 内，其值为 $1$，否则为 $0$。\n\n现在，我们将此表达式代入宏观剪切变化量 $d\\gamma$ 的积分中：\n$$\nd\\gamma = \\frac{1}{A} \\int_{A} \\left( \\sum_{i=1}^{N} \\gamma_0 \\, \\mathbb{I}_{C_i}(\\vec{x}) \\right) dA\n$$\n由于积分和求和是线性运算，我们可以交换它们的顺序：\n$$\nd\\gamma = \\frac{1}{A} \\sum_{i=1}^{N} \\gamma_0 \\int_{A} \\mathbb{I}_{C_i}(\\vec{x}) \\,dA\n$$\n指示函数的积分 $\\int_{A} \\mathbb{I}_{C_i}(\\vec{x}) \\,dA$ 就是核心区域 $C_i$ 的面积，即 $a_c$。我们假设区域 $A$ 足够大，可以忽略核心区域可能部分延伸到 $A$ 外部的边界效应。\n$$\n\\int_{A} \\mathbb{I}_{C_i}(\\vec{x}) \\,dA = \\text{Area}(C_i) = a_c\n$$\n将此代回，我们得到由 $N$ 个事件引起的宏观剪切的总变化：\n$$\nd\\gamma = \\frac{1}{A} \\sum_{i=1}^{N} \\gamma_0 a_c = \\frac{N \\gamma_0 a_c}{A}\n$$\n事件数 $N$ 是一个随机变量。为了找到确定性的宏观速率，我们考虑剪切的期望变化量 $\\langle d\\gamma \\rangle$。\n$$\n\\langle d\\gamma \\rangle = \\frac{\\langle N \\rangle \\gamma_0 a_c}{A}\n$$\n我们代入事件的期望数量 $\\langle N \\rangle = r A \\,dt$：\n$$\n\\langle d\\gamma \\rangle = \\frac{(r A \\,dt) \\gamma_0 a_c}{A} = r \\gamma_0 a_c \\,dt\n$$\n宏观剪切率 $\\dot{\\gamma}$ 是期望宏观剪切的变化率。因此，我们除以 $dt$：\n$$\n\\dot{\\gamma} = \\frac{\\langle d\\gamma \\rangle}{dt} = \\frac{r \\gamma_0 a_c \\,dt}{dt} = r \\gamma_0 a_c\n$$\n问题给出了核心区域面积 $a_c$ 用平均线性细胞尺寸 $\\ell$ 和无量纲常数 $\\alpha$ 表示的表达式：\n$$\na_c = \\alpha \\ell^2\n$$\n将此代入我们关于 $\\dot{\\gamma}$ 的表达式中，得到最终结果：\n$$\n\\dot{\\gamma} = r \\gamma_0 (\\alpha \\ell^2) = r \\alpha \\gamma_0 \\ell^2\n$$\n此结果表明，宏观剪切率 $\\dot{\\gamma}$ 与事件率密度 $r$ 和特征细胞面积 $\\ell^2$ 的乘积成正比，符合要求。比例常数为 $\\alpha \\gamma_0$。\n\n让我们验证单位。速率 $r$ 的单位是 $[面积]^{-1} [时间]^{-1}$，或 $\\mathrm{m}^{-2} \\mathrm{s}^{-1}$。长度 $\\ell$ 的单位是 $[长度]$，或 $\\mathrm{m}$。剪切增量 $\\gamma_0$ 和常数 $\\alpha$ 是无量纲的。因此，$\\dot{\\gamma}$ 的单位是：\n$$\n[\\dot{\\gamma}] = ([Area]^{-1} [Time]^{-1}) \\cdot [1] \\cdot [1] \\cdot ([Length]^2) = (\\mathrm{m}^{-2} \\mathrm{s}^{-1}) \\cdot \\mathrm{m}^2 = \\mathrm{s}^{-1}\n$$\n这些是剪切率的正确单位，符合要求。", "answer": "$$\n\\boxed{r \\alpha \\gamma_{0} \\ell^{2}}\n$$", "id": "2625556"}, {"introduction": "细胞重排和组织应变之间的理论联系虽然强大，但其真正的考验在于数据。最后一个练习将从理论转向应用，指导您构建一个用于分析延时数据的计算流程。通过从模拟观测中量化邻居交换速率和组织应变，并计算它们之间的相关性 [@problem_id:2625508]，您将获得现代定量发育生物学核心分析技术的实践经验。", "problem": "您将获得一个计算流程的形式化描述，用于量化每细胞每分钟的邻近细胞交换率，并将其与发育生物学中汇聚延伸（convergent extension）过程中的组织应变率 $\\dot{\\epsilon}$ 相关联。请构建一个完整的程序，仅使用提供的测试套件来实现以下要求。程序必须完全按照规定格式生成最终输出。\n\n从以下基本原理开始：\n- 组织应变率根据连续介质力学定义为 $\\dot{\\epsilon}(t) = \\frac{1}{L(t)} \\frac{dL}{dt}$，其中 $L(t)$ 是沿延伸轴的组织长度。\n- 邻近细胞交换事件（在上皮细胞片中也称为拓扑T1转换）在操作上通过两个细胞之间邻接关系的变化来标记。在具有对称二元邻接矩阵的时间离散化设置中，两个连续时间点之间切换状态的边的数量记录了邻接关系的变化。每个完成的邻近细胞交换事件会重连两条边，因此切换边数量的一半可估算出已完成的邻近细胞交换事件的数量。\n\n您的任务：\n- 用一个大小为 $N \\times N$、对角线为零的对称二元邻接矩阵序列来表示离散时间点 $t_0,\\dots,t_T$ 的细胞片，其中值为 $1$ 的条目表示相应细胞是邻居。\n- 对于每个持续时间为 $\\Delta t_k$ 秒的区间 $[t_k,t_{k+1}]$，计算：\n  1. 在 $t_k$ 和 $t_{k+1}$ 的邻接矩阵之间，切换状态的无序细胞对（上三角部分）的数量。\n  2. 邻近细胞交换事件的估计数量 $E_k$，为切换数量的一半，即 $E_k = \\frac{1}{2}\\times \\text{toggles}_k$。\n  3. 每细胞每分钟的邻近细胞交换率 $r_k$，计算公式为 $r_k = \\frac{E_k}{N} \\cdot \\frac{60}{\\Delta t_k}$。单位必须报告为“事件/细胞/分钟”。\n  4. 在同一区间内每分钟的组织应变率，使用连续介质定义的中点离散近似，即 $s_k = \\left(\\frac{\\ln L_{k+1} - \\ln L_k}{\\Delta t_k}\\right)\\cdot 60$，其中 $L_k$ 表示时间 $t_k$ 的组织长度。\n- 使用 Pearson 相关系数 (PCC) 对序列 $\\{r_k\\}_{k=0}^{T-1}$ 和 $\\{s_k\\}_{k=0}^{T-1}$ 进行相关性分析。如果任一序列的方差为零，则定义相关性为 $0$。\n- 对于每个测试用例，通过每细胞每分钟的平均邻近细胞交换率 $\\bar{r} = \\frac{1}{T}\\sum_{k=0}^{T-1} r_k$ 来总结邻近细胞交换动态。\n\n实现约束：\n- 使用以下测试套件。在每个测试中，细胞数量为 $N$，每个区间的持续时间为 $\\Delta t_k = \\Delta t$ 秒，邻接关系通过每个时间点的无序边集给出，$L_k$ 是以微米为单位测量的组织长度。从每个边集构建对角线为零的对称二元邻接矩阵。所有索引都是从零开始的。\n\n测试套件：\n- 测试 1 (正常路径，变化的邻近细胞交换和正应变)：\n  - $N = 4$\n  - $\\Delta t = 60$\n  - $t_0$ 时的边： $\\{(0,1),(1,2),(2,3)\\}$\n  - $t_1$ 时的边： $\\{(0,1),(0,2),(2,3)\\}$\n  - $t_2$ 时的边： $\\{(0,1),(0,2),(2,3)\\}$ (与 $t_1$ 相同)\n  - $t_3$ 时的边： $\\{(0,1),(1,2),(2,3)\\}$\n  - 长度： $[100.0, 101.0, 101.5, 104.0]$ 微米\n- 测试 2 (边缘情况，无重连且无应变)：\n  - $N = 4$\n  - $\\Delta t = 60$\n  - $t_0$ 时的边： $\\{(0,1),(1,2),(2,3),(3,0)\\}$\n  - $t_1$ 时的边： $\\{(0,1),(1,2),(2,3),(3,0)\\}$\n  - $t_2$ 时的边： $\\{(0,1),(1,2),(2,3),(3,0)\\}$\n  - $t_3$ 时的边： $\\{(0,1),(1,2),(2,3),(3,0)\\}$\n  - 长度： $[120.0, 120.0, 120.0, 120.0]$ 微米\n- 测试 3 (负相关场景：当应变为负时，邻近细胞交换频繁)：\n  - $N = 4$\n  - $\\Delta t = 60$\n  - $t_0$ 时的边： $\\{(0,1),(1,2),(2,3)\\}$\n  - $t_1$ 时的边： $\\{(0,1),(0,2),(1,3)\\}$\n  - $t_2$ 时的边： $\\{(0,1),(0,2),(1,3)\\}$\n  - $t_3$ 时的边： $\\{(0,1),(1,3),(2,3)\\}$\n  - 长度： $[150.0, 147.0, 147.0, 146.0]$ 微米\n\n角度单位不适用。所有类速率的量必须以“每分钟”为单位报告。两个序列之间的 Pearson 相关系数 (PCC) 必须是无量纲的浮点数。\n\n最终输出规范：\n- 对于每个测试用例，按顺序计算两个浮点数：每细胞每分钟的平均邻近细胞交换率 $\\bar{r}$ 和 $\\{r_k\\}$ 与 $\\{s_k\\}$ 之间的 Pearson 相关系数。\n- 将所有浮点数四舍五入到恰好六位小数。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，每个测试用例的结果是一个双元素列表，例如：`[[\\bar{r}_1, corr_1], [\\bar{r}_2, corr_2], [\\bar{r}_3, corr_3]]`。", "solution": "该问题要求实现一个计算分析流程，以量化汇聚延伸过程中细胞重排动态与组织形变的关系，并进行相关性分析。该问题具有科学依据，定义明确，并为获得唯一解提供了所有必要信息。因此，该问题被视为有效。解决方案将基于离散微积分和统计分析的原理构建，并应用于上皮组织动态的简化模型。\n\n**1. 数据表示与预处理**\n\n在离散时间点 $t_k$，细胞片的状态由一个大小为 $N \\times N$ 的对称二元邻接矩阵 $A_k$ 表示，其中 $N$ 是细胞数量。条目 $A_k(i, j) = 1$ 表示细胞 $i$ 和 $j$ 在时间 $t_k$ 是邻居，否则 $A_k(i, j) = 0$。按照惯例，对角线上的条目 $A_k(i, i)$ 为零。这些矩阵是根据所提供的邻近细胞无序对（边）集合构建的。对于每个时间点 $t_k$，初始化一个 $N \\times N$ 的零矩阵。对于给定集合中的每条边 $(u, v)$，将与该对相对应的条目 $A_k(u, v)$ 和 $A_k(v, u)$ 设置为 $1$。\n\n**2. 细胞重排率的量化**\n\n邻近细胞交换事件，即 T1 转换，表现为细胞间邻接关系的变化。在一个时间区间 $[t_k, t_{k+1}]$ 内，此类变化的数量通过比较邻接矩阵 $A_k$ 和 $A_{k+1}$ 来量化。\n\n切换状态的无序细胞对数量 $\\text{toggles}_k$ 是指满足 $i < j$ 且邻接状态发生变化的对 $(i, j)$ 的计数。这通过计算两个矩阵的逐元素差 $D_k = A_{k+1} - A_k$，并对上三角部分条目的绝对值求和来计算：\n$$\n\\text{toggles}_k = \\sum_{i=0}^{N-2} \\sum_{j=i+1}^{N-1} |A_{k+1}(i, j) - A_k(i, j)|\n$$\n假定每个完成的邻近细胞交换事件会重连两条边（即，在上三角中引起两次切换，一次连接丢失，一次连接获得）。因此，该区间内事件的估计数量 $E_k$ 为：\n$$\nE_k = \\frac{1}{2} \\times \\text{toggles}_k\n$$\n然后，通过将 $E_k$ 按细胞数 $N$ 和区间持续时间 $\\Delta t_k$（以秒为单位）进行归一化，并乘以 $60$ 转换为每分钟的基准，来计算每细胞每分钟的邻近细胞交换率 $r_k$：\n$$\nr_k = \\frac{E_k}{N} \\cdot \\frac{60}{\\Delta t_k}\n$$\n\n**3. 组织应变率的量化**\n\n组织应变率 $\\dot{\\epsilon}(t)$ 在连续介质力学中定义为 $\\dot{\\epsilon}(t) = \\frac{1}{L(t)} \\frac{dL}{dt}$，其中 $L(t)$ 是组织长度。在一个离散区间 $[t_k, t_{k+1}]$ 上，这可以通过对该定义进行积分来近似，从而得到对数应变率（或真实应变率）：\n$$\n\\int_{t_k}^{t_{k+1}} \\dot{\\epsilon}(t) dt = \\int_{L(t_k)}^{L(t_{k+1})} \\frac{dL}{L} = \\ln(L(t_{k+1})) - \\ln(L(t_k))\n$$\n假设在持续时间为 $\\Delta t_k$ 的区间内应变率 $s_k$ 恒定，我们得到 $s_k \\cdot \\Delta t_k = \\ln(L_{k+1}) - \\ln(L_k)$。我们求解 $s_k$ 并将其单位转换为每分钟：\n$$\ns_k = \\left(\\frac{\\ln L_{k+1} - \\ln L_k}{\\Delta t_k}\\right) \\cdot 60\n$$\n\n**4. 统计分析与总结**\n\n在计算出 $T$ 个区间的时间序列 $\\{r_k\\}_{k=0}^{T-1}$ 和 $\\{s_k\\}_{k=0}^{T-1}$ 之后，为每个测试用例计算两个摘要统计量。\n\n首先，平均邻近细胞交换率 $\\bar{r}$ 计算为所有区间速率的算术平均值：\n$$\n\\bar{r} = \\frac{1}{T} \\sum_{k=0}^{T-1} r_k\n$$\n其次，使用 Pearson 相关系数 (PCC) 来量化两个序列之间的关系。对于长度为 $T$ 的两个序列 $X = \\{x_i\\}$ 和 $Y = \\{y_i\\}$，PCC 定义为：\n$$\n\\rho_{X,Y} = \\frac{\\sum_{i=0}^{T-1} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=0}^{T-1} (x_i - \\bar{x})^2} \\sqrt{\\sum_{i=0}^{T-1} (y_i - \\bar{y})^2}}\n$$\n其中 $\\bar{x}$ 和 $\\bar{y}$ 分别是各自序列的均值。如果任一序列的方差为零（即所有元素都相同），则分母为零。根据问题规范，在这种情况下，相关系数定义为 $0$。在计算上，这将使用 `numpy.corrcoef` 来处理，该函数通过生成可映射为 $0$ 的 `NaN` 来正确处理此场景，或者也可以在计算前显式检查方差是否为零。\n\n最终的实现将处理提供的测试套件中的每个测试用例，执行这些步骤以生成所需的值对：$\\bar{r}$ 和 PCC，并四舍五入到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the convergent extension problem for the given test suite.\n    \"\"\"\n    test_cases = [\n        # Test 1 (happy path, variable neighbor exchanges and positive strain)\n        {\n            \"N\": 4,\n            \"dt\": 60,\n            \"edges\": [\n                {(0, 1), (1, 2), (2, 3)},\n                {(0, 1), (0, 2), (2, 3)},\n                {(0, 1), (0, 2), (2, 3)},\n                {(0, 1), (1, 2), (2, 3)},\n            ],\n            \"lengths\": [100.0, 101.0, 101.5, 104.0],\n        },\n        # Test 2 (edge case with no rewiring and no strain)\n        {\n            \"N\": 4,\n            \"dt\": 60,\n            \"edges\": [\n                {(0, 1), (1, 2), (2, 3), (3, 0)},\n                {(0, 1), (1, 2), (2, 3), (3, 0)},\n                {(0, 1), (1, 2), (2, 3), (3, 0)},\n                {(0, 1), (1, 2), (2, 3), (3, 0)},\n            ],\n            \"lengths\": [120.0, 120.0, 120.0, 120.0],\n        },\n        # Test 3 (negative correlation scenario: high neighbor exchange when strain is negative)\n        {\n            \"N\": 4,\n            \"dt\": 60,\n            \"edges\": [\n                {(0, 1), (1, 2), (2, 3)},\n                {(0, 1), (0, 2), (1, 3)},\n                {(0, 1), (0, 2), (1, 3)},\n                {(0, 1), (1, 3), (2, 3)},\n            ],\n            \"lengths\": [150.0, 147.0, 147.0, 146.0],\n        },\n    ]\n\n    final_results = []\n\n    def build_adjacency_matrix(N, edges):\n        \"\"\"Constructs a symmetric binary adjacency matrix from an edge set.\"\"\"\n        adj_matrix = np.zeros((N, N), dtype=int)\n        for u, v in edges:\n            adj_matrix[u, v] = 1\n            adj_matrix[v, u] = 1\n        return adj_matrix\n\n    for case in test_cases:\n        N = case[\"N\"]\n        dt = case[\"dt\"]\n        edge_sets = case[\"edges\"]\n        lengths = case[\"lengths\"]\n\n        num_time_points = len(edge_sets)\n        adj_matrices = [build_adjacency_matrix(N, edges) for edges in edge_sets]\n\n        rates_r = []\n        strains_s = []\n\n        for k in range(num_time_points - 1):\n            A_k = adj_matrices[k]\n            A_k_plus_1 = adj_matrices[k+1]\n\n            # 1. Compute number of toggled unordered cell pairs\n            diff_matrix = np.abs(A_k_plus_1 - A_k)\n            toggles_k = np.triu(diff_matrix, k=1).sum()\n\n            # 2. Estimated number of neighbor exchange events\n            E_k = 0.5 * toggles_k\n\n            # 3. Rate of neighbor exchanges per cell per minute\n            r_k = (E_k / N) * (60 / dt)\n            rates_r.append(r_k)\n\n            # 4. Tissue strain rate\n            L_k = lengths[k]\n            L_k_plus_1 = lengths[k+1]\n            s_k = (np.log(L_k_plus_1) - np.log(L_k)) / dt * 60\n            strains_s.append(s_k)\n\n        # Summarize results\n        # Mean neighbor exchange rate\n        if rates_r:\n            mean_r = sum(rates_r) / len(rates_r)\n        else:\n            mean_r = 0.0\n\n        # Pearson correlation coefficient\n        rates_r_np = np.array(rates_r)\n        strains_s_np = np.array(strains_s)\n        \n        # Per problem spec, if either series has zero variance, correlation is 0.\n        if np.var(rates_r_np) == 0 or np.var(strains_s_np) == 0:\n            pcc = 0.0\n        else:\n            pcc = np.corrcoef(rates_r_np, strains_s_np)[0, 1]\n\n        final_results.append([mean_r, pcc])\n    \n    # Format the final output string exactly as specified.\n    result_strings = [f\"[{r:.6f}, {c:.6f}]\" for r, c in final_results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "2625508"}]}