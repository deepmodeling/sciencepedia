{"hands_on_practices": [{"introduction": "要理解同源选择基因的功能，掌握它们相互作用的层级规则至关重要。第一个练习将探讨“后方优势”（posterior prevalence）原则，这是发育生物学中的一个基本概念。通过分析一个在果蝇（Drosophila）中的经典遗传思想实验，你将练习在前后两个Hox基因于同一体节共表达时，如何预测最终的形态学结果，从而磨练你应用核心发育原则解决问题的能力。[@problem_id:1693247]", "problem": "在果蝇（*Drosophila melanogaster*）中，沿前后轴的体节特征由同源异形选择（Hox）基因的表达决定。第二胸节（T2）正常情况下表达Hox基因*Antennapedia* (*Antp*)，该基因指导翅膀的发育。相邻的后部体节，即第三胸节（T3），表达Hox基因*Ultrabithorax* (*Ubx*)，该基因指导一对称为平衡棒的小型平衡器官的发育。\n\n考虑一个实验，其中一项遗传操作导致*Ubx*基因在果蝇胚胎的整个T2体节中异位表达（即，在异常位置表达）。这个T2体节现在同时含有其正常驻留基因*Antp*和异位表达的后部基因*Ubx*的蛋白质产物。\n\n根据已确立的Hox基因相互作用原则，以下哪一项是成年果蝇T2体节最可能的表型？\n\nA. T2体节将发育成一个正常的翅膀。\n\nB. T2体节将被转化并发育成一个平衡棒。\n\nC. T2体节将发育成一个兼具翅膀和平衡棒特征的混合结构。\n\nD. T2体节上的附肢将无法发育，导致该体节没有外部结构。", "solution": "- 在野生型果蝇中，沿前后轴的体节特征由Hox基因控制。T2表达Antennapedia (Antp)并形成翅膀；T3表达Ultrabithorax (Ubx)并形成平衡棒。\n- Hox基因相互作用的一个核心原则是后部优先（posterior prevalence，或称后部显性 posterior dominance）：当前部和后部Hox基因共表达时，后部Hox基因是上位的，并覆盖前部的发育程序，从而强加一个更靠后的体节特征。\n- 在该实验操作中，*Ubx*在已经表达*Antp*的T2体节中异位表达。因此，T2共表达*Antp*和*Ubx*。\n- 根据后部优先原则，*Ubx*的功能支配*Antp*并抑制翅膀发育程序，转而激活T3特有的平衡棒发育程序。\n- 经典遗传学证据与此一致：T3中*Ubx*的功能丧失突变将平衡棒转化为翅膀，而在T2中*Ubx*的功能获得突变则将翅膀转化为平衡棒。\n- 因此，最可能的表型是T2发生同源异形转化，呈现出类似T3的特征，长出平衡棒而非翅膀，从而排除了正常翅膀（A）、混合结构（C）或附肢缺失（D）的可能性。", "answer": "$$\\boxed{B}$$", "id": "1693247"}, {"introduction": "超越定性规则，现代发育生物学的一个核心目标是建立可预测的、定量的基因调控模型。本练习将从概念理解转向实际计算，运用一个简化的热力学框架将DNA序列的改变与基因表达水平联系起来。你将应用一个模型，其中结合亲和力（由位置权重矩阵PWM得分 $S$ 表示）通过一个类玻尔兹曼因子 $2^S$ 与表达量相关联，从而让你能够精确计算突变对增强子输出的具体影响。[@problem_id:2643483]", "problem": "一个同源异形选择子（Hox）转录因子通过两个独立的DNA基序与一个增强子结合，这两个基序的强度由其位置权重矩阵（PWM）分数来概括。假设一个基于统计力学的热力学占有框架：在平衡状态下，每个结合微观状态的统计权重与一个玻尔兹曼因子成正比。对于一个PWM分数为 $S$ （单位为比特）的单一位点，其统计权重正比于 $\\exp(\\lambda S)$，其中比特与自然单位之间的转换常数是 $\\lambda = \\ln(2)$。在低占有率区间内，结合概率很小，基因表达量与结合构象的总统计权重成正比。考虑一个具有2个独立的Hox位点的增强子，其野生型分数为 $S_1$ 和 $S_2$。设野生型表达量为 $E_{\\mathrm{wt}} = 180$ 任意单位（a.u.）。在野生型中，位点1对总结合权重的分数贡献为 $r = 0.60$，即 $r = \\frac{2^{S_1}}{2^{S_1} + 2^{S_2}}$。一次突变使位点1的PWM分数改变了 $\\Delta S_1 = -1.2$ 比特，位点2的PWM分数改变了 $\\Delta S_2 = +0.5$ 比特。所有其他分子参数（包括转录因子浓度和结合态共有的任何预因子）保持不变，并且低占有率近似在突变后仍然成立。\n\n从微观状态的玻尔兹曼权重以及表达量与总结合统计权重之间的低占有率正比关系出发，用 $E_{\\mathrm{wt}}$、$r$、$\\Delta S_1$ 和 $\\Delta S_2$ 推导出预测的突变体表达量 $E_{\\mathrm{mut}}$，然后计算其数值。将您的最终数值答案四舍五入到四位有效数字，并以任意单位（a.u.）表示。", "solution": "该问题提出了一个基于统计力学原理应用于基因调控的有效且提法恰当的问题。下面进行推导。\n\n基本前提是，在低占有率区间内，基因表达水平 $E$ 与单一结合构象的总统计权重 $W_{\\mathrm{total}}$ 成正比。\n$$E = A \\cdot W_{\\mathrm{total}} = A (W_1 + W_2)$$\n此处，$A$ 是一个全局比例常数，它包含了如转录因子浓度等系统特有参数，这些参数在野生型和突变体情景中被假设为不变的。\n\n对于一个位置权重矩阵（PWM）分数为 $S_i$ 比特的位点 $i$，其统计权重 $W_i$ 正比于 $\\exp(\\lambda S_i)$。给定转换常数 $\\lambda = \\ln(2)$，这可以简化为：\n$$W_i \\propto \\exp(\\ln(2) \\cdot S_i) = (\\exp(\\ln(2)))^{S_i} = 2^{S_i}$$\n因此，我们可以将具有分数 $S_1$ 和 $S_2$ 的野生型（${\\mathrm{wt}}$）系统的表达量写作：\n$$E_{\\mathrm{wt}} = A (2^{S_1} + 2^{S_2})$$\n根据题意，位点1对野生型总结合统计权重的分数贡献为 $r$：\n$$r = \\frac{A \\cdot 2^{S_1}}{A (2^{S_1} + 2^{S_2})} = \\frac{2^{S_1}}{2^{S_1} + 2^{S_2}} = 0.60$$\n因此，位点2的分数贡献是：\n$$1-r = \\frac{2^{S_2}}{2^{S_1} + 2^{S_2}} = 1 - 0.60 = 0.40$$\n这些关系允许我们用总权重和参数 $r$ 来表示单个统计权重项 $2^{S_1}$ 和 $2^{S_2}$：\n$$2^{S_1} = r (2^{S_1} + 2^{S_2})$$\n$$2^{S_2} = (1-r) (2^{S_1} + 2^{S_2})$$\n\n对于突变体（${\\mathrm{mut}}$）系统，PWM分数被改变了 $\\Delta S_1$ 和 $\\Delta S_2$，得到新的分数 $S'_1 = S_1 + \\Delta S_1$ 和 $S'_2 = S_2 + \\Delta S_2$。突变体的表达水平 $E_{\\mathrm{mut}}$ 由下式给出：\n$$E_{\\mathrm{mut}} = A (2^{S'_1} + 2^{S'_2}) = A (2^{S_1 + \\Delta S_1} + 2^{S_2 + \\Delta S_2})$$\n应用指数性质 $x^{a+b} = x^a x^b$，我们展开这个表达式：\n$$E_{\\mathrm{mut}} = A (2^{S_1} 2^{\\Delta S_1} + 2^{S_2} 2^{\\Delta S_2})$$\n为了用 $E_{\\mathrm{wt}}$ 和 $r$ 来表示 $E_{\\mathrm{mut}}$，我们代入 $2^{S_1}$ 和 $2^{S_2}$ 的表达式：\n$$E_{\\mathrm{mut}} = A \\left[ \\left( r (2^{S_1} + 2^{S_2}) \\right) 2^{\\Delta S_1} + \\left( (1-r) (2^{S_1} + 2^{S_2}) \\right) 2^{\\Delta S_2} \\right]$$\n提取公因式 $A (2^{S_1} + 2^{S_2})$：\n$$E_{\\mathrm{mut}} = A (2^{S_1} + 2^{S_2}) \\left[ r \\cdot 2^{\\Delta S_1} + (1-r) \\cdot 2^{\\Delta S_2} \\right]$$\n认识到 $E_{\\mathrm{wt}} = A (2^{S_1} + 2^{S_2})$，我们得到最终的符号关系式：\n$$E_{\\mathrm{mut}} = E_{\\mathrm{wt}} \\left( r \\cdot 2^{\\Delta S_1} + (1-r) \\cdot 2^{\\Delta S_2} \\right)$$\n这个推导出的公式表明，突变体的表达量是每个位点结合强度倍数变化的加权和，其中的权重是各位点对总表达量的原始分数贡献。\n\n最后一步是使用给定的数据计算 $E_{\\mathrm{mut}}$ 的数值：$E_{\\mathrm{wt}} = 180$ a.u.，$r = 0.60$，$\\Delta S_1 = -1.2$ 比特，以及 $\\Delta S_2 = +0.5$ 比特。\n$$E_{\\mathrm{mut}} = 180 \\left( 0.60 \\cdot 2^{-1.2} + (1 - 0.60) \\cdot 2^{0.5} \\right)$$\n$$E_{\\mathrm{mut}} = 180 \\left( 0.60 \\cdot 2^{-1.2} + 0.40 \\cdot 2^{0.5} \\right)$$\n我们计算指数项的数值：\n$$2^{-1.2} \\approx 0.435275$$\n$$2^{0.5} = \\sqrt{2} \\approx 1.414214$$\n将这些值代入 $E_{\\mathrm{mut}}$ 的方程中：\n$$E_{\\mathrm{mut}} \\approx 180 \\left( 0.60 \\cdot 0.435275 + 0.40 \\cdot 1.414214 \\right)$$\n$$E_{\\mathrm{mut}} \\approx 180 \\left( 0.261165 + 0.5656856 \\right)$$\n$$E_{\\mathrm{mut}} \\approx 180 \\left( 0.8268506 \\right)$$\n$$E_{\\mathrm{mut}} \\approx 148.833108$$\n题目要求将最终答案四舍五入到四位有效数字。因此，预测的突变体表达量为 $148.8$ 任意单位。", "answer": "$$\n\\boxed{148.8}\n$$", "id": "2643483"}, {"introduction": "发育系统生物学的终极挑战之一是将单个的调控作用整合成一个动态网络，以重现复杂的模式形成过程。这个高级练习将指导你构建并模拟一个用于后脑模式形成的基因调控网络（GRN）。通过应用一个包含希尔函数的常微分方程（ODEs）系统，你将探索在视黄酸（ $RA$ ）等外部信号的影响下，与不同菱脑节相对应的稳定细胞命运是如何作为网络动态的“吸引子”（attractors）而出现的。[@problem_id:2643475]", "problem": "您的任务是为一个后脑模式形成的基因调控网络（GRN）进行形式化建模。该网络需要是最小化的、具有机制基础的，并整合同源选择子（Hox）旁系同源基因、视黄酸（RA）输入和分节转录因子，以推导出与菱脑节身份相对应的稳定吸引子。目标是在指定的输入条件下计算稳态吸引子，并将每个吸引子分类为一种菱脑节身份。\n\n您必须使用的基本出发点：\n- 分子生物学中心法则，即转录因子浓度因产生和降解而改变。\n- 基因调控由激活子和抑制子通过协同希尔函数建模。\n- 稳定的细胞身份对应于底层GRN的动力学系统吸引子。\n\n需要实现的模型规范：\n1. 变量和输入。有四个动态变量，代表区间 $[0,1]$ 内的归一化浓度：\n   - $x_1$: $\\mathrm{Hoxb1}$ (记为 $B1$)，\n   - $x_2$: $\\mathrm{Hoxa2}$ (记为 $A2$)，\n   - $x_3$: $\\mathrm{Krox20}$ (也称为早期生长反应因子$2$，记为 $K20$)，\n   - $x_4$: $\\mathrm{MafB}$ (也称为 Kreisler，记为 $Maf$)。\n   每个测试用例有三个外部恒定输入：\n   - $R \\in [0,1]$：视黄酸 (RA) 水平，\n   - $u_K \\in \\{0,1\\}$：一个有利于 $\\mathrm{Krox20}$ 的预模式种子，\n   - $u_M \\in \\{0,1\\}$：一个有利于 $\\mathrm{MafB}$ 的预模式种子。\n\n2. 常微分方程 (ODE) 形式。对每个基因 $x_i$，使用标准的质量平衡形式\n   $$\\frac{dx_i}{dt} \\;=\\; g_i \\, F_i(\\text{激活子}, \\text{抑制子}) \\;-\\; k_i \\, x_i,$$\n   其中 $g_i$ 是最大合成速率，$k_i$ 是一阶降解速率，而 $F_i$ 是一个调控逻辑函数。\n\n3. 使用希尔函数的调控逻辑。对激活和抑制均使用协同希尔函数，希尔系数 $n=3$，半激活常数 $K_{1/2}=0.5$：\n   - 对于激活子 $a$，定义\n     $$H_{\\mathrm{act}}(a) \\;=\\; \\frac{a^n}{K_{1/2}^n + a^n}。$$\n   - 对于抑制子 $r$，定义\n     $$H_{\\mathrm{rep}}(r) \\;=\\; \\frac{K_{1/2}^n}{K_{1/2}^n + r^n}。$$\n   - 通过将相应的希尔项相乘来组合多个输入。如下文所指定，将括号内的多个加性产生源组合为基础项和加权激活子项之和。\n\n4. 节点特异性调控。设所有 $g_i = 1$ 和所有 $k_i = 1$。对每个节点，定义 $F_i$ 如下：\n   - $B1$ ($x_1$):\n     $$F_1 \\;=\\; \\Big(b_1 + w_{R1}\\,H_{\\mathrm{act}}(R)\\Big)\\cdot H_{\\mathrm{rep}}(x_2)\\cdot H_{\\mathrm{rep}}(x_3)\\cdot H_{\\mathrm{rep}}(x_4),$$\n     其中 $b_1 = 0.02$ 且 $w_{R1} = 0.98$。\n   - $A2$ ($x_2$):\n     $$F_2 \\;=\\; \\Big(b_2 + w_{R2}\\,H_{\\mathrm{act}}(R)\\Big)\\cdot H_{\\mathrm{rep}}(x_1)\\cdot H_{\\mathrm{rep}}(x_4),$$\n     其中 $b_2 = 0.05$ 且 $w_{R2} = 0.95$。\n   - $K20$ ($x_3$):\n     $$F_3 \\;=\\; \\Big(b_3 + w_{K}\\,H_{\\mathrm{act}}(u_K) + w_{\\mathrm{self3}}\\,H_{\\mathrm{act}}(x_3) + w_{R3}\\,H_{\\mathrm{act}}(R)\\Big)\\cdot H_{\\mathrm{rep}}(x_1)\\cdot H_{\\mathrm{rep}}(x_4),$$\n     其中 $b_3 = 0.02$，$w_{K} = 0.5$，$w_{\\mathrm{self3}} = 0.3$，且 $w_{R3} = 0.2$。\n   - $Maf$ ($x_4$):\n     $$F_4 \\;=\\; \\Big(b_4 + w_{M}\\,H_{\\mathrm{act}}(u_M) + w_{\\mathrm{self4}}\\,H_{\\mathrm{act}}(x_4) + w_{R4}\\,H_{\\mathrm{act}}(R)\\Big)\\cdot H_{\\mathrm{rep}}(x_2)\\cdot H_{\\mathrm{rep}}(x_1),$$\n     其中 $b_4 = 0.02$，$w_{M} = 0.5$，$w_{\\mathrm{self4}} = 0.3$，且 $w_{R4} = 0.2$。\n\n5. 数值积分。实现一个显式欧拉时间离散化方法，时间步长 $\\Delta t = 0.05$，初始条件为所有 $i \\in \\{1,2,3,4\\}$ 都有 $x_i(0) = 0$，最大迭代次数 $N_{\\max} = 200000$，状态更新的欧几里得范数收敛容差为 $\\epsilon = 10^{-9}$。每次更新后，将每个 $x_i$ 裁剪到 $[0,1]$ 区间内。\n\n6. 吸引子分类。收敛后，使用高表达阈值 $T_{\\mathrm{high}} = 0.6$ 将稳态分类为一种菱脑节身份。定义布尔标志\n   $$\\text{hiB1} := (x_1 \\ge T_{\\mathrm{high}}),\\;\\; \\text{hiA2} := (x_2 \\ge T_{\\mathrm{high}}),\\;\\; \\text{hiK20} := (x_3 \\ge T_{\\mathrm{high}}),\\;\\; \\text{hiMaf} := (x_4 \\ge T_{\\mathrm{high}})。$$\n   按所列顺序应用以下决策逻辑（首个匹配的规则适用）：\n   - 如果 $\\text{hiK20}$ 且 $\\text{hiMaf}$ 且非 $\\text{hiB1}$，则返回 $5$ (身份 $r_5$)。\n   - 否则，如果 $\\text{hiA2}$ 且 $\\text{hiK20}$ 且非 $\\text{hiB1}$ 且非 $\\text{hiMaf}$，则返回 $3$ (身份 $r_3$)。\n   - 否则，如果 $\\text{hiB1}$ 且非 $\\text{hiK20}$ 且非 $\\text{hiMaf}$，则返回 $4$ (身份 $r_4$)。\n   - 否则，如果 $\\text{hiMaf}$ 且非 $\\text{hiK20}$ 且非 $\\text{hiB1}$，则返回 $6$ (身份 $r_6$)。\n   - 否则，如果 $\\text{hiA2}$ 且非 $\\text{hiK20}$ 且非 $\\text{hiB1}$ 且非 $\\text{hiMaf}$，则返回 $2$ (身份 $r_2$)。\n   - 否则返回 $0$，表示在 $\\{r_2,r_3,r_4,r_5,r_6\\}$ 内没有唯一匹配。\n\n测试套件：\n提供以下七个输入三元组 $(R,u_K,u_M)$：\n- 情况 1：$(0.55, 0, 0)$\n- 情况 2：$(0.55, 1, 0)$\n- 情况 3：$(0.65, 0, 0)$\n- 情况 4：$(0.70, 1, 1)$\n- 情况 5：$(0.75, 0, 1)$\n- 情况 6：$(0.00, 0, 0)$\n- 情况 7：$(0.60, 1, 1)$\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，并用方括号括起来（例如，“[result1,result2,result3,...]”），每个结果是对应测试用例的整数类别，按顺序排列。", "solution": "问题陈述已经过评估，并被确定为有效。它在科学上植根于发育生物学和系统生物学的原理，问题设定良好，具有一套完整的数学定义和计算指令，并且其表述是客观的。该问题是计算建模领域中一个非平凡、定义明确的任务。\n\n该问题要求对一个用于后脑模式形成的基因调控网络（GRN）模型进行形式化和模拟。发育中的细胞（表示为菱脑节）的身份被认为对应于一个动力学系统的稳定吸引子。该系统的状态由四个关键转录因子的浓度定义：$x_1$ ($\\mathrm{Hoxb1}$)、$x_2$ ($\\mathrm{Hoxa2}$)、$x_3$ ($\\mathrm{Krox20}$) 和 $x_4$ ($\\mathrm{MafB}$)。这些浓度被归一化到区间 $[0,1]$。其动力学由一个包含四个耦合常微分方程（ODE）的系统控制。\n\n对于每个基因产物浓度 $x_i$，其中 $i \\in \\{1, 2, 3, 4\\}$，其时间演化由以下方程给出：\n$$\n\\frac{dx_i}{dt} \\;=\\; g_i \\, F_i(\\mathbf{x}, \\mathbf{u}) \\;-\\; k_i \\, x_i\n$$\n这里，$\\mathbf{x} = [x_1, x_2, x_3, x_4]^T$ 是浓度状态向量，$\\mathbf{u} = [R, u_K, u_M]^T$ 是恒定外部输入向量。参数 $g_i$ 代表最大合成速率，$k_i$ 是一阶降解速率常数。函数 $F_i$ 是调控逻辑函数，它模拟了激活因子和抑制因子对基因 $i$ 转录的综合效应。问题指定所有合成和降解速率均为单位速率，即对所有 $i$ 都有 $g_i=1$ 和 $k_i=1$。\n\n调控相互作用使用协同希尔函数建模。对于浓度为 $a$ 的激活子，激活函数为：\n$$\nH_{\\mathrm{act}}(a) \\;=\\; \\frac{a^n}{K_{1/2}^n + a^n}\n$$\n对于浓度为 $r$ 的抑制子，抑制函数为：\n$$\nH_{\\mathrm{rep}}(r) \\;=\\; \\frac{K_{1/2}^n}{K_{1/2}^n + r^n}\n$$\n问题指定希尔系数为 $n=3$，半激活常数为 $K_{1/2}=0.5$。\n\n每个节点的具体调控函数 $F_i$ 定义如下：\n\n对于 $x_1$ ($\\mathrm{Hoxb1}$):\n$$\nF_1(\\mathbf{x}, R) \\;=\\; \\Big(b_1 + w_{R1}\\,H_{\\mathrm{act}}(R)\\Big)\\cdot H_{\\mathrm{rep}}(x_2)\\cdot H_{\\mathrm{rep}}(x_3)\\cdot H_{\\mathrm{rep}}(x_4)\n$$\n基础速率 $b_1 = 0.02$，权重 $w_{R1} = 0.98$。\n\n对于 $x_2$ ($\\mathrm{Hoxa2}$):\n$$\nF_2(\\mathbf{x}, R) \\;=\\; \\Big(b_2 + w_{R2}\\,H_{\\mathrm{act}}(R)\\Big)\\cdot H_{\\mathrm{rep}}(x_1)\\cdot H_{\\mathrm{rep}}(x_4)\n$$\n基础速率 $b_2 = 0.05$，权重 $w_{R2} = 0.95$。\n\n对于 $x_3$ ($\\mathrm{Krox20}$):\n$$\nF_3(\\mathbf{x}, R, u_K) \\;=\\; \\Big(b_3 + w_{K}\\,H_{\\mathrm{act}}(u_K) + w_{\\mathrm{self3}}\\,H_{\\mathrm{act}}(x_3) + w_{R3}\\,H_{\\mathrm{act}}(R)\\Big)\\cdot H_{\\mathrm{rep}}(x_1)\\cdot H_{\\mathrm{rep}}(x_4)\n$$\n基础速率 $b_3 = 0.02$，权重 $w_{K} = 0.5$、$w_{\\mathrm{self3}} = 0.3$ 和 $w_{R3} = 0.2$。\n\n对于 $x_4$ ($\\mathrm{MafB}$):\n$$\nF_4(\\mathbf{x}, R, u_M) \\;=\\; \\Big(b_4 + w_{M}\\,H_{\\mathrm{act}}(u_M) + w_{\\mathrm{self4}}\\,H_{\\mathrm{act}}(x_4) + w_{R4}\\,H_{\\mathrm{act}}(R)\\Big)\\cdot H_{\\mathrm{rep}}(x_2)\\cdot H_{\\mathrm{rep}}(x_1)\n$$\n基础速率 $b_4 = 0.02$，权重 $w_{M} = 0.5$、$w_{\\mathrm{self4}} = 0.3$ 和 $w_{R4} = 0.2$。\n\n必须对该ODE系统进行数值求解，以找到稳态吸引子。采用显式欧拉时间离散化方案。状态向量 $\\mathbf{x}$ 从时间步 $k$ 到 $k+1$ 的更新规则为：\n$$\n\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\Delta t \\cdot \\left( \\mathbf{F}(\\mathbf{x}_k, \\mathbf{u}) - \\mathbf{x}_k \\right)\n$$\n其中 $\\mathbf{F} = [F_1, F_2, F_3, F_4]^T$。模拟参数为：时间步长 $\\Delta t = 0.05$，初始条件 $\\mathbf{x}_0 = [0, 0, 0, 0]^T$，最大迭代次数 $N_{\\max} = 200000$。一个关键步骤是，在每次更新后将每个 $x_i$ 裁剪到区间 $[0,1]$ 内，以将浓度限制在其物理域内。模拟在达到 $N_{\\max}$ 或系统收敛到稳态时终止。当每步状态变化的欧几里得范数 $\\|\\mathbf{x}_{k+1} - \\mathbf{x}_k\\|_2$ 小于容差 $\\epsilon = 10^{-9}$ 时，判定为收敛。\n\n当收敛到稳态向量 $\\mathbf{x}^* = [x_1^*, x_2^*, x_3^*, x_4^*]^T$ 后，该吸引子被分类为一种菱脑节身份。此分类基于哪些基因产物高表达，即其浓度超过阈值 $T_{\\mathrm{high}} = 0.6$。为每个组分定义布尔标志：\n$\\text{hiB1} := (x_1^* \\ge T_{\\mathrm{high}})$，$\\text{hiA2} := (x_2^* \\ge T_{\\mathrm{high}})$，$\\text{hiK20} := (x_3^* \\ge T_{\\mathrm{high}})$，$\\text{hiMaf} := (x_4^* \\ge T_{\\mathrm{high}})$。\n分类遵循一个特定的逻辑树，按顺序评估：\n1. 如果 $\\text{hiK20} \\land \\text{hiMaf} \\land \\neg\\text{hiB1}$，则身份为 $r_5$ (输出 $5$)。\n2. 否则，如果 $\\text{hiA2} \\land \\text{hiK20} \\land \\neg\\text{hiB1} \\land \\neg\\text{hiMaf}$，则身份为 $r_3$ (输出 $3$)。\n3. 否则，如果 $\\text{hiB1} \\land \\neg\\text{hiK20} \\land \\neg\\text{hiMaf}$，则身份为 $r_4$ (输出 $4$)。\n4. 否则，如果 $\\text{hiMaf} \\land \\neg\\text{hiK20} \\land \\neg\\text{hiB1}$，则身份为 $r_6$ (输出 $6$)。\n5. 否则，如果 $\\text{hiA2} \\land \\neg\\text{hiK20} \\land \\neg\\text{hiB1} \\land \\neg\\text{hiMaf}$，则身份为 $r_2$ (输出 $2$)。\n6. 否则，状态为未分类 (输出 $0$)。\n\n该过程将应用于问题陈述中指定的七个测试用例，生成的整数分类序列将格式化为最终输出。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the steady-state attractors of a Gene Regulatory Network for hindbrain patterning\n    and classifies them into rhombomere identities for a given set of test cases.\n    \"\"\"\n    # Test cases: triplets of (R, u_K, u_M)\n    test_cases = [\n        (0.55, 0, 0),  # Case 1\n        (0.55, 1, 0),  # Case 2\n        (0.65, 0, 0),  # Case 3\n        (0.70, 1, 1),  # Case 4\n        (0.75, 0, 1),  # Case 5\n        (0.00, 0, 0),  # Case 6\n        (0.60, 1, 1),  # Case 7\n    ]\n\n    # Model and simulation parameters\n    N = 3.0\n    K_HALF = 0.5\n    K_HALF_N = K_HALF**N\n    \n    # ODE parameters\n    g = np.array([1.0, 1.0, 1.0, 1.0])\n    k = np.array([1.0, 1.0, 1.0, 1.0])\n    \n    # Regulatory function parameters\n    b1, w_R1 = 0.02, 0.98\n    b2, w_R2 = 0.05, 0.95\n    b3, w_K, w_self3, w_R3 = 0.02, 0.5, 0.3, 0.2\n    b4, w_M, w_self4, w_R4 = 0.02, 0.5, 0.3, 0.2\n\n    # Numerical integration parameters\n    DT = 0.05\n    N_MAX = 200000\n    EPSILON = 1e-9\n\n    # Classification threshold\n    T_HIGH = 0.6\n\n    results = []\n\n    def h_act(a):\n        a_n = a**N\n        return a_n / (K_HALF_N + a_n)\n\n    def h_rep(r):\n        r_n = r**N\n        return K_HALF_N / (K_HALF_N + r_n)\n\n    for case in test_cases:\n        R_input, u_K_input, u_M_input = case\n        \n        # Initial state\n        x = np.zeros(4)\n\n        # Pre-compute constant Hill terms\n        h_act_R = h_act(R_input)\n        h_act_u_K = h_act(float(u_K_input))\n        h_act_u_M = h_act(float(u_M_input))\n\n        for _ in range(N_MAX):\n            x_old = x.copy()\n            x1, x2, x3, x4 = x\n\n            # Regulatory logic functions F_i\n            F = np.zeros(4)\n            \n            # F1 for B1 (x1)\n            F[0] = (b1 + w_R1 * h_act_R) * h_rep(x2) * h_rep(x3) * h_rep(x4)\n            \n            # F2 for A2 (x2)\n            F[1] = (b2 + w_R2 * h_act_R) * h_rep(x1) * h_rep(x4)\n            \n            # F3 for K20 (x3)\n            F[2] = (b3 + w_K * h_act_u_K + w_self3 * h_act(x3) + w_R3 * h_act_R) * h_rep(x1) * h_rep(x4)\n\n            # F4 for Maf (x4)\n            F[3] = (b4 + w_M * h_act_u_M + w_self4 * h_act(x4) + w_R4 * h_act_R) * h_rep(x2) * h_rep(x1)\n            \n            # Euler integration step\n            dxdt = g * F - k * x\n            x = x_old + DT * dxdt\n            \n            # Clipping to maintain concentrations in [0, 1]\n            x = np.clip(x, 0, 1)\n\n            # Check for convergence\n            update_norm = np.linalg.norm(x - x_old)\n            if update_norm < EPSILON:\n                break\n        \n        # Attractor classification\n        x1_ss, x2_ss, x3_ss, x4_ss = x\n        \n        hiB1 = x1_ss >= T_HIGH\n        hiA2 = x2_ss >= T_HIGH\n        hiK20 = x3_ss >= T_HIGH\n        hiMaf = x4_ss >= T_HIGH\n        \n        rhombomere_id = 0\n        if hiK20 and hiMaf and not hiB1:\n            rhombomere_id = 5\n        elif hiA2 and hiK20 and not hiB1 and not hiMaf:\n            rhombomere_id = 3\n        elif hiB1 and not hiK20 and not hiMaf:\n            rhombomere_id = 4\n        elif hiMaf and not hiK20 and not hiB1:\n            rhombomere_id = 6\n        elif hiA2 and not hiK20 and not hiB1 and not hiMaf:\n            rhombomere_id = 2\n        else:\n            rhombomere_id = 0\n            \n        results.append(rhombomere_id)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2643475"}]}