{"hands_on_practices": [{"introduction": "时钟-波前模型的一个核心要素是“波前”，它通常被认为是由成纤维细胞生长因子（Fibroblast Growth Factor, FGF）等信号分子形成的稳定空间梯度。这个梯度为前体节中胚层的细胞提供了位置信息。本练习将引导你从扩散（系数为 $D$）和降解（速率为 $k$）等基本物理化学原理出发，推导出这种梯度形成的数学描述，从而深入理解生物系统中空间模式是如何产生的。[@problem_id:2679229]", "problem": "体节发生中的时钟-波前模型的一个核心要素是体节前中胚层 (PSM) 中存在一个从后到前的分子梯度，该梯度通常被归因于成纤维细胞生长因子 (FGF)。考虑一个沿前-后 (A–P) 轴的一维组织坐标 $x \\ge 0$，其中尾芽位于 $x=0$ 处。成纤维细胞生长因子 (FGF) 在 $x=0$ 处产生，以扩散系数 $D$ 扩散到 PSM 中，并以速率常数 $k$ 通过一级动力学被均匀降解。假设系统在组织坐标系中已达到稳态，并且尾芽作为一个恒定源，向 PSM 施加一个固定的产生通量 $J_{0}$。在远离源头的地方，浓度趋于零。\n\n仅从 (i) 质量守恒、(ii) 菲克扩散定律和 (iii) 一级降解动力学出发，推导出稳态浓度分布 $c(x)$，并确定主导该分布空间衰减的特征长度尺度。然后，在时钟-波前模型的背景下，定义 FGF 浓度等于固定阈值 $c_{\\mathrm{th}}$ 的位置 $x^{\\ast}$，并用特征长度尺度和边界量来表示 $x^{\\ast}$。最后，从生物学上解释这个特征长度尺度对 PSM 中的 FGF 梯度代表了什么，以及它如何限制波前的位置。\n\n你的最终答案必须是特征长度尺度的闭合形式解析表达式。最终答案中不要包含任何单位。", "solution": "所述问题具有科学依据，提法恰当且客观。它呈现了一个标准的反应-扩散情景，这是数理生物学中建模拟态发生素梯度的基石。所提供的所有数据和条件都是一致且充分的，足以推导出一个唯一且有意义的解。因此，该问题被认为是有效的。\n\n我们开始进行推导。问题要求我们推导成纤维细胞生长因子 (FGF) 沿一维组织轴 $x \\ge 0$ 的稳态浓度分布 $c(x)$。推导必须从三个基本原理出发：(i) 质量守恒，(ii) 菲克扩散定律，以及 (iii) 一级降解动力学。\n\n我们考虑一个位于位置 $x$ 和 $x+\\Delta x$ 之间，长度为 $\\Delta x$，横截面积均匀为 $A$ 的一维微小控制体积。此体积内的 FGF 总量为 $c(x,t) A \\Delta x$。\n\n质量守恒原理指出，控制体积内物质总量的变化率等于流入该体积的净通量减去因降解而移除的速率。\n质量的变化率为 $\\frac{\\partial}{\\partial t} (c A \\Delta x)$。\n在位置 $x$ 处流入该体积的 FGF 通量为 $J(x,t) A$，在位置 $x+\\Delta x$ 处流出该体积的通量为 $J(x+\\Delta x, t) A$。因此，流入该体积的净通量为 $(J(x,t) - J(x+\\Delta x,t))A$。\nFGF 以速率常数 $k$ 通过一级动力学降解。因此，从该体积中移除的速率为 $(k c) A \\Delta x$。\n\n综合这些项，质量平衡方程为：\n$$ \\frac{\\partial}{\\partial t} (c A \\Delta x) = (J(x,t) - J(x+\\Delta x,t))A - k c A \\Delta x $$\n两边同除以体积 $A \\Delta x$ 并整理后得到：\n$$ \\frac{\\partial c}{\\partial t} = - \\frac{J(x+\\Delta x,t) - J(x,t)}{\\Delta x} - k c $$\n当 $\\Delta x \\to 0$ 时取极限，我们得到其一般形式的一维反应-扩散方程：\n$$ \\frac{\\partial c}{\\partial t} = - \\frac{\\partial J}{\\partial x} - k c $$\n接下来，我们引用菲克第一扩散定律，它将通量 $J$ 与浓度梯度联系起来：\n$$ J = -D \\frac{\\partial c}{\\partial x} $$\n其中 $D$ 是扩散系数。将菲克定律代入质量平衡方程，得到：\n$$ \\frac{\\partial c}{\\partial t} = - \\frac{\\partial}{\\partial x} \\left(-D \\frac{\\partial c}{\\partial x}\\right) - k c = D \\frac{\\partial^2 c}{\\partial x^2} - k c $$\n问题指定系统已达到稳态，这意味着浓度不再随时间变化。因此，$\\frac{\\partial c}{\\partial t} = 0$。这将控制方程简化为一个二阶常微分方程 (ODE)：\n$$ D \\frac{d^2 c}{d x^2} - k c = 0 $$\n$$ \\frac{d^2 c}{d x^2} - \\frac{k}{D} c = 0 $$\n该方程描述了稳态浓度分布。为求解该方程，我们定义一个具有长度量纲的参数 $\\lambda$，即 $\\lambda = \\sqrt{\\frac{D}{k}}$。现在，该常微分方程可以写成更紧凑的形式：\n$$ \\frac{d^2 c}{d x^2} - \\frac{1}{\\lambda^2} c = 0 $$\n这是一个常系数齐次线性二阶常微分方程。其特征方程为 $r^2 - \\frac{1}{\\lambda^2} = 0$，根为 $r = \\pm \\frac{1}{\\lambda}$。因此，通解为：\n$$ c(x) = C_1 \\exp\\left(\\frac{x}{\\lambda}\\right) + C_2 \\exp\\left(-\\frac{x}{\\lambda}\\right) $$\n其中 $C_1$ 和 $C_2$ 是待由边界条件确定的积分常数。\n\n第一个边界条件是浓度在远离源头处趋于零：当 $x \\to \\infty$ 时，$c(x) \\to 0$。为使此条件成立，具有正指数的项 $\\exp(x/\\lambda)$ 必须为零，因为它在 $x \\to \\infty$ 时会无界增长。这要求常数 $C_1$ 必须为 $0$。解简化为：\n$$ c(x) = C_2 \\exp\\left(-\\frac{x}{\\lambda}\\right) $$\n第二个边界条件是在源头 $x=0$ 处有一个恒定的产生通量 $J_0$。通量 $J(x)$ 由菲克定律给出：\n$$ J(x) = -D \\frac{dc}{dx} = -D \\frac{d}{dx} \\left( C_2 \\exp\\left(-\\frac{x}{\\lambda}\\right) \\right) = -D \\left( -\\frac{C_2}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right) \\right) = \\frac{D C_2}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right) $$\n在 $x=0$ 处，通量为 $J(0) = J_0$：\n$$ J_0 = \\frac{D C_2}{\\lambda} $$\n求解常数 $C_2$ 得：\n$$ C_2 = \\frac{J_0 \\lambda}{D} $$\n将此结果代回 $c(x)$ 的解中，我们得到最终的稳态浓度分布：\n$$ c(x) = \\frac{J_0 \\lambda}{D} \\exp\\left(-\\frac{x}{\\lambda}\\right) $$\n从这个推导中，可以立即确定主导该分布空间衰减的特征长度尺度为：\n$$ \\lambda = \\sqrt{\\frac{D}{k}} $$\n该长度尺度从控制常微分方程的无量纲化过程中自然产生，并决定了浓度衰减到 $e^{-1}$ 倍的距离。\n\n接下来，我们将波前的位置 $x^{\\ast}$ 定义为 FGF 浓度等于固定阈值 $c_{\\mathrm{th}}$ 的位置。我们令 $c(x^{\\ast}) = c_{\\mathrm{th}}$：\n$$ \\frac{J_0 \\lambda}{D} \\exp\\left(-\\frac{x^{\\ast}}{\\lambda}\\right) = c_{\\mathrm{th}} $$\n为求解 $x^{\\ast}$，我们首先分离指数项：\n$$ \\exp\\left(-\\frac{x^{\\ast}}{\\lambda}\\right) = \\frac{c_{\\mathrm{th}} D}{J_0 \\lambda} $$\n取两边的自然对数：\n$$ -\\frac{x^{\\ast}}{\\lambda} = \\ln\\left(\\frac{c_{\\mathrm{th}} D}{J_0 \\lambda}\\right) $$\n$$ x^{\\ast} = -\\lambda \\ln\\left(\\frac{c_{\\mathrm{th}} D}{J_0 \\lambda}\\right) = \\lambda \\ln\\left(\\left(\\frac{c_{\\mathrm{th}} D}{J_0 \\lambda}\\right)^{-1}\\right) $$\n因此，波前的位置是：\n$$ x^{\\ast} = \\lambda \\ln\\left(\\frac{J_0 \\lambda}{c_{\\mathrm{th}} D}\\right) $$\n项 $\\frac{J_0 \\lambda}{D}$ 是源头处的浓度 $c(0)$，我们可以将其表示为 $c_0$。$x^{\\ast}$ 的表达式可以更清晰地写为 $x^{\\ast} = \\lambda \\ln(c_0 / c_{\\mathrm{th}})$，这明确显示了它对特征长度尺度 $\\lambda$ 以及源头浓度与阈值浓度之比的依赖关系。\n\n最后，我们提供生物学解释。特征长度尺度 $\\lambda = \\sqrt{D/k}$ 是形态发生素梯度的一个基本参数。它代表了一个在尾芽处产生的 FGF 分子在被降解前通常扩散的距离。较大的 $\\lambda$（由于高扩散 $D$ 或低降解 $k$）会导致一个平缓的梯度，该梯度会延伸到体节前中胚层 (PSM) 的深处。较小的 $\\lambda$（由于低扩散 $D$ 或高降解 $k$）则会导致一个陡峭的、局域化的梯度。在时钟-波前模型的背景下，体节发生的波前被假定为 FGF 浓度下降到临界阈值 $c_{\\mathrm{th}}$ 以下的位置。我们推导出的表达式 $x^{\\ast} = \\lambda \\ln(c_0/c_{\\mathrm{th}})$ 表明，该波前的位置与特征长度尺度 $\\lambda$ 成正比。因此，$\\lambda$ 不仅仅是一个抽象的数学参数；它是组织系统的一个物理属性，直接制约着位置信息。任何改变 FGF 扩散或降解速率的遗传或环境因素都会改变 $\\lambda$，从而改变波前的位置，进而影响所形成体节的大小和位置。\n\n问题明确要求给出特征长度尺度的闭合形式解析表达式。", "answer": "$$ \\boxed{\\sqrt{\\frac{D}{k}}} $$", "id": "2679229"}, {"introduction": "理解了空间上的“波前”后，我们转向时间上的“时钟”。体节发生的节律性源于每个细胞内部的基因表达振荡，这构成了“分节时钟”。本练习将通过分析一个经典的延迟负反馈微分方程模型，带你探索这种生物振荡器背后的动力学原理，并精确推导出系统因信号延迟 $\\tau$ 的增加而从稳定状态转变为节律性振荡的临界条件。[@problem_id:2679227]", "problem": "在体节形成的“时钟和波前”模型中，基因产物的胞内振荡通常通过由转录、翻译和延迟的自动抑制引起的延迟负反馈来建模。考虑一个蛋白质浓度 $p(t)$ 的单基因延迟负反馈模型，该模型由延迟微分方程 (DDE) 给出\n$$\n\\dot{p}(t) \\;=\\; \\frac{\\beta}{1 + \\left(\\frac{p(t-\\tau)}{K}\\right)^{n}} \\;-\\; \\gamma\\, p(t),\n$$\n其中 $\\beta \\!>\\! 0$ 是最大生产速率， $K \\!>\\! 0$ 是半饱和常数， $n \\!>\\! 1$ 是 Hill 系数， $\\gamma \\!>\\! 0$ 是一阶降解速率，以及 $\\tau \\!>\\! 0$ 是一个有效的转录-翻译-反馈延迟。令 $p^{\\ast}$ 表示满足 $\\dot{p}(t)=0$ 的稳态。\n\n从延迟微分方程稳定性分析的第一性原理出发，对稳态 $p^{\\ast}$ 进行线性化，并应用 Hopf 分岔的定义（出现一对纯虚特征值），以获得发生 Hopf 分岔的最小正临界延迟 $\\tau_{c}$ 的闭式表达式。你的推导应从线性化过程和 DDE 的特征方程开始，并应确定纯虚根存在的必要相容性条件。将你的最终结果 $\\tau_{c}$ 用模型参数 $\\gamma$、$K$、$n$ 和稳态值 $p^{\\ast}$ 表示；角度必须以弧度表示。最终答案必须是单一的闭式解析表达式。不要报告任何不等式；只报告 $\\tau_{c}$ 的表达式。", "solution": "问题陈述具有科学依据、问题明确且客观。它提供了一个标准的生物振荡器延迟微分方程模型，并要求使用已建立的稳定性分析方法推导 Hopf 分岔的临界延迟。所有必要的参数和条件都已定义。该问题是有效的。\n\n我们从蛋白质浓度 $p(t)$ 的延迟微分方程 (DDE) 开始：\n$$ \\frac{d p}{dt} = \\frac{\\beta}{1 + \\left(\\frac{p(t-\\tau)}{K}\\right)^{n}} - \\gamma p(t) $$\n参数 $\\beta$、$K$、$n$、$\\gamma$ 和 $\\tau$ 都是正常数，且 $n > 1$。\n\n首先，我们确定稳态 $p^{\\ast}$。稳态是一个常数解，因此 $p(t) = p(t-\\tau) = p^{\\ast}$ 且 $\\frac{dp}{dt} = 0$。将这些代入 DDE 得到稳态条件：\n$$ 0 = \\frac{\\beta}{1 + \\left(\\frac{p^{\\ast}}{K}\\right)^{n}} - \\gamma p^{\\ast} \\quad \\implies \\quad \\gamma p^{\\ast} = \\frac{\\beta}{1 + \\left(\\frac{p^{\\ast}}{K}\\right)^{n}} $$\n问题要求最终答案用 $p^{\\ast}$ 来表示，所以我们不需要解这个方程求 $p^{\\ast}$。\n\n接下来，我们在稳态 $p^{\\ast}$ 附近进行线性稳定性分析。令 $p(t) = p^{\\ast} + x(t)$，其中 $x(t)$ 代表一个小的扰动。将此代入 DDE 得到：\n$$ \\frac{d}{dt}(p^{\\ast} + x(t)) = \\frac{\\beta}{1 + \\left(\\frac{p^{\\ast} + x(t-\\tau)}{K}\\right)^{n}} - \\gamma(p^{\\ast} + x(t)) $$\n方程左边是 $\\frac{dx}{dt}$。令非线性生产项为 $f(p) = \\frac{\\beta}{1 + (p/K)^{n}}$。我们对 $f(p(t-\\tau))$ 在 $p^{\\ast}$ 附近进行一阶泰勒展开：\n$$ f(p^{\\ast} + x(t-\\tau)) \\approx f(p^{\\ast}) + f'(p^{\\ast}) x(t-\\tau) $$\n完整的方程变为：\n$$ \\frac{dx}{dt} \\approx f(p^{\\ast}) + f'(p^{\\ast}) x(t-\\tau) - \\gamma p^{\\ast} - \\gamma x(t) $$\n根据稳态条件，$f(p^{\\ast}) = \\gamma p^{\\ast}$。这些项相互抵消，剩下线性化的 DDE：\n$$ \\frac{dx}{dt} = f'(p^{\\ast}) x(t-\\tau) - \\gamma x(t) $$\n我们必须计算导数 $f'(p^{\\ast})$。$f(p)$ 的导数是：\n$$ f'(p) = \\frac{d}{dp}\\left[\\beta \\left(1 + \\left(\\frac{p}{K}\\right)^{n}\\right)^{-1}\\right] = -\\beta \\left(1 + \\left(\\frac{p}{K}\\right)^{n}\\right)^{-2} \\cdot n\\left(\\frac{p}{K}\\right)^{n-1} \\cdot \\frac{1}{K} $$\n$$ f'(p) = -\\frac{\\beta n}{K} \\frac{(p/K)^{n-1}}{(1+(p/K)^{n})^{2}} $$\n使用稳态关系 $\\beta = \\gamma p^{\\ast} (1 + (p^{\\ast}/K)^{n})$，我们代入 $\\beta$ 以便用其他参数表示 $f'(p^{\\ast})$：\n$$ f'(p^{\\ast}) = -\\frac{\\gamma p^{\\ast} (1 + (p^{\\ast}/K)^{n}) n}{K} \\frac{(p^{\\ast}/K)^{n-1}}{(1+(p^{\\ast}/K)^{n})^{2}} = -\\frac{\\gamma n p^{\\ast}}{K} \\frac{(p^{\\ast}/K)^{n-1}}{1+(p^{\\ast}/K)^{n}} = -\\frac{\\gamma n (p^{\\ast}/K)^{n}}{1+(p^{\\ast}/K)^{n}} $$\n由于所有参数和 $p^{\\ast}$ 都是正的，且 $n > 1$，所以项 $f'(p^{\\ast})$ 是负的。我们定义一个正常数 $A = -f'(p^{\\ast})$ 来表示负反馈的强度：\n$$ A = \\frac{\\gamma n \\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}} $$\n线性化的 DDE 现在是 $\\frac{dx}{dt} = -A x(t-\\tau) - \\gamma x(t)$。\n\n为了找到稳态的稳定性，我们分析特征方程。我们寻找形式为 $x(t) \\propto \\exp(\\lambda t)$ 的解。将此 ansatz 代入线性化方程：\n$$ \\lambda e^{\\lambda t} = -A e^{\\lambda(t-\\tau)} - \\gamma e^{\\lambda t} $$\n除以 $e^{\\lambda t}$ 得到特征值 $\\lambda$ 的特征方程：\n$$ \\lambda + \\gamma + A e^{-\\lambda \\tau} = 0 $$\n当一对共轭复特征值穿过虚轴时，发生 Hopf 分岔。在分岔点，存在一对纯虚特征值 $\\lambda = \\pm i\\omega_c$，其中 $\\omega_c > 0$ 是临界频率。将 $\\lambda = i\\omega_c$ 代入特征方程：\n$$ i\\omega_c + \\gamma + A e^{-i\\omega_c \\tau_c} = 0 $$\n使用欧拉恒等式 $e^{-i\\theta} = \\cos(\\theta) - i\\sin(\\theta)$，我们得到：\n$$ i\\omega_c + \\gamma + A(\\cos(\\omega_c \\tau_c) - i\\sin(\\omega_c \\tau_c)) = 0 $$\n分离实部和虚部，得到一个由两个方程组成的方程组：\n$$ \\text{实部:} \\quad \\gamma + A\\cos(\\omega_c \\tau_c) = 0 \\quad \\implies \\quad \\cos(\\omega_c \\tau_c) = -\\frac{\\gamma}{A} $$\n$$ \\text{虚部:} \\quad \\omega_c - A\\sin(\\omega_c \\tau_c) = 0 \\quad \\implies \\quad \\sin(\\omega_c \\tau_c) = \\frac{\\omega_c}{A} $$\n为了使解存在，我们使用恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$：\n$$ \\left(-\\frac{\\gamma}{A}\\right)^2 + \\left(\\frac{\\omega_c}{A}\\right)^2 = 1 \\implies \\frac{\\gamma^2}{A^2} + \\frac{\\omega_c^2}{A^2} = 1 $$\n$$ \\omega_c^2 + \\gamma^2 = A^2 \\implies \\omega_c^2 = A^2 - \\gamma^2 $$\n对于非零实频率 $\\omega_c$，我们必须有 $A^2 > \\gamma^2$，即 $A > \\gamma$。因此，临界频率为 $\\omega_c = \\sqrt{A^2 - \\gamma^2}$。\n\n为了求临界延迟 $\\tau_c$，我们使用余弦和正弦方程。根据符号，$\\cos(\\omega_c \\tau_c) < 0$ 且 $\\sin(\\omega_c \\tau_c) > 0$，角 $\\omega_c \\tau_c$ 必须位于第二象限。我们可以使用反余弦函数来求解该角，其主值范围是 $[0, \\pi]$。该条件正确地将角置于 $(\\pi/2, \\pi)$ 内。\n$$ \\omega_c \\tau_c = \\arccos\\left(-\\frac{\\gamma}{A}\\right) + 2k\\pi $$\n其中 $k$ 是一个整数 $k \\ge 0$。最小的正延迟 $\\tau_c$ 对应于 $k=0$：\n$$ \\tau_c = \\frac{1}{\\omega_c} \\arccos\\left(-\\frac{\\gamma}{A}\\right) $$\n代入 $\\omega_c = \\sqrt{A^2 - \\gamma^2}$：\n$$ \\tau_c = \\frac{1}{\\sqrt{A^2 - \\gamma^2}} \\arccos\\left(-\\frac{\\gamma}{A}\\right) $$\n最后，我们将 $A$ 的表达式用模型参数代入，以获得 $\\tau_c$ 的最终闭式解。\n分母是：\n$$ \\sqrt{A^2 - \\gamma^2} = \\sqrt{\\left(\\frac{\\gamma n \\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}\\right)^2 - \\gamma^2} = \\gamma \\sqrt{\\frac{n^2\\left(\\frac{p^{\\ast}}{K}\\right)^{2n}}{\\left(1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}\\right)^2} - 1} $$\n$$ = \\frac{\\gamma}{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}} \\sqrt{n^2\\left(\\frac{p^{\\ast}}{K}\\right)^{2n} - \\left(1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}\\right)^2} $$\n$$ = \\frac{\\gamma}{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}} \\sqrt{\\left(n^2-1\\right)\\left(\\frac{p^{\\ast}}{K}\\right)^{2n} - 2\\left(\\frac{p^{\\ast}}{K}\\right)^{n} - 1} $$\n反余弦函数的参数是：\n$$ -\\frac{\\gamma}{A} = -\\frac{\\gamma}{\\frac{\\gamma n \\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}} = -\\frac{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{n\\left(\\frac{p^{\\ast}}{K}\\right)^{n}} $$\n将这些结合起来得到 $\\tau_c$ 的表达式：\n$$ \\tau_c = \\frac{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{\\gamma \\sqrt{\\left(n^2-1\\right)\\left(\\frac{p^{\\ast}}{K}\\right)^{2n} - 2\\left(\\frac{p^{\\ast}}{K}\\right)^{n} - 1}} \\arccos\\left(-\\frac{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{n\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}\\right) $$\n这是发生 Hopf 分岔的最小正临界延迟的最终表达式。", "answer": "$$\\boxed{\\frac{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{\\gamma \\sqrt{\\left(n^{2}-1\\right)\\left(\\frac{p^{\\ast}}{K}\\right)^{2n} - 2\\left(\\frac{p^{\\ast}}{K}\\right)^{n} - 1}} \\arccos\\left(-\\frac{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{n\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}\\right)}$$", "id": "2679227"}, {"introduction": "时钟-波前模型的精髓在于空间梯度（波前）与时间振荡（时钟）的相互作用。最后一个练习是一个计算实践，你将构建一个集成模型，融合 FGF 梯度（陡度为 $s$）和分节时钟（振幅为 $A$），来预测关键基因 Mesp2 表达条带的形成。通过这个练习，你将亲身体验抽象的数学概念如何转化为具体的、可观察的生物学模式，并定量分析模型参数如何影响最终的发育结果。[@problem_id:2679198]", "problem": "设计并实现一个独立的数值程序，该程序针对一个在时钟-波前框架下最小且生物学上合理的Mesp2条带形成模型，计算Mesp2表达条带的半峰全宽（FWHM），并将其作为成纤维细胞生长因子（FGF）梯度陡峭程度和时钟振荡振幅的函数。该程序必须为每个测试用例生成一个FWHM值，并将结果汇总到如下指定的单行列表中。\n\n模型假设、定义和要求：\n- 生物学背景和最小数学模型：在体节前中胚层中，FGF（成纤维细胞生长因子）蛋白形成一个从后到前的梯度来抑制Mesp2，而分节时钟则通过振荡的Notch信号周期性地激活靶基因。我们将一个固定时间的Mesp2表达的稳态快照建模为一个抑制项和一个激活项的乘法整合，这体现了一个逻辑“与”门，即需要同时满足低FGF和允许性的时钟状态这两个条件。\n- 空间域：使用一个一维胚胎轴，位置为 $x \\in [0,L]$，其中 $x=0$ 为后端，$x=L$ 为前端。除非另有明确说明，否则所有量均视为无单位。角度必须以弧度为单位。\n- FGF梯度：设FGF浓度为 $F(x) = F_0 \\exp(-s x)$，其中 $F_0$ 是后端浓度，$s$ 是梯度陡峭度参数，该参数将在不同测试用例中变化。\n- FGF对Mesp2的抑制：设该抑制作用被建模为一个Hill型抑制解除因子\n$$\nR(F) = \\frac{1}{1 + \\left(\\frac{F}{K_f}\\right)^{n_f}},\n$$\n其中 $K_f$ 是FGF的半效应浓度，$n_f$ 是代表协同性的Hill系数。\n- 时钟驱动的激活：设瞬时时钟驱动为一个半波整流余弦\n$$\nC(x) = \\max\\left(0, A \\cos(q x + \\phi_0)\\right),\n$$\n其中 $A$ 是振荡振幅，该参数将在不同测试用例中变化，$q$ 是空间波数，$\\phi_0$ 是相位偏移。通过一个Hill函数来模拟转录激活\n$$\nH(C) = \\begin{cases}\n\\frac{1}{1 + \\left(\\frac{K_c}{C}\\right)^{n_c}}, & C > 0, \\\\\n0, & C \\le 0,\n\\end{cases}\n$$\n其激活阈值为 $K_c$，Hill系数为 $n_c$。\n- Mesp2快照：将一个固定时间的瞬时Mesp2表达谱定义为\n$$\nM(x) = H(C(x)) \\cdot R(F(x)).\n$$\n- 决定前沿：将决定前沿定义为位置 $x_{\\mathrm{df}}$，在该位置处 $R(F(x_{\\mathrm{df}})) = \\tfrac{1}{2}$，等价于 $F(x_{\\mathrm{df}}) = K_f$。在指数梯度下，该位置为\n$$\nx_{\\mathrm{df}} = \\frac{\\ln\\left(\\frac{F_0}{K_f}\\right)}{s}.\n$$\n- 条带识别与FWHM：在 $[0,L]$ 上 $M(x)$ 的所有局部最大值中，选择其位置最接近 $x_{\\mathrm{df}}$ 的峰。设其峰值为 $M_{\\max}$。将半峰全宽（FWHM）定义为峰两侧 $M(x)$ 穿过 $\\tfrac{1}{2} M_{\\max}$ 的两个最近点之间的空间距离，该距离通过在相邻采样点之间进行线性插值获得。如果 $M(x)$ 没有局部最大值或 $M_{\\max} = 0$，则将FWHM定义为 $0$。\n- 数值方法要求：\n    - 在 $[0,L]$ 上使用一个包含 $N$ 个点的均匀网格，其中 $N$ 需足够大，以解析条带并通过插值稳健地计算FWHM。\n    - 所有三角函数计算均使用弧度。\n    - 仅使用以下指定的常量，并在测试套件中仅改变 $(s,A)$。\n\n所有模拟中使用的常量：\n- 空间域长度：$L = 5$。\n- 后端FGF：$F_0 = 1$。\n- FGF Hill参数：$K_f = 0.2$, $n_f = 4$。\n- 时钟空间波数和相位：$q = 2\\pi$, $\\phi_0 = 0$。\n- 时钟Hill参数：$K_c = 0.5$, $n_c = 3$。\n- 网格分辨率：$N = 10001$。\n\n测试套件：\n- 用例 1： $(s, A) = (1.0, 0.6)$。\n- 用例 2： $(s, A) = (2.0, 0.6)$。\n- 用例 3： $(s, A) = (0.5, 0.6)$。\n- 用例 4： $(s, A) = (1.0, 0.2)$。\n- 用例 5： $(s, A) = (1.0, 1.2)$。\n- 用例 6： $(s, A) = (1.0, 0.0)$。\n\n输出规格：\n- 对于每个测试用例，计算如上定义的FWHM，并将其报告为一个四舍五入到4位小数的浮点数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[w1,w2,w3,w4,w5,w6]”）。\n\n答案格式：\n- 最终答案必须是一个完整的、可独立运行的Python程序，该程序按原样运行并以指定格式精确打印一行输出。", "solution": "该问题陈述经过严格验证，被认为是有效的。它在科学上基于发育生物学中已建立的时钟-波前模型，其提法合规，所有必要的参数和函数都有明确定义，且其表述是客观的。该问题是一项不简单的计算任务，没有矛盾、歧义或故作高深的说法。因此，我将继续提供完整的解决方案。\n\n目标是计算模拟的Mesp2基因表达条带的半峰全宽（FWHM）。该模型描述了在一维胚胎轴 $x \\in [0, L]$（其中 $x=0$ 是后端，$x=L$ 是前端）上的一个固定时间点的Mesp2表达谱 $M(x)$。\n\n该模型通过一个抑制项和一个激活项的乘法整合来构建，代表一个逻辑与门，即基因表达必须同时满足两个条件——从抑制中解除和存在激活信号。\n\n1.  **FGF介导的抑制**：成纤维细胞生长因子（FGF）形成一个从后到前的梯度，模拟为指数衰减：\n    $$\n    F(x) = F_0 \\exp(-s x)\n    $$\n    其中 $F_0$ 是后端（$x=0$）的浓度，$s$ 是梯度的陡峭程度。FGF抑制Mesp2。此效应被建模为一个抑制解除项 $R(F)$，它是一个S型的Hill型函数。在FGF浓度低的地方，Mesp2的表达被允许。该抑制解除的空间分布为：\n    $$\n    R(x) = \\frac{1}{1 + \\left(\\frac{F(x)}{K_f}\\right)^{n_f}} = \\frac{1}{1 + \\left(\\frac{F_0 \\exp(-s x)}{K_f}\\right)^{n_f}}\n    $$\n    此处，$K_f$ 是FGF抑制效应达到最大值一半时的浓度，$n_f$ 是描述反应协同性（陡峭度）的Hill系数。对于大的 $F(x)$（在小的 $x$ 处），该函数值接近 $0$；对于小的 $F(x)$（在大的 $x$ 处），该函数值趋近于 $1$。\n\n2.  **时钟驱动的激活**：周期性的分节时钟提供了一个空间振荡的激活信号。与时钟相关的激活物的瞬时局部浓度被模拟为一个半波整流余弦函数：\n    $$\n    C(x) = \\max\\left(0, A \\cos(q x + \\phi_0)\\right)\n    $$\n    其中 $A$ 是振荡的振幅，$q$ 是空间波数，$\\phi_0$ 是相位偏移。该信号对Mesp2的转录激活由另一个Hill函数 $H(C)$ 建模：\n    $$\n    H(C) = \\begin{cases}\n    \\frac{1}{1 + \\left(\\frac{K_c}{C}\\right)^{n_c}}, & C > 0 \\\\\n    0, & C \\le 0\n    \\end{cases}\n    $$\n    其中 $K_c$ 是达到半最大激活所需的激活物浓度，$n_c$ 是Hill系数。\n\n3.  **Mesp2表达谱**：最终的Mesp2表达谱 $M(x)$ 是激活项和抑制解除项的乘积：\n    $$\n    M(x) = H(C(x)) \\cdot R(x)\n    $$\n    该表达谱只会在 $R(x)$ 显著大于 $0$（前端区域）并且 $H(C(x))$ 显著大于 $0$（在时钟振荡的正相位内）的区域表现出清晰的表达条带。\n\n计算FWHM的数值步骤如下：\n\n首先，我们定义空间网格。域 $[0, L]$ 被离散化为 $N$ 个点，$x_i = i \\cdot \\Delta x$，其中 $i = 0, 1, \\dots, N-1$，$\\Delta x = L/(N-1)$。所有模拟均使用以下常量：$L=5$，$F_0=1$，$K_f=0.2$，$n_f=4$，$q=2\\pi$，$\\phi_0=0$，$K_c=0.5$，$n_c=3$ 以及 $N=10001$。\n\n对于每个由一对参数 $(s, A)$ 定义的测试用例：\n1.  **计算表达谱**：对网格上所有的点 $x_i$ 计算函数 $F(x_i)$、$R(x_i)$、$C(x_i)$、$H(C(x_i))$ 和 $M(x_i)$ 的值。\n2.  **定位决定前沿**：决定前沿 $x_{\\mathrm{df}}$ 是一个参考位置，定义为FGF抑制被解除一半的点，即 $R(x_{\\mathrm{df}}) = \\tfrac{1}{2}$。这对应于 $F(x_{\\mathrm{df}}) = K_f$。对 $x$ 求解可得：\n    $$\n    x_{\\mathrm{df}} = \\frac{\\ln\\left(\\frac{F_0}{K_f}\\right)}{s}\n    $$\n3.  **查找并选择峰**：在计算出的Mesp2表达谱 $M(x_i)$ 中识别所有局部最大值。如果 $M_i > M_{i-1}$ 且 $M_i > M_{i+1}$，则索引为 $i$ 的点是一个局部最大值。从所有找到的峰中，我们选择空间位置最接近计算出的决定前沿 $x_{\\mathrm{df}}$ 的那个。设此峰的索引为 $i_{\\text{peak}}$，其位置为 $x_{\\text{peak}}$，其值为 $M_{\\max} = M(x_{\\text{peak}})$。如果未找到峰或 $M_{\\max}=0$，则FWHM定义为 $0$。\n4.  **计算FWHM**：FWHM是条带在其最大高度一半（$M_{\\text{hm}} = \\tfrac{1}{2} M_{\\max}$）处的宽度。我们必须在峰的两侧找到两个点 $x_{\\text{left}}$ 和 $x_{\\text{right}}$，在这两个点上 $M(x) = M_{\\text{hm}}$。\n    -   为了找到 $x_{\\text{left}}$，我们从 $i_{\\text{peak}}$ 向后搜索，找到第一个包含半最大值的网格区间 $[x_{j-1}, x_j]$（即 $M_{j-1} \\le M_{\\text{hm}} < M_j$）。\n    -   为了找到 $x_{\\text{right}}$，我们从 $i_{\\text{peak}}$ 向前搜索，找到第一个包含半最大值的网格区间 $[x_k, x_{k+1}]$（即 $M_{k+1} \\le M_{\\text{hm}} < M_k$）。\n    -   然后通过在这些区间内进行线性插值来找到位置 $x_{\\text{left}}$ 和 $x_{\\text{right}}$。对于两点 $(x_1, y_1)$ 和 $(x_2, y_2)$，目标值 $y_{\\text{target}}$ 的插值位置 $x_{\\text{interp}}$ 由下式给出：\n    $$\n    x_{\\text{interp}} = x_1 + (x_2 - x_1) \\frac{y_{\\text{target}} - y_1}{y_2 - y_1}\n    $$\n    -   FWHM就是两者之差：FWHM $= x_{\\text{right}} - x_{\\text{left}}$。\n\n整个过程是自动化的，并对所提供的六个测试用例中的每一个执行，并汇总得出的FWHM值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import find_peaks\n\ndef solve():\n    \"\"\"\n    Computes the FWHM of the Mesp2 expression stripe for a series of test cases based on\n    a minimal clock and wavefront model.\n    \"\"\"\n    # Define the constants for the simulation\n    L = 5.0\n    F0 = 1.0\n    Kf = 0.2\n    nf = 4\n    q = 2 * np.pi\n    phi0 = 0.0\n    Kc = 0.5\n    nc = 3\n    N = 10001\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 0.6),  # Case 1\n        (2.0, 0.6),  # Case 2\n        (0.5, 0.6),  # Case 3\n        (1.0, 0.2),  # Case 4\n        (1.0, 1.2),  # Case 5\n        (1.0, 0.0),  # Case 6\n    ]\n\n    results = []\n    \n    # Create the spatial grid\n    x = np.linspace(0, L, N)\n    dx = x[1] - x[0]\n\n    for s, A in test_cases:\n        # Step 1: Compute Mesp2 expression profile M(x)\n        \n        # FGF gradient and repression term R(x)\n        F = F0 * np.exp(-s * x)\n        R = 1.0 / (1.0 + (F / Kf)**nf)\n        \n        # Clock activation term C(x) and H(C(x))\n        C = np.maximum(0, A * np.cos(q * x + phi0))\n        \n        H = np.zeros_like(C)\n        # Avoid division by zero where C is 0\n        positive_C_mask = C > 0\n        H[positive_C_mask] = 1.0 / (1.0 + (Kc / C[positive_C_mask])**nc)\n        \n        # Mesp2 profile M(x)\n        M = H * R\n        \n        # Handle trivial case where M is identically zero\n        if np.all(M == 0):\n            results.append(0.0)\n            continue\n            \n        # Step 2: Find peaks and select the one closest to the determination front\n        \n        # Find all local maxima\n        peak_indices, _ = find_peaks(M)\n        \n        if len(peak_indices) == 0:\n            results.append(0.0)\n            continue\n        \n        # Calculate determination front position\n        x_df = np.log(F0 / Kf) / s\n        \n        # Select peak closest to x_df\n        peak_positions = x[peak_indices]\n        closest_peak_index_in_list = np.argmin(np.abs(peak_positions - x_df))\n        main_peak_index = peak_indices[closest_peak_index_in_list]\n        \n        M_max = M[main_peak_index]\n        \n        if M_max == 0:\n            results.append(0.0)\n            continue\n            \n        # Step 3: Calculate Full Width at Half Maximum (FWHM)\n        \n        M_half_max = M_max / 2.0\n        \n        # Find left crossing point by searching backwards from the peak\n        x_left = 0.0\n        found_left = False\n        for i in range(main_peak_index, 0, -1):\n            if M[i] > M_half_max and M[i-1] = M_half_max:\n                # Linear interpolation between points (i-1) and (i)\n                y1, y2 = M[i-1], M[i]\n                x1, x2 = x[i-1], x[i]\n                x_left = x1 + (x2 - x1) * (M_half_max - y1) / (y2 - y1)\n                found_left = True\n                break\n        \n        # Find right crossing point by searching forwards from the peak\n        x_right = 0.0\n        found_right = False\n        for i in range(main_peak_index, N - 1):\n            if M[i] > M_half_max and M[i+1] = M_half_max:\n                # Linear interpolation between points (i) and (i+1)\n                y1, y2 = M[i], M[i+1]\n                x1, x2 = x[i], x[i+1]\n                x_right = x1 + (x2 - x1) * (M_half_max - y1) / (y2 - y1)\n                found_right = True\n                break\n\n        # If either crossing was not found, FWHM is ill-defined.\n        # Based on the model, this should not happen for a valid peak.\n        if not found_left or not found_right:\n            fwhm = 0.0\n        else:\n            fwhm = x_right - x_left\n            \n        results.append(round(fwhm, 4))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2679198"}]}