{"hands_on_practices": [{"introduction": "在早期胚胎发育中，细胞如何感知其位置并做出命运决定是核心问题之一。此练习将 Hippo 信号通路和 YAP 蛋白这一关键机制简化为一个动态系统模型。通过构建并求解一个常微分方程（ODE），您将亲手计算位于胚胎内部和外部的细胞中，核内 YAP 蛋白的稳态浓度，从而将定性的生物学原理转化为定量的预测。这项实践旨在训练您运用数学模型来抽象和分析核心生物过程的能力 [@problem_id:2686350]。", "problem": "在植入前的小鼠胚胎中，外部细胞保留顶端域（apical domain）并表现出低的Hippo通路活性，而内部细胞则失去顶端域并表现出高的Hippo通路活性。当Hippo通路失活时，Yes相关蛋白（Yes-associated protein, YAP）的核定位会得到促进；而当Hippo通路激活时，其核定位会受到抑制。考虑一个描述YAP核浓度（记为 $Y_{n}$，单位为任意单位）的常微分方程（ODE），该浓度是Hippo活性变量 $H \\in \\{0,1\\}$ 的函数：\n$$\n\\frac{dY_{n}}{dt} = k_{\\mathrm{in}} \\left(1 - H \\right) - k_{\\mathrm{out}} Y_{n}.\n$$\n此处，$k_{\\mathrm{in}}$（任意单位/分钟）是一个受Hippo抑制的核输入项，$k_{\\mathrm{out}}$（/分钟）是一个一级核输出项。从生物学角度看，$H=1$ 对应内部细胞（因失去顶端域而具有高Hippo活性），$H=0$ 对应外部细胞（因具有完整的顶端域而具有低Hippo活性）。假设系统达到稳态，定义为 $\\frac{dY_{n}}{dt} = 0$，并使用参数值 $k_{\\mathrm{in}} = 1.2$（任意单位/分钟）和 $k_{\\mathrm{out}} = 0.3$（/分钟）。\n\n请通过应用稳态条件，从上述控制ODE中推导出稳态YAP核水平 $Y_{n}^{\\ast}$ 作为 $H$ 的函数，然后评估两种细胞状态下（内部 $H=1$ 和外部 $H=0$）的 $Y_{n}^{\\ast}$ 值。以任意单位表示最终数值答案。按（内部、外部）的顺序以数对形式报告您的答案。", "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 控制常微分方程 (ODE)：$\\frac{dY_{n}}{dt} = k_{\\mathrm{in}} \\left(1 - H \\right) - k_{\\mathrm{out}} Y_{n}$\n- $Y_{n}$：YAP的核浓度（任意单位）\n- $H$：Hippo活性变量，$H \\in \\{0,1\\}$\n- $k_{\\mathrm{in}}$：受Hippo抑制的核输入速率常数，$k_{\\mathrm{in}} = 1.2$（任意单位/分钟）\n- $k_{\\mathrm{out}}$：一级核输出速率常数，$k_{\\mathrm{out}} = 0.3$（/分钟）\n- $H$ 的生物学对应关系：$H=1$ 对应内部细胞，$H=0$ 对应外部细胞。\n- 稳态条件：$\\frac{dY_{n}}{dt} = 0$。\n- 目标：推导稳态YAP核水平 $Y_{n}^{\\ast}$ 作为 $H$ 的函数，然后计算 $H=1$ 和 $H=0$ 时的 $Y_{n}^{\\ast}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题提出了一个简化但标准的蛋白质核-质穿梭数学模型，该模型受上游信号通路（Hippo）调控。这是定量生物学和系统生物学中的常用方法。其生物学前提是正确的。\n- **良态问题：** 该问题提供了一个明确的ODE、所有必需的参数以及一个可以从中推导出唯一解的特定条件（稳态）。问题没有歧义。\n- **客观性：** 语言是形式化和定量的，不含主观内容。\n- **缺陷分析：**\n  - 该问题在科学上是合理的，并且可以形式化。\n  - 它是完整的且内部一致。单位是协调的：$k_{\\mathrm{in}}$ 的单位是浓度/时间，而 $k_{\\mathrm{out}} Y_{n}$ 的单位也是浓度/时间，因为 $k_{\\mathrm{out}}$ 的单位是时间的倒数，$Y_{n}$ 的单位是浓度。\n  - 在一个简化模型的背景下，该设定在物理上是合理的。\n  - 对于每个指定的 $H$ 值，都存在一个唯一的、稳定的解。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。将提供解答。\n\n分析从所给的描述核YAP浓度 $Y_n$ 变化率的常微分方程开始：\n$$\n\\frac{dY_{n}}{dt} = k_{\\mathrm{in}} \\left(1 - H \\right) - k_{\\mathrm{out}} Y_{n}\n$$\n问题要求找到稳态浓度，记为 $Y_{n}^{\\ast}$。根据定义，当一个系统的状态变量随时间没有净变化时，该系统处于稳态。对于变量 $Y_{n}$，这个条件表示为：\n$$\n\\frac{dY_{n}}{dt} = 0\n$$\n将此条件应用于控制ODE，并将 $Y_n$ 替换为其稳态值 $Y_{n}^{\\ast}$：\n$$\n0 = k_{\\mathrm{in}} \\left(1 - H \\right) - k_{\\mathrm{out}} Y_{n}^{\\ast}\n$$\n这是一个关于 $Y_{n}^{\\ast}$ 的代数方程。为了推导出 $Y_{n}^{\\ast}$ 作为Hippo活性变量 $H$ 的函数的表达式，我们重新整理该方程：\n$$\nk_{\\mathrm{out}} Y_{n}^{\\ast} = k_{\\mathrm{in}} \\left(1 - H \\right)\n$$\n方程两边同除以 $k_{\\mathrm{out}}$（非零）来求解 $Y_{n}^{\\ast}$，得到通用的稳态解：\n$$\nY_{n}^{\\ast}(H) = \\frac{k_{\\mathrm{in}}}{k_{\\mathrm{out}}} \\left(1 - H \\right)\n$$\n这个表达式给出了对于任何给定的 $H$ 值，稳态下的核YAP浓度。我们现在的任务是为两种指定的细胞状态评估这个表达式。\n\n情况1：内部细胞\n对于内部细胞，Hippo通路高度活跃，对应于 $H=1$。将 $H=1$ 代入通用稳态解：\n$$\nY_{n, \\text{inside}}^{\\ast} = Y_{n}^{\\ast}(1) = \\frac{k_{\\mathrm{in}}}{k_{\\mathrm{out}}} \\left(1 - 1 \\right) = \\frac{k_{\\mathrm{in}}}{k_{\\mathrm{out}}} \\left(0 \\right) = 0\n$$\n因此，内部细胞中的稳态核YAP浓度为 $0$ 任意单位。\n\n情况2：外部细胞\n对于外部细胞，Hippo通路活性较低，对应于 $H=0$。将 $H=0$ 代入通用稳态解：\n$$\nY_{n, \\text{outside}}^{\\ast} = Y_{n}^{\\ast}(0) = \\frac{k_{\\mathrm{in}}}{k_{\\mathrm{out}}} \\left(1 - 0 \\right) = \\frac{k_{\\mathrm{in}}}{k_{\\mathrm{out}}}\n$$\n现在，我们代入给定的参数数值 $k_{\\mathrm{in}} = 1.2$ 任意单位/分钟和 $k_{\\mathrm{out}} = 0.3$ /分钟：\n$$\nY_{n, \\text{outside}}^{\\ast} = \\frac{1.2}{0.3} = 4\n$$\n因此，外部细胞中的稳态核YAP浓度为 $4$ 任意单位。\n\n最终答案需按（内部、外部）的顺序以数对形式报告。\n- 内部细胞稳态YAP ($Y_{n, \\text{inside}}^{\\ast}$): $0$\n- 外部细胞稳态YAP ($Y_{n, \\text{outside}}^{\\ast}$): $4$\n\n序数对是 ($0$, $4$)。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 4 \\end{pmatrix}}\n$$", "id": "2686350"}, {"introduction": "细胞命运的决定不仅仅依赖于单个分子的动态，更取决于一个由多个基因相互作用构成的复杂网络。在上一个练习中，我们关注了上游信号如何调控 YAP；现在，我们将探讨 YAP 的下游靶标（如转录因子 $\\text{CDX2}$）如何构成一个基因调控网络（GRN），并最终锁定细胞命运。此练习要求您通过一个布尔网络模型，模拟滋养层与内细胞团命运决定的核心逻辑，并找出代表稳定细胞命运的“吸引子”。这个过程将使您深入理解细胞命运是如何通过基因网络的“多稳态”特性来实现和维持的 [@problem_id:2686330]。", "problem": "给定一个同步布尔基因调控网络，用于模拟滋养层与内细胞团的谱系特化，其节点集为 $\\{\\mathrm{CDX2},\\mathrm{ELF5},\\mathrm{EOMES},\\mathrm{OCT4}\\}$。每个节点都有一个布尔状态 $x \\in \\{0,1\\}$，表示其在离散时间步 $t \\in \\mathbb{Z}_{\\ge 0}$ 时的转录状态。全局网络状态是一个向量 $\\mathbf{x}(t) = \\big(x_{\\mathrm{CDX2}}(t), x_{\\mathrm{ELF5}}(t), x_{\\mathrm{EOMES}}(t), x_{\\mathrm{OCT4}}(t)\\big) \\in \\{0,1\\}^{4}$。同步更新映射 $\\mathbf{F}:\\{0,1\\}^{4}\\to \\{0,1\\}^{4}$ 由布尔函数定义，这些函数源自基因调控的核心原理：多能性程序与滋养层程序之间的相互抑制，以及滋养层转录因子之间的协同自维持。使用标准逻辑连接词 $\\lor$ (或)、$\\land$ (与) 和 $\\neg$ (非)，更新函数如下：\n$$\n\\begin{aligned}\nf_{\\mathrm{CDX2}}(\\mathbf{x}) &= \\big(x_{\\mathrm{ELF5}} \\lor x_{\\mathrm{EOMES}} \\lor x_{\\mathrm{CDX2}}\\big) \\land \\neg x_{\\mathrm{OCT4}},\\\\\nf_{\\mathrm{ELF5}}(\\mathbf{x}) &= \\big(x_{\\mathrm{CDX2}} \\lor x_{\\mathrm{EOMES}} \\lor x_{\\mathrm{ELF5}}\\big) \\land \\neg x_{\\mathrm{OCT4}},\\\\\nf_{\\mathrm{EOMES}}(\\mathbf{x}) &= \\big(x_{\\mathrm{CDX2}} \\lor x_{\\mathrm{ELF5}} \\lor x_{\\mathrm{EOMES}}\\big) \\land \\neg x_{\\mathrm{OCT4}},\\\\\nf_{\\mathrm{OCT4}}(\\mathbf{x}) &= \\neg \\big(x_{\\mathrm{CDX2}} \\lor x_{\\mathrm{ELF5}} \\lor x_{\\mathrm{EOMES}}\\big).\n\\end{aligned}\n$$\n同步更新为 $\\mathbf{x}(t+1) = \\mathbf{F}\\big(\\mathbf{x}(t)\\big)$。稳定吸引子（不动点）是满足 $\\mathbf{F}(\\mathbf{x}^{\\ast}) = \\mathbf{x}^{\\ast}$ 的任意状态 $\\mathbf{x}^{\\ast} \\in \\{0,1\\}^{4}$。在某些情况下，特定节点被钳制（外部强制）在某个固定值上；从数学上讲，将子集 $\\mathcal{C} \\subseteq \\{\\mathrm{CDX2},\\mathrm{ELF5},\\mathrm{EOMES},\\mathrm{OCT4}\\}$ 钳制到指定值，定义了一个受约束的更新 $\\tilde{\\mathbf{F}}$，它首先计算 $\\mathbf{F}$，然后对于所有 $i \\in \\mathcal{C}$，将 $x_i$ 覆写为其钳制值。钳制稳定吸引子是 $\\tilde{\\mathbf{F}}$ 的一个不动点。\n\n对任意状态 $\\mathbf{x}$ 定义表型分类如下：\n- 类滋养层细胞 (TE-like)：如果 $\\big(x_{\\mathrm{CDX2}} + x_{\\mathrm{ELF5}} + x_{\\mathrm{EOMES}}\\big) \\ge 2$ 且 $x_{\\mathrm{OCT4}} = 0$。\n- 类内细胞团 (ICM-like)：如果 $x_{\\mathrm{CDX2}} = x_{\\mathrm{ELF5}} = x_{\\mathrm{EOMES}} = 0$ 且 $x_{\\mathrm{OCT4}} = 1$。\n- 否则，分类为其他。\n\n对于任意状态 $\\mathbf{x} = \\big(x_{\\mathrm{CDX2}}, x_{\\mathrm{ELF5}}, x_{\\mathrm{EOMES}}, x_{\\mathrm{OCT4}}\\big)$，定义一个整数编码\n$$\nv(\\mathbf{x}) \\;=\\; 8\\,x_{\\mathrm{CDX2}} \\;+\\; 4\\,x_{\\mathrm{ELF5}} \\;+\\; 2\\,x_{\\mathrm{EOMES}} \\;+\\; 1\\,x_{\\mathrm{OCT4}}.\n$$\n这将每个布尔状态映射到 $\\{0,1,\\dots,15\\}$ 中的一个唯一整数。\n\n任务：编写一个程序，该程序针对以下每个钳制测试用例，枚举出指定同步动态下的所有稳定吸引子（不动点），对每个吸引子进行分类，并按要求的格式输出结果。\n\n测试套件（每个用例指定一个钳制集 $\\mathcal{C}$ 及其强制值）：\n- 用例 A (野生型)：无钳制，$\\mathcal{C} = \\varnothing$。\n- 用例 B (OCT4 强制开启)：钳制 $x_{\\mathrm{OCT4}} \\equiv 1$。\n- 用例 C (OCT4 敲除)：钳制 $x_{\\mathrm{OCT4}} \\equiv 0$。\n- 用例 D (ELF5 敲除)：钳制 $x_{\\mathrm{ELF5}} \\equiv 0$。\n\n对于每个用例，程序必须：\n- 枚举所有 $\\mathbf{x} \\in \\{0,1\\}^{4}$，应用相应的受约束更新 $\\tilde{\\mathbf{F}}$，并收集所有不动点。\n- 对于每个不动点，计算其 $v(\\mathbf{x})$ 并分配一个分类代码 $c(\\mathbf{x}) \\in \\{-1,0,1\\}$，其中 $1$ 表示 TE-like， $0$ 表示 ICM-like， $-1$ 表示其他。\n- 按 $v(\\mathbf{x})$ 的升序对吸引子进行排序。\n\n最终输出格式：\n- 程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中应按 A、B、C、D 的顺序为每个测试用例包含一个元素。每个元素本身必须是该用例的 $[v(\\mathbf{x}), c(\\mathbf{x})]$ 对的列表，并按 $v(\\mathbf{x})$ 排序。例如，一个有效的总输出具有以下形式：\n$[[[v_1,c_1],[v_2,c_2]],[[v_3,c_3]],[[v_4,c_4]],[[v_5,c_5],[v_6,c_6]]].$\n- 输出为无量纲整数；不涉及物理单位。不出现角度。不使用百分比。\n\n- 您的程序必须是一个完整、可运行的脚本，该脚本完全按照上述格式生成一行输出，不含任何额外文本。", "solution": "该问题陈述已经过严格验证，被认为是科学上合理、良构且客观的。它描述了系统生物学中的一个经典问题：同步布尔网络中不动点的分析，这是模拟基因调控网络的标准形式体系。网络动力学、钳制条件、状态分类和计算任务都以数学上的精确性进行了定义，并且没有矛盾或歧义。其生物学前提，即多能性因子（如 $\\mathrm{OCT4}$）与滋养外胚层因子（如 $\\mathrm{CDX2}$, $\\mathrm{ELF5}$, $\\mathrm{EOMES}$）之间的相互拮抗，是对发育生物学既定原则的一种有效但简化的表示。因此，一个完整的解决方案是合理的。\n\n问题的核心是在几种外部钳制条件下，识别一个离散动力系统的所有稳定吸引子，特指不动点。系统的不动点 $\\mathbf{x}^{\\ast}$（其更新映射为 $\\tilde{\\mathbf{F}}$）是一个满足条件 $\\mathbf{x}^{\\ast} = \\tilde{\\mathbf{F}}(\\mathbf{x}^{\\ast})$ 的状态。状态空间是有限的，包含 $2^4 = 16$ 个可能的状态，这允许通过穷举法获得完整解。\n\n状态向量为 $\\mathbf{x} = (x_{\\mathrm{CDX2}}, x_{\\mathrm{ELF5}}, x_{\\mathrm{EOMES}}, x_{\\mathrm{OCT4}})$，其中每个分量 $x_i \\in \\{0, 1\\}$。同步更新映射 $\\mathbf{F}(\\mathbf{x}) = (f_{\\mathrm{CDX2}}(\\mathbf{x}), f_{\\mathrm{ELF5}}(\\mathbf{x}), f_{\\mathrm{EOMES}}(\\mathbf{x}), f_{\\mathrm{OCT4}}(\\mathbf{x}))$ 由以下布尔函数定义：\n$$\n\\begin{aligned}\nf_{\\mathrm{CDX2}}(\\mathbf{x}) &= T(\\mathbf{x}) \\land \\neg x_{\\mathrm{OCT4}} \\\\\nf_{\\mathrm{ELF5}}(\\mathbf{x}) &= T(\\mathbf{x}) \\land \\neg x_{\\mathrm{OCT4}} \\\\\nf_{\\mathrm{EOMES}}(\\mathbf{x}) &= T(\\mathbf{x}) \\land \\neg x_{\\mathrm{OCT4}} \\\\\nf_{\\mathrm{OCT4}}(\\mathbf{x}) &= \\neg T(\\mathbf{x})\n\\end{aligned}\n$$\n其中 $T(\\mathbf{x}) = x_{\\mathrm{CDX2}} \\lor x_{\\mathrm{ELF5}} \\lor x_{\\mathrm{EOMES}}$ 是一个辅助函数，代表滋养层特化转录因子的集体活性。\n\n计算策略如下：\n1. 遍历每个可能的状态 $\\mathbf{x} \\in \\{0, 1\\}^4$。\n2. 对每个状态和每个钳制场景，计算下一个状态 $\\mathbf{y} = \\mathbf{F}(\\mathbf{x})$。\n3. 对 $\\mathbf{y}$ 应用相应的钳制条件，以获得受约束的下一个状态 $\\mathbf{x}' = \\tilde{\\mathbf{F}}(\\mathbf{x})$。\n4. 如果 $\\mathbf{x}' = \\mathbf{x}$，则 $\\mathbf{x}$ 是该场景下的一个不动点。\n5. 对每个识别出的不动点，计算其整数编码 $v(\\mathbf{x}) = 8x_{\\mathrm{CDX2}} + 4x_{\\mathrm{ELF5}} + 2x_{\\mathrm{EOMES}} + 1x_{\\mathrm{OCT4}}$ 及其表型分类代码 $c(\\mathbf{x})$。\n6. 收集并按每个用例的指定要求对结果进行排序。\n\n表型分类函数 $c(\\mathbf{x})$ 定义如下：\n$$\nc(\\mathbf{x}) = \\begin{cases} \n1 & \\text{if } (x_{\\mathrm{CDX2}} + x_{\\mathrm{ELF5}} + x_{\\mathrm{EOMES}}) \\ge 2 \\text{ and } x_{\\mathrm{OCT4}} = 0 \\quad (\\text{TE-like}) \\\\\n0 & \\text{if } x_{\\mathrm{CDX2}} = x_{\\mathrm{ELF5}} = x_{\\mathrm{EOMES}} = 0 \\text{ and } x_{\\mathrm{OCT4}} = 1 \\quad (\\text{ICM-like}) \\\\\n-1 & \\text{otherwise} \\end{cases}\n$$\n\n我们现在系统地分析每个测试用例。\n\n**用例 A：野生型（无钳制）**\n在此，受约束的更新映射 $\\tilde{\\mathbf{F}}$ 与无约束的映射 $\\mathbf{F}$ 相同。我们寻找满足 $\\mathbf{x}^{\\ast} = \\mathbf{F}(\\mathbf{x}^{\\ast})$ 的状态 $\\mathbf{x}^{\\ast}$。通过遍历所有 16 个状态，我们找到两个不动点：\n1. $\\mathbf{x}^{\\ast}_1 = (0, 0, 0, 1)$。此处 $T=0$。$\\mathbf{F}(\\mathbf{x}^{\\ast}_1) = (0 \\land \\neg 1, 0 \\land \\neg 1, 0 \\land \\neg 1, \\neg 0) = (0, 0, 0, 1)$。这是一个不动点。\n   - $v(\\mathbf{x}^{\\ast}_1) = 1$。\n   - 分类：$x_{\\mathrm{CDX2}} + x_{\\mathrm{ELF5}} + x_{\\mathrm{EOMES}} = 0$ 且 $x_{\\mathrm{OCT4}}=1$。这是 ICM-like，因此 $c(\\mathbf{x}^{\\ast}_1)=0$。\n2. $\\mathbf{x}^{\\ast}_2 = (1, 1, 1, 0)$。此处 $T=1$。$\\mathbf{F}(\\mathbf{x}^{\\ast}_2) = (1 \\land \\neg 0, 1 \\land \\neg 0, 1 \\land \\neg 0, \\neg 1) = (1, 1, 1, 0)$。这是一个不动点。\n   - $v(\\mathbf{x}^{\\ast}_2) = 8+4+2 = 14$。\n   - 分类：$x_{\\mathrm{CDX2}} + x_{\\mathrm{ELF5}} + x_{\\mathrm{EOMES}} = 3 \\ge 2$ 且 $x_{\\mathrm{OCT4}}=0$。这是 TE-like，因此 $c(\\mathbf{x}^{\\ast}_2)=1$。\n用例 A 的排序结果：$[[1, 0], [14, 1]]$。\n\n**用例 B：OCT4 强制开启（钳制 $x_{\\mathrm{OCT4}} \\equiv 1$）**\n如果一个状态 $\\mathbf{x}^{\\ast}$ 等于计算 $\\mathbf{F}(\\mathbf{x}^{\\ast})$ 然后将 $\\mathrm{OCT4}$ 分量强制为 1 的结果，那么它就是一个不动点。为了成为不动点，该状态本身必须具有 $x_{\\mathrm{OCT4}} = 1$。\n令 $\\mathbf{x}^{\\ast} = (x_{\\mathrm{CDX2}}, x_{\\mathrm{ELF5}}, x_{\\mathrm{EOMES}}, 1)$。$\\mathbf{y} = \\mathbf{F}(\\mathbf{x}^{\\ast})$，且 $\\mathbf{x}'$ 是将 $\\mathbf{y}$ 的 $y_4$ 设置为 1 后的状态。我们需要 $\\mathbf{x}^{\\ast} = \\mathbf{x}'$。\n对于任何 $x_{\\mathrm{OCT4}} = 1$ 的状态 $\\mathbf{x}$，前三个分量的更新函数为 $f(\\mathbf{x}) = T(\\mathbf{x}) \\land \\neg 1 = 0$。因此，对于任何此类状态，$\\mathbf{F}(\\mathbf{x})$ 的前三个分量都将为 0。所以唯一可能的不动点必须是 $(0, 0, 0, 1)$ 的形式。我们检查此状态：\n1. $\\mathbf{x}^{\\ast} = (0, 0, 0, 1)$。如同在用例 A 中，$\\mathbf{F}(0, 0, 0, 1) = (0, 0, 0, 1)$。将第四个分量覆写为 1 不会改变结果。因此，$\\tilde{\\mathbf{F}}(0, 0, 0, 1) = (0, 0, 0, 1)$。它是一个不动点。\n   - $v(\\mathbf{x}^{\\ast}) = 1$。\n   - 分类是 ICM-like，$c(\\mathbf{x}^{\\ast})=0$。\n用例 B 的结果：$[[1, 0]]$。\n\n**用例 C：OCT4 敲除（钳制 $x_{\\mathrm{OCT4}} \\equiv 0$）**\n在这里，我们在每次更新后将 $x_{\\mathrm{OCT4}}$ 钳制为 0。不动点 $\\mathbf{x}^{\\ast}$ 必须具有 $x_{\\mathrm{OCT4}} = 0$。\n1. 检查 $\\mathbf{x}^{\\ast} = (0, 0, 0, 0)$。此处 $T=0$。$\\mathbf{F}(0, 0, 0, 0) = (0 \\land \\neg 0, ..., \\neg 0) = (0, 0, 0, 1)$。将 $x_{\\mathrm{OCT4}}$ 钳制为 0 得到 $(0, 0, 0, 0)$，即原始状态。它是一个不动点。\n   - $v(\\mathbf{x}^{\\ast}) = 0$。\n   - 分类：滋养层因子的和为 0，且 $x_{\\mathrm{OCT4}}=0$。这既不符合 TE-like 也不符合 ICM-like 的标准。它是“其他”，因此 $c(\\mathbf{x}^{\\ast})=-1$。\n2. 检查 $\\mathbf{x}^{\\ast} = (1, 1, 1, 0)$。此处 $T=1$。$\\mathbf{F}(1, 1, 1, 0) = (1 \\land \\neg 0, ..., \\neg 1) = (1, 1, 1, 0)$。将 $x_{\\mathrm{OCT4}}$ 钳制为 0 不会改变结果。它是一个不动点。\n   - $v(\\mathbf{x}^{\\ast}) = 14$。\n   - 分类是 TE-like，$c(\\mathbf{x}^{\\ast})=1$。\n用例 C 的排序结果：$[[0, -1], [14, 1]]$。\n\n**用例 D：ELF5 敲除（钳制 $x_{\\mathrm{ELF5}} \\equiv 0$）**\n我们在每次更新后将 $x_{\\mathrm{ELF5}}$ 钳制为 0。不动点 $\\mathbf{x}^{\\ast}$ 必须具有 $x_{\\mathrm{ELF5}} = 0$。\n1. 检查 $\\mathbf{x}^{\\ast} = (0, 0, 0, 1)$。此处 $T=0$。$\\mathbf{F}(0, 0, 0, 1) = (0, 0, 0, 1)$。将 $x_{\\mathrm{ELF5}}$ 钳制为 0 不会改变结果。它是一个不动点。\n   - $v(\\mathbf{x}^{\\ast}) = 1$。\n   - 分类是 ICM-like，$c(\\mathbf{x}^{\\ast})=0$。\n2. 检查其他 $x_{\\mathrm{ELF5}}=0$ 的状态。考虑 $\\mathbf{x}^{\\ast} = (1, 0, 1, 0)$。此处 $T = 1 \\lor 0 \\lor 1 = 1$。$\\mathbf{F}(\\mathbf{x}^{\\ast}) = (1 \\land \\neg 0, 1 \\land \\neg 0, 1 \\land \\neg 0, \\neg 1) = (1, 1, 1, 0)$。将 $x_{\\mathrm{ELF5}}$ 钳制为 0 得到 $(1, 0, 1, 0)$，即原始状态。它是一个不动点。\n   - $v(\\mathbf{x}^{\\ast}) = 8(1) + 4(0) + 2(1) + 1(0) = 10$。\n   - 分类：$x_{\\mathrm{CDX2}} + x_{\\mathrm{ELF5}} + x_{\\mathrm{EOMES}} = 1+0+1 = 2$。由于 $2 \\ge 2$ 且 $x_{\\mathrm{OCT4}}=0$，这是 TE-like。所以 $c(\\mathbf{x}^{\\ast})=1$。\n用例 D 的排序结果：$[[1, 0], [10, 1]]$。\n\n下面的程序将实现这种穷举搜索并重现这些发现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Boolean network problem by enumerating all states and finding\n    fixed points under different clamping conditions.\n    \"\"\"\n\n    # Test cases: (clamp_idx, clamp_val) or None for wild-type\n    # Node order: CDX2, ELF5, EOMES, OCT4\n    # Indices:    0,    1,    2,     3\n    test_cases = {\n        'A': None,                     # Case A: wild-type\n        'B': {'idx': 3, 'val': 1},     # Case B: OCT4 forced ON\n        'C': {'idx': 3, 'val': 0},     # Case C: OCT4 knockout\n        'D': {'idx': 1, 'val': 0},     # Case D: ELF5 knockout\n    }\n\n    # The order of execution must be A, B, C, D\n    case_order = ['A', 'B', 'C', 'D']\n    \n    all_results = []\n\n    # Number of nodes\n    n_nodes = 4\n    # Total number of states = 2^n_nodes\n    n_states = 1 << n_nodes\n\n    for case_key in case_order:\n        clamp_info = test_cases[case_key]\n        fixed_points = []\n        \n        # Iterate through all 2^4 = 16 possible states\n        for i in range(n_states):\n            # The state vector x is represented as a list of integers (0 or 1)\n            # The order is [x_CDX2, x_ELF5, x_EOMES, x_OCT4]\n            # This corresponds to binary representation of i, padded with zeros\n            state_bin = format(i, f'0{n_nodes}b')\n            x = [int(bit) for bit in state_bin]\n            \n            # Unpack state variables for clarity\n            x_cdx2, x_elf5, x_eomes, x_oct4 = x\n            \n            # --- 1. Compute the next state using the unconstrained update map F ---\n            # T = x_CDX2 OR x_ELF5 OR x_EOMES\n            T = bool(x_cdx2 or x_elf5 or x_eomes)\n            \n            # not_oct4 = NOT x_OCT4\n            not_oct4 = not bool(x_oct4)\n            \n            # Update functions\n            f_cdx2 = T and not_oct4\n            f_elf5 = T and not_oct4\n            f_eomes = T and not_oct4\n            f_oct4 = not T\n            \n            next_x_unclamped = [int(f_cdx2), int(f_elf5), int(f_eomes), int(f_oct4)]\n            \n            # --- 2. Apply clamping to get the constrained next state ---\n            next_x_clamped = list(next_x_unclamped)\n            if clamp_info is not None:\n                clamp_idx = clamp_info['idx']\n                clamp_val = clamp_info['val']\n                next_x_clamped[clamp_idx] = clamp_val\n            \n            # --- 3. Check for fixed point condition ---\n            if next_x_clamped == x:\n                # This state x is a fixed point for the current case.\n                \n                # --- 4. Compute integer encoding v(x) ---\n                v_x = 8 * x_cdx2 + 4 * x_elf5 + 2 * x_eomes + 1 * x_oct4\n                \n                # --- 5. Compute phenotype classification c(x) ---\n                troph_sum = x_cdx2 + x_elf5 + x_eomes\n                c_x = -1 # Default to 'other'\n                if troph_sum >= 2 and x_oct4 == 0:\n                    c_x = 1  # TE-like\n                elif troph_sum == 0 and x_oct4 == 1:\n                    c_x = 0  # ICM-like\n\n                fixed_points.append([v_x, c_x])\n\n        # Sort the collected fixed points by their integer encoding v(x)\n        fixed_points.sort(key=lambda p: p[0])\n        all_results.append(fixed_points)\n\n    # Format the final output string as specified\n    # The map(str, ...) converts each inner list to its string representation\n    # e.g., [[1, 0], [14, 1]] becomes \"[[1, 0], [14, 1]]\"\n    output_str = f\"[{','.join(map(str, all_results))}]\"\n    \n    # Python's default str() adds spaces. The required format has none.\n    # A simple replace ensures strict formatting.\n    output_str = output_str.replace(\" \", \"\")\n\n    print(output_str)\n\nsolve()\n```", "id": "2686330"}, {"introduction": "理论模型为我们提供了关于生物系统的深刻见解，但这些模型必须经过严格的实验验证。一个常见的挑战是，一个基因（如 $\\text{CDX2}$）可能在命运决定的启动阶段和维持阶段扮演不同角色，而要区分这两种作用需要精巧的实验设计。此练习要求您跳出建模者的角色，以实验生物学家的视角，运用因果推理来评估不同的实验方案。通过分析这些方案，您将学会如何设计能够精准区分基因在不同时间窗口功能的实验，这是连接理论模型与实验验证的关键一步 [@problem_id:2686307]。", "problem": "在早期哺乳动物发育中，外部的卵裂球形成滋养层谱系（滋养外胚层；TE），而内部的细胞则形成内细胞团（ICM）。转录因子Caudal Type Homeobox 2 (CDX2)与TE的特化有关。考虑以下一个最小化的因果动力学抽象，该抽象与分子生物学中心法则（DNA到RNA到蛋白质）和标准的基因调控网络原理一致：设$x(t)$表示在发育时间$t$内，一个外部卵裂球中CDX2蛋白的浓度，并设$F(t) \\in \\{0,1\\}$表示TE基因调控程序是否已不可逆地启动（$F(t)=1$）或尚未启动（$F(t)=0$）。存在一个启动窗口$[t_0,t_1]$，在此期间，从$F(t)=0$切换到$F(t)=1$的概率速率单调地依赖于$x(t)$（例如，通过一个阈值过程）。还有一个启动后阶段$t>t_1$，在此期间，$F(t)=1$的状态可以通过依赖于CDX2的前馈环或不依赖于CDX2的反馈稳定机制来维持。\n\n使用基于因果关系的反事实推理，可以将启动时的必要性形式化为以下陈述：如果构建一个处理方案$a(t)$，仅在$t \\in [t_0,t_1]$期间移除CDX2，而在其他时间保持其存在，那么对于在此方案下$F(t_1)=0$的胚胎，在稍后的读出时间$t^\\ast>t_1$的结局$Y^{(a)}(t^\\ast)$（例如，TE标记物阳性细胞的比例）将不同于在始终保持CDX2存在的反事实方案$\\tilde{a}(t)$下的结局$Y^{(\\tilde{a})}(t^\\ast)$。相比之下，维持作用则意味着，仅在$t_1$之后移除CDX2（在启动后阶段开始时，保持$F(t_1)=1$不变）会相对于反事实方案$\\tilde{a}(t)$改变$Y^{(a)}(t^\\ast)$。\n\n你的任务是选择一个最合适的实验策略，该策略在实践中能够通过实施上述反事实对比，来区分CDX2在TE谱系特化中的启动作用和维持作用，同时要符合小鼠植入前发育的生物学现实（大约在8细胞阶段外部细胞发生极化，此后形成囊胚）。以下哪个选项最能满足这些要求？\n\nA. 设计一种可诱导、快速且可逆的CDX2扰动（例如，小分子控制的degron），以实施两种互补的处理方案：仅在$t \\in [t_0,t_1]$期间移除CDX2并在其后恢复；以及在另一组中，在$[t_0,t_1]$期间保留CDX2，但仅在$t>t_1$时移除它。在匹配的读出时间$t^\\ast$定量评估早期的启动读出指标（例如，顶端极性和早期TE靶基因激活）和后期的维持读出指标（例如，持续的ELF5和EOMES表达及上皮完整性）。包括在组成型无效背景中，通过提供一个仅限于$[t_0,t_1]$的CDX2脉冲来进行互补拯救实验。\n\nB. 使用组成型*Cdx2*敲除，并通过向合子中注射母源*Cdx2*信使RNA来尝试“晚期拯救”，然后在囊胚阶段测量TE标记物，不进行额外的时间控制。\n\nC. 在囊胚形成后，特异性地在内细胞团细胞中过表达CDX2，以测试ICM细胞是否能被重编程为TE；利用此结果推断早期在外部细胞中启动TE是否需要CDX2。\n\nD. 在植入前胚胎中，进行无时间控制的镶嵌式CRISPR–Cas$9$诱变，作用于*Cdx2*；在扩张囊胚期分析谱系结局，并根据表型的严重程度推断启动与维持作用。\n\nE. 从8细胞阶段到囊胚期，进行无扰动的高时间分辨率单细胞RNA测序；通过将*Cdx2*表达与TE标记物动态相关联，从转录组轨迹中推断CDX2的启动与维持作用。\n\n选择最佳答案，并参照上文阐述的因果-反事实逻辑（CDX2仅在$[t_0,t_1]$期间存在与否 vs. 仅在$t>t_1]$期间存在与否）以及TE启动和维持的生物学过程来证明你的选择。", "solution": "我们从分子生物学中心法则（DNA到RNA到蛋白质）和标准的因果推理出发：像CDX2这样的蛋白质通过与DNA结合并改变靶基因的转录来实现调控控制，从而随时间影响细胞状态。TE谱系决定可以被概念化为在一个动态基因调控网络中从TE前状态到TE状态的转变。在一个最小化的抽象中，当外部细胞的顶端极性、Hippo通路状态和TEAD4活性汇集时，在启动窗口$[t_0,t_1]$期间，CDX2蛋白浓度$x(t)$影响从$F(t)=0$切换到$F(t)=1$的风险率。此后，在$t>t_1$时，$F(t)=1$的维持反映了TE吸引子的持续强化，这可能通过依赖于CDX2的对ELF5和EOMES等基因的前馈调控、上皮完整性以及自我增强的染色质状态来实现。\n\n反事实推理要求比较在仅CDX2存在时间不同的处理方案$a(t)$下的结局。将$Y^{(a)}(t^\\ast)$定义为在时间$t^\\ast>t_1$的一个可测量的读出指标（例如，TE标记物阳性细胞的比例、TE上皮完整性或维持因子的表达水平）。为了检验启动的必要性，必须特异性地在$[t_0,t_1]$期间移除CDX2但在其后恢复它，并将$Y^{(a)}(t^\\ast)$与在始终保持CDX2存在的方案$\\tilde{a}(t)$下的$Y^{(\\tilde{a})}(t^\\ast)$进行比较。如果CDX2对启动至关重要，那么仅限于$[t_0,t_1]$期间的移除将减少达到$F(t_1)=1$的比例，因此即使之后恢复CDX2，也会降低$Y^{(a)}(t^\\ast)$。为了检验维持的必要性，必须保持启动过程完整（在$[t_0,t_1]$期间存在CDX2，从而建立$F(t_1)=1$），然后仅在$t>t_1$时移除CDX2。如果CDX2对维持至关重要，那么这将使TE标记物和上皮在$t>t_1$时不稳定，从而相对于持续存在的方案降低$Y^{(a)}(t^\\ast)$。\n\n我们现在分析每个选项：\n\nA. 设计一种可诱导、快速且可逆的扰动，并实施两种互补的方案：严格在$[t_0,t_1]$期间移除（启动测试）与严格在$t_1$后移除（维持测试），并在匹配的读出时间$t^\\ast$进行评估。这个设计直接实现了因果关系所要求的反事实对比：$a(t)$与$\\tilde{a}(t)$仅在一个确定的时间窗口内有所不同。快速控制（例如，像生长素诱导或dTAG系统这样的小分子degron）确保了$x(t)$相对于生物决策窗口被急剧调控，满足了$F(t)$响应于$x(t)$时间分布的假设。在组成型无效背景中包含一个时间受限的拯救脉冲，操作化了相反的反事实：如果仅在$[t_0,t_1]$期间存在便足以启动，以及如果在$t_1$之后移除不削弱TE标记物则对维持是可有可无的。这对于植入前胚胎是科学上可行的，并使用了涵盖早期启动（例如，顶端极性和早期TE靶基因激活）和后期维持（例如，ELF5/EOMES和上皮完整性）的读出指标。该选项正确地区分了启动与维持。结论 — 正确。\n\nB. 组成型敲除在所有时间$t$都移除了CDX2，混淆了启动和维持作用，因为其缺失横跨了$[t_0,t_1]$和$t>t_1]$两个阶段。在合子阶段注射母源信使RNA提供的不是晚期拯救，而是非常早期的表达；此外，由于无法精确控制$x(t)$相对于$[t_0,t_1]$的时间，无法构建“仅在$t_1$后存在”或“仅在$[t_0,t_1]$期间缺失”的反事实方案。因此，该设计无法清晰地分离启动与维持作用。结论 — 错误。\n\nC. 在囊胚形成后于内细胞团细胞中过表达CDX2测试的是其重编程ICM为TE的充分性，这是一个不同的问题。它没有在经历TE命运的外部细胞中实施关于CDX2在$[t_0,t_1]$期间与$t>t_1]$期间存在的必要反事实方案。这里的任何结果主要提供关于潜能或重编程的信息，而不能在正常的时空背景下解决启动与维持的必要性问题。结论 — 错误。\n\nD. 无时间控制的镶嵌式CRISPR–Cas$9$诱变引入了空间异质性，但在靶向克隆中，它在启动和维持两个阶段都移除了CDX2。表型的严重程度不能明确归因于启动失败还是维持失败，因为在突变细胞中处理方案$a(t)$是恒定的（CDX2在所有$t$都缺失）。没有时间控制，无法实施反事实比较。结论 — 错误。\n\nE. 高时间分辨率的单细胞转录组学可以得出*Cdx2*表达与TE标记物之间的相关性，但它缺乏干预。在时间$t$上的相关性并不能确定在特定阶段的必要性，也无法近似所需的反事实（如果CDX2仅在$[t_0,t_1]$期间缺失或仅在$t>t_1]$期间缺失会发生什么）。没有扰动，对启动与维持的因果归因是不合理的。结论 — 错误。\n\n因此，只有选项A满足了因果-反事实的设计标准和区分CDX2在滋养层谱系特化中启动与维持作用所需的生物学约束。", "answer": "$$\\boxed{A}$$", "id": "2686307"}]}