{"hands_on_practices": [{"introduction": "在发育生物学中，量化细胞如何响应信号分子是理解形态发生的关键。希尔方程 (Hill equation) 是描述基因转录响应浓度梯度信号的基础工具。本练习以雌性生殖腺中视黄酸 (retinoic acid) 激活减数分裂关键基因 $Stra8$ 为例，让你亲手推导该响应曲线的关键特性，例如其半激活浓度和局部灵敏度。通过这个过程，你将加深对生物开关中“超敏性” (ultrasensitivity) 概念的理解。[@problem_id:2628625]", "problem": "在胚胎期小鼠卵巢中，维甲酸 (retinoic acid, RA) 会诱导受维甲酸刺激基因8 (Stimulated by Retinoic Acid 8, Stra8) 的转录，Stra8 是生殖细胞进入减数分裂的关键门控因子。一个用于配体激活转录的标准生物物理模型假设，启动子占有率以及因此产生的转录输出遵循希尔激活函数。设 Stra8 的输出是 RA 浓度的函数，由以下希尔形式给出\n$$\nS(c) \\;=\\; S_{\\max}\\,\\frac{c^{n}}{K^{n} + c^{n}},\n$$\n其中，$c$ 是 RA 浓度，$S_{\\max}$ 是可实现的最大 Stra8 输出，$n$ 是反映表观协同性的希尔系数，$K$ 是半激活浓度。假设 $c>0$，$K>0$ 且 $n>0$。\n\n仅使用此假设以及导数和对数的标准定义，完成以下任务：\n1) 推导当 Stra8 输出为半最大值时，即 $S(c_{1/2}) = \\tfrac{1}{2}S_{\\max}$ 时的 RA 浓度 $c_{1/2}$。\n2) 为了将希尔系数 $n$ 控制输入输出曲线陡峭程度这一直观概念形式化，定义半激活时归一化响应的局部对数敏感度为\n$$\n\\sigma \\;\\equiv\\; \\left.\\frac{d}{d\\ln c}\\left(\\frac{S(c)}{S_{\\max}}\\right)\\right|_{c=c_{1/2}}.\n$$\n用 $n$ 计算 $\\sigma$。\n\n将最终答案表示为包含 $(c_{1/2},\\,\\sigma)$ 的单个 $1\\times 2$ 行矩阵，其元素为用 $K$ 和 $n$ 表示的精确符号表达式。请勿代入数值，最终框内答案也不要包含单位。在需要时，您可以假设所有函数都是可微的。", "solution": "必须首先严格验证问题陈述。\n\n第1步：提取已知条件。\n问题为*Stra8*输出（记为 $S(c)$）提供了以下数学模型，该输出是维甲酸浓度 $c$ 的函数：\n$$ S(c) = S_{\\max}\\,\\frac{c^{n}}{K^{n} + c^{n}} $$\n参数定义如下：\n- $c$: RA 浓度，约束条件为 $c>0$。\n- $S_{\\max}$: 可实现的最大*Stra8*输出。\n- $n$: 希尔系数，约束条件为 $n>0$。\n- $K$: 半激活浓度，约束条件为 $K>0$。\n\n任务是：\n1. 推导满足条件 $S(c_{1/2}) = \\frac{1}{2}S_{\\max}$ 的浓度 $c_{1/2}$。\n2. 计算局部对数敏感度 $\\sigma$，其定义为：\n$$ \\sigma \\equiv \\left.\\frac{d}{d\\ln c}\\left(\\frac{S(c)}{S_{\\max}}\\right)\\right|_{c=c_{1/2}} $$\n最终答案将以 $1\\times 2$ 行矩阵 $(c_{1/2}, \\sigma)$ 的形式呈现。\n\n第2步：使用提取的已知条件进行验证。\n根据所需标准对问题进行评估。\n- **科学性**：问题有效。希尔方程是定量生物化学和药理学的基石，一个多世纪以来一直用于模拟剂量-反应关系和协同结合。如此处所述，它在转录调控中的应用是系统生物学和生物物理学中标准且成熟的做法。涉及维甲酸和*Stra8*在性腺发育中的生物学背景在事实上是正确的。\n- **适定性**：问题有效。它提出了一个明确定义的数学函数，并要求基于标准的数学运算（代数和微分学）推导两个特定量。所有参数和变量都已定义，且约束条件（$c>0$，$K>0$，$n>0$）确保了函数在目标域内具有良好的数学性质。可以获得唯一且有意义的解。\n- **客观性**：问题有效。其语言精确、数学化，没有任何主观性、模糊性或观点。\n\n结论：该问题在科学上是合理的，是适定的，也是客观的。它没有违反任何指定的无效标准。因此，该问题被认定为有效，我们将继续推导解答。\n\n按要求，解答的推导分为两部分。\n\n第1部分：半最大激活浓度 $c_{1/2}$ 的推导。\n我们需要找到浓度 $c_{1/2}$，在该浓度下输出 $S(c_{1/2})$ 恰好是最大输出 $S_{\\max}$ 的一半。条件是：\n$$ S(c_{1/2}) = \\frac{1}{2}S_{\\max} $$\n代入给定的 $S(c)$ 表达式：\n$$ S_{\\max}\\,\\frac{c_{1/2}^{n}}{K^{n} + c_{1/2}^{n}} = \\frac{1}{2}S_{\\max} $$\n假设 $S_{\\max}$ 代表一个非零的最大输出，我们可以在方程两边同时除以 $S_{\\max}$：\n$$ \\frac{c_{1/2}^{n}}{K^{n} + c_{1/2}^{n}} = \\frac{1}{2} $$\n现在我们求解这个关于 $c_{1/2}$ 的方程。交叉相乘得到：\n$$ 2 c_{1/2}^{n} = K^{n} + c_{1/2}^{n} $$\n从两边减去 $c_{1/2}^{n}$ 得到：\n$$ c_{1/2}^{n} = K^{n} $$\n鉴于 $c>0$ 且 $K>0$，我们可以对两边取 $n$ 次方根，其中 $n>0$。这给出了一个唯一的正实数解：\n$$ c_{1/2} = K $$\n这个结果证实了参数 $K$ 的定义，即达到一半最大响应所需的浓度。\n\n第2部分：局部对数敏感度 $\\sigma$ 的计算。\n对数敏感度 $\\sigma$ 定义为归一化响应对浓度自然对数的导数，并在半最大浓度点 $c_{1/2}$ 处取值。\n首先，我们定义归一化响应 $s(c)$：\n$$ s(c) = \\frac{S(c)}{S_{\\max}} = \\frac{c^{n}}{K^{n} + c^{n}} $$\n$\\sigma$ 的定义是：\n$$ \\sigma = \\left.\\frac{d s(c)}{d\\ln c}\\right|_{c=c_{1/2}} $$\n为了计算关于 $\\ln c$ 的导数，我们使用链式法则：\n$$ \\frac{d}{d\\ln c} = \\frac{dc}{d\\ln c} \\cdot \\frac{d}{dc} $$\n令 $x = \\ln c$。则 $c = \\exp(x)$，且 $\\frac{dc}{dx} = \\exp(x) = c$。因此，该算子等价于：\n$$ \\frac{d}{d\\ln c} = c \\frac{d}{dc} $$\n所以，我们必须计算 $\\sigma = \\left.c \\frac{ds(c)}{dc}\\right|_{c=c_{1/2}}$。\n我们首先使用商法则求导数 $\\frac{ds}{dc}$，其中 $u(c) = c^n$ 且 $v(c) = K^n + c^n$：\n\\begin{align*} \\frac{ds}{dc} &= \\frac{\\frac{d}{dc}(c^n) \\cdot (K^n + c^n) - c^n \\cdot \\frac{d}{dc}(K^n + c^n)}{(K^n + c^n)^2} \\\\ &= \\frac{(n c^{n-1})(K^n + c^n) - c^n (n c^{n-1})}{(K^n + c^n)^2} \\\\ &= \\frac{n c^{n-1}K^n + n c^{2n-1} - n c^{2n-1}}{(K^n + c^n)^2} \\\\ &= \\frac{n K^n c^{n-1}}{(K^n + c^n)^2} \\end{align*}\n现在，我们乘以 $c$ 得到对数导数：\n$$ c \\frac{ds}{dc} = c \\left( \\frac{n K^n c^{n-1}}{(K^n + c^n)^2} \\right) = \\frac{n K^n c^n}{(K^n + c^n)^2} $$\n最后，我们在 $c = c_{1/2} = K$ 处计算该表达式的值：\n$$ \\sigma = \\left. \\frac{n K^n c^n}{(K^n + c^n)^2} \\right|_{c=K} = \\frac{n K^n K^n}{(K^n + K^n)^2} $$\n$$ \\sigma = \\frac{n K^{2n}}{(2K^n)^2} = \\frac{n K^{2n}}{4(K^n)^2} = \\frac{n K^{2n}}{4K^{2n}} $$\n由于 $K>0$，所以 $K^{2n} \\neq 0$，因此我们可以约去分子和分母中的这一项：\n$$ \\sigma = \\frac{n}{4} $$\n这个结果表明，归一化响应在其半最大点的局部敏感度与希尔系数 $n$ 成正比，为 $n$ 作为响应陡峭程度（或称超敏性）的量度提供了定量意义。\n\n最终答案是序对 $(c_{1/2}, \\sigma)$。\n$$ c_{1/2} = K $$\n$$ \\sigma = \\frac{n}{4} $$", "answer": "$$ \\boxed{\\begin{pmatrix} K & \\frac{n}{4} \\end{pmatrix}} $$", "id": "2628625"}, {"introduction": "从单个基因的响应，我们进一步探究多个基因相互作用形成的调控网络。SOX9和β-catenin之间的相互抑制构成了一个“拨动开关” (toggle switch)，这是细胞做出不可逆命运决定的核心基序。本练习深入探讨了性别决定中这一核心开关的动力学原理，分析它是如何产生双稳态 (bistability)，并以此实现对瞬时信号波动的过滤。掌握这些特性对于理解发育过程的稳定性和鲁棒性至关重要。[@problem_id:2628685]", "problem": "在双潜能性腺中，睾丸和卵巢之间的命运选择由一个相互拮抗的基因调控开关所控制，该开关位于SRY盒转录因子$9$ (SOX$9$)和β-连环蛋白（Wingless/Integrated (WNT) 通路的下游效应子）之间。一个标准的生物物理描述使用希尔函数来模拟转录抑制，并用一阶衰减来模拟蛋白质周转。考虑以下无量纲化的对称相互抑制模型，其中一个瞬时SRY样输入$u(t)$直接驱动SOX$9$的合成：\n$$\n\\frac{d x}{d t} \\;=\\; \\frac{\\alpha}{1 + y^{h}} \\;-\\; x \\;+\\; u(t),\\qquad\n\\frac{d y}{d t} \\;=\\; \\frac{\\alpha}{1 + x^{h}} \\;-\\; y,\n$$\n其中，$x$表示SOX$9$，$y$表示β-连环蛋白，$\\alpha$是最大启动子强度（已按降解速率进行缩放），$h$是抑制作用的希尔系数（协同性）。在分析平衡点及其稳定性时，假设$u(t)=0$。该模型抓住了两个核心且被广泛使用的事实：转录抑制是S形的，其希尔指数$h\\geq 1$；蛋白质损失近似为一阶过程。\n\n任务：\n$1.$ 从这些方程出发，仅使用相平面几何和线性稳定性分析，论证为何在足够强的抑制和生成条件下，此开关中可以出现双稳态（及其带来的迟滞现象）。然后，通过分析对称平衡点 $x=y=s$ 并确定其稳定性丧失的临界点，推导出一个显式闭式表达式 $\\alpha_{c}(h)$，该表达式给出产生双稳态的叉式分岔发生时的临界生成强度。将 $\\alpha_{c}$ 表示为仅关于 $h$ 的函数。\n$2.$ 利用双稳态的几何结构，解释迟滞现象如何过滤瞬时波动：具体来说，论证为何一个持续时间为$T$的短时有限振幅输入$u(t)$，如果它没有使系统状态跨越分界线，就不能诱导永久性的命运转换；而将状态推过不稳定鞍点的输入却可以。在你的论证中可以引用零斜线、不动点和分界线，但无需计算$T$。\n\n请提供在任务1中得到的闭式表达式 $\\alpha_{c}(h)$ 作为最终答案。无需进行数值计算，也无需为 $\\alpha$ 标注单位，因为该系统是无量纲的。", "solution": "该问题陈述是应用于基因拨动开关典型模型的非线性动力学和分岔理论中的一个有效练习。它具有科学依据，在数学上是良定的，并包含了解决该问题所需的所有信息。下面将进行分析。\n\n描述SOX$9$ ($x$)和β-连环蛋白 ($y$)动力学的方程组如下：\n$$\n\\frac{d x}{d t} \\;=\\; \\frac{\\alpha}{1 + y^{h}} \\;-\\; x \\;+\\; u(t)\n$$\n$$\n\\frac{d y}{d t} \\;=\\; \\frac{\\alpha}{1 + x^{h}} \\;-\\; y\n$$\n为分析平衡点（任务1），我们设外部输入 $u(t) = 0$。系统变为：\n$$\n\\frac{d x}{d t} \\;=\\; f(x,y) \\;=\\; \\frac{\\alpha}{1 + y^{h}} \\;-\\; x\n$$\n$$\n\\frac{d y}{d t} \\;=\\; g(x,y) \\;=\\; \\frac{\\alpha}{1 + x^{h}} \\;-\\; y\n$$\n\n任务1：双稳态的论证及 $\\alpha_{c}(h)$ 的推导\n\n为了分析该系统，我们首先确定零斜线，即相平面上导数之一为零的曲线。\n$x$-零斜线由 $\\frac{dx}{dt} = 0$ 定义，得出方程：\n$$\nx = \\frac{\\alpha}{1 + y^{h}}\n$$\n$y$-零斜线由 $\\frac{dy}{dt} = 0$ 定义，得出方程：\n$$\ny = \\frac{\\alpha}{1 + x^{h}}\n$$\n系统的不动点是这两条零斜线的交点。$y$-零斜线是一条S形曲线，从 $x=0$ 处的 $y=\\alpha$ 递减到当 $x \\to \\infty$ 时的 $y \\to 0$。$x$-零斜线具有相同的形状，但关于直线 $y=x$ 对称。\n\n由于方程的对称性，直线上 $x=y$ 总是至少存在一个不动点。设此对称平衡点为 $(s, s)$。将 $x=y=s$ 代入零斜线方程可得：\n$$\ns = \\frac{\\alpha}{1 + s^{h}}\n$$\n双稳态要求存在三个不动点。在几何上，这发生在零斜线相交三次时。这种情况的发生条件是，在对称不动点 $(s,s)$ 处，$y$-零斜线的斜率 $\\frac{dy}{dx}$ 足够陡峭。具体来说，出现多个交点的条件是在 $x=s$ 处 $y$-零斜线的斜率绝对值必须大于1。如果 $|\\frac{dy}{dx}|_{x=s} > 1$，则零斜线必定在对称点的两侧再次相交。两个外部不动点将是稳定的，而中间的则是一个不稳定的鞍点，从而形成两个吸引盆。这就是双稳态和迟滞现象的几何起源。\n\n双稳态的出现发生于中心对称平衡点失去其稳定性之时。这对应于一个叉式分岔。我们分析对称平衡点 $(s,s)$ 的线性稳定性。系统的雅可比矩阵 $J$ 为：\n$$\nJ(x,y) = \\begin{pmatrix} \\frac{\\partial f}{\\partial x} & \\frac{\\partial f}{\\partial y} \\\\ \\frac{\\partial g}{\\partial x} & \\frac{\\partial g}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} -1 & -\\frac{\\alpha h y^{h-1}}{(1+y^{h})^2} \\\\ -\\frac{\\alpha h x^{h-1}}{(1+x^{h})^2} & -1 \\end{pmatrix}\n$$\n在对称不动点 $(s, s)$ 处计算雅可比矩阵：\n$$\nJ(s,s) = \\begin{pmatrix} -1 & -\\frac{\\alpha h s^{h-1}}{(1+s^{h})^2} \\\\ -\\frac{\\alpha h s^{h-1}}{(1+s^{h})^2} & -1 \\end{pmatrix}\n$$\n我们定义非对角项为 $k = -\\frac{\\alpha h s^{h-1}}{(1+s^{h})^2}$。雅可比矩阵变为 $J(s,s) = \\begin{pmatrix} -1 & k \\\\ k & -1 \\end{pmatrix}$。\n特征值 $\\lambda$ 可通过特征方程 $\\det(J - \\lambda I) = 0$ 求得：\n$$\n(-1 - \\lambda)^2 - k^2 = 0 \\implies -1 - \\lambda = \\pm k \\implies \\lambda = -1 \\pm k\n$$\n特征值为 $\\lambda_{1} = -1 - |k|$ 和 $\\lambda_{2} = -1 + |k|$。\n注意 $|k| = \\frac{\\alpha h s^{h-1}}{(1+s^{h})^2} \\ge 0$。\n特征值 $\\lambda_{1}$ 始终为负。因此，平衡点的稳定性由 $\\lambda_{2}$ 决定。如果 $\\lambda_{2} < 0$，即 $|k| < 1$，则不动点是稳定的。当 $\\lambda_{2}$ 穿过零时，即 $\\lambda_2 = 0$时，不动点失去稳定性。这个分岔恰好在 $|k|=1$ 时发生。\n\n产生双稳态的叉式分岔发生在临界生成强度 $\\alpha_{c}$ 处，此时以下两个条件同时满足：\n$1$. 点 $(s,s)$ 是一个平衡点：$s = \\frac{\\alpha_{c}}{1 + s^{h}}$\n$2$. 满足分岔条件：$|k| = 1 \\implies \\frac{\\alpha_{c} h s^{h-1}}{(1+s^{h})^2} = 1$\n\n我们现在必须求解这两个方程组成的方程组，以用 $h$ 表示 $\\alpha_c$。\n根据条件1，我们可以写出 $\\alpha_{c} = s(1+s^{h})$。将此代入条件2：\n$$\n\\frac{s(1+s^{h}) h s^{h-1}}{(1+s^{h})^2} = 1\n$$\n$$\n\\frac{h s^{h}}{1+s^{h}} = 1\n$$\n$$\nh s^{h} = 1 + s^{h}\n$$\n$$\n(h-1)s^{h} = 1\n$$\n这得到 $s^{h} = \\frac{1}{h-1}$。为使 $s$ 有实数正解，必须有 $h>1$，这与类开关响应需要协同性的要求是一致的。\n由此，我们得到 $s = \\left(\\frac{1}{h-1}\\right)^{\\frac{1}{h}} = (h-1)^{-\\frac{1}{h}}$。\n\n现在，我们将其代回 $\\alpha_{c}$ 的表达式中：\n$$\n\\alpha_{c} = s(1+s^{h}) = (h-1)^{-\\frac{1}{h}} \\left(1 + \\frac{1}{h-1}\\right)\n$$\n$$\n\\alpha_{c} = (h-1)^{-\\frac{1}{h}} \\left(\\frac{h-1+1}{h-1}\\right)\n$$\n$$\n\\alpha_{c} = (h-1)^{-\\frac{1}{h}} \\left(\\frac{h}{h-1}\\right)\n$$\n$$\n\\alpha_{c} = h \\cdot (h-1)^{-1} \\cdot (h-1)^{-\\frac{1}{h}} = h (h-1)^{-(1+\\frac{1}{h})}\n$$\n$$\n\\alpha_{c}(h) = h (h-1)^{-\\frac{h+1}{h}}\n$$\n这就是临界生成强度的闭式表达式。\n\n任务2：迟滞现象与波动过滤\n\n当 $\\alpha > \\alpha_{c}(h)$ 时，系统是双稳态的。相平面包含三个不动点：两个稳定不动点（节点或焦点）和中心的一个不稳定鞍点。稳定不动点代表已决定的细胞命运：一个是高 $x$ (SOX$9$) 和低 $y$ (β-连环蛋白)，对应于睾丸命运；另一个是低 $x$ 和高 $y$，对应于卵巢命运。\n\n相空间被划分为两个吸引盆。这些吸引盆之间的边界是一条被称为分界线的曲线，它是鞍点上的稳定流形。从分界线一侧开始的轨迹将收敛到一个稳定不动点，而从另一侧开始的轨迹将收敛到另一个稳定不动点。\n\n这种结构解释了系统如何过滤瞬时波动。假设系统处于“卵巢”稳定状态（低 $x$，高 $y$）。一个持续时间为 $T$ 的瞬时输入 $u(t)$ 作为一个扰动，驱动 $x$ 的增加。这将系统状态 $(x(t), y(t))$ 推离其初始平衡点。\n\n如果扰动很小（在振幅或持续时间 $T$ 上），状态轨迹会被移动，但仍会保持在初始的吸引盆内。当输入 $u(t)$ 在时间 $t=T$ 停止时，状态 $(x(T), y(T))$ 并未穿过分界线。然后，系统的动力学将使状态弛豫回原始的“卵巢”稳定不动点。在这种情况下，瞬时信号被过滤掉，细胞命运没有发生永久性改变。\n\n然而，如果输入 $u(t)$ 足够强或持续时间足够长，它可以将系统状态推过分界线，进入“睾丸”状态的吸引盆。在脉冲于时间 $t=T$ 结束的瞬间，状态 $(x(T), y(T))$ 已经处于另一个吸引盆中。系统的内在动力学将引导轨迹不再回到原始状态，而是前进到另一个稳定不动点（高 $x$，低 $y$）。这导致了细胞命运的永久性、不可逆的转换。\n\n因此，分界线起到了一个临界阈值的作用。双稳态的几何结构通过忽略亚阈值的噪声和波动，同时对超阈值信号做出决定性响应，从而提供了鲁棒性。系统的最终状态取决于其经历的大扰动历史，这一特性就是迟滞现象的定义。", "answer": "$$\n\\boxed{h (h-1)^{-\\frac{h+1}{h}}}\n$$", "id": "2628685"}, {"introduction": "最后，我们将视角从单个细胞的决策提升到整个组织的尺度。在发育中的器官里，细胞的命运决定必须在空间上得到协调。本计算练习模拟了一个关键现象：即使在主要的性别决定信号 (SRY) 呈嵌合表达的情况下，细胞群落如何通过局部通讯，实现协同分化，形成统一的组织。这个练习不仅揭示了重要的“群落效应” (community effect)，还提供了基于格点模型进行模拟的实践经验，这是发育系统生物学中的一种强大技术。[@problem_id:2628681]", "problem": "您的任务是为Y染色体性别决定区（Sex-determining Region Y, SRY）呈镶嵌型表达的胚胎生殖嵴中，支持细胞（Sertoli cell）分化的协同作用进行建模。您需要构建一个一维周期性晶格模型，其中每个位点代表一个前支持细胞（pre-Sertoli cell）。晶格索引为 $i$ 的细胞具有一个无量纲的连续分化状态 $s_i(t) \\in [0,1]$，其中 $s_i(t) \\approx 1$ 表示成熟的支持细胞样状态，而 $s_i(t) \\approx 0$ 表示未分化状态。SRY启动子的镶嵌性由一个固定的、无量纲的场 $r_i \\in \\{0,1\\}$ 表示，其中 $r_i = 1$ 表示细胞内在的SRY表达，而 $r_i = 0$ 表示无表达。您将提出并实现一个空间耦合机制，以捕捉通过旁分泌信号传导实现的局部协同作用。\n\n基本原理：\n- 在发育生物学中，细胞分化由基因调控输入驱动，这些输入通常表现出S型（sigmoidal）的输入-输出关系，可以用希尔函数（Hill function）来描述。我们将对输入 $u \\ge 0$ 使用希尔激活函数 $H(u) = \\dfrac{u^n}{K^n + u^n}$，其中 $n$ 是希尔系数，$K$ 是半激活常数。\n- 来自已分化细胞的旁分泌信号会在局部累积并扩散到短距离范围；在比分子扩散和降解更长的时间尺度上，该信号场可以近似为与源的局部空间平均值成正比。在晶格上，最简单的闭合近似是将细胞感受到的旁分泌信号近似为有限半径内其邻近细胞分化状态的平均值。\n\n耦合机制与模型方程：\n- 设位点 $i$ 处感受到的旁分泌信号为周期性晶格上半径为 $R$ 的对称邻域内的邻居平均值 $A_i(t)$，定义为\n$$\nA_i(t) = \\frac{1}{2R} \\sum_{j=1}^{R} \\left( s_{i-j}(t) + s_{i+j}(t) \\right),\n$$\n所有索引均对 $N$ 取模。\n- 设有效分化输入为\n$$\nu_i(t) = r_i + \\eta \\, A_i(t),\n$$\n其中 $\\eta \\ge 0$ 是耦合强度，它将旁分泌信号映射到调控输入域上。$s_i(t)$ 的动力学被视为一个由激活输入驱动、并与衰减相抗衡的类逻辑斯谛松弛过程：\n$$\n\\frac{ds_i}{dt} = k_{\\mathrm{on}} \\, H\\!\\left(u_i(t)\\right) \\, \\left(1 - s_i(t)\\right) - k_{\\mathrm{off}} \\, s_i(t),\n$$\n其中 $k_{\\mathrm{on}} > 0$ 和 $k_{\\mathrm{off}} > 0$ 是速率常数。在此模型中，所有量都是无量纲的。\n\n模拟方案：\n- 晶格大小：$N$ 个位点，周期性边界条件。\n- 初始条件：对于所有 $i$，$s_i(0) = 0$。\n- 时间离散化：使用显式欧拉法，时间步长为 $\\Delta t$，总模拟时间为 $T$。每一步之后，您可以将 $s_i(t)$ 的值限制在区间 $[0,1]$ 内，以维持其物理边界。\n- 分化判读：定义一个阈值 $s_{\\mathrm{th}}$；如果 $s_i(T) \\ge s_{\\mathrm{th}}$，则认为该位点已分化。\n\nSRY镶嵌模式：\n- 通过一个模运算规则定义 $r_i$：对于整数 $m \\ge 1$ 和子集 $S \\subset \\{0,1,\\dots,m-1\\}$，\n$$\nr_i = \\begin{cases}\n1, & \\text{if } (i \\bmod m) \\in S,\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n\n除非另有说明，全程使用以下参数值：\n- 希尔参数：$n = 3$, $K = 0.5$。\n- 动力学参数：$k_{\\mathrm{on}} = 2.0$, $k_{\\mathrm{off}} = 0.1$。\n- 数值积分：$\\Delta t = 0.01$, $T = 20.0$。\n- 分化阈值：$s_{\\mathrm{th}} = 0.8$。\n\n任务：\n- 实现上述模型，并计算下述每个测试用例在时间 $T$ 的分化细胞比例 $\\phi$，其定义为\n$$\n\\phi = \\frac{1}{N} \\sum_{i=0}^{N-1} \\mathbf{1}\\{ s_i(T) \\ge s_{\\mathrm{th}} \\},\n$$\n其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。\n\n测试套件：\n- 情况1（无耦合基线）：\n  - $N = 60$, $m = 5$, $S = \\{0\\}$, $\\eta = 0.0$, $R = 1$。\n- 情况2（最近邻耦合，中等强度）：\n  - $N = 60$, $m = 5$, $S = \\{0\\}$, $\\eta = 0.7$, $R = 1$。\n- 情况3（更宽耦合，强强度）：\n  - $N = 60$, $m = 5$, $S = \\{0\\}$, $\\eta = 1.5$, $R = 2$。\n- 情况4（更稀疏的镶嵌，更宽耦合）：\n  - $N = 60$, $m = 10$, $S = \\{0\\}$, $\\eta = 1.5$, $R = 3$。\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含按上述情况顺序排列的四个结果，形式为用方括号括起来的逗号分隔列表，并四舍五入到三位小数（例如，如果比例为 $0.2$ 和 $1.0$，则输出将包含 $0.200$ 和 $1.000$）。输出格式必须严格如下：\n$$\n[\\phi_1,\\phi_2,\\phi_3,\\phi_4].\n$$\n不应打印任何额外文本。所有量均为无量纲；不需要物理单位。未使用角度。百分比必须按上述规定以小数形式表示。", "solution": "用户提供了一个有效的问题陈述。该问题具有科学依据，提法明确，并指定了所有必要的参数和条件。它要求实现一个在一维周期性晶格上耦合常微分方程组的数值模拟，用以模拟细胞分化。该问题是数学生物学中的一个标准计算任务。我现在将着手解决。\n\n该解决方案涉及模拟周期性晶格上 $N$ 个细胞系统中分化状态 $s_i(t)$ 的时间演化。每个细胞 $i$ 的动力学由以下微分方程控制：\n$$\n\\frac{ds_i}{dt} = k_{\\mathrm{on}} \\, H\\!\\left(u_i(t)\\right) \\, \\left(1 - s_i(t)\\right) - k_{\\mathrm{off}} \\, s_i(t)\n$$\n其中，输入 $u_i(t) = r_i + \\eta A_i(t)$ 取决于一个固定的内在SRY表达模式 $r_i$ 和来自邻近细胞的旁分泌信号 $A_i(t)$。该模拟将使用显式欧拉法进行数值积分。\n\n总体算法如下：\n1.  为每个测试用例初始化系统。这包括设置大小为 $N$ 的晶格、SRY表达模式 $r$ 以及初始分化状态 $s(0)$。\n2.  在时间区间 $[0, T]$ 上以时间步长 $\\Delta t$ 执行数值积分。\n3.  在每个时间步长中，为所有细胞计算常微分方程组中依赖于状态的项（即 $A_i(t)$，以及随后的 $u_i(t)$ 和 $H(u_i(t))$）。\n4.  使用欧拉公式更新状态向量 $s(t)$。\n5.  在最后一个时间步长之后，根据最终状态 $s(T)$ 计算分化细胞的比例 $\\phi$。\n\n下面提供了实现的分步描述。\n\n**1. 系统初始化**\n\n对于每个测试用例，我们定义参数：晶格大小 $N$、镶嵌周期性 $m$、SRY阳性索引子集 $S$、耦合强度 $\\eta$ 和邻域半径 $R$。\n-   SRY表达模式由长度为 $N$ 的向量 $r$ 表示。我们将 $r$ 初始化为全零。然后，我们遍历从 $0$ 到 $N-1$ 的每个位点索引 $i$，如果 $(i \\pmod m) \\in S$，则设置 $r_i = 1$。\n-   分化状态是长度为 $N$ 的向量 $s$。根据初始条件 $s_i(0)=0$，此向量被初始化为全零。\n-   常数参数固定为 $n=3$，$K=0.5$，$k_{\\mathrm{on}}=2.0$，$k_{\\mathrm{off}}=0.1$，$\\Delta t=0.01$，$T=20.0$ 和 $s_{\\mathrm{th}}=0.8$。\n\n**2. 数值积分循环**\n\n时间演化过程模拟的总步数等于 $T / \\Delta t$。我们使用 `NumPy` 对状态数组 $s$ 进行高效的向量化操作。循环过程如下：\n\n-   **计算邻居平均值 $A(t)$**：旁分泌信号 $A_i(t)$ 是位点 $i$ 的 $2R$ 个邻居的平均状态。\n    $$\n    A_i(t) = \\frac{1}{2R} \\sum_{j=1}^{R} \\left( s_{i-j}(t) + s_{i+j}(t) \\right)\n    $$\n    其中索引对 $N$ 取模。此操作可为整个晶格高效实现。一个初始化为零的辅助数组用于累加所有邻居的状态。对于从 $1$ 到 $R$ 的每个 $j$，我们将 `np.roll(s, j)` 和 `np.roll(s, -j)` 添加到累加器中。`np.roll` 函数能正确处理周期性边界条件：`np.roll(s, j)`有效地提供了 $s_{i-j}$ 值的向量。循环结束后，累加的总和除以 $2R$ 得到最终的平均值数组 $A(t)$。\n\n-   **计算有效输入 $u(t)$**：分化机制的总输入为 $u_i(t) = r_i + \\eta A_i(t)$。这通过单个向量化操作计算：$u = r + \\eta A$。\n\n-   **计算时间导数**：计算常微分方程组的右侧，即 $\\frac{ds}{dt}$。这涉及到将希尔函数 $H(u) = \\frac{u^n}{K^n + u^n}$ 应用于输入向量 $u$，然后为所有位点计算完整表达式：\n    $$\n    \\frac{ds}{dt} = k_{\\mathrm{on}} \\cdot H(u) \\odot (1 - s) - k_{\\mathrm{off}} \\cdot s\n    $$\n    其中 $\\odot$ 表示逐元素乘法。\n\n-   **欧拉更新**：使用显式欧拉公式更新状态向量：\n    $$\n    s(t + \\Delta t) = s(t) + \\frac{ds}{dt} \\Delta t\n    $$\n\n-   **状态限制**：为确保状态变量 $s_i$ 保持在其物理边界 $[0,1]$ 内，我们在每个更新步骤后应用限制操作：$s_i \\leftarrow \\max(0, \\min(1, s_i))$。这是通过使用 `np.clip(s, 0, 1)` 完成的。\n\n**3. 最终判读**\n\n在模拟循环于时间 $T$ 完成后，获得最终状态向量 $s(T)$。分化细胞的比例 $\\phi$ 按如下方式计算：\n$$\n\\phi = \\frac{1}{N} \\sum_{i=0}^{N-1} \\mathbf{1}\\{ s_i(T) \\ge s_{\\mathrm{th}} \\}\n$$\n其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。在实现中，这通过从条件 $s \\ge s_{\\mathrm{th}}$ 创建一个布尔数组，然后计算其平均值来实现，该平均值即为所需比例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the 1D lattice model for Sertoli cell differentiation\n    and computes the fraction of differentiated cells for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, m, S, eta, R)\n        (60, 5, {0}, 0.0, 1),  # Case 1\n        (60, 5, {0}, 0.7, 1),  # Case 2\n        (60, 5, {0}, 1.5, 2),  # Case 3\n        (60, 10, {0}, 1.5, 3), # Case 4\n    ]\n\n    # Global parameter values\n    n = 3.0\n    K = 0.5\n    k_on = 2.0\n    k_off = 0.1\n    dt = 0.01\n    T = 20.0\n    s_th = 0.8\n\n    results = []\n\n    def hill_activation(u, n_h, K_h):\n        \"\"\"Vectorized Hill activation function.\"\"\"\n        u_pow_n = np.power(u, n_h)\n        return u_pow_n / (np.power(K_h, n_h) + u_pow_n)\n\n    for N, m, S, eta, R in test_cases:\n        # 1. Initialize SRY pattern `r`\n        r = np.zeros(N, dtype=float)\n        for i in range(N):\n            if (i % m) in S:\n                r[i] = 1.0\n\n        # 2. Initialize state vector `s`\n        s = np.zeros(N, dtype=float)\n\n        # 3. Time evolution loop\n        num_steps = int(T / dt)\n        for _ in range(num_steps):\n            # Calculate neighbor average `A`\n            if R > 0:\n                A_sum = np.zeros(N, dtype=float)\n                for j in range(1, R + 1):\n                    # np.roll handles periodic boundary conditions\n                    A_sum += np.roll(s, j) + np.roll(s, -j)\n                A = A_sum / (2.0 * R)\n            else:\n                A = np.zeros(N, dtype=float)\n            \n            # Calculate effective input `u`\n            u = r + eta * A\n            \n            # Calculate time derivative `ds/dt`\n            H_u = hill_activation(u, n, K)\n            ds_dt = k_on * H_u * (1.0 - s) - k_off * s\n            \n            # Update state `s` using explicit Euler method\n            s += ds_dt * dt\n            \n            # Clamp state to the interval [0, 1]\n            np.clip(s, 0.0, 1.0, out=s)\n\n        # 4. Compute final fraction of differentiated cells\n        differentiated_mask = s >= s_th\n        phi = np.mean(differentiated_mask)\n        results.append(phi)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2628681"}]}