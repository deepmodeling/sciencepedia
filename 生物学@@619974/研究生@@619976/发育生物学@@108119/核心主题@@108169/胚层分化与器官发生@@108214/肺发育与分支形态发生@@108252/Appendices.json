{"hands_on_practices": [{"introduction": "形态发生素梯度是发育中组织内细胞获取位置信息的关键机制。成纤维细胞生长因子10（$FGF10$）是肺部发育中的一种关键形态发生素，其浓度梯度指导着上皮芽的分支。本练习旨在通过反应-扩散模型，模拟一个点源分泌的 $FGF10$ 如何在组织中形成一个稳态浓度梯度。完成这项练习将使你掌握将生物学情景转化为数学模型并求解的核心技能，从而定量地理解信号分子如何塑造其周围的组织环境。[@problem_id:2648848]", "problem": "由局部间充质细胞簇产生的成纤维细胞生长因子$10$ (FGF$10$) 在肺部发育过程中引导上皮分支。考虑一个无界、均匀、各向同性的间充质组织，FGF$10$在其中扩散，并通过一个集总为线性衰减项的一级过程被移除。假设处于稳态状态，平流可忽略不计，且在原点有一个以恒定速率分泌FGF$10$的单个点源。设 $c(\\mathbf{r})$ 表示FGF$10$浓度场，$D$ 为扩散系数，$k$ 为线性衰减率，$Q$ 为源分泌速率（分子数/单位时间）。使用关于源的球对称性和标准的守恒原理。\n\n- 基本依据：稳态下的质量守恒、菲克扩散和线性衰减。\n- 控制稳态平衡：扩散、线性衰减以及由狄拉克δ分布表示的点源。\n\n任务：\n1) 从质量守恒和带线性衰减的菲克扩散出发，建立带有位于原点的强度为$Q$的点源时$c(\\mathbf{r})$的稳态方程，并求解$r>0$时的球对称解$c(r)$。根据物理边界条件（当$r \\to \\infty$时$c(r) \\to 0$）和原点处点源的正确归一化来确定所有常数。\n\n2) 将梯度陡度定义为分数梯度的幅度，\n$$\ns(r) \\equiv \\frac{|\\nabla c(r)|}{c(r)} \\, ,\n$$\n并推导出$s(r)$的封闭形式解。然后使用参数值 $D = 50 \\ \\mu \\mathrm{m}^2 \\ \\mathrm{s}^{-1}$，$k = 5.0 \\times 10^{-4} \\ \\mathrm{s}^{-1}$，$Q = 2.0 \\times 10^{4} \\ \\text{molecules} \\ \\mathrm{s}^{-1}$，在指定距离 $r_0 = 300 \\ \\mu \\mathrm{m}$ 处计算 $s(r)$ 的值。如果有用，可以引入特征长度 $\\lambda \\equiv \\sqrt{D/k}$。\n\n以逆微米为单位，给出$s(r_0)$的数值作为最终报告量。将答案四舍五入到三位有效数字。在最终的方框答案中不要包含单位；仅在解题过程中以 $\\mu \\mathrm{m}^{-1}$ 为单位表示$s(r_0)$。", "solution": "在尝试任何解答之前，将对问题进行验证。\n\n### 第1步：提取已知条件\n- 成纤维细胞生长因子$10$ (FGF$10$)的浓度场由$c(\\mathbf{r})$表示。\n- 介质是无界、均匀、各向同性的间充质组织。\n- 过程处于稳态，平流可忽略不计。\n- 扩散系数为$D$。\n- 一级衰减率为$k$。\n- 位于原点的单个点源以恒定速率$Q$分泌FGF$10$。\n- 控制物理原理是质量守恒、菲克扩散和线性衰减。\n- 控制方程包含用于点源的狄拉克δ分布。\n- 寻求$r>0$时的球对称解$c(r)$。\n- 边界条件：当$r \\to \\infty$时，$c(r) \\to 0$，以及原点处点源的正确归一化。\n- 梯度陡度定义为$s(r) \\equiv \\frac{|\\nabla c(r)|}{c(r)}$。\n- 特征长度可定义为$\\lambda \\equiv \\sqrt{D/k}$。\n- 任务2的参数值：$D = 50 \\ \\mu \\mathrm{m}^2 \\ \\mathrm{s}^{-1}$，$k = 5.0 \\times 10^{-4} \\ \\mathrm{s}^{-1}$，$Q = 2.0 \\times 10^{4} \\ \\text{molecules} \\ \\mathrm{s}^{-1}$，以及计算距离 $r_0 = 300 \\ \\mu \\mathrm{m}$。\n\n### 第2步：使用提取的已知条件进行验证\n对问题进行严格审查。\n- **科学依据**：该问题描述了一个典型的反应-扩散系统，这是生物物理学和发育生物学中用于描述形态发生素梯度形成的标准化成熟模型。使用菲克定律进行扩散，一级动力学进行衰减，以及点源表示法，是一种基本且正确的方法。该问题牢固地建立在物理化学和连续介质力学的原理之上。\n- **适定性**：该问题是适定的。它提供了一个线性偏微分方程，其源项和边界条件（在无穷远处$c \\to 0$）定义明确，保证了唯一、稳定解的存在。\n- **客观性**：该问题以精确、客观的语言陈述，没有任何主观性或模糊性。\n- **完整性**：推导解答所需的所有必要信息，包括控制物理原理、参数和边界条件，均已提供。参数以一致的单位给出。\n\n### 第3步：结论与行动\n该问题在科学上是严谨的、适定的且完整的。它是一个应用于生物学的有效的数学物理问题。因此，将提供解答。\n\n### 解题推导\n\n**1) 控制方程的建立与求解**\n\n对于浓度为$c(\\mathbf{r}, t)$的物质，其质量守恒由连续性方程表示：\n$$\n\\frac{\\partial c}{\\partial t} + \\nabla \\cdot \\mathbf{J} = S\n$$\n其中$\\mathbf{J}$是通量矢量，$S$是单位体积的净源率。\n通量由菲克第一扩散定律给出，$\\mathbf{J} = -D \\nabla c$，其中$D$是扩散系数。源项$S$包括由$Q\\delta(\\mathbf{r})$表示的原点处的点源分泌和线性衰减$-kc$。\n将这些代入均匀介质（$D$为常数）的连续性方程，得到反应-扩散方程：\n$$\n\\frac{\\partial c}{\\partial t} = D \\nabla^2 c - kc + Q\\delta(\\mathbf{r})\n$$\n在稳态下，$\\frac{\\partial c}{\\partial t} = 0$，因此控制方程变为：\n$$\nD \\nabla^2 c - kc + Q\\delta(\\mathbf{r}) = 0\n$$\n对于$r = |\\mathbf{r}| > 0$，狄拉克δ项消失，我们必须求解齐次方程：\n$$\n\\nabla^2 c - \\frac{k}{D} c = 0\n$$\n我们假设一个球对称解，$c(\\mathbf{r}) = c(r)$。在球坐标系中，拉普拉斯算子为$\\nabla^2 c(r) = \\frac{1}{r^2} \\frac{d}{dr}\\left(r^2 \\frac{dc}{dr}\\right)$。引入特征长度$\\lambda = \\sqrt{D/k}$，方程变为：\n$$\n\\frac{1}{r^2} \\frac{d}{dr}\\left(r^2 \\frac{dc}{dr}\\right) - \\frac{1}{\\lambda^2} c = 0\n$$\n为了求解这个常微分方程，我们进行替换$u(r) = r c(r)$。这将方程转化为一个更简单的形式：\n$$\n\\frac{d^2u}{dr^2} - \\frac{1}{\\lambda^2} u = 0\n$$\n$u(r)$的通解是：\n$$\nu(r) = C_1 \\exp(-r/\\lambda) + C_2 \\exp(r/\\lambda)\n$$\n其中$C_1$和$C_2$是积分常数。因此$c(r)$的解是：\n$$\nc(r) = \\frac{u(r)}{r} = \\frac{C_1}{r} \\exp(-r/\\lambda) + \\frac{C_2}{r} \\exp(r/\\lambda)\n$$\n我们应用边界条件，即浓度在无穷远处必须为零：当$r \\to \\infty$时，$c(r) \\to 0$。项$\\exp(r/\\lambda)/r$在$r \\to \\infty$时发散，因此其系数必须为零。这要求$C_2 = 0$。因此解的形式为：\n$$\nc(r) = \\frac{C_1}{r} \\exp(-r/\\lambda)\n$$\n为了确定常数$C_1$，我们将完整的非齐次方程$D \\nabla^2 c - kc = -Q\\delta(\\mathbf{r})$在一个以原点为中心、半径为$\\epsilon$的小球体体积$V_\\epsilon$上积分：\n$$\n\\int_{V_\\epsilon} (D \\nabla^2 c - k c) dV = \\int_{V_\\epsilon} -Q\\delta(\\mathbf{r}) dV = -Q\n$$\n对第一项使用散度定理，我们得到：\n$$\nD \\oint_{\\partial V_\\epsilon} \\nabla c \\cdot d\\mathbf{A} - k \\int_{V_\\epsilon} c \\, dV = -Q\n$$\n梯度是$\\nabla c = \\frac{dc}{dr}\\hat{\\mathbf{r}}$。我们发现$\\frac{dc}{dr} = C_1 \\left( -\\frac{1}{r^2} - \\frac{1}{r\\lambda} \\right) \\exp(-r/\\lambda)$。在半径为$\\epsilon$的球面上的面积分是：\n$$\nD \\int_S \\frac{dc}{dr}\\Big|_{r=\\epsilon} dA = D \\cdot C_1 \\left( -\\frac{1}{\\epsilon^2} - \\frac{1}{\\epsilon\\lambda} \\right) \\exp(-\\epsilon/\\lambda) \\cdot 4\\pi\\epsilon^2 = -4\\pi D C_1 \\left(1 + \\frac{\\epsilon}{\\lambda}\\right)\\exp(-\\epsilon/\\lambda)\n$$\n在极限$\\epsilon \\to 0$下，此项变为$-4\\pi D C_1$。\n体积分是$\\int_{V_\\epsilon} c \\, dV = \\int_0^{\\epsilon} \\frac{C_1}{r} \\exp(-r/\\lambda) 4\\pi r^2 dr = 4\\pi C_1 \\int_0^{\\epsilon} r \\exp(-r/\\lambda) dr$。当$\\epsilon \\to 0$时，该积分趋于$0$。\n因此，积分后的方程简化为：\n$$\n-4\\pi D C_1 - 0 = -Q \\implies C_1 = \\frac{Q}{4\\pi D}\n$$\n因此，$r>0$时的球对称解为：\n$$\nc(r) = \\frac{Q}{4\\pi D r} \\exp\\left(-\\frac{r}{\\lambda}\\right)\n$$\n其中$\\lambda = \\sqrt{D/k}$。\n\n**2) 梯度陡度的计算**\n\n梯度陡度定义为$s(r) = \\frac{|\\nabla c(r)|}{c(r)}$。对于我们的球对称解，梯度是$\\nabla c = \\frac{dc}{dr}\\hat{\\mathbf{r}}$，其幅度为$|\\nabla c| = |\\frac{dc}{dr}|$。\n我们首先计算导数$\\frac{dc}{dr}$：\n$$\n\\frac{dc}{dr} = \\frac{Q}{4\\pi D} \\frac{d}{dr} \\left( \\frac{1}{r} \\exp(-r/\\lambda) \\right) = \\frac{Q}{4\\pi D} \\left( -\\frac{1}{r^2}\\exp(-r/\\lambda) - \\frac{1}{r\\lambda}\\exp(-r/\\lambda) \\right)\n$$\n$$\n\\frac{dc}{dr} = -\\frac{Q}{4\\pi D r} \\exp(-r/\\lambda) \\left( \\frac{1}{r} + \\frac{1}{\\lambda} \\right) = -c(r) \\left( \\frac{1}{r} + \\frac{1}{\\lambda} \\right)\n$$\n由于$r>0$且$\\lambda>0$，该导数恒为负，所以其幅度为$|\\frac{dc}{dr}| = c(r) \\left( \\frac{1}{r} + \\frac{1}{\\lambda} \\right)$。\n那么，陡度$s(r)$为：\n$$\ns(r) = \\frac{c(r) \\left( \\frac{1}{r} + \\frac{1}{\\lambda} \\right)}{c(r)} = \\frac{1}{r} + \\frac{1}{\\lambda}\n$$\n现在，我们使用给定的参数计算$s(r_0)$：$D = 50 \\ \\mu \\mathrm{m}^2 \\ \\mathrm{s}^{-1}$，$k = 5.0 \\times 10^{-4} \\ \\mathrm{s}^{-1}$，以及$r_0 = 300 \\ \\mu \\mathrm{m}$。\n首先，计算特征长度$\\lambda$：\n$$\n\\lambda = \\sqrt{\\frac{D}{k}} = \\sqrt{\\frac{50 \\ \\mu \\mathrm{m}^2 \\ \\mathrm{s}^{-1}}{5.0 \\times 10^{-4} \\ \\mathrm{s}^{-1}}} = \\sqrt{10 \\times 10^4 \\ \\mu \\mathrm{m}^2} = \\sqrt{10^5} \\ \\mu \\mathrm{m} = 100\\sqrt{10} \\ \\mu \\mathrm{m}\n$$\n现在，计算$s(r_0)$：\n$$\ns(r_0) = \\frac{1}{r_0} + \\frac{1}{\\lambda} = \\frac{1}{300 \\ \\mu \\mathrm{m}} + \\frac{1}{100\\sqrt{10} \\ \\mu \\mathrm{m}}\n$$\n数值计算各项：\n$$\n\\frac{1}{300} \\approx 0.0033333... \\ \\mu \\mathrm{m}^{-1}\n$$\n$$\n\\frac{1}{100\\sqrt{10}} \\approx \\frac{1}{100 \\times 3.162277...} \\approx \\frac{1}{316.2277...} \\approx 0.0031622... \\ \\mu \\mathrm{m}^{-1}\n$$\n将这些值相加：\n$$\ns(r_0) \\approx (0.0033333 + 0.0031622) \\ \\mu \\mathrm{m}^{-1} \\approx 0.0064955 \\ \\mu \\mathrm{m}^{-1}\n$$\n四舍五入到三位有效数字，我们得到$0.00650 \\ \\mu \\mathrm{m}^{-1}$。这可以用科学记数法表示为$6.50 \\times 10^{-3} \\ \\mu \\mathrm{m}^{-1}$。", "answer": "$$\n\\boxed{6.50 \\times 10^{-3}}\n$$", "id": "2648848"}, {"introduction": "在单个信号梯度的基础上，更复杂的生物学模式往往源于多个信号分子之间的相互作用，其中激活剂-抑制剂系统是形成周期性结构的核心模型。本练习将深入探讨图灵机制（Turing mechanism），这是一个解释生物系统如何自发组织形成斑图的强大理论，通过模拟激活剂 $FGF10$ 和抑制剂 $SHH$ 之间的调控网络来实现。通过这个高级计算实践，你将进行线性稳定性分析，以预测在何种条件下，原本均一的细胞群体能够自发地产生稳定且具有周期性的模式，例如新肺芽的间距。[@problem_id:2648843]", "problem": "考虑一个邻近上皮源的一维间充质场，其中上皮细胞产生的 Sonic hedgehog (SHH) 抑制间充质中的成纤维细胞生长因子10 (FGF10)。令 $F(x,t)$ 表示 FGF10 的浓度，$S(x,t)$ 表示 SHH 的浓度，它们是沿一维空间坐标 $x$ 和时间 $t$ 的函数。假设浓度、空间和时间均采用无量纲单位。以下耦合反应扩散系统体现了一个最小的激活剂-抑制剂反馈机制，该机制与肺分支形态发生中的经典观察结果一致：\n$$\n\\frac{\\partial F}{\\partial t} \\;=\\; D_F \\frac{\\partial^2 F}{\\partial x^2} \\;+\\; \\alpha_F \\left(1 + \\beta \\frac{F^p}{K_F^p + F^p}\\right)\\cdot \\frac{1}{1 + \\left(\\frac{S}{K_S}\\right)^n} \\;-\\; \\mu_F F,\n$$\n$$\n\\frac{\\partial S}{\\partial t} \\;=\\; D_S \\frac{\\partial^2 S}{\\partial x^2} \\;+\\; \\alpha_S \\frac{F^q}{K_{FS}^q + F^q} \\;-\\; \\mu_S S,\n$$\n其中 $D_F$ 和 $D_S$ 是扩散系数；$\\alpha_F$、$\\alpha_S$ 是最大产生速率；$\\beta$ 是 FGF10 自激活的强度；$\\mu_F$、$\\mu_S$ 是衰变率；$K_F$、$K_S$、$K_{FS}$ 是解离样常数；$p$、$n$、$q$ 是希尔指数。假设 $D_S \\gg D_F$ 捕捉了 SHH 相对于 FGF10 在间充质中更快扩散的特性，这与经验观察结果一致，并假设所有参数均为严格正实数。\n\n您的任务是基于第一性原理，实现一个严谨的线性稳定性分析，以确定是否存在扩散驱动的模式形成（即图灵型不稳定性），如果存在，则计算 FGF10 区域的预测主导间距。请遵循以下步骤，每一步都基于基本定律和经过充分检验的公式：\n\n1) 扩散项基于菲克扩散定律，即通量与负梯度成正比，在一维空间中得到拉普拉斯算子 $D \\frac{\\partial^2}{\\partial x^2}$。\n\n2) 反应项基于转录激活和抑制的标准希尔函数表示，这些表示源于质量作用结合平衡：激活使用递增的希尔函数 $\\frac{F^q}{K^q + F^q}$，抑制使用递减的希尔函数 $\\frac{1}{1 + (S/K)^n}$。\n\n3) 通过求解将时间导数设为零并移除扩散项后得到的空间均匀定常条件，来确定均匀稳态 $(F^\\ast, S^\\ast)$：\n$$\n0 \\;=\\; \\alpha_F \\left(1 + \\beta \\frac{(F^\\ast)^p}{K_F^p + (F^\\ast)^p}\\right)\\cdot \\frac{1}{1 + \\left(\\frac{S^\\ast}{K_S}\\right)^n} \\;-\\; \\mu_F F^\\ast,\n$$\n$$\n0 \\;=\\; \\alpha_S \\frac{(F^\\ast)^q}{K_{FS}^q + (F^\\ast)^q} \\;-\\; \\mu_S S^\\ast.\n$$\n\n4) 通过计算反应项的雅可比矩阵 $J$，将反应动力学在 $(F^\\ast, S^\\ast)$ 附近线性化。$J$ 是方程右侧关于 $F$ 和 $S$ 的偏导数在 $(F^\\ast, S^\\ast)$ 处求值所构成的矩阵。记作 $J = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$。\n\n5) 考虑形式为 $e^{\\sigma t} \\cos(kx)$ 的空间傅里叶模态，并通过对每个模态将拉普拉斯算子替换为 $-k^2$ 来推导色散关系，然后分析矩阵 $J - k^2 D$ 的特征值，其中 $D = \\mathrm{diag}(D_F, D_S)$ 且 $k \\ge 0$ 是空间波数。评估空间均匀稳态是否：\n- 反应稳定（无扩散）：$J$ 的所有特征值的实部均严格为负。\n- 扩散驱动不稳定（图灵不稳定性）：存在某个 $k^\\ast > 0$，使得 $J - k^{\\ast 2} D$ 的最大特征值实部严格为正。\n\n6) 如果存在扩散驱动的不稳定性，根据线性理论计算预测的主导间距（波长）为 $\\lambda^\\ast = \\frac{2\\pi}{k^\\ast}$，其中 $k^\\ast$ 使增长率 $\\Re(\\sigma(k))$ 最大化。如果根据上述定义不存在图灵不稳定性，则报告线性不稳定性分析未能产生稳定间距。\n\n数值和算法要求：\n- 使用无量纲单位进行计算。所有报告的间距必须以无量纲长度单位的浮点数形式给出。\n- 通过限制在非负浓度范围内进行数值求根来确定 $(F^\\ast, S^\\ast)$。\n- 通过计算 $J$ 的特征值来评估反应稳定性。\n- 通过在足够精细的非负波数范围内扫描 $k$，并计算每个 $k$ 对应的 $J - k^2 D$ 的特征值，来评估扩散驱动的不稳定性；识别最大增长率及其对应的 $k^\\ast$。\n- 如果均匀稳态不是反应稳定的，则判定在图灵机制下不允许出现扩散驱动的模式形成。\n- 如果反应稳定且在 $k > 0$ 范围内的最大增长率为非正数，则判定不存在扩散驱动的模式形成。\n- 如果反应稳定且在某个 $k^\\ast > 0$ 处的最大增长率为正，则报告 $\\lambda^\\ast = \\frac{2\\pi}{k^\\ast}$ 作为无量纲单位下的主导间距。\n\n测试套件：\n使用以下四个参数集（每个集合是单次运行的完整参数）。所有数值均为无量纲，必须严格按照所提供的值使用。\n\n- 案例A（抑制剂扩散快，强耦合；预期允许形成间距）：$D_F = 10^{-3}$, $D_S = 1$, $\\alpha_F = 2$, $\\beta = 8$, $\\mu_F = 1$, $\\alpha_S = 4$, $\\mu_S = 1$, $K_F = 1$, $K_S = 1$, $K_{FS} = 1$, $p = 2$, $n = 2$, $q = 2$。\n\n- 案例B（扩散系数相等；预期抑制间距形成）：$D_F = 1$, $D_S = 1$, $\\alpha_F = 2$, $\\beta = 8$, $\\mu_F = 1$, $\\alpha_S = 4$, $\\mu_S = 1$, $K_F = 1$, $K_S = 1$, $K_{FS} = 1$, $p = 2$, $n = 2$, $q = 2$。\n\n- 案例C（激活剂自激活弱；预期抑制间距形成）：$D_F = 10^{-3}$, $D_S = 1$, $\\alpha_F = 2$, $\\beta = 0$, $\\mu_F = 1$, $\\alpha_S = 4$, $\\mu_S = 1$, $K_F = 1$, $K_S = 1$, $K_{FS} = 1$, $p = 2$, $n = 2$, $q = 2$。\n\n- 案例D（近阈值区；边际耦合）：$D_F = 2 \\times 10^{-2}$, $D_S = 1$, $\\alpha_F = 2$, $\\beta = 4, \\mu_F = 1$, $\\alpha_S = 3$, $\\mu_S = 1$, $K_F = 1$, $K_S = 1$, $K_{FS} = 1$, $p = 2$, $n = 2$, $q = 2$。\n\n程序输入输出规范：\n- 您的程序必须将上述四个案例作为内部列表包含；不得读取任何外部输入。\n- 对于每个案例，如果存在扩散驱动的不稳定性，则计算主导间距 $\\lambda^\\ast$（以无量纲长度单位表示）；否则返回 $-1.0$。\n- 您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，\"[0.7853981633974483,-1.0,-1.0,1.2566370614359172]\"）。\n- 列表中的每个条目都必须是浮点数。\n\n目标是基于菲克定律和希尔函数生物化学，进行严谨的判定，确定 SHH 介导的对间充质 FGF10 的抑制是否能通过图灵型机制产生稳定的 FGF10 区域间距，并针对测试套件中的每个参数集报告以无量纲长度单位表示的预测间距。", "solution": "该问题要求对一个一维反应扩散系统进行线性稳定性分析。该系统描述了成纤维细胞生长因子10 ($F$) 和 Sonic hedgehog ($S$) 之间的相互作用，这两者是肺分支形态发生中的推定形态发生素。分析将确定在何种条件下会产生扩散驱动（图灵）不稳定性，并计算由此产生的模式的空间波长。验证问题陈述的有效性是关键的第一步。\n\n给定的是耦合偏微分方程：\n$$\n\\frac{\\partial F}{\\partial t} \\;=\\; D_F \\frac{\\partial^2 F}{\\partial x^2} \\;+\\; \\alpha_F \\left(1 + \\beta \\frac{F^p}{K_F^p + F^p}\\right)\\cdot \\frac{1}{1 + \\left(\\frac{S}{K_S}\\right)^n} \\;-\\; \\mu_F F\n$$\n$$\n\\frac{\\partial S}{\\partial t} \\;=\\; D_S \\frac{\\partial^2 S}{\\partial x^2} \\;+\\; \\alpha_S \\frac{F^q}{K_{FS}^q + F^q} \\;-\\; \\mu_S S\n$$\n参数（$D_F, D_S, \\alpha_F, \\alpha_S, \\beta, \\mu_F, \\mu_S, K_F, K_S, K_{FS}, p, n, q$）被定义为正实数。问题提供了四个特定的参数集（案例A、B、C、D）用于分析。\n\n该问题的提法是科学有效的。\n1.  **科学依据**：该模型基于菲克扩散定律，并使用 Michaelis-Menten / 希尔函数动力学来描述反应项，这些都是化学动力学和系统生物学中用于描述酶催化和转录调控的成熟标准形式。其激活剂-抑制剂结构（$F$ 激活自身和 $S$；$S$ 抑制 $F$）是生物模式形成的经典基序。整个图灵不稳定性框架是理论发育生物学的基石。\n2.  **适定性**：该问题是适定的。它提供了所有必要的方程、参数和一个清晰的、算法上明确定义的目标。对于给定的动力学，预期存在一个唯一的稳定稳态，其后的线性稳定性分析是一个标准的数学过程。\n3.  **客观性**：该问题以精确、量化和无偏见的数学语言陈述。\n\n该问题是有效的，我将遵循规定的步骤顺序进行求解。\n\n**步骤1：均匀稳态分析**\n\n通过将时间导数和扩散项设为零，可以找到空间均匀稳态 $(F^\\ast, S^\\ast)$。这导出了一个包含两个代数方程的系统：\n$$\n(1) \\quad 0 \\;=\\; f(F^\\ast, S^\\ast) = \\alpha_F \\left(1 + \\beta \\frac{(F^\\ast)^p}{K_F^p + (F^\\ast)^p}\\right)\\cdot \\frac{1}{1 + \\left(\\frac{S^\\ast}{K_S}\\right)^n} \\;-\\; \\mu_F F^\\ast\n$$\n$$\n(2) \\quad 0 \\;=\\; g(F^\\ast, S^\\ast) = \\alpha_S \\frac{(F^\\ast)^q}{K_{FS}^q + (F^\\ast)^q} \\;-\\; \\mu_S S^\\ast\n$$\n从方程 $(2)$ 中，我们可以将 $S^\\ast$ 表示为 $F^\\ast$ 的函数：\n$$\nS^\\ast(F^\\ast) = \\frac{\\alpha_S}{\\mu_S} \\frac{(F^\\ast)^q}{K_{FS}^q + (F^\\ast)^q}\n$$\n将此表达式代入方程 $(1)$，得到一个关于 $F^\\ast$ 的非线性方程。由于其复杂性，该方程必须通过数值方法求解。我们使用求根算法来找到 $F^\\ast \\ge 0$，然后计算相应的 $S^\\ast$。\n\n**步骤2：线性化与雅可比矩阵**\n\n为了分析稳态 $(F^\\ast, S^\\ast)$ 的稳定性，我们对反应动力学进行线性化。这包括计算反应系统在稳态处求值的雅可比矩阵 $J$：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f}{\\partial F} & \\frac{\\partial f}{\\partial S} \\\\ \\frac{\\partial g}{\\partial F} & \\frac{\\partial g}{\\partial S} \\end{pmatrix}_{(F^\\ast, S^\\ast)} = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}\n$$\n偏导数计算如下：\n$a = \\frac{\\partial f}{\\partial F} \\bigg|_{(F^\\ast, S^\\ast)} = \\frac{\\alpha_F \\beta p K_F^p (F^\\ast)^{p-1}}{(K_F^p + (F^\\ast)^p)^2} \\cdot \\frac{1}{1 + \\left(\\frac{S^\\ast}{K_S}\\right)^n} - \\mu_F$\n$b = \\frac{\\partial f}{\\partial S} \\bigg|_{(F^\\ast, S^\\ast)} = -\\alpha_F \\left(1 + \\beta \\frac{(F^\\ast)^p}{K_F^p + (F^\\ast)^p}\\right) \\frac{n (S^\\ast)^{n-1}/K_S^n}{\\left(1 + \\left(\\frac{S^\\ast}{K_S}\\right)^n\\right)^2}$\n$c = \\frac{\\partial g}{\\partial F} \\bigg|_{(F^\\ast, S^\\ast)} = \\frac{\\alpha_S q K_{FS}^q (F^\\ast)^{q-1}}{(K_{FS}^q + (F^\\ast)^q)^2}$\n$d = \\frac{\\partial g}{\\partial S} \\bigg|_{(F^\\ast, S^\\ast)} = -\\mu_S$\n为了提高计算效率，可以使用方程 $(1)$ 来简化 $b$ 的表达式：\n$b = -\\mu_F F^\\ast \\frac{n (S^\\ast)^{n-1}/K_S^n}{1 + \\left(\\frac{S^\\ast}{K_S}\\right)^n}$\n\n**步骤3：均匀稳态的稳定性（反应稳定性）**\n\n在没有扩散（$k=0$）的情况下，稳态的稳定性由雅可比矩阵 $J$ 的特征值决定。当且仅当所有特征值的实部都为负时，系统是稳定的。对于一个 $2 \\times 2$ 矩阵，这对应于两个条件：\n1.  $\\text{Tr}(J) = a + d < 0$\n2.  $\\text{Det}(J) = ad - bc > 0$\n如果这些条件不满足，即使没有扩散，稳态也是不稳定的，图灵型不稳定性也不可能发生。\n\n**步骤4：扩散驱动的不稳定性分析**\n\n我们现在考虑形式为 $e^{\\sigma t} e^{ikx}$ 的空间扰动。在线性化系统中，拉普拉斯算子 $\\frac{\\partial^2}{\\partial x^2}$ 变为乘以 $-k^2$，其中 $k$ 是空间波数。小扰动的演化由矩阵 $M(k)$ 控制：\n$$\nM(k) = J - k^2 D = \\begin{pmatrix} a - D_F k^2 & b \\\\ c & d - D_S k^2 \\end{pmatrix}\n$$\n其中 $D = \\text{diag}(D_F, D_S)$ 是扩散系数的对角矩阵。$M(k)$ 的特征值，记为 $\\sigma(k)$，决定了波数为 $k$ 的扰动的增长率。如果均匀稳态是稳定的（步骤3成立），但存在一个波数 $k^\\ast > 0$，使得 $M(k^\\ast)$ 的最大特征值实部为正，那么就会发生扩散驱动（图灵）不稳定性。即 $\\max(\\Re(\\sigma(k^\\ast))) > 0$。\n\n为了找到这一点，我们必须找到增长率函数 $\\Lambda(k) = \\max(\\Re(\\sigma(k)))$ 在 $k \\ge 0$ 上的最大值。特征值 $\\sigma(k)$ 是特征多项式 $\\det(M(k) - \\sigma I) = 0$ 的根，由以下公式给出：\n$$\n\\sigma(k) = \\frac{\\text{Tr}(M(k)) \\pm \\sqrt{\\text{Tr}(M(k))^2 - 4\\det(M(k))}}{2}\n$$\n我们通过在非负 $k$ 值的范围内进行搜索，以数值方式找到使 $\\Lambda(k)$ 最大化的波数 $k^\\ast$。\n\n**步骤5：确定主导间距**\n\n如果存在图灵不稳定性（即，反应系统稳定且 $\\max_{k>0} \\Lambda(k) > 0$），则主导模式间距（波长）$\\lambda^\\ast$ 由对应于最大增长率的波数 $k^\\ast$ 给出。\n$$\n\\lambda^\\ast = \\frac{2\\pi}{k^\\ast}\n$$\n如果没有发现这种不稳定性（要么因为反应系统不稳定，要么因为 $k>0$ 的最大增长率非正），我们报告没有产生稳定间距，并用值 $-1.0$ 表示。\n\n对所提供的四个参数案例中的每一个，都以数值方式执行了这套完整程序。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root_scalar, minimize_scalar\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    # Define test cases as a list of dictionaries.\n    test_cases = [\n        # Case A: fast inhibitor diffusion, strong coupling\n        {'D_F': 1e-3, 'D_S': 1, 'alpha_F': 2, 'beta': 8, 'mu_F': 1, \n         'alpha_S': 4, 'mu_S': 1, 'K_F': 1, 'K_S': 1, 'K_FS': 1, \n         'p': 2, 'n': 2, 'q': 2},\n        # Case B: equal diffusion\n        {'D_F': 1, 'D_S': 1, 'alpha_F': 2, 'beta': 8, 'mu_F': 1, \n         'alpha_S': 4, 'mu_S': 1, 'K_F': 1, 'K_S': 1, 'K_FS': 1, \n         'p': 2, 'n': 2, 'q': 2},\n        # Case C: weak activator autoactivation\n        {'D_F': 1e-3, 'D_S': 1, 'alpha_F': 2, 'beta': 0, 'mu_F': 1, \n         'alpha_S': 4, 'mu_S': 1, 'K_F': 1, 'K_S': 1, 'K_FS': 1, \n         'p': 2, 'n': 2, 'q': 2},\n        # Case D: near-threshold regime\n        {'D_F': 2e-2, 'D_S': 1, 'alpha_F': 2, 'beta': 4, 'mu_F': 1, \n         'alpha_S': 3, 'mu_S': 1, 'K_F': 1, 'K_S': 1, 'K_FS': 1, \n         'p': 2, 'n': 2, 'q': 2},\n    ]\n\n    results = []\n    for params in test_cases:\n        result = analyze_case(params)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef analyze_case(params):\n    \"\"\"\n    Performs the full linear stability analysis for a single parameter set.\n    \"\"\"\n    # Step 1: Find the homogeneous steady state (F*, S*)\n    try:\n        F_star, S_star = find_steady_state(params)\n        if F_star is None:\n            return -1.0\n    except (ValueError, RuntimeError):\n        # If root finding fails, no stable steady state can be determined\n        return -1.0\n\n    # Step 2: Compute the Jacobian matrix J at (F*, S*)\n    J = compute_jacobian(F_star, S_star, params)\n\n    # Step 3: Check for reaction stability (stability at k=0)\n    eigvals_J = np.linalg.eigvals(J)\n    if not np.all(np.real(eigvals_J) < 0):\n        # Homogeneous state is not stable, Turing mechanism not applicable\n        return -1.0\n        \n    # Helper function to calculate the max growth rate for a given k\n    def get_max_growth_rate(k, jacobian, p):\n        k2 = k**2\n        D_matrix = np.diag([p['D_F'], p['D_S']])\n        M_k = jacobian - k2 * D_matrix\n        eigvals = np.linalg.eigvals(M_k)\n        return np.max(np.real(eigvals))\n\n    # Step 4 & 5: Find k* that maximizes growth rate and check for instability\n    # We minimize the negative of the growth rate function to find its maximum.\n    # Set a plausible bound for k.\n    res = minimize_scalar(lambda k: -get_max_growth_rate(k, J, params), \n                          bounds=(0, 50), method='bounded')\n\n    k_star = res.x\n    max_growth_rate = -res.fun\n\n    # Step 6: Compute dominant spacing if instability exists\n    # Check if max growth is positive and occurs at a non-zero wavenumber\n    # A small tolerance is used for floating point comparisons\n    if max_growth_rate > 1e-9 and k_star > 1e-9:\n        lambda_star = 2 * np.pi / k_star\n        return lambda_star\n    else:\n        # No diffusion-driven instability found\n        return -1.0\n\ndef find_steady_state(params):\n    \"\"\"\n    Numerically solves for the homogeneous steady state concentrations (F*, S*).\n    \"\"\"\n    # Unpack parameters for convenience\n    p = params\n\n    def S_func(F):\n        F_q = F**p['q']\n        return (p['alpha_S'] / p['mu_S']) * \\\n               (F_q / (p['K_FS']**p['q'] + F_q))\n\n    def F_root_func(F):\n        if F < 0: return 1e12 # Penalize negative concentrations\n        S = S_func(F)\n        F_p = F**p['p']\n        S_n = (S / p['K_S'])**p['n']\n        \n        prod_term = p['alpha_F'] * (1 + p['beta'] * F_p / (p['K_F']**p['p'] + F_p))\n        repress_term = 1 / (1 + S_n)\n        decay_term = p['mu_F'] * F\n        \n        return prod_term * repress_term - decay_term\n\n    # Define a search bracket for the root finder\n    # Upper bound from max possible production rate\n    f_max_bound = (p['alpha_F'] * (1 + p['beta'])) / p['mu_F']\n    bracket = [1e-9, f_max_bound * 1.5] # Add margin to upper bound\n\n    sol = root_scalar(F_root_func, bracket=bracket, method='brentq')\n\n    if sol.converged:\n        F_star = sol.root\n        S_star = S_func(F_star)\n        return F_star, S_star\n    else:\n        return None, None\n\ndef compute_jacobian(F_star, S_star, params):\n    \"\"\"\n    Computes the 2x2 Jacobian matrix of the reaction terms at the steady state.\n    \"\"\"\n    p = params\n    F, S = F_star, S_star\n\n    F_p = F**p['p']\n    K_F_p = p['K_F']**p['p']\n    \n    S_n_over_K_S_n = (S / p['K_S'])**p['n']\n\n    # Element a = df/dF\n    a = (p['alpha_F'] * p['beta'] * p['p'] * K_F_p * F**(p['p'] - 1) / (K_F_p + F_p)**2) \\\n        * (1 / (1 + S_n_over_K_S_n)) - p['mu_F']\n    \n    # Element b = df/dS (simplified form)\n    # The term n * S**(n-1) / K_S**n can be written as (n/S) * (S/K_S)**n\n    if abs(S) < 1e-12: # Avoid division by zero if S is very small\n        b = 0.0\n    else:\n        num = p['n'] * (S / p['K_S'])**(p['n']-1) * (1/p['K_S'])\n        den = (1 + S_n_over_K_S_n)**2\n        # Use steady state equation to simplify the first part of the derivative\n        b_mult = p['mu_F'] * F * (1 + S_n_over_K_S_n)\n        b = -b_mult * (num/den)\n    \n    # Element c = dg/dF\n    F_q = F**p['q']\n    K_FS_q = p['K_FS']**p['q']\n    c = (p['alpha_S'] * p['q'] * K_FS_q * F**(p['q'] - 1) / (K_FS_q + F_q)**2)\n\n    # Element d = dg/dS\n    d = -p['mu_S']\n\n    return np.array([[a, b], [c, d]])\n\nsolve()\n\n```", "id": "2648843"}, {"introduction": "除了化学信号网络，物理力在组织塑形中也扮演着至关重要的角色，而管腔内流体压力是管状器官发育中的一个关键机械因素。本练习将应用流体动力学和固体力学（拉普拉斯定律）的基本原理，将发育中的肺芽尖端模型化。这项实践将流体分泌产生的管腔压力与上皮组织壁内的机械应力直接联系起来。通过计算各向异性应力指数，本练习提供了一个定量框架，用以理解机械线索如何被解读为定向的细胞生长行为，最终决定了分支是伸长还是扩张，深刻揭示了生物化学信号与物理力学在形态发生中的协同作用。[@problem_id:2648874]", "problem": "在胚胎肺芽中，腔内液体分泌产生的压力使上皮管和周围的间充质变形。考虑一个具有薄上皮壁的、近似圆柱形的单个顶端分支。使用以下建模基础：\n\n- 顺应性腔室内的流体体积守恒：腔内压力 $P(t)$ 遵循 $C\\,\\frac{dP}{dt} = Q_{s} - Q_{\\text{out}}(P)$，其中 $C$ 是肺芽的顺应性，$Q_{s}$ 是恒定的分泌流入量，$Q_{\\text{out}}(P)$ 是压力驱动的外流量。\n- 通过周围组织的线性水力渗漏：$Q_{\\text{out}}(P) = G\\,P$，其中 $G$ 是有效水力传导率。\n- 适用于闭合端管的薄壁圆柱应力（Laplace 定律）：周向（环向）应力为 $\\sigma_{\\theta} = \\frac{P\\,r}{h}$，轴向应力为 $\\sigma_{z} = \\frac{P\\,r}{2h}$，其中 $r$ 是腔内半径，$h$ 是壁厚。\n- 只有当张应力超过方向特异性阈值时，生长才会被激活。定义一个各向异性指数\n$$\nR = \\frac{\\sigma_{\\theta} - \\sigma_{\\theta}^{\\ast}}{\\sigma_{z} + \\sigma_{a} - \\sigma_{z}^{\\ast}},\n$$\n其中 $\\sigma_{\\theta}^{\\ast}$ 和 $\\sigma_{z}^{\\ast}$ 分别是周向和轴向应力阈值，而 $\\sigma_{a}$ 是由间充质系链和细胞骨架张力贡献的主动轴向预应力。将 $R > 1$ 解释为扩张主导的生长，将 $R < 1$ 解释为伸长主导的生长。\n\n对于一个发育中的肺芽，您测量了以下数据：\n- 腔内分泌速率 $Q_{s} = 2.0 \\times 10^{-3}\\ \\text{mm}^{3}/\\text{min}$。\n- 顺应性 $C = 5.0 \\times 10^{-5}\\ \\text{mm}^{3}/\\text{Pa}$。\n- 水力传导率 $G = 2.0 \\times 10^{-5}\\ \\text{mm}^{3}/(\\text{min}\\cdot\\text{Pa})$。\n- 几何尺寸：$r = 0.050\\ \\text{mm}$，$h = 0.0050\\ \\text{mm}$。\n- 应力阈值和主动应力：$\\sigma_{\\theta}^{\\ast} = 400\\ \\text{Pa}$，$\\sigma_{z}^{\\ast} = 300\\ \\text{Pa}$，以及 $\\sigma_{a} = 200\\ \\text{Pa}$。\n\n从上述建模基础出发，(i) 推导稳态腔内压力 $P_{\\infty}$，并 (ii) 评估稳态下的各向异性指数 $R$。仅报告 $R$ 的值作为您的最终答案。将最终答案四舍五入至三位有效数字。将您的最终答案表示为一个纯数（无量纲）。", "solution": "所提出的问题是一个定义明确的生物物理建模练习，它结合了流体动力学和固体力学原理来分析组织生长。它具有科学依据，内容自洽，且所有提供的数据均一致。因此，可以推导出解决方案。\n\n分析始于腔内流体体积守恒，由以下微分方程控制：\n$$\nC\\,\\frac{dP}{dt} = Q_{s} - Q_{\\text{out}}(P)\n$$\n此处，$P(t)$ 是腔内压力，$C$ 是顺应性，$Q_{s}$ 是恒定液体分泌速率，而 $Q_{\\text{out}}(P)$ 是依赖于压力的外流量。外流量被设定为线性水力渗漏：\n$$\nQ_{\\text{out}}(P) = G\\,P\n$$\n其中 $G$ 是水力传导率。将此代入守恒方程可得：\n$$\nC\\,\\frac{dP}{dt} = Q_{s} - G\\,P\n$$\n问题要求在稳态下进行分析。在稳态下，系统变量不随时间变化。因此，压力变为常数，$P(t) = P_{\\infty}$，这意味着其时间导数为零：\n$$\n\\frac{dP}{dt} = 0\n$$\n将此条件应用于控制方程可得：\n$$\n0 = Q_{s} - G\\,P_{\\infty}\n$$\n由此，我们推导出稳态腔内压力 $P_{\\infty}$ 的表达式：\n$$\nP_{\\infty} = \\frac{Q_{s}}{G}\n$$\n使用所提供的数值，$Q_{s} = 2.0 \\times 10^{-3}\\ \\text{mm}^{3}/\\text{min}$ 和 $G = 2.0 \\times 10^{-5}\\ \\text{mm}^{3}/(\\text{min}\\cdot\\text{Pa})$：\n$$\nP_{\\infty} = \\frac{2.0 \\times 10^{-3}}{2.0 \\times 10^{-5}} \\text{ Pa} = 100 \\text{ Pa}\n$$\n接下来，我们确定在此稳态压力下上皮壁中的应力。问题提供了薄壁圆柱应力公式（Laplace 定律）：\n周向（环向）应力 $\\sigma_{\\theta}$ 由下式给出：\n$$\n\\sigma_{\\theta} = \\frac{P_{\\infty}\\,r}{h}\n$$\n轴向应力 $\\sigma_{z}$ 由下式给出：\n$$\n\\sigma_{z} = \\frac{P_{\\infty}\\,r}{2h}\n$$\n给定腔内半径 $r = 0.050\\ \\text{mm}$ 和壁厚 $h = 0.0050\\ \\text{mm}$。这些尺寸的比率为：\n$$\n\\frac{r}{h} = \\frac{0.050}{0.0050} = 10\n$$\n将 $P_{\\infty}$ 的值和 $r/h$ 的比率代入应力方程：\n$$\n\\sigma_{\\theta} = (100 \\text{ Pa}) \\times 10 = 1000 \\text{ Pa}\n$$\n$$\n\\sigma_{z} = \\frac{(100 \\text{ Pa}) \\times 10}{2} = 500 \\text{ Pa}\n$$\n最后一步是计算各向异性指数 $R$，其定义为：\n$$\nR = \\frac{\\sigma_{\\theta} - \\sigma_{\\theta}^{\\ast}}{\\sigma_{z} + \\sigma_{a} - \\sigma_{z}^{\\ast}}\n$$\n我们代入计算出的稳态应力以及给定的参数值：$\\sigma_{\\theta}^{\\ast} = 400\\ \\text{Pa}$，$\\sigma_{z}^{\\ast} = 300\\ \\text{Pa}$，以及 $\\sigma_{a} = 200\\ \\text{Pa}$。\n分子是：\n$$\n\\sigma_{\\theta} - \\sigma_{\\theta}^{\\ast} = 1000\\ \\text{Pa} - 400\\ \\text{Pa} = 600\\ \\text{Pa}\n$$\n分母是：\n$$\n\\sigma_{z} + \\sigma_{a} - \\sigma_{z}^{\\ast} = 500\\ \\text{Pa} + 200\\ \\text{Pa} - 300\\ \\text{Pa} = 400\\ \\text{Pa}\n$$\n因此，各向异性指数 $R$ 为：\n$$\nR = \\frac{600}{400} = 1.5\n$$\n问题要求答案四舍五入至三位有效数字。计算值 $1.5$ 可以写成 $1.50$。由于 $R > 1$，模型预测在这些条件下生长模式为扩张主导。", "answer": "$$\n\\boxed{1.50}\n$$", "id": "2648874"}]}