{"hands_on_practices": [{"introduction": "发育生物学中的一个核心问题是细胞如何根据其在组织中的位置获得特定的身份。这个过程通常由被称为“形态发生素”的信号分子梯度来指导。本练习将理论与实践相结合，通过一个简化的数学模型来模拟Nodal信号如何设定内胚层-中胚层命运边界，旨在训练您将复杂的生物学情景转化为可解的定量框架，并分析系统参数如何影响最终的发育模式。[@problem_id:2634309]", "id": "2634309", "problem": "在早期脊椎动物的原肠胚形成过程中，一个位于前侧的转化生长因子-β (TGF-β) 家族配体 Nodal 的源头，在一个一维的中内胚层上皮上建立了一个浓度梯度。当转录因子 SRY-Box 转录因子 17 (Sox17) 被诱导时，细胞将采取内胚层的命运。根据经验，Sox17 的诱导是超敏的，并且由于高协同性的 Smad2/3 介导的转录，可以将其近似为一个位于 Nodal 浓度 $T$ 处的尖锐阈值。假设组织占据半直线 $x \\geq 0$，组织者位于 $x=0$ 处，并假设稳态 Nodal 梯度由经过充分检验的指数形式 $C(x)=C_0 \\exp(-x/\\lambda)$ 给出，其中 $C_0>0$ 是源头的浓度，$\\lambda>0$ 是由扩散和清除决定的衰减长度。\n\n使用形态发生素解读的阈值模型，内胚层-中胚层命运边界 $x^{\\ast}$ 由 $C(x^{\\ast})=T$ 隐式定义，其中 $C_0>T>0$ 用以确保有区域能够达到该阈值。从基于阈值的命运决定的核心定义和给定的稳态梯度出发，推导出 $x^{\\ast}$ 关于 $C_0$、$T$ 和 $\\lambda$ 的闭式解析表达式。然后，通过计算敏感度 $\\mathrm{d}x^{\\ast}/\\mathrm{d}\\lambda$ 的符号来分析改变 $\\lambda$ 如何使 $x^{\\ast}$ 发生移动，并用文字解释其含义。不需要进行数值评估，也无需四舍五入。你最终报告的答案应该仅为 $x^{\\ast}$ 的显式表达式。", "solution": "该问题陈述在科学上是合理的，在数学上是适定的。它提出了一个形态发生素梯度解读的标准简化模型，这是发育生物学中的一个基本概念。所有必要的参数和定义都已提供，且约束条件是一致的。我们将开始推导。\n\n问题将形态发生素 Nodal 的稳态浓度分布定义为沿一维组织的位置 $x$ 的函数：\n$$C(x) = C_0 \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n此处，$C_0$ 是源头位置 $x=0$ 处的浓度，而 $\\lambda$ 是该梯度的特征衰减长度。\n\n细胞命运决定的模型基于一个尖锐的阈值。如果局部 Nodal 浓度 $C(x)$ 超过一个临界阈值 $T$，细胞就被指定为内胚层。因此，内胚层和中胚层区域之间的边界（我们记为 $x^{\\ast}$）是浓度恰好等于该阈值的精确位置。这由以下隐式定义表达：\n$$C(x^{\\ast}) = T$$\n\n为了推导 $x^{\\ast}$ 的显式闭式表达式，我们将 $C(x)$ 的函数形式代入这个定义方程中：\n$$C_0 \\exp\\left(-\\frac{x^{\\ast}}{\\lambda}\\right) = T$$\n\n问题给出了约束条件 $C_0 > T > 0$。这是一个至关重要的条件。它确保了对于 $x^{\\ast} > 0$ 存在一个有物理意义的解，因为源头的浓度 $C(0) = C_0$ 大于阈值，而远离源头的浓度 $\\lim_{x \\to \\infty} C(x) = 0$ 小于阈值。根据连续函数的介值定理，必然存在一点 $x^{\\ast}$ 使得 $C(x^{\\ast}) = T$。\n\n现在我们通过代数运算来求解 $x^{\\ast}$。首先，我们通过除以 $C_0$ 来分离指数项：\n$$\\exp\\left(-\\frac{x^{\\ast}}{\\lambda}\\right) = \\frac{T}{C_0}$$\n\n接下来，为了解出指数的参数，我们对等式两边取自然对数 $\\ln$：\n$$\\ln\\left(\\exp\\left(-\\frac{x^{\\ast}}{\\lambda}\\right)\\right) = \\ln\\left(\\frac{T}{C_0}\\right)$$\n自然对数是指数函数的反函数，所以左边简化为：\n$$-\\frac{x^{\\ast}}{\\lambda} = \\ln\\left(\\frac{T}{C_0}\\right)$$\n\n为了进一步简化表达式，我们使用基本对数恒等式 $\\ln(a/b) = -\\ln(b/a)$。将此应用于等式右侧，我们得到：\n$$-\\frac{x^{\\ast}}{\\lambda} = -\\ln\\left(\\frac{C_0}{T}\\right)$$\n\n最后，我们将等式两边乘以 $-\\lambda$ 以分离出 $x^{\\ast}$，得到命运边界位置的最终解析表达式：\n$$x^{\\ast} = \\lambda \\ln\\left(\\frac{C_0}{T}\\right)$$\n\n这就是所求的 $x^{\\ast}$ 关于系统参数 $C_0$、$T$ 和 $\\lambda$ 的闭式表达式。\n\n分析的第二部分要求我们计算 $x^{\\ast}$ 相对于衰减长度 $\\lambda$ 的敏感度的符号，该敏感度由导数 $\\frac{\\mathrm{d}x^{\\ast}}{\\mathrm{d}\\lambda}$ 给出。将 $C_0$ 和 $T$ 视为常数，我们对 $x^{\\ast}$ 的表达式求导：\n$$\\frac{\\mathrm{d}x^{\\ast}}{\\mathrm{d}\\lambda} = \\frac{\\mathrm{d}}{\\mathrm{d}\\lambda}\\left[ \\lambda \\ln\\left(\\frac{C_0}{T}\\right) \\right]$$\n$\\ln\\left(\\frac{C_0}{T}\\right)$ 这一项是相对于 $\\lambda$ 的常数因子。因此，导数为：\n$$\\frac{\\mathrm{d}x^{\\ast}}{\\mathrm{d}\\lambda} = \\ln\\left(\\frac{C_0}{T}\\right)$$\n\n为了确定该导数的符号，我们回顾给定的约束条件 $C_0 > T > 0$。这意味着比率 $\\frac{C_0}{T} > 1$。自然对数函数 $\\ln(z)$ 对于任何大于 1 的自变量 $z$ 都严格为正。因此，我们可以得出结论，该导数为正：\n$$\\frac{\\mathrm{d}x^{\\ast}}{\\mathrm{d}\\lambda} > 0$$\n\n敏感度 $\\frac{\\mathrm{d}x^{\\ast}}{\\mathrm{d}\\lambda}$ 的正号表明 $x^{\\ast}$ 是 $\\lambda$ 的单调递增函数。在生物系统背景下的清晰解释是，衰减长度 $\\lambda$ 的增加导致形态发生素梯度变得更平缓，意味着它在衰减前能延伸到组织更远的位置。因此，浓度下降到阈值 $T$ 的位置 $x^{\\ast}$ 会进一步远离位于 $x=0$ 的源头。用生物学术语来说，增加 Nodal 信号的范围会扩大被指定为内胚层的组织区域的大小。", "answer": "$$\n\\boxed{\\lambda \\ln\\left(\\frac{C_0}{T}\\right)}\n$$"}, {"introduction": "超越理论模型，现代发育生物学家必须能够设计实验来检验关于形态发生机制的假设。本练习模拟了一个真实的科研挑战：面对一种发育缺陷（前肠闭锁），您需要提出一个清晰的实验方案来区分两种可能的细胞学病因。这个思想实验旨在磨练您的实验设计逻辑和批判性思维，特别是如何利用特异性分子标记物作为诊断工具来揭示形态发生事件背后的细胞和分子机制。[@problem_id:2634247]", "id": "2634247", "problem": "脊椎动物胚胎通过两侧的内胚层板在前肠门和后肠门处弯曲，并向中线汇合，从而形成肠管，建立一个连续的上皮管。在一个条件性内胚层特异性突变体中，前肠水平的组织学显示，两个相对的内胚层上皮未能相遇，管腔连续性存在间隙，这与前肠闭锁的表型一致。你无法进行活体成像，必须从固定切片中推断其机制。你假设主要缺陷是 (i) 相对的上皮之间的基底膜屏障持续存在，或 (ii) 肠门前缘的上皮迁移和融合失败。\n\n根据以下基本原理：胚层由信号通路和转录因子决定（例如，Nodal 信号在定形内胚层中诱导 SRY-Box 转录因子 $17$ (SOX17) 和 Forkhead box A$2$ (FOXA$2$)）；上皮板通过一种称为基底膜的特化细胞外基质 (ECM) 与间充质分离，基底膜由 Laminins、Collagen type IV、Nidogens 和 Perlecan 组成；上皮融合需要局部移除基底膜以及由整合素和黏着斑信号介导的主动细胞迁移。请选择唯一一个选项，该选项同时 (a) 对肠门融合失败导致前肠闭锁给出了最准确的机制性解释，并且 (b) 提出了一个最简、能提供机制信息的免疫染色组合，其清晰的预测结果能够在固定切片中区分基底膜的持续存在与上皮迁移的缺失。\n\nA. 肠门融合失败使前肠形成两个盲端上皮囊，因为内胚层板必须跨越中线汇合并融合以建立管腔连续性；没有融合，连续性就无法形成，管腔就被中断。为了区分这两种机制，需进行共免疫染色，检测 Laminin 和 Collagen IV（以检测基底膜）、E-cadherin（以标记上皮）以及 FOXA$2$ 或 SOX$17$（以确认内胚层身份），还有酪氨酸 $397$ 位点的磷酸化黏着斑激酶 (phospho-FAK) 或 Paxillin（以报告前缘迁移信号）。预测：如果基底膜持续存在，在两个 E-cadherin 阳性、FOXA$2$/SOX$17$ 阳性的上皮之间会有一条连续的 Laminin/Collagen IV 层，且前缘可能显示出邻接于完整基质的局灶性 phospho-FAK 斑点；如果上皮迁移失败，中线将缺少 Laminin/Colligen IV（基质已被清除），但 E-cadherin 阳性、FOXA$2$/SOX$17$ 阳性的前缘将停留在侧方，并在预期的前缘位置显示出减少或非极化的 phospho-FAK/Paxillin 信号。\n\nB. 肠门融合失败导致闭锁，因为间充质凝聚机械性地夹断了前肠；因此，对间充质中的 Vimentin 和血小板衍生生长因子受体 α (PDGFR$\\alpha$) 以及界面处的 Fibronectin 和 Collagen I 进行免疫染色，以评估基质密度。预测：中线处 Vimentin/PDGFR$\\alpha$ 和 Fibronectin/Collagen I 的增加表明存在间充质夹断机制，而它们的缺失则表明存在上皮迁移缺陷。\n\nC. 肠门融合失败反映了通过细胞凋亡实现的上皮再管化失败；因此，对内胚层中的活化 Caspase-3 和进行末端脱氧核苷酸转移酶 dUTP 缺口末端标记 (TUNEL)，并检测 Zonula Occludens-1 (ZO-1) 以评估紧密连接的完整性。预测：中线处高水平的活化 Caspase-3/TUNEL 信号和碎裂的 ZO-1 表明凋亡性再管化失败，而低水平的细胞凋亡则表明基底膜持续存在。\n\nD. 肠门融合失败反映了前肠的背腹模式形成错误；因此，对内胚层中的 Sonic Hedgehog (SHH) 和骨形态发生蛋白 4 (BMP4) 梯度、用于确定前肠身份的 SRY-Box 转录因子 2 (SOX2) 以及用于中胚层的 Brachyury (T) 进行免疫染色。预测：改变的 SHH/BMP4 梯度以及正常的 SOX2 和 Brachyury 表明是模式形成失败而非机械性融合缺陷；正常的梯度则暗示基底膜持续存在。", "solution": "首先将对问题陈述进行严格验证。\n\n### 步骤 1：提取已知条件\n- **系统**：形成肠管的脊椎动物胚胎。\n- **过程**：两侧定位的内胚层板在前肠门 ($AIP$) 和后肠门 ($PIP$) 处弯曲，向中线汇合并融合，以建立一个连续的上皮管。\n- **表型**：在一个条件性内胚层特异性突变体中，前肠水平的组织学显示两个相对的内胚层上皮未能相遇，导致管腔连续性出现间隙（前肠闭锁）。\n- **实验限制**：必须从固定切片中推断分析结果；无法进行活体成像。\n- **待区分的假设**：\n    1.  `(i)` 相对的上皮之间的基底膜屏障持续存在。\n    2.  `(ii)` 肠门前缘的上皮迁移和融合失败。\n- **假设的基本原理**：\n    1.  胚层决定：`$Nodal$` 信号在定形内胚层中诱导 `$SRY-Box~transcription~factor~17$` (`$SOX17$`) 和 `$Forkhead~box~A2$` (`$FOXA2$`)。\n    2.  基底膜 ($BM$)：上皮板通过一种称为基底膜的特化细胞外基质 ($ECM$) 与间充质分离，基底膜由 `$Laminins$`、`$Collagen~type~IV$`、`$Nidogens$` 和 `$Perlecan$` 组成。\n    3.  上皮融合：需要局部移除基底膜以及由 `$integrins$` 和黏着斑信号介导的主动细胞迁移。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题陈述的有效性进行仔细审查。\n\n- **科学性**：该问题很好地基于发育生物学的原理。关于通过内胚层板融合形成肠管的形态发生、基底膜的分子组成、关键转录因子如 `$SOX17$` 和 `$FOXA2$` 的作用，以及上皮融合的一般机制（需要基质降解和细胞迁移）的描述都是已确立的事实。\n- **适定性**：该问题提法得当。它提出了一个特定的生物学观察（前肠闭锁）和两个不同、合理且互斥的机制性假设。任务是设计一个使用标准技术（免疫染色）的实验来区分这些假设，这为找到解决方案提供了一条清晰且合乎逻辑的路径。\n- **客观性**：语言技术性强且精确。假设被表述为可证伪的科学命题。选项的评估标准是客观的：机制的准确性和所提议实验的信息量。\n\n### 步骤 3：结论与行动\n问题陈述在科学上是合理的、提法得当、客观，并包含足够的信息来构建一个合乎逻辑的解决方案。不存在矛盾、模糊之处或事实错误。因此，该问题是**有效的**。开始求解。\n\n### 求解过程\n任务是选择一个选项，该选项能正确解释表型，并提出了一个实验来区分其原因的两个假设：`$Hypothesis~(i)$`，持续存在的基底膜 ($BM$)，和 `$Hypothesis~(ii)$`，上皮迁移失败。\n\n#### (a) 部分：闭锁的机制性解释\n肠管的形成是一个形态发生过程，涉及将二维上皮板转变为三维管状结构。问题陈述此过程是通过两侧内胚层板的汇合与融合实现的。管腔的连续性是这些板层沿背侧和腹侧中线成功融合的直接结果。如果此融合事件在前肠门处失败，两片板层将保持分离。这将导致两个不相连的盲端管，在未来的消化道中造成物理间隙。根据定义，这种情况就是闭锁（正常开口的缺失）。任何正确的解释都必须阐明上皮融合失败的这一基本后果。\n\n#### (b) 部分：最简、能提供机制信息的免疫染色组合\n为了在固定切片中区分 `$Hypothesis~(i)$` 和 `$Hypothesis~(ii)$`，我们必须将每个提议机制中的关键分子参与者可视化。\n\n1.  **组织鉴定**：首先鉴定感兴趣的组织是至关重要的。\n    *   **内胚层**：问题陈述 `$SOX17$` 和 `$FOXA2$` 是定形内胚层的标记物。\n    *   **上皮**：需要一个通用的上皮标记物，例如 `$E-cadherin$`（一种对上皮完整性至关重要的细胞-细胞黏附分子），来勾勒出细胞轮廓并确认其上皮性质。\n\n2.  **区分假设**：\n    *   为了检验 `$Hypothesis~(i)$`（持续存在的 $BM$），必须直接观察 $BM$。问题陈述 $BM$ 由 `$Laminins$` 和 `$Collagen~type~IV$` 组成。对这些蛋白进行免疫染色将揭示 $BM$ 的位置和连续性。\n        *   **如果 (i) 为真时的预测**：在两个相对但未融合的内胚层上皮之间的空间中，将存在一条连续、不间断的 `$Laminin$` 和/或 `$Collagen~type~IV$` 染色线。\n    *   为了检验 `$Hypothesis~(ii)$`（迁移失败），必须评估前缘（肠门前缘）细胞的迁移活性。主动细胞迁移由细胞骨架驱动，并由细胞与 $ECM$ 连接处的黏着斑信号介导。\n        *   **关键标记物**：活跃黏着斑信号的一个常见且可靠的指标是 `$Focal~Adhesion~Kinase$` (`$FAK$`) 在特定位点（如 `$tyrosine~397$` (`$pFAK^{Y397}$`)）的磷酸化。另一个关键的黏着斑蛋白是 `$Paxillin$`。对 `$phospho-FAK$` 或 `$Paxillin$` 进行染色可以揭示活跃的细胞-基质相互作用和迁移信号位点。\n        *   **如果 (ii) 为真时的预测**：在这种情况下，预计中线处的 $BM$ 已被正确清除，因此 `$Laminin/Collagen~IV$` 染色应该有一个*缺口*。然而，内胚层细胞本身未能迁移到这个被清除的空间中。这将体现为上皮前缘处 `$phospho-FAK$` 或 `$Paxillin$` 信号微弱、缺失或非极化。细胞没有“试图”移动。\n    *   **对 (i) 的对比预测**：如果假设 (i)（持续存在的 $BM$）为真，细胞可能仍在尝试迁移，但受到了物理阻挡。在这种情况下，人们可能会观察到极化的 `$phospho-FAK$/`$Paxillin$` 斑点集中在前缘细胞的基底面，直接邻接于持续存在的 $BM$。\n\n因此，一个最简且完整的实验组合必须包括以下标记物：内胚层身份 (`$FOXA2$/$SOX17$`)、上皮结构 (`$E-cadherin$`)、基底膜 ($BM$) (`$Laminin$/$Collagen~IV$`) 和迁移信号 (`$phospho-FAK$/$Paxillin$`)。在每个假设下，这些标记物的预测结果都是独特的，可以进行明确的区分。\n\n### 逐项分析\n\n**A. 肠门融合失败使前肠形成两个盲端上皮囊，因为内胚层板必须跨越中线汇合并融合以建立管腔连续性；没有融合，连续性就无法形成，管腔就被中断。为了区分这两种机制，需进行共免疫染色，检测 Laminin 和 Collagen IV（以检测基底膜）、E-cadherin（以标记上皮）以及 FOXA$2$ 或 SOX$17$（以确认内胚层身份），还有酪氨酸 $397$ 位点的磷酸化黏着斑激酶 (phospho-FAK) 或 Paxillin（以报告前缘迁移信号）。预测：如果基底膜持续存在，在两个 E-cadherin 阳性、FOXA$2$/SOX$17$ 阳性的上皮之间会有一条连续的 Laminin/Collagen IV 层，且前缘可能显示出邻接于完整基质的局灶性 phospho-FAK 斑点；如果上皮迁移失败，中线将缺少 Laminin/Collagen IV（基质已被清除），但 E-cadherin 阳性、FOXA$2$/SOX$17$ 阳性的前缘将停留在侧方，并在预期的前缘位置显示出减少或非极化的 phospho-FAK/Paxillin 信号。**\n\n*   **机制性解释**：该解释准确，并直接阐述了闭锁的形态发生基础，与基本原理一致。\n*   **免疫染色组合**：提议的组合（`$Laminin$`、`$Collagen~IV$`、`$E-cadherin$`、`$FOXA2$/$SOX17$`、`$phospho-FAK$/$Paxillin$`）正是上面推导出的区分假设所必需且充分的标记物集合。它靶向了组织身份、潜在屏障 ($BM$) 和迁移机制。\n*   **预测**：对每个假设的预测结果合乎逻辑、精确且可直接检验。它们正确地对比了每种情况下 $BM$ 的状态和迁移信号的状态。\n*   **结论**：**正确**。\n\n**B. 肠门融合失败导致闭锁，因为间充质凝聚机械性地夹断了前肠；因此，对间充质中的 Vimentin 和血小板衍生生长因子受体 α (PDGFR$\\alpha$) 以及界面处的 Fibronectin 和 Collagen I 进行免疫染色，以评估基质密度。预测：中线处 Vimentin/PDGFR$\\alpha$ 和 Fibronectin/Collagen I 的增加表明存在间充质夹断机制，而它们的缺失则表明存在上皮迁移缺陷。**\n\n*   **机制性解释**：这引入了一个新的假设（“间充质凝聚”），而不是要测试的两个选项之一。问题明确地是关于*内胚层上皮*的缺陷。\n*   **免疫染色组合**：这些标记物（`$Vimentin$`、`$PDGFR\\alpha$`、`$Fibronectin$`、`$Collagen~I$`）是针对间充质和间质性 $ECM$ 的，而不是针对上皮基底膜或上皮迁移信号。该组合与区分 `$Hypothesis~(i)$` 和 `$Hypothesis~(ii)$` 无关。\n*   **预测**：这些预测旨在检验“间充质夹断”的观点，而不是问题陈述中给出的两种可能性。\n*   **结论**：**错误**。\n\n**C. 肠门融合失败反映了通过细胞凋亡实现的上皮再管化失败；因此，对内胚层中的活化 Caspase-3 和进行末端脱氧核苷酸转移酶 dUTP 缺口末端标记 (TUNEL)，并检测 Zonula Occludens-1 (ZO-1) 以评估紧密连接的完整性。预测：中线处高水平的活化 Caspase-3/TUNEL 信号和碎裂的 ZO-1 表明凋亡性再管化失败，而低水平的细胞凋亡则表明基底膜持续存在。**\n\n*   **机制性解释**：这援引了“通过细胞凋亡实现再管化”，这与问题中描述的上皮板融合是一个根本不同的过程。由板层折叠形成肠管通常不涉及先形成一个实心索，然后通过细胞凋亡形成管腔。\n*   **免疫染色组合**：该组合（`$Cleaved~Caspase-3$`、`$TUNEL$`、`$ZO-1$`）被设计用来测量细胞凋亡和紧密连接的完整性。它没有提供关于基底膜状态 (`$Hypothesis~(i)$`) 或迁移信号 (`$Hypothesis~(ii)$`) 的信息。\n*   **预测**：“低水平细胞凋亡意味着基底膜持续存在”这一预测是一个*不合逻辑的推论*。两者之间没有逻辑联系。\n*   **结论**：**错误**。\n\n**D. 肠门融合失败反映了前肠的背腹模式形成错误；因此，对内胚层中的 Sonic Hedgehog (SHH) 和骨形态发生蛋白 4 (BMP4) 梯度、用于确定前肠身份的 SRY-Box 转录因子 2 (SOX2) 以及用于中胚层的 Brachyury (T) 进行免疫染色。预测：改变的 SHH/BMP4 梯度以及正常的 SOX2 和 Brachyury 表明是模式形成失败而非机械性融合缺陷；正常的梯度则暗示基底膜持续存在。**\n\n*   **机制性解释**：这把焦点转移到了一个上游原因（模式形成），而不是直接的机械性失败（融合）。虽然模式形成缺陷可能是最终原因，但任务是区分给定的两个*下游*融合失败机制。\n*   **免疫染色组合**：该组合（`$SHH$`、`$BMP4$`、`$SOX2$`、`$Brachyury$`）评估组织模式形成和身份。它不包含用于 $BM$ 或迁移机制的标记物。\n*   **预测**：“正常的模式形成梯度‘暗示基底膜持续存在’”是一个逻辑谬误。正常的模式形成并不能排除迁移信号的失败，也不能证明 $BM$ 降解机制存在缺陷。这个实验无法区分 `$Hypothesis~(i)` 和 `$Hypothesis~(ii)$`。\n*   **结论**：**错误**。", "answer": "$$\\boxed{A}$$"}, {"introduction": "随着单细胞测序等高通量技术的发展，我们现在可以在群体水平上以前所未有的分辨率解析细胞状态的异质性。本练习将您置于计算生物学家的角色，要求您根据预先设定的定量标准，对模拟的单细胞基因表达数据进行分类。这项实践旨在让您熟悉基于多维数据定义和量化细胞身份的逻辑，这是从定性观察转向精确、可重复的定量分析的关键一步。[@problem_id:2634294]", "id": "2634294", "problem": "在针对内胚层特化的单细胞RNA测序（scRNA-seq; single-cell Ribonucleic Acid sequencing）研究中，内胚层定型可以操作性地定义为内胚层转录因子的协同上调以及多能性因子的下调。考虑每个细胞中测量的三个基因：Sox17 (Sry-box 17)、FoxA2 (Forkhead box A2) 和 Nanog Homeobox (Nanog)。在机理层面，内胚层转录因子 Sox17 和 FoxA2 协同激活一个内胚层基因程序，而 Nanog 则是拮抗分化的多能性网络的核心组分。根据分子生物学中心法则和标准基因调控逻辑，一个稳定的内胚层状态对应于一个不动点，在该点上，内胚层驱动因子表达水平高而多能性驱动因子表达水平低，并且由于协同调控，内胚层驱动因子会协同上升。\n\n您的任务是，仅使用在给定 Activin 剂量下每个细胞的 Sox17、FoxA2 和 Nanog 表达向量，为内胚层定型形式化一个定量的、无单位的分类标准（Activin 剂量以纳克/毫升，ng/mL 为单位提供，但分类标准本身是无单位的，且不得显式依赖于单位）。然后，实现该标准，以计算测试套件中提供的每个数据集的定型细胞比例。\n\n使用以下基于拮抗调控模块和协同性思想的建模选择：\n\n1. 对于索引为 $i$ 的每个细胞，将其 Sox17 表达量记为 $S_i \\ge 0$，FoxA2 表达量记为 $F_i \\ge 0$，Nanog 表达量记为 $N_i \\ge 0$。\n2. 定义一个对数比率内胚层定型指数\n$$\nR_i \\;=\\; \\log_{10}\\!\\left(\\frac{S_i + F_i + \\kappa}{N_i + \\kappa}\\right),\n$$\n其中 $\\kappa = 10^{-3}$ 是一个小的正常数，用以确保数值稳定性并保持单位抵消。\n3. 定义一个标记物协同性得分\n$$\nc_i \\;=\\; \\frac{|S_i - F_i|}{S_i + F_i + \\delta},\n$$\n其中 $\\delta = 10^{-9}$ 是一个小的正常数，用以避免除以零。较小的 $c_i$ 表示两个内胚层驱动因子的共表达更具协同性。\n4. 当且仅当以下所有条件同时成立时，将细胞 $i$ 分类为定型至内胚层：\n   - $R_i \\ge \\tau$，其中 $\\tau = 0.3$，\n   - $S_i \\ge S_{\\min}$，其中 $S_{\\min} = 0.5$，\n   - $F_i \\ge F_{\\min}$，其中 $F_{\\min} = 0.5$，\n   - $c_i \\le \\eta$，其中 $\\eta = 0.25$。\n\n对于给定 Activin 剂量下的一个包含 $n$ 个细胞的数据集，计算定型细胞比例\n$$\n\\phi \\;=\\; \\frac{1}{n}\\sum_{i=1}^{n} \\mathbf{1}\\!\\left\\{ R_i \\ge \\tau,\\; S_i \\ge S_{\\min},\\; F_i \\ge F_{\\min},\\; c_i \\le \\eta \\right\\},\n$$\n其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数，当条件为真时其值为 $1$，否则为 $0$。将 $\\phi$ 报告为一个在闭区间 $[0,1]$ 内的小数。\n\n您的程序必须严格按照规定实现此标准，并评估以下测试套件。每个测试用例提供 Activin 剂量 $A$（单位为 ng/mL，仅供参考；不涉及角度单位）以及三个等长为 $n$ 的表达向量 $S$、$F$ 和 $N$：\n\n- 测试用例1（低剂量，预期未定型）：$A = 0.0$ ng/mL,\n  $S = [\\,0.10, 0.20, 0.15, 0.12, 0.18, 0.20\\,]$,\n  $F = [\\,0.08, 0.22, 0.14, 0.10, 0.16, 0.18\\,]$,\n  $N = [\\,1.00, 0.90, 1.10, 1.20, 0.95, 1.05\\,]$.\n- 测试用例2（中等剂量，混合状态）：$A = 10.0$ ng/mL,\n  $S = [\\,0.10, 0.20, 2.00, 1.80, 0.15, 2.20\\,]$,\n  $F = [\\,0.12, 0.25, 2.10, 1.90, 0.11, 2.00\\,]$,\n  $N = [\\,1.20, 1.10, 0.20, 0.30, 1.30, 0.10\\,]$.\n- 测试用例3（中高剂量，含不平衡边界情况）：$A = 25.0$ ng/mL,\n  $S = [\\,2.00, 1.90, 3.00, 0.20, 0.15, 2.10\\,]$,\n  $F = [\\,2.10, 2.00, 0.70, 0.22, 0.10, 2.05\\,]$,\n  $N = [\\,0.20, 0.25, 0.20, 1.10, 1.20, 0.15\\,]$.\n- 测试用例4（高剂量，完全定型）：$A = 50.0$ ng/mL,\n  $S = [\\,2.10, 1.95, 2.05, 2.00, 1.90, 2.20\\,]$,\n  $F = [\\,2.00, 2.05, 2.10, 1.95, 2.00, 2.15\\,]$,\n  $N = [\\,0.10, 0.20, 0.15, 0.25, 0.18, 0.12\\,]$.\n- 测试用例5（对单一标记物中退化离散的稳健性）：$A = 5.0$ ng/mL,\n  $S = [\\,1.00, 1.00, 1.00, 1.00, 1.00, 1.00\\,]$,\n  $F = [\\,2.00, 1.90, 2.10, 2.05, 1.95, 2.00\\,]$,\n  $N = [\\,0.30, 0.25, 0.28, 0.32, 0.26, 0.27\\,]$.\n\n您的程序应生成单行输出，其中包含一个用方括号括起的逗号分隔列表形式的结果，其顺序与测试用例相同。每个条目必须是该测试用例的定型比例 $\\phi$，以小数形式表示。例如，输出格式必须与 $[x_1,x_2,x_3,x_4,x_5]$ 完全一样，其中每个 $x_j$ 是测试用例 $j$ 计算出的比例，无额外空格要求。", "solution": "问题陈述已经过验证并被认为是有效的。它以发育生物学的原理为科学依据，特别是内胚层特化的分子逻辑。该问题是适定的，为获得唯一解提供了完整且一致的定义、常数和数据。将生物学概念形式化为定量分类标准是客观且数学上可靠的。\n\n任务是为 5 个不同的数据集计算定型到内胚层谱系的细胞比例 $\\phi$。一个细胞是否被分类为定型，是基于一组应用于三个基因 $S_i$ (Sox17)、$F_i$ (FoxA2) 和 $N_i$ (Nanog) 表达水平的 4 个同时成立的条件。该分类方法基于明确的、确定性的规则。\n\n提供的常数如下：\n- 对数比率的伪计数：$\\kappa = 10^{-3}$\n- 协同性得分的伪计数：$\\delta = 10^{-9}$\n- 对数比率阈值：$\\tau = 0.3$\n- Sox17 表达阈值：$S_{\\min} = 0.5$\n- FoxA2 表达阈值：$F_{\\min} = 0.5$\n- 协同性阈值：$\\eta = 0.25$\n\n对于一个大小为 $n$ 的细胞群体中的每个细胞 $i$，我们首先计算两个指标：\n1. 对数比率内胚层定型指数 $R_i$，它量化了内胚层驱动因子（$S_i$、$F_i$）和多能性因子（$N_i$）之间的平衡：\n$$\nR_i = \\log_{10}\\!\\left(\\frac{S_i + F_i + \\kappa}{N_i + \\kappa}\\right)\n$$\n2. 标记物协同性得分 $c_i$，它衡量了两个内胚层驱动因子的协同表达：\n$$\nc_i = \\frac{|S_i - F_i|}{S_i + F_i + \\delta}\n$$\n\n当且仅当以下所有四个标准都被满足时，细胞 $i$ 被分类为定型：\n1. $R_i \\ge \\tau$ (内胚层程序占主导地位)\n2. $S_i \\ge S_{\\min}$ (Sox17 充分表达)\n3. $F_i \\ge F_{\\min}$ (FoxA2 充分表达)\n4. $c_i \\le \\eta$ (Sox17 和 FoxA2 协同表达)\n\n对于一个给定的数据集，定型细胞的比例 $\\phi$ 是满足所有4个条件的细胞数除以总细胞数 $n$：\n$$\n\\phi = \\frac{1}{n} \\sum_{i=1}^{n} \\mathbf{1}\\{R_i \\ge 0.3, S_i \\ge 0.5, F_i \\ge 0.5, c_i \\le 0.25\\}\n$$\n其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。\n\n我们现在将此程序应用于所提供的 5 个测试用例。\n\n**测试用例 1**:\n表达向量为 $S = [\\,0.10, 0.20, 0.15, 0.12, 0.18, 0.20\\,]$ 和 $F = [\\,0.08, 0.22, 0.14, 0.10, 0.16, 0.18\\,]$。$S_i$ 和 $F_i$ 的所有值都低于最小阈值 $S_{\\min} = 0.5$ 和 $F_{\\min} = 0.5$。因此，没有细胞满足条件 $S_i \\ge 0.5$ 和 $F_i \\ge 0.5$。定型细胞的数量为 0。\n定型比例为 $\\phi_1 = 0/6 = 0.0$。\n\n**测试用例 2**:\n该数据集包含 $n=6$ 个细胞。我们逐个分析每个细胞：\n- 细胞 1、2 和 5 的 $S_i < 0.5$ 和 $F_i < 0.5$，不满足最低表达标准。它们未定型。\n- 细胞 3：$S_3=2.0, F_3=2.1, N_3=0.2$。所有四个条件都满足：$S_3 \\ge 0.5$、$F_3 \\ge 0.5$、$R_3 \\approx 1.31 \\ge 0.3$ 以及 $c_3 \\approx 0.024 \\le 0.25$。该细胞是定型的。\n- 细胞 4：$S_4=1.8, F_4=1.9, N_4=0.3$。所有四个条件都满足：$S_4 \\ge 0.5$、$F_4 \\ge 0.5$、$R_4 \\approx 1.09 \\ge 0.3$ 以及 $c_4 \\approx 0.027 \\le 0.25$。该细胞是定型的。\n- 细胞 6：$S_6=2.2, F_6=2.0, N_6=0.1$。所有四个条件都满足：$S_6 \\ge 0.5$、$F_6 \\ge 0.5$、$R_6 \\approx 1.62 \\ge 0.3$ 以及 $c_6 \\approx 0.048 \\le 0.25$。该细胞是定型的。\n6 个细胞中有 3 个是定型的。\n定型比例为 $\\phi_2 = 3/6 = 0.5$。\n\n**测试用例 3**:\n该数据集包含 $n=6$ 个细胞。我们逐个分析每个细胞：\n- 细胞 4 和 5 的 $S_i < 0.5$ 和 $F_i < 0.5$，不满足最低表达标准。它们未定型。\n- 细胞 1：$S_1=2.0, F_1=2.1, N_1=0.2$。如测试用例 2 所示，该细胞是定型的。\n- 细胞 2：$S_2=1.9, F_2=2.0, N_2=0.25$。所有四个条件都满足：$S_2 \\ge 0.5$、$F_2 \\ge 0.5$、$R_2 \\approx 1.19 \\ge 0.3$ 以及 $c_2 \\approx 0.026 \\le 0.25$。该细胞是定型的。\n- 细胞 3：$S_3=3.0, F_3=0.7, N_3=0.2$。该细胞通过了最低表达和对数比率条件（$R_3 \\approx 1.27 \\ge 0.3$），但不满足协同性标准：$c_3 = |3.0-0.7|/(3.0+0.7+\\delta) \\approx 0.622 > 0.25$。该细胞未定型。\n- 细胞 6：$S_6=2.1, F_6=2.05, N_6=0.15$。所有四个条件都满足：$S_6 \\ge 0.5$、$F_6 \\ge 0.5$、$R_6 \\approx 1.44 \\ge 0.3$ 以及 $c_6 \\approx 0.012 \\le 0.25$。该细胞是定型的。\n6 个细胞中有 3 个是定型的。\n定型比例为 $\\phi_3 = 3/6 = 0.5$。\n\n**测试用例 4**:\n该数据集包含 $n=6$ 个细胞。对于所有细胞，$S_i$ 和 $F_i$ 的值很高（接近 2.0），而 $N_i$ 的值很低（接近 0.2）。差值 $|S_i - F_i|$ 很小。\n- 所有细胞都满足 $S_i \\ge 0.5$ และ $F_i \\ge 0.5$。\n- 对所有细胞而言，比值 $(S_i+F_i+\\kappa)/(N_i+\\kappa)$ 很大，使得所有 $R_i > 0.3$。最小的 $R_i \\approx \\log_{10}((1.90+2.00+0.001)/(0.25+0.001)) \\approx 1.19 > 0.3$。\n- 对所有细胞而言，协同性得分 $c_i$ 很小。最大值为 $c_1 \\approx |2.1-2.0|/(2.1+2.0) \\approx 0.0244 \\le 0.25$。\n所有 6 个细胞都满足所有 4 个标准，被分类为定型。\n定型比例为 $\\phi_4 = 6/6 = 1.0$。\n\n**测试用例 5**:\n该数据集包含 $n=6$ 个细胞。此处，所有细胞的 $S_i=1.0$，而 $F_i \\approx 2.0$。\n- 所有细胞都满足 $S_i \\ge 0.5$ และ $F_i \\ge 0.5$。\n- 所有细胞也满足对数比率条件。最小的 $R_i \\approx \\log_{10}((1.0+2.05+0.001)/(0.32+0.001)) \\approx 0.98 > 0.3$。\n- 然而，所有细胞都不满足协同性标准。差值 $|S_i - F_i|$ 约为 1.0，而总和 $S_i+F_i$ 约为 3.0。协同性得分 $c_i \\approx 1.0/3.0 \\approx 0.333$，大于 $\\eta=0.25$。例如，对细胞 1，$c_1 = |1.0-2.0|/(1.0+2.0+\\delta) \\approx 0.333 > 0.25$。\n没有细胞满足协同性标准。定型细胞的数量为 0。\n定型比例为 $\\phi_5 = 0/6 = 0.0$。\n\n最终计算出的比例如下：$\\phi_1=0.0$, $\\phi_2=0.5$, $\\phi_3=0.5$, $\\phi_4=1.0$ 和 $\\phi_5=0.0$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the fraction of endoderm-committed cells for a suite of test cases\n    based on a defined quantitative classification criterion.\n    \"\"\"\n\n    test_cases = [\n        # (Sox17 expr, FoxA2 expr, Nanog expr)\n        # Test case 1 (low-dose, expected uncommitted)\n        (\n            [0.10, 0.20, 0.15, 0.12, 0.18, 0.20],\n            [0.08, 0.22, 0.14, 0.10, 0.16, 0.18],\n            [1.00, 0.90, 1.10, 1.20, 0.95, 1.05]\n        ),\n        # Test case 2 (intermediate dose, mixed state)\n        (\n            [0.10, 0.20, 2.00, 1.80, 0.15, 2.20],\n            [0.12, 0.25, 2.10, 1.90, 0.11, 2.00],\n            [1.20, 1.10, 0.20, 0.30, 1.30, 0.10]\n        ),\n        # Test case 3 (intermediate-high dose with imbalance edge case)\n        (\n            [2.00, 1.90, 3.00, 0.20, 0.15, 2.10],\n            [2.10, 2.00, 0.70, 0.22, 0.10, 2.05],\n            [0.20, 0.25, 0.20, 1.10, 1.20, 0.15]\n        ),\n        # Test case 4 (high dose, fully committed)\n        (\n            [2.10, 1.95, 2.05, 2.00, 1.90, 2.20],\n            [2.00, 2.05, 2.10, 1.95, 2.00, 2.15],\n            [0.10, 0.20, 0.15, 0.25, 0.18, 0.12]\n        ),\n        # Test case 5 (robustness to degenerate dispersion in one marker)\n        (\n            [1.00, 1.00, 1.00, 1.00, 1.00, 1.00],\n            [2.00, 1.90, 2.10, 2.05, 1.95, 2.00],\n            [0.30, 0.25, 0.28, 0.32, 0.26, 0.27]\n        )\n    ]\n\n    # Model constants and thresholds\n    kappa = 1e-3\n    delta = 1e-9\n    tau = 0.3\n    S_min = 0.5\n    F_min = 0.5\n    eta = 0.25\n\n    results = []\n    for s_expr, f_expr, n_expr in test_cases:\n        S = np.array(s_expr)\n        F = np.array(f_expr)\n        N = np.array(n_expr)\n        \n        num_cells = len(S)\n\n        if num_cells == 0:\n            results.append(0.0)\n            continue\n\n        # Condition 1: Log-ratio endoderm commitment index\n        R = np.log10((S + F + kappa) / (N + kappa))\n        cond1 = (R >= tau)\n        \n        # Condition 2: Sox17 expression threshold\n        cond2 = (S >= S_min)\n        \n        # Condition 3: FoxA2 expression threshold\n        cond3 = (F >= F_min)\n\n        # Condition 4: Marker-coherence score\n        c = np.abs(S - F) / (S + F + delta)\n        cond4 = (c <= eta)\n        \n        # A cell is committed if all four conditions hold\n        committed_mask = cond1 & cond2 & cond3 & cond4\n        \n        num_committed = np.sum(committed_mask)\n        \n        fraction_committed = num_committed / num_cells\n        results.append(fraction_committed)\n\n    # Format output as a comma-separated list of floats inside brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"}]}