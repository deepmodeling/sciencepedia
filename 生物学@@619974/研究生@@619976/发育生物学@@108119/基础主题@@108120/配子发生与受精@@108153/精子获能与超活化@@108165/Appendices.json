{"hands_on_practices": [{"introduction": "我们从精子获能途径的起点开始。本练习旨在探索碳酸氢根离子 ($[\\text{HCO}_3^-]$) 内流、随后的细胞内$\\text{pH}$值上升以及蛋白激酶A (PKA) 激活之间的关键联系。通过应用Henderson-Hasselbalch方程和一个简单的酶激活模型，您将量化这一初始环境信号是如何转化为强有力的细胞内信号的。[@problem_id:2675135]", "problem": "哺乳动物精子的获能过程涉及碳酸氢根离子的快速内流，这会提高细胞内pH值并通过可溶性腺苷酸环化酶（sAC）激活环磷酸腺苷（cAMP）信号通路，进而激活蛋白激酶A（PKA），最终促进精子超活化。考虑一个精子群体，它们处于二氧化碳分压 $p\\mathrm{CO}_{2}$ 恒定的培养基中。在获能过程中，细胞内碳酸氢根离子浓度从 $[\\text{HCO}_3^-]_1 = 5\\ \\text{mM}$ 增加到 $[\\text{HCO}_3^-]_2 = 25\\ \\text{mM}$，而 $p\\mathrm{CO}_{2}$ 和温度保持不变。该二氧化碳-碳酸氢盐缓冲系统可用 Henderson–Hasselbalch 关系式描述，在生理温度下，$\\text{CO}_2/\\text{HCO}_3^-$ 对的有效 $pK_a = 6.1$。\n\n1. 仅使用 $p\\mathrm{CO}_{2}$ 恒定（因此 Henderson–Hasselbalch 表达式中溶解的 $\\mathrm{CO}_{2}$ 项保持不变）的假设，推导出两种碳酸氢根离子浓度下细胞内pH值的变化量 $\\Delta\\text{pH} = \\text{pH}_2 - \\text{pH}_1$ 的表达式，并计算其数值。\n\n2. 为估算下游信号传导，假设可溶性腺苷酸环化酶（sAC）产生的稳态cAMP受碳酸氢根离子激活，该过程遵循Hill型关系，其中Hill系数 $n = 2$，半活化常数 $K = 15\\ \\mathrm{mM}$。并假设稳态蛋白激酶A（PKA）的活性与cAMP的产生量成正比。设归一化的PKA活性为 $A([\\text{HCO}_3^-]) = A_{\\max}\\,\\dfrac{[\\text{HCO}_3^-]^{n}}{K^{n} + [\\text{HCO}_3^-]^{n}}$。计算PKA活性的倍数变化，定义为 $F = \\dfrac{A(25\\ \\mathrm{mM})}{A(5\\ \\mathrm{mM})}$。\n\n将 $\\Delta\\text{pH}$ 和 $F$ 的最终答案一起以行向量 $\\bigl[\\Delta\\text{pH}\\ \\ F\\bigr]$ 的形式给出。将每个量四舍五入到三位有效数字。最终的方框答案中不要包含单位；注意这两个量都是无单位的。", "solution": "该问题已经过验证，被认定是有效的。它在科学上基于酸碱化学和酶动力学原理，问题陈述清晰且信息充分，内容客观。不存在矛盾或谬误。我们开始解题。\n\n该问题分为两部分。第一部分要求计算由碳酸氢根离子浓度增加引起的细胞内pH值变化量 $\\Delta\\text{pH}$。第二部分要求计算蛋白激酶A（PKA）活性的倍数变化 $F$。\n\n第一部分：计算 $\\Delta\\text{pH}$\n\n细胞内pH值由二氧化碳-碳酸氢盐缓冲系统调控，该系统可用 Henderson-Hasselbalch 方程描述：\n$$ \\text{pH} = pK_a + \\log_{10} \\left( \\frac{[\\text{HCO}_3^-]}{[\\text{H}_2\\text{CO}_3]} \\right) $$\n碳酸浓度 $[\\text{H}_2\\text{CO}_3]$ 与溶解在水中的二氧化碳 $[\\text{CO}_2]_{\\text{aq}}$处于平衡状态。根据 Henry 定律，溶解气体的浓度与其分压 $p\\mathrm{CO}_{2}$ 成正比。因此，$[\\text{H}_2\\text{CO}_3]$ 与 $p\\mathrm{CO}_{2}$ 成正比。题目说明 $p\\mathrm{CO}_{2}$ 保持恒定。因此，Henderson-Hasselbalch 方程中分母代表溶解二氧化碳物质浓度的项是恒定的。我们用 $C = [\\text{H}_2\\text{CO}_3]$ 表示这个恒定浓度。\n\n我们有两个状态：初始状态（下标为 $1$）和最终状态（下标为 $2$）。每个状态的pH值为：\n$$ \\text{pH}_1 = pK_a + \\log_{10} \\left( \\frac{[\\text{HCO}_3^-]_1}{C} \\right) $$\n$$ \\text{pH}_2 = pK_a + \\log_{10} \\left( \\frac{[\\text{HCO}_3^-]_2}{C} \\right) $$\npH的变化量 $\\Delta\\text{pH}$ 定义为 $\\text{pH}_2 - \\text{pH}_1$。\n$$ \\Delta\\text{pH} = \\text{pH}_2 - \\text{pH}_1 = \\left( pK_a + \\log_{10} \\left( \\frac{[\\text{HCO}_3^-]_2}{C} \\right) \\right) - \\left( pK_a + \\log_{10} \\left( \\frac{[\\text{HCO}_3^-]_1}{C} \\right) \\right) $$\n$pK_a$ 项相互抵消。使用对数恒等式 $\\log(a) - \\log(b) = \\log(a/b)$，我们合并对数项：\n$$ \\Delta\\text{pH} = \\log_{10} \\left( \\frac{[\\text{HCO}_3^-]_2}{C} \\right) - \\log_{10} \\left( \\frac{[\\text{HCO}_3^-]_1}{C} \\right) = \\log_{10} \\left( \\frac{[\\text{HCO}_3^-]_2/C}{[\\text{HCO}_3^-]_1/C} \\right) $$\n常数分母 $C$ 相互抵消，得到pH变化量的最终表达式：\n$$ \\Delta\\text{pH} = \\log_{10} \\left( \\frac{[\\text{HCO}_3^-]_2}{[\\text{HCO}_3^-]_1} \\right) $$\n我们已知初始和最终的碳酸氢根离子浓度：$[\\text{HCO}_3^-]_1 = 5\\ \\text{mM}$ 和 $[\\text{HCO}_3^-]_2 = 25\\ \\text{mM}$。注意，此计算不需要 $pK_a = 6.1$ 的值。\n代入数值：\n$$ \\Delta\\text{pH} = \\log_{10} \\left( \\frac{25}{5} \\right) = \\log_{10}(5) $$\n其数值计算结果为：\n$$ \\Delta\\text{pH} \\approx 0.69897 $$\n四舍五入到三位有效数字，我们得到 $\\Delta\\text{pH} \\approx 0.699$。\n\n第二部分：计算PKA活性的倍数变化 $F$\n\n归一化的PKA活性 $A$ 是碳酸氢根离子浓度 $[\\text{HCO}_3^-]$ 的函数，由一个Hill型方程给出：\n$$ A([\\text{HCO}_3^-]) = A_{\\max} \\frac{[\\text{HCO}_3^-]^{n}}{K^{n} + [\\text{HCO}_3^-]^{n}} $$\n倍数变化 $F$ 是最终活性与初始活性的比值：\n$$ F = \\frac{A([\\text{HCO}_3^-]_2)}{A([\\text{HCO}_3^-]_1)} $$\n代入 $A$ 的表达式：\n$$ F = \\frac{A_{\\max} \\dfrac{[\\text{HCO}_3^-]_2^{n}}{K^{n} + [\\text{HCO}_3^-]_2^{n}}}{A_{\\max} \\dfrac{[\\text{HCO}_3^-]_1^{n}}{K^{n} + [\\text{HCO}_3^-]_1^{n}}} $$\n最大活性 $A_{\\max}$ 是一个比例常数，可以消去：\n$$ F = \\frac{[\\text{HCO}_3^-]_2^{n}}{K^{n} + [\\text{HCO}_3^-]_2^{n}} \\cdot \\frac{K^{n} + [\\text{HCO}_3^-]_1^{n}}{[\\text{HCO}_3^-]_1^{n}} $$\n我们已知以下参数：Hill系数 $n = 2$，半活化常数 $K = 15\\ \\mathrm{mM}$，初始浓度 $[\\text{HCO}_3^-]_1 = 5\\ \\mathrm{mM}$，以及最终浓度 $[\\text{HCO}_3^-]_2 = 25\\ \\mathrm{mM}$。\n将这些值代入 $F$ 的表达式中。单位（$\\mathrm{mM}$）是一致的，将会抵消，因此我们可以直接使用数值。\n$$ F = \\frac{25^{2}}{15^{2} + 25^{2}} \\cdot \\frac{15^{2} + 5^{2}}{5^{2}} $$\n计算平方项：$5^{2} = 25$，$15^{2} = 225$，$25^{2} = 625$。\n$$ F = \\frac{625}{225 + 625} \\cdot \\frac{225 + 25}{25} $$\n$$ F = \\frac{625}{850} \\cdot \\frac{250}{25} $$\n$$ F = \\frac{625}{850} \\cdot 10 = \\frac{6250}{850} = \\frac{625}{85} $$\n将分子和分母同时除以 $5$ 来简化分数：\n$$ F = \\frac{125}{17} $$\n其数值计算结果为：\n$$ F \\approx 7.35294 $$\n四舍五入到三位有效数字，我们得到 $F \\approx 7.35$。\n\n最终答案要求将 $\\Delta\\text{pH}$ 和 $F$ 两个量以行向量的形式呈现。\n$\\Delta\\text{pH} \\approx 0.699$\n$F \\approx 7.35$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.699 & 7.35 \\end{pmatrix}}\n$$", "id": "2675135"}, {"introduction": "先前计算的细胞内碱化有一个主要目标：CatSper离子通道。本练习使用生物物理学中的一个基本工具——玻尔兹曼方程，来模拟pH值变化如何调节CatSper通道的电压依赖性激活。您将计算通道开放概率的倍数变化，从而将上游的pH信号与精子超活化的分子“看门人”的状态直接联系起来。[@problem_id:2675093]", "problem": "在获能过程中，哺乳动物精子经历细胞内碱化，这使其精子阳离子通道 (CatSper) 的电压依赖性发生左移，从而在给定的膜电位下增加了其开放概率。假设在所研究的温度和离子条件下，CatSper 的电压激活特性可以很好地用玻尔兹曼函数描述，\n$$\nP_{\\text{open}}(V)=\\frac{1}{1+\\exp\\!\\left(\\frac{V_{1/2}-V}{k}\\right)},\n$$\n其中 $V$ 是膜电位，$V_{1/2}$ 是半激活电压，$k$ 是斜率因子。在碱化前的静息条件下，当 $V=-40\\,\\mathrm{mV}$ 时，该通道在极低概率的尾部区域工作，因此 $\\exp\\!\\left(\\frac{V_{1/2}-(-40\\,\\mathrm{mV})}{k}\\right)\\gg 1$。碱化产生一个 $\\Delta V_{1/2}=-15\\,\\mathrm{mV}$ 的偏移（即 $V_{1/2}\\to V_{1/2}+\\Delta V_{1/2}$），而斜率因子 $k=8.0\\,\\mathrm{mV}$ 不受碱化影响。\n\n仅从上述玻尔兹曼形式和所述工作区间所证明的尾部近似出发，推导在 $V=-40\\,\\mathrm{mV}$ 时由于该偏移导致的开放概率的倍数变化表达式，其定义为 $R=\\frac{P_{\\text{open}}^{(\\text{alk})}}{P_{\\text{open}}^{(\\text{rest})}}$，并计算其数值。将 $R$ 作为无量纲数报告，并四舍五入到 $3$ 位有效数字。", "solution": "我们从玻尔兹曼激活函数开始\n$$\nP_{\\text{open}}(V)=\\frac{1}{1+\\exp\\!\\left(\\frac{V_{1/2}-V}{k}\\right)}.\n$$\n令 $P_{\\text{open}}^{(\\text{rest})}$ 表示在电压 $V$ 和半激活电压为 $V_{1/2}$ 时的开放概率，令 $P_{\\text{open}}^{(\\text{alk})}$ 表示碱化后的开放概率，此时半激活电压偏移至 $V_{1/2}+\\Delta V_{1/2}$。根据定义，\n$$\nP_{\\text{open}}^{(\\text{rest})}(V)=\\frac{1}{1+\\exp\\!\\left(\\frac{V_{1/2}-V}{k}\\right)},\\quad\nP_{\\text{open}}^{(\\text{alk})}(V)=\\frac{1}{1+\\exp\\!\\left(\\frac{V_{1/2}+\\Delta V_{1/2}-V}{k}\\right)}.\n$$\n因此，在相同电压 $V$ 下的倍数变化 $R$ 为\n$$\nR=\\frac{P_{\\text{open}}^{(\\text{alk})}(V)}{P_{\\text{open}}^{(\\text{rest})}(V)}=\\frac{1+\\exp\\!\\left(\\frac{V_{1/2}-V}{k}\\right)}{1+\\exp\\!\\left(\\frac{V_{1/2}+\\Delta V_{1/2}-V}{k}\\right)}.\n$$\n现在我们使用所述的工作区间：在碱化前，当 $V=-40\\,\\mathrm{mV}$ 时，通道处于极低概率尾部，这意味着\n$$\n\\exp\\!\\left(\\frac{V_{1/2}-V}{k}\\right)\\gg 1.\n$$\n在此条件下，对于 $x\\gg 1$，有 $1+\\exp(x)\\approx \\exp(x)$。由于 $\\Delta V_{1/2}=-15\\,\\mathrm{mV}$ 与此区间中 $V$ 到 $V_{1/2}$ 的距离相比是适度的，因此偏移后的状态也满足\n$$\n\\exp\\!\\left(\\frac{V_{1/2}+\\Delta V_{1/2}-V}{k}\\right)\\gg 1.\n$$\n因此，\n$$\nR\\approx \\frac{\\exp\\!\\left(\\frac{V_{1/2}-V}{k}\\right)}{\\exp\\!\\left(\\frac{V_{1/2}+\\Delta V_{1/2}-V}{k}\\right)}=\\exp\\!\\left(-\\frac{\\Delta V_{1/2}}{k}\\right).\n$$\n这表明，在低概率尾部，倍数变化仅取决于偏移量 $\\Delta V_{1/2}$ 和斜率因子 $k$，而与 $V_{1/2}$ 或 $V$ 的绝对值无关（只要尾部近似成立）。代入给定值 $\\Delta V_{1/2}=-15\\,\\mathrm{mV}$ 和 $k=8.0\\,\\mathrm{mV}$，\n$$\nR\\approx \\exp\\!\\left(-\\frac{-15\\,\\mathrm{mV}}{8.0\\,\\mathrm{mV}}\\right)=\\exp\\!\\left(\\frac{15}{8}\\right)=\\exp(1.875).\n$$\n计算 $\\exp(1.875)$ 得\n$$\nR\\approx 6.520819\\ldots\n$$\n四舍五入到 $3$ 位有效数字，倍数变化为\n$$\nR\\approx 6.52.\n$$", "answer": "$$\\boxed{6.52}$$", "id": "2675093"}, {"introduction": "理论模型固然强大，但其参数必须通过实验数据来确定。最后的这个练习将模拟一位生物物理学家的工作，要求您将玻尔兹曼模型与合成数据进行拟合，以提取我们在前一个练习中使用的关键参数。您将确定CatSper通道的门控特性（以 $V_{1/2}$ 为代表）对pH变化的响应有多敏感，这是理解其生理调节的关键参数。[@problem_id:2675116]", "problem": "一个双态热力学门控模型描述了精子特异性 CatSper 通道在获能过程中的开放概率。假设在闭合态和开放态之间存在一个双态平衡，其吉布斯自由能差 $\\Delta G(V, \\text{pH}_i)$ 线性依赖于膜电压 $V$，并受细胞内 pH ($\\text{pH}_i$) 调节。基本原理是，在热平衡状态下，状态占据率的比值遵循玻尔兹曼分布，其中\n$$\n\\Delta G(V,\\text{pH}_i) = \\Delta G_0(\\text{pH}_i) - z_g F V,\n$$\n此处 $z_g$ 是无量纲的有效门控电荷，$F$ 是法拉第常数，$\\Delta G_0(\\text{pH}_i)$ 是一个依赖于 $\\text{pH}_i$ 的基线能量差。开放概率由该双态系统在温度 $T$ 下的平衡通过玻尔兹曼定律确定。\n\n使用此物理基础推导一个适用于拟合的开放概率电压依赖性模型，然后将该模型拟合到在三种测试条件（标记为 A、B 和 C）下生成的数据。根据最佳拟合参数，计算每个 $\\text{pH}_i$ 对应的半激活电压 $V_{1/2}$，然后通过线性回归确定单位 $\\text{pH}_i$ 变化引起的 $V_{1/2}$ 偏移。以毫伏每 pH 单位报告斜率。\n\n使用的物理常数：\n- 普适气体常数：$R = 8.314462618 \\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 法拉第常数：$F = 96485.33212 \\,\\mathrm{C\\,mol^{-1}}$。\n- 绝对温度：$T = 310 \\,\\mathrm{K}$。\n\n电压网格（在数据生成和拟合中，所有电压均以毫伏表示）：$V \\in \\{-100,-75,-50,-25,0,25,50,75,100\\}$。\n\n建模和数据生成假设：\n- 假设模型为处于平衡状态的严格双态模型。\n- 仅为生成数据，假设所有三个条件下恒定的有效门控电荷 $z_g = 1$，以固定由温度和电荷决定的斜率因子。\n- 将斜率因子（单位为毫伏）定义为 $k = 1000 \\cdot \\frac{R T}{z_g F}$。\n- 对每个条件，将半激活电压的线性 $\\text{pH}_i$ 依赖性定义为：\n$$\nV_{1/2}(\\text{pH}_i) = V_{1/2}^{\\mathrm{ref}} + \\alpha \\cdot (\\text{pH}_i - \\text{pH}^{\\mathrm{ref}}),\n$$\n单位为毫伏，其中 $V_{1/2}^{\\mathrm{ref}}$ 和 $\\text{pH}^{\\mathrm{ref}}$ 是每个条件的参考值，$\\alpha$ 是单位 $\\text{pH}_i$ 对应的真实潜在 $V_{1/2}$ 偏移（单位为 $\\mathrm{mV}/\\mathrm{pH}$）。观测的开放概率数据是使用这些参数从平衡双态模型中确定性生成的，没有添加噪声。\n\n测试套件（三个独立条件）：\n- 条件 A (理想路径)：$\\text{pH}_i \\in \\{6.8, 7.0, 7.2, 7.4\\}$，$V_{1/2}^{\\mathrm{ref}} = -20 \\,\\mathrm{mV}$ (在 $\\text{pH}^{\\mathrm{ref}} = 7.0$ 时)，且 $\\alpha = -30 \\,\\mathrm{mV}/\\mathrm{pH}$。\n- 条件 B (边界情况，$\\text{pH}_i$ 点数最少)：$\\text{pH}_i \\in \\{7.2, 7.6\\}$，$V_{1/2}^{\\mathrm{ref}} = -10 \\,\\mathrm{mV}$ (在 $\\text{pH}^{\\mathrm{ref}} = 7.2$ 时)，且 $\\alpha = 10 \\,\\mathrm{mV}/\\mathrm{pH}$。\n- 条件 C (边缘情况，对 $\\text{pH}_i$ 不敏感)：$\\text{pH}_i \\in \\{6.9, 7.1, 7.3\\}$，$V_{1/2}^{\\mathrm{ref}} = -25 \\,\\mathrm{mV}$ (在 $\\text{pH}^{\\mathrm{ref}} = 7.1$ 时)，且 $\\alpha = 0 \\,\\mathrm{mV}/\\mathrm{pH}$。\n\n你的任务：\n- 基于上述双态热力学基础，推导电压-激活关系，并将其转换为一个适用于拟合的函数，其参数包括半激活电压 $V_{1/2}$ 和与温度及有效电荷一致的斜率因子。\n- 对每个条件和每个指定的 $\\text{pH}_i$，使用确定性的双态平衡模型和提供的条件参数，在电压网格上生成合成的开放概率数据。\n- 对每个 $\\text{pH}_i$，将推导出的模型拟合到生成的数据中，仅从数据估算 $V_{1/2}(\\text{pH}_i)$ 和斜率因子（在拟合过程中不假设其真实值）。\n- 对每个条件，对 $V_{1/2}(\\text{pH}_i)$ 与 $\\text{pH}_i$ 的关系进行线性最小二乘拟合，以估算单位 $\\Delta \\text{pH}_i$ 引起的 $V_{1/2}$ 偏移。\n- 将每个条件的最终斜率以 $\\mathrm{mV}/\\mathrm{pH}$ 为单位表示，并四舍五入到恰好三位小数（使用小数而非百分比）。\n\n最终输出格式：\n- 你的程序应产生单行输出，其中包含条件 A、B 和 C 的三个估算斜率（按此顺序），形式为用方括号括起来的逗号分隔列表，例如 `\"[x_A,x_B,x_C]\"`。\n- 单位：以 $\\mathrm{mV}/\\mathrm{pH}$ 报告斜率。\n- 本问题不涉及角度单位。\n\n科学真实性及解释要求：\n- 估算出的斜率的符号和大小应根据对 pH 敏感的门控残基的质子化进行物理解释。\n- 碱性偏移（$\\text{pH}_i$ 增加）导致 $V_{1/2}$ 减小（负斜率），这对应于通过去质子化稳定开放态；相反的符号则反映了对闭合态的相对稳定。\n\n本说明中的所有数字和变量均应按国际单位制（SI）标准处理，除非如上所述为电压明确指定了毫伏。确保程序的输出严格遵循指定的最终输出格式。", "solution": "问题陈述经过严格评估并被认定为有效。它在科学上基于统计热力学（玻尔兹曼分布）的原理，并将其应用于离子通道门控的生物物理模型，这是该领域的标准方法。该问题设定良好，提供了所有必要的常数、参数和清晰的任务序列，可导出一个唯一的、可验证的解。定义和约束是自洽、一致的，并以客观的语言表达。未发现科学、逻辑或结构上的缺陷。\n\n解决方案分为三个主要阶段：\n1. 从第一性原理推导适用于拟合的电压-激活模型。\n2. 计算模拟与分析：针对每个指定条件，生成合成数据，将模型拟合到此数据以估计参数，并执行最终的线性回归。\n3. 基于潜在的生物物理模型对结果进行解释。\n\n**1. 门控模型的推导**\n\n问题描述了一个通道的双态平衡模型，该通道可以存在于闭合态（$C$）或开放态（$O$）：\n$$ C \\rightleftharpoons O $$\n在热平衡状态下，处于开放态的概率 $P_O$ 与闭合态的概率 $P_C$ 之比由玻尔兹曼分布决定，该分布取决于两个状态之间的吉布斯自由能差 $\\Delta G$：\n$$ \\frac{P_O}{P_C} = \\exp\\left(-\\frac{\\Delta G}{RT}\\right) $$\n其中 $R$ 是普适气体常数，$T$ 是绝对温度。由于通道必须处于这两种状态之一，概率之和必须为一：$P_O + P_C = 1$。我们可以将 $P_C$ 表示为 $1 - P_O$ 并代入平衡方程：\n$$ \\frac{P_O}{1 - P_O} = \\exp\\left(-\\frac{\\Delta G}{RT}\\right) $$\n求解此方程得到开放概率 $P_O$，即 S 型玻尔兹曼函数：\n$$ P_O(V, \\text{pH}_i) = \\frac{1}{1 + \\exp\\left(\\frac{\\Delta G(V, \\text{pH}_i)}{RT}\\right)} $$\n问题指定自由能差 $\\Delta G$ 线性依赖于膜电压 $V$：\n$$ \\Delta G(V, \\text{pH}_i) = \\Delta G_0(\\text{pH}_i) - z_g F V $$\n此处，$z_g$ 是有效门控电荷，$F$ 是法拉第常数，$\\Delta G_0(\\text{pH}_i)$ 是零电压下的自由能差，该值受细胞内 pH，即 $\\text{pH}_i$ 的调节。\n\n为了创建一个适用于拟合的模型，我们用半激活电压 $V_{1/2}$ 来重新参数化该方程。这是指开放概率为 0.5 时的电压。在玻尔兹曼函数中设置 $P_O = 0.5$ 意味着指数的参数必须为零，即 $\\Delta G(V_{1/2}, \\text{pH}_i) = 0$。\n$$ \\Delta G_0(\\text{pH}_i) - z_g F V_{1/2} = 0 \\implies \\Delta G_0(\\text{pH}_i) = z_g F V_{1/2} $$\n将 $\\Delta G_0(\\text{pH}_i)$ 的这个表达式代回 $\\Delta G$ 的方程中：\n$$ \\Delta G(V, \\text{pH}_i) = z_g F V_{1/2} - z_g F V = z_g F (V_{1/2} - V) $$\n开放概率函数现在可以写成：\n$$ P_O(V) = \\frac{1}{1 + \\exp\\left(\\frac{z_g F (V_{1/2} - V)}{RT}\\right)} $$\n问题要求电压以毫伏（mV）表示。设 $V$ 和 $V_{1/2}$ 的单位为 mV。那么，为了与 $R$、$T$ 和 $F$ 的国际单位制（SI）单位保持一致，我们必须将它们转换为伏特（V）。以毫伏为单位的电压 $V_{\\text{mV}}$ 等于 $V_{\\text{mV}}/1000$ 伏特。指数的参数变为：\n$$ \\frac{z_g F ( (V_{1/2})_{\\text{mV}} - V_{\\text{mV}} ) / 1000}{RT} = \\frac{(V_{1/2})_{\\text{mV}} - V_{\\text{mV}}}{1000 \\cdot \\frac{RT}{z_g F}} $$\n我们将斜率因子 $k$（单位为毫伏）定义为 $k = 1000 \\cdot \\frac{RT}{z_g F}$。这就得到了玻尔兹曼模型的最终、适用于拟合的形式：\n$$ P_O(V) = \\frac{1}{1 + \\exp\\left(\\frac{V_{1/2} - V}{k}\\right)} $$\n其中 $V$、$V_{1/2}$ 和 $k$ 的单位均为 mV。需要通过拟合估计的参数是 $V_{1/2}$ 和 $k$。\n\n**2. 计算步骤**\n\n对每个实验条件（A、B、C），总体步骤包括三个阶段：\n\na. **数据生成**：使用每个条件提供的参数（$\\alpha$, $V_{1/2}^{\\mathrm{ref}}$, $\\text{pH}^{\\mathrm{ref}}$）以及每个指定的 $\\text{pH}_i$，我们首先计算“真实”的半激活电压 $V_{1/2}(\\text{pH}_i) = V_{1/2}^{\\mathrm{ref}} + \\alpha \\cdot (\\text{pH}_i - \\text{pH}^{\\mathrm{ref}})$。我们还计算“真实”的斜率因子 $k = 1000 \\cdot RT / (z_g F)$，其中 $z_g=1$。然后将这些值用于推导出的玻尔兹曼函数，以在提供的电压网格上生成确定性的开放概率数据 $P_O$。\n\nb. **参数估计**：对于每个生成的数据集（每个条件中的每个 $\\text{pH}_i$ 对应一个数据集），我们对 $(V, P_O)$ 数据进行玻尔兹曼模型的非线性最小二乘拟合。拟合过程估计参数 $V_{1/2}$ 和 $k$。由于数据无噪声且由相同模型生成，拟合预计能精确地恢复用于生成数据的真实参数。我们收集每个 $\\text{pH}_i$ 对应的拟合 $V_{1/2}$ 值。\n\nc. **线性回归**：对于每个条件，我们现在有了一组有序对 $(\\text{pH}_i, V_{1/2}^{\\text{fitted}})$。我们对此数据进行线性最小二乘回归，以拟合模型 $V_{1/2}^{\\text{fitted}} = m \\cdot \\text{pH}_i + c$。这条线的斜率 $m$ 就是所求的量：单位 pH 变化引起的半激活电压偏移，即 $\\Delta V_{1/2} / \\Delta \\text{pH}_i$。该值应等同于用于数据生成的参数 $\\alpha$。\n\n**3. 生物物理解释**\n\n斜率 $\\alpha = \\Delta V_{1/2} / \\Delta \\text{pH}_i$ 量化了通道电压依赖性门控的 pH 敏感性。其符号具有重要的生物物理意义：\n- **负斜率 ($\\alpha < 0$)**：$\\text{pH}_i$ 增加（碱化）导致 $V_{1/2}$ 减小（在电压轴上向左移动）。这表明在较高的 pH 下，通道需要较少的去极化即可打开。这意味着一个或多个对 pH 敏感的氨基酸残基（如组氨酸）的去质子化相对于闭合态稳定了开放态。\n- **正斜率 ($\\alpha > 0$)**：$\\text{pH}_i$ 增加导致 $V_{1/2}$ 增大（向右移动）。这意味着通道需要更多的去极化才能打开，暗示去质子化相对于开放态稳定了闭合态。\n- **零斜率 ($\\alpha = 0$)**：在测试范围内，通道的电压依赖性对 pH 变化不敏感。\n\n以下代码实现了此过程，以确定给定三个条件的斜率。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Derives gating parameters for the CatSper channel based on a two-state\n    thermodynamic model, fits the model to synthetic data, and determines\n    the pH-sensitivity of voltage gating.\n    \"\"\"\n    # Physical constants\n    R = 8.314462618  # J mol^-1 K^-1\n    F = 96485.33212   # C mol^-1\n    T = 310.0         # K\n\n    # Voltage grid (in mV) for data generation and fitting\n    V_grid = np.array([-100, -75, -50, -25, 0, 25, 50, 75, 100], dtype=float)\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {\n            \"ph_values\": [6.8, 7.0, 7.2, 7.4],\n            \"v_half_ref\": -20.0,\n            \"ph_ref\": 7.0,\n            \"alpha\": -30.0,\n        },\n        {\n            \"ph_values\": [7.2, 7.6],\n            \"v_half_ref\": -10.0,\n            \"ph_ref\": 7.2,\n            \"alpha\": 10.0,\n        },\n        {\n            \"ph_values\": [6.9, 7.1, 7.3],\n            \"v_half_ref\": -25.0,\n            \"ph_ref\": 7.1,\n            \"alpha\": 0.0,\n        },\n    ]\n\n    # Fit-ready Boltzmann function where V, v_half, and k are in mV\n    def boltzmann_model(V, v_half, k):\n        \"\"\"\n        Calculates open probability based on the Boltzmann distribution.\n        \"\"\"\n        # A small epsilon is added to the denominator to prevent division-by-zero\n        # in edge cases, though not strictly necessary with standard float precision.\n        return 1.0 / (1.0 + np.exp((v_half - V) / k))\n\n    # Gating charge for data generation, as specified\n    z_g_gen = 1.0\n\n    # Calculate the slope factor k for data generation (in mV)\n    k_gen = 1000.0 * (R * T) / (z_g_gen * F)\n    \n    results = []\n\n    for case in test_cases:\n        ph_vals = np.array(case[\"ph_values\"])\n        v_half_ref = case[\"v_half_ref\"]\n        ph_ref = case[\"ph_ref\"]\n        alpha = case[\"alpha\"]\n        \n        fitted_v_halfs = []\n\n        # For each pH value in the current condition...\n        for ph_i in ph_vals:\n            # 1. Generate synthetic data\n            # Calculate the \"true\" half-activation voltage for this pH_i\n            v_half_true = v_half_ref + alpha * (ph_i - ph_ref)\n            \n            # Generate deterministic open probability data across the voltage grid\n            p_open_data = boltzmann_model(V_grid, v_half_true, k_gen)\n            \n            # 2. Fit the model to the generated data\n            # Since data is ideal, initial guesses (p0) are not critical but can aid convergence.\n            p0 = [v_half_true, k_gen]  # Use true values as perfect initial guess\n            \n            # Use non-linear least squares to find the best-fit V_1/2 and k\n            params, _ = curve_fit(boltzmann_model, V_grid, p_open_data, p0=p0)\n            \n            v_half_fit = params[0]\n            fitted_v_halfs.append(v_half_fit)\n            \n        # 3. Perform linear regression of V_1/2 vs. pH\n        # Fit V_1/2 = slope * pH + intercept to find the sensitivity (slope)\n        slope, _, _, _, _ = linregress(ph_vals, fitted_v_halfs)\n        \n        results.append(slope)\n\n    # Format the final output as a comma-separated list in brackets,\n    # with each slope rounded to exactly three decimal places.\n    formatted_results = map(lambda s: f\"{s:.3f}\", results)\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2675116"}]}