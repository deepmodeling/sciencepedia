{"hands_on_practices": [{"introduction": "基因表达本质上是一个随机过程，会导致细胞内蛋白质水平的波动，即“噪音”。负反馈自动调节是基因调控网络中最常见的模体之一，它在维持细胞功能稳健性方面起着至关重要的作用。本练习将指导你使用线性噪音近似（Linear Noise Approximation, LNA）这一强大的分析工具，定量推导负反馈强度如何影响基因表达的噪音水平，从而揭示这一基本网络模体抑制噪音的内在机理。[@problem_id:2665268]", "problem": "考虑一个单基因负自动调控模块，其中蛋白质 $X$ 通过与其启动子结合来抑制其自身的合成。设蛋白质的有效合成倾向为 $b(x) = \\dfrac{\\alpha}{1 + x/K}$，其中 $x$ 是蛋白质拷贝数，$\\alpha$ 是最大合成速率，而 $K$ 是半抑制常数。蛋白质以一阶速率 $\\gamma$ 被降解和稀释，因此损失倾向为 $d(x) = \\gamma x$。假设启动子转换相对于蛋白质寿命而言是快速的，因此 $b(x)$ 是对转录调控的一个很好的单变量粗粒化，并假设内源性涨落主要由合成和降解的散粒噪声主导。\n\n从标准的生灭过程化学主方程出发，并使用线性噪声近似（LNA）进行近似（线性噪声近似（LNA）是系统大小的一阶展开，它给出了围绕确定性不动点的微小涨落的奥恩斯坦-乌伦贝克过程），完成以下任务：\n\n1. 令 $\\bar{x}$ 表示满足 $b(\\bar{x}) = \\gamma \\bar{x}$ 的确定性稳态平均值。将漂移项在 $\\bar{x}$ 附近线性化，并使用一维生灭过程的 LNA，推导出稳态方差 $\\operatorname{Var}(X)$，用 $b'(\\bar{x})$、$\\gamma$ 和 $\\bar{x}$ 表示。由此，求出变异系数 $\\operatorname{CV} = \\sqrt{\\operatorname{Var}(X)}/\\bar{x}$。\n\n2. 将稳态下的无量纲反馈强度定义为 $\\lambda \\equiv -\\dfrac{b'(\\bar{x})}{\\gamma}$。将你在步骤1中得到的 $\\operatorname{CV}$ 表示为 $\\lambda$ 和 $\\bar{x}$ 的函数。\n\n3. 在许多实验中，人们会调节最大合成速率 $\\alpha$ 作为 $\\lambda$ 的函数，以保持平均蛋白质水平在不同反馈条件下恒定。假设调整 $\\alpha$ 使得 $\\bar{x} = \\mu$ 保持固定（与 $\\lambda$ 无关）。在此约束下，计算稳态变异系数 $\\operatorname{CV}$ 作为反馈强度 $\\lambda$ 和目标平均值 $\\mu$ 的函数的闭式表达式。将最终答案表示为单个简化的符号表达式。无需四舍五入。变异系数是无量纲的，不需要单位。", "solution": "我们从蛋白质生灭动力学的标准模型开始，其状态依赖的合成速率为 $b(x)$，一阶损失速率为 $d(x) = \\gamma x$。确定性平均场动力学为\n$$\n\\frac{dx}{dt} = b(x) - \\gamma x.\n$$\n确定性稳态 $\\bar{x}$ 满足\n$$\nb(\\bar{x}) = \\gamma \\bar{x}.\n$$\n\n一维生灭系统的线性噪声近似（LNA）：令 $\\delta x = x - \\bar{x}$ 表示与稳态的微小偏差。将漂移项线性化得到\n$$\n\\frac{d}{dt}\\,\\delta x = \\left(b'(\\bar{x}) - \\gamma\\right)\\delta x + \\eta(t),\n$$\n其中 $\\eta(t)$ 是均值为零的高斯白噪声，其强度由稳态下所有倾向之和设定。对于生灭过程，扩散系数等于稳态倾向之和，\n$$\nD = b(\\bar{x}) + \\gamma \\bar{x} = 2\\gamma \\bar{x},\n$$\n因为在稳态下 $b(\\bar{x}) = \\gamma \\bar{x}$。因此，线性化的随机动力学是一个奥恩斯坦-乌伦贝克过程：\n$$\nd(\\delta x) = A\\,\\delta x\\,dt + \\sqrt{2\\gamma \\bar{x}}\\,dW_t,\n$$\n其中 $A = b'(\\bar{x}) - \\gamma$ 且 $W_t$ 是一个标准维纳过程。\n\n对于一个奥恩斯坦-乌伦贝克过程 $dY = A Y\\,dt + \\sigma\\, dW_t$，当 $A<0$ 时，其平稳方差为 $\\operatorname{Var}(Y) = \\dfrac{\\sigma^{2}}{-2A}$。将此应用于 $\\delta x$ 可得\n$$\n\\operatorname{Var}(X) = \\frac{2\\gamma \\bar{x}}{-2\\left(b'(\\bar{x}) - \\gamma\\right)} = \\frac{\\gamma \\bar{x}}{\\gamma - b'(\\bar{x})}.\n$$\n因此变异系数为\n$$\n\\operatorname{CV} \\equiv \\frac{\\sqrt{\\operatorname{Var}(X)}}{\\bar{x}} = \\sqrt{\\frac{\\gamma}{\\left(\\gamma - b'(\\bar{x})\\right)\\bar{x}}}.\n$$\n\n接下来，定义无量纲反馈强度\n$$\n\\lambda \\equiv -\\frac{b'(\\bar{x})}{\\gamma}.\n$$\n注意，稳定性要求 $A = b'(\\bar{x}) - \\gamma < 0$，即 $\\gamma - b'(\\bar{x}) > 0$，当 $\\gamma > 0$ 时，这等价于 $1 + \\lambda > 0$。使用 $\\lambda$ 的定义，\n$$\n\\gamma - b'(\\bar{x}) = \\gamma\\left(1 + \\lambda\\right).\n$$\n因此，\n$$\n\\operatorname{CV}^{2} = \\frac{\\gamma}{\\left(\\gamma - b'(\\bar{x})\\right)\\bar{x}} = \\frac{1}{\\left(1 + \\lambda\\right)\\bar{x}},\n$$\n以及\n$$\n\\operatorname{CV} = \\frac{1}{\\sqrt{\\left(1 + \\lambda\\right)\\bar{x}}}.\n$$\n\n现在，我们特化到负自动调控的希尔（Hill）合成函数 $b(x) = \\dfrac{\\alpha}{1 + x/K}$。对于此模型，可以计算出 $\\lambda$ 和 $\\bar{x}$ 之间的显式关系：\n$$\nb'(\\bar{x}) = -\\frac{\\alpha}{K\\left(1 + \\bar{x}/K\\right)^{2}}, \\quad \\text{所以} \\quad \\lambda = -\\frac{b'(\\bar{x})}{\\gamma} = \\frac{\\alpha}{\\gamma K\\left(1 + \\bar{x}/K\\right)^{2}}.\n$$\n等价地，使用 $b(\\bar{x}) = \\gamma \\bar{x} = \\dfrac{\\alpha}{1 + \\bar{x}/K}$，可得\n$$\n\\lambda = \\frac{\\bar{x}}{K + \\bar{x}} \\in [0,1).\n$$\n从这个恒等式， $1 - \\lambda = \\dfrac{K}{K + \\bar{x}} = \\dfrac{1}{1 + \\bar{x}/K}$，这给出了一个特别方便的稳态关系\n$$\n\\alpha\\left(1 - \\lambda\\right) = \\gamma \\bar{x}.\n$$\n\n在许多实验中，人们调整 $\\alpha$ 作为 $\\lambda$ 的函数，以将平均蛋白质水平固定在目标值 $\\bar{x} = \\mu$。在这个约束下，变异系数的表达式变为\n$$\n\\operatorname{CV}^{2} = \\frac{1}{\\left(1 + \\lambda\\right)\\mu},\n$$\n因此\n$$\n\\operatorname{CV} = \\frac{1}{\\sqrt{\\left(1 + \\lambda\\right)\\mu}}.\n$$\n这明确表明，增加负反馈强度（即增大 $\\lambda$）会通过乘法因子 $\\left(1 + \\lambda\\right)^{-1/2}$ 在固定平均值 $\\mu$ 的情况下降低变异系数。\n\n因此，所要求的作为反馈强度 $\\lambda$ 的函数（平均值固定为 $\\mu$）的变异系数的闭式表达式为\n$$\n\\operatorname{CV}(\\lambda) = \\frac{1}{\\sqrt{\\left(1 + \\lambda\\right)\\mu}}.\n$$", "answer": "$$\\boxed{\\frac{1}{\\sqrt{(1+\\lambda)\\mu}}}$$", "id": "2665268"}, {"introduction": "虽然噪音通常被视为需要抑制的干扰，但在发育过程中，它也是驱动细胞命运决定的关键因素。本练习探讨了经典的基因“拨动开关”（toggle switch），这是一个由两个相互抑制的基因组成的双稳态回路，是模拟谱系分化的典范。你将通过建立一个随机微分方程模型，来计算在一个微小的不对称性偏好下，内在的基因表达噪音如何驱动一个“犹豫不决”的祖细胞以一定的概率走向两种不同命运中的一种。[@problem_id:2665202]", "problem": "双潜能祖细胞中的一个典型发育决策可由一个遗传拨动开关控制，其中两个转录因子 $A$ 和 $B$ 相互抑制。考虑以下确定性平均场动力学：\n$$\n\\frac{dA}{dt} = \\frac{\\alpha_A}{1 + \\left(\\frac{B}{K}\\right)^{n}} - \\beta A,\\qquad\n\\frac{dB}{dt} = \\frac{\\alpha_B}{1 + \\left(\\frac{A}{K}\\right)^{n}} - \\beta B,\n$$\n其中希尔系数 $n \\ge 2$，解离常数 $K>0$，蛋白质降解率 $\\beta>0$。最大产率略有不对称：\n$$\n\\alpha_A = \\alpha(1+\\delta),\\qquad \\alpha_B = \\alpha(1-\\delta),\n$$\n其中 $0<|\\delta|\\ll 1$ 且基线 $\\alpha>0$。在对称极限 $\\delta=0$下，系统存在一个对称点 $A=B=A^{*}$，由下式隐式定义：\n$$\n\\frac{\\alpha}{1 + \\left(\\frac{A^{*}}{K}\\right)^{n}} = \\beta A^{*}.\n$$\n由有限蛋白质拷贝数引起的内在基因表达噪声，可以在对称点附近沿着不稳定的决策坐标 $x \\equiv \\frac{A-B}{2}$，通过一个一维随机微分方程（SDE）进行建模：\n$$\ndx = \\varepsilon\\, dt + \\sqrt{2D}\\, dW_t,\n$$\n其中 $D>0$ 是一个捕捉内禀涨落的有效扩散系数，$W_t$ 是一个标准维纳过程。产率的微小不对称性沿着 $x$ 产生一个恒定的漂移偏置 $\\varepsilon$，其主导阶与 $\\delta$ 呈线性关系，即 $\\varepsilon = \\kappa\\, \\delta$，其中 $\\kappa>0$ 取决于在 $A^{*}$ 附近确定性向量场在 $x$ 上的投影。当 $x$ 首次到达 $+L$ 时，认为细胞定型为谱系 $A$；当 $x$ 首次到达 $-L$ 时，认为细胞定型为谱系 $B$；其中 $L>0$ 是沿 $x$ 的定型阈值。假设祖细胞从不确定的状态 $x(0)=0$ 开始。\n\n请仅使用应用于基因调控网络的随机过程基本原理，推导两个谱系定型概率 $p_A$ 和 $p_B$ 作为 $\\delta$、 $D$、 $L$ 和 $\\kappa$ 的函数的闭式表达式。该表达式需在 $|\\delta|$ 的主导阶上有效，但对 $D$ 和 $L$ 是非微扰的。你可以用一个常数 $\\kappa$ 来表示最终结果。如果你选择将 $\\kappa$ 与开关的生化参数联系起来，你可以使用由在 $A^{*}$ 附近进行线性化得到的主导阶关系式 $\\kappa=\\beta A^{*}$，其中 $A^{*}$ 的定义如上。请以单一解析表达式的形式给出这两个概率。不需要四舍五入，概率也不应报告单位。", "solution": "该问题陈述提出了一个基于理论系统生物学和随机过程原理的、适定且有效的问题。它要求计算一个双潜能祖细胞的定型概率，该细胞的命运由一个遗传拨动开关控制。决策变量 $x \\equiv \\frac{A-B}{2}$ 的动力学由一个描述有偏维纳过程的一维伊藤随机微分方程（SDE）近似。\n\n该 SDE 如下：\n$$ dx = \\varepsilon\\, dt + \\sqrt{2D}\\, dW_t $$\n其中 $x(t)$ 表示细胞在时间 $t$ 时沿决策坐标的状态。祖细胞从一个不确定的状态 $x(0) = 0$ 开始。微小、恒定的漂移项 $\\varepsilon = \\kappa \\delta$ 表示由于产率不对称性而导致的朝向某一谱系的偏倚，其中 $|\\delta| \\ll 1$。项 $\\sqrt{2D}\\, dW_t$ 模拟了内禀噪声，其中 $D > 0$ 是有效扩散系数，$W_t$ 是一个标准维纳过程。\n\n当过程 $x(t)$ 首次到达吸收边界 $x = +L$ 时，细胞定型为谱系 $A$。当它首次到达吸收边界 $x = -L$ 时，细胞定型为谱系 $B$。因此，问题转化为求一个从 $x_0=0$ 出发的粒子通过边界 $+L$ 或 $-L$ 离开区间 $[-L, L]$ 的概率。这是一个经典的首次穿越问题。\n\n设 $p_A(x)$ 为从 $x$ 开始的随机过程在到达 $-L$ 之前先到达 $+L$ 的概率。这个概率，被称为分裂概率或定型函数（committor function），满足稳态后向科尔莫戈罗夫方程。对于一个一般的时齐伊藤过程 $dX_t = \\mu(X_t) dt + \\sigma(X_t) dW_t$，其在区间 $[a, b]$ 右边界退出的定型函数 $p(x)$ 满足以下二阶常微分方程（ODE）：\n$$ \\mu(x) \\frac{dp}{dx} + \\frac{1}{2}\\sigma(x)^2 \\frac{d^2p}{dx^2} = 0 $$\n边界条件由边界的性质决定：从目标边界出发保证成功，所以 $p(b)=1$；而从另一个边界出发保证失败，所以 $p(a)=0$。\n\n对于本问题，漂移是常数 $\\mu(x) = \\varepsilon$，扩散项也是常数 $\\sigma(x) = \\sqrt{2D}$，这意味着 $\\sigma(x)^2 = 2D$。区间是 $[-L, L]$。因此， $p_A(x)$ 的控制性 ODE 是：\n$$ \\varepsilon \\frac{dp_A}{dx} + D \\frac{d^2p_A}{dx^2} = 0 $$\n边界条件为 $p_A(L) = 1$ 和 $p_A(-L) = 0$。\n\n这是一个线性、二阶、齐次、常系数的常微分方程。其通解形式为：\n$$ p_A(x) = C_1 + C_2 \\exp\\left(-\\frac{\\varepsilon}{D}x\\right) $$\n其中 $C_1$ 和 $C_2$ 是待由边界条件确定的常数。\n\n应用在 $x=-L$ 处的边界条件：\n$$ p_A(-L) = 0 \\implies C_1 + C_2 \\exp\\left(-\\frac{\\varepsilon}{D}(-L)\\right) = C_1 + C_2 \\exp\\left(\\frac{\\varepsilon L}{D}\\right) = 0 $$\n应用在 $x=L$ 处的边界条件：\n$$ p_A(L) = 1 \\implies C_1 + C_2 \\exp\\left(-\\frac{\\varepsilon}{D}L\\right) = 1 $$\n\n我们得到了一个关于 $C_1$ 和 $C_2$ 的二元线性方程组。由第一个方程，我们得到 $C_1 = -C_2 \\exp\\left(\\frac{\\varepsilon L}{D}\\right)$。将此代入第二个方程：\n$$ -C_2 \\exp\\left(\\frac{\\varepsilon L}{D}\\right) + C_2 \\exp\\left(-\\frac{\\varepsilon L}{D}\\right) = 1 $$\n$$ C_2 \\left(\\exp\\left(-\\frac{\\varepsilon L}{D}\\right) - \\exp\\left(\\frac{\\varepsilon L}{D}\\right)\\right) = 1 $$\n这得到：\n$$ C_2 = \\frac{1}{\\exp\\left(-\\frac{\\varepsilon L}{D}\\right) - \\exp\\left(\\frac{\\varepsilon L}{D}\\right)} $$\n对于 $C_1$：\n$$ C_1 = -\\frac{\\exp\\left(\\frac{\\varepsilon L}{D}\\right)}{\\exp\\left(-\\frac{\\varepsilon L}{D}\\right) - \\exp\\left(\\frac{\\varepsilon L}{D}\\right)} = \\frac{\\exp\\left(\\frac{\\varepsilon L}{D}\\right)}{\\exp\\left(\\frac{\\varepsilon L}{D}\\right) - \\exp\\left(-\\frac{\\varepsilon L}{D}\\right)} $$\n将这些常数代回 $p_A(x)$ 的通解：\n$$ p_A(x) = \\frac{\\exp\\left(\\frac{\\varepsilon L}{D}\\right)}{\\exp\\left(\\frac{\\varepsilon L}{D}\\right) - \\exp\\left(-\\frac{\\varepsilon L}{D}\\right)} + \\frac{\\exp\\left(-\\frac{\\varepsilon x}{D}\\right)}{\\exp\\left(-\\frac{\\varepsilon L}{D}\\right) - \\exp\\left(\\frac{\\varepsilon L}{D}\\right)} $$\n$$ p_A(x) = \\frac{\\exp\\left(\\frac{\\varepsilon L}{D}\\right) - \\exp\\left(-\\frac{\\varepsilon x}{D}\\right)}{\\exp\\left(\\frac{\\varepsilon L}{D}\\right) - \\exp\\left(-\\frac{\\varepsilon L}{D}\\right)} $$\n问题陈述祖细胞从 $x(0)=0$ 开始。因此，定型为谱系A的概率，我们简记为 $p_A$，就是 $p_A(0)$：\n$$ p_A = p_A(0) = \\frac{\\exp\\left(\\frac{\\varepsilon L}{D}\\right) - \\exp(0)}{\\exp\\left(\\frac{\\varepsilon L}{D}\\right) - \\exp\\left(-\\frac{\\varepsilon L}{D}\\right)} = \\frac{\\exp\\left(\\frac{\\varepsilon L}{D}\\right) - 1}{\\exp\\left(\\frac{\\varepsilon L}{D}\\right) - \\exp\\left(-\\frac{\\varepsilon L}{D}\\right)} $$\n由于定型是谱系 A 和谱系 B 之间的二元选择，它们的概率之和必须为1：$p_A + p_B = 1$。因此，定型为谱系 B 的概率 $p_B$ 是：\n$$ p_B = 1 - p_A = 1 - \\frac{\\exp\\left(\\frac{\\varepsilon L}{D}\\right) - 1}{\\exp\\left(\\frac{\\varepsilon L}{D}\\right) - \\exp\\left(-\\frac{\\varepsilon L}{D}\\right)} = \\frac{\\left(\\exp\\left(\\frac{\\varepsilon L}{D}\\right) - \\exp\\left(-\\frac{\\varepsilon L}{D}\\right)\\right) - \\left(\\exp\\left(\\frac{\\varepsilon L}{D}\\right) - 1\\right)}{\\exp\\left(\\frac{\\varepsilon L}{D}\\right) - \\exp\\left(-\\frac{\\varepsilon L}{D}\\right)} $$\n$$ p_B = \\frac{1 - \\exp\\left(-\\frac{\\varepsilon L}{D}\\right)}{\\exp\\left(\\frac{\\varepsilon L}{D}\\right) - \\exp\\left(-\\frac{\\varepsilon L}{D}\\right)} $$\n问题指明，漂移 $\\varepsilon$ 在主导阶上由不对称性 $\\delta$ 产生，即 $\\varepsilon = \\kappa \\delta$。将此代入 $p_A$ 和 $p_B$ 的表达式，便得到以给定参数 $\\delta$、 $D$、 $L$ 和 $\\kappa$ 为函数的最终结果。问题陈述说，所需的表达式应“在 $|\\delta|$ 的主导阶上有效，但对 $D$ 和 $L$ 是非微扰的”。这意味着我们应该使用已经是 $\\delta$ 的主导阶近似的SDE，但不应该对所得概率在参数组 $\\frac{\\kappa \\delta L}{D}$ 中进行后续的泰勒展开，因为这会隐含地假设 $\\frac{\\kappa L}{D}$ 是1阶的，从而违背了对 $L$ 和 $D$ 的非微扰要求。推导出的表达式是所指定SDE模型的精确解。与生化参数的可选关联 $\\kappa = \\beta A^*$ 仅为 $\\kappa$ 提供了一个微观解释，但并不改变概率的数学形式。\n\n这两个概率是：\n$$ p_A = \\frac{\\exp\\left(\\frac{\\kappa \\delta L}{D}\\right) - 1}{\\exp\\left(\\frac{\\kappa \\delta L}{D}\\right) - \\exp\\left(-\\frac{\\kappa \\delta L}{D}\\right)} $$\n$$ p_B = \\frac{1 - \\exp\\left(-\\frac{\\kappa \\delta L}{D}\\right)}{\\exp\\left(\\frac{\\kappa \\delta L}{D}\\right) - \\exp\\left(-\\frac{\\kappa \\delta L}{D}\\right)} $$\n这些就是所要求的定型概率的闭式表达式。", "answer": "$$ \\boxed{\n\\begin{pmatrix}\n\\frac{\\exp\\left(\\frac{\\kappa \\delta L}{D}\\right) - 1}{\\exp\\left(\\frac{\\kappa \\delta L}{D}\\right) - \\exp\\left(-\\frac{\\kappa \\delta L}{D}\\right)} & \\frac{1 - \\exp\\left(-\\frac{\\kappa \\delta L}{D}\\right)}{\\exp\\left(\\frac{\\kappa \\delta L}{D}\\right) - \\exp\\left(-\\frac{\\kappa \\delta L}{D}\\right)}\n\\end{pmatrix}\n} $$", "id": "2665202"}, {"introduction": "理论模型只有在能够解释和预测实验数据时才显示出其强大的威力。本练习将理论与当今生物学研究的前沿——单细胞数据分析——联系起来。你将基于转录的“电报模型”，编写一个程序来模拟单细胞mRNA计数数据，并分析这些数据，通过噪音与均值的标度关系来推断基因表达水平的变化主要是由转录爆发的频率调控还是大小调控。这项实践将使你掌握一项核心技能：如何从静态的单细胞快照中解读动态的基因调控策略。[@problem_id:2665250]", "problem": "给定一个在单细胞水平上描述基因表达的力学和统计学框架，该框架基于发育生物学和系统生物学中广泛接受的转录爆发双态（电报）模型。在此模型中，启动子在非激活态和激活态之间交替转换。当启动子处于激活态时，转录本以恒定速率产生，并以一级速率常数降解。在与爆发式转录一致的时间尺度分离机制下，每个细胞中信使核糖核酸 (mRNA) 拷贝数的稳态分布可以表示为一个 Poisson 随机变量，其速率参数本身服从 Gamma 分布（即 Gamma-Poisson 混合），这等价于一个负二项 (NB) 分布。将爆发频率表示为 $f$（每个 mRNA 生命周期内的爆发次数），平均爆发大小表示为 $b$（每次启动子激活产生的 mRNA 数量），mRNA 降解速率表示为 $\\gamma$。在此表示中，Gamma 分布的形状参数为 $\\alpha = f/\\gamma$，尺度参数为 $\\beta = b$，稳态平均 mRNA 为 $\\mu = \\alpha \\beta$。您可以假设分子生物学的中心法则以及转录和降解的质量作用动力学成立。您也可以假设在爆发机制下稳态 mRNA 分布的负二项表示法以及 Gamma-Poisson 混合构造的有效性成立。\n\n您的任务是编写一个完整的、可运行的程序，该程序为多个合成实验中的每一个，使用单细胞数据拟合一个缩放指数，该指数关联了不同实验条件下的超泊松噪声项与均值，然后使用该指数来检验不同条件下均值的变化主要是由爆发频率调制还是爆发大小调制驱动的。程序必须使用固定的随机种子，通过 Gamma-Poisson 混合模型模拟单细胞 mRNA 计数，计算每个条件的样本均值和方差，通过对数线性回归估计缩放指数，并根据该指数对驱动机制进行分类。\n\n基本原理：\n- 中心法则：脱氧核糖核酸 (DNA) 转录为 mRNA，mRNA 翻译为蛋白质；此处我们关注 mRNA。\n- 双态启动子模型（电报模型），包含爆发频率 $f$、爆发大小 $b$ 和 mRNA 降解速率 $\\gamma$。\n- 在爆发条件下，细胞间的稳态 mRNA 计数服从通过形状参数为 $\\alpha = f/\\gamma$ 和尺度参数为 $\\beta = b$ 的 Gamma-Poisson 混合得到的负二项分布；其均值为 $\\mu = \\alpha \\beta$，方差为 Poisson 方差与一个超泊松项之和。\n\n待执行的计算：\n1. 对于每个测试用例，使用 Gamma-Poisson 混合为多个条件模拟单细胞计数：\n   - 对每个条件 $j$，从 Gamma 分布 $\\lambda_{j,i} \\sim \\mathrm{Gamma}(\\text{shape}=\\alpha_j, \\text{scale}=\\beta_j)$ 中抽取 $N$ 个独立同分布的 Gamma 随机变量，其中 $\\alpha_j = f_j/\\gamma$ 且 $\\beta_j = b_j$。\n   - 然后，对每个 $\\lambda_{j,i}$，从 Poisson 分布 $X_{j,i} \\sim \\mathrm{Poisson}(\\lambda_{j,i})$ 中抽取一个样本，以获得单细胞 mRNA 计数。\n2. 对每个条件，计算样本均值 $\\hat{\\mu}_j$ 和样本方差 $\\widehat{\\mathrm{Var}}_j$（使用除数为 $N$ 的总体方差，而非无偏估计量）。\n3. 在一个测试用例的所有条件中，估计一个缩放指数 $\\hat{\\beta}$，使得超泊松噪声项 $E_j = \\widehat{\\mathrm{Var}}_j - \\hat{\\mu}_j$ 与 $\\hat{\\mu}_j$ 的关系近似为 $E_j \\propto \\hat{\\mu}_j^{\\hat{\\beta}}$。通过对数据点 $\\left(\\log \\hat{\\mu}_j, \\log E_j\\right)$ 进行最小二乘线性拟合，将拟合直线的斜率作为 $\\hat{\\beta}$ 的估计值，其中使用自然对数。从拟合中排除任何 $E_j \\le 0$ 或 $\\hat{\\mu}_j \\le 0$ 的条件；确保至少保留 3 个点以进行可靠的拟合。\n4. 使用估计的指数对均值变化的主要驱动因素进行分类：\n   - 如果 $|\\hat{\\beta} - 1| \\le 0.25$（与频率调制主导一致），则返回整数 $1$。\n   - 如果 $|\\hat{\\beta} - 2| \\le 0.25$（与大小调制主导一致），则返回整数 $2$。\n   - 否则返回整数 $0$（混合或不确定）。\n\n角度单位不适用。由于计数是无量纲的，因此不需要物理单位。\n\n在程序中实现的测试套件，为保证可复现性，使用固定的随机种子 $12345$。在所有情况下，每个条件使用 $N = 20000$ 个细胞，且 $\\gamma = 1$。\n- 情况 A（频率调制）：恒定爆发大小 $b = 3$，爆发频率向量 $f \\in \\{0.5, 1.0, 2.0, 4.0\\}$。\n- 情况 B（大小调制）：恒定爆发频率 $f = 1.5$，爆发大小向量 $b \\in \\{1, 2, 4, 8\\}$。\n- 情况 C（混合）：爆发频率向量 $f \\in \\{0.5, 1.0, 2.0, 4.0\\}$，爆发大小向量 $b \\in \\{1.0, 1.5, 2.3, 3.5\\}$。\n- 情况 D（类似 Poisson 的边界，具有非常小的爆发，频率调制）：恒定爆发大小 $b = 0.2$，爆发频率向量 $f \\in \\{0.5, 1.0, 2.0, 4.0\\}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按情况 A、B、C、D 的顺序排列结果。每个元素必须是该情况的整数分类，如上所述。例如，输出必须类似于“[1,2,0,1]”，但要使用为这四种情况实际计算出的整数。", "solution": "问题陈述经过验证，被认为是科学合理的、定义明确的、客观的且内部一致的。它基于已建立的基因转录双态（电报）模型，这是定量生物学中的一个基本概念。在特定假设下，该模型简化为负二项分布的 Gamma-Poisson 混合统计表示，是该领域一个标准且广为接受的结果。所提供的参数和计算任务定义清晰，并直接检验了模型的理论预测。因此，可以推导出解决方案。\n\n该问题要求开发一个计算程序，基于模拟的单细胞 mRNA 计数数据，对基因表达调制的主要机制——爆发频率或爆发大小——进行分类。该分类依赖于估计一个缩放指数，该指数将平均表达水平与转录噪声的幅度关联起来。\n\n**理论框架**\n\n模型的基础是稳态 mRNA 计数 $X$ 的 Gamma-Poisson 混合。单个细胞中的 mRNA 分子数是一个服从 Poisson 分布的随机变量, $X \\sim \\mathrm{Poisson}(\\lambda)$，其中速率参数 $\\lambda$ 在细胞群体中不是恒定的，其本身就是一个随机变量。在爆发式转录机制中，$\\lambda$ 服从 Gamma 分布, $\\lambda \\sim \\mathrm{Gamma}(\\text{shape}=\\alpha, \\text{scale}=\\beta)$。\n\nGamma 分布的参数由转录的生物物理参数决定：\n- 形状参数 $\\alpha$ 由 $\\alpha = f/\\gamma$ 给出，其中 $f$ 是爆发频率，$\\gamma$ 是 mRNA 降解速率。\n- 尺度参数 $\\beta$ 是平均爆发大小, $\\beta = b$。\n\n$X$ 的最终边缘分布是一个负二项分布。该分布的关键统计矩是均值 $\\mu$ 和方差 $\\mathrm{Var}(X)$。\n平均表达是 Poisson 速率在 Gamma 分布上的期望值：\n$$ \\mu = \\mathbb{E}[X] = \\mathbb{E}[\\lambda] = \\alpha\\beta $$\n方差使用全方差定律导出，$\\mathrm{Var}(X) = \\mathbb{E}[\\mathrm{Var}(X|\\lambda)] + \\mathrm{Var}(\\mathbb{E}[X|\\lambda])$。由于 Poisson 分布的均值和方差相等，所以 $\\mathbb{E}[X|\\lambda] = \\mathrm{Var}(X|\\lambda) = \\lambda$。\n$$ \\mathrm{Var}(X) = \\mathbb{E}[\\lambda] + \\mathrm{Var}(\\lambda) $$\nGamma$(\\alpha, \\beta)$ 分布的均值和方差分别是 $\\mathbb{E}[\\lambda] = \\alpha\\beta$ 和 $\\mathrm{Var}(\\lambda) = \\alpha\\beta^2$。代入这些值可得：\n$$ \\mathrm{Var}(X) = \\alpha\\beta + \\alpha\\beta^2 = \\mu + \\alpha\\beta^2 $$\n方差可以分解为一个等于均值的项（泊松噪声）和一个“超泊松”噪声项 $E$，该项捕捉了由转录爆发引起的过度离散：\n$$ E = \\mathrm{Var}(X) - \\mu = \\alpha\\beta^2 $$\n\n**缩放指数的推导**\n\n分类任务的核心是确定在不同调控情景下，超泊松噪声 $E$ 如何随平均表达 $\\mu$ 发生尺度变化。我们假设存在一个幂律关系 $E \\propto \\mu^{\\hat{\\beta}}$，其中 $\\hat{\\beta}$ 是待估计的缩放指数。取自然对数后得到一个线性关系：$\\log E = \\hat{\\beta} \\log \\mu + \\text{constant}$。指数 $\\hat{\\beta}$ 就是这条线的斜率。\n\n我们分析两种纯粹的调控策略：\n\n1.  **频率调制：** 爆发大小 $b$ 保持恒定，而爆发频率 $f$ 在不同条件下变化。在降解速率 $\\gamma$ 恒定的情况下，这意味着尺度参数 $\\beta = b$ 是恒定的，而形状参数 $\\alpha = f/\\gamma$ 发生变化。\n    - 均值：$\\mu = \\alpha\\beta$\n    - 超泊松噪声：$E = \\alpha\\beta^2$\n    我们可以通过代入 $\\alpha = \\mu/\\beta$ 来用 $\\mu$ 表示 $E$：\n    $$ E = \\left(\\frac{\\mu}{\\beta}\\right)\\beta^2 = \\mu\\beta $$\n    由于 $\\beta$ 是常数，$E$ 与 $\\mu$ 成正比。缩放关系为 $E \\propto \\mu^1$，理论指数为 $\\hat{\\beta} = 1$。\n\n2.  **大小调制：** 爆发频率 $f$ 保持恒定，而爆发大小 $b$ 发生变化。这意味着形状参数 $\\alpha = f/\\gamma$ 是恒定的，而尺度参数 $\\beta = b$ 发生变化。\n    - 均值：$\\mu = \\alpha\\beta$\n    - 超泊松噪声：$E = \\alpha\\beta^2$\n    我们通过代入 $\\beta = \\mu/\\alpha$ 来用 $\\mu$ 表示 $E$：\n    $$ E = \\alpha\\left(\\frac{\\mu}{\\alpha}\\right)^2 = \\frac{\\mu^2}{\\alpha} $$\n    由于 $\\alpha$ 是常数，$E$ 与 $\\mu$ 的平方成正比。缩放关系为 $E \\propto \\mu^2$，理论指数为 $\\hat{\\beta} = 2$。\n\n**计算算法设计**\n\n程序将为每个测试用例实现以下步骤，并遵循所提供的参数（$N=20000$ 个细胞，$\\gamma=1$，以及用于可复现性的随机种子 $12345$）。\n\n1.  **数据模拟：** 对于测试用例中的每个实验条件 $j$（由一对参数 $f_j$ 和 $b_j$ 定义）：\n    -   计算 Gamma 分布的参数：形状 $\\alpha_j = f_j / \\gamma$ 和尺度 $\\beta_j = b_j$。\n    -   通过从 Gamma 分布 $\\lambda_{j,i} \\sim \\mathrm{Gamma}(\\alpha_j, \\beta_j)$ 中抽样，生成 $N$ 个随机速率参数 $\\lambda_{j,i}$。\n    -   对于每个 $\\lambda_{j,i}$，通过从 Poisson 分布 $X_{j,i} \\sim \\mathrm{Poisson}(\\lambda_{j,i})$ 中抽样，生成一个单细胞 mRNA 计数 $X_{j,i}$。\n\n2.  **统计估计：** 对于每个条件 $j$，从模拟计数 $\\{X_{j,i}\\}_{i=1}^N$ 中计算样本均值 $\\hat{\\mu}_j$ 和样本总体方差 $\\widehat{\\mathrm{Var}}_j$。方差计算时除数为 $N$。\n\n3.  **缩放指数估计：**\n    -   对于每个条件 $j$，计算估计的超泊松噪声 $E_j = \\widehat{\\mathrm{Var}}_j - \\hat{\\mu}_j$。\n    -   创建一组数据点 $(\\log \\hat{\\mu}_j, \\log E_j)$。任何 $\\hat{\\mu}_j \\le 0$ 或 $E_j \\le 0$ 的点都将被排除。问题保证至少会剩下 3 个有效点用于拟合。\n    -   对这些经过对数转换的点执行简单线性回归以找到斜率，即为估计的缩放指数 $\\hat{\\beta}$。这通过为模型 $\\log E = \\hat{\\beta} \\log \\mu + c$ 寻找最佳拟合线来实现。\n\n4.  **分类：** 根据估计的指数 $\\hat{\\beta}$ 的值对调控机制进行分类：\n    -   如果 $|\\hat{\\beta} - 1| \\le 0.25$，则分类为频率调制（返回 $1$）。\n    -   如果 $|\\hat{\\beta} - 2| \\le 0.25$，则分类为大小调制（返回 $2$）。\n    -   否则，结果为混合或不确定（返回 $0$）。\n\n该程序将应用于指定的四个测试用例：情况 A（频率调制）、情况 B（大小调制）、情况 C（混合调制）和情况 D（一个接近 Poisson 极限的频率调制情况）。最终输出将是这四种情况的整数分类列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates single-cell mRNA counts, fits a noise-mean scaling exponent,\n    and classifies the transcriptional regulatory strategy.\n    \"\"\"\n    # Define global parameters as specified in the problem statement.\n    SEED = 12345\n    N_CELLS = 20000\n    GAMMA = 1.0\n\n    # Define the test cases, each with a set of conditions.\n    # Each condition is defined by a burst frequency (f) and burst size (b).\n    # Using full arrays for f and b in each case for uniform processing.\n    test_cases = [\n        # Case A: Frequency-modulated, constant burst size b = 3.\n        # Expected exponent: 1\n        {'f_params': np.array([0.5, 1.0, 2.0, 4.0]),\n         'b_params': np.array([3.0, 3.0, 3.0, 3.0])},\n\n        # Case B: Size-modulated, constant burst frequency f = 1.5.\n        # Expected exponent: 2\n        {'f_params': np.array([1.5, 1.5, 1.5, 1.5]),\n         'b_params': np.array([1.0, 2.0, 4.0, 8.0])},\n\n        # Case C: Mixed modulation.\n        # Expected exponent: between 1 and 2, classification 0\n        {'f_params': np.array([0.5, 1.0, 2.0, 4.0]),\n         'b_params': np.array([1.0, 1.5, 2.3, 3.5])},\n\n        # Case D: Frequency-modulated, small constant burst size b = 0.2.\n        # Expected exponent: 1\n        {'f_params': np.array([0.5, 1.0, 2.0, 4.0]),\n         'b_params': np.array([0.2, 0.2, 0.2, 0.2])}\n    ]\n\n    results = []\n    # Initialize the random number generator for reproducibility.\n    rng = np.random.default_rng(SEED)\n\n    for case in test_cases:\n        means = []\n        variances = []\n\n        # Iterate through each condition within the test case.\n        for f, b in zip(case['f_params'], case['b_params']):\n            # Calculate Gamma distribution parameters from biophysical parameters.\n            # Shape alpha = f / gamma\n            # Scale beta = b\n            alpha = f / GAMMA\n            beta_param = b\n\n            # Simulate single-cell data using the Gamma-Poisson mixture model.\n            # 1. Draw transcription rates from a Gamma distribution.\n            rates = rng.gamma(shape=alpha, scale=beta_param, size=N_CELLS)\n            # 2. Draw mRNA counts from a Poisson distribution for each rate.\n            counts = rng.poisson(lam=rates)\n\n            # Compute sample mean and population variance for the condition.\n            # np.var by default uses ddof=0, which is the population variance.\n            mu_hat = np.mean(counts)\n            var_hat = np.var(counts)\n            \n            means.append(mu_hat)\n            variances.append(var_hat)\n\n        # Prepare data for linear regression on log-transformed values.\n        log_means = []\n        log_noises = []\n        \n        for mu, var in zip(means, variances):\n            extra_noise = var - mu\n            # Filter out conditions where log is not defined or data is unreliable.\n            if mu > 0 and extra_noise > 0:\n                log_means.append(np.log(mu))\n                log_noises.append(np.log(extra_noise))\n        \n        # Check if enough data points remain for a reliable fit.\n        if len(log_means) < 3:\n            # If not, classify as inconclusive.\n            classification = 0\n        else:\n            # Perform linear regression to find the scaling exponent.\n            # The model is: log(noise) = beta_hat * log(mean) + intercept.\n            # np.polyfit(x, y, 1) returns [slope, intercept].\n            slope, _ = np.polyfit(log_means, log_noises, 1)\n            beta_hat = slope\n            \n            # Classify the regulatory mechanism based on the estimated exponent.\n            if abs(beta_hat - 1.0) <= 0.25:\n                classification = 1  # Frequency modulation\n            elif abs(beta_hat - 2.0) <= 0.25:\n                classification = 2  # Size modulation\n            else:\n                classification = 0  # Mixed or inconclusive\n        \n        results.append(classification)\n\n    # Format and print the final output as a single comma-separated list.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2665250"}]}