{"hands_on_practices": [{"introduction": "形态发生素梯度的精确形成是发育模式建立的基础。本练习将深入探讨控制Hedgehog蛋白在组织中分布的生物物理学原理。通过应用经典的反应-扩散模型，您将计算定义信号传递范围的关键参数，从而定量地理解信号能有效传播多远。[@problem_id:2947587]", "problem": "在 Hedgehog 信号通路中，Hedgehog (HH) 蛋白的长程形态发生素梯度是通过细胞外扩散在组织中建立的，该过程受到一级清除过程（统称为衰减）的拮抗，并由响应细胞通过 Patched (PTCH1) 和 Smoothened (SMO) 读取，以调节 GLI 转录因子。考虑一个占据 $x \\ge 0$ 的一维组织，在 $x=0$ 处有一个持续的边界源，在 $t \\ge 0$ 时维持恒定的细胞外浓度 $C(0,t)=C_{0}$。形态发生素浓度 $C(x,t)$ 根据线性反应-扩散方程演化\n$$\\frac{\\partial C}{\\partial t}=D\\,\\frac{\\partial^{2}C}{\\partial x^{2}}-k\\,C,$$\n其中对于 $x>0$，有 $C(x,0)=0$。此处 $D$ 是有效扩散系数，$k$ 是有效一级衰减率，代表结合介导的清除、内吞和降解。\n\n- 设 $D=0.3\\,\\mu\\text{m}^{2}\\,\\text{s}^{-1}$ 且 $k=10^{-3}\\,\\text{s}^{-1}$。\n- 将稳态 HH 梯度的特征衰减长度 $\\lambda$ 定义为稳态浓度衰减 $\\exp(1)$ 倍的距离。\n- 将在时间 $t$ 的信号范围定义为唯一的距离 $R(t)$，使得 $C(R(t),t)=f_{\\text{th}}\\,C_{0}$，其中 $f_{\\text{th}}=0.1$ 代表激活靶基因所需的阈值分数。\n\n仅使用具有一级衰减和持续边界强迫的线性扩散的基本性质，确定：\n1) 特征长度 $\\lambda$，以及\n2) 上述持续源在 $t=8$ 小时时的信号范围 $R(t)$。两个答案均以 $\\mu\\text{m}$ 为单位表示，并四舍五入至三位有效数字。按 $\\lambda$，$R(8\\,\\text{h})$ 的顺序提供你的最终答案，形式为两个数字。", "solution": "对问题陈述进行验证。\n\n提取已知条件如下：\n- 该系统是一个占据 $x \\ge 0$ 的一维组织。\n- 在 $x=0$ 处的持续边界源在 $t \\ge 0$ 时维持恒定浓度 $C(0,t)=C_{0}$。\n- 形态发生素浓度 $C(x,t)$ 根据反应-扩散方程演化：$\\frac{\\partial C}{\\partial t}=D\\,\\frac{\\partial^{2}C}{\\partial x^{2}}-k\\,C$。\n- 初始条件为对于 $x > 0$，有 $C(x,0)=0$。\n- 有效扩散系数为 $D=0.3\\,\\mu\\text{m}^{2}\\,\\text{s}^{-1}$。\n- 有效一级衰减率为 $k=10^{-3}\\,\\text{s}^{-1}$。\n- 特征衰减长度 $\\lambda$ 是稳态浓度衰减 $\\exp(1)$ 倍的距离。\n- 信号范围 $R(t)$ 是满足 $C(R(t),t)=f_{\\text{th}}\\,C_{0}$ 的距离，阈值分数为 $f_{\\text{th}}=0.1$。\n- 目标是求出 $\\lambda$ 和 $t=8$ 小时时的 $R(t)$。\n\n验证结论：问题有效。它描述了一个基于线性反应-扩散方程的数学生物学中的标准、适定问题，该方程是形态发生素梯度建模的基石。参数具有生物物理学的合理性，定义精确，问题在数学上是可解的。该问题具有科学依据和客观性，没有不一致或含糊之处。\n\n我们继续进行求解。\n\n第 1 部分：确定特征长度 $\\lambda$。\n特征长度 $\\lambda$ 是根据稳态浓度分布 $C_{ss}(x)$ 定义的。在稳态下，浓度不随时间变化，因此 $\\frac{\\partial C}{\\partial t}=0$。控制偏微分方程简化为二阶常微分方程：\n$$D\\,\\frac{d^{2}C_{ss}}{dx^{2}}-k\\,C_{ss} = 0$$\n$$\\frac{d^{2}C_{ss}}{dx^{2}} = \\frac{k}{D}\\,C_{ss}$$\n该方程的通解形式为：\n$$C_{ss}(x) = A\\exp\\left(\\sqrt{\\frac{k}{D}}x\\right) + B\\exp\\left(-\\sqrt{\\frac{k}{D}}x\\right)$$\n其中 $A$ 和 $B$ 是由边界条件决定的常数。\n稳态问题的边界条件是：\n1. 在源处，$x=0$，浓度是固定的：$C_{ss}(0)=C_{0}$。\n2. 远离源处，当 $x\\to\\infty$ 时，浓度必须保持物理上的现实性，即为有限值。\n根据第二个条件，除非 $A=0$，否则当 $x\\to\\infty$ 时，$A\\exp\\left(\\sqrt{\\frac{k}{D}}x\\right)$ 项将发散。因此，我们必须设 $A=0$。\n将第一个条件应用于余下的解：\n$$C_{ss}(0) = B\\exp(0) = B = C_{0}$$\n因此，稳态浓度分布为：\n$$C_{ss}(x) = C_{0}\\exp\\left(-\\sqrt{\\frac{k}{D}}x\\right)$$\n问题将 $\\lambda$ 定义为衰减长度，即浓度下降到 $C_{0}/\\exp(1) = C_{0}\\exp(-1)$ 的距离。\n$$C_{ss}(\\lambda) = C_{0}\\exp\\left(-\\sqrt{\\frac{k}{D}}\\lambda\\right) = C_{0}\\exp(-1)$$\n通过比较指数，我们发现：\n$$\\sqrt{\\frac{k}{D}}\\lambda = 1$$\n$$\\lambda = \\sqrt{\\frac{D}{k}}$$\n代入给定值 $D=0.3\\,\\mu\\text{m}^{2}\\,\\text{s}^{-1}$ 和 $k=10^{-3}\\,\\text{s}^{-1}$：\n$$\\lambda = \\sqrt{\\frac{0.3\\,\\mu\\text{m}^{2}\\,\\text{s}^{-1}}{10^{-3}\\,\\text{s}^{-1}}} = \\sqrt{300\\,\\mu\\text{m}^{2}} = 10\\sqrt{3}\\,\\mu\\text{m}$$\n数值上，$\\lambda \\approx 17.3205\\,\\mu\\text{m}$。四舍五入到三位有效数字，即 $\\lambda \\approx 17.3\\,\\mu\\text{m}$。\n\n第 2 部分：确定 $t=8$ 小时时的信号范围 $R(t)$。\n给定时间为 $t=8\\,\\text{h}$。我们必须将其转换为秒，以与 $D$ 和 $k$ 的单位保持一致。\n$$t = 8\\,\\text{h} \\times 3600\\,\\text{s/h} = 28800\\,\\text{s}$$\n给定反应-扩散问题的完整瞬态解是已知的，可以用互补误差函数 $\\operatorname{erfc}(z)$ 表示：\n$$\\frac{C(x,t)}{C_{0}} = \\frac{1}{2}\\left[\\exp\\left(-x\\sqrt{\\frac{k}{D}}\\right) \\operatorname{erfc}\\left(\\frac{x}{2\\sqrt{Dt}} - \\sqrt{kt}\\right) + \\exp\\left(x\\sqrt{\\frac{k}{D}}\\right) \\operatorname{erfc}\\left(\\frac{x}{2\\sqrt{Dt}} + \\sqrt{kt}\\right)\\right]$$\n信号范围 $R(t)$ 由条件 $C(R(t),t) = f_{\\text{th}}C_{0} = 0.1 C_{0}$ 定义。这需要解一个超越方程。然而，我们应首先分析相关的时间尺度。系统接近稳态的特征时间尺度由衰减率 $k$ 和在特征长度 $\\lambda$ 上的扩散决定。这个时间尺度为 $\\tau \\approx 1/k$。\n$$\\tau = \\frac{1}{k} = \\frac{1}{10^{-3}\\,\\text{s}^{-1}} = 1000\\,\\text{s}$$\n指定的时间是 $t = 28800\\,\\text{s}$，远大于特征时间尺度，$t \\approx 29\\tau$。这表明系统将非常接近其稳态。我们可以通过检查 $\\operatorname{erfc}$ 函数的自变量来验证这一点。\n$\\sqrt{kt}$ 项为 $\\sqrt{10^{-3} \\times 28800} = \\sqrt{28.8} \\approx 5.367$。\n当 $t\\to\\infty$ 时，$\\sqrt{kt}\\to\\infty$。第二个 $\\operatorname{erfc}$ 项的自变量 $\\frac{x}{2\\sqrt{Dt}} + \\sqrt{kt}$ 趋于 $+\\infty$，并且 $\\operatorname{erfc}(z\\to\\infty) \\to 0$。第一个 $\\operatorname{erfc}$ 项的自变量 $\\frac{x}{2\\sqrt{Dt}} - \\sqrt{kt}$ 趋于 $-\\infty$，并且 $\\operatorname{erfc}(z\\to-\\infty) \\to 2$。\n在此极限下，解简化为：\n$$\\frac{C(x,t\\to\\infty)}{C_{0}} = \\frac{1}{2}\\left[\\exp\\left(-x\\sqrt{\\frac{k}{D}}\\right) (2) + \\exp\\left(x\\sqrt{\\frac{k}{D}}\\right) (0)\\right] = \\exp\\left(-x\\sqrt{\\frac{k}{D}}\\right) = \\frac{C_{ss}(x)}{C_{0}}$$\n由于 $t$ 很大，我们可以用稳态解 $C_{ss}(x)$ 来近似瞬态浓度 $C(x,t)$。因此，信号范围 $R(t)$ 可以用不随时间变化的稳态信号范围 $R_{ss}$ 来近似。\n我们通过求解以下方程来找到 $R_{ss}$：\n$$C_{ss}(R_{ss}) = f_{\\text{th}}C_{0}$$\n$$C_{0}\\exp\\left(-\\frac{R_{ss}}{\\lambda}\\right) = 0.1\\,C_{0}$$\n$$\\exp\\left(-\\frac{R_{ss}}{\\lambda}\\right) = 0.1$$\n对两边取自然对数：\n$$-\\frac{R_{ss}}{\\lambda} = \\ln(0.1) = -\\ln(10)$$\n$$R_{ss} = \\lambda\\ln(10)$$\n代入 $\\lambda = 10\\sqrt{3}\\,\\mu\\text{m}$：\n$$R(t=8\\,\\text{h}) \\approx R_{ss} = 10\\sqrt{3}\\ln(10)\\,\\mu\\text{m}$$\n数值上，$R(t=8\\,\\text{h}) \\approx 17.3205 \\times 2.302585 \\approx 39.883\\,\\mu\\text{m}$。\n四舍五入到三位有效数字，信号范围为 $R(8\\,\\text{h}) \\approx 39.9\\,\\mu\\text{m}$。\n\n所求的两个值是 $\\lambda \\approx 17.3\\,\\mu\\text{m}$ 和 $R(8\\,\\text{h}) \\approx 39.9\\,\\mu\\text{m}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n17.3 & 39.9\n\\end{pmatrix}\n}\n$$", "id": "2947587"}, {"introduction": "当Hedgehog信号到达细胞后，必须被转导为细胞内响应。此过程中的一个关键步骤是通过环磷酸腺苷（$cAMP$）调节蛋白激酶A（$PKA$）的活性。本练习应用酶动力学原理，量化由Hedgehog介导的 $cAMP$ 浓度变化如何改变 $PKA$ 活性，而 $PKA$ 活性是控制GLI蛋白加工过程的关键环节。[@problem_id:2947561]", "problem": "在脊椎动物的Hedgehog信号通路中，Sonic Hedgehog (Shh)与受体Patched结合，解除了对Smoothened (SMO)的抑制，这进而通过拮抗G蛋白偶联受体161 (GPR161)及相关的腺苷酸环化酶活性，抑制了初级纤毛中环腺苷酸 (cAMP) 的产生。蛋白激酶A (PKA)由cAMP激活，并磷酸化GLI转录因子，在没有Shh的情况下促进GLI抑制蛋白的形成。假设标准化的PKA催化活性作为cAMP浓度 $c$ 的函数，遵循一个饱和激活曲线，该曲线由经过充分检验的Michaelis–Menten依赖关系描述\n$$\nv(c)=\\frac{V_{\\max}\\,c}{K_m+c},\n$$\n其中 $V_{\\max}=1.0$ (无量纲) 且 $K_m=1.0\\,\\mu\\text{M}$。考虑三个面积相等的纤毛微区，在刺激前的cAMP浓度分别为 $c_1=0.2\\,\\mu\\text{M}$、$c_2=1.0\\,\\mu\\text{M}$ 和 $c_3=5.0\\,\\mu\\text{M}$。在持续的Shh刺激后，假设所有三个微区的cAMP浓度都均匀地乘以一个因子 $f$ 而减少，其中因子 $f$ 由第三个微区中观察到的浓度从 $5.0\\,\\mu\\text{M}$ 降低到 $0.5\\,\\mu\\text{M}$ 来定义。假定瞬时GLI抑制蛋白生成速率与三个微区中PKA活性的算术平均值成正比。\n\n仅使用这些假设和定义作为基本依据，计算Shh刺激后三个微区中平均PKA活性的倍数变化（刺激后除以刺激前）。将您的最终答案表示为最简形式的单个精确分数。最终答案是无量纲的；不要报告任何单位。", "solution": "问题陈述已经过严格评估，被认为是有效的。它在科学上基于分子和细胞生物学的既定原理，特别是Hedgehog信号通路和Michaelis–Menten酶动力学。该问题提法明确，为得到唯一解提供了所有必要的数据和定义。问题是客观的，没有歧义。计算平均PKA活性倍数变化的要求是基于所提供模型的一个直接、可形式化的问题。\n\n蛋白激酶A (PKA) 的标准化催化活性 $v$ 作为cAMP浓度 $c$ 的函数，由Michaelis–Menten方程给出：\n$$\nv(c) = \\frac{V_{\\max} c}{K_m + c}\n$$\n所提供的参数是最大速度 $V_{\\max} = 1.0$ (无量纲) 和Michaelis常数 $K_m = 1.0\\,\\mu\\text{M}$。代入这些值，活性函数变为：\n$$\nv(c) = \\frac{c}{1.0 + c}\n$$\n其中 $c$ 的单位是 $\\mu\\text{M}$。\n\n首先，我们计算Shh刺激前三个微区中各自的PKA活性。初始cAMP浓度为 $c_{1, \\text{before}} = 0.2\\,\\mu\\text{M}$，$c_{2, \\text{before}} = 1.0\\,\\mu\\text{M}$ 和 $c_{3, \\text{before}} = 5.0\\,\\mu\\text{M}$。\n\n相应的PKA活性为：\n$$\nv_{1, \\text{before}} = v(0.2) = \\frac{0.2}{1.0 + 0.2} = \\frac{0.2}{1.2} = \\frac{2}{12} = \\frac{1}{6}\n$$\n$$\nv_{2, \\text{before}} = v(1.0) = \\frac{1.0}{1.0 + 1.0} = \\frac{1.0}{2.0} = \\frac{1}{2}\n$$\n$$\nv_{3, \\text{before}} = v(5.0) = \\frac{5.0}{1.0 + 5.0} = \\frac{5.0}{6.0} = \\frac{5}{6}\n$$\n问题陈述指出，GLI抑制蛋白生成速率与三个等面积微区中PKA活性的算术平均值成正比。因此，刺激前的平均PKA活性 $\\bar{v}_{\\text{before}}$ 为：\n$$\n\\bar{v}_{\\text{before}} = \\frac{v_{1, \\text{before}} + v_{2, \\text{before}} + v_{3, \\text{before}}}{3} = \\frac{\\frac{1}{6} + \\frac{1}{2} + \\frac{5}{6}}{3}\n$$\n为了对分子中的分数求和，我们使用公分母 $6$：\n$$\n\\bar{v}_{\\text{before}} = \\frac{\\frac{1}{6} + \\frac{3}{6} + \\frac{5}{6}}{3} = \\frac{\\frac{1+3+5}{6}}{3} = \\frac{\\frac{9}{6}}{3} = \\frac{\\frac{3}{2}}{3} = \\frac{1}{2}\n$$\n\n接下来，我们确定持续Shh刺激后的状态。刺激导致cAMP浓度均匀地乘以一个因子 $f$ 而减少。该因子由第三个微区中观察到的浓度从 $c_{3, \\text{before}} = 5.0\\,\\mu\\text{M}$ 降低到 $c_{3, \\text{after}} = 0.5\\,\\mu\\text{M}$ 来定义。\n我们求解 $f$：\n$$\nc_{3, \\text{after}} = f \\times c_{3, \\text{before}} \\implies 0.5 = f \\times 5.0 \\implies f = \\frac{0.5}{5.0} = \\frac{1}{10}\n$$\n这个缩减因子应用于所有微区：\n$$\nc_{1, \\text{after}} = f \\times c_{1, \\text{before}} = \\frac{1}{10} \\times 0.2\\,\\mu\\text{M} = 0.02\\,\\mu\\text{M}\n$$\n$$\nc_{2, \\text{after}} = f \\times c_{2, \\text{before}} = \\frac{1}{10} \\times 1.0\\,\\mu\\text{M} = 0.1\\,\\mu\\text{M}\n$$\n$$\nc_{3, \\text{after}} = f \\times c_{3, \\text{before}} = \\frac{1}{10} \\times 5.0\\,\\mu\\text{M} = 0.5\\,\\mu\\text{M}\n$$\n现在，我们用这些浓度计算新的PKA活性：\n$$\nv_{1, \\text{after}} = v(0.02) = \\frac{0.02}{1.0 + 0.02} = \\frac{0.02}{1.02} = \\frac{2}{102} = \\frac{1}{51}\n$$\n$$\nv_{2, \\text{after}} = v(0.1) = \\frac{0.1}{1.0 + 0.1} = \\frac{0.1}{1.1} = \\frac{1}{11}\n$$\n$$\nv_{3, \\text{after}} = v(0.5) = \\frac{0.5}{1.0 + 0.5} = \\frac{0.5}{1.5} = \\frac{1}{3}\n$$\n刺激后的平均PKA活性 $\\bar{v}_{\\text{after}}$ 为：\n$$\n\\bar{v}_{\\text{after}} = \\frac{v_{1, \\text{after}} + v_{2, \\text{after}} + v_{3, \\text{after}}}{3} = \\frac{\\frac{1}{51} + \\frac{1}{11} + \\frac{1}{3}}{3}\n$$\n为了对分数求和，我们找到公分母，即 $51 \\times 11 = 561$，因为 $51 = 3 \\times 17$。\n$$\n\\bar{v}_{\\text{after}} = \\frac{\\frac{11}{561} + \\frac{51}{561} + \\frac{187}{561}}{3} = \\frac{\\frac{11+51+187}{561}}{3} = \\frac{\\frac{249}{561}}{3}\n$$\n将分数 $\\frac{249}{561}$ 的分子和分母同除以它们的公因数 $3$ 进行化简：$\\frac{249 \\div 3}{561 \\div 3} = \\frac{83}{187}$。\n$$\n\\bar{v}_{\\text{after}} = \\frac{\\frac{83}{187}}{3} = \\frac{83}{187 \\times 3} = \\frac{83}{561}\n$$\n最后，我们计算倍数变化，即刺激后的平均PKA活性与刺激前的平均PKA活性之比。\n$$\n\\text{Fold-change} = \\frac{\\bar{v}_{\\text{after}}}{\\bar{v}_{\\text{before}}} = \\frac{\\frac{83}{561}}{\\frac{1}{2}} = \\frac{83}{561} \\times 2 = \\frac{166}{561}\n$$\n分子的质因数为 $166 = 2 \\times 83$。分母的质因数为 $561 = 3 \\times 11 \\times 17$。分子和分母没有公因数，所以该分数是最简形式。", "answer": "$$\\boxed{\\frac{166}{561}}$$", "id": "2947561"}, {"introduction": "Hedgehog梯度的最终目的是建立不同的基因表达区域，从而为发育中的组织设定模式。这最后一个练习要求您将整个通路的逻辑整合到一个计算模型中。通过模拟响应Sonic Hedgehog梯度的GLI激活子和抑制子活性之间的平衡，您将预测基因表达边界的精确位置，从而连接连续信号与离散细胞命运之间的鸿沟。[@problem_id:2947577]", "problem": "设计一个一维稳态计算模型，用于模拟在一条归一化的背腹轴上，通过胶质瘤相关癌基因同源物 (GLI) 转录激活因子 GLI2A 与 GLI 转录抑制因子 GLI3R 之间的平衡来解读 Sonic Hedgehog (SHH) 形态发生素的过程。设位置由 $x \\in [0,1]$ 表示，其中 $x=0$ 为背侧，$x=1$ 为腹侧。使用以下基本且经过充分检验的公式：形态发生素梯度通过希尔型响应函数调控靶基因，并且 GLI2A 随 SHH 浓度增加而增加，GLI3R 随 SHH 浓度增加而减少。假设 SHH 浓度是一个单调递增的指数函数 $H(x) = H_0 \\exp(\\alpha x)$。\n\n通过希尔函数定义 GLI2A 的累积和 GLI3R 的产生：\n- 激活因子：$A(x) = A_{\\max}\\,\\dfrac{H(x)^{n_A}}{K_A^{n_A} + H(x)^{n_A}}$，\n- 抑制因子：$R(x) = R_{\\max}\\,\\dfrac{K_R^{n_R}}{K_R^{n_R} + H(x)^{n_R}}$。\n\n将它们组合成一个净转录驱动力：\n$$\nG(x) = w_A\\,A(x) - w_R\\,R(x),\n$$\n其中权重 $w_A > 0$ 和 $w_R > 0$ 为正。对于一组以 $j$ 为索引、激活阈值为 $\\theta_j$ 的标记基因，将预测的边界位置 $x_j$ 定义为满足 $G(x) \\ge \\theta_j$ 的最小 $x \\in [0,1]$。如果 $\\theta_j \\le G(0)$，则设 $x_j=0$。如果 $\\theta_j > G(1)$，则返回 $-1$，报告边界未出现在轴内。\n\n任务：\n1. 仅使用上述模型，对下方的每个测试用例，计算与三个阈值 $(\\theta_1,\\theta_2,\\theta_3)$ 对应的元组 $(x_1,x_2,x_3)$。\n2. 每个 $x_j$ 必须以浮点数形式返回，并四舍五入到三位小数。对于缺失的边界，返回 $-1.000$。\n3. 您的程序必须通过逻辑上正确的数值方法求解每个 $x_j$，该方法的合理性由模型假设所隐含的 $G(x)$ 的单调性来保证。\n\n所有浓度和参数均为无量纲，不需要物理单位。\n\n测试套件（四个用例）：\n- 用例 1：$H_0=0.5$, $\\alpha=2.0$, $A_{\\max}=1.0$, $R_{\\max}=1.0$, $w_A=1.0$, $w_R=0.8$, $K_A=1.0$, $K_R=0.75$, $n_A=2.0$, $n_R=2.0$, 阈值 $\\{\\theta_1,\\theta_2,\\theta_3\\}=\\{-0.2,\\,0.2,\\,0.6\\}$。\n- 用例 2：$H_0=0.3$, $\\alpha=0.1$, $A_{\\max}=1.0$, $R_{\\max}=1.0$, $w_A=1.0$, $w_R=1.2$, $K_A=1.0$, $K_R=1.0$, $n_A=2.0$, $n_R=2.0$, 阈值 $\\{\\theta_1,\\theta_2,\\theta_3\\}=\\{-1.01,\\,-0.95,\\,-0.5\\}$。\n- 用例 3：$H_0=1.0$, $\\alpha=3.0$, $A_{\\max}=1.0$, $R_{\\max}=1.0$, $w_A=1.1$, $w_R=1.1$, $K_A=1.0$, $K_R=1.0$, $n_A=1.0$, $n_R=1.0$, 阈值 $\\{\\theta_1,\\theta_2,\\theta_3\\}=\\{0.0,\\,0.995,\\,1.1\\}$。\n- 用例 4：$H_0=0.8$, $\\alpha=1.5$, $A_{\\max}=1.0$, $R_{\\max}=1.0$, $w_A=0.5$, $w_R=1.5$, $K_A=1.0$, $K_R=0.6$, $n_A=2.0$, $n_R=2.0$, 阈值 $\\{\\theta_1,\\theta_2,\\theta_3\\}=\\{-0.6,\\,-0.2,\\,0.0\\}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含结果，格式为一个逗号分隔的列表，并用方括号括起来。列表中的每个元素本身是一个由方括号括起来的逗号分隔的三元组，代表一个测试用例的三个四舍五入后的边界位置。对于上述四个用例，要求的格式为\n$[[x_{1,1},x_{1,2},x_{1,3}],[x_{2,1},x_{2,2},x_{2,3}],[x_{3,1},x_{3,2},x_{3,3}],[x_{4,1},x_{4,2},x_{4,3}]]$,\n其中每个 $x_{i,j}$ 都四舍五入到三位小数，不存在的边界使用 $-1.000$ 表示。", "solution": "问题陈述提出了一个明确定义的计算任务，其基础是发育生物学的既定原则，特别是 Hedgehog 信号通路。该问题在科学上是合理的，数学上是一致的，并且是客观的。因此，它被认为是有效的，下面提供了完整的解决方案。\n\n该问题要求沿着一维空间轴 $x \\in [0,1]$ 计算基因表达边界 $x_j$。这些边界被定义为净转录驱动力 $G(x)$ 首次超过一系列给定阈值 $\\theta_j$ 的位置。\n\n该模型由以下几个部分构成：\n\n1.  **SHH 形态发生素梯度：** Sonic Hedgehog 形态发生素的浓度 $H(x)$ 遵循一个指数分布，从轴的背侧（$x=0$）到腹侧（$x=1$）递增。\n    $$H(x) = H_0 \\exp(\\alpha x)$$\n    鉴于在所有测试用例中参数 $\\alpha$ 均为正，$H(x)$ 是 $x$ 的一个严格递增函数。\n\n2.  **GLI 因子：** GLI 激活因子 $A(x)$ 和抑制因子 $R(x)$ 的活性取决于局部 SHH 浓度 $H(x)$。它们的浓度使用希尔函数进行建模：\n    $$A(x) = A_{\\max}\\,\\dfrac{H(x)^{n_A}}{K_A^{n_A} + H(x)^{n_A}}$$\n    $$R(x) = R_{\\max}\\,\\dfrac{K_R^{n_R}}{K_R^{n_R} + H(x)^{n_R}}$$\n    $A(x)$ 的函数是一个标准的 S 型激活曲线，它随其输入 $H(x)$ 单调递增。$R(x)$ 的函数是一个 S 型抑制曲线，它随其输入 $H(x)$ 单调递减。\n\n3.  **净转录驱动力：** 净驱动力 $G(x)$ 是激活因子和抑制因子浓度的加权差：\n    $$G(x) = w_A\\,A(x) - w_R\\,R(x)$$\n    其中权重 $w_A$ 和 $w_R$ 是正常数。\n\n为了设计一个正确的数值策略，我们必须首先分析函数 $G(x)$ 的单调性。根据链式法则，$G(x)$ 对 $x$ 的导数由下式给出：\n$$\\frac{dG}{dx} = w_A \\frac{dA}{dH} \\frac{dH}{dx} - w_R \\frac{dR}{dH} \\frac{dH}{dx}$$\n我们来分析每一项：\n-   $\\frac{dH}{dx} = \\alpha H_0 \\exp(\\alpha x)$。由于 $\\alpha > 0$ 且 $H_0 > 0$，该项为严格正值。\n-   $\\frac{dA}{dH} = A_{\\max} \\frac{n_A H^{n_A-1} K_A^{n_A}}{(K_A^{n_A} + H^{n_A})^2}$。由于所有参数均为正，该项为严格正值。\n-   $\\frac{dR}{dH} = -R_{\\max} \\frac{n_R H^{n_R-1} K_R^{n_R}}{(K_R^{n_R} + H^{n_R})^2}$。该项为严格负值。\n\n将这些发现代入 $\\frac{dG}{dx}$ 的表达式中：\n$$\\frac{dG}{dx} = \\underbrace{w_A \\overbrace{\\left(\\frac{dA}{dH}\\right)}^{>0} \\overbrace{\\left(\\frac{dH}{dx}\\right)}^{>0}}_{>0} - \\underbrace{w_R \\overbrace{\\left(\\frac{dR}{dH}\\right)}^{<0} \\overbrace{\\left(\\frac{dH}{dx}\\right)}^{>0}}_{<0}$$\n第一项 $w_A \\frac{dA}{dx}$ 为正。第二项 $-w_R \\frac{dR}{dx}$ 也为正，因为 $\\frac{dR}{dx}$ 为负。两个严格正项之和为严格正值。因此，对于所有 $x \\in [0,1]$，都有 $\\frac{dG}{dx} > 0$。\n\n这证明了 $G(x)$ 是一个严格单调递增函数。这个性质至关重要：它保证了对于任何阈值 $\\theta_j$，方程 $G(x) = \\theta_j$ 最多只有一个解 $x$。\n\n因此，寻找阈值 $\\theta_j$ 对应的边界位置 $x_j$ 的问题，就简化为求解方程 $G(x_j) = \\theta_j$。算法步骤如下：\n\n1.  对每个测试用例，计算在定义域边界处的净驱动力值：$G(0)$ 和 $G(1)$。\n2.  对每个阈值 $\\theta_j$，应用指定的条件：\n    a. 如果 $\\theta_j \\le G(0)$，则条件 $G(x) \\ge \\theta_j$ 在整个定义域都满足。满足此条件的最小位置 $x$ 是 $x_j = 0$。\n    b. 如果 $\\theta_j > G(1)$，则条件 $G(x) \\ge \\theta_j$ 在定义域内永远不会被满足。边界不存在，因此我们设 $x_j = -1$。\n    c. 如果 $G(0) < \\theta_j \\le G(1)$，$G(x)$ 的严格单调性及介值定理保证了在区间 $(0, 1]$ 内存在唯一的根 $x_j$。\n3.  为了找到这个根，我们求解方程 $F(x) = G(x) - \\theta_j = 0$。鉴于 $F(x)$ 是单调的，并且根被限定在 $[0, 1]$ 区间内，Brent 方法是一种非常适合的数值算法。它既稳健又收敛迅速。我们利用指定环境中可用的 `scipy.optimize.brentq` 函数。\n\n为每个测试用例实施此程序。然后将得出的边界位置 $x_j$ 四舍五入到三位小数，不存在的边界报告为 $-1.000$。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for gene expression boundaries based on a model of the Hedgehog signaling pathway.\n    \"\"\"\n    test_cases = [\n        {\n            \"params\": {\n                \"H0\": 0.5, \"alpha\": 2.0, \"A_max\": 1.0, \"R_max\": 1.0, \n                \"w_A\": 1.0, \"w_R\": 0.8, \"K_A\": 1.0, \"K_R\": 0.75, \n                \"n_A\": 2.0, \"n_R\": 2.0\n            },\n            \"thresholds\": [-0.2, 0.2, 0.6],\n        },\n        {\n            \"params\": {\n                \"H0\": 0.3, \"alpha\": 0.1, \"A_max\": 1.0, \"R_max\": 1.0, \n                \"w_A\": 1.0, \"w_R\": 1.2, \"K_A\": 1.0, \"K_R\": 1.0, \n                \"n_A\": 2.0, \"n_R\": 2.0\n            },\n            \"thresholds\": [-1.01, -0.95, -0.5],\n        },\n        {\n            \"params\": {\n                \"H0\": 1.0, \"alpha\": 3.0, \"A_max\": 1.0, \"R_max\": 1.0,\n                \"w_A\": 1.1, \"w_R\": 1.1, \"K_A\": 1.0, \"K_R\": 1.0,\n                \"n_A\": 1.0, \"n_R\": 1.0\n            },\n            \"thresholds\": [0.0, 0.995, 1.1],\n        },\n        {\n            \"params\": {\n                \"H0\": 0.8, \"alpha\": 1.5, \"A_max\": 1.0, \"R_max\": 1.0,\n                \"w_A\": 0.5, \"w_R\": 1.5, \"K_A\": 1.0, \"K_R\": 0.6, \n                \"n_A\": 2.0, \"n_R\": 2.0\n            },\n            \"thresholds\": [-0.6, -0.2, 0.0],\n        },\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        p = case[\"params\"]\n        thresholds = case[\"thresholds\"]\n        \n        # Pre-calculate powers of K for efficiency\n        K_A_pow_n_A = p[\"K_A\"]**p[\"n_A\"]\n        K_R_pow_n_R = p[\"K_R\"]**p[\"n_R\"]\n\n        def G(x):\n            \"\"\"Calculates the net transcriptional drive G at position x.\"\"\"\n            H_x = p[\"H0\"] * np.exp(p[\"alpha\"] * x)\n            \n            H_x_pow_n_A = H_x**p[\"n_A\"]\n            A_x = p[\"A_max\"] * H_x_pow_n_A / (K_A_pow_n_A + H_x_pow_n_A)\n            \n            H_x_pow_n_R = H_x**p[\"n_R\"]\n            R_x = p[\"R_max\"] * K_R_pow_n_R / (K_R_pow_n_R + H_x_pow_n_R)\n            \n            return p[\"w_A\"] * A_x - p[\"w_R\"] * R_x\n\n        case_results = []\n        G0 = G(0)\n        G1 = G(1)\n\n        for theta in thresholds:\n            if theta <= G0:\n                xj = 0.0\n            elif theta > G1:\n                xj = -1.0\n            else:\n                # The function to find the root of: G(x) - theta = 0\n                def f_to_solve(x):\n                    return G(x) - theta\n                \n                # Brent's method is used as it is efficient and robust for a\n                # root known to be within a bracket for a monotonic function.\n                xj = brentq(f_to_solve, 0, 1)\n            \n            case_results.append(xj)\n        \n        all_results.append(case_results)\n\n    # Format the final output string as specified\n    formatted_case_strings = []\n    for case_res in all_results:\n        case_str_list = [f\"{val:.3f}\" for val in case_res]\n        formatted_case_strings.append(f\"[{','.join(case_str_list)}]\")\n        \n    final_output_string = f\"[{','.join(formatted_case_strings)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "2947577"}]}