{"hands_on_practices": [{"introduction": "在深入研究线粒体DNA（mtDNA）的动态变化和遗传机制之前，理解其独特的结构特征至关重要。动物mtDNA以其极端紧凑的基因组而闻名，几乎没有非编码区。本练习 [@problem_id:2954993] 提供了一个基于真实特征的假设性mtDNA基因组注释，指导您通过计算蛋白质编码区、RNA编码区和基因间区域的比例，来亲手量化这种“编码密度”。这个实践不仅能锻炼您处理基因组坐标数据的基本生物信息学技能，还能让您直观地理解作用于mtDNA以提高复制效率的强大选择压力。", "problem": "一个假设的两侧对称动物的线粒体基因组是一个总长度为 $L = 16{,}580$ 个碱基对的环状双链DNA分子。下方的注释列出了每个特征在参考链上的起始和终止坐标（包含两端）、特征的生物化学类别以及转录链。蛋白质编码基因可能会有轻微重叠，这在后生动物线粒体基因组中是已知现象。在此注释中，转运RNA (tRNA) 和核糖体RNA (rRNA) 基因不与蛋白质编码基因重叠。请使用以下基本事实作为您推理的起点：(i) 分子生物学中心法则（DNA制造RNA，RNA制造蛋白质），(ii) 当坐标包含两端时，基因的基因组长度计算公式为 $\\text{end} - \\text{start} + 1$，(iii) 某一类别在基因组中所占的比例等于该类别覆盖的碱基对数目除以基因组总长度，以及 (iv) 当同一类别中的基因组特征发生重叠时，重叠的碱基对在该类别的覆盖范围内只计算一次（即，使用区间的并集以避免重复计算）。在此注释中，蛋白质编码类别和RNA编码类别之间没有重叠。\n\n基因组注释（所有坐标均包含两端）：\n- tRNA-Phe (RNA), $1$–$70$, H链\n- $12\\mathrm{S}$ rRNA (RNA), $71$–$1000$, H链\n- tRNA-Val (RNA), $1001$–$1070$, H链\n- $16\\mathrm{S}$ rRNA (RNA), $1071$–$2620$, H链\n- tRNA-Leu(UUR) (RNA), $2621$–$2695$, H链\n- ND1 (蛋白质), $2696$–$3655$, H链\n- tRNA-Ile (RNA), $3656$–$3725$, H链\n- tRNA-Gln (RNA), $3726$–$3795$, L链\n- tRNA-Met (RNA), $3796$–$3865$, H链\n- ND2 (蛋白质), $3866$–$4905$, H链\n- tRNA-Trp (RNA), $4906$–$4975$, H链\n- tRNA-Ala (RNA), $4976$–$5045$, L链\n- tRNA-Asn (RNA), $5046$–$5115$, L链\n- tRNA-Cys (RNA), $5116$–$5185$, L链\n- tRNA-Tyr (RNA), $5186$–$5255$, L链\n- COX1 (蛋白质), $5256$–$6797$, H链\n- tRNA-Ser(UCN) (RNA), $6798$–$6867$, L链\n- tRNA-Asp (RNA), $6868$–$6937$, H链\n- COX2 (蛋白质), $6938$–$7621$, H链\n- tRNA-Lys (RNA), $7622$–$7691$, H链\n- ATP8 (蛋白质), $7692$–$7898$, H链\n- ATP6 (蛋白质), $7889$–$8572$, H链\n- COX3 (蛋白质), $8573$–$9358$, H链\n- tRNA-Gly (RNA), $9359$–$9428$, H链\n- ND3 (蛋白质), $9429$–$9773$, H链\n- tRNA-Arg (RNA), $9774$–$9843$, H链\n- ND4L (蛋白质), $9844$–$10143$, H链\n- ND4 (蛋白质), $10137$–$11515$, H链\n- tRNA-His (RNA), $11516$–$11585$, H链\n- tRNA-Ser(AGY) (RNA), $11586$–$11655$, L链\n- tRNA-Leu(CUN) (RNA), $11656$–$11725$, H链\n- ND5 (蛋白质), $11726$–$13537$, H链\n- ND6 (蛋白质), $13538$–$14062$, L链\n- tRNA-Glu (RNA), $14063$–$14132$, L链\n- CYTB (蛋白质), $14133$–$15272$, H链\n- tRNA-Thr (RNA), $15273$–$15342$, H链\n- tRNA-Pro (RNA), $15343$–$15412$, L链\n- 控制区 (非编码，基因间区), $15413$–$16580$\n\n任务：\n1. 计算基因组中蛋白质编码区域的比例、RNA编码区域（合并tRNA和rRNA）的比例，以及基因间区（非编码）的比例，注意避免同一类别内的重叠重复计算。将每个比例表示为不带百分号的小数。\n2. 基于后生动物线粒体遗传学和群体遗传学的基本原理（母系遗传、频繁的传播瓶颈、许多谱系中较高的突变率，以及对复制效率的选择），用一到两句话解释计算出的比例如何揭示该线粒体基因组中对编码密度的选择压力。\n\n按以下顺序报告您的三个比例：蛋白质编码、RNA编码、基因间区。将每个值四舍五入到四位有效数字。您的最终数值答案必须是一个包含三个四舍五入后小数的行矩阵，不带单位。", "solution": "该问题要求计算一个假设的线粒体基因组中蛋白质编码、RNA编码和基因间区域的比例，然后在线粒体演化的背景下对这些比例进行解释。问题陈述具有科学依据，提法明确，并包含解决问题所需的所有信息和规则。它没有违反任何指定的无效标准。因此，我将提供一个完整的解法。\n\n线粒体基因组的总长度为 $L = 16,580$ 个碱基对 (bp)。对于任何具有包含性起始和终止坐标 $s$ 和 $e$ 的基因组特征，其长度的计算公式为 $l = e - s + 1$。一个特征类别所占基因组的比例是其（考虑重叠后的）总长度除以 $L$。\n\n解法根据任务分为两部分。\n\n第1部分：基因组比例的计算\n\n首先，我们计算蛋白质编码基因所占的总碱基对数。注释列出了 $13$ 个蛋白质编码基因。根据问题规则，我们必须识别并校正此类别内的任何重叠。蛋白质编码基因的区间如下：\nND1: $[2696, 3655]$\nND2: $[3866, 4905]$\nCOX1: $[5256, 6797]$\nCOX2: $[6938, 7621]$\nATP8: $[7692, 7898]$\nATP6: $[7889, 8572]$\nCOX3: $[8573, 9358]$\nND3: $[9429, 9773]$\nND4L: $[9844, 10143]$\nND4: $[10137, 11515]$\nND5: $[11726, 13537]$\nND6: $[13538, 14062]$\nCYTB: $[14133, 15272]$\n\n经检查，存在两处重叠：\n1. ATP8 ($[7692, 7898]$) 和 ATP6 ($[7889, 8572]$)。重叠区间为 $[7889, 7898]$。该重叠的长度为 $7898 - 7889 + 1 = 10_ \\text{bp}$。\n2. ND4L ($[9844, 10143]$) 和 ND4 ($[10137, 11515]$)。重叠区间为 $[10137, 10143]$。该重叠的长度为 $10143 - 10137 + 1 = 7_ \\text{bp}$。\n\n蛋白质编码基因所占的总长度 $C_{P}$ 是所有单个蛋白质编码基因长度之和减去重叠区域长度之和。\n单个长度的总和为：\n$$ \\sum l_{\\text{protein}} = (3655 - 2696 + 1) + (4905 - 3866 + 1) + (6797 - 5256 + 1) + (7621 - 6938 + 1) + (7898 - 7692 + 1) + (8572 - 7889 + 1) + (9358 - 8573 + 1) + (9773 - 9429 + 1) + (10143 - 9844 + 1) + (11515 - 10137 + 1) + (13537 - 11726 + 1) + (14062 - 13538 + 1) + (15272 - 14133 + 1) $$\n$$ \\sum l_{\\text{protein}} = 960 + 1040 + 1542 + 684 + 207 + 684 + 786 + 345 + 300 + 1379 + 1812 + 525 + 1140 = 11404 \\text{ bp} $$\n总重叠长度为 $10 + 7 = 17$ bp。\n因此，蛋白质编码区域的总非冗余长度为：\n$$ C_P = 11404 - 17 = 11387 \\text{ bp} $$\n蛋白质编码区域在基因组中所占的比例 $F_P$ 为：\n$$ F_P = \\frac{C_P}{L} = \\frac{11387}{16580} \\approx 0.6867913... $$\n四舍五入到四位有效数字，我们得到 $F_P = 0.6868$。\n\n其次，我们计算RNA编码基因（rRNA和tRNA）所占的总碱基对数。注释列出了 $2$ 个rRNA基因和 $22$ 个tRNA基因。通过检查所有RNA编码基因的起始和终止坐标，可以确定该类别内没有重叠。因此，总长度 $C_R$ 是所有单个RNA基因长度的简单加和。\n两个rRNA基因的长度为：\n$l_{12S} = 1000 - 71 + 1 = 930$ bp\n$l_{16S} = 2620 - 1071 + 1 = 1550$ bp\nrRNA总长度 = $930 + 1550 = 2480$ bp。\n共有 $22$ 个 tRNA 基因。其中 $21$ 个的长度为 $70$ bp。基因 tRNA-Leu(UUR) 的长度为 $2695 - 2621 + 1 = 75$ bp。\ntRNA总长度 = $(21 \\times 70) + 75 = 1470 + 75 = 1545$ bp。\nRNA编码区域的总长度为：\n$$ C_R = 2480 + 1545 = 4025 \\text{ bp} $$\nRNA编码区域在基因组中所占的比例 $F_R$ 为：\n$$ F_R = \\frac{C_R}{L} = \\frac{4025}{16580} \\approx 0.24276236... $$\n四舍五入到四位有效数字，我们得到 $F_R = 0.2428$。\n\n第三，我们计算基因间区在基因组中所占的比例。问题陈述中提到蛋白质编码和RNA编码类别之间没有重叠。因此，总编码长度 $C_{\\text{coding}}$ 为 $C_P + C_R$。\n$$ C_{\\text{coding}} = 11387 + 4025 = 15412 \\text{ bp} $$\n总基因间区（非编码）长度 $I$ 是基因组总长度减去总编码长度。\n$$ I = L - C_{\\text{coding}} = 16580 - 15412 = 1168 \\text{ bp} $$\n这个长度与注释的控制区完全对应，其范围从 $15413$ 到 $16580$ ($16580 - 15413 + 1 = 1168$ bp)，这证实了所有其他区域都是连续或重叠的。\n基因间区在基因组中所占的比例 $F_I$ 为：\n$$ F_I = \\frac{I}{L} = \\frac{1168}{16580} \\approx 0.07044632... $$\n四舍五入到四位有效数字，我们得到 $F_I = 0.07045$。\n\n第2部分：解释\n\n计算出的比例显示，蛋白质编码和RNA编码区域构成了 $F_P + F_R \\approx 0.6868 + 0.2428 = 0.9296$，约占基因组的 $93\\%$。这种极高的编码密度，以及主要局限于必需控制区的极小基因间空间，反映了对基因组紧凑性的强烈纯化选择。这种精简化是一种主要的适应性改变，旨在提高复制效率并最小化非功能性DNA的突变靶标大小，考虑到后生动物线粒体特有的较高突变率和传播瓶颈，这是有利的。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.6868 & 0.2428 & 0.07045 \\end{pmatrix} } $$", "id": "2954993"}, {"introduction": "准确的测量是定量科学的基石，在线粒体遗传学中，这意味着精确量化异质性（heteroplasmy）——即细胞内突变型与野生型mtDNA的比例。然而，下一代测序（NGS）的原始读数（raw reads）不可避免地受到测序错误和技术偏差（如链特异性偏差）的影响。本练习 [@problem_id:2955008] 引入了一个强大的统计框架，教您如何建立一个似然模型，以从带有噪声的测序数据中推断出真实的异质性水平 $p$。通过解决这个问题，您将学会如何将原始观测数据转化为可靠的生物学度量，这是现代分子遗传学研究中一项不可或缺的核心技能。", "problem": "一项线粒体点突变通过深度二代测序 (NGS) 的读段进行检测，这些读段能以正向和反向两种方向进行比对。设真实的异质性为样本中携带变异等位基因的线粒体基因组的比例 $p \\in [0,1]$。假设在给定 $p$ 的条件下，各条读段是独立的，并且链特异性的碱基识别错误率是已知的，且在给定链上的所有读段中保持恒定。具体来说，在正向链上，从一个真实的参考分子中识别出变异的概率为 $\\epsilon_f$，而从一个真实的变异分子中识别出参考的概率为 $\\eta_f$。类似地，在反向链上，这些概率分别为 $\\epsilon_r$ 和 $\\eta_r$。在这些假设下，一条正向链读段被识别为变异的概率为 $q_f(p) = p(1-\\eta_f) + (1-p)\\epsilon_f$，一条反向链读段被识别为变异的概率为 $q_r(p) = p(1-\\eta_r) + (1-p)\\epsilon_r$。您观测到 $n_f$ 条正向链读段中有 $x_f$ 条变异读段，以及 $n_r$ 条反向链读段中有 $x_r$ 条变异读段。\n\n使用基于每条链上观测到的变异读段计数的二项式采样的似然公式，并结合上述定义，计算异质性 $p$ 的最大似然估计以及一个基于在估计值处评估的期望费雪信息推导出的渐近正态近似的双侧 $95\\%$ 置信区间。\n\n数据：\n- 正向链：$n_f = 500$，$x_f = 140$，$\\epsilon_f = 5.0 \\times 10^{-3}$，$\\eta_f = 1.0 \\times 10^{-2}$。\n- 反向链：$n_r = 300$，$x_r = 72$，$\\epsilon_r = 1.5 \\times 10^{-2}$，$\\eta_r = 2.0 \\times 10^{-2}$。\n\n将您的最终结果以单行向量 $\\big[p_{\\text{MLE}},\\ \\text{lower},\\ \\text{upper}\\big]$ 的形式报告，其中 $p_{\\text{MLE}}$ 是最大似然估计，$\\text{lower}$ 和 $\\text{upper}$ 分别是 $95\\%$ 置信区间的下限和上限。将所有三个数值四舍五入至四位有效数字。不包含单位，并将异质性表示为比例（而非百分比）。", "solution": "在尝试给出解答之前，对问题进行验证。\n\n首先，逐字提取已知条件。\n- 真实异质性：$p \\in [0,1]$。\n- 正向链错误概率：真实参考被识别为变异的概率为 $\\epsilon_f$，真实变异被识别为参考的概率为 $\\eta_f$。\n- 反向链错误概率：真实参考被识别为变异的概率为 $\\epsilon_r$，真实变异被识别为参考的概率为 $\\eta_r$。\n- 正向链读段被识别为变异的概率：$q_f(p) = p(1-\\eta_f) + (1-p)\\epsilon_f$。\n- 反向链读段被识别为变异的概率：$q_r(p) = p(1-\\eta_r) + (1-p)\\epsilon_r$。\n- 正向链数据：$n_f = 500$ 条读段，$x_f = 140$ 条变异读段，$\\epsilon_f = 5.0 \\times 10^{-3}$，$\\eta_f = 1.0 \\times 10^{-2}$。\n- 反向链数据：$n_r = 300$ 条读段，$x_r = 72$ 条变异读段，$\\epsilon_r = 1.5 \\times 10^{-2}$，$\\eta_r = 2.0 \\times 10^{-2}$。\n- 目标是使用期望费雪信息计算 $p$ 的最大似然估计 (MLE) 和一个双侧 $95\\%$ 置信区间。\n\n根据验证标准对问题进行评估。\n- **科学依据：** 该模型是计算生物学中一个标准且稳健的方法，用于根据二代测序数据估计等位基因频率，并考虑了链特异性错误率。对基于计数的数据使用二项式似然是基础。该模型在科学上是合理的。\n- **适定性：** 问题提供了清晰的目标和一套完整的数据与定义，以进行唯一的统计估计。对于此模型，对数似然函数的凹性保证了最大似然估计的存在性和唯一性。\n- **客观性：** 问题使用精确、无歧义的数学和生物学术语进行陈述。\n该问题没有科学或事实上的不健全之处，是可形式化的，并且与所述领域相关，不是不完整或矛盾的，使用了现实的参数，并且不是微不足道的。\n\n结论是该问题有效。将提供解答。\n\n在给定真实异质性 $p$ 的条件下，每条链上的变异读段数 $x_f$ 和 $x_r$ 是来自二项分布的独立观测值。具体来说，$x_f \\sim \\text{Bin}(n_f, q_f(p))$ 和 $x_r \\sim \\text{Bin}(n_r, q_r(p))$。似然函数 $L(p)$ 是两个二项概率质量函数的乘积：\n$$ L(p) \\propto q_f(p)^{x_f} (1-q_f(p))^{n_f-x_f} \\cdot q_r(p)^{x_r} (1-q_r(p))^{n_r-x_r} $$\n因此，对数似然函数 $\\ell(p) = \\ln(L(p))$ 为：\n$$ \\ell(p) = x_f \\ln(q_f(p)) + (n_f - x_f) \\ln(1 - q_f(p)) + x_r \\ln(q_r(p)) + (n_r - x_r) \\ln(1 - q_r(p)) + C $$\n其中 $C$ 是一个不依赖于 $p$ 的常数。为了找到最大似然估计 $p_{\\text{MLE}}$，我们必须求解得分方程 $\\frac{d\\ell}{dp} = 0$。\n概率 $q_f(p)$ 和 $q_r(p)$可以表示为 $p$ 的线性函数：\n$q_f(p) = p(1 - \\epsilon_f - \\eta_f) + \\epsilon_f = p \\cdot c_f + \\epsilon_f$，其中 $c_f = 1 - \\epsilon_f - \\eta_f$。\n$q_r(p) = p(1 - \\epsilon_r - \\eta_r) + \\epsilon_r = p \\cdot c_r + \\epsilon_r$，其中 $c_r = 1 - \\epsilon_r - \\eta_r$。\n$q_f(p)$ 和 $q_r(p)$ 关于 $p$ 的导数分别为 $\\frac{dq_f}{dp} = c_f$ 和 $\\frac{dq_r}{dp} = c_r$。\n\n对数似然的导数（得分函数 $S(p)$）是：\n$$ S(p) = \\frac{d\\ell}{dp} = \\left(\\frac{x_f}{q_f(p)} - \\frac{n_f - x_f}{1 - q_f(p)}\\right) \\frac{dq_f}{dp} + \\left(\\frac{x_r}{q_r(p)} - \\frac{n_r - x_r}{1 - q_r(p)}\\right) \\frac{dq_r}{dp} $$\n$$ S(p) = c_f \\left(\\frac{x_f}{q_f(p)} - \\frac{n_f - x_f}{1 - q_f(p)}\\right) + c_r \\left(\\frac{x_r}{q_r(p)} - \\frac{n_r - x_r}{1 - q_r(p)}\\right) $$\n令 $S(p) = 0$ 得到一个关于 $p$ 的非线性方程。我们必须使用所提供的数据对该方程进行数值求解。\n常数为：\n$c_f = 1 - 5.0\\times 10^{-3} - 1.0\\times 10^{-2} = 1 - 0.005 - 0.01 = 0.985$。\n$c_r = 1 - 1.5\\times 10^{-2} - 2.0\\times 10^{-2} = 1 - 0.015 - 0.02 = 0.965$。\n使用数据 $n_f=500, x_f=140, n_r=300, x_r=72$，得分方程为：\n$$ 0.985 \\left(\\frac{140}{0.985p + 0.005} - \\frac{360}{1 - (0.985p + 0.005)}\\right) + 0.965 \\left(\\frac{72}{0.965p + 0.015} - \\frac{228}{1 - (0.965p + 0.015)}\\right) = 0 $$\n该方程关于 $p$ 的数值解给出了最大似然估计：\n$$ p_{\\text{MLE}} \\approx 0.262459 $$\n接下来，基于最大似然估计的渐近正态性构建一个 $95\\%$ 置信区间。最大似然估计的方差 $\\text{Var}(p_{\\text{MLE}})$，通过期望费雪信息 $I(p)$ 的倒数来近似。\n$$ I(p) = -E\\left[\\frac{d^2\\ell}{dp^2}\\right] $$\n对数似然的二阶导数是：\n$$ \\frac{d^2\\ell}{dp^2} = - \\left[ c_f^2 \\left( \\frac{x_f}{q_f(p)^2} + \\frac{n_f - x_f}{(1 - q_f(p))^2} \\right) + c_r^2 \\left( \\frac{x_r}{q_r(p)^2} + \\frac{n_r - x_r}{(1 - q_r(p))^2} \\right) \\right] $$\n通过代入 $E[x_f] = n_f q_f(p)$ 和 $E[x_r] = n_r q_r(p)$ 来求期望：\n$$ I(p) = c_f^2 \\left( \\frac{n_f q_f(p)}{q_f(p)^2} + \\frac{n_f (1-q_f(p))}{(1-q_f(p))^2} \\right) + c_r^2 \\left( \\frac{n_r q_r(p)}{q_r(p)^2} + \\frac{n_r (1-q_r(p))}{(1-q_r(p))^2} \\right) $$\n$$ I(p) = \\frac{n_f c_f^2}{q_f(p)(1-q_f(p))} + \\frac{n_r c_r^2}{q_r(p)(1-q_r(p))} $$\n我们在最大似然估计值处评估费雪信息 $I(p_{\\text{MLE}})$。首先，我们计算 $q_f(p_{\\text{MLE}})$ 和 $q_r(p_{\\text{MLE}})$：\n$q_f(p_{\\text{MLE}}) = 0.985 \\times 0.262459 + 0.005 \\approx 0.263522$。\n$q_r(p_{\\text{MLE}}) = 0.965 \\times 0.262459 + 0.015 \\approx 0.268273$。\n现在，我们计算 $I(p_{\\text{MLE}})$：\n$$ I_f = \\frac{500 \\times (0.985)^2}{0.263522 \\times (1 - 0.263522)} \\approx \\frac{485.1125}{0.194125} \\approx 2499.10 $$\n$$ I_r = \\frac{300 \\times (0.965)^2}{0.268273 \\times (1 - 0.268273)} \\approx \\frac{279.3675}{0.196238} \\approx 1423.63 $$\n$$ I(p_{\\text{MLE}}) = I_f + I_r \\approx 2499.10 + 1423.63 = 3922.73 $$\n估计的标准误是 $\\text{SE}(p_{\\text{MLE}}) = \\frac{1}{\\sqrt{I(p_{\\text{MLE}})}}$：\n$$ \\text{SE}(p_{\\text{MLE}}) \\approx \\frac{1}{\\sqrt{3922.73}} \\approx 0.015967 $$\n一个双侧 $95\\%$ 置信区间由 $p_{\\text{MLE}} \\pm z_{0.975} \\cdot \\text{SE}(p_{\\text{MLE}})$ 给出，其中 $z_{0.975}$ 是标准正态分布的 $0.975$ 分位数，$z_{0.975} \\approx 1.95996$。\n误差范围是 $1.95996 \\times 0.015967 \\approx 0.031295$。\n置信区间为：\n下限：$0.262459 - 0.031295 = 0.231164$。\n上限：$0.262459 + 0.031295 = 0.293754$。\n\n将三个值（$p_{\\text{MLE}}$、下限、上限）四舍五入至四位有效数字：\n$p_{\\text{MLE}} \\approx 0.2625$。\n下限 $\\approx 0.2312$。\n上限 $\\approx 0.2938$。\n最终结果以向量 $[p_{\\text{MLE}}, \\text{lower}, \\text{upper}]$ 的形式呈现。", "answer": "$$ \\boxed{\\begin{pmatrix} 0.2625 & 0.2312 & 0.2938 \\end{pmatrix}} $$", "id": "2955008"}, {"introduction": "掌握了如何分析mtDNA的静态结构和精确测量其群体状态后，我们便可以进入最终步骤：对mtDNA群体动态进行建模。异质性水平如何随时间演变？其背后的驱动力——选择（selection）和遗传漂变（genetic drift）——强度如何？本练习 [@problem_id:2954988] 将指导您应用经典的群体遗传学模型——Wright-Fisher模型的扩散近似——来拟合异质性的时间序列数据。通过这个实践，您将学会从动态数据中提取关键的生物学参数，如选择系数 $s$ 和有效群体大小 $N_e$，从而将抽象的理论模型与具体的实验观测联系起来，深刻理解细胞内进化过程。", "problem": "给定四个在分裂细胞中测得的独立的线粒体异质性值的时间序列。每个时间序列记录了在连续的细胞分裂中，突变型线粒体脱氧核糖核酸（DNA）的比例（无量纲，以十进制形式表示）。假设在每次分裂中，异质性根据一个包含基因选择和遗传漂变的单倍体 Wright–Fisher 过程演化，并且在给定当前异质性的条件下，每次分裂间的转变是独立的。您的任务是通过最大似然估计（MLE）方法，从每个时间序列中拟合一个模型，以估计选择系数 $s$ 和漂变参数（有效种群大小） $N_e$。所有量均为无单位的分数或计数；请勿使用百分比。不涉及角度。\n\n请使用适用于单倍体 Wright–Fisher 动态在每次分裂中 $N_e$ 中等大且 $|s|$ 中等小的范围内的扩散近似，并将每次分裂间的增量视为近似高斯分布，其均值由基因选择决定，方差由遗传漂变决定。请确保您的估计方法与此近似一致，并尊重异质性 $p$ 的生物学上有意义的界限 $0 < p < 1$。如果需要，请应用少量正则化以避免在边界处出现退化情况。\n\n测试套件（每一项都是单个世系的异质性在连续分裂中的轨迹；值为 $[0,1]$ 范围内的无量纲分数，以小数形式书写，而非百分比）：\n\n- 案例 $1$（向上趋势，每次分裂变化适中）：\n  [$0.30$, $0.315$, $0.332$, $0.347$, $0.361$, $0.378$, $0.394$, $0.409$, $0.425$, $0.438$]\n- 案例 $2$（在中性附近徘徊）：\n  [$0.50$, $0.47$, $0.52$, $0.49$, $0.55$, $0.51$, $0.46$, $0.50$, $0.54$, $0.48$]\n- 案例 $3$（向下趋势，每次分裂变化适中）：\n  [$0.70$, $0.685$, $0.673$, $0.658$, $0.646$, $0.635$, $0.623$, $0.612$, $0.601$, $0.591$]\n- 案例 $4$（靠近边界，有轻微向上趋势和明显漂变）：\n  [$0.08$, $0.085$, $0.079$, $0.083$, $0.090$, $0.095$, $0.100$, $0.104$, $0.110$, $0.115$]\n\n要求：\n\n- 模型设计基础：从单倍体的 Wright–Fisher 抽样与基因选择的基本群体遗传学原理及其扩散极限出发。请勿假设或使用任何不能从这些原理推导出的捷径公式。\n- 估计：使用与每次分裂的高斯扩散近似和转变间的独立性相一致的基于似然的推理，为每个案例获得最大似然估计 $(\\hat{s}, \\hat{N}_e)$。\n- 数值稳定性：通过少量正则化处理接近 $0$ 或 $1$ 的值，以使对数似然保持有限且良定义。\n- 输出格式：您的程序必须输出一行，其中包含一个扁平列表，按顺序包含所有四个案例的估计值。选择系数估计值 $s$ 四舍五入到4位小数，$N_e$ 估计值四舍五入到最近的整数。所需格式为：\n  [$\\hat{s}_1$, $\\hat{N}_{e,1}$, $\\hat{s}_2$, $\\hat{N}_{e,2}$, $\\hat{s}_3$, $\\hat{N}_{e,3}$, $\\hat{s}_4$, $\\hat{N}_{e,4}$]\n  其中 $\\hat{s}_k$ 是四舍五入到4位小数的浮点数，$\\hat{N}_{e,k}$ 是整数，对于 $k \\in \\{1,2,3,4\\}$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，[$x_1$, $x_2$, $x_3$, $x_4$, $x_5$, $x_6$, $x_7$, $x_8$]），不含任何额外文本。", "solution": "所述问题具有科学依据，是适定且客观的。它提出了一个基于经典 Wright-Fisher 模型的群体遗传学标准估计问题。所提供的数据对于此任务是一致且充分的。因此，该问题被认为是有效的。我们着手解决该问题。\n\n目标是从线粒体异质性 $p_t$ 的时间序列数据中估计选择系数 $s$ 和有效种群大小 $N_e$。问题指明，动态由一个带选择的单倍体 Wright-Fisher 过程控制，并且我们将使用扩散近似。估计将通过最大似然估计（MLE）进行。\n\n首先，我们必须对模型进行形式化。异质性 $p$ 从一代（细胞分裂）到下一代的演化可以描述为一个两步过程：选择，然后是遗传漂变（随机抽样）。\n\n1.  **选择**：设突变型线粒体DNA的相对适应度为 $w_m = 1+s$，野生型的相对适应度为 $w_w = 1$。在时间 $t$ 选择前，突变型的频率是 $p_t$。线粒体群体的平均适应度为 $\\bar{w} = p_t w_m + (1-p_t) w_w = p_t(1+s) + (1-p_t) = 1+sp_t$。选择后，频率变为 $p'_t$：\n    $$\n    p'_t = \\frac{p_t(1+s)}{1+sp_t}\n    $$\n    仅由选择引起的频率变化为 $\\Delta p_{\\text{sel}} = p'_t - p_t$：\n    $$\n    \\Delta p_{\\text{sel}} = \\frac{p_t(1+s)}{1+sp_t} - p_t = \\frac{p_t(1+s) - p_t(1+sp_t)}{1+sp_t} = \\frac{sp_t(1-p_t)}{1+sp_t}\n    $$\n    问题指定了 $|s|$ 中等小的范围，这使得近似 $1+sp_t \\approx 1$ 是合理的。因此，每代中由选择引起的异质性期望变化为：\n    $$\n    E[\\Delta p_t | p_t] \\approx sp_t(1-p_t)\n    $$\n\n2.  **遗传漂变**：新一代的线粒体是通过从选择后的基因库中抽样 $N_e$ 个基因组形成的，其中突变型频率为 $p'_t$。这是一个二项抽样过程。下一代中的异质性 $p_{t+1}$ 是一个随机变量，其均值为 $E[p_{t+1}|p_t] = p'_t$，方差为 $\\text{Var}(p_{t+1}|p_t) = \\frac{p'_t(1-p'_t)}{N_e}$。\n    在 $|s|$ 小的近似下，$p'_t \\approx p_t$。因此，由漂变引起的变化的方差为：\n    $$\n    \\text{Var}(\\Delta p_t | p_t) \\approx \\frac{p_t(1-p_t)}{N_e}\n    $$\n\n结合这些结果，扩散近似将每次分裂的异质性变化 $\\Delta p_t = p_{t+1} - p_t$ 视为一个高斯随机变量。在给定 $p_t$ 的条件下，$p_{t+1}$ 的分布为：\n$$\np_{t+1} | p_t \\sim \\mathcal{N}\\left(p_t + sp_t(1-p_t), \\frac{p_t(1-p_t)}{N_e}\\right)\n$$\n\n任务是在给定一个观测到的时间序列 $D = \\{p_0, p_1, \\dots, p_{T-1}\\}$ 的情况下，找到最大似然估计 $(\\hat{s}, \\hat{N}_e)$。由于各次转变是独立的，数据的似然函数是每次转变概率的乘积：\n$$\nL(s, N_e | D) = \\prod_{t=0}^{T-2} P(p_{t+1} | p_t, s, N_e)\n$$\n对数似然 $\\mathcal{L} = \\ln L$ 更便于最大化：\n$$\n\\mathcal{L}(s, N_e) = \\sum_{t=0}^{T-2} \\ln \\left[ \\frac{1}{\\sqrt{2\\pi \\frac{p_t(1-p_t)}{N_e}}} \\exp\\left( -\\frac{(p_{t+1} - p_t - sp_t(1-p_t))^2}{2 \\frac{p_t(1-p_t)}{N_e}} \\right) \\right]\n$$\n令 $\\delta_t = p_{t+1} - p_t$ 且 $v_t = p_t(1-p_t)$。展开对数似然并省略不依赖于 $s$ 或 $N_e$ 的常数项：\n$$\n\\mathcal{L}(s, N_e) \\propto \\sum_{t=0}^{T-2} \\left[ \\frac{1}{2}\\ln(N_e) - \\frac{N_e (\\delta_t - s v_t)^2}{2v_t} \\right] = \\frac{T-1}{2}\\ln(N_e) - \\frac{N_e}{2} \\sum_{t=0}^{T-2} \\frac{(\\delta_t - s v_t)^2}{v_t}\n$$\n为了找到最大似然估计，我们将 $\\mathcal{L}$ 对 $s$ 和 $N_e$ 的偏导数设为零。\n\n对 $s$ 的导数：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial s} = - \\frac{N_e}{2} \\sum_{t=0}^{T-2} \\frac{2(\\delta_t - s v_t)(-v_t)}{v_t} = N_e \\sum_{t=0}^{T-2} (\\delta_t - s v_t) = N_e \\left( \\sum \\delta_t - s \\sum v_t \\right)\n$$\n令 $\\frac{\\partial \\mathcal{L}}{\\partial s} = 0$（并假设 $N_e \\neq 0$），我们得到 $s$ 的估计量：\n$$\n\\hat{s} = \\frac{\\sum_{t=0}^{T-2} \\delta_t}{\\sum_{t=0}^{T-2} v_t} = \\frac{\\sum_{t=0}^{T-2} (p_{t+1} - p_t)}{\\sum_{t=0}^{T-2} p_t(1-p_t)}\n$$\n这是一个直观上很有吸引力的结果：估计的选择系数是总观测频率变化量除以累积的选择机会（方差项 $p(1-p)$ 的和）。\n\n对 $N_e$ 的导数：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial N_e} = \\frac{T-1}{2N_e} - \\frac{1}{2} \\sum_{t=0}^{T-2} \\frac{(\\delta_t - s v_t)^2}{v_t}\n$$\n令 $\\frac{\\partial \\mathcal{L}}{\\partial N_e} = 0$：\n$$\n\\frac{T-1}{N_e} = \\sum_{t=0}^{T-2} \\frac{(\\delta_t - s v_t)^2}{v_t}\n$$\n这给出了 $N_e$ 的估计量，它依赖于 $s$：\n$$\n\\hat{N}_e = \\frac{T-1}{\\sum_{t=0}^{T-2} \\frac{(\\delta_t - \\hat{s} v_t)^2}{v_t}}\n$$\n$\\hat{N}_e$ 的值是使用先前计算的 $\\hat{s}$ 来估计的。分母表示残差平方和（即不能被选择解释的变化部分），并按局部方差 $v_t$ 进行缩放。较小的残差变异意味着较弱的漂变，因此有效种群大小 $N_e$ 更大。\n\n实现将应用这些解析公式。为确保数值稳定性，特别是对于接近边界 $0$ 或 $1$ 的异质性值 $p_t$，必须防止项 $v_t = p_t(1-p_t)$ 为零或接近零。我们通过将输入的异质性值裁剪到距离边界一个很小的距离 $\\epsilon$ 内，即对于一个小的 $\\epsilon > 0$（例如 $10^{-9}$），$p_t \\in [\\epsilon, 1-\\epsilon]$，来实现这一点。这满足了正则化要求。然后计算每个案例的最终估计值，按规定进行四舍五入，并呈现出来。", "answer": "$$ \\boxed{\\begin{pmatrix} 0.0713 & 151 & -0.0223 & 116 & -0.0718 & 1502 & 0.0461 & 89 \\end{pmatrix}} $$", "id": "2954988"}]}