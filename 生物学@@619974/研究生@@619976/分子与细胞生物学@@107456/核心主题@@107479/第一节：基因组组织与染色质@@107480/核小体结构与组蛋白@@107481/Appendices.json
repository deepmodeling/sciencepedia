{"hands_on_practices": [{"introduction": "组蛋白修饰是基因调控的核心，但这些化学变化究竟如何转化为功能上的输出？本练习将深入探讨其生物物理学基础，让你运用经典的德拜-休克尔理论来量化当赖氨酸残基被乙酰化时，其与DNA之间静电相互作用能量的变化[@problem_id:2958260]。通过这个计算，你将为一个关键的表观遗传调控机制——组蛋白乙酰化——建立一个定量的、基于物理化学原理的理解。", "problem": "组蛋白H4尾部的一个短碱性区域包含两个赖氨酸残基，在生理pH下，其侧链铵基各携带$+e$的电荷。每个赖氨酸的乙酰化会中和其正电荷（从$+e$变为$0$），从而削弱其与脱氧核糖核酸（DNA）磷酸骨架之间的静电吸引。考虑一个简单的点电荷模型，其中每个赖氨酸侧链主要与一个单一的最近邻磷酸基团相互作用，该磷酸基团被视为电荷为$-e$的点电荷，两者中心间距固定为$r$。假设两个赖氨酸相距足够远，它们与DNA的相互作用是独立的，并且彼此之间不发生相互作用。\n\n溶液是温度为$T$、离子强度为$I$的单价水性电解质，其相对介电常数为$\\varepsilon_r$。使用Debye–Hückel屏蔽库仑势来处理相距为$r$的两个点电荷$q_1$和$q_2$之间的静电相互作用\n$$\nU(r) \\;=\\; \\frac{1}{4\\pi \\varepsilon_0 \\varepsilon_r}\\,\\frac{q_1 q_2}{r}\\,\\exp(-\\kappa r),\n$$\n其中Debye屏蔽参数为\n$$\n\\kappa \\;=\\; \\sqrt{\\frac{2 e^2 N_A I}{\\varepsilon_0 \\varepsilon_r k_B T}}.\n$$\n这里，$e$是元电荷，$N_A$是阿伏伽德罗常数，$k_B$是玻尔兹曼常数，$\\varepsilon_0$是真空介电常数。您可以认为离子强度$I$主要由单价盐贡献。\n\n参数：\n- $r = 0.50\\,\\text{nm}$，\n- $T = 298\\,\\text{K}$，\n- $I = 0.10\\,\\text{M}$，\n- $\\varepsilon_r = 78.5$（水在$298\\,\\text{K}$时），\n- $e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\text{C}$，\n- $\\varepsilon_0 = 8.854\\,187\\,8128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1}$，\n- $k_B = 1.380\\,649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}$，\n- $N_A = 6.022\\,140\\,76 \\times 10^{23}\\,\\text{mol}^{-1}$。\n\n从库仑定律和Debye–Hückel屏蔽框架的第一性原理出发，推导两个赖氨酸均被乙酰化（即两个电荷都从$+e$被中和为$0$）时总静电相互作用能的变化量$\\Delta U_{\\text{total}}$的表达式，然后计算其以热能$k_B T$为单位的数值。将最终答案报告为等于$\\Delta U_{\\text{total}}/(k_B T)$的单个纯数，四舍五入至三位有效数字。最终数值答案中不要包含单位。", "solution": "该问题要求计算当组蛋白尾部的两个赖氨酸残基被乙酰化时，静电相互作用能的变化量$\\Delta U_{\\text{total}}$，并以热能$k_B T$为单位表示此变化。\n\n首先，有必要对问题陈述进行验证。\n\n从问题陈述中提取的已知条件：\n- 两个赖氨酸残基，每个电荷为$q_{lys} = +e$。\n- 乙酰化中和电荷：$q_{lys}' = 0$。\n- 每个赖氨酸与一个电荷为$q_{phos} = -e$的最近邻磷酸基团相互作用。\n- 两个赖氨酸-磷酸盐的相互作用是独立的。\n- 中心间距：$r = 0.50\\,\\text{nm}$。\n- 温度：$T = 298\\,\\text{K}$。\n- 单价离子强度：$I = 0.10\\,\\text{M}$。\n- 介质（水）的相对介电常数：$\\varepsilon_r = 78.5$。\n- 相互作用势为Debye–Hückel屏蔽库仑势：$U(r) = \\frac{1}{4\\pi \\varepsilon_0 \\varepsilon_r}\\,\\frac{q_1 q_2}{r}\\,\\exp(-\\kappa r)$。\n- Debye屏蔽参数：$\\kappa = \\sqrt{\\frac{2 e^2 N_A I}{\\varepsilon_0 \\varepsilon_r k_B T}}$。\n- 常数：$e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\text{C}$，$ \\varepsilon_0 = 8.854\\,187\\,8128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1}$，$k_B = 1.380\\,649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}$，$N_A = 6.022\\,140\\,76 \\times 10^{23}\\,\\text{mol}^{-1}$。\n\n验证：\n该问题具有科学依据，采用了电解质的标准Debye-Hückel模型，这是物理化学的基石。组蛋白乙酰化的背景是分子生物学中的一个基本概念。该问题提法明确，提供了所有必要的参数、方程和清晰的目标。语言精确客观。使用简化的点电荷模型以及独立相互作用的假设，是生物物理建模中常见且明确陈述的合理简化。所给出的物理常数和参数是标准的，并且量纲一致。该问题是可解的，并且不违反任何物理学或化学的基本原理。因此，该问题被认定为有效。\n\n求解过程如下。\n\n该系统由两个独立的赖氨酸-磷酸盐对组成。总静电相互作用能是这两对能量的总和。\n\n初始状态（乙酰化前）：\n两个赖氨酸中的每一个都带有电荷$q_{lys} = +e$。每一个都与一个电荷为$q_{phos} = -e$的磷酸基团相互作用。单个对的相互作用能$U_{\\text{initial, pair}}$由Debye-Hückel势给出，其中$q_1 = +e$，$q_2 = -e$：\n$$\nU_{\\text{initial, pair}} = \\frac{1}{4\\pi \\varepsilon_0 \\varepsilon_r}\\,\\frac{(+e)(-e)}{r}\\,\\exp(-\\kappa r) = -\\frac{e^2}{4\\pi \\varepsilon_0 \\varepsilon_r r}\\,\\exp(-\\kappa r)\n$$\n因为有两个相同且独立的对，所以总初始能量$U_{\\text{total, i}}$为：\n$$\nU_{\\text{total, i}} = 2 \\times U_{\\text{initial, pair}} = -\\frac{2 e^2}{4\\pi \\varepsilon_0 \\varepsilon_r r}\\,\\exp(-\\kappa r) = -\\frac{e^2}{2\\pi \\varepsilon_0 \\varepsilon_r r}\\,\\exp(-\\kappa r)\n$$\n\n最终状态（乙酰化后）：\n乙酰化中和了两个赖氨酸残基上的电荷，因此它们的电荷变为$q_{lys}' = 0$。现在用$q_1 = 0$和$q_2 = -e$计算单个对的相互作用能：\n$$\nU_{\\text{final, pair}} = \\frac{1}{4\\pi \\varepsilon_0 \\varepsilon_r}\\,\\frac{(0)(-e)}{r}\\,\\exp(-\\kappa r) = 0\n$$\n因此，总最终能量$U_{\\text{total, f}}$为零：\n$$\nU_{\\text{total, f}} = 2 \\times U_{\\text{final, pair}} = 0\n$$\n\n总静电能量的变化（$\\Delta U_{\\text{total}}$）：\n能量的变化是最终能量减去初始能量：\n$$\n\\Delta U_{\\text{total}} = U_{\\text{total, f}} - U_{\\text{total, i}} = 0 - \\left(-\\frac{e^2}{2\\pi \\varepsilon_0 \\varepsilon_r r}\\,\\exp(-\\kappa r)\\right)\n$$\n这简化为总能量变化的推导表达式：\n$$\n\\Delta U_{\\text{total}} = \\frac{e^2}{2\\pi \\varepsilon_0 \\varepsilon_r r}\\,\\exp(-\\kappa r)\n$$\n问题要求以$k_B T$为单位给出该值，即无量纲量$\\frac{\\Delta U_{\\text{total}}}{k_B T}$：\n$$\n\\frac{\\Delta U_{\\text{total}}}{k_B T} = \\frac{e^2}{2\\pi \\varepsilon_0 \\varepsilon_r k_B T r}\\,\\exp(-\\kappa r)\n$$\n为了计算数值，我们必须首先计算Debye屏蔽参数$\\kappa$。离子强度$I = 0.10\\,\\text{M}$必须转换为国际单位制（SI）单位：$I = 0.10\\,\\text{mol}\\,\\text{L}^{-1} = 100\\,\\text{mol}\\,\\text{m}^{-3}$。\n$$\n\\kappa = \\sqrt{\\frac{2 e^2 N_A I}{\\varepsilon_0 \\varepsilon_r k_B T}}\n$$\n代入给定值：\n$$\n\\kappa = \\sqrt{\\frac{2 (1.602176634 \\times 10^{-19}\\,\\text{C})^2 (6.02214076 \\times 10^{23}\\,\\text{mol}^{-1}) (100\\,\\text{mol}\\,\\text{m}^{-3})}{(8.8541878128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1}) (78.5) (1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}) (298\\,\\text{K})}}\n$$\n计算各项：\n- 分子中的项：$2 \\times (2.56697 \\times 10^{-38}) \\times (6.02214 \\times 10^{25}) = 3.09176 \\times 10^{-12}\\,\\text{C}^2\\,\\text{m}^{-3}$。\n- 分母中的项：$(6.95054 \\times 10^{-10}) \\times (4.11433 \\times 10^{-21}) = 2.85960 \\times 10^{-30}\\,\\text{J}\\,\\text{F}\\,\\text{m}^{-1}$。\n注意，$\\text{J}\\,\\text{F}\\,\\text{m}^{-1} = (\\text{C}^2\\,\\text{F}^{-1})\\,\\text{F}\\,\\text{m}^{-1} = \\text{C}^2\\,\\text{m}^{-1}$。单位是一致的。\n$$\n\\kappa^2 = \\frac{3.09176 \\times 10^{-12}}{2.85960 \\times 10^{-30}} \\,\\text{m}^{-2} \\approx 1.08119 \\times 10^{18}\\,\\text{m}^{-2}\n$$\n$$\n\\kappa \\approx 1.0398 \\times 10^9\\,\\text{m}^{-1}\n$$\n接下来，我们计算指数的无量纲参数$\\kappa r$，其中$r = 0.50\\,\\text{nm} = 0.50 \\times 10^{-9}\\,\\text{m}$：\n$$\n\\kappa r = (1.0398 \\times 10^9\\,\\text{m}^{-1}) \\times (0.50 \\times 10^{-9}\\,\\text{m}) = 0.5199\n$$\n现在我们计算最终的无量纲量$\\frac{\\Delta U_{\\text{total}}}{k_B T}$：\n$$\n\\frac{\\Delta U_{\\text{total}}}{k_B T} = \\frac{(1.602176634 \\times 10^{-19}\\,\\text{C})^2}{2\\pi (8.8541878128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1}) (78.5) (1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}) (298\\,\\text{K}) (0.50 \\times 10^{-9}\\,\\text{m})} \\times \\exp(-0.5199)\n$$\n热能为 $k_B T = (1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}) \\times (298\\,\\text{K}) \\approx 4.11433 \\times 10^{-21}\\,\\text{J}$。\n指前因子为：\n$$\n\\frac{e^2}{2\\pi \\varepsilon_0 \\varepsilon_r r} = \\frac{(1.602176634 \\times 10^{-19}\\,\\text{C})^2}{2\\pi (6.95054 \\times 10^{-10}\\,\\text{F}\\,\\text{m}^{-1}) (0.50 \\times 10^{-9}\\,\\text{m})} \\approx \\frac{2.56697 \\times 10^{-38}}{2.18362 \\times 10^{-18}}\\,\\text{J} \\approx 1.17556 \\times 10^{-20}\\,\\text{J}\n$$\n除以$k_B T$：\n$$\n\\frac{1.17556 \\times 10^{-20}\\,\\text{J}}{4.11433 \\times 10^{-21}\\,\\text{J}} \\approx 2.8586\n$$\n最后，乘以屏蔽因子$\\exp(-\\kappa r)$：\n$$\n\\frac{\\Delta U_{\\text{total}}}{k_B T} = 2.8586 \\times \\exp(-0.5199) \\approx 2.8586 \\times 0.59458 \\approx 1.7001\n$$\n根据问题要求，将结果四舍五入至三位有效数字，我们得到$1.70$。\n结果为正，表明必须向系统提供能量以中和电荷，这对应于打破赖氨酸与DNA磷酸骨架之间有利的静电吸引。这在物理上是自洽的。", "answer": "$$\n\\boxed{1.70}\n$$", "id": "2958260"}, {"introduction": "在理解了单个分子修饰的能量学效应后，下一步是探究这些局部变化如何共同影响染色质的宏观结构。此练习将引导你使用平衡统计力学的工具，将核小体间的相互作用界面建模为一个“桥接”或“非桥接”的双态系统[@problem_id:2958211]。你将亲手计算由H4K16乙酰化等局部事件引起的自由能变化如何最终影响整个核小体阵列的压缩因子，从而清晰地看到从分子尺度到介观尺度的功能涌现。", "problem": "一个关于核小体纤维压缩的经典模型假设，每个核小体间的界面可以形成一个单一的组蛋白 H4 尾–酸性斑块桥，该桥的形成会缩短阵列的端到端长度。考虑一个包含 $12$ 个串联核小体的核小体阵列（一个“$12$-聚体”），因此有 $11$ 个最近邻界面。将每个界面建模为一个“成桥”或“未成桥”的两态系统，其标准自由能差 $\\Delta G \\equiv G_{\\mathrm{bridged}} - G_{\\mathrm{unbridged}}$ 通过平衡统计力学决定了平衡时成桥态的占据率。使用玻尔兹曼 (Boltzmann) 框架以及以下具有物理动机的假设和参数：\n\n- 对于未乙酰化的组蛋白 H4 赖氨酸 $16$ 尾，一个桥的静电稳定能为 $E_{\\mathrm{elec,un}} = -6.0~\\mathrm{kJ~mol^{-1}}$，构象/熵代价为 $\\Delta G_{\\mathrm{conf}} = +2.0~\\mathrm{kJ~mol^{-1}}$。因此，对于未乙酰化的界面，$\\Delta G_{\\mathrm{un}} = E_{\\mathrm{elec,un}} + \\Delta G_{\\mathrm{conf}}$。\n- 组蛋白 H4 赖氨酸 $16$ 处的乙酰化将静电引力的大小减小了 $80$％（即，只剩下原始引力的 $20$％）。因此，对于乙酰化的界面，有 $E_{\\mathrm{elec,ac}} = 0.20\\,E_{\\mathrm{elec,un}}$，且 $\\Delta G_{\\mathrm{ac}} = E_{\\mathrm{elec,ac}} + \\Delta G_{\\mathrm{conf}}$。\n- 比例为 $f = 0.70$ 的组蛋白 H4 尾在赖氨酸 $16$ 处被乙酰化，你可以用平均场的方式处理这 $11$ 个界面：比例为 $(1-f)$ 的界面表现为未乙酰化，比例为 $f$ 的界面表现为乙酰化，二者相互独立。\n- 每个形成的桥使阵列的端到端长度缩短 $s = 3.0~\\mathrm{nm}$。在没有任何桥的情况下，端到端长度为 $L_{0} = 180~\\mathrm{nm}$。\n- 取绝对温度为 $T = 298~\\mathrm{K}$，并使用以千焦耳每摩尔为能量单位的气体常数：$R = 8.314\\times 10^{-3}~\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。\n\n仅使用平衡统计力学的第一性原理和上述定义，计算期望压缩因子，\n$$\n\\mathrm{CF} \\equiv \\frac{L_{0}}{\\mathbb{E}[L]},\n$$\n对于在指定乙酰化比例下的 $12$-聚体阵列，其中 $\\mathbb{E}[L]$ 是在 $11$ 个界面上所有可能的桥构成的系综中，端到端长度的期望值。假设在各自的乙酰化类别内，界面是独立同分布的，并将期望成桥数视为各独立两态占据率之和。\n\n将压缩因子表示为一个无量纲数，并将答案四舍五入到三位有效数字。", "solution": "首先对问题陈述进行严格验证。\n\n第1步：提取已知条件。\n- 核小体数量：$12$。\n- 最近邻界面数量：$N=11$。\n- 界面模型：两态系统，“成桥”或“未成桥”。\n- 自由能差：$\\Delta G \\equiv G_{\\mathrm{bridged}} - G_{\\mathrm{unbridged}}$。\n- 对于未乙酰化的界面：\n  - 静电稳定能：$E_{\\mathrm{elec,un}} = -6.0~\\mathrm{kJ~mol^{-1}}$。\n  - 构象/熵代价：$\\Delta G_{\\mathrm{conf}} = +2.0~\\mathrm{kJ~mol^{-1}}$。\n  - 自由能差：$\\Delta G_{\\mathrm{un}} = E_{\\mathrm{elec,un}} + \\Delta G_{\\mathrm{conf}}$。\n- 对于乙酰化的界面：\n  - 静电稳定能：$E_{\\mathrm{elec,ac}} = 0.20\\,E_{\\mathrm{elec,un}}$。\n  - 自由能差：$\\Delta G_{\\mathrm{ac}} = E_{\\mathrm{elec,ac}} + \\Delta G_{\\mathrm{conf}}$。\n- 乙酰化 H4 尾的比例：$f = 0.70$。\n- 平均场假设：比例 $(1-f)$ 的界面是未乙酰化的，比例 $f$ 的界面是乙酰化的。\n- 每个桥引起的长度变化：$s = 3.0~\\mathrm{nm}$。\n- 未成桥阵列长度：$L_{0} = 180~\\mathrm{nm}$。\n- 绝对温度：$T = 298~\\mathrm{K}$。\n- 气体常数：$R = 8.314\\times 10^{-3}~\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。\n- 目标：计算压缩因子 $\\mathrm{CF} \\equiv \\frac{L_{0}}{\\mathbb{E}[L]}$。\n\n第2步：使用提取的已知条件进行验证。\n该问题有科学依据，根植于平衡统计力学原理在一个典型的染色质生物物理学模型中的应用。参数在物理上是合理的。问题是适定的，提供了所有必要的数据和清晰、明确的目标，可以导出一个唯一的解。语言客观而精确。问题是自洽的，没有内部矛盾。因此，该问题是有效的。\n\n第3步：结论与行动。\n问题有效。我们开始求解。\n\n目标是计算压缩因子 $\\mathrm{CF}$，其定义为：\n$$\n\\mathrm{CF} \\equiv \\frac{L_{0}}{\\mathbb{E}[L]}\n$$\n其中 $L_{0}$ 是在没有任何桥的情况下阵列的端到端长度，$\\mathbb{E}[L]$ 是阵列在热平衡状态下的期望端到端长度。\n\n阵列的端到端长度 $L$ 取决于形成的桥的数量 $n_{b}$。每个桥使阵列缩短长度 $s$。因此，长度由下式给出：\n$$\nL = L_{0} - n_{b}s\n$$\n期望长度可通过对该表达式取期望值得到。根据期望的线性性质：\n$$\n\\mathbb{E}[L] = \\mathbb{E}[L_{0} - n_{b}s] = L_{0} - \\mathbb{E}[n_{b}]s\n$$\n我们的任务简化为求出期望成桥数 $\\mathbb{E}[n_{b}]$。\n\n阵列有 $N=11$ 个界面。比例为 $f=0.70$ 的界面是乙酰化的，比例为 $(1-f)=0.30$ 的界面是未乙酰化的。在平均场近似下，我们考虑两个独立的界面群体。未乙酰化的界面数量为 $N_{un} = (1-f)N$，乙酰化的界面数量为 $N_{ac} = fN$。\n\n总期望成桥数是来自每个群体的期望数之和：\n$$\n\\mathbb{E}[n_{b}] = \\mathbb{E}[n_{b, \\mathrm{un}}] + \\mathbb{E}[n_{b, \\mathrm{ac}}]\n$$\n对于一组独立同分布的两态系统，处于某一特定状态的系统期望数等于系统总数乘以处于该状态的概率。设 $p_{un}$ 和 $p_{ac}$ 分别为单个未乙酰化或乙酰化界面处于“成桥”状态的概率。那么：\n$$\n\\mathbb{E}[n_{b}] = N_{un}p_{un} + N_{ac}p_{ac} = (1-f)Np_{un} + fNp_{ac} = N((1-f)p_{un} + fp_{ac})\n$$\n\n一个界面成桥的概率由平衡统计力学原理决定。对于处于平衡状态的两态系统，占据一个状态的概率与其玻尔兹曼因子成正比。成桥概率 $p_{bridge}$ 为：\n$$\np_{bridge} = \\frac{\\exp\\left(-\\frac{G_{\\mathrm{bridged}}}{RT}\\right)}{\\exp\\left(-\\frac{G_{\\mathrm{bridged}}}{RT}\\right) + \\exp\\left(-\\frac{G_{\\mathrm{unbridged}}}{RT}\\right)}\n$$\n将分子和分母同除以 $\\exp\\left(-\\frac{G_{\\mathrm{unbridged}}}{RT}\\right)$，并使用定义 $\\Delta G = G_{\\mathrm{bridged}} - G_{\\mathrm{unbridged}}$，我们得到：\n$$\np_{bridge} = \\frac{\\exp\\left(-\\frac{\\Delta G}{RT}\\right)}{1 + \\exp\\left(-\\frac{\\Delta G}{RT}\\right)} = \\frac{1}{1 + \\exp\\left(\\frac{\\Delta G}{RT}\\right)}\n$$\n\n我们必须首先计算自由能差 $\\Delta G_{un}$ 和 $\\Delta G_{ac}$。\n对于一个未乙酰化的界面：\n$$\n\\Delta G_{un} = E_{\\mathrm{elec,un}} + \\Delta G_{\\mathrm{conf}} = -6.0~\\mathrm{kJ~mol^{-1}} + 2.0~\\mathrm{kJ~mol^{-1}} = -4.0~\\mathrm{kJ~mol^{-1}}\n$$\n对于一个乙酰化的界面，静电引力减小到其原始大小的 $20\\%$：\n$$\nE_{\\mathrm{elec,ac}} = 0.20 \\times E_{\\mathrm{elec,un}} = 0.20 \\times (-6.0~\\mathrm{kJ~mol^{-1}}) = -1.2~\\mathrm{kJ~mol^{-1}}\n$$\n因此，一个乙酰化界面的自由能差为：\n$$\n\\Delta G_{ac} = E_{\\mathrm{elec,ac}} + \\Delta G_{\\mathrm{conf}} = -1.2~\\mathrm{kJ~mol^{-1}} + 2.0~\\mathrm{kJ~mol^{-1}} = +0.8~\\mathrm{kJ~mol^{-1}}\n$$\n接下来，我们计算热能标度 $RT$：\n$$\nRT = (8.314\\times 10^{-3}~\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}) \\times (298~\\mathrm{K}) \\approx 2.477572~\\mathrm{kJ~mol^{-1}}\n$$\n现在我们可以计算概率 $p_{un}$ 和 $p_{ac}$：\n$$\np_{un} = \\frac{1}{1 + \\exp\\left(\\frac{\\Delta G_{un}}{RT}\\right)} = \\frac{1}{1 + \\exp\\left(\\frac{-4.0}{2.477572}\\right)} \\approx \\frac{1}{1 + \\exp(-1.61448)} \\approx \\frac{1}{1 + 0.19899} \\approx 0.83403\n$$\n$$\np_{ac} = \\frac{1}{1 + \\exp\\left(\\frac{\\Delta G_{ac}}{RT}\\right)} = \\frac{1}{1 + \\exp\\left(\\frac{0.8}{2.477572}\\right)} \\approx \\frac{1}{1 + \\exp(0.32289)} \\approx \\frac{1}{1 + 1.38108} \\approx 0.41997\n$$\n有了这些概率，我们就可以求出总的期望成桥数：\n$$\n\\mathbb{E}[n_{b}] = N((1-f)p_{un} + fp_{ac}) = 11 \\times ((1-0.70) \\times 0.83403 + 0.70 \\times 0.41997)\n$$\n$$\n\\mathbb{E}[n_{b}] = 11 \\times (0.30 \\times 0.83403 + 0.70 \\times 0.41997) \\approx 11 \\times (0.25021 + 0.29398) = 11 \\times 0.54419 \\approx 5.9861\n$$\n现在我们计算阵列的期望长度：\n$$\n\\mathbb{E}[L] = L_{0} - \\mathbb{E}[n_{b}]s = 180~\\mathrm{nm} - 5.9861 \\times 3.0~\\mathrm{nm} \\approx 180~\\mathrm{nm} - 17.9583~\\mathrm{nm} = 162.0417~\\mathrm{nm}\n$$\n最后，我们计算压缩因子：\n$$\n\\mathrm{CF} = \\frac{L_{0}}{\\mathbb{E}[L]} = \\frac{180}{162.0417} \\approx 1.11082\n$$\n四舍五入到三位有效数字，结果是 $1.11$。", "answer": "$$\\boxed{1.11}$$", "id": "2958211"}, {"introduction": "理论模型的最终检验标准之一是其预测能力。最后一个练习将挑战你从第一性原理出发，构建一个用于预测核小体定位的强大计算模型[@problem_id:2958221]。你将推导并实现一个动态规划算法，它能根据DNA序列依赖的能量景观和统计力学规则，在宏大的基因组背景下计算出任意位置被核小体占据的概率，这是现代计算生物学中的一项核心技能。", "problem": "您将处理一个一维晶格模型，该模型用于描述长度为 $N$ 个碱基对的脱氧核糖核酸 (DNA)。模型中的核小体被模拟为长度固定为 $L$ 个碱基对的硬棒，它们之间不能重叠（空间排斥）。DNA 片段长度为 $N = 1000$ 个碱基对（一个 $1$ 千碱基的片段）。每个潜在的核小体起始位置 $s \\in \\{1,2,\\dots,N-L+1\\}$ 都被赋予一个序列依赖的结合能 $E_s$，该能量以热能 $k_\\mathrm{B}T$ 为单位，其中 $k_\\mathrm{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。该系统处于巨正则系综中，化学势为 $\\mu$（也以 $k_\\mathrm{B}T$ 为单位），并且空间排斥禁止核小体之间发生重叠。\n\n使用的基本原理：\n- 巨正则系综中的玻尔兹曼统计：一个总能量为 $E_\\text{tot}$、核小体数量为 $n$ 的构型的统计权重与 $\\exp\\!\\left(-\\frac{E_\\text{tot} - \\mu n}{k_\\mathrm{B}T}\\right)$ 成正比。在本问题中，所有能量都以 $k_\\mathrm{B}T = 1$ 为单位给出，因此权重简化为 $\\exp\\!\\left(-(E_\\text{tot} - \\mu n)\\right)$。\n- 空间排斥：两个核小体不能重叠；一个起始于位置 $s$ 的核小体覆盖碱基 $s, s+1, \\dots, s+L-1$。\n\n使用一个 $10$ 碱基对周期的能量函数来模拟序列依赖的结合：\n$$\nE_s = A \\cos\\!\\left(2\\pi \\frac{s - \\phi}{10}\\right),\n$$\n其中 $A$ 是振幅（以 $k_\\mathrm{B}T$ 为单位），$\\phi$ 是相位偏移（以碱基对为单位）。余弦函数的参数以弧度为单位。\n\n任务：\n- 基于上述基本原理，推导出一个动态规划算法，用于计算每个碱基 $k \\in \\{1,2,\\dots,N\\}$ 的预测碱基对占据率 $o_k$。占据率 $o_k$ 定义为在考虑空间排斥的巨正则系综中，碱基 $k$ 被某个核小体覆盖的边缘概率。\n- 在一个程序中用数值方法实现该算法，并处理以下参数集构成的测试套件。对于每个测试用例，使用 $N = 1000$ 以及指定的参数 $(L, A, \\phi, \\mu)$：\n  1. 理想情况：$L = 147$, $A = 1.5$, $\\phi = 0.0$, $\\mu = 0.0$。\n  2. 恒定能量，低占据率：$L = 147$, $A = 0.0$, $\\phi = 0.0$, $\\mu = -3.0$。\n  3. 相位偏移，高占据率：$L = 147$, $A = 1.0$, $\\phi = 2.5$, $\\mu = 2.0$。\n  4. 强周期性，极低占据率：$L = 147$, $A = 2.0$, $\\phi = 5.0$, $\\mu = -5.0$。\n\n要求：\n- 仅使用上述物理原理和定义作为出发点。除了空间排斥和巨正则系综中的玻尔兹曼统计之外，不要引入任何额外的假设。\n- 根据定义，余弦函数内的角度单位是弧度；相位 $\\phi$ 如公式所示，以碱基对为单位指定。\n- 将每个碱基对占据率 $o_k$ 表示为四舍五入到六位小数的浮点数。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果。结果是一个用方括号括起来的逗号分隔列表，其中每个元素本身是该测试用例的 $N$ 个四舍五入后占据率组成的、用方括号括起来的逗号分隔列表。具体而言，输出必须采用以下形式\n  $$\n  \\big[\\,[o^{(1)}_1,o^{(1)}_2,\\dots,o^{(1)}_{1000}]\\,,\\,[o^{(2)}_1,\\dots,o^{(2)}_{1000}]\\,,\\,[o^{(3)}_1,\\dots,o^{(3)}_{1000}]\\,,\\,[o^{(4)}_1,\\dots,o^{(4)}_{1000}]\\,\\big]\n  $$\n  该行中任何地方都不能有空格。\n- 因此，每个测试用例的答案是一个包含 $N$ 个浮点数的列表，程序以指定的单行格式输出这些列表的列表。\n\n关于科学真实性的说明：\n- 所有测试用例均使用经典的核小体长度 $L = 147$。\n- $10$ 碱基对的周期性反映了公认的核小体 DNA 的旋转定位偏好。\n\n您的程序必须是自包含的，且不得读取任何输入。它必须使用从所述基本原理推导出的、基于原理的动态规划方法来计算占据率，并以上述确切格式打印结果。", "solution": "所提出的问题是统计生物物理学中一个有效且适定的问题。它具有科学依据，没有矛盾，并且提供了所有必要的参数。任务是推导并实现一个动态规划算法来计算 DNA 晶格上的核小体占据率，这是一个标准的、可解的问题。我现在将进行推导和求解。\n\n该系统是一个由 $N$ 个位点组成的一维晶格，代表一个由 $N$ 个碱基对组成的 DNA 分子。核小体被建模为长度为 $L$ 个碱基对的硬棒，可以与晶格结合。一个起始于位点 $s$ 的核小体占据片段 $[s, s+1, \\dots, s+L-1]$。所有可能的起始位置集合为 $s \\in \\{1, 2, \\dots, N-L+1\\}$。由于空间排斥，任意两个核小体都不能重叠。\n\n该系统处于固定温度 $T$ 和化学势 $\\mu$ 的巨正则系综中。一个起始于位置 $s$ 的核小体的结合与能量 $E_s$ 相关。所有能量和化学势都以热能 $k_B T$ 为单位，并设为 $1$。系统的一个特定构型由 $n$ 个不重叠核小体的起始位置集合 $\\{s_1, \\dots, s_n\\}$ 定义。这样一个构型的统计权重由玻尔兹曼因子给出：\n$$ W(\\{s_1, \\dots, s_n\\}) = \\exp\\left(-\\left(\\sum_{i=1}^n E_{s_i} - n\\mu\\right)\\right) = \\prod_{i=1}^n \\exp(\\mu - E_{s_i}) $$\n我们将起始于位置 $s$ 的单个核小体的权重因子定义为 $w_s = \\exp(\\mu - E_s)$。能量 $E_s$ 由以下周期函数给出：\n$$ E_s = A \\cos\\left(2\\pi \\frac{s - \\phi}{10}\\right) $$\n巨正则配分函数 $Z$ 是所有可能的有效（不重叠）构型的权重之和：\n$$ Z = \\sum_{\\text{all valid configs}} \\prod_{i=1}^n w_{s_i} $$\n我们的目标是计算每个碱基对 $k \\in \\{1, \\dots, N\\}$ 的占据率 $o_k$。占据率 $o_k$ 是位点 $k$ 被任意一个核小体覆盖的边缘概率。由于覆盖位点 $k$ 的核小体的放置是互斥事件（因为空间排斥，只有一个核小体能覆盖给定位置），占据率是覆盖位点 $k$ 的核小体存在的边缘概率之和。\n一个起始于位置 $s$ 的核小体覆盖位点 $k$ 的条件是 $s \\le k < s+L$。因此，能够覆盖位点 $k$ 的起始位置 $s$ 的范围是 $s \\in [\\max(1, k-L+1), \\min(k, N-L+1)]$。设 $P_s$ 为一个核小体起始于位置 $s$ 的边缘概率。那么占据率 $o_k$ 为：\n$$ o_k = \\sum_{s=\\max(1, k-L+1)}^{\\min(k, N-L+1)} P_s $$\n问题简化为计算所有可能起始位置 $s$ 的 $P_s$。这需要使用动态规划方法。\n\n我们定义两组辅助配分函数。设 $Z^F_i$ 为长度为 $i$ 的晶格前缀（位点 $1, \\dots, i$）的配分函数。设 $Z^B_i$ 为从位点 $i$ 开始的晶格后缀（位点 $i, \\dots, N$）的配分函数。\n\n前向配分函数 $Z^F_i$ 可以通过以下递推关系计算。考虑位点 $i$ 的状态：\n1.  位点 $i$ 未被占据。长度为 $i$ 的前缀上的构型就是长度为 $i-1$ 的前缀上的构型。这些构型的权重之和为 $Z^F_{i-1}$。\n2.  位点 $i$ 被一个核小体的末端占据。这个核小体长度必须为 $L$，因此它起始于 $s = i-L+1$ 并占据位点 $[i-L+1, \\dots, i]$。这仅在 $i-L+1 \\ge 1$ （即 $i \\ge L$）时才可能。这个核小体的权重是 $w_{i-L+1}$。晶格的前面部分，即位点 $[1, \\dots, i-L]$，可以处于任何有效构型，其总权重之和为 $Z^F_{i-L}$。这种情况的贡献为 $w_{i-L+1}Z^F_{i-L}$。\n\n这两种情况是互斥的。因此，$Z^F_i$ 的递推关系是：\n$$ Z^F_i = \\begin{cases} Z^F_{i-1} & \\text{if } 1 \\le i < L \\\\ Z^F_{i-1} + w_{i-L+1} Z^F_{i-L} & \\text{if } L \\le i \\le N \\end{cases} $$\n初始条件是 $Z^F_0 = 1$，代表一个权重为 $1$ 的空晶格。我们可以迭代地计算 $Z^F_1, \\dots, Z^F_N$。整个晶格的总配分函数是 $Z = Z^F_N$。\n\n类似地，后向配分函数 $Z^B_i$ 通过考虑位点 $i$ 的状态，由一个递推关系计算得出：\n1.  位点 $i$ 未被占据。后缀 $[i, \\dots, N]$ 上的构型总权重由后缀 $[i+1, \\dots, N]$ 的配分函数给出，即 $Z^B_{i+1}$。\n2.  位点 $i$ 被一个核小体的起始端占据。这个核小体占据位点 $[i, \\dots, i+L-1]$，这仅在 $i+L-1 \\le N$ （即 $i \\le N-L+1$）时才可能。其权重为 $w_i$。剩余的后缀 $[i+L, \\dots, N]$ 可以处于任何状态，总权重为 $Z^B_{i+L}$。其贡献为 $w_i Z^B_{i+L}$。\n\n$Z^B_i$ 的递推关系是：\n$$ Z^B_i = \\begin{cases} Z^B_{i+1} & \\text{if } N-L+1 < i \\le N \\\\ Z^B_{i+1} + w_i Z^B_{i+L} & \\text{if } 1 \\le i \\le N-L+1 \\end{cases} $$\n初始条件是 $Z^B_{N+1} = 1$。我们迭代地计算 $Z^B_N, \\dots, Z^B_1$。作为一致性检查，$Z = Z^B_1$。\n\n利用前向和后向配分函数，我们可以计算边缘概率 $P_s$。包含一个起始于 $s$（占据 $[s, s+L-1]$）的核小体的所有构型的权重是三个独立项的乘积：前缀 $[1, s-1]$ 的配分函数 $Z^F_{s-1}$；核小体本身的权重 $w_s$；以及后缀 $[s+L, N]$ 的配分函数 $Z^B_{s+L}$。\n边缘概率即为这个总权重被巨配分函数 $Z$ 归一化：\n$$ P_s = \\frac{Z^F_{s-1} \\cdot w_s \\cdot Z^B_{s+L}}{Z^F_N} $$\n此表达式对于 $s \\in \\{1, \\dots, N-L+1\\}$ 有效。\n\n由于权重的指数特性，$Z^F_i$ 和 $Z^B_i$ 的值会增长得极大，导致数值溢出。为确保稳定性，所有计算必须在对数空间中进行。令 $\\text{LZF}_i = \\log(Z^F_i)$ 和 $\\text{LZB}_i = \\log(Z^B_i)$。递推关系变为：\n$$ \\text{LZF}_i = \\log(e^{\\text{LZF}_{i-1}} + e^{\\text{LZF}_{i-L} + \\log w_{i-L+1}}) = \\text{logsumexp}(\\text{LZF}_{i-1}, \\text{LZF}_{i-L} + \\log w_{i-L+1}) $$\n$$ \\text{LZB}_i = \\log(e^{\\text{LZB}_{i+1}} + e^{\\text{LZB}_{i+L} + \\log w_i}) = \\text{logsumexp}(\\text{LZB}_{i+1}, \\text{LZB}_{i+L} + \\log w_i) $$\n其中 $\\log w_s = \\mu - E_s$。`logsumexp` 函数可以稳健地计算指数和的对数。初始条件为 $\\text{LZF}_0 = 0$ 和 $\\text{LZB}_{N+1} = 0$。\n对数概率为：\n$$ \\log P_s = \\text{LZF}_{s-1} + \\log w_s + \\text{LZB}_{s+L} - \\text{LZF}_N $$\n由此我们得到 $P_s = \\exp(\\log P_s)$。\n\n最终的算法，在实现时使用从0开始的索引（位点 $0, \\dots, N-1$；起始位置 $0, \\dots, N-L$），如下所示：\n1.  对每个潜在的起始位点 $s \\in \\{0, \\dots, N-L\\}$，计算能量 $E_s$ 和对数权重 $\\log w_s = \\mu - E_s$。\n2.  使用递推关系计算前向对数配分函数数组 $\\text{LZF}[0, \\dots, N]$。$\\text{LZF}[i]$ 对应于长度为 $i$ 的前缀。\n3.  使用递推关系计算后向对数配分函数数组 $\\text{LZB}[0, \\dots, N+1]$。$\\text{LZB}[i]$ 对应于从位点 $i$ 开始的后缀。\n4.  对每个起始位点 $s$，使用对数空间公式计算概率 $P_s$：$P_s = \\exp(\\text{LZF}[s] + \\log w_s + \\text{LZB}[s+L] - \\text{LZF}[N])$。\n5.  对每个碱基位点 $k \\in \\{0, \\dots, N-1\\}$，通过对所有覆盖它的核小体的概率求和来计算占据率 $o_k$：$o_k = \\sum_{s=\\max(0, k-L+1)}^{\\min(k, N-L)} P_s$。\n6.  将结果四舍五入到指定精度。\n这个过程为问题提供了一个完整、正确且数值稳定的解决方案。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import logsumexp\n\ndef calculate_occupancies(N, L, A, phi, mu):\n    \"\"\"\n    Calculates nucleosome occupancy profiles using a dynamic programming algorithm.\n\n    This function implements a 1D lattice model for nucleosome positioning in the\n    grand canonical ensemble. It uses forward and backward dynamic programming\n    passes in logarithmic space to ensure numerical stability.\n\n    Args:\n        N (int): Length of the DNA lattice in base pairs.\n        L (int): Length of a nucleosome in base pairs.\n        A (float): Amplitude of the periodic energy function (in k_B*T).\n        phi (float): Phase offset of the energy function (in base pairs).\n        mu (float): Chemical potential for nucleosome binding (in k_B*T).\n\n    Returns:\n        list[float]: A list of N base-pair occupancies, rounded to 6 decimal places.\n    \"\"\"\n    # Step 1: Pre-compute energies and log-weights\n    # The problem statement uses 1-based indexing for start position 's'.\n    # Our 's_positions' array is 0-based (0 to N-L), so we use (s+1) in the formula.\n    s_positions = np.arange(0, N - L + 1)\n    energies = A * np.cos(2 * np.pi * (s_positions + 1 - phi) / 10.0)\n    log_weights = mu - energies\n\n    # Step 2: Forward DP pass to calculate log-partition functions for prefixes\n    # log_Z_fwd[i] stores the log partition function for the prefix of length i (sites 0..i-1)\n    log_Z_fwd = np.zeros(N + 1)\n    # Base case: log_Z_fwd[0] = log(1) = 0 for an empty prefix.\n    # For prefixes shorter than L, no nucleosome can be placed ending at the last site.\n    for i in range(1, L):\n        log_Z_fwd[i] = log_Z_fwd[i-1]  # log(1)=0\n    # For prefixes of length L or more, apply the full recurrence.\n    for i in range(L, N + 1):\n        # Recurrence: Z[i] = Z[i-1] (site i-1 is free) + Z[i-L]*w[i-L] (site i-1 is end of nuc.)\n        # The nucleosome starts at i-L (0-based).\n        log_Z_fwd[i] = logsumexp([log_Z_fwd[i-1], log_Z_fwd[i-L] + log_weights[i-L]])\n    \n    log_Z_total = log_Z_fwd[N]\n\n    # Step 3: Backward DP pass to calculate log-partition functions for suffixes\n    # log_Z_bwd[i] stores the log partition function for the suffix from site i to N-1.\n    log_Z_bwd = np.zeros(N + 2) # N+1 is index for empty suffix, N+2 size\n    # Base case: log_Z_bwd[N+1] = log(1) = 0 for an empty suffix after site N.\n    # The array is indexed such that log_Z_bwd[i] corresponds to suffix starting at i.\n    # The true empty suffix starts after site N-1, at site N. So we use log_Z_bwd[N].\n    log_Z_bwd[N] = 0.0 # Suffix from N to N-1 (empty)\n\n    # For suffixes where a nucleosome cannot start and fit, the partition function is 1.\n    for i in range(N - 1, N - L, -1):\n        log_Z_bwd[i] = log_Z_bwd[i+1] # effectively propagates the log(1)=0\n    # For suffixes long enough, apply the full recurrence.\n    for i in range(N - L, -1, -1):\n        # Recurrence: Z[i] = Z[i+1] (site i is free) + Z[i+L]*w[i] (site i is start of nuc.)\n        log_Z_bwd[i] = logsumexp([log_Z_bwd[i+1], log_Z_bwd[i+L] + log_weights[i]])\n\n    # Step 4: Calculate marginal probabilities of a nucleosome starting at each site s\n    P_s = np.zeros(N - L + 1)\n    for s in range(N - L + 1):\n        # log(P_s) = log(Z_fwd_prefix) + log(weight_s) + log(Z_bwd_suffix) - log(Z_total)\n        # Prefix before s is sites 0..s-1, has partition function log_Z_fwd[s].\n        # Suffix after nucleosome starting at s (ends at s+L-1) is sites s+L..N-1. This is log_Z_bwd[s+L].\n        log_p = log_Z_fwd[s] + log_weights[s] + log_Z_bwd[s+L] - log_Z_total\n        P_s[s] = np.exp(log_p)\n\n    # Step 5: Calculate base-pair occupancies by summing probabilities\n    occupancies = np.zeros(N)\n    for k in range(N):\n        # Site k is covered by a nucleosome starting at s if k-L+1 <= s <= k.\n        s_start = max(0, k - L + 1)\n        s_end = min(k, N - L)\n        if s_start <= s_end:\n            occupancies[k] = np.sum(P_s[s_start : s_end + 1])\n    \n    return [round(o, 6) for o in occupancies]\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, A, phi, mu)\n        (147, 1.5, 0.0, 0.0),      # Happy path\n        (147, 0.0, 0.0, -3.0),     # Flat energy, low occupancy\n        (147, 1.0, 2.5, 2.0),      # Phase shift, high occupancy\n        (147, 2.0, 5.0, -5.0),     # Strong periodicity, very low occupancy\n    ]\n    \n    N = 1000\n    results = []\n    for L, A, phi, mu in test_cases:\n        result = calculate_occupancies(N, L, A, phi, mu)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # e.g., [[0.1,0.2,...],[0.3,0.4,...],...] with no spaces.\n    inner_strs = [','.join(map(str, r)) for r in results]\n    print(f\"[[{'],['.join(inner_strs)}]]\")\n\nsolve()\n```", "id": "2958221"}]}