{"hands_on_practices": [{"introduction": "本节的第一个练习将检验你对环路挤压模型的概念性理解，该模型是高级染色质组织的核心。通过预测在关键蛋白（CTCF、黏连蛋白和WAPL）被降解后Hi-C图谱将如何变化，你可以巩固对这些分子机器各自角色的认识。这种定性推理是解读遗传扰动实验数据的一项基本技能。[@problem_id:2947793]", "problem": "您正在分析来自一种人类细胞系的 Hi-C（原位染色体构象捕获）图谱，该实验涉及一个生长素诱导的 degron 时间序列，并包含三种扰动：CCCTC 结合因子 (CTCF) 的急性降解、一个核心 cohesin 亚基的急性降解，以及 Wings apart-like protein homolog (WAPL) 的遗传性缺失。仅使用环挤压模型和已建立的 Hi-C 特征定义，判断在每种扰动下，环 (loop)、条纹 (stripe) 以及 A/B 区室化 (compartmentalization) 预计会发生何种模式的变化。您的推理应基于以下几点：cohesin 沿着染色质驱动持续的环挤压，直到被 CTCF 等定向边界元件所阻止；WAPL 促进 cohesin 从染色质上释放，从而限制 cohesin 的停留时间和持续性；Hi-C 环在环锚定点处表现为局灶性富集峰；条纹表现为从一个强锚定点沿对角线延伸的单侧接触富集；拓扑关联结构域 (TAD) 表现为沿对角线的方形区域，反映了局部的绝缘性；A/B 区室反映了活性和非活性染色质的分离，并表现为长程的格子状图案；并且，在短基因组距离上，挤压驱动的接触与区室分离存在竞争关系。未提供数值测量结果。请选择最符合每种扰动预期的定性 Hi-C 特征的选项。\n\nA. CTCF 急性降解：先前汇聚锚定点处的局灶性环消失，绝缘性和条纹减弱，A/B 区室化明显增强；cohesin 急性降解：环、条纹和局部 TAD 结构几乎完全消失，A/B 区室化增强；WAPL 缺失：锚定点处出现更强的角峰和显著的延伸条纹，结构域范围扩大，在短基因组距离上 A/B 区室化减弱。\n\nB. CTCF 急性降解：由于挤压不受阻碍，环更强，条纹更长，A/B 区室化减弱；cohesin 急性降解：环消失，但由于挤压从剩余锚定点继续进行，出现条纹，区室化不变；WAPL 缺失：由于 cohesin 暂停减少，环强度降低，条纹减少，A/B 区室化增强。\n\nC. CTCF 急性降解：环消失，但由于挤压不再停滞，条纹增强，区室化不变；cohesin 急性降解：环减少，但由于绝缘性增加，TAD 边界增强，A/B 区室化减弱；WAPL 缺失：由于挤压被增强，区室化增强，条纹减少。\n\nD. CTCF 急性降解：由于 cohesin 仍然存在，环和条纹变化极小，但 A/B 区室化增强；cohesin 急性降解：由于 CTCF 锚定点占主导，环更强，条纹更长，A/B 区室化减弱；WAPL 缺失：由于 cohesin 停留时间过长，TAD 和环消失，区室化增强。\n\n选择唯一最佳选项。", "solution": "首先将对问题陈述进行严格验证，以确保其科学合理、定义明确且客观。\n\n**步骤 1：提取已知条件**\n\n问题提供了以下模型、定义和实验条件：\n- **系统**：一种人类细胞系中的生长素诱导的 degron 时间序列实验。\n- **模型**：环挤压模型是唯一的推理基础。\n- **扰动**：\n    1.  CCCTC 结合因子 (CTCF) 的急性降解。\n    2.  一个核心 cohesin 亚基的急性降解。\n    3.  Wings apart-like protein homolog (WAPL) 的遗传性缺失。\n- **核心原理与定义**：\n    - 原理 $1$：Cohesin 沿着染色质驱动持续的环挤压。\n    - 原理 $2$：环挤压被 CTCF 等定向边界元件所阻止。\n    - 原理 $3$：WAPL 促进 cohesin 从染色质上释放，限制其停留时间和持续性。\n    - 定义 $1$：Hi-C 环表现为在环锚定点处的局灶性富集峰。\n    - 定义 $2$：条纹表现为从一个强锚定点沿对角线延伸的单侧接触富集。\n    - 定义 $3$：拓扑关联结构域 (TAD) 表现为沿对角线的方形区域，反映了局部的绝缘性。\n    - 定义 $4$：A/B 区室反映了活性和非活性染色质的分离，并表现为长程的格子状图案。\n    - 原理 $4$：在短基因组距离上，挤压驱动的接触与区室分离存在竞争关系。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n根据所需标准对问题进行评估。\n- **科学依据**：该问题基于环挤压模型，这是解释高级染色质组织的主流且有实验支持的框架。cohesin（马达）、CTCF（边界）和 WAPL（释放因子）的作用在分子和细胞生物学领域是经典且公认的。所描述的实验是用于探测染色质结构的常规技术。因此，该问题是科学合理的。\n- **定义明确**：该问题要求基于一组明确定义的规则和分子参与者进行定性预测。所提供的原理和定义足以推断出每种扰动下的一组唯一预期结果。\n- **客观性**：该问题使用了精确的技术语言（例如，“局灶性富集峰”、“持续的环挤压”），并避免了任何主观或模糊的术语。\n- **一致性与完整性**：所提供的信息是自洽且充分的。例如，“挤压与区室化竞争”这一陈述是解决结果中潜在模糊性的关键信息。没有缺失数据或相互矛盾的约束。\n\n**步骤 3：结论与行动**\n\n问题陈述有效。这是一个定义明确、有科学依据的问题，需要严格应用一个已定义的生物物理模型。可以进行分析。\n\n**求解推导**\n\n将通过把给定的原理（原理 $1-4$）和定义（定义 $1-4$）应用于三种扰动中的每一种来推导解决方案。\n\n**扰动 1：CTCF 的急性降解**\n- **前提**：CTCF 提供阻止 cohesin 驱动的环挤压的边界元件（原理 $2$）。环（定义 $1$）和 TAD 边界（定义 $3$）在这些元件处形成。\n- **推理**：在 CTCF 急性降解后，主要的边界元件被移除。Cohesin 驱动的挤压（原理 $1$）不再能在特定位置被有效阻滞。因此，依赖于这种阻滞的稳定结构——即由成对的汇聚 CTCF 位点定义的环以及 TAD 的绝缘边界——将会消失。定义环的局灶性接触富集（角峰）将会消失。TAD 方形区域的清晰边界将溶解，导致绝缘性减弱。条纹（定义 $2$）由强锚定点（通常是 CTCF）的挤压形成，随着这些锚定点的移除，条纹也将消失或严重减弱。根据原理 $4$，挤压驱动的接触与区室分离竞争。结构化的局部接触（环、TAD）的丧失减少了这种竞争，使得潜在的、长程的 A/B 区室化（定义 $4$）在 Hi-C 图谱中变得更加突出。\n- **结论**：CTCF 降解导致环、条纹和 TAD 消失，同时 A/B 区室明显增强。\n\n**扰动 2：一个核心 cohesin 亚基的急性降解**\n- **前提**：Cohesin 是驱动持续环挤压的马达（原理 $1$）。\n- **推理**：核心 cohesin 亚基的降解使环挤压机制本身失效。没有马达，形成环、条纹和 TAD 的过程就无法发生。因此，所有作为环挤压直接产物的 Hi-C 特征将几乎完全从图谱中被抹去。这包括局灶性环峰、条纹和绝缘的方形 TAD 结构。与 CTCF 降解的情况一样，移除与之竞争的挤压过程（原理 $4$）将导致由独立机制建立的 A/B 区室的格子状图案成为 Hi-C 图谱中最主要和最明显的特征。\n- **结论**：Cohesin 降解导致环、条纹和 TAD 几乎完全消失，同时 A/B 区室化增强。\n\n**扰动 3：WAPL 的遗传性缺失**\n- **前提**：WAPL 促进 cohesin 释放，从而限制其停留时间和持续性（原理 $3$）。\n- **推理**：WAPL 的遗传性缺失阻止了 cohesin 从染色质上有效卸载。这导致 cohesin 复合体在 DNA 上停留的时间长得多，并且以更强的持续性挤压环。这种超持续性挤压有几个后果。首先，当挤压被 CTCF 边界阻滞时，卷入环中的染色质数量要大得多，并且 cohesin 复合体在锚定点处更稳定。这增强了环锚定点处的接触频率，导致更强的角峰（定义 $1$）。其次，从单个强边界开始的挤压将进行更长的距离，产生非常突出和延伸的条纹（定义 $2$）。TAD 的平均大小可能会扩大（结构域范围扩大）。第三，这种由挤压介导的强局部接触的急剧增加，加剧了与区室分离的竞争（原理 $4$）。这些增强的局部接触可以压倒或掩盖定义 A/B 区室的较弱的长程接触，特别是在短到中等基因组距离上。\n- **结论**：WAPL 缺失导致更强的环（角峰）和更长、更突出的条纹，相应地，在较短的基因组范围内 A/B 区室化减弱。\n\n**逐项分析**\n\n- **选项 A**：\n    - **CTCF 降解**：预测“先前汇聚锚定点处的局灶性环消失 [...]，绝缘性和条纹减弱，A/B 区室化明显增强”。这是**正确**的。\n    - **Cohesin 降解**：预测“环、条纹和局部 TAD 结构几乎完全消失，A/B 区室化增强”。这是**正确**的。\n    - **WAPL 缺失**：预测“锚定点处出现更强的角峰和显著的延伸条纹 [...]，结构域范围扩大，在短基因组距离上 A/B 区室化减弱”。这是**正确**的。\n    - **判定**：此选项与所有三个推导出的结论完全一致。\n\n- **选项 B**：\n    - **CTCF 降解**：预测“更强的环和更长的条纹”。这直接与 CTCF 作为形成这些特征所必需的边界元件的公认作用相矛盾。边界的丧失阻止了稳定的环和条纹的形成。这个陈述在根本上是错误的。\n    - **判定**：**错误**。\n\n- **选项 C**：\n    - **CTCF 降解**：预测“条纹增强，因为挤压不再停滞”。这是一个逻辑矛盾。条纹是在锚定点处挤压停滞的特征。如果挤压不停滞，条纹就无法形成，更不用说增强了。\n    - **判定**：**错误**。\n\n- **选项 D**：\n    - **CTCF 降解**：预测“环和条纹变化极小”。这是不正确的。移除必要的边界元件 (CTCF) 必然会引起巨大的变化，而不是微小的变化。\n    - **Cohesin 降解**：预测“更强的环和更长的条纹”。这是荒谬的。移除环挤压的马达不可能产生更强的环；它必然会消除它们。\n    - **判定**：**错误**。\n\n基于严格的、依据原理的分析，选项 A 是唯一对所有三种扰动的预期 Hi-C 特征提供了科学正确描述的选项。", "answer": "$$\\boxed{A}$$", "id": "2947793"}, {"introduction": "理解了基本机制后，下一个练习将引导你应用定量模型来预测基因调控。你将使用基于分形球状体模型的接触概率标度律 $P(s) \\propto s^{-\\alpha}$，来计算增强子与启动子之间基因组距离的变化对基因表达的精确影响。这个练习展示了如何将聚合物物理学的原理转化为对生物学结果的可检验的预测。[@problem_id:2947750]", "problem": "一个基因由一个增强子激活，该增强子通过三维染色质折叠与其启动子接触。在高通量染色体构象捕获 (Hi-C) 技术中，经验观察到的、在分形球状体（fractal globule）状态下相距基因组距离 $s$ 的两个基因座之间的接触概率遵循标度律 $P(s)=C\\,s^{-\\alpha}$，其中 $C$ 是一个与 $s$ 无关的常数，$\\alpha$ 是表征聚合物状态的标度指数。假设在所研究的长度尺度范围内，该聚合物处于分形球状体状态，且 $\\alpha=1$。转录激活水平与一个协同性的接触依赖项成正比，即 $E(s)\\propto [P(s)]^{n}$，其中 $n$ 是一个捕获多价或协同激活需求的希尔系数（Hill coefficient）。\n\n一个增强子从基因组分离距离 $s_{1}=50\\,\\text{kb}$ 处被重新定位到 $s_{2}=500\\,\\text{kb}$ 处。仅使用所述的标度律和比例关系，推导表达的倍数变化（fold-change），其定义为无量纲比率 $F=\\dfrac{E(s_{2})}{E(s_{1})}$，并将其表示为关于 $n$ 的封闭形式解析表达式。以一个无单位的简化单一表达式报告最终答案。", "solution": "首先将对问题进行严格验证，以确定其科学和逻辑上的完整性。\n\n问题陈述中给出的已知条件如下：\n$1$. 相距基因组距离 $s$ 的两个基因座之间的接触概率由标度律 $P(s)=C\\,s^{-\\alpha}$ 给出。\n$2$. 系统处于分形球状体状态，其标度指数被指定为 $\\alpha=1$。\n$3$. 转录激活水平 $E(s)$ 与一个涉及接触概率的协同项成正比：$E(s)\\propto [P(s)]^{n}$，其中 $n$ 是一个希尔系数。\n$4$. 一个增强子从初始基因组分离距离 $s_{1}=50\\,\\text{kb}$ 移动到最终分离距离 $s_{2}=500\\,\\text{kb}$。\n$5$. 目标是推导表达的倍数变化，定义为比率 $F=\\dfrac{E(s_{2})}{E(s_{1})}$。\n\n现在，我们评估该问题的有效性。所呈现的模型是分子生物学和聚合物物理学中用于描述染色质组织的一个标准简化表示。标度律 $P(s) \\propto s^{-1}$ 是分形球状体的特征标志，这是一种无结的聚合物构象，允许密集堆积同时保持可及性，这与在特定长度尺度内对染色质组织的实验观察结果一致。在系统生物学中，使用类希尔方程来模拟协同生物激活是一种常见且被接受的方法。给定的参数和值（$s_{1}=50\\,\\text{kb}$，$s_{2}=500\\,\\text{kb}$）对于增强子-启动子距离而言是物理上现实的。该问题是自洽的、有科学依据的、适定的，没有内部矛盾或歧义。因此，该问题被认为是有效的，并将推导求解。\n\n转录激活水平 $E(s)$ 与 $[P(s)]^n$ 成正比。这可以通过引入一个比例常数（我们称之为 $k_{E}$）来表示为一个方程：\n$$E(s) = k_{E} [P(s)]^n$$\n接触概率 $P(s)$ 由标度律给出：\n$$P(s) = C s^{-\\alpha}$$\n问题陈述指出，在所研究的分形球状体状态下，标度指数为 $\\alpha = 1$。代入此值，接触概率变为：\n$$P(s) = C s^{-1}$$\n现在，我们将这个 $P(s)$ 的表达式代入激活水平 $E(s)$ 的方程中：\n$$E(s) = k_{E} [C s^{-1}]^n = k_{E} C^n s^{-n}$$\n$E(s)$ 的表达式表明，激活水平随基因组距离的变化规律为 $s^{-n}$。\n\n我们需要求出倍数变化 $F$，其定义为在新位置 $s_{2}$ 的表达水平与在原位置 $s_{1}$ 的表达水平之比：\n$$F = \\frac{E(s_{2})}{E(s_{1})}$$\n使用推导出的 $E(s)$ 表达式，我们可以写出 $E(s_{1})$ 和 $E(s_{2})$ 的项：\n$$E(s_{1}) = k_{E} C^n s_{1}^{-n}$$\n$$E(s_{2}) = k_{E} C^n s_{2}^{-n}$$\n现在，我们构建比率 $F$：\n$$F = \\frac{k_{E} C^n s_{2}^{-n}}{k_{E} C^n s_{1}^{-n}}$$\n常数 $k_{E}$ 和 $C^n$ 与 $s$ 无关，因此可以从分子和分母中消去：\n$$F = \\frac{s_{2}^{-n}}{s_{1}^{-n}}$$\n这可以利用指数的性质重写为：\n$$F = \\left(\\frac{s_{2}}{s_{1}}\\right)^{-n} = \\left(\\frac{s_{1}}{s_{2}}\\right)^{n}$$\n问题给出了基因组分离距离的具体值：$s_{1} = 50\\,\\text{kb}$ 和 $s_{2} = 500\\,\\text{kb}$。我们将这些值代入 $F$ 的表达式中。千碱基（$\\text{kb}$）的单位在分子和分母中是相同的，将会消去：\n$$\\frac{s_{1}}{s_{2}} = \\frac{50\\,\\text{kb}}{500\\,\\text{kb}} = \\frac{50}{500} = \\frac{1}{10}$$\n将此比率代回 $F$ 的方程中：\n$$F = \\left(\\frac{1}{10}\\right)^{n}$$\n这就是关于希尔系数 $n$ 的倍数变化的封闭形式解析表达式。一个更紧凑的表示是：\n$$F = 10^{-n}$$\n这个结果表明，对于遵循这些标度律的系统，将一个增强子移动到距离其靶启动子远10倍的位置，会导致基因表达下降 $10^n$ 倍。", "answer": "$$\\boxed{10^{-n}}$$", "id": "2947750"}, {"introduction": "最后的实践练习将理论与计算相结合，要求你构建一个基于环路挤压第一性原理的预测模型。你将通过编写代码，模拟删除一个拓扑关联结构域（TAD）边界后，增强子-启动子接触的重连及其对基因活性的影响。这项练习不仅巩固了你对边界功能和异位接触的理解，还为你提供了在现代分子生物学研究中至关重要的计算建模技能。[@problem_id:2947808]", "problem": "实现一个简化的、基于第一性原理的环挤压预测器，用于预测边界元件删除后增强子-启动子之间的通讯。目标是使用一个基于聚合物物理学和屏障渗透性的接触重加权框架，计算因边界删除而产生的异位增强子-启动子接触所引起的启动子活性的预测倍数变化。该程序必须为每个指定的测试用例计算一个无量纲的启动子活性倍数变化，该变化定义为删除后活性与删除前活性的比值，并将所有结果在单行中报告。\n\n模型规格：\n1. 基线基因组接触权重：对于位于位置 $x_i$ 和 $x_j$ （单位：碱基对）的两个位点，定义基因组距离 $d = |x_i - x_j|$。基线接触权重为\n$$\nW(d) = \\frac{1}{1 + \\left(\\frac{d}{\\lambda}\\right)^{\\alpha}},\n$$\n其中 $\\lambda$ 是一个长度标度（单位：碱基对），$\\alpha$ 是一个聚合物标度指数。\n\n2. 作为独立穿越事件的边界衰减：假设有一组边界元件，由索引 $k$ 标识，其基因组位置为 $b_k$（单位：碱基对），渗透性为 $s_k \\in [0,1]$。对于位于 $x_i$ 和 $x_j$ 的一对位点，定义衰减因子\n$$\nA(x_i, x_j; \\{(b_k, s_k)\\}) = \\prod_{k: \\min(x_i,x_j) < b_k < \\max(x_i,x_j)} s_k,\n$$\n即，严格位于这两个位点之间的所有边界的渗透性的乘积。边界删除通过在删除后状态下将指定删除集 $D$ 中所有索引 $k$ 的 $s_k$ 设置为 1 来建模，而在删除前状态下保持 $s_k$ 不变。\n\n3. 来自增强子接触重加权的启动子活性：假设一个启动子位于位置 $p$（单位：碱基对），增强子是一个由数对 $(e_m, w_m)$ 组成的列表，其中 $e_m$ 是增强子位置（单位：碱基对），$w_m$ 是一个非负的增强子权重（无量纲）。预测的启动子活性为\n$$\nS = \\sum_{m} w_m \\, W(|e_m - p|) \\, A(e_m, p; \\{(b_k, s_k)\\}).\n$$\n\n4. 启动子活性的倍数变化：设 $S_{\\mathrm{before}}$ 是使用删除前渗透性计算的启动子活性，设 $S_{\\mathrm{after}}$ 是在为所有 $k \\in D$ 设置 $s_k = 1$ 后计算的启动子活性。每个测试用例所需的输出是无量纲的倍数变化\n$$\nF = \\frac{S_{\\mathrm{after}}}{S_{\\mathrm{before}}}.\n$$\n\n常量：\n- 使用聚合物标度指数 $\\alpha = 1.5$。\n- 使用长度标度 $\\lambda = 20000$ 碱基对。\n\n单位和数值要求：\n- 所有基因组位置和 $\\lambda$ 的单位均为碱基对。\n- 增强子权重 $w_m$ 是无量纲的。\n- 倍数变化 $F$ 是无量纲的，并且必须以浮点小数形式报告。\n- 此问题不涉及角度。\n- 不要用百分号表示任何结果。\n\n程序中每个测试用例的输入规格（不提供外部输入；程序必须嵌入测试套件）：\n- 一个区域长度 $L$（单位：碱基对），模型不直接使用，但为完整性而提供。\n- 一个启动子位置 $p$（单位：碱基对）。\n- 一个增强子列表 $[(e_m, w_m)]$，其中 $e_m$ 以碱基对为单位， $w_m$ 是无量纲的。\n- 一个边界列表 $[(b_k, s_k)]$，其中 $b_k$ 以碱基对为单位， $s_k \\in [0,1]$ 是无量纲的渗透性。\n- 一个删除集 $D$，包含边界列表中在删除后状态下被删除的元素的索引（从零开始）。\n\n要实现的测试套件：\n- 通用参数：$\\alpha = 1.5$，$\\lambda = 20000$ 碱基对。\n\n- 测试用例 1（异位接触暴露的顺利路径）：\n  - $L = 200000$ 碱基对\n  - $p = 120000$ 碱基对\n  - 增强子: $[(80000, 1.0), (150000, 0.6)]$\n  - 边界: $[(100000, 0.1), (130000, 0.05)]$\n  - 删除: $[1]$\n\n- 测试用例 2（强边界移除暴露远端增强子）：\n  - $L = 200000$ 碱基对\n  - $p = 50000$ 碱基对\n  - 增强子: $[(10000, 0.5), (90000, 1.2)]$\n  - 边界: $[(70000, 0.02), (40000, 0.2)]$\n  - 删除: $[0]$\n\n- 测试用例 3（无边界；删除无效果）：\n  - $L = 100000$ 碱基对\n  - $p = 50000$ 碱基对\n  - 增强子: $[(20000, 1.0), (80000, 1.0)]$\n  - 边界: $[]$\n  - 删除: $[]$\n\n- 测试用例 4（通过删除解除完全绝缘；确保来自近端增强子的非零基线活性）：\n  - $L = 150000$ 碱基对\n  - $p = 60000$ 碱基对\n  - 增强子: $[(58000, 0.3), (110000, 1.0)]$\n  - 边界: $[(80000, 0.0)]$\n  - 删除: $[0]$\n\n程序输出格式：\n- 使用上述定义为每个测试用例计算倍数变化 $F$。\n- 生成单行输出，其中包含结果，格式为逗号分隔的浮点数列表，四舍五入到六位小数，并用方括号括起来，例如 $[f_1, f_2, f_3, f_4]$，其中每个 $f_i$ 对应于测试用例 $i$ 的倍数变化。", "solution": "该问题要求实现一个计算模型，以预测基因组边界元件删除后启动子活性的变化。该模型基于聚合物物理学的第一性原理，具体来说是一个环挤压框架，其中增强子根据其空间邻近性影响启动子的活性，而这种邻近性又受到距离和其间的边界元件的调控。目标是计算启动子活性的倍数变化，该变化定义为其在边界删除后的活性与其删除前活性的比率。\n\n该解决方案是通过系统地应用所提供的数学定义来构建的。让我们首先将模型的各个组成部分形式化。\n\n1. 基线接触权重：位于位置 $x_i$ 和 $x_j$、由基因组距离 $d = |x_i - x_j|$ 分隔的两个基因组位点之间的固有接触概率由函数 $W(d)$ 给出。该函数表示在染色质的聚合物模型中，接触频率随距离的衰减。其定义如下：\n$$\nW(d) = \\frac{1}{1 + \\left(\\frac{d}{\\lambda}\\right)^{\\alpha}}\n$$\n在这里， $\\lambda$ 是一个特征长度标度，设置为 $20000$ 碱基对，$\\alpha$ 是一个聚合物标度指数，设置为 $1.5$。这些常数决定了接触衰减曲线的形状。\n\n2. 边界衰减因子：边界元件（例如由 CTCF 蛋白结合的元件）被建模为阻碍环挤压过程的概率性屏障。位于位点对 $(x_i, x_j)$ 之间的边界的集体效应由衰减因子 $A$ 来量化。它是所有严格位于 $x_i$ 和 $x_j$ 之间的、位置为 $b_k$ 的边界 $k$ 的渗透性 $s_k \\in [0, 1]$ 的乘积。渗透性 $s_k=0$ 代表完全屏障，而 $s_k=1$ 代表完全可渗透的元件（无屏障效应）。\n$$\nA(x_i, x_j; \\{(b_k, s_k)\\}) = \\prod_{k: \\min(x_i, x_j) < b_k < \\max(x_i, x_j)} s_k\n$$\n如果 $x_i$ 和 $x_j$ 之间没有边界，则出现空积，定义为 $1$。边界的删除通过将其渗透性 $s_k$ 设置为 $1$ 来建模。\n\n3. 总启动子活性：位于位置 $p$ 的启动子的活性由一组增强子的累积影响决定。每个位于位置 $e_m$、具有内在强度 $w_m$ 的增强子 $m$ 对启动子的活性有贡献。此贡献是增强子强度 $w_m$、基线接触权重 $W(|e_m - p|)$ 以及特定增强子-启动子对的衰减因子 $A(e_m, p)$ 的乘积。总启动子活性 $S$ 是对所有增强子的这些贡献的总和：\n$$\nS = \\sum_{m} w_m \\, W(|e_m - p|) \\, A(e_m, p; \\{(b_k, s_k)\\})\n$$\n\n4. 倍数变化计算：要计算的主要量是倍数变化 $F$。这个无量纲比率量化了删除特定边界集 $D$ 的影响。设 $S_{\\mathrm{before}}$ 是使用原始边界渗透性集计算的启动子活性。设 $S_{\\mathrm{after}}$ 是在修改渗透性（即对于每个边界索引 $k \\in D$，将渗透性 $s_k$ 设置为 $1$）后计算的活性。则倍数变化 $F$ 为：\n$$\nF = \\frac{S_{\\mathrm{after}}}{S_{\\mathrm{before}}}\n$$\n$F > 1$ 的值表示删除导致启动子活性增加，这通常是由于形成了新的或“异位”的、先前被阻断的增强子-启动子接触。$F = 1$ 的值表示没有变化。\n\n每个测试用例的计算过程如下：\n首先，我们定义一个函数，使用常量 $\\alpha=1.5$ 和 $\\lambda=20000$ 来计算给定启动子、增强子列表和边界列表的总启动子活性 $S$。此函数遍历每个增强子，计算依赖于距离的权重 $W(d)$ 和边界衰减 $A$，计算该增强子的贡献，然后将这些贡献求和。\n\n其次，对于每个测试用例，我们通过调用此活性计算函数并使用最初提供的边界列表来计算 $S_{\\mathrm{before}}$。\n\n第三，我们为删除后状态构建一个新的边界列表。这是原始列表的副本，其中在指定删除集 $D$ 中的每个索引为 $k$ 的边界的渗透性 $s_k$ 都被替换为 1.0。\n\n第四，我们通过使用这个新的、修改过的边界列表调用活性计算函数来计算 $S_{\\mathrm{after}}$。\n\n最后，我们计算比率 $F = S_{\\mathrm{after}} / S_{\\mathrm{before}}$ 以获得所需的倍数变化。对所有指定的测试用例重复此过程。对于不存在边界的情况，$S_{\\mathrm{after}}$ 将等于 $S_{\\mathrm{before}}$，从而正确地得出 1.0 的倍数变化。$S_{\\mathrm{before}}$ 为零的情况由问题的设计来处理，该设计确保了至少有一个未被完全绝缘边界与启动子隔开的近端增强子提供非零的基线活性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of predicting enhancer-promoter communication changes\n    upon boundary deletion using a simplified loop-extrusion model.\n    \"\"\"\n\n    # Model constants\n    ALPHA = 1.5\n    LAMBDA = 20000.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (happy path with ectopic contact unmasking)\n        {\n            \"L\": 200000,\n            \"p\": 120000,\n            \"enhancers\": [(80000, 1.0), (150000, 0.6)],\n            \"boundaries\": [(100000, 0.1), (130000, 0.05)],\n            \"deleted\": [1],\n        },\n        # Test case 2 (strong boundary removal exposing a distal enhancer)\n        {\n            \"L\": 200000,\n            \"p\": 50000,\n            \"enhancers\": [(10000, 0.5), (90000, 1.2)],\n            \"boundaries\": [(70000, 0.02), (40000, 0.2)],\n            \"deleted\": [0],\n        },\n        # Test case 3 (no boundaries; deletion has no effect)\n        {\n            \"L\": 100000,\n            \"p\": 50000,\n            \"enhancers\": [(20000, 1.0), (80000, 1.0)],\n            \"boundaries\": [],\n            \"deleted\": [],\n        },\n        # Test case 4 (complete insulation lifted by deletion)\n        {\n            \"L\": 150000,\n            \"p\": 60000,\n            \"enhancers\": [(58000, 0.3), (110000, 1.0)],\n            \"boundaries\": [(80000, 0.0)],\n            \"deleted\": [0],\n        },\n    ]\n\n    def baseline_contact_weight(d, lam, alpha):\n        \"\"\"Calculates W(d), the baseline contact weight.\"\"\"\n        return 1.0 / (1.0 + (d / lam) ** alpha)\n\n    def compute_activity(p_pos, enhancers, boundaries, lam, alpha):\n        \"\"\"\n        Computes the total promoter activity S based on enhancer contacts,\n        modulated by distance and boundary elements.\n        \"\"\"\n        total_activity = 0.0\n        for e_pos, e_weight in enhancers:\n            # 1. Calculate genomic distance and baseline contact weight\n            d = abs(e_pos - p_pos)\n            w_d = baseline_contact_weight(d, lam, alpha)\n\n            # 2. Calculate boundary attenuation factor\n            attenuation = 1.0\n            locus_min = min(p_pos, e_pos)\n            locus_max = max(p_pos, e_pos)\n            for b_pos, b_perm in boundaries:\n                if locus_min < b_pos < locus_max:\n                    attenuation *= b_perm\n            \n            # 3. Sum up the contribution for this enhancer\n            total_activity += e_weight * w_d * attenuation\n            \n        return total_activity\n\n    results = []\n    for case in test_cases:\n        p_pos = case[\"p\"]\n        enhancers = case[\"enhancers\"]\n        boundaries_before = case[\"boundaries\"]\n        deleted_indices = case[\"deleted\"]\n\n        # Calculate pre-deletion promoter activity\n        s_before = compute_activity(p_pos, enhancers, boundaries_before, LAMBDA, ALPHA)\n\n        # Create the post-deletion boundary list by setting permeabilities to 1.0\n        boundaries_after = [list(b) for b in boundaries_before]\n        for idx in deleted_indices:\n            if 0 <= idx < len(boundaries_after):\n                boundaries_after[idx][1] = 1.0\n\n        # Calculate post-deletion promoter activity\n        s_after = compute_activity(p_pos, enhancers, boundaries_after, LAMBDA, ALPHA)\n\n        # Calculate fold-change, handling potential division by zero\n        if s_before == 0.0:\n            # If S_before is 0 and S_after is also 0, change is 1-fold.\n            # If S_before is 0 and S_after > 0, change is infinite.\n            # The problem context implies S_before will be non-zero.\n            fold_change = float('inf') if s_after > 0 else 1.0\n        else:\n            fold_change = s_after / s_before\n        \n        results.append(fold_change)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2947808"}]}