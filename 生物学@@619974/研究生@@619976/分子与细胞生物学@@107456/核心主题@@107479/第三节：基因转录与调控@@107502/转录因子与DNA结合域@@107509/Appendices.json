{"hands_on_practices": [{"introduction": "位置权重矩阵（PWMs）是表示DNA结合基序的基石，但它们的理论基础常常被忽视。本练习将抽象的PWM置于统计热力学的基本原理之中 [@problem_id:2966795]。通过推导结合能（$\\Delta E$）与对数几率分数（$S$）之间的线性关系，您将揭示为何PWM是蛋白质-DNA相互作用的简单加性物理模型的直接结果。", "problem": "一个转录因子通过一个加性结合能模型来识别DNA，在该模型中，一个长度为 $L$、序列为 $s = (s_{1},\\dots,s_{L})$ 的位点的结合能为 $E(s) = \\sum_{i=1}^{L} \\varepsilon_{i}(s_{i}) + E_{0}$，其中 $\\varepsilon_{i}(b)$ 是位置 $i$ 处碱基 $b$ 的贡献，而 $E_{0}$ 是一个与序列无关的偏移量。在绝对温度为 $T$ 的热力学平衡状态下，在结合系综中观察到序列 $s$ 的概率，相对于其背景出现概率 $q(s)$，与其能量的玻尔兹曼因子成正比，这与经过充分检验的大分子结合统计热力学模型一致：$P(\\text{bound}\\,|\\,s) \\propto \\exp(-\\beta E(s))$，其中 $\\beta = 1/(k_{B} T)$，$k_{B}$ 是玻尔兹曼常数。假设一个背景模型，其中碱基在不同位置上是独立的，边际概率为 $q(b)$，并且由于 $E(s)$ 的可加性，结合系综在各个位置上也是可分解的。\n\n将序列 $s$ 的位置权重矩阵（PWM）对数优势比分数（以 $b$ 为底）定义为\n$$\nS(s) \\equiv \\sum_{i=1}^{L} \\log_{b}\\!\\left(\\frac{p_{i}(s_{i})}{q(s_{i})}\\right),\n$$\n其中 $p_{i}(x)$ 是在结合系综中位置 $i$ 处碱基 $x$ 的边际频率，$q(x)$ 是背景碱基频率。仅使用上述统计热力学假设以及 $S(s)$ 和 $E(s)$ 的定义，推导结合能差 $\\Delta E(s) \\equiv E(s) - E_{\\star}$ 与 PWM 分数 $S(s)$ 之间的线性关系，并以 $k_{B}$、$T$ 和 PWM 对数的底 $b$ 表示系数 $\\alpha$，其形式为 $\\Delta E(s) = -\\alpha\\, S(s) + \\text{const}$。\n\n然后，简要概述一个基于原理的实验或计算策略，用于从包含不同序列的平衡占有率 $P(\\text{bound}\\,|\\,s)$ 或独立测量的不同序列的结合自由能 $\\Delta E(s)$ 的数据中拟合 $\\alpha$。\n\n以 $k_{B}$、$T$ 和 $b$ 的形式，提供 $\\alpha$ 的单一闭式解析表达式。用焦耳（Joules）表示 $\\alpha$ 的单位，但不要代入数值。", "solution": "该问题要求推导转录因子与DNA序列的结合能和该序列相应的位置权重矩阵（PWM）分数之间的线性关系。我们首先验证问题陈述的有效性。\n\n给定条件如下：\n1.  一个加性结合能模型：$E(s) = \\sum_{i=1}^{L} \\varepsilon_{i}(s_{i}) + E_{0}$，对于序列 $s = (s_{1},\\dots,s_{L})$。\n2.  在结合系综中观察到序列 $s$ 的概率，相对于其背景出现概率 $q(s)$，与其玻尔兹曼因子成正比：$P(\\text{bound}\\,|\\,s) \\propto \\exp(-\\beta E(s))$，其中 $\\beta = 1/(k_{B} T)$。\n3.  序列的背景概率分布是可分解的：$q(s) = \\prod_{i=1}^{L} q(s_{i})$，其中 $q(s_i)$ 是碱基 $s_i$ 的边际频率。问题文本中的“边际概率 $q(b)$”意味着 $q(s_i)$ 与位置 $i$ 无关，我们将其写作 $q(s_i)=q(b)$（当 $s_i=b$ 时）。为了确保正确性，我们将保留更通用的表示法 $q(s_i)$，因为它不影响推导过程。\n4.  结合系综中序列的概率分布也是可分解的：$p(s) = \\prod_{i=1}^{L} p_{i}(s_{i})$。\n5.  PWM 对数优势比分数的定义为 $S(s) \\equiv \\sum_{i=1}^{L} \\log_{b}\\!\\left(\\frac{p_{i}(s_{i})}{q(s_{i})}\\right)$。\n6.  目标是求出推导出的关系式 $\\Delta E(s) = -\\alpha\\, S(s) + \\text{const}$ 中的系数 $\\alpha$，其中 $\\Delta E(s) \\equiv E(s) - E_{\\star}$。\n\n该问题在科学上基于应用于分子结合的统计力学原理，这是生物物理学中一种标准且经过充分验证的方法。问题陈述清晰，为唯一解提供了充分且一致的信息。语言客观而精确。因此，该问题被认为是有效的。\n\n我们开始推导。根据统计热力学原理，在结合系综中找到序列 $s$ 的概率 $p(s)$ 与其背景概率 $q(s)$ 和其结合能 $E(s)$ 相关。一个序列在结合群体中相对于背景的富集程度由其玻尔兹曼权重给出。这可以正式表述为：\n$$\n\\frac{p(s)}{q(s)} = \\frac{\\exp(-\\beta E(s))}{Z}\n$$\n其中 $Z = \\sum_{s'} \\exp(-\\beta E(s')) q(s')$ 是对所有可能序列的配分函数，它作为一个归一化常数。对于一个处于平衡状态的给定系统，$Z$ 是一个常数。\n\n现在，我们根据问题陈述中提供的可加性和可分解性假设，代入 $p(s)$、$q(s)$ 和 $E(s)$ 的表达式。\n$$\n\\frac{\\prod_{i=1}^{L} p_{i}(s_{i})}{\\prod_{i=1}^{L} q(s_{i})} = \\frac{1}{Z} \\exp\\left(-\\beta \\left(\\sum_{j=1}^{L} \\varepsilon_{j}(s_{j}) + E_{0}\\right)\\right)\n$$\n这可以通过分离乘积和求和来重写：\n$$\n\\prod_{i=1}^{L} \\left(\\frac{p_{i}(s_{i})}{q(s_{i})}\\right) = \\frac{\\exp(-\\beta E_{0})}{Z} \\prod_{i=1}^{L} \\exp(-\\beta \\varepsilon_{i}(s_{i}))\n$$\n这个方程必须对任何序列 $s$ 都成立。该方程的结构，即两边都是对位置 $i=1, \\dots, L$ 的乘积，意味着该关系必须在每个位置上都成立。也就是说，对于每个位置 $i$ 和任何碱基 $b \\in \\{A, C, G, T\\}$，必须存在特定于位置的常数 $C_i$，使得：\n$$\n\\frac{p_{i}(b)}{q(b)} = C_{i} \\exp(-\\beta \\varepsilon_{i}(b))\n$$\n这些常数的乘积必须满足 $\\prod_{i=1}^{L} C_{i} = \\exp(-\\beta E_0)/Z$。对每个位置的关系式取自然对数，得到：\n$$\n\\ln\\left(\\frac{p_{i}(b)}{q(b)}\\right) = \\ln(C_{i}) - \\beta \\varepsilon_{i}(b)\n$$\n现在，我们将其与 PWM 分数 $S(s)$ 联系起来。定义是以一个通用的以 $b$ 为底的对数给出的。我们使用换底公式 $\\log_{b}(x) = \\frac{\\ln(x)}{\\ln(b)}$，用自然对数来表示 $S(s)$：\n$$\nS(s) = \\sum_{i=1}^{L} \\frac{\\ln\\left(\\frac{p_{i}(s_{i})}{q(s_{i})}\\right)}{\\ln(b)} = \\frac{1}{\\ln(b)} \\sum_{i=1}^{L} \\ln\\left(\\frac{p_{i}(s_{i})}{q(s_{i})}\\right)\n$$\n代入我们推导出的对数比表达式：\n$$\nS(s) = \\frac{1}{\\ln(b)} \\sum_{i=1}^{L} (\\ln(C_{i}) - \\beta \\varepsilon_{i}(s_{i}))\n$$\n$$\nS(s) = \\frac{1}{\\ln(b)} \\left( \\left(\\sum_{i=1}^{L} \\ln(C_{i})\\right) - \\beta \\sum_{i=1}^{L} \\varepsilon_{i}(s_{i}) \\right)\n$$\n总结合能为 $E(s) = \\sum_{i=1}^{L} \\varepsilon_{i}(s_{i}) + E_{0}$，这意味着 $\\sum_{i=1}^{L} \\varepsilon_{i}(s_{i}) = E(s) - E_{0}$。将此代入 $S(s)$ 的方程中：\n$$\nS(s) = \\frac{1}{\\ln(b)} \\left( \\left(\\sum_{i=1}^{L} \\ln(C_{i})\\right) - \\beta (E(s) - E_{0}) \\right)\n$$\n$$\nS(s) = -\\frac{\\beta}{\\ln(b)} E(s) + \\frac{1}{\\ln(b)} \\left( \\beta E_{0} + \\sum_{i=1}^{L} \\ln(C_{i}) \\right)\n$$\n这是一个联系 $S(s)$ 和 $E(s)$ 的线性方程。题目要求我们找到 $\\Delta E(s)$ 的关系式，其形式为 $\\Delta E(s) = -\\alpha S(s) + \\text{const}$。首先，我们求解 $E(s)$：\n$$\n\\frac{\\beta}{\\ln(b)} E(s) = -S(s) + \\frac{1}{\\ln(b)} \\left( \\beta E_{0} + \\sum_{i=1}^{L} \\ln(C_{i}) \\right)\n$$\n$$\nE(s) = -\\frac{\\ln(b)}{\\beta} S(s) + \\frac{1}{\\beta} \\left( \\beta E_{0} + \\sum_{i=1}^{L} \\ln(C_{i}) \\right)\n$$\n代入 $\\beta = 1/(k_{B}T)$：\n$$\nE(s) = - (k_{B} T \\ln(b)) S(s) + \\left( E_{0} + k_{B} T \\sum_{i=1}^{L} \\ln(C_{i}) \\right)\n$$\n最后一个括号中的项是一个不依赖于序列 $s$ 的常数。我们称之为 $K$。\n$$\nE(s) = - (k_{B} T \\ln(b)) S(s) + K\n$$\n结合能差定义为 $\\Delta E(s) = E(s) - E_{\\star}$，其中 $E_{\\star}$ 是一个恒定的参考能量。\n$$\n\\Delta E(s) = \\left(- (k_{B} T \\ln(b)) S(s) + K\\right) - E_{\\star}\n$$\n$$\n\\Delta E(s) = - (k_{B} T \\ln(b)) S(s) + (K - E_{\\star})\n$$\n这是 $\\Delta E(s) = -\\alpha S(s) + \\text{const}$ 的形式，其中常数为 $(K - E_{\\star})$。系数 $\\alpha$ 是：\n$$\n\\alpha = k_{B} T \\ln(b)\n$$\n该系数的单位是焦耳（Joules），因为 $k_{B}$ 的单位是焦耳/开尔文（Joules/Kelvin），$T$ 的单位是开尔文（Kelvin），而 $\\ln(b)$ 是无量纲的。\n\n对于问题的第二部分，需要一个从数据中拟合 $\\alpha$ 的策略。推导出的关系式 $\\Delta E(s) = -\\alpha S(s) + \\text{const}$ 是一个线性方程。因此，$\\alpha$ 可以通过 $\\Delta E(s)$ 对 $S(s)$ 的图的斜率的负值来确定。一个基于原理的策略如下：\n1.  **数据采集**：执行一种基于高通量测序的结合分析，例如 SELEX-seq 或 ChIP-seq。该实验为大量 DNA 序列 $\\{s_j\\}$ 产生两个基本数据集：(a) 被转录因子特异性结合的 DNA 片段的序列，以及 (b) 每条序列结合亲和力的定量测量（例如，富集比，其可转换为相对结合能 $\\Delta E(s_j)$）。\n2.  **参数估计**：\n    a.  从结合序列集合中，通过对序列进行比对并计算每个位置 $i$ 上每个碱基的频率，构建位置频率矩阵 $p_{i}(b)$。背景频率 $q(b)$ 从初始序列库或相关的基因组背景中估计。\n    b.  对于每个有结合测量值的序列 $s_j$，使用估计出的矩阵计算其 PWM 分数：$S(s_j) = \\sum_{i=1}^{L} \\log_{b}(p_{i}(s_{j,i})/q(s_{j,i}))$。\n    c.  对于每个序列 $s_j$，将其测量的定量结合亲和力转换为相对结合自由能，作为 $\\Delta E(s_j)$。例如，如果使用平衡占有率，可以从通过 Langmuir 等温线计算出的解离常数推导出相对能量。\n3.  **线性回归**：将计算出的 $\\Delta E(s_j)$ 值与其对应的 $S(s_j)$ 分数作图。对这些数据点进行线性回归。最佳拟合线的斜率将是 $-\\alpha$ 的实验估计值。因此，$\\alpha$ 的值通过取拟合斜率的负值来确定。\n\n该过程提供了 $\\alpha$ 的一个经验值，可以将其与理论值 $k_B T \\ln(b)$ 进行比较，以验证其所基于的热力学模型。", "answer": "$$\n\\boxed{k_{B} T \\ln(b)}\n$$", "id": "2966795"}, {"introduction": "在对PWM有了坚实的理论理解后，我们现在可以将其应用于合成生物学中的一个实际挑战。本练习将引导您体验一个真实的工作流程：设计一个定制的锌指蛋白以识别特定的DNA序列，然后使用其PWM来评估一个关键的设计参数——在人类大小的基因组中预期的脱靶结合位点数量 [@problem_id:2966823]。这整合了蛋白质设计、序列分析和统计学的概念，以展示生物物理模型的预测能力。", "problem": "您正在设计一个三指Cys2His2 (C2H2)锌指转录因子，以使其结合一个特定的双链脱氧核糖核酸(DNA)靶标，并希望使用位置权重矩阵(PWM)扫描来估计在一个大型基因组中高于阈值的脱靶匹配的期望数量。\n\n靶标与设计假设：\n- 靶位点是正向链上的9个碱基对(bp)序列$5'$-GCGTATGGC-$3'$，将由三个串联的C2H2锌指识别，每个锌指沿$5' \\rightarrow 3'$方向接触一个3bp的子位点：锌指1对应$5'$-GCG-$3'$，锌指2对应$5'$-TAT-$3'$，锌指3对应$5'$-GGC-$3'$。\n- 使用针对C2H2锌指的简化经典三接触识别码：对于每个3bp子位点$5'$-$B_{1}B_{2}B_{3}$-$3'$，其α-螺旋上位置$6$、$3$和$-1$的残基分别主要接触$B_{1}$、$B_{2}$和$B_{3}$。选择残基以偏好碱基，规则如下：A $\\rightarrow$ Asn (N)，C $\\rightarrow$ Asp (D)，G $\\rightarrow$ Arg (R)，T $\\rightarrow$ Ser (S)。忽略上下文效应和指间耦合。\n- 通过为每个位置$i \\in \\{1,\\dots,9\\}$分配概率，将此设计转化为一个PWM：该位置上设计好的碱基$b^{*}$的共有碱基概率为$p_{i}(b^{*})=0.7$，而每个非共有碱基$b \\neq b^{*}$的概率为$p_{i}(b)=0.1$。假设位置之间相互独立。\n\n扫描与评分假设：\n- 背景碱基频率是均匀的：$q(\\mathrm{A})=q(\\mathrm{C})=q(\\mathrm{G})=q(\\mathrm{T})=\\frac{1}{4}$。\n- 一个9-mer $x_{1:9}$的PWM对数奇比分$S(x_{1:9})=\\sum_{i=1}^{9} \\log_{2}\\!\\left(\\frac{p_{i}(x_{i})}{q(x_{i})}\\right)$（单位为比特）。\n- 如果$S(x_{1:9}) \\geq T$，则该位点被称为一次命中(hit)，其中阈值$T=8.0$比特。\n- 您使用长度为$L=9$、步长为$1$的滑动窗口扫描长度为$G=3.0 \\times 10^{9}$ bp的基因组的两条链，因此评估的总窗口数为$N_{\\text{win}}=2\\,(G-L+1)$。\n\n任务：\n1. 对于每个锌指，指明根据上述识别码为偏好靶标$5'$-GCGTATGGC-$3'$而选择的位置$6$、$3$和$-1$上的关键螺旋残基。\n2. 仅使用上述PWM和评分假设，从第一性原理推导扫描基因组时高于阈值的命中的期望数量，并将该期望表示为$N_{\\text{win}}$和从背景中随机抽取的9-mer满足$S \\geq T$的概率的函数。\n3. 将最终期望数量计算为一个实数，并四舍五入到三位有效数字。以无量纲计数（无单位）的形式提供您的最终答案，不要包含百分号或任何角度单位。", "solution": "我们从序列特异性DNA识别和基序统计扫描的核心定义开始。\n\n使用简化识别码的设计步骤：\n- 靶标为$5'$-G C G T A T G G C-$3'$。\n- 对于每个3bp子位点$5'$-$B_{1}B_{2}B_{3}$-$3'$，根据映射规则 A $\\rightarrow$ Asn (N), C $\\rightarrow$ Asp (D), G $\\rightarrow$ Arg (R), T $\\rightarrow$ Ser (S)，选择螺旋位置$6$、$3$和$-1$上的残基以分别偏好$B_{1}$、$B_{2}$和$B_{3}$。\n\n应用于每个锌指：\n- 锌指1对应$5'$-G C G-$3'$：位置 $6 \\rightarrow$ R (对应 G)，位置 $3 \\rightarrow$ D (对应 C)，位置 $-1 \\rightarrow$ R (对应 G)。\n- 锌指2对应$5'$-T A T-$3'$：位置 $6 \\rightarrow$ S (对应 T)，位置 $3 \\rightarrow$ N (对应 A)，位置 $-1 \\rightarrow$ S (对应 T)。\n- 锌指3对应$5'$-G G C-$3'$：位置 $6 \\rightarrow$ R (对应 G)，位置 $3 \\rightarrow$ R (对应 G)，位置 $-1 \\rightarrow$ D (对应 C)。\n\n因此，设计的螺旋接触残基为：\n- 锌指1: $(6,3,-1) = (\\mathrm{R}, \\mathrm{D}, \\mathrm{R})$。\n- 锌指2: $(6,3,-1) = (\\mathrm{S}, \\mathrm{N}, \\mathrm{S})$。\n- 锌指3: $(6,3,-1) = (\\mathrm{R}, \\mathrm{R}, \\mathrm{D})$。\n\nPWM与评分：\n根据构造，对于每个位置$i \\in \\{1,\\dots,9\\}$，\n- 共有碱基的概率为$p_{i}(b^{*})=0.7$，\n- 非共有碱基的概率为$p_{i}(b)=0.1$（其中$b \\neq b^{*}$），\n并且背景概率对于所有碱基$b$均为$q(b)=\\frac{1}{4}$。\n\n因此，每个位置的对数奇比贡献（单位为比特）是常数：\n- 对于一个共有碱基：$s_{c}=\\log_{2}\\!\\left(\\frac{0.7}{0.25}\\right)=\\log_{2}(2.8)$,\n- 对于一个非共有碱基：$s_{m}=\\log_{2}\\!\\left(\\frac{0.1}{0.25}\\right)=\\log_{2}(0.4)$。\n\n设$m$为一个9-mer中相对于设计的共有序列的错配（非共有碱基）数量。因为在我们的PWM构造下，各个位置是独立同分布的，所以总分作为$m$的函数是\n$$\nS(m)=(9-m)\\,s_{c}+m\\,s_{m}\n=9\\,\\log_{2}(2.8)+m\\left[\\log_{2}(0.4)-\\log_{2}(2.8)\\right]。\n$$\n定义$\\Delta = s_{c}-s_{m}=\\log_{2}(2.8)-\\log_{2}(0.4)=\\log_{2}\\!\\left(\\frac{2.8}{0.4}\\right)=\\log_{2}(7)$，因此$s_{m}-s_{c}=-\\Delta=-\\log_{2}(7)$。数值上，\n$$\ns_{c}=\\log_{2}(2.8)\\approx 1.485426827,\\quad\ns_{m}=\\log_{2}(0.4)\\approx -1.321928095,\\quad\n\\Delta=\\log_{2}(7)\\approx 2.807354922.\n$$\n因此，\n$$\nS(m)=9\\,s_{c}-m\\,\\Delta \\approx 13.36884144 - 2.807354922\\,m.\n$$\n\n阈值处理：\n我们要求$S(m)\\geq T$，其中$T=8.0$比特。求解满足以下条件的最大整数$m$：\n$$\n13.36884144 - 2.807354922\\,m \\geq 8.0\n\\;\\;\\Longleftrightarrow\\;\\;\nm \\leq \\frac{13.36884144-8.0}{2.807354922}\\approx 1.912\\ldots\n$$\n因此，允许的整数为$m=0$或$m=1$。因此，任何相对于共有序列最多有一次错配的9-mer，其得分都将达到或超过阈值；而任何具有$m\\geq 2$次错配的序列，其得分都将低于阈值。\n\n随机9-mer得分高于阈值的概率：\n在均匀背景和独立性假设下，每个9-mer出现的可能性是相等的，概率为$4^{-9}$。与共有序列的汉明距离为$m$的9-mer数量是$\\binom{9}{m}\\,3^{m}$（选择$m$个位置发生错配，并且对于每个这样的位置，选择3个非共有碱基中的一个）。因此，\n$\\Pr\\{S \\geq T\\}$\n$=\\frac{1}{4^{9}}\\sum_{m=0}^{1}\\binom{9}{m}3^{m}$\n$=\\frac{1}{4^{9}}\\left[\\binom{9}{0}3^{0}+\\binom{9}{1}3^{1}\\right]$\n$=\\frac{1+27}{4^{9}}$\n$=\\frac{28}{4^{9}}。$\n由于$4^{9}=262{,}144=2^{18}$，我们可以将$\\frac{28}{262{,}144}$化简为$\\frac{7}{65{,}536}$。\n\n高于阈值的命中的期望数量：\n扫描的总窗口数为$N_{\\text{win}}=2\\,(G-L+1)=2\\,(3.0\\times 10^{9}-9+1)=2\\,(3.0\\times 10^{9}-8)$。期望计数为\n$\\mathbb{E}[\\text{hits}]=N_{\\text{win}} \\times \\Pr\\{S \\geq T\\}$\n$=2\\,(3.0\\times 10^{9}-8)\\times \\frac{7}{65{,}536}。$\n为了进行数值计算，\n$$\n2\\,(3.0\\times 10^{9}-8)=6.0\\times 10^{9}-16,\n$$\n所以\n$\\mathbb{E}[\\text{hits}]=\\frac{7\\,(6.0\\times 10^{9}-16)}{65{,}536}$\n$=\\frac{42\\times 10^{9}-112}{65{,}536}。$\n计算其值：\n$$\n\\frac{42\\times 10^{9}}{65{,}536}\\approx 640{,}869.140625,\\quad\n\\frac{112}{65{,}536}\\approx 0.001708984375,\n$$\n因此\n$\\mathbb{E}[\\text{hits}]\\approx 640{,}869.140625-0.001708984375$\n$=640{,}869.138916015625。$\n\n四舍五入到三位有效数字，得到$6.41\\times 10^{5}$。\n\n总结：\n- 每个锌指设计的螺旋残基：锌指1 $(6,3,-1)=(\\mathrm{R},\\mathrm{D},\\mathrm{R})$，锌指2 $(\\mathrm{S},\\mathrm{N},\\mathrm{S})$，锌指3 $(\\mathrm{R},\\mathrm{R},\\mathrm{D})$。\n- 在长度为$3.0\\times 10^{9}$ bp的基因组中，使用$T=8.0$比特的阈值扫描两条链时，高于阈值的命中的期望数量：约为$6.41\\times 10^{5}$（无量纲计数），符合要求。", "answer": "$$\\boxed{6.41 \\times 10^{5}}$$", "id": "2966823"}, {"introduction": "作为PWM基础的加性能力模型是一个强大的简化，但自然界的复杂性往往超出其范畴。最后一个练习鼓励您通过探索导致核苷酸位置之间产生依赖性的生物物理机制，来批判性地思考该标准模型的局限性 [@problem_id:2966829]。通过将诸如间接识别和协同二聚化等物理场景与适当的高阶数学模型相匹配，您将培养一项关键技能：为正确的生物学问题选择正确的工具。", "problem": "一个转录因子（TF）以序列特异性的亲和力与双链DNA结合。在热力学占有模型下，结合一个序列 $s$ 的概率与玻尔兹曼因子成正比，$P(s) \\propto \\exp\\left(-\\beta E(s)\\right)$，其中 $\\beta = 1/(k_B T)$，$E(s)$ 是结合自由能。一个位置权重矩阵（PWM）模型，更准确地说是位置特异性加性（或可加）能量模型，假设对于一个长度为 $L$ 的基序，$E(s) = \\sum_{i=1}^{L} \\epsilon_i(s_i)$，这意味着 $P(s)$ 可以按位置分解，$P(s) \\propto \\prod_{i=1}^{L} p_i(s_i)$。对这种分解性的偏离表明存在位置依赖性（上位性），并使加性假设无效。\n\n从这些原则出发，推断DNA识别的结构和生物物理机制如何在 $E(s)$ 中产生相互作用项，从而破坏PWM的加性，然后确定一个能够捕捉这种依赖性的合适模型类别。考虑高阶模型可以表示为：\n- 相邻二核苷酸能量模型：$E(s) = \\sum_{i} \\epsilon_i(s_i) + \\sum_{i} J_{i,i+1}(s_i, s_{i+1})$，\n- 稀疏成对马尔可夫随机场（Potts模型）：$E(s) = \\sum_{i} \\epsilon_i(s_i) + \\sum_{i<j} J_{ij}(s_i, s_j)$，允许长程耦合，\n- 基序序列上的k阶非齐次马尔可夫链（等同于包含沿基序的所有k-mer相互作用），\n- 由离散间隔区长度索引的间区PWM混合模型，可能带有一个依赖于间隔区长度的半位点间耦合参数。\n\n选择所有描述了PWM加性因位置依赖性而失效的情景，并将其与一个非常适合捕捉这种依赖性的高阶模型类别正确配对的选项。\n\nA. 一个TF通过识别由相邻碱基对的碱基堆积决定的DNA小沟宽度和卷曲（roll）来进行间接读取，因此相邻的核苷酸通过局部形状调节彼此对 $E(s)$ 的贡献。使用一个带有 $J_{i,i+1}(s_i, s_{i+1})$ 的相邻二核苷酸能量模型（或等效地，基序上的1阶非齐次马尔可夫链）来捕捉这些最近邻依赖性。\n\nB. 一个同源二聚体TF识别由可变长度 $k \\in \\{3,4,5\\}$ 的间隔区分隔的两个半位点，由于蛋白质-蛋白质的几何构型，存在依赖于 $k$ 的协同稳定作用；当 $k$ 为最佳值时，半位点之间的能量耦合很强，否则很弱。使用一个由 $k$ 索引的间区PWM混合模型，并增加一个依赖于 $k$ 的半位点间耦合项，或者一个等效的稀疏成对马尔可夫随机场，在以间隔区长度为条件下耦合这两个半位点。\n\nC. 一个单体螺旋-转角-螺旋TF与4个独立的碱基位置各形成一个氢键，没有空间位阻或桥接水分子网络，并且晶体学研究显示没有跨越多个碱基的蛋白质接触。通过用一个跨越4个碱基的2阶非齐次马尔可夫链替换PWM来改进模型，以捕捉推定的三核苷酸依赖性。\n\nD. 在配体指数富集的系统进化（SELEX）实验的第5轮之后，全局鸟嘌呤-胞嘧啶（GC）含量已向上漂移，增加了所有基序位置上G和C的频率，但在以每个位置的GC率为条件后，任何碱基对的联合频率等于其边际频率的乘积。通过用相邻二核苷酸模型替换PWM，将GC偏好作为成对相互作用来吸收，从而修正此问题。\n\n选择所有适用项。", "solution": "在尝试任何解答之前，应对问题陈述进行验证。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n- 转录因子（TF）结合DNA序列 $s$ 的概率由一个热力学模型给出：$P(s) \\propto \\exp\\left(-\\beta E(s)\\right)$，其中 $\\beta = 1/(k_B T)$，$E(s)$ 是结合自由能。\n- 位置权重矩阵（PWM）模型由一个在长度为 $L$ 的基序上的加性能量函数定义：$E(s) = \\sum_{i=1}^{L} \\epsilon_i(s_i)$。\n- PWM模型的一个推论是概率的分解：$P(s) \\propto \\prod_{i=1}^{L} p_i(s_i)$。\n- 对这种加性/分解性的偏离被称为位置依赖性或上位性。\n- 引入了高阶模型来捕捉这种依赖性：\n    1. 相邻二核苷酸模型：$E(s) = \\sum_{i} \\epsilon_i(s_i) + \\sum_{i} J_{i,i+1}(s_i, s_{i+1})$。\n    2. 稀疏成对马尔可夫随机场（Potts模型）：$E(s) = \\sum_{i} \\epsilon_i(s_i) + \\sum_{i<j} J_{ij}(s_i, s_j)$。\n    3. k阶非齐次马尔可夫链。\n    4. 间区PWM混合模型。\n- 任务是识别位置依赖性的情景，并将其与一个合适的高阶模型类别进行匹配。\n\n**步骤 2：使用提取的已知条件进行验证**\n问题陈述具有科学依据。所提出的模型——热力学结合模型、作为加性能量模型的PWM，以及各种高阶扩展——都是计算生物学和生物物理学中描述TF-DNA相互作用的标准和基础概念。上位性或位置依赖性作为对简单加性模型的偏离这一概念是当前研究的核心课题。选项中提出的物理机制（间接读取、二聚体协同性）是导致此类依赖性的有充分文献记载的现象。该问题提法恰当，要求在物理原因和数学描述之间建立正确的映射。语言精确、客观。未发现科学、逻辑或结构上的缺陷。\n\n**步骤 3：结论与行动**\n问题陈述是有效的。将推导出一个完整的解答。\n\n**解答推导**\n\n基本原则是，具有加性能量函数 $E(s) = \\sum_{i=1}^{L} \\epsilon_i(s_i)$ 的PWM模型仅在每个碱基对总结合能的贡献独立于结合位点中所有其他碱基时才有效。任何导致碱基 $s_i$ 的能量贡献依赖于另一碱基 $s_j$ 特性的物理机制，都会在能量函数中引入一个非加性的交叉项 $J_{ij}(s_i, s_j)$，从而使PWM无效。我们必须根据这一原则评估每个选项。\n\n**A. 一个TF通过识别由相邻碱基对的碱基堆积决定的DNA小沟宽度和卷曲（roll）来进行间接读取，因此相邻的核苷酸通过局部形状调节彼此对 $E(s)$ 的贡献。使用一个带有 $J_{i,i+1}(s_i, s_{i+1})$ 的相邻二核苷酸能量模型（或等效地，基序上的1阶非齐次马尔可夫链）来捕捉这些最近邻依赖性。**\n\n该选项描述了一种非加性的经典机制。TF的结合亲和力不仅可以由与碱基的直接氢键（直接读取）决定，还可以由DNA双螺旋的序列依赖的形状和柔性（间接读取）决定。像小沟宽度、卷曲（roll）和扭曲（twist）这样的物理性质不是单个碱基对的属性，而是碱基对台阶的属性，即一个二核苷酸 $(s_i, s_{i+1})$。因此，与识别特定位点形状相关的能量贡献是至少两个相邻碱基对的函数。这在最近邻位置之间引入了物理依赖性。能量函数必须包含依赖于二核苷酸的项，而不仅仅是单核苷酸。\n\n所提出的模型是相邻二核苷酸模型：$E(s) = \\sum_{i} \\epsilon_i(s_i) + \\sum_{i} J_{i,i+1}(s_i, s_{i+1})$。$J_{i,i+1}(s_i, s_{i+1})$ 项明确地捕捉了二核苷酸台阶 $(s_i, s_{i+1})$ 的能量贡献，这正是所描述的依赖形式。一个1阶非齐次马尔可夫链，其中碱基 $s_i$ 的概率依赖于前一个碱基 $s_{i-1}$，$P(s_i|s_{i-1})$，其对数概率（也就是能量）具有 $\\sum_i \\epsilon(s_i, s_{i-1})$ 的形式，这在数学上等同于相邻二核苷酸能量模型。物理情景与模型的配对是正确的。\n\n结论：**正确**。\n\n**B. 一个同源二聚体TF识别由可变长度 $k \\in \\{3,4,5\\}$ 的间隔区分隔的两个半位点，由于蛋白质-蛋白质的几何构型，存在依赖于 $k$ 的协同稳定作用；当 $k$ 为最佳值时，半位点之间的能量耦合很强，否则很弱。使用一个由 $k$ 索引的间区PWM混合模型，并增加一个依赖于 $k$ 的半位点间耦合项，或者一个等效的稀疏成对马尔可夫随机场，在以间隔区长度为条件下耦合这两个半位点。**\n\n该情景描述了协同结合，这是长程位置依赖性的一个来源。该TF是一个二聚体，每个单体结合到一个“半位点”。总结合能不是两个半位点能量的总和，因为两个蛋白质单体之间的相互作用提供了额外的稳定性。这种蛋白质-蛋白质相互作用对两个单体的相对距离和方向高度敏感，而这又由半位点之间的DNA间隔区的长度 $k$ 决定。这在序列上相距甚远的两个半位点之间建立了能量耦合。一个覆盖整个结合位点的简单PWM是无效的，因为它无法捕捉这种长程耦合。\n\n所提出的模型是间区PWM的混合模型。这是合适的，因为系统对于每个间隔区长度 $k$ 的行为都不同。对于给定的 $k$，模型需要考虑协同性。“增加一个依赖于 $k$ 的半位点间耦合项”这句话描述了一个类似 $E(s|k) = E_{\\text{PWM1}}(s_{\\text{half1}}) + E_{\\text{PWM2}}(s_{\\text{half2}}) + J_k$ 的能量函数，其中 $J_k$ 是间隔区长度为 $k$ 时的耦合能。这正确地模拟了物理过程。一个等效的稀疏成对马尔可夫场将具有能量 $E(s) = \\sum_i \\epsilon_i(s_i) + \\sum_{i \\in \\text{half1}, j \\in \\text{half2}} J_{ij}(s_i, s_j)$，其中耦合项 $J_{ij}$ 仅对跨越两个半位点的碱基对非零。这也是表示此类长程、结构化依赖性的一种有效且强大的方式，特别是当以间隔区长度为条件时。物理情景与模型的配对是正确的。\n\n结论：**正确**。\n\n**C. 一个单体螺旋-转角-螺旋TF与4个独立的碱基位置各形成一个氢键，没有空间位阻或桥接水分子网络，并且晶体学研究显示没有跨越多个碱基的蛋白质接触。通过用一个跨越4个碱基的2阶非齐次马尔可夫链替换PWM来改进模型，以捕捉推定的三核苷酸依赖性。**\n\n该选项描述了一个典型的PWM有效性案例。问题明确指出，TF与4个*独立*的碱基位置相互作用，*没有*空间位阻或桥接水分子网络（这些可能介导依赖性），并且结构数据显示*没有*跨越多个碱基的接触。所有这些事实都表明位置之间缺乏物理耦合。每个位置的能量贡献与其他位置无关。因此，总结合能可以由一个加性函数正确描述：$E(s) = \\sum_{i=1}^{4} \\epsilon_i(s_i)$。这就是PWM模型的定义。\n\n建议使用一个2阶非齐次马尔可夫链来“改进”这个模型的说法是毫无根据的，并且违反了简约原则（奥卡姆剃刀）。一个2阶模型引入了复杂的三核苷酸依赖性（$J_{i,i+1,i+2}(s_i, s_{i+1}, s_{i+2})$），根据问题描述，这没有任何物理依据。为不存在的效应添加参数并不能改进模型；它会导致过拟合，并且在科学上是不合理的。PWM是此情景的正确模型。\n\n结论：**不正确**。\n\n**D. 在配体指数富集的系统进化（SELEX）实验的第5轮之后，全局鸟嘌呤-胞嘧啶（GC）含量已向上漂移，增加了所有基序位置上G和C的频率，但在以每个位置的GC率为条件后，任何碱基对的联合频率等于其边际频率的乘积。通过用相邻二核苷酸模型替换PWM，将GC偏好作为成对相互作用来吸收，从而修正此问题。**\n\n该情景描述了在一次体外选择实验中背景核苷酸组成的变化。这是一个常见的假象。关键信息是“在以每个位置的GC率为条件后，任何碱基对的联合频率等于其边际频率的乘积。”用概率术语来说，这意味着 $P(s_i, s_j | \\text{context}) = P(s_i| \\text{context})P(s_j| \\text{context})$。这是条件独立性的定义。这意味着一旦考虑了位置特异性的碱基偏好（$\\epsilon_i(s_i)$项），位置之间就不存在残余的依赖性。全局GC偏好影响了每个位置的表观频率，但它没有在TF-DNA能量函数 $E(s)$ 中引入任何内在耦合。结合机制本身可能仍然是完全加性的。PWM的加性，$E(s) = \\sum_i \\epsilon_i(s_i)$，仍然成立。从有偏数据中估计出的参数 $\\epsilon_i(s_i)$ 会反映GC漂移，但模型的*形式*并未失效。\n\n提议用相邻二核苷酸模型替换PWM是不正确的。这将引入成对参数 $J_{i,i+1}$ 来解释一个本质上不是成对的效应。问题在于全局的组成偏好，而不是最近邻相互作用。正确的方法是继续使用PWM，但要对富集序列池的背景核苷酸频率进行适当的归一化。该情景并未描述PWM加性的失效。\n\n结论：**不正确**。\n\n根据此分析，只有选项A和B正确地将位置依赖性的生物物理机制与一个合适的高阶模型配对。", "answer": "$$\\boxed{AB}$$", "id": "2966829"}]}