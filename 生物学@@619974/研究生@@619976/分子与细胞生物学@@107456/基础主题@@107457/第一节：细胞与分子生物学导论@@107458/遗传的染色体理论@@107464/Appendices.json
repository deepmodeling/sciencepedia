{"hands_on_practices": [{"introduction": "将连锁的基因在其染色体上线性排列是遗传学的一项基本技能。这个练习的核心原则是，两个基因之间的重组频率与其物理距离大致成正比。通过系统地分析多对基因间的重组数据，我们可以推断出它们的相对顺序，从而构建一张遗传图谱[@problem_id:2318096]。", "problem": "一位遗传学家正在研究一种新发现的开花植物——*Astraea floribunda*。通过一系列遗传杂交实验，鉴定出同一条染色体上的四个连锁基因。这些基因控制着不同的性状：花瓣颜色（基因座 *P*）、果实形状（基因座 *F*）、茎的质地（基因座 *S*）和叶缘形状（基因座 *L*）。为了确定这些基因的排列顺序，该遗传学家进行了一系列两点测交，并记录了以下基因对之间的重组频率：\n\n- *F* 与 *S*：15%\n- *P* 与 *S*：25%\n- *F* 与 *P*：10%\n- *S* 与 *L*：5%\n- *P* 与 *L*：30%\n- *F* 与 *L*：20%\n\n根据这些数据，确定这四个基因在染色体上的线性顺序。\n\nA. P-S-F-L\n\nB. F-P-L-S\n\nC. P-F-S-L\n\nD. L-P-S-F\n\nE. S-F-P-L", "solution": "我们利用以下原理：对于重组率 $r<0.5$ 的连锁基因，两点重组率近似于图距（单位为摩尔根或厘摩），并且对于较短的区间，这些距离在一条线性染色体上是可加的。\n\n给定的重组率（以小数表示）：\n- $r(F,S)=0.15$\n- $r(P,S)=0.25$\n- $r(F,P)=0.10$\n- $r(S,L)=0.05$\n- $r(P,L)=0.30$\n- $r(F,L)=0.20$\n\n第一步：找出最接近的一对基因以确定其相邻关系。最小值是 $r(S,L)=0.05$，因此 $S$ 和 $L$ 相邻。\n\n第二步：使用 $r(F,S)=0.15$ 和 $r(F,L)=0.20$ 来确定 $F$ 相对于 $S$–$L$ 基因对的位置。\n- 如果顺序是 $F$–$S$–$L$，那么从 $F$ 到 $L$ 的相加距离是 $0.15+0.05=0.20$，这与 $r(F,L)=0.20$ 相符。因此，$F$ 位于 $S$ 的远离 $L$ 的一侧，得到顺序 $F$–$S$–$L$（根据方向，等同于 $L$–$S$–$F$）。\n\n第三步：使用 $r(P,F)=0.10$、$r(P,S)=0.25$ 和 $r(P,L)=0.30$ 来确定 $P$ 相对于已确定的 $F$–$S$–$L$ 片段的位置，其中距离为 $F$–$S=0.15$ 和 $S$–$L=0.05$。\n- 尝试将 $P$ 放在 $F$ 的左侧：顺序为 $P$–$F$–$S$–$L$。\n  那么 $r(P,F)=0.10$（给定），$r(P,S)=0.10+0.15=0.25$（相符），并且 $r(P,L)=0.10+0.15+0.05=0.30$（相符）。所有三个基因对的距离都满足条件。\n- 其他假设（例如，将 $P$ 放在 $F$ 和 $S$ 之间或 $L$ 的右侧）均不成立。例如，如果顺序是 $F$–$P$–$S$–$L$ 且 $F$–$P=0.10$，那么为了保持 $F$–$S=0.15$， $P$–$S$ 的距离将是 $0.05$，这将意味着 $P$–$L=0.05+0.05=0.10\\neq 0.30$，产生矛盾。任何将 $P$ 放置在 $S$ 和 $L$ 之间的位置都会导致 $r(P,F)\\geq r(F,S)=0.15$，这与 $r(P,F)=0.10$ 相矛盾。\n\n因此，与所有基因对重组率一致的唯一线性顺序是 $P$–$F$–$S$–$L$，这对应于选项 C。", "answer": "$$\\boxed{C}$$", "id": "2318096"}, {"introduction": "在构建了基本的遗传图谱之后，我们可以探索更精细的染色体行为，例如交叉干涉。干涉是一种生物学现象，即一个区域的交叉事件会影响邻近区域发生另一次交叉的概率。本练习将指导你如何利用三点测交数据来量化这种效应，计算出符合系数 ($C$) 和干涉值 ($I$)，从而更深入地理解重组的调控机制[@problem_id:2842598]。", "problem": "在果蝇 *Drosophila melanogaster* 中进行的一项三点测交实验中，涉及顺序未知的三个基因座 $A$、$B$ 和 $C$。一位研究者计数了 $n = 10{,}000$ 个后代，并根据从表型推断出的交换结构将它们分为四个不相交的类别：在 $A$–$B$ 和 $B$–$C$ 两个区间均未发生重组的非重组型，仅在 $A$–$B$ 区间发生单交换的类型，仅在 $B$–$C$ 区间发生单交换的类型，以及在两个区间都发生交换的双交换型。观测到的计数如下：非重组型 $8{,}060$，在 $A$–$B$ 区间单交换型 $1{,}140$，在 $B$–$C$ 区间单交换型 $740$，双交换型 $60$。仅使用遗传的染色体理论的基本原理——即等位基因位于物理染色体上，同源染色体在减数分裂中配对和分离，交换作为非姐妹染色单体之间的物理交换产生重组染色单体，以及测交将配子基因型无掩盖地映射到后代表型——请从第一性原理推导，在相邻区间的交换形成相互独立（即无干涉）的假设下，如何计算双交换的期望数量。然后，根据观测和期望的双交换数计算并发系数和干涉。最后，就业已获得的数值，从干涉方向和强度的角度，提供一个简要的生物学解释。将并发系数和干涉表示为无量纲小数，各自四舍五入到四位有效数字。最终报告的答案必须按顺序列出并发系数和干涉。", "solution": "该问题要求在独立性假设下推导双交换的期望数量，然后根据提供的测交数据计算并发系数和干涉，并对结果进行生物学解释。该问题具有科学依据、提法得当且内部一致，因此是有效的。\n\n首先，我们来确定基本原理。三点测交涉及一个亲本，其三个连锁基因座（$A$、$B$、$C$）为杂合体，与另一个亲本，其这三个基因座均为隐性纯合体进行杂交。后代的表型直接反映了杂合亲本产生的配子基因型。两个基因座之间的重组频率定义为重组配子（也就是重组后代）占总数的比例。它的计算方法是，将两个基因座之间区间内发生交换事件产生的后代数量相加，再除以后代总数。\n\n所提供的数据是根据两个相邻染色体区间（我们将其标记为区间 $1$（基因座 $A$ 和 $B$ 之间）和区间 $2$（基因座 $B$ 和 $C$ 之间））的交换事件进行分类的。给出的计数如下：\n后代总数，$n = 10{,}000$\n非重组型（NCO）计数，$N_{NCO} = 8{,}060$\n区间 $1$ 内单交换（SCO I），$N_{SCO_1} = 1{,}140$\n区间 $2$ 内单交换（SCO II），$N_{SCO_2} = 740$\n双交换（DCO），$N_{DCO} = 60$\n总和为 $8{,}060 + 1{,}140 + 740 + 60 = 10{,}000$，与后代总数 $n$ 一致。\n\n区间 $1$ 的重组频率 $RF_1$ 是在该区间内发生交换所产生的后代所占的比例。这些后代包括区间 $1$ 的单交换型和双交换型。\n$$RF_1 = \\frac{N_{SCO_1} + N_{DCO}}{n} = \\frac{1{,}140 + 60}{10{,}000} = \\frac{1{,}200}{10{,}000} = 0.12$$\n\n同样，区间 $2$ 的重组频率 $RF_2$ 是在这第二个区间内发生交换所产生的后代所占的比例。这些后代包括区间 $2$ 的单交换型和双交换型。\n$$RF_2 = \\frac{N_{SCO_2} + N_{DCO}}{n} = \\frac{740 + 60}{10{,}000} = \\frac{800}{10{,}000} = 0.08$$\n\n问题要求在相邻区间内的交换事件相互独立的假设下推导出双交换的期望数量。这个条件意味着没有干涉。根据概率法则，两个独立事件同时发生的概率是它们各自概率的乘积。\n设 $P(CO_1)$ 为区间 $1$ 内发生交换的概率，$P(CO_2)$ 为区间 $2$ 内发生交换的概率。根据重组频率的定义，$P(CO_1) = RF_1$ 且 $P(CO_2) = RF_2$。\n如果这些事件是独立的，则双交换的概率 $P(DCO)$ 为：\n$$P(DCO)_{\\text{expected}} = P(CO_1) \\times P(CO_2) = RF_1 \\times RF_2$$\n这是双交换的期望频率。为了在一个大小为 $n$ 的群体中找到双交换后代的期望*数量* $N_{DCO, \\text{exp}}$，我们将此概率乘以 $n$：\n$$N_{DCO, \\text{exp}} = n \\times P(DCO)_{\\text{expected}} = n \\times RF_1 \\times RF_2$$\n至此完成了从第一性原理的推导。\n\n现在，我们代入计算出的 $RF_1$ 和 $RF_2$ 的值来求双交换的期望数量：\n$$N_{DCO, \\text{exp}} = 10{,}000 \\times 0.12 \\times 0.08 = 10{,}000 \\times 0.0096 = 96$$\n假设没有干涉，双交换的期望计数为 $96$。观测到的计数为 $N_{DCO, \\text{obs}} = 60$。\n\n并发系数 $C$ 是观测到的双交换数量与期望的双交换数量之比。它衡量了期望的双交换数量被实现的程度。\n$$C = \\frac{N_{DCO, \\text{obs}}}{N_{DCO, \\text{exp}}} = \\frac{60}{96} = \\frac{5}{8} = 0.625$$\n四舍五入到四位有效数字，我们得到 $C = 0.6250$。\n\n干涉 $I$ 量化了一个交换事件对相邻区域发生第二个交换事件概率的影响程度。其定义为：\n$$I = 1 - C$$\n代入 $C$ 的值：\n$$I = 1 - 0.625 = 0.375$$\n四舍五入到四位有效数字，我们得到 $I = 0.3750$。\n\n最后，需要对这些数值进行简要的生物学解释。\n并发系数 $C = 0.6250$ 表明，观测到的双交换频率仅为两个区间内交换事件相互独立时期望值的 $62.5\\%$。\n干涉值 $I = 0.3750$ 为正值。这表示正干涉，这是一种常见的生物学现象，即染色体上一个交换（交叉）的形成，会通过机械或生物化学方式抑制邻近区域第二个交换的形成。在这个具体案例中，由于这种抑制效应，$37.5\\%$ 的期望双交换事件被阻止发生。一个区间内交换的发生，使得相邻区间发生交换的可能性降低了 $37.5\\%$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.6250 & 0.3750 \\end{pmatrix}}$$", "id": "2842598"}, {"introduction": "染色体遗传理论在现代基因组学中依然至关重要，尤其是在理解基因表达调控方面。例如，性染色体在两性间的数量差异催生了精密的剂量补偿机制，以平衡基因表达水平。本练习让你扮演一名计算生物学家的角色，要求你基于第一性原理，设计并应用一个指数来通过模拟的转录组数据（RNA-seq）定量评估剂量补偿的效果[@problem_id:2965681]。", "problem": "您会获得来自雄性和雌性组织的小型基因集的配对核糖核酸测序 (RNA-seq) 数据，以及识别X连锁基因和常染色体基因的染色体注释。您的任务是，从第一性原理出发，形式化、推导并计算一个量化两性间剂量补偿效应的量纲为一的指数，然后将其应用于一个固定的测试套件，并报告数值结果。\n\n背景与允许的基础：遗传的染色体学说断言，基因位于染色体上，并根据染色体的行为进行分离。在许多物种中，雄性和雌性在X染色体的拷贝数上有所不同。分子生物学的中心法则指出，脱氧核糖核酸 (DNA) 转录为核糖核酸 (RNA)，RNA 再翻译为蛋白质。RNA-seq测量提供了基因表达丰度的估计值。除非通过如X染色体失活 (XCI) 或X连锁超转录等调控机制进行补偿，否则X染色体拷贝数的性别差异会导致X连锁基因表达的剂量差异。由于测序深度和全局转录活性在样本间可能存在差异，常染色体表达提供了一个基线，用于校正非因X染色体剂量引起的性别特异性差异。\n\n请根据以下原则设计并推导一个指数。设 $M_i$ 和 $F_i$ 分别表示基因 $i$ 在雄性和雌性样本中的表达量测值，单位为每百万转录本 (TPM)，并设 $C_i \\in \\{\\text{\"X\"}, \\text{\"A\"}\\}$ 为染色体标签（\"X\" 代表X连锁，\"A\" 代表常染色体）。设 $X_M = \\sum_{i : C_i = \\text{\"X\"}} M_i$、$A_M = \\sum_{i : C_i = \\text{\"A\"}} M_i$、$X_F = \\sum_{i : C_i = \\text{\"X\"}} F_i$ 和 $A_F = \\sum_{i : C_i = \\text{\"A\"}} F_i$ 分别表示每个性别中X连锁和常染色体的总表达量。您的指数必须满足：\n- 尺度归一化：它必须在每个性别内部比较X连锁表达与常染色体表达的相对值，以消除全局尺度的影响，也就是说，它必须仅通过性别内部的X染色体与常染色体表达之比来依赖于 $X_M$、$A_M$、$X_F$ 和 $A_F$。\n- 对全局重缩放的不变性：如果所有雄性表达值都乘以一个正常数 $s_M$，所有雌性表达值都乘以一个正常数 $s_F$，该指数必须保持不变。\n- 倍数变化的可解释性：如果雄性性别内部的X染色体与常染色体表达之比与雌性的相差一个乘法因子 $k>0$，该指数必须加性地改变一个与 $\\log_2 k$ 成正比的量，使得 $k=2$ 对应于 $+1$ 的增量，$k=1/2$ 对应 $-1$，$k=1$ 对应 $0$。\n- 符号约定：当且仅当雄性和雌性性别内部的比较值相等时，指数为 $0$；当雄性性别内部的比较值超过雌性时，指数为正；反之为负。\n- 数值稳定性：为处理 $X_M$、$A_M$、$X_F$ 或 $A_F$ 中任何一个可能为 $0$ 的情况，在形成任何比例之前，使用一个小的正常数稳定项 $\\epsilon = 10^{-6}$ 加到所有分子和分母上。\n\n实现一个程序，该程序：\n1. 根据这些原则，构建一个关于 $X_M$、$A_M$、$X_F$ 和 $A_F$ 的具体的、定义明确的函数，该函数满足上述所有性质。\n2. 将其应用于下面测试套件中的每个数据集。\n3. 将所有案例的结果作为单行输出：一个计算值的逗号分隔列表，每个值四舍五入到3位小数，并用方括号括起来。\n\n所有表达输入单位均为每百万转录本 (TPM)；该指数无单位报告。当需要对数时，请使用以2为底的对数。\n\n测试套件（每个案例提供一个元组：雄性TPM列表、雌性TPM列表、染色体标签列表）。每个列表按索引对齐，每个数字必须解释为TPM。标签“X”代表X连锁基因，“A”代表常染色体基因。\n- 案例1（补偿基线；性别内部的X染色体与常染色体表达平衡在两性间相等）：\n  - 雄性TPM：[$50$, $30$, $100$, $120$, $80$, $150$]\n  - 雌性TPM：[$90$, $70$, $200$, $240$, $160$, $300$]\n  - 染色体：[\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"]\n- 案例2（无剂量补偿；在相似的常染色体基线下，雌性X染色体表达相对于雄性大约加倍）：\n  - 雄性TPM：[$50$, $30$, $100$, $120$, $80$, $150$]\n  - 雌性TPM：[$100$, $60$, $100$, $120$, $80$, $150$]\n  - 染色体：[\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"]\n- 案例3（雄性X染色体相对于雌性发生超转录）：\n  - 雄性TPM：[$80$, $60$, $60$, $200$, $300$]\n  - 雌性TPM：[$50$, $50$, $50$, $300$, $450$]\n  - 染色体：[\"X\", \"X\", \"X\", \"A\", \"A\"]\n- 案例4（两性间存在全局表达偏移但补偿得以保留；归一化应能消除此偏移）：\n  - 雄性TPM：[$40$, $40$, $200$, $220$, $230$]\n  - 雌性TPM：[$120$, $120$, $600$, $660$, $690$]\n  - 染色体：[\"X\", \"X\", \"A\", \"A\", \"A\"]\n- 案例5（一个基因的雄性X染色体表达几近于无的边缘案例）：\n  - 雄性TPM：[$0$, $5$, $100$, $100$, $100$]\n  - 雌性TPM：[$10$, $10$, $150$, $150$, $150$]\n  - 染色体：[\"X\", \"X\", \"A\", \"A\", \"A\"]\n- 案例6（部分逃逸X染色体失活；雌性X染色体表达相对于常染色体有适度超出）：\n  - 雄性TPM：[$30$, $30$, $30$, $200$, $200$, $200$, $200$]\n  - 雌性TPM：[$40$, $40$, $40$, $200$, $200$, $200$, $200$]\n  - 染色体：[\"X\", \"X\", \"X\", \"A\", \"A\", \"A\", \"A\"]\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，[$v_1$,$v_2$,$v_3$,$v_4$,$v_5$,$v_6$]），其中每个 $v_i$ 是您为案例 $i$ 计算的指数，并以十进制小数形式四舍五入到3位小数。", "solution": "我们从第一性原理出发，这些原理植根于遗传的染色体学说和中心法则。雄性和雌性之间X染色体的拷贝数差异造成了X连锁基因剂量潜在的两倍不平衡。生物体通常演化出如X染色体失活（XCI）或超转录等调控机制，以使两性间的有效X连锁基因表达均等化。核糖核酸测序（RNA-seq）提供了基因表达的定量估计值，通常以每百万转录本（TPM）进行归一化。然而，整体测序深度和全局转录活性在样本间可能不同。因此，在每个性别内部将X连锁表达与常染色体表达进行比较，可以控制与性染色体剂量无关的全局缩放因子。\n\n我们被要求设计一个满足五个关键性质的指数：通过性别内部的X染色体与常染色体表达之比进行尺度归一化，对全局重缩放的不变性，通过乘法偏差下的加性来获得倍数变化的可解释性，一个以相等为零点的符号约定，以及通过添加一个小的正常数稳定项 $\\epsilon = 10^{-6}$ 来防止除以零的数值稳定性。\n\n设 $X_M = \\sum_{i : C_i = \\text{\"X\"}} M_i$ 和 $A_M = \\sum_{i : C_i = \\text{\"A\"}} M_i$ 分别表示雄性X连锁和常染色体表达的总和，类似地，$X_F$ 和 $A_F$ 表示雌性的总和。定义性别内部经X染色体与常染色体归一化的量\n$$\nR_M = \\frac{X_M + \\epsilon}{A_M + \\epsilon}, \\quad R_F = \\frac{X_F + \\epsilon}{A_F + \\epsilon},\n$$\n其中 $\\epsilon = 10^{-6}$ 被同时添加到分子和分母中以保证稳定性。这种构造强制进行尺度归一化并消除了全局缩放的影响：将所有雄性表达乘以一个正常数 $s_M$ 会同时将 $X_M$ 和 $A_M$ 乘以 $s_M$，而 $R_M$ 保持不变（$R_F$ 同理）。因此，为了满足不变性要求和以相等为零点的符号约定，该指数必须是比值 $R_M / R_F$ 的函数。\n\n为实现倍数变化的可解释性，使得乘法差异变为加法差异，且2倍变化对应于+1，我们需要一个函数 $g$，使得 $g(k)$ 在 $k$ 的乘法下是加性的，并以2为底的倍数变化单位来计量。将乘法差异映射到加法差异的标准且唯一（在相差一个乘法常数的意义下）的连续函数是对数函数。选择以2为底的对数可以将单位设定为：因子2映射到+1，1/2映射到-1，相等（1）映射到0。因此，满足所有约束的唯一自然选择是\n$$\n\\mathrm{DCI} \\equiv \\log_2 \\left( \\frac{R_M}{R_F} \\right) \\;=\\; \\log_2 \\left( \\frac{X_M + \\epsilon}{A_M + \\epsilon} \\cdot \\frac{A_F + \\epsilon}{X_F + \\epsilon} \\right).\n$$\n这个剂量补偿指数（DCI）是量纲为一的，当且仅当两性间归一化的X染色体与常染色体表达之比相等时为 $0$，当雄性归一化X水平超过雌性时为正，反之为负。稳定项 $\\epsilon = 10^{-6}$ 确保了在退化情况下的数值鲁棒性。\n\n我们现在计算每个案例的DCI，四舍五入到3位小数。\n\n- 案例1：\n  - 雄性：$X_M = 50 + 30 = 80$，$A_M = 100 + 120 + 80 + 150 = 450$，所以 $R_M = \\frac{80 + 10^{-6}}{450 + 10^{-6}} \\approx \\frac{80}{450} \\approx 0.177\\overline{7}$。\n  - 雌性：$X_F = 90 + 70 = 160$，$A_F = 200 + 240 + 160 + 300 = 900$，所以 $R_F = \\frac{160 + 10^{-6}}{900 + 10^{-6}} \\approx \\frac{160}{900} \\approx 0.177\\overline{7}$。\n  - 比值：$\\frac{R_M}{R_F} \\approx 1$，因此 $\\mathrm{DCI} \\approx \\log_2(1) = 0.000$。\n\n- 案例2：\n  - 雄性：$X_M = 80$，$A_M = 450$，$R_M \\approx \\frac{80}{450} \\approx 0.177\\overline{7}$。\n  - 雌性：$X_F = 100 + 60 = 160$，$A_F = 100 + 120 + 80 + 150 = 450$，$R_F \\approx \\frac{160}{450} \\approx 0.355\\overline{5}$。\n  - 比值：$\\frac{R_M}{R_F} \\approx \\frac{80/450}{160/450} = \\frac{1}{2}$，所以 $\\mathrm{DCI} = \\log_2\\!\\left(\\frac{1}{2}\\right) = -1.000$。\n\n- 案例3：\n  - 雄性：$X_M = 80 + 60 + 60 = 200$，$A_M = 200 + 300 = 500$，$R_M = \\frac{200}{500} = 0.4$。\n  - 雌性：$X_F = 50 + 50 + 50 = 150$，$A_F = 300 + 450 = 750$，$R_F = \\frac{150}{750} = 0.2$。\n  - 比值：$\\frac{R_M}{R_F} = \\frac{0.4}{0.2} = 2$，因此 $\\mathrm{DCI} = \\log_2(2) = 1.000$。\n\n- 案例4：\n  - 雄性：$X_M = 40 + 40 = 80$，$A_M = 200 + 220 + 230 = 650$，$R_M \\approx \\frac{80}{650} \\approx 0.1230769$。\n  - 雌性：$X_F = 120 + 120 = 240$，$A_F = 600 + 660 + 690 = 1950$，$R_F \\approx \\frac{240}{1950} \\approx 0.1230769$。\n  - 比值：$\\frac{R_M}{R_F} \\approx 1$，所以 $\\mathrm{DCI} \\approx 0.000$。\n\n- 案例5：\n  - 雄性：$X_M = 0 + 5 = 5$，$A_M = 100 + 100 + 100 = 300$，$R_M \\approx \\frac{5 + 10^{-6}}{300 + 10^{-6}} \\approx \\frac{5}{300} \\approx 0.016\\overline{6}$。\n  - 雌性：$X_F = 10 + 10 = 20$，$A_F = 150 + 150 + 150 = 450$，$R_F \\approx \\frac{20}{450} \\approx 0.044\\overline{4}$。\n  - 比值：$\\frac{R_M}{R_F} \\approx \\frac{0.016\\overline{6}}{0.044\\overline{4}} = 0.375$，所以 $\\mathrm{DCI} = \\log_2(0.375) \\approx -1.4150375$，直接计算得：$\\log_2\\!\\left(\\frac{3}{8}\\right) = \\log_2(3) - 3 \\approx 1.58496 - 3 = -1.41504$，四舍五入为 $-1.415$。\n\n- 案例6：\n  - 雄性：$X_M = 30 + 30 + 30 = 90$，$A_M = 200 \\times 4 = 800$，$R_M = \\frac{90}{800} = 0.1125$。\n  - 雌性：$X_F = 40 + 40 + 40 = 120$，$A_F = 200 \\times 4 = 800$，$R_F = \\frac{120}{800} = 0.15$。\n  - 比值：$\\frac{R_M}{R_F} = \\frac{0.1125}{0.15} = 0.75$，得到 $\\mathrm{DCI} = \\log_2(0.75) \\approx -0.415037$，四舍五入为 $-0.415$。\n\n因此，将每个结果四舍五入到3位小数后，按顺序预期的输出是：\n- 案例1：$0.000$\n- 案例2：$-1.000$\n- 案例3：$1.000$\n- 案例4：$0.000$\n- 案例5：$-1.415$\n- 案例6：$-0.415$\n\n程序通过使用提供的染色体标签进行求和来计算 $X_M$、$A_M$、$X_F$ 和 $A_F$，使用 $\\epsilon = 10^{-6}$ 构建 $R_M$ 和 $R_F$，计算 $\\mathrm{DCI} = \\log_2\\!\\left(R_M/R_F\\right)$，四舍五入到3位小数，并按要求格式打印列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_dci(male_tpm, female_tpm, chrom_labels, eps=1e-6):\n    \"\"\"\n    Compute the Dosage Compensation Index (DCI) for one dataset.\n    DCI = log2( ( (X_M + eps)/(A_M + eps) ) / ( (X_F + eps)/(A_F + eps) ) )\n    where X_* and A_* are sums of TPMs over X-linked and autosomal genes.\n    \"\"\"\n    male_tpm = np.asarray(male_tpm, dtype=float)\n    female_tpm = np.asarray(female_tpm, dtype=float)\n    chrom_labels = np.asarray(chrom_labels)\n\n    x_mask = chrom_labels == \"X\"\n    a_mask = chrom_labels == \"A\"\n\n    XM = float(male_tpm[x_mask].sum())\n    AM = float(male_tpm[a_mask].sum())\n    XF = float(female_tpm[x_mask].sum())\n    AF = float(female_tpm[a_mask].sum())\n\n    RM = (XM + eps) / (AM + eps)\n    RF = (XF + eps) / (AF + eps)\n\n    dci = np.log2(RM / RF)\n    return dci\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        (\n            [50, 30, 100, 120, 80, 150],\n            [90, 70, 200, 240, 160, 300],\n            [\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 2\n        (\n            [50, 30, 100, 120, 80, 150],\n            [100, 60, 100, 120, 80, 150],\n            [\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 3\n        (\n            [80, 60, 60, 200, 300],\n            [50, 50, 50, 300, 450],\n            [\"X\", \"X\", \"X\", \"A\", \"A\"],\n        ),\n        # Case 4\n        (\n            [40, 40, 200, 220, 230],\n            [120, 120, 600, 660, 690],\n            [\"X\", \"X\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 5\n        (\n            [0, 5, 100, 100, 100],\n            [10, 10, 150, 150, 150],\n            [\"X\", \"X\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 6\n        (\n            [30, 30, 30, 200, 200, 200, 200],\n            [40, 40, 40, 200, 200, 200, 200],\n            [\"X\", \"X\", \"X\", \"A\", \"A\", \"A\", \"A\"],\n        ),\n    ]\n\n    results = []\n    for male_tpm, female_tpm, chrom_labels in test_cases:\n        dci = compute_dci(male_tpm, female_tpm, chrom_labels, eps=1e-6)\n        results.append(dci)\n\n    # Final print statement in the exact required format, rounded to 3 decimals.\n    print(f\"[{','.join(f'{v:.3f}' for v in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2965681"}]}