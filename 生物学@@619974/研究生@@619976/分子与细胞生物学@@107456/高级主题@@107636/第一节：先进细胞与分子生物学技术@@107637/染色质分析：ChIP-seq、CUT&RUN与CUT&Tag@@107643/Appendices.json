{"hands_on_practices": [{"introduction": "在分析染色质图谱数据时，首要任务之一是区分真实的生物信号和技术噪音。聚合酶链式反应（PCR）扩增是建库过程中的必要步骤，但它可能引入偏差，导致某些DNA片段被过度扩增，形成看似信号强烈的“伪影”（artifacts）。简单地移除所有重复读段（duplicate reads）可能会错误地丢弃来自高密度结合位点的真实信号。本练习 [@problem_id:2938850] 将通过一个思想实验，引导你利用峰内读段起始位点的统计分布，来区分真实的蛋白高占据事件和PCR扩增伪影，这是确保数据质量的关键一步。", "problem": "一个团队正在使用染色质免疫沉淀测序 (ChIP-Seq)、核酸酶靶向下切割和释放 (CUT&amp;RUN) 以及靶向下切割和标签化 (CUT&amp;Tag) 技术对一个转录因子进行分析，他们希望评估去除重复序列是否会错误地丢弃启动子近端峰处真实的高占有率结合信号。考虑一个以基序实例为中心的代表性峰窗口，其宽度为 $W = 200$ 个碱基对。在此窗口中，比对上的总读段起始位点数为 $N = 1000$，观测到的唯一基因组起始坐标数为 $S_{\\text{obs}} = 30$，且最频繁的单个起始坐标携带了 $c_{\\max} = 400$ 个读段。唯一分子标识符 (UMI) 不可用。\n\n使用以下基本依据和假设，来推断在没有聚合酶链式反应 (PCR) 人工产物的情况下预期会发生什么：\n- 在独立的片段化或切割和取样条件下，当忽略局部序列偏好时，$N$ 个读段在 $W$ 个可能的起始位置上的分配可以建模为一个多项分布，其概率均等，为 $p_i = 1/W$。对于每个位置的计数，这可以很好地近似为 $W$ 个独立的泊松变量，其均值为 $\\lambda = N/W$。\n- 在此多项/泊松零假设下，被占据的起始位置数的期望值为 $E[S] = \\sum_{i=1}^{W} \\big(1 - (1 - p_i)^N\\big) = W\\big(1 - (1 - 1/W)^N\\big) \\approx W\\big(1 - e^{-N/W}\\big)$（对于较大的 $W$）。\n- 高占有率会增加 $N$，但其本身并不会使起始分布坍缩到一个或少数几个位置；相反，独立的分子会分布在许多可及的位置上。\n\n仅使用这些依据，判断观测到的模式是否与没有 PCR 人工产物的真实高占有率信号一致，并选择最佳支持的标准，以利用峰内的片段起始分布来区分 PCR 重复和真实生物信号。\n\n在这种情况下，哪个选项最能恰当地区分 PCR 人工产物和真实的高占有率事件，同时最大限度地减少生物信号的损失？\n\nA. 逐峰起始分布检验：对每个峰，计算 $\\lambda = N/W$ 并评估在单个碱基上的泊松($\\lambda$)计数下（使用对 $W$ 个位置的 Bonferroni 校正），$c_{\\max}$ 是否为极端异常值，以及 $S_{\\text{obs}}$ 是否接近零假设的期望值 $W(1 - e^{-N/W})$。如果 $c_{\\max}$ 显著大于预期且 $S_{\\text{obs}}$ 明显不足，则标记为 PCR 人工产物；在被标记的峰中，仅在过度富集的起始坐标处标记重复，而不是移除所有深度。\n\nB. 起始位点共址规则：在峰内，通过移除在给定链上共享相同起始位点的所有额外读段，来保留每个起始坐标最多一个读段，因为无论占有率如何，重复的起始位点都反映了 PCR 重复。\n\nC. 全文库规则：仅当全文库范围的重复率超过某个固定阈值（例如，$50\\%$）时才移除重复，而与峰内任何局部的片段起始模式无关。\n\nD. 链形启发式规则：在基于标签化的图谱中，将在单个基因组坐标上于两条链上都观测到的任何窄峰视为真实结合，并避免在此处移除重复；仅当峰在链间不对称时才移除重复，因为对称性意味着在结合位点处的精确切割。", "solution": "问题陈述需经过验证。\n\n**步骤 1：提取给定信息**\n- 分析方法：染色质免疫沉淀测序 (ChIP-Seq)、核酸酶靶向下切割和释放 (CUT&amp;RUN) 以及靶向下切割和标签化 (CUT&amp;Tag)。\n- 目标：评估去除重复序列的方法，同时保留真实的高占有率信号。\n- 峰窗口宽度：$W = 200$ 个碱基对。\n- 窗口内比对上的总读段起始位点数：$N = 1000$。\n- 观测到的唯一基因组起始坐标数：$S_{\\text{obs}} = 30$。\n- 最频繁的单个起始坐标计数：$c_{\\max} = 400$。\n- 唯一分子标识符 (UMI)：不可用。\n- 零假设模型：读段起始位点遵循多项分布，概率均等 $p_i = 1/W$，可近似为 $W$ 个独立的泊松变量，均值为 $\\lambda = N/W$。\n- 零假设模型下唯一的起始位点期望值：$E[S] \\approx W(1 - e^{-N/W})$。\n- 生物学假设：真实的高占有率会增加 $N$，但会导致起始位点的广泛分布，而不是坍缩到少数几个位置。\n\n**步骤 2：使用提取的给定信息进行验证**\n- **科学性：** 该问题牢固地植根于计算生物学和基因组学。所描述的场景——在染色质图谱数据中区分 PCR 扩增人工产物和真实生物信号热点——是一个核心且经过充分研究的挑战。所提供的统计模型（用于读段起始计数的多项分布的泊松近似）是用于此目的的标准且合适的零假设模型，类似于像 MACS 这样的基础工具中所使用的模型。ChIP-Seq、CUT&amp;RUN 和 CUT&amp;Tag 的概念是标准的分子生物学技术。\n- **良态问题：** 该问题是良态的。它提供了清晰的定量数据（$W, N, S_{\\text{obs}}, c_{\\max}$）和一个特定的理论框架（零假设模型），用于评估观测结果。问题要求基于这些原则找到最佳支持的标准，这使得可以推导出一个单一的、合乎逻辑的答案。\n- **客观性：** 语言是技术性的且无偏见的。它描述了一个场景和一个模型，没有主观或基于意见的陈述。\n\n**步骤 3：结论和行动**\n问题陈述在科学上是合理的、良态的、客观的且自洽的。它提出了一个生物信息学中现实的（尽管是程式化的）挑战。该问题是**有效的**。将继续进行解答。\n\n**推导与分析**\n\n问题的核心是评估观测数据（$N=1000$, $W=200$, $S_{\\text{obs}}=30$, $c_{\\max}=400$）是否与所提供的、无聚合酶链式反应 (PCR) 人工产物的真实生物信号的零假设模型一致。\n\n首先，我们计算零假设下每个位置读段计数的泊松分布参数 $\\lambda$：\n$$ \\lambda = \\frac{N}{W} = \\frac{1000}{200} = 5 $$\n在此模型下，在 $200$ bp 窗口中，从任何单个碱基对开始的读段数预期是一个从均值为 $5$ 的泊松分布中抽取的随机变量。\n\n其次，我们评估观测到的最大计数 $c_{\\max}=400$ 的极端性。从均值为 $\\lambda$ 的泊松分布中观测到计数为 $k$ 的概率是 $P(k; \\lambda) = \\frac{\\lambda^k e^{-\\lambda}}{k!}$。观测到计数为 $400$ 或更高的概率是极小的：\n$$ P(k \\ge 400; \\lambda=5) = \\sum_{k=400}^{\\infty} \\frac{5^k e^{-5}}{k!} \\approx 0 $$\n一个 $400$ 的值大约比均值高出 $(400 - 5) / \\sqrt{5} \\approx 176.6$ 个标准差。如此罕见的事件在零假设模型下实际上是不可能发生的，即使考虑到对 $W=200$ 个位置进行多重检验校正。因此，观测到 $c_{\\max}=400$ 与零假设模型完全不一致，是存在非随机过程的强烈指标，即单个初始片段的 PCR 扩增。\n\n第三，我们计算零假设模型下唯一（不同）起始位置的期望数量 $E[S]$：\n$$ E[S] \\approx W\\left(1 - e^{-N/W}\\right) = 200\\left(1 - e^{-5}\\right) $$\n使用 $e^{-5} \\approx 0.006738$，我们发现：\n$$ E[S] \\approx 200(1 - 0.006738) = 200(0.993262) \\approx 198.65 $$\n被占据的唯一（不同）起始位置的期望数量约为 $199$。而观测到的数量是 $S_{\\text{obs}} = 30$。这与期望值（$30$ vs. $199$）相比存在巨大差距。这种起始位点分布的“低复杂度”，加上在某个位置的极端堆积，证实了这些读段并非如真实生物信号所预期的那样独立分布。相反，$N=1000$ 个读段中的大部分是集中在极少数起始位点的克隆拷贝。\n\n证据压倒性地表明该峰主要由 PCR 人工产物构成。理想的策略必须利用这些信息来校正数据，同时保留任何潜在的真实信号。\n\n**逐项分析**\n\nA. **逐峰起始分布检验：对每个峰，计算 $\\lambda = N/W$ 并评估在单个碱基上的泊松($\\lambda$)计数下（使用对 $W$ 个位置的 Bonferroni 校正），$c_{\\max}$ 是否为极端异常值，以及 $S_{\\text{obs}}$ 是否接近零假设的期望值 $W(1 - e^{-N/W})$。如果 $c_{\\max}$ 显著大于预期且 $S_{\\text{obs}}$ 明显不足，则标记为 PCR 人工产物；在被标记的峰中，仅在过度富集的起始坐标处标记重复，而不是移除所有深度。**\n该选项描述了一种统计上严谨的方法，直接利用了问题陈述中提供的零假设模型。它正确地识别了在这种情况下 PCR 重复的两个典型迹象：异常高的 $c_{\\max}$ 和异常低的 $S_{\\text{obs}}$。所提出的解决方案是精细的：它并非盲目地移除所有重复（这可能会丢弃峰内其他起始位置的合法信号），而是精准地只针对那些经过统计验证的、属于人工产物的特定起始位置的读段。这种方法是精确的，并直接解决了最小化生物信号损失的目标。\n**结论：正确**\n\nB. **起始位点共址规则：在峰内，通过移除在给定链上共享相同起始位点的所有额外读段，来保留每个起始坐标最多一个读段，因为无论占有率如何，重复的起始位点都反映了 PCR 重复。**\n这是一种幼稚且过于激进的策略。根据零假设模型计算（$\\lambda=5$），在一个真实的高占有率区域，偶然发生一些碰撞（多个读段在同一起始坐标）是意料之中的。给定位置拥有多于一个读段的概率是 $1 - P(k=0) - P(k=1) = 1 - e^{-5} - 5e^{-5} \\approx 0.96$。因此，在每个起始位点盲目地移除除一个读段外的所有读段，将严重且系统性地低估合法的高占有率峰的真实信号高度。该方法未能区分偶然碰撞和大规模扩增，违反了最小化生物信号损失的原则。\n**结论：不正确**\n\nC. **全文库规则：仅当全文库范围的重复率超过某个固定阈值（例如，$50\\%$）时才移除重复，而与峰内任何局部的片段起始模式无关。**\n这种方法过于粗糙。PCR 人工产物通常是高度局部化的事件；一个单一的“头彩”峰可能几乎完全是人工产物，而文库的其余部分重复率很低。一个全局阈值对这种局部情况不敏感。它会在一个其他方面都很好的文库中漏掉这个人造峰，并且可能错误地惩罚一个在许多位点上都具有真正高占有率的文库（这自然会导致更高的总体重复率）。它忽略了峰内起始分布中包含的强大的局部信息，而这正是问题的焦点。\n**结论：不正确**\n\nD. **链形启发式规则：在基于标签化的图谱中，将在单个基因组坐标上于两条链上都观测到的任何窄峰视为真实结合，并避免在此处移除重复；仅当峰在链间不对称时才移除重复，因为对称性意味着在结合位点处的精确切割。**\n这种启发式规则基于有缺陷的科学推理。通过 Tn5 转座酶进行的标签化会在 DNA 片段的两端插入接头。来自同一片段两端的读段会比对到正链和负链上，两者之间由片段长度分隔。在一个标签化实验（如 CUT&amp;Tag）中，一个真实的结合位点应该呈现出双峰信号，即一个正链起始位点峰和一个分开的、有偏移的负链起始位点峰。在*完全相同*的单个碱基对坐标上，两条链上出现对称的读段堆积，对于标签化来说在物理上是难以置信的，反而是一个技术或比对人工产物的强烈信号。此外，该规则仅适用于基于标签化的方法，无法推广到基于片段化的方法，如 ChIP-Seq，而后者是问题背景的一部分。\n**结论：不正确**\n\n**结论**\n选项 A 提供了唯一一个在统计上是合理的标准，它充分利用了所提供的零假设模型和数据，并提出了一个旨在清理数据而非简单丢弃数据的精细化操作，从而最大限度地减少了真实生物信号的损失。", "answer": "$$\\boxed{A}$$", "id": "2938850"}, {"introduction": "确保数据质量后，下一步通常是在不同样本或条件之间进行定量比较。然而，测序深度、抗体效率或文库制备过程中的差异会给直接比较原始读段计数带来挑战。本练习 [@problem_id:2938912] 将介绍一种强大的校准技术——外源参照（spike-in）标准化。你将从第一性原理出发，推导出精确计算染色质占据水平倍数变化的公式，这是进行可靠的定量生物学研究所需掌握的一项基本技能。", "problem": "一个实验室正在比较通过CUT&Tag（Cleavage Under Targets and Tagmentation）技术分析的两个样本在某一特定基因组峰上的染色质占据情况。该实验室在两个文库中都使用恒定量的外源spike-in染色质作为内参，这种做法在染色质免疫共沉淀测序（ChIP-Seq）和核酸酶靶向切割与释放技术（CUT&RUN）中也很常见。针对样本$1$和样本$2$测量了以下量：\n- $S_1$ 和 $S_2$：比对上的spike-in读数数量。\n- $N_1$ 和 $N_2$：比对上的总读数数量（spike-in加内源）。\n- $y_1$ 和 $y_2$：来自内源基因组的目标峰的原始读数计数。\n\n假定以下基本事实：\n- 每个文库中添加了绝对数量相同的spike-in分子。\n- 测序是一个线性抽样过程，因此在文库制备和比对后，读数计数与基础分子数量成正比。\n- 不存在对两个样本中的spike-in和内源读数产生差异性影响的比对偏好。\n\n仅从这些假设和定义出发，推导样本$2$相对于样本$1$的峰的spike-in标准化倍数变化，该变化能消除测序深度和文库效率的差异。将您的最终答案表示为由 $S_1$、$S_2$、$N_1$、$N_2$、$y_1$ 和 $y_2$ 组成的单个简化的解析表达式。倍数变化是一个无量纲的量。无需四舍五入；请提供一个闭式表达式。", "solution": "问题陈述被认为是有效的。它在科学上基于定量分子生物学的原理，特别是新一代测序数据的标准化。该问题提法恰当、客观，并包含了推导唯一解所需的所有必要信息。\n\n目标是推导样本$2$相对于样本$1$在特定峰上的染色质占据的倍数变化（$FC$）。这是目标的真实绝对分子数量之比，我们将其表示为 $C_{y_2}$ 和 $C_{y_1}$。\n$$FC = \\frac{C_{y_2}}{C_{y_1}}$$\n问题提供了一组测量的读数计数：$y_1$ 和 $y_2$ 代表目标内源峰，$S_1$ 和 $S_2$ 代表外源spike-in内参，$N_1$ 和 $N_2$ 代表比对上的总读数。问题还提出了一组我们必须据此构建论证的基本假设。\n\n设 $C_s$ 为添加到每个文库中的spike-in分子的绝对数量。根据题意，这个量对于两个样本是相同的。基本假设是测序是一个线性抽样过程。这意味着对于任何给定的样本库，观察到的读数数量与初始分子数量成正比。我们可以为样本$1$和样本$2$引入特定的比例常数 $k_1$ 和 $k_2$ ，它们封装了所有技术差异的来源，例如抗体效率、文库制备产量和测序深度。\n\n这使我们能够写出一个方程组，将未知的分子数量与观察到的读数计数联系起来：\n对于样本$1$：\n峰上的内源读数数量 $y_1$ 与该峰上的内源分子数量 $C_{y_1}$ 成正比。\n$$y_1 = k_1 C_{y_1}$$\nspike-in读数数量 $S_1$ 与spike-in分子数量 $C_s$ 成正比。\n$$S_1 = k_1 C_s$$\n\n对于样本$2$：\n峰上的内源读数数量 $y_2$ 与该峰上的内源分子数量 $C_{y_2}$ 成正比。\n$$y_2 = k_2 C_{y_2}$$\nspike-in读数数量 $S_2$ 与spike-in分子数量 $C_s$ 成正比。\n$$S_2 = k_2 C_s$$\n\n我们的目标是求出 $\\frac{C_{y_2}}{C_{y_1}}$ 的值。我们首先用测量量和未知技术因子来表示未知的分子数量。根据内源读数的方程：\n$$C_{y_1} = \\frac{y_1}{k_1}$$\n$$C_{y_2} = \\frac{y_2}{k_2}$$\n\n将这些代入倍数变化的表达式，我们得到：\n$$FC = \\frac{C_{y_2}}{C_{y_1}} = \\frac{y_2 / k_2}{y_1 / k_1} = \\frac{y_2}{y_1} \\cdot \\frac{k_1}{k_2}$$\n该表达式包含了未知技术因子的比率 $\\frac{k_1}{k_2}$。spike-in内参的目的就是确定这个比率。从spike-in读数的方程中，我们可以表达出 $k_1$ 和 $k_2$：\n$$k_1 = \\frac{S_1}{C_s}$$\n$$k_2 = \\frac{S_2}{C_s}$$\n\n因此，这些因子的比率为：\n$$\\frac{k_1}{k_2} = \\frac{S_1 / C_s}{S_2 / C_s} = \\frac{S_1}{S_2}$$\n未知的spike-in分子绝对数量 $C_s$ 被消掉了。这表明两个样本之间的技术效率之比可以直接通过它们各自的spike-in读数计数之比来确定。\n\n通过将此结果代回倍数变化的方程，我们消除了未知的技术因子：\n$$FC = \\frac{y_2}{y_1} \\cdot \\left(\\frac{S_1}{S_2}\\right) = \\frac{y_2 S_1}{y_1 S_2}$$\n这就是spike-in标准化的倍数变化的最终表达式。这个计算也可以看作是标准化峰信号的比率，其中每个样本的信号都用其自身的spike-in信号进行标准化：$FC = \\frac{(y_2/S_2)}{(y_1/S_1)}$。项 $y/S$ 代表内源目标读数与spike-in读数的比率，它与真实的生物学比率 $C_y/C_s$ 成正比，因为技术因子 $k$ 在同一样本内部被消掉了：$\\frac{y}{S} = \\frac{k C_y}{k C_s} = \\frac{C_y}{C_s}$。\n\n总读数计数 $N_1$ 和 $N_2$ 在此推导中并非必需。在spike-in标准化的背景下，它们是无关变量，因为spike-in标准化的设计初衷就是为了独立于文库总大小，从而能正确处理样本间全局染色质总量不同的情况。在给定的假设下，一个包含 $N_1$ 和 $N_2$ 的标准化方案将是不恰当的，且稳健性较差。该问题旨在考察识别完成此任务所需的正确变量和原理的能力。", "answer": "$$\\boxed{\\frac{y_2 S_1}{y_1 S_2}}$$", "id": "2938912"}, {"introduction": "在全基因组范围的染色质分析中，我们会同时检验成千上万个潜在的结合位点，这引发了“多重检验”问题，即随机性本身就可能产生许多看似显著的结果。因此，在得出结论之前，必须对原始的 $p$ 值进行校正。本练习 [@problem_id:2938847] 将带你实践Benjamini-Hochberg程序，这是一种控制假发现率（False Discovery Rate, FDR）的标准统计方法。通过处理一组假设的 $p$ 值，你将学会如何计算 $q$ 值，并确定在高通量实验背景下哪些结果是统计上稳健的。", "problem": "在一项使用 Cleavage Under Targets and Tagmentation (CUT&amp;Tag) 技术绘制组蛋白修饰 H3K27ac 图谱的全基因组分析实验中，您评估了一组候选峰相对于匹配对照组的富集情况。针对 $m$ 个峰中的每一个，都进行了一次双边假设检验，其零假设为该局部读段密度相比于对照组没有富集。假设在零假设下，$p$ 值是独立同分布的，且服从 $[0,1]$ 上的均匀分布，并且通过使用 Benjamini–Hochberg 程序控制假发现率 (FDR) 来做出拒绝决策。\n\n对于 $m=12$ 个峰，您获得了以下（未排序的）$p$ 值：$0.039$、$0.0018$、$0.12$、$0.21$、$0.026$、$0.0009$、$0.57$、$0.071$、$0.055$、$0.006$、$0.017$、$0.010$。\n\n使用 Benjamini–Hochberg 程序，在目标 FDR 水平 $\\alpha = 0.05$ 下，计算这些 $p$ 值的 Benjamini–Hochberg $q$ 值，并确定在 FDR $=0.05$ 时有多少个峰将被视为显著。仅报告保留的峰的数量作为最终答案；将其表示为一个不带单位的整数。无需进行精确算术之外的舍入。", "solution": "问题陈述已经过验证，被认为是适定的、内部一致且有科学依据的。它提出了一个分析高通量生物数据中的标准统计任务。因此，可以通过严格应用指定程序来推导出解决方案。\n\n任务是通过使用 Benjamini–Hochberg (BH) 程序控制假发现率 (FDR)，从一组 $p$ 值中确定统计显著的峰的数量。\n\n给定的参数是：\n假设检验的总数（峰数），$m = 12$。\n目标 FDR 水平，$\\alpha = 0.05$。\n$m=12$ 个未排序的 $p$ 值集合：$\\{0.039, 0.0018, 0.12, 0.21, 0.026, 0.0009, 0.57, 0.071, 0.055, 0.006, 0.017, 0.010\\}$。\n\nBenjamini–Hochberg 程序包括以下步骤：\n1.  将原始 $p$ 值从小到大排序。记这些排序后的 $p$ 值为 $p_{(1)}, p_{(2)}, \\dots, p_{(m)}$。\n2.  对于每个排序后的 $p$ 值 $p_{(i)}$，其中 $i$ 是其从 $1$ 到 $m$ 的排名，计算 Benjamini-Hochberg 临界值 $(i/m)\\alpha$。\n3.  找到最大的排名 $k$，使得其 $p$ 值 $p_{(k)}$ 小于或等于其对应的临界值，即 $p_{(k)} \\le \\frac{k}{m}\\alpha$。\n4.  排名从 $1$ 到 $k$ 的所有检验的原假设都被拒绝。因此，发现的数量为 $k$。\n\n首先，我们将 12 个 $p$ 值按升序排列：\n$p_{(1)} = 0.0009$\n$p_{(2)} = 0.0018$\n$p_{(3)} = 0.006$\n$p_{(4)} = 0.010$\n$p_{(5)} = 0.017$\n$p_{(6)} = 0.026$\n$p_{(7)} = 0.039$\n$p_{(8)} = 0.055$\n$p_{(9)} = 0.071$\n$p_{(10)} = 0.12$\n$p_{(11)} = 0.21$\n$p_{(12)} = 0.57$\n\n接下来，我们将每个 $p_{(i)}$ 与 BH 临界值 $\\frac{i}{m}\\alpha = \\frac{i}{12} \\times 0.05$ 进行比较。\n$\n\\begin{array}{c|c|c|c}\n\\text{排名 } (i) & p_{(i)} & \\text{BH 临界值 } (\\frac{i}{12} \\times 0.05) & p_{(i)} \\le \\text{临界值？} \\\\\n\\hline\n1 & 0.0009 & \\frac{1}{12} \\times 0.05 \\approx 0.00417 & \\text{是} \\\\\n2 & 0.0018 & \\frac{2}{12} \\times 0.05 \\approx 0.00833 & \\text{是} \\\\\n3 & 0.006 & \\frac{3}{12} \\times 0.05 = 0.0125 & \\text{是} \\\\\n4 & 0.010 & \\frac{4}{12} \\times 0.05 \\approx 0.01667 & \\text{是} \\\\\n5 & 0.017 & \\frac{5}{12} \\times 0.05 \\approx 0.02083 & \\text{是} \\\\\n6 & 0.026 & \\frac{6}{12} \\times 0.05 = 0.025 & \\text{否} \\\\\n7 & 0.039 & \\frac{7}{12} \\times 0.05 \\approx 0.02917 & \\text{否} \\\\\n8 & 0.055 & \\frac{8}{12} \\times 0.05 \\approx 0.03333 & \\text{否} \\\\\n9 & 0.071 & \\frac{9}{12} \\times 0.05 = 0.0375 & \\text{否} \\\\\n10 & 0.12 & \\frac{10}{12} \\times 0.05 \\approx 0.04167 & \\text{否} \\\\\n11 & 0.21 & \\frac{11}{12} \\times 0.05 \\approx 0.04583 & \\text{否} \\\\\n12 & 0.57 & \\frac{12}{12} \\times 0.05 = 0.05 & \\text{否}\n\\end{array}\n$\n满足 $p_{(k)} \\le \\frac{k}{m}\\alpha$ 的最大排名 $k$ 是 $k=5$。因此，$p$ 值最小的 5 个峰的原假设被拒绝。\n\n问题还要求计算 Benjamini–Hochberg 的 $q$ 值。第 $i$ 个排序后 $p$ 值的 $q$ 值，即 $q_{(i)}$，被定义为在该检验被判为显著时所能达到的最小 FDR。其计算公式为：\n$$\nq_{(i)} = \\min_{j=i, \\dots, m} \\left( \\frac{m \\cdot p_{(j)}}{j} \\right)\n$$\n这确保了 $q$ 值序列是单调不减的。一个实用的计算方法是，首先对所有排名 $i$ 计算一个中间值 $q'_{(i)} = \\frac{m \\cdot p_{(i)}}{i}$，然后从 $q_{(m)} = q'_{(m)}$ 开始，向后迭代以强制单调性：$q_{(i)} = \\min(q'_{(i)}, q_{(i+1)})$。\n\n我们为我们的数据计算 $q$ 值：\n$\n\\begin{array}{c|c|c|l}\n\\text{排名 } (i) & p_{(i)} & q'_{(i)} = \\frac{12 \\cdot p_{(i)}}{i} & q_{(i)} \\\\\n\\hline\n1 & 0.0009 & 0.0108 & 0.0108 \\\\\n2 & 0.0018 & 0.0108 & 0.0108 \\\\\n3 & 0.006 & 0.0240 & 0.0240 \\\\\n4 & 0.010 & 0.0300 & 0.0300 \\\\\n5 & 0.017 & 0.0408 & 0.0408 \\\\\n6 & 0.026 & 0.0520 & 0.0520 \\\\\n7 & 0.039 & \\approx 0.06686 & \\approx 0.06686 \\\\\n8 & 0.055 & 0.0825 & 0.0825 \\\\\n9 & 0.071 & \\approx 0.09467 & \\approx 0.09467 \\\\\n10 & 0.12 & 0.1440 & 0.1440 \\\\\n11 & 0.21 & \\approx 0.22909 & \\approx 0.22909 \\\\\n12 & 0.57 & 0.5700 & 0.5700\n\\end{array}\n$\n\n为了精确说明单调性的强制执行：\n$q_{(12)} = 0.57$\n$q_{(11)} = \\min(q'_{(11)}, q_{(12)}) = \\min(0.22909..., 0.57) \\approx 0.22909$\n$q_{(10)} = \\min(q'_{(10)}, q_{(11)}) = \\min(0.144, 0.22909...) = 0.144$\n...\n$q_{(6)} = \\min(q'_{(6)}, q_{(7)}) = \\min(0.052, 0.06686...) = 0.052$\n$q_{(5)} = \\min(q'_{(5)}, q_{(6)}) = \\min(0.0408, 0.052) = 0.0408$\n$q_{(4)} = \\min(q'_{(4)}, q_{(5)}) = \\min(0.030, 0.0408) = 0.030$\n$q_{(3)} = \\min(q'_{(3)}, q_{(4)}) = \\min(0.024, 0.030) = 0.024$\n$q_{(2)} = \\min(q'_{(2)}, q_{(3)}) = \\min(0.0108, 0.024) = 0.0108$\n$q_{(1)} = \\min(q'_{(1)}, q_{(2)}) = \\min(0.0108, 0.0108) = 0.0108$\n\n显著峰的数量是满足 $q_{(i)} \\le \\alpha = 0.05$ 的检验数量。\n- $q_{(1)} = 0.0108 \\le 0.05$\n- $q_{(2)} = 0.0108 \\le 0.05$\n- $q_{(3)} = 0.0240 \\le 0.05$\n- $q_{(4)} = 0.0300 \\le 0.05$\n- $q_{(5)} = 0.0408 \\le 0.05$\n- $q_{(6)} = 0.0520 > 0.05$\n\n该条件对前 5 个峰成立。在 0.05 的 FDR 水平下被视为显著的峰的数量是 5。", "answer": "$$\\boxed{5}$$", "id": "2938847"}]}