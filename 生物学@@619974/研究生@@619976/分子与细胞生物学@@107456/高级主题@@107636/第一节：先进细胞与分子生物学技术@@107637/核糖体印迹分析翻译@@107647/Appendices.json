{"hands_on_practices": [{"introduction": "高质量核糖体图谱（Ribo-seq）数据的一个核心特征是其三联体周期性，这直接反映了翻译过程中核糖体以密码子为单位的步进。本练习旨在通过一个假设性的系统性偏移情景，让您深入探究P位点（P-site）确定的准确性与最终周期性信号强度之间的定量关系。通过动手计算，您将更深刻地理解这一关键的质量控制指标，并认识到数据处理中的微小误差如何影响分析结果 [@problem_id:2963266]。", "problem": "核糖体分析 (Ribo-seq) 通过定位受保护的片段并推断核糖体的肽酰位点 (P-位点) 核苷酸来估计核糖体在信使核糖核酸 (mRNA) 上的位置。翻译以长度为 $3$ 的密码子进行，因此比对到蛋白质编码区的读段表现出三联体周期性：当比对的P-位点位置对 $3$ 取模时，大多数读段落在注释的编码框内。考虑以下编码区读段的受控情景：研究者对P-位点偏移的估计存在 $+1$ 个核苷酸的系统性偏移（即，每个分配的P-位点相对于其真实位置都精确地前移了 $1$ 个核苷酸）。\n\n假设以下基本前提：\n- 翻译保持恒定的阅读框；模 $3$ 的框指数为 $j \\in \\{0,1,2\\}$，其中 $j=0$ 表示注释的编码框。\n- 真实的编码区足迹的真实框分配概率为 $p_{0}, p_{1}, p_{2}$，且满足 $\\sum_{j=0}^{2} p_{j} = 1$。\n- 分配的P-位点发生 $+1$ 个核苷酸的循环移位，会将一个真实框 $j$ 映射到一个观测框 $(j+1) \\bmod 3$。\n- 一部分比例为 $c$ 的比对读段来源于编码序列上具有上述三联体结构的真实延伸核糖体（信号），而剩余比例 $r = 1-c$ 是无框偏好的背景读段（噪声），它们以概率向量 $u = (1/3, 1/3, 1/3)$ 均匀分布在各个框中。\n\n设真实框概率为 $p = (p_{0}, p_{1}, p_{2}) = (0.82, 0.09, 0.09)$，信号比例为 $c = 0.80$（因此 $r = 0.20$）。将研究者的三联体周期性统计量定义为框偏差向量（与均匀分布的偏差）的第一个非零离散傅里叶变换 (DFT) 分量的幅值：\n$$\nA(p) \\equiv \\left| \\sum_{j=0}^{2} \\left(p_{j} - \\frac{1}{3}\\right) \\,\\omega^{j} \\right|, \\quad \\text{where } \\omega \\equiv \\exp\\!\\left(-\\frac{2\\pi i}{3}\\right).\n$$\n\n仅从上述定义和假设出发，计算在系统性 $+1$ 核苷酸P-位点误差下：\n1) 混合信号和噪声后，编码区的观测框分配概率向量，以及\n2) 对应的三联体周期性幅值。\n\n将您的最终答案表示为单行矩阵 $\\begin{pmatrix} \\hat{p}_{0} & \\hat{p}_{1} & \\hat{p}_{2} & \\hat{A} \\end{pmatrix}$，其中 $\\hat{p}_{j}$ 是观测到的框概率，$\\hat{A}$ 是观测到的周期性幅值。将每个条目四舍五入到四位有效数字。这些量是无量纲的。", "solution": "我们从模 $3$ 的框指数、信号与均匀背景的混合以及基于离散傅里叶变换 (DFT) 的周期性统计量的定义出发。设真实编码读段的真实框分布向量为 $p = (p_{0}, p_{1}, p_{2})$，且 $\\sum_{j=0}^{2} p_{j} = 1$。系统性的 $+1$ 核苷酸P-位点分配误差将真实框 $j$ 映射到观测框 $(j+1) \\bmod 3$，这相当于将框向量循环移位一个位置。用 $R$ 表示此旋转算子，因此\n$$\nR(p) \\equiv \\big(p_{2},\\, p_{0},\\, p_{1}\\big).\n$$\n给定信号比例 $c$ 和均匀分布在各个框中的背景比例 $r = 1-c$（其概率向量为 $u = (1/3, 1/3, 1/3)$），系统性误差下的观测框向量是以下混合：\n$$\n\\hat{p} \\equiv c\\,R(p) + r\\,u.\n$$\n\n代入给定值 $p = (0.82, 0.09, 0.09)$ 和 $c=0.80$（因此 $r=0.20$），我们首先计算旋转后的编码分量：\n$$\nR(p) = \\big(0.09,\\, 0.82,\\, 0.09\\big).\n$$\n与均匀背景混合后得到\n$$\n\\hat{p} = 0.80 \\cdot \\big(0.09,\\, 0.82,\\, 0.09\\big) + 0.20 \\cdot \\left(\\frac{1}{3},\\, \\frac{1}{3},\\, \\frac{1}{3}\\right).\n$$\n计算每个分量：\n$$\n0.80 \\cdot 0.09 = 0.072,\\quad 0.80 \\cdot 0.82 = 0.656,\\quad 0.20 \\cdot \\frac{1}{3} = \\frac{1}{15} \\approx 0.066\\overline{6}.\n$$\n因此\n$$\n\\hat{p}_{0} = 0.072 + \\frac{1}{15} = \\frac{9}{125} + \\frac{1}{15} = \\frac{52}{375} \\approx 0.1386\\overline{6},\n$$\n$$\n\\hat{p}_{1} = 0.656 + \\frac{1}{15} = \\frac{82}{125} + \\frac{1}{15} = \\frac{271}{375} \\approx 0.7226\\overline{6},\n$$\n$$\n\\hat{p}_{2} = 0.072 + \\frac{1}{15} = \\frac{52}{375} \\approx 0.1386\\overline{6}.\n$$\n\n接下来，我们计算三联体周期性幅值。根据定义，\n$$\nA(p) \\equiv \\left| \\sum_{j=0}^{2} \\left(p_{j} - \\frac{1}{3}\\right)\\omega^{j} \\right|,\\quad \\omega \\equiv \\exp\\!\\left(-\\frac{2\\pi i}{3}\\right).\n$$\n我们将首先仅使用定义来建立两个普适的不变性属性：\n\n1) 循环移位下的不变性（相位相差之外）。对于 $+1$ 的循环移位，$R(p)_{j} = p_{j-1}$，其中指数对 $3$ 取模。那么\n$$\n\\sum_{j=0}^{2} \\left(R(p)_{j} - \\frac{1}{3}\\right)\\omega^{j}\n= \\sum_{j=0}^{2} \\left(p_{j-1} - \\frac{1}{3}\\right)\\omega^{j}\n= \\omega \\sum_{m=0}^{2} \\left(p_{m} - \\frac{1}{3}\\right)\\omega^{m},\n$$\n这里我们代入 $m=j-1$ 并提取了因子 $\\omega$，因为 $\\omega^{j} = \\omega \\cdot \\omega^{m}$。由于 $|\\omega|=1$，因此可得\n$$\nA\\big(R(p)\\big) = A(p).\n$$\n\n2) 线性及均匀分量的消除。对于混合 $\\hat{p} = c\\,R(p) + r\\,u$：\n$$\nA(\\hat{p}) = \\left| \\sum_{j=0}^{2} \\left(c\\,R(p)_{j} + r\\,\\frac{1}{3} - \\frac{1}{3}\\right)\\omega^{j} \\right|\n= \\left| c \\sum_{j=0}^{2} \\left(R(p)_{j} - \\frac{1}{3}\\right)\\omega^{j} + (r-1)\\sum_{j=0}^{2} \\frac{1}{3}\\omega^{j} \\right|.\n$$\n但对于三次单位根，$\\sum_{j=0}^{2} \\omega^{j} = 0$，因此均匀项消失，并且\n$$\nA(\\hat{p}) = c \\left| \\sum_{j=0}^{2} \\left(R(p)_{j} - \\frac{1}{3}\\right)\\omega^{j} \\right| = c\\,A\\big(R(p)\\big) = c\\,A(p).\n$$\n\n因此，我们只需计算给定 $p$ 的 $A(p)$，然后乘以 $c=0.80$ 进行缩放。显式计算 $A(p)$。设\n$$\nq_{j} \\equiv p_{j} - \\frac{1}{3}.\n$$\n对于 $p=(0.82,0.09,0.09)$，\n$$\nq_{0} = 0.82 - \\frac{1}{3} = \\frac{41}{50} - \\frac{1}{3} = \\frac{73}{150},\n$$\n$$\nq_{1} = 0.09 - \\frac{1}{3} = \\frac{9}{100} - \\frac{1}{3} = -\\frac{73}{300},\n$$\n$$\nq_{2} = -\\frac{73}{300}.\n$$\n使用 $\\omega^{0}=1$、$\\omega^{1}=-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}$ 和 $\\omega^{2}=-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}$，注意到 $q_{1}=q_{2}$，因此虚部抵消：\n$$\n\\sum_{j=0}^{2} q_{j}\\omega^{j} = q_{0}\\cdot 1 + q_{1}\\omega + q_{2}\\omega^{2}\n= q_{0} + q_{1}(\\omega + \\omega^{2}) = q_{0} + q_{1}(-1) = q_{0} - q_{1}.\n$$\n因此\n$$\nA(p) = |q_{0} - q_{1}| = \\left|\\frac{73}{150} - \\left(-\\frac{73}{300}\\right)\\right| = \\left|\\frac{73}{150} + \\frac{73}{300}\\right| = \\frac{73}{100} = 0.73.\n$$\n应用 $c=0.80 = \\frac{4}{5}$ 进行缩放，\n$$\n\\hat{A} = A(\\hat{p}) = c\\,A(p) = \\frac{4}{5} \\cdot \\frac{73}{100} = \\frac{73}{125} = 0.584.\n$$\n\n汇总结果并将每个条目四舍五入到四位有效数字：\n$$\n\\hat{p}_{0} \\approx 0.1387,\\quad \\hat{p}_{1} \\approx 0.7227,\\quad \\hat{p}_{2} \\approx 0.1387,\\quad \\hat{A} \\approx 0.5840.\n$$\n\n这些值揭示了 $+1$ 核苷酸的系统性P-位点偏移误差如何循环置换框分配概率，同时保持三联体周期性幅值不变，唯一的改变是均匀背景的稀释效应，它将幅值按信号比例 $c$ 进行缩放。", "answer": "$$\\boxed{\\begin{pmatrix}0.1387 & 0.7227 & 0.1387 & 0.5840\\end{pmatrix}}$$", "id": "2963266"}, {"introduction": "在获得了高质量的读段（reads）后，下一步是准确地将它们分配到相应的基因上以进行定量分析。然而，一个普遍的挑战是处理那些可以比对到基因组多个位置的多重比对读段（multi-mapping reads），尤其是在旁系同源基因之间。本练习提供了一个实践性的编程任务，要求您实现并评估三种不同的分配策略——从简单的均一分配到基于期望最大化（EM）算法的统计模型——以解决这一模糊性，并衡量不同方法对翻译效率估计的影响 [@problem_id:2963228]。", "problem": "您将执行一项基于核糖体翻译谱分析原理的建模任务。请使用以下基本原理来推导一种算法，然后将其实现为一个程序。基本原理：中心法则指出，基因被转录成信使RNA（mRNA），然后由核糖体翻译成蛋白质。在核糖体谱分析中，对核糖体保护的片段（RPFs）进行测序；RPFs 的计数反映了核糖体的占据率。一个公认的结论是，对于一个索引为 $g$ 的基因，如果 $m_g$ 表示其 mRNA 丰度，$\\theta_g$ 表示其翻译效率（TE），那么预期的 RPF 计数与 $m_g \\theta_g$ 成正比。在这种设置下，翻译效率的一个实用定义是 $TE_g \\equiv \\theta_g = \\text{RPF}_g / m_g$，这是一个无量纲的量。当一个读段（read）能够同等地比对到多个旁系同源基因时，就会产生多重比对读段；这些模糊读段在基因间的分配会影响 $TE_g$ 的估计值。\n\n您的任务是：基于上述基本原理和标准似然原则，推导出一种在旁系同源基因间对多重比对读段进行加权的方法，并评估不同加权方案如何影响 $TE_g$ 的估计值。具体而言：\n\n1. 将一个旁系同源基因群组表示为一组基因 $\\{g\\}$，对于该群组，您将获得以下给定信息：\n   - 一个 mRNA 丰度向量 $\\mathbf{m} = (m_g)$，\n   - 一个唯一 RPF 计数向量 $\\mathbf{u} = (u_g)$，\n   - 一个标量 $M$，表示能够同等比对到该群组中任何基因的模糊 RPF 读段的总数。\n   - 一个仅用于评估的基准翻译效率向量 $\\boldsymbol{\\theta}^{\\ast} = (\\theta^{\\ast}_g)$。\n\n2. 为群组中的 $M$ 个模糊读段定义并实现三种分配方案：\n   - 均匀分配：在群组中的所有基因间进行平均分配。\n   - 按 mRNA 比例分配：根据 $m_g$ 按比例分配。\n   - 一种迭代最大似然分配，该方法由一个泊松生成模型证明其合理性，模型中基因 $g$ 观测到的 RPF 计数遵循均值为 $m_g \\theta_g$ 的泊松分布。在该模型下，第 $t$ 次迭代时，基因 $g$ 对模糊读段的责任（responsibilities）与 $m_g \\theta_g^{(t)}$ 成正比。通过将唯一数据估计量与一个非零基线相结合来初始化 $\\theta_g^{(0)}$，仅使用在不了解多重比对信息的情况下可用的信息，使得 $\\theta_g^{(0)} = u_g / m_g + \\lambda$，其中基线 $\\lambda$ 估计为全局唯一数据的均值 $\\lambda = \\left(\\sum_g u_g\\right)/\\left(\\sum_g m_g\\right)$。迭代直至所有基因中 $\\theta_g$ 的最大绝对变化量低于 $10^{-10}$ 的容差，或达到 $10{,}000$ 次迭代，以先发生者为准。收敛后，将被分配的模糊读段定义为 $a_g$（基因 $g$ 的预期模糊读段计数，满足 $\\sum_g a_g = M$），并计算最终的 $\\widehat{\\theta}_g = (u_g + a_g)/m_g$。\n   您的程序必须严格按照描述实现所有三种方案。\n\n3. 对于每种方案，计算翻译效率估计值 $\\widehat{\\theta}_g = (u_g + a_g)/m_g$，并根据提供的基准值 $\\theta^{\\ast}_g$ 评估群组中所有基因的均方误差（MSE）：\n   $$ \\text{MSE} = \\frac{1}{G} \\sum_{g=1}^{G} \\left(\\widehat{\\theta}_g - \\theta^{\\ast}_g \\right)^2, $$\n   其中 $G$ 是旁系同源基因群组中的基因数量。\n\n测试套件。实现您的程序，使其能在以下四个旁系同源基因群组案例上运行。每个案例都指定了 $(\\mathbf{m}, \\mathbf{u}, M, \\boldsymbol{\\theta}^{\\ast})$。\n\n- 案例 A（平衡的旁系同源基因）：\n  - $\\mathbf{m} = [500, 500]$,\n  - $\\mathbf{u} = [10, 10]$,\n  - $M = 20$,\n  - $\\boldsymbol{\\theta}^{\\ast} = [0.04, 0.04]$.\n\n- 案例 B（mRNA 相等但翻译效率不平衡）：\n  - $\\mathbf{m} = [500, 500]$,\n  - $\\mathbf{u} = [16, 4]$,\n  - $M = 30$,\n  - $\\boldsymbol{\\theta}^{\\ast} = [0.08, 0.02]$.\n\n- 案例 C（一个旁系同源基因的唯一 RPF 为零）：\n  - $\\mathbf{m} = [400, 200]$,\n  - $\\mathbf{u} = [2, 0]$,\n  - $M = 22$,\n  - $\\boldsymbol{\\theta}^{\\ast} = [0.05, 0.02]$.\n\n- 案例 D（三个具有稀疏唯一 RPF 的旁系同源基因）：\n  - $\\mathbf{m} = [300, 150, 50]$,\n  - $\\mathbf{u} = [4, 1, 0]$,\n  - $M = 19$,\n  - $\\boldsymbol{\\theta}^{\\ast} = [0.06, 0.03, 0.015]$.\n\n输出规范。您的程序必须按照 A、B、C、D 的顺序为每个案例计算三种方案下的 MSE，方案的固定顺序为：均匀分配、按 mRNA 比例分配、迭代最大似然分配。将所有 12 个浮点数 MSE 值按以下顺序汇总到一个列表中：\n$$[\\text{A\\_uniform}, \\text{A\\_mRNA}, \\text{A\\_iterative}, \\text{B\\_uniform}, \\text{B\\_mRNA}, \\text{B\\_iterative}, \\text{C\\_uniform}, \\text{C\\_mRNA}, \\text{C\\_iterative}, \\text{D\\_uniform}, \\text{D\\_mRNA}, \\text{D\\_iterative}]$$\n并将它们作为单行打印，格式为方括号内由逗号分隔的列表。每个数字精确到小数点后 $6$ 位（如有需要，按四舍五入到远离零的方向取整）。不得打印任何额外文本。", "solution": "该问题已经过验证，被认定是有效的。它在科学上植根于分子生物学和统计推断的原理，特别是核糖体谱分析和基于似然的计数数据建模。该问题是适定的（well-posed），提供了一套完整且一致的定义、数据和目标。它是一项客观、可形式化的任务，与其所述领域直接相关，并且没有歧义或谬误。\n\n核心任务是根据核糖体谱分析数据估算基因特异性翻译效率，记为 $\\theta_g$。所提供的基本关系是，基因 $g$ 的预期核糖体保护片段（RPF）计数 $\\text{RPF}_g$ 与其信使 RNA（mRNA）丰度 $m_g$ 和其翻译效率 $\\theta_g$ 的乘积成正比。因此，$\\theta_g$ 的一个实用估计量是 $\\widehat{\\theta}_g = \\text{RPF}_g / m_g$。\n\n复杂性源于多重比对读段，这些是无法唯一分配给单个基因的 RPF。对于一个包含 $G$ 个基因的旁系同源基因群组，给定唯一比对的 RPF 计数向量 $\\mathbf{u} = (u_1, u_2, \\ldots, u_G)$、mRNA 丰度向量 $\\mathbf{m} = (m_1, m_2, \\ldots, m_G)$ 以及模糊 RPF 的总数 $M$。基因 $g$ 的总 RPF 计数为 $u_g + a_g$，其中 $a_g$ 是分配给基因 $g$ 的模糊读段数量，且 $\\sum_{g=1}^G a_g = M$。那么，估计的翻译效率由下式给出：\n$$ \\widehat{\\theta}_g = \\frac{u_g + a_g}{m_g} $$\n我们现在将为三种指定的方案分别推导分配向量 $\\mathbf{a} = (a_1, a_2, \\ldots, a_G)$，然后使用均方误差（MSE）与基准值 $\\boldsymbol{\\theta}^{\\ast}$ 进行比较，以评估其性能：\n$$ \\text{MSE} = \\frac{1}{G} \\sum_{g=1}^{G} \\left(\\widehat{\\theta}_g - \\theta^{\\ast}_g \\right)^2 $$\n\n方案 1：均匀分配\n该方案是最朴素的方法，它将模糊读段在旁系同源基因群组的所有基因中平均分配，而不考虑任何其他信息。对于一个大小为 $G$ 的群组，每个基因 $g$ 的分配量为：\n$$ a_g = \\frac{M}{G} $$\n\n方案 2：按 mRNA 比例分配\n该方案假设一个模糊读段源自某个基因的可能性与该基因的 mRNA 丰度成正比。这是一种比均匀分配方案更具信息量的启发式方法。分配给基因 $g$ 的读段比例是其 mRNA 丰度与群组中总 mRNA 丰度的比率。\n$$ a_g = M \\cdot \\frac{m_g}{\\sum_{i=1}^G m_i} $$\n\n方案 3：迭代最大似然分配\n该方案源自一个生成统计模型。我们假设基因 $g$ 的总 RPF 计数遵循泊松分布，其均值（和方差）为 $\\lambda_g = m_g \\theta_g$。目标是找到使观测数据（包括唯一计数 $\\mathbf{u}$ 和模糊计数 $M$）的似然最大化的 $\\theta_g$ 值。这是一个经典的缺失数据问题，可以用期望最大化（EM）算法解决。\n\n该算法按以下步骤进行：\n1.  **初始化**：在迭代 $t=0$ 时，我们需要一个翻译效率的初始估计值 $\\boldsymbol{\\theta}^{(0)}$。问题指定了一种初始化方法，该方法将唯一读段信息与基线项 $\\lambda$ 相结合，以避免对没有唯一读段的基因产生零估计。\n    基线是根据唯一读段计算的全局平均 TE：\n    $$ \\lambda = \\frac{\\sum_{i=1}^G u_i}{\\sum_{i=1}^G m_i} $$\n    基因 $g$ 的初始 TE 为：\n    $$ \\theta_g^{(0)} = \\frac{u_g}{m_g} + \\lambda $$\n2.  **迭代**：该算法在 E 步（期望步）和 M 步（最大化步）之间迭代。\n    -   **E 步（期望步）**：在迭代 $t$ 时，给定当前的 TE 估计值 $\\boldsymbol{\\theta}^{(t)}$，我们计算 $M$ 个模糊读段的期望分配。一个模糊读段属于基因 $g$ 的概率（或责任）与来自该基因的预期 RPF 数量成正比，即 $m_g \\theta_g^{(t)}$。因此，基因 $g$ 的责任为：\n        $$ r_g^{(t)} = \\frac{m_g \\theta_g^{(t)}}{\\sum_{i=1}^G m_i \\theta_i^{(t)}} $$\n        分配给基因 $g$ 的模糊读段的期望数量，记为 $a_g^{(t)}$，则为：\n        $$ a_g^{(t)} = M \\cdot r_g^{(t)} $$\n    -   **M 步（最大化步）**：使用期望分配 $a_g^{(t)}$，我们更新每个基因的 TE 估计以获得 $\\boldsymbol{\\theta}^{(t+1)}$。更新后基因 $g$ 的总 RPF 计数为 $u_g + a_g^{(t)}$。最大化泊松似然的新的 TE 估计值为：\n        $$ \\theta_g^{(t+1)} = \\frac{u_g + a_g^{(t)}}{m_g} $$\n3.  **终止**：迭代继续，直到连续迭代之间任何 $\\theta_g$ 的最大绝对变化量低于 $10^{-10}$ 的容差，或达到 $10,000$ 次迭代的最大限制。\n\n收敛后，最终分配 $\\mathbf{a}$ 取自最后一次迭代的结果，并计算最终的 TE 估计值 $\\widehat{\\boldsymbol{\\theta}}$ 和由此产生的 MSE。\n\n该实现将把这三种不同的方法应用于所提供的四个测试案例中的每一个，计算每种案例和方案组合的 MSE。", "answer": "[0.000000,0.000003,0.000000,0.000450,0.000162,0.000051,0.000289,0.000204,0.000014,0.000306,0.000189,0.000044]", "id": "2963228"}, {"introduction": "核糖体图谱分析的最终目标之一是揭示不同生物学条件下翻译水平的动态变化。然而，一个常见的混淆因素是全局翻译起始速率的系统性变化，它可能掩盖或错误地放大基因特异性的调控。本练习将引导您从翻译动力学的第一性原理出发，推导出一个校正方案来分离这些全局效应，并将其应用于具体数据集，从而确保对翻译调控的生物学结论是准确可靠的 [@problem_id:2963235]。", "problem": "核糖体分析中的一个核心任务是，根据核糖体保护片段（RPF）的计数和通过RNA测序（RNA-seq）测量的信使核糖核酸（mRNA）丰度，来推断翻译在不同条件下的变化。考虑两种条件，记为 $A$ 和 $B$。假设翻译处于稳态，转录本上的核糖体密度与起始速率和编码序列上的平均核糖体停留时间成正比，并假设延伸动力学和编码序列长度在条件 $A$ 和 $B$ 之间保持不变。在这些假设下，一个广泛使用的单转录本翻译活性估计量将其等同于RPF丰度与mRNA丰度的比值。从这些基本原理（当延伸不变时，核糖体密度与起始速率和mRNA丰度的乘积成正比）出发，推导条件 $B$ 相对于 $A$ 的起始速率发生全局性倍数变化时，如何体现在这种基于比值的估计量中，并因此可能混淆基因特异性翻译的推断。然后，利用一组在条件 $A$ 和 $B$ 之间基因特异性翻译保持不变的管家基因，提出一个有原则的归一化方案，以校正这种全局性缩放。你的方案应该定义一个条件特异性的缩放因子和一个校正后的翻译估计量。\n\n最后，将你的归一化方案应用于以下数据集。下面每个基因的数量都是经过单细胞校准的丰度（因此跨条件比较是有意义的）。对于每个基因，给出了其在两种条件下的mRNA丰度和RPF丰度：\n- 基因 H1：mRNA $A = 100$，mRNA $B = 100$；RPF $A = 400$，RPF $B = 720$。\n- 基因 H2：mRNA $A = 200$，mRNA $B = 200$；RPF $A = 400$，RPF $B = 720$。\n- 基因 H3：mRNA $A = 150$，mRNA $B = 150$；RPF $A = 450$，RPF $B = 810$。\n- 基因 H4：mRNA $A = 80$，mRNA $B = 80$；RPF $A = 400$，RPF $B = 720$。\n- 基因 X：mRNA $A = 120$，mRNA $B = 120$；RPF $A = 300$，RPF $B = 810$。\n\n将H1–H4视为管家基因，其基因特异性翻译在 $A$ 和 $B$ 之间保持不变。使用你推导的归一化方案，计算基因X在条件 $B$ 下的校正后翻译估计量。将你的最终答案表示为单个无量纲值，并四舍五入到四位有效数字。", "solution": "该问题要求推导核糖体分析数据的归一化方案，并将其应用于所提供的数据集。在尝试任何解决方案之前，必须先对问题陈述进行验证。\n\n**问题验证**\n\n步骤1：提取已知信息。\n- 条件：条件 $A$ 和条件 $B$。\n- 模型假设：\n    1. 稳态翻译。\n    2. 转录本上的核糖体密度与起始速率和平均核糖体停留时间成正比。\n    3. 延伸动力学和编码序列长度在条件 $A$ 和 $B$ 之间保持不变。\n- 定义：\n    1. 单转录本翻译活性估计量是核糖体保护片段（RPF）丰度与信使RNA（mRNA）丰度的比值。\n    2. 管家基因（H1, H2, H3, H4）在不同条件间的基因特异性翻译保持不变。\n- 任务：\n    1. 推导起始速率的全局性倍数变化如何反映在基于比值的估计量中。\n    2. 利用管家基因，提出一个归一化方案来校正这种全局性变化。\n    3. 应用该方案计算基因X在条件 $B$ 中的校正后翻译估计量。\n- 数据（经过单细胞校准的丰度）：\n    - 基因 H1：mRNA $A = 100$，mRNA $B = 100$；RPF $A = 400$，RPF $B = 720$。\n    - 基因 H2：mRNA $A = 200$，mRNA $B = 200$；RPF $A = 400$，RPF $B = 720$。\n    - 基因 H3：mRNA $A = 150$，mRNA $B = 150$；RPF $A = 450$，RPF $B = 810$。\n    - 基因 H4：mRNA $A = 80$，mRNA $B = 80$；RPF $A = 400$，RPF $B = 720$。\n    - 基因 X：mRNA $A = 120$，mRNA $B = 120$；RPF $A = 300$，RPF $B = 810$。\n- 最终答案要求：单个无量纲值，四舍五入到四位有效数字。\n\n步骤2：使用提取的已知信息进行验证。\n- **科学依据**：该问题基于分子生物学的既定原则和基因表达的定量模型（核糖体分析，翻译动力学）。这些是系统生物学和生物信息学中的标准概念。\n- **问题适定性**：该问题结构清晰，包含明确的假设、定义和具体目标。所提供的数据足以执行所需的计算。\n- **客观性**：问题以精确、技术性的语言陈述，没有主观性或模糊性。\n\n步骤3：结论和行动。\n该问题在科学上是合理的、自洽的且适定的。因此，判定其为**有效**问题。将推导解答。\n\n**归一化方案的推导**\n\n设索引 $g$ 表示一个特定基因。我们已知以下量：\n- $P_g$：基因 $g$ 的RPF丰度。\n- $M_g$：基因 $g$ 的mRNA丰度。\n- $I_g$：基因 $g$ 的翻译起始速率。\n- $\\tau_g$：基因 $g$ 的平均核糖体停留时间（与延伸相关）。\n- $L_g$：基因 $g$ 的编码序列长度。\n\n核糖体保护片段的总数 $P_g$ 与翻译基因 $g$ 的mRNA的核糖体总数成正比。这可以表示为mRNA转录本数量（$M_g$）与每个转录本上平均核糖体数量的乘积。后者是核糖体密度（$R_g$）与翻译区域长度（$L_g$）的乘积。\n$$P_g \\propto M_g \\cdot R_g \\cdot L_g$$\n问题陈述，核糖体密度与起始速率和平均停留时间成正比：\n$$R_g \\propto I_g \\cdot \\tau_g$$\n结合这些比例关系可得：\n$$P_g \\propto M_g \\cdot I_g \\cdot \\tau_g \\cdot L_g$$\n我们可以引入一个基因特异性的比例常数 $c_g$ 来将其形式化：\n$$P_g = c_g \\cdot M_g \\cdot I_g \\cdot \\tau_g \\cdot L_g$$\n问题将单转录本翻译活性估计量（我们称之为 $T_g$）定义为RPF丰度与mRNA丰度的比值：\n$$T_g = \\frac{P_g}{M_g} = c_g \\cdot I_g \\cdot \\tau_g \\cdot L_g$$\n让我们用上标 $A$ 和 $B$ 来表示这两种条件。\n$$T_g^A = \\frac{P_g^A}{M_g^A} \\quad \\text{and} \\quad T_g^B = \\frac{P_g^B}{M_g^B}$$\n问题假设延伸动力学（$\\tau_g$）和编码序列长度（$L_g$）在不同条件间保持不变。比例常数 $c_g$ 也是一个内在属性。因此，对于基因 $g$ 而言，$C_g = c_g \\cdot \\tau_g \\cdot L_g$ 这一项在两种条件下都是一个常数。这可以导出：\n$$T_g^A = C_g \\cdot I_g^A$$\n$$T_g^B = C_g \\cdot I_g^B$$\n对于基因 $g$，这些估计量的比值为：\n$$\\frac{T_g^B}{T_g^A} = \\frac{C_g \\cdot I_g^B}{C_g \\cdot I_g^A} = \\frac{I_g^B}{I_g^A}$$\n该比值直接衡量了翻译起始速率的倍数变化。\n\n条件 $B$ 中起始速率的全局性倍数变化可以通过将起始速率 $I_g^B$ 表示为一个全局性系统因子 $S$ 和一个基因特异性调控因子 $\\lambda_g$ 的乘积来建模：\n$$I_g^B = S \\cdot \\lambda_g \\cdot I_g^A$$\n将此代入估计量的比值中，可以展示出混淆效应：\n$$\\frac{T_g^B}{T_g^A} = S \\cdot \\lambda_g$$\n观察到的翻译估计量的倍数变化受到了全局因子 $S$ 的污染，从而妨碍了对真实基因特异性变化 $\\lambda_g$ 的直接推断。\n\n为了校正这一点，我们使用管家基因（用 $h$ 索引），这些基因被假设在翻译上没有基因特异性变化，即 $\\lambda_h = 1$。对于这样的基因：\n$$\\frac{T_h^B}{T_h^A} = S \\cdot 1 = S$$\n这提供了一种估计 $S$ 的方法。一个稳健的估计值 $\\hat{S}$ 可以通过对所有可用的管家基因的这一比值取平均来获得。\n\n由此产生的归一化方案如下：\n1.  **条件特异性缩放因子**：条件 $B$ 相对于参考条件 $A$ 的因子是 $S$。我们使用管家基因集 $H$ 将其估计为 $\\hat{S}$：\n    $$\\hat{S} = \\underset{h \\in H}{\\text{mean}}\\left( \\frac{T_h^B}{T_h^A} \\right) = \\underset{h \\in H}{\\text{mean}}\\left( \\frac{P_h^B / M_h^B}{P_h^A / M_h^A} \\right)$$\n2.  **校正后翻译估计量**：条件 $B$ 中的估计量 $T_g^B$ 被系统性地按 $S$ 缩放。为了将其置于与条件 $A$ 相同的尺度上，我们通过除以 $\\hat{S}$ 来进行归一化。校正后的估计量 $T'^{B}_g$ 为：\n    $$T'^{B}_g = \\frac{T_g^B}{\\hat{S}} = \\frac{P_g^B / M_g^B}{\\hat{S}}$$\n\n**应用于所给数据**\n\n首先，我们根据管家基因H1–H4计算缩放因子 $\\hat{S}$。\n对于基因H1：\n$T_{H1}^A = \\frac{P_{H1}^A}{M_{H1}^A} = \\frac{400}{100} = 4.0$\n$T_{H1}^B = \\frac{P_{H1}^B}{M_{H1}^B} = \\frac{720}{100} = 7.2$\n比值：$\\frac{T_{H1}^B}{T_{H1}^A} = \\frac{7.2}{4.0} = 1.8$。\n\n对于基因H2：\n$T_{H2}^A = \\frac{P_{H2}^A}{M_{H2}^A} = \\frac{400}{200} = 2.0$\n$T_{H2}^B = \\frac{P_{H2}^B}{M_{H2}^B} = \\frac{720}{200} = 3.6$\n比值：$\\frac{T_{H2}^B}{T_{H2}^A} = \\frac{3.6}{2.0} = 1.8$。\n\n对于基因H3：\n$T_{H3}^A = \\frac{P_{H3}^A}{M_{H3}^A} = \\frac{450}{150} = 3.0$\n$T_{H3}^B = \\frac{P_{H3}^B}{M_{H3}^B} = \\frac{810}{150} = 5.4$\n比值：$\\frac{T_{H3}^B}{T_{H3}^A} = \\frac{5.4}{3.0} = 1.8$。\n\n对于基因H4：\n$T_{H4}^A = \\frac{P_{H4}^A}{M_{H4}^A} = \\frac{400}{80} = 5.0$\n$T_{H4}^B = \\frac{P_{H4}^B}{M_{H4}^B} = \\frac{720}{80} = 9.0$\n比值：$\\frac{T_{H4}^B}{T_{H4}^A} = \\frac{9.0}{5.0} = 1.8$。\n\n所有管家基因都得出相同的比值。因此，平均值就是这个值。\n$$\\hat{S} = 1.8$$\n接下来，我们计算基因X在条件 $B$ 中的校正后翻译估计量 $T'^{B}_X$。首先，我们计算未校正的估计量 $T_X^B$：\n$$T_X^B = \\frac{P_X^B}{M_X^B} = \\frac{810}{120} = 6.75$$\n现在，我们应用归一化：\n$$T'^{B}_X = \\frac{T_X^B}{\\hat{S}} = \\frac{6.75}{1.8} = 3.75$$\n最终答案必须保留四位有效数字。\n$$3.750$$", "answer": "$$\\boxed{3.750}$$", "id": "2963235"}]}