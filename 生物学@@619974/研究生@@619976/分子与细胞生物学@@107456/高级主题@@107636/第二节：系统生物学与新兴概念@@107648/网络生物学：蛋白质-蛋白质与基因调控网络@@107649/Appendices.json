{"hands_on_practices": [{"introduction": "网络生物学的核心在于理解分子间的相互作用。此实践从最基本的层面入手：转录因子与DNA启动子位点之间的结合。通过运用质量作用定律，本练习将引导你推导并计算平衡解离常数（$K_d$）和启动子占据率，这两个参数是量化任何分子相互作用强度的基石。这项基础练习对于掌握生物分子相互作用的定量描述至关重要，为你后续分析更复杂的调控网络奠定坚实的数学基础 [@problem_id:2956839]。", "problem": "在一个基因调控网络（GRN）中，一个转录因子（TF）与启动子位点结合以调控转录。考虑一个单一的TF结合位点，其双分子可逆结合遵循质量作用定律，反应为 $P + L \\rightleftharpoons PL$。其中，$P$ 代表未结合的启动子，$L$ 代表游离的TF，而 $PL$ 代表TF-启动子复合物。微观结合速率常数 $k_{\\text{on}}=10^{6}\\,\\text{M}^{-1}\\text{s}^{-1}$，微观解离速率常数 $k_{\\text{off}}=10^{-2}\\,\\text{s}^{-1}$。假设系统处于均匀混合状态，配体消耗可忽略不计（因此游离配体浓度等于总TF浓度），且系统处于热力学平衡状态。仅从质量作用定律和平衡解离常数的定义出发，首先推导平衡解离常数 $K_{d}$ 关于 $k_{\\text{on}}$ 和 $k_{\\text{off}}$ 的表达式，然后推导平衡启动子占有率（结合分数）$\\theta$ 作为游离TF浓度 $[L]$ 和 $K_{d}$ 的函数。最后，计算当 $[L]=10\\,\\text{nM}$ 时 $K_{d}$ 和 $\\theta$ 的值。将 $K_{d}$ 以摩尔单位表示，$\\theta$ 以无量纲小数表示。将两个报告值均四舍五入至三位有效数字。只提供您的最终数值结果。", "solution": "对问题陈述进行验证。已知条件为：双分子可逆反应 $P + L \\rightleftharpoons PL$；结合速率常数 $k_{\\text{on}}=10^{6}\\,\\text{M}^{-1}\\text{s}^{-1}$；解离速率常数 $k_{\\text{off}}=10^{-2}\\,\\text{s}^{-1}$；系统处于热力学平衡状态；配体消耗可忽略不计。问题要求推导平衡解离常数 $K_{d}$ 和启动子占有率 $\\theta$，并随后在游离转录因子浓度为 $[L]=10\\,\\text{nM}$ 时计算它们的数值。该问题科学上基于质量作用定律，提法恰当、客观，并包含得出唯一解所需的所有必要信息。因此，该问题被认定为有效。我们开始进行推导和计算。\n\n首先，我们推导平衡解离常数 $K_{d}$ 的表达式。反应式为 $P + L \\rightleftharpoons PL$。根据质量作用定律，正向结合反应的速率 $v_{\\text{f}}$ 与反应物的浓度成正比：\n$$\nv_{\\text{f}} = k_{\\text{on}} [P] [L]\n$$\n逆向解离反应的速率 $v_{\\text{r}}$ 与生成物的浓度成正比：\n$$\nv_{\\text{r}} = k_{\\text{off}} [PL]\n$$\n在热力学平衡时，反应的净速率为零，这意味着正向速率与逆向速率相等：$v_{\\text{f}} = v_{\\text{r}}$。\n$$\nk_{\\text{on}} [P] [L] = k_{\\text{off}} [PL]\n$$\n平衡解离常数 $K_{d}$ 定义为平衡时解离物质的浓度与复合物浓度的比值：\n$$\nK_{d} = \\frac{[P][L]}{[PL]}\n$$\n通过重排平衡时的速率相等式，我们得到：\n$$\n\\frac{[P][L]}{[PL]} = \\frac{k_{\\text{off}}}{k_{\\text{on}}}\n$$\n因此，$K_{d}$ 关于微观速率常数的表达式为：\n$$\nK_{d} = \\frac{k_{\\text{off}}}{k_{\\text{on}}}\n$$\n接着，我们推导平衡启动子占有率 $\\theta$ 的表达式。占有率定义为被配体（转录因子）结合的启动子位点占总启动子位点的分数。\n$$\n\\theta = \\frac{\\text{已结合启动子的浓度}}{\\text{启动子总浓度}} = \\frac{[PL]}{[P]_{\\text{total}}}\n$$\n启动子的总浓度 $[P]_{\\text{total}}$ 是未结合（游离）启动子浓度 $[P]$ 和已结合启动子浓度 $[PL]$ 的总和。\n$$\n[P]_{\\text{total}} = [P] + [PL]\n$$\n将此代入 $\\theta$ 的表达式中：\n$$\n\\theta = \\frac{[PL]}{[P] + [PL]}\n$$\n根据 $K_{d}$ 的定义，我们可以用 $[PL]$、$[L]$ 和 $K_{d}$ 来表示游离启动子的浓度 $[P]$：\n$$\n[P] = K_{d} \\frac{[PL]}{[L]}\n$$\n将这个 $[P]$ 的表达式代入 $\\theta$ 的方程中：\n$$\n\\theta = \\frac{[PL]}{K_{d} \\frac{[PL]}{[L]} + [PL]}\n$$\n在 $[PL] > 0$ 的条件下，项 $[PL]$ 是分数中所有项的公因子，可以消去：\n$$\n\\theta = \\frac{1}{\\frac{K_{d}}{[L]} + 1}\n$$\n分子和分母同乘以 $[L]$，我们得到结合等温线的标准形式，通常称为非协同结合的 Langmuir-Hill 方程：\n$$\n\\theta = \\frac{[L]}{K_{d} + [L]}\n$$\n现在，我们进行数值计算。\n首先，我们使用给定的速率常数计算 $K_{d}$ 的值：\n$$\nK_{d} = \\frac{k_{\\text{off}}}{k_{\\text{on}}} = \\frac{10^{-2}\\,\\text{s}^{-1}}{10^{6}\\,\\text{M}^{-1}\\text{s}^{-1}} = 10^{-8}\\,\\text{M}\n$$\n问题要求将此值四舍五入至三位有效数字，所以 $K_{d} = 1.00 \\times 10^{-8}\\,\\text{M}$。\n\n接下来，我们计算在游离配体浓度 $[L] = 10\\,\\text{nM}$ 时的占有率 $\\theta$。我们必须首先转换 $[L]$ 的单位，使其与以摩尔浓度 (M) 表示的 $K_{d}$ 一致。\n$$\n[L] = 10\\,\\text{nM} = 10 \\times 10^{-9}\\,\\text{M} = 10^{-8}\\,\\text{M}\n$$\n现在我们将 $[L]$ 和 $K_{d}$ 的数值代入推导出的 $\\theta$ 表达式中：\n$$\n\\theta = \\frac{[L]}{K_{d} + [L]} = \\frac{10^{-8}\\,\\text{M}}{1.00 \\times 10^{-8}\\,\\text{M} + 10^{-8}\\,\\text{M}} = \\frac{10^{-8}\\,\\text{M}}{2.00 \\times 10^{-8}\\,\\text{M}} = \\frac{1}{2} = 0.5\n$$\n问题要求将此值表示为四舍五入至三位有效数字的无量纲小数。因此，$\\theta = 0.500$。\n问题要求只提供最终的数值结果，即 $K_{d} = 1.00 \\times 10^{-8}\\,\\text{M}$ 和 $\\theta = 0.500$。", "answer": "$$\\boxed{\\begin{pmatrix} 1.00 \\times 10^{-8} & 0.500 \\end{pmatrix}}$$", "id": "2956839"}, {"introduction": "单个的分子互作如何组合起来实现复杂的细胞功能？网络基序（network motifs）是解答此问题的关键。本练习聚焦于一种普遍存在的网络基序——相干前馈环路（coherent feed-forward loop），并要求你通过构建常微分方程（ODE）模型来揭示其动态功能。你将通过模拟发现，这种特定的网络结构如何使其能够充当“持久性检测器”，有效地区分短暂的噪声信号与持续的生物学信号 [@problem_id:2956867]。这项综合性实践连接了网络结构与动态功能，是系统生物学建模思维的核心体现。", "problem": "为一个基因调控网络中的相干1型前馈环（coherent type-1 feedforward loop）构建一个动态模型，并用它来算法化地测试其对输入阶跃和短脉冲的持久性检测（persistence detection）响应。该网络由三个节点组成：一个上游转录因子 $X$、一个由 $X$ 激活的中间转录因子 $Y$，以及一个由 $X$ 和 $Y$ 共同激活的目标基因产物 $Z$。输入 $u(t)$ 是一个控制 $X$ 合成的外部信号。所需的模型和分析必须严格地从以下基本原理推导和实现：\n\n- 分子生物学中心法则和基因调控：转录因子通过启动子占有率来调控目标基因的合成速率，基因产物则以与其浓度成正比的方式降解。\n- 质量作用降解：每个物种 $S \\in \\{X,Y,Z\\}$ 的衰变项与其浓度成正比，衰变常数为 $\\gamma_S$。\n- 单激活剂的希尔型激活：启动子占有率是激活剂浓度的饱和函数，由希尔系数 $n$ 和半饱和常数 $K$ 参数化。\n- 对于以“与”逻辑（AND logic）整合 $X$ 和 $Y$ 的 $Z$ 启动子，假设 $X$ 和 $Y$ 独立结合到启动子上不同的调控位点，因此启动子活性与独立性假设下的联合占有率成正比。\n\n根据这些原理，推导出一个由 $u(t)$ 驱动的关于 $X$、$Y$ 和 $Z$ 的常微分方程（ODE）系统，初始条件为 $X(0)=0$、 $Y(0)=0$ 和 $Z(0)=0$。所有浓度单位均为任意一致单位，时间单位为任意时间单位。对于每个参数集，您必须实现两种输入激励：\n\n- 持续阶跃：对于所有 $t \\ge 0$，$u(t)=u_{\\mathrm{amp}}$。\n- 有限脉冲：对于 $0 \\le t < T_{\\mathrm{pulse}}$，$u(t)=u_{\\mathrm{amp}}$；对于 $t \\ge T_{\\mathrm{pulse}}$，$u(t)=0$。\n\n对于每个参数集，在有限时间域 $[0, T_{\\mathrm{end}}]$ 上对常微分方程进行模拟。将 $Z$ 的“阈值穿越”定义为存在某个 $t \\in [0, T_{\\mathrm{end}}]$ 使得 $Z(t) \\ge z_{\\mathrm{thresh}}$。当且仅当持续阶跃导致阈值穿越而有限脉冲不导致阈值穿越时，定义“持久性检测”为真。对于下方的每个测试用例，您的程序必须输出一个布尔值，以指示持久性检测是否成立。\n\n测试套件（每行为一个测试用例；请完全按照规定使用给定的符号和值）：\n\n- 情况 $1$（理想路径，慢速 $Y$ 和严格的 $Z$ 门控）：$ \\alpha_X=5.0$, $ \\gamma_X=1.0$, $ \\alpha_Y=0.6$, $ \\gamma_Y=0.1$, $ K_{XY}=3.0$, $ n_{XY}=2.0$, $ \\alpha_Z=1.0$, $ \\gamma_Z=0.5$, $ K_{XZ}=3.0$, $ n_{XZ}=2.0$, $ K_{YZ}=4.0$, $ n_{YZ}=2.0$, $ u_{\\mathrm{amp}}=1.0$, $ T_{\\mathrm{pulse}}=10.0$, $ T_{\\mathrm{end}}=120.0$, $ z_{\\mathrm{thresh}}=0.6$。\n- 情况 $2$（边缘情况，快速且强的 $Y$ 使得短脉冲也能引发响应）：$ \\alpha_X=5.0$, $ \\gamma_X=1.0$, $ \\alpha_Y=3.0$, $ \\gamma_Y=0.5$, $ K_{XY}=1.0$, $ n_{XY}=2.0$, $ \\alpha_Z=1.0$, $ \\gamma_Z=0.5$, $ K_{XZ}=1.0$, $ n_{XZ}=2.0$, $ K_{YZ}=1.0$, $ n_{YZ}=2.0$, $ u_{\\mathrm{amp}}=1.0$, $ T_{\\mathrm{pulse}}=10.0$, $ T_{\\mathrm{end}}=60.0$, $ z_{\\mathrm{thresh}}=0.6$。\n- 情况 $3$（低协同性，更严格的 $Z$ 门控仍能实现持久性检测）：$ \\alpha_X=5.0$, $ \\gamma_X=1.0$, $ \\alpha_Y=0.4$, $ \\gamma_Y=0.1$, $ K_{XY}=3.0$, $ n_{XY}=1.0$, $ \\alpha_Z=1.0$, $ \\gamma_Z=0.5$, $ K_{XZ}=3.0$, $ n_{XZ}=1.0$, $ K_{YZ}=3.0$, $ n_{YZ}=1.0$, $ u_{\\mathrm{amp}}=1.0$, $ T_{\\mathrm{pulse}}=6.0$, $ T_{\\mathrm{end}}=120.0$, $ z_{\\mathrm{thresh}}=0.5$。\n- 情况 $4$（弱的 $Z$ 合成导致任何情况下都无法穿越阈值）：$ \\alpha_X=5.0$, $ \\gamma_X=1.0$, $ \\alpha_Y=0.6$, $ \\gamma_Y=0.1$, $ K_{XY}=3.0$, $ n_{XY}=2.0$, $ \\alpha_Z=0.2$, $ \\gamma_Z=0.5$, $ K_{XZ}=3.0$, $ n_{XZ}=2.0$, $ K_{YZ}=4.0$, $ n_{YZ}=2.0$, $ u_{\\mathrm{amp}}=1.0$, $ T_{\\mathrm{pulse}}=10.0$, $ T_{\\mathrm{end}}=120.0$, $ z_{\\mathrm{thresh}}=0.6$。\n\n你的程序必须实现推导出的ODE模型，在每种情况下对两种激励进行数值积分，并确定每种情况下的布尔值“持久性检测”结果。你的程序应生成单行输出，其中包含一个方括号括起来的、以逗号分隔的结果列表（例如，“[result1,result2,result3,result4]”），其中每个结果是对应于上述情况（按顺序）的布尔值。", "solution": "我们基于基因调控的核心原理，使用常微分方程构建并分析一个相干1型前馈环。该网络的逻辑如下：物种 $X$ 的合成与外部输入 $u(t)$ 成正比，并以一级动力学方式降解；$Y$ 由受 $X$ 激活的启动子合成，并以一级动力学方式降解；$Z$ 由需要 $X$ 和 $Y$ 共同激活（逻辑与）的启动子合成，同样以一级动力学方式降解。\n\n使用的原理：\n\n- 分子生物学中心法则和标准基因调控理论意味着，基因产物的合成速率可以建模为启动子活性（占有率）乘以一个最大合成速率。\n- 质量作用降解为每个物种 $S \\in \\{X,Y,Z\\}$ 产生一个线性衰变项 $-\\gamma_S S$，其衰变常数为 $\\gamma_S$。\n- 对于浓度为 $A$ 的激活剂，结合到一个具有 $n$ 个相同有效结合位点和半饱和常数为 $K$ 的启动子上，其启动子占有率遵循希尔函数。这是一个经过充分检验的唯象模型，提供了一个随 $A$ 增加而平滑饱和的激活过程。\n- 对于两个作为“与”门的独立激活剂 $X$ 和 $Y$，它们独立结合到不同位点，导致两个位点都被占据的联合概率是它们各自占有率的乘积。\n\n常微分方程模型的推导：\n\n- 物种 $X$：其合成与外部输入 $u(t)$ 成正比，最大速率为 $\\alpha_X$，并以速率 $\\gamma_X X$ 降解。因此\n$$\n\\frac{dX}{dt} = \\alpha_X\\, u(t) - \\gamma_X X.\n$$\n\n- 物种 $Y$：其合成速率通过希尔型激活依赖于 $X$，希尔系数为 $n_{XY}$，半饱和常数为 $K_{XY}$，并由最大速率 $\\alpha_Y$ 进行缩放。其降解项为 $-\\gamma_Y Y$。因此\n$$\n\\frac{dY}{dt} = \\alpha_Y \\cdot \\frac{X^{n_{XY}}}{K_{XY}^{n_{XY}} + X^{n_{XY}}} - \\gamma_Y Y.\n$$\n\n- 物种 $Z$：其启动子需要 $X$ 和 $Y$。在独立结合和“与”逻辑下，其活性是由于 $X$ 的占有率和由于 $Y$ 的占有率的乘积，两者都由一个希尔函数表示，参数分别为 $(n_{XZ}, K_{XZ})$ 和 $(n_{YZ}, K_{YZ})$。设最大速率为 $\\alpha_Z$，降解项为 $-\\gamma_Z Z$，我们得到\n$$\n\\frac{dZ}{dt} = \\alpha_Z \\cdot \\left( \\frac{X^{n_{XZ}}}{K_{XZ}^{n_{XZ}} + X^{n_{XZ}}} \\right) \\cdot \\left( \\frac{Y^{n_{YZ}}}{K_{YZ}^{n_{YZ}} + Y^{n_{YZ}}} \\right) - \\gamma_Z Z.\n$$\n\n初始条件为 $X(0)=0$, $Y(0)=0$, $Z(0)=0$。\n\n激励的定义：\n\n- 持续阶跃：对于所有 $t \\ge 0$，$u(t)=u_{\\mathrm{amp}}$。\n- 有限脉冲：对于 $0 \\le t < T_{\\mathrm{pulse}}$，$u(t)=u_{\\mathrm{amp}}$；对于 $t \\ge T_{\\mathrm{pulse}}$，$u(t)=0$。\n\n算法检测标准：\n\n- 对于每个参数集，对持续阶跃和有限脉冲两种情况，在 $[0, T_{\\mathrm{end}}]$ 上对常微分方程系统进行积分。\n- 对于每次运行，计算 $\\max_{t \\in [0, T_{\\mathrm{end}}]} Z(t)$。\n- 如果 $\\max Z(t) \\ge z_{\\mathrm{thresh}}$，则定义为阈值穿越。\n- 如果持续阶跃导致阈值穿越而有限脉冲没有，则定义持久性检测为真。\n\n在具有“与”逻辑整合的相干1型前馈环中实现持久性检测的原理：\n\n- 直接激活通路 $X \\rightarrow Z$ 提供了一个快速输入，而间接通路 $X \\rightarrow Y \\rightarrow Z$ 引入了延迟，因为 $Y$ 必须累积到一定程度才能完全激活 $Z$ 的启动子。\n- 对于一个短脉冲，$X$ 迅速上升和下降，但 $Y$ 没有足够的时间来累积；因此“与”门基本保持非激活状态，$Z$ 保持在阈值以下。\n- 对于一个持续输入，$Y$ 会累积起来，并与 $X$ 一起驱动 $Z$ 超过阈值。这实现了一个持久性检测器，它能拒绝短暂的输入，同时接受较长的输入。\n\n数值实现细节：\n\n- 该常微分方程系统根据参数不同可能具有中等程度的刚性；一个带有自适应步长的鲁棒显式求解器（例如，龙格-库塔法）在给定的时间范围内足够使用。\n- 为了可靠地评估阈值穿越，数值解在 $[0, T_{\\mathrm{end}}]$ 内一个足够精细的时间网格上进行采样，并计算 $Z(t)$ 的最大值。\n- 测试套件包含4种情况：\n  - 情况1使用较慢的 $Y$ 动态和相对严格的 $Z$ 门控，因此只有持续阶跃能穿越阈值。\n  - 情况2使用更快、更强的 $Y$ 激活，使得即使是短脉冲也能产生足够的 $Y$，导致有限脉冲也穿越阈值；持久性检测应为假。\n  - 情况3使用较低的协同性（$n=1$）和更严格的 $Z$ 门控，但仍能实现持久性检测行为。\n  - 情况4使用较弱的 $Z$ 合成，因此即使是持续阶跃也无法发生阈值穿越；持久性检测应为假。\n\n该实现计算每种情况下的布尔结果，并按要求格式打印单行输出：一个方括号括起来的、以逗号分隔的布尔值列表，顺序为 $[ \\text{情况 1}, \\text{情况 2}, \\text{情况 3}, \\text{情况 4} ]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef hill_activation(a, K, n):\n    # Hill activation function a^n / (K^n + a^n)\n    # Ensure non-negativity for numerical robustness\n    a = max(a, 0.0)\n    return (a ** n) / (K ** n + a ** n) if (K > 0) else 1.0\n\ndef and_gate_activity(x, y, Kx, nx, Ky, ny):\n    # Independent binding AND gate: product of two Hill activations\n    return hill_activation(x, Kx, nx) * hill_activation(y, Ky, ny)\n\ndef simulate_case(params, stimulus_type):\n    # Unpack parameters\n    alpha_x = params['alpha_x']\n    gamma_x = params['gamma_x']\n    alpha_y = params['alpha_y']\n    gamma_y = params['gamma_y']\n    K_xy = params['K_xy']\n    n_xy = params['n_xy']\n    alpha_z = params['alpha_z']\n    gamma_z = params['gamma_z']\n    K_xz = params['K_xz']\n    n_xz = params['n_xz']\n    K_yz = params['K_yz']\n    n_yz = params['n_yz']\n    u_amp = params['u_amp']\n    T_pulse = params['T_pulse']\n    T_end = params['T_end']\n\n    # Define input u(t)\n    if stimulus_type == 'step':\n        def u(t):\n            return u_amp\n    elif stimulus_type == 'pulse':\n        def u(t):\n            return u_amp if (t < T_pulse) else 0.0\n    else:\n        raise ValueError(\"Unknown stimulus_type\")\n\n    # ODE system\n    def ode(t, state):\n        X, Y, Z = state\n        dXdt = alpha_x * u(t) - gamma_x * X\n        f_XY = hill_activation(X, K_xy, n_xy)\n        dYdt = alpha_y * f_XY - gamma_y * Y\n        f_AND = and_gate_activity(X, Y, K_xz, n_xz, K_yz, n_yz)\n        dZdt = alpha_z * f_AND - gamma_z * Z\n        return [dXdt, dYdt, dZdt]\n\n    # Initial conditions\n    y0 = [0.0, 0.0, 0.0]\n\n    # Time grid for evaluation\n    dt = 0.05\n    t_eval = np.arange(0.0, T_end + dt, dt)\n\n    # Integrate ODEs\n    sol = solve_ivp(\n        ode,\n        (0.0, T_end),\n        y0,\n        method='RK45',\n        t_eval=t_eval,\n        rtol=1e-7,\n        atol=1e-9\n    )\n\n    # Extract Z over time and compute max\n    Z_traj = sol.y[2]\n    # Numerical safety: clip tiny negatives\n    Z_traj = np.maximum(Z_traj, 0.0)\n    Z_max = float(np.max(Z_traj))\n    return Z_max\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            'alpha_x': 5.0, 'gamma_x': 1.0,\n            'alpha_y': 0.6, 'gamma_y': 0.1, 'K_xy': 3.0, 'n_xy': 2.0,\n            'alpha_z': 1.0, 'gamma_z': 0.5, 'K_xz': 3.0, 'n_xz': 2.0, 'K_yz': 4.0, 'n_yz': 2.0,\n            'u_amp': 1.0, 'T_pulse': 10.0, 'T_end': 120.0, 'z_thresh': 0.6\n        },\n        # Case 2\n        {\n            'alpha_x': 5.0, 'gamma_x': 1.0,\n            'alpha_y': 3.0, 'gamma_y': 0.5, 'K_xy': 1.0, 'n_xy': 2.0,\n            'alpha_z': 1.0, 'gamma_z': 0.5, 'K_xz': 1.0, 'n_xz': 2.0, 'K_yz': 1.0, 'n_yz': 2.0,\n            'u_amp': 1.0, 'T_pulse': 10.0, 'T_end': 60.0, 'z_thresh': 0.6\n        },\n        # Case 3\n        {\n            'alpha_x': 5.0, 'gamma_x': 1.0,\n            'alpha_y': 0.4, 'gamma_y': 0.1, 'K_xy': 3.0, 'n_xy': 1.0,\n            'alpha_z': 1.0, 'gamma_z': 0.5, 'K_xz': 3.0, 'n_xz': 1.0, 'K_yz': 3.0, 'n_yz': 1.0,\n            'u_amp': 1.0, 'T_pulse': 6.0, 'T_end': 120.0, 'z_thresh': 0.5\n        },\n        # Case 4\n        {\n            'alpha_x': 5.0, 'gamma_x': 1.0,\n            'alpha_y': 0.6, 'gamma_y': 0.1, 'K_xy': 3.0, 'n_xy': 2.0,\n            'alpha_z': 0.2, 'gamma_z': 0.5, 'K_xz': 3.0, 'n_xz': 2.0, 'K_yz': 4.0, 'n_yz': 2.0,\n            'u_amp': 1.0, 'T_pulse': 10.0, 'T_end': 120.0, 'z_thresh': 0.6\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        # Simulate sustained step\n        Zmax_step = simulate_case(params, 'step')\n        # Simulate finite pulse\n        Zmax_pulse = simulate_case(params, 'pulse')\n        # Threshold crossing checks\n        z_thresh = params['z_thresh']\n        crossed_step = Zmax_step >= z_thresh\n        crossed_pulse = Zmax_pulse >= z_thresh\n        # Persistence detection: step crosses AND pulse does not\n        result = (crossed_step and (not crossed_pulse))\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2956867"}, {"introduction": "我们研究的蛋白质相互作用（PPI）或基因调控网络，大多是通过高通量实验技术构建的，而这些技术不可避免地会产生错误。本练习将带你直面这一现实挑战，探讨假阳性（false positives）和假阴性（false negatives）如何影响网络拓扑结构的表观测量。通过运用基本的概率论，你将推导出在存在测量误差的情况下，一个节点的“观测度”（observed degree）与其“真实度”（true degree）之间的数学关系 [@problem_id:2956816]。这项练习对于培养批判性思维、理解和量化实验数据的不确定性至关重要，是任何处理真实网络数据的研究者必须具备的技能。", "problem": "在一个蛋白质-蛋白质相互作用（PPI）网络的高通量筛选中，假设其底层的生物网络是一个包含 $N$ 个蛋白质的无向简单图（无多重边，无自环）。对于一个中心蛋白质 $i$，其真实度（即其真实相互作用伙伴的数量）为 $k_{\\text{true}} = 10$。实验观测流程独立地评估所有涉及 $i$ 的 $N-1$ 个可能的配对，并为每个配对生成一个二元的观测相互作用结果。该测量过程的特征是，对于真实的相互作用，其假阴性率 $p_{\\text{fn}} = 0.3$ （即一个真实的边有 $0.3$ 的概率被漏掉），而对于非相互作用的配对，其假阳性率 $p_{\\text{fp}} = 0.1$ （即一个不存在的边有 $0.1$ 的概率被报告为存在的边）。假设所有评估的配对之间以及不同错误类型之间都是独立的，并且每个配对都只被测试一次。\n\n仅使用图中度的基本定义和基础概率（伯努利试验和期望的线性性），推导节点 $i$ 的预期观测度，将其表示为一个关于 $N$ 的闭式解析表达式，给定 $k_{\\text{true}} = 10$、$p_{\\text{fn}} = 0.3$ 和 $p_{\\text{fp}} = 0.1$。请以一个关于 $N$ 的简化表达式给出最终答案，不带单位。不要四舍五入。你可以假设所有量均为无量纲的。\n\n在你的内部推理中（不作为最终数值表达式的一部分），请基于第一性原理进行推导：即度的定义、$i$ 的非邻居数量，以及独立伯努利指示变量之和的期望。", "solution": "问题陈述已经过严格验证，被认为是有效的。它具有科学依据，问题设定良好，客观，并包含足够的信息以得出唯一解。这是一个网络生物学中的标准问题，可以使用概率论的基本原理解答。\n\n设 $k_{\\text{obs}}$ 是表示中心蛋白质 $i$ 的观测度的随机变量。目标是计算这个变量的期望 $E[k_{\\text{obs}}]$。蛋白质 $i$ 可以与网络中其他 $N-1$ 个蛋白质形成潜在的相互作用。我们可以将观测到的网络表示为一组二元结果。对于每一个其他蛋白质 $j$（其中 $j \\neq i$），设 $X_j$ 是一个伯努利指示变量，使得当观测到 $i$ 和 $j$ 之间存在相互作用时，$X_j=1$；否则 $X_j=0$。\n\n蛋白质 $i$ 的观测度是这些指示变量在所有可能伙伴上的总和：\n$$\nk_{\\text{obs}} = \\sum_{j \\neq i} X_j\n$$\n根据期望的线性性，预期的观测度是这些指示变量期望的总和：\n$$\nE[k_{\\text{obs}}] = E\\left[ \\sum_{j \\neq i} X_j \\right] = \\sum_{j \\neq i} E[X_j]\n$$\n对于一个伯努利指示变量 $X_j$，其期望等于它所指示事件的概率，即 $E[X_j] = P(X_j=1)$。因此，我们需要求出观测到蛋白质 $i$ 和蛋白质 $j$ 之间存在相互作用的概率。\n$$\nE[k_{\\text{obs}}] = \\sum_{j \\neq i} P(X_j=1)\n$$\n这 $N-1$ 个潜在伙伴的集合可以被划分为两个不相交的子集：\n$1$. 真实相互作用伙伴的集合 $S_{\\text{true}}$。该集合的大小由真实度给出，即 $|S_{\\text{true}}| = k_{\\text{true}}$。\n$2$. 非真实相互作用伙伴的蛋白质集合 $S_{\\text{non}}$。该集合的大小为 $|S_{\\text{non}}| = (N-1) - k_{\\text{true}}$。\n\n现在我们可以将期望的总和分解到这两个集合上：\n$$\nE[k_{\\text{obs}}] = \\sum_{j \\in S_{\\text{true}}} P(X_j=1) + \\sum_{j \\in S_{\\text{non}}} P(X_j=1)\n$$\n对于任何蛋白质 $j \\in S_{\\text{true}}$，存在真实的相互作用。如果实验没有漏掉这个相互作用，那么它就会被观测到。漏掉一个真实相互作用的概率是假阴性率 $p_{\\text{fn}}$。因此，观测到它（即真阳性）的概率是：\n$$\nP(X_j=1 \\mid j \\in S_{\\text{true}}) = 1 - p_{\\text{fn}}\n$$\n对于任何蛋白质 $j \\in S_{\\text{non}}$，不存在真实的相互作用。只有当实验出错时，才会观测到相互作用。为一个不相互作用的配对错误地报告相互作用的概率是假阳性率 $p_{\\text{fp}}$：\n$$\nP(X_j=1 \\mid j \\in S_{\\text{non}}) = p_{\\text{fp}}\n$$\n由于在每个集合内，所有成员的概率是相同的，我们可以用集合大小与相应概率的乘积来代替求和：\n$$\nE[k_{\\text{obs}}] = |S_{\\text{true}}| \\cdot (1 - p_{\\text{fn}}) + |S_{\\text{non}}| \\cdot p_{\\text{fp}}\n$$\n代入集合的大小：\n$$\nE[k_{\\text{obs}}] = k_{\\text{true}} (1 - p_{\\text{fn}}) + ((N-1) - k_{\\text{true}}) p_{\\text{fp}}\n$$\n这个表达式代表了预期的观测到的真实相互作用数量加上预期的观测到的虚假相互作用数量。\n\n我们已知以下数值：\n- 真实度，$k_{\\text{true}} = 10$\n- 假阴性率，$p_{\\text{fn}} = 0.3$\n- 假阳性率，$p_{\\text{fp}} = 0.1$\n\n将这些数值代入推导出的表达式中：\n$$\nE[k_{\\text{obs}}] = 10 \\cdot (1 - 0.3) + ((N-1) - 10) \\cdot 0.1\n$$\n$$\nE[k_{\\text{obs}}] = 10 \\cdot (0.7) + (N - 11) \\cdot 0.1\n$$\n$$\nE[k_{\\text{obs}}] = 7 + 0.1N - 1.1\n$$\n简化该表达式，得到关于 $N$ 的预期观测度的最终解析形式：\n$$\nE[k_{\\text{obs}}] = 0.1N + 5.9\n$$\n这就是问题所要求的闭式表达式。它完全是根据度的定义以及独立伯努利试验之和的期望值原理推导出来的。", "answer": "$$\\boxed{0.1N + 5.9}$$", "id": "2956816"}]}