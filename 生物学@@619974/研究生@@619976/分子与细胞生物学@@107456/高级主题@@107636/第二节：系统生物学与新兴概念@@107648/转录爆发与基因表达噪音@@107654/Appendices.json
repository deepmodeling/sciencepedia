{"hands_on_practices": [{"introduction": "在单细胞水平上，一个核心问题是区分基因是持续表达（类似于泊松过程）还是以阵发方式表达。本练习提供了一个基于第一性原理的统计方法，用于处理单分子荧光原位杂交（smFISH）等实验产生的计数数据。通过构建一个假设检验来比较样本方差和样本均值，您将学会如何从统计上确定是否需要使用阵发模型来解释观察到的细胞间表达水平的变异性 [@problem_id:2967016]。", "problem": "一个实验室在稳态条件下，对 $n$ 个同基因细胞中一个组成型表达基因的单分子荧光原位杂交（smFISH）计数进行了量化。核心的生物学问题是，一个简单的恒定速率转录模型（每个细胞的计数独立同分布于泊松分布）是否足够，还是需要启动子转换和转录爆发来解释这些数据。从第一性原理出发，恒定速率的泊松模型意味着对于任何细胞中的计数随机变量 $Y$，有 $\\mathbb{E}[Y]=\\operatorname{Var}(Y)$，而两态启动子爆发可以表示为跨时间或细胞状态的泊松过程的混合，产生过离散计数（例如，负二项分布），其中 $\\operatorname{Var}(Y)>\\mathbb{E}[Y]$。基于这些原理，构建一个单边假设检验，以在以下两者之间做出选择：\n- $H_{0}$：独立泊松计数，所有细胞共享一个未知的单一速率。\n- $H_{1}$：与爆发性转录一致的过离散计数。\n\n给你以下以每个细胞mRNA计数的频率表形式表示的smFISH数据集：\n- 对于每个计数 $k \\in \\{0,1,2,3,4,5,6,7,8\\}$，具有该计数的细胞数量为 $n_{k}$，其中\n  - $n_{0}=5$，\n  - $n_{1}=11$，\n  - $n_{2}=3$，\n  - $n_{3}=11$，\n  - $n_{4}=10$，\n  - $n_{5}=5$，\n  - $n_{6}=1$，\n  - $n_{7}=3$，\n  - $n_{8}=1$。\n\n仅使用 $H_{0}$ 下泊松模型的定义属性和大样本渐近性，构建一个比较样本方差与样本均值的检验统计量，并指定其零假设下的参考分布。然后为上述数据集计算该检验统计量的值。将最终答案表示为检验统计量的数值（无单位），并四舍五入到四位有效数字。", "solution": "该问题要求构建并计算一个检验统计量，以在两种竞争的mRNA计数模型之间做出判断：简单的泊松过程与表现出过离散的过程，后者是转录爆发的一个关键特征。该统计检验必须基于泊松分布的基本性质。\n\n设随机变量 $Y$ 表示单个细胞中的mRNA计数。我们得到一个包含 $n$ 个独立同分布观测值的样本，$Y_1, Y_2, \\ldots, Y_n$。假设检验的构建如下：\n\n零假设 $H_{0}$ 假定细胞间的计数服从具有单一未知速率参数 $\\lambda$ 的泊松分布。泊松分布的一个定义性特征是其均值和方差相等。\n$$ H_{0}: Y_i \\sim \\text{i.i.d. Poisson}(\\lambda) \\implies \\mathbb{E}[Y] = \\operatorname{Var}(Y) = \\lambda $$\n备择假设 $H_{1}$ 对应于过离散的情况，即方差严格大于均值。这是爆发性转录的统计特征。\n$$ H_{1}: \\operatorname{Var}(Y) > \\mathbb{E}[Y] $$\n这就构成了一个单边假设检验。\n\n为构建一个合适的检验统计量，我们使用总体均值和方差的样本估计量。总体均值 $\\mathbb{E}[Y]$ 由样本均值 $\\bar{Y}$ 估计：\n$$ \\bar{Y} = \\frac{1}{n} \\sum_{i=1}^{n} Y_i $$\n总体方差 $\\operatorname{Var}(Y)$ 由无偏样本方差 $S^2$ 估计：\n$$ S^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (Y_i - \\bar{Y})^2 $$\n一个合理的检验统计量会比较这两个估计量。用于此目的的标准统计量是Fisher离散指数，我们用 $D$ 表示。它定义为离均差平方和除以样本均值：\n$$ D = \\frac{\\sum_{i=1}^{n} (Y_i - \\bar{Y})^2}{\\bar{Y}} = \\frac{(n-1)S^2}{\\bar{Y}} $$\n根据指定，在零假设 $H_0$ 下并引用大样本渐近性，统计量 $D$ 服从自由度为 $n-1$ 的卡方分布。因此，零假设下的参考分布为：\n$$ D \\sim \\chi^2_{n-1} $$\n若 $D$ 的值显著大于其在 $H_0$ 下的期望值 $n-1$，则提供了拒绝 $H_0$ 并支持 $H_1$ 的证据。\n\n我们现在使用提供的smFISH计数频率表来计算 $D$ 的值：$n_{0}=5$、$n_{1}=11$、$n_{2}=3$、$n_{3}=11$、$n_{4}=10$、$n_{5}=5$、$n_{6}=1$、$n_{7}=3$ 和 $n_{8}=1$。\n\n首先，样本中的细胞总数 $n$ 是各频率的总和：\n$$ n = \\sum_{k=0}^{8} n_k = 5 + 11 + 3 + 11 + 10 + 5 + 1 + 3 + 1 = 50 $$\n接下来，我们计算样本均值 $\\bar{Y}$。这可以通过频率表计算得出：\n$$ \\bar{Y} = \\frac{1}{n} \\sum_{k=0}^{8} k \\cdot n_k $$\n所有观测到的mRNA计数的总和是：\n$$ \\sum_{k=0}^{8} k \\cdot n_k = (0 \\cdot 5) + (1 \\cdot 11) + (2 \\cdot 3) + (3 \\cdot 11) + (4 \\cdot 10) + (5 \\cdot 5) + (6 \\cdot 1) + (7 \\cdot 3) + (8 \\cdot 1) $$\n$$ \\sum_{k=0}^{8} k \\cdot n_k = 0 + 11 + 6 + 33 + 40 + 25 + 6 + 21 + 8 = 150 $$\n因此，样本均值为：\n$$ \\bar{Y} = \\frac{150}{50} = 3 $$\n现在我们必须计算离均差平方和 $\\sum_{i=1}^{n} (Y_i - \\bar{Y})^2$。这是检验统计量 $D$ 的分子。一个计算上高效的公式是 $\\sum(Y_i - \\bar{Y})^2 = (\\sum Y_i^2) - n\\bar{Y}^2$。我们首先从频率表中计算观测值的平方和：\n$$ \\sum_{i=1}^{n} Y_i^2 = \\sum_{k=0}^{8} k^2 \\cdot n_k $$\n$$ \\sum_{k=0}^{8} k^2 n_k = (0^2 \\cdot 5) + (1^2 \\cdot 11) + (2^2 \\cdot 3) + (3^2 \\cdot 11) + (4^2 \\cdot 10) + (5^2 \\cdot 5) + (6^2 \\cdot 1) + (7^2 \\cdot 3) + (8^2 \\cdot 1) $$\n$$ \\sum_{k=0}^{8} k^2 n_k = 0 + 11 + 12 + 99 + 160 + 125 + 36 + 147 + 64 = 654 $$\n使用这个结果，离均差平方和为：\n$$ \\sum_{i=1}^{n} (Y_i - \\bar{Y})^2 = 654 - (50)(3^2) = 654 - 450 = 204 $$\n最后，我们计算检验统计量 $D$ 的值：\n$$ D = \\frac{\\sum_{i=1}^{n} (Y_i - \\bar{Y})^2}{\\bar{Y}} = \\frac{204}{3} = 68 $$\n计算出的检验统计量的值是 $68$。问题要求将此值四舍五入到四位有效数字，即 $68.00$。为进行假设检验，此值将与自由度为 $n-1 = 49$ 的 $\\chi^2$ 分布的临界值进行比较。", "answer": "$$\\boxed{68.00}$$", "id": "2967016"}, {"introduction": "一旦确定基因表达是阵发性的，下一步就是量化其动态特征。本练习将指导您如何从实验测量的两个关键汇总统计量——平均mRNA数量 $\\langle m \\rangle$ 和法诺因子 $F$——来推断转录阵发的两个核心参数：平均阵发大小 $b$ 和阵发频率 $a$。这个过程展示了理论模型如何将宏观可观测值与微观动力学参数直接联系起来 [@problem_id:2967024]。", "problem": "在一个克隆细胞群体中，一个单拷贝基因由于启动子在转录非活性和活性状态之间转换，表现出脉冲式的信使RNA（mRNA）产生。在双态启动子模型的经典爆发极限（从非活性到活性的转换罕见且活性周期短）下，由随机变量 $m$ 表示的稳态 mRNA 拷贝数，可以由一个负二项分布很好地近似。该分布由爆发频率参数 $a$（无量纲，与经 mRNA 降解速率缩放后的启动子激活速率成正比）和平均爆发大小 $b$（无量纲，每次激活产生的 mRNA 的平均数量）参数化。设负二项分布的概率参数为 $p \\in (0,1)$，其与爆发大小的标准映射关系为 $b = \\frac{1-p}{p}$。于是，负二项分布的均值为 $\\langle m \\rangle = a \\frac{1-p}{p}$，方差为 $\\operatorname{Var}(m) = a \\frac{1-p}{p^{2}}$。法诺因子定义为 $F = \\frac{\\operatorname{Var}(m)}{\\langle m \\rangle}$。\n\n现给出该基因的实验测量值：稳态平均 mRNA 数量为 $\\langle m \\rangle = 32$ 分子/细胞，法诺因子为 $F = 5$（无量纲）。在上述负二项近似下，请仅从测得的 $\\langle m \\rangle$ 和 $F$ 推断爆发大小 $b$ 和爆发频率 $a$。将你的最终答案表示为一个由两个无量纲数组成的行向量 $\\big[b,\\;a\\big]$。无需四舍五入。", "solution": "我们从双态启动子模型爆发极限下负二项分布的基本定义和经过充分检验的性质开始。设 $m$ 表示稳态 mRNA 拷贝数。法诺因子定义为\n$$\nF \\equiv \\frac{\\operatorname{Var}(m)}{\\langle m \\rangle}.\n$$\n在由参数 $a$（形状）和 $p$（概率）定义的负二项模型中，其矩为\n$$\n\\langle m \\rangle = a \\frac{1-p}{p}, \\qquad \\operatorname{Var}(m) = a \\frac{1-p}{p^{2}}.\n$$\n定义平均爆发大小为\n$$\nb \\equiv \\frac{1-p}{p}.\n$$\n将此代入均值和方差的表达式中，得到\n$$\n\\langle m \\rangle = a b, \\qquad \\operatorname{Var}(m) = a \\frac{1-p}{p^{2}} = a \\left(\\frac{1-p}{p}\\right)\\left(\\frac{1}{p}\\right) = a b (1+b),\n$$\n因为 $\\frac{1}{p} = 1 + \\frac{1-p}{p} = 1 + b$。因此，法诺因子变为\n$$\nF = \\frac{\\operatorname{Var}(m)}{\\langle m \\rangle} = \\frac{a b (1+b)}{a b} = 1 + b.\n$$\n这个关系直接导出\n$$\nb = F - 1.\n$$\n一旦 $b$ 已知，均值关系 $\\langle m \\rangle = a b$ 给出\n$$\na = \\frac{\\langle m \\rangle}{b}.\n$$\n现在代入测量值 $\\langle m \\rangle = 32$ 和 $F = 5$：\n$$\nb = 5 - 1 = 4, \\qquad a = \\frac{32}{4} = 8.\n$$\n在此模型中，$b$ 和 $a$ 均为无量纲数，符合要求。所求的行向量为 $\\big[b,\\;a\\big] = \\big[4,\\;8\\big]$。", "answer": "$$\\boxed{\\begin{pmatrix}4 & 8\\end{pmatrix}}$$", "id": "2967024"}, {"introduction": "实验测量总是伴随着不完美之处，理解这些局限性对于准确解释数据至关重要。本练习探讨了有限的检测效率（$\\eta$）如何影响对基因表达噪声的观察。您将通过推导证明，这种常见的实验伪影会如何系统性地减弱（或“稀释”）所测得的阵发信号，这对于从定量实验数据中提取真实的生物学信息是一项关键技能 [@problem_id:2967004]。", "problem": "单个基因表现出转录爆发。在一个充分混合的稳态细胞中，已知信使核糖核酸（mRNA）的拷贝数（记为 $N$）服从负二项分布。这是泊松分布的爆发到达和几何分布的爆发大小，以及一级 mRNA 降解共同作用的结果。设无量纲的爆发频率为 $r>0$（每个 mRNA 生命周期内的平均爆发次数），平均爆发大小为 $b>0$。则 mRNA 拷贝数的均值为 $\\mu = r b$。每个 mRNA 分子以有限的检测效率 $0<\\eta<1$ 被独立检测，得到观测计数 $Y$。该过程为：每个分子以概率 $\\eta$ 被保留，以概率 $1-\\eta$ 被丢弃。\n\n从法诺因子 $F_X = \\operatorname{Var}(X)/\\mathbb{E}[X]$ 的定义、全期望定律和全方差定律出发，并仅使用负二项分布的广为接受的性质（例如，其前两阶矩），推导有限的检测效率如何将负二项信号转换为经二项式稀疏化的负二项过程，并以 $\\eta$ 和 $b$ 的形式计算得到的观测法诺因子 $F_Y$ 的闭式解。你的最终答案必须是 $F_Y$ 的单个解析表达式；不要包含单位，也不要作近似。", "solution": "目标是计算观测到的 mRNA 计数 $Y$ 的法诺因子，其定义为 $F_Y = \\frac{\\operatorname{Var}(Y)}{\\mathbb{E}[Y]}$。为此，我们必须首先计算期望 $\\mathbb{E}[Y]$ 和方差 $\\operatorname{Var}(Y)$。\n\n首先，我们使用全期望定律计算 $Y$ 的期望：$\\mathbb{E}[Y] = \\mathbb{E}[\\mathbb{E}[Y|N]]$。\n在真实 mRNA 计数为 $N$ 的条件下，观测计数 $Y$ 服从二项分布 $\\text{Binomial}(N, \\eta)$。二项分布 $\\text{Binomial}(n, p)$ 的期望是 $np$。因此，$Y$ 在给定 $N$ 下的条件期望是：\n$$\n\\mathbb{E}[Y|N] = N\\eta\n$$\n现在，我们对 $N$ 的分布求期望：\n$$\n\\mathbb{E}[Y] = \\mathbb{E}[N\\eta] = \\eta \\mathbb{E}[N]\n$$\n问题陈述中说明，真实计数 $N$ 的均值为 $\\mathbb{E}[N] = rb$。代入此式，我们得到观测计数的均值：\n$$\n\\mathbb{E}[Y] = \\eta r b\n$$\n\n接下来，我们使用全方差定律计算 $Y$ 的方差：\n$$\n\\operatorname{Var}(Y) = \\mathbb{E}[\\operatorname{Var}(Y|N)] + \\operatorname{Var}(\\mathbb{E}[Y|N])\n$$\n我们必须计算等式右边的两项。\n\n对于第一项 $\\mathbb{E}[\\operatorname{Var}(Y|N)]$，我们需要 $Y$ 在给定 $N$ 下的条件方差。二项分布 $\\text{Binomial}(n, p)$ 的方差是 $np(1-p)$。因此，条件方差是：\n$$\n\\operatorname{Var}(Y|N) = N\\eta(1-\\eta)\n$$\n对 $N$ 求期望：\n$$\n\\mathbb{E}[\\operatorname{Var}(Y|N)] = \\mathbb{E}[N\\eta(1-\\eta)] = \\eta(1-\\eta)\\mathbb{E}[N] = \\eta(1-\\eta)rb\n$$\n\n对于第二项 $\\operatorname{Var}(\\mathbb{E}[Y|N])$，我们使用先前推导出的条件期望结果 $\\mathbb{E}[Y|N] = N\\eta$：\n$$\n\\operatorname{Var}(\\mathbb{E}[Y|N]) = \\operatorname{Var}(N\\eta) = \\eta^2 \\operatorname{Var}(N)\n$$\n现在，我们必须求出真实 mRNA 计数 $N$ 的方差 $\\operatorname{Var}(N)$。问题陈述中说明，$N$ 服从因转录爆发而产生的负二项分布。此分布的一个基本性质是（由平均爆发大小 $b$ 和爆发频率 $r$ 参数化），其方差通过以下表达式与其均值 $\\mathbb{E}[N] = rb$ 相关联：\n$$\n\\operatorname{Var}(N) = \\mathbb{E}[N] + \\frac{(\\mathbb{E}[N])^2}{r} = rb + \\frac{(rb)^2}{r} = rb + rb^2 = rb(1+b)\n$$\n这也意味着真实计数的法诺因子是 $F_N = \\frac{\\operatorname{Var}(N)}{\\mathbb{E}[N]} = 1+b$。\n将此结果代入全方差的第二项表达式中：\n$$\n\\operatorname{Var}(\\mathbb{E}[Y|N]) = \\eta^2 [rb(1+b)] = \\eta^2 rb(1+b)\n$$\n\n现在，我们将这两项相加，求出 $Y$ 的总方差：\n$$\n\\operatorname{Var}(Y) = \\eta(1-\\eta)rb + \\eta^2 rb(1+b)\n$$\n我们可以提出公因子 $rb\\eta$：\n$$\n\\operatorname{Var}(Y) = rb\\eta[(1-\\eta) + \\eta(1+b)]\n$$\n$$\n\\operatorname{Var}(Y) = rb\\eta[1-\\eta + \\eta + \\eta b]\n$$\n$$\n\\operatorname{Var}(Y) = rb\\eta(1 + \\eta b)\n$$\n\n最后，我们计算观测计数 $Y$ 的法诺因子：\n$$\nF_Y = \\frac{\\operatorname{Var}(Y)}{\\mathbb{E}[Y]} = \\frac{rb\\eta(1 + \\eta b)}{rb\\eta}\n$$\n项 $rb\\eta$ 可以消去，前提是 $r, b, \\eta$ 均不为零，这在问题陈述中已给出（$r>0, b>0, 0<\\eta<1$）。这样就得到了观测法诺因子的最终表达式：\n$$\nF_Y = 1 + \\eta b\n$$\n这个结果表明，来自爆发大小 $b$ 的噪声被检测效率 $\\eta$ 所衰减，而基线的泊松噪声分量（‘1’这一项）不受影响。", "answer": "$$\n\\boxed{1 + \\eta b}\n$$", "id": "2967004"}]}