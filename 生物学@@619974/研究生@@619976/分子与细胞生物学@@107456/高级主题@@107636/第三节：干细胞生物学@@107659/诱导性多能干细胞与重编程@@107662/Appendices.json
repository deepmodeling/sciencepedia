{"hands_on_practices": [{"introduction": "成功诱导多能干细胞的第一步是有效地将重编程因子递送到靶细胞中。病毒载体是一种常用方法，但如何确定病毒的最佳用量以确保大多数细胞都能接收到所有必需的因子，同时又避免过度感染带来的细胞毒性？本练习将指导你应用泊松分布模型来解决这个实际问题，计算实现高重编程效率所需的总感染复数 (MOI)，这是细胞工程中的一项基本定量技能。[@problem_id:2948582]", "problem": "一个实验室旨在生成诱导性多能干细胞 (iPSCs)，方法是使用四种独立的、滴度匹配的病毒载体来递送四种重编程转录因子（例如，OCT4、SOX2、KLF4 和 MYC）。感染在低至中等病毒载量下进行，使得每个载体每个细胞的成功进入事件数可以很好地用泊松分布来建模，并且来自不同载体的进入事件彼此独立。假设四种载体均以相同的感染复数 (MOI) 应用，记为 $m$，其定义为该载体每个细胞的平均成功进入事件数。一个细胞被认为具有重编程能力，当且仅当它从四种载体中的每一种都接收到至少一次成功的进入事件；从任何单一载体接收多个拷贝不会提供额外的好处。\n\n仅使用泊松分布的定义和四种载体事件的独立性，确定所有四种载体的总感染复数，记为 $M_{\\text{total}}$，使得一个随机选择的细胞有 $0.95$ 的概率从四种载体中的每一种都接收到至少一次成功的进入事件。以初等函数的闭式解析表达式表示您的最终答案。不要进行数值计算。最终答案必须是一个没有单位的单一表达式。", "solution": "问题指明，对于每种载体，每个细胞的成功进入事件数服从均值为 $m$ 的泊松分布。对于均值为 $m$ 的泊松随机变量 $K$，观察到恰好 $k$ 个事件的概率是\n$$\n\\Pr(K = k) = \\frac{m^{k} \\exp(-m)}{k!}.\n$$\n特别地，从某个给定载体获得零次成功进入的概率是\n$$\n\\Pr(K = 0) = \\exp(-m).\n$$\n因此，一个细胞从某个给定载体接收到至少一次成功进入的概率是\n$$\n\\Pr(K \\ge 1) = 1 - \\Pr(K = 0) = 1 - \\exp(-m).\n$$\n问题陈述，四种载体的感染是独立的，并且每种载体都以相同的 $m$ 应用。因此，一个细胞从四种载体中的每一种都接收到至少一次成功进入的概率是各个概率的乘积：\n$$\n\\Pr(\\text{每种载体至少一次}) = \\left(1 - \\exp(-m)\\right)^{4}.\n$$\n我们需要确保这个概率等于 $0.95$。因此 $m$ 必须满足\n$$\n\\left(1 - \\exp(-m)\\right)^{4} = 0.95.\n$$\n取四次方根并解出 $m$，\n$$\n1 - \\exp(-m) = 0.95^{1/4}\n\\quad\\Longrightarrow\\quad\n\\exp(-m) = 1 - 0.95^{1/4}\n\\quad\\Longrightarrow\\quad\nm = -\\ln\\!\\left(1 - 0.95^{1/4}\\right).\n$$\n所有四种载体的总感染复数是每种载体所用均值的总和，在对称性下为\n$$\nM_{\\text{total}} = 4 m = -4 \\,\\ln\\!\\left(1 - 0.95^{1/4}\\right).\n$$\n如题所求，这是一个以初等函数表示的闭式解析表达式。", "answer": "$$\\boxed{-4\\,\\ln\\!\\left(1-0.95^{1/4}\\right)}$$", "id": "2948582"}, {"introduction": "细胞重编程的核心是表观遗传状态的剧烈重塑，其中DNA去甲基化是一个关键环节。通过数学建模，我们可以将复杂的生物过程转化为可量化的参数，从而更深入地理解其动力学机制。本练习将引导你使用一阶动力学模型来描述在维生素C诱导下特定CpG位点的去甲基化过程，并利用给定的时间序列数据估算反应速率常数 $\\lambda$，让你亲身体验如何连接宏观实验数据与微观分子事件。[@problem_id:2948568]", "problem": "在诱导性多能干细胞(iPSC)重编程过程中，抗坏血酸（维生素C）能增强Ten-Eleven Translocation (TET)双加氧酶的活性，从而加速5-甲基胞嘧啶的氧化并促进DNA去甲基化。考虑一个在持续维生素C暴露下的大规模克隆群体中被调查的单个CpG位点。假设每个甲基化的等位基因以一个恒定的单位等位基因风险率 $\\lambda$ (单位：天$^{-1}$)独立地转化为未甲基化状态，这符合一个无记忆的一阶过程。令 $p(t)$ 表示在时间 $t$（单位：天）一个随机选择的等位基因保持甲基化的概率，且 $p(0)=1$。\n\n1) 从无记忆一阶转换的原理出发，写出 $p(t)$ 的微分方程，并求解该方程以获得 $p(t)$ 关于 $\\lambda$ 和 $t$ 的闭式表达式。\n\n2) 在维生素C处理下，通过深度测序在连续时间点测量该位点的甲基化分数（假设采样误差可忽略不计，因此观测到的分数等于真实的 $p(t)$）如下：\n- $t=1$ 天, $\\hat{p}(1)=0.6065$\n- $t=2$ 天, $\\hat{p}(2)=0.3679$\n- $t=3$ 天, $\\hat{p}(3)=0.2231$\n- $t=4$ 天, $\\hat{p}(4)=0.1353$\n\n使用你在第(1)部分中导出的函数形式，通过自然对数将关系线性化，并在线性化模型上使用普通最小二乘法估计 $\\lambda$，约束拟合通过点 $(t,\\ln p)=(0,0)$，这代表了 $p(0)=1$。报告你对 $\\lambda$ 的估计值，单位为 天$^{-1}$，并四舍五入到四位有效数字。", "solution": "问题陈述已经过验证，被认为是科学上合理的、问题定义清晰且客观的。它提出了一个应用于生物过程的化学动力学标准问题，可以用已有的数学方法解决。\n\n该问题分为两部分。首先，我们必须推导去甲基化过程的数学模型。其次，我们必须使用所提供的数据来估计该模型的一个参数。\n\n第1部分：控制微分方程的推导与求解。\n\n问题陈述指出，甲基化等位基因向未甲基化状态的转化是一个无记忆的一阶过程。这意味着转化速率与剩余的甲基化等位基因数量成正比。令 $p(t)$ 为在时间 $t$ 随机选择的等位基因被甲基化的概率。在一个大群体中，$p(t)$ 等价于甲基化等位基因的比例。这个比例的变化率 $\\frac{dp(t)}{dt}$ 与其本身 $p(t)$ 成正比。比例常数是单位等位基因风险率 $\\lambda$ 的负值，因为甲基化等位基因的比例随时间减少。\n\n因此，控制常微分方程为：\n$$\n\\frac{dp(t)}{dt} = -\\lambda p(t)\n$$\n这是一个一阶线性齐次常系数微分方程。它是可分离的。我们可以将方程重新排列为：\n$$\n\\frac{1}{p(t)} dp(t) = -\\lambda dt\n$$\n我们对等式两边进行积分。左边从初始概率 $p(0)$ 积分到 $p(t)$，右边从时间 $0$ 积分到 $t$。\n$$\n\\int_{p(0)}^{p(t)} \\frac{1}{p'} dp' = \\int_{0}^{t} (-\\lambda) dt'\n$$\n执行积分得到：\n$$\n[\\ln(p')]_{p(0)}^{p(t)} = [-\\lambda t']_{0}^{t}\n$$\n$$\n\\ln(p(t)) - \\ln(p(0)) = -\\lambda t - 0\n$$\n$$\n\\ln\\left(\\frac{p(t)}{p(0)}\\right) = -\\lambda t\n$$\n问题指定了初始条件 $p(0) = 1$，这意味着在 $t=0$ 时所有等位基因都是甲基化的。将此代入方程中：\n$$\n\\ln\\left(\\frac{p(t)}{1}\\right) = \\ln(p(t)) = -\\lambda t\n$$\n为了得到 $p(t)$ 的闭式表达式，我们对两边取指数：\n$$\np(t) = \\exp(-\\lambda t)\n$$\n这就是该微分方程的解，也是在时间 $t$ 等位基因保持甲基化的概率的函数形式。\n\n第2部分：速率常数 $\\lambda$ 的估计。\n\n我们得到在四个时间点 $t_i$ 的甲基化分数测量值 $\\hat{p}(t_i)$。我们需要在线性化模型上使用普通最小二乘法 (OLS) 来估计 $\\lambda$。在第1部分中推导出的模型是 $p(t) = \\exp(-\\lambda t)$。应用自然对数可以使这个关系线性化：\n$$\n\\ln(p(t)) = -\\lambda t\n$$\n这个方程的形式为一条直线 $y=mx$，其中 $y = \\ln(p(t))$，$x = t$，斜率为 $m = -\\lambda$。问题要求拟合被约束通过原点 $(t, \\ln p) = (0, 0)$，这与我们的模型一致，因为 $\\ln(p(0)) = \\ln(1) = 0$。\n\n对于一个强制通过原点的 $y_i = \\beta x_i + \\epsilon_i$ 形式的线性回归模型，最小化残差平方和的斜率OLS估计量 $\\hat{\\beta}$ 由以下公式给出：\n$$\n\\hat{\\beta} = \\frac{\\sum_{i=1}^{n} x_i y_i}{\\sum_{i=1}^{n} x_i^2}\n$$\n在我们的情境中，$x_i = t_i$，$y_i = \\ln(\\hat{p}(t_i))$，斜率参数是 $\\beta = -\\lambda$。所以，我们对斜率的估计值（记为 $\\hat{m}$）是：\n$$\n\\hat{m} = \\frac{\\sum_{i=1}^{4} t_i \\ln(\\hat{p}(t_i))}{\\sum_{i=1}^{4} t_i^2}\n$$\n那么 $\\lambda$ 的估计值为 $\\hat{\\lambda} = -\\hat{m}$。\n\n提供的数据如下：\n- $t_1 = 1$, $\\hat{p}(1) = 0.6065$\n- $t_2 = 2$, $\\hat{p}(2) = 0.3679$\n- $t_3 = 3$, $\\hat{p}(3) = 0.2231$\n- $t_4 = 4$, $\\hat{p}(4) = 0.1353$\n\n我们首先计算分母 $\\sum t_i^2$：\n$$\n\\sum_{i=1}^{4} t_i^2 = 1^2 + 2^2 + 3^2 + 4^2 = 1 + 4 + 9 + 16 = 30\n$$\n接下来，我们计算分子 $\\sum t_i \\ln(\\hat{p}(t_i))$：\n- $\\ln(\\hat{p}(1)) = \\ln(0.6065) \\approx -0.5000728$\n- $\\ln(\\hat{p}(2)) = \\ln(0.3679) \\approx -0.9999136$\n- $\\ln(\\hat{p}(3)) = \\ln(0.2231) \\approx -1.5001351$\n- $\\ln(\\hat{p}(4)) = \\ln(0.1353) \\approx -2.0002461$\n\n总和是：\n$$\n\\sum_{i=1}^{4} t_i \\ln(\\hat{p}(t_i)) = 1(-0.5000728) + 2(-0.9999136) + 3(-1.5001351) + 4(-2.0002461)\n$$\n$$\n= -0.5000728 - 1.9998272 - 4.5004053 - 8.0009844 = -15.0012897\n$$\n现在，我们可以计算估计的斜率 $\\hat{m}$：\n$$\n\\hat{m} = \\frac{-15.0012897}{30} \\approx -0.50004299\n$$\n$\\lambda$ 的估计值是 $\\hat{\\lambda} = -\\hat{m}$：\n$$\n\\hat{\\lambda} = -(-0.50004299) = 0.50004299 \\, \\text{day}^{-1}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\hat{\\lambda} \\approx 0.5000 \\, \\text{day}^{-1}\n$$", "answer": "$$\n\\boxed{0.5000}\n$$", "id": "2948568"}, {"introduction": "将iPSC技术从实验室推向临床，安全性是首要考量。由iPSC分化而来的细胞移植物中如果残留有未分化的细胞，可能形成畸胎瘤，构成严重的肿瘤风险。因此，对最终细胞产品进行严格的质量控制和风险评估至关重要。本练习模拟了细胞疗法中的一个关键安全评估场景，要求你从基本概率原理出发，为残余未分化细胞的未知比例 $p$ 构建一个统计置信上限，这对于确保iPSC衍生疗法的安全性具有直接的实践意义。[@problem_id:2948646]", "problem": "在一批由诱导性多能干细胞（iPSCs; induced pluripotent stem cells）分化而来的分化细胞的安全性评估中，主要的致瘤性风险来自于罕见的残留未分化iPSCs。令 $p$ 表示该批次中随机选择的单个细胞是会在移植后形成畸胎瘤的残留未分化iPSC的未知概率。假设对于残留未分化状态和检测结果，细胞之间是相互独立的。\n\n某申办方计划移植一个大小为 $T$ 个细胞的移植物。在质量控制中，他们使用一种对未分化细胞检测灵敏度为 $\\eta$ 且具有完美特异性的单细胞测试，对批次中的一个大小为 $n$ 的简单随机样本进行检测。在 $n$ 个抽样细胞中，检测结果全部为阴性。该申办方希望使用 $1-\\alpha$ 的单边频率学派置信水平来限定 $p$ 的范围。\n\n仅从独立伯努利试验的基本概率定律和补集法则出发，并且不调用任何预先制表的统计区间公式，完成以下任务：\n\n1. 推导致瘤性风险 $r(p,T)$ 的表达式，该风险定义为大小为 $T$ 的移植物中存在至少一个残留未分化iPSC的概率。\n2. 推导一个精确的单边置信上限 $p_{\\max}(n,\\eta,\\alpha)$，使得在该模型下，在 $n$ 次独立检测中观察到零个阳性结果，意味着 $p \\leq p_{\\max}(n,\\eta,\\alpha)$ 的置信度至少为 $1-\\alpha$。\n3. 使用您推导的表达式，计算当检测细胞数 $n = 3.0 \\times 10^{6}$、灵敏度 $\\eta = 0.95$、$\\alpha = 0.05$ 时的 $p_{\\max}$。将最终的界限表示为十进制数，并将最终答案四舍五入至四位有效数字。\n\n仅以 $p_{\\max}$ 的数值作为最终答案。不要报告任何中间量。概率必须以小数或分数表示，而不是百分比。", "solution": "所述问题具有科学依据，提法明确且客观。它代表了细胞治疗质量控制背景下的一个标准统计风险评估问题。诸如独立伯努利试验等假设，对于该领域典型的大批量生产是合适的简化。因此，该问题被认为是有效的，并将构建一个解决方案。\n\n按照问题陈述的要求，解决方案分三部分推导。\n\n**第一部分：致瘤性风险 $r(p, T)$ 的推导**\n\n致瘤性风险 $r(p, T)$ 被定义为在大小为 $T$ 的移植物中存在至少一个残留未分化诱导性多能干细胞（iPSC）的概率。令 $p$ 为单个随机选取的细胞是未分化iPSC的概率。为移植物选择每个细胞的过程被建模为一次独立的伯努利试验。\n\n移植物中含有“至少一个”未分化细胞的事件，是其含有“零个”未分化细胞事件的补集。根据概率的补集法则：\n$$r(p, T) = P(\\text{T个细胞中至少有一个未分化细胞}) = 1 - P(\\text{T个细胞中没有未分化细胞})$$\n\n单个细胞*不是*未分化iPSC的概率是 $1-p$。由于假设细胞是独立的，所有 $T$ 个细胞都*不是*未分化细胞的概率是它们各自概率的乘积：\n$$P(\\text{T个细胞中没有未分化细胞}) = (1-p) \\times (1-p) \\times \\dots \\times (1-p) \\text{ (} T \\text{ 次)} = (1-p)^T$$\n\n将此代入风险表达式，得到所需公式：\n$$r(p, T) = 1 - (1-p)^T$$\n\n**第二部分：置信上限 $p_{\\max}(n, \\eta, \\alpha)$ 的推导**\n\n我们的任务是为未知参数 $p$ 推导一个精确的单边置信上限 $p_{\\max}$。该置信上限基于在 $n$ 个细胞的样本中未发现阳性结果的观测，该样本使用灵敏度为 $\\eta$ 且特异性完美的测试进行检测。置信水平为 $1-\\alpha$。\n\n首先，我们必须确定单个细胞测试结果为阴性的概率，该概率是 $p$ 的函数。令 $U$ 为细胞是未分化iPSC的事件（$P(U) = p$），$D$ 为细胞是分化细胞的事件（$P(D) = 1-p$）。测试的特征如下：\n- 灵敏度：$P(\\text{测试阳性} | U) = \\eta$。因此，一个未分化细胞出现假阴性的概率是 $P(\\text{测试阴性} | U) = 1 - \\eta$。\n- 完美特异性：$P(\\text{测试阴性} | D) = 1$。\n\n使用全概率定律，单个细胞测试结果为阴性的总概率是：\n$$P(\\text{测试阴性}) = P(\\text{测试阴性} | U) P(U) + P(\\text{测试阴性} | D) P(D)$$\n$$P(\\text{测试阴性}) = (1-\\eta)p + (1)(1-p) = p - \\eta p + 1 - p = 1 - \\eta p$$\n\n令 $E$ 为所有 $n$ 次独立检测均返回阴性结果的事件。在未知参数 $p$ 的条件下，此事件的概率为：\n$$P(E|p) = [P(\\text{测试阴性})]^n = (1 - \\eta p)^n$$\n\n要构建一个 $1-\\alpha$ 的置信上限，我们遵循频率学派的原则。置信上限 $p_{\\max}$ 是这样一个 $p$ 值，对于该 $p$ 值，观察到我们的结果（零个阳性）或更极端结果的概率等于显著性水平 $\\alpha$。令 $X$ 为观察到的阳性细胞数的随机变量。我们观察到 $X=0$。在检验置信上限时，阳性数更少的结果（如 $X=0$）被认为在支持更小 $p$ 值的方向上更为极端。我们观测结果的p值为 $P(X \\le 0|p) = P(X=0|p)$。置信上限 $p_{\\max}$ 是使该p值等于 $\\alpha$ 的 $p$ 值。\n\n因此，我们将我们观察到的事件的概率设为等于 $\\alpha$：\n$$P(E | p_{\\max}) = \\alpha$$\n$$(1 - \\eta p_{\\max})^n = \\alpha$$\n\n现在，我们对该方程求解 $p_{\\max}$：\n$$1 - \\eta p_{\\max} = \\alpha^{1/n}$$\n$$\\eta p_{\\max} = 1 - \\alpha^{1/n}$$\n$$p_{\\max}(n, \\eta, \\alpha) = \\frac{1 - \\alpha^{1/n}}{\\eta}$$\n这就是从第一性原理推导出的精确单边置信上限。\n\n**第三部分：$p_{\\max}$ 的数值计算**\n\n我们给定以下数值：\n- 检测细胞数, $n = 3.0 \\times 10^6$\n- 检测灵敏度, $\\eta = 0.95$\n- 显著性水平, $\\alpha = 0.05$\n\n将这些值代入我们推导出的 $p_{\\max}$ 公式中：\n$$p_{\\max} = \\frac{1 - (0.05)^{1/(3.0 \\times 10^6)}}{0.95}$$\n\n为了计算这个表达式，我们首先计算 $(0.05)^{1/(3.0 \\times 10^6)}$ 这一项。我们使用恒等式 $a^b = \\exp(b \\ln a)$：\n$$\\frac{1}{n} = \\frac{1}{3.0 \\times 10^6} \\approx 3.333 \\times 10^{-7}$$\n$$\\ln(\\alpha) = \\ln(0.05) \\approx -2.99573227$$\n$$\\frac{\\ln(\\alpha)}{n} = \\frac{-2.99573227}{3.0 \\times 10^6} \\approx -9.9857742 \\times 10^{-7}$$\n$$(0.05)^{1/n} = \\exp\\left(\\frac{\\ln(0.05)}{n}\\right) \\approx \\exp(-9.9857742 \\times 10^{-7}) \\approx 0.999999001422$$\n\n现在将此结果代回 $p_{\\max}$ 的表达式中：\n$$p_{\\max} \\approx \\frac{1 - 0.999999001422}{0.95} = \\frac{9.98578 \\times 10^{-7}}{0.95} \\approx 1.0511347 \\times 10^{-6}$$\n\n作为核对，对于非常大的 $n$，$p_{\\max}$ 的表达式可以使用对于小 $x$ 的泰勒展开 $\\exp(x) \\approx 1+x$ 进行近似：\n$$\\alpha^{1/n} = \\exp\\left(\\frac{\\ln \\alpha}{n}\\right) \\approx 1 + \\frac{\\ln \\alpha}{n}$$\n$$p_{\\max} \\approx \\frac{1 - (1 + \\frac{\\ln \\alpha}{n})}{\\eta} = \\frac{-\\ln \\alpha}{n\\eta}$$\n$$p_{\\max} \\approx \\frac{-\\ln(0.05)}{(3.0 \\times 10^6)(0.95)} = \\frac{2.99573227}{2.85 \\times 10^6} \\approx 1.0511341 \\times 10^{-6}$$\n近似值与精确计算结果极为接近，从而证实了结果的正确性。\n\n将计算出的值 $1.0511347 \\times 10^{-6}$ 四舍五入到四位有效数字，得到 $1.051 \\times 10^{-6}$。", "answer": "$$\\boxed{1.051 \\times 10^{-6}}$$", "id": "2948646"}]}