{"hands_on_practices": [{"introduction": "我们首先构建一个简化的肺部数学模型，以此开启我们的实践探索。这个练习将演示像重力这样的基本物理力量，如何导致通气-灌注比（$\\dot{V}_A/\\dot{Q}$）在肺部从底部到顶部产生可预测的空间差异。通过从第一性原理出发推导这一关系，您将对健康直立肺部气体交换的内在不均匀性建立基础性的理解。[@problem_id:2621305]", "problem": "在功能残气量状态下，直立的哺乳动物肺部中，重力在局部肺泡通气和局部肺血流量上都产生了垂直梯度。考虑一个一维垂直坐标 $x$（单位为 $\\mathrm{m}$），从肺底（$x=0$ 处为肺底，向肺尖方向增加）向上测量。假设单位肺容积的局部肺泡通气量（记为 $\\dot V_{A}(x)$）和单位肺容积的局部肺血流量（记为 $\\dot Q(x)$），由于流体静力学和顺应性效应，均随高度呈现简单的指数依赖关系：\n$$\\dot V_{A}(x)=\\dot V_{A}(0)\\,\\exp\\!\\left(-\\frac{x}{\\lambda_{V}}\\right),\\qquad \\dot Q(x)=\\dot Q(0)\\,\\exp\\!\\left(-\\frac{x}{\\lambda_{Q}}\\right),$$\n其中 $\\lambda_{V}0$ 和 $\\lambda_{Q}0$ 分别是通气和灌注的恒定标高。设局部通气-灌注比定义为 $R(x)=\\dot V_{A}(x)/\\dot Q(x)$，并定义肺底比值为 $R_{0}=\\dot V_{A}(0)/\\dot Q(0)$。 \n\n仅从给定的假设、$R(x)$ 的定义以及指数函数的标准性质出发，推导出一个用 $x$、$\\lambda_{V}$、$\\lambda_{Q}$ 和 $R_{0}$ 表示的 $R(x)$ 的闭式解析表达式，并尽可能简化。通气-灌注比是无量纲的；报告你的最终表达式时无需单位。你的最终答案必须是一个单一的解析表达式。", "solution": "我们从单位肺容积的局部肺泡通气量 $\\dot V_{A}(x)$ 和单位肺容积的局部肺血流量 $\\dot Q(x)$ 的定义开始，假设它们都随高度呈指数变化：\n$$\\dot V_{A}(x)=\\dot V_{A}(0)\\,\\exp\\!\\left(-\\frac{x}{\\lambda_{V}}\\right),\\qquad \\dot Q(x)=\\dot Q(0)\\,\\exp\\!\\left(-\\frac{x}{\\lambda_{Q}}\\right),$$\n且 $\\lambda_{V}0$ 和 $\\lambda_{Q}0$。\n\n高度 $x$ 处的通气-灌注比定义为\n$$R(x)=\\frac{\\dot V_{A}(x)}{\\dot Q(x)}.$$\n\n将指数形式代入定义中可得\n$$R(x)=\\frac{\\dot V_{A}(0)\\,\\exp\\!\\left(-\\frac{x}{\\lambda_{V}}\\right)}{\\dot Q(0)\\,\\exp\\!\\left(-\\frac{x}{\\lambda_{Q}}\\right)}.$$\n\n使用指数的性质 $\\exp(a)/\\exp(b)=\\exp(a-b)$，我们可以合并指数项：\n$$R(x)=\\frac{\\dot V_{A}(0)}{\\dot Q(0)}\\,\\exp\\!\\left(-\\frac{x}{\\lambda_{V}}+\\frac{x}{\\lambda_{Q}}\\right).$$\n\n识别出肺底比值 $R_{0}=\\dot V_{A}(0)/\\dot Q(0)$，我们写出\n$$R(x)=R_{0}\\,\\exp\\!\\left(x\\left(\\frac{1}{\\lambda_{Q}}-\\frac{1}{\\lambda_{V}}\\right)\\right).$$\n\n这是一个闭式表达式，给出了通气-灌注比作为高度 $x$ 的函数，并用标高 $\\lambda_{V}$和 $\\lambda_{Q}$ 以及肺底比值 $R_{0}$ 表示。如要求所述，它是无量纲的。", "answer": "$$\\boxed{R_{0}\\,\\exp\\!\\left(x\\left(\\frac{1}{\\lambda_{Q}}-\\frac{1}{\\lambda_{V}}\\right)\\right)}$$", "id": "2621305"}, {"introduction": "从理想化的空间模型转向实践，我们现在来学习一种量化整个肺部气体交换总效率的方法。本题要求您从二氧化碳质量守恒的基本原则出发，推导Bohr-Enghoff方程，并借此计算生理死腔。这个练习至关重要，它能帮助您理解通气-灌注失配的总体效应是如何通过一个单一且具有临床意义的指标来体现的。[@problem_id:2621283]", "problem": "一名处于静息状态的成年人在稳态条件下呼吸室内空气。在平静呼吸期间，您测量到以下数据：潮气量 $V_T = 560\\,\\mathrm{mL}$，通过动脉血气分析测得的动脉血二氧化碳分压 $P_{\\mathrm{a}CO_2} = 44\\,\\mathrm{mmHg}$，以及通过道格拉斯袋（Douglas bag）收集经快速响应二氧化碳分析仪完全混合的单次呼出潮气测得的混合呼出气二氧化碳分压 $\\bar{P}_{\\mathrm{E}CO_2} = 30\\,\\mathrm{mmHg}$。\n\n请仅从以下三点出发：(i) 单次潮气呼吸过程中的二氧化碳守恒，(ii) 呼吸室内空气时吸入的二氧化碳可忽略不计，以及 (iii) 在没有明显弥散限制的稳态条件下，肺泡和动脉血的二氧化碳分压相等，推导出根据这些测量值计算生理死腔容积 $V_D$ 所需的关系式。然后，计算该受试者的 $V_D$。\n\n将您的最终数值答案以 $\\mathrm{mL}$ 为单位表示，并四舍五入至三位有效数字。\n\n在您的推理过程中，简要解释计算出的死腔分数值的大小对于该受试者在静息状态下的通气/血流（$V/Q$）匹配意味着什么，但不要将此解释包含在您的最终数值答案中。", "solution": "所述问题有效、自洽且科学合理。这是质量平衡原理在呼吸生理学中的一个标准应用。我们将进行推导和计算。\n\n该问题的基础是质量守恒原理，应用于单次稳态潮气呼吸中的二氧化碳（$CO_2$）。在一个潮气量（$V_T$）中呼出的$CO_2$总量必须等于源自该容积不同组分的$CO_2$量之和。\n\n单个潮气量 $V_T$ 在概念上被划分为两个不重叠的容积：\n1.  生理死腔容积 $V_D$。这部分气体占据了传导气道以及任何有通气但无灌注的肺泡。这部分容积不参与与肺毛细血管血液的气体交换。\n2.  肺泡通气量 $V_A$。这是到达有灌注的肺泡并参与气体交换的气体容积。\n\n根据定义，这些容积之和等于潮气量：\n$$V_T = V_D + V_A$$\n因此， $V_A = V_T - V_D$。\n\n根据质量守恒定律，混合呼出气中$CO_2$的总摩尔数必须等于来自肺泡容积的$CO_2$摩尔数与来自死腔容积的$CO_2$摩尔数之和。假设理想气体行为（$PV=nRT$），在温度（$T$）恒定的情况下，一种气体的摩尔数（$n$）与其分压（$P$）和所占容积（$V$）的乘积成正比。因此，我们可以用分压-容积乘积来写出质量平衡方程，因为常数项 $1/(RT)$ 将从所有项中消去。\n\n呼出的$CO_2$总量由潮气量 $V_T$ 与混合呼出气中$CO_2$的平均分压 $\\bar{P}_{\\mathrm{E}CO_2}$ 的乘积给出。\n源自死腔的$CO_2$量是死腔容积 $V_D$ 与吸入气中$CO_2$分压 $P_{\\mathrm{I}CO_2}$ 的乘积，因为在吸气末，死腔中充满了吸入气。\n源自肺泡气的$CO_2$量是肺泡容积 $V_A$ 与肺泡气中$CO_2$分压 $P_{\\mathrm{A}CO_2}$ 的乘积。\n\n因此，守恒方程为：\n$$V_T \\cdot \\bar{P}_{\\mathrm{E}CO_2} = V_D \\cdot P_{\\mathrm{I}CO_2} + V_A \\cdot P_{\\mathrm{A}CO_2}$$\n\n我们应用问题中规定的条件：\n(i) $CO_2$守恒是我们方程的基础。\n(ii) 吸入的是室内空气，其中$CO_2$的浓度可以忽略不计。因此，我们取 $P_{\\mathrm{I}CO_2} \\approx 0$。\n(iii) 在没有明显弥散限制且系统处于稳态的情况下，肺泡气中的$CO_2$分压与动脉血中的$CO_2$分压达到平衡。因此， $P_{\\mathrm{A}CO_2} \\approx P_{\\mathrm{a}CO_2}$。\n\n将这些条件和关系式 $V_A = V_T - V_D$ 代入守恒方程：\n$$V_T \\cdot \\bar{P}_{\\mathrm{E}CO_2} = V_D \\cdot (0) + (V_T - V_D) \\cdot P_{\\mathrm{a}CO_2}$$\n简化后得到：\n$$V_T \\cdot \\bar{P}_{\\mathrm{E}CO_2} = V_T \\cdot P_{\\mathrm{a}CO_2} - V_D \\cdot P_{\\mathrm{a}CO_2}$$\n我们需要求的是生理死腔 $V_D$。我们重排方程以解出 $V_D$：\n$$V_D \\cdot P_{\\mathrm{a}CO_2} = V_T \\cdot P_{\\mathrm{a}CO_2} - V_T \\cdot \\bar{P}_{\\mathrm{E}CO_2}$$\n$$V_D \\cdot P_{\\mathrm{a}CO_2} = V_T (P_{\\mathrm{a}CO_2} - \\bar{P}_{\\mathrm{E}CO_2})$$\n这就得出了所需的关系式，即经Enghoff为计算生理死腔而改良的Bohr方程：\n$$V_D = V_T \\frac{P_{\\mathrm{a}CO_2} - \\bar{P}_{\\mathrm{E}CO_2}}{P_{\\mathrm{a}CO_2}}$$\n该方程允许根据给定的可测量量来计算生理死腔。\n\n现在，我们使用所提供的数据计算 $V_D$ 的数值：\n$V_T = 560\\,\\mathrm{mL}$\n$P_{\\mathrm{a}CO_2} = 44\\,\\mathrm{mmHg}$\n$\\bar{P}_{\\mathrm{E}CO_2} = 30\\,\\mathrm{mmHg}$\n\n将这些值代入推导出的公式中：\n$$V_D = 560 \\left( \\frac{44 - 30}{44} \\right)$$\n$$V_D = 560 \\left( \\frac{14}{44} \\right) = 560 \\left( \\frac{7}{22} \\right)$$\n$$V_D \\approx 178.1818... \\,\\mathrm{mL}$$\n问题要求答案四舍五入到三位有效数字。\n$$V_D = 178\\,\\mathrm{mL}$$\n\n为了进行解释，我们考虑死腔分数 $V_D/V_T$。\n$$\\frac{V_D}{V_T} = \\frac{P_{\\mathrm{a}CO_2} - \\bar{P}_{\\mathrm{E}CO_2}}{P_{\\mathrm{a}CO_2}} = \\frac{44 - 30}{44} = \\frac{14}{44} \\approx 0.318$$\n这个分数约为$32\\%$，代表了每次呼吸中不参与气体交换的部分。对于一个健康的静息年轻成年人，这个值通常在$20\\%$到$35\\%$之间。计算出的$32\\%$在此正常范围的上限附近。这表明通气与血流（$V/Q$）的匹配并非最佳，但未达到严重异常的程度。生理死腔的增加提示存在肺泡死腔，即一些肺泡有通气但灌注不足（高$V/Q$比值）。死腔的这种适度增加与该受试者动脉血$P_{\\mathrm{a}CO_2}$轻度升高至$44\\,\\mathrm{mmHg}$（典型正常值为$40\\,\\mathrm{mmHg}$）的情况相符，因为低效的气体交换需要代偿性地增加总通气量，否则将导致高碳酸血症。", "answer": "$$\\boxed{178}$$", "id": "2621283"}, {"introduction": "我们的最后一个实践将从静态分析跃升至生理控制系统的动态世界。您将实现一个单一肺单元的计算模型，该模型整合了缺氧性肺血管收缩和中枢化学感受器反射的反馈回路。这个高级仿真将揭示这些耦合机制如何产生振荡或双稳态等复杂行为，从而强调通气-灌注匹配是一个主动的、动态的过程，而非一个静态的状态。[@problem_id:2621257]", "problem": "要求您实现并分析一个最小化的、无量纲的单一代表性肺单元的通气-灌注匹配动力学模型，重点研究中枢通气控制和缺氧性肺血管收缩（HPV）之间的耦合如何在特定参数区间内产生振荡或双稳态的通气-灌注模式。您的程序必须模拟该模型，对每个参数集的模式进行分类，并按下文指定的方式将结果汇总为单行列表。\n\n模型应根据基本的质量平衡和控制原理构建如下。\n\n1. 变量及其含义（所有变量均为无量纲）：\n- $x(t)$ 是一个标准化的肺泡氧水平，代表肺泡氧分压或氧气分数的替代指标。\n- $c(t)$ 是一个标准化的肺泡二氧化碳水平，代表肺泡二氧化碳分压的替代指标。\n- $v(t)$ 是一个标准化的肺泡通气量。\n- $q(t)$ 是一个标准化的灌注量，它通过缺氧性肺血管收缩依赖于 $x(t)$。\n\n2. 基本原理和假设：\n- 呼吸气体的吸入/洗出质量平衡：根据 Fick 原理在隔室层面上的应用，肺泡隔室中气体的变化率等于流入减去流出再加上产生或消耗。\n- 吸入氧被建模为一个恒定的标准化输入 $x_{I}$。\n- 流入肺泡的二氧化碳由灌注携带，并与 $q(t)$ 成正比。\n- 中枢化学感受器反射控制驱动通气趋向一个目标，该目标随延迟的二氧化碳单调增加，这反映了已知的反馈和延迟效应。\n- 缺氧性肺血管收缩是 $q(t)$ 随 $x(t)$ 的单调增加（较低的 $x$ 导致较低的 $q$）。\n\n3. 模型方程：\n- 缺氧性肺血管收缩 (HPV)：\n$$\nq(t) \\;=\\; \\frac{1}{1 + \\exp\\!\\left(-k_{h}\\,\\big(x(t) - x_{50}\\big)\\right)}.\n$$\n- 使用静态非线性函数 $f$ 和固定延迟 $\\tau_{d}$ 的通气化学感受器反射设定点：\n$$\nf(c) \\;=\\; \\frac{1}{1 + \\exp\\!\\left(-k_{c}\\,\\big(c - c_{50}\\big)\\right)},\\qquad v_{\\text{set}}(t)\\;=\\; v_{\\text{base}} + G\\,f\\big(c(t-\\tau_{d})\\big).\n$$\n- 通气动力学（对设定点的一阶跟踪）：\n$$\n\\frac{dv}{dt} \\;=\\; \\frac{v_{\\text{set}}(t) - v(t)}{\\tau_{v}}.\n$$\n- 氧气平衡（通过通气流入，通过与灌注成比例的方式移除）：\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{v(t)\\,\\big(x_{I} - x(t)\\big)\\;-\\;\\beta\\, q(t)}{\\tau_{o}}.\n$$\n- 二氧化碳平衡（通过与灌注成比例的方式输送，通过通气移除）：\n$$\n\\frac{dc}{dt} \\;=\\; \\frac{\\sigma\\, q(t)\\;-\\; v(t)\\,c(t)}{\\tau_{c}}.\n$$\n\n4. 数值积分和延迟处理：\n- 使用显式前向欧拉法，以固定的时间步长 $\\Delta t = 0.01$，在总时长 $T = 200.0$（所有时间均为无量纲）内模拟这些方程。\n- 通过使用 $c(t)$ 的历史数据缓冲区来实现延迟 $\\tau_{d}$；假设在提供的测试套件中，$\\tau_{d}$ 始终是 $\\Delta t$ 的整数倍。对于 $t  \\tau_{d}$，延迟参数使用初始值 $c(0)$。\n- 在每一步，使用上述HPV函数，直接从当前的 $x(t)$ 计算 $q(t)$。\n- 保持 $v(t) \\ge 0$，$c(t) \\ge 0$，并通过在瞬态过程中需要时进行钳位，将 $x(t)$ 限制在一个合理范围（如 $[0, 1.5]$）内，以避免数值溢出。\n\n5. 关注量：\n- 计算通气-灌注比值的时间序列\n$$\nr(t) \\;=\\; \\frac{v(t)}{\\max\\!\\big(q(t),\\epsilon\\big)},\n$$\n其中使用一个小的下限值 $\\epsilon = 10^{-6}$ 来避免除以零。\n\n6. 初始条件：\n- 对每个参数集运行两次模拟，使用两种不同的初始条件来探查双稳态性：\n    - 初始条件A：$x(0)=0.10$, $c(0)=0.20$, $v(0)=0.10$。\n    - 初始条件B：$x(0)=0.90$, $c(0)=1.00$, $v(0)=1.50$。\n\n7. 每个参数集的分类规则：\n- 将分析窗口定义为模拟的最后 $40\\%$，即时间 $t \\in [0.6\\,T,\\, T]$。在此窗口内，令 $A$ 为 $r(t)$ 的最大值与最小值之差定义的振幅。\n- 使用离散判据 $r_{i-1}  r_{i}  r_{i+1}$ 计算窗口内 $r(t)$ 的局部最大值数量 $N_p$；为忽略伪最大值，要求每个计数的峰值在绝对值上至少比相邻值大 $\\delta = 0.02$。\n- 对每个初始条件，分别计算 $A$ 和 $N_p$。如果任一初始条件下有 $A \\ge 0.15$ 且 $N_{p} \\ge 5$，则将该参数集分类为振荡，并返回整数 $1$。\n- 否则，计算每个初始条件下模拟最后 $20\\%$（即 $t \\in [0.8\\,T,\\,T]$）的 $r(t)$ 平均值，记为 $\\bar{r}_{A}$ 和 $\\bar{r}_{B}$。如果 $\\lvert \\bar{r}_{A} - \\bar{r}_{B} \\rvert \\ge 0.20$，则分类为双稳态，并返回整数 $2$。\n- 如果以上两个条件都不满足，则分类为单一稳定不动点状态，并返回整数 $0$。\n\n8. 测试套件：\n对于下面的每个测试用例，您必须使用指定的参数进行模拟，应用上述分类规则，并按顺序汇总结果。所有参数均为无量纲。\n\n所有用例的通用参数：$x_{I}=1.00$, $\\Delta t = 0.01$, $T=200.0$, $\\epsilon=10^{-6}$。\n\n- 用例1（预期为稳定不动点）：\n    - $v_{\\text{base}}=0.20$, $G=0.80$, $\\tau_{v}=0.30$, $\\tau_{d}=0.00$,\n    - $\\beta=0.30$, $\\sigma=0.30$,\n    - $k_{h}=6.00$, $x_{50}=0.50$,\n    - $k_{c}=6.00$, $c_{50}=0.50$,\n    - $\\tau_{o}=1.00$, $\\tau_{c}=1.00$。\n- 用例2（预期因控制延迟和高增益而振荡）：\n    - $v_{\\text{base}}=0.05$, $G=5.00$, $\\tau_{v}=1.20$, $\\tau_{d}=4.00$,\n    - $\\beta=0.60$, $\\sigma=0.80$,\n    - $k_{h}=6.00$, $x_{50}=0.50$,\n    - $k_{c}=6.00$, $c_{50}=0.50$,\n    - $\\tau_{o}=1.00$, $\\tau_{c}=1.00$。\n- 用例3（预期因陡峭的HPV曲线和强的流-气耦合而双稳态，延迟最小）：\n    - $v_{\\text{base}}=0.02$, $G=0.50$, $\\tau_{v}=0.20$, $\\tau_{d}=0.00$,\n    - $\\beta=0.90$, $\\sigma=1.20$,\n    - $k_{h}=40.00$, $x_{50}=0.60$,\n    - $k_{c}=6.00$, $c_{50}=0.50$,\n    - $\\tau_{o}=1.00$, $\\tau_{c}=1.00$。\n\n9. 要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个含有三个整数的列表，每个整数对应一个用例的结果，按所给顺序排列，无空格，格式如下：\n\"[result_case1,result_case2,result_case3]\"。", "solution": "所提出的问题是计算系统生理学领域一个有效的练习。它要求对一个带有时延的耦合非线性常微分方程系统进行数值模拟，该系统代表了一个肺单元通气-灌注匹配的简化模型。该模型在科学上基于已确立的生理学原理，如质量平衡、缺氧性肺血管收缩（HPV）和中枢化学感受器反射控制。该问题是适定的，提供了所有必要的方程、参数、初始条件、数值方法，以及用于分类系统动力学行为的明确标准。它是客观且可形式化的。因此，将提供一个解法。\n\n问题的核心是求解以下延迟微分方程系统，并分析得到的时间序列。状态变量是标准化的肺泡氧水平 $x(t)$、二氧化碳水平 $c(t)$ 和通气量 $v(t)$。\n\n1. **模型方程**:\n    该系统由三个关于状态变量 $v(t)$、$x(t)$ 和 $c(t)$ 的一阶常微分方程以及一个关于灌注量 $q(t)$ 的代数方程描述。\n\n    -   通气动力学:\n        $$\n        \\frac{dv}{dt} \\;=\\; \\frac{v_{\\text{set}}(t) - v(t)}{\\tau_{v}}\n        $$\n    -   氧气平衡:\n        $$\n        \\frac{dx}{dt} \\;=\\; \\frac{v(t)\\,\\big(x_{I} - x(t)\\big) \\;-\\; \\beta\\, q(t)}{\\tau_{o}}\n        $$\n    -   二氧化碳平衡:\n        $$\n        \\frac{dc}{dt} \\;=\\; \\frac{\\sigma\\, q(t) \\;-\\; v(t)\\,c(t)}{\\tau_{c}}\n        $$\n\n2. **辅助代数和延迟关系**:\n    变量 $q(t)$ 和 $v_{\\text{set}}(t)$ 是状态变量的函数。\n\n    -   缺氧性肺血管收缩（HPV）将灌注量 $q(t)$ 决定为当前氧水平 $x(t)$ 的一个S型函数：\n        $$\n        q(t) \\;=\\; \\frac{1}{1 + \\exp\\!\\left(-k_{h}\\,\\big(x(t) - x_{50}\\big)\\right)}\n        $$\n    -   中枢化学感受器反射通气驱动 $v_{\\text{set}}(t)$ 由延迟的二氧化碳水平 $c(t-\\tau_{d})$ 决定：\n        $$\n        v_{\\text{set}}(t)\\;=\\; v_{\\text{base}} + G\\,f\\big(c(t-\\tau_{d})\\big), \\quad \\text{其中} \\quad f(c) \\;=\\; \\frac{1}{1 + \\exp\\!\\left(-k_{c}\\,\\big(c - c_{50}\\big)\\right)}\n        $$\n\n3. **数值离散化**:\n    我们采用显式前向欧拉法，固定时间步长为 $\\Delta t$。令时间 $t_i = i \\cdot \\Delta t$ 时的状态为 $(v_i, x_i, c_i)$。下一个时间步 $t_{i+1}$ 的状态计算如下：\n\n    -   首先，计算时间 $t_i$ 的辅助变量：\n        灌注量 $q_i$ 使用当前氧水平 $x_i$ 计算：\n        $$\n        q_i \\;=\\; \\frac{1}{1 + \\exp\\!\\left(-k_{h}\\,\\big(x_i - x_{50}\\big)\\right)}\n        $$\n        延迟的二氧化碳值 $c_{\\text{delayed}}$ 从历史数据缓冲区中获取。令延迟的离散步数为 $d = \\tau_d / \\Delta t$。对于 $i  d$，我们使用 $c_{\\text{delayed}} = c_0$。对于 $i \\ge d$，我们使用 $c_{\\text{delayed}} = c_{i-d}$。通气设定点 $v_{\\text{set}, i}$ 则为：\n        $$\n        v_{\\text{set}, i} \\;=\\; v_{\\text{base}} + G \\cdot \\frac{1}{1 + \\exp\\!\\left(-k_{c}\\,\\big(c_{\\text{delayed}} - c_{50}\\big)\\right)}\n        $$\n\n    -   接下来，对每个状态变量应用前向欧拉更新规则：\n        $$\n        v_{i+1} \\;=\\; v_i + \\Delta t \\cdot \\frac{v_{\\text{set}, i} - v_i}{\\tau_{v}}\n        $$\n        $$\n        x_{i+1} \\;=\\; x_i + \\Delta t \\cdot \\frac{v_i(x_I - x_i) - \\beta q_i}{\\tau_{o}}\n        $$\n        $$\n        c_{i+1} \\;=\\; c_i + \\Delta t \\cdot \\frac{\\sigma q_i - v_i c_i}{\\tau_{c}}\n        $$\n\n    -   最后，应用指定的约束以确保数值稳定性和物理合理性：\n        $$\n        v_{i+1} \\leftarrow \\max(0, v_{i+1})\n        $$\n        $$\n        c_{i+1} \\leftarrow \\max(0, c_{i+1})\n        $$\n        $$\n        x_{i+1} \\leftarrow \\text{clip}(x_{i+1}, 0, 1.5)\n        $$\n\n4. **模拟与分析流程**:\n    对于测试套件中提供的每个参数集，执行两次独立的模拟，分别从初始条件A（$x(0)=0.10, c(0)=0.20, v(0)=0.10$）和B（$x(0)=0.90, c(0)=1.00, v(0)=1.50$）开始。总模拟时间为 $T=200.0$，时间步长为 $\\Delta t=0.01$。\n\n    每次模拟后，计算通气-灌注比值的时间序列 $r(t)$：\n    $$\n    r(t) \\;=\\; \\frac{v(t)}{\\max\\!\\big(q(t),\\epsilon\\big)}\n    $$\n    其中 $\\epsilon = 10^{-6}$ 是一个小的常数，用于防止除以零。\n\n5. **动力学状态分类**:\n    系统的行为基于来自两次模拟（A和B）的 $r(t)$ 时间序列的属性进行分类。\n\n    -   **振荡 (1)**: 如果对于初始条件A或B中的任何一个，在时间窗口 $t \\in [0.6T, T]$ 内对 $r(t)$ 的分析同时满足振幅 $A = \\max(r) - \\min(r) \\ge 0.15$ 和峰值数量 $N_p \\ge 5$，则系统被分类为振荡。仅当一个局部最大值（$r_{j-1}  r_j  r_{j+1}$）是显著的，即其值超过其直接相邻值至少 $\\delta = 0.02$（即 $r_j - r_{j-1} \\ge \\delta$ 且 $r_j - r_{j+1} \\ge \\delta$）时，才被计数为峰值。\n\n    -   **双稳态 (2)**: 如果系统未被分类为振荡，则检查其双稳态性。对于每个初始条件，计算在模拟时间的最后 $20\\%$（$t \\in [0.8T, T]$）内 $r(t)$ 的平均值，记为 $\\bar{r}_A$ 和 $\\bar{r}_B$。如果这些平均值之间的绝对差足够大，即 $|\\bar{r}_A - \\bar{r}_B| \\ge 0.20$，则系统被分类为双稳态。\n\n    -   **稳定不动点 (0)**: 如果上述条件均不满足，则假定系统收敛到单一稳定不动点，无论初始条件如何，并如此分类。\n\n实现将精确遵循此逻辑，以确定三个测试用例中每个用例的分类。", "answer": "$$\\boxed{[0,1,2]}$$", "id": "2621257"}]}