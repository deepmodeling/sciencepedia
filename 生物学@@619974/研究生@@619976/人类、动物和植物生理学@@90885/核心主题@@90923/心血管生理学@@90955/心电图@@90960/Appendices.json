{"hands_on_practices": [{"introduction": "计算平均电轴（mean electrical axis, MEA）是心电图解读的基石。此练习将强化心脏电活动的向量概念，并提供一项基本诊断技能的直接实践。通过将原始测量数据（QRS 波群的振幅）转换为一个有临床意义的角度，您将学习如何将心室去极化的平均方向进行可视化，这是评估心室传导通路和识别心脏旋转或肥厚等异常的关键一步 [@problem_id:2615350]。", "problem": "一份标准的12导联心电图（electrocardiogram (ECG)）以纸速 $25\\,\\mathrm{mm\\,s^{-1}}$ 和校准电压 $10\\,\\mathrm{mm\\,mV^{-1}}$ 进行记录。在额平面上，您从肢体导联中提取的QRS波群净偏移（R波振幅的代数值减去Q波和S波振幅绝对值之和）如下：\n\n- I导联：相对于等电位基线的峰值振幅为，Q波在基线下方 $1.0\\,\\mathrm{mm}$，R波在基线上方 $11.0\\,\\mathrm{mm}$，S波在基线下方 $2.0\\,\\mathrm{mm}$。\n- aVF导联（左下肢加压导联）：相对于等电位基线的峰值振幅为，Q波为 $0.0\\,\\mathrm{mm}$，R波在基线上方 $3.0\\,\\mathrm{mm}$，S波在基线下方 $10.0\\,\\mathrm{mm}$。\n\n将额平面QRS平均电轴（mean electrical axis (MEA)）视为一个在QRS间期内的固定向量，其在各导联轴上的投影产生所测得的QRS净偏移。假设各导联的增益相等且响应线性，从而I导联和aVF导联之间的相对振幅得以保持。使用传统的六轴参考系统，其中I导联与 $0^\\circ$ 对齐，aVF导联与 $+90^\\circ$ 对齐，角度逆时针增加。\n\n任务：\n1. 通过I导联和aVF导联测得的净偏移推断向量方向，计算额平面上的MEA（单位为度）。根据所述规定标明角度的符号（正或负）。\n2. 使用普遍接受的阈值，将电轴分类为以下之一：正常（介于 $-30^\\circ$ 和 $+90^\\circ$ 之间）、电轴左偏（介于 $-30^\\circ$ 和 $-90^\\circ$ 之间）或电轴右偏（介于 $+90^\\circ$ 和 $+180^\\circ$ 之间）。如果角度超出这些范围，则记为电轴极度偏移。\n\n以度为单位表示MEA。将您的数值角度四舍五入至四位有效数字。为便于评分，请仅报告MEA角度作为最终数值答案。", "solution": "该问题要求根据心电图（ECG）数据计算并分类额平面QRS平均电轴（MEA）。\n\n首先，我们必须验证问题陈述的有效性。\n已知条件如下：\n- 纸速：$25\\,\\mathrm{mm\\,s^{-1}}$\n- 校准电压：$10\\,\\mathrm{mm\\,mV^{-1}}$\n- I导联偏移：$Q = 1.0\\,\\mathrm{mm}$, $R = 11.0\\,\\mathrm{mm}$, $S = 2.0\\,\\mathrm{mm}$\n- aVF导联偏移：$Q = 0.0\\,\\mathrm{mm}$, $R = 3.0\\,\\mathrm{mm}$, $S = 10.0\\,\\mathrm{mm}$\n- QRS净偏移的定义：R波振幅的代数值减去Q波和S波振幅的绝对值之和。\n- 坐标系：I导联轴位于 $0^\\circ$，aVF导联轴位于 $+90^\\circ$。\n- 任务：计算MEA（以度为单位）并对其进行分类。\n- 精度：将最终角度四舍五入至四位有效数字。\n\n该问题具有科学依据，因为它描述了确定心脏电轴的标准心向量图方法。所提供的值在生理上是合理的。该问题提法明确，内容完整，并提供了计算唯一角度解所需的所有信息。关于纸速和校准电压的信息，虽然对于计算角度（仅取决于偏移的比率）不是必需的，但并未造成矛盾，并且是心电图记录的标准背景数据。因此，该问题被认为是有效的。\n\n我们开始求解。\n\n步骤1：计算每个导联的QRS净偏移。净偏移，我们用 $V_{net}$ 表示，由基于 $Q$、$R$ 和 $S$ 波振幅的公式给出：\n$$V_{net} = R_{amp} - (|Q_{amp}| + |S_{amp}|)$$\n振幅以毫米（$\\text{mm}$）为单位。\n\n对于I导联：\n振幅为 $R_I = 11.0\\,\\mathrm{mm}$，$Q_I = 1.0\\,\\mathrm{mm}$ 和 $S_I = 2.0\\,\\mathrm{mm}$。\nI导联的净偏移 $V_I$ 为：\n$$V_I = 11.0 - (1.0 + 2.0) = 11.0 - 3.0 = 8.0\\,\\mathrm{mm}$$\n\n对于aVF导联：\n振幅为 $R_{aVF} = 3.0\\,\\mathrm{mm}$，$Q_{aVF} = 0.0\\,\\mathrm{mm}$ 和 $S_{aVF} = 10.0\\,\\mathrm{mm}$。\naVF导联的净偏移 $V_{aVF}$ 为：\n$$V_{aVF} = 3.0 - (0.0 + 10.0) = 3.0 - 10.0 = -7.0\\,\\mathrm{mm}$$\n\n步骤2：确定MEA向量的分量。\n问题陈述指出，可将MEA视为一个向量，其在导联轴上的投影对应于净偏移。传统的六轴参考系统将I导联轴置于 $0^\\circ$，将aVF导联轴置于 $+90^\\circ$。这种配置建立了一个标准的二维笛卡尔坐标系，其中MEA向量的x分量是I导联的净偏移，y分量是aVF导联的净偏移。\n设MEA向量为 $\\vec{M}$，其分量为 $(M_x, M_y)$。\n$$M_x = V_I = 8.0$$\n$$M_y = V_{aVF} = -7.0$$\n在此背景下，这些分量是无量纲的，因为我们只关心它们的比率以求得角度。毫米单位会相互抵消。\n\n步骤3：计算MEA向量的角度。\n具有分量 $(M_x, M_y)$ 的向量的角度 $\\theta$ 可以使用反正切函数求得。角度从正x轴（I导联轴）开始逆时针测量。\n$$\\theta = \\arctan\\left(\\frac{M_y}{M_x}\\right)$$\n代入分量值：\n$$\\theta = \\arctan\\left(\\frac{-7.0}{8.0}\\right) = \\arctan(-0.875)$$\n计算必须以度为单位进行：\n$$\\theta \\approx -41.185925...^\\circ$$\n问题要求四舍五入到四位有效数字。\n$$\\theta \\approx -41.19^\\circ$$\n该向量的x分量为正，y分量为负，因此位于第四象限，这与计算出的负角度一致。\n\n步骤4：对计算出的电轴进行分类。\n临床上接受的电轴分类范围如下：\n- 正常电轴：$-30^\\circ \\le \\theta \\le +90^\\circ$\n- 电轴左偏（LAD）：$-90^\\circ \\le \\theta < -30^\\circ$\n- 电轴右偏（RAD）：$+90^\\circ < \\theta \\le +180^\\circ$\n- 电轴极度偏移：超出上述范围（即 $-180^\\circ \\le \\theta < -90^\\circ$）\n\n计算出的MEA为 $\\theta \\approx -41.19^\\circ$。该值满足条件 $-90^\\circ \\le -41.19^\\circ < -30^\\circ$。\n因此，该电轴被分类为电轴左偏（LAD）。\n\n问题要求只将数值角度（以度为单位）作为最终答案。", "answer": "$$\\boxed{-41.19}$$", "id": "2615350"}, {"introduction": "心电图解读的准确性严重依赖于电极的正确放置。本练习探讨了一个常见的错误——肢体导联电极的错误对调——如何系统性地改变记录到的导联信号。通过从第一性原理出发，推导这种错误放置的后果，您将能更深刻地理解导联系统的生物物理基础，并学会识别一种能模拟严重病理状况（如心肌梗死）的关键诊断陷阱 [@problem_id:2615374]。", "problem": "一个三电极肢体系统记录额面心电图。设右臂、左臂和左腿电极处的瞬时电位分别表示为 $V_{R}(t)$、$V_{L}(t)$ 和 $V_{F}(t)$。标准肢体导联由电位差定义为 $L_{I}(t) = V_{L}(t) - V_{R}(t)$、$L_{II}(t) = V_{F}(t) - V_{R}(t)$ 和 $L_{III}(t) = V_{F}(t) - V_{L}(t)$，而加压肢体导联使用 Wilson 中心电端 $V_{W}(t) = \\left(V_{R}(t)+V_{L}(t)+V_{F}(t)\\right)/3$ 定义为 $aVR(t) = V_{R}(t) - V_{W}(t)$、$aVL(t) = V_{L}(t) - V_{W}(t)$ 和 $aVF(t) = V_{F}(t) - V_{W}(t)$。假设额面内的平均 QRS 向量具有恒定的幅值 $A > 0$ 和真实电轴 $\\theta$（以度为单位），其中 $0^\\circ$ 沿 I 导联正方向测量，$+90^\\circ$ 指向下方。在额面的常规线性向量模型下，平均 QRS 向量在三个标准肢体导联轴上的投影为 $L_{I} = A \\cos(\\theta)$、$L_{II} = A \\cos(\\theta - 60^\\circ)$ 和 $L_{III} = A \\cos(\\theta - 120^\\circ)$，这与 Einthoven 法则一致。\n现在假设右臂和左腿电极在皮肤上被意外互换（右臂电极放置在左腿位置，左腿电极放置在右臂位置），而左臂电极位置仍然正确。一位未意识到此互换的解读人员，使用此错误连接记录中测得的 $L_{I}$ 和 $aVF$ 值，通过常规笛卡尔方法来推断平均额面 QRS 电轴。该方法将 $L_{I}$ 和 $aVF$ 的测量值分别视为平均 QRS 向量的水平和垂直分量的比例，并将电轴确定为相应的极角。\n仅使用上述核心定义以及 Wilson 中心电端是三个肢体电位平均值的假设，首先推导右臂-左腿互换对测量的肢体导联和加压肢体导联的代数效应，用真实的 $L_{I}$ 和 $L_{II}$ 表示。然后，对于一颗真实额面平均 QRS 电轴为 $\\theta = 30^\\circ$ 且幅值 $A>0$ 为任意值的心脏，计算解读人员根据错误连接的 $L_{I}$ 和 $aVF$ 会报告的表观平均额面 QRS 电轴的单一数值（以度为单位）。使用区间 $[-180^\\circ, 180^\\circ)$ 内的常规主值。用度数表达你的最终答案。\n在你的推导过程中，指出在解读错误连接的描记图中的心律和电轴时，这种特定的电极互换可能导致的主要诊断陷阱。最终答案必须仅为单一的角度值。", "solution": "所陈述的问题具有科学依据、提法恰当、客观且内部一致。它描述了心电图学中电极错位的物理真实情景，并提供了推导唯一解所需的所有形式化定义。该问题是有效的。\n\n问题的核心是确定电极互换对测得的心电图 (ECG) 导联的定量效应，以及由此导致的对心脏电轴的误读。设右臂、左臂和左腿的真实生理电位分别为 $V_{R}$、$V_{L}$ 和 $V_{F}$。问题陈述指明右臂 (RA) 和左腿 (LL) 电极发生互换。这意味着心电图机在其 RA 输入端测得的电位实际上是 $V_{F}$，而在其 LL 输入端测得的电位实际上是 $V_{R}$。左臂 (LA) 电极位置正确。\n\n设在机器输入端测得的电位用一撇表示：\n$V'_{R} = V_{F}$\n$V'_{L} = V_{L}$\n$V'_{F} = V_{R}$\n\n机器根据这些互换后的输入电位计算标准导联和加压导联。我们推导这些测得的导联（用一撇表示）相对于真实导联的表达式。\n\n真实的标准肢体导联定义为：\n$L_{I} = V_{L} - V_{R}$\n$L_{II} = V_{F} - V_{R}$\n$L_{III} = V_{F} - V_{L}$\n根据这些定义，可以直接得出 Einthoven 法则，$L_{I} + L_{III} = L_{II}$。我们可以将 $L_{III}$ 表示为 $L_{III} = L_{II} - L_{I}$。\n\n测得的标准导联是：\n$L'_{I} = V'_{L} - V'_{R} = V_{L} - V_{F} = -(V_{F} - V_{L}) = -L_{III}$。\n使用 Einthoven 法则，这变为 $L'_{I} = -(L_{II} - L_{I}) = L_{I} - L_{II}$。\n$L'_{II} = V'_{F} - V'_{R} = V_{R} - V_{F} = -(V_{F} - V_{R}) = -L_{II}$。\n$L'_{III} = V'_{F} - V'_{L} = V_{R} - V_{L} = -(V_{L} - V_{R}) = -L_{I}$。\n\n接下来，我们推导测得的加压导联的表达式。首先，我们考察 Wilson 中心电端，其定义为 $V_{W} = \\frac{1}{3}(V_{R} + V_{L} + V_{F})$。机器计算出一个测得的中心电端 $V'_{W}$：\n$V'_{W} = \\frac{1}{3}(V'_{R} + V'_{L} + V'_{F}) = \\frac{1}{3}(V_{F} + V_{L} + V_{R}) = V_{W}$。\nWilson 中心电端在肢体电位的任何排列下都是不变的。\n\n真实的加压导联是：\n$aVR = V_{R} - V_{W}$\n$aVL = V_{L} - V_{W}$\n$aVF = V_{F} - V_{W}$\n\n测得的加压导联是：\n$aVR' = V'_{R} - V'_{W} = V_{F} - V_{W} = aVF$。\n$aVL' = V'_{L} - V'_{W} = V_{L} - V_{W} = aVL$。\n$aVF' = V'_{F} - V'_{W} = V_{R} - V_{W} = aVR$。\nRA 和 LL 电极的这次互换导致测得的导联 $aVR'$ 和 $aVF'$ 是真实 $aVF$ 和 $aVR$ 的互换版本，而 $aVL$ 不受影响。\n\n问题陈述指出，一位未意识到此互换的解读人员使用测得的 $L'_{I}$ 和 $aVF'$ 来确定平均 QRS 电轴。解读人员将 $L'_{I}$ 视为心脏向量的水平分量（$x$ 轴），将 $aVF'$ 视为垂直分量（$y$ 轴）。为了计算表观电轴，我们必须用真实的基本导联 $L_{I}$ 和 $L_{II}$ 来表示 $L'_{I}$ 和 $aVF'$。\n\n我们已经有 $L'_{I} = L_{I} - L_{II}$。对于 $aVF'$，我们有 $aVF' = aVR$。我们必须使用所提供的 $V_W$ 定义，用 $L_I$ 和 $L_{II}$ 来表示真实的 $aVR$。\n$aVR = V_{R} - V_{W} = V_{R} - \\frac{1}{3}(V_{R} + V_{L} + V_{F})$\n为了用 $L_{I}$、$L_{II}$ 和 $V_R$ 表示 $V_{L}$ 和 $V_{F}$，我们使用：\n$V_{L} = L_{I} + V_{R}$\n$V_{F} = L_{II} + V_{R}$\n将这些代入 $aVR$ 的表达式中：\n$aVR = V_{R} - \\frac{1}{3}(V_{R} + (L_{I} + V_{R}) + (L_{II} + V_{R}))$\n$aVR = V_{R} - \\frac{1}{3}(3V_{R} + L_{I} + L_{II}) = V_{R} - V_{R} - \\frac{1}{3}(L_{I} + L_{II})$\n$aVR = -\\frac{1}{3}(L_{I} + L_{II})$\n\n所以，解读人员使用的向量分量与以下成正比：\n水平分量: $x \\propto L'_{I} = L_{I} - L_{II}$\n垂直分量: $y \\propto aVF' = aVR = -\\frac{1}{3}(L_{I} + L_{II})$\n\n现在，我们为真实平均 QRS 电轴 $\\theta = 30^\\circ$ 计算这些值。在标准肢体导联轴上的投影由下式给出：\n$L_{I} = A \\cos(\\theta) = A \\cos(30^\\circ) = A \\frac{\\sqrt{3}}{2}$\n$L_{II} = A \\cos(\\theta - 60^\\circ) = A \\cos(30^\\circ - 60^\\circ) = A \\cos(-30^\\circ) = A \\frac{\\sqrt{3}}{2}$\n\n将这些代入我们测得的分量的表达式中：\n$x \\propto L'_{I} = A \\frac{\\sqrt{3}}{2} - A \\frac{\\sqrt{3}}{2} = 0$\n$y \\propto aVF' = -\\frac{1}{3}\\left(A \\frac{\\sqrt{3}}{2} + A \\frac{\\sqrt{3}}{2}\\right) = -\\frac{1}{3}(A\\sqrt{3}) = -A\\frac{\\sqrt{3}}{3}$\n\n解读人员将表观电轴 $\\theta_{app}$ 确定为与向量 $(x, y)$ 对应的极角。该向量的水平分量为 $0$，垂直分量为负（因为 $A>0$）。在标准额面心电图电轴系统中，水平轴对应于 I 导联（$0^\\circ$），垂直轴对应于 aVF 导联（$+90^\\circ$ 指向下方）。aVF 轴上的正值对应于向下的方向。我们计算出的垂直分量 $y$ 是负值，这意味着向量分量指向上方。一个水平分量为零且垂直分量向上的向量直接指向负 aVF 轴方向。负 aVF 轴的方向是 $+90^\\circ - 180^\\circ = -90^\\circ$。\n\n因此，表观平均额面 QRS 电轴是 $-90^\\circ$。\n\n由此错误产生的诊断陷阱是严重的。一个真实的 $+30^\\circ$ 正常电轴被误读为 $-90^\\circ$ 的极度电轴偏移。更危险的是，这种特定的互换可以模仿完全性下壁心肌梗死的表现。一个电轴为 $+30^\\circ$ 的正常心脏在 II、III 和 aVF 导联中具有正向 QRS 波群。根据我们的推导，测得的导联为 $L'_{II} = -L_{II}$、$L'_{III} = -L_{I}$ 和 $aVF' = aVR$。对于正常电轴，真实的 $L_I$ 和 $L_{II}$ 是正的，真实的 $aVR$ 是负的。因此，解读人员在标记为“II”、“III”和“aVF”的导联中看到负向 QRS 波群。这种模式是下壁梗死的经典特征。此外，真实的 $aVF$ 是正的，但它被记录在“aVR”通道中（$aVR' = aVF$）。在标记为“aVR”的导联中出现直立的 P 波和 QRS 波群是这种电极反接（或右位心）的一个高度特异性的线索，它的出现应立即触发对电极放置的检查。忽视这一线索会导致严重的诊断错误。", "answer": "$$\\boxed{-90}$$", "id": "2615374"}, {"introduction": "鉴别室性心动过速（Ventricular Tachycardia, VT）与伴有差异性传导的室上性心动过速（Supraventricular Tachycardia, SVT）是一项极具挑战性但至关重要的诊断任务。这项高级实践超越了定性的模式识别，采用了一种定量的、基于概率的方法。您将通过实现一个朴素贝叶斯分类器，利用多个心电图特征的诊断似然比（likelihood ratio）进行整合，从而计算出 VT 的后验概率，这展示了如何运用贝叶斯推理原理来创建客观且可复现的诊断算法 [@problem_id:2615327]。", "problem": "您的任务是设计并实现一个基于特定原理的二元分类器，该分类器利用一组具有诊断相关性的标准的似然比 (LRs)，在体表心电图 (ECG) 上区分伴有差异性传导的室上性心动过速 (SVT) 和室性心动过速 (VT)。该分类器必须从第一性原理出发，使用赔率形式的贝叶斯定理以及在给定诊断的情况下各标准条件独立的假设来进行论证。程序必须计算 VT 的后验概率，然后应用一个概率阈值来提供决策规则。\n\n使用的基本原理：\n- 赔率形式的贝叶斯定理：如果 $H$ 是室性心动过速 (VT) 的假设，$E$ 是观测到的证据，那么后验赔率满足\n$$\n\\text{odds}(H \\mid E) = \\text{odds}(H) \\times \\prod_{i=1}^{n} \\text{LR}_{i},\n$$\n其中 $\\text{odds}(H) = \\dfrac{P(H)}{1 - P(H)}$，而 $\\text{LR}_{i}$ 是第 $i$ 个标准的似然比。后验概率可通过赔率恢复，公式如下：\n$$\nP(H \\mid E) = \\dfrac{\\text{odds}(H \\mid E)}{1 + \\text{odds}(H \\mid E)}.\n$$\n- 似然比定义：对于一个二元标准，当特征存在时，$\\text{LR}_{+} = \\dfrac{\\text{敏感性}}{1-\\text{特异性}}$；当特征不存在时，$\\text{LR}_{-} = \\dfrac{1-\\text{敏感性}}{\\text{特异性}}$。在本任务中，您将使用提供的 $\\text{LR}_{+}$ 和 $\\text{LR}_{-}$ 值，这些值是合理的且与临床文献一致。\n\n假设与设计约束：\n- 对于给定的真实心律（SVT 与 VT），使用朴素条件独立性假设。\n- 将以下标准视为具有已量化似然比的二元特征。对于每个标准，如果存在则使用 $\\text{LR}_{+}$，如果不存在则使用 $\\text{LR}_{-}$：\n  - 房室分离存在：$\\text{LR}_{+} = 20.0$，$\\text{LR}_{-} = 0.7$。\n  - 夺获或融合波存在：$\\text{LR}_{+} = 15.0$，$\\text{LR}_{-} = 0.85$。\n  - 胸前导联 QRS 波群同向性存在：$\\text{LR}_{+} = 18.0$，$\\text{LR}_{-} = 0.9$。\n  - aVR 导联初始 R 波存在：$\\text{LR}_{+} = 13.0$，$\\text{LR}_{-} = 0.8$。\n  - 额面电轴极度偏移（介于 $-180$ 度和 $-90$ 度之间，包含边界）存在：$\\text{LR}_{+} = 9.0$，$\\text{LR}_{-} = 0.6$。角度单位为度。\n  - QRS 波群时限极宽（至少 $160$ 毫秒）存在：$\\text{LR}_{+} = 4.0$，$\\text{LR}_{-} = 0.8$。时限单位为毫秒。\n  - 结构性心脏病史存在：$\\text{LR}_{+} = 2.5$，$\\text{LR}_{-} = 0.7$。\n- VT 的先验概率 $P(\\text{VT})$ 以介于 0 和 1 之间（不含两端）的小数形式为每个案例提供。\n- 分类规则：如果 $P(\\text{VT} \\mid \\text{证据}) \\ge 0.5$，则分类为 VT；否则分类为伴有差异性传导的 SVT。此阈值对应于后验赔率至少为 $1$。\n\n需实现的特征提取规则：\n- 如果额面电轴 $\\theta$ 满足 $\\theta \\in [-180,-90]$ 度，则极度电轴偏移特征存在；否则该特征不存在。角度单位为度。\n- 如果 QRS 波群时限 $d$ 满足 $d \\ge 160$ 毫秒，则 QRS 波群极宽特征存在；否则该特征不存在。时限单位为毫秒。\n\n计算要求：\n- 使用提供的似然比以乘法方式实现赔率更新。为保证数值稳定性，可以在对数赔率域中进行计算，即对 $\\log(\\text{LR}_{i})$ 求和，然后通过 logistic 变换 $P = 1/(1 + e^{-\\log\\text{odds}})$ 映射回来。\n- 对于每个测试案例，计算后验概率 $P(\\text{VT} \\mid \\text{证据})$，并四舍五入到三位小数用于报告。\n\n测试套件：\n每个测试案例是一个元组，包含以下有序字段：\n$(P(\\text{VT}), \\text{QRS 时限（毫秒）}, \\text{电轴（度）}, \\text{房室分离}, \\text{夺获/融合波}, \\text{胸前导联同向性}, \\text{aVR 初始 R 波}, \\text{结构性心脏病史})$，其中最后五个条目是布尔值。\n\n按所列顺序为以下案例提供结果：\n- 案例 A: $(0.5, 180, -120, \\text{True}, \\text{False}, \\text{True}, \\text{True}, \\text{True})$。\n- 案例 B: $(0.5, 130, 30, \\text{False}, \\text{False}, \\text{False}, \\text{False}, \\text{False})$。\n- 案例 C: $(0.2, 170, -100, \\text{False}, \\text{False}, \\text{False}, \\text{True}, \\text{True})$。\n- 案例 D: $(0.8, 140, -60, \\text{False}, \\text{False}, \\text{False}, \\text{False}, \\text{True})$。\n- 案例 E: $(0.5, 160, -90, \\text{False}, \\text{False}, \\text{False}, \\text{False}, \\text{False})$。\n- 案例 F: $(0.01, 180, -150, \\text{True}, \\text{True}, \\text{False}, \\text{True}, \\text{False})$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素是对应案例（从 A 到 F）的 VT 后验概率，每个概率值四舍五入到小数点后三位。例如，输出应类似于 $[0.500,0.750,0.250, \\dots]$，小数点后恰好有三位数字。", "solution": "该问题陈述已经过严格验证，并被证实是有效的。它在科学上基于贝叶斯推断原理及其在医学诊断——特别是心电图判读中的应用。该问题定义明确，提供了所有必要的数据、参数、定义和清晰的目标。不存在矛盾、歧义或事实错误。任务是实现一个朴素贝叶斯分类器，根据一组预定义的心电图和临床标准，区分室性心动过速 (VT) 和伴有差异性传导的室上性心动过速 (SVT)。\n\n该分类器的理论基础是赔率形式的贝叶斯定理。设 $H$ 为心律是 VT 的假设。设 $E$ 代表收集到的证据，由一组 $n$ 个发现或标准组成，$E = \\{e_1, e_2, \\dots, e_n\\}$。给定证据时 VT 的后验赔率与先验赔率通过每条证据的似然比的乘积相关联：\n$$\n\\text{odds}(H \\mid E) = \\text{odds}(H) \\times \\prod_{i=1}^{n} \\text{LR}(e_i)\n$$\n该公式依赖于一个关键假设，即在给定真实诊断 $H$ 的情况下，各标准 $e_i$ 是条件独立的。先验赔率由先验概率 $P(H)$ 计算得出，后者是相关患者群体中 VT 的估计患病率，计算公式为 $\\text{odds}(H) = \\frac{P(H)}{1 - P(H)}$。\n\n每个标准 $e_i$ 都是一个二元特征，即存在或不存在。似然比 $\\text{LR}(e_i)$ 取两个值之一：如果第 $i$ 个特征存在，则为 $\\text{LR}_{i,+}$；如果不存在，则为 $\\text{LR}_{i,-}$。对于 $n=7$ 个标准中的每一个，$\\text{LR}_{i,+}$ 和 $\\text{LR}_{i,-}$ 的值是给定且固定的：\n1.  房室 (AV) 分离：$\\text{LR}_{+} = 20.0$，$\\text{LR}_{-} = 0.7$。\n2.  夺获或融合波：$\\text{LR}_{+} = 15.0$，$\\text{LR}_{-} = 0.85$。\n3.  胸前导联 QRS 波群同向性：$\\text{LR}_{+} = 18.0$，$\\text{LR}_{-} = 0.9$。\n4.  aVR 导联初始 R 波：$\\text{LR}_{+} = 13.0$，$\\text{LR}_{-} = 0.8$。\n5.  额面电轴极度偏移：$\\text{LR}_{+} = 9.0$，$\\text{LR}_{-} = 0.6$。如果电轴 $\\theta$ 在 $[-180, -90]$ 度范围内，则此特征存在。\n6.  QRS 波群时限极宽：$\\text{LR}_{+} = 4.0$，$\\text{LR}_{-} = 0.8$。如果 QRS 时限 $d \\ge 160$ 毫秒，则此特征存在。\n7.  结构性心脏病 (SHD) 病史：$\\text{LR}_{+} = 2.5$，$\\text{LR}_{-} = 0.7$。\n\n一旦计算出后验赔率 $\\text{odds}(H \\mid E)$，就使用 logistic 函数将其转换回后验概率：\n$$\nP(H \\mid E) = \\frac{\\text{odds}(H \\mid E)}{1 + \\text{odds}(H \\mid E)}\n$$\n对于极大或极小的赔率，为了保证数值稳定性，计算可以在对数赔率域中执行，此时乘法变为加法：$\\log(\\text{odds}_{\\text{posterior}}) = \\log(\\text{odds}_{\\text{prior}}) + \\sum_{i} \\log(\\text{LR}_i)$。然后最终概率可恢复为 $P(H \\mid E) = (1 + \\exp(-\\log(\\text{odds}_{\\text{posterior}})))^{-1}$。对于给定的参数，标准的浮点数运算就足够了。\n\n为每个测试案例实现的算法如下：\n1.  接收输入元组，其中包括 VT 的先验概率 $P(\\text{VT})$ 和七个诊断标准的值。\n2.  计算先验赔率：$\\text{odds}_{\\text{prior}} = P(\\text{VT}) / (1 - P(\\text{VT}))$。\n3.  初始化一个总似然比乘数 $L$ 为 $1.0$。\n4.  对于七个标准中的每一个，根据输入数据和指定规则（针对 QRS 时限和电轴）判断特征是否存在。\n5.  将 $L$ 乘以该标准对应的 $\\text{LR}_{+}$ 或 $\\text{LR}_{-}$。\n6.  计算后验赔率：$\\text{odds}_{\\text{posterior}} = \\text{odds}_{\\text{prior}} \\times L$。\n7.  计算最终后验概率：$P(\\text{VT} \\mid E) = \\text{odds}_{\\text{posterior}} / (1 + \\text{odds}_{\\text{posterior}})$。\n8.  每个案例的结果就是这个概率，报告时必须四舍五入到三位小数。\n\n作为一个说明性示例，我们计算案例 A 的结果：\n- 输入：$(P(\\text{VT})=0.5, \\text{QRS}=180, \\text{axis}=-120, \\text{AV diss}=\\text{True}, \\text{cap/fus}=\\text{False}, \\text{concord}=\\text{True}, \\text{R in aVR}=\\text{True}, \\text{SHD}=\\text{True})$。\n- 先验赔率：$\\text{odds}_{\\text{prior}} = 0.5 / (1-0.5) = 1.0$。\n- 特征评估和 LR 选择：\n    - QRS 时限 $180 \\ge 160$：存在，$\\text{LR} = 4.0$。\n    - 电轴 $-120 \\in [-180, -90]$：存在，$\\text{LR} = 9.0$。\n    - 房室分离：存在，$\\text{LR} = 20.0$。\n    - 夺获/融合波：不存在，$\\text{LR} = 0.85$。\n    - 胸前导联同向性：存在，$\\text{LR} = 18.0$。\n    - aVR 初始 R 波：存在，$\\text{LR} = 13.0$。\n    - 结构性心脏病史：存在，$\\text{LR} = 2.5$。\n- 总 LR 乘积：$L = 4.0 \\times 9.0 \\times 20.0 \\times 0.85 \\times 18.0 \\times 13.0 \\times 2.5 = 358020$。\n- 后验赔率：$\\text{odds}_{\\text{posterior}} = 1.0 \\times 358020 = 358020$。\n- 后验概率：$P(\\text{VT} \\mid E) = 358020 / (1 + 358020) \\approx 0.9999972...$。\n- 四舍五入到三位小数，结果是 $1.000$。\n\n对所有指定的测试案例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a Naive Bayes classifier to compute the posterior probability of\n    Ventricular Tachycardia (VT) based on ECG and clinical criteria.\n    \"\"\"\n\n    # Define Likelihood Ratios (LR+, LR-) for each criterion pointing towards VT.\n    likelihood_ratios = {\n        'av_dissociation': (20.0, 0.7),\n        'capture_fusion': (15.0, 0.85),\n        'precordial_concordance': (18.0, 0.9),\n        'initial_r_in_avr': (13.0, 0.8),\n        'extreme_axis': (9.0, 0.6),\n        'wide_qrs': (4.0, 0.8),\n        'structural_heart_disease': (2.5, 0.7)\n    }\n\n    # Define the test cases from the problem statement.\n    # Format: (P(VT), QRS_ms, axis_deg, AV_diss, cap/fus, concord, r_avr, shd)\n    test_cases = [\n        # Case A\n        (0.5, 180, -120, True, False, True, True, True),\n        # Case B\n        (0.5, 130, 30, False, False, False, False, False),\n        # Case C\n        (0.2, 170, -100, False, False, False, True, True),\n        # Case D\n        (0.8, 140, -60, False, False, False, False, True),\n        # Case E\n        (0.5, 160, -90, False, False, False, False, False),\n        # Case F\n        (0.01, 180, -150, True, True, False, True, False)\n    ]\n\n    results = []\n    for case in test_cases:\n        p_vt_prior, qrs_duration, axis, av_diss, cap_fus, concordance, r_avr, shd = case\n\n        # Step 1: Calculate prior odds of VT\n        # We must handle the edge case of P(VT)=1, although problem says exclusive of 0 and 1.\n        if p_vt_prior == 1.0:\n            prior_odds = np.inf\n        else:\n            prior_odds = p_vt_prior / (1.0 - p_vt_prior)\n\n        # Step 2: Calculate the total likelihood ratio product\n        total_lr = 1.0\n\n        # Very wide QRS (>= 160 ms)\n        lr_plus, lr_minus = likelihood_ratios['wide_qrs']\n        total_lr *= lr_plus if qrs_duration >= 160 else lr_minus\n\n        # Extreme frontal plane axis ([-180, -90] degrees)\n        lr_plus, lr_minus = likelihood_ratios['extreme_axis']\n        total_lr *= lr_plus if -180 <= axis <= -90 else lr_minus\n        \n        # Atrioventricular dissociation\n        lr_plus, lr_minus = likelihood_ratios['av_dissociation']\n        total_lr *= lr_plus if av_diss else lr_minus\n\n        # Capture or fusion beats\n        lr_plus, lr_minus = likelihood_ratios['capture_fusion']\n        total_lr *= lr_plus if cap_fus else lr_minus\n\n        # Precordial QRS concordance\n        lr_plus, lr_minus = likelihood_ratios['precordial_concordance']\n        total_lr *= lr_plus if concordance else lr_minus\n\n        # Initial R wave in lead aVR\n        lr_plus, lr_minus = likelihood_ratios['initial_r_in_avr']\n        total_lr *= lr_plus if r_avr else lr_minus\n\n        # History of structural heart disease\n        lr_plus, lr_minus = likelihood_ratios['structural_heart_disease']\n        total_lr *= lr_plus if shd else lr_minus\n\n        # Step 3: Calculate posterior odds\n        posterior_odds = prior_odds * total_lr\n\n        # Step 4: Convert posterior odds to posterior probability\n        if np.isinf(posterior_odds):\n            posterior_prob = 1.0\n        else:\n            posterior_prob = posterior_odds / (1.0 + posterior_odds)\n            \n        results.append(posterior_prob)\n\n    # Final print statement in the exact required format.\n    # Each probability is formatted to exactly three decimal places.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2615327"}]}