{"hands_on_practices": [{"introduction": "这项实践利用经典的漏泄整合-发放（leaky integrate-and-fire）模型，为理解神经元兴奋性提供了基础。通过推导刺激强度和持续时间之间的关系，你将计算出两个关键的兴奋性度量指标：基电流（$I_r$）和时值（$t_c$）。本练习旨在建立膜的电阻（$R_m$）和电容（$C_m$）等基本生物物理特性与其宏观功能后果之间的桥梁，为神经元如何响应输入提供了定量的基础 [@problem_id:2570314]。", "problem": "一个神经元膜被建模为一个漏电阻-电容 (RC) 元件，等效于一个膜电阻为 $R_{m}$ 的电阻器与一个膜电容为 $C_{m}$ 的电容器并联。在时间 $t=0$ 时，注入一个幅度为 $I$、持续时间为 $t_{p}$ 的矩形去极化电流脉冲。相对于静息电位，膜电位 $V(t)$ 在 $0 \\le t \\le t_{p}$ 期间遵循一阶线性膜方程 $C_{m}\\,\\frac{dV}{dt}+\\frac{V}{R_{m}}=I$，且初始条件为 $V(0)=0$。如果 $V(t_{p})$ 达到一个固定的阈值偏转 $\\Delta V_{\\text{th}}$，神经元就会发放一个动作电位。\n\n仅从这些前提出发，完成以下任务：\n\n1) 导出一个为达到 $V(t_{p})=\\Delta V_{\\text{th}}$ 所需的最小阈值电流幅度 $I_{\\text{th}}(t_{p})$ 的显式表达式，该表达式应是脉冲持续时间 $t_{p}$ 和膜时间常数 $\\tau_{m}=R_{m}C_{m}$ 的函数。\n\n2) 根据你的表达式，将基电流 $I_{r}$ 定义为极长脉冲下的渐近阈值，将时值 $t_{c}$ 定义为阈值电流等于两倍基电流时的脉冲持续时间。用基本参数 $R_{m}$、$C_{m}$ 和 $\\Delta V_{\\text{th}}$ 表示 $I_{r}$ 和 $t_{c}$。\n\n3) 在对该神经元进行的无电压钳制刺激实验中，测得矩形脉冲的阈值电流为 $I_{\\text{th}}(t_{p}=1.00\\,\\mathrm{ms})=20.0\\,\\mu\\mathrm{A}$ 和 $I_{\\text{th}}(t_{p}=3.00\\,\\mathrm{ms})=11.43\\,\\mu\\mathrm{A}$。使用你导出的强度-时程关系来估计 $I_{r}$ 和 $\\tau_{m}$，然后计算时值 $t_{c}$。\n\n4) 简要解释 $I_{r}$ 和 $t_{c}$ 在 $R_{m}$ 和 $C_{m}$ 方面的生物物理意义，阐明 $R_{m}$ 或 $C_{m}$ 的变化将如何体现在这些兴奋性指标中。\n\n仅报告第 (3) 部分中时值 $t_{c}$ 的数值，单位为毫秒，四舍五入至三位有效数字。不要在最终的方框答案中包含单位。", "solution": "在尝试任何解答之前，将对问题进行验证。\n\n### 步骤 1：提取已知条件\n问题陈述中提供的明确信息如下：\n- **模型**：神经元膜作为并联RC电路，具有膜电阻 $R_{m}$ 和膜电容 $C_{m}$。\n- **输入刺激**：一个幅度为 $I$、持续时间为 $t_{p}$ 的矩形电流脉冲，于时间 $t=0$ 注入。\n- **控制方程**：相对于静息电位，膜电位 $V(t)$ 在区间 $0 \\le t \\le t_{p}$ 内遵循微分方程 $C_{m}\\,\\frac{dV}{dt}+\\frac{V}{R_{m}}=I$。\n- **初始条件**：$V(0)=0$。\n- **发放阈值条件**：如果 $V(t_{p})$ 达到一个固定的阈值偏转，即 $V(t_{p})=\\Delta V_{\\text{th}}$，则发放一个动作电位。\n- **定义**：\n    - 膜时间常数：$\\tau_{m}=R_{m}C_{m}$。\n    - 基电流 $I_{r}$：极长脉冲的渐近阈值电流，$I_{r} = \\lim_{t_p \\to \\infty} I_{\\text{th}}(t_{p})$。\n    - 时值 $t_{c}$：阈值电流等于两倍基电流时的脉冲持续时间，即 $I_{\\text{th}}(t_{c})=2I_{r}$。\n- **实验数据**：\n    - $I_{\\text{th}}(t_{p}=1.00\\,\\mathrm{ms})=20.0\\,\\mu\\mathrm{A}$。\n    - $I_{\\text{th}}(t_{p}=3.00\\,\\mathrm{ms})=11.43\\,\\mu\\mathrm{A}$。\n- **要求输出**：报告第 (3) 部分的时值 $t_{c}$ 的数值，单位为毫秒，四舍五入至三位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题使用了漏积分-发放模型，这是计算神经科学和生物物理学中一个典型且基础稳固的模型。控制方程是 Kirchhoff 电路定律的直接应用。这在科学上是成立的。\n- **适定性**：该问题描述了一个带常数强迫项和指定初始条件的一阶线性常微分方程。该系统是适定的，并有唯一解。基电流和时值的定义是标准且明确的。任务在数学上是明确定义的。\n- **客观性**：问题以精确、量化和客观的语言陈述。没有主观或基于意见的论断。\n- **完整性和一致性**：问题提供了进行所需推导和计算的所有必要方程、初始条件、定义和数据。其设定是内部一致的。\n\n### 步骤 3：结论与行动\n问题陈述在科学上是合理的、适定的和完整的。它被判定为**有效**。现在将提供一个严谨的解答。\n\n---\n\n**1) 强度-时程关系的推导**\n\n我们从给定的膜电位 $V(t)$ 的微分方程开始：\n$$C_{m}\\,\\frac{dV}{dt}+\\frac{V}{R_{m}}=I$$\n该方程在电流脉冲的持续时间内有效，即 $0 \\le t \\le t_{p}$。我们两边同除以 $C_{m}$ 并引入膜时间常数 $\\tau_{m} = R_{m}C_{m}$：\n$$\\frac{dV}{dt}+\\frac{V}{\\tau_{m}}=\\frac{I}{C_{m}}$$\n这是一个一阶线性常微分方程。其齐次解为 $V_h(t) = A\\exp(-t/\\tau_m)$。对于常数强迫项，一个特解是稳态电压 $V_{ss}$，可以通过设置 $\\frac{dV}{dt}=0$ 求得：\n$$\\frac{V_{ss}}{R_{m}} = I \\implies V_{ss} = I R_m$$\n通解是齐次解与特解之和：\n$$V(t) = I R_{m} + A\\exp\\left(-\\frac{t}{\\tau_{m}}\\right)$$\n我们利用初始条件 $V(0)=0$ 来确定积分常数 $A$：\n$$V(0) = 0 = I R_{m} + A\\exp(0) \\implies A = -I R_{m}$$\n将 $A$ 代回通解，得到脉冲期间的电压演变：\n$$V(t) = I R_{m} \\left(1 - \\exp\\left(-\\frac{t}{\\tau_{m}}\\right)\\right)$$\n如果在脉冲结束时电压 $V(t_{p})$ 达到阈值 $\\Delta V_{\\text{th}}$，则会触发一个动作电位。对于恰好处于阈值幅度 $I = I_{\\text{th}}(t_{p})$ 的电流，此条件被精确满足：\n$$\\Delta V_{\\text{th}} = V(t_{p}) = I_{\\text{th}}(t_{p}) R_{m} \\left(1 - \\exp\\left(-\\frac{t_{p}}{\\tau_{m}}\\right)\\right)$$\n求解阈值电流 $I_{\\text{th}}(t_{p})$，得到强度-时程关系：\n$$I_{\\text{th}}(t_{p}) = \\frac{\\Delta V_{\\text{th}}}{R_{m}\\left(1 - \\exp\\left(-\\frac{t_{p}}{\\tau_{m}}\\right)\\right)}$$\n\n**2) 基电流 ($I_r$) 和时值 ($t_c$) 的表达式**\n\n基电流 $I_{r}$ 是无限长脉冲 ($t_{p} \\to \\infty$) 的阈值电流。在此极限下，指数项消失：\n$$I_{r} = \\lim_{t_{p}\\to\\infty} I_{\\text{th}}(t_{p}) = \\frac{\\Delta V_{\\text{th}}}{R_{m}\\left(1 - 0\\right)} = \\frac{\\Delta V_{\\text{th}}}{R_{m}}$$\n时值 $t_{c}$ 是使阈值电流为两倍基电流时的脉冲持续时间 $t_{p}$，即 $I_{\\text{th}}(t_{c}) = 2I_{r}$。代入 $I_{\\text{th}}$ 和 $I_{r}$ 的表达式：\n$$\\frac{\\Delta V_{\\text{th}}}{R_{m}\\left(1 - \\exp\\left(-\\frac{t_{c}}{\\tau_{m}}\\right)\\right)} = 2 \\left(\\frac{\\Delta V_{\\text{th}}}{R_{m}}\\right)$$\n我们从两边消去公因式 $\\frac{\\Delta V_{\\text{th}}}{R_{m}}$ (假设 $\\Delta V_{\\text{th}} \\neq 0$ 且 $R_{m}$ 是有限的非零值)：\n$$\\frac{1}{1 - \\exp\\left(-\\frac{t_{c}}{\\tau_{m}}\\right)} = 2$$\n$$1 = 2 \\left(1 - \\exp\\left(-\\frac{t_{c}}{\\tau_{m}}\\right)\\right)$$\n$$\\frac{1}{2} = 1 - \\exp\\left(-\\frac{t_{c}}{\\tau_{m}}\\right)$$\n$$\\exp\\left(-\\frac{t_{c}}{\\tau_{m}}\\right) = \\frac{1}{2}$$\n对两边取自然对数：\n$$-\\frac{t_{c}}{\\tau_{m}} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)$$\n$$t_{c} = \\tau_{m}\\ln(2)$$\n\n**3) 从数据中估计 $I_{r}$、$\\tau_{m}$ 和 $t_{c}$**\n\n强度-时程关系可以用基电流 $I_{r}$ 表示：\n$$I_{\\text{th}}(t_{p}) = \\frac{I_{r}}{1 - \\exp\\left(-\\frac{t_{p}}{\\tau_{m}}\\right)}$$\n我们有两个已知的数据点：\n1. $I_{1} = 20.0\\,\\mu\\mathrm{A}$ at $t_{1} = 1.00\\,\\mathrm{ms}$\n2. $I_{2} = 11.43\\,\\mu\\mathrm{A}$ at $t_{2} = 3.00\\,\\mathrm{ms}$\n\n这就形成了一个关于两个未知数 $I_{r}$ 和 $\\tau_{m}$ 的非线性方程组：\n$$20.0 = \\frac{I_{r}}{1 - \\exp\\left(-\\frac{1.00}{\\tau_{m}}\\right)}$$\n$$11.43 = \\frac{I_{r}}{1 - \\exp\\left(-\\frac{3.00}{\\tau_{m}}\\right)}$$\n我们可以从两个方程中分别表示出 $I_{r}$：\n$$I_{r} = 20.0 \\left(1 - \\exp\\left(-\\frac{1.00}{\\tau_{m}}\\right)\\right)$$\n$$I_{r} = 11.43 \\left(1 - \\exp\\left(-\\frac{3.00}{\\tau_{m}}\\right)\\right)$$\n令这两个 $I_{r}$ 的表达式相等：\n$$20.0 \\left(1 - \\exp\\left(-\\frac{1.00}{\\tau_{m}}\\right)\\right) = 11.43 \\left(1 - \\exp\\left(-\\frac{3.00}{\\tau_{m}}\\right)\\right)$$\n令 $x = \\exp\\left(-\\frac{1.00}{\\tau_{m}}\\right)$。那么 $\\exp\\left(-\\frac{3.00}{\\tau_{m}}\\right) = \\left(\\exp\\left(-\\frac{1.00}{\\tau_{m}}\\right)\\right)^3 = x^3$。方程变为：\n$$20.0(1 - x) = 11.43(1 - x^3)$$\n使用恒等式 $1 - x^3 = (1 - x)(1 + x + x^2)$：\n$$20.0(1 - x) = 11.43(1 - x)(1 + x + x^2)$$\n因为 $\\tau_{m} > 0$，所以 $x = \\exp\\left(-\\frac{1.00}{\\tau_{m}}\\right)$ 严格介于 0 和 1 之间，因此 $1-x \\neq 0$。我们可以在等式两边同除以 $(1 - x)$：\n$$20.0 = 11.43(1 + x + x^2)$$\n$$x^2 + x + 1 - \\frac{20.0}{11.43} = 0$$\n这是一个二次方程：$11.43x^2 + 11.43x - 8.57 = 0$。使用二次公式 $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$x = \\frac{-11.43 \\pm \\sqrt{11.43^2 - 4(11.43)(-8.57)}}{2(11.43)} = \\frac{-11.43 \\pm \\sqrt{130.6449 + 391.8024}}{22.86} = \\frac{-11.43 \\pm \\sqrt{522.4473}}{22.86}$$\n$$x = \\frac{-11.43 \\pm 22.857106}{22.86}$$\n因为 $x$ 必须为正，我们取正根：\n$$x = \\frac{11.427106}{22.86} \\approx 0.499873$$\n根据 $x$ 的定义：\n$$\\exp\\left(-\\frac{1.00}{\\tau_{m}}\\right) = 0.499873$$\n$$-\\frac{1.00}{\\tau_{m}} = \\ln(0.499873) \\approx -0.693399$$\n$$\\tau_{m} \\approx \\frac{1.00}{0.693399} \\approx 1.4422\\,\\mathrm{ms}$$\n所提供的值表明，预期的理论关系是精确的。如果我们设定 $I_r = 10.0\\,\\mu\\mathrm{A}$，那么 $I_{\\text{th}}(1.00\\,\\mathrm{ms}) = 2I_r$，根据定义，这意味着 $t_{p}=1.00\\,\\mathrm{ms}$ 就是时值。让我们来验证这一点。如果 $t_c=1.00\\,\\mathrm{ms}$，那么 $t_c = \\tau_m \\ln(2)$ 意味着 $\\tau_m = \\frac{t_c}{\\ln(2)} = \\frac{1.00}{\\ln(2)}\\,\\mathrm{ms}$。让我们检查这组参数是否能重现第二个数据点：\n$$I_{\\text{th}}(3.00\\,\\mathrm{ms}) = \\frac{I_r}{1 - \\exp(-3.00/\\tau_m)} = \\frac{10.0}{1 - \\exp(-3.00 \\ln(2) / 1.00)} = \\frac{10.0}{1 - \\exp(-3\\ln(2))}$$\n$$= \\frac{10.0}{1 - \\exp(\\ln(2^{-3}))} = \\frac{10.0}{1 - 2^{-3}} = \\frac{10.0}{1 - 1/8} = \\frac{10.0}{7/8} = \\frac{80.0}{7} \\approx 11.42857\\,\\mu\\mathrm{A}$$\n这与给定的值 $11.43\\,\\mu\\mathrm{A}$ 相符。因此，参数确实是 $I_{r}=10.0\\,\\mu\\mathrm{A}$ 和 $t_c=1.00\\,\\mathrm{ms}$。\n时间常数为 $\\tau_{m} = \\frac{t_{c}}{\\ln(2)} = \\frac{1.00}{\\ln(2)} \\approx 1.443\\,\\mathrm{ms}$。\n时值为 $t_c = 1.00\\,\\mathrm{ms}$。\n\n**4) $I_r$ 和 $t_c$ 的生物物理意义**\n\n- **基电流** $I_r = \\frac{\\Delta V_{\\text{th}}}{R_m}$ 代表达到电压阈值所需的最小电流幅度，只有在无限持续时间的电流脉冲下才能实现。它是稳态兴奋性的一个度量。较低的 $I_r$ 值表示神经元更易兴奋。$I_r$ 与膜电阻 $R_m$ 成反比。$R_m$ 的增加（例如，通过关闭静息漏通道）会减少跨膜的电流泄漏，因此较小的注入电流就足以使膜去极化至阈值。这会降低 $I_r$，增加兴奋性。反之，降低 $R_m$ 会增加 $I_r$。$I_r$ 与膜电容 $C_m$ 无关，因为 $C_m$ 只影响电压变化率，而不影响最终的稳态电压。\n\n- **时值** $t_c = \\tau_m \\ln(2) = R_m C_m \\ln(2)$ 代表强度为两倍基电流的刺激要产生效果所需的脉冲持续时间。它是兴奋性时间特性的一个度量，反映了膜对刺激的响应速度。较短的 $t_c$ 表示对于短暂刺激，膜响应更快、更易兴奋。$t_c$与膜时间常数$\\tau_m$成正比。$R_m$ 或 $C_m$ 的增加都会增加 $\\tau_m$，从而增加 $t_c$。较大的 $R_m$ 会减慢电荷的耗散，而较大的 $C_m$ 需要更多电荷才能达到相同的电位变化；这两个因素都会减慢膜的电压响应并延长时值。\n\n问题只要求给出第 (3) 部分中时值 $t_c$ 的数值，四舍五入至三位有效数字。根据计算，$t_c = 1.00\\,\\mathrm{ms}$。", "answer": "$$\\boxed{1.00}$$", "id": "2570314"}, {"introduction": "在被动膜模型的基础上，这项实践引入了突触电导，以探究神经元如何整合多个输入。你将运用能斯特方程计算不同细胞内条件下的氯离子反转电位（$E_Cl$），从而揭示为何神经递质GABA在成熟神经元中起抑制作用，而在未成熟神经元中却可能起兴奋作用。这个问题阐明了一个关键原则：突触的效应不仅取决于神经递质本身，还取决于突触后细胞的离子环境 [@problem_id:2570289]。", "problem": "一个单室神经元具有被动泄漏电导，并接收打开离子选择性通道的突触输入。假设膜是等电位的，并忽略主动电压门控电导，除了动作电位阈值的概念。泄漏电导的大小为 $g_L = 10\\,\\mathrm{nS}$，反转电位为 $E_L = -65\\,\\mathrm{mV}$；在没有其他电导的情况下，静息膜电位因此约为 $V_{\\mathrm{rest}} \\approx E_L = -65\\,\\mathrm{mV}$。动作电位阈值为 $V_{\\mathrm{th}} = -50\\,\\mathrm{mV}$。A型γ-氨基丁酸（GABA$_A$）突触输入打开一个氯离子选择性电导 $g_{\\mathrm{GABA}} = 10\\,\\mathrm{nS}$（本题中忽略碳酸氢盐的通透性）。α-氨基-3-羟基-5-甲基-4-异恶唑丙酸（AMPA）兴奋性输入打开一个谷氨酸门控电导 $g_E = 2.5\\,\\mathrm{nS}$，反转电位为 $E_E = 0\\,\\mathrm{mV}$。细胞外氯离子浓度为 $[Cl^-]_o = 120\\,\\mathrm{mM}$。\n\n考虑两种仅在细胞内氯离子浓度上有所不同的发育状态：成年状态，其中 $[Cl^-]_i = 5\\,\\mathrm{mM}$；以及未成熟状态，其中 $[Cl^-]_i = 30\\,\\mathrm{mM}$。温度为 $T = 310\\,\\mathrm{K}$，普适气体常数为 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，法拉第常数为 $F = 96485\\,\\mathrm{C\\,mol^{-1}}$。氯离子的化合价为 $z = -1$。你可以假设使用反转电位、驱动力和欧姆离子电流稳态平衡的标准定义。\n\n关于改变细胞内氯离子浓度如何影响兴奋性以及打开氯离子电导的作用，以下哪个（些）选项是正确的？\n\nA. 在成年状态下，在静息时仅打开 GABA$_A$ 通道会使膜超极化至 $V_{\\mathrm{rest}}$ 以下，当与 $g_E$ 输入配对时，膜电位保持在 $V_{\\mathrm{th}}$ 以下。\n\nB. 在未成熟状态下，在静息时仅打开 GABA$_A$ 通道会使膜相对于 $V_{\\mathrm{rest}}$ 去极化但仍低于 $V_{\\mathrm{th}}$；当与 $g_E$ 输入配对时，膜电位超过 $V_{\\mathrm{th}}$。\n\nC. 因为在未成熟神经元中 $E_{Cl}$ 比 $V_{\\mathrm{rest}}$ 更正，所以对于任何给定的兴奋性输入幅度，激活 GABA$_A$ 通道必然会增加发放动作电位的概率。\n\nD. 使 $E_{Cl}$ 比 $V_m$ 更正能保证氯离子外流，从而导致超极化。\n\nE. 如果 $E_{Cl}$ 比 $V_{\\mathrm{th}}$ 更正，则仅打开 GABA$_A$ 通道保证能从静息状态触发一个动作电位。", "solution": "评估问题陈述的有效性。\n\n**步骤1：提取已知条件**\n- 神经元模型：单室，等电位膜。\n- 泄漏电导：$g_L = 10\\,\\mathrm{nS}$。\n- 泄漏反转电位：$E_L = -65\\,\\mathrm{mV}$。\n- 静息电位（基线）：$V_{\\mathrm{rest}} \\approx E_L = -65\\,\\mathrm{mV}$。\n- 动作电位阈值：$V_{\\mathrm{th}} = -50\\,\\mathrm{mV}$。\n- GABA$_A$ 突触输入电导：$g_{\\mathrm{GABA}} = 10\\,\\mathrm{nS}$（氯离子选择性）。\n- AMPA 突触输入电导：$g_E = 2.5\\,\\mathrm{nS}$。\n- AMPA 反转电位：$E_E = 0\\,\\mathrm{mV}$。\n- 细胞外氯离子浓度：$[Cl^-]_o = 120\\,\\mathrm{mM}$。\n- 成年状态细胞内氯离子浓度：$[Cl^-]_i = 5\\,\\mathrm{mM}$。\n- 未成熟状态细胞内氯离子浓度：$[Cl^-]_i = 30\\,\\mathrm{mM}$。\n- 温度：$T = 310\\,\\mathrm{K}$。\n- 普适气体常数：$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 法拉第常数：$F = 96485\\,\\mathrm{C\\,mol^{-1}}$。\n- 氯离子化合价：$z = -1$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题使用了带有突触电导的标准泄漏整合发放神经元模型。氯离子梯度（$E_{Cl}$）的发育性变化及其导致的GABA能功能转换的概念是神经生理学中一个公认的原理。所有参数都在生理上现实的范围内。\n- **良态问题**：该问题定义清晰，并提供了在指定条件下计算稳态膜电位所需的所有信息和常数。对于每种描述的场景，都存在唯一的解。\n- **客观性**：该问题使用精确、定量和无偏见的科学语言陈述。\n\n**步骤3：结论与行动**\n问题陈述在科学上是合理的、良态的、客观的和完整的。因此，它是**有效的**。将推导出解决方案。\n\n具有多个电导的单室神经元的稳态膜电位 $V_m$ 由所有离子电流之和为零的条件确定。根据离子通道的欧姆定律，每种离子 $k$ 的电流为 $I_k = g_k(V_m - E_k)$。在稳态时：\n$$I_{\\mathrm{total}} = \\sum_k I_k = g_L(V_m - E_L) + g_{\\mathrm{GABA}}(V_m - E_{Cl}) + g_E(V_m - E_E) = 0$$\n求解 $V_m$ 得到膜电位的一般方程：\n$$V_m = \\frac{g_L E_L + g_{\\mathrm{GABA}} E_{Cl} + g_E E_E}{g_L + g_{\\mathrm{GABA}} + g_E}$$\n这表明 $V_m$ 是反转电位的加权平均值，其中电导是权重。\n\n首先，我们必须使用能斯特方程计算两种发育状态下氯离子的反转电位 $E_{Cl}$：\n$$E_{Cl} = \\frac{RT}{zF} \\ln\\left(\\frac{[Cl^-]_o}{[Cl^-]_i}\\right)$$\n代入给定的常数：\n$$\\frac{RT}{F} = \\frac{(8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(310\\,\\mathrm{K})}{96485\\,\\mathrm{C\\,mol^{-1}}} \\approx 0.0267\\,\\mathrm{V} = 26.7\\,\\mathrm{mV}$$\n氯离子的化合价为 $z = -1$：\n$$E_{Cl} = \\frac{26.7\\,\\mathrm{mV}}{-1} \\ln\\left(\\frac{[Cl^-]_o}{[Cl^-]_i}\\right) = 26.7\\,\\mathrm{mV} \\ln\\left(\\frac{[Cl^-]_i}{[Cl^-]_o}\\right)$$\n\n对于**成年状态**：$[Cl^-]_i = 5\\,\\mathrm{mM}$ 且 $[Cl^-]_o = 120\\,\\mathrm{mM}$。\n$$E_{Cl}^{\\mathrm{adult}} = 26.7\\,\\mathrm{mV} \\ln\\left(\\frac{5}{120}\\right) = 26.7\\,\\mathrm{mV} \\times (-3.178) \\approx -84.9\\,\\mathrm{mV}$$\n\n对于**未成熟状态**：$[Cl^-]_i = 30\\,\\mathrm{mM}$ 且 $[Cl^-]_o = 120\\,\\mathrm{mM}$。\n$$E_{Cl}^{\\mathrm{immature}} = 26.7\\,\\mathrm{mV} \\ln\\left(\\frac{30}{120}\\right) = 26.7\\,\\mathrm{mV} \\ln(0.25) \\approx 26.7\\,\\mathrm{mV} \\times (-1.386) \\approx -37.0\\,\\mathrm{mV}$$\n\n现在我们评估每个选项。\n\n**A. 在成年状态下，在静息时仅打开 GABA$_A$ 通道会使膜超极化至 $V_{\\mathrm{rest}}$ 以下，当与 $g_E$ 输入配对时，膜电位保持在 $V_{\\mathrm{th}}$ 以下。**\n1. 从静息状态（$V_{\\mathrm{rest}} = -65\\,\\mathrm{mV}$）仅打开 GABA$_A$ 通道：新的稳态电位包括 $g_L$ 和 $g_{\\mathrm{GABA}}$。我们使用 $E_{Cl}^{\\mathrm{adult}} = -84.9\\,\\mathrm{mV}$。\n    $$V_m = \\frac{g_L E_L + g_{\\mathrm{GABA}} E_{Cl}^{\\mathrm{adult}}}{g_L + g_{\\mathrm{GABA}}} = \\frac{(10\\,\\mathrm{nS})(-65\\,\\mathrm{mV}) + (10\\,\\mathrm{nS})(-84.9\\,\\mathrm{mV})}{10\\,\\mathrm{nS} + 10\\,\\mathrm{nS}}$$\n    $$V_m = \\frac{-650 - 849}{20}\\,\\mathrm{mV} = \\frac{-1499}{20}\\,\\mathrm{mV} \\approx -75.0\\,\\mathrm{mV}$$\n    由于 $-75.0\\,\\mathrm{mV} < V_{\\mathrm{rest}} = -65\\,\\mathrm{mV}$，膜发生超极化。第一部分是正确的。\n\n2. 与 $g_E$ 输入配对：所有三种电导都处于活动状态。\n    $$V_m = \\frac{g_L E_L + g_{\\mathrm{GABA}} E_{Cl}^{\\mathrm{adult}} + g_E E_E}{g_L + g_{\\mathrm{GABA}} + g_E}$$\n    $$V_m = \\frac{(10)(-65) + (10)(-84.9) + (2.5)(0)}{10 + 10 + 2.5}\\,\\mathrm{mV} = \\frac{-1499}{22.5}\\,\\mathrm{mV} \\approx -66.6\\,\\mathrm{mV}$$\n    阈值为 $V_{\\mathrm{th}} = -50\\,\\mathrm{mV}$。由于 $-66.6\\,\\mathrm{mV} < -50\\,\\mathrm{mV}$，电位保持在阈值以下。第二部分也是正确的。\n结论：**正确**。\n\n**B. 在未成熟状态下，在静息时仅打开 GABA$_A$ 通道会使膜相对于 $V_{\\mathrm{rest}}$ 去极化但仍低于 $V_{\\mathrm{th}}$；当与 $g_E$ 输入配对时，膜电位超过 $V_{\\mathrm{th}}$。**\n1. 从静息状态仅打开 GABA$_A$ 通道：我们使用 $E_{Cl}^{\\mathrm{immature}} = -37.0\\,\\mathrm{mV}$。\n    $$V_m = \\frac{g_L E_L + g_{\\mathrm{GABA}} E_{Cl}^{\\mathrm{immature}}}{g_L + g_{\\mathrm{GABA}}} = \\frac{(10\\,\\mathrm{nS})(-65\\,\\mathrm{mV}) + (10\\,\\mathrm{nS})(-37.0\\,\\mathrm{mV})}{10\\,\\mathrm{nS} + 10\\,\\mathrm{nS}}$$\n    $$V_m = \\frac{-650 - 370}{20}\\,\\mathrm{mV} = \\frac{-1020}{20}\\,\\mathrm{mV} = -51.0\\,\\mathrm{mV}$$\n    由于 $-51.0\\,\\mathrm{mV} > V_{\\mathrm{rest}} = -65\\,\\mathrm{mV}$，膜发生去极化。由于 $-51.0\\,\\mathrm{mV} < V_{\\mathrm{th}} = -50\\,\\mathrm{mV}$，电位保持在阈值以下。第一部分是正确的。\n\n2. 与 $g_E$ 输入配对：所有三种电导都处于活动状态。\n    $$V_m = \\frac{g_L E_L + g_{\\mathrm{GABA}} E_{Cl}^{\\mathrm{immature}} + g_E E_E}{g_L + g_{\\mathrm{GABA}} + g_E}$$\n    $$V_m = \\frac{(10)(-65) + (10)(-37.0) + (2.5)(0)}{10 + 10 + 2.5}\\,\\mathrm{mV} = \\frac{-1020}{22.5}\\,\\mathrm{mV} \\approx -45.3\\,\\mathrm{mV}$$\n    由于 $-45.3\\,\\mathrm{mV} > V_{\\mathrm{th}} = -50\\,\\mathrm{mV}$，电位超过阈值。第二部分是正确的。\n结论：**正确**。\n\n**C. 因为在未成熟神经元中 $E_{Cl}$ 比 $V_{\\mathrm{rest}}$ 更正，所以对于任何给定的兴奋性输入幅度，激活 GABA$_A$ 通道必然会增加发放动作电位的概率。**\n在未成熟神经元中，$E_{Cl}^{\\mathrm{immature}} \\approx -37.0\\,\\mathrm{mV}$，确实比 $V_{\\mathrm{rest}} = -65\\,\\mathrm{mV}$ 更正。这意味着从静息状态开始，GABA能输入是去极化的。然而，激活GABA$_A$通道也会增加总膜电导（分流效应）。这种分流效应的效果取决于膜电位。新的电位 $V_m'$ 将是旧电位 $V_m$ 和 $E_{Cl}$ 的加权平均值。如果一个强的兴奋性输入使膜电位 $V_m$ 达到比 $E_{Cl}$ *更正*的值，那么打开GABA$_A$通道将把电位*拉低*至 $E_{Cl}$。这将是一种抑制性而非兴奋性作用。例如，一个非常大的 $g_E$ 可以将膜去极化到 $-10\\,\\mathrm{mV}$。增加GABA电导会把这个电位拉向 $-37.0\\,\\mathrm{mV}$，从而减少兴奋。词语“必然”和条件“对于任何给定的兴奋性输入幅度”使这个陈述错误。\n结论：**不正确**。\n\n**D. 使 $E_{Cl}$ 比 $V_m$ 更正能保证氯离子外流，从而导致超极化。**\n作用在离子上的电化学驱动力与 $(V_m - E_{\\mathrm{ion}})$ 成正比。对于像氯离子这样的带负电荷的离子（$z=-1$），其通量方向与带正电荷的离子相反。作用在 $Cl^-$ 上的净力与 $E_{Cl} - V_m$ 成正比。如果 $E_{Cl} > V_m$，作用在 $Cl^-$ 上的驱动力是向外的。负离子（$Cl^-$）的外流意味着细胞内部失去净负电荷，这会导致去极化（膜电位变得更正），而不是超极化。因此，结论“...从而导致超极化”是错误的。\n结论：**不正确**。\n\n**E. 如果 $E_{Cl}$ 比 $V_{\\mathrm{th}}$ 更正，则仅打开 GABA$_A$ 通道保证能从静息状态触发一个动作电位。**\n在未成熟神经元中，我们有 $E_{Cl}^{\\mathrm{immature}} \\approx -37.0\\,\\mathrm{mV}$ 和 $V_{\\mathrm{th}} = -50\\,\\mathrm{mV}$，因此$E_{Cl} > V_{\\mathrm{th}}$ 成立。该陈述声称这保证会触发一个动作电位。然而，最终的膜电位 $V_m$ 是所有活动的反转电位的加权平均值，包括泄漏电位 $E_L = -65\\,\\mathrm{mV}$。正如在选项B中计算的，仅打开GABA$_A$通道导致：\n$$V_m = -51.0\\,\\mathrm{mV}$$\n这个值低于阈值 $V_{\\mathrm{th}} = -50\\,\\mathrm{mV}$。泄漏电导 $g_L$ 将膜电位充分地拉向 $E_L$，以防止其达到阈值。结果取决于电导和反转电位的相对大小。词语“保证”使该陈述错误。\n结论：**不正确**。", "answer": "$$\\boxed{AB}$$", "id": "2570289"}, {"introduction": "这项综合性实践将分析从单室模型推进到使用完整的霍奇金-赫胥黎（Hodgkin-Huxley）模型来模拟空间上延伸的轴突。你的任务是从头开始构建一个计算模型，以观察动作电位的传播并探究导致其传导失败的条件。通过模拟钠离子通道的渐进式阻断，该练习为你提供了强大的实践机会，让你深入了解控制传导速度和可靠性的生物物理因素，这对于理解正常生理功能和由脱髓鞘等引起的病理状态至关重要 [@problem_id:2570337]。", "problem": "您需要实现一个一维无髓鞘轴突模型，该模型包含电压门控钠离子和钾离子通道，并遵循经典的 Hodgkin–Huxley 形式体系。其基本原理是跨圆柱形膜段的电荷守恒、通过欧姆定律定义的轴向电流，以及电压依赖性通道门控的一级动力学。请使用以下经过充分检验的事实和定义作为基础：(i) 膜表现为电容器，其比电容为 $C_m$，总电容与膜面积成正比；(ii) 每个电压门控电流密度是最大电导密度、一个与电压相关的门控变量函数以及驱动力的乘积；(iii) 相邻区室之间的轴向耦合遵循欧姆定律，其轴向电阻根据电缆几何形状和细胞质电阻率计算。\n\n将轴突建模为 $N$ 个等电位圆柱形区室，每个区室长度为 $\\Delta x$，半径为 $a$。在每个区室 $i$ 中，膜电位 $V_i(t)$ 的演化遵循电荷守恒：\n区室 $i$ 的总膜电容乘以 $\\mathrm{d}V_i/\\mathrm{d}t$ 等于流向相邻区室的轴向电流、外部刺激电流和跨膜离子电流的代数和（符号约定为向外的离子电流为正）。使用封端边界条件（电缆两端无轴向电流流出）。最大钠电导密度沿轴突呈线性梯度分布，以模拟部分钠通道阻断：\n$$ \\bar{g}_{Na}(x) = \\bar{g}_{Na,0}\\,\\max\\!\\left(0,\\,1 - s\\,\\frac{x}{L}\\right), $$\n其中 $s \\in [0,1]$ 是远端的下降分数，$x$ 是轴向位置，$L$ 是总长度。所有其他参数均为一致的。\n\n数值积分要求：\n- 使用长度为 $\\Delta x$ 的等长区室进行空间离散化，该长度由目标空间分辨率和指定长度 $L$ 决定；选择 $N$ 以使 $\\Delta x$ 近似于目标值。\n- 使用固定时间步长 $\\Delta t$ 的显式前向欧拉法进行时间积分。\n- 钠激活门控变量 $m$、钠失活门控变量 $h$ 和钾激活门控变量 $n$ 遵循一级动力学 $\\mathrm{d}y/\\mathrm{d}t = \\alpha_y(V)(1-y) - \\beta_y(V)\\,y$（对于 $y \\in \\{m,h,n\\}$），并采用经典的 Hodgkin–Huxley 速率函数。\n\n使用的生物物理和数值常数（所有量均使用指定单位表示）：\n- 轴突半径：$a = 0.025\\,\\mathrm{cm}$。\n- 轴向（胞内）电阻率：$R_i = 0.0354\\,\\mathrm{k}\\Omega\\cdot\\mathrm{cm}$。\n- 比电容：$C_m = 1.0\\,\\mu\\mathrm{F}/\\mathrm{cm}^2$。\n- 最大电导密度：$\\bar{g}_{Na,0} = 120\\,\\mathrm{mS}/\\mathrm{cm}^2$，$\\bar{g}_K = 36\\,\\mathrm{mS}/\\mathrm{cm}^2$，$\\bar{g}_L = 0.3\\,\\mathrm{mS}/\\mathrm{cm}^2$。\n- 反转电位：$E_{Na} = 50\\,\\mathrm{mV}$，$E_K = -77\\,\\mathrm{mV}$，$E_L = -54.4\\,\\mathrm{mV}$。\n- 初始条件：对于所有 $i$，$V_i(0) = -65\\,\\mathrm{mV}$，且 $m,h,n$ 初始化为其在 $V=-65\\,\\mathrm{mV}$ 时的稳态值。\n- 刺激：仅在第一个区室（最前端）施加一个方波电流密度脉冲，其幅值为 $I_{stim} = 20\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$，时间从 $t_{on} = 1.0\\,\\mathrm{ms}$ 到 $t_{off} = 1.5\\,\\mathrm{ms}$，其他位置为零。\n- 空间分辨率目标：$\\Delta x_{target} = 0.005\\,\\mathrm{cm}$；设置 $N = \\lfloor L/\\Delta x_{target} \\rfloor + 1$ 并定义 $\\Delta x = L/(N-1)$。\n- 时间步长：$\\Delta t = 0.01\\,\\mathrm{ms}$。\n- 总仿真时间：$T = 12.0\\,\\mathrm{ms}$。\n- 边界条件：封端（两端均无轴向电流流出）。\n\n使用以 $\\mathrm{mV}$ 为单位的 $V$ 和以 $\\mathrm{ms}$ 为单位的 $t$ 来实现 Hodgkin–Huxley 速率函数：\n- $\\alpha_m(V) = 0.1\\,(V+40)/\\left(1 - e^{-(V+40)/10}\\right)$, $\\beta_m(V) = 4\\,e^{-(V+65)/18}$。\n- $\\alpha_h(V) = 0.07\\,e^{-(V+65)/20}$, $\\beta_h(V) = \\dfrac{1}{1 + e^{-(V+35)/10}}$。\n- $\\alpha_n(V) = 0.01\\,(V+55)/\\left(1 - e^{-(V+55)/10}\\right)$, $\\beta_n(V) = 0.125\\,e^{-(V+65)/80}$。\n通过使用相应的平滑极限，对奇异点处的除法进行数值正则化处理。\n\n几何与电路关系（使用指定的混合单位系统）：\n- 区室膜面积 $A = 2\\pi a\\,\\Delta x$（单位 $\\mathrm{cm}^2$）；区室总电容 $C = C_m A$（单位 $\\mu\\mathrm{F}$）。\n- 相邻区室间的轴向电阻 $R_{ax} = R_i\\,\\Delta x / (\\pi a^2)$（单位 $\\mathrm{k}\\Omega$）。区室 $i$ 和 $j$ 之间的轴向电流为 $(V_j - V_i)/R_{ax}$（单位为 $\\mu\\mathrm{A}$），此电流与单位为 $\\mu\\mathrm{A}$ 的离子电流和刺激电流一起，通过 $C\\,\\mathrm{d}V/\\mathrm{d}t = \\sum I$ 得出单位为 $\\mathrm{mV}/\\mathrm{ms}$ 的 $\\mathrm{d}V/\\mathrm{d}t$。\n\n对于每次仿真，确定：\n- 传导成功：远端区室（索引为 $N-1$）是否在时间 $T$ 内出现向上穿越 $V=0\\,\\mathrm{mV}$ 阈值的现象。\n- 传导速度：如果观察到行进的动作电位，记录在位置 $x_1 = 0.2\\,L$ 和 $x_2 = 0.8\\,L$（四舍五入到最近的区室）处首次向上穿越阈值的时间 $t_1$ 和 $t_2$。计算速度 $v = (x_2 - x_1)/(t_2 - t_1)$，以 $\\mathrm{m}/\\mathrm{s}$ 表示，其中距离单位从 $\\mathrm{cm}$ 转换为 $\\mathrm{m}$，时间单位从 $\\mathrm{ms}$ 转换为 $\\mathrm{s}$。如果任一穿越缺失，则定义速度为 $v = 0.0$。\n\n相对于梯度钠通道阻断的失效阈值：\n- 对于一组固定的参数和轴突长度 $L$，将失效阈值 $s^\\star$ 定义为在 $[0, s_{max}]$ 区间内能够成功传导的 $s$ 的上确界，其中 $s_{max} = 0.95$。假设传导能力随 $s$ 的增加而单调丧失，通过在 $[0, s_{max}]$ 上进行固定次数迭代的二分法来近似 $s^\\star$。如果在 $s_{max}$ 时传导成功，则报告 $s^\\star = s_{max}$；如果在 $s=0$ 时传导失败，则报告 $s^\\star = 0.0$。\n\n测试套件：\n为以下四组参数集运行您的程序，每组参数指定轴突长度 $L$（单位 $\\mathrm{cm}$）和基线梯度钠通道阻断参数 $s_{base}$，用于计算基线传导速度和成功标志。对于每种情况，还需通过上述定义的二分法计算 $s^\\star$。\n- Case A: $L = 1.0\\,\\mathrm{cm}$, $s_{base} = 0.0$。\n- Case B: $L = 1.0\\,\\mathrm{cm}$, $s_{base} = 0.4$。\n- Case C: $L = 1.0\\,\\mathrm{cm}$, $s_{base} = 0.7$。\n- Case D: $L = 0.5\\,\\mathrm{cm}$, $s_{base} = 0.8$。\n\n答案规格：\n- 对于每种情况，生成一个列表 $[v, \\mathrm{success}, s^\\star]$，其中 $v$ 是基线传导速度（单位 $\\mathrm{m}/\\mathrm{s}$，四舍五入到三位小数），$\\mathrm{success}$ 是一个布尔值，指示远端是否在时间 $T$ 内穿越 $0\\,\\mathrm{mV}$，而 $s^\\star$ 是失效阈值（四舍五入到三位小数）。\n- 您的程序应生成单行输出，其中包含一个由这四个列表组成的、以逗号分隔的列表，并用方括号括起来。例如，一个有效的输出格式是\n\"[ [v_A,success_A,sstar_A],[v_B,success_B,sstar_B],[v_C,success_C,sstar_C],[v_D,success_D,sstar_D] ]\"\n除了是有效的 Python 列表语法外，没有额外的空格要求。", "solution": "所提出的问题是计算生物物理学中一个标准的、适定的练习。它要求实现用于无髓鞘轴突的 Hodgkin-Huxley 模型，这是定量神经生理学的基石。所有提供的参数、方程和边界条件在科学上都是合理的，并且内部一致。该问题没有事实错误、矛盾或可能使其无效的模糊之处。因此，我们着手提供一个完整的解决方案。\n\n问题的核心是求解一个耦合偏微分方程组，该方程组描述了膜电位 $V(x,t)$ 沿长度为 $L$ 的轴突的时空演化。轴突被视为一维电缆。基于膜段电荷守恒的控制方程是电缆方程：\n$$ C_m \\frac{\\partial V}{\\partial t} = \\frac{a}{2 R_i} \\frac{\\partial^2 V}{\\partial x^2} - J_{ion}(V, m, h, n) + J_{stim}(x, t) $$\n其中 $C_m$ 是比膜电容，$a$ 是轴突半径，$R_i$ 是胞内电阻率。$J_{ion}$ 项代表跨膜总离子电流密度，$J_{stim}$ 是外部施加的刺激电流密度。\n\n离子电流密度 $J_{ion}$ 是通过钠（Na）、钾（K）和漏（L）通道的电流之和：\n$$ J_{ion} = J_{Na} + J_K + J_L $$\n每个电流密度由欧姆定律定义，其中钠和钾通道的电导是电压依赖的：\n$$ J_{Na} = \\bar{g}_{Na}(x) m^3 h (V - E_{Na}) $$\n$$ J_K = \\bar{g}_K n^4 (V - E_K) $$\n$$ J_L = \\bar{g}_L (V - E_L) $$\n此处，$\\bar{g}_{Na}(x)$、$\\bar{g}_K$ 和 $\\bar{g}_L$ 是最大电导密度。$E_{Na}$、$E_K$ 和 $E_L$ 分别是相应离子的能斯特平衡电位。钠电导被指定为空间梯度的：\n$$ \\bar{g}_{Na}(x) = \\bar{g}_{Na,0}\\,\\max\\!\\left(0,\\,1 - s\\,\\frac{x}{L}\\right) $$\n变量 $m$、$h$ 和 $n$ 是无量纲的门控变量，分别代表钠通道激活、钠通道失活和钾通道激活。它们的动力学由一阶常微分方程描述：\n$$ \\frac{dy}{dt} = \\alpha_y(V)(1-y) - \\beta_y(V)y, \\quad y \\in \\{m, h, n\\} $$\n电压依赖的速率函数 $\\alpha_y(V)$ 和 $\\beta_y(V)$ 由标准的 Hodgkin-Huxley 经验公式给出：\n$$ \\alpha_m(V) = \\frac{0.1(V+40)}{1 - e^{-(V+40)/10}}, \\quad \\beta_m(V) = 4e^{-(V+65)/18} $$\n$$ \\alpha_h(V) = 0.07e^{-(V+65)/20}, \\quad \\beta_h(V) = \\frac{1}{1 + e^{-(V+35)/10}} $$\n$$ \\alpha_n(V) = \\frac{0.01(V+55)}{1 - e^{-(V+55)/10}}, \\quad \\beta_n(V) = 0.125e^{-(V+65)/80} $$\n$\\alpha_m(V)$ 在 $V=-40\\,\\mathrm{mV}$ 处和 $\\alpha_n(V)$ 在 $V=-55\\,\\mathrm{mV}$ 处的奇异点通过取其数学极限来处理，极限值分别为 $1.0$ 和 $0.1$。\n\n为了数值求解该系统，我们采用直线法（method of lines）。首先，我们将空间域 $x \\in [0, L]$ 离散化为 $N$ 个长度为 $\\Delta x = L/(N-1)$ 的等长区室。第 $i$ 个区室的膜电位表示为 $V_i(t) \\equiv V(x_i, t)$，其中 $x_i = i\\Delta x$，对于 $i=0, 1, \\dots, N-1$。空间二阶导数 $\\partial^2 V / \\partial x^2$ 使用标准的中心差分公式进行近似。在边界处（$x=0$ 和 $x=L$），封端条件意味着轴向电流为零，这等效于零通量的诺伊曼（Neumann）边界条件，$\\partial V / \\partial x = 0$。这通过使用虚拟点（ghost points）来实现，从而得到端点处离散拉普拉斯算子的特定形式。半离散化系统成为一个大型的耦合常微分方程组（ODEs），每个状态变量（$V_i, m_i, h_i, n_i$）在每个区室中都有一个方程。\n\n对于内部区室（$0 < i < N-1$）：\n$$ \\frac{dV_i}{dt} = \\frac{1}{C_m}\\left( \\frac{a}{2R_i(\\Delta x)^2}(V_{i-1} - 2V_i + V_{i+1}) - J_{ion, i} \\right) $$\n对于第一个区室（$i=0$），带有刺激 $J_{stim,0}$：\n$$ \\frac{dV_0}{dt} = \\frac{1}{C_m}\\left( \\frac{a}{2R_i(\\Delta x)^2}(2V_1 - 2V_0) - J_{ion, 0} + J_{stim,0} \\right) $$\n对于最后一个区室（$i=N-1$）：\n$$ \\frac{dV_{N-1}}{dt} = \\frac{1}{C_m}\\left( \\frac{a}{2R_i(\\Delta x)^2}(2V_{N-2} - 2V_{N-1}) - J_{ion, N-1} \\right) $$\n门控变量的常微分方程局域于每个区室：\n$$ \\frac{dy_i}{dt} = \\alpha_y(V_i)(1-y_i) - \\beta_y(V_i)y_i, \\quad y \\in \\{m, h, n\\} $$\n\n该常微分方程组使用显式前向欧拉法以固定的时间步长 $\\Delta t$ 随时间进行积分：\n$$ Y(t+\\Delta t) = Y(t) + \\Delta t \\cdot \\frac{dY}{dt}|_{t} $$\n其中 $Y$ 是包含所有 $V_i, m_i, h_i, n_i$ 的状态向量。\n\n计算流程如下：\n1。初始化所有状态变量：$V_i(0) = -65\\,\\mathrm{mV}$，而 $m_i, h_i, n_i$ 设置为其在 $V=-65\\,\\mathrm{mV}$ 时的稳态值 $y_{\\infty}(V) = \\alpha_y(V)/(\\alpha_y(V) + \\beta_y(V))$。\n2。从 $t=0$ 到 $T$ 以步长 $\\Delta t$ 进行时间迭代。在每一步中：\n   a. 基于当前时间 $t$ 的状态，计算所有导数 $\\mathrm{d}V_i/\\mathrm{d}t$、$\\mathrm{d}m_i/\\mathrm{d}t$、$\\mathrm{d}h_i/\\mathrm{d}t$、$\\mathrm{d}n_i/\\mathrm{d}t$。\n   b. 使用欧拉公式将所有状态变量更新到时间 $t+\\Delta t$ 的值。\n   c. 记录在指定位置的阈值穿越（$V=0\\,\\mathrm{mV}$），以确定传导成功和速度。\n3。传导速度 $v$ 计算为 $v = \\Delta x_{eff} / \\Delta t_{cross}$，其中 $\\Delta x_{eff}$ 是测量点（$x=0.2L$ 和 $x=0.8L$）之间的距离，$\\Delta t_{cross}$ 是它们首次向上穿越阈值的时间差。如果任何一次穿越缺失，则 $v=0.0$。\n4。失效阈值 $s^\\star$ 通过在区间 $[0, 0.95]$ 上使用二分搜索找到。在中间点 $s_{mid}$ 运行一次仿真。如果传导成功，搜索的下界更新为 $s_{mid}$；否则，上界更新为 $s_{mid}$。此过程重复固定次数（15次）的迭代，足以达到所需精度。\n\n该算法针对每个测试案例进行实现，以生成所需的输出。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the Hodgkin-Huxley axon model.\n    \"\"\"\n\n    class HodgkinHuxleyAxon:\n        \"\"\"\n        Implements a one-dimensional Hodgkin-Huxley axon model.\n        \"\"\"\n        def __init__(self, L, s, dt=0.01, dx_target=0.005, T=12.0):\n            # Physical parameters\n            self.L = float(L)  # Axon length [cm]\n            self.s = float(s)    # Sodium channel block parameter\n            self.a = 0.025   # Radius [cm]\n            self.R_i = 0.0354 # Axial resistivity [kOhm.cm]\n            self.C_m = 1.0     # Membrane capacitance [uF/cm^2]\n\n            # Conductances and potentials\n            self.g_Na_bar0 = 120.0 # [mS/cm^2]\n            self.g_K_bar = 36.0    # [mS/cm^2]\n            self.g_L_bar = 0.3     # [mS/cm^2]\n            self.E_Na = 50.0       # [mV]\n            self.E_K = -77.0       # [mV]\n            self.E_L = -54.4       # [mV]\n            self.V_rest = -65.0    # [mV]\n\n            # Stimulation\n            self.I_stim_amp = 20.0 # [uA/cm^2]\n            self.t_on = 1.0        # [ms]\n            self.t_off = 1.5       # [ms]\n\n            # Numerical parameters\n            self.dt = dt           # [ms]\n            self.T = T             # [ms]\n            \n            # Spatial discretization\n            self.N = int(np.floor(self.L / dx_target)) + 1\n            if self.N < 2: self.N = 2 # Ensure at least 2 compartments for propagation\n            self.dx = self.L / (self.N - 1)\n            self.x = np.linspace(0, self.L, self.N)\n\n            # Graded sodium conductance\n            self.g_Na_bar = self.g_Na_bar0 * np.maximum(0, 1 - self.s * self.x / self.L)\n            self.g_Na_bar = self.g_Na_bar.reshape(-1, 1)\n\n        # Gating variable rate functions\n        def alpha_m(self, V):\n            V_term = V + 40.0\n            if np.any(np.abs(V_term) < 1e-6): # Regularize singularity\n                return np.where(np.abs(V_term) < 1e-6, 1.0, 0.1 * V_term / (1.0 - np.exp(-V_term / 10.0)))\n            return 0.1 * V_term / (1.0 - np.exp(-V_term / 10.0))\n        def beta_m(self, V): return 4.0 * np.exp(-(V + 65.0) / 18.0)\n        def alpha_h(self, V): return 0.07 * np.exp(-(V + 65.0) / 20.0)\n        def beta_h(self, V): return 1.0 / (1.0 + np.exp(-(V + 35.0) / 10.0))\n        def alpha_n(self, V):\n            V_term = V + 55.0\n            if np.any(np.abs(V_term) < 1e-6): # Regularize singularity\n                return np.where(np.abs(V_term) < 1e-6, 0.1, 0.01 * V_term / (1.0 - np.exp(-V_term / 10.0)))\n            return 0.01 * V_term / (1.0 - np.exp(-V_term / 10.0))\n        def beta_n(self, V): return 0.125 * np.exp(-(V + 65.0) / 80.0)\n        \n        def run(self):\n            \"\"\"Runs the simulation and returns conduction velocity and success.\"\"\"\n            # Initialize state variables\n            V = np.full((self.N, 1), self.V_rest)\n            m = np.full((self.N, 1), self.alpha_m(self.V_rest) / (self.alpha_m(self.V_rest) + self.beta_m(self.V_rest)))\n            h = np.full((self.N, 1), self.alpha_h(self.V_rest) / (self.alpha_h(self.V_rest) + self.beta_h(self.V_rest)))\n            n = np.full((self.N, 1), self.alpha_n(self.V_rest) / (self.alpha_n(self.V_rest) + self.beta_n(self.V_rest)))\n\n            time_steps = np.arange(0, self.T, self.dt)\n            \n            # Setup for tracking outputs\n            v_thresh = 0.0\n            distal_crossed = False\n            idx1 = int(round(0.2 * self.L / self.dx))\n            idx2 = int(round(0.8 * self.L / self.dx))\n            t_cross_1, t_cross_2 = -1.0, -1.0\n\n            coeff_axial = self.a / (2.0 * self.R_i * self.dx**2)\n\n            for t in time_steps:\n                V_prev = np.copy(V)\n\n                # Stimulus current density\n                I_stim = np.zeros((self.N, 1))\n                if self.t_on <= t < self.t_off:\n                    I_stim[0] = self.I_stim_amp\n\n                # Ionic current densities\n                I_Na = self.g_Na_bar * (m**3) * h * (V - self.E_Na)\n                I_K = self.g_K_bar * (n**4) * (V - self.E_K)\n                I_L = self.g_L_bar * (V - self.E_L)\n                I_ion = I_Na + I_K + I_L\n\n                # Discretized Laplacian for axial current\n                laplacian_V = np.zeros((self.N, 1))\n                laplacian_V[1:-1] = V[:-2] - 2 * V[1:-1] + V[2:]\n                laplacian_V[0] = 2 * (V[1] - V[0]) # Sealed-end BC\n                laplacian_V[-1] = 2 * (V[-2] - V[-1]) # Sealed-end BC\n\n                # Derivatives using current state\n                dV_dt = (1.0 / self.C_m) * (coeff_axial * laplacian_V - I_ion + I_stim)\n                dm_dt = self.alpha_m(V) * (1.0 - m) - self.beta_m(V) * m\n                dh_dt = self.alpha_h(V) * (1.0 - h) - self.beta_h(V) * h\n                dn_dt = self.alpha_n(V) * (1.0 - n) - self.beta_n(V) * n\n\n                # Update state variables using Forward Euler\n                V += self.dt * dV_dt\n                m += self.dt * dm_dt\n                h += self.dt * dh_dt\n                n += self.dt * dn_dt\n\n                # Check for threshold crossings\n                if not distal_crossed and V_prev[-1] < v_thresh and V[-1] >= v_thresh:\n                    distal_crossed = True\n                if t_cross_1 < 0 and V_prev[idx1] < v_thresh and V[idx1] >= v_thresh:\n                    t_cross_1 = t\n                if t_cross_2 < 0 and V_prev[idx2] < v_thresh and V[idx2] >= v_thresh:\n                    t_cross_2 = t\n\n            velocity = 0.0\n            if t_cross_1 > 0 and t_cross_2 > t_cross_1:\n                dist_m = (self.x[idx2] - self.x[idx1]) / 100.0  # cm to m\n                time_s = (t_cross_2 - t_cross_1) / 1000.0  # ms to s\n                if time_s > 0:\n                    velocity = dist_m / time_s\n            \n            return velocity, distal_crossed\n\n    def find_s_star(L):\n        s_max = 0.95\n        \n        _, success_at_0 = HodgkinHuxleyAxon(L, 0.0).run()\n        if not success_at_0:\n            return 0.0\n        \n        _, success_at_max = HodgkinHuxleyAxon(L, s_max).run()\n        if success_at_max:\n            return s_max\n\n        s_low, s_high = 0.0, s_max\n        num_iterations = 15  # Sufficient for 3 decimal places\n        for _ in range(num_iterations):\n            s_mid = (s_low + s_high) / 2.0\n            _, success = HodgkinHuxleyAxon(L, s_mid).run()\n            if success:\n                s_low = s_mid\n            else:\n                s_high = s_mid\n        return s_low\n    \n    test_cases = [\n        (1.0, 0.0), # Case A\n        (1.0, 0.4), # Case B\n        (1.0, 0.7), # Case C\n        (0.5, 0.8), # Case D\n    ]\n    \n    all_results = []\n    \n    for L_cm, s_base in test_cases:\n        # Run baseline simulation\n        sim_base = HodgkinHuxleyAxon(L=L_cm, s=s_base)\n        v_base, success_base = sim_base.run()\n        \n        # Find failure threshold s_star\n        s_star = find_s_star(L=L_cm)\n        \n        # Format and append\n        v_rounded = round(v_base, 3)\n        s_star_rounded = round(s_star, 3)\n        all_results.append([v_rounded, success_base, s_star_rounded])\n        \n    # Generate the final output string\n    result_str = str(all_results).replace(\" \", \"\")\n    print(result_str)\n\nsolve()\n```", "id": "2570337"}]}