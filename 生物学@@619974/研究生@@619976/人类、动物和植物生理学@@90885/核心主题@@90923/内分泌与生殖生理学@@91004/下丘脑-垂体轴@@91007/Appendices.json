{"hands_on_practices": [{"introduction": "激素的生物活性主要由其游离、未结合的部分决定。本练习旨在探讨血浆中激素总浓度、结合蛋白以及真正与细胞受体相互作用的游离浓度之间的关键关系 [@problem_id:2617421]。通过应用质量作用定律，您将量化“游离激素假说”，并将血浆转运动态与细胞信号传导的初始步骤——受体结合——直接联系起来，从而磨练您在内分泌学基础的生物化学平衡建模方面的技能。", "problem": "在急性应激期间，一名人类受试者表现出循环皮质醇水平升高。假设皮质醇与皮质类固醇结合球蛋白 (CBG) 之间存在单一的高亲和力结合作用，并忽略与白蛋白的弱结合。皮质醇以可逆的 $1{:}1$ 相互作用与 CBG 结合。在 $37\\,^{\\circ}\\mathrm{C}$ 的热力学平衡条件下进行计算，并应用质量作用定律和质量守恒定律。测得的总浓度为：总皮质醇 $C_T = 800\\ \\mathrm{nM}$, 总 CBG $B_T = 600\\ \\mathrm{nM}$。皮质醇–CBG 的平衡解离常数是 $K_D^{\\mathrm{CBG}} = 40\\ \\mathrm{nM}$, 定义为 $K_D^{\\mathrm{CBG}} = [\\mathrm{free\\ cortisol}]\\,[\\mathrm{free\\ CBG}]/[\\mathrm{CBG\\!-\\!cortisol\\ complex}]$。\n\n首先，仅使用质量作用定律以及总皮质醇和总 CBG 的守恒恒等式，计算这些数据所对应的游离皮质醇浓度 $F$。然后，将垂体负反馈建模为皮质醇与促肾上腺皮质激素细胞中的糖皮质激素受体 (GR) 结合的结果，该结合同样是在平衡状态下的可逆 $1{:}1$ 相互作用，其解离常数为 $K_D^{\\mathrm{GR}} = 10\\ \\mathrm{nM}$。假设促肾上腺皮质激素 (ACTH) 分泌的瞬时分数驱动力与未被占据的 GR 的比例成正比，因此在皮质醇水平为 $F$ 时的 ACTH 驱动力与其在皮质醇为零时的基线值之比 $R/R_0$，等于质量作用定律所决定的未被占据受体的比例。\n\n使用这些假设，并且不使用任何其他现成公式，推导出 $F$ 以及 $R/R_0$。将单一数值 $R/R_0$ (无量纲) 作为您的最终答案。将您的答案四舍五入到四位有效数字。", "solution": "首先对问题陈述进行验证。\n\n逐字提取已知条件如下：\n- 皮质醇与皮质类固醇结合球蛋白 (CBG) 之间在热力学平衡下的可逆 $1{:}1$ 结合作用。\n- 忽略与白蛋白的弱结合。\n- 总皮质醇浓度，$C_T = 800\\ \\mathrm{nM}$。\n- 总 CBG 浓度，$B_T = 600\\ \\mathrm{nM}$。\n- 皮质醇-CBG 的平衡解离常数，$K_D^{\\mathrm{CBG}} = 40\\ \\mathrm{nM}$。\n- 解离常数的定义：$K_D^{\\mathrm{CBG}} = [\\mathrm{free\\ cortisol}]\\,[\\mathrm{free\\ CBG}]/[\\mathrm{CBG\\!-\\!cortisol\\ complex}]$。\n- 负反馈被建模为游离皮质醇与糖皮质激素受体 (GR) 之间的可逆 $1{:}1$ 结合作用。\n- 皮质醇-GR 的平衡解离常数，$K_D^{\\mathrm{GR}} = 10\\ \\mathrm{nM}$。\n- ACTH 驱动力与基线值之比 $R/R_0$，等于未被占据的 GR 的比例。\n- 任务是计算游离皮质醇浓度 $F$，然后计算比值 $R/R_0$。\n- $R/R_0$ 的最终答案应四舍五入到四位有效数字。\n\n该问题经验证是合理的。其科学基础是化学平衡原理（质量作用定律）和质量守恒定律，这些是生物分子相互作用建模的标准方法。该问题提法得当，提供了足够的方程和参数来确定一个唯一的、具有物理意义的解。其语言客观、精确，参数值在生理学上是合理的。不存在逻辑矛盾、歧义或事实错误。因此，我们继续进行求解。\n\n求解过程分两步。首先，我们根据与 CBG 的平衡关系计算游离皮质醇的浓度 $F$。其次，我们使用这个 $F$ 值来计算未被占据的 GR 的比例，根据定义，该比例等于 ACTH 驱动力比值 $R/R_0$。\n\n设 $F$ 为游离皮质醇的浓度，$B$ 为游离 CBG 的浓度，$P$ 为蛋白质-皮质醇复合物（CBG-皮质醇）的浓度。问题陈述了总浓度分别为皮质醇 $C_T$ 和 CBG $B_T$。质量守恒方程为：\n$$ C_T = F + P $$\n$$ B_T = B + P $$\n此 $1{:}1$ 结合平衡的质量作用定律由解离常数 $K_D^{\\mathrm{CBG}}$ 给出：\n$$ K_D^{\\mathrm{CBG}} = \\frac{F \\cdot B}{P} $$\n我们必须求解该方程组以得到 $F$。我们将 $P$ 和 $B$ 用 $F$ 和已知的总浓度表示。根据皮质醇的质量守恒：\n$$ P = C_T - F $$\n将此式代入 CBG 的质量守恒方程：\n$$ B = B_T - P = B_T - (C_T - F) = B_T - C_T + F $$\n现在，将 $P$ 和 $B$ 的表达式代入质量作用方程：\n$$ K_D^{\\mathrm{CBG}} = \\frac{F (B_T - C_T + F)}{C_T - F} $$\n必须将此方程重新整理成关于 $F$ 的标准一元二次方程形式，即 $aF^2 + bF + c = 0$。\n$$ K_D^{\\mathrm{CBG}}(C_T - F) = F(B_T - C_T + F) $$\n$$ K_D^{\\mathrm{CBG}} C_T - K_D^{\\mathrm{CBG}} F = B_T F - C_T F + F^2 $$\n$$ F^2 + (B_T - C_T + K_D^{\\mathrm{CBG}})F - K_D^{\\mathrm{CBG}} C_T = 0 $$\n我们现在代入给定的数值：$C_T = 800\\ \\mathrm{nM}$, $B_T = 600\\ \\mathrm{nM}$, 以及 $K_D^{\\mathrm{CBG}} = 40\\ \\mathrm{nM}$。\n$$ F^2 + (600 - 800 + 40)F - (40)(800) = 0 $$\n$$ F^2 - 160F - 32000 = 0 $$\n使用一元二次方程求根公式 $F = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $F$，其中 $a=1$, $b=-160$, $c=-32000$。\n$$ F = \\frac{-(-160) \\pm \\sqrt{(-160)^2 - 4(1)(-32000)}}{2(1)} $$\n$$ F = \\frac{160 \\pm \\sqrt{25600 + 128000}}{2} $$\n$$ F = \\frac{160 \\pm \\sqrt{153600}}{2} $$\n由于浓度必须是正的物理量，我们取正根：\n$$ F = \\frac{160 + \\sqrt{153600}}{2} \\approx \\frac{160 + 391.9184}{2} \\approx 275.9592\\ \\mathrm{nM} $$\n这就是游离皮质醇的浓度。\n\n接下来，我们计算 ACTH 驱动力比值 $R/R_0$。该比值被设定为等于未被占据的 GR 的比例。设 $[GR]_{\\text{unocc}}$ 为未被占据 GR 的浓度，$[GR]_{\\text{occ}}$ 为与皮质醇结合的 GR 的浓度。总 GR 浓度为 $[GR]_{T} = [GR]_{\\text{unocc}} + [GR]_{\\text{occ}}$。未被占据受体的比例为：\n$$ \\frac{R}{R_0} = \\frac{[GR]_{\\text{unocc}}}{[GR]_{T}} = \\frac{[GR]_{\\text{unocc}}}{[GR]_{\\text{unocc}} + [GR]_{\\text{occ}}} $$\n皮质醇与 GR 的结合平衡由 $K_D^{\\mathrm{GR}}$ 定义：\n$$ K_D^{\\mathrm{GR}} = \\frac{F \\cdot [GR]_{\\text{unocc}}}{[GR]_{\\text{occ}}} $$\n由此，我们将 $[GR]_{\\text{occ}}$ 用 $[GR]_{\\text{unocc}}$ 表示：\n$$ [GR]_{\\text{occ}} = \\frac{F \\cdot [GR]_{\\text{unocc}}}{K_D^{\\mathrm{GR}}} $$\n将此式代入未被占据受体比例的表达式中：\n$$ \\frac{R}{R_0} = \\frac{[GR]_{\\text{unocc}}}{[GR]_{\\text{unocc}} + \\frac{F \\cdot [GR]_{\\text{unocc}}}{K_D^{\\mathrm{GR}}}} $$\n分子和分母中的 $[GR]_{\\text{unocc}}$ 项可以消掉：\n$$ \\frac{R}{R_0} = \\frac{1}{1 + \\frac{F}{K_D^{\\mathrm{GR}}}} = \\frac{K_D^{\\mathrm{GR}}}{K_D^{\\mathrm{GR}} + F} $$\n现在，我们代入计算出的 $F$ 值和给定的 $K_D^{\\mathrm{GR}} = 10\\ \\mathrm{nM}$ 值。\n$$ \\frac{R}{R_0} = \\frac{10}{10 + 275.9592} = \\frac{10}{285.9592} \\approx 0.034969... $$\n题目要求答案四舍五入到四位有效数字。\n$$ \\frac{R}{R_0} \\approx 0.03497 $$\n这就是最终的无量纲比值。", "answer": "$$\\boxed{0.03497}$$", "id": "2617421"}, {"introduction": "在研究内分泌反馈回路时，研究人员常需使用“钳制”技术将激素浓度维持在恒定水平。本练习模拟了这一实验过程中的药代动力学原理 [@problem_id:2617344]。您将从质量平衡第一性原理出发，推导在持续输注过程中控制激素浓度的方程，并确定稳态浓度等关键参数。这项实践有助于您深入理解整体药代动力学，以及探索下丘脑-垂体-肾上腺（HPA）轴的实验设计背后的定量原理。", "problem": "一个研究团队正在评估下丘脑-垂体-肾上腺（HPA）轴在血浆皮质醇浓度受控钳制期间的反馈调节。为在实验期间将血浆皮质醇浓度钳制在近乎恒定的水平，以恒定速率静脉（IV）输注氢化可的松。假设在钳制期间，身体表现为单个充分混合的房室，具有线性一级消除、瞬时混合且无内源性产生的特点。设 $R_{in}$ 表示恒定输注速率（单位时间的质量），$Cl$ 表示全身清除率（单位时间的体积），$V_{d}$ 表示表观分布容积（体积）。\n\n仅从质量平衡和以下核心药代动力学定义出发：(i) 体内药物量的变化率等于输入减去输出，(ii) 输出（消除速率）等于 $Cl$ 乘以血浆浓度，(iii) 体内药物量等于 $V_{d}$ 乘以血浆浓度，推导恒速输注的浓度-时间方程，并用其计算：\n\n- 稳态浓度 $C_{ss}$，以及\n- 从零初始浓度达到 $95\\%$ $C_{ss}$ 所需的时间。\n\n使用在此受试者中实验测得的氢化可的松参数：$R_{in} = 24\\ \\text{mg}\\ \\text{h}^{-1}$，$Cl = 12\\ \\text{L}\\ \\text{h}^{-1}$，以及 $V_{d} = 40\\ \\text{L}$。将稳态浓度以 $\\text{mg}\\ \\text{L}^{-1}$ 表示，时间以 $\\text{h}$ 表示。将两个数值结果均四舍五入至四位有效数字。按 $\\big(C_{ss},\\ \\text{达到 }95\\%\\ C_{ss}\\text{ 的时间}\\big)$ 的顺序，以数对形式提供最终数值结果。", "solution": "提交分析的问题陈述被认为是有效的。它提出了一个药代动力学的标准问题，药代动力学是生理学和医学的核心学科。该问题具有科学依据、提法恰当、客观，并包含了获得唯一且有意义解所需的所有信息和约束。它要求基于第一性原理推导和应用一个基本模型，这是一项合乎逻辑的科学任务。\n\n我们首先根据所提供的第一性原理建立数学模型。设 $A(t)$ 为时间 $t$ 时体内氢化可的松的量，设 $C(t)$ 为相应的血浆浓度。\n\n第一性原理指出，体内药物量的变化率是输入速率与输出速率之差：\n$$\n\\frac{dA(t)}{dt} = \\text{Rate}_{\\text{in}} - \\text{Rate}_{\\text{out}}\n$$\n输入速率是恒定输注速率 $R_{in}$。输出速率，即消除速率，由全身清除率 $Cl$ 与血浆浓度 $C(t)$ 的乘积给出。\n$$\n\\text{Rate}_{\\text{in}} = R_{in}\n$$\n$$\n\\text{Rate}_{\\text{out}} = Cl \\cdot C(t)\n$$\n将这些代入质量平衡方程可得：\n$$\n\\frac{dA(t)}{dt} = R_{in} - Cl \\cdot C(t)\n$$\n问题提供了第三个关系，通过表观分布容积 $V_{d}$ 将体内药物量 $A(t)$ 与血浆浓度 $C(t)$联系起来：\n$$\nA(t) = V_{d} \\cdot C(t)\n$$\n假设 $V_{d}$ 是一个常数，我们将此表达式对时间 $t$ 求导：\n$$\n\\frac{dA(t)}{dt} = V_{d} \\frac{dC(t)}{dt}\n$$\n通过令 $\\frac{dA(t)}{dt}$ 的两个表达式相等，我们得到了关于血浆浓度 $C(t)$ 的一阶线性常微分方程：\n$$\nV_{d} \\frac{dC(t)}{dt} = R_{in} - Cl \\cdot C(t)\n$$\n这是药物浓度的控制方程。为求解该方程，我们将其整理为标准形式：\n$$\n\\frac{dC(t)}{dt} + \\frac{Cl}{V_{d}} C(t) = \\frac{R_{in}}{V_{d}}\n$$\n让我们定义一级消除速率常数 $k_{e}$ 为 $k_{e} = \\frac{Cl}{V_{d}}$。方程变为：\n$$\n\\frac{dC(t)}{dt} + k_{e} C(t) = \\frac{R_{in}}{V_{d}}\n$$\n我们使用积分因子 $I(t)$ 求解此方程，定义为 $I(t) = \\exp\\left(\\int k_{e} dt\\right) = \\exp(k_{e} t)$。将微分方程乘以 $I(t)$ 可得：\n$$\n\\exp(k_{e} t) \\frac{dC(t)}{dt} + k_{e} \\exp(k_{e} t) C(t) = \\frac{R_{in}}{V_{d}} \\exp(k_{e} t)\n$$\n根据乘法法则，左侧可被识别为乘积 $C(t) \\exp(k_{e} t)$ 的导数：\n$$\n\\frac{d}{dt}\\left[ C(t) \\exp(k_{e} t) \\right] = \\frac{R_{in}}{V_{d}} \\exp(k_{e} t)\n$$\n对两边关于 $t$ 积分：\n$$\n\\int \\frac{d}{dt}\\left[ C(t) \\exp(k_{e} t) \\right] dt = \\int \\frac{R_{in}}{V_{d}} \\exp(k_{e} t) dt\n$$\n$$\nC(t) \\exp(k_{e} t) = \\frac{R_{in}}{V_{d} k_{e}} \\exp(k_{e} t) + K\n$$\n其中 $K$ 是积分常数。求解 $C(t)$ 得到通解：\n$$\nC(t) = \\frac{R_{in}}{V_{d} k_{e}} + K \\exp(-k_{e} t)\n$$\n将 $k_{e} = \\frac{Cl}{V_{d}}$ 代回到第一项中：\n$$\nC(t) = \\frac{R_{in}}{V_{d} \\left(\\frac{Cl}{V_{d}}\\right)} + K \\exp(-k_{e} t) = \\frac{R_{in}}{Cl} + K \\exp(-k_{e} t)\n$$\n问题指定初始浓度为零，$C(0) = 0$。我们使用这个条件来确定 $K$：\n$$\nC(0) = 0 = \\frac{R_{in}}{Cl} + K \\exp(0) \\implies K = -\\frac{R_{in}}{Cl}\n$$\n将 $K$ 的值代入通解，我们得到从零浓度开始的恒速输注的特定浓度-时间方程：\n$$\nC(t) = \\frac{R_{in}}{Cl} - \\frac{R_{in}}{Cl} \\exp(-k_{e} t) = \\frac{R_{in}}{Cl} \\left(1 - \\exp(-k_{e} t)\\right)\n$$\n将 $k_{e}$ 替换为其定义 $\\frac{Cl}{V_{d}}$，我们得到推导出的方程的最终形式：\n$$\nC(t) = \\frac{R_{in}}{Cl} \\left(1 - \\exp\\left(-\\frac{Cl}{V_{d}} t\\right)\\right)\n$$\n现在，我们继续计算所需的两个量。\n\n首先，稳态浓度 $C_{ss}$ 是当时间趋于无穷大（$t \\to \\infty$）时达到的浓度。在稳态时，系统处于平衡状态，浓度不再变化。我们可以通过求 $C(t)$ 在 $t \\to \\infty$ 时的极限来找到它：\n$$\nC_{ss} = \\lim_{t \\to \\infty} C(t) = \\lim_{t \\to \\infty} \\left[ \\frac{R_{in}}{Cl} \\left(1 - \\exp\\left(-\\frac{Cl}{V_{d}} t\\right)\\right) \\right]\n$$\n由于 $\\frac{Cl}{V_{d}} > 0$，当 $t \\to \\infty$ 时，指数项 $\\exp\\left(-\\frac{Cl}{V_{d}} t\\right)$ 趋近于 $0$。因此：\n$$\nC_{ss} = \\frac{R_{in}}{Cl} (1 - 0) = \\frac{R_{in}}{Cl}\n$$\n使用给定的数值 $R_{in} = 24\\ \\text{mg}\\ \\text{h}^{-1}$ 和 $Cl = 12\\ \\text{L}\\ \\text{h}^{-1}$：\n$$\nC_{ss} = \\frac{24\\ \\text{mg}\\ \\text{h}^{-1}}{12\\ \\text{L}\\ \\text{h}^{-1}} = 2\\ \\text{mg}\\ \\text{L}^{-1}\n$$\n按要求四舍五入到四位有效数字，我们得到 $C_{ss} = 2.000\\ \\text{mg}\\ \\text{L}^{-1}$。\n\n其次，我们必须求出达到该稳态浓度 $95\\%$ 所需的时间。设这个时间为 $t_{95\\%}$。我们令 $C(t_{95\\%}) = 0.95 \\cdot C_{ss}$：\n$$\n0.95 \\cdot C_{ss} = C_{ss} \\left(1 - \\exp\\left(-\\frac{Cl}{V_{d}} t_{95\\%}\\right)\\right)\n$$\n两边除以 $C_{ss}$（非零）：\n$$\n0.95 = 1 - \\exp\\left(-\\frac{Cl}{V_{d}} t_{95\\%}\\right)\n$$\n整理各项以求解指数项：\n$$\n\\exp\\left(-\\frac{Cl}{V_{d}} t_{95\\%}\\right) = 1 - 0.95 = 0.05\n$$\n对两边取自然对数：\n$$\n-\\frac{Cl}{V_{d}} t_{95\\%} = \\ln(0.05)\n$$\n求解 $t_{95\\%}$：\n$$\nt_{95\\%} = -\\frac{V_{d}}{Cl} \\ln(0.05) = \\frac{V_{d}}{Cl} \\ln\\left(\\frac{1}{0.05}\\right) = \\frac{V_{d}}{Cl} \\ln(20)\n$$\n现在，我们代入数值 $V_{d} = 40\\ \\text{L}$ 和 $Cl = 12\\ \\text{L}\\ \\text{h}^{-1}$：\n$$\nt_{95\\%} = \\frac{40\\ \\text{L}}{12\\ \\text{L}\\ \\text{h}^{-1}} \\ln(20) = \\frac{10}{3} \\ln(20)\\ \\text{h}\n$$\n计算数值：\n$$\n\\ln(20) \\approx 2.99573227\n$$\n$$\nt_{95\\%} \\approx \\frac{10}{3} \\times 2.99573227 \\approx 9.9857742\\ \\text{h}\n$$\n将结果四舍五入到四位有效数字，得到 $t_{95\\%} = 9.986\\ \\text{h}$。\n\n最终结果是 $C_{ss} = 2.000\\ \\text{mg}\\ \\text{L}^{-1}$，达到 $95\\%$ $C_{ss}$ 所需的时间为 $9.986\\ \\text{h}$。", "answer": "$$\\boxed{\\begin{pmatrix} 2.000 & 9.986 \\end{pmatrix}}$$", "id": "2617344"}, {"introduction": "下丘脑-垂体轴的一个关键特征是其脉冲式的激素释放，这对维持其正常功能至关重要。本练习将让您扮演定量生理学家的角色，从充满噪声的激素时间序列数据中提取出潜在的脉冲频率 [@problem_id:2617406]。这项计算实践将指导您完成一个完整的信号处理流程，包括数据预处理、傅里叶分析以及应用基于规则的算法来检测主要的生理频率。通过此练习，您将掌握分析生物信号和定量推断（如促性腺激素释放激素（GnRH）脉冲发生器）等隐藏神经振荡器活动的前沿核心技能。", "problem": "您的任务是通过分析黄体生成素 (LH) 时间序列的频率成分，来推断下丘脑促性腺激素释放激素 (GnRH) 脉冲发生器的活动。请使用下丘脑-垂体-性腺 (HPG) 轴框架，在该框架中，脉冲式促性腺激素释放激素 (GnRH) 通过一个可近似为线性时不变系统的垂体反应，驱动脉冲式的 LH 分泌。根据采样理论和信号分析的基本原理，实现一种方法，对于给定的已采样 LH 时间序列，计算其功率谱并识别主导的生理脉冲频率。假设垂体映射不改变频率，将此主导 LH 频率与推断的 GnRH 脉冲发生器频率相关联。在每种情况下，最终需要关注的量是推断出的 GnRH 脉冲频率，单位为脉冲/小时。最终答案以脉冲/小时为单位，并四舍五入到三位小数。\n\n设计要求：\n- 每个测试用例的输入模型：合成一个 LH 时间序列，该序列是一个或两个代表超日节律脉冲的正弦分量，加上可选的低频基线漂移，以均匀采样方式获得，并带有加性零均值高斯噪声。正弦分量的相位以弧度为单位，可以是任意值。\n- 预处理：移除均值并应用一个平滑的对称锥形窗（例如，Hann 窗）以减少谱泄漏。\n- 谱估计：使用基于离散傅里叶变换的方法计算功率谱。利用采样定理将离散频率仓映射到物理频率（单位：周期/小时）。\n- 生理频带：仅在 $[0.2, 2.0]$ 脉冲/小时的生理频带内搜索主导脉冲。\n- 采样约束：遵守由采样间隔决定的奈奎斯特极限 $f_{\\mathrm{N}}$。如果 $0.9 f_{\\mathrm{N}} \\le 0.2$ 脉冲/小时，则宣布对于该情况，可靠检测是不可能的。\n- 检测规则：将生理频带内功率最高的频率定为主导频率。仅当两个条件同时成立时，才接受其为脉冲频率：(i) 峰值功率与频带内功率中位数的比率至少为 $6.0$（无量纲），并且 (ii) 总记录时长包含至少 $3$ 个候选频率的周期。否则，宣布无可靠检测。\n- 到 GnRH 的映射：在线性时不变近似下，将接受的 LH 主导频率直接映射到推断的 GnRH 脉冲发生器频率。\n\n测试套件（每个用例指定了采样间隔、总时长、用于 LH 脉冲的正弦分量、可选漂移和噪声标准差）。对于所有用例，振幅单位为国际单位/升 (IU/L)，时间单位为小时或分钟（如指定），频率单位为脉冲/小时。您必须使用这些确切的参数集来生成时间序列：\n- 用例 A（理想情况）：采样间隔 $\\Delta t = 5$ 分钟；总时长 $T = 8$ 小时；一个 LH 分量，振幅 $A_1 = 2.0$，频率 $f_1 = 1.0$；无第二个 LH 分量；无漂移；噪声标准差 $\\sigma = 0.4$。\n- 用例 B（双组分竞争）：$\\Delta t = 5$ 分钟；$T = 8$ 小时；两个 LH 分量：$(A_1, f_1) = (2.0, 0.6)$ 和 $(A_2, f_2) = (1.2, 1.2)$；无漂移；$\\sigma = 0.5$。\n- 用例 C（采样过于稀疏）：$\\Delta t = 180$ 分钟；$T = 12$ 小时；一个 LH 分量：$(A_1, f_1) = (2.0, 0.5)$；无漂移；$\\sigma = 0.5$。此用例故意违反了生理频带的采样要求。\n- 用例 D（低频漂移干扰）：$\\Delta t = 10$ 分钟；$T = 12$ 小时；一个 LH 分量：$(A_1, f_1) = (1.5, 0.5)$；一个漂移分量，振幅 $A_d = 4.0$，频率 $f_d = 0.05$；$\\sigma = 0.3$。\n\n对于每个用例，请实施完整的流程并输出推断的 GnRH 脉冲频率（单位：脉冲/小时）。如果检测规则失败或采样约束使得检测不可能，则输出 $-1.0$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的结果列表，并用方括号括起来，顺序与测试套件相同：$[\\text{result}_A,\\text{result}_B,\\text{result}_C,\\text{result}_D]$。\n- 每个结果必须四舍五入到三位小数，并以脉冲/小时为单位表示。", "solution": "该问题要求从黄体生成素 (LH) 浓度的时间序列中推断下丘脑促性腺激素释放激素 (GnRH) 脉冲发生器的频率。这是一个生理信号处理问题。其基本前提是垂体作为一个线性时不变 (LTI) 系统，这意味着输入信号（脉冲式 GnRH）的频率成分在输出信号（脉冲式 LH）中得以保留。因此，LH 脉冲的主导频率对应于 GnRH 的脉冲频率。\n\n解决方案是一个多步骤过程，涉及时间序列合成、信号预处理、频谱分析以及特定检测算法的应用。\n\n**1. 模型与时间序列合成**\n\nLH 时间序列被建模为从连续信号 $L(t)$ 采样的离散信号 $y[k]$。该连续信号是一个或两个代表生理脉冲的正弦分量、一个可选的低频漂移分量以及加性高斯白噪声 $\\epsilon(t)$ 的叠加。该模型由以下公式给出：\n$$L(t) = \\sum_{i=1}^{N_{comp}} A_i \\sin(2\\pi f_i t + \\phi_i) + A_d \\sin(2\\pi f_d t + \\phi_d) + \\epsilon(t)$$\n其中 $A_i$ 和 $f_i$ 是第 $i$ 个脉冲分量的振幅和频率，$A_d$ 和 $f_d$ 是漂移的振幅和频率，$\\phi_i$ 和 $\\phi_d$ 是任意相位（对于功率谱分析，我们可以将其设为 $0$ 而不失一般性），$\\epsilon(t)$ 是一个噪声过程，其中 $\\epsilon \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n时间序列 $y[k]$ 是通过在总时长 $T$ 内以均匀间隔 $\\Delta t$ 采样 $L(t)$ 来生成的。离散时间点为 $t_k = k \\Delta t$，其中 $k = 0, 1, \\dots, N-1$。样本数量 $N$ 由 $N = \\text{floor}(T / \\Delta t)$ 确定。\n\n**2. 采样理论与频率分辨率**\n\n根据奈奎斯特-香农采样定理，如果采样频率 $f_s = 1/\\Delta t$ 大于信号中最大频率的两倍，那么连续信号可以从其样本中完美重建。奈奎斯特频率 $f_N = f_s/2 = 1/(2\\Delta t)$ 代表了可以从采样数据中无歧义地解析的最高频率。\n\n问题针对感兴趣的生理频带 $[0.2, 2.0]$ 脉冲/小时施加了一个采样约束。该约束是，如果 $0.9 f_N \\le 0.2$，则认为采样率对于在该频带内进行可靠检测来说太低。在这种情况下，分析将终止，结果被宣布为无法确定。\n\n离散傅里叶变换 (DFT) 用于将时域信号转换为频域。对于长度为 $N$、采样间隔为 $\\Delta t$ 的信号，DFT 产生 $N$ 个复系数，对应于频率 $f_m = m \\cdot \\frac{f_s}{N} = \\frac{m}{N \\Delta t}$，其中 $m = 0, 1, \\dots, N-1$。频谱的频率分辨率为 $\\Delta f = f_s/N = 1/(N \\Delta t)$。\n\n**3. 信号预处理**\n\n在频谱分析之前，两个预处理步骤至关重要：\n- **去除均值**：从信号中减去样本均值 $\\bar{y} = \\frac{1}{N} \\sum_{k=0}^{N-1} y[k]$。这可以移除频谱的直流分量 ($f=0$)，该分量通常很大，可能会掩盖附近的低频生理信号。\n- **加窗**：将去除均值后的信号乘以一个窗函数。文中以 Hann 窗为例。长度为 $N$ 的 Hann 窗 $w[k]$ 的公式为：\n$$w[k] = 0.5 \\left(1 - \\cos\\left(\\frac{2\\pi k}{N-1}\\right)\\right), \\quad k = 0, \\dots, N-1$$\n加窗使信号在其两端逐渐变细至零，这显著减少了谱泄漏。谱泄漏是一种现象，即有限时长信号的真实频率能量在 DFT 中扩散到相邻的频率仓，可能产生杂散峰值或掩盖较弱的信号。\n\n**4. 功率谱估计**\n\n功率谱由预处理后信号的 DFT 计算得出。设 $Y[m]$ 为加窗、中心化后信号的 DFT。\n$$Y[m] = \\sum_{k=0}^{N-1} (y[k] - \\bar{y}) w[k] e^{-j2\\pi mk/N}$$\n每个频率仓 $f_m$ 的功率与 DFT 系数的幅值平方成正比，即 $P[m] \\propto |Y[m]|^2$。由于输入信号是实数，功率谱是对称的，我们只需要分析正频率的单边谱，即 $m = 0, \\dots, \\lfloor N/2 \\rfloor$。\n\n**5. 主导频率检测算法**\n\n推断的核心在于应用于所计算功率谱的基于规则的检测算法。\n- **生理频带搜索**：主导频率的搜索被限制在预先指定的生理范围 $[0.2, 2.0]$ 脉冲/小时内。此约束基于已建立的关于 LH 脉冲频率的生物学知识。\n- **峰值识别**：在此频带内，将对应于最大功率值 $P_{peak}$ 的频率 $f_{peak}$ 识别为候选主导频率。\n- **检测标准**：候选频率 $f_{peak}$ 仅在两个条件同时满足时，才被接受为有效的生理脉冲频率：\n    1.  **峰值显著性**：峰值功率与生理频带内所有谱估计值的中位数之比必须至少为 $6.0$。\n    $$ \\frac{P_{peak}}{P_{median}} \\ge 6.0 $$\n    该标准确保所识别的峰值在统计上是显著的，并且与频带内的背景噪声谱有足够的区分度。\n    2.  **充分观测**：数据记录的总时长 $T$ 必须足够长，以包含至少 $3$ 个候选频率的完整周期。\n    $$ T \\cdot f_{peak} \\ge 3.0 $$\n    此条件确保振荡不是瞬态伪影，并且已被观测足够长的时间，可被视为信号的一个持久特征。\n\n如果两个条件都满足，则 $f_{peak}$ 被接受为推断的 LH 脉冲频率。根据 LTI 假设，这也是推断的 GnRH 脉冲发生器频率。如果任一条件失败，或者初始采样约束被违反，或者生理频带内没有频谱数据，则无法确定可靠的脉冲频率，结果记为 $-1.0$。\n\n对每个测试用例实施这整个过程，以得出最终结果。\n\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print results.\n    \"\"\"\n    # Use a fixed random seed for reproducibility of the noise component.\n    np.random.seed(42)\n\n    # Define test cases as per the problem statement.\n    # Structure: (delta_t in minutes, T in hours, components, drift, sigma)\n    # Components are lists of (Amplitude, Frequency in pulses/hr, Phase in rad).\n    # Drift is (Amplitude, Frequency, Phase) or None.\n    test_cases = {\n        'A': (5, 8, [(2.0, 1.0, 0)], None, 0.4),\n        'B': (5, 8, [(2.0, 0.6, 0), (1.2, 1.2, 0)], None, 0.5),\n        'C': (180, 12, [(2.0, 0.5, 0)], None, 0.5),\n        'D': (10, 12, [(1.5, 0.5, 0)], (4.0, 0.05, 0), 0.3),\n    }\n\n    results = []\n    # Process each case in the specified order A, B, C, D\n    for case_id in sorted(test_cases.keys()):\n        delta_t_min, T_hr, components, drift, sigma = test_cases[case_id]\n        result = _analyze_lh_series(delta_t_min, T_hr, components, drift, sigma)\n        results.append(result)\n\n    # Return the list of results for formatting in the answer tag.\n    return results\n\ndef _analyze_lh_series(delta_t_min, T_hr, components, drift, sigma):\n    \"\"\"\n    Analyzes a single synthesized LH time series to infer GnRH pulse frequency.\n    \"\"\"\n    PHYSIOLOGICAL_BAND_HZ = [0.2, 2.0]\n    PEAK_TO_MEDIAN_RATIO_THR = 6.0\n    MIN_CYCLES_THR = 3.0\n\n    # 1. Convert units and check sampling constraint\n    delta_t_hr = delta_t_min / 60.0\n    sampling_freq_hz = 1.0 / delta_t_hr\n    nyquist_freq_hz = sampling_freq_hz / 2.0\n    \n    if 0.9 * nyquist_freq_hz = PHYSIOLOGICAL_BAND_HZ[0]:\n        return -1.0\n\n    # 2. Synthesize the LH time series\n    time_vector = np.arange(0, T_hr, delta_t_hr)\n    n_samples = len(time_vector)\n    \n    signal = np.zeros(n_samples)\n    for A, f, phase in components:\n        signal += A * np.sin(2 * np.pi * f * time_vector + phase)\n    \n    if drift:\n        A_d, f_d, phase_d = drift\n        signal += A_d * np.sin(2 * np.pi * f_d * time_vector + phase_d)\n    \n    noise = np.random.normal(0, sigma, n_samples)\n    lh_series = signal + noise\n\n    # 3. Preprocess the signal\n    # Remove the mean\n    processed_series = lh_series - np.mean(lh_series)\n\n    # Apply a Hann window\n    hann_window = np.hanning(n_samples)\n    windowed_series = processed_series * hann_window\n\n    # 4. Compute the power spectrum using FFT\n    # Use the same number of points as the signal for the FFT\n    fft_result = np.fft.fft(windowed_series)\n    \n    # One-sided power spectrum (proportional to magnitude squared)\n    power_spectrum = np.abs(fft_result[:n_samples // 2])**2\n    \n    # Corresponding frequency bins\n    freq_bins = np.fft.fftfreq(n_samples, d=delta_t_hr)[:n_samples // 2]\n\n    # 5. Analyze the spectrum within the physiological band\n    band_indices = np.where(\n        (freq_bins >= PHYSIOLOGICAL_BAND_HZ[0])  \n        (freq_bins = PHYSIOLOGICAL_BAND_HZ[1])\n    )[0]\n\n    if len(band_indices) == 0:\n        return -1.0  # No spectral data in the band of interest\n\n    band_freqs = freq_bins[band_indices]\n    band_power = power_spectrum[band_indices]\n    \n    # Find the dominant peak in the band\n    if len(band_power) == 0:\n        return -1.0\n        \n    peak_power_index_in_band = np.argmax(band_power)\n    peak_power = band_power[peak_power_index_in_band]\n    peak_freq = band_freqs[peak_power_index_in_band]\n\n    # Calculate the median power within the band\n    median_power = np.median(band_power)\n    \n    # 6. Apply detection rules\n    # Rule (i): Peak-to-median ratio\n    if median_power > 0:\n        ratio = peak_power / median_power\n        ratio_check = ratio >= PEAK_TO_MEDIAN_RATIO_THR\n    else:\n        # If median power is zero, a non-zero peak is infinitely prominent\n        ratio_check = peak_power > 0\n\n    # Rule (ii): Minimum number of cycles observed\n    cycles_check = T_hr * peak_freq >= MIN_CYCLES_THR\n    \n    if ratio_check and cycles_check:\n        return peak_freq\n    else:\n        return -1.0\n\n# This part is for conceptual execution; the final answer tag will contain the formatted result.\n# final_results = solve()\n# final_output_string = f\"[{','.join(f'{r:.3f}' for r in final_results)}]\" # -> [1.000,0.625,-1.000,0.500]\n```", "answer": "$$\\boxed{[1.000, 0.625, -1.000, 0.500]}$$", "id": "2617406"}]}