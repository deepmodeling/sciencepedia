{"hands_on_practices": [{"introduction": "对钙稳态的理解始于肠道。钙的吸收是维持体内平衡的第一步，但并非所有膳食中的钙都可被身体吸收利用。本练习将引导你将化学平衡原理应用于一个生理场景[@problem_id:2564968]。通过计算在常见膳食抑制剂（如植酸盐和草酸盐）存在下的游离钙离子浓度，你将对饮食成分如何直接影响可吸收钙的有效性有一个定量的认识。", "problem": "餐后十二指肠腔内含有可溶性钙和两种已知的通过形成可溶性复合物来抑制钙吸收的膳食阴离子：草酸盐和植酸盐（肌醇六磷酸）。钙稳态的内分泌调控，特别是通过甲状旁腺素 (PTH) 和1,25-二羟基维生素D (骨化三醇)，主要通过调节上皮转运途径来发挥作用，而这些途径的驱动力取决于腔内游离钙离子的活度。为定量地将腔内络合作用与该驱动力联系起来，请从条件稳定常数的定义、质量作用定律和质量平衡约束出发，在以下科学真实且自洽的条件下计算游离钙浓度。\n\n假设在稳态和 $\\mathrm{pH} = 6.5$ 时，肠腔的组分如下：\n- 总钙浓度 $C_{\\mathrm{T}} = 3.00 \\times 10^{-3}\\ \\mathrm{M}$。\n- 总草酸盐浓度 $O_{\\mathrm{T}} = 5.00 \\times 10^{-4}\\ \\mathrm{M}$。\n- 总植酸盐浓度 $P_{\\mathrm{T}} = 2.00 \\times 10^{-4}\\ \\mathrm{M}$。\n\n在 $\\mathrm{pH} = 6.5$ 和代表小肠腔的离子强度下，主要可溶性复合物的条件（质子化状态平均的）$1:1$ 形成常数如下：\n- 钙–草酸盐：$\\mathrm{Ca}^{2+} + \\mathrm{Ox}^{2-} \\rightleftharpoons \\mathrm{CaOx}^{0}$，其 $K_{\\mathrm{ox}} = 1.00 \\times 10^{3}\\ \\mathrm{M}^{-1}$。\n- 钙–植酸盐：$\\mathrm{Ca}^{2+} + \\mathrm{Phy}^{n-} \\rightleftharpoons \\mathrm{CaPhy}^{(n-2)-}$，其 $K_{\\mathrm{phy}} = 1.00 \\times 10^{5}\\ \\mathrm{M}^{-1}$。\n\n假设这些条件常数已经包含了在 $\\mathrm{pH} = 6.5$ 下的配体质子化效应，在此条件下更高化学计量的复合物可忽略不计，活度系数为1，并且该体系相对于草酸钙沉淀是亚稳态的，因此在所考虑的时间范围内没有固相形成。不存在其他浓度可观的钙结合配体。\n\n请仅使用质量作用定律和元素质量平衡，确定腔内稳态下游离钙浓度 $[\\mathrm{Ca}^{2+}]$。请用单位微摩尔/升 (micromolar) 表示您的最终答案，并四舍五入至三位有效数字。", "solution": "如题所述，要求确定在含有竞争性配体草酸盐和植酸盐的溶液中，游离钙离子浓度 $[\\mathrm{Ca}^{2+}]$。该问题具有科学依据，提法严谨，并提供了一套自洽的数据和约束条件。这是一个标准的化学平衡问题，可以使用质量作用定律和质量平衡方程来解决。因此，该问题是有效的，并将推导求解。\n\n该体系由以下平衡反应定义，这些反应受其在固定 $\\mathrm{pH}$ 为 $6.5$ 时的相应条件稳定常数控制：\n1.  钙-草酸盐复合物的形成：\n    $$ \\mathrm{Ca}^{2+} + \\mathrm{Ox}_{\\text{free}} \\rightleftharpoons \\mathrm{CaOx} $$\n    平衡由质量作用定律描述：\n    $$ K_{\\mathrm{ox}} = \\frac{[\\mathrm{CaOx}]}{[\\mathrm{Ca}^{2+}][\\mathrm{Ox}_{\\text{free}}]} = 1.00 \\times 10^{3}\\ \\mathrm{M}^{-1} $$\n    此处，$[\\mathrm{Ox}_{\\text{free}}]$ 代表所有未与钙结合的草酸盐物种的总浓度。\n\n2.  钙-植酸盐复合物的形成：\n    $$ \\mathrm{Ca}^{2+} + \\mathrm{Phy}_{\\text{free}} \\rightleftharpoons \\mathrm{CaPhy} $$\n    该平衡由以下公式描述：\n    $$ K_{\\mathrm{phy}} = \\frac{[\\mathrm{CaPhy}]}{[\\mathrm{Ca}^{2+}][\\mathrm{Phy}_{\\text{free}}]} = 1.00 \\times 10^{5}\\ \\mathrm{M}^{-1} $$\n    此处，$[\\mathrm{Phy}_{\\text{free}}]$ 代表所有未与钙结合的植酸盐物种的总浓度。\n\n所有组分的总浓度受以下质量平衡方程约束：\n- 总钙：\n  $$ C_{\\mathrm{T}} = [\\mathrm{Ca}^{2+}] + [\\mathrm{CaOx}] + [\\mathrm{CaPhy}] = 3.00 \\times 10^{-3}\\ \\mathrm{M} $$\n- 总草酸盐：\n  $$ O_{\\mathrm{T}} = [\\mathrm{Ox}_{\\text{free}}] + [\\mathrm{CaOx}] = 5.00 \\times 10^{-4}\\ \\mathrm{M} $$\n- 总植酸盐：\n  $$ P_{\\mathrm{T}} = [\\mathrm{Phy}_{\\text{free}}] + [\\mathrm{CaPhy}] = 2.00 \\times 10^{-4}\\ \\mathrm{M} $$\n\n为了求解游离钙浓度，记为 $x = [\\mathrm{Ca}^{2+}]$, 我们必须首先将络合物质 $[\\mathrm{CaOx}]$ 和 $[\\mathrm{CaPhy}]$ 的浓度表示为 $x$ 的函数。\n\n从草酸盐的质量平衡中，我们将 $[\\mathrm{Ox}_{\\text{free}}]$ 表示为：\n$$ [\\mathrm{Ox}_{\\text{free}}] = O_{\\mathrm{T}} - [\\mathrm{CaOx}] $$\n将此代入 $K_{\\mathrm{ox}}$ 的平衡表达式中：\n$$ K_{\\mathrm{ox}} = \\frac{[\\mathrm{CaOx}]}{x (O_{\\mathrm{T}} - [\\mathrm{CaOx}])} $$\n整理以求解 $[\\mathrm{CaOx}]$：\n$$ K_{\\mathrm{ox}} x (O_{\\mathrm{T}} - [\\mathrm{CaOx}]) = [\\mathrm{CaOx}] $$\n$$ K_{\\mathrm{ox}} x O_{\\mathrm{T}} - K_{\\mathrm{ox}} x [\\mathrm{CaOx}] = [\\mathrm{CaOx}] $$\n$$ K_{\\mathrm{ox}} x O_{\\mathrm{T}} = [\\mathrm{CaOx}] (1 + K_{\\mathrm{ox}} x) $$\n$$ [\\mathrm{CaOx}] = \\frac{K_{\\mathrm{ox}} O_{\\mathrm{T}} x}{1 + K_{\\mathrm{ox}} x} $$\n\n对植酸盐进行相同的推导，我们得到：\n$$ [\\mathrm{CaPhy}] = \\frac{K_{\\mathrm{phy}} P_{\\mathrm{T}} x}{1 + K_{\\mathrm{phy}} x} $$\n\n现在，将这些络合物质的表达式代入钙的质量平衡方程中：\n$$ C_{\\mathrm{T}} = x + \\frac{K_{\\mathrm{ox}} O_{\\mathrm{T}} x}{1 + K_{\\mathrm{ox}} x} + \\frac{K_{\\mathrm{phy}} P_{\\mathrm{T}} x}{1 + K_{\\mathrm{phy}} x} $$\n\n这个方程建立了未知游离钙浓度 $x$ 与已知的总浓度和稳定常数之间的关系。我们必须求解 $x$。这是一个非线性方程，不易通过直接代数重排成一个简单的多项式来求解。然而，由于钙相对于总配体浓度在化学计量上是过量的（$C_{\\mathrm{T}} = 3.00 \\times 10^{-3}\\ \\mathrm{M}$ 而 $O_{\\mathrm{T}} + P_{\\mathrm{T}} = 7.00 \\times 10^{-4}\\ \\mathrm{M}$），我们可以预期游离钙浓度 $x$ 将与 $C_{\\mathrm{T}}$ 处于同一数量级。\n采用迭代数值方法是合适的。我们定义一个函数 $f(x)$，使其根为所求的解：\n$$ f(x) = x + \\frac{K_{\\mathrm{ox}} O_{\\mathrm{T}} x}{1 + K_{\\mathrm{ox}} x} + \\frac{K_{\\mathrm{phy}} P_{\\mathrm{T}} x}{1 + K_{\\mathrm{phy}} x} - C_{\\mathrm{T}} = 0 $$\n我们寻找满足此方程的 $x$ 值。函数 $f(x)$ 在 $x > 0$ 时是单调递增的，这保证了存在唯一的正解。\n\n让我们使用给定的值：\n- $C_{\\mathrm{T}} = 3.00 \\times 10^{-3}$\n- $O_{\\mathrm{T}} = 5.00 \\times 10^{-4}$\n- $P_{\\mathrm{T}} = 2.00 \\times 10^{-4}$\n- $K_{\\mathrm{ox}} = 1.00 \\times 10^{3}$\n- $K_{\\mathrm{phy}} = 1.00 \\times 10^{5}$\n\n$x$ 的一个合理初始估计值是 $C_{\\mathrm{T}} - O_{\\mathrm{T}} - P_{\\mathrm{T}} = 2.30 \\times 10^{-3}\\ \\mathrm{M}$。我们测试 $x_0 = 2.30 \\times 10^{-3}$：\n$$ f(x_0) = 2.30 \\times 10^{-3} + \\frac{(10^3)(5 \\times 10^{-4})(2.3 \\times 10^{-3})}{1 + (10^3)(2.3 \\times 10^{-3})} + \\frac{(10^5)(2 \\times 10^{-4})(2.3 \\times 10^{-3})}{1 + (10^5)(2.3 \\times 10^{-3})} - 3.00 \\times 10^{-3} $$\n$$ f(x_0) = 2.30 \\times 10^{-3} + \\frac{1.15 \\times 10^{-3}}{1 + 2.3} + \\frac{4.6 \\times 10^{-2}}{1 + 230} - 3.00 \\times 10^{-3} $$\n$$ f(x_0) = 2.30 \\times 10^{-3} + 0.3485 \\times 10^{-3} + 0.1991 \\times 10^{-3} - 3.00 \\times 10^{-3} $$\n$$ f(x_0) = (2.30 + 0.3485 + 0.1991 - 3.00) \\times 10^{-3} = -0.1524 \\times 10^{-3} $$\n结果为负，表明估计值 $x_0$ 太低。让我们尝试一个更高的值，例如 $x_1 = 2.45 \\times 10^{-3}$：\n$$ f(x_1) = 2.45 \\times 10^{-3} + \\frac{(10^3)(5 \\times 10^{-4})(2.45 \\times 10^{-3})}{1 + (10^3)(2.45 \\times 10^{-3})} + \\frac{(10^5)(2 \\times 10^{-4})(2.45 \\times 10^{-3})}{1 + (10^5)(2.45 \\times 10^{-3})} - 3.00 \\times 10^{-3} $$\n$$ f(x_1) = 2.45 \\times 10^{-3} + \\frac{1.225 \\times 10^{-3}}{1 + 2.45} + \\frac{4.9 \\times 10^{-2}}{1 + 245} - 3.00 \\times 10^{-3} $$\n$$ f(x_1) = 2.45 \\times 10^{-3} + 0.3551 \\times 10^{-3} + 0.1992 \\times 10^{-3} - 3.00 \\times 10^{-3} $$\n$$ f(x_1) = (2.45 + 0.3551 + 0.1992 - 3.00) \\times 10^{-3} = 0.0043 \\times 10^{-3} $$\n这个结果非常接近于零且为正，表明 $x$ 略小于 $2.45 \\times 10^{-3}\\ \\mathrm{M}$。在计算出的点 $(2.30 \\times 10^{-3}, -0.1524 \\times 10^{-3})$ 和 $(2.45 \\times 10^{-3}, 0.0043 \\times 10^{-3})$ 之间进行线性插值可以得到更精确的答案。\n相应的总钙浓度为 $C_{\\mathrm{T,0}} = 2.8476 \\times 10^{-3}\\ \\mathrm{M}$ 和 $C_{\\mathrm{T,1}} = 3.0043 \\times 10^{-3}\\ \\mathrm{M}$。\n进行插值以找到使 $C_{\\mathrm{T}} = 3.000 \\times 10^{-3}\\ \\mathrm{M}$ 的 $x$ 值：\n$$ x \\approx x_1 - (x_1 - x_0) \\frac{C_{\\mathrm{T,1}} - C_{\\mathrm{T}}}{C_{\\mathrm{T,1}} - C_{\\mathrm{T,0}}} $$\n$$ x \\approx 2.45 \\times 10^{-3} - (0.15 \\times 10^{-3}) \\frac{3.0043 \\times 10^{-3} - 3.000 \\times 10^{-3}}{3.0043 \\times 10^{-3} - 2.8476 \\times 10^{-3}} $$\n$$ x \\approx 2.45 \\times 10^{-3} - (0.15 \\times 10^{-3}) \\frac{0.0043}{0.1567} $$\n$$ x \\approx 2.45 \\times 10^{-3} - 0.0041 \\times 10^{-3} = 2.4459 \\times 10^{-3}\\ \\mathrm{M} $$\n游离钙浓度为 $x = [\\mathrm{Ca}^{2+}] \\approx 2.4459 \\times 10^{-3}\\ \\mathrm{M}$。\n\n题目要求答案以微摩尔/升 ($\\mu\\mathrm{M}$) 为单位，并四舍五入到三位有效数字。\n$$ [\\mathrm{Ca}^{2+}] = 2.4459 \\times 10^{-3}\\ \\mathrm{mol/L} \\times \\frac{10^6\\ \\mu\\mathrm{mol}}{1\\ \\mathrm{mol}} = 2445.9\\ \\mu\\mathrm{M} $$\n四舍五入到三位有效数字得到 $2450\\ \\mu\\mathrm{M}$。为了避免有效数字的歧义，最好用科学记数法表示。\n$$ [\\mathrm{Ca}^{2+}] = 2.45 \\times 10^{3}\\ \\mu\\mathrm{M} $$", "answer": "$$\\boxed{2.45 \\times 10^{3}}$$", "id": "2564968"}, {"introduction": "钙稳态的基石是血浆钙与甲状旁腺激素(PTH)分泌之间极其敏感的反馈回路。此关系并非线性，而是一条可以用希尔方程描述的陡峭的S型曲线。本练习[@problem_id:2564921]挑战你超越定性描述，采用计算方法来量化这一核心调控机制。你将通过将数学模型与生理数据进行拟合，来定量地定义系统的“设定点”及其敏感性——这些是表征个体钙调控特征的关键参数。", "problem": "甲状旁腺主细胞分泌甲状旁腺激素 (PTH) 的过程受细胞外离子钙通过钙敏感受体 (CaSR) 的调节。根据经验，作为细胞外钙函数之一的稳态 PTH 分泌速率，可通过一个能够体现受体占据和协同性的抑制性希尔方程进行建模。考虑一个抑制性协同响应函数，该函数将细胞外钙浓度 $[\\mathrm{Ca}^{2+}]$（单位为 $\\mathrm{mmol}/\\mathrm{L}$）映射到 PTH 分泌速率 $P$（单位为 $\\mathrm{pg}/\\mathrm{mL}$）。此函数包含基础分泌 $P_0$、在基础之上的最大动态增量 $\\Delta P$、钙设定标度 $K$（单位为 $\\mathrm{mmol}/\\mathrm{L}$）以及希尔系数 $n$（无量纲协同性）。假设 PTH 随着 $[\\mathrm{Ca}^{2+}]$ 的增加而单调递减。\n\n从以下基本原理出发：稳态下的受体介导响应可由源自具有协同性的质量作用占据的希尔型关系近似；且 PTH 调控的设定点是使 PTH 分泌处于其动态范围中点时的钙浓度。请您建立并拟合一个协同抑制性希尔模型到合成数据集，然后为每个数据集提取两个总结性量：\n- 钙设定点（单位为 $\\mathrm{mmol}/\\mathrm{L}$），定义为能产生基础分泌与最大分泌之间中点 PTH 水平的 $[\\mathrm{Ca}^{2+}]$ 值，以及\n- 在设定点处求得的 PTH-钙曲线的局部斜率（单位为 $\\mathrm{pg}/\\mathrm{mL}$ 每 $\\mathrm{mmol}/\\mathrm{L}$）。\n\n您的程序必须对提供的各数据集实现一个协同抑制性希尔模型 $\\{P_0,\\Delta P,K,n\\}$ 的非线性最小二乘拟合，并遵循符合生物学现实的约束条件 $P_0 \\ge 0$、$\\Delta P \\ge 0$、$K > 0$ 及 $n > 0$。不要对模型进行线性化。使用有物理意义的初始猜测值和边界以确保收敛。拟合后，根据您拟合的模型，从第一性原理出发计算设定点和在设定点处的斜率。设定点以 $\\mathrm{mmol}/\\mathrm{L}$ 为单位表示，斜率以 $\\mathrm{pg}/\\mathrm{mL}$ 每 $\\mathrm{mmol}/\\mathrm{L}$ 为单位表示。\n\n测试套件。通过在指定的钙浓度网格上使用以下参数集评估协同抑制性希尔模型，生成四个合成数据集。对于每种情况，请根据模型精确计算无噪声的 PTH 值；不要添加噪声。\n\n- 情况 A（典型协同响应）：\n  - 真实参数 $(P_0,P_{\\max},K,n)$: $(15.0, 120.0, 1.18, 3.0)$，其中 $P_{\\max}$ 表示极低钙浓度下的渐近 PTH。在内部使用 $\\Delta P = P_{\\max} - P_0$。\n  - 钙浓度网格（单位为 $\\mathrm{mmol}/\\mathrm{L}$）：$[0.95, 1.05, 1.15, 1.18, 1.25, 1.35, 1.45]$。\n\n- 情况 B（近非协同响应）：\n  - 真实参数 $(P_0,P_{\\max},K,n)$: $(10.0, 80.0, 1.25, 1.0)$。\n  - 钙浓度网格（单位为 $\\mathrm{mmol}/\\mathrm{L}$）：$[1.00, 1.10, 1.20, 1.25, 1.30, 1.40, 1.50]$。\n\n- 情况 C（窄动态范围）：\n  - 真实参数 $(P_0,P_{\\max},K,n)$: $(20.0, 35.0, 1.20, 2.0)$。\n  - 钙浓度网格（单位为 $\\mathrm{mmol}/\\mathrm{L}$）：$[0.90, 1.00, 1.10, 1.20, 1.30, 1.40]$。\n\n- 情况 D（高协同性）：\n  - 真实参数 $(P_0,P_{\\max},K,n)$: $(12.0, 150.0, 1.30, 5.0)$。\n  - 钙浓度网格（单位为 $\\mathrm{mmol}/\\mathrm{L}$）：$[1.05, 1.15, 1.25, 1.30, 1.35, 1.45]$。\n\n对于每种情况，在给定的钙浓度网格上，使用指定的真实参数，通过抑制性希尔模型 $$P([\\mathrm{Ca}^{2+}]) = P_0 + \\dfrac{\\Delta P}{1 + \\left( \\dfrac{[\\mathrm{Ca}^{2+}]}{K} \\right)^{n}}$$ 生成 PTH 值 $P([\\mathrm{Ca}^{2+}])$。\n\n拟合与输出。对于每个数据集：\n- 拟合模型 $P([\\mathrm{Ca}^{2+}]) = P_0 + \\dfrac{\\Delta P}{1 + \\left( \\dfrac{[\\mathrm{Ca}^{2+}]}{K} \\right)^{n}}$ 以复原 $(P_0,\\Delta P,K,n)$。\n- 将设定点定义为模型预测值等于中点值 $P_0 + \\dfrac{\\Delta P}{2}$ 时的钙浓度，并从拟合的模型中计算它。\n- 使用您拟合的参数和模型的微积分导数，将斜率计算为在设定点处求值的导数 $\\dfrac{dP}{d[\\mathrm{Ca}^{2+}]}$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。列表中的每个结果均为一个双元素列表 $[\\text{set\\_point}, \\text{slope}]$，按 A、B、C、D 的顺序对应相应的测试用例。将设定点格式化为恰好三位小数（单位为 $\\mathrm{mmol}/\\mathrm{L}$），并将斜率格式化为恰好一位小数（单位为 $\\mathrm{pg}/\\mathrm{mL}$ 每 $\\mathrm{mmol}/\\mathrm{L}$）。例如，一个有效的输出行格式为 $[[x_1, y_1],[x_2, y_2],[x_3, y_3],[x_4, y_4]]$，使用十进制数字，而非百分比。\n\n此问题不涉及角度单位。除指定单位外，无需其他物理单位。输出必须仅包含此单行，格式需与描述完全一致，不得包含额外文本。", "solution": "所提出的问题是定量生理学中一个定义明确的练习，要求应用数学建模和数值方法来分析内分泌调节。任务是使用希尔方程的一种特定形式，来模拟细胞外钙 $[\\mathrm{Ca}^{2+}]$ 对甲状旁腺激素 $P$ 分泌的抑制效应。我们必须首先通过拟合此模型来验证所提供的数据集，然后从拟合的模型中提取两个关键参数：钙设定点和在该设定点处系统的灵敏度（斜率）。\n\nPTH 分泌速率的控制方程以抑制性希尔函数的形式给出：\n$$P([\\mathrm{Ca}^{2+}]) = P_0 + \\frac{\\Delta P}{1 + \\left( \\frac{[\\mathrm{Ca}^{2+}]}{K} \\right)^n}$$\n在此方程中，$P_0$ 代表在高钙浓度下观察到的基础或最低 PTH 分泌速率。$\\Delta P$ 是在此基础水平之上的最大动态分泌范围，因此，在零钙浓度时趋近的最大分泌速率为 $P_{\\max} = P_0 + \\Delta P$。参数 $K$ 是希尔常数，代表抑制效应达到半最大值时的钙浓度。最后，$n$ 是无量纲希尔系数，它量化了响应的协同性或陡峭程度。\n\n在进行数值实现之前，我们必须从第一性原理出发，推导出这两个感兴趣量的解析表达式。\n\n1.  **钙设定点的推导**\n\n问题将钙设定点（我们记作 $[\\mathrm{Ca}^{2+}]_{\\mathrm{sp}}$）定义为能使 PTH 分泌速率恰好处于其动态范围中点的钙浓度。动态范围从最低水平 $P_0$ 延伸至最高水平 $P_0 + \\Delta P$。因此，中点 PTH 水平 $P_{\\mathrm{mid}}$ 计算如下：\n$$P_{\\mathrm{mid}} = P_0 + \\frac{1}{2}\\left( (P_0 + \\Delta P) - P_0 \\right) = P_0 + \\frac{\\Delta P}{2}$$\n为求得对应的钙浓度，我们令模型方程等于 $P_{\\mathrm{mid}}$，并求解 $[\\mathrm{Ca}^{2+}]_{\\mathrm{sp}}$：\n$$P_0 + \\frac{\\Delta P}{1 + \\left( \\frac{[\\mathrm{Ca}^{2+}]_{\\mathrm{sp}}}{K} \\right)^n} = P_0 + \\frac{\\Delta P}{2}$$\n假设动态范围非零（$\\Delta P > 0$），我们可以简化此表达式。首先，从两边减去 $P_0$：\n$$\\frac{\\Delta P}{1 + \\left( \\frac{[\\mathrm{Ca}^{2+}]_{\\mathrm{sp}}}{K} \\right)^n} = \\frac{\\Delta P}{2}$$\n接下来，（在两边同除以 $\\Delta P$ 后）取倒数：\n$$1 + \\left( \\frac{[\\mathrm{Ca}^{2+}]_{\\mathrm{sp}}}{K} \\right)^n = 2$$\n$$\\left( \\frac{[\\mathrm{Ca}^{2+}]_{\\mathrm{sp}}}{K} \\right)^n = 1$$\n由于 $[\\mathrm{Ca}^{2+}]_{\\mathrm{sp}}$ 和 $K$ 都必须是正实数，唯一的有效解是：\n$$\\frac{[\\mathrm{Ca}^{2+}]_{\\mathrm{sp}}}{K} = 1 \\implies [\\mathrm{Ca}^{2+}]_{\\mathrm{sp}} = K$$\n这个严谨的推导证明了，问题中定义的生理设定点在数学上与希尔模型的参数 $K$ 是等同的。因此，要找到设定点，我们必须通过模型拟合来确定 $K$ 的值。\n\n2.  **设定点处斜率的推导**\n\n所需的第二个量是 PTH 响应曲线的局部斜率，在钙设定点处求值。这是一阶导数 $\\frac{dP}{d[\\mathrm{Ca}^{2+}]}$ 在 $[\\mathrm{Ca}^{2+}] = K$ 处的值。让我们用变量 $x$ 表示 $[\\mathrm{Ca}^{2+}]$。模型为 $P(x) = P_0 + \\Delta P \\left(1 + (x/K)^n\\right)^{-1}$。\n我们应用链式法则来求导数 $\\frac{dP}{dx}$：\n$$\\frac{dP}{dx} = 0 + \\Delta P \\cdot \\left( -1 \\cdot \\left(1 + \\left(\\frac{x}{K}\\right)^n\\right)^{-2} \\right) \\cdot \\frac{d}{dx}\\left(\\left(\\frac{x}{K}\\right)^n\\right)$$\n内部项的导数是 $\\frac{d}{dx}\\left(\\frac{x^n}{K^n}\\right) = \\frac{nx^{n-1}}{K^n}$。将其代回，我们得到：\n$$\\frac{dP}{dx} = -\\Delta P \\cdot \\left(1 + \\left(\\frac{x}{K}\\right)^n\\right)^{-2} \\cdot \\left(\\frac{nx^{n-1}}{K^n}\\right) = -\\frac{n \\Delta P x^{n-1}}{K^n \\left(1 + (x/K)^n\\right)^2}$$\n现在，我们在设定点 $x = [\\mathrm{Ca}^{2+}]_{\\mathrm{sp}} = K$ 处计算此表达式的值：\n$$\\left.\\frac{dP}{dx}\\right|_{x=K} = -\\frac{n \\Delta P K^{n-1}}{K^n \\left(1 + (K/K)^n\\right)^2} = -\\frac{n \\Delta P K^{n-1}}{K^n \\left(1 + 1\\right)^2} = -\\frac{n \\Delta P K^{n-1}}{4K^n}$$\n利用指数性质 $K^{n-1}/K^n = K^{-1} = 1/K$，我们得到设定点处斜率的最终简洁公式：\n$$\\text{Slope}_{sp} = -\\frac{n \\Delta P}{4K}$$\n这个结果表明，曲线在其中心点的陡峭程度与动态范围 $\\Delta P$ 和协同性 $n$ 成正比，与设定点 $K$ 成反比。\n\n计算流程如下。对于四个指定案例中的每一个，使用提供的“真实”参数生成 $P$ 对 $[\\mathrm{Ca}^{2+}]$ 的合成数据。然后，采用非线性最小二乘回归（`scipy.optimize.curve_fit`）将我们的模型函数拟合至此无噪声数据，从而得出参数 $\\{P_0, \\Delta P, K, n\\}$ 的估计值。通过在拟合算法中使用边界来强制执行约束条件 $P_0 \\ge 0$、$\\Delta P \\ge 0$、$K > 0$ 和 $n > 0$。由于数据是完美的，拟合参数预计将高精度地匹配真实参数。最后，使用拟合参数和推导出的解析公式来计算设定点（$K_{fit}$）和设定点处的斜率（$-\\frac{n_{fit} \\Delta P_{fit}}{4K_{fit}}$）。然后按要求格式化结果。", "answer": "```python\n# 完整的、可运行的 Python 3 代码如下。\n# 导入必须符合指定的执行环境。\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Fits a cooperative inhibitory Hill model to synthetic PTH-calcium data,\n    then calculates the calcium set-point and the slope at the set-point.\n    \"\"\"\n\n    # Define the inhibitory Hill model function\n    def hill_inhibitory(x, p0, delta_p, k, n):\n        \"\"\"\n        Inhibitory Hill equation for PTH secretion.\n        x: [Ca2+] concentration\n        p0: Basal PTH secretion\n        delta_p: Maximal dynamic increment (P_max - p0)\n        k: Calcium set-scale (concentration for half-maximal inhibition)\n        n: Hill coefficient (cooperativity)\n        \"\"\"\n        # To avoid potential issues with division by zero or negative bases\n        # with non-integer exponents, we handle k and x carefully.\n        # The bounds in curve_fit will ensure k > 0.\n        return p0 + delta_p / (1.0 + (x / k)**n)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A (typical cooperative response)\",\n            \"params\": (15.0, 120.0, 1.18, 3.0),  # (P0, Pmax, K, n)\n            \"calcium_grid\": np.array([0.95, 1.05, 1.15, 1.18, 1.25, 1.35, 1.45])\n        },\n        {\n            \"name\": \"Case B (near non-cooperative response)\",\n            \"params\": (10.0, 80.0, 1.25, 1.0),\n            \"calcium_grid\": np.array([1.00, 1.10, 1.20, 1.25, 1.30, 1.40, 1.50])\n        },\n        {\n            \"name\": \"Case C (narrow dynamic range)\",\n            \"params\": (20.0, 35.0, 1.20, 2.0),\n            \"calcium_grid\": np.array([0.90, 1.00, 1.10, 1.20, 1.30, 1.40])\n        },\n        {\n            \"name\": \"Case D (high cooperativity)\",\n            \"params\": (12.0, 150.0, 1.30, 5.0),\n            \"calcium_grid\": np.array([1.05, 1.15, 1.25, 1.30, 1.35, 1.45])\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        p0_true, pmax_true, k_true, n_true = case[\"params\"]\n        delta_p_true = pmax_true - p0_true\n        \n        x_data = case[\"calcium_grid\"]\n        \n        # Generate synthetic noiseless data\n        y_data = hill_inhibitory(x_data, p0_true, delta_p_true, k_true, n_true)\n\n        # Set up bounds for the fitting parameters [p0, delta_p, k, n]\n        # K and n must be strictly positive.\n        lower_bounds = [0, 0, 1e-9, 1e-9]\n        upper_bounds = [np.inf, np.inf, np.inf, np.inf]\n        bounds = (lower_bounds, upper_bounds)\n        \n        # Provide physically meaningful initial guesses for the parameters\n        # This improves robustness of the nonlinear fit.\n        p0_guess = np.min(y_data)\n        delta_p_guess = np.max(y_data) - p0_guess\n        k_guess = np.median(x_data) # Often a good starting point for K\n        n_guess = 2.0 # A common value for cooperativity\n        initial_guesses = [p0_guess, delta_p_guess, k_guess, n_guess]\n\n        # Perform the nonlinear least-squares fit\n        popt, _ = curve_fit(\n            hill_inhibitory,\n            x_data,\n            y_data,\n            p0=initial_guesses,\n            bounds=bounds,\n            method='trf' # Trust Region Reflective algorithm is robust with bounds\n        )\n        \n        p0_fit, delta_p_fit, k_fit, n_fit = popt\n\n        # 1. Calculate the set-point\n        # From our derivation, set-point is equal to the parameter K.\n        set_point = k_fit\n\n        # 2. Calculate the slope at the set-point\n        # From our derivation, slope = -(n * delta_p) / (4 * K)\n        slope = -(n_fit * delta_p_fit) / (4.0 * k_fit)\n\n        results.append([set_point, slope])\n\n    # Format the final output string exactly as required.\n    output_parts = []\n    for sp, sl in results:\n        output_parts.append(f\"[{sp:.3f},{sl:.1f}]\")\n    \n    final_output_string = f\"[{','.join(output_parts)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "2564921"}, {"introduction": "钙进入血液后，其水平受到严密调控，其中肾脏在排泄多余钙方面扮演着至关重要的角色。钙的排泄分数($FE_{Ca}$)是评估这一过程的一个强有力的临床和生理学指标。本练习[@problem_id:2564948]将让你扮演临床生理学家的角色，从第一性原理推导钙排泄分数的计算公式。通过将其应用于一个临床场景，你将学会如何利用血浆和尿液数据来量化肾脏对钙的处理，并为诊断潜在的转运缺陷提供依据。", "problem": "一名患有复发性肾钙质沉着症和低镁血症的患者，被怀疑在亨利袢粗升支存在细胞旁二价阳离子重吸收缺陷，可能由Claudin-16 (CLDN16)基因突变引起。现提供该患者在正常血容量状态和正常饮食条件下获取的即时（随机）尿液和血浆检测结果。测定了血浆离子钙以反映可超滤部分。甲状旁腺激素 (PTH) 和骨化三醇 (1,25-二羟基维生素D) 均在参考区间内。\n\n测量值：\n- 血浆离子钙：$4.8$ mg/dL\n- 血浆肌酐：$1.0$ mg/dL\n- 尿钙：$24$ mg/dL\n- 尿肌酐：$110$ mg/dL\n\n请从肾脏生理学的核心定义（肾清除率、滤过负荷和排泄分数）出发，并且不使用任何预先记忆的快捷公式，推导出钙的排泄分数表达式，然后使用上述数据计算其值。将血浆离子钙视为可超滤的钙浓度。将最终的排泄分数表示为无单位小数。将您的答案四舍五入至四位有效数字。", "solution": "本题要求从第一性原理出发，推导出钙的排泄分数 $FE_{Ca}$ 的表达式，然后利用所提供的实验室数据进行计算。\n\n我们的出发点是肾脏生理学的基本定义。\n\n1.  **排泄速率**：某物质在尿液中排泄的速率，记为 $\\dot{E}_x$，是其尿液浓度 $U_x$ 与尿流率 $\\dot{V}$ 的乘积。\n    $$ \\dot{E}_x = U_x \\times \\dot{V} $$\n    对于钙 ($Ca$)，其排泄速率为：\n    $$ \\dot{E}_{Ca} = U_{Ca} \\times \\dot{V} $$\n\n2.  **滤过负荷**：某物质在肾小球从血浆中滤过的速率，记为 $L_{filtered, x}$，是肾小球滤过率 $GFR$ 与血浆中可自由滤过的该物质浓度 $P_{x, filterable}$ 的乘积。\n    $$ L_{filtered, x} = GFR \\times P_{x, filterable} $$\n    对于钙，血浆总钙一部分与白蛋白及其他阴离子结合，一部分是游离的（离子化的）。只有未结合的离子化部分可以被自由滤过。题目要求使用血浆离子钙浓度 $P_{Ca^{2+}}$ 作为可超滤的钙浓度。因此，钙的滤过负荷为：\n    $$ L_{filtered, Ca} = GFR \\times P_{Ca^{2+}} $$\n\n3.  **排泄分数**：某物质的排泄分数 $FE_x$ 定义为排泄量与滤过量的比值。它是一个无量纲量，代表了被滤过的物质中未被重吸收（或被分泌）并最终出现在终尿中的部分。\n    $$ FE_x = \\frac{\\text{排泄速率}}{\\text{滤过负荷}} = \\frac{\\dot{E}_x}{L_{filtered, x}} $$\n    将此定义应用于钙：\n    $$ FE_{Ca} = \\frac{\\dot{E}_{Ca}}{L_{filtered, Ca}} $$\n    代入钙的排泄速率和滤过负荷的表达式：\n    $$ FE_{Ca} = \\frac{U_{Ca} \\times \\dot{V}}{GFR \\times P_{Ca^{2+}}} $$\n\n这个表达式包含两个未直接测量的变量：尿流率 $\\dot{V}$ 和肾小球滤过率 $GFR$。为解决此问题，我们使用一种参考物质——肌酐 ($Cr$) 来估算 $GFR$。肌酐可被自由滤过，且无明显重吸收或分泌（这是一个标准的临床近似）。因此，其肾清除率 $C_{Cr}$ 能很好地估算 $GFR$。\n\n任何物質 $x$ 的肾清除率 $C_x$ 由下式给出：\n$$ C_x = \\frac{U_x \\times \\dot{V}}{P_x} $$\n对于肌酐，其清除率为：\n$$ C_{Cr} = \\frac{U_{Cr} \\times \\dot{V}}{P_{Cr}} $$\n我们进行近似 $GFR \\approx C_{Cr}$：\n$$ GFR \\approx \\frac{U_{Cr} \\times \\dot{V}}{P_{Cr}} $$\n现在, 我们将这个 $GFR$ 的表达式代入 $FE_{Ca}$ 的方程中：\n$$ FE_{Ca} \\approx \\frac{U_{Ca} \\times \\dot{V}}{\\left( \\frac{U_{Cr} \\times \\dot{V}}{P_{Cr}} \\right) \\times P_{Ca^{2+}}} $$\n尿流率项 $\\dot{V}$ 同时出现在分子和分母中，因此可以通过代数运算消去。这是一个关键步骤，因为它允许我们仅通过单次“随机”尿样来计算排泄分数，而无需通过定时收集尿液来确定 $\\dot{V}$。\n$$ FE_{Ca} = \\frac{U_{Ca}}{ \\frac{U_{Cr}}{P_{Cr}} \\times P_{Ca^{2+}} } $$\n为清晰起见，重新整理各项，得到最终推导出的表达式：\n$$ FE_{Ca} = \\frac{U_{Ca} \\times P_{Cr}}{U_{Cr} \\times P_{Ca^{2+}}} $$\n这个表达式是钙清除率与肌酐清除率的比值 ($FE_{Ca} = C_{Ca} / C_{Cr}$)。\n\n现在，我们使用所提供的数据计算数值：\n-   血浆离子钙, $P_{Ca^{2+}} = 4.8$ mg/dL\n-   血浆肌酐, $P_{Cr} = 1.0$ mg/dL\n-   尿钙, $U_{Ca} = 24$ mg/dL\n-   尿肌酐, $U_{Cr} = 110$ mg/dL\n\n將這些值代入推導出的公式中：\n$$ FE_{Ca} = \\frac{(24 \\text{ mg/dL}) \\times (1.0 \\text{ mg/dL})}{(110 \\text{ mg/dL}) \\times (4.8 \\text{ mg/dL})} $$\n单位 (mg/dL) 被消掉，得到一个无量纲值，这与排泄分数的预期相符。\n$$ FE_{Ca} = \\frac{24 \\times 1.0}{110 \\times 4.8} = \\frac{24}{528} $$\n进行除法运算：\n$$ FE_{Ca} = 0.04545454... $$\n题目要求答案四舍五入到四位有效数字。第一个非零数字是 $4$，即第一位有效数字。从那里数四位数字得到 $0.04545$。\n$$ FE_{Ca} \\approx 0.04545 $$\n该值偏高（正常值通常 $< 0.02$），这与临床上怀疑存在肾脏钙重吸收缺陷的诊断相符，例如由Claudin-16突变引起的家族性低镁血症伴高尿钙和肾钙质沉着症。", "answer": "$$\\boxed{0.04545}$$", "id": "2564948"}]}