{"hands_on_practices": [{"introduction": "在深入研究力学转导的复杂调控机制之前，我们首先需要掌握其最基本的电学后果。当一个力敏通道打开时，它允许离子流过细胞膜，从而产生电流。本练习将运用欧姆定律等基本电生理学原理，计算单个开放通道的离子流和功率耗散，这些是理解和量化神经信号产生的基础。[@problem_id:2608975]", "problem": "在一个快速适应性低阈值机械感受神经元中，其机械门控的转导孔在静息状态附近可以近似为一个线性、非选择性的阳离子通道，其反转电位为 $E_{\\text{rev}} \\approx 0\\,\\mathrm{mV}$。此类型单个通道的开放通道电导为 $30\\,\\mathrm{pS}$。该神经元被电压钳制在膜电位 $V_{m}=-60\\,\\mathrm{mV}$ 和 $V_{m}=-20\\,\\mathrm{mV}$。采用电生理学符号约定，即正电流表示净正电荷流出细胞（外向电流）。从电导和离子流欧姆定律的定义，以及电功率作为电功速率的定义出发，计算在 $V_{m}=-60\\,\\mathrm{mV}$ 和 $V_{m}=-20\\,\\mathrm{mV}$ 时的单通道电流，以及相应的开放通道功率耗散。对电流和功率的计算均使用驱动电压 $\\Delta V = V_{m}-E_{\\text{rev}}$。将两个电流值以皮安（picoamperes）表示，两个功率值以飞瓦（femtowatts）表示，并将结果四舍五入至三位有效数字。按顺序 $\\big[I(-60\\,\\mathrm{mV}),\\,P(-60\\,\\mathrm{mV}),\\,I(-20\\,\\mathrm{mV}),\\,P(-20\\,\\mathrm{mV})\\big]$ 报告这四个数值结果。", "solution": "题目所给出的条件为一次标准的电生理学计算提供了一套完整且有科学依据的设定。该问题提法恰当、客观，并提供了所有必要的参数和定义。因此，我们可以开始解题。\n\n控制离子流过通道的基本关系是欧姆定律的一种形式，该定律指出离子电流 $I$ 是通道电导 $g$ 和电化学驱动电位 $\\Delta V$ 的乘积。驱动电位是膜电位 $V_{m}$ 与通透离子的反转电位 $E_{\\text{rev}}$ 之间的差值。\n$$I = g (V_{m} - E_{\\text{rev}})$$\n电生理学符号约定将正电荷的外向流动定义为正电流。鉴于该通道是一个非选择性阳离子通道，且膜电位为负 ($V_{m} < 0$)，而反转电位约等于零 ($E_{\\text{rev}} \\approx 0\\,\\mathrm{mV}$)，我们预计会有阳离子内流，从而产生负电流。\n\n因电流流动而耗散的电功率 $P$ 是电功完成的速率。它由电流与电流流过的电压降的乘积给出。在此情境下，电压降即驱动电位 $\\Delta V = V_{m} - E_{\\text{rev}}$。\n$$P = I \\cdot \\Delta V = I (V_{m} - E_{\\text{rev}})$$\n将电流 $I$ 的表达式代入功率方程，得到以电导和驱动电位表示的功率表达式：\n$$P = [g (V_{m} - E_{\\text{rev}})] \\cdot (V_{m} - E_{\\text{rev}}) = g (V_{m} - E_{\\text{rev}})^{2}$$\n注意，功率耗散始终是一个非负量，因为它取决于驱动电位的平方。\n\n给定参数为：\n单通道电导，$g = 30\\,\\mathrm{pS} = 30 \\times 10^{-12}\\,\\mathrm{S}$。\n反转电位，$E_{\\text{rev}} = 0\\,\\mathrm{mV} = 0\\,\\mathrm{V}$。\n\n现在我们来计算两种指定膜电位下的电流和功率。\n\n情况1：$V_{m} = -60\\,\\mathrm{mV} = -60 \\times 10^{-3}\\,\\mathrm{V}$\n\n首先，我们计算单通道电流 $I_{1}$。\n$$I_{1} = g (V_{m} - E_{\\text{rev}}) = (30 \\times 10^{-12}\\,\\mathrm{S}) \\cdot (-60 \\times 10^{-3}\\,\\mathrm{V} - 0\\,\\mathrm{V})$$\n$$I_{1} = -1800 \\times 10^{-15}\\,\\mathrm{A} = -1.8 \\times 10^{-12}\\,\\mathrm{A}$$\n换算成皮安（$1\\,\\mathrm{pA} = 10^{-12}\\,\\mathrm{A}$）：\n$$I_{1} = -1.8\\,\\mathrm{pA}$$\n四舍五入至三位有效数字，我们得到 $I_{1} = -1.80\\,\\mathrm{pA}$。\n\n接下来，我们计算相应的功率耗散 $P_{1}$。\n$$P_{1} = g (V_{m} - E_{\\text{rev}})^{2} = (30 \\times 10^{-12}\\,\\mathrm{S}) \\cdot (-60 \\times 10^{-3}\\,\\mathrm{V})^{2}$$\n$$P_{1} = (30 \\times 10^{-12}\\,\\mathrm{S}) \\cdot (3600 \\times 10^{-6}\\,\\mathrm{V}^{2})$$\n$$P_{1} = 108000 \\times 10^{-18}\\,\\mathrm{W} = 108 \\times 10^{-15}\\,\\mathrm{W}$$\n换算成飞瓦（$1\\,\\mathrm{fW} = 10^{-15}\\,\\mathrm{W}$）：\n$$P_{1} = 108\\,\\mathrm{fW}$$\n这个值已经是三位有效数字。\n\n情况2：$V_{m} = -20\\,\\mathrm{mV} = -20 \\times 10^{-3}\\,\\mathrm{V}$\n\n我们计算单通道电流 $I_{2}$。\n$$I_{2} = g (V_{m} - E_{\\text{rev}}) = (30 \\times 10^{-12}\\,\\mathrm{S}) \\cdot (-20 \\times 10^{-3}\\,\\mathrm{V} - 0\\,\\mathrm{V})$$\n$$I_{2} = -600 \\times 10^{-15}\\,\\mathrm{A} = -0.6 \\times 10^{-12}\\,\\mathrm{A}$$\n以皮安为单位：\n$$I_{2} = -0.6\\,\\mathrm{pA}$$\n四舍五入至三位有效数字，得到 $I_{2} = -0.600\\,\\mathrm{pA}$。\n\n最后，我们计算相应的功率耗散 $P_{2}$。\n$$P_{2} = g (V_{m} - E_{\\text{rev}})^{2} = (30 \\times 10^{-12}\\,\\mathrm{S}) \\cdot (-20 \\times 10^{-3}\\,\\mathrm{V})^{2}$$\n$$P_{2} = (30 \\times 10^{-12}\\,\\mathrm{S}) \\cdot (400 \\times 10^{-6}\\,\\mathrm{V}^{2})$$\n$$P_{2} = 12000 \\times 10^{-18}\\,\\mathrm{W} = 12 \\times 10^{-15}\\,\\mathrm{W}$$\n以飞瓦为单位：\n$$P_{2} = 12\\,\\mathrm{fW}$$\n四舍五入至三位有效数字，得到 $P_{2} = 12.0\\,\\mathrm{fW}$。\n\n按顺序 $[I(-60\\,\\mathrm{mV}),\\,P(-60\\,\\mathrm{mV}),\\,I(-20\\,\\mathrm{mV}),\\,P(-20\\,\\mathrm{mV})]$ 排列的四个所求数值结果是 $[-1.80,\\,108,\\,-0.600,\\,12.0]$。", "answer": "$$\\boxed{\\begin{pmatrix} -1.80 & 108 & -0.600 & 12.0 \\end{pmatrix}}$$", "id": "2608975"}, {"introduction": "理解了通道开放时的电学行为后，我们接着探究力如何控制通道的开关。基于“来自脂质的力”模型，膜张力可以直接作用于通道蛋白，改变其开放和关闭状态之间的能量平衡。本练习将引导你运用玻尔兹曼分布，从热力学角度定量分析膜张力的变化如何影响通道的开放概率，这是理解力学门控机制的核心。[@problem_id:2608950]", "problem": "一个位于体感神经元中的机械敏感性离子通道，在温度为 $T$ 时，其关闭构象与开放构象之间的两态平衡可以被很好地描述。开放态与关闭态之间的自由能差依赖于膜张力 $\\gamma$，其关系为 $\\Delta G(\\gamma)=\\Delta G_0-\\gamma\\,\\Delta A$。其中 $\\Delta A$ 是通道开放时在膜平面内横截面积的增加量。在热平衡状态下，开放概率 $p_{\\mathrm{o}}$ 和关闭概率 $p_{\\mathrm{c}}$ 满足玻尔兹曼关系 $p_{\\mathrm{o}}/p_{\\mathrm{c}}=\\exp\\!\\left(-\\Delta G(\\gamma)/(k_B T)\\right)$，其中 $k_B$ 是玻尔兹曼常数。\n\n一项实验测量到，在基线膜张力 $\\gamma_1 = 1\\,\\text{mN/m}$ 时，开放概率为 $P_{\\mathrm{o}}(\\gamma_1)=0.12$。随后，膜张力被准静态地增加到 $\\gamma_2 = 4\\,\\text{mN/m}$。该通道的门控面积变化为 $\\Delta A = 12\\,\\text{nm}^2$，且样品处于 $T=300\\,\\text{K}$ 的温度下。使用 $k_B = 1.380\\,649\\times 10^{-23}\\,\\text{J/K}$。\n\n从两态玻尔兹曼平衡以及膜张力对自由能的机械功贡献出发，计算开放概率的变化量 $\\Delta P_{\\mathrm{o}} = P_{\\mathrm{o}}(\\gamma_2) - P_{\\mathrm{o}}(\\gamma_1)$。将您的最终答案表示为一个无量纲小数，并四舍五入到三位有效数字。不要使用百分号。", "solution": "该问题要求计算当膜张力增加时，一个机械敏感性离子通道的开放概率的变化。该通道被描述为一个处于热平衡状态的两态体系（关闭和开放）。\n\n控制该体系的基本原理如下：\n1. 通道处于开放态的概率 $P_{\\mathrm{o}}$ 和处于关闭态的概率 $P_{\\mathrm{c}}$ 之和必须为1，因为这是仅有的两种状态：\n$$P_{\\mathrm{o}} + P_{\\mathrm{c}} = 1$$\n2. 这些概率的比值由玻尔兹曼分布决定，该分布依赖于开放态和关闭态之间的自由能差 $\\Delta G(\\gamma)$：\n$$\\frac{P_{\\mathrm{o}}}{P_{\\mathrm{c}}} = \\exp\\left(-\\frac{\\Delta G(\\gamma)}{k_B T}\\right)$$\n此处，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n根据第一条原理，我们可以写出 $P_{\\mathrm{c}} = 1 - P_{\\mathrm{o}}$。将此式代入玻尔兹曼关系式，得到：\n$$\\frac{P_{\\mathrm{o}}}{1 - P_{\\mathrm{o}}} = \\exp\\left(-\\frac{\\Delta G(\\gamma)}{k_B T}\\right)$$\n解出 $P_{\\mathrm{o}}(\\gamma)$，得到以下表达式，这是一种逻辑斯谛函数的形式：\n$$P_{\\mathrm{o}}(\\gamma) = \\frac{\\exp\\left(-\\frac{\\Delta G(\\gamma)}{k_B T}\\right)}{1 + \\exp\\left(-\\frac{\\Delta G(\\gamma)}{k_B T}\\right)} = \\frac{1}{1 + \\exp\\left(\\frac{\\Delta G(\\gamma)}{k_B T}\\right)}$$\n自由能差 $\\Delta G(\\gamma)$ 作为膜张力 $\\gamma$ 的函数给出：\n$$\\Delta G(\\gamma) = \\Delta G_0 - \\gamma \\Delta A$$\n其中 $\\Delta G_0$ 是在零张力下的内禀自由能差，而 $\\Delta A$ 是通道开放时其平面内面积的变化。\n\n将 $\\Delta G(\\gamma)$ 的表达式代入 $P_{\\mathrm{o}}(\\gamma)$ 的方程中：\n$$P_{\\mathrm{o}}(\\gamma) = \\frac{1}{1 + \\exp\\left(\\frac{\\Delta G_0 - \\gamma \\Delta A}{k_B T}\\right)}$$\n题目陈述，在基线张力 $\\gamma_1 = 1\\,\\text{mN/m}$ 时，开放概率是 $P_{\\mathrm{o}}(\\gamma_1) = 0.12$。这个信息可以用来确定未知量 $\\Delta G_0$，但更直接的方法是在两个不同张力 $\\gamma_1$ 和 $\\gamma_2$ 下的概率之间建立一个关系。\n\n从 $P_{\\mathrm{o}}(\\gamma)$ 的表达式中，我们可以分离出指数项：\n$$\\exp\\left(\\frac{\\Delta G(\\gamma)}{k_B T}\\right) = \\frac{1}{P_{\\mathrm{o}}(\\gamma)} - 1 = \\frac{1 - P_{\\mathrm{o}}(\\gamma)}{P_{\\mathrm{o}}(\\gamma)}$$\n让我们针对两个张力 $\\gamma_1$ 和 $\\gamma_2$ 计算此表达式：\n$$\\exp\\left(\\frac{\\Delta G_0 - \\gamma_1 \\Delta A}{k_B T}\\right) = \\frac{1 - P_{\\mathrm{o}}(\\gamma_1)}{P_{\\mathrm{o}}(\\gamma_1)}$$\n$$\\exp\\left(\\frac{\\Delta G_0 - \\gamma_2 \\Delta A}{k_B T}\\right) = \\frac{1 - P_{\\mathrm{o}}(\\gamma_2)}{P_{\\mathrm{o}}(\\gamma_2)}$$\n将第二个方程除以第一个方程，可以消去未知量 $\\Delta G_0$：\n$$\\frac{\\exp\\left(\\frac{\\Delta G_0 - \\gamma_2 \\Delta A}{k_B T}\\right)}{\\exp\\left(\\frac{\\Delta G_0 - \\gamma_1 \\Delta A}{k_B T}\\right)} = \\frac{\\frac{1 - P_{\\mathrm{o}}(\\gamma_2)}{P_{\\mathrm{o}}(\\gamma_2)}}{\\frac{1 - P_{\\mathrm{o}}(\\gamma_1)}{P_{\\mathrm{o}}(\\gamma_1)}}$$\n左边化简为：\n$$\\exp\\left(\\frac{(\\Delta G_0 - \\gamma_2 \\Delta A) - (\\Delta G_0 - \\gamma_1 \\Delta A)}{k_B T}\\right) = \\exp\\left(-\\frac{(\\gamma_2 - \\gamma_1) \\Delta A}{k_B T}\\right)$$\n现在我们可以解出包含 $P_{\\mathrm{o}}(\\gamma_2)$ 的项：\n$$\\frac{1 - P_{\\mathrm{o}}(\\gamma_2)}{P_{\\mathrm{o}}(\\gamma_2)} = \\left(\\frac{1 - P_{\\mathrm{o}}(\\gamma_1)}{P_{\\mathrm{o}}(\\gamma_1)}\\right) \\exp\\left(-\\frac{(\\gamma_2 - \\gamma_1) \\Delta A}{k_B T}\\right)$$\n我们已知以下数值：\n$P_{\\mathrm{o}}(\\gamma_1) = 0.12$\n$\\gamma_1 = 1\\,\\text{mN/m} = 1 \\times 10^{-3}\\,\\text{N/m}$\n$\\gamma_2 = 4\\,\\text{mN/m} = 4 \\times 10^{-3}\\,\\text{N/m}$\n$\\Delta A = 12\\,\\text{nm}^2 = 12 \\times (10^{-9}\\,\\text{m})^2 = 12 \\times 10^{-18}\\,\\text{m}^2$\n$T = 300\\,\\text{K}$\n$k_B = 1.380649 \\times 10^{-23}\\,\\text{J/K}$\n\n首先，我们计算无量纲的指数。分子是张力变化所做的机械功：\n$$(\\gamma_2 - \\gamma_1)\\Delta A = (4 \\times 10^{-3} - 1 \\times 10^{-3})\\,\\text{N/m} \\times (12 \\times 10^{-18}\\,\\text{m}^2) = (3 \\times 10^{-3}\\,\\text{N/m}) \\times (12 \\times 10^{-18}\\,\\text{m}^2) = 3.6 \\times 10^{-20}\\,\\text{J}$$\n分母是热能标度：\n$$k_B T = (1.380649 \\times 10^{-23}\\,\\text{J/K}) \\times (300\\,\\text{K}) = 4.141947 \\times 10^{-21}\\,\\text{J}$$\n指数是这些能量的比值：\n$$\\frac{(\\gamma_2 - \\gamma_1) \\Delta A}{k_B T} = \\frac{3.6 \\times 10^{-20}\\,\\text{J}}{4.141947 \\times 10^{-21}\\,\\text{J}} \\approx 8.69154$$\n现在，我们将此值代入我们的方程中。初始的概率比是：\n$$\\frac{1 - P_{\\mathrm{o}}(\\gamma_1)}{P_{\\mathrm{o}}(\\gamma_1)} = \\frac{1 - 0.12}{0.12} = \\frac{0.88}{0.12} = \\frac{22}{3}$$\n所以，我们有：\n$$\\frac{1 - P_{\\mathrm{o}}(\\gamma_2)}{P_{\\mathrm{o}}(\\gamma_2)} = \\frac{22}{3} \\times \\exp(-8.69154) \\approx 7.33333 \\times 0.00016800 \\approx 0.00122867$$\n设这个结果值为 $R$。那么，$\\frac{1 - P_{\\mathrm{o}}(\\gamma_2)}{P_{\\mathrm{o}}(\\gamma_2)} = R$。\n解出 $P_{\\mathrm{o}}(\\gamma_2)$：\n$$1 - P_{\\mathrm{o}}(\\gamma_2) = R \\cdot P_{\\mathrm{o}}(\\gamma_2) \\implies 1 = (R+1) P_{\\mathrm{o}}(\\gamma_2) \\implies P_{\\mathrm{o}}(\\gamma_2) = \\frac{1}{R+1}$$\n$$P_{\\mathrm{o}}(\\gamma_2) = \\frac{1}{0.00122867 + 1} = \\frac{1}{1.00122867} \\approx 0.9987729$$\n问题要求计算开放概率的变化量 $\\Delta P_{\\mathrm{o}} = P_{\\mathrm{o}}(\\gamma_2) - P_{\\mathrm{o}}(\\gamma_1)$。\n$$\\Delta P_{\\mathrm{o}} = 0.9987729 - 0.12 = 0.8787729$$\n将最终答案四舍五入到三位有效数字，得到 $0.879$。", "answer": "$$\\boxed{0.879}$$", "id": "2608950"}, {"introduction": "最后，我们将单个通道的生物物理特性整合到一个完整的神经元模型中，以探究机械刺激如何最终转化为神经脉冲序列。通过构建一个泄漏整合-发放 (Leaky Integrate-and-Fire, LIF) 神经元的计算模拟，我们可以预测神经元对特定力学刺激的编码输出。这个综合性练习不仅连接了分子尺度的通道动力学和系统尺度的神经元放电，也让你体验了计算神经科学在研究体感功能中的强大作用。[@problem_id:2608981]", "problem": "模拟一个单室泄漏整合发放（LIF）神经元的发放响应。该神经元由一个斜坡-保持力刺激激活的机械转导电导驱动。目标是计算指定力幅值下的发放脉冲数量，并以单个列表的形式报告这些脉冲计数。\n\n起始点（基本定律和核心定义）：\n- 膜室的电荷守恒给出了电流平衡方程\n$$C_m \\frac{dV}{dt} = I_{\\mathrm{tot}}(t),$$\n其中 $C_m$ 是膜电容，$V$ 是膜电位。\n- 泄漏电流为\n$$I_{\\mathrm{leak}}(t) = -g_L\\left(V(t) - E_L\\right),$$\n其中 $g_L$ 是泄漏电导，$E_L$ 是泄漏反转电位。\n- 机械转导电流被建模为一个具有一级门控的电导：\n$$I_{\\mathrm{mech}}(t) = g_{\\max} \\, x(t)\\, \\left(E_{\\mathrm{rev}} - V(t)\\right),$$\n$$\\tau_x \\frac{dx}{dt} = x_{\\infty}\\!\\left(F(t)\\right) - x(t),$$\n其稳态激活由一个S型力依赖关系给出\n$$x_{\\infty}(F) = \\frac{1}{1 + \\exp\\!\\left(-\\frac{F - F_{50}}{k_F}\\right)}.$$\n此处，$g_{\\max}$ 是最大机械转导电导，$x(t)$ 是激活变量，$E_{\\mathrm{rev}}$ 是机械转导反转电位，$\\tau_x$ 是激活时间常数，$F_{50}$ 是半激活力，$k_F$ 设定了陡峭程度。\n\n力刺激（斜坡-保持）：\n设所施加的力为\n$$\nF(t) =\n\\begin{cases}\n\\displaystyle F_{\\mathrm{amp}} \\frac{t}{T_{\\mathrm{ramp}}},  0 \\le t  T_{\\mathrm{ramp}} \\\\[6pt]\n\\displaystyle F_{\\mathrm{amp}},  T_{\\mathrm{ramp}} \\le t  T_{\\mathrm{ramp}} + T_{\\mathrm{hold}} \\\\[6pt]\n\\displaystyle 0,  t \\ge T_{\\mathrm{ramp}} + T_{\\mathrm{hold}}\n\\end{cases}\n$$\n\n膜方程：\n$$C_m \\frac{dV}{dt} = -g_L\\left(V - E_L\\right) + g_{\\max} \\, x(t)\\, \\left(E_{\\mathrm{rev}} - V\\right).$$\n\n脉冲生成和重置（泄漏整合发放（LIF）规则）：\n- 如果 $V(t)$ 达到阈值 $V_{\\mathrm{th}}$，则称在该时刻发生了一次脉冲，然后将 $V$ 瞬时重置为 $V_{\\mathrm{reset}}$ 并在此值上保持一个绝对不应期 $\\tau_{\\mathrm{ref}}$。在此期间，$V$ 的动力学被暂停（但 $x(t)$ 继续根据其微分方程演化）。\n\n离散化要求：\n- 使用固定时间步长 $\\Delta t$ 的前向欧拉法：\n$$x_{n+1} = x_n + \\Delta t \\, \\frac{x_{\\infty}\\!\\left(F_n\\right) - x_n}{\\tau_x},$$\n$$V_{n+1} = V_n + \\frac{\\Delta t}{C_m}\\left[-g_L\\left(V_n - E_L\\right) + g_{\\max} \\, x_n \\, \\left(E_{\\mathrm{rev}} - V_n\\right)\\right],$$\n除非处于绝对不应期，此时设置 $V_{n+1} = V_{\\mathrm{reset}}$ 并且不应用电压更新，但仍更新 $x_n$。在非不应期时，使用离散脉冲条件 $V_{n+1} \\ge V_{\\mathrm{th}}$ 来记录一次脉冲，然后在接下来的 $\\lceil \\tau_{\\mathrm{ref}} / \\Delta t \\rceil$ 个步骤中强制执行重置和绝对不应期。\n\n初始条件：\n- $V(0) = E_L$。\n- $x(0) = x_{\\infty}\\!\\left(F(0)\\right)$。\n\n物理参数和单位：\n- 膜电容 $C_m = 100\\,\\mathrm{pF}$。\n- 泄漏电导 $g_L = 10\\,\\mathrm{nS}$。\n- 泄漏反转电位 $E_L = -70\\,\\mathrm{mV}$。\n- 脉冲阈值 $V_{\\mathrm{th}} = -50\\,\\mathrm{mV}$。\n- 重置电位 $V_{\\mathrm{reset}} = -65\\,\\mathrm{mV}$。\n- 绝对不应期 $\\tau_{\\mathrm{ref}} = 3\\,\\mathrm{ms}$。\n- 机械转导反转电位 $E_{\\mathrm{rev}} = 0\\,\\mathrm{mV}$。\n- 最大机械转导电导 $g_{\\max} = 30\\,\\mathrm{nS}$。\n- 激活时间常数 $\\tau_x = 5\\,\\mathrm{ms}$。\n- 半激活力 $F_{50} = 5\\,\\mathrm{mN}$。\n- 力陡峭度 $k_F = 1\\,\\mathrm{mN}$。\n- 斜坡持续时间 $T_{\\mathrm{ramp}} = 50\\,\\mathrm{ms}$。\n- 保持持续时间 $T_{\\mathrm{hold}} = 150\\,\\mathrm{ms}$。\n- 时间步长 $\\Delta t = 0.1\\,\\mathrm{ms}$。\n- 总模拟时间 $T_{\\mathrm{tot}} = T_{\\mathrm{ramp}} + T_{\\mathrm{hold}} + 100\\,\\mathrm{ms}$。\n\n在计算时，所有电位必须在内部以 $\\mathrm{V}$ 表示，电导以 $\\mathrm{S}$ 表示，电容以 $\\mathrm{F}$ 表示，力以 $\\mathrm{N}$ 表示，时间以 $\\mathrm{s}$ 表示。不使用角度。要求的输出是脉冲计数（无量纲）。\n\n测试套件：\n模拟并报告以下力幅值（正常路径、近阈值边界和高幅值情况）的脉冲计数：\n- $F_{\\mathrm{amp}} = 0.0\\,\\mathrm{N}$。\n- $F_{\\mathrm{amp}} = 0.0030\\,\\mathrm{N}$。\n- $F_{\\mathrm{amp}} = 0.0032\\,\\mathrm{N}$。\n- $F_{\\mathrm{amp}} = 0.0050\\,\\mathrm{N}$。\n- $F_{\\mathrm{amp}} = 0.0100\\,\\mathrm{N}$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如：$[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_i$ 是对应于上面所列顺序的测试用例的脉冲计数（一个整数）。", "solution": "该问题陈述在科学上是有效的，在计算上是明确定义的。它描述了一个耦合一阶常微分方程系统的初值问题，该系统具有状态依赖的重置条件，这是计算神经科学中的一个标准范式。我们将按照规定构建数值解。\n\n该系统封装了一个单室泄漏整合发放（LIF）神经元的行为。其状态由膜电位 $V(t)$ 和一个机械敏感离子电导的激活变量 $x(t)$ 描述。\n\n膜电位的动力学遵循电荷守恒原理，表示为：\n$$C_m \\frac{dV}{dt} = I_{\\mathrm{tot}}(t) = -g_L\\left(V(t) - E_L\\right) + g_{\\max} \\, x(t)\\, \\left(E_{\\mathrm{rev}} - V(t)\\right)$$\n此处，$C_m$ 是膜电容，$g_L$ 是泄漏电导，其反转电位为 $E_L$，第二项是机械转导电流，其最大电导为 $g_{\\max}$，反转电位为 $E_{\\mathrm{rev}}$。\n\n激活变量 $x(t)$ 遵循一级动力学，由施加的力刺激 $F(t)$ 驱动：\n$$\\tau_x \\frac{dx}{dt} = x_{\\infty}\\!\\left(F(t)\\right) - x(t)$$\n稳态激活 $x_{\\infty}(F)$ 是力的S型函数：\n$$x_{\\infty}(F) = \\frac{1}{1 + \\exp\\!\\left(-\\frac{F - F_{50}}{k_F}\\right)}$$\n刺激 $F(t)$ 是一个斜坡-保持曲线，当 $t0$ 时为零，在 $T_{\\mathrm{ramp}}$ 的持续时间内线性上升到峰值幅度 $F_{\\mathrm{amp}}$，在 $F_{\\mathrm{amp}}$ 处保持 $T_{\\mathrm{hold}}$ 的持续时间，最后返回零。\n\n为求解该系统，我们采用指定的前向欧拉数值积分方案，并使用固定的时间步长 $\\Delta t$。在计算之前，所有提供的参数都将转换为国际单位制（SI）基本单位（伏特、法拉、西门子、秒、牛顿），以保持量纲一致性。\n\n模拟算法以离散时间步长 $t_n = n \\Delta t$ 推进。系统在步骤 $n$ 的状态由 $(V_n, x_n)$ 和一个不应期计数器 `ref_counter` 定义。在 $t_0=0$ 时的初始条件为 $V_0 = E_L$ 和 $x_0 = x_{\\infty}(F(0))$，请注意 $F(0)=0$。\n\n从步骤 $n$ 到 $n+1$ 的逐步更新过程如下：\n\n$1$. 门控变量 $x$ 在每个时间步都进行更新，无论神经元的发放状态如何。计算力 $F_n = F(t_n)$，它决定了目标激活值 $x_{\\infty}(F_n)$。更新公式为：\n$$x_{n+1} = x_n + \\frac{\\Delta t}{\\tau_x} \\left( x_{\\infty}(F_n) - x_n \\right)$$\n\n$2$. 膜电位 $V$ 的更新取决于神经元是否处于不应期状态。\n- 如果 `ref_counter` $ 0$，神经元处于不应期。$V$ 的积分被暂停，电位被钳制在重置值：$V_{n+1} = V_{\\mathrm{reset}}$。然后 `ref_counter` 递减。\n- 如果 `ref_counter` $= 0$，神经元不处于不应期。使用步骤 $n$ 的状态变量对电位进行积分：\n$$V'_{n+1} = V_n + \\frac{\\Delta t}{C_m} \\left[ -g_L(V_n - E_L) + g_{\\max} x_n (E_{\\mathrm{rev}} - V_n) \\right]$$\n符号 $V'_{n+1}$ 表示积分后、脉冲检查前的电位。\n\n$3$. 在非不应期情况下，更新电位后，检查脉冲条件。如果 $V'_{n+1} \\ge V_{\\mathrm{th}}$：\n- 记录一次脉冲，总脉冲计数加一。\n- 下一步的膜电位被设置为重置值：$V_{n+1} = V_{\\mathrm{reset}}$。\n- 通过将 `ref_counter` 设置为不应期的总步数（计算为 $\\lceil \\tau_{\\mathrm{ref}} / \\Delta t \\rceil$）来启动不应期状态。\n- 如果没有发生脉冲（$V'_{n+1}  V_{\\mathrm{th}}$），则下一步的电位就是积分后的值：$V_{n+1} = V'_{n+1}$。\n\n对每个指定的力幅值 $F_{\\mathrm{amp}}$，在总模拟时间 $T_{\\mathrm{tot}}$ 内执行此数值程序。收集得到的脉冲计数，并以指定的列表格式报告。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(F_amp, params):\n    \"\"\"\n    Simulates a single LIF neuron with a mechanotransduction current.\n\n    Args:\n        F_amp (float): The amplitude of the force stimulus in Newtons.\n        params (dict): A dictionary of model and simulation parameters in SI units.\n\n    Returns:\n        int: The total number of spikes generated during the simulation.\n    \"\"\"\n    # Unpack parameters from the dictionary\n    Cm = params[\"Cm\"]\n    gL = params[\"gL\"]\n    EL = params[\"EL\"]\n    Vth = params[\"Vth\"]\n    Vreset = params[\"Vreset\"]\n    tau_ref = params[\"tau_ref\"]\n    Erev = params[\"Erev\"]\n    gmax = params[\"gmax\"]\n    tau_x = params[\"tau_x\"]\n    F50 = params[\"F50\"]\n    kF = params[\"kF\"]\n    Tramp = params[\"Tramp\"]\n    Thold = params[\"Thold\"]\n    Ttot = params[\"Ttot\"]\n    dt = params[\"dt\"]\n\n    # Simulation setup\n    num_steps = int(Ttot / dt)\n    ref_steps = int(np.ceil(tau_ref / dt))\n    \n    # Initial conditions\n    v = EL\n    f_0 = 0.0\n    x_inf_0 = 1.0 / (1.0 + np.exp(-(f_0 - F50) / kF))\n    x = x_inf_0\n    \n    spike_count = 0\n    ref_counter = 0\n\n    # Main simulation loop\n    for i in range(num_steps):\n        t = i * dt\n        \n        # Calculate force F(t) based on the ramp-and-hold profile\n        if t  Tramp:\n            force = F_amp * t / Tramp\n        elif t  Tramp + Thold:\n            force = F_amp\n        else:\n            force = 0.0\n            \n        # Store x from the beginning of the step for the voltage update\n        x_now = x\n        \n        # Update gating variable x (this dynamic is always active)\n        x_inf = 1.0 / (1.0 + np.exp(-(force - F50) / kF))\n        x = x + (dt / tau_x) * (x_inf - x)\n        \n        # Update membrane potential v, conditional on refractory period\n        if ref_counter  0:\n            # Neuron is in refractory period: clamp voltage and decrement counter\n            v = Vreset\n            ref_counter -= 1\n        else:\n            # Neuron is not refractory: integrate the membrane potential\n            i_leak = -gL * (v - EL)\n            i_mech = gmax * x_now * (Erev - v)\n            v = v + (dt / Cm) * (i_leak + i_mech)\n            \n            # Check for a spike\n            if v = Vth:\n                spike_count += 1\n                v = Vreset          # Reset potential\n                ref_counter = ref_steps # Start refractory period\n                \n    return spike_count\n\ndef solve():\n    \"\"\"\n    Main function to define parameters, run simulations for all test cases,\n    and print the results in the specified format.\n    \"\"\"\n    # Parameters are defined in base SI units (F, S, V, N, s)\n    params = {\n        \"Cm\": 100e-12,       # Capacitance (F)\n        \"gL\": 10e-9,         # Leak conductance (S)\n        \"EL\": -70e-3,        # Leak reversal potential (V)\n        \"Vth\": -50e-3,       # Spike threshold (V)\n        \"Vreset\": -65e-3,    # Reset potential (V)\n        \"tau_ref\": 3e-3,     # Absolute refractory period (s)\n        \"Erev\": 0.0,         # Mechanotransduction reversal potential (V)\n        \"gmax\": 30e-9,       # Maximal mechanotransduction conductance (S)\n        \"tau_x\": 5e-3,       # Activation time constant (s)\n        \"F50\": 5e-3,         # Half-activation force (N)\n        \"kF\": 1e-3,          # Force steepness (N)\n        \"Tramp\": 50e-3,      # Ramp duration (s)\n        \"Thold\": 150e-3,     # Hold duration (s)\n        \"Ttot\": 300e-3,      # Total simulation time (s)\n        \"dt\": 0.1e-3,        # Time step (s)\n    }\n    \n    # Test cases for force amplitudes (F_amp) in Newtons\n    test_cases = [0.0, 0.0030, 0.0032, 0.0050, 0.0100]\n    \n    results = []\n    for f_amp in test_cases:\n        count = run_simulation(f_amp, params)\n        results.append(count)\n\n    # Print the final result in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2608981"}]}