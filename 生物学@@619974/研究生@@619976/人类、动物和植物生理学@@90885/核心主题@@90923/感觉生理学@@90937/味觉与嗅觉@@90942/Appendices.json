{"hands_on_practices": [{"introduction": "我们对味觉，例如咸味的感知，始于一个基本的生物物理过程：离子跨越感受器细胞膜的运动。本练习提供了一个动手实践的机会，应用能斯特方程和欧姆定律等基本原理，来计算驱动低盐度味觉转导的钠离子电流。掌握这项计算是理解化学刺激如何转化为神经系统可以解读的电信号的关键。[@problem_id:2572665]", "problem": "啮齿动物的蕈状味觉感受器细胞通过顶膜的上皮钠通道 (ENaC) 孔来转导低盐刺激，该通道对钠离子具有高选择性。阿米洛利 (Amiloride) 通过与 ENaC 结合并降低其传导钠离子的能力，可逆地抑制此通路。考虑一个单一的味觉感受器细胞，其顶膜暴露于含有钠离子的冲洗溶液中。假设在低盐刺激下，黏膜侧和胞质溶胶室之间的钠离子活度比接近浓度比，并且 ENaC 是顶膜上钠离子的唯一传导通路。\n\n从平衡状态下电化学势相等和能斯特电位 (Nernst potential) 的定义出发，并使用适用于宏观电流的欧姆定律 (Ohm’s law)，以及宏观电导的定义（通道数量、单通道开放概率和单通道电导的乘积），推导出在稳态低盐刺激下通过顶膜 ENaC 的净钠离子电流表达式。然后，根据以下生理学上合理的参数计算该电流值：\n\n- 温度 $T = 310\\,\\mathrm{K}$，通用气体常数 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，法拉第常数 $F = 96485\\,\\mathrm{C\\,mol^{-1}}$。\n- 钠离子价态 $z_{\\mathrm{Na}} = +1$。\n- 黏膜侧（顶膜）钠离子浓度 $[\\mathrm{Na}^{+}]_{\\mathrm{out}} = 30\\,\\mathrm{mM}$（低盐）和胞质溶胶钠离子浓度 $[\\mathrm{Na}^{+}]_{\\mathrm{in}} = 12\\,\\mathrm{mM}$。\n- 静息膜电位（细胞内部相对于黏膜溶液）$V_{m} = -60\\,\\mathrm{mV}$，在短暂测量期间保持不变。\n- 顶膜 ENaC 通道数量 $N = 2000$，在此刺激下单通道开放概率 $P_{o} = 0.20$，单通道电导 $\\gamma = 5\\,\\mathrm{pS}$。\n\n采用正电流为外向电流（正电荷流出细胞）的符号约定。最终电流以 $\\mathrm{pA}$ 为单位表示，并将答案四舍五入至三位有效数字。请勿使用任何现成的或简化的反转电位或宏观电流公式；相反，应从上述基本表达式开始，在计算数值之前推导出所需的关系式。", "solution": "首先对问题陈述进行验证。\n\n逐字提取的已知条件：\n- 温度 $T = 310\\,\\mathrm{K}$\n- 通用气体常数 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n- 法拉第常数 $F = 96485\\,\\mathrm{C\\,mol^{-1}}$\n- 钠离子价态 $z_{\\mathrm{Na}} = +1$\n- 黏膜侧钠离子浓度 $[\\mathrm{Na}^{+}]_{\\mathrm{out}} = 30\\,\\mathrm{mM}$\n- 胞质溶胶钠离子浓度 $[\\mathrm{Na}^{+}]_{\\mathrm{in}} = 12\\,\\mathrm{mM}$\n- 静息膜电位 $V_{m} = -60\\,\\mathrm{mV}$\n- 顶膜 ENaC 通道数量 $N = 2000$\n- 单通道开放概率 $P_{o} = 0.20$\n- 单通道电导 $\\gamma = 5\\,\\mathrm{pS}$\n- 符号约定：正电流为外向电流。\n- 假设：活度比等于浓度比；ENaC 是 $\\mathrm{Na}^{+}$ 的唯一通路。\n- 任务：推导净钠离子电流的表达式，并以皮安（picoamperes）为单位计算其值，四舍五入至三位有效数字。\n\n验证结论：\n该问题具有科学依据，表述清晰且客观。它基于已确立的膜转运生物物理学原理，即能斯特-普朗克 (Nernst-Planck) 和 高盛-霍奇金-卡茨 (Goldman-Hodgkin-Katz) 形式体系，此处简化为欧姆定律模型。所提供的参数对于哺乳动物细胞是生理学上合理的。问题是自洽的，没有逻辑矛盾或含糊之处。它要求从基本原理进行推导，这是对理解能力的严格检验。因此，该问题被认定为有效，并将提供解答。\n\n净钠离子电流 $I_{\\mathrm{Na}}$ 的推导始于离子种类 $j$ 的电化学势 $\\tilde{\\mu}_j$ 的定义。该势是其化学势与每摩尔电势能之和。\n$$ \\tilde{\\mu}_j = \\mu_j^0 + RT \\ln(a_j) + z_j F V $$\n此处，$\\mu_j^0$ 是标准化学势，$R$ 是通用气体常数，$T$ 是绝对温度，$a_j$ 是离子的化学活度，$z_j$ 是其价态，$F$ 是法拉第常数，$V$ 是电势。\n\n在热力学平衡状态下，没有离子跨膜的净通量。此条件意味着离子在两个室（胞质溶胶，in，和黏膜溶液，out）中的电化学势相等。对于钠离子（$\\mathrm{Na}^{+}$），这表示为：\n$$ \\tilde{\\mu}_{\\mathrm{Na, in}} = \\tilde{\\mu}_{\\mathrm{Na, out}} $$\n代入电化学势的表达式：\n$$ \\mu_{\\mathrm{Na}}^0 + RT \\ln(a_{\\mathrm{Na, in}}) + z_{\\mathrm{Na}} F V_{\\mathrm{in}} = \\mu_{\\mathrm{Na}}^0 + RT \\ln(a_{\\mathrm{Na, out}}) + z_{\\mathrm{Na}} F V_{\\mathrm{out}} $$\n标准电势 $\\mu_{\\mathrm{Na}}^0$ 被消去。重新排列各项以求得跨膜电位差 $V_{\\mathrm{in}} - V_{\\mathrm{out}}$：\n$$ z_{\\mathrm{Na}} F (V_{\\mathrm{in}} - V_{\\mathrm{out}}) = RT \\ln(a_{\\mathrm{Na, out}}) - RT \\ln(a_{\\mathrm{Na, in}}) = RT \\ln\\left(\\frac{a_{\\mathrm{Na, out}}}{a_{\\mathrm{Na, in}}}\\right) $$\n离子处于平衡状态时的这一特定膜电位差定义为能斯特电位 $E_{\\mathrm{Na}}$。\n$$ E_{\\mathrm{Na}} = V_{\\mathrm{in}} - V_{\\mathrm{out}} = \\frac{RT}{z_{\\mathrm{Na}}F} \\ln\\left(\\frac{a_{\\mathrm{Na, out}}}{a_{\\mathrm{Na, in}}}\\right) $$\n问题陈述指出，对于这些稀溶液，活度比可以用浓度 $[\\mathrm{Na}^{+}]$ 比来近似。\n$$ E_{\\mathrm{Na}} = \\frac{RT}{z_{\\mathrm{Na}}F} \\ln\\left(\\frac{[\\mathrm{Na}^{+}]_{\\mathrm{out}}}{[\\mathrm{Na}^{+}]_{\\mathrm{in}}}\\right) $$\n此表达式给出了钠离子的反转电位。当膜电位 $V_m$ 不等于 $E_{\\mathrm{Na}}$ 时，离子上存在一个净电化学驱动力，由 $(V_m - E_{\\mathrm{Na}})$ 给出。该驱动力通过可用的传导通路产生净电流 $I_{\\mathrm{Na}}$。\n\n根据应用于离子通道的欧姆定律，宏观离子电流是宏观电导 $G_{\\mathrm{Na}}$ 与电化学驱动力的乘积。\n$$ I_{\\mathrm{Na}} = G_{\\mathrm{Na}} (V_m - E_{\\mathrm{Na}}) $$\n问题将宏观电导定义为总通道数 $N$、单个通道开放的概率 $P_o$ 以及单个开放通道的电导 $\\gamma$ 的乘积。\n$$ G_{\\mathrm{Na}} = N \\cdot P_o \\cdot \\gamma $$\n将此定义代入电流方程，得到净钠离子电流的完整表达式：\n$$ I_{\\mathrm{Na}} = N P_o \\gamma \\left( V_m - \\frac{RT}{z_{\\mathrm{Na}}F} \\ln\\left(\\frac{[\\mathrm{Na}^{+}]_{\\mathrm{out}}}{[\\mathrm{Na}^{+}]_{\\mathrm{in}}}\\right) \\right) $$\n至此，所需推导完成。现在，我们使用所给参数计算此表达式的值。\n\n首先，计算钠离子的能斯特电位 $E_{\\mathrm{Na}}$。\n- $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n- $T = 310\\,\\mathrm{K}$\n- $z_{\\mathrm{Na}} = +1$\n- $F = 96485\\,\\mathrm{C\\,mol^{-1}}$\n- $[\\mathrm{Na}^{+}]_{\\mathrm{out}} = 30\\,\\mathrm{mM}$\n- $[\\mathrm{Na}^{+}]_{\\mathrm{in}} = 12\\,\\mathrm{mM}$\n\n$$ E_{\\mathrm{Na}} = \\frac{(8.314)(310)}{(+1)(96485)} \\ln\\left(\\frac{30}{12}\\right) = \\frac{2577.34}{96485} \\ln(2.5) $$\n$$ E_{\\mathrm{Na}} \\approx (0.026712\\,\\mathrm{V}) \\times (0.91629) \\approx 0.02448\\,\\mathrm{V} = 24.48\\,\\mathrm{mV} $$\n接下来，计算宏观钠电导 $G_{\\mathrm{Na}}$。\n- $N = 2000$\n- $P_o = 0.20$\n- $\\gamma = 5\\,\\mathrm{pS} = 5 \\times 10^{-12}\\,\\mathrm{S}$\n\n$$ G_{\\mathrm{Na}} = (2000)(0.20)(5\\,\\mathrm{pS}) = 400 \\times 5\\,\\mathrm{pS} = 2000\\,\\mathrm{pS} $$\n$$ G_{\\mathrm{Na}} = 2000 \\times 10^{-12}\\,\\mathrm{S} = 2 \\times 10^{-9}\\,\\mathrm{S} $$\n最后，计算净钠离子电流 $I_{\\mathrm{Na}}$。\n- $G_{\\mathrm{Na}} = 2 \\times 10^{-9}\\,\\mathrm{S}$\n- $V_m = -60\\,\\mathrm{mV} = -0.060\\,\\mathrm{V}$\n- $E_{\\mathrm{Na}} \\approx 0.02448\\,\\mathrm{V}$\n\n$$ I_{\\mathrm{Na}} = G_{\\mathrm{Na}} (V_m - E_{\\mathrm{Na}}) = (2 \\times 10^{-9}\\,\\mathrm{S}) \\times (-0.060\\,\\mathrm{V} - 0.02448\\,\\mathrm{V}) $$\n$$ I_{\\mathrm{Na}} = (2 \\times 10^{-9}\\,\\mathrm{S}) \\times (-0.08448\\,\\mathrm{V}) $$\n$$ I_{\\mathrm{Na}} = -1.6896 \\times 10^{-10}\\,\\mathrm{A} $$\n问题要求答案以皮安（$\\mathrm{pA}$）为单位，其中 $1\\,\\mathrm{pA} = 10^{-12}\\,\\mathrm{A}$。\n$$ I_{\\mathrm{Na}} = -1.6896 \\times 10^{-10}\\,\\mathrm{A} = -168.96 \\times 10^{-12}\\,\\mathrm{A} = -168.96\\,\\mathrm{pA} $$\n符号约定规定正电流为外向电流。我们结果的负号正确地表示了内向电流，即正钠离子流入细胞。这是预料之中的，因为膜电位（$-60\\,\\mathrm{mV}$）远比钠平衡电位（$\\approx +24.5\\,\\mathrm{mV}$）更负，从而产生强大的内向电化学驱动力。\n\n将结果四舍五入至三位有效数字：\n$$ I_{\\mathrm{Na}} \\approx -169\\,\\mathrm{pA} $$\n这是最终的数值答案。", "answer": "$$\n\\boxed{-169}\n$$", "id": "2572665"}, {"introduction": "在真实的生理环境中，味觉感受器很少只与一种分子作用。本练习将我们从单一刺激的模型推进到更复杂的受体竞争场景，这是药理学和感觉编码中的一个核心概念。通过分析一种竞争性拮抗剂如何影响苦味受体的功能，您将运用 Cheng-Prusoff 和 Schild 关系式，将结合亲和力（$K_i$）与功能效价的变化（$EC_{50}$）联系起来，从而揭示分子间的相互作用如何塑造我们的感官知觉。[@problem_id:2572704]", "problem": "一种异源表达的人类味觉受体2型 (T2R)，它是一种G蛋白偶联受体 (GPCR)，可被苦味激动剂denatonium激活。在一个平衡竞争结合测定中，假设实验在质量作用动力学适用且只有一个正构位点的温度和离子条件下进行，使用denatonium作为示踪配体，其浓度为 $[A] = 4.0\\,\\mu\\mathrm{M}$。独立的饱和结合实验测得denatonium在该受体上的平衡解离常数为 $K_{d} = 8.0\\,\\mu\\mathrm{M}$。Probenecid作为同一位点上的纯粹竞争性拮抗剂，在上述竞争测定中，测得其半数抑制浓度 (IC$_{50}$) 为 $IC_{50} = 500\\,\\mu\\mathrm{M}$。\n\n在一个独立的、具有相同受体表达和信号传导背景的功能性钙成像测定中，分别在不存在和存在 $[I] = 1.00\\,\\mathrm{mM}$ Probenecid的条件下，测量了denatonium的浓度-效应曲线。假设如下条件：正构位点上的纯粹竞争性拮抗作用，激动剂效能无变化，希尔系数 $n_{H} = 1$，受体储备可忽略不计（因此半数最大效应与半数占据密切对应），以及平衡条件。使用基于质量作用定律的标准受体结合框架和经过充分检验的Cheng–Prusoff关系式（该关系式将竞争性拮抗剂的 $IC_{50}$ 与其抑制常数 $K_{i}$ 联系起来），从结合数据中推断出 $K_{i}$。然后，利用竞争性拮抗作用的受体占据理论，确定denatonium浓度-效应曲线的倍数性右移（剂量比）$r$，其定义为 $r = EC_{50,\\mathrm{with\\ antagonist}}/EC_{50,\\mathrm{control}}$。\n\n在这些假设下计算 $r$。将您的最终答案以一个纯数（无量纲）的形式表示，并四舍五入到三位有效数字。", "solution": "在尝试求解之前，将对问题陈述进行验证。\n\n### 第1步：提取已知条件\n提供的明确数据如下：\n- 激动剂 (示踪剂): Denatonium\n- 结合测定中的激动剂浓度: $[A] = 4.0\\,\\mu\\mathrm{M}$\n- 激动剂平衡解离常数: $K_{d} = 8.0\\,\\mu\\mathrm{M}$\n- 拮抗剂: Probenecid\n- 拮抗机制: 正构位点上的纯粹竞争性\n- 拮抗剂半数抑制浓度: $IC_{50} = 500\\,\\mu\\mathrm{M}$\n- 功能测定中的拮抗剂浓度: $[I] = 1.00\\,\\mathrm{mM}$\n- 激动剂功能效应的希尔系数: $n_{H} = 1$\n- 假设受体储备可忽略不计。\n- 假设为平衡条件。\n- 要求计算: 剂量比, $r = EC_{50,\\mathrm{with\\ antagonist}}/EC_{50,\\mathrm{control}}$\n\n### 第2步：使用提取的已知条件进行验证\n根据既定标准对问题进行验证。\n\n- **科学依据充分**: 该问题基于受体药理学的基本原理，特别是质量作用定律在G蛋白偶联受体上竞争性配体结合和功能性拮抗作用中的应用。$K_d$、$K_i$、$IC_{50}$、Cheng-Prusoff关系式以及Gaddum-Schild剂量比等概念都是该领域的标准且经过充分验证的。所涉及的物质 (denatonium, probenecid) 和受体系统 (T2R) 都是真实存在的科学研究对象。该问题在科学上是合理的。\n- **问题定义明确**: 问题提供了足够的数据和一组清晰的假设（竞争性拮抗、受体储备可忽略等），足以计算出唯一且有意义的解。\n- **客观性**: 语言技术性强、精确，无主观或模糊的术语。\n- **完整性和一致性**: 提供了必要的参数（$[A]$, $K_d$, $IC_{50}$, $[I]$）。诸如可忽略的受体储备和$n_H=1$等假设，以一种明确的方式将结合特性（$K_i$）与功能结果（剂量比$r$）联系起来，确保了问题两部分之间的一致性。\n\n### 第3步：结论与行动\n问题被判定为**有效**。这是一个标准的、定义明确的定量药理学问题，具有科学依据和内部一致性。现在将推导求解。\n\n求解过程分两个阶段。首先，根据竞争性结合测定数据确定拮抗剂probenecid的抑制常数$K_i$。其次，利用此$K_i$值预测功能测定中激动剂浓度-效应曲线的右移（剂量比，$r$）。\n\n**第1部分：确定抑制常数 ($K_i$)**\n\n对于竞争性拮抗剂，其半数抑制浓度 ($IC_{50}$) 与其平衡抑制常数 ($K_i$) 之间的关系由Cheng-Prusoff方程描述。该方程考虑了结合测定中标记激动剂（示踪剂）的存在。\n\nCheng-Prusoff方程为：\n$$K_i = \\frac{IC_{50}}{1 + \\frac{[A]}{K_d}}$$\n其中$[A]$是激动剂示踪剂的浓度，$K_d$是其平衡解离常数。\n\n已知值为：\n- $IC_{50} = 500\\,\\mu\\mathrm{M}$\n- $[A] = 4.0\\,\\mu\\mathrm{M}$\n- $K_d = 8.0\\,\\mu\\mathrm{M}$\n\n将这些值代入方程：\n$$K_i = \\frac{500\\,\\mu\\mathrm{M}}{1 + \\frac{4.0\\,\\mu\\mathrm{M}}{8.0\\,\\mu\\mathrm{M}}} = \\frac{500\\,\\mu\\mathrm{M}}{1 + 0.5} = \\frac{500\\,\\mu\\mathrm{M}}{1.5}$$\n$$K_i = \\frac{1000}{3}\\,\\mu\\mathrm{M}$$\n这是竞争性拮抗剂probenecid的平衡解离常数。\n\n**第2部分：确定剂量比 ($r$)**\n\n问题描述了一个功能性测定，其中测量了在不存在和存在拮抗剂probenecid的情况下激动剂denatonium的浓度-效应曲线。对于处于平衡状态的纯粹竞争性拮抗剂，其对激动剂效价的影响通过剂量比$r$来量化。$r$的值取决于拮抗剂的浓度$[I]$及其对受体的亲和力（由其抑制常数$K_i$描述）。\n\n该关系由Gaddum-Schild方程给出：\n$$r = 1 + \\frac{[I]}{K_i}$$\n由于纯粹竞争性拮抗、平衡条件、以及在$n_H = 1$时受体储备可忽略不计的假设，该方程在此直接适用。这些假设共同意味着激动剂的功能性$EC_{50}$因受体竞争而被直接移动。从结合测定中确定的抑制常数 $K_i$ 等同于Schild分析中常用的拮抗剂解离常数$K_B$。\n\n给定的拮抗剂浓度为 $[I] = 1.00\\,\\mathrm{mM}$。为与$K_i$的单位保持一致，必须将其转换为 $\\mu\\mathrm{M}$：\n$$[I] = 1.00\\,\\mathrm{mM} = 1.00 \\times 1000\\,\\mu\\mathrm{M} = 1000\\,\\mu\\mathrm{M}$$\n\n现在，将$[I]$和先前计算出的$K_i$的值代入Gaddum-Schild方程：\n$$r = 1 + \\frac{1000\\,\\mu\\mathrm{M}}{\\frac{1000}{3}\\,\\mu\\mathrm{M}}$$\n如对无量纲剂量比所预期的那样，$\\mu\\mathrm{M}$的单位被消掉：\n$$r = 1 + \\frac{1000 \\times 3}{1000} = 1 + 3 = 4$$\n计算出的剂量比恰好为$4$。问题要求答案四舍五入到三位有效数字。将$4$表示为三位有效数字得到$4.00$。\n\n因此，预计$1.00\\,\\mathrm{mM}$ Probenecid的存在会导致denatonium的浓度-效应曲线发生四倍的右移。", "answer": "$$\\boxed{4.00}$$", "id": "2572704"}, {"introduction": "为了完整理解味觉，我们必须将细胞层面的机制与整个生物体的感知联系起来。本练习通过应用史蒂文斯幂定律，为刺激物理浓度与感知强度之间的关系建模，从而搭建起这座桥梁。通过对代表不同味觉类型（如甜、咸、苦）的假设数据进行拟合，您将量化它们独特的非线性特征，并学习如何从幂定律的指数中推断潜在转导通路的特性，例如它们是压缩性的还是扩张性的。[@problem_id:2572673]", "problem": "要求您实现并应用一个规范的估计量来估算 Stevens 幂律中的指数，这些数据是味觉强度数据，并对该指数在非线性转导方面的解释进行形式化。Stevens 幂律假定，感知强度 $I$ 与刺激 $S$ 遵循 $I = k S^n$ 的关系，其中 $I$ 是以任意单位 (a.u.) 表示的感知强度，$S$ 是以任意单位 (a.u.) 表示的刺激浓度，$k \\gt 0$ 是一个增益因子，$n$ 是一个反映转导非线性的无量纲指数。仅使用以下基本事实和定义：(i) 对数定律，特别是当 $a,b \\gt 0$ 时，$\\ln(ab) = \\ln a + \\ln b$ 和 $\\ln(a^b) = b \\ln a$，以及 (ii) 通过普通最小二乘法 (OLS) 拟合直线 $y = a + b x$ 可以最小化残差平方和，并得出能最小化残差平方和的唯一斜率 $b$ 和截距 $a$。\n\n您的程序必须：\n- 通过变换 $x = \\ln S$，$y = \\ln I$ 将 $I = k S^n$ 线性化，从而使 $\\ln I = \\ln k + n \\ln S$ 变为 $y = a + n x$（其中 $a = \\ln k$），并以此实现一个用于估算指数 $n$ 和增益 $k$ 的 OLS 估计量。\n- 使用自然对数 $\\ln$。\n- 对每个数据集，返回四舍五入到三位小数的指数 $n$。\n- 此外，使用容差 $\\tau = 0.05$ 的规则对该感觉模态的非线性进行分类：如果 $|n - 1| \\le \\tau$，则标记为“近线性”；如果 $n \\gt 1 + \\tau$，则标记为“扩张性”；如果 $n \\lt 1 - \\tau$，则标记为“压缩性”。将这些类别编码为整数：近线性 $\\to 0$，扩张性 $\\to 1$，压缩性 $\\to -1$。\n\n测试套件。使用以下四个代表不同味觉模态或参考行为的数据集。在所有情况下，强度均由 $I = k S^n$ 定义，不添加噪声以分离出该映射关系。所有的 $S$ 和 $I$ 均以任意单位 (a.u.) 表示。\n\n1) 甜味（典型的超线性）：$k = 0.9$，$n = 1.35$，刺激向量 $S = [0.02, 0.05, 0.1, 0.2, 0.5]$。\n2) 咸味（典型的近线性）：$k = 1.1$，$n = 0.95$，刺激向量 $S = [0.03, 0.06, 0.12, 0.24, 0.48]$。\n3) 苦味（低浓度下典型的压缩性）：$k = 0.7$，$n = 0.6$，刺激向量 $S = [0.0001, 0.0003, 0.001, 0.003, 0.01]$。\n4) 参考线性传感器（边界情况）：$k = 1.0$，$n = 1.0$，刺激向量 $S = [0.2, 1.0, 5.0]$。\n\n对于每个数据集，使用 $I = k S^n$ 精确构造 $I$。\n\n估计量的数学规范。对于每个包含样本 $\\{(S_i, I_i)\\}_{i=1}^N$（其中 $S_i \\gt 0$ 且 $I_i \\gt 0$）的数据集，定义 $x_i = \\ln S_i$ 和 $y_i = \\ln I_i$。设 $\\bar{x} = \\frac{1}{N}\\sum_{i=1}^N x_i$ 和 $\\bar{y} = \\frac{1}{N}\\sum_{i=1}^N y_i$。OLS 斜率为\n$$\nn = \\frac{\\sum_{i=1}^N (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^N (x_i - \\bar{x})^2},\n$$\n截距为\n$$\na = \\bar{y} - n \\bar{x},\n$$\n由此得出 $k = e^a$。\n\n最终输出格式。您的程序应生成一行输出，其中包含一个用方括号括起来的、由逗号分隔的列表。该列表必须按顺序包含：\n- 数据集 1-4 的四个拟合指数 $n$，每个都四舍五入到三位小数并表示为浮点数。\n- 数据集 1-4 的四个整数类别代码，使用上述容差规则。\n\n因此，最终输出应如下所示：$[n_1,n_2,n_3,n_4,c_1,c_2,c_3,c_4]$，其中 $n_j$ 是具有三位小数的浮点数，且 $c_j \\in \\{-1,0,1\\}$。\n\n角度单位不适用。由于所有量都以任意单位 (a.u.) 表示，因此不需要进行物理单位转换。答案是指定格式的无量纲浮点数和整数。\n\n您的程序必须硬编码上述测试套件，且不得读取任何输入。\n\n科学解释（不作为打印输出的一部分）应将 $n$ 的符号和大小与潜在的受体和通道转导非线性联系起来：压缩性（$n \\lt 1$）与饱和结合或下游适应/压缩相一致；扩张性（$n \\gt 1$）可能源于协同过程或阈值募集；近线性（$n \\approx 1$）表示在测试范围内的比例转导。", "solution": "从 Stevens 幂律 $I = k S^n$ 开始，其中 $I \\gt 0$, $S \\gt 0$, $k \\gt 0$, 且 $n \\in \\mathbb{R}$。应用自然对数。使用 $\\ln(a^b) = b \\ln a$ 和 $\\ln(ab) = \\ln a + \\ln b$，我们得到\n$$\n\\ln I = \\ln(k S^n) = \\ln k + \\ln(S^n) = \\ln k + n \\ln S.\n$$\n定义 $x = \\ln S$ 和 $y = \\ln I$。模型变为 $y = a + n x$，其中 $a = \\ln k$。因此，估计 $n$ 的问题简化为通过普通最小二乘法 (OLS) 对 $(x_i, y_i)$ 进行直线拟合。对于 $N$ 个配对样本 $(S_i, I_i)$，$x_i = \\ln S_i$，$y_i = \\ln I_i$，以及均值 $\\bar{x} = \\frac{1}{N}\\sum_{i=1}^N x_i$，$\\bar{y} = \\frac{1}{N}\\sum_{i=1}^N y_i$，OLS 斜率为\n$$\nn = \\frac{\\sum_{i=1}^N (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^N (x_i - \\bar{x})^2},\n$$\n截距为\n$$\na = \\bar{y} - n \\bar{x}.\n$$\n于是 $k = e^a$。\n\n估计算法的算法设计：\n1. 对于每个数据集，按规定计算 $I_i = k S_i^n$（无噪声），然后计算 $x_i = \\ln S_i$ 和 $y_i = \\ln I_i$。\n2. 计算 $\\bar{x}$ 和 $\\bar{y}$，然后计算斜率公式的分子和分母。结果是拟合指数 $\\hat{n}$ 和 $\\hat{a} = \\bar{y} - \\hat{n}\\bar{x}$，其中 $\\hat{k} = e^{\\hat{a}}$。\n3. 将 $\\hat{n}$ 四舍五入到三位小数以便报告。\n4. 使用容差 $\\tau = 0.05$ 进行分类：\n   - 如果 $|\\hat{n} - 1| \\le \\tau$，类别 $= 0$（近线性）。\n   - 如果 $\\hat{n} \\gt 1 + \\tau$，类别 $= 1$（扩张性）。\n   - 如果 $\\hat{n} \\lt 1 - \\tau$，类别 $= -1$（压缩性）。\n\n因为所提供的数据集是根据固定的 $k$ 和 $n$ 从 $I = k S^n$ 精确生成的，所以在对数-对数坐标上的 OLS 拟合能在数值精度上恢复真实的 $n$，这与 $S$ 值的采样无关，只要至少有两个不同的 $S$ 值即可。\n\n应用于测试套件：\n\n1) 甜味：$k = 0.9$，$n = 1.35$，$S = [0.02, 0.05, 0.1, 0.2, 0.5]$。精确的对数-线性关系得出 $\\hat{n} \\approx 1.35$。当 $\\tau = 0.05$ 时，$|\\hat{n} - 1| \\approx 0.35 \\gt 0.05$，且 $\\hat{n} \\gt 1 + \\tau$，所以类别 $= 1$（扩张性）。解释：扩张性非线性与协同激活或跨多个受体-转导步骤的募集相一致（例如，在工作范围内具有超线性增益的 G 蛋白偶联级联反应）。\n\n2) 咸味：$k = 1.1$，$n = 0.95$，$S = [0.03, 0.06, 0.12, 0.24, 0.48]$。精确拟合得出 $\\hat{n} \\approx 0.95$。当 $\\tau = 0.05$ 时，$|\\hat{n} - 1| = 0.05 \\le 0.05$，所以类别 $= 0$（近线性）。解释：近线性与离子通道介导的转导相一致（例如，上皮钠通道），在测量范围内具有比例驱动特性。\n\n3) 苦味：$k = 0.7$，$n = 0.6$，$S = [0.0001, 0.0003, 0.001, 0.003, 0.01]$。精确拟合得出 $\\hat{n} \\approx 0.6$。由于 $\\hat{n} \\lt 1 - \\tau$，类别 $= -1$（压缩性）。解释：压缩性非线性可能源于饱和的受体结合、并行的抑制性反馈或压缩动态范围的下游信号传导中的适应。\n\n4) 参考线性：$k = 1.0$，$n = 1.0$，$S = [0.2, 1.0, 5.0]$。精确拟合得出 $\\hat{n} \\approx 1.0$。当 $\\tau = 0.05$ 时，类别 $= 0$（近线性）。解释：比例传感器在测试范围内实现近似线性的映射。\n\n汇总四舍五入后的指数和类别，预期输出为 $[1.350, 0.950, 0.600, 1.000, 1, 0, -1, 0]$。\n\n这个基于原则的流程清晰地将数学估计（通过对数线性化和 OLS）与生理学解释（对反映采样范围内压缩性、线性或扩张性转导的 $n$ 进行分类）分离开来。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef fit_power_law_exponent(S, I):\n    \"\"\"\n    Fit Stevens' power law I = k * S^n by linearizing with natural logs.\n    Returns (n, k) where n is the exponent and k the gain.\n    \"\"\"\n    x = np.log(S)\n    y = np.log(I)\n    x_mean = np.mean(x)\n    y_mean = np.mean(y)\n    # Compute OLS slope (n) and intercept (a)\n    numerator = np.sum((x - x_mean) * (y - y_mean))\n    denominator = np.sum((x - x_mean) ** 2)\n    # Handle potential degenerate case (should not occur with provided data)\n    if denominator == 0.0:\n        raise ValueError(\"Degenerate data: all S values identical in log-space.\")\n    n = numerator / denominator\n    a = y_mean - n * x_mean\n    k = np.exp(a)\n    return n, k\n\ndef classify_nonlinearity(n, tau=0.05):\n    \"\"\"\n    Classify exponent n using tolerance tau:\n    -1: compressive (n < 1 - tau)\n     0: near-linear (|n - 1| <= tau)\n     1: expansive (n > 1 + tau)\n    \"\"\"\n    if abs(n - 1.0) <= tau:\n        return 0\n    elif n > 1.0 + tau:\n        return 1\n    else:\n        return -1\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (name, k, n_true, S_array)\n    test_cases = [\n        (\"sweet\", 0.9, 1.35, np.array([0.02, 0.05, 0.1, 0.2, 0.5], dtype=float)),\n        (\"salty\", 1.1, 0.95, np.array([0.03, 0.06, 0.12, 0.24, 0.48], dtype=float)),\n        (\"bitter\", 0.7, 0.6, np.array([1e-4, 3e-4, 1e-3, 3e-3, 1e-2], dtype=float)),\n        (\"reference_linear\", 1.0, 1.0, np.array([0.2, 1.0, 5.0], dtype=float)),\n    ]\n\n    # Construct I arrays exactly using I = k * S^n as specified (no noise).\n    results_exponents = []\n    results_classes = []\n    for _, k_true, n_true, S in test_cases:\n        I = k_true * (S ** n_true)\n        n_fit, k_fit = fit_power_law_exponent(S, I)\n        # Round exponent to three decimals for output\n        n_out = round(float(n_fit), 3)\n        results_exponents.append(f\"{n_out:.3f}\")\n        cls = classify_nonlinearity(n_fit, tau=0.05)\n        results_classes.append(str(int(cls)))\n\n    # Aggregate results: [n1,n2,n3,n4,c1,c2,c3,c4]\n    out_list = results_exponents + results_classes\n    print(f\"[{','.join(out_list)}]\")\n\nsolve()\n```", "id": "2572673"}]}