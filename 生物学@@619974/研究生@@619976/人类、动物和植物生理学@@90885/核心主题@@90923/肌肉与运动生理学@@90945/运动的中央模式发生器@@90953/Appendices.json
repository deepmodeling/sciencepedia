{"hands_on_practices": [{"introduction": "我们实践的第一步是探究节律的根源：单个神经元的内在起搏能力。许多CPG包含能够自主产生节律性爆发活动的起搏神经元。这个练习旨在通过一个经典的快慢系统分解模型，揭示电压依赖性钙离子电流 $I_{\\mathrm{Ca}}$ 和钙激活钾离子电流 $I_{\\mathrm{KCa}}$ 之间的相互作用是如何驱动这种节律的 [@problem_id:2556980]。通过从第一性原理推导爆发周期和占空比，你将深入理解离子流动力学如何转化为可观察的神经节律时间特性。", "problem": "考虑一个用于运动的中枢模式发生器中的单个起搏神经元，其簇放电由电压依赖性钙电流 ($I_{\\mathrm{Ca}}$) 和钙激活钾电流 ($I_{\\mathrm{KCa}}$) 在标准快慢分解下的相互作用产生。假设细胞内游离钙浓度 $[{\\mathrm{Ca}}]$（为简洁起见，记为 $c$）作为慢变量，其广泛使用的粗粒度描述如下。在活动（放电）期，通过 $I_{\\mathrm{Ca}}$ 的平均钙内流将 $c$ 推向一个较高的准稳态水平 $c_{\\mathrm{hi}}$，而在静息（非放电）期，泵和交换体将 $c$ 推向一个较低的准稳态水平 $c_{\\mathrm{lo}}$。在一阶缓冲和清除条件下，慢动力学为\n$$\n\\frac{dc}{dt} =\n\\begin{cases}\n\\dfrac{c_{\\mathrm{hi}} - c}{\\tau_{\\mathrm{Ca}}} & \\text{(活动期)}， \\\\[6pt]\n\\dfrac{c_{\\mathrm{lo}} - c}{\\tau_{\\mathrm{Ca}}} & \\text{(静息期)}，\n\\end{cases}\n$$\n其中 $\\tau_{\\mathrm{Ca}}$ 是有效钙时间常数。钙激活钾电流 $I_{\\mathrm{KCa}}$ 随 $c$ 单调增加，当 $c$ 穿过上阈值 $c_{\\mathrm{off}}$ 时，活动期终止；而当 $c$ 衰减到下阈值 $c_{\\mathrm{on}}$ 以下时，静息期结束，放电恢复。假设阈值为常数，满足 $c_{\\mathrm{lo}} < c_{\\mathrm{on}} < c_{\\mathrm{off}} < c_{\\mathrm{hi}}$，并且每个簇放电周期在 $c = c_{\\mathrm{on}}$ 开始，在 $c = c_{\\mathrm{off}}$ 结束活动期，然后在 $c$ 返回到 $c = c_{\\mathrm{on}}$ 时结束静息期。您可以假设时间尺度分离，因此快电压动力学在阈值处瞬时切换，并且 $c$ 的慢演化可由上述一阶线性常微分方程很好地描述。\n\n任务：从第一性原理出发，推导活动期持续时间 $T_{\\mathrm{on}}$ 和静息期持续时间 $T_{\\mathrm{off}}$ 关于 $\\tau_{\\mathrm{Ca}}$、$c_{\\mathrm{hi}}$、$c_{\\mathrm{lo}}$、$c_{\\mathrm{on}}$ 和 $c_{\\mathrm{off}}$ 的表达式。然后，使用这些表达式编写一个程序，计算基线 $\\tau_{\\mathrm{Ca}}$ 条件下以及 $\\tau_{\\mathrm{Ca}}$ 减半的缓冲条件下的簇放电周期 $T = T_{\\mathrm{on}} + T_{\\mathrm{off}}$（以毫秒为单位）和占空比 $D = T_{\\mathrm{on}} / T$（无量纲小数）。时间以毫秒报告，占空比以小数形式报告。不涉及角度。\n\n对于下面的每个测试用例，计算并返回一个包含四个值的列表：$[T_{\\text{base}}, D_{\\text{base}}, T_{\\text{buf}}, D_{\\text{buf}}]$，其中 $T_{\\text{base}}$ 和 $D_{\\text{base}}$ 是基线 $\\tau_{\\mathrm{Ca}}$ 的周期和占空比，而 $T_{\\text{buf}}$ 和 $D_{\\text{buf}}$ 是在缓冲作用使时间常数减半至 $\\tau_{\\mathrm{Ca}}/2$ 时的周期和占空比。所有时间量必须以毫秒表示，并四舍五入到 $6$ 位小数；占空比值必须四舍五入到 $6$ 位小数。\n\n使用以下参数集测试套件，每个参数集定义为一个元组 $(\\tau_{\\mathrm{Ca}}, c_{\\mathrm{hi}}, c_{\\mathrm{lo}}, c_{\\mathrm{on}}, c_{\\mathrm{off}})$，其中浓度单位为微摩尔，$\\tau_{\\mathrm{Ca}}$ 单位为毫秒：\n- 测试 $1$：$(200.0, 1.0, 0.05, 0.2, 0.8)$\n- 测试 $2$：$(150.0, 0.9, 0.1, 0.2, 0.7)$\n- 测试 $3$：$(100.0, 1.2, 0.0, 0.55, 0.6)$\n- 测试 $4$：$(250.0, 1.0, 0.02, 0.03, 0.9)$\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表中的每个元素对应一个测试用例，并且本身是按 $[T_{\\text{base}}, D_{\\text{base}}, T_{\\text{buf}}, D_{\\text{buf}}]$ 顺序排列的四个数字的列表。例如，打印的输出应如下所示：\n`[[\\dots],[\\dots],[\\dots],[\\dots]]`\n\n在推导和实现中需要遵守的假设和约束：\n- 仅使用一阶线性常微分方程解的基本定义以及 $I_{\\mathrm{KCa}}$ 对 $c$ 的单调性。\n- 除上述模型所隐含的之外，不要引入任何唯象的简化方法。\n- 在每个测试用例中，通过遵守 $c_{\\mathrm{lo}} < c_{\\mathrm{on}} < c_{\\mathrm{off}} < c_{\\mathrm{hi}}$ 来确保所有对数都有良好定义。", "solution": "问题陈述已经过严格验证。所有提供的信息，包括钙浓度 $c$ 的微分方程、阈值 $c_{\\mathrm{on}}$ 和 $c_{\\mathrm{off}}$ 的定义、参数不等式 $c_{\\mathrm{lo}} < c_{\\mathrm{on}} < c_{\\mathrm{off}} < c_{\\mathrm{hi}}$ 以及测试参数，都是自洽的，科学上基于已建立的生物物理建模原理（快慢分解），并且在数学上是适定的。该问题没有矛盾、歧义和非形式化元素。因此，该问题被认为是有效的，并将推导出一个完整的解。\n\n任务是从第一性原理出发，推导活动期持续时间 $T_{\\mathrm{on}}$ 和静息期持续时间 $T_{\\mathrm{off}}$ 的表达式。\n\n活动期持续时间 $T_{\\mathrm{on}}$ 的推导：\n在活动期，细胞内钙浓度 $c$ 的动力学由以下一阶线性常微分方程控制：\n$$\n\\frac{dc}{dt} = \\frac{c_{\\mathrm{hi}} - c}{\\tau_{\\mathrm{Ca}}}\n$$\n该方程是可分离的。我们重新排列各项以进行积分：\n$$\n\\int \\frac{1}{c_{\\mathrm{hi}} - c} dc = \\int \\frac{1}{\\tau_{\\mathrm{Ca}}} dt\n$$\n积分得到：\n$$\n-\\ln|c_{\\mathrm{hi}} - c| = \\frac{t}{\\tau_{\\mathrm{Ca}}} + K\n$$\n其中 $K$ 是积分常数。考虑到在充电阶段的生物物理约束 $c < c_{\\mathrm{hi}}$，绝对值是不必要的，因此 $|c_{\\mathrm{hi}} - c| = c_{\\mathrm{hi}} - c$。整理得到 $c(t)$ 的通解：\n$$\n\\ln(c_{\\mathrm{hi}} - c) = -\\frac{t}{\\tau_{\\mathrm{Ca}}} - K\n$$\n$$\nc_{\\mathrm{hi}} - c = e^{-K} e^{-t/\\tau_{\\mathrm{Ca}}}\n$$\n$$\nc(t) = c_{\\mathrm{hi}} - A e^{-t/\\tau_{\\mathrm{Ca}}}\n$$\n其中 $A = e^{-K}$ 是一个由初始条件决定的新常数。活动期在时间 $t=0$ 开始，此时钙浓度处于下阈值 $c(0) = c_{\\mathrm{on}}$。代入此条件：\n$$\nc_{\\mathrm{on}} = c_{\\mathrm{hi}} - A e^{0} \\implies A = c_{\\mathrm{hi}} - c_{\\mathrm{on}}\n$$\n因此，活动期的特解是：\n$$\nc(t) = c_{\\mathrm{hi}} - (c_{\\mathrm{hi}} - c_{\\mathrm{on}}) e^{-t/\\tau_{\\mathrm{Ca}}}\n$$\n当浓度达到上阈值 $c(T_{\\mathrm{on}}) = c_{\\mathrm{off}}$ 时，活动期终止。我们求解持续时间 $T_{\\mathrm{on}}$：\n$$\nc_{\\mathrm{off}} = c_{\\mathrm{hi}} - (c_{\\mathrm{hi}} - c_{\\mathrm{on}}) e^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{Ca}}}\n$$\n$$\n(c_{\\mathrm{hi}} - c_{\\mathrm{on}}) e^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{Ca}}} = c_{\\mathrm{hi}} - c_{\\mathrm{off}}\n$$\n$$\ne^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{Ca}}} = \\frac{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}\n$$\n对两边取自然对数：\n$$\n-\\frac{T_{\\mathrm{on}}}{\\tau_{\\mathrm{Ca}}} = \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}\\right)\n$$\n活动期持续时间的最终表达式是：\n$$\nT_{\\mathrm{on}} = -\\tau_{\\mathrm{Ca}} \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}\\right) = \\tau_{\\mathrm{Ca}} \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right)\n$$\n条件 $c_{\\mathrm{on}} < c_{\\mathrm{off}} < c_{\\mathrm{hi}}$ 确保了对数的参数大于 $1$，因此 $T_{\\mathrm{on}}$ 为正。\n\n静息期持续时间 $T_{\\mathrm{off}}$ 的推导：\n在静息期，$c$ 的控制方程是：\n$$\n\\frac{dc}{dt} = \\frac{c_{\\mathrm{lo}} - c}{\\tau_{\\mathrm{Ca}}}\n$$\n该方程的结构与活动期的方程相同。因此，通解是：\n$$\nc(t) = c_{\\mathrm{lo}} - B e^{-t/\\tau_{\\mathrm{Ca}}}\n$$\n其中 $B$ 是一个常数。静息期在时间 $t=0$ 开始（我们为此阶段重置时钟），此时钙浓度处于上阈值 $c(0) = c_{\\mathrm{off}}$。代入此初始条件：\n$$\nc_{\\mathrm{off}} = c_{\\mathrm{lo}} - B e^{0} \\implies B = c_{\\mathrm{lo}} - c_{\\mathrm{off}}\n$$\n静息期的特解是：\n$$\nc(t) = c_{\\mathrm{lo}} - (c_{\\mathrm{lo}} - c_{\\mathrm{off}}) e^{-t/\\tau_{\\mathrm{Ca}}} = c_{\\mathrm{lo}} + (c_{\\mathrm{off}} - c_{\\mathrm{lo}}) e^{-t/\\tau_{\\mathrm{Ca}}}\n$$\n当浓度衰减回下阈值 $c(T_{\\mathrm{off}}) = c_{\\mathrm{on}}$ 时，静息期终止。我们求解持续时间 $T_{\\mathrm{off}}$：\n$$\nc_{\\mathrm{on}} = c_{\\mathrm{lo}} + (c_{\\mathrm{off}} - c_{\\mathrm{lo}}) e^{-T_{\\mathrm{off}}/\\tau_{\\mathrm{Ca}}}\n$$\n$$\nc_{\\mathrm{on}} - c_{\\mathrm{lo}} = (c_{\\mathrm{off}} - c_{\\mathrm{lo}}) e^{-T_{\\mathrm{off}}/\\tau_{\\mathrm{Ca}}}\n$$\n$$\ne^{-T_{\\mathrm{off}}/\\tau_{\\mathrm{Ca}}} = \\frac{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}\n$$\n对两边取自然对数：\n$$\n-\\frac{T_{\\mathrm{off}}}{\\tau_{\\mathrm{Ca}}} = \\ln\\left(\\frac{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}\\right)\n$$\n静息期持续时间的最终表达式是：\n$$\nT_{\\mathrm{off}} = -\\tau_{\\mathrm{Ca}} \\ln\\left(\\frac{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}\\right) = \\tau_{\\mathrm{Ca}} \\ln\\left(\\frac{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}\\right)\n$$\n条件 $c_{\\mathrm{lo}} < c_{\\mathrm{on}} < c_{\\mathrm{off}}$ 确保了对数的参数大于 $1$，因此 $T_{\\mathrm{off}}$ 为正。\n\n簇放电周期 ($T$) 和占空比 ($D$) 的计算：\n总簇放电周期 $T$ 是活动期和静息期持续时间之和：\n$$\nT = T_{\\mathrm{on}} + T_{\\mathrm{off}} = \\tau_{\\mathrm{Ca}} \\left[ \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right) + \\ln\\left(\\frac{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}\\right) \\right]\n$$\n占空比 $D$ 是周期中活动期所占的比例：\n$$\nD = \\frac{T_{\\mathrm{on}}}{T} = \\frac{\\tau_{\\mathrm{Ca}} \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right)}{\\tau_{\\mathrm{Ca}} \\left[ \\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right) + \\ln\\left(\\frac{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}\\right) \\right]}\n$$\n参数 $\\tau_{\\mathrm{Ca}}$ 被消去，表明占空比与钙时间常数无关，仅取决于浓度水平：\n$$\nD = \\frac{\\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right)}{\\ln\\left(\\frac{c_{\\mathrm{hi}} - c_{\\mathrm{on}}}{c_{\\mathrm{hi}} - c_{\\mathrm{off}}}\\right) + \\ln\\left(\\frac{c_{\\mathrm{off}} - c_{\\mathrm{lo}}}{c_{\\mathrm{on}} - c_{\\mathrm{lo}}}\\right)}\n$$\n对于缓冲条件，时间常数变为 $\\tau'_{\\mathrm{Ca}} = \\tau_{\\mathrm{Ca}}/2$。新的周期 $T_{\\text{buf}}$ 将是基线周期 $T_{\\text{base}}$ 的一半，因为 $T_{\\mathrm{on}}$ 和 $T_{\\mathrm{off}}$ 都与 $\\tau_{\\mathrm{Ca}}$ 成正比。新的占空比 $D_{\\text{buf}}$ 将与基线占空比 $D_{\\text{base}}$ 相同，因为它与 $\\tau_{\\mathrm{Ca}}$ 无关。\n\n这些推导出的公式在以下程序中实现，用于计算给定测试用例所需的值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the pacemaker neuron problem for a given set of test cases.\n    Derives burst period and duty cycle from first principles.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (tau_Ca, c_hi, c_lo, c_on, c_off)\n    test_cases = [\n        (200.0, 1.0, 0.05, 0.2, 0.8),\n        (150.0, 0.9, 0.1, 0.2, 0.7),\n        (100.0, 1.2, 0.0, 0.55, 0.6),\n        (250.0, 1.0, 0.02, 0.03, 0.9),\n    ]\n\n    # This function calculates the results for a single parameter set.\n    def calculate_metrics(tau_ca, c_hi, c_lo, c_on, c_off):\n        \"\"\"\n        Calculates and returns the list [T_base, D_base, T_buf, D_buf].\n        \n        Args:\n            tau_ca (float): Baseline calcium time constant in ms.\n            c_hi (float): Upper quasi-steady state concentration level.\n            c_lo (float): Lower quasi-steady state concentration level.\n            c_on (float): Lower threshold for spiking initiation.\n            c_off (float): Upper threshold for spiking termination.\n\n        Returns:\n            list: A list of four floats [T_base, D_base, T_buf, D_buf]\n                  rounded to 6 decimal places.\n        \"\"\"\n        # --- Baseline Calculation ---\n        # Active-phase duration\n        numerator_on = c_hi - c_on\n        denominator_on = c_hi - c_off\n        T_on_base = tau_ca * np.log(numerator_on / denominator_on)\n        \n        # Silent-phase duration\n        numerator_off = c_off - c_lo\n        denominator_off = c_on - c_lo\n        T_off_base = tau_ca * np.log(numerator_off / denominator_off)\n        \n        # Total period\n        T_base = T_on_base + T_off_base\n        \n        # Duty cycle\n        D_base = T_on_base / T_base\n        \n        # --- Buffered Condition Calculation ---\n        # In the buffered condition, tau_ca is halved.\n        # Since T is directly proportional to tau_ca, T_buf is half of T_base.\n        T_buf = T_base / 2.0\n        \n        # The duty cycle D is independent of tau_ca, so it remains unchanged.\n        D_buf = D_base\n        \n        # Return the results rounded to 6 decimal places as required.\n        return [\n            round(T_base, 6),\n            round(D_base, 6),\n            round(T_buf, 6),\n            round(D_buf, 6)\n        ]\n\n    results = []\n    # Process each test case\n    for case in test_cases:\n        tau_ca, c_hi, c_lo, c_on, c_off = case\n        \n        # Validate that the concentration thresholds are ordered correctly to prevent\n        # math domain errors (e.g., log of a non-positive number).\n        if not (c_lo < c_on < c_off < c_hi):\n             raise ValueError(f\"Invalid threshold ordering in case: {case}\")\n             \n        result = calculate_metrics(tau_ca, c_hi, c_lo, c_on, c_off)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2556980"}, {"introduction": "单个神经元的节律性是基础，但运动协调通常需要多个神经元组成的网络。在这个练习中，你将构建一个经典的“半中心振荡器”——一个由两个相互抑制的神经元组成的最小网络模型 [@problem_id:2557001]。关键在于，你将引入短期突触抑制这一重要的生物物理机制，并亲手模拟它如何导致爆发的终止和神经元活动的交替。这个实践将让你从理论走向实践，通过编程实现一个功能性的CPG核心回路，并量化突触动力学在塑造网络输出中的关键作用。", "problem": "你的任务是构建并分析一个对称半中心振荡器，该振荡器由两个通过突触连接的相互抑制的神经元单元组成，这些突触表现出短期突触抑制。你的任务是从突触资源动力学的机制性、基于守恒的原理和一阶低通神经元放电率动力学出发，推导出一个封闭的常微分方程组，对其进行数值模拟，并量化短期突触抑制如何控制爆发终止和爆发间期。\n\n使用的基本原理：\n- 突触资源守恒：一个有限的资源池，它会向其最大值恢复，并因突触前活动而消耗。\n- 一阶低通神经元放电率动力学，该动力学弛豫到净突触输入的静态输入输出非线性。\n- 用于静态输入输出函数的S型放电率非线性。\n\n建模要求：\n1. 考虑两个相同的神经元单元，由 $i \\in \\{1,2\\}$ 索引，其突触前伙伴为 $j \\neq i$。设 $r_i(t)$ 表示单元 $i$ 的放电率，单位为 $\\mathrm{s}^{-1}$；设 $x_i(t)$ 表示从单元 $i$ 到其伙伴的抑制性突触处可用突触资源的分数。设 $u \\in [0,1]$ 为单位突触前活动的恒定利用率（无量纲）。总可用资源被归一化为 $1$。\n\n2. 从以下原理出发，推导突触资源动力学：\n   - 资源以时间常数 $\\tau_{\\mathrm{rec}}$（单位为 $\\mathrm{s}$）向 $1$ 恢复，贡献项为 $(1 - x_i)/\\tau_{\\mathrm{rec}}$。\n   - 资源的消耗与瞬时突触前活动和当前可用资源成正比，贡献一个与 $u \\, x_i \\, r_i$ 成正比的项。\n   将这些原组合并成一个关于 $x_i(t)$ 的微分方程。\n\n3. 对于神经元输出动力学，使用一个向静态非线性 $F(h_i)$ 的一阶弛豫，时间常数为 $\\tau_r$（单位为 $\\mathrm{s}$）：\n   $$\\tau_r \\, \\frac{d r_i}{dt} = - r_i + F\\!\\left(h_i\\right).$$\n   输入 $h_i$ 是一个恒定的强直驱动 $I_0$（无量纲）与来自另一个单元的突触抑制之间的差值。来自单元 $j$ 的有效抑制性输出必须与利用率、可用资源和突触前放电率的乘积成正比，从而得到一个应根据第2项中的原理推导出的有效抑制性驱动 $y_j(t)$。因此，将 $h_i$ 表示为 $h_i = I_0 - w \\, y_j$，其中 $w > 0$ 是一个无量纲的抑制性耦合强度。\n\n4. 对于静态输入输出非线性，使用一个在 $r_{\\max}$ 处饱和的S型放电率函数：\n   $$F(h) = \\frac{r_{\\max}}{1 + \\exp\\!\\left(-a \\, (h - \\theta)\\right)},$$\n   其中 $a > 0$ 是斜率参数（无量纲），$\\theta$ 是阈值（无量纲）。\n\n5. 模拟与测量：\n   - 使用固定的时间步长 $\\Delta t$ 和前向欧拉法对模型进行数值积分，总时长为 $T_{\\mathrm{sim}}$（单位均为 $\\mathrm{s}$）。使用能最小程度打破对称性的初始条件（例如，略有不同的初始放电率）。\n   - 定义活动差异 $\\Delta(t) = r_1(t) - r_2(t)$。当 $\\Delta(t)$ 从负到正穿过（上穿）时，单元1的爆发开始；当它从正到负穿过（下穿）时，爆发结束。根据对称性，同样的情况也适用于角色互换后的单元2。\n   - 单元1的爆发间期（IBI）定义为 $\\Delta(t)$ 连续两次上穿之间的时间。在丢弃初始瞬态后，报告最后几个周期的平均IBI。IBI必须以 $\\mathrm{s}$ 为单位，并报告为四舍五入到三位小数的浮点数。\n   - 爆发终止是由活动突触的抑制驱动的。在 $\\Delta(t)$ 的每个交叉点，记录在符号改变前瞬间当前活动的神经元 $k$ 的 $x_k(t^-)$ 值，其中 $t^-$ 表示交叉前一瞬间的时间。在用于IBI计算的相同周期内，对这些记录值取平均，并报告终止时的平均 $x$ 值，四舍五入到三位小数（无量纲）。\n   - 如果系统没有表现出交替爆发（例如，在瞬态后 $\\Delta(t)$ 的上穿次数少于两次），则将IBI和终止时的平均 $x$ 值都报告为 $0.0$。\n\n6. 除非在测试用例中另有说明，否则使用以下固定参数：\n   - $r_{\\max} = 100 \\ \\mathrm{s}^{-1}$, $a = 4.0$, $\\theta = 1.0$, $I_0 = 1.3$, $w = 3.0$。\n   - $\\tau_r = 0.02 \\ \\mathrm{s}$, $\\Delta t = 0.001 \\ \\mathrm{s}$, $T_{\\mathrm{sim}} = 20.0 \\ \\mathrm{s}$。\n   - 初始条件: $r_1(0) = 2.0 \\ \\mathrm{s}^{-1}$, $r_2(0) = 1.0 \\ \\mathrm{s}^{-1}$, $x_1(0) = x_2(0) = 1.0$。\n\n7. 测试套件：\n   对于每个测试用例，按照规定改变 $(\\tau_{\\mathrm{rec}}, u)$，并使用上述固定参数。对每个用例进行模拟，并生成一对输出：以 $\\mathrm{s}$ 为单位的平均爆发间期和终止时的平均 $x$ 值（无量纲），两者都四舍五入到三位小数。测试用例如下：\n   - 用例A（理想路径）：$\\tau_{\\mathrm{rec}} = 0.5 \\ \\mathrm{s}$, $u = 0.5$。\n   - 用例B（慢恢复）：$\\tau_{\\mathrm{rec}} = 1.5 \\ \\mathrm{s}$, $u = 0.5$。\n   - 用例C（较弱、更快的动力学）：$\\tau_{\\mathrm{rec}} = 0.3 \\ \\mathrm{s}$, $u = 0.3$。\n   - 用例D（无抑制边缘情况）：$\\tau_{\\mathrm{rec}} = 0.5 \\ \\mathrm{s}$, $u = 0.0$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个有四个项目的列表，每个项目对应一个测试用例。每个项目本身是一个包含两个浮点数的列表，顺序为 [mean_IBI_in_seconds, mean_x_at_termination]。输出必须严格按照逗号分隔列表的形式打印，并用方括号括起来，例如：\n[[ibi_A,xterm_A],[ibi_B,xterm_B],[ibi_C,xterm_C],[ibi_D,xterm_D]]\n所有时间单位必须是 $\\mathrm{s}$，并使用标准四舍五入规则保留三位小数。如果某个用例未检测到交替爆发，则为该用例打印 [0.0,0.0]。", "solution": "该问题陈述是计算神经科学领域一个有效的练习。它在科学上基于已确立的神经元和突触动力学原理，定义了所有必要的方程和参数，因此是适定的，并且其表述是客观的。我们将首先推导完整的微分方程组，然后先验地描述数值模拟和分析方法，最后针对指定的测试用例执行模拟。\n\n**1. 模型方程的推导**\n\n该系统由两个相同的、相互抑制的神经元单元组成，由 $i \\in \\{1, 2\\}$ 索引，单元 $i$ 的突触前伙伴表示为 $j \\neq i$。系统状态由四个变量描述：放电率 $r_1(t)$ 和 $r_2(t)$，以及可用突触资源的分数 $x_1(t)$ 和 $x_2(t)$。\n\n**突触资源动力学：**\n神经元 $i$ 的可用突触资源分数 $x_i(t)$ 的动力学由两个相互竞争的过程控制：恢复和消耗。\n-   恢复：资源池向其最大归一化值 $1$ 补充。这被建模为一个时间常数为 $\\tau_{\\mathrm{rec}}$ 的一阶过程，贡献项为 $\\frac{1 - x_i(t)}{\\tau_{\\mathrm{rec}}}$。\n-   消耗：资源因突触前活动而被消耗。消耗速率与突触前放电率 $r_i(t)$、可用资源量 $x_i(t)$ 和利用因子 $u$ 成正比。这贡献了一个项 $-u \\, x_i(t) \\, r_i(t)$。\n\n综合这些，得到突触资源分数的微分方程：\n$$\n\\frac{dx_i}{dt} = \\frac{1 - x_i}{\\tau_{\\mathrm{rec}}} - u \\, x_i \\, r_i\n$$\n该方程对 $i=1$ 和 $i=2$ 均成立。\n\n**神经元放电率动力学：**\n每个神经元的放电率 $r_i(t)$ 向由其净输入 $h_i(t)$ 决定的值弛豫。这被建模为一个时间常数为 $\\tau_r$ 的一阶低通滤波器：\n$$\n\\tau_r \\frac{dr_i}{dt} = -r_i + F(h_i)\n$$\n其中 $F(h_i)$ 是静态输入输出函数。\n\n神经元 $i$ 的净输入 $h_i$ 是一个恒定外部驱动 $I_0$ 和来自神经元 $j$ 的突触抑制之和。问题规定，来自神经元 $j$ 的有效抑制性驱动（我们称之为 $I_{syn, j}$）与利用率 $u$、可用资源 $x_j$ 和突触前放电率 $r_j$ 的乘积成正比。因此，$I_{syn, j}(t) = u \\, x_j(t) \\, r_j(t)$。那么，到神经元 $i$ 的总输入为：\n$$\nh_i(t) = I_0 - w \\, I_{syn, j}(t) = I_0 - w \\, u \\, x_j(t) \\, r_j(t)\n$$\n其中 $w$ 是无量纲的突触耦合强度。\n\n静态输入-输出函数 $F(h)$ 由一个S型函数给出：\n$$\nF(h) = \\frac{r_{\\max}}{1 + \\exp(-a(h - \\theta))}\n$$\n其中 $r_{\\max}$ 是最大放电率，$a$ 是斜率，$\\theta$ 是阈值。\n\n**完整的常微分方程组 (ODEs)：**\n完整的模型是一个描述 $(r_1, r_2, x_1, x_2)$ 演化的四个耦合非线性常微分方程组：\n$$\n\\frac{dr_1}{dt} = \\frac{1}{\\tau_r} \\left( -r_1 + \\frac{r_{\\max}}{1 + \\exp(-a(I_0 - w \\, u \\, x_2 \\, r_2 - \\theta))} \\right)\n$$\n$$\n\\frac{dr_2}{dt} = \\frac{1}{\\tau_r} \\left( -r_2 + \\frac{r_{\\max}}{1 + \\exp(-a(I_0 - w \\, u \\, x_1 \\, r_1 - \\theta))} \\right)\n$$\n$$\n\\frac{dx_1}{dt} = \\frac{1 - x_1}{\\tau_{\\mathrm{rec}}} - u \\, x_1 \\, r_1\n$$\n$$\n\\frac{dx_2}{dt} = \\frac{1 - x_2}{\\tau_{\\mathrm{rec}}} - u \\, x_2 \\, r_2\n$$\n\n**2. 数值模拟与分析**\n\n我们将使用固定时间步长 $\\Delta t$ 的前向欧拉法对该系统进行积分。对于一个具有动力学 $\\frac{dy}{dt} = f(y, t)$ 的通用状态变量 $y(t)$，其更新规则为：\n$$\ny(t + \\Delta t) = y(t) + \\Delta t \\cdot f(y(t), t)\n$$\n此规则在每个时间步应用于所有四个状态变量。为确保满足物理约束，在每个更新步之后，放电率 $r_i$ 将被裁剪在不小于 $0$ 的值（即 $r_i = \\max(0, r_i)$），资源分数 $x_i$ 将被裁剪到区间 $[0, 1]$ 内。\n\n模拟运行总时长为 $T_{\\mathrm{sim}}$。设置初始条件以打破对称性并启动振荡：$r_1(0) = 2.0 \\ \\mathrm{s}^{-1}$，$r_2(0) = 1.0 \\ \\mathrm{s}^{-1}$，以及 $x_1(0) = x_2(0) = 1.0$。\n\n模拟结束后，我们分析生成的时间序列以计算所需的指标。覆盖模拟前半部分（$t \\in [0, T_{\\mathrm{sim}}/2]$）的初始瞬态期将被丢弃，以确保测量取自稳态振荡行为。\n\n-   **活动差异：**我们计算 $\\Delta(t) = r_1(t) - r_2(t)$。\n-   **事件检测：**我们识别出 $\\Delta(t)$ 穿过零点的所有时间点。如果在时间步 $t_k = k \\Delta t$ 和 $t_{k+1}$ 之间满足 $\\Delta(t_k) \\cdot \\Delta(t_{k+1}) < 0$，则发生了一次穿越。\n    -   如果 $\\Delta(t_k) < 0$ 且 $\\Delta(t_{k+1}) \\geq 0$，则发生一次**上穿**（单元1爆发的开始）。\n    -   如果 $\\Delta(t_k) > 0$ 且 $\\Delta(t_{k+1}) \\leq 0$，则发生一次**下穿**（单元1爆发的结束）。\n-   **爆发间期（IBI）：**我们找到瞬态期后发生的所有上穿时间 $t_{up}$。IBI是连续上穿之间的时间差。计算这些IBI的平均值。如果在分析窗口中找到的上穿次数少于两次，则无法计算IBI，平均IBI报告为 $0.0$。\n-   **终止时的突触资源（$x_{\\mathrm{term}}$）：**在瞬态期后的每个零点穿越时间 $t_k$，我们记录刚刚处于活动状态的神经元的资源水平。使用 $t_k^- \\approx t_k$ 时的值。\n    -   如果 $\\Delta(t_k) > 0$（下穿），则单元1处于活动状态。我们记录 $x_1(t_k)$。\n    -   如果 $\\Delta(t_k) < 0$（上穿），则单元2处于活动状态。我们记录 $x_2(t_k)$。\n    计算这些记录的资源值的平均值。如果分析窗口内没有发生穿越，则平均值报告为 $0.0$。\n\n$u=0$ 的特殊情况（用例D）对应于非耦合神经元。在这种情况下，抑制项 $w \\, u \\, x_j \\, r_j$ 为零，两个神经元将独立地收敛到由 $r^* = F(I_0)$ 给出的稳定稳态。不会发生振荡，因此 $\\Delta(t)$ 不会穿过零点。这正确地得到IBI和 $x_{\\mathrm{term}}$ 均为 $0.0$。\n\n对每个测试用例实施所述流程，以生成最终结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print results.\n    \"\"\"\n\n    # Fixed parameters as specified in the problem statement.\n    r_max = 100.0  # s^-1\n    a = 4.0      # dimensionless\n    theta = 1.0  # dimensionless\n    I_0 = 1.3    # dimensionless\n    w = 3.0      # dimensionless\n    tau_r = 0.02   # s\n    dt = 0.001   # s\n    T_sim = 20.0   # s\n\n    # Initial conditions.\n    r1_0 = 2.0  # s^-1\n    r2_0 = 1.0  # s^-1\n    x1_0 = 1.0  # dimensionless\n    x2_0 = 1.0  # dimensionless\n\n    # Test cases: (tau_rec, u)\n    test_cases = [\n        (0.5, 0.5),  # Case A\n        (1.5, 0.5),  # Case B\n        (0.3, 0.3),  # Case C\n        (0.5, 0.0),  # Case D\n    ]\n\n    all_results = []\n\n    for tau_rec, u in test_cases:\n        # Number of time steps\n        num_steps = int(T_sim / dt)\n        \n        # State variable arrays\n        r1 = np.zeros(num_steps)\n        r2 = np.zeros(num_steps)\n        x1 = np.zeros(num_steps)\n        x2 = np.zeros(num_steps)\n        t = np.linspace(0, T_sim, num_steps)\n\n        # Set initial conditions\n        r1[0] = r1_0\n        r2[0] = r2_0\n        x1[0] = x1_0\n        x2[0] = x2_0\n\n        # Static sigmoidal nonlinearity F(h)\n        def F(h):\n            return r_max / (1.0 + np.exp(-a * (h - theta)))\n\n        # Forward Euler integration loop\n        for k in range(num_steps - 1):\n            # Calculate inputs to each neuron\n            h1 = I_0 - w * u * x2[k] * r2[k]\n            h2 = I_0 - w * u * x1[k] * r1[k]\n\n            # Calculate derivatives\n            dr1_dt = (-r1[k] + F(h1)) / tau_r\n            dr2_dt = (-r2[k] + F(h2)) / tau_r\n            dx1_dt = (1.0 - x1[k]) / tau_rec - u * x1[k] * r1[k]\n            dx2_dt = (1.0 - x2[k]) / tau_rec - u * x2[k] * r2[k]\n\n            # Update state variables\n            r1[k+1] = r1[k] + dt * dr1_dt\n            r2[k+1] = r2[k] + dt * dr2_dt\n            x1[k+1] = x1[k] + dt * dx1_dt\n            x2[k+1] = x2[k] + dt * dx2_dt\n\n            # Apply physical constraints (clipping)\n            r1[k+1] = max(0.0, r1[k+1])\n            r2[k+1] = max(0.0, r2[k+1])\n            x1[k+1] = np.clip(x1[k+1], 0.0, 1.0)\n            x2[k+1] = np.clip(x2[k+1], 0.0, 1.0)\n\n        # Analysis of results\n        delta = r1 - r2\n        \n        # Find all zero-crossings\n        # np.diff(np.sign(delta)) is non-zero at crossings\n        crossings_indices = np.where(np.diff(np.sign(delta)))[0]\n\n        # Define transient discard time\n        analysis_start_time = T_sim / 2.0\n        \n        # Find up-crossings (delta changes from - to +)\n        # This means delta[k] < 0 and delta[k+1] > 0\n        up_crossing_indices = crossings_indices[delta[crossings_indices] < 0]\n        up_crossing_times = t[up_crossing_indices]\n\n        # Filter events after transient period\n        valid_up_crossing_times = up_crossing_times[up_crossing_times > analysis_start_time]\n\n        # Calculate mean IBI\n        if len(valid_up_crossing_times) >= 2:\n            ibis = np.diff(valid_up_crossing_times)\n            mean_ibi = np.mean(ibis)\n        else:\n            mean_ibi = 0.0\n\n        # Calculate mean x at termination\n        term_x_values = []\n        valid_crossings_indices = crossings_indices[t[crossings_indices] > analysis_start_time]\n\n        for idx in valid_crossings_indices:\n            # If delta[idx] > 0, it means the crossing is from + to -, so neuron 1 was active\n            if delta[idx] > 0:\n                term_x_values.append(x1[idx])\n            # If delta[idx] < 0, it means the crossing is from - to +, so neuron 2 was active\n            else:\n                term_x_values.append(x2[idx])\n\n        if term_x_values:\n            mean_x_term = np.mean(term_x_values)\n        else:\n            mean_x_term = 0.0\n\n        #\n        # A special check for the case of no oscillations at all\n        # If fewer than 2 total up-crossings, it is non-oscillatory.\n        if len(up_crossing_times) < 2:\n            mean_ibi = 0.0\n            mean_x_term = 0.0\n\n        all_results.append([round(mean_ibi, 3), round(mean_x_term, 3)])\n\n    # Format final output as a list of lists\n    output_str = \"[\" + \",\".join([f\"[{ibi},{x}]\" for ibi, x in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2557001"}, {"introduction": "构建了振荡网络之后，下一个关键问题是如何表征和预测其在面对外部扰动时的行为，这对于理解动物如何在多变的环境中调整其运动至关重要。本练习向你介绍一个强大的理论工具——无穷小相位响应曲线 (infinitesimal Phase Response Curve, iPRC)，它描述了振荡器在周期的不同相位 $\\phi$ 上对微小扰动的敏感性 [@problem_id:2556927]。通过辨析其精确定义和实验测量方法，你将掌握从系统层面分析CPG动力学和稳定性的核心概念，为理解神经振荡器的同步、协调与控制奠定理论基础。", "problem": "一个离体标本中的脊髓运动中枢模式发生器 (CPG) 会产生一个稳定的节律性输出，该输出可被建模为一个具有稳定极限环的光滑自治动力学系统。设系统状态为 $x \\in \\mathbb{R}^n$，内禀动力学为 $\\dot{x} = f(x)$，该系统有一个稳定的 $T$-周期极限环 $x_0(t)$，其角频率为 $\\omega = 2\\pi/T$。假设通过一个微电极向一个选定的神经元施加一个短暂的细胞外或细胞内电流脉冲，并且该扰动沿着一个固定的输入方向（由电极位置和膜耦合决定）投影到状态空间中。您希望表征该 CPG 的无穷小相位响应曲线 $Z(\\phi)$，其中 $\\phi \\in [0,2\\pi)$ 表示未受扰动的极限环上的相位。\n\n哪个选项最好地定义了运动 CPG 的无穷小相位响应曲线 $Z(\\phi)$，并概述了一种科学上合理的方法，即使用在已知相位施加的微小、短暂的电流脉冲来实验性地估计 $Z(\\phi)$？\n\nA. 无穷小相位响应曲线 $Z(\\phi)$ 是振荡幅度随相位变化的单位注入电流变化量。为了估计 $Z(\\phi)$，施加足够长的强方波脉冲以完全重置节律，然后测量下一个周期的峰峰值幅度变化，并除以脉冲幅度以获得 $Z(\\phi)$。\n\nB. 无穷小相位响应曲线 $Z(\\phi)$ 是在极限环上求值的渐近相位函数的梯度，它给出了从一个微小的瞬时状态扰动到即时相位偏移的线性映射。为了针对给定的刺激位点估计 $Z(\\phi)$，在已知相位 $\\phi$（覆盖 $[0,2\\pi)$）施加面积已知的非常短暂、微小的电流脉冲。对于每次试验，使用 $\\Delta \\phi \\approx -\\omega\\,\\Delta t$ 从观察到的后续参考事件（例如，下一次簇发放的起始）时间变化中计算相位偏移 $\\Delta \\phi$，其中 $\\Delta t$ 是观察到的事件时间与未受扰动周期上预期事件时间之间的差异，然后通过脉冲面积进行归一化，以估计沿输入方向的 $Z(\\phi)$ 的投影。在多个小幅度下重复以验证线性，并使用脉冲幅度趋于零时的斜率。\n\nC. 无穷小相位响应曲线 $Z(\\phi)$ 是在大的周期性正弦驱动下获得的有限相位重置曲线。为了估计它，施加一个频率与固有频率略有不同的正弦电流，测量稳态频率偏移，并将频率失谐与驱动幅度的比率作为 $Z(\\phi)$。\n\nD. 无穷小相位响应曲线 $Z(\\phi)$ 是振荡周期关于恒定（强直）偏置电流的导数。为了估计它，注入一系列稳态直流电，测量周期 $T(I)$，计算 $dT/dI$，并通过 $2\\pi$ 归一化以获得 $Z(\\phi)$，该值不随相位变化。\n\nE. 无穷小相位响应曲线 $Z(\\phi)$ 是到下一个周期的时间偏移的单位脉冲持续时间变化量。为了估计它，在已知相位施加跨越周期一大部分的长脉冲，将 $\\Delta \\phi$ 计算为 $\\Delta t/T$（不带符号），并在不按脉冲面积归一化或验证小扰动极限的情况下对周期进行平均。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知信息**\n- 系统：一个离体标本中的脊髓运动中枢模式发生器 (CPG)。\n- 模型：一个具有稳定极限环的光滑自治动力学系统。\n- 状态变量：$x \\in \\mathbb{R}^n$。\n- 动力学：$\\dot{x} = f(x)$。\n- 极限环：一个稳定的 $T$-周期解，$x_0(t)$。\n- 角频率：$\\omega = 2\\pi/T$。\n- 扰动：一个短暂的细胞外或细胞内电流脉冲。\n- 扰动投影：扰动沿状态空间中的一个固定输入方向作用。\n- 待表征的量：无穷小相位响应曲线 (PRC)，$Z(\\phi)$。\n- 相位变量：$\\phi \\in [0,2\\pi)$ 表示未受扰动极限环上的相位。\n- 问题要求给出 $Z(\\phi)$ 的最佳定义以及其科学合理的实验估计方法。\n\n**步骤 2：使用提取的已知信息进行验证**\n该问题提法恰当且具有科学依据。它利用了动力学系统理论中分析振荡神经网络的标准理论框架。中枢模式发生器、其作为具有稳定极限环的动力学系统的表示、周期上的相位概念，以及通过相位响应曲线表征其对小扰动的响应等概念，在计算神经科学和神经生理学中都是经典的。\n\n- **科学依据**：该问题坚实地基于非线性动力学及其在生物振荡器中应用的既定原理。无穷小 PRC，也称为伴随 PRC，是一个基本的理论对象，它源于在极限环周围线性化的系统动力学特性。\n- **提法恰当性**：该问题要求定义一个明确定义的数学和实验量 $Z(\\phi)$ 并给出其测量方案。在既定理论中存在一个唯一的正确答案。\n- **客观性**：所用术语在该领域内是精确和标准的（例如，“光滑自治动力学系统”、“稳定极限环”、“无穷小相位响应曲线”）。没有歧义或主观语言。\n- **完整性**：所提供的信息足以理解背景并评估所提出的定义和方法的正确性。\n\n**步骤 3：结论与行动**\n问题陈述是**有效的**。解题过程将从第一性原理出发来定义无穷小 PRC，然后评估每个选项。\n\n**从第一性原理推导**\n对于一个具有稳定极限环 $x_0(t)$ 的系统 $\\dot{x} = f(x)$，可以建立渐近相位的概念。在极限环的吸引盆中，每个点 $x$ 都可以被赋予一个渐近相位 $\\Phi(x)$，使得从 $x$ 开始的轨迹最终会收敛到极限环轨迹 $x_0(t + \\tau)$，其相位移动了一个常数 $\\tau$。该相位函数的水平集 $\\Phi(x) = \\text{const}$ 被称为等时线。根据定义，相位随时间线性演化：$\\dot{\\phi} = \\omega$。\n\n在极限环 $x_0(t_p)$ 上的时间 $t_p$ 施加一个短暂的扰动，将状态移动到一个新点 $x' = x_0(t_p) + \\delta x$，其中 $\\delta x$ 是一个表示电流脉冲效应的小向量。新状态 $x'$ 位于与 $x_0(t_p)$ 不同的等时线上。渐近相位的变化 $\\Delta\\phi$ 由一阶近似给出：\n$$ \\Delta\\phi = \\Phi(x_0(t_p) + \\delta x) - \\Phi(x_0(t_p)) \\approx \\nabla_x \\Phi(x_0(t_p)) \\cdot \\delta x $$\n向量 $Z(\\phi) = \\nabla_x \\Phi(x_0(\\phi/\\omega))$ 是无穷小相位响应曲线 (iPRC)。它是在极限环上定义的向量场，给出了渐近相位对状态扰动的线性敏感度。\n\n问题陈述扰动沿着一个固定方向 $v$ 投影。扰动向量为 $\\delta x = a \\cdot v$，其中 $a$ 是扰动的大小（例如，电流脉冲的面积，代表传递的总电荷）。测得的相位偏移则是刺激相位 $\\phi$ 的标量函数：\n$$ \\Delta\\phi(\\phi) \\approx (Z(\\phi) \\cdot v) a $$\n实验中测量的量，通常也滥用符号记为 $Z(\\phi)$，就是这个投影：$Z(\\phi)_{\\text{exp}} = Z(\\phi) \\cdot v$。它被形式化定义为：\n$$ Z(\\phi) = \\lim_{a \\to 0} \\frac{\\Delta\\phi(\\phi, a)}{a} $$\n在实验中，人们测量后续标记事件（例如，神经簇发放的起始）发生时间相对于其在未受扰动节律中的预期时间的时间偏移 $\\Delta T$。相位提前对应于事件提前发生（$\\Delta T < 0$），相位延迟对应于事件推后发生（$\\Delta T > 0$）。相位偏移 $\\Delta\\phi$ 通过从时间到相位的转换与时间偏移 $\\Delta T$ 相关：$\\Delta\\phi = - \\frac{2\\pi}{T} \\Delta T = -\\omega \\Delta T$。负号是一个标准约定：时间上的提前（$\\Delta T < 0$）对应于一个正的相位偏移。\n\n因此，实验方案必须包括：\n1.  在已知相位 $\\phi$ 施加一个已知大小 $a$ 的微小、短暂的扰动。\n2.  测量所产生的时间偏移 $\\Delta T$。\n3.  计算相位偏移 $\\Delta\\phi = -\\omega \\Delta T$。\n4.  将 PRC 估计为比率 $\\Delta\\phi/a$。\n5.  在所有相位 $\\phi \\in [0, 2\\pi)$ 上重复，并使用多个小的 $a$ 值来验证线性。\n\n**各选项分析**\n\n**A. 无穷小相位响应曲线 $Z(\\phi)$ 是振荡幅度随相位变化的单位注入电流变化量。为了估计 $Z(\\phi)$，施加足够长的强方波脉冲以完全重置节律，然后测量下一个周期的峰峰值幅度变化，并除以脉冲幅度以获得 $Z(\\phi)$。**\n此选项存在根本性错误。PRC，顾名思义并根据其定义，关注的是**相位**，而不是**幅度**。虽然扰动也会影响幅度（由幅度响应曲线描述），但这并非 $Z(\\phi)$ 所代表的。此外，该方法建议使用“强”脉冲来“完全重置节律”，这与“无穷小”扰动是背道而驰的。这个过程测量的是一个有限的、大扰动的重置，而不是 iPRC。\n**结论：不正确。**\n\n**B. 无穷小相位响应曲线 $Z(\\phi)$ 是在极限环上求值的渐近相位函数的梯度，它给出了从一个微小的瞬时状态扰动到即时相位偏移的线性映射。为了针对给定的刺激位点估计 $Z(\\phi)$，在已知相位 $\\phi$（覆盖 $[0,2\\pi)$）施加面积已知的非常短暂、微小的电流脉冲。对于每次试验，使用 $\\Delta \\phi \\approx -\\omega\\,\\Delta t$ 从观察到的后续参考事件（例如，下一次簇发放的起始）时间变化中计算相位偏移 $\\Delta \\phi$，其中 $\\Delta t$ 是观察到的事件时间与未受扰动周期上预期事件时间之间的差异，然后通过脉冲面积进行归一化，以估计沿输入方向的 $Z(\\phi)$ 的投影。在多个小幅度下重复以验证线性，并使用脉冲幅度趋于零时的斜率。**\n此选项给出了一个正确的理论定义和一个科学严谨的实验方案。将 $Z(\\phi)$ 定义为渐近相位函数（$\\nabla_x \\Phi$）的梯度是精确的。实验方法正确地规定了使用“非常短暂、微小”的脉冲，强调了无穷小极限。它正确地将脉冲**面积**（总电荷）确定为强度的相关度量。使用 $\\Delta\\phi \\approx -\\omega \\Delta t$ 从测量的时间偏移 $\\Delta t$ 转换为相位偏移 $\\Delta\\phi$ 是标准约定。最后，正确地包含了验证线性并取扰动幅度趋于零的极限这一关键步骤，以确保测量对应于*无穷小* PRC。\n**结论：正确。**\n\n**C. 无穷小相位响应曲线 $Z(\\phi)$ 是在大的周期性正弦驱动下获得的有限相位重置曲线。为了估计它，施加一个频率与固有频率略有不同的正弦电流，测量稳态频率偏移，并将频率失谐与驱动幅度的比率作为 $Z(\\phi)$。**\n此选项混淆了两个不同的概念。iPRC 描述的是对短暂、脉冲式扰动的响应。对周期性驱动，特别是正弦驱动的响应，与同步和阿诺德舌（Arnold tongues）的研究有关。虽然 iPRC 可用于*预测*对弱周期性驱动的响应，但它并*不是*由它定义的。所提出的方法测量的是与拖拽（entrainment）相关的属性，而不是问题上下文中脉冲式刺激所定义的 iPRC。驱动被描述为“大的”和“周期性的”，这两者都与问题的“无穷小”和“短暂脉冲”背景相矛盾。\n**结论：不正确。**\n\n**D. 无穷小相位响应曲线 $Z(\\phi)$ 是振荡周期关于恒定（强直）偏置电流的导数。为了估计它，注入一系列稳态直流电，测量周期 $T(I)$，计算 $dT/dI$，并通过 $2\\pi$ 归一化以获得 $Z(\\phi)$，该值不随相位变化。**\n此选项不正确。它描述的是对强直（恒定）输入的频率响应，而不是对脉冲式输入的相位依赖响应。导数 $dT/dI$（或更直接地，$d\\omega/dI$）与 iPRC 在一个周期内的*平均值*（直流分量）有关，根据公式 $\\frac{d\\omega}{dI} = \\frac{1}{T} \\int_0^T Z_I(t) dt$ 可知，其中 $Z_I$ 是对电流扰动的 iPRC。iPRC 本身 $Z(\\phi)$ 是相位的函数，通常不是恒定的。声称 $Z(\\phi)$ *就是*这个常数导数是一种严重的过度简化，而且在事实上是错误的。\n**结论：不正确。**\n\n**E. 无穷小相位响应曲线 $Z(\\phi)$ 是到下一个周期的时间偏移的单位脉冲持续时间变化量。为了估计它，在已知相位施加跨越周期一大部分的长脉冲，将 $\\Delta \\phi$ 计算为 $\\Delta t/T$（不带符号），并在不按脉冲面积归一化或验证小扰动极限的情况下对周期进行平均。**\n此选项包含多个严重错误。首先，对于短暂脉冲，扰动强度是其面积（电荷），而不是其持续时间。其次，该方法明确要求使用“长”脉冲，这违反了“短暂”或“脉冲式”的假设。第三，它提出了一个不正确的相位偏移公式 $\\Delta t/T$，并且关键地忽略了符号，而符号对于区分相位提前和延迟至关重要。第四，它没有按扰动强度进行归一化，也没有验证线性，而这些正是*无穷小* PRC 测量的定义性特征。\n**结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "2556927"}]}