{"hands_on_practices": [{"introduction": "准确测量细胞内游离钙离子浓度 ($[\\mathrm{Ca}^{2+}]$) 是理解兴奋-收缩偶联过程的基础。荧光指示剂（如 Fura-2）是实现这一目标的核心工具，但从原始荧光信号到最终浓度值的转换依赖于严谨的校准和数据分析。本练习将指导你应用标准的 Grynkiewicz 方程和误差传播理论，从一个假设的 Fura-2 实验数据中计算出钙离子浓度及其不确定性，这对于任何实验科学家来说都是一项评估数据可信度的关键技能。[@problem_id:2567129]", "problem": "一个在$37\\,^{\\circ}\\mathrm{C}$下的分离心室肌细胞加载了比率型钙指示剂 Fura-2，用于监测兴奋-收缩偶联过程中的胞浆游离钙离子($\\mathrm{Ca}^{2+}$)动态。在与实验相同的条件下，原位校准得到了以下参数（每个参数均带有$1$个标准差(SD)的不确定度）：最小比率$R_{\\min} = 0.35 \\pm 0.02$，最大比率$R_{\\max} = 8.80 \\pm 0.10$，荧光标度因子$\\gamma = S_{f2}/S_{b2} = 12.0 \\pm 0.6$，以及解离常数$K_{d} = 224\\,\\mathrm{nM} \\pm 10\\,\\mathrm{nM}$。在一个稳态起搏方案中，测得的 Fura-2 荧光比率为$R = 1.50$，其标准差 $\\sigma_{R} = 0.03$。\n\n人们普遍认为，像 Fura-2 这样的比率型染料遵循一个连接$R$和$[\\mathrm{Ca}^{2+}]$的校准关系，该关系源于平衡结合和质量作用定律。使用这一经过充分检验的关系，并结合用于独立不确定度的一阶（线性）误差传播方法，确定推断出的胞浆游离钙浓度$[\\mathrm{Ca}^{2+}]$的传播标准不确定度 (SD)。\n\n最终答案仅报告$[\\mathrm{Ca}^{2+}]$的传播标准差。最终答案以$\\mathrm{nM}$为单位，并四舍五入至三位有效数字。", "solution": "问题陈述经验证是良定的、有科学依据的，并包含得出唯一解所需的所有必要信息。任务是根据测量的参数及其相关的不确定度，计算胞浆游离钙浓度$[\\mathrm{Ca}^{2+}]$的传播标准不确定度。\n\n测得的荧光比率$R$与钙浓度（我们记为$C \\equiv [\\mathrm{Ca}^{2+}]$）之间的关系由 Grynkiewicz 方程给出：\n$$ C(K_d, \\gamma, R, R_{\\min}, R_{\\max}) = K_d \\gamma \\left( \\frac{R - R_{\\min}}{R_{\\max} - R} \\right) $$\n问题要求对独立不确定度使用一阶误差传播。因此，$C$的方差（记为$\\sigma_C^2$）近似为关于每个变量的偏导数平方与该变量方差的乘积之和：\n$$ \\sigma_C^2 \\approx \\left(\\frac{\\partial C}{\\partial K_d}\\right)^2 \\sigma_{K_d}^2 + \\left(\\frac{\\partial C}{\\partial \\gamma}\\right)^2 \\sigma_{\\gamma}^2 + \\left(\\frac{\\partial C}{\\partial R}\\right)^2 \\sigma_R^2 + \\left(\\frac{\\partial C}{\\partial R_{\\min}}\\right)^2 \\sigma_{R_{\\min}}^2 + \\left(\\frac{\\partial C}{\\partial R_{\\max}}\\right)^2 \\sigma_{R_{\\max}}^2 $$\n这里，$\\sigma_x$表示变量$x$的标准差 (SD)。\n\n首先，我们计算$C$相对于五个变量$K_d$、$\\gamma$、$R$、$R_{\\min}$和$R_{\\max}$中每一个的偏导数。\n\n1.  关于$K_d$的偏导数：\n    $$ \\frac{\\partial C}{\\partial K_d} = \\gamma \\left( \\frac{R - R_{\\min}}{R_{\\max} - R} \\right) = \\frac{C}{K_d} $$\n\n2.  关于$\\gamma$的偏导数：\n    $$ \\frac{\\partial C}{\\partial \\gamma} = K_d \\left( \\frac{R - R_{\\min}}{R_{\\max} - R} \\right) = \\frac{C}{\\gamma} $$\n\n3.  关于$R$的偏导数：\n    $$ \\frac{\\partial C}{\\partial R} = K_d \\gamma \\frac{\\partial}{\\partial R}\\left( \\frac{R - R_{\\min}}{R_{\\max} - R} \\right) = K_d \\gamma \\left( \\frac{(1)(R_{\\max} - R) - (R - R_{\\min})(-1)}{(R_{\\max} - R)^2} \\right) = K_d \\gamma \\left( \\frac{R_{\\max} - R_{\\min}}{(R_{\\max} - R)^2} \\right) $$\n\n4.  关于$R_{\\min}$的偏导数：\n    $$ \\frac{\\partial C}{\\partial R_{\\min}} = K_d \\gamma \\frac{\\partial}{\\partial R_{\\min}}\\left( \\frac{R - R_{\\min}}{R_{\\max} - R} \\right) = K_d \\gamma \\left( \\frac{-1}{R_{\\max} - R} \\right) = -K_d \\gamma \\frac{1}{R_{\\max} - R} $$\n\n5.  关于$R_{\\max}$的偏导数：\n    $$ \\frac{\\partial C}{\\partial R_{\\max}} = K_d \\gamma (R - R_{\\min}) \\frac{\\partial}{\\partial R_{\\max}}\\left( (R_{\\max} - R)^{-1} \\right) = K_d \\gamma (R - R_{\\min}) (-1)(R_{\\max} - R)^{-2} = -K_d \\gamma \\frac{R - R_{\\min}}{(R_{\\max} - R)^2} $$\n\n接下来，我们使用给定的平均值来计算这些表达式：\n$K_d = 224\\,\\mathrm{nM}$，$\\sigma_{K_d} = 10\\,\\mathrm{nM}$\n$\\gamma = 12.0$，$\\sigma_{\\gamma} = 0.6$\n$R = 1.50$，$\\sigma_R = 0.03$\n$R_{\\min} = 0.35$，$\\sigma_{R_{\\min}} = 0.02$\n$R_{\\max} = 8.80$，$\\sigma_{R_{\\max}} = 0.10$\n\n首先，计算钙浓度的中心值$C_0$：\n$$ C_0 = (224) \\cdot (12.0) \\cdot \\left( \\frac{1.50 - 0.35}{8.80 - 1.50} \\right) = 2688 \\cdot \\left( \\frac{1.15}{7.30} \\right) \\approx 423.548\\,\\mathrm{nM} $$\n\n现在，在这些平均值处计算偏导数：\n$$ \\frac{\\partial C}{\\partial K_d} = \\frac{C_0}{K_d} = \\frac{423.548}{224} \\approx 1.8908 $$\n$$ \\frac{\\partial C}{\\partial \\gamma} = \\frac{C_0}{\\gamma} = \\frac{423.548}{12.0} \\approx 35.296 $$\n$$ \\frac{\\partial C}{\\partial R} = (224)(12.0) \\left( \\frac{8.80 - 0.35}{(8.80 - 1.50)^2} \\right) = 2688 \\left( \\frac{8.45}{(7.30)^2} \\right) \\approx 426.253 $$\n$$ \\frac{\\partial C}{\\partial R_{\\min}} = -(224)(12.0) \\frac{1}{8.80 - 1.50} = -\\frac{2688}{7.30} \\approx -368.219 $$\n$$ \\frac{\\partial C}{\\partial R_{\\max}} = -(224)(12.0) \\frac{1.50 - 0.35}{(8.80 - 1.50)^2} = -2688 \\frac{1.15}{(7.30)^2} \\approx -58.020 $$\n\n现在我们可以计算构成总方差$\\sigma_C^2$的每一项：\n$$ \\left(\\frac{\\partial C}{\\partial K_d}\\right)^2 \\sigma_{K_d}^2 \\approx (1.8908)^2 (10)^2 \\approx 357.53\\,\\mathrm{nM}^2 $$\n$$ \\left(\\frac{\\partial C}{\\partial \\gamma}\\right)^2 \\sigma_{\\gamma}^2 \\approx (35.296)^2 (0.6)^2 \\approx 448.49\\,\\mathrm{nM}^2 $$\n$$ \\left(\\frac{\\partial C}{\\partial R}\\right)^2 \\sigma_R^2 \\approx (426.253)^2 (0.03)^2 \\approx 163.52\\,\\mathrm{nM}^2 $$\n$$ \\left(\\frac{\\partial C}{\\partial R_{\\min}}\\right)^2 \\sigma_{R_{\\min}}^2 \\approx (-368.219)^2 (0.02)^2 \\approx 54.23\\,\\mathrm{nM}^2 $$\n$$ \\left(\\frac{\\partial C}{\\partial R_{\\max}}\\right)^2 \\sigma_{R_{\\max}}^2 \\approx (-58.020)^2 (0.10)^2 \\approx 33.66\\,\\mathrm{nM}^2 $$\n\n将这些独立的方差分量相加，得到总方差：\n$$ \\sigma_C^2 \\approx 357.53 + 448.49 + 163.52 + 54.23 + 33.66 = 1057.43\\,\\mathrm{nM}^2 $$\n\n传播的标准不确定度 (SD) 是总方差的平方根：\n$$ \\sigma_C = \\sqrt{\\sigma_C^2} \\approx \\sqrt{1057.43} \\approx 32.518\\,\\mathrm{nM} $$\n\n按要求将最终答案四舍五入到三位有效数字，得到$32.5\\,\\mathrm{nM}$。", "answer": "$$\\boxed{32.5}$$", "id": "2567129"}, {"introduction": "生理功能的宏观表现植根于蛋白质的分子特性。本练习旨在建立分子尺度（蛋白质亲和力）与细胞尺度（肌肉收缩力）之间的桥梁，探讨肌钙蛋白 C (Troponin C) 的一个假设突变如何改变其对钙离子的结合亲和力，并最终影响心肌细胞的力-pCa关系。通过从第一性原理出发推导钙离子敏感性的变化，你将能更深刻地理解肌丝的调节机制，以及心肌病等疾病的生物物理基础。[@problem_id:2567167]", "problem": "使用一种去肌膜人心室心肌细胞制备物来测量稳态等长力与游离胞质钙离子浓度的函数关系，其中自变量记为 $p\\mathrm{Ca} \\equiv -\\log_{10}([\\mathrm{Ca}^{2+}])$。力-$p\\mathrm{Ca}$关系呈S形，其曲线中点和陡峭度由两个经验参数概括：半最大力有效浓度（EC50）和希尔系数。此处，EC50 定义为稳态力达到其最大值一半时的游离钙离子浓度，而希尔系数是中点处的有效斜率因子。\n\n考虑调节性钙离子与细肌丝上的Troponin C (TnC) 结合。使用以下基本假设：\n- 钙离子与调节位点的结合遵循质量作用定律，解离常数为 $K_{d}$，因此单个结合位点的占据率为 $\\theta = \\frac{[\\mathrm{Ca}^{2+}]}{[\\mathrm{Ca}^{2+}] + K_{d}}$。\n- 宏观稳态力是调节性占据率 $\\theta$ 的一个单调递增饱和函数，其陡峭度由细肌丝上的协同耦合所控制，在野生型中该耦合的特征是有效希尔系数 $n_{0}$。下文所考虑的突变不改变此协同耦合结构（即，不改变 $n_{0}$）。\n- 假设半最大力对应于调节位点的半数占据，因此 EC50 由产生 $\\theta = \\frac{1}{2}$ 的钙离子浓度确定。\n\nTnC 中的一个点突变使其调节位点对钙离子的亲和力减半，但并不影响细肌丝的协同性。在操作层面，这意味着解离常数从 $K_{d}^{\\mathrm{WT}}$ 加倍至 $K_{d}^{\\mathrm{mut}} = 2 K_{d}^{\\mathrm{WT}}$，而有效希尔系数仍由相同的协同网络控制。\n\n从上述基本假设出发，且不使用任何现成的目标公式，推导该突变如何改变稳态下的力-$p\\mathrm{Ca}$关系。具体确定：\n1) $p\\mathrm{Ca}$轴上中点的加性位移 $\\Delta p\\mathrm{Ca}_{50} \\equiv p\\mathrm{Ca}_{50}^{\\mathrm{mut}} - p\\mathrm{Ca}_{50}^{\\mathrm{WT}}$，以精确解析表达式表示（不进行四舍五入）。\n2) 突变体的希尔系数，用野生型值 $n_{0}$ 表示。\n\n将你的最终答案以行矩阵 $\\begin{pmatrix} \\Delta p\\mathrm{Ca}_{50} & n_{H}^{\\mathrm{mut}} \\end{pmatrix}$ 的形式给出，不带单位。无需四舍五入；请报告精确表达式。最终答案中不要包含任何其他量。", "solution": "该问题陈述已经过验证，被认为具有科学依据、提法恰当且客观。它提出了一个简化但标准的肌肉激活生物物理模型，不存在矛盾或事实性错误。因此，我们可以从指定的基本原理出发，对其解进行严格推导。\n\n该问题要求确定两个量：力-$p\\mathrm{Ca}$曲线中点的位移 $\\Delta p\\mathrm{Ca}_{50}$，以及突变蛋白的希尔系数 $n_{H}^{\\mathrm{mut}}$。\n\n首先，我们确定中点的位移 $\\Delta p\\mathrm{Ca}_{50}$。问题陈述指出，力曲线的中点（此时力为半最大值）对应于 Troponin C 上调节位点的占据率 $\\theta$ 等于 $\\frac{1}{2}$ 时的钙离子浓度。单个结合位点的占据率由质量作用定律给出：\n$$\n\\theta = \\frac{[\\mathrm{Ca}^{2+}]}{[\\mathrm{Ca}^{2+}] + K_{d}}\n$$\n其中 $[\\mathrm{Ca}^{2+}]$ 是游离钙离子浓度，$K_{d}$ 是解离常数。\n\n根据问题的假设，半最大激活时的钙离子浓度（记为 $\\mathrm{EC50}$）是 $\\theta = \\frac{1}{2}$ 时的浓度。我们将 $\\theta = \\frac{1}{2}$ 代入上式，并求解相应的浓度，我们将其记为 $[\\mathrm{Ca}^{2+}]_{50}$：\n$$\n\\frac{1}{2} = \\frac{[\\mathrm{Ca}^{2+}]_{50}}{[\\mathrm{Ca}^{2+}]_{50} + K_{d}}\n$$\n两边同乘以 $2 \\cdot ([\\mathrm{Ca}^{2+}]_{50} + K_{d})$ 得：\n$$\n[\\mathrm{Ca}^{2+}]_{50} + K_{d} = 2 \\cdot [\\mathrm{Ca}^{2+}]_{50}\n$$\n求解 $K_{d}$ 得到基本关系：\n$$\nK_{d} = [\\mathrm{Ca}^{2+}]_{50}\n$$\n这表明，在给定假设下，$\\mathrm{EC50}$ 在数值上等于解离常数。\n\n这种关系对野生型（WT）和突变型（mut）均成立：\n$$\n[\\mathrm{Ca}^{2+}]_{50}^{\\mathrm{WT}} = K_{d}^{\\mathrm{WT}}\n$$\n$$\n[\\mathrm{Ca}^{2+}]_{50}^{\\mathrm{mut}} = K_{d}^{\\mathrm{mut}}\n$$\n问题陈述指出，该突变使亲和力减半，这对应于解离常数的加倍：\n$$\nK_{d}^{\\mathrm{mut}} = 2 K_{d}^{\\mathrm{WT}}\n$$\n将此代入关于 $\\mathrm{EC50}$ 的方程中，得到：\n$$\n[\\mathrm{Ca}^{2+}]_{50}^{\\mathrm{mut}} = 2 \\cdot [\\mathrm{Ca}^{2+}]_{50}^{\\mathrm{WT}}\n$$\n问题要求计算 $p\\mathrm{Ca}$ 轴上的位移，其中 $p\\mathrm{Ca} = -\\log_{10}([\\mathrm{Ca}^{2+}])$。我们可以写出中点 $p\\mathrm{Ca}_{50}^{\\mathrm{WT}}$ 和 $p\\mathrm{Ca}_{50}^{\\mathrm{mut}}$：\n$$\np\\mathrm{Ca}_{50}^{\\mathrm{WT}} = -\\log_{10}([\\mathrm{Ca}^{2+}]_{50}^{\\mathrm{WT}})\n$$\n$$\np\\mathrm{Ca}_{50}^{\\mathrm{mut}} = -\\log_{10}([\\mathrm{Ca}^{2+}]_{50}^{\\mathrm{mut}})\n$$\n现在，我们将突变型和野生型 $\\mathrm{EC50}$ 值之间的关系代入 $p\\mathrm{Ca}_{50}^{\\mathrm{mut}}$ 的方程中：\n$$\np\\mathrm{Ca}_{50}^{\\mathrm{mut}} = -\\log_{10}(2 \\cdot [\\mathrm{Ca}^{2+}]_{50}^{\\mathrm{WT}})\n$$\n使用对数性质 $\\log(ab) = \\log(a) + \\log(b)$，我们得到：\n$$\np\\mathrm{Ca}_{50}^{\\mathrm{mut}} = -(\\log_{10}(2) + \\log_{10}([\\mathrm{Ca}^{2+}]_{50}^{\\mathrm{WT}}))\n$$\n$$\np\\mathrm{Ca}_{50}^{\\mathrm{mut}} = -\\log_{10}(2) - \\log_{10}([\\mathrm{Ca}^{2+}]_{50}^{\\mathrm{WT}})\n$$\n注意到 $-\\log_{10}([\\mathrm{Ca}^{2+}]_{50}^{\\mathrm{WT}})$ 等于 $p\\mathrm{Ca}_{50}^{\\mathrm{WT}}$，我们有：\n$$\np\\mathrm{Ca}_{50}^{\\mathrm{mut}} = p\\mathrm{Ca}_{50}^{\\mathrm{WT}} - \\log_{10}(2)\n$$\n所要求的位移 $\\Delta p\\mathrm{Ca}_{50}$ 定义为 $p\\mathrm{Ca}_{50}^{\\mathrm{mut}} - p\\mathrm{Ca}_{50}^{\\mathrm{WT}}$。\n$$\n\\Delta p\\mathrm{Ca}_{50} = (p\\mathrm{Ca}_{50}^{\\mathrm{WT}} - \\log_{10}(2)) - p\\mathrm{Ca}_{50}^{\\mathrm{WT}} = -\\log_{10}(2)\n$$\n这是答案的第一部分。钙亲和力的降低（$K_d$ 增加）导致力-钙曲线向右移动，这对应于 $p\\mathrm{Ca}$ 标度上的减小（因为 $p\\mathrm{Ca}$ 是一个负对数）。\n\n其次，我们确定突变体的希尔系数 $n_{H}^{\\mathrm{mut}}$。问题陈述明确区分了决定曲线位置（敏感度）的因素和决定其陡峭度（协同性）的因素。S形力-$p\\mathrm{Ca}$曲线的宏观陡峭度由希尔系数 $n_{H}$ 量化。问题陈述指出，这种陡峭度由“细肌丝上的协同耦合所控制，在野生型中该耦合的特征是有效希尔系数 $n_{0}$。”关键是，陈述中还提到：“下文所考虑的突变不改变此协同耦合结构（即，不改变 $n_{0}$）。”\n\n这意味着系统的内在协同性（它产生了陡峭的S形响应）是一个独立参数，不受钙结合位点突变的影响。力-响应曲线的希尔系数 $n_H$ 是这种潜在协同性的宏观表现，并由 $n_0$ 参数化。因此，野生型的希尔系数为 $n_{H}^{\\mathrm{WT}} = n_{0}$。由于该突变不影响协同机制，突变体的希尔系数必须与野生型相同。\n$$\nn_{H}^{\\mathrm{mut}} = n_{H}^{\\mathrm{WT}} = n_{0}\n$$\n该突变改变了曲线的位置，但没有改变其形状或陡峭度。因此，用野生型值 $n_0$ 表示的突变体希尔系数就是 $n_0$。\n\n综合这些结果，中点的加性位移是 $-\\log_{10}(2)$，突变体的希尔系数是 $n_0$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\log_{10}(2) & n_{0} \\end{pmatrix}}\n$$", "id": "2567167"}, {"introduction": "生物系统充满了复杂的动态反馈回路，要理解其行为，通常需要借助计算模型。本练习将挑战你从头构建 L-型钙离子通道的 Hodgkin-Huxley 模型，其中不仅包含了电压依赖性门控，还整合了至关重要的钙依赖性失活 (CDI) 这一负反馈机制。通过模拟这一耦合系统，你将深入理解兴奋-收缩偶联中钙离子触发信号的时变特性，以及这些反馈机制如何共同塑造心肌细胞的动作电位和钙瞬变。[@problem_id:2567141]", "problem": "从第一性原理出发，且不依赖于预先打包好的目标公式，构建一个 L 型钙电流的 Hodgkin–Huxley 风格模型，该模型需同时包含电压依赖性失活和钙依赖性失活。从双态门控诠释和质量作用动力学入手，并利用电荷守恒将钙离子内流与驱动钙依赖性失活的膜下钙浓度耦合起来。您的任务是推导控制微分方程，将电流定义为门控变量和膜电压的代数输出，并实现一个数值求解器，该求解器从一个维持电位开始，模拟一个指定持续时间的方波电压钳方案。膜电压被钳制在维持电位以初始化门控变量，然后在 $t=0$ 时刻阶跃至目标电压，并持续固定的时间。膜下钙浓度由于钙电流和一级移除项而动态演化。钙依赖性失活门由钙离子通过质量作用动力学与一个失活位点结合所驱动。对于每个测试用例，您的程序最终必须输出阶跃期间的最负电流（即电流的最小值）和阶跃结束时的电流。\n\n仅使用以下基础依据：\n- 双态门控，其正向和反向转换由速率决定，这些速率对电压依赖性门控而言依赖于膜电压，对钙依赖性失活而言依赖于钙浓度，并通过线性质量作用常微分方程组合。\n- 将电流分解为最大电导、独立门控变量的乘积以及驱动力的 Hodgkin–Huxley 分解形式。\n- 通过法拉第常数将离子电流与膜下钙浓度的变化联系起来的电荷守恒。\n- 通过在恒定条件下将时间导数置零来进行的在维持电位下的稳态初始化。\n\n您的程序必须实现以下约束和参数值，除非在测试用例中明确改变，否则它们对所有测试用例都是固定的：\n- 维持阶段的膜电压：$V_{\\mathrm{hold}} = -0.08$ 伏特。\n- 钙的阶跃反转电位：$E_{\\mathrm{Ca}} = +0.06$ 伏特。\n- 钙的化合价：$z = 2$。\n- 法拉第常数：$F = 96485.33212$ 库仑/摩尔。\n- 最大电导：$g_{\\mathrm{CaL}} = 5\\times 10^{-7}$ 西门子。\n- 激活门指数：$p = 2$。\n- 电压依赖性激活门 $m$：使用一个双态门，具有稳态值 $m_{\\infty}(V)$ 和时间常数 $\\tau_m(V)$，组合成一个一阶线性常微分方程。对于数值模拟，使用一个逻辑斯蒂稳态 $m_{\\infty}(V)$，其半激活电压为 $V_{m,1/2} = -0.01$ 伏特，斜率因子为 $k_m = 0.006$ 伏特，以及一个不依赖于电压的时间常数 $\\tau_m = 0.003$ 秒。\n- 电压依赖性失活门 $h$：使用一个双态门，具有稳态值 $h_{\\infty}(V)$ 和时间常数 $\\tau_h(V)$，组合成一个一阶线性常微分方程。对于数值模拟，使用一个逻辑斯蒂稳态 $h_{\\infty}(V)$，其半失活电压为 $V_{h,1/2} = -0.04$ 伏特，斜率因子为 $k_h = 0.006$ 伏特，以及一个不依赖于电压的时间常数 $\\tau_h = 0.04$ 秒。\n- 钙依赖性失活门被实现为一个失活结合部分 $b$，遵循质量作用结合，其结合速率为 $k_{\\mathrm{on}} = 1.0\\times 10^{8}$ (M·s)⁻¹，解离速率为 $k_{\\mathrm{off}} = K_d \\, k_{\\mathrm{on}}$，解离常数为 $K_d = 5.0\\times 10^{-7}$ 摩尔/升 (M)。由钙依赖性失活导致的可传导部分为 $f_{\\mathrm{Ca}} = 1 - b$。\n- 膜下钙动力学：一个体积为 $V_{\\mathrm{ss}} = 1.0\\times 10^{-12}$ 升的充分混合子空间，其钙浓度以时间常数 $\\tau_{\\mathrm{Ca}} = 0.05$ 秒向体/静息值进行一级移除，并在方程右侧乘以一个有效缓冲因子 $\\gamma_B = 0.01$。钙浓度遵循一个一级常微分方程，该方程是钙电流驱动的内流项和移除项之和。\n- 在阶跃期间的 L 型钙电流是一个代数量 $I_{\\mathrm{CaL}}(t) = g_{\\mathrm{CaL}}\\, m(t)^p\\, h(t)\\, f_{\\mathrm{Ca}}(t)\\, (V_{\\mathrm{step}} - E_{\\mathrm{Ca}})$，其中 $V_{\\mathrm{step}}$ 是钳制阶跃电压。同样的结构适用于在维持电压下进行稳态初始化。\n- $t=0^{-}$ 时的初始化：设置 $m(0^{-}) = m_{\\infty}(V_{\\mathrm{hold}})$，$h(0^{-}) = h_{\\infty}(V_{\\mathrm{hold}})$，$b(0^{-}) = b_{\\infty}(\\mathrm{Ca}_{\\mathrm{rest}})$，其中 $b_{\\infty}(\\mathrm{Ca}) = \\dfrac{k_{\\mathrm{on}}\\mathrm{Ca}}{k_{\\mathrm{on}}\\mathrm{Ca} + k_{\\mathrm{off}}}$，且 $\\mathrm{Ca}(0^{-}) = \\mathrm{Ca}_{\\mathrm{rest}}$。在 $t=0$ 时，将电压阶跃至 $V_{\\mathrm{step}}$，并使用完全耦合的动力学对指定的持续时间进行前向积分。\n\n您的程序必须不接受任何输入，并且必须使用以下固定的测试套件。对于每个测试用例，您都必须模拟从维持电位到指定阶跃电压的单次阶跃，持续指定的时间，并从具有指定 $\\mathrm{Ca}_{\\mathrm{rest}}$ 的维持稳态开始：\n- 测试用例 1：$V_{\\mathrm{step}} = 0.0$ 伏特，持续时间 $T = 0.2$ 秒，$\\mathrm{Ca}_{\\mathrm{rest}} = 1.0\\times 10^{-7}$ 摩尔/升 (M)。\n- 测试用例 2：$V_{\\mathrm{step}} = 0.0$ 伏特，持续时间 $T = 0.2$ 秒，$\\mathrm{Ca}_{\\mathrm{rest}} = 1.0\\times 10^{-6}$ 摩尔/升 (M)。\n- 测试用例 3：$V_{\\mathrm{step}} = -0.02$ 伏特，持续时间 $T = 0.1$ 秒，$\\mathrm{Ca}_{\\mathrm{rest}} = 1.0\\times 10^{-7}$ 摩尔/升 (M)。\n- 测试用例 4：$V_{\\mathrm{step}} = 0.0$ 伏特，持续时间 $T = 0.005$ 秒，$\\mathrm{Ca}_{\\mathrm{rest}} = 1.0\\times 10^{-7}$ 摩尔/升 (M)。\n\n对于每个测试用例，您的程序必须返回两个浮点数值：阶跃区间 $t \\in [0, T]$ 内 $I_{\\mathrm{CaL}}(t)$ 的最小值（最负值），以及阶跃结束时的终末值 $I_{\\mathrm{CaL}}(T)$。电流的单位是安培。请用科学记数法表示每个测试用例的这两个值，并精确到 $6$ 位有效数字。\n\n最终输出格式：您的程序必须生成单行，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含测试用例 1 到 4 的结果，每个测试用例先是最小电流，然后是终末电流，总共 8 个数字。例如，输出格式必须与 $[\\text{val}_{1,\\min},\\text{val}_{1,T},\\text{val}_{2,\\min},\\text{val}_{2,T},\\text{val}_{3,\\min},\\text{val}_{3,T},\\text{val}_{4,\\min},\\text{val}_{4,T}]$ 完全一样，其中每个 $\\text{val}$ 都以科学记数法格式化，具有 $6$ 位有效数字，单位为安培。", "solution": "该问题要求构建和模拟一个 L 型钙电流（$I_{\\mathrm{CaL}}$）的 Hodgkin-Huxley 风格模型，该模型同时包含电压依赖性和钙依赖性失活。推导过程必须从第一性原理出发。\n\n系统的状态由四个随时间变化的变量描述：激活门 $m(t)$、电压依赖性失活门 $h(t)$、钙依赖性失活部分 $b(t)$ 以及膜下钙浓度 $\\mathrm{Ca}(t)$。膜电压 $V(t)$ 通过电压钳方案进行外部控制。\n\n**1. 控制微分方程的推导**\n\n**A. 电压依赖性门控动力学：**\n电压依赖性门，即激活门（$m$）和失活门（$h$），的动力学由一阶线性常微分方程描述。对于一个通用门控变量 $x$，其变化率由关闭态（$1-x$）和开放态（$x$）之间的转换给出，受电压依赖性速率常数 $\\alpha_x(V)$ 和 $\\beta_x(V)$ 控制：\n$$ \\frac{dx}{dt} = \\alpha_x(V)(1-x) - \\beta_x(V)x $$\n这通常使用稳态值 $x_{\\infty}(V) = \\frac{\\alpha_x(V)}{\\alpha_x(V) + \\beta_x(V)}$ 和时间常数 $\\tau_x(V) = \\frac{1}{\\alpha_x(V) + \\beta_x(V)}$ 来重构：\n$$ \\frac{dx}{dt} = \\frac{x_{\\infty}(V) - x}{\\tau_x(V)} $$\n问题直接提供了稳态函数和时间常数。\n\n对于激活门 $m$：\n$$ \\frac{dm}{dt} = \\frac{m_{\\infty}(V) - m}{\\tau_m} $$\n其中 $m_{\\infty}(V)$ 是一个表示稳态激活的逻辑斯蒂函数：\n$$ m_{\\infty}(V) = \\left(1 + \\exp\\left(-\\frac{V - V_{m,1/2}}{k_m}\\right)\\right)^{-1} $$\n时间常数 $\\tau_m$ 被给定为一个常数值。\n\n对于电压依赖性失活门 $h$：\n$$ \\frac{dh}{dt} = \\frac{h_{\\infty}(V) - h}{\\tau_h} $$\n其中 $h_{\\infty}(V)$ 是一个表示稳态失活的逻辑斯蒂函数：\n$$ h_{\\infty}(V) = \\left(1 + \\exp\\left(\\frac{V - V_{h,1/2}}{k_h}\\right)\\right)^{-1} $$\n时间常数 $\\tau_h$ 也被给定为一个常数。\n\n**B. 钙依赖性失活（CDI）动力学：**\n钙依赖性失活被建模为钙离子与通道上失活位点的结合。处于结合、失活状态的通道部分用 $b$ 表示。相应的可用（未结合）部分为 $f_{\\mathrm{Ca}} = 1-b$。结合反应为：\n$$ \\text{Site}_\\text{unbound} + \\mathrm{Ca}^{2+} \\rightleftharpoons \\text{Site}_\\text{bound} $$\n反应动力学由质量作用定律描述，具有结合速率 $k_{\\mathrm{on}}$ 和解离速率 $k_{\\mathrm{off}}$。结合部分 $b$ 的变化率为：\n$$ \\frac{db}{dt} = k_{\\mathrm{on}}[\\mathrm{Ca}](1-b) - k_{\\mathrm{off}}b $$\n此处，$[\\mathrm{Ca}]$ 是膜下钙浓度 $\\mathrm{Ca}(t)$。解离速率通过解离常数定义，$k_{\\mathrm{off}} = K_d k_{\\mathrm{on}}$。\n\n**C. 膜下钙浓度动力学：**\n膜下钙浓度由于通过 L 型通道的内流和一级移除过程而改变。\n$$ \\frac{d[\\mathrm{Ca}]}{dt} = (\\text{内流引起的变化率}) + (\\text{移除引起的变化率}) $$\n离子电流 $I_{\\mathrm{CaL}}$（单位：安培，C/s）通过除以法拉第常数 $F$ 和离子化合价 $z$ 转换为摩尔通量（mol/s）。按照惯例，正离子的内向电流为负值，并会增加胞内浓度。因此，摩尔内流为 $-\\frac{I_{\\mathrm{CaL}}}{zF}$。浓度的变化率是该通量除以膜下体积 $V_{\\mathrm{ss}}$（单位：升）。\n移除项描述了向静息钙浓度 $\\mathrm{Ca}_{\\mathrm{rest}}$ 的一级弛豫，时间常数为 $\\tau_{\\mathrm{Ca}}$。该项为 $-\\frac{[\\mathrm{Ca}] - \\mathrm{Ca}_{\\mathrm{rest}}}{\\tau_{\\mathrm{Ca}}}$。\n最后，一个有效缓冲因子 $\\gamma_B$ 缩放了游离钙的净变化率，反映了与胞内缓冲物的快速结合。问题指出该因子应用于整个右侧。完整的常微分方程为：\n$$ \\frac{d[\\mathrm{Ca}]}{dt} = \\gamma_B \\left( -\\frac{I_{\\mathrm{CaL}}}{z F V_{\\mathrm{ss}}} - \\frac{[\\mathrm{Ca}] - \\mathrm{Ca}_{\\mathrm{rest}}}{\\tau_{\\mathrm{Ca}}} \\right) $$\n\n**D. L 型钙电流方程：**\n电流 $I_{\\mathrm{CaL}}$ 是系统的代数输出，在 Hodgkin-Huxley 范式中定义为最大电导（$g_{\\mathrm{CaL}}$）、门控变量和驱动力（$V - E_{\\mathrm{Ca}}$）的乘积：\n$$ I_{\\mathrm{CaL}}(t) = g_{\\mathrm{CaL}} \\, m(t)^p \\, h(t) \\, f_{\\mathrm{Ca}}(t) \\, (V(t) - E_{\\mathrm{Ca}}) $$\n代入 $f_{\\mathrm{Ca}}(t) = 1 - b(t)$ 得：\n$$ I_{\\mathrm{CaL}}(t) = g_{\\mathrm{CaL}} \\, m(t)^p \\, h(t) \\, (1-b(t)) \\, (V(t) - E_{\\mathrm{Ca}}) $$\n这个 $I_{\\mathrm{CaL}}$ 的表达式被代入到 $\\mathrm{Ca}(t)$ 的常微分方程中，从而创建了一个完全耦合的系统。\n\n**2. 数值模拟策略**\n\n这个包含四个耦合的非线性常微分方程的系统需要进行数值求解。\n\n**A. 初始化：**\n在时间 $t < 0$ 时，系统在维持电位 $V_{\\mathrm{hold}}$ 和静息钙浓度 $\\mathrm{Ca}_{\\mathrm{rest}}$ 下处于稳态。在 $t=0$ 时用于模拟的初始条件通过将时间导数置零来获得：\n- $m(0) = m_{\\infty}(V_{\\mathrm{hold}})$\n- $h(0) = h_{\\infty}(V_{\\mathrm{hold}})$\n- $\\mathrm{Ca}(0) = \\mathrm{Ca}_{\\mathrm{rest}}$\n- $b(0) = b_{\\infty}(\\mathrm{Ca}_{\\mathrm{rest}})$，其中稳态结合部分由 $\\frac{db}{dt}=0$ 导出：\n  $$ b_{\\infty}(\\mathrm{Ca}) = \\frac{k_{\\mathrm{on}}\\mathrm{Ca}}{k_{\\mathrm{on}}\\mathrm{Ca} + k_{\\mathrm{off}}} $$\n\n**B. 积分：**\n在 $t=0$ 时，电压阶跃至 $V_{\\mathrm{step}}$。然后，该常微分方程系统从 $t=0$ 到指定的持续时间 $T$ 进行前向时间积分。一个鲁棒的自适应步长求解器是合适的，例如 Runge-Kutta 方法（如 RK45）。我们使用 `scipy.integrate.solve_ivp` 来完成此任务，并设置足够小的误差容限以确保所需的数值精度。\n\n**C. 输出计算：**\n模拟完成后，获得了在区间 $[0, T]$ 上 $m(t)$、$h(t)$、$b(t)$ 和 $\\mathrm{Ca}(t)$ 的解轨迹。然后计算所有时间点的电流 $I_{\\mathrm{CaL}}(t)$。所需的输出是：\n1. 阶跃期间电流的最小值：$\\min_{t \\in [0, T]} I_{\\mathrm{CaL}}(t)$。\n2. 阶跃结束时电流的终末值：$I_{\\mathrm{CaL}}(T)$。\n\n对问题中定义的每个测试用例重复此过程。最终的数值结果按指定格式进行格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Constructs and solves a Hodgkin-Huxley style model for the L-type calcium current.\n    \"\"\"\n\n    # --- Fixed Parameters ---\n    params = {\n        'V_hold': -0.08,      # Holding potential (V)\n        'E_ca': 0.06,         # Calcium reversal potential (V)\n        'z': 2.0,             # Valence of Calcium\n        'F': 96485.33212,     # Faraday's constant (C/mol)\n        'g_caL': 5.0e-7,      # Maximal conductance (S)\n        'p': 2,               # Activation gate exponent\n        'V_m_half': -0.01,    # Activation half-voltage (V)\n        'k_m': 0.006,         # Activation slope factor (V)\n        'tau_m': 0.003,       # Activation time constant (s)\n        'V_h_half': -0.04,    # V-inactivation half-voltage (V)\n        'k_h': 0.006,         # V-inactivation slope factor (V)\n        'tau_h': 0.04,        # V-inactivation time constant (s)\n        'k_on': 1.0e8,        # CDI on-rate (1/M/s)\n        'K_d': 5.0e-7,        # CDI dissociation constant (M)\n        'V_ss': 1.0e-12,      # Submembrane volume (L)\n        'tau_ca': 0.05,       # Calcium removal time constant (s)\n        'gamma_B': 0.01       # Calcium buffering factor\n    }\n    params['k_off'] = params['K_d'] * params['k_on'] # CDI off-rate (1/s)\n\n    # --- Steady-State and ODE Functions ---\n\n    def m_inf(V, p):\n        return 1.0 / (1.0 + np.exp(-(V - p['V_m_half']) / p['k_m']))\n\n    def h_inf(V, p):\n        return 1.0 / (1.0 + np.exp((V - p['V_h_half']) / p['k_h']))\n\n    def b_inf(Ca, p):\n        return (p['k_on'] * Ca) / (p['k_on'] * Ca + p['k_off'])\n\n    def get_initial_conditions(v_hold, ca_rest, p):\n        m0 = m_inf(v_hold, p)\n        h0 = h_inf(v_hold, p)\n        b0 = b_inf(ca_rest, p)\n        ca0 = ca_rest\n        return [m0, h0, b0, ca0]\n\n    def ode_system(t, y, v_step, ca_rest, p):\n        m, h, b, ca = y\n\n        # d(m)/dt\n        dmdt = (m_inf(v_step, p) - m) / p['tau_m']\n        \n        # d(h)/dt\n        dhdt = (h_inf(v_step, p) - h) / p['tau_h']\n\n        # d(b)/dt\n        dbdt = p['k_on'] * ca * (1.0 - b) - p['k_off'] * b\n        \n        # Algebraic current I_CaL\n        f_ca = 1.0 - b\n        i_caL = p['g_caL'] * (m**p['p']) * h * f_ca * (v_step - p['E_ca'])\n\n        # d(Ca)/dt\n        # Inward current is negative, increases [Ca]\n        flux_term = -i_caL / (p['z'] * p['F'] * p['V_ss'])\n        removal_term = (ca - ca_rest) / p['tau_ca']\n        dca_dt = p['gamma_B'] * (flux_term - removal_term)\n\n        return [dmdt, dhdt, dbdt, dca_dt]\n\n    # --- Test Cases ---\n    test_cases = [\n        # (V_step [V], a duration T [s], Ca_rest [M])\n        (0.0, 0.2, 1.0e-7),\n        (0.0, 0.2, 1.0e-6),\n        (-0.02, 0.1, 1.0e-7),\n        (0.0, 0.005, 1.0e-7),\n    ]\n\n    all_results = []\n    \n    for v_step, duration, ca_rest in test_cases:\n        # Get initial conditions\n        y0 = get_initial_conditions(params['V_hold'], ca_rest, params)\n        t_span = (0, duration)\n\n        # Solve the ODE system\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=t_span,\n            y0=y0,\n            method='RK45', \n            args=(v_step, ca_rest, params),\n            dense_output=True,\n            rtol=1e-8,\n            atol=1e-10\n        )\n\n        # To find the minimum current, evaluate the solution on a fine grid\n        t_eval = np.linspace(t_span[0], t_span[1], 2000)\n        y_eval = sol.sol(t_eval)\n        m_eval, h_eval, b_eval, _ = y_eval\n        \n        i_caL_profile = params['g_caL'] * (m_eval**params['p']) * h_eval * (1.0 - b_eval) * (v_step - params['E_ca'])\n        min_i = np.min(i_caL_profile)\n\n        # Calculate terminal current from the last point of the solution\n        m_T, h_T, b_T, _ = sol.y[:, -1]\n        i_caL_T = params['g_caL'] * (m_T**params['p']) * h_T * (1.0 - b_T) * (v_step - params['E_ca'])\n        \n        # Append results formatted to 6 significant digits in scientific notation\n        all_results.append(\"{:.6e}\".format(min_i))\n        all_results.append(\"{:.6e}\".format(i_caL_T))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2567141"}]}