{"hands_on_practices": [{"introduction": "简单的数学模型可以为复杂的生理过程提供强有力的见解。本练习通过一个基础的代数模型，揭示了由髓袢升支粗段（TAL）产生的“单一效应”是如何作为逆流倍增系统的基本构建单元的。通过模拟袢利尿剂（如呋塞米）的作用——这类药物直接靶向产生单一效应的 NKCC2 转运蛋白——您将能够定量分析其对肾脏最大浓缩能力的影响，从而将细胞层面的转运机制与整体生理功能联系起来。[@problem_id:2617889]", "problem": "亨利氏袢的粗升支通过2型钠-钾-2氯协同转运体（NKCC2）主动重吸收氯化钠，并且实际上对水不通透，从而建立了一个横向的皮质-髓质“单一效应”，该效应通过逆流流动在轴向上被倍增。考虑一个简化的逆流倍增稳态模型，其中满足以下条件：\n\n- 皮质间质的渗透压浓度为 $300 \\, \\text{mOsm/kg H}_2\\text{O}$。\n- 在无药物作用的情况下，粗升支在每个轴向水平上产生的横向单一效应幅度为 $\\Delta C_{0} = 205 \\, \\text{mOsm/kg H}_2\\text{O}$。\n- 系统的轴向范围和肾单位袢的分布可以由一个逆流倍增重复的有效次数 $N = 3$ 来表示（这是一个代表长度和混合的非整数代理值，决定了单一效应沿皮质髓质轴施加的次数）。\n- 内髓质尿素再循环为乳头间质额外贡献了 $300 \\, \\text{mOsm/kg H}_2\\text{O}$，并且在所考虑的条件下不受袢利尿剂的影响。\n- 当存在抗利尿激素（ADH, antidiuretic hormone）时，集合管在每个水平上与周围间质达到渗透平衡，因此最大尿渗透压浓度等于乳头间质渗透压浓度。\n\n一剂furosemide导致对NKCC2的部分阻断，阻断分数为 $f = 0.70$。假设在稳态下，单一效应的幅度 $\\Delta C$ 与剩余的NKCC2活性成正比，且其他上皮通透性保持不变。\n\n仅使用这些前提和逆流倍增的基本原理，推导furosemide如何改变单一效应，以及该变化如何传导至乳头间质渗透压浓度。然后，计算此给药方案产生的最大尿渗透压浓度的降低值。\n\n将最终数值答案取四位有效数字，并以 $\\text{mOsm/kg H}_2\\text{O}$ 为单位表示。", "solution": "所述问题具有科学依据且提法恰当，允许直接的解析解。我们根据所提供的简化模型描述的逆流倍增基本原理进行求解。\n\n在抗利尿条件下，最大尿渗透压浓度 $U_{osm,max}$ 等于乳头间质的渗透压浓度 $C_{papilla}$。根据模型定义，该渗透压浓度是以下三个组成部分之和：\n$1$. 皮质间质的渗透压浓度 $C_{cortex}$，即进入系统的液体的基线渗透压浓度。\n$2$. 由亨利氏袢的逆流倍增作用产生的总渗透梯度，其大小为单一效应幅度 $\\Delta C$ 与有效倍增重复次数 $N$ 的乘积。\n$3$. 尿素再循环对乳头的额外渗透贡献，我们记为 $C_{urea}$。\n\n因此，最大尿渗透压浓度的控制方程为：\n$$U_{osm,max} = C_{papilla} = C_{cortex} + N \\cdot \\Delta C + C_{urea}$$\n\n我们已知以下参数：\n- 皮质间质渗透压浓度： $C_{cortex} = 300 \\, \\text{mOsm/kg H}_2\\text{O}$\n- 基线单一效应幅度： $\\Delta C_{0} = 205 \\, \\text{mOsm/kg H}_2\\text{O}$\n- 有效重复次数： $N = 3$\n- 尿素对乳头渗透压浓度的贡献： $C_{urea} = 300 \\, \\text{mOsm/kg H}_2\\text{O}$\n\n首先，我们计算没有任何药物作用时的基线最大尿渗透压浓度 $U_{osm,max,0}$。我们使用基线单一效应 $\\Delta C_{0}$。\n$$U_{osm,max,0} = C_{cortex} + N \\cdot \\Delta C_{0} + C_{urea}$$\n代入给定值：\n$$U_{osm,max,0} = 300 + (3 \\times 205) + 300$$\n$$U_{osm,max,0} = 300 + 615 + 300 = 1215 \\, \\text{mOsm/kg H}_2\\text{O}$$\n\n接下来，我们评估furosemide的效果。Furosemide导致NKCC2转运体的部分阻断，阻断分数为 $f = 0.70$。问题陈述，单一效应幅度 $\\Delta C$ 与剩余的NKCC2活性成正比。剩余活性为 $(1-f)$。因此，在furosemide存在下，新的单一效应幅度 $\\Delta C_{f}$ 为：\n$$\\Delta C_{f} = \\Delta C_{0} \\cdot (1 - f)$$\n代入 $\\Delta C_{0}$ 和 $f$ 的值：\n$$\\Delta C_{f} = 205 \\cdot (1 - 0.70) = 205 \\cdot 0.30 = 61.5 \\, \\text{mOsm/kg H}_2\\text{O}$$\n\n现在，我们计算在furosemide影响下的新的最大尿渗透压浓度 $U_{osm,max,f}$。参数 $C_{cortex}$、$N$ 和 $C_{urea}$ 被声明为不受影响。我们使用修正后的单一效应 $\\Delta C_{f}$。\n$$U_{osm,max,f} = C_{cortex} + N \\cdot \\Delta C_{f} + C_{urea}$$\n代入相应的值：\n$$U_{osm,max,f} = 300 + (3 \\times 61.5) + 300$$\n$$U_{osm,max,f} = 300 + 184.5 + 300 = 784.5 \\, \\text{mOsm/kg H}_2\\text{O}$$\n\n最后，问题要求计算最大尿渗透压浓度的降低值。这是基线渗透压浓度与使用furosemide后的渗透压浓度之间的差值。设该降低值为 $\\Delta U_{osm,max}$。\n$$\\Delta U_{osm,max} = U_{osm,max,0} - U_{osm,max,f}$$\n$$\\Delta U_{osm,max} = 1215 - 784.5 = 430.5 \\, \\text{mOsm/kg H}_2\\text{O}$$\n\n结果必须取四位有效数字。计算值 $430.5$ 本身就是四位有效数字。因此，无需进行额外的四舍五入。", "answer": "$$\\boxed{430.5}$$", "id": "2617889"}, {"introduction": "建立陡峭的肾髓质渗透压梯度并非瞬时完成。本练习将探讨逆流倍增器的时间动态特性，将梯度建立过程简化为一个趋向稳态的一阶线性弛豫模型。通过求解一个简单的一阶常微分方程，您将计算出建立该梯度所需的特征时间，从而对肾脏稳态调节所涉及的时间尺度有一个直观的认识。[@problem_id:2617879]", "problem": "在一个哺乳动物肾髓质逆流倍增的简约空间集总模型中，考虑一个Henle袢，其降支和粗升支的总长度为 $L = 1\\,\\mathrm{cm}$。粗升支中的转运体在升支液和每个相应轴向水平的相邻降支/间质之间建立一个固定的横向渗透压差（“单一效应”），其大小为 $\\Delta C_{\\mathrm{s}} = 180\\,\\mathrm{mOsm}$，且与时间无关。从皮质流入的新鲜肾小管液具有恒定的渗透压浓度 $C_{\\mathrm{in}}$。肾小管液通过该袢（降支加升支）的通过时间为 $T = 60\\,\\mathrm{s}$。\n\n假设以下理想化条件，这些是逆流系统第一性原理模型中的标准假设：\n- 降支与局部间质的渗透平衡速度远快于轴向平流，因此间质和降支在局部具有相同的渗透压浓度。\n- 升支中的泵足够强大，能在任何时候维持单一效应 $\\Delta C_{\\mathrm{s}}$，因此存在稳态的髓质乳头顶渗透压浓度 $C_{\\infty}$，其值由 $\\Delta C_{\\mathrm{s}}$ 和 $L$ 决定（本题无需显式计算 $C_{\\infty}$）。\n- 髓质乳头顶渗透压浓度 $C_{\\mathrm{tip}}(t)$ 趋近其稳态值 $C_{\\infty}$ 的时间过程，可以由一个一阶线性弛豫动力学很好地描述。该动力学由一个充分混合的有效乳头顶区室中的质量守恒所支配，其唯一的特征更新时间由肾小管冲刷设定。具体而言，该动力学满足 $\\dfrac{dC_{\\mathrm{tip}}}{dt} = \\dfrac{C_{\\infty}-C_{\\mathrm{tip}}}{\\tau}$，其中 $\\tau = T$。\n- 定义一个“倍增周期”为一个完整的肾小管通过时间 $T$。\n\n从一个均一的初始状态 $C_{\\mathrm{tip}}(0)=C_{\\mathrm{in}}$ 开始，计算 $C_{\\mathrm{tip}}(t)$ 达到 $C_{\\infty}$ 的 $0.95$ 所需的倍增周期数。报告周期数（无量纲）。将你的答案四舍五入到三位有效数字。", "solution": "首先必须验证问题陈述的正确性和可解性。\n\n步骤1：提取已知条件。\n提供的参数和条件如下：\n- 袢长度: $L = 1\\,\\mathrm{cm}$\n- 单一效应大小: $\\Delta C_{\\mathrm{s}} = 180\\,\\mathrm{mOsm}$\n- 流入液渗透压浓度: $C_{\\mathrm{in}}$ (恒定)\n- 肾小管通过时间: $T = 60\\,\\mathrm{s}$\n- 髓质乳头顶渗透压浓度\n $C_{\\mathrm{tip}}(t)$ 的时间动力学由以下微分方程决定: $\\dfrac{dC_{\\mathrm{tip}}}{dt} = \\dfrac{C_{\\infty}-C_{\\mathrm{tip}}}{\\tau}$\n- 特征更新时间等于通过时间: $\\tau = T$\n- 初始条件: 在时间 $t=0$ 时，乳头顶渗透压浓度为 $C_{\\mathrm{tip}}(0) = C_{\\mathrm{in}}$\n- 一个“倍增周期”定义为一个通过时间 $T$。\n- 目标条件是找到时间，使得 $C_{\\mathrm{tip}}(t)$ 达到其稳态值 $C_{\\infty}$ 的 $0.95$。\n\n步骤2：使用提取的已知条件进行验证。\n该问题使用标准的一阶线性弛豫模型来描述肾髓质渗透压梯度的动态建立过程。这是定量生理学中常用且有科学依据的简化方法。所提供的参数（如 $L$ 和 $T$）的数量级是合理的。问题的核心是求解一个给定初始条件的明确的一阶常微分方程。\n\n然而，目标条件的措辞“$C_{\\mathrm{tip}}(t)$ 达到 $C_{\\infty}$ 的 $0.95$”存在轻微的模糊性。字面解释 $C_{\\mathrm{tip}}(t_{\\mathrm{target}}) = 0.95 C_{\\infty}$ 将导致一个依赖于比值 $C_{\\mathrm{in}}/C_{\\infty}$ 的解，而该比值并未提供。这将使问题条件不足。然而，在弛豫动力学的研究中，标准做法是将这种陈述解释为系统完成了从其初始状态到其最终稳态总转变过程的 $95\\%$。也就是说，完成比例 $\\frac{C_{\\mathrm{tip}}(t) - C_{\\mathrm{tip}}(0)}{C_{\\infty} - C_{\\mathrm{tip}}(0)}$ 等于 $0.95$。这种解释使问题自洽，并且不依赖于 $C_{\\mathrm{in}}$ 和 $C_{\\infty}$ 的具体值，这与不需要计算 $C_{\\infty}$ 的说明是一致的。鉴于上下文，这是唯一能得出可解问题的合理解释。因此，在此标准解释下，该问题被认为是有效的。\n\n开始求解。控制方程是一个一阶线性常微分方程：\n$$\n\\frac{dC_{\\mathrm{tip}}}{dt} = \\frac{C_{\\infty} - C_{\\mathrm{tip}}}{\\tau}\n$$\n这是一个可分离变量方程。我们可以将其整理为：\n$$\n\\frac{dC_{\\mathrm{tip}}}{C_{\\infty} - C_{\\mathrm{tip}}} = \\frac{dt}{\\tau}\n$$\n对两边从初始状态（$t=0$, $C_{\\mathrm{tip}}=C_{\\mathrm{in}}$）积分到时间 $t$ 的状态，得到：\n$$\n\\int_{C_{\\mathrm{in}}}^{C_{\\mathrm{tip}}(t)} \\frac{dC'}{C_{\\infty} - C'} = \\int_{0}^{t} \\frac{dt'}{\\tau}\n$$\n积分结果为：\n$$\n\\left[ -\\ln(C_{\\infty} - C') \\right]_{C_{\\mathrm{in}}}^{C_{\\mathrm{tip}}(t)} = \\frac{t}{\\tau}\n$$\n$$\n-\\ln(C_{\\infty} - C_{\\mathrm{tip}}(t)) - (-\\ln(C_{\\infty} - C_{\\mathrm{in}})) = \\frac{t}{\\tau}\n$$\n$$\n\\ln\\left(\\frac{C_{\\infty} - C_{\\mathrm{in}}}{C_{\\infty} - C_{\\mathrm{tip}}(t)}\\right) = \\frac{t}{\\tau}\n$$\n对两边取指数：\n$$\n\\frac{C_{\\infty} - C_{\\mathrm{in}}}{C_{\\infty} - C_{\\mathrm{tip}}(t)} = \\exp\\left(\\frac{t}{\\tau}\\right)\n$$\n解出 $C_{\\mathrm{tip}}(t)$：\n$$\nC_{\\infty} - C_{\\mathrm{tip}}(t) = (C_{\\infty} - C_{\\mathrm{in}}) \\exp\\left(-\\frac{t}{\\tau}\\right)\n$$\n$$\nC_{\\mathrm{tip}}(t) = C_{\\infty} - (C_{\\infty} - C_{\\mathrm{in}}) \\exp\\left(-\\frac{t}{\\tau}\\right)\n$$\n该解描述了乳头顶渗透压浓度从其初始值 $C_{\\mathrm{in}}$ 向稳态值 $C_{\\infty}$ 演化的过程。\n\n如验证时所确定的，我们寻求系统完成其达到平衡过程的 $95\\%$ 时的时间 $t$。达到平衡的比例过程 $f(t)$ 定义为：\n$$\nf(t) = \\frac{C_{\\mathrm{tip}}(t) - C_{\\mathrm{tip}}(0)}{C_{\\infty} - C_{\\mathrm{tip}}(0)} = \\frac{C_{\\mathrm{tip}}(t) - C_{\\mathrm{in}}}{C_{\\infty} - C_{\\mathrm{in}}}\n$$\n代入 $C_{\\mathrm{tip}}(t)$ 的表达式：\n$$\nf(t) = \\frac{\\left(C_{\\infty} - (C_{\\infty} - C_{\\mathrm{in}}) \\exp\\left(-\\frac{t}{\\tau}\\right)\\right) - C_{\\mathrm{in}}}{C_{\\infty} - C_{\\mathrm{in}}} = \\frac{(C_{\\infty} - C_{\\mathrm{in}}) - (C_{\\infty} - C_{\\mathrm{in}}) \\exp\\left(-\\frac{t}{\\tau}\\right)}{C_{\\infty} - C_{\\mathrm{in}}}\n$$\n$$\nf(t) = 1 - \\exp\\left(-\\frac{t}{\\tau}\\right)\n$$\n我们将此完成比例设为目标值 $0.95$：\n$$\n0.95 = 1 - \\exp\\left(-\\frac{t}{\\tau}\\right)\n$$\n$$\n\\exp\\left(-\\frac{t}{\\tau}\\right) = 1 - 0.95 = 0.05\n$$\n对两边取自然对数：\n$$\n-\\frac{t}{\\tau} = \\ln(0.05)\n$$\n解出 $t$：\n$$\nt = -\\tau \\ln(0.05) = \\tau \\ln\\left(\\frac{1}{0.05}\\right) = \\tau \\ln(20)\n$$\n问题要求的是倍增周期的数量，一个周期定义为持续时间 $T$。因此，周期数 $N$ 是总时间 $t$ 除以一个周期的持续时间 $T$：\n$$\nN = \\frac{t}{T}\n$$\n问题陈述中指出，特征时间 $\\tau$ 等于通过时间 $T$，即 $\\tau = T$。将此代入 $N$ 的表达式：\n$$\nN = \\frac{T \\ln(20)}{T} = \\ln(20)\n$$\n现在，我们必须计算其数值并四舍五入到三位有效数字。\n$$\nN = \\ln(20) \\approx 2.995732...\n$$\n四舍五入到三位有效数字，得到：\n$$\nN \\approx 3.00\n$$\n此结果是无量纲的，符合要求。诸如 $L$ 和 $\\Delta C_{\\mathrm{s}}$ 等多余数据在计算中并未用到，因为计算只关注所提供模型描述的时间动力学。", "answer": "$$\\boxed{3.00}$$", "id": "2617879"}, {"introduction": "最终的渗透压梯度是溶质泵送、水渗透性以及血流清除之间精妙平衡的产物。这项高级计算练习要求您构建一个空间分辨模型，并用它来执行系统性的灵敏度分析。通过这项实践，您将能识别出哪些生理参数——例如 NKCC2 转运能力、降支水渗透性或直管血管血流量——对肾脏的浓缩能力具有最显著的控制作用，从而揭示该系统的关键设计特征和调控要点。[@problem_id:2617881]", "problem": "要求您实现并分析一个简化的、稳态的、一维的亨利氏环逆流倍增器模型，以量化三个生理参数如何影响最大尿渗透压浓度。该模型基于一个具有 $N$ 个节段的离散皮质-髓质轴。因变量是间质渗透压浓度分布 $\\{C_i\\}_{i=0}^{N-1}$（单位为 $\\mathrm{mOsm/kg}$）、降支管腔渗透压浓度 $\\{L_i\\}_{i=0}^{N-1}$ 和粗升支管腔渗透压浓度 $\\{U_i\\}_{i=0}^{N-1}$。参数分别是粗升支的钠-钾-氯化物协同转运蛋白（NKCC2）能力 $K$（单位为 $\\mathrm{s^{-1}}$）、降支的水渗透性 $P_w$（单位为 $\\mathrm{s^{-1}}$）和直管冲刷率 $F_{vr}$（单位为 $\\mathrm{s^{-1}}$）。皮质渗透压浓度固定为 $C_0 = 300\\,\\mathrm{mOsm/kg}$。使用步长为 $\\Delta t$ 的时间离散化松弛法来达到稳态。\n\n使用的基本原理和假设：\n- 跨膜的渗透性水运动由渗透压浓度差异驱动，对于小步长，可以近似为线性松弛：通量与渗透性和梯度成正比。在离散时间松弛形式中，这产生一个节段更新 $L \\leftarrow L + a_w (C - L)$，其中 $a_w = \\min(1, P_w \\Delta t)$。\n- 粗升支的主动溶质转运（通过钠-钾-氯化物协同转运蛋白）在操作点附近可以近似为与管腔到间质的渗透压浓度差异成正比的线性驱动力。在离散时间松弛形式中，通过 $U \\leftarrow U - \\Delta$ 降低管腔渗透压浓度，其中 $\\Delta = \\max\\{0, a_p (U - C)\\}$ 且 $a_p = \\min(1, K \\Delta t)$。$\\max$ 强制主动转运的单向性（没有从间质到管腔的泵送）。\n- 直管冲刷可以建模为间质向皮质渗透压浓度松弛的过程，速率为 $a_v = \\min(1, F_{vr} \\Delta t)$：$C \\leftarrow C - a_v (C - C_0)$。\n\n离散化和更新方案：\n- 选择 $N = 100$ 个节段，索引为 $i = 0, 1, \\dots, N-1$，从皮质（$i=0$）到乳头（$i=N-1$）。使用 $C_0 = 300\\,\\mathrm{mOsm/kg}$ 和 $\\Delta t = 0.05\\,\\mathrm{s}$。初始化 $C_i^{(0)} = C_0 + 10^{-3} i\\,\\mathrm{mOsm/kg}$ 以打破对称性。\n- 在每次迭代 $n \\to n+1$ 中，给定 $C_i^{(n)}$，计算：\n  1. 降支沿皮质-髓质轴从皮质到乳头的松弛过程：\n     - 设置 $L_{\\mathrm{in}} \\leftarrow C_0$。\n     - 对于 $i = 0$ 到 $N-1$：$L_{\\mathrm{out}} \\leftarrow L_{\\mathrm{in}} + a_w \\left(C_i^{(n)} - L_{\\mathrm{in}}\\right)$，存储 $L_i \\leftarrow L_{\\mathrm{out}}$，并设置 $L_{\\mathrm{in}} \\leftarrow L_{\\mathrm{out}}$。\n  2. 粗升支从乳头返回皮质的主动转运过程：\n     - 设置 $U \\leftarrow L_{N-1}$。\n     - 对于 $i = N-1$ 向下到 $0$：计算 $\\Delta_i \\leftarrow \\max\\left\\{0, a_p \\left(U - C_i^{(n)}\\right)\\right\\}$，设置 $U \\leftarrow U - \\Delta_i$，并存储 $U_i \\leftarrow U$。\n  3. 每个节段的间质更新，使用混合权重 $s_{\\mathrm{int}}$ 和 $s_{\\mathrm{wat}}$：\n     - 对于每个 $i$：$$C_i^{(n+1)} \\leftarrow C_i^{(n)} + s_{\\mathrm{int}} \\Delta_i + s_{\\mathrm{wat}} a_w \\left(L_i - C_i^{(n)}\\right) - a_v \\left(C_i^{(n)} - C_0\\right)$$。\n- 使用 $s_{\\mathrm{int}} = 0.5$ 和 $s_{\\mathrm{wat}} = 0.2$（无量纲）。迭代直到 $\\max_i \\left|C_i^{(n+1)} - C_i^{(n)}\\right|  \\tau$（其中 $\\tau = 10^{-6}\\,\\mathrm{mOsm/kg}$）或达到 $10^{5}$ 次迭代的硬上限，以先发生者为准。将稳态最大尿渗透压浓度定义为 $C_{\\max} = \\max_i C_i$，单位为 $\\mathrm{mOsm/kg}$。\n\n敏感性分析任务：\n- 对于给定的参数三元组 $(K, P_w, F_{vr})$，使用中心有限差分和相对扰动 $\\varepsilon = 0.1$ 计算 $C_{\\max}$ 对每个参数的局部、归一化、一次性敏感性：\n  - 对于参数 $p \\in \\{K, P_w, F_{vr}\\}$，其基线值为 $p_0$，定义 $p_{\\pm} = p_0 (1 \\pm \\varepsilon)$，并保持其他两个参数在基线值；计算 $C_{\\max}(p_{+})$ 和 $C_{\\max}(p_{-})$。\n  - 通过 $$\\frac{\\partial C_{\\max}}{\\partial p} \\approx \\frac{C_{\\max}(p_{+}) - C_{\\max}(p_{-})}{2 (p_{+} - p_{-})}$$ 近似偏导数。\n  - 定义归一化敏感性指数 $$S_p = \\frac{p_0}{C_{\\max}(p_0)} \\frac{\\partial C_{\\max}}{\\partial p}$$（无量纲）。\n- 按 $|S_p|$ 的降序（绝对值最大者优先）对三个参数进行排序。如果绝对值完全相等，则按参数名称的字典序打破平局。\n\n单位：\n- $C_i$、$C_0$ 和 $C_{\\max}$ 的单位为 $\\mathrm{mOsm/kg}$。\n- $K$、$P_w$ 和 $F_{vr}$ 的单位为 $\\mathrm{s^{-1}}$。\n- $\\Delta t$ 的单位为 $\\mathrm{s}$。\n\n测试套件：\n- 案例1（典型案例）：$(K, P_w, F_{vr}) = (3.0\\,\\mathrm{s^{-1}}, 0.8\\,\\mathrm{s^{-1}}, 0.05\\,\\mathrm{s^{-1}})$。\n- 案例2（增加冲刷）：$(K, P_w, F_{vr}) = (3.0\\,\\mathrm{s^{-1}}, 0.8\\,\\mathrm{s^{-1}}, 0.3\\,\\mathrm{s^{-1}})$。\n- 案例3（低NKCC2能力）：$(K, P_w, F_{vr}) = (0.5\\,\\mathrm{s^{-1}}, 0.8\\,\\mathrm{s^{-1}}, 0.05\\,\\mathrm{s^{-1}})$。\n- 案例4（高降支水渗透性）：$(K, P_w, F_{vr}) = (3.0\\,\\mathrm{s^{-1}}, 2.0\\,\\mathrm{s^{-1}}, 0.05\\,\\mathrm{s^{-1}})$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，包含一个含四个元素的列表，每个元素对应一个测试案例。每个元素本身是一个包含三个字符串的列表，给出按 $|S_p|$ 降序排列的参数名称。使用确切的参数名称字符串 \"NKCC2\"、\"Pw\" 和 \"VR\"。例如，一个有效的输出行格式为 [[\"NKCC2\",\"Pw\",\"VR\"],[\"VR\",\"NKCC2\",\"Pw\"],[\"...\"],[\"...\"]]。", "solution": "问题陈述已经过评估，被认为是有效的。它提出了一个清晰、自洽且计算上可行的问​​题，该问题基于一个简化但有科学依据的肾脏生理学模型。模型方程在量纲上是一致的，数值方案也定义明确。尽管提供的用于偏导数有限差分近似的公式 $\\frac{\\partial C_{\\max}}{\\partial p} \\approx \\frac{C_{\\max}(p_{+}) - C_{\\max}(p_{-})}{2 (p_{+} - p_{-})}$ 由于分母中多了一个因子2而是非标准的，但这并不妨碍最终目标的达成。敏感性的排序取决于敏感性指数的相对大小，而这不受此常数因子的影响。我们将精确地按照陈述来实现该公式。\n\n该任务要求实现一个数值模拟，以确定稳态的皮质-髓质渗透压梯度，并随后进行敏感性分析。解决方案分两部分构建：首先，开发迭代模型以计算给定参数集下的最大间质渗透压浓度 $C_{\\max}$；其次，应用此模型执行指定的敏感性分析。\n\n**1. 逆流倍增器的稳态模型**\n\n该模型将髓质离散化为 $N=100$ 个节段，从皮质到乳头索引为 $i=0, \\dots, N-1$。对三个关键生理过程进行建模，并通过迭代计算其效应，直到达到稳态。\n\n**参数和变量：**\n- 节段数：$N = 100$\n- 皮质渗透压浓度：$C_0 = 300 \\, \\mathrm{mOsm/kg}$\n- 松弛时间步长：$\\Delta t = 0.05 \\, \\mathrm{s}$\n- NKCC2 能力：$K \\, (\\mathrm{s^{-1}})$\n- 降支水渗透性：$P_w \\, (\\mathrm{s^{-1}})$\n- 直管冲刷率：$F_{vr} \\, (\\mathrm{s^{-1}})$\n- 间质混合权重：$s_{\\mathrm{int}} = 0.5$\n- 水混合权重：$s_{\\mathrm{wat}} = 0.2$\n- 收敛容差：$\\tau = 10^{-6} \\, \\mathrm{mOsm/kg}$\n- 因变量：间质渗透压浓度 $C_i$，降支渗透压浓度 $L_i$，升支渗透压浓度 $U_i$。\n\n迭代过程始于一个初始的间质分布 $C_i^{(0)} = C_0 + 10^{-3} i$ 以打破对称性。在每次迭代 $n \\to n+1$ 中，我们基于状态 $C^{(n)}$ 更新系统。首先定义无量纲的松弛速率常数：\n- 水转运速率：$a_w = \\min(1, P_w \\Delta t)$\n- 主动转运速率：$a_p = \\min(1, K \\Delta t)$\n- 直管冲刷速率：$a_v = \\min(1, F_{vr} \\Delta t)$\n\n更新通过三个连续的步骤进行：\n\n**步骤 1：降支（DL）水平衡**\n假设从近曲小管进入降支的液体与皮质等渗，即 $C_0$。当液体流向乳头时，水移出到高渗的间质中，从而浓缩管腔液体。这被建模为一个从皮质（$i=0$）到乳头（$i=N-1$）的松弛过程：\n- 进入节段 $i=0$ 的液体：$L_{\\mathrm{in}} \\leftarrow C_0$\n- 对于 $i = 0, \\dots, N-1$：\n$$L_{\\mathrm{out}} \\leftarrow L_{\\mathrm{in}} + a_w \\left(C_i^{(n)} - L_{\\mathrm{in}}\\right)$$\n计算出的离开节段的液体渗透压浓度 $L_{\\mathrm{out}}$ 被存储为 $L_i$，并成为下一个节段的输入，$L_{\\mathrm{in}} \\leftarrow L_{\\mathrm{out}}$。\n\n**步骤 2：粗升支（TAL）主动转运**\n在髓袢的转折处，来自降支的液体进入粗升支。在粗升支中，NKCC2 转运蛋白主动将溶质（主要是 $\\mathrm{NaCl}$ 和 $\\mathrm{K}^+$）从管腔泵入间质，稀释管腔液体。这个过程被建模为管腔渗透压浓度的降低，从乳头（$i=N-1$）流回皮质（$i=0$）：\n- 在转折处进入粗升支的液体：$U_{\\mathrm{in}} \\leftarrow L_{N-1}$\n- 对于 $i = N-1, \\dots, 0$:\n$$ \\Delta_i \\leftarrow \\max\\left\\{0, a_p \\left(U_{\\mathrm{in}} - C_i^{(n)}\\right)\\right\\} $$\n$$ U_{\\mathrm{out}} \\leftarrow U_{\\mathrm{in}} - \\Delta_i $$\n转运的溶质量 $\\Delta_i$ 被存储用于间质更新。新的管腔渗透压浓度 $U_{\\mathrm{out}}$ 被存储为 $U_i$，并成为向上的下一个节段的输入，$U_{\\mathrm{in}} \\leftarrow U_{\\mathrm{out}}$。\n\n**步骤 3：间质更新**\n每个节段的间质渗透压浓度根据三个相互竞争的效应进行更新：从粗升支增加的溶质、来自降支的水的稀释作用，以及直管对溶质的冲刷。从迭代 $n$ 到 $n+1$ 的间质浓度变化由下式给出：\n$$ C_i^{(n+1)} \\leftarrow C_i^{(n)} + s_{\\mathrm{int}} \\Delta_i + s_{\\mathrm{wat}} a_w \\left(L_i - C_i^{(n)}\\right) - a_v \\left(C_i^{(n)} - C_0\\right) $$\n这里的 $\\Delta_i$ 和 $L_i$ 是在当前迭代步骤中计算的值。该过程不断迭代，直到所有节段中间质渗透压浓度的最大变化低于容差 $\\tau$，即 $\\max_i \\left|C_i^{(n+1)} - C_i^{(n)}\\right|  \\tau$。稳态最大渗透压浓度即为 $C_{\\max} = \\max_i C_i$。\n\n**2. 敏感性分析**\n\n目标是根据参数 $p \\in \\{K, P_w, F_{vr}\\}$ 对 $C_{\\max}$ 的影响程度对其进行排序。这通过一个归一化的敏感性指数 $S_p$ 来量化。\n\n对于每个基线值为 $p_0$ 的参数 $p$，我们在受扰动的参数值 $p_{\\pm} = p_0 (1 \\pm \\varepsilon)$ 处计算 $C_{\\max}$，其中相对扰动为 $\\varepsilon = 0.1$。其他两个参数保持在其基线值。\n\n偏导数使用指定的中心差分公式近似：\n$$ \\frac{\\partial C_{\\max}}{\\partial p} \\approx \\frac{C_{\\max}(p_{+}) - C_{\\max}(p_{-})}{2 (p_{+} - p_{-})} = \\frac{C_{\\max}(p_0(1+\\varepsilon)) - C_{\\max}(p_0(1-\\varepsilon))}{2 (2 p_0 \\varepsilon)} = \\frac{C_{\\max}(p_{+}) - C_{\\max}(p_{-})}{4 p_0 \\varepsilon} $$\n归一化的敏感性指数 $S_p$ 定义为：\n$$ S_p = \\frac{p_0}{C_{\\max}(p_0)} \\frac{\\partial C_{\\max}}{\\partial p} $$\n代入偏导数的近似值，我们得到待计算的表达式：\n$$ S_p \\approx \\frac{p_0}{C_{\\max}(p_0)} \\left( \\frac{C_{\\max}(p_{+}) - C_{\\max}(p_{-})}{4 p_0 \\varepsilon} \\right) = \\frac{1}{4\\varepsilon} \\frac{C_{\\max}(p_{+}) - C_{\\max}(p_{-})}{C_{\\max}(p_0)} $$\n对于每个测试案例，我们计算 $S_K$、$S_{P_w}$ 和 $S_{F_{vr}}$，并按其敏感性指数的绝对值 $|S_p|$ 的降序对相应的参数名（\"NKCC2\"、\"Pw\"、\"VR\"）进行排序。平局通过参数名的字典序来打破。对测试套件中提供的每组基线参数执行此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_c_max(K, Pw, Fvr):\n    \"\"\"\n    Computes the steady-state maximal urine osmolality using the relaxation method.\n\n    Args:\n        K (float): NKCC2 capacity (s^-1).\n        Pw (float): Descending limb water permeability (s^-1).\n        Fvr (float): Vasa recta washout rate (s^-1).\n\n    Returns:\n        float: The maximal interstitial osmolality C_max (mOsm/kg).\n    \"\"\"\n    # ----- Model constants and discretization -----\n    N = 100  # Number of segments\n    C0 = 300.0  # Cortical osmolality (mOsm/kg)\n    dt = 0.05  # Time step (s)\n    s_int = 0.5  # Interstitial mixing weight (dimensionless)\n    s_wat = 0.2  # Water mixing weight (dimensionless)\n\n    # ----- Convergence parameters -----\n    tau = 1e-6  # Convergence tolerance (mOsm/kg)\n    max_iter = 100000  # Maximum number of iterations\n\n    # ----- Dimensionless relaxation rates -----\n    a_w = min(1.0, Pw * dt)\n    a_p = min(1.0, K * dt)\n    a_v = min(1.0, Fvr * dt)\n\n    # ----- Initialization -----\n    # Interstitial osmolality profile\n    C = C0 + 1e-3 * np.arange(N, dtype=np.float64)\n    # Profiles for descending and ascending limbs\n    L = np.zeros(N, dtype=np.float64)\n    U = np.zeros_like(L)\n    Delta_vals = np.zeros_like(L)\n\n    for n in range(max_iter):\n        C_old = np.copy(C)\n\n        # 1. Descending limb relaxation (cortex to papilla)\n        L_in = C0\n        for i in range(N):\n            L_out = L_in + a_w * (C[i] - L_in)\n            L[i] = L_out\n            L_in = L_out\n\n        # 2. Thick ascending limb active transport (papilla to cortex)\n        U_in = L[N - 1]\n        for i in range(N - 1, -1, -1):\n            delta_i = max(0.0, a_p * (U_in - C[i]))\n            Delta_vals[i] = delta_i\n            U_out = U_in - delta_i\n            U[i] = U_out\n            U_in = U_out\n\n        # 3. Interstitial update\n        # This is a vectorized implementation of the loop for performance.\n        C = C_old + s_int * Delta_vals + s_wat * a_w * (L - C_old) - a_v * (C_old - C0)\n\n        # Check for convergence\n        if np.max(np.abs(C - C_old))  tau:\n            break\n            \n    return np.max(C)\n\ndef solve():\n    \"\"\"\n    Main function to run the sensitivity analysis for all test cases.\n    \"\"\"\n    test_cases = [\n        (3.0, 0.8, 0.05),   # Case 1: happy path\n        (3.0, 0.8, 0.3),    # Case 2: increased washout\n        (0.5, 0.8, 0.05),   # Case 3: low NKCC2 capacity\n        (3.0, 2.0, 0.05),   # Case 4: high descending water permeability\n    ]\n\n    all_results = []\n    \n    param_names = [\"NKCC2\", \"Pw\", \"VR\"]\n    eps = 0.1 # Relative perturbation\n\n    for case in test_cases:\n        K0, Pw0, Fvr0 = case\n        \n        # Calculate baseline C_max\n        C_max_base = compute_c_max(K0, Pw0, Fvr0)\n        \n        sensitivities = []\n        \n        # --- Sensitivity for K (NKCC2) ---\n        K_p = K0 * (1 + eps)\n        K_m = K0 * (1 - eps)\n        C_max_p_K = compute_c_max(K_p, Pw0, Fvr0)\n        C_max_m_K = compute_c_max(K_m, Pw0, Fvr0)\n        # S_p = (1 / (4*eps)) * (C_max(p+) - C_max(p-)) / C_max(p0)\n        S_K = (1 / (4 * eps)) * (C_max_p_K - C_max_m_K) / C_max_base if C_max_base  0 else 0\n        sensitivities.append((param_names[0], S_K))\n\n        # --- Sensitivity for Pw ---\n        Pw_p = Pw0 * (1 + eps)\n        Pw_m = Pw0 * (1 - eps)\n        C_max_p_Pw = compute_c_max(K0, Pw_p, Fvr0)\n        C_max_m_Pw = compute_c_max(K0, Pw_m, Fvr0)\n        S_Pw = (1 / (4 * eps)) * (C_max_p_Pw - C_max_m_Pw) / C_max_base if C_max_base  0 else 0\n        sensitivities.append((param_names[1], S_Pw))\n\n        # --- Sensitivity for Fvr (VR) ---\n        Fvr_p = Fvr0 * (1 + eps)\n        Fvr_m = Fvr0 * (1 - eps)\n        C_max_p_Fvr = compute_c_max(K0, Pw0, Fvr_p)\n        C_max_m_Fvr = compute_c_max(K0, Pw0, Fvr_m)\n        S_Fvr = (1 / (4 * eps)) * (C_max_p_Fvr - C_max_m_Fvr) / C_max_base if C_max_base  0 else 0\n        sensitivities.append((param_names[2], S_Fvr))\n\n        # Rank parameters by descending absolute sensitivity.\n        # Tie-breaking by lexicographical order of parameter name.\n        sensitivities.sort(key=lambda item: (-abs(item[1]), item[0]))\n        \n        ranked_names = [item[0] for item in sensitivities]\n        all_results.append(ranked_names)\n\n    # Format the final output string\n    # e.g., [['NKCC2', 'Pw', 'VR'], ['VR', 'Pw', 'NKCC2']]\n    # Note: f-string with nested quotes requires care.\n    output_str = \"[\" + \",\".join([f'[\"{n1}\",\"{n2}\",\"{n3}\"]' for n1, n2, n3 in all_results]) + \"]\"\n\n    print(output_str)\n\nsolve()\n```", "id": "2617881"}]}