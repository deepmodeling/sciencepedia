{"hands_on_practices": [{"introduction": "这个练习将带领我们回到原点，从最基本的质量作用定律出发，推导配体-受体相互作用的核心方程。通过亲手计算不同配体浓度下的受体占有率，你将深刻理解解离常数 $K_d$ 的物理意义，并为后续更复杂的药理学模型打下坚实的定量基础。这项基础练习是理解剂量-反应关系的第一步 [@problem_id:2581941]。", "problem": "一个单室哺乳动物细胞表达一族G蛋白偶联受体（GPCR），每个细胞的总受体数量为 $R_T = 5 \\times 10^{4}$。一种单价配体与每个受体上的单个位点结合，其解离常数为 $K_d = 20\\,\\mathrm{nM}$。该细胞浸浴在充分搅拌的细胞外介质中，该介质如同一个巨大的储存库，其配体本体浓度 $[L]$ 恒定，因此单个细胞上受体结合所导致的配体消耗可以忽略不计。假设反应处于平衡状态，为一对一非协同结合，且下游信号传导的强度与被占据的受体分数成比例，直至达到通路特异性的阈值。\n\n仅从平衡反应 $\\mathrm{R} + \\mathrm{L} \\rightleftharpoons \\mathrm{RL}$ 的解离常数定义以及受体数量守恒出发，推导受体分数占有率作为 $[L]$ 和 $K_d$ 的函数表达式。然后，计算在 $[L] = 5\\,\\mathrm{nM}$、$[L] = 20\\,\\mathrm{nM}$ 和 $[L] = 100\\,\\mathrm{nM}$ 时的分数占有率。最后，在不引入任何额外唯象公式的情况下，简要解释这些占有率与GPCR通路中可能的下游信号阈值和受体储备有何关系。\n\n按 $[L] = 5\\,\\mathrm{nM}$、$20\\,\\mathrm{nM}$ 和 $100\\,\\mathrm{nM}$ 的顺序，以无单位小数形式报告这三个分数占有率。将每个值四舍五入至四位有效数字。", "solution": "问题要求推导受体分数占有率的表达式。让我们从第一性原理开始。\n\n配体 $\\mathrm{L}$ 与受体 $\\mathrm{R}$ 结合形成复合物 $\\mathrm{RL}$ 的过程由以下可逆反应描述：\n$$\n\\mathrm{R} + \\mathrm{L} \\rightleftharpoons \\mathrm{RL}\n$$\n在平衡状态下，正向和逆向反应的速率相等。解离常数 $K_d$ 定义为平衡时各物质浓度的比值：\n$$\nK_d = \\frac{[\\mathrm{R}][\\mathrm{L}]}{[\\mathrm{RL}]} \\quad (1)\n$$\n其中 $[\\mathrm{R}]$ 是游离受体的浓度，$[\\mathrm{L}]$ 是游离配体的浓度，$[\\mathrm{RL}]$ 是配体-受体复合物的浓度。\n\n问题陈述了总受体守恒。设总受体浓度为 $[R_T]$。该总浓度是游离受体浓度与配体结合受体浓度之和：\n$$\n[R_T] = [\\mathrm{R}] + [\\mathrm{RL}] \\quad (2)\n$$\n根据这个守恒定律，我们可以将游离受体的浓度表示为：\n$$\n[\\mathrm{R}] = [R_T] - [\\mathrm{RL}] \\quad (3)\n$$\n将方程 $(3)$ 代入解离常数的定义，即方程 $(1)$，我们得到：\n$$\nK_d = \\frac{([R_T] - [\\mathrm{RL}])[\\mathrm{L}]}{[\\mathrm{RL}]}\n$$\n我们的目标是推导受体分数占有率 $\\theta$ 的表达式，其定义为与配体结合的受体占总受体的比例：\n$$\n\\theta = \\frac{[\\mathrm{RL}]}{[R_T]} \\quad (4)\n$$\n为了求得此值，我们必须首先从 $K_d$ 的表达式中解出 $[\\mathrm{RL}]$。\n$$\nK_d [\\mathrm{RL}] = ([R_T] - [\\mathrm{RL}])[\\mathrm{L}]\n$$\n$$\nK_d [\\mathrm{RL}] = [R_T][\\mathrm{L}] - [\\mathrm{RL}][\\mathrm{L}]\n$$\n$$\nK_d [\\mathrm{RL}] + [\\mathrm{RL}][\\mathrm{L}] = [R_T][\\mathrm{L}]\n$$\n$$\n[\\mathrm{RL}] (K_d + [\\mathrm{L}]) = [R_T][\\mathrm{L}]\n$$\n$$\n[\\mathrm{RL}] = \\frac{[R_T][\\mathrm{L}]}{K_d + [\\mathrm{L}]} \\quad (5)\n$$\n现在，为了求得分数占有率 $\\theta$，我们根据定义 $(4)$ 将方程 $(5)$ 的两边同时除以 $[R_T]$：\n$$\n\\theta = \\frac{[\\mathrm{RL}]}{[R_T]} = \\frac{1}{[R_T]} \\left( \\frac{[R_T][\\mathrm{L}]}{K_d + [\\mathrm{L}]} \\right)\n$$\n这可以简化为最终推导出的分数占有率表达式，也称为非协同结合的Hill-Langmuir方程：\n$$\n\\theta = \\frac{[\\mathrm{L}]}{K_d + [\\mathrm{L}]}\n$$\n请注意，分数占有率 $\\theta$ 与总受体数 $R_T$ 无关，该值为 $5 \\times 10^{4}$，但在计算的这一部分中并不需要。\n\n接下来，我们针对给定值计算 $\\theta$。解离常数为 $K_d = 20\\,\\mathrm{nM}$。\n\n情况1：配体浓度 $[L] = 5\\,\\mathrm{nM}$。\n$$\n\\theta_1 = \\frac{5\\,\\mathrm{nM}}{20\\,\\mathrm{nM} + 5\\,\\mathrm{nM}} = \\frac{5}{25} = 0.2\n$$\n四舍五入到四位有效数字，结果为 $0.2000$。\n\n情况2：配体浓度 $[L] = 20\\,\\mathrm{nM}$。\n$$\n\\theta_2 = \\frac{20\\,\\mathrm{nM}}{20\\,\\mathrm{nM} + 20\\,\\mathrm{nM}} = \\frac{20}{40} = 0.5\n$$\n这个结果是预料之中的，因为解离常数 $K_d$ 的定义就是一半受体被占据时的配体浓度。四舍五入到四位有效数字，结果为 $0.5000$。\n\n情况3：配体浓度 $[L] = 100\\,\\mathrm{nM}$。\n$$\n\\theta_3 = \\frac{100\\,\\mathrm{nM}}{20\\,\\mathrm{nM} + 100\\,\\mathrm{nM}} = \\frac{100}{120} = \\frac{5}{6} \\approx 0.833333...\n$$\n四舍五入到四位有效数字，结果为 $0.8333$。\n\n最后，我们被要求在信号阈值和受体储备的背景下解释这些结果。\n分数占有率值 $0.2000$、$0.5000$ 和 $0.8333$ 代表在每种配体浓度下，总共 $5 \\times 10^{4}$ 个受体中被激活的比例。下游信号传导由这些被激活的受体引发。\n触发可测量的细胞反应可能需要一个最小的分数占有率，即阈值。例如，如果某个通路的阈值为 $\\theta > 0.25$，那么 $5\\,\\mathrm{nM}$ 的配体浓度（$\\theta=0.2000$）将不足以引起反应，而 $20\\,\\mathrm{nM}$ 的配体浓度（$\\theta=0.5000$）则足够。\n“受体储备”或“备用受体”的概念与以下观察有关：在许多GPCR系统中，在分数占有率远小于 $1$ 时即可达到最大的生物学效应。例如，如果该细胞系统在 $[L] = 20\\,\\mathrm{nM}$（此时 $\\theta = 0.5000$）时表现出最大效应，这将意味着只需要激活总受体的 $50\\%$。剩下 $50\\%$ 未被占据或多余的受体构成了受体储备。这种储备使细胞具有高灵敏度，能在远低于受体饱和所需配体浓度的情况下产生最大效应。相反，如果最大效应需要高配体浓度，例如 $[L] = 100\\,\\mathrm{nM}$ 或更高，这将表明受体储备很小或可以忽略不计，此时信号反应与被占据的受体总数更直接地成正比。在没有关于细胞反应的实验数据的情况下，我们只能将这些陈述为基于占有率与反应之间关系的各种可能性。", "answer": "$$\\boxed{\\begin{pmatrix} 0.2000 & 0.5000 & 0.8333 \\end{pmatrix}}$$", "id": "2581941"}, {"introduction": "在第一个练习的基础上，我们现在探讨一个更深入的问题：受体结合如何转化为生理响应。这个练习引入了内在效能和受体储备这两个关键的药理学概念，揭示了为何一个“部分激动剂”在特定系统中仍能产生完全的生物学效应。通过这个思想实验，你将学会区分受体占有率和系统刺激，从而更精确地分析药物作用 [@problem_id:2581932]。", "problem": "在表达单一类型膜受体的生理组织中，对激动剂的级量反应被归一化，使得系统可达到的最大反应等于$1$。设受体占据分数由经典质量作用关系 $\\theta = \\frac{[A]}{[A] + K_{d}}$ 给出，其中 $[A]$ 是激动剂浓度，$K_{d}$ 是解离常数。定义激动剂产生的刺激与其内在效能 $\\epsilon$ 和受体占据分数 $\\theta$ 的乘积成正比。该组织拥有储备受体：当只有分数 $f_{\\mathrm{req}}$ 的受体被占据时，一个完全激动剂（内在效能 $\\epsilon = 1$）就能引起最大系统反应。储备受体分数为 $0.6$，意味着一个完全激动剂只需占据 $1 - 0.6 = 0.4$ 的受体即可达到最大系统反应。\n\n一个测试配体是部分激动剂，其内在效能为 $\\epsilon = 0.4$，解离常数为 $K_{d} = 50 \\ \\mathrm{nM}$。基于受体占据的基本原理和上述储备受体的定义，确定当激动剂浓度 $[A]$ 可以在所有正值上变化时，该部分激动剂所能达到的最大反应（相对于完全激动剂的最大系统反应）。\n\n将最终答案表示为一个无单位的小数比率，并四舍五入到四位有效数字。", "solution": "激动剂结合与组织反应之间的关系可以通过一个两步过程来建模：首先是产生刺激，然后是将该刺激转导为可测量的反应。\n\n设 $S$ 为激动剂产生的刺激。根据问题陈述，刺激与激动剂的内在效能 $\\epsilon$ 和受体占据分数 $\\theta$ 的乘积成正比。我们可以将这种关系表示为：\n$$S = k \\epsilon \\theta$$\n其中 $k$ 是一个比例常数，它考虑了诸如总受体密度等因素。\n\n设 $R$ 为归一化系统反应，它是刺激的函数，即 $R = f(S)$。函数 $f(S)$ 是一个单调递增函数，满足 $f(0) = 0$ 且最大值为 $1$。\n\n我们已知，一个内在效能为 $\\epsilon_{\\text{full}} = 1$ 的完全激动剂，在占据分数为 $\\theta = f_{\\mathrm{req}} = 0.4$ 时，会引起最大系统反应 $R=1$。这个信息使我们能够确定达到最大反应所需的最小刺激。我们将此阈值刺激表示为 $S_{\\text{req}}$。\n$$S_{\\text{req}} = k \\cdot \\epsilon_{\\text{full}} \\cdot f_{\\mathrm{req}} = k \\cdot (1) \\cdot (0.4) = 0.4k$$\n刺激-反应函数 $f(S)$ 的性质是，对于任何刺激 $S \\geq S_{\\text{req}}$，反应都达到最大值，即 $f(S) = 1$。\n\n接下来，我们分析内在效能为 $\\epsilon_{\\text{p}} = 0.4$ 的部分激动剂测试配体。我们需要确定该配体能产生的最大反应 $R_{\\text{p,max}}$。最大反应发生在配体能产生的最大可能刺激 $S_{\\text{p,max}}$ 处。\n\n当激动剂浓度 $[A]$ 达到饱和（$[A] \\to \\infty$）时，可以获得最大刺激。在饱和浓度下，受体占据分数 $\\theta$ 接近其最大值 $1$。\n$$\\theta_{\\text{max}} = \\lim_{[A]\\to\\infty} \\frac{[A]}{[A] + K_{d}} = 1$$\n注意，这个最大占据率不依赖于解离常数 $K_{d}$ 的值。因此，给定的 $K_{d, \\text{p}} = 50 \\ \\mathrm{nM}$ 值对于求解最大反应不是必需的。\n\n该部分激动剂能产生的最大刺激是：\n$$S_{\\text{p,max}} = k \\cdot \\epsilon_{\\text{p}} \\cdot \\theta_{\\text{max}} = k \\cdot (0.4) \\cdot (1) = 0.4k$$\n\n现在，我们将部分激动剂产生的最大刺激 $S_{\\text{p,max}}$ 与达到最大系统反应所需的刺激 $S_{\\text{req}}$ 进行比较。\n$$S_{\\text{p,max}} = 0.4k$$\n$$S_{\\text{req}} = 0.4k$$\n我们发现 $S_{\\text{p,max}} = S_{\\text{req}}$。\n\n该部分激动剂的最大反应是由其最大刺激产生的反应：\n$$R_{\\text{p,max}} = f(S_{\\text{p,max}})$$\n由于 $S_{\\text{p,max}} = S_{\\text{req}}$，并且我们知道任何等于或大于 $S_{\\text{req}}$ 的刺激都会产生等于 $1$ 的最大系统反应，因此可得：\n$$R_{\\text{p,max}} = f(S_{\\text{req}}) = 1$$\n这个结果表明，在一个具有显著储备受体的系统中，一个根据其内在效能 $\\epsilon < 1$ 被分类为部分激动剂的配体，仍然可以起到完全激动剂的作用，能够引起可能的最大组织反应。\n\n问题要求的是部分激动剂的最大反应相对于完全激动剂的最大系统反应的比值。最大系统反应被归一化为 $1$。计算得出的部分激动剂的最大反应也是 $1$。因此，比值为：\n$$\\text{Ratio} = \\frac{R_{\\text{p,max}}}{R_{\\text{max\\_sys}}} = \\frac{1}{1} = 1$$\n\n按照要求，我们将此答案表示为四舍五入到四位有效数字的小数比率。", "answer": "$$\\boxed{1.000}$$", "id": "2581932"}, {"introduction": "最后的这个实践将我们从经典的确定性模型带入现代系统生物学的随机世界，这对于理解低分子数量下的细胞过程至关重要。通过编写一个计算模拟程序，你将亲眼观察到空间组织（如受体聚类）如何降低信号传导中的噪声并提高信息传输的保真度。这项练习引入了信息论中的强大概念，为定量评估信号通路的性能提供了一个全新的框架 [@problem_id:2581921]。", "problem": "要求您形式化并模拟一个最小化的受体介导的激酶激活随机模型，以检验聚类如何降低噪声并量化信息传输。请从以下基于配体-受体结合和随机抽样的基本定义和假设入手。\n\n基本基础：\n- 对于一个拥有 $N_R$ 个相同受体的细胞，这些受体被分成大小为 $m$ 的簇，簇的数量为 $N_c = N_R / m$（假设 $m$ 能被 $N_R$ 整除）。\n- 在配体浓度为 $L$、解离常数为 $K_d$ 时，假设结合是独立的，则平衡态下受体的占据概率为 $p(L) = \\dfrac{L}{L + K_d}$。\n- 在一个包含 $m$ 个受体的簇内，已结合受体的数量 $X$ 服从二项分布 $X \\sim \\mathrm{Binomial}(m, p)$，因此经验平均占据率为 $\\bar{X} = X / m$，其期望为 $\\mathbb{E}[\\bar{X}] = p$，方差为 $\\mathrm{Var}(\\bar{X}) = \\dfrac{p (1-p)}{m}$。\n- 下游激酶的激活被建模为对带噪声的平均占据率的逐簇阈值检测器：对于每个簇，定义 $Y = \\mathbf{1}\\{\\bar{X} + \\eta \\ge \\theta\\}$，其中 $\\eta \\sim \\mathcal{N}(0, \\sigma^2)$ 是独立的加性内在噪声，$\\theta$ 是一个固定阈值。每个细胞的总激酶激活计数为 $K = \\sum_{c=1}^{N_c} Y_c$。\n- 输入变量 $L$ 将被视为一个离散随机变量，在一个有限集合中取值，且具有相等的先验概率。输出变量是离散的激酶计数 $K \\in \\{0,1,\\dots,N_c\\}$。\n\n您的程序必须实现以下规范。\n\n使用的模型参数：\n- 每个细胞的总受体数：$N_R = 100$。\n- 待测试的簇大小（这些定义了测试套件）：$m \\in \\{1, 5, 10, 20, 100\\}$，因此对应的 $N_c \\in \\{100, 20, 10, 5, 1\\}$。\n- 配体解离常数：$K_d = 1.0$。\n- 用于编码输入的配体浓度：$\\mathcal{L} = \\{0.1, 1.0, 10.0\\}$，每个浓度的先验概率均为 $1/3$。\n- 阈值：$\\theta = 0.5$。\n- 每个簇的内在噪声标准差：$\\sigma = 0.1$。\n- 每个配体值下独立模拟的细胞数量：$N_{\\text{cells}} = 20000$。\n- 随机数生成器种子：设置一个固定的种子值 $123$ 以确保可复现性。\n\n程序必须对测试套件中的每个簇大小 $m$ 执行以下任务：\n1) 模拟激酶计数。对于每个 $L \\in \\mathcal{L}$，计算 $p(L) = \\dfrac{L}{L + K_d}$。对于 $N_c$ 个簇中的每一个以及 $N_{\\text{cells}}$ 个模拟细胞中的每一个，从 $X \\sim \\mathrm{Binomial}(m, p(L))$ 中抽样，计算 $\\bar{X} = X/m$，添加内在噪声 $\\eta \\sim \\mathcal{N}(0, \\sigma^2)$，进行阈值处理以获得 $Y = \\mathbf{1}\\{\\bar{X} + \\eta \\ge \\theta\\}$，然后对所有簇求和，得到该模拟细胞的 $K \\in \\{0,\\dots,N_c\\}$。对于每个 $L$，这将导出一个经验条件分布 $P(K \\mid L)$，并在 $L$ 的均匀先验下导出一个无条件分布 $P(K)$。\n2) 噪声量化。在中间配体浓度 $L = 1.0$（即 $p(L) = 0.5$ 时对应的浓度值）下，计算变异系数 $\\mathrm{CV} = \\dfrac{\\sqrt{\\mathrm{Var}(K \\mid L = 1.0)}}{\\mathbb{E}[K \\mid L = 1.0]}$。将此结果作为一个无量纲量报告，并四舍五入到小数点后四位。如果 $\\mathbb{E}[K \\mid L = 1.0] = 0$，则按惯例定义 $\\mathrm{CV} = 0$。\n3) 信息传输度量。使用互信息（MI）来量化从离散输入 $L \\in \\mathcal{L}$ 到离散输出 $K$ 所传输的信息。计算以比特为单位的 Shannon 互信息，其定义为\n$$\nI(L;K) = \\sum_{l \\in \\mathcal{L}} \\sum_{k=0}^{N_c} P(l,k)\\, \\log_2 \\left( \\frac{P(l,k)}{P(l)\\, P(k)} \\right),\n$$\n其中 $P(l,k)$ 是从仿真中估计出的联合分布，$P(l) = 1/3$ 是三种配体值的先验概率。为了避免有限抽样中的零概率问题，使用伪计数为 $\\alpha = 1$ 的 Laplace 平滑：如果 $n(l,k)$ 是所有模拟细胞的原始联合计数，则计算 $n_\\alpha(l,k) = n(l,k) + \\alpha$ 并进行归一化以获得 $P_\\alpha(l,k) = \\dfrac{n_\\alpha(l,k)}{\\sum_{l,k} n_\\alpha(l,k)}$。在评估 $I(L;K)$ 时，使用 $P_\\alpha(l,k)$ 及其对应的边际分布 $P_\\alpha(l)$ 和 $P_\\alpha(k)$ 来代替 $P(l,k)$。将 $I(L;K)$ 以比特为单位报告，并四舍五入到小数点后四位。\n4) 输出格式。您的程序应生成单行输出，其中包含五个测试用例的结果，格式为一个由方括号括起来的逗号分隔列表。每个测试用例的结果本身必须是一个形如 $[m, I\\_\\text{bits}, \\mathrm{CV}]$ 的列表，其中 $m$ 是作为整数的簇大小，$I\\_\\text{bits}$ 是以比特为单位、四舍五入到小数点后四位的浮点数互信息，$\\mathrm{CV}$ 是在 $L = 1.0$ 时、四舍五入到小数点后四位的浮点数变异系数。例如，包含两个测试用例的结果看起来像这样：$[[m\\_1,I\\_1,\\mathrm{CV}\\_1],[m\\_2,I\\_2,\\mathrm{CV}\\_2]]$；在您的情况下，请按升序包含所有五个指定的 $m$ 值。\n\n指导您实现的科学真实性和基本原理：\n- 每个簇的受体占据率的二项抽样形式化了独立结合与大数定律：$\\bar{X}$ 的方差与 $1/m$ 成比例，因此更大的簇能减少上游采样噪声。\n- 内在噪声 $\\eta$ 模拟了下游的生物化学变异性，并确保了非简并的阈值响应。\n- 对簇级阈值输出求和，模拟了一个固定模式的激酶激活计数，而计算变异系数则将固定输入下的噪声进行了操作化度量。\n- 以比特为单位的互信息是一种基于信息论的、有原则的信号传导信息传输度量，它通过对经验联合分布进行平滑处理来减轻有限样本伪影，然后直接计算得出。\n\n不涉及角度单位。输出不需要物理单位：$I(L;K)$ 必须以比特为单位报告，$\\mathrm{CV}$ 是无量纲的。请确保所有报告的数值结果都按要求四舍五入到小数点后四位。", "solution": "该问题要求对受体介导的激酶激活的随机模型进行形式化和模拟。我们将分析受体聚类如何影响信号噪声和信息传输。解决方案包括三个主要阶段：(1) 基于所提供的生物物理模型模拟激酶激活计数，(2) 使用变异系数（CV）量化输出噪声，以及 (3) 使用互信息（MI）量化从配体输入到激酶输出的信息传输。\n\n**1. 模型形式化与模拟**\n\n该系统由一个细胞组成，总共含有 $N_R = 100$ 个受体。这些受体被组织成 $N_c$ 个簇，每个簇的大小为 $m$，因此有 $N_c = N_R / m$。测试用例对应于 $m \\in \\{1, 5, 10, 20, 100\\}$。\n\n系统的输入是配体浓度 $L$，它是一个离散随机变量，从集合 $\\mathcal{L} = \\{0.1, 1.0, 10.0\\}$ 中取值，对于每个 $l \\in \\mathcal{L}$，其均匀先验概率为 $P(l) = 1/3$。配体与受体的结合是一个独立的随机事件。单个受体在平衡状态下被占据（结合）的概率由 Hill-Langmuir 方程给出：\n$$\np(L) = \\frac{L}{L + K_d}\n$$\n其中解离常数给定为 $K_d = 1.0$。\n\n在大小为 $m$ 的单个簇内，已结合受体的数量 $X$ 服从二项分布，因为它代表了 $m$ 次独立伯努利试验的总和，每次试验的成功概率为 $p(L)$：\n$$\nX \\sim \\mathrm{Binomial}(m, p(L))\n$$\n该簇的经验平均占据率为 $\\bar{X} = X/m$。根据大数定律，随着 $m$ 的增加，该均值的方差 $\\mathrm{Var}(\\bar{X}) = p(L)(1-p(L))/m$ 会减小。这代表了通过受体聚类减少了上游采样噪声。\n\n如果一个簇的带噪声的平均占据率 $\\bar{X} + \\eta$ 超过一个固定阈值 $\\theta = 0.5$，则该簇被激活。项 $\\eta$ 代表下游的内在噪声，被建模为一个均值为 $0$、方差为 $\\sigma^2$ 的高斯随机变量，其中 $\\sigma = 0.1$。因此，单个簇的激活 $Y_c$ 是一个二元事件：\n$$\nY_c = \\mathbf{1}\\{\\bar{X_c} + \\eta_c \\ge \\theta\\}\n$$\n其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。\n\n细胞的总激酶激活计数 $K$ 是所有 $N_c$ 个簇的激活之和，这些簇被假定为独立的：\n$$\nK = \\sum_{c=1}^{N_c} Y_c\n$$\n$K$ 的可能取值范围是从 $0$ 到 $N_c$。\n\n模拟过程通过遍历每个簇大小 $m$ 来进行。对于每个 $m$ 和每个配体浓度 $L \\in \\mathcal{L}$，我们模拟 $N_{\\text{cells}} = 20000$ 个独立的细胞。对于每个模拟的细胞，我们执行 $N_c$ 次簇级模拟来计算总激酶计数 $K$。这个过程生成了经验条件概率分布 $P(K|L)$，并存储为一个联合计数矩阵 $n(l,k)$。使用固定的随机种子 $123$ 来确保可复现性。\n\n**2. 噪声量化：变异系数 (CV)**\n\n为了量化信号噪声，我们在固定的输入配体浓度 $L = 1.0$ 下计算激酶计数 $K$ 的变异系数（CV）。CV 是一种标准化的、无量纲的离散程度度量，定义为标准差与均值的比率：\n$$\n\\mathrm{CV}_K = \\frac{\\sigma_K}{\\mu_K} = \\frac{\\sqrt{\\mathrm{Var}(K \\mid L=1.0)}}{\\mathbb{E}[K \\mid L=1.0]}\n$$\n均值 $\\mathbb{E}[K \\mid L=1.0]$ 和方差 $\\mathrm{Var}(K \\mid L=1.0)$ 是使用为 $L=1.0$ 获得的 $N_{\\text{cells}}$ 个模拟的 $K$ 值的样本均值和样本方差来估计的。选择 $L=1.0$ 是有意义的，因为它对应于 $p(L=1.0) = 1.0 / (1.0 + 1.0) = 0.5$，这是二项抽样方差最大的点。按照惯例，如果平均激酶计数为零，则 CV 定义为零。\n\n**3. 信息传输：互信息 (MI)**\n\n为了量化输出的激酶计数 $K$ 提供了多少关于输入配体浓度 $L$ 的信息，我们使用 Shannon 互信息 $I(L;K)$。其定义如下：\n$$\nI(L;K) = \\sum_{l \\in \\mathcal{L}} \\sum_{k=0}^{N_c} P(l,k) \\log_2 \\left( \\frac{P(l,k)}{P(l)P(k)} \\right)\n$$\n其中 $P(l,k)$ 是 $L$ 和 $K$ 的联合概率分布，$P(l)$ 和 $P(k)$ 分别是它们的边际分布。结果以比特为单位度量。\n\n由于模拟次数有限（$N_{\\text{total}} = |\\mathcal{L}| \\times N_{\\text{cells}} = 3 \\times 20000$），某些 $(l,k)$ 对的计数可能为零，这会导致有问题的零概率和未定义的对数。为减轻这种有限抽样伪影并减少偏差，我们采用 Laplace 平滑（或加一规则）。我们将伪计数 $\\alpha = 1$ 添加到原始联合计数矩阵 $n(l,k)$ 的每个条目中：\n$$\nn_\\alpha(l,k) = n(l,k) + \\alpha\n$$\n然后通过对这些平滑后的计数进行归一化来计算平滑的联合概率分布 $P_\\alpha(l,k)$：\n$$\nP_\\alpha(l,k) = \\frac{n_\\alpha(l,k)}{\\sum_{l' \\in \\mathcal{L}} \\sum_{k'=0}^{N_c} n_\\alpha(l',k')}\n$$\n从这个平滑的联合分布中，我们计算出平滑的边际分布 $P_\\alpha(l) = \\sum_k P_\\alpha(l,k)$ 和 $P_\\alpha(k) = \\sum_l P_\\alpha(l,k)$。然后将这些平滑的分布代入互信息公式进行最终计算：\n$$\nI(L;K) = \\sum_{l \\in \\mathcal{L}} \\sum_{k=0}^{N_c} P_\\alpha(l,k) \\log_2 \\left( \\frac{P_\\alpha(l,k)}{P_\\alpha(l)P_\\alpha(k)} \\right)\n$$\n对于每个簇大小 $m$ 的配置，此过程为信号系统传输的信息提供了一个稳健的估计。最终计算出的 CV 和 MI 值按要求四舍五入到小数点后四位。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Formalizes and simulates a stochastic model of receptor-mediated kinase activation\n    to examine the effects of clustering on noise and information transmission.\n    \"\"\"\n    # Define the test cases and model parameters from the problem statement.\n    NR = 100\n    m_values = [1, 5, 10, 20, 100]\n    Kd = 1.0\n    L_values = np.array([0.1, 1.0, 10.0])\n    theta = 0.5\n    sigma = 0.1\n    N_cells = 20000\n    seed = 123\n    alpha = 1.0  # Laplace smoothing pseudo-count\n\n    # Initialize the random number generator with a fixed seed for reproducibility.\n    rng = np.random.default_rng(seed)\n    \n    overall_results = []\n\n    for m in m_values:\n        Nc = NR // m\n        \n        # This matrix will store the raw counts n(l, k).\n        # Dimensions are (number of ligand values) x (max kinase count + 1).\n        joint_counts = np.zeros((len(L_values), Nc + 1))\n        \n        # This will store the kinase counts K for L=1.0 to calculate the CV.\n        K_at_L1 = None\n\n        for l_idx, L in enumerate(L_values):\n            # 1) Simulation of kinase counts.\n            # Calculate receptor occupancy probability.\n            p = L / (L + Kd)\n            \n            # Vectorized simulation for all cells and clusters for the current L.\n            # X: number of bound receptors per cluster. Shape: (N_cells, Nc).\n            X = rng.binomial(m, p, size=(N_cells, Nc))\n            \n            # x_bar: mean occupancy per cluster.\n            x_bar = X / m\n            \n            # eta: intrinsic noise per cluster.\n            eta = rng.normal(0, sigma, size=(N_cells, Nc))\n            \n            # Y: cluster activation indicator (1 if active, 0 otherwise).\n            Y = (x_bar + eta >= theta).astype(int)\n            \n            # K: total kinase activation count per cell. Shape: (N_cells,).\n            K_per_cell = np.sum(Y, axis=1)\n            \n            # If current ligand is L=1.0, save the K counts for CV calculation.\n            if L == 1.0:\n                K_at_L1 = K_per_cell.copy()\n            \n            # Tally the simulation results into the joint count matrix.\n            # np.bincount efficiently creates a histogram of the integer counts.\n            counts = np.bincount(K_per_cell, minlength=Nc + 1)\n            joint_counts[l_idx, :] = counts\n\n        # 2) Noise quantification (CV).\n        if K_at_L1 is None:\n            # This case should not be reached with the given L_values.\n            cv = 0.0\n        else:\n            mean_K = np.mean(K_at_L1)\n            # By convention, if mean is 0, CV is 0.\n            if mean_K == 0:\n                cv = 0.0\n            else:\n                var_K = np.var(K_at_L1)\n                cv = np.sqrt(var_K) / mean_K\n        \n        # 3) Information transmission metric (MI).\n        # Apply Laplace smoothing to the raw counts.\n        smoothed_counts = joint_counts + alpha\n        \n        # Calculate the smoothed joint and marginal probability distributions.\n        total_smoothed_counts = np.sum(smoothed_counts)\n        P_lk = smoothed_counts / total_smoothed_counts\n        \n        # Marginals are calculated from the smoothed joint distribution.\n        P_l = np.sum(P_lk, axis=1, keepdims=True)\n        P_k = np.sum(P_lk, axis=0, keepdims=True)\n        \n        # MI calculation. With smoothing, P_lk, P_l, P_k are all > 0, so log2 is safe.\n        term_inside_log = P_lk / (P_l * P_k)\n        log_term = np.log2(term_inside_log)\n        mi_bits = np.sum(P_lk * log_term)\n        \n        # Format the result string for the current cluster size m.\n        result_str = f\"[{m},{mi_bits:.4f},{cv:.4f}]\"\n        overall_results.append(result_str)\n\n    # Final print statement in the exact required format.\n    final_output_str = f\"[{','.join(overall_results)}]\"\n    print(final_output_str)\n\nsolve()\n```", "id": "2581921"}]}