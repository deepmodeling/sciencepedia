{"hands_on_practices": [{"introduction": "本练习为理解盐度胁迫下的离子转运奠定了生物物理学基础。学生必须掌握，离子跨膜运动不仅由浓度梯度决定，还受到电化学势的共同影响。通过计算必需离子钾（$\\mathrm{K}^+$）和有毒离子钠（$\\mathrm{Na}^+$）的能斯特电位及其驱动力，学生将从数量上理解为何盐胁迫会构成双重威胁，从而为后续理解主动转运机制的必要性奠定基础。[@problem_id:2563981]", "problem": "一个盐生植物的根表皮细胞暴露于盐渍土壤溶液中。假设细胞膜对单价阳离子具有选择性渗透性，并且活度可以用浓度来近似（理想稀溶液）。对于每种离子，在达到热力学平衡时，其跨质膜的电化学势在两侧必须相等，即对于价态为 $z$ 的离子，胞质溶胶和质外体之间的电化学势 $\\mu$ 满足 $\\mu^{\\circ} + RT \\ln a_{\\mathrm{in}} + z F \\psi_{\\mathrm{in}} = \\mu^{\\circ} + RT \\ln a_{\\mathrm{out}} + z F \\psi_{\\mathrm{out}}$，其中 $R$ 是通用气体常数，$T$ 是绝对温度，$F$ 是法拉第常数，$a$ 是活度，$\\psi$ 是电势。在理想稀溶液近似下，取 $a \\approx [\\cdot]$，即摩尔浓度。\n\n已知：\n- 温度 $T = 298.15\\ \\mathrm{K}$，\n- 通用气体常数 $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$，\n- 法拉第常数 $F = 96485.33212\\ \\mathrm{C\\,mol^{-1}}$，\n- $\\mathrm{K}^{+}$ 和 $\\mathrm{Na}^{+}$ 的价态均为 $z = +1$，\n- 胞质溶胶浓度 $[\\mathrm{K}^{+}]_{\\mathrm{in}} = 100\\ \\mathrm{mM}$ 和 $[\\mathrm{Na}^{+}]_{\\mathrm{in}} = 20\\ \\mathrm{mM}$，\n- 质外体浓度 $[\\mathrm{K}^{+}]_{\\mathrm{out}} = 10\\ \\mathrm{mM}$ 和 $[\\mathrm{Na}^{+}]_{\\mathrm{out}} = 200\\ \\mathrm{mM}$，\n- 膜电位（胞质溶胶相对于质外体）$V_{m} = -120\\ \\mathrm{mV}$。\n\n任务：\n1. 根据电化学势相等，推导单价阳离子的平衡电位 $E_{\\mathrm{ion}}$，用 $R$、$T$、$F$ 以及浓度比 $[\\mathrm{out}]/[\\mathrm{in}]$ 表示。\n2. 计算平衡电位 $E_{\\mathrm{K}}$ 和 $E_{\\mathrm{Na}}$（均以 $\\mathrm{mV}$ 为单位表示）。\n3. 使用驱动力 $\\Delta V_{\\mathrm{ion}} = V_{m} - E_{\\mathrm{ion}}$，推断在给定 $V_{m}$ 条件下 $\\mathrm{K}^{+}$ 和 $\\mathrm{Na}^{+}$ 的被动通量方向（流入胞质溶胶或流出至质外体）。\n4. 设 $r$ 为 $\\mathrm{Na}^{+}$ 和 $\\mathrm{K}^{+}$ 的被动电化学驱动力大小之比，定义为 $r = \\dfrac{|\\Delta V_{\\mathrm{Na}}|}{|\\Delta V_{\\mathrm{K}}|}$。将 $r$ 作为最终数值答案。将最终数值答案四舍五入至四位有效数字。比率 $r$ 是无量纲的。\n\n将所有中间过程的平衡电位以 $\\mathrm{mV}$ 为单位表示，但仅报告最终比率 $r$ 作为答案。", "solution": "在尝试任何解答之前，首先对问题陈述进行验证。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n- 基本原理：平衡状态下电化学势相等，$\\mu^{\\circ} + RT \\ln a_{\\mathrm{in}} + z F \\psi_{\\mathrm{in}} = \\mu^{\\circ} + RT \\ln a_{\\mathrm{out}} + z F \\psi_{\\mathrm{out}}$。\n- 近似：$a \\approx [\\cdot]$（活度由摩尔浓度近似）。\n- 常数：\n    - 温度，$T = 298.15\\ \\mathrm{K}$。\n    - 通用气体常数，$R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n    - 法拉第常数，$F = 96485.33212\\ \\mathrm{C\\,mol^{-1}}$。\n- 离子特性：\n    - $\\mathrm{K}^{+}$ 和 $\\mathrm{Na}^{+}$ 的价态为 $z = +1$。\n- 条件：\n    - 胞质溶胶浓度：$[\\mathrm{K}^{+}]_{\\mathrm{in}} = 100\\ \\mathrm{mM}$，$[\\mathrm{Na}^{+}]_{\\mathrm{in}} = 20\\ \\mathrm{mM}$。\n    - 质外体浓度：$[\\mathrm{K}^{+}]_{\\mathrm{out}} = 10\\ \\mathrm{mM}$，$[\\mathrm{Na}^{+}]_{\\mathrm{out}} = 200\\ \\mathrm{mM}$。\n    - 膜电位，$V_{m} = \\psi_{\\mathrm{in}} - \\psi_{\\mathrm{out}} = -120\\ \\mathrm{mV}$。\n- 定义：\n    - 平衡电位，$E_{\\mathrm{ion}}$。\n    - 驱动力，$\\Delta V_{\\mathrm{ion}} = V_{m} - E_{\\mathrm{ion}}$。\n    - 驱动力之比，$r = \\dfrac{|\\Delta V_{\\mathrm{Na}}|}{|\\Delta V_{\\mathrm{K}}|}$。\n- 任务：\n    1. 推导 $E_{\\mathrm{ion}}$ 的表达式。\n    2. 计算 $E_{\\mathrm{K}}$ 和 $E_{\\mathrm{Na}}$ 的数值。\n    3. 推断 $\\mathrm{K}^{+}$ 和 $\\mathrm{Na}^{+}$ 的被动离子通量方向。\n    4. 计算 $r$ 的数值，四舍五入至四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n根据所需标准评估问题。\n- **科学依据：** 该问题基于 Nernst 方程，这是电化学和生物物理学的一个基本原理。所提供的温度、离子浓度和膜电位值对于盐碱条件下的盐生植物细胞是生理上现实的。该背景适用于植物生理学这一特定领域。\n- **良态问题：** 问题提供了所有必要的数据和定义。任务陈述清晰，结构逻辑性强，能够导出一个唯一且稳定的解。\n- **客观性：** 问题采用精确的定量语言表述，没有歧义或主观陈述。\n\n**步骤 3：结论与行动**\n问题被判定为**有效**。它自成体系、科学合理且为良态问题。可以构建一个严谨的解答。\n\n**解答**\n\n**任务 1：推导平衡电位 ($E_{\\mathrm{ion}}$)**\n一种离子跨膜达到热力学平衡的条件是其在膜两侧的电化学势相等。\n$$ \\mu^{\\circ} + RT \\ln a_{\\mathrm{in}} + z F \\psi_{\\mathrm{in}} = \\mu^{\\circ} + RT \\ln a_{\\mathrm{out}} + z F \\psi_{\\mathrm{out}} $$\n标准化学势 $\\mu^{\\circ}$ 在两侧相同，因此可以消去。使用给定的活度 $a$ 可由摩尔浓度 $[\\cdot]$ 替代的近似，我们得到：\n$$ RT \\ln [\\mathrm{ion}]_{\\mathrm{in}} + z F \\psi_{\\mathrm{in}} = RT \\ln [\\mathrm{ion}]_{\\mathrm{out}} + z F \\psi_{\\mathrm{out}} $$\n平衡电位 $E_{\\mathrm{ion}}$ 定义为在该电位差下离子净通量为零的跨膜电位差 $\\psi_{\\mathrm{in}} - \\psi_{\\mathrm{out}}$。我们重排方程以求解该电位差：\n$$ z F (\\psi_{\\mathrm{in}} - \\psi_{\\mathrm{out}}) = RT \\ln [\\mathrm{ion}]_{\\mathrm{out}} - RT \\ln [\\mathrm{ion}]_{\\mathrm{in}} $$\n$$ z F E_{\\mathrm{ion}} = RT \\ln \\left( \\frac{[\\mathrm{ion}]_{\\mathrm{out}}}{[\\mathrm{ion}]_{\\mathrm{in}}} \\right) $$\n这就得出了平衡电位的 Nernst 方程：\n$$ E_{\\mathrm{ion}} = \\frac{RT}{zF} \\ln \\left( \\frac{[\\mathrm{ion}]_{\\mathrm{out}}}{[\\mathrm{ion}]_{\\mathrm{in}}} \\right) $$\n对于单价阳离子，价态 $z$ 为 $+1$，因此表达式变为：\n$$ E_{\\mathrm{ion}} = \\frac{RT}{F} \\ln \\left( \\frac{[\\mathrm{ion}]_{\\mathrm{out}}}{[\\mathrm{ion}]_{\\mathrm{in}}} \\right) $$\n\n**任务 2：计算平衡电位 ($E_{\\mathrm{K}}$ 和 $E_{\\mathrm{Na}}$)**\n首先，我们使用所给常数计算 $\\frac{RT}{F}$ 项的值。\n$$ \\frac{RT}{F} = \\frac{(8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}) (298.15\\ \\mathrm{K})}{96485.33212\\ \\mathrm{C\\,mol^{-1}}} \\approx 0.02569257\\ \\mathrm{V} $$\n这等价于 $25.69257\\ \\mathrm{mV}$。我们将在后续计算中使用这个值。\n\n对于钾离子 ($\\mathrm{K}^{+}$)，其中 $[\\mathrm{K}^{+}]_{\\mathrm{out}} = 10\\ \\mathrm{mM}$ 和 $[\\mathrm{K}^{+}]_{\\mathrm{in}} = 100\\ \\mathrm{mM}$：\n$$ E_{\\mathrm{K}} = \\frac{RT}{F} \\ln \\left( \\frac{[\\mathrm{K}^{+}]_{\\mathrm{out}}}{[\\mathrm{K}^{+}]_{\\mathrm{in}}} \\right) = (25.69257\\ \\mathrm{mV}) \\ln \\left( \\frac{10}{100} \\right) = (25.69257\\ \\mathrm{mV}) \\ln(0.1) $$\n$$ E_{\\mathrm{K}} \\approx (25.69257\\ \\mathrm{mV}) \\times (-2.302585) \\approx -59.1563\\ \\mathrm{mV} $$\n\n对于钠离子 ($\\mathrm{Na}^{+}$)，其中 $[\\mathrm{Na}^{+}]_{\\mathrm{out}} = 200\\ \\mathrm{mM}$ 和 $[\\mathrm{Na}^{+}]_{\\mathrm{in}} = 20\\ \\mathrm{mM}$：\n$$ E_{\\mathrm{Na}} = \\frac{RT}{F} \\ln \\left( \\frac{[\\mathrm{Na}^{+}]_{\\mathrm{out}}}{[\\mathrm{Na}^{+}]_{\\mathrm{in}}} \\right) = (25.69257\\ \\mathrm{mV}) \\ln \\left( \\frac{200}{20} \\right) = (25.69257\\ \\mathrm{mV}) \\ln(10) $$\n$$ E_{\\mathrm{Na}} \\approx (25.69257\\ \\mathrm{mV}) \\times (2.302585) \\approx +59.1563\\ \\mathrm{mV} $$\n平衡电位为 $E_{\\mathrm{K}} \\approx -59.16\\ \\mathrm{mV}$ 和 $E_{\\mathrm{Na}} \\approx +59.16\\ \\mathrm{mV}$。\n\n**任务 3：推断被动通量方向**\n离子的电化学驱动力由 $\\Delta V_{\\mathrm{ion}} = V_{m} - E_{\\mathrm{ion}}$ 给出。被动通量沿着电化学势梯度方向发生。对于阳离子 ($z>0$)，负的驱动力 ($\\Delta V_{\\mathrm{ion}} < 0$) 表示净通量方向是向内的，即流入胞质溶胶。正的驱动力 ($\\Delta V_{\\mathrm{ion}} > 0$) 表示净通量方向是向外的。给定的膜电位是 $V_{m} = -120\\ \\mathrm{mV}$。\n\n对于 $\\mathrm{K}^{+}$：\n$$ \\Delta V_{\\mathrm{K}} = V_{m} - E_{\\mathrm{K}} = (-120\\ \\mathrm{mV}) - (-59.1563\\ \\mathrm{mV}) = -60.8437\\ \\mathrm{mV} $$\n因为 $\\Delta V_{\\mathrm{K}} < 0$，所以 $\\mathrm{K}^{+}$ 的被动通量是**向内**的（流入胞质溶胶）。\n\n对于 $\\mathrm{Na}^{+}$：\n$$ \\Delta V_{\\mathrm{Na}} = V_{m} - E_{\\mathrm{Na}} = (-120\\ \\mathrm{mV}) - (59.1563\\ \\mathrm{mV}) = -179.1563\\ \\mathrm{mV} $$\n因为 $\\Delta V_{\\mathrm{Na}} < 0$，所以 $\\mathrm{Na}^{+}$ 的被动通量也是**向内**的（流入胞质溶胶）。\n\n**任务 4：计算比率 $r$**\n比率 $r$ 定义为 $\\mathrm{Na}^{+}$ 驱动力的大小除以 $\\mathrm{K}^{+}$ 驱动力的大小。\n$$ r = \\frac{|\\Delta V_{\\mathrm{Na}}|}{|\\Delta V_{\\mathrm{K}}|} $$\n使用上一步计算出的值：\n$$ r = \\frac{|-179.1563\\ \\mathrm{mV}|}{|-60.8437\\ \\mathrm{mV}|} = \\frac{179.1563}{60.8437} \\approx 2.944895 $$\n题目要求将最终数值答案四舍五入至四位有效数字。\n$$ r \\approx 2.945 $$\n这个比率是无量纲的，因为它是两个相同单位的量之比。", "answer": "$$\n\\boxed{2.945}\n$$", "id": "2563981"}, {"introduction": "该实践将渗透调节的热力学概念与其背后的代谢现实联系起来。虽然积累脯氨酸等兼容性溶质是植物在逆境中维持水分平衡的关键策略，但这并非没有代价。本问题要求学生将范特霍夫方程计算出的所需溶质浓度，与基于简化生物化学路径的碳和能量化学计量消耗联系起来，从而量化这一成本，具体理解胁迫耐受性中所涉及的生理权衡。[@problem_id:2564001]", "problem": "一个干旱胁迫下的植物叶肉细胞在其胞质溶胶中积累相容性溶质脯氨酸，以降低其渗透势从而保持水分。假设在与渗透压相关的尺度上，胞质溶胶溶液表现为理想溶液，并且在这些条件下，脯氨酸表现为非电解质，其有效渗透系数接近1。目标是通过完全积累脯氨酸，在 $25^{\\circ}\\mathrm{C}$ 下实现一个大小为 $0.5\\ \\mathrm{MPa}$ 的渗透调节。取普适气体常数为 $R = 0.008314\\ \\mathrm{MPa\\ L\\ mol^{-1}\\ K^{-1}}$。\n\n除了计算所需的细胞内脯氨酸浓度外，还需在以下关于植物中脯氨酸生物合成的主要谷氨酸途径的明确生物化学假设下，估算相关的碳成本：\n- 每从谷氨酸合成一摩尔脯氨酸，该途径消耗1摩尔三磷酸腺苷 (ATP) 和2摩尔还原型烟酰胺腺嘌呤二核苷酸磷酸 (NADPH)。\n- 脯氨酸的五碳骨架由碳水化合物提供，即1摩尔葡萄糖为1摩尔脯氨酸提供碳骨架，同时在己糖衍生的中间产物转化为α-酮戊二酸的过程中，有1摩尔碳以二氧化碳的形式损失（即，6个碳的葡萄糖 $\\rightarrow$ 5个碳的脯氨酸 + 1个碳的二氧化碳）。\n- 还原型烟酰胺腺嘌呤二核苷酸磷酸 (NADPH) 完全由氧化磷酸戊糖途径 (OPPP) 产生，该途径每将1摩尔葡萄糖完全氧化成6摩尔二氧化碳，可生成12摩尔NADPH。\n- 所需的ATP由葡萄糖的完全线粒体氧化提供，其有效产率为每将1摩尔葡萄糖完全氧化成6摩尔二氧化碳，可生成30摩尔ATP。\n- 用于提供能量和还原力的葡萄糖是在提供碳骨架的葡萄糖之外的；这两个葡萄糖库之间没有重复计算。\n\n任务：\n- 仅使用适用于稀溶液的基本热力学推理，确定在 $25^{\\circ}\\mathrm{C}$ 下产生大小为 $0.5\\ \\mathrm{MPa}$ 渗透势贡献所需的细胞内脯氨酸浓度。\n- 使用上述生物化学计量关系，计算合成并积累该浓度脯氨酸所需的每升胞质溶胶的最小葡萄糖消耗量，以摩尔/升（moles of glucose per liter）表示。\n\n将你的最终结果以行向量 $\\big[C_{\\mathrm{pro}}\\ (\\mathrm{mol\\ L^{-1}}),\\ n_{\\mathrm{glc}}\\ (\\mathrm{mol\\ L^{-1}})\\big]$ 的形式报告，其中 $C_{\\mathrm{pro}}$ 是所需的脯氨酸浓度，$n_{\\mathrm{glc}}$ 是相应的葡萄糖需求量。将两个数值均四舍五入到三位有效数字。", "solution": "为了确定达到目标渗透调节所需的脯氨酸浓度，我们使用经过充分检验的稀理想溶液渗透势的热力学描述，这等同于范特霍夫关系(van 't Hoff relation)：一个浓度为 $C$ 的非电解质的渗透势贡献由下式给出\n$$\n\\Psi_{s} = - i R T C,\n$$\n其中 $i$ 是范特霍夫因子(van 't Hoff factor)，$R$ 是普适气体常数，$T$ 是绝对温度，$C$ 是溶质的摩尔浓度。对于在这些条件下作为非电解质的脯氨酸，我们取 $i = 1$。\n\n目标渗透调节的大小为 $|\\Psi_{s}| = 0.5\\ \\mathrm{MPa}$，温度为 $T = 25^{\\circ}\\mathrm{C} = 298.15\\ \\mathrm{K}$。给定 $R = 0.008314\\ \\mathrm{MPa\\ L\\ mol^{-1}\\ K^{-1}}$，我们求解所需的浓度 $C_{\\mathrm{pro}}$：\n$$\n|\\Psi_{s}| = R T C_{\\mathrm{pro}} \\quad \\Longrightarrow \\quad C_{\\mathrm{pro}} = \\frac{|\\Psi_{s}|}{R T} = \\frac{0.5}{0.008314 \\times 298.15}.\n$$\n计算分母：\n$$\nR T = 0.008314 \\times 298.15 \\approx 2.4789\\ \\mathrm{MPa\\ L\\ mol^{-1}}.\n$$\n因此，\n$$\nC_{\\mathrm{pro}} \\approx \\frac{0.5}{2.4789} \\approx 0.2017\\ \\mathrm{mol\\ L^{-1}}.\n$$\n四舍五入到三位有效数字，得到\n$$\nC_{\\mathrm{pro}} \\approx 0.202\\ \\mathrm{mol\\ L^{-1}}.\n$$\n\n接下来，我们使用给定的化学计量关系，估算每升胞质溶胶中合成并积累 $C_{\\mathrm{pro}}$ 摩尔脯氨酸所需的葡萄糖量。\n\n设 $n_{\\mathrm{pro}}$ 为每升的脯氨酸摩尔数；此处 $n_{\\mathrm{pro}} = C_{\\mathrm{pro}}$，因为浓度是以每升为单位的。每摩尔脯氨酸所需的总葡萄糖量 $g$（单位：摩尔葡萄糖/摩尔脯氨酸）是三个独立贡献的总和：\n- 碳骨架供应：根据假设，1摩尔葡萄糖为1摩尔脯氨酸提供五碳骨架（有1个碳以二氧化碳形式损失），贡献为\n$$\ng_{\\mathrm{C}} = 1.\n$$\n- 还原力：每摩尔脯氨酸需要2摩尔还原型烟酰胺腺嘌呤二核苷酸磷酸 (NADPH)。氧化磷酸戊糖途径每将1摩尔葡萄糖完全氧化成6摩尔二氧化碳，可生成12摩尔NADPH。因此，提供还原力所需的葡萄糖为\n$$\ng_{\\mathrm{NADPH}} = \\frac{2}{12} = \\frac{1}{6}.\n$$\n- 三磷酸腺苷 (ATP)：每摩尔脯氨酸需要1摩尔ATP。葡萄糖完全氧化每摩尔可生成30摩尔ATP。因此，提供ATP所需的葡萄糖为\n$$\ng_{\\mathrm{ATP}} = \\frac{1}{30}.\n$$\n\n将这些贡献相加，得到每摩尔脯氨酸的总葡萄糖需求量：\n$$\ng = g_{\\mathrm{C}} + g_{\\mathrm{NADPH}} + g_{\\mathrm{ATP}} = 1 + \\frac{1}{6} + \\frac{1}{30} = 1 + 0.166\\overline{6} + 0.033\\overline{3} = 1.2.\n$$\n\n因此，每升所需的葡萄糖量为\n$$\nn_{\\mathrm{glc}} = g \\times n_{\\mathrm{pro}} = 1.2 \\times C_{\\mathrm{pro}} \\approx 1.2 \\times 0.2017 \\approx 0.24204\\ \\mathrm{mol\\ L^{-1}}.\n$$\n四舍五入到三位有效数字：\n$$\nn_{\\mathrm{glc}} \\approx 0.242\\ \\mathrm{mol\\ L^{-1}}.\n$$\n\n汇总这两个量并以要求的格式表示，得到\n$$\n\\big[C_{\\mathrm{pro}}\\ (\\mathrm{mol\\ L^{-1}}),\\ n_{\\mathrm{glc}}\\ (\\mathrm{mol\\ L^{-1}})\\big] \\approx \\big[0.202,\\ 0.242\\big].\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.202 & 0.242\\end{pmatrix}}$$", "id": "2564001"}, {"introduction": "本练习将视角从细胞层面提升至整株植物，探讨了水分传导系统失效这一干旱胁迫下植物死亡的关键机制。学生将参与一项模拟当代生态生理学研究的任务：使用标准数学模型（威布尔函数）拟合木质部脆弱性曲线数据。这项练习不仅能培养实用的数据分析技能，还提供了一个通过关键生理指标（如$P_{50}$和水力安全边际）来定量评估植物抗旱策略的框架。[@problem_id:2564037]", "problem": "给定关于木质部水势及其对应的植物茎干导水率损失百分比的数据集。其生理学背景是木质部导管中水分运输的内聚力-张力机制，以及在干旱或渗透胁迫下观察到的导管栓塞脆弱性。一个广泛使用且经过充分检验的木质部脆弱性曲线唯象模型，使用 Weibull 函数来表示导管在不同水势下的累积失效情况。令 $\\Psi$ 表示以兆帕 (MPa) 为单位的木质部水势，更负的值表示更强的张力；令 $\\mathrm{PLC}(\\Psi)$ 表示以百分比为单位的导水率损失百分比。你的任务是，使用非线性最小二乘法将双参数 Weibull 模型拟合到每个数据集，然后计算两个衍生的水力学指标：导水率损失 $50$ 时的水势（记为 $P_{50}$），以及在 $\\Psi = P_{50}$ 时 $\\mathrm{PLC}(\\Psi)$ 局部斜率的绝对值。\n\n需要拟合的模型是适用于 $\\Psi \\le 0$ 的标准双参数 Weibull 累积分布形式：\n$$\n\\mathrm{PLC}(\\Psi) \\;=\\; 100 \\,\\Big[1 - \\exp\\!\\big(-\\big(\\tfrac{-\\Psi}{\\lambda}\\big)^{k}\\big)\\Big],\n$$\n其中，尺度参数 $\\lambda > 0$，形状参数 $k > 0$。通过最小化观测 PLC 与模型 PLC 之间的残差平方和来拟合 $(\\lambda,k)$ 后，计算：\n- $P_{50}$，其定义为求解 $\\mathrm{PLC}(P_{50}) = 50$ 时的 $\\Psi$ 值，并以兆帕 (MPa) 为单位报告。\n- $S_{50}$，即在 $\\Psi = P_{50}$ 处求得的导数 $\\big|\\tfrac{d\\,\\mathrm{PLC}}{d\\Psi}\\big|$ 的绝对值，并以“百分点/兆帕”为单位报告。\n\n最后，对于每个数据集，给定一个外部指定的季节性最低木质部水势 $\\Psi_{\\min}$ (单位为 MPa)，计算水力安全边际 $\\mathrm{HSM} = \\Psi_{\\min} - P_{50}$ (单位为 MPa)。正的 $\\mathrm{HSM}$ 表示所经历的最低张力比 $P_{50}$ 更不负（更安全），而负的 $\\mathrm{HSM}$ 表示它比 $P_{50}$ 更负（风险更高）。\n\n你的程序必须实现以下测试套件的拟合与计算。每个测试用例提供一组数据点 $(\\Psi_i, \\mathrm{PLC}_i)$ 和一个 $\\Psi_{\\min}$ 值：\n\n- 测试用例 1（耐旱型，曲线陡峭）：\n  - $\\Psi$ 值 (MPa)：$[-0.5,\\,-1.0,\\,-1.5,\\,-2.0,\\,-2.5,\\,-3.0,\\,-3.5,\\,-4.0,\\,-5.0,\\,-6.0]$。\n  - $\\mathrm{PLC}$ 值 (百分比)：$[0.3,\\,2.3,\\,7.6,\\,17.0,\\,30.5,\\,46.7,\\,63.2,\\,77.5,\\,94.6,\\,99.4]$。\n  - $\\Psi_{\\min}$ (MPa)：$-2.9$。\n\n- 测试用例 2（类等水调节型，曲线平缓）：\n  - $\\Psi$ 值 (MPa)：$[-0.3,\\,-0.6,\\,-0.9,\\,-1.2,\\,-1.5,\\,-1.8,\\,-2.1,\\,-2.4,\\,-3.0,\\,-3.6,\\,-4.5]$。\n  - $\\mathrm{PLC}$ 值 (百分比)：$[10.6,\\,21.3,\\,31.1,\\,40.1,\\,48.1,\\,55.1,\\,61.3,\\,66.7,\\,75.6,\\,82.1,\\,88.8]$。\n  - $\\Psi_{\\min}$ (MPa)：$-1.7$。\n\n- 测试用例 3（盐胁迫型，曲线非常陡峭）：\n  - $\\Psi$ 值 (MPa)：$[-0.5,\\,-1.0,\\,-1.5,\\,-2.0,\\,-2.2,\\,-2.4,\\,-2.6,\\,-3.0,\\,-3.5,\\,-4.0]$。\n  - $\\mathrm{PLC}$ 值 (百分比)：$[0.0,\\,0.8,\\,6.2,\\,23.6,\\,35.3,\\,48.9,\\,63.2,\\,87.0,\\,98.8,\\,100.0]$。\n  - $\\Psi_{\\min}$ (MPa)：$-2.6$。\n\n算法要求和使用的定义：\n- 通过最小化 $\\sum_i \\big(\\mathrm{PLC}_i - \\mathrm{PLC}(\\Psi_i;\\lambda,k)\\big)^2$ 并满足约束条件 $\\lambda > 0$ 和 $k > 0$ 来拟合 $(\\lambda,k)$。\n- 通过代数运算求解上述模型中的 $\\mathrm{PLC}(\\Psi) = 50$ 来推导 $P_{50}$。\n- 通过对模型关于 $\\Psi$ 求导来计算斜率绝对值 $S_{50} = \\big|\\tfrac{d\\,\\mathrm{PLC}}{d\\Psi}\\big|_{\\Psi=P_{50}}$。\n- 计算 $\\mathrm{HSM} = \\Psi_{\\min} - P_{50}$。\n\n数值和单位规范：\n- 以兆帕 (MPa) 为单位报告 $P_{50}$ 和 $\\mathrm{HSM}$，保留三位小数。\n- 以“百分点/兆帕”为单位报告 $S_{50}$，保留三位小数。\n- 本问题不涉及角度。\n- 输入中的百分比已是百分比单位；请勿转换为小数。\n\n最终输出格式：\n- 你的程序应生成单行输出，包含一个由列表组成的逗号分隔列表，每个测试用例对应一个列表，每个内部列表按 $[P_{50}, S_{50}, \\mathrm{HSM}]$ 的顺序包含三个浮点数，所有数值均保留三位小数，并用方括号括起来。例如，包含两个用例的有效输出应类似于 $[[x_1,y_1,z_1],[x_2,y_2,z_2]]$，其中每个 $x_j$、$y_j$、$z_j$ 都是格式化为小数点后恰好三位的浮点数。", "solution": "该问题陈述已经过严格验证，并被认为是有效的。它在科学上基于植物水力学原理，特别是内聚力-张力理论和干旱引起的木质部栓塞现象。所用的模型和指标——用于脆弱性曲线的 Weibull 函数、$P_{50}$ 值、此点的斜率 $S_{50}$ 以及水力安全边际 $\\mathrm{HSM}$——都是植物生态生理学领域的标准且成熟的方法。该问题提法恰当、客观，并包含得出唯一且有意义解所需的所有信息。因此，我们可以继续。\n\n解决方案需要一个两阶段过程：首先，根据模型参数分析推导所需指标的表达式；其次，通过数值实现拟合过程，为每个数据集找到这些参数，然后计算这些指标。\n\n指定的唯象模型是双参数 Weibull 函数，它关联了导水率损失百分比 $\\mathrm{PLC}(\\Psi)$ 与木质部水势 $\\Psi$（其中 $\\Psi \\le 0$）：\n$$\n\\mathrm{PLC}(\\Psi) = 100 \\left[1 - \\exp\\left(-\\left(\\frac{-\\Psi}{\\lambda}\\right)^{k}\\right)\\right]\n$$\n待定参数是尺度参数 $\\lambda > 0$ 和形状参数 $k > 0$。\n\n首先，我们推导 $P_{50}$ 的解析表达式，即导水率损失为 $50\\%$ 时的水势。其定义条件为 $\\mathrm{PLC}(P_{50}) = 50$。\n$$\n50 = 100 \\left[1 - \\exp\\left(-\\left(\\frac{-P_{50}}{\\lambda}\\right)^{k}\\right)\\right]\n$$\n两边除以 $100$ 并整理得：\n$$\n0.5 = 1 - \\exp\\left(-\\left(\\frac{-P_{50}}{\\lambda}\\right)^{k}\\right)\n$$\n$$\n\\exp\\left(-\\left(\\frac{-P_{50}}{\\lambda}\\right)^{k}\\right) = 0.5\n$$\n对两边取自然对数：\n$$\n-\\left(\\frac{-P_{50}}{\\lambda}\\right)^{k} = \\ln(0.5) = -\\ln(2)\n$$\n两边乘以 $-1$ 并取 $k$ 次方根：\n$$\n\\frac{-P_{50}}{\\lambda} = \\left(\\ln(2)\\right)^{1/k}\n$$\n解出 $P_{50}$，得到表达式：\n$$\nP_{50} = -\\lambda \\left(\\ln(2)\\right)^{1/k}\n$$\n此表达式允许在已知 $\\lambda$ 和 $k$ 后直接计算 $P_{50}$。由于 $\\lambda > 0$，$k > 0$ 且 $\\ln(2) > 0$，所以 $P_{50}$ 的值将为负，这在物理上对于张力下的水势是正确的。\n\n接下来，我们推导 $S_{50}$ 的表达式，即在 $\\Psi = P_{50}$ 时脆弱性曲线斜率的绝对值。我们必须首先求出导数 $\\frac{d\\,\\mathrm{PLC}}{d\\Psi}$。使用链式法则：\n$$\n\\frac{d\\,\\mathrm{PLC}}{d\\Psi} = \\frac{d}{d\\Psi} \\left(100 - 100 \\exp\\left[-\\left(\\frac{-\\Psi}{\\lambda}\\right)^{k}\\right]\\right)\n$$\n$$\n\\frac{d\\,\\mathrm{PLC}}{d\\Psi} = -100 \\cdot \\exp\\left[-\\left(\\frac{-\\Psi}{\\lambda}\\right)^{k}\\right] \\cdot \\frac{d}{d\\Psi}\\left[-\\left(\\frac{-\\Psi}{\\lambda}\\right)^{k}\\right]\n$$\n$$\n\\frac{d\\,\\mathrm{PLC}}{d\\Psi} = -100 \\cdot \\exp\\left[-\\left(\\frac{-\\Psi}{\\lambda}\\right)^{k}\\right] \\cdot \\left(-k \\left(\\frac{-\\Psi}{\\lambda}\\right)^{k-1} \\cdot \\left(-\\frac{1}{\\lambda}\\right)\\right)\n$$\n$$\n\\frac{d\\,\\mathrm{PLC}}{d\\Psi} = -100 \\cdot \\frac{k}{\\lambda} \\left(\\frac{-\\Psi}{\\lambda}\\right)^{k-1} \\exp\\left[-\\left(\\frac{-\\Psi}{\\lambda}\\right)^{k}\\right]\n$$\n我们在 $\\Psi = P_{50}$ 处计算该导数的值。根据 $P_{50}$ 的推导，我们知道在这一点上 $\\exp\\left[-\\left(\\frac{-P_{50}}{\\lambda}\\right)^{k}\\right] = 0.5$。代入此值可得：\n$$\n\\left.\\frac{d\\,\\mathrm{PLC}}{d\\Psi}\\right|_{\\Psi=P_{50}} = -100 \\cdot \\frac{k}{\\lambda} \\left(\\frac{-P_{50}}{\\lambda}\\right)^{k-1} \\cdot (0.5) = -50 \\frac{k}{\\lambda} \\left(\\frac{-P_{50}}{\\lambda}\\right)^{k-1}\n$$\n我们可以进一步简化。从 $P_{50}$ 的推导中，我们有 $\\left(\\frac{-P_{50}}{\\lambda}\\right) = (\\ln(2))^{1/k}$。\n$$\n\\left.\\frac{d\\,\\mathrm{PLC}}{d\\Psi}\\right|_{\\Psi=P_{50}} = -50 \\frac{k}{\\lambda} \\left( (\\ln(2))^{1/k} \\right)^{k-1} = -50 \\frac{k}{\\lambda} (\\ln(2))^{(k-1)/k} = -50 \\frac{k}{\\lambda} (\\ln(2))^{1 - 1/k}\n$$\n一个更优雅的替代简化方法是使用关系式 $\\left(\\frac{-P_{50}}{\\lambda}\\right)^k = \\ln(2)$。\n$$\n\\left(\\frac{-P_{50}}{\\lambda}\\right)^{k-1} = \\frac{\\left(\\frac{-P_{50}}{\\lambda}\\right)^k}{\\left(\\frac{-P_{50}}{\\lambda}\\right)} = \\frac{\\ln(2)}{-P_{50}/\\lambda}\n$$\n将此代入斜率的表达式中：\n$$\n\\left.\\frac{d\\,\\mathrm{PLC}}{d\\Psi}\\right|_{\\Psi=P_{50}} = -50 \\frac{k}{\\lambda} \\left(\\frac{\\ln(2)}{-P_{50}/\\lambda}\\right) = \\frac{-50 k \\ln(2)}{-P_{50}} = \\frac{50 k \\ln(2)}{P_{50}}\n$$\n由于 $P_{50} < 0$，斜率为负，符合预期。问题要求的是其绝对值 $S_{50}$：\n$$\nS_{50} = \\left|\\frac{d\\,\\mathrm{PLC}}{d\\Psi}\\right|_{\\Psi=P_{50}} = \\left|\\frac{50 k \\ln(2)}{P_{50}}\\right| = \\frac{50 k \\ln(2)}{-P_{50}}\n$$\n最后，水力安全边际 $\\mathrm{HSM}$ 直接计算为：\n$$\n\\mathrm{HSM} = \\Psi_{\\min} - P_{50}\n$$\n\n计算过程包括通过最小化残差平方和 $\\sum_i (\\mathrm{PLC}_i - \\mathrm{PLC}(\\Psi_i; \\lambda, k))^2$ 来为每个数据集拟合参数 $(\\lambda, k)$。这是一个非线性最小二乘优化问题，将使用 `scipy.optimize.curve_fit` 函数进行数值求解。此函数需要模型、自变量数据 ($\\Psi_i$)、因变量数据 ($\\mathrm{PLC}_i$) 以及参数边界 $(\\lambda > 0, k > 0)$。一旦获得最优参数 $(\\hat{\\lambda}, \\hat{k})$，就将它们代入推导出的解析表达式中，以计算 $P_{50}$、$S_{50}$，并随后计算 $\\mathrm{HSM}$。然后按规定格式化最终结果。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves the plant hydraulic vulnerability curve fitting problem for multiple test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"psi\": np.array([-0.5, -1.0, -1.5, -2.0, -2.5, -3.0, -3.5, -4.0, -5.0, -6.0]),\n            \"plc\": np.array([0.3, 2.3, 7.6, 17.0, 30.5, 46.7, 63.2, 77.5, 94.6, 99.4]),\n            \"psi_min\": -2.9,\n        },\n        {\n            \"psi\": np.array([-0.3, -0.6, -0.9, -1.2, -1.5, -1.8, -2.1, -2.4, -3.0, -3.6, -4.5]),\n            \"plc\": np.array([10.6, 21.3, 31.1, 40.1, 48.1, 55.1, 61.3, 66.7, 75.6, 82.1, 88.8]),\n            \"psi_min\": -1.7,\n        },\n        {\n            \"psi\": np.array([-0.5, -1.0, -1.5, -2.0, -2.2, -2.4, -2.6, -3.0, -3.5, -4.0]),\n            \"plc\": np.array([0.0, 0.8, 6.2, 23.6, 35.3, 48.9, 63.2, 87.0, 98.8, 100.0]),\n            \"psi_min\": -2.6,\n        },\n    ]\n\n    def weibull_plc(psi, lam, k):\n        \"\"\"\n        Calculates the Percent Loss of Conductivity (PLC) using the Weibull model.\n        psi: Xylem water potential (MPa, negative).\n        lam: Scale parameter (lambda > 0).\n        k: Shape parameter (k > 0).\n        \"\"\"\n        # To avoid RuntimeWarning for invalid values in power for negative psi,\n        # we work with -psi, which is positive.\n        psi_pos = -psi\n        return 100 * (1 - np.exp(-((psi_pos / lam) ** k)))\n\n    results_all_cases = []\n    \n    for case in test_cases:\n        psi_data = case[\"psi\"]\n        plc_data = case[\"plc\"]\n        psi_min = case[\"psi_min\"]\n\n        # Fit the model using non-linear least squares (scipy.optimize.curve_fit)\n        # We provide bounds to ensure lambda and k are positive.\n        # Initial guess p0 can help convergence but often is not necessary.\n        # A reasonable guess for lambda is related to -P50, and k is often between 1 and 10.\n        initial_guess = [3.0, 3.0]\n        bounds = ([1e-9, 1e-9], [np.inf, np.inf]) # Strictly positive parameters\n        \n        popt, _ = curve_fit(weibull_plc, psi_data, plc_data, p0=initial_guess, bounds=bounds)\n        lam_fit, k_fit = popt\n\n        # 1. Calculate P50\n        # P50 = -lambda * (ln(2))^(1/k)\n        p50 = -lam_fit * (np.log(2))**(1 / k_fit)\n\n        # 2. Calculate S50 (magnitude of slope at P50)\n        # S50 = (50 * k * ln(2)) / -P50\n        s50 = (50 * k_fit * np.log(2)) / -p50\n        \n        # 3. Calculate HSM (Hydraulic Safety Margin)\n        # HSM = Psi_min - P50\n        hsm = psi_min - p50\n\n        # Format results to three decimal places\n        p50_str = f'{p50:.3f}'\n        s50_str = f'{s50:.3f}'\n        hsm_str = f'{hsm:.3f}'\n        \n        results_all_cases.append(f'[{p50_str},{s50_str},{hsm_str}]')\n        \n    # Final print statement in the exact required format.\n    print(f'[{\",\".join(results_all_cases)}]')\n\nsolve()\n```", "id": "2564037"}]}