{"hands_on_practices": [{"introduction": "器官间的通讯依赖于多种信号传导模式，其中神经信号和内分泌信号是最主要的两种长距离通讯方式。它们在速度、范围和持续时间上存在巨大差异。本练习通过一个量化模型，要求你计算并比较一种肽类激素通过循环系统到达靶器官的平均时间，以及一个神经信号沿等长路径传导所需的时间。通过这个实践，你将能深刻理解不同生理控制系统所受到的时间尺度约束，并掌握分析体液信号传递动力学的基本方法。[@problem_id:2586843]", "problem": "一种内分泌肽以瞬时推注的方式释放到体循环中，并分布在一个体积为 $V_{p}$ 的充分混合的中央血浆室内。该肽在血浆中进行一级降解，速率常数为 $k_{\\mathrm{deg}}$。血浆以等于心输出量中血浆组分的容积流量离开中央室。假设总心输出量为 $Q$，血细胞比容为 $H$，则血浆流量为 $Q_{p} = Q (1 - H)$。靶器官通过一根长度为 $D$ 的导管动脉接收动脉血浆，该动脉中的平均血流速度为 $v_{b}$；将此导管建模为平推流，因此离开中央血浆室后的额外动脉转运时间为 $D / v_{b}$。一条有髓鞘轴突从中枢神经系统投射到同一靶器官，路径长度同样为 $D$；其传导速度为 $v_{n}$，可以忽略突触延迟。\n\n从中央室的质量守恒和一级过程的定义出发，推导成功到达体循环流出（而不是被降解）的分子离开中央血浆的平均时间，然后通过加上导管动脉的转运时间，求得激素到达靶器官的期望时间。根据运动学原理推导相同距离下的神经传导时间。然后，使用以下生理学上合理的参数，计算激素到达时间与神经传导时间的无量纲比值 $R$：\n- 心输出量 $Q = 6.0\\,\\mathrm{L/min}$。\n- 血细胞比容 $H = 0.40$。\n- 血浆容积 $V_{p} = 3.0\\,\\mathrm{L}$。\n- 降解速率常数 $k_{\\mathrm{deg}} = 0.0060\\,\\mathrm{s^{-1}}$。\n- 导管长度 $D = 1.2\\,\\mathrm{m}$。\n- 导管内平均血流速度 $v_{b} = 0.40\\,\\mathrm{m/s}$。\n- 有髓鞘轴突传导速度 $v_{n} = 60\\,\\mathrm{m/s}$。\n\n将您的最终答案表示为比值 $R$（无量纲）。将您的答案四舍五入到三位有效数字。", "solution": "问题要求对到达同一靶器官的内分泌信号和神经信号的时间尺度进行定量比较。这需要根据所提供的生理和物理参数推导出每种信号的特征到达时间。\n\n首先，我们分析内分泌通路。肽类激素被引入一个体积为 $V_{p}$ 的中央、充分混合的血浆室。其浓度 $C(t)$ 随时间变化，这是由于两个同时发生的一级清除过程：代谢降解和对流流出。室内肽的质量平衡遵循质量守恒原理。设 $M(t) = V_{p} C(t)$ 为时刻 $t$ 时肽的总质量。该质量的变化率是各清除速率之和：\n$$ \\frac{dM(t)}{dt} = -(\\text{降解速率}) - (\\text{流出速率}) $$\n降解速率由一级过程给出，速率常数为 $k_{\\mathrm{deg}}$，因此速率为 $k_{\\mathrm{deg}} M(t)$。流出速率是血浆流率 $Q_{p}$ 与浓度 $C(t)$ 的乘积，因此速率为 $Q_{p} C(t)$。因此，质量平衡方程为：\n$$ \\frac{d(V_{p} C(t))}{dt} = -k_{\\mathrm{deg}} V_{p} C(t) - Q_{p} C(t) $$\n由于 $V_{p}$ 是常数，我们可以写出浓度的微分方程：\n$$ \\frac{dC(t)}{dt} = -\\left(k_{\\mathrm{deg}} + \\frac{Q_{p}}{V_{p}}\\right) C(t) $$\n这是一个一阶线性齐次常微分方程。我们定义一个总清除速率常数 $k_{el}$，作为两个平行清除通路速率常数之和：\n$$ k_{el} = k_{\\mathrm{deg}} + \\frac{Q_{p}}{V_{p}} $$\n血浆流率 $Q_{p}$ 由 $Q_{p} = Q(1 - H)$ 给出，其中 $Q$ 是总心输出量， $H$ 是血细胞比容。考虑到在 $t=0$ 时刻由推注产生的初始浓度 $C(0)$，浓度呈指数衰减：\n$$ C(t) = C(0) \\exp(-k_{el} t) $$\n问题要求的是成功到达体循环流出（而非被降解）的分子离开中央血浆的平均时间。设这个时间为 $\\tau_{exit}$。这是未被降解的分子亚群的平均停留时间。分子在时刻 $t$ 离开该室的速率是 $Q_{p}C(t)$。最终能够离开的总摩尔数 $N_{exit}$ 是该速率的时间积分：\n$$ N_{exit} = \\int_{0}^{\\infty} Q_{p} C(t) dt = \\int_{0}^{\\infty} Q_{p} C(0) \\exp(-k_{el}t) dt = \\frac{Q_{p}C(0)}{k_{el}} $$\n一个分子离开时间的概率密度函数 $p(t)$，以其最终会离开为条件，是 $t$ 时刻的离开速率与最终离开的总摩尔数之比：\n$$ p(t) = \\frac{Q_{p}C(t)}{N_{exit}} = \\frac{Q_{p}C(0)\\exp(-k_{el}t)}{Q_{p}C(0)/k_{el}} = k_{el}\\exp(-k_{el}t) $$\n这是速率参数为 $k_{el}$ 的指数分布的概率密度函数。该分布的均值即为所求的平均离开时间 $\\tau_{exit}$，它是速率参数的倒数：\n$$ \\tau_{exit} = \\int_{0}^{\\infty} t \\cdot p(t) dt = \\frac{1}{k_{el}} = \\frac{1}{k_{\\mathrm{deg}} + Q_{p}/V_{p}} $$\n激素到达靶器官的总期望时间 $T_{hormone}$ 是从中央室离开的平均时间与通过导管动脉的转运时间 $\\tau_{transit}$ 之和。导管被建模为平推流，因此转运时间就是长度 $D$ 除以血流速度 $v_{b}$：\n$$ \\tau_{transit} = \\frac{D}{v_{b}} $$\n$$ T_{hormone} = \\tau_{exit} + \\tau_{transit} = \\frac{1}{k_{\\mathrm{deg}} + Q(1-H)/V_{p}} + \\frac{D}{v_{b}} $$\n神经信号以传导速度 $v_{n}$ 在相同的距离 $D$ 上传播。假设突触延迟可忽略不计，神经传导时间 $T_{neural}$ 为：\n$$ T_{neural} = \\frac{D}{v_{n}} $$\n无量纲比值 $R$ 是这两个时间的比：\n$$ R = \\frac{T_{hormone}}{T_{neural}} = \\frac{\\frac{1}{k_{\\mathrm{deg}} + Q(1-H)/V_{p}} + \\frac{D}{v_{b}}}{D/v_{n}} $$\n现在我们代入所给的数值，确保使用一致的国际单位制（SI）单位。\n$Q = 6.0\\,\\mathrm{L/min} = 6.0 \\times \\frac{10^{-3}\\,\\mathrm{m^3}}{60\\,\\mathrm{s}} = 1.0 \\times 10^{-4}\\,\\mathrm{m^3/s}$\n$H = 0.40$\n$V_{p} = 3.0\\,\\mathrm{L} = 3.0 \\times 10^{-3}\\,\\mathrm{m^3}$\n$k_{\\mathrm{deg}} = 0.0060\\,\\mathrm{s^{-1}}$\n$D = 1.2\\,\\mathrm{m}$\n$v_{b} = 0.40\\,\\mathrm{m/s}$\n$v_{n} = 60\\,\\mathrm{m/s}$\n\n首先，我们计算血浆流量 $Q_{p}$：\n$$ Q_{p} = Q(1-H) = (1.0 \\times 10^{-4}\\,\\mathrm{m^3/s})(1 - 0.40) = 6.0 \\times 10^{-5}\\,\\mathrm{m^3/s} $$\n接着，我们计算清除速率常数 $k_{el}$：\n$$ k_{el} = k_{\\mathrm{deg}} + \\frac{Q_{p}}{V_{p}} = 0.0060\\,\\mathrm{s^{-1}} + \\frac{6.0 \\times 10^{-5}\\,\\mathrm{m^3/s}}{3.0 \\times 10^{-3}\\,\\mathrm{m^3}} = 0.0060\\,\\mathrm{s^{-1}} + 0.020\\,\\mathrm{s^{-1}} = 0.026\\,\\mathrm{s^{-1}} $$\n平均离开时间 $\\tau_{exit}$ 是：\n$$ \\tau_{exit} = \\frac{1}{k_{el}} = \\frac{1}{0.026\\,\\mathrm{s^{-1}}} \\approx 38.4615\\,\\mathrm{s} $$\n动脉转运时间 $\\tau_{transit}$ 是：\n$$ \\tau_{transit} = \\frac{D}{v_{b}} = \\frac{1.2\\,\\mathrm{m}}{0.40\\,\\mathrm{m/s}} = 3.0\\,\\mathrm{s} $$\n总的激素到达时间 $T_{hormone}$ 是：\n$$ T_{hormone} = \\tau_{exit} + \\tau_{transit} \\approx 38.4615\\,\\mathrm{s} + 3.0\\,\\mathrm{s} = 41.4615\\,\\mathrm{s} $$\n神经传导时间 $T_{neural}$ 是：\n$$ T_{neural} = \\frac{D}{v_{n}} = \\frac{1.2\\,\\mathrm{m}}{60\\,\\mathrm{m/s}} = 0.020\\,\\mathrm{s} $$\n最后，我们计算比值 $R$：\n$$ R = \\frac{T_{hormone}}{T_{neural}} \\approx \\frac{41.4615\\,\\mathrm{s}}{0.020\\,\\mathrm{s}} \\approx 2073.075 $$\n按照题目要求，将结果四舍五入到三位有效数字，得到：\n$$ R \\approx 2070 $$\n这可以用科学记数法表示为 $2.07 \\times 10^3$。这个结果表明，对于给定的参数，激素信号比神经信号慢三个数量级以上。", "answer": "$$\\boxed{2.07 \\times 10^{3}}$$", "id": "2586843"}, {"introduction": "信号在生理网络中的传递并非瞬时完成，其固有的时间延迟是系统动力学的一个关键因素。本练习将探讨这种延迟在负反馈回路中的动态后果。我们将使用一个简化的呼吸化学感受器反射模型，分析当反馈信号的延迟 $\\tau$ 超过某个临界值时，系统如何从稳定的平衡态转变为持续的振荡状态。这个练习旨在让你掌握延迟微分方程的稳定性分析方法，并理解霍普夫分岔 (Hopf bifurcation) 作为生理节律产生机制的数学原理。[@problem_id:2586829]", "problem": "我们考虑一个简化的线性化通气化学感受器反射性控制模型，该模型分析的是动脉二氧化碳分压与其稳态平衡值的微小偏差。令$x(t)$表示在时间$t$动脉二氧化碳分压与其稳态值的偏差。组织中局部代谢缓冲的总体闭环效应由一个系数为$a$的稳定项表示，而由化学感受器传入神经和脑干传出神经驱动的延迟通气校正由一个系数为$b$且总环路延迟为$\\tau$的反馈项表示。该线性时滞微分方程（DDE）为\n$$\n\\dot{x}(t) = - a\\, x(t) + b\\, x(t - \\tau),\n$$\n其中$a>0$且$b<0$，这与通过颈动脉体、脑干呼吸中枢、呼吸肌和肺之间的器官间通讯实现的通气对动脉二氧化碳的负反馈作用相一致。\n\n从线性时不变时滞系统的基本原理出发，并假设平衡点附近存在小扰动，推导该DDE的特征方程，并确定首次出现一对纯虚特征根（标志着通过Hopf分岔产生振荡）时的最小正临界延迟$\\tau_c$，将其表示为$a$和$b$的函数。请说明使得这样一个$\\tau_c$存在的参数条件。\n\n将你的最终答案表示为$\\tau_c$关于$a$和$b$的单一闭式解析表达式。无需进行数值计算，也无需报告物理单位。如果存在多个分支，请报告最小的正值$\\tau_c$。", "solution": "该问题要求推导一个由线性时滞微分方程（DDE）描述的系统开始振荡时的临界时间延迟$\\tau_c$。这对应于求解Hopf分岔的条件。\n\n控制该系统的DDE如下：\n$$\n\\dot{x}(t) = - a\\, x(t) + b\\, x(t - \\tau)\n$$\n其中参数为常数$a > 0$，$b < 0$ 和 $\\tau > 0$。\n\n为分析平衡点$x=0$的稳定性，我们寻找形如$x(t) = C e^{\\lambda t}$的解，其中$\\lambda$是一个复数，$C$是一个非零常数。将此试探解代入DDE中，可得：\n$$\n\\lambda C e^{\\lambda t} = -a C e^{\\lambda t} + b C e^{\\lambda (t-\\tau)}\n$$\n两边同除以$C e^{\\lambda t}$（对于非平凡解，此项不为零），得到系统的特征方程：\n$$\n\\lambda = -a + b e^{-\\lambda \\tau}\n$$\n它可以改写为：\n$$\n\\lambda + a - b e^{-\\lambda \\tau} = 0\n$$\n稳态的稳定性由根$\\lambda$的实部的符号决定。如果所有根的实部均为负，即$\\text{Re}(\\lambda) < 0$，则系统是稳定的。当参数$\\tau$变化时，若一对共轭复根穿过虚轴，则发生Hopf分岔。在分岔点，存在一个纯虚根$\\lambda = i\\omega$，其中$\\omega$是振荡的实值角频率。不失一般性地，我们假设$\\omega > 0$，因为特征方程具有实系数，所以如果$i\\omega$是一个根，那么它的共轭复数$-i\\omega$也必定是一个根。\n\n我们将$\\lambda = i\\omega$代入特征方程：\n$$\ni\\omega + a - b e^{-i\\omega \\tau} = 0\n$$\n$$\na + i\\omega = b e^{-i\\omega \\tau}\n$$\n使用欧拉公式$e^{-i\\omega \\tau} = \\cos(\\omega \\tau) - i \\sin(\\omega \\tau)$，我们将右边展开：\n$$\na + i\\omega = b \\cos(\\omega \\tau) - i b \\sin(\\omega \\tau)\n$$\n为使此等式成立，等式两边的实部和虚部必须分别相等。这得到一个由两个方程组成的方程组：\n$$\n\\text{Real part: } \\quad a = b \\cos(\\omega \\tau) \\quad (1)\n$$\n$$\n\\text{Imaginary part: } \\quad \\omega = -b \\sin(\\omega \\tau) \\quad (2)\n$$\n为了求出频率$\\omega$，我们可以从这两个方程中消去$\\tau$。我们将两个方程两边平方后相加：\n$$\na^{2} + \\omega^{2} = (b \\cos(\\omega \\tau))^{2} + (-b \\sin(\\omega \\tau))^{2}\n$$\n$$\na^{2} + \\omega^{2} = b^{2} \\cos^{2}(\\omega \\tau) + b^{2} \\sin^{2}(\\omega \\tau)\n$$\n$$\na^{2} + \\omega^{2} = b^{2} (\\cos^{2}(\\omega \\tau) + \\sin^{2}(\\omega \\tau))\n$$\n使用三角恒等式$\\cos^{2}(\\theta) + \\sin^{2}(\\theta) = 1$，我们得到：\n$$\na^{2} + \\omega^{2} = b^{2}\n$$\n解出$\\omega^{2}$：\n$$\n\\omega^{2} = b^{2} - a^{2}\n$$\n为使振荡发生，我们需要一个实的、非零的频率$\\omega$。这要求$\\omega^{2} > 0$，从而导出条件：\n$$\nb^{2} > a^{2}\n$$\n由于$a > 0$，这等价于$|b| > a$。这是临界延迟$\\tau_c$存在的必要参数条件。如果$|b| \\le a$，则不会出现此类振荡，系统对于所有$\\tau \\ge 0$均保持稳定。\n\n在$|b| > a$的条件下，分岔点的振荡频率为：\n$$\n\\omega = \\sqrt{b^{2} - a^{2}}\n$$\n现在我们求解临界延迟$\\tau$。由方程$(1)$和$(2)$可得：\n$$\n\\cos(\\omega \\tau) = \\frac{a}{b}\n$$\n$$\n\\sin(\\omega \\tau) = -\\frac{\\omega}{b}\n$$\n在约束条件$a > 0$和$b < 0$下，比值$a/b$为负，所以$\\cos(\\omega \\tau) < 0$。在$\\omega > 0$和$b < 0$的条件下，比值$-\\omega/b$为正，所以$\\sin(\\omega \\tau) > 0$。\n余弦值为负且正弦值为正，意味着角$\\omega\\tau$必须位于第二象限。该角的通解为：\n$$\n\\omega \\tau_k = \\arccos\\left(\\frac{a}{b}\\right) + 2k\\pi, \\quad k = 0, 1, 2, \\dots\n$$\n此处，$\\arccos$是主值函数，对于负自变量$a/b \\in (-1, 0)$，它返回一个在$(\\pi/2, \\pi)$区间内的值，这在$k=0$的情况下能正确地将角置于第二象限。\n\n因此，所有可能的临界延迟集合为：\n$$\n\\tau_k = \\frac{1}{\\omega} \\left( \\arccos\\left(\\frac{a}{b}\\right) + 2k\\pi \\right)\n$$\n问题要求的是最小正临界延迟$\\tau_c$，在该延迟下，第一对根穿过虚轴。这对应于$k=0$的情况：\n$$\n\\tau_c = \\frac{1}{\\omega} \\arccos\\left(\\frac{a}{b}\\right)\n$$\n代入$\\omega = \\sqrt{b^{2} - a^{2}}$的表达式，得到临界延迟的最终解析表达式：\n$$\n\\tau_c = \\frac{1}{\\sqrt{b^{2} - a^{2}}} \\arccos\\left(\\frac{a}{b}\\right)\n$$\n此表达式在$|b| > a$的条件下有效。", "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{b^{2} - a^{2}}} \\arccos\\left(\\frac{a}{b}\\right)}\n$$", "id": "2586829"}, {"introduction": "本练习将前面所学的反馈、延迟和系统动力学等概念整合到一个更复杂的、具有重要临床意义的场景中。你将通过计算机模拟一个由成纤维细胞生长因子-23 ($FGF23$)、甲状旁腺激素 ($PTH$) 和活性维生素D组成的复杂激素网络，该网络在磷酸盐稳态中起核心作用。通过在慢性肾病 ($CKD$) 的病理条件下分析该网络，你不仅能理解疾病如何重塑器官间的通讯，还将学习如何通过“计算机模拟实验” ($in silico$) 评估不同治疗干预措施的有效性，这正是网络生理学在病理生理学和药理学中的前沿应用。[@problem_id:2586771]", "problem": "您将对一个最小化的、无量纲的激素网络动力学系统进行建模，该系统捕捉了骨源性成纤维细胞生长因子23 (FGF23)、甲状旁腺激素 (PTH) 和活性维生素D在调节血清磷酸盐中的跨器官反馈。任务是计算稳态血清磷酸盐，并在慢性肾脏病 (CKD) 条件下对候选治疗干预措施进行局部的、一次一变量的敏感性分析，然后决定哪种干预措施能最有效地减轻高磷血症。\n\n所有状态变量都是标准化的、无量纲的浓度，相对于健康的稳态基线，因此每个物种的健康参考设定点为 $1$。设状态向量为 $(P,F,H,D)$，其中 $P$ 是血清磷酸盐，$F$ 是成纤维细胞生长因子23，$H$ 是甲状旁腺激素，$D$ 是活性维生素D。肾功能通过一个无量纲因子 $K_{\\mathrm{kid}}\\in[0,1]$ 进入模型，其中 $K_{\\mathrm{kid}}=1$ 代表正常肾功能，$K_{\\mathrm{kid}}=0$ 代表功能完全丧失。其动力学由以下常微分方程给出：\n$$\n\\frac{dP}{dt} \\;=\\; s_P + g_{PI}\\,D \\;-\\; e_P\\,K_{\\mathrm{kid}}\\left(1 + u_H\\,H + u_F\\,F\\right)P,\n$$\n$$\n\\frac{dF}{dt} \\;=\\; s_F + g_{FP}\\,P + g_{FD}\\,D \\;-\\; c_F\\,F,\n$$\n$$\n\\frac{dH}{dt} \\;=\\; s_H + g_{HP}\\,P \\;-\\; g_{HD}\\,D \\;-\\; c_H\\,H,\n$$\n$$\n\\frac{dD}{dt} \\;=\\; s_D + g_{DK}\\,K_{\\mathrm{kid}} \\;-\\; g_{DF}\\,F \\;-\\; g_{DP}\\,P \\;-\\; c_D\\,D.\n$$\n\n所有参数均为正常数，其选择使得当 $K_{\\mathrm{kid}}=1$ 时，健康稳态 $(P,F,H,D)=(1,1,1,1)$ 是一个平衡点。使用以下参数值：\n- $e_P=1.5$, $u_H=0.5$, $u_F=0.5$, $g_{PI}=0.8$,\n- $g_{FP}=0.8$, $g_{FD}=0.2$, $c_F=1.0$,\n- $g_{HP}=0.5$, $g_{HD}=0.3$, $c_H=1.0$,\n- $g_{DK}=1.0$, $g_{DF}=0.6$, $g_{DP}=0.2$, $c_D=1.0$.\n确保在 $K_{\\mathrm{kid}}=1$ 时健康平衡的源项为：\n$$\ns_P \\;=\\; e_P\\,(1+u_H+u_F) - g_{PI},\\quad\ns_F \\;=\\; c_F - g_{FP} - g_{FD},\\quad\ns_H \\;=\\; c_H - g_{HP} + g_{HD},\\quad\ns_D \\;=\\; c_D - g_{DK} + g_{DF} + g_{DP}.\n$$\n\n您将评估四个不同的、无量纲的干预参数，它们代表了常见的治疗策略：\n1. 磷酸盐结合剂，参数 $\\theta_{\\mathrm{bind}}\\ge 0$，通过修改 $g_{PI}\\to g_{PI}(1-\\theta_{\\mathrm{bind}})$ 来减少肠道磷酸盐的吸收。\n2. 拟钙剂，参数 $\\theta_{\\mathrm{cmi}}\\ge 0$，通过修改 $s_H\\to s_H(1-\\theta_{\\mathrm{cmi}})$ 和 $g_{HP}\\to g_{HP}(1-\\theta_{\\mathrm{cmi}})$ 来抑制PTH的驱动。\n3. FGF23激动剂，参数 $\\theta_{\\mathrm{fgf}}\\ge 0$，在 $F$ 调节另一个通量的任何地方，具体来说是在磷酸盐排泄因子中的 $u_F\\,F$ 项和维生素D抑制项中的 $g_{DF}\\,F$ 项，通过将 $F$ 替换为 $(1+\\theta_{\\mathrm{fgf}})F$ 来放大FGF23信号。\n4. 活性维生素D类似物，参数 $\\theta_{\\mathrm{vitD}}\\ge 0$，通过修改 $s_D\\to s_D(1+\\theta_{\\mathrm{vitD}})$ 来提供外源性维生素D驱动。\n\n您必须：\n- 对于给定的 $K_{\\mathrm{kid}}$，通过从初始条件 $(1,1,1,1)$ 开始对系统进行时间上的数值积分，直到其达到稳定行为，来计算基线条件下（无干预）的稳态 $P^\\ast$。\n- 对于每种干预 $k\\in\\{\\mathrm{bind},\\mathrm{cmi},\\mathrm{fgf},\\mathrm{vitD}\\}$，使用步长 $\\varepsilon=0.05$ 的前向有限差分，在 $\\theta_k=0$ 处对 $P^\\ast$ 进行关于干预参数 $\\theta_k$ 的局部的、一次一变量的敏感性分析：\n$$\nS_k \\;\\approx\\; \\frac{P^\\ast(\\theta_k=\\varepsilon) - P^\\ast(\\theta_k=0)}{\\varepsilon}.\n$$\n在对 $\\theta_k$ 进行扰动时，所有其他干预参数必须保持固定为 $0$。\n- 确定哪个单一干预措施产生最负的敏感性 $S_k$（即，每单位干预强度下稳态磷酸盐的最大降低）。如果出现完全相同的情况，则根据下面的排序选择最小的索引。\n\n为做出最终决定，干预措施的索引如下：\n- $0$ 代表磷酸盐结合剂，\n- $1$ 代表拟钙剂，\n- $2$ 代表FGF23激动剂，\n- $3$ 代表活性维生素D类似物。\n\n数值要求：\n- 所有变量和参数都是无量纲的；不使用物理单位。\n- 使用常微分方程求解器进行积分，直到达到接近稳态。一个可接受的标准是使用一个能够处理刚性问题的积分器，在足够长的最终时间后得到稳定的终端值；如果系统是稳定的，您可以使用一个固定的较大的最终时间。\n- 对敏感性分析步长使用 $\\varepsilon=0.05$。\n- 所有模拟均使用初始条件 $(P,F,H,D)=(1,1,1,1)$。\n\n测试套件：\n通过设置如下所列的 $K_{\\mathrm{kid}}$ 值，对以下四种CKD严重程度提供结果，并对每种情况独立应用上述敏感性分析协议：\n- 情况 A: $K_{\\mathrm{kid}}=1.0$,\n- 情况 B: $K_{\\mathrm{kid}}=0.6$,\n- 情况 C: $K_{\\mathrm{kid}}=0.3$,\n- 情况 D: $K_{\\mathrm{kid}}=0.0$.\n\n您的程序应生成单行输出，其中包含按A、B、C、D顺序排列的四种情况所选干预措施的索引，形式为逗号分隔的列表，并用方括号括起来（例如，\"[0,1,2,3]\"）。输出必须是根据上述索引映射定义的整数。", "solution": "该问题要求对一个关于血清磷酸盐激素调节的四维常微分方程（ODE）模型进行分析。目标是确定在不同程度的慢性肾脏病（CKD）（由参数 $K_{\\mathrm{kid}}$ 量化）下，降低高磷血症的最有效治疗干预措施。该分析将通过计算稳态血清磷酸盐浓度 $P^\\ast$ 对四种不同干预参数的局部敏感性来完成。\n\n首先，必须验证给定的数据和模型结构。\n\n**步骤1：提取给定条件**\n- **状态变量**：$(P, F, H, D)$，代表血清磷酸盐、成纤维细胞生长因子23 (FGF23)、甲状旁腺激素 (PTH) 和活性维生素D的无量纲浓度。\n- **肾功能参数**：$K_{\\mathrm{kid}} \\in [0, 1]$。\n- **动力学系统 (ODEs)**：\n    $$\n    \\frac{dP}{dt} = s_P + g_{PI}\\,D - e_P\\,K_{\\mathrm{kid}}(1 + u_H\\,H + u_F\\,F)P\n    $$\n    $$\n    \\frac{dF}{dt} = s_F + g_{FP}\\,P + g_{FD}\\,D - c_F\\,F\n    $$\n    $$\n    \\frac{dH}{dt} = s_H + g_{HP}\\,P - g_{HD}\\,D - c_H\\,H\n    $$\n    $$\n    \\frac{dD}{dt} = s_D + g_{DK}\\,K_{\\mathrm{kid}} - g_{DF}\\,F - g_{DP}\\,P - c_D\\,D\n    $$\n- **参数值**：\n    -   $e_P=1.5$, $u_H=0.5$, $u_F=0.5$, $g_{PI}=0.8$\n    -   $g_{FP}=0.8$, $g_{FD}=0.2$, $c_F=1.0$\n    -   $g_{HP}=0.5$, $g_{HD}=0.3$, $c_H=1.0$\n    -   $g_{DK}=1.0$, $g_{DF}=0.6$, $g_{DP}=0.2$, $c_D=1.0$\n- **源项定义**：\n    -   $s_P = e_P(1+u_H+u_F) - g_{PI}$\n    -   $s_F = c_F - g_{FP} - g_{FD}$\n    -   $s_H = c_H - g_{HP} + g_{HD}$\n    -   $s_D = c_D - g_{DK} + g_{DF} + g_{DP}$\n- **干预定义 ($\\theta_k \\ge 0$)**：\n    1.  **磷酸盐结合剂 ($\\theta_{\\mathrm{bind}}$)**：$g_{PI} \\to g_{PI}(1 - \\theta_{\\mathrm{bind}})$。\n    2.  **拟钙剂 ($\\theta_{\\mathrm{cmi}}$)**：$s_H \\to s_H(1 - \\theta_{\\mathrm{cmi}})$ 和 $g_{HP} \\to g_{HP}(1 - \\theta_{\\mathrm{cmi}})$。\n    3.  **FGF23激动剂 ($\\theta_{\\mathrm{fgf}}$)**：在 $u_F\\,F$ 和 $g_{DF}\\,F$ 项中用 $(1 + \\theta_{\\mathrm{fgf}})F$ 替换 $F$。\n    4.  **活性维生素D类似物 ($\\theta_{\\mathrm{vitD}}$)**：$s_D \\to s_D(1 + \\theta_{\\mathrm{vitD}})$。\n- **分析任务**：\n    -   计算稳态 $P^\\ast$。\n    -   使用 $\\varepsilon = 0.05$ 计算局部敏感性 $S_k \\approx \\frac{P^\\ast(\\theta_k=\\varepsilon) - P^\\ast(\\theta_k=0)}{\\varepsilon}$。\n    -   找到具有最负 $S_k$ 的干预措施 $k$。\n- **干预索引**：$0$：结合剂， $1$：拟钙剂， $2$：FGF23激动剂， $3$：维生素D类似物。\n- **数值要求**：\n    -   初始条件：$(P, F, H, D) = (1, 1, 1, 1)$。\n    -   使用能够处理刚性问题的求解器积分至稳态。\n    -   有限差分步长：$\\varepsilon = 0.05$。\n- **测试案例**：$K_{\\mathrm{kid}} = 1.0, 0.6, 0.3, 0.0$。\n\n**步骤2：使用提取的给定条件进行验证**\n该问题在科学上是有根据的，描述了一个简化但概念上标准的生理调节模型。问题是适定的，提供了一套完整的方程、参数、初始条件和一个清晰、客观的分析流程。该系统设计上是一致的，源项的定义确保了在 $K_{\\mathrm{kid}}=1$ 时的健康稳态是一个平衡点，这可以通过代入验证。该问题没有矛盾、不完整或模糊之处。它提出了一个系统生物学中的标准数值任务。\n\n**步骤3：结论与行动**\n问题有效。将推导一个合理的解决方案。\n\n**求解推导**\n\n问题的核心是在各种参数化条件下，求解一个耦合的非线性常微分方程系统的稳态解。状态向量为 $y(t) = [P(t), F(t), H(t), D(t)]^T$。控制方程为 $\\frac{dy}{dt} = f(y; K_{\\mathrm{kid}}, \\vec{\\theta})$，其中 $\\vec{\\theta} = (\\theta_{\\mathrm{bind}}, \\theta_{\\mathrm{cmi}}, \\theta_{\\mathrm{fgf}}, \\theta_{\\mathrm{vitD}})$ 是干预参数的向量。\n\n首先，我们使用提供的参数值计算恒定的源项：\n$e_P=1.5, u_H=0.5, u_F=0.5, g_{PI}=0.8$\n$g_{FP}=0.8, g_{FD}=0.2, c_F=1.0$\n$g_{HP}=0.5, g_{HD}=0.3, c_H=1.0$\n$g_{DK}=1.0, g_{DF}=0.6, g_{DP}=0.2, c_D=1.0$\n\n$s_P = 1.5(1+0.5+0.5) - 0.8 = 1.5(2) - 0.8 = 3.0 - 0.8 = 2.2$\n$s_F = 1.0 - 0.8 - 0.2 = 0.0$\n$s_H = 1.0 - 0.5 + 0.3 = 0.8$\n$s_D = 1.0 - 1.0 + 0.6 + 0.2 = 0.8$\n\n包含干预参数的完整系统可以写作如下：\n令 $y = [P, F, H, D]$。\n\n$\\frac{dP}{dt} = s_P + g_{PI}(1 - \\theta_{\\mathrm{bind}}) D - e_P K_{\\mathrm{kid}}(1 + u_H H + u_F (1 + \\theta_{\\mathrm{fgf}}) F) P$\n$\\frac{dF}{dt} = s_F + g_{FP} P + g_{FD} D - c_F F$\n$\\frac{dH}{dt} = s_H(1 - \\theta_{\\mathrm{cmi}}) + g_{HP}(1 - \\theta_{\\mathrm{cmi}}) P - g_{HD} D - c_H H$\n$\\frac{dD}{dt} = s_D(1 + \\theta_{\\mathrm{vitD}}) + g_{DK} K_{\\mathrm{kid}} - g_{DF} (1 + \\theta_{\\mathrm{fgf}}) F - g_{DP} P - c_D D$\n\n为了找到稳态解 $y^\\ast = [P^\\ast, F^\\ast, H^\\ast, D^\\ast]^T$，我们必须找到 $\\frac{dy}{dt} = 0$ 的点。解析求解这个非线性系统是困难的。一种鲁棒的数值方法是在足够长的时间范围内模拟系统动力学，直到状态变量不再变化。我们将从初始条件 $y(0) = [1, 1, 1, 1]^T$ 积分到大的最终时间 $T_{\\mathrm{final}}$。这个最终时间的解 $y(T_{\\mathrm{final}})$ 提供了对稳态 $y^\\ast$ 的精确近似。鉴于生化网络中可能存在的刚性问题（时间尺度的分离），使用能够处理刚性问题的ODE求解器是合适的，例如 `scipy.integrate.solve_ivp` 中可用的 `Radau` 或 `BDF` 方法。\n\n对于每个给定的 $K_{\\mathrm{kid}}$ 值，流程如下：\n\n1.  **计算基线稳态**：将所有干预参数设为零，即 $\\vec{\\theta} = (0,0,0,0)$。对于给定的 $K_{\\mathrm{kid}}$，积分ODE系统以找到基线稳态磷酸盐水平 $P^\\ast(\\vec{\\theta}=0)$。\n\n2.  **计算扰动后的稳态**：对于每个干预 $k \\in \\{0, 1, 2, 3\\}$，创建一个扰动参数向量 $\\vec{\\theta}_k$，其中第 $k$ 个分量为 $\\varepsilon = 0.05$，所有其他分量为零。对于每个 $\\vec{\\theta}_k$，再次积分系统以找到扰动后的稳态磷酸盐水平 $P^\\ast(\\theta_k=\\varepsilon)$。\n\n3.  **计算敏感性**：对于每个干预 $k$，使用前向有限差分近似计算敏感性：\n    $$\n    S_k = \\frac{P^\\ast(\\theta_k=\\varepsilon) - P^\\ast(\\theta_k=0)}{\\varepsilon}\n    $$\n    这将产生四个敏感性值：$S_0$ (结合剂)，$S_1$ (拟钙剂)，$S_2$ (FGF23激动剂) 和 $S_3$ (维生素D类似物)。\n\n4.  **选择最优干预措施**：目标是减轻高磷血症，这意味着我们寻求在给定强度 $\\varepsilon$ 下导致 $P^\\ast$ 最大下降的干预措施。这对应于最负的敏感性。我们找到索引 $k_{\\mathrm{opt}}$，使得：\n    $$\n    k_{\\mathrm{opt}} = \\arg\\min_{k \\in \\{0,1,2,3\\}} S_k\n    $$\n    如果出现平局，问题规定选择最小的索引。\n\n对于四个指定的 $K_{\\mathrm{kid}}$ 值（$1.0$、$0.6$、$0.3$ 和 $0.0$），将重复整个过程。最终的输出将是最优索引的列表 $[k_{\\mathrm{opt}, A}, k_{\\mathrm{opt}, B}, k_{\\mathrm{opt}, C}, k_{\\mathrm{opt}, D}]$。\n该实现将封装在一个Python脚本中，利用 `numpy` 进行数组操作，并利用 `scipy.integrate.solve_ivp` 进行ODE的数值积分。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the hormone-network dynamical system problem.\n\n    This function sets up the model parameters, loops through different levels of\n    chronic kidney disease (CKD), and for each level, performs a sensitivity\n    analysis to determine the most effective therapeutic intervention to lower\n    serum phosphate.\n    \"\"\"\n\n    # Define the test cases for kidney function K_kid.\n    test_cases = [1.0, 0.6, 0.3, 0.0]\n\n    # Model parameters\n    params = {\n        'e_P': 1.5, 'u_H': 0.5, 'u_F': 0.5, 'g_PI': 0.8,\n        'g_FP': 0.8, 'g_FD': 0.2, 'c_F': 1.0,\n        'g_HP': 0.5, 'g_HD': 0.3, 'c_H': 1.0,\n        'g_DK': 1.0, 'g_DF': 0.6, 'g_DP': 0.2, 'c_D': 1.0,\n    }\n\n    # Calculate source terms based on the healthy steady-state condition (K_kid=1, all vars=1)\n    params['s_P'] = params['e_P'] * (1 + params['u_H'] + params['u_F']) - params['g_PI']\n    params['s_F'] = params['c_F'] - params['g_FP'] - params['g_FD']\n    params['s_H'] = params['c_H'] - params['g_HP'] + params['g_HD']\n    params['s_D'] = params['c_D'] - params['g_DK'] + params['g_DF'] + params['g_DP']\n\n    # Numerical integration settings\n    t_final = 2000.0  # Sufficiently long time to reach steady state\n    t_span = [0, t_final]\n    y0 = np.array([1.0, 1.0, 1.0, 1.0])  # Initial condition (P, F, H, D)\n    epsilon = 0.05  # Finite difference step for sensitivity analysis\n\n    def model(t, y, K_kid, theta_vec, p):\n        \"\"\"\n        Defines the system of ordinary differential equations (ODEs).\n\n        Args:\n            t (float): Time (not used for this autonomous system).\n            y (np.ndarray): State vector [P, F, H, D].\n            K_kid (float): Kidney function parameter.\n            theta_vec (np.ndarray): Vector of intervention parameters [theta_bind, theta_cmi, theta_fgf, theta_vitD].\n            p (dict): Dictionary of model parameters.\n\n        Returns:\n            np.ndarray: Derivatives [dP/dt, dF/dt, dH/dt, dD/dt].\n        \"\"\"\n        P, F, H, D = y\n        theta_bind, theta_cmi, theta_fgf, theta_vitD = theta_vec\n\n        # Apply interventions to parameters\n        g_PI_eff = p['g_PI'] * (1 - theta_bind)\n        s_H_eff = p['s_H'] * (1 - theta_cmi)\n        g_HP_eff = p['g_HP'] * (1 - theta_cmi)\n        F_agonist_factor = (1 + theta_fgf)\n        s_D_eff = p['s_D'] * (1 + theta_vitD)\n\n        # ODE system equations\n        dP_dt = p['s_P'] + g_PI_eff * D - p['e_P'] * K_kid * (1 + p['u_H'] * H + p['u_F'] * F_agonist_factor * F) * P\n        dF_dt = p['s_F'] + p['g_FP'] * P + p['g_FD'] * D - p['c_F'] * F\n        dH_dt = s_H_eff + g_HP_eff * P - p['g_HD'] * D - p['c_H'] * H\n        dD_dt = s_D_eff + p['g_DK'] * K_kid - p['g_DF'] * F_agonist_factor * F - p['g_DP'] * P - p['c_D'] * D\n\n        return np.array([dP_dt, dF_dt, dH_dt, dD_dt])\n\n    def get_steady_state_P(K_kid, theta_vec):\n        \"\"\"\n        Integrates the ODEs to find the steady-state phosphate concentration.\n        \"\"\"\n        sol = solve_ivp(\n            fun=model,\n            t_span=t_span,\n            y0=y0,\n            method='Radau',  # Stiff-capable solver\n            args=(K_kid, theta_vec, params),\n            t_eval=[t_final]  # Evaluate only at the final time point\n        )\n        return sol.y[0, 0] # Return the phosphate concentration P\n\n    best_intervention_indices = []\n\n    for K_kid in test_cases:\n        # 1. Compute baseline steady state (no intervention)\n        theta_base = np.zeros(4)\n        P_base = get_steady_state_P(K_kid, theta_base)\n\n        sensitivities = []\n        # 2. Compute perturbed steady states and sensitivities for each intervention\n        for i in range(4):\n            theta_perturbed = np.zeros(4)\n            theta_perturbed[i] = epsilon\n            \n            P_perturbed = get_steady_state_P(K_kid, theta_perturbed)\n            \n            # 3. Calculate sensitivity\n            S_k = (P_perturbed - P_base) / epsilon\n            sensitivities.append(S_k)\n        \n        # 4. Determine the best intervention (most negative sensitivity)\n        best_index = np.argmin(sensitivities)\n        best_intervention_indices.append(best_index)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, best_intervention_indices))}]\")\n\nsolve()\n```", "id": "2586771"}]}