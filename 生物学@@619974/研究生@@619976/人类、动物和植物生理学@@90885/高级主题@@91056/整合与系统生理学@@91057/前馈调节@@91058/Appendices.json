{"hands_on_practices": [{"introduction": "从理论到实践，我们首先探讨一个具体的生物物理学模型，它展示了前馈调节在体温控制中的核心作用。这个练习要求我们运用热力学第一定律，为一名在运动开始瞬间的跑步者计算出维持核心体温稳定所需的预期性排汗率。通过这个计算，你将亲身体验如何将基本的物理原理（能量守恒）应用于量化一个预测性的生理反应，从而加深对身体如何主动对抗干扰以维持稳态的理解。[@problem_id:2568002]", "problem": "一名质量为 $m = 70\\,\\mathrm{kg}$ 的跑步者于时间 $t=0$ 在温和环境中开始进行稳定的耐力跑。在核心体温发生任何明显变化之前，神经系统会根据预测的代谢热负荷，产生一种前馈（预期性）的汗液分泌增加。假设以下有科学依据的事实和条件，您必须将其作为推导的基本出发点：\n\n- 应用于身体核心室的热力学第一定律，将核心热能的变化率与代谢产热和总散热之间的差值联系起来。\n- 全身热容为 $C = m c_b$，其中比热容为 $c_b = 3.5\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}}$。\n- 初始核心体温为 $T_c(0) = 37^{\\circ}\\mathrm{C}$，环境温度为 $T_a = 25^{\\circ}\\mathrm{C}$。\n- 在 $t=0$ 后的最初瞬间，干热交换（对流加辐射）可被建模为与瞬时核心-环境温差成线性关系，其系数 $k_d = 6.0\\,\\mathrm{W\\,K^{-1}}$ 在此短暂区间内保持近似恒定。\n- 皮肤温度下水的汽化潜热为 $\\lambda = 2.43 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$。\n- 在此短暂区间内，只有一部分比例为 $\\eta = 0.70$ 的分泌汗液蒸发并有助于降温（其余部分则滴落或积聚）。\n- 由于运动开始，代谢产热在 $t=0$ 时从静息值 $M_{\\mathrm{rest}} = 80\\,\\mathrm{W}$ 阶跃增加到运动值 $M_{\\mathrm{ex}} = 680\\,\\mathrm{W}$。假设与 $M_{\\mathrm{ex}}$ 相比，对外所做的机械功可以忽略不计，因此 $M_{\\mathrm{ex}}$ 可被视为需要散发的净产热。\n- 在此短暂区间内，与皮肤途径相比，呼吸造成的热量和质量交换可以忽略不计。\n\n基于以上条件，并从应用于核心的能量守恒定律出发，确定在 $t=0^{+}$ 时，能确保瞬时核心温度斜率为零（即 $\\frac{dT_c}{dt}(0^{+}) = 0$）的最小瞬时前馈汗液分泌率 $\\dot{m}_{s,\\mathrm{ff}}$。将 $\\dot{m}_{s,\\mathrm{ff}}$ 以 $\\mathrm{g\\,min^{-1}}$ 为单位表示。将最终数值结果四舍五入至三位有效数字。", "solution": "该问题要求确定一种特定的前馈生理反应，即汗液分泌率，以确保运动开始时的热稳定性。这是一个能量守恒问题，其解决方案必须基于热力学第一定律。\n\n我们首先将能量守恒原理应用于人体，将其视为一个单一的热力学室。身体内部热能的变化率 $\\frac{dE}{dt}$ 等于代谢产热率 $M$ 减去向环境的总散热率 $H_{loss}$。\n热能的变化通过全身热容 $C$ 与核心体温 $T_c$ 的变化相关联。因此，能量平衡方程为：\n$$C \\frac{dT_c}{dt} = M - H_{loss}$$\n总散热 $H_{loss}$ 是干散热（对流和辐射）$H_d$ 与蒸发（潜热）散热 $H_e$ 之和。题目告知我们忽略呼吸散热。\n$$H_{loss} = H_d + H_e$$\n将此代入能量平衡方程，得到：\n$$C \\frac{dT_c}{dt} = M - (H_d + H_e)$$\n该方程控制着核心体温的行为。问题指定了运动开始瞬间的一个关键条件，我们记为 $t=0^{+}$。在这一瞬间，一个前馈控制机制试图通过确保核心体温不立即开始上升来维持热稳态。这在数学上表示为：\n$$\\frac{dT_c}{dt}(0^{+}) = 0$$\n将此条件应用于我们的能量平衡方程，我们发现等式左侧项变为零。这意味着，为了在 $t=0^{+}$ 时维持稳定，产热率必须与散热率完全平衡。\n$$0 = M(0^{+}) - (H_d(0^{+}) + H_e(0^{+} ))$$\n$$M(0^{+}) = H_d(0^{+}) + H_e(0^{+})$$\n请注意，在求解温度变化为零的条件时，并不需要身体的热容 $C$。在问题陈述中包含它，是为了检验对控制方程的理解。\n\n现在，我们必须利用所提供的信息来定义 $t=0^{+}$ 瞬间的各项。\n代谢产热率 $M$ 以阶跃函数的形式从静息值增加到运动值。在 $t=0^{+}$ 时，它取运动值：\n$$M(0^{+}) = M_{ex} = 680\\,\\mathrm{W}$$\n干散热 $H_d$ 被给定为核心与环境之间温差的线性函数，$H_d = k_d (T_c - T_a)$。在 $t=0^{+}$ 时，核心体温还没有时间从其初始值 $T_c(0)$ 发生变化。\n$$H_d(0^{+}) = k_d (T_c(0) - T_a)$$\n代入给定值：\n$$T_c(0) = 37^{\\circ}\\mathrm{C}$$\n$$T_a = 25^{\\circ}\\mathrm{C}$$\n温差在摄氏度和开尔文下是等效的，为 $\\Delta T = 37 - 25 = 12\\,\\mathrm{K}$。\n$$H_d(0^{+}) = (6.0\\,\\mathrm{W\\,K^{-1}}) \\times (12\\,\\mathrm{K}) = 72\\,\\mathrm{W}$$\n蒸发散热 $H_e$ 是由汗液的相变引起的。它是有效汗液蒸发率与汽化潜热 $\\lambda$ 的乘积。前馈汗液分泌率为 $\\dot{m}_{s,\\mathrm{ff}}$，但只有一部分比例 $\\eta$ 有效蒸发。\n$$H_e(0^{+}) = \\eta \\cdot \\dot{m}_{s,\\mathrm{ff}} \\cdot \\lambda$$\n现在我们将这些表达式代回我们的稳态能量平衡方程：\n$$M_{ex} = k_d (T_c(0) - T_a) + \\eta \\cdot \\dot{m}_{s,\\mathrm{ff}} \\cdot \\lambda$$\n唯一的未知数是我们所求的量 $\\dot{m}_{s,\\mathrm{ff}}$。我们重排方程以求解它：\n$$\\eta \\cdot \\dot{m}_{s,\\mathrm{ff}} \\cdot \\lambda = M_{ex} - k_d (T_c(0) - T_a)$$\n$$\\dot{m}_{s,\\mathrm{ff}} = \\frac{M_{ex} - k_d (T_c(0) - T_a)}{\\eta \\lambda}$$\n现在我们可以将数值代入此表达式。所有数值都采用国际单位制基本单位（瓦特、焦耳、开尔文、千克）。\n$$M_{ex} = 680\\,\\mathrm{J\\,s^{-1}}$$\n$$k_d (T_c(0) - T_a) = 72\\,\\mathrm{J\\,s^{-1}}$$\n$$\\eta = 0.70$$\n$$\\lambda = 2.43 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$$\n$$\\dot{m}_{s,\\mathrm{ff}} = \\frac{680\\,\\mathrm{J\\,s^{-1}} - 72\\,\\mathrm{J\\,s^{-1}}}{0.70 \\times (2.43 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}})} = \\frac{608\\,\\mathrm{J\\,s^{-1}}}{1.701 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}}$$\n$$\\dot{m}_{s,\\mathrm{ff}} \\approx 3.574368 \\times 10^{-4}\\,\\mathrm{kg\\,s^{-1}}$$\n问题要求答案以克/分钟（$\\mathrm{g\\,min^{-1}}$）为单位。我们进行必要的单位换算：\n$$1\\,\\mathrm{kg} = 1000\\,\\mathrm{g}$$\n$$1\\,\\mathrm{min} = 60\\,\\mathrm{s}$$\n$$\\dot{m}_{s,\\mathrm{ff}} \\approx (3.574368 \\times 10^{-4}\\,\\frac{\\mathrm{kg}}{\\mathrm{s}}) \\times (\\frac{1000\\,\\mathrm{g}}{1\\,\\mathrm{kg}}) \\times (\\frac{60\\,\\mathrm{s}}{1\\,\\mathrm{min}})$$\n$$\\dot{m}_{s,\\mathrm{ff}} \\approx 21.4462\\,\\mathrm{g\\,min^{-1}}$$\n按照指示，将结果四舍五入到三位有效数字：\n$$\\dot{m}_{s,\\mathrm{ff}} \\approx 21.4\\,\\mathrm{g\\,min^{-1}}$$\n这是前馈系统为在运动开始时瞬时平衡热量收支所需的最小汗液分泌率，从而防止核心体温的初始上升。", "answer": "$$\\boxed{21.4}$$", "id": "2568002"}, {"introduction": "在理解了前馈调节如何实现生理目标后，一个更深层次的问题是：生理系统如何“决定”其反应的强度？这个练习将我们带入系统生物学和演化理论的交叉领域，通过构建一个包含效益（减少失配）与成本（能量消耗）的数学模型来探索最优的前馈增益。你将通过最优化方法，推导出在不确定环境下能最大化适应性的调节策略，这体现了生理调节中固有的经济学权衡思想。[@problem_id:2568003]", "problem": "在脊椎动物的消化系统中，一种激素的预期性分泌由前馈提示驱动。设预期性效应器输出的模型为 $R = g S$，其中 $S$ 是在时间 $t=0$ 时可用的感觉提示，而 $g$ 是一个无量纲的前馈增益。稍后到达的生理负荷（例如，吸收的营养物质）由 $X$ 表示。在许多次事件中，假设 $S$ 和 $X$ 是联合高斯分布，其均值为零，具有有限的二阶矩和已知的二阶统计量。\n\n定义每次事件的预期马尔萨斯适应度减量为两个分量之和：一个与负荷和预期性响应之间偏差的平方期望成正比的失配惩罚，以及一个与预期性响应幅值的平方期望成正比的能量成本。具体来说，该减量为\n$$\n\\Delta \\mathcal{F}(g) \\equiv \\alpha \\,\\mathbb{E}\\!\\left[(X - g S)^{2}\\right] + \\beta \\,\\mathbb{E}\\!\\left[R^{2}\\right],\n$$\n其中 $\\alpha>0$ 和 $\\beta>0$ 是固定系数，分别反映了对抗失配的选择强度和产生效应器输出的能量惩罚。假设基线马尔萨斯适应度足够大，以至于最大化预期适应度等同于最小化 $\\Delta \\mathcal{F}(g)$。\n\n仅使用联合高斯零均值变量的期望、方差和协方差的定义，以及生理最优点附近的小偏差二次近似，从第一性原理推导使 $\\Delta \\mathcal{F}(g)$ 最小化的最优前馈增益 $g^{\\ast}$，用 $\\alpha$、$\\beta$、$\\mathrm{Var}(S)$ 和 $\\mathrm{Cov}(X,S)$ 表示。然后，对于经验观测值 $\\mathrm{Var}(S)=16$、$\\mathrm{Var}(X)=25$、$S$ 和 $X$ 之间的相关系数 $\\rho=0.5$、$\\alpha=1.8$ 和 $\\beta=0.6$，计算 $g^{\\ast}$ 的数值。\n\n将您的最终答案表示为一个无量纲数，并四舍五入到四位有效数字。", "solution": "最优前馈增益 $g^{\\ast}$ 的推导过程如下。\n需要最小化的目标函数是预期的马尔萨斯适应度减量，由下式给出\n$$ \\Delta \\mathcal{F}(g) = \\alpha \\,\\mathbb{E}\\!\\left[(X - g S)^{2}\\right] + \\beta \\,\\mathbb{E}\\!\\left[R^{2}\\right] $$\n我们已知预期性响应为 $R = gS$。将其代入 $\\Delta \\mathcal{F}(g)$ 的表达式中得到\n$$ \\Delta \\mathcal{F}(g) = \\alpha \\,\\mathbb{E}\\!\\left[(X - g S)^{2}\\right] + \\beta \\,\\mathbb{E}\\!\\left[(gS)^{2}\\right] $$\n我们展开期望算子内部的平方项：\n$$ \\Delta \\mathcal{F}(g) = \\alpha \\,\\mathbb{E}\\!\\left[X^2 - 2gXS + g^2 S^2\\right] + \\beta \\,\\mathbb{E}\\!\\left[g^2 S^2\\right] $$\n根据期望算子的线性性质，我们可以将其分配到各项：\n$$ \\Delta \\mathcal{F}(g) = \\alpha \\left(\\mathbb{E}[X^2] - 2g\\mathbb{E}[XS] + g^2\\mathbb{E}[S^2]\\right) + \\beta g^2 \\mathbb{E}[S^2] $$\n问题陈述 $X$ 和 $S$ 是零均值随机变量，即 $\\mathbb{E}[X] = 0$ 和 $\\mathbb{E}[S] = 0$。对于零均值变量 $Z$，其方差定义为 $\\mathrm{Var}(Z) = \\mathbb{E}[(Z - \\mathbb{E}[Z])^2] = \\mathbb{E}[Z^2]$。类似地，两个零均值变量 $X$ 和 $S$ 之间的协方差为 $\\mathrm{Cov}(X,S) = \\mathbb{E}[(X - \\mathbb{E}[X])(S - \\mathbb{E}[S])] = \\mathbb{E}[XS]$。\n使用这些定义，我们将二阶矩替换为相应的方差和协方差项：\n$$ \\Delta \\mathcal{F}(g) = \\alpha \\left(\\mathrm{Var}(X) - 2g\\mathrm{Cov}(X,S) + g^2\\mathrm{Var}(S)\\right) + \\beta g^2 \\mathrm{Var}(S) $$\n我们可以通过按增益 $g$ 的幂次对项进行分组来重新排列此表达式：\n$$ \\Delta \\mathcal{F}(g) = (\\alpha \\mathrm{Var}(S) + \\beta \\mathrm{Var}(S)) g^2 - (2\\alpha \\mathrm{Cov}(X,S)) g + \\alpha \\mathrm{Var}(X) $$\n$$ \\Delta \\mathcal{F}(g) = (\\alpha + \\beta)\\mathrm{Var}(S) g^2 - 2\\alpha \\mathrm{Cov}(X,S) g + \\alpha \\mathrm{Var}(X) $$\n这个表达式是关于 $g$ 的二次函数。为了找到使 $\\Delta \\mathcal{F}(g)$ 最小化的 $g$ 值，我们必须计算关于 $g$ 的导数并将其设为零。\n$$ \\frac{d}{dg} \\Delta \\mathcal{F}(g) = \\frac{d}{dg} \\left( (\\alpha + \\beta)\\mathrm{Var}(S) g^2 - 2\\alpha \\mathrm{Cov}(X,S) g + \\alpha \\mathrm{Var}(X) \\right) $$\n$$ \\frac{d}{dg} \\Delta \\mathcal{F}(g) = 2(\\alpha + \\beta)\\mathrm{Var}(S) g - 2\\alpha \\mathrm{Cov}(X,S) $$\n将导数设为零以求最优增益 $g^{\\ast}$：\n$$ 2(\\alpha + \\beta)\\mathrm{Var}(S) g^{\\ast} - 2\\alpha \\mathrm{Cov}(X,S) = 0 $$\n$$ (\\alpha + \\beta)\\mathrm{Var}(S) g^{\\ast} = \\alpha \\mathrm{Cov}(X,S) $$\n求解 $g^{\\ast}$ 得到最优前馈增益的解析表达式：\n$$ g^{\\ast} = \\frac{\\alpha \\mathrm{Cov}(X,S)}{(\\alpha + \\beta) \\mathrm{Var}(S)} $$\n二阶导数 $\\frac{d^2}{dg^2} \\Delta \\mathcal{F}(g) = 2(\\alpha + \\beta)\\mathrm{Var}(S)$ 是正的，因为 $\\alpha > 0$，$\\beta > 0$，且 $\\mathrm{Var}(S) \\geq 0$（并且为了使表达式有意义，必须严格为正），这证实了 $g^{\\ast}$ 确实对应于一个最小值。\n\n现在，我们使用提供的经验数据计算 $g^{\\ast}$ 的数值：$\\mathrm{Var}(S)=16$，$\\mathrm{Var}(X)=25$，$\\rho=0.5$，$\\alpha=1.8$ 和 $\\beta=0.6$。\n首先，我们必须从相关系数 $\\rho$ 中求出协方差 $\\mathrm{Cov}(X,S)$。相关系数的定义是 $\\rho = \\frac{\\mathrm{Cov}(X,S)}{\\sqrt{\\mathrm{Var}(X)}\\sqrt{\\mathrm{Var}(S)}}$。\n整理以求解协方差：\n$$ \\mathrm{Cov}(X,S) = \\rho \\sqrt{\\mathrm{Var}(X)} \\sqrt{\\mathrm{Var}(S)} $$\n代入数值：\n$$ \\mathrm{Cov}(X,S) = 0.5 \\times \\sqrt{25} \\times \\sqrt{16} = 0.5 \\times 5 \\times 4 = 10 $$\n现在，我们将所有数值代入 $g^{\\ast}$ 的表达式中：\n$$ g^{\\ast} = \\frac{\\alpha \\mathrm{Cov}(X,S)}{(\\alpha + \\beta) \\mathrm{Var}(S)} = \\frac{1.8 \\times 10}{(1.8 + 0.6) \\times 16} $$\n$$ g^{\\ast} = \\frac{18}{2.4 \\times 16} $$\n$$ g^{\\ast} = \\frac{18}{38.4} = 0.46875 $$\n问题要求将最终答案四舍五入到四位有效数字。\n$$ g^{\\ast} \\approx 0.4688 $$\n这就是在给定条件下的最优无量纲前馈增益。", "answer": "$$\\boxed{0.4688}$$", "id": "2568003"}, {"introduction": "最后，我们将理论模型与工程实际相结合，处理真实生理系统中普遍存在的非理想状况。这个练习引导你从控制理论的视角，为一个稳态调节系统设计理想的前馈增益，并进一步分析当系统存在传感器偏倚、响应可变性以及执行器饱和等限制时，调节效果会如何打折扣。通过编程实现这个包含非线性环节的模型，你将学会量化现实世界中的不完美性对系统性能的影响，这是对复杂生物系统进行建模和分析的一项关键技能。[@problem_id:2568005]", "problem": "您的任务是为一个生理系统中的内稳态变量，在围绕设定点的小偏差下，形式化并计算一个前馈调节器。背景是：一个受控变量（例如，血糖浓度）由一个效应器（例如，胰岛素分泌）调节，同时面临一个输入扰动（例如，营养物质流入）。从生理学和控制论中广泛接受的核心定义和近似出发，假设如下：\n\n1. 在设定点附近，受控变量的小偏差服从一阶线性化和叠加原理，因此受控变量的稳态偏差（记为 $\\Delta y$）与效应器的小变化 $\\Delta u$ 和小扰动 $d$ 的响应满足一种具有恒定局部灵敏度（增益系数）的加性关系。具体而言，在微小扰动下，根据生理学中使用的标准线性近似，受控变量的偏差由效应器灵敏度和扰动灵敏度共同决定，这两者在设定点的一个邻域内被视为常数。\n\n2. 前馈控制器使用扰动 $d$ 的一个预期估计值 $\\hat{d}$，并施加一个与此估计值成比例的效应器指令，即 $\\Delta u = k \\,\\hat{d}$，其中 $k$ 是待设计的前馈增益。该估计器可能表现出一种一致的乘性偏差，建模为 $\\hat{d} = \\rho \\, d$，其中 $\\rho$ 是一个常数。\n\n3. 由于生理变异性（例如，受体灵敏度变异性），实际的效应器灵敏度可能会偏离其标称模型一个恒定的乘性因子 $\\gamma$。因此，相对于其标称值，对效应器的实际灵敏度被缩放了 $\\gamma$ 倍。\n\n4. 效应器通路受到执行器极限的限制，意味着被指令的效应器变化会根据削波映射 $\\mathrm{clip}(x, a, b) = \\min(\\max(x,a), b)$ 进行饱和。因此，施加的效应器为 $\\Delta u_{\\mathrm{applied}} = \\mathrm{clip}(k \\,\\hat{d}, -U_{\\max}, U_{\\max})$，其中 $U_{\\max} \\ge 0$ 是一个已知的界限。\n\n任务：\n\na) 仅从上述由一阶线性化和叠加原理构成的基本基础，以及关于估计器偏差、对象灵敏度变异性和执行器饱和的给定结构性假设出发，推导当没有估计器偏差（即 $\\rho = 1$）、没有灵敏度偏差（即 $\\gamma = 1$）且执行器未饱和时，能够使一阶稳态偏差为零的理想前馈增益 $k^{\\star}$ 的表达式。\n\nb) 在一般的偏差和变异性 $(\\rho, \\gamma)$ 以及存在执行器饱和的情况下，推导受控变量的残余稳态偏差 $\\Delta y$ 的表达式，该表达式应使用标称灵敏度、实现的馈前增益 $k$、偏差因子 $\\rho$、变异性因子 $\\gamma$、扰动大小 $d$ 和界限 $U_{\\max}$ 来表示。您的表达式必须通过 $\\Delta u_{\\mathrm{applied}}$ 正确地解释削波非线性。\n\nc) 实现一个程序，对于下面的每个测试用例，根据标称灵敏度计算理想增益 $k^{\\star}$，然后在存在指定的 $(\\rho, \\gamma, U_{\\max})$ 的情况下使用 $k = k^{\\star}$ 来计算残余稳态偏差 $\\Delta y$。您必须报告 $\\Delta y$ 的数值，单位为毫摩尔/升 (mmol/L)，四舍五入到3位小数。在计算 $k^{\\star}$ 时，效应器和扰动灵敏度应被视为标称常数。\n\n在推导和计算中使用的量和符号：\n\n- 受控变量的标称效应器灵敏度：$G_{u}$。\n- 受控变量的标称扰动灵敏度：$G_{d}$。\n- 扰动大小：$d$。\n- 前馈增益：$k$。\n- 偏差因子：$\\rho$。\n- 变异性因子：$\\gamma$。\n- 效应器界限：$U_{\\max}$。\n- 饱和后施加的效应器：$\\Delta u_{\\mathrm{applied}} = \\mathrm{clip}(k \\,\\rho \\, d, -U_{\\max}, U_{\\max})$。\n- 残余受控变量偏差：$\\Delta y$，单位为 $\\mathrm{mmol/L}$。\n\n使用以下参数值的测试套件，这些值涵盖了理想路径、有偏差估计但无饱和、有对象变异性的饱和、零扰动边界情况以及负扰动带饱和的情况：\n\n- 测试 $1$：$G_{u} = -0.9$, $G_{d} = 1.2$, $d = 2.0$, $\\rho = 1.0$, $\\gamma = 1.0$, $U_{\\max} = 10.0$。\n- 测试 $2$：$G_{u} = -0.9$, $G_{d} = 1.2$, $d = 2.0$, $\\rho = 0.7$, $\\gamma = 1.0$, $U_{\\max} = 10.0$。\n- 测试 $3$：$G_{u} = -0.8$, $G_{d} = 1.0$, $d = 5.0$, $\\rho = 1.1$, $\\gamma = 1.25$, $U_{\\max} = 3.0$。\n- 测试 $4$：$G_{u} = -1.0$, $G_{d} = 0.5$, $d = 0.0$, $\\rho = 0.5$, $\\gamma = 2.0$, $U_{\\max} = 1.0$。\n- 测试 $5$：$G_{u} = -0.6$, $G_{d} = 0.9$, $d = -1.5$, $\\rho = 1.0$, $\\gamma = 1.0$, $U_{\\max} = 1.0$。\n\n您的程序应为每个测试计算理想增益 $k^{\\star}$（根据标称对 $(G_{u}, G_{d})$），然后设置 $k = k^{\\star}$，形成 $\\Delta u_{\\mathrm{applied}} = \\mathrm{clip}(k \\,\\rho \\, d, -U_{\\max}, U_{\\max})$，最后根据您推导的关系式计算 $\\Delta y$。将每个 $\\Delta y$ 以 $\\mathrm{mmol/L}$ 为单位表示，并四舍五入到3位小数。\n\n最终输出格式：您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，$[r_{1},r_{2},r_{3},r_{4},r_{5}]$），其中每个 $r_{i}$ 是测试 $i$ 的四舍五入后的 $\\Delta y$ 值（单位 $\\mathrm{mmol/L}$）。", "solution": "推导从基本原理出发。\n基于线性化系统的叠加原理，受控变量的总稳态偏差 $\\Delta y$ 是由扰动 $d$ 引起的偏差和由施加的效应器作用 $\\Delta u_{\\mathrm{applied}}$ 引起的偏差之和。扰动的影响是其大小乘以扰动灵敏度，即 $G_{d}d$。效应器的影响是其施加的大小乘以*实际*的效应器灵敏度。标称效应器灵敏度是 $G_{u}$，它受到一个变异性因子 $\\gamma$ 的影响，所以实际灵敏度是 $\\gamma G_{u}$。因此，该系统的基本方程是：\n$$\n\\Delta y = (\\gamma G_{u}) \\Delta u_{\\mathrm{applied}} + G_{d} d\n$$\n\n(a) 理想前馈增益 $k^{\\star}$ 的推导。\n对于理想情况，给定没有估计器偏差（$\\rho = 1$），没有对象灵敏度偏差（$\\gamma = 1$），并且没有执行器饱和。\n在这种情况下，扰动估计是完美的：$\\hat{d} = \\rho d = (1)d = d$。\n控制器指令是 $\\Delta u = k \\hat{d} = k d$。\n没有饱和时，施加的效应器等于指令的效应器：$\\Delta u_{\\mathrm{applied}} = \\Delta u = k d$。\n将这些理想条件（$\\gamma=1$ 和 $\\Delta u_{\\mathrm{applied}} = kd$）代入基本系统方程，得到：\n$$\n\\Delta y = (1 \\cdot G_{u}) (k d) + G_{d} d\n$$\n$$\n\\Delta y = (k G_{u} + G_{d}) d\n$$\n理想的前馈增益，记为 $k^{\\star}$，旨在消除这个偏差，即 $\\Delta y = 0$。对于任何非零扰动 $d \\neq 0$，这要求：\n$$\nk^{\\star} G_{u} + G_{d} = 0\n$$\n解出 $k^{\\star}$，得到理想增益的表达式：\n$$\nk^{\\star} = -\\frac{G_{d}}{G_{u}}\n$$\n此增益确保控制作用产生的效应与扰动效应大小相等、符号相反，从而实现完美抵消。\n\n(b) 一般条件下残余稳态偏差 $\\Delta y$ 的推导。\n现在我们考虑一般情况，即存在估计器偏差 $\\rho$、对象变异性 $\\gamma$ 和由 $U_{\\max}$ 定义的执行器饱和。\n控制器指令基于有偏差的估计：$\\Delta u = k \\hat{d} = k (\\rho d)$。\n这个指令随后被执行器极限削波：\n$$\n\\Delta u_{\\mathrm{applied}} = \\mathrm{clip}(k \\rho d, -U_{\\max}, U_{\\max})\n$$\n我们将这个施加的效应器作用的表达式代入基本系统方程：\n$$\n\\Delta y = \\gamma G_{u} \\cdot \\mathrm{clip}(k \\rho d, -U_{\\max}, U_{\\max}) + G_{d} d\n$$\n这就是残余稳态偏差 $\\Delta y$ 的完整和通用表达式，用所有指定的参数和削波非线性表示。\n\n(c) 测试用例的计算。\n对于每个测试用例，我们首先使用标称灵敏度计算理想增益 $k^{\\star} = -G_d/G_u$。然后，我们设置实现的增益 $k = k^{\\star}$，并使用(b)部分中的 $\\Delta y$ 通用公式以及指定的参数 $(\\rho, \\gamma, d, U_{\\max})$ 进行计算。\n\n测试 $1$：$G_{u} = -0.9$, $G_{d} = 1.2$, $d = 2.0$, $\\rho = 1.0$, $\\gamma = 1.0$, $U_{\\max} = 10.0$。\n$k = k^{\\star} = - (1.2) / (-0.9) = 4/3$。\n指令的效应器：$k \\rho d = (4/3) \\cdot 1.0 \\cdot 2.0 = 8/3 \\approx 2.667$。\n施加的效应器：$\\Delta u_{\\mathrm{applied}} = \\mathrm{clip}(8/3, -10.0, 10.0) = 8/3$。\n残余偏差：$\\Delta y = 1.0 \\cdot (-0.9) \\cdot (8/3) + 1.2 \\cdot 2.0 = -2.4 + 2.4 = 0$。\n$\\Delta y = 0.000$ mmol/L。\n\n测试 $2$：$G_{u} = -0.9$, $G_{d} = 1.2$, $d = 2.0$, $\\rho = 0.7$, $\\gamma = 1.0$, $U_{\\max} = 10.0$。\n$k = k^{\\star} = - (1.2) / (-0.9) = 4/3$。\n指令的效应器：$k \\rho d = (4/3) \\cdot 0.7 \\cdot 2.0 = (4/3) \\cdot 1.4 = 5.6/3 \\approx 1.867$。\n施加的效应器：$\\Delta u_{\\mathrm{applied}} = \\mathrm{clip}(5.6/3, -10.0, 10.0) = 5.6/3$。\n残余偏差：$\\Delta y = 1.0 \\cdot (-0.9) \\cdot (5.6/3) + 1.2 \\cdot 2.0 = -0.3 \\cdot 5.6 + 2.4 = -1.68 + 2.4 = 0.72$。\n$\\Delta y = 0.720$ mmol/L。\n\n测试 $3$：$G_{u} = -0.8$, $G_{d} = 1.0$, $d = 5.0$, $\\rho = 1.1$, $\\gamma = 1.25$, $U_{\\max} = 3.0$。\n$k = k^{\\star} = - (1.0) / (-0.8) = 1.25$。\n指令的效应器：$k \\rho d = 1.25 \\cdot 1.1 \\cdot 5.0 = 6.875$。\n施加的效应器：$\\Delta u_{\\mathrm{applied}} = \\mathrm{clip}(6.875, -3.0, 3.0) = 3.0$。\n残余偏差：$\\Delta y = 1.25 \\cdot (-0.8) \\cdot 3.0 + 1.0 \\cdot 5.0 = -1.0 \\cdot 3.0 + 5.0 = -3.0 + 5.0 = 2.0$。\n$\\Delta y = 2.000$ mmol/L。\n\n测试 $4$：$G_{u} = -1.0$, $G_{d} = 0.5$, $d = 0.0$, $\\rho = 0.5$, $\\gamma = 2.0$, $U_{\\max} = 1.0$。\n$k = k^{\\star} = - (0.5) / (-1.0) = 0.5$。\n指令的效应器：$k \\rho d = 0.5 \\cdot 0.5 \\cdot 0.0 = 0$。\n施加的效应器：$\\Delta u_{\\mathrm{applied}} = \\mathrm{clip}(0, -1.0, 1.0) = 0$。\n残余偏差：$\\Delta y = 2.0 \\cdot (-1.0) \\cdot 0 + 0.5 \\cdot 0.0 = 0$。\n$\\Delta y = 0.000$ mmol/L。\n\n测试 $5$：$G_{u} = -0.6$, $G_{d} = 0.9$, $d = -1.5$, $\\rho = 1.0$, $\\gamma = 1.0$, $U_{\\max} = 1.0$。\n$k = k^{\\star} = - (0.9) / (-0.6) = 1.5$。\n指令的效应器：$k \\rho d = 1.5 \\cdot 1.0 \\cdot (-1.5) = -2.25$。\n施加的效应器：$\\Delta u_{\\mathrm{applied}} = \\mathrm{clip}(-2.25, -1.0, 1.0) = -1.0$。\n残余偏差：$\\Delta y = 1.0 \\cdot (-0.6) \\cdot (-1.0) + 0.9 \\cdot (-1.5) = 0.6 - 1.35 = -0.75$。\n$\\Delta y = -0.750$ mmol/L。\n\n这些计算将按要求以编程方式实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the residual steady-state deviation for a feedforward-regulated\n    physiological variable under various conditions.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (G_u, G_d, d, rho, gamma, U_max)\n    test_cases = [\n        (-0.9, 1.2, 2.0, 1.0, 1.0, 10.0),  # Test 1\n        (-0.9, 1.2, 2.0, 0.7, 1.0, 10.0),  # Test 2\n        (-0.8, 1.0, 5.0, 1.1, 1.25, 3.0),  # Test 3\n        (-1.0, 0.5, 0.0, 0.5, 2.0, 1.0),   # Test 4\n        (-0.6, 0.9, -1.5, 1.0, 1.0, 1.0)  # Test 5\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current test case\n        G_u, G_d, d, rho, gamma, U_max = case\n\n        # Task (a) & (c): Compute the ideal feedforward gain k_star\n        # and set k = k_star.\n        # This gain is based on nominal sensitivities and is intended to\n        # perfectly cancel the disturbance in the ideal case.\n        # k_star = -G_d / G_u\n        # A check for G_u being zero is good practice, but not necessary for\n        # the given test cases.\n        if G_u == 0:\n            # If G_u is zero, the effector has no influence, so control is impossible.\n            # This scenario is not in the test data but represents a singularity.\n            # For this problem, we can assume G_u is never zero.\n            pass\n        \n        k_star = -G_d / G_u\n        k = k_star\n\n        # Task (b) & (c): Derive and compute the residual deviation delta_y\n        # under general conditions, including saturation.\n\n        # 1. Calculate the commanded effector change before saturation\n        # delta_u_command = k * rho * d\n        u_command = k * rho * d\n\n        # 2. Apply the actuator saturation (clipping)\n        # delta_u_applied = clip(delta_u_command, -U_max, U_max)\n        u_applied = np.clip(u_command, -U_max, U_max)\n\n        # 3. Compute the final residual steady-state deviation\n        # delta_y = gamma * G_u * delta_u_applied + G_d * d\n        delta_y = gamma * G_u * u_applied + G_d * d\n\n        # Round the result to 3 decimal places as required\n        rounded_delta_y = round(delta_y, 3)\n        results.append(f\"{rounded_delta_y:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2568005"}]}