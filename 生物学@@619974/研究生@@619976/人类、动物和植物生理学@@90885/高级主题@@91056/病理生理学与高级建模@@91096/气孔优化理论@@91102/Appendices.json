{"hands_on_practices": [{"introduction": "在优化气孔行为之前，我们必须首先掌握气孔导度 ($g_s$) 如何转化为碳增益 ($A$) 和水分流失 ($E$) 的基本计算。本练习将气孔优化理论植根于气体扩散的可测量生物物理学中，以菲克定律（Fick's law）为基石，帮助您将导度的抽象概念与定义植物性能的实际通量联系起来。[@problem_id:2610159]", "problem": "叶片通过气孔与大气交换二氧化碳和水蒸气。从扩散摩尔通量的菲克定律（Fick’s law）出发，该定律指出，气体的通量等于导度乘以其摩尔混合比的梯度。假设：\n- 气体交换仪所报告的气孔导度 $g_s$ 是对水蒸气的导度。\n- 由于空气中分子扩散率的比值，对二氧化碳的导度为 $g_c = g_s/1.6$。\n- 空气和胞间空隙中的二氧化碳摩尔分数分别为 $C_a$ 和 $C_i$，以百万分率（ppm）为单位给出，这应被解释为 mol mol$^{-1}$（摩尔分数）。\n- 水蒸气通量由饱和水汽压差（Vapor Pressure Deficit, VPD）所隐含的摩尔分数梯度驱动，VPD记为 $D$（单位为$\\mathrm{kPa}$）。在总压为 $p$ 的理想气体近似下，水蒸气摩尔分数差为 $D/p$。\n- 胞间空隙中水蒸气饱和，边界层和角质层导度可忽略不计，总压均匀且等于大气压。\n\n给定 $C_a = 400\\,\\mathrm{ppm}$，$C_i = 260\\,\\mathrm{ppm}$，$g_s = 0.2\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$，$D = 2\\,\\mathrm{kPa}$ 以及 $p = 101\\,\\mathrm{kPa}$，利用上述物理基础推导表达式并计算：\n- 净$\\mathrm{CO}_2$同化速率 $A$（单位：mol m$^{-2}$ s$^{-1}$），以及\n- 蒸腾速率 $E$（单位：mol m$^{-2}$ s$^{-1}$）。\n\n将 $A$ 和 $E$ 的数值以 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$ 为单位表示，并将每个数值四舍五入至3位有效数字。以行向量 $\\big[ A\\;\\; E \\big]$ 的形式提供最终答案，向量内不含单位。", "solution": "该问题要求推导并计算植物叶片的净$\\mathrm{CO}_2$同化速率（记为 $A$）和蒸腾速率（记为 $E$）。分析从已给出的扩散摩尔通量的菲克定律（Fick's law）公式开始。\n\n首先，我们推导并计算净$\\mathrm{CO}_2$同化速率 $A$。根据所述的菲克定律，摩尔通量是导度与摩尔混合比（摩尔分数）梯度的乘积。对于$\\mathrm{CO}_2$的吸收，其通量 $A$ 由环境空气（$C_a$）和胞间空隙（$C_i$）之间的摩尔分数差驱动。相关的导度是$\\mathrm{CO}_2$的气孔导度，记为 $g_c$。因此，$A$ 的表达式为：\n$$\nA = g_c (C_a - C_i)\n$$\n问题给出了水蒸气气孔导度 $g_s$ 和$\\mathrm{CO}_2$气孔导度 $g_c$ 之间的关系，该关系基于它们在空气中的分子扩散率之比：\n$$\ng_c = \\frac{g_s}{1.6}\n$$\n将此关系代入 $A$ 的方程，得到以给定参数表示的表达式：\n$$\nA = \\frac{g_s}{1.6} (C_a - C_i)\n$$\n我们得到的数值如下：$g_s = 0.2\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$，$C_a = 400\\,\\mathrm{ppm}$ 以及 $C_i = 260\\,\\mathrm{ppm}$。单位 $\\mathrm{ppm}$（百万分率）应被解释为无量纲的摩尔分数，其中 $1\\,\\mathrm{ppm} = 10^{-6}$。因此，我们有 $C_a = 400 \\times 10^{-6}$ 和 $C_i = 260 \\times 10^{-6}$。\n将这些值代入 $A$ 的方程中：\n$$\nA = \\frac{0.2}{1.6} (400 \\times 10^{-6} - 260 \\times 10^{-6})\n$$\n$$\nA = 0.125 \\times (140 \\times 10^{-6})\n$$\n$$\nA = 17.5 \\times 10^{-6}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}\n$$\n该值必须用3位有效数字表示。在标准科学记数法中，它是 $A = 1.75 \\times 10^{-5} \\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$，这已经有3位有效数字。\n\n接着，我们推导并计算蒸腾速率 $E$。这是离开叶片的水蒸气的摩尔通量。此过程的导度是水蒸气气孔导度 $g_s$。驱动力是饱和的胞间空隙与环境空气之间的水蒸气摩尔分数差。问题指出，这个摩尔分数差 $\\Delta w$ 可以通过饱和水汽压差 $D$ 和总大气压 $p$ 计算得出：\n$$\n\\Delta w = \\frac{D}{p}\n$$\n应用菲克定律计算蒸腾作用：\n$$\nE = g_s \\Delta w\n$$\n代入 $\\Delta w$ 的表达式：\n$$\nE = g_s \\frac{D}{p}\n$$\n我们已知的数值为：$g_s = 0.2\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$，$D = 2\\,\\mathrm{kPa}$ 和 $p = 101\\,\\mathrm{kPa}$。注意，比率 $D/p$ 是无量纲的，这符合摩尔分数差的要求。\n将这些值代入 $E$ 的方程中：\n$$\nE = 0.2 \\left( \\frac{2}{101} \\right)\n$$\n$$\nE = \\frac{0.4}{101} \\approx 0.003960396... \\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}\n$$\n将此结果四舍五入至3位有效数字，得到：\n$$\nE \\approx 0.00396\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}\n$$\n在标准科学记数法中，这表示为 $E \\approx 3.96 \\times 10^{-3} \\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$。\n\n最终答案应表示为一个包含 $A$ 和 $E$ 数值的行向量。\n计算出的值为 $A = 1.75 \\times 10^{-5} \\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$ 和 $E = 3.96 \\times 10^{-3} \\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.75 \\times 10^{-5} & 3.96 \\times 10^{-3}\n\\end{pmatrix}\n}\n$$", "id": "2610159"}, {"introduction": "从叶片内部到大气的气体传输是一个多步骤过程，至少需要穿过气孔和叶片边界层。本练习运用一个源于电路的有效类比——串联电阻——来帮助您确定哪一步是控制气体交换的主要瓶颈。理解主导限制因素对于正确解釋气体交换数据和预测植物对风速等环境变化的响应至关重要。[@problem_id:2610165]", "problem": "在植物生理学中的气孔优化理论背景下，考虑气体从叶片细胞间隙到自由大气中的传输，该过程通过两个串联的路径进行：叶片边界层和气孔。设边界层导度用 $g_b$ 表示，气孔导度用 $g_s$ 表示，两者都是在稳态条件下为相同的扩散标量定义的。假设通量为稳态，因此通量在两个元件上空间恒定。\n\n从以下基本定义出发：(i) 每个路径的通量等于导度乘以驱动梯度；(ii) 串联导度通过其阻力的可加性进行组合（其中阻力定义为导度的倒数），推导该双路径系统的有效导度 $g_{\\mathrm{eff}}$（用 $g_b$ 和 $g_s$ 表示）。然后，对于 $g_b = 1.0\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$ 和 $g_s = 0.1\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$，计算 $g_{\\mathrm{eff}}$，并基于第一性原理，判断是边界层限制还是气孔限制主导了整个传输过程。\n\n最终数值答案仅报告 $g_{\\mathrm{eff}}$ 的值。导度以 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$ 为单位表示。请以精确分数形式给出最终答案；如果选择使用小数，请四舍五入到四位有效数字。对主导限制的定性评估应在你的推理中加以论证，无需包含在最终方框内的答案中。", "solution": "在尝试任何解答之前，首先对问题陈述进行验证。\n\n逐字提取已知条件：\n1.  气体传输通过两个串联路径：叶片边界层和气孔。\n2.  边界层导度为 $g_b$。\n3.  气孔导度为 $g_s$。\n4.  系统处于稳态条件下，通量在空间上是恒定的。\n5.  基本定义 (i)：每个路径的通量等于导度乘以驱动梯度。\n6.  基本定义 (ii)：串联导度通过其阻力的可加性进行组合。\n7.  阻力定义为导度的倒数。\n8.  任务是推导有效导度 $g_{\\mathrm{eff}}$（用 $g_b$ 和 $g_s$ 表示）。\n9.  提供了数值：$g_b = 1.0\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$ 和 $g_s = 0.1\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$。\n10. 任务包括计算 $g_{\\mathrm{eff}}$ 并确定主导限制因素。\n\n验证结论：\n该问题具有科学依据，提法明确且客观。它基于输运过程的标准电路类比（欧姆定律类比），这是输运现象和植物生态生理学中的一个基本概念。所提供的定义一致且足以推导出一个唯一解。数值在物理上是合理的。因此，该问题被判定为 **有效**。\n\n解答过程如下。\n\n问题陈述指出，对于串联的元件，它们的阻力是相加的。阻力 $r$ 定义为导度 $g$ 的倒数。因此，对于边界层，其阻力为 $r_b$，对于气孔，其阻力为 $r_s$。它们由以下公式给出：\n$$r_b = \\frac{1}{g_b}$$\n$$r_s = \\frac{1}{g_s}$$\n整个路径的总阻力或有效阻力 $r_{\\mathrm{eff}}$ 是各个串联阻力之和：\n$$r_{\\mathrm{eff}} = r_b + r_s$$\n将 $r_b$ 和 $r_s$ 的表达式代入 $r_{\\mathrm{eff}}$ 的方程，得到：\n$$r_{\\mathrm{eff}} = \\frac{1}{g_b} + \\frac{1}{g_s}$$\n有效导度 $g_{\\mathrm{eff}}$ 是有效阻力 $r_{\\mathrm{eff}}$ 的倒数：\n$$g_{\\mathrm{eff}} = \\frac{1}{r_{\\mathrm{eff}}}$$\n因此，用各部分导度表示的有效导度表达式为：\n$$g_{\\mathrm{eff}} = \\frac{1}{\\frac{1}{g_b} + \\frac{1}{g_s}}$$\n通过在分数的分母中找到公分母，可以对该表达式进行代数简化：\n$$\\frac{1}{g_b} + \\frac{1}{g_s} = \\frac{g_s}{g_b g_s} + \\frac{g_b}{g_b g_s} = \\frac{g_s + g_b}{g_b g_s}$$\n将此结果代回 $g_{\\mathrm{eff}}$ 的表达式中，得到：\n$$g_{\\mathrm{eff}} = \\frac{1}{\\frac{g_b + g_s}{g_b g_s}} = \\frac{g_b g_s}{g_b + g_s}$$\n这就是两个串联导体的有效导度所需的解析表达式。\n\n接下来，我们使用所提供的数据计算 $g_{\\mathrm{eff}}$ 的数值：$g_b = 1.0\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$ 和 $g_s = 0.1\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$。\n$$g_{\\mathrm{eff}} = \\frac{(1.0)(0.1)}{1.0 + 0.1} = \\frac{0.1}{1.1}$$\n为了将其表示为整数的精确分数，我们将分子和分母同乘以 $10$：\n$$g_{\\mathrm{eff}} = \\frac{0.1 \\times 10}{1.1 \\times 10} = \\frac{1}{11}$$\n$g_{\\mathrm{eff}}$ 的值为 $\\frac{1}{11}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$。作为四舍五入到四位有效数字的小数，其近似值为 $0.09091\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$。为求精确，首选精确分数形式。\n\n最后，我们必须确定主导的限制因素。传输限制与传输阻力是同义词。我们必须比较两条路径各自的阻力。\n边界层阻力为：\n$$r_b = \\frac{1}{g_b} = \\frac{1}{1.0} = 1.0\\,\\mathrm{m^2\\,s\\,mol^{-1}}$$\n气孔阻力为：\n$$r_s = \\frac{1}{g_s} = \\frac{1}{0.1} = 10\\,\\mathrm{m^2\\,s\\,mol^{-1}}$$\n总阻力为 $r_{\\mathrm{eff}} = r_b + r_s = 1.0 + 10 = 11\\,\\mathrm{m^2\\,s\\,mol^{-1}}$。\n比较这两个阻力，我们发现 $r_s = 10\\, \\gg \\,r_b = 1.0$。气孔阻力占总阻力的 $\\frac{10}{11}$，约 $91\\%$。由于气孔阻力比边界层阻力大一个数量级，因此它是传输路径中的主要瓶颈。因此，气孔限制主导了整个传输过程。这一结论从以下事实中也显而易见：有效导度 ($g_{\\mathrm{eff}} \\approx 0.09091$)的数值更接近两个导度中较小的一个 ($g_s = 0.1$)，而不是较大的那个 ($g_b = 1.0$)。", "answer": "$$\\boxed{\\frac{1}{11}}$$", "id": "2610165"}, {"introduction": "这项综合性练习将多个概念融会贯通，要求您构建一个功能强大的气孔最优控制模型来模拟植物一整天的生理活动。通过结合光合作用、蒸腾作用以及 Cowan-Farquhar 优化原理的模型，您将预测叶片應如何动态调整其气孔导度以响应光照和湿度的变化。这项实践展示了如何將理论原理转化为对植物行为的可检验、定量的预测。[@problem_id:2610145]", "problem": "您的任务是实现一个程序，该程序根据植物叶片的气孔优化理论，预测最优气孔导度的日变化过程。程序必须使用以下公认的生理学和物理学基础来推导算法，并计算作为时间函数的最优气孔导度：\n\n1. 光合光响应：潜在（生化、光限制）同化速率由以下饱和响应给出\n$$\nA_p(I) = A_{\\max}\\left(1 - e^{-k I}\\right) - R_d,\n$$\n其中 $A_{\\max} > 0$ 的单位为 $\\mathrm{\\mu mol\\ m^{-2}\\ s^{-1}}$，$k > 0$ 是初始斜率参数，单位为 $\\mathrm{( \\mu mol\\ m^{-2}\\ s^{-1} )^{-1}}$，$I$ 是光合光子通量密度，单位为 $\\mathrm{\\mu mol\\ m^{-2}\\ s^{-1}}$，而 $R_d \\ge 0$ 是日间呼吸，单位为 $\\mathrm{\\mu mol\\ m^{-2}\\ s^{-1}}$。为符合物理真实性，强制要求 $A_p(I) \\leftarrow \\max\\{0, A_p(I)\\}$。\n\n2. 扩散供应限制：根据菲克定律（Fick's law）描述的二氧化碳通过气孔的扩散，假设一个线性的供应限制同化\n$$\nA_s(g_s) = a_c\\, g_s,\n$$\n其中 $g_s \\ge 0$ 是对水蒸气的气孔导度，单位为 $\\mathrm{mol\\ m^{-2}\\ s^{-1}}$，$a_c > 0$ 是一个恒定的转换斜率，单位为 $\\mathrm{\\mu mol\\ m^{-2}\\ s^{-1}}$ 每 $\\mathrm{mol\\ m^{-2}\\ s^{-1}}$。这是一个常用的线性化方法，它概括了对二氧化碳的导度与环境到胞间的二氧化碳梯度之间的比率。\n\n3. 共同限制：实现的净同化是潜在生化速率和扩散供应速率中的较小者，\n$$\nA(g_s, I) = \\min\\{A_p(I), A_s(g_s)\\}.\n$$\n\n4. 蒸腾作用：假设蒸腾作用和气孔导度之间存在准稳态关系，\n$$\nE(g_s, D) = g_s\\, D,\n$$\n其中 $D \\ge 0$ 是水蒸气摩尔分数差（无量纲，单位为 $\\mathrm{mol\\ mol^{-1}}$）。\n\n5. 具有恒定边际水分利用效率的 Cowan–Farquhar 最优性：气孔被控制以最大化碳增益与水分利用惩罚之差的时间积分，其中拉格朗日乘子为常数，\n$$\n\\text{maximize}\\quad \\int_{0}^{T} \\left[A\\big(g_s(t),I(t)\\big) - \\lambda\\, E\\big(g_s(t),D(t)\\big)\\right]\\, dt,\n$$\n其中 $\\lambda > 0$ 在时间上是恒定的，单位为 $\\mathrm{\\mu mol\\ CO_2\\ mol^{-1}\\ H_2O}$，$T = 24\\ \\mathrm{h}$。假设没有动态滞后，因此问题在时间上是可分离的（即，优化在时间 t 上是逐点进行的）。\n\n6. 日强迫：光照使用半波整流正弦波，饱和水汽压差使用全正弦波。具体地，对于一天内以小时为单位的时间 t：\n- 白天时段从 $t_{\\text{rise}} = 6$ 到 $t_{\\text{set}} = 18$ 小时。设光周期长度为 $L = 12$ 小时。使用\n$$\nI(t) = \n\\begin{cases}\nI_{\\max}\\, \\sin\\!\\left(\\dfrac{\\pi (t - t_{\\text{rise}})}{L}\\right),  \\text{如果 } t \\in [t_{\\text{rise}}, t_{\\text{set}}] \\\\\n0,  \\text{其他情况}\n\\end{cases}\n$$\n其中 $I_{\\max} \\ge 0$。正弦函数的角度以弧度为单位。\n- 饱和水汽压差为\n$$\nD(t) = D_{\\text{base}} + D_{\\text{amp}}\\, \\sin\\!\\left(\\dfrac{2\\pi (t - 12)}{24}\\right),\n$$\n其中 $D_{\\text{base}} \\ge D_{\\text{amp}} \\ge 0$ 以确保对所有 $t$ 都有 $D(t) \\ge 0$。角度以弧度为单位。\n\n您的任务：\n- 从第 $1$ 至 $5$ 项出发，推导逐时最优性条件以及由此产生的最优气孔导度 $g_s^{\\star}(t)$，其为 $I(t)$、$D(t)$、$A_{\\max}$、$k$、$R_d$、$a_c$ 和 $\\lambda$ 的函数。推导过程不得假设任何未声明的捷径，并且必须明确使用第 $5$ 项所暗示的目标在时间上的可分离性。\n- 实现一个程序，在均匀的小时网格 $t \\in \\{0,1,2,\\dots,24\\}$ 小时上，为下面测试套件中的每组参数评估 $g_s^{\\star}(t)$。所有速率 $A$ 和 $g_s$ 必须按定义表示，导度的单位为 $\\mathrm{mol\\ m^{-2}\\ s^{-1}}$，同化速率的单位为 $\\mathrm{\\mu mol\\ m^{-2}\\ s^{-1}}$；最终输出为最优 $g_s^{\\star}(t)$ 值，以 $\\mathrm{mol\\ m^{-2}\\ s^{-1}}$ 为单位的浮点数报告。每个值四舍五入到 $6$ 位小数。\n- 如果在某个时间点 $A_p(I(t)) \\le 0$，则设置 $g_s^{\\star}(t) = 0$。当最优性条件在某个时间点允许多个解时，选择最小的非负 $g_s$。\n\n测试套件（每个元组指定 $(A_{\\max}, k, R_d, a_c, \\lambda, I_{\\max}, D_{\\text{base}}, D_{\\text{amp}})$）：\n- 案例 $1$（一般日变化，中等水分利用惩罚）：$(30,\\ 0.005,\\ 1,\\ 225,\\ 8000,\\ 1500,\\ 0.02,\\ 0.01)$。\n- 案例 $2$（强水分利用惩罚）：$(30,\\ 0.005,\\ 1,\\ 225,\\ 20000,\\ 1500,\\ 0.02,\\ 0.01)$。\n- 案例 $3$（整个白天饱和水汽压差较低）：$(30,\\ 0.005,\\ 1,\\ 225,\\ 8000,\\ 1500,\\ 0.01,\\ 0.005)$。\n- 案例 $4$（无光照）：$(30,\\ 0.005,\\ 1,\\ 225,\\ 8000,\\ 0,\\ 0.02,\\ 0.01)$。\n- 案例 $5$（中午出现边界条件，决胜规则为取最小导度）：$(30,\\ 0.005,\\ 1,\\ 225,\\ 7500,\\ 1500,\\ 0.02,\\ 0.01)$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个有 $5$ 个元素的列表，每个测试案例一个元素，其中每个元素是包含 $25$ 个浮点值的列表，对应于 $t = 0, 1, \\dots, 24$ 小时的 $g_s^{\\star}(t)$。整体输出必须以以下格式打印为单行\n$$\n[ [g_{0}^{(1)}, g_{1}^{(1)}, \\dots, g_{24}^{(1)}], [g_{0}^{(2)}, \\dots, g_{24}^{(2)}], [g_{0}^{(3)}, \\dots, g_{24}^{(3)}], [g_{0}^{(4)}, \\dots, g_{24}^{(4)}], [g_{0}^{(5)}, \\dots, g_{24}^{(5)}] ],\n$$\n其中每个 g 的单位为 $\\mathrm{mol\\ m^{-2}\\ s^{-1}}$，四舍五入到 $6$ 位小数，并且没有额外的空白或文本。三角函数中的角度必须以弧度为单位。", "solution": "任务是推导最优气孔导度 $g_s^{\\star}(t)$ 并根据气孔优化原理实现其计算程序。该问题具有科学依据且定义明确。最优气孔导度 $g_s^{\\star}(t)$ 的推导源于目标函数的逐点最大化。\n\n问题指出，优化可以在每个时间点 t 独立进行。目标是关于气孔导度 $g_s(t) \\ge 0$ 最大化以下函数：\n$$\nJ(g_s, t) = A\\big(g_s(t), I(t)\\big) - \\lambda E\\big(g_s(t), D(t)\\big)\n$$\n为了推导的清晰性，我们将在单个时间点的分析中省略 $g_s$、$I$ 和 $D$ 的时间依赖性。需要最大化的函数是：\n$$\nJ(g_s) = A(g_s, I) - \\lambda E(g_s, D)\n$$\n代入给定的同化 $A$ 和蒸腾 $E$ 的定义：\n$$\nJ(g_s) = \\min\\{A_p(I), a_c g_s\\} - \\lambda g_s D\n$$\n其中 $A_p(I) = A_{\\max}(1 - e^{-kI}) - R_d$。在给定的时间点，参数 $A_p(I)$ 相对于 $g_s$ 是一个常数。\n\n一项具体指令指出，如果 $A_p(I(t))$ 的初始计算得到非正值，即 $A_p(I(t)) \\le 0$，则最优导度必须设置为 $g_s^{\\star}(t) = 0$。这种情况对应于黑暗或光照极弱的时期，此时呼吸作用的碳损失超过光合作用的增益，使得任何气孔开放及伴随的水分损失都非最优。该指令与优化原则一致：如果 $A_p(I) \\le 0$，则对于 $g_s \\ge 0$，$\\min\\{A_p(I), a_c g_s\\}$ 项始终为非正。目标函数变为 $J(g_s) \\le -\\lambda g_s D$，对于非负的 $g_s$ 和 $D$，该函数在 $g_s=0$ 时最大化，得到最小的负值（或零）。\n\n我们现在考虑 $A_p(I)  0$ 的情况。目标函数 $J(g_s)$ 是连续且分段线性的。$J(g_s)$ 的行为取决于 $\\min$ 函数中的哪一项是限制性的。这两种情况在 $a_c g_s = A_p(I)$ 的点分开，即在 $g_s = g_{s,crit} \\equiv A_p(I)/a_c$。\n\n情况 1：扩散供应限制（$0 \\le g_s  g_{s,crit}$）。\n在此范围内，$a_c g_s  A_p(I)$，所以 $A(g_s, I) = a_c g_s$。目标函数为：\n$$\nJ(g_s) = a_c g_s - \\lambda g_s D = (a_c - \\lambda D) g_s\n$$\n这是一个关于 $g_s$ 的线性函数。其斜率为 $\\frac{dJ}{dg_s} = a_c - \\lambda D$。\n\n情况 2：生化限制（$g_s \\ge g_{s,crit}$）。\n在此范围内，$a_c g_s \\ge A_p(I)$，所以 $A(g_s, I) = A_p(I)$。目标函数为：\n$$\nJ(g_s) = A_p(I) - \\lambda g_s D\n$$\n这同样是关于 $g_s$ 的线性函数。其斜率为 $\\frac{dJ}{dg_s} = -\\lambda D$。由于 $\\lambda  0$ 且 $D(t) \\ge 0$，该斜率总是非正的（$\\le 0$）。\n\n因此，函数 $J(g_s)$ 对于所有 $g_s \\ge g_{s,crit}$ 都是非增的。这意味着 $J(g_s)$ 的最大值不可能出现在任何 $g_s  g_{s,crit}$ 的点。最大值必须位于区间 $[0, g_{s,crit}]$ 内。\n\n在 $[0, g_{s,crit}]$ 内的最大值位置取决于情况 1 中的斜率 $(a_c - \\lambda D)$。\n\\begin{itemize}\n    \\item 如果 $a_c - \\lambda D  0$：函数 $J(g_s)$ 在区间 $[0, g_{s,crit})$ 上严格递增。因此，最大值在该区间的上边界处达到。根据连续性，最优解是 $g_s^{\\star} = g_{s,crit} = A_p(I)/a_c$。\n    \\item 如果 $a_c - \\lambda D \\le 0$：函数 $J(g_s)$ 在区间 $[0, g_{s,crit})$ 上非增。最大值在下边界处达到，即 $g_s^{\\star} = 0$。这也满足了 $a_c = \\lambda D$ 情况下的决胜规则，此时任何 $g_s \\in [0, g_{s,crit}]$ 都是最优的，我们必须选择最小的非负解，即 $0$。\n\\end{itemize}\n\n总而言之，在从 0 到 24 的每个时间步 t 计算 $g_s^{\\star}(t)$ 的算法如下：\n$1$. 使用提供的正弦函数计算环境驱动因子 $I(t)$ 和 $D(t)$。对于 $t \\in [6, 18]$，$I(t) = I_{\\max} \\sin(\\frac{\\pi(t-6)}{12})$；否则 $I(t) = 0$。并且 $D(t) = D_{\\text{base}} + D_{\\text{amp}} \\sin(\\frac{2\\pi(t-12)}{24})$。\n$2$. 计算潜在同化速率 $A_{p,raw}(t) = A_{\\max}(1 - e^{-k I(t)}) - R_d$。\n$3$. 如果 $A_{p,raw}(t) \\le 0$，则设置最优导度 $g_s^{\\star}(t) = 0$。\n$4$. 如果 $A_{p,raw}(t)  0$，评估条件 $a_c  \\lambda D(t)$：\n    \\begin{itemize}\n        \\item 如果 $a_c  \\lambda D(t)$，最优解为 $g_s^{\\star}(t) = A_{p,raw}(t) / a_c$。\n        \\item 如果 $a_c \\le \\lambda D(t)$，最优解为 $g_s^{\\star}(t) = 0$。\n    \\end{itemize}\n\n值得注意的是，测试案例 5 的描述（“中午出现边界条件”）表明在中午 $t=12$ 时存在一个边界条件。相关的边界条件是决胜条件 $a_c = \\lambda D(t)$，这标志着最优策略的转换。使用案例 5 的参数（$a_c=225, \\lambda=7500, D_{base}=0.02, D_{amp}=0.01$）进行计算表明，该等式在 $225 = 7500 D(t)$ 或 $D(t) = 0.03$ 时成立。$D(t)$ 的这个值在 $t=18$ 小时达到，而不是在中午。在 $t=18$ 小时，$I(t)=0$，导致 $A_{p,raw}(t) \\le 0$，因此无论决胜条件如何，$g_s^{\\star}(18)=0$。实现将精确遵循提供的数值参数，因为这种差异不会使问题失效，问题仍然由其数学和物理公式明确定义。推导至此完成。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the diurnal course of optimal stomatal conductance based on Cowan-Farquhar theory.\n    \"\"\"\n    # Test suite (A_max, k, R_d, a_c, lambda, I_max, D_base, D_amp)\n    test_cases = [\n        (30, 0.005, 1, 225, 8000, 1500, 0.02, 0.01),\n        (30, 0.005, 1, 225, 20000, 1500, 0.02, 0.01),\n        (30, 0.005, 1, 225, 8000, 1500, 0.01, 0.005),\n        (30, 0.005, 1, 225, 8000, 0, 0.02, 0.01),\n        (30, 0.005, 1, 225, 7500, 1500, 0.02, 0.01),\n    ]\n\n    all_results = []\n    time_grid = np.arange(0, 25, 1) # t in {0, 1, ..., 24}\n\n    for case in test_cases:\n        A_max, k, R_d, a_c, lam, I_max, D_base, D_amp = case\n        \n        case_gs_results = []\n        for t in time_grid:\n            # Calculate environmental forcings I(t) and D(t)\n            # 1. Photosynthetic Photon Flux Density I(t)\n            t_rise = 6.0\n            t_set = 18.0\n            L = 12.0\n            if t_rise = t = t_set:\n                I_t = I_max * np.sin(np.pi * (t - t_rise) / L)\n            else:\n                I_t = 0.0\n            \n            # 2. Vapor Pressure Deficit D(t)\n            D_t = D_base + D_amp * np.sin(2 * np.pi * (t - 12.0) / 24.0)\n\n            # Calculate potential assimilation rate A_p(t)\n            A_p_raw = A_max * (1 - np.exp(-k * I_t)) - R_d\n\n            # Determine optimal stomatal conductance g_s_star(t)\n            g_s_star = 0.0\n            if A_p_raw  0:\n                # If potential assimilation is positive, check optimality condition\n                if a_c  lam * D_t:\n                    g_s_star = A_p_raw / a_c\n                else:\n                    # Condition a_c = lam * D_t, includes tie-break\n                    g_s_star = 0.0\n            # If A_p_raw = 0, g_s_star remains 0 as initialized per problem spec.\n\n            case_gs_results.append(g_s_star)\n\n        # Format results for the current case\n        case_str_results = f\"[{','.join([f'{val:.6f}' for val in case_gs_results])}]\"\n        all_results.append(case_str_results)\n\n    # Final print statement in the exact required format.\n    final_output = f\"[{','.join(all_results)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2610145"}]}