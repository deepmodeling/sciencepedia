{"hands_on_practices": [{"introduction": "选择正确的光遗传学执行器是设计成功实验的基础步骤。本练习超越了简单的激活或抑制，挑战您去比较两种不同的抑制性离子泵。通过分析它们与神经元基线生物物理特性的相互作用，您将学会评估关键的次级效应，如被动离子流的变化和离子平衡电位的漂移，这项技能对于预测实验操控的鲁棒性和可靠性至关重要。[@problem_id:2589067]", "problem": "一位神经科学家必须选择一种光遗传泵，在电流钳模式下抑制一个皮层锥体神经元。有两种光驱动生电泵可供选择：一种是光驱动氯离子泵（光照时主动将氯离子转运入胞质溶胶），另一种是光驱动质子泵（光照时主动将质子转运出胞质溶胶）。在基线状态下，该神经元的静息膜电位为 $V_m = -65\\ \\text{mV}$，氯离子平衡电位为 $E_{\\text{Cl}} = -70\\ \\text{mV}$。在温度 $T = 37^\\circ \\text{C}$ 时，细胞外和细胞内的酸度分别为 $\\text{pH}_o = 7.4$ 和 $\\text{pH}_i = 7.2$。该神经元的输入电阻为 $R_{\\text{in}} = 150\\ \\text{M}\\Omega$。在相同的辐照度下，两种泵都产生大小相同的稳定向外正膜电流 $I_{\\text{pump}} = 100\\ \\text{pA}$（氯离子泵电流对应于负电荷的向内移动；质子泵电流对应于正电荷的向外移动）。\n\n请仅使用基本定义，判断在 $200\\ \\text{ms}$ 的光脉冲期间，哪种泵会产生更稳健且可预测的超极化。您的论证必须包括：\n- 计算静息膜电位（$V_m$）下，氯离子和质子被动通量的初始电化学驱动力（使用平衡电位）。\n- 根据施加的泵电流和膜输入电阻，计算光照期间预期的稳态超极化幅度。\n- 一个简要的机制性论证，说明在脉冲持续时间内，$V_m$ 与每种离子平衡电位之间的关系将如何影响超极化的可持续性和可预测性。\n\n选择唯一的最佳选项。\n\nA. 选择氯离子泵。因为静息时 $V_m - E_{\\text{Cl}} = +5\\ \\text{mV}$，有利于氯离子内流，并将强烈地使细胞超极化。稳态超极化因驱动力小而被限制在约 $5\\ \\text{mV}$，这是最优的，可以防止过度抑制。\n\nB. 选择质子泵。在这些 pH 值下，质子平衡电位在静息时产生一个很大的驱动力，但泵的运作并不需要这个驱动力。在 $I_{\\text{pump}} = 100\\ \\text{pA}$ 和 $R_{\\text{in}} = 150\\ \\text{M}\\Omega$ 的条件下，预期的超极化约为 $15\\ \\text{mV}$。相比之下，一旦 $V_m$ 降至 $E_{\\text{Cl}}$ 以下，氯离子泵将面临相反的被动氯离子外流，并且在脉冲期间会积累细胞内氯离子，从而破坏持续的抑制作用。\n\nC. 两种泵是等效的。因为 $I_{\\text{pump}} = 100\\ \\text{pA}$ 和 $R_{\\text{in}} = 150\\ \\text{M}\\Omega$，两者都产生完全相同的 $15\\ \\text{mV}$ 持续超极化；初始的电化学驱动力是无关紧要的，并且在脉冲的时间尺度上，长期的离子效应可以忽略不计。\n\nD. 选择氯离子泵。因为 $E_{\\text{Cl}}$ 比 $V_m$ 更负，膜电位将被精确地驱动到 $E_{\\text{Cl}}$（约 $5\\ \\text{mV}$ 的超极化）。质子泵会使神经元去极化，因为质子平衡电位没有 $V_m$ 那么负。", "solution": "题目要求评估两种光遗传抑制性泵——氯离子泵和质子泵，以确定哪一种能对神经元产生更稳健和可预测的超极化。首先必须确定问题陈述的有效性。\n\n### 第一步：提取已知条件\n- **神经元类型**：皮层锥体神经元\n- **实验条件**：电流钳\n- **工具1**：光驱动氯离子泵（将 $\\text{Cl}^-$ 转运入胞质溶胶）。\n- **工具2**：光驱动质子泵（将 $\\text{H}^+$ 转运出胞质溶胶）。\n- **静息膜电位**：$V_m = -65\\ \\text{mV}$\n- **氯离子平衡电位**：$E_{\\text{Cl}} = -70\\ \\text{mV}$\n- **细胞外pH**：$\\text{pH}_o = 7.4$\n- **细胞内pH**：$\\text{pH}_i = 7.2$\n- **温度**：$T = 37^\\circ \\text{C}$\n- **输入电阻**：$R_{\\text{in}} = 150\\ \\text{M}\\Omega$\n- **泵电流**：$I_{\\text{pump}} = 100\\ \\text{pA}$（两种泵均为向外正电流）。\n- **脉冲持续时间**：$200\\ \\text{ms}$\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据**：该问题很好地基于细胞神经生理学和生物物理学的基本原理，包括膜电位、Nernst电位、膜的欧姆定律以及离子泵的作用。问题中描述的工具，即光遗传氯离子泵和质子泵（例如，分别为Halorhodopsin和Archaerhodopsin），是现代神经科学中的标准工具。所有给定的参数（$V_m$、$E_{\\text{Cl}}$、pH、$R_{\\text{in}}$、$I_{\\text{pump}}$）在生理上都是现实的。\n- **问题的适定性**：问题提供了进行必要计算和得出结论所需的所有信息。问题是具体的，可以从给定的数据中逻辑地推导出答案。\n- **客观性**：语言精确且定量，没有主观或含糊的术语。\n\n### 第三步：结论与行动\n问题陈述在科学上是合理的、自洽的且适定的。因此，它是 **有效的**。我将继续进行解答。\n\n根据题目的要求，解答需要包含三个部分。\n\n**1. 计算初始电化学驱动力**\n\n离子的电化学驱动力由膜电位（$V_m$）和该离子的平衡电位（$E_{\\text{ion}}$）之差给出，即 $V_m - E_{\\text{ion}}$。\n\n- **氯离子（$\\text{Cl}^-$）**：\n氯离子平衡电位给定为 $E_{\\text{Cl}} = -70\\ \\text{mV}$。\n静息时被动 $\\text{Cl}^-$ 通量的驱动力为：\n$$V_m - E_{\\text{Cl}} = (-65\\ \\text{mV}) - (-70\\ \\text{mV}) = +5\\ \\text{mV}$$\n对负离子（$\\text{Cl}^-$）的正向驱动力会导致该离子的被动内流，这是一种超极化电流。\n\n- **质子（$\\text{H}^+$）**：\n质子平衡电位 $E_{\\text{H}}$ 必须使用Nernst方程计算：\n$$E_{\\text{H}} = \\frac{RT}{zF} \\ln\\left(\\frac{[\\text{H}^+]_o}{[\\text{H}^+]_i}\\right)$$\n这里，质子的电荷为 $z=+1$。气体常数 $R \\approx 8.314\\ \\text{J}\\cdot\\text{mol}^{-1}\\cdot\\text{K}^{-1}$，法拉第常数 $F \\approx 96485\\ \\text{C}\\cdot\\text{mol}^{-1}$，温度 $T = 37 + 273.15 = 310.15\\ \\text{K}$。$\\frac{RT}{F}$ 项约为 $26.7\\ \\text{mV}$。\n浓度由pH值得出：$[\\text{H}^+] = 10^{-\\text{pH}}$。\n$[\\text{H}^+]_o = 10^{-7.4}\\ \\text{M}$ 且 $[\\text{H}^+]_i = 10^{-7.2}\\ \\text{M}$。\n浓度比为 $\\frac{[\\text{H}^+]_o}{[\\text{H}^+]_i} = \\frac{10^{-7.4}}{10^{-7.2}} = 10^{-0.2}$。\n使用以10为底的对数形式，$E_{\\text{ion}} = \\frac{2.303 RT}{zF} \\log_{10}\\left(\\frac{[\\text{ion}]_o}{[\\text{ion}]_i}\\right)$，在 $37^\\circ \\text{C}$ 时，$\\frac{2.303 RT}{F} \\approx 61.5\\ \\text{mV}$：\n$$E_{\\text{H}} = (61.5\\ \\text{mV}) \\log_{10}(10^{-0.2}) = (61.5\\ \\text{mV})(-0.2) = -12.3\\ \\text{mV}$$\n静息时被动 $\\text{H}^+$ 通量的驱动力为：\n$$V_m - E_{\\text{H}} = (-65\\ \\text{mV}) - (-12.3\\ \\text{mV}) = -52.7\\ \\text{mV}$$\n对正离子（$\\text{H}^+$）的负向驱动力会导致该离子的被动内流，这是一种去极化电流。\n\n**2. 计算预期的稳态超极化**\n\n两种泵都被描述为电流源，提供稳定的 $I_{\\text{pump}} = 100\\ \\text{pA}$ 向外正电流。向外电流使神经元超极化。根据应用于整个细胞的欧姆定律，膜电位的变化（$\\Delta V_m$）是注入电流和输入电阻（$R_{\\text{in}}$）的乘积。\n$$ \\Delta V_m = I_{\\text{pump}} \\times R_{\\text{in}} $$\n给定 $I_{\\text{pump}} = 100\\ \\text{pA} = 100 \\times 10^{-12}\\ \\text{A}$ 和 $R_{\\text{in}} = 150\\ \\text{M}\\Omega = 150 \\times 10^6\\ \\Omega$：\n$$ \\Delta V_m = (100 \\times 10^{-12}\\ \\text{A}) \\times (150 \\times 10^6\\ \\Omega) = 15000 \\times 10^{-6}\\ \\text{V} = 15\\ \\text{mV} $$\n这是一个超极化，所以新的稳态膜电位 $V_{\\text{ss}}$ 预计为：\n$$ V_{\\text{ss}} = V_m - \\Delta V_m = -65\\ \\text{mV} - 15\\ \\text{mV} = -80\\ \\text{mV} $$\n此计算假设泵作为一个理想的电流源，并且 $R_{\\text{in}}$ 保持不变。\n\n**3. 关于稳健性和可预测性的机制性论证**\n\n这个问题的关键在于理解被泵送离子的被动通量如何与主动转运相互作用。这决定了抑制作用的稳健性（可持续性）和可预测性。\n\n- **氯离子泵**：该泵主动将 $\\text{Cl}^-$ 离子移入细胞。预测的超极化会将膜电位带到 $V_{\\text{ss}} = -80\\ \\text{mV}$。氯离子平衡电位为 $E_{\\text{Cl}} = -70\\ \\text{mV}$。一旦膜电位变得比 $E_{\\text{Cl}}$ 更负，被动 $\\text{Cl}^-$ 通量的驱动力 $V_m - E_{\\text{Cl}}$ 就变为负值。对于带负电的 $\\text{Cl}^-$，这种负向驱动力将导致被动的**外流**（$\\text{Cl}^-$ 的向外运动）。这种被动外流构成了一种向内电流，是去极化的，并直接抵消了泵的超极化效应。这种分流电流的存在意味着实际的超极化将小于预测的 $15\\ \\text{mV}$。此外，$\\text{Cl}^-$ 的主动内流会增加其细胞内浓度 $[\\text{Cl}^-]_i$。根据 $\\text{Cl}^-$ 的Nernst方程（$z=-1$），$[\\text{Cl}^-]_i$ 的增加会使 $E_{\\text{Cl}}$ 变得不那么负（即去极化）。这种现象，被称为抑制电位的衰减，会在刺激持续时间内降低泵的有效性，并使抑制水平不稳定且不可预测。\n\n- **质子泵**：该泵主动将 $\\text{H}^+$ 离子移出细胞。这是一个向外电流，将膜超极化到同样的目标 $V_{\\text{ss}} = -80\\ \\text{mV}$。质子平衡电位为 $E_{\\text{H}} = -12.3\\ \\text{mV}$。被动 $\\text{H}^+$ 通量的驱动力 $V_m - E_{\\text{H}}$ 在静息时已经是负值（$-52.7\\ \\text{mV}$），在超极化电位下会变得更负（$-67.7\\ \\text{mV}$）。这种大的负向驱动力有利于 $\\text{H}^+$ 的被动内流，这是一种去极化电流，与氯离子的情况一样，它会对抗泵的作用。但是，有两个关键因素使质子泵与众不同：\n    1.  静息膜对质子的通透性极低（$g_{\\text{H}} \\approx 0$）。因此，即使有很大的驱动力，对抗性的被动电流 $I_{\\text{passive,H}} = g_{\\text{H}}(V_m - E_{\\text{H}})$ 也是可以忽略不计的。\n    2.  细胞内和细胞外空间对pH值的变化有很强的缓冲能力。泵移除的质子会迅速被细胞内缓冲物质释放的质子所补偿。因此，在短暂的 $200\\ \\text{ms}$ 脉冲期间，细胞内质子浓度 $[\\text{H}^+]_i$ 以及 $E_{\\text{H}}$ 基本上保持恒定。\n由于这两个因素，质子泵的作用接近一个理想的电流源。它的效应不会被被动通量或其自身反转电位的变化显著地抵消。由此产生的超极化将非常接近预测的 $15\\ \\text{mV}$，并且在整个光脉冲期间保持稳定。\n\n**结论**：质子泵会产生更稳健和可预测的超极化。\n\n### 逐项分析选项\n\n- **A. 选择氯离子泵。因为静息时 $V_m - E_{\\text{Cl}} = +5\\ \\text{mV}$，有利于氯离子内流，并将强烈地使细胞超极化。稳态超极化因驱动力小而被限制在约 $5\\ \\text{mV}$，这是最优的，可以防止过度抑制。**\n  - 这种说法错误地将通道（一种电导）的逻辑应用于泵（一个电流源）。泵的电流主要不是由电化学驱动力决定的。如果它是一个通道，它会把电压钳制在 $E_{\\text{Cl}}$ 附近，导致约 $5\\ \\text{mV}$ 的超极化。但是，一个 $100\\ \\text{pA}$ 的泵电流会导致一个大得多的超极化，如计算所示。\n  - **结论：错误。**\n\n- **B. 选择质子泵。在这些 pH 值下，质子平衡电位在静息时产生一个很大的驱动力，但泵的运作并不需要这个驱动力。在 $I_{\\text{pump}} = 100\\ \\text{pA}$ 和 $R_{\\text{in}} = 150\\ \\text{M}\\Omega$ 的条件下，预期的超极化约为 $15\\ \\text{mV}$。相比之下，一旦 $V_m$ 降至 $E_{\\text{Cl}}$ 以下，氯离子泵将面临相反的被动氯离子外流，并且在脉冲期间会积累细胞内氯离子，从而破坏持续的抑制作用。**\n  - 这个选项正确地指出质子泵是更好的选择。它正确地陈述了泵是主动转运体。它正确地根据欧姆定律计算了预期的超极化。最重要的是，它正确地指出了在这种情况下氯离子泵的两个主要缺陷：通过将 $V_m$ 驱动到超过 $E_{\\text{Cl}}$ 而产生一个对抗性的被动通量，以及由于离子积累导致的抑制作用衰减。这与我们的推导完全一致。\n  - **结论：正确。**\n\n- **C. 两种泵是等效的。因为 $I_{\\text{pump}} = 100\\ \\text{pA}$ 和 $R_{\\text{in}} = 150\\ \\text{M}\\Omega$，两者都产生完全相同的 $15\\ \\text{mV}$ 持续超极化；初始的电化学驱动力是无关紧要的，并且在脉冲的时间尺度上，长期的离子效应可以忽略不计。**\n  - 这种说法过于简化。它忽略了与所运输的特定离子相关的关键次级效应。正如分析的那样，等效性不成立，因为氯离子泵的作用受到被动通量和离子积累的积极对抗，而质子泵的作用在任何显著程度上都不受影响。关于离子效应在此时间尺度上可以忽略不计的断言对氯离子来说是不正确的。\n  - **结论：错误。**\n\n- **D. 选择氯离子泵。因为 $E_{\\text{Cl}}$ 比 $V_m$ 更负，膜电位将被精确地驱动到 $E_{\\text{Cl}}$（约 $5\\ \\text{mV}$ 的超极化）。质子泵会使神经元去极化，因为质子平衡电位没有 $V_m$ 那么负。**\n  - 这个选项包含两个基本错误。首先，和选项A一样，它混淆了泵和通道；泵不会将电压钳制在离子的平衡电位。其次，它错误地声称质子泵会使神经元去极化。该泵主动将正电荷移出，根据定义，这是一种超极化的向外电流，无论 $E_{\\text{H}}$ 的值是多少。\n  - **结论：错误。**", "answer": "$$\\boxed{B}$$", "id": "2589067"}, {"introduction": "选定工具后，确保将光有效递送到*在体*（*in vivo*）深部组织靶点变得至关重要。本实践将带您深入探讨光在如大脑等高散射介质中传播的物理学原理。通过运用扩散近似理论，您将学习如何估算特定深度的光照强度，这是设计既能有效激活神经元又对组织安全的光照参数的一项关键计算技能。[@problem_id:2589112]", "problem": "一个表达黄色吸收光遗传学执行器的转基因神经元群体，在皮质表面被波长为 $590\\ \\mathrm{nm}$ 的连续波（CW）平面光束照射，入射辐照度为 $I_{0} = 20\\ \\mathrm{mW\\ mm^{-2}}$。脑组织可被建模为一个均匀、半无限、高散射的介质，其特征在于吸收系数 $\\mu_{a}$ 和约化散射系数 $\\mu_{s}'$，其中 $\\mu_{s}' = \\mu_{s}(1-g)$，$g$ 为散射各向异性因子。假设系统处于稳态，横向方向上空间均匀，并且辐射传输方程（RTE）的扩散近似对于描述光在该介质中的传播是有效的。从辐射能量守恒和关联光子通量与标量辐照度梯度的 Fick 定律出发，推导无源区中标量辐照度的一维深度依赖关系。利用此关系式，得到深度 $z$ 处的光强关于 $\\mu_{a}$、$\\mu_{s}'$ 和 $I_{0}$ 的表达式，然后在参数值为 $\\mu_{a} = 0.04\\ \\mathrm{mm^{-1}}$ 和 $\\mu_{s}' = 1.1\\ \\mathrm{mm^{-1}}$ 的情况下，计算其在 $z = 1\\ \\mathrm{mm}$ 处的值。假设表面边界条件可以近似为：对于宽的均匀光束，解满足 $I(0) = I_{0}$。将最终数值答案四舍五入至四位有效数字。以 $\\mathrm{mW\\ mm^{-2}}$ 为单位表示最终光强。", "solution": "问题陈述已经过验证，被认为是科学上合理的、适定的和客观的。它提供了一组足以基于辐射传输方程的扩散近似得到唯一解的参数和假设。我们现在开始进行推导和求解。\n\n问题要求在一个无源、半无限、均匀散射介质中，推导标量辐照度（此处用能量通量率 $\\Phi(z)$ 表示）的一维深度依赖关系。我们从稳态下的辐射能量守恒原理开始。在一个没有光源的体积元中，从该体积流出的净能量速率必须等于其内部吸收的能量速率。这在数学上表示为：\n$$ \\nabla \\cdot \\vec{J}(\\vec{r}) = -S_{a}(\\vec{r}) $$\n其中 $\\vec{J}(\\vec{r})$ 是光子通量矢量（能量的净通量），$S_{a}(\\vec{r})$ 是单位体积吸收的功率。吸收的功率由吸收系数 $\\mu_{a}$ 与局部能量通量率 $\\Phi(\\vec{r})$ 的乘积给出，因此 $S_{a}(\\vec{r}) = \\mu_{a} \\Phi(\\vec{r})$。守恒方程变为：\n$$ \\nabla \\cdot \\vec{J}(\\vec{r}) = -\\mu_{a} \\Phi(\\vec{r}) $$\n扩散近似假定，在高散射介质中，光子通量是由能量通量率的梯度驱动的，这类似于扩散过程。这个关系是应用于光子的 Fick 第一扩散定律：\n$$ \\vec{J}(\\vec{r}) = -D \\nabla \\Phi(\\vec{r}) $$\n其中 $D$ 是光扩散系数。对于吸收系数为 $\\mu_{a}$ 和约化散射系数为 $\\mu_{s}'$ 的介质，扩散系数由下式给出：\n$$ D = \\frac{1}{3(\\mu_{a} + \\mu_{s}')} $$\n将 Fick 定律代入守恒方程，我们得到：\n$$ \\nabla \\cdot \\left( -D \\nabla \\Phi(\\vec{r}) \\right) = -\\mu_{a} \\Phi(\\vec{r}) $$\n假设介质是均匀的，光学性质 $\\mu_{a}$ 和 $\\mu_{s}'$ 是常数，这意味着 $D$ 也是一个常数。方程简化为：\n$$ D \\nabla^2 \\Phi(\\vec{r}) = \\mu_{a} \\Phi(\\vec{r}) $$\n重新整理得到稳态扩散方程，这是一个 Helmholtz 方程：\n$$ \\nabla^2 \\Phi(\\vec{r}) - \\frac{\\mu_{a}}{D} \\Phi(\\vec{r}) = 0 $$\n我们定义一个有效衰减系数 $\\mu_{\\text{eff}}$，使得 $\\mu_{\\text{eff}}^2 = \\frac{\\mu_{a}}{D}$。代入 $D$ 的表达式：\n$$ \\mu_{\\text{eff}}^2 = \\frac{\\mu_{a}}{\\frac{1}{3(\\mu_{a} + \\mu_{s}')}} = 3\\mu_{a}(\\mu_{a} + \\mu_{s}') $$\n因此，$\\mu_{\\text{eff}} = \\sqrt{3\\mu_{a}(\\mu_{a} + \\mu_{s}')}$。扩散方程为：\n$$ \\nabla^2 \\Phi(\\vec{r}) - \\mu_{\\text{eff}}^2 \\Phi(\\vec{r}) = 0 $$\n问题指定了一个入射到表面的宽平面光束，在横向维度上空间均匀。这将问题简化为一维问题，仅依赖于深度 $z$。能量通量率为 $\\Phi(\\vec{r}) = \\Phi(z)$，拉普拉斯算子变为 $\\nabla^2 = \\frac{d^2}{dz^2}$。方程现在是一个常微分方程：\n$$ \\frac{d^2\\Phi(z)}{dz^2} - \\mu_{\\text{eff}}^2 \\Phi(z) = 0 $$\n这个二阶线性齐次常微分方程的通解是：\n$$ \\Phi(z) = C_{1} \\exp(-\\mu_{\\text{eff}} z) + C_{2} \\exp(\\mu_{\\text{eff}} z) $$\n我们应用边界条件来求解常数 $C_{1}$ 和 $C_{2}$。对于半无限介质（$z \\ge 0$），当 $z \\to \\infty$ 时，能量通量率不能发散。这要求增长的指数项的系数为零，因此 $C_{2} = 0$。于是解为：\n$$ \\Phi(z) = C_{1} \\exp(-\\mu_{\\text{eff}} z) $$\n问题陈述要求在表面 $z=0$ 处使用简化的边界条件，即 $\\Phi(0) = I_{0}$，其中 $I_{0}$ 是入射辐照度。应用此条件：\n$$ \\Phi(0) = C_{1} \\exp(0) = C_{1} = I_{0} $$\n因此，随深度变化的能量通量率（在问题陈述中称为“光强”）的特解是：\n$$ \\Phi(z) = I_{0} \\exp(-\\mu_{\\text{eff}} z) = I_{0} \\exp\\left(-z\\sqrt{3\\mu_{a}(\\mu_{a} + \\mu_{s}')}\\right) $$\n现在，我们使用给定的参数来计算这个表达式的值：\n入射辐照度，$I_{0} = 20\\ \\mathrm{mW\\ mm^{-2}}$\n吸收系数，$\\mu_{a} = 0.04\\ \\mathrm{mm^{-1}}$\n约化散射系数，$\\mu_{s}' = 1.1\\ \\mathrm{mm^{-1}}$\n深度，$z = 1\\ \\mathrm{mm}$\n\n首先，我们计算有效衰减系数 $\\mu_{\\text{eff}}$：\n$$ \\mu_{\\text{eff}} = \\sqrt{3 \\times (0.04\\ \\mathrm{mm^{-1}}) \\times (0.04\\ \\mathrm{mm^{-1}} + 1.1\\ \\mathrm{mm^{-1}})} $$\n$$ \\mu_{\\text{eff}} = \\sqrt{0.12\\ \\mathrm{mm^{-1}} \\times 1.14\\ \\mathrm{mm^{-1}}} $$\n$$ \\mu_{\\text{eff}} = \\sqrt{0.1368\\ \\mathrm{mm^{-2}}} \\approx 0.3698648\\ \\mathrm{mm^{-1}} $$\n接下来，我们计算在 $z = 1\\ \\mathrm{mm}$ 处的能量通量率：\n$$ \\Phi(z=1\\ \\mathrm{mm}) = (20\\ \\mathrm{mW\\ mm^{-2}}) \\times \\exp(-\\mu_{\\text{eff}} \\times 1\\ \\mathrm{mm}) $$\n$$ \\Phi(1\\ \\mathrm{mm}) = 20 \\times \\exp(-\\sqrt{0.1368}) $$\n$$ \\Phi(1\\ \\mathrm{mm}) \\approx 20 \\times \\exp(-0.3698648) $$\n$$ \\Phi(1\\ \\mathrm{mm}) \\approx 20 \\times 0.6908200 $$\n$$ \\Phi(1\\ \\mathrm{mm}) \\approx 13.81640\\ \\mathrm{mW\\ mm^{-2}} $$\n问题要求将最终数值答案四舍五入至四位有效数字。\n$$ \\Phi(1\\ \\mathrm{mm}) \\approx 13.82\\ \\mathrm{mW\\ mm^{-2}} $$\n这即是在给定模型和假设下，于指定深度的光强值。", "answer": "$$\\boxed{13.82}$$", "id": "2589112"}, {"introduction": "有效的实验设计最终归结为优化刺激方案，以实现预期结果，同时将副作用降至最低。这项计算练习旨在解决在最大化视蛋白激活与限制组织加热之间的关键权衡问题。您将运用编程来寻找最佳的光脉冲频率 $f$ 与占空比 $D$，这需要您整合对视蛋白动力学和组织热力学模型的理解，以设计出一个高效且安全的刺激范式。[@problem_id:2589134]", "problem": "一个实验室使用光遗传学刺激来驱动表达光门控离子通道（视蛋白）的神经元中的离子光电流。光以周期性方波的形式传递，频率为 $f$（单位为 $\\mathrm{Hz}$），占空比为 $D$（无量纲的小数十进制分数，表示光照开启时间占周期的比例）。光照开启阶段的辐照度是一个固定的振幅 $P$（单位为 $\\mathrm{W/mm^2}$），在光照关闭阶段则为 $0$。视蛋白光电流分数由一个双态门控变量 $O(t)$ 建模，该变量在光照期间以时间常数 $\\tau_{\\mathrm{on}}$（单位为 $\\mathrm{s}$）指数松弛至 $1$，在黑暗中以时间常数 $\\tau_{\\mathrm{off}}$（单位为 $\\mathrm{s}$）指数松弛至 $0$。组织加热被建模为一个集总一阶线性系统，用于表示高出基线的温升 $\\Delta T(t)$（单位为 ${}^\\circ\\mathrm{C}$），该温升由吸收的光功率密度驱动，具有热时间常数 $\\tau_{\\mathrm{th}}$（单位为 $\\mathrm{s}$）；加热驱动与辐照度成正比，比例常数为 $\\beta$（单位为 ${}^\\circ\\mathrm{C}\\, \\mathrm{s}^{-1} \\, (\\mathrm{W/mm^2})^{-1}$）。假设光振幅 $P$ 足够高，使得对于此 $P$ 值，视蛋白的光照动力学由给定的 $\\tau_{\\mathrm{on}}$ 和 $\\tau_{\\mathrm{off}}$ 决定。\n\n基本原理：\n- 光电流门控动力学遵循一阶线性微分方程：光照开启期间 $dO/dt = (1 - O)/\\tau_{\\mathrm{on}}$，光照关闭期间 $dO/dt = -O/\\tau_{\\mathrm{off}}$，其中 $O(t)$ 被限制在 $[0,1]$ 区间内。\n- 集总热动力学遵循线性微分方程 $d\\Delta T/dt = -\\Delta T/\\tau_{\\mathrm{th}} + \\beta\\, u(t)$，其中 $u(t)$ 在光照开启期间等于 $P$，在光照关闭期间等于 $0$。\n\n你的任务是编写一个程序，对于下面的每个测试用例，搜索一个预定义的候选脉冲策略网格，并返回一个同时满足以下条件的策略：\n- 保持稳态周期峰值温升严格低于 $1\\,{}^\\circ\\mathrm{C}$，并且\n- 在一个完整周期内平均达到最大光电流的至少 $0.7$（即，在一个周期内 $O(t)$ 的时间平均值大于或等于 $0.7$）。\n\n要求：\n1. 对于给定的 $(f, D)$ 对，将刺激视为周期为 $T_{\\mathrm{cyc}} = 1/f$、光照开启持续时间为 $T_{\\mathrm{on}} = D/f$、光照关闭持续时间为 $T_{\\mathrm{off}} = (1 - D)/f$ 的周期性方波。\n2. 确定由分段线性动力学所隐含的 $O(t)$ 跨周期的唯一稳态周期解。根据此周期解，计算 $O(t)$ 在一个周期内的精确时间平均值。将此平均值解释为相对于饱和最大电流的平均光电流分数。\n3. 确定由分段线性热动力学所隐含的 $\\Delta T(t)$ 跨周期的唯一稳态周期解。根据此周期解，计算周期内的峰值温升（$\\Delta T(t)$ 在一个周期内的最大值）。\n4. 可行性标准：平均光电流分数大于或等于 $0.7$ 且峰值温升严格小于 $1\\,{}^\\circ\\mathrm{C}$。\n5. 候选网格：频率 $f \\in \\{5, 10, 20, 40, 80\\}$（单位 $\\mathrm{Hz}$）和占空比 $D \\in \\{0.05, 0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.45, 0.50\\}$（无量纲小数十进制分数）。\n6. 如果存在可行策略的选择规则：选择 $D$ 最小的策略；如果多个策略共享该最小 $D$，则选择 $f$ 最小的那个。如果不存在可行策略，则报告不可行。\n7. 为每个测试用例输出一个包含四个条目的列表：$[D, f, \\Delta T_{\\mathrm{peak}}, \\overline{O}]$，其中 $D$ 是无量纲的， $f$ 的单位是 $\\mathrm{Hz}$，$\\Delta T_{\\mathrm{peak}}$ 的单位是 ${}^\\circ\\mathrm{C}$，$\\overline{O}$ 是无量纲的。将 $D$ 表示到小数点后三位，$f$ 到小数点后一位，$\\Delta T_{\\mathrm{peak}}$ 到小数点后四位，$\\overline{O}$ 到小数点后四位。如果不可行，输出 $[-1.0,-1.0,-1.0,-1.0]$。\n8. 你的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素是对应一个测试用例的四元素列表，顺序与下方相同。\n\n测试套件（所有时间单位为 $\\mathrm{s}$，辐照度单位为 $\\mathrm{W/mm^2}$）：\n- 案例 A（理想情况）：$\\tau_{\\mathrm{on}} = 0.005$, $\\tau_{\\mathrm{off}} = 0.015$, $P = 0.010$, $\\tau_{\\mathrm{th}} = 1.0$, $\\beta = 50.0$.\n- 案例 B（较慢的关闭动力学，中等加热）：$\\tau_{\\mathrm{on}} = 0.010$, $\\tau_{\\mathrm{off}} = 0.100$, $P = 0.015$, $\\tau_{\\mathrm{th}} = 0.8$, $\\beta = 40.0$.\n- 案例 C（快速视蛋白，较高辐照度）：$\\tau_{\\mathrm{on}} = 0.003$, $\\tau_{\\mathrm{off}} = 0.008$, $P = 0.030$, $\\tau_{\\mathrm{th}} = 1.2$, $\\beta = 40.0$.\n- 案例 D（非常慢的激活，严格的热限制）：$\\tau_{\\mathrm{on}} = 0.030$, $\\tau_{\\mathrm{off}} = 0.200$, $P = 0.080$, $\\tau_{\\mathrm{th}} = 1.5$, $\\beta = 40.0$.\n\n未使用角度单位。确保所有数值答案遵循其指定的单位和舍入规则。", "solution": "所呈现的问题是一个定义明确、有科学依据的练习，旨在分析由共同方波输入驱动的两个耦合一阶线性系统的稳态周期响应。光遗传通道门控和集总参数组织加热的模型是生物物理学和生物工程学中的标准表示方法。所有参数、约束和目标都已明确定义，从而可以得到一个严谨且唯一的解。因此，该问题是有效的。\n\n任务是从指定的候选网格中找到一个由频率 $f$ 和占空比 $D$ 定义的最优刺激策略。最优策略必须同时满足两个标准：稳态周期峰值温升 $\\Delta T_{\\mathrm{peak}}$ 必须严格小于 $1\\,{}^\\circ\\mathrm{C}$，且时间平均视蛋白激活度 $\\overline{O}$ 必须至少为 $0.7$。选择规则要求选择具有最小 $D$ 的可行策略，在这些策略中，再选择具有最小 $f$ 的那个。\n\n为了解决这个问题，我们必须首先推导出 $\\Delta T_{\\mathrm{peak}}$ 和 $\\overline{O}$ 作为刺激参数 $(f, D)$ 和系统物理参数的函数的解析表达式。\n\n设刺激的周期为 $T_{\\mathrm{cyc}} = 1/f$。光照开启阶段的持续时间为 $T_{\\mathrm{on}} = D \\cdot T_{\\mathrm{cyc}} = D/f$，光照关闭阶段的持续时间为 $T_{\\mathrm{off}} = (1-D) \\cdot T_{\\mathrm{cyc}} = (1-D)/f$。\n\n**1. 视蛋白光电流门控, $O(t)$**\n\n门控变量 $O(t)$ 由两个线性常微分方程 (ODE) 控制：\n- 光照开启 ($0 \\le t < T_{\\mathrm{on}}$): $\\frac{dO}{dt} = \\frac{1-O}{\\tau_{\\mathrm{on}}}$\n- 光照关闭 ($0 \\le t' < T_{\\mathrm{off}}$, 其中 $t' = t - T_{\\mathrm{on}}$): $\\frac{dO}{dt'} = -\\frac{O}{\\tau_{\\mathrm{off}}}$\n\n在稳态周期状态下，$O(t)$ 在光照开启阶段开始时的最小值 $O_{\\mathrm{min}}$ 和结束时的最大值 $O_{\\mathrm{max}}$ 之间振荡。求解ODE并应用周期性条件 $O(T_{\\mathrm{cyc}}) = O(0) = O_{\\mathrm{min}}$，可以得到这些边界的表达式：\n$$O_{\\mathrm{max}} = 1 - (1 - O_{\\mathrm{min}}) e^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{on}}}$$\n$$O_{\\mathrm{min}} = O_{\\mathrm{max}} e^{-T_{\\mathrm{off}}/\\tau_{\\mathrm{off}}}$$\n求解这个关于 $O_{\\mathrm{min}}$ 和 $O_{\\mathrm{max}}$ 的方程组，得到：\n$$O_{\\mathrm{max}} = \\frac{1 - e^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{on}}}}{1 - e^{-(T_{\\mathrm{on}}/\\tau_{\\mathrm{on}} + T_{\\mathrm{off}}/\\tau_{\\mathrm{off}})}}$$\n$$O_{\\mathrm{min}} = O_{\\mathrm{max}} e^{-T_{\\mathrm{off}}/\\tau_{\\mathrm{off}}}$$\n\n$O(t)$ 在一个周期内的时间平均值 $\\overline{O}$ 通过在各自区间内对ODE的解进行积分来计算：\n$$\\overline{O} = \\frac{1}{T_{\\mathrm{cyc}}} \\left( \\int_0^{T_{\\mathrm{on}}} O(t) dt + \\int_{T_{\\mathrm{on}}}^{T_{\\mathrm{cyc}}} O(t) dt \\right)$$\n一个直接使用ODE的简单方法是注意到在“开启”阶段 $\\int O dt = \\int (1 - \\tau_{\\mathrm{on}} \\frac{dO}{dt}) dt = t - \\tau_{\\mathrm{on}}O$，在“关闭”阶段 $\\int O dt = \\int (-\\tau_{\\mathrm{off}} \\frac{dO}{dt}) dt = -\\tau_{\\mathrm{off}}O$。这得到：\n$$T_{\\mathrm{cyc}}\\overline{O} = \\left[t - \\tau_{\\mathrm{on}}O(t)\\right]_0^{T_{\\mathrm{on}}} + \\left[-\\tau_{\\mathrm{off}}O(t)\\right]_{T_{\\mathrm{on}}}^{T_{\\mathrm{cyc}}} = (T_{\\mathrm{on}} - \\tau_{\\mathrm{on}}(O_{\\mathrm{max}}-O_{\\mathrm{min}})) + (-\\tau_{\\mathrm{off}}(O_{\\mathrm{min}}-O_{\\mathrm{max}}))$$\n$$\\overline{O} = \\frac{T_{\\mathrm{on}} + (\\tau_{\\mathrm{off}} - \\tau_{\\mathrm{on}})(O_{\\mathrm{max}} - O_{\\mathrm{min}})}{T_{\\mathrm{cyc}}} = D + f(\\tau_{\\mathrm{off}} - \\tau_{\\mathrm{on}})(O_{\\mathrm{max}} - O_{\\mathrm{min}})$$\n\n**2. 组织加热, $\\Delta T(t)$**\n\n温升 $\\Delta T(t)$ 由以下ODE控制：\n$$\\frac{d\\Delta T}{dt} = -\\frac{\\Delta T}{\\tau_{\\mathrm{th}}} + \\beta u(t)$$\n其中驱动项 $u(t)$ 在光照开启时为 $P$，在光照关闭时为 $0$。在稳态周期状态下，$\\Delta T(t)$ 在最小值 $\\Delta T_{\\mathrm{min}}$ 和最大值 $\\Delta T_{\\mathrm{peak}}$ 之间振荡。温度在光照开启阶段上升，在 $t=T_{\\mathrm{on}}$ 时达到其峰值 $\\Delta T_{\\mathrm{peak}}$。然后在光照关闭阶段冷却。\n\n求解两个阶段的ODE并施加周期性条件，得到：\n$$\\Delta T_{\\mathrm{peak}} = \\Delta T_{\\infty,\\mathrm{on}} + (\\Delta T_{\\mathrm{min}} - \\Delta T_{\\infty,\\mathrm{on}})e^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{th}}},\\quad \\text{其中 } \\Delta T_{\\infty,\\mathrm{on}} = \\beta P \\tau_{\\mathrm{th}}$$\n$$\\Delta T_{\\mathrm{min}} = \\Delta T_{\\mathrm{peak}} e^{-T_{\\mathrm{off}}/\\tau_{\\mathrm{th}}}$$\n求解该方程组得到 $\\Delta T_{\\mathrm{peak}}$，即周期内的峰值温升：\n$$\\Delta T_{\\mathrm{peak}} = \\frac{\\beta P \\tau_{\\mathrm{th}} (1 - e^{-T_{\\mathrm{on}}/\\tau_{\\mathrm{th}}})}{1 - e^{-T_{\\mathrm{cyc}}/\\tau_{\\mathrm{th}}}}$$\n\n**3. 搜索与选择算法**\n\n对于每个测试用例，我们遍历候选网格。为满足选择规则（“最小的 $D$，然后是最小的 $f$”），搜索按字典序进行。我们遍历 $D \\in \\{0.05, 0.10, \\ldots, 0.50\\}$，对于每个 $D$，我们遍历 $f \\in \\{5, 10, 20, 40, 80\\}$。\n\n对于每一对 $(D, f)$：\n1.  计算 $T_{\\mathrm{on}} = D/f$ 和 $T_{\\mathrm{cyc}} = 1/f$。\n2.  使用推导出的公式计算 $\\overline{O}$。\n3.  使用其推导出的公式计算 $\\Delta T_{\\mathrm{peak}}$。\n4.  检查是否满足可行性标准：$\\overline{O} \\ge 0.7$ 和 $\\Delta T_{\\mathrm{peak}} < 1.0$。\n\n满足这两个标准的第一个 $(D, f)$ 对即为该测试用例的最优解。记录其相应的指标，并终止该案例的搜索。如果在整个网格中搜索后未找到可行解，则报告该案例为不可行。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the optogenetic stimulation problem for a suite of test cases.\n    \"\"\"\n    \n    # Test suite parameters\n    # (tau_on, tau_off, P, tau_th, beta)\n    test_cases = {\n        \"Case A\": (0.005, 0.015, 0.010, 1.0, 50.0),\n        \"Case B\": (0.010, 0.100, 0.015, 0.8, 40.0),\n        \"Case C\": (0.003, 0.008, 0.030, 1.2, 40.0),\n        \"Case D\": (0.030, 0.200, 0.080, 1.5, 40.0),\n    }\n\n    # Candidate grid for pulsing strategies\n    frequencies_hz = [5.0, 10.0, 20.0, 40.0, 80.0]\n    duty_cycles = [0.05, 0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.45, 0.50]\n    \n    # Constraints\n    O_AVG_TARGET = 0.7\n    T_PEAK_LIMIT = 1.0\n\n    all_results = []\n\n    for case_name, params in test_cases.items():\n        tau_on, tau_off, P, tau_th, beta = params\n        \n        found_feasible = False\n        best_result = [-1.0, -1.0, -1.0, -1.0]\n\n        # Iterate through D then f to find the optimal solution first per the selection rule\n        for D in duty_cycles:\n            for f in frequencies_hz:\n                # Calculate time durations\n                T_cyc = 1.0 / f\n                T_on = D / f\n                T_off = (1.0 - D) / f\n\n                # --- 1. Opsin gating calculation ---\n                exp_on = np.exp(-T_on / tau_on)\n                exp_off = np.exp(-T_off / tau_off)\n                \n                # Denominator for O_max\n                denom_O = 1.0 - exp_on * exp_off\n                if abs(denom_O)  1e-12: # Avoid division by zero, though unlikely\n                    continue\n\n                O_max = (1.0 - exp_on) / denom_O\n                O_min = O_max * exp_off\n                \n                # The formula derived in the solution text\n                O_avg = D + f * (tau_off - tau_on) * (O_max - O_min)\n\n                # --- 2. Thermal calculation ---\n                exp_th_on = np.exp(-T_on / tau_th)\n                exp_th_cyc = np.exp(-T_cyc / tau_th)\n\n                # Denominator for T_peak\n                denom_T = 1.0 - exp_th_cyc\n                if abs(denom_T)  1e-12: # Avoid division by zero\n                    continue\n                \n                T_peak = (beta * P * tau_th * (1.0 - exp_th_on)) / denom_T\n\n                # --- 3. Feasibility Check ---\n                if O_avg >= O_AVG_TARGET and T_peak  T_PEAK_LIMIT:\n                    best_result = [\n                        float(f\"{D:.3f}\"),\n                        float(f\"{f:.1f}\"),\n                        float(f\"{T_peak:.4f}\"),\n                        float(f\"{O_avg:.4f}\")\n                    ]\n                    found_feasible = True\n                    break # Found smallest f for this D, move to next case\n            \n            if found_feasible:\n                break # Found smallest D, we are done with this case\n        \n        all_results.append(best_result)\n\n    # Format the final output string as a list of lists.\n    # str(list) automatically adds spaces, so we build the string manually.\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]},{r[2]},{r[3]}]\" for r in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2589134"}]}