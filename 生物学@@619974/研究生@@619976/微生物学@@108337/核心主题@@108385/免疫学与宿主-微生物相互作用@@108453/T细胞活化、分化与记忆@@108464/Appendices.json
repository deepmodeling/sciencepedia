{"hands_on_practices": [{"introduction": "T细胞的激活始于T细胞受体（TCR）与肽-主要组织相容性复合物（pMHC）的物理结合。这种相互作用的动力学——即结合速率和持续时间——是决定信号能否成功启动的关键因素。本练习将引导你通过定量分析，探索配体密度、结合动力学参数（如 $k_{\\text{on}}$ 和 $k_{\\text{off}}$）以及信号激活阈值之间的关系，从而深入理解TCR识别的物理化学基础。[@problem_id:2536740]", "problem": "一个T细胞受体（TCR）在细胞-细胞接触界面上与肽-主要组织相容性复合物（pMHC）配体结合，在此界面上，TCR和pMHC均被限制在二维膜上。设微观二维结合速率常数为 $k_{\\text{on}}$，单位为 $\\mu\\text{m}^{2}/(\\text{分子}\\cdot \\text{s})$，解离速率为 $k_{\\text{off}}$，单位为 $\\text{s}^{-1}$。假设接触微区是充分混合的，pMHC表面密度 $\\rho_{L}$（分子/$\\mu\\text{m}^{2}$）是均匀的，并考虑在TCR密度非限制性的伪一级条件下每个受体的占有率。将受体-配体结合建模为可逆反应 $R + L \\rightleftharpoons C$，并令 $x(t)$ 表示在时间 $t$ 任意一个TCR与配体结合的概率。\n\n从质量作用定律出发，忽略扩散限制，推导稳态占有率 $x^{\\ast}$，用 $k_{\\text{on}}$、$k_{\\text{off}}$ 和 $\\rho_{L}$ 表示。另外，假设有效的信号传导需要完成一个具有 $L$ 步的动力学校对序列，每步速率为 $k_{p}$，因此最小信号传导时间为 $\\tau_{\\ast} = L/k_{p}$。使用标准的单步解离模型，其中TCR-pMHC复合物的平均停留时间为 $\\tau_{\\text{dwell}} = 1/k_{\\text{off}}$，确定是否满足激活条件 $\\tau_{\\text{dwell}} > \\tau_{\\ast}$。\n\n使用以下参数值：\n- $k_{\\text{on}} = 4.0 \\times 10^{-3}\\ \\mu\\text{m}^{2}/(\\text{分子}\\cdot \\text{s})$\n- $k_{\\text{off}} = 0.80\\ \\text{s}^{-1}$\n- $\\rho_{L} = 50\\ \\text{分子}/\\mu\\text{m}^{2}$\n- $L = 3$\n- $k_{p} = 2.0\\ \\text{s}^{-1}$\n\n将最终结果表示为一个双元素行向量 $\\big[x^{\\ast}, I\\big]$，其中如果 $\\tau_{\\text{dwell}} > \\tau_{\\ast}$ 则 $I=1$，否则 $I=0$。将 $x^{\\ast}$ 四舍五入到四位有效数字。最终答案中不要包含单位。所有中间推理必须基于所述的第一性原理。", "solution": "问题陈述已经过验证，被认为是科学上合理、定义明确且客观的。它基于免疫学中受体-配体结合动力学和动力学校对模型的既定原理。所有必要的参数都已提供，问题没有矛盾或含糊之处。因此，可以推导出严谨的解。\n\n问题要求计算两个量：T细胞受体（TCR）的稳态占有率，记为 $x^{\\ast}$，以及一个二元指示符 $I$，它反映了T细胞激活的条件是否得到满足。\n\n首先，我们将推导稳态占有率 $x^{\\ast}$ 的表达式。结合过程被建模为可逆反应 $R + L \\rightleftharpoons C$，其中 $R$ 是游离受体，$L$ 是配体，$C$ 是受体-配体复合物。变量 $x(t)$ 表示单个受体在时间 $t$ 处于结合态 $C$ 的概率。因此，受体处于游离态 $R$ 的概率是 $1 - x(t)$。\n\n结合概率的变化率 $\\frac{dx}{dt}$ 受质量作用定律支配。从未结合态到结合态的转变是正向反应。在伪一级条件下，配体密度 $\\rho_{L}$ 被假定为常数。对于单个受体，此转变的速率是其处于未结合状态的概率 $1-x$ 与有效一级结合速率 $k_{\\text{on}} \\rho_{L}$ 的乘积。因此，$x$ 的增加速率是 $(1-x) k_{\\text{on}} \\rho_{L}$。\n\n从结合态到未结合态的转变是解离，即逆向反应。这是一个一级过程，速率常数为 $k_{\\text{off}}$。该转变的速率是其处于结合状态的概率 $x$ 与速率常数 $k_{\\text{off}}$ 的乘积。因此，$x$ 的减少速率是 $x k_{\\text{off}}$。\n\n结合这两个过程，我们得到描述占有率 $x(t)$ 的常微分方程：\n$$ \\frac{dx}{dt} = (1-x) k_{\\text{on}} \\rho_{L} - x k_{\\text{off}} $$\n在稳态时，系统处于平衡状态，意味着净变化率为零，即 $\\frac{dx}{dt} = 0$。设 $x^{\\ast}$ 为稳态占有率。方程变为：\n$$ 0 = (1 - x^{\\ast}) k_{\\text{on}} \\rho_{L} - x^{\\ast} k_{\\text{off}} $$\n我们接下来求解这个关于 $x^{\\ast}$ 的代数方程：\n$$ x^{\\ast} k_{\\text{off}} = k_{\\text{on}} \\rho_{L} - x^{\\ast} k_{\\text{on}} \\rho_{L} $$\n$$ x^{\\ast} (k_{\\text{off}} + k_{\\text{on}} \\rho_{L}) = k_{\\text{on}} \\rho_{L} $$\n$$ x^{\\ast} = \\frac{k_{\\text{on}} \\rho_{L}}{k_{\\text{on}} \\rho_{L} + k_{\\text{off}}} $$\n现在，我们代入给定的数值：$k_{\\text{on}} = 4.0 \\times 10^{-3}\\ \\mu\\text{m}^{2}/(\\text{分子}\\cdot \\text{s})$，$\\rho_{L} = 50\\ \\text{分子}/\\mu\\text{m}^{2}$，以及 $k_{\\text{off}} = 0.80\\ \\text{s}^{-1}$。\n\n首先，我们计算有效结合速率 $k_{\\text{on}} \\rho_{L}$：\n$$ k_{\\text{on}} \\rho_{L} = (4.0 \\times 10^{-3}) \\cdot 50 = 0.20\\ \\text{s}^{-1} $$\n接下来，我们将此值代入 $x^{\\ast}$ 的表达式中：\n$$ x^{\\ast} = \\frac{0.20\\ \\text{s}^{-1}}{0.20\\ \\text{s}^{-1} + 0.80\\ \\text{s}^{-1}} = \\frac{0.20}{1.00} = 0.20 $$\n问题要求将此结果报告为四位有效数字。因此，$x^{\\ast} = 0.2000$。\n\n其次，我们必须评估激活条件 $\\tau_{\\text{dwell}} > \\tau_{\\ast}$，以确定指示符 $I$ 的值。我们已知平均停留时间 $\\tau_{\\text{dwell}}$ 和最小信号传导时间 $\\tau_{\\ast}$ 的定义：\n$$ \\tau_{\\text{dwell}} = \\frac{1}{k_{\\text{off}}} $$\n$$ \\tau_{\\ast} = \\frac{L}{k_{p}} $$\n用于此计算的参数为 $k_{\\text{off}} = 0.80\\ \\text{s}^{-1}$，$L = 3$，以及 $k_{p} = 2.0\\ \\text{s}^{-1}$。\n\n我们计算 $\\tau_{\\text{dwell}}$：\n$$ \\tau_{\\text{dwell}} = \\frac{1}{0.80\\ \\text{s}^{-1}} = 1.25\\ \\text{s} $$\n我们计算 $\\tau_{\\ast}$：\n$$ \\tau_{\\ast} = \\frac{3}{2.0\\ \\text{s}^{-1}} = 1.5\\ \\text{s} $$\n现在，我们通过比较这两个值来检验激活条件：\n$$ 1.25\\ \\text{s} > 1.5\\ \\text{s} $$\n这个不等式显然是错误的。因此，激活条件未被满足。根据问题定义，如果条件未满足，指示变量 $I$ 必须设为 $0$。\n\n最终结果是一个双元素行向量 $[x^{\\ast}, I]$，由我们确定的值组成。", "answer": "$$\\boxed{\\begin{pmatrix} 0.2000 & 0 \\end{pmatrix}}$$", "id": "2536740"}, {"introduction": "初始信号事件之后，T细胞会分化并产生标志性的细胞因子，这是其功能的直接体现。本练习将视角从初始结合事件转向下游的基因表达和蛋白质分泌，引入一个简化的系统生物学模型。你将学习如何将关键转录因子（如STAT蛋白）的激活水平与不同细胞因子（IFN-$\\gamma$和IL-4）的稳态分泌率联系起来，体验如何运用定量模型来预测细胞功能。[@problem_id:2536772]", "problem": "一个培养的人类CD4阳性T细胞接收到极化信号，这些信号差异性地激活信号转导与转录激活因子（STAT）转录因子。在这些条件下，干扰素-γ（IFN-$\\gamma$）和白细胞介素-4（IL-4）的分泌源于受调控的基因表达和蛋白质分泌。使用以下基于分子生物学中心法则和质量平衡动力学的建模假设：转录激活近似为与活化STAT水平成线性关系，信使核糖核酸（mRNA）和蛋白质降解遵循一级动力学，翻译对mRNA浓度呈一级关系，分泌对细胞内细胞因子池呈一级关系。假设mRNA和蛋白质均处于准稳态。\n\n设 $S_4$ 和 $S_6$ 分别表示该细胞中STAT4和STAT6的测量激活水平（任意激活单位）。将IFN-$\\gamma$和IL-4的转录速率（mRNA产生速率）建模为包含基础项和交叉拮抗作用的$S_4$和$S_6$的线性函数：\n- IFN-$\\gamma$ 转录速率 $v_{\\mathrm{I}} = b_{\\mathrm{I}} + a_{\\mathrm{I}} S_4 - c_{\\mathrm{I}} S_6$，\n- IL-4 转录速率 $v_{\\mathrm{L}} = b_{\\mathrm{L}} + a_{\\mathrm{L}} S_6 - c_{\\mathrm{L}} S_4$。\n\n假设mRNA的一级降解速率常数分别为 $\\gamma_{\\mathrm{m,I}}$ 和 $\\gamma_{\\mathrm{m,L}}$。蛋白质的翻译速率常数（单位时间内每mRNA）分别为 $k_{\\mathrm{t,I}}$ 和 $k_{\\mathrm{t,L}}$，并分别通过一级降解（速率常数为 $\\gamma_{\\mathrm{p,I}}$ 和 $\\gamma_{\\mathrm{p,L}}$）和分泌（速率常数为 $\\sigma_{\\mathrm{I}}$ 和 $\\sigma_{\\mathrm{L}}$）从细胞内池中移除，对应IFN-$\\gamma$和IL-4。在mRNA和蛋白质的准稳态假设下，计算稳态分泌通量之比 $J_{\\mathrm{I}}/J_{\\mathrm{L}}$。\n\n使用以下测量的激活水平和动力学参数：\n- $S_4 = 1.2$, $S_6 = 0.8$,\n- $b_{\\mathrm{I}} = 0.1$, $a_{\\mathrm{I}} = 1.5$, $c_{\\mathrm{I}} = 0.5$,\n- $b_{\\mathrm{L}} = 0.1$, $a_{\\mathrm{L}} = 1.4$, $c_{\\mathrm{L}} = 0.6$,\n- $\\gamma_{\\mathrm{m,I}} = \\gamma_{\\mathrm{m,L}} = 0.5$,\n- $k_{\\mathrm{t,I}} = 50$, $k_{\\mathrm{t,L}} = 40$,\n- $\\gamma_{\\mathrm{p,I}} = 0.2$, $\\gamma_{\\mathrm{p,L}} = 0.25$,\n- $\\sigma_{\\mathrm{I}} = 1.0$, $\\sigma_{\\mathrm{L}} = 1.2$.\n\n所有速率常数均以单位时间计，单位一致；最终比值为无量纲。将您的答案四舍五入到4位有效数字。", "solution": "该问题经确认具有科学依据、问题明确且客观。它基于系统生物学和免疫学中的标准模型，特别是质量作用动力学以及基因表达和蛋白质分泌的准稳态假设。所有必需的参数都已提供，问题逻辑上一致且可解。因此，我将提供完整的解题过程。\n\n问题要求推导干扰素-γ（IFN-$\\gamma$）和白细胞介素-4（IL-4）的稳态分泌通量之比 $J_{\\mathrm{I}}/J_{\\mathrm{L}}$。该推导基于一个转录、翻译和分泌的动力学模型。\n\n首先，我们为每种细胞因子的mRNA和细胞内蛋白质浓度建立动力学方程。设 $M_{\\mathrm{I}}(t)$ 和 $P_{\\mathrm{I}}(t)$ 分别为IFN-$\\gamma$的mRNA和蛋白质浓度。设 $M_{\\mathrm{L}}(t)$ 和 $P_{\\mathrm{L}}(t)$ 为IL-4的浓度。\n\n对于IFN-$\\gamma$，其mRNA浓度 $M_{\\mathrm{I}}$ 的变化速率由其转录和降解之间的平衡决定。\n转录速率由 $v_{\\mathrm{I}} = b_{\\mathrm{I}} + a_{\\mathrm{I}} S_4 - c_{\\mathrm{I}} S_6$ 给出。\nmRNA降解是一个一级过程，速率常数为 $\\gamma_{\\mathrm{m,I}}$。\n因此，$M_{\\mathrm{I}}$ 的常微分方程为：\n$$ \\frac{dM_{\\mathrm{I}}}{dt} = (b_{\\mathrm{I}} + a_{\\mathrm{I}} S_4 - c_{\\mathrm{I}} S_6) - \\gamma_{\\mathrm{m,I}} M_{\\mathrm{I}} $$\n\n细胞内蛋白质浓度 $P_{\\mathrm{I}}$ 的变化速率由翻译、降解和分泌控制。\n翻译对mRNA呈一级关系，速率常数为 $k_{\\mathrm{t,I}}$。\n蛋白质通过一级降解（速率常数 $\\gamma_{\\mathrm{p,I}}$）和一级分泌（速率常数 $\\sigma_{\\mathrm{I}}$）被移除。\n$P_{\\mathrm{I}}$ 的常微分方程为：\n$$ \\frac{dP_{\\mathrm{I}}}{dt} = k_{\\mathrm{t,I}} M_{\\mathrm{I}} - \\gamma_{\\mathrm{p,I}} P_{\\mathrm{I}} - \\sigma_{\\mathrm{I}} P_{\\mathrm{I}} = k_{\\mathrm{t,I}} M_{\\mathrm{I}} - (\\gamma_{\\mathrm{p,I}} + \\sigma_{\\mathrm{I}}) P_{\\mathrm{I}} $$\n\n问题陈述要求假设mRNA和蛋白质均处于准稳态（QSS）。这意味着我们将其时间导数设为零，即 $\\frac{dM_{\\mathrm{I}}}{dt} = 0$ 和 $\\frac{dP_{\\mathrm{I}}}{dt} = 0$。设 $M_{\\mathrm{I,ss}}$ 和 $P_{\\mathrm{I,ss}}$ 表示稳态浓度。\n\n根据mRNA的QSS条件：\n$$ 0 = (b_{\\mathrm{I}} + a_{\\mathrm{I}} S_4 - c_{\\mathrm{I}} S_6) - \\gamma_{\\mathrm{m,I}} M_{\\mathrm{I,ss}} $$\n解得 $M_{\\mathrm{I,ss}}$：\n$$ M_{\\mathrm{I,ss}} = \\frac{b_{\\mathrm{I}} + a_{\\mathrm{I}} S_4 - c_{\\mathrm{I}} S_6}{\\gamma_{\\mathrm{m,I}}} $$\n\n根据蛋白质的QSS条件：\n$$ 0 = k_{\\mathrm{t,I}} M_{\\mathrm{I,ss}} - (\\gamma_{\\mathrm{p,I}} + \\sigma_{\\mathrm{I}}) P_{\\mathrm{I,ss}} $$\n解得 $P_{\\mathrm{I,ss}}$：\n$$ P_{\\mathrm{I,ss}} = \\frac{k_{\\mathrm{t,I}} M_{\\mathrm{I,ss}}}{\\gamma_{\\mathrm{p,I}} + \\sigma_{\\mathrm{I}}} $$\n\nIFN-$\\gamma$ 的分泌通量 $J_{\\mathrm{I}}$ 被定义为对细胞内蛋白质池的一级过程：$J_{\\mathrm{I}} = \\sigma_{\\mathrm{I}} P_{\\mathrm{I}}$。因此，稳态通量 $J_{\\mathrm{I,ss}}$ 为：\n$$ J_{\\mathrm{I,ss}} = \\sigma_{\\mathrm{I}} P_{\\mathrm{I,ss}} = \\sigma_{\\mathrm{I}} \\left( \\frac{k_{\\mathrm{t,I}}}{\\gamma_{\\mathrm{p,I}} + \\sigma_{\\mathrm{I}}} \\right) M_{\\mathrm{I,ss}} $$\n代入 $M_{\\mathrm{I,ss}}$ 的表达式：\n$$ J_{\\mathrm{I,ss}} = \\left( \\frac{\\sigma_{\\mathrm{I}} k_{\\mathrm{t,I}}}{\\gamma_{\\mathrm{p,I}} + \\sigma_{\\mathrm{I}}} \\right) \\left( \\frac{b_{\\mathrm{I}} + a_{\\mathrm{I}} S_4 - c_{\\mathrm{I}} S_6}{\\gamma_{\\mathrm{m,I}}} \\right) $$\n\n对IL-4的推导是相同的，只需将所有下标 `I` 替换为 `L`。IL-4的转录速率为 $v_{\\mathrm{L}} = b_{\\mathrm{L}} + a_{\\mathrm{L}} S_6 - c_{\\mathrm{L}} S_4$。IL-4的稳态分泌通量为：\n$$ J_{\\mathrm{L,ss}} = \\left( \\frac{\\sigma_{\\mathrm{L}} k_{\\mathrm{t,L}}}{\\gamma_{\\mathrm{p,L}} + \\sigma_{\\mathrm{L}}} \\right) \\left( \\frac{b_{\\mathrm{L}} + a_{\\mathrm{L}} S_6 - c_{\\mathrm{L}} S_4}{\\gamma_{\\mathrm{m,L}}} \\right) $$\n\n我们被要求计算稳态通量之比 $J_{\\mathrm{I}}/J_{\\mathrm{L}}$（为简化起见，省略下标 `ss`）。\n$$ \\frac{J_{\\mathrm{I}}}{J_{\\mathrm{L}}} = \\frac{\\left( \\frac{\\sigma_{\\mathrm{I}} k_{\\mathrm{t,I}}}{\\gamma_{\\mathrm{p,I}} + \\sigma_{\\mathrm{I}}} \\right) \\left( \\frac{b_{\\mathrm{I}} + a_{\\mathrm{I}} S_4 - c_{\\mathrm{I}} S_6}{\\gamma_{\\mathrm{m,I}}} \\right)}{\\left( \\frac{\\sigma_{\\mathrm{L}} k_{\\mathrm{t,L}}}{\\gamma_{\\mathrm{p,L}} + \\sigma_{\\mathrm{L}}} \\right) \\left( \\frac{b_{\\mathrm{L}} + a_{\\mathrm{L}} S_6 - c_{\\mathrm{L}} S_4}{\\gamma_{\\mathrm{m,L}}} \\right)} $$\n重新整理各项可得：\n$$ \\frac{J_{\\mathrm{I}}}{J_{\\mathrm{L}}} = \\left( \\frac{\\sigma_{\\mathrm{I}} k_{\\mathrm{t,I}}}{\\sigma_{\\mathrm{L}} k_{\\mathrm{t,L}}} \\right) \\left( \\frac{\\gamma_{\\mathrm{p,L}} + \\sigma_{\\mathrm{L}}}{\\gamma_{\\mathrm{p,I}} + \\sigma_{\\mathrm{I}}} \\right) \\left( \\frac{\\gamma_{\\mathrm{m,L}}}{\\gamma_{\\mathrm{m,I}}} \\right) \\left( \\frac{b_{\\mathrm{I}} + a_{\\mathrm{I}} S_4 - c_{\\mathrm{I}} S_6}{b_{\\mathrm{L}} + a_{\\mathrm{L}} S_6 - c_{\\mathrm{L}} S_4} \\right) $$\n鉴于 $\\gamma_{\\mathrm{m,I}} = \\gamma_{\\mathrm{m,L}} = 0.5$，项 $\\frac{\\gamma_{\\mathrm{m,L}}}{\\gamma_{\\mathrm{m,I}}}$ 变为 $1$。该表达式简化为：\n$$ \\frac{J_{\\mathrm{I}}}{J_{\\mathrm{L}}} = \\left( \\frac{\\sigma_{\\mathrm{I}} k_{\\mathrm{t,I}}}{\\sigma_{\\mathrm{L}} k_{\\mathrm{t,L}}} \\right) \\left( \\frac{\\gamma_{\\mathrm{p,L}} + \\sigma_{\\mathrm{L}}}{\\gamma_{\\mathrm{p,I}} + \\sigma_{\\mathrm{I}}} \\right) \\left( \\frac{b_{\\mathrm{I}} + a_{\\mathrm{I}} S_4 - c_{\\mathrm{I}} S_6}{b_{\\mathrm{L}} + a_{\\mathrm{L}} S_6 - c_{\\mathrm{L}} S_4} \\right) $$\n现在，我们将提供的数值代入此表达式。\n参数如下：\n$S_4 = 1.2$, $S_6 = 0.8$\n$b_{\\mathrm{I}} = 0.1$, $a_{\\mathrm{I}} = 1.5$, $c_{\\mathrm{I}} = 0.5$\n$b_{\\mathrm{L}} = 0.1$, $a_{\\mathrm{L}} = 1.4$, $c_{\\mathrm{L}} = 0.6$\n$k_{\\mathrm{t,I}} = 50$, $k_{\\mathrm{t,L}} = 40$\n$\\gamma_{\\mathrm{p,I}} = 0.2$, $\\gamma_{\\mathrm{p,L}} = 0.25$\n$\\sigma_{\\mathrm{I}} = 1.0$, $\\sigma_{\\mathrm{L}} = 1.2$\n\n首先，计算最后一个因子中分子和分母的转录速率项：\n- $J_{\\mathrm{I}}$ 的分子项： $v_{\\mathrm{I}} = b_{\\mathrm{I}} + a_{\\mathrm{I}} S_4 - c_{\\mathrm{I}} S_6 = 0.1 + (1.5)(1.2) - (0.5)(0.8) = 0.1 + 1.8 - 0.4 = 1.5$\n- $J_{\\mathrm{L}}$ 的分母项： $v_{\\mathrm{L}} = b_{\\mathrm{L}} + a_{\\mathrm{L}} S_6 - c_{\\mathrm{L}} S_4 = 0.1 + (1.4)(0.8) - (0.6)(1.2) = 0.1 + 1.12 - 0.72 = 0.1 + 0.4 = 0.5$\n\n现在，计算比率表达式中的其他因子：\n- 因子 1: $\\frac{\\sigma_{\\mathrm{I}} k_{\\mathrm{t,I}}}{\\sigma_{\\mathrm{L}} k_{\\mathrm{t,L}}} = \\frac{1.0 \\times 50}{1.2 \\times 40} = \\frac{50}{48} = \\frac{25}{24}$\n- 因子 2: $\\frac{\\gamma_{\\mathrm{p,L}} + \\sigma_{\\mathrm{L}}}{\\gamma_{\\mathrm{p,I}} + \\sigma_{\\mathrm{I}}} = \\frac{0.25 + 1.2}{0.2 + 1.0} = \\frac{1.45}{1.2} = \\frac{145}{120} = \\frac{29}{24}$\n- 因子 3: $\\frac{v_{\\mathrm{I}}}{v_{\\mathrm{L}}} = \\frac{1.5}{0.5} = 3$\n\n组合这些因子以求得最终比率：\n$$ \\frac{J_{\\mathrm{I}}}{J_{\\mathrm{L}}} = \\left( \\frac{25}{24} \\right) \\left( \\frac{29}{24} \\right) (3) = \\frac{25 \\times 29 \\times 3}{24 \\times 24} = \\frac{2175}{576} $$\n因为 $2175 = 3 \\times 725$ 且 $576 = 3 \\times 192$，我们可以简化：\n$$ \\frac{J_{\\mathrm{I}}}{J_{\\mathrm{L}}} = \\frac{725}{192} $$\n将此分数转换为十进制值：\n$$ \\frac{725}{192} \\approx 3.77604166\\dots $$\n问题要求答案四舍五入到4位有效数字。\n$$ \\frac{J_{\\mathrm{I}}}{J_{\\mathrm{L}}} \\approx 3.776 $$\n此结果表明，在指定条件下，IFN-$\\gamma$ 的分泌通量约是 IL-4 的 $3.776$ 倍。", "answer": "$$\\boxed{3.776}$$", "id": "2536772"}, {"introduction": "T细胞向特定谱系（如调节性T细胞Treg或辅助性T细胞17 Th17）的分化是一个由相互作用的信号网络调控的复杂过程。本练习将带你进行一次更高级的“计算机模拟”实验：构建一个描述该调控网络的动力学模型。通过编写代码来模拟不同的细胞因子环境（TGF-$\\beta$和IL-6）如何引导T细胞走向不同命运，你将掌握利用计算工具揭示生物系统复杂性的强大方法。[@problem_id:2536752]", "problem": "开发人员需要实现一个最小化的、基于机理的动态模型，该模型通过一个耦合的信号转导与转录激活因子3 (STAT3) 和 mothers against decapentaplegic 同源蛋白 (SMAD) 信号网络，捕捉转化生长因子-β (TGF-$\\beta$) 和白细胞介素-6 (IL-6) 如何共同决定活化的 CD4+ T 细胞中叉头框蛋白 P3 (Foxp3) 的诱导与辅助性 T 细胞 17 (Th17) 程序定向之间的平衡。该模型必须基于以下广为接受的基础原理：配体-受体信号传导随配体浓度饱和；转录因子活性以一级动力学产生和降解；基因调控相互作用可由希尔型激活和抑制函数近似。程序必须对指定的常微分方程 (ODE) 系统进行数值积分，直至达到稳态，并返回稳态的 Foxp3 和 Th17 程序水平。\n\n使用的基本原理：\n- 配体占据的受体比例是配体浓度的饱和函数，可以用形式为 $H_{\\mathrm{act}}(x;K,n) = \\dfrac{x^n}{K^n + x^n}$ 的希尔激活函数建模。\n- 相应的希尔抑制函数为 $H_{\\mathrm{rep}}(x;K,n) = \\dfrac{K^n}{K^n + x^n} = 1 - H_{\\mathrm{act}}(x;K,n)$。\n- 转录因子活性变量在产生和一级降解下演化：$\\dfrac{dX}{dt} = \\text{production} - k_{\\mathrm{deg}} X$，其中 $X$ 在不失一般性的情况下被缩放到 $[0,1]$。\n\n模型变量（均为无量纲，缩放到 $[0,1]$）：\n- $S_3(t)$: 活化的 STAT$3$ 水平。\n- $S_M(t)$: 活化的 SMAD 水平。\n- $F(t)$: Foxp$3$ 水平。\n- $R(t)$: Th$17$ 程序代理（例如，由 ROR$\\gamma$t 驱动的输出）。\n\n外部输入（带有物理单位）：\n- $\\mathrm{TGF}\\beta$ 浓度，单位为 $\\mathrm{ng}/\\mathrm{mL}$。\n- $\\mathrm{IL}6$ 浓度，单位为 $\\mathrm{ng}/\\mathrm{mL}$。\n\n要实现的动力学：\n$$\n\\dfrac{d S_3}{dt} \\;=\\; k_{s3}\\, H_{\\mathrm{act}}\\!\\big(\\mathrm{IL}6; K_{\\mathrm{IL}6}, n_{\\mathrm{IL}6}\\big)\\,\\big(1 - S_3\\big)\\;-\\; d_{s3}\\, S_3.\n$$\n$$\n\\dfrac{d S_M}{dt} \\;=\\; k_{sm}\\, H_{\\mathrm{act}}\\!\\big(\\mathrm{TGF}\\beta; K_{\\mathrm{TGF}\\beta}, n_{\\mathrm{TGF}\\beta}\\big)\\,\\big(1 - S_M\\big)\\;-\\; d_{sm}\\, S_M.\n$$\n$$\n\\dfrac{d F}{dt} \\;=\\; k_{f}\\, H_{\\mathrm{act}}\\!\\big(S_M; K_{sm\\to f}, n\\big)\\, H_{\\mathrm{rep}}\\!\\big(S_3; K_{s3\\to f}, n\\big)\\,\\big(1 - F\\big)\\;-\\; d_{f}\\, F.\n$$\n$$\n\\dfrac{d R}{dt} \\;=\\; k_{r}\\, H_{\\mathrm{act}}\\!\\big(S_3; K_{s3\\to r}, n\\big)\\, H_{\\mathrm{rep}}\\!\\big(S_M; K_{sm\\to r}, n\\big)\\, H_{\\mathrm{rep}}\\!\\big(F; K_{f\\to r}, n\\big)\\,\\big(1 - R\\big)\\;-\\; d_{r}\\, R.\n$$\n\n要使用的所有参数值（科学上合理，量纲一致）：\n- 希尔指数：$n_{\\mathrm{IL}6} = 2$, $n_{\\mathrm{TGF}\\beta} = 2$, $n = 2$。\n- 配体敏感性：$K_{\\mathrm{IL}6} = 1.0\\ \\mathrm{ng}/\\mathrm{mL}$, $K_{\\mathrm{TGF}\\beta} = 0.5\\ \\mathrm{ng}/\\mathrm{mL}$。\n- 交叉调控敏感性（无量纲，因为调控因子是缩放过的）：$K_{sm\\to f} = 0.3$, $K_{s3\\to f} = 0.3$, $K_{s3\\to r} = 0.3$, $K_{sm\\to r} = 0.3$, $K_{f\\to r} = 0.3$。\n- 产生和降解速率（每任意时间单位）：$k_{s3} = 1.0$, $d_{s3} = 0.5$, $k_{sm} = 1.0$, $d_{sm} = 0.5$, $k_{f} = 1.0$, $d_{f} = 0.2$, $k_{r} = 1.0$, $d_{r} = 0.2$。\n\n数值积分要求：\n- 使用固定的时间步长 $\\Delta t = 0.01$ 的经典四阶龙格-库塔 (RK$4$) 方法。\n- $t=0$ 时的初始条件：$S_3(0)=0$, $S_M(0)=0$, $F(0)=0$, $R(0)=0$。\n- 积分直到稳态或达到最大时间。通过在至少 $100$ 个步骤后，$\\max\\{|X_{t+\\Delta t} - X_t|\\} < \\varepsilon$ 且 $\\varepsilon = 10^{-8}$ 来定义稳态，以避免过早停止。使用最大模拟时间 $T_{\\max} = 200.0$（任意时间单位）。将最终状态裁剪到 $[0,1]$ 区间内。\n- 报告稳态的 $F$ 和 $R$，四舍五入到 $3$ 位小数（无单位分数）。\n\n测试套件（输入单位为 $\\mathrm{ng}/\\mathrm{mL}$）：\n- 案例 $1$：$\\mathrm{TGF}\\beta = 5.0$, $\\mathrm{IL}6 = 0.1$。\n- 案例 $2$：$\\mathrm{TGF}\\beta = 0.1$, $\\mathrm{IL}6 = 10.0$。\n- 案例 $3$：$\\mathrm{TGF}\\beta = 0.0$, $\\mathrm{IL}6 = 0.0$。\n- 案例 $4$：$\\mathrm{TGF}\\beta = 5.0$, $\\mathrm{IL}6 = 5.0$。\n- 案例 $5$：$\\mathrm{TGF}\\beta = 10.0$, $\\mathrm{IL}6 = 1.0$。\n\n要求的最终输出格式：\n- 您的程序必须生成单行输出，包含测试套件的结果列表，其中每个结果是该案例的配对 $[F^\\ast, R^\\ast]$。整体输出必须是这些配对的单个列表，不含空格，例如：$[[f_1,r_1],[f_2,r_2],\\dots]$，其中每个 $f_i$ 和 $r_i$ 是四舍五入到 $3$ 位小数的浮点数。最终输出是无单位的（$[0,1]$ 内的分数）。", "solution": "我们将免疫学规范转化为一个基于饱和信号传导和一级周转的动力学系统。核心原则是：配体-受体信号传导会饱和，我们用希尔函数来建模；转录因子或程序变量的产生速率与激活信号成正比，并以一级动力学降解；相互调节通过希尔激活和抑制函数的乘积组合来实现。这体现了转化生长因子-β (TGF-$\\beta$) 诱导 mothers against decapentaplegic 同源蛋白 (SMAD) 信号传导，从而促进叉头框蛋白 P3 (Foxp3) 的逻辑；而白细胞介素-6 (IL-6) 诱导信号转导与转录激活因子3 (STAT3) 信号传导，从而促进辅助性 T 细胞 17 (Th17) 程序，同时 Foxp3 和 Th17 轴之间存在交叉抑制。\n\n数学构建模块：\n- 希尔激活函数 $H_{\\mathrm{act}}(x;K,n) = \\dfrac{x^n}{K^n + x^n}$ 近似了随着 $x$ 增加，受体占有率和下游激活达到饱和并趋近于 $1$ 的过程。\n- 希尔抑制函数 $H_{\\mathrm{rep}}(x;K,n) = \\dfrac{K^n}{K^n + x^n} = 1 - H_{\\mathrm{act}}(x;K,n)$ 随着抑制剂的增加而减小。\n- 一级周转由 $\\dfrac{dX}{dt} = \\text{production} - k_{\\mathrm{deg}} X$ 表示。\n\n我们定义了四个无量纲状态变量：$S_3$（活化的 STAT3）、$S_M$（活化的 SMAD）、$F$（Foxp3）和 $R$（Th17 程序）。外部输入分别是 TGF-$\\beta$ 和 IL-6 的浓度，单位为 $\\mathrm{ng}/\\mathrm{mL}$。ODE 系统如下：\n$$\n\\dfrac{d S_3}{dt} \\;=\\; k_{s3}\\, H_{\\mathrm{act}}\\!\\big(\\mathrm{IL}6; K_{\\mathrm{IL}6}, n_{\\mathrm{IL}6}\\big)\\,\\big(1 - S_3\\big)\\;-\\; d_{s3}\\, S_3,\n$$\n$$\n\\dfrac{d S_M}{dt} \\;=\\; k_{sm}\\, H_{\\mathrm{act}}\\!\\big(\\mathrm{TGF}\\beta; K_{\\mathrm{TGF}\\beta}, n_{\\mathrm{TGF}\\beta}\\big)\\,\\big(1 - S_M\\big)\\;-\\; d_{sm}\\, S_M,\n$$\n$$\n\\dfrac{d F}{dt} \\;=\\; k_{f}\\, H_{\\mathrm{act}}\\!\\big(S_M; K_{sm\\to f}, n\\big)\\, H_{\\mathrm{rep}}\\!\\big(S_3; K_{s3\\to f}, n\\big)\\,\\big(1 - F\\big)\\;-\\; d_{f}\\, F,\n$$\n$$\n\\dfrac{d R}{dt} \\;=\\; k_{r}\\, H_{\\mathrm{act}}\\!\\big(S_3; K_{s3\\to r}, n\\big)\\, H_{\\mathrm{rep}}\\!\\big(S_M; K_{sm\\to r}, n\\big)\\, H_{\\mathrm{rep}}\\!\\big(F; K_{f\\to r}, n\\big)\\,\\big(1 - R\\big)\\;-\\; d_{r}\\, R.\n$$\n\n参数值的选择反映了典型的定性敏感性和时间尺度：希尔指数 $n_{\\mathrm{IL}6} = 2$, $n_{\\mathrm{TGF}\\beta} = 2$, $n = 2$；配体半有效浓度 $K_{\\mathrm{IL}6} = 1.0\\ \\mathrm{ng}/\\mathrm{mL}$ 和 $K_{\\mathrm{TGF}\\beta} = 0.5\\ \\mathrm{ng}/\\mathrm{mL}$，以反映 TGF-$\\beta$ 通常在比 IL-6 更低的浓度下有效发信号；交叉调节半水平 $K_{sm\\to f} = 0.3$, $K_{s3\\to f} = 0.3$, $K_{s3\\to r} = 0.3$, $K_{sm\\to r} = 0.3$, $K_{f\\to r} = 0.3$；产生和降解速率 $k_{s3} = 1.0$, $d_{s3} = 0.5$, $k_{sm} = 1.0$, $d_{sm} = 0.5$, $k_{f} = 1.0$, $d_{f} = 0.2$, $k_{r} = 1.0$, $d_{r} = 0.2$。这些参数确保 $S_3$ 和 $S_M$ 能够迅速达到依赖于配体的平台期，而 $F$ 和 $R$ 则整合上游信号和交叉抑制，并更慢地稳定下来。\n\n算法方法：\n- 使用时间步长为 $\\Delta t = 0.01$ 的经典四阶龙格-库塔 (RK4) 方法，从初始条件 $S_3(0)=0$, $S_M(0)=0$, $F(0)=0$, $R(0)=0$ 开始积分。\n- 在至少 $100$ 个步骤后，检查每一步的最大绝对变化 $\\max\\{|X_{t+\\Delta t} - X_t|\\}$；如果它低于 $\\varepsilon = 10^{-8}$，则宣告达到稳态。\n- 如果模拟时间超过 $T_{\\max} = 200.0$，则停止，通过小的 $\\Delta t$ 和有界的非线性保证数值稳定性。\n- 将最终值裁剪到 $[0,1]$ 区间以尊重缩放，并将 $F$ 和 $R$ 四舍五入到 $3$ 位小数进行报告。\n\n基于第一性原理的解释预期：\n- 高 TGF-$\\beta$ 和低 IL-6 会产生高 $S_M$ 和低 $S_3$，因此 $F$ 被强烈产生，而 $R$ 被 $S_M$ 和 $F$ 双重抑制，从而有利于 Foxp3 的诱导而非 Th17 的分化。\n- 低 TGF-$\\beta$ 和高 IL-6 会产生高 $S_3$ 和低 $S_M$，因此 $R$ 被产生而 $F$ 被抑制，从而有利于 Th17。\n- 两种细胞因子都缺失时，两个轴都保持关闭状态。\n- 当两种输入都很高时，交叉抑制和双重促进会产生竞争；在所选参数下，强大的 SMAD 和 Foxp3 抑制偏向于对抗 Th17，使得 Foxp3 处于中到高水平，而 Th17 处于低到中水平。\n- 高 TGF-$\\beta$ 和中等 IL-6 仍然倾向于偏好 Foxp3，因为 SMAD 驱动的促进和 Foxp3 介导的对 Th17 的抑制超过了 STAT3 驱动的激活。\n\n程序必须用单位为 $\\mathrm{ng}/\\mathrm{mL}$ 的输入来评估指定的测试套件，并以单行单个列表的形式输出稳态配对 $[F^\\ast,R^\\ast]$，不含空格，每个值都四舍五入到 3 位小数且无单位（在 $[0,1]$ 内的分数）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef hill_act(x, K, n):\n    # Hill activation: x^n / (K^n + x^n); handle x=0 quickly\n    x = max(0.0, float(x))\n    if x == 0.0:\n        return 0.0\n    xn = x ** n\n    Kn = K ** n\n    return xn / (Kn + xn)\n\ndef hill_rep(x, K, n):\n    # Hill repression: K^n / (K^n + x^n)\n    x = max(0.0, float(x))\n    Kn = K ** n\n    if x == 0.0:\n        return 1.0\n    xn = x ** n\n    return Kn / (Kn + xn)\n\ndef ode_rhs(state, il6, tgfb, params):\n    # Unpack state\n    S3, SM, F, R = state\n\n    # Unpack parameters\n    ks3 = params['ks3']; ds3 = params['ds3']\n    ksm = params['ksm']; dsm = params['dsm']\n    kf = params['kf']; df = params['df']\n    kr = params['kr']; dr = params['dr']\n\n    K_il6 = params['K_il6']; n_il6 = params['n_il6']\n    K_tgfb = params['K_tgfb']; n_tgfb = params['n_tgfb']\n    K_sm_f = params['K_sm_f']; K_s3_f = params['K_s3_f']\n    K_s3_r = params['K_s3_r']; K_sm_r = params['K_sm_r']; K_f_r = params['K_f_r']\n    n_cross = params['n_cross']\n\n    # Upstream activations\n    A_il6 = hill_act(il6, K_il6, n_il6)\n    A_tgfb = hill_act(tgfb, K_tgfb, n_tgfb)\n\n    # ODEs\n    dS3 = ks3 * A_il6 * (1.0 - S3) - ds3 * S3\n    dSM = ksm * A_tgfb * (1.0 - SM) - dsm * SM\n\n    A_SM_on_F = hill_act(SM, K_sm_f, n_cross)\n    R_S3_on_F = hill_rep(S3, K_s3_f, n_cross)\n    dF = kf * A_SM_on_F * R_S3_on_F * (1.0 - F) - df * F\n\n    A_S3_on_R = hill_act(S3, K_s3_r, n_cross)\n    R_SM_on_R = hill_rep(SM, K_sm_r, n_cross)\n    R_F_on_R  = hill_rep(F,  K_f_r,  n_cross)\n    dR = kr * A_S3_on_R * R_SM_on_R * R_F_on_R * (1.0 - R) - dr * R\n\n    return np.array([dS3, dSM, dF, dR], dtype=float)\n\ndef rk4_step(state, dt, il6, tgfb, params):\n    k1 = ode_rhs(state, il6, tgfb, params)\n    k2 = ode_rhs(state + 0.5 * dt * k1, il6, tgfb, params)\n    k3 = ode_rhs(state + 0.5 * dt * k2, il6, tgfb, params)\n    k4 = ode_rhs(state + dt * k3, il6, tgfb, params)\n    return state + (dt / 6.0) * (k1 + 2*k2 + 2*k3 + k4)\n\ndef simulate(il6, tgfb, params, dt=0.01, tmax=200.0, tol=1e-8, min_steps=100):\n    # Initial conditions\n    state = np.array([0.0, 0.0, 0.0, 0.0], dtype=float)\n    t = 0.0\n    steps = 0\n    max_steps = int(tmax / dt)\n    prev_state = state.copy()\n    for i in range(max_steps):\n        state = rk4_step(state, dt, il6, tgfb, params)\n        # keep within [0,1]\n        state = np.clip(state, 0.0, 1.0)\n        steps += 1\n        t += dt\n        if steps >= min_steps:\n            delta = np.max(np.abs(state - prev_state))\n            if delta  tol:\n                break\n        prev_state = state.copy()\n    # Return F and R\n    F = float(np.clip(state[2], 0.0, 1.0))\n    R = float(np.clip(state[3], 0.0, 1.0))\n    return F, R\n\ndef solve():\n    # Define parameters\n    params = {\n        'ks3': 1.0, 'ds3': 0.5,\n        'ksm': 1.0, 'dsm': 0.5,\n        'kf': 1.0,  'df': 0.2,\n        'kr': 1.0,  'dr': 0.2,\n        'K_il6': 1.0, 'n_il6': 2.0,\n        'K_tgfb': 0.5, 'n_tgfb': 2.0,\n        'K_sm_f': 0.3, 'K_s3_f': 0.3,\n        'K_s3_r': 0.3, 'K_sm_r': 0.3, 'K_f_r': 0.3,\n        'n_cross': 2.0\n    }\n\n    # Define the test cases from the problem statement: (TGFb, IL6) in ng/mL\n    test_cases = [\n        (5.0, 0.1),   # Case 1: high TGFb, low IL6\n        (0.1, 10.0),  # Case 2: low TGFb, high IL6\n        (0.0, 0.0),   # Case 3: both zero\n        (5.0, 5.0),   # Case 4: both moderate/high\n        (10.0, 1.0),  # Case 5: high TGFb, moderate IL6\n    ]\n\n    results = []\n    for tgfb, il6 in test_cases:\n        F, R = simulate(il6=il6, tgfb=tgfb, params=params, dt=0.01, tmax=200.0, tol=1e-8, min_steps=100)\n        # Round to 3 decimals as required\n        F_rounded = round(F + 1e-12, 3)\n        R_rounded = round(R + 1e-12, 3)\n        results.append([F_rounded, R_rounded])\n\n    # Format without spaces: [[f1,r1],[f2,r2],...]\n    inner = [f\"[{format(pair[0], '.3f')},{format(pair[1], '.3f')}]\" for pair in results]\n    print(f\"[{','.join(inner)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2536752"}]}