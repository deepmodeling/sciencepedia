{"hands_on_practices": [{"introduction": "在微生物组成学分析中，一个核心挑战是测序数据固有的相对性。原始读数通常被转换为相对丰度（百分比），但这可能引入被称为“成分谬误”的分析偏差。这个练习将通过一个简洁的案例，清晰地揭示仅基于相对丰度的分析如何导致对微生物动态的错误推断，从而强调理解数据成分性的重要性。[@problem_id:2538319]", "problem": "一项关于肠道微生物组的病例对照研究，采用流式细胞术结合16S核糖体核糖核酸扩增子测序技术，测量了每克粪便中的绝对微生物丰度。考虑一个简化的群落，其中有$3$个优势分类单元，分别表示为$T_1$、$T_2$和$T_3$。在对照组中，测得的绝对丰度（细胞数/克）为$x_1^{(0)} = 10^{6}$，$x_2^{(0)} = 10^{9}$和$x_3^{(0)} = 10^{9}$。在疾病组中，测得的绝对丰度为$x_1^{(1)} = 10^{6}$，$x_2^{(1)} = 5 \\times 10^{8}$和$x_3^{(1)} = 5 \\times 10^{8}$。假设测序产生的相对丰度等于绝对比例（即不存在分类单元特异性扩增偏倚），因此在条件$k$下，分类单元$i$的相对丰度为$\\tilde{x}_i^{(k)} = x_i^{(k)} / \\sum_{j=1}^{3} x_j^{(k)}$。\n\n将在相对丰度分析下，分类单元$T_1$的观测$\\log_2$倍数变化定义为$L_{\\mathrm{rel}} = \\log_{2}\\!\\left(\\tilde{x}_1^{(1)} / \\tilde{x}_1^{(0)}\\right)$，将基于绝对丰度的真实$\\log_2$倍数变化定义为$L_{\\mathrm{abs}} = \\log_{2}\\!\\left(x_1^{(1)} / x_1^{(0)}\\right)$。将$T_1$的组成偏差定义为$B = L_{\\mathrm{rel}} - L_{\\mathrm{abs}}$。\n\n仅使用组成数据的基本原理（即相对丰度总和必须为$1$，且等于绝对丰度除以总载量）和所提供的数据，计算$T_1$的$B$值。然后，简要论证一种使用绝对丰度或组成平衡的方法，用于在分析$T_1$与疾病状态的关联时，消除或恰当地重新解释这种偏差。\n\n将$B$的最终值以一个无量纲数的格式报告，并四舍五入至$4$位有效数字。", "solution": "对所提供的问题进行验证。\n\n逐字提取已知条件：\n- 一个群落包含$3$个分类单元：$T_1$、$T_2$、$T_3$。\n- 对照组绝对丰度（细胞数/克）：$x_1^{(0)} = 10^{6}$，$x_2^{(0)} = 10^{9}$和$x_3^{(0)} = 10^{9}$。\n- 疾病组绝对丰度（细胞数/克）：$x_1^{(1)} = 10^{6}$，$x_2^{(1)} = 5 \\times 10^{8}$和$x_3^{(1)} = 5 \\times 10^{8}$。\n- 相对丰度定义：$\\tilde{x}_i^{(k)} = x_i^{(k)} / \\sum_{j=1}^{3} x_j^{(k)}$，其中条件 $k \\in \\{0, 1\\}$。\n- $T_1$的观测相对log$_2$倍数变化：$L_{\\mathrm{rel}} = \\log_{2}\\!\\left(\\tilde{x}_1^{(1)} / \\tilde{x}_1^{(0)}\\right)$。\n- $T_1$的真实绝对log$_2$倍数变化：$L_{\\mathrm{abs}} = \\log_{2}\\!\\left(x_1^{(1)} / x_1^{(0)}\\right)$。\n- $T_1$的组成偏差：$B = L_{\\mathrm{rel}} - L_{\\mathrm{abs}}$。\n- 任务是计算$T_1$的$B$值，报告结果至$4$位有效数字，并论证一种分析方法来减轻这种偏差。\n\n验证过程如下。\n该问题具有科学依据。它探讨了微生物组数据分析中组成性这一基本问题，这是一个公认的概念。相对丰度数据可能产生伪相关的假设是该领域的一个主要议题。所提供的数据值是合理的。该问题提法明确，为$B$的唯一解提供了所有必要的定义和数据。语言客观、专业。该问题未违反任何无效标准。\n\n结论：该问题有效。将制定解决方案。\n\n组成偏差$B$被定义为由相对丰度计算的对数倍数变化与由绝对丰度计算的对数倍数变化之差。\n$$B = L_{\\mathrm{rel}} - L_{\\mathrm{abs}}$$\n代入$L_{\\mathrm{rel}}$和$L_{\\mathrm{abs}}$的定义：\n$$B = \\log_{2}\\!\\left(\\frac{\\tilde{x}_1^{(1)}}{\\tilde{x}_1^{(0)}}\\right) - \\log_{2}\\!\\left(\\frac{x_1^{(1)}}{x_1^{(0)}}\\right)$$\n利用对数性质 $\\log(a) - \\log(b) = \\log(a/b)$，我们将这些项合并：\n$$B = \\log_{2}\\!\\left(\\frac{\\tilde{x}_1^{(1)} / \\tilde{x}_1^{(0)}}{x_1^{(1)} / x_1^{(0)}}\\right) = \\log_{2}\\!\\left(\\frac{\\tilde{x}_1^{(1)}}{\\tilde{x}_1^{(0)}} \\cdot \\frac{x_1^{(0)}}{x_1^{(1)}}\\right)$$\n相对丰度$\\tilde{x}_i^{(k)}$定义为绝对丰度$x_i^{(k)}$除以微生物总载量$S^{(k)} = \\sum_{j=1}^{3} x_j^{(k)}$。我们将此定义代入$\\tilde{x}_1^{(1)}$和$\\tilde{x}_1^{(0)}$：\n$$B = \\log_{2}\\!\\left(\\frac{x_1^{(1)}/S^{(1)}}{x_1^{(0)}/S^{(0)}} \\cdot \\frac{x_1^{(0)}}{x_1^{(1)}}\\right)$$\n绝对丰度项$x_1^{(1)}$和$x_1^{(0)}$相互抵消，表明偏差仅取决于两种条件之间微生物总载量的变化：\n$$B = \\log_{2}\\!\\left(\\frac{S^{(0)}}{S^{(1)}}\\right)$$\n这个结果对于任何绝对丰度不变的分类单元都是普遍适用的。其在相对丰度上的表观变化完全是由总和的变化所驱动的一种假象。\n\n首先，我们计算对照组（$k=0$）的总绝对丰度：\n$$S^{(0)} = x_1^{(0)} + x_2^{(0)} + x_3^{(0)} = 10^{6} + 10^{9} + 10^{9} = 1 \\times 10^{6} + 2 \\times 10^{9} = 2001 \\times 10^{6} = 2.001 \\times 10^{9}$$\n接下来，我们计算疾病组（$k=1$）的总绝对丰度：\n$$S^{(1)} = x_1^{(1)} + x_2^{(1)} + x_3^{(1)} = 10^{6} + 5 \\times 10^{8} + 5 \\times 10^{8} = 10^{6} + 10 \\times 10^{8} = 10^{6} + 10^{9} = 1001 \\times 10^{6} = 1.001 \\times 10^{9}$$\n现在我们计算偏差$B$：\n$$B = \\log_{2}\\!\\left(\\frac{2.001 \\times 10^{9}}{1.001 \\times 10^{9}}\\right) = \\log_{2}\\!\\left(\\frac{2.001}{1.001}\\right)$$\n使用对数的换底公式 $\\log_a(x) = \\frac{\\ln(x)}{\\ln(a)}$：\n$$B = \\frac{\\ln(1.999000999...)}{\\ln(2)} \\approx \\frac{0.69264746}{0.69314718} \\approx 0.99927909$$\n四舍五入至$4$位有效数字，我们得到$B = 0.9993$。\n$T_1$的真实对数倍数变化是$L_{\\mathrm{abs}} = \\log_{2}(10^6 / 10^6) = \\log_{2}(1) = 0$。表观对数倍数变化是$L_{\\mathrm{rel}} = B+L_{\\mathrm{abs}} \\approx 0.9993$。这表明，相对丰度分析会错误地暗示分类单元$T_1$的丰度大约增加了一倍（$\\log_{2}(2) = 1$），而实际上其绝对丰度保持不变。\n\n为了解决这种偏差，存在两种主要方法：\n\n1.  **绝对丰度分析**：最直接且科学上最可靠的方法是放弃相对丰度分析，直接对绝对丰度数据（$x_i^{(k)}$）进行统计检验。问题中说明这些数据已被采集。通过分析这些数值（通常在进行对数转换后，例如$\\ln(x_i^{(k)} + 1)$，以稳定方差），可以直接检验关于我们真正关心的量——即细胞绝对数量——的假设。这种方法完全消除了组成偏差，因为在计算中从未引入分母$S^{(k)}$。在本问题中，这样的分析将正确地得出$L_{\\mathrm{abs}}=0$，从而得出正确的结论：就其绝对数量而言，$T_1$与疾病状态无关。\n\n2.  **对数比分析（组成数据分析）**：如果无法获得绝对丰度数据，只能使用相对丰度（$\\tilde{x}_i^{(k)}$），则必须采用专为组成数据设计的方法。Aitchison几何为此提供了一个框架。该方法不分析单个组分，而是分析组分间的对数比。例如，可以定义一个等距对数比（ilr）平衡，如$z = \\ln\\left(\\frac{\\tilde{x}_1}{\\sqrt{\\tilde{x}_2 \\tilde{x}_3}}\\right)$。然后检验该平衡在不同组间的变化。这样的比率不受数据缩放的影响（也就是说，对于绝对丰度和相对丰度，其值是相同的：$\\ln\\left(\\frac{x_1/S}{\\sqrt{(x_2/S)(x_3/S)}}\\right) = \\ln\\left(\\frac{x_1}{\\sqrt{x_2 x_3}}\\right)$）。这种方法无法恢复$T_1$的绝对变化。相反，它将分析问题从“$T_1$的变化是什么？”重新解释为“$T_1$与$T_2$和$T_3$几何平均数的比率变化是什么？”这是一个有效且定义明确的问题，但其解释却有根本性的不同。它正确地识别出微生物生态系统的结构相对于$T_1$发生了变化，但将这种变化恰当地归因于组分间的比率，而不是归因于单个组分的虚假变化。\n\n总而言之，使用绝对丰度数据是更优越的方法，因为它直接处理了具有生物学意义的量。如果仅限于相对数据，对数比分析提供了一个数学上严谨的框架，但需要对科学假设进行仔细的重新解释。", "answer": "$$\n\\boxed{0.9993}\n$$", "id": "2538319"}, {"introduction": "为了克服相对丰度数据带来的分析挑战，我们需要采用为成分数据量身定制的数学框架。Aitchison几何学通过对数比（log-ratio）变换，将成分数据从受约束的单纯形空间映射到标准的欧几里得空间，从而允许使用常规的统计方法。本练习将引导你从第一性原理推导中心对数比（CLR）变换，并用它来计算样本间的Aitchison距离，这是衡量微生物群落结构差异的有效指标。[@problem_id:2538313]", "problem": "一项关于人类肠道微生物组的病例对照研究旨在调查群落结构的改变是否与某种疾病状态相关。我们从两个粪便样本中获得了跨越四个细菌属的16S核糖体核糖核酸（16S rRNA）基因的测序读数计数。第一个样本来自临床健康个体（样本 A），第二个来自一名患者（样本 B）。在相同有序的菌属集合下，观测到的计数向量为：\n- 样本 A: $\\left[100,\\,50,\\,0,\\,850\\right]$。\n- 样本 B: $\\left[200,\\,25,\\,25,\\,750\\right]$。\n\n由于扩增子测序数据是成分性的（即只有相对信息有意义），并且会受到不同文库大小的影响，因此在比较样本时直接使用原始计数可能会产生假象。仅从以下核心原则出发：(i) 一个成分是在正标量乘法（闭合）下的一个等价类，因此只有比率携带信息；(ii) 用于分析的任何变换都应对总计数（尺度不变性）和组分置換保持不变；(iii) 成分之间的距离应反映比率的差异（Aitchison几何），请推导一个变换，将一个$D$部成分 $\\mathbf{x} = (x_{1},\\dots,x_{D})$（其中 $x_{i} > 0$）映射到一个实数$D$维向量，该向量的各分量之和为零，且其两两之差编码了所有的对数比率信息。请简要解释，在微生物组研究中，为什么这种变换比原始计数更适合用于差异丰度检验。\n\n为确保对数有定义，请对每个样本中的每个分类单元使用+1的加性平滑伪计数，并使用平滑后的正向量进行计算。然后，使用您推导出的变换和变换空间中的标准欧几里得范数，计算样本A和样本B之间的距离（即Aitchison距离）。请使用自然对数 $\\ln(\\cdot)$，并将最终数值答案四舍五入至四位有效数字。無需单位。", "solution": "问题陈述经过严格验证，确认有效。其科学依据建立在成分数据分析（CoDA）的既定原则之上，该领域由 John Aitchison 开创，用于分析代表整体各部分的数据，例如地球化学成分，或本案例中的微生物相对丰度。该问题是适定的、客观的，并包含所有推导唯一、有意义解所需的全部信息。它要求从第一性原理出发推导中心对数比（clr）变换，解释其效用，并具体计算两个给定样本之间的Aitchison距离。\n\n首先，我们推导所需的变换。设一个$D$部成分由正实数向量 $\\mathbf{x} = (x_1, x_2, \\dots, x_D)$ 表示，其中 $x_i > 0$。成分数据的核心原则是，只有组分之间的比率，如 $x_i/x_j$，才包含有意义的信息。一个变换 $T(\\mathbf{x}) = \\mathbf{y} = (y_1, y_2, \\dots, y_D)$ 必须对总和或文库大小（尺度不变性）保持不变。问题要求该变换输出一个实数$D$维向量 $\\mathbf{y}$，使其分量之和为零（$\\sum_{i=1}^D y_i = 0$），并且其两两之差编码了所有的对数比率信息，即 $y_i - y_j = \\ln(x_i/x_j)$。\n\n为了满足 $y_i - y_j = \\ln(x_i) - \\ln(x_j)$，向量 $\\mathbf{y}$ 的分量必须形如 $y_i = \\ln(x_i) + c$，其中常数 $c$ 对所有分量 $i=1, \\dots, D$ 都相同。\n为了满足零和约束，我们必须有：\n$$ \\sum_{i=1}^{D} y_i = \\sum_{i=1}^{D} (\\ln(x_i) + c) = 0 $$\n$$ \\left(\\sum_{i=1}^{D} \\ln(x_i)\\right) + Dc = 0 $$\n解出 $c$ 可得：\n$$ c = -\\frac{1}{D} \\sum_{i=1}^{D} \\ln(x_i) $$\n这个常数 $c$ 是各分量对数的算术平均值的负数。对数的算术平均值等于几何平均值 $g(\\mathbf{x}) = (\\prod_{i=1}^D x_i)^{1/D}$ 的对数。因此：\n$$ c = -\\ln\\left(\\left(\\prod_{i=1}^D x_i\\right)^{1/D}\\right) = -\\ln(g(\\mathbf{x})) $$\n将此代回 $y_i$ 的表达式，我们得到该变换：\n$$ y_i = \\ln(x_i) - \\ln(g(\\mathbf{x})) = \\ln\\left(\\frac{x_i}{g(\\mathbf{x})}\\right) $$\n这个变换被称为中心对数比（clr）变换。$\\text{clr}(\\mathbf{x}) = \\left[ \\ln\\left(\\frac{x_1}{g(\\mathbf{x})}\\right), \\dots, \\ln\\left(\\frac{x_D}{g(\\mathbf{x})}\\right) \\right]$。该变换将一个成分从单纯形 $S^D$ 映射到一个 $(D-1)$ 维的实向量空间，满足所有陈述的要求。\n\n在差异丰度检验方面，这种变换之所以优于原始计数，有几个根本原因。原始计数会受到测序深度（文库大小）变化的影响，这是一种技术性假象，而非生物信号。因此，直接比较计数可能具有误导性。clr变换是尺度不变的，这意味着它不受整个计数向量乘以一个常数的影响，从而消除了文库大小的影响。此外，成分数据具有内在的约束性（例如，一个闭合成分的各组分之和为1），这会在组分之间引入虚假的负相关。对原始或标准化的计数应用假设独立性的标准统计检验（如t检验），可能导致很高的假阳性发现率。clr变换通过关注对数比率，正确地处理了这种成分结构，并将数据转移到一个欧几里得空间（Aitchison几何）中，在该空间里距离有良好定义且有意义，从而可以使用更合适的统计方法。\n\n现在，我们计算样本A和样本B之间的Aitchison距离。原始计数向量为：\n样本 A: $\\mathbf{c}_A = \\left[100,\\,50,\\,0,\\,850\\right]$\n样本 B: $\\mathbf{c}_B = \\left[200,\\,25,\\,25,\\,750\\right]$\n\n我们应用+1的加性平滑伪计数来处理零计数。平滑后的正向量为：\n$\\mathbf{x}_A = \\left[101,\\,51,\\,1,\\,851\\right]$\n$\\mathbf{x}_B = \\left[201,\\,26,\\,26,\\,751\\right]$\n\n接下来，我们计算clr变换后的向量。对于样本A，其中$D=4$：\n几何平均值为 $g(\\mathbf{x}_A) = (101 \\times 51 \\times 1 \\times 851)^{1/4} = (4382851)^{1/4}$。\n其自然对数为 $\\ln(g(\\mathbf{x}_A)) = \\frac{1}{4}(\\ln(101) + \\ln(51) + \\ln(1) + \\ln(851)) \\approx 3.823339$。\nclr变换后的向量 $\\mathbf{y}_A = \\text{clr}(\\mathbf{x}_A)$ 为：\n$$ \\mathbf{y}_A \\approx \\left[ \\ln(101) - 3.823339, \\ln(51) - 3.823339, \\ln(1) - 3.823339, \\ln(851) - 3.823339 \\right] $$\n$$ \\mathbf{y}_A \\approx \\left[ 4.615121 - 3.823339, 3.931826 - 3.823339, 0 - 3.823339, 6.746412 - 3.823339 \\right] $$\n$$ \\mathbf{y}_A \\approx \\left[ 0.791782, 0.108487, -3.823339, 2.923073 \\right] $$\n\n对于样本B：\n几何平均值为 $g(\\mathbf{x}_B) = (201 \\times 26 \\times 26 \\times 751)^{1/4} = (102030396)^{1/4}$。\n其自然对数为 $\\ln(g(\\mathbf{x}_B)) = \\frac{1}{4}(\\ln(201) + \\ln(26) + \\ln(26) + \\ln(751)) \\approx 4.610227$。\nclr变换后的向量 $\\mathbf{y}_B = \\text{clr}(\\mathbf{x}_B)$ 为：\n$$ \\mathbf{y}_B \\approx \\left[ \\ln(201) - 4.610227, \\ln(26) - 4.610227, \\ln(26) - 4.610227, \\ln(751) - 4.610227 \\right] $$\n$$ \\mathbf{y}_B \\approx \\left[ 5.303305 - 4.610227, 3.258097 - 4.610227, 3.258097 - 4.610227, 6.621410 - 4.610227 \\right] $$\n$$ \\mathbf{y}_B \\approx \\left[ 0.693078, -1.352130, -1.352130, 2.011183 \\right] $$\n\nAitchison距离 $d_A(\\mathbf{x}_A, \\mathbf{x}_B)$ 是clr变换后向量 $\\mathbf{y}_A$ 和 $\\mathbf{y}_B$ 之间的标准欧几里得距离：\n$$ d_A = \\sqrt{\\sum_{i=1}^{4} (y_{A,i} - y_{B,i})^2} $$\n各项差值为：\n$y_{A,1} - y_{B,1} \\approx 0.791782 - 0.693078 = 0.098704$\n$y_{A,2} - y_{B,2} \\approx 0.108487 - (-1.352130) = 1.460617$\n$y_{A,3} - y_{B,3} \\approx -3.823339 - (-1.352130) = -2.471209$\n$y_{A,4} - y_{B,4} \\approx 2.923073 - 2.011183 = 0.911890$\n\n将这些差值平方并求和：\n$$ d_A^2 \\approx (0.098704)^2 + (1.460617)^2 + (-2.471209)^2 + (0.911890)^2 $$\n$$ d_A^2 \\approx 0.009742 + 2.133401 + 6.106878 + 0.831543 \\approx 9.081564 $$\n$$ d_A = \\sqrt{9.081564} \\approx 3.013566 $$\n\n将最终答案四舍五入至四位有效数字，得到 $3.014$。", "answer": "$$\n\\boxed{3.014}\n$$", "id": "2538313"}, {"introduction": "超越数据分析，微生物组研究的前沿在于构建能够预测宿主-微生物相互作用的机理模型。这些模型将离散的生物学知识整合为动态的、可量化的系统。此项高级练习旨在挑战你构建一个从微生物代谢物（丁酸盐）到宿主免疫细胞（T细胞）响应（IL-10分泌）的多步骤模型，它融合了平衡结合、酶动力学和基因表达调控等核心概念。[@problem_id:2538359]", "problem": "您的任务是构建并评估一个第一性原理机理模型，该模型将结肠中微生物丁酸盐的浓度与结肠T细胞中组蛋白去乙酰化酶（HDAC）的抑制作用以及由此产生的每个细胞白细胞介素-10（IL-10）的稳态分泌通量联系起来。您的程序必须根据下文指定的一小组测试场景，计算稳态的IL-10分泌通量，并将结果打印为单个用方括号括起来的逗号分隔列表。\n\n该模型必须基于以下基本原理和假设进行推导，这些原理和假设应被视为起点：\n\n- 使用源自质量作用定律的平衡配体结合来模拟丁酸盐对HDAC的占据。假设丁酸盐以表观解离常数$K_i$和由希尔系数$h$描述的协同性与HDAC结合，条件是游离丁酸盐浓度等于所提供的细胞外浓度$B$（单位为毫摩尔，mM）。以此为基础，推导出丁酸盐对HDAC的占有分数，进而得出未被抑制（有活性）的HDAC的分数。\n\n- 使用一个一阶平衡模型来模拟IL-10基因座上乙酰化组蛋白的分数$A(t)$，该平衡涉及组蛋白乙酰转移酶（HAT）以速率常数$k_{\\text{hat}}$进行的乙酰化和HDAC以有效速率常数$k_{\\text{d,eff}}(B)$（取决于活性HDAC的分数）进行的去乙酰化。使用一个双态乙酰化模型$A \\in [0,1]$，其中$dA/dt$受基于这些速率的线性流入-流出平衡控制，并确定稳态分数$A^\\ast$。\n\n- 假设每个细胞的IL-10 mRNA合成速率$s_m$随$A^\\ast$线性增加，即$s_m = r_0 + \\alpha A^\\ast$，其中$r_0$是基础合成速率，$\\alpha$是乙酰化依赖性增量。信使RNA（mRNA）以一阶速率常数$\\delta_m$降解，得到稳态mRNA拷贝数$M^\\ast$。\n\n- 蛋白质以翻译速率常数$k_{\\text{tl}}$（蛋白质/mRNA/小时）产生，细胞内IL-10蛋白质池$P^\\ast$受一阶损失（主要由分泌和周转引起）控制，速率常数为$\\delta_p$。每个细胞的稳态分泌通量为$J = k_{\\text{sec}} P^\\ast$。将$J$以“分子/细胞/小时”为单位表示为十进制数。\n\n参数值固定如下，必须严格按照给定值使用：\n\n- 解离常数 $K_i = 0.5$ mM。\n- 希尔系数 $h = 2$。\n- 基础HDAC去乙酰化速率常数 $k_{\\text{d0}} = 1.0$ $\\text{h}^{-1}$。\n- HAT速率常数 $k_{\\text{hat}}$ 每个测试案例不同（单位为 $\\text{h}^{-1}$）。\n- 基础IL-10 mRNA合成速率 $r_0 = 2.0$ 分子 $\\text{cell}^{-1}\\,\\text{h}^{-1}$。\n- 乙酰化依赖性增量 $\\alpha = 20.0$ 分子 $\\text{cell}^{-1}\\,\\text{h}^{-1}$。\n- mRNA衰变速率 $\\delta_m = \\ln 2$ $\\text{h}^{-1}$。\n- 翻译速率 $k_{\\text{tl}} = 100.0$ 蛋白质 $\\text{mRNA}^{-1}\\,\\text{h}^{-1}$。\n- 蛋白质损失速率 $\\delta_p = 1.0$ $\\text{h}^{-1}$。\n- 分泌比例常数 $k_{\\text{sec}} = 0.5$ $\\text{h}^{-1}$。\n\n测试套件。对于每一对$(B, k_{\\text{hat}})$，您必须计算稳态IL-10分泌通量$J(B, k_{\\text{hat}})$：\n\n- 案例 $1$：$B = 1.0$ mM, $k_{\\text{hat}} = 0.5$ $\\text{h}^{-1}$。\n- 案例 $2$：$B = 0.0$ mM, $k_{\\text{hat}} = 0.5$ $\\text{h}^{-1}$。\n- 案例 $3$：$B = 10.0$ mM, $k_{\\text{hat}} = 0.5$ $\\text{h}^{-1}$。\n- 案例 $4$：$B = 1.0$ mM, $k_{\\text{hat}} = 0.05$ $\\text{h}^{-1}$。\n- 案例 $5$：$B = 0.5$ mM, $k_{\\text{hat}} = 2.0$ $\\text{h}^{-1}$。\n\n您的任务：\n\n- 从上述基础出发，推导稳态分泌通量$J(B, k_{\\text{hat}})$关于$B$和$k_{\\text{hat}}$的闭式表达式。\n- 实现一个程序，计算上述五个测试案例的$J$值，并打印一行包含这五个结果的列表，按顺序排列，格式为用方括号括起来的逗号分隔列表（例如，$[x_1,x_2,x_3,x_4,x_5]$）。每个值必须四舍五入到恰好$6$位小数。所有输出必须以“分子/细胞/小时”为单位表示为十进制数。\n\n物理单位和格式：\n\n- 浓度$B$必须以$\\text{mM}$为单位进行解释。\n- 速率单位如指定为$\\text{h}^{-1}$。\n- 最终结果必须以“分子/细胞/小时”为单位打印。\n- 必须采用带方括号和逗号分隔符的单行输出格式。", "solution": "问题陈述已经过验证，被认为是科学上合理、定义明确且客观的。它概述了定量系统生物学中的一个标准问题，没有矛盾或含糊不清之处。我现在将着手推导解决方案。\n\n目标是推导白细胞介素-10（$J$）的稳态分泌通量的闭式解析表达式，该表达式是细胞外丁酸盐浓度（$B$）和组蛋白乙酰转移酶（HAT）速率常数（$k_{\\text{hat}}$）的函数。推导过程通过一系列步骤进行，模拟从受体抑制到蛋白质分泌的生化级联反应。\n\n**步骤1：丁酸盐对HDAC的抑制**\n\n第一步是量化丁酸盐对组蛋白去乙酰化酶（HDAC）的抑制作用。丁酸盐（$B$）作为抑制剂。丁酸盐与HDAC的结合由希尔方程描述，该方程模拟协同配体结合。丁酸盐对HDAC的占有分数，记为$\\theta(B)$，由下式给出：\n$$\n\\theta(B) = \\frac{B^h}{K_i^h + B^h}\n$$\n此处，$B$是丁酸盐浓度，$K_i$是表观解离常数，$h$是希尔系数。\n\nHDAC中*未被抑制*或*有活性*的分数，记为$f_{\\text{active}}(B)$，即为$1 - \\theta(B)$：\n$$\nf_{\\text{active}}(B) = 1 - \\frac{B^h}{K_i^h + B^h} = \\frac{(K_i^h + B^h) - B^h}{K_i^h + B^h} = \\frac{K_i^h}{K_i^h + B^h}\n$$\n此表达式量化了在给定丁酸盐浓度$B$下，总HDAC池中保持催化活性的部分。\n\n**步骤2：稳态组蛋白乙酰化**\n\nIL-10基因座上组蛋白的乙酰化状态被建模为HATs进行的乙酰化和HDACs进行的去乙酰化之间的动态平衡。设$A(t)$为乙酰化组蛋白的分数，其中$A \\in [0, 1]$。相应地，未乙酰化的组蛋白分数为$(1 - A)$。\n\n乙酰化速率与未乙酰化分数成正比，速率常数为$k_{\\text{hat}}$。去乙酰化速率与乙酰化分数成正比，其有效速率常数$k_{\\text{d,eff}}(B)$取决于丁酸盐浓度。该有效速率是基础去乙酰化速率$k_{\\text{d0}}$乘以活性HDAC的分数：\n$$\nk_{\\text{d,eff}}(B) = k_{\\text{d0}} \\cdot f_{\\text{active}}(B) = k_{\\text{d0}} \\frac{K_i^h}{K_i^h + B^h}\n$$\n控制乙酰化组蛋白分数的微分方程为：\n$$\n\\frac{dA}{dt} = k_{\\text{hat}}(1 - A) - k_{\\text{d,eff}}(B) A\n$$\n在稳态下，$\\frac{dA}{dt} = 0$。设$A^\\ast$为稳态乙酰化组蛋白分数。\n$$\nk_{\\text{hat}}(1 - A^\\ast) = k_{\\text{d,eff}}(B) A^\\ast\n$$\n求解$A^\\ast$可得：\n$$\nk_{\\text{hat}} = (k_{\\text{hat}} + k_{\\text{d,eff}}(B)) A^\\ast \\implies A^\\ast(B, k_{\\text{hat}}) = \\frac{k_{\\text{hat}}}{k_{\\text{hat}} + k_{\\text{d,eff}}(B)}\n$$\n\n**步骤3：稳态mRNA表达**\n\nIL-10 mRNA的合成速率$s_m$被假定为稳态组蛋白乙酰化分数$A^\\ast$的线性函数。这代表了染色质结构的开放，从而使转录得以进行。\n$$\ns_m = r_0 + \\alpha A^\\ast\n$$\n其中$r_0$是基础转录速率，$\\alpha$是乙酰化依赖性增强。mRNA分子通过一阶过程降解，速率常数为$\\delta_m$。每个细胞mRNA拷贝数$M(t)$的动态由下式给出：\n$$\n\\frac{dM}{dt} = s_m - \\delta_m M\n$$\n在稳态下，$\\frac{dM}{dt} = 0$。稳态mRNA拷贝数$M^\\ast$为：\n$$\nM^\\ast = \\frac{s_m}{\\delta_m} = \\frac{r_0 + \\alpha A^\\ast}{\\delta_m}\n$$\n\n**步骤4：稳态蛋白质表达与分泌通量**\n\n细胞内IL-10蛋白质池$P(t)$通过mRNA的翻译而增加，并通过分泌和降解的组合过程而消耗。翻译以速率$k_{\\text{tl}} M$发生，蛋白质损失是一个一阶过程，速率常数为$\\delta_p$。\n$$\n\\frac{dP}{dt} = k_{\\text{tl}} M - \\delta_p P\n$$\n在稳态下，当$M = M^\\ast$时，蛋白质水平$P^\\ast$为：\n$$\nP^\\ast = \\frac{k_{\\text{tl}} M^\\ast}{\\delta_p}\n$$\n问题将分泌通量$J$定义为与细胞内蛋白质浓度成正比，比例常数为$k_{\\text{sec}}$：\n$$\nJ = k_{\\text{sec}} P^\\ast = k_{\\text{sec}} \\frac{k_{\\text{tl}} M^\\ast}{\\delta_p}\n$$\n\n**步骤5：分泌通量的最终表达式**\n\n通过代入中间稳态量的表达式，我们可以推导出分泌通量$J$作为自变量$B$和$k_{\\text{hat}}$以及固定系统参数的函数的最终闭式表达式。\n将$M^\\ast$代入$J$的方程：\n$$\nJ = \\frac{k_{\\text{sec}} k_{\\text{tl}}}{\\delta_p \\delta_m} \\left(\\frac{r_0 + \\alpha A^\\ast}{\\delta_m}\\right) = \\frac{k_{\\text{sec}} k_{\\text{tl}}}{\\delta_p \\delta_m} (r_0 + \\alpha A^\\ast)\n$$\n接下来，代入$A^\\ast$的表达式：\n$$\nJ = \\frac{k_{\\text{sec}} k_{\\text{tl}}}{\\delta_p \\delta_m} \\left( r_0 + \\alpha \\left( \\frac{k_{\\text{hat}}}{k_{\\text{hat}} + k_{\\text{d,eff}}(B)} \\right) \\right)\n$$\n最后，代入$k_{\\text{d,eff}}(B)$的表达式：\n$$\nJ(B, k_{\\text{hat}}) = \\frac{k_{\\text{sec}} k_{\\text{tl}}}{\\delta_p \\delta_m} \\left( r_0 + \\alpha \\frac{k_{\\text{hat}}}{k_{\\text{hat}} + k_{\\text{d0}} \\frac{K_i^h}{K_i^h + B^h}} \\right)\n$$\n这是用于计算的最终解析表达式。该方程基于指定的第一性原理，将外部丁酸盐浓度与细胞IL-10的产出机械地联系起来。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the steady-state IL-10 secretion flux based on a mechanistic model\n    of HDAC inhibition by butyrate.\n    \"\"\"\n\n    # Define the fixed parameter values for the model.\n    # All rates are in units consistent with hours (h).\n    Ki = 0.5  # Apparent dissociation constant (mM)\n    h = 2.0  # Hill coefficient (dimensionless)\n    kd0 = 1.0  # Baseline HDAC deacetylation rate constant (h^-1)\n    khat = None # HAT rate constant (h^-1), varies per case\n    r0 = 2.0  # Basal IL-10 mRNA synthesis rate (molecules cell^-1 h^-1)\n    alpha = 20.0  # Acetylation-dependent increment (molecules cell^-1 h^-1)\n    delta_m = np.log(2)  # mRNA decay rate constant (h^-1)\n    ktl = 100.0  # Translation rate (proteins mRNA^-1 h^-1)\n    delta_p = 1.0  # Protein loss rate constant (h^-1)\n    ksec = 0.5  # Secretion proportionality constant (h^-1)\n\n    # Define the test suite of scenarios (B, khat).\n    # B is butyrate concentration in mM.\n    # khat is HAT rate constant in h^-1.\n    test_cases = [\n        (1.0, 0.5),  # Case 1\n        (0.0, 0.5),  # Case 2\n        (10.0, 0.5), # Case 3\n        (1.0, 0.05), # Case 4\n        (0.5, 2.0),  # Case 5\n    ]\n\n    results = []\n\n    for B, khat in test_cases:\n        # This implementation uses the derived closed-form expression for J.\n        # J(B, khat) = (ksec * ktl) / (delta_p * delta_m) * \n        #              (r0 + alpha * khat / (khat + kd0 * Ki^h / (Ki^h + B^h)))\n\n        # Step 1: Calculate the effective deacetylation rate constant kd_eff\n        kd_eff = kd0 * (Ki**h) / (Ki**h + B**h)\n        \n        # Step 2: Calculate the steady-state fraction of acetylated histones A_star\n        A_star = khat / (khat + kd_eff)\n        \n        # Step 3: Calculate the steady-state mRNA synthesis rate sm\n        sm = r0 + alpha * A_star\n        \n        # Step 4: Calculate the steady-state mRNA copy number M_star\n        M_star = sm / delta_m\n        \n        # Step 5: Calculate the steady-state protein copy number P_star\n        P_star = (ktl * M_star) / delta_p\n        \n        # Step 6: Calculate the secretion flux J\n        J = ksec * P_star\n        \n        results.append(J)\n\n    # Format the final output string as a comma-separated list of values\n    # rounded to 6 decimal places, enclosed in square brackets.\n    output_str = f\"[{','.join([f'{r:.6f}' for r in results])}]\"\n    \n    # Print the final result in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "2538359"}]}