{"hands_on_practices": [{"introduction": "在深入研究光合作用复杂的分子机制之前，掌握其所涉及的基本能量挑战至关重要。本练习将引导你通过第一性原理计算，确定产氧光合作用所需的热力学最低能量，将光子能量与水分解和$NADP^+$还原的氧化还原化学联系起来。通过将此理论极限与Z方案已知的实际光子需求量进行比较，你将更深刻地理解为何自然界演化出了如此复杂的双光系统机制。", "problem": "在产氧光养微生物中，Z-方案采用两个反应中心，它们主要吸收波长接近光系统 II (PSII) $\\lambda_{\\mathrm{PSII}} = 680\\,\\mathrm{nm}$ 和光系统 I (PSI) $\\lambda_{\\mathrm{PSI}} = 700\\,\\mathrm{nm}$ 的光。考虑在 $\\mathrm{pH}\\,7$ 的标准生化条件下，由光驱动的净氧化还原转化：\n$$2\\,\\mathrm{H_2O} + 2\\,\\mathrm{NADP^+} \\longrightarrow \\mathrm{O_2} + 2\\,\\mathrm{NADPH} + 2\\,\\mathrm{H^+},$$\n这对应于将 $4$ 个电子从水转移至烟酰胺腺嘌呤二核苷酸磷酸 ($NADP^+$)。假设在 $\\mathrm{pH}\\,7$ 下有以下经过充分验证的标准还原电位：对于 $\\mathrm{O_2}/\\mathrm{H_2O}$ 电对，$E^{\\circ\\prime}_{\\mathrm{O_2}/\\mathrm{H_2O}} = +0.815\\,\\mathrm{V}$；对于 $NADP^+/NADPH$ 电对，$E^{\\circ\\prime}_{\\mathrm{NADP^+}/\\mathrm{NADPH}} = -0.324\\,\\mathrm{V}$。请使用光子能量与波长的基本关系、连接氧化还原电位与吉布斯自由能的热力学关系，以及以下物理常数：普朗克常数 $h = 6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s}$，光速 $c = 2.99792458\\times 10^8\\,\\mathrm{m\\,s^{-1}}$，阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$，以及法拉第常数 $F = 96485\\,\\mathrm{C\\,mol^{-1}}$。\n\n仅从这些基础出发，并根据“在反应中心，单个被吸收的光子最多只能驱动一次对应于 $1$ 个电子转移的电荷分离事件”这一物理约束，推导估算出释放 $1$ 分子 $\\mathrm{O_2}$ 并将 $2$ 分子 $NADP^+$ 还原为 NADPH 所需的理论最小光子数。使用 $680\\,\\mathrm{nm}$ 和 $700\\,\\mathrm{nm}$ 的光子波长来量化光子能量，并以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示中间能量值。然后，将此理论最小值与自然界Z-方案中经典的 $8$–$10$ 个光子的需求量进行简要比较，并从第一性原理的角度解释任何差异的来源。最终答案仅报告理论最小光子数（一个无单位的纯数字）。最终答案无需进行四舍五入。", "solution": "该问题要求推导驱动产氧光合作用反应（释放一个 $\\mathrm{O_2}$ 分子并还原两个 $NADP^+$ 分子）所需的理论最小光子数。推导过程必须基于热力学和量子力学的第一性原理，使用所提供的数据，并遵守指定的物理约束。\n\n首先，我们必须确定在标准生化条件（$\\mathrm{pH}\\,7$）下驱动给定净反应所需的总能量。该反应为：\n$$2\\,\\mathrm{H_2O} + 2\\,\\mathrm{NADP^+} \\longrightarrow \\mathrm{O_2} + 2\\,\\mathrm{NADPH} + 2\\,\\mathrm{H^+}$$\n这是一个氧化还原反应。标准吉布斯自由能变 $\\Delta G^{\\circ\\prime}$ 与标准还原电位变 $\\Delta E^{\\circ\\prime}$ 之间的关系由以下方程给出：\n$$\\Delta G^{\\circ\\prime} = -nF\\Delta E^{\\circ\\prime}$$\n其中 $n$ 是转移的电子的摩尔数，$F$ 是法拉第常数。\n\n总反应可以分解为两个半反应。电子供体是水 ($\\mathrm{H_2O}$)，电子受体是 $NADP^+$。\n受体（$NADP^+/NADPH$ 电对）的标准还原电位为 $E^{\\circ\\prime}_{\\mathrm{acceptor}} = E^{\\circ\\prime}_{\\mathrm{NADP^+}/\\mathrm{NADPH}} = -0.324\\,\\mathrm{V}$。\n供体（$\\mathrm{O_2}/\\mathrm{H_2O}$ 电对）的标准还原电位为 $E^{\\circ\\prime}_{\\mathrm{donor}} = E^{\\circ\\prime}_{\\mathrm{O_2}/\\mathrm{H_2O}} = +0.815\\,\\mathrm{V}$。\n\n反应的总标准电位变化是被还原物质（阴极）的电位减去被氧化物质（阳极）的电位：\n$$\\Delta E^{\\circ\\prime} = E^{\\circ\\prime}_{\\mathrm{acceptor}} - E^{\\circ\\prime}_{\\mathrm{donor}} = -0.324\\,\\mathrm{V} - (+0.815\\,\\mathrm{V}) = -1.139\\,\\mathrm{V}$$\n问题说明，释放一个 $\\mathrm{O_2}$ 分子需要转移 $n=4$ 个电子。使用法拉第常数 $F = 96485\\,\\mathrm{C\\,mol^{-1}}$，我们可以计算所需的吉布斯自由能变。请注意 $1\\,\\mathrm{V} = 1\\,\\mathrm{J\\,C^{-1}}$。\n$$\\Delta G^{\\circ\\prime} = -(4\\,\\mathrm{mol})(96485\\,\\mathrm{C\\,mol^{-1}})(-1.139\\,\\mathrm{V})$$\n$$\\Delta G^{\\circ\\prime} = 439600.94\\,\\mathrm{J\\,mol^{-1}} \\approx 439.6\\,\\mathrm{kJ\\,mol^{-1}}$$\n这是驱动合成一摩尔 $\\mathrm{O_2}$ 所必须由光提供的最小能量。\n\n接下来，我们计算光子提供的能量。一摩尔光子（一爱因斯坦）的能量由普朗克-爱因斯坦关系式给出：\n$$E_{\\mathrm{mole}} = \\frac{N_{\\mathrm{A}}hc}{\\lambda}$$\n其中 $N_{\\mathrm{A}}$ 是阿伏伽德罗常数，$h$ 是普朗克常数，$c$ 是光速，$\\lambda$ 是波长。问题给出了两个波长，$\\lambda_{\\mathrm{PSII}} = 680\\,\\mathrm{nm}$ 和 $\\lambda_{\\mathrm{PSI}} = 700\\,\\mathrm{nm}$。为了确定理论最小光子数，我们必须考虑能量最低的光子，这对应于最长的波长，即 $\\lambda = 700 \\times 10^{-9}\\,\\mathrm{m}$。\n$$E_{\\mathrm{mole}, 700} = \\frac{(6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}})(6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s})(2.99792458\\times 10^8\\,\\mathrm{m\\,s^{-1}})}{700 \\times 10^{-9}\\,\\mathrm{m}}$$\n$$E_{\\mathrm{mole}, 700} \\approx 170849\\,\\mathrm{J\\,mol^{-1}} \\approx 170.8\\,\\mathrm{kJ\\,mol^{-1}}$$\n为完整起见，对于 $\\lambda = 680 \\times 10^{-9}\\,\\mathrm{m}$：\n$$E_{\\mathrm{mole}, 680} \\approx 175924\\,\\mathrm{J\\,mol^{-1}} \\approx 175.9\\,\\mathrm{kJ\\,mol^{-1}}$$\n\n问题中包含一个关键的物理约束：“在反应中心，单个被吸收的光子最多只能驱动一次对应于 $1$ 个电子转移的电荷分离事件”。这意味着吸收的光子与转移的电子之间存在一对一的关系。由于总反应需要转移 $n=4$ 个电子，因此理论上的最小光子数必须至少为 $4$。\n\n我们必须验证这在能量上是否可行。这需要检查单个光子的能量是否足以驱动单个电子跨越整个电位梯度。对于 $n=4$ 摩尔电子，每摩尔反应所需的总能量为 $\\Delta G^{\\circ\\prime} \\approx 439.6\\,\\mathrm{kJ\\,mol^{-1}}$。每摩尔电子所需的能量是：\n$$\\frac{\\Delta G^{\\circ\\prime}}{n} = \\frac{439.6\\,\\mathrm{kJ\\,mol^{-1}}}{4\\,\\mathrm{mol}} = 109.9\\,\\mathrm{kJ\\,mol^{-1}}$$\n一摩尔能量最低的光子（$\\lambda = 700\\,\\mathrm{nm}$）所提供的能量是 $E_{\\mathrm{mole}, 700} \\approx 170.8\\,\\mathrm{kJ\\,mol^{-1}}$。由于 $170.8\\,\\mathrm{kJ\\,mol^{-1}} > 109.9\\,\\mathrm{kJ\\,mol^{-1}}$，单个 $700\\,\\mathrm{nm}$ 光子的能量足以提供将单个电子从水移动到 $NADP^+$ 所需的能量。\n\n因此，考虑到一个光子移动一个电子的约束，且反应需要移动四个电子，理论上的最小光子数恰好是 $4$。\n\n问题还要求将这个理论最小值 $4$ 个光子与标准的实验值 $8$–$10$ 个光子进行比较。这种差异源于热力学极限与机理现实之间的区别。我们计算出的 $4$ 光子最小值是基于一个假设的光系统，该系统能够用一个光子驱动一个电子跨越 $1.139\\,\\mathrm{V}$ 的整个电位差。如此大的电位差很难在单个光化学步骤中跨越。\n\n自然界的Z-方案通过将过程拆分为在光系统 II (PSII) 和光系统 I (PSI) 处发生的两个更小的、连续的光化学步骤来规避此问题。在此机制中：\n1.  一个光子被 PSII 吸收，将一个电子从放氧复合物激发到更高的能级。\n2.  该电子在通过细胞色素 $b_6f$ 复合物时会损失部分能量。\n3.  第二个光子被 PSI 吸收，将同个电子再次激发到一个非常高的能级，足以还原 $NADP^+$。\n\n因此，每个电子需要两个光子才能完成其从 $\\mathrm{H_2O}$ 到 $\\mathrm{NADPH}$ 的旅程。由于净反应涉及 $4$ 个电子，基于Z-方案的机理最小值为 $4\\,\\text{个电子} \\times 2\\,\\text{个光子/电子} = 8$ 个光子。在自然界中观察到的 $8$–$10$ 个光子的范围，是考虑了理想模型中未包括的进一步的低效率因素，例如非生产性的光子吸收（能量以热或荧光形式损失）以及电子分流到替代途径（例如，循环光合磷酸化）。数值 $8$ 代表了两步机制的完美量子产率，而热力学最小值 $4$ 则代表了一个假设的、单步机制的完美量子产率。", "answer": "$$\\boxed{4}$$", "id": "2521563"}, {"introduction": "光驱动的电子传递巧妙地将光子能量转换成一种电化学梯度，即质子驱动力 ($pmf$)。本练习聚焦于下一个关键步骤：细胞如何利用这一梯度来合成ATP。你将计算驱动ATP合酶分子马达所需的最小 $pmf$，从而在化学渗透势和创造生命必需的能量货币的热力学成本之间建立定量的联系。", "problem": "一种单细胞光养细菌利用光驱动的电子传递在其细胞质膜上产生质子动势（pmf），膜旋转酶三磷酸腺苷（ATP）合酶随后利用该质子动势生产三磷酸腺苷（ATP）。pmf是质子的电化学势差，通常以伏特为单位的电势表示，它将膜电势差和跨膜pH梯度合并为一个单一的量。假设在给定的细胞条件下，合成一个ATP分子需要$\\Delta G_{\\mathrm{ATP}}=50\\,\\mathrm{kJ\\,mol^{-1}}$的标准转化自由能变，ATP合酶的化学计量比为每个ATP需要$n=3.3$个质子，且温度为$T=298\\,\\mathrm{K}$。忽略活度系数效应，并假设当$n$个质子顺着pmf易位所提供的自由能恰好等于$\\Delta G_{\\mathrm{ATP}}$时，达到ATP合成的最低要求。使用法拉第常数$F=96485\\,\\mathrm{C\\,mol^{-1}}$和气体常数$R=8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n从化学渗透耦合的第一性原理以及质子动势作为质子电化学势差的定义出发，推导驱动ATP合成所需的最小质子动势$\\Delta p_{\\min}$的表达式，该表达式应以$\\Delta G_{\\mathrm{ATP}}$、$n$和$F$表示。然后，使用给定的数值计算这个最小值，并以毫伏为单位的电势报告结果。将您的数值答案四舍五入到三位有效数字，并以毫伏表示。此外，简要地用文字解释$\\Delta p_{\\min}$如何依赖于$n$（此定性解释无需数值结果）。", "solution": "所提出的问题是有效的。它在科学上基于生物能量学和化学渗透理论的原理，问题陈述清晰，数据充分且一致，并以客观、可形式化的语言表达。\n\n我们从应用于化学渗透耦合的热力学第一性原理出发。一摩尔三磷酸腺苷（ATP）的合成是一个吸能过程，需要$\\Delta G_{\\mathrm{ATP}}$的吉布斯自由能输入。在光合磷酸化或氧化磷酸化的背景下，这种能量由质子（$H^+$）顺着其跨膜电化学势梯度易位提供。这个梯度就是质子动势（pmf）。\n\n设$\\Delta \\tilde{\\mu}_{H^+}$为质子跨膜的电化学势差，定义为当一摩尔质子从高电势区域（周质或外部）移动到低电势区域（细胞质或内部）时释放的能量。因此，通过$n$摩尔质子易位所提供的总自由能为$n \\Delta \\tilde{\\mu}_{H^+}$。\n\n问题指出，当质子易位所提供的自由能恰好等于ATP合成所需的自由能时，达到ATP合成的最低要求。这建立了以下能量平衡方程：\n$$ n \\Delta \\tilde{\\mu}_{H^+} = \\Delta G_{\\mathrm{ATP}} $$\n问题将质子动势$\\Delta p$定义为以电势单位（伏特）表示的电化学势差。每摩尔能量（$\\Delta \\tilde{\\mu}_{H^+}$）和电势（$\\Delta p$）之间的转换由法拉第常数$F$介导，它代表每摩尔基本电荷的电荷量。对于电荷为$+1$的质子，其关系为：\n$$ \\Delta p = \\frac{\\Delta \\tilde{\\mu}_{H^+}}{F} $$\n根据这个定义，我们可以用pmf来表示电化学势差：\n$$ \\Delta \\tilde{\\mu}_{H^+} = F \\Delta p $$\n我们关心的是pmf的最小量值，我们将其表示为$\\Delta p_{\\min}$。将$\\Delta \\tilde{\\mu}_{H^+}$的表达式代入能量平衡方程，得到：\n$$ n F \\Delta p_{\\min} = \\Delta G_{\\mathrm{ATP}} $$\n求解$\\Delta p_{\\min}$，我们得到所需的表达式：\n$$ \\Delta p_{\\min} = \\frac{\\Delta G_{\\mathrm{ATP}}}{nF} $$\n该表达式以合成的热力学成本$\\Delta G_{\\mathrm{ATP}}$、每个ATP的质子化学计量比$n$和法拉第常数$F$来表示驱动ATP合成所需的最小质子动势。所提供的温度$T$和气体常数$R$是将$\\Delta p$分解为其组成部分——膜电势$\\Delta\\psi$和pH梯度$\\Delta\\text{pH}$——所必需的，但对于基于指定变量的此推导则不是必需的。\n\n接下来，我们使用给定的数值来计算这个表达式。\nATP合成的标准转化自由能变为$\\Delta G_{\\mathrm{ATP}} = 50\\,\\mathrm{kJ\\,mol^{-1}}$。为了保持一致性，我们必须将其转换为国际单位制（SI）的基本单位。\n$$ \\Delta G_{\\mathrm{ATP}} = 50\\,\\mathrm{kJ\\,mol^{-1}} = 50 \\times 10^{3}\\,\\mathrm{J\\,mol^{-1}} $$\n其他给定的值是化学计量比$n = 3.3$和法拉第常数$F = 96485\\,\\mathrm{C\\,mol^{-1}}$。\n将这些值代入我们推导出的$\\Delta p_{\\min}$公式中：\n$$ \\Delta p_{\\min} = \\frac{50 \\times 10^{3}\\,\\mathrm{J\\,mol^{-1}}}{3.3 \\times 96485\\,\\mathrm{C\\,mol^{-1}}} $$\n计算过程如下：\n$$ \\Delta p_{\\min} \\approx \\frac{50000}{318300.5}\\,\\mathrm{J\\,C^{-1}} \\approx 0.157085\\,\\mathrm{V} $$\n结果以伏特（$V$）为单位，因为$1\\,\\mathrm{V} = 1\\,\\mathrm{J\\,C^{-1}}$。问题要求答案以毫伏（$mV$）表示。我们进行单位转换：\n$$ \\Delta p_{\\min} \\approx 0.157085\\,\\mathrm{V} \\times 1000\\,\\mathrm{mV\\,V^{-1}} \\approx 157.085\\,\\mathrm{mV} $$\n将此结果四舍五入到三位有效数字，我们得到所需的最小质子动势：\n$$ \\Delta p_{\\min} \\approx 157\\,\\mathrm{mV} $$\n\n最后，我们被要求解释$\\Delta p_{\\min}$对化学计量比$n$的依赖关系。我们推导出的表达式是$\\Delta p_{\\min} = \\frac{\\Delta G_{\\mathrm{ATP}}}{nF}$。由于在此背景下$\\Delta G_{\\mathrm{ATP}}$和$F$被视为常数，因此所需的最小质子动势$\\Delta p_{\\min}$与化学计量比$n$成反比。一个较大的$n$值意味着需要易位更多的质子来合成一个ATP分子。这意味着能量“负荷”被分配到更多的质子上。因此，每个质子所需的能量就更小，这转化为更小的驱动力，即更低的最小质子动势$\\Delta p_{\\min}$。相反，如果ATP合酶效率较低，使用较少的质子（一个较小的$n$）来制造一个ATP，那么每个质子必须贡献更多的能量来克服$\\Delta G_{\\mathrm{ATP}}$的能垒，因此需要一个更大量值的质子动势。", "answer": "$$ \\boxed{157} $$", "id": "2521582"}, {"introduction": "真实的细胞必须动态平衡其ATP和NADPH的产量，以满足新陈代谢（如碳固定）的波动需求。这项高级练习挑战你从单个计算迈向构建一个功能性的化学计量模型，这是现代系统生物学的一项关键技能。通过实施一个在线性电子流和循环电子流之间分配光子的算法，你将探索蓝细菌如何在不同条件下调节其能量收支并确保代谢稳态。", "problem": "您的任务是为蓝藻光合代谢构建一个最小化的化学计量分配器。在给定吸收的光子供应和碳固定需求的情况下，该分配器将计算可实现的三磷酸腺苷 (ATP) 和烟酰胺腺嘌呤二核苷酸磷酸 (NADPH) 的生产速率，并确定是否必须使用循环电子流。您的分配器必须源于以下关于蓝藻产氧光合作用的基本且经过充分验证的事实，并且除了从这些事实逻辑推导出的结论外，不得假定任何额外的简化途径。\n\n所使用的基本原理：\n- 在线性电子流中，电子流经光系统II (PSII) 和光系统I (PSI)，两个电子将一个烟酰胺腺嘌呤二核苷酸磷酸 ($NADP^+$) 还原为一个 NADPH。这需要每个电子进行两次光化学激发（一次在 PSII，一次在 PSI），因此形成一个 NADPH 需要 $4$ 个光子。\n- 在线性流中，每当两个电子从水传递到 $NADP^+$ 时，水的氧化会在 PSII 处向类囊体腔释放 $2$ 个质子，同时细胞色素 $b_6f$ 复合物通过 Q 循环额外向类囊体腔转运 $4$ 个质子。因此，每传递两个电子（即每形成一个 NADPH），类囊体腔会增加 $6$ 个质子。\n- 在围绕 PSI 的循环电子流中，电子由 PSI 激发，并通过细胞色素 $b_6f$ 复合物循环，没有净 NADPH 形成或水氧化。每循环两个电子，细胞色素 $b_6f$ 复合物向类囊体腔转运 $4$ 个质子。在光化学上，每个电子在 PSI 需要一个光子；因此，两个光子驱动 $4$ 个质子的循环转运。\n- 叶绿体或蓝藻的 ATP 合酶将质子动势与 ATP 合成耦合起来，其有效化学计量为每合成一个 ATP 消耗 $4$ 个质子。\n\n碳固定需求模型：\n- 卡尔文-本森-巴斯汉姆循环每固定一个$CO_2$消耗 $3$ 个 ATP 和 $2$ 个 NADPH。设总固定需求为 $r_{\\mathrm{CO2}}$，单位为分子/秒/细胞。由碳浓缩机制、转运或维持等过程产生的额外纯 ATP 负荷为 $A_{\\mathrm{extra}}$，单位为分子/秒/细胞。\n\n可用资源：\n- 设 $P$ 表示可用于光反应的每秒每细胞吸收的总光子数。\n\n分配假设与目标：\n- 分配给线性电子流的光子根据上述化学计量同时产生 ATP 和 NADPH。分配给循环电子流的光子仅产生 ATP。不考虑其他来源或消耗。如果光子不足以满足需求，您的分配器应优先满足 NADPH 需求，首先将光子分配给线性电子流。只有在 NADPH 需求完全满足后，才应将光子分配给循环电子流以补充 ATP 的生产。如果满足所有需求后仍有光子剩余，则这些光子被视为未使用。如果光子不足以满足 NADPH 需求，则不向循环电子流分配任何光子。\n- 定义一个二进制指示符，当且仅当在上述策略下有严格为正数量的光子被分配到循环电子流时，该指示符为真。\n\n您的任务：\n- 根据基本原理，推导出线性电子流中 ATP 和 NADPH 的单光子产率表达式，以及循环电子流中 ATP 的单光子产率表达式。然后，推导一个算法，该算法在给定 $P$、$r_{\\mathrm{CO2}}$ 和 $A_{\\mathrm{extra}}$ 的情况下，根据所述的优先级和分配规则，计算实现的 ATP 生产速率和 NADPH 生产速率（单位均为分子/秒/细胞），并同时输出指示循环电子流是否被激活的二进制指示符。\n- 按照下文规定，将此算法实现为一个完整的、可运行的程序。\n\n单位和数值输出：\n- 所有输入参数 $P$、$r_{\\mathrm{CO2}}$ 和 $A_{\\mathrm{extra}}$ 的单位默认为分子/秒/细胞，其中 $P$ 为光子，$r_{\\mathrm{CO2}}$ 和 $A_{\\mathrm{extra}}$ 为分子。您的程序必须以分子/秒/细胞为单位输出 ATP 和 NADPH 的生产速率。数值结果必须四舍五入到恰好三位小数。布尔指示符必须是编程语言中的布尔值 `true` 或 `false`。\n\n测试套件：\n- 您的程序必须计算以下测试用例的结果，每个用例是一个元组 $\\left(P, r_{\\mathrm{CO2}}, A_{\\mathrm{extra}}\\right)$：\n  - 用例 1：$\\left(1000, 50, 0\\right)$。\n  - 用例 2：$\\left(500, 50, 40\\right)$。\n  - 用例 3：$\\left(300, 50, 0\\right)$。\n  - 用例 4：$\\left(180, 20, 10\\right)$。\n  - 用例 5：$\\left(240, 30, 20\\right)$。\n  - 用例 6：$\\left(200, 0, 50\\right)$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，其本身是 $\\left[\\text{ATP}, \\text{NADPH}, \\text{cyclic}\\right]$ 形式的列表。例如：$\\left[\\left[\\text{ATP}_{1}, \\text{NADPH}_{1}, \\text{cyclic}_{1}\\right], \\ldots, \\left[\\text{ATP}_{6}, \\text{NADPH}_{6}, \\text{cyclic}_{6}\\right]\\right]$。请确保两个速率值四舍五入到恰好三位小数，并且布尔值是语言原生的布尔字面量。", "solution": "所提出的问题是有效的，因为它在科学上基于光合生物能量学的既定原理，在数学上是适定的，并且使用了客观、明确的术语进行定义。它提供了一套完整的化学计量参数和资源分配的逻辑规则，从而可以推导出并计算出唯一的解。\n\n任务是为一个蓝藻细胞构建一个化学计量模型。给定光子流入量 $P$、碳固定需求 $r_{\\mathrm{CO2}}$ 以及辅助 ATP 需求 $A_{\\mathrm{extra}}$，该模型需要计算可实现的三磷酸腺苷 (ATP) 和烟酰胺腺嘌呤二核苷酸磷酸 (NADPH) 的生产速率。该模型必须遵循指定的资源分配策略。\n\n首先，我们必须为两种光合电子流模式（线性电子流 (LEF) 和循环电子流 (CEF)）推导出 ATP 和 NADPH 的单光子产率。\n\n**化学计量产率的推导**\n\n这些产率是使用所提供的基本数据推导出来的。所有速率的单位默认为每细胞每秒。\n\n*   **线性电子流 (LEF)：**\n    在线性电子流 (LEF) 中，电子从水流经光系统II (PSII) 和光系统I (PSI) 到达 $NADP^+$。\n    1.  **NADPH 产率：** 形成一个 NADPH 分子需要转移两个电子，每个电子通过两个光系统传输需要两次光化学激发。因此，每生产一个 NADPH 消耗 $4$ 个光子。线性电子流中 NADPH 的单光子产率，记为 $\\phi_{\\text{NADPH, LEF}}$，为：\n        $$\\phi_{\\text{NADPH, LEF}} = \\frac{1 \\text{ NADPH}}{4 \\text{ photons}} = 0.25$$\n    2.  **ATP 产率：** 转移两个电子（即形成一个 NADPH）的过程耦合了总共 $6$ 个质子 ($H^+$) 易位进入类囊体腔：$2$ 个来自 PSII 的水氧化，$4$ 个通过细胞色素 $b_6f$ 复合物的 Q 循环。ATP 合酶每通过 $4$ 个质子合成 $1$ 个 ATP。因此，形成 $1$ 个 NADPH 会导致产生：\n        $$\\frac{6 \\text{ H}^+}{4 \\text{ H}^+ / \\text{ATP}} = 1.5 \\text{ ATP}$$\n        由于这 $1.5$ 个 ATP 分子是由产生 NADPH 的同样 $4$ 个光子生成的，线性电子流中 ATP 的单光子产率，记为 $\\phi_{\\text{ATP, LEF}}$，为：\n        $$\\phi_{\\text{ATP, LEF}} = \\frac{1.5 \\text{ ATP}}{4 \\text{ photons}} = 0.375$$\n\n*   **循环电子流 (CEF)：**\n    在循环电子流 (CEF) 中，电子围绕光系统I (PSI) 和细胞色素 $b_6f$ 复合物循环，导致质子易位但没有净 NADPH 产生。\n    1.  **NADPH 产率：** 根据定义，CEF 不产生 NADPH。\n        $$\\phi_{\\text{NADPH, CEF}} = 0$$\n    2.  **ATP 产率：** 每当两个电子通过循环（这需要在 PSI 处消耗 $2$ 个光子，每个电子一个），Q 循环会易位 $4$ 个质子。这些质子可以生成：\n        $$\\frac{4 \\text{ H}^+}{4 \\text{ H}^+ / \\text{ATP}} = 1 \\text{ ATP}$$\n        因此，CEF 中的 $2$ 个光子产生 $1$ 个 ATP。CEF 中 ATP 的单光子产率，记为 $\\phi_{\\text{ATP, CEF}}$，为：\n        $$\\phi_{\\text{ATP, CEF}} = \\frac{1 \\text{ ATP}}{2 \\text{ photons}} = 0.5$$\n\n**光子分配器的算法设计**\n\n该分配算法根据代谢需求和指定的优先级方案，在 LEF 和 CEF 之间分配总可用光子 $P$。\n\n**步骤1：量化代谢需求**\n总的 NADPH和 ATP 需求根据碳固定速率 $r_{\\mathrm{CO2}}$ 和额外 ATP 负荷 $A_{\\mathrm{extra}}$ 计算。\n*   **NADPH 需求 ($D_{\\text{NADPH}}$):** 卡尔文-本森-巴斯汉姆循环每固定一个 $CO_2$ 消耗 $2$ 个 NADPH。\n    $$D_{\\text{NADPH}} = 2 \\cdot r_{\\mathrm{CO2}}$$\n*   **ATP 需求 ($D_{\\text{ATP}}$):** 该循环每固定一个 $CO_2$ 消耗 $3$ 个 ATP，外加额外负荷。\n    $$D_{\\text{ATP}} = 3 \\cdot r_{\\mathrm{CO2}} + A_{\\mathrm{extra}}$$\n\n**步骤2：优先分配至线性电子流**\n问题规定优先保障 NADPH 的生产。由于只有 LEF 产生 NADPH，因此首先将光子分配给 LEF 以满足 $D_{\\text{NADPH}}$。\n*   LEF 满足此需求所需的光子数 $P_{\\text{LEF,req}}$ 为：\n    $$P_{\\text{LEF,req}} = \\frac{D_{\\text{NADPH}}}{\\phi_{\\text{NADPH, LEF}}} = \\frac{2 \\cdot r_{\\mathrm{CO2}}}{0.25} = 8 \\cdot r_{\\mathrm{CO2}}$$\n*   实际分配给 LEF 的光子数 $P_{\\text{LEF}}$ 受总可用光子供应 $P$ 的限制。\n    $$P_{\\text{LEF}} = \\min(P, P_{\\text{LEF,req}})$$\n*   由此产生的 NADPH 产量 $R_{\\text{NADPH}}$ 和 LEF 协同产生的 ATP 产量 $R_{\\text{ATP,LEF}}$ 分别为：\n    $$R_{\\text{NADPH}} = P_{\\text{LEF}} \\cdot \\phi_{\\text{NADPH, LEF}} = 0.25 \\cdot P_{\\text{LEF}}$$\n    $$R_{\\text{ATP,LEF}} = P_{\\text{LEF}} \\cdot \\phi_{\\text{ATP, LEF}} = 0.375 \\cdot P_{\\text{LEF}}$$\n\n**步骤3：将剩余光子分配至循环电子流**\n如果在 LEF 分配后仍有光子剩余，并且仍存在 ATP 缺口，则这些光子将被导向 CEF。\n*   剩余光子数 $P_{\\text{rem}}$ 为：\n    $$P_{\\text{rem}} = P - P_{\\text{LEF}}$$\n*   在计入 LEF 产生的 ATP 后，剩余的 ATP 需求 $D_{\\text{ATP,rem}}$ 为：\n    $$D_{\\text{ATP,rem}} = \\max(0, D_{\\text{ATP}} - R_{\\text{ATP,LEF}})$$\n*   仅当 $P_{\\text{rem}} > 0$ 且 $D_{\\text{ATP,rem}} > 0$ 时，CEF 才会被激活。CEF 满足此剩余 ATP 需求所需的光子数 $P_{\\text{CEF,req}}$ 将是：\n    $$P_{\\text{CEF,req}} = \\frac{D_{\\text{ATP,rem}}}{\\phi_{\\text{ATP, CEF}}} = \\frac{D_{\\text{ATP,rem}}}{0.5} = 2 \\cdot D_{\\text{ATP,rem}}$$\n*   实际分配给 CEF 的光子数 $P_{\\text{CEF}}$ 受剩余供应量的限制。\n    $$P_{\\text{CEF}} = \\min(P_{\\text{rem}}, P_{\\text{CEF,req}})$$\n\n**步骤4：最终产出计算**\n最终的生产速率是两个途径贡献的总和。`cyclic` 指示符取决于 CEF 是否被激活。\n*   CEF 产生的 ATP，$R_{\\text{ATP,CEF}}$ 为：\n    $$R_{\\text{ATP,CEF}} = P_{\\text{CEF}} \\cdot \\phi_{\\text{ATP, CEF}} = 0.5 \\cdot P_{\\text{CEF}}$$\n*   实现的总 ATP 生产速率 $R_{\\text{ATP}}$ 为：\n    $$R_{\\text{ATP}} = R_{\\text{ATP,LEF}} + R_{\\text{ATP,CEF}}$$\n*   总 NADPH 速率 $R_{\\text{NADPH}}$ 就是 LEF 产生的量。\n*   循环流的二进制指示符 `cyclic` 当且仅当有非零数量的光子被分配给 CEF 时为真：\n    $$\\text{cyclic} = (P_{\\text{CEF}} > 0)$$\n\n这些推导出的表达式构成了一个完整的算法，用于根据给定的输入计算所需的输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes achievable ATP and NADPH production rates for cyanobacterial\n    photometabolism based on a set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (P, r_CO2, A_extra)\n        (1000, 50, 0),\n        (500, 50, 40),\n        (300, 50, 0),\n        (180, 20, 10),\n        (240, 30, 20),\n        (200, 0, 50),\n    ]\n\n    # These stoichiometric yields are derived from the problem statement.\n    # Yields are in units of (molecules/photon).\n    # Linear Electron Flow (LEF)\n    # 1 NADPH / 4 photons\n    phi_nadph_lef = 0.25\n    # (6 H+ / 1 NADPH) * (1 ATP / 4 H+) / (4 photons / 1 NADPH) = 1.5 / 4 ATP/photon\n    phi_atp_lef = 0.375\n    \n    # Cyclic Electron Flow (CEF)\n    # (4 H+ / 2 photons) * (1 ATP / 4 H+) = 1 / 2 ATP/photon\n    phi_atp_cef = 0.5\n\n    results_data = []\n    for case in test_cases:\n        P, r_co2, a_extra = case\n\n        # Step 1: Calculate total metabolic demands for ATP and NADPH.\n        # Demand is in molecules/sec/cell.\n        demand_nadph = 2 * r_co2\n        demand_atp = 3 * r_co2 + a_extra\n\n        # Step 2: Allocate photons to LEF to meet NADPH demand (Priority 1).\n        # Since phi_nadph_lef is 0.25, photons required is demand / 0.25 = 4 * demand.\n        photons_for_lef_demand = demand_nadph / phi_nadph_lef\n        # Actual allocation is limited by total available photons.\n        photons_for_lef_actual = min(P, photons_for_lef_demand)\n\n        # Step 3: Calculate production from the LEF allocation.\n        prod_nadph = photons_for_lef_actual * phi_nadph_lef\n        prod_atp_from_lef = photons_for_lef_actual * phi_atp_lef\n\n        # Step 4: Determine if CEF is needed and possible.\n        photons_remaining = P - photons_for_lef_actual\n        demand_atp_remaining = max(0, demand_atp - prod_atp_from_lef)\n        \n        photons_for_cef_actual = 0.0\n        # CEF is engaged only if there are remaining photons AND a remaining ATP deficit.\n        if photons_remaining > 0 and demand_atp_remaining > 0:\n            # Calculate photons needed for CEF to meet the remaining ATP demand.\n            photons_for_cef_demand = demand_atp_remaining / phi_atp_cef\n            # Actual allocation is limited by the remaining photons.\n            photons_for_cef_actual = min(photons_remaining, photons_for_cef_demand)\n\n        # Step 5: Calculate final production rates and the cyclic flow indicator.\n        prod_atp_from_cef = photons_for_cef_actual * phi_atp_cef\n        total_prod_atp = prod_atp_from_lef + prod_atp_from_cef\n        total_prod_nadph = prod_nadph\n        is_cyclic = (photons_for_cef_actual > 0)\n        \n        # Append the calculated results for this case.\n        # Numbers are not rounded yet; rounding is for final formatting.\n        results_data.append([total_prod_atp, total_prod_nadph, is_cyclic])\n\n    # Format the final output string according to the problem specification.\n    # Each result [ATP, NADPH, cyclic] needs specific formatting.\n    # Rates must be rounded to exactly three decimal places.\n    # The boolean must be a language-native literal (True/False).\n    formatted_results = []\n    for res in results_data:\n        atp, nadph, cyclic = res\n        # f-string formats the numbers and directly inserts the boolean's string representation.\n        formatted_results.append(f\"[{atp:.3f}, {nadph:.3f}, {str(cyclic).lower()}]\")\n\n    # Final print statement must produce a single line in the required format.\n    # The format is a string representation of a list of lists.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2521591"}]}