{"hands_on_practices": [{"introduction": "恒化器是微生物生态学中的一个基础模型，它通过控制营养物流入和菌体流出，模拟了许多自然环境中资源持续供应与损失的动态平衡。理解恒化器理论对于分析微生物种群如何响应资源有效性和环境周转率至关重要。本练习将引导你从最基本的质量平衡方程出发，推导出维持微生物种群稳定存在的稳态条件，并确定决定种群存活或被“冲刷”出系统的临界稀释率 $D_{\\mathrm{crit}}$ [@problem_id:2473647]。", "problem": "在碳源限制条件下，一个海洋异养细菌的单一微生物种群在一个恒定体积、完全混合的连续流海水化学恒化器中生长。流入液以 $S_{in}$ 的浓度带来限制性溶解有机底物，流出液的浓度与反应器内相同。稀释率是 $D$（流速除以反应器体积）。比生长速率遵循 Monod 动力学，$\\mu(S) = \\mu_{\\max}\\,\\dfrac{S}{K_s + S}$，其中 $\\mu_{\\max}$ 是最大比生长速率，$K_s$ 是半饱和常数。生物质的增长通过一个恒定的生物质产率 $Y$（每消耗单位底物所产生的生物质）与底物消耗相关联。\n\n从化学恒化器的基本非稳态质量平衡以及所述的动力学和化学计量关系出发，完成以下任务：\n\n1) 推导非负稳态底物浓度 $S^*$ 和生物质浓度 $X^*$ 关于 $D$、$\\mu_{\\max}$、$K_s$、$Y$ 和 $S_{in}$ 的显式代数表达式。\n\n2) 通过在每个稳态点进行线性化，分析冲刷稳态和正值（非零生物质）稳态的局部稳定性。确定冲刷稳态局部渐近稳定的 $D$ 条件，正值稳态存在且局部渐近稳定的条件，以及稳定性发生切换的临界稀释率 $D_{\\mathrm{crit}}$。\n\n3) 使用参数 $\\mu_{\\max} = 0.60\\,\\mathrm{h}^{-1}$，$K_s = 0.50\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}$，$S_{in} = 2.0\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}$ 和 $Y = 0.45\\,\\mathrm{g}\\,\\mathrm{g}^{-1}$，计算 $D_{\\mathrm{crit}}$ 的数值，单位为 $\\mathrm{h}^{-1}$。将您的答案四舍五入到三位有效数字。用 $\\mathrm{h}^{-1}$ 表示您的最终答案，并仅报告此数字作为最终答案。", "solution": "该问题描述了一个标准的化学恒化器模型，这是一个耦合非线性常微分方程组。我们首先根据基本的质量平衡原理建立这些方程。设 $X$ 为微生物生物质的浓度，$S$ 为限制性底物的浓度。化学恒化器的体积 $V$ 是恒定的。流速为 $F$。稀释率定义为 $D = F/V$。\n\n生物质的质量平衡为：\n$$\n\\frac{d(VX)}{dt} = (\\text{生物质生长速率}) - (\\text{生物质流出速率})\n$$\n由于 $V$ 是常数，这变为：\n$$\nV\\frac{dX}{dt} = V(\\mu(S)X) - FX\n$$\n两边除以 $V$ 并使用 $D=F/V$，我们得到关于生物质浓度 $X$ 的第一个微分方程：\n$$\n\\frac{dX}{dt} = \\mu(S)X - DX\n$$\n底物的质量平衡为：\n$$\n\\frac{d(VS)}{dt} = (\\text{底物流入速率}) - (\\text{底物流出速率}) - (\\text{底物消耗速率})\n$$\n这可写为：\n$$\nV\\frac{dS}{dt} = FS_{in} - FS - V\\frac{\\mu(S)X}{Y}\n$$\n其中 $S_{in}$ 是流入底物浓度，$Y$ 是生物质产率系数。两边除以 $V$ 得到关于底物浓度 $S$ 的第二个微分方程：\n$$\n\\frac{dS}{dt} = D(S_{in} - S) - \\frac{\\mu(S)X}{Y}\n$$\n比生长速率 $\\mu(S)$ 由 Monod 方程给出：\n$$\n\\mu(S) = \\mu_{\\max}\\frac{S}{K_s + S}\n$$\n因此，完整的模型是一个由两个方程组成的系统：\n$$\n\\frac{dX}{dt} = \\left(\\mu_{\\max}\\frac{S}{K_s + S} - D\\right)X\n$$\n$$\n\\frac{dS}{dt} = D(S_{in} - S) - \\frac{1}{Y}\\left(\\mu_{\\max}\\frac{S}{K_s + S}\\right)X\n$$\n\n第 1 部分：稳态解的推导。\n为了求稳态浓度（记为 $X^*$ 和 $S^*$），我们将时间导数设为零：\n$$\n\\frac{dX}{dt} = 0 \\implies \\left(\\mu(S^*) - D\\right)X^* = 0\n$$\n$$\n\\frac{dS}{dt} = 0 \\implies D(S_{in} - S^*) - \\frac{\\mu(S^*)X^*}{Y} = 0\n$$\n从第一个方程可知，稳态有两种可能性：\n情况 1：冲刷稳态，其中 $X^* = 0$。\n将 $X^*=0$ 代入第二个稳态方程，得到：\n$$\nD(S_{in} - S^*) - 0 = 0\n$$\n由于 $D > 0$，这意味着 $S^* = S_{in}$。因此，第一个稳态是 $(X^*_1, S^*_1) = (0, S_{in})$。这表示微生物种群已完全从反应器中被冲刷出去的状态。\n\n情况 2：正值（共存）稳态，其中 $X^* > 0$。\n为此，第一个稳态方程要求括号中的项必须为零：\n$$\n\\mu(S^*) - D = 0 \\implies \\mu(S^*) = D\n$$\n代入 Monod 表达式：\n$$\n\\mu_{\\max}\\frac{S^*}{K_s + S^*} = D\n$$\n我们求解此方程得到 $S^*$：\n$$\n\\mu_{\\max}S^* = D(K_s + S^*) = DK_s + DS^*\n$$\n$$\nS^*(\\mu_{\\max} - D) = DK_s\n$$\n$$\nS^* = \\frac{DK_s}{\\mu_{\\max} - D}\n$$\n这是正值稳态的稳态底物浓度，我们记为 $S^*_2$。为使 $S^*_2$ 为非负值，由于 $D > 0$ 和 $K_s > 0$，我们必须有 $\\mu_{\\max} - D > 0$，即 $D < \\mu_{\\max}$。\n现在，我们使用第二个稳态方程来求相应的生物质浓度 $X^*_2$：\n$$\nD(S_{in} - S^*_2) - \\frac{\\mu(S^*_2)X^*_2}{Y} = 0\n$$\n因为我们处于 $\\mu(S^*_2)=D$ 的情况，这可以简化为：\n$$\nD(S_{in} - S^*_2) - \\frac{DX^*_2}{Y} = 0\n$$\n假设 $D \\neq 0$，我们可以两边除以 $D$：\n$$\nS_{in} - S^*_2 - \\frac{X^*_2}{Y} = 0\n$$\n求解 $X^*_2$：\n$$\nX^*_2 = Y(S_{in} - S^*_2)\n$$\n代入 $S^*_2$ 的表达式：\n$$\nX^*_2 = Y\\left(S_{in} - \\frac{DK_s}{\\mu_{\\max} - D}\\right)\n$$\n因此，非负稳态浓度的表达式为：\n冲刷稳态：$(X^*, S^*) = (0, S_{in})$\n正值稳态：$(X^*, S^*) = \\left(Y\\left(S_{in} - \\frac{DK_s}{\\mu_{\\max} - D}\\right), \\frac{DK_s}{\\mu_{\\max} - D}\\right)$\n\n第 2 部分：稳定性分析和临界稀释率。\n我们通过在每个稳态点附近对系统进行线性化来执行局部稳定性分析。系统的雅可比矩阵 $J$ 由下式给出：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial}{\\partial X}(\\mu(S)X - DX) & \\frac{\\partial}{\\partial S}(\\mu(S)X - DX) \\\\ \\frac{\\partial}{\\partial X}(D(S_{in}-S) - \\frac{\\mu(S)X}{Y}) & \\frac{\\partial}{\\partial S}(D(S_{in}-S) - \\frac{\\mu(S)X}{Y}) \\end{pmatrix}\n$$\n偏导数是：\n$$\n\\frac{\\partial f_1}{\\partial X} = \\mu(S) - D\n$$\n$$\n\\frac{\\partial f_1}{\\partial S} = X \\frac{d\\mu}{dS} = X \\frac{\\mu_{\\max}K_s}{(K_s+S)^2}\n$$\n$$\n\\frac{\\partial f_2}{\\partial X} = -\\frac{\\mu(S)}{Y}\n$$\n$$\n\\frac{\\partial f_2}{\\partial S} = -D - \\frac{X}{Y}\\frac{d\\mu}{dS} = -D - \\frac{X}{Y}\\frac{\\mu_{\\max}K_s}{(K_s+S)^2}\n$$\n冲刷稳态 $(X^*, S^*) = (0, S_{in})$ 的稳定性：\n我们计算在该点的雅可比矩阵：\n$$\nJ_1 = \\begin{pmatrix} \\mu(S_{in}) - D & 0 \\\\ -\\frac{\\mu(S_{in})}{Y} & -D \\end{pmatrix}\n$$\n该矩阵是下三角矩阵，因此其特征值 $(\\lambda_1, \\lambda_2)$ 是对角线元素：\n$$\n\\lambda_1 = \\mu(S_{in}) - D = \\mu_{\\max}\\frac{S_{in}}{K_s + S_{in}} - D\n$$\n$$\n\\lambda_2 = -D\n$$\n对于局部渐近稳定性，所有特征值都必须具有负实部。由于 $D > 0$，$\\lambda_2$ 总是负的。因此稳定性取决于 $\\lambda_1$ 的符号。如果 $\\lambda_1 < 0$，冲刷稳态是稳定的，这意味着：\n$$\n\\mu_{\\max}\\frac{S_{in}}{K_s + S_{in}} - D < 0 \\implies D > \\mu_{\\max}\\frac{S_{in}}{K_s + S_{in}}\n$$\n我们将临界稀释率 $D_{\\mathrm{crit}}$ 定义为此阈值：\n$$\nD_{\\mathrm{crit}} = \\mu_{\\max}\\frac{S_{in}}{K_s + S_{in}}\n$$\n所以，如果 $D > D_{\\mathrm{crit}}$，冲刷稳态是局部渐近稳定的。\n\n正值稳态 $(X_2^*, S_2^*)$ 的稳定性：\n仅当 $S_{in} > S_2^*$ 时，此稳态才有物理意义（即 $X_2^* > 0$），这可以简化为 $D < D_{\\mathrm{crit}}$。我们现在分析它在 $D < D_{\\mathrm{crit}}$ 时的稳定性。我们计算在该点的雅可比矩阵，注意 $\\mu(S_2^*) = D$：\n$$\nJ_2 = \\begin{pmatrix} \\mu(S_2^*) - D & X_2^*\\frac{d\\mu}{dS}\\Big|_{S_2^*} \\\\ -\\frac{\\mu(S_2^*)}{Y} & -D - \\frac{X_2^*}{Y}\\frac{d\\mu}{dS}\\Big|_{S_2^*} \\end{pmatrix} = \\begin{pmatrix} 0 & X_2^*\\mu'(S_2^*) \\\\ -\\frac{D}{Y} & -D - \\frac{X_2^*}{Y}\\mu'(S_2^*) \\end{pmatrix}\n$$\n其中 $\\mu'(S_2^*)$ 是 $\\mu(S)$ 在 $S_2^*$ 处求得的导数。这个不动点的稳定性由 $J_2$ 的特征值决定，这些特征值是特征方程 $\\lambda^2 - \\mathrm{Tr}(J_2)\\lambda + \\det(J_2) = 0$ 的根。为了保证稳定性，我们需要 $\\mathrm{Tr}(J_2) < 0$ 和 $\\det(J_2) > 0$。\n迹是：\n$$\n\\mathrm{Tr}(J_2) = 0 + \\left(-D - \\frac{X_2^*}{Y}\\mu'(S_2^*)\\right) = -D - \\frac{X_2^*}{Y}\\mu'(S_2^*)\n$$\n由于当 $D < D_{\\mathrm{crit}}$ 时 $X_2^* > 0$，且 $D>0$，$Y>0$，以及对于所有 $S \\geq 0$，$\\mu'(S) = \\frac{\\mu_{\\max}K_s}{(K_s+S)^2} > 0$，所以迹中的每一项都是正的。因此，$\\mathrm{Tr}(J_2) < 0$。\n行列式是：\n$$\n\\det(J_2) = (0)\\left(-D - \\frac{X_2^*}{Y}\\mu'(S_2^*)\\right) - \\left(X_2^*\\mu'(S_2^*)\\right)\\left(-\\frac{D}{Y}\\right) = \\frac{D X_2^* \\mu'(S_2^*)}{Y}\n$$\n由于 $D>0$，$Y>0$，$\\mu'(S_2^*)>0$，行列式的符号与 $X_2^*$ 的符号相同。正如已确定的，$X_2^* > 0$ 当且仅当 $D < D_{\\mathrm{crit}}$。因此，对于 $D < D_{\\mathrm{crit}}$，我们有 $\\det(J_2) > 0$。\n由于当 $D < D_{\\mathrm{crit}}$ 时，$\\mathrm{Tr}(J_2) < 0$ 和 $\\det(J_2) > 0$ 这两个条件都满足，因此正值稳态在它存在时是局部渐近稳定的。\n\n总结如下：\n- 当 $D > D_{\\mathrm{crit}}$ 时，冲刷稳态是稳定的。\n- 当 $D < D_{\\mathrm{crit}}$ 时，正值稳态存在且稳定。\n- 稳定性发生切换的临界稀释率是 $D_{\\mathrm{crit}} = \\mu_{\\max}\\frac{S_{in}}{K_s + S_{in}}$。在这一点上，发生跨临界分岔。\n\n第 3 部分：$D_{\\mathrm{crit}}$ 的数值计算。\n问题给出了以下参数值：\n$$\n\\mu_{\\max} = 0.60\\,\\mathrm{h}^{-1}\n$$\n$$\nK_s = 0.50\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}\n$$\n$$\nS_{in} = 2.0\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}\n$$\n$Y$ 的值在此计算中不需要。我们使用推导出的 $D_{\\mathrm{crit}}$ 公式：\n$$\nD_{\\mathrm{crit}} = \\mu_{\\max}\\frac{S_{in}}{K_s + S_{in}}\n$$\n代入数值：\n$$\nD_{\\mathrm{crit}} = (0.60\\,\\mathrm{h}^{-1}) \\times \\frac{2.0\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}}{0.50\\,\\mathrm{mg}\\,\\mathrm{L}^{-1} + 2.0\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}}\n$$\n$$\nD_{\\mathrm{crit}} = 0.60 \\times \\frac{2.0}{2.5}\n$$\n$$\nD_{\\mathrm{crit}} = 0.60 \\times 0.8\n$$\n$$\nD_{\\mathrm{crit}} = 0.48\\,\\mathrm{h}^{-1}\n$$\n问题要求答案保留三位有效数字。因此，最终数值是 $0.480\\,\\mathrm{h}^{-1}$。", "answer": "$$\n\\boxed{0.480}\n$$", "id": "2473647"}, {"introduction": "在理想化的恒化器模型之外，现实中的微生物常常栖息于多孔介质或颗粒物等结构化环境中，此时物质传输过程可能成为限制其活性的关键瓶颈。本练习以海洋雪颗粒为例，引导你建立一个反应-扩散模型，用以分析营养物在颗粒内部的扩散供给与微生物消耗之间的平衡关系。通过推导并计算一个关键的无量纲数，你将学会如何定量判断一个微生物“热点”区域的活性是由反应动力学主导还是由物理传输主导[@problem_id:2473663]。", "problem": "一个由胞外多糖构成的多孔球形海洋雪聚集体，其上附着着密集的异养生物群落，该群落通过一级动力学消耗溶解的醋酸盐。在一个静止的海洋环境中，假设周围海水中的醋酸盐浓度恒定，该聚集体可以很好地描述为一个半径为 $L$ 的球体，并且醋酸盐在聚集体内的分子扩散过程的扩散系数为 $D$（假设有效扩散系数等于分子扩散系数，并忽略任何外部边界层）。聚集体内部的局部醋酸盐浓度 $C(r)$ 受扩散和速率常数为 $k$ 的一级消耗过程控制。\n\n从球坐标系下的菲克定律（Fick’s law）和一级消耗项出发，写出 $C(r)$ 的稳态质量平衡方程，并通过用 $L$ 对半径进行标度和用环境浓度对浓度进行标度来将其无量纲化，以确定比较特征反应时间尺度与扩散输运时间尺度的唯一无量纲群。使用所提供的实验上合理的参数值 $L = 5.0 \\times 10^{-4}\\ \\mathrm{m}$，$k = 2.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}$ 和 $D = 7.0 \\times 10^{-10}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}$，对此无量纲群进行数值计算。\n\n仅报告此无量纲群的数值，四舍五入至 $3$ 位有效数字，作为一个纯数（无单位）。该值可用于评估输运或反应是否限制了聚集体内部的底物可用性，但最终报告的答案中请勿包含该解释。", "solution": "该问题要求推导并计算一个控制球形海洋雪聚集体中反应-扩散过程的无量纲群。\n\n首先，我们建立球形聚集体内部醋酸盐浓度 $C(r)$ 的稳态质量平衡控制方程。控制体积内化学物质的一般守恒方程由下式给出：\n$$ \\frac{\\partial C}{\\partial t} = -\\nabla \\cdot \\mathbf{J} + R_{prod} - R_{cons} $$\n其中 $C$ 是浓度，$t$ 是时间，$\\mathbf{J}$ 是摩尔通量矢量，$R$ 项代表生成和消耗速率。\n\n在本问题中，我们处于稳态，因此 $\\frac{\\partial C}{\\partial t} = 0$。醋酸盐没有生成，消耗是一个一级过程，所以净反应项为 $R = -kC(r)$，其中 $k$ 是一级速率常数。通量 $\\mathbf{J}$ 是由分子扩散引起的，并由菲克第一定律（Fick's first law）描述，$\\mathbf{J} = -D \\nabla C$，其中 $D$ 是扩散系数。\n\n鉴于问题的球对称性，我们使用球坐标系，浓度 $C$ 仅取决于离聚集体中心的径向距离 $r$。通量矢量只有一个径向分量，$J_r = -D \\frac{dC}{dr}$。对于仅有径向的场，在球坐标系中通量矢量的散度 $\\nabla \\cdot \\mathbf{J}$ 为：\n$$ \\nabla \\cdot \\mathbf{J} = \\frac{1}{r^2} \\frac{d}{dr} (r^2 J_r) = \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\left(-D \\frac{dC}{dr}\\right) \\right) $$\n假设 $D$ 为常数，上式简化为：\n$$ \\nabla \\cdot \\mathbf{J} = -D \\left( \\frac{d^2C}{dr^2} + \\frac{2}{r} \\frac{dC}{dr} \\right) $$\n将这些表达式代入稳态守恒方程（$0 = -\\nabla \\cdot \\mathbf{J} + R$），得到：\n$$ 0 = D \\left( \\frac{d^2C}{dr^2} + \\frac{2}{r} \\frac{dC}{dr} \\right) - kC $$\n重新整理得到关于 $C(r)$ 的二阶常微分控制方程：\n$$ \\frac{d^2C}{dr^2} + \\frac{2}{r} \\frac{dC}{dr} - \\frac{k}{D} C = 0 $$\n该物理系统的边界条件是：\n1. 在球心处（$r=0$），根据对称性论证，必须没有浓度梯度：$\\frac{dC}{dr}|_{r=0} = 0$。\n2. 在球体表面（$r=L$），浓度等于恒定的环境浓度，我们将其表示为 $C_S$：$C(L) = C_S$。题目中要求忽略任何外部边界层，这使得该条件变得精确。\n\n接下来，我们将控制方程无量纲化。我们引入题目中指定的无量纲变量：\n- 无量纲半径：$\\rho = \\frac{r}{L}$\n- 无量纲浓度：$\\psi = \\frac{C}{C_S}$\n\n我们必须将关于有量纲半径 $r$ 的导数用关于无量纲半径 $\\rho$ 的导数来重新表达：\n$$ \\frac{dC}{dr} = \\frac{d(C_S \\psi)}{d(\\rho L)} = \\frac{C_S}{L} \\frac{d\\psi}{d\\rho} $$\n$$ \\frac{d^2C}{dr^2} = \\frac{d}{dr} \\left( \\frac{C_S}{L} \\frac{d\\psi}{d\\rho} \\right) = \\frac{d}{d(\\rho L)} \\left( \\frac{C_S}{L} \\frac{d\\psi}{d\\rho} \\right) = \\frac{C_S}{L^2} \\frac{d^2\\psi}{d\\rho^2} $$\n将这些无量纲形式代入控制微分方程：\n$$ \\left( \\frac{C_S}{L^2} \\frac{d^2\\psi}{d\\rho^2} \\right) + \\frac{2}{\\rho L} \\left( \\frac{C_S}{L} \\frac{d\\psi}{d\\rho} \\right) - \\frac{k}{D} (C_S \\psi) = 0 $$\n我们将整个方程除以常数项 $\\frac{C_S}{L^2}$，使其无量纲化：\n$$ \\frac{d^2\\psi}{d\\rho^2} + \\frac{2}{\\rho} \\frac{d\\psi}{d\\rho} - \\left( \\frac{k L^2}{D} \\right) \\psi = 0 $$\n这是控制方程的无量纲形式。出现的唯一无量纲群是 $\\psi$ 项的系数。该群通常表示为赛勒模数（Thiele modulus）的平方（$\\Phi^2$），代表特征反应速率与特征扩散速率之比。\n\n题目要求找到比较特征反应时间尺度与扩散输运时间尺度的群，但其物理解释应为扩散时间尺度与反应时间尺度之比。让我们验证这一物理解释。穿过长度 $L$ 的特征扩散时间为 $\\tau_{diff} \\sim \\frac{L^2}{D}$。一级反应的特征时间为 $\\tau_{rxn} \\sim \\frac{1}{k}$。两者的比值为：\n$$ \\frac{\\tau_{diff}}{\\tau_{rxn}} = \\frac{L^2/D}{1/k} = \\frac{k L^2}{D} $$\n这证实了我们必须计算的无量纲群是 $\\frac{k L^2}{D}$。\n\n最后，我们使用所提供的参数计算该群的数值：\n$L = 5.0 \\times 10^{-4}\\ \\mathrm{m}$\n$k = 2.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}$\n$D = 7.0 \\times 10^{-10}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}$\n\n无量纲群为：\n$$ \\frac{k L^2}{D} = \\frac{(2.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}) \\times (5.0 \\times 10^{-4}\\ \\mathrm{m})^2}{7.0 \\times 10^{-10}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}} $$\n$$ \\frac{k L^2}{D} = \\frac{(2.0 \\times 10^{-2}) \\times (25.0 \\times 10^{-8})}{7.0 \\times 10^{-10}} \\frac{\\mathrm{s}^{-1} \\cdot \\mathrm{m}^2}{\\mathrm{m}^{2}\\ \\mathrm{s}^{-1}} $$\n$$ \\frac{k L^2}{D} = \\frac{50.0 \\times 10^{-10}}{7.0 \\times 10^{-10}} $$\n$$ \\frac{k L^2}{D} = \\frac{50.0}{7.0} \\approx 7.142857 $$\n题目要求将该值四舍五入至 $3$ 位有效数字。\n$$ \\frac{k L^2}{D} \\approx 7.14 $$\n这就是所要求的无量纲群的最终数值。", "answer": "$$\n\\boxed{7.14}\n$$", "id": "2473663"}, {"introduction": "微生物的命运不仅受化学和物理环境的制约，更深刻地被种间生物相互作用所塑造。本练习将带领你从单个种群的模型跃升至一个包含营养物、细菌（猎物）和原生动物（捕食者）的微型生态系统。这是一个高级计算挑战，你需要通过编程实现一个经典的捕食-被捕食模型，分析其平衡点的稳定性，并探索捕食关系如何驱动系统产生简单的稳态模型无法预测的持续振荡行为（极限环）[@problem_id:2473618]。", "problem": "考虑一个封闭、充分混合的水生微观世界，其中溶解性无机营养物、细菌猎物种群和原生生物捕食者相互作用。假设限制性营养元素（例如氮）严格守恒，因此总元素含量是恒定的。设状态变量为：溶解性营养物 $N(t)$、细菌生物量 $B(t)$ 和捕食者生物量 $P(t)$，所有变量均以相同的元素单位计量。捕食者的取食遵循 Holling II 型功能性响应。细菌生长遵循 Monod 动力学，所有未被同化的物质和死亡造成的损失都瞬时再矿化为溶解性营养物。其常微分方程 (ODE) 模型如下：\n$$\n\\frac{dN}{dt} = - \\mu_{\\max}\\frac{N}{K + N}B + (1 - e)\\,g(B)\\,P + m_B B + m_P P,\n$$\n$$\n\\frac{dB}{dt} = \\mu_{\\max}\\frac{N}{K + N}B - g(B)\\,P - m_B B,\n$$\n$$\n\\frac{dP}{dt} = e\\,g(B)\\,P - m_P P,\n$$\n其中\n$$\ng(B) = \\frac{a\\,B}{1 + a\\,h\\,B},\n$$\n且严格满足质量守恒\n$$\nN(t) + B(t) + P(t) = T \\quad \\text{对所有 } t \\ge 0.\n$$\n这里，$\\mu_{\\max}$ 是细菌的最大比增长率，$K$ 是营养限制性生长的半饱和常数，$e$ 是捕食者的同化效率，$m_B$ 和 $m_P$ 分别是细菌和捕食者的死亡率或维持损失率，$a$ 是捕食者的攻击率，$h$ 是捕食者的处理时间，$T$ 是恒定的总元素含量。所有参数均为严格正值。您可以假设，当该模型被解释为限制性营养物质-质量平衡系统时，对于水生、海洋或陆地微生物而言，该模型在生物学上是现实的。\n\n仅从上述模型、Monod 生长和 Holling II 型的核心定义以及质量守恒约束出发，推导一种计算方法，该方法对于每一组选定的 $(a,h)$：\n- 确定生物学上可行的非平凡平衡点，\n- 分析内部平衡点（若存在）的局部线性稳定性，\n- 判断长期动态是否表现出非平衡吸引极限环（“稳态循环”），\n- 并为每组参数返回一个简单的分类。\n\n您的程序必须从第一性原理出发，实现以下原则：\n- 利用质量守恒约束来简化平衡点搜索，并确保所有变量保持非负。\n- 对于 $P^\\ast > 0$ 的内部平衡点，利用由 $\\frac{dP}{dt} = 0$ 推导出的定义属性 $e\\,g(B^\\ast) = m_P$ 来简化问题并求解 $B^\\ast$。\n- 利用线性化的定义，在平衡点处构建常微分方程的雅可比矩阵，并根据其特征值确定稳定性。\n- 从一个固定的、生物学上合理的初始条件出发，对常微分方程进行数值积分，以确定是否存在稳定的非平衡周期轨道。通过一个客观的时间序列标准，在舍弃瞬态过程后，基于峰值计数和振幅来判断“存在循环”或“不存在循环”。\n\n科学现实性约束：\n- 将系统视为封闭且质量守恒的，即在任何时候都有 $N + B + P = T$。除了被瞬时再矿化的内部死亡和未同化项外，不要虚构任何外部输入或损失。\n- 使用以下参数值，这些值对于微型浮游动物-细菌-营养物系统是合理的，并且是自洽的。\n- 时间以天为单位，但您的输出将是无量纲的布尔值或整数，因此无需打印任何物理单位。\n\n所有测试共用的固定参数值：\n- $\\mu_{\\max} = 1.2$\n- $K = 0.4$\n- $e = 0.45$\n- $m_B = 0.05$\n- $m_P = 0.1$\n- $T = 4.0$\n\n所有测试的初始条件：\n- $B(0) = 0.5$, $P(0) = 0.2$, $N(0) = T - B(0) - P(0)$.\n\n测试套件（每个测试用例是一对 $(a,h)$）：\n- 测试 1: $(a,h) = (0.2, 0.3)$\n- 测试 2: $(a,h) = (1.0, 0.5)$\n- 测试 3: $(a,h) = (3.0, 0.1)$\n- 测试 4: $(a,h) = (5.0, 0.05)$\n- 测试 5: $(a,h) = (2.0, 4.0)$\n\n对于每个测试用例，您的程序必须：\n1. 计算可行的平衡点，包括内部平衡点（如果存在，即 $B^\\ast > 0$, $P^\\ast > 0$, $N^\\ast \\ge 0$），仅使用上述定义和质量守恒关系 $N^\\ast = T - B^\\ast - P^\\ast$。\n2. 计算内部平衡点（如果存在）处的常微分方程的雅可比矩阵，计算其特征值，并确定内部平衡点是局部稳定的（除对应于质量守恒的特征值外，所有特征值的实部均为负）还是不稳定的（至少有一个剩余特征值的实部为正）。\n3. 从初始条件开始对 ODE 系统进行数值积分，直至足够长的时间以消除瞬态影响，然后通过以下方式检测是否存在非平衡吸引极限环：\n   - 在最终时间窗口内，计算 $P(t)$ 的局部最大值达到一个固定的最小数量，\n   - 并且要求同一窗口内的峰谷振幅超过一个小的绝对阈值。\n   如果两个条件都满足，且轨迹未坍缩到边界平衡点，则判定为“存在循环”；否则判定为“不存在循环”。\n4. 为每个测试用例返回一个整数分类：如果存在非平衡吸引极限环，则输出 $1$，否则输出 $0$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含 5 个测试用例的分类，形式为逗号分隔的整数列表，并用方括号括起来。例如，如果分类为 $1, 0, 1, 0, 0$，则输出必须是下面这一行：\n\"[1,0,1,0,0]\".\n\n备注：\n- 不涉及角度单位。\n- 不要输出任何物理单位。\n- 循环的判定标准必须仅依赖于给定的模型和定义，且除了可从上述定义推导出的公式外，不得使用任何预先计算的公式。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取给定条件**\n- 状态变量：溶解性营养物 $N(t)$、细菌生物量 $B(t)$、捕食者生物量 $P(t)$，单位为限制性元素浓度。\n- ODE 系统：\n$$\n\\frac{dN}{dt} = - \\mu_{\\max}\\frac{N}{K + N}B + (1 - e)\\,g(B)\\,P + m_B B + m_P P\n$$\n$$\n\\frac{dB}{dt} = \\mu_{\\max}\\frac{N}{K + N}B - g(B)\\,P - m_B B\n$$\n$$\n\\frac{dP}{dt} = e\\,g(B)\\,P - m_P P\n$$\n- 捕食者功能性响应 (Holling II 型): $g(B) = \\frac{a\\,B}{1 + a\\,h\\,B}$\n- 质量守恒约束: $N(t) + B(t) + P(t) = T$ 对所有 $t \\ge 0$。\n- 固定参数: $\\mu_{\\max} = 1.2$, $K = 0.4$, $e = 0.45$, $m_B = 0.05$, $m_P = 0.1$, $T = 4.0$。所有参数均为严格正值。\n- 初始条件: $B(0) = 0.5$, $P(0) = 0.2$, $N(0) = T - B(0) - P(0) = 3.3$。\n- 测试套件: 五对 $(a,h)$: $(0.2, 0.3)$, $(1.0, 0.5)$, $(3.0, 0.1)$, $(5.0, 0.05)$, $(2.0, 4.0)$。\n- 任务：为每个测试用例确定是否存在非平衡吸引极限环，并输出一个二进制分类（1 代表存在循环，0 代表不存在）。\n\n**步骤 2：使用提取的给定条件进行验证**\n该问题在科学和数学上是合理的。\n- **科学依据：** 该模型是营养物-猎物-捕食者动态的标准且成熟的表示方法，结合了微生物生长的 Monod 动力学和捕食的 Holling II 型功能性响应。这些是理论生态学和微生物学中的典范模型。具有质量守恒的封闭系统是微观世界研究的基础。\n- **适定性：** 该常微分方程组在生物学相关域（$N, B, P \\ge 0$）内具有局部李普希茨连续的右端项，这确保了给定初始条件下解的存在性和唯一性。\n- **客观性和完整性：** 问题以数学精度进行了规定。所有必需的参数、方程、初始条件和分析目标都已提供，形成了一个自洽且明确的任务。\n- **一致性：** 系统内部是一致的。将三个 ODE 相加可得 $\\frac{dN}{dt} + \\frac{dB}{dt} + \\frac{dP}{dt} = 0$，这是所述质量守恒定律 $N(t) + B(t) + P(t) = T$ 的微分形式。\n\n**步骤 3：结论与行动**\n该问题是有效的。一个严谨的解是可能的，并将被构建出来。\n\n**计算方法的推导**\n\n通过质量守恒约束 $N(t) + B(t) + P(t) = T$ 简化了分析。动态被限制在由 $B \\ge 0$, $P \\ge 0$, 和 $B+P \\le T$ 定义的单纯形内。我们可以通过将 $N(t) = T - B(t) - P(t)$ 代入 $B$ 和 $P$ 的方程中，将系统从三维降至二维。得到的平面系统为：\n$$\n\\frac{dB}{dt} = \\mu_{\\max}\\frac{T - B - P}{K + T - B - P}B - \\frac{aB}{1 + ahB}P - m_B B\n$$\n$$\n\\frac{dP}{dt} = \\left( e\\frac{aB}{1 + ahB} - m_P \\right) P\n$$\n对这个二维系统的分析足以表征整个系统的动态。\n\n**1. 可行平衡点的计算**\n平衡点 $(\\B^\\ast, P^\\ast)$ 是一个使 $\\frac{dB}{dt} = 0$ 且 $\\frac{dP}{dt} = 0$ 的状态。我们寻求 $B^\\ast > 0$ 且 $P^\\ast > 0$ 的非平凡内部平衡点。\n\n从 $\\frac{dP}{dt} = 0$ 可知，对于 $P^\\ast > 0$，我们必须有括号中的项等于零：\n$$\ne\\frac{aB^\\ast}{1 + ahB^\\ast} - m_P = 0 \\implies e a B^\\ast = m_P(1 + ahB^\\ast)\n$$\n解出 $B^\\ast$ 可得：\n$$\nB^\\ast(ea - am_P h) = m_P \\implies B^\\ast = \\frac{m_P}{a(e - m_P h)}\n$$\n为了得到一个有生物学意义的（正的）$B^\\ast$，因为 $a>0$ 且 $m_P>0$，分母必须为正。这给出了内部平衡点存在的条件：$e - m_P h > 0$，或 $e > m_P h$。如果不满足此条件，捕食者无法自我维持，也就不可能共存。\n\n接下来，我们使用 $\\frac{dB}{dt} = 0$ 方程。由于 $B^\\ast > 0$，我们可以除以 $B^\\ast$：\n$$\n\\mu_{\\max}\\frac{N^\\ast}{K + N^\\ast} - \\frac{g(B^\\ast)}{B^\\ast}P^\\ast - m_B = 0\n$$\n代入 $N^\\ast = T - B^\\ast - P^\\ast$ 和 $g(B^\\ast) = \\frac{m_P}{e}$：\n$$\n\\mu_{\\max}\\frac{T - B^\\ast - P^\\ast}{K + T - B^\\ast - P^\\ast} - \\frac{m_P}{eB^\\ast}P^\\ast - m_B = 0\n$$\n这是一个关于 $P^\\ast$ 的非线性方程。令 $C_1 = T - B^\\ast$, $C_2 = K + T - B^\\ast$, and $C_3 = \\frac{m_P}{eB^\\ast}$。方程变为：\n$$\n\\mu_{\\max}\\frac{C_1 - P^\\ast}{C_2 - P^\\ast} = m_B + C_3 P^\\ast\n$$\n整理后得到一个关于 $P^\\ast$ 的二次方程，形式为 $A(P^\\ast)^2 + B P^\\ast + C = 0$：\n$$\nC_3 (P^\\ast)^2 + (m_B - \\mu_{\\max} - C_2 C_3)P^\\ast + (\\mu_{\\max}C_1 - m_B C_2) = 0\n$$\n可以找到这个二次方程的根。如果一个根是实数且满足 $0 < P^\\ast < T - B^\\ast$，则该根在生物学上是可行的。通常只存在一个这样的根。如果找到了一个有效的 $P^\\ast$，则平衡点为 $(N^\\ast, B^\\ast, P^\\ast)$，其中 $N^\\ast = T - B^\\ast - P^\\ast$。\n\n**2. 局部稳定性分析**\n内部平衡点 $(B^\\ast, P^\\ast)$ 的稳定性由二维系统在此点求值的雅可比矩阵的特征值决定。令 $f(B, P) = \\frac{dB}{dt}$ 和 $h(B, P) = \\frac{dP}{dt}$。雅可比矩阵为：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f}{\\partial B} & \\frac{\\partial f}{\\partial P} \\\\ \\frac{\\partial h}{\\partial B} & \\frac{\\partial h}{\\partial P} \\end{pmatrix}_{(B^\\ast, P^\\ast)}\n$$\n偏导数是：\n- $\\frac{\\partial f}{\\partial B} = \\mu_{\\max}\\left(\\frac{N}{K+N} - \\frac{BK}{(K+N)^2}\\right) - P \\frac{dg}{dB} - m_B$\n- $\\frac{\\partial f}{\\partial P} = -\\mu_{\\max}\\frac{BK}{(K+N)^2} - g(B)$\n- $\\frac{\\partial h}{\\partial B} = P e \\frac{dg}{dB}$\n- $\\frac{\\partial h}{\\partial P} = e g(B) - m_P$\n其中 $\\frac{dg}{dB} = \\frac{a}{(1+ahB)^2}$。\n\n在平衡点 $(B^\\ast, P^\\ast)$ 处：\n- $J_{22} = \\frac{\\partial h}{\\partial P} = e g(B^\\ast) - m_P = 0$。\n- $J_{11} = \\frac{\\partial f}{\\partial B}$ 利用平衡条件可以简化为：\n$J_{11} = P^\\ast\\left(\\frac{g(B^\\ast)}{B^\\ast} - \\frac{dg(B^\\ast)}{dB}\\right) - \\mu_{\\max}\\frac{B^\\ast K}{(K+N^\\ast)^2} = P^\\ast \\frac{a^2hB^\\ast}{(1+ahB^\\ast)^2} - \\mu_{\\max}\\frac{B^\\ast K}{(K+N^\\ast)^2}$。\n- $J_{21} = \\frac{\\partial h}{\\partial B} = P^\\ast e \\frac{a}{(1+ahB^\\ast)^2} > 0$。\n- $J_{12} = \\frac{\\partial f}{\\partial P} = -\\mu_{\\max}\\frac{B^\\ast K}{(K+N^\\ast)^2} - g(B^\\ast) < 0$。\n\n特征值 $\\lambda$ 的特征方程是 $\\lambda^2 - \\text{tr}(J)\\lambda + \\det(J) = 0$。\n迹为 $\\text{tr}(J) = J_{11}$。行列式为 $\\det(J) = -J_{12}J_{21} > 0$。\n根据劳斯-赫尔维茨判据，平衡点是局部稳定的当且仅当 $\\text{tr}(J) < 0$ 且 $\\det(J) > 0$。由于 $\\det(J)$ 恒为正，稳定性仅由迹的符号决定：\n- 若 $\\text{tr}(J) = J_{11} < 0$，平衡点是稳定的（吸引的）。\n- 若 $\\text{tr}(J) = J_{11} > 0$，平衡点是不稳定的（排斥的）。这是通过霍普夫分岔可能产生极限环的条件。\n\n**3. 极限环的数值检测**\n确定稳定非平衡吸引子（极限环）存在的最直接方法是对 ODE 系统进行数值积分。步骤如下：\n1.  对二维 ODE 系统...进行积分，积分时间要足够长，以使初始瞬态衰减。总时间 $T_{final}=1000$ 天是足够的。\n2.  在瞬态后阶段分析系统的行为，例如，对于 $t \\in [500, 1000]$。\n3.  基于捕食者种群的时间序列 $P(t)$ 来识别极限环：\n    - **持续性：** 轨迹不得坍缩到边界。通过验证 $B(t)$ 和 $P(t)$ 的最小值大于一个小的容差（例如 $10^{-6}$）来检查。\n    - **振荡：** 时间序列必须表现出持续的振荡，通过计算最小数量的局部最大值（峰值）来确认。在最终 500 天的窗口内，最少 $3$ 个峰值是一个合理的标准。\n    - **振幅：** 振荡必须具有足够大的幅度，以区别于围绕稳定点的数值噪声。峰谷振幅 $\\max(P(t)) - \\min(P(t))$ 必须超过一个小的绝对阈值（例如 $0.01$）。\n4.  如果所有三个条件都满足，系统就表现出极限环，分类为 $1$。否则，假定系统趋近于一个稳定的平衡点，分类为 $0$。\n\n这种分析推理和数值验证的结合，为解决所述问题提供了一个完整的方法。最终的实现将侧重于数值分类方案。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Fixed parameter values as specified in the problem statement.\nMU_MAX = 1.2\nK = 0.4\nE = 0.45\nM_B = 0.05\nM_P = 0.1\nT = 4.0\n\n# Initial condition for all tests.\nY0 = [0.5, 0.2]  # [B(0), P(0)]\n\ndef model(t, y, a, h):\n    \"\"\"\n    Defines the 2D ODE system for bacterial (B) and predator (P) biomass.\n    The nutrient concentration N is implicitly defined by mass conservation.\n    \"\"\"\n    B, P = y\n    \n    # Enforce non-negativity to handle potential numerical errors near boundaries.\n    B = max(0.0, B)\n    P = max(0.0, P)\n    N = T - B - P\n    N = max(0.0, N)\n\n    # Bacterial growth rate (Monod kinetics)\n    # Check for N=0 to avoid division by zero if K=0, although K>0 here.\n    mu_term = MU_MAX * N / (K + N) if (K + N) > 0 else 0.0\n    \n    # Predator grazing rate (Holling Type II functional response)\n    # Check for B=0 to avoid division by denominator=0 if h=0, though a,h>0.\n    g_B = a * B / (1.0 + a * h * B) if (1.0 + a * h * B) > 0 else 0.0\n\n    # The system of Ordinary Differential Equations\n    dBdt = mu_term * B - g_B * P - M_B * B\n    dPdt = E * g_B * P - M_P * P\n    \n    return [dBdt, dPdt]\n\ndef classify_dynamics(a, h):\n    \"\"\"\n    Analyzes the long-term dynamics for a given parameter set (a, h)\n    by integrating the ODE and applying a cycle detection criterion.\n\n    Returns:\n        int: 1 if a limit cycle is detected, 0 otherwise.\n    \"\"\"\n    # Integration time settings\n    t_start, t_end = 0, 1000\n    t_transient = 500\n    \n    # Numerically integrate the ODE system.\n    # 'dense_output=True' is used to get a continuous solution.\n    sol = solve_ivp(\n        model, \n        [t_start, t_end], \n        Y0, \n        args=(a, h), \n        dense_output=True, \n        method='RK45', \n        rtol=1e-6, \n        atol=1e-9\n    )\n\n    # Evaluate the solution in the post-transient window.\n    # Use a sufficient number of points for accurate peak detection.\n    t_eval = np.linspace(t_transient, t_end, 5000)\n    y_eval = sol.sol(t_eval)\n    \n    b_series = y_eval[0, :]\n    p_series = y_eval[1, :]\n\n    # --- Cycle Detection Criterion ---\n\n    # 1. Check for collapse to a boundary equilibrium.\n    # If the mean population is very low, it's not a coexistence cycle.\n    BOUNDARY_TOLERANCE = 1e-5\n    if np.mean(p_series) < BOUNDARY_TOLERANCE or np.mean(b_series) < BOUNDARY_TOLERANCE:\n        return 0\n\n    # 2. Check for significant amplitude.\n    # Distinguishes true oscillations from numerical noise around a stable point.\n    AMPLITUDE_THRESHOLD = 0.01\n    amplitude = np.max(p_series) - np.min(p_series)\n    if amplitude < AMPLITUDE_THRESHOLD:\n        return 0\n\n    # 3. Check for a minimum number of peaks, indicating sustained oscillation.\n    MIN_PEAKS = 3\n    # A peak is detected where the sign of the derivative changes from positive to negative.\n    diffs = np.diff(p_series)\n    # The condition `(diffs[:-1] > 0) & (diffs[1:] < 0)` reliably finds strict local maxima.\n    num_peaks = np.sum((diffs[:-1] > 0) & (diffs[1:] < 0))\n    \n    if num_peaks >= MIN_PEAKS:\n        return 1\n    else:\n        return 0\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final output.\n    \"\"\"\n    # Test suite from the problem statement\n    test_cases = [\n        (0.2, 0.3),   # Test 1\n        (1.0, 0.5),   # Test 2\n        (3.0, 0.1),   # Test 3\n        (5.0, 0.05),  # Test 4\n        (2.0, 4.0),   # Test 5\n    ]\n\n    results = []\n    for a, h in test_cases:\n        classification = classify_dynamics(a, h)\n        results.append(classification)\n\n    # Print the final result in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver\nsolve()\n```", "id": "2473618"}]}