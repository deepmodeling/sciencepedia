{"hands_on_practices": [{"introduction": "物理学中的统计热力学为我们提供了一个强大的定量框架，用以理解和预测基因表达。本练习将指导您从第一性原理出发，推导简单阻遏结构中的基因表达倍数变化（fold-change）的经典表达式。通过这项实践，您将掌握一个基础的定量工具，用以分析阻遏蛋白如何通过与RNA聚合酶（RNAP）竞争启动子结合位点来调控转录水平 [@problem_id:2540934]。", "problem": "一个广泛使用的细菌转录统计热力学模型假设，转录产出与核糖核酸聚合酶（RNAP）结合到启动子的概率成正比。考虑一个处于简单抑制结构中的启动子，其中阻遏蛋白和 RNAP 的结合是相互排斥的（空间位阻）。假设以下基本前提：(i) 启动子的各种状态与细胞内的蛋白质池处于准平衡状态；(ii) 中心法则确保了 RNAP 对启动子的占有率是稳态下转录起始速率的近似指标；(iii) 玻尔兹曼分布给出每个启动子状态的统计权重，其与 $\\exp(-\\beta \\Delta \\epsilon)$ 成正比，其中 $\\beta = 1/(k_B T)$，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，而 $\\Delta \\epsilon$ 是特异性与非特异性结合能之差。\n\n设启动子有三种允许的状态：空置、被 RNAP 结合或被阻遏蛋白结合，相互排斥性禁止 RNAP 和阻遏蛋白同时结合。RNAP 和阻遏蛋白结合的统计权重包含一个有效浓度因子，该因子由拷贝数除以非特异性脱氧核糖核酸（DNA）结合位点的数量给出。\n\n给定一个大肠杆菌（E. coli）细胞的以下细胞和生物物理参数：\n- RNAP 拷贝数 $P = 2000$，\n- 阻遏蛋白拷贝数 $R = 50$，\n- 非特异性 DNA 结合位点数 $N_{\\text{NS}} = 4.6 \\times 10^{6}$，\n- RNAP 特异性与非特异性结合能之差 $\\Delta \\epsilon_{p} = -5 \\, k_B T$，\n- 阻遏蛋白特异性与非特异性结合能之差 $\\Delta \\epsilon_{r} = -15 \\, k_B T$。\n\n从玻尔兹曼权重和上述平衡占有模型出发，首先推导表达倍数变化的通用表达式，其定义为存在阻遏蛋白时的 RNAP 占有率与不存在阻遏蛋白时的 RNAP 占有率之比。然后使用所提供的参数对该倍数变化进行数值计算。\n\n为了评估在此机制中哪种能量贡献在调控中占主导地位，定义无量纲权重\n$$w_p \\equiv \\frac{P}{N_{\\text{NS}}} \\exp\\!\\big(-\\beta \\Delta \\epsilon_p\\big), \\qquad w_r \\equiv \\frac{R}{N_{\\text{NS}}} \\exp\\!\\big(-\\beta \\Delta \\epsilon_r\\big),$$\n和主导性指标\n$$D \\equiv \\begin{cases}\n1, & \\text{if } w_r > \\max\\{1, w_p\\},\\\\\n0, & \\text{otherwise.}\n\\end{cases}$$\n\n将最终结果以一个行矩阵的形式报告，该矩阵按顺序包含两个条目：倍数变化（作为一个纯数）和主导性指标 $D$。将倍数变化四舍五入到 $4$ 位有效数字。在最终报告的值中不要包含任何单位。", "solution": "该问题要求基于一个统计热力学模型，推导和计算一个简单抑制结构中基因表达的倍数变化。该问题是适定的，并且科学上基于基因调控生物物理建模的既定原则。\n\n我们首先将该系统形式化。启动子可以存在于三种相互排斥的状态之一：\n$1$. 启动子是空的（未结合）。\n$2$. 启动子被一个核糖核酸聚合酶（RNAP）分子结合。\n$3$. 启动子被一个阻遏蛋白分子结合。\n\n根据题目，每个状态的统计权重与 $\\exp(-\\beta \\Delta \\epsilon)$ 成正比，其中 $\\beta = (k_B T)^{-1}$，$\\Delta \\epsilon$ 是蛋白质与其在脱氧核糖核酸（DNA）上的特异性位点的结合能相对于非特异性位点的结合能。这些权重还必须考虑分子的浓度。有效浓度由蛋白质的拷贝数除以细胞中非特异性结合位点的数量 $N_{\\text{NS}}$ 给出。\n\n让我们定义每个状态的统计权重：\n启动子的空置状态是参考态，因此其统计权重设为 $1$。\nRNAP 结合态的统计权重，我们记作 $w_p$，为：\n$$w_p = \\frac{P}{N_{\\text{NS}}} \\exp(-\\beta \\Delta \\epsilon_p)$$\n其中 $P$ 是 RNAP 的拷贝数，$\\Delta \\epsilon_p$ 是其特异性与非特异性结合能之差。\n\n阻遏蛋白结合态的统计权重，记作 $w_r$，为：\n$$w_r = \\frac{R}{N_{\\text{NS}}} \\exp(-\\beta \\Delta \\epsilon_r)$$\n其中 $R$ 是阻遏蛋白的拷贝数，$\\Delta \\epsilon_r$ 是其特异性与非特异性结合能之差。\n\n配分函数 $Z$ 是所有可能状态统计权重的总和，由下式给出：\n$$Z = 1 + w_p + w_r$$\n这个配分函数考虑了当 RNAP 和阻遏蛋白都存在时启动子的所有三种可能的构型。\n\n在任何特定状态下找到启动子的概率是该状态的统计权重除以配分函数。问题指出，转录产出与 RNAP 结合到启动子的概率 $p_{\\text{bound}}$ 成正比。因此，当存在阻遏蛋白时，这个概率是：\n$$p_{\\text{bound}}(R>0) = \\frac{w_p}{Z} = \\frac{w_p}{1 + w_p + w_r}$$\n\n为了计算倍数变化，我们还必须确定在没有阻遏蛋白的情况下的 RNAP 占有率。在这种情景下，阻遏蛋白拷贝数 $R = 0$，这意味着其统计权重 $w_r = 0$。系统只能处于空置或 RNAP 结合态。这个未受调控系统的配分函数 $Z_0$ 是：\n$$Z_0 = 1 + w_p$$\n那么，在没有阻遏蛋白的情况下 RNAP 的结合概率是：\n$$p_{\\text{bound}}(R=0) = \\frac{w_p}{Z_0} = \\frac{w_p}{1 + w_p}$$\n\n倍数变化 $FC$ 定义为存在阻遏蛋白时的 RNAP 占有率与不存在阻遏蛋白时的 RNAP 占有率之比：\n$$FC = \\frac{p_{\\text{bound}}(R>0)}{p_{\\text{bound}}(R=0)} = \\frac{\\frac{w_p}{1 + w_p + w_r}}{\\frac{w_p}{1 + w_p}}$$\n化简此表达式可得到倍数变化的通用公式：\n$$FC = \\frac{1 + w_p}{1 + w_p + w_r}$$\n这是推导出的倍数变化的解析表达式。\n\n接下来，我们使用所提供的参数对该表达式进行数值计算：\n- RNAP 拷贝数 $P = 2000$\n- 阻遏蛋白拷贝数 $R = 50$\n- 非特异性 DNA 结合位点数 $N_{\\text{NS}} = 4.6 \\times 10^{6}$\n- RNAP 结合能 $\\Delta \\epsilon_{p} = -5 \\, k_B T$，这意味着 $-\\beta \\Delta \\epsilon_{p} = 5$\n- 阻遏蛋白结合能 $\\Delta \\epsilon_{r} = -15 \\, k_B T$，这意味着 $-\\beta \\Delta \\epsilon_{r} = 15$\n\n首先，我们计算无量纲统计权重 $w_p$ 和 $w_r$：\n$$w_p = \\frac{2000}{4.6 \\times 10^6} \\exp\\left(5\\right) \\approx (4.3478 \\times 10^{-4}) \\times 148.413 \\approx 0.064525$$\n$$w_r = \\frac{50}{4.6 \\times 10^6} \\exp\\left(15\\right) \\approx (1.0870 \\times 10^{-5}) \\times (3.2690 \\times 10^6) \\approx 35.5328$$\n\n现在，我们将这些值代入倍数变化表达式中：\n$$FC = \\frac{1 + w_p}{1 + w_p + w_r} = \\frac{1 + 0.064525}{1 + 0.064525 + 35.5328} = \\frac{1.064525}{36.597325} \\approx 0.0290876$$\n四舍五入到 $4$ 位有效数字，倍数变化为 $0.02909$。\n\n最后，我们必须确定主导性指标 $D$：\n$$D \\equiv \\begin{cases} 1, & \\text{if } w_r > \\max\\{1, w_p\\},\\\\ 0, & \\text{otherwise.} \\end{cases}$$\n我们已经计算出 $w_p \\approx 0.0645$ 和 $w_r \\approx 35.53$。\n我们评估条件 $\\max\\{1, w_p\\}$：\n$$\\max\\{1, 0.0645\\} = 1$$\n$D=1$ 的条件变为 $w_r > 1$。\n因为 $w_r \\approx 35.53$，并且 $35.53 > 1$，所以该条件满足。\n因此，主导性指标 $D = 1$。这表明在此机制下，阻遏蛋白的结合贡献 ($w_r$) 是决定启动子状态的主导因素，其值大于空置状态的权重 ($1$) 和 RNAP 结合态的权重 ($w_p$)。\n\n最终结果由计算出的倍数变化和主导性指标组成。", "answer": "$$\\boxed{\\begin{pmatrix} 0.02909 & 1 \\end{pmatrix}}$$", "id": "2540934"}, {"introduction": "转录激活的效率通常依赖于激活蛋白与RNA聚合酶在DNA上的精确空间排布。本练习是一个思想实验，旨在深化您对DNA螺旋相位（helical phasing）重要性的理解。您需要预测，将一个CRP结合位点在DNA上游移动5个碱基对（约半个螺旋周期），对两种不同类型的启动子（Class I 和 Class II）会产生怎样截然不同的影响 [@problem_id:2540954]。", "problem": "一个大肠杆菌 (Escherichia coli) 启动子被环磷酸腺苷受体蛋白 (CRP；也称为分解代谢物激活蛋白) 激活。考虑两种启动子结构：I类CRP依赖性启动子，其CRP位点中心位于转录起始位点上游的$-61.5$位置；以及II类CRP依赖性启动子，其CRP位点中心位于$-41.5$位置。在I类中，已知激活主要通过CRP激活区$1$ (AR$1$) 与RNA聚合酶α亚基的C端结构域 (RNAP $\\alpha$-CTD) 之间的相互作用发生。在II类中，激活涉及多个接触点，特别是CRP AR$1$–RNAP $\\alpha$-CTD、CRP AR$2$–RNAP α亚基的N端结构域 (RNAP $\\alpha$-NTD)，以及与启动子$-35$元件结合的CRP AR$3$–σ因子区域$4$ ($\\sigma^{70}$ 区域$4$)。假设环磷酸腺苷 (cAMP) 的浓度是饱和的，CRP对其位点的占有率很高，并且其他启动子元件保持不变。\n\n您通过实验将两个启动子中的CRP结合位点向上游移动$5$个碱基对 (bp)，保留了位点序列以及与相邻启动子元件的间距，唯一的改变是这$5$ bp的上游位移。脱氧核糖核酸 (DNA) 是一个右旋螺旋，其平均螺旋周期约为每圈$10.5$ bp，对应于每个bp约$34.3^{\\circ}$的旋转前进，以及每个bp约$0.34$ nm的螺旋上升高度。\n\n仅根据这些公认的物理和分子特征（螺旋相位以及CRP在I类与II类启动子中已知的蛋白质-蛋白质接触），预测这$5$ bp上游位移对每类启动子中转录激活的定性影响。选择唯一的最佳选项。\n\nA. I类激活将显著减弱但不会被完全消除，因为AR$1$–RNAP $\\alpha$-CTD的接触变得相位错误，但$\\alpha$-CTD的柔性使其部分容忍这种错位；II类激活的减弱会更严重，通常接近完全消除，因为AR$3$–$\\sigma^{70}$区域$4$的接触（以及AR$2$–$\\alpha$-NTD的几何构型）因旋转错位和轴向间距增加而同时被破坏。\n\nB. I类激活将保持不变，因为RNAP $\\alpha$-CTD可以重新定位以维持与AR$1$的接触；II类激活将仅显示轻微下降，因为CRP的接触点具有冗余性。\n\nC. I类激活将会增强，因为在移动后的位置上，AR$1$与RNAP $\\alpha$-CTD的排列得到改善；II类激活将保持不变，因为在II类启动子中，CRP主要与DNA接触，而非RNAP。\n\nD. I类和II类的激活都将保持不变，因为$5$ bp的位移使CRP回到DNA的同一侧，并保留了所有蛋白质-蛋白质接触；任何螺旋相位效应都需要$10$ bp的位移。", "solution": "必须首先验证问题陈述的有效性。\n\n### 步骤1：提取已知条件\n-   **系统：** *大肠杆菌 (Escherichia coli)* 的转录激活。\n-   **激活蛋白：** 环磷酸腺苷受体蛋白 (CRP)。\n-   **I类启动子：** CRP结合位点中心位于$-61.5$位置。激活机制主要通过CRP激活区$1$ (AR$1$) 与RNA聚合酶α亚基C端结构域 (RNAP $\\alpha$-CTD) 的相互作用。\n-   **II类启动子：** CRP结合位点中心位于$-41.5$位置。激活涉及多个接触点：CRP AR$1$–RNAP $\\alpha$-CTD、CRP AR$2$–RNAP α亚基N端结构域 (RNAP $\\alpha$-NTD)，以及CRP AR$3$–$\\sigma^{70}$因子区域$4$。\n-   **假设：** cAMP浓度饱和，CRP占有率高，其他启动子元件不变。\n-   **扰动：** CRP结合位点向上游移动$5$个碱基对 (bp)。\n-   **DNA特性：** 右旋螺旋，螺旋周期约为$10.5$ bp/圈，每个bp旋转前进约$34.3^{\\circ}$，每个bp螺旋上升高度约$0.34$ nm。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，描述了细菌基因调控中公认的机制。所提供的I类和II类启动子的位置（$-61.5$和$-41.5$）是经典位置。所述的蛋白质-蛋白质相互作用（AR$1$–$\\alpha$-CTD等）是标准的教科书知识。DNA的物理特性陈述正确。实验设置（移动结合位点）是分子遗传学中的标准技术。该问题表述清晰、客观，并包含足够的信息来推导出逻辑结论。它没有违反任何有效性标准。\n\n### 结论与行动\n该问题有效。将推导解答。\n\n### 推导过程\n\n分析的关键在于理解沿着DNA螺旋移动蛋白质结合位点所带来的几何后果。关键参数是旋转角度的变化（螺旋相位）和相互作用蛋白之间轴向距离的变化。\n\n$\\Delta L = 5$ bp的位移会产生以下后果：\n1.  **旋转变化 ($\\Delta\\theta$)：** DNA螺旋每隔一个碱基对旋转约$34.3^{\\circ}$。$5$ bp的位移导致总旋转为：\n    $$ \\Delta\\theta = 5 \\text{ bp} \\times 34.3^{\\circ}/\\text{bp} = 171.5^{\\circ} $$\n    这个旋转角度非常接近$180^{\\circ}$，这意味着CRP蛋白当结合到新位点时，将位于DNA螺旋的与原位置相对的另一侧。一个完整的螺旋圈（约$10.5$ bp）会恢复原始的旋转方向。$5$ bp的位移大约对应半个螺旋圈（$5/10.5 \\approx 0.476$），导致最大程度的旋转错位。\n\n2.  **轴向距离变化 ($\\Delta z$)：** DNA螺旋每个碱基对的上升高度约为$0.34$ nm。向上游移动$5$ bp会使CRP与RNAP全酶之间的轴向距离增加：\n    $$ \\Delta z = 5 \\text{ bp} \\times 0.34 \\text{ nm/bp} = 1.7 \\text{ nm} $$\n\n现在，我们必须将这些几何变化应用于每一种启动子类型。\n\n**I类启动子分析：**\n-   **原始状态：** 在$-61.5$位置，CRP的位置最适合其激活区$1$ (AR$1$) 与RNAP $\\alpha$-CTD接触。这种相互作用是通过连接$\\alpha$-CTD与RNAP核心酶的一条长的、柔性的多肽连接子来介导的。这种柔性使得$\\alpha$-CTD能够在一定距离范围内，以及在较小程度上，在一定旋转相位范围内，寻找并结合上游的激活子。\n-   **位移的影响：** CRP位点移动到$-61.5 - 5 = -66.5$。现在，CRP分子呈现在DNA螺旋的另一面（$\\Delta\\theta \\approx 180^{\\circ}$），并且距离启动子远了$1.7$ nm。严重的旋转错位将破坏AR$1$–$\\alpha$-CTD的相互作用。然而，$\\alpha$-CTD连接子固有的柔性可能使其能够在一定程度上“环绕”DNA，从而建立次优的接触。这意味着相互作用被显著削弱，导致转录激活大幅降低，但可能不会完全被消除。这种柔性提供了一定程度的对相位变化的容忍度，而这种容忍度在更刚性的相互作用中是不存在的。\n\n**II类启动子分析：**\n-   **原始状态：** 在$-41.5$位置，CRP紧邻核心启动子，并与RNAP全酶形成多个结构精确的接触。这些接触包括：\n    -   AR$1$–$\\alpha$-CTD。\n    -   AR$2$–$\\alpha$-NTD（RNAP刚性结构核心内的一个结构域）。\n    -   AR$3$–$\\sigma^{70}$区域$4$（对于稳定$\\sigma$因子与$-35$启动子元件的相互作用至关重要）。\n    后两个接触（AR$2$和AR$3$）已知具有立体特异性，并依赖于CRP和RNAP之间固定的几何排列。\n-   **位移的影响：** CRP位点移动到$-41.5 - 5 = -46.5$。这同时引入了约$180^{\\circ}$的旋转错位和$1.7$ nm的轴向距离增加。对于像AR$2$–$\\alpha$-NTD和AR$3$–$\\sigma^{70}$这样刚性的、立体特异性的蛋白质-蛋白质相互作用，这种巨大的几何扰动是灾难性的。CRP上相关的激活区域现在将面向远离其在RNAP上的结合伙伴，并且增加的距离进一步阻止了任何接触。与I类情况不同，没有长的柔性连接子来补偿如此剧烈的变化。所有关键的激活接触都同时被破坏。\n-   **结论：** 对II类启动子的影响将是激活的大幅减弱，很可能接近完全消除。\n\n**预测总结：**\n-   **I类：** 由于旋转错相，激活被大幅减弱，但由于柔性的$\\alpha$-CTD连接子提供的部分容忍性而未被消除。\n-   **II类：** 激活被非常严重地减弱，很可能接近消除，因为刚性的、立体特异性的接触（AR$2$、AR$3$）无法容忍旋转相位和轴向距离上的巨大破坏。\n\n### 逐选项分析\n\n**A. I类激活将显著减弱但不会被完全消除，因为AR$1$–RNAP $\\alpha$-CTD的接触变得相位错误，但$\\alpha$-CTD的柔性使其部分容忍这种错位；II类激活的减弱会更严重，通常接近完全消除，因为AR$3$–$\\sigma^{70}$区域$4$的接触（以及AR$2$–$\\alpha$-NTD的几何构型）因旋转错位和轴向间距增加而同时被破坏。**\n这个选项正确地指出了$5$ bp的位移导致旋转错相。它准确地描述了对I类激活的影响：由于$\\alpha$-CTD连接子的柔性，强烈的减弱效应被缓解，从而避免了完全消除。它还正确地预测了对II类激活的更严重、接近消除的影响，并将其归因于旋转和距离共同破坏了刚性接触（AR$3$–$\\sigma^{70}$ 以及隐含的 AR$2$–$\\alpha$-NTD）。这与推导过程完全一致。\n**结论：正确。**\n\n**B. I类激活将保持不变，因为RNAP $\\alpha$-CTD可以重新定位以维持与AR$1$的接触；II类激活将仅显示轻微下降，因为CRP的接触点具有冗余性。**\n该选项高估了$\\alpha$-CTD连接子的补偿能力。约$180^{\\circ}$的相位偏移是一个主要的能量障碍，激活不会保持不变。对于II类，它误解了冗余的含义；当一个几何位移同时破坏所有接触点时，冗余没有任何好处。激活的下降将是严重的，而不是轻微的。\n**结论：错误。**\n\n**C. I类激活将会增强，因为在移动后的位置上，AR$1$与RNAP $\\alpha$-CTD的排列得到改善；II类激活将保持不变，因为在II类启动子中，CRP主要与DNA接触，而非RNAP。**\n已知$-61.5$的初始位置是为激活而正确相位的。将CRP移动到DNA的另一面会恶化而非改善排列。关于II类的说法在事实上是错误的；II类激活的定义就是CRP与RNAP之间多个必要的蛋白质-蛋白质接触。\n**结论：错误。**\n\n**D. I类和II类的激活都将保持不变，因为$5$ bp的位移使CRP回到DNA的同一侧，并保留了所有蛋白质-蛋白质接触；任何螺旋相位效应都需要$10$ bp的位移。**\n该选项基于对DNA螺旋结构的一个根本性错误理解。$5$ bp的位移大约是半个螺旋圈，将蛋白质移动到DNA的*另一*侧。约$10.5$ bp的位移，而不是$5$ bp的位移，才会恢复同侧方向。该选项的前提在事实上是错误的。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2540954"}, {"introduction": "理论模型只有在能够解释实验数据时才具有真正的预测能力。这项实践将带您体验从原始测量数据中提取生物物理洞见的过程。您将使用希尔（Hill）方程这一现象学模型来拟合模拟的启动子活性数据，并从拟合得到的希尔系数$n$中推断出转录因子协同性的潜在机制 [@problem_id:2540956]。", "problem": "您将获得四个独立的稳态数据集，这些数据集测量了一个细菌启动子的激活情况，该启动子的转录激活需要环磷酸腺苷（cAMP）受体蛋白（CRP）。其机理基础是，在细菌中，诸如环磷酸腺苷（cAMP）的信号分子与诸如环磷酸腺苷（cAMP）受体蛋白（CRP）的转录因子结合，从而改变它们结合脱氧核糖核酸（DNA）和招募核糖核酸聚合酶（RNAP）的能力。在稳态和快速结合平衡的条件下，启动子输出可以被建模为与启动子结合的、具有转录能力的CRP所占比例的单调函数。针对这种单调、饱和响应，一种广泛使用的唯象形式是S型函数，其陡峭程度由一个无量纲形状参数控制，该参数通常被解释为希尔系数。您的任务是为每个数据集拟合这样一个S型希尔函数，然后根据CRP二聚体的生物物理学来解释拟合出的希尔系数。\n\n对于每个数据集，您必须：\n- 拟合一个从cAMP浓度到启动子活性的希尔型输入-输出映射，该映射包含四个自由参数：基线活性$b$、振幅$A$（因此最大活性为$b + A$）、有效中点浓度$K$（单位为$\\mu$M）和一个希尔系数$n$（无量纲）。\n- 根据拟合出的$n$值，推断观测到的协同性是否可以仅由CRP二聚体相关的两个cAMP结合事件来解释，或者是否需要额外的协同性（例如，协同性DNA结合或协同性招募核糖核酸聚合酶（RNAP）），或者与强协同性双位点模型相比，该系统是否表现出次协同行为。\n- 使用以下带有明确数值阈值的解释规则：如果$n \\in [\\,1.75,\\,2.25\\,]$，报告代码$0$（与CRP二聚体中无额外协同性的两个cAMP结合事件一致）；如果$n > 2.25$，报告代码$1$（超协同性，表明除了两个cAMP位点外还存在额外的协同性）；如果$n < 1.75$，报告代码$-1$（次协同性，表明协同性降低或存在异质性群体）。\n\n输入数据和单位：\n- 对于每个数据集，cAMP浓度（单位为$\\mu$M）均相同，由列表$[\\;0.05,\\;0.1,\\;0.3,\\;1.0,\\;3.0,\\;10.0,\\;30.0,\\;100.0,\\;300.0\\;]$给出。\n- 每个数据集测得的启动子活性（无量纲，已经归一化）如下：\n  - 数据集$1$（具有典型双位点协同性的CRP依赖型启动子）：\n    $[\\;0.020024,\\;0.020098,\\;0.020881,\\;0.029703,\\;0.100917,\\;0.510000,\\;0.902000,\\;0.990297,\\;0.998911\\;]$。\n  - 数据集$2$（更陡峭的转变，与额外的协同性一致）：\n    $[\\;0.020000,\\;0.020000,\\;0.020000,\\;0.020027,\\;0.021279,\\;0.099813,\\;0.808900,\\;0.996506,\\;0.999925\\;]$。\n  - 数据集$3$（更平缓的转变，与协同性降低一致）：\n    $[\\;0.104969,\\;0.109877,\\;0.128916,\\;0.188889,\\;0.318182,\\;0.544444,\\;0.731579,\\;0.840741,\\;0.879221\\;]$。\n  - 数据集$4$（极低的中点，在低cAMP浓度下急剧上升，其他方面类似于双位点）：\n    $[\\;0.009901,\\;0.038462,\\;0.264706,\\;0.800000,\\;0.972973,\\;0.997506,\\;0.999722,\\;0.999975,\\;0.999997\\;]$。\n\n需要实现的任务：\n- 对于每个数据集，对提供的$(x,y)$数据对执行希尔型响应的非线性最小二乘拟合，其中自由参数为$b$、$A$、$K$和$n$，$x$是cAMP浓度（单位为$\\mu$M），$y$是启动子活性（无量纲）。所有拟合参数必须被约束在具有物理意义的范围内：$b \\ge 0$, $A \\ge 0$, $K > 0$ 和 $n > 0$。\n- 从拟合参数中，提取希尔系数$n$，并使用上述规则将其分类为代码$-1$、$0$或$1$。\n\n测试套件和要求的输出：\n- 使用上述四个数据集和共享的浓度列表作为完整的测试套件。\n- 对于每个数据集$i \\in \\{1,2,3,4\\}$，输出一个二元列表$[\\,\\hat{n}_i,\\;c_i\\,]$，其中$\\hat{n}_i$是四舍五入到三位小数的拟合希尔系数（无量纲），$c_i \\in \\{-1,0,1\\}$是上面定义的解释代码。\n- 您的程序应生成单行输出，其中包含四个数据集的结果，格式为一个由逗号分隔的二元列表组成的列表，并用一对单独的方括号括起来，不含空格。例如，格式必须严格为 \"[[n1,code1],[n2,code2],[n3,code3],[n4,code4]]\" 的形式，其中每个$n_i$打印时保留三位小数。具体地，将此要求的字符串抽象地表示为 \"[[$n_{1}$,$c_{1}$],[$n_{2}$,$c_{2}$],[$n_{3}$,$c_{3}$],[$n_{4}$,$c_{4}$]]\"。\n\n角度和单位约定：\n- 所有cAMP浓度$x$的单位均为$\\mu$M，所有启动子活性$y$均为无量纲。\n- 希尔系数$n$是无量纲的，并且必须报告到三位小数。", "solution": "该问题陈述经过验证，被认为是具有科学依据、定义明确且客观的。它提出了定量生物物理学中的一个标准任务：使用唯象模型来表征生物分子系统的输入-输出响应。所提供的数据是一致的，足以完成该任务。因此，该问题被认为是有效的，并且解决方案是可行的。\n\n此问题的核心是为一个启动子对不同浓度的效应分子——环磷酸腺苷（cAMP）的稳态转录响应进行建模。该响应被假定遵循S型剂量反应曲线，这是涉及协同结合的系统的共同特征。希尔方程是描述此类现象的经典数学模型。将输入浓度$x$（cAMP浓度）与输出$y$（启动子活性）相关联的四参数希尔函数由下式给出：\n$$ y(x; b, A, K, n) = b + A \\frac{x^n}{K^n + x^n} $$\n在此方程中：\n- $b$代表在没有配体（$x \\to 0$）时，基础或背景的启动子活性。\n- $A$代表响应的振幅，使得在饱和配体浓度（$x \\to \\infty$）时，最大活性为$b+A$。\n- $K$是有效中点浓度，在该浓度下，活性处于最小值和最大值之间的一半，即$y(K) = b + A/2$。它通常被解释为有效解离常数。\n- $n$是希尔系数，一个量化响应曲线陡峭程度的无量纲参数。它作为协同性的度量。\n\n参数$\\{b, A, K, n\\}$的值是未知的，必须为四个数据集中的每一个确定。这通过将模型拟合到实验数据来实现。所选择的方法是非线性最小二乘回归。这涉及找到一组参数，以最小化残差平方和$\\chi^2$，即在所有$N$个数据点上，测量的启动子活性$y_{i, \\text{data}}$与模型预测的活性$y(x_i; b, A, K, n)$之间的差异：\n$$ \\chi^2(b, A, K, n) = \\sum_{i=1}^{N} [y_{i, \\text{data}} - y(x_i; b, A, K, n)]^2 $$\n这个最小化过程是一个数值优化问题。我们必须通过施加约束来尊重参数的物理意义：$b \\ge 0$, $A \\ge 0$, $K > 0$ 和 $n > 0$。这些约束在优化算法中作为边界来实现。\n\n核心的生物物理解释依赖于拟合出的希尔系数$\\hat{n}$的值。所讨论的转录因子CRP是一个二聚体，每个单体都有一个cAMP的结合位点。一个简化的配体与多位点蛋白质结合的模型预测，理论最大希尔系数等于结合位点的数量，在强协同性的假设下，对于CRP二聚体来说，即为$n=2$。因此，将经验希尔系数$\\hat{n}$的值与此理论值进行比较。\n- 如果发现$\\hat{n}$在$[\\,1.75,\\,2.25\\,]$的范围内（代码$0$），则观察到的协同性与CRP二聚体上两个协同cAMP结合事件的标准模型一致。\n- 如果$\\hat{n} > 2.25$（代码$1$），则系统表现出超协同性。这意味着可能存在额外的协同相互作用，例如多个CRP-cAMP复合物与DNA的协同结合。\n- 如果$\\hat{n} < 1.75$（代码$-1$），则系统是次协同的。这可能是由结合位点之间的负协同性、测量伪影或被测分子群体的异质性引起的。\n\n该实现将利用`scipy.optimize.curve_fit`函数，该函数非常适合此类回归分析。对于四个数据集中的每一个，我们将：\n1. 提供实验数据$(x_i, y_i)$。\n2. 对希尔方程进行有界非线性最小二乘拟合，以找到最优参数$(\\hat{b}, \\hat{A}, \\hat{K}, \\hat{n})$。\n3. 提取拟合的希尔系数$\\hat{n}$。\n4. 应用指定的分类规则，确定协同性代码$c \\in \\{-1, 0, 1\\}$。\n5. 将结果（包括四舍五入的$\\hat{n}$及其对应的代码$c$）格式化为指定的列表结构，用于最终输出。\n对所有四个数据集重复此过程以完成分析。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Fits a Hill-type function to four datasets of promoter activity vs. cAMP concentration,\n    and interprets the resulting Hill coefficient.\n    \"\"\"\n\n    # Define the 4-parameter Hill function for fitting.\n    # x: concentration\n    # b: baseline\n    # A: amplitude\n    # K: midpoint concentration\n    # n: Hill coefficient\n    def hill_function(x, b, A, K, n):\n        # A numerically stable implementation of the Hill equation.\n        # This prevents potential overflow/underflow issues with large x or n.\n        return b + A * np.power(x, n) / (np.power(K, n) + np.power(x, n))\n\n    # Shared cAMP concentrations for all datasets, in microMolar.\n    x_concentrations = np.array([0.05, 0.1, 0.3, 1.0, 3.0, 10.0, 30.0, 100.0, 300.0])\n\n    # The four datasets of promoter activity (dimensionless).\n    # These will be the test cases for the fitting procedure.\n    test_cases = [\n        # Dataset 1: Typical two-site cooperativity\n        np.array([0.020024, 0.020098, 0.020881, 0.029703, 0.100917, 0.510000, 0.902000, 0.990297, 0.998911]),\n        # Dataset 2: Supercooperative\n        np.array([0.020000, 0.020000, 0.020000, 0.020027, 0.021279, 0.099813, 0.808900, 0.996506, 0.999925]),\n        # Dataset 3: Subcooperative\n        np.array([0.104969, 0.109877, 0.128916, 0.188889, 0.318182, 0.544444, 0.731579, 0.840741, 0.879221]),\n        # Dataset 4: Low midpoint, two-site-like\n        np.array([0.009901, 0.038462, 0.264706, 0.800000, 0.972973, 0.997506, 0.999722, 0.999975, 0.999997]),\n    ]\n\n    # A list to store the final string-formatted results for each dataset.\n    results = []\n\n    # Process each dataset.\n    for y_data in test_cases:\n        # Provide reasonable initial guesses for the parameters [b, A, K, n].\n        # These are robust guesses that work well for all provided datasets.\n        p0 = [0.01, 1.0, 5.0, 2.0]\n\n        # Define bounds for the parameters to ensure physical meaning:\n        # b >= 0, A >= 0, K > 0, n > 0.\n        # We also set practical upper bounds to aid convergence.\n        bounds = ([0, 0, 1e-9, 1e-9], [1.0, 2.0, 1000.0, 15.0])\n\n        # Perform the nonlinear least-squares fit.\n        # The 'trf' method is default for bounded problems and is robust.\n        p_opt, _ = curve_fit(hill_function, x_concentrations, y_data, p0=p0, bounds=bounds, maxfev=10000)\n\n        # Extract the fitted Hill coefficient.\n        n_fit = p_opt[3]\n\n        # Classify the Hill coefficient based on the provided rules.\n        if 1.75 <= n_fit <= 2.25:\n            code = 0  # Consistent with two-site cooperativity\n        elif n_fit > 2.25:\n            code = 1  # Supercooperative\n        else:  # n_fit < 1.75\n            code = -1 # Subcooperative\n\n        # Format the result as a string '[n,c]' and add to the list.\n        # n is rounded to three decimal places.\n        results.append(f\"[{n_fit:.3f},{code}]\")\n\n    # Print the final output in the exact required format: [[n1,c1],[n2,c2],...]\n    print(f\"[[{','.join(results)}]]\")\n\n# Execute the solution.\nsolve()\n```", "id": "2540956"}]}