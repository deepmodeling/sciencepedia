{"hands_on_practices": [{"introduction": "三羧酸循环（TCA cycle）中的一个关键步骤，即苹果酸脱氢酶催化的反应，其标准吉布斯自由能变（$\\Delta G^{\\circ \\prime}$）是很大的正值，这在热力学上是极其不利的。那么，这个循环在细胞内是如何顺利进行的呢？这项练习将通过计算特定细胞内浓度下的实际吉布斯自由能变（$\\Delta G^{\\prime}$），来揭示标准条件与真实细胞环境之间的差异，从而帮助您理解质量作用定律如何驱动看似不利的反应向前进行。[@problem_id:2540293]", "problem": "在一个处于稳态的生长中的革兰氏阴性菌中，三羧酸循环依赖苹果酸脱氢酶根据以下生物化学标准态反应来实现苹果酸和草酰乙酸的相互转化：\n$$\\text{L-malate} + \\text{NAD}^{+} \\rightleftharpoons \\text{oxaloacetate} + \\text{NADH} + \\text{H}^{+}.$$\n假设在 $T=310\\ \\mathrm{K}$ 和 $\\text{pH}=7.0$ 的条件下，生物化学标准转换吉布斯自由能变为 $\\Delta G^{\\circ \\prime} = +29.7\\ \\mathrm{kJ\\,mol^{-1}}$，其中质子和水的活度被缓冲，因此不包括在转换反应商中。细胞内浓度为 $[\\text{malate}]=1\\ \\mathrm{mM}$、$[\\text{oxaloacetate}]=10\\ \\mu\\mathrm{M}$ 以及 $[\\text{NAD}^{+}]/[\\text{NADH}]=10$。假设体系为理想行为，因此活度等于摩尔浓度。使用普适气体常数 $R=8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n从生物化学标准条件下理想稀溶液的化学势和反应吉布斯自由能的热力学定义出发，推导出适用于此反应的转换反应商，并计算在所述细胞内浓度下的实际转换吉布斯自由能变 $\\Delta G^{\\prime}$。然后，仅根据 $\\Delta G^{\\prime}$ 的符号，指出在这些条件下哪个反应方向是热力学上有利的。\n\n将 $\\Delta G^{\\prime}$ 的最终数值以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示，并四舍五入至 3 位有效数字。", "solution": "所述问题在科学上是合理的，提法恰当，并包含得出唯一解所需的所有信息。这是热力学原理在生物化学系统中的一个标准应用。因此，我们将进行推导和计算。\n\n实际转换吉布斯自由能变 $\\Delta G^{\\prime}$ 与生物化学标准转换吉布斯自由能变 $\\Delta G^{\\circ \\prime}$ 之间的基本关系由以下方程给出：\n$$\n\\Delta G^{\\prime} = \\Delta G^{\\circ \\prime} + RT \\ln Q^{\\prime}\n$$\n其中 $R$ 是普适气体常数，$T$ 是绝对温度，$Q^{\\prime}$ 是转换反应商。\n\n所考虑的反应是由苹果酸脱氢酶催化的 L-苹果酸和草酰乙酸的相互转化：\n$$\n\\text{L-malate} + \\text{NAD}^{+} \\rightleftharpoons \\text{oxaloacetate} + \\text{NADH} + \\text{H}^{+}\n$$\n问题指明，在生物化学标准条件下，水和质子的活度被认为是常数且等于 $1$。因此，在转换反应商 $Q^{\\prime}$ 的表达式中，它们被省略。假设体系为理想行为，活度等于摩尔浓度，则 $Q^{\\prime}$ 的表达式为：\n$$\nQ^{\\prime} = \\frac{[\\text{oxaloacetate}][\\text{NADH}]}{[\\text{L-malate}][\\text{NAD}^{+}]}\n$$\n这个表达式可以方便地重排，以利用给定的浓度比：\n$$\nQ^{\\prime} = \\frac{[\\text{oxaloacetate}]}{[\\text{L-malate}]} \\times \\left( \\frac{[\\text{NADH}]}{[\\text{NAD}^{+}]} \\right)\n$$\n我们已知以下细胞内条件：\n$[\\text{L-malate}] = 1\\ \\mathrm{mM} = 1 \\times 10^{-3}\\ \\mathrm{M}$\n$[\\text{oxaloacetate}] = 10\\ \\mu\\mathrm{M} = 1 \\times 10^{-5}\\ \\mathrm{M}$\n比例 $[\\text{NAD}^{+}]/[\\text{NADH}] = 10$，这意味着 $[\\text{NADH}]/[\\text{NAD}^{+}] = \\frac{1}{10} = 0.1$。\n\n将这些值代入 $Q^{\\prime}$ 的表达式中：\n$$\nQ^{\\prime} = \\frac{1 \\times 10^{-5}\\ \\mathrm{M}}{1 \\times 10^{-3}\\ \\mathrm{M}} \\times \\frac{1}{10} = (1 \\times 10^{-2}) \\times (1 \\times 10^{-1}) = 1 \\times 10^{-3}\n$$\n反应商 $Q^{\\prime}$ 是一个无量纲量，正如预期。\n\n现在，我们计算实际转换吉布斯自由能变 $\\Delta G^{\\prime}$。给定的参数如下：\n$\\Delta G^{\\circ \\prime} = +29.7\\ \\mathrm{kJ\\,mol^{-1}} = +29700\\ \\mathrm{J\\,mol^{-1}}$\n$R = 8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n$T = 310\\ \\mathrm{K}$\n\n将这些值代入主方程中：\n$$\n\\Delta G^{\\prime} = 29700\\ \\mathrm{J\\,mol^{-1}} + (8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}})(310\\ \\mathrm{K}) \\ln(1 \\times 10^{-3})\n$$\n首先，我们计算 $RT$ 项：\n$$\nRT = (8.314\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}})(310\\ \\mathrm{K}) = 2577.34\\ \\mathrm{J\\,mol^{-1}}\n$$\n接下来，我们计算 $Q^{\\prime}$ 的自然对数：\n$$\n\\ln(1 \\times 10^{-3}) \\approx -6.907755\n$$\n现在，我们可以计算 $RT \\ln Q^{\\prime}$ 项：\n$$\nRT \\ln Q^{\\prime} \\approx (2577.34\\ \\mathrm{J\\,mol^{-1}})(-6.907755) \\approx -17804.5\\ \\mathrm{J\\,mol^{-1}}\n$$\n最后，我们计算 $\\Delta G^{\\prime}$：\n$$\n\\Delta G^{\\prime} \\approx 29700\\ \\mathrm{J\\,mol^{-1}} - 17804.5\\ \\mathrm{J\\,mol^{-1}} = 11895.5\\ \\mathrm{J\\,mol^{-1}}\n$$\n问题要求答案以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位，并四舍五入至 3 位有效数字。\n$$\n\\Delta G^{\\prime} = 11.8955\\ \\mathrm{kJ\\,mol^{-1}} \\approx 11.9\\ \\mathrm{kJ\\,mol^{-1}}\n$$\n在指定条件下，实际转换吉布斯自由能变 $\\Delta G^{\\prime}$ 的符号决定了反应的热力学有利方向。\n- 如果 $\\Delta G^{\\prime} < 0$，则正反应是自发的。\n- 如果 $\\Delta G^{\\prime} > 0$，则逆反应是自发的。\n- 如果 $\\Delta G^{\\prime} = 0$，则反应处于平衡状态。\n\n在本例中，$\\Delta G^{\\prime} = +11.9\\ \\mathrm{kJ\\,mol^{-1}}$，这是一个正值。因此，在所述细胞内浓度下，正向反应（苹果酸转化为草酰乙酸）不是自发的。逆反应，即草酰乙酸和 NADH 转化为 L-苹果酸和 NAD$^{+}$，是热力学上有利的方向。\n$$\n\\text{oxaloacetate} + \\text{NADH} + \\text{H}^{+} \\longrightarrow \\text{L-malate} + \\text{NAD}^{+}\n$$\n这一结果与已知的三羧酸循环代谢背景相符，在体内，苹果酸脱氢酶反应的高正值 $\\Delta G^{\\circ \\prime}$ 是通过其产物草酰乙酸的极低浓度来克服的，而草酰乙酸会被后续的酶，即柠檬酸合酶，迅速消耗。然而，仅根据给定的数值，逆反应是更有利的。", "answer": "$$\n\\boxed{11.9}\n$$", "id": "2540293"}, {"introduction": "三羧酸循环不仅是一个能量产生的工厂，它还是一个关键的代谢枢纽，为氨基酸、核苷酸等重要分子的合成提供前体物质。这种双重功能（分解代谢和合成代谢）被称为“两性”（amphibolic）性质。这项练习将引导您运用质量守恒的基本原理，计算在特定生物合成需求下，维持循环稳态所需的最小“补给”（anaplerotic）通量，从而深化您对循环动态平衡及其在细胞生长中核心作用的理解。[@problem_id:2540363]", "problem": "一种快速生长的细菌运行氧化型三羧酸（TCA）循环，该循环不存在乙醛酸循环支路，也没有任何净还原性TCA通量。三羧酸（TCA）循环的中间产物——草酰乙酸（OAA）、柠檬酸、异柠檬酸、α-酮戊二酸、琥珀酰辅酶A（succinyl-CoA）、琥珀酸、延胡索酸和苹果酸——形成一个单一的循环途径。在该途径中，每个内部步骤精确消耗一个中间产物并精确生成一个中间产物（二氧化碳不是TCA中间产物）。该循环唯一的输入是通过柠檬酸合酶输入的乙酰辅酶A（acetyl-CoA），以及一个通过丙酮酸羧化酶将丙酮酸羧化为草酰乙酸的补给反应，其通量为 $v_{\\mathrm{anap}}$。细胞从该循环中分流碳源以支持氨基酸的生物合成，具体如下：\n- 天冬氨酸家族的氨基酸由草酰乙酸生成，其净流出通量为 $J_{\\mathrm{Asp}} = 5.8$ mmol gDW$^{-1}$ h$^{-1}$，其中 gDW 表示克干重。\n- 谷氨酸家族的氨基酸由α-酮戊二酸生成，其净流出通量为 $J_{\\mathrm{Glu}} = 7.7$ mmol gDW$^{-1}$ h$^{-1}$。\n\n假设：\n- 不存在其他TCA中间产物的流出或输入。\n- 所有TCA中间产物的浓度均处于稳态（无净积累）。\n- 乙酰辅酶A的流入不会净生成草酰乙酸；它仅维持循环的周转。\n- 除了指定的流出以及向草酰乙酸的补给输入外，在经典循环之外不存在TCA中间产物之间的净转化。\n\n从每个中间产物在稳态下的质量守恒原理，以及循环内部反应在中间产物分子数量上是一一对应的这一事实出发，请从第一性原理推导出在这些流出条件下维持TCA中间产物池稳态所需的最小补给通量 $v_{\\mathrm{anap,min}}$，并根据给定的数值报告其数值。将答案四舍五入至四位有效数字，并以 mmol gDW$^{-1}$ h$^{-1}$ 为单位表示。", "solution": "问题要求在给定特定的生物合成流出条件下，确定维持三羧酸（TCA）循环中间产物稳态所必需的最小补给通量，记为 $v_{\\mathrm{anap,min}}$。该分析将基于质量守恒基本原理。\n\n所考虑的系统是整个TCA循环中间产物池：草酰乙酸（OAA）、柠檬酸、异柠檬酸、α-酮戊二酸（$\\alpha$-KG）、琥珀酰辅酶A（succinyl-CoA）、琥珀酸、延胡索酸和苹果酸。问题陈述所有这些中间产物的浓度都处于稳态，这意味着这些中间产物的总生成速率必须等于其总消耗速率。\n我们可以将其表述为整个产物池的质量平衡方程。\n$$ \\frac{d}{dt} \\left( \\sum_{i \\in \\text{TCA intermediates}} [\\text{I}_i] \\right) = 0 $$\n该条件意味着，所有进入该池的流入通量之和必须等于所有从该池流出的通量之和。\n$$ \\sum J_{\\text{in}} = \\sum J_{\\text{out}} $$\n\n我们必须确定构成中间产物分子净生成（流入）和净消耗（流出）的通量。\n\n1.  **循环内部反应**：问题陈述“每个内部步骤精确消耗一个中间产物并精确生成一个中间产物”。例如，苹果酸转化为草酰乙酸消耗一个苹果酸分子并生成一个草酰乙酸分子。这些反应将一种中间产物转化为另一种，但不改变中间产物池中分子的总数。因此，它们对净流入或净流出没有贡献。\n\n2.  **乙酰辅酶A的输入**：由柠檬酸合酶催化的反应为：\n    $$ \\text{Acetyl-CoA} + \\text{Oxaloacetate} \\rightarrow \\text{Citrate} + \\text{CoA} $$\n    此反应消耗一个TCA中间产物（草酰乙酸）并生成一个TCA中间产物（柠檬酸）。问题正确地指出这“不会净生成草酰乙酸；它仅维持循环的周转”。因此，乙酰辅酶A的流入不代表中间产物分子池的净来源。\n\n3.  **补给输入**：丙酮酸羧化为草酰乙酸的补给反应是循环的一个输入。这个反应从非中间产物的丙酮酸生成一个TCA中间产物分子——草酰乙酸。因此，此通量 $v_{\\mathrm{anap}}$ 构成TCA中间产物池的净流入。\n\n4.  **生物合成流出**：问题指明了两个从循环中分流碳源用于生物合成的点。\n    -   通量 $J_{\\mathrm{Asp}}$ 从循环中移除了草酰乙酸。\n    -   通量 $J_{\\mathrm{Glu}}$ 从循环中移除了α-酮戊二酸。\n    这两个通量代表了从中间产物池中分子的净流出。\n\n基于此分析，整个TCA循环中间产物池在稳态下的质量平衡方程简化为：\n$$ \\text{Total Influx} = \\text{Total Efflux} $$\n$$ v_{\\mathrm{anap}} = J_{\\mathrm{Asp}} + J_{\\mathrm{Glu}} $$\n所需的最小通量 $v_{\\mathrm{anap,min}}$ 正是满足此稳态条件的通量。任何更低的通量都会导致中间产物池的净耗竭。因此：\n$$ v_{\\mathrm{anap,min}} = J_{\\mathrm{Asp}} + J_{\\mathrm{Glu}} $$\n\n为了更严谨地验证这一结果，我们可以写出分支点上各个中间产物的稳态质量平衡方程。设 $v_1$ 为循环中从柠檬酸合酶到异柠檬酸脱氢酶的通量，而 $v_2$ 为循环下半部分从α-酮戊二酸脱氢酶到苹果酸脱氢酶的通量。\n草酰乙酸（OAA）的平衡方程为：\n$$ \\frac{d[\\text{OAA}]}{dt} = v_2 + v_{\\mathrm{anap}} - v_1 - J_{\\mathrm{Asp}} = 0 $$\n$$ v_{\\mathrm{anap}} - J_{\\mathrm{Asp}} = v_1 - v_2 $$\nα-酮戊二酸（$\\alpha$-KG）的平衡方程为：\n$$ \\frac{d[\\alpha\\text{-KG}]}{dt} = v_1 - v_2 - J_{\\mathrm{Glu}} = 0 $$\n$$ v_1 - v_2 = J_{\\mathrm{Glu}} $$\n将第二个方程代入第一个方程，得到：\n$$ v_{\\mathrm{anap}} - J_{\\mathrm{Asp}} = J_{\\mathrm{Glu}} $$\n$$ v_{\\mathrm{anap}} = J_{\\mathrm{Asp}} + J_{\\mathrm{Glu}} $$\n这证实了从更简单的聚合产物池模型中获得的结果。最小补给通量必须精确平衡用于生物合成的中间产物的总流出。\n\n问题给出了以下流出通量的数值：\n-   $J_{\\mathrm{Asp}} = 5.8$ mmol gDW$^{-1}$ h$^{-1}$\n-   $J_{\\mathrm{Glu}} = 7.7$ mmol gDW$^{-1}$ h$^{-1}$\n\n将这些数值代入推导出的方程：\n$$ v_{\\mathrm{anap,min}} = 5.8 \\, \\text{mmol gDW}^{-1} \\text{h}^{-1} + 7.7 \\, \\text{mmol gDW}^{-1} \\text{h}^{-1} $$\n$$ v_{\\mathrm{anap,min}} = 13.5 \\, \\text{mmol gDW}^{-1} \\text{h}^{-1} $$\n问题要求答案四舍五入到四位有效数字。确切的和是 $13.5$。为用四位有效数字表示此值，我们将其写作 $13.50$。", "answer": "$$\n\\boxed{13.50}\n$$", "id": "2540363"}, {"introduction": "在复杂的代谢网络中，我们如何预测不同环境条件下（如好氧与厌氧）代谢物的流向和速率？通量平衡分析（Flux Balance Analysis, FBA）是系统生物学中解决此类问题的强大计算工具。这项实践将指导您构建并求解一个简化的三羧酸循环FBA模型，通过设置和优化线性规划问题来最大化ATP的生成，亲身体验如何整合化学计量学、反应约束和生物学目标来预测代谢网络的行为。[@problem_id:2540309]", "problem": "给定一个为流平衡分析 (FBA) 设计的、简化版三羧酸（TCA）循环及其与氧化磷酸化耦合的化学计量模型。该模型假设所有内部代谢物处于稳态，并使用线性优化来确定一个可行的内部TCA流通量分布，以最大化三磷酸腺苷（ATP）的耗散（等同于ATP的产生），同时受限于有氧或无氧条件以及交换流通量的上限。您的任务是实现一个程序，为几个测试用例建立并求解相应的线性规划问题，每个测试用例由乙酰辅酶A（AcCoA）供应、氧气摄取以及还原型烟酰胺腺嘌呤二核苷酸（NADH）和还原型黄素腺嘌呤二核苷酸（FADH2）的发酵能力的上限定义。\n\n基本原理：\n- 稳态质量平衡：对于每个内部代谢物 $i$，其净生成速率为零，表示为线性系统 $S \\, \\mathbf{v} = \\mathbf{0}$，其中 $S$ 是化学计量矩阵，$\\mathbf{v}$ 是反应流通量向量。\n- 流通量边界：每个反应 $j$ 都有一个下界 $\\ell_j$ 和一个上界 $u_j$，使得 $\\ell_j \\le v_j \\le u_j$。\n- 线性目标：最大化一个线性函数 $\\mathbf{c}^\\top \\mathbf{v}$，该函数代表ATP耗散，其中ATP由底物水平磷酸化和氧化磷酸化产生。\n\n反应和化学计量（内部代谢物是平衡的；交换代谢物通过交换反应连接）。反应列表如下：\n1. $R_0$: AcCoA\\_in: $\\emptyset \\rightarrow \\mathrm{AcCoA}$。\n2. $R_1$: CS (柠檬酸合酶): $\\mathrm{AcCoA} + \\mathrm{OAA} \\rightarrow \\mathrm{Cit}$。\n3. $R_2$: ACO (乌头酸酶): $\\mathrm{Cit} \\rightarrow \\mathrm{ICit}$。\n4. $R_3$: ICDH (异柠檬酸脱氢酶): $\\mathrm{ICit} \\rightarrow \\mathrm{AKG} + \\mathrm{CO_2} + \\mathrm{NADH}$。\n5. $R_4$: AKGDH ($\\alpha$-酮戊二酸脱氢酶): $\\mathrm{AKG} \\rightarrow \\mathrm{SucCoA} + \\mathrm{CO_2} + \\mathrm{NADH}$。\n6. $R_5$: SUCOAS (琥珀酰辅酶A合成酶): $\\mathrm{SucCoA} \\rightarrow \\mathrm{Succ} + \\mathrm{ATP}$。\n7. $R_6$: SDH (琥珀酸脱氢酶): $\\mathrm{Succ} \\rightarrow \\mathrm{Fum} + \\mathrm{FADH_2}$。\n8. $R_7$: FUM (延胡索酸酶): $\\mathrm{Fum} \\rightarrow \\mathrm{Mal}$。\n9. $R_8$: MDH (苹果酸脱氢酶): $\\mathrm{Mal} \\rightarrow \\mathrm{OAA} + \\mathrm{NADH}$。\n10. $R_9$: ETC\\_NADH (通过NADH的氧化磷酸化): $\\mathrm{NADH} + 0.5\\,\\mathrm{O_2} \\rightarrow \\mathrm{ATP}$，每 $\\mathrm{NADH}$ 的ATP产率为 $y_N = 2.5$。\n11. $R_{10}$: ETC\\_FADH2 (通过FADH2的氧化磷酸化): $\\mathrm{FADH_2} + 0.5\\,\\mathrm{O_2} \\rightarrow \\mathrm{ATP}$，每 $\\mathrm{FADH_2}$ 的ATP产率为 $y_F = 1.5$。\n12. $R_{11}$: ATP\\_drain: $\\mathrm{ATP} \\rightarrow \\emptyset$。\n13. $R_{12}$: O$_2$ 摄取: $\\emptyset \\rightarrow \\mathrm{O_2}$。\n14. $R_{13}$: CO$_2$ 输出: $\\mathrm{CO_2} \\rightarrow \\emptyset$。\n15. $R_{14}$: NADH\\_ferm (通用无氧NADH氧化池): $\\mathrm{NADH} \\rightarrow \\emptyset$。\n16. $R_{15}$: FADH2\\_ferm (通用无氧FADH$_2$氧化池): $\\mathrm{FADH_2} \\rightarrow \\emptyset$。\n\n质量平衡中视为内部代谢物的有：$\\mathrm{AcCoA}$、$\\mathrm{OAA}$、$\\mathrm{Cit}$、$\\mathrm{ICit}$、$\\mathrm{AKG}$、$\\mathrm{SucCoA}$、$\\mathrm{Succ}$、$\\mathrm{Fum}$、$\\mathrm{Mal}$、$\\mathrm{NADH}$、$\\mathrm{FADH_2}$、$\\mathrm{ATP}$、$\\mathrm{O_2}$、$\\mathrm{CO_2}$。\n\n在$S$中，每个反应的化学计量系数如下：\n- $R_0$: $\\mathrm{AcCoA}$ 的系数为 $+1$。\n- $R_1$: $\\mathrm{AcCoA}$ 的系数为 $-1$，$\\mathrm{OAA}$ 的系数为 $-1$，$\\mathrm{Cit}$ 的系数为 $+1$。\n- $R_2$: $\\mathrm{Cit}$ 的系数为 $-1$，$\\mathrm{ICit}$ 的系数为 $+1$。\n- $R_3$: $\\mathrm{ICit}$ 的系数为 $-1$，$\\mathrm{AKG}$ 的系数为 $+1$，$\\mathrm{CO_2}$ 的系数为 $+1$，$\\mathrm{NADH}$ 的系数为 $+1$。\n- $R_4$: $\\mathrm{AKG}$ 的系数为 $-1$，$\\mathrm{SucCoA}$ 的系数为 $+1$，$\\mathrm{CO_2}$ 的系数为 $+1$，$\\mathrm{NADH}$ 的系数为 $+1$。\n- $R_5$: $\\mathrm{SucCoA}$ 的系数为 $-1$，$\\mathrm{Succ}$ 的系数为 $+1$，$\\mathrm{ATP}$ 的系数为 $+1$。\n- $R_6$: $\\mathrm{Succ}$ 的系数为 $-1$，$\\mathrm{Fum}$ 的系数为 $+1$，$\\mathrm{FADH_2}$ 的系数为 $+1$。\n- $R_7$: $\\mathrm{Fum}$ 的系数为 $-1$，$\\mathrm{Mal}$ 的系数为 $+1$。\n- $R_8$: $\\mathrm{Mal}$ 的系数为 $-1$，$\\mathrm{OAA}$ 的系数为 $+1$，$\\mathrm{NADH}$ 的系数为 $+1$。\n- $R_9$: $\\mathrm{NADH}$ 的系数为 $-1$，$\\mathrm{O_2}$ 的系数为 $-0.5$，$\\mathrm{ATP}$ 的系数为 $+y_N$，其中 $y_N=2.5$。\n- $R_{10}$: $\\mathrm{FADH_2}$ 的系数为 $-1$，$\\mathrm{O_2}$ 的系数为 $-0.5$，$\\mathrm{ATP}$ 的系数为 $+y_F$，其中 $y_F=1.5$。\n- $R_{11}$: $\\mathrm{ATP}$ 的系数为 $-1$。\n- $R_{12}$: $\\mathrm{O_2}$ 的系数为 $+1$。\n- $R_{13}$: $\\mathrm{CO_2}$ 的系数为 $-1$。\n- $R_{14}$: $\\mathrm{NADH}$ 的系数为 $-1$。\n- $R_{15}$: $\\mathrm{FADH_2}$ 的系数为 $-1$。\n\n不可逆性与边界：\n- 对于 $R_0$ (AcCoA\\_in): $0 \\le v_0 \\le U_{\\mathrm{AcCoA}}$。\n- 对于内部TCA反应和ATP消耗：$R_1, R_2, R_3, R_4, R_5, R_6, R_7, R_8, R_{11}$ 是正向不可逆的，其流通量为 $0 \\le v_j < \\infty$。\n- 对于氧化磷酸化：$R_9, R_{10}$ 是不可逆的，$0 \\le v_j < \\infty$。\n- 对于氧气摄取：$R_{12}$ 是不可逆的，$0 \\le v_{12} \\le U_{\\mathrm{O_2}}$。\n- 对于二氧化碳输出：$R_{13}$ 是不可逆的，$0 \\le v_{13} < \\infty$。\n- 对于发酵池：$R_{14}$ 是不可逆的，$0 \\le v_{14} \\le U_{\\mathrm{ferm,N}}$，且 $R_{15}$ 是不可逆的，$0 \\le v_{15} \\le U_{\\mathrm{ferm,F}}$。\n\n目标：\n- 最大化ATP耗散流通量 $v_{11}$，该流通量受限于通过底物水平磷酸化（$R_5$）和氧化磷酸化（$R_9$ 和 $R_{10}$）的ATP产生。在ATP的稳态下，约束条件为 $v_{11} = v_5 + y_N v_9 + y_F v_{10}$，其中 $y_N = 2.5$ 且 $y_F = 1.5$。通过直接最大化 $v_{11}$ 来实现此目标。\n\n单位：\n- 所有流通量必须以 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$ 表示。您的程序必须以这些单位输出数值，四舍五入到六位小数。\n\n程序要求行为：\n- 如上所述构建 $S$、边界和目标。\n- 对于下方的每个测试用例，求解在 $S \\mathbf{v} = \\mathbf{0}$ 和边界约束下最大化 $v_{11}$ 的线性规划问题，并返回一个最优流通量向量。\n- 提取内部TCA流通量分布，作为一个有序列表 $[v_1, v_2, v_3, v_4, v_5, v_6, v_7, v_8]$，分别对应于反应CS, ACO, ICDH, AKGDH, SUCOAS, SDH, FUM, 和 MDH。\n- 所有返回的流通量均以 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$ 为单位表示，四舍五入到六位小数。\n\n测试套件（每个元组为 $(U_{\\mathrm{AcCoA}}, U_{\\mathrm{O_2}}, U_{\\mathrm{ferm,N}}, U_{\\mathrm{ferm,F}})$，单位为 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$）：\n- 用例 A（有氧，无发酵）：$(10, 100, 0, 0)$。\n- 用例 B（无氧，发酵充分）：$(10, 0, 100, 100)$。\n- 用例 C（无氧，发酵受限）：$(10, 0, 5, 1)$。\n- 用例 D（无底物）：$(0, 100, 100, 100)$。\n\n最终输出格式：\n- 您的程序应生成单行结果，该结果为一个逗号分隔的列表，用方括号括起，其中每个元素是按A、B、C、D顺序排列的八元素TCA流通量列表。例如：\n\"[[v1_A,v2_A,v3_A,v4_A,v5_A,v6_A,v7_A,v8_A],[v1_B,...,v8_B],[v1_C,...,v8_C],[v1_D,...,v8_D]]\"\n每个 $v$ 值必须是浮点数，四舍五入到六位小数，单位为 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$。", "solution": "所给问题是流平衡分析（FBA）的一个典型应用，这是一种用于系统生物学中预测代谢流通量分布的计算方法。任务是确定在特定约束下，使三磷酸腺苷（ATP）产量最大化的三羧酸（TCA）循环的稳态最优流通量。这被构建为一个线性规划（LP）问题。对问题陈述的严谨验证证实，其具有科学依据、提法恰当（well-posed），并包含了获得唯一且有意义解所需的所有信息。因此，我们可以着手求解。\n\nFBA的核心是稳态假设，该假设规定每个内部代谢物的净生产速率为零。此原则表示为一个线性方程组：\n$$S \\cdot \\mathbf{v} = \\mathbf{0}$$\n其中$S$是维度为 $m \\times n$（$m$个代谢物，$n$个反应）的化学计量矩阵，$\\mathbf{v}$是反应流通量（速率）向量。\n\n首先，我们构建化学计量矩阵$S$。$S$的行对应$m=14$个内部代谢物，列对应$n=16$个反应。条目$S_{ij}$代表代谢物$i$在反应$j$中的化学计量系数。代谢物排序为：$\\mathrm{AcCoA}$, $\\mathrm{OAA}$, $\\mathrm{Cit}$, $\\mathrm{ICit}$, $\\mathrm{AKG}$, $\\mathrm{SucCoA}$, $\\mathrm{Succ}$, $\\mathrm{Fum}$, $\\mathrm{Mal}$, $\\mathrm{NADH}$, $\\mathrm{FADH_2}$, $\\mathrm{ATP}$, $\\mathrm{O_2}$, $\\mathrm{CO_2}$。反应按问题陈述中从$v_0$到$v_{15}$的顺序列出。得到的 $14 \\times 16$ 矩阵$S$如下（为排版方便，此处显示的是转置矩阵 $S^\\top$）：\n\n$$\nS^\\top = \\begin{pmatrix}\n 1 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 \\\\\n-1 & -1 &  1 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 \\\\\n 0 &  0 & -1 &  1 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 \\\\\n 0 &  0 &  0 & -1 &  1 &  0 &  0 &  0 &  0 &  1 &  0 &  0 &  0 &  1 \\\\\n 0 &  0 &  0 &  0 & -1 &  1 &  0 &  0 &  0 &  1 &  0 &  0 &  0 &  1 \\\\\n 0 &  0 &  0 &  0 &  0 & -1 &  1 &  0 &  0 &  0 &  0 &  1 &  0 &  0 \\\\\n 0 &  0 &  0 &  0 &  0 &  0 & -1 &  1 &  0 &  0 &  1 &  0 &  0 &  0 \\\\\n 0 &  0 &  0 &  0 &  0 &  0 &  0 & -1 &  1 &  0 &  0 &  0 &  0 &  0 \\\\\n 0 &  1 &  0 &  0 &  0 &  0 &  0 &  0 & -1 &  1 &  0 &  0 &  0 &  0 \\\\\n 0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 & -1 &  0 &  2.5 & -0.5 &  0 \\\\\n 0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 & -1 &  1.5 & -0.5 &  0 \\\\\n 0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 & -1 &  0 &  0 \\\\\n 0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  1 &  0 \\\\\n 0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 & -1 \\\\\n 0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 & -1 &  0 &  0 &  0 &  0 \\\\\n 0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 & -1 &  0 &  0 &  0\n\\end{pmatrix}\n$$\n\n其次，我们定义流通量的约束。每个流通量 $v_j$ 都受下界 $\\ell_j$ 和上界 $u_j$ 的限制：\n$$ \\ell_j \\le v_j \\le u_j $$\n根据问题描述，大多数反应是不可逆的，所以它们的下界是 $0$。上界要么是无限大（实际上无界），要么由摄取和发酵反应的特定参数给出。对于给定的测试用例 $(U_{\\mathrm{AcCoA}}, U_{\\mathrm{O_2}}, U_{\\mathrm{ferm,N}}, U_{\\mathrm{ferm,F}})$，边界条件为：\n- $0 \\le v_0 \\le U_{\\mathrm{AcCoA}}$\n- $0 \\le v_{12} \\le U_{\\mathrm{O_2}}$\n- $0 \\le v_{14} \\le U_{\\mathrm{ferm,N}}$\n- $0 \\le v_{15} \\le U_{\\mathrm{ferm,F}}$\n- $0 \\le v_j \\le \\infty$ 对于所有其他 $j \\in \\{1, \\dots, 11, 13\\}$。\n\n第三，我们建立目标函数。目标是最大化ATP耗散流通量 $v_{11}$。这等同于最小化其负值 $-v_{11}$。因此，待优化的目标函数是 $\\mathbf{c}^\\top \\mathbf{v}$，其中 $\\mathbf{c}$ 是一个在对应 $v_{11}$ 的位置为 $1$、其他位置为 $0$ 的向量，并且我们求解一个最大化问题（或在标准LP求解器中最小化 $-\\mathbf{c}^\\top \\mathbf{v}$）。\n$$ \\text{目标向量} = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0]^\\top $$\n\n完整的LP公式为：\n$$\n\\begin{align*}\n\\text{最大化} \\quad & \\mathbf{c}^\\top \\mathbf{v} \\\\\n\\text{受限于} \\quad & S \\cdot \\mathbf{v} = \\mathbf{0} \\\\\n& \\boldsymbol{\\ell} \\le \\mathbf{v} \\le \\mathbf{u}\n\\end{align*}\n$$\n该LP问题使用标准数值求解器（在本例中为 `scipy.optimize.linprog`）为四个测试用例中的每一个进行求解。得到的最优流通量向量 $\\mathbf{v}^*$ 提供了每个反应的流通量。从该向量中，我们提取内部TCA循环反应的流通量 $v_1$ 到 $v_8$，并按要求的格式呈现。对于接近零值的数值精度问题，通过将低于一个微小容差（例如 $10^{-9}$）的流通量设为精确的 $0$ 来处理。最终值按规定四舍五入到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Sets up and solves the flux balance analysis problem for the TCA cycle.\n    \"\"\"\n    \n    # Stoichiometric matrix S (14 metabolites x 16 reactions)\n    # Metabolites (rows): AcCoA, OAA, Cit, ICit, AKG, SucCoA, Succ, Fum, Mal,\n    #                     NADH, FADH2, ATP, O2, CO2\n    # Reactions (columns): R0-R15\n    S = np.array([\n        # v0,  v1, v2, v3, v4, v5, v6, v7, v8,   v9,  v10, v11, v12, v13, v14, v15\n        [  1,  -1,  0,  0,  0,  0,  0,  0,  0,    0,    0,   0,   0,   0,   0,   0],  # AcCoA\n        [  0,  -1,  0,  0,  0,  0,  0,  0,  1,    0,    0,   0,   0,   0,   0,   0],  # OAA\n        [  0,   1, -1,  0,  0,  0,  0,  0,  0,    0,    0,   0,   0,   0,   0,   0],  # Cit\n        [  0,   0,  1, -1,  0,  0,  0,  0,  0,    0,    0,   0,   0,   0,   0,   0],  # ICit\n        [  0,   0,  0,  1, -1,  0,  0,  0,  0,    0,    0,   0,   0,   0,   0,   0],  # AKG\n        [  0,   0,  0,  0,  1, -1,  0,  0,  0,    0,    0,   0,   0,   0,   0,   0],  # SucCoA\n        [  0,   0,  0,  0,  0,  1, -1,  0,  0,    0,    0,   0,   0,   0,   0,   0],  # Succ\n        [  0,   0,  0,  0,  0,  0,  1, -1,  0,    0,    0,   0,   0,   0,   0,   0],  # Fum\n        [  0,   0,  0,  0,  0,  0,  0,  1, -1,    0,    0,   0,   0,   0,   0,   0],  # Mal\n        [  0,   0,  0,  1,  1,  0,  0,  0,  1,   -1,    0,   0,   0,   0,  -1,   0],  # NADH\n        [  0,   0,  0,  0,  0,  0,  1,  0,  0,    0,   -1,   0,   0,   0,   0,  -1],  # FADH2\n        [  0,   0,  0,  0,  0,  1,  0,  0,  0,  2.5,  1.5,  -1,   0,   0,   0,   0],  # ATP\n        [  0,   0,  0,  0,  0,  0,  0,  0,  0, -0.5, -0.5,   0,   1,   0,   0,   0],  # O2\n        [  0,   0,  0,  1,  1,  0,  0,  0,  0,    0,    0,   0,   0,  -1,   0,   0]   # CO2\n    ], dtype=float)\n\n    # Objective function: maximize v11 (ATP_drain), which is equivalent to minimize -v11\n    c = np.zeros(16)\n    c[11] = -1\n\n    # Test suite: (U_AcCoA, U_O2, U_ferm_N, U_ferm_F)\n    test_cases = [\n        (10, 100, 0, 0),       # Case A: aerobic\n        (10, 0, 100, 100),     # Case B: anaerobic, ample fermentation\n        (10, 0, 5, 1),         # Case C: anaerobic, limited fermentation\n        (0, 100, 100, 100)     # Case D: no substrate\n    ]\n\n    all_results_tca_fluxes = []\n\n    for case in test_cases:\n        U_AcCoA, U_O2, U_ferm_N, U_ferm_F = case\n\n        # Define flux bounds (lower_bound, upper_bound) for each reaction v0 to v15\n        # None represents infinity\n        bounds = [\n            (0, U_AcCoA),       # v0: AcCoA_in\n            (0, None),           # v1: CS\n            (0, None),           # v2: ACO\n            (0, None),           # v3: ICDH\n            (0, None),           # v4: AKGDH\n            (0, None),           # v5: SUCOAS\n            (0, None),           # v6: SDH\n            (0, None),           # v7: FUM\n            (0, None),           # v8: MDH\n            (0, None),           # v9: ETC_NADH\n            (0, None),           # v10: ETC_FADH2\n            (0, None),           # v11: ATP_drain\n            (0, U_O2),           # v12: O2_uptake\n            (0, None),           # v13: CO2_export\n            (0, U_ferm_N),       # v14: NADH_ferm\n            (0, U_ferm_F)        # v15: FADH2_ferm\n        ]\n\n        # Solve the linear programming problem\n        res = linprog(c, A_eq=S, b_eq=np.zeros(S.shape[0]), bounds=bounds, method='highs')\n\n        if not res.success:\n            # In case of optimization failure, report zero fluxes\n            tca_fluxes = [0.0] * 8\n        else:\n            v = res.x\n            # Due to floating point inaccuracies, values close to 0 can be slightly negative.\n            v[v  1e-9] = 0\n            \n            # Extract internal TCA fluxes (v1 to v8)\n            # R1:CS, R2:ACO, R3:ICDH, R4:AKGDH, R5:SUCOAS, R6:SDH, R7:FUM, R8:MDH\n            tca_fluxes_raw = v[1:9]\n            \n            # Round to six decimal places as required\n            tca_fluxes = [round(flux, 6) for flux in tca_fluxes_raw]\n            \n        all_results_tca_fluxes.append(tca_fluxes)\n\n    # Format the final output according to the problem specification\n    # e.g., \"[[v1_A..v8_A],[v1_B..v8_B],...]\"\n    # str() on a list of floats generates the required inner format [1.0, 2.0, ...]\n    output_str = str(all_results_tca_fluxes).replace(\" \", \"\")\n\n    print(output_str)\n\n# In a restricted environment, the main execution block needs to be self-contained.\n# solve() call is assumed to be handled by the execution environment.\n# For local testing, uncomment the line below.\n# solve()\n```", "id": "2540309"}]}