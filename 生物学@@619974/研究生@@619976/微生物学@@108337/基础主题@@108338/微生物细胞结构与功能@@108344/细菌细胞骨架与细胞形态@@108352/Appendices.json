{"hands_on_practices": [{"introduction": "如何从简单的杆状或球状生成更复杂的细胞形态，例如新月柄杆菌（Caulobacter crescentus）的新月形？这个练习的核心是差异化生长假说，即细胞骨架蛋白（如 Crescentin, CreS）通过在细胞内壁局部抑制肽聚糖合成，导致内外壁生长速度不均衡。通过这个练习，你将定量地探索局部生长率 $\\mu$ 的微小差异如何导致全局细胞曲率半径 $R_c$ 的出现，这是形态建成中的一个基本概念，它要求你将几何学原理和生长动力学定律应用于一个动态的生物系统。[@problem_id:2537435]", "problem": "像 *Caulobacter crescentus* 这样的新月形细菌可以理想化为一个薄圆弧，其中心线的曲率半径为 $R_c(t)$，其横跨弧的厚度（近似于细胞直径）为 $d$。细胞骨架蛋白 Crescentin (CreS) 定位于内曲率处，并抑制此处的肽聚糖插入。假设存在以下基本事实和运动学关系：\n- 沿侧壁的指数伸长：任何无约束伸长的局部弧长 $\\ell(t)$ 均遵循 $\\frac{d\\ell}{dt} = \\mu\\,\\ell$，其解为 $\\ell(t) = \\ell(0)\\exp(\\mu t)$，其中 $\\mu$ 是一个恒定的比伸长率。\n- Crescentin介导的抑制作用使内壁的比伸长率降低了比例 $\\alpha$，因此内壁的比伸长率为 $(1-\\alpha)\\mu$，而外壁的比伸长率保持为 $\\mu$。\n- 该弧保持为圆形，厚度恒为 $d$，并通过沿其长度的纯拉伸生长（无剪切，无径向膨胀）。设该弧对应的圆心角为 $\\theta(t)$（以弧度为单位）。在任何时候，外壁和内壁的弧长都满足几何关系 $L_{\\mathrm{out}}(t) = \\big(R_c(t) + \\frac{d}{2}\\big)\\,\\theta(t)$ 和 $L_{\\mathrm{in}}(t) = \\big(R_c(t) - \\frac{d}{2}\\big)\\,\\theta(t)$。\n\n在时间 $t=0$ 时，细胞的中线曲率半径为 $R_c(0) = R_0$，角度为 $\\theta(0) = \\theta_0$。因此，外壁和内壁的长度分别为 $L_{\\mathrm{out}}(0) = \\big(R_0 + \\frac{d}{2}\\big)\\theta_0$ 和 $L_{\\mathrm{in}}(0) = \\big(R_0 - \\frac{d}{2}\\big)\\theta_0$。在时间间隔 $T$ 内，由于CreS的抑制作用，外壁以速率 $\\mu$ 指数伸长，而内壁以速率 $(1-\\alpha)\\mu$ 指数伸长。\n\n仅从上述运动学和指数生长定律出发，通过对沿弧的微分生长进行积分，推导出 $R_c(T)$，然后根据以下参数值计算曲率半径的变化量 $\\Delta R_c = R_c(T) - R_0$：$R_0 = 3.0\\,\\mu\\mathrm{m}$，$d = 0.70\\,\\mu\\mathrm{m}$，$\\mu = 0.60\\,\\mathrm{h}^{-1}$，$\\alpha = 0.30$，以及 $T = 1.0\\,\\mathrm{h}$。角度以弧度为单位。用 $\\mu\\mathrm{m}$ 表示你的最终答案，并将结果四舍五入到四位有效数字。", "solution": "问题陈述描述了一个用于新月形细菌生长的生物物理模型。该模型基于细菌细胞生物学的既定原理，即指数生长和细胞骨架通过调节细胞壁合成来决定细胞形状的作用。该问题具有科学依据，在数学上是适定的，并包含获得唯一解所需的所有信息。因此，该问题是有效的，我们可以继续进行推导。\n\n问题的核心在于细胞内壁和外壁之间的差异生长。外壁和内壁的长度 $L_{\\mathrm{out}}(t)$ 和 $L_{\\mathrm{in}}(t)$ 根据给定的指数生长定律演变。在时间 $T$，它们的长度由以下公式给出：\n$$L_{\\mathrm{out}}(T) = L_{\\mathrm{out}}(0)\\exp(\\mu T)$$\n$$L_{\\mathrm{in}}(T) = L_{\\mathrm{in}}(0)\\exp((1-\\alpha)\\mu T)$$\n其中 $\\mu$ 是外壁的比伸长率，而 $(1-\\alpha)\\mu$ 是由于细胞骨架蛋白 Crescentin 的存在而被抑制的内壁比伸长率。\n\n在 $t=0$ 时的初始长度由初始几何形状决定：一个半径为 $R_c(0) = R_0$、厚度为 $d$、对应圆心角为 $\\theta_0$ 的弧。\n$$L_{\\mathrm{out}}(0) = \\left(R_0 + \\frac{d}{2}\\right)\\theta_0$$\n$$L_{\\mathrm{in}}(0) = \\left(R_0 - \\frac{d}{2}\\right)\\theta_0$$\n\n将这些初始长度代入生长方程，得到时间 $T$ 时的长度：\n$$L_{\\mathrm{out}}(T) = \\left(R_0 + \\frac{d}{2}\\right)\\theta_0 \\exp(\\mu T)$$\n$$L_{\\mathrm{in}}(T) = \\left(R_0 - \\frac{d}{2}\\right)\\theta_0 \\exp((1-\\alpha)\\mu T)$$\n\n在任何时间 $t$（包括 $T$），细胞的几何形状都由一个中线曲率半径为 $R_c(T)$、对应圆心角为 $\\theta(T)$ 的圆弧描述。弧长必须满足以下几何关系：\n$$L_{\\mathrm{out}}(T) = \\left(R_c(T) + \\frac{d}{2}\\right)\\theta(T)$$\n$$L_{\\mathrm{in}}(T) = \\left(R_c(T) - \\frac{d}{2}\\right)\\theta(T)$$\n\n为了求解 $R_c(T)$，我们可以通过考虑外壁与内壁弧长之比来消去未知角度 $\\theta_0$ 和 $\\theta(T)$。从生长动力学，我们有：\n$$\\frac{L_{\\mathrm{out}}(T)}{L_{\\mathrm{in}}(T)} = \\frac{\\left(R_0 + \\frac{d}{2}\\right)\\theta_0 \\exp(\\mu T)}{\\left(R_0 - \\frac{d}{2}\\right)\\theta_0 \\exp((1-\\alpha)\\mu T)} = \\left(\\frac{R_0 + \\frac{d}{2}}{R_0 - \\frac{d}{2}}\\right) \\exp(\\mu T - (1-\\alpha)\\mu T)$$\n$$\\frac{L_{\\mathrm{out}}(T)}{L_{\\mathrm{in}}(T)} = \\left(\\frac{R_0 + \\frac{d}{2}}{R_0 - \\frac{d}{2}}\\right) \\exp(\\alpha\\mu T)$$\n\n从时间 $T$ 时的几何形状，我们有：\n$$\\frac{L_{\\mathrm{out}}(T)}{L_{\\mathrm{in}}(T)} = \\frac{\\left(R_c(T) + \\frac{d}{2}\\right)\\theta(T)}{\\left(R_c(T) - \\frac{d}{2}\\right)\\theta(T)} = \\frac{R_c(T) + \\frac{d}{2}}{R_c(T) - \\frac{d}{2}}$$\n\n通过将这两个弧长比的表达式相等，我们得到了一个将 $R_c(T)$ 与初始参数联系起来且与角度无关的方程：\n$$\\frac{R_c(T) + \\frac{d}{2}}{R_c(T) - \\frac{d}{2}} = \\left(\\frac{R_0 + \\frac{d}{2}}{R_0 - \\frac{d}{2}}\\right) \\exp(\\alpha\\mu T)$$\n\n为了求解 $R_c(T)$，我们定义一个无量纲量 $K$：\n$$K = \\left(\\frac{R_0 + \\frac{d}{2}}{R_0 - \\frac{d}{2}}\\right) \\exp(\\alpha\\mu T)$$\n方程变为：\n$$\\frac{R_c(T) + \\frac{d}{2}}{R_c(T) - \\frac{d}{2}} = K$$\n我们重新整理此式以求解 $R_c(T)$：\n$$R_c(T) + \\frac{d}{2} = K\\left(R_c(T) - \\frac{d}{2}\\right)$$\n$$R_c(T) + \\frac{d}{2} = K R_c(T) - K\\frac{d}{2}$$\n$$\\frac{d}{2} + K\\frac{d}{2} = K R_c(T) - R_c(T)$$\n$$\\frac{d}{2}(K+1) = R_c(T)(K-1)$$\n$$R_c(T) = \\frac{d}{2} \\frac{K+1}{K-1}$$\n\n将 $K$ 的表达式代回，得到 $R_c(T)$ 的完整解析解：\n$$R_c(T) = \\frac{d}{2} \\frac{\\left(\\frac{R_0 + d/2}{R_0 - d/2}\\right) \\exp(\\alpha\\mu T) + 1}{\\left(\\frac{R_0 + d/2}{R_0 - d/2}\\right) \\exp(\\alpha\\mu T) - 1}$$\n\n现在，我们代入给定的数值：$R_0 = 3.0\\,\\mu\\mathrm{m}$，$d = 0.70\\,\\mu\\mathrm{m}$，$\\mu = 0.60\\,\\mathrm{h}^{-1}$，$\\alpha = 0.30$，以及 $T = 1.0\\,\\mathrm{h}$。\n\n首先，我们计算无量纲的参数。指数部分为：\n$$\\alpha\\mu T = (0.30)(0.60\\,\\mathrm{h}^{-1})(1.0\\,\\mathrm{h}) = 0.18$$\n初始几何比为：\n$$\\frac{R_0 + d/2}{R_0 - d/2} = \\frac{3.0\\,\\mu\\mathrm{m} + 0.35\\,\\mu\\mathrm{m}}{3.0\\,\\mu\\mathrm{m} - 0.35\\,\\mu\\mathrm{m}} = \\frac{3.35}{2.65}$$\n\n现在，我们计算因子 $K$：\n$$K = \\frac{3.35}{2.65} \\exp(0.18)$$\n数值上，$\\frac{3.35}{2.65} \\approx 1.26415094$ 且 $\\exp(0.18) \\approx 1.19721736$。\n$$K \\approx (1.26415094)(1.19721736) \\approx 1.51347001$$\n\n我们用这个值来求 $R_c(T)$：\n$$R_c(T) = \\frac{0.70\\,\\mu\\mathrm{m}}{2} \\frac{1.51347001 + 1}{1.51347001 - 1} = (0.35\\,\\mu\\mathrm{m}) \\frac{2.51347001}{0.51347001}$$\n$$R_c(T) \\approx (0.35\\,\\mu\\mathrm{m}) (4.89503329) \\approx 1.71326165\\,\\mu\\mathrm{m}$$\n\n问题要求计算曲率半径的变化量 $\\Delta R_c = R_c(T) - R_0$。\n$$\\Delta R_c = 1.71326165\\,\\mu\\mathrm{m} - 3.0\\,\\mu\\mathrm{m} = -1.28673835\\,\\mu\\mathrm{m}$$\n\n负号表示曲率半径减小，意味着细胞变得更弯曲。这是外壁生长速度快于内壁的直接结果。\n\n最后，将结果四舍五入到四位有效数字，得到：\n$$\\Delta R_c \\approx -1.287\\,\\mu\\mathrm{m}$$", "answer": "$$\\boxed{-1.287}$$", "id": "2537435"}, {"introduction": "细菌细胞分裂是其生命周期中的关键事件，其中隔膜的收缩过程至关重要。本练习基于一个核心的物理原理：面积守恒，即由分裂机器合成新肽聚糖的速率必须等于隔膜孔缩小的速率。这个模型将分子层面的活动（如单个合成酶的催化周期时间 $\\tau_c$）与细胞尺度的过程（隔膜关闭）联系起来，更重要的是，它展示了如何利用这类模型从宏观可观测数据中估算难以直接测量的生物学参数，例如活跃酶分子的数量 $M$。[@problem_id:2537454]", "problem": "在杆状细菌中，当一组活性合成酶（如青霉素结合蛋白(PBPs; penicillin-binding protein)）合成肽聚糖(PG)时，隔膜会发生收缩。假设每个合成酶独立地完成催化循环，平均循环时间为$\\,\\tau_{c}\\,$，并且每个完成的循环都为生长的隔膜盘贡献一个面积为$\\,s\\,$的新隔膜PG有效斑块。设在隔膜边缘均匀分布着$\\,M\\,$个活性合成酶。将隔膜视为一个瞬时半径为$\\,r(t)\\,$的圆盘，从初始半径$\\,r_{0}\\,$闭合到$\\,0\\,$，并假设PG的面密度恒定，合成在边缘周围是均匀的，且重塑或裂解不限制边缘的前进。\n\n首先，从面积守恒和圆的几何学出发，推导出一个关于瞬时隔膜闭合速度$\\,\\dot{r}(r)\\,$的符号表达式，该表达式是$\\,M\\,$、$\\,s\\,$、$\\,\\tau_{c}\\,$和$\\,r\\,$的函数。然后，通过对得到的$\\,\\dot{r}(r)\\,$进行积分，获得从$\\,r_{0}\\,$闭合到$\\,0\\,$所需的总收缩时间$\\,T\\,$的表达式。最后，使用实验观测到的收缩时间来估算活性合成酶的数量$\\,M\\,$.\n\n使用以下参数值：\n- 初始隔膜半径 $\\,r_{0} = 0.50\\,\\mu\\mathrm{m}\\,$.\n- 每个合成酶每次催化循环的有效面积 $\\,s = 3.0 \\times 10^{-6}\\,\\mu\\mathrm{m}^{2}\\,$.\n- 平均催化循环时间 $\\,\\tau_{c} = 0.20\\,\\mathrm{s}\\,$.\n- 观测到的总收缩时间 $\\,T_{\\mathrm{obs}} = 1.50 \\times 10^{3}\\,\\mathrm{s}\\,$.\n\n将估算出的$\\,M\\,$报告为一个四舍五入到两位有效数字的纯数。在最终报告的值中不要包含单位。角度（如果出现）应以弧度为单位。", "solution": "问题陈述具有科学依据、提法明确、客观且自成体系。它描述了一个简化的、但在物理和生物学上连贯的细菌隔膜收缩模型。所提供的参数在细胞过程的合理范围内。任务是推导特定的物理量，并用它们进行定量估算，这是生物物理建模中的一个标准程序。因此，该问题被认为是有效的。我们将着手解决它。\n\n要应用的基本原理是面积守恒。新肽聚糖(PG)面积的合成速率必须等于开放隔膜孔面积的减小速率。\n\n首先，我们确定PG面积的总合成速率。有$M$个合成酶，每个合成酶在平均时间$\\tau_{c}$内完成一个催化循环。因此，每个合成酶的循环速率是$\\frac{1}{\\tau_{c}}$。在$M$个合成酶独立工作的情况下，单位时间内的总催化循环次数是$\\frac{M}{\\tau_{c}}$。每个循环贡献一个面积$s$。因此，总面积合成速率为：\n$$ \\frac{dA_{\\text{synth}}}{dt} = \\frac{M s}{\\tau_{c}} $$\n在给定假设下，该速率是恒定的。\n\n接下来，我们考虑闭合隔膜的几何形状。开放的隔膜区域是一个瞬时半径为$r(t)$的圆，所以其面积是$A(t) = \\pi r(t)^{2}$。这个面积的变化率可以通过使用链式法则对时间$t$求导得到：\n$$ \\frac{dA}{dt} = \\frac{d}{dt} (\\pi r^{2}) = 2\\pi r \\frac{dr}{dt} $$\n由于隔膜正在闭合，其面积在减小。新PG的合成速率必须等于开放区域面积的减小速率。因此，我们有：\n$$ \\frac{dA}{dt} = - \\frac{dA_{\\text{synth}}}{dt} = - \\frac{M s}{\\tau_{c}} $$\n令两个关于$\\frac{dA}{dt}$的表达式相等，得到：\n$$ 2\\pi r \\frac{dr}{dt} = - \\frac{M s}{\\tau_{c}} $$\n求解瞬时隔膜闭合速度$\\dot{r}(r) = \\frac{dr}{dt}$，我们得到第一个要求的表达式：\n$$ \\dot{r}(r) = -\\frac{M s}{2\\pi \\tau_{c} r} $$\n负号正确地表示半径随时间减小。闭合速度，即大小$|\\dot{r}|$，与半径$r$成反比。\n\n为了求得总收缩时间$T$，我们必须对这个微分方程进行积分。我们可以分离变量$r$和$t$：\n$$ 2\\pi r \\, dr = -\\frac{M s}{\\tau_{c}} \\, dt $$\n我们对等式两边在整个收缩期间进行积分。半径$r$从时间$t=0$时的初始值$r_{0}$减小到时间$t=T$时的最终值$0$。\n$$ \\int_{r_{0}}^{0} 2\\pi r \\, dr = \\int_{0}^{T} -\\frac{M s}{\\tau_{c}} \\, dt $$\n我们计算积分：\n左边：$\\int_{r_{0}}^{0} 2\\pi r \\, dr = 2\\pi \\left[\\frac{r^{2}}{2}\\right]_{r_{0}}^{0} = \\pi (0^{2} - r_{0}^{2}) = -\\pi r_{0}^{2}$。\n右边：$\\int_{0}^{T} -\\frac{M s}{\\tau_{c}} \\, dt = -\\frac{M s}{\\tau_{c}} [t]_{0}^{T} = -\\frac{M s T}{\\tau_{c}}$。\n\n令结果相等：\n$$ -\\pi r_{0}^{2} = -\\frac{M s T}{\\tau_{c}} $$\n求解总收缩时间$T$，我们得到第二个要求的表达式：\n$$ T = \\frac{\\pi \\tau_{c} r_{0}^{2}}{M s} $$\n\n最后，我们使用实验观测到的收缩时间$T_{\\mathrm{obs}}$来估算活性合成酶的数量$M$。我们重新整理$T$的表达式来求解$M$：\n$$ M = \\frac{\\pi \\tau_{c} r_{0}^{2}}{T s} $$\n给定以下参数值：\n- 初始隔膜半径 $r_{0} = 0.50\\,\\mu\\mathrm{m}$\n- 每个周期的有效面积 $s = 3.0 \\times 10^{-6}\\,\\mu\\mathrm{m}^{2}$\n- 平均催化循环时间 $\\tau_{c} = 0.20\\,\\mathrm{s}$\n- 观测到的总收缩时间 $T = T_{\\mathrm{obs}} = 1.50 \\times 10^{3}\\,\\mathrm{s}$\n\n将这些值代入$M$的方程中：\n$$ M = \\frac{\\pi (0.20\\,\\mathrm{s}) (0.50\\,\\mu\\mathrm{m})^{2}}{(1.50 \\times 10^{3}\\,\\mathrm{s}) (3.0 \\times 10^{-6}\\,\\mu\\mathrm{m}^{2})} $$\n$$ M = \\frac{\\pi (0.20) (0.25)}{ (1.50 \\times 10^{3}) (3.0 \\times 10^{-6}) } $$\n$$ M = \\frac{0.05 \\pi}{4.5 \\times 10^{-3}} = \\frac{5 \\times 10^{-2} \\pi}{4.5 \\times 10^{-3}} = \\frac{5}{4.5} \\times 10^{1} \\pi = \\frac{10}{9} \\times 10 \\pi = \\frac{100\\pi}{9} $$\n计算数值：\n$$ M \\approx 34.906585... $$\n问题要求将此值四舍五入到两位有效数字。\n$$ M \\approx 35 $$\n这个结果代表了共同驱动隔膜收缩的活性合成酶的估算数量。", "answer": "$$\n\\boxed{35}\n$$", "id": "2537454"}, {"introduction": "现代微生物学的一个重要挑战是连接基因型（细胞骨架基因的存在与否）与表型（细胞形态）。这个练习将特定的生物学规则（例如，MreB 蛋白与杆状形态相关，CreS 蛋白与弧菌形态相关）形式化为一个计算流程。本次实践将视角从单个细胞的物理建模转向了基因组尺度上的生物信息学预测，你将学习如何将生物学知识转化为算法，利用阈值和逻辑规则构建一个分类器，并使用灵敏度 $\\mathrm{Se}_k$ 和特异性 $\\mathrm{Sp}_k$ 等指标来量化评估其性能，这些都是计算生物学中的核心技能。[@problem_id:2537467]", "problem": "您的任务是规范化并实现一个确定性计算流程，该流程根据每个基因组的细胞骨架蛋白家族的概貌相似性证据，检测可能的同源物并预测细菌细胞形态类别。此任务必须基于基本的生物学和统计学原理进行构建，并实现为一个能产出量化性能指标的算法。\n\n基本原理和假设：\n- 中心法则指出，脱氧核糖核酸（DNA）编码蛋白质，其一级氨基酸序列包含共同祖先的信号。基于概貌的方法，例如隐马尔可夫模型（HMM），会产生一个对数优势比分数（bitscore），该分数指示了查询序列与蛋白质家族概貌的相似性。公认的是，越高的bitscore与同源性相关性越强，而比对的覆盖度则表示查询域与概貌匹配的部分所占的比例。\n- 细胞骨架蛋白家族与细菌细胞形态之间有经验上确立的关系：FtsZ在有细胞壁的细菌中广泛保守；MreB与杆状细胞形态相关；Crescentin（CreS）与弯曲形态（弧菌形）相关。这些关联被用作机制性的先验知识。\n- 从连续证据进行二元分类可以看作是一个阈值检验。对于一个蛋白质家族，给定其bitscore $s$ 和概貌覆盖度 $c$，当 $s \\ge T$ 且 $c \\ge K$ 时，判定为检测到该家族。其中 $T$ 和 $K$ 是预先指定的常数。这是一种Neyman–Pearson风格的决策规则，通过设定阈值来控制假阳性。\n- 对于给定的类别 $k$，根据预测值与真实标签（ground truth）定义真阳性 $TP_k$、假阳性 $FP_k$、真阴性 $TN_k$ 和假阴性 $FN_k$。灵敏度（召回率）和特异度的定义分别为 $\\mathrm{Se}_k = \\dfrac{TP_k}{TP_k + FN_k}$ 和 $\\mathrm{Sp}_k = \\dfrac{TN_k}{TN_k + FP_k}$。所有比率必须以小数形式表示。\n\n流程规范：\n- 对于每个基因组，给定一个元组 $(s_{\\mathrm{F}}, c_{\\mathrm{F}}, s_{\\mathrm{M}}, c_{\\mathrm{M}}, s_{\\mathrm{C}}, c_{\\mathrm{C}}, y)$，其中 $s_{\\mathrm{F}}$ 和 $c_{\\mathrm{F}}$ 是FtsZ概貌的bitscore和覆盖度，$s_{\\mathrm{M}}$ 和 $c_{\\mathrm{M}}$ 是MreB的，$s_{\\mathrm{C}}$ 和 $c_{\\mathrm{C}}$ 是CreS的，$y$ 是真实的细胞形态标签，属于 $\\{\\text{coccus}, \\text{rod}, \\text{vibrio}\\}$ 集合。Bitscore是无量纲的，覆盖度是区间 $[0,1]$ 内的分数。\n- 使用固定阈值 $T_{\\mathrm{F}} = 50$, $K_{\\mathrm{F}} = 0.7$；$T_{\\mathrm{M}} = 60$, $K_{\\mathrm{M}} = 0.6$；$T_{\\mathrm{C}} = 45$, $K_{\\mathrm{C}} = 0.5$。当且仅当 $s_x \\ge T_x$ 且 $c_x \\ge K_x$ 时，家族 $x \\in \\{\\mathrm{F}, \\mathrm{M}, \\mathrm{C}\\}$ 被视为检测到。\n- 使用以下规则集预测细胞形态 $\\hat{y}$：\n  - 如果MreB和CreS都被检测到，预测 $\\hat{y} = \\text{vibrio}$。\n  - 否则，如果MreB被检测到而CreS未被检测到，预测 $\\hat{y} = \\text{rod}$。\n  - 否则，如果MreB未被检测到，FtsZ被检测到，且CreS未被检测到，预测 $\\hat{y} = \\text{coccus}$。\n  - 否则（包括FtsZ未被检测到或CreS在没有MreB的情况下被检测到的情况），预测 $\\hat{y} = \\text{unknown}$。\n- 在评估时，将 $\\text{unknown}$ 视为与三个类别中的任何一个都不匹配（即，对于真实类别，它会计入 $FN_k$；对于所有其他类别，它会计入 $TN_k$）。\n\n需在整个测试集上计算的评估指标：\n- 对于 $k \\in \\{\\text{coccus}, \\text{rod}, \\text{vibrio}\\}$，计算如上定义的 $\\mathrm{Se}_k$ 和 $\\mathrm{Sp}_k$。\n- 计算所有基因组的总体准确率 $\\mathrm{Acc} = \\dfrac{\\text{正确预测的数量}}{\\text{基因组总数}}$，其中只有 $\\hat{y}$ 与 $y$ 完全匹配才算作正确预测；只有当真实标签也是 $\\text{unknown}$ 时，$\\text{unknown}$ 预测才算正确（在本测试集中不会出现这种情况）。\n\n测试集：\n为以下 $8$ 个基因组提供结果，每个基因组都以 $(s_{\\mathrm{F}}, c_{\\mathrm{F}}, s_{\\mathrm{M}}, c_{\\mathrm{M}}, s_{\\mathrm{C}}, c_{\\mathrm{C}}, y)$ 的形式指定：\n- 基因组 $1$：$(80, 0.9, 20, 0.2, 10, 0.2, \\text{coccus})$。\n- 基因组 $2$：$(75, 0.95, 70, 0.9, 15, 0.4, \\text{rod})$。\n- 基因组 $3$：$(85, 0.8, 90, 0.7, 60, 0.8, \\text{vibrio})$。\n- 基因组 $4$：$(70, 0.75, 60, 0.6, 30, 0.6, \\text{rod})$。\n- 基因组 $5$：$(65, 0.72, 59.9, 0.8, 45, 0.49, \\text{coccus})$。\n- 基因组 $6$：$(49, 0.69, 25, 0.3, 20, 0.2, \\text{coccus})$。\n- 基因组 $7$：$(88, 0.9, 85, 0.95, 45, 0.5, \\text{rod})$。\n- 基因组 $8$：$(90, 0.9, 80, 0.7, 55, 0.49, \\text{vibrio})$。\n\n角度单位不适用。所有输出均为无单位的小数。将所有报告的指标四舍五入至三位小数。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，顺序如下：\n$[ \\mathrm{Se}_{\\text{coccus}}, \\mathrm{Sp}_{\\text{coccus}}, \\mathrm{Se}_{\\text{rod}}, \\mathrm{Sp}_{\\text{rod}}, \\mathrm{Se}_{\\text{vibrio}}, \\mathrm{Sp}_{\\text{vibrio}}, \\mathrm{Acc} ]$。", "solution": "所提出的问题是计算生物学中一个有效且定义明确的任务。它要求基于可靠（尽管简化了）的生物学和统计学原理，实现一个确定性算法，根据序列同源性数据对细菌细胞形态进行分类。规则、数据和评估指标的规定足够精确，可以得出一个唯一的、可验证的解决方案。其中不存在科学或逻辑上的矛盾。分析过程如下。\n\n问题的核心是实现一个决策流程。首先，对于每个基因组，我们必须确定三个关键细胞骨架蛋白家族的存在：FtsZ、MreB 和 Crescentin (CreS)。对于给定的蛋白质家族 $x \\in \\{\\mathrm{F}, \\mathrm{M}, \\mathrm{C}\\}$，其检测逻辑基于对隐马尔可夫模型（HMM）搜索得到的 bitscore $s_x$ 和概貌覆盖度 $c_x$ 的双重阈值测试。当且仅当一个蛋白质的分数和覆盖度达到或超过指定阈值，即 $s_x \\ge T_x$ 且 $c_x \\ge K_x$，该蛋白质才被认为是“已检测到”。\n\n固定阈值如下：\n- 对于 FtsZ (F): $T_{\\mathrm{F}} = 50$, $K_{\\mathrm{F}} = 0.7$\n- 对于 MreB (M): $T_{\\mathrm{M}} = 60$, $K_{\\mathrm{M}} = 0.6$\n- 对于 Crescentin (C): $T_{\\mathrm{C}} = 45$, $K_{\\mathrm{C}} = 0.5$\n\n设 $D_x$ 为一个布尔变量，表示家族 $x$ 的检测状态。预测的细胞形态 $\\hat{y}$ 由以下层级规则集确定：\n$1$. 如果 $D_{\\mathrm{M}}$ 和 $D_{\\mathrm{C}}$ 均为真，预测 $\\hat{y} = \\text{vibrio}$。\n$2$. 否则，如果 $D_{\\mathrm{M}}$ 为真且 $D_{\\mathrm{C}}$ 为假，预测 $\\hat{y} = \\text{rod}$。\n$3$. 否则，如果 $D_{\\mathrm{M}}$ 为假，$D_{\\mathrm{F}}$ 为真，且 $D_{\\mathrm{C}}$ 为假，预测 $\\hat{y} = \\text{coccus}$。\n$4$. 在所有其他情况下，预测为 $\\hat{y} = \\text{unknown}$。\n\n我们将此流程应用于提供的 $8$ 个基因组。\n\n- **基因组 $1$**: $(s_{\\mathrm{F}} = 80, c_{\\mathrm{F}} = 0.9, s_{\\mathrm{M}} = 20, c_{\\mathrm{M}} = 0.2, s_{\\mathrm{C}} = 10, c_{\\mathrm{C}} = 0.2, y = \\text{coccus})$\n  - $D_{\\mathrm{F}}$: $80 \\ge 50$ 且 $0.9 \\ge 0.7 \\implies \\text{真}$\n  - $D_{\\mathrm{M}}$: $20 < 60 \\implies \\text{假}$\n  - $D_{\\mathrm{C}}$: $10 < 45 \\implies \\text{假}$\n  - 规则 3 适用：$\\hat{y} = \\text{coccus}$。预测正确。\n\n- **基因组 $2$**: $(s_{\\mathrm{F}} = 75, c_{\\mathrm{F}} = 0.95, s_{\\mathrm{M}} = 70, c_{\\mathrm{M}} = 0.9, s_{\\mathrm{C}} = 15, c_{\\mathrm{C}} = 0.4, y = \\text{rod})$\n  - $D_{\\mathrm{F}}$: $75 \\ge 50$ 且 $0.95 \\ge 0.7 \\implies \\text{真}$\n  - $D_{\\mathrm{M}}$: $70 \\ge 60$ 且 $0.9 \\ge 0.6 \\implies \\text{真}$\n  - $D_{\\mathrm{C}}$: $15 < 45 \\implies \\text{假}$\n  - 规则 2 适用：$\\hat{y} = \\text{rod}$。预测正确。\n\n- **基因组 $3$**: $(s_{\\mathrm{F}} = 85, c_{\\mathrm{F}} = 0.8, s_{\\mathrm{M}} = 90, c_{\\mathrm{M}} = 0.7, s_{\\mathrm{C}} = 60, c_{\\mathrm{C}} = 0.8, y = \\text{vibrio})$\n  - $D_{\\mathrm{F}}$: $85 \\ge 50$ 且 $0.8 \\ge 0.7 \\implies \\text{真}$\n  - $D_{\\mathrm{M}}$: $90 \\ge 60$ 且 $0.7 \\ge 0.6 \\implies \\text{真}$\n  - $D_{\\mathrm{C}}$: $60 \\ge 45$ 且 $0.8 \\ge 0.5 \\implies \\text{真}$\n  - 规则 1 适用：$\\hat{y} = \\text{vibrio}$。预测正确。\n\n- **基因组 $4$**: $(s_{\\mathrm{F}} = 70, c_{\\mathrm{F}} = 0.75, s_{\\mathrm{M}} = 60, c_{\\mathrm{M}} = 0.6, s_{\\mathrm{C}} = 30, c_{\\mathrm{C}} = 0.6, y = \\text{rod})$\n  - $D_{\\mathrm{F}}$: $70 \\ge 50$ 且 $0.75 \\ge 0.7 \\implies \\text{真}$\n  - $D_{\\mathrm{M}}$: $60 \\ge 60$ 且 $0.6 \\ge 0.6 \\implies \\text{真}$\n  - $D_{\\mathrm{C}}$: $30 < 45 \\implies \\text{假}$\n  - 规则 2 适用：$\\hat{y} = \\text{rod}$。预测正确。\n\n- **基因组 $5$**: $(s_{\\mathrm{F}} = 65, c_{\\mathrm{F}} = 0.72, s_{\\mathrm{M}} = 59.9, c_{\\mathrm{M}} = 0.8, s_{\\mathrm{C}} = 45, c_{\\mathrm{C}} = 0.49, y = \\text{coccus})$\n  - $D_{\\mathrm{F}}$: $65 \\ge 50$ 且 $0.72 \\ge 0.7 \\implies \\text{真}$\n  - $D_{\\mathrm{M}}$: $59.9 < 60 \\implies \\text{假}$\n  - $D_{\\mathrm{C}}$: $0.49 < 0.5 \\implies \\text{假}$\n  - 规则 3 适用：$\\hat{y} = \\text{coccus}$。预测正确。\n\n- **基因组 $6$**: $(s_{\\mathrm{F}} = 49, c_{\\mathrm{F}} = 0.69, s_{\\mathrm{M}} = 25, c_{\\mathrm{M}} = 0.3, s_{\\mathrm{C}} = 20, c_{\\mathrm{C}} = 0.2, y = \\text{coccus})$\n  - $D_{\\mathrm{F}}$: $49 < 50 \\implies \\text{假}$\n  - $D_{\\mathrm{M}}$: $25 < 60 \\implies \\text{假}$\n  - $D_{\\mathrm{C}}$: $20 < 45 \\implies \\text{假}$\n  - 规则 4 适用（无其他规则匹配）：$\\hat{y} = \\text{unknown}$。预测不正确。\n\n- **基因组 $7$**: $(s_{\\mathrm{F}} = 88, c_{\\mathrm{F}} = 0.9, s_{\\mathrm{M}} = 85, c_{\\mathrm{M}} = 0.95, s_{\\mathrm{C}} = 45, c_{\\mathrm{C}} = 0.5, y = \\text{rod})$\n  - $D_{\\mathrm{F}}$: $88 \\ge 50$ 且 $0.9 \\ge 0.7 \\implies \\text{真}$\n  - $D_{\\mathrm{M}}$: $85 \\ge 60$ 且 $0.95 \\ge 0.6 \\implies \\text{真}$\n  - $D_{\\mathrm{C}}$: $45 \\ge 45$ 且 $0.5 \\ge 0.5 \\implies \\text{真}$\n  - 规则 1 适用：$\\hat{y} = \\text{vibrio}$。预测不正确。\n\n- **基因组 $8$**: $(s_{\\mathrm{F}} = 90, c_{\\mathrm{F}} = 0.9, s_{\\mathrm{M}} = 80, c_{\\mathrm{M}} = 0.7, s_{\\mathrm{C}} = 55, c_{\\mathrm{C}} = 0.49, y = \\text{vibrio})$\n  - $D_{\\mathrm{F}}$: $90 \\ge 50$ 且 $0.9 \\ge 0.7 \\implies \\text{真}$\n  - $D_{\\mathrm{M}}$: $80 \\ge 60$ 且 $0.7 \\ge 0.6 \\implies \\text{真}$\n  - $D_{\\mathrm{C}}$: $0.49 < 0.5 \\implies \\text{假}$\n  - 规则 2 适用：$\\hat{y} = \\text{rod}$。预测不正确。\n\n结果总结如下：\n- 预测值：`coccus`、`rod`、`vibrio`、`rod`、`coccus`、`unknown`、`vibrio`、 `rod`。\n- 真实标签：`coccus`、`rod`、`vibrio`、`rod`、`coccus`、`coccus`、`rod`、 `vibrio`。\n- 正确预测：$8$ 个中有 $5$ 个。\n\n现在，我们计算评估指标。对于每个类别 $k \\in \\{\\text{coccus}, \\text{rod}, \\text{vibrio}\\}$，我们必须确定真阳性 ($TP_k$)、假阳性 ($FP_k$)、真阴性 ($TN_k$) 和假阴性 ($FN_k$) 的数量。\n\n**对于类别 $k=\\text{coccus}$:**\n- 正例（真实标签）：$3$ 个（基因组 $1, 5, 6$）\n- 负例（真实标签）：$5$ 个（基因组 $2, 3, 4, 7, 8$）\n- $TP_{\\text{coccus}}$：预测为 `coccus`，真实标签为 `coccus`。（基因组 $1, 5$）。计数 = $2$。\n- $FP_{\\text{coccus}}$：预测为 `coccus`，真实标签不为 `coccus`。（无）。计数 = $0$。\n- $FN_{\\text{coccus}}$：真实标签为 `coccus`，预测不为 `coccus`。（基因组 $6$，预测为 `unknown`）。计数 = $1$。\n- $TN_{\\text{coccus}}$：真实标签不为 `coccus`，预测不为 `coccus`。（基因组 $2, 3, 4, 7, 8$）。计数 = $5$。\n- 灵敏度：$\\mathrm{Se}_{\\text{coccus}} = \\dfrac{TP_k}{TP_k + FN_k} = \\dfrac{2}{2 + 1} = \\dfrac{2}{3} \\approx 0.667$。\n- 特异度：$\\mathrm{Sp}_{\\text{coccus}} = \\dfrac{TN_k}{TN_k + FP_k} = \\dfrac{5}{5 + 0} = 1.000$。\n\n**对于类别 $k=\\text{rod}$:**\n- 正例（真实标签）：$3$ 个（基因组 $2, 4, 7$）\n- 负例（真实标签）：$5$ 个（基因组 $1, 3, 5, 6, 8$）\n- $TP_{\\text{rod}}$：预测为 `rod`，真实标签为 `rod`。（基因组 $2, 4$）。计数 = $2$。\n- $FP_{\\text{rod}}$：预测为 `rod`，真实标签不为 `rod`。（基因组 $8$，真实标签为 `vibrio`）。计数 = $1$。\n- $FN_{\\text{rod}}$：真实标签为 `rod`，预测不为 `rod`。（基因组 $7$，预测为 `vibrio`）。计数 = $1$。\n- $TN_{\\text{rod}}$：真实标签不为 `rod`，预测不为 `rod`。（基因组 $1, 3, 5, 6$）。计数 = $4$。\n- 灵敏度：$\\mathrm{Se}_{\\text{rod}} = \\dfrac{2}{2 + 1} = \\dfrac{2}{3} \\approx 0.667$。\n- 特异度：$\\mathrm{Sp}_{\\text{rod}} = \\dfrac{4}{4 + 1} = \\dfrac{4}{5} = 0.800$。\n\n**对于类别 $k=\\text{vibrio}$:**\n- 正例（真实标签）：$2$ 个（基因组 $3, 8$）\n- 负例（真实标签）：$6$ 个（基因组 $1, 2, 4, 5, 6, 7$）\n- $TP_{\\text{vibrio}}$：预测为 `vibrio`，真实标签为 `vibrio`。（基因组 $3$）。计数 = $1$。\n- $FP_{\\text{vibrio}}$：预测为 `vibrio`，真实标签不为 `vibrio`。（基因组 $7$，真实标签为 `rod`）。计数 = $1$。\n- $FN_{\\text{vibrio}}$：真实标签为 `vibrio`，预测不为 `vibrio`。（基因组 $8$，预测为 `rod`）。计数 = $1$。\n- $TN_{\\text{vibrio}}$：真实标签不为 `vibrio`，预测不为 `vibrio`。（基因组 $1, 2, 4, 5, 6$）。计数 = $5$。\n- 灵敏度：$\\mathrm{Se}_{\\text{vibrio}} = \\dfrac{1}{1 + 1} = \\dfrac{1}{2} = 0.500$。\n- 特异度：$\\mathrm{Sp}_{\\text{vibrio}} = \\dfrac{5}{5 + 1} = \\dfrac{5}{6} \\approx 0.833$。\n\n**总体准确率:**\n- $\\mathrm{Acc} = \\dfrac{\\text{正确预测的数量}}{\\text{基因组总数}} = \\dfrac{5}{8} = 0.625$。\n\n最终计算出的指标，四舍五入到三位小数，如下所示：\n- $\\mathrm{Se}_{\\text{coccus}} = 0.667$\n- $\\mathrm{Sp}_{\\text{coccus}} = 1.000$\n- $\\mathrm{Se}_{\\text{rod}} = 0.667$\n- $\\mathrm{Sp}_{\\text{rod}} = 0.800$\n- $\\mathrm{Se}_{\\text{vibrio}} = 0.500$\n- $\\mathrm{Sp}_{\\text{vibrio}} = 0.833$\n- $\\mathrm{Acc} = 0.625$\n这些值将以指定的输出格式呈现。", "answer": "$$ \\boxed{[0.667, 1.000, 0.667, 0.800, 0.500, 0.833, 0.625]} $$", "id": "2537467"}]}