{"hands_on_practices": [{"introduction": "在宏基因组学中，准确量化基因丰度是一个主要目标。然而，不同物种间同源基因的存在会导致读段（reads）的模糊比对，从而产生显著的定量偏差。本练习 [@problem_id:2507043] 探讨了一个形式化模型，用于计算仅使用唯一比对读段所引入的残留偏差 $r$，为评估丰度估计的可靠性提供了一个批判性视角。", "problem": "一份微生物组样本包含两种细菌，记为物种 $S_1$ 和物种 $S_2$，其在群落中的 DNA 质量分数分别为 $w_1$ 和 $w_2$。我们对该样本进行了鸟枪法宏基因组测序。考虑一个同时存在于这两个物种中的基因家族 $G$，它在物种 $S_1$ 中有 $c_1$ 个拷贝，在物种 $S_2$ 中有 $c_2$ 个拷贝。基因家族 $G$ 的所有拷贝都具有相同的编码序列长度 $L$。鸟枪法测序的一个标准假设是，测序读段是从核苷酸中均匀随机抽样的，因此源自某一基因座的预期读段数量与该基因座的核苷酸数量及其在混合物中的分子丰度的乘积成正比。使用读段比对软件将其与基因目录进行比对，只有那些能够唯一比对到目录中单个条目的读段才会被保留用于定量分析；而那些能同样好地比对到多个条目的读段则被丢弃。对于物种 $S_i$ 中基因 $G$ 的第 $j$ 个拷贝，我们将唯一可比对分数 $u_i$ 定义为：在该拷贝上进行均匀抽样时，在所使用的比对软件和参考序列下，能够产生唯一可比对读段的位置所占的比例。假设在物种 $S_i$ 内部，所有 $c_i$ 个拷贝的 $u_i$ 值都是相同的。\n\n定义以下量（原始计数除以 $L$ 和总文库大小后，这些归一化步骤会抵消全局尺度因子）：\n- 样本中基因家族 $G$ 的真实归一化丰度 $A_{\\mathrm{true}}$，与总的拷贝数加权群落质量成正比，即假设每个碱基都可唯一比对时的预期归一化读段产量。\n- 观测到的仅唯一比对归一化丰度 $A_{\\mathrm{uniq}}$，与总的拷贝数加权群落质量再乘以唯一可比对分数成正比。\n\n一个标准小组建议分析人员报告一个用于仅唯一比对计数的残差偏倚，其定义为\n$$\nr \\equiv \\frac{A_{\\mathrm{uniq}}}{A_{\\mathrm{true}}} - 1,\n$$\n一个无量纲的量，当仅唯一比对计数低估真实丰度时，该值为负。\n\n给定 $w_1 = 0.7$，$w_2 = 0.3$，$c_1 = 1$，$c_2 = 3$，$u_1 = 0.9$ 和 $u_2 = 0.4$。在上述假设下，计算 $r$。请用小数表示您的答案（而非百分比），并四舍五入到四位有效数字。无需单位。", "solution": "首先对问题陈述进行验证。\n\n给定条件如下：\n- 两个物种，$S_1$ 和 $S_2$。\n- 群落 DNA 质量分数：$w_1 = 0.7$，$w_2 = 0.3$。\n- 基因家族 $G$ 的拷贝数：在 $S_1$ 中为 $c_1 = 1$，在 $S_2$ 中为 $c_2 = 3$。\n- 所有拷贝的基因长度 $L$ 均相同。\n- 唯一可比对分数：$S_1$ 中拷贝为 $u_1 = 0.9$，$S_2$ 中拷贝为 $u_2 = 0.4$。\n- 真实归一化丰度 $A_{\\mathrm{true}}$ 与总的拷贝数加权群落质量成正比。\n- 观测到的仅唯一比对归一化丰度 $A_{\\mathrm{uniq}}$ 与拷贝数加权群落质量乘以唯一可比对分数成正比。\n- 残差偏倚定义为 $r \\equiv \\frac{A_{\\mathrm{uniq}}}{A_{\\mathrm{true}}} - 1$。\n\n该问题是有效的。它在科学上基于宏基因组分析的原理，特别是解决了由非唯一序列读段引起的常见定量偏倚问题。问题表述清晰，为得到唯一解提供了所有必要的定义和数据。其语言客观，设定在其建模框架内具有内部一致性和物理合理性。没有违反科学原理或逻辑矛盾之处。\n\n任务是计算残差偏倚 $r$。首先，我们必须根据给出的定义构建 $A_{\\mathrm{true}}$ 和 $A_{\\mathrm{uniq}}$ 的数学表达式。设 $\\alpha$ 是一个比例常数，它包含了测序深度和其他归一化因子，这两种丰度度量方法都通用此常数。\n\n真实丰度 $A_{\\mathrm{true}}$ 与“总的拷贝数加权群落质量”成正比。每个物种 $S_i$ 的贡献是其质量分数 $w_i$ 乘以该基因家族 $G$ 在此物种中的拷贝数 $c_i$。将两个物种的贡献相加，我们得到：\n$$A_{\\mathrm{true}} = \\alpha (w_1 c_1 + w_2 c_2)$$\n\n观测到的仅唯一比对丰度 $A_{\\mathrm{uniq}}$ 的定义类似，但每个物种的贡献还要额外乘以唯一可比对分数 $u_i$ 进行加权。这反映了只有基因序列的一部分对唯一比对的读段计数有贡献。\n$$A_{\\mathrm{uniq}} = \\alpha (w_1 c_1 u_1 + w_2 c_2 u_2)$$\n\n残差偏倚 $r$ 定义为：\n$$r = \\frac{A_{\\mathrm{uniq}}}{A_{\\mathrm{true}}} - 1$$\n将 $A_{\\mathrm{true}}$ 和 $A_{\\mathrm{uniq}}$ 的表达式代入 $r$ 的定义中，比例常数 $\\alpha$ 被消掉：\n$$r = \\frac{\\alpha (w_1 c_1 u_1 + w_2 c_2 u_2)}{\\alpha (w_1 c_1 + w_2 c_2)} - 1 = \\frac{w_1 c_1 u_1 + w_2 c_2 u_2}{w_1 c_1 + w_2 c_2} - 1$$\n该表达式表明，比率 $\\frac{A_{\\mathrm{uniq}}}{A_{\\mathrm{true}}}$ 是唯一可比对分数 $u_1$ 和 $u_2$ 的加权平均值，其中权重是来自每个物种的基因的真实丰度，$w_1 c_1$ 和 $w_2 c_2$。\n\n现在，我们将给定的数值代入 $r$ 的表达式中：\n$w_1 = 0.7$\n$w_2 = 0.3$\n$c_1 = 1$\n$c_2 = 3$\n$u_1 = 0.9$\n$u_2 = 0.4$\n\n首先，计算分母，它代表了该基因家族的总真实相对丰度：\n$$w_1 c_1 + w_2 c_2 = (0.7)(1) + (0.3)(3) = 0.7 + 0.9 = 1.6$$\n接下来，计算分子，它代表了总的仅唯一比对相对丰度：\n$$w_1 c_1 u_1 + w_2 c_2 u_2 = (0.7)(1)(0.9) + (0.3)(3)(0.4) = 0.63 + 0.36 = 0.99$$\n\n现在，我们可以计算 $r$：\n$$r = \\frac{0.99}{1.6} - 1$$\n进行除法运算：\n$$\\frac{0.99}{1.6} = 0.61875$$\n最后，我们计算 $r$：\n$$r = 0.61875 - 1 = -0.38125$$\n题目要求答案四舍五入到四位有效数字。数字 $3$，$8$，$1$ 和 $2$ 是前四位有效数字。第五位数字是 $5$，因此需要将第四位数字向上取整。\n$$r \\approx -0.3813$$\n负值表示在这种群落中，仅唯一比对的计数方法低估了基因家族 $G$ 的真实丰度。", "answer": "$$\\boxed{-0.3813}$$", "id": "2507043"}, {"introduction": "宏基因组学揭示了微生物群落的遗传潜力，而宏转录组学则衡量其活跃的基因表达。为了从相对丰度转向绝对分子计数，研究人员常使用“峰内”（spike-in）标准品。本实践 [@problem_id:2507273] 将引导您完成从峰内数据推导转换因子 $k$ 并传播相关不确定性的统计过程，这是定量功能分析的一项基本技能。", "problem": "从一个海洋生物膜样本制备了一个宏转录组核糖核酸测序（RNA-seq）文库，在文库构建前，向其中加入了已知绝对分子数的 External RNA Controls Consortium (ERCC) 内参转录本。假设以下基础模型：每个转录本类别 $j$（包括内参和内源转录本）产生的测序读数遵循独立的泊松计数，其均值与输入中的绝对分子数成正比。形式上，对于每个内参 $i$，观测到的比对读数计数 $R_{i}$ 满足 $R_{i} \\sim \\mathrm{Poisson}(k\\, m_{i})$，其中 $m_{i}$ 是内参 $i$ 的已知输入分子数，而 $k$ 是一个样本特异性转换因子（读数/分子）。对于一个目标内源转录本 $t$，观测到的计数 $R_{t}$ 满足 $R_{t} \\sim \\mathrm{Poisson}(k\\, m_{t})$，其中 $m_{t}$ 是该转录本在文库输入中的未知绝对分子数。假设无截距（即，零分子产生零期望读数），并忽略长度或鸟嘌呤-胞嘧啶（GC）偏好。\n\n该文库的数据：\n- 内参 $S_{1}$：$m_{1} = 2.00 \\times 10^{6}$ 分子，观测到 $R_{1} = 19{,}820$ 个读数。\n- 内参 $S_{2}$：$m_{2} = 5.00 \\times 10^{5}$ 分子，观测到 $R_{2} = 4{,}930$ 个读数。\n- 内参 $S_{3}$：$m_{3} = 1.00 \\times 10^{5}$ 分子，观测到 $R_{3} = 1{,}010$ 个读数。\n- 内参 $S_{4}$：$m_{4} = 2.00 \\times 10^{4}$ 分子，观测到 $R_{4} = 210$ 个读数。\n- 目标转录本 $t$：观测到 $R_{t} = 2{,}560$ 个读数。\n\n任务：\n1. 从独立内参的泊松似然和模型 $R_{i} \\sim \\mathrm{Poisson}(k\\, m_{i})$ 出发，推导转换因子 $k$ 的最大似然估计量 $\\hat{k}$ 及其在模型假设下相应的大样本方差 $\\mathrm{Var}(\\hat{k})$。\n2. 将 delta 方法与函数 $f(R,k) = R/k$ 应用于估计量 $\\hat{m}_{t} = R_{t}/\\hat{k}$，推导 $\\mathrm{Var}(\\hat{m}_{t})$ 的一个近似表达式。该表达式需考虑来自 $R_{t}$ 和 $\\hat{k}$ 两者的不确定性，并假设 $R_{t}$ 与内参计数独立。在需要时，使用泊松性质 $\\mathrm{Var}(R) = \\mathbb{E}[R]$ 和代入近似法。\n3. 使用所提供的数据，计算估计的标准不确定度 $\\sqrt{\\widehat{\\mathrm{Var}}(\\hat{m}_{t})}$，单位为拷贝数（分子）。将最终报告值四舍五入至三位有效数字。以拷贝数表示最终答案。", "solution": "所给问题具有科学依据、提法清晰且客观。它呈现了一个定量转录组学中使用外部内参对照的标准问题，该问题基于一个简化但有效的测序计数泊松模型。所有必要的数据和假设均已提供。因此，我将开始解答。\n\n按照要求，问题分三部分解决：推导转换因子 $k$ 的最大似然估计量（MLE）及其方差，推导目标分子数估计值 $\\hat{m}_t$ 的方差，以及计算 $\\hat{m}_t$ 的标准不确定度。\n\n_任务1：推导MLE $\\hat{k}$ 及其方差 $\\mathrm{Var}(\\hat{k})$_\n\n模型指出，对于 $N$ 个独立的内参标准品，观测到的读数计数 $R_i$ 来自泊松分布，$R_i \\sim \\mathrm{Poisson}(\\lambda_i)$，其均值 $\\lambda_i$ 由 $k m_i$ 给出。此处，$m_i$ 是已知的输入分子数，$k$ 是未知的转换因子。似然函数 $L(k)$ 是观测到计数 $\\{R_1, \\dots, R_N\\}$ 的概率之积：\n$$ L(k) = \\prod_{i=1}^{N} P(R_i | k, m_i) = \\prod_{i=1}^{N} \\frac{\\exp(-k m_i) (k m_i)^{R_i}}{R_i!} $$\n为了找到最大似然估计量（MLE），我们最大化对数似然函数 $\\ell(k) = \\ln L(k)$：\n$$ \\ell(k) = \\sum_{i=1}^{N} \\ln\\left( \\frac{\\exp(-k m_i) (k m_i)^{R_i}}{R_i!} \\right) = \\sum_{i=1}^{N} \\left( -k m_i + R_i \\ln(k) + R_i \\ln(m_i) - \\ln(R_i!) \\right) $$\n我们通过将 $\\ell(k)$ 对 $k$ 求导并将结果设为零来找到 MLE $\\hat{k}$：\n$$ \\frac{d\\ell}{dk} = \\sum_{i=1}^{N} \\left( -m_i + \\frac{R_i}{k} \\right) = - \\sum_{i=1}^{N} m_i + \\frac{1}{k} \\sum_{i=1}^{N} R_i $$\n在 $k = \\hat{k}$ 处，令 $\\frac{d\\ell}{dk} = 0$：\n$$ \\frac{1}{\\hat{k}} \\sum_{i=1}^{N} R_i = \\sum_{i=1}^{N} m_i \\implies \\hat{k} = \\frac{\\sum_{i=1}^{N} R_i}{\\sum_{i=1}^{N} m_i} $$\n这个结果是直观的：每个分子的平均读数的最佳估计是来自标准品的总读数除以其总分子数。\n\n接下来，我们求 $\\hat{k}$ 的大样本方差。它由费雪信息 $I(k)$ 的倒数给出。费雪信息为 $I(k) = -\\mathbb{E}\\left[\\frac{d^2\\ell}{dk^2}\\right]$。对数似然的二阶导数是：\n$$ \\frac{d^2\\ell}{dk^2} = \\frac{d}{dk} \\left( - \\sum_{i=1}^{N} m_i + \\frac{1}{k} \\sum_{i=1}^{N} R_i \\right) = -\\frac{1}{k^2} \\sum_{i=1}^{N} R_i $$\n取期望，其中 $\\mathbb{E}[R_i] = k m_i$：\n$$ \\mathbb{E}\\left[\\frac{d^2\\ell}{dk^2}\\right] = -\\frac{1}{k^2} \\sum_{i=1}^{N} \\mathbb{E}[R_i] = -\\frac{1}{k^2} \\sum_{i=1}^{N} (k m_i) = -\\frac{1}{k} \\sum_{i=1}^{N} m_i $$\n因此，费雪信息为：\n$$ I(k) = - \\left( -\\frac{1}{k} \\sum_{i=1}^{N} m_i \\right) = \\frac{1}{k} \\sum_{i=1}^{N} m_i $$\nMLE 的渐近方差为 $\\mathrm{Var}(\\hat{k}) \\approx [I(k)]^{-1}$：\n$$ \\mathrm{Var}(\\hat{k}) = \\frac{k}{\\sum_{i=1}^{N} m_i} $$\n\n_任务2：推导 $\\hat{m}_t$ 的近似方差_\n\n目标转录本绝对分子数 $m_t$ 的估计量由 $\\hat{m}_t = R_t / \\hat{k}$ 给出。这是两个随机变量的函数：目标转录本的读数计数 $R_t$ 和估计的转换因子 $\\hat{k}$。问题指出 $R_t$ 与内参计数独立，因此 $\\hat{k}$（仅为内参计数的函数）也与 $R_t$ 独立。\n我们使用 delta 方法来近似两个独立随机变量之比的方差。对于函数 $f(X,Y) = X/Y$，其方差可近似为：\n$$ \\mathrm{Var}(f(X,Y)) \\approx \\left(\\frac{\\partial f}{\\partial X}\\right)^2 \\mathrm{Var}(X) + \\left(\\frac{\\partial f}{\\partial Y}\\right)^2 \\mathrm{Var}(Y) $$\n其中偏导数在 $X$ 和 $Y$ 的期望值处求值。此处，$X=R_t$ 且 $Y=\\hat{k}$。偏导数是：\n$$ \\frac{\\partial f}{\\partial R_t} = \\frac{1}{\\hat{k}} \\quad \\text{and} \\quad \\frac{\\partial f}{\\partial \\hat{k}} = -\\frac{R_t}{\\hat{k}^2} $$\n期望为 $\\mathbb{E}[R_t] = k m_t$ 和 $\\mathbb{E}[\\hat{k}] = k$。在这些期望值处对导数求值可得：\n$$ \\frac{\\partial f}{\\partial R_t} \\bigg|_{\\mathbb{E}} = \\frac{1}{k} \\quad \\text{and} \\quad \\frac{\\partial f}{\\partial \\hat{k}} \\bigg|_{\\mathbb{E}} = -\\frac{k m_t}{k^2} = -\\frac{m_t}{k} $$\n随机变量的方差为 $\\mathrm{Var}(R_t) = k m_t$（根据泊松性质）和 $\\mathrm{Var}(\\hat{k}) \\approx \\frac{k}{\\sum m_i}$（根据任务1）。将这些代入 delta 方法公式中：\n$$ \\mathrm{Var}(\\hat{m}_t) \\approx \\left(\\frac{1}{k}\\right)^2 \\mathrm{Var}(R_t) + \\left(-\\frac{m_t}{k}\\right)^2 \\mathrm{Var}(\\hat{k}) $$\n$$ \\mathrm{Var}(\\hat{m}_t) \\approx \\frac{1}{k^2} (k m_t) + \\frac{m_t^2}{k^2} \\left( \\frac{k}{\\sum_{i=1}^{N} m_i} \\right) $$\n$$ \\mathrm{Var}(\\hat{m}_t) \\approx \\frac{m_t}{k} + \\frac{m_t^2}{k \\sum_{i=1}^{N} m_i} $$\n该表达式用真实（但未知）的参数表示方差。第一项 $m_t/k$ 源于目标转录本的泊松计数噪声，而第二项源于转换因子 $k$ 估计中的传播不确定度。\n\n_任务3：计算标准不确定度_\n\n为了计算，我们使用方差的代入估计量 $\\widehat{\\mathrm{Var}}(\\hat{m}_t)$，即用估计值 $\\hat{k}$ 和 $\\hat{m}_t$ 替换未知参数 $k$ 和 $m_t$。通过对 $\\hat{m}_t^2$ 进行因式分解，可以得到一个便于计算的形式：\n$$ \\widehat{\\mathrm{Var}}(\\hat{m}_t) \\approx \\frac{\\hat{m}_t}{\\hat{k}} + \\frac{\\hat{m}_t^2}{\\hat{k} \\sum m_i} = \\hat{m}_t^2 \\left( \\frac{1}{\\hat{m}_t \\hat{k}} + \\frac{1}{\\hat{k} \\sum m_i} \\right) $$\n使用定义 $\\hat{m}_t \\hat{k} = R_t$ 和 $\\hat{k} \\sum m_i = \\sum R_i$：\n$$ \\widehat{\\mathrm{Var}}(\\hat{m}_t) \\approx \\hat{m}_t^2 \\left( \\frac{1}{R_t} + \\frac{1}{\\sum_{i=1}^{N} R_i} \\right) $$\n现在，我们代入所提供的数据：\n$R_1 = 19,820$, $R_2 = 4,930$, $R_3 = 1,010$, $R_4 = 210$.\n$m_1 = 2.00 \\times 10^6$, $m_2 = 5.00 \\times 10^5$, $m_3 = 1.00 \\times 10^5$, $m_4 = 2.00 \\times 10^4$.\n$R_t = 2,560$.\n\n首先，我们计算内参的总读数和总分子数：\n$$ \\sum_{i=1}^{4} R_i = 19,820 + 4,930 + 1,010 + 210 = 25,970 $$\n$$ \\sum_{i=1}^{4} m_i = (2.00 \\times 10^6) + (5.00 \\times 10^5) + (1.00 \\times 10^5) + (2.00 \\times 10^4) = 2.62 \\times 10^6 $$\n接下来，我们计算 $k$ 和 $m_t$ 的估计值：\n$$ \\hat{k} = \\frac{\\sum R_i}{\\sum m_i} = \\frac{25,970}{2.62 \\times 10^6} \\approx 0.0099122 \\text{ 读数/分子} $$\n$$ \\hat{m}_t = \\frac{R_t}{\\hat{k}} = \\frac{2,560}{0.0099122} \\approx 258,266 \\text{ 分子} $$\n现在我们使用方差的计算公式：\n$$ \\widehat{\\mathrm{Var}}(\\hat{m}_t) \\approx (\\hat{m}_t)^2 \\left( \\frac{1}{R_t} + \\frac{1}{\\sum R_i} \\right) = (258,266)^2 \\left( \\frac{1}{2,560} + \\frac{1}{25,970} \\right) $$\n$$ \\widehat{\\mathrm{Var}}(\\hat{m}_t) \\approx (6.6701 \\times 10^{10}) \\left( \\frac{1}{2,560} + \\frac{1}{25,970} \\right) $$\n$$ \\widehat{\\mathrm{Var}}(\\hat{m}_t) \\approx (6.6701 \\times 10^{10}) (3.90625 \\times 10^{-4} + 3.8506 \\times 10^{-5}) $$\n$$ \\widehat{\\mathrm{Var}}(\\hat{m}_t) \\approx (6.6701 \\times 10^{10}) (4.29131 \\times 10^{-4}) \\approx 2.8623 \\times 10^7 \\text{ 分子}^2 $$\n估计的标准不确定度是该方差的平方根：\n$$ \\sqrt{\\widehat{\\mathrm{Var}}(\\hat{m}_t)} \\approx \\sqrt{2.8623 \\times 10^7} \\approx 5350.05 \\text{ 分子} $$\n四舍五入到三位有效数字，标准不确定度为 $5.35 \\times 10^3$ 拷贝数。", "answer": "$$\\boxed{5.35 \\times 10^3}$$", "id": "2507273"}, {"introduction": "宏蛋白质组学直接观察微生物群落的蛋白质机器，但从复杂的质谱图中鉴定肽段是一个在噪声中寻找信号的问题。控制假发现率（False Discovery Rate, FDR）对于得出可靠的科学结论至关重要。这个问题 [@problem_id:2507151] 要求您在一个常用的统计框架内，从第一性原理出发推导 $\\mathrm{FDR}(s)$，从而巩固您对肽段鉴定中如何严格建立置信度的理解。", "problem": "在鸟枪法宏蛋白质组学中，肽谱匹配 (PSM) 打分用于区分正确和错误的鉴定结果。考虑一个使用一对一目标-诱饵策略进行的数据库搜索，其中 PSM 分数（记为 $S \\ge 0$）被建模为两个分数分布的混合模型：一个代表错误匹配的空成分和一个代表正确匹配的备择成分。假设以下经过充分检验且常用的建模假设：\n- 一个 PSM 是错误的（空假设）的先验概率为 $\\pi_{0}$，其是正确的先验概率为 $1 - \\pi_{0}$。\n- 在匹配错误的情况下，分数服从率参数为 $\\lambda_{0}$ 的指数分布，因此 $P_{0}(S \\ge s) = \\exp(-\\lambda_{0} s)$。\n- 在匹配正确的情况下，分数服从率参数为 $\\lambda_{1}$ 的指数分布，且 $\\lambda_{0} > \\lambda_{1} > 0$，因此 $P_{1}(S \\ge s) = \\exp(-\\lambda_{1} s)$。\n\n从第一性原理出发，使用在分数阈值 $s$ 处的假发现率 (FDR) 的定义，即在所有 $S \\ge s$ 的 PSM 中错误匹配的期望比例，推导出 $\\mathrm{FDR}(s)$ 关于 $\\pi_{0}$、$\\lambda_{0}$、$\\lambda_{1}$ 和 $s$ 的表达式。然后，使用 q 值的定义，即给定一个 PSM 被判为显著时的最小 FDR，为以下 PSM 分数集计算 q 值：\n- $s \\in \\{3.0, 4.0, 5.0, 6.0, 7.5, 9.0\\}$。\n\n使用参数值 $\\pi_{0} = 0.8$、$\\lambda_{0} = 1.2$ 和 $\\lambda_{1} = 0.4$。最后，确定最小分数阈值 $s^{\\star}$，使得在该阈值下的期望 FDR 等于 $0.01$（即 1% 的假发现率）。将最终阈值四舍五入至四位有效数字，并以分数单位（无量纲）表示。最终答案必须是单个实数。", "solution": "在尝试任何解答之前，需要对问题陈述进行严格的验证过程。\n\n首先，逐字提取所有提供的信息。\n已知条件：\n1.  分数变量为 $S \\ge 0$。\n2.  该模型是两个成分的混合模型：空成分（错误）和备择成分（正确）。\n3.  错误匹配的先验概率为 $\\pi_{0}$。\n4.  正确匹配的先验概率为 $1 - \\pi_{0}$。\n5.  错误匹配的分数分布由生存函数 $P_{0}(S \\ge s) = \\exp(-\\lambda_{0} s)$ 描述，对应于率参数为 $\\lambda_{0}$ 的指数分布。\n6.  正确匹配的分数分布由生存函数 $P_{1}(S \\ge s) = \\exp(-\\lambda_{1} s)$ 描述，对应于率参数为 $\\lambda_{1}$ 的指数分布。\n7.  给定率参数的约束条件：$\\lambda_{0} > \\lambda_{1} > 0$。\n8.  假发现率 $\\mathrm{FDR}(s)$ 定义为“所有 $S \\ge s$ 的 PSM 中错误匹配的期望比例”。\n9.  q 值定义为“给定一个 PSM 被判为显著时的最小 FDR”。\n10. 提供了具体的参数值：$\\pi_{0} = 0.8$、$\\lambda_{0} = 1.2$ 和 $\\lambda_{1} = 0.4$。\n11. 给定了一组用于计算 q 值的 PSM 分数：$s \\in \\{3.0, 4.0, 5.0, 6.0, 7.5, 9.0\\}$。\n12. 最终任务是找到最小分数阈值 $s^{\\star}$，使得 $\\mathrm{FDR}(s^{\\star}) = 0.01$。结果必须四舍五入至四位有效数字。\n\n接下来，根据科学合理性、客观性和良置性标准对问题进行验证。\n- **科学依据**：该问题使用了在计算蛋白质组学和生物信息学中普遍应用的标准混合模型框架，用于肽谱匹配的打分和统计验证。使用指数分布对分数分布进行建模、目标-诱饵策略概念以及 FDR 和 q 值的定义都是该领域中既定且基础的内容。条件 $\\lambda_{0} > \\lambda_{1}$ 正确地建模了所期望的行为，即错误匹配（空假设）的平均分数低于正确匹配（备择假设）的平均分数。\n- **良置性与完整性**：该问题在数学上是良置的。所有必要的参数（$\\pi_{0}$、$\\lambda_{0}$、$\\lambda_{1}$）、定义（FDR、q 值）以及分布的函数形式都已明确给出。提供的数值（$\\pi_{0} = 0.8$、$\\lambda_{0} = 1.2$、$\\lambda_{1} = 0.4$）与约束条件（$\\lambda_{0} > \\lambda_{1} > 0$）一致。任务清晰，并能导出一个唯一的、可推导的解。\n- **客观性**：问题以精确、定量的语言陈述，没有歧义、主观性或非科学论断。\n\n结论：该问题科学合理、自洽且良置。它不违反任何无效标准。我们可以继续进行解答。\n\n按要求从第一性原理构建解决方案。\n\n**第一部分：FDR 表达式的推导**\n在分数阈值 $s$ 处的假发现率 $\\mathrm{FDR}(s)$，是指在一个 PSM 的分数 $S$ 大于或等于 $s$ 的条件下，该 PSM 是错误的条件概率。这可以用贝叶斯定理正式写为：\n$$ \\mathrm{FDR}(s) = P(\\text{incorrect} | S \\ge s) = \\frac{P(S \\ge s | \\text{incorrect}) \\cdot P(\\text{incorrect})}{P(S \\ge s)} $$\n该表达式的各组成部分由已知条件确定。\n一个错误匹配的先验概率为 $P(\\text{incorrect}) = \\pi_{0}$。\n对于一个错误匹配，观察到分数 $S \\ge s$ 的条件概率是 $P(S \\ge s | \\text{incorrect}) = P_{0}(S \\ge s) = \\exp(-\\lambda_{0} s)$。\n因此，分子是 $\\pi_{0} \\exp(-\\lambda_{0} s)$。\n\n分母 $P(S \\ge s)$ 是分数大于或等于 $s$ 的总概率，通过全概率定律求得：\n$$ P(S \\ge s) = P(S \\ge s | \\text{incorrect})P(\\text{incorrect}) + P(S \\ge s | \\text{correct})P(\\text{correct}) $$\n使用所给的定义：\n$$ P(S \\ge s) = \\exp(-\\lambda_{0} s) \\cdot \\pi_{0} + \\exp(-\\lambda_{1} s) \\cdot (1 - \\pi_{0}) $$\n将这些组合起来，$\\mathrm{FDR}(s)$ 的表达式为：\n$$ \\mathrm{FDR}(s) = \\frac{\\pi_{0} \\exp(-\\lambda_{0} s)}{\\pi_{0} \\exp(-\\lambda_{0} s) + (1 - \\pi_{0}) \\exp(-\\lambda_{1} s)} $$\n\n**第二部分：q 值的计算**\n对于一个给定的观测分数 $s_{\\text{obs}}$，其 q 值是在该 PSM 被判为显著时的最小 FDR。如果在阈值 $s_{\\text{thr}}$ 下，$s_{\\text{obs}} \\ge s_{\\text{thr}}$，则该 PSM 被判为显著。因此，使该 PSM 被判为显著的阈值集合是 $\\{s_{\\text{thr}} | s_{\\text{thr}} \\le s_{\\text{obs}}\\}$。q 值是 FDR 在此阈值集合上的最小值：\n$$ q(s_{\\text{obs}}) = \\min_{s_{\\text{thr}} \\le s_{\\text{obs}}} \\mathrm{FDR}(s_{\\text{thr}}) $$\n为了评估这一点，我们必须确定 $\\mathrm{FDR}(s)$ 的单调性。让我们通过将分子和分母同除以 $\\exp(-\\lambda_{1} s)$ 来重写表达式：\n$$ \\mathrm{FDR}(s) = \\frac{\\pi_{0} \\exp(-(\\lambda_{0} - \\lambda_{1}) s)}{\\pi_{0} \\exp(-(\\lambda_{0} - \\lambda_{1}) s) + (1 - \\pi_{0})} = \\frac{\\pi_{0}}{\\pi_{0} + (1 - \\pi_{0}) \\exp((\\lambda_{0} - \\lambda_{1}) s)} $$\n鉴于 $\\lambda_{0} > \\lambda_{1}$，项 $\\lambda_{0} - \\lambda_{1}$ 是正的。因此，对于 $s \\ge 0$，$\\exp((\\lambda_{0} - \\lambda_{1}) s)$ 是 $s$ 的一个严格递增函数。因此，分母是严格递增的，并且由于分子是一个正常数，$\\mathrm{FDR}(s)$ 是 $s$ 的一个严格递减函数。\n因为 $\\mathrm{FDR}(s)$ 是递减的，对于 $s_{\\text{thr}} \\le s_{\\text{obs}}$，$\\mathrm{FDR}(s_{\\text{thr}})$ 的最小值出现在区间的右边界，即 $s_{\\text{thr}} = s_{\\text{obs}}$。\n因此，对于此模型，q 值就是 FDR 在该分数本身处的值：\n$$ q(s) = \\mathrm{FDR}(s) $$\n使用提供的参数 $\\pi_{0} = 0.8$、$\\lambda_{0} = 1.2$ 和 $\\lambda_{1} = 0.4$：\n$$ \\mathrm{FDR}(s) = \\frac{0.8 \\exp(-1.2 s)}{0.8 \\exp(-1.2 s) + 0.2 \\exp(-0.4 s)} = \\frac{4 \\exp(-1.2 s)}{4 \\exp(-1.2 s) + \\exp(-0.4 s)} = \\frac{4 \\exp(-0.8 s)}{4 \\exp(-0.8 s) + 1} = \\frac{4}{4 + \\exp(0.8 s)} $$\n给定分数 $s \\in \\{3.0, 4.0, 5.0, 6.0, 7.5, 9.0\\}$ 的 q 值使用此公式计算。例如，对于 $s = 3.0$：\n$$ q(3.0) = \\mathrm{FDR}(3.0) = \\frac{4}{4 + \\exp(0.8 \\times 3.0)} = \\frac{4}{4 + \\exp(2.4)} \\approx 0.2662 $$\n其他值将以类似方式计算。\n\n**第三部分：分数阈值 $s^{\\star}$ 的确定**\n问题要求找到分数阈值 $s^{\\star}$，使得 FDR 等于 $0.01$。我们建立方程：\n$$ \\mathrm{FDR}(s^{\\star}) = 0.01 $$\n使用推导出的公式和指定的参数：\n$$ \\frac{4}{4 + \\exp(0.8 s^{\\star})} = 0.01 $$\n我们求解 $s^{\\star}$：\n$$ 4 = 0.01 \\cdot (4 + \\exp(0.8 s^{\\star})) $$\n$$ 400 = 4 + \\exp(0.8 s^{\\star}) $$\n$$ 396 = \\exp(0.8 s^{\\star}) $$\n对两边取自然对数得到：\n$$ \\ln(396) = 0.8 s^{\\star} $$\n分离出 $s^{\\star}$：\n$$ s^{\\star} = \\frac{\\ln(396)}{0.8} $$\n现在，我们计算数值。\n$$ s^{\\star} = \\frac{5.9814139...}{0.8} \\approx 7.476767... $$\n四舍五入到四位有效数字，我们得到 $s^{\\star} = 7.477$。由于 $\\mathrm{FDR}(s)$ 是严格单调的，这个解是唯一的，因此是满足条件的最小阈值。", "answer": "$$\\boxed{7.477}$$", "id": "2507151"}]}