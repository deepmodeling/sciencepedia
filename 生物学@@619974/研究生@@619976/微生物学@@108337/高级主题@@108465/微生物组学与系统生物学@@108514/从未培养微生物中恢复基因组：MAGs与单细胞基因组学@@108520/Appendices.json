{"hands_on_practices": [{"introduction": "在我们从复杂的微生物群落中重建出宏基因组组装基因组（MAG）后，首要且关键的一步是评估其质量。本练习将引导您应用最核心的质量控制方法：利用一组在特定谱系中保守的单拷贝标记基因来估算基因组的完整性（completeness）和污染度（contamination）。通过这个实践 [@problem_id:2495840]，您将掌握从基因计数数据中推导出这些关键指标的基本技能，这是评估任何重建基因组质量的基石。", "problem": "一个宏基因组组装基因组（MAG）的质量通过一套谱系特异性的单拷贝标记基因进行评估。假设该谱系预期的单拷贝标记基因数量为 $m = 120$。在某个特定的 MAG 中，检测到了 $u = 92$ 个不同的标记基因（每个标记基因最多计数一次），并且发现其中 $d = 6$ 个检测到的标记基因存在重复，每次重复对应着在预期的单拷贝之外恰好增加一个拷贝（也就是说，这 $d$ 个标记基因的总拷贝数为 2）。\n\n仅使用以下基本定义：(i) 完整度是存在的预期单拷贝标记基因的比例，(ii) 污染度是额外拷贝的单拷贝标记基因相对于预期数量的比例，推导完整度的估计量 $\\hat{c}$ 和污染度的估计量 $\\hat{t}$，用 $m$、$u$ 和额外拷贝数表示。然后，使用 $m = 120$，$u = 92$ 以及额外拷贝数等于 $d = 6$ 的值来计算这些估计量。在推导过程中，从定义出发，并为形成估计量的每一步提供理由。基于第一性原理，简要讨论在简单的标记基因检测抽样模型下，标记基因集有限的大小 $m$ 和重复的低计数如何影响这些估计值的置信度。\n\n将 $\\hat{c}$ 和 $\\hat{t}$ 的最终数值报告为保留四位有效数字的小数。不要报告单位或百分比。将最终数值答案以行向量 $\\bigl[\\hat{c}, \\hat{t}\\bigr]$ 的形式呈现。", "solution": "所述问题具有科学依据，提法得当，并包含足够信息以获得唯一解。我们将按要求进行推导和分析。\n\n任务是根据一组给定的定义和参数，推导完整度（$\\hat{c}$）和污染度（$\\hat{t}$）的估计量，对它们进行数值计算，并讨论这些估计值的统计置信度。给定参数如下：预期的单拷贝标记基因数量为 $m = 120$；检测到的独特标记基因数量为 $u = 92$；发现恰好有一个额外拷贝的标记基因数量为 $d = 6$。\n\n首先，我们推导完整度的估计量 $\\hat{c}$。提供的定义是“完整度是存在的预期单拷贝标记基因的比例”。预期的单拷贝标记基因总数为 $m$。在宏基因组组装基因组（MAG）中存在（即被检测到）的这些标记基因的数量为 $u$。因此，估计量 $\\hat{c}$ 是找到的独特标记基因数量与谱系特异性基因集中标记基因总数的比率。\n$$\n\\hat{c} = \\frac{u}{m}\n$$\n该估计量代表了在 MAG 中成功回收的参考标记基因集的比例。\n\n其次，我们推导污染度的估计量 $\\hat{t}$。定义是“污染度是额外拷贝的单拷贝标记基因相对于预期数量的比例”。问题指出，有 $d$ 个重复的标记基因，每个都“恰好有一个额外拷贝”。因此，“额外拷贝”的总数等于 $d$。定义指明这个比例是“相对于预期数量”。问题中定义的唯一相关的“预期数量”是 $m$，即标记基因集的大小。因此，估计量 $\\hat{t}$ 是额外拷贝数与预期标记基因总数的比率。\n$$\n\\hat{t} = \\frac{d}{m}\n$$\n该公式衡量了基于重复的污染水平，并由作为基因组代理的标记基因集的大小进行归一化。\n\n现在，我们将给定的数值代入这些估计量。参数为 $m = 120$，$u = 92$，$d = 6$。\n对于完整度 $\\hat{c}$：\n$$\n\\hat{c} = \\frac{92}{120} = \\frac{23}{30} = 0.7666\\overline{6}\n$$\n四舍五入到四位有效数字，其值为 $\\hat{c} \\approx 0.7667$。\n\n对于污染度 $\\hat{t}$：\n$$\n\\hat{t} = \\frac{6}{120} = \\frac{1}{20} = 0.05\n$$\n用四位有效数字表示，该值为 $0.05000$。\n\n最后，我们从第一性原理出发，讨论这些估计值的置信度。值 $\\hat{c}$ 和 $\\hat{t}$ 是从样本中得出的点估计，并会受到统计误差的影响。\n\n完整度估计值 $\\hat{c}$ 的置信度由标记基因集的大小 $m$ 决定。我们可以将每个标记基因的观测建模为独立的伯努利试验，其中成功（检测到）的概率是真实的完整度 $p_c$。因此，检测到的标记基因数量 $u$ 服从二项分布，$u \\sim \\text{Binomial}(m, p_c)$。估计量 $\\hat{c} = u/m$ 是标准的样本比例。该估计的不确定性由其标准误量化，即 $\\text{SE}(\\hat{c}) = \\sqrt{\\frac{p_c(1-p_c)}{m}}$，其估计值为 $\\sqrt{\\frac{\\hat{c}(1-\\hat{c})}{m}}$。标准误与样本大小的平方根 $\\sqrt{m}$ 成反比。当 $m=120$ 时，标记基因集的大小是有限的，这引入了切实存在但不算过度的不确定性。更大的 $m$ 会产生更小的标准误，从而得到更窄的置信区间，表示更高的置信度。\n\n污染度估计值 $\\hat{t}$ 的置信度受到观测到的重复事件数量过低（$d=6$）的严重影响。重复的发生可以被建模为稀有事件，因此计数 $d$ 可以被视为来自一个具有未知真实平均率 $\\lambda$ 的泊松分布的观测值。污染度估计值为 $\\hat{t} = d/m$。$\\hat{t}$ 不确定性的主要来源是计数 $d$ 的随机性。对于小的整数计数，泊松分布是高度偏斜的，其均值的置信区间相对于观测值而言很宽。对于 $d=6$ 的观测值，重复数的真实均值的 $95\\%$ 置信区间大约为 $[2.2, 13.1]$。额外拷贝数的基础计数中的这种巨大不确定性直接传递给污染度估计值 $\\hat{t}$，导致一个非常宽的置信区间。因此，基于少量重复事件的污染度估计被认为具有较低的统计置信度。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.7667 & 0.05000 \\end{pmatrix}}\n$$", "id": "2495840"}, {"introduction": "虽然单拷贝标记基因是评估基因组质量的强大工具，但标准的分析流程并非万无一失。一个常见的陷阱是，某些被错误地假设为单拷贝的基因（如rRNA基因）在特定生物体中天然存在多个拷贝，这会导致污染度被高估。本练习 [@problem_id:2495922] 介绍了一种重要的修正方法，即利用测序深度（coverage）信息来估算基因的真实拷贝数，并据此校正污染度评分，从而实现更精确的基因组质量评估。", "problem": "一个从一种未培养细菌中回收的单细胞扩增基因组 (SAG)，使用常用于宏基因组组装基因组 (MAGs) 的单拷贝标记基因框架进行了评估。此类框架通过量化每个基因组中预期单拷贝存在的基因的额外拷贝数，并根据标记基因集的大小进行归一化，来推断污染程度。鸟枪法测序中一个经过充分验证的观察结果是，在均匀采样且无位点特异性偏好的情况下，读长深度（覆盖度）与潜在的DNA拷贝数成正比。核糖体RNA (rRNA) 操纵子是少数经常为多拷贝的细菌位点之一，因此将rRNA基因包含在单拷贝标记基因集中会夸大表观污染程度。\n\n考虑一个大小为 $S = 57$ 个位点的标记基因集，该基因集（对于该分类单元而言是错误地）将 $16\\mathrm{S}$、$23\\mathrm{S}$ 和 $5\\mathrm{S}$ rRNA基因作为单拷贝标记基因包含在内。对于所讨论的SAG，测量了以下数据：\n- 观测到的独特标记基因数量（不考虑拷贝数的存在性）：$U = 50$。\n- 观测到的标记基因实例总数（计算重复拷贝）：$T = 60$。\n- 一组确认为单拷贝的管家基因的中位覆盖度：$m_{c} = 21$。\n- 三个rRNA基因的中位覆盖度：$m_{16\\mathrm{S}} = 66$， $m_{23\\mathrm{S}} = 62$， $m_{5\\mathrm{S}} = 59$。\n\n假设以下基本依据：\n- 从单拷贝标记基因推断的污染源于超出单个拷贝的额外拷贝，其程度与这些额外拷贝的总数经标记基因集大小归一化后的值成正比。\n- 对于拷贝数为 $c$ 的一类位点，其预期覆盖度与真实单拷贝位点覆盖度的 $c$ 倍成比例，因此拷贝数可以估计为该类位点特异性覆盖度与单拷贝覆盖度之比的最接近整数。\n\n使用这些基本依据，推导一个校正程序，该程序：\n- 通过将rRNA中位覆盖度与 $m_{c}$ 之比四舍五入到最接近的整数，从来估计rRNA操纵子拷贝数 $\\hat{c}$。\n- 在用 $S$进行归一化之前，从总重复计数中减去仅由多拷贝rRNA基因导致的预期额外计数。\n\n将此程序应用于以上数据，以小数形式计算校正后的污染估计值。将您的最终答案四舍五入至四位有效数字，并以纯数字形式报告，不带百分号。", "solution": "所提出的问题是一个定量基因组学中的计算，具体要求对单细胞扩增基因组 (SAG) 的污染估计值进行校正。该问题具有科学依据且提法明确，为解决问题提供了所有必要的数据和清晰的逻辑步骤。现在，我们来执行此程序。\n\n首先，我们必须正式陈述问题中给出的参数：\n- 标记基因集的大小，$S = 57$。\n- 检测到的独特标记基因数量，$U = 50$。\n- 检测到的标记基因实例总数（计算所有拷贝），$T = 60$。\n- 一组已确认的单拷贝基因的中位覆盖度，$m_{c} = 21$。\n- 三个被错误地包含为单拷贝标记基因的特定核糖体RNA (rRNA) 基因的中位覆盖度：$m_{16\\mathrm{S}} = 66, m_{23\\mathrm{S}} = 62$, and $m_{5\\mathrm{S}} = 59$。\n\n污染通常通过观测到的重复标记基因数量除以标记基因集的大小进行归一化来量化。观测到的重复总数，我们将其表示为 $D_{obs}$，是找到的总实例数与独特基因数之间的差值。\n$$D_{obs} = T - U = 60 - 50 = 10$$\n这个观测到的计数包括来自真实污染的重复，以及来自该生物体自身多拷贝基因的表观重复。任务是校正后者。\n\n校正程序始于估计rRNA操纵子的拷贝数 $\\hat{c}$。这一估计的基础是测序覆盖度与潜在DNA序列的拷贝数成正比的原理。我们必须首先确定rRNA基因的代表性覆盖度。问题指定使用三个测量的rRNA基因覆盖度的中位数。设此值为 $m_{rRNA, med}$。\n$$m_{rRNA, med} = \\operatorname{median}(\\{59, 62, 66\\}) = 62$$\n然后通过计算该rRNA中位覆盖度与基线单拷贝覆盖度 $m_c$ 之比，并取最接近的整数，来估计拷贝数 $\\hat{c}$。\n$$\\hat{c} = \\operatorname{round}\\left(\\frac{m_{rRNA, med}}{m_c}\\right) = \\operatorname{round}\\left(\\frac{62}{21}\\right) \\approx \\operatorname{round}(2.95238) = 3$$\n这个结果表明，该生物体中的rRNA基因大约存在 $3$ 个拷贝。\n\n接下来，我们计算这些多拷贝rRNA基因预期产生的重复基因计数。标记基因集包含 $3$ 个rRNA基因，每个都被错误地假定为单拷贝。根据估计的拷贝数 $\\hat{c}=3$，这些基因中的每一个预期有 $\\hat{c} - 1$ 个额外拷贝，即重复。\n每个rRNA基因贡献的重复数是：\n$$d_{per\\_rRNA} = \\hat{c} - 1 = 3 - 1 = 2$$\n由于标记基因集中有 $3$ 个这样的rRNA位点（$16\\mathrm{S}$、$23\\mathrm{S}$、$5\\mathrm{S}$），源于它们的预期重复总数 $D_{rRNA}$ 便是：\n$$D_{rRNA} = 3 \\times d_{per\\_rRNA} = 3 \\times 2 = 6$$\n\n现在，我们可以计算校正后的重复数 $D_{adj}$。这是通过从观测到的重复总数中减去归因于多拷贝rRNA基因的重复数来实现的。剩余部分代表了更可能源于真实基因组污染的重复。\n$$D_{adj} = D_{obs} - D_{rRNA} = 10 - 6 = 4$$\n\n最后，通过将这个校正后的重复计数除以标记基因集的总大小 $S$ 进行归一化，来计算校正后的污染估计值 $C_{adj}$。这符合所提供的污染定义。\n$$C_{adj} = \\frac{D_{adj}}{S} = \\frac{4}{57}$$\n为满足题目要求，此分数必须表示为小数并四舍五入到四位有效数字。\n$$C_{adj} = \\frac{4}{57} \\approx 0.070175438...$$\n将此值四舍五入到四位有效数字，得到：\n$$C_{adj} \\approx 0.07018$$\n这就是最终的校正后污染估计值。", "answer": "$$\\boxed{0.07018}$$", "id": "2495922"}, {"introduction": "一个高质量的基因组组装依赖于充分的测序数据，但“充分”究竟意味着什么？本练习将视角从组装后的评估转向测序过程的理论基础。通过一个基于经典的Lander-Waterman模型的思想实验 [@problem_id:2495881]，您将从第一性原理出发，建立测序深度 $C$ 与基因组未被覆盖部分（即不完整性）之间的数学关系，深刻理解为何深度测序是获得完整基因组的理论保障。", "problem": "从一个复杂群落中恢复的一个宏基因组组装基因组 (MAG) 估计其单倍体基因组大小为 $G=5\\times 10^{6}$ 个碱基对 (bp)。一次测序运行产生了 $N=5\\times 10^{7}$ 条独立的鸟枪法读段，每条长度为 $L=150$ bp。这些读段源自单细胞基因组学工作流程，为进行此计算，假定扩增偏倚可以忽略不计。假设一个理想化的均匀随机鸟枪模型：读段在环状基因组上均匀随机地开始，读段的起始位置是独立的，并且由于 $L \\ll G$，边缘效应可以忽略不计。\n\n仅从以下两点出发：(i) 测序深度（也称覆盖度）的定义，即测序总碱基数除以基因组大小；以及 (ii) 每个碱基的覆盖次数是由许多独立的稀有事件产生的假设，推导出组装MAG中未被覆盖的碱基的期望分数。然后，计算：\n\n- 平均覆盖度 $C$。\n- 在碱基覆盖度的理想化泊松模型下，基因组未被覆盖的期望分数。\n\n将期望的未覆盖分数表示为小数或精确表达式。将这两个值报告为无量纲量。除非为了表示无法以精确形式表达的常数，否则不要四舍五入。", "solution": "首先将对问题进行严格验证。只有在确认其有效性后，才会尝试求解。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n已知条件逐字从问题陈述中提取如下：\n- 单倍体基因组大小：$G=5\\times 10^{6}$ bp\n- 鸟枪法读段总数：$N=5\\times 10^{7}$\n- 读段长度：$L=150$ bp\n- 假设1：测序运行来自单细胞基因组学工作流程，其中扩增偏倚被假定为可以忽略不计。\n- 假设2：假定一个理想化的均匀随机鸟枪模型。\n- 假设3：读段在环状基因组上均匀随机地开始。\n- 假设4：读段的起始位置是独立的。\n- 假设5：由于 $L \\ll G$，边缘效应可以忽略不计。\n- 任务1：从测序深度的定义和许多独立稀有事件的假设出发，推导出未被覆盖的碱基的期望分数。\n- 任务2：计算平均覆盖度 $C$。\n- 任务3：在碱基覆盖度的理想化泊松模型下，计算基因组未被覆盖的期望分数。\n\n**步骤2：使用提取的已知条件进行验证**\n\n根据既定标准对问题进行评估：\n- **科学依据充分**：该问题是 Lander-Waterman 模型的直接应用，该模型是基因组学和生物信息学中用于描述测序覆盖度的基础概念。诸如读段的均匀随机分布和覆盖深度的泊松模型等假设，在此背景下是标准的理想化处理。所提供的基因组大小（$G$）、读段数量（$N$）和读段长度（$L$）的数值在现代测序实验的实际范围内。\n- **提法明确**：问题陈述清晰，提供了推导和计算所要求数量的所有必要参数和假设。存在唯一、稳定且有意义的解。\n- **客观性**：问题使用精确的科学语言表述，没有主观性或模糊性。\n\n该问题未违反任何无效性标准。它在科学上是合理的、自洽的且客观的。条件 $L \\ll G$（$150 \\ll 5 \\times 10^6$）成立，这证明了所陈述的可忽略边缘效应的假设是合理的。\n\n**步骤3：结论与行动**\n\n问题被判定为**有效**。现在将提供一个完整的、有理有据的解答。\n\n### 解题推导\n\n该问题要求从第一性原理出发，推导未覆盖碱基的期望分数，然后计算该分数和平均覆盖度。\n\n首先，我们讨论平均覆盖度（记为 $C$）的定义和计算。问题陈述将测序深度（覆盖度）定义为测序总碱基数除以基因组大小。\n\n测序的总碱基数是读段数量 $N$ 与每个读段长度 $L$ 的乘积。\n$$\n\\text{测序总碱基数} = N \\times L\n$$\n\n基因组大小给定为 $G$。因此，平均覆盖度 $C$ 为：\n$$\nC = \\frac{N \\times L}{G}\n$$\n\n接下来，我们推导基因组中未被覆盖部分的期望分数。推导必须从“许多独立的稀有事件”这一前提出发，这是泊松分布的经典基础。\n\n考虑基因组中的任意单个碱基。我们希望求出该碱基未被任何一条测序读段覆盖的概率。\n\n一条长度为 $L$ 的读段要覆盖一个特定碱基，其起始位置必须落在以该碱基为终点、长度为 $L$ 的基因组窗口内。给定一个大小为 $G$ 的环状基因组，并假设读段起始位置是均匀随机的，那么单条随机选择的读段覆盖这个特定碱基的概率 $p$ 是这个目标窗口的长度与总基因组大小的比值：\n$$\np = \\frac{L}{G}\n$$\n\n由于读段是独立的，被一条读段覆盖的事件与被另一条读段覆盖的事件是独立的。因此，单条读段*不*覆盖该特定碱基的概率是 $1-p$。\n$$\n1-p = 1 - \\frac{L}{G}\n$$\n\n总共有 $N$ 条独立的读段。这 $N$ 条读段*均未*覆盖该特定碱基的概率是每条读段相应概率的乘积：\n$$\nP(\\text{碱基未被覆盖}) = (1 - p)^N = \\left(1 - \\frac{L}{G}\\right)^N\n$$\n\n该表达式给出了在二项分布框架下的精确概率，其中每个读段都是一次伯努利试验。然而，问题要求我们使用“许多独立的稀有事件”的假设，这引出了泊松近似。在我们的情况下，试验次数 $N$ 非常大（$5 \\times 10^7$），而成功概率 $p$ 非常小（$p = 150 / (5 \\times 10^6) = 3 \\times 10^{-5}$），这正是二项分布收敛于泊松分布的精确条件。\n\n设随机变量 $K$ 为一个碱基被覆盖的次数。$K$ 服从二项分布 $B(N, p)$。$K$ 的期望值，记为 $\\lambda$，是：\n$$\n\\lambda = N \\times p = N \\frac{L}{G}\n$$\n这个参数 $\\lambda$ 与我们之前定义的平均覆盖度 $C$ 是相同的。\n$$\n\\lambda = C\n$$\n\n当 $N$ 很大且 $p$ 很小时，二项分布 $B(N, p)$ 的概率质量函数可以用均值为 $\\lambda = Np$ 的泊松分布来近似。在泊松分布中，观测到 $k$ 次事件的概率是：\n$$\nP(K=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}\n$$\n\n我们关心的是碱基未被覆盖的情况，这对应于 $k=0$。\n$$\nP(K=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\frac{1 \\cdot \\exp(-\\lambda)}{1} = \\exp(-\\lambda)\n$$\n代入 $\\lambda=C$，一个碱基未被覆盖的概率是 $\\exp(-C)$。这也可以通过对二项概率在 $N \\to \\infty$ 时取极限来形式上证明：\n$$\n\\lim_{N \\to \\infty} \\left(1 - \\frac{L}{G}\\right)^N = \\lim_{N \\to \\infty} \\left(1 - \\frac{C}{N}\\right)^N = \\exp(-C)\n$$\n由于读段均匀分布的假设，任何单个碱基未被覆盖的概率对所有碱基都是相同的。因此，整个基因组未被覆盖的期望分数也是 $\\exp(-C)$。\n\n现在，我们使用给定的数值进行计算。\n\n1.  **计算平均覆盖度 ($C$)**\n    给定：$G=5\\times 10^{6}$， $N=5\\times 10^{7}$， $L=150$。\n    $$\n    C = \\frac{N \\times L}{G} = \\frac{(5 \\times 10^7) \\times 150}{5 \\times 10^6}\n    $$\n    $$\n    C = \\left(\\frac{5 \\times 10^7}{5 \\times 10^6}\\right) \\times 150 = 10 \\times 150 = 1500\n    $$\n    平均覆盖度是 $1500$。这是一个无量纲量，常写作 $1500$X。\n\n2.  **计算期望的未覆盖分数**\n    基因组未被覆盖的期望分数由 $\\exp(-C)$ 给出。\n    $$\n    \\text{未覆盖分数} = \\exp(-1500)\n    $$\n    这个值是一个精确表达式。它是一个极小的正数，代表基因组被测序的深度非常高，以至于任何碱基被漏掉的概率几乎为零。用小数形式表示它是不切实际且没有必要的。\n\n    所求的两个量是平均覆盖度 $C$ 和期望的未覆盖分数 $\\exp(-C)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1500 & \\exp(-1500) \\end{pmatrix}}\n$$", "id": "2495881"}]}