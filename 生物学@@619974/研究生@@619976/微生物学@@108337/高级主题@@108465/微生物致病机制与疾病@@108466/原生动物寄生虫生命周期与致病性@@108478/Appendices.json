{"hands_on_practices": [{"introduction": "寄生虫生命周期的闭合是其在宿主种群中得以延续的根本前提。为了定量地理解这一过程，我们可以构建数学模型来捕捉传播的关键动态。本练习将引导你从基本原理出发，推导一个典型的双宿主寄生虫系统的基本再生数（$R_0$），它揭示了接触率、传播概率和感染持续时间等生物学和生态学参数如何共同决定寄生虫能否成功建立种群。这项实践旨在培养你的数学建模能力，并让你对寄生虫存续的根本条件有一个深刻的定量理解。[@problem_id:2526580]", "problem": "一种双宿主原生动物寄生虫需要且仅需要两个宿主来完成其生活史：一个脊椎动物宿主 $H_1$ 和一个无脊椎动物宿主 $H_2$。在 $H_1$ 中，一个复制阶段产生可传播的配子体；在 $H_2$ 中，发育过程产生可在 $H_1$ 中引发感染的子孢子。你的任务是为在稳态传播条件下，生活史闭合所必需且充分的最小感染-传播骨架进行建模。\n\n构建一个最小有向图模型，其中有且仅有两个感染节点：$X_1$（在 $H_1$ 中的一个已建立的、当前具传染性的感染）和 $X_2$（在 $H_2$ 中的一个已建立的、当前具传染性的感染）。边（Edge）编码了跨宿主成功产生新的已建立感染。假设为罕见感染极限，因此基本上所有潜在的传染性接触都发生在传染性个体和易感个体之间，宿主种群大小恒定，且下面定义的所有速率和概率都是时齐的。\n\n定义以下具有生物学可解释性的量：\n- $b$：单个 $H_2$ 个体试图在 $H_1$ 个体上吸血的均只接触率（单位：$\\text{time}^{-1}$）。\n- $m$：每个 $H_1$ 个体对应的 $H_2$ 个体数量比率（无量纲）。\n- $p_{1\\to 2}$：从一个具传染性的 $H_1$ 到一个易感的 $H_2$ 的单次接触，在应用了所有 $H_2$ 内部的发育筛选后，最终在 $H_2$ 中产生一个已建立感染的概率（无量纲）。\n- $p_{2\\to 1}$：从一个具传染性的 $H_2$ 到一个易感的 $H_1$ 的单次接触，在应用了所有 $H_1$ 内部的发育筛选后，最终在 $H_1$ 中产生一个已建立感染的概率（无量纲）。\n- $s_2$：一个因摄取来自 $H_1$ 的可传播形式而受感染的 $H_2$ 个体，在感染消失或死亡前，存活过外潜伏期并变得具有传染性的概率（无量纲）。\n- $s_1$：一个被来自 $H_2$ 的子孢子感染的 $H_1$ 个体，在被清除或死亡之前，存活过内潜伏期并变得具有传染性（即产生可传播的配子体）的概率（无量纲）。\n- $D_1$：$H_1$ 感染保持传染性的平均持续时间（单位：$\\text{time}$）。\n- $D_2$：$H_2$ 感染保持传染性的平均持续时间（单位：$\\text{time}$）。\n\n从跨宿主相遇的质量作用第一性原理、仓室传染系统的下一代算子定义，以及关于无病平衡点的线性化出发，完成以下任务：\n- 用单个传染性个体在其整个传染期内通过跨宿主转换产生的预期新建立感染数来指定你的双节点有向图的边权重，使用 $b$, $m$, $p_{1\\to 2}$, $p_{2\\to 1}$, $s_1$, $s_2$, $D_1$, 和 $D_2$ 表示。\n- 写出 $2\\times 2$ 的下一代矩阵 $K$，其 $(i,j)$ 项是由单个 $X_j$ 感染在一个其他方面均为易感的系统中产生的新 $X_i$ 感染的预期数量，然后计算其谱半径，即基本再生数 $R_0$。\n- 由此推导出稳态传播下生活史闭合的充要条件（用 $R_0$ 表示）。\n\n将您的最终答案表示为 $R_0$ 关于 $b$, $m$, $p_{1\\to 2}$, $p_{2\\to 1}$, $s_1$, $s_2$, $D_1$, 和 $D_2$ 的单个闭式解析表达式。最终答案无需单位。不要提供不等式或方程式作为最终答案；仅提供所要求的表达式。", "solution": "该问题要求为一个代表宿主 $H_1$ 中的感染（状态 $X_1$）和宿主 $H_2$ 中的感染（状态 $X_2$）的双态系统构建一个下一代矩阵 $K$。该矩阵的元素 $K_{ij}$ 定义为，在一个完全易感的种群中，由单个 $j$ 类型的传染性个体在其整个传染期内产生的 $i$ 类型新感染的预期数量。\n\n首先，我们确定矩阵的非对角线元素，它们对应于连接 $X_1$ 和 $X_2$ 的有向图边的权重。由于传播严格是跨宿主的（$H_1 \\to H_2$ 和 $H_2 \\to H_1$），对角线元素 $K_{11}$ 和 $K_{22}$ 必须为零。\n$$K_{11} = 0$$\n$$K_{22} = 0$$\n\n接下来，我们计算 $K_{21}$，即由单个具传染性的 $H_1$ 个体产生的新的具传染性的 $H_2$ 个体的预期数量。\n- 种群中存在单个具传染性的 $H_1$ 个体。\n- $H_2$ 个体与 $H_1$ 个体的比率为 $m$。参数 $b$ 是单个 $H_2$ 的均只接触率。因此，整个 $H_2$ 种群对单个 $H_1$ 个体的总接触率为 $m \\times b$。\n- 在罕见感染极限下，所有接触的 $H_2$ 都被假定为易感。\n- 一个从具传染性的 $H_1$ 到易感的 $H_2$ 的接触建立感染的概率是 $p_{1\\to 2}$。\n- 这个新感染的 $H_2$ 存活过外潜伏期并变得具传染性的概率是 $s_2$。\n- 因此，单个具传染性的 $H_1$ 产生新的*具传染性*的 $H_2$ 个体的速率是这些项的乘积：$m \\cdot b \\cdot p_{1\\to 2} \\cdot s_2$。\n- 这种产生发生在 $H_1$ 个体的平均传染期 $D_1$ 内。\n- 新的 $H_2$ 感染总预期数是速率乘以持续时间：\n$$K_{21} = (m \\cdot b \\cdot p_{1\\to 2} \\cdot s_2) \\cdot D_1$$\n\n现在，我们计算 $K_{12}$，即由单个具传染性的 $H_2$ 个体产生的新的具传染性的 $H_1$ 个体的预期数量。\n- 种群中存在单个具传染性的 $H_2$ 个体。\n- 该 $H_2$ 个体以速率 $b$ 与 $H_1$ 个体接触。\n- 在罕见感染极限下，所有被接触的 $H_1$ 都被假定为易感。\n- 一个从具传染性的 $H_2$ 到易感的 $H_1$ 的接触建立感染的概率是 $p_{2\\to 1}$。\n- 这个新感染的 $H_1$ 存活过内潜伏期并变得具传染性的概率是 $s_1$。\n- 因此，单个具传染性的 $H_2$ 产生新的*具传染性*的 $H_1$ 个体的速率是 $b \\cdot p_{2\\to 1} \\cdot s_1$。\n- 这种产生发生在 $H_2$ 个体的平均传染期 $D_2$ 内。\n- 新的 $H_1$ 感染总预期数是速率乘以持续时间：\n$$K_{12} = (b \\cdot p_{2\\to 1} \\cdot s_1) \\cdot D_2$$\n\n因此，下一代矩阵 $K$ 是：\n$$K = \\begin{pmatrix} K_{11} & K_{12} \\\\ K_{21} & K_{22} \\end{pmatrix} = \\begin{pmatrix} 0 & b \\cdot p_{2\\to 1} \\cdot s_1 \\cdot D_2 \\\\ m \\cdot b \\cdot p_{1\\to 2} \\cdot s_2 \\cdot D_1 & 0 \\end{pmatrix}$$\n\n基本再生数 $R_0$ 是矩阵 $K$ 的谱半径，记为 $\\rho(K)$。$K$ 的特征值 $\\lambda$ 是特征方程 $\\det(K - \\lambda I) = 0$ 的根。\n$$\n\\det \\begin{pmatrix}\n-\\lambda & K_{12} \\\\\nK_{21} & -\\lambda\n\\end{pmatrix} = 0\n$$\n$$(-\\lambda)(-\\lambda) - K_{12} K_{21} = 0$$\n$$\\lambda^2 - K_{12} K_{21} = 0$$\n$$\\lambda^2 = K_{12} K_{21}$$\n特征值为 $\\lambda = \\pm \\sqrt{K_{12} K_{21}}$。由于 $K$ 是一个非负矩阵，其谱半径是最大的非负特征值。\n$$R_0 = \\rho(K) = \\sqrt{K_{12} K_{21}}$$\n代入 $K_{12}$ 和 $K_{21}$ 的表达式：\n$$R_0 = \\sqrt{(b \\cdot p_{2\\to 1} \\cdot s_1 \\cdot D_2) \\cdot (m \\cdot b \\cdot p_{1\\to 2} \\cdot s_2 \\cdot D_1)}$$\n将根号下的项合并，得到 $R_0$ 的最终表达式：\n$$R_0 = \\sqrt{m \\cdot b^2 \\cdot p_{1\\to 2} \\cdot p_{2\\to 1} \\cdot s_1 \\cdot s_2 \\cdot D_1 \\cdot D_2}$$\n生活史闭合的条件，即允许寄生虫在宿主种群中建立并持续存在（即感染成为地方病）的条件，是基本再生数必须大于或等于1。充要条件是 $R_0 \\ge 1$。这确保了平均而言，每一代感染至少能产生一代后续感染，从而使传播链得以持续。问题仅要求提供 $R_0$ 的表达式。", "answer": "$$\\boxed{\\sqrt{m \\cdot b^2 \\cdot p_{1\\to 2} \\cdot p_{2\\to 1} \\cdot s_1 \\cdot s_2 \\cdot D_1 \\cdot D_2}}$$", "id": "2526580"}, {"introduction": "在理解了维持寄生虫生命周期所需的条件后，一个关键问题是如何打破它。公共卫生干预，例如水消毒，对于控制通过环境传播的寄生虫至关重要。本练习关注量化这种干预措施对环境抵抗性寄生虫阶段（如贾第鞭毛虫囊合子）的效力。通过应用一级反应动力学模型，你将把消毒剂浓度和接触时间与病原体的对数削减率联系起来，后者是评估公共卫生措施有效性的一个标准指标。这项实践将基础微积分与环境微生物学中的实际问题相结合，展示了数学模型如何指导疾病预防策略。[@problem_id:2526520]", "problem": "Giardia duodenalis（也称为 Giardia lamblia 或 Giardia intestinalis）在小肠中致病的滋养体阶段与在环境中耐受性强、通过污染水源传播的包囊阶段之间交替。在饮用水消毒中，包囊阶段是灭活的相关目标。对于在消毒剂浓度恒定的完全混合反应器中，由消毒剂介导的原生动物包囊灭活过程，一个经过充分检验的经验观察是，存活生物体的瞬时损失率与当前存活数量和消毒剂浓度均成正比。设 $N(t)$ 表示时间 $t$ 时存活的 Giardia 包囊数量，$C$ 为恒定的消毒剂浓度，$k$ 是特定于 Giardia 和消毒剂的灭活系数（其单位使得 $k C$ 成为时间的倒数）。在完全混合、恒定 $C$ 和等温条件下，接触时间为 $T$ 时，一级灭活定律表示为常微分方程 $\\,\\frac{dN}{dt} = -k\\,C\\,N\\,$，初始条件为 $N(0)=N_0$。\n\n公共卫生绩效通常以对数减少值报告，定义为接触时间 $T$ 后的以 10 为底的对数减少值 $L$：\n$$\nL \\equiv -\\log_{10}\\!\\left(\\frac{N(T)}{N_0}\\right).\n$$\n\n仅从一级灭活定律 $\\,\\frac{dN}{dt} = -k\\,C\\,N\\,$ 和上述 $L$ 的定义出发，推导出一个用 $k$、$C$ 和 $T$ 表示的 $L$ 的闭式解析表达式。将您的最终结果以单个简化的解析表达式形式给出。最终答案中不要包含单位。如果您选择表达任何常数，请使用精确形式（例如，使用 $\\ln(10)$ 而不是小数近似值）。", "solution": "推导从所提供的一级灭活定律开始，这是一个可分离的常微分方程：\n$$\n\\frac{dN}{dt} = -kCN\n$$\n鉴于对于一个存活生物种群，$N(t)$ 必须为正，我们可以用 $N$ 去除两边：\n$$\n\\frac{1}{N} dN = -kC dt\n$$\n参数 $k$ 和 $C$ 被说明为常数。我们对该方程两边进行积分。对 $N$ 的积分区间是从时间 $t=0$ 时的初始数量 $N_0$ 到最终接触时间 $t=T$ 时的数量 $N(T)$。\n$$\n\\int_{N_0}^{N(T)} \\frac{1}{N} dN = \\int_{0}^{T} -kC dt\n$$\n对两边进行积分得到：\n$$\n[\\ln(N)]_{N_0}^{N(T)} = -kC [t]_{0}^{T}\n$$\n应用微积分基本定理：\n$$\n\\ln(N(T)) - \\ln(N_0) = -kC(T - 0)\n$$\n使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$，我们将左边的项合并：\n$$\n\\ln\\left(\\frac{N(T)}{N_0}\\right) = -kCT\n$$\n该表达式将存活率的自然对数与灭活系数、浓度和时间的乘积联系起来。\n\n问题要求推导以 10 为底的对数减少值 $L$，其定义为：\n$$\nL \\equiv -\\log_{10}\\left(\\frac{N(T)}{N_0}\\right)\n$$\n为了将我们的结果与此定义联系起来，我们必须将自然对数（$\\ln$）转换为以 10 为底的对数（$\\log_{10}$）。对数的换底公式为：\n$$\n\\log_{b}(x) = \\frac{\\log_{a}(x)}{\\log_{a}(b)}\n$$\n设 $a=e$（自然对数的底）和 $b=10$，我们有：\n$$\n\\log_{10}(x) = \\frac{\\ln(x)}{\\ln(10)}\n$$\n重新整理得到 $\\ln(x)$ 的表达式：\n$$\n\\ln(x) = \\ln(10) \\log_{10}(x)\n$$\n我们将 $x = \\frac{N(T)}{N_0}$ 代入此恒等式：\n$$\n\\ln\\left(\\frac{N(T)}{N_0}\\right) = \\ln(10) \\log_{10}\\left(\\frac{N(T)}{N_0}\\right)\n$$\n现在，我们将我们得到的两个关于 $\\ln\\left(\\frac{N(T)}{N_0}\\right)$ 的表达式相等：\n$$\n\\ln(10) \\log_{10}\\left(\\frac{N(T)}{N_0}\\right) = -kCT\n$$\n求解 $\\log_{10}\\left(\\frac{N(T)}{N_0}\\right)$：\n$$\n\\log_{10}\\left(\\frac{N(T)}{N_0}\\right) = -\\frac{kCT}{\\ln(10)}\n$$\n最后，我们将此结果代入 $L$ 的定义：\n$$\nL = -\\left(-\\frac{kCT}{\\ln(10)}\\right)\n$$\n这简化为对数减少值 $L$ 的最终闭式表达式：\n$$\nL = \\frac{kCT}{\\ln(10)}\n$$\n此结果完全由给定的参数 $k$、$C$ 和 $T$ 表示，符合要求。", "answer": "$$\\boxed{\\frac{kCT}{\\ln(10)}}$$", "id": "2526520"}, {"introduction": "有效的疾病管理依赖于准确的诊断，但生物学上的复杂性常常使诊断充满挑战。本练习探讨了一种疟疾快速诊断测试（RDT）在真实世界中的性能，其中寄生虫的遗传特性（如基因缺失）和宿主因素（如抗原持续存在）都会影响测试结果。这是一个应用概率论评估诊断测试的深入实践，你将利用全概率定律和贝叶斯定理，通过整合多种现实世界的复杂因素来计算阳性预测值（PPV）——一个至关重要的临床指标。这项练习旨在磨练你在生物统计学和批判性思维方面的高级技能，并阐明如何超越教科书中的灵敏度和特异性，对诊断工具在特定流行病学背景下的实际效用进行精细的定量评估。[@problem_id:2526567]", "problem": "一种基于富组氨酸蛋白2 (HRP2) 的恶性疟原虫疟疾快速诊断检测 (RDT) 可检测源自寄生虫无性红细胞内周期的血期抗原。HRP2在滋养体和裂殖体阶段被分泌，并且在寄生虫被清除后仍可持续存在于循环系统中。在某些地区，寄生虫携带pfhrp2基因的缺失，这会减少或消除HRP2的表达，从而即使患者当前正处于感染状态，也会降低检测的阳性率。此外，HRP3有时会与测试条上的HRP2抗体发生交叉反应。在某一特定地区，考虑对发热患者进行的一项横断面调查，其中以下参数已知或假定在调查的时间尺度上是稳定的：\n- 当前恶性疟原虫无性寄生虫血症的患病率为 $p = 0.25$。\n- 在当前受感染的个体中，致病寄生虫群体缺乏pfhrp2的概率为 $d = 0.12$。\n- 对于携带pfhrp2完整寄生虫的当前受感染个体，基于HRP2的RDT单次检测结果为阳性的概率为 $s = 0.98$（这综合了抗原动力学和在典型寄生虫密度下的检测限的影响）。\n- 对于携带pfhrp2缺失寄生虫的当前受感染个体，由于HRP3交叉反应性导致的残留阳性在单次检测中发生的概率为 $r = 0.15$。\n- 在当前未感染的个体中，有一部分（比例为 $u = 0.05$）处于近期治疗后的窗口期内，在此期间循环HRP2可能仍然可以被检测到；这类近期感染已清除的个体检测结果为阳性的概率为 $q = 0.40$。\n- 其余未感染的个体（占比例 $1 - u$）由于非特异性反应或操作者失误，其基础假阳性概率为 $b = 0.01$。\n\n假设所述机制相互独立，且每位患者提供一个独立的检测结果。仅使用患病率、灵敏度、特异度、全概率定律和贝叶斯定理的核心定义，从第一性原理推导出阳性预测值 (PPV) 的表达式（定义为 $P(\\text{感染} \\mid \\text{检测阳性})$），然后根据上述参数计算其数值。将最终答案表示为四舍五入到四位有效数字的小数。不要使用百分号。", "solution": "本问题要求推导和计算一种疟疾快速诊断检测的阳性预测值(PPV)。PPV被定义为在个体检测结果为阳性的条件下，其确实受到感染的条件概率。我们必须使用所提供的参数，从第一性原理出发进行推导。\n\n让我们根据问题陈述来定义相关事件及其概率。\n$I$：个体当前患有恶性疟原虫无性期感染的事件。给定其患病率为 $P(I) = p = 0.25$。\n$I^c$：个体当前未受感染的事件。其概率为 $P(I^c) = 1 - P(I) = 1 - p = 1 - 0.25 = 0.75$。\n$T^+$：诊断检测结果为阳性的事件。\n$T^-$：诊断检测结果为阴性的事件。\n\nPPV即概率 $P(I \\mid T^+)$。根据贝叶斯定理，其表达式为：\n$$\n\\text{PPV} = P(I \\mid T^+) = \\frac{P(T^+ \\mid I) P(I)}{P(T^+)}\n$$\n分母 $P(T^+)$ 可以通过以感染状态为条件，使用全概率定律展开：\n$$\nP(T^+) = P(T^+ \\mid I) P(I) + P(T^+ \\mid I^c) P(I^c)\n$$\n将此代入PPV的表达式，得到：\n$$\n\\text{PPV} = \\frac{P(T^+ \\mid I) P(I)}{P(T^+ \\mid I) P(I) + P(T^+ \\mid I^c) P(I^c)}\n$$\n为了解决这个问题，我们必须推导出 $P(T^+ \\mid I)$（该人群中检测的灵敏度）和 $P(T^+ \\mid I^c)$（特异度的补集，即 $1 - \\text{特异度}$）的表达式。\n\n首先，我们计算灵敏度 $P(T^+ \\mid I)$。对于受感染的个体，检测性能取决于寄生虫是否携带pfhrp2基因。我们定义以下事件：\n$D$：在已知感染的条件下，致病寄生虫携带pfhrp2基因缺失的事件。给定 $P(D \\mid I) = d = 0.12$。\n$D^c$：在已知感染的条件下，致病寄生虫pfhrp2完整的事件。其概率为 $P(D^c \\mid I) = 1 - d = 1 - 0.12 = 0.88$。\n\n对于这两个受感染的亚群，检测结果为阳性的概率分别为：\n$P(T^+ \\mid I \\cap D^c) = s = 0.98$（对于pfhrp2完整寄生虫感染的灵敏度）。\n$P(T^+ \\mid I \\cap D) = r = 0.15$（对于pfhrp2缺失寄生虫感染的残留阳性率）。\n\n使用全概率定律，总体灵敏度 $P(T^+ \\mid I)$ 是这些概率的加权平均值：\n$$\nP(T^+ \\mid I) = P(T^+ \\mid I \\cap D^c) P(D^c \\mid I) + P(T^+ \\mid I \\cap D) P(D \\mid I)\n$$\n$$\nP(T^+ \\mid I) = s(1-d) + rd\n$$\n代入给定值：\n$$\nP(T^+ \\mid I) = (0.98)(1 - 0.12) + (0.15)(0.12) = (0.98)(0.88) + 0.018 = 0.8624 + 0.018 = 0.8804\n$$\n\n接下来，我们计算未感染个体中检测结果为阳性的概率 $P(T^+ \\mid I^c)$。该人群分为两组。我们定义以下事件：\n$U$：在未感染的条件下，个体近期清除了感染的事件。给定 $P(U \\mid I^c) = u = 0.05$。\n$U^c$：在未感染的条件下，个体近期未清除感染的事件。其概率为 $P(U^c \\mid I^c) = 1 - u = 1 - 0.05 = 0.95$。\n\n对于这两个未感染的亚群，检测结果为阳性的概率分别为：\n$P(T^+ \\mid I^c \\cap U) = q = 0.40$（因持续性抗原导致的阳性）。\n$P(T^+ \\mid I^c \\cap U^c) = b = 0.01$（基础假阳性率）。\n\n使用全概率定律， $P(T^+ \\mid I^c)$ 为：\n$$\nP(T^+ \\mid I^c) = P(T^+ \\mid I^c \\cap U) P(U \\mid I^c) + P(T^+ \\mid I^c \\cap U^c) P(U^c \\mid I^c)\n$$\n$$\nP(T^+ \\mid I^c) = qu + b(1-u)\n$$\n代入给定值：\n$$\nP(T^+ \\mid I^c) = (0.40)(0.05) + (0.01)(1 - 0.05) = 0.02 + (0.01)(0.95) = 0.02 + 0.0095 = 0.0295\n$$\n该值代表 $1 - \\text{特异度}$。\n\n现在我们拥有了构建PPV完整表达式所需的所有组成部分。推导出的解析表达式为：\n$$\n\\text{PPV} = \\frac{(s(1-d) + rd)p}{(s(1-d) + rd)p + (qu + b(1-u))(1-p)}\n$$\n我们分别计算分子和分母。\n真阳性结果的概率是 $P(T^+ \\cap I) = P(T^+ \\mid I)P(I)$:\n$$\nP(T^+ \\cap I) = (0.8804)(0.25) = 0.2201\n$$\n假阳性结果的概率是 $P(T^+ \\cap I^c) = P(T^+ \\mid I^c)P(I^c)$:\n$$\nP(T^+ \\cap I^c) = (0.0295)(0.75) = 0.022125\n$$\n检测结果为阳性的总概率 $P(T^+)$ 是这两个概率之和：\n$$\nP(T^+) = P(T^+ \\cap I) + P(T^+ \\cap I^c) = 0.2201 + 0.022125 = 0.242225\n$$\n最后，PPV是真阳性概率与总阳性概率之比：\n$$\n\\text{PPV} = P(I \\mid T^+) = \\frac{P(T^+ \\cap I)}{P(T^+)} = \\frac{0.2201}{0.242225}\n$$\n$$\n\\text{PPV} \\approx 0.908660105273383\n$$\n题目要求将答案四舍五入到四位有效数字。\n$$\n\\text{PPV} \\approx 0.9087\n$$\n这就是在指定条件下阳性预测值的最终数值。", "answer": "$$\n\\boxed{0.9087}\n$$", "id": "2526567"}]}