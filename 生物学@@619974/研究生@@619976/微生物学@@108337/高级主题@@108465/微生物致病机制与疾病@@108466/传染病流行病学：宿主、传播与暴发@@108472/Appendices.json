{"hands_on_practices": [{"introduction": "在新发传染病暴发的初期，估算其基本再生数（$R_0$）是评估其大流行潜力的关键第一步。本练习将通过一个理想化的早期疫情增长数据，引导您实践如何从观测到的指数增长率（$r$）和给定的世代间隔分布，利用更新方程理论推导出$R_0$ [@problem_id:2489931]。这项实践将巩固您对疫情增长动力学与核心传播参数之间关系的理解。", "problem": "一种呼吸道病原体在一个庞大的、完全易感的大都市人口中出现。在最初几周，由于缺乏控制措施，监测系统捕获了每日的症状发作发病数，其报告延迟和相对于泊松过程的过度离散均可忽略不计。流行病学家将最早期的病例计数汇总到等长且不重叠的时间窗口中，获得了以下早期疫情的发病轨迹，并假设该轨迹处于初始指数增长阶段：\n\n- 在时间 $t=0$ 天：新增发病 $I(0)=25$ 例。\n- 在时间 $t=5$ 天：新增发病 $I(5)=50$ 例。\n- 在时间 $t=10$ 天：新增发病 $I(10)=100$ 例。\n- 在时间 $t=15$ 天：新增发病 $I(15)=200$ 例。\n- 在时间 $t=20$ 天：新增发病 $I(20)=400$ 例。\n\n假设早期发病数遵循指数增⻓定律 $I(t)=I(0)\\exp(r t)$，其中 $r$ (单位为 $\\text{day}^{-1}$) 是一个恒定的人均增⻓率。代际间隔概率密度 $w(a)$（即从一个原代感染到其续代感染之间的时间 $a$ 的分布）被建模为一个形状参数 $k=4$、尺度参数 $\\theta=1.25$ 天的伽马分布，即\n$$\nw(a)=\\frac{a^{k-1}\\exp\\!\\left(-a/\\theta\\right)}{\\Gamma(k)\\,\\theta^{k}}, \\quad a>0.\n$$\n使用初始阶段恒定基本再生数 $R_0$（基本再生数($R_0$)：在完全易感的人群中，由单个原代感染病例所引起的续代感染病例的平均数量）的经典传播更新公式，根据以上数据和假设计算 $R_0$。使用早期疫情的发病数据从基本原理出发确定 $r$，然后在更新框架下根据 $r$ 和 $w(a)$ 推断 $R_0$。仅报告最终的 $R_0$ 值，以纯数字形式（无单位）呈现，并四舍五入到四位有效数字。", "solution": "所给问题是数理流行病学中的一个标准练习，在尝试求解之前需要对其进行验证。\n\n首先，我将逐字提取给定信息。\n- 时间 $t=0$ 时的初始发病数为 $I(0)=25$。\n- 时间 $t=5$ 时的发病数为 $I(5)=50$。\n- 时间 $t=10$ 时的发病数为 $I(10)=100$。\n- 时间 $t=15$ 时的发病数为 $I(15)=200$。\n- 时间 $t=20$ 时的发病数为 $I(20)=400$。\n- 发病轨迹由指数增⻓定律 $I(t)=I(0)\\exp(r t)$ 建模，其中 $r$ 是恒定的疫情增⻓率。\n- 代际间隔分布 $w(a)$ 是一个形状参数为 $k=4$、尺度参数为 $\\theta=1.25$ 天的伽马分布。其概率密度函数由 $w(a)=\\frac{a^{k-1}\\exp(-a/\\theta)}{\\Gamma(k)\\,\\theta^{k}}$ ($a>0$) 给出。\n- 任务是计算基本再生数 $R_0$。\n\n现在，我将验证问题陈述的有效性。\n该问题具有科学依据，它利用了疫情早期阶段的经典指数增⻓模型和更新方程，后者是传染病动力学中的一个基本概念。伽马分布是建模代际间隔的标准且恰当的选择。该问题是适定的，提供了确定唯一解所需的所有参数和数据。数据内部一致，术语精确且客观。该问题未违反任何无效性标准。它是在指定领域内一个可形式化和可解的问题。\n\n结论是：该问题有效。我现在将开始求解。\n\n求解过程需要两个主要步骤：首先，根据给定的发病数据确定指数增⻓率 $r$；其次，通过代际间隔分布 $w(a)$ 将该增⻓率 $r$ 与基本再生数 $R_0$ 联系起来。\n\n步骤1：确定增⻓率 $r$。\n假设发病数 $I(t)$ 遵循定律 $I(t) = I(0)\\exp(rt)$。我们可以通过计算两个不同时间点的发病数之比来确定 $r$。让我们使用 $t_1=0$ 和 $t_2=5$ 天。\n$$\n\\frac{I(t_2)}{I(t_1)} = \\frac{I(0)\\exp(rt_2)}{I(0)\\exp(rt_1)} = \\exp(r(t_2-t_1))\n$$\n代入给定值 $I(5)=50$ 和 $I(0)=25$：\n$$\n\\frac{50}{25} = \\exp(r(5-0))\n$$\n$$\n2 = \\exp(5r)\n$$\n为了解出 $r$，我们对两边取自然对数：\n$$\n\\ln(2) = 5r\n$$\n$$\nr = \\frac{\\ln(2)}{5}\n$$\n该值的单位为 $\\text{day}^{-1}$。可以使用任何其他时间区间来验证所提供数据的一致性。例如，在 $t=15$ 和 $t=20$ 之间：\n$$\n\\frac{I(20)}{I(15)} = \\frac{400}{200} = 2 = \\exp(r(20-15)) = \\exp(5r)\n$$\n这再次得到 $r = \\frac{\\ln(2)}{5}$。数据与这个恒定的增⻓率完全一致。\n\n步骤2：将 $r$ 与 $R_0$ 联系起来。\n更新方程将时间 $t$ 的发病数描述为过去发病数和代际过程的函数：\n$$\nI(t) = \\int_{0}^{\\infty} R_0 I(t-a) w(a) da\n$$\n在此，$R_0 w(a)$ 代表一个原代病例在时间间隔 $a$ 后产生的续代感染的期望数量。\n在疫情的初始阶段，指数增⻓是一个有效的近似，我们将 $I(t) = C \\exp(rt)$ 代入更新方程，其中 $C$ 是一个常数。\n$$\nC \\exp(rt) = \\int_{0}^{\\infty} R_0 [C \\exp(r(t-a))] w(a) da\n$$\n我们可以将常数项从积分中提取出来：\n$$\nC \\exp(rt) = R_0 C \\exp(rt) \\int_{0}^{\\infty} \\exp(-ra) w(a) da\n$$\n两边同除以非零的 $C \\exp(rt)$，我们得到欧拉-洛特卡方程：\n$$\n1 = R_0 \\int_{0}^{\\infty} \\exp(-ra) w(a) da\n$$\n此表达式中的积分是代际间隔分布 $w(a)$ 的矩生成函数 (MGF) 在点 $-r$ 处的定义。设 $M_a(s) = E[\\exp(sa)]$ 是随机变量 $a$ 的矩生成函数。该方程变为：\n$$\n1 = R_0 M_a(-r)\n$$\n因此，$R_0$ 可以计算如下：\n$$\nR_0 = \\frac{1}{M_a(-r)}\n$$\n给定代际间隔 $a$ 遵循形状参数为 $k=4$、尺度参数为 $\\theta=1.25$ 的伽马分布。伽马($k, \\theta$)分布的矩生成函数由以下标准公式给出：\n$$\nM_a(s) = (1 - \\theta s)^{-k}\n$$\n该公式在 $s < 1/\\theta$ 时有效。我们计算该矩生成函数在 $s = -r$ 处的值：\n$$\nM_a(-r) = (1 - \\theta(-r))^{-k} = (1 + r\\theta)^{-k}\n$$\n将此代回 $R_0$ 的表达式中：\n$$\nR_0 = \\frac{1}{(1 + r\\theta)^{-k}} = (1 + r\\theta)^{k}\n$$\n现在我们代入各参数的数值：\n$k = 4$\n$\\theta = 1.25 = \\frac{5}{4}$ 天\n$r = \\frac{\\ln(2)}{5}$ 天$^{-1}$\n\n乘积 $r\\theta$ 为：\n$$\nr\\theta = \\left(\\frac{\\ln(2)}{5}\\right) \\left(\\frac{5}{4}\\right) = \\frac{\\ln(2)}{4}\n$$\n现在我们计算 $R_0$：\n$$\nR_0 = \\left(1 + \\frac{\\ln(2)}{4}\\right)^{4}\n$$\n为了获得数值，我们使用 $\\ln(2) \\approx 0.69314718$。\n$$\nR_0 = \\left(1 + \\frac{0.69314718}{4}\\right)^{4} = (1 + 0.173286795)^{4} = (1.173286795)^{4}\n$$\n$$\nR_0 \\approx 1.8950453\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nR_0 \\approx 1.895\n$$\n这是根据所提供的数据和模型计算出的基本再生数的最终值。", "answer": "$$\n\\boxed{1.895}\n$$", "id": "2489931"}, {"introduction": "流行病的传播并非一成不变，公共卫生干预措施会动态地影响其传播效率。因此，实时监测有效再生数（$R_t$）对于疫情控制至关重要。本练习要求您设计并实现一个程序，使用贝叶斯方法结合更新方程来估计随时间变化的$R_t$，并量化其不确定性 [@problem_id:2489874]。通过这项编码实践，您将掌握现代流行病学中用于评估干预效果和指导政策调整的核心量化技能。", "problem": "设计并实现一个程序，使用离散时间的更新方程来估算随时间变化的有效再生数，并基于泊松观测模型和伽马先验共轭进行有原则的不确定性量化。仅从第一性原理出发：更新方程将发病数与总传染力联系起来，而泊松似然与伽马先验通过贝叶斯定理能得到一个易于处理的后验分布。假设时间是离散的，以天为单位，索引为 $t \\in \\{0,1,2,\\dots,T-1\\}$，并已知代际间隔分布。所有发病计数均为非负整数。您必须使用从零开始的索引。\n\n基本原理：\n- 更新方程：每日发病数 $I_t$ 通过总传染力 $\\Lambda_t$ 与有效再生数 $R_t$ 相关联，总传染力由过去的发病数和代际间隔分布计算得出。具体来说，时间 $t$ 的总传染力定义为\n$$\n\\Lambda_t \\equiv \\sum_{s=1}^{S} I_{t-s} \\, w_s,\n$$\n约定对于所有 $u < 0$，$I_u = 0$。更新恒等式通过期望 $\\mathbb{E}[I_t \\mid R_t] = R_t \\Lambda_t$ 将 $I_t$ 和 $R_t$ 联系起来。\n- 观测模型：在给定 $R_t$ 的条件下，将 $I_t$ 建模为均值为 $R_t \\Lambda_t$ 的泊松随机变量。\n- 先验：假设在每个时间点 $t$，$R_t$ 都有一个独立的伽马先验，其形状参数为 $a$，速率参数为 $b$（即，在 $r>0$ 上，其密度正比于 $r^{a-1} e^{-b r}$）。\n\n您的任务：\n1. 对下面的每个测试用例，根据给定的发病数 $I_t$ 和代际间隔分布 $w_s$ 计算 $\\Lambda_{t_{\\mathrm{eval}}}$。\n2. 使用泊松观测模型和伽马先验，推导在给定 $I_{t_{\\mathrm{eval}}}$ 和 $\\Lambda_{t_{\\mathrm{eval}}}$ 的条件下 $R_{t_{\\mathrm{eval}}}$ 的后验分布。从该后验分布中计算：\n   - $R_{t_{\\mathrm{eval}}}$ 的后验均值，\n   - 置信水平为 $c$ 的中心可信区间的下界和上界（在每个尾部使用相等的尾部概率 $(1-c)/2$）。\n3. 生成数值结果，并四舍五入到 $6$ 位小数。\n\n约定和约束：\n- 如果 $\\Lambda_t = 0$ 且 $I_t = 0$，则时间 $t$ 的数据不提供任何新信息，且后验分布必须退化为先验分布。\n- 用于计算的伽马分布参数化必须使用形状参数 $k$ 和尺度参数 $\\theta$，它们通过 $\\theta = 1/b$ 与形状参数 $a$ 和速率参数 $b$ 相关。\n- 所有中间量均为无单位的计数或概率；不涉及物理单位。\n- 不涉及角度。\n- 当您呈现数值概率（如置信水平）时，必须表示为 $0$ 和 $1$ 之间的小数。\n\n测试套件：\n- 用例 $1$（正常路径）：\n  - 发病数 $I = [2, 3, 5, 7, 6, 4, 3, 2, 2, 1]$.\n  - 代际间隔 $w = [0.1, 0.4, 0.5]$.\n  - 先验参数 $a = 1.0, b = 1.0$.\n  - 置信水平 $c = 0.95$.\n  - 评估时间 $t_{\\mathrm{eval}} = 5$.\n- 用例 $2$（评估时总传染力为零的边界情况）：\n  - 发病数 $I = [0, 0, 0, 0]$.\n  - 代际间隔 $w = [0.6, 0.4]$.\n  - 先验参数 $a = 0.5, b = 0.5$.\n  - 置信水平 $c = 0.90$.\n  - 评估时间 $t_{\\mathrm{eval}} = 0$.\n- 用例 $3$（稀疏传播和较长代际间隔的边界情况）：\n  - 发病数 $I = [0, 1, 0, 2, 1, 3, 2, 1, 0, 0, 0, 0]$.\n  - 代际间隔 $w = [0.05, 0.15, 0.4, 0.3, 0.1]$.\n  - 先验参数 $a = 2.0, b = 2.0$.\n  - 置信水平 $c = 0.95$.\n  - 评估时间 $t_{\\mathrm{eval}} = 6$.\n\n要求的最终输出格式：\n- 您的程序必须按顺序处理上述三个测试用例，并生成单行输出，其中包含按以下顺序排列的 $9$ 个浮点数结果：依次为用例 1、用例 2、用例 3 的结果，每个用例贡献后验均值、可信区间下界和可信区间上界。输出必须是单个用方括号括起来的逗号分隔列表，例如 $[x_1,x_2,\\dots,x_9]$，每个 $x_i$ 四舍五入到 $6$ 位小数，并且行中不含任何空格。", "solution": "该问题是有效的。它在科学上基于数学流行病学和贝叶斯统计的既定原则，提法良好，提供了足够的信息以获得唯一解，并且陈述客观。\n\n目标是使用贝叶斯框架在特定时间 $t_{\\mathrm{eval}}$ 估算有效再生数 $R_t$。该模型由更新方程定义，它通过代际间隔分布 $w_s$ 将每日新增感染发病数 $I_t$ 与过去的发病数联系起来。\n\n问题的核心在于应用 Bayes 定理来更新我们对 $R_t$ 的信念。其组成部分是：\n1.  $R_t$ 的**先验分布**，它代表了我们在观测到时间 $t$ 的数据之前的信念。问题指定了一个伽马分布，$R_t \\sim \\text{Gamma}(a, b)$，其中 $a$ 是形状参数，$b$ 是速率参数。概率密度函数 (PDF) 由下式给出：\n    $$\n    p(R_t) = \\frac{b^a}{\\Gamma(a)} R_t^{a-1} e^{-b R_t}\n    $$\n2.  **似然函数**，它描述了在给定 $R_t$ 值的条件下观测到发病数 $I_t$ 的概率。问题指出 $I_t$ 服从均值为 $\\mathbb{E}[I_t] = R_t \\Lambda_t$ 的泊松分布，其中 $\\Lambda_t$ 是由过去病例产生的总传染力。似然函数为：\n    $$\n    P(I_t \\mid R_t, \\Lambda_t) = \\frac{(R_t \\Lambda_t)^{I_t} e^{-R_t \\Lambda_t}}{I_t!}\n    $$\n    总传染力 $\\Lambda_t$ 是一个根据过去的发病数据 $I_{t-s}$ 和代际间隔分布 $w_s$ 计算出的确定性量：\n    $$\n    \\Lambda_t = \\sum_{s=1}^{S} I_{t-s} \\, w_s\n    $$\n    其中 $S$ 是传染性的最大持续时间，$w_s$ 是一个原发病例在 $s$ 天后引起续发病例的概率。我们使用约定，对于 $u < 0$，$I_u = 0$。\n\n根据 Bayes 定理，$R_t$ 的后验分布正比于似然函数与先验分布的乘积：\n$$\np(R_t \\mid I_t, \\Lambda_t) \\propto P(I_t \\mid R_t, \\Lambda_t) \\times p(R_t)\n$$\n代入似然函数和先验的表达式，并舍去所有不依赖于 $R_t$ 的项，我们得到：\n$$\np(R_t \\mid I_t, \\Lambda_t) \\propto \\left( (R_t \\Lambda_t)^{I_t} e^{-R_t \\Lambda_t} \\right) \\times \\left( R_t^{a-1} e^{-b R_t} \\right)\n$$\n$$\np(R_t \\mid I_t, \\Lambda_t) \\propto R_t^{I_t} \\Lambda_t^{I_t} e^{-R_t \\Lambda_t} R_t^{a-1} e^{-b R_t}\n$$\n$$\np(R_t \\mid I_t, \\Lambda_t) \\propto R_t^{a + I_t - 1} e^{-(b + \\Lambda_t) R_t}\n$$\n这是一个伽马分布的核。因此，由于伽马先验和泊松似然之间的共轭性，后验分布也是一个伽马分布。后验分布为：\n$$\nR_t \\mid I_t, \\Lambda_t \\sim \\text{Gamma}(a_{post}, b_{post})\n$$\n更新后的参数为：\n-   后验形状参数：$a_{post} = a + I_t$\n-   后验速率参数：$b_{post} = b + \\Lambda_t$\n\n当 $\\Lambda_t = 0$ 且 $I_t = 0$ 时，会出现一个特殊情况。在这种情况下，$a_{post} = a + 0 = a$ 且 $b_{post} = b + 0 = b$。后验分布与先验分布相同，这是合乎逻辑的，因为数据没有提供关于 $R_t$ 的任何信息。如果 $\\Lambda_t=0$，则预计不会有新的感染，观测到 $I_t=0$ 与任何 $R_t$ 的值都是一致的。\n\n为便于计算，我们使用伽马分布的形状-尺度参数化，其中形状参数 $k = a$，尺度参数 $\\theta = 1/b$。用这些参数表示，后验分布为 $\\text{Gamma}(k_{post}, \\theta_{post})$，其中：\n-   后验形状参数：$k_{post} = a_{post} = a + I_t$\n-   后验尺度参数：$\\theta_{post} = 1/b_{post} = 1 / (b + \\Lambda_t)$\n\n根据这个后验分布，我们可以计算出所需的量：\n1.  **后验均值：** $\\text{Gamma}(k, \\theta)$ 分布的均值是 $k\\theta$。因此，$R_t$ 的后验均值是：\n    $$\n    \\mathbb{E}[R_t \\mid I_t, \\Lambda_t] = k_{post} \\theta_{post} = \\frac{a + I_t}{b + \\Lambda_t}\n    $$\n2.  **中心可信区间：** 置信水平为 $c$ 的中心可信区间由后验分布对应于概率 $\\alpha_{low} = (1-c)/2$ 和 $\\alpha_{up} = 1 - (1-c)/2 = (1+c)/2$ 的分位数定义。其下界和上界通过使用后验伽马分布的百分点函数 (PPF) 或逆累积分布函数 (CDF) 来找到。\n\n每个测试用例的算法如下：\n1.  给定 $I$、$w$、$a$、$b$、$c$ 和 $t_{\\mathrm{eval}}$。\n2.  使用离散卷积 $\\sum_{s=1}^{S} I_{t_{\\mathrm{eval}}-s} w_{s-1}$ 计算 $\\Lambda_{t_{\\mathrm{eval}}}$（对数组 $w$ 使用从零开始的索引）。\n3.  获取发病数 $I_{t_{\\mathrm{eval}}}$。\n4.  计算后验形状参数 $k_{post} = a + I_{t_{\\mathrm{eval}}}$ 和后验速率参数 $b_{post} = b + \\Lambda_{t_{\\mathrm{eval}}}$。后验尺度参数为 $\\theta_{post} = 1/b_{post}$。\n5.  计算后验均值：$\\mathbb{E}[R_{t_{\\mathrm{eval}}}] = k_{post} \\theta_{post}$。\n6.  使用 $\\text{Gamma}(k_{post}, \\theta_{post})$ 分布在概率 $(1-c)/2$ 和 $(1+c)/2$ 处的 PPF 计算可信区间界限。\n7.  按要求将所有结果四舍五入到 $6$ 位小数。", "answer": "```python\nimport numpy as np\nfrom scipy.stats import gamma\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating the effective reproduction number R_t\n    using a Bayesian framework for the renewal equation.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"I\": np.array([2, 3, 5, 7, 6, 4, 3, 2, 2, 1]),\n            \"w\": np.array([0.1, 0.4, 0.5]),\n            \"a\": 1.0, \"b\": 1.0,\n            \"c\": 0.95,\n            \"t_eval\": 5\n        },\n        {\n            \"I\": np.array([0, 0, 0, 0]),\n            \"w\": np.array([0.6, 0.4]),\n            \"a\": 0.5, \"b\": 0.5,\n            \"c\": 0.90,\n            \"t_eval\": 0\n        },\n        {\n            \"I\": np.array([0, 1, 0, 2, 1, 3, 2, 1, 0, 0, 0, 0]),\n            \"w\": np.array([0.05, 0.15, 0.4, 0.3, 0.1]),\n            \"a\": 2.0, \"b\": 2.0,\n            \"c\": 0.95,\n            \"t_eval\": 6\n        }\n    ]\n\n    final_results = []\n    for case in test_cases:\n        I, w, a, b, c, t_eval = case[\"I\"], case[\"w\"], case[\"a\"], case[\"b\"], case[\"c\"], case[\"t_eval\"]\n        \n        # 1. Compute total infectiousness Lambda_t\n        lambda_t = 0.0\n        S = len(w)\n        for s in range(1, S + 1):\n            if t_eval - s >= 0:\n                lambda_t += I[t_eval - s] * w[s - 1]\n\n        # Get incidence at evaluation time\n        I_t = I[t_eval]\n\n        # 2. Derive posterior distribution parameters\n        # Prior parameters (shape a, rate b)\n        # Posterior parameters (shape a_post, rate b_post)\n        a_post = a + I_t\n        b_post = b + lambda_t\n\n        # 3. Compute posterior mean and credible interval\n        # For scipy, we use shape k and scale theta\n        # k = a, theta = 1/b\n        \n        # Check for division by zero, although not expected with b > 0\n        if b_post == 0:\n            # This case is physically unlikely and suggests an issue with inputs\n            # or model applicability. However, we should handle it gracefully.\n            # If b_post is 0, the distribution is improper. Here we follow the\n            # problem's convention for Lambda=0, I_t=0, where posterior=prior\n            if a == a_post and b == b_post: #\n                k_post = a\n                theta_post = 1.0 / b if b != 0 else float('inf')\n            else:\n                # Undefined case, but must return some value.\n                # Let's set results to NaN to indicate a problem.\n                mean, lower, upper = float('nan'), float('nan'), float('nan')\n                final_results.extend([mean, lower, upper])\n                continue\n        else:\n             k_post = a_post\n             theta_post = 1.0 / b_post\n\n        # Posterior mean\n        mean = k_post * theta_post\n        \n        # Credible interval\n        alpha_low = (1.0 - c) / 2.0\n        alpha_up = 1.0 - alpha_low\n        \n        lower = gamma.ppf(alpha_low, a=k_post, scale=theta_post)\n        upper = gamma.ppf(alpha_up, a=k_post, scale=theta_post)\n\n        final_results.extend([mean, lower, upper])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in final_results)}]\")\n\nsolve()\n```", "id": "2489874"}, {"introduction": "将流行病学理论应用于制定有效的公共卫生对策是高级流行病学家的核心能力之一。本练习模拟了一个在接触率存在异质性的人群中优化疫苗分配的真实场景 [@problem_id:2490026]。您需要构建下一代矩阵模型来计算有效再生数（$R_e$），并运用最优化原理，在疫苗总量有限的条件下，确定能最大程度降低疾病传播的疫苗分配策略。", "problem": "一种直接传播的呼吸道病原体出现在一个宿主种群中，该种群被划分为两个接触率不同的亚群。假设为频率依赖的成比例混合。设两个亚群的索引为 $i \\in \\{1,2\\}$，其种群大小分别为 $N_{1}$ 和 $N_{2}$，人均每日平均接触次数分别为 $c_{1}$ 和 $c_{2}$。每次接触的传播概率为 $q$，平均传染期为 $D$。现有可将易感性降低至 $1 - \\epsilon$ 倍（其中 $0 < \\epsilon < 1$）的疫苗，并且第 $i$ 组中有比例为 $v_{i}$ 的个体可以接种疫苗。假设疫苗接种不影响传染性或接触率。设可用疫苗总剂量为 $M$，因此分配方案必须满足剂量约束 $N_{1} v_{1} + N_{2} v_{2} = M$，其中 $0 \\leq v_{i} \\leq 1$。\n\n从下一代矩阵（NGM）的基本定义出发，其中元素 $K_{ij}$ 是在一个完全易感的种群中，由第 $j$ 组中的一个典型原发病例在第 $i$ 组中引起的预期继发感染数，推导成比例混合下的NGM，并说明疫苗接种如何对其进行修正。然后，建立并求解约束优化问题，使用拉格朗日优化方法，选择 $v_{1}$ 和 $v_{2}$ 以最小化有效再生数 $R_{e}$，该值等于接种后NGM的谱半径。\n\n使用以下参数值：$N_{1} = 1.0 \\times 10^{5}$，$N_{2} = 2.0 \\times 10^{5}$，$c_{1} = 20$，$c_{2} = 5$，$q = 0.02$，$D = 4$，$\\epsilon = 0.8$，以及 $M = 1.3 \\times 10^{5}$。将最优分配方案报告为行向量 $\\bigl(v_{1}^{\\ast}, v_{2}^{\\ast}\\bigr)$，其中每个分量是其对应组别接种疫苗的比例。将最终分配方案的每个分量取四位有效数字。最终答案中不要包含单位。", "solution": "问题陈述经评估，被认为是科学上可靠、提法恰当且客观的。它为数学流行病学中的一个标准问题提供了一套完整且一致的数据和条件。因此，我将给出完整的解题过程。\n\n该问题要求推导下一代矩阵（NGM）、其在疫苗接种下的修正形式，并求解一个优化问题，以找到使有效再生数 $R_e$ 最小化的疫苗分配方案 $(v_1, v_2)$。\n\n首先，我们推导完全易感种群的下一代矩阵（用矩阵 $K$ 表示）。元素 $K_{ij}$ 代表由 $j$ 亚群中的单个感染者在 $i$ 亚群中引起的新增感染期望数。传播是频率依赖的，且为成比例混合。\n\n来自 $j$ 组的感染者每天的接触率为 $c_j$。在成比例混合下，任何一次接触的对象是来自 $i$ 组个体的概率，与 $i$ 组规模占总人口的比例成正比，即 $\\frac{N_i}{N}$，其中 $N = N_1 + N_2$。\n$j$ 组中的一个感染者与 $i$ 组个体接触的速率为 $c_j \\frac{N_i}{N}$。\n每次接触的传播概率是 $q$。由于假设种群完全易感，由 $j$ 组中单个感染者在 $i$ 组中产生新感染的速率为 $c_j \\frac{N_i}{N} q$。\n平均传染期为 $D$。\n因此，由 $j$ 组中的一个原发病例在 $i$ 组中引起的继发感染总期望数为：\n$$ K_{ij} = \\left(c_j \\frac{N_i}{N}\\right) q D $$\n这就定义了 $2 \\times 2$ 下一代矩阵 $K$ 的元素：\n$$ K = \\begin{pmatrix} c_1 \\frac{N_1}{N} q D & c_2 \\frac{N_1}{N} q D \\\\ c_1 \\frac{N_2}{N} q D & c_2 \\frac{N_2}{N} q D \\end{pmatrix} $$\n该矩阵可以表示为两个向量的外积：\n$$ K = \\frac{qD}{N} \\begin{pmatrix} N_1 \\\\ N_2 \\end{pmatrix} \\begin{pmatrix} c_1 & c_2 \\end{pmatrix} $$\n\n接下来，我们考虑疫苗接种的效果。疫苗使易感性降低至 $1 - \\epsilon$ 倍。在亚群 $i$ 中，接种比例为 $v_i$。亚群 $i$ 中个体的平均易感性是未接种者和已接种者易感性的加权平均值：$(1-v_i) \\cdot 1 + v_i \\cdot (1-\\epsilon) = 1 - v_i + v_i - v_i\\epsilon = 1 - v_i\\epsilon$。\n疫苗接种只影响接受方种群的易感性。因此，$i$ 组中的新增感染数会按此因子减少。接种后NGM（$K_v$）的元素 $K_{v,ij}$ 由 $K_{ij}$ 乘以 $i$ 组的平均易感性得出。\n$$ K_{v,ij} = K_{ij} (1 - v_i\\epsilon) $$\n因此，接种后的NGM为：\n$$ K_v = \\begin{pmatrix} K_{11}(1-v_1\\epsilon) & K_{12}(1-v_1\\epsilon) \\\\ K_{21}(1-v_2\\epsilon) & K_{22}(1-v_2\\epsilon) \\end{pmatrix} = \\begin{pmatrix} c_1 \\frac{N_1}{N} q D (1-v_1\\epsilon) & c_2 \\frac{N_1}{N} q D (1-v_1\\epsilon) \\\\ c_1 \\frac{N_2}{N} q D (1-v_2\\epsilon) & c_2 \\frac{N_2}{N} q D (1-v_2\\epsilon) \\end{pmatrix} $$\n与 $K$ 类似，$K_v$ 是一个秩为1的矩阵，可以写成外积形式：\n$$ K_v = \\frac{qD}{N} \\begin{pmatrix} N_1(1-v_1\\epsilon) \\\\ N_2(1-v_2\\epsilon) \\end{pmatrix} \\begin{pmatrix} c_1 & c_2 \\end{pmatrix} $$\n有效再生数 $R_e$ 是 $K_v$ 的谱半径（主特征值）。对于形如 $\\mathbf{u}\\mathbf{w}^T$ 的秩-1矩阵，其谱半径为 $\\mathbf{w}^T\\mathbf{u}$。\n$$ R_e(v_1, v_2) = \\rho(K_v) = \\frac{qD}{N} \\left[ c_1 N_1(1-v_1\\epsilon) + c_2 N_2(1-v_2\\epsilon) \\right] $$\n我们的目标是在给定约束条件下，最小化 $R_e(v_1, v_2)$。\n$$ R_e(v_1, v_2) = \\frac{qD}{N} [ (c_1 N_1 + c_2 N_2) - \\epsilon(c_1 N_1 v_1 + c_2 N_2 v_2) ] $$\n由于 $\\frac{qD}{N}$ 和 $\\epsilon$ 是正常数，最小化 $R_e$ 等价于最大化函数 $f(v_1, v_2) = c_1 N_1 v_1 + c_2 N_2 v_2$。\n\n优化问题是：\n在以下约束条件下，最大化 $f(v_1, v_2) = c_1 N_1 v_1 + c_2 N_2 v_2$：\n1. 剂量约束：$g(v_1, v_2) = N_1 v_1 + N_2 v_2 - M = 0$\n2. 可行性约束：$0 \\leq v_1 \\leq 1$ 且 $0 \\leq v_2 \\leq 1$\n\n我们使用拉格朗日优化法。在等式约束下最大化 $f$ 的拉格朗日函数为：\n$$ \\mathcal{L}(v_1, v_2, \\lambda) = c_1 N_1 v_1 + c_2 N_2 v_2 - \\lambda(N_1 v_1 + N_2 v_2 - M) $$\n对 $v_1$ 和 $v_2$ 求偏导数并令其为零，以找到内部极值点（其中 $0 < v_i < 1$）：\n$$ \\frac{\\partial \\mathcal{L}}{\\partial v_1} = c_1 N_1 - \\lambda N_1 = N_1(c_1 - \\lambda) = 0 \\implies \\lambda = c_1 $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial v_2} = c_2 N_2 - \\lambda N_2 = N_2(c_2 - \\lambda) = 0 \\implies \\lambda = c_2 $$\n内部解要求 $c_1 = c_2$。然而，给定参数为 $c_1 = 20$ 和 $c_2 = 5$，因此 $c_1 \\neq c_2$。这意味着极值点不出现在可行域的内部，而必须位于其边界上。这是预料之中的，因为我们是在一个凸区域（由约束条件定义的线段）上最大化一个线性函数。最大值必须出现在该可行区域的某个顶点上。\n\n项 $c_i$ 可被视为为 $i$ 组个体接种疫苗的“价值”或“回报”，因为它是目标函数中区分两个组的关键参数。由于 $c_1 > c_2$，为第 1 组的个体接种疫苗比为第 2 组的个体接种疫苗更能有效地降低 $R_e$（每剂）。因此，最优策略是优先为高接触率的第 1 组接种疫苗。\n\n我们将尽可能多的剂量分配给第 1 组，直到第 1 组全部接种完毕（$v_1=1$）或剂量用完为止。\n完全接种第 1 组所需的剂量数为 $N_1 = 1.0 \\times 10^5$。\n可用的总剂量为 $M = 1.3 \\times 10^5$。\n由于 $M > N_1$，我们有足够的剂量来完全接种第 1 组。因此，第 1 组的最优接种比例为 $v_1^* = 1$。\n\n用于第 1 组的剂量数为 $N_1 v_1^* = (1.0 \\times 10^5) \\times 1 = 1.0 \\times 10^5$。\n剩余剂量数为 $M - N_1 v_1^* = 1.3 \\times 10^5 - 1.0 \\times 10^5 = 0.3 \\times 10^5$。\n这些剩余剂量被分配给第 2 组。\n在第 2 组中接种疫苗的个体数量为 $N_2 v_2^* = 0.3 \\times 10^5$。\n第 2 组的人口数为 $N_2 = 2.0 \\times 10^5$。\n第 2 组需要接种的比例为：\n$$ v_2^* = \\frac{0.3 \\times 10^5}{N_2} = \\frac{0.3 \\times 10^5}{2.0 \\times 10^5} = \\frac{0.3}{2.0} = 0.15 $$\n最终的分配方案 $(v_1^*, v_2^*) = (1, 0.15)$ 满足所有约束条件：$v_1^*=1 \\in [0, 1]$，$v_2^*=0.15 \\in [0, 1]$，且 $N_1 v_1^* + N_2 v_2^* = (1.0 \\times 10^5)(1) + (2.0 \\times 10^5)(0.15) = 1.0 \\times 10^5 + 0.3 \\times 10^5 = 1.3 \\times 10^5 = M$。\n\n最优分配方案为 $v_1^* = 1$ 和 $v_2^* = 0.15$。问题要求将每个分量取四位有效数字。\n$v_1^* = 1.000$\n$v_2^* = 0.1500$\n\n最终的最优分配方案是行向量 $(1.000, 0.1500)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.000 & 0.1500\n\\end{pmatrix}\n}\n$$", "id": "2490026"}]}