{"hands_on_practices": [{"introduction": "在生物膜中，信号分子并非在开放水域中自由扩散，而必须穿过由胞外聚合物（EPS）构成的复杂迷宫。本练习将引导您从基本原理出发，探讨多孔介质的物理特性——即孔隙率（$\\varepsilon$）和曲折度（$\\lambda$）——如何降低宏观扩散速率。通过推导有效扩散系数（$D_{\\text{eff}}$），您将深刻理解生物膜的结构如何直接制约细胞间通讯的速度与范围 [@problem_id:2481843]。", "problem": "在一个水合细菌生物膜中，胞外聚合物（EPS）形成了一个多孔、充满水的网络，小的信号分子通过这个网络扩散以介导细胞间的通讯。考虑一个厚度为 $L$ 的均质、各向同性、稳态、无反应的生物膜平板，其平均浓度 $C(x)$ 仅沿 $x$ 方向变化。在充满水的孔隙空间内，局部通量遵循菲克第一定律（Fick’s first law），其分子扩散系数 $D$ 在充满流体的孔隙中空间均匀，而在聚合物相中可忽略不计。设孔隙空间由两个几何描述符表征：孔隙率 $\\varepsilon$（可用于扩散的空隙分数）和几何曲折度 $\\lambda := L_e/L \\ge 1$，其中 $L_e$ 是连接两个相距 $L$ 的面的扩散流线的平均弧长。\n\n仅从孔隙尺度的菲克第一定律以及 $\\varepsilon$ 和 $\\lambda$ 的几何定义出发，推导一个形式为 $J_{x}=-D_{\\text{eff}}\\,\\partial C/\\partial x$ 的均质化一维本构关系，该关系将穿过整个横截面（包括孔隙和聚合物）的面积平均通量 $J_{x}$ 与宏观浓度梯度联系起来。用 $D$、$\\varepsilon$ 和 $\\lambda$ 明确表示 $D_{\\text{eff}}$，并物理解释 $\\varepsilon$ 和 $\\lambda$ 如何修正 $D$。\n\n然后，引入一个单一的无量纲曲折度因子 $\\tau$，该因子聚合了孔隙率和曲折度带来的微观结构惩罚，使得 $D_{\\text{eff}}$ 可以写成紧凑形式 $D_{\\text{eff}}=D/\\tau$。最后，对于一个在水中的信号分子，其 $D=5\\times 10^{-6}$ cm$^{2}$/s，以及一个由 $\\tau=3$ 表征的 EPS 网络，计算 $D_{\\text{eff}}$ 的数值。将您的最终数值估算以平方厘米每秒为单位表示，并将答案四舍五入到两位有效数字。", "solution": "所提出的问题是多孔介质中输运性质均质化的一个标准练习，这是化学工程和生物物理学中的一个基本课题。该问题具有科学依据，提法恰当，并包含了获得唯一解所需的所有信息。因此，我们进行推导和计算。\n\n第一个任务是推导面积平均质量通量 $J_x$ 的一维本构关系，用有效扩散系数 $D_{\\text{eff}}$ 表示。我们按照要求从第一性原理开始。\n\n在充满水的孔隙空间内，信号分子的局部通量由菲克第一定律（Fick's first law）控制。通量是一个矢量 $\\vec{j}$，与局部浓度梯度 $\\nabla C$ 相关：\n$$\n\\vec{j} = -D \\nabla C\n$$\n该定律仅在孔隙内有效，其中扩散系数为 $D$。在聚合物相中，扩散系数可忽略不计，因此通量为零。\n\n宏观通量 $J_x$ 是通量矢量在 $x$ 方向上的分量，在包含孔隙空间和聚合物基质的总横截面积 $A$ 上进行平均。\n设 $\\dot{N}$ 是通过生物膜横截面的总摩尔流率（摩尔/时间）。宏观通量定义为：\n$$\nJ_x = \\frac{\\dot{N}}{A}\n$$\n流动只能通过孔隙面积 $A_p$ 发生。孔隙率 $\\varepsilon$ 定义为可用于扩散的总面积分数，因此 $A_p = \\varepsilon A$。在孔隙横截面上通量不是均匀的，也未必与 $x$ 轴对齐。总流率 $\\dot{N}$ 是局部通量矢量的法向分量在孔隙面积上的积分。然而，在所提供的简化假设下，我们可以使用基于平均量的论证。\n\n让我们考虑沿一条平均的、有代表性的流线的通量。沿着这条坐标为 $s$ 的曲折路径的通量是 $J_s$。根据菲克定律：\n$$\nJ_s = -D \\frac{dC}{ds}\n$$\n对于厚度为 $L$ 的平板上的稳态条件，两个面之间存在恒定的浓度差 $\\Delta C$。沿长度为 $L_e$ 的曲折路径的平均梯度是 $\\frac{\\Delta C}{L_e}$。因此，沿路径的平均通量是：\n$$\nJ_s \\approx -D \\frac{\\Delta C}{L_e}\n$$\n总摩尔流率 $\\dot{N}$ 是沿流线的通量 $J_s$ 与该通量所通过的孔隙总面积 $A_p$ 的乘积：\n$$\n\\dot{N} = J_s A_p = \\left(-D \\frac{\\Delta C}{L_e}\\right) (\\varepsilon A)\n$$\n我们将 $\\dot{N}$ 的这个表达式代回到宏观通量 $J_x$ 的定义中：\n$$\nJ_x = \\frac{\\dot{N}}{A} = \\frac{1}{A} \\left(-D \\varepsilon A \\frac{\\Delta C}{L_e}\\right) = -D \\varepsilon \\frac{\\Delta C}{L_e}\n$$\n为了将此表达式与所需形式联系起来，我们必须用宏观变量来表示 $\\Delta C$ 和 $L_e$。在厚度 $L$ 上的宏观浓度梯度 $\\frac{\\partial C}{\\partial x}$，平均而言是 $\\frac{\\Delta C}{L}$。因此，我们写成 $\\Delta C = L \\frac{\\partial C}{\\partial x}$。几何曲折度 $\\lambda$ 给出为 $\\lambda = \\frac{L_e}{L}$，这意味着有效路径长度为 $L_e = \\lambda L$。\n\n将这两个关系代入 $J_x$ 的表达式中：\n$$\nJ_x = -D \\varepsilon \\frac{L \\frac{\\partial C}{\\partial x}}{\\lambda L} = - \\left(\\frac{D \\varepsilon}{\\lambda}\\right) \\frac{\\partial C}{\\partial x}\n$$\n这个方程就是均质化的一维本构关系。通过与目标形式 $J_x = -D_{\\text{eff}} \\frac{\\partial C}{\\partial x}$ 比较，我们确定有效扩散系数为：\n$$\nD_{\\text{eff}} = \\frac{D \\varepsilon}{\\lambda}\n$$\n这个结果的物理解释是直观的。与分子扩散系数 $D$ 相比，有效扩散系数 $D_{\\text{eff}}$ 因两个因素而减小：\n1. 孔隙率 $\\varepsilon$：这个因子（$0 < \\varepsilon \\leq 1$）解释了可用于扩散的横截面积的减小。通量与可用面积成正比，因此与 $\\varepsilon$ 成正比。\n2. 曲折度 $\\lambda$：这个因子（$\\lambda \\geq 1$）解释了扩散路径长度的增加。对于固定的浓度差，更长的路径导致更小的浓度梯度，而浓度梯度是扩散的驱动力。因此，通量与路径长度成反比，因此与 $\\lambda$ 成反比。\n\n接下来，我们被要求引入一个单一的无量纲曲折度因子 $\\tau$，它聚合了这些微观结构惩罚，使得 $D_{\\text{eff}} = \\frac{D}{\\tau}$。我们将推导出的 $D_{\\text{eff}}$ 表达式与这个紧凑形式相等：\n$$\n\\frac{D \\varepsilon}{\\lambda} = \\frac{D}{\\tau}\n$$\n解出 $\\tau$ 得到：\n$$\n\\tau = \\frac{\\lambda}{\\varepsilon}\n$$\n这个组合因子 $\\tau$ 正确地反映了当路径变得更曲折（$\\lambda$ 更大）或空隙分数变得更小（$\\varepsilon$ 更小）时，多孔介质对扩散的阻碍作用变得更大（即 $\\tau$ 增大）。\n\n最后，我们必须根据给定的值 $D = 5 \\times 10^{-6}$ cm$^{2}$/s 和 $\\tau = 3$ 来计算 $D_{\\text{eff}}$ 的数值。\n使用有效扩散系数的紧凑形式：\n$$\nD_{\\text{eff}} = \\frac{D}{\\tau} = \\frac{5 \\times 10^{-6} \\text{ cm}^2/\\text{s}}{3}\n$$\n$$\nD_{\\text{eff}} = \\frac{5}{3} \\times 10^{-6} \\text{ cm}^2/\\text{s} \\approx 1.666... \\times 10^{-6} \\text{ cm}^2/\\text{s}\n$$\n问题要求答案四舍五入到两位有效数字。\n$$\nD_{\\text{eff}} \\approx 1.7 \\times 10^{-6} \\text{ cm}^2/\\text{s}\n$$\n这就是在指定的生物膜 EPS 网络中信号分子的有效扩散系数的最终数值。", "answer": "$$\\boxed{1.7 \\times 10^{-6}}$$", "id": "2481843"}, {"introduction": "信号分子的传播之旅不仅受到物理阻碍，还受制于时间；许多信号分子在化学上并不稳定，会随时间降解。本实践结合了菲克扩散定律与一级反应动力学，旨在探索“特征通讯长度”（$L$）这一关键概念。通过计算该长度尺度，您将学习如何量化信号扩散速率（$D$）与其化学稳定性（$k$）之间的相互作用，并最终决定一个信号是作为短程信使还是远程信使 [@problem_id:2481839]。", "problem": "在碱性生物膜微环境中，酰基高丝氨酸内酯 (AHL) 群体感应信号会经历碱催化的内酯水解，该过程可被建模为一级水解。考虑两种AHL，分别记为AHL-A和AHL-B，在pH $8.0$条件下，其实验报道的水解半衰期分别为 $t_{1/2,\\mathrm{A}} = 0.80$ 小时和 $t_{1/2,\\mathrm{B}} = 5.0$ 小时。假设水解遵循一级动力学，并且在含水生物膜基质内的扩散传输可以很好地近似为一维，其扩散系数为常数，AHL-A和AHL-B的扩散系数分别为 $D_{\\mathrm{A}} = 1.2 \\times 10^{-10}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ 和 $D_{\\mathrm{B}} = 0.8 \\times 10^{-10}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$。\n\n任务：\n1) 从一级过程半衰期的定义出发，计算在 $t = 2.0$ 小时后，在一个充分混合的体系中每种AHL剩余的比例，表示为 $f_{\\mathrm{A}}(2.0\\ \\mathrm{h})$ 和 $f_{\\mathrm{B}}(2.0\\ \\mathrm{h})$。\n\n2) 对于存在一级损耗的一维浓度场 $c(x)$，从稳态反应-扩散平衡方程 $D \\frac{d^2c}{dx^2} - kc = 0$ 出发，在边界条件 $c(0) = c_0$ 和当 $x \\to \\infty$ 时 $c(x)$ 有界的情况下，推导特征通讯长度 $L$。该长度 $L$ 定义为浓度 $c(x)$ 衰减至 $c_0/\\exp(1)$ 时的距离 $x$，并用扩散系数 $D$ 和一级速率常数 $k$ 表示。\n\n3) 利用你得到的 $L$ 的结果，使用给定的 $D$ 值和从已报道的半衰期推断出的 $k$ 值，计算在pH $8.0$条件下两种AHL的特征通讯长度之比 $L_{\\mathrm{A}}/L_{\\mathrm{B}}$。将此比值作为你的唯一数值答案报告。将最终答案四舍五入至四位有效数字。最终报告的比值是无量纲的。\n\n在你的推理中，解释计算出的分数和长度尺度如何体现这些信号在碱性生物膜中的预期通讯范围，但只需报告比值 $L_{\\mathrm{A}}/L_{\\mathrm{B}}$ 作为你的最终答案。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 过程：酰基高丝氨酸内酯 (AHL) 在碱性生物膜中的一级水解。\n- 信号AHL-A:\n  - 半衰期：在pH $8.0$时为 $t_{1/2,\\mathrm{A}} = 0.80$ 小时。\n  - 扩散系数：$D_{\\mathrm{A}} = 1.2 \\times 10^{-10}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$。\n- 信号AHL-B:\n  - 半衰期：在pH $8.0$时为 $t_{1/2,\\mathrm{B}} = 5.0$ 小时。\n  - 扩散系数：$D_{\\mathrm{B}} = 0.8 \\times 10^{-10}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$。\n- 反应-扩散模型：一维稳态方程为 $D \\frac{d^2c}{dx^2} - kc = 0$。\n- 边界条件：$c(0) = c_0$ 且当 $x \\to \\infty$ 时 $c(x)$ 保持有界。\n- 定义：特征通讯长度 $L$ 是指当 $c(x) = c_0/\\exp(1)$ 时的距离 $x$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在科学上是合理的。它使用化学动力学（一级衰变）和质量传输（菲克扩散）的标准原​​理来模拟一个公认的生物现象——生物膜中的群体感应。所提供的反应-扩散方程是经历一级衰变的物种的正确一维稳态表示。\n- **适定性**：该问题是适定的。物理参数已提供，控制方程和边界条件已指定，任务定义清晰，可以得出一个唯一且稳定的解。\n- **客观性**：问题以客观、定量的语言陈述，没有歧义或主观论断。\n\n**步骤3：结论与行动**\n该问题是有效的。它是生物物理化学和化学反应工程中的一个标准练习题，基于正确的物理和数学原理。可以开始求解过程。\n\n按要求，解答分为三个部分。\n\n**第1部分：在指定时间后剩余AHL的比例**\n\n对于一级过程，物质在时间 $t$ 的浓度 $C(t)$ 由以下速率定律给出：\n$$C(t) = C(0) \\exp(-kt)$$\n其中 $C(0)$ 是初始浓度，$k$ 是一级速率常数。半衰期 $t_{1/2}$ 是浓度降至其初始值一半所需的时间，即 $C(t_{1/2}) = C(0)/2$。将此代入速率定律可得：\n$$\\frac{C(0)}{2} = C(0) \\exp(-k t_{1/2})$$\n$$\\frac{1}{2} = \\exp(-k t_{1/2})$$\n对两边取自然对数，可得：\n$$\\ln\\left(\\frac{1}{2}\\right) = -k t_{1/2}$$\n$$-\\ln(2) = -k t_{1/2}$$\n因此，一级过程的速率常数与半衰期之间的关系是：\n$$k = \\frac{\\ln(2)}{t_{1/2}}$$\n剩余AHL的比例 $f(t)$ 是 $C(t)/C(0)$ 的比值：\n$$f(t) = \\frac{C(t)}{C(0)} = \\exp(-kt)$$\n代入 $k$ 的表达式：\n$$f(t) = \\exp\\left(-\\frac{\\ln(2)}{t_{1/2}}t\\right) = \\exp\\left(\\ln\\left(2^{-t/t_{1/2}}\\right)\\right) = 2^{-t/t_{1/2}}$$\n我们计算在 $t = 2.0$ 小时时每种AHL的这个比例。\n\n对于AHL-A，其 $t_{1/2,\\mathrm{A}} = 0.80$ 小时：\n$$f_{\\mathrm{A}}(2.0\\ \\mathrm{h}) = 2^{-2.0/0.80} = 2^{-2.5} \\approx 0.1768$$\n对于AHL-B，其 $t_{1/2,\\mathrm{B}} = 5.0$ 小时：\n$$f_{\\mathrm{B}}(2.0\\ \\mathrm{h}) = 2^{-2.0/5.0} = 2^{-0.4} \\approx 0.7579$$\n这些值表明，在充分混合的环境中，AHL-A的降解速度明显快于AHL-B。\n\n**第2部分：特征通讯长度 $L$ 的推导**\n\n我们必须求解稳态反应-扩散方程，以得到浓度分布 $c(x)$：\n$$D \\frac{d^2c}{dx^2} - kc = 0$$\n这是一个二阶、线性、齐次常微分方程，其系数为常数。其特征方程是：\n$$Dr^2 - k = 0$$\n方程的根为 $r = \\pm\\sqrt{k/D}$。因此，通解为：\n$$c(x) = A_{1} \\exp\\left(\\sqrt{\\frac{k}{D}}x\\right) + A_{2} \\exp\\left(-\\sqrt{\\frac{k}{D}}x\\right)$$\n其中 $A_1$ 和 $A_2$ 是由边界条件决定的常数。\n第一个边界条件是 $c(0) = c_0$：\n$$c_0 = A_{1}\\exp(0) + A_{2}\\exp(0) = A_1 + A_2$$\n第二个边界条件是当 $x \\to \\infty$ 时，$c(x)$ 必须有界。由于当 $x \\to \\infty$ 时，$\\exp\\left(\\sqrt{\\frac{k}{D}}x\\right)$ 项会无界增长，为了满足该边界条件，其系数必须为零，即 $A_1 = 0$。\n根据第一个条件，我们得到 $A_2 = c_0$。因此，浓度分布的特解是：\n$$c(x) = c_0 \\exp\\left(-\\sqrt{\\frac{k}{D}}x\\right)$$\n特征通讯长度 $L$ 定义为浓度衰减至 $c_0/\\exp(1)$ 时的距离 $x$。我们令 $x=L$ 且 $c(L) = c_0 \\exp(-1)$：\n$$c_0 \\exp(-1) = c_0 \\exp\\left(-\\sqrt{\\frac{k}{D}}L\\right)$$\n令指数相等：\n$$-1 = -\\sqrt{\\frac{k}{D}}L$$\n求解 $L$ 得到特征长度的表达式：\n$$L = \\frac{1}{\\sqrt{k/D}} = \\sqrt{\\frac{D}{k}}$$\n该长度尺度代表了信号分子在被反应有效去除之前可以扩散的距离。\n\n**第3部分：特征长度之比 $L_{\\mathrm{A}}/L_{\\mathrm{B}}$ 的计算**\n\n使用推导出的 $L$ 表达式，比值 $L_{\\mathrm{A}}/L_{\\mathrm{B}}$ 为：\n$$\\frac{L_{\\mathrm{A}}}{L_{\\mathrm{B}}} = \\frac{\\sqrt{D_{\\mathrm{A}}/k_{\\mathrm{A}}}}{\\sqrt{D_{\\mathrm{B}}/k_{\\mathrm{B}}}} = \\sqrt{\\frac{D_{\\mathrm{A}}}{k_{\\mathrm{A}}} \\cdot \\frac{k_{\\mathrm{B}}}{D_{\\mathrm{B}}}} = \\sqrt{\\left(\\frac{D_{\\mathrm{A}}}{D_{\\mathrm{B}}}\\right)\\left(\\frac{k_{\\mathrm{B}}}{k_{\\mathrm{A}}}\\right)}$$\n我们将关系式 $k = \\ln(2)/t_{1/2}$ 代入速率常数之比中：\n$$\\frac{k_{\\mathrm{B}}}{k_{\\mathrm{A}}} = \\frac{\\ln(2)/t_{1/2,\\mathrm{B}}}{\\ln(2)/t_{1/2,\\mathrm{A}}} = \\frac{t_{1/2,\\mathrm{A}}}{t_{1/2,\\mathrm{B}}}$$\n长度之比的表达式变为：\n$$\\frac{L_{\\mathrm{A}}}{L_{\\mathrm{B}}} = \\sqrt{\\left(\\frac{D_{\\mathrm{A}}}{D_{\\mathrm{B}}}\\right)\\left(\\frac{t_{1/2,\\mathrm{A}}}{t_{1/2,\\mathrm{B}}}\\right)}$$\n现在，我们代入给定的数值：\n$D_{\\mathrm{A}} = 1.2 \\times 10^{-10}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$\n$D_{\\mathrm{B}} = 0.8 \\times 10^{-10}$ $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$\n$t_{1/2,\\mathrm{A}} = 0.80$ 小时\n$t_{1/2,\\mathrm{B}} = 5.0$ 小时\n\n$D$ 和 $t_{1/2}$ 的单位在比值中会消去，因此无需单位换算。\n$$\\frac{D_{\\mathrm{A}}}{D_{\\mathrm{B}}} = \\frac{1.2 \\times 10^{-10}}{0.8 \\times 10^{-10}} = \\frac{1.2}{0.8} = 1.5$$\n$$\\frac{t_{1/2,\\mathrm{A}}}{t_{1/2,\\mathrm{B}}} = \\frac{0.80}{5.0} = 0.16$$\n将这些值代入长度之比的表达式中：\n$$\\frac{L_{\\mathrm{A}}}{L_{\\mathrm{B}}} = \\sqrt{1.5 \\times 0.16} = \\sqrt{0.24}$$\n计算数值并将结果四舍五入至四位有效数字：\n$$\\frac{L_{\\mathrm{A}}}{L_{\\mathrm{B}}} \\approx 0.4898979... \\approx 0.4899$$\n该比值小于1，表明AHL-A的特征通讯长度明显短于AHL-B。这是AHL-A更快的水解速率（即更短的半衰期）所带来的直接结果，其影响超过了其略快的扩散速率。因此，在碱性生物膜中，AHL-A充当短程信号，而AHL-B能够介导更长距离的通讯。", "answer": "$$\\boxed{0.4899}$$", "id": "2481839"}, {"introduction": "细菌能够利用精密的基因线路，将信号传播过程中的物理和化学限制转化为优势，从而创造出引人注目的基因表达空间图谱。本计算练习将指导您建立一个系统层面的模型，该模型耦合了反应-扩散物理学与基因调控的非线性逻辑（希尔函数）。通过模拟一个可扩散信号如何在不同浓度阈值下激活或抑制基因表达，您将亲眼见证简单的局部规则如何涌现出复杂的宏观组织，例如分化细胞形成的条纹状图案 [@problem_id:2481788]。", "problem": "构建一个基于第一性原理的、有原则的模型，用于描述由产生自动诱导物的发送菌株和对自动诱导物作出响应的接收菌株组成的一维生物膜中的空间条纹形成。使用以下基本原理：Fick 扩散定律、线性一阶衰减和 Hill 型转录调控。\n\n一个发送菌株带占据一维域的中心区域，产生一种会扩散和降解的自动诱导物。接收细胞遍布整个域。设空间域为 $x \\in [-L,L]$，在 $x=-L$ 和 $x=L$ 处具有反射（零通量）边界。自动诱导物的稳态浓度 $A(x)$ 满足由 Fick 定律、线性衰减和空间局域源所隐含的质量平衡：\n- Fick 定律：扩散通量为 $J(x) = -D \\,\\frac{dA}{dx}$。\n- 稳态守恒：$\\frac{d}{dx} J(x) - \\mu A(x) + q\\, s(x) = 0$。\n- 将以上两者结合，得到稳态偏微分方程\n$$\n0 = D \\frac{d^2 A}{dx^2} - \\mu A(x) + q \\, s(x),\n$$\n其诺伊曼边界条件为\n$$\n\\left.\\frac{dA}{dx}\\right|_{x=-L} = 0, \\quad \\left.\\frac{dA}{dx}\\right|_{x=+L} = 0.\n$$\n此处，$D$ 是扩散系数，$\\mu$ 是一阶衰减率，$q$ 是发送菌株带内的均匀产生速率，$s(x)$ 是发送菌株占据函数\n$$\ns(x) = \\begin{cases}\n1 & \\text{if } |x| \\le \\frac{w}{2},\\\\\n0 & \\text{if } |x| > \\frac{w}{2},\n\\end{cases}\n$$\n其中 $w$ 是发送菌株带的宽度。所有量均为无量纲。\n\n接收菌株通过两个相对的 Hill 模块（一个激活模块和一个抑制模块）满足带通条件时，报告为“开启”状态：\n- 激活 Hill 函数 $H_{\\text{on}}(A) = \\frac{A^{n_{\\text{on}}}}{K_{\\text{on}}^{n_{\\text{on}}} + A^{n_{\\text{on}}}}$，\n- 抑制 Hill 函数 $H_{\\text{off}}(A) = \\frac{A^{n_{\\text{off}}}}{K_{\\text{off}}^{n_{\\text{off}}} + A^{n_{\\text{off}}}}$。\n定义在位置 $x$ 处的接收菌株为“开启”，当且仅当 $H_{\\text{on}}(A(x)) \\ge \\tau$ 和 $H_{\\text{off}}(A(x)) \\le \\tau$ 同时成立，决策阈值为 $\\tau = \\frac{1}{2}$。这等效于对 $A(x)$ 施加一个围绕 $K_{\\text{on}}$ 和 $K_{\\text{off}}$ 的带通窗口。\n\n定义“条纹”为一个连续的位置区间，在该区间内接收菌株处于“开启”状态，并且该区间完全位于仅接收菌株区域 $\\{x: |x| > \\frac{w}{2}\\}$ 内（即，不包括发送菌株占据的带）。对于每个参数集，最终要计算的是这种不相交连续区间的整数数量。\n\n算法要求：\n- 将域 $[-L,L]$ 离散化为 $N$ 个均匀间隔的网格点，其中 $N$ 为奇数（以精确包含 $x=0$）。您必须使用 $N=2001$。设网格间距为 $\\Delta x = \\dfrac{2L}{N-1}$。\n- 在内部使用二阶中心差分，在边界使用单侧二阶诺伊曼边界模板来离散化稳态方程。对于内部网格索引 $i$，\n$$\nD \\frac{A_{i-1} - 2 A_i + A_{i+1}}{\\Delta x^2} - \\mu A_i + q\\, s_i = 0.\n$$\n对于边界索引 $i=0$ 和 $i=N-1$，通过标准的虚拟点消除法施加零通量条件，得到\n$$\nD \\frac{2(A_{1} - A_{0})}{\\Delta x^2} - \\mu A_{0} + q\\, s_{0} = 0,\n$$\n$$\nD \\frac{2(A_{N-2} - A_{N-1})}{\\Delta x^2} - \\mu A_{N-1} + q\\, s_{N-1} = 0.\n$$\n- 组装得到的线性系统并求解大小为 $N$ 的稳态向量 $\\mathbf{A}$。\n- 对每个网格点计算 $H_{\\text{on}}(A_i)$ 和 $H_{\\text{off}}(A_i)$，如果 $H_{\\text{on}}(A_i) \\ge \\frac{1}{2}$、$H_{\\text{off}}(A_i) \\le \\frac{1}{2}$ 且 $|x_i| > \\frac{w}{2}$，则声明网格点 $i$ 处的接收菌株为“开启”。\n- 计算满足“开启”条件的不相交连续网格点段的数量。一个段是满足条件的连续索引的最大集合；将每个这样的最大集合计为一个条纹。\n\n所有变量和参数均为无量纲。\n\n测试套件：\n为以下四个参数集提供结果（每行列出 $(D,\\mu,L,w,q,K_{\\text{on}},K_{\\text{off}},n_{\\text{on}},n_{\\text{off}})$）：\n- 情况 1：$(1.0,\\,1.0,\\,10.0,\\,2.0,\\,1.0,\\,0.2,\\,0.6,\\,2.0,\\,2.0)$。\n- 情况 2：$(1.0,\\,1.0,\\,10.0,\\,2.0,\\,0.1,\\,0.2,\\,0.6,\\,2.0,\\,2.0)$。\n- 情况 3：$(1.0,\\,1.0,\\,10.0,\\,2.0,\\,1.0,\\,1.2,\\,2.0,\\,2.0,\\,2.0)$。\n- 情况 4：$(0.5,\\,1.0,\\,10.0,\\,2.0,\\,1.0,\\,0.2,\\,0.6,\\,2.0,\\,2.0)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[r_1,r_2,r_3,r_4]$），其中 $r_j$ 是为测试用例 $j$ 检测到的条纹的整数数量。\n\n交付物：\n- 一个单一、完整、可运行的程序，该程序构建有限差分系统，求解 $A(x)$，评估接收菌株“开启”掩码，计算条纹数量，并以精确的所需格式打印四个测试用例的结果，不含任何额外文本或空白。", "solution": "该问题陈述已经过严格验证，并被确定为是合理的。它在科学上基于反应-扩散系统和分子生物学的既定原理，在数学上是适定的，并且其规定具有足够、无歧义的细节，从而可以得到唯一、可验证的解。该问题没有逻辑矛盾、事实错误或主观论断。因此，提供一个完整的解是合理的。\n\n该问题要求确定接收微生物菌株响应可扩散的自动诱导物分子 $A$ 而形成的空间条纹的数量。该系统在一个空间维度 $x$ 上建模，域为 $x \\in [-L, L]$。\n\n模型的核心是自动诱导物浓度 $A(x)$ 的稳态反应-扩散方程：\n$$\nD \\frac{d^2 A}{dx^2} - \\mu A(x) + q \\, s(x) = 0\n$$\n该方程表示了扩散（第一项，来自 Fick 定律）、一阶衰减（第二项）和产生（第三项）之间的平衡。这里，$D$ 是扩散系数，$\\mu$ 是衰减率常数，$q$ 是产生速率。产生仅发生在宽度为 $w$ 的中心发送细胞带内，由源函数描述：\n$$\ns(x) = \\begin{cases}\n1 & \\text{if } |x| \\le \\frac{w}{2},\\\\\n0 & \\text{if } |x| > \\frac{w}{2}.\n\\end{cases}\n$$\n域是封闭的，具有零通量（诺伊曼）边界条件，这反映了没有自动诱导物可以离开系统：\n$$\n\\left.\\frac{dA}{dx}\\right|_{x=-L} = 0, \\quad \\left.\\frac{dA}{dx}\\right|_{x=+L} = 0.\n$$\n为了数值求解这个边值问题，我们对空间域进行离散化。区间 $[-L, L]$ 被划分为 $N = 2001$ 个均匀间隔的网格点，$x_i = -L + i \\cdot \\Delta x$，其中 $i \\in \\{0, 1, \\dots, N-1\\}$，网格间距为 $\\Delta x = \\frac{2L}{N-1}$。这些点上的浓度表示为 $A_i = A(x_i)$。\n\n微分方程使用有限差分进行近似。对于内部网格点 $i$（其中 $1 \\le i \\le N-2$），使用二阶中心差分格式来近似二阶导数：\n$$\n\\left.\\frac{d^2 A}{dx^2}\\right|_{x_i} \\approx \\frac{A_{i-1} - 2 A_i + A_{i+1}}{\\Delta x^2}.\n$$\n将此代入控制方程，为每个内部点产生一个线性代数方程：\n$$\nD \\frac{A_{i-1} - 2 A_i + A_{i+1}}{\\Delta x^2} - \\mu A_i + q s_i = 0.\n$$\n对于边界点 $i=0$ 和 $i=N-1$，使用指定的二阶精确模板（由消除域外“虚拟点”产生）来强制执行零通量条件：\n对于 $i=0$：\n$$\nD \\frac{2(A_1 - A_0)}{\\Delta x^2} - \\mu A_0 + q s_0 = 0.\n$$\n对于 $i=N-1$：\n$$\nD \\frac{2(A_{N-2} - A_{N-1})}{\\Delta x^2} - \\mu A_{N-1} + q s_{N-1} = 0.\n$$\n这组 $N$ 个线性方程可以表示为矩阵形式 $\\mathbf{M} \\mathbf{A} = \\mathbf{b}$，其中 $\\mathbf{A} = [A_0, A_1, \\dots, A_{N-1}]^T$ 是未知浓度向量，$\\mathbf{M}$ 是一个 $N \\times N$ 的系数矩阵，$\\mathbf{b}$ 是一个 $N \\times 1$ 的源向量。\n\n通过重新整理离散化方程，我们可以构建矩阵 $\\mathbf{M}$ 和向量 $\\mathbf{b}$：\n第 $i$ 个方程的一般形式是：\n$$\n\\left(\\frac{D}{\\Delta x^2}\\right) A_{i-1} - \\left(\\frac{2D}{\\Delta x^2} + \\mu\\right) A_i + \\left(\\frac{D}{\\Delta x^2}\\right) A_{i+1} = -q s_i, \\quad \\text{for } 1 \\le i \\le N-2.\n$$\n边界方程是：\n$$\n-\\left(\\frac{2D}{\\Delta x^2} + \\mu\\right) A_0 + \\left(\\frac{2D}{\\Delta x^2}\\right) A_1 = -q s_0, \\quad \\text{for } i=0.\n$$\n$$\n\\left(\\frac{2D}{\\Delta x^2}\\right) A_{N-2} - \\left(\\frac{2D}{\\Delta x^2} + \\mu\\right) A_{N-1} = -q s_{N-1}, \\quad \\text{for } i=N-1.\n$$\n根据这些表达式，三对角矩阵 $\\mathbf{M}$ 具有以下非零元素：\n- 主对角线：$M_{i,i} = -(\\frac{2D}{\\Delta x^2} + \\mu)$，对于所有 $i \\in \\{0, \\dots, N-1\\}$。\n- 上对角线：$M_{i,i+1} = \\frac{D}{\\Delta x^2}$，对于 $i \\in \\{1, \\dots, N-2\\}$，以及一个特殊的边界项 $M_{0,1} = \\frac{2D}{\\Delta x^2}$。\n- 下对角线：$M_{i,i-1} = \\frac{D}{\\Delta x^2}$，对于 $i \\in \\{1, \\dots, N-2\\}$，以及一个特殊的边界项 $M_{N-1,N-2} = \\frac{2D}{\\Delta x^2}$。\n源向量 $\\mathbf{b}$ 的元素为 $b_i = -q s_i$，其中如果 $|x_i| \\le \\frac{w}{2}$，则 $s_i = 1$，否则 $s_i = 0$。系统 $\\mathbf{M} \\mathbf{A} = \\mathbf{b}$ 使用标准线性求解器求解向量 $\\mathbf{A}$。\n\n一旦获得稳态浓度分布 $\\mathbf{A}$，我们确定接收菌株的响应。如果两个条件同时满足：$H_{\\text{on}}(A_i) \\ge \\frac{1}{2}$ 和 $H_{\\text{off}}(A_i) \\le \\frac{1}{2}$，则位置 $x_i$ 处的接收菌株为“开启”。阈值为 $\\tau = \\frac{1}{2}$ 的 Hill 函数阈值条件可以显著简化。对于激活 Hill 函数 $H_{\\text{on}}(A) = \\frac{A^{n_{\\text{on}}}}{K_{\\text{on}}^{n_{\\text{on}}} + A^{n_{\\text{on}}}}$，条件 $H_{\\text{on}}(A) \\ge \\frac{1}{2}$ 等价于 $A \\ge K_{\\text{on}}$。类似地，对于此处用于“关闭”逻辑的抑制 Hill 函数 $H_{\\text{off}}(A) = \\frac{A^{n_{\\text{off}}}}{K_{\\text{off}}^{n_{\\text{off}}} + A^{n_{\\text{off}}}}$，条件 $H_{\\text{off}}(A) \\le \\frac{1}{2}$ 等价于 $A \\le K_{\\text{off}}$。因此，当且仅当浓度 $A_i$ 落在带通窗口 $[K_{\\text{on}}, K_{\\text{off}}]$ 内时，接收菌株为“开启”。Hill 系数 $n_{\\text{on}}$ 和 $n_{\\text{off}}$ 的具体值不影响阈值，只影响响应的陡峭程度。\n\n“条纹”被定义为一个连续区域，其中接收菌株是“开启”的，*并且*该区域位于发送菌株带之外，即 $|x_i| > \\frac{w}{2}$。为了计算条纹的数量，我们首先为网格点构建一个布尔掩码，如果 $K_{\\text{on}} \\le A_i \\le K_{\\text{off}}$ 并且 $|x_i| > \\frac{w}{2}$，则该掩码为真。然后，我们计算该掩码中不相交的连续真值块的数量。这在算法上是通过找到掩码沿空间轴从假到真转换的次数来实现的。通过在掩码的开头填充一个假值，可以通过对连续元素之间差值为 1 的出现次数求和来稳健地计算此计数。\n\n将此过程应用于测试套件中提供的每个参数集，以计算条纹的最终整数数量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D reaction-diffusion problem for biofilm stripe formation\n    for a given set of test cases.\n    \"\"\"\n    # Test cases: (D, mu, L, w, q, K_on, K_off, n_on, n_off)\n    test_cases = [\n        (1.0, 1.0, 10.0, 2.0, 1.0, 0.2, 0.6, 2.0, 2.0),\n        (1.0, 1.0, 10.0, 2.0, 0.1, 0.2, 0.6, 2.0, 2.0),\n        (1.0, 1.0, 10.0, 2.0, 1.0, 1.2, 2.0, 2.0, 2.0),\n        (0.5, 1.0, 10.0, 2.0, 1.0, 0.2, 0.6, 2.0, 2.0),\n    ]\n\n    results = []\n    \n    # Numerical parameters specified in the problem\n    N = 2001\n\n    for case in test_cases:\n        D, mu, L, w, q, K_on, K_off, n_on, n_off = case\n\n        # 1. Discretize the domain\n        x = np.linspace(-L, L, N)\n        dx = 2.0 * L / (N - 1.0)\n\n        # 2. Construct the linear system M*A = b\n        M = np.zeros((N, N))\n        \n        # Coefficients from finite difference stencil\n        dx2 = dx * dx\n        alpha_interior = D / dx2\n        alpha_boundary = 2.0 * D / dx2\n        diag_main = -(alpha_boundary + mu)\n\n        # Fill the matrix M\n        # Main diagonal\n        np.fill_diagonal(M, diag_main)\n        \n        # Upper and lower diagonals for interior points\n        np.fill_diagonal(M[1:], alpha_interior)  # Lower diagonal\n        np.fill_diagonal(M[:, 1:], alpha_interior)  # Upper diagonal\n        \n        # Correct boundary condition terms\n        M[0, 1] = alpha_boundary\n        M[N - 1, N - 2] = alpha_boundary\n        \n        # Construct the source vector b\n        s = np.zeros(N)\n        s[np.abs(x) <= w / 2.0] = 1.0\n        b = -q * s\n\n        # 3. Solve the linear system for the concentration profile A\n        A = np.linalg.solve(M, b)\n\n        # 4. Determine receiver state and identify stripes\n        # The condition H_on(A) >= 1/2 and H_off(A) <= 1/2 with tau=1/2\n        # simplifies to K_on <= A <= K_off.\n        is_on_concentration = (A >= K_on) & (A <= K_off)\n        \n        # A stripe must be in the receiver-only region\n        is_in_receiver_region = np.abs(x) > w / 2.0\n        \n        # Combine conditions to get the final \"on\" mask for stripes\n        is_stripe_point = is_on_concentration & is_in_receiver_region\n\n        # 5. Count the number of disjoint contiguous segments (stripes)\n        # Pad with False at the beginning to correctly count stripes starting at index 0.\n        padded_mask = np.insert(is_stripe_point, 0, False)\n        # A transition from False to True (0 to 1) marks the start of a stripe.\n        # The number of such transitions is the number of stripes.\n        stripe_starts = np.diff(padded_mask.astype(np.int8)) == 1\n        num_stripes = np.sum(stripe_starts)\n        \n        results.append(num_stripes)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2481788"}]}