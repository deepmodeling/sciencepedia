{"hands_on_practices": [{"introduction": "要理解深部生物圈这个广阔而隐秘的生态系统，我们首先必须明确其物理边界。温度是所有生命的主要限制因素，而在地壳中，温度随深度增加。本实践将指导您完成一项基本的地球物理计算，根据传导热流和已知的超嗜热微生物的耐热极限，估算微生物生命能够持续存在的最大深度 [@problem_id:2486101]。这个练习将宏观的行星过程与生命的绝对极限联系起来，为您提供一个量化宜居带范围的框架。", "problem": "在远离剧烈热液循环的洋脊侧翼区的海洋岩石圈，实测的海底地表热流主要由热传导控制。假设为一维（1D）稳态垂直热传导，物性恒定且无内部热源。海底上覆一层厚度为 $h_{s}$、体热导率为 $k_{s}$ 的饱和远洋沉积物，其下为热导率为 $k_{c}$ 的上层玄武岩海洋地壳。海底向上的传导性地表热流大小为 $q$（向上为正）。沉积物-水界面的底层水温为 $T_{0}$。维持活跃微生物生命的温度上限为 $T_{\\mathrm{lim}}$。\n\n使用傅里叶热传导定律和地温梯度的定义，并将温度随深度增加的方向（向下）视为正方向，完成以下任务：\n\n- 推导沉积物内和玄武岩地壳内的地温梯度。\n- 确定考虑到有限厚度的沉积物层，温度首次达到 $T_{\\mathrm{lim}}$ 的海底以下总深度。\n\n使用以下参数值，这些值是年轻至中年海洋地壳环境的典型值：$q = 0.090\\ \\mathrm{W\\,m^{-2}}$， $h_{s} = 500\\ \\mathrm{m}$， $k_{s} = 1.2\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$， $k_{c} = 2.5\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$， $T_{0} = 2\\ ^{\\circ}\\mathrm{C}$，以及 $T_{\\mathrm{lim}} = 122\\ ^{\\circ}\\mathrm{C}$。\n\n将你的最终答案报告为达到 $T_{\\mathrm{lim}}$ 时的海底以下（从沉积物-水界面算起）的总深度的单个数值。最终深度以米为单位表示，并将答案四舍五入到三位有效数字。", "solution": "首先，将对所述问题的科学性和逻辑完整性进行验证。\n\n以下是从问题陈述中逐字提取的已知条件：\n- 模型：一维（$1$D）稳态垂直热传导，物性恒定且无内部热源。\n- 沉积物层厚度：$h_{s}$\n- 沉积物体热导率：$k_{s}$\n- 上层玄武岩海洋地壳热导率：$k_{c}$\n- 向上（为正）的传导性地表热流大小：$q$\n- 沉积物-水界面（$z=0$）的底层水温：$T_{0}$\n- 维持活跃微生物生命的温度上限：$T_{\\mathrm{lim}}$\n- 坐标系：深度，用 $z$ 表示，从海底 $z=0$ 处向下增加。\n- 参数值：\n    - $q = 0.090\\ \\mathrm{W\\,m^{-2}}$\n    - $h_{s} = 500\\ \\mathrm{m}$\n    - $k_{s} = 1.2\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n    - $k_{c} = 2.5\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n    - $T_{0} = 2\\ ^{\\circ}\\mathrm{C}$\n    - $T_{\\mathrm{lim}} = 122\\ ^{\\circ}\\mathrm{C}$\n\n问题的验证过程如下：\n- **科学基础**：该问题基于物理学的基本原理——傅里叶热传导定律。所描述的情景——热流穿过海洋沉积物和地壳——是地球物理学和海洋学中的一个标准应用。所述参数值为典型值，且在物理上是合理的。$122\\ ^{\\circ}\\mathrm{C}$ 的温度上限与已知的超嗜热古菌的生存上限相对应，使得该问题与深部生物圈研究相关。该问题是科学上合理的。\n- **适定性**：该问题给出了足够的数据和约束条件（一维稳态、物性恒定、双层模型），可以得到温度剖面和 $T_{\\mathrm{lim}}$ 等温线深度的唯一解。\n- **客观性**：该问题以精确的定量语言陈述，没有模糊性、主观性或非科学性论断。\n- **其他缺陷**：该问题不违反任何其他有效性标准。在其陈述的简化条件下，它是完整的、一致的、现实的，并且并非微不足道。\n\n结论是问题有效。现在将推导解答。\n\n控制热传递的基本方程是傅里叶热传导定律。在一维情况下，沿坐标 $z$ 增加方向的热通量 $q_{z}$ 由下式给出：\n$$\nq_{z} = -k \\frac{dT}{dz}\n$$\n在本问题中，深度坐标 $z$ 向下为正。热流 $q$ 定义为向上的正值。因此，在正 $z$ 方向（向下）的热通量为 $q_{z} = -q$。将此代入傅里叶定律：\n$$\n-q = -k \\frac{dT}{dz}\n$$\n这可以简化为：\n$$\n\\frac{dT}{dz} = \\frac{q}{k}\n$$\n$\\frac{dT}{dz}$ 项是地温梯度。在稳态条件下且无内部热源时，热通量 $q$ 在穿过沉积物和地壳层时必须随深度保持恒定。\n\n首先，我们按要求推导每一层中的地温梯度。\n在沉积物层中，热导率为 $k_{s}$，地温梯度 $(\\frac{dT}{dz})_{s}$ 为：\n$$\n\\left(\\frac{dT}{dz}\\right)_{s} = \\frac{q}{k_{s}}\n$$\n在玄武岩地壳中，热导率为 $k_{c}$，地温梯度 $(\\frac{dT}{dz})_{c}$ 为：\n$$\n\\left(\\frac{dT}{dz}\\right)_{c} = \\frac{q}{k_{c}}\n$$\n这就完成了问题的第一部分。\n\n接下来，我们求出温度达到 $T_{\\mathrm{lim}}$ 的总深度 $z_{\\mathrm{lim}}$。我们必须首先确定这个温度是在沉积物层内达到，还是在其下的地壳中达到。沉积物层（$0 \\le z \\le h_{s}$）内的温度剖面可以通过对梯度进行积分得到，边界条件为 $T(0) = T_{0}$：\n$$\nT_{s}(z) = T_{0} + \\int_{0}^{z} \\frac{q}{k_{s}} dz' = T_{0} + \\frac{q}{k_{s}} z\n$$\n沉积物层底部，即深度 $z = h_{s}$ 处的温度，记为 $T_{h}$：\n$$\nT_{h} = T(h_{s}) = T_{0} + \\frac{q}{k_{s}} h_{s}\n$$\n代入给定的数值（注意，以 $^{\\circ}\\mathrm{C}$ 为单位的温差等于以 $\\mathrm{K}$ 为单位的温差）：\n$$\nT_{h} = 2\\ ^{\\circ}\\mathrm{C} + \\frac{0.090\\ \\mathrm{W\\,m^{-2}}}{1.2\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}} \\times 500\\ \\mathrm{m} = 2\\ ^{\\circ}\\mathrm{C} + (0.075\\ \\mathrm{K\\,m^{-1}}) \\times (500\\ \\mathrm{m}) = 2\\ ^{\\circ}\\mathrm{C} + 37.5\\ ^{\\circ}\\mathrm{C} = 39.5\\ ^{\\circ}\\mathrm{C}\n$$\n由于 $T_{h} = 39.5\\ ^{\\circ}\\mathrm{C}$ 小于 $T_{\\mathrm{lim}} = 122\\ ^{\\circ}\\mathrm{C}$，因此极限温度必定在玄武岩地壳内达到。\n\n地壳中的温度从界面 $z = h_{s}$ 处的 $T_{h}$ 开始增加。地壳（$z > h_{s}$）中的温度剖面由下式给出：\n$$\nT_{c}(z) = T_{h} + \\int_{h_{s}}^{z} \\frac{q}{k_{c}} dz' = T_{h} + \\frac{q}{k_{c}} (z - h_{s})\n$$\n我们要求解深度 $z = z_{\\mathrm{lim}}$，使得 $T_{c}(z_{\\mathrm{lim}}) = T_{\\mathrm{lim}}$。\n$$\nT_{\\mathrm{lim}} = T_{h} + \\frac{q}{k_{c}} (z_{\\mathrm{lim}} - h_{s})\n$$\n设 $\\Delta z_{c} = z_{\\mathrm{lim}} - h_{s}$ 是达到 $T_{\\mathrm{lim}}$ 所需进入地壳的额外深度。\n$$\n\\Delta z_{c} = \\frac{T_{\\mathrm{lim}} - T_{h}}{q/k_{c}} = \\frac{(T_{\\mathrm{lim}} - T_{h})k_{c}}{q}\n$$\n地壳内所需的温度增量为 $T_{\\mathrm{lim}} - T_{h} = 122\\ ^{\\circ}\\mathrm{C} - 39.5\\ ^{\\circ}\\mathrm{C} = 82.5\\ ^{\\circ}\\mathrm{C}$。\n我们计算 $\\Delta z_{c}$：\n$$\n\\Delta z_{c} = \\frac{(82.5\\ \\mathrm{K}) \\times (2.5\\ \\mathrm{W\\,m^{-1}\\,K^{-1}})}{0.090\\ \\mathrm{W\\,m^{-2}}} = \\frac{206.25\\ \\mathrm{W\\,m^{-1}}}{0.090\\ \\mathrm{W\\,m^{-2}}} = 2291.666... \\mathrm{m}\n$$\n海底以下的总深度 $z_{\\mathrm{lim}}$ 是沉积物厚度与进入地壳深度的和：\n$$\nz_{\\mathrm{lim}} = h_{s} + \\Delta z_{c}\n$$\n$$\nz_{\\mathrm{lim}} = 500\\ \\mathrm{m} + 2291.666... \\mathrm{m} = 2791.666... \\mathrm{m}\n$$\n问题要求答案四舍五入到三位有效数字。数值 $2791.666...$ 四舍五入到三位有效数字是 $2790$。", "answer": "$$\n\\boxed{2790}\n$$", "id": "2486101"}, {"introduction": "仅仅找到一个温度适宜的区域只是第一步；生命还需要能量来源才能生存。本练习深入探讨了在深部地下挑战性条件下一种关键微生物代谢——硫酸盐还原作用的热力学。通过使用原位化学数据并考虑非理想溶液效应来计算实际的吉布斯自由能变 $\\Delta G_r$，您将定量地评估一个特定的代谢途径是否是深部生物圈中生命的可行能量来源 [@problem_id:2486179]。", "problem": "考虑一个在温度为 $T = 2^{\\circ}\\mathrm{C}$、孔隙水离子强度为 $I = 0.10\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$ 的寒冷深海地下沉积物中通过代谢乙酸盐来进行硫酸盐还原的微生物群落。假设静水压力对化学势的影响可以忽略不计，因为净反应的摩尔体积变化很小，所以标准态压力校正可以忽略。净水相反应为\n$$\\mathrm{CH_3COO^-} + \\mathrm{SO_4^{2-}} \\rightarrow 2\\,\\mathrm{HCO_3^-} + \\mathrm{HS^-}.$$\n测得的原位质量摩尔浓度（在本计算中假设等于摩尔浓度）如下：乙酸盐 $\\mathrm{CH_3COO^-}$，$m_{\\mathrm{Ac^-}} = 3.0 \\times 10^{-6}\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$；硫酸盐 $\\mathrm{SO_4^{2-}}$，$m_{\\mathrm{SO_4^{2-}}} = 2.8 \\times 10^{-2}\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$；碳酸氢盐 $\\mathrm{HCO_3^-}$，$m_{\\mathrm{HCO_3^-}} = 6.0 \\times 10^{-3}\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$；硫氢根 $\\mathrm{HS^-}$，$m_{\\mathrm{HS^-}} = 1.5 \\times 10^{-6}\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$。将水的活度视为1。\n\n为了考虑在给定离子强度下的非理想溶液行为，使用扩展的德拜-休克尔(Debye–Hückel)关系的戴维斯(Davies)形式计算单离子活度系数 $\\gamma_i$\n$$\\log_{10}\\gamma_i \\;=\\; -A\\,z_i^2\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\,I\\right),$$\n其中在 $T = 2^{\\circ}\\mathrm{C}$ 时 $A = 0.49$，离子电荷为 $z_{\\mathrm{Ac^-}}=-1$、$z_{\\mathrm{SO_4^{2-}}}=-2$、$z_{\\mathrm{HCO_3^-}}=-1$、$z_{\\mathrm{HS^-}}=-1$。使用活度 $a_i = \\gamma_i m_i$ 计算反应商。普适气体常数为 $R = 8.314 \\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n\n在 $T_1 = 298.15\\,\\mathrm{K}$ 时，反应的标准吉布斯能为 $\\Delta G_r^{\\circ}(T_1) = -47.6\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，标准反应熵为 $\\Delta S_r^{\\circ} = +60.0\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。假设 $\\Delta H_r^{\\circ}$ 和 $\\Delta S_r^{\\circ}$ 在从 $T_1$ 到 $T = 275.15\\,\\mathrm{K}$ 的温度区间内不随温度变化。\n\n从以活度表示的化学势定义和以化学势表示的反应吉布斯能出发，并使用所提供的非理想性模型，计算在指定孔隙水成分和温度 $T = 2^{\\circ}\\mathrm{C}$ 下，该反应的实际吉布斯能变 $\\Delta G_r$。以每消耗一摩尔乙酸盐的 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位表示您的最终答案，并四舍五入到四位有效数字。", "solution": "该问题要求计算在指定的非标准温度和化学成分条件下，微生物代谢反应的实际吉布斯能变 $\\Delta G_r$。控制该反应的基本热力学关系是：\n$$ \\Delta G_r = \\Delta G_r^{\\circ}(T) + RT \\ln Q $$\n其中 $\\Delta G_r^{\\circ}(T)$ 是原位温度 $T$ 下反应的标准吉布斯能，$R$ 是普适气体常数，$Q$ 是反应商，它考虑了反应物和产物的非标准浓度。计算将分三步进行：首先，确定 $\\Delta G_r^{\\circ}(T)$；其次，计算非理想条件下的反应商 $Q$；第三，组合这些项以求得 $\\Delta G_r$。\n\n首先，我们必须对反应的标准吉布斯能进行温度校正。已知在参考温度 $T_1 = 298.15\\,\\mathrm{K}$ 时，$\\Delta G_r^{\\circ}(T_1) = -47.6\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，标准反应熵 $\\Delta S_r^{\\circ} = +60.0\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1} = +0.0600\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。根据题目要求，我们假设标准反应焓 $\\Delta H_r^{\\circ}$ 和标准反应熵 $\\Delta S_r^{\\circ}$ 在所关心的温度范围内是恒定的。\n\n标准反应焓 $\\Delta H_r^{\\circ}$ 可以利用吉布斯能的基本定义，根据 $T_1$ 时的给定数据计算得出：\n$$ \\Delta G_r^{\\circ}(T_1) = \\Delta H_r^{\\circ} - T_1 \\Delta S_r^{\\circ} $$\n整理得到 $\\Delta H_r^{\\circ}$：\n$$ \\Delta H_r^{\\circ} = \\Delta G_r^{\\circ}(T_1) + T_1 \\Delta S_r^{\\circ} $$\n代入给定值：\n$$ \\Delta H_r^{\\circ} = -47.6\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} + (298.15\\,\\mathrm{K})(0.0600\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) $$\n$$ \\Delta H_r^{\\circ} = -47.6\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} + 17.889\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} = -29.711\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\n有了 $\\Delta H_r^{\\circ}$ 和 $\\Delta S_r^{\\circ}$ 的（假设恒定）值，我们现在可以计算原位温度 $T = 2^{\\circ}\\mathrm{C} = 275.15\\,\\mathrm{K}$ 下反应的标准吉布斯能：\n$$ \\Delta G_r^{\\circ}(T) = \\Delta H_r^{\\circ} - T \\Delta S_r^{\\circ} $$\n$$ \\Delta G_r^{\\circ}(T) = -29.711\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} - (275.15\\,\\mathrm{K})(0.0600\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) $$\n$$ \\Delta G_r^{\\circ}(T) = -29.711\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} - 16.509\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} = -46.220\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\n\n第二，我们计算反应的反应商 $Q$：\n$$ \\mathrm{CH_3COO^-} + \\mathrm{SO_4^{2-}} \\rightarrow 2\\,\\mathrm{HCO_3^-} + \\mathrm{HS^-} $$\n反应商由所涉及物质的活度 $a_i$ 定义：\n$$ Q = \\frac{(a_{\\mathrm{HCO_3^-}})^{2} (a_{\\mathrm{HS^-}})}{(a_{\\mathrm{CH_3COO^-}})(a_{\\mathrm{SO_4^{2-}}})} $$\n活度 $a_i$ 通过活度系数 $\\gamma_i$ 与质量摩尔浓度 $m_i$ 相关，即 $a_i = \\gamma_i m_i$。活度系数使用提供的戴维斯(Davies)方程计算：\n$$ \\log_{10}\\gamma_i = -A\\,z_i^2\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\,I\\right) $$\n使用给定参数 $A = 0.49$ 和离子强度 $I = 0.10\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$，我们首先计算括号中的项，该项对所有离子都是共同的：\n$$ C = \\frac{\\sqrt{0.10}}{1+\\sqrt{0.10}} - 0.3(0.10) = \\frac{0.316227...}{1.316227...} - 0.03 = 0.240253... - 0.03 = 0.210253... $$\n$z_i^2$ 有两个不同的值：对于 $\\mathrm{CH_3COO^-}$、$\\mathrm{HCO_3^-}$ 和 $\\mathrm{HS^-}$，$z_i^2 = (-1)^2 = 1$；对于 $\\mathrm{SO_4^{2-}}$，$z_i^2 = (-2)^2 = 4$。\n对于一价离子 ($z_i^2=1$)，记为 $\\gamma_1$：\n$$ \\log_{10}\\gamma_1 = -0.49(1)^2(0.210253...) = -0.103024... \\implies \\gamma_1 = 10^{-0.103024...} = 0.78885... $$\n对于二价离子 ($z_i^2=4$)，记为 $\\gamma_2$：\n$$ \\log_{10}\\gamma_2 = -0.49(2)^2(0.210253...) = -0.49(4)(0.210253...) = -0.412096... \\implies \\gamma_2 = 10^{-0.412096...} = 0.38717... $$\n反应商可以表示为：\n$$ Q = \\frac{(\\gamma_1 m_{\\mathrm{HCO_3^-}})^2 (\\gamma_1 m_{\\mathrm{HS^-}})}{(\\gamma_1 m_{\\mathrm{CH_3COO^-}})(\\gamma_2 m_{\\mathrm{SO_4^{2-}}})} = \\frac{\\gamma_1^2}{\\gamma_2} \\times \\frac{(m_{\\mathrm{HCO_3^-}})^2 (m_{\\mathrm{HS^-}})}{(m_{\\mathrm{CH_3COO^-}})(m_{\\mathrm{SO_4^{2-}}})} $$\n我们代入给定的质量摩尔浓度：$m_{\\mathrm{CH_3COO^-}} = 3.0 \\times 10^{-6}$，$m_{\\mathrm{SO_4^{2-}}} = 2.8 \\times 10^{-2}$，$m_{\\mathrm{HCO_3^-}} = 6.0 \\times 10^{-3}$，以及 $m_{\\mathrm{HS^-}} = 1.5 \\times 10^{-6}\\,\\mathrm{mol}\\,\\mathrm{kg}^{-1}$。\n$$ \\frac{(m_{\\mathrm{HCO_3^-}})^2 (m_{\\mathrm{HS^-}})}{(m_{\\mathrm{CH_3COO^-}})(m_{\\mathrm{SO_4^{2-}}})} = \\frac{(6.0 \\times 10^{-3})^2(1.5 \\times 10^{-6})}{(3.0 \\times 10^{-6})(2.8 \\times 10^{-2})} = \\frac{5.4 \\times 10^{-11}}{8.4 \\times 10^{-8}} = 6.42857... \\times 10^{-4} $$\n活度系数的比值为：\n$$ \\frac{\\gamma_1^2}{\\gamma_2} = \\frac{(0.78885...)^2}{0.38717...} = \\frac{0.62228...}{0.38717...} = 1.60727... $$\n因此，反应商为：\n$$ Q = (1.60727...) \\times (6.42857... \\times 10^{-4}) = 1.03339... \\times 10^{-3} $$\n\n第三，我们结合这些结果来求得实际的吉布斯能变 $\\Delta G_r$。气体常数 $R = 8.314 \\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n$$ \\Delta G_r = \\Delta G_r^{\\circ}(T) + RT \\ln Q $$\n$$ \\Delta G_r = -46.220\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} + (8.314 \\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1})(275.15\\,\\mathrm{K}) \\ln(1.03339... \\times 10^{-3}) $$\n$$ \\Delta G_r = -46.220\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} + (2.28820... \\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1})(-6.87524...) $$\n$$ \\Delta G_r = -46.220\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} - 15.73147... \\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\n$$ \\Delta G_r = -61.95147... \\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\n根据题目要求将此结果四舍五入到四位有效数字，得到：\n$$ \\Delta G_r = -61.95\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\n负号证实了在该原位条件下反应是自发的，为微生物群落提供了能量来源。", "answer": "$$\\boxed{-61.95}$$", "id": "2486179"}, {"introduction": "微生物的集体代谢活动会在其环境中留下独特的化学指纹。本实践让您像一位生物地球化学家一样，运用数学模型来解读这些化学信号。您将推导并应用一个一维扩散-反应模型来分析海洋沉积物的浓度剖面，从而提取出微生物活动的体积速率——这是理解深部生物圈生物地球化学影响的关键参数 [@problem_id:2486110]。这项强大的技术弥合了微观过程与其在生态系统尺度上可观测效应之间的鸿沟。", "problem": "你的任务是为海洋沉积物中的硫酸盐建立一个一维稳态扩散-反应模型，以便从浓度剖面推断体积微生物硫酸盐还原速率。假设垂直坐标$z$从$z = 0$处的沉积物-水界面开始向下增加，直至$z = L$处的无通量基底。适用以下基本原理。\n\n1. 在孔隙度和曲折度恒定的多孔介质中的菲克第一定律（Fick's First Law）：扩散通量为 $J(z) = -D_e \\, \\dfrac{dC}{dz}$，其中有效扩散系数为 $D_e = D_0 \\, \\dfrac{\\phi}{\\theta^2}$，$D_0$ 是自由溶液分子扩散系数，$\\phi$ 是孔隙度，$\\theta$ 是曲折度。\n2. 无平流或生物灌溉作用下的稳态质量守恒：$0 = \\dfrac{d}{dz}\\left(D_e \\, \\dfrac{dC}{dz}\\right) - R(C)$，其中 $R(C)$ 是硫酸盐消耗（微生物硫酸盐还原）的体积汇项，可为零级反应 $R(C) = R_0$ 或一级反应 $R(C) = k \\, C$。\n3. 边界条件：顶部的狄利克雷条件（Dirichlet condition）$C(0) = C_0$，以及基底的诺伊曼无通量条件（Neumann no-flux condition）$\\dfrac{dC}{dz}(L) = 0$。\n\n你的任务是：\n\nA. 仅从上述基本原理出发，推导在给定边界条件下两种反应模型（零级反应 $R(C) = R_0$ 和一级反应 $R(C) = k \\, C$）的稳态剖面 $C(z)$。请用 $z$、$L$、$C_0$、$D_e$ 和速率参数（$R_0$ 或 $k$）显式表达 $C(z)$。\n\nB. 设计一个最小二乘估计器，从一组在深度 $\\{z_i\\}$ 处测得的浓度数据中推断体积速率参数：\n- 对于零级模型，利用 $C(z)$ 对 $R_0$ 的线性关系，推导 $R_0$ 的闭式最小二乘估计器。\n- 对于一级模型，构建一个关于 $k$ 的单参数非线性最小二乘目标函数，并提出一种稳健的数值策略，以在有界区间 $[0, K_{\\max}]$ 上找到其最小值点。\n\nC. 实现一个程序，为下述每个测试用例计算 $D_e$，选择合适的模型，通过最小二乘法拟合速率参数，并返回拟合后的参数。使用以下测试套件。所有物理单位均采用国际单位制（SI）。深度 $z$ 和 $L$ 的单位是 $\\mathrm{m}$。扩散系数 $D_0$ 和 $D_e$ 的单位是 $\\mathrm{m^2 \\, s^{-1}}$。浓度 $C$ 的单位是 $\\mathrm{mol \\, m^{-3}}$。零级速率 $R_0$ 的单位是 $\\mathrm{mol \\, m^{-3} \\, s^{-1}}$。一级速率常数 $k$ 的单位是 $\\mathrm{s^{-1}}$。\n\n测试用例1（理想情况，零级反应）：\n- $D_0 = $ $5.0 \\times 10^{-10}$，$\\phi = $ $0.7$，$\\theta = $ $2.5$，$L = $ $0.4$，$C_0 = $ $28.0$。\n- 深度 $z_i$ (单位 $\\mathrm{m}$)：$[\\, 0.0,\\; 0.05,\\; 0.1,\\; 0.2,\\; 0.3,\\; 0.4 \\,]$。\n- 测量浓度 $C_i$ (单位 $\\mathrm{mol \\, m^{-3}}$)：$[\\, 28.0,\\; 27.66517857142857,\\; 27.375,\\; 26.92857142857143,\\; 26.660714285714286,\\; 26.57142857142857 \\,]$。\n\n测试用例2（非线性一级反应）：\n- $D_0 = $ $5.0 \\times 10^{-10}$，$\\phi = $ $0.7$，$\\theta = $ $2.0$，$L = $ $0.5$，$C_0 = $ $28.0$。\n- 深度 $z_i$ (单位 $\\mathrm{m}$)：$[\\, 0.0,\\; 0.1,\\; 0.2,\\; 0.3,\\; 0.4,\\; 0.5 \\,]$。\n- 测量浓度 $C_i$ (单位 $\\mathrm{mol \\, m^{-3}}$)：$[\\, 28.0,\\; 19.185298634,\\; 13.473093861,\\; 9.956622656,\\; 8.045416193,\\; 7.442462403 \\,]$。\n\n测试用例3（边界情况，无反应，零级模型）：\n- $D_0 = $ $5.0 \\times 10^{-10}$，$\\phi = $ $0.8$，$\\theta = $ $2.0$，$L = $ $0.3$，$C_0 = $ $20.0$。\n- 深度 $z_i$ (单位 $\\mathrm{m}$)：$[\\, 0.0,\\; 0.05,\\; 0.1,\\; 0.2,\\; 0.3 \\,]$。\n- 测量浓度 $C_i$ (单位 $\\mathrm{mol \\, m^{-3}}$)：$[\\, 20.0,\\; 20.0,\\; 20.0,\\; 20.0,\\; 20.0 \\,]$。\n\n实现细节和要求的输出：\n- 对每个用例使用 $D_e = D_0 \\, \\dfrac{\\phi}{\\theta^2}$。\n- 对于零级模型，估计 $R_0$ (单位 $\\mathrm{mol \\, m^{-3} \\, s^{-1}}$)。\n- 对于一级模型，估计 $k$ (单位 $\\mathrm{s^{-1}}$)。\n- 以SI单位表示最终的拟合速率，每个结果都格式化为科学记数法，小数点后保留六位数字，并使用小写指数符号（例如，$1.234567\\mathrm{e}{-08}$）。在此格式下，将每个估计值四舍五入到小数点后六位。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，结果按测试用例的顺序排列，例如：$[r_1,r_2,r_3]$，其中每个 $r_i$ 是相应测试用例的格式化估计值。", "solution": "问题陈述已经过验证，被认为是科学上合理、适定且完整的。它描述了一个一维扩散-反应系统的标准边值问题，这是地球化学和微生物学中的一个基本模型。所有参数和条件都已指明，可以得到唯一且有意义的解。我们可以开始推导。\n\n对于浓度为 $C$ 的溶质，其一维（$z$）通用稳态扩散-反应方程如下：\n$$\n\\dfrac{d}{dz}\\left(D_e \\, \\dfrac{dC}{dz}\\right) - R(C) = 0\n$$\n其中 $D_e$ 是恒定的有效扩散系数，$R(C)$ 是体积反应速率。定义域为 $z \\in [0, L]$。边界条件为表面的固定浓度 $C(0) = C_0$ 和基底的无通量条件 $\\dfrac{dC}{dz}(L) = 0$。\n\n**A. 浓度剖面的推导**\n\n我们推导零级和一级反应动力学下的解析解 $C(z)$。\n\n**1. 零级反应模型**\n\n对于零级反应，速率是恒定的：$R(C) = R_0$。控制微分方程简化为：\n$$\nD_e \\dfrac{d^2C}{dz^2} = R_0\n$$\n对 $z$ 积分一次，得到通量方程：\n$$\n\\dfrac{dC}{dz} = \\dfrac{R_0}{D_e} z + A\n$$\n其中 $A$ 是一个积分常数。应用基底的无通量边界条件 $\\dfrac{dC}{dz}(L) = 0$：\n$$\n0 = \\dfrac{R_0}{D_e} L + A \\implies A = -\\dfrac{R_0 L}{D_e}\n$$\n将 $A$ 代回，得到浓度梯度：\n$$\n\\dfrac{dC}{dz} = \\dfrac{R_0}{D_e} (z - L)\n$$\n对 $z$ 进行二次积分，得到浓度剖面：\n$$\nC(z) = \\dfrac{R_0}{D_e} \\left( \\dfrac{z^2}{2} - Lz \\right) + B\n$$\n其中 $B$ 是第二个积分常数。应用表面的狄利克雷边界条件 $C(0) = C_0$：\n$$\nC_0 = \\dfrac{R_0}{D_e} (0) + B \\implies B = C_0\n$$\n因此，零级动力学下浓度剖面的显式解为：\n$$\nC(z) = C_0 + \\dfrac{R_0}{D_e} \\left( \\dfrac{z^2}{2} - Lz \\right)\n$$\n\n**2. 一级反应模型**\n\n对于一级反应，速率与浓度成正比：$R(C) = kC$。控制方程是一个二阶齐次线性常微分方程：\n$$\nD_e \\dfrac{d^2C}{dz^2} - kC = 0 \\quad \\text{或} \\quad \\dfrac{d^2C}{dz^2} - \\lambda^2 C = 0\n$$\n其中我们定义特征长度尺度参数 $\\lambda = \\sqrt{\\dfrac{k}{D_e}}$。其通解最好用双曲函数表示：\n$$\nC(z) = A' \\cosh(\\lambda z) + B' \\sinh(\\lambda z)\n$$\n应用表面的边界条件 $C(0) = C_0$：\n$$\nC_0 = A' \\cosh(0) + B' \\sinh(0) \\implies A' = C_0\n$$\n所以解的形式为 $C(z) = C_0 \\cosh(\\lambda z) + B' \\sinh(\\lambda z)$。对 $z$ 的导数是：\n$$\n\\dfrac{dC}{dz} = \\lambda C_0 \\sinh(\\lambda z) + \\lambda B' \\cosh(\\lambda z)\n$$\n应用基底的无通量边界条件 $\\dfrac{dC}{dz}(L) = 0$：\n$$\n0 = \\lambda C_0 \\sinh(\\lambda L) + \\lambda B' \\cosh(\\lambda L) \\implies B' = -C_0 \\dfrac{\\sinh(\\lambda L)}{\\cosh(\\lambda L)} = -C_0 \\tanh(\\lambda L)\n$$\n将常数 $B'$ 代回 $C(z)$ 的表达式中：\n$$\nC(z) = C_0 \\cosh(\\lambda z) - C_0 \\tanh(\\lambda L) \\sinh(\\lambda z) = C_0 \\left( \\cosh(\\lambda z) - \\dfrac{\\sinh(\\lambda L)}{\\cosh(\\lambda L)} \\sinh(\\lambda z) \\right)\n$$\n$$\nC(z) = \\dfrac{C_0}{\\cosh(\\lambda L)} \\left( \\cosh(\\lambda z)\\cosh(\\lambda L) - \\sinh(\\lambda z)\\sinh(\\lambda L) \\right)\n$$\n使用双曲恒等式 $\\cosh(x-y) = \\cosh(x)\\cosh(y) - \\sinh(x)\\sinh(y)$，我们得到最终的简洁解：\n$$\nC(z) = C_0 \\dfrac{\\cosh(\\lambda(L-z))}{\\cosh(\\lambda L)} = C_0 \\dfrac{\\cosh\\left(\\sqrt{\\frac{k}{D_e}}(L-z)\\right)}{\\cosh\\left(\\sqrt{\\frac{k}{D_e}}L\\right)}\n$$\n\n**B. 最小二乘法参数估计**\n\n给定在深度 $\\{z_i\\}$ 处测得的一组 $N$ 个浓度值 $\\{C_i^{obs}\\}$，我们为速率参数设计估计器。\n\n**1. $R_0$ 的零级最小二乘估计器**\n\n我们旨在找到使残差平方和 $S(R_0)$ 最小化的速率 $R_0$：\n$$\nS(R_0) = \\sum_{i=1}^{N} \\left( C_i^{obs} - C(z_i; R_0) \\right)^2\n$$\n模型 $C(z) = C_0 + \\dfrac{R_0}{D_e} \\left( \\dfrac{z^2}{2} - Lz \\right)$ 关于参数 $R_0$ 是线性的。我们可以将其重新排列为：\n$$\nC(z_i) - C_0 = R_0 \\cdot \\left[ \\dfrac{1}{D_e} \\left( \\dfrac{z_i^2}{2} - Lz_i \\right) \\right]\n$$\n这是一个形式为 $y_i = \\beta x_i$ 且通过原点的线性回归模型，其中因变量是 $y_i = C_i^{obs} - C_0$，自变量是 $x_i' = \\dfrac{1}{D_e} \\left( \\dfrac{z_i^2}{2} - Lz_i \\right)$，待估计的参数是 $\\beta = R_0$。$\\beta$ 的闭式最小二乘估计器为 $\\hat{\\beta} = (\\sum x_i' y_i) / (\\sum (x_i')^2)$。\n代入我们的变量：\n$$\n\\hat{R}_0 = \\dfrac{\\sum_{i=1}^{N} \\left[ \\dfrac{1}{D_e} \\left( \\dfrac{z_i^2}{2} - Lz_i \\right) \\right] (C_i^{obs} - C_0)}{\\sum_{i=1}^{N} \\left[ \\dfrac{1}{D_e} \\left( \\dfrac{z_i^2}{2} - Lz_i \\right) \\right]^2}\n$$\n常数因子 $1/D_e$ 可以简化，得到 $R_0$ 的最终估计器：\n$$\n\\hat{R}_0 = D_e \\dfrac{\\sum_{i=1}^{N} \\left( \\dfrac{z_i^2}{2} - Lz_i \\right) (C_i^{obs} - C_0)}{\\sum_{i=1}^{N} \\left( \\dfrac{z_i^2}{2} - Lz_i \\right)^2}\n$$\n\n**2. $k$ 的一级非线性最小二乘**\n\n一级动力学的模型在参数 $k$ 上是非线性的。我们必须通过数值方法最小化残差平方和目标函数 $S(k)$：\n$$\nS(k) = \\sum_{i=1}^{N} \\left( C_i^{obs} - C_0 \\dfrac{\\cosh\\left(\\sqrt{\\frac{k}{D_e}}(L-z_i)\\right)}{\\cosh\\left(\\sqrt{\\frac{k}{D_e}}L\\right)} \\right)^2\n$$\n需要一种稳健的数值策略，在诸如 $k \\in [0, K_{max}]$ 这样的物理上有意义的区间上找到最小值点 $\\hat{k}$。这是一个一维优化问题。一种有效的方法是使用有界优化算法，例如 Brent 方法或有界拟牛顿法（L-BFGS-B），这些算法已在标准科学计算库中实现。该过程包括将目标函数 $S(k)$、边界 $[0, K_{max}]$ 和已知参数（$D_e, L, C_0, \\{z_i, C_i^{obs}\\}$）提供给数值最小化器，然后它将返回最优值 $\\hat{k}$。下界 $k \\ge 0$ 是一个关键的物理约束。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves for microbial respiration rates from concentration profiles using\n    1D steady-state diffusion-reaction models.\n    \"\"\"\n    test_cases = [\n        {\n            \"model\": \"zero-order\",\n            \"params\": {\n                \"D0\": 5.0e-10, \"phi\": 0.7, \"theta\": 2.5, \"L\": 0.4, \"C0\": 28.0\n            },\n            \"data\": {\n                \"z\": np.array([0.0, 0.05, 0.1, 0.2, 0.3, 0.4]),\n                \"C_obs\": np.array([28.0, 27.66517857142857, 27.375, 26.92857142857143, 26.660714285714286, 26.57142857142857])\n            }\n        },\n        {\n            \"model\": \"first-order\",\n            \"params\": {\n                \"D0\": 5.0e-10, \"phi\": 0.7, \"theta\": 2.0, \"L\": 0.5, \"C0\": 28.0\n            },\n            \"data\": {\n                \"z\": np.array([0.0, 0.1, 0.2, 0.3, 0.4, 0.5]),\n                \"C_obs\": np.array([28.0, 19.185298634, 13.473093861, 9.956622656, 8.045416193, 7.442462403])\n            }\n        },\n        {\n            \"model\": \"zero-order\",\n            \"params\": {\n                \"D0\": 5.0e-10, \"phi\": 0.8, \"theta\": 2.0, \"L\": 0.3, \"C0\": 20.0\n            },\n            \"data\": {\n                \"z\": np.array([0.0, 0.05, 0.1, 0.2, 0.3]),\n                \"C_obs\": np.array([20.0, 20.0, 20.0, 20.0, 20.0])\n            }\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        p = case[\"params\"]\n        d = case[\"data\"]\n        \n        # Calculate effective diffusivity\n        De = p[\"D0\"] * p[\"phi\"] / p[\"theta\"]**2\n        \n        if case[\"model\"] == \"zero-order\":\n            # Use closed-form least-squares estimator for R0\n            x_vec = d[\"z\"]**2 / 2.0 - p[\"L\"] * d[\"z\"]\n            y_vec = d[\"C_obs\"] - p[\"C0\"]\n            \n            numerator = np.sum(x_vec * y_vec)\n            denominator = np.sum(x_vec**2)\n            \n            if denominator == 0.0:\n                # This occurs if all z_i are 0, or if profile is perfectly flat (y_vec is all 0)\n                R0_fit = 0.0\n            else:\n                R0_fit = De * numerator / denominator\n            \n            results.append(R0_fit)\n            \n        elif case[\"model\"] == \"first-order\":\n            # Define the objective function for nonlinear least squares\n            def objective_func(k, De, L, C0, z, C_obs):\n                # Ensure physical constraint k >= 0 is met by the optimizer\n                if k  0:\n                    return np.inf\n\n                # Handle the edge case of no reaction (k=0)\n                if k == 0.0:\n                    C_model = np.full_like(z, C0)\n                else:\n                    lambda_val = np.sqrt(k / De)\n                    arg_L = lambda_val * L\n                    \n                    # Prevent overflow in np.cosh for very large arguments\n                    if arg_L > 700:\n                        # For large lambda*L, cosh(lambda(L-z))/cosh(lambda*L) approaches exp(-lambda*z)\n                        C_model = C0 * np.exp(-lambda_val * z)\n                    else:\n                        C_model = C0 * np.cosh(lambda_val * (L - z)) / np.cosh(arg_L)\n                \n                return np.sum((C_obs - C_model)**2)\n\n            # Perform bounded 1D optimization to find k\n            res = minimize_scalar(\n                fun=objective_func,\n                args=(De, p[\"L\"], p[\"C0\"], d[\"z\"], d[\"C_obs\"]),\n                bounds=(0, 1e-7),  # Search in a physically reasonable range [0, K_max]\n                method='bounded'\n            )\n            \n            k_fit = res.x\n            results.append(k_fit)\n\n    # Format output according to problem specification\n    formatted_results = [\"{:.6e}\".format(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2486110"}]}