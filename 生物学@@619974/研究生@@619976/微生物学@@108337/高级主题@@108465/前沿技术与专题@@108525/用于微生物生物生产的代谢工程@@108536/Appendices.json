{"hands_on_practices": [{"introduction": "在进行任何复杂的基因工程之前，代谢工程师必须首先确认所提出的生物合成途径在化学上是可行的。本练习将介绍一项基本技能：运用原子和电子守恒定律来验证反应的化学计量。通过确保反应不违反基本的质量守恒和氧化还原守恒定律，我们可以筛选出理论上可能的途径，为后续的优化工作奠定坚实的基础。", "problem": "一位生物过程工程师正在评估一个厌氧生产过程：在水性介质中，从葡萄糖 $\\left(\\mathrm{C_{6}H_{12}O_{6}}\\right)$ 生产$n$-丁醇 $\\left(\\mathrm{C_{4}H_{10}O}\\right)$。该过程无外部电子受体，且生物质的形成可忽略不计。副产物仅限于二氧化碳 $\\left(\\mathrm{CO_{2}}\\right)$、水 $\\left(\\mathrm{H_{2}O}\\right)$ 和氢气 $\\left(\\mathrm{H_{2}}\\right)$。该系统必须遵守原子守恒和总还原当量（电子）守恒。将氢气视为每摩尔携带 $2$ 个还原当量，水和二氧化碳的净还原当量视为零。所有物质均为中性，因此电荷平衡已默认满足。\n\n给定以下 $3$ 个候选的总反应路径：\n- 路径A：$\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + 2\\,\\mathrm{CO_{2}} + \\mathrm{H_{2}O}$。\n- 路径B：$\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + \\mathrm{CO_{2}} + 2\\,\\mathrm{H_{2}}$。\n- 路径C：$\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + 3\\,\\mathrm{CO} + 2\\,\\mathrm{H_{2}O}$。\n\n任务：\n1. 使用原子衡算，检验每条路径是否满足碳、氢、氧原子的守恒以及总还原当量的守恒。排除任何违反守恒定律的路径。\n2. 对于允许的副产物集合 $\\left\\{\\mathrm{CO_{2}},\\mathrm{H_{2}O},\\mathrm{H_{2}}\\right\\}$，考虑以下总反应通式\n$$\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\nu_{b}\\,\\mathrm{C_{4}H_{10}O} + \\nu_{c}\\,\\mathrm{CO_{2}} + \\nu_{h}\\,\\mathrm{H_{2}O} + \\nu_{H_{2}}\\,\\mathrm{H_{2}},$$\n其中 $\\nu_{b}, \\nu_{c}, \\nu_{h}, \\nu_{H_{2}} \\ge 0$ 是未知的非负化学计量系数。建立碳、氢、氧的元素平衡方程，以及基于还原当量守恒的总氧化还原平衡方程。利用这些约束条件，确定$n$-丁醇的最大可能摩尔产率 $\\nu_{b}^{\\max}$（单位：摩尔/摩尔葡萄糖）。\n3. 使用原子量 $M(\\mathrm{C})=12.01$，$M(\\mathrm{H})=1.008$，$M(\\mathrm{O})=16.00$（单位：克/摩尔），计算相应的最大质量产率 $Y_{P/S}^{\\max}$（单位：克$n$-丁醇/克葡萄糖）。最终数值结果以克$n$-丁醇/克葡萄糖为单位，并四舍五入至 $4$ 位有效数字。\n\n你最终报告的答案必须是任务 $3$ 中指定的 $Y_{P/S}^{\\max}$ 的单一数值。", "solution": "问题陈述已经过评估，并被确定为有效。这是一个在代谢化学计量学和热力学领域具有科学依据、自成体系且定义明确的问题，需要应用基本守恒定律。其前提、约束和目标都已清晰定义。现在我将开始进行系统性求解。\n\n解答将根据问题任务分为三个部分。\n\n首先，我将通过检查原子（碳、氢、氧）守恒和还原当量守恒来验证三个候选的反应路径。一个分子 $\\mathrm{C}_{a}\\mathrm{H}_{b}\\mathrm{O}_{c}\\mathrm{N}_{d}$ 的还原度 $\\gamma$ 由公式 $\\gamma = 4a + b - 2c - 3d$ 给出。对于本问题中的物质，它们都不带电荷且不含氮，因此该公式可以简化。一摩尔物质的可用电子总数，我们称之为还原当量(RE)，即为其还原度。\n对于底物，葡萄糖（$\\mathrm{C_{6}H_{12}O_{6}}$）：$\\gamma_{\\text{glucose}} = 4(6) + 12 - 2(6) = 24$。\n对于产物，$n$-丁醇（$\\mathrm{C_{4}H_{10}O}$）：$\\gamma_{\\text{butanol}} = 4(4) + 10 - 2(1) = 24$。\n问题定义了副产物的RE：\n$\\mathrm{CO_{2}}$：$\\gamma_{\\mathrm{CO_{2}}} = 0$。这与公式 $4(1) - 2(2) = 0$ 一致。\n$\\mathrm{H_{2}O}$：$\\gamma_{\\mathrm{H_{2}O}} = 0$。这与公式 $2 - 2(1) = 0$ 一致。\n$\\mathrm{H_{2}}$：$\\gamma_{\\mathrm{H_{2}}} = 2$。这与公式 $2$ 一致。\n\n路径A：$\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + 2\\,\\mathrm{CO_{2}} + \\mathrm{H_{2}O}$\n- 碳(C)平衡：$6 \\rightarrow 4 + 2(1) = 6$。平衡满足。\n- 氢(H)平衡：$12 \\rightarrow 10 + 2(1) = 12$。平衡满足。\n- 氧(O)平衡：$6 \\rightarrow 1 + 2(2) + 1 = 6$。平衡满足。\n- 还原当量(RE)平衡：$24 \\rightarrow 1(24) + 2(0) + 1(0) = 24$。平衡满足。\n结论：路径A有效，因为它满足所有守恒定律。\n\n路径B：$\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + \\mathrm{CO_{2}} + 2\\,\\mathrm{H_{2}}$\n- 碳(C)平衡：$6 \\rightarrow 4 + 1 = 5$。平衡被违反。\n结论：路径B因未能使碳原子守恒而无效。无需进一步检查。\n\n路径C：$\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + 3\\,\\mathrm{CO} + 2\\,\\mathrm{H_{2}O}$\n- 碳(C)平衡：$6 \\rightarrow 4 + 3(1) = 7$。平衡被违反。\n结论：路径C因未能使碳原子守恒而无效。此外，一氧化碳($\\mathrm{CO}$)的出现也使得该路径与后续分析不一致，因为它不属于主问题中指定的允许副产物集合。再者，问题陈述并未提供$\\mathrm{CO}$的还原当量，因此即使原子平衡，也无法进行完全验证。\n\n其次，我将确定$n$-丁醇的最大可能摩尔产率 $\\nu_{b}^{\\max}$。总化学计量方程为：\n$$1\\,\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\nu_{b}\\,\\mathrm{C_{4}H_{10}O} + \\nu_{c}\\,\\mathrm{CO_{2}} + \\nu_{h}\\,\\mathrm{H_{2}O} + \\nu_{H_{2}}\\,\\mathrm{H_{2}}$$\n我们基于消耗 $1$ 摩尔葡萄糖，从原子平衡建立线性方程组。\n- C平衡：$6 = 4\\nu_{b} + \\nu_{c}$  (1)\n- H平衡：$12 = 10\\nu_{b} + 2\\nu_{h} + 2\\nu_{H_{2}}$  (2)\n- O平衡：$6 = \\nu_{b} + 2\\nu_{c} + \\nu_{h}$  (3)\n\n氧化还原平衡方程（$24 = 24\\nu_{b} + 2\\nu_{H_{2}}$）是原子平衡方程（$4 \\times \\text{C} + \\text{H} - 2 \\times \\text{O}$）的线性组合，因此是冗余的。我们必须求解这个包含四个未知化学计量系数的三方程系统，这些系数被约束为非负数：$\\nu_{b} \\ge 0$, $\\nu_{c} \\ge 0$, $\\nu_{h} \\ge 0$, $\\nu_{H_{2}} \\ge 0$。\n\n我们将 $\\nu_{c}$、$\\nu_{h}$ 和 $\\nu_{H_{2}}$ 表示为 $\\nu_{b}$ 的函数，以找到丁醇产率的可行范围。\n由(1)得：\n$$\\nu_{c} = 6 - 4\\nu_{b}$$\n将此代入(3)：\n$6 = \\nu_{b} + 2(6 - 4\\nu_{b}) + \\nu_{h}$\n$6 = \\nu_{b} + 12 - 8\\nu_{b} + \\nu_{h}$\n$6 = 12 - 7\\nu_{b} + \\nu_{h} \\implies \\nu_{h} = 7\\nu_{b} - 6$\n\n将 $\\nu_{h}$ 代入简化的H平衡方程(2)，即 $6 = 5\\nu_{b} + \\nu_{h} + \\nu_{H_{2}}$：\n$6 = 5\\nu_{b} + (7\\nu_{b} - 6) + \\nu_{H_{2}}$\n$6 = 12\\nu_{b} - 6 + \\nu_{H_{2}} \\implies \\nu_{H_{2}} = 12 - 12\\nu_{b}$\n\n现在应用非负性约束：\n1. $\\nu_{b} \\ge 0$ （给定）\n2. $\\nu_{c} \\ge 0 \\implies 6 - 4\\nu_{b} \\ge 0 \\implies 4\\nu_{b} \\le 6 \\implies \\nu_{b} \\le \\frac{3}{2}$\n3. $\\nu_{h} \\ge 0 \\implies 7\\nu_{b} - 6 \\ge 0 \\implies 7\\nu_{b} \\ge 6 \\implies \\nu_{b} \\ge \\frac{6}{7}$\n4. $\\nu_{H_{2}} \\ge 0 \\implies 12 - 12\\nu_{b} \\ge 0 \\implies 12\\nu_{b} \\le 12 \\implies \\nu_{b} \\le 1$\n\n结合这些不等式，我们得到 $\\nu_{b}$ 的可行范围：\n$$\\frac{6}{7} \\le \\nu_{b} \\le 1$$\n目标是最大化 $\\nu_{b}$。在此可行范围内的最大值是 $\\nu_{b}^{\\max} = 1$。\n\n第三，我将计算最大质量产率 $Y_{P/S}^{\\max}$。首先，使用给定的原子量计算摩尔质量 ($M$)：$M(\\mathrm{C})=12.01\\,\\text{g/mol}$，$M(\\mathrm{H})=1.008\\,\\text{g/mol}$, $M(\\mathrm{O})=16.00\\,\\text{g/mol}$。\n葡萄糖的摩尔质量，$M_{\\text{glucose}}$ ($\\mathrm{C_{6}H_{12}O_{6}}$)：\n$$M_{\\text{glucose}} = 6 \\times 12.01 + 12 \\times 1.008 + 6 \\times 16.00 = 72.06 + 12.096 + 96.00 = 180.156\\,\\text{g/mol}$$\n$n$-丁醇的摩尔质量，$M_{\\text{butanol}}$ ($\\mathrm{C_{4}H_{10}O}$)：\n$$M_{\\text{butanol}} = 4 \\times 12.01 + 10 \\times 1.008 + 1 \\times 16.00 = 48.04 + 10.080 + 16.00 = 74.120\\,\\text{g/mol}$$\n最大质量产率由以下公式给出：\n$$Y_{P/S}^{\\max} = \\nu_{b}^{\\max} \\frac{M_{\\text{butanol}}}{M_{\\text{glucose}}}$$\n代入数值：\n$$Y_{P/S}^{\\max} = 1 \\times \\frac{74.120}{180.156} \\approx 0.4114134\\,\\text{g/g}$$\n按要求四舍五入至 $4$ 位有效数字，结果为 $0.4114$。", "answer": "$$\n\\boxed{0.4114}\n$$", "id": "2506619"}, {"introduction": "一个化学计量上可行的途径并不一定是一个高效的途径，其生产速率往往受限于最慢的反应步骤。本练习将分析层次从化学计量学推进到动力学，通过应用经典的米氏方程 (Michaelis-Menten model) 来计算线性途径中每个步骤的催化能力。这项实践能够帮助我们精确识别限制整体通量的“动力学瓶颈”，从而为靶向性地提高产量提供明确指导。", "problem": "一种工程菌被构建用于通过一个严格线性的四步通路生产目标分子。在操作条件下，每一步都由一种单底物酶催化，无变构调节且产物抑制可忽略不计。细胞处于稳态生理状态，每个步骤的底物的胞内浓度都已测定，且在酶-底物复合物的准稳态假设下，每个酶都遵循经典的米氏-孟顿机理。假设所报告的总酶都具有催化活性，每一步都有效不可逆，并且在给定条件下，稳态下的通路比通量不能超过最慢步骤的可达到速率。酶的总丰度以每克干重 (gDW) 报告，其中 gDW 代表克干重。\n\n对于步骤 $i \\in \\{1,2,3,4\\}$，测量了以下参数：\n- 步骤 1：总酶丰度 $E_{t,1} = 0.030~\\mu\\text{mol}~\\text{gDW}^{-1}$，催化转换数 $k_{\\text{cat},1} = 120~\\text{s}^{-1}$，米氏常数 $K_{M,1} = 0.20~\\text{mM}$，底物浓度 $S_{1} = 1.00~\\text{mM}$。\n- 步骤 2：总酶丰度 $E_{t,2} = 0.015~\\mu\\text{mol}~\\text{gDW}^{-1}$，催化转换数 $k_{\\text{cat},2} = 200~\\text{s}^{-1}$，米氏常数 $K_{M,2} = 0.050~\\text{mM}$，底物浓度 $S_{2} = 0.100~\\text{mM}$。\n- 步骤 3：总酶丰度 $E_{t,3} = 0.040~\\mu\\text{mol}~\\text{gDW}^{-1}$，催化转换数 $k_{\\text{cat},3} = 50~\\text{s}^{-1}$，米氏常数 $K_{M,3} = 0.50~\\text{mM}$，底物浓度 $S_{3} = 0.250~\\text{mM}$。\n- 步骤 4：总酶丰度 $E_{t,4} = 0.010~\\mu\\text{mol}~\\text{gDW}^{-1}$，催化转换数 $k_{\\text{cat},4} = 500~\\text{s}^{-1}$，米氏常数 $K_{M,4} = 0.20~\\text{mM}$，底物浓度 $S_{4} = 1.00~\\text{mM}$。\n\n仅使用米氏-孟顿动力学的基本定义和源自质量守恒的稳态通路通量限制，计算在这些条件下酶限制的最大通路比通量，以 $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$ 表示。将您的答案四舍五入到三位有效数字。除了陈述的参数外，您不能假设任何其他参数，并且您必须在解决方案的推导过程中从第一性原理证明所用单位的合理性。虽然您应该推断哪一步限制了通量，但只需报告所要求单位的最大比通量的数值。", "solution": "我们从经典的单底物米氏-孟顿机理以及对酶-底物复合物的准稳态假设开始。对于单个步骤，总酶浓度为 $E_{t}$，底物浓度为 $S$，其单位体积的反应速率为\n\n$$\nr \\;=\\; \\frac{V_{\\max} S}{K_{M} + S} \\quad \\text{其中} \\quad V_{\\max} \\;=\\; k_{\\text{cat}} E,\n$$\n\n其中 $E$ 是单位体积的酶浓度。在代谢工程中，通常以每克干重 (gDW) 而不是每单位体积来报告酶丰度。设 $E_{t}$ (单位为 $\\text{mol}~\\text{gDW}^{-1}$) 表示每克干重的总酶丰度。设 $\\rho$ 为生物质密度，单位为 $\\text{gDW}~\\text{L}^{-1}$。那么，体积酶浓度为 $E = E_{t}\\,\\rho$ (单位为 $\\text{mol}~\\text{L}^{-1}$)。因此，体积速率变为\n\n$$\nr \\;=\\; k_{\\text{cat}} (E_{t}\\rho)\\, \\frac{S}{K_{M} + S}.\n$$\n\n通过除以 $\\rho$ 将体积速率转换为基于每克干重的基准，得到比通量 $J$ (单位为 $\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}$):\n\n$$\nJ \\;=\\; \\frac{r}{\\rho} \\;=\\; k_{\\text{cat}} E_{t}\\, \\frac{S}{K_{M} + S}.\n$$\n\n因此，当 $E_{t}$ 以每克干重给出，而 $S$ 和 $K_{M}$ 以相同单位的浓度给出时，每克干重的比速率直接为\n\n$$\nJ \\;=\\; k_{\\text{cat}} E_{t}\\, \\frac{S}{K_{M} + S}.\n$$\n\n单位是一致的：$k_{\\text{cat}}$ 的单位是 $\\text{s}^{-1}$，$E_{t}$ 的单位是 $\\text{mol}~\\text{gDW}^{-1}$，饱和项 $\\frac{S}{K_{M}+S}$ 是无量纲的，所以 $J$ 的单位是 $\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}$。之后，通过乘以 $3.6 \\times 10^{3}$ 将其转换为 $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$。\n\n对于一个处于稳态、没有中间产物积累、并且每个步骤在相同通量下独立运行的严格线性通路，可达到的通路通量不能超过在当前底物浓度下任何单个步骤的容量。因此，酶限制的最大通路比通量是各步骤容量的最小值：\n\n$$\nJ_{\\text{max}} \\;=\\; \\min_{i \\in \\{1,2,3,4\\}} \\left\\{ k_{\\text{cat},i} E_{t,i}\\, \\frac{S_{i}}{K_{M,i} + S_{i}} \\right\\}.\n$$\n\n\n我们计算每个步骤的容量 $J_{i}$，单位为 $\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}$，然后转换为 $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$。\n\n步骤 1:\n\n$$\nV_{\\max,1} \\;=\\; k_{\\text{cat},1} E_{t,1} \\;=\\; 120~\\text{s}^{-1} \\times 0.030~\\mu\\text{mol}~\\text{gDW}^{-1} \\;=\\; 3.6~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n\n$$\n\\frac{S_{1}}{K_{M,1}+S_{1}} \\;=\\; \\frac{1.00}{0.20+1.00} \\;=\\; \\frac{1.00}{1.20} \\;=\\; \\frac{5}{6}.\n$$\n\n\n$$\nJ_{1} \\;=\\; 3.6 \\times \\frac{5}{6} \\;=\\; 3.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n转换为 $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$:\n\n$$\n3.0~\\mu\\text{mol}~\\text{s}^{-1} \\times \\frac{1~\\text{mmol}}{1000~\\mu\\text{mol}} \\times 3600~\\text{s}~\\text{h}^{-1} \\;=\\; 10.8~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\n\n\n步骤 2:\n\n$$\nV_{\\max,2} \\;=\\; 200 \\times 0.015 \\;=\\; 3.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n\n$$\n\\frac{S_{2}}{K_{M,2}+S_{2}} \\;=\\; \\frac{0.100}{0.050+0.100} \\;=\\; \\frac{0.100}{0.150} \\;=\\; \\frac{2}{3}.\n$$\n\n\n$$\nJ_{2} \\;=\\; 3.0 \\times \\frac{2}{3} \\;=\\; 2.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1} \\;\\Rightarrow\\; 2.0 \\times \\frac{1}{1000} \\times 3600 \\;=\\; 7.2~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\n\n\n步骤 3:\n\n$$\nV_{\\max,3} \\;=\\; 50 \\times 0.040 \\;=\\; 2.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n\n$$\n\\frac{S_{3}}{K_{M,3}+S_{3}} \\;=\\; \\frac{0.250}{0.50+0.250} \\;=\\; \\frac{0.250}{0.750} \\;=\\; \\frac{1}{3}.\n$$\n\n\n$$\nJ_{3} \\;=\\; 2.0 \\times \\frac{1}{3} \\;=\\; \\frac{2}{3}~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n转换:\n\n$$\n\\frac{2}{3}~\\mu\\text{mol}~\\text{s}^{-1} \\times \\frac{1}{1000}~\\text{mmol}~\\mu\\text{mol}^{-1} \\times 3600~\\text{s}~\\text{h}^{-1} \\;=\\; \\frac{2}{3} \\times 3.6~\\text{mmol}~\\text{h}^{-1} \\;=\\; 2.4~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\n\n\n步骤 4:\n\n$$\nV_{\\max,4} \\;=\\; 500 \\times 0.010 \\;=\\; 5.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n\n$$\n\\frac{S_{4}}{K_{M,4}+S_{4}} \\;=\\; \\frac{1.00}{0.20+1.00} \\;=\\; \\frac{5}{6}.\n$$\n\n\n$$\nJ_{4} \\;=\\; 5.0 \\times \\frac{5}{6} \\;=\\; \\frac{25}{6}~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n转换:\n\n$$\n\\frac{25}{6}~\\mu\\text{mol}~\\text{s}^{-1} \\times \\frac{1}{1000} \\times 3600 \\;=\\; \\frac{25}{6} \\times 3.6 \\times 10^{-3+3}~\\text{mmol}~\\text{h}^{-1} \\;=\\; 15.0~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\n\n\n汇总各步骤的容量，单位为 $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$:\n\n$$\nJ_{1} = 10.8,\\quad J_{2} = 7.2,\\quad J_{3} = 2.4,\\quad J_{4} = 15.0.\n$$\n\n酶限制的最大通路比通量是\n\n$$\nJ_{\\text{max}} \\;=\\; \\min\\{10.8,\\, 7.2,\\, 2.4,\\, 15.0\\} \\;=\\; 2.4~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\n\n\n四舍五入到三位有效数字得到 $2.40~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$。通过检查各步骤的容量，在这些条件下，限制性步骤是步骤3。根据要求，我们只报告所要求单位的数值。", "answer": "$$\\boxed{2.40}$$", "id": "2506550"}, {"introduction": "真实的代谢网络是复杂且相互关联的，而非简单的线性途径。本计算练习介绍通量平衡分析 (Flux Balance Analysis, FBA)，这是系统生物学中的一个基石工具，用于在全网络尺度上预测最佳的代谢流量分布。通过进一步应用通量变异性分析 (Flux Variability Analysis, FVA)，我们还能探索代谢网络的灵活性并揭示实现生产目标的多样化策略，这对于设计复杂的细胞工厂至关重要。", "problem": "用于微生物生物生产的代谢网络通过稳态质量守恒（化学计量质量平衡）和线性优化进行建模。其基础是稳态质量平衡和流量边界：每种内部代谢物均无净累积，因此流量向量 $\\mathbf{v} \\in \\mathbb{R}^n$ 必须满足 $S \\mathbf{v} = \\mathbf{0}$，其中 $S \\in \\mathbb{R}^{m \\times n}$ 是化学计量矩阵，每个反应流量 $v_i$ 都受到下限和上限的约束。该基础与线性目标函数共同构成了流量平衡分析（FBA）的理论基础。多重最优解通过流量变异性分析（FVA）进行表征，该方法在将最优目标值维持在一个很小的容差范围内的同时，计算各个流量的允许范围。您的程序必须实现这些原理，以比较不同目标下的最优解，并通过 FVA 量化多重最优解。\n\n网络规格。内部代谢物为 $\\{\\text{Glc}, \\text{Pyr}, \\text{ATP}, \\text{O2}, \\text{CO2}, \\text{Lac}\\}$。反应（全部不可逆）及其流量索引如下：\n- $v_1$：葡萄糖摄取，$\\text{Glc}_e \\rightarrow \\text{Glc}$，索引 $0$。\n- $v_2$：糖酵解，$\\text{Glc} \\rightarrow 2\\,\\text{Pyr} + 2\\,\\text{ATP}$，索引 $1$。\n- $v_3$：呼吸作用 A，$\\text{Pyr} + 2.5\\,\\text{O2} \\rightarrow 3\\,\\text{CO2} + 12.5\\,\\text{ATP}$，索引 $2$。\n- $v_{10}$：呼吸作用 B (呼吸作用 A 的副本)，$\\text{Pyr} + 2.5\\,\\text{O2} \\rightarrow 3\\,\\text{CO2} + 12.5\\,\\text{ATP}$，索引 $3$。\n- $v_4$：发酵作用 A，$\\text{Pyr} \\rightarrow \\text{Lac}$，索引 $4$。\n- $v_{11}$：发酵作用 B (发酵作用 A 的副本)，$\\text{Pyr} \\rightarrow \\text{Lac}$，索引 $5$。\n- $v_5$：三磷酸腺苷 (ATP) 水解需求，$\\text{ATP} \\rightarrow \\varnothing$，索引 $6$。\n- $v_6$：生物量合成 (汇)，$2\\,\\text{Pyr} + 10\\,\\text{ATP} \\rightarrow \\varnothing$，索引 $7$。\n- $v_7$：氧气摄取，$\\text{O2}_e \\rightarrow \\text{O2}$，索引 $8$。\n- $v_8$：二氧化碳输出，$\\text{CO2} \\rightarrow \\varnothing$，索引 $9$。\n- $v_9$：乳酸输出，$\\text{Lac} \\rightarrow \\varnothing$，索引 $10$。\n\n针对内部代谢物的稳态化学计量质量平衡 $S \\mathbf{v} = \\mathbf{0}$，写成线性方程组如下：\n- Glc: $+1\\,v_1 - 1\\,v_2 = 0$。\n- Pyr: $+2\\,v_2 - 1\\,v_3 - 1\\,v_{10} - 1\\,v_4 - 1\\,v_{11} - 2\\,v_6 = 0$。\n- ATP: $+2\\,v_2 + 12.5\\,v_3 + 12.5\\,v_{10} - 1\\,v_5 - 10\\,v_6 = 0$。\n- O2: $+1\\,v_7 - 2.5\\,v_3 - 2.5\\,v_{10} = 0$。\n- CO2: $+3\\,v_3 + 3\\,v_{10} - 1\\,v_8 = 0$。\n- Lac: $+1\\,v_4 + 1\\,v_{11} - 1\\,v_9 = 0$。\n\n流量边界。所有反应均不可逆，下限为 $0$。交换反应具有如下有限的上限：\n- $0 \\le v_1 \\le G_{\\max}$ (葡萄糖摄取)。\n- $0 \\le v_7 \\le O_{\\max}$ (氧气摄取)。\n- 所有其他反应的上限为 $+\\infty$。\n\n目标。您必须计算以下内容，每一项都构建为一个线性规划问题：\n1. 生物量最大化：最大化 $v_6$。\n2. ATP 产量最大化：最大化 $v_5$。\n3. 最大生长速率下的最小总流量：首先从目标 (1) 中找到最大生物量 $v_6^\\star$，然后在满足约束 $S \\mathbf{v} = \\mathbf{0}$、上述边界条件以及 $v_6 \\ge v_6^\\star - \\epsilon$ 的前提下，最小化总流量 $\\sum_{i=1}^{n} |v_i|$。因为所有反应都是不可逆的，所以 $|v_i| = v_i$，因此目标简化为最小化 $\\sum_{i=1}^{n} v_i$。\n\n流量变异性分析 (FVA)。对于上述每个目标，在获得最优目标值 $z^\\star$ 后，通过计算集合 $\\{v_3, v_{10}, v_4, v_{11}\\}$ 中每个目标流量 $v_j$ 的最小和最大可行值来表征多重最优解，约束条件为 $S \\mathbf{v} = \\mathbf{0}$、边界条件以及目标在容差 $\\epsilon$ 内保持最优。当目标是最大化 $c^\\top \\mathbf{v}$ 时，通过添加不等式 $-c^\\top \\mathbf{v} \\le -z^\\star + \\epsilon$ 来实现这一点。对于最小总流量目标，同时添加 $v_6 \\ge v_6^\\star - \\epsilon$ 和 $\\sum_{i=1}^{n} v_i \\le T^\\star + \\epsilon$ 两个约束，其中 $T^\\star$ 是在该约束下找到的最小总流量。\n\n数值容差和单位。使用容差 $\\epsilon = 10^{-7}$。所有流量均以毫摩尔每克干重每小时为单位表示，即 $\\text{mmol}\\,\\text{gDW}^{-1}\\,\\text{h}^{-1}$。将所有报告的数字四舍五入到六位小数。\n\n测试套件。针对以下参数集 $(G_{\\max}, O_{\\max})$ 求解上述问题：\n- 案例 1：$(G_{\\max}, O_{\\max}) = (10, 100)$。\n- 案例 2：$(G_{\\max}, O_{\\max}) = (10, 8)$。\n- 案例 3：$(G_{\\max}, O_{\\max}) = (10, 0)$。\n\n要求的最终输出格式。您的程序应生成单行输出，其中包含一个列表，该列表按顺序为每个案例连接了以下值，顺序必须完全一致：\n- 生物量最优值 $v_6^\\star$。\n- ATP 最优值 $v_5^\\star$。\n- 在 $v_6 \\ge v_6^\\star - \\epsilon$ 条件下的最小总流量 $T^\\star$。\n- 生物量最优解下的 FVA：$[v_3^{\\min}, v_3^{\\max}, v_{10}^{\\min}, v_{10}^{\\max}, v_4^{\\min}, v_4^{\\max}, v_{11}^{\\min}, v_{11}^{\\max}]$。\n- ATP 最优解下的 FVA：顺序相同的八个值。\n- 最小总流量最优解下的 FVA：顺序相同的八个值。\n\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如 $[x_1,x_2,\\dots]$），其中每个数字都按要求四舍五入到六位小数。不应打印任何其他文本。", "solution": "问题陈述经过了严格审查，并被确定为 **有效**。它提出了一个计算系统生物学领域的标准练习，具体涉及将流量平衡分析（FBA）和流量变异性分析（FVA）应用于一个简化的代谢网络。该问题是自成体系的，在数学上是适定的，并且其科学基础是稳态质量守恒原理。重复反应通路（$v_3/v_{10}$ 和 $v_4/v_{11}$）的存在不是一个缺陷，而是一种为产生多重最优解而进行的刻意构造。多重最优解是代谢网络中的一种常见现象，而对其进行表征正是 FVA 的核心目的。\n\n解决方案通过系统地应用线性规划（LP）来推进。代谢网络的状态由一个流量向量 $\\mathbf{v} \\in \\mathbb{R}^{11}$ 描述，其中 $\\mathbf{v} = [v_0, v_1, \\dots, v_{10}]^\\top$。索引 $0, \\dots, 10$ 对应于问题中指定的反应 $v_1, v_2, v_3, v_{10}, v_4, v_{11}, v_5, v_6, v_7, v_8, v_9$。\n\n模型的核心是稳态质量平衡方程 $S \\mathbf{v} = \\mathbf{0}$，其中 $S \\in \\mathbb{R}^{6 \\times 11}$ 是化学计量矩阵。S 的行对应于内部代谢物 $\\{\\text{Glc}, \\text{Pyr}, \\text{ATP}, \\text{O2}, \\text{CO2}, \\text{Lac}\\}$，其列对应于流量 $v_0, \\dots, v_{10}$。根据所提供的化学计量方程，矩阵 $S$ 为：\n$$\nS = \\begin{pmatrix}\n 1 & -1 &    0 &    0 &    0 &    0 &   0 &   0 &   0 &   0 &   0 \\\\\n 0 &  2 &   -1 &   -1 &   -1 &   -1 &   0 &  -2 &   0 &   0 &   0 \\\\\n 0 &  2 & 12.5 & 12.5 &    0 &    0 &  -1 & -10 &   0 &   0 &   0 \\\\\n 0 &  0 & -2.5 & -2.5 &    0 &    0 &   0 &   0 &   1 &   0 &   0 \\\\\n 0 &  0 &    3 &    3 &    0 &    0 &   0 &   0 &   0 &  -1 &   0 \\\\\n 0 &  0 &    0 &    0 &    1 &    1 &   0 &   0 &   0 &   0 &  -1\n\\end{pmatrix}\n$$\n因此，线性方程组为 $S\\mathbf{v} = \\mathbf{0}$，其中 $\\mathbf{0}$ 是 $\\mathbb{R}^6$中的零向量。\n\n每个流量 $v_i$ 都受下限和上限 $l_i \\le v_i \\le u_i$ 的约束。所有反应都是不可逆的，因此对于所有 $i \\in \\{0, \\dots, 10\\}$，$l_i = 0$。上限为：\n- $v_0 \\le G_{\\max}$\n- $v_8 \\le O_{\\max}$\n- 所有其他流量 $v_i \\le +\\infty$。\n\n每个任务都构建为一个独立的 LP 问题。由于标准 LP 求解器执行的是最小化，因此最大化目标函数 $c^\\top \\mathbf{v}$ 是通过最小化 $-c^\\top \\mathbf{v}$ 来实现的。\n\n1.  **生物量最大化**：目标是最大化生物量合成流量 $v_7$（对应反应 $v_6$）。要最小化的目标函数是 $c^\\top \\mathbf{v}$，其中 $c = [0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0]^\\top$。最优值为 $v_6^\\star = - \\min(c^\\top \\mathbf{v})$。\n\n2.  **ATP 产量最大化**：目标是最大化 ATP 水解流量 $v_6$（对应反应 $v_5$）。要最小化的目标函数是 $c^\\top \\mathbf{v}$，其中 $c = [0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0]^\\top$。最优值为 $v_5^\\star = - \\min(c^\\top \\mathbf{v})$。\n\n3.  **最大生长速率下的最小总流量**：这是一个两步优化。\n    a. 首先，如目标 (1) 中所述，确定最大生物量流量 $v_6^\\star$。\n    b. 其次，求解一个新的 LP 来最小化总流量 $\\sum_{i=0}^{10} v_i$。这对应的目标向量为 $c = [1, 1, \\dots, 1]^\\top$。添加一个约束以确保生物量生产接近最优：$v_7 \\ge v_6^\\star - \\epsilon$。最优值为 $T^\\star = \\min(\\sum v_i)$。\n\n对上述三个最优状态中的每一个都执行**流量变异性分析 (FVA)**。对于一个给定的最优目标值 $z^\\star$，向 LP 问题中添加一个额外约束，以强制目标值保持在近最优状态。然后，对于每个目标流量 $v_j$（来自对应于反应 $v_3, v_{10}, v_4, v_{11}$ 的流量索引集合 $\\{2, 3, 4, 5\\}$），我们通过求解两个 LP 来找到其最小和最大可能值。\n\n-   **针对生物量最优解的 FVA**：添加约束 $v_7 \\ge v_6^\\star - \\epsilon$。\n-   **针对 ATP 最优解的 FVA**：添加约束 $v_6 \\ge v_5^\\star - \\epsilon$。\n-   **针对最小总流量的 FVA**：添加两个约束：$v_7 \\ge v_6^\\star - \\epsilon$ 和 $\\sum_{i=0}^{10} v_i \\le T^\\star + \\epsilon$。\n\n对于这些约束系统中的每一个，我们都遍历目标流量 $v_j$，将目标先后设置为最小化 $v_j$ 和最大化 $v_j$（即最小化 $-v_j$），以找到允许的流量范围 $[v_j^{\\min}, v_j^{\\max}]$。\n\n整个过程使用 `scipy.optimize.linprog` 函数为每个测试用例进行算法实现，该函数为此类 LP 问题提供了强大的求解器。所有数值结果均按要求四舍五入到六位小数。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    为给定的代谢网络模型求解一系列流量平衡分析 (FBA) 和流量变异性分析 (FVA) 问题。\n    \"\"\"\n    \n    # 定义测试用例 (G_max, O_max)\n    test_cases = [\n        (10.0, 100.0),  # 案例 1\n        (10.0, 8.0),    # 案例 2\n        (10.0, 0.0)     # 案例 3\n    ]\n\n    # 化学计量矩阵 S (6 种代谢物 x 11 个反应)\n    # 行: Glc, Pyr, ATP, O2, CO2, Lac\n    # 列: v1, v2, v3, v10, v4, v11, v5, v6, v7, v8, v9 (索引 0-10)\n    S = np.array([\n        # v0,  v1,    v2,    v3,    v4,    v5,   v6,   v7,   v8,   v9,  v10\n        [  1,  -1,   0.0,   0.0,   0.0,   0.0,  0.0,  0.0,  0.0,  0.0,  0.0],  # Glc\n        [  0,   2,  -1.0,  -1.0,  -1.0,  -1.0,  0.0, -2.0,  0.0,  0.0,  0.0],  # Pyr\n        [  0,   2,  12.5,  12.5,   0.0,   0.0, -1.0, -10.0, 0.0,  0.0,  0.0],  # ATP\n        [  0,   0,  -2.5,  -2.5,   0.0,   0.0,  0.0,  0.0,  1.0,  0.0,  0.0],  # O2\n        [  0,   0,   3.0,   3.0,   0.0,   0.0,  0.0,  0.0,  0.0, -1.0,  0.0],  # CO2\n        [  0,   0,   0.0,   0.0,   1.0,   1.0,  0.0,  0.0,  0.0,  0.0, -1.0],  # Lac\n    ])\n    b_eq = np.zeros(S.shape[0])\n    num_fluxes = S.shape[1]\n    \n    # 数值容差\n    epsilon = 1e-7\n\n    # FVA 目标流量索引 (从0开始): v3, v10, v4, v11\n    fva_flux_indices = [2, 3, 4, 5]\n\n    all_results = []\n\n    def run_fva(S_mat, b_eq_vec, bounds_list, A_ub_mat, b_ub_vec):\n        \"\"\"辅助函数，用于为给定的约束系统执行 FVA。\"\"\"\n        fva_results = []\n        for idx in fva_flux_indices:\n            c = np.zeros(num_fluxes)\n            \n            # 最小化流量 v_j\n            c[idx] = 1.0\n            res_min = linprog(c, A_eq=S_mat, b_eq=b_eq_vec, A_ub=A_ub_mat, b_ub=b_ub_vec, bounds=bounds_list, method='highs')\n            min_val = res_min.fun if res_min.success else 0.0\n            \n            # 通过最小化 -v_j 来最大化流量 v_j\n            c[idx] = -1.0\n            res_max = linprog(c, A_eq=S_mat, b_eq=b_eq_vec, A_ub=A_ub_mat, b_ub=b_ub_vec, bounds=bounds_list, method='highs')\n            max_val = -res_max.fun if res_max.success else 0.0\n\n            fva_results.extend([min_val, max_val])\n        return fva_results\n\n    for G_max, O_max in test_cases:\n        case_results = []\n        bounds = [(0, None)] * num_fluxes\n        bounds[0] = (0, G_max)  # v1 (葡萄糖摄取)\n        bounds[8] = (0, O_max)  # v7 (氧气摄取)\n\n        # 1. 生物量最大化 (目标: max v6, 索引 7)\n        c_biomass = np.zeros(num_fluxes)\n        c_biomass[7] = -1\n        res_biomass = linprog(c_biomass, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs')\n        v6_star = -res_biomass.fun if res_biomass.success else 0.0\n        case_results.append(v6_star)\n        \n        # 2. ATP 产量最大化 (目标: max v5, 索引 6)\n        c_atp = np.zeros(num_fluxes)\n        c_atp[6] = -1\n        res_atp = linprog(c_atp, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs')\n        v5_star = -res_atp.fun if res_atp.success else 0.0\n        case_results.append(v5_star)\n\n        # 3. 最大生长速率下的最小总流量\n        A_ub_minflux = np.zeros((1, num_fluxes))\n        A_ub_minflux[0, 7] = -1  # -v7 <= -(v6_star - epsilon) <==> v7 >= v6_star - epsilon\n        b_ub_minflux = [-(v6_star - epsilon)]\n        c_totalflux = np.ones(num_fluxes)\n        res_totalflux = linprog(c_totalflux, A_eq=S, b_eq=b_eq, A_ub=A_ub_minflux, b_ub=b_ub_minflux, bounds=bounds, method='highs')\n        T_star = res_totalflux.fun if res_totalflux.success else 0.0\n        case_results.append(T_star)\n\n        # 4. 针对生物量最优解的 FVA\n        A_ub_fva1 = np.zeros((1, num_fluxes))\n        A_ub_fva1[0, 7] = -1    # v7 >= v6_star - epsilon\n        b_ub_fva1 = [-(v6_star - epsilon)]\n        fva_biomass_results = run_fva(S, b_eq, bounds, A_ub_fva1, b_ub_fva1)\n        case_results.extend(fva_biomass_results)\n\n        # 5. 针对 ATP 最优解的 FVA\n        A_ub_fva2 = np.zeros((1, num_fluxes))\n        A_ub_fva2[0, 6] = -1    # v6 >= v5_star - epsilon\n        b_ub_fva2 = [-(v5_star - epsilon)]\n        fva_atp_results = run_fva(S, b_eq, bounds, A_ub_fva2, b_ub_fva2)\n        case_results.extend(fva_atp_results)\n        \n        # 6. 针对最小总流量最优解的 FVA\n        A_ub_fva3 = np.zeros((2, num_fluxes))\n        A_ub_fva3[0, 7] = -1        # v7 >= v6_star - epsilon\n        A_ub_fva3[1, :] = 1         # sum(v_i) <= T_star + epsilon\n        b_ub_fva3 = [-(v6_star - epsilon), T_star + epsilon]\n        fva_totalflux_results = run_fva(S, b_eq, bounds, A_ub_fva3, b_ub_fva3)\n        case_results.extend(fva_totalflux_results)\n\n        all_results.extend(case_results)\n        \n    # 格式化并打印最终输出\n    print(f\"[{','.join(f'{x:.6f}' for x in all_results)}]\")\n\nsolve()\n```", "id": "2506613"}]}