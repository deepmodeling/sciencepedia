{"hands_on_practices": [{"introduction": "在CRISPR微生物基因组工程的实践中，首要任务是选择最适合特定生物和应用场景的核酸酶。本练习将引导你比较两种常用的CRISPR工具——$SpCas9$和$Cas12a$——在不同基因组碱基组成（富含$GC$与富含$AT$）的微生物中的适用性[@problem_id:2484582]。通过这个实践，你将学会如何基于核酸酶的PAM序列要求和基因组特征，做出理性的、数据驱动的工具选择，这是设计成功基因编辑项目的关键第一步。", "problem": "一位微生物遗传学家必须在酿脓链球菌Cas9 (SpCas9) 和 Cas12a (也称为 Cpf1) 之间进行选择，用于两种细菌的基因组工程。SpCas9 需要一个形式为 NGG 的原型间隔子邻近基序 (PAM)，该基序位于非靶标链上原型间隔子的 $3^{\\prime}$ 端，并主要在 PAM 附近产生平末端双链断裂。Cas12a 需要一个形式为 TTTV (V 代表 A, C 或 G) 的 PAM，该基序位于非靶标链上原型间隔子的 $5^{\\prime}$ 端，并在远离 PAM 的位置产生黏性末端双链断裂。对于通过催化失活的核酸酶进行的转录抑制（CRISPR干扰），细菌中一个经过充分验证的观察结果是：当向导RNA靶向非模板链（编码链）时，失活的SpCas9 (dSpCas9) 会产生更强的抑制效果；而当向导RNA靶向模板链时，失活的Cas12a (dCas12a) 会产生更强的抑制效果。假设是标准的细菌转录，其中RNA聚合酶以 $3^{\\prime}\\to 5^{\\prime}$ 的方向读取模板链，以 $5^{\\prime}\\to 3^{\\prime}$ 的方向合成RNA。\n\n正在考虑两种微生物：\n- 微生物 X 的基因组鸟嘌呤-胞嘧啶含量为 $g_X = 0.70$ （即 $70\\%$ 的鸟嘌呤-胞嘧啶）。\n- 微生物 Y 的基因组鸟嘌呤-胞嘧啶含量为 $g_Y = 0.30$。\n\n为在全基因组范围内近似PAM的可用性，使用以下碱基组成的独立性模型：在任何基因组位置，碱基 G 的概率为 $p(\\mathrm{G}) = g/2$，碱基 C 的概率为 $p(\\mathrm{C}) = g/2$，碱基 A 的概率为 $p(\\mathrm{A}) = (1-g)/2$，碱基 T 的概率为 $p(\\mathrm{T}) = (1-g)/2$，且链上不同位置的碱基出现是相互独立的。在此模型下，给定链上每个位置出现 NGG PAM 的概率可近似为 $p(\\mathrm{NGG}) \\approx p(\\mathrm{G})^{2}$，而出现 TTTV PAM 的概率可近似为 $p(\\mathrm{TTTV}) \\approx p(\\mathrm{T})^{3}\\,[1 - p(\\mathrm{T})]$。\n\n这位遗传学家在每种微生物中都有两项任务：\n- 任务 1：在众多基因的起始密码子周围 $\\pm 50~\\mathrm{bp}$ 范围内制造双链断裂，以产生小的基因敲除，优先考虑在这些位点附近具有高的全基因组PAM密度。\n- 任务 2：通过CRISPR干扰抑制一个必需基因，选择向导RNA的靶向方向（靶向模板链或非模板链）以最大化抑制效果。\n\n根据PAM要求、链偏好性以及碱基组成模型，以下哪种组合选择是最佳的？\n\nA. 对微生物 X 使用 SpCas9，对微生物 Y 使用 Cas12a，以最大化任务 $1$ 的PAM可用性。对于任务 $2$，将 dSpCas9 的向导RNA设计在非模板链上，将 dCas12a 的向导RNA设计在模板链上。\n\nB. 对微生物 X 使用 Cas12a，对微生物 Y 使用 SpCas9，以最大化任务 $1$ 的PAM可用性。对于任务 $2$，将 dSpCas9 和 dCas12a 的向导RNA都设计在非模板链上。\n\nC. 对两种微生物都使用 SpCas9，因为由于存在简并的 N，NGG 序列很常见。对于任务 $2$，链的选择对 dSpCas9 和 dCas12a 来说都无关紧要。\n\nD. 对两种微生物都使用 Cas12a，因为 TTTV 在V位置允许三种选择。对于任务 $2$，将 dSpCas9 和 dCas12a 的向导RNA都设计在模板链上。\n\nE. 对于任务 $1$，对微生物 X 使用 SpCas9，对微生物 Y 使用 Cas12a，但对于任务 $2$，将 dSpCas9 的向导RNA设计在模板链上，将 dCas12a 的向导RNA设计在非模板链上，以使PAM近端与RNA聚合酶的接近方向对齐。", "solution": "必须首先验证问题陈述的科学性和逻辑完整性。\n\n步骤 1：提取给定信息\n- 核酸酶 1: `Streptococcus pyogenes Cas9` ($\\text{SpCas9}$)\n    - 原型间隔子邻近基序 (PAM): $\\text{NGG}$，位于非靶标链上原型间隔子的 $3^{\\prime}$ 端。\n    - 作用: 在 PAM 附近产生平末端双链断裂 (DSB)。\n    - CRISPR干扰 (d$\\text{SpCas9}$): 当向导RNA靶向非模板链（编码链）时，抑制作用更强。\n- 核酸酶 2: $\\text{Cas12a}$ (也称为 $\\text{Cpf1}$)\n    - PAM: $\\text{TTTV}$ (其中 $\\text{V}$ 是 $\\text{A}$, $\\text{C}$, 或 $\\text{G}$)，位于非靶标链上原型间隔子的 $5^{\\prime}$ 端。\n    - 作用: 在远离 PAM 的位置产生黏性末端双链断裂。\n    - CRISPR干扰 (d$\\text{Cas12a}$): 当向导RNA靶向模板链时，抑制作用更强。\n- 转录: RNA聚合酶以 $3^{\\prime}\\to 5^{\\prime}$ 方向读取模板链，以 $5^{\\prime}\\to 3^{\\prime}$ 方向合成RNA。\n- 微生物 X: 基因组鸟嘌呤-胞嘧啶 (GC) 含量 $g_X = 0.70$。\n- 微生物 Y: 基因组 GC 含量 $g_Y = 0.30$。\n- 碱基组成模型: 在任何位置，碱基概率为 $p(\\mathrm{G}) = g/2$，$p(\\mathrm{C}) = g/2$，$p(\\mathrm{A}) = (1-g)/2$，$p(\\mathrm{T}) = (1-g)/2$。碱基是独立的。\n- PAM 概率近似:\n    - $p(\\mathrm{NGG}) \\approx p(\\mathrm{G})^{2}$\n    - $p(\\mathrm{TTTV}) \\approx p(\\mathrm{T})^{3}\\,[1 - p(\\mathrm{T})]$\n- 任务 1: 创建基因敲除，优先考虑高的全基因组PAM密度。\n- 任务 2: 使用CRISPR干扰抑制一个必需基因，以最大化抑制效果。\n\n步骤 2：使用提取的给定信息进行验证\n- **科学依据**: 所描述的 $\\text{SpCas9}$ 和 $\\text{Cas12a}$ 的特性（PAM序列、PAM位置、切割类型和CRISPRi链偏好性）与分子生物学和基因组工程领域的既定发现一致。微生物的GC含量值是现实的。\n- **良构性**: 问题提供了一个明确的目标（确定最佳策略）和足够的定量信息（GC含量、概率模型），足以得出一个确定的解决方案。\n- **一致性**: 提供的概率模型在内部是一致的。$p(\\text{NGG})$ 的公式是 $p(\\text{N})p(\\text{G})p(\\text{G}) = 1 \\cdot p(\\text{G}) \\cdot p(\\text{G}) = p(\\text{G})^2$，与提供的近似值 $p(\\text{NGG}) \\approx p(\\mathrm{G})^2$ 相匹配。$p(\\text{TTTV})$ 的公式是 $p(\\text{T})p(\\text{T})p(\\text{T})p(\\text{V}) = p(\\text{T})^3 (p(\\text{A})+p(\\text{C})+p(\\text{G})) = p(\\text{T})^3 (1-p(\\text{T}))$，也与提供的近似值相匹配。使用 '$\\approx$' 是可接受的，因为它反映了这是一个复杂生物学现实的简化模型。问题没有矛盾之处。\n- **客观性**: 问题使用精确、客观的语言和定量数据进行陈述。没有提出主观性论断。\n\n步骤 3：结论与行动\n问题陈述在科学上是合理的、良构的、内部一致的和客观的。它是有效的。我将继续进行解答。\n\n该问题需要一个分两部分的分析：首先，根据PAM密度确定用于敲除（任务 $1$）的最佳核酸酶；其次，根据给定的规则确定用于CRISPR干扰（任务 $2$）的正确靶向链策略。\n\n**任务 1 的分析：PAM 密度**\n\n我们必须计算并比较在每种微生物基因组中找到 $\\text{SpCas9}$ PAM ($\\text{NGG}$) 与 $\\text{Cas12a}$ PAM ($\\text{TTTV}$) 的概率。\n\n对于微生物 X，GC 含量为 $g_X = 0.70$。\n每种碱基的概率为：\n- $p_X(\\mathrm{G}) = g_X/2 = 0.70/2 = 0.35$\n- $p_X(\\mathrm{T}) = (1-g_X)/2 = (1-0.70)/2 = 0.30/2 = 0.15$\n\n微生物 X 的 PAM 概率为：\n- 对于 $\\text{SpCas9}$: $p_X(\\mathrm{NGG}) \\approx (p_X(\\mathrm{G}))^2 = (0.35)^2 = 0.1225$\n- 对于 $\\text{Cas12a}$: $p_X(\\mathrm{TTTV}) \\approx (p_X(\\mathrm{T}))^3 (1-p_X(\\mathrm{T})) = (0.15)^3 (1-0.15) = 0.003375 \\times 0.85 = 0.00286875$\n\n比较微生物 X 的概率：$0.1225 > 0.00286875$。因此，$\\text{SpCas9}$ 在微生物 X 中提供了显著更高的PAM密度。\n\n对于微生物 Y，GC 含量为 $g_Y = 0.30$。\n每种碱基的概率为：\n- $p_Y(\\mathrm{G}) = g_Y/2 = 0.30/2 = 0.15$\n- $p_Y(\\mathrm{T}) = (1-g_Y)/2 = (1-0.30)/2 = 0.70/2 = 0.35$\n\n微生物 Y 的 PAM 概率为：\n- 对于 $\\text{SpCas9}$: $p_Y(\\mathrm{NGG}) \\approx (p_Y(\\mathrm{G}))^2 = (0.15)^2 = 0.0225$\n- 对于 $\\text{Cas12a}$: $p_Y(\\mathrm{TTTV}) \\approx (p_Y(\\mathrm{T}))^3 (1-p_Y(\\mathrm{T})) = (0.35)^3 (1-0.35) = 0.042875 \\times 0.65 = 0.02786875$\n\n比较微生物 Y 的概率：$0.02786875 > 0.0225$。因此，$\\text{Cas12a}$ 在微生物 Y 中提供了更高的PAM密度。\n\n任务 $1$ 的结论：为了最大化基因敲除的PAM可用性，遗传学家应该对微生物 X 使用 $\\text{SpCas9}$，对微生物 Y 使用 $\\text{Cas12a}$。\n\n**任务 2 的分析：CRISPR 干扰**\n\n问题的这一部分不需要计算，而是直接应用前提中陈述的规则。\n- 对于 d$\\text{SpCas9}$：问题陈述其“当向导RNA靶向非模板链（编码链）时，产生更强的抑制效果”。\n- 对于 d$\\text{Cas12a}$：问题陈述其“当向导RNA靶向模板链时，产生更强的抑制效果”。\n\n任务 $2$ 的结论：为了最大化抑制效果，d$\\text{SpCas9}$ 的向导RNA必须设计为靶向非模板链，而 d$\\text{Cas12a}$ 的向导RNA必须设计为靶向模板链。\n\n**组合策略**\n结合两项任务的结论，最佳策略是：\n1. 对于任务 $1$，在微生物 X 中使用 $\\text{SpCas9}$，在微生物 Y 中使用 $\\text{Cas12a}$。\n2. 对于任务 $2$，当使用 d$\\text{SpCas9}$ 时，靶向非模板链。当使用 d$\\text{Cas12a}$ 时，靶向模板链。\n\n**选项评估**\n\nA. 对微生物 X 使用 $\\text{SpCas9}$，对微生物 Y 使用 $\\text{Cas12a}$，以最大化任务 $1$ 的PAM可用性。对于任务 $2$，将 d$\\text{SpCas9}$ 的向导RNA设计在非模板链上，将 d$\\text{Cas12a}$ 的向导RNA设计在模板链上。\n- 任务 $1$ 的核酸酶选择（X用$\\text{SpCas9}$，Y用$\\text{Cas12a}$）与我们的定量分析相符。\n- 任务 $2$ 的靶向链规则（d$\\text{SpCas9}$ 靶向非模板链，d$\\text{Cas12a}$ 靶向模板链）与问题的前提相符。\n- 结论：**正确**。\n\nB. 对微生物 X 使用 $\\text{Cas12a}$，对微生物 Y 使用 $\\text{SpCas9}$，以最大化任务 $1$ 的PAM可用性。对于任务 $2$，将 d$\\text{SpCas9}$ 和 d$\\text{Cas12a}$ 的向导RNA都设计在非模板链上。\n- 任务 $1$ 的核酸酶选择与我们的分析结果相反。\n- 根据问题陈述，d$\\text{Cas12a}$ 的靶向链选择是错误的。\n- 结论：**错误**。\n\nC. 对两种微生物都使用 $\\text{SpCas9}$，因为由于存在简并的 N，$\\text{NGG}$ 序列很常见。对于任务 $2$，链的选择对 d$\\text{SpCas9}$ 和 d$\\text{Cas12a}$ 来说都无关紧要。\n- 对微生物 Y 使用 $\\text{SpCas9}$ 不是最优选择，因为我们的计算显示 $\\text{Cas12a}$ 在那里有更高的PAM密度。定性推理是不够的。\n- 声称链选择对任务 $2$ 无关紧要，直接与问题的前提相矛盾。\n- 结论：**错误**。\n\nD. 对两种微生物都使用 $\\text{Cas12a}$，因为 $\\text{TTTV}$ 在V位置允许三种选择。对于任务 $2$，将 d$\\text{SpCas9}$ 和 d$\\text{Cas12a}$ 的向导RNA都设计在模板链上。\n- 对微生物 X 使用 $\\text{Cas12a}$ 不是最优选择，因为 $\\text{SpCas9}$ 具有高得多的PAM密度。\n- 根据问题陈述，d$\\text{SpCas9}$ 的靶向链选择是错误的。\n- 结论：**错误**。\n\nE. 对于任务 $1$，对微生物 X 使用 $\\text{SpCas9}$，对微生物 Y 使用 $\\text{Cas12a}$，但对于任务 $2$，将 d$\\text{SpCas9}$ 的向导RNA设计在模板链上，将 d$\\text{Cas12a}$ 的向导RNA设计在非模板链上，以使PAM近端与RNA聚合酶的接近方向对齐。\n- 任务 $1$ 的核酸酶选择是正确的。\n- 任务 $2$ 的靶向链规则与问题作为“一个经过充分验证的观察结果”所提供的内容完全相反。必须遵循前提，而不是那些与前提相矛盾的理论解释。\n- 结论：**错误**。\n\n基于对所提供模型和规则的系统性应用，只有选项 A 与分析完全一致。", "answer": "$$\\boxed{A}$$", "id": "2484582"}, {"introduction": "任何基因组编辑实验的最后一步都是精确评估其效率。高通量测序技术为我们提供了海量的编辑结果数据，但要准确解读这些数据，必须借助严谨的统计学方法。本练习将让你扮演数据分析师的角色，推导并应用必要的统计工具，从测序读数中量化编辑效率[@problem_id:2484587]。你将学习如何运用二项分布模型和最大似然估计原理，不仅计算出最可能的编辑率，还为其确定置信区间，这是准确报告实验成果和发表高水平研究的核心能力。", "problem": "进行了一项混合编辑实验，以量化细菌群体中基于成簇规律间隔短回文重复序列（CRISPR）的基因组编辑效率。编辑后，通过新一代测序对一个扩增子进行测序，产生 $n$ 个独立读段，每个读段在目标位点上可被分类为已编辑或未编辑。假设每个读段源于一次独立的、相同的伯努利试验，其成功概率为 $p$，其中成功定义为获得一个已编辑的读段。在这些假设下，已编辑读段的计数 $K$ 服从参数为 $n$ 和 $p$ 的二项分布。\n\n从参数为 $p$ 时 $K=k$ 的二项似然函数定义出发，推导：\n- $p$ 的最大似然估计量 $\\hat{p}$，\n- 通过利用费雪信息对最大似然估计量的渐近正态近似进行逆推，得到的 $p$ 的大样本双侧 $(1-\\alpha)$ 置信区间。\n\n然后，对于一个数据集，其中总共 $n=1000$ 个读段中有 $k=312$ 个已编辑读段，计算 $\\hat{p}$ 的数值以及 $95\\%$ 置信区间的端点，取 $\\alpha=0.05$ 时的 $z_{1-\\alpha/2}=1.96$。所有概率均以小数表示。将最终数值结果四舍五入至四位有效数字。在最终数值答案中，按顺序报告三元组 $\\left(\\hat{p},\\text{下界},\\text{上界}\\right)$。", "solution": "首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 独立读段的数量为 $n$。\n- 每个读段是一次独立的、相同的伯努利试验。\n- 成功（一个已编辑读段）的概率为 $p$。\n- 已编辑读段的计数 $K$ 服从二项分布：$K \\sim \\text{Binomial}(n, p)$。\n- 给定一个具体数据集，其中总共 $n=1000$ 个读段中有 $k=312$ 个已编辑读段。\n- 我们必须推导 $p$ 的最大似然估计量（MLE）$\\hat{p}$。\n- 我们必须通过利用费雪信息对 MLE 的渐近正态近似进行逆推，来推导 $p$ 的大样本双侧 $(1-\\alpha)$ 置信区间。\n- 我们必须为给定数据集计算 $\\hat{p}$ 的数值和 $95\\%$ 置信区间。\n- 置信水平为 $95\\%$，因此 $1-\\alpha = 0.95$，对应 $\\alpha=0.05$。\n- 标准正态分位数给定为 $z_{1-\\alpha/2} = 1.96$。\n- 最终数值结果必须四舍五入至四位有效数字。\n- 最终数值答案必须以三元组 $(\\hat{p}, \\text{下界}, \\text{上界})$ 的形式报告。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，它使用了一个标准的统计模型（二项分布）来解决基因组学中的一个常见应用（量化新一代测序结果）。该问题定义明确、客观且自成体系，为所需的推导和计算提供了所有必要信息。它不违反任何基本原则，不基于错误的前提，也不包含任何模糊或矛盾之处。所提供的数据（$n=1000$, $k=312$）在所述的实验背景下是符合实际的。该问题需要数理统计学领域的标准且非平凡的推导。\n\n**步骤3：结论与行动**\n该问题有效。将提供解答。\n\n参数为 $n$ 和 $p$ 的二项随机变量 $K$ 的概率质量函数由 $P(K=k | n, p) = \\binom{n}{k} p^k (1-p)^{n-k}$ 给出。对于一个固定的观测值 $k$，该函数作为参数 $p$ 的函数，即为似然函数 $L(p|k)$。\n$$L(p|k) = \\binom{n}{k} p^k (1-p)^{n-k}$$\n为求最大似然估计量（MLE）$\\hat{p}$，我们将 $L(p|k)$ 对 $p$ 最大化。由于对数是单调函数，在计算上最大化对数似然函数 $\\ell(p|k) = \\ln L(p|k)$ 更为简单。\n$$\\ell(p|k) = \\ln\\left(\\binom{n}{k}\\right) + k\\ln(p) + (n-k)\\ln(1-p)$$\n我们通过求 $\\ell(p|k)$ 对 $p$ 的一阶导数并令其为零来找到最大值。\n$$\\frac{d\\ell}{dp} = \\frac{k}{p} - \\frac{n-k}{1-p}$$\n将此导数设为零以找到临界点 $\\hat{p}$：\n$$\\frac{k}{\\hat{p}} - \\frac{n-k}{1-\\hat{p}} = 0 \\implies \\frac{k}{\\hat{p}} = \\frac{n-k}{1-\\hat{p}}$$\n$$k(1-\\hat{p}) = \\hat{p}(n-k)$$\n$$k - k\\hat{p} = n\\hat{p} - k\\hat{p}$$\n$$k = n\\hat{p}$$\n这得到了 $p$ 的最大似然估计量：\n$$\\hat{p} = \\frac{k}{n}$$\n为确认这是一个最大值，我们检查二阶导数：\n$$\\frac{d^2\\ell}{dp^2} = -\\frac{k}{p^2} - \\frac{n-k}{(1-p)^2}$$\n由于 $k$ 和 $n$ 是满足 $0 \\le k \\le n$ 的非负计数，且 $p \\in (0, 1)$，该二阶导数恒为负。因此，对数似然函数是凹函数，$\\hat{p} = k/n$ 确实是唯一的最大似然估计量。\n\n接下来，我们推导 $p$ 的大样本置信区间。根据最大似然估计理论，对于大样本量 $n$，MLE $\\hat{p}$ 渐近服从正态分布，其均值等于真实参数 $p$，方差等于费雪信息 $I(p)$ 的倒数，即 $I(p)^{-1}$。\n$$\\hat{p} \\xrightarrow{d} N\\left(p, \\frac{1}{I(p)}\\right)$$\n对于来自伯努利分布的样本量为 $n$ 的样本，其费雪信息 $I(p) = n I_1(p)$，其中 $I_1(p)$ 是单次试验的信息。它可以计算为 $I(p) = -E\\left[\\frac{d^2\\ell}{dp^2}\\right]$。\n$$I(p) = -E\\left[-\\frac{K}{p^2} - \\frac{n-K}{(1-p)^2}\\right] = E\\left[\\frac{K}{p^2}\\right] + E\\left[\\frac{n-K}{(1-p)^2}\\right]$$\n利用期望的线性性质以及 $E[K] = np$ 这一事实：\n$$I(p) = \\frac{E[K]}{p^2} + \\frac{n-E[K]}{(1-p)^2} = \\frac{np}{p^2} + \\frac{n-np}{(1-p)^2} = \\frac{n}{p} + \\frac{n(1-p)}{(1-p)^2} = \\frac{n}{p} + \\frac{n}{1-p}$$\n$$I(p) = n\\left(\\frac{1-p+p}{p(1-p)}\\right) = \\frac{n}{p(1-p)}$$\n因此，$\\hat{p}$ 的渐近方差为 $\\text{Var}(\\hat{p}) \\approx \\frac{1}{I(p)} = \\frac{p(1-p)}{n}$。$\\hat{p}$ 的标准误是 $\\text{SE}(\\hat{p}) = \\sqrt{\\frac{p(1-p)}{n}}$。\n对于大样本量 $n$，标准化统计量（枢轴量）近似服从标准正态分布：\n$$\\frac{\\hat{p}-p}{\\text{SE}(\\hat{p})} \\approx N(0,1)$$\n为构建置信区间，我们必须估计标准误，因为它依赖于未知参数 $p$。我们用 MLE $\\hat{p}$ 代替 $p$，得到估计的标准误 $\\widehat{\\text{SE}}(\\hat{p}) = \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}$。\n$(1-\\alpha)$ 双侧置信区间以 $\\hat{p}$ 为中心，其误差范围由标准正态分位数 $z_{1-\\alpha/2}$ 确定：\n$$\\hat{p} \\pm z_{1-\\alpha/2} \\widehat{\\text{SE}}(\\hat{p})$$\n代入估计标准误的表达式， $p$ 的置信区间为：\n$$\\left[ \\hat{p} - z_{1-\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}, \\quad \\hat{p} + z_{1-\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} \\right]$$\n\n现在，我们将这些结果应用于给定的数据集：$k=312$，$n=1000$，对于 $95\\%$ 的置信区间，$1-\\alpha=0.95$，因此 $\\alpha=0.05$ 且 $z_{1-\\alpha/2} = z_{0.975} = 1.96$。\n\n首先，计算 MLE $\\hat{p}$：\n$$\\hat{p} = \\frac{k}{n} = \\frac{312}{1000} = 0.312$$\n接下来，计算估计的标准误 $\\widehat{\\text{SE}}(\\hat{p})$：\n$$\\widehat{\\text{SE}}(\\hat{p}) = \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} = \\sqrt{\\frac{0.312(1-0.312)}{1000}} = \\sqrt{\\frac{0.312 \\times 0.688}{1000}} = \\sqrt{\\frac{0.214656}{1000}} = \\sqrt{0.000214656} \\approx 0.01465114$$\n误差范围（ME）为：\n$$ME = z_{0.975} \\times \\widehat{\\text{SE}}(\\hat{p}) = 1.96 \\times 0.01465114 \\approx 0.02871624$$\n$95\\%$ 置信区间的端点是：\n下界：$\\hat{p} - ME = 0.312 - 0.02871624 \\approx 0.28328376$\n上界：$\\hat{p} + ME = 0.312 + 0.02871624 \\approx 0.34071624$\n\n将这些结果四舍五入至四位有效数字：\n$\\hat{p} = 0.3120$\n下界 $= 0.2833$\n上界 $= 0.3407$\n最终的三元组是 $(0.3120, 0.2833, 0.3407)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3120 & 0.2833 & 0.3407 \\end{pmatrix}}\n$$", "id": "2484626"}, {"introduction": "选择合适的CRISPR系统并设计好向导RNA（guide RNA）之后，一个核心问题便是脱靶效应——即CRISPR系统在基因组中切割了非预期的位点。能够预测脱靶事件的发生概率，对于确保实验的特异性至关重要。本练习将指导你从基本概率原理出发，建立一个用于估算基因组中潜在脱靶位点期望数量的数学模型[@problem_id:2484626]。通过这个计算实践，你将掌握在实验开始前定量评估向导RNA特异性的能力，从而有效规避非预期的基因组编辑。", "problem": "您正在使用成簇规律间隔短回文重复序列 (CRISPR) 和化脓性链球菌Cas9 (SpCas9) 对一种细菌进行基因工程改造。在一个零序列模型中，基因组被视为一个独立同分布且核苷酸组成均一的序列。在该模型中，一个潜在的脱靶结合事件被定义为任何与一个有效的SpCas9前间隔序列邻近基序 (PAM) 相邻的基因组位点，该位点与一个固定的、长度为 $L$ 的向导核糖核酸 (RNA) 相比，错配数量最多为指定值 $m$。对于SpCas9，PAM是三核苷酸模式 $\\mathrm{NGG}$，其中 $\\mathrm{N}$ 是任何碱基，$\\mathrm{G}$ 表示鸟嘌呤。假设基因组位置之间和向导位置之间相互独立，并通过将 $G$ 视为在单链上扫描的候选项位数量来忽略链特异性效应。\n\n请仅从以下三点出发：(i) 指示随机变量之和的期望值的定义，(ii) 独立伯努利试验的基本概率规则，以及 (iii) 二项分布，推导出一个解析表达式，用于计算与向导相比错配数量最多为 $m$ 的脱靶位点的期望数量。您的表达式必须用基因组大小 $G$、PAM频率 $f_{\\mathrm{PAM}}$、向导长度 $L$ 和错配容忍度 $m$ 来表示。\n\n然后，将此表达式应用于均一核苷酸组成和SpCas9的特定情况，并对 $G = 4.64 \\times 10^{6}$、$L = 20$ 和 $m = 2$ 进行数值计算。在均一组成假设下，根据第一性原理计算 $\\mathrm{NGG}$ 基序的 $f_{\\mathrm{PAM}}$。将您最终的数值答案四舍五入到四位有效数字。最终答案以纯数字形式表示，不带单位。", "solution": "在尝试任何解答之前，首先对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 研究系统：在细菌中使用CRISPR/SpCas9进行基因组工程。\n- 模型：一个零序列模型，其中基因组是一个独立同分布 (i.i.d.) 且核苷酸组成均一的序列。\n- 脱靶位点定义：一个与有效的SpCas9前间隔序列邻近基序 (PAM) 相邻的基因组位点，其与一个固定长度为 $L$ 的向导RNA相比，错配数最多为指定的数量 $m$。\n- SpCas9 PAM：三核苷酸模式 $\\mathrm{NGG}$，其中 $\\mathrm{N}$ 是任意碱基，$\\mathrm{G}$ 是鸟嘌呤。\n- 假设：基因组位置之间和向导位置之间相互独立。忽略链特异性效应。\n- 变量与常量：$G$ 是扫描的候选项位数量；$L$ 是向导RNA长度；$m$ 是最大错配数；$f_{\\mathrm{PAM}}$ 是PAM频率。\n- 要求的推导方法：必须从 (i) 指示随机变量之和的期望值的定义，(ii) 独立伯努利试验的概率规则，以及 (iii) 二项分布出发。\n- 推导的输出要求：用 $G$、$f_{\\mathrm{PAM}}$、$L$ 和 $m$ 表示脱靶位点期望数量的解析表达式。\n- 数值计算参数：$G = 4.64 \\times 10^{6}$，$L = 20$，$m = 2$。\n- 数值计算任务：在均一组成假设下计算 $\\mathrm{NGG}$ 基序的 $f_{\\mathrm{PAM}}$，并评估期望数量，将结果四舍五入到四位有效数字。\n\n步骤2：使用提取的已知条件进行验证。\n评估问题的有效性。\n- 科学依据：该问题在科学上是合理的。它采用了生物信息学中用于估算CRISPR-Cas9脱靶活性的标准（尽管简化了的）概率模型。SpCas9及其PAM ($\\mathrm{NGG}$)、向导RNA和错配的定义在分子生物学和基因组工程领域都是真实且标准的。\n- 适定性：该问题是适定的。它清晰地定义了目标、给定参数、基本假设（i.i.d.序列、独立性）以及所要求的数学框架。这些要求会导向一个唯一的、稳定的且有意义的解。\n- 客观性：问题以精确、客观、技术性的语言陈述，没有任何主观性或歧义。\n\n该问题没有表现出任何已定义的缺陷（例如，科学上不合理、不完整、不现实）。所提供的假设，如i.i.d.零序列模型，是此类计算的标准简化，并且已明确说明。\n\n步骤3：结论与行动。\n宣布该问题有效。将提供一个完整的、有理有据的解答。\n\n目标是推导脱靶位点的期望数量，记为 $E$。我们考虑一个有 $G$ 个潜在靶点的基因组。我们为每个位点 $i \\in \\{1, 2, \\ldots, G\\}$ 定义一个指示随机变量 $I_i$。如果位点 $i$ 是一个脱靶位点，变量 $I_i$ 取值为 $1$，否则为 $0$。\n脱靶位点的总数是这些指示变量的总和，即 $\\sum_{i=1}^{G} I_i$。根据问题说明，我们使用随机变量和的期望性质，即期望的和等于和的期望（期望的线性性）：\n$$\nE = E\\left[\\sum_{i=1}^{G} I_i\\right] = \\sum_{i=1}^{G} E[I_i]\n$$\n对于一个指示变量，其期望是它所指示事件的概率：$E[I_i] = P(I_i = 1)$。问题假设了一个i.i.d.模型，意味着每个位点在统计上是相同的。因此，概率 $P(I_i = 1)$ 对所有 $i$ 都是常数。我们把这个概率记为 $p_{\\text{off-target}}$。脱靶位点期望数量的表达式简化为：\n$$\nE = G \\cdot p_{\\text{off-target}}\n$$\n一个位点被定义为脱靶位点，需要满足两个独立的条件：($1$) 它与一个有效的PAM相邻，以及 ($2$) 其长度为 $L$ 的序列与向导RNA序列相比，错配数量最多为 $m$。设 $A$ 是存在有效PAM的事件， $B$ 是序列错配数量最多为 $m$ 的事件。一个脱靶位点的概率是 $p_{\\text{off-target}} = P(A \\cap B)$。由于假设基因组位置是独立的，这两个事件也是独立的，因此 $P(A \\cap B) = P(A) \\cdot P(B)$。\nPAM的概率 $P(A)$ 即为PAM频率 $f_{\\mathrm{PAM}}$。\n概率 $P(B)$ 是在长度为 $L$ 的序列中最多有 $m$ 个错配的概率。根据要求，我们使用二项分布框架来分析这个问题。将向导序列与潜在位点的基因组DNA进行比较，涉及 $L$ 次独立的比较，这些都是伯努利试验。对于每个位置，结果要么是‘匹配’，要么是‘错配’。\n问题指定了均一的核苷酸组成，意味着在任何位置找到四种碱基（A、C、G、T）中任意一种的概率是 $p_{\\text{base}} = \\frac{1}{4}$。对于固定的向导RNA中的任何给定位置，与随机基因组碱基匹配的概率是 $p_{\\text{match}} = \\frac{1}{4}$。因此，错配的概率是 $p_{\\text{mismatch}} = 1 - p_{\\text{match}} = 1 - \\frac{1}{4} = \\frac{3}{4}$。\n长度为 $L$ 的序列中错配的数量 $k$ 服从二项分布 $B(L, p_{\\text{mismatch}})$。观察到恰好 $k$ 个错配的概率由以下公式给出：\n$$\nP(k \\text{ mismatches}) = \\binom{L}{k} (p_{\\text{mismatch}})^k (p_{\\text{match}})^{L-k} = \\binom{L}{k} \\left(\\frac{3}{4}\\right)^k \\left(\\frac{1}{4}\\right)^{L-k}\n$$\n事件 $B$ 对应于最多有 $m$ 个错配，即 $k \\le m$。概率 $P(B)$ 是 $k = 0, 1, \\ldots, m$ 时概率的总和：\n$$\nP(B) = \\sum_{k=0}^{m} \\binom{L}{k} \\left(\\frac{3}{4}\\right)^k \\left(\\frac{1}{4}\\right)^{L-k}\n$$\n综合所有部分，脱靶位点期望数量的最终解析表达式为：\n$$\nE = G \\cdot f_{\\mathrm{PAM}} \\cdot \\sum_{k=0}^{m} \\binom{L}{k} \\left(\\frac{3}{4}\\right)^k \\left(\\frac{1}{4}\\right)^{L-k}\n$$\n该表达式用所要求的变量 $G$、$f_{\\mathrm{PAM}}$、$L$ 和 $m$ 表示。\n\n现在，我们针对给定情况进行特化并执行数值计算。\n首先，我们在均一核苷酸组成的假设下，计算SpCas9 PAM ($\\mathrm{NGG}$) 的 $f_{\\mathrm{PAM}}$。由于独立性，这个三核苷酸序列的概率是每个碱基概率的乘积：\n$$\nf_{\\mathrm{PAM}} = P(\\mathrm{N}) \\cdot P(\\mathrm{G}) \\cdot P(\\mathrm{G})\n$$\n这里，$P(\\mathrm{N})$ 是任何核苷酸的概率，为 $1$。$P(\\mathrm{G})$ 是鸟嘌呤的概率，为 $\\frac{1}{4}$。\n$$\nf_{\\mathrm{PAM}} = 1 \\cdot \\frac{1}{4} \\cdot \\frac{1}{4} = \\frac{1}{16} = 0.0625\n$$\n给定的参数是 $G = 4.64 \\times 10^{6}$、$L = 20$ 和 $m = 2$。\n我们必须计算 $k$ 从 $0$ 到 $2$ 的和：\n$$\n\\sum_{k=0}^{2} \\binom{20}{k} \\left(\\frac{3}{4}\\right)^k \\left(\\frac{1}{4}\\right)^{20-k} = \\frac{1}{4^{20}} \\sum_{k=0}^{2} \\binom{20}{k} 3^k\n$$\n二项式系数为：\n$\\binom{20}{0} = 1$\n$\\binom{20}{1} = 20$\n$\\binom{20}{2} = \\frac{20 \\cdot 19}{2} = 190$\n方括号中的项是：\n$$\n\\binom{20}{0} \\cdot 3^0 + \\binom{20}{1} \\cdot 3^1 + \\binom{20}{2} \\cdot 3^2 = 1 \\cdot 1 + 20 \\cdot 3 + 190 \\cdot 9 = 1 + 60 + 1710 = 1771\n$$\n所以最多有 $m=2$ 个错配的概率是 $P(B) = \\frac{1771}{4^{20}}$。\n现在，我们计算最终的期望值 $E$：\n$$\nE = G \\cdot f_{\\mathrm{PAM}} \\cdot P(B) = (4.64 \\times 10^{6}) \\cdot \\left(\\frac{1}{16}\\right) \\cdot \\left(\\frac{1771}{4^{20}}\\right)\n$$\n代入 $16 = 4^2$：\n$$\nE = (4.64 \\times 10^{6}) \\cdot \\frac{1}{4^2} \\cdot \\frac{1771}{4^{20}} = \\frac{4.64 \\times 10^{6} \\times 1771}{4^{22}}\n$$\n我们计算分母：$4^{22} = (2^2)^{22} = 2^{44} = 17592186044416$。\n分子是：$4.64 \\times 10^{6} \\times 1771 = 8217.84 \\times 10^{6}$。\n$$\nE = \\frac{8217.84 \\times 10^{6}}{17592186044416} = \\frac{8217.84}{17592186.044416} \\approx 0.000467145\n$$\n四舍五入到四位有效数字，结果是 $0.0004671$。", "answer": "$$\\boxed{0.0004671}$$", "id": "2484587"}]}