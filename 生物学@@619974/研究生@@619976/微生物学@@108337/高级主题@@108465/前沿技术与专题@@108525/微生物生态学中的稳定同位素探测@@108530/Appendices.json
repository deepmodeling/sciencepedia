{"hands_on_practices": [{"introduction": "稳定同位素探针（SIP）技术的物理基础在于，我们能够通过密度梯度离心将标记了重同位素的DNA与未标记的DNA分离开。本练习将引导你使用一个预测模型，该模型将DNA分子的内在属性（鸟嘌呤-胞嘧啶含量，即 $GC$ 含量）及同位素标记程度，与其在氯化铯（$CsCl$）密度梯度中的最终浮力密度联系起来。掌握这一前向模型是理解SIP实验设计和结果解读的关键第一步。[@problem_id:2534014]", "problem": "在用于脱氧核糖核酸（DNA）稳定同位素探针（SIP）的氯化铯平衡密度梯度中，等密度平衡时的浮力密度由DNA所受净浮力为零时的溶液密度决定。微生物生态学中的定量解释基于两个经过充分检验的事实：(i) 在氯化铯（CsCl）中，当温度和离子强度固定时，DNA的浮力密度随鸟嘌呤+胞嘧啶摩尔分数的增加而近似线性增加，这是因为与鸟嘌呤和胞嘧啶相关的更高的平均偏比容和每碱基对质量使平衡密度发生偏移；(ii) 增加分子质量的同位素取代（例如，用碳-13替换碳-12），在稀释取代和理想混合的假设下，会产生一个与DNA碳库中重同位素原子分数成正比的浮力密度近似线性增加。这些线性依赖关系可以通过一个基线DNA浮力密度（对应于零鸟嘌呤+胞嘧啶分数和自然同位素丰度）、一个相对于鸟嘌呤+胞嘧啶摩尔分数的斜率，以及一个相对于碳-13原子分数的斜率来进行参数化。\n\n现为您提供在实验温度下，DNA在CsCl中获得的以下经验校准参数：基线密度 $\\rho_{0}=1.660~\\mathrm{g~mL^{-1}}$，鸟嘌呤+胞嘧啶斜率 $k_{\\mathrm{GC}}=0.098~\\mathrm{g~mL^{-1}}$ 每单位鸟嘌呤+胞嘧啶摩尔分数，以及同位素斜率 $\\alpha=0.036~\\mathrm{g~mL^{-1}}$ 每单位 $^{\\text{13}}\\text{C}$ 原子分数。考虑一个微生物基因组，其鸟嘌呤+胞嘧啶摩尔分数为 $x_{\\mathrm{GC}}=0.60$，在 $^{\\text{13}}\\text{C}$ 标记的底物上孵育后，其DNA中 $^{\\text{13}}\\text{C}$ 的碳原子分数为 $f_{H}=0.30$。\n\n使用上述合理的线性响应框架，确定该DNA的期望浮力密度，单位为 $\\mathrm{g~mL^{-1}}$。将您的最终答案四舍五入到四位有效数字。", "solution": "在尝试进行任何解答之前，将对问题进行验证。\n\n首先，我将逐字提取问题陈述中的已知条件。\n- 基线DNA浮力密度（对应于零鸟嘌呤+胞嘧啶分数和自然同位素丰度），$\\rho_{0}=1.660~\\mathrm{g~mL^{-1}}$。\n- 鸟嘌呤+胞嘧啶斜率，$k_{\\mathrm{GC}}=0.098~\\mathrm{g~mL^{-1}}$ 每单位鸟嘌呤+胞嘧啶摩尔分数。\n- $^{\\text{13}}\\text{C}$ 的同位素斜率，$\\alpha=0.036~\\mathrm{g~mL^{-1}}$ 每单位 $^{\\text{13}}\\text{C}$ 原子分数。\n- 微生物基因组的鸟嘌呤+胞嘧啶摩尔分数，$x_{\\mathrm{GC}}=0.60$。\n- 孵育后DNA碳库中 $^{\\text{13}}\\text{C}$ 的原子分数，$f_{H}=0.30$。\n- 浮力密度、鸟嘌呤+胞嘧啶摩尔分数和同位素取代之间的关系被描述为一个线性模型。\n- 最终答案必须四舍五入到四位有效数字。\n\n接下来，我将根据这些提取的已知条件来验证问题。\n1.  **科学依据**：该问题描述了一个简化但基本正确的DNA在氯化铯梯度中浮力密度的模型，这是分子生物学和微生物生态学中称为稳定同位素探针（SIP）的标准技术。浮力密度对G+C含量和重同位素掺入的线性依赖性是用于定量分析的公认近似。所提供的参数值在此实验背景下是物理上现实的。该问题在科学上是合理的。\n2.  **良构性**：该问题提供了一个清晰的数学框架——一个线性模型——以及计算浮力密度单一、唯一值所需的所有必要参数。该问题是良构的。\n3.  **客观性**：该问题以精确、定量和客观的术语陈述。没有主观或基于意见的陈述。该问题是客观的。\n4.  **完整性与一致性**：该问题是自洽的。它提供了应用所述线性模型所需的所有常数和变量。没有矛盾之处。\n5.  **现实性与可行性**：所描述的条件是DNA-SIP实验的标准条件。$60\\%$的G+C含量在细菌中很常见，而$30\\%$的$^{\\text{13}}\\text{C}$原子分数在实验室孵育中是可以实现的。该问题是现实的。\n6.  **其他缺陷**：该问题并非微不足道，因为它需要正确应用一个多变量线性模型。它不是隐喻性的、病态的或不可验证的。\n\n结论是该问题有效。我现在将继续解答。\n\n问题陈述浮力密度 $\\rho$ 是鸟嘌呤+胞嘧啶摩尔分数 $x_{\\mathrm{GC}}$ 和重同位素 $^{\\text{13}}\\text{C}$ 原子分数 $f_{H}$ 的线性函数。该模型可以表示为相对于基线密度 $\\rho_0$ 的效应的线性叠加。这种线性模型的一般形式是：\n$$\n\\rho(x_{\\mathrm{GC}}, f_{H}) = \\rho_{0} + \\Delta\\rho_{\\mathrm{GC}} + \\Delta\\rho_{\\mathrm{iso}}\n$$\n其中 $\\Delta\\rho_{\\mathrm{GC}}$ 是由鸟嘌呤+胞嘧啶含量引起的密度漂移，而 $\\Delta\\rho_{\\mathrm{iso}}$ 是由同位素标记引起的密度漂移。\n\n根据问题描述，这些漂移与它们各自的控制变量成正比，比例常数是给定的斜率 $k_{\\mathrm{GC}}$ 和 $\\alpha$。\n来自鸟嘌呤+胞嘧啶含量的贡献是：\n$$\n\\Delta\\rho_{\\mathrm{GC}} = k_{\\mathrm{GC}} \\cdot x_{\\mathrm{GC}}\n$$\n来自同位素取代的贡献是：\n$$\n\\Delta\\rho_{\\mathrm{iso}} = \\alpha \\cdot f_{H}\n$$\n结合这些项，浮力密度 $\\rho$ 的完整方程是：\n$$\n\\rho(x_{\\mathrm{GC}}, f_{H}) = \\rho_{0} + k_{\\mathrm{GC}} \\cdot x_{\\mathrm{GC}} + \\alpha \\cdot f_{H}\n$$\n现在，我将把提供的数值代入此方程。\n给定值为：\n- $\\rho_{0} = 1.660~\\mathrm{g~mL^{-1}}$\n- $k_{\\mathrm{GC}} = 0.098~\\mathrm{g~mL^{-1}}$\n- $x_{\\mathrm{GC}} = 0.60$\n- $\\alpha = 0.036~\\mathrm{g~mL^{-1}}$\n- $f_{H} = 0.30$\n\n计算过程如下：\n$$\n\\rho = 1.660 + (0.098 \\cdot 0.60) + (0.036 \\cdot 0.30)\n$$\n首先，计算各个部分的贡献：\nG+C含量的贡献是：\n$$\nk_{\\mathrm{GC}} \\cdot x_{\\mathrm{GC}} = 0.098 \\cdot 0.60 = 0.0588\n$$\n同位素标记的贡献是：\n$$\n\\alpha \\cdot f_{H} = 0.036 \\cdot 0.30 = 0.0108\n$$\n现在，将这些贡献与基线密度相加：\n$$\n\\rho = 1.660 + 0.0588 + 0.0108\n$$\n$$\n\\rho = 1.7188 + 0.0108\n$$\n$$\n\\rho = 1.7296~\\mathrm{g~mL^{-1}}\n$$\n问题要求最终答案四舍五入到四位有效数字。计算值为 $1.7296$。前四位有效数字是 $1$、$7$、$2$ 和 $9$。第五位数字是 $6$，大于或等于 $5$，所以我们将第四位数字向上取整。\n$$\n\\rho \\approx 1.730~\\mathrm{g~mL^{-1}}\n$$\n最终计算出的浮力密度是 $1.730~\\mathrm{g~mL^{-1}}$。", "answer": "$$\\boxed{1.730}$$", "id": "2534014"}, {"introduction": "在掌握了预测浮力密度的理论后，下一步是分析真实的实验数据。实际的SIP实验会产生DNA在密度梯度中不同组分内的丰度分布。本练习将向你展示如何处理这些原始数据，通过计算DNA丰度分布的质心来量化其密度漂移，并最终推算出关键的生物学指标——原子分数超额（Atom Fraction Excess, AFE），这是衡量同位素掺入程度的核心参数。[@problem_id:2533985]", "problem": "给定单个操作分类单元（Operational Taxonomic Unit, OTU）在脱氧核糖核酸（Deoxyribonucleic Acid, DNA）稳定同位素探测（Stable Isotope Probing, SIP）氯化铯（Cesium Chloride, CsCl）等密度梯度实验中，按梯度组分收集的丰度数据。对于每个测试用例，您将获得一组相同的浮力密度下的两种丰度分布：一种分布来自未标记的对照DNA样本，另一种来自标记的DNA处理组。您的任务是实现计算每种分布在密度空间中的质心，根据质心的位移解释DNA中碳-13的原子百分超（Atom Fraction Excess, AFE），并以小数形式输出AFE值。\n\n使用以下基本原理：\n- 对于密度坐标为$\\rho$且非负权重函数为$w(\\rho)$的连续分布，其质心（center of mass, COM）定义为：\n$$\\rho_{\\mathrm{COM}} \\;=\\; \\dfrac{\\int \\rho\\, w(\\rho)\\, d\\rho}{\\int w(\\rho)\\, d\\rho}.$$\n- 对于由索引$i$表示的离散组分，其浮力密度为$\\rho_i$，非负丰度为$a_i$，通过黎曼和来近似该积分，得到离散质心：\n$$\\rho_{\\mathrm{COM}} \\;=\\; \\dfrac{\\sum_i \\rho_i\\, a_i}{\\sum_i a_i}.$$\n- 在恒温的氯化铯DNA梯度中，由碳-13标记引起的浮力密度位移与DNA中碳-13的原子百分超近似成线性关系。令$k$为比例常数（单位原子百分超引起的密度位移）。使用$k = 0.036$，单位为 $\\mathrm{g}\\,\\mathrm{mL}^{-1}$ 每单位AFE：\n$$\\Delta \\rho \\;=\\; k \\cdot \\mathrm{AFE}.$$\n假设未标记和标记的测量指的是同一个OTU，因此鸟嘌呤+胞嘧啶（Guanine+Cytosine）的含量是恒定的，在计算差值时会被抵消。\n\n算法任务：\n1. 对每个测试用例，使用上述离散公式计算未标记样本的质心$\\rho_{\\mathrm{U}}$和标记样本的质心$\\rho_{\\mathrm{L}}$。此处，$\\rho_i$为浮力密度（单位：$\\mathrm{g}\\,\\mathrm{mL}^{-1}$），$a_i$为非负丰度（任意单位）。\n2. 计算密度位移 $\\Delta \\rho = \\rho_{\\mathrm{L}} - \\rho_{\\mathrm{U}}$，单位为 $\\mathrm{g}\\,\\mathrm{mL}^{-1}$。\n3. 计算原子百分超 $\\mathrm{AFE} = \\Delta \\rho / k$（无量纲）。\n4. 由于测量噪声，AFE的负值估计在物理上是不允许的；因此，如果$\\mathrm{AFE}  0$，则该用例报告$0$。\n5. 对于数值报告，将每个AFE四舍五入到小数点后六位，并表示为小数（不含百分号）。\n\n物理单位：\n- 密度$\\rho_i$的单位为 $\\mathrm{g}\\,\\mathrm{mL}^{-1}$。\n- 比例常数为 $k = 0.036$ $\\mathrm{g}\\,\\mathrm{mL}^{-1}$ 每单位AFE。\n- 最终的AFE是无量纲的，必须报告为四舍五入到小数点后六位的小数。\n\n测试套件：\n对于每个用例，给定一个密度列表和两个丰度列表（第一个是未标记的，第二个是标记的）。所有用例均使用 $k = 0.036$。\n\n- 用例 $1$：\n  - 密度：$[\\,1.690,\\,1.700,\\,1.710,\\,1.720,\\,1.730\\,]$\n  - 未标记丰度：$[\\,10,\\,50,\\,100,\\,50,\\,10\\,]$\n  - 标记丰度：$[\\,5,\\,20,\\,80,\\,80,\\,35\\,]$\n\n- 用例 $2$：\n  - 密度：$[\\,1.700,\\,1.710,\\,1.720\\,]$\n  - 未标记丰度：$[\\,0,\\,10,\\,0\\,]$\n  - 标记丰度：$[\\,0,\\,10,\\,0\\,]$\n\n- 用例 $3$：\n  - 密度：$[\\,1.680,\\,1.690,\\,1.700,\\,1.710\\,]$\n  - 未标记丰度：$[\\,20,\\,10,\\,0,\\,0\\,]$\n  - 标记丰度：$[\\,0,\\,0,\\,0,\\,30\\,]$\n\n- 用例 $4$：\n  - 密度：$[\\,1.700,\\,1.705,\\,1.710,\\,1.715,\\,1.720\\,]$\n  - 未标记丰度：$[\\,1,\\,0,\\,0,\\,0,\\,0\\,]$\n  - 标记丰度：$[\\,0,\\,0,\\,0,\\,0,\\,1\\,]$\n\n- 用例 $5$：\n  - 密度：$[\\,1.700,\\,1.705,\\,1.710\\,]$\n  - 未标记丰度：$[\\,5,\\,10,\\,5\\,]$\n  - 标记丰度：$[\\,4,\\,10,\\,6\\,]$\n\n- 用例 $6$（测试非负性处理）：\n  - 密度：$[\\,1.700,\\,1.710,\\,1.720\\,]$\n  - 未标记丰度：$[\\,0,\\,10,\\,0\\,]$\n  - 标记丰度：$[\\,7,\\,3,\\,0\\,]$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用例$1$到$6$的AFE结果，格式为逗号分隔的列表，并用方括号括起来，每个值都四舍五入到小数点后六位（例如，$[0.123456,0.000000,\\dots]$）。", "solution": "问题陈述已经过验证，被认为是科学上可靠、定义明确且客观的。它提出了一个简化但正确的DNA稳定同位素探测（Stable Isotope Probing, SIP）中的常见计算，这是一种在微生物生态学中使用的技术。所有必要的数据、定义和物理常数都已提供，没有内部矛盾或歧义。我们将着手解决问题。\n\n核心任务是量化重同位素（碳-$13$）并入特定微生物操作分类单元（Operational Taxonomic Unit, OTU）的脱氧核糖核酸（Deoxyribonucleic Acid, DNA）中的程度。这种并入表现为DNA浮力密度的增加。该分析依赖于密度梯度中DNA丰度分布的质心（center of mass, COM）概念。\n\n如问题中所述，一组离散组分的质心计算为浮力密度$\\rho_i$的加权平均值，其中权重是相应的丰度$a_i$。对于未标记的对照样本（U）和标记的处理样本（L），各自的质心$\\rho_{\\mathrm{U}}$和$\\rho_{\\mathrm{L}}$计算如下：\n$$\n\\rho_{\\mathrm{U}} = \\frac{\\sum_i \\rho_i a_{U_i}}{\\sum_i a_{U_i}}\n\\qquad \\text{和} \\qquad\n\\rho_{\\mathrm{L}} = \\frac{\\sum_i \\rho_i a_{L_i}}{\\sum_i a_{L_i}}\n$$\n此处，$a_{U_i}$和$a_{L_i}$分别代表未标记和标记样本在第$i$个组分中的丰度。\n\n质心的位移$\\Delta\\rho$是标记质心与未标记质心之差：\n$$\n\\Delta\\rho = \\rho_{\\mathrm{L}} - \\rho_{\\mathrm{U}}\n$$\n该密度位移在物理上与DNA中$^{13}\\text{C}$的原子百分超（Atom Fraction Excess, AFE）成正比。该关系由一个线性近似给出：\n$$\n\\Delta\\rho = k \\cdot \\text{AFE}\n$$\n其中$k$是比例常数，给定值为$k = 0.036 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}$每单位AFE。由此，我们推导出AFE的表达式：\n$$\n\\text{AFE} = \\frac{\\Delta\\rho}{k}\n$$\n由于AFE代表同位素超额分数，它在物理上不能为负。因此，任何可能由测量噪声或实验假象导致的计算值$\\text{AFE}  0$都必须校正为$0$。\n\n我们现在将此程序应用于每个测试用例。\n\n**用例 1：**\n- 密度 $\\rho_i$：$[\\,1.690,\\,1.700,\\,1.710,\\,1.720,\\,1.730\\,]$\n- 未标记丰度 $a_{U_i}$：$[\\,10,\\,50,\\,100,\\,50,\\,10\\,]$\n- 标记丰度 $a_{L_i}$：$[\\,5,\\,20,\\,80,\\,80,\\,35\\,]$\n$$\n\\rho_{\\mathrm{U}} = \\frac{1.690(10) + 1.700(50) + 1.710(100) + 1.720(50) + 1.730(10)}{10+50+100+50+10} = \\frac{376.2}{220} = 1.710 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\rho_{\\mathrm{L}} = \\frac{1.690(5) + 1.700(20) + 1.710(80) + 1.720(80) + 1.730(35)}{5+20+80+80+35} = \\frac{377.4}{220} \\approx 1.71545455 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\Delta\\rho = 1.71545455 - 1.710 = 0.00545455 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\text{AFE} = \\frac{0.00545455}{0.036} \\approx 0.15151515 \\implies 0.151515\n$$\n\n**用例 2：**\n- 密度 $\\rho_i$：$[\\,1.700,\\,1.710,\\,1.720\\,]$\n- 未标记丰度 $a_{U_i}$：$[\\,0,\\,10,\\,0\\,]$\n- 标记丰度 $a_{L_i}$：$[\\,0,\\,10,\\,0\\,]$\n$$\n\\rho_{\\mathrm{U}} = \\frac{1.710(10)}{10} = 1.710 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\rho_{\\mathrm{L}} = \\frac{1.710(10)}{10} = 1.710 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\Delta\\rho = 1.710 - 1.710 = 0 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\text{AFE} = \\frac{0}{0.036} = 0 \\implies 0.000000\n$$\n\n**用例 3：**\n- 密度 $\\rho_i$：$[\\,1.680,\\,1.690,\\,1.700,\\,1.710\\,]$\n- 未标记丰度 $a_{U_i}$：$[\\,20,\\,10,\\,0,\\,0\\,]$\n- 标记丰度 $a_{L_i}$：$[\\,0,\\,0,\\,0,\\,30\\,]$\n$$\n\\rho_{\\mathrm{U}} = \\frac{1.680(20) + 1.690(10)}{20+10} = \\frac{50.5}{30} \\approx 1.68333333 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\rho_{\\mathrm{L}} = \\frac{1.710(30)}{30} = 1.710 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\Delta\\rho = 1.710 - 1.68333333 = 0.02666667 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\text{AFE} = \\frac{0.02666667}{0.036} \\approx 0.74074074 \\implies 0.740741\n$$\n\n**用例 4：**\n- 密度 $\\rho_i$：$[\\,1.700,\\,1.705,\\,1.710,\\,1.715,\\,1.720\\,]$\n- 未标记丰度 $a_{U_i}$：$[\\,1,\\,0,\\,0,\\,0,\\,0\\,]$\n- 标记丰度 $a_{L_i}$：$[\\,0,\\,0,\\,0,\\,0,\\,1\\,]$\n$$\n\\rho_{\\mathrm{U}} = \\frac{1.700(1)}{1} = 1.700 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\rho_{\\mathrm{L}} = \\frac{1.720(1)}{1} = 1.720 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\Delta\\rho = 1.720 - 1.700 = 0.020 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\text{AFE} = \\frac{0.020}{0.036} \\approx 0.55555556 \\implies 0.555556\n$$\n\n**用例 5：**\n- 密度 $\\rho_i$：$[\\,1.700,\\,1.705,\\,1.710\\,]$\n- 未标记丰度 $a_{U_i}$：$[\\,5,\\,10,\\,5\\,]$\n- 标记丰度 $a_{L_i}$：$[\\,4,\\,10,\\,6\\,]$\n$$\n\\rho_{\\mathrm{U}} = \\frac{1.700(5) + 1.705(10) + 1.710(5)}{5+10+5} = \\frac{34.1}{20} = 1.705 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\rho_{\\mathrm{L}} = \\frac{1.700(4) + 1.705(10) + 1.710(6)}{4+10+6} = \\frac{34.11}{20} = 1.7055 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\Delta\\rho = 1.7055 - 1.705 = 0.0005 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\text{AFE} = \\frac{0.0005}{0.036} \\approx 0.01388889 \\implies 0.013889\n$$\n\n**用例 6：**\n- 密度 $\\rho_i$：$[\\,1.700,\\,1.710,\\,1.720\\,]$\n- 未标记丰度 $a_{U_i}$：$[\\,0,\\,10,\\,0\\,]$\n- 标记丰度 $a_{L_i}$：$[\\,7,\\,3,\\,0\\,]$\n$$\n\\rho_{\\mathrm{U}} = \\frac{1.710(10)}{10} = 1.710 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\rho_{\\mathrm{L}} = \\frac{1.700(7) + 1.710(3)}{7+3} = \\frac{17.03}{10} = 1.703 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\Delta\\rho = 1.703 - 1.710 = -0.007 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n得到的$\\Delta\\rho$为负值，这将导致AFE为负。根据问题规范，这在物理上是不允许的，必须设为$0$。\n$$\n\\text{AFE}_{\\text{raw}} = \\frac{-0.007}{0.036}  0 \\implies \\text{AFE} = 0 \\implies 0.000000\n$$\n\n实现代码将遵循此逻辑以生成最终结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Atom Fraction Excess (AFE) in DNA Stable Isotope Probing (SIP)\n    experiments based on buoyant density shifts.\n    \"\"\"\n\n    # Proportionality constant k in g/mL per unit AFE\n    k_constant = 0.036\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"densities\": [1.690, 1.700, 1.710, 1.720, 1.730],\n            \"unlabeled_abundances\": [10, 50, 100, 50, 10],\n            \"labeled_abundances\": [5, 20, 80, 80, 35],\n        },\n        {\n            \"densities\": [1.700, 1.710, 1.720],\n            \"unlabeled_abundances\": [0, 10, 0],\n            \"labeled_abundances\": [0, 10, 0],\n        },\n        {\n            \"densities\": [1.680, 1.690, 1.700, 1.710],\n            \"unlabeled_abundances\": [20, 10, 0, 0],\n            \"labeled_abundances\": [0, 0, 0, 30],\n        },\n        {\n            \"densities\": [1.700, 1.705, 1.710, 1.715, 1.720],\n            \"unlabeled_abundances\": [1, 0, 0, 0, 0],\n            \"labeled_abundances\": [0, 0, 0, 0, 1],\n        },\n        {\n            \"densities\": [1.700, 1.705, 1.710],\n            \"unlabeled_abundances\": [5, 10, 5],\n            \"labeled_abundances\": [4, 10, 6],\n        },\n        {\n            \"densities\": [1.700, 1.710, 1.720],\n            \"unlabeled_abundances\": [0, 10, 0],\n            \"labeled_abundances\": [7, 3, 0],\n        }\n    ]\n\n    results = []\n\n    def calculate_com(densities, abundances):\n        \"\"\"Calculates the discrete center of mass.\"\"\"\n        total_abundance = np.sum(abundances)\n        if total_abundance == 0:\n            # Handle case with no abundance, though not expected in test data.\n            # Return 0 or raise error. Returning 0 is safer for automation.\n            return 0.0\n        \n        # Weighted sum of densities\n        weighted_sum = np.dot(densities, abundances)\n        \n        return weighted_sum / total_abundance\n\n    for case in test_cases:\n        densities = np.array(case[\"densities\"])\n        unlabeled_abundances = np.array(case[\"unlabeled_abundances\"])\n        labeled_abundances = np.array(case[\"labeled_abundances\"])\n\n        # 1. Compute COM for unlabeled and labeled distributions\n        rho_unlabeled = calculate_com(densities, unlabeled_abundances)\n        rho_labeled = calculate_com(densities, labeled_abundances)\n\n        # 2. Compute the density shift\n        delta_rho = rho_labeled - rho_unlabeled\n\n        # 3. Compute the Atom Fraction Excess (AFE)\n        afe = delta_rho / k_constant\n\n        # 4. Handle non-physical negative AFE values\n        if afe  0:\n            afe = 0.0\n\n        # Append the formatted result\n        results.append(f\"{afe:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2533985"}, {"introduction": "现实世界中的样品很少是完全纯净的，实验过程中的污染是常见问题。这个高级练习将带你处理一个典型挑战：背景碳污染，它可能严重影响结果的准确性。你将学习如何通过质量平衡计算来校正测量数据，同时练习在不同同位素表达方式（如同位素比值 $R$ 与千分差 $\\delta$ 值）之间进行转换，这是阅读和发表同位素生态学领域研究的必备技能。[@problem_id:2534040]", "problem": "一项土壤微宇宙实验实施了稳定同位素探针（SIP）技术，使用均匀标记的 $^{13}\\mathrm{C}$-碳酸氢盐来追踪自养碳同化进入微生物脱氧核糖核酸（DNA）的过程。经过氯化铯密度梯度超速离心后，收集重DNA组分，并用同位素比值质谱法（IRMS）进行分析。IRMS报告称，总提取物（微生物DNA加上来自提取试剂盒的微量碳污染）测得的 $^{13}\\mathrm{C}/^{12}\\mathrm{C}$ 同位素比值为 $R_{\\mathrm{obs}} = 0.012400$。碳质量平衡表明，该提取物含有 $M_{\\mathrm{DNA}} = 20.0\\,\\mu\\mathrm{g}$ 的微生物DNA碳和 $M_{\\mathrm{bkg}} = 2.00\\,\\mu\\mathrm{g}$ 来自试剂盒的背景碳。背景碳的同位素组成为 $\\delta^{13}\\mathrm{C}_{\\mathrm{bkg}} = -25.0$ ‰（千分率），该值是相对于国际标准维也纳Pee Dee Belemnite（VPDB）而言的。VPDB的 $^{13}\\mathrm{C}/^{12}\\mathrm{C}$ 比值为 $R_{\\mathrm{VPDB}} = 0.0111802$（无量纲）。\n\n仅使用同位素比值、原子分数和相对于VPDB的同位素δ值标记法的基本定义，首先对总体测量值进行背景碳校正，以求得微生物DNA的真实同位素比值 $R_{\\mathrm{DNA}}$。然后，将 $R_{\\mathrm{DNA}}$ 转换为相对于VPDB的 $\\delta^{13}\\mathrm{C}_{\\mathrm{DNA}}$ 并报告其值。最后，在稳定同位素探针的背景下，解释正的 $\\delta^{13}\\mathrm{C}$ 值对于 $^{13}\\mathrm{C}$ 标记掺入DNA中意味着什么。\n\n说明：\n- 在混合计算中，将碳质量视为与碳原子总数成正比。\n- 将最终的 $\\delta^{13}\\mathrm{C}_{\\mathrm{DNA}}$ 值四舍五入至4位有效数字。\n- 以千分率（‰）表示最终的 $\\delta^{13}\\mathrm{C}_{\\mathrm{DNA}}$。", "solution": "所提出的问题是同位素地球化学中的一个标准反卷积任务，特别是在微生物生态学中稳定同位素探针（SIP）的背景下。这个问题有科学依据，是良定的，并包含了获得唯一解所需的所有信息。因此，我们开始进行分析。\n\n问题的核心在于对一个总样品的测量同位素比值进行已知污染物的校正。总样品（总碳质量为 $M_{\\mathrm{obs}}$）是目标样品（即微生物DNA，碳质量为 $M_{\\mathrm{DNA}}$）和背景污染物（碳质量为 $M_{\\mathrm{bkg}}$）的混合物。总质量守恒：\n$$M_{\\mathrm{obs}} = M_{\\mathrm{DNA}} + M_{\\mathrm{bkg}}$$\n已知 $M_{\\mathrm{DNA}} = 20.0\\,\\mu\\mathrm{g}$ 和 $M_{\\mathrm{bkg}} = 2.00\\,\\mu\\mathrm{g}$，总碳质量为：\n$$M_{\\mathrm{obs}} = 20.0\\,\\mu\\mathrm{g} + 2.00\\,\\mu\\mathrm{g} = 22.0\\,\\mu\\mathrm{g}$$\n\n同位素混合的基本原理是每种同位素的原子总数是守恒的。同位素比值（$R = {}^{13}\\mathrm{C}/{}^{12}\\mathrm{C}$）和δ值（$\\delta^{13}\\mathrm{C}$）不是守恒量，它们不进行线性混合。线性混合的守恒量是原子分数 $F^{13}$，定义为 ${}^{13}\\mathrm{C}$ 原子数除以总碳原子数。原子分数 $F^{13}$ 与同位素比值 $R$ 之间的关系由以下精确表达式给出：\n$$F^{13} = \\frac{R}{1 + R}$$\n问题陈述我们可以将碳质量视为与碳原子总数成正比。因此，各组分的质量分数等于它们的摩尔分数。DNA（$x_{\\mathrm{DNA}}$）和背景（$x_{\\mathrm{bkg}}$）的质量分数为：\n$$x_{\\mathrm{DNA}} = \\frac{M_{\\mathrm{DNA}}}{M_{\\mathrm{obs}}} = \\frac{20.0}{22.0} = \\frac{10}{11}$$\n$$x_{\\mathrm{bkg}} = \\frac{M_{\\mathrm{bkg}}}{M_{\\mathrm{obs}}} = \\frac{2.00}{22.0} = \\frac{1}{11}$$\n${}^{13}\\mathrm{C}$ 原子分数的混合方程为：\n$$F^{13}_{\\mathrm{obs}} = x_{\\mathrm{DNA}} F^{13}_{\\mathrm{DNA}} + x_{\\mathrm{bkg}} F^{13}_{\\mathrm{bkg}}$$\n我们的目标是求出纯DNA的同位素组成，这可以通过首先求解 $F^{13}_{\\mathrm{DNA}}$ 来获得：\n$$F^{13}_{\\mathrm{DNA}} = \\frac{F^{13}_{\\mathrm{obs}} - x_{\\mathrm{bkg}} F^{13}_{\\mathrm{bkg}}}{x_{\\mathrm{DNA}}}$$\n\n为了解这个方程，我们必须首先根据所提供的数据计算观测总样品（$F^{13}_{\\mathrm{obs}}$）和背景污染物（$F^{13}_{\\mathrm{bkg}}$）的原子分数。\n\n1.  从 $R_{\\mathrm{obs}} = 0.012400$ 计算 $F^{13}_{\\mathrm{obs}}$：\n    $$F^{13}_{\\mathrm{obs}} = \\frac{R_{\\mathrm{obs}}}{1 + R_{\\mathrm{obs}}} = \\frac{0.012400}{1 + 0.012400} = \\frac{0.012400}{1.012400} \\approx 0.012248123$$\n\n2.  计算 $F^{13}_{\\mathrm{bkg}}$。首先，我们必须从其δ值 $\\delta^{13}\\mathrm{C}_{\\mathrm{bkg}} = -25.0$ ‰（千分率）求出同位素比值 $R_{\\mathrm{bkg}}$。δ值标记法是相对于VPDB标准 $R_{\\mathrm{VPDB}} = 0.0111802$ 定义的，如下所示：\n    $$\\delta^{13}\\mathrm{C} = \\left( \\frac{R_{\\mathrm{sample}}}{R_{\\mathrm{VPDB}}} - 1 \\right) \\times 1000$$\n    求解 $R_{\\mathrm{bkg}}$：\n    $$R_{\\mathrm{bkg}} = R_{\\mathrm{VPDB}} \\left(1 + \\frac{\\delta^{13}\\mathrm{C}_{\\mathrm{bkg}}}{1000}\\right) = 0.0111802 \\left(1 + \\frac{-25.0}{1000}\\right) = 0.0111802 \\times 0.975 = 0.010900695$$\n    现在，我们将 $R_{\\mathrm{bkg}}$ 转换为其对应的原子分数 $F^{13}_{\\mathrm{bkg}}$：\n    $$F^{13}_{\\mathrm{bkg}} = \\frac{R_{\\mathrm{bkg}}}{1 + R_{\\mathrm{bkg}}} = \\frac{0.010900695}{1.010900695} \\approx 0.010782130$$\n\n现在我们将这些值代入整理后的混合方程，求出 $F^{13}_{\\mathrm{DNA}}$：\n$$F^{13}_{\\mathrm{DNA}} = \\frac{0.012248123 - \\left(\\frac{1}{11}\\right) \\times 0.010782130}{\\frac{10}{11}}$$\n为避免过早的舍入误差，我们先计算分子：\n$$0.012248123 - \\frac{0.010782130}{11} = 0.012248123 - 0.0009801936 = 0.0112679294$$\n然后我们除以质量分数 $x_{\\mathrm{DNA}}$：\n$$F^{13}_{\\mathrm{DNA}} = \\frac{0.0112679294}{10/11} = 0.0112679294 \\times 1.1 = 0.012394722$$\n\n任务的第一部分是求出DNA的真实同位素比值 $R_{\\mathrm{DNA}}$。我们使用反向关系 $R = \\frac{F}{1-F}$ 将 $F^{13}_{\\mathrm{DNA}}$ 转换回 $R_{\\mathrm{DNA}}$：\n$$R_{\\mathrm{DNA}} = \\frac{F^{13}_{\\mathrm{DNA}}}{1 - F^{13}_{\\mathrm{DNA}}} = \\frac{0.012394722}{1 - 0.012394722} = \\frac{0.012394722}{0.987605278} \\approx 0.01255026$$\n\n任务的第二部分是将 $R_{\\mathrm{DNA}}$ 转换为δ值表示法 $\\delta^{13}\\mathrm{C}_{\\mathrm{DNA}}$，并四舍五入到4位有效数字：\n$$\\delta^{13}\\mathrm{C}_{\\mathrm{DNA}} = \\left( \\frac{R_{\\mathrm{DNA}}}{R_{\\mathrm{VPDB}}} - 1 \\right) \\times 1000 = \\left( \\frac{0.01255026}{0.0111802} - 1 \\right) \\times 1000$$\n$$\\delta^{13}\\mathrm{C}_{\\mathrm{DNA}} = \\left( 1.122541 - 1 \\right) \\times 1000 = 0.122541 \\times 1000 = 122.541\\,\\text{‰}$$\n将此结果四舍五入到4位有效数字，得到 $122.5$\\,‰。\n\n最后，问题要求对该结果进行解释。正的 $\\delta^{13}\\mathrm{C}$ 值表示样品相对于VPDB标准富集了重同位素 ${}^{13}\\mathrm{C}$。由于碳固定过程中的动力学同位素效应会优先选择较轻的 ${}^{12}\\mathrm{C}$ 同位素，天然生物材料通常表现出负的 $\\delta^{13}\\mathrm{C}$ 值。计算得出的 $\\delta^{13}\\mathrm{C}_{\\mathrm{DNA}} = +122.5$\\,‰ 值非常高，远超自然同位素变化的范围。这种强烈的富集是来自SIP实验的明确证据，表明提取DNA的微生物已经主动同化了微宇宙中提供的 $^{13}\\mathrm{C}$-标记的碳酸氢盐。由于碳酸氢盐是一种无机碳源，这一结果明确证明了自养活动——即活跃的微生物种群将无机碳固定到其生物质（并因此进入DNA）中。", "answer": "$$\\boxed{122.5}$$", "id": "2534040"}]}