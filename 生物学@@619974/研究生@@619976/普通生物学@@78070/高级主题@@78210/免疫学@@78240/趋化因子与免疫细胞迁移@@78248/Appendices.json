{"hands_on_practices": [{"introduction": "趋化因子引导的细胞迁移始于信号分子在组织中的扩散。通过应用物理化学的基本原理，我们可以估算趋化因子的扩散速率，这是理解趋化因子梯度如何形成和维持的关键第一步。这个练习将引导你使用著名的斯托克斯-爱因斯坦关系，将趋化因子的分子量等微观属性与其在生理环境中的宏观扩散行为联系起来 [@problem_id:2784794]。", "problem": "一种分子量为 $10~\\mathrm{kDa}$ 的可溶性趋化因子在生理温度下被分泌到粘度为 $\\eta = 1.5 \\times 10^{-3}~\\mathrm{Pa\\cdot s}$ 的组织间液中。将该单体建模为一个密度均匀的致密球体，蛋白质密度为 $\\rho_p = 1.35~\\mathrm{g\\cdot cm^{-3}}$，并通过将其体积等同于球体体积来估算其流体力学半径 $R_H$。然后使用布朗运动的斯托克斯-爱因斯坦 (Stokes–Einstein, SE) 关系计算其在组织间隙中的扩散系数 $D$。取绝对温度 $T = 310~\\mathrm{K}$，玻尔兹曼常数 $k_B = 1.380649 \\times 10^{-23}~\\mathrm{J\\cdot K^{-1}}$，阿伏伽德罗常数 ($N_A$) $6.02214076 \\times 10^{23}~\\mathrm{mol^{-1}}$。在本次估算中，假设流体力学半径等于几何半径。在你的推理中，定性地解释非共价二聚化（两个单体缔合成一个密度相同的致密二聚体）预计会如何改变 $D$ 的估算值，但最终数值结果只报告单体的 $D$。\n\n以 $\\mathrm{m^2\\cdot s^{-1}}$ 为单位表示单体的最终扩散系数，并将答案四舍五入到三位有效数字。", "solution": "该问题陈述清晰，科学上合理，基于物理化学和生物学原理。它提供了所有必要的信息和常数，以便基于简化的球形模型计算蛋白质单体的扩散系数。\n\n解决此问题的逻辑步骤如下：\n首先，我们确定单个趋化因子单体的质量。\n其次，使用给定的蛋白质密度，我们计算该单体的体积。\n第三，通过将单体建模为球体，我们确定其几何半径，并假设该半径等于其流体力学半径 $R_H$。\n第四，我们应用斯托克斯-爱因斯坦关系计算扩散系数 $D$。\n最后，我们对二聚化对 $D$ 的影响进行定性分析。\n\n为确保一致性，所有计算必须使用国际单位制 (SI) 单位进行。\n\n步骤1：计算单个单体的质量 $m$。\n给定的分子量为 $10~\\mathrm{kDa}$，对应的摩尔质量 $M_{molar}$ 为 $10 \\times 10^3~\\mathrm{g\\cdot mol^{-1}}$，在国际单位制中为 $10~\\mathrm{kg\\cdot mol^{-1}}$。\n单个分子的质量 $m$ 是摩尔质量除以阿伏伽德罗常数 $N_A$。\n$$m = \\frac{M_{molar}}{N_A}$$\n使用所提供的值：\n$$m = \\frac{10~\\mathrm{kg\\cdot mol^{-1}}}{6.02214076 \\times 10^{23}~\\mathrm{mol^{-1}}}$$\n\n步骤2：计算单体的体积 $V$。\n单体的体积是其质量除以其密度 $\\rho_p$。我们必须首先将密度从 $\\mathrm{g\\cdot cm^{-3}}$ 转换为 $\\mathrm{kg\\cdot m^{-3}}$。\n$\\rho_p = 1.35~\\mathrm{g\\cdot cm^{-3}} = 1.35 \\times \\frac{10^{-3}~\\mathrm{kg}}{(10^{-2}~\\mathrm{m})^3} = 1.35 \\times \\frac{10^{-3}}{10^{-6}}~\\mathrm{kg\\cdot m^{-3}} = 1.35 \\times 10^3~\\mathrm{kg\\cdot m^{-3}}$。\n体积 $V$ 为：\n$$V = \\frac{m}{\\rho_p} = \\frac{M_{molar}}{N_A \\rho_p}$$\n\n步骤3：计算流体力学半径 $R_H$。\n问题要求将单体建模为球体，并假设流体力学半径 $R_H$ 等于几何半径 $R$。球体的体积为 $V = \\frac{4}{3}\\pi R^3$。\n通过令两个体积表达式相等，我们可以解出半径 $R$。\n$$\\frac{4}{3}\\pi R^3 = \\frac{M_{molar}}{N_A \\rho_p}$$\n$$R^3 = \\frac{3 M_{molar}}{4\\pi N_A \\rho_p}$$\n因此，流体力学半径 $R_H$ 是：\n$$R_H = R = \\left( \\frac{3 M_{molar}}{4\\pi N_A \\rho_p} \\right)^{1/3}$$\n代入国际单位制下的数值：\n$$R_H = \\left( \\frac{3 \\times 10~\\mathrm{kg\\cdot mol^{-1}}}{4\\pi (6.02214076 \\times 10^{23}~\\mathrm{mol^{-1}})(1.35 \\times 10^3~\\mathrm{kg\\cdot m^{-3}})} \\right)^{1/3}$$\n$$R_H = \\left( \\frac{30}{4\\pi (6.02214076 \\times 1.35) \\times 10^{26}} \\right)^{1/3} \\approx \\left( \\frac{30}{1.0218 \\times 10^{28}} \\right)^{1/3}$$\n$$R_H \\approx (2.936 \\times 10^{-27}~\\mathrm{m^3})^{1/3} \\approx 1.432 \\times 10^{-9}~\\mathrm{m}$$\n\n步骤4：计算扩散系数 $D$。\n球形粒子在流体中的扩散系数 $D$ 的斯托克斯-爱因斯坦关系式为：\n$$D = \\frac{k_B T}{6\\pi \\eta R_H}$$\n其中，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，$\\eta$ 是流体的动力粘度。\n我们已知：\n$k_B = 1.380649 \\times 10^{-23}~\\mathrm{J\\cdot K^{-1}}$\n$T = 310~\\mathrm{K}$\n$\\eta = 1.5 \\times 10^{-3}~\\mathrm{Pa\\cdot s} = 1.5 \\times 10^{-3}~\\mathrm{kg\\cdot m^{-1}\\cdot s^{-1}}$\n代入这些值和计算出的 $R_H$：\n$$D = \\frac{(1.380649 \\times 10^{-23}~\\mathrm{J\\cdot K^{-1}})(310~\\mathrm{K})}{6\\pi (1.5 \\times 10^{-3}~\\mathrm{kg\\cdot m^{-1}\\cdot s^{-1}})(1.432 \\times 10^{-9}~\\mathrm{m})}$$\n$$D \\approx \\frac{4.280 \\times 10^{-21}~\\mathrm{J}}{4.048 \\times 10^{-11}~\\mathrm{kg\\cdot s^{-1}}}$$\n单位是一致的，因为 $1~\\mathrm{J} = 1~\\mathrm{kg\\cdot m^2\\cdot s^{-2}}$，所以 $\\mathrm{J / (kg\\cdot s^{-1})} = \\mathrm{m^2\\cdot s^{-1}}$。\n$$D \\approx 1.057 \\times 10^{-10}~\\mathrm{m^2\\cdot s^{-1}}$$\n按要求四舍五入到三位有效数字，扩散系数为 $1.06 \\times 10^{-10}~\\mathrm{m^2\\cdot s^{-1}}$。\n\n二聚化的定性分析：\n如果两个单体缔合成一个致密的二聚体，二聚体的质量 $m_d$ 将是单体质量 $m_m$ 的两倍：$m_d = 2m_m$。假设密度 $\\rho_p$ 保持不变，二聚体的体积 $V_d$ 也将是单体体积 $V_m$ 的两倍：$V_d = 2V_m$。\n球形粒子的半径与其体积的关系为 $R \\propto V^{1/3}$。因此，二聚体的半径 $R_d$ 与单体半径 $R_m$ 的关系如下：\n$$R_d \\propto V_d^{1/3} = (2V_m)^{1/3} = 2^{1/3} V_m^{1/3} \\propto 2^{1/3} R_m$$\n因此，$R_d = 2^{1/3} R_m$。\n斯托克斯-爱因斯坦方程表明，扩散系数与半径成反比：$D \\propto 1/R_H$。假设两种物质的流体力学半径都与其几何半径成正比，则二聚体的扩散系数 $D_d$ 将为：\n$$D_d \\propto \\frac{1}{R_d} = \\frac{1}{2^{1/3} R_m} \\propto \\frac{1}{2^{1/3}} D_m$$\n因此，二聚化会使扩散系数减小一个因子 $2^{1/3} \\approx 1.26$。较大的粒子扩散得更慢，这是一个预期的结果。", "answer": "$$\\boxed{1.06 \\times 10^{-10}}$$", "id": "2784794"}, {"introduction": "在真实的生理环境中，免疫细胞常常同时暴露在多种趋化因子信号中，它们必须对这些有时相互竞争的信号做出“决策”。这个练习探讨了细胞如何通过受体-配体结合动力学的微妙差异来区分和优先响应特定信号。你将超越简单的受体占有率计算，深入到趋化性“灵敏度”这一核心概念，从而理解细胞如何在复杂的信号网络中做出精确的定向迁移决策 [@problem_id:2784813]。", "problem": "一个游走性白细胞共表达 C-X-C 基序趋化因子受体 4 (CXCR4) 和 C-C 趋化因子受体 5 型 (CCR5)。它在胞外浓度为 $5\\,\\mathrm{nM}$ 的环境中遇到 C-X-C 基序趋化因子配体 12 (CXCL12)，并在胞外浓度为 $20\\,\\mathrm{nM}$ 的环境中遇到 C-C 基序趋化因子配体 5 (CCL5)。解离常数分别为 $K_{d,\\mathrm{CXCL12\\text{--}CXCR4}} = 3\\,\\mathrm{nM}$ 和 $K_{d,\\mathrm{CCL5\\text{--}CCR5}} = 10\\,\\mathrm{nM}$。假设在平衡状态下，配体-受体为一对一结合，细胞上 CXCR4 和 CCR5 的总受体丰度相等，并且已占据的受体与下游趋化信号传导的偶联方式相同。\n\n您的推导只能使用以下基本事实和定义作为起点：对于一对一结合反应 $\\mathrm{R} + \\mathrm{L} \\rightleftharpoons \\mathrm{RL}$，在平衡状态下，解离常数满足 $K_{d} = \\dfrac{[\\mathrm{R}][\\mathrm{L}]}{[\\mathrm{RL}]}$，受体总浓度为 $[\\mathrm{R}]_{\\mathrm{T}} = [\\mathrm{R}] + [\\mathrm{RL}]$。分数占据率定义为处于配体结合状态的受体所占的比例。\n\n首先，在给定的胞外浓度下，计算 CXCL12 对 CXCR4 的分数占据率以及 CCL5 对 CCR5 的分数占据率。接着，为了预测在浅且可比的空间梯度中哪个轴向的定向迁移占主导地位，请围绕背景配体浓度对基于占据率的趋化信号进行线性化，并比较由此产生的灵敏度。将优势指数定义为\n$$\nD \\equiv \\frac{S_{\\mathrm{CXCL12\\text{--}CXCR4}}}{S_{\\mathrm{CCL5\\text{--}CCR5}}},\n$$\n其中 $S$ 表示在背景浓度下，分数占据率对配体浓度微小变化的线性化灵敏度。将最终的优势指数 $D$ 表示为一个无量纲小数，并四舍五入到四位有效数字。", "solution": "该问题经过验证，被认为是具有科学依据、适定且客观的。它基于受体-配体结合动力学的标准原理，不包含任何矛盾或缺陷。因此，有必要提供完整的解题过程。\n\n该问题要求比较两个并行的趋化因子-受体系统的趋化灵敏度：C-X-C 基序趋化因子配体 12 (CXCL12) 与 C-X-C 基序趋化因子受体 4 (CXCR4) 的结合，以及 C-C 基序趋化因子配体 5 (CCL5) 与 C-C 趋化因子受体 5 型 (CCR5) 的结合。我们将 CXCL12-CXCR4 系统指定为系统 $1$，将 CCL5-CCR5 系统指定为系统 $2$。\n\n该分析的基础是受体的分数占据率 $\\theta$。对于一对一结合反应 $\\mathrm{R} + \\mathrm{L} \\rightleftharpoons \\mathrm{RL}$，在平衡状态下，解离常数 $K_d$ 由下式给出：\n$$K_{d} = \\frac{[\\mathrm{R}][\\mathrm{L}]}{[\\mathrm{RL}]}$$\n受体总浓度 $[\\mathrm{R}]_{\\mathrm{T}}$ 是游离受体 $[\\mathrm{R}]$ 和配体结合受体 $[\\mathrm{RL}]$ 的总和：\n$$[\\mathrm{R}]_{\\mathrm{T}} = [\\mathrm{R}] + [\\mathrm{RL}]$$\n根据第二个关系式，我们将游离受体浓度表示为 $[\\mathrm{R}] = [\\mathrm{R}]_{\\mathrm{T}} - [\\mathrm{RL}]$。将其代入 $K_d$ 的方程中：\n$$K_d = \\frac{([\\mathrm{R}]_{\\mathrm{T}} - [\\mathrm{RL}])[\\mathrm{L}]}{[\\mathrm{RL}]}$$\n我们重排该表达式以求解分数占据率 $\\theta = \\frac{[\\mathrm{RL}]}{[\\mathrm{R}]_{\\mathrm{T}}}$。\n$$K_d [\\mathrm{RL}] = ([\\mathrm{R}]_{\\mathrm{T}} - [\\mathrm{RL}])[\\mathrm{L}] = [\\mathrm{R}]_{\\mathrm{T}}[\\mathrm{L}] - [\\mathrm{RL}][\\mathrm{L}]$$\n$$[\\mathrm{RL}](K_d + [\\mathrm{L}]) = [\\mathrm{R}]_{\\mathrm{T}}[\\mathrm{L}]$$\n$$\\theta([\\mathrm{L}]) = \\frac{[\\mathrm{RL}]}{[\\mathrm{R}]_{\\mathrm{T}}} = \\frac{[\\mathrm{L}]}{K_d + [\\mathrm{L}]}$$\n这就是著名的 Langmuir-Hill 方程，其中 Hill 系数为 $1$。\n\n第一个任务是使用给定的浓度和解离常数计算两个系统的分数占据率。\n\n对于系统 $1$ (CXCL12-CXCR4):\n配体浓度 $[\\mathrm{L}_1] = 5\\,\\mathrm{nM}$\n解离常数 $K_{d,1} = 3\\,\\mathrm{nM}$\n分数占据率 $\\theta_1$ 为：\n$$\\theta_1 = \\frac{[\\mathrm{L}_1]}{K_{d,1} + [\\mathrm{L}_1]} = \\frac{5}{3 + 5} = \\frac{5}{8}$$\n\n对于系统 $2$ (CCL5-CCR5):\n配体浓度 $[\\mathrm{L}_2] = 20\\,\\mathrm{nM}$\n解离常数 $K_{d,2} = 10\\,\\mathrm{nM}$\n分数占据率 $\\theta_2$ 为：\n$$\\theta_2 = \\frac{[\\mathrm{L}_2]}{K_{d,2} + [\\mathrm{L}_2]} = \\frac{20}{10 + 20} = \\frac{20}{30} = \\frac{2}{3}$$\n\n第二个任务是比较线性化灵敏度。趋化信号被假定为与已占据受体的数量成正比。根据总受体丰度相等和下游偶联方式相同的假设，总信号强度与分数占据率 $\\theta$ 直接成正比。因此，对配体浓度微小变化的灵敏度是分数占据率对配体浓度的的一阶导数，即 $\\frac{d\\theta}{d[\\mathrm{L}]}$。\n\n我们将灵敏度 $S$ 定义为：\n$$S([\\mathrm{L}]) = \\frac{d\\theta}{d[\\mathrm{L}]} = \\frac{d}{d[\\mathrm{L}]}\\left(\\frac{[\\mathrm{L}]}{K_d + [\\mathrm{L}]}\\right)$$\n使用导数的商法则，我们得到：\n$$S([\\mathrm{L}]) = \\frac{(1)(K_d + [\\mathrm{L}]) - ([\\mathrm{L}])(1)}{(K_d + [\\mathrm{L}])^2} = \\frac{K_d}{(K_d + [\\mathrm{L}])^2}$$\n\n现在我们计算每个系统在其各自背景配体浓度下的灵敏度。\n\n对于系统 $1$：\n$$S_1 = S_{\\mathrm{CXCL12\\text{--}CXCR4}} = \\frac{K_{d,1}}{(K_{d,1} + [\\mathrm{L}_1])^2} = \\frac{3}{(3 + 5)^2} = \\frac{3}{8^2} = \\frac{3}{64}\\,\\mathrm{nM}^{-1}$$\n\n对于系统 $2$：\n$$S_2 = S_{\\mathrm{CCL5\\text{--}CCR5}} = \\frac{K_{d,2}}{(K_{d,2} + [\\mathrm{L}_2])^2} = \\frac{10}{(10 + 20)^2} = \\frac{10}{30^2} = \\frac{10}{900} = \\frac{1}{90}\\,\\mathrm{nM}^{-1}$$\n\n最后一步是计算优势指数 $D$，它被定义为两个灵敏度的比值。\n$$D = \\frac{S_1}{S_2} = \\frac{\\frac{3}{64}\\,\\mathrm{nM}^{-1}}{\\frac{1}{90}\\,\\mathrm{nM}^{-1}} = \\frac{3}{64} \\times 90 = \\frac{270}{64}$$\n此分数为无量纲，符合要求。化简该分数：\n$$D = \\frac{135}{32}$$\n将此精确分数转换为小数值：\n$$D = 135 \\div 32 = 4.21875$$\n问题要求将此结果四舍五入到四位有效数字。\n$$D \\approx 4.219$$\n该结果表明，在指定条件下，白细胞对 CXCL12 的微小梯度的趋化反应强度是对 CCL5 等效梯度的趋化反应强度的四倍多。", "answer": "$$\\boxed{4.219}$$", "id": "2784813"}, {"introduction": "细胞对趋化因子的响应能力是动态变化的，这主要通过调控细胞表面受体的数量来实现。受体在被配体激活后会经历内化和再循环的过程，这对于细胞适应环境信号和维持定向迁移至关重要。在这个实践中，你将构建一个基于微分方程的动力学模型来描述受体运输过程，并利用计算方法将模型与模拟的实验数据进行拟合，从而估算出内化和再循环的关键速率常数。这项练习完美地结合了理论建模与数据分析，是现代定量生物学研究中的一项核心技能 [@problem_id:2784839]。", "problem": "您的任务是估算控制免疫细胞上趋化因子受体运输的动力学速率常数。在 C-X-C 基序趋化因子配体 12 (CXCL12) 的作用下，C-X-C 趋化因子受体 4 型 (CXCR4) 会经历配体触发的从质膜开始的内吞作用（内化），并随后再循环回细胞表面。假设一个经典的双室受体运输模型，包含一个表面池和一个内部池，在恒定配体暴露下受一级动力学控制。\n\n基本假设和定义：\n- 令 $S(t)$ 表示在时间 $t$ 时细胞表面受体相对于基线（因此通过归一化处理后 $S(0) = 1$）的分数，令 $I(t)$ 表示在时间 $t$ 时内化的分数。当合成和降解在实验时间尺度上可以忽略不计时，质量守恒意味着对于所有 $t \\ge 0$ 都有 $S(t) + I(t) = 1$。\n- 令 $k_{\\text{int}}$ 表示内化速率常数，令 $k_{\\text{rec}}$ 表示再循环速率常数。$k_{\\text{int}}$ 和 $k_{\\text{rec}}$ 均为非负数，单位为 $\\text{min}^{-1}$。\n- 该机理模型是一个双室系统，具有从表面池到内部池以及返回的一级通量。该模型由常微分方程 (ODE) 及其质量守恒约束和初始条件指定。目标是根据 $S(t)$ 的时程测量数据来估算 $k_{\\text{int}}$ 和 $k_{\\text{rec}}$。\n\n您的程序必须实现一个估算器，对于每个提供的数据集，通过最小化模型预测的 $S(t)$ 与观测到的 $S(t)$ 之间的残差平方和，将双室模型与观测数据进行拟合，同时满足约束条件 $k_{\\text{int}} \\ge 0$ 和 $k_{\\text{rec}} \\ge 0$。所有时间单位均为分钟，所有速率常数必须以 $\\text{min}^{-1}$ 为单位报告。所有最终估算的速率常数表示为四舍五入到六位小数。\n\n测试套件：\n对于下面的每个数据集，给定时间向量 $t$（单位为分钟）和相应的测量表面分数 $S_{\\text{obs}}(t)$（无单位，归一化为 $S(0) = 1$）。使用这些数据估算 $k_{\\text{int}}$ 和 $k_{\\text{rec}}$。\n\n- 数据集 1 (典型的内化与部分再循环)：\n  - $t = [0, 5, 10, 15, 20, 30, 45, 60]$\n  - $S_{\\text{obs}}(t) = [1.000000, 0.352608, 0.208156, 0.175924, 0.168732, 0.166770, 0.166668, 0.166667]$\n\n- 数据集 2 (快速内化与快速再循环)：\n  - $t = [0.0, 0.5, 1.0, 2.0, 3.0, 5.0, 10.0]$\n  - $S_{\\text{obs}}(t) = [1.000000, 0.718595, 0.585669, 0.493220, 0.472591, 0.466962, 0.466667]$\n\n- 数据集 3 (慢速内化与慢速再循环)：\n  - $t = [0, 20, 40, 60, 80, 100, 120]$\n  - $S_{\\text{obs}}(t) = [1.000000, 0.699208, 0.534129, 0.443533, 0.393812, 0.366525, 0.351549]$\n\n- 数据集 4 (在测量窗口内无明显可检测的再循环的内化)：\n  - $t = [0, 5, 10, 15, 20, 30]$\n  - $S_{\\text{obs}}(t) = [1.000000, 0.223130, 0.049787, 0.011109, 0.002479, 0.000123]$\n\n- 数据集 5 (平衡的内化与再循环)：\n  - $t = [0, 2, 4, 6, 8, 10]$\n  - $S_{\\text{obs}}(t) = [1.000000, 0.650597, 0.545359, 0.513662, 0.504115, 0.501239]$\n\n要求输出：\n- 对于每个数据集，返回估算出的参数对 $[\\,\\hat{k}_{\\text{int}}, \\hat{k}_{\\text{rec}}\\,]$，单位为 $\\text{min}^{-1}$，并四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含所有数据集的结果，聚合为由方括号括起来的、以逗号分隔的列表的列表。例如，一个有效的输出应类似于 $[\\,[\\,a,b\\,],[\\,c,d\\,],\\dots]$，其中每个符号是四舍五入到六位小数的十进制数值，单位为 $\\text{min}^{-1}$。", "solution": "所述问题具有科学依据，提法恰当且客观。它描述了一个经典的受体运输双室模型，这是细胞生物学中的一个基本概念，并要求使用数学建模和数值优化的标准方法进行参数估计。所有必要信息均已提供，问题是自洽且逻辑一致的。因此，我们可以进行严谨的求解。\n\n该系统由两个受体室组成：一个表面池，其分数为 $S(t)$，以及一个内部池，其分数为 $I(t)$。受体总数守恒，因此在初始条件 $S(0) = 1$ 和 $I(0) = 0$ 的情况下，对于所有时间 $t \\ge 0$，质量平衡方程为 $S(t) + I(t) = 1$。\n\n这些池之间的运输受一级动力学控制。表面受体分数的变率由从表面到内部池的内化通量和从内部池返回表面的再循环通量之间的平衡决定。这表示为一个一阶常微分方程 (ODE)：\n$$\n\\frac{dS}{dt} = -k_{\\text{int}} S(t) + k_{\\text{rec}} I(t)\n$$\n此处，$k_{\\text{int}}$ 和 $k_{\\text{rec}}$ 分别是内化和再循环的非负速率常数，单位为 $\\text{min}^{-1}$。\n\n为了求解 $S(t)$，我们将质量守恒约束 $I(t) = 1 - S(t)$ 代入 ODE：\n$$\n\\frac{dS}{dt} = -k_{\\text{int}} S(t) + k_{\\text{rec}} (1 - S(t))\n$$\n整理各项，我们得到一个线性一阶 ODE：\n$$\n\\frac{dS}{dt} + (k_{\\text{int}} + k_{\\text{rec}}) S(t) = k_{\\text{rec}}\n$$\n这个方程可以使用积分因子或通过识别其标准形式来求解。通解为：\n$$\nS(t) = \\frac{k_{\\text{rec}}}{k_{\\text{int}} + k_{\\text{rec}}} + C e^{-(k_{\\text{int}} + k_{\\text{rec}})t}\n$$\n其中 $C$ 是积分常数。我们使用初始条件 $S(0) = 1$ 来确定 $C$：\n$$\nS(0) = 1 = \\frac{k_{\\text{rec}}}{k_{\\text{int}} + k_{\\text{rec}}} + C\n$$\n$$\nC = 1 - \\frac{k_{\\text{rec}}}{k_{\\text{int}} + k_{\\text{rec}}} = \\frac{k_{\\text{int}} + k_{\\text{rec}} - k_{\\text{rec}}}{k_{\\text{int}} + k_{\\text{rec}}} = \\frac{k_{\\text{int}}}{k_{\\text{int}} + k_{\\text{rec}}}\n$$\n将 $C$ 代回通解，得到表面受体分数作为时间与动力学参数函数的显式解析解：\n$$\nS(t; k_{\\text{int}}, k_{\\text{rec}}) = \\frac{k_{\\text{rec}}}{k_{\\text{int}} + k_{\\text{rec}}} + \\frac{k_{\\text{int}}}{k_{\\text{int}} + k_{\\text{rec}}} e^{-(k_{\\text{int}} + k_{\\text{rec}})t}\n$$\n该方程构成了我们模型的基础。项 $\\frac{k_{\\text{rec}}}{k_{\\text{int}} + k_{\\text{rec}}}$ 代表了当 $t \\to \\infty$ 时，表面受体的稳态分数 $S_{\\infty}$。\n\n问题要求从给定的时程数据 $\\{t_i, S_{\\text{obs}, i}\\}$ 估算参数 $\\hat{k}_{\\text{int}}$ 和 $\\hat{k}_{\\text{rec}}$。这是一个参数估计任务，我们将把它表述为一个非线性最小二乘优化问题。目标是找到最小化模型预测值与实验观测值之间残差平方和 (SSR) 的 $k_{\\text{int}}$ 和 $k_{\\text{rec}}$ 的值：\n$$\n\\underset{k_{\\text{int}}, k_{\\text{rec}}}{\\text{minimize}} \\quad \\text{SSR}(k_{\\text{int}}, k_{\\text{rec}}) = \\sum_{i} (S(t_i; k_{\\text{int}}, k_{\\text{rec}}) - S_{\\text{obs}, i})^2\n$$\n此优化受制于速率常数不能为负的物理约束：\n$$\nk_{\\text{int}} \\ge 0, \\quad k_{\\text{rec}} \\ge 0\n$$\n这个约束优化问题将通过数值方法求解。实现将使用 SciPy 库中的 `scipy.optimize.minimize` 函数，特别是 L-BFGS-B 算法，该算法能有效处理箱式约束。对于每个数据集，定义一个计算 SSR 的目标函数，并针对参数 $(k_{\\text{int}}, k_{\\text{rec}})$ 进行最小化。得到的最优参数即为所求的估计值。模型函数 $S(t)$ 的数值稳定实现必须处理 $k_{\\text{int}} + k_{\\text{rec}} \\approx 0$ 的边缘情况，此时 $S(t) \\approx 1$。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Solves the receptor trafficking parameter estimation problem for all test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"t\": np.array([0, 5, 10, 15, 20, 30, 45, 60]),\n            \"S_obs\": np.array([1.000000, 0.352608, 0.208156, 0.175924, 0.168732, 0.166770, 0.166668, 0.166667]),\n        },\n        {\n            \"t\": np.array([0.0, 0.5, 1.0, 2.0, 3.0, 5.0, 10.0]),\n            \"S_obs\": np.array([1.000000, 0.718595, 0.585669, 0.493220, 0.472591, 0.466962, 0.466667]),\n        },\n        {\n            \"t\": np.array([0, 20, 40, 60, 80, 100, 120]),\n            \"S_obs\": np.array([1.000000, 0.699208, 0.534129, 0.443533, 0.393812, 0.366525, 0.351549]),\n        },\n        {\n            \"t\": np.array([0, 5, 10, 15, 20, 30]),\n            \"S_obs\": np.array([1.000000, 0.223130, 0.049787, 0.011109, 0.002479, 0.000123]),\n        },\n        {\n            \"t\": np.array([0, 2, 4, 6, 8, 10]),\n            \"S_obs\": np.array([1.000000, 0.650597, 0.545359, 0.513662, 0.504115, 0.501239]),\n        },\n    ]\n\n    def model_S(t, k_int, k_rec):\n        \"\"\"\n        Calculates the theoretical surface receptor fraction S(t) based on the two-compartment model.\n        Args:\n            t (np.ndarray): Time points.\n            k_int (float): Internalization rate constant.\n            k_rec (float): Recycling rate constant.\n        Returns:\n            np.ndarray: Predicted S(t) values.\n        \"\"\"\n        k_sum = k_int + k_rec\n        \n        # Handle the edge case where k_sum is close to zero to avoid division by zero.\n        # If both rates are zero, no change occurs, so S(t) remains 1.\n        if k_sum  1e-9:\n            return np.ones_like(t)\n        \n        s_infinity = k_rec / k_sum\n        transient_term_coeff = k_int / k_sum\n        \n        return s_infinity + transient_term_coeff * np.exp(-k_sum * t)\n\n    def objective_func(params, t_data, s_data):\n        \"\"\"\n        Objective function for least-squares fitting (Sum of Squared Residuals).\n        Args:\n            params (list or np.ndarray): A list containing [k_int, k_rec].\n            t_data (np.ndarray): The time points of the observations.\n            s_data (np.ndarray): The observed S(t) values.\n        Returns:\n            float: The sum of squared residuals.\n        \"\"\"\n        k_int, k_rec = params\n        s_model = model_S(t_data, k_int, k_rec)\n        return np.sum((s_model - s_data)**2)\n\n    results = []\n    for case in test_cases:\n        t_data = case[\"t\"]\n        s_data = case[\"S_obs\"]\n\n        # Provide a reasonable initial guess for the optimization.\n        # Estimate k_int from the initial drop.\n        if len(t_data) > 1 and t_data[1] > 0:\n            k_int_guess = (1.0 - s_data[1]) / t_data[1]\n        else:\n            k_int_guess = 0.1\n        k_int_guess = max(1e-6, k_int_guess) # Ensure positivity and non-zero.\n\n        # Estimate k_rec from the steady-state value.\n        s_inf_guess = s_data[-1]\n        if (1.0 - s_inf_guess)  1e-6:\n             k_rec_guess = 0.0\n        else:\n            k_rec_guess = k_int_guess * s_inf_guess / (1.0 - s_inf_guess)\n        k_rec_guess = max(0.0, k_rec_guess)\n\n        initial_guess = [k_int_guess, k_rec_guess]\n        \n        # Define non-negativity constraints for the rate constants.\n        bounds = [(0, None), (0, None)]\n\n        # Perform the optimization.\n        result = minimize(\n            objective_func,\n            initial_guess,\n            args=(t_data, s_data),\n            method='L-BFGS-B',\n            bounds=bounds,\n            options={'ftol': 1e-12, 'gtol': 1e-12} # Tighter tolerance for high-precision data\n        )\n        \n        k_int_hat, k_rec_hat = result.x\n        results.append([k_int_hat, k_rec_hat])\n\n    # Format the final output string as required.\n    formatted_results = []\n    for k_int_val, k_rec_val in results:\n        formatted_results.append(f\"[{k_int_val:.6f},{k_rec_val:.6f}]\")\n    \n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "2784839"}]}