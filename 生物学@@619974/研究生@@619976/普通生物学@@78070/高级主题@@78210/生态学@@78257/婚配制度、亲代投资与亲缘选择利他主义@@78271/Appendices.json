{"hands_on_practices": [{"introduction": "亲缘关系系数 $r$ 是亲缘选择理论的基石，它量化了两个个体因共同祖先而共享基因的概率。掌握其计算方法对于理解社会行为的演化至关重要。本练习 [@problem_id:2813967] 提供了使用路径计数法来确定二倍体系统中常见亲属间 $r$ 值的基本实践，这是分析家庭动态与合作行为的一项基础技能。", "problem": "在一个进行有性生殖的二倍体、常染色体系统中，同源共祖（identity by descent, IBD）是相对于一个由无亲缘关系、非近交的奠基者组成的群体来定义的。两个个体之间的亲缘系数，记作 $r(A,B)$，是个体 $A$ 在一个随机选择的常染色体基因座上的一个随机选择的等位基因与个体 $B$ 在同一基因座上的一个随机选择的等位基因同源共祖的概率。假设遵循以下基本原则：(i) 孟德尔分离定律，即每次减数分裂以概率 $\\frac{1}{2}$ 传递每个常染色体等位基因；(ii) 奠基者是远系繁殖且相互无亲缘关系，因此任何奠基祖先的近交系数 $F=0$；(iii) 基因座间独立分配，且常染色体没有性别特异性的传递偏倚。\n\n仅使用这些原则，并基于两个非近交个体间的任何IBD共享都必须能通过连接他们共同祖先的路径追溯这一逻辑，通过枚举并求和目标对之间所有不同最小系谱路径的贡献来计算 $r$，其中路径上的每一次减数分裂都贡献一个乘法因子 $\\frac{1}{2}$。\n\n在所述假设下，计算以下三种关系的 $r$ 值：\n- 全同胞（同父同母），\n- 半同胞（仅同母；父亲们彼此及与母亲均无亲缘关系），\n- 一代表亲（他们的父母是全同胞；无其他共同血缘，即不是二重表亲）。\n\n将最终答案以单行矩阵的形式表示为精确的有理数，顺序为 [全同胞, 半同胞, 一代表亲]。无需四舍五入，也不应包含单位。", "solution": "经判定，问题陈述有效。它在科学上基于孟德尔遗传学原理，问题设置得当，目标清晰且在数学上易于处理，并提供了所有必要的假设，如二倍性、常染色体遗传以及一个远系繁殖且无亲缘关系的奠基群体。解题方法已明确指定。我们将着手进行推导。\n\n问题要求计算成对个体间的亲缘系数 $r$。计算必须遵循路径分析法。对于两个非近交个体 $X$ 和 $Y$（其共同祖先也非近交），亲缘系数 $r(X,Y)$ 是连接它们的所有可能系谱路径的概率总和。每条路径必须从一个个体（比如 $X$）上溯至一个共同祖先 $A$，然后再下溯至另一个个体 $Y$。每条此类路径的贡献由 $(\\frac{1}{2})^n$ 给出，其中 $n$ 是路径中减数分裂步骤的总数。总亲缘系数是 $X$ 和 $Y$ 之间所有不同最小路径的这些贡献之和。\n\n$r(X,Y) = \\sum_{\\text{路径}} \\left(\\frac{1}{2}\\right)^n$\n\n我们将此程序应用于三种指定的关系。\n\n1.  **全同胞：**\n    设两个全同胞为 $S_1$ 和 $S_2$。他们共享两个共同祖先：他们的母亲（$M$）和父亲（$F$）。我们假设 $M$ 和 $F$ 无亲缘关系且非近交，这与问题的预设一致。\n    \n    *   **路径 1：** 通过母亲 $M$。路径为 $S_1 \\leftarrow M \\rightarrow S_2$。从 $M$ 到 $S_1$ 的减数分裂是一步。从 $M$ 到 $S_2$ 的减数分裂是第二步。总步数为 $n = 1 + 1 = 2$。此路径的贡献为 $(\\frac{1}{2})^2 = \\frac{1}{4}$。\n    *   **路径 2：** 通过父亲 $F$。路径为 $S_1 \\leftarrow F \\rightarrow S_2$。同样，步数为 $n = 1 + 1 = 2$。此路径的贡献为 $(\\frac{1}{2})^2 = \\frac{1}{4}$。\n    \n    总亲缘系数是这两条不同路径的贡献之和：\n    $$r_{\\text{全同胞}} = \\left(\\frac{1}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}$$\n\n2.  **半同胞：**\n    设两个半同胞为 $H_1$ 和 $H_2$。他们共享一个共同祖先，即他们的母亲（$M$）。他们的父亲 $F_1$ 和 $F_2$ 彼此无亲缘关系，也与 $M$ 无亲缘关系。\n    \n    *   **路径 1：** 通过母亲 $M$。路径为 $H_1 \\leftarrow M \\rightarrow H_2$。减数分裂的步数为 $n = 1 + 1 = 2$。此路径的贡献为 $(\\frac{1}{2})^2 = \\frac{1}{4}$。\n    \n    由于只有一个共同祖先，因此这是唯一的路径。总亲缘系数为：\n    $$r_{\\text{半同胞}} = \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4}$$\n\n3.  **一代表亲：**\n    设两个一代表亲为 $C_1$ 和 $C_2$。他们的父母是全同胞。设 $C_1$ 的亲本为 $P_1$，$C_2$ 的亲本为 $P_2$，其中 $P_1$ 和 $P_2$ 是同胞。$C_1$ 和 $C_2$ 的共同祖先是 $P_1$ 和 $P_2$ 的父母，我们称之为祖父母，$GM$（祖母）和 $GF$（祖父）。根据问题所述，没有其他共同血缘。\n    \n    *   **路径 1：** 通过祖母 $GM$。路径为 $C_1 \\leftarrow P_1 \\leftarrow GM \\rightarrow P_2 \\rightarrow C_2$。减数分裂的步数是从 $C_1$ 到 $GM$ 的代数（2步：$C_1 \\leftarrow P_1 \\leftarrow GM$）加上从 $GM$ 到 $C_2$ 的代数（2步：$GM \\rightarrow P_2 \\rightarrow C_2$）。总步数为 $n = 2 + 2 = 4$。此路径的贡献为 $(\\frac{1}{2})^4 = \\frac{1}{16}$。\n    *   **路径 2：** 通过祖父 $GF$。路径为 $C_1 \\leftarrow P_1 \\leftarrow GF \\rightarrow P_2 \\rightarrow C_2$。步数同样为 $n = 2 + 2 = 4$。此路径的贡献为 $(\\frac{1}{2})^4 = \\frac{1}{16}$。\n    \n    总亲缘系数是这两条路径的贡献之和：\n    $$r_{\\text{一代表亲}} = \\left(\\frac{1}{2}\\right)^4 + \\left(\\frac{1}{2}\\right)^4 = \\frac{1}{16} + \\frac{1}{16} = \\frac{2}{16} = \\frac{1}{8}$$\n\n计算出的亲缘系数分别为：全同胞 $\\frac{1}{2}$，半同胞 $\\frac{1}{4}$，一代表亲 $\\frac{1}{8}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2} & \\frac{1}{4} & \\frac{1}{8} \\end{pmatrix}}$$", "id": "2813967"}, {"introduction": "在理解了亲缘关系之后，我们现在可以将其应用于 W.D. Hamilton 的开创性法则，来预测社会演化的进程。这个实践问题 [@problem_id:2813994] 要求您使用不等式 $rb-c>0$ 来判断一种代价高昂的帮助行为是否会在群体中扩散。通过解决这个简单但功能强大的场景，您将对自然选择如何从广义适合度的角度权衡利他主义的成本和收益获得具体的理解。", "problem": "一个种群由二倍体个体组成，其中一个连续的、可加性的社会性状 $z$ 控制着针对单个主要受益者的、具有代价的帮助行为的概率和强度。考虑在一个常驻性状值为 $z=0$ 的种群中，一个稀有突变体使性状 $z$ 发生微小变化 $\\delta z$，因此一阶（线性）近似是适用的。根据亲缘选择中广义适合度的定义，由于微小的变化 $\\delta z$ 导致的行为者广义适合度的边际变化，等于 (i) 行为者的行为对其自身预期繁殖成功率的边际效应，与 (ii) 行为者的行为对受益者预期繁殖成功率的边际效应（由行为者和受益者之间的遗传相关系数 $r$ 加权）之和。假设对行为者的边际直接效应是每单位 $z$ 降低 $c$ 的速率，对受益者的边际效应是每单位 $z$ 增加 $b$ 的速率。您可以假设选择是弱的，并且处于稀有突变极限，因此性状 $z$ 的选择梯度的符号与广义适合度的边际效应的符号相匹配。\n\n给定 $r=0.5$，$b=2$ 和 $c=1.2$：\n1. 仅使用上述定义和 $z=0$ 附近的线性近似，判断利他行为（即正的 $\\delta z$）是否被选择所偏好。\n2. 在此线性近似下，计算选择梯度的大小。\n\n最终数值答案仅报告选择梯度的大小。无需四舍五入，也无需单位。", "solution": "对问题陈述进行验证。\n\n步骤 1：提取已知条件。\n- 种群由二倍体个体组成。\n- 一个连续的、可加性的社会性状用 $z$ 表示。\n- 问题考虑在一个常驻性状值为 $z=0$ 的种群中，一个稀有突变体使性状发生微小变化 $\\delta z$。\n- 陈述说明一阶（线性）近似是适用的。\n- 由于 $\\delta z$ 导致的行为者广义适合度的边际变化是两种效应之和：\n    - (i) 对行为者自身预期繁殖成功率的边际效应。\n    - (ii) 对受益者预期繁殖成功率的边际效应（由遗传相关系数 $r$ 加权）。\n- 对行为者的边际直接效应是每单位 $z$ 降低 $c$ 的速率。\n- 对受益者的边际效应是每单位 $z$ 增加 $b$ 的速率。\n- 假设：弱选择和稀有突变极限。\n- 在这些假设下，性状 $z$ 的选择梯度的符号与广义适合度的边际效应的符号相匹配。\n- 给定的参数值为：相关系数 $r=0.5$，对受益者的收益 $b=2$，以及对行为者的成本 $c=1.2$。\n- 任务是（1）判断利他行为（即正的 $\\delta z$）是否被偏好，以及（2）计算选择梯度的大小。最终答案应仅为选择梯度的大小。\n\n步骤 2：使用提取的已知条件进行验证。\n- 该问题具有科学依据。它提出了基于广义适合度和汉密尔顿法则的亲缘选择理论的标准表述，这些是演化生物学的基础原理。\n- 该问题提法明确。它提供了计算选择梯度的唯一、有意义的值所需的所有定义、参数和假设。\n- 该问题是客观的，使用了精确的定量语言，避免了任何主观或模糊的术语。\n- 该问题不违反任何无效性标准。它是社会演化理论的一个教科书式应用。\n\n步骤 3：结论与行动。\n- 该问题被视为有效。将提供解决方案。\n\n问题要求计算社会性状 $z$ 的选择梯度。根据问题定义，我们必须构建一个表达式，表示表现出性状变化 $\\delta z$ 的行为者的广义适合度的边际变化，我们将其记为 $\\delta W_{\\text{incl}}$。\n\n问题陈述指出，$\\delta W_{\\text{incl}}$ 是对行为者适合度的直接效应与对受益者适合度的间接效应（由其遗传相关性 $r$ 加权）之和。\n\n对行为者的边际直接效应是每单位性状 $z$ 降低速率 $c$。对于一个微小的变化 $\\delta z$，这对行为者适合度的效应由表达式 $-c \\delta z$ 给出。\n\n对受益者的边际效应是每单位性状 $z$ 增加速率 $b$。对于行为者性状的微小变化 $\\delta z$，对受益者适合度的效应是 $b \\delta z$。在计算广义适合度效应时，此效应由相关系数 $r$ 加权。因此，广义适合度变化的间接分量是 $r (b \\delta z)$。\n\n将这两个分量相加，得到广义适合度的总边际变化：\n$$\n\\delta W_{\\text{incl}} = -c \\delta z + r b \\delta z\n$$\n我们可以提出公因子 $\\delta z$：\n$$\n\\delta W_{\\text{incl}} = (rb - c) \\delta z\n$$\n问题陈述指出，一阶（线性）近似是适用的，并且性状 $z$ 的选择梯度的符号与此广义适合度的边际效应的符号相匹配。选择梯度（我们可记为 $S$）定义为适合度相对于性状的偏导数，在常驻性状值处求值。在这种线性近似中，选择梯度是乘以性状变化 $\\delta z$ 的系数：\n$$\nS = \\frac{\\partial W_{\\text{incl}}}{\\partial z} \\bigg|_{z=0} = rb - c\n$$\n这个表达式是汉密尔顿法则的核心。利他行为，定义为使他人受益但自身付出代价的行为（即，当 $c>0$ 和 $b>0$ 时，$\\delta z$ 为正），如果选择梯度 $S$ 为正，则会受到自然选择的偏好。一个正的 $S$ 意味着性状 $z$ 的增加会导致广义适合度的增加。\n\n首先，我们判断利他行为是否被偏好。我们将给定值 $r=0.5$，$b=2$ 和 $c=1.2$ 代入选择梯度 $S$ 的表达式中：\n$$\nS = (0.5)(2) - 1.2 = 1 - 1.2 = -0.2\n$$\n由于选择梯度 $S = -0.2$ 为负，选择将作用于降低性状 $z$ 的值。因此，在这些条件下，正向变化 $\\delta z > 0$（利他行为）不被偏好；它会受到选择的排斥。\n\n其次，我们计算选择梯度的大小。选择梯度为 $S = -0.2$。其大小为 $S$ 的绝对值：\n$$\n|S| = |-0.2| = 0.2\n$$\n这就是问题要求的最终数值。", "answer": "$$\n\\boxed{0.2}\n$$", "id": "2813994"}, {"introduction": "现实世界中的演化决策通常涉及在多个相互竞争的因素之间进行权衡。这个高级练习 [@problem_id:2813928] 超越了简单的利他主义，旨在为一个复杂而现实的场景建模：在父权不确定性下雄性亲代抚育的演化。您将运用最优化原理，根据父权的确信度和与未来繁殖机会的权衡，来确定雄性应如何调整其对后代的投入，这体现了边际分析在行为生态学中的强大威力。", "problem": "一种双亲物种表现出雄性亲代抚育，这与其未来的交配成功存在权衡取舍。设总亲代投入为雌性与雄性贡献之和，即 $I=I_{f}+I_{m}$。$B$个后代中每个后代存活至独立的机率是总投入的饱和函数，由 $S(I)=1-\\exp(-k I)$ 给出，其中 $k>0$ 是一个捕捉投入回报递减的常数。假设雌性投入固定量 $I_{f}$，且不受雄性决策的影响，而雄性选择 $I_{m}\\ge 0$ 以最大化其当前季节的广义适合度。雄性在当前季节其自身存活后代的期望数为 $p \\, B \\, S(I_{f}+I_{m})$，其中 $p\\in[0,1]$ 是它在该窝后代中的亲权份额。雄性抚育的机会成本会透过一个成本函数 $C_{m}(I_{m})$ 来减少雄性未来的期望后代数，其中 $C_{m}(0)=0$ 且当 $I_{m}\\ge 0$ 时 $C_{m}'(I_{m})>0$。假设为二倍体遗传，与自身后代的亲缘相关系数为 $r=\\tfrac{1}{2}$，并设雄性在没有抚育的情况下，其基线未来繁殖量为一个常数 $R_{0}$（与 $I_{m}$ 无关）。假设雄性会最大化其当前窝存活后代的期望数与其未来后代期望数的、经亲缘相关系数加权的总和，并保持所有其他因素不变。\n\n对于一个特定种群，假设以下参数值和函数成立：$B=6$，$I_{f}=3$，$k=0.4$，以及 $C_{m}(I_{m})=c\\, I_{m}$，其中 $c=0.25$。将 $R_{0}$ 视为一个不依赖于 $I_{m}$ 的任意正常数。在这些假设下，存在一个亲权阈值 $p^{\\ast}$，使得当 $p<p^{\\ast}$ 时，雄性的最优决策是 $I_{m}=0$（不抚育），而当 $p>p^{\\ast}$ 时，雄性提供正向的抚育。\n\n仅使用广义适合度理论的第一性原理和基础优化方法（在内部最优点处，边际效益等于边际成本），推导出 $p^{\\ast}$ 关于 $B$、$S(\\cdot)$ 和 $C_{m}(\\cdot)$ 的一般表达式，然后根据上面给出的具体函数和参数计算其值。将你最终的 $p^{\\ast}$ 数值答案以小数形式表示，并四舍五入至四位有效数字。", "solution": "雄性的广义适合度是其当前窝后代中携带其基因的存活后代期望数，与其未来后代中携带其基因的后代期望数的、经亲缘相关系数加权的总和。在二倍体遗传下，与自身后代的亲缘相关系数为 $r=\\tfrac{1}{2}$，其广义适合度作为其投入 $I_{m}$ 的函数可以写为\n$$\nW(I_{m}) \\;=\\; r \\Big( p \\, B \\, S(I_{f}+I_{m}) \\;+\\; R_{0} \\;-\\; C_{m}(I_{m}) \\Big).\n$$\n此处，$R_{0}$ 与 $I_{m}$ 无关，而 $r$ 同时乘以当前和未来的项。由于 $r$ 是一个正常数因子，最大化 $W(I_{m})$ 等价于最大化方括号内的项：\n$$\n\\Phi(I_{m}) \\;=\\; p \\, B \\, S(I_{f}+I_{m}) \\;-\\; C_{m}(I_{m}) \\;+\\; R_{0}.\n$$\n由于 $R_{0}$ 相对于 $I_{m}$ 是一个常数，它不影响 $I_{m}$ 的选择，因此在优化过程中可以忽略。因此，雄性选择 $I_{m}$ 来最大化\n$$\n\\Psi(I_{m}) \\;=\\; p \\, B \\, S(I_{f}+I_{m}) \\;-\\; C_{m}(I_{m}).\n$$\n\n描述任何内部最优解 $I_{m}^{\\ast}>0$ 的一阶条件是透过对 $\\Psi(I_{m})$ 关于 $I_{m}$ 求导并将導數设为零得到：\n$$\n\\frac{d\\Psi}{d I_{m}} \\;=\\; p \\, B \\, S'(I_{f}+I_{m}) \\;-\\; C_{m}'(I_{m}) \\;=\\; 0.\n$$\n因为 $S(I)$ 是递增且凹的（回报递减），而 $C_{m}(I_{m})$ 是递增的，所以左侧表达式随 $I_{m}$ 的增加而减少，这确保了如果存在解，则解是唯一的。亲权阈值 $p^{\\ast}$ 界定了角点解 $I_{m}=0$ 何时成为最优解。具体来说，当 $I_{m}=0$ 处的边际效益小于或等于边际成本时，$I_{m}=0$ 是最优的；只有当 $I_{m}=0$ 处的边际效益超过边际成本时，才存在一个正的内部解。因此，阈值 $p^{\\ast}$ 由 $I_{m}=0$ 处的无差异条件定义：\n$$\np^{\\ast} \\, B \\, S'(I_{f}) \\;=\\; C_{m}'(0).\n$$\n解出 $p^{\\ast}$ 得到一般表达式\n$$\np^{\\ast} \\;=\\; \\frac{C_{m}'(0)}{B \\, S'(I_{f})}.\n$$\n\n现在根据给定的函数和参数进行计算。我们有 $S(I)=1-\\exp(-k I)$ 且 $k=0.4$，所以\n$$\nS'(I) \\;=\\; k \\, \\exp(-k I).\n$$\n因此，\n$$\nS'(I_{f}) \\;=\\; k \\, \\exp(-k I_{f}) \\;=\\; 0.4 \\, \\exp\\!\\big(-0.4 \\times 3\\big) \\;=\\; 0.4 \\, \\exp(-1.2).\n$$\n成本函数是线性的，$C_{m}(I_{m})=c \\, I_{m}$ 且 $c=0.25$，因此\n$$\nC_{m}'(0) \\;=\\; c \\;=\\; 0.25.\n$$\n将窝的大小 $B=6$ 代入阈值表达式中：\n$$\np^{\\ast} \\;=\\; \\frac{0.25}{6 \\times \\big(0.4 \\, \\exp(-1.2)\\big)} \\;=\\; \\frac{0.25}{2.4 \\, \\exp(-1.2)} \\;=\\; \\frac{0.25}{2.4} \\, \\exp(1.2).\n$$\n计算数值：\n$$\n\\frac{0.25}{2.4} \\;=\\; 0.104166\\overline{6}, \\quad \\exp(1.2) \\approx 3.320116923,\n$$\n所以\n$$\np^{\\ast} \\;\\approx\\; 0.104166\\overline{6} \\times 3.320116923 \\;\\approx\\; 0.345843\\ldots\n$$\n四舍五入至四位有效数字，\n$$\np^{\\ast} \\;\\approx\\; 0.3458.\n$$\n此值位于单位区间内，这与其作为一个亲权份额的解释是一致的，当亲权份额低于此值时，雄性抚育降至零。", "answer": "$$\\boxed{0.3458}$$", "id": "2813928"}]}