{"hands_on_practices": [{"introduction": "本练习将引导您完成一项基础但至关重要的任务：根据一个假设的“封闭世代”的原始生存数据构建一个世代生命表。通过直接从头计算存活函数 $l_x$、死亡数 $d_x$、特定年龄区间存活年数 $L_x$ 以及最终的期望寿命，您将深入理解生命表中各个核心组成部分之间的内在联系。这个练习是掌握生命表分析的基石 [@problem_id:2811963]。", "problem": "一个规模为 $100$ 人的封闭队列在整数年龄 $x \\in \\{0,1,2,3,4,5\\}$ 被观察，其队列人数为 $\\{n_x\\} = (100,80,61,50,43,40)$，表示在每个年龄 $x$ 开始时的存活人数。考虑对于 $x \\in \\{0,1,2,3,4\\}$ 的一年期年龄区间 $[x,x+1)$。仅使用离散时间下的生存分析和生命表理论的基本定义，完成以下任务：\n\n- 定义生存函数 $l_x$ 为初始队列中存活到年龄 $x$ 开始时的人数比例，区间内死亡数 $d_x$ 为相邻 $l_x$ 值之间的差额，在年龄 $x$ 存活的条件下于区间 $[x,x+1)$ 内死亡的条件概率 $q_x$，以及在年龄 $x$ 存活的条件下于区间 $[x,x+1)$ 内生存的条件概率 $p_x$。\n- 假设每个区间内的死亡呈均匀分布（这是与区间内死亡率恒定一致的标准近似方法），因此在每个单位长度区间 $[x,x+1)$ 内，生存人年数满足 $L_x=(l_x+l_{x+1})/2$。\n- 根据第一性原理，基于构建的生命表量，计算在观察窗口 $[0,5)$ 内的出生时期望寿命，该值解释为此队列中新生儿从出生到 5 岁的预期生存年数。\n\n报告出生时期望寿命的最终值（以年为单位），并将答案四舍五入到四位有效数字。在最终的方框答案中不要包含单位。", "solution": "对问题陈述进行验证。\n\n逐字提取已知条件：\n- 观察一个规模为 $100$ 人的封闭队列。\n- 整数年龄为 $x \\in \\{0,1,2,3,4,5\\}$。\n- 队列人数为 $\\{n_x\\} = (100,80,61,50,43,40)$，其中 $n_x$ 是在年龄 $x$ 开始时的存活人数。\n- 年龄区间为一年期区间 $[x,x+1)$，其中 $x \\in \\{0,1,2,3,4\\}$。\n- 生存函数 $l_x$ 定义为初始队列中存活到年龄 $x$ 开始时的人数比例。\n- 区间内的死亡数 $d_x$ 是相邻 $l_x$ 值之间的差额。\n- 条件死亡概率 $q_x$ 是在年龄 $x$ 存活的条件下于 $[x,x+1)$ 内死亡的概率。\n- 条件生存概率 $p_x$ 是在年龄 $x$ 存活的条件下于 $[x,x+1)$ 内生存的概率。\n- 假设每个区间内的死亡呈均匀分布（UDD）。\n- 区间内的生存人年数为 $L_x=(l_x+l_{x+1})/2$。\n- 目标是计算在观察窗口 $[0,5)$ 内的出生时期望寿命，解释为从出生到 5 岁的预期生存年数。\n- 最终答案必须四舍五入到四位有效数字。\n\n此问题被确定为有效。它在科学上基于人口学和生存分析的既定原则。问题陈述清晰，提供了计算所需量所必需的所有数据和定义（$n_x$，UDD假设）。数据是一致的，因为存活人数 $\\{n_x\\}$ 是一个单调非增序列。语言客观而精确。该问题是生命表构建和分析中的一个标准练习。\n\n我们开始解题。\n\n首先，我们根据给定的队列数据构建基本的生命表函数。初始队列规模，或称基数，为 $n_0=100$。生存函数 $l_x$ 定义为初始队列中存活到年龄 $x$ 开始时的人数比例。因此，$l_x = n_x / n_0$。此生命表的基数为 $l_0 = n_0/n_0 = 100/100 = 1$。\n\n$x \\in \\{0,1,2,3,4,5\\}$ 时 $l_x$ 的值为：\n$$l_0 = \\frac{100}{100} = 1.0$$\n$$l_1 = \\frac{80}{100} = 0.8$$\n$$l_2 = \\frac{61}{100} = 0.61$$\n$$l_3 = \\frac{50}{100} = 0.50$$\n$$l_4 = \\frac{43}{100} = 0.43$$\n$$l_5 = \\frac{40}{100} = 0.40$$\n\n根据题目要求，我们还定义了其他基本量，尽管并非所有量都用于最终计算。对于一个以 $l_x$ 人数开始的队列，在区间 $[x, x+1)$ 内的死亡人数为 $d_x = l_x - l_{x+1}$。在年龄 $x$ 存活的条件下于 $[x, x+1)$ 内死亡的条件概率为 $q_x = d_x/l_x$。条件生存概率为 $p_x = 1 - q_x = l_{x+1}/l_x$。\n\n主要目标是计算在观察窗口 $[0,5)$ 内的出生时期望寿命。这被解释为新生儿从 0 岁到 5 岁的预期生存年数。该量被称为从 0 岁开始的 5 年期临时期望寿命，记为 $e_{0:5\\rceil}$。其计算方法为队列在 0 岁到 5 岁之间生存的总人年数，除以队列在 0 岁时的初始人数。\n在年龄 $x$ 和 $x+k$ 之间生存的总人年数为 $\\sum_{i=x}^{x+k-1} L_i$。因此，临时期望寿命由下式给出：\n$$e_{0:5\\rceil} = \\frac{\\sum_{x=0}^{4} L_x}{l_0}$$\n在此，$L_x$ 表示在年龄区间 $[x,x+1)$ 内的生存人年数。题目指定了公式 $L_x = (l_x+l_{x+1})/2$，这是在每个一年期区间内死亡均匀分布（UDD）假设下的标准计算方法。\n\n我们现在计算从 $x=0$ 到 $x=4$ 每个区间的 $L_x$ 值：\n$$L_0 = \\frac{l_0 + l_1}{2} = \\frac{1.0 + 0.8}{2} = \\frac{1.8}{2} = 0.9$$\n$$L_1 = \\frac{l_1 + l_2}{2} = \\frac{0.8 + 0.61}{2} = \\frac{1.41}{2} = 0.705$$\n$$L_2 = \\frac{l_2 + l_3}{2} = \\frac{0.61 + 0.50}{2} = \\frac{1.11}{2} = 0.555$$\n$$L_3 = \\frac{l_3 + l_4}{2} = \\frac{0.50 + 0.43}{2} = \\frac{0.93}{2} = 0.465$$\n$$L_4 = \\frac{l_4 + l_5}{2} = \\frac{0.43 + 0.40}{2} = \\frac{0.83}{2} = 0.415$$\n\n接下来，我们将这些值相加，求出从 0 岁到 5 岁的总生存人年数：\n$$\\sum_{x=0}^{4} L_x = L_0 + L_1 + L_2 + L_3 + L_4$$\n$$\\sum_{x=0}^{4} L_x = 0.9 + 0.705 + 0.555 + 0.465 + 0.415 = 3.04$$\n\n计算出的总和是一个精确值，由精确的有理数推导得出。最后，我们计算指定窗口内的期望寿命：\n$$e_{0:5\\rceil} = \\frac{\\sum_{x=0}^{4} L_x}{l_0} = \\frac{3.04}{1.0} = 3.04$$\n\n题目要求答案四舍五入到四位有效数字。精确值为 $3.04$，它有三位有效数字。为了以四位有效数字表示该值，我们必须在末尾添加一个零，得到 $3.040$。\n在观察窗口 $[0,5)$ 内的出生时期望寿命为 $3.040$ 年。", "answer": "$$\\boxed{3.040}$$", "id": "2811963"}, {"introduction": "在现实世界中，追踪一个完整的生物世代往往不切实际。因此，本练习将向您介绍一种更常见的方法：使用在一个较短时期内收集的横截面数据来构建一个时期生命表。您将学习如何计算中心死亡率 $m_x$，并掌握将其转换为生命表死亡概率 $q_x$ 的关键技术，这是生态学家和人口统计学家处理实际人口数据的必备技能 [@problem_id:2811952]。", "problem": "一项关于某个小型哺乳动物物种的野外研究，记录了在一个日历年内，以一岁为年龄组的年龄结构计数、死亡数和风险暴露人时。假设 $x \\in \\{0,1,2,3,4\\}$ 为一年期闭区间，$x=5+$ 为开口区间；在每个闭区间内的风险率（死亡力）为分段恒定，在开口区间内的风险率为恒定。年中计数值为 $N_x$，年内观测到的死亡数为 $D_x$，暴露人时为 $E_x$（单位：人年）。数据如下：\n\n- $x=0$: $(N_0, D_0, E_0) = (\\,950,\\,38,\\,950\\,)$\n- $x=1$: $(N_1, D_1, E_1) = (\\,980,\\,5,\\,980\\,)$\n- $x=2$: $(N_2, D_2, E_2) = (\\,990,\\,4,\\,990\\,)$\n- $x=3$: $(N_3, D_3, E_3) = (\\,1000,\\,6,\\,1000\\,)$\n- $x=4$: $(N_4, D_4, E_4) = (\\,980,\\,10,\\,980\\,)$\n- $x=5+$: $(N_5, D_5, E_5) = (\\,500,\\,50,\\,500\\,)$\n\n使用为每个年龄组定义的中心死亡率 $m_x = D_x / E_x$ 构建一个时期生命表。通过经典的 $a_x$ 调整关系式\n$$\nq_x \\approx \\frac{m_x}{1 + (1-a_x)\\,m_x}\n$$\n来近似计算区间死亡概率 $q_x$，其中对所有一年期闭区间，$a_x = 0.5$。设生命表基数 $l_0 = 1$。对每个闭区间，使用生存人年的标准恒等式\n$$\nL_x = l_{x+1} + a_x\\,d_x,\n$$\n其中 $d_x = l_x\\,q_x$。对于 $x=5+$ 的开口区间，取 $q_{5}=1$ 并假设 5 岁以后的风险率为恒定。\n\n根据这些要素和假设，计算时期出生时预期寿命 $e_0$，其中 $e_0 = T_0/l_0$，而 $T_0$ 是生命表中 0 岁及以上年龄的总生存人年。请以年为单位表示您的最终结果，并将答案四舍五入至四位有效数字。", "solution": "问题陈述提出了人口学中的一个标准任务：根据关于死亡和暴露的横截面数据构建时期生命表。我们必须首先验证问题的完整性。\n\n**问题验证**\n\n给定的条件是：\n- 年龄组：$x \\in \\{0, 1, 2, 3, 4\\}$（一年期闭区间）和 $x = 5+$（开口区间）。\n- 每个年龄组 $x$ 的数据：年中计数值 $N_x$、死亡数 $D_x$ 和暴露人时 $E_x$。\n  - $x=0: (N_0, D_0, E_0) = (950, 38, 950)$\n  - $x=1: (N_1, D_1, E_1) = (980, 5, 980)$\n  - $x=2: (N_2, D_2, E_2) = (990, 4, 990)$\n  - $x=3: (N_3, D_3, E_3) = (1000, 6, 1000)$\n  - $x=4: (N_4, D_4, E_4) = (980, 10, 980)$\n  - $x=5+: (N_5, D_5, E_5) = (500, 50, 500)$\n- 定义和假设：\n  - 中心死亡率：$m_x = D_x / E_x$。\n  - 在区间 $[x, x+1)$ 内的死亡概率：$q_x \\approx \\frac{m_x}{1 + (1-a_x)m_x}$。\n  - 分离因子：$a_x = 0.5$ for $x \\in \\{0, 1, 2, 3, 4\\}$。\n  - 生命表基数：$l_0 = 1$。\n  - 在 $[x, x+1)$ 内的生存人年：$L_x = l_{x+1} + a_x d_x$。\n  - 对于开口区间 $x=5+$, 陈述为“取 $q_5=1$”和“假设 5 岁以后为恒定风险率”。\n\n该问题具有科学依据，使用了生命表分析中的标准定义和近似方法。问题是适定且自洽的。在“取 $q_5=1$”这一指令中存在一个细微的歧义。这不应被解释为区间 $[5, 6)$ 的死亡概率，因为这将与问题对 $5+$ 这一开口组的定义相矛盾，而应被解释为一个同义反复的陈述，即在最后的开口区间 $[5, \\infty)$ 内的死亡概率为 1。在这个最终年龄组中，用于计算的实际假设是“恒定风险率”，这意味着 5 岁时的预期寿命是中心死亡率的倒数，即 $e_5 = 1/m_{5+}$。在此标准人口学解释下，该问题是完全有效的。我们开始进行求解。\n\n**求解推导**\n\n目标是计算出生时预期寿命 $e_0 = T_0 / l_0$。我们将逐步构建生命表。\n\n**步骤 1：计算中心死亡率 ($m_x$)**\n\n每个年龄组的中心死亡率为 $m_x = D_x / E_x$。\n- $m_0 = \\frac{38}{950} = 0.04$\n- $m_1 = \\frac{5}{980} = \\frac{1}{196} \\approx 0.005102$\n- $m_2 = \\frac{4}{990} = \\frac{2}{495} \\approx 0.004040$\n- $m_3 = \\frac{6}{1000} = 0.006$\n- $m_4 = \\frac{10}{980} = \\frac{1}{98} \\approx 0.010204$\n- $m_{5+} = \\frac{50}{500} = 0.1$\n\n**步骤 2：计算死亡概率 ($q_x$)**\n\n对于闭区间（$x=0$ 到 $4$），我们使用给定的公式，其中 $a_x=0.5$：\n$q_x = \\frac{m_x}{1 + (1-0.5)m_x} = \\frac{m_x}{1 + 0.5m_x}$。\n\n- $q_0 = \\frac{0.04}{1 + 0.5(0.04)} = \\frac{0.04}{1.02} = \\frac{38}{969} \\approx 0.03921569$\n- $q_1 = \\frac{1/196}{1 + 0.5(1/196)} = \\frac{1/196}{1 + 1/392} = \\frac{2}{393} \\approx 0.00508906$\n- $q_2 = \\frac{2/495}{1 + 0.5(2/495)} = \\frac{2/495}{1 + 1/495} = \\frac{2}{496} = \\frac{1}{248} \\approx 0.00403226$\n- $q_3 = \\frac{0.006}{1 + 0.5(0.006)} = \\frac{0.006}{1.003} = \\frac{6}{1003} \\approx 0.00598205$\n- $q_4 = \\frac{1/98}{1 + 0.5(1/98)} = \\frac{1/98}{1 + 1/196} = \\frac{2}{197} \\approx 0.01015228$\n\n对于开口区间 $5+$，根据定义，最终死亡的概率为 $q_{5+} = 1$。\n\n**步骤 3：构建生命表各列 ($l_x$ 和 $d_x$)**\n\n我们从基数 $l_0 = 1$ 开始，为每个年龄迭代计算存活数 ($l_x$) 和死亡数 ($d_x = l_x q_x$) 。\n\n- 年龄 $0$: $l_0 = 1$。\n  $d_0 = l_0 q_0 = 1 \\times 0.03921569 = 0.03921569$。\n  $l_1 = l_0 - d_0 = 1 - 0.03921569 = 0.96078431$。\n- 年龄 $1$: $l_1 = 0.96078431$。\n  $d_1 = l_1 q_1 = 0.96078431 \\times 0.00508906 = 0.00488950$。\n  $l_2 = l_1 - d_1 = 0.96078431 - 0.00488950 = 0.95589481$。\n- 年龄 $2$: $l_2 = 0.95589481$。\n  $d_2 = l_2 q_2 = 0.95589481 \\times 0.00403226 = 0.00385441$。\n  $l_3 = l_2 - d_2 = 0.95589481 - 0.00385441 = 0.95204040$。\n- 年龄 $3$: $l_3 = 0.95204040$。\n  $d_3 = l_3 q_3 = 0.95204040 \\times 0.00598205 = 0.00569502$。\n  $l_4 = l_3 - d_3 = 0.95204040 - 0.00569502 = 0.94634538$。\n- 年龄 $4$: $l_4 = 0.94634538$。\n  $d_4 = l_4 q_4 = 0.94634538 \\times 0.01015228 = 0.00960683$。\n  $l_5 = l_4 - d_4 = 0.94634538 - 0.00960683 = 0.93673855$。\n\n**步骤 4：计算生存人年 ($L_x$)**\n\n对于闭区间（$x=0$ 到 $4$），当 $a_x = 0.5$ 时，公式 $L_x = l_{x+1} + a_x d_x$ 等价于 $L_x = 0.5 (l_x + l_{x+1})$。\n- $L_0 = 0.5 (l_0 + l_1) = 0.5 (1 + 0.96078431) = 0.98039216$。\n- $L_1 = 0.5 (l_1 + l_2) = 0.5 (0.96078431 + 0.95589481) = 0.95833956$。\n- $L_2 = 0.5 (l_2 + l_3) = 0.5 (0.95589481 + 0.95204040) = 0.95396761$。\n- $L_3 = 0.5 (l_3 + l_4) = 0.5 (0.95204040 + 0.94634538) = 0.94919289$。\n- $L_4 = 0.5 (l_4 + l_5) = 0.5 (0.94634538 + 0.93673855) = 0.94154197$。\n\n对于开口区间 $5+$，恒定风险率 $\\mu_{5+}$ 的假设意味着中心死亡率 $m_{5+}$ 是该风险率的估计量，即 $m_{5+} \\approx \\mu_{5+}$。对于到达 5 岁的人，其预期寿命为 $e_5 = 1/\\mu_{5+} \\approx 1/m_{5+}$。5 岁以上的总生存人年为 $L_{5+} = T_5 = l_5 e_5$。\n- $L_{5+} = l_5 / m_{5+} = 0.93673855 / 0.1 = 9.3673855$。\n\n**步骤 5：计算总生存人年 ($T_x$)**\n\n年龄 $x$ 及以上的总生存人年为 $T_x = \\sum_{y=x}^{\\omega} L_y$，其中 $\\omega$ 表示最后一个年龄组。我们通过从最高年龄组向下求和来计算该值。\n- $T_5 = L_{5+} = 9.3673855$。\n- $T_4 = L_4 + T_5 = 0.94154197 + 9.3673855 = 10.30892747$。\n- $T_3 = L_3 + T_4 = 0.94919289 + 10.30892747 = 11.25812036$。\n- $T_2 = L_2 + T_3 = 0.95396761 + 11.25812036 = 12.21208797$。\n- $T_1 = L_1 + T_2 = 0.95833956 + 12.21208797 = 13.17042753$。\n- $T_0 = L_0 + T_1 = 0.98039216 + 13.17042753 = 14.15081969$。\n\n**步骤 6：计算出生时预期寿命 ($e_0$)**\n\n出生时预期寿命为 $e_0 = T_0 / l_0$。由于基数 $l_0 = 1$，因此有 $e_0 = T_0$。\n$e_0 = 14.15081969$ 年。\n\n题目要求结果四舍五入到四位有效数字。\n$e_0 \\approx 14.15$。", "answer": "$$\\boxed{14.15}$$", "id": "2811952"}, {"introduction": "在许多生物学和医学研究中，我们常常无法观察到每个研究对象的最终结局，这种情况被称为“数据删失”。本练习将介绍现代生存分析的基石——Kaplan-Meier 估计法，这是一种处理此类不完整数据的强大非参数方法。您将亲手处理包含右删失（例如，研究结束或个体失访）的个体水平数据，一步步构建出准确的生存曲线，这项技能在临床试验和生态学实地研究中至关重要 [@problem_id:2811971]。", "problem": "一项队列研究随访了 $n=4$ 名个体，他们的随访完成时间（单位相同）各不相同：$2, 3, 5, 7$。两名个体在时间 $t=3$ 和 $t=7$ 发生事件（死亡），两名个体在时间 $t=2$ 和 $t=5$ 被右删失。假设右删失为非信息性的，没有相同的事件时间，并且每个事件时间的风险集包括在该时间点严格之前仍在观察中的所有个体。仅使用生存分析的基本原理和标准大样本理论，按顺序完成以下任务：\n- 在观测时间 $t \\in \\{2, 3, 5, 7\\}$ 处，构建生存函数的 Kaplan–Meier (KM) 乘积极限估计 $\\hat S(t)$。\n- 为 $S(7)$ 推导一个在渐近理论下科学上可辩护的双侧 $95\\%$ 置信区间 (CI)，并在需要时仔细论证在参数边界附近对变换或尺度的选择。\n\n所有概率均以小数表示。所有报告的概率均四舍五入至四位有效数字。报告 $\\hat S(5)$ 的值作为你的最终数值答案，四舍五入至四位有效数字。", "solution": "该问题要求基于一个小型队列研究，构建 Kaplan-Meier (KM) 生存函数估计，并为一个特定时间点的生存率构建置信区间 (CI)。我将首先验证问题陈述的有效性，并在确认其有效后，基于基本原理进行严格的、分步的推导。\n\n首先，我们整理所提供的数据。总队列大小为 $n=4$。观测数据如下：一名个体在时间 $t=2$ 被右删失；一名个体在时间 $t=3$ 发生事件（死亡）；一名个体在时间 $t=5$ 被右删失；以及一名个体在时间 $t=7$ 发生事件。不同的事件时间为 $t_1=3$ 和 $t_2=7$。\n\n设 $t_j$ 表示第 $j$ 个不同的事件时间。设 $n_j$ 为在时间 $t_j$ 之前瞬间处于风险中（存活且在观察中）的个体数量。设 $d_j$ 为在时间 $t_j$ 发生的事件数量。风险集和事件列表如下：\n- 在时间 $t=0$，风险中的个体数量为 $4$。\n- 在时间 $t=2$，一名个体被删失。风险中的个体数量变为 $4-1=3$。\n- 在第一个事件时间 $t_1=3$：风险中的个体数量为 $n_1=3$。事件数量为 $d_1=1$。\n- 在 $t=3$ 的事件之后，风险中的个体数量变为 $3-1=2$。\n- 在时间 $t=5$，一名个体被删失。风险中的个体数量变为 $2-1=1$。\n- 在第二个事件时间 $t_2=7$：风险中的个体数量为 $n_2=1$。事件数量为 $d_2=1$。\n\n生存函数 $S(t) = P(T > t)$ 的 Kaplan-Meier 乘积极限估计量由以下公式给出：\n$$ \\hat S(t) = \\prod_{j: t_j \\le t} \\left(1 - \\frac{d_j}{n_j}\\right) $$\n我们在指定的时间点 $t \\in \\{2, 3, 5, 7\\}$ 处计算该估计量的值。\n\n- 对于 $t=2$：此时点之前没有事件发生。因此，生存函数估计为 $\\hat S(2) = 1$。在 $t=2$ 的删失不改变 $S(2)$ 的估计值，但它减少了后续时间的风险集大小。四舍五入至四位有效数字，$\\hat S(2) = 1.0000$。\n\n- 对于 $t=3$：此时点发生了一个事件。估计值计算如下：\n$$ \\hat S(3) = \\left(1 - \\frac{d_1}{n_1}\\right) = \\left(1 - \\frac{1}{3}\\right) = \\frac{2}{3} $$\n作为小数并四舍五入至四位有效数字，$\\hat S(3) \\approx 0.6667$。\n\n- 对于 $t=5$：在 $t=3$ 和 $t=5$ 之间没有事件发生。生存估计在此区间内保持不变。在 $t=5$ 的删失不改变该时间点的生存估计。\n$$ \\hat S(5) = \\hat S(3) = \\frac{2}{3} $$\n作为小数并四舍五入至四位有效数字，$\\hat S(5) \\approx 0.6667$。\n\n- 对于 $t=7$：发生第二个事件。通过将先前的生存概率乘以存活过 $t=7$ 的条件概率来更新生存估计：\n$$ \\hat S(7) = \\hat S(t<7) \\times \\left(1 - \\frac{d_2}{n_2}\\right) = \\frac{2}{3} \\times \\left(1 - \\frac{1}{1}\\right) = \\frac{2}{3} \\times 0 = 0 $$\n四舍五入至四位有效数字，$\\hat S(7) = 0.0000$。\n\nKM 估计总结：$\\hat S(2)=1.0000$，$\\hat S(3) \\approx 0.6667$，$\\hat S(5) \\approx 0.6667$，$\\hat S(7)=0.0000$。\n\n接下来，我们必须为 $S(7)$ 推导一个双侧 $95\\%$ 置信区间。其点估计为 $\\hat S(7)=0$。这是一个需要仔细考虑的边界情况。构建 $\\hat S(t)$ 置信区间的一个标准方法涉及使用 Greenwood's 公式计算方差：\n$$ \\widehat{\\text{Var}}(\\hat S(t)) = [\\hat S(t)]^2 \\sum_{j: t_j \\le t} \\frac{d_j}{n_j(n_j - d_j)} $$\n然后，一个线性置信区间为 $\\hat S(t) \\pm z_{\\alpha/2} \\sqrt{\\widehat{\\text{Var}}(\\hat S(t))}$，其中对于 $95\\%$ 置信区间，$z_{0.025} \\approx 1.96$。然而，这种方法有已知的缺陷，特别是它可能产生超出有效范围 $[0, 1]$ 的区间限。\n\n为了纠正这一点，我们使用对 $S(t)$ 的变换。一个常见且理论上合理的选择是互补对数-对数变换，即 $g(p) = \\ln(-\\ln(p))$，它将区间 $(0, 1)$ 映射到 $(-\\infty, \\infty)$。在变换后的尺度上构建置信区间，然后反变换回来。\n\n然而，在这个具体问题中，$\\hat S(7)=0$。任何涉及 $\\ln(\\hat S(t))$ 或 $\\ln(-\\ln(\\hat S(t)))$ 的变换在这一点上都是无定义的。此外，Greenwood's 的方差公式本身在 $t=7$ 时也出现问题。求和中的第二项对应于 $t_2=7$ 处的事件，此时 $n_2=1$ 且 $d_2=1$。分母项 $n_2(n_2-d_2)$ 变为 $1(1-1)=0$，导致除以零。\n\n科学上可辩护的路径，与生存分析中的标准实践（例如，如 Klein and Moeschberger 所述）一致，是直接处理这种边界情况。当最大的观测时间是一个未删失的事件时，Kaplan-Meier 估计值降至 $0$ 并保持不变。按照惯例，对于所有后续时间，估计量的方差被取为 $0$。这反映了这样一个事实：根据观测数据，没有证据表明在该时间点之后还有生存可能；根据渐近近似，生存的估计值精确为 $0$，没有不确定性。虽然这是渐近理论的一个已知局限性，特别是在小样本量的情况下，但这是标准惯例。\n\n因此，对于 $t=7$，我们有 $\\hat S(7)=0$ 和 $\\widehat{\\text{Var}}(\\hat S(7))=0$。标准误为 $\\sqrt{0}=0$。那么 $95\\%$ 的置信区间是：\n$$ \\hat S(7) \\pm 1.96 \\times 0 = [0, 0] $$\n这个退化区间是将标准大样本理论应用于最后一个观测是事件的数据集的直接且合乎逻辑的结果，它使得超过该时间点的生存概率估计为 $0$。没有基于变换的方法是适用的。\n\n最后的任务是报告 $\\hat S(5)$ 的值，并四舍五入到四位有效数字。如前所计算，$\\hat S(5) = \\frac{2}{3} \\approx 0.666666...$，四舍五入后为 $0.6667$。", "answer": "$$\\boxed{0.6667}$$", "id": "2811971"}]}