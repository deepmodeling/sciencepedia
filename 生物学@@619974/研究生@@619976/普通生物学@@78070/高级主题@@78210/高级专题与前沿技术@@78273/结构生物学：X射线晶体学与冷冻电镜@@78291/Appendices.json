{"hands_on_practices": [{"introduction": "结构因子 $F(hkl)$ 是连接原子模型和衍射数据之间的桥梁，是晶体学中的核心概念。它代表了晶胞中所有原子对特定衍射点 $(h,k,l)$ 的总散射贡献。本练习将指导你基于第一性原理，综合考虑原子坐标、占有率以及由B因子描述的热振动，亲手计算结构因子 [@problem_id:2839287]。这个实践将帮助你深入理解原子尺度的结构信息是如何被编码成可观测的衍射强度的。", "problem": "空间群为 $P1$ 的一个大分子晶体，其不对称单元由三个独立原子组成，它们的分数坐标为 $(x_j,y_j,z_j)$（以晶胞为基底），占有率为 $o_j$，各向同性原子位移参数（B因子）为 $B_j$（单位为 $\\mathrm{\\AA}^2$）。忽略异常色散，并假设每个原子独立散射，其原子散射因子 $f_j(s)$ 在给定的散射变量 $s = \\sin\\theta/\\lambda$ 处已有列表值。我们感兴趣的衍射点指标为 $(h,k,l)=(2,1,0)$，测量于 $s = 0.2\\ \\mathrm{\\AA}^{-1}$ 处。此衍射点的原子数据如下：\n- 原子 A：$(x_A,y_A,z_A)=(0.25,\\,0.50,\\,0.00)$，$o_A=1.0$，$B_A=10$，$f_A(s{=}0.2)=5.70$ 电子。\n- 原子 B：$(x_B,y_B,z_B)=(0.10,\\,0.20,\\,0.30)$，$o_B=0.5$，$B_B=25$，$f_B(s{=}0.2)=7.40$ 电子。\n- 原子 C：$(x_C,y_C,z_C)=(0.40,\\,0.90,\\,0.60)$，$o_C=1.0$，$B_C=15$，$f_C(s{=}0.2)=6.50$ 电子。\n\n仅使用衍射理论和电子密度的基本定义，并通过标准的B因子温度因子处理各向同性原子位移，计算 $(h,k,l)=(2,1,0)$ 衍射点的结构因子振幅 $|F(hkl)|$。以电子为单位表示最终振幅，并将您的答案四舍五入到四位有效数字。不要报告强度或平方量；仅报告振幅 $|F|$，单位为电子。", "solution": "在尝试求解之前，对问题陈述的有效性进行严格评估。\n\n**步骤 1：提取已知条件**\n- 空间群：$P1$\n- 不对称单元内容：三个独立原子，记为 A、B、C。\n- 原子分数坐标：$(x_j, y_j, z_j)$\n- 原子占有率：$o_j$\n- 原子各向同性位移参数 (B因子)：$B_j$，单位为 $\\mathrm{\\AA}^2$\n- 原子散射因子：$f_j(s)$\n- 色散效应：忽略异常色散。\n- 衍射点指标：$(h,k,l) = (2,1,0)$\n- 散射变量：$s = \\sin\\theta/\\lambda = 0.2\\ \\mathrm{\\AA}^{-1}$\n- 原子 A 数据：$(x_A,y_A,z_A)=(0.25,\\,0.50,\\,0.00)$，$o_A=1.0$，$B_A=10\\ \\mathrm{\\AA}^2$，$f_A(s{=}0.2)=5.70$ 电子。\n- 原子 B 数据：$(x_B,y_B,z_B)=(0.10,\\,0.20,\\,0.30)$，$o_B=0.5$，$B_B=25\\ \\mathrm{\\AA}^2$，$f_B(s{=}0.2)=7.40$ 电子。\n- 原子 C 数据：$(x_C,y_C,z_C)=(0.40,\\,0.90,\\,0.60)$，$o_C=1.0$，$B_C=15\\ \\mathrm{\\AA}^2$，$f_C(s{=}0.2)=6.50$ 电子。\n- 要求输出：结构因子振幅 $|F(hkl)|$，单位为电子，四舍五入到四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估。\n- **科学依据**：该问题是X射线晶体学中的一个标准练习。它要求计算结构因子，这是衍射理论中的一个基本量。所有概念——空间群、分数坐标、原子散射因子、B因子和占有率——都是结构生物学的核心原理。所提供的值在物理上是合理的。该问题具有科学合理性。\n- **适定性**：该问题提供了计算结构因子振幅唯一值所需的所有参数。空间群 $P1$ 的指定正确地意味着不对称单元就是整个晶胞，从而消除了求和中应包含的原子数量和位置的任何歧义。问题清晰明确，存在唯一的稳定解。\n- **客观性**：该问题使用该领域标准的精确、定量术语和定义进行陈述。它不含主观或基于意见的主张。\n\n**步骤 3：结论与行动**\n该问题是有效的。这是一个适定的、有科学依据的问题，可以用基本原理解答。现在推导求解过程。\n\n**求解推导**\n\n结构因子 $F(hkl)$ 表示对于给定的衍射点 $(h,k,l)$，晶胞中所有电子的总散射波。对于晶胞中的一组 $N$ 个离散原子，它被定义为每个原子散射贡献的总和：\n$$\nF(hkl) = \\sum_{j=1}^{N} f_{j,\\text{eff}} \\exp[2\\pi i (hx_j + ky_j + lz_j)]\n$$\n其中 $(x_j, y_j, z_j)$ 是原子 $j$ 的分数坐标。空间群为 $P1$，它只有恒等对称操作。因此，不对称单元构成晶胞的全部内容，求和是对指定的三个原子进行的 ($N=3$)。\n\n每个原子的有效原子散射因子 $f_{j,\\text{eff}}$ 必须考虑其部分占有率 $o_j$ 和由各向同性B因子 $B_j$ 描述的热振动。温度因子校正的标准定义是 $\\exp(-B_j s^2)$，其中 $s = \\sin\\theta/\\lambda$。因此，有效散射因子为：\n$$\nf_{j,\\text{eff}} = o_j \\cdot f_j(s) \\cdot \\exp(-B_j s^2)\n$$\n给定 $s = 0.2\\ \\mathrm{\\AA}^{-1}$，所以 $s^2 = (0.2)^2 = 0.04\\ \\mathrm{\\AA}^{-2}$。\n\n首先，我们计算每个原子的有效原子散射因子：\n- **原子 A**:\n$$\nf_{A,\\text{eff}} = o_A \\cdot f_A(s) \\cdot \\exp(-B_A s^2) = (1.0)(5.70) \\exp[-10 \\cdot (0.04)] = 5.70 \\exp(-0.4)\n$$\n- **原子 B**:\n$$\nf_{B,\\text{eff}} = o_B \\cdot f_B(s) \\cdot \\exp(-B_B s^2) = (0.5)(7.40) \\exp[-25 \\cdot (0.04)] = 3.70 \\exp(-1.0)\n$$\n- **原子 C**:\n$$\nf_{C,\\text{eff}} = o_C \\cdot f_C(s) \\cdot \\exp(-B_C s^2) = (1.0)(6.50) \\exp[-15 \\cdot (0.04)] = 6.50 \\exp(-0.6)\n$$\n\n接下来，我们为衍射点 $(h,k,l) = (2,1,0)$ 计算每个原子的相位项 $\\phi_j = 2\\pi (hx_j + ky_j + lz_j)$。\n- **原子 A**：$(x_A,y_A,z_A)=(0.25,\\,0.50,\\,0.00)$\n$$\n\\phi_A = 2\\pi (2 \\cdot 0.25 + 1 \\cdot 0.50 + 0 \\cdot 0.00) = 2\\pi (0.50 + 0.50) = 2\\pi\n$$\n- **原子 B**：$(x_B,y_B,z_B)=(0.10,\\,0.20,\\,0.30)$\n$$\n\\phi_B = 2\\pi (2 \\cdot 0.10 + 1 \\cdot 0.20 + 0 \\cdot 0.30) = 2\\pi (0.20 + 0.20) = 0.8\\pi\n$$\n- **原子 C**：$(x_C,y_C,z_C)=(0.40,\\,0.90,\\,0.60)$\n$$\n\\phi_C = 2\\pi (2 \\cdot 0.40 + 1 \\cdot 0.90 + 0 \\cdot 0.60) = 2\\pi (0.80 + 0.90) = 3.4\\pi\n$$\n由于指数函数是以 $2\\pi i$ 为周期的，因此 $\\exp(i 3.4\\pi) = \\exp(i (1.4\\pi + 2\\pi)) = \\exp(i 1.4\\pi)$。\n\n现在我们可以将结构因子 $F(210)$ 写成复数之和：\n$$\nF(210) = f_{A,\\text{eff}} \\exp(i\\phi_A) + f_{B,\\text{eff}} \\exp(i\\phi_B) + f_{C,\\text{eff}} \\exp(i\\phi_C)\n$$\n使用欧拉公式 $\\exp(i\\phi) = \\cos(\\phi) + i\\sin(\\phi)$，我们将 $F(210) = F_{\\text{real}} + i F_{\\text{imag}}$ 分离为实部和虚部。\n\n$$\nF_{\\text{real}} = f_{A,\\text{eff}}\\cos(\\phi_A) + f_{B,\\text{eff}}\\cos(\\phi_B) + f_{C,\\text{eff}}\\cos(\\phi_C)\n$$\n$$\nF_{\\text{imag}} = f_{A,\\text{eff}}\\sin(\\phi_A) + f_{B,\\text{eff}}\\sin(\\phi_B) + f_{C,\\text{eff}}\\sin(\\phi_C)\n$$\n代入数值：\n$$\nF_{\\text{real}} = 5.70 \\exp(-0.4) \\cos(2\\pi) + 3.70 \\exp(-1.0) \\cos(0.8\\pi) + 6.50 \\exp(-0.6) \\cos(1.4\\pi)\n$$\n$$\nF_{\\text{imag}} = 5.70 \\exp(-0.4) \\sin(2\\pi) + 3.70 \\exp(-1.0) \\sin(0.8\\pi) + 6.50 \\exp(-0.6) \\sin(1.4\\pi)\n$$\n我们对各项进行数值计算：\n$f_{A,\\text{eff}} \\approx 5.70 \\cdot (0.670320) = 3.820824$\n$f_{B,\\text{eff}} \\approx 3.70 \\cdot (0.367879) = 1.361154$\n$f_{C,\\text{eff}} \\approx 6.50 \\cdot (0.548812) = 3.567276$\n\n$\\cos(2\\pi) = 1$, $\\sin(2\\pi) = 0$\n$\\cos(0.8\\pi) \\approx -0.809017$\n$\\sin(0.8\\pi) \\approx 0.587785$\n$\\cos(1.4\\pi) \\approx -0.309017$\n$\\sin(1.4\\pi) \\approx -0.951057$\n\n实部和虚部的计算：\n$$\nF_{\\text{real}} \\approx (3.820824)(1) + (1.361154)(-0.809017) + (3.567276)(-0.309017)\n$$\n$$\nF_{\\text{real}} \\approx 3.820824 - 1.101211 - 1.102375 = 1.617238\n$$\n$$\nF_{\\text{imag}} \\approx (3.820824)(0) + (1.361154)(0.587785) + (3.567276)(-0.951057)\n$$\n$$\nF_{\\text{imag}} \\approx 0 + 0.799985 - 3.392662 = -2.592677\n$$\n结构因子的振幅 $|F(210)|$ 由下式给出：\n$$\n|F(210)| = \\sqrt{F_{\\text{real}}^2 + F_{\\text{imag}}^2}\n$$\n$$\n|F(210)| \\approx \\sqrt{(1.617238)^2 + (-2.592677)^2} \\approx \\sqrt{2.61545 + 6.72197} = \\sqrt{9.33742}\n$$\n$$\n|F(210)| \\approx 3.055719\n$$\n按照题目要求，将结果四舍五入到四位有效数字：\n$$\n|F(210)| \\approx 3.056\n$$\n单位是电子，因为原子散射因子 $f_j$ 是以电子为单位给出的。", "answer": "$$\n\\boxed{3.056}\n$$", "id": "2839287"}, {"introduction": "在获得结构因子——振幅来自实验测量，相位通过相位问题求解得到——之后，我们便可以重建生物大分子的电子密度图。这一过程通过傅里叶逆变换实现，即傅里叶合成，它是从衍射数据回到三维结构的关键步骤。本练习让你有机会利用给定的结构因子，在一个特定点上计算电子密度，从而巩固对傅里叶合成的理解 [@problem_id:2839279]。此外，该问题还引导你思考在实际计算中（如使用快速傅里叶变换FFT）会遇到的一些重要数值问题。", "problem": "一个空间群为 $P1$ 的大分子晶体具有立方晶胞，其晶胞参数 $a=b=c=10\\,\\text{\\AA}$，晶胞体积 $V=a\\,b\\,c$。对于一个仅有平移对称性的晶体，电子密度可定义为复结构因子的傅里叶逆变换，其中每个结构因子都写成极坐标形式 $F_{hkl}=\\lvert F_{hkl}\\rvert \\exp(i\\,\\varphi_{hkl})$。现给定一组结构因子振幅 $\\lvert F_{hkl}\\rvert$（单位：电子）和相位 $\\varphi_{hkl}$（单位：度），对应于以下密勒指数及其弗里德尔对：\n- $(h,k,l)=(1,0,0)$，其中 $\\lvert F_{100}\\rvert=80$ 且 $\\varphi_{100}=30^{\\circ}$；$(h,k,l)=(-1,0,0)$，其中 $\\lvert F_{-100}\\rvert=80$ 且 $\\varphi_{-100}=-30^{\\circ}$。\n- $(h,k,l)=(0,1,0)$，其中 $\\lvert F_{010}\\rvert=50$ 且 $\\varphi_{010}=60^{\\circ}$；$(h,k,l)=(0,-1,0)$，其中 $\\lvert F_{0-10}\\rvert=50$ 且 $\\varphi_{0-10}=-60^{\\circ}$。\n- $(h,k,l)=(0,0,1)$，其中 $\\lvert F_{001}\\rvert=70$ 且 $\\varphi_{001}=45^{\\circ}$；$(h,k,l)=(0,0,-1)$，其中 $\\lvert F_{00-1}\\rvert=70$ 且 $\\varphi_{00-1}=-45^{\\circ}$。\n- $(h,k,l)=(1,1,0)$，其中 $\\lvert F_{110}\\rvert=40$ 且 $\\varphi_{110}=120^{\\circ}$；$(h,k,l)=(-1,-1,0)$，其中 $\\lvert F_{-1-10}\\rvert=40$ 且 $\\varphi_{-1-10}=-120^{\\circ}$。\n\n假设晶体学相位原点位于晶胞原点，并使用分数坐标 $\\boldsymbol{r}=(x,y,z)$，其中 $x=\\tfrac{1}{4}$，$y=\\tfrac{1}{2}$，$z=\\tfrac{3}{4}$。请仅使用适用于 $P1$ 空间群的结构因子及其逆变换的基本定义，根据给定的衍射点数据计算该点处的电子密度 $\\rho(\\boldsymbol{r})$。三角函数中的角度必须以弧度为单位。\n\n然后，基于采样理论和算法实现，简要讨论在使用快速傅里叶变换 (FFT) 在离散网格上计算电子密度图时出现的两个数值计算方面的考量。\n\n将 $\\rho(\\boldsymbol{r})$ 的最终数值以电子/立方埃 $\\big(\\text{e}\\,\\text{\\AA}^{-3}\\big)$ 为单位表示，并四舍五入至四位有效数字。", "solution": "该问题要求计算晶体学晶胞内某特定点的电子密度，并在该背景下讨论与快速傅里叶变换（FFT）相关的数值计算考量。\n\n首先，确定问题的有效性。该问题设定在 X 射线晶体学的标准框架内，提供了所有必需的参数：晶胞尺寸、空间群、一组结构因子（振幅和相位）以及用于计算的坐标。所给条件是自洽的；对于每个衍射点 $\\boldsymbol{H}=(h,k,l)$，都提供了其弗里德尔对 $-\\boldsymbol{H}$，其振幅满足 $\\lvert F_{\\boldsymbol{H}}\\rvert = \\lvert F_{-\\boldsymbol{H}}\\rvert$，相位满足 $\\varphi_{\\boldsymbol{H}} = -\\varphi_{-\\boldsymbol{H}}$，这与非中心对称晶体的结构因子定义 $\\boldsymbol{F}_{-\\boldsymbol{H}} = \\boldsymbol{F}_{\\boldsymbol{H}}^*$ 相符。该问题具有科学依据、提法明确且客观。因此，可以推导出解答。\n\n在体积为 $V$ 的晶胞内，位置 $\\boldsymbol{r}=(x,y,z)$（以分数坐标表示）的电子密度 $\\rho(\\boldsymbol{r})$ 由结构因子 $F_{hkl}$ 的傅里叶逆变换给出。对于空间群 $P1$ 的一般情况，它仅具有平移对称性，该关系表示为一个傅里叶级数：\n$$\n\\rho(\\boldsymbol{r}) = \\frac{1}{V} \\sum_{h,k,l} F_{hkl} \\exp(-2\\pi i (hx + ky + lz))\n$$\n其中求和遍及所有密勒指数 $(h,k,l)$。结构因子 $F_{hkl}$ 是一个复数，可以写成极坐标形式 $F_{hkl} = \\lvert F_{hkl}\\rvert \\exp(i\\varphi_{hkl})$。\n\n题目提供了一个有限的衍射点列表。电子密度的计算将仅基于这些给定的项。$h=k=l=0$ 对应的项，即 $F_{000}$，它代表晶胞中的总电子数并贡献于平均电子密度，题中并未给出。因此，计算得出的是相对于平均电子密度的偏差在给定频率分量上的总和，而不是绝对电子密度。\n\n晶胞是立方的，$a=b=c=10\\,\\text{\\AA}$，所以体积是 $V = a^3 = (10\\,\\text{\\AA})^3 = 1000\\,\\text{\\AA}^3$。\n目标位置为 $\\boldsymbol{r}=(x,y,z)$，其中 $x=\\tfrac{1}{4}$，$y=\\tfrac{1}{2}$，$z=\\tfrac{3}{4}$。\n\n求和过程可以简化。因为电子密度是实数，求和中的虚部必须相互抵消。这种情况发生在对弗里德尔对 $(h,k,l)$ 和 $(-h,-k,-l)$ 的项进行求和时。这样一个对的和是：\n$$\nF_{hkl} \\exp(-2\\pi i \\boldsymbol{H} \\cdot \\boldsymbol{r}) + F_{-h-k-l} \\exp(-2\\pi i (-\\boldsymbol{H}) \\cdot \\boldsymbol{r})\n$$\n使用 $F_{-h-k-l} = F_{hkl}^*$，上式变为：\n$$\n\\lvert F_{hkl}\\rvert e^{i\\varphi_{hkl}} e^{-2\\pi i \\boldsymbol{H} \\cdot \\boldsymbol{r}} + \\lvert F_{hkl}\\rvert e^{-i\\varphi_{hkl}} e^{2\\pi i \\boldsymbol{H} \\cdot \\boldsymbol{r}} = \\lvert F_{hkl}\\rvert \\big( e^{i(\\varphi_{hkl} - 2\\pi \\boldsymbol{H} \\cdot \\boldsymbol{r})} + e^{-i(\\varphi_{hkl} - 2\\pi \\boldsymbol{H} \\cdot \\boldsymbol{r})} \\big)\n$$\n根据欧拉公式，上式可简化为 $2 \\lvert F_{hkl}\\rvert \\cos(\\varphi_{hkl} - 2\\pi \\boldsymbol{H} \\cdot \\boldsymbol{r})$，又因为 $\\cos(\\theta) = \\cos(-\\theta)$，这等价于 $2 \\lvert F_{hkl}\\rvert \\cos(2\\pi \\boldsymbol{H} \\cdot \\boldsymbol{r} - \\varphi_{hkl})$。\n\n电子密度则为：\n$$\n\\rho(\\boldsymbol{r}) = \\frac{1}{V} \\sum_{\\text{unique } hkl\\neq 0} 2 \\lvert F_{hkl}\\rvert \\cos(2\\pi(hx+ky+lz) - \\varphi_{hkl})\n$$\n求和是针对所提供的四个唯一的非原点衍射点进行的：$(1,0,0)$、$(0,1,0)$、$(0,0,1)$ 和 $(1,1,0)$。按照要求，所有相位角 $\\varphi_{hkl}$ 都必须从度转换为弧度。\n\n1.  来自 $(1,0,0)$ 对的贡献：\n    $\\lvert F_{100}\\rvert = 80$，$\\varphi_{100} = 30^{\\circ} = \\frac{\\pi}{6}$ 弧度。\n    余弦函数的自变量为 $2\\pi(1 \\cdot \\tfrac{1}{4} + 0 \\cdot \\tfrac{1}{2} + 0 \\cdot \\tfrac{3}{4}) - \\frac{\\pi}{6} = \\frac{\\pi}{2} - \\frac{\\pi}{6} = \\frac{\\pi}{3}$。\n    该项为 $2 \\cdot 80 \\cos(\\frac{\\pi}{3}) = 160 \\cdot \\frac{1}{2} = 80$。\n\n2.  来自 $(0,1,0)$ 对的贡献：\n    $\\lvert F_{010}\\rvert = 50$，$\\varphi_{010} = 60^{\\circ} = \\frac{\\pi}{3}$ 弧度。\n    余弦函数的自变量为 $2\\pi(0 \\cdot \\tfrac{1}{4} + 1 \\cdot \\tfrac{1}{2} + 0 \\cdot \\tfrac{3}{4}) - \\frac{\\pi}{3} = \\pi - \\frac{\\pi}{3} = \\frac{2\\pi}{3}$。\n    该项为 $2 \\cdot 50 \\cos(\\frac{2\\pi}{3}) = 100 \\cdot (-\\frac{1}{2}) = -50$。\n\n3.  来自 $(0,0,1)$ 对的贡献：\n    $\\lvert F_{001}\\rvert = 70$，$\\varphi_{001} = 45^{\\circ} = \\frac{\\pi}{4}$ 弧度。\n    余弦函数的自变量为 $2\\pi(0 \\cdot \\tfrac{1}{4} + 0 \\cdot \\tfrac{1}{2} + 1 \\cdot \\tfrac{3}{4}) - \\frac{\\pi}{4} = \\frac{3\\pi}{2} - \\frac{\\pi}{4} = \\frac{5\\pi}{4}$。\n    该项为 $2 \\cdot 70 \\cos(\\frac{5\\pi}{4}) = 140 \\cdot (-\\frac{\\sqrt{2}}{2}) = -70\\sqrt{2}$。\n\n4.  来自 $(1,1,0)$ 对的贡献：\n    $\\lvert F_{110}\\rvert = 40$，$\\varphi_{110} = 120^{\\circ} = \\frac{2\\pi}{3}$ 弧度。\n    余弦函数的自变量为 $2\\pi(1 \\cdot \\tfrac{1}{4} + 1 \\cdot \\tfrac{1}{2} + 0 \\cdot \\tfrac{3}{4}) - \\frac{2\\pi}{3} = 2\\pi(\\frac{3}{4}) - \\frac{2\\pi}{3} = \\frac{3\\pi}{2} - \\frac{2\\pi}{3} = \\frac{9\\pi - 4\\pi}{6} = \\frac{5\\pi}{6}$。\n    该项为 $2 \\cdot 40 \\cos(\\frac{5\\pi}{6}) = 80 \\cdot (-\\frac{\\sqrt{3}}{2}) = -40\\sqrt{3}$。\n\n这些贡献的总和是 $80 - 50 - 70\\sqrt{2} - 40\\sqrt{3} = 30 - 70\\sqrt{2} - 40\\sqrt{3}$。\n使用数值 $\\sqrt{2} \\approx 1.41421356$ 和 $\\sqrt{3} \\approx 1.73205081$：\n总和 $\\approx 30 - 70(1.41421356) - 40(1.73205081) = 30 - 98.994949 - 69.282032 = -138.276981$。\n\n最后，电子密度是这个总和除以体积 $V$：\n$$\n\\rho(\\boldsymbol{r}) = \\frac{-138.276981}{1000\\,\\text{\\AA}^3} = -0.138276981\\,\\text{e}\\,\\text{\\AA}^{-3}\n$$\n四舍五入到四位有效数字，结果是 $-0.1383\\,\\text{e}\\,\\text{\\AA}^{-3}$。\n\n问题的第二部分要求讨论在使用 FFT 在离散网格上计算电子密度图时的两个数值计算考量。\n\n1.  **采样率与混叠**：连续的电子密度函数 $\\rho(\\boldsymbol{r})$ 是通过对离散结构因子 $F_{hkl}$ 进行傅里叶逆变换，在真实空间的离散网格上计算的。奈奎斯特-香农采样定理规定了为避免混叠所需的网格间距，混叠是指高频信息损坏低频分量的现象。沿特定轴（例如 $a$ 轴）的数据中存在的最高频率由最大密勒指数 $h_{max}$ 决定。相应的空间频率是 $f_{max} = h_{max}/a$。为了无歧义地表示这个频率，采样频率 $f_s$ 必须大于 $f_{max}$ 的两倍。就 $a$ 轴上的网格点数 $N_a$ 而言，采样频率为 $f_s = N_a/a$。因此，条件为 $N_a/a > 2(h_{max}/a)$，可简化为 $N_a > 2h_{max}$。如果违反此条件（即真实空间网格过于粗糙），电子密度图中的高频细节将会“环绕”并扭曲低频处的图。这要求根据衍射数据的分辨率极限仔细选择 FFT 网格的维度。一个常用的经验法则是，为了同时考虑帕特森图中的特征，采样率应设为 $N_a > 4h_{max}$。\n\n2.  **FFT 算法效率与零填充**：快速傅里叶变换算法的计算效率高度依赖于每个维度上网格点数（$N_a, N_b, N_c$）的素因数分解。当这些数字是 2 的幂（Cooley-Tukey FFT）或者是高合成数（即拥有小的素因数）时，算法速度最快。由采样定理决定的最小网格尺寸（$N_a > 2h_{max}$ 等）可能是一个大素数，这会使 FFT 的计算效率低下。为了解决这个问题，通常会对结构因子数组进行“零填充”，将其维度扩展到附近的一个高合成数。例如，如果 $2h_{max} + 1 = 127$，可以将数据嵌入到一个 $128 \\times 128 \\times 128$ 的网格中（$128=2^7$）。这种被称为零填充的做法有两个目的：它通过允许使用高效的 FFT 程序来确保计算速度，并且它在真实空间中有效地对电子密度图进行插值（一种 sinc 插值形式），从而产生更平滑、网格更精细的图，而不会增加任何新的高分辨率信息。", "answer": "$$\n\\boxed{-0.1383}\n$$", "id": "2839279"}, {"introduction": "在真实的结构生物学实验中，我们收集到的数据几乎总是存在某种形式的缺失，例如受限于分辨率、样品台遮挡或各向异性衍射。根据傅里叶变换的卷积定理，倒易空间中的数据截断会在实空间的电子密度图中引入可预测的系统性伪影，如密度图中的涟漪效应和形变。本练习旨在挑战你分析这些伪影的来源，并评估如何通过“切趾”（apodization）等方法来减弱它们的影响 [@problem_id:2839248]。通过这个过程，你将培养出审视电子密度图质量的批判性思维。", "problem": "一位晶体学家和一位低温电子显微镜（cryo-EM）从业者正在比较由具有不同类型不完整性的倒易空间数据重建的实空间电子密度图。在这两种情况下，重建的电子密度图都是通过对测量的傅里叶变换乘以一个倒易空间掩模后进行傅里叶逆变换得到的。设真实的电子密度为 $\\rho(\\mathbf{r})$，其傅里叶变换为 $\\hat{\\rho}(\\mathbf{s})$，其中 $\\mathbf{s}$ 是空间频率矢量，其大小为 $s = 1/d$（其中 $d$ 的单位为 $\\text{\\AA}$）。重建的电子密度图为 $\\tilde{\\rho}(\\mathbf{r}) = \\mathcal{F}^{-1}\\{\\hat{\\rho}(\\mathbf{s}) M(\\mathbf{s})\\}$，其中 $M(\\mathbf{s})$ 是一个二值或锥化的掩模，用于编码保留了哪些频率。\n\n情况 X（X射线晶体学）：由于各向异性，数据在一个倒易空间轴上测量到了 $d_{\\min} = 2.0\\,\\text{\\AA}$ 的表观高分辨率极限，但在正交轴上仅测量到 $d_{\\min} = 3.0\\,\\text{\\AA}$。同时，由于束流截止器（beamstop）的存在，缺少了低分辨率数据（$d > 50\\,\\text{\\AA}$）。该电子密度图最初是使用在 $d_{\\min}$ 处的硬高分辨率截断和一个硬低频空洞进行重建的（即 $M(\\mathbf{s})$ 在一个各向异性的壳层内部为1，其他地方为0）。\n\n情况 E（低温电子显微镜断层成像）：倾斜的几何构型在倒易空间中产生了一个缺失楔（missing wedge）（即 $M(\\mathbf{s})$ 在一个楔形区域的方向上为0），并且从业者在计算傅里叶变换之前，应用了一个具有完美锐利边缘的二值实空间掩模，以将重建限制在颗粒的支撑区域内。\n\n您仅可假设以下基本原理：\n- 卷积定理：倒易空间中的乘法对应于实空间中的卷积，因此 $\\tilde{\\rho}(\\mathbf{r}) = (\\rho \\ast m)(\\mathbf{r})$，其中 $m(\\mathbf{r}) = \\mathcal{F}^{-1}\\{M(\\mathbf{s})\\}$ 是点扩散函数（PSF）。\n- 倒易空间中更平滑的函数通常在实空间中产生衰减更快的核函数，而一个域中的突变边缘会在另一个域中产生振荡的旁瓣（类似吉布斯现象的涟漪）。\n- 一个域中的各向异性通过傅里叶变换映射到共轭域中的各向异性。\n\n研究人员考虑了以下处理策略：\n- 在外部高分辨率边缘使用宽度为 $\\Delta s = 0.1\\,\\text{\\AA}^{-1}$ 的升余弦（Tukey）锥化函数来代替硬截断。\n- 在内部低频边缘使用宽度为 $\\Delta s = 0.02\\,\\text{\\AA}^{-1}$ 的升余弦锥化函数来软化束流截止器造成的空洞。\n- 对所有保留的傅里叶系数应用 $B = -50\\,\\text{\\AA}^2$ 的各向同性负B因子锐化。\n- 各向异性切趾，使 $M(\\mathbf{s})$ 在一个与测量的各向异性相匹配的椭球面上平滑地锥化至零。\n- 晶体学中的体溶剂模型，用于估计和填充缺失的低分辨率结构因子。\n\n关于观察到的实空间伪影的来源以及所提出补救措施的可能效果，以下哪些陈述可以从上述原理中正确地推导出来？选择所有适用的选项。\n\nA. 在 $d_{\\min} = 2.0\\,\\text{\\AA}$ 处的硬高分辨率截断会在锐利的密度特征周围产生振荡旁瓣（截断涟漪），因为 $M(\\mathbf{s})$ 有一个锐利的边界；在外部边缘使用升余弦锥化可以减少这些涟漪，但代价是峰会稍微变宽。\n\nB. 缺失的低分辨率数据（$d > 50\\,\\text{\\AA}$）起到了高通滤波器的作用，它会强调边缘，并可能产生看起来中空的大分子密度；对低频边缘进行锥化和/或使用体溶剂模型通过恢复或平滑地融合平均密度来减少中空伪影。\n\nC. 使用 $B = -50\\,\\text{\\AA}^2$ 的各向同性负B因子锐化通常会抑制高分辨率的截断涟漪，并通过补偿缺失的频率来校正各向异性的拉伸。\n\nD. 各向异性的截断（椭球极限或缺失楔）会导致方向依赖的点扩散函数（PSF）以及沿采样不足方向的拉伸或条纹；与各向异性相匹配的各向异性切趾可以减少方向性的涟漪，而不会凭空制造缺失的信息。\n\nE. 在低温电子显微镜中，傅里叶重建前应用具有完美锐利边缘的硬实空间掩模，通过限制支撑区域来抑制由数据缺失引起的傅里叶振铃，从而减少倒易空间中的振荡。", "solution": "题目陈述已经过验证，被认为是科学上合理的、问题定义清晰的，并且基于傅里叶分析应用于结构生物学的既定原理。我现在将逐一评估每个选项。\n\n控制重建的核心关系是 $\\tilde{\\rho}(\\mathbf{r}) = \\mathcal{F}^{-1}\\{\\hat{\\rho}(\\mathbf{s}) M(\\mathbf{s})\\}$。根据卷积定理，这等同于 $\\tilde{\\rho}(\\mathbf{r}) = (\\rho \\ast m)(\\mathbf{r})$，其中 $m(\\mathbf{r}) = \\mathcal{F}^{-1}\\{M(\\mathbf{s})\\}$ 是点扩散函数（PSF）。因此，重建图 $\\tilde{\\rho}(\\mathbf{r})$ 的性质是由真实图 $\\rho(\\mathbf{r})$ 与点扩散函数 $m(\\mathbf{r})$ 的卷积决定的，而点扩散函数 $m(\\mathbf{r})$ 又是倒易空间掩模 $M(\\mathbf{s})$ 的傅里叶逆变换。\n\n**对选项 A 的评估：**\n该陈述涉及硬高分辨率截断，这意味着掩模 $M(\\mathbf{s})$ 是一个二值函数，在某个最大空间频率 $s_{\\max} = 1/d_{\\min}$ 处突然降为零。在此情况下，$d_{\\min}$ 被给出为 $2.0\\,\\text{\\AA}$。根据所提供的原理——一个域中的突变边缘会在另一个域中产生振荡旁瓣——$M(\\mathbf{s})$ 中的锐利截断将产生一个振荡的点扩散函数（PSF） $m(\\mathbf{r})$。这些振荡就是“旁瓣”。因此，卷积 $\\rho \\ast m$ 会将这些振荡印在重建的图 $\\tilde{\\rho}(\\mathbf{r})$ 上，尤其是在真实密度 $\\rho(\\mathbf{r})$ 中的锐利特征（如原子位置）周围。这种现象被正确地识别为截断涟漪。\n\n升余弦锥化是一种切趾（apodization）方法，其中 $M(\\mathbf{s})$ 的锐利边缘被一个平滑函数所取代，该函数在一个有限区间（此处指定为 $\\Delta s = 0.1\\,\\text{\\AA}^{-1}$）内逐渐衰减至零。这使得 $M(\\mathbf{s})$ 成为一个更平滑的函数。原理指出，倒易空间中更平滑的函数会在实空间中产生衰减更快的核函数。一个衰减更快、振荡更少的点扩散函数 $m(\\mathbf{r})$，在卷积后，将在 $\\tilde{\\rho}(\\mathbf{r})$ 中产生更少和更弱的涟漪。其代价是，锥化处理降低了最高分辨率傅里葉系数的权重，这等同于与一个中心峰更宽的点扩散函数进行卷积。更宽的点扩散函数会导致最终图中出现更宽的峰，这是一种有效分辨率的轻微损失。该陈述准确地描述了整个过程及其利弊权衡。\n\n结论：**正确**。\n\n**对选项 B 的评估：**\n该陈述探讨了缺失低分辨率数据（特别是 $d > 50\\,\\text{\\AA}$）的后果，这对应于在空间频率 $s < 1/(50\\,\\text{\\AA}) = 0.02\\,\\text{\\AA}^{-1}$ 处掩模 $M(\\mathbf{s})$ 中存在一个空洞。移除信号的最低频率成分是高通滤波器的定义。原点处的傅里叶系数 $\\hat{\\rho}(\\mathbf{s}=0)$ 代表函数 $\\rho(\\mathbf{r})$ 的平均值。移除它及其邻近系数会导致图中的平均密度水平不正确，通常会在高密度区域周围产生一个负的凹陷，从而造成一种被称为“看起来中空”的大分子的伪影。\n\n提出的补救措施是对低频边缘进行锥化和使用体溶剂模型。用宽度为 $\\Delta s = 0.02\\,\\text{\\AA}^{-1}$ 的升余弦函数对边缘进行锥化，平滑了在原点附近从 $M(\\mathbf{s})=0$ 到 $M(\\mathbf{s})=1$ 的过渡。根据与选项 A 相同的逻辑，这避免了傅里叶分量的突兀引入，从而减轻了与数据中锐利“空洞”相关的严重振荡伪影（在这种情况下是大的负值波谷）。体溶剂模型是一种更具物理动机的方法，它基于结构的低分辨率模型（例如，分子和周围的平坦溶剂）来估计缺失的低分辨率傅里叶系数的值。这“填补”了缺失的数据，直接恢复了关于物体整体形状和平均密度的关键低频信息。两种方法都有助于减少这种伪影。\n\n结论：**正确**。\n\n**对选项 C 的评估：**\n该陈述声称，各向同性的负B因子锐化会抑制截断涟漪并校正各向异性。B因子是通过将系数 $\\hat{\\rho}(\\mathbf{s})$ 乘以一个指数因子 $\\exp(-B s^2/4)$ 来应用的。对于一个负B值，如 $B = -50\\,\\text{\\AA}^2$，该因子随着空间频率 $s=|\\mathbf{s}|$ 的增加而增加。此操作相对于低分辨率项放大了高分辨率项。\n\n截断涟漪源于数据的突兀截断。在截断前放大数据会使过渡更加突兀，这将*加剧*而非抑制由此产生的涟漪。其次，问题指出数据限制是各向异性的（$d_{\\min} = 2.0\\,\\text{\\AA}$ vs $d_{\\min} = 3.0\\,\\text{\\AA}$），而提议的锐化是*各向同性*的，意味着对于给定的半径 $s$，其效果在所有方向上都是均匀的。应用各向同性的操作无法校正各向异性的缺陷。它会在所有方向上锐化密度图，但不会修复方向性的分辨率差异或由此产生的拉伸。最后，锐化重新加权了*已测量*的傅里叶系数；它不会“补偿”超出分辨率极限的“缺失频率”。它不能创造不存在的信息。该陈述在这三点上都是错误的。\n\n结论：**不正确**。\n\n**对选项 D 的评估：**\n该陈述涉及各向异性数据截断，例如情况 X 中的椭球分辨率极限或情况 E 中的缺失楔。这意味着掩模 $M(\\mathbf{s})$ 不是球对称的。傅里叶各向异性原理指出，一个域中的各向异性会映射到共轭域中。因此，一个各向异性的掩模 $M(\\mathbf{s})$ 将产生一个各向异性的点扩散函数（PSF） $m(\\mathbf{r})$。傅里叶变换的一个基本性质是，一个域中在一个方向上的约束会导致共轭域中在同一方向上的拉伸。因此，沿着特定倒易空间方向（例如，椭球体的“薄”轴或垂直于楔形平面的方向）的有限采样，会导致一个在相应实空间方向上被拉长的点扩散函数，从而使图中的特征变得模糊或出现条纹。这一点陈述正确。\n\n各向异性切趾是应用一个形状与数据各向异性边界相匹配的平滑锥化函数。这将 $M(\\mathbf{s})$ 的锐利、各向异性边缘替换为一个平滑的边缘。正如在对选项 A 的分析中所确立的，平滑掩模边界会抑制点扩散函数的旁瓣，从而减少相关的实空间涟漪。因为切趾与各向异性相匹配，所以它能正确地处理这些涟漪的方向性。该陈述正确地指出，这个过程不会凭空制造缺失的信息；它仅仅是减轻了由可用信息的锐利截断所引起的伪影。\n\n结论：**正确**。\n\n**对选项 E 的评估：**\n该陈述提出，应用锐利的实空间掩模会减少倒易空间中的振荡。这与所提供的原理直接矛盾。卷积定理双向适用：一个域中的乘法是另一个域中的卷积。将一个具有“完美锐利边缘”的实空间掩模（我们称之为 $w(\\mathbf{r})$）应用于密度图 $\\rho(\\mathbf{r})$，得到乘积 $\\rho(\\mathbf{r})w(\\mathbf{r})$。该乘积的傅里叶变换是它们各自变换的卷积：$\\mathcal{F}\\{\\rho(\\mathbf{r})w(\\mathbf{r})\\} = (\\hat{\\rho} \\ast \\hat{w})(\\mathbf{s})$。\n\n根据傅里叶对偶性原理，实空间掩模 $w(\\mathbf{r})$ 的锐利边缘意味着其傅里叶变换 $\\hat{w}(\\mathbf{s})$ 必定是振荡且缓慢衰减的（例如，对于盒状掩模，是sinc函数）。将真实的傅里叶变换 $\\hat{\\rho}(\\mathbf{s})$ 与这个振荡函数 $\\hat{w}(\\mathbf{s})$ 进行卷积，会将这些振荡引入到倒易空间表示中，这种现象被称为傅里叶相关泄漏。这种操作远非“减少倒易空间中的振荡”，而是生成了振荡。这会人为地将信号扩散到倒易空间中本不应有信号的区域，包括缺失楔，这对许多算法来说是一个主要问题。该陈述从根本上误解了锐利度与振荡之间的傅里叶关系。\n\n结论：**不正确**。", "answer": "$$\\boxed{ABD}$$", "id": "2839248"}]}