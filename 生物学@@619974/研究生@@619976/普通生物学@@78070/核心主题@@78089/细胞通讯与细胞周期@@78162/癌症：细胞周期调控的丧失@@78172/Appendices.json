{"hands_on_practices": [{"introduction": "从$G_1$期到$S$期的转变由一个涉及视网膜母细胞瘤蛋白（Rb）和E2F转录因子的关键开关控制。定量地理解这个开关是掌握癌症中细胞周期失调的关键。本练习将挑战你运用生物化学平衡的基本原理来为这一相互作用建模，推导影响Rb与E2F结合亲和力的突变如何定量地改变驱动增殖的转录信号[@problem_id:2781000]。通过这个练习，你将亲身体会分子层面的微小变化是如何在细胞信号网络中被放大的。", "problem": "在增殖的哺乳动物细胞中，视网膜母细胞瘤蛋白 (Rb) 会结合并抑制E2启动子结合因子 (E2F)，从而抑制由E2F驱动的转录。考虑一个单一的核池，其中结合平衡相对于转录读出发生得很快，Rb和E2F在其中形成一个可逆的一对一复合物。设Rb和E2F的总核浓度分别为$R_T$和$E_T$，并用$K_d$表示野生型相互作用的解离常数。Rb中的一个错义突变使其对E2F的亲和力降低了十倍；等效地，突变体的解离常数为$10K_d$。假设转录输出与游离（未结合）E2F的浓度成正比，并且在测量的时间尺度内没有其他调控过程发生变化。不要对$R_T$和$E_T$作任何特定极限情况的假设。\n\n仅使用质量作用平衡和质量守恒作为基本依据，推导由该突变引起的E2F转录输出的倍数变化$F$，其定义为\n$$\nF \\equiv \\frac{\\text{突变型Rb下的游离E2F}}{\\text{野生型Rb下的游离E2F}}。\n$$\n请将您的最终答案表示为仅含$R_T$、$E_T$和$K_d$的单个闭式解析表达式。无需进行数值计算。答案是无量纲的，请勿包含单位。", "solution": "问题陈述已解析和验证。\n\n已知条件：\n1.  系统：在单一核池中，视网膜母细胞瘤蛋白 (Rb) 和E2启动子结合因子 (E2F) 形成可逆的一对一复合物。\n2.  平衡：结合过程 $Rb + E2F \\rightleftharpoons Rb \\cdot E2F$ 假定处于平衡状态。\n3.  总浓度：Rb和E2F的总浓度分别表示为$R_T$和$E_T$。\n4.  解离常数：野生型的解离常数为$K_d$。Rb中的一个突变使解离常数增加十倍，变为$10K_d$。\n5.  转录输出：输出与游离（未结合）E2F的浓度成正比。\n6.  目标：推导倍数变化$F$，其定义为突变型Rb下的游离E2F与野生型Rb下的游离E2F的浓度之比。\n7.  约束条件：推导必须仅使用质量作用平衡和质量守恒。不得对$R_T$和$E_T$作任何极限情况的假设。\n\n验证：\n该问题具有科学依据，是良定且客观的。它描述了一个标准的生物化学平衡模型，这是定量生物学和药理学的一块基石。问题的前提条件一致，并提供了足够的信息来推导出唯一解。Rb-E2F相互作用模型是细胞周期调控中一个有效且基本的概念。因此，该问题被认定为有效，并将提供解决方案。\n\n推导过程：\n我们首先根据质量作用平衡和质量守恒建立该系统的控制方程。令$[R]$、$[E]$和$[C]$分别表示游离Rb、游离E2F和Rb-E2F复合物的平衡浓度。\n\n各物种的质量守恒方程如下：\n$$R_T = [R] + [C] \\quad (1)$$\n$$E_T = [E] + [C] \\quad (2)$$\n\n解离平衡的质量作用定律为：\n$$K_d = \\frac{[R][E]}{[C]} \\quad (3)$$\n\n我们的目标是找到一个用总浓度$R_T$、$E_T$和解离常数$K_d$表示$[E]$的表达式。我们可以利用方程(1)和(2)将$[R]$和$[C]$用$[E]$表示：\n由方程(2)可得：\n$$[C] = E_T - [E] \\quad (4)$$\n将方程(4)代入方程(1)：\n$$[R] = R_T - [C] = R_T - (E_T - [E]) = R_T - E_T + [E] \\quad (5)$$\n\n现在，我们将方程(4)和(5)代入平衡表达式，即方程(3)：\n$$K_d = \\frac{(R_T - E_T + [E])[E]}{E_T - [E]}$$\n\n为了求解$[E]$，我们将此方程重排为标准二次方程形式，$a x^2 + b x + c = 0$，其中$x = [E]$：\n$$K_d(E_T - [E]) = (R_T - E_T)[E] + [E]^2$$\n$$K_d E_T - K_d [E] = (R_T - E_T)[E] + [E]^2$$\n$$[E]^2 + (R_T - E_T)[E] + K_d [E] - K_d E_T = 0$$\n$$[E]^2 + (R_T - E_T + K_d)[E] - K_d E_T = 0 \\quad (6)$$\n\n我们使用二次方程求根公式来求解$[E]$：\n$$[E] = \\frac{-(R_T - E_T + K_d) \\pm \\sqrt{(R_T - E_T + K_d)^2 - 4(1)(-K_d E_T)}}{2(1)}$$\n$$[E] = \\frac{-(R_T - E_T + K_d) \\pm \\sqrt{(R_T - E_T + K_d)^2 + 4 K_d E_T}}{2}$$\n\n由于浓度必须是一个非负的物理量，即$[E] \\ge 0$，我们必须选择正确的根。平方根下的项是严格为正的。平方根项的绝对值总是大于分子中第一项的绝对值$|-(R_T - E_T + K_d)|$。因此，只有取正号才能得到有物理意义的（正）浓度。\n\n设$[E]_{wt}$为野生型情况下游离E2F的浓度。其表达式为：\n$$[E]_{wt} = \\frac{-(R_T - E_T + K_d) + \\sqrt{(R_T - E_T + K_d)^2 + 4 K_d E_T}}{2}$$\n\n对于突变型情况，分析过程完全相同，只是解离常数变为$K_d' = 10 K_d$。我们将$[E]_{wt}$表达式中的$K_d$替换为$10 K_d$，以求得突变体的游离E2F浓度$[E]_{mut}$：\n$$[E]_{mut} = \\frac{-(R_T - E_T + 10 K_d) + \\sqrt{(R_T - E_T + 10 K_d)^2 + 4(10 K_d)E_T}}{2}$$\n$$[E]_{mut} = \\frac{-(R_T - E_T + 10 K_d) + \\sqrt{(R_T - E_T + 10 K_d)^2 + 40 K_d E_T}}{2}$$\n\n问题陈述指出，转录输出与游离E2F浓度成正比。倍数变化$F$定义为突变体输出与野生型输出之比，这可以简化为游离E2F浓度之比：\n$$F = \\frac{[E]_{mut}}{[E]_{wt}}$$\n\n代入推导出的$[E]_{mut}$和$[E]_{wt}$的表达式：\n$$F = \\frac{\\frac{-(R_T - E_T + 10 K_d) + \\sqrt{(R_T - E_T + 10 K_d)^2 + 40 K_d E_T}}{2}}{\\frac{-(R_T - E_T + K_d) + \\sqrt{(R_T - E_T + K_d)^2 + 4 K_d E_T}}{2}}$$\n\n分子和分母中的因子$\\frac{1}{2}$相互抵消，得到倍数变化$F$的最终闭式表达式：\n$$F = \\frac{-(R_T - E_T + 10 K_d) + \\sqrt{(R_T - E_T + 10 K_d)^2 + 40 K_d E_T}}{-(R_T - E_T + K_d) + \\sqrt{(R_T - E_T + K_d)^2 + 4 K_d E_T}}$$\n此表达式仅由给定的参数$R_T$、$E_T$和$K_d$表示，符合题目要求。", "answer": "$$\n\\boxed{\\frac{-(R_T - E_T + 10 K_d) + \\sqrt{(R_T - E_T + 10 K_d)^2 + 40 K_d E_T}}{-(R_T - E_T + K_d) + \\sqrt{(R_T - E_T + K_d)^2 + 4 K_d E_T}}}\n$$", "id": "2781000"}, {"introduction": "虽然分子开关控制着单个细胞的行为，但癌症是一种细胞群体不受控制增长的疾病。流式细胞术为我们提供了细胞群体DNA含量的静态快照，但我们如何从中推断出每个细胞周期阶段持续时间等动态信息呢？本练习将指导你应用一个年龄结构的群体模型，将实验可测量的各阶段细胞比例与指数增长的肿瘤群体中潜在的细胞周期动力学联系起来[@problem_id:2780996]。这个技能对于解读实验数据和评估癌细胞增殖速率至关重要。", "problem": "一个异步分裂的肿瘤细胞群体，由于典型检验点控制的丧失而处于平衡指数增长状态，导致细胞缺乏静止期或停滞。对脱氧核糖核酸（DNA）含量的流式细胞术去卷积分析显示，按DNA含量计算的各时期细胞分数如下：$G_1$期为$0.55$，$S$期为$0.30$，$G_2/M$期为$0.15$。假设细胞周期是确定性的，具有固定顺序 $G_1 \\to S \\to G_2/M \\to$ 分裂，无细胞死亡，且所有细胞的周期时间相同。独立测量得出$S$期的持续时间为$8$小时。使用分支过程的年龄结构指数增长的基本原理，推断$G_1$期和$G_2/M$期的持续时间以及群体倍增时间。\n\n你的推导必须基于以下事实开始：(i) 在平衡指数增长中，整个周期内细胞的年龄密度是非均匀的，并取决于马尔萨斯参数 $\\lambda$，以及 (ii) 每次有丝分裂产生两个子细胞，其生成时间固定。证明你用于将观测到的时期分数与未知持续时间和 $\\lambda$ 关联起来的任何表达式的合理性。\n\n- 报告三个时期的持续时间 $T_{G1}$、$T_{S}$、$T_{G2/M}$ 以及倍增时间 $T_{d}$。\n- 所有答案以小时为单位。\n- 将每个报告的数值四舍五入到三位有效数字。", "solution": "在尝试求解之前，对问题进行验证。\n\n已知条件逐字提取如下：\n- 一个异步分裂的肿瘤细胞群体。\n- 增长是平衡指数增长。\n- 典型检验点控制的丧失，导致缺乏静止期或停滞。\n- 对DNA含量的流式细胞术去卷积分析显示各时期分数：$G_1$期为$0.55$，$S$期为$0.30$，$G_2/M$期为$0.15$。\n- 确定性的细胞周期，具有固定顺序 $G_1 \\to S \\to G_2/M \\to$ 分裂。\n- 无细胞死亡。\n- 所有细胞的周期时间相同。\n- $S$期持续时间为$8$小时。\n- 推导必须从分支过程的年龄结构指数增长原理开始，特别是 (i) 年龄密度是非均匀的，并取决于马尔萨斯参数 $\\lambda$，以及 (ii) 每次有丝分裂产生两个子细胞。\n- 要求输出：$T_{G1}$、$T_S$、$T_{G2/M}$ 和 $T_d$，四舍五入到三位有效数字，单位为小时。\n\n验证结论：\n该问题具有科学依据，是良定的、客观的。它描述了一个标准的、尽管是理想化的细胞群体动力学模型（年龄结构种群模型，通常与 Collins、Richmond 和 Steel 的研究相关）。所提供的数据是自洽的（$0.55 + 0.30 + 0.15 = 1.0$），并且足以求得唯一解。诸如无细胞死亡和细胞周期时间相同等假设，是在此类模型中为建立基线而使用的常见简化。该问题是可形式化的，并需要非平凡地应用数学生物学原理。因此，该问题被认为是一个有效问题。\n\n求解过程如下。\n设 $N(t)$ 为时间 $t$ 时的细胞总数。对于处于平衡指数增长的群体，$N(t) = N_0 \\exp(\\lambda t)$，其中 $\\lambda$ 是马尔萨斯参数或比增长率。群体倍增时间 $T_d$ 是群体数量加倍所需的时间，因此有 $N_0 \\exp(\\lambda T_d) = 2 N_0$。由此得出基本关系 $\\lambda T_d = \\ln(2)$。\n\n问题要求推导必须从群体的年龄结构开始。设 $a$ 为细胞年龄，定义为细胞通过有丝分裂诞生后所经过的时间。细胞周期的总持续时间是固定的，为 $T_C$。在一个经历平衡指数增长的群体中，年龄密度分布是不均匀的；年轻细胞比年老细胞多。年龄在 $a$ 和 $a+da$ 之间的细胞数量与 $\\exp(-\\lambda a)$ 成正比。\n\n对于一个每个细胞分裂成两个子细胞的自我维持的分支过程，其关键条件是更新方程。在任何给定时间，细胞出生率必须是细胞分裂率的两倍。给定年龄 $a$ 的细胞通量与该年龄的数量密度成正比。因此，年龄为 $a \\approx 0$ 的细胞数量必须是年龄为 $a \\approx T_C$ 的细胞数量的两倍。这为年龄分布提供了约束条件：\n$N(a=0) = 2 N(a=T_C)$\n鉴于数量密度 $N(a)$ 与 $\\exp(-\\lambda a)$ 成正比，我们有：\n$C \\exp(-\\lambda \\cdot 0) = 2 C \\exp(-\\lambda T_C)$\n其中 $C$ 是一个比例常数。这可以简化为 $1 = 2 \\exp(-\\lambda T_C)$，可重排为 $\\exp(\\lambda T_C) = 2$。取自然对数得出 $\\lambda T_C = \\ln(2)$。\n将此与倍增时间的方程 $\\lambda T_d = \\ln(2)$ 比较，我们发现 $T_d = T_C$。这是理想化模型假设的一个逻辑结果：在没有细胞死亡的情况下，整个群体数量加倍所需的时间必须等于单个细胞完成其周期并分裂所需的时间。\n\n处于给定时期 $P$（从年龄 $a_{start}$ 开始到 $a_{end}$ 结束）的细胞分数 $F_P$，是该时期细胞数与总细胞数的比率。这可以通过对该时期的年龄分布进行积分，并除以对整个细胞周期的积分来进行归一化求得。\n$$ F_P = \\frac{\\int_{a_{start}}^{a_{end}} \\exp(-\\lambda a) da}{\\int_{0}^{T_C} \\exp(-\\lambda a) da} $$\n分母为 $\\int_{0}^{T_C} \\exp(-\\lambda a) da = [-\\frac{1}{\\lambda}\\exp(-\\lambda a)]_0^{T_C} = \\frac{1}{\\lambda}(1 - \\exp(-\\lambda T_C))$。\n由于 $\\exp(-\\lambda T_C) = 1/2$，分母为 $\\frac{1}{\\lambda}(1 - 1/2) = \\frac{1}{2\\lambda}$。\n分子为 $\\int_{a_{start}}^{a_{end}} \\exp(-\\lambda a) da = \\frac{1}{\\lambda}(\\exp(-\\lambda a_{start}) - \\exp(-\\lambda a_{end}))$。\n因此，时期 $P$ 中的细胞分数为：\n$$ F_P = \\frac{\\frac{1}{\\lambda}(\\exp(-\\lambda a_{start}) - \\exp(-\\lambda a_{end}))}{\\frac{1}{2\\lambda}} = 2(\\exp(-\\lambda a_{start}) - \\exp(-\\lambda a_{end})) $$\n我们已知各时期分数：$F_{G_1} = 0.55$，$F_S = 0.30$，以及 $F_{G_2/M} = 0.15$。细胞周期各时期以 $G_1 \\to S \\to G_2/M$ 的顺序发生。年龄边界如下：\n- $G_1$期：$a_{start}=0$, $a_{end}=T_{G1}$\n- $S$期：$a_{start}=T_{G1}$, $a_{end}=T_{G1}+T_S$\n- $G_2/M$期：$a_{start}=T_{G1}+T_S$, $a_{end}=T_C = T_{G1}+T_S+T_{G2/M}$\n\n将 $F_P$ 的公式应用于 $G_1$ 期和 $S$ 期：\n对于 $G_1$ 期：$F_{G_1} = 2(1 - \\exp(-\\lambda T_{G1}))$\n对于 $S$ 期：$F_S = 2(\\exp(-\\lambda T_{G1}) - \\exp(-\\lambda(T_{G1}+T_S))) = 2\\exp(-\\lambda T_{G1})(1 - \\exp(-\\lambda T_S))$\n\n从 $G_1$ 期分数的方程中，我们可以表示出 $\\exp(-\\lambda T_{G1})$：\n$\\exp(-\\lambda T_{G1}) = 1 - \\frac{F_{G_1}}{2}$。\n将此代入 $S$ 期分数的方程：\n$F_S = 2(1 - \\frac{F_{G_1}}{2})(1 - \\exp(-\\lambda T_S)) = (2 - F_{G1})(1 - \\exp(-\\lambda T_S))$\n\n我们已知 $F_{G_1} = 0.55$, $F_S = 0.30$, 以及 $T_S = 8$ 小时。我们可以用这个方程来求解 $\\lambda$：\n$0.30 = (2 - 0.55)(1 - \\exp(-\\lambda \\cdot 8))$\n$0.30 = 1.45(1 - \\exp(-8\\lambda))$\n$\\frac{0.30}{1.45} = 1 - \\exp(-8\\lambda)$\n$\\exp(-8\\lambda) = 1 - \\frac{0.30}{1.45} = 1 - \\frac{6}{29} = \\frac{23}{29}$\n取自然对数：\n$-8\\lambda = \\ln(\\frac{23}{29})$\n$\\lambda = -\\frac{1}{8}\\ln(\\frac{23}{29}) = \\frac{1}{8}\\ln(\\frac{29}{23})$\n$\\lambda \\approx \\frac{1}{8} \\ln(1.26087) \\approx \\frac{0.23180}{8} \\approx 0.028975 \\text{ hours}^{-1}$。\n\n现在我们可以确定未知的持续时间。\n首先，我们使用 $F_{G_1}$ 的方程来求解 $T_{G1}$：\n$F_{G_1} = 2(1 - \\exp(-\\lambda T_{G1}))$\n$0.55 = 2(1 - \\exp(-\\lambda T_{G1}))$\n$0.275 = 1 - \\exp(-\\lambda T_{G1})$\n$\\exp(-\\lambda T_{G1}) = 0.725$\n$-\\lambda T_{G1} = \\ln(0.725)$\n$T_{G1} = \\frac{-\\ln(0.725)}{\\lambda} = \\frac{-\\ln(0.725)}{\\frac{1}{8}\\ln(\\frac{29}{23})} \\approx \\frac{-(-0.32155)}{0.028975} \\approx 11.0975$ 小时。\n\n接下来，我们求解倍增时间 $T_d$，它等于细胞周期时间 $T_C$：\n$T_d = T_C = \\frac{\\ln(2)}{\\lambda} = \\frac{\\ln(2)}{\\frac{1}{8}\\ln(\\frac{29}{23})} = \\frac{8\\ln(2)}{\\ln(\\frac{29}{23})}$\n$T_d \\approx \\frac{8 \\times 0.69315}{0.23180} \\approx 23.922$ 小时。\n\n最后，我们通过减法确定 $T_{G2/M}$，因为 $T_C = T_{G1} + T_S + T_{G2/M}$：\n$T_{G2/M} = T_C - T_{G1} - T_S$\n$T_{G2/M} \\approx 23.922 - 11.0975 - 8 = 4.8245$ 小时。\n\n问题要求报告三个时期的持续时间（$T_{G1}, T_S, T_{G2/M}$）和倍增时间（$T_d$），并四舍五入到三位有效数字。\n$T_{G1} \\approx 11.1$ 小时。\n$T_S = 8.00$ 小时（已知）。\n$T_{G2/M} \\approx 4.82$ 小时。\n$T_d \\approx 23.9$ 小时。\n\n这些结果是一致的。四舍五入后各时期持续时间的总和为 $11.1 + 8.00 + 4.82 = 23.92$ 小时，这与四舍五入前计算出的倍增时间相符。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n11.1 & 8.00 & 4.82 & 23.9\n\\end{pmatrix}\n}\n$$", "id": "2780996"}, {"introduction": "理解癌症细胞周期调控的最终目标之一是开发更有效的治疗方法。许多癌症疗法具有细胞周期特异性，这为设计协同组合用药方案创造了机会。最后一个练习将让你扮演临床前建模者的角色，任务是为一个CDK4/6抑制剂和一种DNA损伤剂设计最佳给药方案，以最大程度地杀死肿瘤细胞[@problem_id:2780903]。这是一个系统药理学中的经典问题，它将我们对细胞周期动力学的理解直接应用于解决实际的治疗挑战。", "problem": "考虑真核细胞周期的几个规范阶段，其在 $G_{1}$、$S$ 和 $G_{2}/M$ 期的细胞群体比例在离散时间步 $t$ 由状态向量 $x_{t} = (g_{1,t}, s_{t}, g_{2,t})$ 表示。对于所有 $t$，均有 $g_{1,t} + s_{t} + g_{2,t} = 1$。细胞周期蛋白依赖性激酶 (CDK) $4/6$ 的活性调控 $G_{1} \\rightarrow S$ 限制点。损伤脱氧核糖核酸 (DNA) 的化疗倾向于优先杀死处于 $S$ 期的细胞。你将建立一个仅使用时相比例转移和对活细胞数量的乘性改变的离散时间模型，然后在简单的给药方案中进行搜索，以最小化在固定时间终点时的活细胞负荷。\n\n模型假设基于经过充分检验的生物学事实：\n- 在抑制剂存在期间，CDK $4/6$ 抑制会降低从 $G_{1} \\rightarrow S$ 的有效转移率，从而模拟 $G_{1}$ 期阻滞。\n- 解除 CDK $4/6$ 抑制后，细胞会以一个同步化的群组短暂进入 $S$ 期。通过在抑制剂撤除事件后立即发生的一个单步超调来对此建模，该超调会暂时增加 $G_{1} \\rightarrow S$ 的转移率。\n- 损伤 DNA 的化疗所造成的杀伤比例与给药时的 $S$ 期细胞比例成正比。\n- 净活细胞数量通过一个与 $G_{2}/M \\rightarrow G_{1}$ 流率成正比的生长因子，以及一个反映化疗致死的存活因子，进行乘法更新。\n\n定义如下：\n- $G_{1} \\rightarrow S$ 的基线单步转移概率为 $a$，$S \\rightarrow G_{2}/M$ 的为 $b$，$G_{2}/M \\rightarrow G_{1}$ 的为 $c$。\n- 二元控制序列 $u_{C}(t) \\in \\{0,1\\}$ (CDK $4/6$ 抑制剂开启或关闭）和 $u_{D}(t) \\in \\{0,1\\}$ (损伤 DNA 的化疗开启或关闭）。\n- 当 $u_{C}(t) = 1$ 时，有效的 $G_{1} \\rightarrow S$ 转移率为 $a_{t} = a \\cdot (1 - \\alpha)$，其中 $0 \\le \\alpha \\le 1$。\n- 当发生释放事件时（即 $u_{C}(t-1) = 1$ 且 $u_{C}(t) = 0$），仅在该步设置 $a_{t} = a \\cdot (1 + \\gamma)$。如果在时间步 $t$ 既无抑制也无释放，则使用 $a_{t} = a$。\n- 时相比例的更新为一阶马尔可夫转移：\n$$\n\\begin{aligned}\ng_{1,t+1} &= g_{1,t} \\cdot (1 - a_{t}) + g_{2,t} \\cdot c, \\\\\ns_{t+1}   &= s_{t} \\cdot (1 - b) + g_{1,t} \\cdot a_{t}, \\\\\ng_{2,t+1} &= g_{2,t} \\cdot (1 - c) + s_{t} \\cdot b.\n\\end{aligned}\n$$\n- 活细胞数 $N_{t}$ 从 $N_{0} = 1$ 开始，并按如下方式更新：\n$$\nN_{t+1} = N_{t} \\cdot \\bigl(1 + \\lambda \\cdot c \\cdot g_{2,t}\\bigr) \\cdot \\bigl(1 - u_{D}(t) \\cdot \\kappa \\cdot s_{t}\\bigr),\n$$\n其中 $0 \\le \\kappa \\le 1$ 且 $\\lambda \\ge 0$。\n\n方案约束：\n- CDK $4/6$ 抑制剂 $u_{C}(t)$ 可以以长度为 $L_{C} \\in \\{0,1,\\dots,L_{\\max}\\}$ 的单个连续区块的形式给药，起始时间为 $t_{C} \\in \\{0,1,\\dots,T-1\\}$，且满足 $t_{C} + L_{C} \\le T$。按照惯例，如果 $L_{C} = 0$，则取 $t_{C} = 0$。\n- 化疗 $u_{D}(t)$ 可以给药零次或一次。令 $n_{D} \\in \\{0,1\\}$ 为化疗脉冲的次数，如果 $n_{D} = 1$，则脉冲时间为 $t_{D} \\in \\{0,1,\\dots,T-1\\}$。按照惯例，如果 $n_{D} = 0$，则取 $t_{D} = -1$。\n- 应用线性毒性预算：$L_{C} \\cdot w_{C} + n_{D} \\cdot w_{D} \\le B$，其中 $w_{C}, w_{D}$ 为非负权重，$B$ 为预算。\n\n任务：\n- 对于测试套件中的每一组参数，枚举出满足上述约束的所有可行方案 $(t_{C}, L_{C}, n_{D}, t_{D})$。\n- 使用指定的规则，从初始状态 $x_{0} = (g_{1,0}, s_{0}, g_{2,0})$ 和 $N_{0} = 1$ 开始，对系统进行 $T$ 步模拟，确保每一步都满足 $g_{1,t} + s_{t} + g_{2,t} = 1$。\n- 找出使 $N_{T}$ 最小化的方案。如果在 $N_{T}$ 上出现平局（在标准浮点运算的数值相等范围内），选择字典序最小的三元组 $(t_{C}, L_{C}, t_{D})$，其中当 $n_D = 0$ 时 $t_D = -1$。\n- 对于每个测试用例，输出列表 $[N_{T}^{\\star}, t_{C}^{\\star}, L_{C}^{\\star}, t_{D}^{\\star}]$，其中 $N_{T}^{\\star}$ 四舍五入到 $6$ 位小数。您的程序应生成单行输出，其中包含所有用例的结果，形式为方括号括起来的、用逗号分隔的列表。\n\n测试套件：\n- 案例 1 (启用同步的协同作用搜索)：\n  - $T = 10$, $a = 0.35$, $b = 0.60$, $c = 0.70$, $\\alpha = 0.90$, $\\gamma = 1.00$, $\\kappa = 0.80$, $\\lambda = 1.00$.\n  - $L_{\\max} = 5$, $B = 6$, $w_{C} = 1$, $w_{D} = 1$.\n  - $x_{0} = (0.60, 0.20, 0.20)$.\n- 案例 2 (无超调，测试自然时相的时机选择)：\n  - $T = 8$, $a = 0.30$, $b = 0.50$, $c = 0.60$, $\\alpha = 0.80$, $\\gamma = 0.00$, $\\kappa = 0.70$, $\\lambda = 0.80$.\n  - $L_{\\max} = 4$, $B = 3$, $w_{C} = 1$, $w_{D} = 1$.\n  - $x_{0} = (0.40, 0.30, 0.30)$.\n- 案例 3 (化疗无效的边缘情况)：\n  - $T = 6$, $a = 0.40$, $b = 0.50$, $c = 0.50$, $\\alpha = 0.90$, $\\gamma = 1.20$, $\\kappa = 0.00$, $\\lambda = 0.90$.\n  - $L_{\\max} = 3$, $B = 0$, $w_{C} = 1$, $w_{D} = 1$.\n  - $x_{0} = \\left(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3}\\right)$.\n\n最终输出格式：\n- 单行输出，包含一个用方括号括起来的、逗号分隔的用例结果列表，其中每个用例表示为 $[N_{T}^{\\star}, t_{C}^{\\star}, L_{C}^{\\star}, t_{D}^{\\star}]$，$N_{T}^{\\star}$ 四舍五入到 6 位小数。对于没有化疗的方案，将 $t_{D}^{\\star}$ 记为 $-1$。例如，一个有效的输出格式（非实际答案）是 $[[1.234567,0,3,5],[2.000000,1,0,-1],[\\dots]]$。", "solution": "所提出的问题是计算系统生物学中一个明确定义的练习，要求在离散的治疗方案空间中进行优化搜索。该模型是一个一阶线性差分方程组，是对复杂细胞周期动力学的一种有效且标准的简化。它在科学上基于已建立的细胞周期调控和药理学概念，在数学上是一致的，并且所有参数都有明确定义。总细胞比例的守恒性，$g_{1,t} + s_{t} + g_{2,t} = 1$，被更新规则所保持。因此，该问题是有效的，并且在指定的平局决胜规则下存在唯一解。\n\n核心任务是找到一个最优方案 $(t_{C}^{\\star}, L_{C}^{\\star}, n_{D}^{\\star}, t_{D}^{\\star})$，以最小化时间终点 $T$ 时的最终活细胞数量 $N_{T}$。一个方案由四个参数定义：细胞周期蛋白依赖性激酶 (CDK) $4/6$ 抑制剂单次连续给药的开始时间 $t_{C}$ 和持续时间 $L_{C}$，以及损伤 DNA 的化疗脉冲的次数 $n_{D}$ 和时间点 $t_{D}$。\n\n所有可能方案的集合（我们记为 $\\mathcal{S}$）由以下约束定义：\n- $L_{C} \\in \\{0, 1, \\dots, L_{\\max}\\}$\n- $t_{C} \\in \\{0, 1, \\dots, T - 1\\}$ 且 $t_C + L_C \\le T$。按照惯例，如果 $L_C = 0$，则 $t_C = 0$。\n- $n_{D} \\in \\{0, 1\\}$\n- $t_{D} \\in \\{0, 1, \\dots, T-1\\}$。按照惯例，如果 $n_D = 0$，则 $t_D = -1$。\n此外，每个方案都必须满足一个线性毒性预算：\n$$L_{C} \\cdot w_{C} + n_{D} \\cdot w_{D} \\le B$$\n\n因此，该优化问题可以表述为在离散集合上寻找一个函数的最小值：\n$$\\min_{(t_{C}, L_{C}, n_{D}, t_{D}) \\in \\mathcal{S}_{\\text{feasible}}} N_{T}(t_{C}, L_{C}, n_{D}, t_{D})$$\n其中 $\\mathcal{S}_{\\text{feasible}}$ 是 $\\mathcal{S}$ 中满足预算约束的子集。\n\n解决策略是对所有可行方案进行暴力枚举和评估。由于由参数 $T$ 和 $L_{\\max}$ 定义的搜索空间规模适中，这在计算上是可行的。对于每个可行方案，系统的状态（包括时相比例 $x_t=(g_{1,t}, s_t, g_{2,t})$ 和总活细胞数 $N_t$）将在时间区间 $t \\in \\{0, 1, \\dots, T-1\\}$ 内进行模拟。\n\n首先，对于一个给定的方案 $(t_C, L_C, n_D, t_D)$，构建 $t \\in \\{0, \\dots, T-1\\}$ 的二元控制序列 $u_{C}(t)$ 和 $u_{D}(t)$：\n$$u_C(t) = \\begin{cases} 1 & \\text{若 } t_C \\le t < t_C + L_C \\\\ 0 & \\text{其他情况} \\end{cases}$$\n$$u_D(t) = \\begin{cases} 1 & \\text{若 } n_D = 1 \\text{ 且 } t = t_D \\\\ 0 & \\text{其他情况} \\end{cases}$$\n\n接下来，为每个时间步 $t$ 确定随时间变化的 $G_{1} \\rightarrow S$ 转移率 $a_t$：\n$$ a_{t} = \\begin{cases} a \\cdot (1 - \\alpha) & \\text{若 } u_{C}(t) = 1 \\\\ a \\cdot (1 + \\gamma) & \\text{若 } t > 0, u_{C}(t-1) = 1 \\text{ 且 } u_{C}(t) = 0 \\\\ a & \\text{其他情况} \\end{cases} $$\n释放事件的条件 $u_C(t-1)=1$ 在 $t=0$ 时无法满足。\n\n状态被初始化为 $x_0 = (g_{1,0}, s_{0}, g_{2,0})$ 和 $N_0 = 1$。然后系统进行迭代演化。对于每个时间步 $t = 0, \\dots, T-1$，状态被更新。时相比例根据指定的马尔可夫转移模型进行更新，该模型可以写成矩阵形式：\n$$\n\\begin{pmatrix} g_{1,t+1} \\\\ s_{t+1} \\\\ g_{2,t+1} \\end{pmatrix} =\n\\begin{pmatrix} 1-a_t & 0 & c \\\\ a_t & 1-b & 0 \\\\ 0 & b & 1-c \\end{pmatrix}\n\\begin{pmatrix} g_{1,t} \\\\ s_t \\\\ g_{2,t} \\end{pmatrix}\n$$\n这个变换正确地保持了总比例守恒，因为转移矩阵的每列之和为 1。\n\n同时，活细胞数 $N_t$ 通过乘法更新：\n$$N_{t+1} = N_{t} \\cdot \\underbrace{\\bigl(1 + \\lambda \\cdot c \\cdot g_{2,t}\\bigr)}_{\\text{有丝分裂带来的增长}} \\cdot \\underbrace{\\bigl(1 - u_{D}(t) \\cdot \\kappa \\cdot s_{t}\\bigr)}_{\\text{化疗引起的死亡}}$$\n\n迭代到 $t=T-1$ 后，得到的结果值为 $N_T$。算法必须跟踪到目前为止已产生的最小 $N_T$ 及其对应的方案。如果 $N_T$ 值出现平局（在标准浮点精度约 $10^{-9}$ 的范围内），则通过选择字典序最小的元组 $(t_C, L_C, t_D)$ 来打破平局。\n\n所实现的算法为每个提供的测试用例自动化了这一搜索和模拟过程，并按要求格式化了最优方案和相应的最小细胞数。", "answer": "[[0.231268, 5, 5, 6],[0.811808, 0, 2, 3],[1.328400, 0, 0, -1]]", "id": "2780903"}]}