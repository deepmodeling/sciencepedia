{"hands_on_practices": [{"introduction": "本练习将带您回顾岛屿生物地理学理论的根基。通过从经典的MacArthur-Wilson模型中推导出物种的平衡数量（$S^*$），您将从第一性原理的层面理解物种迁入率和灭绝率如何相互作用，共同决定一个岛屿上的生物多样性。这项实践对于解读更复杂的生物地理模型，以及培养关于控制物种丰富度的关键参数的直觉至关重要。[@problem_id:2805206]", "problem": "一个岛屿在MacArthur–Wilson岛屿生物地理学框架下接收来自大陆物种库的殖民物种。设$S(t)$表示时刻$t$岛上的物种数量，$S_{max}$表示岛屿可接触到的大陆物种库的大小，$I$表示岛屿为空时的最大迁入率，而$E$表示当岛屿被物种库中的物种饱和时的最大灭绝率。假设迁入率随$S$线性下降，灭绝率随$S$线性增加，得到如下常微分方程\n$$\n\\frac{dS}{dt} \\;=\\; I\\!\\left(1 - \\frac{S}{S_{max}}\\right) \\;-\\; E\\,\\frac{S}{S_{max}}.\n$$\n仅从平衡态是$\\frac{dS}{dt}=0$的状态这一定义以及线性函数的代数性质出发，推导以$I$、$E$和$S_{max}$表示的平衡物种丰富度$S^{*}$的闭式表达式。然后，运用第一性原理，定性解释当$I$、$E$和$S_{max}$中的每一个在其他参数保持不变的情况下增加时，$S^{*}$如何变化，并明确说明其响应是增加还是减少，以及是呈现收益递减还是等比例缩放。请以最简闭式形式给出$S^{*}$的最终表达式。无需进行数值计算。", "solution": "对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 时刻$t$岛上的物种数量表示为$S(t)$。\n- 岛屿可接触到的大陆物种库大小为$S_{max}$。\n- 岛屿为空时的最大迁入率($S=0$)为$I$。\n- 岛屿饱和时的最大灭绝率($S=S_{max}$)为$E$。\n- 主导常微分方程为：\n$$\n\\frac{dS}{dt} = I\\left(1 - \\frac{S}{S_{max}}\\right) - E\\frac{S}{S_{max}}\n$$\n- 平衡的定义是$\\frac{dS}{dt}=0$的状态。\n- 任务是推导以$I$、$E$和$S_{max}$表示的平衡物种丰富度$S^{*}$的闭式表达式。\n- 任务还要求定性解释当$I$、$E$和$S_{max}$单独增加时，$S^{*}$如何响应变化。\n\n步骤2：使用提取的已知条件进行验证。\n根据验证标准对问题进行评估。\n- **科学基础**：该问题基于MacArthur–Wilson岛屿生物地理学模型，这是生态学中一个基础且成熟的理论。迁入率和灭绝率对物种丰富度的线性依赖关系是该模型最原始、最简单的表述。因此，该问题在科学上是合理的。\n- **适定性**：该问题提供了一个一阶常微分方程，并要求求解其平衡点。寻找平衡点需要将导数设为零并求解一个代数方程。所得方程对于目标变量$S^{*}$是线性的，保证了唯一解的存在。该问题是适定的。\n- **客观性**：该问题使用精确的数学语言陈述，变量和参数定义清晰，没有主观或含糊的术语。\n- **完整性与一致性**：该问题是自洽的。推导平衡表达式和分析其性质所需的所有信息都已提供，没有矛盾之处。\n\n步骤3：结论与行动。\n该问题具有科学有效性、适定性、客观性和完整性，是理论生态学中的一个标准练习。现在开始求解过程。\n\n推导从给定的微分方程开始，该方程模拟了岛屿上物种丰富度$S$的变化率：\n$$\n\\frac{dS}{dt} = I\\left(1 - \\frac{S}{S_{max}}\\right) - E\\frac{S}{S_{max}}\n$$\n第一项，$I\\left(1 - \\frac{S}{S_{max}}\\right)$，代表新物种的迁入率。当岛屿为空（$S=0$）时，它达到最大值$I$；随着物种数量接近大陆物种库的大小（$S=S_{max}$），它线性下降到$0$。第二项，$E\\frac{S}{S_{max}}$，代表已存在物种的灭绝率。当岛屿为空（$S=0$）时，它为$0$；当岛屿饱和（$S=S_{max}$）时，它线性增加到最大值$E$。\n\n平衡被定义为物种数量不再变化的状态，即变化率为零。在平衡状态下，物种丰富度用$S^{*}$表示。我们应用此条件：\n$$\n\\frac{dS}{dt} \\bigg|_{S=S^{*}} = 0\n$$\n这意味着迁入率必须与灭绝率完全平衡。将主导方程的右侧设为$0$：\n$$\nI\\left(1 - \\frac{S^{*}}{S_{max}}\\right) - E\\frac{S^{*}}{S_{max}} = 0\n$$\n这是一个关于$S^{*}$的线性代数方程。我们现在必须用给定的参数$I$、$E$和$S_{max}$来解出$S^{*}$。首先，展开项$I$：\n$$\nI - \\frac{I S^{*}}{S_{max}} - \\frac{E S^{*}}{S_{max}} = 0\n$$\n分离不含$S^{*}$的项：\n$$\nI = \\frac{I S^{*}}{S_{max}} + \\frac{E S^{*}}{S_{max}}\n$$\n在右侧提取公因子$S^{*}$：\n$$\nI = S^{*} \\left( \\frac{I}{S_{max}} + \\frac{E}{S_{max}} \\right)\n$$\n通过提取$\\frac{1}{S_{max}}$进一步简化：\n$$\nI = S^{*} \\frac{I + E}{S_{max}}\n$$\n最后，为了获得$S^{*}$的表达式，我们将两边乘以$S_{max}$并除以$(I+E)$：\n$$\nS^{*} = \\frac{I S_{max}}{I + E}\n$$\n这就是平衡物种丰富度的闭式表达式。\n\n任务的第二部分是定性解释$S^{*}$如何响应各参数的变化。我们使用推导出的$S^{*}$表达式并分析其偏导数。\n\n1.  **对迁入率($I$)的依赖性**：\n    为确定$S^{*}$如何随$I$变化，我们计算偏导数$\\frac{\\partial S^{*}}{\\partial I}$：\n    $$\n    \\frac{\\partial S^{*}}{\\partial I} = \\frac{\\partial}{\\partial I} \\left( \\frac{I S_{max}}{I + E} \\right)\n    $$\n    使用商法则求导，$\\frac{d}{dx}\\left(\\frac{u}{v}\\right) = \\frac{u'v - uv'}{v^2}$：\n    $$\n    \\frac{\\partial S^{*}}{\\partial I} = \\frac{(S_{max})(I+E) - (I S_{max})(1)}{(I+E)^2} = \\frac{I S_{max} + E S_{max} - I S_{max}}{(I+E)^2} = \\frac{E S_{max}}{(I+E)^2}\n    $$\n    由于参数$E$和$S_{max}$代表物理量（灭绝率和物种库大小），它们必须是正的（$E>0, S_{max}>0$）。分母$(I+E)^2$也严格为正。因此，$\\frac{\\partial S^{*}}{\\partial I} > 0$，这意味着**$S^{*}$是$I$的增函数**。\n    为了确定这种增加的性质（例如，收益递减），我们考察二阶偏导数$\\frac{\\partial^2 S^{*}}{\\partial I^2}$：\n    $$\n    \\frac{\\partial^2 S^{*}}{\\partial I^2} = \\frac{\\partial}{\\partial I} \\left( \\frac{E S_{max}}{(I+E)^2} \\right) = E S_{max} \\frac{\\partial}{\\partial I} (I+E)^{-2} = E S_{max} \\left( -2(I+E)^{-3} \\cdot 1 \\right) = \\frac{-2 E S_{max}}{(I+E)^3}\n    $$\n    由于$E>0$、$S_{max}>0$且$I+E>0$，二阶导数为负。一阶导数为正且二阶导数为负表示这是一个凹函数。这表明存在**收益递减**：最大迁入率$I$的每一次增量增加，所带来的平衡物种丰富度$S^{*}$的增加量会逐渐变小。\n\n2.  **对灭绝率($E$)的依赖性**：\n    我们计算偏导数$\\frac{\\partial S^{*}}{\\partial E}$：\n    $$\n    \\frac{\\partial S^{*}}{\\partial E} = \\frac{\\partial}{\\partial E} \\left( \\frac{I S_{max}}{I + E} \\right) = I S_{max} \\frac{\\partial}{\\partial E} (I+E)^{-1} = I S_{max} \\left( -1(I+E)^{-2} \\cdot 1 \\right) = \\frac{-I S_{max}}{(I+E)^2}\n    $$\n    由于$I>0$且$S_{max}>0$，分子为负，分母为正。因此，$\\frac{\\partial S^{*}}{\\partial E} < 0$，这意味着**$S^{*}$是$E$的减函数**。\n    为评估这种减少的性质，我们考察二阶偏导数$\\frac{\\partial^2 S^{*}}{\\partial E^2}$：\n    $$\n    \\frac{\\partial^2 S^{*}}{\\partial E^2} = \\frac{\\partial}{\\partial E} \\left( \\frac{-I S_{max}}{(I+E)^2} \\right) = -I S_{max} \\frac{\\partial}{\\partial E} (I+E)^{-2} = -I S_{max} \\left( -2(I+E)^{-3} \\cdot 1 \\right) = \\frac{2 I S_{max}}{(I+E)^3}\n    $$\n    由于$I>0$、$S_{max}>0$且$I+E>0$，该二阶导数为正。一阶导数为负且二阶导数为正表示这是一个凸函数。$E$的增加导致$S^{*}$的减少，但随着$E$变大，这种减少的幅度会变小。这也是灭绝的负面影响的一种**收益递减**形式。\n\n3.  **对大陆物种库大小($S_{max}$)的依赖性**：\n    我们计算偏导数$\\frac{\\partial S^{*}}{\\partial S_{max}}$：\n    $$\n    \\frac{\\partial S^{*}}{\\partial S_{max}} = \\frac{\\partial}{\\partial S_{max}} \\left( \\frac{I S_{max}}{I + E} \\right) = \\frac{I}{I+E}\n    $$\n    项$\\frac{I}{I+E}$相对于$S_{max}$被视为常数。由于$I>0$且$E \\ge 0$，该导数是一个正常数。因此，**$S^{*}$是$S_{max}$的增函数**。\n    二阶偏导数为：\n    $$\n    \\frac{\\partial^2 S^{*}}{\\partial S_{max}^2} = \\frac{\\partial}{\\partial S_{max}} \\left( \\frac{I}{I+E} \\right) = 0\n    $$\n    二阶导数为零表示存在线性关系。这意味着$S^{*}$相对于$S_{max}$表现出**等比例缩放**。平衡物种数量是总可用物种库的一个固定分数，即$\\frac{I}{I+E}$。\n\n总之，平衡物种丰富度随着迁入率的增大而增加（但有收益递减），随着灭绝率的增大而减少（其负面影响有收益递减），并随着大陆物种库的大小成比例增加。", "answer": "$$\n\\boxed{\\frac{I S_{max}}{I + E}}\n$$", "id": "2805206"}, {"introduction": "在对岛屿生物地理学理论理解的基础上，这项实践将挑战您处理经验数据。您需要将经典的物种-面积关系（$S = cA^z$）拟合到几个假设的岛屿数据集中，从而对其进行分析。这项练习将磨练您的数据分析技能，并加深您对现实世界因素（如岛屿的隔离程度和栖息地多样性）如何调节这一基本生态学定律的理解。[@problem_id:2805178]", "problem": "您会得到三个独立的岛屿数据集。每个岛屿由四个观测变量描述：面积、物种丰富度、与最近大陆的隔离距离以及栖息地多样性指数。其生物学前提基于岛屿生物地理学的平衡理论和尺度不变性，即物种丰富度随面积增加而增加，该增加的强度受隔离程度和栖息地多样性的调节，并且尺度不变关系在对数变换下变为线性关系。从第一性原理出发，使用以下基本假设和定义：(i) 岛屿面积调节了物种灭绝和栖息地异质性；(ii) 隔离程度调节了物种迁入；(iii) 对数变换将乘性的、尺度不变的幂律关系映射为仿射线性形式；(iv) 普通最小二乘法通过最小化残差平方和，为仿射线性模型提供闭式解估计量。\n\n对于每个岛屿，定义 $x = \\log_{10}(A)$，其中 $A$ 是以 $\\mathrm{km}^2$ 为单位的面积；定义 $y = \\log_{10}(S)$，其中 $S$ 是物种数量（无单位）。对于任意岛屿子集，假设 $y$ 与 $x$ 呈仿射线性关系，并使用普通最小二乘法估计斜率参数 $z$。具体来说，对于一个包含向量 $x$ 和 $y$ 的子集，$z$ 的估计公式如下：\n$$\nz \\equiv \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^{n} (x_i - \\bar{x})^2},\n$$\n其中 $\\bar{x}$ 和 $\\bar{y}$ 是样本均值。斜率 $z$ 是无量纲的。所需的输出不需要截距。\n\n对于每个数据集（测试用例），按以下规则对岛屿进行分区：\n- 隔离程度：“近”（near）指隔离距离 $I \\leq 60$ $\\mathrm{km}$，“远”（far）指 $I > 60$ $\\mathrm{km}$，\n- 栖息地多样性：“低”（low）指栖息地多样性指数 $H < 1.4$，“高”（high）指 $H \\geq 1.4$。\n\n对于每个数据集，计算：\n- $z_{\\mathrm{near}}$，来自“近”子集，\n- $z_{\\mathrm{far}}$，来自“远”子集，\n- $z_{\\mathrm{low}}$，来自“低”多样性子集，\n- $z_{\\mathrm{high}}$，来自“高”多样性子集，\n- 差值 $z_{\\mathrm{far}} - z_{\\mathrm{near}}$ 和 $z_{\\mathrm{high}} - z_{\\mathrm{low}}$，\n- 布尔值 $(z_{\\mathrm{near}} < z_{\\mathrm{far}})$ 和 $(z_{\\mathrm{low}} < z_{\\mathrm{high}})$。\n\n将所有斜率和差值四舍五入到三位小数。布尔值必须是精确的。\n\n所有面积必须以 $\\mathrm{km}^2$ 为单位，隔离距离以 $\\mathrm{km}$ 为单位，物种丰富度为无单位的计数，栖息地多样性指数为无单位的标量。不涉及角度或百分比。使用以10为底的对数。不要应用任何加权或正则化处理。如果一个子集包含的相异 $x$ 值少于两个，问题将是不适定的；但是，所提供的测试套件避免了此类退化情况。\n\n测试套件（每个岛屿是一个元组 $(A, S, I, H)$，其中 $A$ 的单位是 $\\mathrm{km}^2$，$S$ 是无单位计数，$I$ 的单位是 $\\mathrm{km}$，$H$ 是无单位的）：\n\n- 数据集 1:\n  $\\{(2,7,20,0.9), (5,8,30,1.1), (20,10,45,1.3), (50,12,35,1.4), (120,14,25,1.5), (300,17,40,1.6), (3,6,120,1.0), (8,8,80,1.2), (15,9,150,1.3), (60,14,200,1.5), (200,20,300,1.7), (800,30,500,1.8)\\}$.\n\n- 数据集 2:\n  $\\{(4,8,30,1.0), (9,9,40,1.2), (40,11,35,1.4), (6,7,180,1.1), (25,11,220,1.5), (90,16,260,1.6)\\}$.\n\n- 数据集 3:\n  $\\{(1.5,6,50,1.0), (12,9,40,1.1), (150,15,55,1.5), (1500,24,20,1.7), (2,5,150,1.2), (18,11,200,1.3), (180,25,300,1.6), (1800,55,400,1.8)\\}$.\n\n您的程序必须按顺序处理这三个数据集。对于每个数据集，生成一个包含八个结果的有序列表：\n$[z_{\\mathrm{near}}, z_{\\mathrm{far}}, z_{\\mathrm{low}}, z_{\\mathrm{high}}, z_{\\mathrm{far}} - z_{\\mathrm{near}}, z_{\\mathrm{high}} - z_{\\mathrm{low}}, (z_{\\mathrm{near}} < z_{\\mathrm{far}}), (z_{\\mathrm{low}} < z_{\\mathrm{high}})]$。\n\n最终输出格式：您的程序应生成单行输出，其中包含所有三个数据集的结果串联而成的逗号分隔列表，并用方括号括起来。也就是说，输出一个长度为 $24$ 的单一列表，该列表通过按顺序附加数据集1、数据集2和数据集3的八个值而获得。格式示例（仅为说明）：$[0.123,0.456,0.111,0.222,0.333,0.444,True,True, \\dots]$。", "solution": "问题陈述已经过验证，并被认定为有效。它提出了一个定义明确、具有科学依据的计算生物学练习，具体与岛屿生物地理学的平衡理论相关。所有数据、定义和约束都以清晰明确的方式提供，从而可以得出一个直接且唯一的解决方案。\n\n基本任务是分析物种丰富度（$S$）和岛屿面积（$A$）之间的关系，该关系受到隔离程度（$I$）和栖息地多样性（$H$）的调节。问题正确地指出，幂律形式的物种-面积关系（通常表示为 $S = cA^z$）可通过对数变换进行线性化。我们定义新变量 $x = \\log_{10}(A)$ 和 $y = \\log_{10}(S)$，这将幂律关系转换为仿射形式：$y = zx + \\log_{10}(c)$。任务是为指定的岛屿数据子集估计斜率参数 $z$。\n\n斜率 $z$ 使用为简单线性回归提供的普通最小二乘法（OLS）估计量公式进行估计：\n$$\nz \\equiv \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^{n} (x_i - \\bar{x})^2}\n$$\n其中 $n$ 是给定子集中的岛屿数量，$x_i$ 和 $y_i$ 是第 $i$ 个岛屿经过对数变换后的面积和物种数量，$\\bar{x}$ 和 $\\bar{y}$ 分别是它们的样本均值。\n\n对于所提供的三个数据集中的每一个，求解方法如下：\n\n1.  **数据分区**：根据两个标准，将一个数据集中的全部岛屿划分为四个重叠的子集：\n    *   **隔离程度**：如果一个岛屿的隔离距离 $I \\leq 60 \\thinspace \\mathrm{km}$，则归类为“近”（near）；如果 $I > 60 \\thinspace \\mathrm{km}$，则归类为“远”（far）。这将创建两个子集，一个用于近岛，一个用于远岛。\n    *   **栖息地多样性**：如果一个岛屿的栖息地指数 $H < 1.4$，则归类为“低”（low）多样性；如果 $H \\geq 1.4$，则归类为“高”（high）多样性。这将创建另外两个子集。\n\n2.  **斜率计算**：对于生成的四个子集中的每一个——近岛（$z_{\\mathrm{near}}$）、远岛（$z_{\\mathrm{far}}$）、低多样性（$z_{\\mathrm{low}}$）和高多样性（$z_{\\mathrm{high}}$）——计算其斜率参数 $z$。设计一个计算函数来系统地执行以下步骤：\n    a.  对于给定的岛屿子集，提取面积（$A$）和物种丰富度（$S$）的值。\n    b.  应用以10为底的对数变换，得到向量 $x = \\log_{10}(A)$ 和 $y = \\log_{10}(S)$。\n    c.  计算样本均值 $\\bar{x}$ 和 $\\bar{y}$。\n    d.  计算分子，即 $\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})$，它是偏差乘积之和。\n    e.  计算分母，即 $\\sum_{i=1}^{n} (x_i - \\bar{x})^2$，它是 $x$ 的离差平方和。\n    f.  斜率 $z$ 是分子与分母之比。问题保证了子集的构造可以避免分母为零的情况。\n\n3.  **分析与格式化**：计算出四个斜率值后，推导得出以下量：\n    *   远岛和近岛斜率之差：$z_{\\mathrm{far}} - z_{\\mathrm{near}}$。\n    *   高、低多样性斜率之差：$z_{\\mathrm{high}} - z_{\\mathrm{low}}$。\n    *   一个布尔值，指示远岛斜率是否大于近岛斜率：$(z_{\\mathrm{near}} < z_{\\mathrm{far}})$。\n    *   一个布尔值，指示高多样性斜率是否大于低多样性斜率：$(z_{\\mathrm{low}} < z_{\\mathrm{high}})$。\n\n    所有计算出的斜率和差值都需数值上四舍五入到三位小数。布尔值保持精确。\n\n4.  **结果汇总**：对所有三个数据集重复此过程。将每个数据集产生的八个结果值——对于数据集 $k \\in \\{1, 2, 3\\}$，即 $[z_{\\mathrm{near}}, z_{\\mathrm{far}}, z_{\\mathrm{low}}, z_{\\mathrm{high}}, z_{\\mathrm{far}} - z_{\\mathrm{near}}, z_{\\mathrm{high}} - z_{\\mathrm{low}}, (z_{\\mathrm{near}} < z_{\\mathrm{far}}), (z_{\\mathrm{low}} < z_{\\mathrm{high}})]_k$——按顺序串联起来，形成一个包含 $24$ 个元素的单一输出列表。所提供的程序使用 `numpy` 库稳健地实现了此过程，以进行高效和准确的数值计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the island biogeography problem by partitioning datasets,\n    calculating OLS slopes, and compiling the results as specified.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset 1\n        [\n            (2, 7, 20, 0.9), (5, 8, 30, 1.1), (20, 10, 45, 1.3),\n            (50, 12, 35, 1.4), (120, 14, 25, 1.5), (300, 17, 40, 1.6),\n            (3, 6, 120, 1.0), (8, 8, 80, 1.2), (15, 9, 150, 1.3),\n            (60, 14, 200, 1.5), (200, 20, 300, 1.7), (800, 30, 500, 1.8)\n        ],\n        # Dataset 2\n        [\n            (4, 8, 30, 1.0), (9, 9, 40, 1.2), (40, 11, 35, 1.4),\n            (6, 7, 180, 1.1), (25, 11, 220, 1.5), (90, 16, 260, 1.6)\n        ],\n        # Dataset 3\n        [\n            (1.5, 6, 50, 1.0), (12, 9, 40, 1.1), (150, 15, 55, 1.5),\n            (1500, 24, 20, 1.7), (2, 5, 150, 1.2), (18, 11, 200, 1.3),\n            (180, 25, 300, 1.6), (1800, 55, 400, 1.8)\n        ]\n    ]\n\n    all_results = []\n\n    def calculate_z(subset):\n        \"\"\"\n        Calculates the OLS slope 'z' for a given subset of islands.\n        The subset is a list of (A, S, I, H) tuples.\n        \"\"\"\n        if len(subset) < 2:\n            return np.nan  # Degenerate case, though problem avoids this.\n\n        # Extract Area (A) and Species Richness (S)\n        A_vals = [island[0] for island in subset]\n        S_vals = [island[1] for island in subset]\n\n        # Log-transform the data\n        x = np.log10(A_vals)\n        y = np.log10(S_vals)\n\n        # Calculate sample means\n        x_mean = np.mean(x)\n        y_mean = np.mean(y)\n\n        # Calculate numerator and denominator for the slope formula\n        numerator = np.sum((x - x_mean) * (y - y_mean))\n        denominator = np.sum((x - x_mean)**2)\n\n        if denominator == 0:\n            return np.nan # Ill-posed if all x values are identical.\n\n        return numerator / denominator\n\n    for dataset in test_cases:\n        # Partition the dataset according to the rules\n        near_subset = [island for island in dataset if island[2] <= 60]\n        far_subset = [island for island in dataset if island[2] > 60]\n        low_h_subset = [island for island in dataset if island[3] < 1.4]\n        high_h_subset = [island for island in dataset if island[3] >= 1.4]\n\n        # Calculate slope 'z' for each subset\n        z_near = calculate_z(near_subset)\n        z_far = calculate_z(far_subset)\n        z_low = calculate_z(low_h_subset)\n        z_high = calculate_z(high_h_subset)\n\n        # Calculate derived quantities\n        diff_iso = z_far - z_near\n        diff_hab = z_high - z_low\n\n        bool_iso = z_near < z_far\n        bool_hab = z_low < z_high\n\n        # Format results as specified (rounding)\n        case_results = [\n            round(z_near, 3),\n            round(z_far, 3),\n            round(z_low, 3),\n            round(z_high, 3),\n            round(diff_iso, 3),\n            round(diff_hab, 3),\n            bool_iso,\n            bool_hab\n        ]\n        all_results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2805178"}, {"introduction": "区分同源与同功是演化生物学的核心。本练习为此提供了一个形式化框架，要求您使用连续时间马尔可夫模型来计算一个性状发生趋同演化的概率。通过解决这个问题，您将培养出一种定量的直觉，理解共享性状如何可能独立出现，这是准确重建演化历史的关键概念。[@problem_id:2805187]", "problem": "某蜥蜴支系的两个岛屿谱系表现出一个二态形态特征，该特征具有状态 $0$ 或 $1$。一块来自这两个谱系最近共同祖先（MRCA）且年代测定明确的化石表明，在分化时（发生于 $t$ 个时间单位之前），祖征状态为 $0$。假设在每个后代谱系中，该特征都遵循一个时间齐次、连续时间的马尔可夫过程进行演化，该过程采用对称马尔可夫k状态（Mk）模型，其中 $k=2$，状态间的瞬时转变速率在每个谱系中为 $q$。两个后代分支的长度相等，均为 $t$，并且以MRCA的祖征状态为条件，两个分支上的演化历史是独立的。\n\n为了在生物地理学背景下区分同源与趋同，将“因趋同而非遗传导致状态相同”定义为以下事件：观察到两个末端分类单元在现今共享相同的衍征状态 $1$，尽管它们的MRCA在分化时处于状态 $0$。在上述假设下，请推导出该事件的概率，并以 $q$ 和 $t$ 的闭式表达式表示。\n\n你的最终答案必须是单一的解析表达式。请勿近似或四舍五入。", "solution": "对所述问题进行验证。\n\n**步骤1：提取已知条件**\n- 某蜥蜴支系的两个岛屿谱系。\n- 一个具有状态 {$0$, $1$} 的二态形态特征。\n- 分化时的最近共同祖先 (MRCA) 状态：状态 $0$。\n- 自共同祖先分化以来的时间：$t$ 个时间单位。\n- 演化模型：时间齐次连续时间马尔可夫过程。\n- 具体模型：对称马尔可夫k状态 (Mk) 模型，其中 $k=2$。\n- 状态间的每个谱系的瞬时转变速率：$q$。\n- 分支长度：两个后代分支的长度相等，均为 $t$。\n- 独立性：以MRCA状态为条件，两个分支上的演化历史是独立的。\n- 目标事件：“因趋同而非遗传导致状态相同”，其定义为“观察到两个末端分类单元在现今共享相同的衍征状态 $1$，尽管它们的MRCA在分化时处于状态 $0$”。\n- 目标：以 $q$ 和 $t$ 的闭式表达式推导此事件的概率。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题使用了连续时间马尔可夫链，具体是对称2状态 (Mk) 模型，这是系统发育比较方法和分子演化中的一个标准基础工具。其框架在科学上是合理的。\n- **适定性**：该问题是适定的。它提供了所有必要的参数（$q$, $t$）、初始条件（祖征状态为 $0$），以及一个精确定义的待计算的概率事件。可以确定唯一的解。\n- **客观性**：该问题以精确、客观的语言陈述，没有歧义或主观论断。“趋同”的概念为计算目的被赋予了严格、形式化的定义。\n\n**步骤3：结论与行动**\n该问题是有效的。这是随机过程应用于演化生物学的一个标准练习。将推导解答。\n\n单个谱系上二态特征的演化由一个对称的2状态连续时间马尔可夫过程描述。状态为 {$0, 1$}。从状态 $i$ 到状态 $j$ ($i \\neq j$) 的瞬时变化速率为 $q$。因此，无穷小生成元矩阵（或速率矩阵）$Q$ 为：\n$$\nQ = \\begin{pmatrix} -q & q \\\\ q & -q \\end{pmatrix}\n$$\n在长度为 $t$ 的时间间隔内，从状态 $i$ 转变到状态 $j$ 的概率由矩阵项 $[P(t)]_{ij}$ 给出，其中 $P(t) = \\exp(Qt)$ 是转移概率矩阵。\n\n为了计算 $P(t)$，我们可以对 $Q$ 进行对角化或使用其他矩阵指数化方法。$Q$ 的特征值 $\\lambda$ 可通过求解特征方程 $\\det(Q - \\lambda I) = 0$ 找到：\n$$\n\\det\\begin{pmatrix} -q - \\lambda & q \\\\ q & -q - \\lambda \\end{pmatrix} = (-q - \\lambda)^2 - q^2 = 0\n$$\n这得到 $(\\lambda + q)^2 = q^2$，从而 $\\lambda + q = \\pm q$。特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = -2q$。\n\n转移矩阵 $P(t)$ 可以表示为：\n$$\nP(t) = \\begin{pmatrix} P_{00}(t) & P_{01}(t) \\\\ P_{10}(t) & P_{11}(t) \\end{pmatrix}\n$$\n其中 $P_{ij}(t)$ 是在时间 $0$ 时过程从状态 $i$ 开始，在时间 $t$ 处于状态 $j$ 的概率。对于对称2状态模型，这些概率是众所周知的：\n$$\nP_{01}(t) = P_{10}(t) = \\frac{1}{2}(1 - \\exp(-2qt))\n$$\n$$\nP_{00}(t) = P_{11}(t) = \\frac{1}{2}(1 + \\exp(-2qt))\n$$\n我们将两个后代谱系表示为谱系 $A$ 和谱系 $B$。令 $X_A(s)$ 和 $X_B(s)$ 分别为谱系 $A$ 和谱系 $B$ 中该特征在分化事件后 $s$ 时刻的状态（$0 \\le s \\le t$）。\n\n问题给出的初始条件是MRCA处于状态 $0$。这意味着 $X_A(0) = 0$ 且 $X_B(0) = 0$。\n目标事件被定义为两个末端分类单元在当前时间 $t$ 都具有衍征状态 $1$。这对应于事件 $\\{X_A(t)=1 \\text{ and } X_B(t)=1\\}$。\n\n我们需要计算该联合事件在祖征状态为条件的概率：\n$$\n\\text{Prob}\\{X_A(t)=1, X_B(t)=1 \\mid X_A(0)=0, X_B(0)=0 \\}\n$$\n问题指出，在以祖征状态为条件下，两个分支上的演化历史是独立的。因此，联合概率是每个谱系各自概率的乘积：\n$$\n\\text{Prob}\\{X_A(t)=1 \\mid X_A(0)=0 \\} \\times \\text{Prob}\\{X_B(t)=1 \\mid X_B(0)=0 \\}\n$$\n这些概率中的每一个都是在长度为 $t$ 的时间段内从状态 $0$ 转变到状态 $1$ 的转移概率，即 $P_{01}(t)$。\n$$\n\\text{Prob}\\{X_A(t)=1 \\mid X_A(0)=0 \\} = P_{01}(t) = \\frac{1}{2}(1 - \\exp(-2qt))\n$$\n$$\n\\text{Prob}\\{X_B(t)=1 \\mid X_B(0)=0 \\} = P_{01}(t) = \\frac{1}{2}(1 - \\exp(-2qt))\n$$\n所指定的趋同事件的概率是这两个相同概率的乘积：\n$$\nP(\\text{convergence}) = [P_{01}(t)]^2 = \\left[ \\frac{1}{2}(1 - \\exp(-2qt)) \\right]^2\n$$\n展开此表达式得到最终的闭式结果：\n$$\nP(\\text{convergence}) = \\frac{1}{4} (1 - \\exp(-2qt))^2\n$$\n该表达式正确地捕捉了两个谱系在时间间隔 $t$ 内，均从一个祖征状态（$0$）开始，独立演化到一个共享的衍征状态（$1$）的概率。这就是所指定的趋同事件的形式化、概率性定义。", "answer": "$$\\boxed{\\frac{1}{4}(1 - \\exp(-2qt))^{2}}$$", "id": "2805187"}]}