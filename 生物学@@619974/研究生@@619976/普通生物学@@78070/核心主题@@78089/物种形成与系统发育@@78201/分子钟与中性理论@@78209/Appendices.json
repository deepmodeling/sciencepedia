{"hands_on_practices": [{"introduction": "中性理论的一个核心成果是，中性突变的固定速率等于中性突变率本身，并且独立于种群大小。这个看似有违直觉的结论是分子钟概念的理论基石。本练习将引导你从群体遗传学的基本原理出发，亲手推导出这一关键结果，从而深刻理解为何分子演化可以呈现出类似时钟的规律性。[@problem_id:2818739]", "problem": "一个随机交配的二倍体群体的有效群体大小恒定为 $N = 10^{5}$。每个位点、每一代的中性突变率为 $\\mu = 1 \\times 10^{-8}$。考虑一个 $T = 10^{7}$ 代的时间间隔。仅从以下基本事实出发：(i) 在一个二倍体群体中，每个位点每一代有 $2N$ 个基因拷贝可以发生突变，(ii) 每个位点每一代进入群体的中性新突变的期望数量由基因拷贝数与每个拷贝的中性突变率的乘积决定，以及 (iii) 在中性条件下，一个新产生的等位基因的固定概率等于其初始频率，请从第一性原理出发，推导在 $T$ 代时间内累积的每个位点的中性固定数的期望表达式（用 $N$、$\\mu$ 和 $T$ 表示）。然后，使用给定的 $N$、$\\mu$ 和 $T$ 的值计算该表达式。最后，简要解释你的数值结果，说明中性替换的累积是否呈时钟样。将每个位点的期望数表示为一个无单位的小数。除了精确算术之外，不需要进行四舍五入。", "solution": "该问题要求从第一性原理出发，推导在时间间隔 $T$ 内每个位点的中性替换（或固定）的期望数。我们将每个位点、每一代的中性替换率记为 $K$。因此，总的期望固定数将是 $K \\times T$。\n\n我们遵循所提供的基本事实：\n\n1.  **新中性突变的速率：**\n    事实 (i) 和 (ii) 指出，每个位点、每一代进入群体的中性新突变的期望数量是基因拷贝数（$2N$）与每个拷贝的中性突变率（$\\mu$）的乘积。\n    设这个新突变引入的速率为 $\\lambda$。\n    $$ \\lambda = (2N) \\times \\mu = 2N\\mu $$\n    该表达式表示在一代之内，整个群体中某个特定位点上产生的新中性等位基因的总数。\n\n2.  **新中性突变的固定概率：**\n    一个新突变最初在群体中以单个拷贝的形式存在。该位点的总基因拷贝数为 $2N$。因此，这个新等位基因的初始频率，我们称之为 $p_0$，是：\n    $$ p_0 = \\frac{1}{2N} $$\n    事实 (iii) 指出，在中性条件下（即该等位基因没有选择优势或劣势），其最终达到固定（频率为 1）的概率等于其初始频率。设这个概率为 $P_{fix}$。\n    $$ P_{fix} = p_0 = \\frac{1}{2N} $$\n\n3.  **中性替换率：**\n    中性替换率 $K$ 是新中性突变产生*并*随后走向固定的速率。这是新中性突变引入的速率 ($\\lambda$) 与其中任何一个被固定的概率 ($P_{fix}$) 的乘积。\n    $$ K = \\lambda \\times P_{fix} $$\n    代入我们推导出的表达式：\n    $$ K = (2N\\mu) \\times \\left(\\frac{1}{2N}\\right) $$\n    $2N$ 项相消，得到一个非常简单的结果：\n    $$ K = \\mu $$\n    这是中性理论的一个基石性结果：中性等位基因的替换率等于中性突变率，并且与有效群体大小无关。\n\n4.  **在时间 $T$ 内的总期望固定数：**\n    在 $T$ 代的时间段内，每个位点的中性固定总期望数是每代的替换率 $K$ 乘以代数 $T$。\n    $$ \\text{Total Fixations} = K \\times T = \\mu T $$\n\n现在，我们使用问题中提供的数值来计算这个表达式：\n$N = 10^{5}$\n$\\mu = 1 \\times 10^{-8}$\n$T = 10^{7}$\n\n每个位点的中性固定总期望数是：\n$$ \\text{Total Fixations} = (1 \\times 10^{-8}) \\times (10^{7}) = 10^{-8+7} = 10^{-1} = 0.1 $$\n\n最后，我们必须在分子钟的背景下解释这个结果。推导表明，中性替换的累积速率 $K$ 等于中性突变率 $\\mu$。关键的是，这个速率与有效群体大小 $N$ 无关。如果假定对于给定的基因或基因组区域，突变率 $\\mu$ 在进化时间内近似恒定，那么替换率 $K$ 也将是恒定的。因此，替换的累积将以一种稳定的、类似时钟的节奏发生。计算表明，在 $T = 10^{7}$ 代的时间里，我们期望在任何给定的中性位点上，有 $0.1$ 个替换已经发生并被固定。这种规律性源于替换率独立于群体大小等人口学参数，是分子钟的理论基础。", "answer": "$$\\boxed{0.1}$$", "id": "2818739"}, {"introduction": "在理论基础上，我们转向实际应用：如何从真实的DNA序列差异中估算物种分化时间。观察到的序列差异比例（$p$）常常低估了真实的演化距离（$D$），因为在漫长的演化过程中，同一位点可能发生多次替换。本练习将介绍经典的Jukes-Cantor（JC69）模型，让你亲手实践如何校正“多重替换”效应，并结合分子钟假说，将序列差异转化为以百万年为单位的时间尺度。[@problem_id:2818705]", "problem": "比较两个直系同源的蛋白质编码序列，每个序列的长度都足够长，可以忽略抽样方差，观测到的核苷酸差异比例为 $p=0.15$。假设各位点在 Jukes–Cantor 1969 (JC69) 模型下独立演化，并且中性理论成立，因此每个位点的长期替代率等于每个位点每个单位时间的中性突变率。进一步假设碱基频率相等，所有核苷酸变化之间的瞬时速率相等，具有平稳性和时间可逆性，不存在位点间速率异质性，也没有祖先多态性效应。\n\n设 $D$ 表示在分隔这两个序列的两个谱系上累积的每个位点的预期替代数（即以每个位点的替代数为单位的演化路径长度）。使用 JC69 模型，根据观测到的比例 $p$ 计算校正后的距离 $D$。然后，使用中性理论分子钟，通过公式 $T = D/(2\\mu)$ 估算谱系间的分化时间 $T$，其中中性突变率为 $\\mu = 2 \\times 10^{-9}$ 每位点每年。\n\n- 报告 $D$ 的值（单位：每个位点的替代数），结果保留四位有效数字。\n- 报告 $T$ 的值（单位：百万年，My），结果保留三位有效数字。\n\n用文字简要解释，与使用未经校正的比例 $p$ 作为距离相比，JC69 校正如何影响分化时间的估计。", "solution": "此问题的任务是使用Jukes-Cantor模型计算经多重替换校正后的演化距离 $D$，然后使用分子钟假说估算分化时间 $T$。\n\nJukes-Cantor (1969) 模型是一个核苷酸替换的单参数模型。它假设所有替换以相等的概率发生。观察到的差异位点比例 $p$ 与每个位点的预期替换数 $D$ 之间的关系由以下公式给出：\n$$D = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}p\\right)$$\n这种校正考虑了在演化时间内单个位点上发生的多次替换，而这些多次替换是简单的成对比较所无法捕捉到的。\n\n给定 $p = 0.15$。我们将此值代入 $D$ 的方程中：\n$$D = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}(0.15)\\right)$$\n首先，我们计算括号内的项：\n$$\\frac{4}{3}(0.15) = \\frac{4}{3} \\left(\\frac{15}{100}\\right) = \\frac{60}{300} = \\frac{1}{5} = 0.2$$\n将此结果代回 $D$ 的表达式中：\n$$D = -\\frac{3}{4} \\ln(1 - 0.2) = -\\frac{3}{4} \\ln(0.8)$$\n$0.8$ 的自然对数约等于 $-0.22314355$。因此：\n$$D \\approx -0.75 \\times (-0.22314355) \\approx 0.16735766$$\n题目要求将此值保留四位有效数字。\n$$D \\approx 0.1674 \\text{ 每个位点的替代数}$$\n\n接下来，我们使用给定的分子钟方程 $T = D / (2\\mu)$ 估算分化时间 $T$。数量 $D$ 代表从共同祖先分化出来的两个谱系上每个位点的总替换数。分化以来的时间 $T$ 与每个谱系的替换率相关，该替代率即为中性突变率 $\\mu$。因此，两个序列之间的总分化速率为 $2\\mu$。\n给定中性突变率 $\\mu = 2 \\times 10^{-9}$ 每位点每年。为保持计算精度，我们使用未四舍五入的 $D$ 值进行计算。\n$$T = \\frac{D}{2\\mu} = \\frac{0.16735766 \\text{ 替代数/位点}}{2 \\times (2 \\times 10^{-9} \\text{ 替代数/位点/年})} = \\frac{0.16735766}{4 \\times 10^{-9}} \\text{ 年}$$\n$$T \\approx 41,839,415 \\text{ 年}$$\n题目要求答案以百万年（My）为单位，其中 $1 \\text{ My} = 10^6 \\text{ 年}$。\n$$T \\approx \\frac{41,839,415}{10^6} \\text{ My} \\approx 41.839415 \\text{ My}$$\n保留三位有效数字，我们得到：\n$$T \\approx 41.8 \\text{ My}$$\n\n最后，关于JC69校正如何影响分化时间的估计：\n观测到的差异比例 $p$ 是对不同位点的直接计数，代表了一个原始的、未经校正的距离。这个原始距离系统性地低估了实际的演化事件数量，因为它未能考虑随时间推移在同一核苷酸位点上发生的多次替换。例如，从 A 变为 G，再从 G 变回 A，这导致观测不到差异，但实际上发生了两次替代。类似地，从 A 变为 G，再变为 T，这被计为一次差异（A 对 T），但实际上发生了两次替代。JC69 公式对这些“多次击中”进行校正，提供一个估计值 $D$，对于 $p > 0$ 的情况，$D$ 总是大于 $p$。由于分化时间 $T$ 与距离成正比（$T = D/(2\\mu)$），使用校正后的距离 $D$ 会得到一个更长，因此也更准确的分化时间估计，优于简单地使用未校正比例 $p$ 所得到的结果。用 $p$ 代替 $D$ 必然会导致对真实演化时间的低估。", "answer": "$$\\boxed{\\begin{pmatrix} 0.1674 & 41.8 \\end{pmatrix}}$$", "id": "2818705"}, {"introduction": "对于蛋白质编码序列，并非所有突变都具有相同的演化意义。同义替换（不改变氨基酸）和非同义替换（改变氨基酸）受到的选择压力截然不同，这为我们探测自然选择提供了线索。本练习将引导你计算同义替换率（$d_S$）和非同义替换率（$d_N$），并求解它们的比值 $\\omega$ (即 $d_N/d_S$)，这是衡量选择压力的一个关键指标。通过这个过程，你还将直面并理解一个在深时标演化分析中普遍存在的挑战——替换饱和。[@problem_id:2818709]", "problem": "将两个直系同源编码序列按密码子逐一比对。使用经密码子使用频率加权的Nei–Gojobori位点计数法，同义位点数为$S=540$，非同义位点数为$N=1{,}260$。在成对比对中，观察到的同义差异数和非同义差异数分别为$D_{S}=378$和$D_{N}=189$。假设在每类位点（同义和非同义）中，替换遵循一个时间同质性的连续时间马尔可夫链，且碱基频率相等，转换率相等，即Jukes–Cantor (JC)模型分别适用于同义和非同义两类位点。同时，假设中性理论的前提成立，即同义替换率反映了同义位点的中性突变率，并且分化沿着2个独立的谱系以恒定速率累积。\n\n任务：\n1. 根据位点计数数据，导出观察到的同义和非同义差异比例$p_{S}$和$p_{N}$，然后推断经JC校正的同义和非同义进化距离$d_{S}$和$d_{N}$，分别以每个同义位点和每个非同义位点的预期替换数来衡量。\n2. 计算比率 $\\omega=d_{N}/d_{S}$。\n3. 使用中性同义替换率 $\\mu_{S}=4.0 \\times 10^{-9}$ 每位点每年，根据$d_{S}$以及中性理论中预期分化与时间的关系，在同义位点严格分子钟下估算分化时间$T$（以年为单位）。将您的估算结果转换为百万年（Myr）。将最终的时间估算值四舍五入至四位有效数字，并以Myr表示。\n4. 根据JC模型下从观察到的差异比例$p_{S}$到校正后距离$d_{S}$的映射关系，简要解释在深度分化时间下，同义位点的饱和如何对$d_{S}$以及$\\omega$产生偏差。\n\n为便于评分，请仅报告$T$的最终数值（以Myr为单位）作为您的答案，并按要求四舍五入。在最终的方框答案中不要包含单位。", "solution": "步骤1：计算观察到的差异比例和经JC校正的距离。\n根据定义，观察到的同义和非同义差异比例分别为：\n$$\np_{S}=\\frac{D_{S}}{S}=\\frac{378}{540}=\\frac{7}{10}=0.7\n$$\n$$\np_{N}=\\frac{D_{N}}{N}=\\frac{189}{1{,}260}=\\frac{15}{100}=0.15\n$$\n在Jukes–Cantor模型下，从观察到的差异比例$p$到校正后距离$d$的映射关系为\n$$\nd \\;=\\; -\\frac{3}{4}\\,\\ln\\!\\left(1-\\frac{4}{3}p\\right).\n$$\n将此应用于同义类别：\n$$\nd_{S} \\;=\\; -\\frac{3}{4}\\,\\ln\\!\\left(1-\\frac{4}{3}\\cdot 0.7\\right)\n\\;=\\; -\\frac{3}{4}\\,\\ln\\!\\left(1-\\frac{28}{30}\\right)\n\\;=\\; -\\frac{3}{4}\\,\\ln\\!\\left(\\frac{2}{30}\\right)\n\\;=\\; -\\frac{3}{4}\\,\\ln\\!\\left(\\frac{1}{15}\\right)\n\\;=\\; \\frac{3}{4}\\,\\ln(15).\n$$\n对于非同义类别：\n$$\nd_{N} \\;=\\; -\\frac{3}{4}\\,\\ln\\!\\left(1-\\frac{4}{3}\\cdot 0.15\\right)\n\\;=\\; -\\frac{3}{4}\\,\\ln\\!\\left(1-0.2\\right)\n\\;=\\; -\\frac{3}{4}\\,\\ln(0.8)\n\\;=\\; \\frac{3}{4}\\,\\ln(1.25).\n$$\n作为数值参考，\n$$\nd_{S} \\;=\\; \\frac{3}{4}\\,\\ln(15) \\;\\approx\\; 2.031037651,\n\\qquad\nd_{N} \\;=\\; \\frac{3}{4}\\,\\ln(1.25) \\;\\approx\\; 0.167357663.\n$$\n\n步骤2：计算 $\\omega$。\n根据定义，\n$$\n\\omega \\;=\\; \\frac{d_{N}}{d_{S}} \\;=\\; \\frac{\\frac{3}{4}\\ln(1.25)}{\\frac{3}{4}\\ln(15)} \\;=\\; \\frac{\\ln(1.25)}{\\ln(15)} \\;\\approx\\; 0.082429311.\n$$\n\n步骤3：根据$d_{S}$和$\\mu_{S}$估算分化时间$T$。\n根据同义位点的中性理论，两个谱系在时间$T$后的预期分化（校正后距离）为\n$$\nd_{S} \\;=\\; 2\\,\\mu_{S}\\,T,\n$$\n因此\n$$\nT \\;=\\; \\frac{d_{S}}{2\\,\\mu_{S}}.\n$$\n当$\\mu_{S}=4.0\\times 10^{-9}$每位点每年且$d_{S}=\\frac{3}{4}\\ln(15)$时，\n$$\nT \\;=\\; \\frac{\\frac{3}{4}\\ln(15)}{2 \\times 4.0\\times 10^{-9}}\n\\;=\\; \\frac{\\frac{3}{4}\\ln(15)}{8.0\\times 10^{-9}}\n\\;\\approx\\; \\frac{2.031037651}{8.0\\times 10^{-9}}\n\\;\\approx\\; 2.538796\\!\\times\\! 10^{8}\\ \\text{years}.\n$$\n通过除以$10^{6}$将其转换为百万年（Myr）：\n$$\nT_{\\mathrm{Myr}} \\;=\\; \\frac{2.538796\\!\\times\\! 10^{8}}{10^{6}} \\;=\\; 253.8796\\ \\text{Myr}.\n$$\n按要求四舍五入至四位有效数字：\n$$\nT_{\\mathrm{Myr}} \\;\\approx\\; 253.9\\ \\text{Myr}.\n$$\n\n步骤4：讨论同义位点的饱和偏差及其对$d_{S}$和$\\omega$的影响。\n在JC映射$d = -\\frac{3}{4}\\ln(1-\\frac{4}{3}p)$下，观察到的差异比例$p$的上限为$3/4$，因为在长时间尺度上，状态相同的概率接近$1/4$。随着真实分化程度增大，$p$会趋近于$3/4$，并且对进一步的替换变得越来越不敏感（饱和）。如果忽略多次击中并使用朴素估计$d\\approx p$，那么在深度时间上$d_{S}$将因为$p_{S}$不能超过$3/4$而被严重低估；对于本数据，朴素估计$d_{S}^{\\mathrm{naive}}=p_{S}=0.7$将得出\n$$\nT^{\\mathrm{naive}} \\;=\\; \\frac{0.7}{2\\cdot 4.0\\times 10^{-9}} \\;=\\; 8.75\\times 10^{7}\\ \\text{years} \\;=\\; 87.5\\ \\text{Myr},\n$$\n相对于经JC校正的$253.9\\ \\text{Myr}$，这是一个严重的低估。即使应用像JC这样的参数校正，当$p_{S}$接近$3/4$时，估计量也会变得高度可变，并对模型错误设定（碱基组成偏向、转换-颠换偏向、位点间速率变异）敏感。$d_{S}$在深度时间上的残余低估会使$\\omega=d_{N}/d_{S}$膨胀，可能模拟出正选择的信号。更真实的密码子模型，包含位点间速率异质性以及适当的碱基组成和转换-颠换参数，通过最大似然法或贝叶斯方法进行拟合，可以减轻——但不能完全消除——深度分化中由饱和引起的偏差和不确定性。", "answer": "$$\\boxed{253.9}$$", "id": "2818709"}]}