{"hands_on_practices": [{"introduction": "理论的精髓在于实践。在本节中，我们将通过一系列动手实践，将前几章讨论的古生物学和演化生物学的核心概念付诸实践。这些练习旨在磨练您的定量技能和概念推理能力，让您像一位真正的科学家一样，从原始数据中提取演化证据。我们的第一项实践是地质年代学的“侦探工作”。放射性同位素测年法为化石记录提供了至关重要的时间框架，但测年结果并非绝对可靠。本练习将训练您识别同位素数据中的系统性偏差，区分由样本污染引起的“伪年龄”和由开放体系行为导致的年龄失真，这是批判性评估任何基于化石的演化时间表的关键一步 [@problem_id:2798029]。", "problem": "一个含化石的地层序列被上下两个火山灰层所夹持，您希望通过评估这些火山灰层的放射性年龄，来为形态演化的节奏提供证据。您从每个火山灰层中测量了一系列同源全岩样品，以在标准坐标系 $x = {}^{87}\\mathrm{Rb}/{}^{86}\\mathrm{Sr}$ 和 $y = {}^{87}\\mathrm{Sr}/{}^{86}\\mathrm{Sr}$ 中构建铷-锶等时线。然后，您进行加权最小二乘法拟合，并检查 $y$ 的残差与 $x$ 的函数关系以及加权偏差均方（MSWD；Mean Square of Weighted Deviates）。\n\n请仅基于以下基本原理进行推理：\n\n- 放射性衰变与增生：母体原子数随时间演化为 $N_P(t) = N_P(0)\\,e^{-\\lambda t}$，产生的放射成因子体原子数为 $N_D^\\ast(t) = N_P(0)\\,(1-e^{-\\lambda t})$，其中衰变常数为 $\\lambda$，时间为 $t$。\n- 等时线构建假设一组同源样品具有共同的初始子体与归一化同位素比值，并表现为封闭体系；用非放射成因同位素（例如，对锶而言为 ${}^{86}\\mathrm{Sr}$）进行归一化，可以消除绝对浓度的初始非均一性的影响。\n- 混合与质量平衡：在双组分混合物中，混合物的同位素比值通过特定同位素的质量平衡获得，并且当比值用第三种同位素（例如 ${}^{86}\\mathrm{Sr}$）归一化时，通常是混合比例的有理函数。\n\n基于这些原理，推断当您在 $(x,y)$ 平面上强制进行线性拟合时，对封闭体系等时线模型的偏离将如何体现在等时线残差的模式中。具体而言，请区分以下两种情况：\n\n- 与原生火山灰在 $x$ 和 $y$ 值上均不相同的碎屑端元发生双组分混合所造成的污染。\n- 同位素封闭后的开放体系行为，涉及部分样品中放射成因子体 ${}^{87}\\mathrm{Sr}$ 的丢失，且丢失比例可能在样品组中有所不同。\n\n在上述两种情况下，对于最佳拟合直线的残差和MSWD，应预期看到哪些诊断性模式？以下哪些选项正确地提出了这些模式？请选择所有适用选项。\n\nA. 双组分混合污染通常会在 $(x,y)$ 数据阵列中产生系统性弯曲，因为混合比是混合分数的有理函数。当强制进行线性拟合时，$y$ 对 $x$ 的带符号残差通常会在 $x$ 的范围内反转符号（例如，在低 $x$ 和高 $x$ 处为负，在中间 $x$ 处为正，或反之），从而产生“S形”模式和一个升高的MSWD值，如果移除高杠杆端元，该值会显著降低。\n\nB. 封闭后放射成因 ${}^{87}\\mathrm{Sr}$ 的开放体系丢失，如果样品间的丢失比例不同，将优先压低具有较大 $x$ 值的样品的 $y$ 值，因为放射成因增生项与 $x$ 成正比。相对于共同的最佳拟合斜率，残差将倾向于为负，并且其绝对值大约与 $x$ 成比例增加，同时MSWD值将升高。\n\nC. 双组分混合污染将使残差无结构且与 $x$ 无关（在零附近随机分布），因为混合只增加了随机散布；MSWD将接近1，移除杠杆点几乎没有影响。\n\nD. 封闭后放射成因 ${}^{87}\\mathrm{Rb}$ 的开放体系丢失将使残差关于零对称且在低 $x$ 处最大，并产生一个表观更老（更陡）的斜率；因为 $y$ 不受影响，所以残差不应与 $x$ 相关，MSWD将保持接近1。", "solution": "对所述问题进行严格验证。\n\n**步骤1：提取已知条件**\n- **体系**：火山灰层中同源全岩样品的Rb-Sr等时线分析。\n- **坐标**：$x = {}^{87}\\mathrm{Rb}/{}^{86}\\mathrm{Sr}$，$y = {}^{87}\\mathrm{Sr}/{}^{86}\\mathrm{Sr}$。\n- **分析**：加权最小二乘法线性回归，检查 $y$ 的残差，以及加权偏差均方（MSWD）。\n- **控制原理**：\n    1.  放射性衰变：$N_P(t) = N_P(0)\\,e^{-\\lambda t}$。\n    2.  放射成因增生：$N_D^\\ast(t) = N_P(0)\\,(1-e^{-\\lambda t})$。\n    3.  等时线假设：同源样品，共同的初始子体比值，以及封闭体系行为。\n    4.  混合：双组分混合物的同位素比值是混合比例的有理函数。\n- **待区分的情景**：\n    1.  双组分混合造成的污染。\n    2.  放射成因 ${}^{87}\\mathrm{Sr}$ 丢失的开放体系行为。\n\n**步骤2：问题陈述的验证**\n该陈述在科学上基于同位素地球化学和地质年代学的原理。关于放射性衰变、等时线构建、混合和开放体系扰动的物理模型是标准的且陈述正确。问题设定良好、客观且自洽，提供了足够的信息来推断指定的地质情景对分析结果的影响。不存在科学缺陷、矛盾或歧义。该问题是对地质年代学概念理解的有效检验。\n\n**结论：** 问题有效。开始求解。\n\n**等时线模型及扰动的推导**\n\n首先，我们根据所提供的原理建立理想的等时线方程。在形成后经过时间 $t$，子体同位素 ${}^{87}\\mathrm{Sr}$（记为 $D$）的原子数是初始原子数 $D_0$ 与由母体同位素 ${}^{87}\\mathrm{Rb}$（记为 $P$）衰变产生的放射成因原子数 $D^*$ 之和。\n根据给定原理，放射成因原子数为 $D^*(t) = P(0)(1 - e^{-\\lambda t})$。利用衰变定律 $P(0) = P(t)e^{\\lambda t}$，上式变为 $D^*(t) = P(t)(e^{\\lambda t} - 1)$。\n子体原子总数为 $D(t) = D_0 + P(t)(e^{\\lambda t} - 1)$。\n为构建等时线，我们用同一元素的稳定非放射成因同位素 ${}^{86}\\mathrm{Sr}$（记为 $S_{ref}$）进行归一化。该同位素不是由衰变产生的，其数量是恒定的。两边同除以 $S_{ref}$ 得：\n$$ \\frac{D(t)}{S_{ref}} = \\frac{D_0}{S_{ref}} + \\frac{P(t)}{S_{ref}}(e^{\\lambda t} - 1) $$\n该方程的形式为 $y = y_0 + x \\cdot m$，其中坐标为 $y = {}^{87}\\mathrm{Sr}/{}^{86}\\mathrm{Sr}$ 和 $x = {}^{87}\\mathrm{Rb}/{}^{86}\\mathrm{Sr}$。初始比值为 $y_0 = ({}^{87}\\mathrm{Sr}/{}^{86}\\mathrm{Sr})_0$，斜率为 $m = e^{\\lambda t} - 1$。一组同源样品将具有相同的年龄 $t$ 和初始比值 $y_0$，因此它们在 $(x, y)$ 平面上必须落在一条直线上（即等时线）。\n\n我们现在分析两种指定的地质复杂情况。\n\n**情景1：双组分混合污染**\n设原生火山灰为端元 $A$，碎屑污染物为端元 $C$。一个被测量的样品是包含质量分数为 $f$ 的污染物 $C$ 和 $(1-f)$ 的火山灰 $A$ 的混合物。混合物中任何同位素 $I$ 的浓度 $[I]_M$ 由质量平衡方程给出：$[I]_M = f[I]_C + (1-f)[I]_A$。\n混合物的坐标 $x_M$ 和 $y_M$ 为：\n$$ x_M = \\frac{[{}^{87}\\mathrm{Rb}]_M}{[{}^{86}\\mathrm{Sr}]_M} = \\frac{f \\cdot [{}^{87}\\mathrm{Rb}]_C + (1-f) \\cdot [{}^{87}\\mathrm{Rb}]_A}{f \\cdot [{}^{86}\\mathrm{Sr}]_C + (1-f) \\cdot [{}^{86}\\mathrm{Sr}]_A} $$\n$$ y_M = \\frac{[{}^{87}\\mathrm{Sr}]_M}{[{}^{86}\\mathrm{Sr}]_M} = \\frac{f \\cdot [{}^{87}\\mathrm{Sr}]_C + (1-f) \\cdot [{}^{87}\\mathrm{Sr}]_A}{f \\cdot [{}^{86}\\mathrm{Sr}]_C + (1-f) \\cdot [{}^{86}\\mathrm{Sr}]_A} $$\n正如问题基本原理中正确陈述的那样，这些是混合分数 $f$ 的有理函数。在一般情况下，即归一化同位素 $[{}^{86}\\mathrm{Sr}]$ 的浓度在端元 $A$ 和 $C$ 之间不同时，对于 $f \\in [0, 1]$，点 $(x_M, y_M)$ 的轨迹形成一条双曲线，而不是一条直线。\n如果对位于曲线上的数据强制进行线性拟合，残差 $r_i = y_{i,measured} - y_{i,fitted}$ 将表现出系统性的、非随机的模式。对于简单的凹形或凸形曲线，残差通常在数据范围的两端为一种符号，在中间为相反符号（例如，负-正-负）。这在残差对 $x$ 的图上产生了一个结构化的、通常是“S形”或抛物线形的模式。线性模型无法描述弯曲数据将导致一个很大的MSWD值（MSWD $\\gg 1$），表明拟合不佳。最接近纯端元（低 $f$ 和高 $f$）的样品是高杠杆点，它们最强烈地定义了曲率。移除这些点可能会使剩余的、更靠近中心的点看起来更线性，从而人为地改善拟合统计数据（即降低MSWD）。\n\n**情景2：放射成因 ${}^{87}\\mathrm{Sr}$ 的开放体系丢失**\n这种扰动发生在体系演化了年龄 $t$ 之后。测得的 $y$ 值被改变。设样品 $i$ 中丢失了比例为 $\\alpha_i$ 的*放射成因* ${}^{87}\\mathrm{Sr}$。样品 $i$ 中放射成因 ${}^{87}\\mathrm{Sr}$ 的量为 $D_i^* = P_i(t)(e^{\\lambda t}-1)$。\n测量到的 ${}^{87}\\mathrm{Sr}$ 值 $D'_{i}$ 变为 $D'_{i} = D_0 + (1-\\alpha_i)D_i^*$。对样品 $i$ 两边同除以 $S_{ref}$：\n$$ y'_i = \\frac{D_0}{S_{ref}} + (1-\\alpha_i) \\frac{P_i(t)}{S_{ref}}(e^{\\lambda t}-1) = y_0 + (1-\\alpha_i) x_i m $$\n原始未受扰动的值为 $y_i = y_0 + x_i m$。扰动将每个点 $(x_i, y_i)$ 垂直向下移动到新位置 $(x_i, y'_i)$。位移的大小为 $\\Delta y_i = y'_i - y_i = -\\alpha_i x_i m$。\n该位移与 $x_i$ 成正比：具有更高Rb/Sr比值（即更大的 $x_i$）的样品产生了更多的放射成因 ${}^{87}\\mathrm{Sr}$，因此在给定的丢失比例 $\\alpha_i$ 下，其 $y$ 值的绝对降低量更大。\n因为丢失比例 $\\alpha_i$ 在样品间各不相同，这会引入散布。数据点不再位于一条直线上。总体效果是将数据点阵列向更平缓的斜率方向旋转，从而得出一个伪年轻的年龄。$\\alpha_i$ 的叠加随机变化增加了分析不确定性无法解释的散布，因此MSWD将升高（MSWD $> 1$）。\n关于新最佳拟合线的残差：对于高 $x$ 值的样品，向下的位移是最大的。最佳拟合线将尝试穿过这个受扰动的点云。低 $x$ 值的样品受影响最小，可能会将拟合线锚定在真实截距附近。因此，被显著拉低的高 $x$ 值样品将倾向于位于最佳拟合线的下方，导致较大的负残差。这些负残差的大小会随着 $x$ 的增加而趋向于更大的负值。这表明残差的方差随 $x$ 的增加而增加（异方差性）。\n\n**选项评估**\n\n**A. 双组分混合污染通常会在 $(x,y)$ 数据阵列中产生系统性弯曲，因为混合比是混合分数的有理函数。当强制进行线性拟合时，$y$ 对 $x$ 的带符号残差通常会在 $x$ 的范围内反转符号（例如，在低 $x$ 和高 $x$ 处为负，在中间 $x$ 处为正，或反之），从而产生“S形”模式和一个升高的MSWD值，如果移除高杠杆端元，该值会显著降低。**\n该陈述精确而准确地总结了如上所推导的双组分混合的后果。弯曲、系统性残差、升高的MSWD值以及移除端元的影响都是混合作用的经典指标。\n结论：**正确**。\n\n**B. 封闭后放射成因 ${}^{87}\\mathrm{Sr}$ 的开放体系丢失，如果样品间的丢失比例不同，将优先压低具有较大 $x$ 值的样品的 $y$ 值，因为放射成因增生项与 $x$ 成正比。相对于共同的最佳拟合斜率，残差将倾向于为负，并且其绝对值大约与 $x$ 成比例增加，同时MSWD值将升高。**\n该陈述准确地描述了 ${}^{87}\\mathrm{Sr}$ 丢失的影响。$y$ 值的降低确实对较大的 $x$ 更为显著。由此产生的散布将使MSWD升高。对残差模式的描述——在高 $x$ 处残差趋向于越来越负——是该过程的一个合理且公认的诊断特征，因为它反映了数据阵列围绕一个低 $x$ 枢轴点的顺时针旋转。\n结论：**正确**。\n\n**C. 双组分混合污染将使残差无结构且与 $x$ 无关（在零附近随机分布），因为混合只增加了随机散布；MSWD将接近1，移除杠杆点几乎没有影响。**\n该陈述根本上是错误的。混合是一个确定性过程，它产生的是曲率，而不是随机散布。这会导致结构化的残差和高的MSWD值。与陈述相反，移除杠杆点的影响是显著的。\n结论：**错误**。\n\n**D. 封闭后放射成因 ${}^{87}\\mathrm{Rb}$ 的开放体系丢失将使残差关于零对称且在低 $x$ 处最大，并产生一个表观更老（更陡）的斜率；因为 $y$ 不受影响，所以残差不应与 $x$ 相关，MSWD将保持接近1。**\n该选项描述了一个不同的情景，即母体同位素 ${}^{87}\\mathrm{Rb}$ 的丢失。Rb的丢失影响 $x$ 坐标，将数据点水平向左移动。这确实会导致更陡的斜率和更老的表观年龄。然而，关于残差的说法是错误的。这种扰动是系统性的，会导致相关的残差模式（例如，在低 $x'$ 处为负，在高 $x'$ 处为正），而不是对称的模式。这种对直线的系统性偏离将导致MSWD升高，而不是接近1。\n结论：**错误**。\n\n基于此分析，选项A和B正确描述了两种指定情景下的诊断模式。", "answer": "$$\\boxed{AB}$$", "id": "2798029"}, {"introduction": "在建立了可靠的时间框架后，我们面临下一个关键问题：化石记录本身有多完整？众所周知，化石记录是不完美的，但这种不完美性可以通过统计方法进行量化。本练习将引导您使用最大似然估计（Maximum Likelihood Estimation, MLE）这一强大的统计工具，从化石产出时间序列数据中分离出两个关键参数：真实的保存率和地质采样率 [@problem_id:2798052]。掌握这项技能使我们能够从简单地计算化石数量，跃升到更深入地理解化石形成过程本身，从而更准确地解释我们观察到的多样性模式。", "problem": "根据独立的系统发育学和地层学证据，一个单一分类单元被推断从时间起点 $t=0$ 连续存在至灭绝时间 $t=T$，其中 $T=10$ 百万年 (Myr)。在这个已知的存在区间内，观测到 $n=8$ 次化石出现，其绝对时间（单位为自从起源以来的百万年）如下：$t=\\{0.3,\\,1.1,\\,1.6,\\,3.2,\\,3.3,\\,5.0,\\,6.7,\\,8.9\\}$。假设保存-采样机制是均匀的，使得在 $[0,T]$ 上的化石观测记录服从一个均匀泊松过程，其净观测率为 $\\lambda$（单位：次/百万年）。进一步假设净观测率是一个未知的每次采样机会的保存产出率 $\\mu$（单位：预期出现次数/每次采样机会）和一个未知的采样机会率 $\\nu$（单位：采样机会次数/百万年）的乘积，因此 $\\lambda=\\mu\\,\\nu$。\n\n为了能分别识别 $\\mu$ 和 $\\nu$，我们还提供了将 $[0,T]$ 划分为四个不重叠子区间后，各子区间内采样机会计数 $L_i$ 的一个独立编制的时间序列，各子区间时长为 $\\Delta t_i$：\n- 区间 1：$[0,2]$ 百万年，$\\Delta t_1=2$ 百万年，$L_1=8$。\n- 区间 2：$(2,5]$ 百万年，$\\Delta t_2=3$ 百万年，$L_2=16$。\n- 区间 3：$(5,7]$ 百万年，$\\Delta t_3=2$ 百万年，$L_3=10$。\n- 区间 4：$(7,10]$ 百万年，$\\Delta t_4=3$ 百万年，$L_4=16$。\n\n假设采样机会以均匀泊松过程的形式出现，其率为 $\\nu$，因此 $L_i$ 是独立的泊松随机变量，其均值为 $\\nu\\,\\Delta t_i$，并且与保存过程无关。在间断-分析建模框架（在固定的已知时长 $T$ 上的均匀泊松出现）下，推导出 $\\mu$ 和 $\\nu$ 的联合最大似然估计量 (MLE)，然后根据上述数据计算它们的数值。将两个估计值四舍五入至三位有效数字。$\\mu$ 的单位表示为“次出现/每次采样机会”，$\\nu$ 的单位表示为“次采样机会/百万年”。将最终答案以行向量 $\\big(\\hat{\\mu}\\ \\hat{\\nu}\\big)$ 的形式报告。", "solution": "所述问题具有科学依据、提法明确、客观，且包含足够信息以获得唯一解。这是一个应用于古生物学数据的统计推断中的标准问题。我们可以开始解答。\n\n问题要求推导每次采样机会的保存产出率 $\\mu$ 和采样机会率 $\\nu$ 的联合最大似然估计量 (MLEs)。观测值的总集合包含两个独立部分：第一，化石出现的次数和时间点；第二，在划分的时间区间内的采样机会计数。因此，总似然函数 $\\mathcal{L}(\\mu, \\nu)$ 是与这两个独立数据集相关的似然函数的乘积。\n设 $\\mathcal{L}_1$ 是化石出现数据的似然函数，$\\mathcal{L}_2$ 是采样机会数据的似然函数。总似然函数为 $\\mathcal{L}(\\mu, \\nu) = \\mathcal{L}_1(\\mu, \\nu) \\times \\mathcal{L}_2(\\nu)$。\n\n首先，我们构建 $\\mathcal{L}_1(\\mu, \\nu)$。化石出现被建模为一个在已知时间区间 $[0, T]$ 上的均匀泊松过程，其净观测率为 $\\lambda = \\mu \\nu$。对于一个均匀泊松过程，在时长为 $T$ 的区间内观测到 $n$ 个事件的似然由该过程的概率密度函数给出，即 $\\lambda^n \\exp(-\\lambda T)$。对于均匀过程，除了事件总数 $n$ 之外，事件的具体时间点不提供关于率 $\\lambda$ 的额外信息。\n代入 $\\lambda = \\mu \\nu$，化石数据的似然函数为：\n$$ \\mathcal{L}_1(\\mu, \\nu) = (\\mu \\nu)^n \\exp(-\\mu \\nu T) $$\n根据给定数据 $n=8$ 和 $T=10$ 百万年 (Myr)，该式变为：\n$$ \\mathcal{L}_1(\\mu, \\nu) = (\\mu \\nu)^8 \\exp(-10 \\mu \\nu) $$\n\n其次，我们构建 $\\mathcal{L}_2(\\nu)$。采样机会被建模为率为 $\\nu$ 的均匀泊松过程。我们在四个时长为 $\\Delta t_i$ 的独立不重叠区间内观测到计数 $L_i$。在区间 $i$ 内的机会次数 $L_i$ 是一个均值为 $\\nu \\Delta t_i$ 的泊松随机变量。由于其独立性，观测到集合 $\\{L_1, L_2, L_3, L_4\\}$ 的似然是各个泊松概率的乘积：\n$$ \\mathcal{L}_2(\\nu) = \\prod_{i=1}^{4} P(L_i | \\nu, \\Delta t_i) = \\prod_{i=1}^{4} \\frac{(\\nu \\Delta t_i)^{L_i} \\exp(-\\nu \\Delta t_i)}{L_i!} $$\n这可以写成：\n$$ \\mathcal{L}_2(\\nu) = \\left( \\prod_{i=1}^{4} \\frac{(\\Delta t_i)^{L_i}}{L_i!} \\right) \\nu^{\\sum L_i} \\exp\\left(-\\nu \\sum \\Delta t_i\\right) $$\n括号中的项是关于参数 $\\nu$ 的常数。\n\n联合似然 $\\mathcal{L}(\\mu, \\nu)$ 是 $\\mathcal{L}_1$ 和 $\\mathcal{L}_2$ 的乘积。处理似然的自然对数（即对数似然函数 $\\ell(\\mu, \\nu) = \\ln(\\mathcal{L}(\\mu, \\nu))$）更为方便。\n$$ \\ell(\\mu, \\nu) = \\ln(\\mathcal{L}_1(\\mu, \\nu)) + \\ln(\\mathcal{L}_2(\\nu)) $$\n$$ \\ell(\\mu, \\nu) = [n \\ln(\\mu \\nu) - \\mu \\nu T] + \\left[ \\sum_{i=1}^{4} L_i \\ln(\\nu) + \\sum_{i=1}^{4} (L_i \\ln(\\Delta t_i) - \\ln(L_i!)) - \\nu \\sum_{i=1}^{4} \\Delta t_i \\right] $$\n我们可以将包含 $\\mu$ 和 $\\nu$ 的项分组，并舍去不依赖于这些参数的常数项，因为它们不影响最大化过程。设 $L_{tot} = \\sum_{i=1}^4 L_i$ 且 $\\Delta t_{tot} = \\sum_{i=1}^4 \\Delta t_i$。\n$$ \\ell(\\mu, \\nu) = n \\ln(\\mu) + n \\ln(\\nu) - \\mu \\nu T + L_{tot} \\ln(\\nu) - \\nu \\Delta t_{tot} + C $$\n其中 $C$ 是一个常数。这可以简化为：\n$$ \\ell(\\mu, \\nu) = n \\ln(\\mu) + (n + L_{tot}) \\ln(\\nu) - \\mu \\nu T - \\nu \\Delta t_{tot} + C $$\n\n为了找到 MLE $(\\hat{\\mu}, \\hat{\\nu})$，我们求 $\\ell(\\mu, \\nu)$ 关于 $\\mu$ 和 $\\nu$ 的偏导数，并将它们设为零。\n\n关于 $\\mu$ 的偏导数：\n$$ \\frac{\\partial \\ell}{\\partial \\mu} = \\frac{n}{\\mu} - \\nu T = 0 $$\n$$ \\implies \\frac{n}{\\hat{\\mu}} = \\hat{\\nu} T \\implies \\hat{\\mu}\\hat{\\nu} = \\frac{n}{T} $$\n这个结果表明，总率 $\\lambda$ 的 MLE 是 $\\hat{\\lambda} = n/T$，这是泊松率的标准 MLE。\n\n关于 $\\nu$ 的偏导数：\n$$ \\frac{\\partial \\ell}{\\partial \\nu} = \\frac{n + L_{tot}}{\\nu} - \\mu T - \\Delta t_{tot} = 0 $$\n$$ \\implies \\frac{n + L_{tot}}{\\hat{\\nu}} = \\hat{\\mu} T + \\Delta t_{tot} $$\n\n我们现在得到一个关于估计量 $\\hat{\\mu}$ 和 $\\hat{\\nu}$ 的方程组：\n1.  $\\hat{\\mu} T = \\frac{n}{\\hat{\\nu}}$\n2.  $\\frac{n + L_{tot}}{\\hat{\\nu}} = \\hat{\\mu} T + \\Delta t_{tot}$\n\n将第一个方程代入第二个方程：\n$$ \\frac{n + L_{tot}}{\\hat{\\nu}} = \\frac{n}{\\hat{\\nu}} + \\Delta t_{tot} $$\n$$ \\frac{L_{tot}}{\\hat{\\nu}} = \\Delta t_{tot} $$\n这就得出了 $\\nu$ 的估计量：\n$$ \\hat{\\nu} = \\frac{L_{tot}}{\\Delta t_{tot}} = \\frac{\\sum_{i=1}^{4} L_i}{\\sum_{i=1}^{4} \\Delta t_i} $$\n这是总采样机会数除以总时长，即采样机会过程的率 $\\nu$ 的 MLE。\n\n现在，我们使用第一个方程求解 $\\hat{\\mu}$：$\\hat{\\mu} = \\frac{n}{T \\hat{\\nu}}$。\n代入 $\\hat{\\nu}$ 的表达式：\n$$ \\hat{\\mu} = \\frac{n}{T \\left(\\frac{\\sum L_i}{\\sum \\Delta t_i}\\right)} $$\n问题的设定使得用于采样机会计数的子区间的总时长等于该分类单元存在的总时长：$T = \\sum_{i=1}^{4} \\Delta t_i$。因此，表达式简化为：\n$$ \\hat{\\mu} = \\frac{n}{\\sum_{i=1}^{4} L_i} $$\n这个 $\\mu$ 的估计量是观测到的化石总数除以观测到的采样机会总数。\n\n现在我们计算数值。\n已知条件为：\n- $n = 8$\n- $T = 10$ 百万年\n- 子区间数据：\n  - $L_1=8, \\Delta t_1 = 2$ 百万年\n  - $L_2=16, \\Delta t_2 = 3$ 百万年\n  - $L_3=10, \\Delta t_3 = 2$ 百万年\n  - $L_4=16, \\Delta t_4 = 3$ 百万年\n\n首先，我们计算总计数和总时长：\n$$ \\sum_{i=1}^{4} L_i = 8 + 16 + 10 + 16 = 50 $$\n$$ \\sum_{i=1}^{4} \\Delta t_i = 2 + 3 + 2 + 3 = 10 \\text{ 百万年} $$\n正如预期，$\\sum \\Delta t_i = T$。\n\n现在，我们计算 $\\hat{\\nu}$ 和 $\\hat{\\mu}$ 的估计值：\n$$ \\hat{\\nu} = \\frac{\\sum L_i}{\\sum \\Delta t_i} = \\frac{50}{10} = 5 $$\n单位是“次采样机会/百万年”。\n\n$$ \\hat{\\mu} = \\frac{n}{\\sum L_i} = \\frac{8}{50} = \\frac{4}{25} = 0.16 $$\n单位是“次出现/每次采样机会”。\n\n问题要求四舍五入至三位有效数字。\n$\\hat{\\nu} = 5.00$ 次采样机会/百万年。\n$\\hat{\\mu} = 0.160$ 次出现/每次采样机会。\n\n最终答案以行向量 $(\\hat{\\mu}\\ \\hat{\\nu})$ 的形式报告。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.160 & 5.00\n\\end{pmatrix}\n}\n$$", "id": "2798052"}, {"introduction": "最后的实践将前两步的成果——一个经过严格评估的时间框架和对记录完整性的量化理解——整合起来，用于检验演化论的一个核心预测：来自不同独立证据来源的演化树应该具有一致性。在本练习中，我们将比较由化石形态数据和现代分子数据分别构建的系统发育树 [@problem_id:2798010]。您将学习计算两种拓扑结构之间的Robinson-Foulds距离，这是一种衡量树形差异的经典方法，并通过置换检验来评估它们的一致性是否显著高于随机预期的水平。这项综合性任务完美地体现了现代演化生物学如何融合不同领域的证据，以构建一幅连贯的生命历史画卷。", "problem": "一个研究团队正在比较一个基于化石的形态学数据集和一个针对相同分类单元的分子序列比对之间的系统发育信号，以通过一致的层级模式来评估共同起源的证据。该团队从每个数据集中推断出一棵无根、完全解析的树：最简约形态树和最大似然分子树。在包含 $n$ 个分类单元的无根、完全解析的树中，每条内部边都会引起分类单元集的一次二分（分割），每棵树有 $n-3$ 个这样的非平凡分割。Robinson–Foulds (RF) 距离计算两棵树之间不共享的非平凡分割的数量，这将基于共享层级结构的拓扑一致性度量进行了操作化。用于检验一致性的置换检验通过随机化一棵树上的分类单元标签，来生成一个在数据集不相关的情况下随机预期的 RF 距离的零分布。\n\n现为您提供关于 $n=6$ 个分类单元 $\\{A,B,C,D,E,F\\}$ 的以下信息：\n- 形态树拓扑（无根）：Newick 格式 $=$ $((A,B),(C,D),(E,F))$。\n- 分子树拓扑（无根）：Newick 格式 $=$ $((A,B),(C,E),(D,F))$。\n\n假设两棵树都是严格二叉的，并被视为无根树。在对分子树的分类单元标签进行 $N=20$ 次独立随机置换（形态树保持不变）后，观测到的 Robinson–Foulds 距离为：\n$\\{6,6,6,4,6,6,6,6,6,6,6,6,4,6,6,6,6,6,6,6\\}$。\n\n使用这些数据：\n1) 通过比较它们的非平凡分割集，计算形态树和分子树之间的观测 Robinson-Foulds 距离。\n2) 使用置换结果，计算过度一致性的单侧置换 $p$ 值，其定义为置换后的 RF 距离中小于或等于观测 RF 距离的值所占的比例。\n\n将 $p$ 值作为您的最终答案。将您的答案四舍五入到四位有效数字，并以小数形式表示（不带百分号）。", "solution": "所述问题具有科学依据，阐述清晰且客观。它提出了计算系统发育学中的一个标准任务：使用 Robinson-Foulds 距离和置换检验来评估两棵进化树之间的一致性。所有术语均为标准术语，并且提供了获得唯一解所需的所有数据。因此，该问题是有效的，我们可以进行分析。\n\n该问题需要两个主要步骤：首先，计算两棵指定树之间的观测 Robinson-Foulds ($RF$) 距离；其次，使用提供的零分布计算此观测距离的置换 $p$ 值。\n\n步骤 1：计算观测 Robinson-Foulds 距离。\n\n一棵具有 $n$ 个分类单元的无根、完全解析的（二叉）树拥有 $n-3$ 条内部边。每条内部边都定义了分类单元集的一个非平凡二分，或称分割。两棵树之间的 Robinson-Foulds 距离是指存在于一棵树中但不存在于另一棵树中的非平凡分割的数量。这等同于它们各自的分割集对称差的大小。\n\n对于给定的问题，分类单元的数量为 $n=6$。因此，每棵树将有 $n-3 = 6-3 = 3$ 个非平凡分割。\n\n设 $S_{morph}$ 为形态树的非平凡分割集， $S_{mol}$ 为分子树的非平凡分割集。分类单元为 $\\{A,B,C,D,E,F\\}$。\n\n首先，我们根据 Newick 字符串 $((A,B),(C,D),(E,F))$ 确定形态树的分割。该拓扑将分类单元分为三对。三条内部边将每一对与其余部分分开。\n这些分割是：\n1. 将分支 $(A,B)$ 与其余部分分开的边。此二分为 $\\{A, B\\} | \\{C, D, E, F\\}$。\n2. 将分支 $(C,D)$ 与其余部分分开的边。此二分为 $\\{C, D\\} | \\{A, B, E, F\\}$。\n3. 将分支 $(E,F)$ 与其余部分分开的边。此二分为 $\\{E, F\\} | \\{A, B, C, D\\}$。\n\n所以，形态树的分割集是：\n$$S_{morph} = \\{ \\{A, B\\} | \\{C, D, E, F\\}, \\quad \\{C, D\\} | \\{A, B, E, F\\}, \\quad \\{E, F\\} | \\{A, B, C, D\\} \\}$$\n\n接下来，我们根据 Newick 字符串 $((A,B),(C,E),(D,F))$ 确定分子树的分割。该拓扑也以成对方式对分类单元进行分组，但方式不同。\n这些分割是：\n1. 将分支 $(A,B)$ 与其余部分分开的边。此二分为 $\\{A, B\\} | \\{C, D, E, F\\}$。\n2. 将分支 $(C,E)$ 与其余部分分开的边。此二分为 $\\{C, E\\} | \\{A, B, D, F\\}$。\n3. 将分支 $(D,F)$ 与其余部分分开的边。此二分为 $\\{D, F\\} | \\{A, B, C, E\\}$。\n\n所以，分子树的分割集是：\n$$S_{mol} = \\{ \\{A, B\\} | \\{C, D, E, F\\}, \\quad \\{C, E\\} | \\{A, B, D, F\\}, \\quad \\{D, F\\} | \\{A, B, C, E\\} \\}$$\n\n现在，我们计算 Robinson-Foulds 距离 $RF_{obs}$。$RF$ 距离由以下公式给出：\n$$RF(T_1, T_2) = |S_1| + |S_2| - 2|S_1 \\cap S_2|$$\n我们必须找到两个分割集的交集 $S_{morph} \\cap S_{mol}$。通过比较 $S_{morph}$ 和 $S_{mol}$ 的元素，我们发现只有一个共同的分割：\n$$S_{morph} \\cap S_{mol} = \\{ \\{A, B\\} | \\{C, D, E, F\\} \\}$$\n共享分割的数量为 $|S_{morph} \\cap S_{mol}| = 1$。每棵树中的分割数量为 $|S_{morph}| = |S_{mol}| = 3$。将这些值代入 RF 距离的公式中：\n$$RF_{obs} = 3 + 3 - 2(1) = 4$$\n形态树和分子树之间的观测 Robinson-Foulds 距离为 $4$。\n\n步骤 2：计算单侧置换 $p$ 值。\n\n该问题将过度一致性的 $p$ 值定义为置换后的 $RF$ 距离中小于或等于观测 $RF$ 距离的值所占的比例。“过度一致性”对应于异常低的 $RF$ 距离，因为 $RF$ 是衡量不相似性的指标。\n\n观测距离为 $RF_{obs} = 4$。\n给出的 $N=20$ 个置换后的 $RF$ 距离集合为：\n$$\\{6, 6, 6, 4, 6, 6, 6, 6, 6, 6, 6, 6, 4, 6, 6, 6, 6, 6, 6, 6\\}$$\n我们必须计算这个集合中小于或等于 $4$ 的值的数量。设这个计数为 $k$。通过检查该集合，我们发现有两个值等于 $4$，没有值小于 $4$。因此，$k=2$。\n\n置换总数为 $N=20$。$p$ 值是分数 $\\frac{k}{N}$。\n$$p = \\frac{2}{20} = \\frac{1}{10} = 0.1$$\n问题要求答案四舍五入到四位有效数字。\n$$p = 0.1000$$\n这是最终计算出的 $p$ 值。", "answer": "$$\\boxed{0.1000}$$", "id": "2798010"}]}