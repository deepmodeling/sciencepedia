{"hands_on_practices": [{"introduction": "三点测交是经典遗传学中确定连锁基因顺序和相对距离的基石。通过分析杂交后代中不同基因型组合的频率，我们可以推断出亲本、单交换和双交换事件的发生情况。这个练习将带你从原始的后代计数数据出发，一步步地推导出三个连锁基因的顺序，并计算它们之间的遗传图距，这是遗传图谱构建的基本功。[@problem_id:2801497]", "problem": "一个在三个基因座 $A$、$B$ 和 $C$ 上均为杂合的三杂合个体，携带连锁相单倍型 $A B C$ 和 $a b c$。该个体与一个三隐性测交亲本 $a b c$ 进行测交。测交后代中的表现型类别直接反映了该三杂合亲本产生的配子。您观测到以下八个后代类别（总数 $N = 10{,}000$）：\n\n- $A B C: 3{,}579$\n- $a b c: 3{,}573$\n- $A b c: 525$\n- $a B C: 523$\n- $A B c: 826$\n- $a b C: 824$\n- $A b C: 76$\n- $a B c: 74$\n\n仅根据经典遗传学中关于重组率、双交换（DCO）和三点测交逻辑的核心定义，推断出线性基因顺序，并计算推断顺序中相邻基因座之间的遗传图距。\n\n- 将基因顺序从左到右报告为基因座索引 $(1,2,3)$ 的一个排列，其中 $1 \\equiv A$，$2 \\equiv B$，$3 \\equiv C$。\n- 计算两个相邻基因座的距离 $d_{1\\text{–}2}$ 和 $d_{2\\text{–}3}$，单位为厘摩（centiMorgan, cM），使用标准的短距离近似法，即重组率乘以 $100$ 等于以 $\\text{cM}$ 为单位的遗传距离。\n- 将每个距离保留四位有效数字。\n- 将您的最终答案表示为单行矩阵 $\\begin{pmatrix} i_1 & i_2 & i_3 & d_{1\\text{–}2} & d_{2\\text{–}3} \\end{pmatrix}$，矩阵内不含单位。在您的解题正文中，请将单位注明为 $\\text{cM}$。", "solution": "对问题进行验证。\n\n逐字提取已知条件：\n- 一个在三个基因座 $A$、$B$ 和 $C$ 上均为杂合的三杂合个体。\n- 该个体携带连锁相单倍型 $A B C$ 和 $a b c$。\n- 该个体与一个三隐性测交亲本 $a b c$ 进行测交。\n- 后代总数为 $N = 10,000$。\n- 后代表现型类别计数：\n  - $A B C: 3,579$\n  - $a b c: 3,573$\n  - $A b c: 525$\n  - $a B C: 523$\n  - $A B c: 826$\n  - $a b C: 824$\n  - $A b C: 76$\n  - $a B c: 74$\n\n验证结论：问题有效。\n- 该问题科学上基于经典遗传学原理，特别是用于基因作图的三点测交分析。\n- 该问题提法明确，为得出唯一解提供了所有必要数据。\n- 语言客观、精确。\n- 数据内部一致；后代计数总和为 $3,579 + 3,573 + 525 + 523 + 826 + 824 + 76 + 74 = 10,000$，与给定的总数 $N$ 相符。互反类型（例如 $A B C$ 和 $a b c$）的数量在数值上相似，这与减数分裂的预期一致。所有有效问题的标准均已满足。\n\n解题过程如下。目标是确定三个基因的线性顺序及其间的遗传距离。三点测交的分析依赖于识别杂合亲本产生的不同类别的配子。由于测交亲本是纯合隐性（$a b c$），后代的表现型直接揭示了来自三杂合亲本的配子的遗传组成。\n\n首先，我们根据后代的频率对其进行分类。原则是亲本型（非重组）配子频率最高，而双交换（DCO）配子频率最低。\n- 两个频率最高的表现型类别是 $A B C$（计数 $3,579$）和 $a b c$（计数 $3,573$）。这些代表亲本型或非重组配子。非重组后代的总数为 $N_{P} = 3,579 + 3,573 = 7,152$。这与给定的亲本单倍型 $A B C$ 和 $a b c$ 一致。\n- 两个频率最低的表现型类别是 $A b C$（计数 $76$）和 $a B c$（计数 $74$）。这些代表双交换（DCO）配子，其产生于两个同时发生的交换事件。DCO 后代的总数为 $N_{DCO} = 76 + 74 = 150$。\n\n接下来，我们确定基因顺序。双交换事件会交换两条亲本染色体之间的中间等位基因。通过比较DCO配子与亲本配子的等位基因组成，我们可以确定位于中间的基因。让我们比较亲本单倍型 $A B C$ 和 DCO 单倍型 $A b C$。基因座 $A$ 和 $C$ 的等位基因相同（$A$ 和 $C$），而基因座 $B$ 的等位基因发生了交换（$B$ 换为 $b$）。这表明基因座 $B$ 位于基因座 $A$ 和 $C$ 之间。因此，正确的基因顺序是 $A - B - C$。根据题目中 $1 \\equiv A$，$2 \\equiv B$，$3 \\equiv C$ 的表示法，基因顺序为 $(1, 2, 3)$。\n\n确定了基因顺序后，我们现在可以对剩下的四个后代类别进行分类，它们是由单交换（SCO）事件产生的。\n- 基因 $A$ 和基因 $B$ 之间的单交换（区域1）会产生配子 $A b c$ 和 $a B C$。这些类别的观测计数分别为 $525$ 和 $523$。区域1的SCO后代总数为 $N_{SCO1} = 525 + 523 = 1,048$。\n- 基因 $B$ 和基因 $C$ 之间的单交换（区域2）会产生配子 $A B c$ 和 $a b C$。这些类别的观测计数分别为 $826$ 和 $824$。区域2的SCO后代总数为 $N_{SCO2} = 826 + 824 = 1,650$。\n\n现在，我们计算遗传图距。两个基因座之间的图距定义为它们之间的重组率，以厘摩（$\\text{cM}$）表示。一厘摩对应 $1\\%$ 的重组率。重组率（$RF$）是重组后代数与后代总数的比值。关键要记住，两个基因座之间的重组事件总数包括该区间内的*所有*单交换*以及所有*双交换。\n\n基因座 $A$ 和基因座 $B$ 之间的距离，记为 $d_{1\\text{–}2}$，计算如下：\n$$RF_{A-B} = \\frac{N_{SCO1} + N_{DCO}}{N_{total}} = \\frac{1,048 + 150}{10,000} = \\frac{1,198}{10,000} = 0.1198$$\n那么图距为：\n$$d_{1\\text{–}2} = RF_{A-B} \\times 100 = 0.1198 \\times 100 = 11.98 \\text{ cM}$$\n该值已为四位有效数字。\n\n基因座 $B$ 和基因座 $C$ 之间的距离，记为 $d_{2\\text{–}3}$，计算方法类似：\n$$RF_{B-C} = \\frac{N_{SCO2} + N_{DCO}}{N_{total}} = \\frac{1,650 + 150}{10,000} = \\frac{1,800}{10,000} = 0.1800$$\n那么图距为：\n$$d_{2\\text{–}3} = RF_{B-C} \\times 100 = 0.1800 \\times 100 = 18.00 \\text{ cM}$$\n该值已给出四位有效数字。\n\n推断出的遗传图为：$A \\xrightarrow{11.98\\text{ cM}} B \\xrightarrow{18.00\\text{ cM}} C$。\n\n为了验证交换事件的非随机性（遗传干涉），我们可以将观测到的DCO频率与预期的DCO频率进行比较。预期的频率是两个相邻区域重组率的乘积：\n$$RF_{expected DCO} = RF_{A-B} \\times RF_{B-C} = 0.1198 \\times 0.1800 \\approx 0.02156$$\n预期的DCO后代数为 $10,000 \\times 0.02156 = 215.6$。\n观测数为 $150$。并发系数为 $C = \\frac{\\text{观测DCO}}{\\text{预期DCO}} = \\frac{150}{215.6} \\approx 0.696$。\n干涉值为 $I = 1 - C = 1 - 0.696 = 0.304$。这个正干涉值表明，一个区域内的交换会降低相邻区域同时发生交换的概率，这是一个常见的生物学现象。\n\n最终答案要求以 $(1,2,3)$ 的排列形式给出基因顺序，以及两个相邻的图距 $d_{1\\text{–}2}$ 和 $d_{2\\text{–}3}$。\n基因顺序是 $A-B-C$，对应于 $(1, 2, 3)$。\n距离为 $d_{1\\text{–}2} = 11.98$ 和 $d_{2\\text{–}3} = 18.00$。\n要求的输出是一个包含这五个值的单行矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 2 & 3 & 11.98 & 18.00\n\\end{pmatrix}\n}\n$$", "id": "2801497"}, {"introduction": "重组率 ($r$) 是可以直接观测的遗传现象，而图距 ($d$) 是一个考虑了多次交换事件的理论距离。本练习旨在深化你对这两个概念之间关系的理解，通过应用两种经典的作图函数——Haldane函数（假设无干涉）和Kosambi函数（假设正干涉），将同一个观测重组率转换为不同的图距。这有助于揭示交叉互换的生物学模型如何影响遗传图谱的构建。[@problem_id:2801515]", "problem": "在一个二倍体物种的大规模回交实验中，根据经验估计，两个共显性遗传标记之间的重组率为 $r=0.22$。假设在此尺度上独立分配定律不适用，并且染色体上的交换形成可以通过两个经典作图函数框架之一来建模。\n\n仅使用以下基本原理：\n- 重组率 $r$ 是指随机抽样的一条染色单体在两个基因座之间是重组型的概率，这种情况发生在该染色单体上两个基因座之间的交换次数为奇数时。\n- 在无干涉模型下，沿二价体的交换位置遵循沿遗传长度的泊松过程，而涉及特定染色单体的交换次数则是一个稀疏泊松过程。\n- 在具有图距可加性的正干涉模型下，Kosambi作图函数是一个被广泛使用且经过充分检验的，用于在重组率和遗传距离之间进行转换的函数。\n\n根据给定的 $r$ 值，分别在Haldane无干涉模型和Kosambi正干涉模型下推导遗传图距，然后计算两种距离之差的绝对值。将这两个距离以厘摩根（cM）为单位表示，其中1摩根等于平均预期每条染色单体发生一次交换的区间长度。按此顺序报告三个值：Haldane距离（cM）、Kosambi距离（cM）和绝对差值（cM）。将报告的每个值四舍五入到4位有效数字。最终报告的值中不要包含任何注释；单位和注释只应出现在您的演算过程中。最终报告的值必须与您展示的推导过程一致。", "solution": "该问题要求使用两种不同的模型——Haldane无干涉模型和Kosambi正干涉模型——根据观测到的重组率计算遗传图距。我们已知经验重组率为 $r = 0.22$。最终结果必须以厘摩根（cM）为单位表示，并四舍五入到4位有效数字。\n\n首先，我们处理Haldane无干涉模型。该模型假设沿染色体二价体的交换事件遵循泊松过程。遗传图距（单位为摩根，我们记为 $x$）定义为两个基因座之间单条染色单体上发生交换的期望次数。如果二价体上的交换呈泊松分布，那么影响单条染色单体的交换次数 $K$ 也遵循均值为 $x$ 的泊松分布。观察到 $k$ 次交换的概率由下式给出：\n$$P(K=k) = \\frac{\\exp(-x) x^k}{k!}$$\n如果基因座之间发生奇数次交换，就会产生重组型染色单体。因此，重组率 $r$ 是所有奇数 $k$ 值对应概率的总和：\n$$r = \\sum_{j=0}^{\\infty} P(K = 2j+1) = \\sum_{j=0}^{\\infty} \\frac{\\exp(-x) x^{2j+1}}{(2j+1)!}$$\n这个求和可以在双曲函数的泰勒级数展开中找到。具体来说，$\\sinh(x) = \\sum_{j=0}^{\\infty} \\frac{x^{2j+1}}{(2j+1)!}$。\n因此，该关系为：\n$$r = \\exp(-x) \\sinh(x)$$\n通过代入双曲正弦的指数形式 $\\sinh(x) = \\frac{\\exp(x) - \\exp(-x)}{2}$，我们推导出Haldane作图函数：\n$$r = \\exp(-x) \\left( \\frac{\\exp(x) - \\exp(-x)}{2} \\right) = \\frac{1 - \\exp(-2x)}{2}$$\n为了从重组率 $r$ 求出遗传距离 $x_H$，我们必须对该函数求逆：\n$$2r = 1 - \\exp(-2x_H)$$\n$$\\exp(-2x_H) = 1 - 2r$$\n$$-2x_H = \\ln(1 - 2r)$$\n$$x_H = -\\frac{1}{2} \\ln(1 - 2r)$$\n距离 $x_H$ 的单位是摩根。要转换为厘摩根（$d_H$），我们乘以 $100$：\n$$d_H = 100 \\times x_H = -50 \\ln(1 - 2r)$$\n代入给定的值 $r = 0.22$：\n$$d_H = -50 \\ln(1 - 2 \\times 0.22) = -50 \\ln(1 - 0.44) = -50 \\ln(0.56)$$\n计算数值：\n$$d_H \\approx -50 \\times (-0.579818) \\approx 28.9909 \\text{ cM}$$\n四舍五入到4位有效数字，Haldane距离为 $d_H \\approx 28.99 \\text{ cM}$。\n\n其次，我们处理Kosambi正干涉模型。题目指导我们使用Kosambi作图函数，它將重組率 $r$ 与以摩根为单位的图距 $x_K$ 关联起来，如下所示：\n$$r = \\frac{1}{2} \\tanh(2x_K)$$\n该函数考虑了正干涉，即一次交换事件会降低附近发生另一次交换的概率。为了从 $r$ 求出距离 $d_K$，我们必须对该函数求逆。\n$$2r = \\tanh(2x_K)$$\n$$2x_K = \\arctanh(2r)$$\n$$x_K = \\frac{1}{2} \\arctanh(2r)$$\n距离 $x_K$ 的单位是摩根。以厘摩根为单位的距离 $d_K$ 是：\n$$d_K = 100 \\times x_K = 50 \\arctanh(2r)$$\n我们也可以使用反双曲正切的对数定义来表示它，即 $\\arctanh(z) = \\frac{1}{2} \\ln \\left( \\frac{1+z}{1-z} \\right)$：\n$$d_K = 50 \\left( \\frac{1}{2} \\ln \\left( \\frac{1+2r}{1-2r} \\right) \\right) = 25 \\ln \\left( \\frac{1+2r}{1-2r} \\right)$$\n代入值 $r = 0.22$：\n$$d_K = 50 \\arctanh(2 \\times 0.22) = 50 \\arctanh(0.44)$$\n计算数值：\n$$d_K \\approx 50 \\times (0.472231) \\approx 23.6115 \\text{ cM}$$\n四舍五入到4位有效数字，Kosambi距离为 $23.61$ cM。\n\n最后，我们计算两个距离之差的绝对值 $\\Delta d$：\n$$\\Delta d = |d_H - d_K|$$\n在最终四舍五入之前，使用未舍入的值以获得更高精度：\n$$\\Delta d = |28.99092... - 23.61154...| = |5.37938...| \\text{ cM}$$\n将绝对差值四舍五入到4位有效数字，我们得到 $5.379$ cM。\n\n因此，所需的三个值为：\nHaldane距离：$d_H \\approx 28.99$ cM。\nKosambi距离：$d_K \\approx 23.61$ cM。\n绝对差值：$\\Delta d \\approx 5.379$ cM。", "answer": "$$\n\\boxed{\\begin{pmatrix} 28.99 & 23.61 & 5.379 \\end{pmatrix}}\n$$", "id": "2801515"}, {"introduction": "理想化的教科书问题与真实的科研场景之间存在差距，其中最常见的挑战就是实验数据的质量问题。本练习模拟了一个包含基因分型错误和数据缺失的场景，旨在揭示即使是很小的错误率($\\varepsilon$)也可能导致所谓的“图谱膨胀”这一系统性偏差。通过分析这个问题，你将理解为何在现代遗传图谱构建中，必须采用如隐马尔可夫模型 (HMM) 等先进的统计学算法来获得稳健和准确的结果。[@problem_id:2801527]", "problem": "一位植物遗传学家正在利用回交群体构建连锁图，其中每个后代在每个位点上携带轮回亲本或供体亲本的等位基因。考虑位于同一条染色体上的两个共显性标记 $M_1$ 和 $M_2$。设 $M_1$ 和 $M_2$ 之间的真实重组率为 $r$，并假设沿染色体没有交换干涉。每个标记的基因型在检测时，会以概率 $\\varepsilon$ 独立地被误判（在回交群体的两种基因型类别之间对称地翻转），并以概率 $m$ 独立地缺失（随机缺失）。研究者使用朴素两点估计法，该方法排除了在 $M_1$ 或 $M_2$ 上有缺失数据的个体，然后在剩余个体中通过观察到的重组基因型对的比例来估计重组率。然后，在无干涉假设下，使用该情况下的标准作图函数计算遗传距离。假设样本量足够大，以至于期望值可以近似于观察到的比例。\n\n请将你的推理建立在第一性原理之上：回交过程中配子形成时同源染色单体间发生重组事件的伯努利概率（即重组率 $r$ 的定义）、各位点基因分型错误在位点间和个体间的独立性，以及重组率和图距之间的无干涉关系。不要假设任何直接给出错误条件下观测重组率的特定修正公式；相反，应从所述假设中推导出任何必要的表达式。\n\n现在分析以下具体参数设置：$r = 0.12$，$\\varepsilon = 0.02$ 和 $m = 0.10$。在你的回答中，可以按名称引用通用算法框架，例如隐马尔可夫模型 (HMM)、期望最大化 (EM) 算法和贝叶斯信息准则 (BIC)。\n\n哪个选项最准确地描述了在这些条件下预期的朴素两点估计，并为多标记排序过程推荐了算法上合理的步骤，以防止由基因型分型错误和缺失数据引起的伪图距膨胀？\n\nA. 朴素两点估计值大致保持在 $r = 0.12$，因为随机基因分型错误平均会相互抵消；然而，缺失率为 $m = 0.10$ 的缺失数据会通过减小分母而使估计值产生向下偏倚。为了纠正多标记图距膨胀，应删除所有有任何缺失标记的个体，并在添加标记时使用更严格的显著性阈值。\n\nB. 在 $\\varepsilon = 0.02$ 的条件下，朴素两点估计值被高估至约 $r_{\\text{obs}} \\approx 0.150$，而缺失率为 $m=0.10$ 的随机缺失数据不会对两点估计量的期望产生偏倚，但会增加其方差；相应的无干涉图距从约 $13.72$ 厘摩膨胀至约 $17.83$ 厘摩。纠正性的排序应将一个显式的基因型分型错误参数整合到一个多点隐马尔可夫模型 (HMM) 中，通过最大似然法（例如，期望最大化 (EM) 算法）估计 $\\varepsilon$，并对缺失的基因型进行边缘化处理，而不是按列表删除；通过最大化多点似然并应用长度惩罚（例如，贝叶斯信息准则 (BIC)）来评估局部顺序置换（“rippling”），以抑制伪图距膨胀，并迭代地标记和重新检查具有高局部后验错误概率的基因型。\n\nC. 朴素两点估计值在 $r = 0.120$ 左右保持不变，因为两个位点的错误是独立的；为稳定排序，应使用成对删除法计算成对重组率，然后在相邻区间上进行多数投票，并为保守起见，将所有不明确或缺失的状态指定为重组型。\n\nD. 朴素两点估计值被低估至约 $r_{\\text{obs}} \\approx 0.100$，因为基因型分型错误掩盖了真实的重组体；为防止图距膨胀，应切换到 Kosambi 作图函数，并在排序前将缺失的基因型插补为每个标记上最常见的等位基因。\n\nE. 朴素两点估计值被高估了约 $2\\varepsilon$，得到 $r_{\\text{obs}} \\approx 0.160$；为进行纠正，应筛选掉偏离哈迪-温伯格平衡的标记，然后固定能够最小化相邻重组率之和的标记顺序，而不对错误或缺失进行建模。", "solution": "对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n-   **群体结构**：一个回交群体。\n-   **标记**：两个共显性标记 $M_1$ 和 $M_2$，位于同一条染色体上。\n-   **真实重组率**：$r$。\n-   **交换干涉假设**：无交换干涉。\n-   **基因型分型错误模型**：每个标记以概率 $\\varepsilon$ 独立地发生错误分类。该错误是回交群体中两种可能基因型类别之间的对称翻转。\n-   **缺失数据模型**：每个标记以概率 $m$ 独立地缺失。其机制是随机缺失 (MAR)。\n-   **估计量**：一个朴素的两点估计量，它使用成对删除法（舍弃在 $M_1$ 或 $M_2$ 上有缺失数据的个体）。重组率被估计为剩余个体中重组体的比例。\n-   **图距函数**：对应于无干涉假设的标准函数（Haldane 函数）。\n-   **样本量**：假设足够大，因此观测比例可以用其期望值来近似。\n-   **具体参数**：$r = 0.12$，$\\varepsilon = 0.02$， $m = 0.10$。\n-   **任务**：描述朴素估计的特征，并为多标记作图推荐稳健的算法流程。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学基础**：该问题在统计遗传学和连锁作图的原理上有坚实的基础。回交、重组、基因型分型错误、缺失数据和作图函数等概念都是标准概念。指定的参数是现实的。\n-   **适定性**：该问题是适定的。它提供了所有必要的参数和对估计过程的清晰定义，从而可以为观测到的重组率和图距推导出唯一的期望值。\n-   **客观性**：该问题以精确、客观、技术性的语言陈述，不含主观性。\n-   **完整性与一致性**：该问题是自洽且内部一致的。它指明了错误模型、缺失数据机制和估计方法。\n-   **可行性**：所有陈述的条件和参数值在科学上都是合理的，并且在计算上是可行的。\n\n### 步骤 3：结论与行动\n问题陈述在科学上是合理的、适定的且内部一致的。它是**有效的**。开始求解。\n\n### 朴素估计期望值的推导\n\n首先，我们分析朴素估计过程的组成部分。\n\n**1. 缺失数据的影响**\n该过程排除了任何在 $M_1$ 或 $M_2$ 上有缺失基因型的个体。在单个位点上观测到基因型的概率是 $(1-m)$。由于缺失在位点间是独立的，一个个体在 $M_1$ 和 $M_2$ 上都有非缺失数据的概率是 $(1-m)^2$。对于 $m=0.10$，这个概率是 $(1-0.10)^2 = 0.90^2 = 0.81$。\n问题陈述数据是随机缺失 (MAR)。这意味着，以具有完整数据的个体子集为条件，并不会改变真实基因型的期望频率。因此，对缺失数据进行成对删除会减少有效样本量，从而增加估计的方差，但它不会向估计量的期望值中引入系统性偏差。因此，我们可以分析基因型分型错误对具有完整数据的个体亚群的影响。\n\n**2. 基因型分型错误的影响**\n设 $r$ 为真实重组率。在一个来自回交群体的大样本中，真实亲本型基因型的比例是 $(1-r)$，真实重组型基因型的比例是 $r$。\n基因型分型错误 $\\varepsilon$ 是一个位点上两种可能基因型状态之间的对称翻转。我们需要找到一个真实的亲本型或重组型个体被*观察*为重组型的概率。这个观察到的比例就是朴素估计值 $r_{\\text{obs}}$。\n\n如果 $M_1$ 和 $M_2$ 的基因型相同，则个体的基因型对被归类为亲本型；如果不同，则为重组型。\n一个错误是观测基因型的翻转。各位点的错误是独立的。\n\n-   **考虑一个真实的亲本型个体（比例为 $1-r$）：**\n    $M_1$ 和 $M_2$ 的基因型相同。如果一个位点被正确读取而另一个被错误读取，这个个体将被*观察为重组型*。\n    这个事件的概率是：\n    $$P(\\text{obs rec} | \\text{true par}) = P(\\text{correct at } M_1, \\text{error at } M_2) + P(\\text{error at } M_1, \\text{correct at } M_2)$$\n    $$P(\\text{obs rec} | \\text{true par}) = (1-\\varepsilon)\\varepsilon + \\varepsilon(1-\\varepsilon) = 2\\varepsilon(1-\\varepsilon)$$\n\n-   **考虑一个真实的重组型个体（比例为 $r$）：**\n    $M_1$ 和 $M_2$ 的基因型不同。如果两个位点都被正确读取，或者两个位点都被错误读取（双重错误使这对基因型再次显得不同），这个个体将被*观察为重组型*。\n    这个事件的概率是：\n    $$P(\\text{obs rec} | \\text{true rec}) = P(\\text{correct at } M_1, \\text{correct at } M_2) + P(\\text{error at } M_1, \\text{error at } M_2)$$\n    $$P(\\text{obs rec} | \\text{true rec}) = (1-\\varepsilon)(1-\\varepsilon) + \\varepsilon\\varepsilon = (1-\\varepsilon)^2 + \\varepsilon^2$$\n\n观察到的重组体总期望比例 $r_{\\text{obs}}$ 是这些可能性按真实比例加权后的和：\n$$r_{\\text{obs}} = P(\\text{obs rec}) = P(\\text{obs rec} | \\text{true par}) P(\\text{true par}) + P(\\text{obs rec} | \\text{true rec}) P(\\text{true rec})$$\n$$r_{\\text{obs}} = [2\\varepsilon(1-\\varepsilon)](1-r) + [(1-\\varepsilon)^2 + \\varepsilon^2](r)$$\n让我们简化这个表达式：\n$$r_{\\text{obs}} = (2\\varepsilon - 2\\varepsilon^2)(1-r) + (1-2\\varepsilon+\\varepsilon^2+\\varepsilon^2)(r)$$\n$$r_{\\text{obs}} = (2\\varepsilon - 2\\varepsilon^2) - r(2\\varepsilon - 2\\varepsilon^2) + r(1 - 2\\varepsilon + 2\\varepsilon^2)$$\n$$r_{\\text{obs}} = (2\\varepsilon - 2\\varepsilon^2) + r(1 - 2\\varepsilon + 2\\varepsilon^2 - (2\\varepsilon - 2\\varepsilon^2))$$\n$$r_{\\text{obs}} = (2\\varepsilon - 2\\varepsilon^2) + r(1 - 4\\varepsilon + 4\\varepsilon^2)$$\n$$r_{\\text{obs}} = 2\\varepsilon(1-\\varepsilon) + r(1-2\\varepsilon)^2$$\n另一种等价的公式是 $r_{\\text{obs}} = r + (1-2r) \\cdot 2\\varepsilon(1-\\varepsilon)$。这个形式清楚地表明，对于 $r < 0.5$，$1-2r > 0$，所以 $r_{\\text{obs}} > r$。重组率被高估了。\n\n**3. 数值计算**\n使用给定的参数 $r = 0.12$ 和 $\\varepsilon = 0.02$：\n$$r_{\\text{obs}} = 0.12 + (1 - 2 \\cdot 0.12) \\cdot 2 \\cdot 0.02 \\cdot (1 - 0.02)$$\n$$r_{\\text{obs}} = 0.12 + (1 - 0.24) \\cdot 0.04 \\cdot (0.98)$$\n$$r_{\\text{obs}} = 0.12 + (0.76) \\cdot (0.0392)$$\n$$r_{\\text{obs}} = 0.12 + 0.029792$$\n$$r_{\\text{obs}} \\approx 0.1498$$\n四舍五入到三位小数，$r_{\\text{obs}} \\approx 0.150$。\n\n**4. 图距计算与膨胀**\n问题指明无交换干涉，这对应于 Haldane 作图函数：\n$$d = -0.5 \\ln(1 - 2r)$$\n其中 $d$ 的单位是摩尔根 (Morgans)。要得到厘摩 (cM)，我们使用 $d_{\\text{cM}} = -50 \\ln(1 - 2r)$。\n\n-   **真实图距 (使用 $r = 0.12$):**\n    $$d_{\\text{true}} = -50 \\ln(1 - 2 \\cdot 0.12) = -50 \\ln(1 - 0.24) = -50 \\ln(0.76)$$\n    $$d_{\\text{true}} \\approx -50(-0.27443) \\approx 13.72 \\text{ cM}$$\n\n-   **观测图距 (使用 $r_{\\text{obs}} \\approx 0.150$):**\n    $$d_{\\text{obs}} = -50 \\ln(1 - 2 \\cdot 0.150) = -50 \\ln(1 - 0.30) = -50 \\ln(0.70)$$\n    $$d_{\\text{obs}} \\approx -50(-0.35667) \\approx 17.83 \\text{ cM}$$\n基因型分型错误导致估计的重组率从 $0.12$ 膨胀到约 $0.150$，这反过来又使估计的图距从约 $13.72$ cM 膨胀到约 $17.83$ cM。这种现象被称为伪图距膨胀。\n\n**5. 算法建议**\n为了在存在基因型分型错误和缺失数据的情况下构建一个稳健的多标记连锁图，必须放弃朴素的两点法。最先进的方法包括：\n-   **多点似然模型**：使用隐马尔可夫模型 (HMM) 是标准方法。沿染色体的真实基因型序列是“隐藏”状态，而观察到的基因型是“发射”。HMM 中的转移概率是相邻标记间重组率的函数。\n-   **显式错误建模**：HMM 的发射概率必须明确地对基因型分型错误率 $\\varepsilon$ 进行建模。该模型变为 $P(\\text{观察到的基因型} | \\text{真实的基因型})$。\n-   **参数估计**：通过最大化整个图谱上数据的总似然来同时估计重组率和错误率 $\\varepsilon$。期望最大化 (EM) 算法是在 HMM 中进行这种最大似然估计的标准工具。\n-   **处理缺失数据**：HMM 不是丢弃数据（成对或按列表删除），而是通过对缺失位点上所有可能的隐藏状态进行求和（边缘化）来自然地处理缺失数据，并根据旁侧数据给出的概率进行加权。这是对信息远为更有效的利用。\n-   **顺序优化与模型选择**：找到最佳标记顺序涉及测试局部置换（例如，“ripple”程序），并选择最大化多点似然的顺序。为防止过拟合和伪图距膨胀，这种最大化通常会受到惩罚。像贝叶斯信息准则 (BIC) 或赤池信息准则 (AIC) 这样的模型选择标准可用于惩罚图谱长度（具有更多重组事件的模型）。\n-   **错误诊断**：图谱构建后，可以使用 Viterbi 或前向-后向算法为每个数据点计算基因型分型错误的后验概率。具有高后验错误概率的基因型可以被标记出来，以便重新检测或在下一轮作图中置为空白。\n\n---\n### 逐项分析选项\n\n**A. 朴素两点估计值大致保持在 $r = 0.12$，因为随机基因分型错误平均会相互抵消；然而，缺失率为 $m = 0.10$ 的缺失数据会通过减小分母而使估计值产生向下偏倚。为了纠正多标记图距膨胀，应删除所有有任何缺失标记的个体，并在添加标记时使用更严格的显著性阈值。**\n-   **不正确。** 推导表明，随机错误不会相互抵消；它们会导致连锁标记的重组率被系统性地高估。随机缺失数据不会使估计量的期望值产生偏倚。推荐的纠正措施效率低下，且未解决问题的根本原因。\n\n**B. 在 $\\varepsilon = 0.02$ 的条件下，朴素两点估计值被高估至约 $r_{\\text{obs}} \\approx 0.150$，而缺失率为 $m=0.10$ 的随机缺失数据不会对两点估计量的期望产生偏倚，但会增加其方差；相应的无干涉图距从约 $13.72$ 厘摩膨胀至约 $17.83$ 厘摩。纠正性的排序应将一个显式的基因型分型错误参数整合到一个多点隐马尔可夫模型 (HMM) 中，通过最大似然法（例如，期望最大化 (EM) 算法）估计 $\\varepsilon$，并对缺失的基因型进行边缘化处理，而不是按列表删除；通过最大化多点似然并应用长度惩罚（例如，贝叶斯信息准则 (BIC)）来评估局部顺序置换（“rippling”），以抑制伪图距膨胀，并迭代地标记和重新检查具有高局部后验错误概率的基因型。**\n-   **正确。** 该选项正确地量化了重组率和图距的高估情况，正确描述了 MAR 缺失数据的统计效应，并准确地详述了解决基因型分型错误和缺失数据的最先进的稳健连锁作图算法框架。根据统计遗传学的原理，该陈述的每个部分都是正确的。\n\n**C. 朴素两点估计值在 $r = 0.120$ 左右保持不变，因为两个位点的错误是独立的；为稳定排序，应使用成对删除法计算成对重组率，然后在相邻区间上进行多数投票，并为保守起见，将所有不明确或缺失的状态指定为重组型。**\n-   **不正确。** 如推导所示，估计值被高估，而非不变。其理由（“因为两个位点的错误是独立的”）是错误的。将缺失状态指定为重组型的建议是一个有严重缺陷的程序，会引入巨大的偏差和灾难性的图距膨胀。\n\n**D. 朴素两点估计值被低估至约 $r_{\\text{obs}} \\approx 0.100$，因为基因型分型错误掩盖了真实的重组体；为防止图距膨胀，应切换到 Kosambi 作图函数，并在排序前将缺失的基因型插补为每个标记上最常见的等位基因。**\n-   **不正确。** 估计值被高估，而非低估。建议的解决方案是误导性的。切换作图函数解决的是干涉问题，而非基因型分型错误。将缺失值插补为最常见的等位基因是一种朴素且有偏的方法，会人为地降低估计的重组率。\n\n**E. 朴素两点估计值被高估了约 $2\\varepsilon$，得到 $r_{\\text{obs}} \\approx 0.160$；为进行纠正，应筛选掉偏离哈迪-温伯格平衡的标记，然后固定能够最小化相邻重组率之和的标记顺序，而不对错误或缺失进行建模。**\n-   **不正确。** $r_{\\text{obs}} \\approx r + 2\\varepsilon$ 的近似是不准确的；计算表明高估至约 $0.150$。回交群体中不期望存在哈迪-温伯格平衡，因此这种筛选是不恰当的。在不建立错误模型的情况下最小化重组率之和是一种朴素的“旅行商”方法，众所周知，这种方法对基因型分型错误高度敏感，常常产生不正确的图谱。它不能纠正错误，反而深受其害。", "answer": "$$\\boxed{B}$$", "id": "2801527"}]}