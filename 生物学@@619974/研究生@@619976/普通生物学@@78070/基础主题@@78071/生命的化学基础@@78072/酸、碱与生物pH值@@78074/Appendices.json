{"hands_on_practices": [{"introduction": "在生物化学计算中，我们常常将生物体液视为理想溶液，其中浓度等于活度。然而，细胞质的高离子强度意味着这是一个显著的过度简化。此练习旨在挑战您超越这种理想化，通过计算在有无背景电解质的酸性溶液中的 $pH$ 值，您将直接量化离子相互作用对氢离子活度的影响，这是精确描述生物系统的一个基本概念 [@problem_id:2772432]。", "problem": "一种温度为 $25\\,^{\\circ}\\text{C}$ 的水溶液是通过在两种条件下溶解盐酸 (HCl) 制备的，其形式浓度为 $1.0\\ \\text{millimolar (mM)}$：(i) 在纯水中，不添加支持电解质；(ii) 在 $0.10\\ \\text{molar (M)}$ 的氯化钠 (NaCl) 作为惰性支持电解质存在的情况下。在两种情况下，均将盐酸视为完全解离的强酸，并忽略水的自电离相对于强酸的影响。同时忽略离子对。将氢离子电势 (pH) 定义为 $ \\text{pH} = -\\log_{10} a_{\\mathrm{H}^{+}}$，其中 $a_{\\mathrm{H}^{+}}$ 是相对于标准态浓度 $c^{\\circ} = 1\\ \\text{M}$ 的氢离子活度。使用活度模型 $a_{\\mathrm{H}^{+}} = \\gamma_{\\mathrm{H}^{+}}\\, c_{\\mathrm{H}^{+}}/c^{\\circ}$，其中 $\\gamma_{\\mathrm{H}^{+}}$ 是氢离子的活度系数。\n\n假设在这些离子强度下，单价离子的活度系数可以通过 $25\\,^{\\circ}\\text{C}$ 时 Debye–Hückel 方程的 Davies 形式来估算，\n$$\n\\log_{10}\\gamma_{i} = -A z_{i}^{2}\\!\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I\\right),\n$$\n其中 $A=0.509$，电荷数为 $z_{i}$，离子强度 $I$ 定义为\n$$\nI = \\tfrac{1}{2}\\sum_{j} c_{j} z_{j}^{2},\n$$\n其中求和遍及所有浓度为 $c_{j}$ 的离子种类。\n\n使用这些定义和假设，计算情况 (i) 和情况 (ii) 的 pH 值。按 (i) 纯水，(ii) $0.10\\ \\text{M}$ NaCl 的顺序列出你的两个数值答案。每个答案四舍五入到四位有效数字。将这两个数字以行向量的形式给出。", "solution": "所给问题已经过严格评估，被认为是有效的。这是一个物理化学领域中表述恰当的问题，它具有科学依据、内部一致，并包含了得出唯一解所需的所有定量信息和形式定义。\n\n氢离子电势 $\\text{pH}$ 由氢离子活度 $a_{\\mathrm{H}^{+}}$ 定义，而非其摩尔浓度 $c_{\\mathrm{H}^{+}}$。其控制关系式为：\n$$\n\\text{pH} = -\\log_{10} a_{\\mathrm{H}^{+}}\n$$\n活度通过活度系数 $\\gamma_{\\mathrm{H}^{+}}$ 与摩尔浓度相关联：\n$$\na_{\\mathrm{H}^{+}} = \\gamma_{\\mathrm{H}^{+}} \\frac{c_{\\mathrm{H}^{+}}}{c^{\\circ}}\n$$\n其中 $c^{\\circ} = 1\\ \\text{M}$ 是标准态浓度。因此，$\\text{pH}$ 的表达式为：\n$$\n\\text{pH} = -\\log_{10}\\left(\\gamma_{\\mathrm{H}^{+}} \\frac{c_{\\mathrm{H}^{+}}}{c^{\\circ}}\\right) = -\\log_{10}(\\gamma_{\\mathrm{H}^{+}}) - \\log_{10}\\left(\\frac{c_{\\mathrm{H}^{+}}}{c^{\\circ}}\\right)\n$$\n题目指出，盐酸 $\\text{HCl}$ 是一种强酸且完全解离。对于 $1.0\\ \\text{millimolar}$ ($1.0 \\times 10^{-3}\\ \\text{M}$) 的形式浓度，氢离子浓度为 $c_{\\mathrm{H}^{+}} = 1.0 \\times 10^{-3}\\ \\text{M}$。对于两种情况，$\\text{pH}$ 方程中依赖浓度的项是恒定的：\n$$\n-\\log_{10}\\left(\\frac{c_{\\mathrm{H}^{+}}}{c^{\\circ}}\\right) = -\\log_{10}\\left(\\frac{1.0 \\times 10^{-3}\\ \\text{M}}{1\\ \\text{M}}\\right) = -\\log_{10}(1.0 \\times 10^{-3}) = 3.0\n$$\n剩下的任务是计算每种条件下的活度系数 $\\gamma_{\\mathrm{H}^{+}}$。该系数由溶液的离子强度 $I$ 决定，根据所提供的 Davies 方程：\n$$\n\\log_{10}\\gamma_{i} = -A z_{i}^{2}\\!\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I\\right)\n$$\n对于氢离子，电荷数 $z_{\\mathrm{H}^{+}}=+1$，所以 $z_{\\mathrm{H}^{+}}^2 = 1$。给定常数 $A=0.509$。$\\gamma_{\\mathrm{H}^{+}}$ 的方程变为：\n$$\n\\log_{10}\\gamma_{\\mathrm{H}^{+}} = -0.509\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I\\right)\n$$\n离子强度 $I$ 的计算公式为 $I = \\frac{1}{2}\\sum_{j} c_{j} z_{j}^{2}$，其中求和遍及所有离子种类。\n\n情况 (i)：$\\text{HCl}$ 在纯水中。\n\n首先，必须计算离子强度 $I_i$。存在的离子仅来自于解离的 $\\text{HCl}$：$\\mathrm{H}^{+}$ 和 $\\mathrm{Cl}^{-}$，两者浓度均为 $1.0 \\times 10^{-3}\\ \\text{M}$。\n$$\nI_i = \\frac{1}{2} \\left[ c_{\\mathrm{H}^{+}} z_{\\mathrm{H}^{+}}^2 + c_{\\mathrm{Cl}^{-}} z_{\\mathrm{Cl}^{-}}^2 \\right] = \\frac{1}{2} \\left[ (1.0 \\times 10^{-3})(+1)^2 + (1.0 \\times 10^{-3})(-1)^2 \\right]\n$$\n$$\nI_i = \\frac{1}{2} (1.0 \\times 10^{-3} + 1.0 \\times 10^{-3}) = 1.0 \\times 10^{-3}\\ \\text{M}\n$$\n当 $I_i = 0.001\\ \\text{M}$ 时，我们计算 $\\log_{10}\\gamma_{\\mathrm{H}^{+}, i}$：\n$$\n\\log_{10}\\gamma_{\\mathrm{H}^{+}, i} = -0.509 \\left( \\frac{\\sqrt{0.001}}{1+\\sqrt{0.001}} - 0.3 \\times 0.001 \\right)\n$$\n$$\n\\log_{10}\\gamma_{\\mathrm{H}^{+}, i} \\approx -0.509 \\left( \\frac{0.0316228}{1.0316228} - 0.0003 \\right) \\approx -0.509 (0.0306534 - 0.0003) = -0.509(0.0303534) \\approx -0.015450\n$$\n则情况 (i) 的 $\\text{pH}$ 为：\n$$\n\\text{pH}_i = -\\log_{10}(\\gamma_{\\mathrm{H}^{+}, i}) - \\log_{10}(c_{\\mathrm{H}^{+}}/c^{\\circ}) \\approx -(-0.015450) + 3.0 = 3.015450\n$$\n四舍五入到四位有效数字，得到 $\\text{pH}_i = 3.015$。\n\n情况 (ii)：$\\text{HCl}$ 在 $0.10\\ \\text{M}$ $\\text{NaCl}$ 中。\n\n首先，我们确定溶液中所有离子的浓度。$\\text{NaCl}$ 电解质提供了额外的离子。\n$c_{\\mathrm{H}^{+}} = 1.0 \\times 10^{-3}\\ \\text{M}$\n$c_{\\mathrm{Na}^{+}} = 0.10\\ \\text{M}$\n$c_{\\mathrm{Cl}^{-}} = (\\text{来自}\\text{HCl}) + (\\text{来自}\\text{NaCl}) = 1.0 \\times 10^{-3}\\ \\text{M} + 0.10\\ \\text{M} = 0.101\\ \\text{M}$\n接下来，我们计算离子强度 $I_{ii}$：\n$$\nI_{ii} = \\frac{1}{2} \\left[ c_{\\mathrm{H}^{+}} z_{\\mathrm{H}^{+}}^2 + c_{\\mathrm{Na}^{+}} z_{\\mathrm{Na}^{+}}^2 + c_{\\mathrm{Cl}^{-}} z_{\\mathrm{Cl}^{-}}^2 \\right]\n$$\n$$\nI_{ii} = \\frac{1}{2} \\left[ (1.0 \\times 10^{-3})(+1)^2 + (0.10)(+1)^2 + (0.101)(-1)^2 \\right]\n$$\n$$\nI_{ii} = \\frac{1}{2} (0.001 + 0.10 + 0.101) = \\frac{1}{2} (0.202) = 0.101\\ \\text{M}\n$$\n使用 $I_{ii} = 0.101\\ \\text{M}$，我们计算 $\\log_{10}\\gamma_{\\mathrm{H}^{+}, ii}$：\n$$\n\\log_{10}\\gamma_{\\mathrm{H}^{+}, ii} = -0.509 \\left( \\frac{\\sqrt{0.101}}{1+\\sqrt{0.101}} - 0.3 \\times 0.101 \\right)\n$$\n$$\n\\log_{10}\\gamma_{\\mathrm{H}^{+}, ii} \\approx -0.509 \\left( \\frac{0.317805}{1.317805} - 0.0303 \\right) \\approx -0.509 (0.241162 - 0.0303) = -0.509(0.210862) \\approx -0.107329\n$$\n情况 (ii) 的 $\\text{pH}$ 为：\n$$\n\\text{pH}_{ii} = -\\log_{10}(\\gamma_{\\mathrm{H}^{+}, ii}) - \\log_{10}(c_{\\mathrm{H}^{+}}/c^{\\circ}) \\approx -(-0.107329) + 3.0 = 3.107329\n$$\n四舍五入到四位有效数字，得到 $\\text{pH}_{ii} = 3.107$。\n计算出的两个 $\\text{pH}$ 值是 $3.015$ 和 $3.107$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.015 & 3.107\n\\end{pmatrix}\n}\n$$", "id": "2772432"}, {"introduction": "Henderson–Hasselbalch 方程是制备和理解缓冲液的基石，但其常用形式使用浓度，这隐含地假设了理想溶液的行为。基于活度的概念，本练习要求您推导并计算在生理相关条件下，这种常见简化所引入的精确误差 [@problem_id:2772446]。这项实践将加深您对基本生化公式背后假设及其在真实生物介质中局限性的批判性理解。", "problem": "一种模拟细胞质的缓冲液由等摩尔的磷酸二氢钠和磷酸氢二钠组成，因此共轭酸碱对为 $\\mathrm{H_{2}PO_{4}^{-}}$ 和 $\\mathrm{HPO_{4}^{2-}}$，其分析浓度为 $c_{\\mathrm{H_{2}PO_{4}^{-}}} = c_{\\mathrm{HPO_{4}^{2-}}}$。该介质的离子强度由一种惰性支持电解质固定在 $I = 0.200\\ \\mathrm{M}$。温度为 $25\\,^{\\circ}\\mathrm{C}$。假设使用（以活度定义的）热力学酸解离常数，并忽略 $\\mathrm{H^{+}}$ 和 $\\mathrm{OH^{-}}$ 对 $I$ 的贡献。\n\n仅从活度 $a_{i} = \\gamma_{i} c_{i}$ 的定义、单质子酸的热力学酸解离常数 $K_{a}$ 的定义以及 $\\mathrm{pH}$ 的定义出发，量化在该给定离子强度下，在此磷酸盐缓冲液的 Henderson–Hasselbalch 关系式中用浓度代替活度所引入的带符号误差 $\\Delta \\mathrm{pH}$，其中\n- $\\Delta \\mathrm{pH} \\equiv \\mathrm{pH}_{\\text{conc}} - \\mathrm{pH}_{\\text{act}}$，\n- $z_{\\mathrm{H_{2}PO_{4}^{-}}} = -1$ 且 $z_{\\mathrm{HPO_{4}^{2-}}} = -2$，\n- 在离子强度 $I$ 下，单离子活度系数由 Davies 方程描述\n$$\n\\log_{10}\\gamma_{i} = -A z_{i}^{2}\\!\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I\\right),\n$$\n其中在 $25\\,^{\\circ}\\mathrm{C}$ 时，$A = 0.509$。\n\n将 $\\Delta \\mathrm{pH}$ 的最终答案表示为一个带符号的十进制数，以 pH 单位（无量纲）表示，并四舍五入到四位有效数字。", "solution": "目标是计算在固定离子强度下，对于共轭对 $\\mathrm{H_{2}PO_{4}^{-}}/\\mathrm{HPO_{4}^{2-}}$，仅用浓度替换后预测的 $\\mathrm{pH}$ 值与由正确的基于活度的表达式预测的 $\\mathrm{pH}$ 值之间的差异。\n\n从单质子酸 $\\mathrm{HA} \\rightleftharpoons \\mathrm{H^{+}} + \\mathrm{A^{-}}$ 解离的热力学定义开始，\n$$\nK_{a} \\equiv \\frac{a_{\\mathrm{H^{+}}}\\, a_{\\mathrm{A^{-}}}}{a_{\\mathrm{HA}}}, \\quad \\text{其中} \\quad a_{i} = \\gamma_{i} c_{i}.\n$$\n根据定义，\n$$\n\\mathrm{pH} \\equiv -\\log_{10} a_{\\mathrm{H^{+}}}, \\quad \\mathrm{p}K_{a} \\equiv -\\log_{10} K_{a}.\n$$\n对 $K_{a}$ 表达式取 $\\log_{10}$ 并重新整理可得\n$$\n-\\log_{10} a_{\\mathrm{H^{+}}} = -\\log_{10} K_{a} + \\log_{10}\\!\\left(\\frac{a_{\\mathrm{HA}}}{a_{\\mathrm{A^{-}}}}\\right),\n$$\n这就得到了基于活度的 Henderson–Hasselbalch 形式\n$$\n\\mathrm{pH}_{\\text{act}} = \\mathrm{p}K_{a} + \\log_{10}\\!\\left(\\frac{a_{\\mathrm{A^{-}}}}{a_{\\mathrm{HA}}}\\right).\n$$\n如果用浓度代替活度，预测的 $\\mathrm{pH}$ 将是\n$$\n\\mathrm{pH}_{\\text{conc}} = \\mathrm{p}K_{a} + \\log_{10}\\!\\left(\\frac{c_{\\mathrm{A^{-}}}}{c_{\\mathrm{HA}}}\\right).\n$$\n因此，带符号的误差为\n$$\n\\Delta \\mathrm{pH} \\equiv \\mathrm{pH}_{\\text{conc}} - \\mathrm{pH}_{\\text{act}} \n= \\log_{10}\\!\\left(\\frac{c_{\\mathrm{A^{-}}}}{c_{\\mathrm{HA}}}\\right) - \\log_{10}\\!\\left(\\frac{a_{\\mathrm{A^{-}}}}{a_{\\mathrm{HA}}}\\right)\n= -\\log_{10}\\!\\left(\\frac{\\gamma_{\\mathrm{A^{-}}}}{\\gamma_{\\mathrm{HA}}}\\right).\n$$\n对于该磷酸盐缓冲液，我们定义 $\\mathrm{A^{-}} \\equiv \\mathrm{HPO_{4}^{2-}}$ 和 $\\mathrm{HA} \\equiv \\mathrm{H_{2}PO_{4}^{-}}$。在给定条件 $c_{\\mathrm{HPO_{4}^{2-}}} = c_{\\mathrm{H_{2}PO_{4}^{-}}}$ 下，浓度比被消掉，因此误差仅取决于单离子活度系数的比值：\n$$\n\\Delta \\mathrm{pH} = -\\log_{10}\\!\\left(\\frac{\\gamma_{\\mathrm{HPO_{4}^{2-}}}}{\\gamma_{\\mathrm{H_{2}PO_{4}^{-}}}}\\right).\n$$\n\n接下来，使用 Davies 方程计算在 $I = 0.200$ 时的活度系数，\n$$\n\\log_{10}\\gamma_{i} = -A z_{i}^{2} \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I \\right), \\quad A = 0.509.\n$$\n先以符号形式，然后以数值形式计算依赖于离子强度的括号项：\n$$\nB(I) \\equiv \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I, \\quad \\text{因此} \\quad \\log_{10}\\gamma_{i} = -A z_{i}^{2} B(I).\n$$\n当 $I = 0.200$ 时，我们计算括号项 $B(I)$：\n$$ B(I) = \\frac{\\sqrt{0.200}}{1+\\sqrt{0.200}} - 0.3(0.200) \\approx 0.3090169944 - 0.060 = 0.2490169944. $$\n因此，\n$$\n\\log_{10}\\gamma_{i} = -A z_{i}^{2} B(0.200) \\approx -0.509 \\times z_{i}^{2} \\times 0.2490169944.\n$$\n对于 $z = -1$ 的 $\\mathrm{H_{2}PO_{4}^{-}}$，\n$$\n\\log_{10}\\gamma_{\\mathrm{H_{2}PO_{4}^{-}}} \\approx -0.509 \\times 1 \\times 0.2490169944 = -0.1267496501.\n$$\n对于 $z = -2$ 的 $\\mathrm{HPO_{4}^{2-}}$，\n$$\n\\log_{10}\\gamma_{\\mathrm{HPO_{4}^{2-}}} \\approx -0.509 \\times 4 \\times 0.2490169944 = -0.5069986004.\n$$\n它们的比值的对数为\n$$\n\\log_{10}\\!\\left(\\frac{\\gamma_{\\mathrm{HPO_{4}^{2-}}}}{\\gamma_{\\mathrm{H_{2}PO_{4}^{-}}}}\\right) = \\log_{10}\\gamma_{\\mathrm{HPO_{4}^{2-}}} - \\log_{10}\\gamma_{\\mathrm{H_{2}PO_{4}^{-}}} \\approx -0.5069986004 - (-0.1267496501) = -0.3802489503.\n$$\n因此，带符号的误差为\n$$\n\\Delta \\mathrm{pH} = -\\log_{10}\\!\\left(\\frac{\\gamma_{\\mathrm{HPO_{4}^{2-}}}}{\\gamma_{\\mathrm{H_{2}PO_{4}^{-}}}}\\right) \\approx -(-0.3802489503) = 0.3802489503.\n$$\n解释这个符号，$\\Delta \\mathrm{pH} > 0$ 表明，在 $I = 0.200$ 时，对于这种缓冲液，使用浓度代替活度会高估 $\\mathrm{pH}$ 值。四舍五入到四位有效数字得到\n$$\n\\Delta \\mathrm{pH} \\approx 0.3802.\n$$", "answer": "$$\\boxed{0.3802}$$", "id": "2772446"}, {"introduction": "细胞的 $pH$ 值并非一个静态属性，而是一个动态的稳态，由一系列膜转运蛋白主动维持，以抵抗持续的代谢产酸。理解这种稳态需要整合多个动力学和平衡过程。这项顶石实践将指导您构建一个细胞溶质 $pH$ 调节的计算模型 [@problem_id:2772402]。通过将关键的生物物理原理——离子交换动力学、主动转运和缓冲平衡——转化为一个可解的系统，您将掌握现代定量生物学中至关重要的系统级建模技能。", "problem": "您必须编写一个完整且可运行的程序，通过在转运体介导的质子等效通量下强制执行质量和电荷平衡，来计算稳态胞质酸度（以pH表示）。转运过程包括钠/质子交换体、氯/碳酸氢盐交换体和液泡型三磷酸腺苷酶（ATP）质子泵。您的程序必须实现以下科学基础和建模假设，然后针对一个小型测试套件对稳态问题进行数值求解。\n\n使用的基础原理（请基于这些原理进行推导，不要假设任何额外的简化公式）：\n- 二氧化碳/碳酸氢盐体系的酸碱平衡：假设二氧化碳在细胞膜两侧快速平衡，并使用Henderson–Hasselbalch关系式，其中二氧化碳分压固定。设二氧化碳溶解度系数为 $\\alpha_{\\mathrm{CO_2}}$，分压为 $P_{\\mathrm{CO_2}}$，则细胞外和细胞内的碳酸氢盐浓度满足\n  $$\\mathrm{pH} = \\mathrm{p}K_a + \\log_{10}\\left(\\frac{[\\mathrm{HCO_3^-}]}{\\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}}}\\right)。$$\n  因此，给定 $\\mathrm{pH}$，$[\\mathrm{HCO_3^-}]$ 由 $[\\mathrm{HCO_3^-}] = \\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}} \\cdot 10^{\\mathrm{pH} - \\mathrm{p}K_a}$ 确定。本问题中所有浓度单位均为 $\\mathrm{mM}$，$\\mathrm{pH}$ 无单位。\n\n- 电中性$1:1$交换体的可逆质量作用动力学：对于一个通用交换体 $A_{\\mathrm{out}} + B_{\\mathrm{in}} \\rightleftharpoons A_{\\mathrm{in}} + B_{\\mathrm{out}}$，其净摩尔通量密度与两侧驱动反应物浓度乘积之差成正比：\n  $$J = g\\left([A]_{\\mathrm{out}}[B]_{\\mathrm{in}} - [A]_{\\mathrm{in}}[B]_{\\mathrm{out}}\\right),$$\n  其中 $g$ 是一个具有适当单位的唯象类电导系数。将此定律应用于钠/质子交换体（$\\mathrm{Na^+/H^+}$，交换一个细胞外的 $\\mathrm{Na^+}$ 和一个细胞内的 $\\mathrm{H^+}$）以及氯/碳酸氢盐交换体（$\\mathrm{Cl^-/HCO_3^-}$，交换一个细胞外的 $\\mathrm{Cl^-}$ 和一个细胞内的 $\\mathrm{HCO_3^-}$）。假设两种交换体都是电中性的，且不受膜电位的直接影响。\n\n- 液泡型三磷酸腺苷酶质子泵的可饱和主动转运：将向外的质子泵送过程建模为一个依赖于细胞内自由质子浓度 $ [\\mathrm{H^+}]_{\\mathrm{in}} $ 的类米氏（Michaelis–Menten）过程，\n  $$J_{\\mathrm{V}} = V_{\\max} \\frac{[\\mathrm{H^+}]_{\\mathrm{in}}}{K + [\\mathrm{H^+}]_{\\mathrm{in}}}。$$\n\n- 稳态下的质子等效质量平衡：定义符号约定，即正值贡献项会增加细胞内自由质子浓度。设 $J_{\\mathrm{met}}$ 为一个恒定的细胞内质子产生速率（代谢酸负荷）。设 $J_{\\mathrm{NHE}}$ 表示由质量作用模型定义的净 $\\mathrm{Na^+/H^+}$ 交换摩尔通量密度（$A=\\mathrm{Na^+}$，$B=\\mathrm{H^+}$），并设 $J_{\\mathrm{AE}}$ 表示由质量作用模型定义的净 $\\mathrm{Cl^-/HCO_3^-}$ 交换摩尔通量密度（$A=\\mathrm{Cl^-}$，$B=\\mathrm{HCO_3^-}$）。因为 $\\mathrm{Na^+/H^+}$ 正向运转时输出 $\\mathrm{H^+}$，液泡型三磷酸腺苷酶也输出 $\\mathrm{H^+}$，而 $\\mathrm{Cl^-/HCO_3^-}$ 输入碱（每输入一个碳酸氢根离子就中和掉一个质子），所以稳态条件为\n  $$0 = J_{\\mathrm{met}} - J_{\\mathrm{NHE}} - J_{\\mathrm{V}} - J_{\\mathrm{AE}},$$\n  其中 $J_{\\mathrm{AE}}$ 被理解为由氯/碳酸氢盐交换体质量作用项定义的碳酸氢盐内流（因此当其为正值时，会降低细胞内质子浓度）。\n\n- 胞质电中性：包含一个单一的、不反应的、不可渗透的细胞内阴离子 $ [\\mathrm{A^-}]_{\\mathrm{in}} $，以代表固定的负电荷（蛋白质和代谢物）。您必须强制执行代数电荷平衡\n  $$[\\mathrm{Na^+}]_{\\mathrm{in}} + [\\mathrm{K^+}]_{\\mathrm{in}} + [\\mathrm{H^+}]_{\\mathrm{in}} = [\\mathrm{Cl^-}]_{\\mathrm{in}} + [\\mathrm{HCO_3^-}]_{\\mathrm{in}} + [\\mathrm{A^-}]_{\\mathrm{in}},$$\n  并且在确定稳态 $\\mathrm{pH}_{\\mathrm{in}}$ 后，您必须根据此关系计算 $ [\\mathrm{A^-}]_{\\mathrm{in}} $。无需解决渗透平衡问题；将所有给定的浓度视为参数或从上述关系代数推导出的变量。不要建模或输出膜电位。\n\n需要实现的数值细节：\n- 除非另有说明，否则请使用上述Henderson–Hasselbalch关系式，并设 $\\mathrm{p}K_a = 6.1$（无单位），$\\alpha_{\\mathrm{CO_2}} = 0.03$（单位 $\\mathrm{mM/mmHg}$），以及 $P_{\\mathrm{CO_2}} = 40$（单位 $\\mathrm{mmHg}$）。使用 $\\mathrm{pH}$ 通过 $[\\mathrm{H^+}] = 10^{-\\mathrm{pH}} \\times 1000$ 计算 $[\\mathrm{H^+}]$，以 $\\mathrm{mM}$ 为单位表示。\n\n- 对于每个测试用例，通过在物理上合理的区间内求解 $\\mathrm{pH}_{\\mathrm{in}}$ 的稳态方程来计算细胞内 $\\mathrm{pH}$。如果可能，您必须在区间 $\\mathrm{pH}_{\\mathrm{in}} \\in [5.5, 8.8]$ 中找到一个实根；如果区间端点的值无法将根括住，则通过采样在该区间内搜索一个合适的括号区间，然后应用一个稳健的有界求根算法。找到 $\\mathrm{pH}_{\\mathrm{in}}$ 后，使用电中性方程计算 $ [\\mathrm{A^-}]_{\\mathrm{in}} $。您不需要打印 $ [\\mathrm{A^-}]_{\\mathrm{in}} $，但您的实现必须在内部计算它以验证电荷平衡。\n\n测试套件（所有浓度单位为 $\\mathrm{mM}$，除非明确说明单位；$\\mathrm{pH}$ 无单位）：\n- 所有测试用例共用的常数：\n  - $ [\\mathrm{Na^+}]_{\\mathrm{out}} = 140 $, $ [\\mathrm{Na^+}]_{\\mathrm{in}} = 12 $, $ [\\mathrm{Cl^-}]_{\\mathrm{out}} = 110 $, $ [\\mathrm{Cl^-}]_{\\mathrm{in}} = 15 $, $ [\\mathrm{K^+}]_{\\mathrm{in}} = 140 $, $ \\alpha_{\\mathrm{CO_2}} = 0.03 $（单位 $\\mathrm{mM/mmHg}$）, $ P_{\\mathrm{CO_2}} = 40 $（单位 $\\mathrm{mmHg}$）, $ \\mathrm{p}K_a = 6.1 $（无单位）。\n- 用例1（正常路径）：$\\mathrm{pH}_{\\mathrm{out}} = 7.40$, $g_{\\mathrm{NHE}} = 5\\times 10^{-3}$, $g_{\\mathrm{AE}} = 5\\times 10^{-6}$, $V_{\\max} = 1\\times 10^{-4}$, $K = 1\\times 10^{-4}$, $J_{\\mathrm{met}} = 1\\times 10^{-6}$。\n- 用例2（酸性细胞外边界）：$\\mathrm{pH}_{\\mathrm{out}} = 6.80$, $g_{\\mathrm{NHE}} = 5\\times 10^{-3}$, $g_{\\mathrm{AE}} = 5\\times 10^{-6}$, $V_{\\max} = 1\\times 10^{-4}$, $K = 1\\times 10^{-4}$, $J_{\\mathrm{met}} = 1\\times 10^{-6}$。\n- 用例3（液泡型三磷酸腺苷酶被抑制）：$\\mathrm{pH}_{\\mathrm{out}} = 7.40$, $g_{\\mathrm{NHE}} = 5\\times 10^{-3}$, $g_{\\mathrm{AE}} = 5\\times 10^{-6}$, $V_{\\max} = 0$, $K = 1\\times 10^{-4}$, $J_{\\mathrm{met}} = 1\\times 10^{-6}$。\n- 用例4（在碱性外部条件下增强的碳酸氢盐交换）：$\\mathrm{pH}_{\\mathrm{out}} = 7.60$, $g_{\\mathrm{NHE}} = 5\\times 10^{-3}$, $g_{\\mathrm{AE}} = 2\\times 10^{-5}$, $V_{\\max} = 1\\times 10^{-4}$, $K = 1\\times 10^{-4}$, $J_{\\mathrm{met}} = 1\\times 10^{-6}$。\n\n要求的最终输出格式：\n- 您的程序必须生成一行输出，其中包含一个Python风格的列表字面量，按顺序包含四个测试用例的细胞内 $\\mathrm{pH}$ 值，每个值都四舍五入到恰好四位小数（无单位），例如，格式为“[7.2105,7.0031,7.1120,7.3562]”。不应打印任何其他文本。\n\n注意事项：\n- 所有计算中，浓度单位必须为 $\\mathrm{mM}$，$P_{\\mathrm{CO_2}}$ 单位为 $\\mathrm{mmHg}$，$\\mathrm{pH}$ 无单位。\n- 除了所述原理外，不要使用任何生物学上的“捷径”。按照给定的形式实现质量作用和米氏动力学，并强制执行守恒定律和电中性。", "solution": "本问题已经过验证。\n\n第一步：提取给定信息\n\n本问题提供了以下数学模型和参数。除非另有说明，所有浓度单位均为 $\\mathrm{mM}$。\n\n**平衡与动力学定律：**\n1.  **碳酸氢盐体系：** $\\mathrm{pH}$ 与碳酸氢盐浓度 $[\\mathrm{HCO_3^-}]$ 之间的关系由Henderson-Hasselbalch方程给出：\n    $\\mathrm{pH} = \\mathrm{p}K_a + \\log_{10}\\left(\\frac{[\\mathrm{HCO_3^-}]}{\\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}}}\\right)$。\n    这意味着 $[\\mathrm{HCO_3^-}] = \\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}} \\cdot 10^{\\mathrm{pH} - \\mathrm{p}K_a}$。\n2.  **质量作用交换：** 对于一个通用的 $1:1$ 交换体 $A_{\\mathrm{out}} + B_{\\mathrm{in}} \\rightleftharpoons A_{\\mathrm{in}} + B_{\\mathrm{out}}$，其通量为 $J = g\\left([A]_{\\mathrm{out}}[B]_{\\mathrm{in}} - [A]_{\\mathrm{in}}[B]_{\\mathrm{out}}\\right)$。这适用于：\n    -   $\\mathrm{Na^+/H^+}$ 交换体 ($\\mathrm{NHE}$): $A=\\mathrm{Na^+}$, $B=\\mathrm{H^+}$。\n    -   $\\mathrm{Cl^-/HCO_3^-}$ 交换体 ($\\mathrm{AE}$): $A=\\mathrm{Cl^-}$, $B=\\mathrm{HCO_3^-}$。\n3.  **主动转运：** V型ATP酶质子泵（$\\mathrm{V}$）的通量由米氏（Michaelis-Menten）动力学给出：\n    $J_{\\mathrm{V}} = V_{\\max} \\frac{[\\mathrm{H^+}]_{\\mathrm{in}}}{K + [\\mathrm{H^+}]_{\\mathrm{in}}}$。\n\n**守恒与平衡定律：**\n1.  **稳态质子平衡：** 细胞内质子浓度的净变化率为零。按照正通量增加细胞内质子浓度的约定：\n    $0 = J_{\\mathrm{met}} - J_{\\mathrm{NHE}} - J_{\\mathrm{V}} - J_{\\mathrm{AE}}$。\n    这里，$J_{\\mathrm{met}}$ 是恒定的代谢酸产生速率。$J_{\\mathrm{NHE}}$ 是净 $\\mathrm{H^+}$ 外排通量。$J_{\\mathrm{V}}$ 是净 $\\mathrm{H^+}$ 外排通量。$J_{\\mathrm{AE}}$ 定义为净 $\\mathrm{HCO_3^-}$ 内流，这是一个质子等效的外排通量。\n2.  **胞质电中性：** 电荷总和必须为零。在计算稳态 $\\mathrm{pH}_{\\mathrm{in}}$ 后，由该平衡确定不可渗透阴离子浓度 $[\\mathrm{A^-}]_{\\mathrm{in}}$：\n    $[\\mathrm{Na^+}]_{\\mathrm{in}} + [\\mathrm{K^+}]_{\\mathrm{in}} + [\\mathrm{H^+}]_{\\mathrm{in}} = [\\mathrm{Cl^-}]_{\\mathrm{in}} + [\\mathrm{HCO_3^-}]_{\\mathrm{in}} + [\\mathrm{A^-}]_{\\mathrm{in}}$。\n\n**数值参数：**\n-   $\\mathrm{p}K_a = 6.1$\n-   $\\alpha_{\\mathrm{CO_2}} = 0.03 \\, \\mathrm{mM/mmHg}$\n-   $P_{\\mathrm{CO_2}} = 40 \\, \\mathrm{mmHg}$\n-   质子浓度转换：$[\\mathrm{H^+}]_{\\mathrm{mM}} = 10^{-\\mathrm{pH}} \\times 1000$。\n-   $\\mathrm{pH}_{\\mathrm{in}}$ 的搜索区间：$[5.5, 8.8]$。\n\n**测试套件数据：**\n-   **通用常数：** $[\\mathrm{Na^+}]_{\\mathrm{out}} = 140$, $[\\mathrm{Na^+}]_{\\mathrm{in}} = 12$, $[\\mathrm{Cl^-}]_{\\mathrm{out}} = 110$, $[\\mathrm{Cl^-}]_{\\mathrm{in}} = 15$, $[\\mathrm{K^+}]_{\\mathrm{in}} = 140$。\n-   **用例1：** $\\mathrm{pH}_{\\mathrm{out}} = 7.40$, $g_{\\mathrm{NHE}} = 5 \\times 10^{-3}$, $g_{\\mathrm{AE}} = 5 \\times 10^{-6}$, $V_{\\max} = 1 \\times 10^{-4}$, $K = 1 \\times 10^{-4}$, $J_{\\mathrm{met}} = 1 \\times 10^{-6}$。\n-   **用例2：** $\\mathrm{pH}_{\\mathrm{out}} = 6.80$, $g_{\\mathrm{NHE}} = 5 \\times 10^{-3}$, $g_{\\mathrm{AE}} = 5 \\times 10^{-6}$, $V_{\\max} = 1 \\times 10^{-4}$, $K = 1 \\times 10^{-4}$, $J_{\\mathrm{met}} = 1 \\times 10^{-6}$。\n-   **用例3：** $\\mathrm{pH}_{\\mathrm{out}} = 7.40$, $g_{\\mathrm{NHE}} = 5 \\times 10^{-3}$, $g_{\\mathrm{AE}} = 5 \\times 10^{-6}$, $V_{\\max} = 0$, $K = 1 \\times 10^{-4}$, $J_{\\mathrm{met}} = 1 \\times 10^{-6}$。\n-   **用例4：** $\\mathrm{pH}_{\\mathrm{out}} = 7.60$, $g_{\\mathrm{NHE}} = 5 \\times 10^{-3}$, $g_{\\mathrm{AE}} = 2 \\times 10^{-5}$, $V_{\\max} = 1 \\times 10^{-4}$, $K = 1 \\times 10^{-4}$, $J_{\\mathrm{met}} = 1 \\times 10^{-6}$。\n\n第三步：结论与行动\n\n该问题是**有效的**。将提供一个解决方案。\n\n**求解推导**\n问题的核心是求解非线性方程 $F(\\mathrm{pH}_{\\mathrm{in}}) = 0$ 来得到 $\\mathrm{pH}_{\\mathrm{in}}$，其中：\n$$F(\\mathrm{pH}_{\\mathrm{in}}) = J_{\\mathrm{met}} - J_{\\mathrm{NHE}}(\\mathrm{pH}_{\\mathrm{in}}) - J_{\\mathrm{V}}(\\mathrm{pH}_{\\mathrm{in}}) - J_{\\mathrm{AE}}(\\mathrm{pH}_{\\mathrm{in}})$$\n设 $x = \\mathrm{pH}_{\\mathrm{in}}$。方程的各组成部分被定义为 $x$ 的函数。\n\n首先，我们建立依赖于 $x$ 的浓度：\n-   细胞内质子浓度：$[\\mathrm{H^+}]_{\\mathrm{in}}(x) = 1000 \\cdot 10^{-x}$\n-   细胞内碳酸氢盐浓度：$[\\mathrm{HCO_3^-}]_{\\mathrm{in}}(x) = (\\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}}) \\cdot 10^{x - \\mathrm{p}K_a}$\n\n我们还需要细胞外浓度，对于给定的测试用例，这些浓度是恒定的，由 $\\mathrm{pH}_{\\mathrm{out}}$ 导出：\n-   细胞外质子浓度：$[\\mathrm{H^+}]_{\\mathrm{out}} = 1000 \\cdot 10^{-\\mathrm{pH}_{\\mathrm{out}}}$\n-   细胞外碳酸氢盐浓度：$[\\mathrm{HCO_3^-}]_{\\mathrm{out}} = (\\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}}) \\cdot 10^{\\mathrm{pH}_{\\mathrm{out}} - \\mathrm{p}K_a}$\n\n接下来，我们将三个转运体通量定义为 $x$ 的函数：\n1.  **NHE通量：**\n    $$J_{\\mathrm{NHE}}(x) = g_{\\mathrm{NHE}} \\left( [\\mathrm{Na^+}]_{\\mathrm{out}}[\\mathrm{H^+}]_{\\mathrm{in}}(x) - [\\mathrm{Na^+}]_{\\mathrm{in}}[\\mathrm{H^+}]_{\\mathrm{out}} \\right)$$\n2.  **V-ATP酶通量：**\n    $$J_{\\mathrm{V}}(x) = V_{\\max} \\frac{[\\mathrm{H^+}]_{\\mathrm{in}}(x)}{K + [\\mathrm{H^+}]_{\\mathrm{in}}(x)}$$\n3.  **AE通量（碳酸氢盐内流）：**\n    $$J_{\\mathrm{AE}}(x) = g_{\\mathrm{AE}} \\left( [\\mathrm{Cl^-}]_{\\mathrm{in}}[\\mathrm{HCO_3^-}]_{\\mathrm{out}} - [\\mathrm{Cl^-}]_{\\mathrm{out}}[\\mathrm{HCO_3^-}]_{\\mathrm{in}}(x) \\right)$$\n\n对于每个测试用例，将参数（$g_{\\mathrm{NHE}}$、$g_{\\mathrm{AE}}$、$V_{\\max}$、$K$、$J_{\\mathrm{met}}$、$\\mathrm{pH}_{\\mathrm{out}}$ 等）代入这些表达式。然后我们得到一个完整的函数 $F(x)$，可以进行数值求解。我们将在指定区间 $x \\in [5.5, 8.8]$ 内采用一种稳健的有界求根方法，例如 Brent-Dekker 方法。\n\n找到根 $\\mathrm{pH}_{\\mathrm{in}}$ 后，我们必须计算不可渗透阴离子的浓度 $[\\mathrm{A^-}]_{\\mathrm{in}}$，以确认电荷平衡。这是一个后处理步骤，最终输出中不要求。使用求解得到的 $\\mathrm{pH}_{\\mathrm{in}}$，我们计算最终的 $[\\mathrm{H^+}]_{\\mathrm{in}}$ 和 $[\\mathrm{HCO_3^-}]_{\\mathrm{in}}$：\n$$[\\mathrm{A^-}]_{\\mathrm{in}} = [\\mathrm{Na^+}]_{\\mathrm{in}} + [\\mathrm{K^+}]_{\\mathrm{in}} + [\\mathrm{H^+}]_{\\mathrm{in}} - \\left( [\\mathrm{Cl^-}]_{\\mathrm{in}} + [\\mathrm{HCO_3^-}]_{\\mathrm{in}} \\right)$$\n将对四个测试用例中的每一个实施此程序。最终程序将系统地应用这些计算，并按要求格式化所得的 $\\mathrm{pH}_{\\mathrm{in}}$ 值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes the steady-state intracellular pH for a cell model with three\n    primary ion transporters, solving a nonlinear equation for proton balance.\n    \"\"\"\n\n    # Common parameters for all test cases as specified in the problem.\n    # All concentrations are in mM.\n    common_params = {\n        'na_out': 140.0,\n        'na_in': 12.0,\n        'cl_out': 110.0,\n        'cl_in': 15.0,\n        'k_in': 140.0,\n        'alpha_co2': 0.03,  # mM/mmHg\n        'p_co2': 40.0,      # mmHg\n        'pka': 6.1,\n    }\n\n    # Test cases with their specific parameters.\n    test_cases = [\n        # Case 1: Happy path\n        {'ph_out': 7.40, 'g_nhe': 5e-3, 'g_ae': 5e-6, 'v_max': 1e-4, 'k_pump': 1e-4, 'j_met': 1e-6},\n        # Case 2: Acidic extracellular boundary\n        {'ph_out': 6.80, 'g_nhe': 5e-3, 'g_ae': 5e-6, 'v_max': 1e-4, 'k_pump': 1e-4, 'j_met': 1e-6},\n        # Case 3: V-ATPase inhibited\n        {'ph_out': 7.40, 'g_nhe': 5e-3, 'g_ae': 5e-6, 'v_max': 0.0, 'k_pump': 1e-4, 'j_met': 1e-6},\n        # Case 4: Enhanced bicarbonate exchange with alkaline outside\n        {'ph_out': 7.60, 'g_nhe': 5e-3, 'g_ae': 2e-5, 'v_max': 1e-4, 'k_pump': 1e-4, 'j_met': 1e-6},\n    ]\n\n    results = []\n    \n    # pH range for root finding\n    ph_search_bracket = [5.5, 8.8]\n\n    for case_params in test_cases:\n        params = {**common_params, **case_params}\n\n        # Pre-calculate constants that depend on extracellular pH\n        h_out = 1000.0 * (10**(-params['ph_out']))\n        co2_product = params['alpha_co2'] * params['p_co2']\n        bicarb_out = co2_product * (10**(params['ph_out'] - params['pka']))\n\n        def balance_function(ph_in):\n            \"\"\"\n            This function represents the steady-state proton balance equation F(pH_in) = 0.\n            We solve for the root of this function.\n            F(pH_in) = J_met - J_NHE - J_V - J_AE = 0\n            \"\"\"\n            # Calculate intracellular concentrations based on ph_in\n            h_in = 1000.0 * (10**(-ph_in))\n            bicarb_in = co2_product * (10**(ph_in - params['pka']))\n\n            # Calculate flux for Na+/H+ exchanger (J_NHE)\n            j_nhe = params['g_nhe'] * (params['na_out'] * h_in - params['na_in'] * h_out)\n\n            # Calculate flux for V-ATPase proton pump (J_V)\n            j_v = params['v_max'] * h_in / (params['k_pump'] + h_in)\n\n            # Calculate flux for Cl-/HCO3- exchanger (J_AE), defined as bicarbonate influx\n            j_ae = params['g_ae'] * (params['cl_in'] * bicarb_out - params['cl_out'] * bicarb_in)\n            \n            return params['j_met'] - j_nhe - j_v - j_ae\n\n        # Solve for ph_in using a robust bracketed root-finder.\n        # The balance_function is monotonic, so brentq is highly reliable.\n        sol = root_scalar(balance_function, bracket=ph_search_bracket, method='brentq')\n        ph_in_steady_state = sol.root\n        results.append(ph_in_steady_state)\n\n        # Internal validation: Compute the required fixed anion concentration [A-]_in\n        # to ensure charge balance, as per the problem description. This is not for output.\n        h_in_final = 1000.0 * (10**(-ph_in_steady_state))\n        bicarb_in_final = co2_product * (10**(ph_in_steady_state - params['pka']))\n        a_in_final = (params['na_in'] + params['k_in'] + h_in_final) - \\\n                     (params['cl_in'] + bicarb_in_final)\n        # For a physically valid model, a_in_final should be positive.\n\n    # Format the output as a single line string according to the specification.\n    output_str = \"[\" + \",\".join(f\"{res:.4f}\" for res in results) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2772402"}]}