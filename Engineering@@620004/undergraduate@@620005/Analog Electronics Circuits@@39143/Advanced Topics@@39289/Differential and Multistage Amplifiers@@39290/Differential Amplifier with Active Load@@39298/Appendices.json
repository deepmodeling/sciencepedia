{"hands_on_practices": [{"introduction": "This first exercise tackles a fundamental task in analog circuit design: dimensioning transistors to meet a specific performance target. Here, you will connect the amplifier’s overall differential transconductance ($G_m$), a critical parameter that directly influences voltage gain, to the aspect ratio ($W/L$) of the input transistors. This practice solidifies the relationship between device physics, biasing, and high-level circuit performance. [@problem_id:1297240]", "problem": "An analog circuit designer is developing the input stage for a new operational amplifier. This stage consists of an NMOS differential pair ($M_1$ and $M_2$) with a PMOS current mirror active load. The differential pair is biased by a constant tail current source, $I_{SS}$. To meet the amplifier's overall gain specification, the differential input stage must achieve a specific small-signal differential transconductance, $G_m$.\n\nAssuming both input NMOS transistors are identical, operate in the saturation region, and can be described by the square-law model, determine the required aspect ratio, $(W/L)$, for these input transistors. Neglect channel-length modulation (i.e., assume the output resistance $r_o$ is infinite) and body effect.\n\nThe design specifications and process parameters are as follows:\n- Required differential transconductance, $G_m = 1.00\\,\\text{mS}$ (where $1\\,\\text{S} = 1\\,\\text{A/V}$)\n- Tail bias current, $I_{SS} = 200\\,\\mu\\text{A}$\n- NMOS process transconductance parameter, $\\mu_n C_{ox} = 400\\,\\mu\\text{A/V}^2$\n\nCalculate the required dimensionless aspect ratio $(W/L)$.", "solution": "For an NMOS in saturation with the square-law model and neglecting channel-length modulation and body effect, the drain current and transconductance are\n$$\nI_D=\\frac{1}{2}\\mu_n C_{ox}\\frac{W}{L}V_{OV}^{2},\\qquad g_m=\\frac{\\partial I_D}{\\partial V_{GS}}=\\mu_n C_{ox}\\frac{W}{L}V_{OV}.\n$$\nIn a differential pair with an ideal tail source, each transistor carries the quiescent current\n$$\nI_D=\\frac{I_{SS}}{2}.\n$$\nWith a PMOS current-mirror active load that performs differential-to-single-ended conversion, the small-signal transconductance from the differential input to the single-ended output equals the transconductance of one input transistor, so the required $g_m$ equals the specified $G_m$.\n\nEliminating $V_{OV}$ between the two equations,\n$$\nV_{OV}=\\frac{g_m}{\\mu_n C_{ox}\\frac{W}{L}},\n$$\nand substituting into $I_D$ gives\n$$\nI_D=\\frac{1}{2}\\mu_n C_{ox}\\frac{W}{L}\\left(\\frac{g_m}{\\mu_n C_{ox}\\frac{W}{L}}\\right)^{2}=\\frac{1}{2}\\frac{g_m^{2}}{\\mu_n C_{ox}\\frac{W}{L}}.\n$$\nSolving for the aspect ratio,\n$$\n\\frac{W}{L}=\\frac{g_m^{2}}{2\\mu_n C_{ox}I_D}=\\frac{G_m^{2}}{2\\mu_n C_{ox}\\left(\\frac{I_{SS}}{2}\\right)}=\\frac{G_m^{2}}{\\mu_n C_{ox}I_{SS}}.\n$$\nSubstituting the given values in scientific notation,\n$$\nG_m=1.00\\times 10^{-3},\\quad \\mu_n C_{ox}=4.00\\times 10^{-4},\\quad I_{SS}=2.00\\times 10^{-4},\n$$\nyields\n$$\n\\frac{W}{L}=\\frac{(1.00\\times 10^{-3})^{2}}{(4.00\\times 10^{-4})(2.00\\times 10^{-4})}=\\frac{1.00\\times 10^{-6}}{8.00\\times 10^{-8}}=12.5.\n$$\nThus, the required aspect ratio is $12.5$ (dimensionless).", "answer": "$$\\boxed{12.5}$$", "id": "1297240"}, {"introduction": "An amplifier's usefulness depends not only on its gain but also on its speed. This practice shifts our focus from static characteristics to the dynamic response of the circuit by asking you to determine its settling time. You will calculate the amplifier's small-signal output resistance—a key figure of merit determined by the active load and input pair—and use it to analyze how quickly the output settles in response to a step input. [@problem_id:1297204]", "problem": "An integrated circuit designer is characterizing the transient response of a fundamental building block: a differential amplifier. The amplifier is constructed using four Metal-Oxide-Semiconductor Field-Effect Transistors (MOSFETs) in a standard configuration. An n-channel MOSFET (NMOS) differential pair (M1, M2) forms the input stage, and a p-channel MOSFET (PMOS) current mirror (M3, M4) serves as the active load. The single-ended output is taken from the drain of M2, which is connected to the drain of M4. The entire circuit is biased by an ideal tail current source, $I_{SS}$, with a magnitude of $200\\ \\mu\\text{A}$. All transistors are operating in the saturation region.\n\nThe relevant small-signal device parameters, determined by the fabrication process and biasing conditions, are as follows:\n- For the NMOS transistors (M1, M2): the channel-length modulation parameter is $\\lambda_n = 0.05\\ \\text{V}^{-1}$.\n- For the PMOS transistors (M3, M4): the channel-length modulation parameter is $\\lambda_p = 0.04\\ \\text{V}^{-1}$.\n\nThe total parasitic capacitance at the output node, which includes contributions from the transistors and interconnects, is found to be $C_L = 1.0\\ \\text{pF}$.\n\nAt time $t=0$, a small differential step voltage is applied to the input, causing the output voltage to change. To analyze the speed of the amplifier, model its response as that of a single-pole system. Calculate the 1% settling time, defined as the time it takes for the output voltage to reach and stay within 1% of its final value after the step input is applied.\n\nExpress your answer in nanoseconds (ns) and round it to three significant figures.", "solution": "Model the output node as a single-pole with time constant $\\tau = R_{\\text{out}} C_{L}$. For a first-order step response, the error decays as $\\exp(-t/\\tau)$, so the time to settle within $0.01$ of the final value satisfies $\\exp(-t_{1\\%}/\\tau) = 0.01$, hence\n$$\nt_{1\\%} = \\tau \\ln(100).\n$$\n\nWith an ideal tail current source and small-signal operation about the symmetric bias point, each side of the differential pair carries $I_{D} = I_{SS}/2$. The small-signal output resistances of M2 (NMOS) and M4 (PMOS) in saturation are\n$$\nr_{o,n} = \\frac{1}{\\lambda_{n} I_{D}} = \\frac{1}{\\lambda_{n} \\left( I_{SS}/2 \\right)} = \\frac{2}{\\lambda_{n} I_{SS}}, \\qquad\nr_{o,p} = \\frac{1}{\\lambda_{p} I_{D}} = \\frac{1}{\\lambda_{p} \\left( I_{SS}/2 \\right)} = \\frac{2}{\\lambda_{p} I_{SS}}.\n$$\nThe effective resistance at the output node is their parallel combination:\n$$\nR_{\\text{out}} = \\frac{r_{o,n} \\, r_{o,p}}{r_{o,n} + r_{o,p}} = \\frac{2}{I_{SS} \\left( \\lambda_{n} + \\lambda_{p} \\right)}.\n$$\nTherefore,\n$$\n\\tau = R_{\\text{out}} C_{L} = \\frac{2 C_{L}}{I_{SS} \\left( \\lambda_{n} + \\lambda_{p} \\right)},\n\\quad\nt_{1\\%} = \\tau \\ln(100) = \\frac{2 C_{L} \\ln(100)}{I_{SS} \\left( \\lambda_{n} + \\lambda_{p} \\right)}.\n$$\n\nSubstitute the given values $C_{L} = 1.0 \\times 10^{-12}$, $I_{SS} = 200 \\times 10^{-6}$, $\\lambda_{n} = 0.05$, and $\\lambda_{p} = 0.04$:\n$$\nR_{\\text{out}} = \\frac{2}{(200 \\times 10^{-6})(0.05 + 0.04)} \\approx 1.11111 \\times 10^{5},\n$$\n$$\n\\tau = R_{\\text{out}} C_{L} \\approx (1.11111 \\times 10^{5})(1.0 \\times 10^{-12}) = 1.11111 \\times 10^{-7},\n$$\n$$\nt_{1\\%} = \\tau \\ln(100) \\approx (1.11111 \\times 10^{-7}) \\times \\ln(100) \\approx (1.11111 \\times 10^{-7}) \\times 4.605170 \\approx 5.11685 \\times 10^{-7}.\n$$\nConverting to nanoseconds gives $t_{1\\%} \\approx 5.11685 \\times 10^{2}$ ns, which rounds to three significant figures as $512$ ns.", "answer": "$$\\boxed{512}$$", "id": "1297204"}, {"introduction": "Our small-signal models and performance calculations rely on the crucial assumption that all transistors operate in the saturation region. This final exercise tests the validity of that assumption under a non-zero differential input, a condition that pushes the amplifier away from its ideal bias point. By performing a detailed DC analysis, you will determine if any transistor falls into the triode region, gaining practical insight into the amplifier's operational limits, such as its input voltage range and output swing. [@problem_id:1297253]", "problem": "An analog circuit designer is analyzing the input stage of an operational amplifier, which is a differential amplifier with an active load, implemented in a Complementary Metal-Oxide-Semiconductor (CMOS) process. The circuit consists of five transistors. Transistors M1 and M2 form the NMOS differential pair. Their gates are the differential inputs, $V_{in1}$ and $V_{in2}$. Their sources are connected together and to the drain of transistor M5. Transistors M3 and M4 form a PMOS current mirror that serves as the active load. Their sources are connected to the positive supply voltage, $V_{DD}$. Their gates are connected together, and this common gate node is also connected to the drain of M3. The drain of M1 is connected to the drain of M3. The drain of M2 is connected to the drain of M4, and this node serves as the circuit's output, $V_{out}$. Transistor M5 is an NMOS transistor with its source connected to the negative supply voltage, $V_{SS}$, providing a constant bias current, $I_{bias}$.\n\nThe circuit operates with supply voltages $V_{DD} = 1.5 \\ \\text{V}$ and $V_{SS} = -1.5 \\ \\text{V}$. The DC bias current provided by M5 is $I_{bias} = 200 \\ \\mu\\text{A}$. For the purpose of this DC analysis, you can ignore the channel-length modulation effect (i.e., assume $\\lambda = 0$ for all transistors).\n\nThe device parameters are as follows:\n- For all NMOS transistors (M1, M2, M5): Threshold voltage $V_{tn} = 0.4 \\ \\text{V}$, and process parameter $k'_n = 400 \\ \\mu\\text{A/V}^2$.\n- For all PMOS transistors (M3, M4): Threshold voltage $V_{tp} = -0.5 \\ \\text{V}$, and process parameter $k'_p = 100 \\ \\mu\\text{A/V}^2$.\n\nThe aspect ratios $(W/L)$ for the transistors are:\n- $(W/L)_1 = (W/L)_2 = 25$\n- $(W/L)_3 = (W/L)_4 = 100$\n- $(W/L)_5 = 50\n\nThe DC input voltages are set to $V_{in1} = -0.1 \\ \\text{V}$ and $V_{in2} = 0.1 \\ \\text{V}$. Determine which of the transistors, if any, are operating in the triode (linear) region under these conditions.\n\nA. M1\n\nB. M2\n\nC. M4\n\nD. M5\n\nE. All transistors are in saturation.", "solution": "Define saturation and triode conditions.\n- For an NMOS: saturation if $V_{DS} \\geq V_{OV,n}$ with $V_{OV,n} \\equiv V_{GS}-V_{tn}$; triode if $V_{DS} < V_{OV,n}$.\n- For a PMOS: saturation if $V_{SD} \\geq V_{OV,p}$ with $V_{OV,p} \\equiv V_{SG}-|V_{tp}|$; triode if $V_{SD} < V_{OV,p}$.\n\nDevice parameters and transconductance factors:\n- $k_{n1}=k_{n2}=k'_{n}(W/L)_{1,2}=400\\times 10^{-6}\\times 25=10\\times 10^{-3}\\ \\text{A/V}^{2}$,\n- $k_{p3}=k_{p4}=k'_{p}(W/L)_{3,4}=100\\times 10^{-6}\\times 100=10\\times 10^{-3}\\ \\text{A/V}^{2}$,\n- $k_{n5}=k'_{n}(W/L)_{5}=400\\times 10^{-6}\\times 50=20\\times 10^{-3}\\ \\text{A/V}^{2}$,\nwith $V_{tn}=0.4\\ \\text{V}$ and $|V_{tp}|=0.5\\ \\text{V}$.\n\nBecause $\\lambda=0$ and M3 is diode-connected, the PMOS mirror forces $I_{4}=I_{3}$ when M4 is in saturation; KCL at the output requires $I_{2}=I_{4}$. In a mirror-loaded differential pair with unequal inputs, the output adjusts so that $I_{2}=I_{4}=I_{1}$; with tail current $I_{1}+I_{2}=I_{bias}$, it follows that\n$$I_{1}=I_{2}=\\frac{I_{bias}}{2}=100\\times 10^{-6}\\ \\text{A}.$$\n\nSolve for the tail node voltage $V_{S}$ and mirror gate/drain voltage $V_{X}$ using M1 and M3 in saturation:\n- M1 saturation current: $I_{1}=\\frac{1}{2}k_{n1}(V_{g1}-V_{S}-V_{tn})^{2}$ with $V_{g1}=-0.1\\ \\text{V}$. Thus\n$$100\\times 10^{-6}= \\frac{1}{2}(10\\times 10^{-3})(-0.1-V_{S}-0.4)^{2} \\Rightarrow (-0.5 - V_{S})^{2}=0.02,$$\nso $-0.5 - V_{S}=+\\sqrt{0.02}=0.1414$ (choose positive overdrive), giving\n$$V_{S}=-0.6414\\ \\text{V},\\qquad V_{OV1}=V_{g1}-V_{S}-V_{tn}=0.1414\\ \\text{V}.$$\n\n- M3 diode-connected saturation current: $I_{3}=\\frac{1}{2}k_{p3}(V_{SG3}-|V_{tp}|)^{2}=100\\times 10^{-6}$, hence\n$$(V_{SG3}-0.5)^{2}=0.02 \\Rightarrow V_{SG3}=0.6414\\ \\text{V}.$$\nWith $V_{S3}=V_{DD}=1.5\\ \\text{V}$, the mirror gate/drain node is\n$$V_{X}=V_{G3}=V_{D3}=V_{S3}-V_{SG3}=1.5-0.6414=0.8586\\ \\text{V}.$$\n\nThus M4 has $V_{SG4}=0.6414\\ \\text{V}$ and, if saturated, $I_{4}=I_{3}=100\\times 10^{-6}\\ \\text{A}$. Its saturation condition requires\n$$V_{SD4}=V_{S4}-V_{D4}=1.5-V_{out}\\geq V_{OVp}=V_{SG4}-|V_{tp}|=0.1414\\ \\text{V},$$\nwhich will be verified after finding $V_{out}$.\n\nNow solve M2 in triode so that $I_{2}=I_{4}=100\\times 10^{-6}\\ \\text{A}$. For M2,\n$$V_{OV2}=V_{g2}-V_{S}-V_{tn}=0.1-(-0.6414)-0.4=0.3414\\ \\text{V},$$\nand the triode current is\n$$I_{2}=k_{n1}\\left[V_{OV2}V_{DS2}-\\frac{1}{2}V_{DS2}^{2}\\right],\\quad V_{DS2}=V_{out}-V_{S}.$$\nSet $I_{2}=100\\times 10^{-6}$ and $k_{n1}=10\\times 10^{-3}$:\n$$\\frac{I_{2}}{k_{n1}}=0.01 = V_{OV2}V_{DS2}-\\frac{1}{2}V_{DS2}^{2}.$$\nSolve the quadratic\n$$\\frac{1}{2}V_{DS2}^{2}-V_{OV2}V_{DS2}+0.01=0 \\;\\Rightarrow\\; V_{DS2}^{2}-0.6828\\,V_{DS2}+0.02=0.$$\nThe roots are $$V_{DS2}=\\frac{0.6828\\pm\\sqrt{0.6828^{2}-0.08}}{2},$$ giving the acceptable triode solution\n$$V_{DS2}\\approx 0.03065\\ \\text{V}\\quad(\\text{since }V_{DS2}<V_{OV2}=0.3414\\ \\text{V}).$$\nHence\n$$V_{out}=V_{S}+V_{DS2}\\approx -0.6414+0.03065=-0.6107\\ \\text{V}.$$\n\nNow verify each device’s region:\n- M1: $V_{DS1}=V_{D1}-V_{S}=V_{X}-V_{S}=0.8586-(-0.6414)=1.5\\ \\text{V}$ and $V_{OV1}=0.1414\\ \\text{V}$. Since $V_{DS1}\\gg V_{OV1}$, M1 is in saturation (not triode).\n- M2: $V_{DS2}=0.03065\\ \\text{V}$ and $V_{OV2}=0.3414\\ \\text{V}$, so $V_{DS2}<V_{OV2}$; M2 is in triode.\n- M4: $V_{SD4}=1.5-(-0.6107)=2.1107\\ \\text{V}$ and $V_{OVp}=0.1414\\ \\text{V}$, so $V_{SD4}\\geq V_{OVp}$; M4 is in saturation (not triode).\n- M5: Its overdrive for $I_{bias}=200\\times 10^{-6}\\ \\text{A}$ in saturation is from $I_{5}=\\frac{1}{2}k_{n5}V_{OV5}^{2}$:\n$$V_{OV5}^{2}=\\frac{I_{5}}{\\frac{1}{2}k_{n5}}=\\frac{0.2\\times 10^{-3}}{10\\times 10^{-3}}=0.02 \\Rightarrow V_{OV5}=0.1414\\ \\text{V}.$$\nWith $V_{DS5}=V_{S}-V_{SS}=-0.6414-(-1.5)=0.8586\\ \\text{V}\\geq V_{OV5}$, M5 is in saturation (not triode).\n\nConclusion: Only M2 operates in the triode (linear) region. Therefore, the correct option is B.", "answer": "$$\\boxed{B}$$", "id": "1297253"}]}