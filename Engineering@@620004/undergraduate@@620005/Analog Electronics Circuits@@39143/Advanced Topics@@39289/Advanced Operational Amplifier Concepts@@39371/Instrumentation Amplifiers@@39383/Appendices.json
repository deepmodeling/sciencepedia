{"hands_on_practices": [{"introduction": "This first exercise establishes the foundational skill for working with instrumentation amplifiers (In-Amps): calculating the differential gain. By analyzing the classic three-op-amp topology and applying basic circuit laws for ideal op-amps, you will derive and use the fundamental gain equation. This practice [@problem_id:1311724] is the starting point for understanding how an In-Amp precisely amplifies the difference between two signals.", "problem": "An engineer is designing a precision pre-amplifier circuit using a standard three-operational-amplifier (op-amp) instrumentation amplifier configuration. The op-amps are considered to be ideal.\n\nThe circuit is configured as follows:\nThe first stage consists of two op-amps, U1 and U2. The input signals, $v_1$ and $v_2$, are connected to the non-inverting inputs of U1 and U2, respectively. A resistor, designated as the gain resistor $R_G$, is connected between the inverting inputs of U1 and U2. Two identical resistors, each with resistance $R_1$, are used in the negative feedback paths; one connects the output of U1 to its inverting input, and the other connects the output of U2 to its inverting input.\n\nThe second stage is a difference amplifier built with a third op-amp, U3. The output of U1 is connected to the inverting input of U3 through a resistor $R_2$. The output of U2 is connected to the non-inverting input of U3 through another resistor, also of value $R_2$. A feedback resistor with resistance $R_3$ connects the output of U3 to its inverting input. Finally, another resistor with value $R_3$ connects the non-inverting input of U3 to ground.\n\nThe resistor values chosen for the design are:\n$R_G = 1.20\\,\\text{k}\\Omega$\n$R_1 = 22.0\\,\\text{k}\\Omega$\n$R_2 = 10.0\\,\\text{k}\\Omega$\n$R_3 = 47.0\\,\\text{k}\\Omega$\n\nCalculate the differential voltage gain, $A_d = \\frac{v_{out}}{v_2 - v_1}$, of this instrumentation amplifier. Round your final answer to three significant figures.", "solution": "For ideal op-amps, the input currents are zero and each op-amp maintains a virtual short between its inputs, so the inverting-node voltages in the first stage are $v_{1}$ (at node $a$ for U1) and $v_{2}$ (at node $b$ for U2).\n\nApplying KCL at node $a$ (inverting input of U1) using Ohm's law gives\n$$(v_{o1}-v_{1})/R_{1}=(v_{1}-v_{2})/R_{G} \\quad \\Rightarrow \\quad v_{o1}=v_{1}+\\frac{R_{1}}{R_{G}}(v_{1}-v_{2}).$$\nSimilarly, at node $b$ (inverting input of U2),\n$$(v_{o2}-v_{2})/R_{1}=(v_{2}-v_{1})/R_{G} \\quad \\Rightarrow \\quad v_{o2}=v_{2}+\\frac{R_{1}}{R_{G}}(v_{2}-v_{1}).$$\nTherefore, the first-stage differential output is\n$$v_{o2}-v_{o1}=\\left[1+2\\frac{R_{1}}{R_{G}}\\right](v_{2}-v_{1}).$$\n\nThe second stage is a difference amplifier with matched ratios $R_{3}/R_{2}$ on both arms, yielding (by superposition, voltage division on the non-inverting side, and KCL at the inverting node)\n$$v_{out}=\\frac{R_{3}}{R_{2}}(v_{o2}-v_{o1}).$$\nCombining with the first-stage result gives the overall differential gain\n$$A_{d}\\equiv \\frac{v_{out}}{v_{2}-v_{1}}=\\frac{R_{3}}{R_{2}}\\left(1+2\\frac{R_{1}}{R_{G}}\\right).$$\n\nSubstituting the given values $R_{G}=1.20\\,\\text{k}\\Omega$, $R_{1}=22.0\\,\\text{k}\\Omega$, $R_{2}=10.0\\,\\text{k}\\Omega$, $R_{3}=47.0\\,\\text{k}\\Omega$,\n$$A_{d}= \\frac{47.0}{10.0}\\left(1+2\\frac{22.0}{1.20}\\right)=4.7\\left(1+36.666\\ldots\\right)=4.7\\times 37.666\\ldots=177.033\\ldots$$\nRounded to three significant figures,\n$$A_{d}=177.$$", "answer": "$$\\boxed{177}$$", "id": "1311724"}, {"introduction": "Building on basic analysis, this next practice shifts the focus to design, a core engineering activity. Here, you'll tackle a realistic scenario where an In-Amp must be configured to meet the resolution requirements of a measurement system. This problem [@problem_id:1311759] challenges you to work backward from a desired system performance to determine the exact value of the gain-setting resistor $R_G$, demonstrating the In-Amp's key role in practical signal conditioning chains.", "problem": "An engineer is designing a Battery Management System (BMS) for an electric vehicle. A critical task is to accurately monitor the voltage of individual lithium-ion cells. For this purpose, a standard three-op-amp instrumentation amplifier is used to amplify the differential voltage across a single cell before it is measured by an Analog-to-Digital Converter (ADC).\n\nThe instrumentation amplifier is constructed as follows: The first stage consists of two op-amps, each with a feedback resistor of value $R_1$. These two op-amps are coupled by a single gain-setting resistor, $R_G$. The outputs of this first stage feed into a second-stage differential amplifier. This differential amplifier is built with four identical resistors, each having a value of $R_2$. For this design, the fixed resistor values are $R_1 = 20.0 \\, \\text{k}\\Omega$ and $R_2 = 50.0 \\, \\text{k}\\Omega$.\n\nTo ensure the safety and longevity of the battery, the BMS must be able to resolve voltage changes as small as $250 \\, \\mu\\text{V}$ across the cell terminals. The ADC connected to the output of the instrumentation amplifier has a voltage resolution (the smallest voltage change it can detect) of $5.00 \\, \\text{mV}$.\n\nAssuming ideal op-amp behavior, calculate the value of the gain-setting resistor $R_G$ that is required to meet this minimum resolution specification. Express your answer in kilo-ohms ($k\\Omega$) and round to three significant figures.", "solution": "The output of an ideal three-op-amp instrumentation amplifier is proportional to the input differential voltage, with overall differential gain given by the product of the first-stage gain and the second-stage differential gain. For the described topology:\n- The first-stage gain is \n$$\nG_{1} = 1 + \\frac{2R_{1}}{R_{G}}.\n$$\n- The second-stage differential amplifier uses four equal resistors $R_{2}$, giving unity differential gain:\n$$\nG_{2} = \\frac{R_{2}}{R_{2}} = 1.\n$$\nThus, the overall differential gain is\n$$\nG = G_{1}G_{2} = 1 + \\frac{2R_{1}}{R_{G}}.\n$$\n\nTo meet the resolution requirement, the minimum input change $\\Delta V_{\\text{in}} = 250 \\, \\mu\\text{V}$ must produce at least one least significant bit at the ADC input, $\\Delta V_{\\text{ADC}} = 5.00 \\, \\text{mV}$. Therefore, the required gain is\n$$\nG_{\\text{req}} = \\frac{\\Delta V_{\\text{ADC}}}{\\Delta V_{\\text{in}}} = \\frac{5.00 \\, \\text{mV}}{250 \\, \\mu\\text{V}} = 20.\n$$\n\nSet the overall gain equal to $G_{\\text{req}}$ and solve for $R_{G}$:\n$$\n1 + \\frac{2R_{1}}{R_{G}} = 20 \\quad \\Rightarrow \\quad \\frac{2R_{1}}{R_{G}} = 19 \\quad \\Rightarrow \\quad R_{G} = \\frac{2R_{1}}{19}.\n$$\nWith $R_{1} = 20.0 \\, \\text{k}\\Omega$,\n$$\nR_{G} = \\frac{2 \\times 20.0 \\, \\text{k}\\Omega}{19} = \\frac{40.0}{19} \\, \\text{k}\\Omega \\approx 2.105263\\ldots \\, \\text{k}\\Omega.\n$$\nRounded to three significant figures,\n$$\nR_{G} \\approx 2.11 \\, \\text{k}\\Omega.\n$$", "answer": "$$\\boxed{2.11}$$", "id": "1311759"}, {"introduction": "Real-world amplifiers are not ideal; they are limited by their power supply voltages. This final exercise delves into one of the most critical practical limitations of an instrumentation amplifier: its input common-mode range. By deriving the conditions under which the internal op-amps saturate, this problem [@problem_id:1311737] reveals the intricate relationship between the common-mode voltage, differential voltage, and gain. Understanding this trade-off is essential for designing robust circuits that avoid clipping and distortion.", "problem": "Consider a standard three-operational-amplifier (op-amp) Instrumentation Amplifier (In-Amp). The circuit is composed of a first stage with two non-inverting op-amps (A1 and A2) and a second stage which is a difference amplifier (A3). An input voltage $v_1$ is applied to the non-inverting terminal of A1, and an input voltage $v_2$ is applied to the non-inverting terminal of A2.\n\nThe feedback network for the input stage features a single resistor with resistance $R_G$ connected between the inverting terminals of A1 and A2. A resistor of resistance $R_1$ connects the output of A1 to its inverting terminal, and another resistor of resistance $R_1$ connects the output of A2 to its inverting terminal.\n\nThe second stage is a unity-gain difference amplifier built around op-amp A3 using four identical resistors, each with resistance $R_2$. The output of A1, $v_{o1}$, is connected to the inverting input of A3 through one of these resistors, and the output of A2, $v_{o2}$, is connected to the non-inverting input of A3 through another.\n\nAll three op-amps are ideal, with the exception that their output voltage is limited by symmetric power supply rails, $+V_S$ and $-V_S$. For the In-Amp to operate in its linear region, the output of each op-amp must remain within the range $[-V_S, +V_S]$.\n\nThe circuit's inputs are characterized by a differential voltage $v_d = v_2 - v_1$ and a common-mode voltage $v_{cm} = \\frac{v_1 + v_2}{2}$. For a given non-zero differential input $v_d$, the amplifier will only function correctly (i.e., without any op-amp output saturating) if the common-mode input $v_{cm}$ is within a specific range.\n\nDerive the analytical expressions for the minimum allowable common-mode voltage, $V_{cm,min}$, and the maximum allowable common-mode voltage, $V_{cm,max}$. Express your answers in terms of $V_S$, $v_d$, $R_1$, and $R_G$. Your final answer should be a pair of expressions for $(V_{cm,min}, V_{cm,max})$.", "solution": "The operational range of the instrumentation amplifier is limited by the saturation of its internal op-amps. The common-mode input voltage, $v_{cm}$, is passed through the input buffer stage (A1 and A2) but is rejected by the subsequent difference amplifier stage (A3). Therefore, the limitation on the input common-mode range arises from the need to keep the outputs of the first-stage op-amps, $v_{o1}$ and $v_{o2}$, within their saturation limits, which are $[-V_S, +V_S]$.\n\nFirst, let's determine the expressions for $v_{o1}$ and $v_{o2}$.\nFor ideal op-amps A1 and A2, the voltage at the inverting input is equal to the voltage at the non-inverting input. Thus, the voltage at the inverting terminal of A1 is $v_1$, and the voltage at the inverting terminal of A2 is $v_2$.\nApplying Kirchhoff's Current Law (KCL) at the inverting input of A1 (node voltage $v_1$), and noting that no current enters the op-amp input:\n$$ \\frac{v_1 - v_{o1}}{R_1} + \\frac{v_1 - v_2}{R_G} = 0 \\implies v_{o1} = v_1 + R_1 \\frac{v_1 - v_2}{R_G} $$\nUsing the definition $v_d = v_2 - v_1$, this becomes:\n$$ v_{o1} = v_1 - R_1 \\frac{v_d}{R_G} $$\nSimilarly, applying KCL at the inverting input of A2 (node voltage $v_2$):\n$$ \\frac{v_2 - v_{o2}}{R_1} + \\frac{v_2 - v_1}{R_G} = 0 \\implies v_{o2} = v_2 + R_1 \\frac{v_2 - v_1}{R_G} $$\n$$ v_{o2} = v_2 + R_1 \\frac{v_d}{R_G} $$\n\nNext, we express $v_1$ and $v_2$ in terms of the common-mode voltage $v_{cm}$ and differential voltage $v_d$:\n$$v_1 = v_{cm} - \\frac{v_d}{2}$$\n$$v_2 = v_{cm} + \\frac{v_d}{2}$$\nSubstituting these into the expressions for $v_{o1}$ and $v_{o2}$:\n$$v_{o1} = \\left(v_{cm} - \\frac{v_d}{2}\\right) - \\frac{R_1}{R_G} v_d = v_{cm} - v_d \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right)$$\n$$v_{o2} = \\left(v_{cm} + \\frac{v_d}{2}\\right) + \\frac{R_1}{R_G} v_d = v_{cm} + v_d \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right)$$\n\nFor linear operation, both $v_{o1}$ and $v_{o2}$ must be within the supply rails:\n$$-V_S \\le v_{o1} \\le +V_S$$\n$$-V_S \\le v_{o2} \\le +V_S$$\n\nLet's apply these constraints to our expressions for $v_{o1}$ and $v_{o2}$.\nFor $v_{o1}$:\n$$-V_S \\le v_{cm} - v_d \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right) \\le V_S$$\nThis gives two inequalities for $v_{cm}$:\n$$v_{cm} \\ge -V_S + v_d \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right)$$\n$$v_{cm} \\le V_S + v_d \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right)$$\n\nFor $v_{o2}$:\n$$-V_S \\le v_{cm} + v_d \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right) \\le V_S$$\nThis gives two more inequalities for $v_{cm}$:\n$$v_{cm} \\ge -V_S - v_d \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right)$$\n$$v_{cm} \\le V_S - v_d \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right)$$\n\nTo find the allowable range for $v_{cm}$, we must satisfy all four inequalities simultaneously.\nThe lower bound for $v_{cm}$, $V_{cm,min}$, must be the maximum of the two lower bounds:\n$$V_{cm,min} = \\max \\left[-V_S + v_d \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right), -V_S - v_d \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right) \\right]$$\nThe upper bound for $v_{cm}$, $V_{cm,max}$, must be the minimum of the two upper bounds:\n$$V_{cm,max} = \\min \\left[V_S + v_d \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right), V_S - v_d \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right) \\right]$$\n\nLet the term $X = v_d \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right)$.\nThen $V_{cm,min} = \\max[-V_S + X, -V_S - X] = -V_S + \\max[X, -X] = -V_S + |X|$.\nAnd $V_{cm,max} = \\min[V_S + X, V_S - X] = V_S - \\max[X, -X] = V_S - |X|$.\n\nSince $R_1$ and $R_G$ are resistances, the term $\\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right)$ is always positive.\nTherefore, $|X| = |v_d| \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right)$.\n\nThe minimum and maximum allowable common-mode voltages are:\n$$V_{cm,min} = -V_S + |v_d| \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right)$$\n$$V_{cm,max} = V_S - |v_d| \\left(\\frac{1}{2} + \\frac{R_1}{R_G}\\right)$$\n\nWe can write the term in the parenthesis with a common denominator for a cleaner expression:\n$\\frac{1}{2} + \\frac{R_1}{R_G} = \\frac{R_G + 2R_1}{2R_G}$.\n\nSo the final expressions for the minimum and maximum allowable common-mode voltages are:\n$$V_{cm,min} = -V_S + |v_d| \\left(\\frac{R_G + 2R_1}{2R_G}\\right)$$\n$$V_{cm,max} = V_S - |v_d| \\left(\\frac{R_G + 2R_1}{2R_G}\\right)$$\nThe problem asks for the pair $(V_{cm,min}, V_{cm,max})$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix} -V_S + |v_d| \\left(\\frac{R_G + 2R_1}{2R_G}\\right) & V_S - |v_d| \\left(\\frac{R_G + 2R_1}{2R_G}\\right) \\end{pmatrix}\n}\n$$", "id": "1311737"}]}