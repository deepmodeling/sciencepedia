{"hands_on_practices": [{"introduction": "The cornerstone of analog circuit design is the ability to translate a high-level performance requirement, such as voltage gain, into specific device-level parameters. This practice focuses on this fundamental skill by exploring the relationship between an amplifier's DC bias and its AC performance. By determining the necessary tail current to achieve a target differential gain, you will engage with the core trade-offs that govern the design of a basic differential pair [@problem_id:1306690].", "problem": "An analog circuit designer is creating the input stage of an amplifier using a basic N-type Metal-Oxide-Semiconductor (NMOS) differential pair. The differential pair consists of two identical NMOS transistors, M1 and M2, and is biased by an ideal constant current source providing a tail current $I_{SS}$. Each transistor has a resistive load, $R_{D}$, connected between its drain and the positive supply voltage. For this design, the transistors are assumed to be operating in the saturation region, and the effect of channel-length modulation is considered negligible. The process and device parameters for the identical transistors are characterized by a combined term $k_{n} = \\mu_n C_{ox} (W/L)$, where $\\mu_n$ is the electron mobility, $C_{ox}$ is the gate oxide capacitance per unit area, and $(W/L)$ is the aspect ratio of the transistors.\n\nThe design requires the amplifier to achieve a specific small-signal differential voltage gain magnitude, $A_{v}$. Derive an expression for the required tail current, $I_{SS}$, in terms of the target gain magnitude $A_{v}$, the load resistance $R_{D}$, and the parameter $k_{n}$.", "solution": "The solution involves determining the required transconductance ($g_m$) from the voltage gain specification and then relating this transconductance to the tail current ($I_{SS}$) using the transistor's square-law model.\n\nFirst, we begin with the expression for the small-signal differential voltage gain, $A_d = \\frac{v_{od}}{v_{id}}$, of a differential pair with resistive loads $R_{D}$. The gain is given by $A_d = -g_m R_{D}$, where $g_m$ is the transconductance of each of the identical input transistors. The problem specifies a target for the magnitude of this gain, which we denote as $A_{v}$.\n$$A_{v} = |A_d| = |-g_m R_{D}| = g_m R_{D}$$\n\nFrom this gain equation, we can solve for the required transconductance, $g_m$, to meet the specification:\n$$g_m = \\frac{A_{v}}{R_{D}}$$\n\nNext, we relate the transconductance $g_m$ to the DC bias conditions of the transistor. For an NMOS transistor operating in the saturation region, the transconductance is given by the square-law model equation:\n$$g_m = \\sqrt{2 k_{n} I_D}$$\nwhere $I_D$ is the DC drain current of the transistor and $k_{n}$ is the provided process and device parameter.\n\nIn a symmetrically biased differential pair, the tail current $I_{SS}$ from the ideal current source is split equally between the two transistors, M1 and M2. Therefore, the DC drain current for each transistor is:\n$$I_D = \\frac{I_{SS}}{2}$$\n\nNow we substitute this expression for $I_D$ into the transconductance formula:\n$$g_m = \\sqrt{2 k_{n} \\left(\\frac{I_{SS}}{2}\\right)} = \\sqrt{k_{n} I_{SS}}$$\nThis gives us a direct relationship between the transconductance of each transistor and the total tail current $I_{SS}$.\n\nWe now have two expressions for $g_m$. By equating them, we can solve for the required $I_{SS}$:\n$$\\frac{A_{v}}{R_{D}} = \\sqrt{k_{n} I_{SS}}$$\n\nTo isolate $I_{SS}$, we square both sides of the equation:\n$$\\left(\\frac{A_{v}}{R_{D}}\\right)^2 = k_{n} I_{SS}$$\n\nFinally, dividing by $k_{n}$ yields the expression for the required tail current:\n$$I_{SS} = \\frac{1}{k_{n}} \\left(\\frac{A_{v}}{R_{D}}\\right)^2 = \\frac{A_{v}^2}{k_{n} R_{D}^2}$$\nThis is the final expression for the tail current needed to achieve the specified differential voltage gain magnitude.", "answer": "$$\\boxed{\\frac{A_{v}^{2}}{k_{n} R_{D}^{2}}}$$", "id": "1306690"}, {"introduction": "While achieving a desired gain is crucial, an amplifier's utility is also defined by its speed. This exercise shifts our focus from static characteristics to dynamic performance limitations, specifically the slew rate. Understanding how slew rate constrains the maximum frequency and amplitude of an output signal is essential for designing amplifiers intended for high-speed data acquisition or communication systems [@problem_id:1306686].", "problem": "A fully differential amplifier (FDA) is a key component in a high-performance data acquisition system. Its ability to reject common-mode noise makes it ideal for amplifying small signals in noisy environments. The performance of this amplifier, however, is limited by its slew rate, which restricts how quickly its output voltage can change.\n\nConsider an FDA that is configured to produce a balanced, sinusoidal differential output voltage, defined as $V_{od}(t) = V_{out,p}(t) - V_{out,n}(t)$, where $V_{out,p}(t)$ and $V_{out,n}(t)$ are the voltages at the positive and negative output terminals, respectively. The two single-ended outputs swing symmetrically around a fixed common-mode voltage. The peak amplitude of the differential output signal is $V_{od,\\text{peak}} = 4.0 \\text{ V}$. The amplifier has a specified slew rate of $SR = 1.5 \\text{ V/Âµs}$.\n\nDetermine the maximum operating frequency of this sinusoidal signal before the output becomes distorted due to slew rate limiting. Express your final answer in Megahertz (MHz), rounded to three significant figures.", "solution": "Let the FDA produce balanced single-ended outputs that are sinusoidal and symmetric about the common-mode voltage. With differential peak amplitude $V_{od,\\text{peak}}$, the single-ended outputs can be written as\n$$\nV_{out,p}(t)=V_{cm}+\\frac{V_{od,\\text{peak}}}{2}\\sin(\\omega t), \\quad\nV_{out,n}(t)=V_{cm}-\\frac{V_{od,\\text{peak}}}{2}\\sin(\\omega t),\n$$\nso each single-ended output has peak amplitude $V_{od,\\text{peak}}/2$.\n\nBy definition, the slew rate $SR$ limits the magnitude of the time derivative of each single-ended output. For a sinusoid $v(t)=V_{p}\\sin(\\omega t)$, the derivative is\n$$\n\\frac{dv}{dt}= \\omega V_{p}\\cos(\\omega t),\n$$\nwhose maximum magnitude is $\\omega V_{p}$. Applying this to each single-ended output gives the constraint\n$$\n\\omega \\left(\\frac{V_{od,\\text{peak}}}{2}\\right)\\leq SR.\n$$\nUsing $\\omega=2\\pi f$, the maximum frequency before slew-induced distortion is\n$$\nf_{\\max}=\\frac{SR}{\\pi V_{od,\\text{peak}}}.\n$$\n\nSubstituting the given values $SR=1.5\\,\\text{V}/\\mu\\text{s}$ and $V_{od,\\text{peak}}=4.0\\,\\text{V}$, and noting that $\\text{V}/\\mu\\text{s}$ divided by $\\text{V}$ yields $\\mu\\text{s}^{-1}$ (i.e., MHz), we obtain\n$$\nf_{\\max}=\\frac{1.5}{\\pi\\cdot 4.0}\\ \\text{MHz}\\approx 0.119\\ \\text{MHz},\n$$\nrounded to three significant figures.", "answer": "$$\\boxed{0.119}$$", "id": "1306686"}, {"introduction": "In an ideal world, amplifiers would only scale signals, but in reality, they introduce non-linearity. This advanced practice explores the consequences of this non-ideal behavior by analyzing third-order intermodulation distortion (IM3), a critical issue in high-fidelity systems. By deriving the amplitude of these distortion products, you will gain insight into how to model and quantify the non-linear performance of a fully differential amplifier [@problem_id:1306668].", "problem": "Consider a fully differential amplifier constructed with perfectly matched input transistors. The amplifier is biased such that its nonlinear behavior for small differential input signals, $v_{id}$, can be accurately modeled. The relationship between the differential input voltage and the resulting differential output current, $\\Delta i_d = i_{d1} - i_{d2}$, is given by the polynomial expansion:\n$$\n\\Delta i_d = g_m v_{id} + g_{m3} v_{id}^3\n$$\nHere, $g_m$ is the small-signal transconductance and $g_{m3}$ is the third-order nonlinear coefficient. All other terms in the expansion are considered negligible. The amplifier is connected to a pair of matched resistive loads, each with resistance $R_L$.\n\nA two-tone test signal is applied to the input of the amplifier, resulting in a differential input voltage of the form:\n$$\nv_{id}(t) = A \\cos(\\omega_1 t) + A \\cos(\\omega_2 t)\n$$\nwhere $A$ is the amplitude of each tone, and their frequencies, $\\omega_1$ and $\\omega_2$, are closely spaced.\n\nThe nonlinearity of the amplifier causes the generation of new frequency components at the output. Of particular concern are the Third-Order Intermodulation (IM3) products, which are distortion components that appear at frequencies close to the fundamental tones, specifically at $2\\omega_1 - \\omega_2$ and $2\\omega_2 - \\omega_1$.\n\nDerive an analytic expression for the amplitude, denoted as $V_{IM3}$, of these IM3 distortion components present in the differential output voltage, $v_{od} = v_{o1} - v_{o2}$. Express your answer in terms of the given parameters $A$, $R_L$, and $g_{m3}$.", "solution": "We are given a fully differential transconductor whose differential output current is modeled by\n$$\n\\Delta i_{d}=g_{m} v_{id}+g_{m3} v_{id}^{3},\n$$\nand the input is a two-tone signal\n$$\nv_{id}(t)=A\\cos(\\omega_{1}t)+A\\cos(\\omega_{2}t).\n$$\nOnly the cubic term generates third-order intermodulation (IM3) components near the fundamentals; the linear term contributes only at the fundamental frequencies. Therefore, we focus on the cubic term:\n$$\nv_{id}^{3}=A^{3}\\left(\\cos(\\omega_{1}t)+\\cos(\\omega_{2}t)\\right)^{3}.\n$$\nExpanding the cube,\n$$\n\\left(\\cos\\alpha+\\cos\\beta\\right)^{3}=\\cos^{3}\\alpha+3\\cos^{2}\\alpha\\cos\\beta+3\\cos\\alpha\\cos^{2}\\beta+\\cos^{3}\\beta.\n$$\nUse the trigonometric identities\n$$\n\\cos^{3}x=\\frac{3\\cos x+\\cos 3x}{4},\\qquad \\cos^{2}x=\\frac{1+\\cos 2x}{2},\\qquad \\cos x\\,\\cos y=\\frac{\\cos(x+y)+\\cos(x-y)}{2}.\n$$\nThe IM3 components at frequencies $2\\omega_{1}-\\omega_{2}$ and $2\\omega_{2}-\\omega_{1}$ arise from the cross terms $3\\cos^{2}\\alpha\\cos\\beta$ and $3\\cos\\alpha\\cos^{2}\\beta$, respectively. For example,\n$$\n3\\cos^{2}\\alpha\\cos\\beta=3\\left(\\frac{1+\\cos 2\\alpha}{2}\\right)\\cos\\beta=\\frac{3}{2}\\cos\\beta+\\frac{3}{2}\\cos 2\\alpha\\cos\\beta,\n$$\nand\n$$\n\\cos 2\\alpha\\cos\\beta=\\frac{\\cos(2\\alpha+\\beta)+\\cos(2\\alpha-\\beta)}{2},\n$$\nso the coefficient of $\\cos(2\\alpha-\\beta)$ from this term is $\\frac{3}{4}$. By symmetry, the term $3\\cos\\alpha\\cos^{2}\\beta$ contributes $\\frac{3}{4}$ to $\\cos(2\\beta-\\alpha)$. The $\\cos^{3}$ terms generate only fundamentals and third harmonics, not IM3.\n\nTherefore,\n$$\nv_{id}^{3}(t)=A^{3}\\left[\\frac{3}{4}\\cos\\left((2\\omega_{1}-\\omega_{2})t\\right)+\\frac{3}{4}\\cos\\left((2\\omega_{2}-\\omega_{1})t\\right)+\\text{(other frequencies)}\\right].\n$$\nThe corresponding differential current IM3 components are\n$$\n\\Delta i_{d,\\text{IM3}}(t)=g_{m3}A^{3}\\frac{3}{4}\\left[\\cos\\left((2\\omega_{1}-\\omega_{2})t\\right)+\\cos\\left((2\\omega_{2}-\\omega_{1})t\\right)\\right],\n$$\nso the amplitude of each IM3 current component is $\\frac{3}{4}|g_{m3}|A^{3}$.\n\nWith matched resistive loads $R_{L}$, the differential output voltage is related to the differential current by\n$$\nv_{od}=-R_{L}\\,\\Delta i_{d}.\n$$\nThus, the amplitude of each IM3 component in the differential output voltage is\n$$\nV_{IM3}=R_{L}\\left(\\frac{3}{4}|g_{m3}|A^{3}\\right).\n$$\nSince amplitude is a magnitude, we report the positive value. Equivalently, if sign is not a concern, one may write $V_{IM3}=\\frac{3}{4}R_{L}g_{m3}A^{3}$ and understand it as an amplitude.", "answer": "$$\\boxed{\\frac{3}{4}\\,R_{L}\\,|g_{m3}|\\,A^{3}}$$", "id": "1306668"}]}