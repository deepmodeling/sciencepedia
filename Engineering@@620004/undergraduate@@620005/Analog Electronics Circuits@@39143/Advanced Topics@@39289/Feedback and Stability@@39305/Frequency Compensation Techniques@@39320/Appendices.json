{"hands_on_practices": [{"introduction": "This first practice serves as a crucial starting point. Before we tackle the compensation of complex multi-pole systems, we must first master the behavior of a simple, single-pole amplifier. This exercise reinforces the fundamental concept of the Gain-Bandwidth Product (GBWP), which dictates the inherent trade-off between an amplifier's gain and its bandwidth, a cornerstone principle in circuit design [@problem_id:1305792]. Understanding this relationship is essential for making informed design choices.", "problem": "An electronics engineer is designing a preamplifier circuit for a sensor that produces a low-amplitude, high-frequency signal. The engineer selects an operational amplifier (op-amp) that can be modeled as having a first-order, single-pole frequency response. According to the manufacturer's datasheet, this op-amp has a specified Gain-Bandwidth Product (GBWP) of 10 MHz. The preamplifier is configured as a non-inverting amplifier with a required low-frequency closed-loop voltage gain of 100.\n\nAssuming this closed-loop gain value is constant across the operating passband, calculate the resulting -3dB bandwidth of the final amplifier circuit. Express your answer in kilohertz (kHz).", "solution": "For a single-pole op-amp with open-loop transfer function $A(s) = \\dfrac{A_{0}}{1 + s/\\omega_{p}}$, the unity-gain (transition) frequency is $\\omega_{t} \\approx A_{0}\\omega_{p}$ and $f_{t} = \\dfrac{\\omega_{t}}{2\\pi}$ is the Gain-Bandwidth Product (GBWP).\n\nWith feedback factor $\\beta$ in a non-inverting configuration, the closed-loop transfer function is\n$$\nT(s) = \\frac{A(s)}{1 + \\beta A(s)} = \\frac{A_{0}}{1 + \\beta A_{0} + s/\\omega_{p}}.\n$$\nThis can be written as\n$$\nT(s) = \\frac{\\dfrac{A_{0}}{1 + \\beta A_{0}}}{1 + \\dfrac{s}{\\omega_{p}(1 + \\beta A_{0})}}.\n$$\nHence, the low-frequency closed-loop gain is\n$$\nA_{\\text{cl},0} = \\frac{A_{0}}{1 + \\beta A_{0}} \\approx \\frac{1}{\\beta},\n$$\nand the closed-loop pole (which sets the -3 dB bandwidth for a first-order response) is\n$$\n\\omega_{\\text{cl}} = \\omega_{p}(1 + \\beta A_{0}).\n$$\nThe closed-loop bandwidth $f_{\\text{cl}}$ is found from the constant Gain-Bandwidth Product relationship:\n$$A_{\\text{cl},0} \\times f_{\\text{cl}} = \\text{GBWP}$$\nTherefore,\n$$ f_{\\text{cl}} = \\frac{\\text{GBWP}}{A_{\\text{cl},0}}. $$\nFor a non-inverting amplifier, the noise gain equals the closed-loop gain, so with $A_{\\text{cl},0} = 100$ and $\\text{GBWP} = 10 \\times 10^{6}\\ \\text{Hz}$,\n$$\nf_{-3\\ \\text{dB}} = \\frac{10 \\times 10^{6}}{100} = 1.0 \\times 10^{5}\\ \\text{Hz} = 100\\ \\text{kHz}.\n$$\nTherefore, the -3 dB bandwidth is 100 kHz.", "answer": "$$\\boxed{100}$$", "id": "1305792"}, {"introduction": "Moving beyond the ideal single-pole model, real-world amplifiers often have multiple poles that can lead to instability when feedback is applied. This practice delves into Miller compensation, a powerful and widely used technique to ensure stability by creating a dominant low-frequency pole. You will calculate the required compensation capacitor to achieve a specific phase margin, learning how the interaction between the unity-gain frequency, the non-dominant pole, and the Right-Half-Plane (RHP) zero dictates the amplifier's dynamic performance [@problem_id:1305749].", "problem": "Consider a simplified model of a two-stage Operational Transconductance Amplifier (OTA) designed to function as a unity-gain buffer for a capacitive sensor. The first stage of the OTA has a transconductance $g_{m1}$ and an output resistance $R_{o1}$. The second stage has a transconductance $g_{m2}$ and an output resistance $R_{o2}$. To ensure stable operation, a compensation capacitor, $C_c$, is connected from the output of the first stage to the output of the second stage. The amplifier is driving a total load capacitance $C_L$, which includes the sensor capacitance.\n\nGiven the following device and load parameters:\n- First-stage transconductance, $g_{m1} = 1.20 \\text{ mA/V}$\n- Second-stage transconductance, $g_{m2} = 15.0 \\text{ mA/V}$\n- First-stage output resistance, $R_{o1} = 250 \\text{ k}\\Omega$\n- Second-stage output resistance, $R_{o2} = 50.0 \\text{ k}\\Omega$\n- Load capacitance, $C_L = 12.0 \\text{ pF}$\n\nCalculate the value of the compensation capacitor $C_c$ required to achieve a phase margin of exactly 60 degrees. For your analysis, assume that the effects of pole splitting are dominant and that all other parasitic capacitances within the circuit are negligible. Express your answer in picofarads (pF), rounded to three significant figures.", "solution": "The problem asks for the value of the Miller compensation capacitor $C_c$ that results in a phase margin (PM) of 60 degrees for a two-stage OTA in a unity-gain feedback configuration.\n\nFirst, we identify the key frequency-dependent characteristics of the compensated two-stage OTA. The open-loop transfer function $A(s)$ has a dominant pole $\\omega_{p1}$, a non-dominant pole $\\omega_{p2}$, and a right-half-plane (RHP) zero $\\omega_z$.\n\nThe unity-gain frequency, $\\omega_t$, of the compensated amplifier is determined by the transconductance of the first stage, $g_{m1}$, and the compensation capacitor, $C_c$.\n$$ \\omega_t = \\frac{g_{m1}}{C_c} $$\n\nThe non-dominant pole, $\\omega_{p2}$, is primarily determined by the second stage's transconductance, $g_{m2}$, and the load capacitance, $C_L$. Under the standard pole-splitting approximation, and assuming $C_c$ is not much smaller than $C_L$, its location is approximated as:\n$$ \\omega_{p2} \\approx \\frac{g_{m2}}{C_L} $$\n\nThe compensation capacitor $C_c$ creates a feedforward path from the input to the output of the second stage, which introduces a RHP zero, $\\omega_z$, given by:\n$$ \\omega_z = \\frac{g_{m2}}{C_c} $$\n\nThe phase margin is defined at the unity-gain frequency $\\omega_t$. It is given by $PM = 180^\\circ + \\angle A(j\\omega_t)$, where $\\angle A(j\\omega_t)$ is the phase of the open-loop transfer function at $\\omega = \\omega_t$. The phase is the sum of contributions from the poles and the zero:\n$$ \\angle A(j\\omega_t) = -\\arctan\\left(\\frac{\\omega_t}{\\omega_{p1}}\\right) - \\arctan\\left(\\frac{\\omega_t}{\\omega_{p2}}\\right) - \\arctan\\left(\\frac{\\omega_t}{\\omega_z}\\right) $$\nNote the negative sign for the RHP zero's phase contribution. In a properly compensated op-amp, the dominant pole $\\omega_{p1}$ is placed at a much lower frequency than $\\omega_t$, so $\\omega_t \\gg \\omega_{p1}$. This means the phase contribution from the dominant pole at $\\omega_t$ is approximately $-90^\\circ$.\n$$ \\arctan\\left(\\frac{\\omega_t}{\\omega_{p1}}\\right) \\approx 90^\\circ $$\nSubstituting this into the phase margin equation:\n$$ PM \\approx 180^\\circ - 90^\\circ - \\arctan\\left(\\frac{\\omega_t}{\\omega_{p2}}\\right) - \\arctan\\left(\\frac{\\omega_t}{\\omega_z}\\right) $$\n$$ PM \\approx 90^\\circ - \\arctan\\left(\\frac{\\omega_t}{\\omega_{p2}}\\right) - \\arctan\\left(\\frac{\\omega_t}{\\omega_z}\\right) $$\nWe are given that the desired phase margin is $60^\\circ$.\n$$ 60^\\circ = 90^\\circ - \\arctan\\left(\\frac{\\omega_t}{\\omega_{p2}}\\right) - \\arctan\\left(\\frac{\\omega_t}{\\omega_z}\\right) $$\n$$ \\arctan\\left(\\frac{\\omega_t}{\\omega_{p2}}\\right) + \\arctan\\left(\\frac{\\omega_t}{\\omega_z}\\right) = 30^\\circ $$\nNow we express the ratios $\\omega_t/\\omega_{p2}$ and $\\omega_t/\\omega_z$ in terms of the circuit parameters.\n$$ \\frac{\\omega_t}{\\omega_{p2}} = \\frac{g_{m1}/C_c}{g_{m2}/C_L} = \\frac{g_{m1}C_L}{g_{m2}C_c} $$\n$$ \\frac{\\omega_t}{\\omega_z} = \\frac{g_{m1}/C_c}{g_{m2}/C_c} = \\frac{g_{m1}}{g_{m2}} $$\nSubstituting these into our phase equation:\n$$ \\arctan\\left(\\frac{g_{m1}C_L}{g_{m2}C_c}\\right) + \\arctan\\left(\\frac{g_{m1}}{g_{m2}}\\right) = 30^\\circ $$\nWe can now plug in the given numerical values. First, let's calculate the term involving only the transconductances.\n$$ \\frac{g_{m1}}{g_{m2}} = \\frac{1.20 \\text{ mA/V}}{15.0 \\text{ mA/V}} = 0.0800 $$\nThe phase contribution from the RHP zero is:\n$$ \\arctan(0.0800) \\approx 4.5739^\\circ $$\nNow substitute this back into the phase equation:\n$$ \\arctan\\left(\\frac{g_{m1}C_L}{g_{m2}C_c}\\right) + 4.5739^\\circ = 30^\\circ $$\n$$ \\arctan\\left(\\frac{g_{m1}C_L}{g_{m2}C_c}\\right) = 30^\\circ - 4.5739^\\circ = 25.4261^\\circ $$\nNow we can solve for the argument of the arctan function:\n$$ \\frac{g_{m1}C_L}{g_{m2}C_c} = \\tan(25.4261^\\circ) \\approx 0.47543 $$\nFinally, we solve for $C_c$:\n$$ C_c = \\frac{g_{m1}C_L}{g_{m2} \\times 0.47543} = \\left(\\frac{g_{m1}}{g_{m2}}\\right) \\frac{C_L}{0.47543} $$\nSubstitute the known values:\n$$ C_c = (0.0800) \\frac{12.0 \\text{ pF}}{0.47543} \\approx 2.01935 \\text{ pF} $$\nThe problem asks for the answer to be rounded to three significant figures.\n$$ C_c \\approx 2.02 \\text{ pF} $$\nThe values for $R_{o1}$ and $R_{o2}$ were not needed for this calculation, as they primarily determine the DC gain and the exact location of the dominant pole, which are not directly required when using the relationship between $\\omega_t$, $\\omega_{p2}$, $\\omega_z$ and the phase margin.", "answer": "$$\\boxed{2.02}$$", "id": "1305749"}, {"introduction": "While Miller compensation is highly effective, it introduces an undesirable side effect: a Right-Half-Plane (RHP) zero that can degrade the phase margin and limit performance. This final practice addresses this limitation directly, introducing a practical refinement to the technique. By adding a \"nulling\" resistor in series with the Miller capacitor, you can strategically reposition this zero, even moving it to infinity to completely eliminate its negative impact on stability [@problem_id:1305737]. This is a key skill for optimizing high-performance amplifiers.", "problem": "An engineer is designing a two-stage CMOS operational amplifier. The second stage of the amplifier is modeled as a transconductance stage with a transconductance of $g_{m2}$ and an output resistance of $R_{o2}$. To ensure stability across a wide range of loads, a Miller compensation capacitor, $C_C$, is connected between the input and output nodes of this second stage. A known side-effect of this compensation method is the creation of a zero in the Right-Half Plane (RHP) of the amplifier's transfer function, which can degrade the phase margin.\n\nTo address this, a nulling resistor, $R_z$, is placed in series with the compensation capacitor $C_C$. The value of this resistor can be chosen to alter the position of the zero. Your task is to find the specific value of $R_z$ that moves the RHP zero to an infinite frequency, thereby eliminating its effect on the amplifier's performance.\n\nThe parameters for the second stage are as follows:\n- Transconductance, $g_{m2} = 400 \\text{ } \\mu\\text{A/V}$\n- Output Resistance, $R_{o2} = 150 \\text{ k}\\Omega$\n- Compensation Capacitor, $C_C = 3 \\text{ pF}$\n\nCalculate the required value of the nulling resistor $R_z$. Express your answer in kilo-ohms (k$\\Omega$).", "solution": "The problem asks for the value of a nulling resistor $R_z$ that eliminates the Right-Half Plane (RHP) zero in a two-stage amplifier by moving it to infinity. The zero is introduced by the feedforward path through the Miller compensation network.\n\nLet's analyze the small-signal model of the second stage. Let $v_x$ be the input voltage to the second stage and $v_{out}$ be the output voltage. The second stage consists of a voltage-controlled current source with transconductance $g_{m2}$ and an output resistance $R_{o2}$. The compensation network, comprising capacitor $C_C$ in series with resistor $R_z$, is connected between nodes $v_x$ and $v_{out}$.\n\nThe impedance of the series compensation network in the s-domain is given by:\n$$ Z_C(s) = R_z + \\frac{1}{sC_C} $$\n\nThe transfer function zeros are the frequencies at which the output voltage $v_{out}$ becomes zero for a finite input voltage $v_x$. To find these zeros, we can analyze the currents at the output node. The total current at the output node is the sum of the current from the controlled source ($I_{gm2}$) and the current flowing through the compensation network ($I_C$), plus any current flowing through the output resistance $R_{o2}$ and the load.\nBy applying Kirchhoff's Current Law (KCL) at the output node $v_{out}$, we have:\n$$ g_{m2}v_x + \\frac{v_{out}}{R_{o2}} + I_{load} + \\frac{v_{out} - v_x}{Z_C(s)} = 0 $$\nwhere $I_{load}$ is the current into the load connected to the output.\n\nTo find the zeros of the transfer function $A_v(s) = v_{out}(s)/v_x(s)$, we look for the values of $s$ (denoted $s_z$) for which $v_{out}(s_z) = 0$ while $v_x(s_z) \\neq 0$. Setting $v_{out} = 0$ in the KCL equation simplifies it significantly. Note that when $v_{out}=0$, the current through $R_{o2}$ and the load also becomes zero.\nThe KCL equation becomes:\n$$ g_{m2}v_x + \\frac{0 - v_x}{Z_C(s)} = 0 $$\nSince we are looking for a solution where $v_x \\neq 0$, we can divide the equation by $v_x$:\n$$ g_{m2} - \\frac{1}{Z_C(s)} = 0 $$\nThis equation defines the frequency $s = s_z$ of the zero.\n$$ g_{m2} = \\frac{1}{Z_C(s_z)} $$\nNow, we substitute the expression for $Z_C(s)$:\n$$ g_{m2} = \\frac{1}{R_z + \\frac{1}{s_z C_C}} $$\nWe can now solve for the zero, $s_z$:\n$$ R_z + \\frac{1}{s_z C_C} = \\frac{1}{g_{m2}} $$\n$$ \\frac{1}{s_z C_C} = \\frac{1}{g_{m2}} - R_z $$\n$$ \\frac{1}{s_z C_C} = \\frac{1 - g_{m2}R_z}{g_{m2}} $$\n$$ s_z = \\frac{g_{m2}}{C_C(1 - g_{m2}R_z)} $$\nThis expression gives the location of the zero in the s-plane. The problem requires us to find the value of $R_z$ that moves this zero to an infinite frequency ($s_z \\to \\infty$). For the expression of $s_z$ to approach infinity, its denominator must approach zero.\n$$ 1 - g_{m2}R_z = 0 $$\nSolving for $R_z$ gives the value of the nulling resistor:\n$$ R_z = \\frac{1}{g_{m2}} $$\nNotice that this value depends only on the transconductance of the second stage, $g_{m2}$, and not on $C_C$, $R_{o2}$, or the load.\n\nNow, we can substitute the given numerical value for $g_{m2}$:\n$$ g_{m2} = 400 \\text{ } \\mu\\text{A/V} = 400 \\times 10^{-6} \\text{ S} $$\n$$ R_z = \\frac{1}{400 \\times 10^{-6} \\text{ S}} = \\frac{1}{0.0004} \\text{ }\\Omega = 2500 \\text{ }\\Omega $$\nThe problem asks for the answer in kilo-ohms (k$\\Omega$).\n$$ R_z = 2500 \\text{ }\\Omega = 2.5 \\text{ k}\\Omega $$", "answer": "$$\\boxed{2.5}$$", "id": "1305737"}]}