{"hands_on_practices": [{"introduction": "To begin our exploration of the Bessel filter's time-domain characteristics, we start with a fundamental building block of analog circuits: the first-order Resistor-Capacitor ($RC$) low-pass filter. This simple circuit provides an excellent tangible model for understanding group delay, a measure of how much different frequency components of a signal are delayed. By calculating the group delay for this basic filter at Direct Current (DC), or $\\omega=0$, you will build an intuition for how a filter's component values directly influence its signal-delay properties, a concept central to the design of more advanced Bessel filters [@problem_id:1282699].", "problem": "In audio and data transmission systems, it is often critical to minimize signal distortion. One type of distortion, known as phase distortion, occurs when different frequency components of a signal are delayed by different amounts of time as they pass through a filter. The group delay, a measure of this time delay as a function of frequency, should ideally be constant across the signal's bandwidth.\n\nA simple first-order low-pass filter, which approximates the behavior of an ideal Bessel filter at low frequencies, is constructed using a resistor and a capacitor. The input voltage is applied across a series combination of a resistor with resistance $R$ and a capacitor with capacitance $C$. The filtered output voltage is taken across the capacitor.\n\nGiven a resistor with $R = 1.5 \\text{ k}\\Omega$ and a capacitor with $C = 0.10 \\mu\\text{F}$, calculate the group delay of this filter for very low frequencies, i.e., at a frequency of 0 Hz.\n\nExpress your final answer in milliseconds (ms). Round your answer to two significant figures.", "solution": "For a series $RC$ low-pass filter with output taken across the capacitor, the transfer function is obtained using the impedance of the capacitor $Z_{C} = \\frac{1}{j\\omega C}$:\n$$\nH(j\\omega) \\equiv \\frac{V_{\\text{out}}}{V_{\\text{in}}} = \\frac{Z_{C}}{R + Z_{C}} = \\frac{\\frac{1}{j\\omega C}}{R + \\frac{1}{j\\omega C}} = \\frac{1}{1 + j\\omega RC}.\n$$\nThe phase of $H(j\\omega)$ is\n$$\n\\phi(\\omega) = -\\arctan(\\omega RC).\n$$\nThe group delay is defined as\n$$\n\\tau_{g}(\\omega) = -\\frac{d\\phi(\\omega)}{d\\omega}.\n$$\nDifferentiating $\\phi(\\omega)$ gives\n$$\n\\frac{d\\phi}{d\\omega} = -\\frac{RC}{1 + (\\omega RC)^{2}},\n$$\nso\n$$\n\\tau_{g}(\\omega) = \\frac{RC}{1 + (\\omega RC)^{2}}.\n$$\nAt $\\omega = 0$, the group delay is\n$$\n\\tau_{g}(0) = RC.\n$$\nWith $R = 1.5 \\times 10^{3}\\ \\Omega$ and $C = 0.10 \\times 10^{-6}\\ \\text{F}$,\n$$\nRC = \\left(1.5 \\times 10^{3}\\right)\\left(0.10 \\times 10^{-6}\\right)\\ \\text{s} = 1.5 \\times 10^{-4}\\ \\text{s}.\n$$\nConverting to milliseconds,\n$$\n1.5 \\times 10^{-4}\\ \\text{s} = 0.15\\ \\text{ms}.\n$$\nRounded to two significant figures, the group delay at $0$ Hz is $0.15$ ms.", "answer": "$$\\boxed{0.15}$$", "id": "1282699"}, {"introduction": "Having established the concept of group delay with a simple $RC$ circuit, we now move to a true second-order Bessel filter. Unlike the first-order approximation, a Bessel filter is specifically defined by the coefficients of its transfer function, which are mathematically optimized to create a maximally flat group delay. This practice problem [@problem_id:1282712] challenges you to calculate the group delay at DC for a second-order Bessel filter, directly connecting the abstract coefficients of the transfer function to the filter's hallmark time-domain performance.", "problem": "An analog filter is being designed for a high-fidelity audio system to remove high-frequency noise without distorting the phase of the audio signals in the passband. The chosen topology is a second-order low-pass Bessel filter, known for its maximally flat group delay characteristic. The filter's voltage transfer function, $H(s) = \\frac{V_{out}(s)}{V_{in}(s)}$, is given by:\n$$H(s) = \\frac{A}{s^2 + B s + C}$$\nFor this particular design, the coefficients have been determined to be $B = 1.20 \\times 10^4 \\text{ s}^{-1}$ and $C = 4.80 \\times 10^7 \\text{ s}^{-2}$. The constant $A$ is chosen such that the filter has a DC gain of unity.\n\nCalculate the group delay of this filter at an angular frequency of $\\omega=0$ rad/s.\n\nExpress your answer in microseconds (Âµs), rounded to three significant figures.", "solution": "The group delay is defined as $\\tau_{g}(\\omega)=-\\frac{d}{d\\omega}\\arg H(j\\omega)$. For $H(s)=\\frac{A}{s^{2}+Bs+C}$ with unity DC gain, we require $H(0)=1$, which gives $\\frac{A}{C}=1$ and hence $A=C$. Therefore,\n$$\nH(j\\omega)=\\frac{C}{C-\\omega^{2}+jB\\omega}.\n$$\nLet the denominator be $D(j\\omega)=x(\\omega)+j y(\\omega)$ with $x(\\omega)=C-\\omega^{2}$ and $y(\\omega)=B\\omega$. Then $\\arg H(j\\omega)=-\\arg D(j\\omega)$, so\n$$\n\\tau_{g}(\\omega)=-\\frac{d}{d\\omega}\\arg H(j\\omega)=\\frac{d}{d\\omega}\\arg D(j\\omega).\n$$\nUsing the derivative of the argument of a complex function, \n$$\n\\frac{d}{d\\omega}\\arg D(j\\omega)=\\frac{x(\\omega)\\,y'(\\omega)-y(\\omega)\\,x'(\\omega)}{x(\\omega)^{2}+y(\\omega)^{2}},\n$$\nwith $x'(\\omega)=-2\\omega$ and $y'(\\omega)=B$, we obtain\n$$\n\\tau_{g}(\\omega)=\\frac{(C-\\omega^{2})B-(B\\omega)(-2\\omega)}{(C-\\omega^{2})^{2}+(B\\omega)^{2}}=\\frac{B\\,(C+\\omega^{2})}{(C-\\omega^{2})^{2}+(B\\omega)^{2}}.\n$$\nAt $\\omega=0$,\n$$\n\\tau_{g}(0)=\\frac{B\\,C}{C^{2}}=\\frac{B}{C}.\n$$\nSubstituting the given values $B=1.20\\times 10^{4}\\ \\text{s}^{-1}$ and $C=4.80\\times 10^{7}\\ \\text{s}^{-2}$,\n$$\n\\tau_{g}(0)=\\frac{1.20\\times 10^{4}}{4.80\\times 10^{7}}\\ \\text{s}=2.50\\times 10^{-4}\\ \\text{s}.\n$$\nConverting to microseconds (where $1\\ \\text{microsecond}=10^{-6}\\ \\text{s}$) gives\n$$\n\\tau_{g}(0)=2.50\\times 10^{2}\\ \\text{microseconds}.\n$$\nRounded to three significant figures, the value in microseconds is $2.50\\times 10^{2}$.", "answer": "$$\\boxed{2.50 \\times 10^{2}}$$", "id": "1282712"}, {"introduction": "This final practice elevates our analysis from calculation to design, tackling a common engineering problem: phase and delay compensation. While a Butterworth filter is prized for its maximally flat magnitude response in the passband, its phase response is non-linear, leading to signal distortion. This advanced exercise [@problem_id:1282705] explores a powerful technique called delay equalization, where an all-pass filter is cascaded with a Butterworth filter. Your task is to design the all-pass equalizer to make the combined system's group delay maximally flat, effectively mimicking the superior time-domain performance of a higher-order Bessel filter.", "problem": "In high-frequency communication systems, maintaining signal integrity requires that all frequency components of a signal experience the same time delay. This property is characterized by a flat group delay. A common technique to achieve this is to use a delay equalizer to compensate for the non-constant group delay of other filters in the signal path.\n\nConsider a normalized second-order Butterworth low-pass filter (LPF) with the transfer function:\n$$ H_{LPF}(s) = \\frac{1}{s^2 + \\sqrt{2}s + 1} $$\nTo improve its phase response, this filter is placed in series (cascaded) with a second-order all-pass equalizer (APE) whose transfer function is given by:\n$$ H_{APE}(s) = \\frac{s^2 - as + b}{s^2 + as + b} $$\nwhere $a$ and $b$ are positive real constants to be determined. The denominator of the APE, $s^2 + as + b$, can be related to the standard second-order form $s^2 + \\frac{\\omega_0}{Q}s + \\omega_0^2$, where $\\omega_0$ is the undamped natural frequency and $Q$ is the quality factor.\n\nThe design objective is to choose $a$ and $b$ such that the group delay of the total cascaded system, $H_{Total}(s) = H_{LPF}(s) \\cdot H_{APE}(s)$, is maximally flat at a frequency of $\\omega=0$. This condition makes the overall response approximate that of a fourth-order Bessel filter near DC.\n\nTo constrain the design, the quality factor of the all-pass equalizer's poles is specified to be $Q = \\frac{1}{2}$.\n\nDetermine the required values for the parameters $a$ and $b$. Present your final answer as an ordered pair $(a, b)$.", "solution": "The total group delay of a cascade equals the sum of the group delays of the factors. Let $H_{Total}(s)=H_{LPF}(s)H_{APE}(s)$ and let $\\tau(\\omega)$ denote group delay at frequency $\\omega$, so\n$$\n\\tau_{Total}(\\omega)=\\tau_{LPF}(\\omega)+\\tau_{APE}(\\omega).\n$$\nFor a second-order denominator $D(s)=s^{2}+a_{1}s+a_{0}$, we have $D(j\\omega)=X(\\omega)+jY(\\omega)$ with $X(\\omega)=a_{0}-\\omega^{2}$ and $Y(\\omega)=a_{1}\\omega$. The phase of $D(j\\omega)$ is $\\arg D(j\\omega)$ and\n$$\n\\frac{d}{d\\omega}\\arg D(j\\omega)=\\frac{X(\\omega)Y'(\\omega)-Y(\\omega)X'(\\omega)}{X(\\omega)^{2}+Y(\\omega)^{2}}=\\frac{a_{1}\\big(a_{0}+\\omega^{2}\\big)}{(a_{0}-\\omega^{2})^{2}+(a_{1}\\omega)^{2}}.\n$$\nFor the LPF $H_{LPF}(s)=1/(s^{2}+\\sqrt{2}\\,s+1)$, the phase is $-\\arg D_{L}(j\\omega)$ with $D_{L}(s)=s^{2}+\\sqrt{2}\\,s+1$, hence\n$$\n\\tau_{LPF}(\\omega)=\\frac{d}{d\\omega}\\arg D_{L}(j\\omega)=\\frac{\\sqrt{2}\\,(1+\\omega^{2})}{(1-\\omega^{2})^{2}+2\\omega^{2}}=\\frac{\\sqrt{2}\\,(1+\\omega^{2})}{1+\\omega^{4}}.\n$$\nIts Maclaurin expansion to order $\\omega^{2}$ is\n$$\n\\tau_{LPF}(\\omega)=\\sqrt{2}+\\sqrt{2}\\,\\omega^{2}+O(\\omega^{4}).\n$$\nFor the all-pass equalizer $H_{APE}(s)=(s^{2}-as+b)/(s^{2}+as+b)$, note that the numerator equals $D_{A}(-s)$ where $D_{A}(s)=s^{2}+as+b$. Thus\n$$\n\\arg H_{APE}(j\\omega)=\\arg D_{A}(-j\\omega)-\\arg D_{A}(j\\omega)=-2\\,\\arg D_{A}(j\\omega),\n$$\nand therefore\n$$\n\\tau_{APE}(\\omega)=-\\frac{d}{d\\omega}\\arg H_{APE}(j\\omega)=2\\,\\frac{d}{d\\omega}\\arg D_{A}(j\\omega)=\\frac{2a\\,(b+\\omega^{2})}{(b-\\omega^{2})^{2}+(a\\omega)^{2}}.\n$$\nExpand $\\tau_{APE}(\\omega)$ near $\\omega=0$. Write the denominator as $b^{2}+(a^{2}-2b)\\omega^{2}+O(\\omega^{4})$ and invert:\n$$\n\\frac{1}{(b-\\omega^{2})^{2}+(a\\omega)^{2}}=\\frac{1}{b^{2}}\\left[1-\\frac{a^{2}-2b}{b^{2}}\\omega^{2}+O(\\omega^{4})\\right].\n$$\nThus\n$$\n\\tau_{APE}(\\omega)=\\frac{2a}{b^{2}}(b+\\omega^{2})\\left[1-\\frac{a^{2}-2b}{b^{2}}\\omega^{2}+O(\\omega^{4})\\right]\n=\\frac{2a}{b}+\\frac{2a(3b-a^{2})}{b^{3}}\\omega^{2}+O(\\omega^{4}).\n$$\nHence the total group delay expansion is\n$$\n\\tau_{Total}(\\omega)=\\left(\\sqrt{2}+\\frac{2a}{b}\\right)+\\left(\\sqrt{2}+\\frac{2a(3b-a^{2})}{b^{3}}\\right)\\omega^{2}+O(\\omega^{4}).\n$$\nMaximally flat group delay at $\\omega=0$ imposes that the first nontrivial curvature term vanish, i.e.,\n$$\n\\sqrt{2}+\\frac{2a(3b-a^{2})}{b^{3}}=0.\n$$\nThe APE denominator is compared with the standard form $s^{2}+(\\omega_{0}/Q)s+\\omega_{0}^{2}$, giving $a=\\omega_{0}/Q$ and $b=\\omega_{0}^{2}$. With the specified $Q=\\frac{1}{2}$, this yields\n$$\nb=a^{2}Q^{2}=\\frac{a^{2}}{4}.\n$$\nSubstitute $b=\\frac{a^{2}}{4}$ into the flatness condition. Compute $3b-a^{2}=\\frac{3a^{2}}{4}-a^{2}=-\\frac{a^{2}}{4}$ and $b^{3}=\\frac{a^{6}}{64}$, hence\n$$\n\\sqrt{2}+\\frac{2a(3b-a^{2})}{b^{3}}=\\sqrt{2}+2a\\cdot\\frac{-a^{2}/4}{a^{6}/64}\n=\\sqrt{2}-\\frac{32}{a^{3}}=0.\n$$\nTherefore $a^{3}=16\\sqrt{2}$, and\n$$\na=(16\\sqrt{2})^{1/3}=2^{3/2}=2\\sqrt{2},\\qquad b=\\frac{a^{2}}{4}=2.\n$$\nThese values satisfy the specified $Q=\\frac{1}{2}$ and make the total group delay maximally flat at $\\omega=0$ to second order, yielding a near-DC behavior akin to a fourth-order Bessel response.", "answer": "$$\\boxed{\\begin{pmatrix}2\\sqrt{2} & 2\\end{pmatrix}}$$", "id": "1282705"}]}