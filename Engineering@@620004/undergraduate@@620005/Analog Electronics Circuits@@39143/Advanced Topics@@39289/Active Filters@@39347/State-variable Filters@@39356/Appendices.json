{"hands_on_practices": [{"introduction": "Mastering filter theory involves not only designing for stability but also understanding the very edge of instability. This practice explores a fascinating application where a state-variable filter is purposefully configured to oscillate. By analyzing the feedback loop, you will determine the precise conditions under which the system's poles land on the imaginary axis, transforming the filter into a stable sinusoidal oscillator [@problem_id:1334688].", "problem": "An analog circuit intended to function as a stable sinusoidal generator is constructed using a state-variable topology with three ideal operational amplifiers (op-amps). The circuit consists of two identical inverting integrator stages and one inverting summing amplifier stage, connected in a closed loop.\n\nThe configuration is as follows:\n- The output of the summing amplifier is denoted as $V_1$.\n- The first integrator, with input $V_1$, produces an output $V_2$.\n- The second integrator, with input $V_2$, produces an output $V_3$.\n- The outputs $V_2$ and $V_3$ are both fed back as inputs to the summing amplifier to generate $V_1$ and close the loop.\n\nComponent details:\n- Each inverting integrator is constructed using an input resistor $R$ and a feedback capacitor $C$.\n- The inverting summing amplifier is constructed with the following connections to its inverting input terminal: the signal $V_2$ is fed through a resistor $R_Q$, and the signal $V_3$ is fed through a resistor $R_F$. The feedback resistor for this summing amplifier is also $R_F$.\n\nThe circuit is tuned to produce a sustained, stable sinusoidal oscillation by adjusting the value of the resistor $R_Q$. When this condition is met, the poles of the system's characteristic equation lie exactly on the imaginary axis of the complex s-plane.\n\nDetermine the angular frequency, $\\omega$, of this sustained oscillation. Express your answer as a symbolic expression in terms of $R$, $C$, and $R_F$.", "solution": "We model each block using ideal op-amp relations in the Laplace domain. For an inverting integrator with input resistor $R$ and feedback capacitor $C$, the transfer function is $V_{\\text{out}}(s) = -\\frac{1}{RCs} V_{\\text{in}}(s)$. Applying this to the cascaded integrators yields\n$$\nV_{2}(s) = -\\frac{1}{RCs} V_{1}(s), \\quad V_{3}(s) = -\\frac{1}{RCs} V_{2}(s) = \\frac{1}{(RCs)^{2}} V_{1}(s).\n$$\nThe inverting summing amplifier with feedback resistor $R_{F}$, input $V_{2}$ through $R_{Q}$, and input $V_{3}$ through $R_{F}$ gives\n$$\nV_{1}(s) = -\\frac{R_{F}}{R_{Q}} V_{2}(s) - \\frac{R_{F}}{R_{F}} V_{3}(s) = -\\frac{R_{F}}{R_{Q}} V_{2}(s) - V_{3}(s).\n$$\nSubstituting $V_{2}(s)$ and $V_{3}(s)$ in terms of $V_{1}(s)$,\n$$\nV_{1}(s) = -\\frac{R_{F}}{R_{Q}}\\left(-\\frac{1}{RCs} V_{1}(s)\\right) - \\frac{1}{(RCs)^{2}} V_{1}(s),\n$$\nwhich simplifies (dividing by $V_{1}(s)$ and multiplying both sides by $(RCs)^{2}$) to the characteristic equation\n$$\n(RC)^{2} s^{2} - \\frac{R_{F}}{R_{Q}} (RC) s + 1 = 0,\n$$\nor equivalently\n$$\ns^{2} - \\frac{R_{F}}{R_{Q} RC} s + \\frac{1}{(RC)^{2}} = 0.\n$$\nFor sustained sinusoidal oscillation, the poles lie on the imaginary axis, which for a second-order polynomial requires the $s$-term coefficient to be zero. Thus the tuning condition is $\\frac{R_{F}}{R_{Q} RC} = 0$, corresponding to idealized $R_{Q} \\to \\infty$. Under this condition, the characteristic equation reduces to\n$$\ns^{2} + \\frac{1}{(RC)^{2}} = 0,\n$$\nwhose roots are $s = \\pm \\mathrm{j} \\frac{1}{RC}$. Therefore, the angular frequency of sustained oscillation is\n$$\n\\omega = \\frac{1}{RC}.\n$$\nThis result is independent of $R_{F}$ and $R_{Q}$ at the oscillation condition.", "answer": "$$\\boxed{\\frac{1}{RC}}$$", "id": "1334688"}, {"introduction": "One of the key advantages of the state-variable architecture is its ability to provide multiple, simultaneous filter responses. This exercise prompts you to analyze the internal workings of the filter when it operates at its designated center frequency. You will calculate the relative peak voltages at the high-pass, band-pass, and low-pass outputs, a crucial step in practical design to ensure that no internal stage of the circuit is overdriven into saturation [@problem_id:1334697].", "problem": "An analog filter circuit is implemented using three ideal operational amplifiers (op-amps), designated OA1, OA2, and OA3, along with several resistors and capacitors. The configuration forms a state-variable filter. The roles of the op-amps are as follows:\n\n- OA2 is configured as an inverting integrator. Its input is the output of OA1, denoted as $V_1$. The integrator is constructed using an input resistor $R_2$ and a feedback capacitor $C_2$. The output of OA2 is denoted as $V_2$.\n- OA3 is also configured as an inverting integrator. Its input is the output of OA2, $V_2$. This integrator is constructed using an input resistor $R_3$ and a feedback capacitor $C_3$. The output of OA3 is denoted as $V_3$.\n- OA1 is a summing amplifier that provides the necessary feedback to close the loop and also accepts the external input signal $V_{in}$. Its specific configuration establishes the filter's overall characteristics. It is designed such that $V_1$ serves as the high-pass (HP) output, $V_2$ serves as the band-pass (BP) output, and $V_3$ serves as the low-pass (LP) output.\n\nThe component values for the two integrator stages are given as:\n- $R_2 = 10.0\\ \\text{k}\\Omega$\n- $C_2 = 10.0\\ \\text{nF}$\n- $R_3 = 25.0\\ \\text{k}\\Omega$\n- $C_3 = 10.0\\ \\text{nF}$\n\nThe filter is driven by a sinusoidal input signal, $V_{in}(t)$, whose frequency is precisely tuned to the filter's center frequency, $\\omega_0$. At this specific input frequency, the peak amplitudes of the output voltages from the three op-amps are measured to be $V_{p1}$, $V_{p2}$, and $V_{p3}$, corresponding to OA1, OA2, and OA3, respectively.\n\nCalculate the ratio of the maximum peak output voltage to the minimum peak output voltage observed among the three op-amps, that is, $\\frac{\\max(V_{p1}, V_{p2}, V_{p3})}{\\min(V_{p1}, V_{p2}, V_{p3})}$. Round your final answer to three significant figures.", "solution": "Let the Laplace variable be $s$ and consider ideal inverting integrators:\n- OA2 (from $V_{1}$ to $V_{2}$): $V_{2}(s) = -\\dfrac{1}{s R_{2} C_{2}}\\,V_{1}(s)$.\n- OA3 (from $V_{2}$ to $V_{3}$): $V_{3}(s) = -\\dfrac{1}{s R_{3} C_{3}}\\,V_{2}(s)$.\n\nCascading the two relations gives the fixed internal ratios among the three outputs:\n$$\nV_{2}(s) = -\\frac{1}{s R_{2} C_{2}}\\,V_{1}(s),\\qquad\nV_{3}(s) = \\frac{1}{s^{2} R_{2} C_{2} R_{3} C_{3}}\\,V_{1}(s).\n$$\n\nFor a canonical state-variable filter, the natural (center) frequency is set by the integrator constants as\n$$\n\\omega_{0} = \\sqrt{\\frac{1}{R_{2} C_{2} R_{3} C_{3}}}.\n$$\n\nAt sinusoidal steady state with $s=\\mathrm{j}\\omega$, the magnitude relations at $\\omega=\\omega_{0}$ follow directly from the above internal ratios:\n$$\n\\left|\\frac{V_{2}}{V_{1}}\\right|_{\\omega=\\omega_{0}} = \\frac{1}{\\omega_{0} R_{2} C_{2}}\n= \\sqrt{\\frac{R_{3} C_{3}}{R_{2} C_{2}}},\\qquad\n\\left|\\frac{V_{3}}{V_{1}}\\right|_{\\omega=\\omega_{0}} = \\frac{1}{\\omega_{0}^{2} R_{2} C_{2} R_{3} C_{3}} = 1.\n$$\n\nThus, at $\\omega=\\omega_{0}$, the peak amplitudes satisfy\n$$\nV_{p3} = V_{p1},\\qquad V_{p2} = \\sqrt{\\frac{R_{3} C_{3}}{R_{2} C_{2}}}\\,V_{p1}.\n$$\n\nTherefore,\n$$\n\\frac{\\max(V_{p1}, V_{p2}, V_{p3})}{\\min(V_{p1}, V_{p2}, V_{p3})}\n= \\max\\!\\left(1,\\sqrt{\\frac{R_{3} C_{3}}{R_{2} C_{2}}}\\right).\n$$\n\nWith the given values $R_{2}=10.0\\,\\text{k}\\Omega$, $C_{2}=10.0\\,\\text{nF}$, $R_{3}=25.0\\,\\text{k}\\Omega$, $C_{3}=10.0\\,\\text{nF}$,\n$$\n\\frac{R_{3} C_{3}}{R_{2} C_{2}} = \\frac{25.0\\times 10.0}{10.0\\times 10.0} = 2.5,\n$$\nso\n$$\n\\frac{\\max(V_{p1}, V_{p2}, V_{p3})}{\\min(V_{p1}, V_{p2}, V_{p3})}\n= \\sqrt{2.5} \\approx 1.58\\quad\\text{(to three significant figures).}\n$$", "answer": "$$\\boxed{1.58}$$", "id": "1334697"}, {"introduction": "A filter's performance is not just defined by its frequency response but also by its behavior over time when faced with sudden input signals. This problem shifts our focus from the frequency domain to the time domain by analyzing the filter's unit step response. By solving the system's differential equations, you will see exactly how the parameters $\\omega_0$ and $Q$ shape the transient characteristics, such as overshoot and ringing, of the low-pass output [@problem_id:1334679].", "problem": "A particular second-order state-variable filter is used to process an input voltage signal $v_{in}(t)$. Its internal dynamics can be precisely described by a state-space model with two state variables, $x_1(t)$ and $x_2(t)$. The output low-pass filtered voltage is given by $v_{LP}(t) = x_1(t)$. The system is governed by the following set of coupled linear differential equations:\n$$ \\frac{dx_1}{dt} = x_2(t) $$\n$$ \\frac{dx_2}{dt} = -\\omega_0^2 x_1(t) - \\frac{\\omega_0}{Q} x_2(t) + \\omega_0^2 v_{in}(t) $$\nThe filter is characterized by a natural frequency $\\omega_0 = 100\\sqrt{2}$ rad/s and a quality factor $Q = 1/\\sqrt{3}$.\nThe filter is initially at rest, meaning $x_1(0) = 0$ and $x_2(0)=0$. At time $t=0$, a unit step voltage is applied to the input, such that $v_{in}(t) = 1$ V for all $t \\ge 0$.\n\nDetermine the expression for the low-pass output voltage $v_{LP}(t)$ for $t \\ge 0$. Your answer should be a single real-valued analytic function of time $t$.", "solution": "The given state equations are\n$$\\frac{dx_{1}}{dt}=x_{2}(t), \\qquad \\frac{dx_{2}}{dt}=-\\omega_{0}^{2} x_{1}(t)-\\frac{\\omega_{0}}{Q} x_{2}(t)+\\omega_{0}^{2} v_{in}(t),$$\nwith $v_{in}(t)=1$ for $t\\ge 0$, and initial conditions $x_{1}(0)=0$, $x_{2}(0)=0$. Eliminating $x_{2}$ by differentiating the first equation and substituting into the second gives a single second-order ODE for $x_{1}(t)$:\n$$\\frac{d^2 x_1}{dt^2}=-\\omega_{0}^{2} x_{1}-\\frac{\\omega_{0}}{Q}\\frac{dx_1}{dt}+\\omega_{0}^{2}.$$\nRewriting,\n$$\\frac{d^2 x_1}{dt^2}+\\frac{\\omega_{0}}{Q}\\frac{dx_1}{dt}+\\omega_{0}^{2} x_{1}=\\omega_{0}^{2},$$\nwith $x_{1}(0)=0$ and $\\frac{dx_1}{dt}(0)=x_{2}(0)=0$. A constant particular solution is $x_{1,p}=1$. The homogeneous equation\n$$\\frac{d^2 x_h}{dt^2}+\\frac{\\omega_{0}}{Q}\\frac{dx_h}{dt}+\\omega_{0}^{2} x_{h}=0$$\nhas characteristic roots\n$$r=-\\frac{\\omega_{0}}{2Q}\\pm \\mathrm{j}\\,\\omega_{d}, \\quad \\omega_{d}=\\omega_{0}\\sqrt{1-\\frac{1}{4Q^{2}}}.$$\nThus\n$$x_{h}(t)=\\exp\\!\\left(-\\frac{\\omega_{0}}{2Q}t\\right)\\left(C\\cos(\\omega_{d} t)+D\\sin(\\omega_{d} t)\\right).$$\nImposing $x_{1}(0)=0$ yields $1+x_{h}(0)=0$, so $C=-1$. Differentiating,\n$$\\frac{d x_{h}}{dt}=\\exp\\!\\left(-\\frac{\\omega_{0}}{2Q}t\\right)\\left[-\\frac{\\omega_{0}}{2Q}C\\cos(\\omega_{d} t)-\\frac{\\omega_{0}}{2Q}D\\sin(\\omega_{d} t)-\\omega_{d}C\\sin(\\omega_{d} t)+\\omega_{d}D\\cos(\\omega_{d} t)\\right],$$\nand using $\\frac{dx_1}{dt}(0)=0$ gives $\\frac{dx_h}{dt}(0)=0$, hence\n$$-\\frac{\\omega_{0}}{2Q}C+\\omega_{d}D=0 \\;\\Rightarrow\\; D=-\\frac{\\omega_{0}}{2Q\\,\\omega_{d}}.$$\nTherefore,\n$$x_{1}(t)=1-\\exp\\!\\left(-\\frac{\\omega_{0}}{2Q}t\\right)\\left[\\cos(\\omega_{d} t)+\\frac{\\omega_{0}}{2Q\\,\\omega_{d}}\\sin(\\omega_{d} t)\\right].$$\nWith the given parameters $\\omega_{0}=100\\sqrt{2}$ and $Q=1/\\sqrt{3}$, we have\n$$\\frac{\\omega_{0}}{2Q}=50\\sqrt{6}, \\qquad \\omega_{d}=\\omega_{0}\\sqrt{1-\\frac{1}{4Q^{2}}}=50\\sqrt{2}, \\qquad \\frac{\\omega_{0}}{2Q\\,\\omega_{d}}=\\sqrt{3}.$$\nThus the low-pass output $v_{LP}(t)=x_{1}(t)$ for $t\\ge 0$ is\n$$v_{LP}(t)=1-\\exp\\!\\left(-50\\sqrt{6}\\,t\\right)\\left[\\cos\\!\\left(50\\sqrt{2}\\,t\\right)+\\sqrt{3}\\,\\sin\\!\\left(50\\sqrt{2}\\,t\\right)\\right].$$\nThis satisfies $v_{LP}(0)=0$, $\\frac{dv_{LP}}{dt}(0)=0$, and $\\lim_{t\\to\\infty}v_{\\text{LP}}(t)=1$, as required for a unit-step response of a unity-gain low-pass filter.", "answer": "$$\\boxed{1-\\exp\\!\\left(-50\\sqrt{6}\\,t\\right)\\left[\\cos\\!\\left(50\\sqrt{2}\\,t\\right)+\\sqrt{3}\\,\\sin\\!\\left(50\\sqrt{2}\\,t\\right)\\right]}$$", "id": "1334679"}]}