{"hands_on_practices": [{"introduction": "The foundation of any current mirror lies in establishing a stable and predictable reference current. This first practice puts you in the designer's seat, tackling the essential task of selecting a component to set this reference. You will determine the value of a reference resistor, $R_{REF}$, needed to generate a target current, applying the fundamental square-law model for a MOSFET in saturation and basic circuit laws.[@problem_id:1317765]", "problem": "An analog circuit designer is tasked with creating a stable current source to drive a high-efficiency blue Light Emitting Diode (LED). The design employs a simple current mirror composed of two identical n-channel Metal-Oxide-Semiconductor Field-Effect Transistors (MOSFETs), denoted as M1 and M2. The entire circuit is powered by a single supply voltage $V_{DD}$.\n\nIn this configuration, the reference transistor M1 is \"diode-connected,\" meaning its gate and drain terminals are tied together. A reference resistor, $R_{REF}$, is connected between the supply voltage $V_{DD}$ and the interconnected drain and gate of M1. This arrangement establishes a reference current $I_{REF}$. The second transistor, M2, has its gate connected to the gate of M1 and its source connected to ground, mirroring the reference current to an output current $I_{OUT}$ that drives the LED.\n\nAssume the two MOSFETs are perfectly matched and operate in the saturation region. The effect of channel-length modulation can be considered negligible ($\\lambda = 0$).\n\nGiven the following parameters:\n- Supply Voltage, $V_{DD} = 3.3~\\text{V}$\n- Target Reference Current, $I_{REF} = 150~\\mu\\text{A}$\n- Process Transconductance Parameter, $k'_{n} = 100~\\mu\\text{A/V}^2$\n- Transistor Aspect Ratio, $W/L = 10$\n- Threshold Voltage, $V_{tn} = 0.7~\\text{V}$\n\nCalculate the required value of the reference resistor $R_{REF}$ to establish the target reference current. Express your answer in kilo-ohms (k$\\Omega$) and round to three significant figures.", "solution": "For a diode-connected NMOS operating in saturation with negligible channel-length modulation, the reference current is given by the square-law relation\n$$\nI_{REF}=\\frac{1}{2}k'_{n}\\left(\\frac{W}{L}\\right)\\left(V_{GS}-V_{tn}\\right)^{2}.\n$$\nSolving for the gate-source voltage,\n$$\nV_{GS}=V_{tn}+\\sqrt{\\frac{2I_{REF}}{k'_{n}\\left(\\frac{W}{L}\\right)}}.\n$$\nThe resistor $R_{REF}$ drops the difference between the supply and the gate/drain node, so by Ohm's law,\n$$\nI_{REF}=\\frac{V_{DD}-V_{GS}}{R_{REF}}\\quad\\Rightarrow\\quad R_{REF}=\\frac{V_{DD}-V_{GS}}{I_{REF}}.\n$$\nSubstituting the expression for $V_{GS}$,\n$$\nR_{REF}=\\frac{V_{DD}-V_{tn}-\\sqrt{\\frac{2I_{REF}}{k'_{n}\\left(\\frac{W}{L}\\right)}}}{I_{REF}}.\n$$\nNow substitute the given numerical values in SI units: $V_{DD}=3.3$, $V_{tn}=0.7$, $I_{REF}=1.5\\times 10^{-4}$, $k'_{n}=1.0\\times 10^{-4}$, and $\\frac{W}{L}=10$. First compute the overdrive term:\n$$\n\\sqrt{\\frac{2I_{REF}}{k'_{n}\\left(\\frac{W}{L}\\right)}}=\\sqrt{\\frac{2\\left(1.5\\times 10^{-4}\\right)}{\\left(1.0\\times 10^{-4}\\right)\\left(10\\right)}}=\\sqrt{0.3}\\approx 0.547722558.\n$$\nThus,\n$$\nV_{GS}=0.7+0.547722558\\approx 1.247722558,\n$$\nand\n$$\nR_{REF}=\\frac{3.3-1.247722558}{1.5\\times 10^{-4}}\\approx \\frac{2.052277442}{1.5\\times 10^{-4}}\\approx 1.36818496\\times 10^{4}\\ \\text{ohms}.\n$$\nExpressed in kilo-ohms and rounded to three significant figures,\n$$\nR_{REF}\\approx 13.7\\ \\text{k}\\Omega.\n$$\nThis design also satisfies the saturation condition for the diode-connected device since $V_{DS}=V_{GS}>V_{GS}-V_{tn}$ by construction.", "answer": "$$\\boxed{13.7}$$", "id": "1317765"}, {"introduction": "While a 1:1 current copy is useful, many applications require scaling the reference current up or down. This exercise demonstrates how to achieve a specific current ratio by adjusting transistor geometries, a core technique in analog IC design. We will also move beyond the ideal model to consider channel-length modulation, a key non-ideality that affects a mirror's precision and introduces a dependency on output voltage.[@problem_id:1317760]", "problem": "An analog circuit designer is implementing a basic current mirror using two N-channel Metal-Oxide-Semiconductor (NMOS) transistors, $M_1$ and $M_2$, fabricated with the same process. In the mirror configuration, $M_1$ is diode-connected (its gate and drain are tied together) and is supplied by a reference current $I_{REF}$. The gate terminals of both $M_1$ and $M_2$ are connected to the same node, and their sources are both connected to ground. The current flowing through the drain of $M_2$ is the output current, $I_{OUT}$.\n\nThe design specifications and process parameters are as follows:\n- Reference current, $I_{REF} = 100~\\mu\\text{A}$\n- Process transconductance parameter, $\\mu_n C_{ox} = 200~\\mu\\text{A}/\\text{V}^2$\n- Threshold voltage, $V_{th} = 0.5~\\text{V}$\n- Channel-length modulation parameter, $\\lambda = 0.05~\\text{V}^{-1}$\n- Aspect ratio of the reference transistor $M_1$, $(W/L)_1 = 10$\n- The drain of the output transistor $M_2$ is connected to a load that maintains a constant voltage $V_{D2} = 1.8~\\text{V}$.\n\nThe goal is to design the circuit such that the output current is half of the reference current, i.e., $I_{OUT} = 0.5 I_{REF}$. Assuming both transistors are operating in the saturation region, calculate the required aspect ratio, $(W/L)_2$, for transistor $M_2$. Express your answer as a dimensionless number rounded to three significant figures.", "solution": "The problem requires us to find the aspect ratio $(W/L)_2$ of the output transistor $M_2$ in an NMOS current mirror, considering the effect of channel-length modulation.\n\nFirst, we write the drain current equation for an NMOS transistor operating in the saturation region, including the channel-length modulation effect:\n$$I_D = \\frac{1}{2} \\mu_n C_{ox} \\frac{W}{L} (V_{GS} - V_{th})^2 (1 + \\lambda V_{DS})$$\nThe gate-source voltage, $V_{GS}$, is common to both transistors and is set by the reference transistor $M_1$. For transistor $M_1$, the drain current is $I_{D1} = I_{REF}$, and because it is diode-connected, its drain-to-source voltage is equal to its gate-to-source voltage, i.e., $V_{DS1} = V_{GS}$.\n\nThe full equation for $I_{REF}$ is therefore:\n$$I_{REF} = \\frac{1}{2} \\mu_n C_{ox} (W/L)_1 (V_{GS} - V_{th})^2 (1 + \\lambda V_{GS})$$\nSolving this equation for $V_{GS}$ directly would involve solving a cubic polynomial. A standard and sufficiently accurate approach in introductory analysis is to first calculate an approximate value for $V_{GS}$ by ignoring the $(1 + \\lambda V_{GS})$ term, as $\\lambda$ is typically small.\n\nSo, we first find an approximate $V_{GS}$ using the simplified equation:\n$$I_{REF} \\approx \\frac{1}{2} \\mu_n C_{ox} (W/L)_1 (V_{GS} - V_{th})^2$$\nSubstituting the given values:\n$$100 \\times 10^{-6} \\text{ A} = \\frac{1}{2} (200 \\times 10^{-6} \\text{ A/V}^2) (10) (V_{GS} - 0.5 \\text{ V})^2$$\n$$100 \\times 10^{-6} = (1000 \\times 10^{-6}) (V_{GS} - 0.5)^2$$\n$$(V_{GS} - 0.5)^2 = \\frac{100 \\times 10^{-6}}{1000 \\times 10^{-6}} = 0.1$$\nTaking the square root of both sides (and choosing the positive root since $V_{GS}$ must be greater than $V_{th}$ for the transistor to be on):\n$$V_{GS} - 0.5 = \\sqrt{0.1} \\approx 0.31623 \\text{ V}$$\n$$V_{GS} \\approx 0.5 + 0.31623 = 0.81623 \\text{ V}$$\nWe should check that both transistors are in saturation. The overdrive voltage is $V_{OV} = V_{GS} - V_{th} \\approx 0.31623$ V. For $M_1$, $V_{DS1} = V_{GS} \\approx 0.81623 \\text{ V}$. Since $V_{DS1} > V_{OV}$, $M_1$ is in saturation. For $M_2$, $V_{DS2} = V_{D2} = 1.8 \\text{ V}$. Since $V_{DS2} > V_{OV}$, $M_2$ is also in saturation.\n\nNow we can write the full current equations for both transistors, including the channel-length modulation term, using this calculated value of $V_{GS}$.\nFor $M_1$:\n$$I_{REF} = \\frac{1}{2} \\mu_n C_{ox} (W/L)_1 (V_{GS} - V_{th})^2 (1 + \\lambda V_{GS})$$\nFor $M_2$, the drain current is $I_{OUT}$ and the drain-source voltage is $V_{DS2} = V_{D2} = 1.8 \\text{ V}$:\n$$I_{OUT} = \\frac{1}{2} \\mu_n C_{ox} (W/L)_2 (V_{GS} - V_{th})^2 (1 + \\lambda V_{D2})$$\nTo find the relationship between the two currents and their aspect ratios, we take the ratio of $I_{OUT}$ to $I_{REF}$:\n$$\\frac{I_{OUT}}{I_{REF}} = \\frac{\\frac{1}{2} \\mu_n C_{ox} (W/L)_2 (V_{GS} - V_{th})^2 (1 + \\lambda V_{D2})}{\\frac{1}{2} \\mu_n C_{ox} (W/L)_1 (V_{GS} - V_{th})^2 (1 + \\lambda V_{GS})}$$\nThe common terms $\\frac{1}{2} \\mu_n C_{ox} (V_{GS} - V_{th})^2$ cancel out, leaving:\n$$\\frac{I_{OUT}}{I_{REF}} = \\frac{(W/L)_2}{(W/L)_1} \\frac{1 + \\lambda V_{D2}}{1 + \\lambda V_{GS}}$$\nWe need to solve for $(W/L)_2$:\n$$(W/L)_2 = (W/L)_1 \\left( \\frac{I_{OUT}}{I_{REF}} \\right) \\left( \\frac{1 + \\lambda V_{GS}}{1 + \\lambda V_{D2}} \\right)$$\nNow we substitute the known values into this expression: $(W/L)_1 = 10$, $I_{OUT}/I_{REF} = 0.5$, $\\lambda = 0.05 \\text{ V}^{-1}$, $V_{GS} \\approx 0.81623 \\text{ V}$, and $V_{D2} = 1.8 \\text{ V}$.\n$$(W/L)_2 = 10 \\times 0.5 \\times \\frac{1 + (0.05)(0.81623)}{1 + (0.05)(1.8)}$$\n$$(W/L)_2 = 5 \\times \\frac{1 + 0.0408115}{1 + 0.09}$$\n$$(W/L)_2 = 5 \\times \\frac{1.0408115}{1.09}$$\n$$(W/L)_2 = 5 \\times 0.9548729...$$\n$$(W/L)_2 = 4.77436...$$\nRounding the result to three significant figures, as requested in the problem statement:\n$$(W/L)_2 \\approx 4.77$$", "answer": "$$\\boxed{4.77}$$", "id": "1317760"}, {"introduction": "A current mirror does not behave as an ideal current source under all conditions; it has operational limits. This practice explores the concept of output compliance voltage by analyzing what happens when the output voltage is too low to maintain proper operation. You will learn the critical skill of checking a transistor's operating region and see how the output current changes when the device leaves saturation and enters the triode region.[@problem_id:1317772]", "problem": "A simple current mirror circuit is constructed using two N-channel Metal-Oxide-Semiconductor (NMOS) transistors, denoted as $M_1$ and $M_2$. The gates of both transistors are connected together, and their sources are tied to the ground. The drain of the reference transistor, $M_1$, is connected to its gate, and this node is supplied by a reference current $I_{REF}$. The output current, $I_{OUT}$, is drawn from the drain of the output transistor, $M_2$.\n\nThe transistors are characterized by the following parameters:\n-   Threshold voltage: $V_{th} = 0.50~\\text{V}$\n-   Process transconductance parameter: $k'_n = 200~\\mu\\text{A/V}^2$\n-   Aspect ratio of $M_1$: $(W/L)_1 = 10$\n-   Aspect ratio of $M_2$: $(W/L)_2 = 20$\n-   Reference current: $I_{REF} = 90~\\mu\\text{A}$\n\nThe output of the mirror is connected to a load that fixes the drain voltage of $M_2$ at $V_{OUT} = 0.20~\\text{V}$. For this analysis, you must assume channel-length modulation is negligible for both transistors.\n\nCalculate the value of the output current $I_{OUT}$. Express your answer in microamperes ($\\mu\\text{A}$), rounded to three significant figures.", "solution": "The problem asks for the output current $I_{OUT}$ of an NMOS current mirror where the output voltage is specified. We need to determine the operating region of each transistor to use the correct current-voltage equations.\n\nFirst, let's analyze the reference transistor, $M_1$. The drain and gate of $M_1$ are connected, which means its drain-source voltage is equal to its gate-source voltage, i.e., $V_{DS1} = V_{GS1}$. A transistor operates in the saturation region if $V_{DS} \\ge V_{GS} - V_{th}$. For $M_1$, this condition becomes $V_{GS1} \\ge V_{GS1} - V_{th}$, which simplifies to $0 \\ge -V_{th}$. Since the threshold voltage $V_{th}$ is positive ($0.50 \\text{ V}$), this condition is always met. Therefore, $M_1$ is operating in the saturation region.\n\nThe drain current of an NMOS transistor in saturation (ignoring channel-length modulation) is given by:\n$$I_D = \\frac{1}{2} k'_n \\left(\\frac{W}{L}\\right) (V_{GS} - V_{th})^2$$\nFor $M_1$, its drain current is the reference current, $I_{D1} = I_{REF}$. We can use this to find the gate-source voltage $V_{GS1}$.\n$$I_{REF} = \\frac{1}{2} k'_n \\left(\\frac{W}{L}\\right)_1 (V_{GS1} - V_{th})^2$$\nRearranging the equation to solve for $V_{GS1}$:\n$$V_{GS1} = V_{th} + \\sqrt{\\frac{2 I_{REF}}{k'_n (W/L)_1}}$$\nSubstituting the given values:\n$I_{REF} = 90 \\text{ } \\mu\\text{A} = 90 \\times 10^{-6} \\text{ A}$\n$k'_n = 200 \\text{ } \\mu\\text{A/V}^2 = 200 \\times 10^{-6} \\text{ A/V}^2$\n$(W/L)_1 = 10$\n$V_{th} = 0.50 \\text{ V}$\n$$V_{GS1} = 0.50 + \\sqrt{\\frac{2 \\times 90 \\times 10^{-6}}{200 \\times 10^{-6} \\times 10}} = 0.50 + \\sqrt{\\frac{180 \\times 10^{-6}}{2000 \\times 10^{-6}}}$$\n$$V_{GS1} = 0.50 + \\sqrt{0.09} = 0.50 + 0.30 = 0.80 \\text{ V}$$\n\nSince the gates of $M_1$ and $M_2$ are connected, their gate-source voltages are equal: $V_{GS2} = V_{GS1} = 0.80 \\text{ V}$.\n\nNow, let's determine the operating region of the output transistor, $M_2$. We need to compare its drain-source voltage, $V_{DS2}$, with its overdrive voltage, $V_{OV2} = V_{GS2} - V_{th}$.\n$V_{OV2} = 0.80 \\text{ V} - 0.50 \\text{ V} = 0.30 \\text{ V}$.\nThe problem states that the output voltage is $V_{OUT} = 0.20 \\text{ V}$, which corresponds to the drain-source voltage of $M_2$, so $V_{DS2} = 0.20 \\text{ V}$.\n\nThe condition for $M_2$ to be in saturation is $V_{DS2} \\ge V_{GS2} - V_{th}$, or $V_{DS2} \\ge V_{OV2}$.\nHere, we have $0.20 \\text{ V} < 0.30 \\text{ V}$. Since $V_{DS2} < V_{OV2}$, the transistor $M_2$ is not in saturation. It is operating in the linear or triode region.\n\nThe drain current of an NMOS transistor in the triode region is given by:\n$$I_D = k'_n \\left(\\frac{W}{L}\\right) \\left[ (V_{GS} - V_{th})V_{DS} - \\frac{1}{2}V_{DS}^2 \\right]$$\nThe output current $I_{OUT}$ is the drain current of $M_2$, so $I_{OUT} = I_{D2}$. We can calculate it using the known values for $M_2$:\n$k'_n = 200 \\times 10^{-6} \\text{ A/V}^2$\n$(W/L)_2 = 20$\n$V_{GS2} = 0.80 \\text{ V}$\n$V_{th} = 0.50 \\text{ V}$\n$V_{DS2} = 0.20 \\text{ V}$\n$$I_{OUT} = (200 \\times 10^{-6}) \\times 20 \\times \\left[ (0.80 - 0.50)(0.20) - \\frac{1}{2}(0.20)^2 \\right]$$\n$$I_{OUT} = (4000 \\times 10^{-6}) \\times \\left[ (0.30)(0.20) - \\frac{1}{2}(0.04) \\right]$$\n$$I_{OUT} = (4.0 \\times 10^{-3}) \\times \\left[ 0.060 - 0.020 \\right]$$\n$$I_{OUT} = (4.0 \\times 10^{-3}) \\times [0.040]$$\n$$I_{OUT} = 0.160 \\times 10^{-3} \\text{ A}$$\nTo express the answer in microamperes ($\\mu\\text{A}$), we multiply by $10^6$:\n$$I_{OUT} = 0.160 \\times 10^{-3} \\times 10^6 \\text{ } \\mu\\text{A} = 160 \\text{ } \\mu\\text{A}$$\nThe result is $160 \\text{ } \\mu\\text{A}$. The problem asks for the answer to be rounded to three significant figures. The number 160 has exactly three significant figures.", "answer": "$$\\boxed{160}$$", "id": "1317772"}]}