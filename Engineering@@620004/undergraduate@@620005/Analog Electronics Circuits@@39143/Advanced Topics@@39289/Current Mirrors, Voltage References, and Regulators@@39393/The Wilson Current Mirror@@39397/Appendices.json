{"hands_on_practices": [{"introduction": "Transitioning from theory to practice begins with setting up the correct operating conditions. This problem lets you perform a fundamental design calculation for a Wilson current mirror: determining the reference resistor value needed to produce a specific output current [@problem_id:1342141]. This exercise connects the circuit’s DC bias point to a physical component, a crucial first step in any real-world analog circuit design.", "problem": "An electronics engineer is designing a precision biasing circuit for an amplifier stage in a low-power integrated circuit. The design utilizes a Wilson current mirror to generate a stable output current, $I_{out}$. The circuit is constructed using three NPN Bipolar Junction Transistors (BJTs) that are assumed to be perfectly matched.\n\nThe mirror is powered by a supply voltage of $V_{CC} = 5.00 \\text{ V}$. For the specific topology of the Wilson mirror being used, a detailed analysis provides the following relationships, assuming the transistors operate in the forward-active region and the Early effect is negligible:\n\n1.  The reference current, $I_{REF}$, which flows through the reference resistor $R_{ref}$, is related to the desired output current $I_{out}$ by the equation:\n    $$I_{REF} = I_{out} \\left(1 + \\frac{2}{\\beta(\\beta + 1)}\\right)$$\n    where $\\beta$ is the common-emitter current gain of the transistors.\n\n2.  The DC voltage at the reference node (the point where $R_{ref}$ connects to the transistor network) is stable at twice the base-emitter turn-on voltage, i.e., $V_{REF} = 2V_{BE,on}$.\n\nThe design requires a stable output current of $I_{out} = 100.0 \\text{ } \\mu \\text{A}$. The matched transistors have a current gain of $\\beta = 100$, and their base-emitter turn-on voltage is $V_{BE,on} = 0.700 \\text{ V}$.\n\nCalculate the required value of the reference resistor, $R_{ref}$, to achieve the specified output current. Express your answer in kilohms ($\\text{k}\\Omega$) and round to three significant figures.", "solution": "We are given the Wilson mirror relations:\n- Reference current to output current: \n$$I_{REF} = I_{out}\\left(1 + \\frac{2}{\\beta(\\beta + 1)}\\right)$$\n- Reference node voltage: \n$$V_{REF} = 2V_{BE,on}$$\nAssuming the reference resistor $R_{ref}$ is connected from $V_{CC}$ to the reference node, Ohm’s law gives:\n$$R_{ref} = \\frac{V_{CC} - V_{REF}}{I_{REF}}$$\nSubstitute $V_{REF}$ and $I_{REF}$:\n$$R_{ref} = \\frac{V_{CC} - 2V_{BE,on}}{I_{out}\\left(1 + \\frac{2}{\\beta(\\beta + 1)}\\right)}$$\nInsert the given values $V_{CC} = 5.00\\text{ V}$, $V_{BE,on} = 0.700\\text{ V}$, $I_{out} = 100.0\\ \\mu\\text{A}$, and $\\beta = 100$:\n$$V_{CC} - 2V_{BE,on} = 5.00 - 2(0.700) = 3.600\\text{ V}$$\n$$1 + \\frac{2}{\\beta(\\beta + 1)} = 1 + \\frac{2}{100\\cdot 101} = 1 + \\frac{2}{10100} = \\frac{5051}{5050}$$\nThus,\n$$R_{ref} = \\frac{3.600\\text{ V}}{100.0\\ \\mu\\text{A}\\cdot \\frac{5051}{5050}} = \\frac{3.600\\text{ V}}{100.0\\ \\mu\\text{A}}\\cdot \\frac{5050}{5051}$$\nCompute the base ratio:\n$$\\frac{3.600\\text{ V}}{100.0\\ \\mu\\text{A}} = 36.000\\ \\text{k}\\Omega$$\nTherefore,\n$$R_{ref} = 36.000\\ \\text{k}\\Omega \\times \\frac{5050}{5051} \\approx 35.9929\\ \\text{k}\\Omega$$\nRounding to three significant figures as required gives $36.0\\ \\text{k}\\Omega$.", "answer": "$$\\boxed{36.0}$$", "id": "1342141"}, {"introduction": "The real power of the Wilson current mirror lies not just in its ability to copy a current, but in how well it maintains that current against variations in load conditions. This high performance is quantified by its large small-signal output resistance, $R_{out}$ [@problem_id:1333859]. This exercise will guide you through the small-signal analysis to derive this critical parameter, revealing the clever feedback mechanism that gives the Wilson mirror its superior characteristics.", "problem": "An engineer is designing a precision current source using a Wilson current mirror topology. The circuit is constructed with three NPN Bipolar Junction Transistors (BJTs), labeled Q1, Q2, and Q3, which are perfectly matched. Each transistor has a small-signal transconductance of $g_m$ and a finite small-signal output resistance of $r_o$.\n\nThe circuit is configured as follows:\n- The emitters of Q1 and Q2 are connected to ground.\n- Q1 is diode-connected, with its collector tied to its base. A reference current source is connected to this node.\n- The base of Q2 is connected to the base of Q1.\n- Q3 is stacked on top of Q2, meaning the emitter of Q3 is connected to the collector of Q2.\n- The base of Q3 is connected to the common base node of Q1 and Q2.\n- The output current is drawn from the collector of Q3.\n\nAssuming the current gain, $\\beta$, of the transistors is infinitely large, determine the small-signal output resistance, $R_{out}$, of the current mirror as seen from the collector of Q3. Express your answer as a single closed-form analytic expression in terms of $g_m$ and $r_o$.", "solution": "We use the small-signal hybrid-pi model for BJTs with infinite current gain. Let all three transistors be matched with transconductance $g_{m}$ and output resistance $r_{o}$. Define $g_{o} \\equiv \\frac{1}{r_{o}}$.\n\nLabel nodes as follows:\n- Node $B$: common base node of Q1, Q2, Q3 and collector of Q1 (diode-connected).\n- Node $X$: collector of Q2 and emitter of Q3.\n- Node $Y$: collector of Q3 (the output node).\n- Ground: emitters of Q1 and Q2.\n\nSmall-signal elements:\n- Q1 (diode-connected) from $B$ to ground presents an admittance $g_{m}+g_{o}$ since its small-signal current is $i_{1}=(g_{m}+g_{o})v_{b}$.\n- Q2 has a dependent current source of value $g_{m}v_{b}$ from $X$ to ground and a resistor $r_{o}$ from $X$ to ground (conductance $g_{o}$).\n- Q3 has a dependent current source of value $g_{m}(v_{b}-v_{x})$ from $Y$ to $X$ and a resistor $r_{o}$ from $Y$ to $X$ (conductance $g_{o}$).\n\nWe seek $R_{out}$ seen at $Y$ by applying a test voltage $v_{y}$ at node $Y$ (with respect to ground), solving for the resulting current $i_{y}$ flowing from node $Y$ into the network, and then using $R_{out}=\\frac{v_{y}}{i_{y}}$.\n\nFirst, determine $v_{b}$. With infinite $\\beta$, base currents are zero; the only element connected to node $B$ is Q1 (to ground). There is no small-signal excitation connected to $B$ through Q2 or Q3 because controlled sources do not inject current into $B$. Therefore KCL at $B$ gives\n$$\n(g_{m}+g_{o})v_{b}=0 \\;\\;\\Rightarrow\\;\\; v_{b}=0.\n$$\n\nNext, write KCL at node $X$. Sum of currents leaving $X$ must be zero (no independent source at $X$):\n- Through Q2 $r_{o}$ to ground: $g_{o}v_{x}$.\n- Through Q2 $g_{m}$ source to ground: $g_{m}v_{b}$.\n- Through Q3 $r_{o}$ to $Y$: $g_{o}(v_{x}-v_{y})$.\n- Through Q3 $g_{m}$ source (which is oriented from $Y$ to $X$): current leaving $X$ via this source is $-g_{m}(v_{b}-v_{x})$.\n\nThus\n$$\ng_{o}v_{x}+g_{m}v_{b}+g_{o}(v_{x}-v_{y})-g_{m}(v_{b}-v_{x})=0.\n$$\nWith $v_{b}=0$, this simplifies to\n$$\n(2g_{o}+g_{m})v_{x}=g_{o}v_{y} \\;\\;\\Rightarrow\\;\\; v_{x}=\\frac{g_{o}}{2g_{o}+g_{m}}\\,v_{y}.\n$$\n\nNow compute the test current $i_{y}$ flowing from node $Y$ into the network. Currents leaving $Y$ toward the network are:\n- Through Q3 $r_{o}$ to $X$: $g_{o}(v_{y}-v_{x})$.\n- Through Q3 $g_{m}$ source from $Y$ to $X$: $g_{m}(v_{b}-v_{x})$.\n\nHence, using $v_{b}=0$,\n$$\ni_{y}=g_{o}(v_{y}-v_{x})-g_{m}v_{x}.\n$$\nSubstitute $v_{x}=\\alpha v_{y}$ with $\\alpha=\\frac{g_{o}}{2g_{o}+g_{m}}$:\n$$\ni_{y}=\\left[g_{o}(1-\\alpha)-g_{m}\\alpha\\right]v_{y}.\n$$\nCompute $1-\\alpha=\\frac{g_{o}+g_{m}}{2g_{o}+g_{m}}$, so\n$$\ng_{o}(1-\\alpha)-g_{m}\\alpha=\\frac{g_{o}(g_{o}+g_{m})-g_{m}g_{o}}{2g_{o}+g_{m}}=\\frac{g_{o}^{2}}{2g_{o}+g_{m}}.\n$$\nTherefore\n$$\ni_{y}=\\frac{g_{o}^{2}}{2g_{o}+g_{m}}\\,v_{y}\n\\quad\\Rightarrow\\quad\nR_{out}=\\frac{v_{y}}{i_{y}}=\\frac{2g_{o}+g_{m}}{g_{o}^{2}}=g_{m}r_{o}^{2}+2r_{o}.\n$$\n\nThis is the closed-form small-signal output resistance as seen from the collector of Q3.", "answer": "$$\\boxed{g_{m}r_{o}^{2}+2r_{o}}$$", "id": "1333859"}, {"introduction": "A true test of understanding is the ability to analyze a circuit when things go wrong. In this hypothetical scenario, a manufacturing fault transforms the circuit, providing a powerful exercise in first-principles analysis [@problem_id:1342145]. By calculating the output current of the faulty circuit, you will reinforce your knowledge of BJT behavior and Kirchhoff's Current Law, skills that are essential for troubleshooting electronic systems.", "problem": "A current-steering circuit is constructed using three identical NPN Bipolar Junction Transistors (BJTs), labeled Q1, Q2, and Q3. The intended configuration is as follows:\n\n- The emitters of Q1 and Q3 are connected to ground.\n- A reference current source provides a current $I_{REF}$ to an input node.\n- Transistor Q2 is diode-connected, with its collector and base shorted together. The collector of Q2 is connected to a positive supply voltage, $V_{CC}$.\n- The common base-collector node of Q2 is connected to the bases of Q1 and Q3.\n- The emitter of Q2 is connected to the collector of Q3. This connection point also serves as the input node for the reference current, $I_{REF}$.\n- The output current, $I_{OUT}$, is drawn from the collector of Q1.\n\nDuring manufacturing, a fault occurs: the transistor Q2 is entirely replaced by a simple wire that shorts the pad intended for Q2's collector to the pad intended for Q2's emitter. All other connections remain as described.\n\nAssuming all transistors are identical and operate in the forward-active region with a forward current gain $\\beta = 100$, and the reference current is $I_{REF} = 2.00$ mA, calculate the new output current $I_{OUT}$ in the faulty circuit. The Early effect can be considered negligible.\n\nExpress your answer in milliamperes (mA), rounded to three significant figures.", "solution": "With Q2 removed and replaced by a short between its collector pad (also tied to the common base node of Q1 and Q3) and its emitter pad (tied to the collector of Q3 and the $I_{REF}$ input node), the fault effectively ties the bases of Q1 and Q3 to the collector of Q3 and to the $I_{REF}$ node. Thus Q3 becomes diode-connected ($V_{CB3}=0$), and the reference current $I_{REF}$ feeds:\n- the collector of Q3, carrying $I_{C3}$,\n- the base of Q3, carrying $I_{B3}$,\n- the base of Q1, carrying $I_{B1}$.\n\nAssuming forward-active operation and identical transistors with negligible Early effect:\n- The collector current and base current of any transistor satisfy $I_{C}=\\beta I_{B}$.\n- Identical transistors with shorted bases and equal emitter potentials have equal $V_{BE}$, hence equal collector currents. Therefore,\n$$\nI_{C1}=I_{C3}\\equiv I.\n$$\nFrom $I_{C}=\\beta I_{B}$, the base currents are\n$$\nI_{B1}=\\frac{I_{C1}}{\\beta}=\\frac{I}{\\beta},\\qquad I_{B3}=\\frac{I_{C3}}{\\beta}=\\frac{I}{\\beta}.\n$$\nApplying KCL at the node where $I_{REF}$ is injected (which is tied to the bases of Q1, Q3 and the collector of Q3), the incoming current $I_{REF}$ equals the sum of the three outgoing currents:\n$$\nI_{REF}=I_{C3}+I_{B1}+I_{B3}=I\\left(1+\\frac{2}{\\beta}\\right).\n$$\nSolving for $I$ gives\n$$\nI=\\frac{\\beta}{\\beta+2}\\,I_{REF}.\n$$\nThe output current is drawn from the collector of Q1, so\n$$\nI_{OUT}=I_{C1}=I=\\frac{\\beta}{\\beta+2}\\,I_{REF}.\n$$\nSubstituting $\\beta=100$ and $I_{REF}=2.00\\ \\text{mA}$,\n$$\nI_{OUT}=\\frac{100}{100+2}\\times 2.00=\\frac{200}{102}\\ \\text{mA}\\approx 1.960784\\ \\text{mA}.\n$$\nRounded to three significant figures, this is $1.96$ mA.", "answer": "$$\\boxed{1.96}$$", "id": "1342145"}]}