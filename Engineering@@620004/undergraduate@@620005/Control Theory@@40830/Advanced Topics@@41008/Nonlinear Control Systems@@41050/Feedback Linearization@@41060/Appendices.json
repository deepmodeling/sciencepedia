{"hands_on_practices": [{"introduction": "The concept of relative degree is fundamental to input-output feedback linearization, as it quantifies the directness of the input's influence on the output. This exercise will give you hands-on practice in determining the relative degree of a nonlinear system, a critical first step in designing any feedback linearizing controller [@problem_id:1575306]. Mastering this calculation is essential for understanding the structure and limitations of the system you aim to control.", "problem": "Consider a nonlinear single-input, single-output system described by the following state-space equations:\n$$\n\\begin{aligned}\n\\dot{x}_1 &= x_1 x_2 \\\\\n\\dot{x}_2 &= u\n\\end{aligned}\n$$\nHere, $x_1$ and $x_2$ represent the state variables of the system, and $u$ is the control input. The system's output is defined as $y = x_1$.\n\nDetermine the relative degree of this system with respect to the specified output $y$.", "solution": "We write the system in control-affine form $\\dot{x} = f(x) + g(x)u$ with output $y = h(x)$:\n$$\nf(x) = \\begin{pmatrix} x_{1}x_{2} \\\\ 0 \\end{pmatrix}, \\quad g(x) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad h(x) = x_{1}.\n$$\nThe relative degree $r$ at a point is the smallest positive integer such that $L_{g}L_{f}^{r-1}h(x) \\neq 0$, where $L_{f}$ and $L_{g}$ denote Lie derivatives along $f$ and $g$, respectively.\n\nFirst Lie derivatives:\n$$\nL_{g}h(x) = \\frac{\\partial h}{\\partial x}g(x) = \\begin{pmatrix} 1 & 0 \\end{pmatrix}\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = 0,\n$$\nso the input $u$ does not appear in $\\dot{y}$ and the relative degree is at least $2$.\n\nCompute $L_{f}h$:\n$$\nL_{f}h(x) = \\frac{\\partial h}{\\partial x}f(x) = \\begin{pmatrix} 1 & 0 \\end{pmatrix}\\begin{pmatrix} x_{1}x_{2} \\\\ 0 \\end{pmatrix} = x_{1}x_{2}.\n$$\nThen\n$$\nL_{g}L_{f}h(x) = \\frac{\\partial (x_{1}x_{2})}{\\partial x}g(x) = \\begin{pmatrix} x_{2} & x_{1} \\end{pmatrix}\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = x_{1}.\n$$\nThus, for $x_{1} \\neq 0$, $L_{g}L_{f}h(x) \\neq 0$ and the input appears in the second derivative of the output, so the relative degree is $r=2$ on the set $\\{x \\mid x_{1} \\neq 0\\}$.\n\nEquivalently, by direct differentiation,\n$$\n\\dot{y} = \\dot{x}_{1} = x_{1}x_{2}, \\quad \\ddot{y} = \\dot{x}_{1}x_{2} + x_{1}\\dot{x}_{2} = x_{1}x_{2}^{2} + x_{1}u,\n$$\nand the coefficient of $u$ in $\\ddot{y}$ is $x_{1}$, confirming the relative degree $2$ for $x_{1} \\neq 0$. At $x_{1}=0$, $L_{g}L_{f}^{k}h(x)$ remains zero for all $k \\geq 1$ (one finds $L_{g}L_{f}^{k}h(x) = k x_{1} x_{2}^{k-1}$), so the relative degree is not well-defined at that point. The standard answer is $r=2$ (away from $x_{1}=0$).", "answer": "$$\\boxed{2}$$", "id": "1575306"}, {"introduction": "Once the relative degree is known, the next step is to synthesize the control law that cancels the system's nonlinearities. This practice problem focuses on deriving the functions $\\alpha(x)$ and $\\beta(x)$ for a control input $u = \\alpha(x) + \\beta(x)v$ that transforms the complex dynamics into a simple, linear relationship [@problem_id:1575256]. This process is the core of feedback linearization, turning a challenging nonlinear problem into a manageable linear one.", "problem": "Consider a simplified model for a chemical process within a continuous stirred-tank reactor. The state of the system is described by two variables: the concentration of a product, $x_1(t)$, and the temperature of the reactor, $x_2(t)$. The evolution of these states is governed by the nonlinear differential equations:\n$$\n\\begin{aligned}\n\\dot{x}_1 &= x_2^2 \\\\\n\\dot{x}_2 &= u\n\\end{aligned}\n$$\nHere, the state vector is $x = [x_1, x_2]^T$, and $u(t)$ is the control input, which represents the rate of heating or cooling applied to the reactor. The output of interest, which we aim to control, is the product concentration, defined as $y = x_1$.\n\nThe objective is to design a state-feedback control law of the form $u = \\alpha(x) + \\beta(x)v$. In this expression, $v$ is a new, external command input, and $\\alpha(x)$ and $\\beta(x)$ are functions of the state vector $x$. The purpose of this controller is to make the input-output behavior of the system linear. Specifically, the relationship between the new input $v$ and the output $y$ must be described by the simple second-order linear dynamics $\\ddot{y} = v$.\n\nDetermine the expressions for the functions $\\alpha(x)$ and $\\beta(x)$ that achieve this input-output linearization. The final answer should be presented as a pair of functions, with $\\alpha(x)$ as the first element and $\\beta(x)$ as the second.", "solution": "We aim to achieve input-output linearization so that the output $y=x_{1}$ satisfies $\\ddot{y}=v$ under a feedback of the form $u=\\alpha(x)+\\beta(x)v$.\n\nGiven the system\n$$\n\\dot{x}_{1}=x_{2}^{2}, \\qquad \\dot{x}_{2}=u,\n$$\nand the output $y=h(x)=x_{1}$, compute successive time derivatives of $y$.\n\nFirst derivative:\n$$\n\\dot{y}=\\dot{x}_{1}=x_{2}^{2}.\n$$\n\nSecond derivative:\n$$\n\\ddot{y}=\\frac{d}{dt}\\left(x_{2}^{2}\\right)=2x_{2}\\dot{x}_{2}=2x_{2}u.\n$$\n\nThis shows the relative degree is two wherever $x_{2}\\neq 0$. In the standard input-output linearization form,\n$$\n\\ddot{y}=L_{f}^{2}h(x)+L_{g}L_{f}h(x)\\,u,\n$$\nwe identify\n$$\nL_{f}h=x_{2}^{2}, \\quad \\nabla(L_{f}h)=[0,\\;2x_{2}], \\quad f(x)=\\begin{bmatrix}x_{2}^{2}\\\\ 0\\end{bmatrix}, \\quad g(x)=\\begin{bmatrix}0\\\\ 1\\end{bmatrix},\n$$\nso\n$$\nL_{f}^{2}h=\\nabla(L_{f}h)\\cdot f=[0,\\;2x_{2}]\\begin{bmatrix}x_{2}^{2}\\\\ 0\\end{bmatrix}=0, \\qquad L_{g}L_{f}h=\\nabla(L_{f}h)\\cdot g=[0,\\;2x_{2}]\\begin{bmatrix}0\\\\ 1\\end{bmatrix}=2x_{2}.\n$$\n\nTo enforce $\\ddot{y}=v$, choose $u$ as\n$$\nu=\\frac{v-L_{f}^{2}h}{L_{g}L_{f}h}=\\frac{v}{2x_{2}}.\n$$\nThis is of the form $u=\\alpha(x)+\\beta(x)v$ with\n$$\n\\alpha(x)=0, \\qquad \\beta(x)=\\frac{1}{2x_{2}},\n$$\nvalid on the domain where $x_{2}\\neq 0$.", "answer": "$$\\boxed{\\begin{pmatrix} 0 & \\frac{1}{2 x_{2}} \\end{pmatrix}}$$", "id": "1575256"}, {"introduction": "The true power of feedback linearization lies in its synergy with the vast toolkit of linear control theory. This exercise demonstrates the complete design process, where you will not only linearize the system but also design the controller to place the closed-loop poles at specific locations, thereby dictating the system's dynamic response [@problem_id:1575297]. This final step shows how to go from a nonlinear model to a high-performance, precisely controlled linear system.", "problem": "Consider a nonlinear dynamical system described by the state equations:\n$$\n\\begin{aligned}\n\\dot{x}_1 &= -\\alpha x_1 + \\beta \\ln(1 + x_2^2) \\\\\n\\dot{x}_2 &= u\n\\end{aligned}\n$$\nwhere $x_1$ and $x_2$ are the system's states, $u$ is the control input, and $\\alpha$ and $\\beta$ are known positive real constants. The output of the system is defined as $y = x_1$.\n\nYour task is to design a state feedback control law $u(x_1, x_2)$ that transforms the nonlinear input-output relationship into a linear one. Specifically, the control law must ensure that the closed-loop system dynamics for the output $y$ are governed by a characteristic equation with roots (poles) at $-p_1$ and $-p_2$. Here, $p_1$ and $p_2$ are distinct positive real constants.\n\nDetermine the expression for the control law $u$ as a function of the state variables $x_1, x_2$ and the parameters $\\alpha, \\beta, p_1, p_2$.", "solution": "We are given the system\n$$\n\\dot{x}_{1}=-\\alpha x_{1}+\\beta \\ln(1+x_{2}^{2}), \\quad \\dot{x}_{2}=u, \\quad y=x_{1},\n$$\nwith constants $\\alpha>0$, $\\beta>0$. We aim to design a feedback $u(x_{1},x_{2})$ so that the output $y$ has closed-loop dynamics with characteristic equation having roots at $-p_{1}$ and $-p_{2}$, i.e.,\n$$\n\\ddot{y}+(p_{1}+p_{2})\\dot{y}+p_{1}p_{2}y=0,\n$$\nwhere $p_{1}$ and $p_{2}$ are distinct positive constants.\n\nFirst, compute the output derivatives. Since $y=x_{1}$,\n$$\n\\dot{y}=\\dot{x}_{1}=-\\alpha y+\\beta \\ln(1+x_{2}^{2}).\n$$\nDifferentiate again, using the chain rule and $\\dot{x}_{2}=u$:\n$$\n\\ddot{y}=\\frac{d}{dt}\\left(-\\alpha y+\\beta \\ln(1+x_{2}^{2})\\right)\n=-\\alpha \\dot{y}+\\beta \\frac{2x_{2}}{1+x_{2}^{2}}\\,\\dot{x}_{2}\n=-\\alpha \\dot{y}+\\beta \\frac{2x_{2}}{1+x_{2}^{2}}\\,u.\n$$\nTo impose the desired linear second-order dynamics on $y$, set\n$$\n\\ddot{y}=-(p_{1}+p_{2})\\dot{y}-p_{1}p_{2}y.\n$$\nEquating with the systemâ€™s $\\ddot{y}$ expression gives\n$$\n-\\alpha \\dot{y}+\\beta \\frac{2x_{2}}{1+x_{2}^{2}}\\,u=-(p_{1}+p_{2})\\dot{y}-p_{1}p_{2}y,\n$$\nwhich implies\n$$\n\\beta \\frac{2x_{2}}{1+x_{2}^{2}}\\,u=-(p_{1}+p_{2}-\\alpha)\\dot{y}-p_{1}p_{2}y.\n$$\nSubstitute $\\dot{y}=-\\alpha y+\\beta \\ln(1+x_{2}^{2})$ and $y=x_{1}$:\n$$\nu=\\frac{1+x_{2}^{2}}{2\\beta x_{2}}\\left(-(p_{1}+p_{2}-\\alpha)\\left(-\\alpha x_{1}+\\beta \\ln(1+x_{2}^{2})\\right)-p_{1}p_{2}x_{1}\\right).\n$$\nExpanding the numerator yields the equivalent explicit form\n$$\nu=\\frac{1+x_{2}^{2}}{2\\beta x_{2}}\\left(\\left(\\alpha(p_{1}+p_{2}-\\alpha)-p_{1}p_{2}\\right)x_{1}-(p_{1}+p_{2}-\\alpha)\\beta \\ln(1+x_{2}^{2})\\right).\n$$\nThis feedback linearizes the input-output map and yields the closed-loop output dynamics with poles at $-p_{1}$ and $-p_{2}$, assuming $x_{2}\\neq 0$ so that the input gain is nonzero.", "answer": "$$\\boxed{\\frac{1+x_{2}^{2}}{2\\beta x_{2}}\\left(\\left(\\alpha(p_{1}+p_{2}-\\alpha)-p_{1}p_{2}\\right)x_{1}-(p_{1}+p_{2}-\\alpha)\\beta \\ln(1+x_{2}^{2})\\right)}$$", "id": "1575297"}]}