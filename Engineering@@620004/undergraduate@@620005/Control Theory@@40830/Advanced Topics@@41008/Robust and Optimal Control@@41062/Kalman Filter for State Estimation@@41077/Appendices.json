{"hands_on_practices": [{"introduction": "A crucial first step in deploying a Kalman filter is initializing its state and expressing our confidence in that initial guess. The initial error covariance matrix, $P_{0|0}$, serves precisely this purpose, with its diagonal elements representing the variance or uncertainty of each state variable. This exercise explores how to set these values to reflect real-world knowledge about the initial conditions of a system, a fundamental skill for ensuring the filter behaves correctly from the very start. [@problem_id:1587015]", "problem": "An aerospace engineer is tasked with implementing a Kalman filter to estimate the attitude (orientation) of a new nanosatellite. The estimation is simplified to a single axis of rotation. The state vector for the filter is defined as $x_k = \\begin{pmatrix} \\theta_k \\\\ \\omega_k \\end{pmatrix}$, where $\\theta_k$ is the angular position and $\\omega_k$ is the angular velocity at discrete time step $k$.\n\nAt the moment of deployment from the launch vehicle (time $k=0$), a star tracker provides a reasonably precise measurement of the initial angular position, $\\theta_0$. However, a failure in the onboard gyroscope during the deployment sequence means there is no trustworthy information about the satellite's initial angular velocity, $\\omega_0$. The engineering team decides to initialize the state estimate with the measured position and a zero velocity, $\\hat{x}_{0|0} = \\begin{pmatrix} \\theta_0 \\\\ 0 \\end{pmatrix}$.\n\nThe initial state covariance matrix, $P_{0|0}$, which represents the uncertainty in this initial estimate, is initialized as a diagonal matrix:\n$$\nP_{0|0} = \\begin{pmatrix} \\sigma_{\\theta}^2  0 \\\\ 0  \\sigma_{\\omega}^2 \\end{pmatrix}\n$$\nHere, $\\sigma_{\\theta}^2$ is the variance of the error in the initial angular position estimate, and $\\sigma_{\\omega}^2$ is the variance of the error in the initial angular velocity estimate.\n\nTo configure the Kalman filter to properly reflect the high confidence in the initial position measurement and the extreme lack of confidence in the initial velocity assumption, which of the following initialization strategies for the variances is most appropriate?\n\nA. A small value for $\\sigma_{\\theta}^2$ and a large value for $\\sigma_{\\omega}^2$.\n\nB. A large value for $\\sigma_{\\theta}^2$ and a small value for $\\sigma_{\\omega}^2$.\n\nC. Small values for both $\\sigma_{\\theta}^2$ and $\\sigma_{\\omega}^2$.\n\nD. Large values for both $\\sigma_{\\theta}^2$ and $\\sigma_{\\omega}^2$.\n\nE. A small value for $\\sigma_{\\theta}^2$ and set $\\sigma_{\\omega}^2 = 0$, since the initial velocity estimate is set to zero.", "solution": "We are given the initial state estimate $\\hat{x}_{0|0} = \\begin{pmatrix} \\theta_{0} \\\\ 0 \\end{pmatrix}$ and the initial covariance\n$$\nP_{0|0} = \\begin{pmatrix} \\sigma_{\\theta}^{2}  0 \\\\ 0  \\sigma_{\\omega}^{2} \\end{pmatrix}.\n$$\nIn a Kalman filter, the covariance $P$ encodes uncertainty: a smaller variance means higher confidence in the corresponding state component, while a larger variance means lower confidence. The influence of uncertainty on the weighting of new measurements is governed by the Kalman gain\n$$\nK_{k} = P_{k|k-1} H^{T} \\left(H P_{k|k-1} H^{T} + R\\right)^{-1},\n$$\nso larger entries in $P_{k|k-1}$ lead to a larger gain and faster correction by measurements; smaller entries lead to a smaller gain and less correction.\n\nAt $k=0$, the star tracker provides a precise measurement of $\\theta_{0}$, so we should set $\\sigma_{\\theta}^{2}$ small to reflect high confidence in the initial position. There is no trustworthy information about $\\omega_{0}$; the chosen initial value of zero is arbitrary. Therefore, we should set $\\sigma_{\\omega}^{2}$ large to reflect high uncertainty and allow the filter to quickly correct the initial velocity estimate as information becomes available through process dynamics and subsequent measurements.\n\nEvaluating the options:\n- A uses a small $\\sigma_{\\theta}^{2}$ and a large $\\sigma_{\\omega}^{2}$, which correctly encodes high confidence in position and low confidence in velocity.\n- B would wrongly downweight the precise position and overconfidently trust the arbitrary zero velocity.\n- C would be overconfident in the unknown velocity.\n- D would unnecessarily distrust the precise position measurement.\n- E sets $\\sigma_{\\omega}^{2}=0$, implying absolute certainty in the velocity, which is the opposite of the stated lack of confidence and would inhibit necessary corrections.\n\nTherefore, the appropriate choice is A.", "answer": "$$\\boxed{A}$$", "id": "1587015"}, {"introduction": "A Kalman filter's performance relies on the accuracy of its underlying models, but in practice, these models are never perfect. This thought experiment investigates a common real-world challenge: a persistent, unknown bias in a sensor's measurements. Understanding how the filter's estimate responds to such a systematic error is vital for diagnosing and troubleshooting filter behavior in practical applications. [@problem_id:1587014]", "problem": "A one-dimensional Kalman filter is implemented to estimate the velocity, $v$, of a vehicle. The filter operates under the standard assumptions of a linear system with Gaussian noise.\n\nThe vehicle's dynamics are modeled as a random walk, where the velocity at time step $k$ is related to the velocity at the previous step $k-1$ by $v_k = v_{k-1} + w_{k-1}$. Here, $w_{k-1}$ is the process noise, which is a zero-mean Gaussian random variable with variance $Q$. This term accounts for small, unmodeled disturbances like changes in road grade or wind gusts.\n\nThe vehicle's velocity is measured by a single sensor (a speedometer). The measurement at time step $k$, denoted by $z_k$, is modeled as $z_k = v_k + n_k$, where $n_k$ is the measurement noise, a zero-mean Gaussian random variable with variance $R$. The process noise and measurement noise are uncorrelated.\n\nUnbeknownst to the filter designer, the speedometer has a manufacturing defect that introduces a constant, positive bias, $b  0$. Therefore, the actual measurement fed to the filter is not $z_k$, but $z_{k, \\text{biased}} = v_{k, \\text{true}} + b + n_k$, where $v_{k, \\text{true}}$ is the true velocity. The Kalman filter is configured with the standard measurement model (assuming $b=0$) and has been running long enough for its internal parameters, such as the Kalman gain, to reach a steady state.\n\nIn this steady-state condition, which of the following statements best describes the relationship between the filter's estimate of the velocity, $\\hat{v}_k$, and the true velocity, $v_{k, \\text{true}}$? Assume the true velocity is approximately constant over the observation period.\n\nA. The filter's estimate $\\hat{v}_k$ will be, on average, equal to the true velocity $v_{k, \\text{true}}$. The filter's mechanism is robust enough to reject the constant bias.\n\nB. The filter's estimate $\\hat{v}_k$ will diverge, growing infinitely over time.\n\nC. The filter's estimate $\\hat{v}_k$ will be, on average, lower than the true velocity $v_{k, \\text{true}}$.\n\nD. The filter's estimate $\\hat{v}_k$ will oscillate around the true velocity $v_{k, \\text{true}}$.\n\nE. The filter's estimate $\\hat{v}_k$ will be, on average, higher than the true velocity $v_{k, \\text{true}}$.", "solution": "We model the true dynamics and biased measurements as\n$$\nv_{k} = v_{k-1} + w_{k-1}, \\quad z_{k}^{\\text{biased}} = v_{\\text{true}} + b + n_{k},\n$$\nwith zero-mean, uncorrelated Gaussian noises of variances $Q$ and $R$, respectively, and $b0$ a constant bias. The Kalman filter, unaware of $b$, uses the standard measurement model $z_{k} = v_{k} + n_{k}$.\n\nFor the one-dimensional random-walk model with identity state transition and measurement matrices, the Kalman prediction and update equations are\n$$\n\\hat{v}_{k\\mid k-1} = \\hat{v}_{k-1\\mid k-1}, \\quad P_{k\\mid k-1} = P_{k-1\\mid k-1} + Q,\n$$\n$$\nK_{k} = \\frac{P_{k\\mid k-1}}{P_{k\\mid k-1} + R}, \\quad r_{k} = z_{k}^{\\text{biased}} - \\hat{v}_{k\\mid k-1},\n$$\n$$\n\\hat{v}_{k\\mid k} = \\hat{v}_{k\\mid k-1} + K_{k}\\, r_{k}.\n$$\nLet $m_{k\\mid k} = \\mathbb{E}[\\hat{v}_{k\\mid k}]$ and assume $v_{\\text{true}}$ is constant. Using $\\mathbb{E}[n_{k}]=0$, we have\n$$\n\\mathbb{E}[r_{k}] = \\mathbb{E}[z_{k}^{\\text{biased}} - \\hat{v}_{k\\mid k-1}] = v_{\\text{true}} + b - m_{k\\mid k-1}.\n$$\nTaking expectations in the update,\n$$\nm_{k\\mid k} = m_{k\\mid k-1} + K_{k}\\big(v_{\\text{true}} + b - m_{k\\mid k-1}\\big).\n$$\nDefine the mean estimation error relative to the true velocity as $e_{k} = m_{k\\mid k} - v_{\\text{true}}$. Since $m_{k\\mid k-1} = m_{k-1\\mid k-1}$ for this model, we get the scalar recursion\n$$\ne_{k} = (1 - K_{k})\\, e_{k-1} + K_{k}\\, b.\n$$\nIn steady state, $K_{k} \\to K^{\\ast}$ with $0  K^{\\ast}  1$ (because $Q0$, $R0$ imply a positive steady covariance), and the steady-state mean error $e^{\\ast}$ satisfies\n$$\ne^{\\ast} = (1 - K^{\\ast}) e^{\\ast} + K^{\\ast} b \\;\\;\\Longrightarrow\\;\\; K^{\\ast} e^{\\ast} = K^{\\ast} b \\;\\;\\Longrightarrow\\;\\; e^{\\ast} = b.\n$$\nEquivalently, in steady state the innovation has zero mean, $\\mathbb{E}[r_{k}] = 0$, which yields $v_{\\text{true}} + b - \\mathbb{E}[\\hat{v}_{k\\mid k-1}] = 0$ and thus $\\mathbb{E}[\\hat{v}_{k}] = v_{\\text{true}} + b$. Therefore, the filterâ€™s estimate is, on average, higher than the true velocity by exactly the bias $b$. This corresponds to option E.", "answer": "$$\\boxed{E}$$", "id": "1587014"}, {"introduction": "To maintain reliable performance, a Kalman filter must be robust against sudden, anomalous sensor readings, or outliers. This practice introduces a powerful statistical technique known as the chi-squared ($\\chi^2$) test on the Normalized Innovation Squared (NIS), which acts as a \"validation gate\" to identify and reject faulty measurements in real time. Mastering this method is essential for building resilient estimation systems that can operate reliably in unpredictable environments. [@problem_id:1587043]", "problem": "A self-driving vehicle's navigation system uses a Kalman filter to track a leading car. The state of the leading car is modeled in one dimension (longitudinal motion) by its position $p$ and velocity $v$. The state vector at discrete time step $k$ is given by $x_k = [p_k, v_k]^T$.\n\nThe system dynamics are described by a linear state-space model:\n$$x_k = F x_{k-1} + w_{k-1}$$\n$$z_k = H x_k + v_k$$\n\nwhere:\n- $F = \\begin{pmatrix} 1  \\Delta t \\\\ 0  1 \\end{pmatrix}$ is the state transition matrix, with a time step of $\\Delta t = 0.5$ s.\n- $w_{k-1}$ is the process noise, modeled as a zero-mean Gaussian with covariance matrix $Q = \\begin{pmatrix} \\frac{\\Delta t^4}{4}  \\frac{\\Delta t^3}{2} \\\\ \\frac{\\Delta t^3}{2}  \\Delta t^2 \\end{pmatrix} \\sigma_a^2$. The standard deviation of the unmodeled acceleration is $\\sigma_a = 0.2 \\text{ m/s}^2$.\n- $z_k$ is the scalar measurement of the car's position from a RADAR sensor.\n- $H = \\begin{pmatrix} 1  0 \\end{pmatrix}$ is the measurement matrix.\n- $v_k$ is the measurement noise, modeled as a zero-mean Gaussian with variance $R = \\sigma_z^2$, where the sensor's measurement standard deviation is $\\sigma_z = 1.0$ m.\n\nAt the end of time step $k-1$, the filter's posterior state estimate and its error covariance are:\n$$\\hat{x}_{k-1|k-1} = \\begin{pmatrix} 10.0 \\text{ m} \\\\ 2.0 \\text{ m/s} \\end{pmatrix}, \\quad P_{k-1|k-1} = \\begin{pmatrix} 0.5  0.1 \\\\ 0.1  0.2 \\end{pmatrix} \\text{ m}^2 \\text{ or } (\\text{m/s})^2$$\n\nAt time step $k$, a new measurement arrives: $z_k = 15.0$ m.\n\nTo prevent filter divergence due to sensor glitches, a validation gate is applied to each new measurement. This is done by performing a chi-squared ($\\chi^2$) test on the Normalized Innovation Squared (NIS), $\\epsilon_k$. The measurement $z_k$ is rejected as an outlier if its NIS value exceeds a predetermined threshold. For a measurement dimension of 1, the critical value of the $\\chi^2$ distribution for a significance level of $\\alpha = 0.01$ is $\\chi^2_{1, 0.01} = 6.635$.\n\nBased on a chi-squared test with this significance level, what is the calculated NIS value for the measurement $z_k$, and should the measurement be accepted or rejected?\n\nA. The NIS is approximately 9.69, and the measurement should be rejected.\n\nB. The NIS is approximately 9.69, and the measurement should be accepted.\n\nC. The NIS is approximately 15.1, and the measurement should be rejected.\n\nD. The NIS is approximately 5.45, and the measurement should be accepted.\n\nE. The NIS is approximately 5.45, and the measurement should be rejected.", "solution": "We use the standard discrete Kalman filter prediction and innovation equations for a constant-velocity model. The prediction step is\n$$\n\\hat{x}_{k|k-1} = F \\hat{x}_{k-1|k-1}, \\qquad P_{k|k-1} = F P_{k-1|k-1} F^{T} + Q.\n$$\nWith $\\Delta t = 0.5$, we have\n$$\nF = \\begin{pmatrix} 1  0.5 \\\\ 0  1 \\end{pmatrix}, \\quad \\hat{x}_{k-1|k-1} = \\begin{pmatrix} 10.0 \\\\ 2.0 \\end{pmatrix}.\n$$\nTherefore,\n$$\n\\hat{x}_{k|k-1} = \\begin{pmatrix} 1  0.5 \\\\ 0  1 \\end{pmatrix}\\begin{pmatrix} 10.0 \\\\ 2.0 \\end{pmatrix} = \\begin{pmatrix} 11.0 \\\\ 2.0 \\end{pmatrix}.\n$$\nThe process noise covariance for $\\sigma_{a} = 0.2$ is\n$$\nQ = \\begin{pmatrix} \\frac{\\Delta t^{4}}{4}  \\frac{\\Delta t^{3}}{2} \\\\ \\frac{\\Delta t^{3}}{2}  \\Delta t^{2} \\end{pmatrix}\\sigma_{a}^{2}\n= \\begin{pmatrix} \\frac{0.5^{4}}{4}  \\frac{0.5^{3}}{2} \\\\ \\frac{0.5^{3}}{2}  0.5^{2} \\end{pmatrix} (0.2)^{2}\n= \\begin{pmatrix} 0.000625  0.0025 \\\\ 0.0025  0.01 \\end{pmatrix}.\n$$\nCompute $F P_{k-1|k-1} F^{T}$:\n$$\nF P_{k-1|k-1} = \\begin{pmatrix} 1  0.5 \\\\ 0  1 \\end{pmatrix}\\begin{pmatrix} 0.5  0.1 \\\\ 0.1  0.2 \\end{pmatrix} = \\begin{pmatrix} 0.55  0.2 \\\\ 0.1  0.2 \\end{pmatrix},\n$$\n$$\nF P_{k-1|k-1} F^{T} = \\begin{pmatrix} 0.55  0.2 \\\\ 0.1  0.2 \\end{pmatrix}\\begin{pmatrix} 1  0 \\\\ 0.5  1 \\end{pmatrix} = \\beginpmatrix} 0.65  0.2 \\\\ 0.2  0.2 \\end{pmatrix}.\n$$\nThus,\n$$\nP_{k|k-1} = \\begin{pmatrix} 0.65  0.2 \\\\ 0.2  0.2 \\end{pmatrix} + \\begin{pmatrix} 0.000625  0.0025 \\\\ 0.0025  0.01 \\end{pmatrix} = \\begin{pmatrix} 0.650625  0.2025 \\\\ 0.2025  0.21 \\end{pmatrix}.\n$$\nWith $H = \\begin{pmatrix} 1  0 \\end{pmatrix}$, the innovation (measurement residual) is\n$$\ny_{k} = z_{k} - H \\hat{x}_{k|k-1} = 15.0 - 11.0 = 4.0,\n$$\nand the innovation covariance is\n$$\nS_{k} = H P_{k|k-1} H^{T} + R = 0.650625 + (1.0)^{2} = 1.650625.\n$$\nThe Normalized Innovation Squared (NIS) is\n$$\n\\epsilon_{k} = y_{k}^{T} S_{k}^{-1} y_{k} = \\frac{y_{k}^{2}}{S_{k}} = \\frac{16}{1.650625} \\approx 9.69.\n$$\nFor a one-dimensional measurement with significance level $\\alpha = 0.01$, the threshold is $\\chi^{2}_{1,0.01} = 6.635$. Since $9.69  6.635$, the measurement should be rejected as an outlier. This corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "1587043"}]}