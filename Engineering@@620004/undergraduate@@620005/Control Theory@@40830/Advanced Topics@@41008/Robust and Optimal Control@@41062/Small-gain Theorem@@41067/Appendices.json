{"hands_on_practices": [{"introduction": "Real-world control systems are often limited by physical constraints, such as the maximum power an actuator can deliver. This exercise [@problem_id:1611071] explores how to guarantee stability in the presence of such a common nonlinearityâ€”actuator saturation. By modeling the saturation as a nonlinear operator and determining its gain, we can use the small-gain theorem to find the maximum controller gain that keeps the system stable, a fundamental skill in practical control design.", "problem": "A control system is designed to regulate the temperature of a chemical process in a bioreactor. The bioreactor's thermal dynamics are modeled by a linear time-invariant system. The transfer function from the input power of the heater, $v(t)$ in watts (W), to the normalized dimensionless temperature output, $y(t)$, is given by:\n$$P(s) = \\frac{b}{s+a}$$\nwhere the parameters are $a = 0.15 \\text{ s}^{-1}$ and $b = 0.05 \\text{ W}^{-1}\\cdot\\text{s}^{-1}$. The plant is assumed to be stable, with $a > 0$.\n\nA simple proportional controller with a positive gain $K$ is used. It takes the error signal $e(t) = r(t) - y(t)$, where $r(t)$ is the desired reference temperature, and computes a desired heater power $u(t) = K \\cdot e(t)$.\n\nThe heater is the actuator, and it cannot supply infinite power. The actual power $v(t)$ delivered by the heater is constrained by a saturation nonlinearity. If the controller requests power $u(t)$, the delivered power is $v(t) = \\text{sat}(u(t))$, which is defined as:\n$$ v(t) = \\begin{cases} u(t) & \\text{if } |u(t)| \\le P_{max} \\\\ P_{max} \\cdot \\text{sgn}(u(t)) & \\text{if } |u(t)| > P_{max} \\end{cases} $$\nHere, $P_{max}$ is the positive maximum power rating of the heater.\n\nThe closed-loop system can be analyzed as a negative feedback interconnection of a linear system and a nonlinear operator. Using the small-gain theorem, determine the maximum value of the positive controller gain $K$ that guarantees the stability of the closed-loop system for any reference input $r(t)$ and for any positive value of the maximum power $P_{max}$. The gain $K$ has units of $\\text{W}$. Express your answer as a real number. Round your final answer to two significant figures.", "solution": "We view the closed-loop as a Lur'e interconnection between a linear time-invariant system and a static nonlinearity. Define the signals as follows: the controller output is $u(t)=K e(t)=K(r(t)-y(t))$, the actuator output is $v(t)=\\text{sat}(u(t))$, and the plant output is $y(t)$. The plant transfer function from $v$ to $y$ is $P(s)=\\frac{b}{s+a}$ with $a>0$, $b>0$.\n\nIntroduce $w:=u$ (input to the nonlinearity) and $z:=v$ (output of the nonlinearity). The interconnection equations are\n$$\ny = P z, \\quad w = K(r - y) = K r - K P z.\n$$\nThus, the linear map from $z$ to $w$ is $-K P(s)$, and $r$ enters additively as an exogenous input $K r$. The saturation operator $\\text{sat}(\\cdot)$ satisfies the global Lipschitz bound\n$$\n|\\,\\text{sat}(u_{1}) - \\text{sat}(u_{2})\\,| \\le |u_{1} - u_{2}|\n$$\nfor all $u_{1},u_{2}$, so its induced gain is bounded by $1$ in any signal norm. Therefore, by the small-gain theorem, a sufficient condition for input-output stability of the feedback interconnection for any reference input and any positive $P_{max}$ is\n$$\n\\| -K P \\|_{\\infty} \\cdot 1 < 1 \\quad \\Longleftrightarrow \\quad K \\, \\|P\\|_{\\infty} < 1.\n$$\nWe compute the $\\mathcal{H}_{\\infty}$ norm of $P(s)=\\frac{b}{s+a}$. For $\\omega \\in \\mathbb{R}$,\n$$\n|P(j\\omega)| = \\frac{b}{\\sqrt{\\omega^{2}+a^{2}}},\n$$\nwhich is strictly decreasing in $|\\omega|$ because the denominator $\\sqrt{\\omega^{2}+a^{2}}$ increases with $|\\omega|$. Hence the maximum occurs at $\\omega=0$, yielding\n$$\n\\|P\\|_{\\infty} = \\sup_{\\omega} |P(j\\omega)| = \\frac{b}{a}.\n$$\nThe small-gain condition becomes\n$$\nK \\cdot \\frac{b}{a} < 1 \\quad \\Longleftrightarrow \\quad K < \\frac{a}{b}.\n$$\nWith the given parameters $a=0.15$ and $b=0.05$, we obtain\n$$\nK_{\\max} = \\frac{a}{b} = \\frac{0.15}{0.05} = 3.\n$$\nRounding to two significant figures gives $3.0$.", "answer": "$$\\boxed{3.0}$$", "id": "1611071"}, {"introduction": "Our models of systems are rarely perfect, and robust control theory provides tools to design controllers that work despite this uncertainty. This practice [@problem_id:1611051] delves into robust stability for a discrete-time system with multiplicative uncertainty, a standard framework for representing unmodeled dynamics. You will investigate how a common practical issue, computational delay, degrades the system's stability margin, providing a quantitative understanding of the performance costs associated with digital implementation.", "problem": "A discrete-time control system is designed to regulate a process. The process is modeled by a stable, first-order Linear Time-Invariant (LTI) plant with a transfer function $P(z) = \\frac{1}{z-0.8}$. A simple proportional controller, $C(z) = 0.4$, is used in a standard unity feedback configuration.\n\nAfter implementation, it is found that the true plant, $P_{\\text{true}}(z)$, deviates from the model $P(z)$ due to unmodeled dynamics. This relationship is captured by a multiplicative uncertainty model: $P_{\\text{true}}(z) = P(z) (1 + W(z)\\Delta(z))$. Here, the uncertainty frequency weight is a constant, $W(z) = 0.5$, and $\\Delta(z)$ is any unknown but stable LTI system whose magnitude on the unit circle is bounded by one, i.e., $| \\Delta(e^{j\\omega}) | \\le 1$ for all frequencies $\\omega$.\n\nThe robust stability margin, denoted by $k_m$, is defined as the maximum value such that the closed-loop system remains stable for all possible perturbations $\\Delta(z)$ satisfying $| \\Delta(e^{j\\omega}) | < k_m$.\n\nFirst, consider the nominal design where the controller is $C(z)=0.4$. Let the robust stability margin for this system be $k_{m,1}$.\n\nNext, consider a scenario where a single-step computational delay is introduced into the control loop. This delay effectively modifies the controller to become $C_d(z) = C(z) z^{-1}$. Let the robust stability margin for this new system with the delayed controller be $k_{m,2}$.\n\nDetermine the ratio of the robust stability margin of the delayed system to that of the original system, $R = \\frac{k_{m,2}}{k_{m,1}}$. Report your answer as a single real number rounded to three significant figures.", "solution": "We use the standard multiplicative plant uncertainty model $P_{\\text{true}}(z) = P(z)\\bigl(1 + W(z)\\Delta(z)\\bigr)$ with $W(z) = \\frac{1}{2}$ and $|\\Delta(e^{j\\omega})| \\le 1$. For unity feedback, the robust stability condition under multiplicative uncertainty is given by the small-gain theorem applied to the complementary sensitivity $T(z) = \\frac{L(z)}{1 + L(z)}$ with $L(z) = P(z)C(z)$. Specifically, if we allow $|\\Delta(e^{j\\omega})| < k$, then robust stability is guaranteed when\n$$\n\\|k\\,W\\,T\\|_{\\infty} < 1,\n$$\nso the robust stability margin is\n$$\nk_{m} = \\frac{1}{\\|W T\\|_{\\infty}}.\n$$\n\nNominal controller $C(z) = \\frac{2}{5}$:\nThe loop is $L_{1}(z) = P(z)C(z) = \\frac{\\frac{2}{5}}{z - \\frac{4}{5}}$. The complementary sensitivity is\n$$\nT_{1}(z) = \\frac{L_{1}(z)}{1 + L_{1}(z)} = \\frac{\\frac{2}{5}}{z - \\frac{2}{5}}.\n$$\nOn the unit circle $z = \\exp(j\\omega)$, its magnitude is\n$$\n|T_{1}(e^{j\\omega})| = \\frac{\\frac{2}{5}}{|\\exp(j\\omega) - \\frac{2}{5}|}, \\quad |\\exp(j\\omega) - a|^{2} = 1 - 2 a \\cos\\omega + a^{2}.\n$$\nWith $a = \\frac{2}{5}$, the denominator magnitude is minimized at $\\cos\\omega = 1$, giving $\\min_{\\omega}|\\exp(j\\omega) - \\frac{2}{5}| = 1 - \\frac{2}{5} = \\frac{3}{5}$. Hence\n$$\n\\|T_{1}\\|_{\\infty} = \\frac{\\frac{2}{5}}{\\frac{3}{5}} = \\frac{2}{3}, \\quad \\|W T_{1}\\|_{\\infty} = \\frac{1}{2}\\cdot\\frac{2}{3} = \\frac{1}{3},\n$$\nand therefore\n$$\nk_{m,1} = \\frac{1}{\\|W T_{1}\\|_{\\infty}} = 3.\n$$\n\nDelayed controller $C_{d}(z) = C(z) z^{-1} = \\frac{2}{5} z^{-1}$:\nThe loop is $L_{2}(z) = \\frac{\\frac{2}{5} z^{-1}}{z - \\frac{4}{5}}$, and\n$$\nT_{2}(z) = \\frac{L_{2}(z)}{1 + L_{2}(z)} = \\frac{\\frac{2}{5} z^{-1}}{z - \\frac{4}{5} + \\frac{2}{5} z^{-1}} = \\frac{\\frac{2}{5}}{z^{2} - \\frac{4}{5} z + \\frac{2}{5}}.\n$$\nOn the unit circle $z = \\exp(j\\omega)$, write $c = \\cos\\omega$. Then the denominator magnitude squared is\n$$\n\\left|e^{j2\\omega} - \\frac{4}{5} e^{j\\omega} + \\frac{2}{5}\\right|^{2} = 1.6\\,c^{2} - 2.24\\,c + 1 = \\frac{8}{5}c^{2} - \\frac{56}{25}c + 1.\n$$\nDefine $g(c) = \\frac{8}{5}c^{2} - \\frac{56}{25}c + 1$ for $c \\in [-1,1]$. This convex quadratic attains its minimum at $c^{\\star} = \\frac{56/25}{2\\cdot 8/5} = \\frac{7}{10}$, yielding\n$$\ng(c^{\\star}) = \\frac{27}{125}.\n$$\nTherefore\n$$\n\\|T_{2}\\|_{\\infty} = \\frac{\\frac{2}{5}}{\\sqrt{27/125}} = \\frac{2}{3}\\sqrt{\\frac{5}{3}}, \\quad \\|W T_{2}\\|_{\\infty} = \\frac{1}{2}\\cdot \\frac{2}{3}\\sqrt{\\frac{5}{3}} = \\frac{1}{3}\\sqrt{\\frac{5}{3}},\n$$\nand hence\n$$\nk_{m,2} = \\frac{1}{\\|W T_{2}\\|_{\\infty}} = 3\\sqrt{\\frac{3}{5}}.\n$$\n\nThe requested ratio is\n$$\nR = \\frac{k_{m,2}}{k_{m,1}} = \\frac{3\\sqrt{3/5}}{3} = \\sqrt{\\frac{3}{5}}.\n$$\nNumerically, $R \\approx 0.774596669\\ldots$, which rounded to three significant figures is $0.775$.", "answer": "$$\\boxed{0.775}$$", "id": "1611051"}, {"introduction": "The small-gain theorem's utility extends beyond static nonlinearities or time-invariant uncertainties to systems with time-varying components. In this problem [@problem_id:1611065], we analyze a system with a periodically fluctuating gain, which could represent component aging or environmental cycles. This exercise demonstrates the theorem's power and versatility by showing how to establish a stability condition based on the maximum possible gain of the time-varying element, regardless of how fast it changes.", "problem": "A feedback control system is constructed by interconnecting a stable Linear Time-Invariant (LTI) system, denoted by $G$, with a time-varying multiplier, $k(t)$. The output of $G$, let's call it $y_G$, is fed as the input to the multiplier. The output of the multiplier, $y_k$, is then subtracted from an external reference signal $u$ to produce the input for $G$. That is, the input to $G$ is $e_G = u - y_k$.\n\nThe stable LTI system $G$ is known to have an induced $L_2$-gain of $\\gamma_G$. The induced $L_2$-gain of a system is defined as the smallest non-negative number $\\gamma$ such that the $L_2$-norm of its output is bounded by $\\gamma$ times the $L_2$-norm of its input for all possible inputs.\n\nThe time-varying multiplier $k(t)$ is characterized by the relation $y_k(t) = k(t) y_G(t)$, where the gain function is a pure sinusoid with a DC offset, given by\n$$k(t) = A + B \\sin(\\omega t)$$\nHere, $A$, $B$, and $\\omega$ are real constants. This model can represent a system component with a nominal gain $A$ subject to periodic fluctuations of amplitude $|B|$.\n\nTo ensure the stability of the entire closed-loop system for all possible values of $\\omega$ and any initial state, a conservative stability criterion must be used. Assuming that the parameters are such that a stable solution is possible (specifically, that $1 - \\gamma_G |A| > 0$), determine the maximum permissible magnitude of the oscillatory component, $|B|$, that guarantees the stability of the closed-loop system based on the small-gain theorem.\n\nExpress your answer as a closed-form analytic expression in terms of $\\gamma_G$ and $A$.", "solution": "Let $G$ be a stable LTI system with induced $L_{2}$-gain $\\gamma_{G}$, so for all inputs $e_{G}$,\n$$\n\\|y_{G}\\|_{2} \\leq \\gamma_{G}\\|e_{G}\\|_{2}.\n$$\nThe time-varying multiplier $k(t)$ maps $y_{G}$ to $y_{k}$ via $y_{k}(t)=k(t)y_{G}(t)$ with $k(t)=A+B\\sin(\\omega t)$. The induced $L_{2}$-gain of the multiplication operator $K$ is the essential supremum of $|k(t)|$:\n$$\n\\gamma_{K}=\\operatorname{ess\\,sup}_{t}|k(t)|=\\sup_{s\\in[-1,1]}|A+Bs|.\n$$\nSince $A+Bs$ ranges over the interval $[A-|B|,A+|B|]$, its maximum absolute value is\n$$\n\\gamma_{K}=|A|+|B|.\n$$\nIn the feedback interconnection $e_{G}=u-y_{k}$, we have\n$$\n\\|y_{G}\\|_{2} \\leq \\gamma_{G}\\|e_{G}\\|_{2}=\\gamma_{G}\\|u-y_{k}\\|_{2}\\leq \\gamma_{G}\\|u\\|_{2}+\\gamma_{G}\\|y_{k}\\|_{2}\\leq \\gamma_{G}\\|u\\|_{2}+\\gamma_{G}\\gamma_{K}\\|y_{G}\\|_{2}.\n$$\nRearranging yields\n$$\n\\left(1-\\gamma_{G}\\gamma_{K}\\right)\\|y_{G}\\|_{2}\\leq \\gamma_{G}\\|u\\|_{2}.\n$$\nBy the small-gain theorem, the closed-loop is $L_{2}$-stable for all $\\omega$ if\n$$\n\\gamma_{G}\\gamma_{K}<1.\n$$\nSubstituting $\\gamma_{K}=|A|+|B|$ gives\n$$\n\\gamma_{G}\\left(|A|+|B|\\right)<1 \\quad \\Longrightarrow \\quad |B|<\\frac{1}{\\gamma_{G}}-|A|.\n$$\nUnder the stated assumption $1-\\gamma_{G}|A|>0$, the right-hand side is positive, and the largest admissible oscillation magnitude that guarantees stability is\n$$\n|B|_{\\max}=\\frac{1}{\\gamma_{G}}-|A|.\n$$\nThis bound is independent of $\\omega$, thus valid for all $\\omega$.", "answer": "$$\\boxed{\\frac{1}{\\gamma_{G}}-|A|}$$", "id": "1611065"}]}