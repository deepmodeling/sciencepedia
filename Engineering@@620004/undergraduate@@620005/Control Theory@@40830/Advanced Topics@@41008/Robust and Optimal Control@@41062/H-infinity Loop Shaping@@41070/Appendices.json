{"hands_on_practices": [{"introduction": "The H-infinity loop shaping design process begins with representing the system, or 'plant', in a specific mathematical framework. This representation, known as a normalized coprime factorization, breaks down the plant's transfer function into a ratio of two stable and proper functions. This exercise is a fundamental check of understanding, asking you to verify whether a given pair of functions qualifies as a normalized coprime factorization by testing the three core conditions: the factorization itself ($G=NM^{-1}$), the Bezout identity, and the normalization property.", "problem": "In modern robust control theory, a plant with a transfer function $G(s)$ can be represented as a fraction of two stable transfer functions, a method known as coprime factorization. A specific type, the normalized right coprime factorization, is particularly useful in H-infinity controller synthesis.\n\nA pair of stable and proper transfer functions, $(N(s), M(s))$, is a normalized right coprime factorization of a plant $G(s)$ if it satisfies the following three conditions:\n1.  $G(s) = N(s)M(s)^{-1}$\n2.  The Bezout identity is satisfied: there exist stable and proper transfer functions $X(s)$ and $Y(s)$ such that $X(s)N(s) + Y(s)M(s) = 1$.\n3.  The normalization condition is met: $N(s)N(-s) + M(s)M(-s) = 1$.\n\nConsider a plant with the transfer function $G(s) = s+1$. A control engineer proposes the following pair of transfer functions as a potential normalized right coprime factorization:\n$$N(s) = \\frac{s+1}{s+2}$$\n$$M(s) = \\frac{1}{s+2}$$\n\nDetermine which of the following statements is true regarding the proposed factorization $(N(s), M(s))$ for the plant $G(s)$.\n\nA. The pair is not a valid factorization because $N(s)$ or $M(s)$ is unstable.\n\nB. The pair is a valid coprime factorization ($G=NM^{-1}$ and the Bezout identity holds), but it is not normalized.\n\nC. The pair satisfies the normalization condition, but it is not a valid factorization for $G(s)$ because $G(s) \\neq N(s)M(s)^{-1}$.\n\nD. The pair is a valid normalized right coprime factorization of $G(s)$.\n\nE. The pair is not a valid coprime factorization because the Bezout identity cannot be satisfied with stable, proper $X(s)$ and $Y(s)$.", "solution": "We first verify stability and properness of the proposed factors. The transfer functions are $N(s)=\\frac{s+1}{s+2}$ and $M(s)=\\frac{1}{s+2}$. Each has a single pole at $s=-2$, which lies in the open left half-plane, so both are stable. Both are proper because the degree of each numerator does not exceed the degree of its denominator.\n\nNext, we check the factorization condition $G(s)=N(s)M(s)^{-1}$. Since $M(s)^{-1}=s+2$, we get\n$$\nN(s)M(s)^{-1}=\\frac{s+1}{s+2}\\,(s+2)=s+1=G(s).\n$$\nThus, the factorization condition is satisfied.\n\nWe now verify the Bezout identity. We seek stable, proper $X(s)$ and $Y(s)$ such that $X(s)N(s)+Y(s)M(s)=1$. Multiply the desired identity by $(s+2)^2$ to clear denominators:\n$$\n\\left[X(s)\\frac{s+1}{s+2}+Y(s)\\frac{1}{s+2}\\right](s+2)^2=1\\cdot(s+2)^2.\n$$\nEquivalently,\n$$\nX(s)(s+1)(s+2)+Y(s)(s+2)=(s+2)^2.\n$$\nChoose a common proper, stable denominator $Q(s)=s+2$ and set $X(s)=\\frac{P(s)}{Q(s)}$, $Y(s)=\\frac{R(s)}{Q(s)}$ with $P(s)$ and $R(s)$ polynomials of degree at most one so that $X,Y\\in \\mathcal{RH}_{\\infty}$. Then\n$$\n\\frac{P(s)}{s+2}(s+1)(s+2)+\\frac{R(s)}{s+2}(s+2)=(s+2)^2\n$$\nreduces to\n$$\nP(s)(s+1)+R(s)=(s+2)^2.\n$$\nLet $P(s)=as+b$ and $R(s)=cs+d$. Matching coefficients against $(s+2)^2=s^2+4s+4$ yields\n$$\na=1,\\quad a+b+c=4,\\quad b+d=4.\n$$\nOne valid choice is $b=0$, $c=3$, $d=4$, giving $P(s)=s$ and $R(s)=3s+4$. Hence\n$$\nX(s)=\\frac{s}{s+2},\\qquad Y(s)=\\frac{3s+4}{s+2},\n$$\nwhich are stable and proper, and\n$$\nX(s)N(s)+Y(s)M(s)=\\frac{s}{s+2}\\cdot\\frac{s+1}{s+2}+\\frac{3s+4}{s+2}\\cdot\\frac{1}{s+2}\n=\\frac{s^2+4s+4}{(s+2)^2}=1.\n$$\nTherefore, the Bezout identity holds.\n\nFinally, we check the normalization condition $N(s)N(-s)+M(s)M(-s)=1$. Compute\n$$\nN(s)N(-s)=\\frac{s+1}{s+2}\\cdot\\frac{1-s}{2-s}=\\frac{(s+1)(-(s-1))}{(s+2)(-(s-2))}=\\frac{s^{2}-1}{s^{2}-4},\n$$\nand\n$$\nM(s)M(-s)=\\frac{1}{s+2}\\cdot\\frac{1}{2-s}=-\\frac{1}{(s+2)(s-2)}=-\\frac{1}{s^{2}-4}.\n$$\nThus,\n$$\nN(s)N(-s)+M(s)M(-s)=\\frac{s^{2}-1}{s^{2}-4}-\\frac{1}{s^{2}-4}=\\frac{s^{2}-2}{s^{2}-4}\\neq 1.\n$$\nTherefore, the proposed pair is a valid coprime factorization but not normalized.\n\nThe correct statement is B.", "answer": "$$\\boxed{B}$$", "id": "1578958"}, {"introduction": "After representing the plant correctly, the next step is 'loop shaping,' where we use pre- and post-compensators (also called weighting functions) to mold the system's frequency response. The goal is to achieve desirable characteristics like good performance at low frequencies and stability at high frequencies. This practice problem allows you to get your hands on this core concept by calculating the gain crossover frequency, the point where the magnitude of the shaped loop is exactly one ($|G_s(j\\omega)| = 1$), which is a critical indicator of the closed-loop system's bandwidth.", "problem": "Consider the design of a simplified vertical altitude controller for a small quadcopter drone. The linearized dynamics from the commanded motor thrust to the resulting vertical velocity can be modeled by a first-order plant, $G(s)$. In a loop-shaping control design framework, the nominal plant is augmented with weighting functions, also known as compensators, to achieve desired performance characteristics.\n\nThe plant is given by the transfer function:\n$$G(s) = \\frac{K}{s+a}$$\nwhere $K$ and $a$ are positive real constants representing the system's DC gain and pole location, respectively.\n\nTo improve performance, a proportional pre-compensator, $W_1(s)$, and an integral post-compensator, $W_2(s)$, are introduced. Their transfer functions are:\n$$W_1(s) = k_p$$\n$$W_2(s) = \\frac{k_i}{s}$$\nwhere $k_p$ and $k_i$ are positive real gains.\n\nThe \"shaped plant,\" denoted as $G_s(s)$, is formed by cascading these elements in the order $W_2(s)$, $G(s)$, and $W_1(s)$.\n\nDetermine the angular frequency $\\omega > 0$ at which the magnitude of the frequency response of the shaped plant, $|G_s(j\\omega)|$, is equal to unity. Express your answer as a formula in terms of $K$, $a$, $k_p$, and $k_i$.", "solution": "The shaped plant is the cascade of $W_{2}(s)$, $G(s)$, and $W_{1}(s)$:\n$$\nG_{s}(s)=W_{2}(s)\\,G(s)\\,W_{1}(s)=\\frac{k_{i}}{s}\\cdot\\frac{K}{s+a}\\cdot k_{p}=\\frac{k_{p}k_{i}K}{s(s+a)}.\n$$\nEvaluating the frequency response at $s=j\\omega$ gives\n$$\nG_{s}(j\\omega)=\\frac{k_{p}k_{i}K}{(j\\omega)(j\\omega+a)}.\n$$\nThe magnitude is\n$$\n\\left|G_{s}(j\\omega)\\right|=\\frac{k_{p}k_{i}K}{|j\\omega|\\;|j\\omega+a|}=\\frac{k_{p}k_{i}K}{\\omega\\,\\sqrt{a^{2}+\\omega^{2}}}.\n$$\nImposing $\\left|G_{s}(j\\omega)\\right|=1$ yields\n$$\n\\frac{k_{p}k_{i}K}{\\omega\\,\\sqrt{a^{2}+\\omega^{2}}}=1 \\;\\;\\Longrightarrow\\;\\; \\omega\\,\\sqrt{a^{2}+\\omega^{2}}=k_{p}k_{i}K.\n$$\nSquaring both sides and defining $x=\\omega^{2}$ gives a quadratic in $x$:\n$$\n\\omega^{2}\\left(a^{2}+\\omega^{2}\\right)=(k_{p}k_{i}K)^{2}\\;\\;\\Longrightarrow\\;\\; x^{2}+a^{2}x-(k_{p}k_{i}K)^{2}=0.\n$$\nSolving for $x$ and selecting the nonnegative root,\n$$\nx=\\frac{-a^{2}+\\sqrt{a^{4}+4(k_{p}k_{i}K)^{2}}}{2},\n$$\nhence\n$$\n\\omega=\\sqrt{x}=\\sqrt{\\frac{-a^{2}+\\sqrt{a^{4}+4(k_{p}k_{i}K)^{2}}}{2}}.\n$$\nThis $\\omega>0$ satisfies $\\left|G_{s}(j\\omega)\\right|=1$.", "answer": "$$\\boxed{\\sqrt{\\frac{-a^{2}+\\sqrt{a^{4}+4\\left(k_{p}k_{i}K\\right)^{2}}}{2}}}$$", "id": "1578985"}, {"introduction": "The ultimate goal of H-infinity loop shaping is to design a controller that is not only stable but also robust against uncertainties in the plant model. The design process yields a crucial number, the stability margin $\\epsilon$, which quantifies this robustness against coprime factor perturbations. This final exercise challenges you to interpret the meaning of this stability margin by relating it to the maximum allowable size of perturbations, thereby solidifying your understanding of how H-infinity control guarantees robust stability.", "problem": "A control systems engineer is developing a controller for a single-input, single-output (SISO) electro-magnetic actuator using the H-infinity loop shaping method. The plant is represented by its normalized coprime factorization $P = N M^{-1}$. The resulting design guarantees closed-loop stability for any perturbed plant $P_{\\Delta} = (N+\\Delta_N)(M+\\Delta_M)^{-1}$ as long as the H-infinity norm of the perturbation pair, $\\|[\\Delta_N, \\Delta_M]\\|_{\\infty}$, is less than the stability margin, which was calculated to be $\\epsilon = 0.25$.\n\nIn addition to this standard robustness guarantee, the engineer wants to evaluate a different robustness metric. They are interested in the maximum possible magnitude of the sum of the two perturbation factors. Let this metric be the \"summed perturbation norm\", defined as $\\|\\Delta_N + \\Delta_M\\|_{\\infty}$.\n\nAssuming the worst-case allowable perturbation (i.e., a perturbation whose norm approaches the stability margin $\\epsilon$), what is the maximum possible value for the summed perturbation norm? Express your answer as a real number rounded to three significant figures.", "solution": "Let the plant be given in normalized coprime factorization $P = N M^{-1}$, and consider SISO perturbations $\\Delta_{N}$ and $\\Delta_{M}$. The robustness condition is that the $\\mathcal{H}_{\\infty}$ norm of the row transfer matrix $[\\Delta_{N},\\,\\Delta_{M}]$ satisfies\n$$\n\\|[\\Delta_{N},\\,\\Delta_{M}]\\|_{\\infty} \\leq \\epsilon,\n$$\nwhere in the worst-case allowable sense the norm approaches $\\epsilon$.\n\nFor SISO systems, the $\\mathcal{H}_{\\infty}$ norm of the row matrix equals the supremum (over frequency) of the Euclidean norm of its entries:\n$$\n\\|[\\Delta_{N},\\,\\Delta_{M}]\\|_{\\infty} \\;=\\; \\sup_{\\omega} \\sqrt{|\\Delta_{N}(\\mathrm{j}\\omega)|^{2} + |\\Delta_{M}(\\mathrm{j}\\omega)|^{2}}.\n$$\nThus, pointwise in frequency,\n$$\n\\sqrt{|\\Delta_{N}(\\mathrm{j}\\omega)|^{2} + |\\Delta_{M}(\\mathrm{j}\\omega)|^{2}} \\;\\leq\\; \\epsilon.\n$$\n\nThe summed perturbation norm is\n$$\n\\|\\Delta_{N} + \\Delta_{M}\\|_{\\infty} \\;=\\; \\sup_{\\omega} |\\Delta_{N}(\\mathrm{j}\\omega) + \\Delta_{M}(\\mathrm{j}\\omega)|.\n$$\nFor each frequency, apply the Cauchy–Schwarz inequality to the vectors $[1,\\,1]$ and $[\\Delta_{N}(\\mathrm{j}\\omega),\\,\\Delta_{M}(\\mathrm{j}\\omega)]^{\\top}$:\n$$\n|\\Delta_{N}(\\mathrm{j}\\omega) + \\Delta_{M}(\\mathrm{j}\\omega)| \\;=\\; |[1,\\,1]\\,[\\Delta_{N}(\\mathrm{j}\\omega),\\,\\Delta_{M}(\\mathrm{j}\\omega)]^{\\top}|\n\\;\\leq\\; \\|[1,\\,1]\\|_{2}\\,\\sqrt{|\\Delta_{N}(\\mathrm{j}\\omega)|^{2} + |\\Delta_{M}(\\mathrm{j}\\omega)|^{2}}\n\\;=\\; \\sqrt{2}\\,\\sqrt{|\\Delta_{N}(\\mathrm{j}\\omega)|^{2} + |\\Delta_{M}(\\mathrm{j}\\omega)|^{2}}.\n$$\nUsing the robustness constraint, this yields the pointwise bound\n$$\n|\\Delta_{N}(\\mathrm{j}\\omega) + \\Delta_{M}(\\mathrm{j}\\omega)| \\;\\leq\\; \\sqrt{2}\\,\\epsilon,\n$$\nand hence\n$$\n\\|\\Delta_{N} + \\Delta_{M}\\|_{\\infty} \\;\\leq\\; \\sqrt{2}\\,\\epsilon.\n$$\n\nTightness: equality in Cauchy–Schwarz is achieved when $\\Delta_{N}$ and $\\Delta_{M}$ have the same phase and equal magnitudes, for example by choosing stable constants $\\Delta_{N}(s) = \\Delta_{M}(s) = \\epsilon/\\sqrt{2}$, which satisfy $\\|[\\Delta_{N},\\,\\Delta_{M}]\\|_{\\infty} = \\epsilon$ and yield $|\\Delta_{N} + \\Delta_{M}| = \\sqrt{2}\\,\\epsilon$ at all frequencies. Under the strict inequality constraint, one can approach this value arbitrarily closely. Therefore, the maximum possible summed perturbation norm (in the worst-case allowable sense) equals $\\sqrt{2}\\,\\epsilon$.\n\nWith $\\epsilon = 0.25$, the maximum is\n$$\n\\sqrt{2}\\times 0.25 = 0.353553\\ldots,\n$$\nwhich rounded to three significant figures is $0.354$.", "answer": "$$\\boxed{0.354}$$", "id": "1578940"}]}