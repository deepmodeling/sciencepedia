{"hands_on_practices": [{"introduction": "The most direct approach to designing a deadbeat controller involves pole-zero cancellation. This exercise puts this core concept into practice, where you will design a controller that precisely inverts the stable dynamics of a given plant. By doing so, you can impose a desired closed-loop response that settles in the minimum possible time, providing a foundational skill for digital control design. [@problem_id:1567944]", "problem": "Consider a digital control system where the discrete-time transfer function of the plant is given by:\n$$G_p(z) = \\frac{1}{z(z - 0.5)}$$\nA digital controller, with transfer function $G_c(z)$, is to be designed for this plant in a unity feedback configuration. The control objective is to achieve a deadbeat response for a unit step input. A deadbeat response is defined as a response where the system output reaches the final steady-state value in the minimum possible number of sampling periods and remains at that value for all subsequent time.\n\nDetermine the transfer function $G_c(z)$ of the controller that achieves this deadbeat response. Your answer should be an expression in terms of $z$.", "solution": "We are given the discrete-time plant transfer function\n$$G_{p}(z) = \\frac{1}{z\\left(z - \\frac{1}{2}\\right)}.$$\nIn unity feedback, the closed-loop transfer function is\n$$T(z) = \\frac{Y(z)}{R(z)} = \\frac{G_{c}(z)G_{p}(z)}{1 + G_{c}(z)G_{p}(z)}.$$\nA deadbeat step response requires the output to reach its final value in a finite number of sampling instants and remain there. For a plant that can be written with an explicit delay factor as powers of $z^{-1}$, the minimum achievable settling time equals the pure delay. Rewrite the plant to expose the delay:\n$$G_{p}(z) = \\frac{1}{z\\left(z - \\frac{1}{2}\\right)} = \\frac{z^{-2}}{1 - \\frac{1}{2}z^{-1}}.$$\nThis shows a two-sample delay. The deadbeat choice for the closed-loop transfer function that achieves unity steady-state gain and minimum possible settling time is\n$$T(z) = z^{-2} = \\frac{1}{z^{2}}.$$\nLet the loop transfer function be $L(z) = G_{c}(z)G_{p}(z)$. Then\n$$T(z) = \\frac{L(z)}{1+L(z)}.$$\nImposing $T(z) = z^{-2}$ gives\n$$z^{-2} = \\frac{L(z)}{1+L(z)} \\;\\;\\Longrightarrow\\;\\; z^{-2}\\left(1+L(z)\\right) = L(z) \\;\\;\\Longrightarrow\\;\\; z^{-2} = L(z)\\left(1 - z^{-2}\\right).$$\nHence,\n$$L(z) = \\frac{z^{-2}}{1 - z^{-2}} = \\frac{1}{z^{2} - 1}.$$\nSince $L(z) = G_{c}(z)G_{p}(z)$, solve for $G_{c}(z)$:\n$$G_{c}(z) = \\frac{L(z)}{G_{p}(z)} = \\frac{\\frac{1}{z^{2} - 1}}{\\frac{1}{z\\left(z - \\frac{1}{2}\\right)}} = \\frac{z\\left(z - \\frac{1}{2}\\right)}{z^{2} - 1}.$$\nVerification: With this $G_{c}(z)$,\n$$L(z) = \\frac{z\\left(z - \\frac{1}{2}\\right)}{z^{2} - 1}\\cdot \\frac{1}{z\\left(z - \\frac{1}{2}\\right)} = \\frac{1}{z^{2} - 1},$$\nso\n$$T(z) = \\frac{L(z)}{1+L(z)} = \\frac{\\frac{1}{z^{2} - 1}}{1 + \\frac{1}{z^{2} - 1}} = \\frac{1}{z^{2}} = z^{-2},$$\nwhich yields $y[k] = r[k-2]$ for a unit step input, i.e., the output reaches the final value in two samples (the minimum possible due to the two-sample delay) and remains there. Also, $T(1) = 1$, ensuring zero steady-state error for a step input.\nTherefore, the deadbeat controller is\n$$G_{c}(z) = \\frac{z\\left(z - \\frac{1}{2}\\right)}{z^{2} - 1}.$$", "answer": "$$\\boxed{\\frac{z\\left(z-\\frac{1}{2}\\right)}{z^{2}-1}}$$", "id": "1567944"}, {"introduction": "In the real world, our models are never perfect. This practice problem acts as a compelling thought experiment, exploring the critical consequences of model uncertainty in deadbeat control. By analyzing a scenario where a controller based on an incomplete model fails, you will learn to diagnose control system failures and appreciate why the seemingly perfect cancellation of poles and zeros can be a fragile strategy. [@problem_id:1567929]", "problem": "A control engineer is tasked with designing a digital controller for a chemical process. Based on initial system identification, the process is modeled by the discrete-time transfer function:\n$$P_{model}(z) = \\frac{K_m}{z-a}$$\nwith the parameters identified as $a = 0.9$ and $K_m = 2.0$.\n\nThe engineer designs a deadbeat controller intended to achieve a minimal (one-step) settling time for the closed-loop system's response to a reference input. The design target for the closed-loop transfer function from the reference signal to the plant output is therefore $T_{ref}(z) = z^{-1}$.\n\nUpon implementing the controller on the actual physical plant, the engineer observes that the system does not settle as expected. Instead, for any non-zero initial condition or disturbance, the output exhibits a persistent, non-decaying sinusoidal oscillation with a period of exactly 8 sampling intervals.\n\nA more detailed analysis reveals that the initial model was incomplete. The actual plant transfer function is of a higher order:\n$$P_{actual}(z) = \\frac{K_a}{(z-a)(z-p_u)}$$\nThe pole at $z=a$ was correctly identified, but an additional unmodeled pole at $z=p_u$ and a different true gain constant $K_a$ were present.\n\nAssuming the controller was designed and implemented exactly as specified by the initial model and deadbeat criterion, determine the location of the unmodeled pole, $p_u$, and the ratio of the actual gain to the modeled gain, $\\gamma = \\frac{K_a}{K_m}$. Present your final answer as two exact analytic expressions for $p_u$ and $\\gamma$.", "solution": "The model used for design is $P_{model}(z) = \\dfrac{K_{m}}{z-a}$. With unity feedback and controller $C(z)$, the closed-loop transfer from reference to output is\n$$\nT(z) = \\frac{P_{model}(z) C(z)}{1 + P_{model}(z) C(z)}.\n$$\nThe deadbeat design target is $T_{ref}(z) = z^{-1}$. Let $L(z) \\equiv P_{model}(z) C(z)$. Enforcing $T(z) = z^{-1}$ gives\n$$\n\\frac{L(z)}{1 + L(z)} = z^{-1} \\;\\;\\Rightarrow\\;\\; z^{-1} \\bigl(1 + L(z)\\bigr) = L(z) \\;\\;\\Rightarrow\\;\\; z^{-1} = L(z)\\bigl(1 - z^{-1}\\bigr),\n$$\nhence\n$$\nL(z) = \\frac{z^{-1}}{1 - z^{-1}} = \\frac{1}{z - 1}.\n$$\nTherefore the controller that achieves $T_{ref}(z)$ for the model is obtained from $P_{model}(z) C(z) = \\dfrac{1}{z - 1}$:\n$$\nC(z) = \\frac{1}{z - 1}\\,\\frac{z - a}{K_{m}} = \\frac{z - a}{K_{m}(z - 1)}.\n$$\n\nThe actual plant is $P_{actual}(z) = \\dfrac{K_{a}}{(z - a)(z - p_{u})}$. Implementing the designed controller on the actual plant yields the actual loop transfer\n$$\nL_{actual}(z) = P_{actual}(z) C(z) = \\frac{K_{a}}{(z - a)(z - p_{u})}\\,\\frac{z - a}{K_{m}(z - 1)} = \\frac{\\gamma}{(z - p_{u})(z - 1)},\n$$\nwhere $\\gamma \\equiv \\dfrac{K_{a}}{K_{m}}$.\n\nWith unity feedback, the closed-loop characteristic equation is $1 + L_{actual}(z) = 0$, i.e.,\n$$\n(z - p_{u})(z - 1) + \\gamma = 0,\n$$\nor equivalently the monic characteristic polynomial\n$$\nz^{2} - (1 + p_{u}) z + (p_{u} + \\gamma) = 0.\n$$\n\nThe observed undamped sinusoidal oscillation with period exactly $8$ samples implies the closed-loop poles lie on the unit circle at angle $\\theta = \\dfrac{2\\pi}{8} = \\dfrac{\\pi}{4}$, namely $z_{1,2} = \\cos\\!\\bigl(\\tfrac{\\pi}{4}\\bigr) \\pm \\mathrm{j}\\sin\\!\\bigl(\\tfrac{\\pi}{4}\\bigr)$. For such a complex-conjugate pair on the unit circle, the monic polynomial is\n$$\nz^{2} - 2\\cos\\!\\bigl(\\tfrac{\\pi}{4}\\bigr) z + 1 \\;=\\; z^{2} - \\sqrt{2}\\, z + 1.\n$$\nMatching coefficients with $z^{2} - (1 + p_{u}) z + (p_{u} + \\gamma)$ gives\n$$\n1 + p_{u} = \\sqrt{2}, \\qquad p_{u} + \\gamma = 1.\n$$\nSolving,\n$$\np_{u} = \\sqrt{2} - 1, \\qquad \\gamma = 1 - p_{u} = 2 - \\sqrt{2}.\n$$\nThe choice $\\theta = \\dfrac{3\\pi}{4}$ would imply $p_{u} = -1 - \\sqrt{2}$, which lies outside the unit circle and is inconsistent with a stable unmodeled plant pole, so the physically consistent solution is as above.", "answer": "$$\\boxed{p_u = \\sqrt{2}-1, \\quad \\gamma = 2-\\sqrt{2}}$$", "id": "1567929"}, {"introduction": "Deadbeat control extends beyond simple transfer functions into the powerful state-space framework, which can handle more complex systems. This advanced exercise challenges you to design a deadbeat controller for a switched linear systemâ€”one whose dynamics change periodically over time. By working directly with state matrices, you will see how to achieve a finite-time response even in non-standard scenarios, highlighting the versatility of state-feedback methods. [@problem_id:1567938]", "problem": "Consider a discrete-time switched linear system whose state is described by the vector $x(k) \\in \\mathbb{R}^2$ at time step $k$. The system's dynamics are governed by one of two sets of state-space equations, which alternate periodically. For even time steps $k = 0, 2, 4, \\dots$, the system evolves according to:\n$$x(k+1) = A_1 x(k) + B_1 u(k)$$\nFor odd time steps $k = 1, 3, 5, \\dots$, the system evolves according to:\n$$x(k+1) = A_2 x(k) + B_2 u(k)$$\nThe system matrices are given as:\n$$A_1 = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}, \\quad B_1 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$$\n$$A_2 = \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix}, \\quad B_2 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$$\n\nA time-varying state-feedback controller of the form $u(k) = -K_k x(k)$ is to be designed. Given the 2-periodic nature of the system, the controller gains are also 2-periodic, such that $K_k = K_0$ for even $k$ and $K_k = K_1$ for odd $k$, where $K_0$ and $K_1$ are constant $1 \\times 2$ row matrices.\n\nYour task is to determine the gain matrices $K_0$ and $K_1$ that achieve deadbeat control, meaning the system state must be driven to the origin, $x = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$, in exactly two time steps, regardless of the initial state $x(0)$.\n\nIf the deadbeat condition allows for more than one solution for the gain matrices, you must choose the specific solution that minimizes the Euclidean norm of the gain matrix $K_1$.\n\nPresent your final answer as a single $2 \\times 2$ matrix where the first row contains the elements of $K_0$ and the second row contains the elements of $K_1$.", "solution": "We require deadbeat control in two steps under the 2-periodic dynamics with time-varying state feedback $u(k)=-K_{k}x(k)$, where $K_{k}=K_{0}$ for even $k$ and $K_{k}=K_{1}$ for odd $k$. The closed-loop state update is\n$$\nx(1)=(A_{1}-B_{1}K_{0})x(0), \\quad x(2)=(A_{2}-B_{2}K_{1})x(1)=(A_{2}-B_{2}K_{1})(A_{1}-B_{1}K_{0})x(0).\n$$\nTo achieve deadbeat in exactly two steps for all initial $x(0)$, the two-step transition must be the zero matrix:\n$$\n(A_{2}-B_{2}K_{1})(A_{1}-B_{1}K_{0})=0.\n$$\nLet $K_{0}=\\begin{pmatrix}a & b\\end{pmatrix}$ and $K_{1}=\\begin{pmatrix}c & d\\end{pmatrix}$. Compute\n$$\nB_{1}K_{0}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}\\begin{pmatrix}a & b\\end{pmatrix}=\\begin{pmatrix}0 & 0 \\\\ a & b\\end{pmatrix}, \\quad A_{1}-B_{1}K_{0}=\\begin{pmatrix}1 & 1 \\\\ -a & 1-b\\end{pmatrix},\n$$\n$$\nB_{2}K_{1}=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}\\begin{pmatrix}c & d\\end{pmatrix}=\\begin{pmatrix}c & d \\\\ 0 & 0\\end{pmatrix}, \\quad A_{2}-B_{2}K_{1}=\\begin{pmatrix}1-c & -d \\\\ 1 & 1\\end{pmatrix}.\n$$\nThus\n$$\n(A_{2}-B_{2}K_{1})(A_{1}-B_{1}K_{0})=\\begin{pmatrix}1-c & -d \\\\ 1 & 1\\end{pmatrix}\\begin{pmatrix}1 & 1 \\\\ -a & 1-b\\end{pmatrix}\n$$\nwhose entries are\n$$\n\\begin{aligned}\n\\text{(top-left)}&:\\ (1-c)\\cdot 1+(-d)\\cdot(-a)=(1-c)+ad,\\\\\n\\text{(top-right)}&:\\ (1-c)\\cdot 1+(-d)\\cdot(1-b)=(1-c)-d+db,\\\\\n\\text{(bottom-left)}&:\\ 1\\cdot 1+1\\cdot(-a)=1-a,\\\\\n\\text{(bottom-right)}&:\\ 1\\cdot 1+1\\cdot(1-b)=2-b.\n\\end{aligned}\n$$\nSetting all four entries to zero gives\n$$\n1-a=0,\\quad 2-b=0,\\quad (1-c)+ad=0,\\quad (1-c)-d+db=0.\n$$\nFrom the first two equations, $a=1$ and $b=2$. Substituting into the last two yields the single condition\n$$\n(1-c)+d=0 \\quad \\Rightarrow \\quad c=1+d,\n$$\nso there is a one-parameter family of deadbeat solutions:\n$$\nK_{0}=\\begin{pmatrix}1 & 2\\end{pmatrix}, \\quad K_{1}=\\begin{pmatrix}1+d & d\\end{pmatrix}, \\quad d\\in\\mathbb{R}.\n$$\nTo select the solution minimizing the Euclidean norm of $K_{1}$, minimize\n$$\n\\|K_{1}\\|_{2}^{2}=(1+d)^{2}+d^{2}=2d^{2}+2d+1.\n$$\nDifferentiating with respect to $d$ and setting to zero gives\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}d}\\left(2d^{2}+2d+1\\right)=4d+2=0 \\quad \\Rightarrow \\quad d=-\\frac{1}{2},\n$$\nand hence\n$$\nc=1+d=\\frac{1}{2}.\n$$\nTherefore the gains are\n$$\nK_{0}=\\begin{pmatrix}1 & 2\\end{pmatrix}, \\quad K_{1}=\\begin{pmatrix}\\frac{1}{2} & -\\frac{1}{2}\\end{pmatrix},\n$$\nwhich satisfy $(A_{2}-B_{2}K_{1})(A_{1}-B_{1}K_{0})=0$ and minimize the Euclidean norm of $K_{1}$.", "answer": "$$\\boxed{\\begin{pmatrix}1 & 2 \\\\ \\frac{1}{2} & -\\frac{1}{2}\\end{pmatrix}}$$", "id": "1567938"}]}