{"hands_on_practices": [{"introduction": "Mastering state-feedback begins with understanding its most fundamental application: placing the pole of a first-order system. This exercise [@problem_id:1614741] strips the concept down to its core, using a simple temperature control model. By directly calculating the gain $k$ to position a single pole $p$, you will build a solid intuition for how feedback directly shapes a system's dynamic response.", "problem": "A simplified model for the temperature control of a spacecraft instrument is described by Newton's law of cooling, augmented with a controlled heat source. The temperature of the instrument, $T(t)$, evolves according to the first-order differential equation:\n$$\n\\frac{dT(t)}{dt} = -\\alpha (T(t) - T_{amb}) + \\gamma U(t)\n$$\nwhere $T_{amb}$ is the constant ambient temperature of the spacecraft's interior. The positive constant $\\alpha$ is the heat transfer coefficient, representing how quickly the instrument loses heat to its surroundings. The positive constant $\\gamma$ is the heating gain, which relates the control input $U(t)$ (power supplied to a resistive heater) to the rate of temperature change.\n\nTo maintain the instrument at a desired setpoint temperature $T_{sp}$, a proportional controller is used. The control law for the heater power is:\n$$\nU(t) = k (T_{sp} - T(t))\n$$\nwhere $k$ is the proportional feedback gain to be determined.\n\nFor analysis, it is convenient to define a state variable $x(t) = T(t) - T_{amb}$, which represents the temperature deviation from the ambient. The dynamics of this closed-loop system are characterized by a single pole. Your task is to determine the analytical expression for the feedback gain $k$ that places this pole at a specified location $p$ on the real axis.\n\nExpress your answer for the gain $k$ purely in terms of the system parameters $\\alpha$, $\\gamma$, and the desired pole location $p$.", "solution": "The goal is to find the feedback gain $k$ that places the closed-loop system's pole at a specified location $p$. We begin by expressing the system dynamics in terms of the state variable $x(t) = T(t) - T_{amb}$.\n\nFirst, we find the time derivative of the state variable $x(t)$:\n$$\n\\frac{dx(t)}{dt} = \\frac{d}{dt} (T(t) - T_{amb})\n$$\nSince $T_{amb}$ is a constant, its derivative is zero. Therefore:\n$$\n\\frac{dx(t)}{dt} = \\frac{dT(t)}{dt}\n$$\nNow we can substitute this into the given system equation:\n$$\n\\frac{dx(t)}{dt} = -\\alpha (T(t) - T_{amb}) + \\gamma U(t)\n$$\nBy definition, $x(t) = T(t) - T_{amb}$, so we can rewrite the equation in terms of the state variable $x(t)$:\n$$\n\\frac{dx(t)}{dt} = -\\alpha x(t) + \\gamma U(t)\n$$\nThis is the open-loop state-space representation of the system.\n\nNext, we incorporate the control law. The control law is given as:\n$$\nU(t) = k (T_{sp} - T(t))\n$$\nWe need to express this control law in terms of the state variable $x(t)$. From the definition of $x(t)$, we have $T(t) = x(t) + T_{amb}$. Substituting this into the control law gives:\n$$\nU(t) = k (T_{sp} - (x(t) + T_{amb}))\n$$\n$$\nU(t) = k (T_{sp} - T_{amb}) - k x(t)\n$$\nNow, we substitute this expression for $U(t)$ back into the state-space equation to obtain the closed-loop system dynamics:\n$$\n\\frac{dx(t)}{dt} = -\\alpha x(t) + \\gamma [k (T_{sp} - T_{amb}) - k x(t)]\n$$\nTo find the pole, we are interested in the homogeneous part of the differential equation, which involves the terms multiplied by $x(t)$. Let's group these terms:\n$$\n\\frac{dx(t)}{dt} = -\\alpha x(t) - \\gamma k x(t) + \\gamma k (T_{sp} - T_{amb})\n$$\n$$\n\\frac{dx(t)}{dt} = -(\\alpha + \\gamma k) x(t) + \\gamma k (T_{sp} - T_{amb})\n$$\nThis is a first-order linear ordinary differential equation of the form $\\dot{x} = A x + B u_{ext}$, where the closed-loop system matrix (a scalar in this case) is $A_{cl} = -(\\alpha + \\gamma k)$, and the external input term is $B u_{ext} = \\gamma k (T_{sp} - T_{amb})$.\n\nThe pole of a linear time-invariant system is given by the eigenvalue(s) of its system matrix. For this first-order system, the pole is simply the scalar value of the system matrix $A_{cl}$.\n$$\n\\text{pole} = -(\\alpha + \\gamma k)\n$$\nThe problem states that this pole must be placed at a specified location $p$. Thus, we set:\n$$\np = -(\\alpha + \\gamma k)\n$$\nFinally, we solve this equation for the unknown gain $k$:\n$$\n-p = \\alpha + \\gamma k\n$$\n$$\n\\gamma k = -p - \\alpha\n$$\n$$\nk = \\frac{-p - \\alpha}{\\gamma}\n$$\nThis is the required analytical expression for the feedback gain $k$.", "answer": "$$ \\boxed{\\frac{-p - \\alpha}{\\gamma}} $$", "id": "1614741"}, {"introduction": "Effective control design is about more than just achieving stability; it's about managing trade-offs. This practice [@problem_id:1614726] explores the fundamental compromise between system performance and control effort using a classic mass-spring-damper model. By designing two controllers with different response speeds, you will quantify how demanding a \"fast\" response is on the control input, a crucial consideration in any real-world engineering application.", "problem": "A mass-spring-damper system is described by the second-order linear differential equation:\n$$m\\ddot{x}(t) + b\\dot{x}(t) + kx(t) = u(t)$$\nwhere $x(t)$ is the displacement of the mass from its equilibrium position and $u(t)$ is an external control force. The system has the following parameters: a mass $m=1.0$ kg, a damping coefficient $b=3.0$ Ns/m, and a spring constant $k=2.0$ N/m.\n\nThe system is to be controlled using a state-feedback controller. The state vector is defined as $\\mathbf{x}(t) = [x_1(t), x_2(t)]^T = [x(t), \\dot{x}(t)]^T$, and the control law is given by $u(t) = -K\\mathbf{x}(t) = -k_1 x_1(t) - k_2 x_2(t)$.\n\nTwo different controllers are designed to achieve different performance objectives by placing the closed-loop system poles at specific locations in the s-plane.\n- **Controller S (Slow):** This controller places the closed-loop poles at $p_S = \\{-2.0, -3.0\\}$.\n- **Controller F (Fast):** This controller places the closed-loop poles at $p_F = \\{-8.0, -10.0\\}$.\n\nThe system is initially at rest, with an initial displacement of $x(0) = 0.5$ m and zero initial velocity, $\\dot{x}(0) = 0$. For each controller, the control input $u(t)$ will act to return the system to its equilibrium state $\\mathbf{x} = [0, 0]^T$.\n\nLet $|u_{\\text{max,S}}|$ and $|u_{\\text{max,F}}|$ be the maximum magnitudes of the control input signals required by the slow and fast controllers, respectively, during the entire time evolution from $t=0$ to infinity.\n\nCalculate the ratio $\\frac{|u_{\\text{max,F}}|}{|u_{\\text{max,S}}|}$.", "solution": "First, we will represent the mass-spring-damper system in state-space form. Let the state variables be $x_1 = x$ and $x_2 = \\dot{x}$. The state equations are:\n$\\dot{x}_1 = x_2$\n$\\dot{x}_2 = \\ddot{x} = \\frac{1}{m}(-kx - b\\dot{x} + u) = -\\frac{k}{m}x_1 - \\frac{b}{m}x_2 + \\frac{1}{m}u$\n\nIn matrix form, $\\dot{\\mathbf{x}} = A\\mathbf{x} + B\\mathbf{u}$, where:\n$A = \\begin{pmatrix} 0 & 1 \\\\ -k/m & -b/m \\end{pmatrix}$ and $B = \\begin{pmatrix} 0 \\\\ 1/m \\end{pmatrix}$.\n\nSubstituting the given values $m=1.0$ kg, $b=3.0$ Ns/m, and $k=2.0$ N/m:\n$A = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix}$ and $B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$.\n\nThe state-feedback control law is $u = -K\\mathbf{x} = -\\begin{pmatrix} k_1 & k_2 \\end{pmatrix}\\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$.\nThe closed-loop system dynamics are given by $\\dot{\\mathbf{x}} = (A-BK)\\mathbf{x}$.\n$A-BK = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\\begin{pmatrix} k_1 & k_2 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix} - \\begin{pmatrix} 0 & 0 \\\\ k_1 & k_2 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -2-k_1 & -3-k_2 \\end{pmatrix}$.\n\nThe poles of the closed-loop system are the eigenvalues of the matrix $A-BK$, which are the roots of the characteristic equation $\\det(sI - (A-BK)) = 0$.\n$\\det \\begin{pmatrix} s & -1 \\\\ 2+k_1 & s+3+k_2 \\end{pmatrix} = s(s+3+k_2) - (-1)(2+k_1) = 0$\n$s^2 + (3+k_2)s + (2+k_1) = 0$.\n\nNow, we will determine the gain matrices $K_S$ and $K_F$ for the two controllers.\n\n**Controller S (Slow):**\nThe desired poles are at $\\{-2.0, -3.0\\}$. The desired characteristic polynomial is:\n$(s - (-2))(s - (-3)) = (s+2)(s+3) = s^2 + 5s + 6 = 0$.\nBy comparing the coefficients of this polynomial with the general characteristic polynomial $s^2 + (3+k_{2,S})s + (2+k_{1,S}) = 0$, we get:\n$3 + k_{2,S} = 5 \\implies k_{2,S} = 2$\n$2 + k_{1,S} = 6 \\implies k_{1,S} = 4$\nSo, the gain matrix for the slow controller is $K_S = \\begin{pmatrix} 4 & 2 \\end{pmatrix}$.\n\n**Controller F (Fast):**\nThe desired poles are at $\\{-8.0, -10.0\\}$. The desired characteristic polynomial is:\n$(s - (-8))(s - (-10)) = (s+8)(s+10) = s^2 + 18s + 80 = 0$.\nBy comparing the coefficients of this polynomial with the general characteristic polynomial $s^2 + (3+k_{2,F})s + (2+k_{1,F}) = 0$, we get:\n$3 + k_{2,F} = 18 \\implies k_{2,F} = 15$\n$2 + k_{1,F} = 80 \\implies k_{1,F} = 78$\nSo, the gain matrix for the fast controller is $K_F = \\begin{pmatrix} 78 & 15 \\end{pmatrix}$.\n\nNext, we need to find the maximum magnitude of the control input, $|u(t)|$, for each controller. The control input is given by $u(t) = -k_1 x_1(t) - k_2 x_2(t)$. The initial condition is given as $x(0)=0.5$ m and $\\dot{x}(0)=0$ m/s, which corresponds to the initial state vector $\\mathbf{x}(0) = [0.5, 0]^T$.\n\nFor a system starting from rest with a non-zero displacement, the state feedback controller will apply the largest corrective force at the very beginning ($t=0$). At this instant, the displacement is at its maximum, and the velocity (which would typically contribute a damping-like term to the control action via $k_2$) is zero. As the system moves, the displacement decreases and velocity becomes non-zero, but the combination of terms results in a smaller control input magnitude. Thus, the maximum control input magnitude occurs at $t=0$.\n$|u_{\\text{max}}| = |u(0)| = |-K\\mathbf{x}(0)|$.\n\nLet's calculate this value for each controller.\nFor Controller S:\n$|u_{\\text{max,S}}| = |-K_S \\mathbf{x}(0)| = \\left|-\\begin{pmatrix} 4 & 2 \\end{pmatrix}\\begin{pmatrix} 0.5 \\\\ 0 \\end{pmatrix}\\right| = |-(4 \\times 0.5 + 2 \\times 0)| = |-2.0| = 2.0$ N.\n\nFor Controller F:\n$|u_{\\text{max,F}}| = |-K_F \\mathbf{x}(0)| = \\left|-\\begin{pmatrix} 78 & 15 \\end{pmatrix}\\begin{pmatrix} 0.5 \\\\ 0 \\end{pmatrix}\\right| = |-(78 \\times 0.5 + 15 \\times 0)| = |-39.0| = 39.0$ N.\n\nFinally, we calculate the required ratio:\n$\\frac{|u_{\\text{max,F}}|}{|u_{\\text{max,S}}|} = \\frac{39.0}{2.0} = 19.5$.\nThis result demonstrates the trade-off in control design: achieving a much faster response (poles further in the left-half plane) requires a significantly larger control effort.", "answer": "$$\\boxed{19.5}$$", "id": "1614726"}, {"introduction": "While coefficient matching works well for simple systems, it quickly becomes unwieldy as system order increases. This problem [@problem_id:1614771] introduces a powerful, systematic approach for pole placement: Ackermann's formula. Applying this formula to a third-order system demonstrates an elegant and scalable method, equipping you with a tool essential for designing controllers for more complex, higher-order dynamic systems.", "problem": "Consider a third-order Linear Time-Invariant (LTI) system representing a simplified model for a DC motor position controller. The system's dynamics are described by the state-space equation $\\dot{\\mathbf{x}} = A\\mathbf{x} + B u$, where $\\mathbf{x}$ is the state vector and $u$ is the control input. The state and input matrices are given by:\n\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & -2 & -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n\nTo improve the performance of the system, a state-feedback control law of the form $u = -K\\mathbf{x}$ is to be implemented, where $K = [k_1 \\ k_2 \\ k_3]$ is the constant controller gain vector. The goal is to place the closed-loop poles at desired locations, which corresponds to achieving a specific closed-loop characteristic polynomial.\n\nThe desired characteristic polynomial for the closed-loop system, $\\dot{\\mathbf{x}} = (A - BK)\\mathbf{x}$, is specified as:\n$$\n\\alpha_c(s) = s^3 + 15s^2 + 74s + 120\n$$\n\nUsing Ackermann's formula, determine the feedback gain vector $K$. Express your answer as a row vector $K = [k_1 \\ k_2 \\ k_3]$.", "solution": "We use Ackermann’s formula for state-feedback pole placement. For an LTI system $\\dot{\\mathbf{x}} = A\\mathbf{x} + B u$ with $u = -K\\mathbf{x}$ and desired characteristic polynomial $\\alpha_{c}(s)$ of degree $n=3$, Ackermann’s formula gives\n$$\nK = e_{3}^{T} C^{-1} \\alpha_{c}(A),\n$$\nwhere $e_{3}^{T} = \\begin{pmatrix}0 & 0 & 1\\end{pmatrix}$ and $C = \\begin{pmatrix}B & AB & A^{2}B\\end{pmatrix}$ is the controllability matrix.\n\nFirst compute $AB$ and $A^{2}B$:\n$$\nAB = AB = \\begin{pmatrix} 1 \\\\ 1 \\\\ -5 \\end{pmatrix}, \\quad\nA^{2}B = A(AB) = \\begin{pmatrix} 1 \\\\ -5 \\\\ 13 \\end{pmatrix}.\n$$\nThus the controllability matrix is\n$$\nC = \\begin{pmatrix} 0 & 1 & 1 \\\\ 1 & 1 & -5 \\\\ 1 & -5 & 13 \\end{pmatrix}.\n$$\nWe need $e_{3}^{T} C^{-1}$. Let $r = \\begin{pmatrix} r_{1} & r_{2} & r_{3} \\end{pmatrix} = e_{3}^{T} C^{-1}$. Then $r C = e_{3}^{T} = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix}$, which yields the linear system\n$$\nr_{2} + r_{3} = 0, \\quad r_{1} + r_{2} - 5 r_{3} = 0, \\quad r_{1} - 5 r_{2} + 13 r_{3} = 1.\n$$\nSolving gives\n$$\nr_{3} = \\frac{1}{24}, \\quad r_{2} = -\\frac{1}{24}, \\quad r_{1} = \\frac{1}{4},\n$$\nso\n$$\ne_{3}^{T} C^{-1} = \\begin{pmatrix} \\frac{1}{4} & -\\frac{1}{24} & \\frac{1}{24} \\end{pmatrix}.\n$$\n\nNext compute $\\alpha_{c}(A)$ for $\\alpha_{c}(s) = s^{3} + 15 s^{2} + 74 s + 120$:\n$$\nA^{2} = \\begin{pmatrix} 0 & 0 & 1 \\\\ 0 & -2 & -3 \\\\ 0 & 6 & 7 \\end{pmatrix}, \\quad\nA^{3} = \\begin{pmatrix} 0 & -2 & -3 \\\\ 0 & 6 & 7 \\\\ 0 & -14 & -15 \\end{pmatrix}.\n$$\nTherefore\n$$\n\\alpha_{c}(A) = A^{3} + 15 A^{2} + 74 A + 120 I\n= \\begin{pmatrix} 120 & 72 & 12 \\\\ 0 & 96 & 36 \\\\ 0 & -72 & -12 \\end{pmatrix}.\n$$\n\nFinally,\n$$\nK = \\begin{pmatrix} \\frac{1}{4} & -\\frac{1}{24} & \\frac{1}{24} \\end{pmatrix}\n\\begin{pmatrix} 120 & 72 & 12 \\\\ 0 & 96 & 36 \\\\ 0 & -72 & -12 \\end{pmatrix}\n= \\begin{pmatrix} 30 & 11 & 1 \\end{pmatrix}.\n$$\nThis feedback gain places the closed-loop poles at the roots of $\\alpha_{c}(s)$, i.e., achieves the desired characteristic polynomial for $A - BK$.", "answer": "$$\\boxed{\\begin{pmatrix}30 & 11 & 1\\end{pmatrix}}$$", "id": "1614771"}]}