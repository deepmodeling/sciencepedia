{"hands_on_practices": [{"introduction": "To begin, we will solidify the core mechanics of designing a controller with integral action. This foundational practice walks you through the complete process for a simple first-order system, representing a common thermal control problem. By augmenting the system state with an integrator and then applying pole placement techniques, you will directly calculate the necessary feedback gains to achieve a desired dynamic response [@problem_id:1614018]. This exercise is essential for building a concrete understanding of how to merge state-feedback control with the requirement of zero steady-state error.", "problem": "Consider a simplified model for controlling the temperature of a small electronic component. The deviation of the component's temperature from the ambient temperature is denoted by $x(t)$, and its dynamics are described by the first-order linear differential equation:\n$$\n\\dot{x}(t) = -2x(t) + u(t)\n$$\nwhere $u(t)$ is the power input from a resistive heater.\n\nThe objective is to design a controller that ensures the temperature deviation $x(t)$ tracks a constant reference value $r$ with zero steady-state error. To achieve this, an integral controller is implemented. A new state variable, $\\xi(t)$, is defined as the integral of the tracking error $e(t) = r - x(t)$:\n$$\n\\xi(t) = \\int_{0}^{t} [r - x(\\tau)] d\\tau\n$$\nThe control input $u(t)$ is generated by a state-feedback law based on the augmented state vector $z(t) = \\begin{bmatrix} x(t) \\\\ \\xi(t) \\end{bmatrix}$. The control law is given by:\n$$\nu(t) = -Kz(t) = - \\begin{pmatrix} k_1 & k_2 \\end{pmatrix} \\begin{bmatrix} x(t) \\\\ \\xi(t) \\end{bmatrix}\n$$\nDetermine the numerical values of the gain vector components, $k_1$ and $k_2$, required to place the poles of the closed-loop system at $-3 + 3j$ and $-3 - 3j$. Express your answer as a row matrix $\\begin{pmatrix} k_1 & k_2 \\end{pmatrix}$.", "solution": "The plant dynamics are $\\dot{x}(t)=-2x(t)+u(t)$. The integral state is defined by $\\xi(t)=\\int_{0}^{t}[r-x(\\tau)]\\,d\\tau$, so its derivative is $\\dot{\\xi}(t)=r-x(t)$. With the augmented state $z(t)=\\begin{bmatrix}x(t)\\\\ \\xi(t)\\end{bmatrix}$ and control $u(t)=-Kz(t)=- \\begin{pmatrix} k_1 & k_2 \\end{pmatrix} \\begin{bmatrix}x(t)\\\\ \\xi(t)\\end{bmatrix}$, the closed-loop homogeneous dynamics (excluding the input $r$ which does not affect pole locations) are\n$$\n\\dot{x} = -2x - k_{1}x - k_{2}\\xi = (-2-k_{1})x + (-k_{2})\\xi,\\qquad\n\\dot{\\xi} = -x.\n$$\nThus the closed-loop state matrix is\n$$\nA_{\\text{cl}}=\\begin{bmatrix}-2-k_{1} & -k_{2} \\\\ -1 & 0\\end{bmatrix}.\n$$\nThe characteristic polynomial is\n$$\n\\det(sI - A_{\\text{cl}})=\\det\\begin{bmatrix}s+2+k_{1} & k_{2} \\\\ 1 & s\\end{bmatrix}\n= (s+2+k_{1})s - k_{2} = s^{2} + (2+k_{1})s - k_{2}.\n$$\nThe desired closed-loop poles are $-3 \\pm 3j$, whose characteristic polynomial is\n$$\n(s - (-3+3j))(s - (-3-3j)) = (s+3-3j)(s+3+3j) = (s+3)^{2} + 9 = s^{2} + 6s + 18.\n$$\nMatching coefficients gives\n$$\n2 + k_{1} = 6 \\quad\\Rightarrow\\quad k_{1} = 4,\\qquad -k_{2} = 18 \\quad\\Rightarrow\\quad k_{2} = -18.\n$$\nTherefore, the required gain vector is $\\begin{pmatrix}4 & -18\\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix}4 & -18\\end{pmatrix}}$$", "id": "1614018"}, {"introduction": "Moving from a numerical example to a more general and physical context, this exercise challenges you to analyze an active suspension system. Here, you will derive the symbolic characteristic polynomial for a second-order mass-spring-damper system augmented with an integrator [@problem_id:1614087]. This practice will deconstruct the mathematics to reveal precisely how the physical parameters of the plant ($m, c, k$) and your controller gains ($k_{1}, k_{2}, k_{I}$) collectively influence the system's stability and performance. Gaining proficiency in this symbolic manipulation is key to developing a deeper, more intuitive grasp of control system design.", "problem": "An automotive engineer is designing an active suspension system for one corner of a vehicle. The system's vertical dynamics are modeled as a mass $m$ (representing a quarter of the vehicle's chassis mass) supported by a spring of stiffness $k$ and a damper with coefficient $c$. An actuator provides a control force $u(t)$ to adjust the suspension. The vertical displacement of the mass from its desired equilibrium height is denoted by $y(t)$. The governing equation of motion for this system is given by:\n$$m\\frac{d^{2}y}{dt^{2}} + c\\frac{dy}{dt} + ky = u(t)$$\nTo ensure that the vehicle maintains its design ride height and eliminates any steady-state error caused by constant disturbances (such as changes in passenger load), the engineer implements a controller with integral action. This is achieved by augmenting the system's state (position $y(t)$ and velocity $\\dot{y}(t)$) with an integral state variable, $x_I(t)$, defined as the time integral of the position, $x_I(t) = \\int y(t) \\,dt$.\n\nThe control force is then generated by a full state-feedback law based on this augmented state:\n$$u(t) = -k_{1}y(t) - k_{2}\\frac{dy}{dt}(t) - k_{I}x_{I}(t)$$\nwhere $k_{1}$, $k_{2}$, and $k_{I}$ are the constant feedback gains for the proportional, derivative, and integral terms, respectively.\n\nFind the characteristic polynomial of the resulting closed-loop control system. Express your answer as a monic polynomial in the variable $s$, with coefficients written in terms of the physical parameters $m, c, k$ and the controller gains $k_{1}, k_{2}, k_{I}$.", "solution": "To find the characteristic polynomial of the closed-loop system, we first need to represent the entire system in state-space form.\n\nFirst, let's define the state variables for the original second-order system. Let $x_1 = y$ (position) and $x_2 = \\dot{y}$ (velocity). The state equations for the open-loop plant are:\n$$\n\\dot{x}_1 = \\dot{y} = x_2\n$$\n$$\n\\dot{x}_2 = \\ddot{y} = \\frac{1}{m}(u(t) - c\\dot{y} - ky) = -\\frac{k}{m}x_1 - \\frac{c}{m}x_2 + \\frac{1}{m}u(t)\n$$\n\nNext, we augment the system with the integral state $x_I = \\int y \\, dt$. The derivative of this state is $\\dot{x}_I = y = x_1$. The augmented state vector is $\\mathbf{x}_{aug} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_I \\end{pmatrix}$. The state equations for the augmented system can be written as:\n$$\n\\dot{x}_1 = x_2\n$$\n$$\n\\dot{x}_2 = -\\frac{k}{m}x_1 - \\frac{c}{m}x_2 + \\frac{1}{m}u(t)\n$$\n$$\n\\dot{x}_I = x_1\n$$\nIn matrix form, $\\dot{\\mathbf{x}}_{aug} = A_{aug}\\mathbf{x}_{aug} + B_{aug}u(t)$, this is:\n$$\n\\begin{pmatrix} \\dot{x}_1 \\\\ \\dot{x}_2 \\\\ \\dot{x}_I \\end{pmatrix} = \n\\begin{pmatrix} 0 & 1 & 0 \\\\ -k/m & -c/m & 0 \\\\ 1 & 0 & 0 \\end{pmatrix}\n\\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_I \\end{pmatrix} +\n\\begin{pmatrix} 0 \\\\ 1/m \\\\ 0 \\end{pmatrix} u(t)\n$$\n\nThe control law is given as $u(t) = -k_{1}y - k_{2}\\dot{y} - k_{I}x_{I} = -k_{1}x_1 - k_{2}x_2 - k_{I}x_I$. In matrix form, this is $u = -K_{aug}\\mathbf{x}_{aug}$, where the gain matrix is $K_{aug} = \\begin{pmatrix} k_1 & k_2 & k_I \\end{pmatrix}$.\n\nWe can now form the closed-loop system by substituting the control law into the augmented state equation:\n$$\n\\dot{\\mathbf{x}}_{aug} = A_{aug}\\mathbf{x}_{aug} + B_{aug}(-K_{aug}\\mathbf{x}_{aug}) = (A_{aug} - B_{aug}K_{aug})\\mathbf{x}_{aug}\n$$\nThe closed-loop system matrix is $A_{cl} = A_{aug} - B_{aug}K_{aug}$. Let's compute this matrix. First, we compute the product $B_{aug}K_{aug}$:\n$$\nB_{aug}K_{aug} = \\begin{pmatrix} 0 \\\\ 1/m \\\\ 0 \\end{pmatrix} \\begin{pmatrix} k_1 & k_2 & k_I \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ k_1/m & k_2/m & k_I/m \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nNow, we can find $A_{cl}$:\n$$\nA_{cl} = A_{aug} - B_{aug}K_{aug} = \\begin{pmatrix} 0 & 1 & 0 \\\\ -k/m & -c/m & 0 \\\\ 1 & 0 & 0 \\end{pmatrix} - \\begin{pmatrix} 0 & 0 & 0 \\\\ k_1/m & k_2/m & k_I/m \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n$$\nA_{cl} = \\begin{pmatrix} 0 & 1 & 0 \\\\ -(k+k_1)/m & -(c+k_2)/m & -k_I/m \\\\ 1 & 0 & 0 \\end{pmatrix}\n$$\n\nThe characteristic polynomial of the closed-loop system is given by $P(s) = \\det(sI - A_{cl})$, where $I$ is the $3 \\times 3$ identity matrix.\n$$\nsI - A_{cl} = \\begin{pmatrix} s & 0 & 0 \\\\ 0 & s & 0 \\\\ 0 & 0 & s \\end{pmatrix} - \\begin{pmatrix} 0 & 1 & 0 \\\\ -(k+k_1)/m & -(c+k_2)/m & -k_I/m \\\\ 1 & 0 & 0 \\end{pmatrix}\n$$\n$$\nsI - A_{cl} = \\begin{pmatrix} s & -1 & 0 \\\\ (k+k_1)/m & s+(c+k_2)/m & k_I/m \\\\ -1 & 0 & s \\end{pmatrix}\n$$\nWe now compute the determinant of this matrix. We can use the cofactor expansion along the first row:\n$$\nP(s) = s \\begin{vmatrix} s+\\frac{c+k_2}{m} & \\frac{k_I}{m} \\\\ 0 & s \\end{vmatrix} - (-1) \\begin{vmatrix} \\frac{k+k_1}{m} & \\frac{k_I}{m} \\\\ -1 & s \\end{vmatrix} + 0\n$$\n$$\nP(s) = s \\left( \\left( s+\\frac{c+k_2}{m} \\right)s - (0)\\left(\\frac{k_I}{m}\\right) \\right) + 1 \\left( \\left(\\frac{k+k_1}{m}\\right)s - (-1)\\left(\\frac{k_I}{m}\\right) \\right)\n$$\n$$\nP(s) = s \\left( s^2 + \\frac{c+k_2}{m}s \\right) + \\left( \\frac{k+k_1}{m}s + \\frac{k_I}{m} \\right)\n$$\n$$\nP(s) = s^3 + \\frac{c+k_2}{m}s^2 + \\frac{k+k_1}{m}s + \\frac{k_I}{m}\n$$\nThis is the monic characteristic polynomial of the closed-loop system.", "answer": "$$\n\\boxed{s^{3} + \\frac{c+k_{2}}{m}s^{2} + \\frac{k+k_{1}}{m}s + \\frac{k_{I}}{m}}\n$$", "id": "1614087"}, {"introduction": "A robust control design looks beyond just pole placement; it also considers the influence of the system's intrinsic properties, such as its zeros. This advanced problem highlights a critical, real-world phenomenon where a plant zero located near the origin interacts with the controller's integrator pole [@problem_id:1614034]. By calculating the initial rate of change of the control signal, $\\dot{u}(0^+)$, you will uncover how this interaction can demand aggressive control action and potentially cause significant overshoot in the system's output. This analysis is crucial for designing controllers that not only track references accurately but also behave smoothly and avoid saturating actuators.", "problem": "A single-input, single-output (SISO) linear time-invariant system is described by the state-space model:\n$$\n\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t)\n$$\n$$\ny(t) = C \\mathbf{x}(t)\n$$\nwhere the state vector is $\\mathbf{x} \\in \\mathbb{R}^2$, the control input is $u \\in \\mathbb{R}$, the output is $y \\in \\mathbb{R}$, and the system matrices are given by:\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ -10 & -7 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 0.1 & 1 \\end{pmatrix}\n$$\nThe transfer function of this plant, $P(s) = C(sI-A)^{-1}B$, possesses a zero which is close to the origin. To ensure that the output $y(t)$ tracks a step reference input $r(t)$ with zero steady-state error, a state-feedback controller with integral action is implemented.\n\nThe controller structure uses an augmented state vector $\\mathbf{x}_a(t) = \\begin{pmatrix} \\mathbf{x}(t) \\\\ \\xi(t) \\end{pmatrix}$, where the integrator state $\\xi(t)$ is defined by $\\dot{\\xi}(t) = r(t) - y(t)$. The control law is given by a state-feedback on the augmented state:\n$$\nu(t) = -K_a \\mathbf{x}_a(t) = -\\begin{pmatrix} K_x & k_I \\end{pmatrix} \\begin{pmatrix} \\mathbf{x}(t) \\\\ \\xi(t) \\end{pmatrix}\n$$\nwhere $K_x = \\begin{pmatrix} k_1 & k_2 \\end{pmatrix}$ is the feedback gain for the original plant states and $k_I$ is the integral gain. The gain vector $K_a = \\begin{pmatrix} k_1 & k_2 & k_I \\end{pmatrix}$ is chosen to place the closed-loop poles of the augmented system at the locations: $s_1 = -8$ and $s_{2,3} = -3 \\pm 3j$.\n\nAssuming the system is initially at rest, a unit step reference input $r(t) = 1$ for $t \\ge 0$ is applied. Determine the initial rate of change of the control input, $\\dot{u}(0^+) = \\lim_{t \\to 0^+} \\frac{du(t)}{dt}$.\n\nProvide the exact numerical value of the result in SI units.", "solution": "The augmented closed-loop system with integral action uses the augmented state $\\mathbf{x}_{a} = \\begin{pmatrix} \\mathbf{x} \\\\ \\xi \\end{pmatrix}$, where $\\dot{\\xi} = r - y = r - C \\mathbf{x}$, and the control law $u = -K_{x}\\mathbf{x} - k_{I}\\xi$. The closed-loop augmented state matrix is\n$$\nA_{\\text{cl}} = \\begin{pmatrix}\nA - B K_{x} & - B k_{I} \\\\\n- C & 0\n\\end{pmatrix}.\n$$\nWith $A = \\begin{pmatrix} 0 & 1 \\\\ -10 & -7 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, and $C = \\begin{pmatrix} 0.1 & 1 \\end{pmatrix}$, and $K_{x} = \\begin{pmatrix} k_{1} & k_{2} \\end{pmatrix}$, the matrix $A_{\\text{cl}}$ is\n$$\nA_{\\text{cl}} =\n\\begin{pmatrix}\n0 & 1 & 0 \\\\\n-10 - k_{1} & -7 - k_{2} & -k_{I} \\\\\n-0.1 & -1 & 0\n\\end{pmatrix}.\n$$\nThe characteristic polynomial is $\\det(sI - A_{\\text{cl}})$, which evaluates to\n$$\n\\det\\!\\begin{pmatrix}\ns & -1 & 0 \\\\\n10 + k_{1} & s + 7 + k_{2} & k_{I} \\\\\n0.1 & 1 & s\n\\end{pmatrix}\n= s^{3} + (7 + k_{2}) s^{2} + (10 + k_{1} - k_{I}) s - 0.1 k_{I}.\n$$\nThe desired closed-loop poles are at $s_{1} = -8$ and $s_{2,3} = -3 \\pm 3j$, giving the target characteristic polynomial\n$$\n(s + 8)\\left(s^{2} + 6 s + 18\\right) = s^{3} + 14 s^{2} + 66 s + 144.\n$$\nMatching coefficients yields\n$$\n7 + k_{2} = 14 \\;\\Rightarrow\\; k_{2} = 7, \\quad\n10 + k_{1} - k_{I} = 66 \\;\\Rightarrow\\; k_{1} = 56 + k_{I}, \\quad\n- 0.1 k_{I} = 144 \\;\\Rightarrow\\; k_{I} = -1440.\n$$\nNow evaluate $\\dot{u}(0^{+})$ under the given initial conditions. Since the system is initially at rest, $\\mathbf{x}(0) = \\mathbf{0}$ and $\\xi(0) = 0$, hence $u(0^{+}) = 0$. The time derivative of the control is\n$$\n\\dot{u}(t) = -K_{x} \\dot{\\mathbf{x}}(t) - k_{I} \\dot{\\xi}(t).\n$$\nAt $t = 0^{+}$, from the plant dynamics $\\dot{\\mathbf{x}}(0^{+}) = A \\mathbf{x}(0) + B u(0^{+}) = \\mathbf{0}$, and from the integrator dynamics with $r(t) = 1$ and $y(0) = C \\mathbf{x}(0) = 0$ we have $\\dot{\\xi}(0^{+}) = 1$. Therefore\n$$\n\\dot{u}(0^{+}) = -K_{x} \\dot{\\mathbf{x}}(0^{+}) - k_{I} \\dot{\\xi}(0^{+}) = -0 - k_{I} \\cdot 1 = -k_{I} = 1440.\n$$\nThus the initial rate of change of the control input is $1440$ in SI units.", "answer": "$$\\boxed{1440}$$", "id": "1614034"}]}