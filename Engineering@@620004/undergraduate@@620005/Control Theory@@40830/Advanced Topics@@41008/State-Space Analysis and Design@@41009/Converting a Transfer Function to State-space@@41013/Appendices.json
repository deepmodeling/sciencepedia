{"hands_on_practices": [{"introduction": "Welcome to the hands-on portion of our exploration into state-space representation. We will begin with a fundamental exercise: converting a standard, strictly proper transfer function into its controllable canonical form. This practice [@problem_id:1566302] is essential as this canonical form provides a direct and structured method for creating a state-space model, where the coefficients of the transfer function's denominator directly populate the state matrix $A$, and the numerator coefficients define the output matrix $C$. Mastering this direct conversion is the first step toward understanding the powerful relationship between the frequency-domain and time-domain descriptions of a system.", "problem": "A linear time-invariant system is described by the transfer function $G(s) = \\frac{Y(s)}{U(s)} = \\frac{s^2 + 4}{s^3 + 5s^2 + 9s + 7}$. This system can be modeled using a state-space representation of the form:\n$$\n\\dot{\\mathbf{x}} = A\\mathbf{x} + B u\n$$\n$$\ny = C\\mathbf{x} + D u\n$$\nwhere $\\mathbf{x}$ is the state vector, $u$ is the scalar input, and $y$ is the scalar output.\n\nWhich of the following sets of matrices corresponds to the controllable canonical form of this system?\n\nA. $A = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -7 & -9 & -5 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 4 & 0 & 1 \\end{pmatrix}$, $D = [0]$\n\nB. $A = \\begin{pmatrix} 0 & 0 & -7 \\\\ 1 & 0 & -9 \\\\ 0 & 1 & -5 \\end{pmatrix}$, $B = \\begin{pmatrix} 4 \\\\ 0 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix}$, $D = [0]$\n\nC. $A = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 7 & 9 & 5 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 4 & 0 & 1 \\end{pmatrix}$, $D = [0]$\n\nD. $A = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -7 & -9 & -5 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 1 & 0 & 4 \\end{pmatrix}$, $D = [0]$", "solution": "For a single-input single-output strictly proper transfer function with monic denominator\n$$\nG(s)=\\frac{b_{2}s^{2}+b_{1}s+b_{0}}{s^{3}+a_{2}s^{2}+a_{1}s+a_{0}},\n$$\nthe controllable canonical form is defined by\n$$\nA=\\begin{pmatrix}\n0 & 1 & 0 \\\\\n0 & 0 & 1 \\\\\n-a_{0} & -a_{1} & -a_{2}\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix},\\quad\nC=\\begin{pmatrix} b_{0} & b_{1} & b_{2} \\end{pmatrix},\\quad\nD=[0],\n$$\nbecause the system is strictly proper, so $D=0$.\n\nFor the given transfer function\n$$\nG(s)=\\frac{s^{2}+4}{s^{3}+5s^{2}+9s+7},\n$$\nthe denominator coefficients are $a_{2}=5$, $a_{1}=9$, $a_{0}=7$, and the numerator coefficients are $b_{2}=1$, $b_{1}=0$, $b_{0}=4$.\n\nTo verify the input-output map, compute\n$$\nG(s)=C\\,(sI-A)^{-1}B+D.\n$$\nWith the companion-form $A$ and $B$ above, solve $(sI-A)v=B$ for $v=(sI-A)^{-1}B$:\n$$\n\\begin{pmatrix}\ns & -1 & 0 \\\\\n0 & s & -1 \\\\\na_{0} & a_{1} & s+a_{2}\n\\end{pmatrix}\n\\begin{pmatrix} v_{1} \\\\ v_{2} \\\\ v_{3} \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\nFrom the first two equations, $v_{2}=s v_{1}$ and $v_{3}=s^{2} v_{1}$. Substituting into the third gives\n$$\na_{0}v_{1}+a_{1}(s v_{1})+(s+a_{2})(s^{2}v_{1})=1\n\\;\\Rightarrow\\;\nv_{1}=\\frac{1}{s^{3}+a_{2}s^{2}+a_{1}s+a_{0}},\n$$\nhence\n$$\nv=\\frac{1}{s^{3}+a_{2}s^{2}+a_{1}s+a_{0}}\\begin{pmatrix} 1 \\\\ s \\\\ s^{2} \\end{pmatrix}.\n$$\nTherefore,\n$$\nG(s)=C v = \\frac{b_{0}+b_{1}s+b_{2}s^{2}}{s^{3}+a_{2}s^{2}+a_{1}s+a_{0}}.\n$$\nMatching with the given $G(s)=\\frac{s^{2}+4}{s^{3}+5s^{2}+9s+7}$ yields $b_{2}=1$, $b_{1}=0$, $b_{0}=4$, so\n$$\nA=\\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -7 & -9 & -5 \\end{pmatrix},\\quad\nB=\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix},\\quad\nC=\\begin{pmatrix} 4 & 0 & 1 \\end{pmatrix},\\quad\nD=[0],\n$$\nwhich corresponds to option A. The other options either have incorrect signs in $A$ (C), represent the observable canonical form (B), or have the numerator coefficients ordered incorrectly in $C$ (D).", "answer": "$$\\boxed{A}$$", "id": "1566302"}, {"introduction": "Building upon the basics, our next practice [@problem_id:1566249] introduces complexities often encountered in real-world system models. This exercise requires you to handle a transfer function that is not strictly proper and whose denominator is not monic. You will first need to account for the direct feedthrough term $D$, which represents an instantaneous connection between the input and output, and then normalize the transfer function. These preliminary steps are crucial for correctly applying the canonical form conversion and are a vital part of a control engineer's standard toolkit.", "problem": "An industrial servomechanism is modeled as a linear time-invariant (LTI) system. Its dynamics, relating the input control signal $u(t)$ to the output angular position $y(t)$, are captured by the following transfer function in the Laplace domain:\n$$G(s) = \\frac{Y(s)}{U(s)} = \\frac{4s^3 + 2s^2 - 4s + 10}{2s^3 + 4s^2 - 6s - 8}$$\nTo implement a digital controller, this system must be converted into a state-space model of the form:\n$$\\dot{\\mathbf{x}} = A\\mathbf{x} + B u$$\n$$y = C\\mathbf{x} + D u$$\nwhere the matrices $(A, B, C, D)$ represent the system in controllable canonical form. After deriving these matrices, construct a row vector containing specific elements in the following order: $[A_{31}, A_{32}, A_{33}, C_{11}, C_{12}, C_{13}, D]$. What is this resulting vector?", "solution": "The task is to find a specific set of elements from the state-space matrices $(A, B, C, D)$ in controllable canonical form for the given transfer function $G(s)$.\n\nFirst, we analyze the transfer function:\n$$G(s) = \\frac{4s^3 + 2s^2 - 4s + 10}{2s^3 + 4s^2 - 6s - 8}$$\nThe degree of the numerator polynomial is equal to the degree of the denominator polynomial (both are 3). This means the transfer function is proper, but not strictly proper. As a result, there will be a non-zero direct feedthrough term, $D$.\n\nThe value of $D$ can be found by taking the limit of $G(s)$ as $s \\to \\infty$. This is equivalent to the ratio of the leading coefficients of the numerator and denominator.\n$$D = \\lim_{s \\to \\infty} G(s) = \\lim_{s \\to \\infty} \\frac{4s^3 + 2s^2 - 4s + 10}{2s^3 + 4s^2 - 6s - 8} = \\frac{4}{2} = 2$$\n\nThe state-space representation is constructed from the strictly proper part of the transfer function, $G_{sp}(s)$, where $G(s) = G_{sp}(s) + D$. We find $G_{sp}(s)$ by subtracting $D$ from $G(s)$:\n$$G_{sp}(s) = G(s) - D = \\frac{4s^3 + 2s^2 - 4s + 10}{2s^3 + 4s^2 - 6s - 8} - 2$$\nTo subtract, we put everything over a common denominator:\n$$G_{sp}(s) = \\frac{(4s^3 + 2s^2 - 4s + 10) - 2(2s^3 + 4s^2 - 6s - 8)}{2s^3 + 4s^2 - 6s - 8}$$\n$$G_{sp}(s) = \\frac{4s^3 + 2s^2 - 4s + 10 - 4s^3 - 8s^2 + 12s + 16}{2s^3 + 4s^2 - 6s - 8}$$\nCombining like terms in the numerator gives:\n$$G_{sp}(s) = \\frac{-6s^2 + 8s + 26}{2s^3 + 4s^2 - 6s - 8}$$\n\nTo obtain the controllable canonical form, the denominator of the strictly proper transfer function must be monic (i.e., its leading coefficient must be 1). The leading coefficient of the denominator is 2, so we divide both the numerator and the denominator by 2:\n$$G_{sp}(s) = \\frac{\\frac{1}{2}(-6s^2 + 8s + 26)}{\\frac{1}{2}(2s^3 + 4s^2 - 6s - 8)} = \\frac{-3s^2 + 4s + 13}{s^3 + 2s^2 - 3s - 4}$$\nNow, the transfer function is in the standard form for an $n=3$ system:\n$$G_{sp}(s) = \\frac{b_2 s^2 + b_1 s + b_0}{s^3 + a_2 s^2 + a_1 s + a_0}$$\nBy comparing coefficients, we identify:\n$b_2 = -3$, $b_1 = 4$, $b_0 = 13$\n$a_2 = 2$, $a_1 = -3$, $a_0 = -4$\n\nFor a third-order system, the controllable canonical form matrices $(A, B, C)$ are given by:\n$$A = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -a_0 & -a_1 & -a_2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} b_0 & b_1 & b_2 \\end{pmatrix}$$\nSubstituting the identified coefficients:\n$$A = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -(-4) & -(-3) & -(2) \\end{pmatrix} = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 4 & 3 & -2 \\end{pmatrix}$$\n$$B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$$\n$$C = \\begin{pmatrix} 13 & 4 & -3 \\end{pmatrix}$$\nAnd we already found $D = 2$.\n\nThe problem asks for a row vector constructed from specific elements: $[A_{31}, A_{32}, A_{33}, C_{11}, C_{12}, C_{13}, D]$.\nFrom matrix $A$:\n$A_{31} = 4$\n$A_{32} = 3$\n$A_{33} = -2$\n\nFrom matrix $C$:\n$C_{11} = 13$\n$C_{12} = 4$\n$C_{13} = -3$\n\nThe scalar $D$ is $2$.\n\nConstructing the final vector:\n$$[A_{31}, A_{32}, A_{33}, C_{11}, C_{12}, C_{13}, D] = [4, 3, -2, 13, 4, -3, 2]$$\nWe present this as a row matrix.", "answer": "$$\n\\boxed{\\begin{pmatrix} 4 & 3 & -2 & 13 & 4 & -3 & 2 \\end{pmatrix}}\n$$", "id": "1566249"}, {"introduction": "This final practice moves beyond direct procedural conversion to an important conceptual level: the idea of a minimal realization. The exercise [@problem_id:1566256] presents a transfer function with a hidden pole-zero cancellation, a common occurrence that can obscure the true order of the system. Your task is to identify this cancellation to find the minimal transfer function before converting it to state-space form. This process underscores a critical principle: a state-space model should be both controllable and observable, representing the system's dynamics with the smallest possible number of state variables.", "problem": "A single-input, single-output Linear Time-Invariant (LTI) system is described by the transfer function $G(s) = \\frac{Y(s)}{U(s)}$, where $U(s)$ is the Laplace transform of the input signal $u(t)$ and $Y(s)$ is the Laplace transform of the output signal $y(t)$. The transfer function is given by:\n$$G(s) = \\frac{s+a}{s^3 + (a+b)s^2 + (ab+c)s + ac}$$\nHere, $a$, $b$, and $c$ are distinct positive real constants.\n\nA state-space representation of a system is given by the equations:\n$$ \\dot{\\mathbf{x}}(t) = \\mathbf{A x}(t) + \\mathbf{B} u(t) $$\n$$ y(t) = \\mathbf{C x}(t) + \\mathbf{D} u(t) $$\n\nDetermine the minimal realization of this system in controllable canonical form. A minimal realization is a state-space model that is both fully controllable and fully observable. From the resulting state-space matrices $(\\mathbf{A}, \\mathbf{B}, \\mathbf{C}, \\mathbf{D})$, calculate the scalar value of the expression $\\mathbf{C} \\mathbf{A}^2 \\mathbf{B}$.", "solution": "We are given the transfer function\n$$G(s) = \\frac{s+a}{s^{3} + (a+b)s^{2} + (ab+c)s + ac}.$$\nFirst, determine whether there is a pole-zero cancellation. Evaluate the denominator at $s=-a$:\n$$(-a)^{3} + (a+b)(-a)^{2} + (ab+c)(-a) + ac = -a^{3} + (a+b)a^{2} - a(ab+c) + ac.$$\nSimplifying,\n$$-a^{3} + a^{3} + ba^{2} - a^{2}b - ac + ac = 0.$$\nHence, $s=-a$ is a root of the denominator, so $(s+a)$ is a factor. Indeed,\n$$(s+a)(s^{2} + b s + c) = s^{3} + (a+b)s^{2} + (ab+c)s + ac.$$\nTherefore, the minimal transfer function after cancelling the common factor $(s+a)$ is\n$$G_{\\min}(s) = \\frac{1}{s^{2} + b s + c},$$\nwhich is strictly proper and of order $2$.\n\nA controllable canonical form realization for a second-order transfer function with monic denominator $s^{2} + b s + c$ and numerator $1$ (i.e., $0 \\cdot s + 1$) is given by\n$$\\mathbf{A} = \\begin{pmatrix} 0 & 1 \\\\ -c & -b \\end{pmatrix}, \\quad \\mathbf{B} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad \\mathbf{C} = \\begin{pmatrix} 1 & 0 \\end{pmatrix}, \\quad \\mathbf{D} = 0.$$\nVerification of the transfer function:\n$$(s\\mathbf{I} - \\mathbf{A}) = \\begin{pmatrix} s & -1 \\\\ c & s + b \\end{pmatrix}, \\quad \\det(s\\mathbf{I} - \\mathbf{A}) = s^{2} + b s + c,$$\n$$(s\\mathbf{I} - \\mathbf{A})^{-1} = \\frac{1}{s^{2} + b s + c} \\begin{pmatrix} s + b & 1 \\\\ -c & s \\end{pmatrix}, \\quad (s\\mathbf{I} - \\mathbf{A})^{-1}\\mathbf{B} = \\frac{1}{s^{2} + b s + c} \\begin{pmatrix} 1 \\\\ s \\end{pmatrix}.$$\nThus,\n$$G_{\\min}(s) = \\mathbf{C}(s\\mathbf{I} - \\mathbf{A})^{-1}\\mathbf{B} + \\mathbf{D} = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\frac{1}{s^{2} + b s + c} \\begin{pmatrix} 1 \\\\ s \\end{pmatrix} = \\frac{1}{s^{2} + b s + c}.$$\nControllability and observability:\n$$\\mathcal{C} = \\begin{pmatrix} \\mathbf{B} & \\mathbf{A}\\mathbf{B} \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 1 & -b \\end{pmatrix}, \\quad \\det(\\mathcal{C}) = -1 \\neq 0,$$\n$$\\mathcal{O} = \\begin{pmatrix} \\mathbf{C} \\\\ \\mathbf{C}\\mathbf{A} \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix},$$\nboth full rank, so the realization is minimal.\n\nNow compute $\\mathbf{C}\\mathbf{A}^{2}\\mathbf{B}$. First,\n$$\\mathbf{A}\\mathbf{B} = \\begin{pmatrix} 0 & 1 \\\\ -c & -b \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -b \\end{pmatrix}.$$\nThen,\n$$\\mathbf{A}^{2}\\mathbf{B} = \\mathbf{A}(\\mathbf{A}\\mathbf{B}) = \\begin{pmatrix} 0 & 1 \\\\ -c & -b \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -b \\end{pmatrix} = \\begin{pmatrix} -b \\\\ -c + b^{2} \\end{pmatrix}.$$\nFinally,\n$$\\mathbf{C}\\mathbf{A}^{2}\\mathbf{B} = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} -b \\\\ -c + b^{2} \\end{pmatrix} = -b.$$\nTherefore, the requested scalar is $-b$.", "answer": "$$\\boxed{-b}$$", "id": "1566256"}]}