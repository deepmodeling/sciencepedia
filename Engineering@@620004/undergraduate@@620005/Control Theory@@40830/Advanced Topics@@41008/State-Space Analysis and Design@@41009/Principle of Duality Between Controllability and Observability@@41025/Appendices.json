{"hands_on_practices": [{"introduction": "This first exercise goes to the heart of the duality principle. We will explore the direct mathematical relationship between the controllability of a system, described by the pair of matrices $(A, B)$, and the observability of its corresponding dual system. By working through this problem [@problem_id:1601185], you will formally establish why the statement \"controllability of $(A, B)$ is equivalent to observability of $(A^T, B^T)$\" holds true, providing a solid foundation for all other applications of duality.", "problem": "Consider a Linear Time-Invariant (LTI) system described by the state-space representation $\\dot{x}(t) = Ax(t) + Bu(t)$, where $x(t) \\in \\mathbb{R}^n$ is the state vector, $u(t) \\in \\mathbb{R}^m$ is the input vector, $A$ is the $n \\times n$ state matrix, and $B$ is the $n \\times m$ input matrix. It is given that this system, represented by the pair $(A, B)$, is completely state controllable.\n\nNow, consider a different LTI system, which we will refer to as the \"dual system\". This dual system is defined by a state matrix $A_{dual} = A^T$ and an output matrix for an output equation $y_{dual}(t) = C_{dual} x_{dual}(t)$ given by $C_{dual} = B^T$.\n\nBased on the principle of duality in control theory, which of the following statements about this dual system is definitively true?\n\nA. The dual system is completely observable.\n\nB. The dual system is completely controllable.\n\nC. The dual system is guaranteed to be asymptotically stable.\n\nD. The observability matrix of the dual system has a rank less than $n$.", "solution": "We are given an LTI system with state-space dynamics $\\dot{x}(t) = A x(t) + B u(t)$ and the pair $(A,B)$ is completely controllable. By definition of complete controllability via the Popov–Belevitch–Hautus (PBH) test, this means that for every $\\lambda \\in \\mathbb{C}$,\n$$\n\\operatorname{rank}\\,[\\lambda I - A,\\; B] = n.\n$$\nEquivalently, there is no nonzero left eigenvector $v^{T}$ of $A$ satisfying $v^{T}A = \\lambda v^{T}$ such that $v^{T}B = 0$.\n\nThe dual system is defined with $A_{dual} = A^{T}$ and $C_{dual} = B^{T}$. Observability of the pair $(A_{dual}, C_{dual}) = (A^{T}, B^{T})$ can be tested by the PBH observability criterion, which states that $(A^{T}, B^{T})$ is observable if and only if for every $\\lambda \\in \\mathbb{C}$,\n$$\n\\operatorname{rank}\\,\\begin{bmatrix} \\lambda I - A^{T} \\\\ B^{T} \\end{bmatrix} = n.\n$$\nStarting from the controllability PBH condition for $(A,B)$,\n$$\n\\operatorname{rank}\\,[\\lambda I - A,\\; B] = n,\n$$\ntake the transpose of the block matrix. Since matrix rank is invariant under transposition, we obtain\n$$\n\\operatorname{rank}\\,\\begin{bmatrix} \\lambda I - A^{T} \\\\ B^{T} \\end{bmatrix} = n,\n$$\nfor all $\\lambda \\in \\mathbb{C}$. By the PBH observability test, this proves that the dual pair $(A^{T}, B^{T})$ is completely observable. Therefore statement A is definitively true.\n\nTo rule out the other options:\n- Statement B is not guaranteed: controllability of $(A,B)$ does not imply controllability of $(A^{T}, B^{T})$; rather, it implies observability of $(A^{T}, B^{T})$.\n- Statement C is false in general: controllability does not imply asymptotic stability, and $A$ and $A^{T}$ share the same eigenvalues, so instability (if present) is preserved under transposition.\n- Statement D contradicts the established observability; the observability matrix must have rank $n$ for complete observability, not less than $n$.\n\nHence, the only definitively true statement is A.", "answer": "$$\\boxed{A}$$", "id": "1601185"}, {"introduction": "The principle of duality is not just a theoretical curiosity; it has profound practical implications for control engineering. This thought experiment [@problem_id:1601187] places you in the role of an engineer with a limited set of software tools. You will see how a deep understanding of duality allows you to cleverly repurpose an existing function for checking observability to solve a problem of controllability, demonstrating how theoretical principles enable resourcefulness and efficient problem-solving.", "problem": "A control systems engineer is working with a legacy piece of software that contains a pre-compiled library function, `is_observable(F, G)`. This function is a \"black box,\" meaning its internal code cannot be viewed or modified. The documentation states that the function takes two matrix arguments, `F` and `G`, which represent the state matrix and output matrix of a linear time-invariant (LTI) system described by the state-space equations:\n$$\n\\dot{\\mathbf{x}} = F\\mathbf{x} \\\\\n\\mathbf{y} = G\\mathbf{x}\n$$\nThe function returns `true` if the system pair $(F, G)$ is observable, and `false` otherwise.\n\nThe engineer needs to determine if a completely different LTI system, described by the state equation $\\dot{\\mathbf{z}} = A\\mathbf{z} + B\\mathbf{u}$, is controllable. The state matrix $A$ is an $n \\times n$ matrix and the input matrix $B$ is an $n \\times m$ matrix.\n\nWhich of the following describes the correct way for the engineer to use the `is_observable(F, G)` function to test the controllability of the system pair $(A, B)$? In these options, $A^T$ and $B^T$ denote the transpose of matrices $A$ and $B$, respectively. The system $(A, B)$ is controllable if and only if the function call returns `true`.\n\nA. Call `is_observable(A, B)`\n\nB. Call `is_observable(A^T, B^T)`\n\nC. Call `is_observable(B, A)`\n\nD. Call `is_observable(B^T, A^T)`\n\nE. The function `is_observable(F, G)` cannot be used to determine the controllability of the system $(A, B)$.", "solution": "For a linear time-invariant system, controllability and observability are characterized by rank conditions on the controllability and observability matrices.\n\nThe pair $(A, B)$ is controllable if and only if its controllability matrix\n$$\n\\mathcal{C}(A,B) \\equiv \\big[\\, B \\;\\; AB \\;\\; A^{2}B \\;\\; \\cdots \\;\\; A^{n-1}B \\,\\big]\n$$\nhas rank $n$.\n\nThe pair $(F, G)$ is observable if and only if its observability matrix\n$$\n\\mathcal{O}(F,G) \\equiv \\begin{bmatrix}\nG \\\\\nGF \\\\\nG F^{2} \\\\\n\\vdots \\\\\nG F^{n-1}\n\\end{bmatrix}\n$$\nhas rank $n$.\n\nUse the duality between controllability and observability. Let $F = A^{T}$ and $G = B^{T}$. Then\n$$\n\\mathcal{O}(A^{T}, B^{T}) = \\begin{bmatrix}\nB^{T} \\\\\nB^{T} A^{T} \\\\\nB^{T} (A^{T})^{2} \\\\\n\\vdots \\\\\nB^{T} (A^{T})^{n-1}\n\\end{bmatrix}.\n$$\nTaking the transpose and using $(XY)^{T} = Y^{T} X^{T}$ and $(A^{T})^{k} = (A^{k})^{T}$,\n$$\n\\mathcal{O}(A^{T}, B^{T})^{T} = \\big[\\, B \\;\\; AB \\;\\; A^{2}B \\;\\; \\cdots \\;\\; A^{n-1}B \\,\\big] = \\mathcal{C}(A,B).\n$$\nSince $\\operatorname{rank}(M) = \\operatorname{rank}(M^{T})$ for any matrix $M$, it follows that\n$$\n\\operatorname{rank}\\big(\\mathcal{O}(A^{T}, B^{T})\\big) = \\operatorname{rank}\\big(\\mathcal{C}(A,B)\\big).\n$$\nTherefore, $(A,B)$ is controllable if and only if $(A^{T}, B^{T})$ is observable. Consequently, the correct use of the black-box function is to call it as $\\texttt{is\\_observable}(A^{T}, B^{T})$.\n\nOptions A, C, and D do not test the correct dual property (and in C and D, matrix dimensions are generally incompatible for a state matrix). Option E is false because duality provides the required mapping.", "answer": "$$\\boxed{B}$$", "id": "1601187"}, {"introduction": "Our final practice expands the scope of duality by connecting it to the input-output behavior of a system, described by its transfer function $G(s)$. This problem [@problem_id:1601135] investigates the consequences of a pole-zero cancellation, which indicates a non-minimal state-space realization. You will discover that the dual of a single-input, single-output (SISO) system shares the same transfer function, and therefore, if the original system is non-minimal, its dual must be as well, providing a deeper insight into the relationship between internal structure and external behavior.", "problem": "A linear time-invariant (LTI), single-input, single-output (SISO) system, denoted as $\\Sigma$, is represented by the state-space model $(A, B, C)$, where $A$ is an $n \\times n$ constant matrix, $B$ is an $n \\times 1$ constant column vector, and $C$ is a $1 \\times n$ constant row vector. The transfer function of the system is given by $G(s) = C(sI - A)^{-1}B$.\n\nAn analysis of the system reveals that the degree of the denominator of the transfer function $G(s)$, after all common factors with the numerator have been cancelled, is strictly less than $n$. This is a phenomenon known as pole-zero cancellation, and it implies that the system $\\Sigma$ is not simultaneously completely controllable and completely observable.\n\nThe dual system, $\\Sigma_{dual}$, is defined by the state-space model $(A_{dual}, B_{dual}, C_{dual}) = (A^T, C^T, B^T)$, where $T$ denotes the transpose operation.\n\nBased on this information, which of the following statements about the dual system $\\Sigma_{dual}$ is necessarily true?\n\nA. The dual system $\\Sigma_{dual}$ must be completely controllable.\n\nB. The dual system $\\Sigma_{dual}$ must be completely observable.\n\nC. The dual system $\\Sigma_{dual}$ cannot be both completely controllable and completely observable.\n\nD. The dual system $\\Sigma_{dual}$ must be neither completely controllable nor completely observable.\n\nE. No definitive conclusion can be drawn about the controllability or observability of $\\Sigma_{dual}$ without the specific matrices.", "solution": "We are given a SISO LTI realization $\\Sigma$ with transfer function $G(s)=C(sI-A)^{-1}B$. It is stated that, after cancelling all common factors, the denominator degree of $G(s)$ is strictly less than $n$. Denote the McMillan degree (the minimal order of any realization of $G(s)$) by $r$. Then the given condition implies\n$$\nr< n.\n$$\n\nA standard result from realization theory is:\n- A realization $(A,B,C)$ is minimal if and only if it is both completely controllable and completely observable.\n- The minimal order equals the McMillan degree $r$.\n\nSince the given realization has order $n>r$, it is not minimal; hence $(A,B,C)$ cannot be both completely controllable and completely observable.\n\nNow consider the dual system $\\Sigma_{dual}$ with\n$$\nA_{dual}=A^{T},\\quad B_{dual}=C^{T},\\quad C_{dual}=B^{T}.\n$$\nIts transfer function is\n$$\nG_{dual}(s)\\;=\\;C_{dual}(sI-A_{dual})^{-1}B_{dual}\\;=\\;B^{T}(sI-A^{T})^{-1}C^{T}.\n$$\nUsing the identity $(X^{T})^{-1}=(X^{-1})^{T}$ when $X$ is invertible and the fact that $(sI-A^{T})^{-1}=\\big((sI-A)^{-1}\\big)^{T}$, we obtain\n$$\nG_{dual}(s)\\;=\\;B^{T}\\big((sI-A)^{-1}\\big)^{T}C^{T}\\;=\\;\\big(C(sI-A)^{-1}B\\big)^{T}.\n$$\nBecause the system is SISO, $G(s)$ is a scalar function, so transposition leaves it unchanged. Therefore,\n$$\nG_{dual}(s)=G(s).\n$$\n\nThus $\\Sigma_{dual}$ is also a realization of the same transfer function $G(s)$ and has the same order $n$. Since the McMillan degree of $G(s)$ is $r<n$, the dual realization of order $n$ is also nonminimal. By the minimality criterion, a nonminimal realization cannot be both completely controllable and completely observable. Hence, for $\\Sigma_{dual}$ it is necessarily true that it cannot be both completely controllable and completely observable.\n\nThis establishes that option C must hold, while options A, B, and D are too strong, and E is incorrect because a definitive conclusion (namely, not both) does follow from the given information.", "answer": "$$\\boxed{C}$$", "id": "1601135"}]}