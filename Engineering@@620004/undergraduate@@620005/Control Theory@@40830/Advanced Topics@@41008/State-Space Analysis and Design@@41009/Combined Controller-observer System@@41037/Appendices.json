{"hands_on_practices": [{"introduction": "The foundation of controlling systems with incomplete information lies in our ability to design a state-feedback controller and a state observer independently. This practice provides hands-on experience with this core design process, applying the pole placement technique to set the desired dynamics for both the controller and the observer. Mastering this calculation is the first step toward implementing robust observer-based control systems. [@problem_id:1563422]", "problem": "A second-order, single-input, single-output (SISO) linear time-invariant (LTI) system is described by the following state-space representation:\n$$\n\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B u(t)\n$$\n$$\ny(t) = C\\mathbf{x}(t)\n$$\nwhere $\\mathbf{x}(t) = [x_1(t), x_2(t)]^T$ is the state vector, $u(t)$ is the control input, and $y(t)$ is the measured output. The system matrices are given by:\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}\n$$\nSince the full state vector $\\mathbf{x}(t)$ is not directly measurable, a control strategy is implemented using a state-feedback controller with an observer. The control law is given by $u(t) = -K\\hat{\\mathbf{x}}(t)$, where $\\hat{\\mathbf{x}}(t)$ is the estimated state provided by a Luenberger observer. The dynamics of this observer are:\n$$\n\\dot{\\hat{\\mathbf{x}}}(t) = A\\hat{\\mathbf{x}}(t) + B u(t) + L(y(t) - C\\hat{\\mathbf{x}}(t))\n$$\nThe controller gain is a row vector $K = [k_1, k_2]$, and the observer gain is a column vector $L = [l_1, l_2]^T$.\n\nTo achieve the desired performance, the closed-loop poles of the controller are to be placed at $s = -4$ and $s = -5$. To ensure that the state estimate converges quickly, the poles of the observer error dynamics are to be placed at $s = -10$ and $s = -12$.\n\nBased on the separation principle, the controller and observer gains can be designed independently. Determine the numerical values for the four components of the gain vectors: $k_1, k_2, l_1,$ and $l_2$.", "solution": "We apply the separation principle: design the state-feedback gain $K$ so that the eigenvalues of $A - B K$ are at $s = -4$ and $s = -5$, and independently design the observer gain $L$ so that the eigenvalues of $A - L C$ are at $s = -10$ and $s = -12$.\n\nFirst, compute $K = [k_{1}, k_{2}]$ by matching the characteristic polynomial of $A - B K$ to the desired one. With $B K = \\begin{pmatrix} 0 & 0 \\\\ k_{1} & k_{2} \\end{pmatrix}$, we have\n$$\nA - B K = \\begin{pmatrix} 0 & 1 \\\\ -2 - k_{1} & -3 - k_{2} \\end{pmatrix}.\n$$\nThe characteristic polynomial is\n$$\n\\det\\!\\big(s I - (A - B K)\\big) = \\det \\begin{pmatrix} s & -1 \\\\ 2 + k_{1} & s + 3 + k_{2} \\end{pmatrix} = s^{2} + (3 + k_{2}) s + (2 + k_{1}).\n$$\nThe desired closed-loop characteristic polynomial for poles at $-4$ and $-5$ is\n$$\n(s + 4)(s + 5) = s^{2} + 9 s + 20.\n$$\nEquating coefficients yields\n$$\n3 + k_{2} = 9 \\quad \\Rightarrow \\quad k_{2} = 6, \\qquad 2 + k_{1} = 20 \\quad \\Rightarrow \\quad k_{1} = 18.\n$$\n\nNext, compute $L = \\begin{pmatrix} l_{1} \\\\ l_{2} \\end{pmatrix}$ by matching the characteristic polynomial of $A - L C$ to the desired one. Since $L C = \\begin{pmatrix} l_{1} & 0 \\\\ l_{2} & 0 \\end{pmatrix}$, we have\n$$\nA - L C = \\begin{pmatrix} -l_{1} & 1 \\\\ -2 - l_{2} & -3 \\end{pmatrix}.\n$$\nThe characteristic polynomial is\n$$\n\\det\\!\\big(s I - (A - L C)\\big) = \\det \\begin{pmatrix} s + l_{1} & -1 \\\\ 2 + l_{2} & s + 3 \\end{pmatrix} = (s + l_{1})(s + 3) + (2 + l_{2}) = s^{2} + (3 + l_{1}) s + (3 l_{1} + 2 + l_{2}).\n$$\nThe desired observer error characteristic polynomial for poles at $-10$ and $-12$ is\n$$\n(s + 10)(s + 12) = s^{2} + 22 s + 120.\n$$\nEquating coefficients gives\n$$\n3 + l_{1} = 22 \\quad \\Rightarrow \\quad l_{1} = 19, \\qquad 3 l_{1} + 2 + l_{2} = 120 \\quad \\Rightarrow \\quad l_{2} = 120 - 3 \\cdot 19 - 2 = 61.\n$$\n\nThus, the gains are $k_{1} = 18$, $k_{2} = 6$, $l_{1} = 19$, and $l_{2} = 61$.", "answer": "$$\\boxed{\\begin{pmatrix}18 & 6 & 19 & 61\\end{pmatrix}}$$", "id": "1563422"}, {"introduction": "After designing the controller gain $K$ and observer gain $L$ separately, how can we be sure the combined system behaves as intended? This exercise allows you to verify the celebrated separation principle by analyzing the full closed-loop system matrix. By calculating the eigenvalues, you will confirm that the poles of the overall system are precisely the collection of the individual controller and observer poles, providing a concrete demonstration of this fundamental theorem. [@problem_id:1563443]", "problem": "Consider a linear time-invariant (LTI) system described by the state-space equations $\\dot{x} = Ax + Bu$ and $y=Cx$, where $x \\in \\mathbb{R}^2$ is the state vector, $u \\in \\mathbb{R}$ is the control input, and $y \\in \\mathbb{R}$ is the measured output. The system matrices are given by:\n$$ A = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix} $$\nA dynamic output-feedback controller is implemented for this system. This controller consists of a state-feedback law $u = -K\\hat{x}$ combined with a Luenberger observer that generates the state estimate $\\hat{x}$. The controller gain matrix $K$ and the observer gain matrix $L$ have been pre-designed and are given as:\n$$ K = \\begin{pmatrix} 28 & 8 \\end{pmatrix}, \\quad L = \\begin{pmatrix} 19 \\\\ 61 \\end{pmatrix} $$\nThe dynamics of the complete closed-loop system, using an augmented state vector composed of the system state $x$ and the estimation error $e = x - \\hat{x}$, can be described by the linear equation $\\dot{z} = A_{cl}z$, where $z = \\begin{pmatrix} x \\\\ e \\end{pmatrix}$ and the combined system matrix $A_{cl}$ is:\n$$ A_{cl} = \\begin{pmatrix} A-BK & BK \\\\ \\mathbf{0} & A-LC \\end{pmatrix} $$\nwhere $\\mathbf{0}$ is the $2 \\times 2$ zero matrix.\n\nDetermine the four poles of this combined controller-observer system, which are the eigenvalues of the matrix $A_{cl}$. Present the poles as a set of four numerical values, sorted in ascending order.", "solution": "We use the separation principle for LTI systems with a Luenberger observer and state feedback. The augmented closed-loop matrix is block upper triangular,\n$$\nA_{cl}=\\begin{pmatrix}A-BK & BK \\\\ \\mathbf{0} & A-LC\\end{pmatrix},\n$$\nso its eigenvalues are the union of the eigenvalues of the diagonal blocks $A-BK$ and $A-LC$.\n\nFirst compute $BK$ and $LC$. With $B=\\begin{pmatrix}0\\\\1\\end{pmatrix}$ and $K=\\begin{pmatrix}28 & 8\\end{pmatrix}$,\n$$\nBK = B K = \\begin{pmatrix}0\\\\1\\end{pmatrix}\\begin{pmatrix}28 & 8\\end{pmatrix}\n= \\begin{pmatrix}0 & 0\\\\ 28 & 8\\end{pmatrix}.\n$$\nThus\n$$\nA-BK = \\begin{pmatrix}0 & 1\\\\ -2 & -3\\end{pmatrix} - \\begin{pmatrix}0 & 0\\\\ 28 & 8\\end{pmatrix}\n= \\begin{pmatrix}0 & 1\\\\ -30 & -11\\end{pmatrix}.\n$$\nThe characteristic polynomial of $A-BK$ is\n$$\n\\det(sI-(A-BK)) = \\det\\begin{pmatrix}s & -1\\\\ 30 & s+11\\end{pmatrix}\n= s(s+11)+30 = s^{2}+11s+30 = (s+5)(s+6),\n$$\nso the eigenvalues of $A-BK$ are $-5$ and $-6$.\n\nNext, with $L=\\begin{pmatrix}19\\\\61\\end{pmatrix}$ and $C=\\begin{pmatrix}1 & 0\\end{pmatrix}$,\n$$\nLC = L C = \\begin{pmatrix}19\\\\61\\end{pmatrix}\\begin{pmatrix}1 & 0\\end{pmatrix}\n= \\begin{pmatrix}19 & 0\\\\ 61 & 0\\end{pmatrix}.\n$$\nThus\n$$\nA-LC = \\begin{pmatrix}0 & 1\\\\ -2 & -3\\end{pmatrix} - \\begin{pmatrix}19 & 0\\\\ 61 & 0\\end{pmatrix}\n= \\begin{pmatrix}-19 & 1\\\\ -63 & -3\\end{pmatrix}.\n$$\nThe characteristic polynomial of $A-LC$ is\n$$\n\\det(sI-(A-LC)) = \\det\\begin{pmatrix}s+19 & -1\\\\ 63 & s+3\\end{pmatrix}\n= (s+19)(s+3)+63 = s^{2}+22s+120 = (s+10)(s+12),\n$$\nso the eigenvalues of $A-LC$ are $-10$ and $-12$.\n\nTherefore, the four poles of $A_{cl}$ are the union of these sets, sorted in ascending order: $-12$, $-10$, $-6$, $-5$.", "answer": "$$\\boxed{\\begin{pmatrix}-12 & -10 & -6 & -5\\end{pmatrix}}$$", "id": "1563443"}, {"introduction": "True mastery of a concept comes when we can predict a system's behavior from its design goals alone. This problem challenges your understanding of the separation principle by asking for the poles of a complete observer-based controller system given only the design specifications. This exercise demonstrates that the poles of the control loop and the observer error dynamics are preserved in the final system, allowing you to determine its overall characteristics without calculating the specific gain matrices. [@problem_id:1556750]", "problem": "Consider a third-order Linear Time-Invariant (LTI) system described by the state-space representation $\\dot{x} = Ax + Bu$ and $y = Cx$, where\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 6 & 5 & -2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 & 0 \\end{pmatrix}\n$$\nThe system is unstable and not all states are directly measured. To stabilize the system and achieve a desired performance, an observer-based state-feedback controller is designed. The control law is given by $u = -K\\hat{x}$, where $\\hat{x}$ is the state vector estimated by a full-order Luenberger observer:\n$$\n\\dot{\\hat{x}} = A\\hat{x} + Bu + L(y - C\\hat{x})\n$$\nThe gains $K$ and $L$ are chosen to meet specific performance criteria. The design specifications require the closed-loop controller poles to be placed at $\\{-10, -2+2j, -2-2j\\}$. Furthermore, the poles for the observer error dynamics are to be placed at $\\{-30, -6, -6\\}$ to ensure the state estimate converges faster than the system dynamics.\n\nDetermine the set of all eigenvalues for the complete, sixth-order, observer-based controller system, which is described by the combined dynamics of the plant state $x$ and the estimation error $e = x - \\hat{x}$. Express your answer as a single row matrix containing the six eigenvalues. The eigenvalues in the matrix must be sorted in ascending order based on their real parts. For any eigenvalues with the same real part, the one with the smaller imaginary part must be listed first.", "solution": "We begin with the plant and observer equations. The plant is given by $\\dot{x}=Ax+Bu$ with output $y=Cx$. The control law is $u=-K\\hat{x}$. The full-order observer is\n$$\n\\dot{\\hat{x}}=A\\hat{x}+Bu+L(y-C\\hat{x})=A\\hat{x}+Bu+L\\big(Cx-C\\hat{x}\\big).\n$$\nDefine the estimation error $e=x-\\hat{x}$, so that $\\hat{x}=x-e$. Substituting the control law into the plant dynamics yields\n$$\nu=-K\\hat{x}=-K(x-e)=-Kx+Ke,\n$$\nand therefore\n$$\n\\dot{x}=Ax+Bu=A x+B(-Kx+Ke)=(A-BK)x+BK\\,e.\n$$\nFor the error dynamics, compute\n$$\n\\dot{e}=\\dot{x}-\\dot{\\hat{x}}=(Ax+Bu)-\\big(A\\hat{x}+Bu+L(Cx-C\\hat{x})\\big)\n=A(x-\\hat{x})-L C(x-\\hat{x})=(A-LC)e.\n$$\nHence, the combined sixth-order dynamics in the coordinates $\\begin{pmatrix}x \\\\ e\\end{pmatrix}$ are\n$$\n\\begin{pmatrix}\\dot{x} \\\\ \\dot{e}\\end{pmatrix}\n=\n\\begin{pmatrix}\nA-BK & BK \\\\\n0 & A-LC\n\\end{pmatrix}\n\\begin{pmatrix}x \\\\ e\\end{pmatrix}.\n$$\nBecause this system matrix is block upper triangular, its eigenvalues are the union of the eigenvalues of the diagonal blocks $A-BK$ and $A-LC$. By design, the closed-loop poles of $A-BK$ are placed at $\\{-10,\\,-2+2j,\\,-2-2j\\}$, and the observer error poles of $A-LC$ are placed at $\\{-30,\\,-6,\\,-6\\}$. Therefore, the complete set of eigenvalues of the sixth-order augmented system is the union\n$$\n\\{-30,\\,-6,\\,-6,\\,-10,\\,-2-2j,\\,-2+2j\\}.\n$$\nSorting these in ascending order by real parts, and for equal real parts placing the one with the smaller imaginary part first, gives\n$$\n-30, -10, -6, -6, -2-2j, -2+2j.\n$$\nThus the required single row matrix is as stated.", "answer": "$$\\boxed{\\begin{pmatrix}-30 & -10 & -6 & -6 & -2-2j & -2+2j\\end{pmatrix}}$$", "id": "1556750"}]}