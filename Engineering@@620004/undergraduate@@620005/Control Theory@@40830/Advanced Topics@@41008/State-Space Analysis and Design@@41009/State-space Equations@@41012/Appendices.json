{"hands_on_practices": [{"introduction": "One of the most fundamental skills in control theory is the ability to translate a system's behavior from a classical differential equation into the modern state-space representation. This conversion is essential because it recasts a single high-order differential equation into a system of first-order equations, which is the standard format for computational analysis and advanced control design. In this first hands-on practice [@problem_id:1614942], you will learn the systematic procedure for deriving the state-space model, specifically in controller canonical form, from a given linear time-invariant differential equation.", "problem": "A linear time-invariant (LTI) system is described by the following third-order ordinary differential equation, which relates the output signal $y(t)$ to the input signal $u(t)$:\n$$\n\\frac{d^3y}{dt^3} + 4\\frac{d^2y}{dt^2} + 7\\frac{dy}{dt} + 3y(t) = 5\\frac{du}{dt} + 2u(t)\n$$\nThis system can be represented in state-space form using a state vector $\\mathbf{x}(t)$, a state matrix $A$, an input matrix $B$, an output matrix $C$, and a direct transmission matrix $D$. The standard form of the state-space equations is:\n$$\n\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + Bu(t)\n$$\n$$\ny(t) = C\\mathbf{x}(t) + Du(t)\n$$\nDetermine the state matrix $A$ for the system when it is represented in controller canonical form.", "solution": "To convert the given differential equation into the controller canonical state-space form, we first find the system's transfer function $G(s) = Y(s)/U(s)$. We take the Laplace transform of the differential equation, assuming zero initial conditions.\n\nThe given equation is:\n$$\n\\frac{d^3y}{dt^3} + 4\\frac{d^2y}{dt^2} + 7\\frac{dy}{dt} + 3y(t) = 5\\frac{du}{dt} + 2u(t)\n$$\nApplying the Laplace transform, where $\\mathcal{L}\\{f(t)\\} = F(s)$ and $\\mathcal{L}\\{\\frac{d^n f}{dt^n}\\} = s^n F(s)$ under zero initial conditions, we get:\n$$\ns^3Y(s) + 4s^2Y(s) + 7sY(s) + 3Y(s) = 5sU(s) + 2U(s)\n$$\nFactoring out $Y(s)$ and $U(s)$:\n$$\n(s^3 + 4s^2 + 7s + 3)Y(s) = (5s + 2)U(s)\n$$\nThe transfer function $G(s)$ is the ratio of the output $Y(s)$ to the input $U(s)$:\n$$\nG(s) = \\frac{Y(s)}{U(s)} = \\frac{5s + 2}{s^3 + 4s^2 + 7s + 3}\n$$\nFor the controller canonical form, we introduce an intermediate variable, let's call it $Z(s)$, such that the transfer function is split into two parts:\n$$\n\\frac{Z(s)}{U(s)} = \\frac{1}{s^3 + 4s^2 + 7s + 3} \\quad \\text{and} \\quad \\frac{Y(s)}{Z(s)} = 5s + 2\n$$\nFrom the first equation, we can write a differential equation for the intermediate variable $z(t)$:\n$$\n(s^3 + 4s^2 + 7s + 3)Z(s) = U(s)\n$$\nConverting this back to the time domain gives:\n$$\n\\frac{d^3z}{dt^3} + 4\\frac{d^2z}{dt^2} + 7\\frac{dz}{dt} + 3z(t) = u(t)\n$$\nNow, we define the state variables based on $z(t)$ and its derivatives. This is the standard choice for the controller canonical form. Let the state vector be $\\mathbf{x} = [x_1, x_2, x_3]^T$.\n$$\nx_1(t) = z(t)\n$$\n$$\nx_2(t) = \\dot{z}(t)\n$$\n$$\nx_3(t) = \\ddot{z}(t)\n$$\nWe can now write the state equations by taking the derivatives of these state variables:\n$$\n\\dot{x}_1 = \\dot{z} = x_2\n$$\n$$\n\\dot{x}_2 = \\ddot{z} = x_3\n$$\nTo find $\\dot{x}_3$, we use the differential equation for $z(t)$:\n$$\n\\dot{x}_3 = \\dddot{z} = -3z - 7\\dot{z} - 4\\ddot{z} + u(t)\n$$\nSubstituting the state variables into this equation:\n$$\n\\dot{x}_3 = -3x_1 - 7x_2 - 4x_3 + u(t)\n$$\nWe can now write these three state equations in matrix form $\\dot{\\mathbf{x}} = A\\mathbf{x} + Bu$:\n$$\n\\begin{pmatrix} \\dot{x}_1 \\\\ \\dot{x}_2 \\\\ \\dot{x}_3 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -3 & -7 & -4 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} u(t)\n$$\nFrom this, we can identify the state matrix $A$ and the input matrix $B$:\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -3 & -7 & -4 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\nThe problem asks specifically for the state matrix $A$. For completeness, let's also find the output equation. From our decomposition, $Y(s) = (5s + 2)Z(s)$, which in the time domain is:\n$$\ny(t) = 5\\dot{z}(t) + 2z(t)\n$$\nSubstituting the state variables:\n$$\ny(t) = 5x_2 + 2x_1\n$$\nIn matrix form $y = C\\mathbf{x} + Du$:\n$$\ny(t) = \\begin{pmatrix} 2 & 5 & 0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} + \\begin{pmatrix} 0 \\end{pmatrix} u(t)\n$$\nSo, the output matrix is $C = \\begin{pmatrix} 2 & 5 & 0 \\end{pmatrix}$ and the direct transmission matrix is $D = \\begin{pmatrix} 0 \\end{pmatrix}$.\n\nThe question asks for the state matrix $A$. Based on our derivation, the matrix is:\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -3 & -7 & -4 \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -3 & -7 & -4 \\end{pmatrix}}\n$$", "id": "1614942"}, {"introduction": "Complex engineering systems are often designed in a modular fashion, by interconnecting simpler, well-understood subsystems. The state-space framework is particularly powerful for this, as it provides a clear and algebraic method for combining models. This exercise [@problem_id:1614954] demonstrates how to create a single, comprehensive state-space model for a larger system formed by connecting two smaller systems in parallel, a common architecture found in fields from signal processing to aerospace engineering.", "problem": "Two independent Linear Time-Invariant (LTI) systems are described by their respective state-space models.\n\nSystem 1 is a second-order system with state vector $\\mathbf{x}_1(t) \\in \\mathbb{R}^2$, scalar input $u_1(t)$, and scalar output $y_1(t)$. Its dynamics are given by:\n$$\n\\dot{\\mathbf{x}}_1(t) = A_1 \\mathbf{x}_1(t) + B_1 u_1(t)\n$$\n$$\ny_1(t) = C_1 \\mathbf{x}_1(t) + D_1 u_1(t)\n$$\nwhere the matrices are:\n$$\nA_1 = \\begin{pmatrix} 0 & 1 \\\\ -5 & -6 \\end{pmatrix}, \\quad B_1 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C_1 = \\begin{pmatrix} 1 & 1 \\end{pmatrix}, \\quad D_1 = 0\n$$\n\nSystem 2 is a first-order system with state variable $x_2(t) \\in \\mathbb{R}$, scalar input $u_2(t)$, and scalar output $y_2(t)$. Its dynamics are given by:\n$$\n\\dot{x}_2(t) = A_2 x_2(t) + B_2 u_2(t)\n$$\n$$\ny_2(t) = C_2 x_2(t) + D_2 u_2(t)\n$$\nwhere the matrices (which are scalars in this case) are:\n$$\nA_2 = -2, \\quad B_2 = 3, \\quad C_2 = 1, \\quad D_2 = 1\n$$\n\nThese two systems are connected in parallel. This means they share the same input, $u(t)$, such that $u_1(t) = u_2(t) = u(t)$. The overall output of the combined system, $y(t)$, is the sum of their individual outputs, $y(t) = y_1(t) + y_2(t)$.\n\nThe resulting combined system can be described by a new, third-order state-space model using the composite state vector $\\mathbf{x}(t) = \\begin{pmatrix} \\mathbf{x}_1(t) \\\\ x_2(t) \\end{pmatrix}$. This model has the standard form:\n$$\n\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t)\n$$\n$$\ny(t) = C \\mathbf{x}(t) + D u(t)\n$$\n\nWhich of the following options correctly identifies the state-space matrices $A, B, C,$ and $D$ for the combined parallel system?\n\nA. $A = \\begin{pmatrix} 0 & 1 & 0 \\\\ -5 & -6 & 0 \\\\ 0 & 0 & -2 \\end{pmatrix}, B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 3 \\end{pmatrix}, C = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}, D = 1$\n\nB. $A = \\begin{pmatrix} 0 & 1 & 0 \\\\ -5 & -6 & 0 \\\\ 3 & 3 & -2 \\end{pmatrix}, B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, C = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}, D = 0$\n\nC. $A = \\begin{pmatrix} 0 & 1 & 0 \\\\ -5 & -6 & 0 \\\\ 0 & 0 & -2 \\end{pmatrix}, B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 3 \\end{pmatrix}, C = \\begin{pmatrix} 1 & 1 & -1 \\end{pmatrix}, D = -1$\n\nD. $A = \\begin{pmatrix} 0 & 1 & 0 \\\\ -5 & -6 & 0 \\\\ 0 & 0 & -2 \\end{pmatrix}, B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 3 \\end{pmatrix}, C = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}, D = 0$", "solution": "Because the systems are independent and connected in parallel with a shared input, the composite state is defined as $\\mathbf{x}(t) = \\begin{pmatrix} \\mathbf{x}_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}$, and the input to both subsystems is $u(t)$. The state equations of the subsystems are\n$$\n\\dot{\\mathbf{x}}_{1}(t) = A_{1}\\mathbf{x}_{1}(t) + B_{1}u(t), \\quad \\dot{x}_{2}(t) = A_{2}x_{2}(t) + B_{2}u(t).\n$$\nStacking these gives the overall state equation\n$$\n\\dot{\\mathbf{x}}(t) = \\begin{pmatrix} A_{1} & 0 \\\\ 0 & A_{2} \\end{pmatrix} \\mathbf{x}(t) + \\begin{pmatrix} B_{1} \\\\ B_{2} \\end{pmatrix} u(t).\n$$\nSubstituting the given matrices,\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 \\\\ -5 & -6 & 0 \\\\ 0 & 0 & -2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 3 \\end{pmatrix}.\n$$\n\nFor the output, the parallel interconnection yields $y(t) = y_{1}(t) + y_{2}(t)$, so\n$$\ny(t) = C_{1}\\mathbf{x}_{1}(t) + D_{1}u(t) + C_{2}x_{2}(t) + D_{2}u(t) = \\begin{pmatrix} C_{1} & C_{2} \\end{pmatrix} \\mathbf{x}(t) + (D_{1} + D_{2}) u(t).\n$$\nSubstituting the given matrices,\n$$\nC = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}, \\quad D = 0 + 1 = 1.\n$$\n\nTherefore, the correct combined state-space matrices are\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 \\\\ -5 & -6 & 0 \\\\ 0 & 0 & -2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 3 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}, \\quad D = 1,\n$$\nwhich corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "1614954"}, {"introduction": "Once we have a state-space model, its primary purpose is to predict how the system will behave over time in response to various inputs and initial conditions. This practice [@problem_id:1614978] brings the theory to life by having you calculate the explicit time response of a thermal control system for an instrument on a satellite. By solving the state-space equation, you will determine how the instrument's temperature evolves, combining the transient dynamics from its initial state with the steady-state response to a control input.", "problem": "A miniaturized satellite uses an active thermal control system to maintain the temperature of a critical onboard instrument. The system's thermal dynamics can be modeled by a state-space representation. Let the state vector be $\\mathbf{x}(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$, where $x_1(t)$ is the temperature deviation (in Kelvin) of the instrument from its desired operating point, and $x_2(t)$ is the temperature deviation of the instrument's mounting structure.\n\nThe system dynamics are described by the following linear time-invariant (LTI) equation:\n$$ \\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t) $$\nwith system matrices given by:\n$$ A = \\begin{pmatrix} -1 & 1 \\\\ -5 & -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\nThe input $u(t)$ is a normalized signal to the instrument's heater. At time $t=0$, the system is in an initial state $\\mathbf{x}(0) = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$. To bring the instrument to its operating temperature, the heater is activated with a constant signal, represented by a unit step input $u(t) = 1$ for $t \\ge 0$.\n\nDetermine the expression for the instrument's temperature deviation, $x_1(t)$, for all $t \\ge 0$.", "solution": "We are given the linear time-invariant system\n$$\n\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t), \\quad A = \\begin{pmatrix} -1 & 1 \\\\ -5 & -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n$$\nwith initial condition $\\mathbf{x}(0) = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$ and a unit step input $u(t)=1$ for $t \\ge 0$. The solution to such an LTI system is\n$$\n\\mathbf{x}(t) = \\exp(A t)\\,\\mathbf{x}(0) + \\int_{0}^{t} \\exp(A(t-\\tau))\\,B\\,u(\\tau)\\,d\\tau.\n$$\nFor a constant input $u(t)=1$, a constant particular (steady-state) solution $\\mathbf{x}_{\\mathrm{ss}}$ satisfies\n$$\nA\\,\\mathbf{x}_{\\mathrm{ss}} + B = \\mathbf{0} \\quad \\Longrightarrow \\quad \\mathbf{x}_{\\mathrm{ss}} = -A^{-1} B.\n$$\nCompute $A^{-1}$. The determinant is\n$$\n\\det(A) = (-1)(-3) - (1)(-5) = 8,\n$$\nand the adjugate is\n$$\n\\operatorname{adj}(A) = \\begin{pmatrix} -3 & -1 \\\\ 5 & -1 \\end{pmatrix},\n$$\nso\n$$\nA^{-1} = \\frac{1}{8} \\begin{pmatrix} -3 & -1 \\\\ 5 & -1 \\end{pmatrix}, \\quad A^{-1} B = \\frac{1}{8} \\begin{pmatrix} -3 \\\\ 5 \\end{pmatrix}.\n$$\nThus\n$$\n\\mathbf{x}_{\\mathrm{ss}} = -A^{-1} B = \\begin{pmatrix} \\frac{3}{8} \\\\ -\\frac{5}{8} \\end{pmatrix}.\n$$\nTherefore the full solution can be written as\n$$\n\\mathbf{x}(t) = \\exp(A t)\\,(\\mathbf{x}(0) - \\mathbf{x}_{\\mathrm{ss}}) + \\mathbf{x}_{\\mathrm{ss}}.\n$$\nDefine $\\mathbf{v} = \\mathbf{x}(0) - \\mathbf{x}_{\\mathrm{ss}} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} \\frac{3}{8} \\\\ -\\frac{5}{8} \\end{pmatrix} = \\begin{pmatrix} \\frac{13}{8} \\\\ \\frac{5}{8} \\end{pmatrix}$.\n\nTo compute $\\exp(A t)$, use the standard real-form expression for a $2 \\times 2$ matrix with complex-conjugate eigenvalues. The characteristic polynomial of $A$ is\n$$\n\\lambda^{2} + 4 \\lambda + 8 = 0,\n$$\nso the eigenvalues are $-2 \\pm 2 i$. Let $a = -2$ and $b = 2$. Then\n$$\n\\exp(A t) = \\exp(a t)\\left[ \\cos(b t)\\,I + \\frac{\\sin(b t)}{b}\\,(A - a I) \\right]\n= \\exp(-2 t)\\left[ \\cos(2 t)\\,I + \\frac{\\sin(2 t)}{2}\\,(A + 2 I) \\right].\n$$\nCompute $(A + 2 I)$ and apply to $\\mathbf{v}$:\n$$\nA + 2 I = \\begin{pmatrix} 1 & 1 \\\\ -5 & -1 \\end{pmatrix}, \\quad (A + 2 I)\\mathbf{v} = \\begin{pmatrix} 1 & 1 \\\\ -5 & -1 \\end{pmatrix} \\begin{pmatrix} \\frac{13}{8} \\\\ \\frac{5}{8} \\end{pmatrix} = \\begin{pmatrix} \\frac{18}{8} \\\\ -\\frac{70}{8} \\end{pmatrix} = \\begin{pmatrix} \\frac{9}{4} \\\\ -\\frac{35}{4} \\end{pmatrix}.\n$$\nTherefore\n$$\n\\exp(A t)\\,\\mathbf{v} = \\exp(-2 t)\\left[ \\cos(2 t)\\,\\mathbf{v} + \\frac{\\sin(2 t)}{2}\\,(A + 2 I)\\mathbf{v} \\right]\n= \\exp(-2 t)\\left[ \\cos(2 t)\\begin{pmatrix} \\frac{13}{8} \\\\ \\frac{5}{8} \\end{pmatrix} + \\frac{\\sin(2 t)}{2}\\begin{pmatrix} \\frac{9}{4} \\\\ -\\frac{35}{4} \\end{pmatrix} \\right].\n$$\nThe first component is\n$$\n\\left[\\exp(A t)\\,\\mathbf{v}\\right]_{1} = \\exp(-2 t)\\left( \\frac{13}{8}\\cos(2 t) + \\frac{9}{8}\\sin(2 t) \\right).\n$$\nAdding the steady-state first component $\\left(\\mathbf{x}_{\\mathrm{ss}}\\right)_{1} = \\frac{3}{8}$ yields\n$$\nx_{1}(t) = \\exp(-2 t)\\left( \\frac{13}{8}\\cos(2 t) + \\frac{9}{8}\\sin(2 t) \\right) + \\frac{3}{8}, \\quad t \\ge 0.\n$$\nThis satisfies the second-order reduced equation $\\ddot{x}_{1} + 4 \\dot{x}_{1} + 8 x_{1} = 3$ with initial conditions $x_{1}(0) = 2$ and $\\dot{x}_{1}(0) = -1$, confirming consistency.", "answer": "$$\\boxed{\\exp(-2 t)\\left(\\frac{13}{8}\\cos(2 t)+\\frac{9}{8}\\sin(2 t)\\right)+\\frac{3}{8}}$$", "id": "1614978"}]}