{"hands_on_practices": [{"introduction": "The journey from theoretical understanding to practical application often begins with mastering fundamental calculations. For stable continuous-time systems, the controllability Gramian can be determined by solving the algebraic Lyapunov equation. This exercise provides foundational practice in this essential technique, using a system of uncoupled subsystems to clearly illustrate how the structure of the Gramian reflects the system's physical properties [@problem_id:1565982].", "problem": "Consider a physical system composed of two independent, non-interacting subsystems. The state of the overall system is described by the state vector $\\mathbf{x}(t) = \\begin{pmatrix} x_1(t) & x_2(t) \\end{pmatrix}^T$, and its evolution is governed by the linear time-invariant (LTI) state-space equation $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B\\mathbf{u}(t)$.\n\nThe system dynamics are defined by the matrix $A$, and the control inputs $\\mathbf{u}(t)$ influence the system through the matrix $B$. For this particular system, the matrices are given as:\n$$\nA = \\begin{pmatrix} -\\lambda_1 & 0 \\\\ 0 & -\\lambda_2 \\end{pmatrix}\n\\quad \\text{and} \\quad\nB = \\begin{pmatrix} \\beta_1 & 0 \\\\ 0 & \\beta_2 \\end{pmatrix}\n$$\nHere, $\\lambda_1$ and $\\lambda_2$ are distinct positive constants representing the stable decay rates of the two subsystems, and $\\beta_1$ and $\\beta_2$ are non-zero real constants representing the effectiveness of the corresponding inputs.\n\nThe controllability of this stable system over an infinite time horizon can be quantified by the controllability Gramian, $W_c$. This Gramian is the unique symmetric positive-definite matrix that satisfies the continuous-time algebraic Lyapunov equation:\n$$\nAW_c + W_c A^T = -BB^T\n$$\nYour task is to solve this equation to determine the controllability Gramian $W_c$ for the given system. Express your answer as a 2x2 matrix in terms of the symbolic parameters $\\lambda_1, \\lambda_2, \\beta_1$, and $\\beta_2$.", "solution": "Given the continuous-time algebraic Lyapunov equation for the controllability Gramian $W_{c}$,\n$$\nA W_{c} + W_{c} A^{T} = - B B^{T},\n$$\nwith\n$$\nA = \\begin{pmatrix} -\\lambda_{1} & 0 \\\\ 0 & -\\lambda_{2} \\end{pmatrix}, \\quad B = \\begin{pmatrix} \\beta_{1} & 0 \\\\ 0 & \\beta_{2} \\end{pmatrix},\n$$\nand $\\lambda_{1}, \\lambda_{2} > 0$, $\\beta_{1}, \\beta_{2} \\neq 0$. Since $A$ is diagonal with negative diagonal entries, it is Hurwitz, so the Lyapunov equation has a unique symmetric positive-definite solution. Let\n$$\nW_{c} = \\begin{pmatrix} w_{11} & w_{12} \\\\ w_{12} & w_{22} \\end{pmatrix}, \\quad A^{T} = A, \\quad B B^{T} = \\begin{pmatrix} \\beta_{1}^{2} & 0 \\\\ 0 & \\beta_{2}^{2} \\end{pmatrix}.\n$$\nCompute each term:\n$$\nA W_{c} = \\begin{pmatrix} -\\lambda_{1} & 0 \\\\ 0 & -\\lambda_{2} \\end{pmatrix} \\begin{pmatrix} w_{11} & w_{12} \\\\ w_{12} & w_{22} \\end{pmatrix} = \\begin{pmatrix} -\\lambda_{1} w_{11} & -\\lambda_{1} w_{12} \\\\ -\\lambda_{2} w_{12} & -\\lambda_{2} w_{22} \\end{pmatrix},\n$$\n$$\nW_{c} A = \\begin{pmatrix} w_{11} & w_{12} \\\\ w_{12} & w_{22} \\end{pmatrix} \\begin{pmatrix} -\\lambda_{1} & 0 \\\\ 0 & -\\lambda_{2} \\end{pmatrix} = \\begin{pmatrix} -\\lambda_{1} w_{11} & -\\lambda_{2} w_{12} \\\\ -\\lambda_{1} w_{12} & -\\lambda_{2} w_{22} \\end{pmatrix}.\n$$\nThus,\n$$\nA W_{c} + W_{c} A = \\begin{pmatrix} -2 \\lambda_{1} w_{11} & -(\\lambda_{1} + \\lambda_{2}) w_{12} \\\\ -(\\lambda_{1} + \\lambda_{2}) w_{12} & -2 \\lambda_{2} w_{22} \\end{pmatrix}.\n$$\nEquating to $- B B^{T}$ gives the system\n$$\n-2 \\lambda_{1} w_{11} = - \\beta_{1}^{2}, \\quad -(\\lambda_{1} + \\lambda_{2}) w_{12} = 0, \\quad -2 \\lambda_{2} w_{22} = - \\beta_{2}^{2}.\n$$\nSolving using $\\lambda_{1}, \\lambda_{2} > 0$ yields\n$$\nw_{11} = \\frac{\\beta_{1}^{2}}{2 \\lambda_{1}}, \\quad w_{12} = 0, \\quad w_{22} = \\frac{\\beta_{2}^{2}}{2 \\lambda_{2}}.\n$$\nTherefore,\n$$\nW_{c} = \\begin{pmatrix} \\frac{\\beta_{1}^{2}}{2 \\lambda_{1}} & 0 \\\\ 0 & \\frac{\\beta_{2}^{2}}{2 \\lambda_{2}} \\end{pmatrix},\n$$\nwhich is symmetric positive-definite since $\\lambda_{1}, \\lambda_{2} > 0$ and $\\beta_{1}, \\beta_{2} \\neq 0$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\beta_{1}^{2}}{2 \\lambda_{1}} & 0 \\\\ 0 & \\frac{\\beta_{2}^{2}}{2 \\lambda_{2}}\\end{pmatrix}}$$", "id": "1565982"}, {"introduction": "A deep understanding of Gramians comes from connecting their mathematical properties to core system behaviors like stability. This practice problem uses the integral definition of the controllability Gramian to directly contrast a stable system with an unstable one. By calculating the time at which the growing Gramian of an unstable system matches the final value of its stable counterpart, you will build crucial intuition about control energy and why the infinite-horizon Gramian is a concept reserved for stable systems [@problem_id:1565972].", "problem": "Consider a first-order Linear Time-Invariant (LTI) system where the state dynamics are governed by the equation $\\dot{x}(t) = A x(t) + B u(t)$, with $x(t)$ being the scalar state and $u(t)$ being the scalar control input. The finite-horizon controllability Gramian over a time interval $[0, T]$ is defined as $W_c(T) = \\int_0^T e^{A\\tau} B B^T e^{A^T \\tau} d\\tau$.\n\nWe will analyze two such systems:\n1.  An unstable system, $S_U$, described by the state equation $\\dot{x}(t) = \\alpha x(t) + \\beta u(t)$.\n2.  A stable system, $S_S$, described by the state equation $\\dot{x}(t) = -\\alpha x(t) + \\beta u(t)$.\n\nIn these models, $\\alpha$ and $\\beta$ are real constants with $\\alpha > 0$ and $\\beta \\neq 0$.\n\nLet $W_{c,U}(T)$ denote the controllability Gramian for the unstable system $S_U$. The infinite-horizon controllability Gramian for the stable system $S_S$ is well-defined and is given by $W_{c,S}(\\infty) = \\lim_{T \\to \\infty} W_{c,S}(T)$, where $W_{c,S}(T)$ is the finite-horizon Gramian for $S_S$.\n\nDetermine the specific time horizon $T^*$ at which the value of the unstable system's Gramian, $W_{c,U}(T^*)$, becomes exactly equal to the stable system's infinite-horizon Gramian, $W_{c,S}(\\infty)$. Express your answer as an analytic expression in terms of $\\alpha$.", "solution": "For a scalar first-order LTI system with state equation $\\dot{x}(t) = A x(t) + B u(t)$, the finite-horizon controllability Gramian over $[0,T]$ is\n$$\nW_{c}(T) = \\int_{0}^{T} \\exp(A \\tau)\\, B B^{T}\\, \\exp(A^{T} \\tau)\\, d\\tau.\n$$\nSince $A$ and $B$ are scalars, $A^{T} = A$ and $B B^{T} = \\beta^{2}$. Therefore,\n$$\nW_{c}(T) = \\beta^{2} \\int_{0}^{T} \\exp(2 A \\tau)\\, d\\tau.\n$$\nEvaluating the integral for $A \\neq 0$ gives\n$$\nW_{c}(T) = \\beta^{2} \\left[\\frac{1}{2 A} \\exp(2 A \\tau)\\right]_{0}^{T} = \\frac{\\beta^{2}}{2 A}\\left(\\exp(2 A T) - 1\\right).\n$$\n\nFor the unstable system $S_{U}$ with $A = \\alpha$ and $\\alpha > 0$,\n$$\nW_{c,U}(T) = \\frac{\\beta^{2}}{2 \\alpha}\\left(\\exp(2 \\alpha T) - 1\\right).\n$$\nFor the stable system $S_{S}$ with $A = -\\alpha$,\n$$\nW_{c,S}(T) = \\beta^{2} \\int_{0}^{T} \\exp(-2 \\alpha \\tau)\\, d\\tau = \\frac{\\beta^{2}}{2 \\alpha}\\left(1 - \\exp(-2 \\alpha T)\\right),\n$$\nand the infinite-horizon Gramian is\n$$\nW_{c,S}(\\infty) = \\lim_{T \\to \\infty} W_{c,S}(T) = \\frac{\\beta^{2}}{2 \\alpha}.\n$$\n\nWe seek $T^{*}$ such that $W_{c,U}(T^{*}) = W_{c,S}(\\infty)$. Setting these equal,\n$$\n\\frac{\\beta^{2}}{2 \\alpha}\\left(\\exp(2 \\alpha T^{*}) - 1\\right) = \\frac{\\beta^{2}}{2 \\alpha}.\n$$\nBecause $\\alpha > 0$ and $\\beta \\neq 0$, we divide both sides by $\\frac{\\beta^{2}}{2 \\alpha}$ to obtain\n$$\n\\exp(2 \\alpha T^{*}) - 1 = 1 \\quad \\Rightarrow \\quad \\exp(2 \\alpha T^{*}) = 2.\n$$\nTaking the natural logarithm,\n$$\n2 \\alpha T^{*} = \\ln 2 \\quad \\Rightarrow \\quad T^{*} = \\frac{1}{2 \\alpha} \\ln 2.\n$$\nThis expression depends only on $\\alpha$, as required.", "answer": "$$\\boxed{\\frac{\\ln 2}{2\\alpha}}$$", "id": "1565972"}, {"introduction": "Complementing controllability is the concept of observability, which addresses our ability to deduce the internal state of a system from its external outputs. This exercise shifts our focus to the observability Gramian and connects it to a powerful application in state estimation and signal processing. You will not only compute the Gramian but also perform a Cholesky factorization, a technique used to create \"whitening\" filters that simplify estimation problems [@problem_id:1565970].", "problem": "In the field of state estimation for dynamic systems, understanding the observability of a system is crucial. For a stable Linear Time-Invariant (LTI) system described by $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t)$ with output $y(t) = C\\mathbf{x}(t)$, the infinite-horizon observability Gramian, $W_o$, quantifies how well the initial state $\\mathbf{x}(0)$ can be inferred from the output measurements $y(t)$ over the interval $[0, \\infty)$. The Gramian is defined as:\n$$W_o = \\int_0^\\infty e^{A^T t} C^T C e^{At} dt$$\nThe covariance of the error in an optimal estimate of $\\mathbf{x}(0)$ is proportional to $W_o^{-1}$.\n\nA common technique in signal processing for estimation is to \"whiten\" the measurement signal, which involves transforming the data so that the noise components are uncorrelated. This can be achieved using the Cholesky factorization of the observability Gramian in the form $W_o = R^T R$, where $R$ is an upper-triangular matrix. The matrix $R$ and its inverse are then used to construct this whitening transformation.\n\nConsider a system with the following state and output matrices:\n$$A = \\begin{pmatrix} -1 & 1 \\\\ 0 & -2 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$$\nDetermine the upper-triangular matrix $R$ from the Cholesky factorization $W_o = R^T R$, where $R$ has positive diagonal entries. Express your answer as a 2x2 matrix with exact symbolic entries.", "solution": "The problem asks for the upper-triangular matrix $R$ from the Cholesky factorization $W_o = R^T R$ of the infinite-horizon observability Gramian $W_o = \\int_0^\\infty e^{A^T t} C^T C e^{At} dt$.\n\nFirst, we need to compute the matrix exponential $e^{At}$ for the given matrix $A = \\begin{pmatrix} -1 & 1 \\\\ 0 & -2 \\end{pmatrix}$. Since $A$ is an upper-triangular matrix with distinct eigenvalues $\\lambda_1 = -1$ and $\\lambda_2 = -2$, we can use the formula for the matrix exponential of a 2x2 upper-triangular matrix. For a matrix $A = \\begin{pmatrix} a & b \\\\ 0 & d \\end{pmatrix}$ with $a \\neq d$, the exponential is $e^{At} = \\begin{pmatrix} e^{at} & b\\frac{e^{at}-e^{dt}}{a-d} \\\\ 0 & e^{dt} \\end{pmatrix}$.\nSubstituting $a=-1$, $b=1$, and $d=-2$:\n$$e^{At} = \\begin{pmatrix} e^{-t} & 1 \\cdot \\frac{e^{-t}-e^{-2t}}{-1 - (-2)} \\\\ 0 & e^{-2t} \\end{pmatrix} = \\begin{pmatrix} e^{-t} & e^{-t}-e^{-2t} \\\\ 0 & e^{-2t} \\end{pmatrix}$$\nThe transpose is $e^{A^T t} = (e^{At})^T = \\begin{pmatrix} e^{-t} & 0 \\\\ e^{-t}-e^{-2t} & e^{-2t} \\end{pmatrix}$.\n\nNext, we form the matrix $C^T C$. With $C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$:\n$$C^T C = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$$\n\nNow we can form the integrand $M(t) = e^{A^T t} C^T C e^{At}$:\n$$M(t) = \\begin{pmatrix} e^{-t} & 0 \\\\ e^{-t}-e^{-2t} & e^{-2t} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} e^{-t} & e^{-t}-e^{-2t} \\\\ 0 & e^{-2t} \\end{pmatrix}$$\nFirst, compute the product of the first two matrices:\n$$e^{A^T t} C^T C = \\begin{pmatrix} e^{-t} & 0 \\\\ e^{-t}-e^{-2t} & e^{-2t} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} e^{-t} & 0 \\\\ e^{-t}-e^{-2t} & 0 \\end{pmatrix}$$\nNow, multiply by the third matrix:\n$$M(t) = \\begin{pmatrix} e^{-t} & 0 \\\\ e^{-t}-e^{-2t} & 0 \\end{pmatrix} \\begin{pmatrix} e^{-t} & e^{-t}-e^{-2t} \\\\ 0 & e^{-2t} \\end{pmatrix} = \\begin{pmatrix} e^{-2t} & e^{-t}(e^{-t}-e^{-2t}) \\\\ (e^{-t}-e^{-2t})e^{-t} & (e^{-t}-e^{-2t})^2 \\end{pmatrix}$$\nSimplifying the terms in $M(t)$:\n$$M(t) = \\begin{pmatrix} e^{-2t} & e^{-2t}-e^{-3t} \\\\ e^{-2t}-e^{-3t} & e^{-2t} - 2e^{-3t} + e^{-4t} \\end{pmatrix}$$\n\nThe observability Gramian $W_o$ is the integral of $M(t)$ from $0$ to $\\infty$. We integrate each element of the matrix. For a stable system, $\\int_0^\\infty e^{-kt} dt = \\frac{1}{k}$ for $k > 0$.\n$W_{o,11} = \\int_0^\\infty e^{-2t} dt = \\frac{1}{2}$\n$W_{o,12} = W_{o,21} = \\int_0^\\infty (e^{-2t}-e^{-3t}) dt = \\frac{1}{2} - \\frac{1}{3} = \\frac{1}{6}$\n$W_{o,22} = \\int_0^\\infty (e^{-2t} - 2e^{-3t} + e^{-4t}) dt = \\frac{1}{2} - 2\\left(\\frac{1}{3}\\right) + \\frac{1}{4} = \\frac{6 - 8 + 3}{12} = \\frac{1}{12}$\nSo, the observability Gramian is:\n$$W_o = \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{6} \\\\ \\frac{1}{6} & \\frac{1}{12} \\end{pmatrix}$$\n\nFinally, we perform the Cholesky factorization $W_o = R^T R$, where $R = \\begin{pmatrix} r_{11} & r_{12} \\\\ 0 & r_{22} \\end{pmatrix}$ is an upper-triangular matrix with positive diagonal entries ($r_{11}>0, r_{22}>0$).\n$$R^T R = \\begin{pmatrix} r_{11} & 0 \\\\ r_{12} & r_{22} \\end{pmatrix} \\begin{pmatrix} r_{11} & r_{12} \\\\ 0 & r_{22} \\end{pmatrix} = \\begin{pmatrix} r_{11}^2 & r_{11}r_{12} \\\\ r_{11}r_{12} & r_{12}^2 + r_{22}^2 \\end{pmatrix}$$\nEquating this with $W_o$:\n1. $r_{11}^2 = W_{o,11} = \\frac{1}{2} \\implies r_{11} = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}} = \\frac{\\sqrt{2}}{2}$.\n2. $r_{11}r_{12} = W_{o,12} = \\frac{1}{6} \\implies \\left(\\frac{\\sqrt{2}}{2}\\right)r_{12} = \\frac{1}{6} \\implies r_{12} = \\frac{1}{6} \\frac{2}{\\sqrt{2}} = \\frac{1}{3\\sqrt{2}} = \\frac{\\sqrt{2}}{6}$.\n3. $r_{12}^2 + r_{22}^2 = W_{o,22} = \\frac{1}{12} \\implies r_{22}^2 = \\frac{1}{12} - r_{12}^2 = \\frac{1}{12} - \\left(\\frac{\\sqrt{2}}{6}\\right)^2 = \\frac{1}{12} - \\frac{2}{36} = \\frac{1}{12} - \\frac{1}{18}$.\nTo subtract the fractions, we find a common denominator, which is 36:\n$$r_{22}^2 = \\frac{3}{36} - \\frac{2}{36} = \\frac{1}{36}$$\n$$r_{22} = \\sqrt{\\frac{1}{36}} = \\frac{1}{6}$$\nSince $r_{11} = \\frac{\\sqrt{2}}{2} > 0$ and $r_{22} = \\frac{1}{6} > 0$, the conditions are met.\n\nThe resulting matrix $R$ is:\n$$R = \\begin{pmatrix} \\frac{\\sqrt{2}}{2} & \\frac{\\sqrt{2}}{6} \\\\ 0 & \\frac{1}{6} \\end{pmatrix}$$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\sqrt{2}}{2} & \\frac{\\sqrt{2}}{6} \\\\ 0 & \\frac{1}{6} \\end{pmatrix}}$$", "id": "1565970"}]}