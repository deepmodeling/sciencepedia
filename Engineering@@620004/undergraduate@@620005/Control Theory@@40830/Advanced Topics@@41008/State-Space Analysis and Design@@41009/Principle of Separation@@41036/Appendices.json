{"hands_on_practices": [{"introduction": "The power of the separation principle lies in its 'divide and conquer' approach to controller design. We can first design a state-feedback gain $K$ as if all states were measurable, and then separately design an observer gain $L$ to estimate those states. This exercise [@problem_id:1601360] walks you through this two-stage process for a simple integrator system and culminates in synthesizing your two designs into a single, implementable dynamic controller $C(s)$.", "problem": "Consider a simplified model for controlling the liquid level in a large tank. The state of the system is the liquid level, $x(t)$, measured in meters. The dynamics are governed by the first-order differential equation $\\dot{x}(t) = u(t)$, where $u(t)$ is the control input representing the net inflow rate in meters per second. A sensor provides a direct measurement of the liquid level, so the system output is $y(t) = x(t)$.\n\nA control engineer is tasked with designing a dynamic controller based on an observer-based state-feedback architecture. The design specifications require that the closed-loop pole associated with the state-feedback control action be placed at $-2$, and the pole associated with the state observer error dynamics be placed at $-20$.\n\nDetermine the transfer function $C(s) = U(s)/Y(s)$ of the resulting dynamic controller.", "solution": "The plant is given by the state-space model with $A=0$, $B=1$, and $C=1$ because $\\dot{x}(t)=u(t)$ and $y(t)=x(t)$.\n\nThe state-feedback gain $K$ is chosen to place the closed-loop pole of $A-BK$ at $-2$. Since $A-BK=0-1\\cdot K=-K$, the requirement $-K=-2$ implies\n$$\nK=2.\n$$\n\nThe observer gain $L$ is chosen to place the observer error dynamics pole of $A-LC$ at $-20$. Since $A-LC=0-L\\cdot 1=-L$, the requirement $-L=-20$ implies\n$$\nL=20.\n$$\n\nUsing a Luenberger observer and state feedback, the controller is defined by\n$$\n\\dot{\\hat{x}}=A\\hat{x}+Bu+L\\left(y-C\\hat{x}\\right), \\quad u=-K\\hat{x}.\n$$\nSubstituting $A=0$, $B=1$, $C=1$, and $u=-K\\hat{x}$ gives\n$$\n\\dot{\\hat{x}}=u+L\\left(y-\\hat{x}\\right)=-(K+L)\\hat{x}+Ly.\n$$\nTaking Laplace transforms with zero initial condition,\n$$\ns\\hat{X}(s)=-(K+L)\\hat{X}(s)+L Y(s) \\quad \\Rightarrow \\quad \\hat{X}(s)=\\frac{L}{s+K+L}Y(s).\n$$\nThen\n$$\nU(s)=-K\\hat{X}(s)=-K\\frac{L}{s+K+L}Y(s),\n$$\nso the dynamic controller transfer function is\n$$\nC(s)=\\frac{U(s)}{Y(s)}=-\\frac{K L}{s+K+L}.\n$$\nWith $K=2$ and $L=20$, this becomes\n$$\nC(s)=-\\frac{40}{s+22}.\n$$", "answer": "$$\\boxed{-\\frac{40}{s+22}}$$", "id": "1601360"}, {"introduction": "A key insight from the separation principle is that the stability of the overall system depends on the stability of *both* the controller and the observer. The poles of the combined system are simply the union of the individual controller and observer poles. In this practice [@problem_id:1601363], you will analyze a scenario where a stabilizing controller is paired with an unstable observer, directly demonstrating how instability in one part guarantees instability for the entire system.", "problem": "An engineer is designing a control system for an unstable process modeled as a continuous-time Linear Time-Invariant (LTI) system. The system dynamics are described by the state-space equations $\\dot{x}(t) = Ax(t) + Bu(t)$ and $y(t) = Cx(t)$, where $x(t)$ is the state vector, $u(t)$ is the control input, and $y(t)$ is the measured output.\n\nThe system matrices are given as:\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ 3 & -2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}\n$$\n\nA full state-feedback controller of the form $u(t) = -Kx(t)$ is not feasible because not all states are directly measurable. Therefore, an observer-based controller is proposed. The control law will be $u(t) = -K\\hat{x}(t)$, where $\\hat{x}(t)$ is the state estimate provided by a Luenberger observer.\n\nA state-feedback gain $K = \\begin{pmatrix} 11 & 4 \\end{pmatrix}$ has been designed, which is known to place the poles of the state-feedback system ($A-BK$) in stable locations. For the observer, a gain matrix $L = \\begin{pmatrix} -4 \\\\ 1 \\end{pmatrix}$ has been chosen.\n\nYour task is to analyze the stability of the complete closed-loop system, which consists of the plant, the observer, and the state-feedback law. Calculate the value of the closed-loop pole with the largest real part. Round your final answer to three significant figures.", "solution": "The stability of the overall observer-based control system is determined by the set of all its closed-loop poles. According to the principle of separation in control theory, the set of poles of the combined system (plant with an observer-based controller) is the union of the set of poles of the state-feedback regulator and the set of poles of the observer.\n\nWe need to find these two sets of poles independently.\n\nFirst, we determine the poles of the state-feedback regulator. These are the eigenvalues of the matrix $(A-BK)$. The state-feedback gain is given as $K = \\begin{pmatrix} 11 & 4 \\end{pmatrix}$.\nThe matrix $(A-BK)$ is calculated as:\n$$\nA - BK = \\begin{pmatrix} 0 & 1 \\\\ 3 & -2 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 11 & 4 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 3 & -2 \\end{pmatrix} - \\begin{pmatrix} 0 & 0 \\\\ 11 & 4 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -8 & -6 \\end{pmatrix}\n$$\nThe poles are the roots of the characteristic equation, $\\det(\\lambda I - (A-BK)) = 0$.\n$$\n\\det\\left( \\begin{pmatrix} \\lambda & 0 \\\\ 0 & \\lambda \\end{pmatrix} - \\begin{pmatrix} 0 & 1 \\\\ -8 & -6 \\end{pmatrix} \\right) = \\det\\begin{pmatrix} \\lambda & -1 \\\\ 8 & \\lambda+6 \\end{pmatrix} = 0\n$$\n$$\n\\lambda(\\lambda+6) - (-1)(8) = \\lambda^{2} + 6\\lambda + 8 = 0\n$$\nFactoring this polynomial gives:\n$$\n(\\lambda+2)(\\lambda+4) = 0\n$$\nSo, the poles of the state-feedback regulator are $\\lambda_{1} = -2$ and $\\lambda_{2} = -4$. Both poles have negative real parts, confirming that the controller is stabilizing.\n\nSecond, we determine the poles of the state observer. These are the eigenvalues of the matrix $(A-LC)$. The observer gain is given as $L = \\begin{pmatrix} -4 \\\\ 1 \\end{pmatrix}$.\nThe matrix $(A-LC)$ is calculated as:\n$$\nA - LC = \\begin{pmatrix} 0 & 1 \\\\ 3 & -2 \\end{pmatrix} - \\begin{pmatrix} -4 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 3 & -2 \\end{pmatrix} - \\begin{pmatrix} -4 & 0 \\\\ 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 4 & 1 \\\\ 2 & -2 \\end{pmatrix}\n$$\nThe observer poles are the roots of the characteristic equation, $\\det(\\lambda I - (A-LC)) = 0$.\n$$\n\\det\\left( \\begin{pmatrix} \\lambda & 0 \\\\ 0 & \\lambda \\end{pmatrix} - \\begin{pmatrix} 4 & 1 \\\\ 2 & -2 \\end{pmatrix} \\right) = \\det\\begin{pmatrix} \\lambda-4 & -1 \\\\ -2 & \\lambda+2 \\end{pmatrix} = 0\n$$\n$$\n(\\lambda-4)(\\lambda+2) - (-1)(-2) = \\lambda^{2} - 2\\lambda - 8 - 2 = \\lambda^{2} - 2\\lambda - 10 = 0\n$$\nWe use the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^{2}-4ac}}{2a}$, to find the roots of this equation, with $a=1$, $b=-2$, and $c=-10$.\n$$\n\\lambda = \\frac{-(-2) \\pm \\sqrt{(-2)^{2} - 4(1)(-10)}}{2(1)} = \\frac{2 \\pm \\sqrt{4 + 40}}{2} = \\frac{2 \\pm \\sqrt{44}}{2} = 1 \\pm \\sqrt{11}\n$$\nSo, the poles of the observer are $\\lambda_{3} = 1 + \\sqrt{11}$ and $\\lambda_{4} = 1 - \\sqrt{11}$. Because the pole $1 + \\sqrt{11}$ has a positive real part, the observer is unstable.\n\nThe set of all closed-loop poles for the complete system is the union of these two sets: $\\{-2, -4, 1 + \\sqrt{11}, 1 - \\sqrt{11}\\}$.\n\nThe question asks for the pole with the largest real part. We compare the real parts of all four poles:\n$\\operatorname{Re}(-2) = -2$\n$\\operatorname{Re}(-4) = -4$\n$\\operatorname{Re}(1 + \\sqrt{11}) = 1 + \\sqrt{11} \\approx 1 + 3.3166 = 4.3166$\n$\\operatorname{Re}(1 - \\sqrt{11}) = 1 - \\sqrt{11} \\approx 1 - 3.3166 = -2.3166$\n\nThe pole with the largest real part is $1 + \\sqrt{11}$. We need to provide its numerical value rounded to three significant figures.\nValue $= 1 + \\sqrt{11} \\approx 4.3166247...$\nRounding to three significant figures, we get $4.32$.\nSince there is a pole with a positive real part, the overall system is unstable, despite the controller design being stable.", "answer": "$$\\boxed{4.32}$$", "id": "1601363"}, {"introduction": "While the separation principle allows us to design the controller and observer independently, this powerful tool is only effective if the system meets certain criteria. This conceptual problem [@problem_id:1601326] explores the fundamental limits of this method. You'll investigate why the ability to stabilize a system using output feedback hinges on the concepts of stabilizability and detectability, and what happens when an unstable mode is fundamentally hidden from the observer.", "problem": "An engineer is tasked with designing a stabilizing controller for a satellite's attitude control system. The dynamics of the system are modeled as a linear time-invariant (LTI) system described by the state-space equations:\n$$ \\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B \\mathbf{u}(t) $$\n$$ \\mathbf{y}(t) = C \\mathbf{x}(t) $$\nwhere $\\mathbf{x}$ is the state vector, $\\mathbf{u}$ is the control input vector, and $\\mathbf{y}$ is the output measurement vector.\n\nDue to the limited number and placement of sensors on the satellite, not all state variables can be directly measured; only the output $\\mathbf{y}(t)$ is available for feedback. The engineer plans to implement an output feedback controller of the form $\\mathbf{u}(t) = -K \\hat{\\mathbf{x}}(t)$, where $\\hat{\\mathbf{x}}(t)$ is the state estimate generated by a full-order Luenberger observer. This design strategy relies on the separation principle.\n\nA thorough analysis of the system matrices $(A, B, C)$ reveals two critical properties:\n1. The system is fully controllable.\n2. The system is not fully observable, and one of the system's unstable modes (i.e., an eigenvalue of $A$ with a positive real part) is unobservable.\n\nBased on this information, which of the following conclusions is correct regarding the engineer's plan to stabilize the system using this output feedback strategy?\n\nA. The system can be stabilized. The separation principle allows the controller gain $K$ and observer gain $L$ to be designed independently. Since the system is controllable, a stabilizing gain $K$ can be found, which is sufficient for overall stability.\n\nB. The system cannot be stabilized. Stabilization using output feedback is only possible if the system is both controllable and observable. Since it is not observable, stabilization is impossible regardless of the properties of the unobservable modes.\n\nC. The system cannot be stabilized. The observer cannot estimate the state associated with the unstable, unobservable mode. Therefore, the controller, which relies on the state estimate, will be unable to apply a corrective input to counteract this specific instability.\n\nD. The system can be stabilized, but only if the observer's poles are placed to be significantly faster than the controller's poles. A very fast observer can estimate the unstable state quickly enough for the controller to react and stabilize it.\n\nE. The system can be stabilized. The property of controllability implies the system is also stabilizable, which means all unstable modes can be controlled. The lack of observability might degrade performance but does not prevent stabilization.", "solution": "We start from the LTI plant\n$$\n\\dot{\\mathbf{x}}(t)=A \\mathbf{x}(t)+B \\mathbf{u}(t), \\quad \\mathbf{y}(t)=C \\mathbf{x}(t),\n$$\nand the intended output-feedback via a full-order Luenberger observer with control law\n$$\n\\mathbf{u}(t)=-K \\hat{\\mathbf{x}}(t),\n$$\nand observer\n$$\n\\dot{\\hat{\\mathbf{x}}}(t)=A \\hat{\\mathbf{x}}(t)+B \\mathbf{u}(t)+L\\big(\\mathbf{y}(t)-C \\hat{\\mathbf{x}}(t)\\big).\n$$\nSubstituting $\\mathbf{u}(t)=-K \\hat{\\mathbf{x}}(t)$ and $\\mathbf{y}(t)=C \\mathbf{x}(t)$ gives\n$$\n\\dot{\\mathbf{x}}=A \\mathbf{x} - B K \\hat{\\mathbf{x}}, \\qquad\n\\dot{\\hat{\\mathbf{x}}}=(A-BK)\\hat{\\mathbf{x}}+L C\\big(\\mathbf{x}-\\hat{\\mathbf{x}}\\big).\n$$\nDefine the estimation error $\\mathbf{e}:=\\mathbf{x}-\\hat{\\mathbf{x}}$. Then\n$$\n\\dot{\\mathbf{e}}=\\dot{\\mathbf{x}}-\\dot{\\hat{\\mathbf{x}}}=\\big(A\\mathbf{x}-BK\\hat{\\mathbf{x}}\\big)-\\big((A-BK)\\hat{\\mathbf{x}}+LC(\\mathbf{x}-\\hat{\\mathbf{x}})\\big)\n=(A-LC)\\mathbf{e}.\n$$\nAlso,\n$$\n\\dot{\\mathbf{x}}=A \\mathbf{x} - B K \\hat{\\mathbf{x}}=A \\mathbf{x} - B K (\\mathbf{x}-\\mathbf{e})=(A-BK)\\mathbf{x} + B K \\mathbf{e}.\n$$\nTherefore, the augmented closed-loop dynamics in the coordinates $(\\mathbf{x},\\mathbf{e})$ is\n$$\n\\begin{pmatrix}\\dot{\\mathbf{x}}\\\\ \\dot{\\mathbf{e}}\\end{pmatrix}\n=\n\\begin{pmatrix}\nA-BK & BK\\\\\n0 & A-LC\n\\end{pmatrix}\n\\begin{pmatrix}\\mathbf{x}\\\\ \\mathbf{e}\\end{pmatrix}.\n$$\nBy the separation principle, the eigenvalues of the closed-loop matrix are the union of the eigenvalues of $A-BK$ and $A-LC$. Hence, closed-loop asymptotic stability requires both $A-BK$ and $A-LC$ to be Hurwitz.\n\nGiven that the system is fully controllable, there exists $K$ such that $A-BK$ is Hurwitz. The observer error dynamics $A-LC$ can be made Hurwitz if and only if $(A,C)$ is detectable. Detectability is equivalent to the condition that all unobservable modes of $A$ have strictly negative real parts.\n\nThe problem states that the system is not fully observable and that one unstable mode (an eigenvalue $\\lambda$ of $A$ with $\\operatorname{Re}(\\lambda)>0$) is unobservable. Let $\\mathbf{v} \\neq 0$ satisfy $A \\mathbf{v}=\\lambda \\mathbf{v}$ and $C \\mathbf{v}=0$. For any choice of $L$, we have\n$$\n(A-LC)\\mathbf{v} = A \\mathbf{v} - L C \\mathbf{v} = \\lambda \\mathbf{v},\n$$\nso $\\lambda$ is an eigenvalue of $A-LC$. Because $\\operatorname{Re}(\\lambda)>0$, the matrix $A-LC$ cannot be Hurwitz for any $L$. Therefore, the augmented closed-loop system necessarily has an unstable eigenvalue and cannot be stabilized by this observer-based output-feedback strategy.\n\nThis rules out statements A, D, and E. Statement B is too strong because stabilization by output feedback requires stabilizability and detectability, not full observability; stable unobservable modes are allowable. Statement C correctly identifies that the unobservable unstable mode cannot be estimated by the observer and, consequently, the controller relying on the state estimate cannot stabilize that mode, preventing overall stabilization.", "answer": "$$\\boxed{C}$$", "id": "1601326"}]}