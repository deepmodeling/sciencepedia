{"hands_on_practices": [{"introduction": "Before we can design a state estimator, we must first answer a fundamental question: is it even possible to deduce all the internal states from the available measurements? This property is called observability, and it is the cornerstone of observer design. This exercise [@problem_id:1584834] presents a practical scenario where a design choice—the placement of a sensor—alters the output matrix $C$ and ultimately determines whether the system's full state can be reconstructed.", "problem": "An engineering team is developing a state-feedback controller for a simplified one-dimensional model of a two-body satellite system connected by a flexible tether. The system consists of two masses, $m_1$ and $m_2$, connected by a spring with constant $k$. An external force $u(t)$ can be applied to mass $m_1$. For modeling purposes, the masses and spring constant are normalized such that $m_1=1$, $m_2=1$, and $k=1$. Damping is considered negligible.\n\nThe state of the system is described by the vector $\\mathbf{x} = [p_1, v_1, p_2, v_2]^T$, where $p_1$ and $v_1$ are the position and velocity of the first mass, and $p_2$ and $v_2$ are the position and velocity of the second mass. The linearized dynamics are given by the state-space equation $\\dot{\\mathbf{x}} = A\\mathbf{x} + B u$, with the system matrix $A$ given by:\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n-1 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n1 & 0 & -1 & 0\n\\end{pmatrix}\n$$\n\nTo implement a state estimator (an observer), the team must be able to reconstruct the full state vector $\\mathbf{x}$ from the available measurements. Two different sensor configurations are proposed, leading to two different output equations $y = C\\mathbf{x}$.\n\n**Configuration 1**: A sensor directly measures the absolute position of the first mass, $p_1$. The corresponding output matrix is:\n$$\nC_1 = \\begin{pmatrix} 1 & 0 & 0 & 0 \\end{pmatrix}\n$$\n\n**Configuration 2**: A different sensor measures the relative displacement between the two masses, $p_1 - p_2$. The corresponding output matrix is:\n$$\nC_2 = \\begin{pmatrix} 1 & 0 & -1 & 0 \\end{pmatrix}\n$$\n\nYour task is to determine which of these configurations results in an observable system.\n\nA) Only Configuration 1 is observable.\n\nB) Only Configuration 2 is observable.\n\nC) Both configurations are observable.\n\nD) Neither configuration is observable.", "solution": "For a linear time-invariant system with state matrix $A$ and output matrix $C$, the system is observable if and only if the observability matrix\n$$\n\\mathcal{O} = \\begin{pmatrix}\nC \\\\\nCA \\\\\nCA^{2} \\\\\nCA^{3}\n\\end{pmatrix}\n$$\nhas rank equal to the state dimension, which here is $4$.\n\nGiven\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n-1 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n1 & 0 & -1 & 0\n\\end{pmatrix},\n$$\nwe test each configuration.\n\nConfiguration 1: $C_{1} = \\begin{pmatrix} 1 & 0 & 0 & 0 \\end{pmatrix}$.\n\nCompute successive products:\n$$\nC_{1}A = \\begin{pmatrix} 0 & 1 & 0 & 0 \\end{pmatrix},\n$$\n$$\nC_{1}A^{2} = (C_{1}A)A = \\begin{pmatrix} -1 & 0 & 1 & 0 \\end{pmatrix},\n$$\n$$\nC_{1}A^{3} = (C_{1}A^{2})A = \\begin{pmatrix} 0 & -1 & 0 & 1 \\end{pmatrix}.\n$$\nThus\n$$\n\\mathcal{O}_{1} = \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n-1 & 0 & 1 & 0 \\\\\n0 & -1 & 0 & 1\n\\end{pmatrix}.\n$$\nThe columns of $\\mathcal{O}_{1}$ are\n$$\n\\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\\\ 0 \\end{pmatrix},\\quad\n\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix},\\quad\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix},\\quad\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix},\n$$\nwhich are linearly independent. Therefore $\\operatorname{rank}(\\mathcal{O}_{1}) = 4$, so Configuration 1 is observable.\n\nConfiguration 2: $C_{2} = \\begin{pmatrix} 1 & 0 & -1 & 0 \\end{pmatrix}$.\n\nCompute successive products:\n$$\nC_{2}A = \\begin{pmatrix} 0 & 1 & 0 & -1 \\end{pmatrix},\n$$\n$$\nC_{2}A^{2} = (C_{2}A)A = \\begin{pmatrix} -2 & 0 & 2 & 0 \\end{pmatrix} = -2 C_{2},\n$$\n$$\nC_{2}A^{3} = (C_{2}A^{2})A = -2(C_{2}A) = \\begin{pmatrix} 0 & -2 & 0 & 2 \\end{pmatrix}.\n$$\nThus\n$$\n\\mathcal{O}_{2} = \\begin{pmatrix}\n1 & 0 & -1 & 0 \\\\\n0 & 1 & 0 & -1 \\\\\n-2 & 0 & 2 & 0 \\\\\n0 & -2 & 0 & 2\n\\end{pmatrix},\n$$\nwhere the third row equals $-2$ times the first row and the fourth row equals $-2$ times the second row. Hence $\\operatorname{rank}(\\mathcal{O}_{2}) = 2 < 4$, and Configuration 2 is not observable.\n\nTherefore, only Configuration 1 is observable.", "answer": "$$\\boxed{A}$$", "id": "1584834"}, {"introduction": "Once a system is verified as observable, the next step is the design of the observer itself, which hinges on calculating the observer gain $L$. This gain is crucial as it dictates how the estimation error behaves over time. This practice [@problem_id:1584819] guides you through the essential technique of pole placement, where you will derive the gains necessary to place the eigenvalues of the error dynamics matrix, $A-LC$, at desired locations to ensure stable and rapid error convergence.", "problem": "Consider a second-order Linear Time-Invariant (LTI) system described by the following state-space model:\n$$\n\\begin{aligned}\n\\dot{\\mathbf{x}}(t) &= A \\mathbf{x}(t) + B \\mathbf{u}(t) \\\\\ny(t) &= C \\mathbf{x}(t)\n\\end{aligned}\n$$\nwhere the state vector is $\\mathbf{x}(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$, and the matrices are given by:\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ -a_0 & -a_1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}\n$$\nHere, $a_0$ and $a_1$ are real-valued system parameters. The input matrix $B$ and the input vector $\\mathbf{u}(t)$ are not relevant for this problem.\n\nA full-state Luenberger observer is designed for this system. The dynamics of the estimated state vector, $\\hat{\\mathbf{x}}(t)$, are governed by the equation:\n$$\n\\dot{\\hat{\\mathbf{x}}}(t) = A \\hat{\\mathbf{x}}(t) + B \\mathbf{u}(t) + L(y(t) - C\\hat{\\mathbf{x}}(t))\n$$\nThe observer gain is a column vector $L = \\begin{pmatrix} l_1 \\\\ l_2 \\end{pmatrix}$. The characteristic polynomial of the matrix governing the observer's estimation error, $\\mathbf{e}(t) = \\mathbf{x}(t) - \\hat{\\mathbf{x}}(t)$, is desired to be:\n$$\np_{des}(s) = s^2 + \\alpha_1 s + \\alpha_0\n$$\nwhere $\\alpha_1 > 0$ and $\\alpha_0 > 0$ are the coefficients that determine the desired stable dynamics of the observer.\n\nDetermine the expressions for the observer gains $l_1$ and $l_2$ in terms of the system parameters ($a_0, a_1$) and the desired characteristic polynomial coefficients ($\\alpha_0, \\alpha_1$). Your final answer should present the expressions for $l_1$ and $l_2$ in that order.", "solution": "Define the estimation error as $\\mathbf{e}(t)=\\mathbf{x}(t)-\\hat{\\mathbf{x}}(t)$. Using the plant and observer dynamics,\n$$\n\\dot{\\mathbf{e}}(t)=\\dot{\\mathbf{x}}(t)-\\dot{\\hat{\\mathbf{x}}}(t)=\\left(A\\mathbf{x}(t)+B\\mathbf{u}(t)\\right)-\\left(A\\hat{\\mathbf{x}}(t)+B\\mathbf{u}(t)+L\\left(y(t)-C\\hat{\\mathbf{x}}(t)\\right)\\right).\n$$\nSince $y(t)=C\\mathbf{x}(t)$, this simplifies to\n$$\n\\dot{\\mathbf{e}}(t)=A\\left(\\mathbf{x}(t)-\\hat{\\mathbf{x}}(t)\\right)-L\\left(C\\mathbf{x}(t)-C\\hat{\\mathbf{x}}(t)\\right)=(A-LC)\\mathbf{e}(t).\n$$\nWith $A=\\begin{pmatrix}0&1\\\\-a_{0}&-a_{1}\\end{pmatrix}$, $C=\\begin{pmatrix}1&0\\end{pmatrix}$, and $L=\\begin{pmatrix}l_{1}\\\\ l_{2}\\end{pmatrix}$, we have\n$$\nLC=\\begin{pmatrix}l_{1}\\\\ l_{2}\\end{pmatrix}\\begin{pmatrix}1&0\\end{pmatrix}=\\begin{pmatrix}l_{1}&0\\\\ l_{2}&0\\end{pmatrix},\n\\quad\nA-LC=\\begin{pmatrix}-l_{1}&1\\\\-a_{0}-l_{2}&-a_{1}\\end{pmatrix}.\n$$\nThe characteristic polynomial of a $2\\times 2$ matrix $M$ is $s^{2}-(\\operatorname{tr}M)s+\\det M$. Therefore, for $A-LC$,\n$$\np(s)=s^{2}-\\left(\\operatorname{tr}(A-LC)\\right)s+\\det(A-LC).\n$$\nCompute the trace and determinant:\n$$\n\\operatorname{tr}(A-LC)=-l_{1}-a_{1},\\qquad\n\\det(A-LC)=(-l_{1})(-a_{1})-1\\cdot(-a_{0}-l_{2})=l_{1}a_{1}+a_{0}+l_{2}.\n$$\nWe require $p(s)=p_{des}(s)=s^{2}+\\alpha_{1}s+\\alpha_{0}$, hence coefficient matching gives\n$$\n-\\operatorname{tr}(A-LC)=\\alpha_{1}\\;\\Rightarrow\\;-(-l_{1}-a_{1})=\\alpha_{1}\\;\\Rightarrow\\;l_{1}=\\alpha_{1}-a_{1},\n$$\n$$\n\\det(A-LC)=\\alpha_{0}\\;\\Rightarrow\\;l_{1}a_{1}+a_{0}+l_{2}=\\alpha_{0}\\;\\Rightarrow\\;l_{2}=\\alpha_{0}-a_{0}-l_{1}a_{1}.\n$$\nSubstituting $l_{1}=\\alpha_{1}-a_{1}$ into the expression for $l_{2}$ yields\n$$\nl_{2}=\\alpha_{0}-a_{0}-a_{1}(\\alpha_{1}-a_{1})=\\alpha_{0}-a_{0}-a_{1}\\alpha_{1}+a_{1}^{2}.\n$$\nThus, the observer gains that place the estimation error dynamics at $p_{des}(s)=s^{2}+\\alpha_{1}s+\\alpha_{0}$ are $l_{1}=\\alpha_{1}-a_{1}$ and $l_{2}=\\alpha_{0}-a_{0}-a_{1}\\alpha_{1}+a_{1}^{2}$.", "answer": "$$\\boxed{\\begin{pmatrix} \\alpha_{1}-a_{1} \\\\ \\alpha_{0}-a_{0}-a_{1}\\alpha_{1}+a_{1}^{2} \\end{pmatrix}}$$", "id": "1584819"}, {"introduction": "To truly grasp observability, it is instructive to explore its absence. This exercise [@problem_id:1584790] offers a concrete look into the consequences of an unobservable system by tasking you with finding a specific initial state that is entirely \"invisible\" to the output measurements. Understanding this unobservable subspace—the set of states that produce zero output—reinforces why the observability condition is a critical prerequisite for successful state estimation.", "problem": "Consider a linear time-invariant (LTI) system whose evolution is described by the state-space equations $\\dot{x}(t) = Ax(t)$ and $y(t) = Cx(t)$, where the system operates without any external input. The state vector is $x(t) \\in \\mathbb{R}^3$ and the output is a scalar $y(t) \\in \\mathbb{R}$. The corresponding system matrices are given as:\n$$\nA = \\begin{bmatrix} 1 & -3 & 1 \\\\ 2 & 0 & -3 \\\\ -1 & 2 & -2 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & -1 & 0 \\end{bmatrix}\n$$\nIt is possible to choose a non-zero initial state, $x(0)$, such that the system's output remains zero for all time, i.e., $y(t) \\equiv 0$ for all $t \\ge 0$. Find the unique non-zero initial state vector $x(0)$ that satisfies this condition, subject to the additional constraint that its first component is $x_1(0) = 5$. Present your answer as a $3 \\times 1$ column vector.", "solution": "For the zero-input LTI system $\\dot{x}(t)=Ax(t)$ and $y(t)=Cx(t)$, the state and output are $x(t)=\\exp(At)x(0)$ and $y(t)=C\\exp(At)x(0)$. For $y(t)\\equiv 0$ for all $t\\ge 0$, all time derivatives at $t=0$ must vanish:\n$$\ny^{(k)}(0)=CA^{k}x(0)=0 \\quad \\text{for all } k\\ge 0.\n$$\nBy the Cayley-Hamilton theorem, in $\\mathbb{R}^{3}$ it suffices to enforce this for $k=0,1,2$. Therefore $x(0)$ must lie in the nullspace of the observability matrix\n$$\n\\mathcal{O}=\\begin{bmatrix} C \\\\ CA \\\\ CA^{2} \\end{bmatrix}.\n$$\nWith $C=\\begin{bmatrix}1 & -1 & 0\\end{bmatrix}$ and $A=\\begin{bmatrix} 1 & -3 & 1 \\\\ 2 & 0 & -3 \\\\ -1 & 2 & -2 \\end{bmatrix}$, compute\n$$\nCA=\\begin{bmatrix}1 & -1 & 0\\end{bmatrix}A\n=\\begin{bmatrix}\n1\\cdot 1+(-1)\\cdot 2+0\\cdot(-1),\\;\n1\\cdot(-3)+(-1)\\cdot 0+0\\cdot 2,\\;\n1\\cdot 1+(-1)\\cdot(-3)+0\\cdot(-2)\n\\end{bmatrix}\n=\\begin{bmatrix}-1 & -3 & 4\\end{bmatrix}.\n$$\nThen\n$$\nCA^{2}=(CA)A=\\begin{bmatrix}-1 & -3 & 4\\end{bmatrix}A\n=\\begin{bmatrix}\n(-1)\\cdot 1+(-3)\\cdot 2+4\\cdot(-1),\\;\n(-1)\\cdot(-3)+(-3)\\cdot 0+4\\cdot 2,\\;\n(-1)\\cdot 1+(-3)\\cdot(-3)+4\\cdot(-2)\n\\end{bmatrix}\n=\\begin{bmatrix}-11 & 11 & 0\\end{bmatrix}.\n$$\nThus\n$$\n\\mathcal{O}=\\begin{bmatrix}\n1 & -1 & 0\\\\\n-1 & -3 & 4\\\\\n-11 & 11 & 0\n\\end{bmatrix}.\n$$\nLet $x(0)=\\begin{bmatrix}x_{1} \\\\ x_{2} \\\\ x_{3}\\end{bmatrix}$. Solving $\\mathcal{O}x(0)=0$ gives from the first row $x_{1}-x_{2}=0$, hence $x_{1}=x_{2}$. The second row yields $-x_{1}-3x_{2}+4x_{3}=0$, which with $x_{1}=x_{2}$ gives $-4x_{1}+4x_{3}=0$, hence $x_{3}=x_{1}$. The third row is consistent with $x_{1}=x_{2}$. Therefore the nullspace is spanned by $\\begin{bmatrix}1 \\\\ 1 \\\\ 1\\end{bmatrix}$, and the unique non-zero initial state with $x_{1}(0)=5$ is\n$$\nx(0)=5\\begin{bmatrix}1 \\\\ 1 \\\\ 1\\end{bmatrix}=\\begin{bmatrix}5 \\\\ 5 \\\\ 5\\end{bmatrix}.\n$$\nThis $x(0)$ satisfies $CA^{k}x(0)=0$ for $k=0,1,2$, and by Cayley-Hamilton it follows that $CA^{k}x(0)=0$ for all $k\\ge 0$, hence $y(t)\\equiv 0$ for all $t\\ge 0$.", "answer": "$$\\boxed{\\begin{pmatrix}5 \\\\ 5 \\\\ 5\\end{pmatrix}}$$", "id": "1584790"}]}