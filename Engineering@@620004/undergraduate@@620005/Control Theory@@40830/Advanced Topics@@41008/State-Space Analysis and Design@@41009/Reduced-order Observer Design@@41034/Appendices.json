{"hands_on_practices": [{"introduction": "Before we can design an effective observer, we must first confirm that it's possible to create one whose estimation error will not grow without bound. This foundational exercise introduces the crucial concept of detectability, which is the necessary and sufficient condition for achieving a stable reduced-order observer. By analyzing the partitioned subsystem matrices, you will determine if a given system is a valid candidate for observer design, reinforcing the theoretical underpinnings of this powerful technique [@problem_id:1604272].", "problem": "Consider a third-order linear time-invariant (LTI) system described by the state-space representation $\\dot{x}(t) = Ax(t)$ and $y(t) = Cx(t)$, where $x(t) \\in \\mathbb{R}^3$ is the state vector and $y(t) \\in \\mathbb{R}$ is the measured output. The system matrices are given by:\n$$A = \\begin{pmatrix} 0 & 1 & -1 \\\\ 1 & -2 & 1 \\\\ 0 & 1 & -2 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 & 0 \\end{pmatrix}$$\nTo estimate the unmeasured states of this system, one can design a reduced-order observer. A fundamental prerequisite for the existence of a stable reduced-order observer is that a specific subsystem partition satisfies the property of detectability.\n\nBased on an analysis of the system, which of the following statements is correct regarding the suitability for designing a stable reduced-order observer?\n\nA. A stable reduced-order observer can be designed because the relevant subsystem is observable.\n\nB. A stable reduced-order observer can be designed because the relevant subsystem is detectable, although it is not observable.\n\nC. A stable reduced-order observer cannot be designed because the relevant subsystem is not detectable.\n\nD. A stable reduced-order observer cannot be designed because the relevant subsystem is not controllable.\n\nE. It is not possible to determine the suitability without knowing the input matrix $B$ of the full state-space model $\\dot{x} = Ax+Bu$.", "solution": "We are given the system $\\dot{x}(t)=Ax(t)$, $y(t)=Cx(t)$ with \n$$\nA=\\begin{pmatrix}\n0 & 1 & -1\\\\\n1 & -2 & 1\\\\\n0 & 1 & -2\n\\end{pmatrix}, \n\\quad \nC=\\begin{pmatrix}1 & 0 & 0\\end{pmatrix},\n$$\nso the measured output is $y=x_{1}$. For a reduced-order observer where the measured states are placed first, partition the state as $x=\\begin{pmatrix}x_{m}\\\\x_{u}\\end{pmatrix}$ with $x_{m}=x_{1}\\in\\mathbb{R}$ and $x_{u}=\\begin{pmatrix}x_{2}\\\\x_{3}\\end{pmatrix}\\in\\mathbb{R}^{2}$. Partition $A$ conformably as\n$$\nA=\\begin{pmatrix}\nA_{11} & A_{12}\\\\\nA_{21} & A_{22}\n\\end{pmatrix},\n$$\nwhere, by inspection of $A$,\n$$\nA_{11}=0,\\quad A_{12}=\\begin{pmatrix}1 & -1\\end{pmatrix},\\quad\nA_{21}=\\begin{pmatrix}1\\\\0\\end{pmatrix},\\quad\nA_{22}=\\begin{pmatrix}-2 & 1\\\\ 1 & -2\\end{pmatrix}.\n$$\nThe subsystem dynamics in this partition are\n$$\n\\dot{x}_{m}=A_{11}x_{m}+A_{12}x_{u},\\qquad\n\\dot{x}_{u}=A_{21}x_{m}+A_{22}x_{u}.\n$$\nA standard reduced-order observer for $x_{u}$ exists and can be stabilized if and only if the pair $(A_{22},A_{12})$ is detectable. Moreover, the error dynamics of the reduced-order observer take the form\n$$\n\\dot{e}_{u}=(A_{22}-L A_{12})e_{u},\n$$\nso detectability of $(A_{22},A_{12})$ ensures that there exists $L$ such that $A_{22}-L A_{12}$ is Hurwitz.\n\nWe test detectability by first examining the eigenvalues of $A_{22}$. The characteristic polynomial of $A_{22}$ is\n$$\n\\det(\\lambda I - A_{22})=\\det\\begin{pmatrix}\\lambda+2 & -1\\\\ -1 & \\lambda+2\\end{pmatrix}\n=(\\lambda+2)^{2}-1=\\lambda^{2}+4\\lambda+3=(\\lambda+1)(\\lambda+3),\n$$\nso the eigenvalues are $\\lambda=-1$ and $\\lambda=-3$, both strictly in the open left half-plane. Therefore, for any output matrix, including $A_{12}$, the pair $(A_{22},\\cdot)$ is detectable because there are no unstable modes with nonnegative real part.\n\nTo check observability, form the observability matrix for $(A_{22},A_{12})$:\n$$\n\\mathcal{O}=\\begin{pmatrix}\nA_{12}\\\\\nA_{12}A_{22}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & -1\\\\\n-3 & 3\n\\end{pmatrix}.\n$$\nThe second row is formed by the calculation $A_{12}A_{22}=\\begin{pmatrix}1  -1\\end{pmatrix}\\begin{pmatrix}-2  1\\\\ 1  -2\\end{pmatrix} =\\begin{pmatrix}-3  3\\end{pmatrix}=-3\\begin{pmatrix}1  -1\\end{pmatrix}$.\nSince the rows of the observability matrix are linearly dependent, $\\mathcal{O}$ has rank $12$, and the pair $(A_{22},A_{12})$ is not observable. However, since all eigenvalues of $A_{22}$ are strictly stable, the unobservable mode is stable, and thus the pair is detectable.\n\nTherefore, a stable reduced-order observer can be designed, and the justification is detectability (but not observability) of the relevant subsystem. Options involving controllability or dependence on an input matrix $B$ are not relevant for this detectability-based condition in the autonomous case.\n\nHence, the correct statement is B.", "answer": "$$\\boxed{B}$$", "id": "1604272"}, {"introduction": "Once we've established that a stable observer can be designed, the next step is to control how it behaves. This practice dives into the core design procedure of pole placement for a continuous-time system, allowing us to dictate the speed at which the estimation error converges to zero. You will calculate the scalar gain $L$ for a first-order observer to place the error dynamics' pole at a desired location, a fundamental skill in tuning observer performance for real-world applications like the provided UAV model [@problem_id:1604275].", "problem": "An aerospace engineer is developing a controller for a small Unmanned Aerial Vehicle (UAV). A simplified linear model for the pitch dynamics of the drone around its hovering equilibrium is given by the following state-space representation:\n\n$$\n\\frac{d}{dt} \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ -a_1  -a_2 \\end{pmatrix} \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ b_1 \\end{pmatrix} u(t)\n$$\n\nHere, $x_1(t)$ is the pitch angle in radians, and $x_2(t)$ is the pitch rate in radians per second. The term $u(t)$ represents the control input from the motors. The system parameters are given as $a_1 = 25.0 \\text{ s}^{-2}$ and $a_2 = 12.5 \\text{ s}^{-1}$.\n\nThe onboard sensors can accurately measure the pitch angle $x_1(t)$, so the output equation is $y(t) = x_1(t)$. However, the pitch rate $x_2(t)$ is not directly measured and must be estimated for use in a feedback control law. To achieve this, a first-order reduced-order observer is to be designed. The observer's task is to generate an estimate $\\hat{x}_2(t)$ of the state $x_2(t)$.\n\nFor rapid convergence of the estimate, the engineer wants the single pole of the observer's error dynamics to be located at $s = -50.0 \\text{ s}^{-1}$. Determine the value of the scalar observer gain, $L$, required to achieve this pole placement.\n\nExpress your answer for $L$ in units of $\\text{s}^{-1}$, rounded to three significant figures.", "solution": "We begin with the given system\n$$\n\\dot{x}=\\begin{pmatrix}0  1\\\\ -a_{1}  -a_{2}\\end{pmatrix}x+\\begin{pmatrix}0\\\\ b_{1}\\end{pmatrix}u,\\quad y=x_{1},\n$$\nand partition the state as $x=\\begin{pmatrix}x_{m}\\\\ x_{u}\\end{pmatrix}$ with $x_{m}=x_{1}$ (measured) and $x_{u}=x_{2}$ (unmeasured). Then\n$$\nA_{11}=0,\\quad A_{12}=1,\\quad A_{21}=-a_{1},\\quad A_{22}=-a_{2},\\quad B_{1}=0,\\quad B_{2}=b_{1}.\n$$\nA standard first-order reduced-order observer for $x_{u}$ has the form\n$$\n\\dot{\\hat{x}}_{u}=(A_{22}-L A_{12})\\hat{x}_{u}+(A_{21}-L A_{11})y+(B_{2}-L B_{1})u+L\\,\\dot{y}.\n$$\nDefine the estimation error $\\tilde{x}_{u}=x_{u}-\\hat{x}_{u}$. Using the plant equations\n$$\n\\dot{x}_{u}=A_{21}y+A_{22}x_{u}+B_{2}u,\\quad \\dot{y}=\\dot{x}_{m}=A_{11}y+A_{12}x_{u}+B_{1}u,\n$$\nthe error dynamics become\n$$\n\\dot{\\tilde{x}}_{u}=\\dot{x}_{u}-\\dot{\\hat{x}}_{u}=\\left(A_{22}-L A_{12}\\right)\\tilde{x}_{u}.\n$$\nHence the single observer error pole is located at\n$$\ns=A_{22}-L A_{12}.\n$$\nTo assign this pole at the desired location $s=-\\lambda$ with $\\lambda0$, we require\n$$\nA_{22}-L A_{12}=-\\lambda\\quad\\Longrightarrow\\quad L=\\frac{A_{22}+\\lambda}{A_{12}}.\n$$\nFor the given system, $A_{22}=-a_{2}$ and $A_{12}=1$, so\n$$\nL=-a_{2}+\\lambda.\n$$\nWith the target pole at $s=-50\\,\\text{s}^{-1}$, we set $\\lambda=50$ and use $a_{2}=12.5\\,\\text{s}^{-1}$ to obtain\n$$\nL=-a_{2}+50=-12.5+50=37.5\\,\\text{s}^{-1}.\n$$\nRounded to three significant figures, the required observer gain is $37.5$ in units of $\\text{s}^{-1}$.", "answer": "$$\\boxed{37.5}$$", "id": "1604275"}, {"introduction": "Many modern control systems are implemented digitally, which means we must translate our design principles to the discrete-time domain. This exercise challenges you to design a reduced-order observer for a discrete-time system with the goal of achieving dead-beat performance. You will determine the observer gain that drives the estimation error to zero in a single time step, a uniquely powerful and efficient objective possible in digital control [@problem_id:1604228].", "problem": "A second-order discrete-time linear time-invariant system is used to model a component in a digital control architecture. The system's dynamics are described by the state-space equations:\n$$\nx(k+1) = A x(k) + B u(k)\n$$\n$$\ny(k) = C x(k)\n$$\nwhere $k$ is the time index, $x(k) \\in \\mathbb{R}^2$ is the state vector, $u(k) \\in \\mathbb{R}$ is the control input, and $y(k) \\in \\mathbb{R}$ is the measured output. The system matrices are given by:\n$$\nA = \\begin{pmatrix} 1  0.1 \\\\ -0.5  0.8 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1  0 \\end{pmatrix}\n$$\nThe output $y(k) = x_1(k)$ represents a directly measured state. To estimate the unmeasured state, $x_2(k)$, a first-order reduced-order observer is to be designed. The goal is to achieve dead-beat performance for the observer, meaning the estimation error for the unmeasured state must converge to zero in exactly one time step. Determine the scalar observer gain $L$ that accomplishes this.", "solution": "We partition the given system according to the measured and unmeasured states. With $x(k) = \\begin{pmatrix} x_{1}(k) \\\\ x_{2}(k) \\end{pmatrix}$, the state equations are\n$$\nx_{1}(k+1) = a_{11} x_{1}(k) + a_{12} x_{2}(k) + b_{1} u(k), \\quad\nx_{2}(k+1) = a_{21} x_{1}(k) + a_{22} x_{2}(k) + b_{2} u(k),\n$$\nwhere from $A$ and $B$ we identify\n$$\na_{11} = 1, \\quad a_{12} = 0.1, \\quad a_{21} = -0.5, \\quad a_{22} = 0.8, \\quad b_{1} = 0, \\quad b_{2} = 1.\n$$\nSince $y(k) = x_{1}(k)$ is measured, we design a first-order reduced-order observer to estimate $x_{2}(k)$. A standard discrete-time reduced-order observer that uses the one-step-ahead output innovation is\n$$\n\\hat{x}_{2}(k+1) = a_{21} x_{1}(k) + a_{22} \\hat{x}_{2}(k) + b_{2} u(k) + L\\left( x_{1}(k+1) - \\hat{x}_{1}(k+1) \\right),\n$$\nwith the predicted output\n$$\n\\hat{x}_{1}(k+1) = a_{11} x_{1}(k) + a_{12} \\hat{x}_{2}(k) + b_{1} u(k).\n$$\nDefine the estimation error for the unmeasured state as $e(k) = x_{2}(k) - \\hat{x}_{2}(k)$. Using the system and observer equations,\n$$\n\\begin{aligned}\ne(k+1) = x_{2}(k+1) - \\hat{x}_{2}(k+1) \\\\\n= \\left[a_{21} x_{1}(k) + a_{22} x_{2}(k) + b_{2} u(k)\\right] - \\left[a_{21} x_{1}(k) + a_{22} \\hat{x}_{2}(k) + b_{2} u(k) + L\\left( x_{1}(k+1) - \\hat{x}_{1}(k+1) \\right)\\right] \\\\\n= a_{22}\\left(x_{2}(k) - \\hat{x}_{2}(k)\\right) - L\\left( x_{1}(k+1) - \\hat{x}_{1}(k+1) \\right).\n\\end{aligned}\n$$\nThe one-step-ahead output innovation equals\n$$\nx_{1}(k+1) - \\hat{x}_{1}(k+1) = \\left[a_{11} x_{1}(k) + a_{12} x_{2}(k) + b_{1} u(k)\\right] - \\left[a_{11} x_{1}(k) + a_{12} \\hat{x}_{2}(k) + b_{1} u(k)\\right] = a_{12} e(k).\n$$\nTherefore, the scalar error dynamics reduce to\n$$\ne(k+1) = \\left(a_{22} - L a_{12}\\right) e(k).\n$$\nDead-beat performance in exactly one step requires $e(k+1) = 0$ for any $e(k)$, which is achieved by setting the error dynamics coefficient to zero:\n$$\na_{22} - L a_{12} = 0 \\quad \\Longrightarrow \\quad L = \\frac{a_{22}}{a_{12}}.\n$$\nSubstituting the given values $a_{22} = 0.8$ and $a_{12} = 0.1$ yields\n$$\nL = \\frac{0.8}{0.1} = 8.\n$$", "answer": "$$\\boxed{8}$$", "id": "1604228"}]}