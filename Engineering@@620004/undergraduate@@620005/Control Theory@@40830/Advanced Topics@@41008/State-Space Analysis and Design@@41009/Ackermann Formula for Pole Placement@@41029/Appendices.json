{"hands_on_practices": [{"introduction": "To begin, let's ground our understanding with a direct numerical application of pole placement. This exercise provides a concrete scenario where you can compute the state feedback gain matrix $K$ for a given second-order system and specific desired pole locations. By working through this numerical example [@problem_id:1556746], you will gain hands-on familiarity with the calculation steps involved, either by applying Ackermann's formula directly or by using the coefficient matching method, which serves as a valuable verification tool for low-dimensional systems.", "problem": "Consider a linear time-invariant (LTI) system described by the state-space equation $\\dot{\\mathbf{x}} = A\\mathbf{x} + B\\mathbf{u}$, with the state matrix $A$ and the input matrix $B$ given by:\n$$\nA = \\begin{pmatrix} 0  1 \\\\ 2  -1 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\nwhere $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$ is the state vector and $\\mathbf{u}$ is a scalar control input.\n\nA state feedback controller of the form $\\mathbf{u} = -K\\mathbf{x}$ is to be implemented, where $K = \\begin{pmatrix} k_1  k_2 \\end{pmatrix}$ is the state feedback gain matrix. Determine the numerical values for the elements of the gain matrix $K$ such that the poles of the resulting closed-loop system are placed at $p_1 = -3$ and $p_2 = -4$.\n\nExpress your answer as a row matrix for $K$.", "solution": "We are given the LTI system $\\dot{\\mathbf{x}} = A\\mathbf{x} + B\\mathbf{u}$ with $A = \\begin{pmatrix} 0  1 \\\\ 2  -1 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, and a state feedback $\\mathbf{u} = -K\\mathbf{x}$ with $K = \\begin{pmatrix} k_{1}  k_{2} \\end{pmatrix}$. Under state feedback, the closed-loop system is\n$$\n\\dot{\\mathbf{x}} = (A - BK)\\mathbf{x}.\n$$\nFirst compute $BK$:\n$$\nB K = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} k_{1}  k_{2} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ k_{1}  k_{2} \\end{pmatrix}.\n$$\nHence the closed-loop matrix is\n$$\nA_{\\text{cl}} = A - BK = \\begin{pmatrix} 0  1 \\\\ 2 - k_{1}  -1 - k_{2} \\end{pmatrix}.\n$$\nThe characteristic polynomial of $A_{\\text{cl}}$ is given by\n$$\n\\chi_{A_{\\text{cl}}}(s) = \\det(sI - A_{\\text{cl}}) = s^{2} - \\operatorname{tr}(A_{\\text{cl}})\\,s + \\det(A_{\\text{cl}}).\n$$\nCompute the trace and determinant:\n$$\n\\operatorname{tr}(A_{\\text{cl}}) = 0 + (-1 - k_{2}) = -1 - k_{2},\n$$\n$$\n\\det(A_{\\text{cl}}) = (0)(-1 - k_{2}) - (1)(2 - k_{1}) = k_{1} - 2.\n$$\nThe desired closed-loop poles are $p_{1} = -3$ and $p_{2} = -4$, hence the desired characteristic polynomial is\n$$\n(s - p_{1})(s - p_{2}) = (s + 3)(s + 4) = s^{2} + 7s + 12.\n$$\nEquating coefficients with $\\chi_{A_{\\text{cl}}}(s)$ gives\n$$\n-\\operatorname{tr}(A_{\\text{cl}}) = 7 \\quad \\Rightarrow \\quad -(-1 - k_{2}) = 7 \\quad \\Rightarrow \\quad 1 + k_{2} = 7 \\quad \\Rightarrow \\quad k_{2} = 6,\n$$\n$$\n\\det(A_{\\text{cl}}) = 12 \\quad \\Rightarrow \\quad k_{1} - 2 = 12 \\quad \\Rightarrow \\quad k_{1} = 14.\n$$\nTherefore, the required state feedback gain matrix is\n$$\nK = \\begin{pmatrix} 14  6 \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 14  6 \\end{pmatrix}}$$", "id": "1556746"}, {"introduction": "Having established the computational procedure, we now move to a more conceptual and practical design problem. This exercise [@problem_id:1556708] involves stabilizing an inherently unstable system, a common and critical task in control engineering. Instead of using specific numbers, you will derive a symbolic expression for the feedback gain $K$. This approach allows you to see how the necessary control action depends on both the system's physical parameters (like the natural frequency $\\omega_0$) and the desired closed-loop performance (defined by poles $p_1$ and $p_2$).", "problem": "Consider a simplified model for an unstable system, such as the vertical control of a magnetically levitated object. The linearized dynamics around its unstable equilibrium point are described by the state-space equation $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B u(t)$. The state vector is defined as $\\mathbf{x}(t) = \\begin{pmatrix} z(t) \\\\ \\dot{z}(t) \\end{pmatrix}$, where $z(t)$ represents the vertical displacement from equilibrium and $\\dot{z}(t)$ is the corresponding velocity. The control input $u(t)$ is proportional to the current supplied to the electromagnet.\n\nThe system matrices are given by:\n$$\nA = \\begin{pmatrix} 0  1 \\\\ \\omega_0^2  0 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\nwhere $\\omega_0$ is a positive real constant representing the natural frequency of the unstable open-loop system.\n\nA state feedback control law of the form $u(t) = -K\\mathbf{x}(t)$ is to be implemented, where $K = \\begin{pmatrix} k_1  k_2 \\end{pmatrix}$ is the constant state feedback gain matrix. The goal of this controller is to stabilize the system by moving the closed-loop poles to desired locations.\n\nYour task is to place the closed-loop poles at $s = -p_1$ and $s = -p_2$, where $p_1$ and $p_2$ are distinct positive real constants. Using Ackermann's formula, find the state feedback gain matrix $K$ required to achieve this pole placement. Express your answer in terms of $\\omega_0$, $p_1$, and $p_2$.", "solution": "We are given the linear time-invariant system $\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t)$ with $A = \\begin{pmatrix} 0  1 \\\\ \\omega_{0}^{2}  0 \\end{pmatrix}$ and $B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, and we apply state feedback $u(t) = -K \\mathbf{x}(t)$ with $K = \\begin{pmatrix} k_{1}  k_{2} \\end{pmatrix}$. The desired closed-loop poles are at $s = -p_{1}$ and $s = -p_{2}$, with $p_{1} \\neq p_{2}  0$. The desired characteristic polynomial is\n$$\np_{d}(s) = (s + p_{1})(s + p_{2}) = s^{2} + a_{1} s + a_{0},\n$$\nwhere $a_{1} = p_{1} + p_{2}$ and $a_{0} = p_{1} p_{2}$.\n\nFirst, verify controllability and form the controllability matrix:\n$$\nAB = A B = \\begin{pmatrix} 0  1 \\\\ \\omega_{0}^{2}  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathcal{C} = \\begin{pmatrix} B  AB \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}.\n$$\nSince $\\det(\\mathcal{C}) = -1 \\neq 0$, the pair $(A,B)$ is controllable and Ackermann's formula applies.\n\nAckermann's formula for SISO systems with state feedback $u = -K x$ gives\n$$\nK = e_{2}^{T} \\mathcal{C}^{-1} p_{d}(A),\n$$\nwhere $e_{2}^{T} = \\begin{pmatrix} 0  1 \\end{pmatrix}$ and $p_{d}(A)$ is the desired characteristic polynomial evaluated at $A$:\n$$\np_{d}(A) = A^{2} + a_{1} A + a_{0} I.\n$$\nCompute $A^{2}$:\n$$\nA^{2} = \\begin{pmatrix} 0  1 \\\\ \\omega_{0}^{2}  0 \\end{pmatrix}^{2} = \\begin{pmatrix} \\omega_{0}^{2}  0 \\\\ 0  \\omega_{0}^{2} \\end{pmatrix} = \\omega_{0}^{2} I.\n$$\nTherefore,\n$$\np_{d}(A) = \\omega_{0}^{2} I + a_{1} A + a_{0} I = (\\omega_{0}^{2} + a_{0}) I + a_{1} A.\n$$\nAlso,\n$$\n\\mathcal{C}^{-1} = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}, \\quad e_{2}^{T} \\mathcal{C}^{-1} = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\end{pmatrix}.\n$$\nThus,\n$$\nK = \\begin{pmatrix} 1  0 \\end{pmatrix} \\left[(\\omega_{0}^{2} + a_{0}) I + a_{1} A \\right].\n$$\nEvaluate the matrix inside:\n$$\n(\\omega_{0}^{2} + a_{0}) I + a_{1} A = \\begin{pmatrix} \\omega_{0}^{2} + a_{0}  0 \\\\ 0  \\omega_{0}^{2} + a_{0} \\end{pmatrix} + \\begin{pmatrix} 0  a_{1} \\\\ a_{1} \\omega_{0}^{2}  0 \\end{pmatrix} = \\begin{pmatrix} \\omega_{0}^{2} + a_{0}  a_{1} \\\\ a_{1} \\omega_{0}^{2}  \\omega_{0}^{2} + a_{0} \\end{pmatrix}.\n$$\nTherefore,\n$$\nK = \\begin{pmatrix} \\omega_{0}^{2} + a_{0}  a_{1} \\end{pmatrix} = \\begin{pmatrix} \\omega_{0}^{2} + p_{1} p_{2}  p_{1} + p_{2} \\end{pmatrix}.\n$$\n\nAs a consistency check, the closed-loop matrix is $A - B K = \\begin{pmatrix} 0  1 \\\\ \\omega_{0}^{2} - k_{1}  -k_{2} \\end{pmatrix}$, whose characteristic polynomial is\n$$\n\\det(sI - (A - BK)) = s^{2} + k_{2} s + (k_{1} - \\omega_{0}^{2}),\n$$\nwhich equals $s^{2} + (p_{1} + p_{2}) s + p_{1} p_{2}$ when $k_{2} = p_{1} + p_{2}$ and $k_{1} = p_{1} p_{2} + \\omega_{0}^{2}$, confirming the result.", "answer": "$$\\boxed{\\begin{pmatrix}\\omega_{0}^{2}+p_{1}p_{2}  p_{1}+p_{2}\\end{pmatrix}}$$", "id": "1556708"}, {"introduction": "The final practice is a thought experiment designed to solidify your conceptual grasp of state feedback control and Ackermann's formula. This problem [@problem_id:1556685] asks a simple but profound question: what control action is required if the desired poles are identical to the system's original open-loop poles? Answering this connects directly to the Cayley-Hamilton theorem, a cornerstone of linear systems theory, and provides an essential sanity check for the entire pole placement methodology. It reinforces the intuitive idea that control should only be applied when a change in system behavior is actually desired.", "problem": "Consider a general $n$-th order, controllable, Linear Time-Invariant (LTI), Single-Input Single-Output (SISO) system described by the state-space representation $\\dot{x}(t) = Ax(t) + Bu(t)$, where $x \\in \\mathbb{R}^{n}$ is the state vector, $u \\in \\mathbb{R}$ is the control input, $A$ is the $n \\times n$ state matrix, and $B$ is the $n \\times 1$ input matrix. The system's open-loop poles are the eigenvalues of the matrix $A$, which are the roots of the open-loop characteristic polynomial, $\\alpha(s) = \\det(sI-A)$.\n\nA state feedback control law of the form $u(t) = -Kx(t)$ is applied, where $K$ is a $1 \\times n$ row vector of feedback gains. The goal of this control law is to place the poles of the closed-loop system, given by the eigenvalues of the matrix $(A - BK)$, at desired locations. The desired pole locations are specified by the roots of a desired characteristic polynomial, $\\alpha_d(s)$.\n\nAckermann's formula provides a method for calculating the gain matrix $K$ that achieves the desired pole placement. The formula is given by:\n$$K = \\begin{pmatrix}0  0  \\dots  1\\end{pmatrix} \\mathcal{C}^{-1} \\alpha_d(A)$$\nwhere $\\mathcal{C}$ is the $n \\times n$ controllability matrix of the pair $(A, B)$, and $\\alpha_d(A)$ is the matrix polynomial found by substituting the matrix $A$ for the scalar variable $s$ in the desired characteristic polynomial $\\alpha_d(s)$.\n\nSuppose that a control designer, for analytical purposes, decides to choose the desired closed-loop poles to be exactly the same as the system's original open-loop poles. What is the state feedback gain matrix $K$ that Ackermann's formula would compute for this specific scenario? Express your answer as a general matrix expression valid for any such $n$-th order system.", "solution": "We are given an $n$-th order controllable LTI SISO system $\\dot{x}(t) = Ax(t) + Bu(t)$ and the state feedback law $u(t) = -Kx(t)$, with Ackermann’s formula\n$$\nK = \\begin{pmatrix}0  0  \\dots  1\\end{pmatrix} \\mathcal{C}^{-1} \\alpha_{d}(A),\n$$\nwhere $\\mathcal{C}$ is the controllability matrix of $(A,B)$ and $\\alpha_{d}(s)$ is the desired characteristic polynomial.\n\nLet the desired closed-loop polynomial be chosen equal to the open-loop characteristic polynomial:\n$$\n\\alpha_{d}(s) = \\alpha(s) = \\det(sI - A).\n$$\nBy the Cayley–Hamilton theorem, the matrix $A$ satisfies its own characteristic polynomial:\n$$\n\\alpha(A) = 0_{n \\times n}.\n$$\nTherefore, substituting $\\alpha_{d}(A) = \\alpha(A)$ into Ackermann’s formula yields\n$$\nK = \\begin{pmatrix}0  0  \\dots  1\\end{pmatrix} \\mathcal{C}^{-1} \\alpha(A) = \\begin{pmatrix}0  0  \\dots  1\\end{pmatrix} \\mathcal{C}^{-1} 0_{n \\times n} = 0_{1 \\times n}.\n$$\nHence, the gain returned by Ackermann’s formula in this scenario is the zero row vector, which leaves the closed-loop matrix $A - BK$ equal to $A$, placing the poles at the original open-loop locations as specified.", "answer": "$$\\boxed{0_{1 \\times n}}$$", "id": "1556685"}]}