{"hands_on_practices": [{"introduction": "The power of the Smith predictor lies in its ingenious structure, which uses a process model to effectively remove the time delay from the primary feedback loop. This architectural choice allows for more aggressive controller tuning than would otherwise be possible for systems with significant dead time. This first practice invites you to derive the fundamental closed-loop transfer function for an ideal Smith predictor, revealing the mathematical elegance behind its operation under perfect model conditions [@problem_id:1611252].", "problem": "In a chemical processing plant, a control system is designed to regulate the concentration of a product. The process has a transfer function given by $P(s) = P_0(s)\\exp(-s\\tau)$, where $P_0(s)$ represents the dynamics of the chemical reactor and $\\exp(-s\\tau)$ represents a pure time delay $\\tau$ due to the transport of the product to a downstream sensor.\n\nTo overcome the challenges posed by this time delay, a Smith predictor control scheme is implemented. The scheme uses a controller with transfer function $C(s)$. The output of the controller, $U(s)$, is fed to the actual process to produce the output $Y(s)$.\n\nThe feedback signal, $B(s)$, which is compared with the setpoint $R(s)$, is synthesized as follows:\n$B(s) = Y_m(s) + (Y(s) - Y_{pred}(s))$\nwhere:\n- $Y(s)$ is the actual measured output of the process.\n- $Y_m(s)$ is the output of a mathematical model of the process *without* the time delay.\n- $Y_{pred}(s)$ is the output of a mathematical model of the *entire* process, *including* the time delay.\n\nAssume that the mathematical models used within the Smith predictor are a perfect match for the actual process. That is, the model for the delay-free part is $\\hat{P}_0(s) = P_0(s)$ and the model for the full process is $\\hat{P}(s) = P(s)$.\n\nYour task is to derive the overall closed-loop transfer function of the system, defined as $G_{cl}(s) = \\frac{Y(s)}{R(s)}$. Express your answer in terms of $C(s)$, $P_0(s)$, and $\\tau$.", "solution": "The actual process is given by $P(s)=P_{0}(s)\\exp(-s\\tau)$. With input $U(s)$, the true output is\n$$\nY(s)=P(s)U(s)=P_{0}(s)\\exp(-s\\tau)\\,U(s).\n$$\nThe Smith predictor constructs\n$$\nB(s)=Y_{m}(s)+\\big(Y(s)-Y_{\\text{pred}}(s)\\big),\n$$\nwhere, under perfect model matching, the internal models are $\\hat{P}_{0}(s)=P_{0}(s)$ and $\\hat{P}(s)=P(s)$. Hence\n$$\nY_{m}(s)=\\hat{P}_{0}(s)U(s)=P_{0}(s)U(s), \\quad Y_{\\text{pred}}(s)=\\hat{P}(s)U(s)=P(s)U(s)=Y(s).\n$$\nTherefore,\n$$\nB(s)=Y_{m}(s)+\\big(Y(s)-Y_{\\text{pred}}(s)\\big)=P_{0}(s)U(s).\n$$\nThe controller input is the error $E(s)=R(s)-B(s)$, and the controller output is\n$$\nU(s)=C(s)E(s)=C(s)\\big(R(s)-B(s)\\big)=C(s)\\big(R(s)-P_{0}(s)U(s)\\big).\n$$\nRearranging,\n$$\nU(s)+C(s)P_{0}(s)U(s)=C(s)R(s)\\quad\\Rightarrow\\quad U(s)=\\frac{C(s)}{1+C(s)P_{0}(s)}\\,R(s).\n$$\nThe actual output is then\n$$\nY(s)=P_{0}(s)\\exp(-s\\tau)\\,U(s)=P_{0}(s)\\exp(-s\\tau)\\,\\frac{C(s)}{1+C(s)P_{0}(s)}\\,R(s).\n$$\nThus the overall closed-loop transfer function is\n$$\nG_{cl}(s)=\\frac{Y(s)}{R(s)}=\\frac{C(s)P_{0}(s)\\exp(-s\\tau)}{1+C(s)P_{0}(s)}.\n$$", "answer": "$$\\boxed{\\frac{C(s)P_{0}(s)\\exp(-s\\tau)}{1+C(s)P_{0}(s)}}$$", "id": "1611252"}, {"introduction": "With the ideal structure of the Smith predictor understood, the next logical step is to design the controller, $G_c(s)$, that resides within it. The predictor's architecture conveniently isolates the delay-free dynamics of the process, allowing us to apply standard design techniques as if the delay were not present. In this practice, you will determine the controller transfer function required to achieve a specific, desired closed-loop response for the delay-free model, a common and powerful approach rooted in the principles of internal model control (IMC) [@problem_id:1611279].", "problem": "Consider a process with a transfer function $G(s) = G_m(s) e^{-\\theta s}$, where $G_m(s) = \\frac{K}{\\tau s + 1}$ represents the delay-free dynamics and $e^{-\\theta s}$ represents a pure time delay. Here, $K$, $\\tau$, and $\\theta$ are positive real constants representing the process gain, process time constant, and delay time, respectively.\n\nA feedback control system is designed for this process. The design strategy involves creating a controller, $G_c(s)$, based on the delay-free part of the process, $G_m(s)$. In this control architecture, the effective closed-loop transfer function from the setpoint, $R(s)$, to the output of the delay-free model, $Y_m(s)$, is given by:\n$$\n\\frac{Y_m(s)}{R(s)} = \\frac{G_c(s) G_m(s)}{1 + G_c(s) G_m(s)}\n$$\nThe design specification requires this effective closed-loop response to behave as a simple first-order system with a desired time constant $\\tau_{cl}$:\n$$\n\\frac{Y_m(s)}{R(s)} = \\frac{1}{\\tau_{cl} s + 1}\n$$\nwhere $\\tau_{cl}$ is a positive real constant.\n\nDetermine the transfer function of the controller, $G_c(s)$, that is required to meet this design specification. Express your answer as a function of $K$, $\\tau$, and $\\tau_{cl}$.", "solution": "The effective closed-loop transfer function for the delay-free model is given by\n$$\n\\frac{Y_{m}(s)}{R(s)}=\\frac{G_{c}(s)G_{m}(s)}{1+G_{c}(s)G_{m}(s)}.\n$$\nDefine the loop transfer function as $L(s)=G_{c}(s)G_{m}(s)$. Then the closed-loop form becomes\n$$\n\\frac{Y_{m}(s)}{R(s)}=\\frac{L(s)}{1+L(s)}.\n$$\nTo meet the specification\n$$\n\\frac{Y_{m}(s)}{R(s)}=\\frac{1}{\\tau_{cl}s+1},\n$$\nwe require\n$$\n\\frac{L(s)}{1+L(s)}=\\frac{1}{\\tau_{cl}s+1}.\n$$\nSolve this for $L(s)$:\n$$\nL(s)=\\frac{\\frac{1}{\\tau_{cl}s+1}}{1-\\frac{1}{\\tau_{cl}s+1}}=\\frac{\\frac{1}{\\tau_{cl}s+1}}{\\frac{\\tau_{cl}s}{\\tau_{cl}s+1}}=\\frac{1}{\\tau_{cl}s}.\n$$\nThus\n$$\nG_{c}(s)G_{m}(s)=\\frac{1}{\\tau_{cl}s}.\n$$\nWith $G_{m}(s)=\\frac{K}{\\tau s+1}$, solve for $G_{c}(s)$:\n$$\nG_{c}(s)=\\frac{\\frac{1}{\\tau_{cl}s}}{\\frac{K}{\\tau s+1}}=\\frac{\\tau s+1}{K\\,\\tau_{cl}\\,s}.\n$$\nEquivalently, this is a proportional-integral form\n$$\nG_{c}(s)=\\frac{\\tau}{K\\tau_{cl}}+\\frac{1}{K\\tau_{cl}s}.\n$$\nEither expression satisfies the design requirement and depends only on $K$, $\\tau$, and $\\tau_{cl}$. The delay parameter does not enter because the specification is imposed on the delay-free model response.", "answer": "$$\\boxed{\\frac{\\tau s+1}{K\\,\\tau_{cl}\\,s}}$$", "id": "1611279"}, {"introduction": "While the standard Smith predictor is effective for stable processes, it contains an internal instability and fails when the process itself is open-loop unstable, a scenario encountered in exothermic chemical reactors and other challenging applications. This limitation can be overcome by strategically modifying the predictor's structure to ensure its own stability. This final, more advanced practice challenges you to analyze such a modified Smith predictor, demonstrating how foundational control strategies are adapted to solve complex, real-world stabilization problems [@problem_id:1611256].", "problem": "A control engineer is tasked with designing a controller for an open-loop unstable process with a significant time delay. The process is modeled by the transfer function:\n$$G_p(s) = \\frac{K}{\\tau s - 1} e^{-\\theta s}$$\nwhere $K$, $\\tau$, and $\\theta$ are positive real constants representing the process gain, unstable time constant, and time delay, respectively.\n\nA standard Smith predictor is known to suffer from internal instability when applied to such a process. To circumvent this issue, a modified Smith predictor structure is proposed. The controller's transfer function, $C(s)$, is given by:\n$$C(s) = \\frac{G_c(s)}{1 + G_c(s)G_{pm}(s)(1 - e^{-\\theta s})}$$\nIn this structure, $G_c(s)$ is a primary controller designed for the delay-free part of the process. For this problem, we use a simple proportional controller, $G_c(s) = K_c$, where $K_c$ is a positive constant gain.\n\nCrucially, the internal model used for prediction, $G_{pm}(s)$, is chosen to be a stable approximation of the actual delay-free process part $G_{p0}(s) = \\frac{K}{\\tau s - 1}$. The chosen stable model is:\n$$G_{pm}(s) = \\frac{K}{\\tau s + 1}$$\nThis modification ensures the controller $C(s)$ itself is stable for any time delay $\\theta > 0$, assuming an appropriate choice of $K_c$.\n\nThe closed-loop system is formed by a standard negative feedback loop where the plant $G_p(s)$ is controlled by $C(s)$. The stability of this closed-loop system is determined by the roots of its characteristic equation. This characteristic equation can be arranged into the form $A(s) + B(s)e^{-\\theta s} = 0$.\n\nYour task is to determine the transfer function $P(s) = -\\frac{B(s)}{A(s)}$, which is a key component in analyzing the stability of the system using methods like the Nyquist criterion. Express your answer as a single rational function in terms of $s$, $K$, $\\tau$, and $K_c$.", "solution": "We start from the given plant, controller structure, and internal model:\n- Plant: $G_{p}(s) = \\dfrac{K}{\\tau s - 1}\\exp(-\\theta s)$.\n- Primary controller: $G_{c}(s) = K_{c}$.\n- Internal model: $G_{pm}(s) = \\dfrac{K}{\\tau s + 1}$.\n- Implemented controller: $C(s) = \\dfrac{G_{c}(s)}{1 + G_{c}(s)G_{pm}(s)\\left(1 - \\exp(-\\theta s)\\right)} = \\dfrac{K_{c}}{1 + K_{c}\\dfrac{K}{\\tau s + 1}\\left(1 - \\exp(-\\theta s)\\right)}$.\n\nDefine $D(s) \\equiv 1 + K_{c}G_{pm}(s)\\left(1 - \\exp(-\\theta s)\\right) = 1 + \\dfrac{K_{c}K}{\\tau s + 1} - \\dfrac{K_{c}K}{\\tau s + 1}\\exp(-\\theta s)$. The loop transfer function is\n$$\nL(s) = C(s)G_{p}(s) = \\frac{K_{c}}{D(s)}\\cdot \\frac{K}{\\tau s - 1}\\exp(-\\theta s) = \\frac{K_{c}K\\exp(-\\theta s)}{(\\tau s - 1)D(s)}.\n$$\nFor standard negative feedback, the characteristic equation is\n$$\n1 + L(s) = 0 \\;\\;\\Rightarrow\\;\\; (\\tau s - 1)D(s) + K_{c}K\\exp(-\\theta s) = 0.\n$$\nSubstitute $D(s) = 1 + \\dfrac{K_{c}K}{\\tau s + 1} - \\dfrac{K_{c}K}{\\tau s + 1}\\exp(-\\theta s)$ to group delayed and non-delayed terms:\n$$\n(\\tau s - 1)\\left(1 + \\frac{K_{c}K}{\\tau s + 1}\\right) - (\\tau s - 1)\\frac{K_{c}K}{\\tau s + 1}\\exp(-\\theta s) + K_{c}K\\exp(-\\theta s) = 0.\n$$\nArrange as $A(s) + B(s)\\exp(-\\theta s) = 0$ with\n$$\nA(s) = (\\tau s - 1)\\left(1 + \\frac{K_{c}K}{\\tau s + 1}\\right), \\quad\nB(s) = K_{c}K - (\\tau s - 1)\\frac{K_{c}K}{\\tau s + 1}.\n$$\nSimplify $B(s)$:\n$$\nB(s) = K_{c}K\\left[1 - \\frac{\\tau s - 1}{\\tau s + 1}\\right] = K_{c}K\\left(\\frac{2}{\\tau s + 1}\\right) = \\frac{2K_{c}K}{\\tau s + 1}.\n$$\nSimplify $A(s)$:\n$$\nA(s) = (\\tau s - 1)\\left(\\frac{\\tau s + 1 + K_{c}K}{\\tau s + 1}\\right) = \\frac{(\\tau s - 1)(\\tau s + 1 + K_{c}K)}{\\tau s + 1}.\n$$\nTherefore,\n$$\nP(s) = -\\frac{B(s)}{A(s)} = -\\frac{\\dfrac{2K_{c}K}{\\tau s + 1}}{\\dfrac{(\\tau s - 1)(\\tau s + 1 + K_{c}K)}{\\tau s + 1}} = -\\frac{2K_{c}K}{(\\tau s - 1)(\\tau s + 1 + K_{c}K)}.\n$$\nThis is a single rational function in terms of $s$, $K$, $\\tau$, and $K_{c}$.", "answer": "$$\\boxed{-\\frac{2K K_{c}}{(\\tau s - 1)(\\tau s + 1 + K K_{c})}}$$", "id": "1611256"}]}