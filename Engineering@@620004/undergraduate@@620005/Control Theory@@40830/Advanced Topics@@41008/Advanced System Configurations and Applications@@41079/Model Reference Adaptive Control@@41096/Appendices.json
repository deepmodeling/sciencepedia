{"hands_on_practices": [{"introduction": "Before designing an adaptive controller, we must first understand the problem it needs to solve. This practice guides you through the essential first step of deriving the error dynamics equation [@problem_id:1591821]. By expressing the evolution of the tracking error, $e(t)$, you will see precisely how mismatches between the plant and the model, and the choice of control gains, influence the system's performance, laying the mathematical groundwork for the adaptive solution.", "problem": "Consider a simple first-order dynamical system, often referred to as the 'plant', whose behavior is described by the differential equation:\n$$ \\dot{y}_p(t) = -a_p y_p(t) + b_p u(t) $$\nHere, $y_p(t)$ is the output of the plant, $u(t)$ is the control input, and $a_p$ and $b_p$ are constant positive parameters representing the plant's characteristics.\n\nThe goal is to make the plant's output $y_p(t)$ follow the output of a stable 'reference model', $y_m(t)$, which is defined by:\n$$ \\dot{y}_m(t) = -a_m y_m(t) + b_m r(t) $$\nIn this equation, $y_m(t)$ is the desired model output, $r(t)$ is a bounded reference signal, and $a_m$ and $b_m$ are known positive constants.\n\nTo achieve this, a linear feedback controller is implemented, where the control input $u(t)$ is given by:\n$$ u(t) = \\theta_1 y_p(t) + \\theta_2 r(t) $$\nThe parameters $\\theta_1$ and $\\theta_2$ are the constant controller gains.\n\nThe tracking error, $e(t)$, is defined as the difference between the plant output and the reference model output:\n$$ e(t) = y_p(t) - y_m(t) $$\n\nThe dynamics of this tracking error can be expressed as a first-order ordinary differential equation in the form $\\dot{e}(t) = F$. Your task is to find the expression for $F$. Express your answer in terms of the tracking error $e(t)$, the reference model output $y_m(t)$, the reference signal $r(t)$, and the constant parameters ($a_p, b_p, a_m, b_m, \\theta_1, \\theta_2$). For simplicity, you may omit the explicit time dependence $(t)$ in your final expression.", "solution": "We start from the definitions of the plant, model, control law, and tracking error:\n- Plant: $\\dot{y}_{p}=-a_{p}y_{p}+b_{p}u$.\n- Model: $\\dot{y}_{m}=-a_{m}y_{m}+b_{m}r$.\n- Control: $u=\\theta_{1}y_{p}+\\theta_{2}r$.\n- Error: $e=y_{p}-y_{m}$.\n\nDifferentiate the error to obtain its dynamics:\n$$\n\\dot{e}=\\dot{y}_{p}-\\dot{y}_{m}.\n$$\nSubstitute the plant and model dynamics:\n$$\n\\dot{e}=\\left(-a_{p}y_{p}+b_{p}u\\right)-\\left(-a_{m}y_{m}+b_{m}r\\right).\n$$\nSubstitute the control input $u=\\theta_{1}y_{p}+\\theta_{2}r$:\n$$\n\\dot{e}=-a_{p}y_{p}+b_{p}\\left(\\theta_{1}y_{p}+\\theta_{2}r\\right)+a_{m}y_{m}-b_{m}r.\n$$\nGroup terms:\n$$\n\\dot{e}=\\left(-a_{p}+b_{p}\\theta_{1}\\right)y_{p}+a_{m}y_{m}+\\left(b_{p}\\theta_{2}-b_{m}\\right)r.\n$$\nExpress $y_{p}$ in terms of $e$ and $y_{m}$ using $y_{p}=e+y_{m}$:\n$$\n\\dot{e}=\\left(-a_{p}+b_{p}\\theta_{1}\\right)\\left(e+y_{m}\\right)+a_{m}y_{m}+\\left(b_{p}\\theta_{2}-b_{m}\\right)r.\n$$\nDistribute and collect like terms:\n$$\n\\dot{e}=\\left(-a_{p}+b_{p}\\theta_{1}\\right)e+\\left(-a_{p}+b_{p}\\theta_{1}+a_{m}\\right)y_{m}+\\left(b_{p}\\theta_{2}-b_{m}\\right)r.\n$$\nTherefore, the error dynamics $\\dot{e}=F$ has\n$$\nF=\\left(-a_{p}+b_{p}\\theta_{1}\\right)e+\\left(a_{m}-a_{p}+b_{p}\\theta_{1}\\right)y_{m}+\\left(b_{p}\\theta_{2}-b_{m}\\right)r.\n$$", "answer": "$$\\boxed{\\left(-a_{p}+b_{p}\\theta_{1}\\right)e+\\left(a_{m}-a_{p}+b_{p}\\theta_{1}\\right)y_{m}+\\left(b_{p}\\theta_{2}-b_{m}\\right)r}$$", "id": "1591821"}, {"introduction": "With the error dynamics established, the core of adaptive control is to design a mechanism that automatically adjusts the controller parameters to drive the tracking error to zero. This exercise takes you into the world of digital control, where you will derive the adaptation laws for a discrete-time system using a gradient-descent method [@problem_id:1591827]. This process is fundamental to creating intelligent controllers that can learn from performance errors and adapt to uncertainties in real time.", "problem": "A crucial component in a next-generation communication satellite requires precise thermal regulation. Its temperature dynamics can be simplified and modeled by the following first-order discrete-time system:\n$$y_p(k+1) = a_p y_p(k) + b_p u(k)$$\nHere, $k$ is the discrete time index, $y_p(k)$ represents the temperature deviation of the component from its nominal operating point, and $u(k)$ is the control signal sent to the thermoelectric cooler. The system parameters $a_p$ and $b_p$ are unknown but constant, representing the thermal inertia and the cooler effectiveness, respectively. It is known from physical principles that $b_p > 0$.\n\nTo ensure stable and predictable thermal behavior, the component's temperature response is required to follow a specified reference model:\n$$y_m(k+1) = a_m y_m(k) + b_m r(k)$$\nIn this model, $y_m(k)$ is the desired temperature deviation, $r(k)$ is the external command signal, and $a_m$ and $b_m$ are known, fixed parameters defining the ideal response, with $|a_m|  1$ to guarantee stability.\n\nA direct Model Reference Adaptive Control (MRAC) scheme is employed to achieve this. The control law has the form:\n$$u(k) = \\theta_1(k) y_p(k) + \\theta_2(k) r(k)$$\nwhere $\\theta_1(k)$ and $\\theta_2(k)$ are the adaptive gains. These gains are updated at each time step based on a gradient-descent method aimed at minimizing the squared tracking error at the subsequent time step, defined by the cost function $J = \\frac{1}{2}e(k+1)^2$, where the tracking error is $e(k+1) = y_p(k+1) - y_m(k+1)$. The update rule is given by:\n$$\\theta_i(k+1) = \\theta_i(k) - \\gamma_0 \\frac{\\partial J}{\\partial \\theta_i(k)} \\quad \\text{for } i \\in \\{1, 2\\}$$\nwhere $\\gamma_0$ is a base positive adaptation rate. For the final expressions, the unknown physical parameter $b_p$ that appears in the derivation must be absorbed into a new, single positive adaptation gain denoted by $\\gamma$.\n\nDerive the explicit update expressions for the adaptive gains $\\theta_1(k+1)$ and $\\theta_2(k+1)$. Your final answer should be presented as a $1 \\times 2$ row matrix containing the complete expression for $\\theta_1(k+1)$ in the first column and $\\theta_2(k+1)$ in the second.", "solution": "The goal is to find the adaptation laws for the controller parameters $\\theta_1(k)$ and $\\theta_2(k)$. The adaptation is based on a gradient-descent minimization of the cost function $J = \\frac{1}{2}e(k+1)^2$, where $e(k+1) = y_p(k+1) - y_m(k+1)$ is the tracking error.\n\nThe update rule is given as:\n$$\\theta_i(k+1) = \\theta_i(k) - \\gamma_0 \\frac{\\partial J}{\\partial \\theta_i(k)}$$\n\nFirst, we apply the chain rule to compute the partial derivative of the cost function $J$ with respect to each parameter $\\theta_i(k)$:\n$$\\frac{\\partial J}{\\partial \\theta_i(k)} = \\frac{\\partial}{\\partial \\theta_i(k)} \\left( \\frac{1}{2} e(k+1)^2 \\right) = e(k+1) \\frac{\\partial e(k+1)}{\\partial \\theta_i(k)}$$\n\nNext, we need to find the sensitivity derivative, which describes how the error $e(k+1)$ changes with respect to the controller parameters at the previous time step, $\\theta_i(k)$.\nThe error is defined as $e(k+1) = y_p(k+1) - y_m(k+1)$. The reference model output $y_m(k+1)$ is generated by $y_m(k+1) = a_m y_m(k) + b_m r(k)$ and does not depend on the controller parameters $\\theta_1(k)$ and $\\theta_2(k)$. Therefore, the derivative of the error is simply the derivative of the plant output:\n$$\\frac{\\partial e(k+1)}{\\partial \\theta_i(k)} = \\frac{\\partial}{\\partial \\theta_i(k)} \\left( y_p(k+1) - y_m(k+1) \\right) = \\frac{\\partial y_p(k+1)}{\\partial \\theta_i(k)}$$\n\nNow, we compute the derivative of the plant output $y_p(k+1)$ with respect to each parameter. The plant dynamics are given by $y_p(k+1) = a_p y_p(k) + b_p u(k)$. We substitute the control law $u(k) = \\theta_1(k) y_p(k) + \\theta_2(k) r(k)$ into the plant equation:\n$$y_p(k+1) = a_p y_p(k) + b_p \\left( \\theta_1(k) y_p(k) + \\theta_2(k) r(k) \\right)$$\n\nWe can now calculate the partial derivatives with respect to $\\theta_1(k)$ and $\\theta_2(k)$. Note that $y_p(k)$ and $r(k)$ are treated as constants in this differentiation as they are values from the previous time step.\nFor $\\theta_1(k)$:\n$$\\frac{\\partial y_p(k+1)}{\\partial \\theta_1(k)} = \\frac{\\partial}{\\partial \\theta_1(k)} \\left[ a_p y_p(k) + b_p \\theta_1(k) y_p(k) + b_p \\theta_2(k) r(k) \\right] = b_p y_p(k)$$\nFor $\\theta_2(k)$:\n$$\\frac{\\partial y_p(k+1)}{\\partial \\theta_2(k)} = \\frac{\\partial}{\\partial \\theta_2(k)} \\left[ a_p y_p(k) + b_p \\theta_1(k) y_p(k) + b_p \\theta_2(k) r(k) \\right] = b_p r(k)$$\n\nNow we substitute these sensitivity derivatives back into the expressions for $\\frac{\\partial J}{\\partial \\theta_i(k)}$:\n$$\\frac{\\partial J}{\\partial \\theta_1(k)} = e(k+1) \\frac{\\partial y_p(k+1)}{\\partial \\theta_1(k)} = e(k+1) b_p y_p(k)$$\n$$\\frac{\\partial J}{\\partial \\theta_2(k)} = e(k+1) \\frac{\\partial y_p(k+1)}{\\partial \\theta_2(k)} = e(k+1) b_p r(k)$$\n\nFinally, we substitute these gradients into the given update rule $\\theta_i(k+1) = \\theta_i(k) - \\gamma_0 \\frac{\\partial J}{\\partial \\theta_i(k)}$:\nFor $\\theta_1(k+1)$:\n$$\\theta_1(k+1) = \\theta_1(k) - \\gamma_0 \\left( e(k+1) b_p y_p(k) \\right)$$\nFor $\\theta_2(k+1)$:\n$$\\theta_2(k+1) = \\theta_2(k) - \\gamma_0 \\left( e(k+1) b_p r(k) \\right)$$\n\nThe problem states that the unknown constant $b_p$ must be absorbed into a single adaptation gain $\\gamma$. We define a new gain $\\gamma = \\gamma_0 b_p$. Since $\\gamma_0 > 0$ and it is given that $b_p > 0$, the combined adaptation gain $\\gamma$ is also positive.\n\nThe final adaptation laws are:\n$$\\theta_1(k+1) = \\theta_1(k) - \\gamma e(k+1) y_p(k)$$\n$$\\theta_2(k+1) = \\theta_2(k) - \\gamma e(k+1) r(k)$$\n\nThese expressions provide the explicit update rules for the adaptive gains. The error $e(k+1)$ is calculated at each step using the measured plant output $y_p(k+1)$ and the calculated model output $y_m(k+1)$. The gains are then updated using this error and the signal values from the previous step, $y_p(k)$ and $r(k)$.\n\nThe answer is to be presented as a $1 \\times 2$ row matrix. The first element is the expression for $\\theta_1(k+1)$ and the second element is the expression for $\\theta_2(k+1)$.", "answer": "$$\\boxed{\\begin{pmatrix} \\theta_1(k) - \\gamma e(k+1) y_p(k)  \\theta_2(k) - \\gamma e(k+1) r(k) \\end{pmatrix}}$$", "id": "1591827"}, {"introduction": "A powerful theoretical design must also be robust to the complexities of the real world, and this practice addresses a critical challenge: the presence of unmodeled high-frequency dynamics [@problem_id:1591826]. You will investigate how these common physical phenomena can violate the Strictly Positive Real (SPR) condition, a cornerstone of many MRAC stability proofs. This exercise provides a concrete method for calculating the critical frequency at which these unmodeled dynamics first compromise the system's stability assumptions.", "problem": "An aerospace engineer is developing a Model Reference Adaptive Control (MRAC) system for a satellite's attitude control thruster. The initial simplified model for the thruster's dynamic response from input command to torque output is a first-order system with a transfer function $G_{p,nom}(s) = \\frac{K}{s+a}$, where $K$ is a positive gain.\n\nDuring hardware-in-the-loop testing, it is discovered that unmodeled high-frequency dynamics, such as valve actuation delays, are present. These dynamics can be effectively approximated by a single fast pole, leading to a more accurate, true plant transfer function:\n$$G_{p,true}(s) = \\frac{K}{s+a} \\cdot \\frac{p}{s+p}$$\nHere, $p$ is a large positive constant such that $p \\gg a$, representing the high-frequency pole at $s=-p$.\n\nFor the stability proof of the chosen MRAC architecture to hold, it is required that the plant transfer function be Strictly Positive Real (SPR). A transfer function $H(s)$ is considered SPR if its Nyquist plot for all frequencies $\\omega \\ge 0$ remains in the right half of the complex plane. For a minimum-phase system like $G_{p,true}(s)$, this is equivalent to its phase angle, $\\angle H(j\\omega)$, remaining strictly between $-90^\\circ$ and $+90^\\circ$.\n\nThe unmodeled dynamics introduce phase lag that increases with frequency, which can cause the SPR condition to be violated. Determine the critical angular frequency $\\omega_c$ at which the phase angle of the true plant, $\\angle G_{p,true}(j\\omega)$, first reaches the boundary of the SPR region, i.e., $-90^\\circ$. This frequency indicates the threshold beyond which the unmodeled dynamics fundamentally challenge the stability assumptions of the controller.\n\nUse the following parameters for your calculation: $a = 15.0 \\text{ rad/s}$ and $p = 250 \\text{ rad/s}$. The gain $K$ is a positive constant but its value is not needed.\n\nExpress your final answer for the critical angular frequency $\\omega_c$ in units of rad/s, rounded to three significant figures.", "solution": "The true plant transfer function is given by\n$$\nG_{p,\\text{true}}(s)=\\frac{K}{s+a}\\cdot\\frac{p}{s+p}=\\frac{Kp}{(s+a)(s+p)}.\n$$\nEvaluated on the imaginary axis at $s=j\\omega$, its frequency response is\n$$\nG_{p,\\text{true}}(j\\omega)=\\frac{Kp}{(j\\omega+a)(j\\omega+p)}.\n$$\nSince $K0$ and $p0$, the numerator contributes zero phase. Each factor in the denominator has angle $\\arg(j\\omega+\\alpha)=\\arctan\\!\\left(\\frac{\\omega}{\\alpha}\\right)$ for $\\alpha0$, so the overall phase is\n$$\n\\angle G_{p,\\text{true}}(j\\omega)=-\\arctan\\!\\left(\\frac{\\omega}{a}\\right)-\\arctan\\!\\left(\\frac{\\omega}{p}\\right).\n$$\nThe SPR boundary is reached when the phase equals $-\\frac{\\pi}{2}$, hence we set\n$$\n\\arctan\\!\\left(\\frac{\\omega}{a}\\right)+\\arctan\\!\\left(\\frac{\\omega}{p}\\right)=\\frac{\\pi}{2}.\n$$\nLet $x=\\frac{\\omega}{a}$ and $y=\\frac{\\omega}{p}$. Using the tangent addition identity,\n$$\n\\tan\\big(\\arctan x+\\arctan y\\big)=\\frac{x+y}{1-xy}.\n$$\nFor the left-hand side to equal $\\tan\\!\\left(\\frac{\\pi}{2}\\right)$, the denominator must vanish with $x,y0$, yielding\n$$\n1-xy=0\\quad\\Longrightarrow\\quad xy=1.\n$$\nSubstituting back gives\n$$\n\\frac{\\omega}{a}\\cdot\\frac{\\omega}{p}=1\\;\\;\\Longrightarrow\\;\\;\\omega^{2}=ap\\;\\;\\Longrightarrow\\;\\;\\omega_{c}=\\sqrt{ap}.\n$$\nWith $a=15.0$ rad/s and $p=250$ rad/s,\n$$\n\\omega_{c}=\\sqrt{15.0\\times 250}=\\sqrt{3750}\\approx 61.237\\;\\text{rad/s}.\n$$\nRounded to three significant figures, the critical angular frequency is $61.2$ rad/s.", "answer": "$$\\boxed{61.2}$$", "id": "1591826"}]}