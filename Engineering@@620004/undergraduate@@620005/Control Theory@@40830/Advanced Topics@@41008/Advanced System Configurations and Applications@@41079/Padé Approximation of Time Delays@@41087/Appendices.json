{"hands_on_practices": [{"introduction": "The transfer function for a pure time delay, $\\exp(-\\tau s)$, is transcendental, which complicates analysis using standard algebraic tools. To overcome this, we can approximate it with a rational function. This first exercise guides you through the fundamental process of deriving the first-order Padé approximation by matching its Maclaurin series expansion to that of the time delay function, a core skill for modeling delayed systems [@problem_id:1597561].", "problem": "In a chemical processing plant, a concentration sensor is installed in a pipe at a significant distance downstream from a continuous stirred-tank reactor. The fluid in the pipe travels at a constant velocity, introducing a pure time delay, also known as a transport lag, into the measurement signal. For the purposes of designing a digital feedback controller, this time delay must be approximated by a rational transfer function. The transport lag for the system has been measured to be $\\tau = 1.5$ seconds. Determine the first-order Padé approximation, denoted as $G_a(s)$, for the transfer function of this time delay.", "solution": "A pure time delay of duration $\\tau$ has the transfer function $G(s)=\\exp(-\\tau s)$. To obtain the first-order Padé approximation, we approximate $\\exp(-\\tau s)$ by a rational function of the form\n$$\nG_{a}(s)=\\frac{1+a s}{1+b s},\n$$\nwhose Maclaurin series matches that of $\\exp(-\\tau s)$ up to terms of order $s^{2}$. The series expansion of the delay is\n$$\n\\exp(-\\tau s)=1-\\tau s+\\frac{\\tau^{2}}{2}s^{2}+\\mathcal{O}(s^{3}).\n$$\nExpanding $G_{a}(s)$ about $s=0$ gives\n$$\n\\frac{1+a s}{1+b s}=(1+a s)(1-b s+b^{2}s^{2}+\\mathcal{O}(s^{3}))=1+(a-b)s+(b^{2}-a b)s^{2}+\\mathcal{O}(s^{3}).\n$$\nMatching coefficients with $\\exp(-\\tau s)$ yields the system\n$$\na-b=-\\tau,\\qquad b^{2}-a b=\\frac{\\tau^{2}}{2}.\n$$\nFrom $a=-\\tau+b$ and substituting into the second equation,\n$$\nb^{2}-(-\\tau+b)b=\\tau b=\\frac{\\tau^{2}}{2}\\quad\\Rightarrow\\quad b=\\frac{\\tau}{2},\\quad a=-\\frac{\\tau}{2}.\n$$\nTherefore, the first-order Padé approximation is\n$$\nG_{a}(s)=\\frac{1-\\frac{\\tau}{2}s}{1+\\frac{\\tau}{2}s}.\n$$\nWith the given transport lag $\\tau=1.5=\\frac{3}{2}$ seconds, we have $\\frac{\\tau}{2}=\\frac{3}{4}$, so\n$$\nG_{a}(s)=\\frac{1-\\frac{3}{4}s}{1+\\frac{3}{4}s}.\n$$", "answer": "$$\\boxed{\\frac{1-\\frac{3}{4}s}{1+\\frac{3}{4}s}}$$", "id": "1597561"}, {"introduction": "While Padé approximations are useful, they are not perfect and can introduce characteristics not present in the original system. This practice explores a crucial side effect of the first-order approximation: the creation of a zero in the right-half of the complex plane. Understanding the location and implication of this 'non-minimum phase' zero is vital for predicting the performance limitations of a control system based on an approximated model [@problem_id:1597565].", "problem": "In control systems engineering, pure time delays, represented by the transfer function $D(s) = \\exp(-sT)$, are non-rational and can complicate analysis. A common technique is to approximate this delay using a Padé approximation. The first-order Padé approximation of the time delay is given by the rational function:\n$$P_1(s) = \\frac{1 - \\frac{sT}{2}}{1 + \\frac{sT}{2}}$$\nwhere $s$ is the complex frequency variable and $T$ is the constant time delay.\n\nConsider a process with an intrinsic transfer function $G_p(s) = \\frac{K}{s+a}$, where $K$ and $a$ are positive real constants representing the process gain and pole location, respectively. The full open-loop transfer function, including the time delay, is $L(s) = G_p(s) D(s)$.\n\nFor analysis purposes, we replace the exact delay $D(s)$ with its first-order Padé approximation $P_1(s)$, resulting in an approximated open-loop transfer function $L_{approx}(s) = G_p(s) P_1(s)$. This approximation introduces a finite zero into the system model that was not present in the original process $G_p(s)$.\n\nDetermine the location of this zero in the complex s-plane. Express your answer as a symbolic expression in terms of the time delay $T$.", "solution": "We use the first-order Padé approximation of the pure time delay, given by the rational function\n$$\nP_{1}(s)=\\frac{1-\\frac{sT}{2}}{1+\\frac{sT}{2}}.\n$$\nThe intrinsic process transfer function is\n$$\nG_{p}(s)=\\frac{K}{s+a},\n$$\nwith $K>0$ and $a>0$. Replacing the exact delay with $P_{1}(s)$, the approximated open-loop transfer function is\n$$\nL_{\\text{approx}}(s)=G_{p}(s)P_{1}(s)=\\frac{K}{s+a}\\cdot\\frac{1-\\frac{sT}{2}}{1+\\frac{sT}{2}}=\\frac{K\\left(1-\\frac{sT}{2}\\right)}{(s+a)\\left(1+\\frac{sT}{2}\\right)}.\n$$\nZeros of a transfer function are the roots of its numerator polynomial when written in factored pole-zero form. The numerator of $L_{\\text{approx}}(s)$ is $K\\left(1-\\frac{sT}{2}\\right)$. Since $K\\neq 0$, the zero is obtained by solving\n$$\n1-\\frac{sT}{2}=0 \\quad \\Longrightarrow \\quad s=\\frac{2}{T}.\n$$\nThus, the Padé approximation introduces a single zero at $s=\\frac{2}{T}$ in the right half-plane for $T>0$.", "answer": "$$\\boxed{\\frac{2}{T}}$$", "id": "1597565"}, {"introduction": "The primary motivation for approximating time delays is to make intractable analysis problems solvable. In this practice, you will apply the first-order Padé approximation to a realistic control scenario: determining the stability limits of a feedback system with a time delay. By replacing the exponential term, you can use algebraic stability criteria to find the maximum controller gain before the system becomes unstable, demonstrating the practical power of this approximation technique [@problem_id:1597578].", "problem": "A simplified model for the temperature control of a continuously stirred-tank reactor (CSTR) is being analyzed. The process transfer function, relating the change in heater power input, $\\Delta P(s)$, to the resulting change in reactor temperature, $\\Delta T(s)$, is given by:\n$$G(s) = \\frac{\\Delta T(s)}{\\Delta P(s)} = \\frac{A}{s+a} e^{-\\tau s}$$\nHere, $A$ represents the process gain, $1/a$ is the reactor's time constant, and $\\tau$ is a time delay associated with the temperature sensor. The system is controlled using a proportional controller, $C(s)=K$, in a standard unity feedback configuration.\n\nDue to the time delay term $e^{-\\tau s}$, standard stability analysis techniques like the Routh-Hurwitz criterion cannot be directly applied to the characteristic equation. To circumvent this, you are to approximate the time delay using a first-order Padé approximation.\n\nDetermine the maximum value of the proportional gain $K$ for which the closed-loop system remains stable. Your answer should be a symbolic expression in terms of the positive real parameters $A$, $a$, and $\\tau$.", "solution": "We are given the plant transfer function with time delay\n$$G(s)=\\frac{A}{s+a}\\exp(-\\tau s),$$\nwith a proportional controller $C(s)=K$ in unity feedback. The closed-loop characteristic equation is\n$$1+K G(s)=0.$$\nBecause of the delay, we approximate it by the first-order Padé formula\n$$\\exp(-\\tau s)\\approx\\frac{1-\\frac{\\tau}{2}s}{1+\\frac{\\tau}{2}s}.$$\nThus the approximated plant is\n$$G_{\\text{Pade}}(s)=\\frac{A}{s+a}\\cdot\\frac{1-\\frac{\\tau}{2}s}{1+\\frac{\\tau}{2}s}.$$\nThe characteristic equation with this approximation becomes\n$$1+K\\,G_{\\text{Pade}}(s)=0,$$\nwhich, after multiplying by $(s+a)\\left(1+\\frac{\\tau}{2}s\\right)$, yields the polynomial equation\n$$(s+a)\\left(1+\\frac{\\tau}{2}s\\right)+K A\\left(1-\\frac{\\tau}{2}s\\right)=0.$$\nExpanding and collecting powers of $s$,\n$$(s+a)+\\frac{\\tau}{2}s(s+a)+K A-\\frac{\\tau}{2}K A\\,s=0,$$\n$$\\frac{\\tau}{2}s^{2}+\\left(1+\\frac{\\tau a}{2}-\\frac{\\tau K A}{2}\\right)s+(a+K A)=0.$$\nMultiplying through by $\\frac{2}{\\tau}$ to obtain a monic quadratic,\n$$s^{2}+\\left(\\frac{2}{\\tau}+a-K A\\right)s+\\frac{2}{\\tau}(a+K A)=0.$$\nFor a second-order polynomial $s^{2}+b s+c$ with positive leading coefficient, the Routh-Hurwitz stability conditions are $b>0$ and $c>0$. Here,\n$$b=\\frac{2}{\\tau}+a-K A,\\qquad c=\\frac{2}{\\tau}(a+K A).$$\nSince $a>0$, $A>0$, and $\\tau>0$, we have $c>0$ if and only if $a+K A>0$, which is satisfied for all $K>-\\frac{a}{A}$, in particular for all nonnegative $K$. The upper bound on $K$ comes from $b>0$:\n$$\\frac{2}{\\tau}+a-K A>0\\quad\\Longrightarrow\\quad K<\\frac{\\frac{2}{\\tau}+a}{A}.$$\nTherefore, the maximum proportional gain that preserves stability (i.e., the stability limit) is\n$$K_{\\max}=\\frac{\\frac{2}{\\tau}+a}{A}.$$", "answer": "$$\\boxed{\\frac{a+\\frac{2}{\\tau}}{A}}$$", "id": "1597578"}]}