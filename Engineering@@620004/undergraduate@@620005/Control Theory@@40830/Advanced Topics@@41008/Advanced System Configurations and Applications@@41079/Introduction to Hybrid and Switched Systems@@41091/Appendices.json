{"hands_on_practices": [{"introduction": "Hybrid systems often exhibit behaviors not present in any of their individual modes. This first practice explores how two inherently stable first-order systems can be combined through a simple state-based switching rule, known as hysteresis, to generate a stable, self-sustaining oscillation or limit cycle [@problem_id:1582958]. Mastering this concept is fundamental to understanding how complex, emergent behaviors arise in switched systems, from electronic oscillators to biological clocks.", "problem": "Consider a switched dynamical system used to model a simple electronic oscillator. The system's state is described by a single scalar variable $x(t)$, and its dynamics can be switched between two modes. The two modes are described by the following first-order affine differential equations:\n\n- Subsystem 1: $\\dot{x} = -x + U_{max}$\n- Subsystem 2: $\\dot{x} = -x - U_{max}$\n\nHere, $U_{max}$ is a positive constant representing the magnitude of a control input.\n\nA hysteresis-based switching law is implemented to control the system and induce periodic behavior. The switching logic is as follows:\n1. The system operates under Subsystem 1, causing $x(t)$ to move towards its equilibrium. When the state $x(t)$ increases and reaches an upper threshold value of $S$, the system instantaneously switches to Subsystem 2.\n2. The system then operates under Subsystem 2, causing $x(t)$ to move towards its new equilibrium. When the state $x(t)$ decreases and reaches a lower threshold value of $-S$, the system instantaneously switches back to Subsystem 1.\n\nThis process repeats, creating a stable limit cycle. The parameters are chosen such that $0 < S < U_{max}$, which guarantees that the thresholds are reachable from the opposing equilibria.\n\nDetermine the total period $T$ of the resulting stable limit cycle oscillation. Express your answer as a function of the parameters $S$ and $U_{max}$.", "solution": "The system has two affine first-order subsystems with dynamics $\\dot{x}=-x\\pm U_{max}$. For a constant input $c$, the standard solution of $\\dot{x}=-x+c$ with initial condition $x(0)=x_{0}$ is\n$$\nx(t)=c+\\left(x_{0}-c\\right)\\exp(-t),\n$$\nwhich exponentially approaches the equilibrium $x=c$ with time constant $1$.\n\nSegment 1 (from $-S$ to $S$ under Subsystem 1): Here $c=U_{max}$ and $x(0)=-S$, so\n$$\nx(t)=U_{max}+(-S-U_{max})\\exp(-t).\n$$\nLet $t_{1}$ be the time when $x(t_{1})=S$. Solve:\n$$\nS=U_{max}+(-S-U_{max})\\exp(-t_{1}) \\\\\nS-U_{max}=(-S-U_{max})\\exp(-t_{1}) \\\\\nU_{max}-S=(S+U_{max})\\exp(-t_{1}) \\\\\n\\exp(-t_{1})=\\frac{U_{max}-S}{U_{max}+S},\n$$\nhence\n$$\nt_{1}=\\ln\\!\\left(\\frac{U_{max}+S}{U_{max}-S}\\right).\n$$\n\nSegment 2 (from $S$ to $-S$ under Subsystem 2): Here $c=-U_{max}$ and $x(0)=S$, so\n$$\nx(t)=-U_{max}+(S+U_{max})\\exp(-t).\n$$\nLet $t_{2}$ be the time when $x(t_{2})=-S$. Solve:\n$$\n-S=-U_{max}+(S+U_{max})\\exp(-t_{2}) \\\\\n-U_{max}+S=(S+U_{max})\\exp(-t_{2}) \\\\\nU_{max}-S=(S+U_{max})\\exp(-t_{2}) \\\\\n\\exp(-t_{2})=\\frac{U_{max}-S}{U_{max}+S},\n$$\nso\n$$\nt_{2}=\\ln\\!\\left(\\frac{U_{max}+S}{U_{max}-S}\\right).\n$$\n\nThe total period is the sum of the two segment times:\n$$\nT=t_{1}+t_{2}=2\\ln\\!\\left(\\frac{U_{max}+S}{U_{max}-S}\\right).\n$$\nThe condition $0<S<U_{max}$ ensures that $0<\\frac{U_{max}-S}{U_{max}+S}<1$, so the logarithmâ€™s argument exceeds $1$, yielding positive times and a well-defined period.", "answer": "$$\\boxed{2\\ln\\!\\left(\\frac{U_{max}+S}{U_{max}-S}\\right)}$$", "id": "1582958"}, {"introduction": "Building on the idea of state-dependent switching, we now investigate how such rules can be used to actively manipulate the energy of a system. This thought experiment involves a mechanical oscillator where the spring stiffness is changed based on the direction of motion, a process analogous to \"parametric pumping\" [@problem_id:1583017]. By solving this problem, you will gain a physical intuition for how a switched controller can systematically inject energy into a system, leading to amplification rather than simple oscillation.", "problem": "Consider a \"parametric pumping\" oscillator consisting of a point mass $m$ free to move on a frictionless, horizontal track. The mass is attached to a special device that exerts a restoring force $F = -k(x,v)x$, where $x$ is the displacement from the equilibrium position at $x=0$ and $v$ is the velocity of the mass. The effective spring constant, $k$, is instantaneously and electronically adjusted according to the following state-dependent rules:\n\n1.  When the mass is moving away from the equilibrium point (i.e., when $x \\cdot v > 0$), the spring constant is set to a value $k_1$.\n2.  When the mass is moving towards the equilibrium point (i.e., when $x \\cdot v  0$), the spring constant is set to a value $k_2$.\n\nBoth $k_1$ and $k_2$ are positive constants.\n\nAt time $t=0$, the mass is released from rest at an initial positive displacement $x_0$. After its release, the mass begins to oscillate. Let $x_1$ denote the maximum positive displacement reached by the mass after it has completed its first full oscillation (i.e., the first time it returns to a state of zero velocity at a positive displacement).\n\nDetermine the ratio $x_1 / x_0$. Express your final answer as a closed-form analytic expression in terms of $k_1$ and $k_2$.", "solution": "The force is given by $F=-k(x,v)\\,x$, with $k=k_{1}$ when $xv0$ (moving away from equilibrium) and $k=k_{2}$ when $xv0$ (moving toward equilibrium). For any time interval during which the sign of $xv$ is fixed, $k$ is constant, so the equation of motion is $m\\ddot{x}+k_{i}x=0$ with $k_{i}\\in\\{k_{1},k_{2}\\}$, and the mechanical energy\n$$\nE_{i}=\\frac{1}{2}m v^{2}+\\frac{1}{2}k_{i}x^{2}\n$$\nis conserved on that interval.\n\nAt $t=0$, the mass is at $x=x_{0}0$ with $v=0$. Immediately after release, it moves toward equilibrium, so the motion from $x_{0}$ to the first crossing of $x=0$ occurs with $k=k_{2}$ and conserved energy\n$$\nE_{(1)}=\\frac{1}{2}k_{2}x_{0}^{2}.\n$$\nAt $x=0$, the potential energy is zero, so the kinetic energy equals $E_{(1)}$, i.e.,\n$$\n\\frac{1}{2}m v^{2}=\\frac{1}{2}k_{2}x_{0}^{2}.\n$$\n\nAfter crossing to $x0$, the motion is away from equilibrium, so $k$ switches to $k_{1}$. Energy is conserved on this segment with\n$$\nE_{(2)}=\\frac{1}{2}m v^{2}=\\frac{1}{2}k_{2}x_{0}^{2}.\n$$\nAt the negative turning point $x=-x_{-}$ (where $v=0$), all energy is potential with $k_{1}$, so\n$$\n\\frac{1}{2}k_{1}x_{-}^{2}=E_{(2)}=\\frac{1}{2}k_{2}x_{0}^{2}\n\\quad\\Rightarrow\\quad\nx_{-}^{2}=\\frac{k_{2}}{k_{1}}\\,x_{0}^{2}.\n$$\n\nAt that instant (with $v=0$), the device switches to $k=k_{2}$ for the inward motion. The energy conserved on the next inward segment is then\n$$\nE_{(3)}=\\frac{1}{2}k_{2}x_{-}^{2}.\n$$\nThis energy remains purely kinetic at the next crossing $x=0$, and after crossing into $x0$ the motion is outward with $k=k_{1}$. On this final outward segment, energy is conserved as\n$$\nE_{(4)}=\\frac{1}{2}m v^{2}=E_{(3)}=\\frac{1}{2}k_{2}x_{-}^{2}.\n$$\nAt the next positive turning point $x=x_{1}$ (with $v=0$), the energy is purely potential with $k_{1}$:\n$$\n\\frac{1}{2}k_{1}x_{1}^{2}=E_{(4)}=\\frac{1}{2}k_{2}x_{-}^{2}\n\\quad\\Rightarrow\\quad\nx_{1}^{2}=\\frac{k_{2}}{k_{1}}\\,x_{-}^{2}.\n$$\nSubstituting $x_{-}^{2}=(k_{2}/k_{1})x_{0}^{2}$ gives\n$$\nx_{1}^{2}=\\left(\\frac{k_{2}}{k_{1}}\\right)^{2}x_{0}^{2}\n\\quad\\Rightarrow\\quad\n\\frac{x_{1}}{x_{0}}=\\frac{k_{2}}{k_{1}}.\n$$\nThis result is independent of $m$ and shows amplification when $k_{2}k_{1}$ and attenuation when $k_{2}k_{1}$.", "answer": "$$\\boxed{\\frac{k_{2}}{k_{1}}}$$", "id": "1583017"}, {"introduction": "In the real world, control actions are never truly instantaneous; processing and actuation delays are unavoidable. This final practice examines the profound impact of a constant time delay $\\tau$ on a simple relay control system [@problem_id:1582973]. You will discover how a controller designed to be stabilizing under ideal conditions can, in the presence of delay, lead to persistent, and often undesirable, limit cycle oscillations, a crucial lesson for the design of practical control systems.", "problem": "Consider a simplified model for a one-dimensional positioning system. The position of an object is denoted by $x(t)$, and its velocity is directly controlled by an input $u(t)$, such that $\\frac{dx}{dt} = u(t)$. The goal is to maintain the object at the origin, $x=0$.\n\nThe control system employed is a simple relay controller, which applies a corrective velocity of constant magnitude $K  0$. The direction of the velocity depends on the sign of the measured position. However, there is a constant processing delay of $\\tau  0$ between the measurement of the position and the application of the control velocity.\n\nThe resulting dynamics of the system are described by the delay-differential equation:\n$$ \\frac{dx}{dt}(t) = -K \\cdot \\text{sgn}(x(t-\\tau)) $$\nwhere $\\text{sgn}(\\cdot)$ is the signum function, defined as $\\text{sgn}(z) = 1$ for $z0$, $\\text{sgn}(z) = -1$ for $z0$, and $\\text{sgn}(0) = 0$.\n\nIt is observed that for any non-zero initial state, the system does not converge to the origin but instead enters a stable periodic oscillation, known as a limit cycle. Determine the amplitude $A$ (the maximum displacement from the origin) and the period $T$ of this limit cycle.\n\nProvide your answer as an ordered pair $(A, T)$.", "solution": "The plant is an integrator with input a relay control based on a delayed measurement. The dynamics are\n$$\n\\frac{dx}{dt}(t) = -K\\,\\text{sgn}(x(t-\\tau)),\n$$\nso $x(t)$ is piecewise linear with slope either $+K$ or $-K$, and control switchings occur when $x(t-\\tau)$ changes sign. If $z_{n}$ denotes a zero-crossing time of $x$, then the corresponding control switching time is $s_{n} = z_{n} + \\tau$.\n\nIn the limit cycle, choose a reference time $t=0$ at a zero crossing with $x$ passing from positive to negative (so $x(0)=0$ and for small $t0$, $x(t)0$). For $t\\in(0,\\tau)$, the delayed argument $t-\\tau\\in(-\\tau,0)$ where $x$ was positive, hence $\\text{sgn}(x(t-\\tau))=+1$ and\n$$\n\\frac{dx}{dt}(t) = -K,\\quad 0\\le t\\le \\tau,\n$$\nwhich integrates to\n$$\nx(t) = -K t,\\quad 0\\le t\\le \\tau.\n$$\nAt $t=\\tau$, a switch occurs because the zero crossing at $t=0$ is now seen by the delayed argument, so for $t\\in(\\tau,3\\tau)$ we have $t-\\tau\\in(0,2\\tau)$ where $x$ is negative near $0$ and then becomes nonnegative after $t=2\\tau$, but the switch is already fixed at $t=\\tau$ until the next zero crossing is seen. Immediately after $t=\\tau$, $\\text{sgn}(x(t-\\tau))=-1$, so\n$$\n\\frac{dx}{dt}(t) = +K,\\quad \\tau\\le t\\le 3\\tau,\n$$\nand integrating from $t=\\tau$ with $x(\\tau^{-})=-K\\tau$ gives\n$$\nx(t) = -K\\tau + K(t-\\tau),\\quad \\tau\\le t\\le 3\\tau.\n$$\nAt $t=2\\tau$ this yields $x(2\\tau)=0$, showing a zero crossing; the next control switch will therefore occur at $t=3\\tau$. At $t=3\\tau$,\n$$\nx(3\\tau^{-}) = -K\\tau + K(2\\tau) = K\\tau,\n$$\nwhich is the maximum displacement. For $t\\in(3\\tau,5\\tau)$ the delayed sign has flipped (due to the zero crossing at $2\\tau$), so the slope becomes $-K$:\n$$\n\\frac{dx}{dt}(t) = -K,\\quad 3\\tau\\le t\\le 5\\tau,\n$$\nand integrating from $t=3\\tau$ gives\n$$\nx(t) = K\\tau - K(t-3\\tau),\\quad 3\\tau\\le t\\le 5\\tau.\n$$\nAt $t=4\\tau$ we have $x(4\\tau)=0$, and at $t=4\\tau^{+}$ the slope is again $-K$ (since $x(3\\tau)0$), so the state $(x,\\dot{x})$ repeats that at $t=0^{+}$. Therefore, the oscillation is periodic with period\n$$\nT = 4\\tau,\n$$\nand the maximum displacement (amplitude) attained is\n$$\nA = K\\tau.\n$$\nHence the limit cycle has amplitude $A=K\\tau$ and period $T=4\\tau$.", "answer": "$$\\boxed{\\begin{pmatrix} K\\tau  4\\tau \\end{pmatrix}}$$", "id": "1582973"}]}