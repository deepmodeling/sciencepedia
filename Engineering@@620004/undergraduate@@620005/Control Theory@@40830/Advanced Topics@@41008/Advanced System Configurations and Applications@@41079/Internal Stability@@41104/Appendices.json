{"hands_on_practices": [{"introduction": "A control system can appear stable from an input-output perspective, yet still harbor hidden instabilities. This first practice problem [@problem_id:1581505] provides a clear conceptual illustration using the scenario of a chemical reactor. By analyzing a parasitic, unstable thermal process that is decoupled from the main control loop, you will see how a system can be internally unstable even when its primary transfer function is stable.", "problem": "A control engineer is tasked with regulating the product concentration, $y(t)$, from a Continuously Stirred-Tank Reactor (CSTR). The relationship between the reactant feed rate, $u(t)$, and the product concentration is modeled by the stable first-order transfer function $P(s)$, where $s$ is the Laplace variable:\n$$P(s) = \\frac{Y(s)}{U(s)} = \\frac{K_p}{s+a}$$\nHere, $K_p$ and $a$ are positive real constants. A simple proportional controller with transfer function $C(s) = K_c$, where $K_c$ is a positive constant, is implemented in a standard unity-gain negative feedback configuration, such that the control signal is $u(t) = K_c(r(t) - y(t))$, where $r(t)$ is the desired concentration setpoint. Both the plant $P(s)$ and a controller $C(s)$ are stable.\n\nUnbeknownst to the engineer, a slow, parasitic side-reaction also occurs within the reactor. The temperature associated with this side-reaction, $T(t)$, is not affected by the reactant feed rate $u(t)$ and its thermal effects on the main reaction are negligible, so it does not appear in the transfer function $P(s)$. The dynamics of this parasitic temperature are governed by the equation:\n$$\\frac{dT(t)}{dt} = \\lambda T(t)$$\nwhere $\\lambda$ is a small, positive real constant, indicating a slow, unstable thermal runaway.\n\nThe system is operated with a zero setpoint, $r(t) = 0$ for all $t \\ge 0$. At time $t=0$, the system has a non-zero parasitic temperature $T(0) = T_0$ but the main reaction is at equilibrium with $y(0)=0$. Despite the input-output stability of the main control loop, an operator reports that the overall system is behaving unexpectedly over long time scales. To investigate this, determine the analytical expression for the parasitic temperature $T(t)$ for all $t \\ge 0$. Your final expression should be in terms of $T_0$, $\\lambda$, and $t$.", "solution": "The parasitic temperature dynamics are given independently of the control loop by the first-order linear ordinary differential equation\n$$\\frac{dT(t)}{dt} = \\lambda T(t),$$\nwith initial condition $T(0) = T_{0}$ and parameter $\\lambda > 0$. This equation can be solved by separation of variables. Assuming $T(t) \\neq 0$ (the solution for $T(t)=0$ is trivially included in the general solution by choosing the integration constant accordingly), write\n$$\\frac{dT(t)}{T(t)} = \\lambda \\, dt.$$\nIntegrating both sides with respect to $t$ yields\n$$\\int \\frac{1}{T(t)} \\, dT(t) = \\int \\lambda \\, dt \\quad \\Rightarrow \\quad \\ln|T(t)| = \\lambda t + C,$$\nwhere $C$ is an integration constant. Exponentiating both sides gives\n$$|T(t)| = \\exp(C)\\exp(\\lambda t).$$\nAbsorbing the sign into the constant, define $C_{1} = \\pm \\exp(C)$ to obtain the general solution\n$$T(t) = C_{1}\\exp(\\lambda t).$$\nApplying the initial condition $T(0) = T_{0}$ gives\n$$T_{0} = C_{1}\\exp(0) = C_{1},$$\nso the unique solution satisfying the initial condition is\n$$T(t) = T_{0}\\exp(\\lambda t), \\quad t \\ge 0.$$\nThis shows that for $\\lambda > 0$ the parasitic temperature grows exponentially over time, independent of the main control loop.", "answer": "$$\\boxed{T_{0}\\exp(\\lambda t)}$$", "id": "1581505"}, {"introduction": "One of the most tempting but dangerous shortcuts in controller design is the cancellation of an unstable plant pole or zero. This practice [@problem_id:1581452] explores the consequences of such a design by having you calculate an internal signal, the control effort $u(t)$. You will demonstrate mathematically why, despite a seemingly stable input-to-output relationship, the system is internally unstable and would fail in practice due to a saturating or unbounded control signal.", "problem": "A control system is designed for a chemical process in a bioreactor. The process dynamics, relating the input reagent concentration $U(s)$ to the measured output product concentration $Y(s)$, are modeled by the transfer function $P(s) = B(s-p_0)$. Here, $s$ is the Laplace variable, $p_0$ is a positive real constant representing an unstable zero inherent to the reaction kinetics, and $B$ is a positive process gain.\n\nAn engineer proposes a controller with the transfer function $C(s) = \\frac{A}{s-p_0}$, where $A$ is a positive controller gain. The controller's pole is deliberately chosen to cancel the plant's unstable zero. The plant and controller are arranged in a standard unity-feedback configuration, where the controller's output is the reagent concentration, $u(t)$, and the controller's input is the error signal $e(t) = r(t) - y(t)$.\n\nWhile the overall transfer function from the reference signal $r(t)$ to the plant output $y(t)$ appears stable due to this cancellation, a senior engineer expresses concern about the system's internal stability. To investigate this concern, calculate the analytical expression for the control signal $u(t)$ that is fed to the plant when the system is subjected to a unit step reference input, $r(t)=1$ for $t \\ge 0$. Assume the system is initially at rest (zero initial conditions). Express your answer in terms of the symbolic constants $A$, $B$, and $p_0$.", "solution": "In a unity-feedback configuration, the Laplace-domain relations among the signals are:\n- $Y(s) = P(s) U(s) = B(s - p_{0}) U(s)$,\n- $E(s) = R(s) - Y(s)$,\n- $U(s) = C(s) E(s) = \\dfrac{A}{s - p_{0}} E(s)$.\n\nEliminating $E(s)$ and $Y(s)$ to solve directly for $U(s)$ gives\n$$\nU(s) = \\frac{C(s)}{1 + C(s) P(s)} R(s).\n$$\nWith $C(s) = \\dfrac{A}{s - p_{0}}$ and $P(s) = B(s - p_{0})$, the loop transfer becomes\n$$\nC(s) P(s) = \\frac{A}{s - p_{0}} \\, B(s - p_{0}) = A B.\n$$\nFor a unit step input, $R(s) = \\dfrac{1}{s}$, so\n$$\nU(s) = \\frac{\\dfrac{A}{s - p_{0}}}{1 + A B} \\cdot \\frac{1}{s}\n= \\frac{A}{1 + A B} \\cdot \\frac{1}{s(s - p_{0})}.\n$$\nPerform a partial-fraction decomposition:\n$$\n\\frac{1}{s(s - p_{0})} = \\frac{\\alpha}{s} + \\frac{\\beta}{s - p_{0}},\n$$\nwhich requires $1 = \\alpha(s - p_{0}) + \\beta s$. Setting $s = 0$ gives $\\alpha = -\\dfrac{1}{p_{0}}$, and setting $s = p_{0}$ gives $\\beta = \\dfrac{1}{p_{0}}$. Hence\n$$\n\\frac{1}{s(s - p_{0})} = -\\frac{1}{p_{0}} \\cdot \\frac{1}{s} + \\frac{1}{p_{0}} \\cdot \\frac{1}{s - p_{0}}.\n$$\nUsing the inverse Laplace transforms $\\mathcal{L}^{-1}\\{1/s\\} = 1$ and $\\mathcal{L}^{-1}\\{1/(s - p_{0})\\} = \\exp(p_{0} t)$ for $t \\ge 0$, the time-domain control signal is\n$$\nu(t) = \\frac{A}{1 + A B} \\left( -\\frac{1}{p_{0}} \\cdot 1 + \\frac{1}{p_{0}} \\exp(p_{0} t) \\right)\n= \\frac{A}{(1 + A B) p_{0}} \\left( \\exp(p_{0} t) - 1 \\right),\n\\quad t \\ge 0.\n$$\nThis expression shows exponential growth due to the internal unstable mode at $s = p_{0}$, despite the apparently stable input-output map from $r$ to $y$.", "answer": "$$\\boxed{\\frac{A}{(1+A B)\\,p_{0}}\\left(\\exp(p_{0} t)-1\\right)}$$", "id": "1581452"}, {"introduction": "How can we systematically detect hidden instabilities? The key is to recognize that a control system responds to more than just setpoint changes; it must also handle disturbances. This exercise [@problem_id:1581494] introduces a more rigorous stability check by examining all the crucial transfer functions within a feedback loop. You will discover how an injected disturbance can reveal an unstable mode that was hidden in the standard reference-to-output analysis, proving the necessity of this comprehensive approach for guaranteeing internal stability.", "problem": "A junior control systems engineer is tasked with designing a controller for a given process. The system is configured as a standard unity negative feedback loop. The process (or \"plant\") is modeled by the transfer function $P(s)$, and the controller is given by $C(s)$. The relationship between the reference input $r(t)$, the controller output (control signal) $u(t)$, and the plant output $y(t)$ is described by the Laplace domain equations $U(s) = C(s)(R(s) - Y(s))$ and $Y(s) = P(s)U(s)$.\n\nThe specific transfer functions are:\n$$P(s) = \\frac{s - 2}{(s + 5)(s - 1)}$$\n$$C(s) = \\frac{K(s - 1)}{s + 4}$$\nwhere $K=3$.\n\nThe engineer first computes the loop transfer function $L(s) = P(s)C(s)$ and then analyzes the nominal closed-loop transfer function from the reference to the output, $T_{yr}(s) = \\frac{Y(s)}{R(s)}$. Finding all poles of $T_{yr}(s)$ to be in the left-half of the complex plane, the engineer concludes the system is stable.\n\nHowever, this conclusion is premature because it does not guarantee *internal stability*. A system is internally stable only if the transfer function between *any* two points in the loop is stable. To test this, consider an additive disturbance $d(t)$ that enters the system at the input to the plant, so the new plant input is $u(t) + d(t)$. In the Laplace domain, the plant output is now governed by $Y(s) = P(s)(U(s) + D(s))$.\n\nYour task is to determine which of the key closed-loop transfer functions reveals the system's internal instability by having at least one pole with a non-negative real part.\n\nWhich one of the following transfer functions is unstable?\n\nA. The transfer function from reference to output, $T_{yr}(s) = \\frac{Y(s)}{R(s)}$\n\nB. The transfer function from reference to control signal, $T_{ur}(s) = \\frac{U(s)}{R(s)}$\n\nC. The transfer function from disturbance to output, $T_{yd}(s) = \\frac{Y(s)}{D(s)}$\n\nD. The transfer function from disturbance to control signal, $T_{ud}(s) = \\frac{U(s)}{D(s)}$", "solution": "Given unity negative feedback with $U(s) = C(s)(R(s) - Y(s))$ and $Y(s) = P(s)(U(s) + D(s))$, solve for $U$ and $Y$ in terms of $R$ and $D$.\n\nStart from $Y = P(U + D)$ and substitute into $U = C(R - Y)$ to obtain\n$$\nU = C R - C Y = C R - C P(U + D) = C R - C P U - C P D.\n$$\nCollecting terms in $U$ gives\n$$\n(1 + C P) U = C R - C P D,\n$$\nand hence\n$$\n\\frac{U}{R} = \\frac{C}{1 + C P}, \\quad \\frac{U}{D} = -\\frac{C P}{1 + C P}.\n$$\nUsing $Y = P(U + D)$, we get\n$$\n\\frac{Y}{R} = P \\frac{U}{R} = \\frac{P C}{1 + C P}, \\quad \\frac{Y}{D} = P \\frac{U}{D} + P = \\frac{P}{1 + C P}.\n$$\n\nWith $P(s) = \\frac{s - 2}{(s + 5)(s - 1)}$ and $C(s) = \\frac{K(s - 1)}{s + 4}$, compute $1 + C P$ without canceling the unstable factor:\n$$\nC P = \\frac{K(s - 1)}{s + 4} \\cdot \\frac{s - 2}{(s + 5)(s - 1)} = \\frac{K(s - 2)(s - 1)}{(s + 4)(s + 5)(s - 1)}.\n$$\nTherefore,\n$$\n1 + C P = \\frac{(s + 4)(s + 5)(s - 1) + K(s - 2)(s - 1)}{(s + 4)(s + 5)(s - 1)} = \\frac{(s - 1)\\big((s + 4)(s + 5) + K(s - 2)\\big)}{(s + 4)(s + 5)(s - 1)}.\n$$\n\nNow compute each closed-loop transfer function:\n\n1) From reference to output:\n$$\nT_{yr}(s) = \\frac{Y}{R} = \\frac{P C}{1 + C P} = \\frac{\\frac{K(s - 2)(s - 1)}{(s + 5)(s - 1)(s + 4)}}{\\frac{(s - 1)\\big((s + 4)(s + 5) + K(s - 2)\\big)}{(s + 4)(s + 5)(s - 1)}} = \\frac{K(s - 2)}{(s + 4)(s + 5) + K(s - 2)}.\n$$\nIts denominator is $(s + 4)(s + 5) + K(s - 2) = s^{2} + (9 + K)s + (20 - 2K)$, which has no factor $(s - 1)$ and, for the given $K$, is in the left-half plane as stated. Thus $T_{yr}(s)$ is stable.\n\n2) From reference to control signal:\n$$\nT_{ur}(s) = \\frac{U}{R} = \\frac{C}{1 + C P} = \\frac{\\frac{K(s - 1)}{s + 4}}{\\frac{(s - 1)\\big((s + 4)(s + 5) + K(s - 2)\\big)}{(s + 4)(s + 5)(s - 1)}} = \\frac{K(s + 5)(s - 1)}{(s + 4)(s + 5) + K(s - 2)}.\n$$\nHere $(s - 1)$ appears as a zero, not a pole. Poles are the roots of $(s + 4)(s + 5) + K(s - 2)$, so $T_{ur}(s)$ is stable.\n\n3) From disturbance to output:\n$$\nT_{yd}(s) = \\frac{Y}{D} = \\frac{P}{1 + C P} = \\frac{\\frac{s - 2}{(s + 5)(s - 1)}}{\\frac{(s - 1)\\big((s + 4)(s + 5) + K(s - 2)\\big)}{(s + 4)(s + 5)(s - 1)}} = \\frac{(s - 2)(s + 4)}{(s - 1)\\big((s + 4)(s + 5) + K(s - 2)\\big)}.\n$$\nThis expression retains an explicit factor $(s - 1)$ in the denominator, which is a right-half-plane pole. Therefore $T_{yd}(s)$ is unstable.\n\n4) From disturbance to control signal:\n$$\nT_{ud}(s) = \\frac{U}{D} = -\\frac{C P}{1 + C P} = -\\frac{K(s - 2)}{(s + 4)(s + 5) + K(s - 2)}.\n$$\nIts poles are again the roots of $(s + 4)(s + 5) + K(s - 2)$, so $T_{ud}(s)$ is stable.\n\nThus, the internal instability is exposed by the disturbance-to-output transfer function $T_{yd}(s)$, which has an unstable pole at $s = 1$ due to the attempted cancellation of the plant’s unstable pole by the controller zero.", "answer": "$$\\boxed{C}$$", "id": "1581494"}]}