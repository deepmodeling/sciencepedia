{"hands_on_practices": [{"introduction": "In single-input, single-output (SISO) systems, the concept of gain is straightforward. However, for multivariable systems, the effect of an input on an output is more nuanced and depends on the direction of the entire input vector. This exercise challenges you to think about system gain in terms of directionality and optimization by finding the specific combination of inputs that produces the maximum steady-state effect on a chosen output [@problem_id:1583894]. Mastering this concept is key to understanding how to efficiently actuate a multivariable system.", "problem": "A thin, thermally conductive plate is modeled as a stable 2-input, 2-output Linear Time-Invariant (LTI) system. The inputs, $u_1(t)$ and $u_2(t)$, are control voltages applied to two independent heating elements. The outputs, $y_1(t)$ and $y_2(t)$, represent the temperature deviations from ambient at two distinct sensor locations on the plate.\n\nThe dynamical relationship between the vector of input Laplace transforms, $U(s) = \\begin{pmatrix} U_1(s) \\\\ U_2(s) \\end{pmatrix}$, and the vector of output Laplace transforms, $Y(s) = \\begin{pmatrix} Y_1(s) \\\\ Y_2(s) \\end{pmatrix}$, is described by the transfer function matrix $G(s)$:\n\n$$ Y(s) = G(s) U(s) $$\n\nwhere\n$$ G(s) = \\begin{pmatrix} \\frac{2}{s+1} & \\frac{1}{s+2} \\\\ \\frac{-1}{s+3} & \\frac{3}{s+1} \\end{pmatrix} $$\n\nA control strategy involves applying a constant input vector, $u(t) = u_0 = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$, to the system. The total input \"effort\" is constrained, requiring the input vector to be a unit vector, i.e., $\\sqrt{u_1^2 + u_2^2} = 1$.\n\nYour task is to determine the specific constant unit input vector $u_0$ that maximizes the steady-state temperature deviation at the first sensor location, $y_1$. Express your answer as the two components of this unit vector, $[u_1, u_2]$, in a row matrix.", "solution": "We consider a stable LTI system with transfer matrix $G(s)$ and a constant input $u(t)=u_{0}=\\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix}$ satisfying $u_{1}^{2}+u_{2}^{2}=1$. In the Laplace domain, a constant input corresponds to $U(s)=\\dfrac{u_{0}}{s}$. The output in the Laplace domain is $Y(s)=G(s)U(s)$, and the steady-state value of $y_{1}(t)$ is obtained via the final value theorem. Since the system is stable, the final value theorem applies and gives\n$$\ny_{1,\\text{ss}}=\\lim_{t\\to\\infty}y_{1}(t)=\\lim_{s\\to 0}sY_{1}(s)=\\lim_{s\\to 0}s\\left(\\text{row}_{1}\\!\\left(G(s)\\right)U(s)\\right)=\\text{row}_{1}\\!\\left(G(0)\\right)u_{0}.\n$$\nEvaluating $G(0)$ yields\n$$\nG(0)=\\begin{pmatrix} \\dfrac{2}{1} & \\dfrac{1}{2} \\\\ \\dfrac{-1}{3} & \\dfrac{3}{1} \\end{pmatrix}=\\begin{pmatrix} 2 & \\dfrac{1}{2} \\\\ -\\dfrac{1}{3} & 3 \\end{pmatrix},\n$$\nso\n$$\ny_{1,\\text{ss}}=\\begin{pmatrix} 2 & \\dfrac{1}{2} \\end{pmatrix}\\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix}=2u_{1}+\\dfrac{1}{2}u_{2}.\n$$\nWe must maximize $2u_{1}+\\dfrac{1}{2}u_{2}$ subject to $u_{1}^{2}+u_{2}^{2}=1$. Define the vector $v=\\begin{pmatrix} 2 \\\\ \\dfrac{1}{2} \\end{pmatrix}$. Then $y_{1,\\text{ss}}=v^{\\top}u_{0}$. By the Cauchyâ€“Schwarz inequality,\n$$\nv^{\\top}u_{0}\\leq \\|v\\|_{2}\\,\\|u_{0}\\|_{2}=\\|v\\|_{2},\n$$\nwith equality if and only if $u_{0}$ is parallel to $v$, i.e., $u_{0}=\\dfrac{v}{\\|v\\|_{2}}$. The norm of $v$ is\n$$\n\\|v\\|_{2}=\\sqrt{2^{2}+\\left(\\dfrac{1}{2}\\right)^{2}}=\\sqrt{\\dfrac{17}{4}}=\\dfrac{\\sqrt{17}}{2}.\n$$\nTherefore,\n$$\nu_{0}^{\\star}=\\dfrac{1}{\\|v\\|_{2}}\\begin{pmatrix} 2 \\\\ \\dfrac{1}{2} \\end{pmatrix}=\\dfrac{2}{\\sqrt{17}}\\begin{pmatrix} 2 \\\\ \\dfrac{1}{2} \\end{pmatrix}=\\begin{pmatrix} \\dfrac{4}{\\sqrt{17}} \\\\ \\dfrac{1}{\\sqrt{17}} \\end{pmatrix}.\n$$\nExpressed as a row matrix for $[u_{1},u_{2}]$, the maximizing unit input vector is $\\begin{pmatrix} \\dfrac{4}{\\sqrt{17}} & \\dfrac{1}{\\sqrt{17}} \\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{4}{\\sqrt{17}} & \\frac{1}{\\sqrt{17}} \\end{pmatrix}}$$", "id": "1583894"}, {"introduction": "Multivariable systems are defined by the intricate coupling between their inputs and outputs, which can sometimes lead to counter-intuitive dynamic behavior. This practice explores a phenomenon known as 'inverse response,' where an output initially moves in the opposite direction from its eventual steady-state value. By analyzing a system where one output is held constant, you will uncover how hidden multivariable transmission zeros dictate the system's dynamic path, a critical consideration in designing stable and predictable controllers [@problem_id:1583833].", "problem": "Consider a chemical process occurring in a Continuous Stirred-Tank Reactor (CSTR). The process is modeled as a 2-input, 2-output linear system, which is a type of Multiple-Input, Multiple-Output (MIMO) system. The inputs are the flow rate of reactant A, denoted by $u_1(t)$, and the flow rate of a catalyst, $u_2(t)$. The outputs are the concentration of the desired product P, $y_1(t)$, and the temperature within the reactor, $y_2(t)$. All variables represent deviations from a steady-state operating point.\n\nThe dynamic relationship between the inputs and outputs in the Laplace domain is described by the transfer function matrix $G(s)$:\n$$\n\\begin{pmatrix} Y_1(s) \\\\ Y_2(s) \\end{pmatrix} = G(s) \\begin{pmatrix} U_1(s) \\\\ U_2(s) \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{2s+1} & \\frac{1}{s+1} \\\\ \\frac{4}{s+1} & \\frac{3}{s+1} \\end{pmatrix} \\begin{pmatrix} U_1(s) \\\\ U_2(s) \\end{pmatrix}\n$$\nInitially, the system is at steady state with $u_1(t)=0$ and $u_2(t)=0$ for $t<0$. A control system is implemented with the objective of perfectly maintaining the reactor temperature at its initial setpoint, i.e., ensuring $y_2(t) = 0$ for all $t \\geq 0$. To achieve this, the controller manipulates the catalyst flow rate $u_2(t)$.\n\nAt time $t=0$, the flow rate of reactant A is subjected to a unit step increase, so $u_1(t) = 1$ for $t \\geq 0$.\n\nWhich of the following statements best describes the qualitative time evolution of the product concentration, $y_1(t)$, for $t > 0$?\n\nA. $y_1(t)$ monotonically increases from 0 to a new, positive steady-state value.\n\nB. $y_1(t)$ initially decreases, becoming negative, before rising to a new, positive steady-state value.\n\nC. $y_1(t)$ increases from 0, overshoots its final steady-state value, and then settles at that value.\n\nD. $y_1(t)$ monotonically decreases from 0 to a new, negative steady-state value.\n\nE. $y_1(t)$ initially increases, becoming positive, before falling to a new, negative steady-state value.", "solution": "We use linear MIMO transfer relations in the Laplace domain. The outputs are\n$$\n\\begin{pmatrix} Y_{1}(s) \\\\ Y_{2}(s) \\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{2}{2s+1} & \\frac{1}{s+1} \\\\\n\\frac{4}{s+1} & \\frac{3}{s+1}\n\\end{pmatrix}\n\\begin{pmatrix} U_{1}(s) \\\\ U_{2}(s) \\end{pmatrix}.\n$$\nThe control objective is to maintain $y_{2}(t)=0$ for $t\\geq 0$. In Laplace form this is $Y_{2}(s)=0$, so\n$$\nY_{2}(s)=\\frac{4}{s+1}U_{1}(s)+\\frac{3}{s+1}U_{2}(s)=0\n\\quad\\Longrightarrow\\quad\nU_{2}(s)=-\\frac{4}{3}U_{1}(s).\n$$\nAt $t=0$ the reactant flow undergoes a unit step, so $U_{1}(s)=\\frac{1}{s}$, hence\n$$\nU_{2}(s)=-\\frac{4}{3}\\cdot\\frac{1}{s}.\n$$\nThe product concentration output is\n$$\nY_{1}(s)=\\frac{2}{2s+1}U_{1}(s)+\\frac{1}{s+1}U_{2}(s)\n=\\left(\\frac{2}{2s+1}-\\frac{4}{3}\\cdot\\frac{1}{s+1}\\right)\\frac{1}{s}\n=\\frac{2}{s(2s+1)}-\\frac{4}{3}\\cdot\\frac{1}{s(s+1)}.\n$$\nInvert each term. First,\n$$\n\\frac{2}{s(2s+1)}=\\frac{2}{s}-\\frac{4}{2s+1}\n\\quad\\Longrightarrow\\quad\n\\mathcal{L}^{-1}\\left\\{\\frac{2}{s(2s+1)}\\right\\}=2-2\\exp\\!\\left(-\\frac{t}{2}\\right).\n$$\nSecond,\n$$\n\\frac{4}{3}\\cdot\\frac{1}{s(s+1)}=\\frac{4}{3}\\left(\\frac{1}{s}-\\frac{1}{s+1}\\right)\n\\quad\\Longrightarrow\\quad\n\\mathcal{L}^{-1}\\left\\{\\frac{4}{3}\\cdot\\frac{1}{s(s+1)}\\right\\}=\\frac{4}{3}-\\frac{4}{3}\\exp(-t).\n$$\nTherefore\n$$\ny_{1}(t)=\\left[2-2\\exp\\!\\left(-\\frac{t}{2}\\right)\\right]-\\left[\\frac{4}{3}-\\frac{4}{3}\\exp(-t)\\right]\n=\\frac{2}{3}-2\\exp\\!\\left(-\\frac{t}{2}\\right)+\\frac{4}{3}\\exp(-t),\\quad t\\geq 0.\n$$\nQualitative features:\n- Initial value: $y_{1}(0^{+})=\\frac{2}{3}-2+\\frac{4}{3}=0$.\n- Initial slope: $y_{1}'(t)=\\exp\\!\\left(-\\frac{t}{2}\\right)-\\frac{4}{3}\\exp(-t)$, so $y_{1}'(0^{+})=1-\\frac{4}{3}=-\\frac{1}{3}<0$. Thus $y_{1}$ initially decreases below zero.\n- Steady state: $\\lim_{t\\to\\infty}y_{1}(t)=\\frac{2}{3}>0$.\n- Extremum: $y_{1}'(t)=0$ gives $\\exp(t/2)=\\frac{4}{3}$, a unique $t>0$ minimum. Evaluating there yields $y_{1}<0$, confirming an undershoot. As $t\\to\\infty$, the transient term $-2\\exp(-t/2)+\\frac{4}{3}\\exp(-t)$ remains negative and tends to $0$, so $y_{1}(t)$ approaches $\\frac{2}{3}$ from below without overshoot.\n\nHence, $y_{1}(t)$ initially decreases below zero and then rises to a positive steady-state value. This corresponds to option B.", "answer": "$$\\boxed{B}$$", "id": "1583833"}, {"introduction": "The theoretical models we develop are often continuous in time, but their implementation in the real world is almost always digital. This creates a crucial gap that must be bridged by converting our continuous-time state-space models into discrete-time equivalents that a computer can use. This problem provides hands-on practice with this essential conversion process using the Zero-Order Hold (ZOH) method, a standard technique for preparing a system model for digital control implementation [@problem_id:1583869].", "problem": "A simplified model for the lateral dynamics of a quadcopter drone operating in a vertical plane is described by a continuous-time state-space representation $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B\\mathbf{u}(t)$. The state vector is defined as $\\mathbf{x} = [p, \\dot{p}, \\phi, \\dot{\\phi}]^T$, where $p$ is the horizontal position, $\\dot{p}$ is the horizontal velocity, $\\phi$ is the roll angle relative to the vertical axis, and $\\dot{\\phi}$ is the roll angular velocity. The input vector is $\\mathbf{u} = [u_1, u_2]^T$, where $u_1$ is the control input related to the roll torque and $u_2$ is a direct horizontal thrust force.\n\nThe system dynamics are given by the matrices:\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & g & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 & 0 \\\\ 0 & 1/m \\\\ 0 & 0 \\\\ \\eta & 0 \\end{pmatrix}\n$$\nwhere $g$ is the acceleration due to gravity, $m$ is the mass of the drone, and $\\eta$ is a positive constant representing the effectiveness of the roll torque control.\n\nTo implement a digital controller, this continuous-time model must be converted into an equivalent discrete-time model of the form $\\mathbf{x}_{k+1} = A_d \\mathbf{x}_k + B_d \\mathbf{u}_k$, where $T_s$ is the sampling period. This conversion is performed assuming that the control input vector $\\mathbf{u}(t)$ is held constant over each sampling interval $[kT_s, (k+1)T_s)$, which corresponds to a Zero-Order Hold (ZOH) on the inputs.\n\nDetermine the discrete-time input matrix $B_d$. Express your answer as a matrix in terms of the symbolic parameters $g$, $m$, $\\eta$, and $T_s$.", "solution": "Under a Zero-Order Hold on the inputs, the exact discrete-time matrices are given by\n$$\nA_{d}=\\exp(A T_{s}), \\quad B_{d}=\\int_{0}^{T_{s}} \\exp(A \\tau)\\, B \\, \\mathrm{d}\\tau.\n$$\nThus we need $\\exp(A \\tau)$. Since $A$ is strictly upper triangular, its powers vanish beyond order three. Compute the needed powers:\n$$\nA=\\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & g & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}, \\quad\nA^{2}=\\begin{pmatrix} 0 & 0 & g & 0 \\\\ 0 & 0 & 0 & g \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}, \\quad\nA^{3}=\\begin{pmatrix} 0 & 0 & 0 & g \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}, \\quad\nA^{4}=0.\n$$\nTherefore,\n$$\n\\exp(A \\tau)=I + A \\tau + \\frac{A^{2} \\tau^{2}}{2} + \\frac{A^{3} \\tau^{3}}{6}\n=\\begin{pmatrix}\n1 & \\tau & \\frac{g \\tau^{2}}{2} & \\frac{g \\tau^{3}}{6} \\\\\n0 & 1 & g \\tau & \\frac{g \\tau^{2}}{2} \\\\\n0 & 0 & 1 & \\tau \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}.\n$$\nNext compute $\\exp(A \\tau) B$ using\n$$\nB=\\begin{pmatrix} 0 & 0 \\\\ 0 & \\frac{1}{m} \\\\ 0 & 0 \\\\ \\eta & 0 \\end{pmatrix}.\n$$\nThe result is\n$$\n\\exp(A \\tau) B\n=\n\\begin{pmatrix}\n\\frac{\\eta g \\tau^{3}}{6} & \\frac{\\tau}{m} \\\\\n\\frac{\\eta g \\tau^{2}}{2} & \\frac{1}{m} \\\\\n\\eta \\tau & 0 \\\\\n\\eta & 0\n\\end{pmatrix}.\n$$\nIntegrating entrywise from $\\tau=0$ to $\\tau=T_{s}$ yields\n$$\nB_{d}=\\int_{0}^{T_{s}} \\exp(A \\tau) B \\, \\mathrm{d}\\tau\n=\n\\begin{pmatrix}\n\\frac{\\eta g T_{s}^{4}}{24} & \\frac{T_{s}^{2}}{2 m} \\\\\n\\frac{\\eta g T_{s}^{3}}{6} & \\frac{T_{s}}{m} \\\\\n\\frac{\\eta T_{s}^{2}}{2} & 0 \\\\\n\\eta T_{s} & 0\n\\end{pmatrix}.\n$$\nThis is the discrete-time input matrix under a Zero-Order Hold with sampling period $T_{s}$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\eta g T_{s}^{4}}{24} & \\frac{T_{s}^{2}}{2 m} \\\\ \\frac{\\eta g T_{s}^{3}}{6} & \\frac{T_{s}}{m} \\\\ \\frac{\\eta T_{s}^{2}}{2} & 0 \\\\ \\eta T_{s} & 0\\end{pmatrix}}$$", "id": "1583869"}]}