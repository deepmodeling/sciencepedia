{"hands_on_practices": [{"introduction": "Many real-world systems, from aerospace vehicles to magnetic levitation trains, are governed by nonlinear dynamics. This exercise explores the essential technique of linearization, which allows us to approximate a nonlinear system's behavior around a specific operating point with a linear model. By practicing the linearization of a Maglev system, you will develop the foundational skill of deriving a transfer function from physical principles, a crucial first step for applying the vast toolkit of linear control theory to complex, nonlinear applications [@problem_id:1574534].", "problem": "Consider a simplified model of a magnetic levitation (Maglev) system designed to suspend a small ferromagnetic ball of mass $m$. An electromagnet is positioned directly above the ball. The vertical dynamics of the ball are governed by the force of gravity and the magnetic attraction from the electromagnet.\n\nLet $y(t)$ be the size of the air gap between the bottom of the electromagnet and the top of the ball, with the positive $y$ direction defined as downwards. The force of gravity is $F_g = mg$, acting in the positive $y$ direction, where $g$ is the acceleration due to gravity. The magnetic force is an attractive force, acting in the negative $y$ direction (upwards), and is modeled by the equation $F_{mag} = k \\frac{i(t)^2}{y(t)^2}$, where $i(t)$ is the current flowing through the electromagnet's coil and $k$ is a positive physical constant.\n\nThe system is unstable but can be held in equilibrium at a specific air gap $y_0$ by providing a constant current $i_0$. For a control system analysis, we are interested in the behavior of the system for small deviations from this equilibrium point. Let the input to the system be the small deviation in current, $u(t) = i(t) - i_0$, and the output be the corresponding small deviation in the air gap, $Y(t) = y(t) - y_0$.\n\nAssuming these deviations are small, derive the linearized transfer function $G(s) = \\frac{Y(s)}{U(s)}$ for the system. Express your answer in terms of the equilibrium air gap $y_0$, the equilibrium current $i_0$, and the gravitational acceleration $g$.", "solution": "Define the positive $y$ direction downward. The forces on the ball are gravity $F_{g}=mg$ (downward, positive) and magnetic attraction $F_{mag}=k \\frac{i(t)^{2}}{y(t)^{2}}$ (upward, negative in the $y$-positive convention). By Newtonâ€™s second law,\n$$\nm \\ddot{y}(t)=mg-\\frac{k\\,i(t)^{2}}{y(t)^{2}}.\n$$\nAn equilibrium at $(y_{0},i_{0})$ satisfies $\\ddot{y}=0$, hence\n$$\n0=mg-\\frac{k\\,i_{0}^{2}}{y_{0}^{2}}\\quad\\Rightarrow\\quad mg=\\frac{k\\,i_{0}^{2}}{y_{0}^{2}}.\n$$\nLet small deviations be $Y(t)=y(t)-y_{0}$ and $u(t)=i(t)-i_{0}$. Define $f(y,i)=mg-\\frac{k i^{2}}{y^{2}}$. The linearized dynamics about $(y_{0},i_{0})$ are\n$$\nm \\ddot{Y}(t)=\\left.\\frac{\\partial f}{\\partial y}\\right|_{0} Y(t)+\\left.\\frac{\\partial f}{\\partial i}\\right|_{0} u(t),\n$$\nwith\n$$\n\\frac{\\partial f}{\\partial y}=2k\\frac{i^{2}}{y^{3}},\\quad \\frac{\\partial f}{\\partial i}=-2k\\frac{i}{y^{2}}.\n$$\nEvaluating at $(y_{0},i_{0})$ gives\n$$\nm \\ddot{Y}(t)=\\frac{2k i_{0}^{2}}{y_{0}^{3}}\\,Y(t)-\\frac{2k i_{0}}{y_{0}^{2}}\\,u(t).\n$$\nUse the equilibrium relation $mg=\\frac{k i_{0}^{2}}{y_{0}^{2}}$ to eliminate $k/m$:\n$$\n\\frac{k}{m}=\\frac{g y_{0}^{2}}{i_{0}^{2}}.\n$$\nDivide by $m$ to obtain\n$$\n\\ddot{Y}(t)=\\frac{2g}{y_{0}}\\,Y(t)-\\frac{2g}{i_{0}}\\,u(t).\n$$\nTaking Laplace transforms with zero initial conditions,\n$$\ns^{2}Y(s)=\\frac{2g}{y_{0}}\\,Y(s)-\\frac{2g}{i_{0}}\\,U(s),\n$$\nwhich rearranges to\n$$\n\\frac{Y(s)}{U(s)}=\\frac{-\\frac{2g}{i_{0}}}{s^{2}-\\frac{2g}{y_{0}}}.\n$$\nThus, the linearized transfer function expressed in terms of $y_{0}$, $i_{0}$, and $g$ is as above.", "answer": "$$\\boxed{\\frac{-\\frac{2 g}{i_{0}}}{s^{2}-\\frac{2 g}{y_{0}}}}$$", "id": "1574534"}, {"introduction": "Effective control is critical in high-performance technology, such as managing the thermal dynamics of a computer processor to prevent overheating. This problem moves into the realm of state-space control, where we design a controller to directly influence the system's internal states. You will implement a Proportional-Derivative (PD) controller and use the pole placement technique to achieve a desired thermal response, providing a direct link between controller gains and system performance [@problem_id:1574529].", "problem": "To prevent thermal throttling in a high-performance computer processor, an active cooling system is employed. The thermal dynamics of a processing core (node 1) and its adjacent silicon region (node 2) can be simplified using a two-node lumped-parameter model. The evolution of the temperature deviations from a steady-state operating point, $\\delta T_1(t)$ for the core and $\\delta T_2(t)$ for the surrounding region, are governed by the following linearized differential equations:\n\n$$\nC_1 \\frac{d(\\delta T_1)}{dt} = k(\\delta T_2 - \\delta T_1) - k_{amb}\\delta T_1 - \\delta u(t)\n$$\n$$\nC_2 \\frac{d(\\delta T_2)}{dt} = k(\\delta T_1 - \\delta T_2) - k_{amb}\\delta T_2\n$$\n\nHere, $C_1$ and $C_2$ are the thermal capacitances of the core and the surrounding region, respectively. The parameter $k$ represents the thermal conductance between the two nodes, and $k_{amb}$ is the thermal conductance from each node to the ambient environment (i.e., the heat sink). The term $\\delta u(t)$ is the deviation in the rate of heat energy removal from the core, provided by a Thermoelectric Cooler (TEC).\n\nA Proportional-Derivative (PD) controller adjusts the heat removal rate based on the core's temperature deviation. The control law for the heat removal deviation is given by:\n\n$$\n\\delta u(t) = K_p \\delta T_1(t) + K_d \\frac{d(\\delta T_1)}{dt}\n$$\n\nwhere $K_p$ and $K_d$ are the proportional and derivative gains, respectively.\n\nThe system parameters are provided as:\n- Core thermal capacitance, $C_1 = 0.5 \\text{ J/K}$\n- Surrounding region thermal capacitance, $C_2 = 2.0 \\text{ J/K}$\n- Inter-node thermal conductance, $k = 2.5 \\text{ W/K}$\n- Ambient thermal conductance, $k_{amb} = 0.5 \\text{ W/K}$\n- Derivative gain, $K_d = 1.0 \\text{ W}\\cdot\\text{s/K}$\n\nTo achieve a desired transient response, one of the poles of the closed-loop system must be placed at $s = -5.0 \\text{ rad/s}$. Calculate the required value for the proportional gain $K_p$. Express your answer in W/K, rounded to three significant figures.", "solution": "Let $x_{1}(t)=\\delta T_{1}(t)$ and $x_{2}(t)=\\delta T_{2}(t)$. With the PD control law $\\delta u(t)=K_{p}x_{1}(t)+K_{d}\\dot{x}_{1}(t)$ substituted into the first thermal balance, we obtain\n$$\nC_{1}\\dot{x}_{1}=k(x_{2}-x_{1})-k_{amb}x_{1}-K_{p}x_{1}-K_{d}\\dot{x}_{1}.\n$$\nRearranging gives\n$$\n(C_{1}+K_{d})\\dot{x}_{1}=k x_{2}-(k+k_{amb}+K_{p})x_{1}.\n$$\nThe second equation is\n$$\nC_{2}\\dot{x}_{2}=k(x_{1}-x_{2})-k_{amb}x_{2}.\n$$\nTherefore, the closed-loop state-space model $\\dot{x}=Ax$ has\n$$\nA=\\begin{pmatrix}\n-\\dfrac{k+k_{amb}+K_{p}}{C_{1}+K_{d}} & \\dfrac{k}{C_{1}+K_{d}}\\\\\n\\dfrac{k}{C_{2}} & -\\dfrac{k+k_{amb}}{C_{2}}\n\\end{pmatrix}.\n$$\nThe characteristic polynomial is\n$$\np(s)=\\det(sI-A)=s^{2}-(\\operatorname{tr}A)s+\\det A,\n$$\nwith\n$$\n\\operatorname{tr}A=-\\dfrac{k+k_{amb}+K_{p}}{C_{1}+K_{d}}-\\dfrac{k+k_{amb}}{C_{2}},\n\\quad\n\\det A=\\left(-\\dfrac{k+k_{amb}+K_{p}}{C_{1}+K_{d}}\\right)\\left(-\\dfrac{k+k_{amb}}{C_{2}}\\right)-\\dfrac{k}{C_{1}+K_{d}}\\cdot\\dfrac{k}{C_{2}}.\n$$\nTo place a pole at $s=-5$, enforce $p(-5)=0$, i.e.,\n$$\n25+5\\,\\operatorname{tr}A+\\det A=0.\n$$\nWith the given numerical parameters $C_{1}=0.5$, $C_{2}=2.0$, $k=2.5$, $k_{amb}=0.5$, $K_{d}=1.0$, compute the matrix entries as functions of $K_{p}$:\n$$\na_{11}=-\\dfrac{k+k_{amb}+K_{p}}{C_{1}+K_{d}}=-\\dfrac{3.0+K_{p}}{1.5}=-2-\\dfrac{2}{3}K_{p},\\quad\na_{12}=\\dfrac{k}{C_{1}+K_{d}}=\\dfrac{2.5}{1.5}=\\dfrac{5}{3},\n$$\n$$\na_{21}=\\dfrac{k}{C_{2}}=\\dfrac{2.5}{2.0}=\\dfrac{5}{4},\\quad\na_{22}=-\\dfrac{k+k_{amb}}{C_{2}}=-\\dfrac{3.0}{2.0}=-\\dfrac{3}{2}.\n$$\nThus\n$$\n\\operatorname{tr}A=a_{11}+a_{22}=-\\dfrac{7}{2}-\\dfrac{2}{3}K_{p},\\qquad\n\\det A=a_{11}a_{22}-a_{12}a_{21}=(3+K_{p})-\\dfrac{25}{12}=K_{p}+\\dfrac{11}{12}.\n$$\nImpose $25+5\\,\\operatorname{tr}A+\\det A=0$:\n$$\n25+5\\left(-\\dfrac{7}{2}-\\dfrac{2}{3}K_{p}\\right)+\\left(K_{p}+\\dfrac{11}{12}\\right)=0,\n$$\n$$\n25-\\dfrac{35}{2}-\\dfrac{10}{3}K_{p}+K_{p}+\\dfrac{11}{12}=0,\n$$\n$$\n\\dfrac{101}{12}-\\dfrac{7}{3}K_{p}=0\\quad\\Rightarrow\\quad K_{p}=\\dfrac{101}{28}.\n$$\nNumerically, $K_{p}\\approx 3.607142857$, which to three significant figures is $3.61$ in units of W/K.", "answer": "$$\\boxed{3.61}$$", "id": "1574529"}, {"introduction": "A common challenge in control engineering is that not all state variables of a system are accessible for measurement. This exercise tackles this issue by introducing the concept of a state observer for a multi-zone HVAC system. You will learn to design a Luenberger observer, which uses the available measurements and a system model to estimate the unmeasured states, a fundamental technique that enables the implementation of full-state feedback control even with limited sensor data [@problem_id:1574548].", "problem": "Consider a simplified thermal model for a building with two zones, managed by a Heating, Ventilation, and Air Conditioning (HVAC) system. Zone 1 is a server room with significant internal heat generation, and Zone 2 is an adjacent office space. The system's thermal dynamics are described by the following coupled linear differential equations, where all temperatures are measured in kelvin (K), time in seconds (s), energy in joules (J), and power in watts (W):\n\n$C_1 \\frac{dT_1}{dt} = -K_{1a}(T_1 - T_a) - K_{12}(T_1 - T_2) - \\alpha(T_1 - T_a) + u_1(t)$\n$C_2 \\frac{dT_2}{dt} = -K_{2a}(T_2 - T_a) + K_{12}(T_1 - T_2) + \\alpha(T_1 - T_2)$\n\nHere, $T_1(t)$ and $T_2(t)$ are the temperatures of Zone 1 and Zone 2, respectively. $T_a$ is the constant ambient outside temperature. The control input $u_1(t)$ represents the net heat rate added to Zone 1 by the HVAC system and internal electronic equipment. The parameters of the system are given as:\n- Thermal capacitance of Zone 1: $C_1 = 1.0 \\times 10^5 \\text{ J/K}$\n- Thermal capacitance of Zone 2: $C_2 = 1.75 \\times 10^5 \\text{ J/K}$\n- Thermal conductance to ambient for Zone 1: $K_{1a} = 150 \\text{ W/K}$\n- Thermal conductance to ambient for Zone 2: $K_{2a} = 175 \\text{ W/K}$\n- Thermal conductance between zones: $K_{12} = 200 \\text{ W/K}$\n- Advective heat transfer coefficient due to one-way airflow from Zone 1 to Zone 2: $\\alpha = 150 \\text{ W/K}$\n\nThe system is to be controlled based on state feedback, but a sensor is only available to measure the temperature in Zone 2. A Luenberger observer is designed to estimate the temperatures in both zones. Let the state variables be the temperature deviations from ambient: $x_1 = T_1 - T_a$ and $x_2 = T_2 - T_a$. The state-space representation is $\\dot{\\mathbf{x}} = A\\mathbf{x} + B u_1(t)$, with the measurement being $y = x_2$.\n\nYour task is to determine the observer gain vector $L = \\begin{pmatrix} L_1 \\\\ L_2 \\end{pmatrix}$ for a full-state observer with dynamics $\\dot{\\hat{\\mathbf{x}}} = A\\hat{\\mathbf{x}} + B u_1(t) + L(y - \\hat{y})$. The observer is to be designed such that the eigenvalues (poles) of the observer error dynamics are placed at $-0.010 \\text{ s}^{-1}$ and $-0.012 \\text{ s}^{-1}$.\n\nExpress the components of the gain vector $L$ as a row matrix $\\begin{pmatrix} L_1 & L_2 \\end{pmatrix}$, with values given in units of $\\text{s}^{-1}$.", "solution": "Define the deviation states $x_{1} = T_{1} - T_{a}$ and $x_{2} = T_{2} - T_{a}$. Since $T_{a}$ is constant, $\\dot{x}_{i} = \\dot{T}_{i}$. Rewrite the given dynamics in terms of $x_{1},x_{2}$:\n$$\nC_{1}\\dot{x}_{1} = -(K_{1a}+\\alpha)x_{1} - K_{12}(x_{1}-x_{2}) + u_{1}\n= -(K_{1a}+K_{12}+\\alpha)x_{1} + K_{12}x_{2} + u_{1},\n$$\n$$\nC_{2}\\dot{x}_{2} = -K_{2a}x_{2} + (K_{12}+\\alpha)(x_{1}-x_{2})\n= (K_{12}+\\alpha)x_{1} - (K_{2a}+K_{12}+\\alpha)x_{2}.\n$$\nThus the state-space model $\\dot{\\mathbf{x}} = A\\mathbf{x} + B u_{1}$ with $y = x_{2}$ has\n$$\nA = \\begin{pmatrix}\n-\\dfrac{K_{1a}+K_{12}+\\alpha}{C_{1}} & \\dfrac{K_{12}}{C_{1}}\\\\\n\\dfrac{K_{12}+\\alpha}{C_{2}} & -\\dfrac{K_{2a}+K_{12}+\\alpha}{C_{2}}\n\\end{pmatrix},\\quad\nB = \\begin{pmatrix} \\dfrac{1}{C_{1}} \\\\ 0 \\end{pmatrix},\\quad\nC = \\begin{pmatrix} 0 & 1 \\end{pmatrix}.\n$$\nWith the observer $\\dot{\\hat{\\mathbf{x}}} = A\\hat{\\mathbf{x}} + Bu_{1} + L(y-\\hat{y})$, the error $\\mathbf{e} = \\mathbf{x}-\\hat{\\mathbf{x}}$ evolves as\n$$\n\\dot{\\mathbf{e}} = (A - L C)\\mathbf{e},\\quad L = \\begin{pmatrix} L_{1} \\\\ L_{2} \\end{pmatrix}.\n$$\nSince $LC = \\begin{pmatrix} 0 & L_{1} \\\\ 0 & L_{2} \\end{pmatrix}$, we have\n$$\nA - LC = \\begin{pmatrix}\na_{11} & a_{12} - L_{1}\\\\\na_{21} & a_{22} - L_{2}\n\\end{pmatrix},\\quad\n\\text{where } a_{11} = -\\dfrac{K_{1a}+K_{12}+\\alpha}{C_{1}},\\; a_{12} = \\dfrac{K_{12}}{C_{1}},\\; a_{21} = \\dfrac{K_{12}+\\alpha}{C_{2}},\\; a_{22} = -\\dfrac{K_{2a}+K_{12}+\\alpha}{C_{2}}.\n$$\nThe characteristic polynomial is\n$$\np(\\lambda) = \\det\\!\\big(\\lambda I - (A - LC)\\big)\n= \\lambda^{2} - \\lambda\\big(a_{11}+a_{22}-L_{2}\\big) + \\big(a_{11}(a_{22}-L_{2}) - a_{21}(a_{12}-L_{1})\\big).\n$$\nWe desire poles at $-0.010$ and $-0.012$, so the desired polynomial is\n$$\np_{d}(\\lambda) = (\\lambda+0.010)(\\lambda+0.012) = \\lambda^{2} + 0.022\\,\\lambda + 0.00012.\n$$\nMatching coefficients gives\n$$\na_{11}+a_{22}-L_{2} = -0.022,\\quad\na_{11}(a_{22}-L_{2}) - a_{21}(a_{12}-L_{1}) = 0.00012.\n$$\nCompute the entries of $A$ using the given parameters:\n$$\na_{11} = -\\dfrac{150+200+150}{1.0\\times 10^{5}} = -0.005,\\quad\na_{12} = \\dfrac{200}{1.0\\times 10^{5}} = 0.002,\n$$\n$$\na_{21} = \\dfrac{200+150}{1.75\\times 10^{5}} = \\dfrac{350}{175000} = 0.002,\\quad\na_{22} = -\\dfrac{175+200+150}{1.75\\times 10^{5}} = -\\dfrac{525}{175000} = -0.003.\n$$\nFirst, from the trace condition,\n$$\nL_{2} = a_{11}+a_{22}+0.022 = (-0.005) + (-0.003) + 0.022 = 0.014.\n$$\nNext, from the constant term condition, write\n$$\n0.00012 = \\big(a_{11}a_{22} - a_{21}a_{12}\\big) - a_{11}L_{2} + a_{21}L_{1}.\n$$\nCompute\n$$\na_{11}a_{22} - a_{21}a_{12} = (-0.005)(-0.003) - (0.002)(0.002) = 0.000015 - 0.000004 = 0.000011,\n$$\n$$\n-a_{11}L_{2} = -(-0.005)(0.014) = 0.00007.\n$$\nThus\n$$\n0.00012 = 0.000011 + 0.00007 + a_{21}L_{1} \\;\\Rightarrow\\; a_{21}L_{1} = 0.00012 - 0.000081 = 0.000039,\n$$\n$$\nL_{1} = \\dfrac{0.000039}{0.002} = 0.0195.\n$$\nTherefore,\n$$\nL = \\begin{pmatrix} 0.0195 \\\\ 0.014 \\end{pmatrix},\n$$\nwhich yields observer error dynamics with eigenvalues at the desired locations. A quick check: $\\operatorname{tr}(A-LC) = a_{11}+a_{22}-L_{2} = -0.022$ and $\\det(A-LC) = 0.00012$, matching the target polynomial $\\lambda^{2} + 0.022\\lambda + 0.00012$.", "answer": "$$\\boxed{\\begin{pmatrix} 0.0195 & 0.014 \\end{pmatrix}}$$", "id": "1574548"}]}