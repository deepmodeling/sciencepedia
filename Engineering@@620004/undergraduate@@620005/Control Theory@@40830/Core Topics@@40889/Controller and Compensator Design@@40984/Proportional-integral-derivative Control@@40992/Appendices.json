{"hands_on_practices": [{"introduction": "Tuning a PID controller is both a science and an art, often requiring an intuitive understanding of how each gain affects the system's behavior. This first practice invites you to step into the role of a control engineer diagnosing a real-world system. By analyzing the response of a quadcopter drone, you will learn to connect observed behaviors like oscillations and steady-state error to the specific roles of the proportional ($K_p$), integral ($K_i$), and derivative ($K_d$) gains, a crucial skill for effective manual tuning [@problem_id:1603249].", "problem": "An engineering student is tasked with designing a Proportional-Integral-Derivative (PID) controller to maintain the altitude of a small quadcopter drone. The controller adjusts motor thrust based on the error between the desired setpoint altitude and the altitude measured by an onboard sensor.\n\nThe student follows a common tuning procedure:\n1.  Initially, only the proportional term (P-controller) with gain $K_p$ is enabled. The student observes that when commanded to a new altitude, the drone flies towards it but stabilizes at an altitude slightly below the setpoint, exhibiting a steady-state error.\n2.  Next, the student enables the integral term (PI-controller) with gain $K_i$ to eliminate the steady-state error. Now, the drone successfully reaches the setpoint altitude. However, the response is somewhat oscillatory, overshooting the target and settling after a few oscillations.\n3.  In an attempt to make the response faster and more aggressive, the student significantly increases one of the controller gains. After this change, a test is performed by giving the drone a small downward push from its stable hover. The drone now responds by oscillating indefinitely about the target altitude with a constant amplitude and a fixed period. This behavior indicates the system has become marginally stable.\n\nBased on this final observation, which of the following is the most likely cause of the sustained oscillations?\n\nA. The proportional gain ($K_p$) is too high.\n\nB. The integral gain ($K_i$) is too high.\n\nC. The derivative gain ($K_d$) is too high.\n\nD. The drone's motors do not have enough power to stabilize it.\n\nE. The proportional gain ($K_p$) is too low.", "solution": "We consider the drone altitude dynamics linearized about hover. Let the vertical position be $z(t)$ and the control input (incremental thrust about hover) be $u(t)$. Around hover, a standard small-signal model is\n$$\nm \\ddot{z}(t) + b \\dot{z}(t) = u(t),\n$$\nwhere $m$ is the mass and $b$ represents viscous damping/aerodynamic drag and actuator drag. Taking Laplace transforms with zero initial conditions gives the plant transfer function\n$$\nG(s) = \\frac{Z(s)}{U(s)} = \\frac{1}{m s^{2} + b s}.\n$$\nA PID controller is\n$$\nC(s) = K_{p} + \\frac{K_{i}}{s} + K_{d} s,\n$$\nacting on the error $e(t) = z_{\\text{ref}}(t) - z(t)$ so that $U(s) = C(s) E(s)$ and $E(s) = Z_{\\text{ref}}(s) - Z(s)$. The closed-loop characteristic equation under unity feedback is\n$$\n1 + C(s) G(s) = 0 \\quad \\Longleftrightarrow \\quad 1 + \\frac{K_{p} + \\frac{K_{i}}{s} + K_{d} s}{m s^{2} + b s} = 0.\n$$\nMultiplying by $m s^{2} + b s$ and then by $s$ to clear denominators yields the cubic characteristic polynomial\n$$\nm s^{3} + (b + K_{d}) s^{2} + K_{p} s + K_{i} = 0.\n$$\nLet $a_{3} = m$, $a_{2} = b + K_{d}$, $a_{1} = K_{p}$, $a_{0} = K_{i}$. The Routh-Hurwitz stability condition for a cubic $a_{3} s^{3} + a_{2} s^{2} + a_{1} s + a_{0} = 0$ is\n$$\na_{3} > 0,\\quad a_{2} > 0,\\quad a_{1} > 0,\\quad a_{0} > 0,\\quad \\text{and} \\quad a_{2} a_{1} > a_{3} a_{0}.\n$$\nIn terms of gains, with positive $m$ and $b$, stability requires\n$$\nK_{p} > 0,\\quad K_{i} > 0,\\quad K_{d} > -b,\\quad \\text{and} \\quad (b + K_{d}) K_{p} > m K_{i}.\n$$\nMarginal stability with sustained oscillations (constant-amplitude sinusoid) occurs at the boundary where the $s^{1}$-row of the Routh table becomes zero, i.e.,\n$$\n(b + K_{d}) K_{p} = m K_{i},\n$$\nwhich produces a pair of purely imaginary closed-loop poles. The associated auxiliary equation from the $s^{2}$-row, $(b + K_{d}) s^{2} + K_{i} = 0$, shows the oscillation frequency\n$$\n\\omega = \\sqrt{\\frac{K_{i}}{b + K_{d}}}.\n$$\nInterpreting the observed behavior: with only proportional action, the steady-state error under a constant disturbance (gravity offset about hover) is expected because a P-controller cannot remove constant disturbances; adding integral action eliminates this error, but integral action typically reduces phase margin and introduces overshoot and oscillations as observed. The final test shows that after making the controller “faster and more aggressive” by significantly increasing one gain, a small perturbation leads to sustained oscillations of constant amplitude and fixed period, i.e., the closed loop is on the verge of instability (marginally stable).\n\nFrom classical control and the Nyquist/root-locus viewpoint, increasing the proportional gain $K_{p}$ increases loop gain, reduces phase margin, and, at a critical “ultimate gain” $K_{u}$, produces sustained oscillations with a well-defined period. This is precisely the Ziegler-Nichols ultimate gain test: with other terms not dominant in phase lead, excessive $K_{p}$ drives the Nyquist locus to the $-1$ point, yielding a closed-loop pole pair on the imaginary axis and constant-amplitude oscillations after a small disturbance. In contrast, a large derivative gain $K_{d}$ adds phase lead and usually increases damping, opposing such oscillations; while an excessively large integral gain $K_{i}$ can destabilize a PI loop, the student’s stated intent “to make the response faster and more aggressive” is most consistently achieved (and commonly attempted) by increasing $K_{p}$, which is the standard cause of entering the marginally stable, sustained-oscillation regime. Insufficient motor power would not create small-signal sustained oscillations; it would limit achievable acceleration/altitude, not place poles on the imaginary axis. A low $K_{p}$ would yield sluggish, undercorrected behavior, not sustained oscillation.\n\nTherefore, the most likely cause of the sustained oscillations after the aggressive retuning is that the proportional gain $K_{p}$ was increased too much, driving the loop to its ultimate gain and marginal stability.", "answer": "$$\\boxed{A}$$", "id": "1603249"}, {"introduction": "While intuition is invaluable, a robust controller design relies on quantitative analysis. This exercise transitions from qualitative observation to a precise calculation of controller performance, focusing on a critical metric: steady-state error [@problem_id:1603305]. By analyzing a P-controlled motor subject to a constant load, you will apply the Final Value Theorem to analytically prove why proportional control alone often results in a persistent error, providing the mathematical justification for adding integral action.", "problem": "A precision positioning system for an optical microscope uses a Direct Current (DC) motor to move a specimen stage. The system is designed to hold the stage at a fixed reference position. The relationship between the torque applied by the motor and the resulting angular position of the motor shaft is modeled by the transfer function $G(s) = \\frac{K}{s(\\tau s + 1)}$, where $s$ is the complex frequency variable, $K$ is the motor's velocity constant, and $\\tau$ is its mechanical time constant.\n\nA proportional controller with gain $K_p$, represented by $C(s) = K_p$, is implemented in a unity negative feedback loop to regulate the motor's position. The controller's output is a torque command given to the motor.\n\nDuring operation, it is discovered that the entire assembly is on a slight, unintended incline. This results in a constant gravitational load that exerts an effective disturbance torque of magnitude $T_d$ on the motor shaft. This disturbance is modeled as being summed with the torque command from the controller.\n\nAssuming the closed-loop system is stable and all parameters ($K, \\tau, K_p, T_d$) are positive constants, determine the steady-state error in the angular position of the motor shaft caused by this constant disturbance torque. Your answer should be a symbolic expression in terms of the given parameters.", "solution": "Let $R(s)$ be the Laplace transform of the reference position, $Y(s)$ be the Laplace transform of the actual motor position, and $E(s) = R(s) - Y(s)$ be the Laplace transform of the error. The system is set up in a unity negative feedback configuration. The controller is $C(s) = K_p$ and the plant is $G(s) = \\frac{K}{s(\\tau s + 1)}$.\n\nThe problem states there is a disturbance torque, $D(s)$, added to the controller's output. The total torque input to the plant is the sum of the controller's output, $U_c(s)$, and the disturbance torque, $D(s)$.\nThe controller output is related to the error by $U_c(s) = C(s)E(s)$.\nThe plant's output is related to the total input torque by $Y(s) = G(s)[U_c(s) + D(s)]$.\n\nSubstituting the expression for $U_c(s)$, we get:\n$$Y(s) = G(s)[C(s)E(s) + D(s)]$$\nNow, substitute the definition of the error, $E(s) = R(s) - Y(s)$:\n$$Y(s) = G(s)[C(s)(R(s) - Y(s)) + D(s)]$$\nWe want to find the error caused by the disturbance. To isolate this effect, we can set the reference input to zero, $R(s) = 0$. This is because the system is linear, and we can use superposition. When $R(s)=0$, the error is $E(s) = 0 - Y(s) = -Y(s)$. The equation becomes:\n$$Y(s) = G(s)[-C(s)Y(s) + D(s)]$$\nWe can now solve for $Y(s)$ in terms of $D(s)$:\n$$Y(s) = -G(s)C(s)Y(s) + G(s)D(s)$$\n$$Y(s) + G(s)C(s)Y(s) = G(s)D(s)$$\n$$Y(s)[1 + G(s)C(s)] = G(s)D(s)$$\n$$Y(s) = \\frac{G(s)}{1 + G(s)C(s)} D(s)$$\nThe error due to the disturbance is $E_d(s) = -Y(s)$:\n$$E_d(s) = -\\frac{G(s)}{1 + G(s)C(s)} D(s)$$\nThe problem states that the disturbance is a constant torque of magnitude $T_d$. In the Laplace domain, a constant (or step function) of magnitude $T_d$ is represented as $D(s) = \\frac{T_d}{s}$.\nSubstituting this into the error expression:\n$$E_d(s) = -\\frac{G(s)}{1 + G(s)C(s)} \\frac{T_d}{s}$$\nTo find the steady-state error, $e_{ss}$, we use the Final Value Theorem (FVT), which states that $e_{ss} = \\lim_{t \\to \\infty} e(t) = \\lim_{s \\to 0} s E_d(s)$. The FVT is applicable because the problem states the closed-loop system is stable. (The poles of the closed-loop system are the roots of the characteristic equation $1 + G(s)C(s) = 0$, which is $1 + \\frac{K_p K}{s(\\tau s + 1)} = 0 \\implies \\tau s^2 + s + K_p K = 0$. Since $\\tau, K_p, K$ are all positive, the roots have negative real parts, confirming stability).\n\nApplying the FVT:\n$$e_{ss} = \\lim_{s \\to 0} s E_d(s) = \\lim_{s \\to 0} s \\left( -\\frac{G(s)}{1 + G(s)C(s)} \\frac{T_d}{s} \\right)$$\n$$e_{ss} = -T_d \\lim_{s \\to 0} \\frac{G(s)}{1 + G(s)C(s)}$$\nNow, we substitute the expressions for $G(s)$ and $C(s)$:\n$$e_{ss} = -T_d \\lim_{s \\to 0} \\frac{\\frac{K}{s(\\tau s + 1)}}{1 + K_p \\frac{K}{s(\\tau s + 1)}}$$\nTo simplify the fraction, we multiply the numerator and denominator by $s(\\tau s + 1)$:\n$$e_{ss} = -T_d \\lim_{s \\to 0} \\frac{K}{s(\\tau s + 1) + K_p K}$$\nNow we can evaluate the limit by substituting $s=0$:\n$$e_{ss} = -T_d \\frac{K}{0(\\tau \\cdot 0 + 1) + K_p K}$$\n$$e_{ss} = -T_d \\frac{K}{0 + K_p K}$$\n$$e_{ss} = -T_d \\frac{K}{K_p K}$$\nAssuming $K \\neq 0$, it cancels out:\n$$e_{ss} = -\\frac{T_d}{K_p}$$\nThis is the steady-state error in the angular position due to the constant disturbance torque.", "answer": "$$\\boxed{-\\frac{T_d}{K_p}}$$", "id": "1603305"}, {"introduction": "Having diagnosed controller behavior and quantified its limitations, the final step is to learn a systematic design method that moves beyond trial-and-error. This practice introduces the Lambda tuning method, a powerful technique that allows you to specify the desired closed-loop behavior and then derive the exact controller parameters to achieve it [@problem_id:1603268]. By working through this problem, you will learn how to translate a high-level performance goal, such as a desired response time constant $\\lambda$, into the precise proportional gain $K_c$ and integral time $\\tau_I$ for a PI controller.", "problem": "A continuous-flow microfluidic bioreactor is used to culture microorganisms. The concentration of a key nutrient in the reactor is regulated by a feedback control system. The process dynamics, relating the nutrient feed rate (manipulated variable) to the nutrient concentration (process variable), can be accurately modeled by a first-order transfer function:\n$$G_p(s) = \\frac{K_p}{\\tau_p s + 1}$$\nwhere $K_p$ is the process gain and $\\tau_p$ is the process time constant.\n\nA Proportional-Integral (PI) controller is used to maintain the nutrient concentration at a desired setpoint. The controller has the transfer function:\n$$G_c(s) = K_c \\left(1 + \\frac{1}{\\tau_I s}\\right)$$\nwhere $K_c$ is the proportional gain and $\\tau_I$ is the integral time.\n\nThe goal is to tune the PI controller using the Lambda tuning method. This method aims to make the closed-loop system response (from setpoint to process variable) behave like an ideal first-order system with a specified time constant $\\lambda$, which dictates the desired speed of response. Assume a standard negative feedback configuration.\n\nDetermine the analytical expressions for the pair of controller parameters $(K_c, \\tau_I)$ in terms of the process parameters $K_p$, $\\tau_p$, and the desired closed-loop time constant $\\lambda$.", "solution": "The plant and controller transfer functions are given by\n$$G_{p}(s)=\\frac{K_{p}}{\\tau_{p} s+1}, \\qquad G_{c}(s)=K_{c}\\left(1+\\frac{1}{\\tau_{I} s}\\right).$$\nFor standard negative feedback, the closed-loop transfer function from setpoint $R$ to output $Y$ is\n$$\\frac{Y(s)}{R(s)}=\\frac{G_{c}(s)G_{p}(s)}{1+G_{c}(s)G_{p}(s)}.$$\nLambda tuning requires the closed-loop response to match an ideal first-order model with time constant $\\lambda$:\n$$\\frac{Y(s)}{R(s)}=\\frac{1}{\\lambda s+1}.$$\nEquating these and solving for $G_{c}(s)$ yields\n$$\\frac{G_{c}(s)G_{p}(s)}{1+G_{c}(s)G_{p}(s)}=\\frac{1}{\\lambda s+1}\n\\;\\;\\Longrightarrow\\;\\; G_{c}(s)G_{p}(s)\\big(\\lambda s+1\\big)=1+G_{c}(s)G_{p}(s)\n\\;\\;\\Longrightarrow\\;\\; G_{c}(s)G_{p}(s)\\lambda s=1.$$\nHence\n$$G_{c}(s)=\\frac{1}{G_{p}(s)\\lambda s}=\\frac{\\tau_{p} s+1}{K_{p}\\lambda s}.$$\nExpress the PI controller in a comparable form:\n$$G_{c}(s)=K_{c}\\left(1+\\frac{1}{\\tau_{I} s}\\right)=K_{c}\\frac{\\tau_{I} s+1}{\\tau_{I} s}=\\frac{K_{c}}{\\tau_{I}}\\frac{\\tau_{I} s+1}{s}.$$\nMatch coefficients in\n$$\\frac{K_{c}}{\\tau_{I}}\\big(\\tau_{I} s+1\\big)=\\frac{1}{K_{p}\\lambda}\\big(\\tau_{p} s+1\\big).$$\nFrom the $s$-coefficient:\n$$K_{c}=\\frac{\\tau_{p}}{K_{p}\\lambda}.$$\nFrom the constant term:\n$$\\frac{K_{c}}{\\tau_{I}}=\\frac{1}{K_{p}\\lambda}\\;\\;\\Longrightarrow\\;\\;\\tau_{I}=\\tau_{p}.$$\nThus the Lambda tuning for a first-order plant without dead time gives\n$$K_{c}=\\frac{\\tau_{p}}{K_{p}\\lambda}, \\qquad \\tau_{I}=\\tau_{p}.$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\tau_{p}}{K_{p}\\lambda} & \\tau_{p}\\end{pmatrix}}$$", "id": "1603268"}]}