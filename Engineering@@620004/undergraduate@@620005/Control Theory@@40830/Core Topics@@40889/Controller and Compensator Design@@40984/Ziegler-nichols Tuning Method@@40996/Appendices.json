{"hands_on_practices": [{"introduction": "The Ziegler-Nichols ultimate sensitivity method is fundamentally an experimental procedure, but its core principles are rooted in the mathematical theory of stability. This first practice bridges that gap by demonstrating how to determine the key tuning parameters, the ultimate gain $K_u$ and ultimate period $T_u$, directly from a system's transfer function. By applying the Routh-Hurwitz stability criterion, we can analytically find the precise conditions under which a system becomes marginally stable, providing a theoretical foundation for the values one would seek to find experimentally [@problem_id:1622381].", "problem": "A control engineer is tasked with tuning a feedback controller for a high-precision manufacturing system. The system's dynamics, including the sensor and actuator, can be effectively modeled by the plant transfer function $G_p(s) = \\frac{1}{(s+1)(s+3)(s+5)}$. The engineer decides to employ a simple proportional controller, $G_c(s) = K_p$, as a first step in the tuning process using the Ziegler-Nichols ultimate sensitivity method. This method involves increasing the proportional gain $K_p$ from zero until the closed-loop system becomes marginally stable, exhibiting sustained oscillations. The gain at this point is called the ultimate gain, $K_u$, and the period of the oscillations is the ultimate period, $T_u$.\n\nAssuming the system is configured with standard negative unity feedback, determine the ultimate period $T_u$ for this system. The complex frequency variable $s$ has units of inverse seconds. Express your answer in seconds, rounded to three significant figures.", "solution": "For unity negative feedback with proportional control $G_{c}(s)=K_{p}$ and plant $G_{p}(s)=\\frac{1}{(s+1)(s+3)(s+5)}$, the closed-loop characteristic equation is\n$$\n1+K_{p}G_{p}(s)=0 \\;\\;\\Longleftrightarrow\\;\\; (s+1)(s+3)(s+5)+K_{p}=0.\n$$\nExpanding,\n$$\n(s+1)(s+3)=s^{2}+4s+3,\\quad (s^{2}+4s+3)(s+5)=s^{3}+9s^{2}+23s+15,\n$$\nso the characteristic polynomial is\n$$\np(s)=s^{3}+9s^{2}+23s+(15+K_{p}).\n$$\nUsing the Routh-Hurwitz array for $s^{3}+a_{1}s^{2}+a_{2}s+a_{3}$ with $a_{1}=9$, $a_{2}=23$, $a_{3}=15+K_{p}$:\n- Row $s^{3}$: $1\\;\\; 23$\n- Row $s^{2}$: $9\\;\\; 15+K_{p}$\n- Row $s^{1}$: $\\displaystyle \\frac{9\\cdot 23-(15+K_{p})}{9}=\\frac{192-K_{p}}{9}\\;\\; 0$\n- Row $s^{0}$: $15+K_{p}$\n\nMarginal stability (sustained oscillations) occurs when the element in the $s^{1}$ row becomes zero:\n$$\n\\frac{192-K_{p}}{9}=0 \\;\\;\\Longrightarrow\\;\\; K_{p}=192.\n$$\nAt this value, the auxiliary equation is formed from the $s^{2}$ row:\n$$\n9s^{2}+(15+K_{p})=0 \\;\\;\\Longrightarrow\\;\\; 9s^{2}+207=0 \\;\\;\\Longrightarrow\\;\\; s^{2}=-23.\n$$\nThus the imaginary-axis roots are at $s=\\pm j\\omega_{u}$ with\n$$\n\\omega_{u}=\\sqrt{23}.\n$$\nThe ultimate period is\n$$\nT_{u}=\\frac{2\\pi}{\\omega_{u}}=\\frac{2\\pi}{\\sqrt{23}}.\n$$\nNumerically,\n$$\nT_{u}=\\frac{2\\pi}{\\sqrt{23}}\\approx 1.30975\\;\\text{ s},\n$$\nwhich rounded to three significant figures is $1.31$ s.", "answer": "$$\\boxed{1.31}$$", "id": "1622381"}, {"introduction": "In real-world engineering, we often work with simplified models of complex systems. The Ziegler-Nichols open-loop (or reaction curve) method is a prime example of this, typically approximating a process with a First-Order-Plus-Dead-Time (FOPDT) model. This exercise explores the practical consequences of such an approximation, questioning what happens when a controller tuned for a simple model is applied to the more complex reality [@problem_id:1622321]. This practice provides valuable insight into the robustness of tuning methods and how modeling choices can lead to more conservative and stable designs.", "problem": "A chemical process is known to be accurately described by a Second-Order-Plus-Dead-Time (SOPDT) model with the transfer function:\n$$G_p(s) = \\frac{K_p}{(T_1 s + 1)(T_2 s + 1)} e^{-L_p s}$$\nwhere $K_p$ is the process gain, $T_1$ and $T_2$ are the time constants (with $T_1 > T_2$), and $L_p$ is the process dead time.\n\nFor the purpose of controller design, a control engineer approximates this process using a First-Order-Plus-Dead-Time (FOPDT) model:\n$$G_m(s) = \\frac{K_m}{T_m s + 1} e^{-L_m s}$$\nThe engineer derives the FOPDT parameters by setting $K_m = K_p$, $T_m = T_1$, and lumping the smaller time constant $T_2$ into the dead time, such that the model's dead time is $L_m = L_p + T_2$.\n\nThe engineer then designs a Proportional-Integral (PI) controller, $G_c(s) = K_c \\left(1 + \\frac{1}{T_i s}\\right)$, using the Ziegler-Nichols (Z-N) first method (the open-loop method). The tuning rules for a PI controller based on the FOPDT model parameters ($K_m, T_m, L_m$) are:\n- Proportional Gain: $K_c = \\frac{0.9 T_m}{K_m L_m}$\n- Integral Time: $T_i = \\frac{L_m}{0.3}$\n\nThis PI controller, designed using the approximate model $G_m(s)$, is then implemented on the actual process $G_p(s)$. Based on a qualitative analysis of the model-process mismatch, which of the following statements most accurately describes the expected performance of the actual closed-loop system compared to the performance predicted by the FOPDT model?\n\nA. The actual closed-loop system will be more stable than predicted by the model, exhibiting a larger phase margin.\n\nB. The actual closed-loop system will be less stable than predicted by the model, exhibiting a smaller phase margin.\n\nC. The stability of the actual closed-loop system will be identical to the stability predicted by the model.\n\nD. The approximation only affects the steady-state performance and has no impact on system stability.\n\nE. The system will be unstable regardless of the model used, as the Ziegler-Nichols method always produces unstable PI controllers for second-order-plus-dead-time systems.", "solution": "The actual process has the frequency response\n$$G_{p}(j\\omega)=\\frac{K_{p}}{(1+j\\omega T_{1})(1+j\\omega T_{2})}\\exp(-j\\omega L_{p}),$$\nso its magnitude and phase are\n$$|G_{p}(j\\omega)|=\\frac{|K_{p}|}{\\sqrt{(1+(\\omega T_{1})^{2})(1+(\\omega T_{2})^{2})}},\\qquad \\phi_{p}(\\omega)=-\\arctan(\\omega T_{1})-\\arctan(\\omega T_{2})-\\omega L_{p}.$$\nThe approximate model uses $K_{m}=K_{p}$, $T_{m}=T_{1}$ and $L_{m}=L_{p}+T_{2}$, hence\n$$G_{m}(j\\omega)=\\frac{K_{p}}{1+j\\omega T_{1}}\\exp(-j\\omega (L_{p}+T_{2})),$$\nwith\n$$|G_{m}(j\\omega)|=\\frac{|K_{p}|}{\\sqrt{1+(\\omega T_{1})^{2}}},\\qquad \\phi_{m}(\\omega)=-\\arctan(\\omega T_{1})-\\omega(L_{p}+T_{2}).$$\nComparing phases at the same frequency,\n$$\\phi_{m}(\\omega)-\\phi_{p}(\\omega)=-\\omega T_{2}+\\arctan(\\omega T_{2}).$$\nFor all $\\omega>0$, $\\arctan(x)<x$, so $-\\omega T_{2}+\\arctan(\\omega T_{2})<0$. Therefore,\n$$\\phi_{m}(\\omega)<\\phi_{p}(\\omega)\\quad\\text{for all }\\omega>0,$$\nthat is, the FOPDT model is more phase-lagging than the actual SOPDT plant at every frequency.\n\nFor magnitudes, since the dead time does not affect magnitude,\n$$\\frac{|G_{p}(j\\omega)|}{|G_{m}(j\\omega)|}=\\frac{1}{\\sqrt{1+(\\omega T_{2})^{2}}}<1\\quad\\text{for all }\\omega>0.$$\nWith the same implemented controller $G_{c}(s)=K_{c}\\left(1+\\frac{1}{T_{i}s}\\right)$ tuned from the model, the open-loop magnitudes satisfy\n$$\\frac{|G_{c}(j\\omega)G_{p}(j\\omega)|}{|G_{c}(j\\omega)G_{m}(j\\omega)|}=\\frac{|G_{p}(j\\omega)|}{|G_{m}(j\\omega)|}=\\frac{1}{\\sqrt{1+(\\omega T_{2})^{2}}}<1.$$\nHence, if $\\omega_{c,m}$ is the modelâ€™s unity-gain crossover with the designed controller (i.e., $|G_{c}(j\\omega_{c,m})G_{m}(j\\omega_{c,m})|=1$), then at that same frequency\n$$|G_{c}(j\\omega_{c,m})G_{p}(j\\omega_{c,m})|<1,$$\nso the actual crossover frequency $\\omega_{c,p}$ satisfies $\\omega_{c,p}<\\omega_{c,m}$. A lower crossover frequency further reduces phase lag contributions from both poles and dead time.\n\nCombining these two facts:\n1) At any fixed frequency, the plant phase is less negative than the model phase, $\\phi_{p}(\\omega)>\\phi_{m}(\\omega)$.\n2) The actual crossover occurs at a lower frequency, which reduces the magnitude of all lag terms $-\\arctan(\\omega T_{1})$, $-\\arctan(\\omega T_{2})$, and $-\\omega L_{p}$.\n\nTherefore, the actual loop with the implemented controller has a larger phase margin (is more stable) than predicted by the FOPDT model. This corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "1622321"}, {"introduction": "Since the Ziegler-Nichols methods rely on parameters derived from experiments or process data, they are inherently subject to measurement error. This final practice delves into a crucial aspect of practical implementation: sensitivity analysis. We will investigate how small, unavoidable errors in determining the ultimate gain $K_u$ and ultimate period $T_u$ propagate and affect the final PID controller gains ($K_p$, $K_I$, and $K_D$). This analysis is vital for understanding why some controller parameters are more \"fragile\" than others and for appreciating the importance of precision in the tuning process [@problem_id:1622316].", "problem": "Two control engineers are tasked with tuning a Proportional-Integral-Derivative (PID) controller for a stable industrial process. They decide to use the second Ziegler-Nichols method, also known as the ultimate cycle method. This involves finding the ultimate gain $K_u$ and the ultimate period $P_u$ by pushing the system to the brink of instability with a proportional-only controller.\n\nThe classic Ziegler-Nichols tuning rules for a PID controller are given by:\n- Proportional gain: $K_p = 0.60 K_u$\n- Integral time: $T_i = 0.50 P_u$\n- Derivative time: $T_d = 0.125 P_u$\n\nThe PID controller can be parameterized in terms of a proportional gain $K_p$, an integral gain $K_I = K_p/T_i$, and a derivative gain $K_D = K_p T_d$.\n\nDue to slight differences in experimental judgment, one engineer's measurements of the ultimate gain and period are slightly off from the true values, which we denote as $K_{u,0}$ and $P_{u,0}$. The measured values are $K_u$ and $P_u$. We define the small, positive, non-zero fractional errors in these measurements as $\\epsilon_K = (K_u - K_{u,0})/K_{u,0}$ and $\\epsilon_P = (P_u - P_{u,0})/P_{u,0}$.\n\nAfter calculating the controller parameters based on their erroneous measurements, an analysis reveals two key facts:\n1. The resulting fractional error in the calculated derivative gain, $(K_D - K_{D,0})/K_{D,0}$, is precisely five times the fractional error in the calculated proportional gain, $(K_p - K_{p,0})/K_{p,0}$.\n2. The resulting fractional error in the calculated integral gain, $(K_I - K_{I,0})/K_{I,0}$, is a negative value.\n\nAssuming the errors $\\epsilon_K$ and $\\epsilon_P$ are small enough that a first-order approximation for fractional errors is valid (i.e., for a function $Z$ of variables $X, Y, ...$, the fractional error $\\frac{\\delta Z}{Z}$ can be found from the total differential of $\\ln(Z)$), determine the numerical value of the ratio of the fractional error in the integral gain to the fractional error in the proportional gain.", "solution": "We start from the Ziegler-Nichols PID rules:\n- $K_{p} = 0.60\\,K_{u} = \\frac{3}{5}K_{u}$,\n- $T_{i} = 0.50\\,P_{u} = \\frac{1}{2}P_{u}$,\n- $T_{d} = 0.125\\,P_{u} = \\frac{1}{8}P_{u}$.\n\nThe implemented gains are $K_{I} = \\frac{K_{p}}{T_{i}}$ and $K_{D} = K_{p}T_{d}$. Substituting the above:\n$$\nK_{I} = \\frac{\\frac{3}{5}K_{u}}{\\frac{1}{2}P_{u}} = \\frac{6}{5}\\frac{K_{u}}{P_{u}}, \n\\qquad\nK_{D} = \\left(\\frac{3}{5}K_{u}\\right)\\left(\\frac{1}{8}P_{u}\\right) = \\frac{3}{40}K_{u}P_{u}.\n$$\n\nLet the true values be $K_{u,0}$ and $P_{u,0}$, and define small fractional errors $\\epsilon_{K} = \\frac{K_{u}-K_{u,0}}{K_{u,0}}$ and $\\epsilon_{P} = \\frac{P_{u}-P_{u,0}}{P_{u,0}}$. Using first-order error propagation via differentials of logarithms:\n- For $K_{p} = \\frac{3}{5}K_{u}$,\n$$\n\\ln K_{p} = \\ln\\!\\left(\\frac{3}{5}\\right) + \\ln K_{u}\n\\;\\Rightarrow\\;\n\\frac{\\delta K_{p}}{K_{p}} = \\frac{\\delta K_{u}}{K_{u}} = \\epsilon_{K}.\n$$\n- For $K_{D} = \\frac{3}{40}K_{u}P_{u}$,\n$$\n\\ln K_{D} = \\ln\\!\\left(\\frac{3}{40}\\right) + \\ln K_{u} + \\ln P_{u}\n\\;\\Rightarrow\\;\n\\frac{\\delta K_{D}}{K_{D}} = \\epsilon_{K} + \\epsilon_{P}.\n$$\n- For $K_{I} = \\frac{6}{5}\\frac{K_{u}}{P_{u}}$,\n$$\n\\ln K_{I} = \\ln\\!\\left(\\frac{6}{5}\\right) + \\ln K_{u} - \\ln P_{u}\n\\;\\Rightarrow\\;\n\\frac{\\delta K_{I}}{K_{I}} = \\epsilon_{K} - \\epsilon_{P}.\n$$\n\nCondition 1 states that the fractional error in $K_{D}$ is five times that in $K_{p}$:\n$$\n\\epsilon_{K} + \\epsilon_{P} = 5\\epsilon_{K}\n\\;\\Rightarrow\\;\n\\epsilon_{P} = 4\\epsilon_{K}.\n$$\nThen the fractional error in $K_{I}$ is\n$$\n\\frac{\\delta K_{I}}{K_{I}} = \\epsilon_{K} - \\epsilon_{P} = \\epsilon_{K} - 4\\epsilon_{K} = -3\\epsilon_{K},\n$$\nwhich satisfies Condition 2 (it is negative since $\\epsilon_{K} > 0$). Therefore, the ratio of the fractional error in $K_{I}$ to that in $K_{p}$ is\n$$\n\\frac{\\frac{\\delta K_{I}}{K_{I}}}{\\frac{\\delta K_{p}}{K_{p}}} = \\frac{-3\\epsilon_{K}}{\\epsilon_{K}} = -3.\n$$", "answer": "$$\\boxed{-3}$$", "id": "1622316"}]}