{"hands_on_practices": [{"introduction": "To truly grasp the impact of integrator windup, it's helpful to quantify its effects in a tangible scenario. This practice explores a PI-controlled thermal system with a physically limited heater, a common situation in process control. By calculating the \"unwinding\" time—the duration the controller remains saturated even after the error reverses—you will gain a concrete understanding of how windup degrades system performance and delays recovery. [@problem_id:1580921]", "problem": "A thermal chamber's temperature, $T(t)$ in degrees Celsius, is regulated by a control system. The chamber's temperature dynamics relative to the surroundings are described by the first-order differential equation:\n$$ \\tau \\frac{d(T(t)-T_{amb})}{dt} + (T(t)-T_{amb}) = K_p u_{sat}(t) $$\nwhere $T_{amb} = 25$ °C is the constant ambient temperature, $\\tau = 200$ s is the thermal time constant, $K_p = 1.0$ °C/W is the process gain, and $u_{sat}(t)$ is the power in Watts supplied by a heater.\n\nA Proportional-Integral (PI) controller is used to adjust the heater power. The controller's command signal, $u_c(t)$, is calculated as:\n$$ u_c(t) = K_c e(t) + x_I(t) $$\nwhere $e(t) = T_{sp}(t) - T(t)$ is the error between the setpoint $T_{sp}(t)$ and the measured temperature $T(t)$. The controller gain is $K_c = 2.0$ W/°C. The integral state, $x_I(t)$, which represents the accumulated error, evolves according to:\n$$ \\frac{dx_I}{dt} = \\frac{K_c}{T_i} e(t) $$\nwith an integral time constant of $T_i = 50$ s.\n\nThe heater is an electric resistive element that can only supply heat and has a maximum power output. Therefore, the actual power supplied, $u_{sat}(t)$, is related to the controller command by $u_{sat}(t) = \\max(0, \\min(u_c(t), U_{max}))$, with $U_{max} = 75$ W.\n\nThe control sequence is as follows:\n1.  Initially, for $t0$, the system is in steady state with the setpoint equal to the ambient temperature, $T_{sp} = T_{amb}$.\n2.  At $t=0$, the setpoint is stepped up to $T_{sp} = 150$ °C. The system responds, and the heater power immediately saturates at its maximum value, $U_{max}$.\n3.  The system is allowed to evolve until the chamber temperature $T(t)$ reaches 99.0% of the total change from its initial value towards its new steady-state temperature under maximum heater power. Let this time be $t_1$.\n4.  Precisely at time $t_1$, the setpoint is instantly returned to $T_{sp} = 25$ °C. Despite the large negative error this creates, the heater remains saturated at $U_{max}$ for some additional time due to the large accumulated value in the integral state $x_I(t)$.\n\nCalculate the duration $\\Delta t$, from time $t_1$ onwards, for which the controller command $u_c(t)$ remains at or above the saturation limit $U_{max}$. This duration is the time it takes for the controller to \"unwind\" from its saturated state. Express your answer in seconds, rounded to four significant figures.", "solution": "Let $y(t) \\equiv T(t)-T_{amb}$ so that the plant dynamics are\n$$\n\\tau \\frac{dy}{dt}+y = K_{p}\\,u_{sat}(t).\n$$\nFor $t0$, $T_{sp}=T_{amb}$ and at steady state $y(0)=0$, $u_{sat}(0)=0$. With $e=T_{sp}-T$, $u_{c}=K_{c}e+x_{I}$, $\\dot{x}_{I}=(K_{c}/T_{i})e$, a consistent steady state has $e(0)=0$, $x_{I}(0)=0$.\n\nAt $t=0$, $T_{sp}$ steps to $T_{sp,1}=150$, so $e(0^{+})=150-25=125$, $u_{c}(0^{+})=K_{c}e(0^{+})=2\\cdot 125=250\\geq U_{max}$ and thus $u_{sat}=U_{max}$ for $t\\in[0,t_{1}]$. With constant input $u_{sat}=U_{max}$, the plant solution is\n$$\ny(t)=y_{ss}\\bigl(1-\\exp(-t/\\tau)\\bigr),\\quad y_{ss}\\equiv K_{p}U_{max}.\n$$\nThe time $t_{1}$ at which $y$ reaches the fraction $0.99$ of the total change satisfies\n$$\ny(t_{1})=0.99\\,y_{ss}\\;\\Longrightarrow\\;1-\\exp(-t_{1}/\\tau)=0.99\\;\\Longrightarrow\\;\\exp(-t_{1}/\\tau)=0.01,\n$$\nso\n$$\nt_{1}=\\tau\\ln(100).\n$$\nDuring $t\\in[0,t_{1}]$, the error is\n$$\ne_{1}(t)=T_{sp,1}-T(t)=\\bigl(T_{sp,1}-T_{amb}\\bigr)-y(t)=\\bigl(T_{sp,1}-T_{amb}-y_{ss}\\bigr)+y_{ss}\\exp(-t/\\tau).\n$$\nThe integral state at $t_{1}$ is\n$$\nx_{I}(t_{1})=x_{I}(0)+\\frac{K_{c}}{T_{i}}\\int_{0}^{t_{1}}e_{1}(t)\\,dt\n=\\frac{K_{c}}{T_{i}}\\left[\\bigl(T_{sp,1}-T_{amb}-y_{ss}\\bigr)t_{1}+y_{ss}\\tau\\bigl(1-\\exp(-t_{1}/\\tau)\\bigr)\\right].\n$$\nUsing $\\exp(-t_{1}/\\tau)=0.01$ and $1-\\exp(-t_{1}/\\tau)=0.99$,\n$$\nx_{I}(t_{1})=\\frac{K_{c}}{T_{i}}\\left[\\bigl(T_{sp,1}-T_{amb}-y_{ss}\\bigr)\\tau\\ln(100)+0.99\\,y_{ss}\\tau\\right].\n$$\n\nAt $t=t_{1}$, the setpoint returns to $T_{sp,2}=T_{amb}$, so for $t\\geq t_{1}$ define $s\\equiv t-t_{1}$. While $u_{c}\\geq U_{max}$, the actuator remains saturated at $u_{sat}=U_{max}$, so the plant continues evolving under constant input $U_{max}$:\n$$\ny(t)=y_{ss}-\\bigl(y_{ss}-y(t_{1})\\bigr)\\exp(-s/\\tau)=y_{ss}\\left[1-0.01\\,\\exp(-s/\\tau)\\right].\n$$\nHence, with the new setpoint $T_{sp,2}=T_{amb}$,\n$$\ne_{2}(s)=T_{sp,2}-T(t)= -\\,y(t)=-y_{ss}+0.01\\,y_{ss}\\exp(-s/\\tau).\n$$\nThe integral evolves as\n$$\nx_{I}(t)=x_{I}(t_{1})+\\frac{K_{c}}{T_{i}}\\int_{0}^{s}e_{2}(\\xi)\\,d\\xi\n=x_{I}(t_{1})+\\frac{K_{c}}{T_{i}}\\left[-y_{ss}s+0.01\\,y_{ss}\\tau\\bigl(1-\\exp(-s/\\tau)\\bigr)\\right].\n$$\nTherefore, for $s\\geq 0$ while saturated high, the commanded control is\n$$\nu_{c}(s)=K_{c}e_{2}(s)+x_{I}(t)\n=x_{I}(t_{1})-K_{c}y_{ss}+\\frac{K_{c}}{T_{i}}\\bigl(0.01\\,y_{ss}\\tau\\bigr)-\\frac{K_{c}}{T_{i}}y_{ss}\\,s\n+K_{c}\\cdot 0.01\\,y_{ss}\\left[1-\\frac{\\tau}{T_{i}}\\right]\\exp(-s/\\tau).\n$$\nDesaturation occurs at the first $s=\\Delta t$ such that $u_{c}(\\Delta t)=U_{max}$. With the given numerical values $K_{p}=1$, $U_{max}=75$, $\\tau=200$, $K_{c}=2$, $T_{i}=50$, $T_{amb}=25$, $T_{sp,1}=150$, we have $y_{ss}=75$ and $t_{1}=200\\ln(100)$. Evaluating the constants,\n$$\nx_{I}(t_{1})=\\frac{2}{50}\\left[(125-75)\\cdot 200\\ln(100)+0.99\\cdot 75\\cdot 200\\right]\\approx 2436.0680742,\n$$\nand the commanded signal simplifies to\n$$\nu_{c}(s)=2292.0680742-3\\,s-4.5\\,\\exp(-s/200).\n$$\nSetting $u_{c}(\\Delta t)=U_{max}=75$ gives the scalar equation\n$$\n3\\,\\Delta t+4.5\\,\\exp(-\\Delta t/200)=2217.0680742.\n$$\nSolving this yields\n$$\n\\Delta t\\approx 738.9854\\ \\text{s},\n$$\nwhich, rounded to four significant figures, is\n$$\n\\Delta t=739.0\\ \\text{s}.\n$$", "answer": "$$\\boxed{739.0}$$", "id": "1580921"}, {"introduction": "Having witnessed the problem of windup, we now turn to a classic solution: the back-calculation method. This intuitive anti-windup strategy works by measuring the discrepancy between the controller's ideal output and the actuator's actual, saturated output. This \"saturation error\" is then used to create a corrective feedback signal that prevents the integrator state from growing uncontrollably. This exercise challenges you to identify the correct mathematical form of the modified integrator, reinforcing the core logic of this powerful technique. [@problem_id:1580959]", "problem": "A control systems engineer is designing a feedback controller for a high-precision robotic actuator. The controller is a Proportional-Integral (PI) type. The system's error signal, denoted by $e(t)$, is the input to the controller. The ideal, unconstrained output of the controller, $u(t)$, is the sum of a proportional term and an integral term. The integral part is managed by an internal state variable, $x_i(t)$, which represents the accumulated error over time. The dynamics of this integral state are given by the differential equation:\n$$ \\frac{dx_i}{dt} = K_i e(t) $$\nwhere $K_i$ is the integral gain. The ideal controller output is then calculated as $u(t) = K_p e(t) + x_i(t)$, where $K_p$ is the proportional gain.\n\nA major real-world constraint is that the physical actuator cannot produce an arbitrary output. Its output, denoted by $v(t)$, is limited to a specific range, $[V_{min}, V_{max}]$. This behavior is modeled by a saturation function:\n$$ v(t) = \\text{sat}(u(t)) = \\begin{cases} V_{max}  \\text{if } u(t)  V_{max} \\\\ u(t)  \\text{if } V_{min} \\le u(t) \\le V_{max} \\\\ V_{min}  \\text{if } u(t)  V_{min} \\end{cases} $$\nWhen saturation occurs, i.e., when $u(t) \\ne v(t)$, the standard integrator continues to accumulate error, a phenomenon known as integrator windup, which can lead to large overshoots and poor system performance.\n\nTo mitigate this, the engineer decides to implement a back-calculation anti-windup scheme. This scheme works by creating a feedback loop that senses the difference between the ideal controller output $u(t)$ and the actual saturated output $v(t)$. This difference, often called the saturation error, is then used to create a corrective term that is subtracted from the input of the integrator. This corrective term is proportional to the saturation error, with a gain constant $K_t  0$, known as the tracking gain or anti-windup gain.\n\nGiven this description of the back-calculation anti-windup modification, which of the following differential equations correctly represents the new dynamics of the integrator state $x_i(t)$?\n\nA. $\\frac{dx_i}{dt} = K_i e(t) - K_t (u(t) - v(t))$\n\nB. $\\frac{dx_i}{dt} = K_i e(t) + K_t (u(t) - v(t))$\n\nC. $\\frac{dx_i}{dt} = K_i \\left( e(t) - K_t (u(t) - v(t)) \\right)$\n\nD. $\\frac{dx_i}{dt} = K_i e(t) - K_t u(t)$\n\nE. $\\frac{dx_i}{dt} = K_i e(t) - K_t (K_p e(t) - v(t))$", "solution": "The original PI controller uses the integrator state $x_{i}(t)$ with dynamics\n$$\n\\frac{dx_{i}}{dt} = K_{i} e(t),\n$$\nand the ideal control signal is $u(t) = K_{p} e(t) + x_{i}(t)$. The actuator output is saturated as $v(t) = \\text{sat}(u(t))$, so the saturation error is the difference between the ideal and actual outputs:\n$$\nu(t) - v(t).\n$$\nIn back-calculation anti-windup, this saturation error is fed back to the integrator input through a tracking gain $K_{t}  0$, and, as stated, the corrective term is subtracted from the input of the integrator. The input to the integrator (the right-hand side of the state equation) is originally $K_{i} e(t)$. With the corrective term proportional to the saturation error and subtracted, the modified integrator input becomes\n$$\nK_{i} e(t) - K_{t} \\big(u(t) - v(t)\\big).\n$$\nTherefore, the new integrator dynamics are\n$$\n\\frac{dx_{i}}{dt} = K_{i} e(t) - K_{t} \\big(u(t) - v(t)\\big).\n$$\nThis matches option A. The sign is correct for mitigation: if $u(t)  v(t)$ (positive saturation error), the corrective term decreases $\\frac{dx_{i}}{dt}$ to oppose windup; if $u(t)  v(t)$, it increases $\\frac{dx_{i}}{dt}$ appropriately. Options B and D have incorrect signs or omit $v(t)$, option C incorrectly scales the corrective path by $K_{i}$ rather than an independent $K_{t}$, and option E incorrectly substitutes $K_{p} e(t)$ for $u(t)$, ignoring $x_{i}(t)$.", "answer": "$$\\boxed{A}$$", "id": "1580959"}, {"introduction": "Effective anti-windup can also be achieved by altering the controller's fundamental structure, an approach frequently used in digital implementations. This problem introduces the \"velocity form\" or \"incremental\" PI controller, which calculates the required *change* in the control signal at each time step. By working through a step-by-step example, you will see how this formulation inherently avoids windup by basing its next move on the *actual* output previously applied to the actuator, providing an elegant and implicit solution to saturation issues. [@problem_id:1580915]", "problem": "In digital control systems, the velocity form (or incremental form) of a Proportional-Integral (PI) controller is often favored for its inherent anti-windup properties. This problem analyzes the behavior of such a controller when faced with actuator saturation.\n\nConsider a digital control loop with a sampling period of $T$. The controller calculates an incremental change in its output, $\\Delta u[k]$, at each discrete time step $k$ based on the current error $e[k]$ and the previous error $e[k-1]$:\n$$\n\\Delta u[k] = K_p (e[k] - e[k-1]) + K_i T e[k]\n$$\nwhere $K_p$ and $K_i$ are the proportional and integral gains, respectively.\n\nThe controller's internal command for the current step, $u_{\\text{internal}}[k]$, is then determined by adding this increment to the *actual* command applied to the actuator in the previous step, $u_{\\text{applied}}[k-1]$:\n$$\nu_{\\text{internal}}[k] = u_{\\text{applied}}[k-1] + \\Delta u[k]\n$$\nThe physical actuator has saturation limits, $U_{\\min}$ and $U_{\\max}$. The command that is actually sent to the actuator, $u_{\\text{applied}}[k]$, is the internal command clamped to these limits.\n\nGiven the following parameters and initial conditions:\n- Proportional Gain, $K_p = 0.5$\n- Integral Gain, $K_i = 1.2$\n- Sampling Period, $T = 0.1 \\, \\text{s}$\n- Actuator Limits: $U_{\\min} = -10.0 \\, \\text{V}$ and $U_{\\max} = 10.0 \\, \\text{V}$\n- Initial Conditions at $k=0$: $e[0] = 0$ and $u_{\\text{applied}}[0] = 0 \\, \\text{V}$\n\nSuppose the system experiences the following sequence of errors for $k=1, 2, 3, 4$:\n- $e[1] = 15.0$\n- $e[2] = 15.0$\n- $e[3] = 15.0$\n- $e[4] = -5.0$\n\nCalculate the value of the command applied to the actuator at time step $k=4$, which is $u_{\\text{applied}}[4]$. Express your answer in Volts, rounded to three significant figures.", "solution": "We use the given incremental PI controller in velocity form:\n$$\n\\Delta u[k] = K_{p}\\big(e[k]-e[k-1]\\big) + K_{i}T\\,e[k],\n$$\nand the internal command is formed from the previously applied command (anti-windup by construction):\n$$\nu_{\\text{internal}}[k] = u_{\\text{applied}}[k-1] + \\Delta u[k],\n$$\nthen saturated to actuator limits:\n$$\nu_{\\text{applied}}[k] = \\min\\!\\big(\\max(u_{\\text{internal}}[k],\\,U_{\\min}),\\,U_{\\max}\\big).\n$$\nGiven $K_{p}=0.5$, $K_{i}=1.2$, $T=0.1$, we compute $K_{i}T=1.2\\times 0.1=0.12$. The limits are $U_{\\min}=-10$ and $U_{\\max}=10$. Initial conditions: $e[0]=0$ and $u_{\\text{applied}}[0]=0$.\n\nStep k=1 with $e[1]=15$:\n$$\n\\Delta u[1]=0.5\\big(15-0\\big)+0.12\\cdot 15=7.5+1.8=9.3,\n$$\n$$\nu_{\\text{internal}}[1]=0+9.3=9.3,\\quad u_{\\text{applied}}[1]=9.3\\ \\text{(within limits)}.\n$$\n\nStep k=2 with $e[2]=15$:\n$$\n\\Delta u[2]=0.5\\big(15-15\\big)+0.12\\cdot 15=0+1.8=1.8,\n$$\n$$\nu_{\\text{internal}}[2]=9.3+1.8=11.1,\\quad u_{\\text{applied}}[2]=10.0\\ \\text{(saturated at }U_{\\max}\\text{)}.\n$$\n\nStep k=3 with $e[3]=15$:\n$$\n\\Delta u[3]=0.5\\big(15-15\\big)+0.12\\cdot 15=1.8,\n$$\n$$\nu_{\\text{internal}}[3]=10.0+1.8=11.8,\\quad u_{\\text{applied}}[3]=10.0\\ \\text{(saturated)}.\n$$\n\nStep k=4 with $e[4]=-5$:\n$$\n\\Delta u[4]=0.5\\big(-5-15\\big)+0.12\\cdot(-5)=0.5\\cdot(-20)-0.6=-10-0.6=-10.6,\n$$\n$$\nu_{\\text{internal}}[4]=10.0+(-10.6)=-0.6,\\quad u_{\\text{applied}}[4]=-0.6\\ \\text{(within limits)}.\n$$\n\nThus, the applied command at $k=4$ is $-0.6$ V. Rounded to three significant figures: $-0.600$.", "answer": "$$\\boxed{-0.600}$$", "id": "1580915"}]}