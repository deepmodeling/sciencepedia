{"hands_on_practices": [{"introduction": "The foundation of feedforward control lies in proactively countering a disturbance before it affects the system's output. This first practice explores the most fundamental application of this idea: designing a static controller to completely eliminate the steady-state error caused by a persistent disturbance [@problem_id:1574107]. By analyzing the system's DC gains for both the process, $G_p(0)$, and disturbance, $G_d(0)$, you will derive the feedforward gain, $K_{ff}$, that perfectly balances the disturbance's influence, providing a clear illustration of the core principle $K_{ff} = -G_d(0)/G_p(0)$.", "problem": "A high-precision thermal processing chamber is used for curing composites. The temperature within the chamber, represented by its Laplace transform $T(s)$, is controlled by adjusting the power supplied to a heating element, $P(s)$. The process dynamics are modeled by the transfer function:\n$$G_p(s) = \\frac{T(s)}{P(s)} = \\frac{K_p}{(\\tau_1 s + 1)(\\tau_2 s + 1)}$$\nwhere $K_p$ is the process gain, and $\\tau_1$ and $\\tau_2$ are the process time constants.\n\nA significant, measurable disturbance to the system is the periodic opening of an access door for sample insertion, which causes heat loss. The impact of this disturbance, represented by a signal $D(s)$, on the chamber temperature is described by the disturbance transfer function:\n$$G_d(s) = \\frac{T(s)}{D(s)} = \\frac{-K_d}{\\tau_d s + 1}$$\nwhere $K_d$ is the disturbance gain and $\\tau_d$ is the disturbance time constant. All constants $K_p, K_d, \\tau_1, \\tau_2, \\tau_d$ are positive real numbers.\n\nTo counteract the thermal drop from the door opening without waiting for feedback correction from the primary Proportional-Integral-Derivative (PID) controller, a feedforward control scheme is implemented. This scheme uses a measurement of the disturbance $D(s)$ to make a proactive adjustment to the heater power. The adjustment is determined by a simple static feedforward controller with a constant gain $K_{ff}$. The total power command sent to the heater is the sum of the primary controller's output and the feedforward controller's output, where the latter is given by $P_{ff}(s) = K_{ff} D(s)$.\n\nDetermine the analytical expression for the static feedforward gain, $K_{ff}$, that is theoretically required to perfectly cancel the steady-state temperature change caused by a sustained disturbance (e.g., the door being held open indefinitely). Express your answer in terms of the given parameters.", "solution": "The goal is to determine the static feedforward gain $K_{ff}$ that ensures the steady-state change in temperature due to a sustained disturbance is zero. The overall change in temperature, $T(s)$, is the sum of the change caused directly by the disturbance and the change caused by the feedforward control action.\n\nThe direct effect of the disturbance $D(s)$ on the temperature $T(s)$ is given by the disturbance transfer function $G_d(s)$:\n$$T_{direct}(s) = G_d(s) D(s)$$\n\nThe feedforward controller generates a power adjustment $P_{ff}(s) = K_{ff} D(s)$. This power adjustment affects the temperature via the process transfer function $G_p(s)$:\n$$T_{ff}(s) = G_p(s) P_{ff}(s) = G_p(s) K_{ff} D(s)$$\n\nThe total change in temperature due to the disturbance and the feedforward compensation is the sum of these two effects:\n$$T_{total}(s) = T_{direct}(s) + T_{ff}(s) = G_d(s) D(s) + G_p(s) K_{ff} D(s)$$\nWe can factor out $D(s)$ to find the total transfer function from the disturbance to the temperature:\n$$\\frac{T_{total}(s)}{D(s)} = G_d(s) + G_p(s) K_{ff}$$\n\nWe are interested in the steady-state response to a sustained disturbance. A sustained disturbance can be modeled as a step input of magnitude $d_0$, so its Laplace transform is $D(s) = \\frac{d_0}{s}$.\n\nThe Final Value Theorem allows us to find the steady-state value of a time-domain signal, $t(t)$, from its Laplace transform, $T(s)$, by computing $\\lim_{t \\to \\infty} t(t) = \\lim_{s \\to 0} s T(s)$.\n\nApplying the Final Value Theorem to find the steady-state temperature change, $T_{ss}$:\n$$T_{ss} = \\lim_{s \\to 0} s T_{total}(s) = \\lim_{s \\to 0} s \\left( G_d(s) + G_p(s) K_{ff} \\right) D(s)$$\nSubstituting $D(s) = \\frac{d_0}{s}$:\n$$T_{ss} = \\lim_{s \\to 0} s \\left( G_d(s) + G_p(s) K_{ff} \\right) \\frac{d_0}{s}$$\nThe $s$ terms cancel out:\n$$T_{ss} = d_0 \\lim_{s \\to 0} \\left( G_d(s) + G_p(s) K_{ff} \\right)$$\n$$T_{ss} = d_0 \\left( \\lim_{s \\to 0} G_d(s) + \\left(\\lim_{s \\to 0} G_p(s)\\right) K_{ff} \\right)$$\n\nThe term $\\lim_{s \\to 0} G(s)$ is the steady-state or DC gain of a stable transfer function $G(s)$, which we can denote as $G(0)$. So, the expression becomes:\n$$T_{ss} = d_0 \\left( G_d(0) + G_p(0) K_{ff} \\right)$$\n\nFor perfect steady-state cancellation, we require $T_{ss} = 0$. Since the disturbance magnitude $d_0$ is non-zero, this implies:\n$$G_d(0) + G_p(0) K_{ff} = 0$$\nSolving for $K_{ff}$:\n$$K_{ff} = - \\frac{G_d(0)}{G_p(0)}$$\n\nNow, we must calculate the DC gains for the given transfer functions.\nFor the process transfer function:\n$$G_p(s) = \\frac{K_p}{(\\tau_1 s + 1)(\\tau_2 s + 1)}$$\n$$G_p(0) = \\lim_{s \\to 0} \\frac{K_p}{(\\tau_1 s + 1)(\\tau_2 s + 1)} = \\frac{K_p}{(\\tau_1 \\cdot 0 + 1)(\\tau_2 \\cdot 0 + 1)} = \\frac{K_p}{1 \\cdot 1} = K_p$$\n\nFor the disturbance transfer function:\n$$G_d(s) = \\frac{-K_d}{\\tau_d s + 1}$$\n$$G_d(0) = \\lim_{s \\to 0} \\frac{-K_d}{\\tau_d s + 1} = \\frac{-K_d}{\\tau_d \\cdot 0 + 1} = -K_d$$\n\nFinally, we substitute these DC gains into the expression for $K_{ff}$:\n$$K_{ff} = - \\frac{-K_d}{K_p}$$\n$$K_{ff} = \\frac{K_d}{K_p}$$\nThis is the required static feedforward gain.", "answer": "$$\\boxed{\\frac{K_d}{K_p}}$$", "id": "1574107"}, {"introduction": "While the ideal feedforward controller perfectly inverts the process dynamics, real-world systems often present limitations that make this impossible. This exercise delves into such a scenario, featuring a non-minimum phase system where direct inversion would result in an unstable controller [@problem_id:1575797]. This is a critical challenge in fields like aerospace, and this problem guides you through designing a stable and proper feedforward controller, $G_{ff}(s)$, by creating a practical approximation of the ideal inverse, highlighting the trade-offs required for effective, real-world implementation.", "problem": "A quadcopter is employed to transport a sensitive payload suspended by a cable. To counteract the effects of atmospheric disturbances, the quadcopter is equipped with an anemometer that provides real-time measurements of lateral wind gusts. The objective is to design a feedforward controller that uses this wind data to actively stabilize the payload.\n\nLet $\\theta(t)$ be the swing angle of the payload from the vertical, which is the system output to be minimized. The control input, $u(t)$, is the lateral acceleration commanded to the quadcopter. The measured disturbance, $d(t)$, is the lateral wind speed. All initial conditions are assumed to be zero.\n\nThe system dynamics are described by the following linearized transfer functions in the Laplace domain:\n\n1.  The process transfer function, $G_p(s)$, from the quadcopter's commanded acceleration $U(s) = \\mathcal{L}\\{u(t)\\}$ to the payload's swing angle $\\Theta(s) = \\mathcal{L}\\{\\theta(t)\\}$ is given by:\n    $$G_p(s) = \\frac{K_p (1 - T_z s)}{s^2 + 2\\zeta\\omega_n s + \\omega_n^2}$$\n    This model captures the essential pendulum-like dynamics and includes a non-minimum phase zero, a characteristic of such underactuated aerial manipulation systems.\n\n2.  The disturbance transfer function, $G_d(s)$, from the wind speed disturbance $D(s) = \\mathcal{L}\\{d(t)\\}$ to the payload's swing angle $\\Theta(s)$ is given by:\n    $$G_d(s) = \\frac{K_d}{s^2 + 2\\zeta\\omega_n s + \\omega_n^2}$$\n\nHere, $K_p$, $K_d$, $T_z$, $\\zeta$, and $\\omega_n$ are all positive real constants representing the physical parameters of the system.\n\nYour task is to determine the transfer function of a stable and proper feedforward controller, $G_{ff}(s)$, that takes the measured disturbance $D(s)$ as input to generate the control signal $U(s)$. The controller should be designed to minimize the effect of the wind gust on the payload's swing angle. Provide the analytic expression for $G_{ff}(s)$ in terms of the given parameters.", "solution": "With zero initial conditions and using Laplace transforms, the payload angle satisfies\n$$\n\\Theta(s)=G_{p}(s)\\,U(s)+G_{d}(s)\\,D(s).\n$$\nIf the feedforward controller uses the measured disturbance as $U(s)=G_{ff}(s)\\,D(s)$, then the closed-loop disturbance-to-output map becomes\n$$\n\\frac{\\Theta(s)}{D(s)}=G_{p}(s)\\,G_{ff}(s)+G_{d}(s).\n$$\nThe ideal disturbance cancellation condition is\n$$\nG_{p}(s)\\,G_{ff}^{\\text{ideal}}(s)+G_{d}(s)=0\n\\quad\\Rightarrow\\quad\nG_{ff}^{\\text{ideal}}(s)=-\\frac{G_{d}(s)}{G_{p}(s)}.\n$$\nUsing the given transfer functions,\n$$\nG_{p}(s)=\\frac{K_{p}\\left(1-T_{z}s\\right)}{s^{2}+2\\zeta\\omega_{n}s+\\omega_{n}^{2}},\n\\qquad\nG_{d}(s)=\\frac{K_{d}}{s^{2}+2\\zeta\\omega_{n}s+\\omega_{n}^{2}},\n$$\nyields\n$$\nG_{ff}^{\\text{ideal}}(s)=-\\frac{K_{d}}{K_{p}\\left(1-T_{z}s\\right)}.\n$$\nBecause $T_{z}0$, the factor $\\left(1-T_{z}s\\right)^{-1}$ has a pole at $s=1/T_{z}$ in the right half-plane, so $G_{ff}^{\\text{ideal}}(s)$ is unstable and thus not implementable.\n\nTo obtain a stable and proper approximation that preserves low-frequency disturbance rejection while avoiding inversion of the non-minimum-phase zero, replace the unstable factor by its stable mirror, that is,\n$$\n\\frac{1}{1-T_{z}s}\\;\\leadsto\\;\\frac{1}{1+T_{z}s}.\n$$\nTherefore, choose the stable, proper feedforward controller\n$$\nG_{ff}(s)=-\\frac{K_{d}}{K_{p}\\left(1+T_{z}s\\right)}.\n$$\nThis controller is strictly proper and has a single pole at $s=-1/T_{z}$, hence is stable. The resulting residual disturbance-to-output map is\n$$\nG_{p}(s)G_{ff}(s)+G_{d}(s)\n=\n\\frac{K_{d}}{s^{2}+2\\zeta\\omega_{n}s+\\omega_{n}^{2}}\n\\left[\n1-\\frac{1-T_{z}s}{1+T_{z}s}\n\\right]\n=\n\\frac{2K_{d}T_{z}s}{\\left(1+T_{z}s\\right)\\left(s^{2}+2\\zeta\\omega_{n}s+\\omega_{n}^{2}\\right)},\n$$\nwhich vanishes at $s=0$, ensuring cancellation of steady (low-frequency) wind components while maintaining stability and properness.", "answer": "$$\\boxed{-\\dfrac{K_{d}}{K_{p}\\left(1+T_{z}s\\right)}}$$", "id": "1575797"}, {"introduction": "Moving beyond single-loop systems, this practice extends the concept of feedforward control to the multi-input, multi-output (MIMO) domain, which is characteristic of many complex industrial processes. Here, you will tackle a two-zone thermal processing system where actions and disturbances are coupled [@problem_id:1575780]. The task is to design a matrix of feedforward controllers, $\\mathbf{G}_f(s)$, that diagonalizes the system's response to disturbances, a process that requires inverting the plant's transfer function matrix, $\\mathbf{G}_p(s)$. This problem builds valuable skills in applying linear algebra to control design for achieving comprehensive disturbance rejection in interconnected systems.", "problem": "A simplified two-zone Rapid Thermal Processing (RTP) system is used for semiconductor wafer manufacturing. The temperature in each zone is controlled by a dedicated heater. Let $T_1(t)$ and $T_2(t)$ be the temperatures of zone 1 and zone 2, respectively, and let $P_1(t)$ and $P_2(t)$ be the power supplied to the corresponding heaters. The system is subject to measurable thermal disturbances, $d_1(t)$ and $d_2(t)$, caused by fluctuations in a cooling gas flow.\n\nIn the Laplace domain, the system dynamics can be described by a Multi-Input, Multi-Output (MIMO) model:\n$$\n\\mathbf{T}(s) = \\mathbf{G}_p(s) \\mathbf{P}(s) + \\mathbf{G}_d(s) \\mathbf{d}(s)\n$$\nwhere $\\mathbf{T}(s) = \\begin{pmatrix} T_1(s) \\\\ T_2(s) \\end{pmatrix}$, $\\mathbf{P}(s) = \\begin{pmatrix} P_1(s) \\\\ P_2(s) \\end{pmatrix}$, and $\\mathbf{d}(s) = \\begin{pmatrix} d_1(s) \\\\ d_2(s) \\end{pmatrix}$ are the column vectors of the Laplace transforms of the temperatures, heater powers, and disturbances, respectively.\n\nThe plant transfer function matrix, $\\mathbf{G}_p(s)$, which includes thermal coupling between the zones, and the disturbance transfer function matrix, $\\mathbf{G}_d(s)$, are given by:\n$$\n\\mathbf{G}_p(s) = \\frac{1}{s+1} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n$$\n\\mathbf{G}_d(s) = \\frac{1}{s+2} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n\nTo counteract the effect of the disturbances, a feedforward controller, represented by the transfer function matrix $\\mathbf{G}_f(s)$, is to be designed. This controller adjusts the heater powers based on the measured disturbances according to the control law $\\mathbf{P}(s) = \\mathbf{G}_f(s) \\mathbf{d}(s)$.\n\nDetermine the analytical expression for the feedforward controller matrix $\\mathbf{G}_f(s)$ that provides perfect disturbance rejection, meaning the temperature vector $\\mathbf{T}(s)$ is identically zero for any non-zero disturbance vector $\\mathbf{d}(s)$, assuming zero initial conditions and zero reference temperatures.", "solution": "We start from the given MIMO plant and disturbance model in the Laplace domain:\n$$\n\\mathbf{T}(s) = \\mathbf{G}_{p}(s)\\mathbf{P}(s) + \\mathbf{G}_{d}(s)\\mathbf{d}(s),\n$$\nand the feedforward law\n$$\n\\mathbf{P}(s) = \\mathbf{G}_{f}(s)\\mathbf{d}(s).\n$$\nSubstituting the control law into the plant equation gives\n$$\n\\mathbf{T}(s) = \\left(\\mathbf{G}_{p}(s)\\mathbf{G}_{f}(s) + \\mathbf{G}_{d}(s)\\right)\\mathbf{d}(s).\n$$\nPerfect disturbance rejection for any disturbance vector $\\mathbf{d}(s)$ requires\n$$\n\\mathbf{G}_{p}(s)\\mathbf{G}_{f}(s) + \\mathbf{G}_{d}(s) = \\mathbf{0},\n$$\nwhich implies, assuming $\\mathbf{G}_{p}(s)$ is invertible,\n$$\n\\mathbf{G}_{f}(s) = -\\mathbf{G}_{p}(s)^{-1}\\mathbf{G}_{d}(s).\n$$\n\nGiven\n$$\n\\mathbf{G}_{p}(s) = \\frac{1}{s+1}\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}, \\quad\n\\mathbf{G}_{d}(s) = \\frac{1}{s+2}\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix},\n$$\nwe compute $\\mathbf{G}_{p}(s)^{-1}$. Let $\\mathbf{M} = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$. Then\n$$\n\\mathbf{G}_{p}(s) = \\frac{1}{s+1}\\mathbf{M} \\quad \\Rightarrow \\quad \\mathbf{G}_{p}(s)^{-1} = (s+1)\\mathbf{M}^{-1}.\n$$\nThe determinant of $\\mathbf{M}$ is $\\det(\\mathbf{M}) = 4 - 1 = 3$, and its inverse is\n$$\n\\mathbf{M}^{-1} = \\frac{1}{3}\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}.\n$$\nHence,\n$$\n\\mathbf{G}_{p}(s)^{-1} = \\frac{s+1}{3}\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}.\n$$\nMultiplying by $\\mathbf{G}_{d}(s)$ yields\n$$\n\\mathbf{G}_{p}(s)^{-1}\\mathbf{G}_{d}(s) = \\frac{s+1}{3}\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}\\cdot \\frac{1}{s+2}\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n= \\frac{s+1}{3(s+2)}\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}.\n$$\nTherefore, the feedforward controller that achieves perfect disturbance rejection is\n$$\n\\mathbf{G}_{f}(s) = -\\frac{s+1}{3(s+2)}\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}\n= \\begin{pmatrix}\n-\\frac{2(s+1)}{3(s+2)}  \\frac{s+1}{3(s+2)} \\\\\n\\frac{s+1}{3(s+2)}  -\\frac{2(s+1)}{3(s+2)}\n\\end{pmatrix}.\n$$\nSubstituting this $\\mathbf{G}_{f}(s)$ into $\\mathbf{T}(s) = \\left(\\mathbf{G}_{p}(s)\\mathbf{G}_{f}(s) + \\mathbf{G}_{d}(s)\\right)\\mathbf{d}(s)$ gives the zero matrix multiplying $\\mathbf{d}(s)$, thus ensuring $\\mathbf{T}(s) \\equiv \\mathbf{0}$ for any $\\mathbf{d}(s)$ under the stated assumptions.", "answer": "$$\\boxed{\\begin{pmatrix}\n-\\frac{2(s+1)}{3(s+2)}  \\frac{s+1}{3(s+2)} \\\\\n\\frac{s+1}{3(s+2)}  -\\frac{2(s+1)}{3(s+2)}\n\\end{pmatrix}}$$", "id": "1575780"}]}