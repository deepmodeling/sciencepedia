{"hands_on_practices": [{"introduction": "The phase margin is a fundamental metric for assessing the relative stability and predicting the transient response of a closed-loop system. This practice provides essential hands-on experience in calculating the phase margin directly from a system's open-loop transfer function, a core skill for any control engineer. By working through this example [@problem_id:1613054], you will solidify your understanding of the gain crossover frequency and its role in determining stability.", "problem": "An engineer is analyzing the stability of a unity-feedback control system for a single joint of a robotic arm. The open-loop transfer function, $G(s)$, which relates the motor's command signal to the joint's final angular position, has been modeled as:\n$$G(s) = \\frac{K}{s(1 + \\tau s)}$$\nThis model represents a system with an ideal integrator (from the motor converting a velocity command to a position) and a first-order lag with a time constant $\\tau$ (representing the combined electrical and mechanical dynamics of the motor).\n\nFor the specific system under consideration, the gain constant is $K = 10.0 \\text{ s}^{-1}$ and the time constant is $\\tau = 0.01 \\text{ s}$.\n\nTo ensure the system is stable and has adequate performance, the engineer needs to determine its stability margins. Calculate the phase margin of this system. Express your answer in degrees, rounded to three significant figures.", "solution": "For a unity-feedback system with open-loop transfer function $L(s)=G(s)$, the phase margin is evaluated at the gain crossover frequency $\\omega_{gc}$ where $|L(j\\omega_{gc})|=1$. The phase margin (in radians) is given by\n$$\\text{PM}=\\pi+\\arg\\{L(j\\omega_{gc})\\}.$$\n\nGiven\n$$G(s)=\\frac{K}{s(1+\\tau s)},$$\nthe loop transfer function in frequency domain is\n$$L(j\\omega)=\\frac{K}{j\\omega\\left(1+j\\omega\\tau\\right)}.$$\n\nIts magnitude and phase are\n$$|L(j\\omega)|=\\frac{K}{\\omega\\sqrt{1+(\\omega\\tau)^{2}}}, \\quad \\arg\\{L(j\\omega)\\}=-\\frac{\\pi}{2}-\\arctan(\\omega\\tau).$$\n\nThe gain crossover frequency $\\omega_{gc}$ satisfies\n$$\\frac{K}{\\omega_{gc}\\sqrt{1+(\\omega_{gc}\\tau)^{2}}}=1.$$\nLet $x=\\omega_{gc}\\tau$ and $a=K\\tau$. Then $\\omega_{gc}=x/\\tau$ and the equation becomes\n$$\\frac{a}{x\\sqrt{1+x^{2}}}=1 \\;\\;\\Longrightarrow\\;\\; x\\sqrt{1+x^{2}}=a.$$\nSquaring both sides and setting $y=x^{2}$ gives\n$$x^{2}(1+x^{2})=a^{2}\\;\\;\\Longrightarrow\\;\\; y^{2}+y-a^{2}=0.$$\nSolving the quadratic for $y\\ge 0$,\n$$y=\\frac{-1+\\sqrt{1+4a^{2}}}{2}, \\quad x=\\sqrt{y}=\\sqrt{\\frac{-1+\\sqrt{1+4a^{2}}}{2}}.$$\n\nAt $\\omega_{gc}$, the phase is $\\arg\\{L(j\\omega_{gc})\\}=-\\frac{\\pi}{2}-\\arctan(x)$, so the phase margin (in radians) is\n$$\\text{PM}=\\pi+\\left(-\\frac{\\pi}{2}-\\arctan(x)\\right)=\\frac{\\pi}{2}-\\arctan(x),$$\nand in degrees,\n$$\\text{PM}_{\\text{deg}}=90-\\left(\\frac{180}{\\pi}\\right)\\arctan(x), \\quad x=\\sqrt{\\frac{-1+\\sqrt{1+4(K\\tau)^{2}}}{2}}.$$\n\nFor $K=10.0\\,\\text{s}^{-1}$ and $\\tau=0.01\\,\\text{s}$, $a=K\\tau=0.1$, hence\n$$y=\\frac{-1+\\sqrt{1+4(0.1)^{2}}}{2}=\\frac{-1+\\sqrt{1.04}}{2}\\approx 0.009901951,$$\n$$x=\\sqrt{y}\\approx 0.0991789.$$\nThen\n$$\\arctan(x)\\approx 0.099179\\ \\text{rad}\\approx 5.6809\\ \\text{degrees},$$\nso\n$$\\text{PM}_{\\text{deg}}\\approx 90-5.6809=84.3191.$$\nRounded to three significant figures, the phase margin is $84.3$ degrees.", "answer": "$$\\boxed{84.3}$$", "id": "1613054"}, {"introduction": "Beyond merely assessing stability, Bode plots are powerful design tools. A common engineering task is to determine the safe operating range for a controller's parameters. This exercise demonstrates how to use the concept of gain margin to find the maximum proportional gain $K$ before a system goes unstable, connecting frequency-domain analysis directly to practical controller tuning [@problem_id:1613060].", "problem": "An engineering team is designing an active suspension system for a specialized vehicle. The system is modeled as a unity negative feedback control loop. A proportional controller with a positive gain $K$ is used to generate a corrective force based on the ride height error. The plant, which represents the vehicle's dynamic response to this force, has a transfer function $G(s)$.\n\nA frequency response analysis of the plant $G(s)$ has been performed, yielding the following key characteristics:\n1. The plant is a minimum-phase system, meaning it has no poles or zeros in the right-half of the s-plane.\n2. For small positive values of the gain $K$, the closed-loop system is known to be stable.\n3. There is a single, unique angular frequency, denoted as the phase crossover frequency $\\omega_{pc}$, at which the phase shift of $G(j\\omega)$ is exactly $-180^\\circ$. This frequency is measured to be $\\omega_{pc} = 25.0$ rad/s.\n4. At this specific phase crossover frequency, the magnitude of the plant's frequency response is measured to be $|G(j\\omega_{pc})| = 0.080$.\n\nBased on this information, determine the maximum value of the gain $K$ for which the closed-loop system will remain stable.", "solution": "The stability of the unity negative feedback system can be analyzed using the open-loop transfer function, $L(s) = K G(s)$. The stability boundary is determined by the Nyquist stability criterion. For a system to be on the verge of instability, the Nyquist plot of $L(j\\omega)$ must pass through the critical point $(-1, 0)$ in the complex plane.\n\nThis condition implies two requirements must be met simultaneously:\n1. The magnitude of the open-loop transfer function must be unity: $|L(j\\omega)| = 1$.\n2. The phase of the open-loop transfer function must be $-180^\\circ$: $\\angle L(j\\omega) = -180^\\circ$.\n\nLet's analyze the phase condition first. The open-loop transfer function is $L(s) = K G(s)$. Since the gain $K$ is a positive real number, its phase is $0^\\circ$. Therefore, the phase of the open-loop system is equal to the phase of the plant:\n$$\n\\angle L(j\\omega) = \\angle (K G(j\\omega)) = \\angle K + \\angle G(j\\omega) = 0^\\circ + \\angle G(j\\omega) = \\angle G(j\\omega)\n$$\nThe frequency at which the open-loop phase is $-180^\\circ$ is the phase crossover frequency, $\\omega_{pc}$. According to the problem statement, this occurs at $\\omega_{pc} = 25.0$ rad/s, where $\\angle G(j\\omega_{pc}) = -180^\\circ$.\n\nNow, let's apply the magnitude condition at this specific frequency. The system is at the margin of stability when $|L(j\\omega_{pc})| = 1$. We can express the magnitude of the open-loop transfer function as:\n$$\n|L(j\\omega_{pc})| = |K G(j\\omega_{pc})| = K |G(j\\omega_{pc})|\n$$\nThe value of gain $K$ that places the system on the verge of instability is the maximum possible gain for stability, which we will call $K_{max}$. Setting the magnitude to 1 gives:\n$$\nK_{max} |G(j\\omega_{pc})| = 1\n$$\nSolving for $K_{max}$, we get:\n$$\nK_{max} = \\frac{1}{|G(j\\omega_{pc})|}\n$$\nThe problem provides the magnitude of the plant's response at the phase crossover frequency: $|G(j\\omega_{pc})| = 0.080$.\n\nSubstituting this value into our expression for $K_{max}$:\n$$\nK_{max} = \\frac{1}{0.080}\n$$\nTo compute the value, we can write $0.080$ as a fraction: $0.080 = \\frac{80}{1000} = \\frac{8}{100} = \\frac{2}{25}$.\n$$\nK_{max} = \\frac{1}{\\frac{2}{25}} = \\frac{25}{2} = 12.5\n$$\nSince the system is stable for small $K$ and there is only one phase crossover frequency, the system is stable for all gains in the range $0 < K < K_{max}$. Thus, the maximum value of the gain $K$ for which the closed-loop system is stable is 12.5.", "answer": "$$\\boxed{12.5}$$", "id": "1613060"}, {"introduction": "While simple rules of thumb are useful, real-world systems can present complex frequency responses that demand a more nuanced analysis. This practice explores a system with multiple gain crossover frequencies, a scenario where a naive application of the phase margin rule can be misleading. By analyzing this case [@problem_id:1612996], you will learn to interpret non-standard Bode plots and understand why the gain at the phase crossover frequency often provides a more robust indicator of stability.", "problem": "A control engineer is designing a unity negative feedback system to regulate the temperature of a novel chemical reactor. The open-loop transfer function of the system is denoted by $G(s)$. Due to complex thermal dynamics and transport delays, the Bode plot of the open-loop frequency response, $G(j\\omega)$, exhibits non-standard behavior. A frequency-response analysis reveals the following key characteristics:\n\n- The magnitude plot of $G(j\\omega)$ crosses the 0 dB line at two distinct angular frequencies: $\\omega_{c1} = 10 \\text{ rad/s}$ and $\\omega_{c2} = 100 \\text{ rad/s}$.\n- The phase of the system at these frequencies is given by $\\angle G(j\\omega_{c1}) = -150^\\circ$ and $\\angle G(j\\omega_{c2}) = -210^\\circ$.\n- The phase plot of $G(j\\omega)$ crosses the $-180^\\circ$ line at a single angular frequency, known as the phase crossover frequency, $\\omega_{p} = 40 \\text{ rad/s}$.\n\nThe stability of the closed-loop system is to be assessed using the phase margin. The phase margin (PM) is defined as $PM = 180^\\circ + \\phi$, where $\\phi$ is the phase angle at the relevant gain crossover frequency. Which of the following statements correctly identifies the stability of the system and the reason for it?\n\nA. The system is stable because the phase margin calculated at $\\omega_{c1}$ is positive.\n\nB. The system is stable because the gain is less than 0 dB at low frequencies and high frequencies.\n\nC. The system is unstable because the phase margin calculated at $\\omega_{c1}$ is not a valid indicator of stability in this case.\n\nD. The system is unstable because the magnitude of the open-loop transfer function is greater than 1 (or 0 dB) at the phase crossover frequency $\\omega_{p}$.\n\nE. The system is marginally stable because there are multiple gain crossover frequencies.\n\nF. The stability cannot be determined from the information provided.", "solution": "We consider a unity negative feedback loop with open-loop transfer function $G(s)$ and frequency response $G(j\\omega)$. The gain crossover frequencies are defined by $|G(j\\omega_{c})|=1$ (i.e., $0$ dB), and the phase margin at a gain crossover $\\omega_{c}$ is $PM=180^{\\circ}+\\angle G(j\\omega_{c})$. The phase crossover frequency $\\omega_{p}$ is defined by $\\angle G(j\\omega_{p})=-180^{\\circ}$. Closed-loop stability can be assessed by either the phase margin at the relevant gain crossover or, equivalently, by the gain margin at the phase crossover frequency. Specifically, at $\\omega_{p}$, if $|G(j\\omega_{p})|>1$ (i.e., magnitude above $0$ dB), the gain margin is negative and the closed-loop is unstable (Nyquist criterion, unity feedback, and no open-loop right-half-plane poles).\n\nGiven data:\n- Gain crossovers: $\\omega_{c1}=10$ and $\\omega_{c2}=100$, with phases $\\angle G(j\\omega_{c1})=-150^{\\circ}$ and $\\angle G(j\\omega_{c2})=-210^{\\circ}$.\n- Phase crossover: $\\omega_{p}=40$ with $\\angle G(j\\omega_{p})=-180^{\\circ}$.\n\nStep 1: Compute the phase margins at the two gain crossovers (to highlight the ambiguity when multiple crossovers exist).\nAt $\\omega_{c1}$,\n$$\nPM_{1}=180^{\\circ}+(-150^{\\circ})=30^{\\circ}>0.\n$$\nAt $\\omega_{c2}$,\n$$\nPM_{2}=180^{\\circ}+(-210^{\\circ})=-30^{\\circ}<0.\n$$\nThus, using $\\omega_{c1}$ alone would misleadingly suggest stability, while using $\\omega_{c2}$ indicates instability. Therefore, in the presence of multiple gain crossovers, the phase margin at the lower crossover is not a reliable indicator by itself.\n\nStep 2: Determine the magnitude at the phase crossover frequency $\\omega_{p}=40$.\nLet $M(\\omega)=20\\log_{10}|G(j\\omega)|$ denote the Bode magnitude in dB. We are given $M(\\omega_{c1})=0$ and $M(\\omega_{c2})=0$. For realizable (proper or strictly proper) physical systems, $|G(j\\omega)|\\to 0$ as $\\omega\\to\\infty$, so\n$$\n\\lim_{\\omega\\to\\infty}M(\\omega)=-\\infty<0.\n$$\nBy continuity of $M(\\omega)$ and the fact that $M(\\omega)=0$ at exactly two distinct frequencies $\\omega_{c1}$ and $\\omega_{c2}$, it follows that:\n- For $\\omega>\\omega_{c2}$, $M(\\omega)<0$.\n- Therefore, in the interval $(\\omega_{c1},\\omega_{c2})$, the magnitude must be above $0$ dB, i.e., $M(\\omega)>0$.\nSince $\\omega_{p}=40$ lies strictly between $\\omega_{c1}=10$ and $\\omega_{c2}=100$, we conclude\n$$\nM(\\omega_{p})>0 \\quad\\Longleftrightarrow\\quad |G(j\\omega_{p})|>1.\n$$\n\nStep 3: Conclude stability from the gain at the phase crossover.\nAt $\\omega_{p}$, the phase is exactly $-180^{\\circ}$ and the magnitude satisfies $|G(j\\omega_{p})|>1$. This implies a negative gain margin. For a unity negative feedback loop with no open-loop right-half-plane poles, the Nyquist plot crosses the negative real axis at a radius greater than $1$, leading to a clockwise encirclement of the critical point $-1$, and thus an unstable closed-loop. Hence the correct stability assessment is that the system is unstable because the magnitude is greater than $1$ at the phase crossover frequency.\n\nAmong the given options, this corresponds precisely to statement D. Statement A is invalidated by the presence of multiple gain crossovers; statement C identifies that the phase margin at $\\omega_{c1}$ is not a valid indicator, but it does not provide the correct specific reason, whereas D does. Statements B, E, and F are incorrect for the reasons above and because the provided information suffices to conclude instability through the negative gain margin at $\\omega_{p}$.", "answer": "$$\\boxed{D}$$", "id": "1612996"}]}