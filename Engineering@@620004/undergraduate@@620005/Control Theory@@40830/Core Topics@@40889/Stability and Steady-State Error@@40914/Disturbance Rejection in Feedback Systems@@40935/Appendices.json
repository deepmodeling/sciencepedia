{"hands_on_practices": [{"introduction": "A fundamental aspect of feedback control is its ability to mitigate the effects of unwanted disturbances. However, the effectiveness of this mitigation can depend critically on where the disturbance enters the system. This practice provides a foundational exercise in analyzing this dependency by directly comparing the steady-state error from a disturbance entering the plant's input versus one at its output, revealing how the plant's own characteristics scale its vulnerability. [@problem_id:1572095]", "problem": "Consider a unity negative feedback control system designed to regulate a process. The controller is a simple proportional controller with a transfer function given by $C(s) = K_p$, where $K_p$ is a positive gain constant. The process, or plant, is modeled as a stable first-order system with a transfer function $P(s) = \\frac{K}{Ts+1}$, where $K$ is the positive DC gain and $T$ is the positive time constant.\n\nThe system is subject to an unwanted constant disturbance, $d(t)$, of magnitude $d_0$, which has the Laplace transform $D(s) = \\frac{d_0}{s}$. To analyze the system's disturbance rejection capability, we evaluate its performance with a zero reference input, i.e., $r(t) = 0$. The error signal is defined as the difference between the reference and the output, $e(t) = r(t) - y(t)$.\n\nWe will compare two distinct scenarios for where this disturbance enters the system:\n\n1.  **Input Disturbance:** The disturbance is added to the controller's output signal, just before the plant.\n2.  **Output Disturbance:** The disturbance is added to the plant's output signal.\n\nLet $e_{ss,1}$ be the steady-state error for the input disturbance case, and let $e_{ss,2}$ be the steady-state error for the output disturbance case.\n\nDetermine the value of the ratio of the magnitudes of these two steady-state errors, $\\frac{|e_{ss,1}|}{|e_{ss,2}|}$. Express your answer as a closed-form analytic expression in terms of the given symbolic parameters.", "solution": "We consider a unity negative feedback system with controller $C(s)=K_{p}$ and plant $P(s)=\\frac{K}{Ts+1}$, subject to a constant disturbance $D(s)=\\frac{d_{0}}{s}$ and zero reference $R(s)=0$. The error is $E(s)=R(s)-Y(s)=-Y(s)$. We assume closed-loop stability so that the final value theorem applies.\n\nCase 1: Input disturbance (added before the plant). The plant input is $U_{\\text{in}}(s)=C(s)E(s)+D(s)$. The output is\n$$\nY(s)=P(s)U_{\\text{in}}(s)=P(s)\\big(C(s)E(s)+D(s)\\big)=P(s)\\big(C(s)(-Y(s))+D(s)\\big).\n$$\nRearranging,\n$$\nY(s)+P(s)C(s)Y(s)=P(s)D(s)\\;\\;\\Rightarrow\\;\\;Y(s)=\\frac{P(s)}{1+P(s)C(s)}D(s).\n$$\nHence\n$$\nE(s)=-Y(s)=-\\frac{P(s)}{1+P(s)C(s)}D(s).\n$$\nBy the final value theorem,\n$$\ne_{ss,1}=\\lim_{t\\to\\infty}e(t)=\\lim_{s\\to 0}sE(s)=\\lim_{s\\to 0}\\left[-\\frac{P(s)}{1+P(s)C(s)}\\,d_{0}\\right].\n$$\nEvaluating at $s=0$ gives $P(0)=K$ and $C(0)=K_{p}$, thus\n$$\ne_{ss,1}=-\\frac{K}{1+KK_{p}}\\,d_{0},\\quad |e_{ss,1}|=\\frac{K}{1+KK_{p}}\\,|d_{0}|.\n$$\n\nCase 2: Output disturbance (added at the plant output). The measured output is\n$$\nY(s)=P(s)C(s)E(s)+D(s).\n$$\nWith $E(s)=-Y(s)$, we have\n$$\nE(s)=-\\big(P(s)C(s)E(s)+D(s)\\big)\\;\\;\\Rightarrow\\;\\;E(s)+P(s)C(s)E(s)=-D(s),\n$$\nso\n$$\nE(s)=-\\frac{1}{1+P(s)C(s)}D(s).\n$$\nThen\n$$\ne_{ss,2}=\\lim_{s\\to 0}sE(s)=\\lim_{s\\to 0}\\left[-\\frac{1}{1+P(s)C(s)}\\,d_{0}\\right]=-\\frac{1}{1+KK_{p}}\\,d_{0},\n$$\nand\n$$\n|e_{ss,2}|=\\frac{1}{1+KK_{p}}\\,|d_{0}|.\n$$\n\nTherefore, the ratio of the magnitudes of the steady-state errors is\n$$\n\\frac{|e_{ss,1}|}{|e_{ss,2}|}=\\frac{\\frac{K}{1+KK_{p}}|d_{0}|}{\\frac{1}{1+KK_{p}}|d_{0}|}=K.\n$$\nThis ratio is independent of $K_{p}$, $T$, and $d_{0}$.", "answer": "$$\\boxed{K}$$", "id": "1572095"}, {"introduction": "While simple feedback can reduce errors, achieving perfect rejection requires a more sophisticated approach. This exercise introduces the powerful Internal Model Principle, a cornerstone of modern control theory that dictates how a controller must be structured to completely nullify persistent disturbances. By analyzing a system subject to both a constant drift and a sinusoidal vibration, you will discover the specific controller poles needed to create an \"internal model\" of the external world's unwanted signals. [@problem_id:1572074]", "problem": "A high-precision optical trapping system is used in a biophysics laboratory to hold a microscopic dielectric bead at a fixed reference position. The system's dynamics are modeled by a plant with transfer function $P(s)$. A controller $C(s)$ is used in a unity negative feedback configuration to maintain the bead's position.\n\nThe system is subject to external disturbances that are additively combined with the plant's output. The total disturbance signal, $d(t)$, consists of two components: a constant offset $A$ due to slow thermal drift in the system's electronics, and a sinusoidal vibration of amplitude $B$ and angular frequency $\\omega_0$ transmitted from a nearby piece of equipment. The total disturbance can thus be written as:\n$$d(t) = A + B\\sin(\\omega_0 t)$$\nwhere $A$, $B$, and $\\omega_0$ are positive real constants.\n\nAssume the plant $P(s)$ is stable and does not have any poles located at $s=0$ or at $s = \\pm j\\omega_0$. Also assume that the controller $C(s)$ is designed such that the overall closed-loop system is stable.\n\nTo ensure that the position error caused by the disturbance $d(t)$ asymptotically approaches zero (i.e., $\\lim_{t\\to\\infty} e(t) = 0$), what is the minimal set of poles that the controller transfer function $C(s)$ must contain?\n\nA. A single pole at $s=0$.\n\nB. A pair of poles at $s = \\pm j\\omega_0$.\n\nC. A single pole at $s=0$ and a pair of poles at $s = \\pm j\\omega_0$.\n\nD. A double pole at $s=0$.\n\nE. A pair of poles at $s = \\pm \\omega_0$.\n\nF. No specific poles are required; a sufficiently high-gain proportional controller can achieve this.", "solution": "Let the loop transfer function be $L(s) = P(s)C(s)$. In unity negative feedback, with the disturbance $d$ added at the plant output, the closed-loop relations are\n$$y(s) = \\frac{L(s)}{1+L(s)}\\,r(s) + \\frac{1}{1+L(s)}\\,d(s), \\quad e(s) = r(s) - y(s).$$\nDefine the sensitivity $S(s) = \\frac{1}{1+L(s)}$ and the complementary sensitivity $T(s) = \\frac{L(s)}{1+L(s)}$. Then\n$$e(s) = r(s) - \\left(T(s)r(s) + S(s)d(s)\\right) = S(s)r(s) - S(s)d(s).$$\nThus, the transfer function from $d$ to $e$ is $G_{ed}(s) = -S(s)$. To make the position error caused by $d(t)$ asymptotically vanish for the given disturbance components, we require that the steady response of $e$ to each component is zero.\n\n1) Constant component $A$. Its Laplace transform is $d_{A}(s) = \\frac{A}{s}$. The error contribution is\n$$e_{A}(s) = -S(s)\\frac{A}{s}.$$\nBy the Final Value Theorem (closed-loop stable by assumption),\n$$\\lim_{t\\to\\infty} e_{A}(t) = \\lim_{s\\to 0} s e_{A}(s) = \\lim_{s\\to 0} \\left(-A S(s)\\right).$$\nHence we need $S(0)=0$. Since $S(0) = \\frac{1}{1+L(0)}$, this requires $|L(0)| \\to \\infty$. The plant has no pole at $s=0$ and is stable, so $P(0)$ is finite and nonzero. Therefore the only way to achieve $|L(0)| \\to \\infty$ is for the controller to contribute a pole at $s=0$ (integral action). A single pole at $s=0$ is sufficient for perfect rejection of a constant disturbance; a double pole is not necessary for this disturbance class.\n\n2) Sinusoidal component $B\\sin(\\omega_{0} t)$. Its Laplace transform is $d_{B}(s) = \\frac{B\\omega_{0}}{s^{2}+\\omega_{0}^{2}}$. The steady-state sinusoidal error due to this input is governed by the frequency response at $\\omega_{0}$:\n$$e_{B,ss}(t) = \\Re\\left\\{-S(j\\omega_{0})\\,B \\exp(j\\omega_{0} t)\\right\\}.$$\nTo have $e_{B,ss}(t) \\equiv 0$, we require $S(j\\omega_{0}) = 0$. Since $S(j\\omega_{0}) = \\frac{1}{1+L(j\\omega_{0})}$, this requires $|L(j\\omega_{0})| \\to \\infty$. The plant has no poles at $s=\\pm j\\omega_{0}$ and is stable, so $P(j\\omega_{0})$ is finite and nonzero. Thus, to make $|L(j\\omega_{0})| \\to \\infty$, the controller must include an internal model of the sinusoid, namely a pair of poles at $s=\\pm j\\omega_{0}$.\n\nBy the Internal Model Principle, the minimal internal model that guarantees asymptotic rejection of the exogenous signals $A$ and $B\\sin(\\omega_{0} t)$ is the union of the required generators: one integrator at $s=0$ for the constant and a resonant pair at $s=\\pm j\\omega_{0}$ for the sinusoid. This corresponds to option C. Options A or B alone reject only one of the two components; option D is not minimal for a constant disturbance; option E places real poles and does not provide infinite loop gain at $s=\\pm j\\omega_{0}$; option F cannot achieve exact zero error because finite proportional gain yields $S(j\\omega)\\neq 0$.", "answer": "$$\\boxed{C}$$", "id": "1572074"}, {"introduction": "Beyond just minimizing the final error, a well-designed control system must manage the entire transient response to a disturbance. This problem bridges theory and practical engineering by focusing on the optimal tuning of a PID controller, a workhorse of industrial automation. You will use the Integral of Time-weighted Absolute Error (ITAE) criterion—a standard performance metric—to determine the optimal derivative gain for rejecting a load disturbance, showcasing how design parameters are selected to ensure a system recovers quickly and smoothly. [@problem_id:1572081]", "problem": "A control systems engineer is designing a Proportional-Integral-Derivative (PID) controller for a robotic joint actuator. In a simplified model, the plant transfer function $P(s)$ relating the motor input voltage to the joint's angular position is given by $P(s) = \\frac{B}{s(s+a)}$, where $a$ and $B$ are positive real constants representing the actuator's dynamics.\n\nThe actuator is part of a unity negative feedback control system with the PID controller $C(s) = K_p + \\frac{K_i}{s} + K_d s$. A significant challenge in this application is the rejection of external load disturbances, such as unexpected forces on the robotic arm. This load disturbance can be modeled as a signal $D(s)$ added to the controller's output before it enters the plant.\n\nThe integral gain has been chosen as a fixed value $K_i$. The proportional gain $K_p$ is assumed to be correctly tuned to a value that is compatible with an optimal response. The engineer's task is now to determine the derivative gain $K_d$ that specifically minimizes the Integral of Time-weighted Absolute Error (ITAE), defined as $\\int_{0}^{\\infty} t|e(t)|dt$, for the angular position error $e(t)$ in response to a step load disturbance of magnitude $D_0$, i.e., $D(s) = D_0/s$.\n\nFor a system whose response error is governed by a third-order characteristic polynomial of the form $s^3 + c_2 s^2 + c_1 s + c_0$, it is a known result from control theory that the ITAE criterion is minimized when the coefficients satisfy the relationships of the standard form $s^3 + 1.75\\omega_0 s^2 + 2.15\\omega_0^2 s + \\omega_0^3$ for some characteristic frequency $\\omega_0$.\n\nDetermine the analytical expression for the optimal derivative gain $K_d$ in terms of the given system parameters $a$, $B$, and $K_i$.", "solution": "The unity-feedback loop has plant $P(s)=\\frac{B}{s(s+a)}$ and controller $C(s)=K_{p}+\\frac{K_{i}}{s}+K_{d}s$. The load disturbance $D(s)$ is summed at the plant input. With a zero reference for disturbance rejection, the error is $e(t)= -y(t)$, and in the Laplace domain\n$$\ny(s)=P(s)\\big(C(s)e(s)+D(s)\\big),\\qquad e(s)=-y(s).\n$$\nSubstituting $y(s)=-e(s)$ gives\n$$\n-e(s)=P(s)\\big(C(s)e(s)+D(s)\\big)\\;\\;\\Rightarrow\\;\\;e(s)\\big(1+P(s)C(s)\\big)=-P(s)D(s).\n$$\nThus the error dynamics are governed by the closed-loop characteristic equation\n$$\n1+P(s)C(s)=0.\n$$\nCompute $P(s)C(s)$:\n$$\nP(s)C(s)=\\frac{B}{s(s+a)}\\left(K_{p}+\\frac{K_{i}}{s}+K_{d}s\\right).\n$$\nThe characteristic equation is\n$$\n1+\\frac{B}{s(s+a)}\\left(K_{p}+\\frac{K_{i}}{s}+K_{d}s\\right)=0.\n$$\nMultiplying by $s(s+a)$ and then by $s$ to clear the fraction yields\n$$\ns^{2}(s+a)+B\\big(K_{p}s+K_{i}+K_{d}s^{2}\\big)=0.\n$$\nCollecting powers of $s$ gives the third-order characteristic polynomial\n$$\ns^{3}+(a+BK_{d})s^{2}+(BK_{p})s+(BK_{i})=0.\n$$\nBy the given ITAE optimality result, the error-optimal third-order form is\n$$\ns^{3}+1.75\\,\\omega_{0}\\,s^{2}+2.15\\,\\omega_{0}^{2}\\,s+\\omega_{0}^{3}=0,\n$$\nfor some $\\omega_{0}$. Equating coefficients gives\n$$\na+BK_{d}=1.75\\,\\omega_{0},\\qquad BK_{p}=2.15\\,\\omega_{0}^{2},\\qquad BK_{i}=\\omega_{0}^{3}.\n$$\nFrom $BK_{i}=\\omega_{0}^{3}$ we obtain\n$$\n\\omega_{0}=(BK_{i})^{\\frac{1}{3}}.\n$$\nSubstituting this into $a+BK_{d}=1.75\\,\\omega_{0}$ and solving for $K_{d}$ yields\n$$\nK_{d}=\\frac{1.75\\,(BK_{i})^{\\frac{1}{3}}-a}{B}.\n$$\nThis expression depends only on the given parameters $a$, $B$, and $K_{i}$ and is independent of the disturbance magnitude $D_{0}$, as expected because the closed-loop poles determine the error dynamics.", "answer": "$$\\boxed{\\frac{1.75\\,(B K_{i})^{\\frac{1}{3}}-a}{B}}$$", "id": "1572081"}]}