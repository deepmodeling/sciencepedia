{"hands_on_practices": [{"introduction": "The cornerstone of Large Eddy Simulation (LES) is the spatial filtering operation, which formally separates large, energy-carrying eddies from smaller, unresolved ones. This first practice provides a concrete, hands-on calculation to demystify what it means to \"filter\" a velocity field. By applying a simple top-hat filter to a quadratic velocity profile, you will see how the original flow is modified and understand the direct impact of the filter width, $\\Delta$, on the resulting large-scale flow [@problem_id:1770693].", "problem": "In the field of computational fluid dynamics, Large Eddy Simulation (LES) is a powerful technique for modeling turbulent flows. A core concept in LES is the decomposition of the flow into large, resolved scales and small, subgrid scales through a filtering process.\n\nConsider a simplified one-dimensional velocity field along the $x$-axis, which is described by the parabolic profile $u(x) = A x^2$. Here, $A$ is a positive constant with the appropriate units to ensure $u(x)$ has dimensions of velocity.\n\nTo separate the scales, a one-dimensional top-hat filter (also known as a box filter) is applied. The filtering operation defines the large-scale, or filtered, velocity field $\\bar{u}(x)$ as the spatial average of $u(x)$ over a region of width $\\Delta$. The mathematical definition of this filtering process at a point $x$ is given by:\n$$ \\bar{u}(x) = \\frac{1}{\\Delta} \\int_{x - \\Delta/2}^{x + \\Delta/2} u(x') \\, dx' $$\nIn this expression, $\\Delta$ is the constant filter width, which typically corresponds to the grid size of the simulation.\n\nDetermine the analytical expression for the filtered velocity field, $\\bar{u}(x)$, that results from applying the top-hat filter to the given velocity profile. Your final answer should be expressed in terms of the parameters $A$, $x$, and $\\Delta$.", "solution": "We apply the top-hat filter definition to the given velocity field. With $u(x')=A x'^{2}$, the filtered field is\n$$\n\\bar{u}(x)=\\frac{1}{\\Delta}\\int_{x-\\Delta/2}^{x+\\Delta/2}A x'^{2}\\,dx'=\\frac{A}{\\Delta}\\left[\\frac{x'^{3}}{3}\\right]_{x-\\Delta/2}^{x+\\Delta/2}=\\frac{A}{3\\Delta}\\left((x+\\tfrac{\\Delta}{2})^{3}-(x-\\tfrac{\\Delta}{2})^{3}\\right).\n$$\nUsing the binomial expansions,\n$$\n(x+h)^{3}=x^{3}+3x^{2}h+3x h^{2}+h^{3},\\quad (x-h)^{3}=x^{3}-3x^{2}h+3x h^{2}-h^{3},\n$$\ntheir difference is\n$$\n(x+h)^{3}-(x-h)^{3}=6x^{2}h+2h^{3}.\n$$\nSetting $h=\\Delta/2$ gives\n$$\n(x+\\tfrac{\\Delta}{2})^{3}-(x-\\tfrac{\\Delta}{2})^{3}=6x^{2}\\left(\\tfrac{\\Delta}{2}\\right)+2\\left(\\tfrac{\\Delta}{2}\\right)^{3}=3\\Delta x^{2}+\\frac{\\Delta^{3}}{4}.\n$$\nSubstituting back,\n$$\n\\bar{u}(x)=\\frac{A}{3\\Delta}\\left(3\\Delta x^{2}+\\frac{\\Delta^{3}}{4}\\right)=A x^{2}+\\frac{A\\Delta^{2}}{12}.\n$$\nThus the filtered velocity field is the original parabolic profile plus a constant offset that depends on the filter width.", "answer": "$$\\boxed{A x^{2}+\\frac{A\\Delta^{2}}{12}}$$", "id": "1770693"}, {"introduction": "After filtering the flow, the next step in LES is to model the effect of the small scales on the resolved ones, which almost always requires the resolved-scale strain rate tensor, $\\bar{S}_{ij}$, as an input. This tensor quantifies the rate of deformation of the large eddies, a physical process that governs the transfer of energy across scales. This practice bridges the gap by having you calculate the components of $\\bar{S}_{ij}$ for a given large-scale flow, a necessary skill for applying subgrid-scale models [@problem_id:1770663].", "problem": "In the field of computational fluid dynamics, Large Eddy Simulation (LES) is a powerful technique for modeling turbulent flows. In LES, the flow variables are decomposed into a \"resolved\" part, representing large-scale fluid motions, and a \"subgrid-scale\" part, representing the smaller scales. A key quantity for modeling the subgrid-scale effects is the resolved-scale strain rate tensor, $\\bar{S}_{ij}$, which characterizes the rate of deformation of fluid elements at the resolved scale.\n\nConsider a simplified two-dimensional, incompressible, steady-state filtered flow field, representing the resolved flow within a plane channel. In a Cartesian coordinate system $(x_1, x_2)$, the filtered velocity components are given by:\n$$\n\\bar{u}_1(x_2) = U_0 \\left( 1 - \\left(\\frac{x_2}{H}\\right)^4 \\right)\n$$\n$$\n\\bar{u}_2(x_1, x_2) = 0\n$$\nwhere $U_0$ is the maximum velocity at the centerline and $H$ is the channel half-height. Both $U_0$ and $H$ are positive constants.\n\nThe resolved-scale strain rate tensor $\\bar{S}_{ij}$ is defined as the symmetric part of the velocity gradient tensor:\n$$\n\\bar{S}_{ij} = \\frac{1}{2} \\left( \\frac{\\partial \\bar{u}_i}{\\partial x_j} + \\frac{\\partial \\bar{u}_j}{\\partial x_i} \\right)\n$$\nwhere $i$ and $j$ can be 1 or 2.\n\nDetermine all components of the resolved-scale strain rate tensor $\\bar{\\mathbf{S}}$ as a function of the given parameters. Present your answer as a 2x2 matrix.", "solution": "The resolved velocity field is two-dimensional and steady with components $\\bar{u}_{1}(x_{2})=U_{0}\\left(1-\\left(\\frac{x_{2}}{H}\\right)^{4}\\right)$ and $\\bar{u}_{2}(x_{1},x_{2})=0$, where $U_{0}$ and $H$ are constants. The resolved-scale strain rate tensor is defined by\n$$\n\\bar{S}_{ij}=\\frac{1}{2}\\left(\\frac{\\partial \\bar{u}_{i}}{\\partial x_{j}}+\\frac{\\partial \\bar{u}_{j}}{\\partial x_{i}}\\right).\n$$\nFirst compute the velocity gradients. Since $\\bar{u}_{1}$ depends only on $x_{2}$,\n$$\n\\frac{\\partial \\bar{u}_{1}}{\\partial x_{1}}=0,\\qquad \\frac{\\partial \\bar{u}_{1}}{\\partial x_{2}}=\\frac{d}{dx_{2}}\\left[U_{0}\\left(1-\\left(\\frac{x_{2}}{H}\\right)^{4}\\right)\\right]=-U_{0}\\cdot 4\\frac{x_{2}^{3}}{H^{4}}=-\\frac{4U_{0}x_{2}^{3}}{H^{4}}.\n$$\nBecause $\\bar{u}_{2}=0$,\n$$\n\\frac{\\partial \\bar{u}_{2}}{\\partial x_{1}}=0,\\qquad \\frac{\\partial \\bar{u}_{2}}{\\partial x_{2}}=0.\n$$\nNow apply the definition of $\\bar{S}_{ij}$ componentwise:\n$$\n\\bar{S}_{11}=\\frac{1}{2}\\left(\\frac{\\partial \\bar{u}_{1}}{\\partial x_{1}}+\\frac{\\partial \\bar{u}_{1}}{\\partial x_{1}}\\right)=\\frac{\\partial \\bar{u}_{1}}{\\partial x_{1}}=0,\n$$\n$$\n\\bar{S}_{22}=\\frac{1}{2}\\left(\\frac{\\partial \\bar{u}_{2}}{\\partial x_{2}}+\\frac{\\partial \\bar{u}_{2}}{\\partial x_{2}}\\right)=\\frac{\\partial \\bar{u}_{2}}{\\partial x_{2}}=0,\n$$\n$$\n\\bar{S}_{12}=\\bar{S}_{21}=\\frac{1}{2}\\left(\\frac{\\partial \\bar{u}_{1}}{\\partial x_{2}}+\\frac{\\partial \\bar{u}_{2}}{\\partial x_{1}}\\right)=\\frac{1}{2}\\left(-\\frac{4U_{0}x_{2}^{3}}{H^{4}}+0\\right)=-\\frac{2U_{0}x_{2}^{3}}{H^{4}}.\n$$\nTherefore, the resolved-scale strain rate tensor as a $2\\times 2$ matrix is\n$$\n\\begin{pmatrix}\n0 & -\\frac{2U_{0}x_{2}^{3}}{H^{4}} \\\\\n-\\frac{2U_{0}x_{2}^{3}}{H^{4}} & 0\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0 & -\\frac{2U_{0}x_{2}^{3}}{H^{4}} \\\\ -\\frac{2U_{0}x_{2}^{3}}{H^{4}} & 0\\end{pmatrix}}$$", "id": "1770663"}, {"introduction": "We now arrive at the heart of subgrid-scale modeling: calculating the eddy viscosity that parameterizes the effect of the unresolved turbulence. The Smagorinsky model is a foundational approach that relates the subgrid-scale viscosity, $\\nu_{sgs}$, to the magnitude of the resolved strain rate tensor. This final practice will guide you through calculating $\\nu_{sgs}$ for a simple shear flow, illustrating how a physical quantity representing small-scale dissipation is generated from the properties of the large-scale flow [@problem_id:1770682].", "problem": "In the field of computational fluid dynamics, Large Eddy Simulation (LES) is a turbulence modeling technique that separates the large-scale turbulent eddies, which are resolved directly, from the small-scale eddies, which are modeled. The effect of these small, unresolved scales on the resolved flow is incorporated through a subgrid-scale (SGS) stress tensor. A common approach to model this tensor is the Boussinesq hypothesis, which relates the SGS stress to the resolved strain rate tensor via an SGS eddy viscosity, $\\nu_{sgs}$.\n\nOne of the foundational models for this eddy viscosity is the Smagorinsky model, given by the expression:\n$$\n\\nu_{sgs} = (C_s \\Delta)^2 \\sqrt{2 \\bar{S}_{ij} \\bar{S}_{ij}}\n$$\nwhere $C_s$ is the dimensionless Smagorinsky constant, $\\Delta$ is the filter width (a characteristic length scale of the computational grid), and $\\bar{S}_{ij}$ is the resolved strain rate tensor. For an incompressible flow with velocity components $\\bar{u}_i$ in the directions $x_i = (x, y, z)$, the strain rate tensor is defined as $\\bar{S}_{ij} = \\frac{1}{2}\\left(\\frac{\\partial \\bar{u}_i}{\\partial x_j} + \\frac{\\partial \\bar{u}_j}{\\partial x_i}\\right)$. The term $\\bar{S}_{ij} \\bar{S}_{ij}$ implies summation over repeated indices (Einstein notation).\n\nConsider a simple, steady, two-dimensional shear flow in a Cartesian coordinate system, where the velocity field is given by $\\vec{v} = (u,v,w)$ with components $u = S y$, $v=0$, and $w=0$. The quantity $S$ is a constant, positive shear rate. For the purpose of this analysis, assume that the filtering operation inherent in LES does not alter this linear velocity profile, such that the resolved velocity field is identical to the given field (i.e., $\\bar{u}_i = u_i$).\n\nBased on this information, derive an expression for the subgrid-scale viscosity $\\nu_{sgs}$ in this simple shear flow. Your final answer should be expressed in terms of the shear rate $S$, the Smagorinsky constant $C_s$, and the filter width $\\Delta$.", "solution": "We use the Smagorinsky subgrid-scale viscosity model\n$$\n\\nu_{sgs} = (C_{s}\\Delta)^{2}\\sqrt{2\\,\\bar{S}_{ij}\\bar{S}_{ij}},\n$$\nwhere the resolved strain rate tensor is defined for incompressible flow as\n$$\n\\bar{S}_{ij}=\\frac{1}{2}\\left(\\frac{\\partial \\bar{u}_{i}}{\\partial x_{j}}+\\frac{\\partial \\bar{u}_{j}}{\\partial x_{i}}\\right).\n$$\nThe given velocity field is $u_{1}=u=S\\,y$, $u_{2}=v=0$, $u_{3}=w=0$, with $x_{1}=x$, $x_{2}=y$, $x_{3}=z$, and the filtering operation does not alter the field, so $\\bar{u}_{i}=u_{i}$. The nonzero velocity gradients are\n$$\n\\frac{\\partial u_{1}}{\\partial x_{2}}=S,\\quad \\frac{\\partial u_{1}}{\\partial x_{1}}=\\frac{\\partial u_{1}}{\\partial x_{3}}=\\frac{\\partial u_{2}}{\\partial x_{j}}=\\frac{\\partial u_{3}}{\\partial x_{j}}=0.\n$$\nUsing the definition of $\\bar{S}_{ij}$, the only nonzero components are\n$$\n\\bar{S}_{12}=\\bar{S}_{21}=\\frac{1}{2}\\left(\\frac{\\partial u_{1}}{\\partial x_{2}}+\\frac{\\partial u_{2}}{\\partial x_{1}}\\right)=\\frac{S}{2},\n$$\nwhile all diagonal and other off-diagonal components vanish. The contraction is then\n$$\n\\bar{S}_{ij}\\bar{S}_{ij}=\\bar{S}_{12}^{2}+\\bar{S}_{21}^{2}=2\\left(\\frac{S}{2}\\right)^{2}=\\frac{S^{2}}{2}.\n$$\nTherefore,\n$$\n\\sqrt{2\\,\\bar{S}_{ij}\\bar{S}_{ij}}=\\sqrt{2\\cdot\\frac{S^{2}}{2}}=|S|.\n$$\nSince the given shear rate $S$ is specified to be positive, $|S|=S$. Substituting into the Smagorinsky model yields\n$$\n\\nu_{sgs}=(C_{s}\\Delta)^{2}S.\n$$", "answer": "$$\\boxed{(C_{s}\\Delta)^{2}S}$$", "id": "1770682"}]}