{"hands_on_practices": [{"introduction": "The first step in any Computational Fluid Dynamics (CFD) analysis is to transform continuous partial differential equations into a system of algebraic equations that a computer can solve. This process, called discretization, can introduce artifacts if not performed carefully. This exercise [@problem_id:1764340] explores the popular central difference scheme for the convection-diffusion equation. It demonstrates how a simple analysis can reveal the conditions under which the scheme might produce unphysical oscillations, introducing the crucial concept of the cell Péclet number, $Pe$.", "problem": "In the field of Computational Fluid Dynamics (CFD), a central challenge is the accurate numerical solution of transport equations. Consider the one-dimensional, steady-state convection-diffusion equation for a scalar quantity $\\phi$, such as the concentration of a pollutant in a narrow channel with a steady, uniform fluid flow. The governing equation in its non-conservative form is given by:\n$$u \\frac{d\\phi}{dx} - \\Gamma \\frac{d^2\\phi}{dx^2} = 0$$\nHere, $u$ is the constant, positive fluid velocity, $\\Gamma$ is the constant, positive diffusion coefficient, and $x$ is the spatial coordinate.\n\nTo solve this equation numerically, we discretize it on a uniform grid with nodes indexed by $i$. The location of node $i$ is $x_i$, and the constant spacing between adjacent nodes is $\\Delta x = x_{i+1} - x_i$. We will use the finite difference method, approximating both the first derivative (convection term) and the second derivative (diffusion term) with second-order central difference schemes.\n\nThe resulting algebraic equation for any interior node $i$ can be rearranged into the following general form, which relates the value at a node to its immediate neighbors:\n$$a_P \\phi_i = a_W \\phi_{i-1} + a_E \\phi_{i+1}$$\nIn this convention, the subscripts $P$, $W$, and $E$ refer to the central (\"P\"oint), west ($i-1$), and east ($i+1$) nodes, respectively.\n\nA critical requirement for a numerical scheme to produce physically realistic solutions (i.e., avoiding unphysical oscillations) is that the coefficients linking a node to its neighbors ($a_W$ and $a_E$) must be non-negative.\n\nBy discretizing the governing equation as described, determine the maximum value of the dimensionless cell Péclet number, defined as $Pe = \\frac{u \\Delta x}{\\Gamma}$, for which this non-negativity condition on the coefficients $a_W$ and $a_E$ is satisfied.", "solution": "We start from the steady one-dimensional convection-diffusion equation\n$$u \\frac{d\\phi}{dx} - \\Gamma \\frac{d^{2}\\phi}{dx^{2}} = 0,$$\nwith constant $u>0$, $\\Gamma>0$, and a uniform grid with spacing $\\Delta x$.\n\nUsing second-order central differences at node $i$,\n$$\\left.\\frac{d\\phi}{dx}\\right|_{i} \\approx \\frac{\\phi_{i+1} - \\phi_{i-1}}{2 \\Delta x}, \\qquad \\left.\\frac{d^{2}\\phi}{dx^{2}}\\right|_{i} \\approx \\frac{\\phi_{i+1} - 2 \\phi_{i} + \\phi_{i-1}}{\\Delta x^{2}}.$$\nSubstituting into the differential equation gives\n$$u \\frac{\\phi_{i+1} - \\phi_{i-1}}{2 \\Delta x} - \\Gamma \\frac{\\phi_{i+1} - 2 \\phi_{i} + \\phi_{i-1}}{\\Delta x^{2}} = 0.$$\nExpanding and regrouping,\n$$\\frac{\\Gamma}{\\Delta x^{2}} \\phi_{i+1} - \\frac{2 \\Gamma}{\\Delta x^{2}} \\phi_{i} + \\frac{\\Gamma}{\\Delta x^{2}} \\phi_{i-1} - \\frac{u}{2 \\Delta x} \\phi_{i+1} + \\frac{u}{2 \\Delta x} \\phi_{i-1} = 0.$$\nMove the neighbor terms to the right-hand side to match the form $a_{P} \\phi_{i} = a_{W} \\phi_{i-1} + a_{E} \\phi_{i+1}$:\n$$\\frac{2 \\Gamma}{\\Delta x^{2}} \\phi_{i} = \\left(\\frac{\\Gamma}{\\Delta x^{2}} + \\frac{u}{2 \\Delta x}\\right) \\phi_{i-1} + \\left(\\frac{\\Gamma}{\\Delta x^{2}} - \\frac{u}{2 \\Delta x}\\right) \\phi_{i+1}.$$\nHence,\n$$a_{P} = \\frac{2 \\Gamma}{\\Delta x^{2}}, \\quad a_{W} = \\frac{\\Gamma}{\\Delta x^{2}} + \\frac{u}{2 \\Delta x}, \\quad a_{E} = \\frac{\\Gamma}{\\Delta x^{2}} - \\frac{u}{2 \\Delta x}.$$\n\nThe non-negativity requirement for the neighbor coefficients is\n$$a_{W} \\ge 0, \\qquad a_{E} \\ge 0.$$\nSince $u>0$, $\\Gamma>0$, and $\\Delta x>0$, we have $a_{W} > 0$ automatically. The binding condition is $a_{E} \\ge 0$, i.e.,\n$$\\frac{\\Gamma}{\\Delta x^{2}} - \\frac{u}{2 \\Delta x} \\ge 0 \\quad \\Longleftrightarrow \\quad \\frac{u \\Delta x}{\\Gamma} \\le 2.$$\nDefining the cell Péclet number $Pe = \\frac{u \\Delta x}{\\Gamma}$, the maximum value that ensures non-negative $a_{W}$ and $a_{E}$ is\n$$Pe_{\\max} = 2.$$", "answer": "$$\\boxed{2}$$", "id": "1764340"}, {"introduction": "Real-world engineering problems rarely involve simple rectangular domains, requiring methods that can handle complex geometries. The finite volume method is a powerful approach that addresses this by discretizing the domain into a mesh of arbitrary control volumes. This practice [@problem_id:1764386] requires you to apply the fundamental integral mass conservation law to a single hexagonal cell, providing direct, hands-on experience with the core principle that allows CFD to accurately model flow in intricate systems like braided rivers or over complex aerodynamic bodies.", "problem": "In the development of a 2D Computational Fluid Dynamics (CFD) model for a shallow river system, the domain is discretized into a mesh of regular hexagonal control volumes. We will analyze the mass conservation for a single such control volume.\n\nThe control volume is a regular hexagon of side length $L$, centered at the origin $(0,0)$ of a Cartesian coordinate system. Its vertices are located at $(L, 0)$, $(L/2, \\sqrt{3}L/2)$, $(-L/2, \\sqrt{3}L/2)$, $(-L, 0)$, $(-L/2, -\\sqrt{3}L/2)$, and $(L/2, -\\sqrt{3}L/2)$. We assume the model is two-dimensional, which corresponds to analyzing a slice of the flow with a uniform unit depth. The spatially-averaged density of the fluid within this control volume is denoted by $\\rho_P$.\n\nThe faces of the hexagon are numbered 1 to 6 in a counter-clockwise direction, where face 1 is the horizontal face located in the upper half-plane ($y>0$). For the purpose of numerical approximation, the flow properties are considered uniform over each face. For each face $i$ (where $i=1, \\dots, 6$), the fluid density is $\\rho_i$ and the velocity vector is given by $\\vec{v}_i = u_i \\hat{i} + v_i \\hat{j}$.\n\nBased on these definitions, derive an expression for the time rate of change of the average density within the control volume, $\\frac{d\\rho_P}{dt}$. Your answer should be a single analytical expression in terms of $L$, and the face properties $\\{\\rho_i, u_i, v_i\\}$ for $i=1, \\dots, 6$.", "solution": "We use integral mass conservation over a fixed control volume in two dimensions with unit depth:\n$$\\frac{d}{dt}\\int_{A}\\rho\\,dA+\\oint_{\\partial A}\\rho\\,\\vec{v}\\cdot\\vec{n}\\,dl=0.$$\nDefining the area average $\\rho_{P}$ by $\\int_{A}\\rho\\,dA=A\\,\\rho_{P}$ (with fixed area), we obtain\n$$A\\,\\frac{d\\rho_{P}}{dt}+\\sum_{i=1}^{6}\\rho_{i}\\,\\vec{v}_{i}\\cdot\\vec{n}_{i}\\,l_{i}=0,$$\nwhere $l_{i}$ is the length of face $i$ and $\\vec{n}_{i}$ is its outward unit normal. For a regular hexagon of side length $L$, each face has length $l_{i}=L$. The area of a regular hexagon with side $L$ is\n$$A=6\\left(\\frac{\\sqrt{3}}{4}L^{2}\\right)=\\frac{3\\sqrt{3}}{2}\\,L^{2}.$$\nHence\n$$\\frac{d\\rho_{P}}{dt}=-\\frac{L}{A}\\sum_{i=1}^{6}\\rho_{i}\\,\\vec{v}_{i}\\cdot\\vec{n}_{i}=-\\frac{2}{3\\sqrt{3}\\,L}\\sum_{i=1}^{6}\\rho_{i}\\,\\vec{v}_{i}\\cdot\\vec{n}_{i}.$$\nNumber faces counter-clockwise with face 1 the horizontal top edge. The outward unit normals for the six faces are\n$$\\vec{n}_{1}=(0,1),\\quad \\vec{n}_{2}=\\left(-\\frac{\\sqrt{3}}{2},\\frac{1}{2}\\right),\\quad \\vec{n}_{3}=\\left(-\\frac{\\sqrt{3}}{2},-\\frac{1}{2}\\right),$$\n$$\\vec{n}_{4}=(0,-1),\\quad \\vec{n}_{5}=\\left(\\frac{\\sqrt{3}}{2},-\\frac{1}{2}\\right),\\quad \\vec{n}_{6}=\\left(\\frac{\\sqrt{3}}{2},\\frac{1}{2}\\right).$$\nWriting $\\vec{v}_{i}=u_{i}\\hat{i}+v_{i}\\hat{j}$ and taking dot products yields\n$$\\sum_{i=1}^{6}\\rho_{i}\\,\\vec{v}_{i}\\cdot\\vec{n}_{i}=\\rho_{1}v_{1}+\\rho_{2}\\left(-\\frac{\\sqrt{3}}{2}u_{2}+\\frac{1}{2}v_{2}\\right)+\\rho_{3}\\left(-\\frac{\\sqrt{3}}{2}u_{3}-\\frac{1}{2}v_{3}\\right)-\\rho_{4}v_{4}+\\rho_{5}\\left(\\frac{\\sqrt{3}}{2}u_{5}-\\frac{1}{2}v_{5}\\right)+\\rho_{6}\\left(\\frac{\\sqrt{3}}{2}u_{6}+\\frac{1}{2}v_{6}\\right).$$\nSubstituting and removing the halves by a common factor gives the compact expression\n$$\\frac{d\\rho_{P}}{dt}=-\\frac{1}{3\\sqrt{3}\\,L}\\Big[2\\rho_{1}v_{1}+\\rho_{2}(-\\sqrt{3}\\,u_{2}+v_{2})+\\rho_{3}(-\\sqrt{3}\\,u_{3}-v_{3})-2\\rho_{4}v_{4}+\\rho_{5}(\\sqrt{3}\\,u_{5}-v_{5})+\\rho_{6}(\\sqrt{3}\\,u_{6}+v_{6})\\Big].$$\nThis expression is the requested time rate of change of the average density in terms of $L$ and the face properties.", "answer": "$$\\boxed{-\\frac{1}{3\\sqrt{3}\\,L}\\left[2\\rho_{1}v_{1}+\\rho_{2}\\left(-\\sqrt{3}\\,u_{2}+v_{2}\\right)+\\rho_{3}\\left(-\\sqrt{3}\\,u_{3}-v_{3}\\right)-2\\rho_{4}v_{4}+\\rho_{5}\\left(\\sqrt{3}\\,u_{5}-v_{5}\\right)+\\rho_{6}\\left(\\sqrt{3}\\,u_{6}+v_{6}\\right)\\right]}$$", "id": "1764386"}, {"introduction": "Writing a CFD solver is only half the battle; ensuring its correctness is equally critical. The Method of Manufactured Solutions (MMS) is a rigorous and elegant technique for verifying that a code solves the intended equations to the expected order of accuracy. In this exercise [@problem_id:1764341], you will step into the shoes of a CFD developer and perform the key step of MMS: deriving the necessary source term from a chosen \"manufactured\" solution. This is a fundamental practice in the professional development and verification of computational software.", "problem": "In the field of Computational Fluid Dynamics (CFD), the Method of Manufactured Solutions (MMS) is a rigorous procedure for verifying the correctness of a numerical solver's implementation. This method involves choosing a non-trivial analytical function as a \"manufactured\" solution to the governing partial differential equation. This function is then substituted into the equation to determine the corresponding source term that would make the equation hold true. This source term is then programmed into the CFD code, and the numerical result is compared against the known manufactured solution to assess the order of accuracy of the solver.\n\nAs a CFD developer, you are tasked with creating a verification case for a new solver that handles the steady-state, two-dimensional convection-diffusion equation for a scalar quantity $\\phi(x,y)$. The governing equation is given by:\n$$U \\frac{\\partial \\phi}{\\partial x} + V \\frac{\\partial \\phi}{\\partial y} = \\Gamma \\left( \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2} \\right) + S_\\phi(x,y)$$\nHere, $U$ and $V$ are the constant velocity components in the $x$ and $y$ directions, respectively, and $\\Gamma$ is the constant diffusion coefficient. $S_\\phi(x,y)$ is the source term per unit volume.\n\nYou have selected the following manufactured solution:\n$$\\phi_m(x,y) = A \\sin(k_x x) \\exp(-\\alpha y) + C x^2 y$$\nwhere $A, C, k_x$, and $\\alpha$ are known, non-zero constants.\n\nYour task is to determine the analytical expression for the source term, $S_\\phi(x,y)$, that must be implemented in the code so that $\\phi_m(x,y)$ is an exact solution to the governing convection-diffusion equation. Provide the complete expression for $S_\\phi(x,y)$ in terms of $x, y$, and the given constants $U, V, \\Gamma, A, C, k_x$, and $\\alpha$.", "solution": "We start from the steady two-dimensional convection-diffusion equation for a scalar field $\\phi(x,y)$ with constant coefficients:\n$$\nU \\frac{\\partial \\phi}{\\partial x} + V \\frac{\\partial \\phi}{\\partial y} = \\Gamma \\left( \\frac{\\partial^{2} \\phi}{\\partial x^{2}} + \\frac{\\partial^{2} \\phi}{\\partial y^{2}} \\right) + S_{\\phi}(x,y).\n$$\nGiven the manufactured solution\n$$\n\\phi_{m}(x,y) = A \\sin(k_{x} x) \\exp(-\\alpha y) + C x^{2} y,\n$$\nthe source term that makes $\\phi_{m}$ an exact solution is obtained by substituting $\\phi_{m}$ into the governing equation and solving for $S_{\\phi}(x,y)$:\n$$\nS_{\\phi}(x,y) = U \\frac{\\partial \\phi_{m}}{\\partial x} + V \\frac{\\partial \\phi_{m}}{\\partial y} - \\Gamma \\left( \\frac{\\partial^{2} \\phi_{m}}{\\partial x^{2}} + \\frac{\\partial^{2} \\phi_{m}}{\\partial y^{2}} \\right).\n$$\n\nCompute the required derivatives. First derivatives:\n$$\n\\frac{\\partial \\phi_{m}}{\\partial x} = A k_{x} \\cos(k_{x} x) \\exp(-\\alpha y) + 2 C x y,\n$$\n$$\n\\frac{\\partial \\phi_{m}}{\\partial y} = -\\alpha A \\sin(k_{x} x) \\exp(-\\alpha y) + C x^{2}.\n$$\n\nSecond derivatives:\n$$\n\\frac{\\partial^{2} \\phi_{m}}{\\partial x^{2}} = -A k_{x}^{2} \\sin(k_{x} x) \\exp(-\\alpha y) + 2 C y,\n$$\n$$\n\\frac{\\partial^{2} \\phi_{m}}{\\partial y^{2}} = \\alpha^{2} A \\sin(k_{x} x) \\exp(-\\alpha y).\n$$\n\nForm the Laplacian:\n$$\n\\frac{\\partial^{2} \\phi_{m}}{\\partial x^{2}} + \\frac{\\partial^{2} \\phi_{m}}{\\partial y^{2}} = A (\\alpha^{2} - k_{x}^{2}) \\sin(k_{x} x) \\exp(-\\alpha y) + 2 C y.\n$$\n\nCompute the convective term:\n$$\nU \\frac{\\partial \\phi_{m}}{\\partial x} + V \\frac{\\partial \\phi_{m}}{\\partial y} = A \\exp(-\\alpha y) \\left[ U k_{x} \\cos(k_{x} x) - V \\alpha \\sin(k_{x} x) \\right] + 2 U C x y + V C x^{2}.\n$$\n\nSubstitute into the expression for $S_{\\phi}(x,y)$:\n$$\nS_{\\phi}(x,y) = A \\exp(-\\alpha y) \\left[ U k_{x} \\cos(k_{x} x) - V \\alpha \\sin(k_{x} x) \\right] + 2 U C x y + V C x^{2} - \\Gamma \\left[ A (\\alpha^{2} - k_{x}^{2}) \\sin(k_{x} x) \\exp(-\\alpha y) + 2 C y \\right].\n$$\n\nCombine terms multiplying the common factors to obtain a compact form:\n$$\nS_{\\phi}(x,y) = A \\exp(-\\alpha y) \\left[ U k_{x} \\cos(k_{x} x) + \\left( \\Gamma (k_{x}^{2} - \\alpha^{2}) - V \\alpha \\right) \\sin(k_{x} x) \\right] + C \\left( 2 U x y + V x^{2} - 2 \\Gamma y \\right).\n$$\nThis is the required analytical source term expressed in terms of $x$, $y$, and the constants $U, V, \\Gamma, A, C, k_{x}$, and $\\alpha$.", "answer": "$$\\boxed{A \\exp(-\\alpha y) \\left[ U k_{x} \\cos(k_{x} x) + \\left( \\Gamma (k_{x}^{2} - \\alpha^{2}) - V \\alpha \\right) \\sin(k_{x} x) \\right] + C \\left( 2 U x y + V x^{2} - 2 \\Gamma y \\right)}$$", "id": "1764341"}]}