{"hands_on_practices": [{"introduction": "To build a solid understanding of the Finite Volume Method (FVM), we begin with its most fundamental application. This first practice guides you through the discretization of a simple, one-dimensional pure diffusion equation on a uniform grid. By applying the core FVM principle of integral conservation, you will derive the algebraic equation linking a node to its neighbors and, in doing so, reveal the connection between FVM and the familiar central differencing formula, providing an essential foundation for your learning [@problem_id:1749431].", "problem": "Consider a one-dimensional, steady-state physical system where a scalar quantity $\\phi$ diffuses through a medium. The process is governed by the pure diffusion equation:\n$$ \\frac{d}{dx} \\left( \\Gamma \\frac{d\\phi}{dx} \\right) = 0 $$\nwhere $\\Gamma$ is the diffusion coefficient, which is assumed to be constant.\n\nThis physical domain is discretized into a uniform one-dimensional grid with a constant spacing of $\\Delta x$ between adjacent nodes. We wish to find the algebraic equation for a generic internal node $P$ (also denoted by index $i$) using the Finite Volume Method (FVM). The control volume for node $P$ is centered on the node and its boundaries (faces) are located at positions $x_P - \\frac{\\Delta x}{2}$ and $x_P + \\frac{\\Delta x}{2}$. The nodes adjacent to $P$ are the west node $W$ (index $i-1$) and the east node $E$ (index $i+1$).\n\nFollowing the FVM procedure, which involves integrating the governing equation over the control volume and approximating the fluxes at the faces, derive the resulting algebraic equation. The gradients at the control volume faces should be approximated using the values at the two nearest nodes. For example, the gradient at the east face between nodes $P$ and $E$ is approximated as $\\frac{\\phi_E - \\phi_P}{\\Delta x}$.\n\nThe final algebraic equation should be written in the standard form:\n$$ a_P \\phi_P = a_W \\phi_W + a_E \\phi_E $$\nTo ensure a unique set of coefficients, the equation must be normalized such that $a_W = \\frac{\\Gamma}{\\Delta x}$.\n\nBased on this formulation, determine the expressions for the coefficients $a_P$ and $a_E$. Present your answer as an ordered pair of expressions $(a_P, a_E)$.", "solution": "Start from the steady one-dimensional diffusion equation with constant diffusion coefficient:\n$$\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right)=0.$$\nIntegrate over the control volume of node $P$, whose faces are at $x_{w}=x_{P}-\\frac{\\Delta x}{2}$ and $x_{e}=x_{P}+\\frac{\\Delta x}{2}$:\n$$\\int_{x_{w}}^{x_{e}}\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right)\\,dx=\\left[\\Gamma \\frac{d\\phi}{dx}\\right]_{e}-\\left[\\Gamma \\frac{d\\phi}{dx}\\right]_{w}=0.$$\nApproximate the face gradients using the two nearest nodes on a uniform grid:\n$$(\\partial\\phi/\\partial x)_{e}\\approx\\frac{\\phi_{E}-\\phi_{P}}{\\Delta x},\\qquad(\\partial\\phi/\\partial x)_{w}\\approx\\frac{\\phi_{P}-\\phi_{W}}{\\Delta x}.$$\nSubstitute these into the integrated balance:\n$$\\Gamma\\frac{\\phi_{E}-\\phi_{P}}{\\Delta x}-\\Gamma\\frac{\\phi_{P}-\\phi_{W}}{\\Delta x}=0.$$\nRearrange to obtain the algebraic equation:\n$$\\frac{\\Gamma}{\\Delta x}\\,\\phi_{E}+\\frac{\\Gamma}{\\Delta x}\\,\\phi_{W}=2\\,\\frac{\\Gamma}{\\Delta x}\\,\\phi_{P}.$$\nMatch this to the standard form $a_{P}\\phi_{P}=a_{W}\\phi_{W}+a_{E}\\phi_{E}$. With the normalization $a_{W}=\\frac{\\Gamma}{\\Delta x}$, it follows that\n$$a_{E}=\\frac{\\Gamma}{\\Delta x},\\qquad a_{P}=a_{W}+a_{E}=\\frac{2\\Gamma}{\\Delta x}.$$\nThus, the requested ordered pair is $(a_{P},a_{E})=\\left(\\frac{2\\Gamma}{\\Delta x},\\frac{\\Gamma}{\\Delta x}\\right)$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{2\\Gamma}{\\Delta x} & \\frac{\\Gamma}{\\Delta x}\\end{pmatrix}}$$", "id": "1749431"}, {"introduction": "Building upon the basic discretization, we now introduce additional physical complexity by incorporating a source term, which can represent phenomena like chemical reactions or heat generation. In this exercise, you will discretize a one-dimensional diffusion-reaction problem and, crucially, assemble the resulting algebraic equations for all unknown nodes into a complete matrix system. Mastering this process is key to translating a physical problem into the standard $[A][\\Phi]=[b]$ form, preparing it for a computational solution [@problem_id:1749401].", "problem": "Consider the one-dimensional, steady-state transport of a chemical species in a narrow, quiescent fluid channel of length $L$. The concentration of the species, denoted by $\\phi(x)$, is governed by the diffusion equation:\n$$\n\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) + S = 0\n$$\nwhere $\\Gamma$ is the constant diffusion coefficient. The species undergoes a first-order chemical reaction, leading to a source/sink term $S$ that is a linear function of the local concentration:\n$$\nS = S_C + S_P \\phi\n$$\nHere, $S_C$ and $S_P$ are constant coefficients.\n\nThe channel extends from $x=0$ to $x=L$. The concentrations at the boundaries are held constant at known values: $\\phi(0) = \\phi_A$ and $\\phi(L) = \\phi_B$.\n\nTo solve for the concentration profile, the domain is discretized into a uniform grid with five equally-spaced nodes: $x_0, x_1, x_2, x_3, x_4$, where $x_0=0$ and $x_4=L$. The concentrations at the three internal nodes, $\\phi(x_1) \\equiv \\phi_1$, $\\phi(x_2) \\equiv \\phi_2$, and $\\phi(x_3) \\equiv \\phi_3$, are unknown.\n\nApplying a central-differencing-based finite volume method to the governing equation at each internal node results in a system of three linear algebraic equations for the three unknown concentrations. This system can be written in matrix form as $[A][\\Phi] = [b]$, where $[\\Phi]$ is the column vector of unknown concentrations, $[\\Phi] = \\begin{pmatrix} \\phi_1 & \\phi_2 & \\phi_3 \\end{pmatrix}^T$.\n\nDetermine the $3 \\times 3$ coefficient matrix $[A]$. Your answer should be expressed in terms of $\\Gamma$, $L$, and $S_P$.", "solution": "The governing equation with constant diffusion coefficient is\n$$\n\\Gamma \\frac{d^{2}\\phi}{dx^{2}} + S_C + S_P \\phi = 0.\n$$\nDiscretize the domain into five equally spaced nodes with spacing $h = \\frac{L}{4}$. Using a finite volume method on a control volume of width $h$ around an internal node $i \\in \\{1,2,3\\}$, integrate the equation over the control volume and approximate face gradients by central differences:\n$$\n\\Gamma \\left[\\left.\\frac{d\\phi}{dx}\\right|_{e} - \\left.\\frac{d\\phi}{dx}\\right|_{w}\\right] + S_P \\phi_i h + S_C h = 0,\n$$\nwith\n$$\n\\left.\\frac{d\\phi}{dx}\\right|_{e} \\approx \\frac{\\phi_{i+1} - \\phi_i}{h}, \\qquad \\left.\\frac{d\\phi}{dx}\\right|_{w} \\approx \\frac{\\phi_i - \\phi_{i-1}}{h}.\n$$\nSubstituting these into the balance gives\n$$\n\\Gamma \\left[\\frac{\\phi_{i+1} - \\phi_i}{h} - \\frac{\\phi_i - \\phi_{i-1}}{h}\\right] + S_P \\phi_i h + S_C h = 0,\n$$\nwhich simplifies to\n$$\n\\frac{\\Gamma}{h}\\phi_{i-1} + \\left(-\\frac{2\\Gamma}{h} + S_P h\\right)\\phi_i + \\frac{\\Gamma}{h}\\phi_{i+1} = - S_C h.\n$$\nRearranging into the standard linear-system form $[A][\\Phi]=[b]$, move neighbor terms to the left-hand side and the constant source and boundary contributions to the right-hand side. The finite-volume coefficients for any internal node are\n$$\na_W = \\frac{\\Gamma}{h}, \\qquad a_E = \\frac{\\Gamma}{h}, \\qquad a_P = \\frac{2\\Gamma}{h} - S_P h.\n$$\nFor the $3 \\times 3$ matrix acting on $[\\Phi] = (\\phi_1,\\phi_2,\\phi_3)^{T}$, the rows correspond to nodes $i=1,2,3$. For $i=1$, the west neighbor is the boundary node $\\phi_0=\\phi_A$ (moved to the right-hand side), so only $\\phi_1$ and $\\phi_2$ appear on the left. For $i=2$, both neighbors are unknowns. For $i=3$, the east neighbor is the boundary node $\\phi_4=\\phi_B$ (moved to the right-hand side). Substituting $h=\\frac{L}{4}$ gives\n$$\na_W = a_E = \\frac{\\Gamma}{h} = \\frac{4\\Gamma}{L}, \\qquad a_P = \\frac{2\\Gamma}{h} - S_P h = \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}.\n$$\nTherefore, the coefficient matrix is\n$$\n[A] =\n\\begin{pmatrix}\n\\frac{8\\Gamma}{L} - \\frac{S_P L}{4} & -\\frac{4\\Gamma}{L} & 0 \\\\\n-\\frac{4\\Gamma}{L} & \\frac{8\\Gamma}{L} - \\frac{S_P L}{4} & -\\frac{4\\Gamma}{L} \\\\\n0 & -\\frac{4\\Gamma}{L} & \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\n\\frac{8\\Gamma}{L} - \\frac{S_{P} L}{4} & -\\frac{4\\Gamma}{L} & 0 \\\\\n-\\frac{4\\Gamma}{L} & \\frac{8\\Gamma}{L} - \\frac{S_{P} L}{4} & -\\frac{4\\Gamma}{L} \\\\\n0 & -\\frac{4\\Gamma}{L} & \\frac{8\\Gamma}{L} - \\frac{S_{P} L}{4}\n\\end{pmatrix}}$$", "id": "1749401"}, {"introduction": "Real-world simulations often involve multiple dimensions and complex geometries, necessitating non-uniform grids and efficient solution strategies. This final practice challenges you to extend the FVM to a two-dimensional domain with a non-uniform grid, a scenario far closer to engineering applications. You will then formulate an update equation for the Gauss-Seidel method [@problem_id:1749399], a powerful iterative technique used to solve the large systems of linear equations that are characteristic of computational fluid dynamics.", "problem": "Consider the two-dimensional, steady-state diffusion equation for a scalar variable $\\phi$, given by $\\nabla \\cdot (\\Gamma \\nabla \\phi) + S = 0$, where $\\Gamma$ is a constant diffusion coefficient and $S$ is a volumetric source term. This equation is being discretized on a non-uniform Cartesian grid using the Finite Volume Method (FVM).\n\nFor an internal control volume centered at a node 'P', the neighboring nodes are designated as 'W' (West), 'E' (East), 'S' (South), and 'N' (North). The grid is non-uniform, with the following node-to-node distances defined:\n- $\\delta x_{wP}$: distance from node W to node P\n- $\\delta x_{Pe}$: distance from node P to node E\n- $\\delta y_{sP}$: distance from node S to node P\n- $\\delta y_{Pn}$: distance from node P to node N\n\nThe control volume faces are positioned midway between adjacent nodes. The source term $S$ is linearized as a function of the local cell-centered value $\\phi_P$, such that $S = S_C + S_P \\phi_P$, where $S_C$ and $S_P$ are constants.\n\nThe discretization process results in a system of linear algebraic equations, which is solved iteratively. Your task is to apply the point-by-point Gauss-Seidel method to derive the update equation. The computational grid is swept in a specific order: first by increasing coordinate in the x-direction, and then by increasing coordinate in the y-direction. This implies that when updating the value at node P, the values at its West (W) and South (S) neighbors have already been computed for the current iteration $(k+1)$.\n\nDerive the algebraic expression for the updated value $\\phi_P^{(k+1)}$ at node P for iteration $(k+1)$ in terms of the neighboring values $\\phi_W$, $\\phi_E$, $\\phi_S$, $\\phi_N$, the iteration superscripts, the diffusion coefficient $\\Gamma$, the source term constants $S_C$ and $S_P$, and the geometric grid spacings.", "solution": "We start from the steady diffusion equation with a linearized source,\n$$\n\\nabla \\cdot \\left(\\Gamma \\nabla \\phi\\right) + S = 0,\\qquad S = S_{C} + S_{P}\\,\\phi_{P}.\n$$\nIntegrating over the control volume around node $P$ of area $V_{P}$ (unit thickness) and applying the divergence theorem yields\n$$\n\\sum_{f \\in \\{e,w,n,s\\}} \\Gamma \\left(\\nabla \\phi \\cdot \\boldsymbol{n}\\right)_{f} A_{f} + S_{C} V_{P} + S_{P} V_{P} \\phi_{P} = 0,\n$$\nwhere $A_{f}$ is the face length and $\\boldsymbol{n}$ is the outward unit normal. On an orthogonal Cartesian grid with faces at midpoints, the two-point approximations for face-normal gradients are\n$$\n\\left(\\frac{\\partial \\phi}{\\partial x}\\right)_{e} \\approx \\frac{\\phi_{E}-\\phi_{P}}{\\delta x_{Pe}},\\quad\n\\left(\\frac{\\partial \\phi}{\\partial x}\\right)_{w} \\approx \\frac{\\phi_{P}-\\phi_{W}}{\\delta x_{wP}},\n$$\n$$\n\\left(\\frac{\\partial \\phi}{\\partial y}\\right)_{n} \\approx \\frac{\\phi_{N}-\\phi_{P}}{\\delta y_{Pn}},\\quad\n\\left(\\frac{\\partial \\phi}{\\partial y}\\right)_{s} \\approx \\frac{\\phi_{P}-\\phi_{S}}{\\delta y_{sP}}.\n$$\nThe face lengths and control-volume area, given midpoints between nodes, are\n$$\nA_{e}=A_{w}=\\Delta y_{P}=\\frac{\\delta y_{sP}+\\delta y_{Pn}}{2},\\qquad\nA_{n}=A_{s}=\\Delta x_{P}=\\frac{\\delta x_{wP}+\\delta x_{Pe}}{2},\n$$\n$$\nV_{P}=\\Delta x_{P}\\,\\Delta y_{P}=\\frac{\\left(\\delta x_{wP}+\\delta x_{Pe}\\right)\\left(\\delta y_{sP}+\\delta y_{Pn}\\right)}{4}.\n$$\nSubstituting the approximations into the integrated balance gives\n$$\n\\Gamma A_{e}\\frac{\\phi_{E}-\\phi_{P}}{\\delta x_{Pe}}\n-\\Gamma A_{w}\\frac{\\phi_{P}-\\phi_{W}}{\\delta x_{wP}}\n+\\Gamma A_{n}\\frac{\\phi_{N}-\\phi_{P}}{\\delta y_{Pn}}\n-\\Gamma A_{s}\\frac{\\phi_{P}-\\phi_{S}}{\\delta y_{sP}}\n+S_{C}V_{P}+S_{P}V_{P}\\phi_{P}=0.\n$$\nCollecting like terms leads to the standard linear system\n$$\na_{P}\\,\\phi_{P}=a_{W}\\,\\phi_{W}+a_{E}\\,\\phi_{E}+a_{S}\\,\\phi_{S}+a_{N}\\,\\phi_{N}+S_{C}V_{P},\n$$\nwith diffusion coefficients\n$$\na_{E}=\\Gamma \\frac{A_{e}}{\\delta x_{Pe}}=\\Gamma \\frac{\\Delta y_{P}}{\\delta x_{Pe}},\\quad\na_{W}=\\Gamma \\frac{A_{w}}{\\delta x_{wP}}=\\Gamma \\frac{\\Delta y_{P}}{\\delta x_{wP}},\n$$\n$$\na_{N}=\\Gamma \\frac{A_{n}}{\\delta y_{Pn}}=\\Gamma \\frac{\\Delta x_{P}}{\\delta y_{Pn}},\\quad\na_{S}=\\Gamma \\frac{A_{s}}{\\delta y_{sP}}=\\Gamma \\frac{\\Delta x_{P}}{\\delta y_{sP}},\n$$\nand\n$$\na_{P}=a_{W}+a_{E}+a_{S}+a_{N}-S_{P}V_{P}.\n$$\nApplying the pointwise Gauss-Seidel update with sweep order increasing in $x$ then $y$ (so $\\phi_{W}$ and $\\phi_{S}$ are at iteration $(k+1)$, while $\\phi_{E}$ and $\\phi_{N}$ are at iteration $(k)$), we obtain\n$$\n\\phi_{P}^{(k+1)}=\\frac{a_{W}\\,\\phi_{W}^{(k+1)}+a_{E}\\,\\phi_{E}^{(k)}+a_{S}\\,\\phi_{S}^{(k+1)}+a_{N}\\,\\phi_{N}^{(k)}+S_{C}V_{P}}{a_{P}}.\n$$\nSubstituting the geometric definitions to express everything in terms of the given spacings,\n$$\n\\phi_{P}^{(k+1)}=\n\\frac{\\Gamma \\frac{\\delta y_{sP}+\\delta y_{Pn}}{2}\\left(\\frac{\\phi_{W}^{(k+1)}}{\\delta x_{wP}}+\\frac{\\phi_{E}^{(k)}}{\\delta x_{Pe}}\\right)\n+\\Gamma \\frac{\\delta x_{wP}+\\delta x_{Pe}}{2}\\left(\\frac{\\phi_{S}^{(k+1)}}{\\delta y_{sP}}+\\frac{\\phi_{N}^{(k)}}{\\delta y_{Pn}}\\right)\n+S_{C}\\frac{\\left(\\delta x_{wP}+\\delta x_{Pe}\\right)\\left(\\delta y_{sP}+\\delta y_{Pn}\\right)}{4}}\n{\\Gamma \\frac{\\delta y_{sP}+\\delta y_{Pn}}{2}\\left(\\frac{1}{\\delta x_{wP}}+\\frac{1}{\\delta x_{Pe}}\\right)\n+\\Gamma \\frac{\\delta x_{wP}+\\delta x_{Pe}}{2}\\left(\\frac{1}{\\delta y_{sP}}+\\frac{1}{\\delta y_{Pn}}\\right)\n-S_{P}\\frac{\\left(\\delta x_{wP}+\\delta x_{Pe}\\right)\\left(\\delta y_{sP}+\\delta y_{Pn}\\right)}{4}}.\n$$\nThis is the required Gauss-Seidel update for $\\phi_{P}^{(k+1)}$ on the non-uniform grid, in terms of $\\Gamma$, $S_{C}$, $S_{P}$, the neighboring values with appropriate iteration superscripts, and the given geometric spacings.", "answer": "$$\\boxed{\\phi_{P}^{(k+1)}=\n\\frac{\\Gamma \\frac{\\delta y_{sP}+\\delta y_{Pn}}{2}\\left(\\frac{\\phi_{W}^{(k+1)}}{\\delta x_{wP}}+\\frac{\\phi_{E}^{(k)}}{\\delta x_{Pe}}\\right)\n+\\Gamma \\frac{\\delta x_{wP}+\\delta x_{Pe}}{2}\\left(\\frac{\\phi_{S}^{(k+1)}}{\\delta y_{sP}}+\\frac{\\phi_{N}^{(k)}}{\\delta y_{Pn}}\\right)\n+S_{C}\\frac{\\left(\\delta x_{wP}+\\delta x_{Pe}\\right)\\left(\\delta y_{sP}+\\delta y_{Pn}\\right)}{4}}\n{\\Gamma \\frac{\\delta y_{sP}+\\delta y_{Pn}}{2}\\left(\\frac{1}{\\delta x_{wP}}+\\frac{1}{\\delta x_{Pe}}\\right)\n+\\Gamma \\frac{\\delta x_{wP}+\\delta x_{Pe}}{2}\\left(\\frac{1}{\\delta y_{sP}}+\\frac{1}{\\delta y_{Pn}}\\right)\n-S_{P}\\frac{\\left(\\delta x_{wP}+\\delta x_{Pe}\\right)\\left(\\delta y_{sP}+\\delta y_{Pn}\\right)}{4}}}$$", "id": "1749399"}]}