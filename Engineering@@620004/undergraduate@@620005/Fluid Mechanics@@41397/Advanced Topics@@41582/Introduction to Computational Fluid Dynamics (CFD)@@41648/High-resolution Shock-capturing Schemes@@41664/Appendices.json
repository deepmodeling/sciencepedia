{"hands_on_practices": [{"introduction": "Before diving into the complexities of high-resolution schemes, it is crucial to understand why they are necessary. Classical high-order methods, while accurate for smooth flows, can fail catastrophically when encountering strong gradients or shocks. This practice [@problem_id:1761785] provides a hands-on demonstration of this failure, where you will use the Lax-Wendroff scheme to simulate a strong expansion and witness how it can generate physically impossible results, such as negative pressure.", "problem": "A computational fluid dynamics engineer is simulating the one-dimensional flow of a perfect gas using the Euler equations. The simulation employs the two-step Lax-Wendroff scheme to achieve second-order accuracy in space and time. During a test case involving a strong expansion wave, the simulation crashes, reporting non-physical results. Your task is to analyze the cause of this failure by performing a single time-step calculation for a specific grid cell.\n\nThe state of the gas in any cell $j$ is described by a vector of conserved variables $\\mathbf{U}_j = [\\rho_j, (\\rho u)_j, E_j]^T$, where $\\rho$ is the density, $u$ is the velocity, and $E$ is the total energy per unit volume. The flux vector is $\\mathbf{F}(\\mathbf{U}_j) = [(\\rho u)_j, (\\rho u^2 + p)_j, (u(E+p))_j]^T$. The gas obeys the ideal gas law with the equation of state for pressure given by $p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^2)$.\n\nThe two-step Lax-Wendroff scheme updates the state in cell $i$ from time $n$ to $n+1$ as follows:\n\n1.  **Predictor Step**: Calculate the state at the cell interfaces ($i-1/2$ and $i+1/2$) at a half-time step ($n+1/2$). For an interface $j+1/2$ between cells $j$ and $j+1$:\n    $$ \\mathbf{U}_{j+1/2}^{n+1/2} = \\frac{1}{2}(\\mathbf{U}_j^n + \\mathbf{U}_{j+1}^n) - \\frac{\\Delta t}{2\\Delta x}(\\mathbf{F}(\\mathbf{U}_{j+1}^n) - \\mathbf{F}(\\mathbf{U}_j^n)) $$\n\n2.  **Corrector Step**: Use the predicted interface states to update the state of cell $i$:\n    $$ \\mathbf{U}_i^{n+1} = \\mathbf{U}_i^n - \\frac{\\Delta t}{\\Delta x}(\\mathbf{F}(\\mathbf{U}_{i+1/2}^{n+1/2}) - \\mathbf{F}(\\mathbf{U}_{i-1/2}^{n+1/2})) $$\n\nConsider the following non-dimensional initial conditions at time $t=0$ for three adjacent cells, which represent a strong expansion:\n-   **Cell $i-1$**: $\\rho_{i-1} = 1.0$, $u_{i-1} = 0.0$, $p_{i-1} = 1.0$\n-   **Cell $i$**: $\\rho_i = 0.1$, $u_i = 4.0$, $p_i = 0.01$\n-   **Cell $i+1$**: $\\rho_{i+1} = 0.1$, $u_{i+1} = 4.0$, $p_{i+1} = 0.01$\n\nUse the following parameters for your calculation:\n-   Ratio of specific heats: $\\gamma = 1.4$\n-   Time step to grid spacing ratio: $\\frac{\\Delta t}{\\Delta x} = 0.1$\n\nCalculate the pressure $p_i^{n+1}$ in cell $i$ after one time step. Express your answer in the same non-dimensional units as the initial conditions, rounded to three significant figures.", "solution": "We work with the conserved variables $\\mathbf{U}=[\\rho,\\,m,\\,E]^{T}$ where $m=\\rho u$, and the Euler flux $\\mathbf{F}(\\mathbf{U})=[m,\\,\\rho u^{2}+p,\\,u(E+p)]^{T}$. The ideal-gas pressure satisfies $p=(\\gamma-1)\\left(E-\\frac{1}{2}\\rho u^{2}\\right)$, hence $E=\\frac{p}{\\gamma-1}+\\frac{1}{2}\\rho u^{2}$.\n\nGiven $\\gamma=1.4$ and $\\Delta t/\\Delta x=\\lambda=0.1$, the three cell states at time $n$ are:\n- Cell $i-1$: $\\rho_{i-1}=1$, $u_{i-1}=0$, $p_{i-1}=1$, so $m_{i-1}=0$ and $E_{i-1}=\\frac{1}{\\gamma-1}+0=\\frac{1}{0.4}=2.5$. Thus\n$$\n\\mathbf{U}_{i-1}=[1,\\,0,\\,2.5]^{T},\\quad\n\\mathbf{F}(\\mathbf{U}_{i-1})=[0,\\,1,\\,0]^{T}.\n$$\n- Cell $i$: $\\rho_{i}=0.1$, $u_{i}=4$, $p_{i}=0.01$, so $m_{i}=0.4$ and $E_{i}=\\frac{0.01}{0.4}+\\frac{1}{2}(0.1)(4^{2})=0.025+0.8=0.825$. Thus\n$$\n\\mathbf{U}_{i}=[0.1,\\,0.4,\\,0.825]^{T},\\quad\n\\mathbf{F}(\\mathbf{U}_{i})=[0.4,\\,1.61,\\,3.34]^{T}.\n$$\n- Cell $i+1$ equals cell $i$, so $\\mathbf{U}_{i+1}=\\mathbf{U}_{i}$ and $\\mathbf{F}(\\mathbf{U}_{i+1})=\\mathbf{F}(\\mathbf{U}_{i})$.\n\nPredictor at $i-\\tfrac{1}{2}$:\n$$\n\\mathbf{U}_{i-1/2}^{n+1/2}=\\tfrac{1}{2}(\\mathbf{U}_{i-1}+\\mathbf{U}_{i})-\\tfrac{\\lambda}{2}\\left(\\mathbf{F}(\\mathbf{U}_{i})-\\mathbf{F}(\\mathbf{U}_{i-1})\\right).\n$$\nComponentwise,\n$$\n\\rho_{L}=\\tfrac{1}{2}(1+0.1)-\\tfrac{0.1}{2}(0.4-0)=0.53,\n$$\n$$\nm_{L}=\\tfrac{1}{2}(0+0.4)-\\tfrac{0.1}{2}(1.61-1)=0.1695,\n$$\n$$\nE_{L}=\\tfrac{1}{2}(2.5+0.825)-\\tfrac{0.1}{2}(3.34-0)=1.4955.\n$$\nThen $u_{L}=m_{L}/\\rho_{L}=0.1695/0.53=1695/5300$, and\n$$\np_{L}=(\\gamma-1)\\left(E_{L}-\\tfrac{1}{2}\\rho_{L}u_{L}^{2}\\right)\n=0.4\\left(1.4955-\\tfrac{1}{2}\\cdot 0.53\\cdot\\left(\\tfrac{1695}{5300}\\right)^{2}\\right)\n\\approx 0.5873583942.\n$$\nHence the left interface flux uses these primitives:\n$$\n\\mathbf{F}(\\mathbf{U}_{i-1/2}^{n+1/2})=\n\\bigl[m_{L},\\,\\rho_{L}u_{L}^{2}+p_{L},\\,u_{L}(E_{L}+p_{L})\\bigr]\n\\approx\n\\bigl[0.1695,\\,0.6415664232,\\,0.6661216945\\bigr]^{T}.\n$$\n\nPredictor at $i+\\tfrac{1}{2}$:\n$$\n\\mathbf{U}_{i+1/2}^{n+1/2}=\\tfrac{1}{2}(\\mathbf{U}_{i}+\\mathbf{U}_{i+1})-\\tfrac{\\lambda}{2}\\left(\\mathbf{F}(\\mathbf{U}_{i+1})-\\mathbf{F}(\\mathbf{U}_{i})\\right)\n=\\mathbf{U}_{i},\n$$\nso $\\mathbf{F}(\\mathbf{U}_{i+1/2}^{n+1/2})=\\mathbf{F}(\\mathbf{U}_{i})=[0.4,\\,1.61,\\,3.34]^{T}$.\n\nCorrector for cell $i$:\n$$\n\\mathbf{U}_{i}^{n+1}=\\mathbf{U}_{i}^{n}-\\lambda\\left(\\mathbf{F}(\\mathbf{U}_{i+1/2}^{n+1/2})-\\mathbf{F}(\\mathbf{U}_{i-1/2}^{n+1/2})\\right).\n$$\nCompute the flux difference and update:\n$$\n\\Delta \\mathbf{F}=\\bigl[0.4-0.1695,\\,1.61-0.6415664232,\\,3.34-0.6661216945\\bigr]^{T}\n=\\bigl[0.2305,\\,0.9684335768,\\,2.6738783055\\bigr]^{T},\n$$\n$$\n\\mathbf{U}_{i}^{n+1}=[0.1,\\,0.4,\\,0.825]^{T}-0.1\\,\\Delta \\mathbf{F}\n=\\bigl[0.07695,\\,0.30315664232,\\,0.5576121694505\\bigr]^{T}.\n$$\n\nRecover $p_{i}^{n+1}$ from the EOS:\n$$\np_{i}^{n+1}=(\\gamma-1)\\left(E_{i}^{n+1}-\\tfrac{1}{2}\\rho_{i}^{n+1}(u_{i}^{n+1})^{2}\\right)\n=(\\gamma-1)\\left(E_{i}^{n+1}-\\frac{(m_{i}^{n+1})^{2}}{2\\rho_{i}^{n+1}}\\right).\n$$\nWith $\\rho_{i}^{n+1}=0.07695$, $m_{i}^{n+1}=0.30315664232$, we have\n$$\n\\frac{(m_{i}^{n+1})^{2}}{2\\rho_{i}^{n+1}}\n=\\frac{0.0919039497827365}{0.1539}\\approx 0.597166664,\n$$\nso\n$$\np_{i}^{n+1}=0.4\\left(0.5576121694505-0.597166664\\right)\\approx -0.0158218.\n$$\nRounded to three significant figures, this yields the non-physical negative pressure noted in the crash.", "answer": "$$\\boxed{-1.58 \\times 10^{-2}}$$", "id": "1761785"}, {"introduction": "High-resolution schemes achieve robustness by incorporating non-linear flux limiters, which selectively add numerical dissipation near sharp gradients while maintaining high order in smooth regions. However, this remarkable feature comes with its own set of trade-offs that are important to understand. In this exercise [@problem_id:1761764], you will investigate a key artifact of Total Variation Diminishing (TVD) schemes by quantifying the clipping of a smooth Gaussian pulse, revealing how accuracy can be degraded at local extrema.", "problem": "A numerical scheme is proposed to solve the one-dimensional linear advection equation, $\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$, for a scalar quantity $u(x,t)$. The advection speed is a positive constant, $a=1.0 \\text{ m/s}$. The initial condition at $t=0$ is a smooth Gaussian pulse given by $u(x,0) = \\exp(-k x^2)$, where the constant $k = 50.0 \\text{ m}^{-2}$. The spatial domain is discretized into a uniform grid with spacing $\\Delta x = 0.02 \\text{ m}$, where grid points are located at $x_j = j \\Delta x$ for integer $j$. The initial peak of the pulse corresponds to the grid point $j=0$.\n\nThe system is evolved in time using a discrete time step $\\Delta t$. The Courant number is defined as $C = a \\Delta t / \\Delta x$ and is set to be exactly $0.5$. The update rule for the numerical solution $u_j^n$ at grid point $j$ and time step $n$ is given by the following conservative finite-volume scheme:\n\n$u_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x} (f_{j+1/2} - f_{j-1/2})$\n\nThe numerical flux $f_{j+1/2}$ between cells $j$ and $j+1$ is defined using a high-resolution method:\n\n$f_{j+1/2} = a \\left( u_j^n + \\frac{1}{2} \\psi(r_j) (u_{j+1}^n - u_j^n) \\right)$\n\nHere, $r_j$ represents the ratio of consecutive cell-to-cell gradients:\n\n$r_j = \\frac{u_j^n - u_{j-1}^n}{u_{j+1}^n - u_j^n}$\n\nThis ratio is well-defined as long as the denominator is non-zero. The function $\\psi(r)$ is given by:\n\n$\\psi(r) = \\max(0, \\min(1, r))$\n\nThe initial maximum value of the solution on the grid is $u_{\\text{max}}^{n=0} = u_0^0 = 1.0$. Calculate the absolute reduction in the maximum value of the numerical solution on the grid after a single time step. This reduction is defined as $\\Delta u_{\\text{peak}} = u_{\\text{max}}^{n=0} - u_{\\text{max}}^{n=1}$, where $u_{\\text{max}}^n$ is the maximum value of $u_j^n$ over all grid points $j$ at time step $n$.\n\nExpress your answer as a dimensionless number rounded to three significant figures.", "solution": "We solve the linear advection equation using the given finite-volume scheme with numerical flux\n$$\nf_{j+1/2}^{n} = a\\left(u_{j}^{n} + \\frac{1}{2}\\psi(r_{j})(u_{j+1}^{n} - u_{j}^{n})\\right),\n$$\nand update\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(f_{j+1/2}^{n} - f_{j-1/2}^{n}\\right).\n$$\nDefine the Courant number $C = a\\Delta t/\\Delta x = 0.5$. Then the update can be written as\n$$\nu_{j}^{n+1} = u_{j}^{n} - C\\left[\\left(u_{j}^{n} + \\frac{1}{2}\\psi(r_{j})(u_{j+1}^{n} - u_{j}^{n})\\right) - \\left(u_{j-1}^{n} + \\frac{1}{2}\\psi(r_{j-1})(u_{j}^{n} - u_{j-1}^{n})\\right)\\right].\n$$\nThe initial data are $u_{j}^{0} = \\exp(-k x_{j}^{2})$ with $x_{j} = j\\Delta x$, so let\n$$\ns \\equiv u_{1}^{0} = u_{-1}^{0} = \\exp(-k\\Delta x^{2}), \\quad u_{0}^{0} = 1, \\quad u_{2}^{0} = u_{-2}^{0} = \\exp(-4k\\Delta x^{2}) = s^{4}.\n$$\n\nWe compute the ratios $r_{j}$ at $n=0$ needed for the fluxes near the peak:\n- At $j=0$,\n$$\nr_{0} = \\frac{u_{0}^{0} - u_{-1}^{0}}{u_{1}^{0} - u_{0}^{0}} = \\frac{1 - s}{s - 1} = -1,\n$$\nso $\\psi(r_{0}) = \\max(0,\\min(1,-1)) = 0$.\n- At $j=-1$,\n$$\nr_{-1} = \\frac{u_{-1}^{0} - u_{-2}^{0}}{u_{0}^{0} - u_{-1}^{0}} = \\frac{s - s^{4}}{1 - s} = \\frac{s(1 - s^{3})}{1 - s} = s(1 + s + s^{2}) = s + s^{2} + s^{3}.\n$$\nFor the given $k$ and $\\Delta x$ we have $0 < s < 1$ and numerically $s = \\exp(-0.02)$, which gives $r_{-1} = s + s^{2} + s^{3} > 1$, hence $\\psi(r_{-1}) = 1$.\n- At $j=1$,\n$$\nr_{1} = \\frac{u_{1}^{0} - u_{0}^{0}}{u_{2}^{0} - u_{1}^{0}} = \\frac{s - 1}{s^{4} - s} = \\frac{1 - s}{s(1 - s^{3})} = \\frac{1}{s(1 + s + s^{2})} = \\frac{1}{r_{-1}}.\n$$\nSince $r_{-1}>1$, we have $0<r_{1}<1$, hence $\\psi(r_{1}) = r_{1}$.\n\nNow compute the updates at the key points.\n\nFor $j=0$,\n$$\nu_{0}^{1} = u_{0}^{0} - C\\left[\\left(u_{0}^{0} + \\frac{1}{2}\\psi(r_{0})(u_{1}^{0} - u_{0}^{0})\\right) - \\left(u_{-1}^{0} + \\frac{1}{2}\\psi(r_{-1})(u_{0}^{0} - u_{-1}^{0})\\right)\\right].\n$$\nUsing $\\psi(r_{0})=0$ and $\\psi(r_{-1})=1$,\n$$\nu_{0}^{1} = 1 - C\\left[1 - \\left(s + \\frac{1}{2}(1 - s)\\right)\\right]\n= 1 - C\\left[(1 - s)\\left(1 - \\frac{1}{2}\\right)\\right]\n= 1 - \\frac{C}{2}(1 - s).\n$$\n\nFor $j=1$,\n$$\nu_{1}^{1} = u_{1}^{0} - C\\left[\\left(u_{1}^{0} + \\frac{1}{2}\\psi(r_{1})(u_{2}^{0} - u_{1}^{0})\\right) - \\left(u_{0}^{0} + \\frac{1}{2}\\psi(r_{0})(u_{1}^{0} - u_{0}^{0})\\right)\\right].\n$$\nWith $\\psi(r_{0})=0$ and $\\psi(r_{1})=r_{1}$,\n$$\nu_{1}^{1} = s - C\\left[(s - 1) + \\frac{1}{2}r_{1}(s^{4} - s)\\right].\n$$\nSince $r_{1} = 1/[s(1 + s + s^{2})]$ and $s^{4} - s = -s(1 - s^{3}) = -s(1 - s)(1 + s + s^{2})$,\n$$\n\\frac{1}{2}r_{1}(s^{4} - s) = \\frac{1}{2}\\cdot \\frac{1}{s(1 + s + s^{2})}\\cdot \\left[-s(1 - s)(1 + s + s^{2})\\right] = -\\frac{1}{2}(1 - s).\n$$\nTherefore,\n$$\nu_{1}^{1} = s - C\\left[(s - 1) - \\frac{1}{2}(1 - s)\\right] = s + \\frac{3C}{2}(1 - s).\n$$\n\nWith $C=0.5$, these become\n$$\nu_{0}^{1} = 1 - \\frac{1}{4}(1 - s) = \\frac{3}{4} + \\frac{1}{4}s,\\qquad\nu_{1}^{1} = s + \\frac{3}{4}(1 - s) = \\frac{3}{4} + \\frac{1}{4}s.\n$$\nThus the two largest values after one step are equal: $u_{0}^{1} = u_{1}^{1} = \\frac{3}{4} + \\frac{1}{4}s$.\n\nTo confirm this is the maximum, note for $j=-1$ one finds\n$$\nu_{-1}^{1} = s - C\\left[\\left(s + \\frac{1}{2}\\psi(r_{-1})(1 - s)\\right) - \\left(s^{4} + \\frac{1}{2}\\psi(r_{-2})(s - s^{4})\\right)\\right].\n$$\nUsing $\\psi(r_{-1})=1$ and the bound $\\psi(r_{-2})\\leq 1$ gives the upper bound\n$$\nu_{-1}^{1} \\leq s - \\frac{C}{2}(1 - s^{4}),\n$$\nwhich at $C=0.5$ is strictly less than $\\frac{3}{4} + \\frac{1}{4}s$ for $0<s<1$. Values further from the peak are smaller still, so\n$$\nu_{\\text{max}}^{n=1} = \\frac{3}{4} + \\frac{1}{4}s,\\qquad s=\\exp(-k\\Delta x^{2}).\n$$\n\nTherefore, the reduction in the peak after one time step is\n$$\n\\Delta u_{\\text{peak}} = u_{\\text{max}}^{n=0} - u_{\\text{max}}^{n=1} = 1 - \\left(\\frac{3}{4} + \\frac{1}{4}\\exp(-k\\Delta x^{2})\\right) = \\frac{1}{4}\\left(1 - \\exp(-k\\Delta x^{2})\\right).\n$$\nSubstituting $k=50.0$ and $\\Delta x=0.02$ gives $k\\Delta x^{2} = 50.0 \\times (0.02)^{2} = 0.02$, hence\n$$\n\\Delta u_{\\text{peak}} = \\frac{1}{4}\\left(1 - \\exp(-0.02)\\right) \\approx \\frac{1}{4}\\times 0.0198013266932447 \\approx 0.00495033167331117.\n$$\nRounded to three significant figures, the absolute reduction is $0.00495$.", "answer": "$$\\boxed{0.00495}$$", "id": "1761764"}, {"introduction": "Modern shock-capturing codes often rely on sophisticated approximate Riemann solvers like Roe's scheme, which linearize the problem at each cell interface to achieve high efficiency and accuracy. Despite their power, these solvers can still produce non-physical solutions, such as expansion shocks, in specific \"transonic\" flow regimes. This practice [@problem_id:1761745] challenges you to diagnose such a case and understand why an \"entropy fix\" is a critical component for building a truly robust numerical tool for a wide range of flow conditions.", "problem": "Consider the one-dimensional Euler equations for an ideal gas, which are commonly used in computational fluid dynamics (CFD). The system is described by the state vector $U$ and flux vector $F(U)$:\n$$U = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad F(U) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\end{pmatrix}$$\nwhere $\\rho$ is the density, $u$ is the velocity, $E$ is the total energy per unit volume, and $p$ is the pressure. The gas is a perfect gas with an equation of state $E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$, where the adiabatic index is $\\gamma = 1.4$.\n\nA Riemann problem is defined by two constant states, a left state ($U_L$) and a right state ($U_R$), separated by a discontinuity at $x=0$. At time $t=0$, the states are:\n- Left state ($x<0$): $\\rho_L = 1.0 \\text{ kg/m}^3$, $u_L = 0.9 \\text{ m/s}$, $p_L = 1.0 \\text{ Pa}$.\n- Right state ($x>0$): $\\rho_R = 0.1 \\text{ kg/m}^3$, $u_R = 2.0 \\text{ m/s}$, $p_R = 0.2 \\text{ Pa}$.\n\nRoe's approximate Riemann solver computes a numerical flux at the interface based on a linearized problem. This involves calculating Roe-averaged quantities, denoted by a hat accent. The necessary formulas are:\n- Roe-averaged velocity: $\\hat{u} = \\frac{\\sqrt{\\rho_L}u_L + \\sqrt{\\rho_R}u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}$\n- Roe-averaged total enthalpy: $\\hat{H} = \\frac{\\sqrt{\\rho_L}H_L + \\sqrt{\\rho_R}H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}$, where $H = (E+p)/\\rho$.\n- Roe-averaged speed of sound: $\\hat{c} = \\sqrt{(\\gamma-1)(\\hat{H} - \\frac{1}{2}\\hat{u}^2)}$\n\nThe eigenvalues of the Roe-averaged Jacobian matrix are $\\hat{\\lambda}_1 = \\hat{u} - \\hat{c}$, $\\hat{\\lambda}_2 = \\hat{u}$, and $\\hat{\\lambda}_3 = \\hat{u} + \\hat{c}$. The corresponding eigenvalues for a general state $U$ are $\\lambda_1(U) = u - c$, $\\lambda_2(U) = u$, and $\\lambda_3(U) = u + c$, where $c = \\sqrt{\\gamma p / \\rho}$.\n\nFor the given flow configuration, a numerical instability known as an entropy-violating expansion shock can occur. This is associated with a \"transonic\" characteristic wave family, for which the characteristic speed $\\lambda_k(U)$ changes sign across the interface (i.e., $\\lambda_k(U_L)$ and $\\lambda_k(U_R)$ have opposite signs).\n\nCalculate the Roe-averaged eigenvalue, $\\hat{\\lambda}_k$, corresponding to this specific transonic wave family. Round your final answer to four significant figures and express it in m/s.", "solution": "We are given the one-dimensional Euler equations for a perfect gas with $\\gamma=1.4$, and a Riemann problem with left and right states. The characteristic speeds for a state $U$ are $\\lambda_{1}(U)=u-c$, $\\lambda_{2}(U)=u$, $\\lambda_{3}(U)=u+c$, where $c=\\sqrt{\\gamma p/\\rho}$. The Roe-averaged speeds are $\\hat{\\lambda}_{1}=\\hat{u}-\\hat{c}$, $\\hat{\\lambda}_{2}=\\hat{u}$, $\\hat{\\lambda}_{3}=\\hat{u}+\\hat{c}$, with\n$$\n\\hat{u}=\\frac{\\sqrt{\\rho_{L}}u_{L}+\\sqrt{\\rho_{R}}u_{R}}{\\sqrt{\\rho_{L}}+\\sqrt{\\rho_{R}}},\\quad\n\\hat{H}=\\frac{\\sqrt{\\rho_{L}}H_{L}+\\sqrt{\\rho_{R}}H_{R}}{\\sqrt{\\rho_{L}}+\\sqrt{\\rho_{R}}},\\quad\n\\hat{c}=\\sqrt{(\\gamma-1)\\left(\\hat{H}-\\frac{1}{2}\\hat{u}^{2}\\right)},\n$$\nand $H=(E+p)/\\rho$ with $E=\\frac{p}{\\gamma-1}+\\frac{1}{2}\\rho u^{2}$, hence\n$$\nH=\\frac{\\gamma}{\\gamma-1}\\frac{p}{\\rho}+\\frac{1}{2}u^{2}.\n$$\n\nFirst, compute the left and right sound speeds and characteristic speeds to identify the transonic wave family:\n$$\nc_{L}=\\sqrt{\\frac{\\gamma p_{L}}{\\rho_{L}}}=\\sqrt{1.4\\cdot\\frac{1.0}{1.0}}=\\sqrt{1.4}\\approx 1.183215956,\n$$\n$$\nc_{R}=\\sqrt{\\frac{\\gamma p_{R}}{\\rho_{R}}}=\\sqrt{1.4\\cdot\\frac{0.2}{0.1}}=\\sqrt{2.8}\\approx 1.673320053.\n$$\nThen\n$$\n\\lambda_{1}(U_{L})=u_{L}-c_{L}\\approx 0.9-1.183215956\\approx -0.283215956,\\quad \\lambda_{2}(U_{L})=u_{L}=0.9,\\quad \\lambda_{3}(U_{L})=u_{L}+c_{L}\\approx 2.083215956,\n$$\n$$\n\\lambda_{1}(U_{R})=u_{R}-c_{R}\\approx 2.0-1.673320053\\approx 0.326679947,\\quad \\lambda_{2}(U_{R})=u_{R}=2.0,\\quad \\lambda_{3}(U_{R})=u_{R}+c_{R}\\approx 3.673320053.\n$$\nOnly the $k=1$ family changes sign across the interface (negative on the left, positive on the right), so the transonic wave family is $k=1$. Therefore we must compute $\\hat{\\lambda}_{1}=\\hat{u}-\\hat{c}$.\n\nCompute the total enthalpies:\n$$\n\\frac{\\gamma}{\\gamma-1}=\\frac{1.4}{0.4}=3.5,\\quad\nH_{L}=3.5\\frac{p_{L}}{\\rho_{L}}+\\frac{1}{2}u_{L}^{2}=3.5\\cdot 1.0+\\frac{1}{2}\\cdot 0.9^{2}=3.5+0.405=3.905,\n$$\n$$\nH_{R}=3.5\\frac{p_{R}}{\\rho_{R}}+\\frac{1}{2}u_{R}^{2}=3.5\\cdot\\frac{0.2}{0.1}+\\frac{1}{2}\\cdot 2.0^{2}=3.5\\cdot 2.0+2.0=9.0.\n$$\nCompute Roe averages. With $\\sqrt{\\rho_{L}}=1$ and $\\sqrt{\\rho_{R}}=\\sqrt{0.1}\\approx 0.316227766$, the common denominator is\n$$\nD=\\sqrt{\\rho_{L}}+\\sqrt{\\rho_{R}}=1+0.316227766016838\\approx 1.316227766016838.\n$$\nThen\n$$\n\\hat{u}=\\frac{1\\cdot 0.9+0.316227766016838\\cdot 2.0}{D}=\\frac{1.532455532033676}{1.316227766016838}\\approx 1.1642784,\n$$\n$$\n\\hat{H}=\\frac{1\\cdot 3.905+0.316227766016838\\cdot 9.0}{D}=\\frac{6.751049894151542}{1.316227766016838}\\approx 5.129089409.\n$$\nNow compute the Roe sound speed:\n$$\n\\hat{u}^{2}\\approx (1.1642784)^{2}=1.35554419270656,\\quad \\frac{1}{2}\\hat{u}^{2}\\approx 0.67777209635328,\n$$\n$$\n\\hat{H}-\\frac{1}{2}\\hat{u}^{2}\\approx 5.129089409-0.67777209635328\\approx 4.45131731264672,\n$$\n$$\n\\hat{c}=\\sqrt{(\\gamma-1)\\left(\\hat{H}-\\frac{1}{2}\\hat{u}^{2}\\right)}=\\sqrt{0.4\\cdot 4.45131731264672}\\approx \\sqrt{1.780526925058688}\\approx 1.3343638.\n$$\nTherefore, for the transonic family $k=1$,\n$$\n\\hat{\\lambda}_{1}=\\hat{u}-\\hat{c}\\approx 1.1642784-1.3343638\\approx -0.1700854\\ \\text{m/s}.\n$$\nRounding to four significant figures gives $-0.1701$ in m/s.", "answer": "$$\\boxed{-0.1701}$$", "id": "1761745"}]}