{"hands_on_practices": [{"introduction": "The fundamental operation of any linear time-invariant filter, including a matched filter, is convolution. This first exercise provides a foundational, hands-on opportunity to compute the output of a matched filter for the canonical rectangular pulse. By working through this classic example, you will gain a concrete understanding of how the filter's output evolves over time and why the resulting triangular shape represents the signal's autocorrelation, peaking at the moment of perfect alignment. [@problem_id:1736683]", "id": "1736683", "problem": "In a simplified baseband digital communication system, a rectangular pulse is used to represent a binary '1'. The pulse, denoted by $s(t)$, has a duration of $T$ and a unit amplitude. It is defined as:\n$$s(t) = u(t) - u(t-T)$$\nwhere $u(t)$ is the Heaviside unit step function, defined as $u(t) = 1$ for $t \\ge 0$ and $u(t) = 0$ for $t < 0$.\n\nTo maximize the signal-to-noise ratio at the receiver at a specific time, a matched filter is employed. The impulse response of a filter matched to a signal $g(t)$ is generally given by $h(t) = g(T_d - t)$, where $T_d$ is a design parameter representing a time delay. For this system, the filter is made causal by choosing the delay to be equal to the pulse duration, so its impulse response is $h(t) = s(T - t)$.\n\nAssume the transmitted pulse $s(t)$ is the input to this matched filter. Determine the complete mathematical expression for the output waveform $y(t)$ as a function of time $t$ and the parameter $T$. Your answer should be expressed in terms of the unit ramp function, defined as $r(t) = t u(t)$.\n\n", "solution": "The matched filter output is the convolution of the input pulse with the impulse response:\n$$\ny(t) = (s * h)(t), \\quad \\text{with} \\quad s(t) = u(t) - u(t - T), \\quad h(t) = s(T - t).\n$$\nSince $s(t)$ is a unit-amplitude rectangular pulse of width $T$, $h(t)$ is also a rectangular pulse of width $T$ (time-reversed and shifted to ensure causality). For convolution with piecewise-continuous signals, point values at isolated times do not affect the result; thus we may equivalently use the causal representation\n$$\nh(t) \\equiv u(t) - u(t - T)\n$$\nfor computing the convolution. Therefore,\n$$\ny(t) = \\big(u - u(\\cdot - T)\\big) * \\big(u - u(\\cdot - T)\\big).\n$$\nBy linearity of convolution,\n$$\ny(t) = u * u \\;-\\; u * u(t - T) \\;-\\; u(t - T) * u \\;+\\; u(t - T) * u(t - T).\n$$\nUsing the standard result $u * u = r(t)$ with $r(t) = t\\,u(t)$ and the shift property of convolution,\n$$\nu * u(t - T) = r(t - T), \\quad u(t - T) * u = r(t - T), \\quad u(t - T) * u(t - T) = r(t - 2T).\n$$\nSubstituting these into the expression for $y(t)$ yields\n$$\ny(t) = r(t) - 2\\,r(t - T) + r(t - 2T),\n$$\nwhich is a triangular waveform of base $2T$ and peak value $T$ at $t = T$, as expected for the matched filter output (equal to the autocorrelation of $s(t)$ evaluated at lag $t - T$).", "answer": "$$\\boxed{r(t) - 2\\,r(t - T) + r(t - 2T)}$$"}, {"introduction": "Building on the mechanics of convolution, we now focus on the core purpose of the matched filter: maximizing the signal's presence at a single point in time. This practice shifts our focus to the discrete-time domain, which is essential for understanding modern digital receivers. By calculating the maximum value of the output sequence, you will directly verify the key theoretical result that this peak output is equal to the energy of the input signal, a principle that underpins the matched filter's optimality in maximizing the signal-to-noise ratio. [@problem_id:1736685]", "id": "1736685", "problem": "In a digital communication system, a specific pulse shape is transmitted to represent binary data. To optimize detection at the receiver in the presence of Additive White Gaussian Noise (AWGN), a matched filter is employed. The goal of this filter is to maximize the Signal-to-Noise Ratio (SNR) of the signal at the sampling instant.\n\nConsider a real-valued, finite-duration discrete-time signal, $s[n]$, used for this purpose, defined as:\n$$\ns[n] = \\begin{cases}\nA \\rho^{n} & \\text{for } n = 0, 1, 2, \\dots, L-1 \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nwhere $A$ is a real constant representing the initial amplitude, $\\rho$ is a real-valued decay factor such that $0 < |\\rho| < 1$, and $L$ is a positive integer representing the length of the signal.\n\nA causal Finite Impulse Response (FIR) filter is designed to be matched to this signal. The impulse response of this matched filter, $h[n]$, is given by $h[n] = s[L-1-n]$.\n\nIf the signal $s[n]$ is input to this matched filter, an output signal $y[n]$ is produced, where $y[n]$ is the convolution of $s[n]$ and $h[n]$. Determine the maximum value achieved by the output signal $y[n]$. Your answer should be a closed-form analytic expression in terms of $A$, $\\rho$, and $L$.\n\n", "solution": "The problem asks for the maximum value of the output signal $y[n]$, which is the result of the convolution of the input signal $s[n]$ with the impulse response of its matched filter $h[n]$.\n\nThe output signal $y[n]$ is given by the convolution sum:\n$$\ny[n] = s[n] * h[n] = \\sum_{k=-\\infty}^{\\infty} s[k] h[n-k]\n$$\n\nThe impulse response of the matched filter is defined as $h[n] = s[L-1-n]$. We can find an expression for the time-shifted version $h[n-k]$ by substituting $n-k$ for $n$:\n$$\nh[n-k] = s[L-1-(n-k)] = s[L-1-n+k]\n$$\n\nSubstituting this into the convolution sum gives:\n$$\ny[n] = \\sum_{k=-\\infty}^{\\infty} s[k] s[L-1-n+k]\n$$\n\nThis expression for $y[n]$ is the time-shifted autocorrelation of the signal $s[n]$. The autocorrelation function of a signal is maximized at the origin (zero shift). In our case, the argument of the second term in the sum is $k + (L-1-n)$. The output $y[n]$ will be maximized when the effective shift is zero, which corresponds to $L-1-n=0$. This occurs at the time index $n=L-1$.\n\nLet's calculate the value of the output at $n=L-1$:\n$$\ny[L-1] = \\sum_{k=-\\infty}^{\\infty} s[k] h[(L-1)-k]\n$$\n\nFirst, let's look at the term $h[L-1-k]$. Using the definition of $h[n]$, we have:\n$$\nh[L-1-k] = s[L-1-(L-1-k)] = s[k]\n$$\n\nSubstituting this back into the expression for $y[L-1]$:\n$$\ny[L-1] = \\sum_{k=-\\infty}^{\\infty} s[k] s[k] = \\sum_{k=-\\infty}^{\\infty} (s[k])^2\n$$\n\nThe signal $s[k]$ is defined to be non-zero only for $k$ in the range $\\{0, 1, 2, \\dots, L-1\\}$. Therefore, we can change the limits of the summation:\n$$\ny_{\\text{max}} = y[L-1] = \\sum_{k=0}^{L-1} (s[k])^2\n$$\n\nNow, we substitute the definition of the signal, $s[k] = A \\rho^k$:\n$$\ny_{\\text{max}} = \\sum_{k=0}^{L-1} (A \\rho^k)^2 = \\sum_{k=0}^{L-1} A^2 (\\rho^2)^k\n$$\n\nWe can factor out the constant $A^2$ from the summation:\n$$\ny_{\\text{max}} = A^2 \\sum_{k=0}^{L-1} (\\rho^2)^k\n$$\n\nThe remaining sum is a finite geometric series of the form $\\sum_{k=0}^{N-1} r^k = \\frac{1-r^N}{1-r}$. In our case, the number of terms is $L$ and the common ratio is $r = \\rho^2$. Applying the formula for the sum of a finite geometric series:\n$$\n\\sum_{k=0}^{L-1} (\\rho^2)^k = \\frac{1 - (\\rho^2)^L}{1 - \\rho^2} = \\frac{1 - \\rho^{2L}}{1 - \\rho^2}\n$$\n\nFinally, we substitute this sum back into our expression for $y_{\\text{max}}$:\n$$\ny_{\\text{max}} = A^2 \\left( \\frac{1 - \\rho^{2L}}{1 - \\rho^2} \\right)\n$$\nThis is the maximum value of the output signal.", "answer": "$$\n\\boxed{A^{2} \\frac{1 - \\rho^{2L}}{1 - \\rho^{2}}}\n$$"}, {"introduction": "Theory often begins with ideal conditions, but practical engineering requires analyzing performance in the face of imperfections. This final exercise investigates a common real-world issue: the effect of an unwanted DC offset on the performance of a matched filter system. You will learn to treat this offset as a form of interference and analytically quantify the resulting degradation in the signal-to-noise ratio. This practice is crucial for developing the skill to assess a system's robustness and understand how its performance is impacted by non-ideal factors. [@problem_id:1736640]", "id": "1736640", "problem": "In a digital communication system, a binary data stream is transmitted using a simple rectangular pulse shaping scheme. The system is designed to be zero-mean in the long run, with transmissions of a signal pulse $s(t)$ and its inverse $-s(t)$ being equally likely. For our analysis, we focus on the detection of a single pulse $s(t)$ defined as:\n$$\ns(t) = \\begin{cases} A & \\text{if } 0 \\le t \\le T \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nwhere $A$ and $T$ are positive constants.\n\nThe receiver employs a filter matched to this signal $s(t)$ to maximize the detectability of the pulse in the presence of Additive White Gaussian Noise (AWGN), which has a constant two-sided power spectral density of $N_0/2$. The output of the matched filter is sampled at the optimal time to achieve the highest Signal-to-Noise Ratio (SNR).\n\nIn an ideal scenario, the received signal is $r_{ideal}(t) = s(t) + n(t)$, where $n(t)$ is the AWGN. The performance is measured by the output SNR, denoted $SNR_{ideal}$, which is defined as the squared value of the signal component at the filter's output at the sampling instant, divided by the average power (variance) of the noise component at the output.\n\nNow, consider a non-ideal, degraded scenario where a small, unknown, but constant DC offset $C$ contaminates the signal due to an imperfection in the receiver's analog front-end. The received signal is now $r_{degraded}(t) = s(t) + C + n(t)$. The same matched filter is used. In this case, the DC offset acts as a form of interference. The degraded performance is measured by $SNR_{degraded}$, where the \"signal\" power at the output is still due to $s(t)$ alone, but the \"total noise\" power at the output is the sum of the power due to the AWGN and the power due to the DC offset $C$.\n\nCalculate the ratio $\\frac{SNR_{degraded}}{SNR_{ideal}}$ to quantify the performance degradation. Express your answer as a closed-form analytic expression in terms of $C$, $T$, and $N_0$.\n\n", "solution": "Let $s(t)$ be real-valued and time-limited to $[0,T]$. Define its energy and area by\n$$\nE_{s} \\equiv \\int_{-\\infty}^{\\infty} s^{2}(t)\\,dt, \n\\qquad\nS_{1} \\equiv \\int_{-\\infty}^{\\infty} s(t)\\,dt.\n$$\nFor the given rectangular pulse $s(t)=A$ on $[0,T]$ and zero otherwise,\n$$\nE_{s}=\\int_{0}^{T} A^{2}\\,dt = A^{2}T,\n\\qquad\nS_{1}=\\int_{0}^{T} A\\,dt = AT.\n$$\n\nWith a matched filter $h(t)=s(T-t)$, the sample at $t=T$ is the correlation $y(T)=\\int_{-\\infty}^{\\infty} s(u)\\,r(u)\\,du$.\n\nIdeal case $r_{\\text{ideal}}(t)=s(t)+n(t)$:\n- Signal component at the output sample is\n$$\ny_{s}(T)=\\int s(u)\\,s(u)\\,du=E_{s}.\n$$\n- Noise component is $y_{n}(T)=\\int s(u)\\,n(u)\\,du$, which is zero-mean Gaussian with variance\n$$\n\\operatorname{Var}\\{y_{n}(T)\\}=\\frac{N_{0}}{2}\\int s^{2}(u)\\,du=\\frac{N_{0}}{2}E_{s}.\n$$\nTherefore,\n$$\nSNR_{\\text{ideal}}=\\frac{\\left(y_{s}(T)\\right)^{2}}{\\operatorname{Var}\\{y_{n}(T)\\}}=\\frac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}}=\\frac{2E_{s}}{N_{0}}.\n$$\n\nDegraded case $r_{\\text{degraded}}(t)=s(t)+C+n(t)$:\n- Output sample decomposes as\n$$\ny(T)=\\int s(u)\\,s(u)\\,du+\\int s(u)\\,C\\,du+\\int s(u)\\,n(u)\\,du\n=E_{s}+C\\,S_{1}+y_{n}(T).\n$$\n- The signal component remains $E_{s}$. The interference from the DC offset is the deterministic term $C\\,S_{1}$, whose power contribution at the sample is $(C\\,S_{1})^{2}$. The AWGN contribution has variance $\\left(\\frac{N_{0}}{2}\\right)E_{s}$. Hence the total noise-plus-interference power at the output sample is\n$$\n\\left(\\frac{N_{0}}{2}\\right)E_{s}+(C\\,S_{1})^{2}.\n$$\nThus,\n$$\nSNR_{\\text{degraded}}=\\frac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}+C^{2}S_{1}^{2}}.\n$$\n\nThe degradation ratio is\n$$\n\\frac{SNR_{\\text{degraded}}}{SNR_{\\text{ideal}}}\n=\\frac{\\dfrac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}+C^{2}S_{1}^{2}}}{\\dfrac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}}}\n=\\frac{\\left(\\frac{N_{0}}{2}\\right)E_{s}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}+C^{2}S_{1}^{2}}\n=\\frac{1}{1+\\dfrac{2\\,C^{2}S_{1}^{2}}{N_{0}E_{s}}}.\n$$\nFor the rectangular pulse, $E_{s}=A^{2}T$ and $S_{1}=AT$, so\n$$\n\\frac{2\\,C^{2}S_{1}^{2}}{N_{0}E_{s}}=\\frac{2\\,C^{2}\\,A^{2}T^{2}}{N_{0}\\,A^{2}T}=\\frac{2\\,C^{2}T}{N_{0}},\n$$\nwhich yields\n$$\n\\frac{SNR_{\\text{degraded}}}{SNR_{\\text{ideal}}}\n=\\frac{1}{1+\\dfrac{2\\,C^{2}T}{N_{0}}}\n=\\frac{N_{0}}{N_{0}+2\\,C^{2}T}.\n$$\nThis expression depends only on $C$, $T$, and $N_{0}$, as required.", "answer": "$$\\boxed{\\frac{N_{0}}{N_{0}+2C^{2}T}}$$"}]}