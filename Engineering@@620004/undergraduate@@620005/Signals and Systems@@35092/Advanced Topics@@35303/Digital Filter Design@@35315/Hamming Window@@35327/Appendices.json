{"hands_on_practices": [{"introduction": "To truly understand the power of a window function, we must first analyze its characteristics in the frequency domain. This initial practice provides the theoretical foundation by guiding you through the derivation of the Discrete-Time Fourier Transform (DTFT) for the Hamming window. By starting from its time-domain definition, you will see how the window's elegant cosine-based shape, $w_H[n] = 0.54 - 0.46 \\cos\\left(\\frac{2\\pi n}{N-1}\\right)$, translates into a specific, predictable spectral structure, which is the key to its utility in suppressing spectral leakage [@problem_id:1723929].", "problem": "In digital signal processing, windowing is a fundamental technique used to taper a signal and reduce spectral leakage. Consider a signal processing chain where a discrete-time signal $x[n]$ is first multiplied by a rectangular window $w_R[n]$ of length $N$. The resulting signal is then immediately multiplied by a Hamming window $w_H[n]$ of the same length $N$. This sequence of operations is equivalent to multiplying the original signal $x[n]$ by a single composite window, $w_{eq}[n]$.\n\nThe windows are formally defined as follows:\n- The rectangular window is given by $w_R[n] = 1$ for $0 \\le n \\le N-1$, and $w_R[n] = 0$ otherwise.\n- The Hamming window is given by $w_H[n] = 0.54 - 0.46 \\cos\\left(\\frac{2\\pi n}{N-1}\\right)$ for $0 \\le n \\le N-1$, and $w_H[n] = 0$ otherwise.\n\nAssume that $N$ is an integer greater than 1.\n\nYour task is to derive a closed-form analytic expression for the Discrete-Time Fourier Transform (DTFT), denoted as $W_{eq}(e^{j\\omega})$, of the equivalent composite window $w_{eq}[n]$. Express your final answer in terms of $N$ and the angular frequency $\\omega$.", "solution": "The time-domain operation multiplies $x[n]$ by the rectangular window $w_{R}[n]$ and then by the Hamming window $w_{H}[n]$, both of length $N$. Since $w_{R}[n]=1$ for $0 \\leq n \\leq N-1$ and zero otherwise, and $w_{H}[n]=0$ outside the same interval, their product equals the Hamming window itself:\n$$\nw_{eq}[n]=w_{R}[n]\\,w_{H}[n]=w_{H}[n],\\quad \\text{for all }n.\n$$\nThe DTFT of $w_{eq}[n]$ is therefore the DTFT of the Hamming window:\n$$\nW_{eq}(e^{j\\omega}) = \\sum_{n=0}^{N-1}\\left(0.54-0.46\\cos\\left(\\frac{2\\pi n}{N-1}\\right)\\right)e^{-j\\omega n}.\n$$\nUsing linearity of the DTFT and the identity $\\cos(\\theta) = \\frac{1}{2}(e^{j\\theta} + e^{-j\\theta})$, we write\n$$\nW_{eq}(e^{j\\omega})\n=0.54\\sum_{n=0}^{N-1}e^{-j\\omega n}\n-\\frac{0.46}{2}\\sum_{n=0}^{N-1}\\left[e^{-j\\left(\\omega-\\frac{2\\pi}{N-1}\\right)n} + e^{-j\\left(\\omega+\\frac{2\\pi}{N-1}\\right)n}\\right].\n$$\nFor any real $a$, the finite geometric series evaluates to\n$$\n\\sum_{n=0}^{N-1} e^{-jan} = e^{-ja\\frac{N-1}{2}}\\frac{\\sin\\left(\\frac{N a}{2}\\right)}{\\sin\\left(\\frac{a}{2}\\right)}.\n$$\nApplying this with $a=\\omega$, $a=\\omega-\\frac{2\\pi}{N-1}$, and $a=\\omega+\\frac{2\\pi}{N-1}$ yields the closed-form expression\n$$\nW_{eq}(e^{j\\omega})\n=0.54 e^{-j\\omega\\frac{N-1}{2}}\\frac{\\sin\\left(\\frac{N\\omega}{2}\\right)}{\\sin\\left(\\frac{\\omega}{2}\\right)}\n-0.23\\left[\ne^{-j\\left(\\omega-\\frac{2\\pi}{N-1}\\right)\\frac{N-1}{2}}\\frac{\\sin\\left(\\frac{N}{2}\\left(\\omega-\\frac{2\\pi}{N-1}\\right)\\right)}{\\sin\\left(\\frac{1}{2}\\left(\\omega-\\frac{2\\pi}{N-1}\\right)\\right)}\n+e^{-j\\left(\\omega+\\frac{2\\pi}{N-1}\\right)\\frac{N-1}{2}}\\frac{\\sin\\left(\\frac{N}{2}\\left(\\omega+\\frac{2\\pi}{N-1}\\right)\\right)}{\\sin\\left(\\frac{1}{2}\\left(\\omega+\\frac{2\\pi}{N-1}\\right)\\right)}\n\\right].\n$$\nThis expression is valid for all $N>1$ and all $\\omega$, with the usual interpretation at removable singularities where denominators vanish.", "answer": "$$\\boxed{0.54 e^{-j\\omega\\frac{N-1}{2}} \\frac{\\sin(\\frac{N\\omega}{2})}{\\sin(\\frac{\\omega}{2})} - 0.23 \\left[ e^{-j(\\omega-\\frac{2\\pi}{N-1})\\frac{N-1}{2}} \\frac{\\sin(\\frac{N}{2}(\\omega-\\frac{2\\pi}{N-1}))}{\\sin(\\frac{1}{2}(\\omega-\\frac{2\\pi}{N-1}))} + e^{-j(\\omega+\\frac{2\\pi}{N-1})\\frac{N-1}{2}} \\frac{\\sin(\\frac{N}{2}(\\omega+\\frac{2\\pi}{N-1}))}{\\sin(\\frac{1}{2}(\\omega+\\frac{2\\pi}{N-1}))} \\right]}$$", "id": "1723929"}, {"introduction": "Now that we have a theoretical grasp of the Hamming window's spectrum, we can apply this knowledge to a practical engineering scenario. In FIR filter design, one of the most common tasks is to determine the necessary filter order, or window length $N$, to meet a specific performance requirement, such as the sharpness of a filter's cutoff. This exercise demonstrates how to translate a design constraint on the main lobe's bandwidth directly into the minimum required window length, a fundamental skill in digital signal processing [@problem_id:1723953].", "problem": "A signal processing engineer is designing a digital Finite Impulse Response (FIR) filter using the windowing method. The design requires a precise control over the filter's transition band, which is critically dependent on the main lobe width of the window function used. The engineer chooses a Hamming window, which is defined for a length $N$ as:\n$$w[n] = 0.54 - 0.46 \\cos\\left(\\frac{2\\pi n}{N-1}\\right), \\quad \\text{for } n = 0, 1, \\dots, N-1.$$\n\nThe signal to be filtered is sampled at a frequency $f_s = 48$ kHz. For this family of window functions, extensive empirical studies have established a relationship between the main lobe's null-to-null bandwidth, $\\Delta f_{\\text{null}}$, and its 3-decibel (dB) bandwidth, $\\Delta f_{\\text{3dB}}$. This relationship is given by $\\Delta f_{\\text{3dB}} \\approx 0.325 \\times \\Delta f_{\\text{null}}$.\n\nThe main lobe of the Hamming window's frequency spectrum is centered at 0 Hz, and its first nulls occur at frequencies $f = \\pm \\frac{c f_s}{N}$, where $c$ is a constant. For the Hamming window, this constant is $c=2$.\n\nThe filter design specification requires the 3-dB bandwidth of the window's main lobe to be no more than 150 Hz.\n\nDetermine the minimum integer window length $N$ that satisfies this design constraint.", "solution": "The problem asks for the minimum integer window length $N$ that ensures the 3-dB bandwidth, $\\Delta f_{\\text{3dB}}$, of the Hamming window's main lobe is no more than 150 Hz. The design constraint can be written as:\n$$ \\Delta f_{\\text{3dB}} \\le 150 \\text{ Hz} $$\n\nTo solve this, we first need to find an expression for $\\Delta f_{\\text{3dB}}$ in terms of the window length $N$. The problem provides a relationship between the 3-dB bandwidth and the null-to-null bandwidth, $\\Delta f_{\\text{null}}$:\n$$ \\Delta f_{\\text{3dB}} \\approx 0.325 \\times \\Delta f_{\\text{null}} $$\n\nNext, we determine $\\Delta f_{\\text{null}}$. The problem states that the first nulls of the main lobe occur at frequencies $f = \\pm \\frac{c f_s}{N}$, with the constant $c=2$ for the Hamming window. Let's call these null frequencies $f_{\\text{null,1}}$ and $f_{\\text{null,2}}$.\n$$ f_{\\text{null,1}} = +\\frac{2 f_s}{N} $$\n$$ f_{\\text{null,2}} = -\\frac{2 f_s}{N} $$\nThe null-to-null bandwidth is the difference between these two frequencies:\n$$ \\Delta f_{\\text{null}} = f_{\\text{null,1}} - f_{\\text{null,2}} = \\left(\\frac{2 f_s}{N}\\right) - \\left(-\\frac{2 f_s}{N}\\right) = \\frac{4 f_s}{N} $$\n\nNow we can substitute this expression for $\\Delta f_{\\text{null}}$ into the equation for $\\Delta f_{\\text{3dB}}$:\n$$ \\Delta f_{\\text{3dB}} \\approx 0.325 \\times \\left(\\frac{4 f_s}{N}\\right) = \\frac{1.3 f_s}{N} $$\n\nWith this expression, we can use the design constraint to find the required window length $N$:\n$$ \\frac{1.3 f_s}{N} \\le 150 $$\nWe need to solve for $N$. Rearranging the inequality gives:\n$$ N \\ge \\frac{1.3 f_s}{150} $$\n\nNow we can substitute the given numerical values. The sampling frequency is $f_s = 48$ kHz, which is $48000$ Hz.\n$$ N \\ge \\frac{1.3 \\times 48000}{150} $$\nLet's perform the calculation:\n$$ N \\ge \\frac{1.3 \\times 4800}{15} $$\nSince $4800 / 15 = 320$, we have:\n$$ N \\ge 1.3 \\times 320 $$\n$$ N \\ge 416 $$\n\nThe inequality shows that $N$ must be greater than or equal to 416. Since the window length $N$ must be an integer, the minimum integer value for $N$ that satisfies this condition is 416.", "answer": "$$\\boxed{416}$$", "id": "1723953"}, {"introduction": "The specific coefficients of the Hamming window, $0.54$ and $0.46$, are precisely chosen to optimize spectral performance, particularly to minimize the highest sidelobe. This final practice serves as a compelling thought experiment on the importance of this precision. You will explore what happens when we replace the exact cosine function with a seemingly reasonable polynomial approximation, revealing how such a modification can drastically and unexpectedly degrade the window's spectral properties [@problem_id:1723926]. This exercise provides a powerful lesson on the sensitivity of frequency-domain behavior to small changes in the time-domain definition.", "problem": "A standard length-$N$ Hamming window, used in digital signal processing for spectral analysis, is defined for $n = 0, 1, \\dots, N-1$ by the function:\n$$w_H[n] = 0.54 - 0.46 \\cos\\left(\\frac{2\\pi n}{N-1}\\right)$$\nAn engineer proposes creating a new window, $w_A[n]$, by replacing the cosine term in the Hamming window definition with its second-order Taylor series approximation expanded around the temporal midpoint of the window, i.e., around the point corresponding to $n = (N-1)/2$.\n\nConsider the specific case of a length $N=5$ window. Determine the peak sidelobe level of the resulting approximated window, $w_A[n]$. The peak sidelobe level is defined as the ratio, in decibels (dB), of the magnitude of the highest sidelobe peak to the magnitude of the main lobe peak.\n\nExpress your final answer in dB, rounded to three significant figures.", "solution": "The problem asks for the peak sidelobe level of a modified Hamming window of length $N=5$.\n\nStep 1: Determine the approximated window function $w_A[n]$.\nThe argument of the cosine function is $x(n) = \\frac{2\\pi n}{N-1}$. The expansion is centered at $n = (N-1)/2$, where the argument is $x_c = \\frac{2\\pi}{N-1} \\frac{N-1}{2} = \\pi$.\nThe second-order Taylor series expansion of $\\cos(x)$ around $x=\\pi$ is:\n$$ \\cos(x) \\approx \\cos(\\pi) + \\frac{d}{dx}\\cos(x)\\bigg|_{x=\\pi}(x-\\pi) + \\frac{1}{2!} \\frac{d^2}{dx^2}\\cos(x)\\bigg|_{x=\\pi}(x-\\pi)^2 $$\n$$ \\cos(x) \\approx -1 - \\sin(\\pi)(x-\\pi) - \\frac{1}{2}\\cos(\\pi)(x-\\pi)^2 $$\n$$ \\cos(x) \\approx -1 + \\frac{1}{2}(x-\\pi)^2 $$\nSubstitute $x = \\frac{2\\pi n}{N-1}$:\n$$ \\cos\\left(\\frac{2\\pi n}{N-1}\\right) \\approx -1 + \\frac{1}{2}\\left(\\frac{2\\pi n}{N-1} - \\pi\\right)^2 = -1 + \\frac{\\pi^2}{2}\\left(\\frac{2n - (N-1)}{N-1}\\right)^2 $$\nNow, substitute this approximation into the Hamming window formula to get $w_A[n]$:\n$$ w_A[n] = 0.54 - 0.46 \\left[ -1 + \\frac{\\pi^2}{2}\\left(\\frac{2n - (N-1)}{N-1}\\right)^2 \\right] $$\n$$ w_A[n] = 0.54 + 0.46 - 0.23\\pi^2\\left(\\frac{2n - (N-1)}{N-1}\\right)^2 = 1.00 - 0.23\\pi^2\\left(\\frac{2n - (N-1)}{N-1}\\right)^2 $$\n\nStep 2: Calculate the window samples for $N=5$.\nFor $N=5$, the samples are for $n=0, 1, 2, 3, 4$. The denominator is $N-1=4$.\n$$ w_A[n] = 1.00 - 0.23\\pi^2\\left(\\frac{2n - 4}{4}\\right)^2 = 1.00 - 0.23\\pi^2\\left(\\frac{n - 2}{2}\\right)^2 $$\nLet's calculate the samples:\n- $n=0: w_A[0] = 1 - 0.23\\pi^2\\left(\\frac{-2}{2}\\right)^2 = 1 - 0.23\\pi^2 \\approx 1 - 0.23(9.8696) \\approx 1 - 2.270 = -1.270$\n- $n=1: w_A[1] = 1 - 0.23\\pi^2\\left(\\frac{-1}{2}\\right)^2 = 1 - \\frac{0.23\\pi^2}{4} \\approx 1 - 0.5675 = 0.4325$\n- $n=2: w_A[2] = 1 - 0.23\\pi^2\\left(\\frac{0}{2}\\right)^2 = 1$\n- $n=3: w_A[3] = 1 - 0.23\\pi^2\\left(\\frac{1}{2}\\right)^2 = 1 - \\frac{0.23\\pi^2}{4} \\approx 0.4325$\n- $n=4: w_A[4] = 1 - 0.23\\pi^2\\left(\\frac{2}{2}\\right)^2 = 1 - 0.23\\pi^2 \\approx -1.270$\nThe window sequence is approximately $\\{-1.270, 0.4325, 1, 0.4325, -1.270\\}$. Notice it is symmetric around $n=2$.\n\nStep 3: Find the Discrete-Time Fourier Transform (DTFT) of $w_A[n]$.\nThe DTFT is $W_A(\\omega) = \\sum_{n=0}^{4} w_A[n] e^{-j\\omega n}$.\nDue to symmetry around $n=2$, we can simplify by factoring out $e^{-j2\\omega}$:\n$$ W_A(\\omega) = e^{-j2\\omega} \\left( w_A[2] + w_A[1]e^{j\\omega} + w_A[3]e^{-j\\omega} + w_A[0]e^{j2\\omega} + w_A[4]e^{-j2\\omega} \\right) $$\n$$ W_A(\\omega) = e^{-j2\\omega} \\left( w_A[2] + 2w_A[1]\\cos(\\omega) + 2w_A[0]\\cos(2\\omega) \\right) $$\nThe magnitude spectrum $|W_A(\\omega)|$ is the absolute value of the real term in the parenthesis. Let's call it $A(\\omega)$.\n$$ A(\\omega) = 1 + 2(0.4325)\\cos(\\omega) + 2(-1.270)\\cos(2\\omega) = 1 + 0.865\\cos(\\omega) - 2.540\\cos(2\\omega) $$\n\nStep 4: Find the main lobe amplitude.\nThe main lobe peak is at $\\omega=0$.\n$$ A(0) = 1 + 0.865\\cos(0) - 2.540\\cos(0) = 1 + 0.865 - 2.540 = -0.675 $$\nThe main lobe amplitude is $|A(0)| = 0.675$.\n\nStep 5: Find the sidelobe peaks.\nWe need to find the extrema of $A(\\omega)$ for $\\omega \\neq 0$. We differentiate $A(\\omega)$ with respect to $\\omega$ and set it to zero.\n$$ \\frac{dA}{d\\omega} = -0.865\\sin(\\omega) - 2.540(-2\\sin(2\\omega)) = -0.865\\sin(\\omega) + 5.080\\sin(2\\omega) $$\nUsing $\\sin(2\\omega) = 2\\sin(\\omega)\\cos(\\omega)$:\n$$ \\frac{dA}{d\\omega} = -0.865\\sin(\\omega) + 10.16\\sin(\\omega)\\cos(\\omega) = \\sin(\\omega) (10.16\\cos(\\omega) - 0.865) = 0 $$\nThe extrema occur when $\\sin(\\omega)=0$ (which gives $\\omega = 0, \\pi, ...$) or when $10.16\\cos(\\omega) - 0.865 = 0$.\nThe case $\\omega=0$ is the main lobe.\nThe case $\\omega=\\pi$ gives a possible sidelobe peak:\n$$ A(\\pi) = 1 + 0.865\\cos(\\pi) - 2.540\\cos(2\\pi) = 1 - 0.865 - 2.540 = -2.405 $$\nThe other case is $\\cos(\\omega) = \\frac{0.865}{10.16} \\approx 0.08514$.\nTo evaluate $A(\\omega)$ here, we use $\\cos(2\\omega) = 2\\cos^2(\\omega) - 1$.\n$$ \\cos(2\\omega) = 2(0.08514)^2 - 1 \\approx 2(0.007249) - 1 = 0.0145 - 1 = -0.9855 $$\n$$ A(\\omega_{\\text{ext}}) = 1 + 0.865(0.08514) - 2.540(-0.9855) \\approx 1 + 0.0736 + 2.503 \\approx 3.577 $$\n\nTo confirm these are sidelobes, we check the first null of the spectrum. The main lobe ends where $A(\\omega)=0$ for the first time.\n$1 + 0.865\\cos\\omega - 2.540(2\\cos^2\\omega - 1) = 0 \\implies 5.08\\cos^2\\omega - 0.865\\cos\\omega - 3.54 = 0$.\nSolving the quadratic for $\\cos\\omega$ gives $\\cos\\omega \\approx 0.923$ or $\\cos\\omega \\approx -0.753$.\nThe first null is at $\\omega = \\arccos(0.923) \\approx 0.394$ rad.\nThe extrema we found at $\\omega=\\pi \\approx 3.14$ rad and $\\omega=\\arccos(0.08514) \\approx 1.486$ rad are both well outside the main lobe defined by $|\\omega| < 0.394$ rad.\nThe sidelobe peak amplitudes are $|-2.405| = 2.405$ and $|3.577| = 3.577$. The peak sidelobe is the larger of these two, which is $3.577$.\n\nStep 6: Calculate the peak sidelobe level in dB.\n$$ \\text{PSL} = 20 \\log_{10}\\left(\\frac{|\\text{peak sidelobe amplitude}|}{|\\text{main lobe amplitude}|}\\right) = 20 \\log_{10}\\left(\\frac{3.577}{0.675}\\right) $$\n$$ \\text{PSL} = 20 \\log_{10}(5.299) \\approx 20 \\times 0.7242 \\approx 14.484 \\text{ dB} $$\nRounding to three significant figures gives $14.5$ dB.\n\nAn interesting feature of this approximated window is that its sidelobes are larger than its main lobe, hence the positive dB value.", "answer": "$$\\boxed{14.5}$$", "id": "1723926"}]}