{"hands_on_practices": [{"introduction": "Let's begin with a foundational task in designing digital filters from analog prototypes: ensuring a key feature, like a cutoff frequency, appears exactly where we want it in the final design. This practice guides you through the core calculation of frequency prewarping. By converting a desired digital specification for an audio filter into the required analog prototype specification, you will practice how to directly compensate for the non-linear frequency mapping inherent in the bilinear transform. [@problem_id:1720731]", "problem": "A signal processing engineer is tasked with designing a digital low-pass filter for a high-fidelity audio system. The design methodology involves translating a well-characterized continuous-time (analog) filter prototype into a discrete-time (digital) filter using the Bilinear Transform. The audio system operates with a sampling frequency, $F_s$, of $20.0 \\text{ kHz}$.\n\nThe primary design specification is that the resulting digital filter must exhibit its cutoff frequency (conventionally the -3 dB attenuation point) at precisely one-half of the Nyquist frequency of the system. The Bilinear Transform is known to cause a non-linear compression, or \"warping,\" of the frequency axis when mapping from the continuous-time domain to the discrete-time domain. To counteract this effect and achieve the desired digital cutoff frequency, the cutoff frequency of the analog prototype must be appropriately pre-adjusted, a technique known as frequency prewarping.\n\nCalculate the required prewarped cutoff frequency that must be used for the analog filter prototype. Express your answer in kilohertz (kHz) and round it to three significant figures.", "solution": "The bilinear transform maps continuous-time angular frequency $\\Omega$ (in radians per second) to discrete-time angular frequency $\\omega$ (in radians per sample) by\n$$\n\\omega=2\\arctan\\!\\left(\\frac{\\Omega T}{2}\\right),\n$$\nwhere $T=\\frac{1}{F_{s}}$ is the sampling period. To prewarp a desired digital cutoff to an analog prototype cutoff, solve for $\\Omega$:\n$$\n\\Omega=\\frac{2}{T}\\tan\\!\\left(\\frac{\\omega}{2}\\right)=2F_{s}\\tan\\!\\left(\\frac{\\omega}{2}\\right).\n$$\nThe specification requires the digital cutoff at one-half the Nyquist frequency. The Nyquist frequency is $\\frac{F_{s}}{2}$, so the desired digital cutoff in hertz is $f_{d}=\\frac{F_{s}}{4}$. The corresponding discrete-time angular frequency is\n$$\n\\omega_{c}=\\frac{2\\pi f_{d}}{F_{s}}=\\frac{2\\pi}{F_{s}}\\cdot\\frac{F_{s}}{4}=\\frac{\\pi}{2}.\n$$\nHence the prewarped analog angular cutoff is\n$$\n\\Omega_{p}=2F_{s}\\tan\\!\\left(\\frac{\\omega_{c}}{2}\\right)=2F_{s}\\tan\\!\\left(\\frac{\\pi}{4}\\right)=2F_{s}.\n$$\nConverting to hertz, $f_{p}=\\frac{\\Omega_{p}}{2\\pi}$, gives\n$$\nf_{p}=\\frac{2F_{s}}{2\\pi}=\\frac{F_{s}}{\\pi}.\n$$\nWith $F_{s}=20.0\\ \\text{kHz}$, this becomes\n$$\nf_{p}=\\frac{20.0}{\\pi}\\ \\text{kHz}\\approx 6.366\\ \\text{kHz}.\n$$\nRounding to three significant figures yields $6.37\\ \\text{kHz}$.", "answer": "$$\\boxed{6.37}$$", "id": "1720731"}, {"introduction": "Now that you have practiced the correct procedure, it's crucial to understand *why* it's so important. This problem explores a common pitfall: what happens if we ignore frequency prewarping and naively assume a direct, linear correspondence between a filter's analog and digital frequencies? By calculating the significant error that results from this mistake, you will gain a concrete appreciation for a key aspect of the bilinear transform and the absolute necessity of prewarping for accurate filter design. [@problem_id:1720719]", "problem": "In digital filter design, the bilinear transform is a common method for converting an analog filter design into a digital one. This transform maps the entire $j\\Omega$ axis of the complex $s$-plane onto the unit circle $z = e^{j\\omega}$ of the $z$-plane, but the mapping is nonlinear. The relationship between the analog frequency $\\Omega$ (in rad/s) and the digital frequency $\\omega$ (in rad/sample) is given by $\\Omega = \\frac{2}{T} \\tan\\left(\\frac{\\omega}{2}\\right)$, where $T$ is the sampling period in seconds. To compensate for this nonlinearity, a technique called frequency prewarping is typically used.\n\nAn engineer is designing a first-order digital low-pass filter based on an analog prototype with the transfer function $H_a(s) = \\frac{\\Omega_c}{s + \\Omega_c}$, where $\\Omega_c$ is the analog cutoff frequency. The design specification requires the final digital filter to have a 3-dB cutoff frequency at a desired digital frequency $\\omega_d$. The 3-dB cutoff frequency is the frequency at which the filter's magnitude response is $1/\\sqrt{2}$ times its DC gain; for the given $H_a(s)$, this occurs precisely at the frequency $\\Omega = \\Omega_c$.\n\nThe engineer, however, neglects to apply frequency prewarping. Instead, they make a common mistake by assuming a direct correspondence between the frequency values. They set the analog cutoff frequency $\\Omega_c$ in the prototype filter to be numerically equal to the desired digital cutoff frequency $\\omega_d$.\n\nGiven a desired digital cutoff frequency $\\omega_d = 0.2\\pi$ radians/sample and a sampling period $T = 0.5$ s, this mistake leads to an actual digital cutoff frequency, $\\omega_a$, that differs from the desired $\\omega_d$. Calculate the relative error in the cutoff frequency, defined as $\\epsilon = \\frac{\\omega_a - \\omega_d}{\\omega_d}$.\n\nProvide your answer for the relative error $\\epsilon$ as a decimal value rounded to three significant figures.", "solution": "The bilinear transform maps analog and digital frequencies by the relation\n$$\n\\Omega=\\frac{2}{T}\\tan\\!\\left(\\frac{\\omega}{2}\\right),\n$$\nso a given analog frequency $\\Omega$ corresponds to a digital frequency\n$$\n\\omega=2\\,\\arctan\\!\\left(\\frac{\\Omega T}{2}\\right).\n$$\nFor the first-order analog low-pass prototype $H_{a}(s)=\\frac{\\Omega_{c}}{s+\\Omega_{c}}$, the $3$-dB cutoff occurs at $\\Omega=\\Omega_{c}$. Without prewarping, the engineer sets $\\Omega_{c}=\\omega_{d}$. Therefore, the actual digital cutoff frequency after the bilinear transform is\n$$\n\\omega_{a}=2\\,\\arctan\\!\\left(\\frac{\\Omega_{c}T}{2}\\right)=2\\,\\arctan\\!\\left(\\frac{\\omega_{d}T}{2}\\right).\n$$\nThe relative error is defined as\n$$\n\\epsilon=\\frac{\\omega_{a}-\\omega_{d}}{\\omega_{d}}=\\frac{2\\,\\arctan\\!\\left(\\frac{\\omega_{d}T}{2}\\right)-\\omega_{d}}{\\omega_{d}}.\n$$\nWith $\\omega_{d}=0.2\\pi=\\frac{\\pi}{5}$ and $T=0.5$, we have\n$$\n\\frac{\\omega_{d}T}{2}=\\frac{\\left(\\frac{\\pi}{5}\\right)\\left(\\frac{1}{2}\\right)}{2}=\\frac{\\pi}{20},\n$$\nso\n$$\n\\omega_{a}=2\\,\\arctan\\!\\left(\\frac{\\pi}{20}\\right),\\quad\n\\epsilon=\\frac{2\\,\\arctan\\!\\left(\\frac{\\pi}{20}\\right)-\\frac{\\pi}{5}}{\\frac{\\pi}{5}}=\\frac{10}{\\pi}\\arctan\\!\\left(\\frac{\\pi}{20}\\right)-1.\n$$\nNumerically evaluating,\n$$\n\\arctan\\!\\left(\\frac{\\pi}{20}\\right)\\approx 0.1558065,\\quad \\omega_{a}\\approx 0.311613,\n$$\nand with $\\omega_{d}=\\frac{\\pi}{5}\\approx 0.628319$,\n$$\n\\epsilon=\\frac{0.311613-0.628319}{0.628319}\\approx -0.504.\n$$\nRounded to three significant figures, the relative error is $-0.504$.", "answer": "$$\\boxed{-0.504}$$", "id": "1720719"}, {"introduction": "Moving beyond single-frequency specifications, let's apply our knowledge to a more complex and practical scenario: designing a bandpass filter. This exercise requires you to prewarp two distinct cutoff frequencies that define the filter's passband. In doing so, you will discover a key consequence of the transform's non-linear warping: the bandwidth of the prewarped analog filter is not the same as the bandwidth of the target digital filter. This is a critical insight for designing any filter that must operate accurately over a specific frequency range. [@problem_id:1720737]", "problem": "An audio engineer is tasked with designing a digital Infinite Impulse Response (IIR) filter to isolate a specific frequency range in a musical recording. The design will be implemented using the bilinear transformation method, which maps a continuous-time (analog) filter prototype to a discrete-time (digital) filter. The digital filter is required to have a passband defined by a lower cutoff frequency of $f_{d1} = 6.00$ kHz and an upper cutoff frequency of $f_{d2} = 12.0$ kHz. The audio system operates at a sampling frequency of $f_s = 48.0$ kHz.\n\nTo ensure the cutoff frequencies of the final digital filter are correct, the corresponding cutoff frequencies of the analog prototype filter must be \"prewarped\" before its design. Calculate the required bandwidth of this prewarped analog prototype filter. Express your answer in kilohertz (kHz) and round it to three significant figures.", "solution": "For the bilinear transformation, the relation between the analog radian frequency $\\Omega$ and the digital radian frequency $\\omega$ is\n$$\n\\Omega=\\frac{2}{T}\\tan\\!\\left(\\frac{\\omega}{2}\\right), \\quad T=\\frac{1}{f_{s}}.\n$$\nConverting to Hertz, $F=\\frac{\\Omega}{2\\pi}$ and using $\\omega=2\\pi \\frac{f_{d}}{f_{s}}$, the prewarped analog frequency corresponding to a digital frequency $f_{d}$ is\n$$\nF=\\frac{f_{s}}{\\pi}\\tan\\!\\left(\\pi\\frac{f_{d}}{f_{s}}\\right).\n$$\nTherefore, the prewarped analog passband edge frequencies are\n$$\nF_{1}=\\frac{f_{s}}{\\pi}\\tan\\!\\left(\\pi\\frac{f_{d1}}{f_{s}}\\right), \\quad F_{2}=\\frac{f_{s}}{\\pi}\\tan\\!\\left(\\pi\\frac{f_{d2}}{f_{s}}\\right),\n$$\nand the required analog bandwidth is\n$$\nB=F_{2}-F_{1}=\\frac{f_{s}}{\\pi}\\left[\\tan\\!\\left(\\pi\\frac{f_{d2}}{f_{s}}\\right)-\\tan\\!\\left(\\pi\\fracf_{d1}}{f_{s}}\\right)\\right].\n$$\nWith $f_{s}=48.0\\ \\text{kHz}$, $f_{d1}=6.00\\ \\text{kHz}$, and $f_{d2}=12.0\\ \\text{kHz}$,\n$$\n\\pi\\frac{f_{d1}}{f_{s}}=\\frac{\\pi}{8}, \\quad \\pi\\frac{f_{d2}}{f_{s}}=\\frac{\\pi}{4},\n$$\nso that $\\tan(\\pi/4)=1$ and $\\tan(\\pi/8)=\\sqrt{2}-1$. Hence,\n$$\nB=\\frac{48}{\\pi}\\left[1-(\\sqrt{2}-1)\\right]\\ \\text{kHz}=\\frac{48}{\\pi}(2-\\sqrt{2})\\ \\text{kHz}.\n$$\nNumerically,\n$$\nB\\approx \\frac{48}{\\pi}\\times 0.5857864376\\ \\text{kHz}\\approx 8.95016013\\ \\text{kHz},\n$$\nwhich rounded to three significant figures is $8.95\\ \\text{kHz}$.", "answer": "$$\\boxed{8.95}$$", "id": "1720737"}]}