{"hands_on_practices": [{"introduction": "This first exercise establishes the core principle of the mainlobe-sidelobe trade-off. By quantitatively comparing the frequency spectra of a rectangular window and a triangular window of the same duration, we can directly observe this fundamental compromise. Calculating the mainlobe width and sidelobe levels gives us concrete metrics to evaluate how a window's shape affects its performance in the frequency domain [@problem_id:1736404].", "problem": "In signal processing, applying a \"window function\" to a block of data is a crucial step before performing a Fourier transform. This is done to mitigate spectral leakage, an effect where energy from a signal at one frequency \"leaks\" into other frequency bins. Different window functions offer different trade-offs between resolving closely spaced frequency components and suppressing this leakage.\n\nThis problem asks you to quantitatively analyze the trade-off between two fundamental window functions: the rectangular window and the triangular (or Bartlett) window. Both are defined to be non-zero only over the interval $|t| \\le \\frac{T}{2}$.\n\n1.  **Rectangular window:** $w_R(t) = 1$ for $|t| \\le \\frac{T}{2}$, and $w_R(t) = 0$ otherwise.\n2.  **Triangular window:** $w_T(t) = 1 - \\frac{2|t|}{T}$ for $|t| \\le \\frac{T}{2}$, and $w_T(t) = 0$ otherwise.\n\nThe spectral characteristics of these windows are determined by their Fourier Transforms, $W(f) = \\int_{-\\infty}^{\\infty} w(t) \\exp(-j 2\\pi f t) dt$. For your calculations, use the normalized sinc function, defined as $\\text{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$.\n\nWe will use the following two metrics to evaluate the performance of these windows:\n\n*   **Mainlobe Width:** The width of the central peak in the frequency spectrum, defined as the distance in frequency (in Hz) between the first two nulls (zeros) on either side of the main peak at $f=0$.\n*   **Peak Sidelobe Level (PSL):** A measure of the strength of the largest sidelobe relative to the mainlobe. For the purpose of this problem, we will approximate the peak magnitude of the first sidelobe by evaluating the spectrum's magnitude $|W(f)|$ at the frequency midpoint between the first and second nulls away from the center ($f=0$). The PSL is the ratio of this approximate sidelobe peak magnitude to the mainlobe peak magnitude, $|W(0)|$.\n\nYour task is to calculate the following two dimensionless ratios:\n\nA. The ratio of the mainlobe width of the triangular window's spectrum to that of the rectangular window's spectrum, $\\frac{\\text{Width}_T}{\\text{Width}_R}$.\nB. The ratio of the Peak Sidelobe Level of the triangular window's spectrum to that of the rectangular window's spectrum, $\\frac{\\text{PSL}_T}{\\text{PSL}_R}$.\n\nPresent your final answer as an ordered pair of analytic expressions for $(\\frac{\\text{Width}_T}{\\text{Width}_R}, \\frac{\\text{PSL}_T}{\\text{PSL}_R})$.", "solution": "Define the Fourier transform as $W(f)=\\int_{-\\infty}^{\\infty} w(t)\\exp(-j2\\pi f t)\\,dt$ and the normalized sinc as $\\text{sinc}(x)=\\frac{\\sin(\\pi x)}{\\pi x}$.\n\nFor the rectangular window $w_{R}(t)=1$ for $|t|\\leq T/2$ and $0$ otherwise, compute\n$$\nW_{R}(f)=\\int_{-T/2}^{T/2}\\exp(-j2\\pi f t)\\,dt\n=\\left.\\frac{\\exp(-j2\\pi f t)}{-j2\\pi f}\\right|_{-T/2}^{T/2}\n=\\frac{\\exp(-j\\pi f T)-\\exp(j\\pi f T)}{-j2\\pi f}\n=T\\,\\text{sinc}(fT).\n$$\nZeros occur where $\\sin(\\pi fT)=0$ for $f\\neq 0$, i.e., at $f=\\pm\\frac{1}{T},\\pm\\frac{2}{T},\\ldots$. Hence the mainlobe width (distance between the first two nulls around $f=0$) is\n$$\n\\text{Width}_{R}=\\frac{1}{T}-\\left(-\\frac{1}{T}\\right)=\\frac{2}{T}.\n$$\nThe mainlobe peak is $|W_{R}(0)|=\\int_{-T/2}^{T/2}1\\,dt=T$. The first and second nulls are at $f=\\frac{1}{T}$ and $f=\\frac{2}{T}$, so their midpoint is $f=\\frac{3}{2T}$. The approximate sidelobe magnitude at this midpoint is\n$$\n|W_{R}(\\tfrac{3}{2T})|=T\\,\\left|\\text{sinc}\\!\\left(\\tfrac{3}{2}\\right)\\right|,\n$$\nso the rectangular PSL is\n$$\n\\text{PSL}_{R}=\\frac{|W_{R}(\\tfrac{3}{2T})|}{|W_{R}(0)|}=\\left|\\text{sinc}\\!\\left(\\tfrac{3}{2}\\right)\\right|\n=\\left|\\frac{\\sin(\\tfrac{3}{2}\\pi)}{\\tfrac{3}{2}\\pi}\\right|\n=\\frac{2}{3\\pi}.\n$$\n\nFor the triangular window $w_{T}(t)=1-\\frac{2|t|}{T}$ for $|t|\\leq T/2$ and $0$ otherwise, note that $w_{T}(t)=\\text{tri}\\!\\left(\\tfrac{2t}{T}\\right)$ and use the convolution identity $\\text{tri}(x)=(\\text{rect}*\\text{rect})(x)$. Let $u(t)=\\text{rect}\\!\\left(\\tfrac{2t}{T}\\right)$, so $w_{T}(t)=\\frac{2}{T}(u*u)(t)$. By the convolution theorem,\n$$\nW_{T}(f)=\\frac{2}{T}\\,U(f)^{2},\\quad U(f)=\\int u(t)\\exp(-j2\\pi f t)\\,dt=\\frac{T}{2}\\,\\text{sinc}\\!\\left(\\frac{fT}{2}\\right).\n$$\nTherefore,\n$$\nW_{T}(f)=\\frac{2}{T}\\left(\\frac{T}{2}\\,\\text{sinc}\\!\\left(\\frac{fT}{2}\\right)\\right)^{2}\n=\\frac{T}{2}\\,\\text{sinc}^{2}\\!\\left(\\frac{fT}{2}\\right).\n$$\nZeros occur when $\\text{sinc}\\!\\left(\\frac{fT}{2}\\right)=0$, i.e., at $\\frac{fT}{2}=\\pm 1,\\pm 2,\\ldots$, so the first two nulls are at $f=\\pm\\frac{2}{T}$. Hence the mainlobe width is\n$$\n\\text{Width}_{T}=\\frac{2}{T}-\\left(-\\frac{2}{T}\\right)=\\frac{4}{T}.\n$$\nThus the mainlobe-width ratio is\n$$\n\\frac{\\text{Width}_{T}}{\\text{Width}_{R}}=\\frac{\\frac{4}{T}}{\\frac{2}{T}}=2.\n$$\nThe mainlobe peak is $|W_{T}(0)|=\\int_{-T/2}^{T/2}\\left(1-\\frac{2|t|}{T}\\right)\\,dt=\\frac{T}{2}$, which also follows from $W_{T}(0)=\\frac{T}{2}\\,\\text{sinc}^{2}(0)=\\frac{T}{2}$. For PSL, the first two nulls are at $f=\\frac{2}{T}$ and $f=\\frac{4}{T}$, whose midpoint is $f=\\frac{3}{T}$. The approximate sidelobe magnitude is then\n$$\n|W_{T}(\\tfrac{3}{T})|=\\frac{T}{2}\\,\\left|\\text{sinc}\\!\\left(\\tfrac{3}{2}\\right)\\right|^{2},\n$$\nso\n$$\n\\text{PSL}_{T}=\\frac{|W_{T}(\\tfrac{3}{T})|}{|W_{T}(0)|}=\\left|\\text{sinc}\\!\\left(\\tfrac{3}{2}\\right)\\right|^{2}\n=\\left(\\frac{2}{3\\pi}\\right)^{2}.\n$$\nTherefore the PSL ratio is\n$$\n\\frac{\\text{PSL}_{T}}{\\text{PSL}_{R}}=\\frac{\\left(\\frac{2}{3\\pi}\\right)^{2}}{\\frac{2}{3\\pi}}=\\frac{2}{3\\pi}.\n$$\n\nThe required ordered pair is $\\left(\\frac{\\text{Width}_{T}}{\\text{Width}_{R}},\\frac{\\text{PSL}_{T}}{\\text{PSL}_{R}}\\right)=\\left(2,\\frac{2}{3\\pi}\\right)$.", "answer": "$$\\boxed{\\left(2, \\frac{2}{3\\pi}\\right)}$$", "id": "1736404"}, {"introduction": "Building on the concept of mainlobe width, this practice connects window theory to a tangible application in signal analysis. We will determine the minimum frequency separation required to distinguish two distinct signal components, a critical performance metric known as frequency resolution. This exercise demonstrates how the choice of a window function and the total observation time $T$ directly impact the resolving power of a measurement system [@problem_id:1736446].", "problem": "A signal processor is used to analyze the vibration data from a precision milling machine. The data is collected over a total observation time of $T = 400$ ms. To reduce spectral leakage, the collected data segment is multiplied by a triangular window function, $w(t)$, before performing a Fourier transform. The triangular window is defined as $w(t) = 1 - \\frac{2|t|}{T}$ for $|t| \\le T/2$, and $w(t)=0$ otherwise. Two distinct vibrational modes of similar amplitude are considered to be just resolvable in frequency if the peak of the spectral response of one mode coincides with the first null (zero-crossing) of the spectral response of the other. Determine the minimum frequency separation between two such modes that this system can resolve. Express your answer in Hertz (Hz), rounded to three significant figures.", "solution": "The problem asks for the minimum resolvable frequency separation, $\\Delta f_{\\text{min}}$, for a system that uses a triangular window of duration $T$. The resolution criterion is given as the Rayleigh criterion: two spectral peaks are resolved if the maximum of one falls on the first minimum of the other.\n\nWhen a signal containing sinusoids is multiplied by a window function $w(t)$, its spectrum is the convolution of the sinusoids' spectra (impulses) with the Fourier transform of the window function, $W(f)$. This means the spectrum of each sinusoidal component will have the shape of $W(f)$. Therefore, to find the minimum resolvable frequency separation, we need to find the frequency of the first null of $W(f)$ relative to its peak at $f=0$.\n\nFirst, we compute the Fourier Transform of the triangular window function $w(t)$.\nThe window is defined as $w(t) = 1 - \\frac{2|t|}{T}$ for $|t| \\le T/2$ and $0$ otherwise.\nThe Fourier Transform $W(f)$ is given by:\n$$W(f) = \\int_{-\\infty}^{\\infty} w(t) e^{-j 2\\pi f t} dt = \\int_{-T/2}^{T/2} \\left(1 - \\frac{2|t|}{T}\\right) e^{-j 2\\pi f t} dt$$\nSince $w(t)$ is a real and even function, its transform $W(f)$ will also be real and even. We can simplify the integral:\n$$W(f) = 2 \\int_{0}^{T/2} \\left(1 - \\frac{2t}{T}\\right) \\cos(2\\pi f t) dt$$\nWe can solve this integral using integration by parts, $\\int u \\, dv = uv - \\int v \\, du$.\nLet $u = 1 - \\frac{2t}{T}$ and $dv = \\cos(2\\pi f t) dt$.\nThen $du = -\\frac{2}{T} dt$ and $v = \\frac{\\sin(2\\pi f t)}{2\\pi f}$.\nThe integral becomes:\n$$ \\int \\left(1 - \\frac{2t}{T}\\right) \\cos(2\\pi f t) dt = \\left(1 - \\frac{2t}{T}\\right) \\frac{\\sin(2\\pi f t)}{2\\pi f} - \\int \\frac{\\sin(2\\pi f t)}{2\\pi f} \\left(-\\frac{2}{T}\\right) dt $$\n$$ = \\left(1 - \\frac{2t}{T}\\right) \\frac{\\sin(2\\pi f t)}{2\\pi f} + \\frac{2}{T(2\\pi f)} \\int \\sin(2\\pi f t) dt $$\n$$ = \\left(1 - \\frac{2t}{T}\\right) \\frac{\\sin(2\\pi f t)}{2\\pi f} - \\frac{2}{T(2\\pi f)^2} \\cos(2\\pi f t) $$\nNow, we evaluate this from $t=0$ to $t=T/2$:\n$$ \\left[ \\left(1 - \\frac{2t}{T}\\right) \\frac{\\sin(2\\pi f t)}{2\\pi f} - \\frac{2 \\cos(2\\pi f t)}{T(2\\pi f)^2} \\right]_{0}^{T/2} $$\nAt the upper limit $t=T/2$:\n$$ \\left(1 - \\frac{2(T/2)}{T}\\right) \\frac{\\sin(\\pi f T)}{2\\pi f} - \\frac{2 \\cos(\\pi f T)}{T(2\\pi f)^2} = 0 - \\frac{2 \\cos(\\pi f T)}{4T\\pi^2 f^2} = -\\frac{\\cos(\\pi f T)}{2T\\pi^2 f^2} $$\nAt the lower limit $t=0$:\n$$ \\left(1 - 0\\right) \\frac{\\sin(0)}{2\\pi f} - \\frac{2 \\cos(0)}{T(2\\pi f)^2} = 0 - \\frac{2}{4T\\pi^2 f^2} = -\\frac{1}{2T\\pi^2 f^2} $$\nThe value of the integral is (upper limit) - (lower limit):\n$$ \\int_{0}^{T/2} \\dots dt = -\\frac{\\cos(\\pi f T)}{2T\\pi^2 f^2} - \\left(-\\frac{1}{2T\\pi^2 f^2}\\right) = \\frac{1 - \\cos(\\pi f T)}{2T\\pi^2 f^2} $$\nNow, we multiply by the factor of 2 from the initial simplification of $W(f)$:\n$$ W(f) = 2 \\cdot \\frac{1 - \\cos(\\pi f T)}{2T\\pi^2 f^2} = \\frac{1 - \\cos(\\pi f T)}{T\\pi^2 f^2} $$\nUsing the identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we let $\\theta = \\pi f T$:\n$$ W(f) = \\frac{2\\sin^2(\\pi f T / 2)}{T\\pi^2 f^2} $$\nTo express this in terms of the unnormalized sinc function, $\\text{sinc}(x) = \\sin(x)/x$, we rearrange the expression:\n$$ W(f) = \\frac{T}{2} \\cdot \\frac{4\\sin^2(\\pi f T / 2)}{T^2\\pi^2 f^2} = \\frac{T}{2} \\left( \\frac{\\sin(\\pi f T / 2)}{\\pi f T / 2} \\right)^2 = \\frac{T}{2} \\text{sinc}^2\\left(\\frac{\\pi f T}{2}\\right) $$\nThe main lobe of $W(f)$ is centered at $f=0$. The first nulls occur when the argument of the sinc function is a non-zero integer multiple of $\\pi$. So, for the first null, we set the argument to $\\pm \\pi$:\n$$ \\frac{\\pi f_{\\text{null}} T}{2} = \\pm \\pi $$\nSolving for $f_{\\text{null}}$ gives:\n$$ f_{\\text{null}} = \\pm \\frac{2}{T} $$\nThe distance from the central peak at $f=0$ to the first null is $2/T$. According to the problem's resolution criterion, this distance is the minimum resolvable frequency separation, $\\Delta f_{\\text{min}}$.\n$$ \\Delta f_{\\text{min}} = \\frac{2}{T} $$\nWe are given $T = 400$ ms, which is $0.400$ s.\n$$ \\Delta f_{\\text{min}} = \\frac{2}{0.400 \\text{ s}} = 5.00 \\text{ Hz} $$\nThe minimum resolvable frequency separation is 5.00 Hz.", "answer": "$$\\boxed{5.00}$$", "id": "1736446"}, {"introduction": "This final exercise transitions from analyzing existing windows to synthesizing a new one with desired characteristics, a key skill in filter design. You will craft a custom Finite Impulse Response (FIR) window by strategically placing nulls in its frequency response at specific frequencies, $\\omega$, to reject interference. This practice demonstrates the power of controlling a filter's spectral shape by manipulating the locations of its zeros [@problem_id:1736389].", "problem": "An engineer is designing a custom window for a spectral analysis application. The window is a 5-tap, symmetric, zero-phase Finite Impulse Response (FIR) filter, with coefficients denoted by $w[n]$ for $n \\in \\{-2, -1, 0, 1, 2\\}$, where $w[n] = w[-n]$. To achieve specific interference rejection, the window's frequency response, which is its Discrete-Time Fourier Transform (DTFT) $W(e^{j\\omega})$, must have nulls (zeros) at the normalized angular frequencies $\\omega_1 = \\frac{\\pi}{2}$ radians/sample and $\\omega_2 = \\frac{3\\pi}{4}$ radians/sample.\n\nThe frequency spectrum of this window is characterized by a central mainlobe around $\\omega=0$ and a series of smaller sidelobes at higher frequencies. The mainlobe is defined as the region around $\\omega=0$ bounded by the first nulls. The peak mainlobe level is the magnitude of the frequency response at $\\omega=0$. The peak sidelobe level is defined as the maximum absolute value of the frequency response outside the mainlobe region.\n\nCalculate the ratio of the peak sidelobe level to the peak mainlobe level for this custom window. Express your answer as a numerical value rounded to four significant figures.", "solution": "For a 5-tap symmetric, zero-phase FIR with $w[n]=w[-n]$ and support $n\\in\\{-2,-1,0,1,2\\}$, the DTFT reduces to a real even cosine series:\n$$\nW(\\exp(j\\omega))=\\sum_{n=-2}^{2}w[n]\\exp(-j\\omega n)=w[0]+2w[1]\\cos\\omega+2w[2]\\cos 2\\omega.\n$$\nLet $x=\\cos\\omega$. Using $\\cos 2\\omega=2x^{2}-1$, $W(\\exp(j\\omega))$ is a quadratic in $x$. Imposing $W(\\exp(j\\omega_{1}))=0$ and $W(\\exp(j\\omega_{2}))=0$ at $\\omega_{1}=\\frac{\\pi}{2}$ and $\\omega_{2}=\\frac{3\\pi}{4}$ with $x_{1}=\\cos\\omega_{1}=0$ and $x_{2}=\\cos\\omega_{2}=-\\frac{\\sqrt{2}}{2}$, the unique (up to a nonzero scale $K$) quadratic with these roots is\n$$\nW(\\exp(j\\omega))=K\\big(\\cos\\omega-\\cos\\omega_{1}\\big)\\big(\\cos\\omega-\\cos\\omega_{2}\\big)=K\\,\\cos\\omega\\left(\\cos\\omega+\\frac{\\sqrt{2}}{2}\\right).\n$$\nThe mainlobe is bounded by the first nulls at $\\omega=\\pm\\frac{\\pi}{2}$. Its peak level is at $\\omega=0$:\n$$\n|W(\\exp(j\\cdot 0))|=|K|\\left(\\cos 0\\right)\\left(\\cos 0+\\frac{\\sqrt{2}}{2}\\right)=|K|\\left(1+\\frac{\\sqrt{2}}{2}\\right).\n$$\nOutside the mainlobe, consider\n$$\nf(\\omega)=\\cos\\omega\\left(\\cos\\omega+\\frac{\\sqrt{2}}{2}\\right),\n$$\nso $W(\\exp(j\\omega))=K f(\\omega)$. Its derivative is\n$$\n\\frac{d}{d\\omega}f(\\omega)=-\\sin\\omega\\left(2\\cos\\omega+\\frac{\\sqrt{2}}{2}\\right).\n$$\nOn $\\omega\\in\\left[\\frac{\\pi}{2},\\frac{3\\pi}{4}\\right]$, $\\sin\\omega>0$ and $2\\cos\\omega+\\frac{\\sqrt{2}}{2}$ changes sign once, yielding a stationary point at $\\cos\\omega=-\\frac{\\sqrt{2}}{4}$. There,\n$$\nf=\\left(-\\frac{\\sqrt{2}}{4}\\right)\\left(-\\frac{\\sqrt{2}}{4}+\\frac{\\sqrt{2}}{2}\\right)=-\\frac{1}{8},\n$$\nso the first sidelobe magnitude is $\\frac{1}{8}|K|$.\n\nOn $\\omega\\in\\left[\\frac{3\\pi}{4},\\pi\\right]$, one has $\\sin\\omega\\geq 0$ and $2\\cos\\omega+\\frac{\\sqrt{2}}{2}<0$, hence $\\frac{d}{d\\omega}f(\\omega)>0$, so $f$ increases to its maximum at $\\omega=\\pi$:\n$$\nf(\\pi)=\\cos\\pi\\left(\\cos\\pi+\\frac{\\sqrt{2}}{2}\\right)=(-1)\\left(-1+\\frac{\\sqrt{2}}{2}\\right)=1-\\frac{1}{\\sqrt{2}}.\n$$\nComparing $1-\\frac{1}{\\sqrt{2}}$ and $\\frac{1}{8}$, multiply both sides by $8\\sqrt{2}>0$ to obtain $8\\sqrt{2}-8$ versus $\\sqrt{2}$, i.e., $7\\sqrt{2}>8$, which is true (squaring gives $98>64$). Thus the peak sidelobe level is\n$$\n\\text{PSL}=|K|\\left(1-\\frac{1}{\\sqrt{2}}\\right).\n$$\nThe peak mainlobe level is\n$$\n\\text{PML}=|K|\\left(1+\\frac{1}{\\sqrt{2}}\\right).\n$$\nTherefore the desired ratio is\n$$\nR=\\frac{\\text{PSL}}{\\text{PML}}=\\frac{1-\\frac{1}{\\sqrt{2}}}{1+\\frac{1}{\\sqrt{2}}}=\\frac{\\sqrt{2}-1}{\\sqrt{2}+1}=(\\sqrt{2}-1)^{2}=3-2\\sqrt{2}.\n$$\nNumerically, $R\\approx 0.171572875\\ldots$, which rounded to four significant figures is $0.1716$.", "answer": "$$\\boxed{0.1716}$$", "id": "1736389"}]}