{"hands_on_practices": [{"introduction": "The journey of designing a practical FIR filter often begins with a purely theoretical concept: the ideal filter. This exercise provides the foundational practice of translating an ideal low-pass filter's frequency response into its time-domain impulse response and then applying the simplest windowing technique—truncation—to create a finite-length filter. By calculating the coefficients directly, you will gain a concrete understanding of how the abstract properties of an ideal filter are transformed into the tangible values that define a real-world digital filter [@problem_id:1719431].", "problem": "A digital signal processing system is being designed to remove high-frequency noise. The system uses a linear phase Finite Impulse Response (FIR) filter with 7 taps. Its impulse response, denoted $h[n]$, is therefore real-valued, symmetric, and has a finite duration.\n\nThe design procedure starts with the frequency response of an ideal low-pass filter, $H_d(e^{j\\omega})$, which is defined over one period $-\\pi \\le \\omega < \\pi$ as:\n$$ H_d(e^{j\\omega}) = \\begin{cases} 1 & \\text{for } |\\omega| \\le \\frac{\\pi}{2} \\\\ 0 & \\text{for } \\frac{\\pi}{2} < |\\omega| \\le \\pi \\end{cases} $$\nThe corresponding ideal impulse response, $h_d[n]$, is found by taking the inverse transform of $H_d(e^{j\\omega})$.\n\nTo create the 7-tap filter, the ideal impulse response $h_d[n]$ is truncated to be non-zero only for indices $n$ from $-3$ to $3$. This creates a non-causal, zero-phase filter with coefficients denoted as $h_{nc}[n]$. The coefficients are defined as:\n$$ h_{nc}[n] = \\begin{cases} h_d[n] & \\text{for } n \\in \\{-3, -2, -1, 0, 1, 2, 3\\} \\\\ 0 & \\text{otherwise} \\end{cases} $$\nDetermine the seven non-zero coefficients of this non-causal filter, $h_{nc}[-3], h_{nc}[-2], \\dots, h_{nc}[3]$. Present your answer as a sequence of these seven values, ordered by increasing index from $n=-3$ to $n=3$. Your answers must be exact analytical expressions in terms of constants like $\\pi$.", "solution": "The ideal low-pass filter with cutoff frequency $\\omega_{c}=\\frac{\\pi}{2}$ has frequency response $H_{d}(\\exp(j\\omega))=1$ for $|\\omega|\\leq \\frac{\\pi}{2}$ and $0$ otherwise on $[-\\pi,\\pi)$. The corresponding ideal impulse response is given by the inverse DTFT:\n$$\nh_{d}[n]=\\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi}H_{d}(\\exp(j\\omega))\\exp(j\\omega n)\\,d\\omega\n=\\frac{1}{2\\pi}\\int_{-\\frac{\\pi}{2}}^{\\frac{\\pi}{2}}\\exp(j\\omega n)\\,d\\omega.\n$$\nFor $n=0$,\n$$\nh_{d}[0]=\\frac{1}{2\\pi}\\int_{-\\frac{\\pi}{2}}^{\\frac{\\pi}{2}}1\\,d\\omega=\\frac{1}{2\\pi}\\left(\\pi\\right)=\\frac{1}{2}.\n$$\nFor $n\\neq 0$,\n$$\nh_{d}[n]=\\frac{1}{2\\pi}\\left[\\frac{\\exp(j\\omega n)}{j n}\\right]_{-\\frac{\\pi}{2}}^{\\frac{\\pi}{2}}\n=\\frac{1}{2\\pi j n}\\left(\\exp\\!\\left(j\\frac{\\pi n}{2}\\right)-\\exp\\!\\left(-j\\frac{\\pi n}{2}\\right)\\right)\n=\\frac{1}{\\pi n}\\sin\\!\\left(\\frac{\\pi n}{2}\\right).\n$$\nThus,\n$$\nh_{d}[n]=\\begin{cases}\n\\frac{1}{2}, & n=0,\\\\[4pt]\n\\frac{1}{\\pi n}\\sin\\!\\left(\\frac{\\pi n}{2}\\right), & n\\neq 0.\n\\end{cases}\n$$\nThe 7-tap non-causal zero-phase filter is obtained by truncation to $n\\in\\{-3,-2,-1,0,1,2,3\\}$, so $h_{nc}[n]=h_{d}[n]$ for these $n$. Evaluating each:\n- For $n=-3$: $\\sin\\!\\left(-\\frac{3\\pi}{2}\\right)=1$, hence $h_{nc}[-3]=\\frac{1}{\\pi(-3)}\\cdot 1=-\\frac{1}{3\\pi}$.\n- For $n=-2$: $\\sin(-\\pi)=0$, hence $h_{nc}[-2]=0$.\n- For $n=-1$: $\\sin\\!\\left(-\\frac{\\pi}{2}\\right)=-1$, hence $h_{nc}[-1]=\\frac{1}{-\\pi}\\cdot(-1)=\\frac{1}{\\pi}$.\n- For $n=0$: $h_{nc}[0]=\\frac{1}{2}$.\n- For $n=1$: $\\sin\\!\\left(\\frac{\\pi}{2}\\right)=1$, hence $h_{nc}[1]=\\frac{1}{\\pi}$.\n- For $n=2$: $\\sin(\\pi)=0$, hence $h_{nc}[2]=0$.\n- For $n=3$: $\\sin\\!\\left(\\frac{3\\pi}{2}\\right)=-1$, hence $h_{nc}[3]=-\\frac{1}{3\\pi}$.\n\nTherefore, ordered from $n=-3$ to $n=3$, the seven coefficients are $-\\frac{1}{3\\pi},\\,0,\\,\\frac{1}{\\pi},\\,\\frac{1}{2},\\,\\frac{1}{\\pi},\\,0,\\,-\\frac{1}{3\\pi}$.", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{3\\pi} & 0 & \\frac{1}{\\pi} & \\frac{1}{2} & \\frac{1}{\\pi} & 0 & -\\frac{1}{3\\pi}\\end{pmatrix}}$$", "id": "1719431"}, {"introduction": "Applying a window to an ideal impulse response is a necessary compromise, and understanding its consequences is key to effective filter design. This practice problem shifts our focus from 'how' to 'why,' exploring the side effects of windowing through the lens of spectral leakage. By analyzing why a high-pass filter designed this way fails to perfectly block DC signals, you will uncover the fundamental trade-off between filter length and frequency resolution that governs all window-based designs [@problem_id:1719415].", "problem": "In digital signal processing, the window method is a common technique for designing a Finite Impulse Response (FIR) filter. This method begins with an ideal frequency response, for which the corresponding impulse response is typically infinitely long and non-causal. To create a practical, finite-length filter, this ideal impulse response is multiplied by a finite-length window function (like a rectangular, Hamming, or Blackman window).\n\nConsider the design of a discrete-time high-pass filter. An ideal high-pass filter has a frequency response with a gain of zero in its stopband, which includes the DC component (frequency $\\omega = 0$), and a constant gain (e.g., unity) in its passband. However, when the window method is applied to design a practical FIR high-pass filter, the resulting filter's frequency response exhibits a small but distinctly non-zero gain at DC.\n\nWhich of the following statements provides the most accurate physical and mathematical explanation for why this non-zero DC gain occurs?\n\nA. The process of making the filter causal by shifting its impulse response introduces a linear phase component in the frequency domain, which fundamentally alters the magnitude response at DC from zero to a non-zero value.\n\nB. The truncation of the infinite ideal impulse response by the window function is equivalent to convolving the ideal frequency response with the frequency response of the window. The main lobe of the window's spectrum, centered at DC, inevitably \"smears\" or \"leaks\" into the ideal filter's stopband, resulting in non-zero gain at DC.\n\nC. The non-zero gain at DC is a direct consequence of the Gibbs phenomenon, which describes the overshoot and ripple that occur at the band edges (the transition between the stopband and passband) and necessarily propagates to the DC frequency.\n\nD. The discretization of the continuous-time sinc function, which is the impulse response of an ideal filter, introduces quantization errors. These errors accumulate at the DC frequency, leading to a non-zero gain.\n\nE. Any practical window function (other than the ideal rectangular window in the frequency domain) has a non-zero bandwidth. This inherent bandwidth forces the resulting filter to also have a non-zero response at frequencies where the ideal filter would have zero gain, including DC.", "solution": "The problem asks for the fundamental reason why a high-pass filter designed using the window method has a non-zero DC gain, even though the ideal high-pass filter has zero DC gain. Let's analyze the process step-by-step.\n\nLet $h_{ideal}[n]$ be the impulse response of the ideal high-pass filter, and let $H_{ideal}(e^{j\\omega})$ be its frequency response. By definition, an ideal high-pass filter has zero gain at DC, so $H_{ideal}(e^{j0}) = 0$. The impulse response $h_{ideal}[n]$ corresponding to such a sharp-cutoff filter is infinitely long (it is a form of the sinc function, modulated by a cosine).\n\nThe window method creates a practical, finite-length FIR filter by truncating this ideal impulse response. This is achieved by multiplying $h_{ideal}[n]$ with a finite-length window function, $w[n]$. Let the resulting practical filter's impulse response be $h[n]$.\n\n$$h[n] = h_{ideal}[n] \\cdot w[n]$$\n\nTo understand the effect of this operation on the frequency response, we use the convolution theorem of the Discrete-Time Fourier Transform (DTFT). The theorem states that multiplication in the time domain corresponds to periodic convolution in the frequency domain. Therefore, the frequency response of the practical filter, $H(e^{j\\omega})$, is the convolution of the ideal filter's frequency response, $H_{ideal}(e^{j\\omega})$, and the window's frequency response, $W(e^{j\\omega})$.\n\n$$H(e^{j\\omega}) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} H_{ideal}(e^{j\\theta}) W(e^{j(\\omega - \\theta)}) d\\theta$$\n\nWe are interested in the DC gain of the practical filter, which is its frequency response evaluated at $\\omega = 0$.\n\n$$H(e^{j0}) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} H_{ideal}(e^{j\\theta}) W(e^{-j\\theta}) d\\theta$$\n\nLet's analyze the components of this integral:\n1.  $H_{ideal}(e^{j\\theta})$: This is the ideal high-pass frequency response. It is zero for frequencies in the stopband, i.e., for $|\\theta| \\le \\omega_c$, where $\\omega_c$ is the cutoff frequency. So, $H_{ideal}(e^{j\\theta})$ is zero in a region around $\\theta=0$.\n2.  $W(e^{-j\\theta})$: This is the frequency response of the window function. For any finite-length window, $W(e^{j\\omega})$ is not a simple delta function. It has a high-energy \"main lobe\" centered at $\\omega=0$ and a series of decaying \"sidelobes\" that extend across all frequencies. The width of the main lobe and the amplitude of the sidelobes depend on the specific window used.\n\nThe integral for $H(e^{j0})$ computes the area of the product of these two functions. Although $H_{ideal}(e^{j\\theta})$ is zero near $\\theta=0$, the function $W(e^{-j\\theta})$ is not. The main lobe and sidelobes of $W(e^{-j\\theta})$ extend into the regions where $H_{ideal}(e^{j\\theta})$ is non-zero (i.e., the passband, $|\\theta| > \\omega_c$). The product $H_{ideal}(e^{j\\theta}) W(e^{-j\\theta})$ will therefore be non-zero in the passband regions of the ideal filter. Integrating this non-zero product over the interval $[-\\pi, \\pi]$ will, in general, yield a non-zero result.\n\nThis process is often described as \"spectral leakage\" or \"smearing.\" The convolution operation effectively \"smears\" the frequency response of the window onto the ideal frequency response. The energy from the main lobe of the window's spectrum, which is centered at DC, \"leaks\" or \"spreads\" into the stopband of the ideal filter. This smearing raises the gain from its ideal value of zero to some small, non-zero value across the entire stopband, including at $\\omega=0$.\n\nNow let's evaluate the given options:\n-   A: Making the filter causal adds a linear phase term, but it does not change the magnitude response $|H(e^{j\\omega})|$. The DC gain is a magnitude property, so this is incorrect.\n-   B: This statement correctly identifies that time-domain multiplication is frequency-domain convolution. It correctly points out that the window's spectrum (with its main lobe at DC) is convolved with the ideal filter's spectrum, causing leakage or smearing that results in a non-zero DC gain. This is the correct explanation.\n-   C: The Gibbs phenomenon refers to the high-frequency ripples and overshoot/undershoot near a discontinuity (the band edge). While it is also a result of truncation (convolution), it specifically describes the behavior at the discontinuity. The non-zero DC gain is a broader effect of spectral leakage across the entire stopband, not just a feature of the band-edge ripple.\n-   D: Quantization error is related to representing continuous values with a finite number of bits. It is a separate issue from the windowing method itself, which is a mathematical operation on ideal real numbers. This is incorrect.\n-   E: This statement is partially true but less precise and complete than B. While the window's bandwidth is a factor, the core mechanism is the *convolution* of the two spectra. Stating that the window's bandwidth forces a non-zero response is an oversimplification that misses the key mathematical operation. Option B provides a much more rigorous explanation of *how* this happens.\n\nTherefore, option B provides the most accurate and complete explanation.", "answer": "$$\\boxed{B}$$", "id": "1719415"}, {"introduction": "Having explored the basic mechanism of windowing and its inherent trade-offs, we now turn to a practical design scenario that mirrors real-world engineering challenges. This exercise introduces the Kaiser window, a powerful tool that offers an adjustable parameter, $\\beta$, to control the compromise between stopband attenuation and transition width. By working through the established design formulas, you will learn how to select the optimal window shape to meet specific frequency response requirements under a fixed filter length constraint [@problem_id:1719395].", "problem": "An engineer is tasked with designing a low-pass Finite Impulse Response (FIR) filter to preprocess a noisy signal from a sensor. The design must be implemented using the Kaiser window method. Due to strict hardware memory constraints on the embedded system, the filter length is fixed at $N=65$. The desired frequency response specifications are a passband edge frequency of $\\omega_p = 0.3\\pi$ radians/sample and a stopband edge frequency of $\\omega_s = 0.4\\pi$ radians/sample.\n\nThe empirical design formulas for the Kaiser window are as follows:\n1.  The relationship between the filter length $N$, the stopband attenuation $A_s$ (in dB), and the transition width $\\Delta\\omega = \\omega_s - \\omega_p$ is given by the approximation:\n    $$ (N-1) \\Delta\\omega = \\frac{A_s - 8}{2.285} $$\n2.  The Kaiser window parameter $\\beta$ is determined by the stopband attenuation $A_s$:\n    $$ \\beta = \\begin{cases} 0.1102(A_s - 8.7), & \\text{for } A_s > 50 \\\\ 0.5842(A_s - 21)^{0.4} + 0.07886(A_s - 21), & \\text{for } 21 \\le A_s \\le 50 \\\\ 0, & \\text{for } A_s < 21 \\end{cases} $$\n\nGiven the fixed filter length and the specified transition width, determine the maximum stopband attenuation $A_s$ that can be achieved. Then, find the value of the parameter $\\beta$ required to realize this design.\n\nProvide your answer as two numerical values: the attenuation $A_s$ (in dB) and the parameter $\\beta$. Round your final answers to three significant figures.", "solution": "We use the given Kaiser window empirical relation between filter length, transition width, and stopband attenuation:\n$$(N-1)\\Delta\\omega=\\frac{A_{s}-8}{2.285}.$$\nGiven $N=65$ and $\\Delta\\omega=\\omega_{s}-\\omega_{p}=0.4\\pi-0.3\\pi=0.1\\pi=\\frac{\\pi}{10}$, we solve for $A_{s}$:\n$$A_{s}=8+2.285\\,(N-1)\\Delta\\omega=8+2.285\\cdot 64\\cdot \\frac{\\pi}{10}=8+14.624\\,\\pi.$$\nNumerically, using $\\pi\\approx 3.14159265$, this gives\n$$A_{s}\\approx 8+14.624\\times 3.14159265=53.9426509\\ \\text{dB}.$$\nSince $A_{s}>50$, the appropriate formula for the Kaiser parameter is\n$$\\beta=0.1102\\,(A_{s}-8.7).$$\nSubstituting the computed $A_{s}$:\n$$\\beta=0.1102\\,(53.9426509-8.7)=0.1102\\times 45.2426509\\approx 4.98574003.$$\nRounding both to three significant figures yields $A_{s}\\approx 53.9$ and $\\beta\\approx 4.99$.", "answer": "$$\\boxed{\\begin{pmatrix} 53.9 & 4.99 \\end{pmatrix}}$$", "id": "1719395"}]}