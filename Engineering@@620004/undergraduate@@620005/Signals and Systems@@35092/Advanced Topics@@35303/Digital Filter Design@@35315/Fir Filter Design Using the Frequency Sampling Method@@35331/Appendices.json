{"hands_on_practices": [{"introduction": "The core principle of the frequency sampling method is elegantly simple: you define the filter you want in the frequency domain, and then use the Inverse Discrete Fourier Transform (IDFT) to find the corresponding time-domain filter coefficients. This first exercise [@problem_id:1719137] provides direct practice with this fundamental conversion, challenging you to calculate a specific impulse response coefficient, $h[n]$, from a given set of frequency samples $H[k]$. This is the foundational skill for designing any filter with this technique.", "problem": "A linear-phase Finite Impulse Response (FIR) filter of length $N=15$ is being designed using the frequency sampling technique. In this method, the desired filter's frequency response is specified by a set of $N$ frequency samples, $H[k]$, for $k = 0, 1, \\dots, N-1$. These samples correspond to the frequencies $\\omega_k = \\frac{2\\pi k}{N}$.\n\nFor this particular design, a symmetric low-pass characteristic is chosen, with the frequency samples defined as:\n$$\nH[k] = \\begin{cases}\n1 & \\text{for } k \\in \\{0, 1, 2, 13, 14\\} \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nThe impulse response of the filter, $h[n]$, is obtained by computing the $N$-point Inverse Discrete Fourier Transform (IDFT) of the sequence $H[k]$.\n\nDetermine the value of the impulse response coefficient $h[7]$. Provide your answer as a single, closed-form analytic expression.", "solution": "For an $N$-point IDFT with the conventional DFT/IDFT pair\n$$\nX[k]=\\sum_{n=0}^{N-1} x[n]\\exp\\left(-\\mathrm{j}\\frac{2\\pi kn}{N}\\right),\\quad\nx[n]=\\frac{1}{N}\\sum_{k=0}^{N-1} X[k]\\exp\\left(\\mathrm{j}\\frac{2\\pi kn}{N}\\right),\n$$\nthe impulse response is\n$$\nh[n]=\\frac{1}{N}\\sum_{k=0}^{N-1} H[k]\\exp\\left(\\mathrm{j}\\frac{2\\pi kn}{N}\\right).\n$$\nWith $N=15$ and $H[k]=1$ for $k\\in\\{0,1,2,13,14\\}$ and $H[k]=0$ otherwise, we obtain\n$$\nh[n]=\\frac{1}{15}\\left[\\exp(0)+\\exp\\left(\\mathrm{j}\\frac{2\\pi n}{15}\\right)+\\exp\\left(\\mathrm{j}\\frac{4\\pi n}{15}\\right)+\\exp\\left(\\mathrm{j}\\frac{26\\pi n}{15}\\right)+\\exp\\left(\\mathrm{j}\\frac{28\\pi n}{15}\\right)\\right].\n$$\nUsing $13\\equiv -2\\pmod{15}$ and $14\\equiv -1\\pmod{15}$ gives\n$$\nh[n]=\\frac{1}{15}\\left[1+\\exp\\left(\\mathrm{j}\\frac{2\\pi n}{15}\\right)+\\exp\\left(\\mathrm{j}\\frac{4\\pi n}{15}\\right)+\\exp\\left(-\\mathrm{j}\\frac{4\\pi n}{15}\\right)+\\exp\\left(-\\mathrm{j}\\frac{2\\pi n}{15}\\right)\\right].\n$$\nApplying $\\exp(\\mathrm{j}\\theta)+\\exp(-\\mathrm{j}\\theta)=2\\cos\\theta$ yields\n$$\nh[n]=\\frac{1}{15}\\left[1+2\\cos\\left(\\frac{2\\pi n}{15}\\right)+2\\cos\\left(\\frac{4\\pi n}{15}\\right)\\right].\n$$\nFor $n=7$,\n$$\nh[7]=\\frac{1}{15}\\left[1+2\\cos\\left(\\frac{14\\pi}{15}\\right)+2\\cos\\left(\\frac{28\\pi}{15}\\right)\\right].\n$$\nUse the identities $\\cos(\\pi-\\alpha)=-\\cos(\\alpha)$ and $\\cos(2\\pi-\\alpha)=\\cos(\\alpha)$ to obtain\n$$\n\\cos\\left(\\frac{14\\pi}{15}\\right)=-\\cos\\left(\\frac{\\pi}{15}\\right),\\qquad\n\\cos\\left(\\frac{28\\pi}{15}\\right)=\\cos\\left(\\frac{2\\pi}{15}\\right).\n$$\nTherefore,\n$$\nh[7]=\\frac{1}{15}\\left[1-2\\cos\\left(\\frac{\\pi}{15}\\right)+2\\cos\\left(\\frac{2\\pi}{15}\\right)\\right].\n$$\nOptionally, using $\\cos(2x)=2\\cos^{2}(x)-1$ with $x=\\frac{\\pi}{15}$ gives the equivalent closed form\n$$\nh[7]=\\frac{1}{15}\\left[4\\cos^{2}\\left(\\frac{\\pi}{15}\\right)-2\\cos\\left(\\frac{\\pi}{15}\\right)-1\\right].\n$$\nEither expression is a valid single, closed-form analytic expression for $h[7]$.", "answer": "$$\\boxed{\\frac{1}{15}\\left[4\\cos^{2}\\left(\\frac{\\pi}{15}\\right)-2\\cos\\left(\\frac{\\pi}{15}\\right)-1\\right]}$$", "id": "1719137"}, {"introduction": "While the basic concept is straightforward, practical filter design often involves additional constraints that shape our choices for the frequency samples. This next practice [@problem_id:1719134] explores one such critical constraint related to linear-phase Finite Impulse Response (FIR) filters. You will see how choosing a specific filter architecture, in this case a Type-II filter, imposes a necessary condition on one of the frequency samples, demonstrating a key principle in robust and professional filter design.", "problem": "A digital signal processing engineer is designing a low-pass Finite Impulse Response (FIR) filter of length $N=16$ using the frequency sampling method. The design specifies a Type-II linear-phase filter, which implies that the filter's impulse response, denoted $h[n]$, is real-valued and symmetric ($h[n] = h[N-1-n]$) and its length $N$ is an even number.\n\nThe filter's characteristics are defined by $N$ frequency samples, $H[k]$, taken at frequencies $\\omega_k = \\frac{2\\pi k}{N}$ for $k=0, 1, \\dots, N-1$. To ensure a real-valued impulse response, these samples are chosen to be real and to satisfy the symmetry condition $H[k] = H[N-k]$.\n\nThe target is a low-pass filter, and the engineer has specified most of the independent sample values as follows:\n- Passband samples: $H[0]=1, H[1]=1, H[2]=1, H[3]=1$.\n- Transition sample: $H[4]=0.4$.\n- Stopband samples: $H[5]=0, H[6]=0, H[7]=0$.\n\nThe sample at $k=8$ corresponds to the Nyquist frequency. The remaining samples for $k>8$ are determined by the symmetry requirement. Based on the fundamental properties that all Type-II FIR filters must satisfy, determine the correct values for the set of independent frequency samples $H[k]$ for $k = 0, 1, \\dots, 8$.\n\nPresent your answer as a row matrix containing the values for $H[0], H[1], \\dots, H[8]$ in order.", "solution": "We are given an FIR filter of length $N=16$ with Type-II linear phase, which implies $N$ is even and the impulse response is symmetric, $h[n]=h[N-1-n]$. The frequency-sampling method specifies $N$ samples $H[k]$ at $\\omega_{k}=\\frac{2\\pi k}{N}$, $k=0,1,\\dots,N-1$, chosen real and symmetric as $H[k]=H[N-k]$ to ensure a real-valued $h[n]$.\n\nA fundamental property of Type-II FIR filters (even $N$, symmetric $h[n]$) is that the frequency response must be zero at the Nyquist frequency $\\omega=\\pi$. To see this, let $N=2M$ with $M=8$. The DTFT of $h[n]$ is\n$$\nH(\\mathrm{e}^{\\mathrm{j}\\omega})=\\sum_{n=0}^{N-1}h[n]\\,\\mathrm{e}^{-\\mathrm{j}\\omega n}.\n$$\nUsing symmetry $h[n]=h[N-1-n]$ and pairing terms $n$ with $N-1-n$ for $n=0,\\dots,M-1$, we obtain\n$$\nH(\\mathrm{e}^{\\mathrm{j}\\omega})=\\sum_{n=0}^{M-1}h[n]\\left(\\mathrm{e}^{-\\mathrm{j}\\omega n}+\\mathrm{e}^{-\\mathrm{j}\\omega (N-1-n)}\\right)\n=e^{-\\mathrm{j}\\omega (N-1)/2}\\sum_{n=0}^{M-1}2h[n]\\cos\\!\\left(\\omega\\left(n-\\frac{N-1}{2}\\right)\\right).\n$$\nFor even $N$, we have $\\frac{N-1}{2}=M-\\frac{1}{2}$, a half-integer. Evaluating at the Nyquist frequency $\\omega=\\pi$ yields\n$$\n\\cos\\!\\left(\\pi\\left(n-\\frac{N-1}{2}\\right)\\right)=\\cos\\!\\left(\\pi\\left(n-M+\\frac{1}{2}\\right)\\right)=0\n$$\nfor every integer $n$. Hence the entire sum is zero and\n$$\nH(\\mathrm{e}^{\\mathrm{j}\\pi})=0.\n$$\nIn the frequency-sampling design, $H[k]$ are samples of $H(\\mathrm{e}^{\\mathrm{j}\\omega})$ at $\\omega_{k}=\\frac{2\\pi k}{N}$. The Nyquist frequency corresponds to $k=\\frac{N}{2}=8$, so the Type-II property enforces\n$$\nH[8]=0.\n$$\n\nAll other specified independent samples remain as given, and symmetry $H[k]=H[N-k]$ determines those for $k>8$. Therefore, the correct set of independent samples for $k=0,1,\\dots,8$ is\n$$\n\\begin{pmatrix}\nH[0] & H[1] & H[2] & H[3] & H[4] & H[5] & H[6] & H[7] & H[8]\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & 1 & 1 & 1 & 0.4 & 0 & 0 & 0 & 0\n\\end{pmatrix}.\n$$\nThis satisfies the Type-II constraint $H[8]=0$, maintains real-valued and symmetric samples, and preserves the specified passband, transition, and stopband values.", "answer": "$$\\boxed{\\begin{pmatrix}1 & 1 & 1 & 1 & 0.4 & 0 & 0 & 0 & 0\\end{pmatrix}}$$", "id": "1719134"}, {"introduction": "The power of the frequency sampling method becomes even clearer when we view it through the lens of the z-plane. This final exercise [@problem_id:1742274] reveals a profound link between the frequency samples you specify and the resulting filter's fundamental structure. By setting certain frequency samples $H[k]$ to zero to create a stopband, you are, in fact, strategically placing the zeros of the transfer function $H(z)$ on the unit circle, which is the very mechanism that provides stopband attenuation.", "problem": "A systems engineer is designing a digital Finite Impulse Response (FIR) filter of length $N=32$. The design is based on the frequency sampling method, where the desired frequency response is specified at $N$ equally spaced frequencies, $\\omega_k = \\frac{2\\pi k}{N}$, for $k = 0, 1, \\dots, N-1$. The resulting frequency samples, denoted by $H[k]$, are used to determine the filter's impulse response $h[n]$ and its corresponding transfer function $H(z)$.\n\nTo approximate an ideal lowpass filter, the engineer sets the frequency samples as follows:\n$$\nH[k] = \\begin{cases} 1 & \\text{for } k \\in \\{0, 1, 2, 30, 31\\} \\\\ 0 & \\text{for } k=3, 4, \\dots, 29 \\end{cases}\n$$\nThese specific choices for $H[k]$ ensure that the resulting impulse response $h[n]$ is a real-valued sequence.\n\nBased on this design specification, determine the number of zeros of the filter's transfer function $H(z)$ that are guaranteed to be located on the unit circle in the z-plane.", "solution": "We are given an FIR of length $N=32$ designed by the frequency-sampling method. Let the $N$ equally spaced frequencies be $\\omega_{k}=\\frac{2\\pi k}{N}$, $k=0,1,\\dots,N-1$, and the specified samples be $H[k]$. The impulse response is obtained by the inverse DFT:\n$$\nh[n]=\\frac{1}{N}\\sum_{k=0}^{N-1}H[k]\\exp\\!\\left(j\\frac{2\\pi k}{N}n\\right),\\quad n=0,1,\\dots,N-1.\n$$\nThe transfer function is\n$$\nH(z)=\\sum_{n=0}^{N-1}h[n]z^{-n},\n$$\nand, in particular, its frequency response on the unit circle is\n$$\nH(e^{j\\omega})=\\sum_{n=0}^{N-1}h[n]e^{-j\\omega n}.\n$$\nEvaluating $H(e^{j\\omega})$ at the sampling frequencies $\\omega_{m}=\\frac{2\\pi m}{N}$ and substituting $h[n]$ gives\n$$\nH\\left(e^{j\\frac{2\\pi m}{N}}\\right)=\\sum_{n=0}^{N-1}\\left[\\frac{1}{N}\\sum_{k=0}^{N-1}H[k]\\exp\\!\\left(j\\frac{2\\pi k}{N}n\\right)\\right]\\exp\\!\\left(-j\\frac{2\\pi m}{N}n\\right).\n$$\nInterchanging the order of summation yields\n$$\nH\\left(e^{j\\frac{2\\pi m}{N}}\\right)=\\frac{1}{N}\\sum_{k=0}^{N-1}H[k]\\sum_{n=0}^{N-1}\\exp\\!\\left(j\\frac{2\\pi (k-m)}{N}n\\right).\n$$\nUsing the orthogonality of complex exponentials,\n$$\n\\sum_{n=0}^{N-1}\\exp\\!\\left(j\\frac{2\\pi (k-m)}{N}n\\right)=\\begin{cases}N,& k=m\\ (\\text{mod }N),\\\\ 0,& k\\neq m,\\end{cases}\n$$\nwe obtain the exact interpolation property\n$$\nH\\left(e^{j\\frac{2\\pi m}{N}}\\right)=H[m],\\quad m=0,1,\\dots,N-1.\n$$\nTherefore, for every index $m$ with $H[m]=0$, the value $H\\left(e^{j\\frac{2\\pi m}{N}}\\right)=0$, which implies that $z=e^{j\\frac{2\\pi m}{N}}$ is a zero of $H(z)$ on the unit circle.\n\nIn the given specification,\n$$\nH[k]=1\\ \\text{for}\\ k\\in\\{0,1,2,30,31\\},\\qquad H[k]=0\\ \\text{for}\\ k=3,4,\\dots,29.\n$$\nThe set $\\{3,4,\\dots,29\\}$ contains $29-3+1=27$ indices. Hence there are $27$ distinct frequencies $\\omega_{k}=\\frac{2\\pi k}{N}$ at which $H\\left(e^{j\\omega_{k}}\\right)=0$, and thus $27$ zeros of $H(z)$ are guaranteed to lie on the unit circle.\n\nThis count includes the self-conjugate Nyquist frequency at $k=\\frac{N}{2}=16$ (i.e., $z=-1$) and all conjugate pairs at $k$ and $N-k$, each contributing distinct unit-circle zeros. No further unit-circle zeros are guaranteed by the specification, so the guaranteed number is $27$.", "answer": "$$\\boxed{27}$$", "id": "1742274"}]}