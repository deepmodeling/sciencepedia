{"hands_on_practices": [{"introduction": "Before we explore the visual benefits of zero-padding, it's crucial to understand its effect on fundamental signal properties like energy. This first exercise [@problem_id:1774276] challenges you to apply Parseval's relation—a cornerstone theorem connecting time-domain energy to frequency-domain energy—to a zero-padded signal. By working through a common pitfall in the calculation, you will solidify your understanding of how energy is conserved and correctly quantified in the DFT.", "problem": "Consider a finite-length, complex-valued discrete-time signal $x[n]$ that is non-zero only for the interval $0 \\leq n \\leq N-1$. The total energy of this signal is defined in the time domain as $E_x = \\sum_{n=0}^{N-1} |x[n]|^2$.\n\nThis signal is then zero-padded to create a new, longer signal $y[n]$ of length $N'$, where $N' > N$. The new signal is defined as:\n$$\ny[n] = \\begin{cases} x[n], & 0 \\leq n \\leq N-1 \\\\ 0, & N \\leq n \\leq N'-1 \\end{cases}\n$$\nThe $N'$-point Discrete Fourier Transform (DFT) of this padded signal is computed, yielding the frequency-domain representation $Y[k] = \\sum_{n=0}^{N'-1} y[n] \\exp\\left(-j\\frac{2\\pi kn}{N'}\\right)$ for $k=0, 1, \\dots, N'-1$.\n\nAn engineer, attempting to verify the signal energy from this new DFT spectrum, calculates a quantity they label $E_{\\text{calc}}$. However, they mistakenly use the original signal length $N$ as the scaling factor in their calculation, as follows:\n$$\nE_{\\text{calc}} = \\frac{1}{N} \\sum_{k=0}^{N'-1} |Y[k]|^2\n$$\nDetermine the ratio $R = \\frac{E_{\\text{calc}}}{E_x}$, which represents the fractional error in the engineer's energy calculation. The signal $x[n]$ is not trivial (i.e., its energy $E_x$ is non-zero). Express your answer as a closed-form analytic expression in terms of $N$ and $N'$.", "solution": "We are given a finite-length signal $x[n]$ supported on $0 \\leq n \\leq N-1$ with energy $E_{x}=\\sum_{n=0}^{N-1}|x[n]|^{2}$. Define the zero-padded signal $y[n]$ of length $N'$ by $y[n]=x[n]$ for $0 \\leq n \\leq N-1$ and $y[n]=0$ for $N \\leq n \\leq N'-1$. Its $N'$-point DFT is\n$$\nY[k]=\\sum_{n=0}^{N'-1}y[n]\\exp\\!\\left(-j\\frac{2\\pi kn}{N'}\\right),\\quad k=0,1,\\dots,N'-1.\n$$\nWith this DFT convention, Parseval's relation for the $N'$-point DFT states\n$$\n\\sum_{n=0}^{N'-1}|y[n]|^{2}=\\frac{1}{N'}\\sum_{k=0}^{N'-1}|Y[k]|^{2}.\n$$\nBecause $y[n]=x[n]$ for $0 \\leq n \\leq N-1$ and $y[n]=0$ otherwise, we have\n$$\n\\sum_{n=0}^{N'-1}|y[n]|^{2}=\\sum_{n=0}^{N-1}|x[n]|^{2}=E_{x}.\n$$\nSubstituting into Parseval's relation yields\n$$\nE_{x}=\\frac{1}{N'}\\sum_{k=0}^{N'-1}|Y[k]|^{2}\\quad\\Longrightarrow\\quad \\sum_{k=0}^{N'-1}|Y[k]|^{2}=N' E_{x}.\n$$\nThe engineer computes\n$$\nE_{\\text{calc}}=\\frac{1}{N}\\sum_{k=0}^{N'-1}|Y[k]|^{2}=\\frac{1}{N}\\left(N' E_{x}\\right)=\\frac{N'}{N}E_{x}.\n$$\nTherefore, the requested ratio is\n$$\nR=\\frac{E_{\\text{calc}}}{E_{x}}=\\frac{N'}{N}.\n$$\nSince $N'>N$ and $E_{x}\\neq 0$, this shows the engineer overestimates the energy by the factor $\\frac{N'}{N}$.", "answer": "$$\\boxed{\\frac{N'}{N}}$$", "id": "1774276"}, {"introduction": "One of the primary motivations for zero-padding is to get a clearer view of a signal's spectrum, especially when searching for weak components near strong ones. This practice [@problem_id:1774273] presents a realistic scenario where a faint signal could be mistaken for a sidelobe artifact from a much stronger signal. You will determine the amount of zero-padding needed to effectively 'zoom in' on the spectrum, providing the visual density to confidently distinguish a true signal peak from leakage.", "problem": "A signal processing engineer is analyzing a discrete-time signal, $x[n]$, which is known to be the sum of two real sinusoids. The signal is captured over a finite duration by collecting $N=1000$ samples at a sampling frequency of $f_s = 8000$ Hz. The signal is given by:\n$$x[n] = A_1 \\cos(2\\pi \\frac{f_1}{f_s} n) + A_2 \\cos(2\\pi \\frac{f_2}{f_s} n), \\quad \\text{for } n = 0, 1, \\dots, N-1$$\nThe primary component has a frequency $f_1 = 1000$ Hz. This frequency is intentionally chosen to coincide perfectly with a bin of an $N$-point Discrete Fourier Transform (DFT). A much weaker secondary component is suspected to be present at frequency $f_2 = 1010$ Hz.\n\nWhen analyzing the spectrum of a finite-length signal (effectively applying a rectangular window), each sinusoidal component produces a main peak accompanied by a series of sidelobes due to spectral leakage. The engineer is concerned that the weak secondary component at $f_2$ might be mistaken for, or obscured by, a sidelobe from the strong primary component at $f_1$.\n\nTo better visualize the spectrum, the engineer decides to append $N_{zero}$ zeros to the signal $x[n]$, creating a new signal of total length $N_{tot} = N + N_{zero}$, and then compute an $N_{tot}$-point DFT. This process, known as zero-padding, effectively interpolates the underlying continuous spectrum by providing more closely spaced frequency samples.\n\nFor this problem, assume the following two facts:\n1. The first major sidelobe in the magnitude spectrum of an $N$-point rectangularly-windowed sinusoid occurs at a frequency offset of approximately $1.4303 \\times (f_s/N)$ from the sinusoid's true frequency.\n2. To reliably distinguish the peak of the secondary component from the nearby sidelobe peak of the primary component, the engineer requires that the frequency spacing of the zero-padded DFT, let's call it $\\Delta f_{zp}$, must be no more than half the frequency separation between the true frequency of the secondary component, $f_2$, and the frequency of the first major sidelobe of the primary component.\n\nDetermine the minimum integer number of zeros, $N_{zero}$, that must be appended to the signal to satisfy the engineer's resolution criterion.", "solution": "The zero-padded DFT frequency spacing is $\\Delta f_{zp} = \\frac{f_{s}}{N_{tot}}$ with $N_{tot} = N + N_{zero}$. For a rectangular window of length $N$, the first major sidelobe of a sinusoid at $f_{1}$ occurs at\n$$\nf_{\\text{sl},1} = f_{1} + 1.4303 \\left(\\frac{f_{s}}{N}\\right).\n$$\nThe frequency separation between the suspected secondary component at $f_{2}$ and this sidelobe is\n$$\nd \\equiv \\left| f_{2} - f_{\\text{sl},1} \\right| = \\left| f_{2} - f_{1} - 1.4303 \\left(\\frac{f_{s}}{N}\\right) \\right|.\n$$\nThe engineer’s criterion requires\n$$\n\\Delta f_{zp} \\leq \\frac{1}{2} d \\quad \\Longrightarrow \\quad \\frac{f_{s}}{N_{tot}} \\leq \\frac{1}{2} \\left| f_{2} - f_{1} - 1.4303 \\left(\\frac{f_{s}}{N}\\right) \\right|.\n$$\nSolving for $N_{tot}$ gives\n$$\nN_{tot} \\geq \\frac{2 f_{s}}{\\left| f_{2} - f_{1} - 1.4303 \\left(\\frac{f_{s}}{N}\\right) \\right|}.\n$$\nSubstitute $f_{s} = 8000$, $N = 1000$, $f_{1} = 1000$, and $f_{2} = 1010$:\n$$\n\\frac{f_{s}}{N} = \\frac{8000}{1000} = 8,\\quad 1.4303 \\left(\\frac{f_{s}}{N}\\right) = 1.4303 \\times 8 = 11.4424,\n$$\n$$\nd = \\left| 1010 - 1000 - 11.4424 \\right| = \\left| 10 - 11.4424 \\right| = 1.4424,\n$$\n$$\nN_{tot} \\geq \\frac{2 \\times 8000}{1.4424} = \\frac{16000}{1.4424} \\approx 11092.623\\ldots\n$$\nHence the minimum integer $N_{tot}$ is $11093$, and therefore\n$$\nN_{zero} = N_{tot} - N = 11093 - 1000 = 10093.\n$$", "answer": "$$\\boxed{10093}$$", "id": "1774273"}, {"introduction": "This final practice [@problem_id:1774257] flips our perspective, turning a spectral artifact into a source of information. When we analyze a finite-length signal, the truncation acts like a rectangular window, creating predictable ripples in the frequency spectrum whose density is related to the signal's original length. This problem asks you to work backward from the observed spectrum of a zero-padded signal to deduce its original, unknown duration, demonstrating a deeper mastery of the windowing effect.", "problem": "In a signal processing application, a transient, real-valued discrete-time signal $x[n]$ is captured. The signal is known to be of a finite, but unknown, length $L$. That is, $x[n] = 0$ for $n < 0$ and $n \\ge L$. To analyze its spectral content with high resolution, the sequence is zero-padded to a total length of $N = 4096$. An $N$-point Discrete Fourier Transform (DFT), denoted as $X[k]$, is then computed for this zero-padded sequence.\n\nUpon examining the magnitude spectrum $|X[k]|$, it is observed that the spectrum consists of a broad, slowly varying envelope corresponding to the original signal's content, which is modulated by a fine, high-frequency ripple pattern. A detailed analysis of this ripple pattern reveals that the local minima (nulls) are separated by an average spacing of $\\Delta k = 22.76$ samples in the DFT index $k$.\n\nAssuming these ripples are an artifact of the sharp truncation of the original signal at length $L$, determine the original length $L$ of the signal $x[n]$. Express your answer for $L$ as the nearest integer.", "solution": "The observed fine ripples in the magnitude spectrum arise from the sharp truncation of $x[n]$ to length $L$, which is equivalent to multiplying the original signal by a rectangular window $w[n]$ of length $L$. The discrete-time Fourier transform (DTFT) of the rectangular window is\n$$\nW\\!\\left(\\exp(j\\omega)\\right)=\\exp\\!\\left(-j\\omega\\frac{L-1}{2}\\right)\\frac{\\sin\\!\\left(\\frac{\\omega L}{2}\\right)}{\\sin\\!\\left(\\frac{\\omega}{2}\\right)}.\n$$\nThe magnitude $|W(\\exp(j\\omega))|$ has zeros at\n$$\n\\frac{\\omega L}{2}=m\\pi \\quad \\Rightarrow \\quad \\omega=\\frac{2\\pi m}{L}, \\quad m\\in\\mathbb{Z}\\setminus\\{0\\}.\n$$\nTherefore, the spacing between consecutive nulls in frequency is\n$$\n\\Delta\\omega=\\frac{2\\pi}{L}.\n$$\nThe $N$-point DFT samples the DTFT at frequencies $\\omega_{k}=\\frac{2\\pi k}{N}$, so the spacing in DFT index between consecutive nulls is\n$$\n\\Delta k=\\frac{N\\,\\Delta\\omega}{2\\pi}=\\frac{N}{L}.\n$$\nSolving for $L$ gives\n$$\nL=\\frac{N}{\\Delta k}.\n$$\nWith $N=4096$ and the observed $\\Delta k=22.76$, we obtain\n$$\nL=\\frac{4096}{22.76}\\approx 180.\n$$\nRounding to the nearest integer yields $L=180$.", "answer": "$$\\boxed{180}$$", "id": "1774257"}]}