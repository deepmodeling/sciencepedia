{"hands_on_practices": [{"introduction": "In an ideal world, the Fourier transform of a pure sinusoid is an elegant pair of infinitely sharp impulses at its positive and negative frequencies. However, real-world signal processing requires us to to analyze finite-length segments. This practice explores the foundational consequence of this truncation, which is mathematically modeled by multiplying the ideal signal with a rectangular window. Understanding the resulting spectrum is the first step to grasping the phenomenon of spectral leakage. [@problem_id:1753673]", "problem": "An engineer is analyzing a discrete-time signal $x[n]$ known to be a pure deterministic sinusoid with amplitude $A$ and a constant, normalized angular frequency $\\omega_0$, where $0 < \\omega_0 < \\pi$. The signal is given by the expression $x[n] = A \\cos(\\omega_0 n)$.\n\nFor practical analysis using a digital computer, only a finite-length segment of the signal can be processed. This truncation is modeled by multiplying the ideal signal $x[n]$ by a rectangular window function, $w_R[n]$. The window is of length $M$ and is defined as $w_R[n] = 1$ for $0 \\le n \\le M-1$ and $w_R[n] = 0$ otherwise. The resulting signal to be analyzed is $y[n] = x[n] w_R[n]$.\n\nThe engineer then computes the Discrete-Time Fourier Transform (DTFT) of the windowed signal, denoted as $Y(e^{j\\omega})$. Which of the following options provides the most accurate qualitative description of the magnitude spectrum, $|Y(e^{j\\omega})|$, for the principal frequency range $-\\pi < \\omega < \\pi$?\n\nA. Two infinitely sharp impulses (Dirac delta functions) located precisely at frequencies $\\omega = \\omega_0$ and $\\omega = -\\omega_0$.\n\nB. A single broad central peak (main lobe) centered at $\\omega = 0$, accompanied by a series of smaller, decaying ripples (sidelobes) that extend across the frequency range.\n\nC. Two prominent peaks (main lobes), centered near the frequencies $\\omega = \\omega_0$ and $\\omega = -\\omega_0$, with each peak being accompanied by a series of smaller, decaying ripples (sidelobes).\n\nD. A spectrum with a constant, non-zero magnitude across the entire frequency range from $-\\pi$ to $\\pi$.\n\nE. A series of equally spaced, equally high impulses located at integer multiples of the frequency $\\frac{2\\pi}{M}$.", "solution": "We start from the given signal and window:\n$$x[n]=A\\cos(\\omega_{0} n),\\quad w_{R}[n]=\\begin{cases}1,&0\\leq n\\leq M-1\\\\ 0,&\\text{otherwise}\\end{cases},\\quad y[n]=x[n]w_{R}[n].$$\nUsing Euler's identity, write the cosine as\n$$x[n]=\\frac{A}{2}\\left(\\exp(j\\omega_{0} n)+\\exp(-j\\omega_{0} n)\\right),$$\nso\n$$y[n]=\\frac{A}{2}\\left(w_{R}[n]\\exp(j\\omega_{0} n)+w_{R}[n]\\exp(-j\\omega_{0} n)\\right).$$\nDefine the DTFT by\n$$Y(\\exp(j\\omega))=\\sum_{n=-\\infty}^{\\infty}y[n]\\exp(-j\\omega n).$$\nBy linearity and the modulation property of the DTFT,\n$$\\mathcal{F}\\{w_{R}[n]\\exp(j\\omega_{0} n)\\}=W_{R}(\\exp(j(\\omega-\\omega_{0}))),\\quad \\mathcal{F}\\{w_{R}[n]\\exp(-j\\omega_{0} n)\\}=W_{R}(\\exp(j(\\omega+\\omega_{0}))),$$\nso\n$$Y(\\exp(j\\omega))=\\frac{A}{2}\\left(W_{R}(\\exp(j(\\omega-\\omega_{0})))+W_{R}(\\exp(j(\\omega+\\omega_{0})))\\right).$$\nThe DTFT of the length-$M$ rectangular window is the Dirichlet kernel (up to a linear phase):\n$$W_{R}(\\exp(j\\omega))=\\sum_{n=0}^{M-1}\\exp(-j\\omega n)=\\exp\\!\\left(-j\\omega\\frac{M-1}{2}\\right)\\frac{\\sin\\!\\left(\\frac{M\\omega}{2}\\right)}{\\sin\\!\\left(\\frac{\\omega}{2}\\right)}.$$\nTherefore,\n$$|W_{R}(\\exp(j\\omega))|=\\left|\\frac{\\sin\\!\\left(\\frac{M\\omega}{2}\\right)}{\\sin\\!\\left(\\frac{\\omega}{2}\\right)}\\right|,$$\nwhich has a main lobe centered at $\\omega=0$ with decaying sidelobes. Substituting into $Y(\\exp(j\\omega))$ gives\n$$|Y(\\exp(j\\omega))|=\\frac{A}{2}\\left|W_{R}(\\exp(j(\\omega-\\omega_{0})))+W_{R}(\\exp(j(\\omega+\\omega_{0})))\\right|,$$\nwhich, qualitatively, is the superposition of two shifted copies of the Dirichlet magnitude, one centered at $\\omega=\\omega_{0}$ and the other at $\\omega=-\\omega_{0}$. Because $0<\\omega_{0}<\\pi$, both peaks lie within the principal range $-\\pi<\\omega<\\pi$. Each of these two peaks exhibits a main lobe with accompanying decaying sidelobes due to the rectangular window.\n\nHence, the correct qualitative description is two prominent main lobes centered near $\\omega=\\pm\\omega_{0}$, each with sidelobes.\n\nComparing with the options:\n- A is incorrect because truncation by a finite window broadens deltas into main lobes with sidelobes.\n- B is the spectrum of the window alone (centered at $0$), not of the modulated windowed sinusoid.\n- C matches the derived structure.\n- D is incorrect; the magnitude is not flat.\n- E describes a line spectrum for periodic/discrete frequencies, not the DTFT of a finite segment.\n\nTherefore, the correct choice is C.", "answer": "$$\\boxed{C}$$", "id": "1753673"}, {"introduction": "The previous exercise demonstrates that truncating a signal smears its spectral energy, a phenomenon called leakage. This practice presents a classic and highly practical scenario that reveals why this is a critical problem: a strong signal's leakage can easily mask a nearby, much weaker one. By quantitatively comparing a rectangular window to a Hann window, you will see how the right choice of window can make the difference between detecting a signal and missing it completely. [@problem_id:1753664]", "problem": "An engineer is analyzing a signal from a sensor using a Discrete Fourier Transform (DFT). The signal is sampled at a frequency $f_s = 10 \\text{ kHz}$ and a block of $N=1000$ samples is collected for analysis. The signal is known to contain a very strong sinusoidal component and a potentially very weak sinusoidal component. The total signal can be modeled as $x(t) = s_1(t) + s_2(t)$, where:\n\n1.  The strong component is $s_1(t) = A_1 \\cos(2\\pi f_1 t)$ with amplitude $A_1 = 1.0$ (in arbitrary units) and frequency $f_1 = 1002 \\text{ Hz}$.\n2.  The weak component is $s_2(t) = A_2 \\cos(2\\pi f_2 t)$ with amplitude $A_2 = 0.0050$ (in the same units) and frequency $f_2 = 1055 \\text{ Hz}$.\n\nThe engineer wants to determine if the weak signal $s_2(t)$ can be detected in the DFT spectrum. A common criterion for detectability is that the magnitude of the weak signal's contribution at a given DFT frequency bin must be greater than the spectral leakage from the strong signal at that same bin. The engineer focuses their analysis on the DFT bin whose frequency is closest to $f_2$.\n\nThe magnitude contribution of a windowed sinusoid of amplitude $A$ with a normalized frequency of $k_{sig}$ to the DFT magnitude at an observed integer bin $k_{obs}$ can be approximated as $|X[k_{obs}]| \\approx C \\cdot A \\cdot |G(\\Delta k)|$. Here, $\\Delta k = k_{obs} - k_{sig}$ is the normalized frequency difference, $G(\\Delta k)$ is the normalized magnitude response of the window's spectrum, and $C$ is a scaling constant that depends on the window type and DFT length.\n\nThe values for the normalized magnitude response $G(\\Delta k)$ for a rectangular window (i.e., no windowing) and a Hann window are provided in the table below for the specific $\\Delta k$ values relevant to this problem.\n\n| Window Type  | $G$ at $\\Delta k = 0.5$ | $G$ at $\\Delta k = 4.8$ |\n|--------------|-------------------------|-------------------------|\n| Rectangular  | 0.640                   | 0.0400                  |\n| Hann         | 0.450                   | 0.000500                |\n\nLet $R_{rect}$ be the ratio of the weak signal's magnitude to the strong signal's leakage magnitude at the analysis bin when using a rectangular window. Similarly, let $R_{Hann}$ be the same ratio when using a Hann window.\n\nTo quantify the benefit of using the Hann window in this specific scenario, calculate the improvement factor, defined as the ratio $R_{Hann} / R_{rect}$. Report your final answer rounded to three significant figures.", "solution": "The DFT bin spacing is $\\Delta f = \\frac{f_{s}}{N}$. With $f_{s}=10 \\times 10^{3}$ and $N=1000$, $\\Delta f = 10$. The bin centers are at $k \\Delta f$ with integer $k$.\n\nThe frequency $f_{2}=1055$ lies exactly midway between bins $k=105$ (at $1050$) and $k=106$ (at $1060$). Choosing the lower bin $k_{obs}=105$ makes the weak component detuning $|\\Delta k|=|k_{obs}-k_{sig,2}|=|105-105.5|=0.5$, and the strong component at $f_{1}=1002$ has $k_{sig,1}=\\frac{f_{1}}{\\Delta f}=100.2$, so its detuning to $k_{obs}=105$ is $|\\Delta k|=|105-100.2|=4.8$. These are exactly the $\\Delta k$ values provided in the table.\n\nFor a given window, the magnitude contribution at $k_{obs}$ from a sinusoid of amplitude $A$ is $|X[k_{obs}]| \\approx C \\cdot A \\cdot |G(\\Delta k)|$, where $C$ depends on the window and $N$, and $G$ is the window’s normalized magnitude response.\n\nDefine $R$ as the ratio of the weak component’s magnitude to the strong component’s leakage magnitude at $k_{obs}$. For a given window,\n$$\nR=\\frac{C \\cdot A_{2} \\cdot |G(0.5)|}{C \\cdot A_{1} \\cdot |G(4.8)|}=\\frac{A_{2}}{A_{1}} \\cdot \\frac{|G(0.5)|}{|G(4.8)|}.\n$$\nThus $C$ cancels within each ratio.\n\nFor the rectangular window,\n$$\nR_{rect}=\\frac{A_{2}}{A_{1}} \\cdot \\frac{0.640}{0.0400}.\n$$\nFor the Hann window,\n$$\nR_{Hann}=\\frac{A_{2}}{A_{1}} \\cdot \\frac{0.450}{0.000500}.\n$$\nThe improvement factor is\n$$\n\\frac{R_{Hann}}{R_{rect}}=\\frac{\\frac{A_{2}}{A_{1}} \\cdot \\frac{0.450}{0.000500}}{\\frac{A_{2}}{A_{1}} \\cdot \\frac{0.640}{0.0400}}=\\frac{0.450/0.000500}{0.640/0.0400}=\\frac{0.450 \\cdot 0.0400}{0.000500 \\cdot 0.640}.\n$$\nCompute the numerator and denominator:\n$$\n0.450 \\cdot 0.0400=0.018, \\quad 0.000500 \\cdot 0.640=0.000320.\n$$\nHence\n$$\n\\frac{R_{Hann}}{R_{rect}}=\\frac{0.018}{0.000320}=56.25.\n$$\nRounded to three significant figures, this is $56.3$.", "answer": "$$\\boxed{56.3}$$", "id": "1753664"}, {"introduction": "Theory provides the foundation, but true mastery comes from hands-on exploration. This computational exercise puts you in the driver's seat, asking you to simulate and analyze a signal with two very closely spaced frequencies—a common challenge in fields from astronomy to acoustics. By implementing different windows (Rectangular, Hann, and Blackman) and calculating key performance metrics, you will directly observe the crucial trade-off between a window's frequency resolution (main-lobe width) and its leakage suppression (sidelobe height). [@problem_id:2440581]", "problem": "You will model the effect of spectral leakage on the discrete Fourier transform when attempting to resolve two continuous-time sinusoidal components whose frequency separation is strictly less than the discrete Fourier transform frequency resolution. Consider a real-valued signal composed of two sinusoids of equal amplitude, sampled uniformly at a constant sampling frequency. Let the total number of samples be $N$, the sampling frequency be $f_{s}$ in Hz, and the discrete Fourier transform frequency resolution be $\\Delta f = \\frac{f_{s}}{N}$ in Hz. The signal is\n$$\nx[n] = \\sin\\!\\left(2\\pi \\frac{f_{1}}{f_{s}} n + \\phi_{1}\\right) + \\sin\\!\\left(2\\pi \\frac{f_{2}}{f_{s}} n + \\phi_{2}\\right), \\quad n = 0,1,2,\\dots,N-1,\n$$\nwith phases $\\phi_{1}$ and $\\phi_{2}$ in radians. You must analyze the windowed discrete Fourier transform magnitude spectrum of $x[n]$ for the following three windows $w[n]$ of length $N$:\n- Rectangular window: $w_{\\mathrm{rect}}[n] = 1$ for all $n$.\n- Hann window: $w_{\\mathrm{hann}}[n] = \\tfrac{1}{2}\\left(1 - \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right)\\right)$.\n- Blackman window: $w_{\\mathrm{black}}[n] = 0.42 - 0.5 \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right) + 0.08 \\cos\\!\\left(\\tfrac{4\\pi n}{N-1}\\right)$.\n\nDefine the discrete Fourier transform of the windowed signal as\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n]\\,w[n]\\,e^{-j 2\\pi \\frac{k n}{N}}, \\quad k = 0,1,2,\\dots,N-1,\n$$\nand define the nonnegative-frequency magnitude spectrum as $M[k] = |X[k]|$ for $k = 0,1,2,\\dots,\\tfrac{N}{2}$.\n\nFor each window, quantify spectral leakage and peak structure as follows:\n- Let $p_{1} = \\mathrm{round}\\!\\left(\\frac{f_{1}}{\\Delta f}\\right)$ and $p_{2} = \\mathrm{round}\\!\\left(\\frac{f_{2}}{\\Delta f}\\right)$, both clipped to the integer interval $[0, \\tfrac{N}{2}]$. Define the leakage fraction\n$$\nL = \\frac{\\sum_{k=0,\\,k \\neq p_{1},\\,k \\neq p_{2}}^{N/2} M[k]^{2}}{\\sum_{k=0}^{N/2} M[k]^{2}},\n$$\na dimensionless number in $[0,1]$.\n- Let $M_{\\max}$ be the largest value of $M[k]$ over $k = 0,1,2,\\dots,\\tfrac{N}{2}$, and let $M_{\\mathrm{second}}$ be the second-largest value over the same index set. Define the peak ratio\n$$\nR = \\frac{M_{\\mathrm{second}}}{M_{\\max}},\n$$\na dimensionless number in $[0,1]$.\n\nAll phases must be specified in radians. Frequencies must be specified in Hz. Sampling times are $t_{n} = \\tfrac{n}{f_{s}}$ in s. All requested outputs are dimensionless real numbers.\n\nTest suite. Use the following parameter sets, where each case satisfies $|f_{1} - f_{2}| < \\Delta f$:\n- Case $1$: $f_{s} = 1024$ Hz, $N = 256$, $f_{1} = 100.0$ Hz, $f_{2} = 102.0$ Hz, $\\phi_{1} = 0$ rad, $\\phi_{2} = 0$ rad.\n- Case $2$: $f_{s} = 1024$ Hz, $N = 256$, $f_{1} = 99.0$ Hz, $f_{2} = 101.0$ Hz, $\\phi_{1} = 0$ rad, $\\phi_{2} = 0$ rad.\n- Case $3$: $f_{s} = 1024$ Hz, $N = 256$, $f_{1} = 100.0$ Hz, $f_{2} = 100.25$ Hz, $\\phi_{1} = 0$ rad, $\\phi_{2} = 0$ rad.\n\nFor each case, compute the $6$-tuple of outputs\n$$\n\\left[L_{\\mathrm{rect}},\\,L_{\\mathrm{hann}},\\,L_{\\mathrm{black}},\\,R_{\\mathrm{rect}},\\,R_{\\mathrm{hann}},\\,R_{\\mathrm{black}}\\right],\n$$\nwhere each $L_{\\cdot}$ and $R_{\\cdot}$ is as defined above for the corresponding window.\n\nFinal output format. Your program should produce a single line of output containing a list of three elements (one per test case), where each element is the comma-separated list\n$[L_{\\mathrm{rect}},L_{\\mathrm{hann}},L_{\\mathrm{black}},R_{\\mathrm{rect}},R_{\\mathrm{hann}},R_{\\mathrm{black}}]$ with all entries as decimal floats. The overall output must be a single bracketed list of these three lists with no spaces, for example\n\"[[a,b,c,d,e,f],[a,b,c,d,e,f],[a,b,c,d,e,f]]\".", "solution": "The problem posed is a well-defined exercise in computational physics and digital signal processing. It is scientifically grounded, self-contained, and algorithmically formalizable. All parameters and functions are explicitly defined, and the test cases are consistent with the premises. The problem is therefore deemed valid and a full solution will be provided.\n\nThe fundamental task is to analyze the performance of different window functions in resolving two sinusoidal signals whose frequencies, $f_{1}$ and $f_{2}$, are separated by less than the frequency resolution of the Discrete Fourier Transform (DFT), $\\Delta f = \\frac{f_{s}}{N}$. This situation is common in experimental data analysis, where spectral components may be closely spaced.\n\nThe core principle behind this analysis is the understanding of the DFT and the phenomenon of spectral leakage. The DFT assumes that the finite-length signal segment $x[n]$ of length $N$ is one period of an infinitely periodic signal. If the signal segment does not contain an integer number of cycles of its constituent sinusoids, a sharp discontinuity arises at the boundary where the signal wraps around. This discontinuity manifests in the frequency domain as spectral leakage, where energy from the true frequency \"leaks\" into other frequency bins.\n\nWindowing is a technique to mitigate this effect. A window function $w[n]$ is applied to the signal, $y[n] = x[n]w[n]$, before the DFT is computed. Window functions taper towards zero at the ends of the segment, reducing the boundary discontinuities. This comes at a cost. The Fourier transform of the window function is convolved with the true spectrum of the signal. This convolution broadens the main spectral peaks (main lobes) and reduces the amplitude of the spurious peaks (sidelobes). This creates a trade-off:\n\n$1$. **Rectangular Window, $w_{\\mathrm{rect}}[n]$**: This is equivalent to applying no window, simply truncating the signal. Its transform has the narrowest main lobe, offering the highest theoretical frequency resolution. However, it also has the highest sidelobes (the first sidelobe is only about $-13$ dB down from the main lobe), leading to severe spectral leakage that can obscure nearby weaker signals or merge with adjacent strong signals.\n\n$2$. **Hann Window, $w_{\\mathrm{hann}}[n]$**: This is a smooth, bell-shaped window. Its main lobe is approximately twice as wide as that of the rectangular window, thus reducing frequency resolution. Its significant advantage is the much lower sidelobe level (first sidelobe at about $-31$ dB), which provides excellent leakage suppression.\n\n$3$. **Blackman Window, $w_{\\mathrm{black}}[n]$**: This window provides an even wider main lobe (approximately three times that of the rectangular window) and, in return, even lower sidelobes (first sidelobe at about $-58$ dB). It offers superior leakage suppression at the cost of further reduced frequency resolution.\n\nThe problem requires a quantitative analysis of this trade-off using two metrics for the magnitude spectrum $M[k] = |X[k]|$.\n\n- **Leakage Fraction, $L$**: This metric, defined as $L = (\\sum_{k=0,\\,k \\neq p_{1},\\,k \\neq p_{2}}^{N/2} M[k]^{2}) / (\\sum_{k=0}^{N/2} M[k]^{2})$, measures the fraction of spectral energy that has leaked outside the primary frequency bins associated with the signals, $p_{1}$ and $p_{2}$. These bins are identified by rounding the true frequencies normalized by the DFT frequency resolution, $f/\\Delta f$. A lower value of $L$ indicates better suppression of spectral leakage. We expect $L_{\\mathrm{rect}} > L_{\\mathrm{hann}} > L_{\\mathrm{black}}$.\n\n- **Peak Ratio, $R$**: This metric, defined as $R = M_{\\mathrm{second}} / M_{\\max}$, quantifies the resolvability of the two spectral components. If the two sinusoids are resolved into two distinct peaks in the spectrum, $R$ will be close to $1$ (since the sinusoids have equal amplitude). If they merge into a single, broad peak, $M_{\\max}$ will be this merged peak and $M_{\\mathrm{second}}$ will be the highest side lobe, resulting in a small value of $R$. Since $|f_{1} - f_{2}| < \\Delta f$, the components are not resolvable according to the classic Rayleigh criterion for a rectangular window. We will investigate whether they are nonetheless distinguishable.\n\nThe algorithmic procedure to solve the problem for each test case is as follows:\n\n$1$. Define the parameters $f_{s}$, $N$, $f_{1}$, $f_{2}$, $\\phi_{1}$, and $\\phi_{2}$.\n$2$. Generate the discrete time vector $n = [0, 1, \\dots, N-1]$.\n$3$. Construct the signal $x[n] = \\sin(2\\pi \\frac{f_{1}}{f_{s}} n + \\phi_{1}) + \\sin(2\\pi \\frac{f_{2}}{f_{s}} n + \\phi_{2})$.\n$4$. For each of the three specified window functions $w[n]$ (Rectangular, Hann, Blackman):\n    a. Generate the window sequence $w[n]$.\n    b. Apply the window to the signal: $y[n] = x[n] \\cdot w[n]$.\n    c. Compute the DFT of the windowed signal, $X[k] = \\sum_{n=0}^{N-1} y[n]\\,e^{-j 2\\pi \\frac{k n}{N}}$, using the Fast Fourier Transform (FFT) algorithm for efficiency.\n    d. Extract the non-negative frequency magnitude spectrum, $M[k] = |X[k]|$ for $k = 0, 1, \\dots, N/2$.\n    e. Calculate the DFT frequency resolution $\\Delta f = f_{s}/N$.\n    f. Determine the closest integer DFT bin indices for the two frequencies: $p_{1} = \\mathrm{round}(f_{1}/\\Delta f)$ and $p_{2} = \\mathrm{round}(f_{2}/\\Delta f)$, clipped to the valid range $[0, N/2]$.\n    g. Calculate the leakage fraction $L$ by summing the squared magnitudes of all bins except $p_{1}$ and $p_{2}$, and dividing by the total sum of squared magnitudes.\n    h. Calculate the peak ratio $R$ by finding the two largest values in the spectrum $M[k]$ and computing their ratio.\n$5$. Consolidate the six computed values ($L_{\\mathrm{rect}}, L_{\\mathrm{hann}}, L_{\\mathrm{black}}, R_{\\mathrm{rect}}, R_{\\mathrm{hann}}, R_{\\mathrm{black}}$) into a single list for the test case.\n$6$. Repeat for all test cases and format the final output as specified.\n\nThis procedure is implemented in the following program.", "answer": "```python\nimport numpy as np\nfrom scipy.fft import fft\n\ndef solve():\n    \"\"\"\n    Solves the spectral analysis problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # (fs, N, f1, f2, phi1, phi2)\n        (1024.0, 256, 100.0, 102.0, 0.0, 0.0),\n        (1024.0, 256, 99.0, 101.0, 0.0, 0.0),\n        (1024.0, 256, 100.0, 100.25, 0.0, 0.0),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        fs, N, f1, f2, phi1, phi2 = case\n\n        # Step 1: Generate signal x[n]\n        n = np.arange(N)\n        x_n = np.sin(2 * np.pi * f1 / fs * n + phi1) + \\\n              np.sin(2 * np.pi * f2 / fs * n + phi2)\n        \n        # Step 2: Define window functions\n        w_rect = np.ones(N)\n        # The problem defines windows symmetric about the midpoint, using N-1.\n        w_hann = 0.5 * (1 - np.cos(2 * np.pi * n / (N - 1)))\n        w_black = 0.42 - 0.5 * np.cos(2 * np.pi * n / (N - 1)) + \\\n                  0.08 * np.cos(4 * np.pi * n / (N - 1))\n\n        windows = {\n            \"rect\": w_rect,\n            \"hann\": w_hann,\n            \"black\": w_black,\n        }\n        \n        L_results = {}\n        R_results = {}\n\n        # Step 3: Loop through each window to perform analysis\n        for name, w_n in windows.items():\n            # Step 3a: Apply window\n            y_n = x_n * w_n\n            \n            # Step 3b: Compute DFT\n            X_k = fft(y_n)\n            \n            # Step 3c: Get non-negative frequency magnitude spectrum M[k]\n            # M[k] covers frequencies from 0 to fs/2. The size is N/2 + 1.\n            num_freq_bins = N // 2 + 1\n            M_k = np.abs(X_k[:num_freq_bins])\n\n            # Step 3d: Calculate metrics\n            delta_f = fs / N\n            # As per problem, determine peak indices p1, p2\n            p1 = int(np.round(f1 / delta_f))\n            p2 = int(np.round(f2 / delta_f))\n            \n            # Clip indices to the range of the non-negative spectrum\n            p1 = np.clip(p1, 0, N // 2)\n            p2 = np.clip(p2, 0, N // 2)\n            \n            # Calculate Leakage Fraction L\n            total_energy = np.sum(M_k**2)\n            if total_energy < 1e-12:  # Avoid division by zero for null signal\n                L = 0.0\n            else:\n                peak_indices = np.unique([p1, p2])\n                peak_energy = np.sum(M_k[peak_indices]**2)\n                leakage_energy = total_energy - peak_energy\n                L = leakage_energy / total_energy\n            \n            L_results[name] = L\n\n            # Calculate Peak Ratio R\n            # Find M_max and M_second\n            if M_k.size < 2:\n                R = 0.0\n            else:\n                sorted_M = np.sort(M_k)\n                M_max = sorted_M[-1]\n                M_second = sorted_M[-2]\n                if M_max < 1e-12: # Avoid division by zero\n                    R = 0.0\n                else:\n                    R = M_second / M_max\n\n            R_results[name] = R\n            \n        # Step 4: Assemble results for the case in the specified order\n        case_results = [\n            L_results[\"rect\"], L_results[\"hann\"], L_results[\"black\"],\n            R_results[\"rect\"], R_results[\"hann\"], R_results[\"black\"]\n        ]\n        all_results.append(case_results)\n\n    # Step 5: Format the final output string\n    # e.g., \"[[a,b,c,d,e,f],[...]]\"\n    output_parts = []\n    for res_list in all_results:\n        output_parts.append(f\"[{','.join(map(str, res_list))}]\")\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n\n    print(final_output)\n\nsolve()\n```", "id": "2440581"}]}