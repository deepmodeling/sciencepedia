{"hands_on_practices": [{"introduction": "Understanding sampling rate conversion is often easiest in the frequency domain. This first exercise provides a clear, intuitive demonstration of the process by tracking a simple, single-frequency input signal through each stage of the converter. By analyzing how the spectrum of the signal $x[n] = (-1)^n$ is altered by upsampling and filtering, you'll gain a foundational understanding of how the ideal low-pass filter works to isolate the desired signal component and eliminate unwanted spectral images.", "problem": "A discrete-time signal processing system performs sampling rate conversion by a rational factor of $L/M$. The process consists of three stages: first, the input signal is upsampled by a factor of $L=2$; second, the upsampled signal is passed through an ideal low-pass filter; and third, the filtered signal is downsampled by a factor of $M=3$.\n\nThe input to the system is the alternating sequence $x[n] = (-1)^n$.\n\nThe ideal low-pass filter is designed to prevent aliasing from the downsampling stage and has a transfer function given by:\n$$ H(e^{j\\omega}) = \\begin{cases} 2 & \\text{for } |\\omega| \\leq \\frac{\\pi}{3} \\\\ 0 & \\text{for } \\frac{\\pi}{3} < |\\omega| \\leq \\pi \\end{cases} $$\nDetermine the output sequence $y[n]$ of this system. Express your answer as a closed-form expression in terms of $n$.", "solution": "We analyze the system stage by stage in the frequency domain using the discrete-time Fourier transform (DTFT) and standard multirate relations.\n\nThe input is $x[n] = (-1)^{n} = \\exp(j \\pi n)$. Its DTFT is a line spectrum at $\\omega = \\pi$ modulo $2\\pi$, which can be represented as\n$$\nX(e^{j\\omega}) = 2\\pi \\sum_{k\\in\\mathbb{Z}} \\delta(\\omega - \\pi - 2\\pi k).\n$$\n\nAfter upsampling by $L=2$, the DTFT of the upsampled signal $u[n]$ is given by the standard formula\n$$\nU(e^{j\\omega}) = X(e^{j 2\\omega}).\n$$\nSubstituting the expression for $X$,\n$$\nU(e^{j\\omega}) = 2\\pi \\sum_{k\\in\\mathbb{Z}} \\delta(2\\omega - \\pi - 2\\pi k).\n$$\nUsing the scaling property of the Dirac delta, $\\delta(a \\omega - b) = \\frac{1}{|a|}\\delta(\\omega - b/a)$, we obtain\n$$\nU(e^{j\\omega}) = \\pi \\sum_{k\\in\\mathbb{Z}} \\delta\\!\\left(\\omega - \\frac{\\pi}{2} - \\pi k\\right).\n$$\nThus, within the principal interval, the upsampled signal has spectral lines only at $\\omega = \\pm \\frac{\\pi}{2}$.\n\nThe ideal low-pass filter has transfer function\n$$\nH(e^{j\\omega}) = \\begin{cases}\n2 & \\text{for } |\\omega| \\leq \\frac{\\pi}{3}, \\\\\n0 & \\text{for } \\frac{\\pi}{3} < |\\omega| \\leq \\pi.\n\\end{cases}\n$$\nSince $\\frac{\\pi}{2} > \\frac{\\pi}{3}$, the frequencies $\\omega = \\pm \\frac{\\pi}{2}$ lie strictly outside the passband. Therefore, the spectrum after filtering is\n$$\nW(e^{j\\omega}) = H(e^{j\\omega})\\,U(e^{j\\omega}) = 0,\n$$\nwhich implies the time-domain filtered signal is identically zero:\n$$\nw[n] = 0 \\quad \\text{for all } n.\n$$\n\nFinally, downsampling by $M=3$ yields\n$$\ny[n] = w[3n] = 0 \\quad \\text{for all } n.\n$$\n\nTherefore, the output sequence is the zero sequence.", "answer": "$$\\boxed{0}$$", "id": "1750635"}, {"introduction": "Building on the single-frequency case, this practice explores how rate conversion affects a signal with a defined bandwidth. We will trace the transformation of a signal's spectrum—represented here as a simple rectangular shape—as it is compressed by upsampling and then passed through the anti-aliasing filter. This exercise is crucial for visualizing how the output bandwidth is determined and reinforces the interplay between the original signal's bandwidth, the upsampling factor $L$, and the downsampling factor $M$.", "problem": "A discrete-time signal $x[n]$ has a Discrete-Time Fourier Transform (DTFT), $X(e^{j\\omega})$, that is non-zero and equal to a constant value of 1 for frequencies in the range $|\\omega| < \\pi/5$, and is zero for $\\pi/5 \\leq |\\omega| \\leq \\pi$.\n\nThis signal is processed by a digital system with the following three stages:\n1. An intermediate signal $x_u[n]$ is created by inserting one zero-valued sample between each consecutive pair of samples of the original signal $x[n]$. Specifically, $x_u[n] = x[n/2]$ if $n$ is even, and $x_u[n] = 0$ if $n$ is odd.\n2. The signal $x_u[n]$ is then passed through an ideal low-pass digital filter, which has a passband gain of 2 and a cutoff frequency of $\\pi/3$ radians/sample. Let the output of this filter be $x_f[n]$.\n3. The final output signal, $y[n]$, is obtained by keeping only every third sample of $x_f[n]$, i.e., $y[n] = x_f[3n]$.\n\nDetermine the bandwidth of the output signal $y[n]$. Specifically, find the maximum positive frequency, which we will call $\\omega_{max}$, such that the DTFT of the output, $Y(e^{j\\omega})$, is non-zero for all frequencies $|\\omega| < \\omega_{max}$. Express your answer as a numerical multiple of $\\pi$.", "solution": "We are given a discrete-time signal with DTFT\n$$\nX(e^{j\\omega})=\\begin{cases}\n1, & |\\omega|<\\frac{\\pi}{5},\\\\\n0, & \\frac{\\pi}{5}\\leq|\\omega|\\leq \\pi.\n\\end{cases}\n$$\nStage 1 is upsampling by a factor of 2 via zero-insertion: $x_{u}[n]=x[n/2]$ for even $n$ and $x_{u}[n]=0$ for odd $n$. The DTFT of an upsampled signal by factor $L$ satisfies\n$$\nX_{u}(e^{j\\omega})=\\sum_{n=-\\infty}^{\\infty}x_{u}[n]\\exp(-j\\omega n)=\\sum_{k=-\\infty}^{\\infty}x[k]\\exp(-j\\omega(2k))=X(e^{j(2\\omega)}).\n$$\nTherefore $X_{u}(e^{j\\omega})$ is nonzero exactly when $2\\omega$ falls in a passband of $X(e^{j\\Omega})$ modulo $2\\pi$. Since $X(e^{j\\Omega})$ is nonzero for $|\\Omega|<\\pi/5$ (periodic with period $2\\pi$), this implies\n$$\nX_{u}(e^{j\\omega})\\neq 0 \\quad \\Leftrightarrow \\quad |2\\omega-2\\pi m|<\\frac{\\pi}{5}\\ \\text{for some } m \\in \\mathbb{Z},\n$$\nwhich is equivalent to\n$$\n|\\omega - m\\pi| < \\frac{\\pi}{10}.\n$$\nWithin the principal interval $[-\\pi,\\pi)$ this yields a baseband lobe $|\\omega|<\\pi/10$ and image lobes around $\\omega=\\pm\\pi$ with width $\\pi/5$ total, i.e., $|\\omega \\mp \\pi| < \\pi/10$.\n\nStage 2 applies an ideal low-pass filter with passband gain $2$ and cutoff $\\omega_{c}=\\pi/3$. Its frequency response is\n$$\nH(e^{j\\omega})=\\begin{cases}\n2, & |\\omega|<\\frac{\\pi}{3},\\\\\n0, & \\frac{\\pi}{3}\\leq|\\omega|\\leq \\pi.\n\\end{cases}\n$$\nThe filtered spectrum is\n$$\nX_{f}(e^{j\\omega})=H(e^{j\\omega})X_{u}(e^{j\\omega}).\n$$\nSince the baseband of $X_{u}$ is $|\\omega|<\\pi/10$ and $\\pi/10<\\pi/3$, it passes and is scaled by $2$, while the image bands around $\\pm\\pi$ fall in the stopband and are removed. Hence\n$$\nX_{f}(e^{j\\omega})=\\begin{cases}\n2, & |\\omega|<\\frac{\\pi}{10},\\\\\n0, & \\frac{\\pi}{10}\\leq|\\omega|\\leq \\pi.\n\\end{cases}\n$$\n\nStage 3 downsamples by a factor $M=3$: $y[n]=x_{f}[3n]$. The DTFT of a decimated signal by factor $M$ satisfies\n$$\nY(e^{j\\omega})=\\frac{1}{M}\\sum_{k=0}^{M-1}X_{f}\\!\\left(e^{j\\frac{\\omega+2\\pi k}{M}}\\right).\n$$\nWith $M=3$,\n$$\nY(e^{j\\omega})=\\frac{1}{3}\\sum_{k=0}^{2}X_{f}\\!\\left(e^{j\\frac{\\omega+2\\pi k}{3}}\\right).\n$$\nBecause $X_{f}(e^{j\\theta})$ is nonzero only for $|\\theta|<\\pi/10$, a term in the sum is nonzero only if\n$$\n\\left|\\frac{\\omega+2\\pi k}{3}\\right|<\\frac{\\pi}{10}.\n$$\nFor $k=0$, this condition is $|\\omega|<3\\pi/10$, which is feasible and yields a nonzero contribution. For $k=1$, it would require $|\\omega+2\\pi|<3\\pi/10$, which cannot hold for $\\omega\\in[-\\pi,\\pi]$. For $k=2$, it would require $|\\omega+4\\pi|<3\\pi/10$, also impossible for $\\omega\\in[-\\pi,\\pi]$. Therefore only the $k=0$ term contributes, and $Y(e^{j\\omega})$ is nonzero precisely for\n$$\n|\\omega|<\\frac{3\\pi}{10}.\n$$\nThus the output bandwidth is $\\omega_{\\max}=\\frac{3\\pi}{10}$.\n\nTherefore, the maximum positive frequency such that $Y(e^{j\\omega})$ is nonzero for all $|\\omega|<\\omega_{\\max}$ is $\\frac{3\\pi}{10}$.", "answer": "$$\\boxed{\\frac{3\\pi}{10}}$$", "id": "1750644"}, {"introduction": "Theory is best understood when its importance is made practical. This final exercise presents a realistic \"what-if\" scenario: what happens when the crucial anti-aliasing filter is omitted from the system? By simulating this design flaw in an audio processing context, you will directly identify the resulting aliasing artifacts—unwanted frequencies that corrupt the output signal. This problem highlights the indispensable role of proper filtering in maintaining signal integrity during resampling.", "problem": "An audio processing system is designed to change the playback speed of a recording. The input is a continuous-time signal, which for testing purposes is a pure tone modeled by $x(t) = \\cos(\\omega_0 t)$, where the frequency $f_0 = \\omega_0 / (2\\pi)$ is exactly $6 \\text{ kHz}$. This signal is first digitized by an Analog-to-Digital Converter (ADC) operating at a sampling rate of $F_s = 20 \\text{ kHz}$, producing a discrete-time sequence $x[n]$.\n\nTo achieve the desired effect, the system must resample this sequence by a rational factor of $3/4$. This is implemented by first upsampling the sequence $x[n]$ by a factor of $L=3$ to get an intermediate sequence $x_u[n]$, and then downsampling $x_u[n]$ by a factor of $M=4$ to produce the final output sequence $y[n]$.\n\nHowever, due to a design flaw, the crucial low-pass anti-aliasing filter, which should be applied to $x_u[n]$ before downsampling, has been completely omitted. The final sequence $y[n]$ is then sent to an ideal Digital-to-Analog Converter (DAC) operating at the new, modified sampling rate to produce the output analog signal $y(t)$.\n\nDetermine all distinct positive frequencies, in kHz, that are present in the resulting analog signal $y(t)$. Present your answers in ascending order.", "solution": "The analog input is $x(t)=\\cos(\\omega_{0} t)$ with $f_{0}=\\omega_{0}/(2\\pi)=6\\ \\text{kHz}$. Sampling at $F_{s}=20\\ \\text{kHz}$ gives the discrete-time tone\n$$\nx[n]=\\cos(\\omega_{d} n),\\quad \\text{where } \\omega_{d}=\\frac{2\\pi f_{0}}{F_{s}}=\\frac{2\\pi\\cdot 6\\text{ kHz}}{20\\text{ kHz}}=\\frac{3\\pi}{5}\\ \\text{rad/sample}.\n$$\nUpsampling by $L=3$ creates images of the original spectrum. The original frequencies at $\\pm\\omega_d$ produce new frequencies at $\\omega_u = (\\pm\\omega_{d}+2\\pi k)/L$ for $k=0,1,2$. The distinct positive frequencies in the upsampled signal $x_u[n]$ within $[0, \\pi]$ are $\\frac{\\pi}{5}$, $\\frac{7\\pi}{15}$, and $\\frac{13\\pi}{15}$.\n\nNext, downsampling this signal by $M=4$ without a filter causes aliasing. Each frequency $\\omega_u$ in $x_u[n]$ maps to a new frequency $\\omega' \\equiv M \\omega_u \\pmod{2\\pi}$ in the output $y[n]$, which we evaluate in the range $[-\\pi, \\pi]$:\n*   For $\\omega_u = \\frac{\\pi}{5}$: $\\omega'_1 = 4 \\cdot \\frac{\\pi}{5} = \\frac{4\\pi}{5}$.\n*   For $\\omega_u = \\frac{7\\pi}{15}$: $\\omega'_2 = 4 \\cdot \\frac{7\\pi}{15} = \\frac{28\\pi}{15} \\equiv \\frac{28\\pi}{15} - 2\\pi = -\\frac{2\\pi}{15}$.\n*   For $\\omega_u = \\frac{13\\pi}{15}$: $\\omega'_3 = 4 \\cdot \\frac{13\\pi}{15} = \\frac{52\\pi}{15} \\equiv \\frac{52\\pi}{15} - 4\\pi = -\\frac{8\\pi}{15}$.\n\nThe distinct positive digital frequency magnitudes in the output sequence $y[n]$ are therefore $\\frac{2\\pi}{15}$, $\\frac{8\\pi}{15}$, and $\\frac{4\\pi}{5}$.\n\nThe final DAC operates at the new sampling rate $F_{s}'=\\frac{L}{M}F_{s}=\\frac{3}{4}\\cdot 20\\ \\text{kHz}=15\\ \\text{kHz}$. An ideal DAC maps a digital frequency $\\omega'$ to an analog frequency $f = (\\omega'/(2\\pi))F_{s}'$.\n*   For $\\omega' = \\frac{2\\pi}{15}$: $f = \\frac{2\\pi/15}{2\\pi} F_{s}' = \\frac{1}{15} \\cdot 15\\ \\text{kHz} = 1\\ \\text{kHz}$.\n*   For $\\omega' = \\frac{8\\pi}{15}$: $f = \\frac{8\\pi/15}{2\\pi} F_{s}' = \\frac{4}{15} \\cdot 15\\ \\text{kHz} = 4\\ \\text{kHz}$.\n*   For $\\omega' = \\frac{4\\pi}{5}$: $f = \\frac{4\\pi/5}{2\\pi} F_{s}' = \\frac{2}{5} \\cdot 15\\ \\text{kHz} = 6\\ \\text{kHz}$.\n\nTherefore, the distinct positive frequencies present in $y(t)$ are $1\\ \\text{kHz}$, $4\\ \\text{kHz}$, and $6\\ \\text{kHz}$, in ascending order.", "answer": "$$\\boxed{1, 4, 6}$$", "id": "1750693"}]}