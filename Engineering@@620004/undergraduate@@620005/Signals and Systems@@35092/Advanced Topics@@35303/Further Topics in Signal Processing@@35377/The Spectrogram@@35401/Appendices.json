{"hands_on_practices": [{"introduction": "Before analyzing complex time-varying spectra, it is crucial to understand how new frequency components can emerge from simple inputs. This first practice explores the effect of a common nonlinearity—a memoryless squaring device—on a pure sinusoidal signal. By working through this foundational problem, you will see how nonlinear systems generate harmonics, which are new frequencies that are integer multiples of the input frequency, a phenomenon that spectrograms are perfectly suited to reveal [@problem_id:1765704].", "problem": "An engineer is testing a nonlinear electronic component. The input to this component is a pure sinusoidal voltage signal, described by the function $v_{in}(t) = V_0 \\cos(\\omega_0 t)$, where $V_0$ is the peak amplitude and $\\omega_0$ is the angular frequency in radians per second. The component is a memoryless squaring device, meaning its output voltage is given by the relation $v_{out}(t) = [v_{in}(t)]^2$. The engineer uses a spectrum analyzer to observe the frequency content of the output signal $v_{out}(t)$. Assuming the input signal is non-trivial (i.e., $V_0 \\neq 0$ and $\\omega_0 \\neq 0$), which of the following best describes the set of angular frequencies present in the output signal $v_{out}(t)$?\n\nA. Only the original frequency, $\\omega_0$.\n\nB. The original frequency, $\\omega_0$, and a new component at $2\\omega_0$.\n\nC. A DC component (0 rad/s) and a new component at $2\\omega_0$.\n\nD. Only a new component at $2\\omega_0$.\n\nE. A DC component (0 rad/s), the original frequency $\\omega_0$, and a new component at $2\\omega_0$.", "solution": "The input is a single-tone sinusoid described by $v_{in}(t) = V_{0} \\cos(\\omega_{0} t)$ with $V_{0} \\neq 0$ and $\\omega_{0} \\neq 0$. The device is a memoryless squaring nonlinearity, so the output is\n$$\nv_{out}(t) = \\left[v_{in}(t)\\right]^{2} = \\left(V_{0} \\cos(\\omega_{0} t)\\right)^{2} = V_{0}^{2} \\cos^{2}(\\omega_{0} t).\n$$\nUse the trigonometric power-reduction identity\n$$\n\\cos^{2}(x) = \\frac{1 + \\cos(2x)}{2}.\n$$\nApplying this with $x = \\omega_{0} t$ gives\n$$\nv_{out}(t) = \\frac{V_{0}^{2}}{2} \\left[1 + \\cos(2 \\omega_{0} t)\\right].\n$$\nThis decomposition shows:\n- A DC component (zero angular frequency) with amplitude $\\frac{V_{0}^{2}}{2}$.\n- A single harmonic at angular frequency $2 \\omega_{0}$ with amplitude $\\frac{V_{0}^{2}}{2}$.\nThere is no component at the original frequency $\\omega_{0}$. Because $V_{0} \\neq 0$, the amplitudes are nonzero, and because $\\omega_{0} \\neq 0$, the harmonic is at a nonzero frequency. Therefore, the set of angular frequencies present is $\\{0, 2\\omega_{0}\\}$, which corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "1765704"}, {"introduction": "A spectrogram is not a perfect, objective representation of a signal's frequency content over time; rather, it is an image created through the \"lens\" of a chosen analysis window. This exercise tackles the heart of practical spectrogram analysis: the fundamental time-frequency trade-off. By considering how the spectrogram of a gated sinusoid changes with a short versus a long analysis window, $T_w$, you will gain critical intuition for how analysis parameters shape what you see and learn to distinguish true signal features from measurement artifacts [@problem_id:1765705].", "problem": "Consider a signal $x(t)$ generated by gating a pure sinusoidal tone with a periodic rectangular pulse train. The sinusoidal tone is described by $c(t) = \\cos(2\\pi f_c t)$, where the carrier frequency is $f_c = 1000$ Hz.\n\nThe gating signal, $p(t)$, is a periodic rectangular pulse train with a period of $T_p = 200$ ms. It has a duty cycle of 50%, meaning the pulse is \"high\" (value of 1) for a duration of $D = 100$ ms and \"low\" (value of 0) for the remaining 100 ms of each period. The resulting signal is $x(t) = c(t) \\cdot p(t)$.\n\nA spectrogram of this signal $x(t)$ is to be computed. The spectrogram is the squared magnitude of the Short-Time Fourier Transform (STFT), which analyzes the frequency content of the signal over time using a sliding window. We will consider two distinct scenarios based on the length of the analysis window, $T_w$.\n\n- **Scenario 1:** The window length is $T_w = 10$ ms.\n- **Scenario 2:** The window length is $T_w = 500$ ms.\n\nWhich of the following statements provides the most accurate qualitative description of the dominant features in the spectrograms for both scenarios?\n\nA.\n- Scenario 1: A prominent feature near frequency $f_c$ that appears and disappears with a period of 200 ms. The feature is present for approximately 100 ms and absent for 100 ms. The short window causes significant frequency broadening.\n- Scenario 2: A set of sharp, continuous horizontal lines at the carrier frequency $f_c = 1000$ Hz and sideband frequencies $f_c \\pm k f_p$, where $f_p=5$ Hz. The intensity of these lines decreases for larger integer values of $|k|$, and lines corresponding to even non-zero values of $k$ (e.g., at $1000 \\pm 10$ Hz, $1000 \\pm 20$ Hz) are absent.\n\nB.\n- Scenario 1: A set of sharp, continuous horizontal lines at the carrier frequency $f_c = 1000$ Hz and sideband frequencies $f_c \\pm k f_p$, where $f_p=5$ Hz. The intensity of these lines decreases for larger integer values of $|k|$, and lines corresponding to even non-zero values of $k$ are absent.\n- Scenario 2: A prominent feature near frequency $f_c$ that appears and disappears with a period of 200 ms. The feature is present for approximately 100 ms and absent for 100 ms.\n\nC.\n- Scenario 1: A prominent feature near frequency $f_c$ that appears and disappears with a period of 200 ms. The feature is present for approximately 100 ms and absent for 100 ms. The short window causes significant frequency broadening.\n- Scenario 2: A set of sharp, continuous horizontal lines at sideband frequencies $f_c \\pm k f_p$ for odd values of $k$ only, where $f_p=5$ Hz. The central line at the carrier frequency $f_c=1000$ Hz is absent.\n\nD.\n- Scenario 1: A single, continuous horizontal line at frequency $f_c = 1000$ Hz, intersected by periodic vertical lines (broadband bursts) every 100 ms.\n- Scenario 2: A set of sharp, continuous horizontal lines at the carrier frequency $f_c = 1000$ Hz and sideband frequencies $f_c \\pm k f_p$, where $f_p=5$ Hz. The intensity of these lines decreases for larger integer values of $|k|$, and lines corresponding to even non-zero values of $k$ are absent.\n\nE.\n- Scenario 1: A prominent feature near frequency $f_c$ that appears and disappears with a period of 200 ms. The feature is present for approximately 100 ms and absent for 100 ms. The short window causes significant frequency broadening.\n- Scenario 2: A set of sharp, continuous horizontal lines at the carrier frequency $f_c = 1000$ Hz and sideband frequencies $f_c \\pm k f_p$, where $f_p=5$ Hz. All integer values of $k$ produce visible lines, with intensity decreasing smoothly as $|k|$ increases.", "solution": "The problem asks to predict the appearance of a spectrogram for a gated sinusoid under two different Short-Time Fourier Transform (STFT) window lengths. The key principle is the time-frequency uncertainty principle: a short time window provides good time resolution but poor frequency resolution, while a long time window provides good frequency resolution but poor time resolution.\n\nThe signal is $x(t) = \\cos(2\\pi f_c t) \\cdot p(t)$, with $f_c = 1000$ Hz. The pulse train $p(t)$ has a period $T_p = 200$ ms and a pulse duration $D = 100$ ms (50% duty cycle). The fundamental frequency of the pulse train is $f_p = 1/T_p = 1/0.2 = 5$ Hz.\n\n**Analysis of Scenario 1: Short Window ($T_w = 10$ ms)**\n\nIn this scenario, the window length $T_w=10$ ms is much shorter than both the pulse duration ($D=100$ ms) and the period ($T_p=200$ ms).\n- **Time Resolution:** The time resolution is high, on the order of $T_w$. The STFT can distinguish events that happen on a timescale larger than 10 ms. Since the signal is switched on for 100 ms and off for 100 ms, the STFT can clearly resolve these 'on' and 'off' states.\n- **Frequency Resolution:** The frequency resolution is poor, on the order of $\\Delta f \\approx 1/T_w = 1/0.01 = 100$ Hz. The STFT cannot resolve frequency components that are closer than about 100 Hz.\n\nWhen the STFT window is positioned within one of the 'on' intervals, it analyzes a segment of a pure sinusoid $\\cos(2\\pi f_c t)$. The transform will show a peak of energy centered at $f_c = 1000$ Hz. Due to the poor frequency resolution, this peak will be broad, smeared across a frequency range of about 100 Hz.\nWhen the window is positioned within an 'off' interval, it analyzes a signal that is zero, so the transform will show near-zero energy.\n\nAs the window slides in time, the spectrogram will show a feature centered at $f_c=1000$ Hz appearing for 100 ms, then disappearing for 100 ms, repeating with the period $T_p=200$ ms. This matches the first part of options A, C, and E.\n\n**Analysis of Scenario 2: Long Window ($T_w = 500$ ms)**\n\nIn this scenario, the window length $T_w = 500$ ms is much longer than the period of the pulse train ($T_p = 200$ ms).\n- **Time Resolution:** The time resolution is poor, on the order of $T_w=500$ ms. The STFT window always covers multiple 'on' and 'off' cycles (specifically, $500/200 = 2.5$ cycles). It cannot resolve the individual on/off events in time. Thus, the resulting spectrogram will appear continuous in time, not showing the periodic blinking.\n- **Frequency Resolution:** The frequency resolution is excellent, on the order of $\\Delta f \\approx 1/T_w = 1/0.5 = 2$ Hz. The STFT can resolve frequency components that are separated by more than 2 Hz. This is fine enough to resolve the spectral structure caused by the 5 Hz pulse train.\n\nTo understand this structure, we analyze the signal in the frequency domain. The signal $x(t)$ is the product of two signals, so its Fourier transform $X(f)$ is the convolution of their individual transforms:\n$X(f) = \\mathcal{F}\\{\\cos(2\\pi f_c t)\\} * \\mathcal{F}\\{p(t)\\}$\n\nThe Fourier transform of the sinusoid is two delta functions:\n$\\mathcal{F}\\{\\cos(2\\pi f_c t)\\} = \\frac{1}{2}[\\delta(f-f_c) + \\delta(f+f_c)]$\n\nThe pulse train $p(t)$ is periodic, so its Fourier transform is a train of delta functions located at integer multiples of the fundamental frequency $f_p=5$ Hz. The weights of these delta functions are given by the Fourier series coefficients $c_k$ of $p(t)$.\n$\\mathcal{F}\\{p(t)\\} = \\sum_{k=-\\infty}^{\\infty} c_k \\delta(f - k f_p)$\n\nFor a rectangular pulse train with 50% duty cycle ($D=T_p/2$), the coefficients are given by:\n$c_k = \\frac{1}{T_p} \\int_{-D/2}^{D/2} (1) \\cdot e^{-j 2\\pi k f_p t} dt = \\frac{1}{T_p} \\int_{-T_p/4}^{T_p/4} e^{-j 2\\pi k t/T_p} dt$\n$c_k = \\frac{1}{T_p} \\left[ \\frac{e^{-j 2\\pi k t/T_p}}{-j 2\\pi k/T_p} \\right]_{-T_p/4}^{T_p/4} = \\frac{1}{-j 2\\pi k} (e^{-j \\pi k/2} - e^{j \\pi k/2}) = \\frac{-2j \\sin(-\\pi k/2)}{-j 2\\pi k} = \\frac{\\sin(\\pi k/2)}{\\pi k}$\nThis is a normalized sinc function: $c_k = \\frac{1}{2}\\text{sinc}(\\frac{k}{2})$.\n\nLet's evaluate $c_k$ for a few values of $k$:\n- $k=0$: $c_0 = \\lim_{k\\to 0} \\frac{\\sin(\\pi k/2)}{\\pi k} = \\frac{\\pi/2}{\\pi} = 1/2$. (The DC offset is 0.5, as expected for 50% duty cycle).\n- $k=\\pm 1$: $c_{\\pm 1} = \\frac{\\sin(\\pm \\pi/2)}{\\pm \\pi} = \\frac{\\pm 1}{\\pm \\pi} = 1/\\pi$.\n- $k=\\pm 2$: $c_{\\pm 2} = \\frac{\\sin(\\pm \\pi)}{\\pm 2\\pi} = 0$.\n- $k=\\pm 3$: $c_{\\pm 3} = \\frac{\\sin(\\pm 3\\pi/2)}{\\pm 3\\pi} = \\frac{\\mp 1}{\\pm 3\\pi} = -1/(3\\pi)$.\n- $k=\\pm 4$: $c_{\\pm 4} = \\frac{\\sin(\\pm 2\\pi)}{\\pm 4\\pi} = 0$.\nIn general, $c_k=0$ for all even, non-zero integers $k$.\n\nNow, convolving the sinusoid's spectrum with the pulse train's spectrum means placing scaled copies of the pulse train's spectrum at $f=\\pm f_c$. The resulting spectrum $X(f)$ (for positive frequencies) consists of delta functions at frequencies $f_c + k f_p$:\n$X(f) \\propto \\sum_{k=-\\infty}^{\\infty} c_k \\delta(f - (f_c + k f_p))$\nThe high-resolution STFT will resolve these delta functions as sharp spectral lines. The spectrogram will therefore show continuous horizontal lines at frequencies $f = f_c + k f_p = 1000 + k \\cdot 5$ Hz.\n\nThe intensity of these lines is proportional to $|c_k|^2$.\n- A strong line exists at $f_c$ (for $k=0$).\n- Lines exist at $f_c \\pm 5$ Hz (for $k=\\pm 1$).\n- Lines at $f_c \\pm 10$ Hz (for $k=\\pm 2$) are absent because $c_{\\pm 2} = 0$.\n- Lines exist at $f_c \\pm 15$ Hz (for $k=\\pm 3$).\n- Lines at $f_c \\pm 20$ Hz (for $k=\\pm 4$) are absent because $c_{\\pm 4} = 0$.\nAnd so on. This matches the second part of option A.\n\n**Evaluating the Options:**\n- **A:** Correctly describes both scenarios based on the analysis above.\n- **B:** Incorrectly swaps the descriptions for the two scenarios.\n- **C:** Incorrectly claims the central line at $f_c$ is absent for Scenario 2. The $k=0$ component ($c_0$) is non-zero.\n- **D:** Incorrectly describes Scenario 1. Vertical lines imply impulsive, broadband events, whereas the gating creates periodic segments of a narrowband signal.\n- **E:** Incorrectly describes Scenario 2. It fails to account for the nulls in the spectrum at even multiples of $f_p$ away from the carrier, which is a specific feature of the 50% duty cycle pulse train.\n\nTherefore, option A is the only one that accurately describes both situations.", "answer": "$$\\boxed{A}$$", "id": "1765705"}, {"introduction": "Spectrograms are not just for observing signals in isolation; they are powerful tools for predicting and analyzing how signals are transformed by systems. This problem applies time-frequency concepts to a practical scenario involving a Linear Time-Invariant (LTI) filter. You will use the essential approximation $S_y(\\tau, \\omega) \\approx |H(\\omega)|^2 S_x(\\tau, \\omega)$ to quantify how a filter alters the energy of a signal whose frequency content changes over time, solidifying the connection between system theory and practical signal analysis [@problem_id:1765710].", "problem": "A diagnostic system for industrial machinery analyzes an acoustic signal, $x(t)$, by passing it through a pre-processing filter to produce an output signal, $y(t)$. The filter is a stable Linear Time-Invariant (LTI) system. The analysis is performed in the time-frequency domain using spectrograms, which represent the energy distribution of a signal over time and frequency. Let $S_x(\\tau, \\omega)$ be the spectrogram of the input signal and $S_y(\\tau, \\omega)$ be the spectrogram of the output signal.\n\nThe input signal $x(t)$ is characterized by its spectrogram, which is found to be non-zero only during two specific operational epochs of the machine.\n- In the time interval $0 \\le \\tau \\le T_0$, the input signal's energy is highly concentrated at a single angular frequency $\\omega_1$, where the spectrogram has a constant amplitude of $P_1$.\n- In the time interval $T_0 < \\tau \\le 2T_0$, the input signal's energy is highly concentrated at a different single angular frequency $\\omega_2$, where the spectrogram has a constant amplitude of $P_2$.\n- The spectrogram $S_x(\\tau, \\omega)$ is zero for all other times and frequencies.\n\nThe LTI pre-processing filter has a magnitude frequency response given by $|H(\\omega)| = \\frac{K}{\\sqrt{1 + (\\omega/\\omega_c)^2}}$, where $K$ and $\\omega_c$ are positive real constants representing the filter's gain and cut-off frequency, respectively. For the analysis technique employed, the output spectrogram is modeled by the relation $S_y(\\tau, \\omega) = |H(\\omega)|^2 S_x(\\tau, \\omega)$.\n\nCalculate the ratio of the total energy of the output signal $y(t)$ within the time interval $[0, T_0]$ to the total energy of the output signal $y(t)$ within the time interval $(T_0, 2T_0]$. Express your answer as a symbolic expression in terms of $P_1$, $P_2$, $\\omega_1$, $\\omega_2$, and $\\omega_c$.", "solution": "The total energy of a signal within a time interval $[a,b]$ is given in terms of its spectrogram by\n$$\nE_{y}[a,b]=\\int_{a}^{b}\\int_{-\\infty}^{\\infty} S_{y}(\\tau,\\omega)\\,d\\omega\\,d\\tau.\n$$\nFor a stable LTI system, the output spectrogram satisfies $S_{y}(\\tau,\\omega)=|H(\\omega)|^{2}S_{x}(\\tau,\\omega)$.\n\nBy the problem statement, during $0\\le \\tau\\le T_{0}$, the input spectrogram is concentrated at $\\omega_{1}$ with constant amplitude $P_{1}$, which we model as\n$$\nS_{x}(\\tau,\\omega)=P_{1}\\,\\delta(\\omega-\\omega_{1})\\quad \\text{for }0\\le \\tau\\le T_{0},\n$$\nand during $T_{0}<\\tau\\le 2T_{0}$, it is concentrated at $\\omega_{2}$ with constant amplitude $P_{2}$,\n$$\nS_{x}(\\tau,\\omega)=P_{2}\\,\\delta(\\omega-\\omega_{2})\\quad \\text{for }T_{0}<\\tau\\le 2T_{0},\n$$\nwith $S_{x}(\\tau,\\omega)=0$ otherwise.\n\nHence, the output spectrogram in the first interval is\n$$\nS_{y}(\\tau,\\omega)=|H(\\omega)|^{2}P_{1}\\,\\delta(\\omega-\\omega_{1}),\n$$\nso the energy in $[0,T_{0}]$ is\n$$\nE_{1}=\\int_{0}^{T_{0}}\\int_{-\\infty}^{\\infty}|H(\\omega)|^{2}P_{1}\\,\\delta(\\omega-\\omega_{1})\\,d\\omega\\,d\\tau\n=\\int_{0}^{T_{0}}|H(\\omega_{1})|^{2}P_{1}\\,d\\tau\n=T_{0}\\,|H(\\omega_{1})|^{2}P_{1}.\n$$\nSimilarly, for $(T_{0},2T_{0}]$,\n$$\nE_{2}=\\int_{T_{0}}^{2T_{0}}\\int_{-\\infty}^{\\infty}|H(\\omega)|^{2}P_{2}\\,\\delta(\\omega-\\omega_{2})\\,d\\omega\\,d\\tau\n=T_{0}\\,|H(\\omega_{2})|^{2}P_{2}.\n$$\nTherefore, the desired ratio is\n$$\n\\frac{E_{1}}{E_{2}}=\\frac{|H(\\omega_{1})|^{2}P_{1}}{|H(\\omega_{2})|^{2}P_{2}}.\n$$\nUsing the given magnitude response $|H(\\omega)|=\\dfrac{K}{\\sqrt{1+(\\omega/\\omega_{c})^{2}}}$, we have\n$$\n|H(\\omega)|^{2}=\\frac{K^{2}}{1+(\\omega/\\omega_{c})^{2}}.\n$$\nSubstituting and simplifying,\n$$\n\\frac{E_{1}}{E_{2}}=\\frac{\\dfrac{K^{2}}{1+(\\omega_{1}/\\omega_{c})^{2}}P_{1}}{\\dfrac{K^{2}}{1+(\\omega_{2}/\\omega_{c})^{2}}P_{2}}\n=\\frac{P_{1}}{P_{2}}\\cdot \\frac{1+(\\omega_{2}/\\omega_{c})^{2}}{1+(\\omega_{1}/\\omega_{c})^{2}}.\n$$", "answer": "$$\\boxed{\\frac{P_{1}}{P_{2}}\\cdot \\frac{1+(\\omega_{2}/\\omega_{c})^{2}}{1+(\\omega_{1}/\\omega_{c})^{2}}}$$", "id": "1765710"}]}