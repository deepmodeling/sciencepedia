{"hands_on_practices": [{"introduction": "We begin our hands-on exploration with the most fundamental application of polyphase decomposition. This practice exercise demonstrates how to break down a simple yet common filter—the two-point moving average filter—into its two polyphase components. By directly applying the decomposition formula, you will gain a concrete understanding of how a filter's impulse response is separated into its 'even' and 'odd' parts, a core skill for designing efficient multirate systems. [@problem_id:1737208]", "problem": "In multirate digital signal processing, a filter's transfer function, $H(z)$, can be decomposed into a set of 'polyphase components'. This decomposition is crucial for designing efficient filter banks, which are used in applications like audio compression and communications. For a system with a decimation/interpolation factor of $M=2$, the transfer function $H(z)$ can be uniquely represented in terms of its two polyphase components, $E_0(z)$ and $E_1(z)$, through the relationship:\n\n$$H(z) = E_0(z^{2}) + z^{-1}E_1(z^{2})$$\n\nConsider a simple two-point moving average filter, a type of Finite Impulse Response (FIR) filter commonly used for basic noise reduction in real-time data streams. The transfer function for this filter is given by:\n\n$$H(z) = 0.5(1 + z^{-1})$$\n\nDetermine the two polyphase component filters, $E_0(z)$ and $E_1(z)$, for this specific moving average filter. Your final answer should be the pair of expressions for $E_0(z)$ and $E_1(z)$.", "solution": "We start from the given 2-point moving average FIR filter with transfer function\n$$H(z) = \\frac{1}{2}\\left(1 + z^{-1}\\right).$$\nBy definition, an FIR transfer function can be written as\n$$H(z) = \\sum_{n=0}^{\\infty} h[n] z^{-n},$$\nfrom which we identify the impulse response coefficients as $h[0] = \\frac{1}{2}$, $h[1] = \\frac{1}{2}$, and $h[n] = 0$ for all other $n$.\n\nFor polyphase decomposition with $M=2$, the type-1 polyphase components $E_{0}(z)$ and $E_{1}(z)$ are defined by splitting $h[n]$ into its even- and odd-indexed parts:\n$$E_{0}(z) = \\sum_{k=0}^{\\infty} h[2k] z^{-k}, \\qquad E_{1}(z) = \\sum_{k=0}^{\\infty} h[2k+1] z^{-k},$$\nand they satisfy\n$$H(z) = E_{0}\\left(z^{2}\\right) + z^{-1} E_{1}\\left(z^{2}\\right).$$\n\nCompute $E_{0}(z)$:\n- The only nonzero even-indexed coefficient is $h[0] = \\frac{1}{2}$, corresponding to $k=0$. Therefore,\n$$E_{0}(z) = \\frac{1}{2}.$$\n\nCompute $E_{1}(z)$:\n- The only nonzero odd-indexed coefficient is $h[1] = \\frac{1}{2}$, corresponding to $k=0$. Therefore,\n$$E_{1}(z) = \\frac{1}{2}.$$\n\nVerification:\n$$E_{0}\\left(z^{2}\\right) + z^{-1} E_{1}\\left(z^{2}\\right) = \\frac{1}{2} + z^{-1}\\left(\\frac{1}{2}\\right) = \\frac{1}{2}\\left(1 + z^{-1}\\right) = H(z),$$\nwhich matches the given transfer function.\n\nHence, the polyphase components are $E_{0}(z) = \\frac{1}{2}$ and $E_{1}(z) = \\frac{1}{2}$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2} & \\frac{1}{2}\\end{pmatrix}}$$", "id": "1737208"}, {"introduction": "Having mastered the 2-phase case, we now generalize the concept to a system with more components. This problem challenges you to perform a 3-phase decomposition on a given Finite Impulse Response (FIR) filter. This practice is crucial as it demonstrates the scalability of the polyphase technique, which is essential for implementing sophisticated filter banks with an arbitrary number of channels. [@problem_id:1742747]", "problem": "A causal discrete-time Finite Impulse Response (FIR) filter is characterized by the impulse response $h[n] = 2\\delta[n] - \\delta[n-1] + 3\\delta[n-3] - 4\\delta[n-5]$. For an efficient hardware implementation, this filter is to be realized using a 3-phase polyphase decomposition. The polyphase component sequences, denoted $e_0[n]$, $e_1[n]$, and $e_2[n]$, are defined from the original impulse response $h[n]$ by the relation $e_k[n] = h[3n+k]$ for $k \\in \\{0, 1, 2\\}$.\n\nDetermine the Z-transforms of these three polyphase component sequences, denoted as $E_0(z)$, $E_1(z)$, and $E_2(z)$.", "solution": "The problem requires finding the 3-phase polyphase components of the FIR filter with impulse response $h[n] = 2\\delta[n] - \\delta[n-1] + 3\\delta[n-3] - 4\\delta[n-5]$.\nThe non-zero values of the impulse response are:\n$h[0] = 2$\n$h[1] = -1$\n$h[2] = 0$\n$h[3] = 3$\n$h[4] = 0$\n$h[5] = -4$\nFor all other non-negative integers $n$, $h[n]=0$.\n\nThe polyphase components $e_k[n]$ are defined by the relation $e_k[n] = h[Mn+k]$, where $M=3$ is the number of phases. We will determine each component sequence $e_k[n]$ for $k=0, 1, 2$ by downsampling the original sequence, and then find their respective Z-transforms $E_k(z)$.\n\nFirst, we determine the component sequence $e_0[n]$. This component is formed by taking every third sample of $h[n]$, starting with the first sample ($n=0$). The definition is $e_0[n] = h[3n]$.\nFor $n=0$: $e_0[0] = h[3 \\cdot 0] = h[0] = 2$.\nFor $n=1$: $e_0[1] = h[3 \\cdot 1] = h[3] = 3$.\nFor $n \\geq 2$, the index $3n$ will be $6, 9, 12, \\dots$. Since $h[m]=0$ for $m > 5$, all subsequent values $e_0[n]$ for $n \\geq 2$ are zero.\nSo, the sequence $e_0[n]$ is given by $e_0[n] = 2\\delta[n] + 3\\delta[n-1]$.\nThe Z-transform of $e_0[n]$ is $E_0(z) = \\mathcal{Z}\\{e_0[n]\\}$, which is:\n$E_0(z) = \\mathcal{Z}\\{2\\delta[n] + 3\\delta[n-1]\\} = 2(1) + 3(z^{-1}) = 2 + 3z^{-1}$.\n\nNext, we determine the component sequence $e_1[n]$. This component is formed by taking every third sample of $h[n]$, starting with the second sample ($n=1$). The definition is $e_1[n] = h[3n+1]$.\nFor $n=0$: $e_1[0] = h[3 \\cdot 0 + 1] = h[1] = -1$.\nFor $n=1$: $e_1[1] = h[3 \\cdot 1 + 1] = h[4] = 0$.\nFor $n \\geq 1$, the index $3n+1$ will be $4, 7, 10, \\dots$. Since $h[m]=0$ for these indices (except for $h[1]$, which we've already covered), all subsequent values $e_1[n]$ for $n \\geq 1$ are zero.\nSo, the sequence $e_1[n]$ is given by $e_1[n] = -1 \\cdot \\delta[n]$.\nThe Z-transform of $e_1[n]$ is $E_1(z) = \\mathcal{Z}\\{e_1[n]\\}$:\n$E_1(z) = \\mathcal{Z}\\{-\\delta[n]\\} = -1$.\n\nFinally, we determine the component sequence $e_2[n]$. This component is formed by taking every third sample of $h[n]$, starting with the third sample ($n=2$). The definition is $e_2[n] = h[3n+2]$.\nFor $n=0$: $e_2[0] = h[3 \\cdot 0 + 2] = h[2] = 0$.\nFor $n=1$: $e_2[1] = h[3 \\cdot 1 + 2] = h[5] = -4$.\nFor $n \\geq 2$, the index $3n+2$ will be $8, 11, \\dots$. Since $h[m]=0$ for these indices, all subsequent values $e_2[n]$ for $n \\geq 2$ are zero.\nSo, the sequence $e_2[n]$ is given by $e_2[n] = -4\\delta[n-1]$.\nThe Z-transform of $e_2[n]$ is $E_2(z) = \\mathcal{Z}\\{e_2[n]\\}$:\n$E_2(z) = \\mathcal{Z}\\{-4\\delta[n-1]\\} = -4z^{-1}$.\n\nTo summarize, the Z-transforms of the three polyphase components are:\n$E_0(z) = 2 + 3z^{-1}$\n$E_1(z) = -1$\n$E_2(z) = -4z^{-1}$", "answer": "$$\\boxed{\\begin{pmatrix} 2 + 3z^{-1} & -1 & -4z^{-1} \\end{pmatrix}}$$", "id": "1742747"}, {"introduction": "Our final practice moves from concrete numerical examples to a more general, algebraic analysis. Here, you will investigate how polyphase decomposition applies to a system of two cascaded filters, expressing the overall components in terms of the individual filter coefficients. This exercise develops essential skills for analyzing and designing complex multirate systems, where understanding the properties of interconnected filter blocks is key to an efficient implementation. [@problem_id:1742749]", "problem": "In the design of efficient multirate digital signal processing systems, a filter is often implemented using its polyphase components. Consider a filtering system $H(z)$ that is realized by cascading two Finite Impulse Response (FIR) filters, $H_1(z)$ and $H_2(z)$, such that the overall transfer function is $H(z) = H_1(z)H_2(z)$.\n\nThe individual filters are given by their transfer functions:\n$H_1(z) = a_0 + a_1 z^{-1} + a_2 z^{-2}$\n$H_2(z) = b_0 + b_1 z^{-1}$\nwhere $a_0, a_1, a_2, b_0,$ and $b_1$ are constant real coefficients.\n\nFor an efficient implementation, the overall filter $H(z)$ is to be represented using its 2-phase (Type 1) polyphase decomposition, which is defined as:\n$H(z) = E_0(z^2) + z^{-1}E_1(z^2)$\nHere, $E_0(z)$ and $E_1(z)$ are the two polyphase components of $H(z)$.\n\nDetermine the transfer functions for the polyphase components $E_0(z)$ and $E_1(z)$ of the cascaded system $H(z)$. Express your answers in terms of the coefficients $a_0, a_1, a_2, b_0, b_1$. Present your final answer as a $1 \\times 2$ row matrix of the form $\\begin{pmatrix} E_0(z) & E_1(z) \\end{pmatrix}$.", "solution": "We start with the cascaded FIR filters with transfer functions\n$$H_{1}(z)=a_{0}+a_{1}z^{-1}+a_{2}z^{-2}, \\quad H_{2}(z)=b_{0}+b_{1}z^{-1}.$$\nThe overall transfer function is the product\n$$H(z)=H_{1}(z)H_{2}(z).$$\nBy polynomial multiplication,\n$$\n\\begin{aligned}\nH(z)&=(a_{0}+a_{1}z^{-1}+a_{2}z^{-2})(b_{0}+b_{1}z^{-1})\\\\\n&=a_{0}b_{0}+(a_{0}b_{1}+a_{1}b_{0})z^{-1}+(a_{1}b_{1}+a_{2}b_{0})z^{-2}+a_{2}b_{1}z^{-3}.\n\\end{aligned}\n$$\nThus, if we denote the impulse response coefficients by $h[n]$, we have\n$$h[0]=a_{0}b_{0},\\quad h[1]=a_{0}b_{1}+a_{1}b_{0},\\quad h[2]=a_{1}b_{1}+a_{2}b_{0},\\quad h[3]=a_{2}b_{1}.$$\nFor the 2-phase (Type 1) polyphase decomposition, the definition is\n$$H(z)=E_{0}(z^{2})+z^{-1}E_{1}(z^{2}),$$\nwhere the polyphase components collect even- and odd-indexed samples, respectively:\n$$E_{0}(z)=\\sum_{k}h[2k]z^{-k},\\qquad E_{1}(z)=\\sum_{k}h[2k+1]z^{-k}.$$\nUsing the computed $h[n]$, we obtain\n$$E_{0}(z)=h[0]+h[2]z^{-1}=a_{0}b_{0}+\\left(a_{1}b_{1}+a_{2}b_{0}\\right)z^{-1},$$\n$$E_{1}(z)=h[1]+h[3]z^{-1}=\\left(a_{0}b_{1}+a_{1}b_{0}\\right)+a_{2}b_{1}z^{-1}.$$\nTherefore, the requested $1\\times 2$ row matrix is\n$$\\begin{pmatrix}E_{0}(z) & E_{1}(z)\\end{pmatrix}=\\begin{pmatrix}a_{0}b_{0}+\\left(a_{1}b_{1}+a_{2}b_{0}\\right)z^{-1} & \\left(a_{0}b_{1}+a_{1}b_{0}\\right)+a_{2}b_{1}z^{-1}\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}a_{0}b_{0}+\\left(a_{1}b_{1}+a_{2}b_{0}\\right)z^{-1} & \\left(a_{0}b_{1}+a_{1}b_{0}\\right)+a_{2}b_{1}z^{-1}\\end{pmatrix}}$$", "id": "1742749"}]}