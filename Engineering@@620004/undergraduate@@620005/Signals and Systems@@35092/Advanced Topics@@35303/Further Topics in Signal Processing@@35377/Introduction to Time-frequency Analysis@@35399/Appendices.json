{"hands_on_practices": [{"introduction": "The power of time-frequency analysis comes with a fundamental trade-off: you cannot simultaneously know the exact time and the exact frequency of a signal feature. This principle means that a high resolution in the time domain comes at the cost of poor resolution in the frequency domain, and vice versa. This practice [@problem_id:1730830] places you in the role of an engineer facing this very dilemma, tasking you with determining the minimum window size needed to distinguish two very close frequencies. By completing this exercise, you will gain a concrete, quantitative understanding of how frequency resolution is inversely tied to the duration of the analysis window.", "problem": "An engineer is tasked with analyzing a vibration signal from a precision-machined rotating assembly to diagnose a potential imbalance. The signal is sampled at a rate $F_s = 10.0 \\text{ kHz}$. Initial analysis suggests the presence of two dominant sinusoidal components with frequencies $f_1 = 2000.0 \\text{ Hz}$ and $f_2 = 1999.3 \\text{ Hz}$.\n\nTo investigate the time-varying nature of these components, the engineer employs a Short-Time Fourier Transform (STFT). The analysis uses a Hann window. For this type of window, a common criterion for resolving two sinusoids of similar amplitude is that their frequency separation must be at least twice the frequency resolution, or \"bin spacing,\" of the Discrete Fourier Transform (DFT) computed on the windowed segment. The bin spacing is defined as $\\frac{F_s}{N}$, where $N$ is the number of samples in the window.\n\nDetermine the minimum duration of the Hann window, in milliseconds, that the engineer must use to successfully resolve these two frequency components according to the specified criterion. Express your answer in milliseconds, rounded to three significant figures.", "solution": "We are given a sampling rate $F_{s}$ and two sinusoidal components at frequencies $f_{1}$ and $f_{2}$. Let the frequency separation be $\\Delta f_{s} = |f_{1} - f_{2}|$. For an STFT using a Hann window, the stated resolution criterion for two similar-amplitude sinusoids is that they are resolved if their separation is at least twice the DFT bin spacing. The DFT bin spacing for a window of $N$ samples is $\\Delta f_{\\text{bin}} = \\frac{F_{s}}{N}$. Therefore, the resolution condition is\n$$\n\\Delta f_{s} \\geq 2 \\Delta f_{\\text{bin}} = \\frac{2 F_{s}}{N}.\n$$\nSolving this inequality for $N$ gives\n$$\nN \\geq \\frac{2 F_{s}}{\\Delta f_{s}}.\n$$\nThe window duration in seconds is $T_{w} = \\frac{N}{F_{s}}$, so the minimum duration that satisfies the criterion is\n$$\nT_{w,\\min} = \\frac{1}{F_{s}} \\cdot \\frac{2 F_{s}}{\\Delta f_{s}} = \\frac{2}{\\Delta f_{s}}.\n$$\nNow compute the frequency separation from the given values:\n$$\n\\Delta f_{s} = |2000.0 - 1999.3| \\text{ Hz} = 0.7 \\text{ Hz}.\n$$\nHence,\n$$\nT_{w,\\min} = \\frac{2}{0.7} \\text{ s} = \\frac{20}{7} \\text{ s}.\n$$\nConverting to milliseconds,\n$$\nT_{w,\\min} = \\frac{20}{7} \\times 10^{3} \\text{ ms} \\approx 2.857142857 \\times 10^{3} \\text{ ms}.\n$$\nRounded to three significant figures,\n$$\nT_{w,\\min} \\approx 2.86 \\times 10^{3} \\text{ ms}.\n$$", "answer": "$$\\boxed{2.86 \\times 10^{3}}$$", "id": "1730830"}, {"introduction": "Once we understand that a longer window improves frequency resolution, it's tempting to look for computational shortcuts. A common technique in digital signal processing is zero-padding, which increases the number of points in a Discrete Fourier Transform (DFT) and can make a spectrogram appear more detailed. This practice [@problem_id:1730843] confronts a critical question: does zero-padding actually improve our ability to resolve closely spaced frequencies? By exploring its effect, you will learn to distinguish between true physical resolution, which is set by the window, and computational interpolation, a vital skill for accurately interpreting time-frequency plots.", "problem": "An engineer is analyzing a discrete-time signal $x[n]$ to identify its constituent frequencies over time. To do this, they compute a spectrogram using the Short-Time Fourier Transform (STFT). The process involves the following steps:\n\n1.  The signal $x[n]$ is segmented into overlapping blocks.\n2.  Each block is multiplied by a window function $w[n]$ of length $L=256$ samples.\n3.  The Discrete Fourier Transform (DFT) of each windowed segment is computed.\n4.  The squared magnitude of the DFT results are plotted as an intensity map (spectrogram).\n\nInitially, the engineer chooses the DFT size, $N$, to be equal to the window length, so $N=L=256$. Let's call the resulting spectrogram *Spectrogram A*.\n\nAfter observing the result, the engineer decides to modify the analysis. They keep the window length $L=256$ but change the DFT size to $N=1024$. This is achieved by taking each 256-sample windowed segment and appending $1024 - 256 = 768$ zeros to it before computing the 1024-point DFT. This new procedure results in *Spectrogram B*.\n\nWhich of the following statements most accurately describes the primary qualitative difference observed when comparing Spectrogram B to Spectrogram A?\n\nA. Spectrogram B will have a significantly higher temporal resolution.\n\nB. Spectrogram B will have a significantly higher true frequency resolution, allowing the engineer to distinguish between sinusoids that are much closer in frequency.\n\nC. Spectrogram B will exhibit much greater spectral leakage from strong frequency components into adjacent frequency bins.\n\nD. The frequency content in Spectrogram B will appear interpolated and smoother, making it easier to estimate the precise frequency of the spectral peaks.\n\nE. The signal-to-noise ratio of Spectrogram B will be lower than that of Spectrogram A.", "solution": "We analyze how changing only the DFT size from $N=L$ to $N> L$ (with zero padding) affects the STFT spectrogram while keeping the window $w[n]$ and its length $L$ fixed.\n\nDefine the windowed segment at time index $m$ as $y_{m}[n]=x[n]w[n-m]$, with effective nonzero support of length $L$. The continuous-frequency DTFT of $y_{m}[n]$ is\n$$\nY_{m}(\\omega)=\\sum_{n=0}^{L-1}y_{m}[n]\\exp(-\\mathrm{j}\\omega n).\n$$\nThe $N$-point DFT samples $Y_{m}(\\omega)$ on the grid $\\omega_{k}=2\\pi k/N$:\n$$\nX_{m}[k]=\\sum_{n=0}^{N-1}\\tilde{y}_{m}[n]\\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi k}{N}n\\right),\n$$\nwhere $\\tilde{y}_{m}[n]=y_{m}[n]$ for $0\\leq n\\leq L-1$ and $\\tilde{y}_{m}[n]=0$ for $L\\leq n\\leq N-1$ (zero padding when $N>L$). Thus $X_{m}[k]=Y_{m}(\\omega_{k})$; changing $N$ only changes the sampling density of $Y_{m}(\\omega)$:\n$$\n\\Delta \\omega=\\frac{2\\pi}{N},\\qquad \\Delta f=\\frac{f_{s}}{N}.\n$$\n\nTrue frequency resolution is governed by the window’s effective duration, not by $N$. The magnitude $|Y_{m}(\\omega)|$ is the convolution in frequency of the underlying spectral lines with the window spectrum $W(\\omega)$, whose mainlobe width scales on the order of $1/L$ (with constants depending on the window shape). Therefore, the Rayleigh limit and the ability to resolve two closely spaced sinusoids are determined by $L$ and $w[n]$, not by $N$. Zero padding (increasing $N$) refines the frequency sampling grid but does not narrow the mainlobe of $|W(\\omega)|$, so it does not provide significantly higher true frequency resolution.\n\nTemporal resolution is set by the window length $L$ (and hop size), both unchanged; therefore it is not improved by increasing $N$. Spectral leakage is determined by $w[n]$ and the alignment of sinusoids with the frequency grid; zero padding does not increase leakage energy, it merely samples the same leakage pattern more densely. Signal-to-noise ratio is not degraded by zero padding because no additional noise is introduced and the underlying energy distribution is unchanged.\n\nConsequently, when $N$ is increased with $L$ fixed, the spectrogram’s frequency axis becomes more finely sampled; the displayed magnitude $|X_{m}[k]|^{2}$ appears smoother and more interpolated between the coarser-bin values, which aids in visually locating and estimating peak frequencies without changing the fundamental resolution or leakage properties.\n\nTherefore, the most accurate description is that the frequency content will look interpolated and smoother, facilitating precise peak estimation.\n\nOptions assessment:\n- A: False; temporal resolution unchanged.\n- B: False; true frequency resolution set by $L$ and $w[n]$, not by $N$.\n- C: False; leakage is a window property; zero padding does not increase it.\n- D: True; denser sampling makes spectra appear smoother and interpolated.\n- E: False; SNR is not reduced by zero padding.\n\nHence, the correct choice is D.", "answer": "$$\\boxed{D}$$", "id": "1730843"}, {"introduction": "Time-frequency analysis is not just for tracking gradual changes in frequency; its real strength lies in capturing and characterizing abrupt, transient events within a signal. This exercise [@problem_id:1730835] presents a seemingly simple signal—a sinusoid that instantaneously flips its phase—to demonstrate a profound capability of the Short-Time Fourier Transform (STFT). By analyzing the STFT at the exact moment of the phase jump, you will discover how even events with no change in frequency produce a distinct and predictable signature in the time-frequency domain, revealing the deep connection between a signal's time-domain behavior and its representation in the STFT.", "problem": "In digital communication systems, phase modulation is a common technique. Consider a simplified model of a carrier signal that undergoes an abrupt phase change. The signal is a complex exponential given by $x(t)$ with a constant angular frequency $\\omega_0 > 0$. At time $t=0$, the phase of the signal instantaneously jumps by $\\pi$ radians. For $t<0$, the signal is $x(t) = \\exp(j\\omega_0 t)$, and for $t \\ge 0$, it is $x(t) = \\exp(j(\\omega_0 t + \\pi))$.\n\nThe time-frequency characteristics of this signal are analyzed using the Short-Time Fourier Transform (STFT), defined with respect to a window function $w(t)$. The STFT of $x(t)$ is given by:\n$$X(\\tau, \\omega) = \\int_{-\\infty}^{\\infty} x(t) w(t-\\tau) e^{-j\\omega t} dt$$\nAssume the window function $w(t)$ is a real-valued, continuous, and symmetric (even) function, i.e., $w(t) = w(-t)$, and that it is non-zero over some finite or infinite interval centered at $t=0$.\n\nWhich of the following statements correctly describes the magnitude of the STFT, $|X(\\tau, \\omega)|$, precisely at the time of the phase jump ($\\tau=0$) and at the original carrier frequency ($\\omega=\\omega_0$)?\n\nA. $|X(0, \\omega_0)|$ is non-zero and has a local maximum compared to nearby frequencies.\n\nB. $|X(0, \\omega_0)| = 0$.\n\nC. $|X(0, \\omega_0)|$ is non-zero and equal to half its value far from the jump (i.e., for large $|\\tau|$).\n\nD. The STFT is undefined at $(\\tau, \\omega) = (0, \\omega_0)$ due to the signal's discontinuity.\n\nE. The value of $|X(0, \\omega_0)|$ depends on the specific shape of the window function $w(t)$ and cannot be determined in general.", "solution": "The problem asks for the value of the Short-Time Fourier Transform (STFT) magnitude, $|X(0, \\omega_0)|$, for a specific signal with a phase jump.\n\nFirst, let's write out the signal $x(t)$ more explicitly.\nFor $t < 0$, we have $x(t) = \\exp(j\\omega_0 t)$.\nFor $t \\ge 0$, we have $x(t) = \\exp(j(\\omega_0 t + \\pi))$. Using Euler's identity, $\\exp(j\\pi) = \\cos(\\pi) + j\\sin(\\pi) = -1$.\nSo, for $t \\ge 0$, $x(t) = \\exp(j\\omega_0 t) \\exp(j\\pi) = -\\exp(j\\omega_0 t)$.\n\nWe can combine these two cases using the signum function, $\\text{sgn}(t)$, which is $-1$ for $t<0$ and $+1$ for $t>0$. The value at $t=0$ is usually defined as 0, but since it's a single point, it doesn't affect the integral.\nOur signal can be written as $x(t) = -\\text{sgn}(t) \\exp(j\\omega_0 t)$ for all $t \\ne 0$.\n\nThe STFT is defined as:\n$$X(\\tau, \\omega) = \\int_{-\\infty}^{\\infty} x(t) w(t-\\tau) e^{-j\\omega t} dt$$\n\nWe need to evaluate this at $\\tau=0$ and $\\omega=\\omega_0$.\n$$X(0, \\omega_0) = \\int_{-\\infty}^{\\infty} x(t) w(t-0) e^{-j\\omega_0 t} dt$$\n$$X(0, \\omega_0) = \\int_{-\\infty}^{\\infty} x(t) w(t) e^{-j\\omega_0 t} dt$$\n\nNow, substitute the expression for $x(t)$:\n$$X(0, \\omega_0) = \\int_{-\\infty}^{\\infty} [-\\text{sgn}(t) \\exp(j\\omega_0 t)] w(t) e^{-j\\omega_0 t} dt$$\n\nThe exponential terms cancel out: $\\exp(j\\omega_0 t) e^{-j\\omega_0 t} = \\exp(0) = 1$.\n$$X(0, \\omega_0) = \\int_{-\\infty}^{\\infty} [-\\text{sgn}(t)] w(t) dt$$\n$$X(0, \\omega_0) = - \\int_{-\\infty}^{\\infty} \\text{sgn}(t) w(t) dt$$\n\nLet's analyze the integrand, $f(t) = \\text{sgn}(t) w(t)$.\nThe problem states that the window function $w(t)$ is symmetric, which means it is an even function: $w(t) = w(-t)$.\nThe signum function, $\\text{sgn}(t)$, is an odd function: $\\text{sgn}(t) = -\\text{sgn}(-t)$.\nThe product of an odd function and an even function is an odd function:\n$$f(-t) = \\text{sgn}(-t) w(-t) = [-\\text{sgn}(t)] [w(t)] = -[\\text{sgn}(t) w(t)] = -f(t)$$\nSo, the integrand $f(t) = \\text{sgn}(t) w(t)$ is an odd function.\n\nThe integral of any odd function over a symmetric interval from $-\\infty$ to $\\infty$ is zero. This can be shown by splitting the integral:\n$$\\int_{-\\infty}^{\\infty} f(t) dt = \\int_{-\\infty}^{0} f(t) dt + \\int_{0}^{\\infty} f(t) dt$$\nIn the first integral, let $u = -t$, so $du = -dt$. When $t \\to -\\infty$, $u \\to \\infty$. When $t=0$, $u=0$.\n$$\\int_{-\\infty}^{0} f(t) dt = \\int_{\\infty}^{0} f(-u) (-du) = \\int_{0}^{\\infty} f(-u) du$$\nSince $f$ is an odd function, $f(-u) = -f(u)$.\n$$\\int_{0}^{\\infty} f(-u) du = \\int_{0}^{\\infty} -f(u) du = - \\int_{0}^{\\infty} f(u) du$$\nSubstituting this back into the full integral:\n$$\\int_{-\\infty}^{\\infty} f(t) dt = \\left( - \\int_{0}^{\\infty} f(t) dt \\right) + \\left( \\int_{0}^{\\infty} f(t) dt \\right) = 0$$\n\nTherefore, the integral we need to evaluate is zero:\n$$X(0, \\omega_0) = - \\int_{-\\infty}^{\\infty} \\text{sgn}(t) w(t) dt = 0$$\n\nThe magnitude is consequently also zero: $|X(0, \\omega_0)| = 0$.\n\nThis result holds for any real, continuous, and symmetric window function $w(t)$ for which the integral converges. Therefore, the value is not dependent on the window's specific shape (rejecting E), it is well-defined (rejecting D), and it is not non-zero (rejecting A and C). The correct conclusion is that the magnitude is exactly zero. This phenomenon occurs because the phase opposition of the signal on either side of the analysis window's center, combined with the window's symmetry, creates perfect cancellation at the carrier frequency.", "answer": "$$\\boxed{B}$$", "id": "1730835"}]}