{"hands_on_practices": [{"introduction": "The foundation of a Quadrature Mirror Filter (QMF) bank lies in the specific mathematical relationships between its four component filters. This exercise explores the fundamental construction of a QMF bank, where the analysis and synthesis filters are derived from a single prototype low-pass filter through modulation and time-reversal. Mastering this direct application of the QMF definitions is the essential first step toward understanding how these systems achieve aliasing cancellation and signal reconstruction [@problem_id:1746359].", "problem": "In the design of a two-channel Quadrature Mirror Filter (QMF) bank, the four filters involved are the low-pass analysis filter ($h_0[n]$), the high-pass analysis filter ($h_1[n]$), the low-pass synthesis filter ($g_0[n]$), and the high-pass synthesis filter ($g_1[n]$). For alias cancellation, these filters are typically related by the following conditions:\n1. The high-pass analysis filter is a modulated version of the low-pass analysis filter: $h_1[n] = (-1)^n h_0[n]$.\n2. The synthesis filters are time-reversed versions of their corresponding analysis filters: $g_0[n] = h_0[-n]$ and $g_1[n] = h_1[-n]$.\n\nSuppose an engineer selects a simple Finite Impulse Response (FIR) filter for the low-pass analysis stage, with an impulse response given by:\n$$h_0[n] = \\delta[n] + \\delta[n-1]$$\nwhere $\\delta[n]$ is the Kronecker delta function.\n\nDetermine the impulse response $g_1[n]$ of the corresponding high-pass synthesis filter. Express your answer in terms of Kronecker delta functions.", "solution": "The problem requires us to find the impulse response of the high-pass synthesis filter, $g_1[n]$, starting from the impulse response of the low-pass analysis filter, $h_0[n]$. We will use the relationships provided in the problem statement in a two-step process.\n\nFirst, we determine the impulse response of the high-pass analysis filter, $h_1[n]$, from the low-pass analysis filter, $h_0[n]$. The relationship is given as:\n$$h_1[n] = (-1)^n h_0[n]$$\nWe are given $h_0[n] = \\delta[n] + \\delta[n-1]$. Substituting this into the equation for $h_1[n]$ yields:\n$$h_1[n] = (-1)^n (\\delta[n] + \\delta[n-1])$$\nWe can distribute the modulation term $(-1)^n$ to both terms inside the parenthesis:\n$$h_1[n] = (-1)^n \\delta[n] + (-1)^n \\delta[n-1]$$\nTo simplify this expression, we use the sifting property of the Kronecker delta function, which states that for any function $f[n]$, we have $f[n]\\delta[n-k] = f[k]\\delta[n-k]$.\nFor the first term, $(-1)^n \\delta[n]$, the delta function is non-zero only at $n=0$. We evaluate $(-1)^n$ at $n=0$:\n$$(-1)^n \\delta[n] = (-1)^0 \\delta[n] = 1 \\cdot \\delta[n] = \\delta[n]$$\nFor the second term, $(-1)^n \\delta[n-1]$, the delta function is non-zero only at $n=1$. We evaluate $(-1)^n$ at $n=1$:\n$$(-1)^n \\delta[n-1] = (-1)^1 \\delta[n-1] = -1 \\cdot \\delta[n-1] = -\\delta[n-1]$$\nCombining these results, the impulse response of the high-pass analysis filter is:\n$$h_1[n] = \\delta[n] - \\delta[n-1]$$\n\nSecond, we determine the impulse response of the high-pass synthesis filter, $g_1[n]$, from the high-pass analysis filter, $h_1[n]$. The relationship for this is given as:\n$$g_1[n] = h_1[-n]$$\nThis operation corresponds to time-reversing the impulse response $h_1[n]$. To perform this, we substitute $-n$ for every instance of $n$ in the expression we just derived for $h_1[n]$:\n$$g_1[n] = \\delta[-n] - \\delta[-n-1]$$\nFinally, we simplify this expression using standard properties of the Kronecker delta function. The delta function is an even function, which means $\\delta[-k] = \\delta[k]$ for any integer $k$.\nApplying this property to the first term gives:\n$$\\delta[-n] = \\delta[n]$$\nFor the second term, we can factor out the negative sign inside the argument of the delta function:\n$$\\delta[-n-1] = \\delta[-(n+1)]$$\nUsing the even property again on this term, we have $\\delta[-(n+1)] = \\delta[n+1]$.\nSubstituting these simplified forms back into the expression for $g_1[n]$, we obtain the final answer:\n$$g_1[n] = \\delta[n] - \\delta[n+1]$$", "answer": "$$\\boxed{\\delta[n] - \\delta[n+1]}$$", "id": "1746359"}, {"introduction": "To truly appreciate how a filter bank functions, it is instructive to analyze what happens when key components are altered or removed. This practice problem challenges you to derive the input-output relationship for a system with a standard QMF analysis stage but a simplified synthesis stage that lacks filters. By working through the z-domain behavior of the downsampling and upsampling operations from first principles, you will gain a deeper intuition for how aliasing artifacts are created and why synthesis filters are ultimately necessary for signal restoration [@problem_id:1746364].", "problem": "Consider a two-channel digital signal processing system. The analysis stage of this system is a standard two-channel Quadrature Mirror Filter (QMF) bank. An input signal $x[n]$, with z-transform $X(z)$, is split into two paths. In the upper path, the signal is filtered by a low-pass filter with transfer function $H_0(z)$ and then downsampled by a factor of 2 to produce the signal $v_0[n]$. In the lower path, the signal is filtered by a high-pass filter with transfer function $H_1(z)$ and then downsampled by a factor of 2 to produce the signal $v_1[n]$. The crucial property of the QMF bank is that the analysis filters are related by $H_1(z) = H_0(-z)$.\n\nThe synthesis stage of this particular system is modified from a standard QMF bank. The signals $v_0[n]$ and $v_1[n]$ are each upsampled by a factor of 2 to produce signals $u_0[n]$ and $u_1[n]$, respectively. The final output signal, $y[n]$, is then formed by simply summing these two upsampled signals: $y[n] = u_0[n] + u_1[n]$. Note that, unlike a standard synthesis bank, no synthesis filters are used.\n\nDetermine an expression for the z-transform of the output signal, $Y(z)$, in terms of the z-transform of the input signal, $X(z)$, and the z-transform of the low-pass analysis filter, $H_0(z)$.", "solution": "The problem asks for the z-transform of the output, $Y(z)$, of a modified two-channel filter bank in terms of the input's z-transform, $X(z)$, and the analysis filter's transfer function, $H_0(z)$. We will analyze the system step-by-step.\n\nLet's first define the z-transform identities for downsampling and upsampling.\nIf a signal $w[n]$ is downsampled by a factor of 2 to produce $d[n] = w[2n]$, their z-transforms are related by:\n$$D(z) = \\frac{1}{2} \\left[ W(z^{1/2}) + W(-z^{1/2}) \\right]$$\nIf a signal $s[n]$ is upsampled by a factor of 2 to produce $u[n]$ (where $u[2n] = s[n]$ and $u[2n+1] = 0$), their z-transforms are related by:\n$$U(z) = S(z^2)$$\n\nNow, let's trace the signal through the system.\n\n**Step 1: Analyze the upper analysis path.**\nThe input signal $x[n]$ is first filtered by $H_0(z)$. Let the filtered signal be $x_0[n]$. Its z-transform is:\n$$X_0(z) = H_0(z)X(z)$$\nThis signal $x_0[n]$ is then downsampled by 2 to produce $v_0[n]$. Let $V_0(z)$ be the z-transform of $v_0[n]$. Using the downsampling identity:\n$$V_0(z) = \\frac{1}{2} \\left[ X_0(z^{1/2}) + X_0(-z^{1/2}) \\right]$$\nSubstituting the expression for $X_0(z)$:\n$$V_0(z) = \\frac{1}{2} \\left[ H_0(z^{1/2})X(z^{1/2}) + H_0(-z^{1/2})X(-z^{1/2}) \\right]$$\n\n**Step 2: Analyze the lower analysis path.**\nThe input signal $x[n]$ is filtered by $H_1(z)$. Let this filtered signal be $x_1[n]$. Its z-transform is $X_1(z) = H_1(z)X(z)$. Using the QMF property $H_1(z) = H_0(-z)$, we have:\n$$X_1(z) = H_0(-z)X(z)$$\nThis signal $x_1[n]$ is then downsampled by 2 to produce $v_1[n]$. Let $V_1(z)$ be the z-transform of $v_1[n]$. Using the downsampling identity again:\n$$V_1(z) = \\frac{1}{2} \\left[ X_1(z^{1/2}) + X_1(-z^{1/2}) \\right]$$\nSubstituting the expression for $X_1(z)$:\n$$V_1(z) = \\frac{1}{2} \\left[ H_0(-z^{1/2})X(z^{1/2}) + H_0(-(-z^{1/2}))X(-z^{1/2}) \\right]$$\n$$V_1(z) = \\frac{1}{2} \\left[ H_0(-z^{1/2})X(z^{1/2}) + H_0(z^{1/2})X(-z^{1/2}) \\right]$$\n\n**Step 3: Analyze the synthesis stage.**\nThe signal $v_0[n]$ is upsampled by 2 to produce $u_0[n]$. Let its z-transform be $U_0(z)$. Using the upsampling identity:\n$$U_0(z) = V_0(z^2)$$\nSubstituting the expression for $V_0(z)$ with $z \\to z^2$:\n$$U_0(z) = \\frac{1}{2} \\left[ H_0((z^2)^{1/2})X((z^2)^{1/2}) + H_0(-(z^2)^{1/2})X(-(z^2)^{1/2}) \\right]$$\n$$U_0(z) = \\frac{1}{2} \\left[ H_0(z)X(z) + H_0(-z)X(-z) \\right]$$\n\nSimilarly, the signal $v_1[n]$ is upsampled by 2 to produce $u_1[n]$. Let its z-transform be $U_1(z)$.\n$$U_1(z) = V_1(z^2)$$\nSubstituting the expression for $V_1(z)$ with $z \\to z^2$:\n$$U_1(z) = \\frac{1}{2} \\left[ H_0(-(z^2)^{1/2})X((z^2)^{1/2}) + H_0((z^2)^{1/2})X(-(z^2)^{1/2}) \\right]$$\n$$U_1(z) = \\frac{1}{2} \\left[ H_0(-z)X(z) + H_0(z)X(-z) \\right]$$\n\n**Step 4: Combine the paths to find the final output.**\nThe final output is $y[n] = u_0[n] + u_1[n]$. In the z-domain, this corresponds to $Y(z) = U_0(z) + U_1(z)$.\n$$Y(z) = \\frac{1}{2} \\left[ H_0(z)X(z) + H_0(-z)X(-z) \\right] + \\frac{1}{2} \\left[ H_0(-z)X(z) + H_0(z)X(-z) \\right]$$\nNow, we group the terms with $X(z)$ and the terms with $X(-z)$:\n$$Y(z) = \\frac{1}{2} \\left[ H_0(z)X(z) + H_0(-z)X(z) \\right] + \\frac{1}{2} \\left[ H_0(-z)X(-z) + H_0(z)X(-z) \\right]$$\nFactor out $X(z)$ from the first group and $X(-z)$ from the second group:\n$$Y(z) = \\frac{1}{2} \\left[ H_0(z) + H_0(-z) \\right] X(z) + \\frac{1}{2} \\left[ H_0(-z) + H_0(z) \\right] X(-z)$$\nFinally, factor out the common term $[H_0(z) + H_0(-z)]$:\n$$Y(z) = \\frac{1}{2} \\left[ H_0(z) + H_0(-z) \\right] \\left[ X(z) + X(-z) \\right]$$\nThis is the final expression for the output $Y(z)$.", "answer": "$$\\boxed{\\frac{1}{2} \\left[ H_0(z) + H_0(-z) \\right] \\left[ X(z) + X(-z) \\right]}$$", "id": "1746364"}, {"introduction": "Moving from theoretical analysis to practical design is a crucial step in engineering. While it's important to understand how a given QMF system behaves, it's even more powerful to design a system that meets a specific performance goal, such as perfect reconstruction. This design exercise tasks you with determining the precise numerical coefficients for a prototype filter that satisfies the mathematical conditions for perfect reconstruction, ensuring the output is a perfectly delayed version of the input [@problem_id:1746348].", "problem": "A two-channel Quadrature Mirror Filter (QMF) bank is a common structure in digital signal processing for splitting a signal into sub-bands. The bank consists of an analysis section, with a low-pass filter $H_0(z)$ and a high-pass filter $H_1(z)$, and a synthesis section, with filters $G_0(z)$ and $G_1(z)$.\n\nFor this problem, consider a standard QMF design where all filters are defined in terms of a single prototype low-pass Finite Impulse Response (FIR) filter, $H_0(z)$, as follows:\n- Analysis high-pass filter: $H_1(z) = H_0(-z)$\n- Synthesis low-pass filter: $G_0(z) = H_0(z)$\n- Synthesis high-pass filter: $G_1(z) = -H_0(-z)$\n\nWith these choices, aliasing is perfectly cancelled, and the overall transfer function of the system, $T(z)$, which relates the reconstructed output $\\hat{X}(z)$ to the input $X(z)$ by $\\hat{X}(z) = T(z)X(z)$, is given by:\n$$T(z) = \\frac{1}{2}\\left[H_0(z)^2 - H_0(-z)^2\\right]$$\n\nYour task is to design the prototype filter $H_0(z)$. The filter is specified as a 4-tap FIR filter, $$H_0(z) = b_0 + b_1 z^{-1} + b_2 z^{-2} + b_3 z^{-3}$$\nAdditionally, the filter must have generalized linear phase, which for its length imposes the symmetry condition on its coefficients: $b_k = b_{3-k}$ for $k \\in \\{0, 1, 2, 3\\}$.\n\nThe design objective is for the overall system to achieve a perfect reconstruction of the input signal, but with a delay of 3 samples. This means the overall transfer function must be $T(z) = z^{-3}$.\n\nDetermine the numerical values of the four filter coefficients $b_0, b_1, b_2, b_3$. While multiple solutions may exist, provide the specific solution for which the coefficient $b_0$ is positive. Present your final answer as the set of coefficients $(b_0, b_1, b_2, b_3)$, with each value rounded to three significant figures.", "solution": "The problem requires us to find the coefficients of a 4-tap linear-phase FIR filter $H_0(z)$ for a QMF bank such that the overall system transfer function is $T(z) = z^{-3}$.\n\nFirst, we write down the form of the filter $H_0(z)$ incorporating the linear phase constraint. The filter is given as $H_0(z) = b_0 + b_1 z^{-1} + b_2 z^{-2} + b_3 z^{-3}$. The linear phase symmetry condition is $b_k = b_{3-k}$. This implies:\nFor $k=0$, $b_0 = b_3$.\nFor $k=1$, $b_1 = b_2$.\nSo, the filter transfer function can be written in terms of two unknown coefficients, $b_0$ and $b_1$:\n$$H_0(z) = b_0 + b_1 z^{-1} + b_1 z^{-2} + b_0 z^{-3}$$\n\nNext, we evaluate the overall system transfer function $T(z) = \\frac{1}{2}\\left[H_0(z)^2 - H_0(-z)^2\\right]$. To do this, we first find $H_0(-z)$:\n$$H_0(-z) = b_0 + b_1 (-z)^{-1} + b_1 (-z)^{-2} + b_0 (-z)^{-3}$$\n$$H_0(-z) = b_0 - b_1 z^{-1} + b_1 z^{-2} - b_0 z^{-3}$$\n\nTo simplify the calculation of $H_0(z)^2 - H_0(-z)^2$, we can use the polyphase representation. A filter's transfer function $H(z)$ can be decomposed into its even-indexed and odd-indexed coefficient parts, $H(z) = P_0(z^2) + z^{-1}P_1(z^2)$.\nFor our $H_0(z)$:\nThe even-indexed coefficients are $b_0$ and $b_1$ (at positions $n=0$ and $n=2$). So, $P_0(z^2) = b_0 + b_1 z^{-2}$.\nThe odd-indexed coefficients are $b_1$ and $b_0$ (at positions $n=1$ and $n=3$). So, $P_1(z^2) = b_1 + b_0 z^{-2}$.\n\nThus, $H_0(z) = (b_0 + b_1 z^{-2}) + z^{-1}(b_1 + b_0 z^{-2})$.\nAnd $H_0(-z) = (b_0 + b_1 z^{-2}) - z^{-1}(b_1 + b_0 z^{-2})$.\n\nNow we can calculate $T(z)$:\n$$T(z) = \\frac{1}{2} \\left[ \\left( P_0(z^2) + z^{-1}P_1(z^2) \\right)^2 - \\left( P_0(z^2) - z^{-1}P_1(z^2) \\right)^2 \\right]$$\nExpanding the squares:\n$$T(z) = \\frac{1}{2} \\left[ (P_0^2 + 2z^{-1}P_0P_1 + z^{-2}P_1^2) - (P_0^2 - 2z^{-1}P_0P_1 + z^{-2}P_1^2) \\right]$$\n$$T(z) = \\frac{1}{2} \\left[ 4z^{-1}P_0(z^2)P_1(z^2) \\right] = 2z^{-1}P_0(z^2)P_1(z^2)$$\n\nNow, we substitute the expressions for $P_0(z^2)$ and $P_1(z^2)$:\n$$T(z) = 2z^{-1}(b_0 + b_1 z^{-2})(b_1 + b_0 z^{-2})$$\nExpanding the product:\n$$T(z) = 2z^{-1}(b_0b_1 + b_0^2 z^{-2} + b_1^2 z^{-2} + b_0b_1 z^{-4})$$\n$$T(z) = 2z^{-1}(b_0b_1 + (b_0^2 + b_1^2)z^{-2} + b_0b_1 z^{-4})$$\nDistributing the $2z^{-1}$ term:\n$$T(z) = 2b_0b_1 z^{-1} + 2(b_0^2 + b_1^2)z^{-3} + 2b_0b_1 z^{-5}$$\n\nWe are given that the desired transfer function is $T(z) = z^{-3}$. We can equate the coefficients of the powers of $z^{-1}$ in both expressions for $T(z)$.\n$$2b_0b_1 z^{-1} + 2(b_0^2 + b_1^2)z^{-3} + 2b_0b_1 z^{-5} = 0 \\cdot z^{-1} + 1 \\cdot z^{-3} + 0 \\cdot z^{-5}$$\nThis gives us a system of equations:\n1. Coefficient of $z^{-1}$: $2b_0b_1 = 0$\n2. Coefficient of $z^{-3}$: $2(b_0^2 + b_1^2) = 1$\n3. Coefficient of $z^{-5}$: $2b_0b_1 = 0$ (This is redundant)\n\nFrom equation (1), we must have either $b_0 = 0$ or $b_1 = 0$.\n\nCase 1: $b_0 = 0$.\nSubstituting this into equation (2):\n$2(0^2 + b_1^2) = 1 \\implies 2b_1^2 = 1 \\implies b_1^2 = \\frac{1}{2} \\implies b_1 = \\pm\\frac{1}{\\sqrt{2}}$.\n\nCase 2: $b_1 = 0$.\nSubstituting this into equation (2):\n$2(b_0^2 + 0^2) = 1 \\implies 2b_0^2 = 1 \\implies b_0^2 = \\frac{1}{2} \\implies b_0 = \\pm\\frac{1}{\\sqrt{2}}$.\n\nThe problem asks for the solution where $b_0$ is positive. This corresponds to Case 2 with the positive root.\nSo, we have:\n$b_0 = +\\frac{1}{\\sqrt{2}}$\n$b_1 = 0$\n\nNow we find all four coefficients using the symmetry conditions $b_2=b_1$ and $b_3=b_0$:\n$b_0 = \\frac{1}{\\sqrt{2}}$\n$b_1 = 0$\n$b_2 = 0$\n$b_3 = \\frac{1}{\\sqrt{2}}$\n\nThe final step is to find the numerical values rounded to three significant figures.\n$b_0 = b_3 = \\frac{1}{\\sqrt{2}} \\approx 0.70710678...$\nRounding to three significant figures gives $0.707$.\nThe other coefficients are exactly zero.\n\nThe required set of coefficients is $(b_0, b_1, b_2, b_3) = (0.707, 0, 0, 0.707)$.", "answer": "$$\\boxed{\\begin{pmatrix} 0.707 & 0 & 0 & 0.707 \\end{pmatrix}}$$", "id": "1746348"}]}