{"hands_on_practices": [{"introduction": "A core motivation for using multirate systems is to improve computational efficiency. This practice explores a fundamental technique where we move a filtering operation to after a downsampler, allowing the filter to run at a much lower rate. This exercise [@problem_id:1737879] demonstrates a direct application of the first Noble Identity, which provides the precise mathematical rule, $H(z) = G(z^M)$, for finding the original high-rate filter $H(z)$ that is equivalent to a more efficient low-rate filter $G(z)$.", "problem": "In digital signal processing, performing operations at a high sampling rate can be computationally expensive. A common strategy to improve efficiency is to rearrange operations. Consider a system where a discrete-time signal is first passed through a digital filter with a transfer function $H(z)$ and then downsampled by a factor of $M=4$. This process is known as decimation.\n\nTo reduce the computational load, an engineer proposes an alternative system that is functionally equivalent. In this new system, the same input signal is first downsampled by a factor of $M=4$, and the resulting lower-rate signal is then filtered by a much simpler filter with a transfer function given by $G(z) = 1 + z^{-1}$.\n\nAssuming the two systems produce identical output signals for any given input signal, determine the transfer function $H(z)$ of the filter in the original, computationally expensive configuration.", "solution": "Let the input signal be $x[n]$ and the final output signal be $y[n]$. We are given two equivalent systems that produce the same output $y[n]$ from the same input $x[n]$.\n\nSystem 1: A filter with transfer function $H(z)$ is followed by a decimator (downsampler) by a factor of $M=4$.\nThe signal after the filter $H(z)$ is $w[n]$, with its Z-transform being $W(z) = H(z)X(z)$.\nThe decimator then produces the output $y[n] = w[4n]$. The Z-transform of the output is given by\n$$Y(z) = \\frac{1}{4} \\sum_{k=0}^{3} W\\left(z^{1/4} \\exp\\left(-j\\frac{2\\pi k}{4}\\right)\\right) = \\frac{1}{4} \\sum_{k=0}^{3} H\\left(z^{1/4} e^{-j\\pi k/2}\\right) X\\left(z^{1/4} e^{-j\\pi k/2}\\right)$$\n\nSystem 2: A decimator by a factor of $M=4$ is followed by a filter with transfer function $G(z)$.\nThe signal after the decimator is $v[n] = x[4n]$. Its Z-transform is $V(z)$.\nThis signal is then filtered by $G(z)$. The Z-transform of the final output is $Y(z) = G(z)V(z)$.\nThe Z-transform of the downsampled signal $v[n]$ is related to the Z-transform of the original signal $x[n]$ by\n$$V(z) = \\frac{1}{4} \\sum_{k=0}^{3} X\\left(z^{1/4} \\exp\\left(-j\\frac{2\\pi k}{4}\\right)\\right) = \\frac{1}{4} \\sum_{k=0}^{3} X\\left(z^{1/4} e^{-j\\pi k/2}\\right)$$\nSo, the output of System 2 is\n$$Y(z) = G(z) \\left( \\frac{1}{4} \\sum_{k=0}^{3} X\\left(z^{1/4} e^{-j\\pi k/2}\\right) \\right)$$\n\nFor the two systems to be equivalent, their outputs must be identical. This problem is a direct application of the first Noble Identity for multirate systems. This identity states that a filter $H(z)$ followed by a downsampler by $M$ is equivalent to a downsampler by $M$ followed by a filter $G(z)$ if and only if $H(z)$ is an $M$-th band filter, meaning its transfer function can be expressed as $H(z) = G(z^M)$.\n\nIn this problem, we have:\nThe downsampling factor $M = 4$.\nThe transfer function of the filter in the efficient system is $G(z) = 1 + z^{-1}$.\nThe transfer function of the filter in the original system is $H(z)$.\n\nAccording to the first Noble Identity, the relationship between the two filter transfer functions is:\n$$H(z) = G(z^M)$$\n\nSubstituting the given values of $M=4$ into this relationship, we get:\n$$H(z) = G(z^4)$$\n\nNow, we find $G(z^4)$ by replacing every occurrence of $z$ in the expression for $G(z)$ with $z^4$.\nGiven $G(z) = 1 + z^{-1}$, we have:\n$$G(z^4) = 1 + (z^4)^{-1}$$\n$$G(z^4) = 1 + z^{-4}$$\n\nTherefore, the transfer function of the filter in the original system is:\n$$H(z) = 1 + z^{-4}$$", "answer": "$$\\boxed{1 + z^{-4}}$$", "id": "1737879"}, {"introduction": "While the Noble Identities provide elegant relationships in the Z-domain, it is essential to see how these principles manifest at the implementation level. This exercise [@problem_id:1737888] moves from the abstract transfer function to the concrete time-domain difference equation. By deriving the input-output relationship for a system with a decimator followed by a filter, you will build a tangible connection between the theoretical block diagram and the sample-by-sample processing that a digital signal processor would execute.", "problem": "In digital signal processing, multirate systems are often optimized for computational efficiency using properties known as the noble identities. These identities allow for the reordering of operations like filtering and sample rate conversion.\n\nConsider the following scenario. A causal Linear Time-Invariant (LTI) system is designed to process an input signal $x[n]$. The process involves two stages:\n1.  The input signal $x[n]$ is first downsampled by an integer factor $M=3$ to produce an intermediate signal $v[n] = x[3n]$.\n2.  The intermediate signal $v[n]$ is then filtered by a causal LTI filter with a transfer function $H(z) = \\frac{1 + \\beta z^{-1}}{1 - \\alpha z^{-1}}$ to produce the final output signal $y[n]$.\n\nAn engineer knows that an equivalent system can be constructed by swapping the order of operations, i.e., by filtering the original signal $x[n]$ first and then downsampling. A noble identity dictates that to maintain equivalence, the filter's transfer function must be modified from $H(z)$ to $G(z) = H(z^M)$.\n\nGiven that both system configurations produce the exact same output $y[n]$ for any given input $x[n]$, your task is to determine the definitive input-output difference equation for this process. The parameters for the filter are given as $\\alpha = 0.8$ and $\\beta = -0.25$.\n\nFind the coefficients $A_1, B_0, B_3$ for the difference equation expressed in the standard form:\n$$y[n] = A_1 y[n-1] + B_0 x[3n] + B_3 x[3n-3]$$\n\nPresent your final answer as a row matrix containing the three numerical coefficients in the order $(A_1, B_0, B_3)$.", "solution": "Let the decimator output be $v[n]=x[3n]$. The given causal LTI filter has transfer function\n$$\nH(z)=\\frac{1+\\beta z^{-1}}{1-\\alpha z^{-1}},\n$$\nso with input $v[n]$ and output $y[n]$,\n$$\n\\frac{Y(z)}{V(z)}=\\frac{1+\\beta z^{-1}}{1-\\alpha z^{-1}} \\;\\;\\Rightarrow\\;\\; (1-\\alpha z^{-1})Y(z)=(1+\\beta z^{-1})V(z).\n$$\nTaking the inverse $z$-transform gives the time-domain difference equation\n$$\ny[n]-\\alpha y[n-1]=v[n]+\\beta v[n-1].\n$$\nSubstituting $v[n]=x[3n]$ and $v[n-1]=x[3(n-1)]=x[3n-3]$ yields\n$$\ny[n]=\\alpha y[n-1]+x[3n]+\\beta x[3n-3].\n$$\nComparing with the requested form $y[n]=A_{1}y[n-1]+B_{0}x[3n]+B_{3}x[3n-3]$ gives\n$$\nA_{1}=\\alpha,\\quad B_{0}=1,\\quad B_{3}=\\beta.\n$$\nWith the specified parameters $\\alpha=0.8$ and $\\beta=-0.25$, the coefficients are\n$$\nA_{1}=0.8,\\quad B_{0}=1,\\quad B_{3}=-0.25.\n$$\nThis result is consistent with the noble identity: filtering by $G(z)=H(z^{3})=\\frac{1+\\beta z^{-3}}{1-\\alpha z^{-3}}$ before downsampling by $3$ yields $w[n]-\\alpha w[n-3]=x[n]+\\beta x[n-3]$, and sampling at multiples of $3$ gives the same $y[n]$ relation above.", "answer": "$$\\boxed{\\begin{pmatrix}0.8 & 1 & -0.25\\end{pmatrix}}$$", "id": "1737888"}, {"introduction": "Building on the principles of decimation, this advanced practice delves into a realistic engineering challenge: designing a filter for a system where the signal of interest has been aliased. Downsampling changes a signal's frequency content in a predictable way, and this exercise [@problem_id:1737892] requires you to calculate the new, aliased frequency of an interfering tone. This task highlights the practical implications of multirate theory, moving beyond simple system equivalence to active design in the presence of aliasing effects.", "problem": "In modern software-defined radio systems, it is often necessary to remove strong, narrow-band interference. To minimize computational load, signal processing is frequently performed at the lowest possible sample rate.\n\nConsider a discrete-time signal that is contaminated by a powerful sinusoidal interference. The normalized angular frequency of this interference is known to be $\\omega_0 = \\frac{3\\pi}{8}$ radians/sample. To remove this interference, the signal is first passed through a decimator, which downsamples the signal by a factor of $M=5$. The resulting low-rate signal is then filtered by a stable, second-order Infinite Impulse Response (IIR) filter, $H(z)$.\n\nThis notch filter is designed to have a pair of complex-conjugate zeros on the unit circle, located at $z_{1,2} = e^{\\pm j\\theta_z}$, which are responsible for nullifying the interference. The filter's poles are located at $p_{1,2} = r e^{\\pm j\\theta_z}$ with a radius of $r=0.95$ to ensure stability while creating a sharp notch.\n\nYour task is to determine the fundamental positive angle $\\theta_z$ that defines the positions of the filter's zeros. Your answer should satisfy $0 < \\theta_z < \\pi$. Express your final answer in radians.", "solution": "The interference in the original discrete-time signal has normalized angular frequency $\\omega_{0} = \\frac{3\\pi}{8}$ radians/sample. After decimation by a factor $M=5$, the downsampled sequence is $y[n] = x[Mn]$. For a complex exponential component $x[n] = \\exp(j\\omega_{0} n)$, the decimated sequence becomes $y[n] = \\exp(j M \\omega_{0} n)$, which corresponds to a normalized angular frequency\n$$\n\\omega_{d} = M\\omega_{0} \\quad \\text{mod} \\; 2\\pi.\n$$\nTo place the notch of the IIR filter at the interference frequency present in the downsampled signal, we must map $\\omega_{d}$ into the principal interval $(-\\pi,\\pi]$:\n$$\n\\omega_{d} = \\left(M\\omega_{0} + 2\\pi k\\right) \\in (-\\pi,\\pi] \\quad \\text{for some} \\; k \\in \\mathbb{Z}.\n$$\nSubstituting $\\omega_{0} = \\frac{3\\pi}{8}$ and $M=5$ gives\n$$\nM\\omega_{0} = \\frac{15\\pi}{8}.\n$$\nChoosing $k=-1$ to fold into $(-\\pi,\\pi]$,\n$$\n\\omega_{d} = \\frac{15\\pi}{8} - 2\\pi = \\frac{15\\pi}{8} - \\frac{16\\pi}{8} = -\\frac{\\pi}{8}.\n$$\nThe notch filter zeros must be located at $z_{1,2} = \\exp(\\pm j\\theta_{z})$ with a positive fundamental angle $\\theta_{z}$ in $(0,\\pi)$. Since the interference in the downsampled signal appears at $\\omega_{d} = -\\frac{\\pi}{8}$, the required positive angle is the magnitude\n$$\n\\theta_{z} = |\\omega_{d}| = \\frac{\\pi}{8}.\n$$\nThis choice places the zeros at the correct conjugate angles to eliminate the aliased interference. The pole radius $r=0.95$ determines the notch sharpness but does not affect the angle $\\theta_{z}$.", "answer": "$$\\boxed{\\frac{\\pi}{8}}$$", "id": "1737892"}]}