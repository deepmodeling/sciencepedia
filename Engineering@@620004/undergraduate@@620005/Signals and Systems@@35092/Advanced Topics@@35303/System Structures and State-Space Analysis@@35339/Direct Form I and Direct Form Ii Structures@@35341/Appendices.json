{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we first examine the Direct Form I structure, a fundamental and intuitive method for implementing a digital filter. This form directly realizes the filter's governing difference equation by cascading two distinct sections: a non-recursive (feedforward) part that processes the input and a recursive (feedback) part that generates the output. This exercise [@problem_id:1714605] will guide you through deriving the system's overall transfer function, $H(z)$, from this structural description, building a solid foundation for translating mathematical filter designs into practical block diagrams.", "problem": "A causal, linear time-invariant (LTI) discrete-time filter is implemented using a Direct Form I structure. This structure is characterized by two stages of computation involving an input signal $x[n]$, an output signal $y[n]$, and an intermediate signal $v[n]$.\n\nThe first stage is a feedforward Finite Impulse Response (FIR) section. It computes the intermediate signal $v[n]$ by forming a weighted sum of the current input $x[n]$ and two previous inputs, $x[n-1]$ and $x[n-2]$. The weights for $x[n]$, $x[n-1]$, and $x[n-2]$ are $b_0$, $b_1$, and $b_2$ respectively.\n\nThe second stage is a feedback Infinite Impulse Response (IIR) section. It generates the final output $y[n]$ such that $y[n]$ plus a weighted sum of its own two previous values, $y[n-1]$ and $y[n-2]$, is equal to the intermediate signal $v[n]$. The weights for $y[n-1]$ and $y[n-2]$ are $a_1$ and $a_2$ respectively.\n\nAll coefficients $a_k$ and $b_k$ are constant real numbers. The system is assumed to be initially at rest, meaning all past inputs and outputs are zero.\n\nDetermine the transfer function $H(z) = \\frac{Y(z)}{X(z)}$ of the overall system. Express your answer as a rational function of $z$ where the numerator and denominator are polynomials in positive powers of $z$.", "solution": "The system is defined by two linear time-invariant stages with an intermediate signal. The first, feedforward FIR stage forms\n$$\nv[n] = b_{0}x[n] + b_{1}x[n-1] + b_{2}x[n-2].\n$$\nThe second, feedback IIR stage enforces\n$$\ny[n] + a_{1}y[n-1] + a_{2}y[n-2] = v[n].\n$$\nTaking the $z$-transform of both equations under the stated initial rest condition and using linearity and the time-shift property $Z\\{x[n-k]\\} = z^{-k}X(z)$ for $k \\geq 0$, the first stage becomes\n$$\nV(z) = \\left(b_{0} + b_{1}z^{-1} + b_{2}z^{-2}\\right)X(z),\n$$\nand the second stage becomes\n$$\n\\left(1 + a_{1}z^{-1} + a_{2}z^{-2}\\right)Y(z) = V(z).\n$$\nSolving the second equation for $Y(z)$ and substituting $V(z)$ from the first equation gives the transfer function\n$$\nH(z) = \\frac{Y(z)}{X(z)} = \\frac{b_{0} + b_{1}z^{-1} + b_{2}z^{-2}}{1 + a_{1}z^{-1} + a_{2}z^{-2}}.\n$$\nTo express $H(z)$ as a rational function with polynomials in positive powers of $z$, multiply numerator and denominator by $z^{2}$:\n$$\nH(z) = \\frac{b_{0}z^{2} + b_{1}z + b_{2}}{z^{2} + a_{1}z + a_{2}}.\n$$\nThis is the required form.", "answer": "$$\\boxed{\\frac{b_{0}z^{2} + b_{1}z + b_{2}}{z^{2} + a_{1}z + a_{2}}}$$", "id": "1714605"}, {"introduction": "While the Direct Form I structure is straightforward, it is not the most efficient in terms of memory requirements. This leads us to the Direct Form II structure, a popular and optimized alternative. This practice problem explores how reordering the feedforward and feedback operations allows them to share the same set of delay elements, thus minimizing memory usage without changing the filter's transfer function. By working through this exercise [@problem_id:1714613], you will analyze this more compact structure and appreciate the practical design trade-offs involved in filter implementation.", "problem": "A discrete-time, linear time-invariant (LTI) system, such as one used in a digital audio equalizer, is implemented using a computational structure known as the Direct Form II realization. This structure is efficient in terms of memory as it minimizes the number of delay elements.\n\nThe system's behavior is described by the relationship between its input sequence $x[n]$, its output sequence $y[n]$, and an internal intermediate sequence $w[n]$. The intermediate sequence $w[n]$ is generated from the input and its own past values according to the recursive difference equation:\n$$w[n] = x[n] - a_1 w[n-1] - a_2 w[n-2]$$\nThe output sequence $y[n]$ is then formed from the current and past values of this intermediate sequence according to the non-recursive difference equation:\n$$y[n] = b_0 w[n] + b_1 w[n-1] + b_2 w[n-2]$$\nFor a particular configuration of this system, the filter coefficients are given as:\n$a_1 = -0.7$\n$a_2 = 0.1$\n$b_0 = 2$\n$b_1 = 0.5$\n$b_2 = -0.3$\n\nDetermine the overall transfer function $H(z) = Y(z)/X(z)$ of the system.", "solution": "The problem asks for the transfer function $H(z)$ of a system described by two difference equations that define its Direct Form II structure. The transfer function is the ratio of the Z-transform of the output, $Y(z)$, to the Z-transform of the input, $X(z)$. We can find this by first taking the Z-transform of each difference equation and then combining them algebraically.\n\nThe first equation relates the intermediate signal $w[n]$ to the input signal $x[n]$:\n$$w[n] = x[n] - a_1 w[n-1] - a_2 w[n-2]$$\nWe apply the Z-transform to this equation. Using the time-shifting property of the Z-transform, which states that $\\mathcal{Z}\\{f[n-k]\\} = z^{-k}F(z)$, we get:\n$$W(z) = X(z) - a_1 z^{-1} W(z) - a_2 z^{-2} W(z)$$\nNow, we rearrange this equation to find the relationship between $W(z)$ and $X(z)$. We group all terms involving $W(z)$ on one side:\n$$W(z) + a_1 z^{-1} W(z) + a_2 z^{-2} W(z) = X(z)$$\nFactoring out $W(z)$, we have:\n$$W(z) (1 + a_1 z^{-1} + a_2 z^{-2}) = X(z)$$\nThis allows us to express the ratio of $W(z)$ to $X(z)$ as a transfer function, let's call it $H_1(z)$:\n$$H_1(z) = \\frac{W(z)}{X(z)} = \\frac{1}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\n\nNext, we consider the second equation, which relates the output signal $y[n]$ to the intermediate signal $w[n]$:\n$$y[n] = b_0 w[n] + b_1 w[n-1] + b_2 w[n-2]$$\nAgain, we apply the Z-transform and its time-shifting property:\n$$Y(z) = b_0 W(z) + b_1 z^{-1} W(z) + b_2 z^{-2} W(z)$$\nFactoring out $W(z)$ from the right side gives:\n$$Y(z) = W(z) (b_0 + b_1 z^{-1} + b_2 z^{-2})$$\nThis defines the transfer function from the intermediate signal to the output, let's call it $H_2(z)$:\n$$H_2(z) = \\frac{Y(z)}{W(z)} = b_0 + b_1 z^{-1} + b_2 z^{-2}$$\n\nThe overall transfer function $H(z) = Y(z)/X(z)$ is the product of these two transfer functions, as the system is a cascade of $H_1(z)$ followed by $H_2(z)$:\n$$H(z) = \\frac{Y(z)}{X(z)} = \\frac{Y(z)}{W(z)} \\cdot \\frac{W(z)}{X(z)} = H_2(z) H_1(z)$$\nSubstituting the expressions for $H_1(z)$ and $H_2(z)$:\n$$H(z) = (b_0 + b_1 z^{-1} + b_2 z^{-2}) \\cdot \\left( \\frac{1}{1 + a_1 z^{-1} + a_2 z^{-2}} \\right)$$\n$$H(z) = \\frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\nThis is the general form of the transfer function for a second-order IIR filter in Direct Form II.\n\nFinally, we substitute the given numerical values for the coefficients:\n$a_1 = -0.7$\n$a_2 = 0.1$\n$b_0 = 2$\n$b_1 = 0.5$\n$b_2 = -0.3$\n\nPlugging these into the general expression for $H(z)$:\n$$H(z) = \\frac{2 + (0.5) z^{-1} + (-0.3) z^{-2}}{1 + (-0.7) z^{-1} + (0.1) z^{-2}}$$\n$$H(z) = \\frac{2 + 0.5 z^{-1} - 0.3 z^{-2}}{1 - 0.7 z^{-1} + 0.1 z^{-2}}$$\nThis is the final closed-form expression for the system's transfer function.", "answer": "$$\\boxed{\\frac{2 + 0.5z^{-1} - 0.3z^{-2}}{1 - 0.7z^{-1} + 0.1z^{-2}}}$$", "id": "1714613"}, {"introduction": "Having learned to construct transfer functions from known filter structures, we now reverse the challenge, a common task in systems engineering known as system identification. In many real-world scenarios, we must characterize an unknown \"black box\" filter based on its observable behavior. This problem [@problem_id:1714591] demonstrates that the impulse response, $h[n]$, acts as a unique fingerprint for a linear time-invariant system, with its initial values holding critical information about the filter's internal coefficients. By analyzing a few measured samples of an impulse response, you will learn to deduce the feedback coefficients that define the filter's recursive behavior.", "problem": "An engineer is tasked with characterizing an unknown causal, second-order Linear Time-Invariant (LTI) digital filter. This type of filter is often implemented using a Direct Form structure, and its input-output relationship can be described by a general rational transfer function $H(z)$:\n$$H(z) = \\frac{Y(z)}{X(z)} = \\frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\nThis is the general form for a second-order Infinite Impulse Response (IIR) filter.\n\nThrough preliminary analysis, the engineer determines that the filter has a simple feedforward path, described by the coefficients $b_0 = 2$, $b_1 = 0$, and $b_2 = 0$. To determine the feedback coefficients, a unit impulse input, defined as $x[n] = \\delta[n]$, is applied to the filter. The first three samples of the resulting output impulse response, $h[n]$, are measured to be:\n$h[0] = 2$\n$h[1] = 1.6$\n$h[2] = 0.48$\n\nBased on this information, determine the numerical values of the feedback coefficients $a_1$ and $a_2$. The answer should be provided as an ordered pair $(a_1, a_2)$.", "solution": "For a causal second-order LTI IIR filter with transfer function\n$$H(z)=\\frac{Y(z)}{X(z)}=\\frac{b_{0}+b_{1}z^{-1}+b_{2}z^{-2}}{1+a_{1}z^{-1}+a_{2}z^{-2}},$$\nthe corresponding time-domain difference equation is obtained by multiplying both sides by the denominator and taking the inverse $z$-transform:\n$$y[n]+a_{1}y[n-1]+a_{2}y[n-2]=b_{0}x[n]+b_{1}x[n-1]+b_{2}x[n-2].$$\nGiven $b_{0}=2$, $b_{1}=0$, and $b_{2}=0$, this simplifies to\n$$y[n]+a_{1}y[n-1]+a_{2}y[n-2]=2x[n].$$\nWith an impulse input $x[n]=\\delta[n]$ and zero initial conditions (causality and initial rest), the output is the impulse response $h[n]=y[n]$, which satisfies\n$$h[n]+a_{1}h[n-1]+a_{2}h[n-2]=2\\delta[n].$$\nEvaluate this recurrence for $n=0,1,2$ using $h[-1]=0$ and $h[-2]=0$:\n- For $n=0$:\n$$h[0]+a_{1}h[-1]+a_{2}h[-2]=2 \\implies h[0]=2,$$\nconsistent with the measurement.\n- For $n=1$:\n$$h[1]+a_{1}h[0]+a_{2}h[-1]=0 \\implies h[1]+a_{1}h[0]=0 \\implies a_{1}=-\\frac{h[1]}{h[0]}.$$\nUsing $h[1]=1.6=\\frac{8}{5}$ and $h[0]=2$,\n$$a_{1}=-\\frac{\\frac{8}{5}}{2}=-\\frac{8}{10}=-\\frac{4}{5}.$$\n- For $n=2$:\n$$h[2]+a_{1}h[1]+a_{2}h[0]=0 \\implies a_{2}=-\\frac{h[2]+a_{1}h[1]}{h[0]}.$$\nUsing $h[2]=0.48=\\frac{12}{25}$, $h[1]=\\frac{8}{5}$, and $a_{1}=-\\frac{4}{5}$,\n$$h[2]+a_{1}h[1]=\\frac{12}{25}-\\frac{4}{5}\\cdot\\frac{8}{5}=\\frac{12}{25}-\\frac{32}{25}=-\\frac{20}{25}=-\\frac{4}{5},$$\nhence\n$$a_{2}=-\\frac{-\\frac{4}{5}}{2}=\\frac{4}{5}\\cdot\\frac{1}{2}=\\frac{2}{5}.$$\nTherefore, the feedback coefficients are $a_{1}=-\\frac{4}{5}$ and $a_{2}=\\frac{2}{5}$.", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{4}{5} & \\frac{2}{5}\\end{pmatrix}}$$", "id": "1714591"}]}