{"hands_on_practices": [{"introduction": "The journey from a transfer function to a state-space model is a fundamental skill in control theory and system analysis. This first exercise guides you through constructing a state-space representation in controllable canonical form [@problem_id:1748244]. This particular form is valuable as it provides a direct and systematic method to realize any transfer function, making it a common starting point for controller design and simulation.", "problem": "A stable linear time-invariant (LTI) system, with input $u(t)$ and output $y(t)$, is described by the following transfer function:\n$$H(s) = \\frac{Y(s)}{U(s)} = \\frac{2s + 1}{s^{2} + 7s + 12}$$\nYour task is to determine the state-space representation of this system in controllable canonical form. The state-space model is defined by the equations:\n$$\n\\begin{aligned}\n\\dot{\\mathbf{x}}(t) &= \\mathbf{A}\\mathbf{x}(t) + \\mathbf{B}u(t) \\\\\ny(t) &= \\mathbf{C}\\mathbf{x}(t) + Du(t)\n\\end{aligned}\n$$\nwhere $\\mathbf{x}(t)$ is the state vector, and $\\mathbf{A}, \\mathbf{B}, \\mathbf{C}, D$ are the state, input, output, and feedthrough matrices (where D is a scalar), respectively.\n\nProvide your answer as a single row matrix containing the elements of the matrices $\\mathbf{A}, \\mathbf{B}, \\mathbf{C},$ and the scalar $D$ in the following specific order: the elements of the $2 \\times 2$ matrix $\\mathbf{A}$ row by row (i.e., $A_{11}, A_{12}, A_{21}, A_{22}$), followed by the elements of the $2 \\times 1$ column vector $\\mathbf{B}$ (i.e., $B_1, B_2$), followed by the elements of the $1 \\times 2$ row vector $\\mathbf{C}$ (i.e., $C_1, C_2$), and finally the scalar $D$.", "solution": "Given the transfer function\n$$H(s) = \\frac{Y(s)}{U(s)} = \\frac{2s + 1}{s^{2} + 7s + 12},$$\nwrite the denominator in the monic form $s^{2} + a_{1}s + a_{0}$ and the numerator as $b_{1}s + b_{0}$. By identification,\n$$a_{1} = 7, \\quad a_{0} = 12, \\quad b_{1} = 2, \\quad b_{0} = 1.$$\nFor the controllable canonical form of a strictly proper second-order system with transfer function $H(s) = \\frac{b_{1}s + b_{0}}{s^{2} + a_{1}s + a_{0}}$, the state-space realization is\n$$\\mathbf{A} = \\begin{pmatrix} 0 & 1 \\\\ -a_{0} & -a_{1} \\end{pmatrix}, \\quad \\mathbf{B} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad \\mathbf{C} = \\begin{pmatrix} b_{0} & b_{1} \\end{pmatrix}, \\quad D = 0.$$\nSubstituting the identified coefficients gives\n$$\\mathbf{A} = \\begin{pmatrix} 0 & 1 \\\\ -12 & -7 \\end{pmatrix}, \\quad \\mathbf{B} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad \\mathbf{C} = \\begin{pmatrix} 1 & 2 \\end{pmatrix}, \\quad D = 0.$$\nVerification via the transfer function computed from the state-space model:\n$$(s\\mathbf{I} - \\mathbf{A}) = \\begin{pmatrix} s & -1 \\\\ 12 & s + 7 \\end{pmatrix}, \\quad \\det(s\\mathbf{I} - \\mathbf{A}) = s^{2} + 7s + 12.$$\n$$(s\\mathbf{I} - \\mathbf{A})^{-1} \\mathbf{B} = \\frac{1}{s^{2} + 7s + 12} \\begin{pmatrix} 1 \\\\ s \\end{pmatrix}, \\quad H(s) = \\mathbf{C}(s\\mathbf{I} - \\mathbf{A})^{-1}\\mathbf{B} + D = \\frac{2s + 1}{s^{2} + 7s + 12},$$\nwhich matches the given $H(s)$, confirming correctness. The requested single row is therefore $A_{11}, A_{12}, A_{21}, A_{22}, B_{1}, B_{2}, C_{1}, C_{2}, D$ equal to $0, 1, -12, -7, 0, 1, 1, 2, 0$.", "answer": "$$\\boxed{\\begin{pmatrix} 0 & 1 & -12 & -7 & 0 & 1 & 1 & 2 & 0 \\end{pmatrix}}$$", "id": "1748244"}, {"introduction": "While a single transfer function describes a unique input-output relationship, it can correspond to infinitely many state-space realizations. This practice explores the critical concept of minimality, where a given state-space model may contain redundant states that do not affect the external behavior [@problem_id:1748215]. By calculating the transfer function and identifying pole-zero cancellations, you will learn to derive a minimal realization, which is the most efficient representation of the system's dynamics.", "problem": "A fourth-order linear time-invariant (LTI) system is described by the state-space representation:\n$$\n\\dot{\\mathbf{x}}(t) = \\mathbf{A}\\mathbf{x}(t) + \\mathbf{B} u(t)\n$$\n$$\ny(t) = \\mathbf{C}\\mathbf{x}(t) + D u(t)\n$$\nwhere $\\mathbf{x}(t)$ is the state vector, $u(t)$ is the input, and $y(t)$ is the output. The system matrices are given by:\n$$\n\\mathbf{A} = \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\\\ -30 & -61 & -41 & -11 \\end{pmatrix}\n$$\n$$\n\\mathbf{B} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{C} = \\begin{pmatrix} 20 & 29 & 10 & 1 \\end{pmatrix}\n$$\n$$\nD = 0\n$$\n\nThis representation is known to be non-minimal, meaning it contains unobservable or uncontrollable modes. Your task is to find a minimal state-space realization of this system. A minimal realization is one that has the smallest possible state dimension while preserving the same input-output relationship (i.e., the same transfer function).\n\nFind the matrices $(\\mathbf{A}_m, \\mathbf{B}_m, \\mathbf{C}_m, D_m)$ for a minimal realization in controllable canonical form. Present your final answer as a single row matrix containing the elements of $\\mathbf{A}_m$ (in row-major order), followed by the elements of $\\mathbf{B}_m$ (in row-major order), followed by the elements of $\\mathbf{C}_m$ (in row-major order), and finally the scalar $D_m$.", "solution": "We are given a controllable companion-form realization with\n$$\n\\mathbf{A}=\\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-30 & -61 & -41 & -11\n\\end{pmatrix},\\quad\n\\mathbf{B}=\\begin{pmatrix}0\\\\0\\\\0\\\\1\\end{pmatrix},\\quad\n\\mathbf{C}=\\begin{pmatrix}20 & 29 & 10 & 1\\end{pmatrix},\\quad\nD=0.\n$$\nFor a controllable companion form of order $n$ with $\\mathbf{B}=\\mathbf{e}_{n}$ and $\\mathbf{C}=[c_{0},c_{1},\\dots,c_{n-1}]$, the transfer function is\n$$\nG(s)=\\frac{c_{0}+c_{1}s+\\cdots+c_{n-1}s^{n-1}}{s^{n}+a_{n-1}s^{n-1}+\\cdots+a_{0}}+D,\n$$\nwhere the last row of $\\mathbf{A}$ is $\\big(-a_{0},-a_{1},\\dots,-a_{n-1}\\big)$. In our case, the last row of $\\mathbf{A}$ is $(-30,-61,-41,-11)$, so the characteristic (and denominator) polynomial is\n$$\np(s)=s^{4}+11s^{3}+41s^{2}+61s+30.\n$$\nWith $\\mathbf{C}=(20,29,10,1)$ and $D=0$, the numerator is\n$$\nN(s)=20+29s+10s^{2}+1s^{3}=s^{3}+10s^{2}+29s+20.\n$$\nHence the transfer function is\n$$\nG(s)=\\frac{s^{3}+10s^{2}+29s+20}{s^{4}+11s^{3}+41s^{2}+61s+30}.\n$$\nFactor both numerator and denominator:\n$$\ns^{4}+11s^{3}+41s^{2}+61s+30=(s+1)(s+2)(s+3)(s+5),\n$$\n$$\ns^{3}+10s^{2}+29s+20=(s+1)(s+4)(s+5).\n$$\nCancel the common factors $(s+1)$ and $(s+5)$ to obtain the reduced (minimal) transfer function\n$$\nG_{m}(s)=\\frac{s+4}{(s+2)(s+3)}=\\frac{s+4}{s^{2}+5s+6}.\n$$\nA minimal controllable companion-form realization of $G_{m}(s)=\\dfrac{b_{1}s+b_{0}}{s^{2}+a_{1}s+a_{0}}$ is given by\n$$\n\\mathbf{A}_{m}=\\begin{pmatrix}0 & 1 \\\\ -a_{0} & -a_{1}\\end{pmatrix},\\quad\n\\mathbf{B}_{m}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix},\\quad\n\\mathbf{C}_{m}=\\begin{pmatrix}b_{0} & b_{1}\\end{pmatrix},\\quad\nD_{m}=0.\n$$\nFrom $G_{m}(s)=\\dfrac{s+4}{s^{2}+5s+6}$ we identify $a_{1}=5$, $a_{0}=6$, $b_{1}=1$, $b_{0}=4$. Therefore,\n$$\n\\mathbf{A}_{m}=\\begin{pmatrix}0 & 1 \\\\ -6 & -5\\end{pmatrix},\\quad\n\\mathbf{B}_{m}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix},\\quad\n\\mathbf{C}_{m}=\\begin{pmatrix}4 & 1\\end{pmatrix},\\quad\nD_{m}=0.\n$$\nFinally, listing the elements in the requested single row (row-major for $\\mathbf{A}_{m}$, then $\\mathbf{B}_{m}$, then $\\mathbf{C}_{m}$, then $D_{m}$) gives\n$$\n\\begin{pmatrix}\n0 & 1 & -6 & -5 & 0 & 1 & 4 & 1 & 0\n\\end{pmatrix}.\n$$\nThis realization is minimal (order two) and preserves the transfer function.", "answer": "$$\\boxed{\\begin{pmatrix}0 & 1 & -6 & -5 & 0 & 1 & 4 & 1 & 0\\end{pmatrix}}$$", "id": "1748215"}, {"introduction": "Beyond standard canonical forms, state-space models can be structured to reveal deep insights into a system's behavior. This problem introduces the diagonal (or modal) realization, which is built around the system's poles [@problem_id:1748247]. By performing a partial fraction expansion, you will construct a state-space model where the state matrix is diagonal, effectively decoupling the system's dynamic modes and providing a clear view of how each pole contributes to the overall response.", "problem": "A stable, third-order Linear Time-Invariant (LTI) continuous-time system is described by the transfer function $H(s)$, which relates the Laplace transform of the output, $Y(s)$, to the Laplace transform of the input, $U(s)$, as follows:\n$$H(s) = \\frac{2s^2 + 3s + 4}{s^3 + 7s^2 + 14s + 8}$$\n\nThis system can be represented by a state-space model of the form:\n$$\\dot{\\mathbf{x}}(t) = \\mathbf{A}\\mathbf{x}(t) + \\mathbf{B} u(t)$$\n$$y(t) = \\mathbf{C}\\mathbf{x}(t) + D u(t)$$\nwhere $\\mathbf{x}(t)$ is the state vector, and $\\mathbf{A}, \\mathbf{B}, \\mathbf{C}, D$ are the state, input, output, and feedthrough matrices, respectively.\n\nDetermine the diagonal state-space realization $(\\mathbf{A}, \\mathbf{B}, \\mathbf{C}, D)$ of this system subject to the following constraints:\n1. The state matrix $\\mathbf{A}$ must be a diagonal matrix.\n2. The state variables $x_1(t), x_2(t), x_3(t)$ must be ordered such that they correspond to the system's poles sorted by increasing absolute value.\n3. The input matrix $\\mathbf{B}$ must be a column vector with all its elements equal to 1.\n\nUsing this specific state-space realization, compute the scalar value $q = \\mathbf{C} \\mathbf{A}^2 \\mathbf{B}$. Provide this value as your final answer.", "solution": "We start from the transfer function\n$$H(s)=\\frac{2s^{2}+3s+4}{s^{3}+7s^{2}+14s+8}=\\frac{2s^{2}+3s+4}{(s+1)(s+2)(s+4)}.$$\nSince the system is stable and the denominator factors as shown, the poles are at $-1$, $-2$, and $-4$. Sorting by increasing absolute value yields the order $-1$, $-2$, $-4$. A diagonal realization consistent with the constraints has\n$$\\mathbf{A}=\\operatorname{diag}(-1,-2,-4),\\quad \\mathbf{B}=\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix}.$$\n\nFor a diagonal/modal realization with $\\mathbf{B}$ as specified and $D=0$ (because $H(s)$ is strictly proper), the transfer function is\n$$H(s)=\\mathbf{C}(s\\mathbf{I}-\\mathbf{A})^{-1}\\mathbf{B}=\\sum_{i=1}^{3}\\frac{c_{i}}{s-\\lambda_{i}},$$\nwhere $\\lambda_{1}=-1$, $\\lambda_{2}=-2$, $\\lambda_{3}=-4$, and $\\mathbf{C}=\\begin{pmatrix}c_{1}&c_{2}&c_{3}\\end{pmatrix}$. Therefore the residues $k_{i}$ of $H(s)$ at $s=\\lambda_{i}$ must satisfy $k_{i}=c_{i}$.\n\nCompute the residues using\n$$k_{i}=\\frac{N(\\lambda_{i})}{\\prod_{j\\neq i}(\\lambda_{i}-\\lambda_{j})},\\quad N(s)=2s^{2}+3s+4.$$\n- At $s=-1$:\n$$k_{1}=\\frac{N(-1)}{(-1-(-2))(-1-(-4))}=\\frac{2(1)+3(-1)+4}{(1)(3)}=\\frac{3}{3}=1.$$\n- At $s=-2$:\n$$k_{2}=\\frac{N(-2)}{(-2-(-1))(-2-(-4))}=\\frac{2(4)+3(-2)+4}{(-1)(2)}=\\frac{6}{-2}=-3.$$\n- At $s=-4$:\n$$k_{3}=\\frac{N(-4)}{(-4-(-1))(-4-(-2))}=\\frac{2(16)+3(-4)+4}{(-3)(-2)}=\\frac{24}{6}=4.$$\n\nThus,\n$$\\mathbf{C}=\\begin{pmatrix}1&-3&4\\end{pmatrix},\\qquad D=0.$$\n\nNow compute\n$$q=\\mathbf{C}\\mathbf{A}^{2}\\mathbf{B}.$$\nSince $\\mathbf{A}=\\operatorname{diag}(-1,-2,-4)$, we have\n$$\\mathbf{A}^{2}=\\operatorname{diag}(1,4,16),\\quad \\mathbf{A}^{2}\\mathbf{B}=\\begin{pmatrix}1\\\\4\\\\16\\end{pmatrix}.$$\nTherefore,\n$$q=\\mathbf{C}(\\mathbf{A}^{2}\\mathbf{B})=\\begin{pmatrix}1&-3&4\\end{pmatrix}\\begin{pmatrix}1\\\\4\\\\16\\end{pmatrix}=1-12+64=53.$$", "answer": "$$\\boxed{53}$$", "id": "1748247"}]}