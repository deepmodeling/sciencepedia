{"hands_on_practices": [{"introduction": "This first exercise moves beyond the idealized Nyquist theorem to confront a core challenge in practical system design. We will explore how a real-world anti-aliasing filter, with its unavoidable transition band, limits the usable signal bandwidth for a fixed sampling rate. Mastering this concept is the first step toward designing robust data acquisition systems that are free from aliasing artifacts [@problem_id:1698331].", "problem": "A biomedical engineer is designing a portable Electroencephalogram (EEG) monitoring device. The core of the device is a data acquisition system that digitizes the faint electrical signals from the brain. This system includes an analog anti-aliasing filter followed by an Analog-to-Digital Converter (ADC). The ADC operates at a fixed sampling frequency of $f_s$.\n\nThe anti-aliasing filter is a low-pass filter characterized by the following specifications:\n- The **passband edge frequency**, $f_p$, is the maximum frequency at which the input signal's amplitude is attenuated by no more than 3 dB.\n- The **stopband edge frequency**, $f_{st}$, is the minimum frequency at which the input signal's amplitude is attenuated by at least 60 dB.\n- The region between $f_p$ and $f_{st}$ is the **transition band**. The width of this band is fixed by the filter's design to be $\\Delta f = f_{st} - f_p$.\n\nTo ensure the integrity of the collected data, it is crucial to prevent aliasing artifacts from corrupting the frequencies of interest. The **usable signal bandwidth** is defined as the range of frequencies from DC up to the passband edge, $f_p$. In other words, the usable bandwidth is $B = f_p$.\n\nAssuming the engineer can freely choose the filter's passband edge frequency $f_p$ to maximize the usable bandwidth while strictly avoiding any aliasing from frequencies outside the stopband into the usable bandwidth, determine the maximum achievable usable signal bandwidth, $B_{max}$, in terms of the sampling frequency $f_s$ and the transition band width $\\Delta f$.", "solution": "The goal is to find the maximum usable signal bandwidth, $B_{max}$. The problem statement defines the usable bandwidth as the passband edge frequency of the anti-aliasing filter, so $B = f_p$. Our objective is to maximize $f_p$ under the constraint that aliasing does not corrupt the signal within this band.\n\nThe anti-aliasing filter has a passband that ends at $f_p$ and a stopband that begins at $f_{st}$. The relationship between these frequencies is given by the transition band width, $\\Delta f$:\n$$f_{st} = f_p + \\Delta f$$\nSince we are maximizing the usable bandwidth $B = f_p$, we can express the stopband edge frequency in terms of $B$:\n$$f_{st} = B + \\Delta f$$\n\nAccording to the Nyquist-Shannon sampling theorem, when a signal is sampled at a frequency $f_s$, spectral components of the original analog signal are replicated at integer multiples of $f_s$. Aliasing occurs when these replicas overlap with the baseband spectrum. Specifically, a frequency component at an original frequency $f_{orig}$ can appear as an aliased frequency $f_{alias} = |f_{orig} - k f_s|$ for integer $k$.\n\nThe most problematic aliasing comes from the first replica (for $k=1$), where a high-frequency component at $f_{orig}$ folds back into the low-frequency band at $f_s - f_{orig}$. To prevent corruption of the usable bandwidth $[0, B]$, we must ensure that any significant aliased frequencies fall outside this range.\n\nThe anti-aliasing filter is designed to heavily attenuate frequencies in its stopband, i.e., for all frequencies $f \\ge f_{st}$. Any frequency component below $f_{st}$ (i.e., in the passband or transition band) is not guaranteed to be sufficiently attenuated and could potentially cause aliasing. The \"worst-case\" scenario for aliasing involves the lowest frequency that is not strongly attenuated by the filter just before it enters the stopband. To be conservative and ensure no corruption, we must consider what happens to frequency components at the boundary of the stopband.\n\nLet's analyze a frequency component at the stopband edge, $f_{st}$. When sampled, this frequency will generate an aliased component in the baseband at:\n$$f_{alias} = f_s - f_{st}$$\nTo ensure that this aliased component does not interfere with the signal in the usable bandwidth $[0, B]$, its frequency must be greater than or equal to the maximum frequency in that band, which is $B$. This gives us the critical condition:\n$$f_{alias} \\ge B$$\nSubstituting the expression for $f_{alias}$:\n$$f_s - f_{st} \\ge B$$\nNow, we can substitute the expression for $f_{st}$ in terms of $B$ and $\\Delta f$:\n$$f_s - (B + \\Delta f) \\ge B$$\nWe can now solve this inequality for $B$ to find the maximum allowed bandwidth.\n$$f_s - B - \\Delta f \\ge B$$\n$$f_s - \\Delta f \\ge 2B$$\n$$B \\le \\frac{f_s - \\Delta f}{2}$$\nThis inequality gives the upper limit on the usable bandwidth $B$. To maximize the bandwidth, we choose the largest possible value for $B$, which corresponds to the equality:\n$$B_{max} = \\frac{f_s - \\Delta f}{2}$$\nThis expression represents the maximum achievable usable signal bandwidth given the fixed sampling rate and the filter's transition width.", "answer": "$$\\boxed{\\frac{f_s - \\Delta f}{2}}$$", "id": "1698331"}, {"introduction": "Building on the general principles of bandwidth and sampling, this problem examines the interaction between a filter and a specific, harmonically rich signal. By analyzing a square wave passing through a Butterworth filter, you will learn to predict which specific frequency components are likely to cause aliasing after sampling. This practice underscores the need to consider not just the signal's maximum frequency, but its entire spectral content [@problem_id:1698335].", "problem": "In a digital signal processing system, an analog signal must be sampled. To prevent aliasing, an anti-aliasing filter is applied before the sampler. Consider a symmetric periodic square wave signal with a fundamental frequency of $f_0 = 1.0$ kHz. This signal is passed through a second-order analog Butterworth low-pass filter with a cutoff frequency of $f_c = 4.0$ kHz. The filtered signal is then sampled at a rate of $f_s = 10.0$ kHz.\n\nA harmonic of the original square wave is considered to cause significant aliasing if it satisfies two conditions:\n1.  Its frequency is greater than the Nyquist frequency determined by the sampling rate.\n2.  After being attenuated by the filter, its amplitude is greater than 1% of the filtered fundamental's amplitude.\n\nRecall that a symmetric periodic square wave contains only odd harmonics (i.e., its frequency components are at $k f_0$ for $k=1, 3, 5, \\dots$). Determine the set of harmonic numbers, $k$, that cause significant aliasing according to the criteria above.\n\nWhich of the following represents the complete set of such harmonic numbers?\n\nA. $\\{7\\}$\n\nB. $\\{7, 9\\}$\n\nC. $\\{7, 9, 11\\}$\n\nD. $\\{7, 9, 11, 13\\}$\n\nE. $\\{5, 7, 9\\}$", "solution": "The Nyquist frequency is $f_{N} = \\frac{f_{s}}{2} = 5.0\\ \\text{kHz}$. Since the square wave has only odd harmonics at $k f_{0}$ with $k \\in \\{1,3,5,\\dots\\}$ and $f_{0} = 1.0\\ \\text{kHz}$, condition 1 requires $k f_{0} > f_{N}$, i.e., $k > 5$. Thus the candidates are $k \\in \\{7,9,11,13,\\dots\\}$.\n\nFor a symmetric square wave, the magnitude of the $k$-th odd harmonic before filtering is proportional to $\\frac{1}{k}$ times the fundamental. Let $A_{k}^{(0)}$ denote the unfiltered $k$-th harmonic amplitude and $A_{1}^{(0)}$ the unfiltered fundamental amplitude; then $\\frac{A_{k}^{(0)}}{A_{1}^{(0)}} = \\frac{1}{k}$.\n\nA second-order Butterworth low-pass filter has magnitude response\n$$\n|H(f)| = \\frac{1}{\\sqrt{1 + \\left(\\frac{f}{f_{c}}\\right)^{4}}}.\n$$\nTherefore, the ratio of the filtered $k$-th harmonic amplitude to the filtered fundamental amplitude is\n$$\nR_{k} \\equiv \\frac{A_{k}^{(0)} |H(k f_{0})|}{A_{1}^{(0)} |H(f_{0})|} = \\frac{1}{k}\\,\\frac{|H(k f_{0})|}{|H(f_{0})|} = \\frac{1}{k}\\,\\sqrt{\\frac{1 + \\left(\\frac{f_{0}}{f_{c}}\\right)^{4}}{1 + \\left(\\frac{k f_{0}}{f_{c}}\\right)^{4}}}.\n$$\nCondition 2 requires $R_{k} > 0.01$. With $f_{0} = 1.0\\ \\text{kHz}$ and $f_{c} = 4.0\\ \\text{kHz}$, we have $\\frac{f_{0}}{f_{c}} = \\frac{1}{4}$ and $\\frac{k f_{0}}{f_{c}} = \\frac{k}{4}$, so\n$$\nR_{k} = \\frac{1}{k}\\,\\sqrt{\\frac{1 + \\left(\\frac{1}{4}\\right)^{4}}{1 + \\left(\\frac{k}{4}\\right)^{4}}} = \\frac{1}{k}\\,\\sqrt{\\frac{1 + \\frac{1}{256}}{1 + \\frac{k^{4}}{256}}} = \\frac{1}{k}\\,\\sqrt{\\frac{\\frac{257}{256}}{1 + \\frac{k^{4}}{256}}}.\n$$\nImposing $R_{k} > 0.01$ and squaring yields\n$$\n\\frac{1}{k^{2}}\\,\\frac{\\frac{257}{256}}{1 + \\frac{k^{4}}{256}} > 0.0001,\n$$\nwhich rearranges to\n$$\n1 + \\frac{k^{4}}{256} < \\frac{\\frac{257}{256}}{(0.01 k)^{2}} = \\frac{257}{256}\\cdot\\frac{10000}{k^{2}} = \\frac{2570000}{256 k^{2}}.\n$$\nMultiplying both sides by $256 k^{2}$ gives the equivalent inequality\n$$\nk^{6} + 256 k^{2} < 2570000.\n$$\nWe test odd $k > 5$:\n\n- $k=7$: $k^{6} = 117649$, $256 k^{2} = 12544$, sum $= 130193 < 2570000$; satisfies.\n- $k=9$: $k^{6} = 531441$, $256 k^{2} = 20736$, sum $= 552177 < 2570000$; satisfies.\n- $k=11$: $k^{6} = 1771561$, $256 k^{2} = 30976$, sum $= 1802537 < 2570000$; satisfies.\n- $k=13$: $k^{6} = 4826809$, $256 k^{2} = 43264$, sum $= 4870073 > 2570000$; fails.\n\nSince the left-hand side $k^{6} + 256 k^{2}$ increases strictly with $k$, all higher odd $k$ will also fail. Thus the harmonics causing significant aliasing are exactly $k \\in \\{7,9,11\\}$, which corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "1698335"}, {"introduction": "Our final practice problem elevates the analysis to a systems-engineering level, where technical specifications meet economic reality. You will solve an optimization problem that balances the cost of the analog anti-aliasing filter against the cost of the digital subsystem it serves. This exercise illustrates the crucial trade-off between analog precision and digital processing speed, a fundamental consideration in the design of any cost-effective DAQ system [@problem_id:1698377].", "problem": "A company is designing a new Data Acquisition (DAQ) system to monitor a physical process. The analog signal from the sensor is known to be bandlimited, with its maximum frequency content at $f_{max} = 10.0 \\text{ kHz}$. To prevent aliasing, a hardware N-th order Butterworth low-pass filter is placed before the Analog-to-Digital Converter (ADC). The design specifications mandate that the filter's -3 dB cutoff frequency, $f_c$, must be set equal to $f_{max}$. Furthermore, the filter must provide at least $A_{min} = 60 \\text{ dB}$ of attenuation at the Nyquist frequency, $f_s/2$, where $f_s$ is the sampling frequency.\n\nThe total cost of the system is dominated by two components: the analog filter and the digital subsystem (ADC and memory).\n1.  The cost of the Butterworth filter, $C_{filter}$, is directly proportional to its complexity, given by $C_{filter} = K_N \\cdot N$, where $N$ is the integer order of the filter and the cost coefficient is $K_N = \\$150.00$ per order.\n2.  The cost of the digital subsystem, $C_{digital}$, increases with the required sampling rate, given by $C_{digital} = K_s \\cdot f_s$, where the cost coefficient is $K_s = \\$2.00$ per kHz of sampling frequency.\n\nYour task is to determine the optimal filter order, $N_{opt}$, that minimizes the total system cost, $C_{total} = C_{filter} + C_{digital}$. You must also find this minimum cost, $C_{min}$. The filter order $N$ must be a positive integer.\n\nDetermine the optimal integer filter order $N_{opt}$ and the corresponding minimum total system cost $C_{min}$. Express the final cost in dollars, rounded to three significant figures.", "solution": "The squared magnitude response of an $N$-th order Butterworth low-pass filter with cutoff $f_{c}$ is\n$$\n|H(j2\\pi f)|^{2}=\\frac{1}{1+\\left(\\frac{f}{f_{c}}\\right)^{2N}}.\n$$\nThe attenuation in decibels at frequency $f$ is therefore\n$$\nA(f)=10\\log_{10}\\!\\left(1+\\left(\\frac{f}{f_{c}}\\right)^{2N}\\right).\n$$\nWith $f_{c}=f_{\\max}$ and the Nyquist frequency $f_{s}/2$, the attenuation requirement $A(f_{s}/2)\\geq A_{\\min}$ gives\n$$\n10\\log_{10}\\!\\left(1+\\left(\\frac{f_{s}/2}{f_{\\max}}\\right)^{2N}\\right)\\geq A_{\\min}.\n$$\nLet $r\\equiv \\frac{f_{s}/2}{f_{\\max}}$. Then the inequality becomes\n$$\n1+r^{2N}\\geq 10^{A_{\\min}/10}\\quad\\Rightarrow\\quad r\\geq\\left(10^{A_{\\min}/10}-1\\right)^{\\frac{1}{2N}}.\n$$\nFor a given $N$, the minimum sampling frequency that satisfies the constraint is\n$$\nf_{s,\\min}(N)=2f_{\\max}\\left(10^{A_{\\min}/10}-1\\right)^{\\frac{1}{2N}}.\n$$\nThe costs are $C_{\\text{filter}}=K_{N}N$ and $C_{\\text{digital}}=K_{s}f_{s}$. Minimizing total cost for a given $N$ uses $f_{s}=f_{s,\\min}(N)$, yielding\n$$\nC_{\\text{total}}(N)=K_{N}N+K_{s}\\,f_{s,\\min}(N)\n=K_{N}N+K_{s}\\cdot 2f_{\\max}\\left(10^{\\frac{A_{\\min}}{10}}-1\\right)^{\\frac{1}{2N}}.\n$$\nSubstitute the given numerical specifications $K_{N}=150$, $K_{s}=2$ (per kHz), $f_{\\max}=10.0$ kHz, and $A_{\\min}=60$ dB:\n$$\nC_{\\text{total}}(N)=150\\,N+40\\left(10^{6}-1\\right)^{\\frac{1}{2N}}.\n$$\nEvaluate this for positive integers $N$:\n- $N=3$: $C_{\\text{total}}(3)\\approx 150\\cdot 3+40\\cdot 10^{\\frac{3}{3}}=450+400=850$.\n- $N=4$: $C_{\\text{total}}(4)\\approx 150\\cdot 4+40\\cdot 10^{\\frac{3}{4}}=600+40\\cdot 5.623413\\approx 824.93653$.\n- $N=5$: $C_{\\text{total}}(5)\\approx 750+40\\cdot 10^{0.6}\\approx 750+159.2429\\approx 909.2429$.\n\nThe minimum among these occurs at $N=4$. Therefore, $N_{\\text{opt}}=4$, and the corresponding minimum cost is\n$$\nC_{\\min}=150\\cdot 4+40\\left(10^{6}-1\\right)^{\\frac{1}{8}}\\approx 824.93653,\n$$\nwhich, rounded to three significant figures, is $825$ dollars.", "answer": "$$\\boxed{\\begin{pmatrix}4 & 825\\end{pmatrix}}$$", "id": "1698377"}]}