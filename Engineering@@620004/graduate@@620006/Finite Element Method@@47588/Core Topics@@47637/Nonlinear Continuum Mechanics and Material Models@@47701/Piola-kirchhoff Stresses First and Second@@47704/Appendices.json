{"hands_on_practices": [{"introduction": "Understanding the relationships between different stress measures is fundamental to continuum mechanics. This practice grounds the first Piola-Kirchhoff stress, $\\boldsymbol{P}$, and second Piola-Kirchhoff stress, $\\boldsymbol{S}$, in the physical principle of force equivalence between the reference and current configurations. By starting with the definitions of traction and using Nanson's formula to relate area elements, you will derive the essential transformation formulas connecting $\\boldsymbol{P}$ and $\\boldsymbol{S}$ to the true (Cauchy) stress $\\boldsymbol{\\sigma}$ [@problem_id:2587889]. This exercise provides a concrete understanding of how these abstract tensors are related and how to compute their components in a straightforward case of pure stretch.", "problem": "In a Total Lagrangian finite element formulation for finite deformation elasticity, consider a material mapping from a reference configuration with position vector $\\boldsymbol{X}$ to a current configuration with position vector $\\boldsymbol{x}=\\boldsymbol{\\varphi}(\\boldsymbol{X})$. The deformation gradient is $\\boldsymbol{F}=\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{\\varphi}$. Let the unit normal to a surface element in the reference configuration be $\\boldsymbol{N}$ with area $\\mathrm{d}A$, and the corresponding unit normal in the current configuration be $\\boldsymbol{n}$ with area $\\mathrm{d}a$. Let the Cauchy stress (true stress) be $\\boldsymbol{\\sigma}$, the first Piola–Kirchhoff stress be $\\boldsymbol{P}$, and the second Piola–Kirchhoff stress be $\\boldsymbol{S}$.\n\nYou are given the following fundamental relations:\n- Cauchy traction definition in the current configuration: $\\boldsymbol{t}=\\boldsymbol{\\sigma}\\,\\boldsymbol{n}$.\n- Nominal traction definition in the reference configuration: $\\boldsymbol{T}_{0}=\\boldsymbol{P}\\,\\boldsymbol{N}$.\n- Equality of contact forces on corresponding surface elements: $\\boldsymbol{t}\\,\\mathrm{d}a=\\boldsymbol{T}_{0}\\,\\mathrm{d}A$.\n- Nanson’s formula: $\\boldsymbol{n}\\,\\mathrm{d}a = J\\,\\boldsymbol{F}^{-T}\\boldsymbol{N}\\,\\mathrm{d}A$, where $J=\\det \\boldsymbol{F}$.\n\nStarting only from the above relations and the definition $\\boldsymbol{S}=\\boldsymbol{F}^{-1}\\boldsymbol{P}$, first derive expressions for $\\boldsymbol{P}$ and $\\boldsymbol{S}$ in terms of $\\boldsymbol{F}$, $J$, and $\\boldsymbol{\\sigma}$. Then, specialize to the case of a pure stretch with\n$$\n\\boldsymbol{F}=\\operatorname{diag}(\\lambda_{1},\\lambda_{2},\\lambda_{3}), \\quad \\lambda_{i}>0,\n$$\nand a diagonal Cauchy stress\n$$\n\\boldsymbol{\\sigma}=\\operatorname{diag}(\\sigma_{1},\\sigma_{2},\\sigma_{3}).\n$$\n\nCompute the diagonal components of $\\boldsymbol{P}$ and $\\boldsymbol{S}$ explicitly as closed-form expressions in terms of $\\lambda_{1},\\lambda_{2},\\lambda_{3}$ and $\\sigma_{1},\\sigma_{2},\\sigma_{3}$. Express your final answer as a single row matrix containing the six diagonal entries in the order $\\big(P_{11},P_{22},P_{33},S_{11},S_{22},S_{33}\\big)$, using $J=\\lambda_{1}\\lambda_{2}\\lambda_{3}$ where needed. Express your final answer symbolically; do not include units.", "solution": "The problem statement is analyzed and found to be valid. It is a well-posed problem in continuum mechanics, grounded in established principles, with a complete and consistent set of definitions and relations. There are no scientific or logical flaws. The solution will proceed by first deriving the general relationships between the stress tensors and then specializing to the given case.\n\nThe starting point is the equality of contact forces acting on a material surface element in the current and reference configurations:\n$$\n\\boldsymbol{t}\\,\\mathrm{d}a = \\boldsymbol{T}_{0}\\,\\mathrm{d}A\n$$\nHere, $\\boldsymbol{t}$ is the Cauchy traction vector in the current configuration and $\\boldsymbol{T}_{0}$ is the nominal traction vector in the reference configuration. The elemental areas are $\\mathrm{d}a$ and $\\mathrm{d}A$, respectively.\n\nWe substitute the definitions of the traction vectors in terms of the Cauchy stress $\\boldsymbol{\\sigma}$ and the first Piola-Kirchhoff stress $\\boldsymbol{P}$:\n$$\n(\\boldsymbol{\\sigma}\\,\\boldsymbol{n})\\,\\mathrm{d}a = (\\boldsymbol{P}\\,\\boldsymbol{N})\\,\\mathrm{d}A\n$$\nwhere $\\boldsymbol{n}$ and $\\boldsymbol{N}$ are the unit normal vectors to the surface element in the current and reference configurations. Rearranging the terms yields:\n$$\n\\boldsymbol{\\sigma}\\,(\\boldsymbol{n}\\,\\mathrm{d}a) = \\boldsymbol{P}\\,(\\boldsymbol{N}\\,\\mathrm{d}A)\n$$\nWe now employ Nanson's formula, which relates the oriented area elements in the two configurations:\n$$\n\\boldsymbol{n}\\,\\mathrm{d}a = J\\,\\boldsymbol{F}^{-T}\\boldsymbol{N}\\,\\mathrm{d}A\n$$\nwhere $\\boldsymbol{F}$ is the deformation gradient, $J = \\det(\\boldsymbol{F})$, and $\\boldsymbol{F}^{-T}$ is the inverse transpose of $\\boldsymbol{F}$. Substituting Nanson's formula into the force balance equation gives:\n$$\n\\boldsymbol{\\sigma}\\,(J\\,\\boldsymbol{F}^{-T}\\boldsymbol{N}\\,\\mathrm{d}A) = \\boldsymbol{P}\\,(\\boldsymbol{N}\\,\\mathrm{d}A)\n$$\nSince this relation must hold for any arbitrary surface element, we can cancel the scalar term $\\mathrm{d}A$ and recognize that the equality must hold for any choice of the normal vector $\\boldsymbol{N}$. This implies the following relationship between the tensors:\n$$\n\\boldsymbol{P} = J\\,\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}\n$$\nThis is the required expression relating the first Piola-Kirchhoff stress $\\boldsymbol{P}$ to the Cauchy stress $\\boldsymbol{\\sigma}$.\n\nNext, we derive the expression for the second Piola-Kirchhoff stress, $\\boldsymbol{S}$. We are given the definition:\n$$\n\\boldsymbol{S} = \\boldsymbol{F}^{-1}\\boldsymbol{P}\n$$\nSubstituting the expression for $\\boldsymbol{P}$ we just derived:\n$$\n\\boldsymbol{S} = \\boldsymbol{F}^{-1}\\,(J\\,\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T})\n$$\nThe scalar $J$ can be moved to the front:\n$$\n\\boldsymbol{S} = J\\,\\boldsymbol{F}^{-1}\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}\n$$\nThis is the required expression relating the second Piola-Kirchhoff stress $\\boldsymbol{S}$ to the Cauchy stress $\\boldsymbol{\\sigma}$. This completes the first part of the problem.\n\nFor the second part, we specialize these general relations to the case of a pure stretch, where the deformation gradient $\\boldsymbol{F}$ and the Cauchy stress $\\boldsymbol{\\sigma}$ are given as diagonal matrices:\n$$\n\\boldsymbol{F} = \\begin{pmatrix} \\lambda_{1} & 0 & 0 \\\\ 0 & \\lambda_{2} & 0 \\\\ 0 & 0 & \\lambda_{3} \\end{pmatrix}, \\quad \\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{1} & 0 & 0 \\\\ 0 & \\sigma_{2} & 0 \\\\ 0 & 0 & \\sigma_{3} \\end{pmatrix}\n$$\nwith principal stretches $\\lambda_{i} > 0$. The determinant of $\\boldsymbol{F}$ is $J = \\det(\\boldsymbol{F}) = \\lambda_{1}\\lambda_{2}\\lambda_{3}$. Since $\\boldsymbol{F}$ is a diagonal matrix, its transpose is itself, $\\boldsymbol{F}^{T} = \\boldsymbol{F}$. The inverse of its transpose is:\n$$\n\\boldsymbol{F}^{-T} = (\\boldsymbol{F}^T)^{-1} = \\boldsymbol{F}^{-1} = \\begin{pmatrix} \\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\lambda_{3}^{-1} \\end{pmatrix}\n$$\nWe now compute the components of $\\boldsymbol{P}$ using $\\boldsymbol{P} = J\\,\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}$:\n$$\n\\boldsymbol{P} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\sigma_{1} & 0 & 0 \\\\ 0 & \\sigma_{2} & 0 \\\\ 0 & 0 & \\sigma_{3} \\end{pmatrix} \\begin{pmatrix} \\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\lambda_{3}^{-1} \\end{pmatrix}\n$$\nThe product of the two diagonal matrices is a diagonal matrix:\n$$\n\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T} = \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\sigma_{2}\\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\sigma_{3}\\lambda_{3}^{-1} \\end{pmatrix}\n$$\nMultiplying by the scalar $J$ gives the components of $\\boldsymbol{P}$:\n$$\n\\boldsymbol{P} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\sigma_{2}\\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\sigma_{3}\\lambda_{3}^{-1} \\end{pmatrix} = \\begin{pmatrix} \\sigma_{1}\\lambda_{2}\\lambda_{3} & 0 & 0 \\\\ 0 & \\sigma_{2}\\lambda_{1}\\lambda_{3} & 0 \\\\ 0 & 0 & \\sigma_{3}\\lambda_{1}\\lambda_{2} \\end{pmatrix}\n$$\nThe diagonal components of the first Piola-Kirchhoff stress are:\n$P_{11} = \\sigma_{1}\\lambda_{2}\\lambda_{3}$\n$P_{22} = \\sigma_{2}\\lambda_{1}\\lambda_{3}$\n$P_{33} = \\sigma_{3}\\lambda_{1}\\lambda_{2}$\n\nFinally, we compute the components of $\\boldsymbol{S}$ using $\\boldsymbol{S} = J\\,\\boldsymbol{F}^{-1}\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}$:\n$$\n\\boldsymbol{S} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\lambda_{3}^{-1} \\end{pmatrix} \\begin{pmatrix} \\sigma_{1} & 0 & 0 \\\\ 0 & \\sigma_{2} & 0 \\\\ 0 & 0 & \\sigma_{3} \\end{pmatrix} \\begin{pmatrix} \\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\lambda_{3}^{-1} \\end{pmatrix}\n$$\nPerforming the matrix multiplications:\n$$\n\\boldsymbol{S} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\lambda_{3}^{-1} \\end{pmatrix} \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\sigma_{2}\\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\sigma_{3}\\lambda_{3}^{-1} \\end{pmatrix}\n$$\n$$\n\\boldsymbol{S} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-2} & 0 & 0 \\\\ 0 & \\sigma_{2}\\lambda_{2}^{-2} & 0 \\\\ 0 & 0 & \\sigma_{3}\\lambda_{3}^{-2} \\end{pmatrix} = \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1}\\lambda_{2}\\lambda_{3} & 0 & 0 \\\\ 0 & \\sigma_{2}\\lambda_{1}\\lambda_{2}^{-1}\\lambda_{3} & 0 \\\\ 0 & 0 & \\sigma_{3}\\lambda_{1}\\lambda_{2}\\lambda_{3}^{-1} \\end{pmatrix}\n$$\nThe diagonal components of the second Piola-Kirchhoff stress are:\n$S_{11} = \\sigma_{1}\\lambda_{1}^{-1}\\lambda_{2}\\lambda_{3}$\n$S_{22} = \\sigma_{2}\\lambda_{1}\\lambda_{2}^{-1}\\lambda_{3}$\n$S_{33} = \\sigma_{3}\\lambda_{1}\\lambda_{2}\\lambda_{3}^{-1}$\n\nThe required six diagonal components are assembled into a single row matrix for the final answer.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sigma_{1}\\lambda_{2}\\lambda_{3} & \\sigma_{2}\\lambda_{1}\\lambda_{3} & \\sigma_{3}\\lambda_{1}\\lambda_{2} & \\sigma_{1}\\lambda_{1}^{-1}\\lambda_{2}\\lambda_{3} & \\sigma_{2}\\lambda_{1}\\lambda_{2}^{-1}\\lambda_{3} & \\sigma_{3}\\lambda_{1}\\lambda_{2}\\lambda_{3}^{-1} \\end{pmatrix}}\n$$", "id": "2587889"}, {"introduction": "A cornerstone of any physically realistic constitutive model is the principle of material frame-indifference, which demands that rigid body motions produce no stresses. This hands-on practice explores this concept through a \"rigid motion test,\" a fundamental verification for hyperelastic material models in finite element codes [@problem_id:2587933]. By considering a pure rotation and a strain energy function that is minimized in the undeformed state, you will demonstrate that both the first and second Piola-Kirchhoff stresses must vanish, reinforcing a critical link between physical principles and mathematical formulation.", "problem": "Consider a hyperelastic material model used in the finite element method, with a stored energy density that is frame-indifferent, so that $W(\\boldsymbol{F}) = \\hat{W}(\\boldsymbol{C})$ with $\\boldsymbol{C} = \\boldsymbol{F}^{\\top} \\boldsymbol{F}$. Let $\\boldsymbol{F} \\in \\mathbb{R}^{3 \\times 3}$ denote the deformation gradient with $\\det \\boldsymbol{F} > 0$, and let $\\boldsymbol{C} \\in \\mathbb{R}^{3 \\times 3}$ denote the right Cauchy–Green deformation tensor. Assume that $\\hat{W}(\\boldsymbol{C})$ attains a strict global minimum at $\\boldsymbol{C} = \\boldsymbol{I}$, where $\\boldsymbol{I}$ is the identity tensor. The first Piola–Kirchhoff stress is defined by $\\boldsymbol{P} := \\frac{\\partial W}{\\partial \\boldsymbol{F}}$ and the second Piola–Kirchhoff stress by $\\boldsymbol{S} := 2 \\frac{\\partial \\hat{W}}{\\partial \\boldsymbol{C}}$. Let $\\boldsymbol{Q} \\in \\mathrm{SO}(3)$ be a proper orthogonal tensor, i.e., $\\boldsymbol{Q}^{\\top} \\boldsymbol{Q} = \\boldsymbol{I}$ and $\\det \\boldsymbol{Q} = 1$.\n\nTasks:\n1. Starting from the given definitions and the chain rule applied to $\\boldsymbol{C} = \\boldsymbol{F}^{\\top} \\boldsymbol{F}$, derive $\\boldsymbol{S}$ at $\\boldsymbol{C} = \\boldsymbol{I}$, and derive a relation between $\\boldsymbol{P}$ and $\\boldsymbol{S}$. Then, evaluate these quantities for the rigid rotation $\\boldsymbol{F} = \\boldsymbol{Q} \\in \\mathrm{SO}(3)$.\n2. Define the scalar diagnostic \n$$R := \\|\\boldsymbol{P}\\|_{F}^{2} + \\|\\boldsymbol{S}\\|_{F}^{2},$$\nwhere $\\|\\boldsymbol{A}\\|_{F}^{2} := \\boldsymbol{A} : \\boldsymbol{A}$ is the Frobenius norm. Compute $R$ for the case $\\boldsymbol{F} = \\boldsymbol{Q} \\in \\mathrm{SO}(3)$. Provide your final answer as an exact real number with no units.\n3. Briefly interpret your result as a rigid motion test that a consistent hyperelastic finite element implementation should pass.\n\nYour final submitted answer must be the value of $R$ only. No rounding is required. The scalar $R$ is dimensionless; do not include any units in the final answer.", "solution": "We begin by analyzing the conditions provided in the problem statement. The stored energy density $\\hat{W}(\\boldsymbol{C})$ is stated to have a strict global minimum at the configuration where the right Cauchy-Green deformation tensor $\\boldsymbol{C}$ is the identity tensor $\\boldsymbol{I}$. For a differentiable function, a necessary condition for an extremum is that its gradient must vanish. The gradient of the scalar function $\\hat{W}$ with respect to its tensor argument $\\boldsymbol{C}$ is $\\frac{\\partial \\hat{W}}{\\partial \\boldsymbol{C}}$. Therefore, at the minimum point $\\boldsymbol{C}=\\boldsymbol{I}$, we must have:\n$$\n\\left. \\frac{\\partial \\hat{W}}{\\partial \\boldsymbol{C}} \\right|_{\\boldsymbol{C}=\\boldsymbol{I}} = \\boldsymbol{0}\n$$\nwhere $\\boldsymbol{0}$ is the second-order zero tensor.\n\nThe second Piola-Kirchhoff stress tensor $\\boldsymbol{S}$ is defined as $\\boldsymbol{S} := 2 \\frac{\\partial \\hat{W}}{\\partial \\boldsymbol{C}}$. By substituting the condition for the minimum of $\\hat{W}$, we evaluate $\\boldsymbol{S}$ for the state $\\boldsymbol{C}=\\boldsymbol{I}$:\n$$\n\\boldsymbol{S}(\\boldsymbol{C}=\\boldsymbol{I}) = 2 \\left. \\frac{\\partial \\hat{W}}{\\partial \\boldsymbol{C}} \\right|_{\\boldsymbol{C}=\\boldsymbol{I}} = 2 \\boldsymbol{0} = \\boldsymbol{0}\n$$\nThis demonstrates that in the stress-free reference configuration, the second Piola-Kirchhoff stress is zero, as expected from physical principles.\n\nNext, we must derive the relationship between the first Piola-Kirchhoff stress $\\boldsymbol{P}$ and the second Piola-Kirchhoff stress $\\boldsymbol{S}$. The definition for $\\boldsymbol{P}$ is $\\boldsymbol{P} := \\frac{\\partial W}{\\partial \\boldsymbol{F}}$. Given the functional dependence $W(\\boldsymbol{F}) = \\hat{W}(\\boldsymbol{C}(\\boldsymbol{F}))$, we apply the chain rule for differentiation. In index notation, this is:\n$$\nP_{ij} = \\frac{\\partial W}{\\partial F_{ij}} = \\sum_{k,l} \\frac{\\partial \\hat{W}}{\\partial C_{kl}} \\frac{\\partial C_{kl}}{\\partial F_{ij}}\n$$\nWe know from the definition of $\\boldsymbol{S}$ that $\\frac{\\partial \\hat{W}}{\\partial C_{kl}} = \\frac{1}{2} S_{kl}$. The right Cauchy-Green tensor components are $C_{kl} = \\sum_m F_{mk} F_{ml}$. We compute the derivative of $C_{kl}$ with respect to $F_{ij}$:\n$$\n\\frac{\\partial C_{kl}}{\\partial F_{ij}} = \\frac{\\partial}{\\partial F_{ij}} \\left( \\sum_m F_{mk} F_{ml} \\right) = \\sum_m \\left( \\frac{\\partial F_{mk}}{\\partial F_{ij}} F_{ml} + F_{mk} \\frac{\\partial F_{ml}}{\\partial F_{ij}} \\right)\n$$\nUsing the identity for the derivative of one tensor component with respect to another, $\\frac{\\partial F_{ab}}{\\partial F_{cd}} = \\delta_{ac} \\delta_{bd}$, where $\\delta$ is the Kronecker delta, we obtain:\n$$\n\\frac{\\partial C_{kl}}{\\partial F_{ij}} = \\sum_m \\left( (\\delta_{mi} \\delta_{kj}) F_{ml} + F_{mk} (\\delta_{mi} \\delta_{lj}) \\right) = \\delta_{kj} F_{il} + F_{ik} \\delta_{lj}\n$$\nSubstituting these results into the expression for $P_{ij}$:\n$$\nP_{ij} = \\sum_{k,l} \\left( \\frac{1}{2} S_{kl} \\right) (\\delta_{kj} F_{il} + F_{ik} \\delta_{lj}) = \\frac{1}{2} \\left( \\sum_{l} S_{jl} F_{il} + \\sum_{k} S_{kj} F_{ik} \\right)\n$$\nBecause $\\boldsymbol{S}$ is the gradient of a scalar potential with respect to a symmetric tensor $\\boldsymbol{C}$, $\\boldsymbol{S}$ must also be symmetric, i.e., $\\boldsymbol{S} = \\boldsymbol{S}^{\\top}$ or $S_{kj} = S_{jk}$. The expression for $P_{ij}$ can be written in tensor notation and simplified:\n$$\n\\boldsymbol{P} = \\frac{1}{2} (\\boldsymbol{F} \\boldsymbol{S}^{\\top} + \\boldsymbol{F} \\boldsymbol{S}) = \\frac{1}{2} (\\boldsymbol{F} \\boldsymbol{S} + \\boldsymbol{F} \\boldsymbol{S}) = \\boldsymbol{F} \\boldsymbol{S}\n$$\nThis is the fundamental relationship between the first and second Piola-Kirchhoff stresses.\n\nWe are asked to evaluate these quantities for a rigid rotation, where the deformation gradient is $\\boldsymbol{F} = \\boldsymbol{Q}$, with $\\boldsymbol{Q}$ being a proper orthogonal tensor, $\\boldsymbol{Q} \\in \\mathrm{SO}(3)$. For this deformation, the right Cauchy-Green tensor is:\n$$\n\\boldsymbol{C} = \\boldsymbol{F}^{\\top} \\boldsymbol{F} = \\boldsymbol{Q}^{\\top} \\boldsymbol{Q}\n$$\nBy the definition of an orthogonal tensor, $\\boldsymbol{Q}^{\\top} \\boldsymbol{Q} = \\boldsymbol{I}$. Thus, a rigid body rotation corresponds to $\\boldsymbol{C}=\\boldsymbol{I}$. As established previously, for $\\boldsymbol{C}=\\boldsymbol{I}$, the second Piola-Kirchhoff stress is zero:\n$$\n\\boldsymbol{S} = \\boldsymbol{S}(\\boldsymbol{C}=\\boldsymbol{I}) = \\boldsymbol{0}\n$$\nUsing the derived relation $\\boldsymbol{P}=\\boldsymbol{F}\\boldsymbol{S}$, we find the corresponding first Piola-Kirchhoff stress:\n$$\n\\boldsymbol{P} = \\boldsymbol{F} \\boldsymbol{S} = \\boldsymbol{Q} \\boldsymbol{0} = \\boldsymbol{0}\n$$\nBoth stress tensors are identically zero for a rigid rotation of a body from a stress-free state.\n\nThe final task is to compute the scalar diagnostic $R$, defined as:\n$$\nR := \\|\\boldsymbol{P}\\|_{F}^{2} + \\|\\boldsymbol{S}\\|_{F}^{2}\n$$\nwhere $\\|\\boldsymbol{A}\\|_{F}^{2} := \\boldsymbol{A} : \\boldsymbol{A} = \\sum_{i,j} A_{ij}^2$ is the squared Frobenius norm. For the case $\\boldsymbol{F}=\\boldsymbol{Q}$, we have $\\boldsymbol{P} = \\boldsymbol{0}$ and $\\boldsymbol{S} = \\boldsymbol{0}$. The Frobenius norm of a zero tensor is $0$.\n$$\n\\|\\boldsymbol{P}\\|_{F}^{2} = \\|\\boldsymbol{0}\\|_{F}^{2} = \\boldsymbol{0}:\\boldsymbol{0} = 0\n$$\n$$\n\\|\\boldsymbol{S}\\|_{F}^{2} = \\|\\boldsymbol{0}\\|_{F}^{2} = \\boldsymbol{0}:\\boldsymbol{0} = 0\n$$\nTherefore, the value of $R$ is:\n$$\nR = 0 + 0 = 0\n$$\n\nThe interpretation of this result is that any rigid body motion, being a deformation-free (strain-free) process, must produce zero stress in a hyperelastic material. In computational mechanics, specifically the finite element method, this serves as a fundamental verification test. When a modeled body or a patch of elements is subjected to a pure rotation, a correctly implemented hyperelastic material model must return zero (or numerically negligible) stress values. A non-zero result for $R$ in such a test, often called a \"rigid motion test\", indicates a severe flaw in the numerical implementation, such as a failure to satisfy the principle of material frame-indifference. Passing this test is a necessary condition for a consistent and reliable finite element code.", "answer": "$$\n\\boxed{0}\n$$", "id": "2587933"}, {"introduction": "In computational mechanics, ensuring the correctness of an implementation is as important as the underlying theory. This practice introduces the \"Taylor test,\" a powerful and universal numerical technique to verify that an implementation of a stress tensor is consistent with its parent strain energy function [@problem_id:2587909]. You will derive the first Piola-Kirchhoff stress $\\boldsymbol{P}$ from a given energy potential $W$ and then confirm that the analytical directional derivative, $\\boldsymbol{P} : \\delta\\boldsymbol{F}$, matches a finite-difference approximation. This exercise provides essential hands-on experience in the verification and validation practices that ensure the reliability of finite element simulations.", "problem": "Let $\\boldsymbol{F} \\in \\mathbb{R}^{d \\times d}$ denote the deformation gradient mapping from a reference configuration to a current configuration, with $d \\in \\{2,3\\}$. Consider a compressible hyperelastic material with strain energy density $W(\\boldsymbol{F})$, where $W$ depends only on $\\boldsymbol{F}$. The First Piola–Kirchhoff stress (sometimes referred to as the nominal stress) is defined as the derivative of the energy with respect to the deformation gradient, that is $\\boldsymbol{P}(\\boldsymbol{F}) = \\dfrac{\\partial W(\\boldsymbol{F})}{\\partial \\boldsymbol{F}}$, and the directional derivative of the energy in the direction $\\delta \\boldsymbol{F}$ satisfies $\\delta W(\\boldsymbol{F})[\\delta \\boldsymbol{F}] = \\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}$, where the Frobenius product is $\\boldsymbol{A} : \\boldsymbol{B} = \\sum_{i,j} A_{ij} B_{ij}$. In a finite element method setting, the energy balance consistency of an implementation of $\\boldsymbol{P}$ can be tested by verifying that $\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}$ matches a finite difference directional derivative of $W(\\boldsymbol{F})$ along $\\delta \\boldsymbol{F}$.\n\nStart from first principles and implement the following energy density function $W(\\boldsymbol{F})$ for a compressible Neo-Hookean solid:\n$$\nW(\\boldsymbol{F}) = \\frac{\\mu}{2}\\left(I_1(\\boldsymbol{C}) - d\\right) - \\mu \\ln J + \\frac{\\kappa}{2}\\left(\\ln J\\right)^2,\n$$\nwhere $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$, $I_1(\\boldsymbol{C}) = \\mathrm{tr}(\\boldsymbol{C})$, $J = \\det(\\boldsymbol{F})$, $\\mu > 0$ is the shear modulus, and $\\kappa > 0$ is the bulk modulus. You must derive $\\boldsymbol{P}(\\boldsymbol{F})$ from the above definition of $W(\\boldsymbol{F})$ using the chain rule and fundamental matrix calculus identities; you must not assume any pre-known stress formula.\n\nNumerically verify the energy balance by comparing the analytical directional derivative $\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}$ with a central finite difference approximation of the directional derivative:\n$$\nD^{\\mathrm{FD}}W(\\boldsymbol{F})[\\delta \\boldsymbol{F}] = \\frac{W\\!\\left(\\boldsymbol{F} + \\varepsilon\\,\\delta \\boldsymbol{F}\\right) - W\\!\\left(\\boldsymbol{F} - \\varepsilon\\,\\delta \\boldsymbol{F}\\right)}{2\\,\\varepsilon}.\n$$\nFor each test case, compute the symmetric relative error\n$$\n\\mathrm{err} = \\frac{\\left|\\,\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F} - D^{\\mathrm{FD}}W(\\boldsymbol{F})[\\delta \\boldsymbol{F}]\\,\\right|}{\\left|\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}\\right| + \\left|D^{\\mathrm{FD}}W(\\boldsymbol{F})[\\delta \\boldsymbol{F}]\\right| + 10^{-12}},\n$$\nand return a boolean indicating whether $\\mathrm{err} \\leq 10^{-6}$.\n\nYour program must implement $W(\\boldsymbol{F})$ from the given definition, derive and implement $\\boldsymbol{P}(\\boldsymbol{F})$ from first principles, and then, for each of the test cases below, compute the boolean pass/fail according to the above criterion. No physical units are required in this problem. All angles, if any appear in your own derivation, must be treated purely symbolically and no angle unit is needed.\n\nUse the following test suite. Each case specifies $\\boldsymbol{F}$, $\\delta \\boldsymbol{F}$, $\\mu$, $\\kappa$, and $\\varepsilon$. All matrices are given explicitly.\n\n- Case $1$ ($d = 3$):\n  $$\n  F = \\begin{bmatrix}\n  1.1 & 0.2 & -0.1 \\\\\n  0.0 & 0.9 & 0.15 \\\\\n  0.05 & -0.08 & 1.05\n  \\end{bmatrix},\\quad\n  \\delta F = \\begin{bmatrix}\n  0.3 & -0.1 & 0.2 \\\\\n  -0.05 & 0.25 & -0.15 \\\\\n  0.1 & -0.2 & 0.05\n  \\end{bmatrix},\\quad\n  \\mu = 40.0,\\quad \\kappa = 120.0,\\quad \\varepsilon = 10^{-7}.\n  $$\n\n- Case $2$ ($d = 3$):\n  $$\n  F = \\begin{bmatrix}\n  1.3 & 0.3 & 0.0 \\\\\n  0.1 & 0.8 & 0.2 \\\\\n  0.0 & -0.1 & 1.2\n  \\end{bmatrix},\\quad\n  \\delta F = \\begin{bmatrix}\n  -0.2 & 0.05 & 0.1 \\\\\n  0.15 & -0.25 & 0.05 \\\\\n  -0.05 & 0.1 & -0.15\n  \\end{bmatrix},\\quad\n  \\mu = 25.0,\\quad \\kappa = 80.0,\\quad \\varepsilon = 10^{-7}.\n  $$\n\n- Case $3$ ($d = 2$):\n  $$\n  F = \\begin{bmatrix}\n  0.85 & 0.2 \\\\\n  -0.1 & 1.3\n  \\end{bmatrix},\\quad\n  \\delta F = \\begin{bmatrix}\n  0.1 & -0.3 \\\\\n  0.25 & 0.15\n  \\end{bmatrix},\\quad\n  \\mu = 40.0,\\quad \\kappa = 120.0,\\quad \\varepsilon = 10^{-7}.\n  $$\n\n- Case $4$ ($d = 3$):\n  $$\n  F = \\begin{bmatrix}\n  0.85 & 0.0 & 0.0 \\\\\n  0.0 & 0.85 & 0.0 \\\\\n  0.0 & 0.0 & 0.85\n  \\end{bmatrix},\\quad\n  \\delta F = \\begin{bmatrix}\n  -0.1 & 0.05 & 0.0 \\\\\n  0.0 & 0.1 & -0.05 \\\\\n  0.02 & 0.0 & -0.02\n  \\end{bmatrix},\\quad\n  \\mu = 10.0,\\quad \\kappa = 300.0,\\quad \\varepsilon = 10^{-7}.\n  $$\n\n- Case $5$ ($d = 2$):\n  $$\n  F = \\begin{bmatrix}\n  1.0 & 0.5 \\\\\n  -0.4 & 1.1\n  \\end{bmatrix},\\quad\n  \\delta F = \\begin{bmatrix}\n  0.5 & -0.2 \\\\\n  0.3 & 0.4\n  \\end{bmatrix},\\quad\n  \\mu = 60.0,\\quad \\kappa = 150.0,\\quad \\varepsilon = 10^{-7}.\n  $$\n\nRequired output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[r_1,r_2,r_3,r_4,r_5]$, where each $r_i$ is a boolean value indicating whether the corresponding case passed the energy balance test. No additional text should be printed.", "solution": "An assessment of the problem statement is the mandatory first step.\n\n**Step 1: Extract Givens**\n- Deformation gradient: $\\boldsymbol{F} \\in \\mathbb{R}^{d \\times d}$, with $d \\in \\{2,3\\}$.\n- Strain energy density function: $W(\\boldsymbol{F}) = \\frac{\\mu}{2}\\left(I_1(\\boldsymbol{C}) - d\\right) - \\mu \\ln J + \\frac{\\kappa}{2}\\left(\\ln J\\right)^2$.\n- Right Cauchy-Green deformation tensor: $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$.\n- First invariant of $\\boldsymbol{C}$: $I_1(\\boldsymbol{C}) = \\mathrm{tr}(\\boldsymbol{C})$.\n- Jacobian of deformation: $J = \\det(\\boldsymbol{F})$.\n- Material parameters: shear modulus $\\mu > 0$, bulk modulus $\\kappa > 0$.\n- First Piola-Kirchhoff stress tensor definition: $\\boldsymbol{P}(\\boldsymbol{F}) = \\dfrac{\\partial W(\\boldsymbol{F})}{\\partial \\boldsymbol{F}}$.\n- Directional derivative relation: $\\delta W(\\boldsymbol{F})[\\delta \\boldsymbol{F}] = \\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}$.\n- Finite difference approximation for the directional derivative: $D^{\\mathrm{FD}}W(\\boldsymbol{F})[\\delta \\boldsymbol{F}] = \\frac{W\\!\\left(\\boldsymbol{F} + \\varepsilon\\,\\delta \\boldsymbol{F}\\right) - W\\!\\left(\\boldsymbol{F} - \\varepsilon\\,\\delta \\boldsymbol{F}\\right)}{2\\,\\varepsilon}$.\n- Symmetric relative error formula: $\\mathrm{err} = \\frac{\\left|\\,\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F} - D^{\\mathrm{FD}}(W)[\\delta \\boldsymbol{F}]\\,\\right|}{\\left|\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}\\right| + \\left|D^{\\mathrm{FD}}(W)[\\delta \\boldsymbol{F}]\\right| + 10^{-12}}$.\n- Pass/fail criterion: $\\mathrm{err} \\leq 10^{-6}$.\n- Five test cases are provided, each with specified matrices $\\boldsymbol{F}$, $\\delta \\boldsymbol{F}$ and scalar parameters $\\mu$, $\\kappa$, $\\varepsilon$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is subjected to scrutiny against the validation criteria.\n- **Scientifically Grounded**: The problem is rooted in the established field of continuum mechanics. The compressible Neo-Hookean model is a standard hyperelastic material model. The definitions of the deformation gradient $\\boldsymbol{F}$, First Piola-Kirchhoff stress $\\boldsymbol{P}$, and the verification of the energy balance via a Taylor test are fundamental concepts in computational mechanics. The problem is scientifically sound.\n- **Well-Posed**: The problem is clearly defined. It requires the derivation of a specific quantity, $\\boldsymbol{P}(\\boldsymbol{F})$, and its numerical verification against a well-defined benchmark. All necessary data and formulas are provided. A unique and numerically stable result (a boolean value for each test case) is expected.\n- **Objective**: The problem is stated in precise mathematical language, free from any subjectivity or ambiguity.\n- **Completeness and Consistency**: The problem is self-contained. There are no missing definitions or contradictory constraints. The data provided for the test cases is complete.\n- **Other Flaws**: The problem is not trivial, as it requires a correct derivation using matrix calculus. It is not based on any unrealistic premises or faulty logic.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. It is a standard and well-posed exercise in continuum mechanics. We proceed to the solution.\n\nThe objective is to derive the First Piola-Kirchhoff stress tensor $\\boldsymbol{P}(\\boldsymbol{F})$ from the given strain energy density $W(\\boldsymbol{F})$ and subsequently verify the correctness of the derived expression numerically. The derivation must proceed from first principles, utilizing the calculus of variations.\n\nThe strain energy density is given as:\n$$\nW(\\boldsymbol{F}) = \\frac{\\mu}{2}\\left(I_1(\\boldsymbol{C}) - d\\right) - \\mu \\ln J + \\frac{\\kappa}{2}\\left(\\ln J\\right)^2\n$$\nwhere $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$, $I_1(\\boldsymbol{C}) = \\mathrm{tr}(\\boldsymbol{C})$, and $J = \\det(\\boldsymbol{F})$.\n\nThe First Piola-Kirchhoff stress $\\boldsymbol{P}$ is the derivative of $W$ with respect to $\\boldsymbol{F}$, formally defined through the directional derivative (or Gâteaux derivative) of $W$ in an arbitrary direction $\\delta \\boldsymbol{F}$:\n$$\n\\delta W(\\boldsymbol{F})[\\delta \\boldsymbol{F}] = \\left.\\frac{d}{d\\alpha} W(\\boldsymbol{F} + \\alpha\\,\\delta \\boldsymbol{F})\\right|_{\\alpha=0} = \\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}\n$$\nwhere ':' denotes the Frobenius inner product of matrices, $\\boldsymbol{A}:\\boldsymbol{B} = \\mathrm{tr}(\\boldsymbol{A}^{\\mathsf{T}}\\boldsymbol{B})$.\n\nWe compute the variation $\\delta W$ by applying the chain rule. Let us decompose $W$ into two parts for clarity:\n$W(\\boldsymbol{F}) = W_{iso}(\\boldsymbol{F}) + W_{vol}(\\boldsymbol{F})$, where\n$W_{iso}(\\boldsymbol{F}) = \\frac{\\mu}{2}(\\mathrm{tr}(\\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}) - d)$ is the isochoric part, and\n$W_{vol}(\\boldsymbol{F}) = -\\mu \\ln(\\det \\boldsymbol{F}) + \\frac{\\kappa}{2}(\\ln(\\det \\boldsymbol{F}))^2$ is the volumetric part.\nThe total variation is $\\delta W = \\delta W_{iso} + \\delta W_{vol}$.\n\nFirst, we find the variation of the isochoric part, $\\delta W_{iso}$.\nThe variation of $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$ is:\n$$\n\\delta \\boldsymbol{C} = \\delta(\\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}) = (\\delta \\boldsymbol{F})^{\\mathsf{T}}\\boldsymbol{F} + \\boldsymbol{F}^{\\mathsf{T}}(\\delta \\boldsymbol{F})\n$$\nThe variation of the first invariant $I_1(\\boldsymbol{C}) = \\mathrm{tr}(\\boldsymbol{C})$ is:\n$$\n\\delta I_1 = \\delta(\\mathrm{tr}(\\boldsymbol{C})) = \\mathrm{tr}(\\delta \\boldsymbol{C}) = \\mathrm{tr}((\\delta \\boldsymbol{F})^{\\mathsf{T}}\\boldsymbol{F} + \\boldsymbol{F}^{\\mathsf{T}}(\\delta \\boldsymbol{F})) = \\mathrm{tr}((\\delta \\boldsymbol{F})^{\\mathsf{T}}\\boldsymbol{F}) + \\mathrm{tr}(\\boldsymbol{F}^{\\mathsf{T}}(\\delta \\boldsymbol{F}))\n$$\nUsing the cyclic property of the trace, $\\mathrm{tr}(AB) = \\mathrm{tr}(BA)$, and the property $\\mathrm{tr}(A^{\\mathsf{T}}) = \\mathrm{tr}(A)$, we have $\\mathrm{tr}((\\delta \\boldsymbol{F})^{\\mathsf{T}}\\boldsymbol{F}) = \\mathrm{tr}(\\boldsymbol{F}^{\\mathsf{T}}\\delta \\boldsymbol{F})$. Thus:\n$$\n\\delta I_1 = 2\\,\\mathrm{tr}(\\boldsymbol{F}^{\\mathsf{T}}(\\delta \\boldsymbol{F})) = 2\\,(\\boldsymbol{F} : \\delta \\boldsymbol{F})\n$$\nThe variation of $W_{iso}$ is then:\n$$\n\\delta W_{iso} = \\frac{\\partial W_{iso}}{\\partial I_1} \\delta I_1 = \\frac{\\mu}{2} \\delta I_1 = \\frac{\\mu}{2} (2\\,\\boldsymbol{F} : \\delta \\boldsymbol{F}) = \\mu \\boldsymbol{F} : \\delta \\boldsymbol{F}\n$$\nBy comparing this to the definition $\\delta W_{iso} = \\boldsymbol{P}_{iso} : \\delta \\boldsymbol{F}$, we identify the isochoric part of the stress:\n$$\n\\boldsymbol{P}_{iso}(\\boldsymbol{F}) = \\mu \\boldsymbol{F}\n$$\n\nNext, we find the variation of the volumetric part, $\\delta W_{vol}$.\nLet $J = \\det(\\boldsymbol{F})$. The variation of $W_{vol}$ with respect to $J$ is:\n$$\n\\frac{\\partial W_{vol}}{\\partial J} = -\\frac{\\mu}{J} + \\frac{\\kappa}{2} \\cdot 2 (\\ln J) \\cdot \\frac{1}{J} = \\frac{\\kappa \\ln J - \\mu}{J}\n$$\nThe variation of $W_{vol}$ is given by the chain rule: $\\delta W_{vol} = \\frac{\\partial W_{vol}}{\\partial J} \\delta J$.\nThe variation of the determinant, $\\delta J$, is given by Jacobi's formula:\n$$\n\\delta J = J\\,\\mathrm{tr}(\\boldsymbol{F}^{-1} \\delta \\boldsymbol{F})\n$$\nUsing the identity $\\mathrm{tr}(A B) = (A^{\\mathsf{T}} : B)$, we can rewrite this as:\n$$\n\\delta J = J\\,(\\boldsymbol{F}^{-\\mathsf{T}} : \\delta \\boldsymbol{F})\n$$\nSubstituting these expressions into the variation of $W_{vol}$:\n$$\n\\delta W_{vol} = \\left(\\frac{\\kappa \\ln J - \\mu}{J}\\right) \\left(J\\,(\\boldsymbol{F}^{-\\mathsf{T}} : \\delta \\boldsymbol{F})\\right) = (\\kappa \\ln J - \\mu) \\boldsymbol{F}^{-\\mathsf{T}} : \\delta \\boldsymbol{F}\n$$\nBy comparing this to the definition $\\delta W_{vol} = \\boldsymbol{P}_{vol} : \\delta \\boldsymbol{F}$, we identify the volumetric part of the stress:\n$$\n\\boldsymbol{P}_{vol}(\\boldsymbol{F}) = (\\kappa \\ln J - \\mu) \\boldsymbol{F}^{-\\mathsf{T}}\n$$\n\nThe total First Piola-Kirchhoff stress tensor is the sum of the isochoric and volumetric parts:\n$$\n\\boldsymbol{P}(\\boldsymbol{F}) = \\boldsymbol{P}_{iso}(\\boldsymbol{F}) + \\boldsymbol{P}_{vol}(\\boldsymbol{F}) = \\mu \\boldsymbol{F} + (\\kappa \\ln J - \\mu) \\boldsymbol{F}^{-\\mathsf{T}}\n$$\nThis is the analytical expression for the stress tensor that must be implemented.\n\nFor the numerical verification, we implement this derived formula for $\\boldsymbol{P}(\\boldsymbol{F})$ and compute the analytical directional derivative $\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}$. We then compare this value to a numerical approximation using a central finite difference scheme, as specified:\n$$\nD^{\\mathrm{FD}}W(\\boldsymbol{F})[\\delta \\boldsymbol{F}] = \\frac{W\\!\\left(\\boldsymbol{F} + \\varepsilon\\,\\delta \\boldsymbol{F}\\right) - W\\!\\left(\\boldsymbol{F} - \\varepsilon\\,\\delta \\boldsymbol{F}\\right)}{2\\,\\varepsilon}\n$$\nThe symmetric relative error is computed for each test case:\n$$\n\\mathrm{err} = \\frac{\\left|\\,\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F} - D^{\\mathrm{FD}}W(\\boldsymbol{F})[\\delta \\boldsymbol{F}]\\,\\right|}{\\left|\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}\\right| + \\left|D^{\\mathrm{FD}}W(\\boldsymbol{F})[\\delta \\boldsymbol{F}]\\right| + 10^{-12}}\n$$\nA test case passes if this error is less than or equal to the tolerance $\\mathrm{err} \\leq 10^{-6}$. The implementation will proceed with these derived formulas and procedures.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by deriving and verifying the First Piola-Kirchhoff stress\n    for a compressible Neo-Hookean material model.\n    \"\"\"\n\n    test_cases = [\n        # Case 1\n        {\n            \"F\": np.array([\n                [1.1, 0.2, -0.1],\n                [0.0, 0.9, 0.15],\n                [0.05, -0.08, 1.05]\n            ]),\n            \"delta_F\": np.array([\n                [0.3, -0.1, 0.2],\n                [-0.05, 0.25, -0.15],\n                [0.1, -0.2, 0.05]\n            ]),\n            \"mu\": 40.0, \"kappa\": 120.0, \"epsilon\": 1e-7\n        },\n        # Case 2\n        {\n            \"F\": np.array([\n                [1.3, 0.3, 0.0],\n                [0.1, 0.8, 0.2],\n                [0.0, -0.1, 1.2]\n            ]),\n            \"delta_F\": np.array([\n                [-0.2, 0.05, 0.1],\n                [0.15, -0.25, 0.05],\n                [-0.05, 0.1, -0.15]\n            ]),\n            \"mu\": 25.0, \"kappa\": 80.0, \"epsilon\": 1e-7\n        },\n        # Case 3\n        {\n            \"F\": np.array([\n                [0.85, 0.2],\n                [-0.1, 1.3]\n            ]),\n            \"delta_F\": np.array([\n                [0.1, -0.3],\n                [0.25, 0.15]\n            ]),\n            \"mu\": 40.0, \"kappa\": 120.0, \"epsilon\": 1e-7\n        },\n        # Case 4\n        {\n            \"F\": np.array([\n                [0.85, 0.0, 0.0],\n                [0.0, 0.85, 0.0],\n                [0.0, 0.0, 0.85]\n            ]),\n            \"delta_F\": np.array([\n                [-0.1, 0.05, 0.0],\n                [0.0, 0.1, -0.05],\n                [0.02, 0.0, -0.02]\n            ]),\n            \"mu\": 10.0, \"kappa\": 300.0, \"epsilon\": 1e-7\n        },\n        # Case 5\n        {\n            \"F\": np.array([\n                [1.0, 0.5],\n                [-0.4, 1.1]\n            ]),\n            \"delta_F\": np.array([\n                [0.5, -0.2],\n                [0.3, 0.4]\n            ]),\n            \"mu\": 60.0, \"kappa\": 150.0, \"epsilon\": 1e-7\n        }\n    ]\n\n    def calculate_W(F, mu, kappa):\n        \"\"\"\n        Computes the strain energy density W(F).\n        \"\"\"\n        d = F.shape[0]\n        C = F.T @ F\n        I1_C = np.trace(C)\n        J = np.linalg.det(F)\n\n        # A valid deformation must have J > 0.\n        if J <= 0:\n            # Return a large value to indicate unphysical deformation.\n            # This is not strictly necessary for the given test cases but is good practice.\n            return np.inf\n\n        W = (mu / 2) * (I1_C - d) - mu * np.log(J) + (kappa / 2) * (np.log(J))**2\n        return W\n\n    def calculate_P(F, mu, kappa):\n        \"\"\"\n        Computes the First Piola-Kirchhoff stress tensor P(F) using the derived formula.\n        \"\"\"\n        J = np.linalg.det(F)\n        # It's an established result that d(det(A))/dA = det(A) * A^(-T)\n        F_inv_T = np.linalg.inv(F).T\n        P = mu * F + (kappa * np.log(J) - mu) * F_inv_T\n        return P\n\n    results = []\n    for case in test_cases:\n        F, delta_F, mu, kappa, epsilon = case[\"F\"], case[\"delta_F\"], case[\"mu\"], case[\"kappa\"], case[\"epsilon\"]\n\n        # 1. Analytical directional derivative: dW_analytic = P(F) : delta_F\n        P = calculate_P(F, mu, kappa)\n        dW_analytic = np.sum(P * delta_F)  # Frobenius inner product\n\n        # 2. Finite difference approximation of the directional derivative\n        F_plus = F + epsilon * delta_F\n        F_minus = F - epsilon * delta_F\n        \n        W_plus = calculate_W(F_plus, mu, kappa)\n        W_minus = calculate_W(F_minus, mu, kappa)\n\n        dW_fd = (W_plus - W_minus) / (2 * epsilon)\n\n        # 3. Compute symmetric relative error\n        abs_diff = np.abs(dW_analytic - dW_fd)\n        denominator = np.abs(dW_analytic) + np.abs(dW_fd) + 1e-12\n        err = abs_diff / denominator\n\n        # 4. Check against tolerance\n        passed = err <= 1e-6\n        results.append(passed)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2587909"}]}