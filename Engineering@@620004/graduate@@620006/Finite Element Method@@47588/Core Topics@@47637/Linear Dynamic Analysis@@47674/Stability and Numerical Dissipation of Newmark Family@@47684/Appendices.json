{"hands_on_practices": [{"introduction": "The first step in mastering a numerical method is to thoroughly understand the properties of its key variants. This exercise focuses on the linear acceleration method, a classic member of the Newmark family defined by parameters $(\\beta, \\gamma) = (1/6, 1/2)$. By deriving its dispersion relation and stability limit from first principles, you will gain a fundamental understanding of how a time integration scheme can introduce phase errors and what constraints on the time step $\\Delta t$ are necessary to ensure a stable simulation [@problem_id:2598061].", "problem": "Consider the undamped, linear, semi-discrete elastodynamic model arising from the finite element method (FEM): \n$$\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0},$$ \nwith symmetric positive-definite mass matrix $\\mathbf{M}$ and stiffness matrix $\\mathbf{K}$. By standard modal analysis, each mass-normalized mode $q(t)$ satisfies the single-degree-of-freedom (SDOF) ordinary differential equation (ODE) \n$$\\ddot{q}(t) + \\omega^{2} q(t) = 0,$$ \nwhere $\\omega$ is the exact circular frequency of the mode. Apply the Newmark family with linear-acceleration parameters $(\\beta,\\gamma)=(1/6,1/2)$ and a constant time step $\\Delta t$ to this SDOF modal equation.\n\nStarting only from the semi-discrete ODE and the definition of the Newmark family with $(\\beta,\\gamma)=(1/6,1/2)$, derive the one-step amplification relation for the discrete modal displacement $\\{q_{n}\\}_{n\\in\\mathbb{Z}}$ governed by this Newmark scheme. Then use it to:\n\n- Derive the discrete dispersion relation, i.e., the functional relation between the exact nondimensional frequency $\\rho := \\omega\\,\\Delta t$ and the numerical phase increment per step $\\bar{\\rho}$ (in radians), under the ansatz $q_{n} \\propto \\exp(\\mathrm{i}\\, n\\, \\bar{\\rho})$.\n- Determine the critical time step $\\Delta t_{c}$ for linear stability of this mode, defined as the largest $\\Delta t$ such that the spectral radius of the one-step amplification mapping does not exceed $1$.\n- Assess the leading-order phase-error of the method relative to the exact dynamics as $\\Delta t \\to 0$, defined by \n$$\\frac{\\bar{\\omega} - \\omega}{\\omega}, \\quad \\text{with} \\quad \\bar{\\omega} := \\frac{\\bar{\\rho}}{\\Delta t},$$\nexpressed as an asymptotic series truncated at the first nonzero term in powers of $\\rho$.\n\nProvide your final answer as a row matrix with three entries, in the following order and forms: \n(1) the analytic expression for $\\bar{\\rho}$ in terms of $\\rho$ (in radians), \n(2) the analytic expression for $\\Delta t_{c}$ in terms of $\\omega$ (express the time in the same units as $\\Delta t$ would have), and \n(3) the leading-order analytic expression for the relative phase error in terms of $\\rho$ (dimensionless). Do not include units in the final boxed answer. No numerical rounding is required.", "solution": "The problem statement presented is a standard, well-posed exercise in the analysis of numerical methods for structural dynamics. It is scientifically grounded, objective, and self-contained. All provided information, including the governing ordinary differential equation (ODE), the specific Newmark parameters $(\\beta, \\gamma)$, and the definitions of stability and phase error, are standard and correct within the field of computational mechanics. The problem is therefore deemed **valid**, and I will proceed with its solution.\n\nThe motion of a single mass-normalized mode is governed by the single-degree-of-freedom (SDOF) equation:\n$$\n\\ddot{q}(t) + \\omega^2 q(t) = 0\n$$\nwhere $\\omega$ is the exact circular frequency of the mode. We apply the Newmark family of time integration algorithms. The general update rules for displacement $q$ and velocity $\\dot{q}$ from time step $n$ to $n+1$ are:\n$$\nq_{n+1} = q_n + \\Delta t \\dot{q}_n + (\\Delta t)^2 \\left[ \\left(\\frac{1}{2} - \\beta\\right) \\ddot{q}_n + \\beta \\ddot{q}_{n+1} \\right]\n$$\n$$\n\\dot{q}_{n+1} = \\dot{q}_n + \\Delta t \\left[ (1 - \\gamma) \\ddot{q}_n + \\gamma \\ddot{q}_{n+1} \\right]\n$$\nThe problem specifies the linear acceleration method, for which the parameters are $(\\beta, \\gamma) = (1/6, 1/2)$. The parameter $\\gamma=1/2$ ensures that the method is second-order accurate and possesses no numerical dissipation. For the special case of $\\gamma=1/2$, the Newmark updates can be combined into a single, three-term recurrence relation for the discrete displacements $\\{q_n\\}$. Evaluating the discrete equation of motion $\\ddot{q}_{n} + \\omega^2 q_{n} = 0$ at time steps $n-1$, $n$, and $n+1$, and substituting into the well-known three-point difference formula for the Newmark method yields:\n$$\nq_{n+1} - 2q_n + q_{n-1} = (\\Delta t)^2 \\left[ \\beta \\ddot{q}_{n+1} + (1-2\\beta) \\ddot{q}_n + \\beta \\ddot{q}_{n-1} \\right]\n$$\nWe enforce the discrete equation of motion at each time step, i.e., $\\ddot{q}_k = -\\omega^2 q_k$ for $k \\in \\{n-1, n, n+1\\}$. Substituting this into the recurrence relation gives:\n$$\nq_{n+1} - 2q_n + q_{n-1} = -(\\omega \\Delta t)^2 \\left[ \\beta q_{n+1} + (1-2\\beta) q_n + \\beta q_{n-1} \\right]\n$$\nIntroducing the nondimensional frequency $\\rho := \\omega \\Delta t$, we rearrange the terms:\n$$\n(1 + \\beta \\rho^2) q_{n+1} - (2 - (1 - 2\\beta)\\rho^2) q_n + (1 + \\beta \\rho^2) q_{n-1} = 0\n$$\nTo find the discrete dispersion relation, we substitute the ansatz $q_n = C \\exp(\\mathrm{i} n \\bar{\\rho})$, where $C$ is a constant and $\\bar{\\rho}$ is the numerical phase increment per step.\n$$\n(1 + \\beta \\rho^2) \\exp(\\mathrm{i} (n+1) \\bar{\\rho}) - (2 - (1 - 2\\beta)\\rho^2) \\exp(\\mathrm{i} n \\bar{\\rho}) + (1 + \\beta \\rho^2) \\exp(\\mathrm{i} (n-1) \\bar{\\rho}) = 0\n$$\nDividing by $C \\exp(\\mathrm{i} n \\bar{\\rho})$ and using Euler's formula $\\exp(\\mathrm{i}\\bar{\\rho}) + \\exp(-\\mathrm{i}\\bar{\\rho}) = 2\\cos(\\bar{\\rho})$, we obtain:\n$$\n(1 + \\beta \\rho^2) (\\exp(\\mathrm{i}\\bar{\\rho}) + \\exp(-\\mathrm{i}\\bar{\\rho})) = 2 - (1 - 2\\beta)\\rho^2\n$$\n$$\n2(1 + \\beta \\rho^2) \\cos(\\bar{\\rho}) = 2 - (1 - 2\\beta)\\rho^2\n$$\n$$\n\\cos(\\bar{\\rho}) = \\frac{1 - (\\frac{1}{2} - \\beta)\\rho^2}{1 + \\beta \\rho^2}\n$$\nFor the linear acceleration method, $\\beta = 1/6$. Substituting this value:\n$$\n\\cos(\\bar{\\rho}) = \\frac{1 - (\\frac{1}{2} - \\frac{1}{6})\\rho^2}{1 + \\frac{1}{6}\\rho^2} = \\frac{1 - \\frac{1}{3}\\rho^2}{1 + \\frac{1}{6}\\rho^2}\n$$\nSolving for $\\bar{\\rho}$ gives the first required result, the discrete dispersion relation:\n$$\n\\bar{\\rho} = \\arccos\\left(\\frac{1 - \\frac{\\rho^2}{3}}{1 + \\frac{\\rho^2}{6}}\\right)\n$$\n\nNext, we determine the linear stability limit. A necessary and sufficient condition for stability of a non-dissipative method ($\\gamma=1/2$) is that the eigenvalues of its amplification matrix lie on the unit circle. This is equivalent to requiring the value of $\\cos(\\bar{\\rho})$ to be real and within the interval $[-1, 1]$.\n$$\n-1 \\le \\frac{1 - \\frac{\\rho^2}{3}}{1 + \\frac{\\rho^2}{6}} \\le 1\n$$\nSince $\\rho^2 = (\\omega \\Delta t)^2 \\ge 0$, the denominator $1 + \\rho^2/6$ is always positive. We can analyze the two inequalities separately.\nThe right inequality:\n$$\n1 - \\frac{\\rho^2}{3} \\le 1 + \\frac{\\rho^2}{6} \\implies -\\frac{\\rho^2}{3} \\le \\frac{\\rho^2}{6} \\implies 0 \\le \\frac{\\rho^2}{2}\n$$\nThis is true for any real $\\rho$.\nThe left inequality sets the stability limit:\n$$\n-1 \\le \\frac{1 - \\frac{\\rho^2}{3}}{1 + \\frac{\\rho^2}{6}} \\implies -(1 + \\frac{\\rho^2}{6}) \\le 1 - \\frac{\\rho^2}{3}\n$$\n$$\n-1 - \\frac{\\rho^2}{6} \\le 1 - \\frac{\\rho^2}{3} \\implies \\frac{\\rho^2}{3} - \\frac{\\rho^2}{6} \\le 2 \\implies \\frac{\\rho^2}{6} \\le 2 \\implies \\rho^2 \\le 12\n$$\nThe stability limit is thus $\\rho_{crit} = \\sqrt{12} = 2\\sqrt{3}$.\nThe critical time step $\\Delta t_c$ is found from $\\rho_{crit} = \\omega \\Delta t_c$:\n$$\n\\Delta t_c = \\frac{2\\sqrt{3}}{\\omega}\n$$\n\nFinally, we assess the leading-order phase error for small time steps, i.e., as $\\rho = \\omega \\Delta t \\to 0$. The relative phase error is defined as $(\\bar{\\omega} - \\omega)/\\omega$, which is equivalent to $(\\bar{\\rho}/\\rho) - 1$.\nWe expand both sides of the dispersion relation $\\cos(\\bar{\\rho}) = (1 - \\rho^2/3) / (1 + \\rho^2/6)$ in Taylor series around $\\rho=0$.\nThe left side: $\\cos(\\bar{\\rho}) = 1 - \\frac{\\bar{\\rho}^2}{2} + \\frac{\\bar{\\rho}^4}{24} - O(\\bar{\\rho}^6)$.\nThe right side, using the geometric series $(1+x)^{-1} = 1 - x + x^2 - \\dots$:\n$$\n\\frac{1 - \\frac{\\rho^2}{3}}{1 + \\frac{\\rho^2}{6}} = \\left(1 - \\frac{\\rho^2}{3}\\right)\\left(1 - \\frac{\\rho^2}{6} + \\frac{\\rho^4}{36} - O(\\rho^6)\\right) = 1 - \\frac{\\rho^2}{6} - \\frac{\\rho^2}{3} + \\frac{\\rho^4}{18} + \\frac{\\rho^4}{36} + O(\\rho^6)\n$$\n$$\n= 1 - \\frac{1}{2}\\rho^2 + \\frac{1}{12}\\rho^4 + O(\\rho^6)\n$$\nEquating the series expansions:\n$$\n1 - \\frac{\\bar{\\rho}^2}{2} + \\frac{\\bar{\\rho}^4}{24} + O(\\bar{\\rho}^6) = 1 - \\frac{1}{2}\\rho^2 + \\frac{1}{12}\\rho^4 + O(\\rho^6)\n$$\nFor $\\rho \\to 0$, we have $\\bar{\\rho} \\to \\rho$, so the method is consistent. Let's find the higher-order terms. Equating coefficients of $\\rho^2$ and $\\bar{\\rho}^2$ gives $\\bar{\\rho}^2 \\approx \\rho^2$. We can substitute this into the $\\bar{\\rho}^4$ term:\n$$\n\\frac{\\bar{\\rho}^2}{2} = \\frac{1}{2}\\rho^2 - \\frac{1}{12}\\rho^4 + \\frac{\\bar{\\rho}^4}{24} + O(\\rho^6) \\approx \\frac{1}{2}\\rho^2 - \\frac{1}{12}\\rho^4 + \\frac{\\rho^4}{24} = \\frac{1}{2}\\rho^2 - \\frac{1}{24}\\rho^4\n$$\n$$\n\\bar{\\rho}^2 \\approx \\rho^2 - \\frac{1}{12}\\rho^4 = \\rho^2\\left(1 - \\frac{\\rho^2}{12}\\right)\n$$\nTaking the square root and using the binomial approximation $\\sqrt{1-x} \\approx 1 - x/2$ for small $x$:\n$$\n\\bar{\\rho} \\approx \\rho\\sqrt{1 - \\frac{\\rho^2}{12}} \\approx \\rho\\left(1 - \\frac{1}{2} \\cdot \\frac{\\rho^2}{12}\\right) = \\rho\\left(1 - \\frac{\\rho^2}{24}\\right)\n$$\nThe relative phase error is then:\n$$\n\\frac{\\bar{\\omega} - \\omega}{\\omega} = \\frac{\\bar{\\rho}}{\\rho} - 1 \\approx \\left(1 - \\frac{\\rho^2}{24}\\right) - 1 = -\\frac{\\rho^2}{24}\n$$\nThe leading-order relative phase error is $-\\rho^2/24$. The negative sign indicates phase lag (period elongation), which is characteristic of the linear acceleration method.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\arccos\\left(\\frac{1 - \\frac{\\rho^2}{3}}{1 + \\frac{\\rho^2}{6}}\\right) & \\frac{2\\sqrt{3}}{\\omega} & -\\frac{\\rho^2}{24}\n\\end{pmatrix}\n}\n$$", "id": "2598061"}, {"introduction": "Beyond analyzing existing methods, a key skill is understanding how to optimize them. This practice explores how tuning the Newmark parameter $\\beta$ can significantly enhance accuracy for non-dissipative schemes where $\\gamma=1/2$. You will perform a small-time-step analysis to find the specific value of $\\beta$ that eliminates the leading term in the period error, effectively elevating the method's accuracy from second to fourth order for oscillatory problems [@problem_id:2598012]. This demonstrates a powerful concept in algorithm design: tailoring parameters to minimize specific sources of error.", "problem": "Consider the undamped linear single degree of freedom (SDOF) oscillator governed by the ordinary differential equation $m \\ddot{u}(t) + k u(t) = 0$, with natural circular frequency $\\omega = \\sqrt{k/m}$. The motion is advanced in time by the Newmark family with parameters $\\beta$ and $\\gamma$, using a uniform time step $\\Delta t$, according to the update relations\n$$\nu_{n+1} = u_n + \\Delta t\\, v_n + \\Delta t^2 \\left[\\left(\\tfrac{1}{2} - \\beta\\right) a_n + \\beta\\, a_{n+1}\\right], \\quad\nv_{n+1} = v_n + \\Delta t \\left[(1-\\gamma) a_n + \\gamma\\, a_{n+1}\\right],\n$$\nwhere $a_n = \\ddot{u}_n$. Assume $\\gamma = \\tfrac{1}{2}$ and define the nondimensional step $\\Omega = \\omega \\Delta t$. By eliminating auxiliary variables, this method induces a two-step recurrence for the displacement of the form\n$$\nu_{n+1} - 2 \\cos(\\Omega_{\\mathrm{num}})\\, u_n + u_{n-1} = 0,\n$$\nwhich defines the discrete (algorithmic) frequency $\\Omega_{\\mathrm{num}} = \\omega_{\\mathrm{num}} \\Delta t$. Using only the given definitions and the method relations above (and no other specialized formulas), perform a small-$\\Omega$ analysis to expand $\\Omega_{\\mathrm{num}}$ as a series in $\\Omega$ up to and including the term of order $\\Omega^3$. Determine the value of $\\beta$ that eliminates the leading dispersive term in $\\Omega_{\\mathrm{num}} - \\Omega$ and briefly explain the implication for the leading-order behavior of the period error $T_{\\mathrm{num}}/T - 1$, where $T_{\\mathrm{num}} = 2\\pi/\\omega_{\\mathrm{num}}$ and $T = 2\\pi/\\omega$. Your final answer must be the single value of $\\beta$ (no units or rounding required). Angles must be treated in radians throughout.", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens.\n- Governing ordinary differential equation: $m \\ddot{u}(t) + k u(t) = 0$.\n- Natural circular frequency: $\\omega = \\sqrt{k/m}$.\n- Newmark family update relations with time step $\\Delta t$:\n$$u_{n+1} = u_n + \\Delta t\\, v_n + \\Delta t^2 \\left[\\left(\\tfrac{1}{2} - \\beta\\right) a_n + \\beta\\, a_{n+1}\\right]$$\n$$v_{n+1} = v_n + \\Delta t \\left[(1-\\gamma) a_n + \\gamma\\, a_{n+1}\\right]$$\n- Parameter constraint: $\\gamma = \\tfrac{1}{2}$.\n- Nondimensional time step: $\\Omega = \\omega \\Delta t$.\n- Form of the induced two-step recurrence for displacement: $u_{n+1} - 2 \\cos(\\Omega_{\\mathrm{num}})\\, u_n + u_{n-1} = 0$.\n- Definition of discrete (algorithmic) frequency: $\\Omega_{\\mathrm{num}} = \\omega_{\\mathrm{num}} \\Delta t$.\n- Definitions for period error analysis: $T_{\\mathrm{num}} = 2\\pi/\\omega_{\\mathrm{num}}$ and $T = 2\\pi/\\omega$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, well-posed, and objective. It presents a standard task in the analysis of numerical methods for structural dynamics: the dispersion analysis of the Newmark time integration scheme. All definitions and equations are standard and correct. The problem is self-contained, providing all necessary information to proceed with a derivation from first principles as requested. There are no contradictions, ambiguities, or factual errors. The problem is a formalizable and relevant exercise in applied mathematics and computational mechanics.\n\nStep 3: Verdict and Action.\nThe problem is valid. A solution will be provided.\n\nThe task is to derive the value of the Newmark parameter $\\beta$ that eliminates the leading dispersive error for an undamped single-degree-of-freedom system, given $\\gamma = 1/2$. We begin with the provided Newmark update rules and the equation of motion.\n\nFor the linear oscillator, the acceleration at any time step $t_n$ is directly related to the displacement $u_n$ by the equation of motion: $m a_n + k u_n = 0$, which implies $a_n = -(k/m)u_n = -\\omega^2 u_n$. The same holds for time step $t_{n+1}$: $a_{n+1} = -\\omega^2 u_{n+1}$.\n\nWe set $\\gamma = 1/2$ in the Newmark relations and substitute the expressions for acceleration:\n$$u_{n+1} = u_n + \\Delta t\\, v_n + \\Delta t^2 \\left[ \\left(\\frac{1}{2} - \\beta\\right)(-\\omega^2 u_n) + \\beta(-\\omega^2 u_{n+1}) \\right]$$\n$$v_{n+1} = v_n + \\Delta t \\left[ \\frac{1}{2}(-\\omega^2 u_n) + \\frac{1}{2}(-\\omega^2 u_{n+1}) \\right]$$\n\nIntroducing the nondimensional time step $\\Omega = \\omega \\Delta t$, the equations become:\n$$u_{n+1} = u_n + \\Delta t\\, v_n - \\Omega^2 \\left[ \\left(\\frac{1}{2} - \\beta\\right) u_n + \\beta u_{n+1} \\right] \\quad (1)$$\n$$\\Delta t\\, v_{n+1} = \\Delta t\\, v_n - \\frac{\\Omega^2}{2} (u_n + u_{n+1}) \\quad (2)$$\n\nOur goal is to derive a recurrence relation involving only the displacements $u_n$. We must eliminate the velocity terms. From equation $(1)$, we isolate $\\Delta t\\, v_n$:\n$$(1 + \\beta \\Omega^2) u_{n+1} = \\left(1 - \\left(\\frac{1}{2} - \\beta\\right)\\Omega^2\\right) u_n + \\Delta t\\, v_n$$\n$$\\Delta t\\, v_n = (1 + \\beta \\Omega^2) u_{n+1} - \\left(1 - \\left(\\frac{1}{2} - \\beta\\right)\\Omega^2\\right) u_n \\quad (3)$$\n\nTo find an expression for $\\Delta t\\, v_{n+1}$, we can shift the time index in equation $(3)$ from $n$ to $n+1$:\n$$\\Delta t\\, v_{n+1} = (1 + \\beta \\Omega^2) u_{n+2} - \\left(1 - \\left(\\frac{1}{2} - \\beta\\right)\\Omega^2\\right) u_{n+1} \\quad (4)$$\n\nWe must also use the velocity update, equation $(2)$. We substitute the expression for $\\Delta t\\, v_n$ from $(3)$ into $(2)$:\n$$\\Delta t\\, v_{n+1} = \\left[ (1 + \\beta \\Omega^2) u_{n+1} - \\left(1 - \\left(\\frac{1}{2} - \\beta\\right)\\Omega^2\\right) u_n \\right] - \\frac{\\Omega^2}{2} (u_n + u_{n+1})$$\nCollecting terms for $u_n$ and $u_{n+1}$:\n$$\\Delta t\\, v_{n+1} = \\left(1 + \\beta \\Omega^2 - \\frac{\\Omega^2}{2}\\right) u_{n+1} - \\left(1 - \\left(\\frac{1}{2} - \\beta\\right)\\Omega^2 + \\frac{\\Omega^2}{2}\\right) u_n$$\n$$\\Delta t\\, v_{n+1} = \\left(1 + \\left(\\beta - \\frac{1}{2}\\right)\\Omega^2\\right) u_{n+1} - \\left(1 + \\beta\\Omega^2\\right) u_n \\quad (5)$$\n\nNow we equate the two expressions for $\\Delta t\\, v_{n+1}$, from $(4)$ and $(5)$:\n$$(1 + \\beta \\Omega^2) u_{n+2} - \\left(1 - \\left(\\frac{1}{2} - \\beta\\right)\\Omega^2\\right) u_{n+1} = \\left(1 + \\left(\\beta - \\frac{1}{2}\\right)\\Omega^2\\right) u_{n+1} - \\left(1 + \\beta\\Omega^2\\right) u_n$$\nRearranging to group terms by displacement index:\n$$(1 + \\beta \\Omega^2) u_{n+2} - \\left[ \\left(1 - \\left(\\frac{1}{2} - \\beta\\right)\\Omega^2\\right) + \\left(1 + \\left(\\beta - \\frac{1}{2}\\right)\\Omega^2\\right) \\right] u_{n+1} + (1 + \\beta \\Omega^2) u_n = 0$$\nThe coefficient of the $u_{n+1}$ term simplifies:\n$$1 - \\frac{1}{2}\\Omega^2 + \\beta\\Omega^2 + 1 + \\beta\\Omega^2 - \\frac{1}{2}\\Omega^2 = 2 + (2\\beta - 1)\\Omega^2$$\nThe resulting three-term recurrence relation is:\n$$(1 + \\beta \\Omega^2) u_{n+2} - (2 + (2\\beta - 1)\\Omega^2) u_{n+1} + (1 + \\beta \\Omega^2) u_n = 0$$\nTo match the form $u_{n+1} - 2\\cos(\\Omega_{\\mathrm{num}})\\, u_n + u_{n-1} = 0$ given in the problem, we shift the indices down by one and divide by the factor $(1 + \\beta \\Omega^2)$:\n$$u_{n+1} - \\frac{2 + (2\\beta - 1)\\Omega^2}{1 + \\beta \\Omega^2} u_n + u_{n-1} = 0$$\nBy comparison, we identify:\n$$2\\cos(\\Omega_{\\mathrm{num}}) = \\frac{2 + (2\\beta - 1)\\Omega^2}{1 + \\beta \\Omega^2}$$\n$$\\cos(\\Omega_{\\mathrm{num}}) = \\frac{1 + (\\beta - 1/2)\\Omega^2}{1 + \\beta \\Omega^2}$$\n\nTo analyze the dispersive properties, we perform a Taylor series expansion for small $\\Omega$. The left-hand side (LHS) expands as:\n$$\\cos(\\Omega_{\\mathrm{num}}) = 1 - \\frac{\\Omega_{\\mathrm{num}}^2}{2!} + \\frac{\\Omega_{\\mathrm{num}}^4}{4!} - O(\\Omega_{\\mathrm{num}}^6)$$\nThe right-hand side (RHS) is expanded using the geometric series $(1+x)^{-1} = 1 - x + x^2 - \\dots$:\n$$\\text{RHS} = \\left(1 + \\left(\\beta - \\frac{1}{2}\\right)\\Omega^2\\right) (1 + \\beta\\Omega^2)^{-1} = \\left(1 + \\left(\\beta - \\frac{1}{2}\\right)\\Omega^2\\right) \\left(1 - \\beta\\Omega^2 + \\beta^2\\Omega^4 - O(\\Omega^6)\\right)$$\n$$\\text{RHS} = 1 - \\beta\\Omega^2 + \\beta^2\\Omega^4 + \\left(\\beta - \\frac{1}{2}\\right)\\Omega^2 - \\beta\\left(\\beta - \\frac{1}{2}\\right)\\Omega^4 + O(\\Omega^6)$$\n$$\\text{RHS} = 1 + \\left(-\\beta + \\beta - \\frac{1}{2}\\right)\\Omega^2 + \\left(\\beta^2 - \\beta^2 + \\frac{\\beta}{2}\\right)\\Omega^4 + O(\\Omega^6)$$\n$$\\text{RHS} = 1 - \\frac{1}{2}\\Omega^2 + \\frac{\\beta}{2}\\Omega^4 + O(\\Omega^6)$$\n\nEquating the two series expansions:\n$$1 - \\frac{\\Omega_{\\mathrm{num}}^2}{2} + \\frac{\\Omega_{\\mathrm{num}}^4}{24} - \\dots = 1 - \\frac{1}{2}\\Omega^2 + \\frac{\\beta}{2}\\Omega^4 + \\dots$$\nComparing terms, we see that to leading order, $\\Omega_{\\mathrm{num}}^2 \\approx \\Omega^2$, which shows the method is consistent. Let us find the more precise relation:\n$$\\frac{\\Omega_{\\mathrm{num}}^2}{2} = \\frac{\\Omega^2}{2} - \\frac{\\beta}{2}\\Omega^4 + \\frac{\\Omega_{\\mathrm{num}}^4}{24} - O(\\Omega^6)$$\nMultiplying by $2$ and substituting $\\Omega_{\\mathrm{num}}^4 \\approx \\Omega^4$ into the higher-order term:\n$$\\Omega_{\\mathrm{num}}^2 = \\Omega^2 - \\beta\\Omega^4 + \\frac{\\Omega^4}{12} + O(\\Omega^6) = \\Omega^2 + \\left(\\frac{1}{12} - \\beta\\right)\\Omega^4 + O(\\Omega^6)$$\nNow we take the square root to find $\\Omega_{\\mathrm{num}}$:\n$$\\Omega_{\\mathrm{num}} = \\sqrt{\\Omega^2 \\left(1 + \\left(\\frac{1}{12} - \\beta\\right)\\Omega^2 + O(\\Omega^4)\\right)} = \\Omega \\sqrt{1 + \\left(\\frac{1}{12} - \\beta\\right)\\Omega^2 + O(\\Omega^4)}$$\nUsing the expansion $\\sqrt{1+x} = 1 + \\frac{1}{2}x + O(x^2)$:\n$$\\Omega_{\\mathrm{num}} = \\Omega \\left(1 + \\frac{1}{2}\\left(\\frac{1}{12} - \\beta\\right)\\Omega^2 + O(\\Omega^4)\\right)$$\n$$\\Omega_{\\mathrm{num}} = \\Omega + \\frac{1}{2}\\left(\\frac{1}{12} - \\beta\\right)\\Omega^3 + O(\\Omega^5)$$\nThis is the expansion of the numerical frequency $\\Omega_{\\mathrm{num}}$ in terms of the exact frequency parameter $\\Omega$.\n\nThe numerical dispersion is characterized by the difference $\\Omega_{\\mathrm{num}} - \\Omega$. The leading dispersive term is the first non-zero term in the expansion of this difference. From our result:\n$$\\Omega_{\\mathrm{num}} - \\Omega = \\frac{1}{2}\\left(\\frac{1}{12} - \\beta\\right)\\Omega^3 + O(\\Omega^5)$$\nTo eliminate this leading dispersive term, its coefficient must be zero:\n$$\\frac{1}{2}\\left(\\frac{1}{12} - \\beta\\right) = 0 \\implies \\beta = \\frac{1}{12}$$\n\nThe implication for the period error is as follows. The period error is defined as $E_T = T_{\\mathrm{num}}/T - 1$.\n$$E_T = \\frac{2\\pi/\\omega_{\\mathrm{num}}}{2\\pi/\\omega} - 1 = \\frac{\\omega}{\\omega_{\\mathrm{num}}} - 1$$\nUsing the nondimensional parameters, this is equivalent to:\n$$E_T = \\frac{\\Omega}{\\Omega_{\\mathrm{num}}} - 1$$\nUsing our expansion for $\\Omega_{\\mathrm{num}}$:\n$$E_T = \\frac{\\Omega}{\\Omega \\left(1 + \\frac{1}{2}\\left(\\frac{1}{12} - \\beta\\right)\\Omega^2 + O(\\Omega^4)\\right)} - 1$$\n$$E_T = \\left(1 + \\frac{1}{2}\\left(\\frac{1}{12} - \\beta\\right)\\Omega^2 + O(\\Omega^4)\\right)^{-1} - 1$$\nUsing the expansion $(1+x)^{-1} = 1-x+O(x^2)$:\n$$E_T = \\left(1 - \\frac{1}{2}\\left(\\frac{1}{12} - \\beta\\right)\\Omega^2 + O(\\Omega^4)\\right) - 1$$\n$$E_T = -\\frac{1}{2}\\left(\\frac{1}{12} - \\beta\\right)\\Omega^2 + O(\\Omega^4)$$\nThe leading-order term in the period error is of order $\\Omega^2$, which corresponds to a second-order accurate method for the period. By choosing $\\beta = 1/12$, this leading-order term is eliminated. The period error then becomes $O(\\Omega^4)$, which signifies a much higher accuracy (fourth-order) for small time steps. This implies that the numerical period of oscillation will be exceptionally close to the exact period.\n\nThe value of $\\beta$ required is $1/12$.", "answer": "$$\\boxed{\\frac{1}{12}}$$", "id": "2598012"}, {"introduction": "Theoretical analysis provides predictions about a method's behavior, but empirical verification is essential for building confidence in its implementation. This hands-on coding exercise guides you through a numerical convergence study to measure the order of accuracy for different Newmark schemes. By comparing the numerical solution against an exact solution for progressively smaller time steps, you will empirically confirm the theoretical accuracy rates derived in analytical exercises and observe the practical effects of numerical dissipation [@problem_id:2598094]. This practice bridges the crucial gap between abstract theory and concrete computational results.", "problem": "Consider the linear single-degree-of-freedom second-order initial value problem given by the homogeneous ordinary differential equation $m \\ddot{u}(t) + c \\dot{u}(t) + k u(t) = 0$ with initial conditions $u(0) = u_0$ and $\\dot{u}(0) = v_0$. Use the Newmark family of single-step time integration schemes, parameterized by $(\\beta,\\gamma)$, to advance the solution in time with a uniform step size $\\Delta t$. The goal is to construct an empirical test to verify the theoretical order of accuracy of the Newmark family by halving $\\Delta t$ and computing error norms. The test must be designed using the following fundamental base: (i) Newton’s second law of motion as embodied in the governing equation $m \\ddot{u}(t) + c \\dot{u}(t) + k u(t) = 0$, and (ii) the definition of the Newmark family as a two-parameter discretization of kinematics and equilibrium that advances $(u,\\dot{u},\\ddot{u})$ from time $t_n$ to $t_{n+1} = t_n + \\Delta t$.\n\nFor the purpose of measurability, set $m = 1$, $c = 0$, and $k = \\omega^2$ with a known angular frequency $\\omega > 0$. Choose initial conditions $u_0$ and $v_0$ such that the exact solution is known in closed form. The exact solution for $c = 0$ is $u_{\\text{exact}}(t) = u_0 \\cos(\\omega t) + \\dfrac{v_0}{\\omega} \\sin(\\omega t)$ and $\\dot{u}_{\\text{exact}}(t) = -\\omega u_0 \\sin(\\omega t) + v_0 \\cos(\\omega t)$.\n\nYou must implement a program that:\n- Advances the solution using the Newmark method for a given pair $(\\beta,\\gamma)$ and time step $\\Delta t$ up to a fixed final time $T$.\n- Repeats the computation for the halved time steps $\\Delta t$, $\\Delta t/2$, $\\Delta t/4$, and $\\Delta t/8$.\n- At each time step size, measures the following data:\n  1. The discrete time histories $\\{u_n\\}_{n=0}^{N}$ and $\\{\\dot{u}_n\\}_{n=0}^{N}$ at times $t_n = n \\Delta t$ for $n = 0,1,\\dots,N$, where $N = T/\\Delta t$.\n  2. The corresponding exact values $\\{u_{\\text{exact}}(t_n)\\}$ and $\\{\\dot{u}_{\\text{exact}}(t_n)\\}$.\n  3. The absolute errors at the final time $t_N = T$: $e_u(\\Delta t) = |u_N - u_{\\text{exact}}(T)|$ and $e_v(\\Delta t) = |\\dot{u}_N - \\dot{u}_{\\text{exact}}(T)|$.\n  4. Optionally, the discrete-in-time norms over the full time interval, such as the maximum-in-time error $\\max_n |u_n - u_{\\text{exact}}(t_n)|$ and the root-mean-square error $\\left(\\dfrac{1}{N+1} \\sum_{n=0}^N |u_n - u_{\\text{exact}}(t_n)|^2\\right)^{1/2}$, though these will not be part of the final output.\n- Uses the measured final-time errors to estimate the empirical order of accuracy $p$ by comparing errors computed at successive halved step sizes. The estimate must be based on the ratio of errors for consecutive $\\Delta t$ values and must be aggregated across all available consecutive pairs $(\\Delta t,\\Delta t/2)$, $(\\Delta t/2,\\Delta t/4)$, and $(\\Delta t/4,\\Delta t/8)$ to yield a single representative estimate for displacement and for velocity.\n\nTest Suite:\nUse the following three parameter sets; they are chosen to probe distinct accuracy and stability characteristics within the Newmark family:\n\n- Case A (unconditionally stable, classical second order): $\\omega = 2\\pi$, $T = 1$, $u_0 = 1$, $v_0 = 0$, $\\beta = \\dfrac{1}{4}$, $\\gamma = \\dfrac{1}{2}$, base time step $\\Delta t_0 = \\dfrac{T}{10}$.\n- Case B (conditionally stable member often referred to as linear acceleration, with a sufficiently small time step to ensure stability over the test horizon): $\\omega = \\sqrt{5}$, $T = 1$, $u_0 = 1$, $v_0 = 0$, $\\beta = \\dfrac{1}{6}$, $\\gamma = \\dfrac{1}{2}$, base time step $\\Delta t_0 = \\dfrac{T}{10}$.\n- Case C (unconditionally stable with numerical dissipation and reduced order due to $\\gamma \\neq \\dfrac{1}{2}$): $\\omega = 2\\pi$, $T = 1$, $u_0 = 1$, $v_0 = 0$, $\\beta = 0.31$, $\\gamma = 0.6$, base time step $\\Delta t_0 = \\dfrac{T}{10}$.\n\nFor each case, compute the empirical order of accuracy for displacement and for velocity at the final time by halving the time step from the base value $\\Delta t_0$ through $\\Delta t_0/8$ and aggregating the three consecutive-pair estimates into one representative value per quantity.\n\nFinal Output Format:\nYour program should produce a single line of output containing a list of $6$ floating-point numbers in the following order:\n$[p^{(A)}_u, p^{(A)}_v, p^{(B)}_u, p^{(B)}_v, p^{(C)}_u, p^{(C)}_v]$,\nwhere $p^{(X)}_u$ and $p^{(X)}_v$ denote the aggregated empirical orders for displacement and velocity, respectively, for Case $X \\in \\{A,B,C\\}$. The list must be printed as a comma-separated list enclosed in square brackets, with each value rounded to three decimal places. No physical units are required in the output because the reported quantities are dimensionless orders of accuracy.", "solution": "The problem requires an empirical verification of the theoretical order of accuracy for the New-mark family of time integration schemes. This is to be performed on a linear single-degree-of-freedom (SDOF) system.\n\nThe governing ordinary differential equation (ODE) for the SDOF system is Newton's second law of motion:\n$$m \\ddot{u}(t) + c \\dot{u}(t) + k u(t) = 0$$\nwith initial conditions $u(0) = u_0$ and $\\dot{u}(0) = v_0$. For this problem, the parameters are specified as mass $m=1$, damping coefficient $c=0$, and stiffness $k=\\omega^2$, where $\\omega > 0$ is the natural angular frequency. The equation simplifies to the undamped simple harmonic oscillator:\n$$ \\ddot{u}(t) + \\omega^2 u(t) = 0 $$\nThe exact solution for the given initial conditions is:\n$$ u_{\\text{exact}}(t) = u_0 \\cos(\\omega t) + \\frac{v_0}{\\omega} \\sin(\\omega t) $$\n$$ \\dot{u}_{\\text{exact}}(t) = -u_0 \\omega \\sin(\\omega t) + v_0 \\cos(\\omega t) $$\n\nThe Newmark family of methods provides a time-stepping algorithm to approximate the solution. The state of the system $(u, \\dot{u}, \\ddot{u})$ is advanced from time $t_n$ to $t_{n+1} = t_n + \\Delta t$ using the following kinematic updates, parameterized by $\\beta$ and $\\gamma$:\n$$ u_{n+1} = u_n + \\dot{u}_n \\Delta t + \\left[ \\left(\\frac{1}{2} - \\beta\\right) \\ddot{u}_n + \\beta \\ddot{u}_{n+1} \\right] \\Delta t^2 $$\n$$ \\dot{u}_{n+1} = \\dot{u}_n + \\left[ (1-\\gamma) \\ddot{u}_n + \\gamma \\ddot{u}_{n+1} \\right] \\Delta t $$\nThese equations are implicit because the unknowns at time $t_{n+1}$ appear on both sides. To solve for them, we enforce the governing ODE at time $t_{n+1}$:\n$$ \\ddot{u}_{n+1} + \\omega^2 u_{n+1} = 0 \\implies \\ddot{u}_{n+1} = -\\omega^2 u_{n+1} $$\nThis relationship is specific to the linear undamped system and allows for a direct solution. We substitute the expression for $\\ddot{u}_{n+1}$ into the displacement update equation:\n$$ u_{n+1} = u_n + \\dot{u}_n \\Delta t + \\left(\\frac{1}{2} - \\beta\\right) \\ddot{u}_n \\Delta t^2 + \\beta (-\\omega^2 u_{n+1}) \\Delta t^2 $$\nWe can now algebraically solve for $u_{n+1}$ in terms of quantities known at time $t_n$. Rearranging the terms yields:\n$$ u_{n+1} \\left(1 + \\beta \\omega^2 \\Delta t^2\\right) = u_n + \\dot{u}_n \\Delta t + \\left(\\frac{1}{2} - \\beta\\right) \\ddot{u}_n \\Delta t^2 $$\nThis provides an explicit formula for $u_{n+1}$:\n$$ u_{n+1} = \\frac{1}{1 + \\beta \\omega^2 \\Delta t^2} \\left[ u_n + \\dot{u}_n \\Delta t + \\left(\\frac{1}{2} - \\beta\\right) \\ddot{u}_n \\Delta t^2 \\right] $$\nOnce $u_{n+1}$ is computed, the acceleration $\\ddot{u}_{n+1}$ and velocity $\\dot{u}_{n+1}$ at the new time step are found directly:\n$$ \\ddot{u}_{n+1} = -\\omega^2 u_{n+1} $$\n$$ \\dot{u}_{n+1} = \\dot{u}_n + (1 - \\gamma) \\ddot{u}_n \\Delta t + \\gamma \\ddot{u}_{n+1} \\Delta t $$\nThe time-stepping procedure starts with initial conditions $u_0$ and $\\dot{u}_0 = v_0$. The initial acceleration, $\\ddot{u}_0$, must be consistent with the governing equation at $t=0$:\n$$ \\ddot{u}_0 = -\\omega^2 u_0 $$\nThe solution is advanced iteratively until the final time $T$ is reached.\n\nTo determine the empirical order of accuracy, $p$, we analyze how the global error at a fixed time $T$ behaves as a function of the time step size $\\Delta t$. For a method of order $p$, the error is expected to scale as $e(\\Delta t) \\approx C (\\Delta t)^p$, where $C$ is a constant. Considering two different step sizes, $\\Delta t_1$ and a halved step size $\\Delta t_2 = \\Delta t_1/2$, the ratio of their corresponding errors is:\n$$ \\frac{e(\\Delta t_1)}{e(\\Delta t_2)} \\approx \\frac{C (\\Delta t_1)^p}{C (\\Delta t_2)^p} = \\left(\\frac{\\Delta t_1}{\\Delta t_2}\\right)^p = 2^p $$\nTaking the base-2 logarithm of this ratio allows for an estimation of $p$:\n$$ p \\approx \\log_2 \\left( \\frac{e(\\Delta t_1)}{e(\\Delta t_2)} \\right) $$\nThe problem requires this calculation for the errors in displacement, $e_u(\\Delta t) = |u_N - u_{\\text{exact}}(T)|$, and velocity, $e_v(\\Delta t) = |\\dot{u}_N - \\dot{u}_{\\text{exact}}(T)|$, where $N = T/\\Delta t$. The procedure will be executed for a sequence of halved time steps $\\Delta t_0, \\Delta t_0/2, \\Delta t_0/4, \\Delta t_0/8$. This provides three consecutive pairs of time steps, from which three estimates of $p$ are computed. The final reported order of accuracy is the arithmetic mean of these three estimates, providing a more robust measure.\n\nThe implementation will consist of a function to perform the Newmark time integration for a given set of parameters, a function to compute the exact solution, and a main routine to orchestrate the error analysis for each test case specified in the problem statement.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef exact_solution(t, omega, u0, v0):\n    \"\"\"\n    Computes the exact solution for the SDOF system u'' + omega^2 * u = 0.\n    \n    Args:\n        t (float): Time.\n        omega (float): Natural angular frequency.\n        u0 (float): Initial displacement.\n        v0 (float): Initial velocity.\n        \n    Returns:\n        tuple[float, float]: Displacement and velocity at time t.\n    \"\"\"\n    # Defensive check for omega=0, though problem statement guarantees omega > 0.\n    if omega == 0:\n        u_t = u0 + v0 * t\n        v_t = v0\n        return u_t, v_t\n        \n    u_t = u0 * np.cos(omega * t) + (v0 / omega) * np.sin(omega * t)\n    v_t = -u0 * omega * np.sin(omega * t) + v0 * np.cos(omega * t)\n    return u_t, v_t\n\ndef run_newmark_solver(omega, u0, v0, T, beta, gamma, dt):\n    \"\"\"\n    Solves the SDOF system using the Newmark method.\n    \n    Args:\n        omega (float): Natural angular frequency.\n        u0 (float): Initial displacement.\n        v0 (float): Initial velocity.\n        T (float): Final time.\n        beta (float): Newmark parameter beta.\n        gamma (float): Newmark parameter gamma.\n        dt (float): Time step size.\n        \n    Returns:\n        tuple[float, float]: Numerical displacement and velocity at time T.\n    \"\"\"\n    # Ensure number of steps is integer, using round for float precision\n    N = int(round(T / dt))\n    \n    # Initialize displacement, velocity, and acceleration\n    u, v = u0, v0\n    k = omega**2\n    a = -k * u  # Initial acceleration from EOM: m*a + k*u = 0 with m=1\n\n    # Pre-compute constant part of the denominator for efficiency\n    denom = 1.0 + beta * k * dt**2\n\n    # Time integration loop\n    for _ in range(N):\n        # Update displacement using the derived explicit formula for linear systems\n        u_next = (u + v * dt + (0.5 - beta) * a * dt**2) / denom\n        \n        # Update acceleration using the EOM at the next step\n        a_next = -k * u_next\n        \n        # Update velocity using the Newmark velocity update rule\n        v_next = v + (1.0 - gamma) * a * dt + gamma * a_next * dt\n        \n        # Advance the state\n        u, v, a = u_next, v_next, a_next\n        \n    return u, v\n\ndef compute_order_of_accuracy(params):\n    \"\"\"\n    Computes the empirical order of accuracy for a given test case.\n    \n    Args:\n        params (dict): Dictionary of parameters for the test case.\n        \n    Returns:\n        tuple[float, float]: Aggregated empirical order for displacement and velocity.\n    \"\"\"\n    omega = params['omega']\n    T = params['T']\n    u0 = params['u0']\n    v0 = params['v0']\n    beta = params['beta']\n    gamma = params['gamma']\n    dt0 = params['dt0']\n\n    # Get exact solution at the final time T\n    u_exact_T, v_exact_T = exact_solution(T, omega, u0, v0)\n\n    # Define the sequence of time steps\n    dts = [dt0 / (2**i) for i in range(4)]  # dt0, dt0/2, dt0/4, dt0/8\n\n    errors_u = []\n    errors_v = []\n\n    # Compute errors for each time step size\n    for dt in dts:\n        u_N, v_N = run_newmark_solver(omega, u0, v0, T, beta, gamma, dt)\n        errors_u.append(np.abs(u_N - u_exact_T))\n        errors_v.append(np.abs(v_N - v_exact_T))\n\n    orders_u = []\n    orders_v = []\n\n    # Compute order estimates from consecutive error pairs\n    for i in range(3):  # For pairs (dt_i, dt_{i+1})\n        # Handle cases where error is zero to avoid division by zero\n        if errors_u[i+1] > 1e-16: # Use a small tolerance for stability\n            ratio_u = errors_u[i] / errors_u[i+1]\n            orders_u.append(np.log2(ratio_u))\n        \n        if errors_v[i+1] > 1e-16:\n            ratio_v = errors_v[i] / errors_v[i+1]\n            orders_v.append(np.log2(ratio_v))\n            \n    # Aggregate (average) the order estimates. If no valid estimates, return 0.\n    p_u = np.mean(orders_u) if orders_u else 0.0\n    p_v = np.mean(orders_v) if orders_v else 0.0\n\n    return p_u, p_v\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Unconditionally stable, 2nd order (Constant Average Acceleration)\n        {\n            'omega': 2.0 * np.pi, 'T': 1.0, 'u0': 1.0, 'v0': 0.0,\n            'beta': 1.0/4.0, 'gamma': 1.0/2.0, 'dt0': 1.0/10.0\n        },\n        # Case B: Conditionally stable, 2nd order (Linear Acceleration Method)\n        {\n            'omega': np.sqrt(5.0), 'T': 1.0, 'u0': 1.0, 'v0': 0.0,\n            'beta': 1.0/6.0, 'gamma': 1.0/2.0, 'dt0': 1.0/10.0\n        },\n        # Case C: Unconditionally stable, 1st order (with numerical dissipation)\n        {\n            'omega': 2.0 * np.pi, 'T': 1.0, 'u0': 1.0, 'v0': 0.0,\n            'beta': 0.31, 'gamma': 0.6, 'dt0': 1.0/10.0\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        p_u, p_v = compute_order_of_accuracy(case)\n        results.extend([p_u, p_v])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{x:.3f}' for x in results])}]\")\n\nsolve()\n```", "id": "2598094"}]}