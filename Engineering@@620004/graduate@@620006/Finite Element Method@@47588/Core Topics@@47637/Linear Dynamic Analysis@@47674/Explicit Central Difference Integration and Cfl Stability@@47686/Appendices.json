{"hands_on_practices": [{"introduction": "Understanding the stability of an explicit time integration scheme begins with a firm grasp of its theoretical underpinnings. This first exercise [@problem_id:2557114] guides you through the fundamental derivation of the Courant–Friedrichs–Lewy (CFL) condition for a one-dimensional elastic bar. By performing a modal analysis on the semi-discretized finite element equations, you will derive the classic stability limit $\\Delta t_{\\max} = h/c$, directly linking the element size $h$ and material wave speed $c$ to the maximum permissible time step.", "problem": "A straight, homogeneous elastic bar of length $L$ and constant cross-sectional area $A$ is modeled in one spatial dimension by linear elasticity in small strains. Let $E$ denote Young’s modulus and $\\rho$ the mass density. The governing partial differential equation for the axial displacement $u(x,t)$ is the linear wave equation derived from Newton’s second law and Hooke’s law, with wave speed $c=\\sqrt{E/\\rho}$. Consider a finite element semi-discretization of the bar using $N$ uniform two-node linear elements of size $h=L/N$, with mass lumping (row-sum diagonalization of the consistent mass) on a uniform mesh and periodic boundary conditions to eliminate boundary artifacts. The semi-discrete equations have the form\n$$M \\ddot{\\mathbf{u}}(t) + K \\mathbf{u}(t) = \\mathbf{0}$$\nwhere $M$ is diagonal.\n\nTime integration is performed by the explicit central difference scheme (also known as the leap-frog method). The stability of this explicit scheme is controlled by the Courant–Friedrichs–Lewy (CFL) condition, which depends on the largest natural frequency of the semi-discrete system and hence on the spatial discretization.\n\nStarting from first principles (Newton’s second law and the finite element semi-discrete model) and a modal (Fourier) analysis of the resulting uniform lattice, derive the expression for the largest stable time step $\\Delta t_{\\max}$ for the explicit central difference method in terms of $h$, $E$, and $\\rho$. Then, using the derived expression, compute the numerical value of $\\Delta t_{\\max}$ for the data\n- $E = 210 \\times 10^{9}$ Pa,\n- $\\rho = 7800$ kg/m$^3$,\n- $L = 1$ m,\n- $N = 100$,\nand express your final numerical answer in seconds. Round your answer to four significant figures.", "solution": "The problem requires the derivation of the stability limit for the explicit central difference time integration scheme applied to a finite element semi-discretization of a one-dimensional elastic bar. This represents a classic problem in computational wave propagation. The validation of the problem statement has been performed and it is found to be scientifically grounded, well-posed, and objective. There are no flaws. We proceed with a formal derivation.\n\nThe governing equation for the axial displacement $u(x,t)$ is the wave equation:\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\nwhere the wave speed $c$ is given by $c = \\sqrt{E/\\rho}$, with $E$ being Young's modulus and $\\rho$ the mass density.\n\nThe spatial domain is discretized using $N$ uniform linear two-node finite elements of length $h = L/N$. The semi-discrete system of ordinary differential equations has the form $M \\ddot{\\mathbf{u}}(t) + K \\mathbf{u}(t) = \\mathbf{0}$. We must first construct the mass matrix $M$ and stiffness matrix $K$ for a representative node in the uniform mesh with periodic boundary conditions.\n\nFor a single linear bar element of length $h$, the element stiffness matrix $k^e$ and consistent mass matrix are given by:\n$$\nk^e = \\frac{AE}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}, \\quad m^e_{\\text{consistent}} = \\frac{\\rho A h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\nThe problem specifies mass lumping via row-sum diagonalization. The lumped element mass matrix $m^e$ is therefore:\n$$\nm^e = \\frac{\\rho A h}{6} \\begin{pmatrix} 2+1 & 0 \\\\ 0 & 1+2 \\end{pmatrix} = \\frac{\\rho A h}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nConsider a generic node $j$. It connects two elements: element $(j-1, j)$ and element $(j, j+1)$. Due to the periodic boundary conditions, all nodes are topologically equivalent. The equation of motion for the displacement $u_j$ of node $j$ is assembled from the contributions of these two elements.\n\nThe mass associated with node $j$, $M_{jj}$, is the sum of contributions from the two adjacent elements:\n$$\nM_{jj} = \\frac{\\rho A h}{2} + \\frac{\\rho A h}{2} = \\rho A h\n$$\nSince the lumped mass matrix $M$ is diagonal, the mass term in the equation for node $j$ is simply $M_{jj} \\ddot{u}_j = (\\rho A h) \\ddot{u}_j$.\n\nThe stiffness term for node $j$, $(K\\mathbf{u})_j$, is assembled from the element stiffness matrices. The force on node $j$ depends on its own displacement $u_j$ and the displacements of its neighbors, $u_{j-1}$ and $u_{j+1}$.\n$$\n(K\\mathbf{u})_j = \\left(\\frac{AE}{h}\\right) [u_j - u_{j+1}] + \\left(\\frac{AE}{h}\\right) [u_j - u_{j-1}] = \\frac{AE}{h} (-u_{j-1} + 2u_j - u_{j+1})\n$$\nCombining these terms, the equation of motion for node $j$ becomes:\n$$\n(\\rho A h) \\ddot{u}_j + \\frac{AE}{h} (-u_{j-1} + 2u_j - u_{j+1}) = 0\n$$\nDividing by $\\rho A h$ gives:\n$$\n\\ddot{u}_j + \\frac{E}{\\rho h^2} (-u_{j-1} + 2u_j - u_{j+1}) = 0\n$$\nSubstituting $c^2 = E/\\rho$, we get the discrete lattice equation:\n$$\n\\ddot{u}_j + \\frac{c^2}{h^2} (-u_{j-1} + 2u_j - u_{j+1}) = 0\n$$\nThis is a finite difference approximation of the original partial differential equation.\n\nTo find the natural frequencies of this semi-discrete system, we perform a modal analysis by positing a discrete wave solution (a Fourier mode) of the form:\n$$\nu_j(t) = \\hat{u} \\exp(i(\\omega t - k x_j)) = \\hat{u} \\exp(i(\\omega t - k j h))\n$$\nwhere $\\omega$ is the angular frequency, $k$ is the wave number, $x_j=jh$ is the position of node $j$, and $\\hat{u}$ is the amplitude. The temporal derivatives are $\\dot{u}_j = i\\omega u_j$ and $\\ddot{u}_j = -\\omega^2 u_j$. The spatial relationships are $u_{j-1} = u_j \\exp(ikh)$ and $u_{j+1} = u_j \\exp(-ikh)$.\n\nSubstituting these into the lattice equation yields the dispersion relation:\n$$\n-\\omega^2 u_j + \\frac{c^2}{h^2} (-u_j \\exp(ikh) + 2u_j - u_j \\exp(-ikh)) = 0\n$$\nDividing by $u_j$ (which is non-zero):\n$$\n-\\omega^2 + \\frac{c^2}{h^2} (2 - (\\exp(ikh) + \\exp(-ikh))) = 0\n$$\nUsing Euler's identity, $2\\cos(kh) = \\exp(ikh) + \\exp(-ikh)$, we find:\n$$\n\\omega^2 = \\frac{2c^2}{h^2} (1 - \\cos(kh))\n$$\nApplying the half-angle trigonometric identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$$\n\\omega^2(k) = \\frac{4c^2}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right)\n$$\nThe angular frequency is thus a function of the wave number $k$:\n$$\n\\omega(k) = \\frac{2c}{h} \\left| \\sin\\left(\\frac{kh}{2}\\right) \\right|\n$$\nThe stability of the explicit central difference scheme is governed by the highest natural frequency of the discrete system, $\\omega_{\\max}$. This maximum frequency occurs when the term $|\\sin(kh/2)|$ reaches its maximum value of $1$. This corresponds to the shortest wavelength that the discrete mesh can resolve, $\\lambda_{\\min} = 2h$, for which the wave number is $k_{\\max} = \\pi/h$. For this value, the argument of the sine function is $k_{\\max}h/2 = \\pi/2$.\n\nThus, the maximum natural frequency is:\n$$\n\\omega_{\\max} = \\frac{2c}{h} \\left| \\sin\\left(\\frac{\\pi}{2}\\right) \\right| = \\frac{2c}{h}\n$$\nThe stability condition for the central difference (leap-frog) method applied to a system of harmonic oscillators is $\\Delta t \\le 2/\\omega_{\\max}$. Therefore, the maximum stable time step $\\Delta t_{\\max}$ is:\n$$\n\\Delta t_{\\max} = \\frac{2}{\\omega_{\\max}} = \\frac{2}{2c/h} = \\frac{h}{c}\n$$\nSubstituting $c = \\sqrt{E/\\rho}$, we obtain the final expression for the maximum stable time step in terms of the required parameters:\n$$\n\\Delta t_{\\max} = \\frac{h}{\\sqrt{E/\\rho}} = h \\sqrt{\\frac{\\rho}{E}}\n$$\nThis is the Courant–Friedrichs–Lewy (CFL) condition for this specific numerical scheme.\n\nWe now compute the numerical value using the provided data:\n$E = 210 \\times 10^{9} \\, \\text{Pa}$\n$\\rho = 7800 \\, \\text{kg}/\\text{m}^3$\n$L = 1 \\, \\text{m}$\n$N = 100$\n\nFirst, we calculate the element size $h$ and the wave speed $c$.\n$$\nh = \\frac{L}{N} = \\frac{1}{100} = 0.01 \\, \\text{m}\n$$\n$$\nc = \\sqrt{\\frac{E}{\\rho}} = \\sqrt{\\frac{210 \\times 10^{9}}{7800}} \\approx 5188.745 \\, \\text{m/s}\n$$\nNow, we calculate the maximum stable time step $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = \\frac{h}{c} = \\frac{0.01}{\\sqrt{\\frac{210 \\times 10^{9}}{7800}}} \\approx \\frac{0.01}{5188.745} \\approx 1.92725 \\times 10^{-6} \\, \\text{s}\n$$\nRounding the result to four significant figures as required:\n$$\n\\Delta t_{\\max} \\approx 1.927 \\times 10^{-6} \\, \\text{s}\n$$\nThis completes the derivation and calculation.", "answer": "$$\\boxed{1.927 \\times 10^{-6}}$$", "id": "2557114"}, {"introduction": "Real-world systems are rarely homogeneous, and this practice [@problem_id:2557125] extends the stability analysis to a system composed of two different materials, a common scenario in engineering. By analyzing a simple, heterogeneous two-element model which reduces to a single degree of freedom, you will discover a crucial principle: the global time step for an explicit scheme is constrained by the most restrictive local condition. This exercise provides a clear, analytical demonstration of how the element with the highest characteristic frequency governs the stable time step for the entire simulation.", "problem": "Consider one-dimensional small-strain axial elastodynamics for a bar with two segments in series made of different materials. Segment A has length $h_{1} = 5.0\\times 10^{-2}\\ \\text{m}$, Young’s modulus $E_{1} = 70\\times 10^{9}\\ \\text{Pa}$, and mass density $\\rho_{1} = 2.70\\times 10^{3}\\ \\text{kg/m}^{3}$. Segment B has length $h_{2} = 5.0\\times 10^{-2}\\ \\text{m}$, Young’s modulus $E_{2} = 200\\times 10^{9}\\ \\text{Pa}$, and mass density $\\rho_{2} = 7.80\\times 10^{3}\\ \\text{kg/m}^{3}$. The cross-sectional area is uniform and equal to $A = 1.00\\times 10^{-4}\\ \\text{m}^{2}$. Discretize each segment with one linear two-node finite element and impose fixed displacements at the two ends. Assume no external loading and no damping. Use a lumped mass matrix. The time integration is performed by the explicit central difference method.\n\nStarting only from Newton’s second law, the constitutive relation for linear axial elasticity, and the standard finite element semidiscretization framework, do the following:\n\n1. Derive the undamped semidiscrete equations of motion and the explicit central difference time-stepping relation. Using modal (eigenvector) decomposition, derive a necessary and sufficient linear stability condition expressed in terms of the largest natural circular frequency of the semidiscrete system. Clearly state this condition in a form that can be evaluated once the largest circular frequency is known.\n\n2. Assemble the global stiffness and lumped mass contributions for the described two-material, two-element mesh, enforce the fixed-end boundary conditions, and reduce the system. Show that the dynamics reduce to a single degree of freedom and obtain a closed-form expression for the maximum stable time step in terms of $E_{1}$, $E_{2}$, $\\rho_{1}$, $\\rho_{2}$, $h_{1}$, $h_{2}$, and $A$.\n\n3. Substitute the given numerical values and compute the maximum stable time step. Express your final result in microseconds and round to four significant figures.", "solution": "The problem is subjected to validation before a solution is attempted.\n\nThe givens are:\nMaterial properties for segment A: length $h_{1} = 5.0\\times 10^{-2}\\ \\text{m}$, Young’s modulus $E_{1} = 70\\times 10^{9}\\ \\text{Pa}$, mass density $\\rho_{1} = 2.70\\times 10^{3}\\ \\text{kg/m}^{3}$.\nMaterial properties for segment B: length $h_{2} = 5.0\\times 10^{-2}\\ \\text{m}$, Young’s modulus $E_{2} = 200\\times 10^{9}\\ \\text{Pa}$, mass density $\\rho_{2} = 7.80\\times 10^{3}\\ \\text{kg/m}^{3}$.\nShared properties: cross-sectional area $A = 1.00\\times 10^{-4}\\ \\text{m}^{2}$.\nDiscretization and constraints: Each segment is modeled with one linear two-node finite element, with fixed displacements at the free ends of the assembly.\nNumerical model: A lumped mass matrix and the explicit central difference method are to be used for the time integration of the undamped, unforced system.\n\nThe problem is scientifically grounded in the principles of solid mechanics and numerical analysis. It is well-posed, with all necessary information provided and no contradictions present. The language is objective and precise. The problem is a standard exercise in computational mechanics, testing fundamental concepts of finite element analysis and stability of explicit time integration schemes. Therefore, the problem is deemed valid and a solution will be provided.\n\nThe solution proceeds in three parts as requested.\n\nPart 1: Derivation of the Stability Condition\n\nThe semidiscrete equations of motion for an undamped, unforced linear elastic system are derived from Newton's second law and the finite element spatial discretization of the weak form of the governing partial differential equation. This yields a system of ordinary differential equations:\n$$ \\mathbf{M}\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\mathbf{u}(t) = \\mathbf{0} $$\nwhere $\\mathbf{M}$ is the mass matrix, $\\mathbf{K}$ is the stiffness matrix, and $\\mathbf{u}(t)$ is the vector of nodal displacements.\n\nThe explicit central difference method is used for time integration. The acceleration at time step $n$ (time $t_n = n\\Delta t$) is approximated by a central difference formula:\n$$ \\ddot{\\mathbf{u}}_n \\approx \\frac{\\mathbf{u}_{n+1} - 2\\mathbf{u}_n + \\mathbf{u}_{n-1}}{(\\Delta t)^2} $$\nwhere $\\mathbf{u}_n = \\mathbf{u}(t_n)$ and $\\Delta t$ is the time step. Substituting this into the equation of motion at time $t_n$ gives:\n$$ \\mathbf{M}\\left(\\frac{\\mathbf{u}_{n+1} - 2\\mathbf{u}_n + \\mathbf{u}_{n-1}}{(\\Delta t)^2}\\right) + \\mathbf{K}\\mathbf{u}_n = \\mathbf{0} $$\nRearranging to solve for the displacements at the next time step, $\\mathbf{u}_{n+1}$, we obtain the time-stepping relation:\n$$ \\mathbf{M}\\mathbf{u}_{n+1} = 2\\mathbf{M}\\mathbf{u}_n - \\mathbf{M}\\mathbf{u}_{n-1} - (\\Delta t)^2\\mathbf{K}\\mathbf{u}_n $$\nSince a lumped (diagonal) mass matrix $\\mathbf{M}$ is used, its inverse $\\mathbf{M}^{-1}$ is trivial to compute, and the scheme is explicit:\n$$ \\mathbf{u}_{n+1} = 2\\mathbf{u}_n - \\mathbf{u}_{n-1} - (\\Delta t)^2\\mathbf{M}^{-1}\\mathbf{K}\\mathbf{u}_n $$\nTo analyze the stability of this scheme, we perform a modal analysis. The solution $\\mathbf{u}(t)$ can be expressed as a linear combination of the system's eigenvectors (modes) $\\boldsymbol{\\phi}_i$. The problem decouples into a set of independent scalar equations for each modal coordinate $q_i(t)$:\n$$ \\ddot{q}_i(t) + \\omega_i^2 q_i(t) = 0 $$\nwhere $\\omega_i$ is the $i$-th natural circular frequency, obtained from the generalized eigenvalue problem $\\mathbf{K}\\boldsymbol{\\phi}_i = \\omega_i^2\\mathbf{M}\\boldsymbol{\\phi}_i$. Applying the central difference scheme to a single modal equation gives:\n$$ \\frac{q_{n+1} - 2q_n + q_{n-1}}{(\\Delta t)^2} + \\omega^2 q_n = 0 $$\nwhere indices $i$ are dropped for clarity. This is a linear recurrence relation. We seek a solution of the form $q_n = \\lambda^n$. Substituting this into the equation yields the characteristic equation for the amplification factor $\\lambda$:\n$$ \\lambda^{n+1} - 2\\lambda^n + \\lambda^{n-1} + (\\omega\\Delta t)^2\\lambda^n = 0 $$\nDividing by $\\lambda^{n-1}$ (for $\\lambda \\neq 0$), we get a quadratic equation in $\\lambda$:\n$$ \\lambda^2 - \\left(2 - (\\omega\\Delta t)^2\\right)\\lambda + 1 = 0 $$\nFor the numerical solution to be stable, the magnitude of the roots $\\lambda$ must not exceed unity, i.e., $|\\lambda| \\le 1$. The roots of this quadratic equation are:\n$$ \\lambda_{1,2} = \\frac{(2 - (\\omega\\Delta t)^2) \\pm \\sqrt{(2 - (\\omega\\Delta t)^2)^2 - 4}}{2} $$\nThe condition for stability requires the discriminant to be non-positive, which ensures the roots are complex conjugates with modulus $1$, or real roots with magnitude at most $1$. A positive discriminant can lead to a real root with magnitude greater than $1$, causing instability.\nThe stability condition is met if $(2 - (\\omega\\Delta t)^2)^2 - 4 \\le 0$, which simplifies to:\n$$ |2 - (\\omega\\Delta t)^2| \\le 2 $$\nThis inequality is equivalent to $-2 \\le 2 - (\\omega\\Delta t)^2 \\le 2$.\nThe right side, $2 - (\\omega\\Delta t)^2 \\le 2$, implies $(\\omega\\Delta t)^2 \\ge 0$, which is always true for real $\\omega$ and $\\Delta t$.\nThe left side, $-2 \\le 2 - (\\omega\\Delta t)^2$, implies $(\\omega\\Delta t)^2 \\le 4$, which gives $|\\omega\\Delta t| \\le 2$.\nThis condition must hold for all modes of the system. The most restrictive constraint comes from the mode with the highest frequency, $\\omega_{\\max}$. Therefore, the necessary and sufficient linear stability condition is:\n$$ \\omega_{\\max}\\Delta t \\le 2 $$\nThis can be stated as: the time step $\\Delta t$ must be less than or equal to the critical time step $\\Delta t_{crit} = \\frac{2}{\\omega_{\\max}}$, where $\\omega_{\\max}$ is the largest natural circular frequency of the semidiscrete system.\n\nPart 2: Derivation of the Closed-Form Expression for the Maximum Stable Time Step\n\nThe system consists of two linear bar elements connected in series. The nodes are labeled $1$, $2$, and $3$ from left to right. Element $1$ connects nodes $1$ and $2$, and element $2$ connects nodes $2$ and $3$.\nThe element stiffness matrix for a $1$D bar element of length $h$, area $A$, and Young's modulus $E$ is:\n$$ \\mathbf{k}^e = \\frac{AE}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\nThe element lumped mass matrix for a material with density $\\rho$ is:\n$$ \\mathbf{m}^e = \\frac{\\rho A h}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} $$\nThe global stiffness matrix $\\mathbf{K}$ is assembled by summing the contributions from element $1$ (material $1$, length $h_1$) and element $2$ (material $2$, length $h_2$):\n$$ \\mathbf{K} = \\begin{pmatrix} \\frac{AE_1}{h_1} & -\\frac{AE_1}{h_1} & 0 \\\\ -\\frac{AE_1}{h_1} & \\frac{AE_1}{h_1} + \\frac{AE_2}{h_2} & -\\frac{AE_2}{h_2} \\\\ 0 & -\\frac{AE_2}{h_2} & \\frac{AE_2}{h_2} \\end{pmatrix} $$\nThe global lumped mass matrix $\\mathbf{M}$ is assembled similarly:\n$$ \\mathbf{M} = \\begin{pmatrix} \\frac{\\rho_1 A h_1}{2} & 0 & 0 \\\\ 0 & \\frac{\\rho_1 A h_1}{2} + \\frac{\\rho_2 A h_2}{2} & 0 \\\\ 0 & 0 & \\frac{\\rho_2 A h_2}{2} \\end{pmatrix} $$\nThe boundary conditions are fixed ends, meaning the displacements at node $1$ and node $3$ are zero: $u_1 = 0$ and $u_3 = 0$. This leaves a single active degree of freedom, $u_2$. The system can be reduced by considering only the rows and columns corresponding to this degree of freedom.\nThe reduced $1 \\times 1$ stiffness and mass matrices are the central entries of the global matrices:\n$$ K_{red} = K_{22} = \\frac{AE_1}{h_1} + \\frac{AE_2}{h_2} = A\\left(\\frac{E_1}{h_1} + \\frac{E_2}{h_2}\\right) $$\n$$ M_{red} = M_{22} = \\frac{\\rho_1 A h_1}{2} + \\frac{\\rho_2 A h_2}{2} = \\frac{A}{2}(\\rho_1 h_1 + \\rho_2 h_2) $$\nThe equation of motion for this single-degree-of-freedom system is $M_{red}\\ddot{u}_2 + K_{red}u_2 = 0$. The natural frequency of this system is the only frequency, and thus it is $\\omega_{\\max}$:\n$$ \\omega_{\\max}^2 = \\frac{K_{red}}{M_{red}} = \\frac{A\\left(\\frac{E_1}{h_1} + \\frac{E_2}{h_2}\\right)}{\\frac{A}{2}(\\rho_1 h_1 + \\rho_2 h_2)} = \\frac{2\\left(\\frac{E_1}{h_1} + \\frac{E_2}{h_2}\\right)}{\\rho_1 h_1 + \\rho_2 h_2} $$\nThe maximum stable time step $\\Delta t_{crit}$ is given by $\\frac{2}{\\omega_{\\max}}$. Substituting the expression for $\\omega_{\\max}$:\n$$ \\Delta t_{crit} = \\frac{2}{\\omega_{\\max}} = 2 \\sqrt{\\frac{\\rho_1 h_1 + \\rho_2 h_2}{2\\left(\\frac{E_1}{h_1} + \\frac{E_2}{h_2}\\right)}} = \\sqrt{\\frac{4(\\rho_1 h_1 + \\rho_2 h_2)}{2\\left(\\frac{E_1}{h_1} + \\frac{E_2}{h_2}\\right)}} $$\nThus, the closed-form expression is:\n$$ \\Delta t_{crit} = \\sqrt{\\frac{2(\\rho_1 h_1 + \\rho_2 h_2)}{\\frac{E_1}{h_1} + \\frac{E_2}{h_2}}} $$\n\nPart 3: Numerical Computation\n\nWe now substitute the given numerical values into the derived expression.\n$h_{1} = 5.0\\times 10^{-2}\\ \\text{m}$, $E_{1} = 70\\times 10^{9}\\ \\text{Pa}$, $\\rho_{1} = 2.70\\times 10^{3}\\ \\text{kg/m}^{3}$.\n$h_{2} = 5.0\\times 10^{-2}\\ \\text{m}$, $E_{2} = 200\\times 10^{9}\\ \\text{Pa}$, $\\rho_{2} = 7.80\\times 10^{3}\\ \\text{kg/m}^{3}$.\n\nFirst, we calculate the terms in the numerator of the radicand:\n$$ \\rho_1 h_1 = (2.70\\times 10^{3}\\ \\text{kg/m}^{3}) \\times (5.0\\times 10^{-2}\\ \\text{m}) = 135\\ \\text{kg/m}^{2} $$\n$$ \\rho_2 h_2 = (7.80\\times 10^{3}\\ \\text{kg/m}^{3}) \\times (5.0\\times 10^{-2}\\ \\text{m}) = 390\\ \\text{kg/m}^{2} $$\n$$ 2(\\rho_1 h_1 + \\rho_2 h_2) = 2(135 + 390)\\ \\text{kg/m}^{2} = 2(525)\\ \\text{kg/m}^{2} = 1050\\ \\text{kg/m}^{2} $$\nNext, we calculate the terms in the denominator of the radicand:\n$$ \\frac{E_1}{h_1} = \\frac{70\\times 10^{9}\\ \\text{Pa}}{5.0\\times 10^{-2}\\ \\text{m}} = 1.4\\times 10^{12}\\ \\text{Pa/m} $$\n$$ \\frac{E_2}{h_2} = \\frac{200\\times 10^{9}\\ \\text{Pa}}{5.0\\times 10^{-2}\\ \\text{m}} = 4.0\\times 10^{12}\\ \\text{Pa/m} $$\n$$ \\frac{E_1}{h_1} + \\frac{E_2}{h_2} = (1.4\\times 10^{12} + 4.0\\times 10^{12})\\ \\text{Pa/m} = 5.4\\times 10^{12}\\ \\text{Pa/m} $$\nNow we compute the maximum stable time step:\n$$ \\Delta t_{crit} = \\sqrt{\\frac{1050\\ \\text{kg/m}^{2}}{5.4\\times 10^{12}\\ \\text{Pa/m}}} = \\sqrt{\\frac{1050}{5.4\\times 10^{12}}}\\ \\text{s} \\approx \\sqrt{1.9444... \\times 10^{-10}}\\ \\text{s} $$\n$$ \\Delta t_{crit} \\approx 1.394433 \\times 10^{-5}\\ \\text{s} $$\nThe result is required in microseconds ($\\mu$s), where $1\\ \\mu\\text{s} = 10^{-6}\\ \\text{s}$.\n$$ \\Delta t_{crit} \\approx 13.94433\\ \\mu\\text{s} $$\nRounding to four significant figures, we get $13.94\\ \\mu\\text{s}$.", "answer": "$$\\boxed{13.94}$$", "id": "2557125"}, {"introduction": "Theoretical derivations provide the 'why,' but numerical experiments provide the tangible 'what.' This final practice [@problem_id:2557116] challenges you to write a program that numerically verifies the CFL stability bound. You will simulate the system's response using time steps that are stable, marginally stable, and unstable, and directly observe the resulting solution behavior—from bounded oscillation to catastrophic failure. This hands-on verification is essential for building intuition and confirming that the abstract stability condition has real, predictable consequences in a computational setting.", "problem": "Consider the one-dimensional linear elastic wave equation on the interval $\\left(0,L\\right)$ with homogeneous Dirichlet boundary conditions at both ends and no external forcing. Let $u\\left(x,t\\right)$ denote the axial displacement, $\\rho$ the mass density, $E$ the Young’s modulus, and $A$ the cross-sectional area. The strong form is\n$$\n\\rho A\\,\\frac{\\partial^2 u}{\\partial t^2} - \\frac{\\partial}{\\partial x}\\left(EA\\,\\frac{\\partial u}{\\partial x}\\right) = 0,\\quad x\\in\\left(0,L\\right),\\ t>0,\\quad u\\left(0,t\\right)=u\\left(L,t\\right)=0.\n$$\nLet the wave speed be $c=\\sqrt{E/\\rho}$.\n\nUsing the standard Galerkin finite element method with uniform meshes of $N_e$ two-node linear elements and a mass-lumped approximation, the semi-discrete system has the form\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0},\n$$\nwhere $\\mathbf{M}\\in\\mathbb{R}^{n\\times n}$ is diagonal positive definite after eliminating the boundary degrees of freedom, $\\mathbf{K}\\in\\mathbb{R}^{n\\times n}$ is symmetric positive definite, and $n=N_e-1$ is the number of interior degrees of freedom. Consider the explicit central difference time integration defined on a uniform time grid with time step $\\Delta t$ by\n$$\n\\mathbf{u}^{k+1} = 2\\mathbf{u}^k - \\mathbf{u}^{k-1} - \\Delta t^2\\,\\mathbf{M}^{-1}\\mathbf{K}\\,\\mathbf{u}^k,\\quad k\\geq 1,\n$$\nwith the first step computed via\n$$\n\\mathbf{u}^1 = \\mathbf{u}^0 + \\Delta t\\,\\dot{\\mathbf{u}}^0 + \\frac{\\Delta t^2}{2}\\,\\ddot{\\mathbf{u}}^0,\n$$\nwhere $\\ddot{\\mathbf{u}}^0 = -\\mathbf{M}^{-1}\\mathbf{K}\\,\\mathbf{u}^0$.\n\nYour task is to verify the Courant–Friedrichs–Lewy (CFL) stability bound for the explicit central difference scheme using canonical problems constructed from the above one-dimensional model. Start from the fundamental definitions of the semi-discrete system and the explicit scheme and determine the maximum stable time step implied by the spectral properties of the undamped, unforced discrete system. Then, for each test case, compute:\n- the critical time step $\\Delta t_{\\text{crit}}$ in seconds,\n- the ratio $r=\\Delta t/\\Delta t_{\\text{crit}}$ (dimensionless),\n- a predicted stability flag $\\in\\{0,1\\}$ obtained solely from the theoretical stability condition,\n- an observed stability flag $\\in\\{0,1\\}$ obtained from a direct simulation using the explicit central difference scheme.\n\nFor the observed stability, use the following canonical initial condition to create a worst-case scenario: set the initial displacement $\\mathbf{u}^0$ proportional to the discrete eigenvector associated with the largest generalized eigenvalue of the pair $\\left(\\mathbf{K},\\mathbf{M}\\right)$ (i.e., the highest discrete frequency mode), normalized to unit $M$-norm, and set the initial velocity $\\dot{\\mathbf{u}}^0=\\mathbf{0}$. Evolve the scheme for a specified number of time steps and declare the run “observed stable” if the maximum $M$-norm of the displacement over the simulated time does not exceed a prescribed threshold multiple of the initial $M$-norm. Use a threshold factor equal to $20$ (dimensionless). All physical quantities must be expressed in the International System of Units: meters for $L$, seconds for time, and meters per second for $c$. Report $\\Delta t_{\\text{crit}}$ in seconds.\n\nImplement the following test suite. In all cases, take $A=1$ (square meter), $E=1$ (Pascal), and choose $\\rho=E/c^2$ so that the wave speed is exactly $c$. Apply homogeneous Dirichlet boundary conditions at $x=0$ and $x=L$. For each case, construct the uniform mesh, assemble $\\mathbf{K}$ and the lumped $\\mathbf{M}$, compute the discrete spectrum to determine the critical time step, choose $\\Delta t$ as instructed, and simulate for the prescribed number of steps.\n\n- Case $\\left(1\\right)$: $L=1$ (meter), $N_e=80$, $c=200$ (meter per second), choose $\\Delta t=0.8\\,\\Delta t_{\\text{crit}}$, and simulate for $4000$ time steps.\n- Case $\\left(2\\right)$: $L=1$ (meter), $N_e=80$, $c=200$ (meter per second), choose $\\Delta t=1.0\\,\\Delta t_{\\text{crit}}$, and simulate for $2000$ time steps.\n- Case $\\left(3\\right)$: $L=1$ (meter), $N_e=80$, $c=200$ (meter per second), choose $\\Delta t=1.05\\,\\Delta t_{\\text{crit}}$, and simulate for $800$ time steps.\n- Case $\\left(4\\right)$: $L=1$ (meter), $N_e=160$, $c=200$ (meter per second), choose $\\Delta t=0.8\\,\\Delta t_{\\text{crit}}$, and simulate for $4000$ time steps.\n\nYour program must:\n- assemble $\\mathbf{K}$ and $\\mathbf{M}$ for a uniform mesh of two-node linear elements,\n- apply the Dirichlet boundary conditions by eliminating the boundary degrees of freedom,\n- compute the largest generalized eigenvalue of $(\\mathbf{K},\\mathbf{M})$ and hence the corresponding highest discrete angular frequency,\n- determine the theoretical critical time step and the predicted stability flag,\n- construct the highest-frequency eigenvector and normalize it to unit $M$-norm,\n- run the explicit central difference scheme for the specified number of steps with initial velocity equal to zero,\n- compute the maximum displacement $M$-norm during the run and determine the observed stability flag using the threshold factor equal to $20$.\n\nNumerical outputs to be produced for each case must be:\n- $\\Delta t_{\\text{crit}}$ in seconds (as a floating-point number),\n- $r=\\Delta t/\\Delta t_{\\text{crit}}$ (as a floating-point number),\n- predicted stability flag, with value $1$ if theoretically stable and $0$ otherwise,\n- observed stability flag, with value $1$ if the simulation is observed stable and $0$ otherwise.\n\nFinal output format: Your program should produce a single line of output containing a Python-style list of four lists (one per test case), where each inner list is of the form $[\\Delta t_{\\text{crit}}, r, \\text{predicted}, \\text{observed}]$. For example, the output should look like\n$$\n[[d_1,r_1,p_1,o_1],[d_2,r_2,p_2,o_2],[d_3,r_3,p_3,o_3],[d_4,r_4,p_4,o_4]],\n$$\nwith each $d_i$ in seconds and each $r_i$, $p_i$, $o_i$ dimensionless. The program must be entirely self-contained and must not read any input.", "solution": "The problem requires the verification of the Courant–Friedrichs–Lewy (CFL) stability condition for the explicit central difference time integration scheme applied to a one-dimensional wave equation discretized by the finite element method. The solution is developed through a systematic, principle-based approach.\n\nFirst, we establish the theoretical stability criterion. The semi-discrete system is given by the undamped, unforced system of ordinary differential equations $\\mathbf{M}\\,\\ddot{\\mathbf{u}} + \\mathbf{K}\\,\\mathbf{u} = \\mathbf{0}$. The explicit central difference scheme for this system is\n$$\n\\mathbf{u}^{k+1} = 2\\mathbf{u}^k - \\mathbf{u}^{k-1} - \\Delta t^2\\,\\mathbf{M}^{-1}\\mathbf{K}\\,\\mathbf{u}^k.\n$$\nTo analyze the stability of this scheme, we consider a single mode of oscillation, where the displacement vector is of the form $\\mathbf{u}(t) = \\mathbf{v}\\,e^{i\\omega t}$. Substituting this into the semi-discrete equation yields the generalized eigenvalue problem $\\mathbf{K}\\mathbf{v} = \\omega^2\\mathbf{M}\\mathbf{v}$, where $\\omega$ is a natural angular frequency of the discrete system and $\\mathbf{v}$ is the corresponding mode shape. Let $\\lambda = \\omega^2$ be an eigenvalue. We seek a numerical solution of the form $\\mathbf{u}^k = g^k\\mathbf{v}$, where $g$ is a complex amplification factor. Substituting this into the difference equation leads to a characteristic quadratic equation for $g$:\n$$\ng^2 - (2 - \\Delta t^2 \\lambda)g + 1 = 0.\n$$\nFor the scheme to be stable, the magnitude of the roots of this equation must not exceed one, i.e., $|g| \\le 1$. This condition is met if the roots are complex conjugates, which requires the discriminant of the quadratic equation to be non-positive:\n$$\n(2 - \\Delta t^2 \\lambda)^2 - 4 \\le 0.\n$$\nThis inequality simplifies to $-2 \\le 2 - \\Delta t^2 \\lambda \\le 2$, which in turn gives $0 \\le \\Delta t^2 \\lambda \\le 4$, or $\\Delta t \\sqrt{\\lambda} \\le 2$. Since this must hold for all modes of the system, the stability is governed by the mode with the highest frequency, $\\omega_{\\max} = \\sqrt{\\lambda_{\\max}}$. The stability condition, also known as the CFL condition for this scheme, is therefore:\n$$\n\\Delta t \\le \\frac{2}{\\omega_{\\max}} = \\frac{2}{\\sqrt{\\lambda_{\\max}}}.\n$$\nThe critical time step is the maximum permissible time step, $\\Delta t_{\\text{crit}} = 2/\\omega_{\\max}$. A time step $\\Delta t > \\Delta t_{\\text{crit}}$ will lead to exponential growth of the numerical solution for the highest frequency mode, resulting in instability. The theoretically predicted stability flag is $1$ if the ratio $r = \\Delta t/\\Delta t_{\\text{crit}} \\le 1$ and $0$ otherwise.\n\nNext, we construct the system matrices $\\mathbf{M}$ and $\\mathbf{K}$ using the finite element method. The domain of length $L$ is discretized into $N_e$ uniform two-node linear elements, each of length $h = L/N_e$. For an element with Young's modulus $E$, cross-sectional area $A$, and mass density $\\rho$, the element stiffness matrix $\\mathbf{k}^e$ and lumped mass matrix $\\mathbf{m}^e$ are:\n$$\n\\mathbf{k}^e = \\frac{EA}{h}\n\\begin{pmatrix}\n1 & -1 \\\\\n-1 & 1\n\\end{pmatrix}, \\quad\n\\mathbf{m}^e = \\frac{\\rho A h}{2}\n\\begin{pmatrix}\n1 & 0 \\\\\n0 & 1\n\\end{pmatrix}.\n$$\nThe global matrices for the entire mesh are assembled by summing the contributions from each element. The homogeneous Dirichlet boundary conditions, $u(0,t)=u(L,t)=0$, are enforced by eliminating the rows and columns corresponding to the boundary nodes (node $0$ and node $N_e$). This results in reduced system matrices $\\mathbf{K}$ and $\\mathbf{M}$ of size $n \\times n$, where $n = N_e-1$ is the number of interior, free degrees of freedom. The resulting mass matrix $\\mathbf{M}$ is diagonal with entries $M_{ii} = \\rho A h$, and the stiffness matrix $\\mathbf{K}$ is symmetric and tridiagonal.\n\nThe core of the numerical task is to find the largest eigenvalue $\\lambda_{\\max}$ of the generalized eigenvalue problem $\\mathbf{K}\\mathbf{v} = \\lambda\\mathbf{M}\\mathbf{v}$. This is accomplished using a numerical eigenvalue solver. With $\\lambda_{\\max}$ known, we compute $\\omega_{\\max} = \\sqrt{\\lambda_{\\max}}$ and $\\Delta t_{\\text{crit}} = 2/\\omega_{\\max}$.\n\nFinally, to observe the stability empirically, we perform a direct time integration. To create a worst-case scenario that maximally excites the potentially unstable mode, the initial displacement $\\mathbf{u}^0$ is set to the eigenvector $\\mathbf{v}_{\\max}$ corresponding to $\\lambda_{\\max}$. This eigenvector is scaled to have a unit $M$-norm, i.e., $\\|\\mathbf{u}^0\\|_{M} = \\sqrt{(\\mathbf{u}^0)^T\\mathbf{M}\\mathbf{u}^0} = 1$. The initial velocity is set to zero, $\\dot{\\mathbf{u}}^0 = \\mathbf{0}$. The time evolution is computed using the central difference scheme, starting with the special first step:\n$$\n\\mathbf{u}^1 = \\mathbf{u}^0 - \\frac{\\Delta t^2}{2}\\mathbf{M}^{-1}\\mathbf{K}\\,\\mathbf{u}^0.\n$$\nDuring the simulation over a specified number of steps, we monitor the $M$-norm of the displacement, $\\|\\mathbf{u}^k\\|_{M}$. The simulation is declared \"observed stable\" (flag $1$) if the maximum observed norm does not exceed a given threshold multiple of the initial norm (here, a factor of $20$). If the norm exceeds this threshold, the simulation is declared unstable (flag $0$). This generous threshold easily distinguishes between the bounded response of a stable run and the exponential growth of an unstable one. This procedure is repeated for each test case specified in the problem statement.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for CFL stability verification.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, Ne, c, r_target, num_steps)\n        (1.0, 80, 200.0, 0.8, 4000),\n        (1.0, 80, 200.0, 1.0, 2000),\n        (1.0, 80, 200.0, 1.05, 800),\n        (1.0, 160, 200.0, 0.8, 4000),\n    ]\n\n    stability_threshold_factor = 20.0\n    results = []\n\n    for case in test_cases:\n        L, Ne, c, r_target, num_steps = case\n        \n        # Setup physical and mesh parameters\n        E = 1.0\n        A = 1.0\n        rho = E / c**2\n        h = L / Ne\n        n_dof = Ne - 1\n\n        # Assemble stiffness (K) and lumped mass (M) matrices for interior DOFs\n        \n        # M is a diagonal matrix, stored as a 1D array of its diagonal entries\n        # M_ii = rho * A * h for each of the n_dof interior nodes\n        M_diag = np.full(n_dof, rho * A * h)\n        \n        # K is a tridiagonal matrix\n        # Diagonal entries: 2*E*A/h\n        # Off-diagonal entries: -E*A/h\n        main_diag_K = np.full(n_dof, 2 * E * A / h)\n        off_diag_K = np.full(n_dof - 1, -E * A / h)\n        K = np.diag(main_diag_K) + np.diag(off_diag_K, k=1) + np.diag(off_diag_K, k=-1)\n\n        # Solve the generalized eigenvalue problem: K v = lambda M v\n        # Using scipy.linalg.eigh for symmetric matrices. We pass M as a full diagonal matrix.\n        eigenvalues, eigenvectors = eigh(K, np.diag(M_diag))\n        \n        # The largest eigenvalue determines the stability limit\n        lambda_max = eigenvalues[-1]\n        \n        # The highest discrete angular frequency\n        omega_max = np.sqrt(lambda_max)\n        \n        # Compute the theoretical critical time step\n        dt_crit = 2.0 / omega_max\n\n        # --- Predicted Stability ---\n        # The chosen time step for the simulation\n        dt = r_target * dt_crit\n        # Predicted stability flag is 1 if dt = dt_crit (i.e., r_target = 1.0)\n        predicted_stability = 1 if r_target = 1.0 else 0\n        \n        # --- Observed Stability Simulation ---\n        # Set initial conditions based on the highest frequency mode\n        # The eigenvector corresponding to lambda_max\n        v_max = eigenvectors[:, -1]\n        \n        # Normalize the initial displacement vector u0 to have unit M-norm\n        m_norm_v_max_sq = v_max.T @ (M_diag * v_max)  # M is diagonal\n        u0 = v_max / np.sqrt(m_norm_v_max_sq)\n        \n        # Initial velocity is zero\n        udot0 = np.zeros(n_dof)\n\n        # Pre-calculate matrix for the update step to save computation\n        # Since M is diagonal, its inverse is simple\n        inv_M_diag = 1.0 / M_diag\n        C = dt**2 * (inv_M_diag[:, np.newaxis] * K) # Efficient since inv_M is diagonal\n\n        # First step of central difference scheme (special formula)\n        ddot0 = -(inv_M_diag * (K @ u0))\n        u1 = u0 + dt * udot0 + (dt**2 / 2.0) * ddot0\n        \n        u_prev = u0\n        u_curr = u1\n        \n        # Initial M-norm is 1 by normalization\n        max_m_norm_u = 1.0\n\n        # Main time-stepping loop\n        for k in range(1, num_steps):\n            # Central difference update\n            u_next = 2 * u_curr - u_prev - C @ u_curr\n            \n            u_prev, u_curr = u_curr, u_next\n            \n            # Calculate M-norm of the current displacement\n            current_m_norm_u = np.sqrt(u_curr.T @ (M_diag * u_curr))\n            \n            if current_m_norm_u > max_m_norm_u:\n                max_m_norm_u = current_m_norm_u\n            \n            # Early exit if solution has clearly blown up to avoid overflow/wasted computation\n            if not np.isfinite(max_m_norm_u) or max_m_norm_u > stability_threshold_factor * 10:\n                break\n        \n        # Determine observed stability based on the specified threshold\n        observed_stability = 1 if max_m_norm_u = stability_threshold_factor else 0\n        \n        # Store results for this case\n        results.append([dt_crit, r_target, predicted_stability, observed_stability])\n\n    # Final print statement in the exact required format.\n    print(results)\n\nsolve()\n```", "id": "2557116"}]}