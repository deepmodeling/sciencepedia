{"hands_on_practices": [{"introduction": "To truly understand the difference between consistent and lumped mass matrices, we begin at the source: the kinetic energy principle. This practice guides you through the process of deriving both matrix types for a simple one-dimensional bar element directly from its kinetic energy expression. By calculating and comparing the kinetic energy for a given velocity state [@problem_id:2546885], you will gain a concrete understanding of how these formulations differ in their representation of an element's inertia.", "problem": "A uniform slender bar undergoing one-dimensional axial motion is modeled by the Finite Element Method (FEM) using a single two-node linear element of length $L$ and cross-sectional area $A$. The material density is constant and equal to $\\rho$. Let $x$ denote the physical coordinate measured along the element, with $x \\in [0,L]$. The kinetic energy of the continuous bar is given by the standard definition $T = \\tfrac{1}{2} \\int_{0}^{L} \\rho A \\, v(x,t)^{2} \\, \\mathrm{d}x$. In the Galerkin semi-discrete setting, approximate the velocity field as $v(x,t) \\approx N_{1}(x)\\,\\dot{d}_{1}(t) + N_{2}(x)\\,\\dot{d}_{2}(t)$, where $N_{1}(x)$ and $N_{2}(x)$ are the linear shape functions associated with the two nodes, and $\\dot{d}_{1}(t)$ and $\\dot{d}_{2}(t)$ are the nodal velocities.\n\nStarting from the kinetic energy definition and the linear shape functions, derive the consistent element mass matrix and then construct a lumped (diagonal) element mass matrix by the row-sum diagonalization of the consistent mass matrix. For the specific element with $L = 0.8\\,\\mathrm{m}$, $A = 2.5 \\times 10^{-4}\\,\\mathrm{m}^{2}$, and $\\rho = 7800\\,\\mathrm{kg/m}^{3}$, consider the nodal velocity vector $\\dot{\\mathbf{d}} = \\begin{pmatrix} \\dot{d}_{1} \\\\ \\dot{d}_{2} \\end{pmatrix} = \\begin{pmatrix} 0.35 \\\\ 1.10 \\end{pmatrix}\\,\\mathrm{m/s}$.\n\nLet $T_{\\mathrm{c}}$ be the kinetic energy computed with the consistent mass matrix and $T_{\\mathrm{l}}$ the kinetic energy computed with the lumped mass matrix. Compute the ratio $R = T_{\\mathrm{c}}/T_{\\mathrm{l}}$ for this element and these nodal velocities. Express your final answer as a dimensionless number rounded to four significant figures.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard exercise in the formulation of mass matrices within the Finite Element Method for structural dynamics. All necessary data are provided, and the task is to perform a series of well-defined derivations and calculations. Therefore, the problem is valid, and a solution will be provided.\n\nThe kinetic energy $T$ of a continuous body is given by\n$$T = \\frac{1}{2} \\int_{V} \\rho \\, \\mathbf{v} \\cdot \\mathbf{v} \\, \\mathrm{d}V$$\nFor one-dimensional axial motion of a bar with constant cross-sectional area $A$, this simplifies to\n$$T = \\frac{1}{2} \\int_{0}^{L} \\rho A \\, v(x,t)^{2} \\, \\mathrm{d}x$$\nwhere $v(x,t)$ is the axial velocity at position $x$ and time $t$.\n\nWithin the finite element framework, the velocity field $v(x,t)$ inside an element is approximated using shape functions $N_i(x)$ and nodal velocities $\\dot{d}_i(t)$. For a two-node linear element, this approximation is\n$$v(x,t) \\approx \\mathbf{N}(x) \\dot{\\mathbf{d}}(t) = \\begin{pmatrix} N_1(x) & N_2(x) \\end{pmatrix} \\begin{pmatrix} \\dot{d}_1(t) \\\\ \\dot{d}_2(t) \\end{pmatrix}$$\nwhere $\\mathbf{N}(x)$ is the row vector of shape functions and $\\dot{\\mathbf{d}}(t)$ is the column vector of nodal velocities. The standard linear shape functions for a two-node element with nodes at $x=0$ and $x=L$ are\n$$N_1(x) = 1 - \\frac{x}{L}$$\n$$N_2(x) = \\frac{x}{L}$$\nSubstituting the velocity approximation into the kinetic energy expression gives\n$$T \\approx \\frac{1}{2} \\int_{0}^{L} \\rho A \\left( \\mathbf{N}(x) \\dot{\\mathbf{d}}(t) \\right)^{2} \\, \\mathrm{d}x = \\frac{1}{2} \\int_{0}^{L} \\rho A \\left( \\dot{\\mathbf{d}}^{T} \\mathbf{N}^{T}(x) \\mathbf{N}(x) \\dot{\\mathbf{d}} \\right) \\, \\mathrm{d}x$$\nSince the nodal velocities $\\dot{\\mathbf{d}}$ do not depend on the spatial coordinate $x$, we can write\n$$T = \\frac{1}{2} \\dot{\\mathbf{d}}^{T} \\left( \\rho A \\int_{0}^{L} \\mathbf{N}^{T}(x) \\mathbf{N}(x) \\, \\mathrm{d}x \\right) \\dot{\\mathbf{d}}$$\nThis is of the form $T = \\frac{1}{2} \\dot{\\mathbf{d}}^{T} \\mathbf{M}_{\\mathrm{e}} \\dot{\\mathbf{d}}$, where $\\mathbf{M}_{\\mathrm{e}}$ is the element mass matrix.\n\nFirst, we derive the consistent mass matrix, $\\mathbf{M}_{\\mathrm{c}}$, defined by the integral term:\n$$\\mathbf{M}_{\\mathrm{c}} = \\rho A \\int_{0}^{L} \\mathbf{N}^{T}(x) \\mathbf{N}(x) \\, \\mathrm{d}x = \\rho A \\int_{0}^{L} \\begin{pmatrix} N_1(x)^2 & N_1(x)N_2(x) \\\\ N_2(x)N_1(x) & N_2(x)^2 \\end{pmatrix} \\, \\mathrm{d}x$$\nThe components of the matrix require the evaluation of the following integrals:\n$$\\int_{0}^{L} N_1(x)^2 \\, \\mathrm{d}x = \\int_{0}^{L} \\left(1 - \\frac{x}{L}\\right)^2 \\, \\mathrm{d}x = \\left[ L - \\frac{x^2}{L} + \\frac{x^3}{3L^2} \\right]_{0}^{L} = L - L + \\frac{L}{3} = \\frac{L}{3}$$\n$$\\int_{0}^{L} N_2(x)^2 \\, \\mathrm{d}x = \\int_{0}^{L} \\left(\\frac{x}{L}\\right)^2 \\, \\mathrm{d}x = \\left[ \\frac{x^3}{3L^2} \\right]_{0}^{L} = \\frac{L}{3}$$\n$$\\int_{0}^{L} N_1(x)N_2(x) \\, \\mathrm{d}x = \\int_{0}^{L} \\left(1 - \\frac{x}{L}\\right)\\left(\\frac{x}{L}\\right) \\, \\mathrm{d}x = \\left[ \\frac{x^2}{2L} - \\frac{x^3}{3L^2} \\right]_{0}^{L} = \\frac{L}{2} - \\frac{L}{3} = \\frac{L}{6}$$\nAssembling these results, the consistent mass matrix is:\n$$\\mathbf{M}_{\\mathrm{c}} = \\rho A \\begin{pmatrix} \\frac{L}{3} & \\frac{L}{6} \\\\ \\frac{L}{6} & \\frac{L}{3} \\end{pmatrix} = \\frac{\\rho A L}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$$\nNext, we construct the lumped mass matrix, $\\mathbf{M}_{\\mathrm{l}}$, by the row-sum lumping procedure. Each diagonal entry of $\\mathbf{M}_{\\mathrm{l}}$ is the sum of all entries in the corresponding row of $\\mathbf{M}_{\\mathrm{c}}$, and all off-diagonal entries are zero.\nSum of row $1$: $\\frac{\\rho A L}{6}(2+1) = \\frac{3\\rho A L}{6} = \\frac{\\rho A L}{2}$\nSum of row $2$: $\\frac{\\rho A L}{6}(1+2) = \\frac{3\\rho A L}{6} = \\frac{\\rho A L}{2}$\nThus, the lumped mass matrix is:\n$$\\mathbf{M}_{\\mathrm{l}} = \\begin{pmatrix} \\frac{\\rho A L}{2} & 0 \\\\ 0 & \\frac{\\rho A L}{2} \\end{pmatrix} = \\frac{\\rho A L}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$$\nThe kinetic energy calculated with the consistent mass matrix, $T_{\\mathrm{c}}$, is\n$$T_{\\mathrm{c}} = \\frac{1}{2} \\dot{\\mathbf{d}}^{T} \\mathbf{M}_{\\mathrm{c}} \\dot{\\mathbf{d}} = \\frac{1}{2} \\begin{pmatrix} \\dot{d}_1 & \\dot{d}_2 \\end{pmatrix} \\left( \\frac{\\rho A L}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} \\right) \\begin{pmatrix} \\dot{d}_1 \\\\ \\dot{d}_2 \\end{pmatrix}$$\n$$T_{\\mathrm{c}} = \\frac{\\rho A L}{12} \\left[ 2\\dot{d}_1^2 + 2\\dot{d}_1\\dot{d}_2 + 2\\dot{d}_2^2 \\right] = \\frac{\\rho A L}{6} \\left( \\dot{d}_1^2 + \\dot{d}_1\\dot{d}_2 + \\dot{d}_2^2 \\right)$$\nThe kinetic energy calculated with the lumped mass matrix, $T_{\\mathrm{l}}$, is\n$$T_{\\mathrm{l}} = \\frac{1}{2} \\dot{\\mathbf{d}}^{T} \\mathbf{M}_{\\mathrm{l}} \\dot{\\mathbf{d}} = \\frac{1}{2} \\begin{pmatrix} \\dot{d}_1 & \\dot{d}_2 \\end{pmatrix} \\left( \\frac{\\rho A L}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\right) \\begin{pmatrix} \\dot{d}_1 \\\\ \\dot{d}_2 \\end{pmatrix} = \\frac{\\rho A L}{4} \\left( \\dot{d}_1^2 + \\dot{d}_2^2 \\right)$$\nThe problem requires the ratio $R = T_{\\mathrm{c}} / T_{\\mathrm{l}}$.\n$$R = \\frac{\\frac{\\rho A L}{6} \\left( \\dot{d}_1^2 + \\dot{d}_1\\dot{d}_2 + \\dot{d}_2^2 \\right)}{\\frac{\\rho A L}{4} \\left( \\dot{d}_1^2 + \\dot{d}_2^2 \\right)}$$\nThe term $\\rho A L$ cancels, demonstrating that the ratio is independent of the material properties and element geometry.\n$$R = \\frac{4}{6} \\frac{\\dot{d}_1^2 + \\dot{d}_1\\dot{d}_2 + \\dot{d}_2^2}{\\dot{d}_1^2 + \\dot{d}_2^2} = \\frac{2}{3} \\frac{\\dot{d}_1^2 + \\dot{d}_1\\dot{d}_2 + \\dot{d}_2^2}{\\dot{d}_1^2 + \\dot{d}_2^2}$$\nNow, we substitute the given nodal velocities $\\dot{d}_1 = 0.35$ and $\\dot{d}_2 = 1.10$.\n$$\\dot{d}_1^2 = (0.35)^2 = 0.1225$$\n$$\\dot{d}_2^2 = (1.10)^2 = 1.21$$\n$$\\dot{d}_1\\dot{d}_2 = (0.35)(1.10) = 0.385$$\nSubstituting these values into the expression for $R$:\n$$R = \\frac{2}{3} \\frac{0.1225 + 0.385 + 1.21}{0.1225 + 1.21} = \\frac{2}{3} \\frac{1.7175}{1.3325}$$\nPerforming the calculation:\n$$R \\approx \\frac{2}{3} \\times 1.28893058... \\approx 0.85928705...$$\nRounding to four significant figures, the ratio is $0.8593$.", "answer": "$$\\boxed{0.8593}$$", "id": "2546885"}, {"introduction": "Building on the foundational definitions, we now explore the practical consequences of choosing a mass formulation in dynamic analysis. This exercise examines the free vibration of a 2D membrane, a classic problem where core calculations can be performed analytically for a simplified finite element model. By determining the fundamental vibration frequency $\\omega$ with both consistent and lumped mass matrices [@problem_id:2562470], you will directly observe how this choice impacts the system's predicted dynamic behavior, a critical consideration for ensuring accuracy in simulations.", "problem": "Consider free, transverse vibration of a homogeneous membrane on the unit square domain $\\Omega = [0,1]\\times[0,1]$ with clamped boundary (Dirichlet condition $u=0$ on $\\partial\\Omega$). The governing weak form is: find nontrivial $u$ and angular frequency $\\omega$ such that\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\Omega \\;=\\; \\omega^{2} \\int_{\\Omega} u \\, v \\, d\\Omega\n\\quad \\text{for all test functions } v.\n$$\nLet the membrane have uniform surface mass density $\\rho t = 1$. Discretize with the Finite Element Method (FEM) using piecewise linear (affine) shape functions on a uniform triangulation of $\\Omega$ obtained by dividing $\\Omega$ into $2\\times 2$ congruent squares of side length $h=1/2$, and then subdividing each square by the diagonal from its bottom-left corner to its top-right corner. This produces $8$ right triangles of area $A = h^{2}/2 = 1/8$. Use the standard consistent mass matrix (with entries $M_{ij} = \\int_{\\Omega} N_{i} N_{j} \\, d\\Omega$) and the row-sum lumped mass matrix (with diagonal entries $M^{L}_{ii} = \\sum_{j} M_{ij}$), and the standard stiffness matrix (with entries $K_{ij} = \\int_{\\Omega} \\nabla N_{i}\\cdot \\nabla N_{j}\\, d\\Omega$).\n\nTasks:\n1) Starting from the partition of unity property of the shape functions $\\sum_{i} N_{i} \\equiv 1$, prove that the assembled consistent mass matrix conserves the total mass exactly in the sense that\n$$\n\\boldsymbol{1}^{\\top} \\mathbf{M} \\, \\boldsymbol{1} \\;=\\; \\int_{\\Omega} 1 \\, d\\Omega \\;=\\; 1,\n$$\nwhere $\\boldsymbol{1}$ is the vector of ones. Then, show that the row-sum lumped mass matrix also exactly conserves total mass, i.e.,\n$$\n\\sum_{i} M^{L}_{ii} \\;=\\; \\boldsymbol{1}^{\\top} \\mathbf{M} \\, \\boldsymbol{1} \\;=\\; 1.\n$$\nAssume all integrals are evaluated exactly.\n\n2) Impose the Dirichlet boundary condition by eliminating boundary degrees of freedom, and observe that only the interior node at the center of the square remains. Compute explicitly the single-entry reduced stiffness and mass quantities needed for the generalized eigenvalue problem $\\mathbf{K}\\mathbf{u} = \\omega^{2} \\mathbf{M}\\mathbf{u}$ for this interior degree of freedom, using:\n- For each triangular element, the gradient of a linear shape function $N_{i}$ is constant on the element and can be written as $\\nabla N_{i} = \\frac{1}{2A} \\begin{bmatrix} b_{i} \\\\ c_{i} \\end{bmatrix}$, where $b_{i}$ and $c_{i}$ depend only on the element’s vertex coordinates.\n- The elemental consistent mass diagonal contribution is $\\int_{T} N_{i}^{2}\\, d\\Omega = \\frac{A}{6}$ and the row-sum lumped mass diagonal contribution is $\\frac{A}{3}$ for a linear triangle of area $A$.\n\n3) Using the assembled reduced quantities, form the one-degree-of-freedom generalized eigenvalue problems for the consistent and lumped mass matrices and determine the ratio of the predicted fundamental angular frequencies,\n$$\nR \\;=\\; \\frac{\\omega_{\\mathrm{lumped}}}{\\omega_{\\mathrm{consistent}}}.\n$$\nExpress your final answer for $R$ as a simplified exact expression with no units. Do not round.", "solution": "The problem statement is evaluated to be valid as it is scientifically grounded, well-posed, and objective. It represents a standard problem in the Finite Element Method for structural dynamics. We proceed with the solution, addressing each of the three tasks in order.\n\nThe governing generalized eigenvalue problem in matrix form is $\\mathbf{K}\\mathbf{u} = \\omega^{2}\\mathbf{M}\\mathbf{u}$, where $\\mathbf{K}$ is the global stiffness matrix with entries $K_{ij} = \\int_{\\Omega} \\nabla N_{i}\\cdot \\nabla N_{j}\\, d\\Omega$ and $\\mathbf{M}$ is the global mass matrix with entries $M_{ij} = \\int_{\\Omega} (\\rho t) N_{i} N_{j} \\, d\\Omega$. Given the uniform surface mass density $\\rho t = 1$, the mass matrix entries are $M_{ij} = \\int_{\\Omega} N_{i} N_{j} \\, d\\Omega$.\n\nTask 1: Proof of Mass Conservation\n\nWe are asked to prove that both the consistent and lumped mass matrices conserve the total mass of the membrane, which is $\\int_{\\Omega} \\rho t \\, d\\Omega = \\int_{\\Omega} 1 \\, d\\Omega = 1$.\n\nFirst, consider the consistent mass matrix $\\mathbf{M}$. The total mass represented by the matrix can be calculated by summing all its elements, which is equivalent to the quadratic form $\\boldsymbol{1}^{\\top} \\mathbf{M} \\boldsymbol{1}$, where $\\boldsymbol{1}$ is a column vector of ones.\n$$\n\\boldsymbol{1}^{\\top} \\mathbf{M} \\boldsymbol{1} = \\sum_{i} \\sum_{j} M_{ij}\n$$\nSubstituting the definition of the matrix entry $M_{ij}$, we have:\n$$\n\\sum_{i} \\sum_{j} M_{ij} = \\sum_{i} \\sum_{j} \\int_{\\Omega} N_{i}(x,y) N_{j}(x,y) \\, d\\Omega\n$$\nSince the integrals and summations are over finite sets of functions and nodes, we can interchange the order of integration and summation:\n$$\n\\int_{\\Omega} \\left( \\sum_{i} \\sum_{j} N_{i}(x,y) N_{j}(x,y) \\right) \\, d\\Omega = \\int_{\\Omega} \\left( \\sum_{i} N_{i}(x,y) \\right) \\left( \\sum_{j} N_{j}(x,y) \\right) \\, d\\Omega\n$$\nThe problem states that the shape functions $N_{k}$ satisfy the partition of unity property, $\\sum_{k} N_{k}(x,y) \\equiv 1$ for all $(x,y) \\in \\Omega$. Applying this property, the expression simplifies to:\n$$\n\\int_{\\Omega} (1) (1) \\, d\\Omega = \\int_{\\Omega} 1 \\, d\\Omega = \\mathrm{Area}(\\Omega)\n$$\nThe domain $\\Omega$ is the unit square $[0,1] \\times [0,1]$, so its area is $1 \\times 1 = 1$. Therefore, we have proven that:\n$$\n\\boldsymbol{1}^{\\top} \\mathbf{M} \\boldsymbol{1} = 1\n$$\nThis demonstrates that the consistent mass matrix correctly accounts for the total mass of the system.\n\nNext, consider the row-sum lumped mass matrix $\\mathbf{M}^{L}$, which is a diagonal matrix with entries $M^{L}_{ii} = \\sum_{j} M_{ij}$. The total mass in this formulation is the sum of all diagonal entries, as all off-diagonal entries are zero.\n$$\n\\sum_{i} M^{L}_{ii} = \\sum_{i} \\left( \\sum_{j} M_{ij} \\right)\n$$\nThis double summation is precisely the sum of all elements of the consistent mass matrix $\\mathbf{M}$, which we have already evaluated.\n$$\n\\sum_{i} M^{L}_{ii} = \\sum_{i} \\sum_{j} M_{ij} = \\boldsymbol{1}^{\\top} \\mathbf{M} \\boldsymbol{1} = 1\n$$\nThus, the row-sum lumped mass matrix also conserves the total mass exactly.\n\nTask 2: Computation of Reduced Stiffness and Mass\n\nThe mesh has nodes at coordinates $(i h, j h)$ for $i,j \\in \\{0, 1, 2\\}$ with $h=1/2$. This gives $9$ nodes. The Dirichlet boundary condition $u=0$ is imposed on all $8$ boundary nodes. The only remaining active degree of freedom corresponds to the interior node at $(1/2, 1/2)$. Let us denote this as node $p$. The reduced stiffness and mass matrices are $1 \\times 1$ scalars, $K_{red} = K_{pp}$ and $M_{red} = M_{pp}$.\n\nThe central node $p$ at $(1/2, 1/2)$ is a vertex for $6$ of the $8$ triangular elements. All elements are right isosceles triangles with area $A = h^2/2 = (1/2)^2/2 = 1/8$. The global matrix entries are assembled by summing contributions from these $6$ elements.\n\nFor a uniform grid of right triangles, the assembly of the stiffness matrix for an interior node using linear elements results in the standard five-point stencil for the Laplacian. For node $p$, the assembled stiffness value $K_{pp}$ is known to be $4$.\n\nThe total reduced stiffness $K_{red} = K_{pp}$ is the sum of these contributions from the 6 elements. Let's verify this using the properties given. The diagonal stiffness contribution from a single element at a right-angled vertex is $1$, and at an acute-angled vertex is $1/2$. For the central node, it is the right-angled vertex for two elements and an acute-angled vertex for four elements.\n$$\nK_{red} = K_{pp} = 2 \\times 1 + 4 \\times \\frac{1}{2} = 2 + 2 = 4\n$$\n\nFor the consistent mass matrix, the problem provides that the diagonal contribution from a linear triangle element is $\\int_{T} N_i^2 \\, d\\Omega = A/6$. Since node $p$ is connected to $6$ elements, each of area $A=1/8$, the reduced consistent mass $M_{red}$ is:\n$$\nM_{red} = M_{pp} = \\sum_{e=1}^{6} \\frac{A_e}{6} = 6 \\times \\frac{A}{6} = A = \\frac{1}{8}\n$$\n\nFor the row-sum lumped mass matrix, the diagonal contribution from a linear triangle element is given as $A/3$. The reduced lumped mass $M^L_{red}$ is the sum of contributions from the $6$ elements connected to node $p$:\n$$\nM^L_{red} = M^L_{pp} = \\sum_{e=1}^{6} \\frac{A_e}{3} = 6 \\times \\frac{A}{3} = 2A = 2 \\times \\frac{1}{8} = \\frac{1}{4}\n$$\n\nTask 3: Ratio of Fundamental Frequencies\n\nThe one-degree-of-freedom generalized eigenvalue problems for the fundamental angular frequency $\\omega$ are scalar equations.\n\nFor the consistent mass formulation:\n$$\nK_{red} u_p = \\omega_{\\mathrm{consistent}}^{2} M_{red} u_p\n$$\n$$\n4 u_p = \\omega_{\\mathrm{consistent}}^{2} \\left(\\frac{1}{8}\\right) u_p\n$$\nSolving for $\\omega_{\\mathrm{consistent}}^{2}$:\n$$\n\\omega_{\\mathrm{consistent}}^{2} = \\frac{4}{1/8} = 32\n$$\n\nFor the lumped mass formulation:\n$$\nK_{red} u_p = \\omega_{\\mathrm{lumped}}^{2} M^L_{red} u_p\n$$\n$$\n4 u_p = \\omega_{\\mathrm{lumped}}^{2} \\left(\\frac{1}{4}\\right) u_p\n$$\nSolving for $\\omega_{\\mathrm{lumped}}^{2}$:\n$$\n\\omega_{\\mathrm{lumped}}^{2} = \\frac{4}{1/4} = 16\n$$\n\nThe ratio $R$ is defined as $R = \\omega_{\\mathrm{lumped}} / \\omega_{\\mathrm{consistent}}$.\n$$\nR = \\frac{\\sqrt{\\omega_{\\mathrm{lumped}}^{2}}}{\\sqrt{\\omega_{\\mathrm{consistent}}^{2}}} = \\frac{\\sqrt{16}}{\\sqrt{32}} = \\frac{4}{4\\sqrt{2}} = \\frac{1}{\\sqrt{2}}\n$$\nRationalizing the denominator gives:\n$$\nR = \\frac{\\sqrt{2}}{2}\n$$", "answer": "$$\\boxed{\\frac{\\sqrt{2}}{2}}$$", "id": "2562470"}, {"introduction": "The choice between consistent and lumped mass matrices involves a classic engineering trade-off that extends beyond modal accuracy to computational efficiency, particularly in explicit dynamics. This problem guides you through a stability analysis of the explicit central difference method applied to a 1D bar model. By deriving the maximum stable time step, $\\Delta t_{\\max}$, for both formulations and exploring the practical technique of mass scaling [@problem_id:2546889], you will uncover the fundamental reasons why lumped mass formulations are often dominant in large-scale explicit simulations.", "problem": "A one-dimensional homogeneous elastic bar of undeformed length $L$ and constant cross-sectional area $A$ is modeled for small longitudinal motions. The bar has Young’s modulus $E$ and mass density $\\rho$, so the one-dimensional linear momentum balance for longitudinal displacement $u(x,t)$ is\n$$\n\\rho A\\,\\frac{\\partial^{2}u}{\\partial t^{2}} - E A\\,\\frac{\\partial^{2}u}{\\partial x^{2}}=0.\n$$\nThe bar is discretized uniformly into linear two-node finite elements of length $h$, with standard piecewise-linear shape functions used in a Galerkin formulation. Time integration is performed by the explicit central difference method. Consider two spatial mass formulations: the consistent mass matrix and the lumped (diagonal) mass matrix.\n\nStarting from the governing equation above and the Galerkin semi-discretization with uniform mesh spacing $h$, do the following:\n\n1) For an interior node in an infinite uniform mesh (or sufficiently large periodic mesh), derive the element-level mass and stiffness matrices, assemble the interior nodal equations, and perform a discrete plane-wave analysis by substituting the ansatz $u_{i}(t)=\\hat{u}\\,\\exp\\!\\left(i(i\\theta-\\omega t)\\right)$, where $i$ indexes the nodes, $\\theta\\in[0,\\pi]$ is the nondimensional wavenumber, and $\\omega$ is the circular frequency. From this, obtain the dispersion relation $\\omega(\\theta)$ for:\n- the consistent mass formulation,\n- the lumped mass formulation.\n\n2) Using the single-degree-of-freedom stability requirement of the explicit central difference scheme applied mode-by-mode to the semi-discrete system, determine the maximum stable time step $\\Delta t_{\\max}$ for each mass formulation as a function of $h$, $E$, and $\\rho$.\n\n3) You will run the simulation with the consistent mass formulation, but you wish to use a target step size $\\Delta t_{\\text{target}}$ that exceeds the unscaled stable limit. You therefore apply uniform mass scaling by a scalar factor $s>1$ (equivalently, scale the density to $s\\rho$ while keeping the stiffness unchanged). Derive the minimal $s$ required so that the central difference scheme is stable at $\\Delta t_{\\text{target}}$ for the consistent mass formulation.\n\nUse the following numerical data:\n- $E=210\\times 10^{9}\\ \\mathrm{Pa}$,\n- $\\rho=7800\\ \\mathrm{kg/m^{3}}$,\n- $h=1.00\\times 10^{-3}\\ \\mathrm{m}$,\n- $\\Delta t_{\\text{target}}=3.00\\times 10^{-7}\\ \\mathrm{s}$.\n\nRound your final numerical answer for $s$ to four significant figures. Report only the dimensionless $s$; do not include units in your final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It is a standard exercise in the numerical analysis of partial differential equations using the finite element method, specifically addressing dispersion analysis and stability of explicit time integration schemes. All required data and definitions are provided, and no contradictions or ambiguities are present. The problem is valid. I will proceed with the solution derivation.\n\nThe governing equation for longitudinal displacement $u(x,t)$ is the one-dimensional wave equation:\n$$\n\\rho A \\frac{\\partial^2 u}{\\partial t^2} - E A \\frac{\\partial^2 u}{\\partial x^2} = 0\n$$\nwhere $\\rho$ is the mass density, $E$ is Young's modulus, and $A$ is the cross-sectional area. The speed of wave propagation in the continuous medium is $c_0 = \\sqrt{E/\\rho}$.\n\nThe Galerkin semi-discretization of this equation leads to a system of ordinary differential equations in time:\n$$\n\\mathbf{M} \\ddot{\\mathbf{u}} + \\mathbf{K} \\mathbf{u} = \\mathbf{0}\n$$\nwhere $\\mathbf{M}$ is the global mass matrix, $\\mathbf{K}$ is the global stiffness matrix, and $\\mathbf{u}$ is the vector of nodal displacements.\n\nWe consider a uniform mesh of linear two-node elements of length $h$. For a generic element defined on the local domain $\\xi \\in [0, h]$, the linear shape functions are $N_1(\\xi) = 1 - \\xi/h$ and $N_2(\\xi) = \\xi/h$.\n\nThe element stiffness matrix $\\mathbf{K}^e$ is given by:\n$$\nK^e_{ij} = \\int_0^h E A \\frac{dN_i}{d\\xi} \\frac{dN_j}{d\\xi} d\\xi\n$$\nWith $\\frac{dN_1}{d\\xi} = -1/h$ and $\\frac{dN_2}{d\\xi} = 1/h$, the computation yields:\n$$\n\\mathbf{K}^e = \\frac{E A}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nThe element consistent mass matrix $\\mathbf{M}_C^e$ is given by:\n$$\nM^e_{C,ij} = \\int_0^h \\rho A N_i(\\xi) N_j(\\xi) d\\xi\n$$\nThe computation yields:\n$$\n\\mathbf{M}_C^e = \\frac{\\rho A h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\nThe element lumped mass matrix $\\mathbf{M}_L^e$ is obtained by summing the rows of $\\mathbf{M}_C^e$ and placing the result on the diagonal:\n$$\n\\mathbf{M}_L^e = \\frac{\\rho A h}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n\n**1) Dispersion Relations**\n\nWe analyze the equation of motion for an interior node $i$, which is connected to elements $(i-1)$ and $(i)$. Assembling the contributions from these two elements, we obtain the nodal equation.\n\nFor the stiffness part, the assembly is identical for both mass formulations:\n$$\n(K u)_i = \\frac{E A}{h} (-u_{i-1} + 2u_i - u_{i+1})\n$$\nFor the mass part, we have two cases.\nConsistent mass:\n$$\n(M_C \\ddot{u})_i = \\frac{\\rho A h}{6} (\\ddot{u}_{i-1} + 4\\ddot{u}_i + \\ddot{u}_{i+1})\n$$\nLumped mass:\n$$\n(M_L \\ddot{u})_i = \\rho A h \\ddot{u}_i\n$$\nWe substitute the discrete plane-wave ansatz $u_j(t) = \\hat{u} \\exp(i(j\\theta - \\omega t))$, which implies $\\ddot{u}_j(t) = -\\omega^2 u_j(t)$. The relations $u_{j\\pm 1} = u_j \\exp(\\pm i\\theta)$ hold.\n\n- **Consistent Mass Formulation:**\nThe assembled equation is:\n$$\n\\frac{\\rho A h}{6} (\\ddot{u}_{i-1} + 4\\ddot{u}_i + \\ddot{u}_{i+1}) + \\frac{E A}{h} (-u_{i-1} + 2u_i - u_{i+1}) = 0\n$$\nSubstituting the ansatz and dividing by common factors:\n$$\n-\\omega^2 \\frac{\\rho h}{6} (\\exp(-i\\theta) + 4 + \\exp(i\\theta)) + \\frac{E}{h} (-\\exp(-i\\theta) + 2 - \\exp(i\\theta)) = 0\n$$\n$$\n-\\omega^2 \\frac{\\rho h}{6} (4 + 2\\cos\\theta) + \\frac{E}{h} (2 - 2\\cos\\theta) = 0\n$$\nSolving for $\\omega^2$:\n$$\n\\omega_C^2 = \\frac{E}{\\rho} \\frac{6}{h^2} \\frac{2(1-\\cos\\theta)}{2(2+\\cos\\theta)} = c_0^2 \\frac{6}{h^2} \\frac{1-\\cos\\theta}{2+\\cos\\theta}\n$$\nUsing the half-angle identity $1-\\cos\\theta = 2\\sin^2(\\theta/2)$:\n$$\n\\omega_C^2 = c_0^2 \\frac{12}{h^2} \\frac{\\sin^2(\\theta/2)}{3 - 2\\sin^2(\\theta/2)}\n$$\nThe dispersion relation is $\\omega_C(\\theta) = \\frac{2\\sqrt{3}c_0}{h} \\frac{|\\sin(\\theta/2)|}{\\sqrt{3-2\\sin^2(\\theta/2)}}$.\n\n- **Lumped Mass Formulation:**\nThe assembled equation is:\n$$\n\\rho A h \\ddot{u}_i + \\frac{E A}{h} (-u_{i-1} + 2u_i - u_{i+1}) = 0\n$$\nSubstituting the ansatz:\n$$\n-\\omega^2 \\rho h + \\frac{E}{h} (2 - 2\\cos\\theta) = 0\n$$\nSolving for $\\omega^2$:\n$$\n\\omega_L^2 = \\frac{E}{\\rho h^2} (2 - 2\\cos\\theta) = c_0^2 \\frac{2}{h^2} (1-\\cos\\theta)\n$$\nUsing the half-angle identity:\n$$\n\\omega_L^2 = c_0^2 \\frac{4}{h^2} \\sin^2(\\theta/2)\n$$\nThe dispersion relation is $\\omega_L(\\theta) = \\frac{2c_0}{h} |\\sin(\\theta/2)|$.\n\n**2) Maximum Stable Time Step**\n\nThe stability condition for the explicit central difference method is $\\Delta t \\le 2/\\omega_{\\max}$, where $\\omega_{\\max}$ is the maximum natural frequency of the discrete system. This maximum occurs at the highest non-dimensional wavenumber, $\\theta = \\pi$.\n\n- **Consistent Mass Formulation:**\nAt $\\theta = \\pi$, $\\sin^2(\\theta/2) = \\sin^2(\\pi/2) = 1$.\n$$\n\\omega_{C, \\max}^2 = c_0^2 \\frac{12}{h^2} \\frac{1}{3-2} = \\frac{12 c_0^2}{h^2}\n$$\n$$\n\\omega_{C, \\max} = \\frac{2\\sqrt{3}c_0}{h} = \\frac{2\\sqrt{3}}{h}\\sqrt{\\frac{E}{\\rho}}\n$$\nThe maximum stable time step is:\n$$\n\\Delta t_{\\max, C} = \\frac{2}{\\omega_{C, \\max}} = \\frac{2h}{2\\sqrt{3}c_0} = \\frac{h}{\\sqrt{3}}\\sqrt{\\frac{\\rho}{E}}\n$$\n\n- **Lumped Mass Formulation:**\nAt $\\theta=\\pi$:\n$$\n\\omega_{L, \\max}^2 = c_0^2 \\frac{4}{h^2} \\sin^2(\\pi/2) = \\frac{4c_0^2}{h^2}\n$$\n$$\n\\omega_{L, \\max} = \\frac{2c_0}{h} = \\frac{2}{h}\\sqrt{\\frac{E}{\\rho}}\n$$\nThe maximum stable time step is:\n$$\n\\Delta t_{\\max, L} = \\frac{2}{\\omega_{L, \\max}} = \\frac{2h}{2c_0} = \\frac{h}{c_0} = h\\sqrt{\\frac{\\rho}{E}}\n$$\n\n**3) Mass Scaling Factor**\n\nWe apply mass scaling to the consistent mass formulation by a factor $s$, replacing $\\rho$ with $\\rho' = s\\rho$. The stiffness $E$ remains unchanged. The new stability limit, $\\Delta t'_{\\max, C}$, is:\n$$\n\\Delta t'_{\\max, C} = \\frac{h}{\\sqrt{3}}\\sqrt{\\frac{\\rho'}{E}} = \\frac{h}{\\sqrt{3}}\\sqrt{\\frac{s\\rho}{E}} = \\left(\\frac{h}{\\sqrt{3}}\\sqrt{\\frac{\\rho}{E}}\\right)\\sqrt{s} = \\Delta t_{\\max, C} \\sqrt{s}\n$$\nWe require the scheme to be stable for a target time step $\\Delta t_{\\text{target}}$. The minimal scaling factor $s$ is found by setting the new stability limit equal to this target step size:\n$$\n\\Delta t_{\\text{target}} = \\Delta t'_{\\max, C} = \\frac{h\\sqrt{s}}{\\sqrt{3}}\\sqrt{\\frac{\\rho}{E}}\n$$\nSolving for $s$:\n$$\n\\sqrt{s} = \\frac{\\Delta t_{\\text{target}}\\sqrt{3}}{h}\\sqrt{\\frac{E}{\\rho}}\n$$\n$$\ns = 3 \\left(\\frac{\\Delta t_{\\text{target}}}{h}\\right)^2 \\left(\\frac{E}{\\rho}\\right)\n$$\nWe now substitute the provided numerical data:\n$E=210 \\times 10^9\\ \\mathrm{Pa}$, $\\rho=7800\\ \\mathrm{kg/m^3}$, $h=1.00 \\times 10^{-3}\\ \\mathrm{m}$, and $\\Delta t_{\\text{target}}=3.00 \\times 10^{-7}\\ \\mathrm{s}$.\n$$\ns = 3 \\left(\\frac{3.00 \\times 10^{-7}}{1.00 \\times 10^{-3}}\\right)^2 \\left(\\frac{210 \\times 10^9}{7800}\\right)\n$$\n$$\ns = 3 \\left(3.00 \\times 10^{-4}\\right)^2 \\left(\\frac{2.1 \\times 10^{11}}{7.8 \\times 10^3}\\right)\n$$\n$$\ns = 3 \\times (9.00 \\times 10^{-8}) \\times (2.692307... \\times 10^7)\n$$\n$$\ns = 27.00 \\times 10^{-8} \\times 2.692307... \\times 10^7\n$$\n$$\ns = 2.700 \\times 10^{-7} \\times 2.692307... \\times 10^7 = 2.700 \\times 2.692307...\n$$\n$$\ns = 7.2692307...\n$$\nRounding to four significant figures, the minimal scaling factor is $s = 7.269$.", "answer": "$$\\boxed{7.269}$$", "id": "2546889"}]}