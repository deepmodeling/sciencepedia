{"hands_on_practices": [{"introduction": "The first step in analyzing the dynamics of a structure using the Finite Element Method is to discretize the governing equations of motion. This practice guides you through the fundamental process of deriving the consistent element mass matrix for a simple one-dimensional bar from first principles. By applying the Galerkin method to the weak form of the elastodynamics equation, you will develop a core skill and gain insight into how the inertial properties of a continuous body are systematically distributed to the element's nodes [@problem_id:2594295].", "problem": "Consider a uniform, prismatic, one-dimensional axial bar occupying the interval $x \\in [0,L]$, with constant cross-sectional area $A$ and material density $\\rho$. Let $u(x,t)$ denote the axial displacement. The governing equation for axial motion follows from the balance of linear momentum (Newton’s second law) applied to a differential bar segment, giving the strong form of one-dimensional elastodynamics:\n$$\\rho A \\,\\ddot{u}(x,t) - \\frac{\\partial}{\\partial x}\\!\\big(EA\\,\\frac{\\partial u}{\\partial x}(x,t)\\big) = A\\,b(x,t),$$\nwhere $E$ is Young’s modulus and $b(x,t)$ is the axial body force per unit volume. Use the standard Galerkin procedure from the Finite Element Method (FEM) to obtain the semi-discrete equations of motion for a single $2$-node linear bar element with nodes at $x=0$ and $x=L$. Assume the displacement field is approximated by\n$$u(x,t) \\approx N_1(x)\\,d_1(t) + N_2(x)\\,d_2(t),$$\nwith the linear shape functions\n$$N_1(x) = 1 - \\frac{x}{L},\\qquad N_2(x) = \\frac{x}{L},$$\nand take the weighting functions equal to the shape functions (Galerkin choice). Derive, from first principles starting with the weak form, the element-level semi-discrete equations and identify the consistent element mass matrix $\\mathbf{M}^{e}$ as the coefficient matrix multiplying the nodal accelerations. Then evaluate the necessary integrals explicitly over $x \\in [0,L]$ to obtain a closed-form expression for $\\mathbf{M}^{e}$ in terms of $\\rho$, $A$, and $L$.\n\nProvide the final element mass matrix as a single analytic expression. Do not substitute numerical values, do not include units, and do not round.", "solution": "The problem statement is reviewed and found to be valid. It is scientifically grounded, well-posed, objective, and contains all necessary information to derive the consistent mass matrix for a one-dimensional linear bar element using the Galerkin method. It is a standard problem in the study of the Finite Element Method. We shall proceed with the derivation.\n\nThe starting point is the strong form of the governing equation for one-dimensional elastodynamics, given as:\n$$ \\rho A \\,\\ddot{u}(x,t) - \\frac{\\partial}{\\partial x}\\!\\left(EA\\,\\frac{\\partial u}{\\partial x}(x,t)\\right) = A\\,b(x,t) $$\nwhere $\\rho$ is the material density, $A$ is the cross-sectional area, $u(x,t)$ is the axial displacement, $E$ is Young's modulus, and $b(x,t)$ is the body force per unit volume. The double dot, $\\ddot{u}$, denotes the second partial derivative with respect to time, $t$.\n\nTo derive the weak form, we multiply the equation by an arbitrary weighting function, $w(x)$, and integrate over the domain of a single finite element, which spans from $x=0$ to $x=L$.\n$$ \\int_{0}^{L} w(x) \\left[ \\rho A \\,\\ddot{u}(x,t) - \\frac{\\partial}{\\partial x}\\!\\left(EA\\,\\frac{\\partial u}{\\partial x}\\right) \\right] dx = \\int_{0}^{L} w(x) A\\,b(x,t) dx $$\nWe rearrange the terms and apply integration by parts to the term containing the second spatial derivative of $u$. This procedure reduces the continuity requirement on the displacement field $u(x,t)$.\n$$ \\int_{0}^{L} w(x) \\rho A \\ddot{u} \\,dx - \\int_{0}^{L} w(x) \\frac{\\partial}{\\partial x}\\!\\left(EA\\,\\frac{\\partial u}{\\partial x}\\right) dx = \\int_{0}^{L} w(x) A\\,b(x,t) dx $$\nThe second term on the left-hand side is integrated by parts:\n$$ \\int_{0}^{L} w(x) \\frac{\\partial}{\\partial x}\\!\\left(EA\\,\\frac{\\partial u}{\\partial x}\\right) dx = \\left[ w(x) EA \\frac{\\partial u}{\\partial x} \\right]_{0}^{L} - \\int_{0}^{L} \\frac{\\partial w}{\\partial x} EA \\frac{\\partial u}{\\partial x} dx $$\nSubstituting this back into the integrated equation gives the weak form for the element:\n$$ \\int_{0}^{L} w(x) \\rho A \\ddot{u} \\,dx + \\int_{0}^{L} \\frac{\\partial w}{\\partial x} EA \\frac{\\partial u}{\\partial x} dx = \\int_{0}^{L} w(x) A\\,b(x,t) dx + \\left[ w(x) EA \\frac{\\partial u}{\\partial x} \\right]_{0}^{L} $$\nThis equation must hold for any admissible weighting function $w(x)$. The term on the right-hand side represents the work done by the external forces, including body forces and nodal forces (boundary tractions).\n\nNext, we introduce the finite element approximation for the displacement field $u(x,t)$ over the element. For a $2$-node linear element, the displacement is interpolated from the nodal displacements $d_1(t)$ and $d_2(t)$ using linear shape functions $N_1(x)$ and $N_2(x)$:\n$$ u(x,t) \\approx u^h(x,t) = N_1(x)d_1(t) + N_2(x)d_2(t) = \\mathbf{N}(x)\\mathbf{d}(t) $$\nwhere $\\mathbf{N}(x) = \\begin{pmatrix} N_1(x) & N_2(x) \\end{pmatrix}$ is the matrix of shape functions and $\\mathbf{d}(t) = \\begin{pmatrix} d_1(t) \\\\ d_2(t) \\end{pmatrix}$ is the vector of nodal displacements. The shape functions are given as $N_1(x) = 1 - \\frac{x}{L}$ and $N_2(x) = \\frac{x}{L}$.\n\nThe required derivatives are:\n$$ \\ddot{u}(x,t) \\approx \\mathbf{N}(x)\\ddot{\\mathbf{d}}(t) $$\n$$ \\frac{\\partial u}{\\partial x}(x,t) \\approx \\frac{d\\mathbf{N}}{dx}\\mathbf{d}(t) = \\mathbf{B}(x)\\mathbf{d}(t) $$\nwhere $\\mathbf{B}(x) = \\begin{pmatrix} \\frac{dN_1}{dx} & \\frac{dN_2}{dx} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{L} & \\frac{1}{L} \\end{pmatrix}$.\n\nIn the Galerkin method, the weighting functions are chosen to be the shape functions themselves, i.e., $w(x)$ is set to $N_i(x)$ for $i=1, 2$. This can be expressed in matrix form by setting the vector of weighting functions to $\\mathbf{w}(x) = \\mathbf{N}^T(x)$. Substituting these approximations into the weak form yields a system of ordinary differential equations:\n$$ \\left( \\int_{0}^{L} \\mathbf{N}^T(x) \\rho A \\mathbf{N}(x) dx \\right) \\ddot{\\mathbf{d}}(t) + \\left( \\int_{0}^{L} \\mathbf{B}^T(x) EA \\mathbf{B}(x) dx \\right) \\mathbf{d}(t) = \\mathbf{F}^e(t) $$\nwhere $\\mathbf{F}^e(t)$ is the element force vector. This is the semi-discrete equation of motion, $\\mathbf{M}^e \\ddot{\\mathbf{d}}(t) + \\mathbf{K}^e \\mathbf{d}(t) = \\mathbf{F}^e(t)$.\n\nThe problem requests the derivation of the consistent element mass matrix, $\\mathbf{M}^e$, which is the coefficient matrix of the nodal accelerations, $\\ddot{\\mathbf{d}}(t)$.\n$$ \\mathbf{M}^e = \\int_{0}^{L} \\mathbf{N}^T(x) \\rho A \\mathbf{N}(x) dx = \\rho A \\int_{0}^{L} \\begin{pmatrix} N_1(x) \\\\ N_2(x) \\end{pmatrix} \\begin{pmatrix} N_1(x) & N_2(x) \\end{pmatrix} dx $$\n$$ \\mathbf{M}^e = \\rho A \\int_{0}^{L} \\begin{pmatrix} N_1^2(x) & N_1(x)N_2(x) \\\\ N_2(x)N_1(x) & N_2^2(x) \\end{pmatrix} dx $$\nWe evaluate the integrals for each component of the matrix $\\mathbf{M}^e_{ij} = \\rho A \\int_0^L N_i(x)N_j(x) dx$.\n\nComponent $\\mathbf{M}^e_{11}$:\n$$ \\mathbf{M}^e_{11} = \\rho A \\int_{0}^{L} (1 - \\frac{x}{L})^2 dx = \\rho A \\left[ -L\\frac{(1 - \\frac{x}{L})^3}{3} \\right]_{0}^{L} = \\rho A \\left( 0 - (-L\\frac{1}{3}) \\right) = \\frac{\\rho A L}{3} $$\n\nComponent $\\mathbf{M}^e_{22}$:\n$$ \\mathbf{M}^e_{22} = \\rho A \\int_{0}^{L} (\\frac{x}{L})^2 dx = \\frac{\\rho A}{L^2} \\int_{0}^{L} x^2 dx = \\frac{\\rho A}{L^2} \\left[ \\frac{x^3}{3} \\right]_{0}^{L} = \\frac{\\rho A}{L^2} \\frac{L^3}{3} = \\frac{\\rho A L}{3} $$\n\nComponent $\\mathbf{M}^e_{12} = \\mathbf{M}^e_{21}$ (by symmetry):\n$$ \\mathbf{M}^e_{12} = \\rho A \\int_{0}^{L} (1 - \\frac{x}{L})(\\frac{x}{L}) dx = \\rho A \\int_{0}^{L} (\\frac{x}{L} - \\frac{x^2}{L^2}) dx = \\rho A \\left[ \\frac{x^2}{2L} - \\frac{x^3}{3L^2} \\right]_{0}^{L} $$\n$$ \\mathbf{M}^e_{12} = \\rho A \\left( (\\frac{L^2}{2L} - \\frac{L^3}{3L^2}) - 0 \\right) = \\rho A \\left( \\frac{L}{2} - \\frac{L}{3} \\right) = \\rho A \\left( \\frac{3L - 2L}{6} \\right) = \\frac{\\rho A L}{6} $$\n\nAssembling the components into the matrix $\\mathbf{M}^e$:\n$$ \\mathbf{M}^e = \\begin{pmatrix} \\frac{\\rho A L}{3} & \\frac{\\rho A L}{6} \\\\ \\frac{\\rho A L}{6} & \\frac{\\rho A L}{3} \\end{pmatrix} $$\nThis can be written in factored form, which is the final answer.\n$$ \\mathbf{M}^e = \\frac{\\rho A L}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} $$", "answer": "$$\n\\boxed{\\frac{\\rho A L}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}}\n$$", "id": "2594295"}, {"introduction": "An essential test for any structural element formulation is its ability to correctly represent rigid-body motion, which should produce no internal strain energy. This exercise challenges you to verify this fundamental principle for a planar Euler-Bernoulli beam element by showing that its stiffness matrix appropriately annihilates the rigid-body modes. This practice provides deep insight into the physical meaning of the semi-discrete equations and introduces the powerful concept of analyzing system behavior in a modal subspace [@problem_id:2594259].", "problem": "Consider a uniform, prismatic, planar Euler–Bernoulli beam element (two-node, cubic Hermite interpolation) of length $L$, cross-sectional area $A$, mass density $\\rho$, and flexural rigidity $E I$. Let the element nodal degrees of freedom be ordered as $\\mathbf{q} = [v_1,\\ \\varphi_1,\\ v_2,\\ \\varphi_2]^{\\mathsf{T}}$, where $v_i$ is the transverse displacement and $\\varphi_i$ is the rotation (slope) at node $i$. Use the standard Galerkin semi-discretization starting from the fundamental energetic definitions: the consistent element mass matrix satisfies $M_{ij} = \\int_{0}^{L} \\rho A\\, N_i(x)\\, N_j(x)\\, \\mathrm{d}x$, and the element stiffness matrix satisfies $K_{ij} = \\int_{0}^{L} E I\\, N_i''(x)\\, N_j''(x)\\, \\mathrm{d}x$, where $N_i(x)$ are the Euler–Bernoulli Hermite shape functions associated to the entries of $\\mathbf{q}$ and $N_i''(x)$ denotes the second derivative with respect to $x$.\n\na) Identify two linearly independent rigid-body modes for this free-free element in the nodal basis $\\mathbf{q}$, one corresponding to a pure rigid translation and the other to a pure rigid rotation. Impose the normalization constraints that the translation mode has $v_1=1$ and $\\varphi_1=0$, and the rotation mode has $\\varphi_1=\\varphi_2=1$ with $v_1=0$. Denote these column vectors by $\\boldsymbol{\\phi}_t$ and $\\boldsymbol{\\phi}_r$, respectively, and set $\\boldsymbol{\\Phi} = [\\boldsymbol{\\phi}_t\\ \\ \\boldsymbol{\\phi}_r]$.\n\nb) Using only the foundational definitions of Euler–Bernoulli beam theory, verify that the element stiffness annihilates both rigid-body modes, i.e., $\\mathbf{K} \\boldsymbol{\\phi}_t = \\mathbf{0}$ and $\\mathbf{K} \\boldsymbol{\\phi}_r = \\mathbf{0}$.\n\nc) Form the $2 \\times 2$ generalized mass matrix $\\mathbf{G} = \\boldsymbol{\\Phi}^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\Phi}$ induced on the rigid-body subspace, and compute its determinant in closed form as a function of $\\rho$, $A$, and $L$. Express your final answer as a symbolic expression in terms of $\\rho$, $A$, and $L$ only; do not attach units.", "solution": "The problem shall be validated before any attempt at a solution is made.\n\nThe givens are:\n- A uniform, prismatic, planar Euler–Bernoulli beam element.\n- Length: $L$.\n- Cross-sectional area: $A$.\n- Mass density: $\\rho$.\n- Flexural rigidity: $E I$.\n- Nodal degrees of freedom (DOF) vector: $\\mathbf{q} = [v_1,\\ \\varphi_1,\\ v_2,\\ \\varphi_2]^{\\mathsf{T}}$.\n- $v_i$: transverse displacement at node $i$.\n- $\\varphi_i$: rotation at node $i$.\n- Consistent mass matrix definition: $M_{ij} = \\int_{0}^{L} \\rho A\\, N_i(x)\\, N_j(x)\\, \\mathrm{d}x$.\n- Stiffness matrix definition: $K_{ij} = \\int_{0}^{L} E I\\, N_i''(x)\\, N_j''(x)\\, \\mathrm{d}x$.\n- $N_i(x)$: Hermite shape functions.\n- Rigid translation mode $\\boldsymbol{\\phi}_t$ constraints: $v_1=1$, $\\varphi_1=0$.\n- Rigid rotation mode $\\boldsymbol{\\phi}_r$ constraints: $\\varphi_1=\\varphi_2=1$, $v_1=0$.\n- Matrix of rigid-body modes: $\\boldsymbol{\\Phi} = [\\boldsymbol{\\phi}_t\\ \\ \\boldsymbol{\\phi}_r]$.\n\nThe problem is scientifically grounded, formulated in standard anelasticity and finite element theory. It is well-posed, as the constraints provided are sufficient to uniquely determine the necessary quantities. The language is objective and precise. All necessary information is provided. The problem is deemed valid.\n\nThe solution proceeds in three parts as requested.\n\na) Identification of rigid-body modes\n\nA rigid-body motion for a planar beam is described by a displacement field $v(x)$ that is at most linear in the spatial coordinate $x$. This is because such a motion induces no curvature, $v''(x) = 0$, and thus no strain. The general form is $v(x) = c_0 + c_1 x$, where $c_0$ and $c_1$ are constants. The rotation is the slope, $\\varphi(x) = v'(x) = c_1$.\n\nFor the rigid translation mode, $\\boldsymbol{\\phi}_t$:\nThe motion is a pure translation, so $v(x) = c_0$ and $\\varphi(x) = 0$.\nThe problem imposes the constraints $v_1 = v(0) = 1$ and $\\varphi_1 = \\varphi(0) = 0$.\nFrom $v(0)=1$, we have $c_0=1$. The displacement field must be $v(x) = 1$.\nThe nodal DOFs corresponding to this field are:\n$v_1 = v(0) = 1$\n$\\varphi_1 = v'(0) = 0$\n$v_2 = v(L) = 1$\n$\\varphi_2 = v'(L) = 0$\nAs a column vector, the translation mode is $\\boldsymbol{\\phi}_t = [1,\\ 0,\\ 1,\\ 0]^{\\mathsf{T}}$.\n\nFor the rigid rotation mode, $\\boldsymbol{\\phi}_r$:\nThe motion is a pure rotation about some center, described by $v(x) = c_0 + c_1 x$.\nThe problem imposes the constraints $\\varphi_1 = \\varphi(0) = 1$, $\\varphi_2 = \\varphi(L) = 1$, and $v_1 = v(0) = 0$.\nFrom $\\varphi(x) = c_1$, the constraints $\\varphi(0)=1$ and $\\varphi(L)=1$ both yield $c_1=1$.\nFrom $v(0)=0$, we have $c_0 + c_1(0) = 0$, so $c_0=0$.\nThe displacement field must be $v(x) = x$. This represents a rigid rotation about the origin $x=0$.\nThe nodal DOFs corresponding to this field are:\n$v_1 = v(0) = 0$\n$\\varphi_1 = v'(0) = 1$\n$v_2 = v(L) = L$\n$\\varphi_2 = v'(L) = 1$\nAs a column vector, the rotation mode is $\\boldsymbol{\\phi}_r = [0,\\ 1,\\ L,\\ 1]^{\\mathsf{T}}$.\n\nThe matrix of rigid-body modes is $\\boldsymbol{\\Phi} = [\\boldsymbol{\\phi}_t\\ \\ \\boldsymbol{\\phi}_r] = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & L \\\\ 0 & 1 \\end{pmatrix}$.\n\nb) Verification of stiffness matrix annihilation\n\nThe element stiffness matrix $\\mathbf{K}$ must annihilate any rigid-body mode vector $\\boldsymbol{\\phi}$. This is a fundamental property reflecting that rigid-body motion induces no strain and hence no elastic restoring forces. We must show $\\mathbf{K} \\boldsymbol{\\phi} = \\mathbf{0}$.\nThe $i$-th component of the vector $\\mathbf{K} \\boldsymbol{\\phi}$ is given by $(\\mathbf{K}\\boldsymbol{\\phi})_i = \\sum_{j=1}^{4} K_{ij} \\boldsymbol{\\phi}_j$.\nSubstituting the definition of $K_{ij}$:\n$$ (\\mathbf{K}\\boldsymbol{\\phi})_i = \\sum_{j=1}^{4} \\left( \\int_{0}^{L} E I\\, N_i''(x)\\, N_j''(x)\\, \\mathrm{d}x \\right) \\boldsymbol{\\phi}_j $$\nBy linearity of integration, we can write:\n$$ (\\mathbf{K}\\boldsymbol{\\phi})_i = \\int_{0}^{L} E I\\, N_i''(x) \\left( \\sum_{j=1}^{4} N_j''(x) \\boldsymbol{\\phi}_j \\right) \\mathrm{d}x $$\nThe expression $\\sum_{j=1}^{4} N_j(x) \\boldsymbol{\\phi}_j$ represents the displacement field $v_\\phi(x)$ corresponding to the nodal displacements in $\\boldsymbol{\\phi}$. Therefore, the term in the parentheses is the second derivative of this field:\n$$ v_\\phi''(x) = \\left( \\sum_{j=1}^{4} N_j(x) \\boldsymbol{\\phi}_j \\right)'' = \\sum_{j=1}^{4} N_j''(x) \\boldsymbol{\\phi}_j $$\nFor any rigid-body mode, the corresponding displacement field $v_\\phi(x)$ is at most linear, so its second derivative $v_\\phi''(x)$ must be identically zero for all $x \\in [0, L]$.\nWe have already established the displacement fields: $v_t(x) = 1$ for $\\boldsymbol{\\phi}_t$ and $v_r(x) = x$ for $\\boldsymbol{\\phi}_r$.\nFor the translation mode $\\boldsymbol{\\phi}_t$, we have $v_t''(x) = (1)'' = 0$.\nFor the rotation mode $\\boldsymbol{\\phi}_r$, we have $v_r''(x) = (x)'' = 0$.\nThus, for both modes, the integrand is zero:\n$$ (\\mathbf{K}\\boldsymbol{\\phi}_t)_i = \\int_{0}^{L} E I\\, N_i''(x) \\cdot (0) \\, \\mathrm{d}x = 0 $$\n$$ (\\mathbf{K}\\boldsymbol{\\phi}_r)_i = \\int_{0}^{L} E I\\, N_i''(x) \\cdot (0) \\, \\mathrm{d}x = 0 $$\nSince this holds for each component $i=1, 2, 3, 4$, we have rigorously verified that $\\mathbf{K} \\boldsymbol{\\phi}_t = \\mathbf{0}$ and $\\mathbf{K} \\boldsymbol{\\phi}_r = \\mathbf{0}$.\n\nc) Computation of the determinant of the generalized mass matrix\n\nThe generalized mass matrix on the rigid-body subspace is $\\mathbf{G} = \\boldsymbol{\\Phi}^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\Phi}$. Its components are $\\mathbf{G}_{ab} = \\boldsymbol{\\phi}_a^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_b$ for $a, b \\in \\{t, r\\}$.\nWe can compute these components without explicit construction of the full mass matrix $\\mathbf{M}$. A component $\\boldsymbol{\\phi}_a^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_b$ can be expressed as:\n$$ \\boldsymbol{\\phi}_a^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_b = \\sum_{i=1}^{4} \\sum_{j=1}^{4} (\\boldsymbol{\\phi}_a)_i M_{ij} (\\boldsymbol{\\phi}_b)_j = \\sum_{i,j} (\\boldsymbol{\\phi}_a)_i \\left(\\int_{0}^{L} \\rho A\\, N_i(x)\\, N_j(x)\\, \\mathrm{d}x \\right) (\\boldsymbol{\\phi}_b)_j $$\n$$ = \\int_{0}^{L} \\rho A \\left(\\sum_{i=1}^{4} N_i(x) (\\boldsymbol{\\phi}_a)_i\\right) \\left(\\sum_{j=1}^{4} N_j(x) (\\boldsymbol{\\phi}_b)_j\\right) \\mathrm{d}x = \\int_{0}^{L} \\rho A\\, v_a(x)\\, v_b(x)\\, \\mathrm{d}x $$\nwhere $v_a(x)$ and $v_b(x)$ are the displacement fields for modes $\\boldsymbol{\\phi}_a$ and $\\boldsymbol{\\phi}_b$.\n\n$\\mathbf{G}_{11} = \\boldsymbol{\\phi}_t^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_t = \\int_{0}^{L} \\rho A\\, v_t(x)\\, v_t(x)\\, \\mathrm{d}x$. With $v_t(x)=1$:\n$$ \\mathbf{G}_{11} = \\int_{0}^{L} \\rho A\\, (1)^2 \\, \\mathrm{d}x = \\rho A \\int_{0}^{L} \\mathrm{d}x = \\rho A L $$\nThis is the total mass of the beam element, as expected for pure translation.\n\n$\\mathbf{G}_{22} = \\boldsymbol{\\phi}_r^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_r = \\int_{0}^{L} \\rho A\\, v_r(x)\\, v_r(x)\\, \\mathrm{d}x$. With $v_r(x)=x$:\n$$ \\mathbf{G}_{22} = \\int_{0}^{L} \\rho A\\, x^2 \\, \\mathrm{d}x = \\rho A \\left[ \\frac{x^3}{3} \\right]_{0}^{L} = \\frac{\\rho A L^3}{3} $$\nThis is the mass moment of inertia of the beam about the end at $x=0$.\n\n$\\mathbf{G}_{12} = \\boldsymbol{\\phi}_t^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_r = \\int_{0}^{L} \\rho A\\, v_t(x)\\, v_r(x)\\, \\mathrm{d}x$. With $v_t(x)=1$ and $v_r(x)=x$:\n$$ \\mathbf{G}_{12} = \\int_{0}^{L} \\rho A\\, (1)(x) \\, \\mathrm{d}x = \\rho A \\left[ \\frac{x^2}{2} \\right]_{0}^{L} = \\frac{\\rho A L^2}{2} $$\nThis is the first moment of mass about the end at $x=0$.\n\nSince $\\mathbf{M}$ is symmetric, $\\mathbf{G}$ must also be symmetric, so $\\mathbf{G}_{21} = \\mathbf{G}_{12}$.\nThe generalized mass matrix is:\n$$ \\mathbf{G} = \\begin{pmatrix} \\rho A L & \\frac{1}{2} \\rho A L^2 \\\\ \\frac{1}{2} \\rho A L^2 & \\frac{1}{3} \\rho A L^3 \\end{pmatrix} $$\nThe determinant is calculated as:\n$$ \\det(\\mathbf{G}) = (\\rho A L) \\left(\\frac{1}{3} \\rho A L^3\\right) - \\left(\\frac{1}{2} \\rho A L^2\\right)^2 $$\n$$ \\det(\\mathbf{G}) = \\frac{1}{3} (\\rho A)^2 L^4 - \\frac{1}{4} (\\rho A)^2 L^4 $$\n$$ \\det(\\mathbf{G}) = \\left(\\frac{1}{3} - \\frac{1}{4}\\right) (\\rho A)^2 L^4 = \\left(\\frac{4-3}{12}\\right) (\\rho A)^2 L^4 = \\frac{1}{12} (\\rho A)^2 L^4 $$\nThis is the final symbolic expression for the determinant.", "answer": "$$\\boxed{\\frac{1}{12} (\\rho A)^{2} L^{4}}$$", "id": "2594259"}, {"introduction": "The semi-discretization inherent in the Finite Element Method introduces numerical artifacts, most notably dispersion, where the wave propagation speed becomes frequency-dependent. This advanced practice explores the phenomenon by comparing the dispersion relations for two common modeling choices: the consistent-mass and lumped-mass formulations. By analyzing how each approach approximates the true continuum behavior, you will gain a critical understanding of the accuracy and limitations of FEM for wave propagation problems [@problem_id:2594288].", "problem": "Consider a uniform, prismatic, axial bar of constant cross-sectional area $A$, Young’s modulus $E$, and mass density $\\rho$, undergoing small longitudinal vibrations. The exact continuum equation of motion is the one-dimensional wave equation $\\rho A \\,\\partial^{2} u/\\partial t^{2} = E A \\,\\partial^{2} u/\\partial x^{2}$, with wave speed $c = \\sqrt{E/\\rho}$. Discretize the bar by the Finite Element Method (FEM) using linear two-node elements of uniform length $h$ on an infinite ($\\mathbb{Z}$-periodic) grid, and denote by $\\mathbf{M}$ and $\\mathbf{K}$ the assembled global mass and stiffness matrices, respectively. Consider two semi-discrete models:\n- the consistent-mass model with $\\mathbf{M} = \\mathbf{M}^{\\mathrm{cons}}$,\n- the lumped-mass model with $\\mathbf{M} = \\mathbf{M}^{\\mathrm{lump}}$ formed by standard row-sum mass lumping of $\\mathbf{M}^{\\mathrm{cons}}$.\nIn both cases, the semi-discrete equations of motion are $\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0}$.\n\nStarting from the continuum equation and the Galerkin construction with linear shape functions, derive the element matrices, assemble the uniform lattice equations at a generic interior node $j \\in \\mathbb{Z}$, and impose a Bloch wave ansatz $u_{j}(t) = U \\exp\\!\\big(i\\,j\\,\\kappa - i\\,\\omega t\\big)$, where $U \\in \\mathbb{C}$ is a nonzero amplitude, $\\kappa = k h \\in [0,\\pi]$ is the nondimensional wavenumber in the first Brillouin zone, $k$ is the physical wavenumber, and $\\omega$ is the circular frequency. From this, obtain the discrete dispersion relation $\\omega(\\kappa)$ for each mass model and the corresponding phase velocities $v_{p}(\\kappa) = \\omega(\\kappa)/k$.\n\nFinally, provide, in closed form, the exact expression of the ratio of the lumped-mass phase velocity to the consistent-mass phase velocity, $v_{p}^{\\mathrm{lump}}(\\kappa)/v_{p}^{\\mathrm{cons}}(\\kappa)$, as a function of $\\kappa \\in [0,\\pi]$. Your final answer must be a single analytic expression in terms of $\\kappa$, with no units. Do not round.", "solution": "The problem as stated is valid. It is a standard, well-posed problem in the computational analysis of wave propagation, free of scientific or logical flaws. The necessary information is provided, and the objective is unambiguous. The solution proceeds by direct derivation.\n\nThe analysis begins with the formulation of the finite element matrices for a single two-node axial bar element of length $h$. The displacement field $u(x,t)$ within the element, located on the interval $[x_j, x_{j+1}]$, is interpolated from the nodal displacements $u_j(t)$ and $u_{j+1}(t)$ using linear shape functions. In a local coordinate $\\xi = (x - x_j)/h \\in [0,1]$, the shape functions are $N_1(\\xi) = 1-\\xi$ and $N_2(\\xi) = \\xi$. The displacement is $u(\\xi,t) = \\mathbf{N}(\\xi) \\mathbf{u}^e(t)$, where $\\mathbf{N} = \\begin{pmatrix} 1-\\xi & \\xi \\end{pmatrix}$ and $\\mathbf{u}^e = \\begin{pmatrix} u_j & u_{j+1} \\end{pmatrix}^T$.\n\nThe element stiffness matrix $\\mathbf{k}^e$ is derived from the strain energy functional. The strain is $\\epsilon = \\partial u / \\partial x = (1/h) \\partial u / \\partial \\xi = \\frac{1}{h} \\begin{pmatrix} -1 & 1 \\end{pmatrix} \\mathbf{u}^e$. The strain-displacement matrix is $\\mathbf{B} = \\frac{1}{h} \\begin{pmatrix} -1 & 1 \\end{pmatrix}$.\n$$\n\\mathbf{k}^e = \\int_{0}^{h} (E A) \\mathbf{B}^T \\mathbf{B} \\, dx = E A \\int_{0}^{1} \\left( \\frac{1}{h} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} \\right) \\left( \\frac{1}{h} \\begin{pmatrix} -1 & 1 \\end{pmatrix} \\right) h \\, d\\xi = \\frac{EA}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n\nThe element consistent-mass matrix $\\mathbf{m}^{\\mathrm{cons}, e}$ is derived from the kinetic energy functional.\n$$\n\\mathbf{m}^{\\mathrm{cons}, e} = \\int_{0}^{h} (\\rho A) \\mathbf{N}^T \\mathbf{N} \\, dx = \\rho A h \\int_{0}^{1} \\begin{pmatrix} (1-\\xi)^2 & \\xi(1-\\xi) \\\\ \\xi(1-\\xi) & \\xi^2 \\end{pmatrix} d\\xi = \\frac{\\rho A h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\n\nThe element lumped-mass matrix $\\mathbf{m}^{\\mathrm{lump}, e}$ is obtained by the row-sum lumping procedure, which diagonalizes the matrix by summing each row's elements onto the diagonal.\n$$\n\\mathbf{m}^{\\mathrm{lump}, e} = \\frac{\\rho A h}{6} \\begin{pmatrix} 2+1 & 0 \\\\ 0 & 1+2 \\end{pmatrix} = \\frac{\\rho A h}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n\nFor an infinite grid of such elements, the semi-discrete equation of motion at a generic interior node $j$ is assembled from the contributions of the two adjacent elements, $(j-1, j)$ and $(j, j+1)$. The equation at node $j$ takes the form $M_{j,j-1} \\ddot{u}_{j-1} + M_{j,j} \\ddot{u}_{j} + M_{j,j+1} \\ddot{u}_{j+1} + K_{j,j-1} u_{j-1} + K_{j,j} u_j + K_{j,j+1} u_{j+1} = 0$.\n\nAssembly of the stiffness terms yields:\n$K_{j,j-1} = k^e_{21} = -EA/h$, $K_{j,j+1} = k^e_{12} = -EA/h$, and $K_{j,j} = k^e_{22} + k^e_{11} = 2EA/h$.\nThe stiffness part of the equation is $\\frac{EA}{h}(-u_{j-1} + 2u_j - u_{j+1})$.\n\nFor the consistent-mass model, assembly of mass terms yields:\n$M^{\\mathrm{cons}}_{j,j-1} = m^{\\mathrm{cons},e}_{21} = \\rho A h/6$, $M^{\\mathrm{cons}}_{j,j+1} = m^{\\mathrm{cons},e}_{12} = \\rho A h/6$, and $M^{\\mathrm{cons}}_{j,j} = m^{\\mathrm{cons},e}_{22} + m^{\\mathrm{cons},e}_{11} = 4\\rho A h/6 = 2\\rho A h/3$.\nThe resulting consistent-mass equation for node $j$ is:\n$$\n\\frac{\\rho A h}{6} (\\ddot{u}_{j-1} + 4\\ddot{u}_j + \\ddot{u}_{j+1}) + \\frac{EA}{h}(-u_{j-1} + 2u_j - u_{j+1}) = 0\n$$\n\nFor the lumped-mass model, the off-diagonal mass terms are zero. The diagonal term is:\n$M^{\\mathrm{lump}}_{j,j} = m^{\\mathrm{lump},e}_{22} + m^{\\mathrm{lump},e}_{11} = \\rho A h/2 + \\rho A h/2 = \\rho A h$.\nThe resulting lumped-mass equation for node $j$ is:\n$$\n(\\rho A h) \\ddot{u}_j + \\frac{EA}{h}(-u_{j-1} + 2u_j - u_{j+1}) = 0\n$$\n\nTo find the dispersion relation, the Bloch wave ansatz $u_j(t) = U \\exp(i(j\\kappa - \\omega t))$ is substituted into these equations. This implies $\\ddot{u}_j(t) = -\\omega^2 u_j(t)$ and $u_{j\\pm1}(t) = u_j(t) \\exp(\\pm i\\kappa)$.\n\nFor the consistent-mass model, substitution gives:\n$$\n-\\omega^2 \\frac{\\rho A h}{6} (\\exp(-i\\kappa) + 4 + \\exp(i\\kappa)) + \\frac{EA}{h}(-\\exp(-i\\kappa) + 2 - \\exp(i\\kappa)) = 0\n$$\n$$\n-\\omega^2 \\frac{\\rho A h}{6} (2\\cos(\\kappa) + 4) + \\frac{EA}{h}(2 - 2\\cos(\\kappa)) = 0\n$$\nSolving for $(\\omega^{\\mathrm{cons}})^2$ and using $c^2=E/\\rho$:\n$$\n(\\omega^{\\mathrm{cons}})^2 = \\frac{EA}{\\rho A h^2} \\frac{6(1-\\cos(\\kappa))}{2+\\cos(\\kappa)} = \\frac{6c^2}{h^2} \\frac{1-\\cos(\\kappa)}{2+\\cos(\\kappa)}\n$$\n\nFor the lumped-mass model, substitution gives:\n$$\n-\\omega^2 (\\rho A h) + \\frac{EA}{h}(-\\exp(-i\\kappa) + 2 - \\exp(i\\kappa)) = 0\n$$\n$$\n-\\omega^2 \\rho A h + \\frac{EA}{h}(2 - 2\\cos(\\kappa)) = 0\n$$\nSolving for $(\\omega^{\\mathrm{lump}})^2$:\n$$\n(\\omega^{\\mathrm{lump}})^2 = \\frac{EA}{\\rho A h^2} 2(1-\\cos(\\kappa)) = \\frac{2c^2}{h^2} (1-\\cos(\\kappa))\n$$\n\nThe phase velocity is defined as $v_p(\\kappa) = \\omega(\\kappa)/k$, where $k = \\kappa/h$ is the physical wavenumber. Thus, $v_p(\\kappa) = h \\omega(\\kappa) / \\kappa$.\n\nThe phase velocity for the consistent-mass model is:\n$$\nv_p^{\\mathrm{cons}}(\\kappa) = \\frac{h}{\\kappa} \\omega^{\\mathrm{cons}}(\\kappa) = \\frac{h}{\\kappa} \\sqrt{\\frac{6c^2}{h^2} \\frac{1-\\cos(\\kappa)}{2+\\cos(\\kappa)}} = \\frac{c\\sqrt{6}}{\\kappa} \\sqrt{\\frac{1-\\cos(\\kappa)}{2+\\cos(\\kappa)}}\n$$\n\nThe phase velocity for the lumped-mass model is:\n$$\nv_p^{\\mathrm{lump}}(\\kappa) = \\frac{h}{\\kappa} \\omega^{\\mathrm{lump}}(\\kappa) = \\frac{h}{\\kappa} \\sqrt{\\frac{2c^2}{h^2} (1-\\cos(\\kappa))} = \\frac{c\\sqrt{2}}{\\kappa} \\sqrt{1-\\cos(\\kappa)}\n$$\n\nThe required ratio is $v_{p}^{\\mathrm{lump}}(\\kappa)/v_{p}^{\\mathrm{cons}}(\\kappa)$.\n$$\n\\frac{v_{p}^{\\mathrm{lump}}(\\kappa)}{v_{p}^{\\mathrm{cons}}(\\kappa)} = \\frac{\\frac{c\\sqrt{2}}{\\kappa} \\sqrt{1-\\cos(\\kappa)}}{\\frac{c\\sqrt{6}}{\\kappa} \\sqrt{\\frac{1-\\cos(\\kappa)}{2+\\cos(\\kappa)}}}\n$$\nFor $\\kappa \\in (0, \\pi]$, the terms $\\frac{c}{\\kappa}$ and $\\sqrt{1-\\cos(\\kappa)}$ cancel.\n$$\n\\frac{v_{p}^{\\mathrm{lump}}(\\kappa)}{v_{p}^{\\mathrm{cons}}(\\kappa)} = \\frac{\\sqrt{2}}{\\sqrt{6}} \\frac{1}{\\sqrt{\\frac{1}{2+\\cos(\\kappa)}}} = \\frac{1}{\\sqrt{3}} \\sqrt{2+\\cos(\\kappa)} = \\sqrt{\\frac{2+\\cos(\\kappa)}{3}}\n$$\nThis expression is the closed-form representation of the ratio of the phase velocities.", "answer": "$$\n\\boxed{\\sqrt{\\frac{2+\\cos(\\kappa)}{3}}}\n$$", "id": "2594288"}]}