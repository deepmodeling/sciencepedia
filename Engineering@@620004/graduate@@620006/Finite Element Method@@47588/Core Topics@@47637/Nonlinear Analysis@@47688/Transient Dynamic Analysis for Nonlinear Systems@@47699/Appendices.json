{"hands_on_practices": [{"introduction": "Explicit time integration is a cornerstone of nonlinear transient dynamics, particularly for problems involving wave propagation, impacts, or severe material nonlinearity. Its major limitation, however, is conditional stability. This exercise guides you through a foundational, first-principles derivation of the critical time step limit for the central difference method, revealing the intimate connection between the physical wave speed $c$, the finite element mesh size $h$, and the maximum permissible time step $\\Delta t_{\\text{crit}}$ [@problem_id:2607423]. Mastering this relationship is the first step toward building robust and efficient explicit dynamic simulations.", "problem": "A uniform, slender, one-dimensional elastic bar of constant cross-section is undergoing transient motion governed by Newtonâ€™s second law. The material response is nonlinear, but at a given time instant consider a linearization about the current configuration so that the bar has an instantaneous tangent modulus $E_{t}$ and constant mass density $\\rho$. Define the instantaneous elastic wave speed as $c = \\sqrt{E_{t}/\\rho}$. The bar is discretized by the finite element method (FEM) using a uniform mesh of linear, two-node elements of length $h$, and a diagonal (lumped) mass matrix is employed. Assume a sufficiently large periodic mesh so that boundary effects can be neglected and the highest-frequency mode is governed by the mesh-level dispersion relation.\n\nYou will use the explicit central difference method (CDM) to advance the semi-discrete equations in time. Starting from first principles, and without invoking any pre-tabulated stability limits, proceed as follows:\n- Write the semi-discrete equations of motion for the uniform mesh and reduce them to a nearest-neighbor lattice equation for interior nodes.\n- Postulate a harmonic wave solution on the discrete lattice to obtain the mesh dispersion relation and identify the maximum discrete angular frequency $\\omega_{\\max}$ in terms of $c$ and $h$.\n- Apply a linear stability analysis of the central difference time integrator for the scalar oscillator $\\ddot{y} + \\omega^{2} y = 0$ and deduce the critical time step $\\Delta t_{\\text{crit}}$ in terms of $\\omega_{\\max}$.\n\nFinally, combine the above results to obtain a closed-form expression for the central-difference critical time step $\\Delta t_{\\text{crit}}$ as a function of the wave speed $c$ and the element size $h$ for this mesh. Provide your answer as a symbolic expression in terms of $c$ and $h$. Do not include units and do not perform any numerical rounding.", "solution": "The problem requires the derivation of the critical time step for the explicit central difference method applied to a one-dimensional elastic bar discretized with linear finite elements. The derivation will proceed in three stages as specified: first, deriving the semi-discrete equations of motion; second, performing a dispersion analysis to find the maximum natural frequency of the discrete system; and third, performing a stability analysis of the time integrator to relate the critical time step to this maximum frequency.\n\nFirst, we establish the semi-discrete equation of motion for an interior node of a uniform finite element mesh. For a one-dimensional, two-node bar element of length $h$, constant cross-section $A$, tangent modulus $E_t$, and mass density $\\rho$, the element stiffness matrix $\\mathbf{K}^e$ is given by:\n$$\n\\mathbf{K}^e = \\frac{A E_t}{h}\n\\begin{pmatrix}\n1 & -1 \\\\\n-1 & 1\n\\end{pmatrix}\n$$\nThe problem specifies a diagonal (lumped) mass matrix. The total mass of the element is $m^e = \\rho A h$. This mass is distributed equally to the two nodes, resulting in the element mass matrix $\\mathbf{M}^e$:\n$$\n\\mathbf{M}^e = \\frac{\\rho A h}{2}\n\\begin{pmatrix}\n1 & 0 \\\\\n0 & 1\n\\end{pmatrix}\n$$\nWe consider an infinite, uniform mesh and focus on an arbitrary interior node $j$. This node is connected to its neighbors, node $j-1$ and node $j+1$, through two adjacent elements, element $(j-1, j)$ and element $(j, j+1)$. The global equation of motion for the system is $\\mathbf{M}\\ddot{\\mathbf{u}} + \\mathbf{K}\\mathbf{u} = \\mathbf{F}_{ext}$. For free vibration, $\\mathbf{F}_{ext} = \\mathbf{0}$. The equation for the degree of freedom $u_j$ at node $j$ is assembled from the contributions of the two adjacent elements.\n\nThe mass associated with node $j$ is the sum of contributions from each element:\n$$\nM_{jj} = \\left(\\mathbf{M}^e\\right)_{22} + \\left(\\mathbf{M}^e\\right)_{11} = \\frac{\\rho A h}{2} + \\frac{\\rho A h}{2} = \\rho A h\n$$\nThe internal force on node $j$ is the sum of forces from the stiffness of the two elements. The force on node $j$ from element $(j-1, j)$ is $\\frac{A E_t}{h}(-u_{j-1} + u_j)$. The force on node $j$ from element $(j, j+1)$ is $\\frac{A E_t}{h}(u_j - u_{j+1})$. The total internal force is the sum:\n$$\n(K_{j, j-1} u_{j-1} + K_{jj} u_j + K_{j, j+1} u_{j+1}) = \\frac{A E_t}{h}(-u_{j-1} + u_j) + \\frac{A E_t}{h}(u_j - u_{j+1}) = \\frac{A E_t}{h}(-u_{j-1} + 2u_j - u_{j+1})\n$$\nThus, the equation of motion for node $j$ is:\n$$\n(\\rho A h) \\ddot{u}_j + \\frac{A E_t}{h} (2u_j - u_{j-1} - u_{j+1}) = 0\n$$\nDividing by $\\rho A h$ and substituting the definition of the wave speed $c = \\sqrt{E_t/\\rho}$, which implies $c^2 = E_t/\\rho$, we obtain the nearest-neighbor lattice equation:\n$$\n\\ddot{u}_j + \\frac{c^2}{h^2} (2u_j - u_{j-1} - u_{j+1}) = 0\n$$\n\nSecond, we perform a dispersion analysis on this lattice equation to find the maximum frequency. We postulate a harmonic wave solution of the form $u_j(t) = U \\exp[i(kx_j - \\omega t)]$, where $x_j = jh$ is the coordinate of node $j$, $k$ is the wave number, and $\\omega$ is the angular frequency. The required terms are:\n$$\n\\ddot{u}_j(t) = -\\omega^2 u_j(t)\n$$\n$$\nu_{j-1}(t) = U \\exp[i(k(j-1)h - \\omega t)] = u_j(t) \\exp(-ikh)\n$$\n$$\nu_{j+1}(t) = U \\exp[i(k(j+1)h - \\omega t)] = u_j(t) \\exp(ikh)\n$$\nSubstituting these into the lattice equation yields:\n$$\n-\\omega^2 u_j + \\frac{c^2}{h^2} (2u_j - u_j \\exp(-ikh) - u_j \\exp(ikh)) = 0\n$$\nDividing by $u_j$ (which is non-zero for a non-trivial solution) and rearranging:\n$$\n\\omega^2 = \\frac{c^2}{h^2} (2 - (\\exp(ikh) + \\exp(-ikh)))\n$$\nUsing the Euler identity $\\cos(z) = \\frac{1}{2}(\\exp(iz) + \\exp(-iz))$, this becomes:\n$$\n\\omega^2 = \\frac{2c^2}{h^2} (1 - \\cos(kh))\n$$\nApplying the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we obtain the dispersion relation for the discrete system:\n$$\n\\omega^2 = \\frac{2c^2}{h^2} \\left(2\\sin^2\\left(\\frac{kh}{2}\\right)\\right) = \\frac{4c^2}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right)\n$$\nThe maximum frequency of the mesh, $\\omega_{\\max}$, corresponds to the mode that maximizes this expression. The sine function has a maximum absolute value of $1$. This occurs when its argument is an odd multiple of $\\pi/2$. The highest frequency mode corresponds to the shortest wavelength the mesh can represent, which is $\\lambda_{\\min} = 2h$. The wave number for this mode is $k_{\\max} = 2\\pi/\\lambda_{\\min} = \\pi/h$. Substituting this into the dispersion relation:\n$$\n\\omega_{\\max} = \\sqrt{\\frac{4c^2}{h^2} \\sin^2\\left(\\frac{(\\pi/h)h}{2}\\right)} = \\frac{2c}{h} \\left|\\sin\\left(\\frac{\\pi}{2}\\right)\\right| = \\frac{2c}{h}\n$$\n\nThird, we analyze the stability of the central difference method for the scalar harmonic oscillator equation $\\ddot{y} + \\omega^2 y = 0$. The central difference approximation for the second derivative is $\\ddot{y}_n \\approx (y_{n+1} - 2y_n + y_{n-1})/(\\Delta t)^2$. Substituting this into the model equation gives the recurrence relation:\n$$\n\\frac{y_{n+1} - 2y_n + y_{n-1}}{(\\Delta t)^2} + \\omega^2 y_n = 0\n$$\n$$\ny_{n+1} = (2 - (\\omega \\Delta t)^2) y_n - y_{n-1}\n$$\nTo analyze stability, we assume a solution of the form $y_n = G^n$, where $G$ is an amplification factor. Substituting this into the recurrence relation gives the characteristic equation for $G$:\n$$\nG^{n+1} = (2 - (\\omega \\Delta t)^2) G^n - G^{n-1}\n$$\n$$\nG^2 - (2 - (\\omega \\Delta t)^2) G + 1 = 0\n$$\nFor the numerical solution to remain bounded (stable), the magnitudes of the roots $G$ of this quadratic equation must not exceed $1$, i.e., $|G| \\le 1$. The roots are:\n$$\nG = \\frac{(2 - (\\omega \\Delta t)^2) \\pm \\sqrt{(2 - (\\omega \\Delta t)^2)^2 - 4}}{2}\n$$\nThe solution becomes unstable if any root has a magnitude greater than $1$. This occurs when the roots are real and unequal, which happens when the discriminant is positive. A positive discriminant requires $(2 - (\\omega \\Delta t)^2)^2 > 4$, or $|2 - (\\omega \\Delta t)^2| > 2$. This inequality holds if $2 - (\\omega \\Delta t)^2 > 2$ (which is impossible as $-(\\omega \\Delta t)^2 \\le 0$) or if $2 - (\\omega \\Delta t)^2 < -2$. The latter condition gives $(\\omega \\Delta t)^2 > 4$, or $|\\omega \\Delta t| > 2$.\nTherefore, for stability, we must have $|\\omega \\Delta t| \\le 2$. The integration scheme must be stable for all frequencies present in the semi-discrete system. This requires the condition to hold for the maximum frequency, $\\omega_{\\max}$:\n$$\n\\omega_{\\max} \\Delta t \\le 2\n$$\nThe critical time step, $\\Delta t_{\\text{crit}}$, is the largest value of $\\Delta t$ for which this condition is met:\n$$\n\\Delta t_{\\text{crit}} = \\frac{2}{\\omega_{\\max}}\n$$\n\nFinally, we combine the results. Substituting the expression for $\\omega_{\\max} = 2c/h$ into the equation for $\\Delta t_{\\text{crit}}$:\n$$\n\\Delta t_{\\text{crit}} = \\frac{2}{2c/h} = \\frac{h}{c}\n$$\nThis represents the Courant-Friedrichs-Lewy (CFL) condition for this particular numerical scheme, stating that the time step must be no larger than the time it takes for a wave to travel across one element.", "answer": "$$\n\\boxed{\\frac{h}{c}}\n$$", "id": "2607423"}, {"introduction": "To enhance computational efficiency in large-scale simulations, analysts often employ under-integrated finite elements. While cost-effective, these elements can suffer from unphysical, zero-energy deformations known as \"hourglass modes.\" This practice delves into the critical task of hourglass control, contrasting stiffness-based and viscosity-based stabilization methods. By analyzing these approaches, you will learn how to suppress spurious modes without compromising the physical accuracy of long-wavelength phenomena or unduly restricting the stable time step, a crucial skill for any practitioner of explicit dynamics [@problem_id:2607407].", "problem": "A compressible hyperelastic solid of density $\\rho$ and tangent elasticity tensor $\\mathbb{C}(\\boldsymbol{\\varepsilon})$ is discretized by under-integrated, trilinear hexahedral elements and advanced in time using an explicit central difference scheme. The semidiscrete equation of motion is $\\,\\mathbf{M}\\,\\ddot{\\mathbf{u}}+\\mathbf{f}_{\\mathrm{int}}(\\mathbf{u})=\\mathbf{f}_{\\mathrm{ext}}$, where $\\mathbf{M}$ is a diagonal (lumped) mass matrix, $\\mathbf{u}$ the nodal displacement vector, $\\mathbf{f}_{\\mathrm{int}}$ the internal force vector obtained from the Principle of Virtual Work, and $\\mathbf{f}_{\\mathrm{ext}}$ the external force vector. With reduced integration, the element admits zero-energy (hourglass) deformation modes that produce no strain energy and thus no restoring force in $\\mathbf{f}_{\\mathrm{int}}$. To suppress the growth of these modes under transient loading, an hourglass control is added in one of two forms: a stiffness-like stabilization or a viscosity-like stabilization applied in the hourglass subspace.\n\nStarting from conservation of linear momentum and the structure of the explicit central difference scheme, analyze how hourglass control influences stability and phase accuracy, and outline a principled calibration procedure for a viscosity-like hourglass control that suppresses spurious hourglass oscillations without corrupting the physical wave speeds of long-wavelength disturbances. In your reasoning, base any wave speed you use on the current tangent moduli, e.g., the shear wave speed $c_{s}=\\sqrt{G_{\\mathrm{tan}}/\\rho}$, where $G_{\\mathrm{tan}}$ is the current tangent shear modulus.\n\nWhich of the following statements are correct? Select all that apply.\n\nA. Adding a stiffness-like hourglass control raises the highest discrete frequency in the spectrum of the linearized system and therefore tightens the explicit time-step limit $\\Delta t_{\\mathrm{crit}}$; by contrast, a viscosity-like hourglass control that is projected onto the hourglass subspace and calibrated to target a damping ratio at a high wavenumber (e.g., near the Nyquist limit) can suppress spurious modes while preserving long-wavelength phase velocity. A practical calibration is to set $\\eta_{h}=2\\,\\zeta_{h}\\,m_{h}\\,\\omega_{h}$ with $\\omega_{h}\\approx \\pi c_{s}/h$ and $m_{h}$ an estimate of the modal mass associated with a single hourglass mode, where $h$ is a characteristic element size and $\\zeta_{h}$ is a chosen target damping ratio.\n\nB. To avoid affecting shear waves, the hourglass viscosity should be scaled with the bulk modulus $K$ so that $\\eta_{h}\\propto K$; this ensures that only volumetric hourglass patterns are damped and that the explicit time-step limit $\\Delta t_{\\mathrm{crit}}$ increases because the stabilizing forces act against unphysical deformations.\n\nC. Global Rayleigh damping calibrated to critically damp the elementâ€™s highest mode is an appropriate substitute for hourglass viscosity: it suppresses hourglass instabilities while leaving the explicit stability limit unchanged and does not alter the phase velocity of physical waves.\n\nD. A wave-speed-preserving viscosity calibration can be constructed by (i) defining an hourglass operator $\\mathbf{H}$ such that $\\mathbf{H}\\,\\mathbf{u}= \\mathbf{0}$ for rigid-body motions and any displacement field that induces constant strain over the element, (ii) adding a viscous hourglass force $\\mathbf{f}_{h}^{v}=\\eta_{h}\\,\\mathbf{H}\\,\\dot{\\mathbf{u}}$, and (iii) choosing $\\eta_{h}$ to realize a target modal damping ratio $\\zeta_{h}$ at a representative hourglass frequency $\\omega_{h}\\approx \\pi c_{t}/h$, where $c_{t}$ is a current tangent wave speed (e.g., $c_{s}$). Estimating the modal mass as $m_{h}\\approx \\alpha\\,m_{e}$ for some $\\alpha$ of order unity (with $m_{e}=\\rho V_{e}$ the element mass and $V_{e}$ its volume) and setting $\\eta_{h}=2\\,\\zeta_{h}\\,m_{h}\\,\\omega_{h}$ yields damping concentrated on high-wavenumber hourglass content. Because $\\mathbf{H}$ annihilates linear fields, this procedure does not change the dispersion or phase velocity for wavelengths $\\lambda\\gg h$.\n\nE. Increasing the stiffness-like hourglass parameter always increases the maximum stable explicit time step because the added stiffness suppresses unphysical modes, thereby improving numerical stability without affecting the highest physical frequencies.\n\nOnly consider scientifically defensible arguments and scalings derived from the governing equations and standard properties of the explicit central difference method; do not assume any proprietary formulation details.", "solution": "The semidiscrete equation of motion for the finite element system is given as:\n$$ \\mathbf{M}\\,\\ddot{\\mathbf{u}} + \\mathbf{f}_{\\mathrm{int}}(\\mathbf{u}) = \\mathbf{f}_{\\mathrm{ext}} $$\nwhere $\\mathbf{M}$ is the diagonal lumped mass matrix, $\\mathbf{u}$ is the vector of nodal displacements, $\\mathbf{f}_{\\mathrm{int}}$ is the vector of internal forces, and $\\mathbf{f}_{\\mathrm{ext}}$ is the vector of external forces. Using under-integrated elements, certain deformation modesâ€”the hourglass modesâ€”produce zero strain at the integration points. Consequently, they contribute nothing to the strain energy and thus nothing to the internal force vector, $\\mathbf{f}_{\\mathrm{int}}$. These modes are unresisted and can grow spuriously in a dynamic simulation. To counteract this, a stabilization force, $\\mathbf{f}_{h}$, is added to the system:\n$$ \\mathbf{M}\\,\\ddot{\\mathbf{u}} + \\mathbf{f}_{\\mathrm{int}}(\\mathbf{u}) + \\mathbf{f}_{h} = \\mathbf{f}_{\\mathrm{ext}} $$\nThe explicit central difference scheme updates displacements based on accelerations at time step $n$:\n$$ \\mathbf{u}^{n+1} = \\mathbf{u}^{n} + \\Delta t \\, \\dot{\\mathbf{u}}^{n+1/2} $$\n$$ \\dot{\\mathbf{u}}^{n+1/2} = \\dot{\\mathbf{u}}^{n-1/2} + \\Delta t \\, \\ddot{\\mathbf{u}}^{n} $$\nwhere $\\ddot{\\mathbf{u}}^{n} = \\mathbf{M}^{-1}(\\mathbf{f}_{\\mathrm{ext}}^{n} - \\mathbf{f}_{\\mathrm{int}}^{n} - \\mathbf{f}_{h}^{n})$. The stability of this scheme is governed by the Courant-Friedrichs-Lewy (CFL) condition, which limits the time step size $\\Delta t$ based on the highest natural frequency of the discretized system, $\\omega_{\\max}$. The critical time step is $\\Delta t_{\\mathrm{crit}} \\le 2/\\omega_{\\max}$. The highest frequency $\\omega_{\\max}$ is determined by the minimum time it takes for a wave to travel across an element, i.e., $\\omega_{\\max} \\approx c_{\\max}/h_{\\min}$, where $c_{\\max}$ is the fastest wave speed in the material and $h_{\\min}$ is a characteristic dimension of the smallest element. For a linearized system with tangent stiffness $\\mathbf{K}_{\\mathrm{tan}}$, $\\omega_{\\max}$ is the square root of the largest eigenvalue of the generalized eigenproblem $\\mathbf{K}_{\\mathrm{tan}}\\mathbf{v} = \\omega^2 \\mathbf{M}\\mathbf{v}$.\n\nLet us analyze the two types of hourglass control.\n\n1.  **Stiffness-like control**: Here, $\\mathbf{f}_{h} = \\mathbf{K}_{h}\\mathbf{u}$, where $\\mathbf{K}_{h}$ is an artificial stiffness matrix that acts only on the hourglass modes. The linearized equation of motion becomes $\\mathbf{M}\\,\\ddot{\\mathbf{u}} + (\\mathbf{K}_{\\mathrm{tan}} + \\mathbf{K}_{h})\\mathbf{u} = \\mathbf{f}_{\\mathrm{ext}}$. The total system stiffness is increased. Since $\\mathbf{K}_{h}$ is a positive semi-definite matrix, adding it to $\\mathbf{K}_{\\mathrm{tan}}$ will increase (or leave unchanged) the eigenvalues of $\\mathbf{M}^{-1}\\mathbf{K}_{\\mathrm{Total}}$. This leads to a higher maximum frequency, $\\omega'_{\\max} \\ge \\omega_{\\max}$. Consequently, the critical time step is reduced: $\\Delta t'_{\\mathrm{crit}} \\le 2/\\omega'_{\\max} \\le \\Delta t_{\\mathrm{crit}}$.\n\n2.  **Viscosity-like control**: Here, $\\mathbf{f}_{h} = \\mathbf{C}_{h}\\dot{\\mathbf{u}}$, where $\\mathbf{C}_{h}$ is an artificial viscous damping matrix projected onto the hourglass subspace. The goal is to add damping specifically to the unphysical, high-frequency hourglass modes without affecting the physical, long-wavelength modes. A properly formulated viscous control projects the velocity field onto the hourglass modal basis and applies a force proportional to the rate of hourglassing. For a long-wavelength disturbance, the displacement field across a single element is nearly linear. An hourglass operator, by definition, is orthogonal to rigid-body motions and constant strain fields (which arise from linear displacement fields). Therefore, such an operator will produce nearly zero force for long-wavelength modes, preserving their phase velocity and physical behavior.\n    For an unforced single hourglass mode, the equation is $m_{h}\\ddot{u}_{h} + c_{h}\\dot{u}_{h} = 0$, where $m_{h}$ is the modal mass, $u_{h}$ is the modal displacement, and $c_{h}$ is the modal viscosity. The characteristic equation is $m_{h}s^2 + c_{h}s = 0$. The solution is damped. To achieve a specified damping ratio $\\zeta_{h}$ at a certain frequency $\\omega_{h}$, we use the standard formula for a second-order system: $c_{h} = 2\\zeta_{h}m_{h}\\omega_{h}$. The frequency $\\omega_{h}$ is chosen to be representative of the hourglass phenomenon, which is a high-wavenumber mode. A wavelength of $\\lambda=2h$ (where $h$ is the element size) is appropriate, corresponding to the Nyquist frequency. The frequency is then $\\omega_{h} = 2\\pi c / \\lambda = \\pi c/h$, where $c$ is a relevant wave speed, such as the tangent shear wave speed $c_{s}$. The modal mass $m_{h}$ is some fraction of the total element mass. This provides a principled calibration procedure. Adding such viscosity has a small effect on the stability limit, which for a damped system is $\\Delta t \\le \\frac{2}{\\omega_{\\max}} (\\sqrt{1+\\xi_{\\max}^2} - \\xi_{\\max})$. Since the viscosity is targeted and usually small ($\\zeta_h \\ll 1$), this reduction is minimal compared to the significant reduction from stiffness-based control.\n\nNow, we evaluate each statement.\n\n**A. Adding a stiffness-like hourglass control raises the highest discrete frequency in the spectrum of the linearized system and therefore tightens the explicit time-step limit $\\Delta t_{\\mathrm{crit}}$; by contrast, a viscosity-like hourglass control that is projected onto the hourglass subspace and calibrated to target a damping ratio at a high wavenumber (e.g., near the Nyquist limit) can suppress spurious modes while preserving long-wavelength phase velocity. A practical calibration is to set $\\eta_{h}=2\\,\\zeta_{h}\\,m_{h}\\,\\omega_{h}$ with $\\omega_{h}\\approx \\pi c_{s}/h$ and $m_{h}$ an estimate of the modal mass associated with a single hourglass mode, where $h$ is a characteristic element size and $\\zeta_{h}$ is a chosen target damping ratio.**\n- The first clause correctly states that stiffness control increases $\\omega_{\\max}$ and thus reduces (tightens) $\\Delta t_{\\mathrm{crit}}$. This is correct as derived above.\n- The second clause correctly describes the advantage of projected viscous damping: it targets spurious modes while preserving the physics of long-wavelength modes. This is the main motivation for using such schemes.\n- The third clause presents the standard calibration procedure for achieving a target modal damping ratio $\\zeta_{h}$. The formula $\\eta_{h}=2\\,\\zeta_{h}\\,m_{h}\\,\\omega_{h}$ (using $\\eta_h$ for the modal viscous coefficient) is correct. The estimate for the hourglass frequency $\\omega_{h}\\approx \\pi c_{s}/h$ is physically sound, representing a mode with wavelength on the order of the element size.\nThe statement is a correct and concise summary of the state of the art in hourglass control.\n**Verdict: Correct.**\n\n**B. To avoid affecting shear waves, the hourglass viscosity should be scaled with the bulk modulus $K$ so that $\\eta_{h}\\propto K$; this ensures that only volumetric hourglass patterns are damped and that the explicit time-step limit $\\Delta t_{\\mathrm{crit}}$ increases because the stabilizing forces act against unphysical deformations.**\n- The primary hourglass modes in trilinear hexahedra are deviatoric (shear-like) in nature. Scaling the control with the bulk modulus $K$ would primarily damp volumetric modes, which is not the main problem. To avoid affecting *physical* shear waves, the control should be orthogonal to them, not scaled with a property ($K$) unrelated to shear. The premise is flawed.\n- The claim that $\\Delta t_{\\mathrm{crit}}$ *increases* is fundamentally false. Adding any form of stabilization, whether stiffness or damping, cannot increase the stable time step. Stiffness control *decreases* it. Viscous control at best leaves it nearly unchanged or slightly decreases it. The argument that suppressing unphysical modes improves stability in a way that allows for a larger time step conflates two different types of stability (modal vs. numerical integration).\n**Verdict: Incorrect.**\n\n**C. Global Rayleigh damping calibrated to critically damp the elementâ€™s highest mode is an appropriate substitute for hourglass viscosity: it suppresses hourglass instabilities while leaving the explicit stability limit unchanged and does not alter the phase velocity of physical waves.**\n- Rayleigh damping, $\\mathbf{C} = \\alpha_R \\mathbf{M} + \\beta_R \\mathbf{K}$, is not a targeted control. It introduces damping across all modes. While a large $\\beta_R$ can damp high-frequency modes (including hourglass), the $\\alpha_R \\mathbf{M}$ term heavily damps low-frequency physical modes, which is undesirable and corrupts phase accuracy. Thus, it *does* alter the phase velocity of physical waves.\n- Calibrating it to *critically damp* ($\\zeta=1$) the highest mode means the damping ratio at $\\omega_{\\max}$ is $\\xi_{\\max}=1$. The stability limit becomes $\\Delta t \\le \\frac{2}{\\omega_{\\max}} (\\sqrt{1+1^2} - 1) \\approx 0.414 (2/\\omega_{\\max})$. This is a severe *reduction*, not \"unchanged\".\n**Verdict: Incorrect.**\n\n**D. A wave-speed-preserving viscosity calibration can be constructed by (i) defining an hourglass operator $\\mathbf{H}$ such that $\\mathbf{H}\\,\\mathbf{u}= \\mathbf{0}$ for rigid-body motions and any displacement field that induces constant strain over the element, (ii) adding a viscous hourglass force $\\mathbf{f}_{h}^{v}=\\eta_{h}\\,\\mathbf{H}\\,\\dot{\\mathbf{u}}$, and (iii) choosing $\\eta_{h}$ to realize a target modal damping ratio $\\zeta_{h}$ at a representative hourglass frequency $\\omega_{h}\\approx \\pi c_{t}/h$, where $c_{t}$ is a current tangent wave speed (e.g., $c_{s}$). Estimating the modal mass as $m_{h}\\approx \\alpha\\,m_{e}$ for some $\\alpha$ of order unity (with $m_{e}=\\rho V_{e}$ the element mass and $V_{e}$ its volume) and setting $\\eta_{h}=2\\,\\zeta_{h}\\,m_{h}\\,\\omega_{h}$ yields damping concentrated on high-wavenumber hourglass content. Because $\\mathbf{H}$ annihilates linear fields, this procedure does not change the dispersion or phase velocity for wavelengths $\\lambda\\gg h$.**\n- This statement provides a formal and detailed description of the viscosity-like control method.\n- (i) The definition of the hourglass operator $\\mathbf{H}$ is correct; its orthogonality to rigid-body and constant-strain modes is the essential property that isolates hourglassing.\n- (ii) The form of the viscous force is a valid conceptual representation of a projected viscous force.\n- (iii) The calibration procedure is identical to the one described correctly in statement A and is based on sound physical principles. The estimation of modal mass as a fraction of the element mass is a common practice.\n- The final conclusion is correct: because $\\mathbf{H}$ annihilates linear fields, it correctly leaves long-wavelength physical modes unaffected, thus preserving their phase velocity. The assertion that $\\alpha$ is of order unity is a slight imprecision (it's typically a fraction less than $1$), but in the context of order-of-magnitude estimation, this does not invalidate the statement's fundamental correctness.\n**Verdict: Correct.**\n\n**E. Increasing the stiffness-like hourglass parameter always increases the maximum stable explicit time step because the added stiffness suppresses unphysical modes, thereby improving numerical stability without affecting the highest physical frequencies.**\n- This statement is fundamentally incorrect. As analyzed for statement A, adding stiffness, artificial or physical, increases the system's highest frequency $\\omega_{\\max}$. The stability limit $\\Delta t_{\\mathrm{crit}} \\le 2/\\omega_{\\max}$ is therefore *reduced*, not increased.\n- The reasoning provided is flawed. While the control does suppress the growth of unphysical modes (a form of \"improving stability\"), it does so by stiffening the response at high frequencies, which is precisely what tightens the explicit time integration stability limit. The statement incorrectly claims this does not affect the highest frequencies; the hourglass frequencies *are* the highest frequencies in the system after stabilization.\n**Verdict: Incorrect.**\n\nIn summary, statements A and D provide correct descriptions of hourglass control theory and practice. Statements B, C, and E contain fundamental errors regarding the effect of stabilization on the explicit time step and the nature of different damping schemes.", "answer": "$$\\boxed{AD}$$", "id": "2607407"}, {"introduction": "Accurately representing energy dissipation is essential for realistic transient dynamic analysis. Proportional damping, commonly known as Rayleigh damping, offers a pragmatic way to introduce dissipation by constructing the damping matrix $\\boldsymbol{C}$ as a linear combination of the mass $\\boldsymbol{M}$ and stiffness $\\boldsymbol{K}$ matrices: $\\boldsymbol{C} = a_0\\boldsymbol{M} + a_1\\boldsymbol{K}_{\\mathrm{T}}$. This hands-on problem focuses on the practical calibration of the coefficients $a_0$ and $a_1$ to match desired damping ratios at two distinct frequencies of a linearized system. This exercise will solidify your understanding of how to control system dynamics and effectively model energy loss in a complex nonlinear model [@problem_id:2607433].", "problem": "A nonlinear finite element model of a slender structure is integrated in time under transient loading. Let the semi-discrete equations of motion be linearized about a configuration at time $t_0$, yielding a linear time-invariant system with mass matrix $\\boldsymbol{M}$ and tangent stiffness matrix $\\boldsymbol{K}_{\\mathrm{T}}$. You decide to adopt proportional (Rayleigh) damping in this linearized system, with damping matrix $\\boldsymbol{C}$ taken as a linear combination of the mass and stiffness matrices. For transient dynamic analysis, you wish to calibrate the damping to match two target (small) modal damping ratios associated with two undamped modes of the linearized system.\n\nSpecifically, at the chosen linearization state, the undamped natural frequencies of two modes are measured to be $\\omega_1 = 30\\,\\mathrm{rad/s}$ and $\\omega_2 = 120\\,\\mathrm{rad/s}$, and you desire modal damping ratios $\\zeta_1 = 0.02$ and $\\zeta_2 = 0.06$ for these modes, respectively. Assume all matrices are real, symmetric, and that the undamped eigenvectors are complete and form a basis with the usual orthogonality properties with respect to $\\boldsymbol{M}$ and $\\boldsymbol{K}_{\\mathrm{T}}$.\n\nWhich of the following options correctly define the Rayleigh damping model for the linearized system and correctly explain and/or carry out the calibration of ($a_0,a_1$) from the two target modal damping ratios described above? Select all that apply.\n\nA. Use $\\boldsymbol{C} = a_0 \\boldsymbol{M} + a_1 \\boldsymbol{K}_{\\mathrm{T}}$ with $\\boldsymbol{K}_{\\mathrm{T}}$ taken at the linearization configuration, calibrate ($a_0,a_1$) from the two target undamped modes of the linearized system, and obtain the numerical values $a_0 = 0.32\\,\\mathrm{s}^{-1}$ and $a_1 = 9.78 \\times 10^{-4}\\,\\mathrm{s}$ for the given targets at $\\omega_1 = 30\\,\\mathrm{rad/s}$ and $\\omega_2 = 120\\,\\mathrm{rad/s}$.\n\nB. Use $\\boldsymbol{C} = a_0 \\boldsymbol{M} + a_1 \\boldsymbol{K}_{\\mathrm{T}}$ but calibrate via the relation $2\\zeta_r = a_0\\omega_r + a_1/\\omega_r$ for each mode $r$, which yields $a_0 = 9.78 \\times 10^{-4}\\,\\mathrm{s}^{-1}$ and $a_1 = 0.32\\,\\mathrm{s}$ for the targets at $\\omega_1 = 30\\,\\mathrm{rad/s}$ and $\\omega_2 = 120\\,\\mathrm{rad/s}$.\n\nC. The calibrated coefficients ($a_0,a_1$) depend on the arbitrary scaling of the eigenvectors; therefore, changing the normalization of the mode shapes changes the computed ($a_0,a_1$).\n\nD. It is acceptable to replace angular frequencies by cyclic frequencies in hertz during calibration; using $f_1 = \\omega_1/(2\\pi)$ and $f_2 = \\omega_2/(2\\pi)$ in place of $\\omega_1$ and $\\omega_2$ yields $a_0 \\approx 0.051\\,\\mathrm{s}^{-1}$ and $a_1 \\approx 6.15 \\times 10^{-3}\\,\\mathrm{s}$ for the given targets.\n\nE. In a nonlinear transient analysis, proportional damping may be defined with the tangent stiffness matrix of the selected linearization, so calibration of ($a_0,a_1$) is performed using the undamped natural frequencies of that linearized system; the resulting ($a_0,a_1$) do not depend on how the eigenvectors are normalized.", "solution": "The semi-discrete equation of motion for a general nonlinear system is given by $\\boldsymbol{M}\\ddot{\\boldsymbol{u}} + \\boldsymbol{P}(\\boldsymbol{u}, \\dot{\\boldsymbol{u}}) = \\boldsymbol{F}_{\\text{ext}}(t)$, where $\\boldsymbol{P}$ is the vector of internal forces. For the purpose of transient analysis, this system is linearized about a state $(\\boldsymbol{u}_0, \\dot{\\boldsymbol{u}}_0)$ at time $t_0$. The linearized equation of motion for an increment $\\Delta\\boldsymbol{u}$ is:\n$$ \\boldsymbol{M}\\Delta\\ddot{\\boldsymbol{u}} + \\boldsymbol{C}_{\\mathrm{T}}\\Delta\\dot{\\boldsymbol{u}} + \\boldsymbol{K}_{\\mathrm{T}}\\Delta\\boldsymbol{u} = \\Delta\\boldsymbol{F}(t) $$\nwhere $\\boldsymbol{K}_{\\mathrm{T}} = \\partial\\boldsymbol{P}/\\partial\\boldsymbol{u}|_0$ is the tangent stiffness matrix and $\\boldsymbol{C}_{\\mathrm{T}} = \\partial\\boldsymbol{P}/\\partial\\dot{\\boldsymbol{u}}|_0$ is the tangent damping matrix, both evaluated at the linearization state. The problem adopts the Rayleigh damping model for this linearized system, which is a common engineering approximation where the damping matrix is assumed to be a linear combination of the mass and tangent stiffness matrices:\n$$ \\boldsymbol{C} = a_0 \\boldsymbol{M} + a_1 \\boldsymbol{K}_{\\mathrm{T}} $$\nHere, $\\boldsymbol{C}$ represents the damping matrix of the linearized system, which we are tasked to calibrate.\n\nTo determine the coefficients $a_0$ and $a_1$, we analyze the undamped free vibration eigenproblem of the linearized system:\n$$ \\boldsymbol{K}_{\\mathrm{T}}\\boldsymbol{\\phi}_r = \\omega_r^2 \\boldsymbol{M}\\boldsymbol{\\phi}_r $$\nwhere $\\omega_r$ is the $r$-th undamped natural frequency and $\\boldsymbol{\\phi}_r$ is the corresponding eigenvector (mode shape). The eigenvectors are $\\boldsymbol{M}$-orthogonal and $\\boldsymbol{K}_{\\mathrm{T}}$-orthogonal.\n\nWe transform the damped system into modal coordinates using the basis of eigenvectors. The equation of motion for the $r$-th modal coordinate, $q_r(t)$, becomes:\n$$ \\ddot{q}_r(t) + 2\\zeta_r\\omega_r\\dot{q}_r(t) + \\omega_r^2 q_r(t) = f_r(t) $$\nThe term $2\\zeta_r\\omega_r$ is derived from the modal damping matrix $\\boldsymbol{C}$:\n$$ 2\\zeta_r\\omega_r = \\frac{\\boldsymbol{\\phi}_r^T \\boldsymbol{C} \\boldsymbol{\\phi}_r}{\\boldsymbol{\\phi}_r^T \\boldsymbol{M} \\boldsymbol{\\phi}_r} $$\nSubstituting the Rayleigh damping model $\\boldsymbol{C} = a_0 \\boldsymbol{M} + a_1 \\boldsymbol{K}_{\\mathrm{T}}$:\n$$ 2\\zeta_r\\omega_r = \\frac{\\boldsymbol{\\phi}_r^T (a_0 \\boldsymbol{M} + a_1 \\boldsymbol{K}_{\\mathrm{T}}) \\boldsymbol{\\phi}_r}{\\boldsymbol{\\phi}_r^T \\boldsymbol{M} \\boldsymbol{\\phi}_r} = a_0 \\frac{\\boldsymbol{\\phi}_r^T \\boldsymbol{M} \\boldsymbol{\\phi}_r}{\\boldsymbol{\\phi}_r^T \\boldsymbol{M} \\boldsymbol{\\phi}_r} + a_1 \\frac{\\boldsymbol{\\phi}_r^T \\boldsymbol{K}_{\\mathrm{T}} \\boldsymbol{\\phi}_r}{\\boldsymbol{\\phi}_r^T \\boldsymbol{M} \\boldsymbol{\\phi}_r} $$\nUsing the property from the eigenvalue problem, $\\boldsymbol{\\phi}_r^T \\boldsymbol{K}_{\\mathrm{T}} \\boldsymbol{\\phi}_r = \\omega_r^2 \\boldsymbol{\\phi}_r^T \\boldsymbol{M} \\boldsymbol{\\phi}_r$, the expression simplifies to:\n$$ 2\\zeta_r\\omega_r = a_0 + a_1\\omega_r^2 $$\nFor $\\omega_r > 0$, we can rearrange this into the canonical form for calibration:\n$$ 2\\zeta_r = \\frac{a_0}{\\omega_r} + a_1\\omega_r $$\nThis equation shows the relationship between the damping ratio $\\zeta_r$ for a given mode and its natural frequency $\\omega_r$. Note that this relationship is independent of the normalization of the eigenvector $\\boldsymbol{\\phi}_r$.\n\nWe are given two target modes to calibrate the two unknown coefficients, $a_0$ and $a_1$:\n1. Mode 1: $\\omega_1 = 30\\,\\mathrm{rad/s}$, $\\zeta_1 = 0.02$\n2. Mode 2: $\\omega_2 = 120\\,\\mathrm{rad/s}$, $\\zeta_2 = 0.06$\n\nThis yields a system of two linear equations:\n$$ 2(0.02) = \\frac{a_0}{30} + a_1(30) \\implies 0.04 = \\frac{a_0}{30} + 30a_1 $$\n$$ 2(0.06) = \\frac{a_0}{120} + a_1(120) \\implies 0.12 = \\frac{a_0}{120} + 120a_1 $$\nThis can be written in matrix form:\n$$ \\begin{pmatrix} 1/30 & 30 \\\\ 1/120 & 120 \\end{pmatrix} \\begin{pmatrix} a_0 \\\\ a_1 \\end{pmatrix} = \\begin{pmatrix} 0.04 \\\\ 0.12 \\end{pmatrix} $$\nWe solve this system for $(a_0, a_1)$. From the first equation, $a_0 = 30(0.04 - 30a_1) = 1.2 - 900a_1$. Substituting this into the second equation:\n$$ 0.12 = \\frac{1.2 - 900a_1}{120} + 120a_1 $$\n$$ 0.12 = 0.01 - 7.5a_1 + 120a_1 $$\n$$ 0.11 = 112.5a_1 $$\n$$ a_1 = \\frac{0.11}{112.5} = \\frac{110}{112500} = \\frac{11}{11250} \\approx 9.777... \\times 10^{-4}\\,\\mathrm{s} $$\nNow, we find $a_0$:\n$$ a_0 = 1.2 - 900 \\left( \\frac{0.11}{112.5} \\right) = 1.2 - \\frac{99}{112.5} = 1.2 - 0.88 = 0.32\\,\\mathrm{s}^{-1} $$\nThe units are derived from the calibration equation: $a_1\\omega_r$ must be dimensionless, so $a_1$ has units of time ($s$). $a_0/\\omega_r$ must be dimensionless, so $a_0$ has units of frequency ($s^{-1}$).\n\nNow we evaluate each option.\n\nA. Use $\\boldsymbol{C} = a_0 \\boldsymbol{M} + a_1 \\boldsymbol{K}_{\\mathrm{T}}$ with $\\boldsymbol{K}_{\\mathrm{T}}$ taken at the linearization configuration, calibrate ($a_0,a_1$) from the two target undamped modes of the linearized system, and obtain the numerical values $a_0 = 0.32\\,\\mathrm{s}^{-1}$ and $a_1 = 9.78 \\times 10^{-4}\\,\\mathrm{s}$ for the given targets at $\\omega_1 = 30\\,\\mathrm{rad/s}$ and $\\omega_2 = 120\\,\\mathrm{rad/s}$.\nThis option correctly states the form of the Rayleigh damping matrix using the tangent stiffness. The specified calibration procedure is correct. The calculated values $a_0 = 0.32\\,\\mathrm{s}^{-1}$ and $a_1 \\approx 9.78 \\times 10^{-4}\\,\\mathrm{s}$ (rounded) match our derivation precisely.\nVerdict: **Correct**.\n\nB. Use $\\boldsymbol{C} = a_0 \\boldsymbol{M} + a_1 \\boldsymbol{K}_{\\mathrm{T}}$ but calibrate via the relation $2\\zeta_r = a_0\\omega_r + a_1/\\omega_r$ for each mode $r$, which yields $a_0 = 9.78 \\times 10^{-4}\\,\\mathrm{s}^{-1}$ and $a_1 = 0.32\\,\\mathrm{s}$ for the targets at $\\omega_1 = 30\\,\\mathrm{rad/s}$ and $\\omega_2 = 120\\,\\mathrm{rad/s}$.\nThe calibration relation $2\\zeta_r = a_0\\omega_r + a_1/\\omega_r$ is incorrect. It improperly associates $a_0$ with $\\omega_r$ and $a_1$ with $1/\\omega_r$. The correct relation is $2\\zeta_r = a_0/\\omega_r + a_1\\omega_r$. This error leads to a dimensionally inconsistent formula and consequently incorrect assignment of the computed numerical values to the coefficients. The reported values for $a_0$ and $a_1$ are swapped.\nVerdict: **Incorrect**.\n\nC. The calibrated coefficients ($a_0,a_1$) depend on the arbitrary scaling of the eigenvectors; therefore, changing the normalization of the mode shapes changes the computed ($a_0,a_1$).\nThis statement is false. As shown in the derivation, the calibration equation $2\\zeta_r = a_0/\\omega_r + a_1\\omega_r$ is derived from ratios of modal quantities (e.g., $\\boldsymbol{\\phi}_r^T \\boldsymbol{K}_{\\mathrm{T}} \\boldsymbol{\\phi}_r / \\boldsymbol{\\phi}_r^T \\boldsymbol{M} \\boldsymbol{\\phi}_r = \\omega_r^2$). Any scaling factor applied to an eigenvector $\\boldsymbol{\\phi}_r$ cancels out in these ratios. Therefore, the natural frequencies $\\omega_r$ and modal damping ratios $\\zeta_r$ are invariant to eigenvector normalization. Since the coefficients $(a_0,a_1)$ are determined solely from $(\\omega_r, \\zeta_r)$ pairs, they are also independent of eigenvector normalization.\nVerdict: **Incorrect**.\n\nD. It is acceptable to replace angular frequencies by cyclic frequencies in hertz during calibration; using $f_1 = \\omega_1/(2\\pi)$ and $f_2 = \\omega_2/(2\\pi)$ in place of $\\omega_1$ and $\\omega_2$ yields $a_0 \\approx 0.051\\,\\mathrm{s}^{-1}$ and $a_1 \\approx 6.15 \\times 10^{-3}\\,\\mathrm{s}$ for the given targets.\nThis procedure is fundamentally incorrect. The derivation of the calibration formula relies on the angular frequency $\\omega$ (in rad/s) as it appears in the standard form of the second-order differential equation for an oscillator. Replacing $\\omega$ with cyclic frequency $f = \\omega/(2\\pi)$ (in Hz) constitutes a dimensional error. While the option provides arithmetically correct results for this flawed procedure, the premise that such a substitution is \"acceptable\" is false. This is a severe conceptual mistake.\nVerdict: **Incorrect**.\n\nE. In a nonlinear transient analysis, proportional damping may be defined with the tangent stiffness matrix of the selected linearization, so calibration of ($a_0,a_1$) is performed using the undamped natural frequencies of that linearized system; the resulting ($a_0,a_1$) do not depend on how the eigenvectors are normalized.\nThis option presents two correct conceptual statements. First, it accurately describes a standard and valid methodology for applying Rayleigh damping in a nonlinear analysis context: using the tangent stiffness matrix from a specific linearized state and calibrating based on the properties of that state. Second, it correctly states that the resulting coefficients $(a_0,a_1)$ are independent of eigenvector normalization, which is a fundamental property of the calibration method as demonstrated in the analysis for option C.\nVerdict: **Correct**.", "answer": "$$\\boxed{AE}$$", "id": "2607433"}]}