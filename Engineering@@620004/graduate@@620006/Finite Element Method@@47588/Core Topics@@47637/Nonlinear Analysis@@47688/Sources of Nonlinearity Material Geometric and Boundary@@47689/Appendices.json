{"hands_on_practices": [{"introduction": "Geometric nonlinearity is fundamental to analyzing structures that undergo large displacements and rotations, where the stiffness changes as the body deforms. This hands-on exercise guides you through the core calculation of finite strain mechanics: computing the deformation gradient, $F$. By working with a standard 3D hexahedral element in a Total Lagrangian framework, you will connect nodal displacements to the local deformation state, gaining an essential skill for implementing or verifying any nonlinear finite element code [@problem_id:2597165].", "problem": "A single eight-node trilinear hexahedral element is used in a Total Lagrangian (TL) finite element formulation for three-dimensional solid mechanics to model a kinematically nonlinear deformation (geometric nonlinearity). The reference (undeformed) configuration is the rectangular block with nodal coordinates given in the global material coordinates $\\left(X,Y,Z\\right)$:\n- Node $1$: $\\left(0,0,0\\right)$,\n- Node $2$: $\\left(2,0,0\\right)$,\n- Node $3$: $\\left(2,1,0\\right)$,\n- Node $4$: $\\left(0,1,0\\right)$,\n- Node $5$: $\\left(0,0,1.5\\right)$,\n- Node $6$: $\\left(2,0,1.5\\right)$,\n- Node $7$: $\\left(2,1,1.5\\right)$,\n- Node $8$: $\\left(0,1,1.5\\right)$.\n\nIn the parent (isoparametric) space with coordinates $\\left(\\xi,\\eta,\\zeta\\right)\\in[-1,1]^3$, the nodes are located at the standard sign combinations $\\left(\\xi_i,\\eta_i,\\zeta_i\\right)\\in\\{(-1,-1,-1),(+1,-1,-1),(+1,+1,-1),(-1,+1,-1),(-1,-1,+1),(+1,-1,+1),(+1,+1,+1),(-1,+1,+1)\\}$ for nodes $1$ through $8$ respectively.\n\n1) Starting from the fundamental isoparametric concept that both geometry and displacement are interpolated by the same trilinear shape functions $N_i\\left(\\xi,\\eta,\\zeta\\right)$, derive the explicit isoparametric mapping $\\left(X(\\xi,\\eta,\\zeta),Y(\\xi,\\eta,\\zeta),Z(\\xi,\\eta,\\zeta)\\right)$ for this element in terms of the nodal coordinates and the shape functions. Clearly state the shape functions.\n\n2) In a Total Lagrangian setting, the current position is $\\boldsymbol{x}\\left(\\boldsymbol{X}\\right)=\\boldsymbol{X}+\\boldsymbol{u}\\left(\\boldsymbol{X}\\right)$, and the deformation gradient is $\\boldsymbol{F}\\left(\\boldsymbol{X}\\right)=\\partial \\boldsymbol{x}/\\partial \\boldsymbol{X}$. Using the same shape functions to interpolate the displacement field, the nodal displacements (in the global basis) are prescribed numerically as follows:\n- Node $1$: $\\left(0,0,0\\right)$,\n- Node $2$: $\\left(0.24,0.20,0.04\\right)$,\n- Node $3$: $\\left(0.39,0.15,0.11\\right)$,\n- Node $4$: $\\left(0.15,-0.05,0.07\\right)$,\n- Node $5$: $\\left(0.075,-0.045,0.12\\right)$,\n- Node $6$: $\\left(0.315,0.155,0.16\\right)$,\n- Node $7$: $\\left(0.465,0.105,0.23\\right)$,\n- Node $8$: $\\left(0.225,-0.095,0.19\\right)$.\n\nEvaluate the deformation gradient $\\boldsymbol{F}$ at the elementâ€™s center Gauss point $\\left(\\xi,\\eta,\\zeta\\right)=\\left(0,0,0\\right)$ using the TL formulation, making clear how the geometric nonlinearity enters the computation through the kinematic definition.\n\nFinally, report the scalar volume ratio $J=\\det\\left(\\boldsymbol{F}\\right)$ at the center Gauss point. Express the final answer as a pure number with no units, rounded to four significant figures.", "solution": "The problem statement is scrutinized and found to be valid. It is scientifically grounded in the principles of nonlinear solid mechanics and the finite element method, is well-posed with all necessary data provided, and is formulated with objective, unambiguous language. I will therefore proceed with a full solution.\n\nThe problem requires two main tasks: first, to derive the isoparametric mapping for the reference configuration, and second, to calculate the deformation gradient $\\boldsymbol{F}$ and the volume ratio $J$ at the element's center for a given displacement field.\n\n**Part 1: Isoparametric Mapping of the Reference Configuration**\n\nThe isoparametric concept dictates that the geometry of the element is interpolated from its nodal coordinates using the same shape functions that are used to interpolate the displacement field. For an eight-node trilinear hexahedral element, the shape function $N_i$ associated with node $i$ (with parent coordinates $(\\xi_i, \\eta_i, \\zeta_i)$) is given by:\n$$\nN_i(\\xi, \\eta, \\zeta) = \\frac{1}{8}(1 + \\xi_i \\xi)(1 + \\eta_i \\eta)(1 + \\zeta_i \\zeta)\n$$\nwhere $(\\xi, \\eta, \\zeta) \\in [-1, 1]^3$. The material coordinates $(X, Y, Z)$ at any point within the element are interpolated from the nodal coordinates $(\\boldsymbol{X}_i)$ as:\n$$\n\\boldsymbol{X}(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) \\boldsymbol{X}_i\n$$\nThis vector equation represents three scalar equations for the coordinates $X$, $Y$, and $Z$:\n$$\nX(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) X_i\n$$\n$$\nY(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) Y_i\n$$\n$$\nZ(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) Z_i\n$$\nThe provided nodal coordinates $(\\boldsymbol{X}_i)$ and the standard parent coordinates $(\\xi_i, \\eta_i, \\zeta_i)$ are used to find the explicit mapping. For the given rectangular block, the mapping simplifies. For coordinate $X$:\n$$\nX(\\xi, \\eta, \\zeta) = N_2(\\xi, \\eta, \\zeta)(2) + N_3(\\xi, \\eta, \\zeta)(2) + N_6(\\xi, \\eta, \\zeta)(2) + N_7(\\xi, \\eta, \\zeta)(2)\n$$\nSubstituting the shape functions and simplifying by grouping terms, we find:\n$$\nX(\\xi, \\eta, \\zeta) = (1+\\xi)\n$$\nSimilarly, for coordinates $Y$ and $Z$:\n$$\nY(\\xi, \\eta, \\zeta) = N_3(1) + N_4(1) + N_7(1) + N_8(1) = \\frac{1}{2}(1+\\eta) = 0.5(1+\\eta)\n$$\n$$\nZ(\\xi, \\eta, \\zeta) = N_5(1.5) + N_6(1.5) + N_7(1.5) + N_8(1.5) = \\frac{1.5}{2}(1+\\zeta) = 0.75(1+\\zeta)\n$$\nThus, the explicit isoparametric mapping is:\n$$\nX(\\xi, \\eta, \\zeta) = 1 + \\xi\n$$\n$$\nY(\\xi, \\eta, \\zeta) = 0.5(1 + \\eta)\n$$\n$$\nZ(\\xi, \\eta, \\zeta) = 0.75(1 + \\zeta)\n$$\n\n**Part 2: Deformation Gradient and Volume Ratio**\n\nIn a Total Lagrangian (TL) formulation, the deformation gradient $\\boldsymbol{F}$ is defined as the gradient of the current position vector $\\boldsymbol{x}$ with respect to the initial material coordinates $\\boldsymbol{X}$:\n$$\n\\boldsymbol{F} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{X}} = \\frac{\\partial (\\boldsymbol{X} + \\boldsymbol{u})}{\\partial \\boldsymbol{X}} = \\boldsymbol{I} + \\frac{\\partial \\boldsymbol{u}}{\\partial \\boldsymbol{X}}\n$$\nHere, $\\boldsymbol{u}$ is the displacement vector and $\\boldsymbol{I}$ is the second-order identity tensor. The term $\\partial \\boldsymbol{u} / \\partial \\boldsymbol{X}$ is the displacement gradient tensor. The use of this exact kinematic relation, valid for arbitrarily large displacements and rotations, is the foundation of geometric nonlinearity.\n\nTo compute the derivatives with respect to the material coordinates $(X,Y,Z)$, we employ the chain rule, relating them to derivatives in the parent coordinate system $(\\xi, \\eta, \\zeta)$:\n$$\n\\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\\\ \\frac{\\partial}{\\partial \\zeta} \\end{Bmatrix} = \\begin{bmatrix} \\frac{\\partial X}{\\partial \\xi} & \\frac{\\partial Y}{\\partial \\xi} & \\frac{\\partial Z}{\\partial \\xi} \\\\ \\frac{\\partial X}{\\partial \\eta} & \\frac{\\partial Y}{\\partial \\eta} & \\frac{\\partial Z}{\\partial \\eta} \\\\ \\frac{\\partial X}{\\partial \\zeta} & \\frac{\\partial Y}{\\partial \\zeta} & \\frac{\\partial Z}{\\partial \\zeta} \\end{bmatrix} \\begin{Bmatrix} \\frac{\\partial}{\\partial X} \\\\ \\frac{\\partial}{\\partial Y} \\\\ \\frac{\\partial}{\\partial Z} \\end{Bmatrix} = \\boldsymbol{J_0}^T \\begin{Bmatrix} \\frac{\\partial}{\\partial X} \\\\ \\frac{\\partial}{\\partial Y} \\\\ \\frac{\\partial}{\\partial Z} \\end{Bmatrix}\n$$\nThe matrix $\\boldsymbol{J_0}$ is the Jacobian of the mapping from parent to reference coordinates. Its components are $(\\boldsymbol{J_0})_{ij} = \\partial X_i / \\partial \\xi_j$. From our mapping derived in Part 1, we compute $\\boldsymbol{J_0}$:\n$$\n\\boldsymbol{J_0} = \\begin{bmatrix} \\frac{\\partial X}{\\partial \\xi} & \\frac{\\partial X}{\\partial \\eta} & \\frac{\\partial X}{\\partial \\zeta} \\\\ \\frac{\\partial Y}{\\partial \\xi} & \\frac{\\partial Y}{\\partial \\eta} & \\frac{\\partial Y}{\\partial \\zeta} \\\\ \\frac{\\partial Z}{\\partial \\xi} & \\frac{\\partial Z}{\\partial \\eta} & \\frac{\\partial Z}{\\partial \\zeta} \\end{bmatrix} = \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 0.5 & 0 \\\\ 0 & 0 & 0.75 \\end{bmatrix}\n$$\nSince this Jacobian is constant, its value is the same everywhere, including the element center. We require its inverse to find derivatives with respect to $\\boldsymbol{X}$:\n$$\n\\boldsymbol{J_0}^{-1} = \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & \\frac{1}{0.75} \\end{bmatrix} = \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & \\frac{4}{3} \\end{bmatrix}\n$$\nThe displacement gradient $\\nabla_{\\boldsymbol{X}}\\boldsymbol{u} = \\partial \\boldsymbol{u} / \\partial \\boldsymbol{X}$ is computed via the chain rule as $\\nabla_{\\boldsymbol{X}}\\boldsymbol{u} = (\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u})(\\boldsymbol{J_0}^{-1})^T$, where $\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} = \\partial \\boldsymbol{u} / \\partial \\boldsymbol{\\xi}$. Since $\\boldsymbol{J_0}^{-1}$ is diagonal and thus symmetric, $(\\boldsymbol{J_0}^{-1})^T = \\boldsymbol{J_0}^{-1}$.\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial \\boldsymbol{X}} = \\left( \\frac{\\partial \\boldsymbol{u}}{\\partial \\boldsymbol{\\xi}} \\right) \\boldsymbol{J_0}^{-1}\n$$\nThe gradient of the displacement field with respect to parent coordinates, $\\partial \\boldsymbol{u} / \\partial \\boldsymbol{\\xi}$, is found by differentiating the displacement interpolation:\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial \\xi_j} (\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi_j} (\\xi, \\eta, \\zeta) \\boldsymbol{u}_i\n$$\nWe must evaluate this at the element center $(\\xi, \\eta, \\zeta) = (0,0,0)$. The derivatives of the shape functions at this point are:\n$$\n\\frac{\\partial N_i}{\\partial \\xi}\\bigg|_{(0,0,0)} = \\frac{1}{8}\\xi_i, \\quad \\frac{\\partial N_i}{\\partial \\eta}\\bigg|_{(0,0,0)} = \\frac{1}{8}\\eta_i, \\quad \\frac{\\partial N_i}{\\partial \\zeta}\\bigg|_{(0,0,0)} = \\frac{1}{8}\\zeta_i\n$$\nNow we compute the components of the matrix $\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} = [ \\partial u_k / \\partial \\xi_j ]$ at $(0,0,0)$.\nFor $\\partial u_x / \\partial \\xi$:\n$\\frac{\\partial u_x}{\\partial \\xi} = \\frac{1}{8}\\sum_{i=1}^8 \\xi_i u_{ix} = \\frac{1}{8}[(-1)(0) + (1)(0.24) + (1)(0.39) + (-1)(0.15) + (-1)(0.075) + (1)(0.315) + (1)(0.465) + (-1)(0.225)] = \\frac{0.96}{8} = 0.12$\nFollowing this procedure for all nine components of $\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u}$:\n$$\n\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} = \\begin{bmatrix} \\frac{\\partial u_x}{\\partial \\xi} & \\frac{\\partial u_x}{\\partial \\eta} & \\frac{\\partial u_x}{\\partial \\zeta} \\\\ \\frac{\\partial u_y}{\\partial \\xi} & \\frac{\\partial u_y}{\\partial \\eta} & \\frac{\\partial u_y}{\\partial \\zeta} \\\\ \\frac{\\partial u_z}{\\partial \\xi} & \\frac{\\partial u_z}{\\partial \\eta} & \\frac{\\partial u_z}{\\partial \\zeta} \\end{bmatrix} = \\begin{bmatrix} 0.12 & 0.075 & 0.0375 \\\\ 0.10 & -0.025 & -0.0225 \\\\ 0.02 & 0.035 & 0.06 \\end{bmatrix}\n$$\nNow, we compute the displacement gradient $\\nabla_{\\boldsymbol{X}}\\boldsymbol{u}$:\n$$\n\\nabla_{\\boldsymbol{X}}\\boldsymbol{u} = \\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} \\boldsymbol{J_0}^{-1} = \\begin{bmatrix} 0.12 & 0.075 & 0.0375 \\\\ 0.10 & -0.025 & -0.0225 \\\\ 0.02 & 0.035 & 0.06 \\end{bmatrix} \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & \\frac{4}{3} \\end{bmatrix}\n$$\n$$\n\\nabla_{\\boldsymbol{X}}\\boldsymbol{u} = \\begin{bmatrix} (0.12)(1) & (0.075)(2) & (0.0375)(\\frac{4}{3}) \\\\ (0.10)(1) & (-0.025)(2) & (-0.0225)(\\frac{4}{3}) \\\\ (0.02)(1) & (0.035)(2) & (0.06)(\\frac{4}{3}) \\end{bmatrix} = \\begin{bmatrix} 0.12 & 0.15 & 0.05 \\\\ 0.10 & -0.05 & -0.03 \\\\ 0.02 & 0.07 & 0.08 \\end{bmatrix}\n$$\nThe deformation gradient $\\boldsymbol{F}$ is then:\n$$\n\\boldsymbol{F} = \\boldsymbol{I} + \\nabla_{\\boldsymbol{X}}\\boldsymbol{u} = \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} + \\begin{bmatrix} 0.12 & 0.15 & 0.05 \\\\ 0.10 & -0.05 & -0.03 \\\\ 0.02 & 0.07 & 0.08 \\end{bmatrix} = \\begin{bmatrix} 1.12 & 0.15 & 0.05 \\\\ 0.10 & 0.95 & -0.03 \\\\ 0.02 & 0.07 & 1.08 \\end{bmatrix}\n$$\nFinally, the scalar volume ratio $J$ is the determinant of the deformation gradient, $J = \\det(\\boldsymbol{F})$.\n$$\nJ = 1.12((0.95)(1.08) - (-0.03)(0.07)) - 0.15((0.10)(1.08) - (-0.03)(0.02)) + 0.05((0.10)(0.07) - (0.95)(0.02))\n$$\n$$\nJ = 1.12(1.026 + 0.0021) - 0.15(0.108 + 0.0006) + 0.05(0.007 - 0.019)\n$$\n$$\nJ = 1.12(1.0281) - 0.15(0.1086) + 0.05(-0.012)\n$$\n$$\nJ = 1.151472 - 0.01629 - 0.0006\n$$\n$$\nJ = 1.134582\n$$\nRounding to four significant figures as required, we obtain $J = 1.135$.", "answer": "$$\n\\boxed{1.135}\n$$", "id": "2597165"}, {"introduction": "Material nonlinearity arises from the complex constitutive behavior of materials like elastomers or metals undergoing plasticity, where stress is not a linear function of strain. This practice problem moves from kinematics to constitutive modeling, asking you to derive the stress tensor and the consistent tangent modulus for a hyperelastic neo-Hookean material [@problem_id:2597193]. Deriving the tangent modulus, $\\mathbb{C}$, is a critical skill, as it is the key to creating numerically efficient solvers that maintain quadratic convergence rates in a Newton-Raphson scheme.", "problem": "Consider a hyperelastic compressible neo-Hookean solid used in the finite element method, with stored energy density (per reference volume) specified as a function of the deformation gradient $F$ by\n$$\nW(F) = \\frac{\\mu}{2}\\left(I_{1} - 3\\right) - \\mu \\,\\ln J + \\frac{\\kappa}{2}\\left(\\ln J\\right)^{2},\n$$\nwhere $C = F^{\\mathsf{T}} F$ is the right Cauchyâ€“Green deformation tensor, $I_{1} = \\operatorname{tr}(C)$, $J = \\det(F)$, and $\\mu$ and $\\kappa$ are material parameters. The second Piolaâ€“Kirchhoff stress $S$ and the Greenâ€“Lagrange strain $E$ are related by $E = \\tfrac{1}{2}(C - I)$ and the constitutive law $S = 2\\,\\partial W/\\partial C$ for hyperelasticity.\n\nTasks:\n- Starting from the principles of hyperelasticity and tensor calculus, derive the algorithmic stress update, namely an explicit expression for $S$ in terms of $F$ (or equivalently $C$), without introducing any approximations.\n- Compute the consistent material tangent $\\mathbb{C} = \\partial S/\\partial E$ in closed form as a fourth-order tensor. You may employ standard tensor products; if you do, define them clearly.\n- To produce a single scalar result, specialize your tangent to the homogeneous deformation $F = \\operatorname{diag}(\\lambda, 1, 1)$ and report the component $\\mathbb{C}_{1111}$ as a closed-form analytic expression in terms of $\\lambda$, $\\mu$, and $\\kappa$.\n\nAnswer specification:\n- Your final reported quantity must be the single expression for $\\mathbb{C}_{1111}$ in terms of $\\lambda$, $\\mu$, and $\\kappa$.\n- Express your final answer symbolically. Do not evaluate numerically and do not attach units.", "solution": "We begin from the hyperelastic definition of stress with respect to the right Cauchyâ€“Green deformation tensor $C = F^{\\mathsf{T}} F$. For a stored energy $W(C)$, the second Piolaâ€“Kirchhoff stress is given by\n$$\nS = 2\\,\\frac{\\partial W}{\\partial C}.\n$$\nThe Greenâ€“Lagrange strain is $E = \\tfrac{1}{2}(C - I)$ so that the consistent material tangent with respect to $E$ is\n$$\n\\mathbb{C} = \\frac{\\partial S}{\\partial E} = 2\\,\\frac{\\partial S}{\\partial C},\n$$\nbecause $\\partial/\\partial E = 2\\,\\partial/\\partial C$.\n\nThe chosen compressible neo-Hookean energy is\n$$\nW(C) = \\frac{\\mu}{2}\\left(\\operatorname{tr}C - 3\\right) - \\mu\\,\\ln J + \\frac{\\kappa}{2}\\left(\\ln J\\right)^{2},\n$$\nwith $J = \\det(F)$. Since $C = F^{\\mathsf{T}}F$ and $\\det(C) = J^{2}$, it follows that $\\ln J = \\tfrac{1}{2}\\ln\\det C$. We will need the following standard tensor calculus identities for a symmetric, positive-definite $C$:\n- The variation of the inverse: $\\mathrm{d}C^{-1} = -\\,C^{-1}\\,(\\mathrm{d}C)\\,C^{-1}$.\n- The variation of the logarithmic Jacobian: $\\mathrm{d}(\\ln J) = \\frac{1}{2}\\,C^{-1}:\\mathrm{d}C$, where $A:B = \\operatorname{tr}(A^{\\mathsf{T}} B)$ denotes the double contraction.\n\nStep one: compute $S$.\nCompute the first variation of $W$:\n$$\n\\mathrm{d}W = \\frac{\\mu}{2}\\,\\mathrm{d}(\\operatorname{tr}C) - \\mu\\,\\mathrm{d}(\\ln J) + \\kappa\\,\\ln J\\,\\mathrm{d}(\\ln J).\n$$\nUsing $\\mathrm{d}(\\operatorname{tr}C) = I : \\mathrm{d}C$ and $\\mathrm{d}(\\ln J) = \\tfrac{1}{2} C^{-1}:\\mathrm{d}C$,\n$$\n\\mathrm{d}W = \\left[\\frac{\\mu}{2} I - \\frac{\\mu}{2} C^{-1} + \\frac{\\kappa}{2}\\,\\ln J\\,C^{-1}\\right] : \\mathrm{d}C.\n$$\nTherefore,\n$$\n\\frac{\\partial W}{\\partial C} = \\frac{\\mu}{2} I - \\frac{\\mu}{2} C^{-1} + \\frac{\\kappa}{2}\\,\\ln J\\,C^{-1},\n$$\nand thus\n$$\nS = 2\\,\\frac{\\partial W}{\\partial C} = \\mu\\,I - \\mu\\,C^{-1} + \\kappa\\,\\ln J\\,C^{-1}.\n$$\nThis is the exact algorithmic stress update expressed in terms of $C$ (and hence $F$ through $C = F^{\\mathsf{T}}F$) with no approximations. It exhibits both geometric nonlinearity through $C^{-1}$ and $J$ and material nonlinearity through the nonlinear dependence on invariants.\n\nStep two: compute the consistent tangent $\\mathbb{C} = \\partial S/\\partial E$.\nDifferentiate $S$ with respect to $C$:\n$$\n\\mathrm{d}S = -\\mu\\,\\mathrm{d}(C^{-1}) + \\kappa\\,\\mathrm{d}(\\ln J)\\,C^{-1} + \\kappa\\,\\ln J\\,\\mathrm{d}(C^{-1}).\n$$\nInsert the identities $\\mathrm{d}C^{-1} = -\\,C^{-1}\\,(\\mathrm{d}C)\\,C^{-1}$ and $\\mathrm{d}(\\ln J) = \\frac{1}{2} C^{-1}:\\mathrm{d}C$ to obtain\n$$\n\\mathrm{d}S = \\mu\\,C^{-1}(\\mathrm{d}C)C^{-1} + \\frac{\\kappa}{2}\\,(C^{-1}:\\mathrm{d}C)\\,C^{-1} - \\kappa\\,\\ln J\\,C^{-1}(\\mathrm{d}C)C^{-1}.\n$$\nCollecting terms,\n$$\n\\mathrm{d}S = \\left(\\mu - \\kappa\\,\\ln J\\right)\\,C^{-1}(\\mathrm{d}C)C^{-1} + \\frac{\\kappa}{2}\\,(C^{-1}:\\mathrm{d}C)\\,C^{-1}.\n$$\nIntroduce the following fourth-order tensor products to represent the linear map $\\mathrm{d}C \\mapsto \\mathrm{d}S$:\n- For second-order tensors $A$ and $B$, define the non-symmetric product $(A \\otimes B)_{ijkl} = A_{ij} B_{kl}$ so that $(A \\otimes B):X = A\\,(B:X)$.\n- Define the symmetric (with respect to interchange of the last two indices when acting on symmetric arguments) product $(A \\odot B)_{ijkl} = \\tfrac{1}{2}\\left(A_{ik}B_{jl} + A_{il}B_{jk}\\right)$ so that, for symmetric $X$, $(A \\odot B):X = \\tfrac{1}{2}\\left(A X B^{\\mathsf{T}} + A X^{\\mathsf{T}} B^{\\mathsf{T}}\\right) = A X B^{\\mathsf{T}}$.\n\nWith these, the derivative with respect to $C$ can be written as\n$$\n\\frac{\\partial S}{\\partial C} \\equiv \\mathbb{A} = \\left(\\mu - \\kappa\\,\\ln J\\right)\\,(C^{-1} \\odot C^{-1}) + \\frac{\\kappa}{2}\\,(C^{-1} \\otimes C^{-1}).\n$$\nSince $\\mathbb{C} = \\partial S/\\partial E = 2\\,\\partial S/\\partial C$, we obtain the consistent material tangent\n$$\n\\mathbb{C} = 2\\left(\\mu - \\kappa\\,\\ln J\\right)\\,(C^{-1} \\odot C^{-1}) + \\kappa\\,(C^{-1} \\otimes C^{-1}).\n$$\nThis fourth-order tensor possesses the standard major symmetry and, when restricted to symmetric arguments, the required minor symmetries due to hyperelasticity.\n\nStep three: specialize to $F = \\operatorname{diag}(\\lambda, 1, 1)$ and compute $\\mathbb{C}_{1111}$.\nFor this homogeneous deformation,\n$$\nC = F^{\\mathsf{T}}F = \\operatorname{diag}(\\lambda^{2}, 1, 1), \\qquad C^{-1} = \\operatorname{diag}(\\lambda^{-2}, 1, 1), \\qquad J = \\det(F) = \\lambda.\n$$\nWe need the component $\\mathbb{C}_{1111}$. Using the component forms,\n$$\n(C^{-1} \\odot C^{-1})_{1111} = \\frac{1}{2}\\left(C^{-1}_{11} C^{-1}_{11} + C^{-1}_{11} C^{-1}_{11}\\right) = \\left(C^{-1}_{11}\\right)^{2} = \\lambda^{-4},\n$$\nand\n$$\n(C^{-1} \\otimes C^{-1})_{1111} = C^{-1}_{11}\\,C^{-1}_{11} = \\lambda^{-4}.\n$$\nTherefore,\n$$\n\\mathbb{C}_{1111} = 2\\left(\\mu - \\kappa\\,\\ln \\lambda\\right)\\lambda^{-4} + \\kappa\\,\\lambda^{-4} = \\left[2\\mu + \\kappa\\left(1 - 2\\ln \\lambda\\right)\\right]\\lambda^{-4}.\n$$\nThis is the requested single closed-form expression in terms of $\\lambda$, $\\mu$, and $\\kappa$.\n\nRemarks on sources of nonlinearity: The dependence of $S$ and $\\mathbb{C}$ on $F$ enters through $C^{-1}$ and $J = \\det(F)$, providing geometric nonlinearity. The constitutive dependence on $\\ln J$ and multiplicative inverse $C^{-1}$ are inherently nonlinear in the material response, representing material nonlinearity. No boundary nonlinearity is present in this constitutive derivation, but in a finite element method discretization, nonlinear boundary conditions would add an additional source beyond the scope of this derivation.", "answer": "$$\\boxed{\\left[2\\mu+\\kappa\\left(1-2\\ln \\lambda\\right)\\right]\\lambda^{-4}}$$", "id": "2597193"}, {"introduction": "Boundary nonlinearities, often the most challenging to handle numerically, occur when boundary conditions themselves change during the analysis, with mechanical contact being the canonical example. This exercise confronts the non-smooth nature of contact, where the binary \"on-or-off\" state of contact violates the differentiability assumptions of standard solution methods [@problem_id:2597217]. By analyzing the formulation of a semi-smooth Newton method, you will engage with the advanced mathematical tools required to build robust solvers for problems involving such inequality constraints.", "problem": "A frictionless unilateral contact problem is modeled for a linearly elastic body undergoing small deformations, discretized using the finite element method (FEM). Let $u \\in \\mathbb{R}^n$ denote the global displacement vector, $\\lambda \\in \\mathbb{R}^m$ the nodal normal contact forces (Lagrange multipliers), and $N \\in \\mathbb{R}^{m \\times n}$ the matrix mapping displacements to normal gaps through $g(u) = N u - g_0$, where $g_0 \\in \\mathbb{R}^m$ is the initial gap with the rigid obstacle. The equilibrium residual is $R_u(u,\\lambda) = K u + N^T \\lambda - f$, where $K \\in \\mathbb{R}^{n \\times n}$ is the symmetric positive definite stiffness matrix on the unconstrained subspace and $f \\in \\mathbb{R}^n$ is the external load vector. The contact conditions are the Signorini complementarity conditions $g(u) \\ge 0$, $\\lambda \\ge 0$, and $g(u)^T \\lambda = 0$.\n\nIt is observed that a naive Newtonâ€“Raphson iteration applied directly to an equation-based reformulation of the complementarity constraints fails to converge when contact status switches between active and inactive at some nodes. This failure is attributed to the non-smoothness of the boundary conditions.\n\nWhich option both correctly identifies the source of nonlinearity responsible for the observed convergence issues and proposes a valid semi-smooth Newton method that uses a generalized derivative consistent with an active-set characterization for the contact nodes? Select the single best option.\n\nA. The nonlinearity is due to the inequality-type boundary condition. Introduce a nonsmooth residual for the contact via a projection onto the nonnegative orthant with a parameter $c > 0$, and apply a semi-smooth Newton method to the coupled system. Define $y = \\lambda - c\\, g(u)$ and $P(y) = \\max(0, y)$ (applied componentwise). The contact residual is $R_\\lambda(u,\\lambda) = \\lambda - P(y)$. A generalized Jacobian is obtained by selecting a diagonal matrix $D \\in \\mathbb{R}^{m \\times m}$ with entries $D_{ii} = 1$ if $y_i > 0$ (contact active), $D_{ii} = 0$ if $y_i < 0$ (contact inactive), and any $D_{ii} \\in [0,1]$ if $y_i = 0$ (biactive). The corresponding semi-smooth Newton step $(\\Delta u, \\Delta \\lambda)$ at $(u,\\lambda)$ solves\n$$\n\\begin{bmatrix}\nK & N^T \\\\\nc\\, D\\, N & I - D\n\\end{bmatrix}\n\\begin{bmatrix}\n\\Delta u \\\\ \\Delta \\lambda\n\\end{bmatrix}\n=\n-\n\\begin{bmatrix}\nR_u(u,\\lambda) \\\\\nR_\\lambda(u,\\lambda)\n\\end{bmatrix},\n$$\nand the active set is updated from the sign of $y$.\n\nB. The nonlinearity primarily arises from geometric effects because the gap $g(u)$ depends on $u$. Replace the complementarity conditions by a smooth penalty potential with stiffness $c > 0$, giving a smooth residual $R_\\lambda(u) = c\\, \\min(0, g(u))$, and apply the classical Newtonâ€“Raphson method to the penalized equilibrium $K u + N^T R_\\lambda(u) - f = 0$ with tangent $K_t = K + c\\, N^T N$.\n\nC. The difficulty is numerical noise, not non-smoothness. Reformulate the complementarity by the Fischerâ€“Burmeister function $\\phi(a,b) = \\sqrt{a^2 + b^2} - (a + b)$ and apply standard Newton because $\\phi$ is smooth, using the Jacobian obtained by differentiating $\\phi(g(u), \\lambda)$.\n\nD. The nonlinearity is due to the inequality boundary but can be handled by a semi-smooth Newton method that linearizes the projection with the diagonal $D$ defined by $D_{ii} = 0$ on the active set and $D_{ii} = 1$ on the inactive set. The Newton system is\n$$\n\\begin{bmatrix}\nK & N^T \\\\\n-\\, c\\, D\\, N & I + D\n\\end{bmatrix}\n\\begin{bmatrix}\n\\Delta u \\\\ \\Delta \\lambda\n\\end{bmatrix}\n=\n-\n\\begin{bmatrix}\nR_u(u,\\lambda) \\\\\nR_\\lambda(u,\\lambda)\n\\end{bmatrix}.\n$$\n\nE. The nonlinearity is boundary-induced, but the generalized derivative is unnecessary. A fixed active set is chosen at the initial guess and held constant. The Newton system reduces to a smooth block system by eliminating the inactive multipliers and enforcing $g(u) = 0$ on the hypothesized active set until convergence.", "solution": "The user has provided a problem in computational contact mechanics. The first step is to validate the problem statement.\n\n**Step 1: Extract Givens**\n\n*   **Problem Domain**: Frictionless unilateral contact for a linearly elastic body with small deformations, discretized using the Finite Element Method (FEM).\n*   **Variables**:\n    *   $u \\in \\mathbb{R}^n$: global displacement vector.\n    *   $\\lambda \\in \\mathbb{R}^m$: nodal normal contact forces (Lagrange multipliers).\n*   **Problem Data**:\n    *   $K \\in \\mathbb{R}^{n \\times n}$: symmetric positive definite stiffness matrix.\n    *   $f \\in \\mathbb{R}^n$: external load vector.\n    *   $N \\in \\mathbb{R}^{m \\times n}$: matrix mapping displacements to normal gaps.\n    *   $g_0 \\in \\mathbb{R}^m$: initial gap vector.\n*   **Governing Relations**:\n    *   Normal gap function: $g(u) = N u - g_0$.\n    *   Equilibrium residual: $R_u(u,\\lambda) = K u + N^T \\lambda - f$.\n    *   Signorini complementarity conditions: $g(u) \\ge 0$, $\\lambda \\ge 0$, and $g(u)^T \\lambda = 0$.\n*   **Observation**: A naive Newtonâ€“Raphson method fails to converge when contact status changes, due to the non-smoothness of the boundary conditions.\n*   **Question**: Identify the option that correctly identifies the source of nonlinearity and proposes a valid semi-smooth Newton method using a consistent generalized derivative and active-set characterization.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientific Grounding**: The problem statement is scientifically sound. It presents the standard Karush-Kuhn-Tucker (KKT) conditions for a quadratic programming problem, which is the classical formulation of a linearly elastic, small-deformation, frictionless contact problem. The identification of non-smoothness as the source of convergence issues for standard Newton methods is correct, and the suggestion of semi-smooth Newton methods as a remedy is a standard and advanced topic in computational mechanics.\n*   **Well-Posedness**: The problem is well-posed. The underlying physical problem, under the given assumptions ($K$ is symmetric positive definite), has a unique solution. The question asks for the identification of a correct numerical method from a set of options, which is a well-defined task.\n*   **Objectivity**: The problem is stated in precise, objective mathematical language.\n*   **Flaw Checklist**: The problem does not violate any of the specified criteria for invalidity. It is scientifically sound, formalizable, complete, realistic, well-posed, and non-trivial.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid. I will now proceed with a full derivation and analysis.\n\nThe problem is to solve the system defined by the KKT conditions for contact:\n$$\n\\begin{cases}\n    K u + N^T \\lambda - f = 0 \\\\\n    g(u) \\ge 0, \\quad \\lambda \\ge 0 \\\\\n    g(u)^T \\lambda = 0\n\\end{cases}\n$$\nwhere $g(u) = N u - g_0$. The core difficulty lies in the complementarity conditions, which can be stated component-wise as $g_i(u) \\ge 0$, $\\lambda_i \\ge 0$, and $g_i(u) \\lambda_i = 0$ for each contact node $i$. These conditions introduce non-differentiability, rendering standard Newton-Raphson methods inapplicable directly. The source of this difficulty is not material nonlinearity (the body is linearly elastic) nor geometric nonlinearity (deformations are small, and the gap function is linear), but is a **boundary nonlinearity** arising from the inequality constraints.\n\nA semi-smooth Newton method is required. This involves reformulating the complementarity conditions as a system of non-smooth equations. A prominent class of such reformulations is based on so-called NCP-functions (Nonlinear Complementarity Problem functions), $\\phi(a,b)$, which have the property that $\\phi(a,b)=0 \\iff a \\ge 0, b \\ge 0, ab=0$.\n\nOne such reformulation uses the projection onto the non-negative orthant. The condition $a \\ge 0, b \\ge 0, ab=0$ is equivalent to $a - \\max(0, a - cb) = 0$ for any constant $c > 0$. Let us apply this to our problem by setting $a = \\lambda$ and $b = g(u)$. The complementarity condition is then equivalent to the equation:\n$$\n\\lambda - \\max(0, \\lambda - c\\,g(u)) = 0\n$$\nLet us define the argument of the projection as $y(u, \\lambda) = \\lambda - c\\,g(u)$ and use the operator $P(y) = \\max(0, y)$, applied component-wise. The KKT system is rewritten as a system of equations:\n$$\nR(u, \\lambda) = \\begin{bmatrix} R_u(u, \\lambda) \\\\ R_\\lambda(u, \\lambda) \\end{bmatrix} = \\begin{bmatrix} K u + N^T \\lambda - f \\\\ \\lambda - P(y(u, \\lambda)) \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}\n$$\nThis system is non-smooth because the projection operator $P$ is not differentiable when any component of its argument is zero. However, it is a semi-smooth function, which permits the use of a semi-smooth Newton method. The method linearizes the system at the current iterate $(u^k, \\lambda^k)$ by solving:\n$$\nJ_{gen}(u^k, \\lambda^k) \\begin{bmatrix} \\Delta u \\\\ \\Delta \\lambda \\end{bmatrix} = - R(u^k, \\lambda^k)\n$$\nwhere $J_{gen}$ is an element of the generalized Jacobian (Clarke subdifferential) of $R$. We must compute this generalized Jacobian.\n$$\nJ_{gen} = \\begin{bmatrix} \\frac{\\partial R_u}{\\partial u} & \\frac{\\partial R_u}{\\partial \\lambda} \\\\ \\frac{\\partial R_\\lambda}{\\partial u} & \\frac{\\partial R_\\lambda}{\\partial \\lambda} \\end{bmatrix}\n$$\nThe top block is linear: $\\frac{\\partial R_u}{\\partial u} = K$ and $\\frac{\\partial R_u}{\\partial \\lambda} = N^T$.\nFor the bottom block, we use the chain rule for generalized derivatives. The generalized derivative of $P(y)$ can be represented by a diagonal matrix $D$, where its diagonal entries $D_{ii}$ are taken from the subdifferential of the scalar function $\\max(0, \\cdot)$ at $y_i$:\n*   If $y_i > 0$, the derivative is $1$. So, $D_{ii} = 1$.\n*   If $y_i < 0$, the derivative is $0$. So, $D_{ii} = 0$.\n*   If $y_i = 0$, the subdifferential is the interval $[0,1]$. We can choose any value, for instance $D_{ii}=0$ or $D_{ii}=1$.\n\nWith this matrix $D$, the generalized derivatives of $R_\\lambda$ are:\n$$\n\\frac{\\partial R_\\lambda}{\\partial u} = \\frac{\\partial}{\\partial u} [\\lambda - P(\\lambda - c(Nu-g_0))] = -D \\cdot \\frac{\\partial}{\\partial u} [\\lambda - cNu + cg_0] = -D(-cN) = cDN\n$$\n$$\n\\frac{\\partial R_\\lambda}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} [\\lambda - P(\\lambda - c\\,g(u))] = I - D \\cdot \\frac{\\partial}{\\partial \\lambda} [\\lambda - c\\,g(u)] = I - D(I) = I - D\n$$\nThus, the generalized Jacobian matrix is:\n$$\nJ_{gen} = \\begin{bmatrix} K & N^T \\\\ cDN & I-D \\end{bmatrix}\n$$\nThe sign of $y_i = \\lambda_i - c\\,g_i(u)$ determines the contact state for the next iteration.\n*   If contact is active ($g_i \\to 0, \\lambda_i > 0$), then $y_i \\approx \\lambda_i > 0$. For this case, $D_{ii}=1$.\n*   If contact is inactive ($g_i > 0, \\lambda_i \\to 0$), then $y_i \\approx -c\\,g_i < 0$. For this case, $D_{ii}=0$.\nThe problem now is to evaluate the given options against this correct derivation.\n\n**Option-by-Option Analysis**\n\n**A. The nonlinearity is due to the inequality-type boundary condition. Introduce a nonsmooth residual for the contact via a projection onto the nonnegative orthant with a parameter $c > 0$, and apply a semi-smooth Newton method to the coupled system. ...**\n\nThis option correctly identifies the source of nonlinearity as the \"inequality-type boundary condition\". It proposes a semi-smooth Newton method based on the projection function $P(y) = \\max(0, y)$, which is a standard and correct approach. The contact residual is given as $R_\\lambda(u,\\lambda) = \\lambda - P(y)$ with $y = \\lambda - c\\, g(u)$, which exactly matches the formulation $\\lambda - \\max(0, \\lambda - c\\,g(u))=0$ derived above. The generalized Jacobian is given as $\\begin{bmatrix} K & N^T \\\\ c\\, D\\, N & I - D \\end{bmatrix}$, which perfectly matches our derived matrix. The definition of the diagonal matrix $D$ with $D_{ii} = 1$ for $y_i > 0$ (active) and $D_{ii} = 0$ for $y_i < 0$ (inactive) is also correct. The entire description is consistent and mathematically sound.\n**Verdict: Correct.**\n\n**B. The nonlinearity primarily arises from geometric effects because the gap $g(u)$ depends on $u$. Replace the complementarity conditions by a smooth penalty potential...**\n\nThis option incorrectly identifies the source of nonlinearity. Since the problem specifies small deformations and a linear gap function $g(u) = Nu - g_0$, there is no geometric nonlinearity. The nonlinearity is from the switching nature of the boundary conditions. The proposed method is a penalty method, which replaces the non-smooth problem with a smooth but approximate one. While a valid numerical strategy in some contexts, it is not a semi-smooth Newton method and is known to introduce ill-conditioning. The question specifically asks for a semi-smooth Newton method.\n**Verdict: Incorrect.**\n\n**C. The difficulty is numerical noise, not non-smoothness. Reformulate the complementarity by the Fischerâ€“Burmeister function...and apply standard Newton because $\\phi$ is smooth...**\n\nThis option is fundamentally flawed. The primary difficulty is an inherent non-smoothness, not numerical noise. It proposes using the Fischer-Burmeister function $\\phi(a,b) = \\sqrt{a^2 + b^2} - (a+b)$. While this is a valid NCP-function, the claim that it \"is smooth\" is false. The function $\\phi(a,b)$ is not differentiable at $(a,b) = (0,0)$. This point corresponds precisely to the biactive state ($g_i=0, \\lambda_i=0$), where the non-smoothness is critical. Because of this, a semi-smooth Newton method is still required, not a \"standard Newton\" method.\n**Verdict: Incorrect.**\n\n**D. The nonlinearity is due to the inequality boundary but can be handled by a semi-smooth Newton method that linearizes the projection with the diagonal $D$ defined by $D_{ii} = 0$ on the active set and $D_{ii} = 1$ on the inactive set...**\n\nThis option correctly identifies the source of nonlinearity but presents an incorrect mathematical formulation. The definition of the matrix $D$ is the reverse of the correct one derived from the projection operator in option A. While a different NCP-function could potentially lead to such a definition of $D$, the system matrix $\\begin{bmatrix} K & N^T \\\\ -\\, c\\, D\\, N & I + D \\end{bmatrix}$ does not correspond to a consistent derivation for any standard NCP-function. For instance, the signs and terms in the lower block, such as $-cDN$ and $I+D$, are inconsistent with the underlying theory of generalized derivatives for such problems.\n**Verdict: Incorrect.**\n\n**E. The nonlinearity is boundary-induced, but the generalized derivative is unnecessary. A fixed active set is chosen...and held constant...**\n\nThis option correctly identifies the source of nonlinearity but dismisses the necessary tool to solve it. It describes a classical, but often inefficient and unreliable, \"active-set strategy\". By fixing the active set, one solves a sequence of linear problems. This method is known to fail to converge (\"chatter\") precisely in the situations described in the problemâ€”when the contact status of nodes is changing between iterations. The claim that a \"generalized derivative is unnecessary\" is a direct contradiction of the modern, robust theory for solving such non-smooth problems.\n**Verdict: Incorrect.**\n\nIn summary, only Option A presents a fully correct and consistent description of a valid method that answers the question. It correctly identifies the source of nonlinearity and details a state-of-the-art semi-smooth Newton method with the correct residual formulation and the corresponding correct generalized Jacobian.", "answer": "$$\\boxed{A}$$", "id": "2597217"}]}