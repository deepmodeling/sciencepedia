{"hands_on_practices": [{"introduction": "Understanding line search begins with the ideal case. This exercise tasks you with analyzing a simple convex quadratic energy functional, which is the cornerstone of linear finite element analysis. By deriving the exact step length that minimizes the energy and comparing it to the step accepted by a practical backtracking algorithm [@problem_id:2573793], you will build a fundamental intuition for how inexact line searches balance computational efficiency with the core requirement of sufficient decrease.", "problem": "Consider the quadratic energy arising from the finite element discretization of linear elasticity,\n$$J(u) = \\tfrac{1}{2}\\,u^{\\top} K u - f^{\\top} u,$$\nwhere $K \\in \\mathbb{R}^{2 \\times 2}$ is a symmetric positive definite (SPD) stiffness matrix and $f \\in \\mathbb{R}^{2}$ is the load vector. Let\n$$K = \\begin{pmatrix} 8 & -2 \\\\ -2 & 5 \\end{pmatrix}, \\qquad f = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}, \\qquad u^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.$$\nAdopt the standard Euclidean inner product and the steepest descent direction $p^{(0)} = -\\nabla J(u^{(0)})$. Starting from the definitions of gradient and directional derivative of $J$ and the Armijo sufficient decrease condition, do the following:\n\n1) Derive from first principles the exact step length $\\alpha_{\\star}$ that minimizes $J(u^{(0)} + \\alpha\\, p^{(0)})$ along the steepest descent direction.\n\n2) Using a backtracking line search with Armijo parameter $c_{1} = 10^{-4}$, initial trial step $\\alpha_{0} = 1$, and reduction factor $\\rho = \\tfrac{1}{2}$, determine the accepted backtracking step $\\alpha_{\\mathrm{bt}}$ at $u^{(0)}$ (that is, the first $\\alpha$ in the sequence $\\{ \\alpha_{0}, \\rho \\alpha_{0}, \\rho^{2} \\alpha_{0}, \\dots \\}$ that satisfies the Armijo condition).\n\n3) Report the ratio $\\alpha_{\\mathrm{bt}}/\\alpha_{\\star}$ as a single reduced fraction. No rounding is required.", "solution": "The problem is scientifically grounded, well-posed, and contains all necessary information for a unique solution. The stiffness matrix $K$ is symmetric. Its positive definiteness is confirmed by Sylvester's criterion: the first leading principal minor is $\\det(8) = 8 > 0$, and the second is $\\det(K) = (8)(5) - (-2)(-2) = 40 - 4 = 36 > 0$. As $K$ is symmetric positive definite (SPD), the quadratic functional $J(u)$ is strictly convex and has a unique minimum. We proceed with the solution.\n\nThe quadratic energy functional is given by\n$$J(u) = \\frac{1}{2}u^{\\top} K u - f^{\\top} u.$$\nThe gradient of this functional with respect to $u$ is found using matrix calculus. The derivative of the quadratic term $\\frac{1}{2}u^{\\top} K u$ is $\\frac{1}{2}(K + K^{\\top})u$, and the derivative of the linear term $-f^{\\top} u$ is $-f$. Since the stiffness matrix $K$ is symmetric ($K = K^{\\top}$), the gradient simplifies to\n$$\\nabla J(u) = K u - f.$$\nWe are given the initial point $u^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$. At this point, the gradient is\n$$\\nabla J(u^{(0)}) = K u^{(0)} - f = K \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} - f = -f = -\\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ -1 \\end{pmatrix}.$$\nThe steepest descent direction $p^{(0)}$ is defined as the negative of the gradient at $u^{(0)}$:\n$$p^{(0)} = -\\nabla J(u^{(0)}) = -(-f) = f = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}.$$\n\n1) First, we derive the exact step length $\\alpha_{\\star}$. This is the value of $\\alpha > 0$ that minimizes the one-dimensional function $\\phi(\\alpha) = J(u^{(0)} + \\alpha p^{(0)})$.\n$$\\phi(\\alpha) = J(u^{(0)} + \\alpha p^{(0)}) = \\frac{1}{2}(u^{(0)} + \\alpha p^{(0)})^{\\top} K (u^{(0)} + \\alpha p^{(0)}) - f^{\\top}(u^{(0)} + \\alpha p^{(0)}).$$\nSubstituting $u^{(0)} = 0$, the expression simplifies:\n$$\\phi(\\alpha) = \\frac{1}{2}(\\alpha p^{(0)})^{\\top} K (\\alpha p^{(0)}) - f^{\\top}(\\alpha p^{(0)}) = \\frac{1}{2}\\alpha^{2} (p^{(0)})^{\\top} K p^{(0)} - \\alpha f^{\\top} p^{(0)}.$$\nTo find the minimum of this quadratic function of $\\alpha$, we set its derivative with respect to $\\alpha$ to zero:\n$$\\frac{d\\phi}{d\\alpha} = \\alpha (p^{(0)})^{\\top} K p^{(0)} - f^{\\top} p^{(0)} = 0.$$\nSolving for $\\alpha$ gives the exact step length $\\alpha_{\\star}$:\n$$\\alpha_{\\star} = \\frac{f^{\\top} p^{(0)}}{(p^{(0)})^{\\top} K p^{(0)}}.$$\nSince $p^{(0)} = f$, we can write this as\n$$\\alpha_{\\star} = \\frac{f^{\\top} f}{f^{\\top} K f}.$$\nWe now compute the necessary quantities with the given $K$ and $f$:\n$$f^{\\top} f = \\begin{pmatrix} 2 & 1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = 2^{2} + 1^{2} = 4 + 1 = 5.$$\n$$K f = \\begin{pmatrix} 8 & -2 \\\\ -2 & 5 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} (8)(2) + (-2)(1) \\\\ (-2)(2) + (5)(1) \\end{pmatrix} = \\begin{pmatrix} 16 - 2 \\\\ -4 + 5 \\end{pmatrix} = \\begin{pmatrix} 14 \\\\ 1 \\end{pmatrix}.$$\n$$f^{\\top} K f = \\begin{pmatrix} 2 & 1 \\end{pmatrix} \\begin{pmatrix} 14 \\\\ 1 \\end{pmatrix} = (2)(14) + (1)(1) = 28 + 1 = 29.$$\nSubstituting these values, we find the exact step length:\n$$\\alpha_{\\star} = \\frac{5}{29}.$$\n\n2) Next, we find the accepted backtracking step length $\\alpha_{\\mathrm{bt}}$. The backtracking line search starts with an initial trial step $\\alpha_{0}=1$ and iteratively reduces it by a factor $\\rho = \\frac{1}{2}$ until the Armijo sufficient decrease condition is met. The Armijo condition is\n$$J(u^{(k)} + \\alpha p^{(k)}) \\le J(u^{(k)}) + c_{1} \\alpha \\nabla J(u^{(k)})^{\\top} p^{(k)}.$$\nFor our problem at the initial step ($k=0$), this becomes\n$$J(u^{(0)} + \\alpha p^{(0)}) \\le J(u^{(0)}) + c_{1} \\alpha \\nabla J(u^{(0)})^{\\top} p^{(0)}.$$\nWe evaluate each term:\n$$J(u^{(0)}) = J(\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}) = \\frac{1}{2}(0) - 0 = 0.$$\n$$\\nabla J(u^{(0)})^{\\top} p^{(0)} = (-f)^{\\top} f = -f^{\\top} f = -5.$$\n$$J(u^{(0)} + \\alpha p^{(0)}) = \\phi(\\alpha) = \\frac{1}{2}\\alpha^{2} (p^{(0)})^{\\top} K p^{(0)} - \\alpha f^{\\top} p^{(0)} = \\frac{29}{2}\\alpha^{2} - 5\\alpha.$$\nThe Armijo condition is thus\n$$\\frac{29}{2}\\alpha^{2} - 5\\alpha \\le 0 + c_{1} \\alpha (-5) = -5 c_{1} \\alpha.$$\nSince $\\alpha$ must be positive, we can divide by $\\alpha$:\n$$\\frac{29}{2}\\alpha - 5 \\le -5 c_{1}.$$\n$$\\frac{29}{2}\\alpha \\le 5 - 5 c_{1} = 5(1 - c_{1}).$$\n$$\\alpha \\le \\frac{10}{29}(1 - c_{1}).$$\nUsing the given Armijo parameter $c_{1} = 10^{-4}$:\n$$\\alpha \\le \\frac{10}{29}(1 - 10^{-4}) = \\frac{10}{29}(0.9999) = \\frac{9.999}{29}.$$\nNow we test the sequence of trial steps $\\alpha = \\{1, \\frac{1}{2}, \\frac{1}{4}, \\dots \\}$.\n- Test $\\alpha = 1$: Is $1 \\le \\frac{9.999}{29}$? No, since $29 > 9.999$. Reject.\n- Test $\\alpha = \\frac{1}{2}$: Is $\\frac{1}{2} \\le \\frac{9.999}{29}$? This is equivalent to $29 \\le 2(9.999) = 19.998$. No. Reject.\n- Test $\\alpha = \\frac{1}{4}$: Is $\\frac{1}{4} \\le \\frac{9.999}{29}$? This is equivalent to $29 \\le 4(9.999) = 39.996$. Yes. Accept.\nThe first step length to satisfy the condition is $\\alpha = \\frac{1}{4}$. Thus, the accepted backtracking step is\n$$\\alpha_{\\mathrm{bt}} = \\frac{1}{4}.$$\n\n3) Finally, we compute the ratio of the backtracking step to the exact step:\n$$\\frac{\\alpha_{\\mathrm{bt}}}{\\alpha_{\\star}} = \\frac{1/4}{5/29} = \\frac{1}{4} \\cdot \\frac{29}{5} = \\frac{29}{20}.$$\nThis fraction is already in simplest form as $29$ is a prime number and $20$ is not a multiple of $29$.", "answer": "$$\\boxed{\\frac{29}{20}}$$", "id": "2573793"}, {"introduction": "Real-world nonlinear problems are rarely as well-behaved as simple quadratics; their energy landscapes can be non-convex. This practice explores what happens when the tangent stiffness becomes indefinite, a situation where the pure Newton direction may not be a descent direction for the potential energy. By demonstrating this failure and then deriving a standard safeguarding modification [@problem_id:2573842], you will learn a critical technique used in robust solvers to ensure global convergence even when far from a stable solution.", "problem": "Consider a one-dimensional nonlinear elastic bar of unit length with left end fixed and right end displacement $u \\in \\mathbb{R}$ as the single degree of freedom after a single linear finite element discretization within the Finite Element Method (FEM). The stored energy density is $\\psi(\\varepsilon)=\\tfrac{1}{4}(\\varepsilon^{2}-1)^{2}$ as a function of the axial strain $\\varepsilon$. With the constant strain approximation $\\varepsilon=u$ on the unit interval, the discrete potential energy is $ \\Pi(u)=\\tfrac{1}{4}(u^{2}-1)^{2}$. In a line-search globalization strategy, take the merit function $M(u)$ to be the potential energy $M(u)=\\Pi(u)$. The gradient is $g(u)=\\Pi'(u)$ and the tangent (Hessian) is $k(u)=\\Pi''(u)$. A direction $p$ is a descent direction for $M$ at $u$ if $g(u)\\,p<0$. The Newton direction $p_{\\mathrm{N}}(u)$ solves $k(u)\\,p_{\\mathrm{N}}(u)=-g(u)$. \n\nWork at the iterate $u^{(k)}=\\tfrac{1}{2}$. Starting only from the definitions above and standard calculus, do the following:\n1) Compute $g(u^{(k)})$, $k(u^{(k)})$, and the Newton direction $p_{\\mathrm{N}}(u^{(k)})$, and verify whether $p_{\\mathrm{N}}(u^{(k)})$ is a descent direction by evaluating $g(u^{(k)})\\,p_{\\mathrm{N}}(u^{(k)})$.\n2) To enforce descent when the tangent is indefinite, consider the safeguarded modified Newton system with a diagonal shift $\\tau \\in \\mathbb{R}$: $(k(u^{(k)})+\\tau)\\,p_{\\tau}(u^{(k)})=-g(u^{(k)})$. Determine the smallest real number $\\tau_{\\star}$ such that for all $\\tau>\\tau_{\\star}$, the direction $p_{\\tau}(u^{(k)})$ is guaranteed to be a descent direction for $M$ at $u^{(k)}$ for any nonzero gradient. Provide $\\tau_{\\star}$ as an exact number. The final answer must be this single value for $\\tau_{\\star}$ (no units).", "solution": "The potential energy of the system is given by\n$$ \\Pi(u) = \\frac{1}{4}(u^2-1)^2 $$\nThe first and second derivatives of the potential energy with respect to the degree of freedom $u$ define the gradient (internal force) $g(u)$ and the tangent (stiffness) $k(u)$, respectively.\n\nThe gradient is computed via the chain rule:\n$$ g(u) = \\Pi'(u) = \\frac{d}{du} \\left[ \\frac{1}{4}(u^2-1)^2 \\right] = \\frac{1}{4} \\cdot 2(u^2-1) \\cdot (2u) = u(u^2-1) = u^3 - u $$\nThe tangent is the derivative of the gradient:\n$$ k(u) = \\Pi''(u) = \\frac{d}{du} \\left[ u^3 - u \\right] = 3u^2 - 1 $$\n\nWe are instructed to analyze the system at the iterate $u^{(k)} = \\frac{1}{2}$.\n\nFirst, we address part (1) of the problem. We evaluate the gradient and tangent at $u^{(k)} = \\frac{1}{2}$:\n$$ g(u^{(k)}) = g\\left(\\frac{1}{2}\\right) = \\left(\\frac{1}{2}\\right)^3 - \\frac{1}{2} = \\frac{1}{8} - \\frac{1}{2} = -\\frac{3}{8} $$\n$$ k(u^{(k)}) = k\\left(\\frac{1}{2}\\right) = 3\\left(\\frac{1}{2}\\right)^2 - 1 = 3\\left(\\frac{1}{4}\\right) - 1 = \\frac{3}{4} - 1 = -\\frac{1}{4} $$\nThe Newton direction $p_{\\mathrm{N}}(u^{(k)})$ is defined by the solution to the linear system $k(u^{(k)}) \\, p_{\\mathrm{N}}(u^{(k)}) = -g(u^{(k)})$. Substituting the computed values:\n$$ \\left(-\\frac{1}{4}\\right) p_{\\mathrm{N}}\\left(\\frac{1}{2}\\right) = - \\left(-\\frac{3}{8}\\right) = \\frac{3}{8} $$\nSolving for $p_{\\mathrm{N}}(\\frac{1}{2})$:\n$$ p_{\\mathrm{N}}\\left(\\frac{1}{2}\\right) = \\frac{3}{8} \\cdot (-4) = -\\frac{12}{8} = -\\frac{3}{2} $$\nTo verify if this is a descent direction for the merit function $M(u) = \\Pi(u)$, we must check if the condition $g(u^{(k)}) \\, p_{\\mathrm{N}}(u^{(k)}) < 0$ is satisfied. We compute this product:\n$$ g\\left(\\frac{1}{2}\\right) \\, p_{\\mathrm{N}}\\left(\\frac{1}{2}\\right) = \\left(-\\frac{3}{8}\\right) \\cdot \\left(-\\frac{3}{2}\\right) = \\frac{9}{16} $$\nSince $\\frac{9}{16} > 0$, the Newton direction $p_{\\mathrm{N}}(u^{(k)})$ is not a descent direction. This is expected, as the tangent stiffness $k(u^{(k)}) = -\\frac{1}{4}$ is negative, indicating that the potential energy surface is concave down at this point. The unmodified Newton step seeks a stationary point, which in this case is a local maximum of the potential.\n\nNext, we address part (2) of the problem. We consider the safeguarded modified Newton system:\n$$ (k(u^{(k)}) + \\tau) \\, p_{\\tau}(u^{(k)}) = -g(u^{(k)}) $$\nThe purpose of the parameter $\\tau$ is to modify the system such that the resulting direction $p_{\\tau}(u^{(k)})$ is a descent direction. From the system definition, we can express the modified direction as:\n$$ p_{\\tau}(u^{(k)}) = - \\frac{g(u^{(k)})}{k(u^{(k)}) + \\tau} $$\nThis expression is valid provided that $k(u^{(k)}) + \\tau \\neq 0$.\n\nThe condition for $p_{\\tau}(u^{(k)})$ to be a descent direction is $g(u^{(k)}) \\, p_{\\tau}(u^{(k)}) < 0$. We substitute the expression for $p_{\\tau}(u^{(k)})$ into this inequality:\n$$ g(u^{(k)}) \\left( - \\frac{g(u^{(k)})}{k(u^{(k)}) + \\tau} \\right) < 0 $$\n$$ - \\frac{[g(u^{(k)})]^2}{k(u^{(k)}) + \\tau} < 0 $$\nThe problem specifies that the gradient is nonzero. For any nonzero real number $g(u^{(k)})$, its square $[g(u^{(k)})]^2$ is strictly positive. Therefore, the numerator $-[g(u^{(k)})]^2$ is strictly negative. For the entire fraction to be negative, the denominator must be strictly positive:\n$$ k(u^{(k)}) + \\tau > 0 $$\nThis condition ensures that the modified tangent, $k(u^{(k)}) + \\tau$, is positive definite (in this one-dimensional case, simply positive). A positive definite modified tangent guarantees a descent direction for any nonzero gradient.\n\nWe now substitute the value of the tangent at the given iterate, $k(u^{(k)}) = -\\frac{1}{4}$:\n$$ -\\frac{1}{4} + \\tau > 0 $$\nSolving for $\\tau$ gives the condition:\n$$ \\tau > \\frac{1}{4} $$\nThe problem asks for the smallest real number $\\tau_{\\star}$ such that for all $\\tau > \\tau_{\\star}$, the direction $p_{\\tau}(u^{(k)})$ is guaranteed to be a descent direction. The derived condition is precisely $\\tau > \\frac{1}{4}$. The value $\\tau_{\\star}$ is therefore the infimum of the set of valid $\\tau$ values, which is the boundary of this interval.\nThus, $\\tau_{\\star} = \\frac{1}{4}$. For any $\\tau > \\tau_{\\star}$, the modified tangent $k(u^{(k)})+\\tau$ will be positive, and a descent direction will be obtained. If $\\tau = \\tau_{\\star}$, the denominator is zero, and the direction is undefined.", "answer": "$$\n\\boxed{\\frac{1}{4}}\n$$", "id": "2573842"}, {"introduction": "Having explored how to secure a descent direction, we now confront a more fundamental question: a descent direction for which objective? This advanced practice investigates a scenario where minimizing the system's potential energy, $\\Pi(\\mathbf{u})$, conflicts with minimizing the force imbalance, measured by the residual norm squared $M(\\mathbf{u}) = \\frac{1}{2}\\|\\mathbf{R}(\\mathbf{u})\\|_{2}^{2}$. This exercise [@problem_id:2573788] is crucial for understanding why modern nonlinear solvers often prioritize reducing the residual, as it more directly represents progress toward achieving mechanical equilibrium, especially in complex stability problems.", "problem": "Consider a nonlinear finite element (FE) equilibrium problem derived from a hyperelastic total potential energy $\\Pi(\\mathbf{u})$, with residual $\\mathbf{R}(\\mathbf{u}) = \\nabla \\Pi(\\mathbf{u})$ and consistent tangent $\\mathbf{K}(\\mathbf{u}) = \\nabla^{2} \\Pi(\\mathbf{u})$. A globalization via line search considers trial states $\\mathbf{u}(\\alpha) = \\mathbf{u}^{k} + \\alpha \\mathbf{p}^{k}$ for $\\alpha \\ge 0$, where the Newton direction $\\mathbf{p}^{k}$ solves $\\mathbf{K}^{k}\\mathbf{p}^{k} = -\\mathbf{R}^{k}$ with $\\mathbf{R}^{k} = \\mathbf{R}(\\mathbf{u}^{k})$ and $\\mathbf{K}^{k} = \\mathbf{K}(\\mathbf{u}^{k})$. Two acceptance criteria are commonly used: decrease of the energy $\\Pi$ and decrease of a residual-based merit function $M(\\alpha) = \\tfrac{1}{2}\\|\\mathbf{R}(\\mathbf{u}(\\alpha))\\|_{2}^{2}$.\n\nAssume a local quadratic model is exact around $\\mathbf{u}^{k}$, so that for any increment $\\mathbf{s}$ one has $\\Pi(\\mathbf{u}^{k}+\\mathbf{s}) = \\Pi(\\mathbf{u}^{k}) + \\mathbf{R}^{k\\top}\\mathbf{s} + \\tfrac{1}{2}\\mathbf{s}^{\\top}\\mathbf{K}^{k}\\mathbf{s}$ and $\\mathbf{R}(\\mathbf{u}^{k}+\\mathbf{s}) = \\mathbf{R}^{k} + \\mathbf{K}^{k}\\mathbf{s}$. At the current iterate, let\n- $\\mathbf{R}^{k} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$,\n- $\\mathbf{K}^{k} = \\mathrm{diag}(1,-1)$.\n\nUsing the exact Newton direction $\\mathbf{p}^{k} = -(\\mathbf{K}^{k})^{-1}\\mathbf{R}^{k}$ and the line $\\mathbf{u}(\\alpha) = \\mathbf{u}^{k} + \\alpha \\mathbf{p}^{k}$:\n\n- Derive explicit expressions for $\\Delta \\Pi(\\alpha) := \\Pi(\\mathbf{u}(\\alpha)) - \\Pi(\\mathbf{u}^{k})$ and $M(\\alpha) := \\tfrac{1}{2}\\|\\mathbf{R}(\\mathbf{u}(\\alpha))\\|_{2}^{2}$ as functions of $\\alpha$.\n- Prove that there exists a nonempty interval of $\\alpha$ for which $\\Delta \\Pi(\\alpha)$ is strictly positive while $M(\\alpha)$ is strictly decreasing, thereby demonstrating that a residual-merit line search will accept steps that an energy-decrease line search would reject.\n- Compute the smallest positive step length $\\alpha$ such that $\\Pi(\\mathbf{u}(\\alpha)) = \\Pi(\\mathbf{u}^{k})$. Report this value as your final answer (dimensionless).\n- Based on your derivation, give a concise argument about which acceptance criterion (energy decrease versus residual-merit decrease) more directly reflects convergence to equilibrium in FE.\n\nYour final reported answer must be the single value of the smallest positive $\\alpha$ for which $\\Pi(\\mathbf{u}(\\alpha)) = \\Pi(\\mathbf{u}^{k})$. No rounding is required.", "solution": "The first task is to compute the Newton direction $\\mathbf{p}^{k}$. Given $\\mathbf{K}^{k}\\mathbf{p}^{k} = -\\mathbf{R}^{k}$, we solve for $\\mathbf{p}^{k}$:\n$$\n\\mathbf{p}^{k} = -(\\mathbf{K}^{k})^{-1}\\mathbf{R}^{k}\n$$\nThe tangent matrix is $\\mathbf{K}^{k} = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$. Its inverse is $(\\mathbf{K}^{k})^{-1} = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$, which is identical to $\\mathbf{K}^{k}$.\nWith $\\mathbf{R}^{k} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$, the direction is:\n$$\n\\mathbf{p}^{k} = - \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = - \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}\n$$\n\nNext, we derive the expression for the change in potential energy, $\\Delta \\Pi(\\alpha) = \\Pi(\\mathbf{u}(\\alpha)) - \\Pi(\\mathbf{u}^{k})$.\nUsing the provided quadratic model with the increment $\\mathbf{s} = \\alpha \\mathbf{p}^{k}$:\n$$\n\\Delta \\Pi(\\alpha) = \\mathbf{R}^{k\\top}(\\alpha \\mathbf{p}^{k}) + \\frac{1}{2}(\\alpha \\mathbf{p}^{k})^{\\top}\\mathbf{K}^{k}(\\alpha \\mathbf{p}^{k}) = \\alpha (\\mathbf{R}^{k\\top}\\mathbf{p}^{k}) + \\frac{1}{2}\\alpha^{2} (\\mathbf{p}^{k\\top}\\mathbf{K}^{k}\\mathbf{p}^{k})\n$$\nWe compute the scalar products:\nThe directional derivative of $\\Pi$ along $\\mathbf{p}^{k}$ at $\\mathbf{u}^k$ is $\\mathbf{R}^{k\\top}\\mathbf{p}^{k}$:\n$$\n\\mathbf{R}^{k\\top}\\mathbf{p}^{k} = \\begin{pmatrix} 1 & 2 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix} = (1)(-1) + (2)(2) = -1 + 4 = 3\n$$\nThe quadratic term is $\\mathbf{p}^{k\\top}\\mathbf{K}^{k}\\mathbf{p}^{k}$. Using the definition $\\mathbf{K}^{k}\\mathbf{p}^{k} = -\\mathbf{R}^{k}$:\n$$\n\\mathbf{p}^{k\\top}\\mathbf{K}^{k}\\mathbf{p}^{k} = \\mathbf{p}^{k\\top}(-\\mathbf{R}^{k}) = -(\\mathbf{p}^{k\\top}\\mathbf{R}^{k}) = -(\\mathbf{R}^{k\\top}\\mathbf{p}^{k}) = -3\n$$\nSubstituting these values back into the expression for $\\Delta \\Pi(\\alpha)$:\n$$\n\\Delta \\Pi(\\alpha) = 3\\alpha - \\frac{3}{2}\\alpha^{2}\n$$\nSince the directional derivative $\\mathbf{R}^{k\\top}\\mathbf{p}^{k} = 3 > 0$, the Newton direction $\\mathbf{p}^{k}$ is an ascent direction for the potential energy $\\Pi$.\n\nNext, we derive the expression for the residual-based merit function $M(\\alpha) = \\frac{1}{2}\\|\\mathbf{R}(\\mathbf{u}(\\alpha))\\|_{2}^{2}$.\nUsing the exact linear model for the residual with $\\mathbf{s} = \\alpha \\mathbf{p}^{k}$:\n$$\n\\mathbf{R}(\\mathbf{u}(\\alpha)) = \\mathbf{R}(\\mathbf{u}^{k} + \\alpha\\mathbf{p}^{k}) = \\mathbf{R}^{k} + \\alpha \\mathbf{K}^{k}\\mathbf{p}^{k}\n$$\nSubstituting $\\mathbf{K}^{k}\\mathbf{p}^{k} = -\\mathbf{R}^{k}$:\n$$\n\\mathbf{R}(\\mathbf{u}(\\alpha)) = \\mathbf{R}^{k} + \\alpha(-\\mathbf{R}^{k}) = (1-\\alpha)\\mathbf{R}^{k}\n$$\nNow we compute the merit function:\n$$\nM(\\alpha) = \\frac{1}{2}\\|(1-\\alpha)\\mathbf{R}^{k}\\|_{2}^{2} = \\frac{1}{2}(1-\\alpha)^{2}\\|\\mathbf{R}^{k}\\|_{2}^{2}\n$$\nWe calculate the squared norm of the initial residual: $\\|\\mathbf{R}^{k}\\|_{2}^{2} = 1^{2} + 2^{2} = 5$.\nThus, the merit function is:\n$$\nM(\\alpha) = \\frac{5}{2}(1-\\alpha)^{2}\n$$\n\nNow we must demonstrate that there exists a nonempty interval of $\\alpha$ where $\\Delta \\Pi(\\alpha) > 0$ while $M(\\alpha)$ is strictly decreasing.\nThe condition $\\Delta \\Pi(\\alpha) > 0$ becomes $3\\alpha - \\frac{3}{2}\\alpha^{2} > 0$, which simplifies to $\\frac{3}{2}\\alpha(2-\\alpha) > 0$. For $\\alpha > 0$, this requires $2-\\alpha > 0$, so $\\alpha \\in (0, 2)$.\nFor $M(\\alpha)$ to be strictly decreasing, its derivative with respect to $\\alpha$ must be negative.\n$$\n\\frac{dM}{d\\alpha} = \\frac{d}{d\\alpha}\\left(\\frac{5}{2}(1-\\alpha)^{2}\\right) = \\frac{5}{2} \\cdot 2(1-\\alpha)(-1) = -5(1-\\alpha)\n$$\nThe condition $\\frac{dM}{d\\alpha} < 0$ implies $-5(1-\\alpha) < 0$, which means $1-\\alpha > 0$, or $\\alpha < 1$.\nThe intersection of the two conditions, $\\alpha \\in (0, 2)$ and $\\alpha < 1$, is the interval $\\alpha \\in (0, 1)$. For any $\\alpha$ in this interval, the energy increases ($\\Delta\\Pi > 0$), so an energy-based line search would reject the step. However, the residual-based merit function decreases, so a line search based on $M(\\alpha)$ would accept such a step. This proves the assertion.\n\nWe are asked to compute the smallest positive step length $\\alpha$ for which the potential energy returns to its initial value, i.e., $\\Pi(\\mathbf{u}(\\alpha)) = \\Pi(\\mathbf{u}^{k})$, which is equivalent to $\\Delta \\Pi(\\alpha) = 0$.\n$$\n3\\alpha - \\frac{3}{2}\\alpha^{2} = 0\n$$\n$$\n\\alpha\\left(3 - \\frac{3}{2}\\alpha\\right) = 0\n$$\nThis equation has two solutions: $\\alpha = 0$ (the trivial starting point) and $3 - \\frac{3}{2}\\alpha = 0$.\nSolving for the non-trivial $\\alpha$:\n$$\n3 = \\frac{3}{2}\\alpha \\implies \\alpha = 2\n$$\nThe smallest positive step length is therefore $\\alpha = 2$.\n\nFinally, a concise argument on the more appropriate acceptance criterion. The fundamental goal in an FE equilibrium analysis is to find the state $\\mathbf{u}^{*}$ for which the internal and external forces are balanced, which is mathematically expressed as the residual vector being zero: $\\mathbf{R}(\\mathbf{u}^{*}) = \\mathbf{0}$. The residual-based merit function $M(\\mathbf{u}) = \\frac{1}{2}\\|\\mathbf{R}(\\mathbf{u})\\|_{2}^{2}$ is constructed specifically to measure progress towards this goal, as $M(\\mathbf{u}) \\ge 0$ and $M(\\mathbf{u}) = 0$ if and only if $\\mathbf{R}(\\mathbf{u}) = \\mathbf{0}$. Therefore, a line search that ensures a decrease in $M$ is directly convergent towards an equilibrium state. In contrast, an energy-decrease criterion seeks a local minimum of the potential energy $\\Pi$. While stable equilibrium points are local minima, equilibrium can also occur at saddle points or local maxima, especially in problems involving instability and path-following. As demonstrated in this problem, when the tangent stiffness $\\mathbf{K}^{k}$ is indefinite, the Newton direction may be an ascent direction for energy, causing an energy-based line search to fail. The residual-merit criterion, however, remains effective and allows the algorithm to progress towards the solution where $\\mathbf{R}=\\mathbf{0}$ (at $\\alpha=1$ in this case). Consequently, the residual-merit criterion is more robust and directly reflects the primary goal of finding any equilibrium state, stable or not.", "answer": "$$\n\\boxed{2}\n$$", "id": "2573788"}]}