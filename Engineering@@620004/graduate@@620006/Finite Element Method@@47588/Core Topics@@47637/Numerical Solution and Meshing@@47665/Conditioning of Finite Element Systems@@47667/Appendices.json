{"hands_on_practices": [{"introduction": "This first practice delves into the heart of finite element conditioning by analyzing its most fundamental case: the one-dimensional Poisson equation on a uniform mesh. By deriving the exact eigenvalues of the underlying discrete Laplacian, you will uncover the famous $O(h^{-2})$ scaling relationship for the stiffness matrix condition number. This exercise provides a crucial theoretical foundation, explaining why refining a mesh inherently leads to a more ill-conditioned linear system and motivating the need for advanced solvers and preconditioners. [@problem_id:2546526]", "problem": "Consider the simple path graph on a one-dimensional chain with homogeneous Dirichlet boundary conditions at its two endpoints. Let $n \\in \\mathbb{N}$ denote the number of interior vertices (equivalently, unknowns). The resulting graph Laplacian restricted to the interior is the $n \\times n$ symmetric tridiagonal matrix $T_{n}$ with entries $2$ on the diagonal and $-1$ on the first sub- and super-diagonals, and zeros elsewhere. For a symmetric positive definite (SPD) matrix $A$, the spectral condition number in the spectral norm is defined by $\\kappa_{2}(A) = \\lambda_{\\max}(A)/\\lambda_{\\min}(A)$, where $\\lambda_{\\max}(A)$ and $\\lambda_{\\min}(A)$ are the largest and smallest eigenvalues of $A$, respectively.\n\nSeparately, consider the one-dimensional Poisson boundary value problem $-u'' = f$ on the interval $(0,1)$ with $u(0)=u(1)=0$. Discretize it by the finite element method (FEM) using continuous, piecewise-linear basis functions on a uniform mesh of $N$ elements, so the mesh size is $h = 1/N$ and the number of interior degrees of freedom is $n = N-1$. The stiffness matrix $K_{h}$ is defined by entries $K_{h,ij} = \\int_{0}^{1} \\varphi_{i}'(x)\\,\\varphi_{j}'(x)\\,\\mathrm{d}x$, where $\\{\\varphi_{i}\\}_{i=1}^{n}$ are the nodal basis functions associated with the interior nodes.\n\nStarting from the eigenvalue problem for $T_{n}$ and enforcing the homogeneous Dirichlet boundary conditions underlying the path graph interior reduction, derive the exact expression for $\\kappa_{2}(T_{n})$ as a function of $n$. Using only foundational properties of the FEM stiffness matrix on a uniform mesh, relate $K_{h}$ to $T_{n}$, and use this relation to infer the asymptotic scaling of $\\kappa_{2}(K_{h})$ in terms of $n$ and in terms of $h$.\n\nProvide as your final answer a single, closed-form analytic expression for $\\kappa_{2}(T_{n})$ in terms of $n$. No numerical rounding is required, and do not include units in the final answer.", "solution": "We begin with the $n \\times n$ tridiagonal matrix $T_{n}$ whose entries are\n$$\n(T_{n})_{ii} = 2,\\quad (T_{n})_{i,i+1} = (T_{n})_{i+1,i} = -1,\\quad \\text{for } i=1,\\dots,n-1,\n$$\nand zero otherwise. This matrix is the reduced graph Laplacian obtained by eliminating the two boundary nodes of a path graph with homogeneous Dirichlet boundary conditions; it is symmetric positive definite (SPD).\n\nThe eigenvalue problem $T_{n} v = \\lambda v$ in components reads\n$$\n- v_{i-1} + 2 v_{i} - v_{i+1} = \\lambda v_{i}, \\quad i=1,\\dots,n,\n$$\nwith homogeneous Dirichlet boundary conditions implicitly enforced by $v_{0} = 0$ and $v_{n+1} = 0$. This is a constant-coefficient linear recurrence with boundary conditions. A standard approach is to use the trial form\n$$\nv_{i} = \\sin(i \\theta),\n$$\nwhich already satisfies $v_{0} = \\sin(0) = 0$. Substituting into the recurrence yields\n$$\n- \\sin((i-1)\\theta) + 2 \\sin(i\\theta) - \\sin((i+1)\\theta) = \\lambda \\sin(i\\theta).\n$$\nUsing the trigonometric identities\n$$\n\\sin((i+1)\\theta) + \\sin((i-1)\\theta) = 2 \\sin(i\\theta) \\cos(\\theta),\n$$\nwe obtain\n$$\n- \\left[2 \\sin(i\\theta) \\cos(\\theta)\\right] + 2 \\sin(i\\theta) = \\lambda \\sin(i\\theta).\n$$\nFor nontrivial eigenvectors, $\\sin(i\\theta) \\neq 0$ for some $i$, so we can divide by $\\sin(i\\theta)$ to get\n$$\n- 2 \\cos(\\theta) + 2 = \\lambda.\n$$\nThus the eigenvalues are parameterized by\n$$\n\\lambda(\\theta) = 2 - 2 \\cos(\\theta).\n$$\nThe remaining boundary condition $v_{n+1} = \\sin((n+1)\\theta) = 0$ enforces that\n$$\n(n+1)\\theta = k \\pi, \\quad k \\in \\mathbb{Z}.\n$$\nExcluding the trivial solution where the eigenvector vanishes identically, we take $k = 1,2,\\dots,n$, yielding\n$$\n\\theta_{k} = \\frac{k \\pi}{n+1}, \\quad k=1,2,\\dots,n.\n$$\nTherefore, the $n$ positive eigenvalues are\n$$\n\\lambda_{k} = 2 - 2 \\cos\\!\\left(\\frac{k \\pi}{n+1}\\right) = 4 \\sin^{2}\\!\\left(\\frac{k \\pi}{2(n+1)}\\right), \\quad k=1,2,\\dots,n.\n$$\nFrom this sequence, the smallest eigenvalue is\n$$\n\\lambda_{\\min} = \\lambda_{1} = 4 \\sin^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right),\n$$\nand the largest eigenvalue is\n$$\n\\lambda_{\\max} = \\lambda_{n} = 4 \\sin^{2}\\!\\left(\\frac{n \\pi}{2(n+1)}\\right).\n$$\nUsing the identity $\\sin\\!\\left(\\frac{n \\pi}{2(n+1)}\\right) = \\cos\\!\\left(\\frac{\\pi}{2(n+1)}\\right)$, we obtain\n$$\n\\lambda_{\\max} = 4 \\cos^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right).\n$$\nHence, the spectral condition number in the spectral norm is\n$$\n\\kappa_{2}(T_{n}) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{4 \\cos^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right)}{4 \\sin^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\cot^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right).\n$$\n\nWe now relate this to the one-dimensional finite element method (FEM) stiffness matrix on a uniform mesh. Consider $-u'' = f$ on $(0,1)$ with $u(0)=u(1)=0$, discretized using continuous, piecewise-linear basis functions on a uniform mesh of $N$ elements of size $h = 1/N$. There are $n = N-1$ interior nodes and hence $n$ basis functions $\\{\\varphi_{i}\\}_{i=1}^{n}$. On a uniform mesh with linear elements, the gradient of each basis function $\\varphi_{i}'$ is piecewise constant and the only nonzero element stiffness contributions come from nearest-neighbor interactions. A standard assembly calculation yields the global stiffness matrix\n$$\nK_{h} = \\frac{1}{h} \\, T_{n},\n$$\nwhere $T_{n}$ is exactly the tridiagonal matrix defined above. Since $K_{h}$ is a positive scalar multiple of $T_{n}$, they have the same set of eigenvectors and their eigenvalues are related by a uniform scaling:\n$$\n\\mu_{k}(K_{h}) = \\frac{1}{h} \\, \\lambda_{k}(T_{n}), \\quad k=1,\\dots,n.\n$$\nTherefore, the spectral condition number is invariant under positive scalar multiplication, giving\n$$\n\\kappa_{2}(K_{h}) = \\kappa_{2}(T_{n}) = \\cot^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right).\n$$\nTo extract the scaling with $n$ and $h$, use the small-angle expansion $\\cot(x) \\sim \\frac{1}{x}$ as $x \\to 0$. Here,\n$$\n\\frac{\\pi}{2(n+1)} \\to 0 \\quad \\text{as } n \\to \\infty,\n$$\nso\n$$\n\\kappa_{2}(T_{n}) = \\cot^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right) \\sim \\left(\\frac{2(n+1)}{\\pi}\\right)^{2} \\quad \\text{as } n \\to \\infty.\n$$\nSince $n = N-1$ and $h = 1/N$, we have $n+1 = N = 1/h$, and thus\n$$\n\\kappa_{2}(K_{h}) \\sim \\left(\\frac{2}{\\pi}\\right)^{2} \\frac{1}{h^{2}} \\quad \\text{as } h \\to 0,\n$$\nwhich recovers the well-known $O(h^{-2})$ scaling of the spectral condition number for the one-dimensional finite element stiffness matrix on a uniform mesh.\n\nTherefore, the exact closed-form expression for the condition number of the path graph Dirichlet Laplacian $T_{n}$ is $\\cot^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right)$, and it matches the finite element method stiffness matrix scaling both exactly (by equality) and asymptotically (as $O(n^{2})$ or $O(h^{-2})$ as the mesh is refined).", "answer": "$$\\boxed{\\cot^{2}\\!\\left(\\frac{\\pi}{2(n+1)}\\right)}$$", "id": "2546526"}, {"introduction": "Building upon the ideal uniform mesh, this exercise explores the practical impact of mesh quality on system conditioning. Using a simple graded mesh, you will assemble the stiffness matrix and observe how element size variation affects its properties. This hands-on problem demonstrates two common diagonal scaling (equilibration) strategies, allowing you to quantify their effectiveness and appreciate how simple preconditioning can significantly improve the condition number of a matrix arising from a real-world discretization. [@problem_id:2546522]", "problem": "Consider the one-dimensional Poisson model problem $-u'' = f$ on a bounded interval with homogeneous Dirichlet boundary conditions at both endpoints. Discretize using the Finite Element Method (FEM) with continuous, piecewise-linear basis functions over a three-element graded mesh with element lengths $h_1$, $h_2$, $h_3$ in geometric progression with fixed ratio $r>0$, i.e., $h_2 = r h_1$ and $h_3 = r h_2$. Impose the two Dirichlet conditions at the interval endpoints so that there are exactly two interior nodes and the global stiffness matrix $K \\in \\mathbb{R}^{2 \\times 2}$ is symmetric positive definite. You may take $h_1 = 1$ without loss of generality, and you should work at the exact arithmetic level (no rounding).\n\nDefine the following two diagonal equilibration strategies for the stiffness matrix $K$:\n- Row-sum symmetric equilibration: choose a diagonal scaling $S_{\\mathrm{row}} = \\mathrm{diag}(s_1,s_2)$ with $s_i>0$ such that every row sum of absolute values of the symmetrically scaled matrix $S_{\\mathrm{row}} K S_{\\mathrm{row}}$ equals $1$.\n- Geometric-mean (unit-diagonal/Jacobi) equilibration: choose a diagonal scaling $S_{\\mathrm{geo}} = \\mathrm{diag}\\!\\big(1/\\sqrt{K_{11}},\\,1/\\sqrt{K_{22}}\\big)$, which makes the diagonal of $S_{\\mathrm{geo}} K S_{\\mathrm{geo}}$ equal to $1$.\n\nStarting from the canonical FEM bilinear form and its element-level contributions, assemble $K$ explicitly for this three-element graded mesh. Then, using the definition of the spectral condition number (matrix $2$-norm condition number) $\\kappa_2(K) = \\lambda_{\\max}(K)/\\lambda_{\\min}(K)$ for a symmetric positive definite matrix $K$, compute closed-form expressions (in terms of $r$) for each of the following three quantities:\n- $\\kappa_2(K)$ for the unscaled matrix,\n- $\\kappa_2\\!\\big(S_{\\mathrm{row}} K S_{\\mathrm{row}}\\big)$ after row-sum symmetric equilibration,\n- $\\kappa_2\\!\\big(S_{\\mathrm{geo}} K S_{\\mathrm{geo}}\\big)$ after geometric-mean equilibration.\n\nExpress your final answer as a single row matrix containing these three expressions in the order listed above. No numerical rounding is required, and no physical units are involved.", "solution": "The problem is the one-dimensional Poisson equation $-u'' = f$ with homogeneous Dirichlet boundary conditions. The weak formulation leads to the bilinear form $a(u,v) = \\int_{\\Omega} u' v' dx$. For continuous, piecewise-linear basis functions $\\phi_i(x)$, the entries of the stiffness matrix are $K_{ij} = a(\\phi_j, \\phi_i)$.\n\nA standard one-dimensional linear finite element of length $h$ has a local stiffness matrix given by\n$$ k_e = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\nThe global stiffness matrix is assembled by summing the contributions from each element. We have a mesh with three elements of lengths $h_1$, $h_2$, and $h_3$. There are two interior nodes, denoted $1$ and $2$, between the Dirichlet boundaries. The global stiffness matrix for the interior nodes is $K \\in \\mathbb{R}^{2 \\times 2}$.\n\nThe first interior node is connected by element $1$ (length $h_1$) and element $2$ (length $h_2$). The second interior node is connected by element $2$ (length $h_2$) and element $3$ (length $h_3$). The assembly process yields:\n$K_{11}$ is the sum of diagonal entries from element $1$ and element $2$: $K_{11} = \\frac{1}{h_1} + \\frac{1}{h_2}$.\n$K_{22}$ is the sum of diagonal entries from element $2$ and element $3$: $K_{22} = \\frac{1}{h_2} + \\frac{1}{h_3}$.\n$K_{12} = K_{21}$ is the off-diagonal contribution from the shared element $2$: $K_{12} = -\\frac{1}{h_2}$.\n\nThus, the stiffness matrix is:\n$$ K = \\begin{pmatrix} \\frac{1}{h_1} + \\frac{1}{h_2} & -\\frac{1}{h_2} \\\\ -\\frac{1}{h_2} & \\frac{1}{h_2} + \\frac{1}{h_3} \\end{pmatrix} $$\nThe problem specifies a graded mesh with $h_1=1$, $h_2=r h_1 = r$, and $h_3=r h_2 = r^2$, for a given ratio $r>0$. Substituting these values:\n$$ K = \\begin{pmatrix} \\frac{1}{1} + \\frac{1}{r} & -\\frac{1}{r} \\\\ -\\frac{1}{r} & \\frac{1}{r} + \\frac{1}{r^2} \\end{pmatrix} = \\begin{pmatrix} \\frac{r+1}{r} & -\\frac{1}{r} \\\\ -\\frac{1}{r} & \\frac{r+1}{r^2} \\end{pmatrix} $$\n\n1.  Condition number of the unscaled matrix $K$: $\\kappa_2(K)$.\n    The eigenvalues $\\lambda$ of a $2 \\times 2$ symmetric matrix $\\begin{pmatrix} a & c \\\\ c & b \\end{pmatrix}$ are given by $\\lambda = \\frac{a+b \\pm \\sqrt{(a-b)^2 + 4c^2}}{2}$.\n    For our matrix $K$:\n    $a = \\frac{r+1}{r}$, $b = \\frac{r+1}{r^2}$, $c = -\\frac{1}{r}$.\n    $a+b = \\frac{r(r+1) + (r+1)}{r^2} = \\frac{(r+1)^2}{r^2}$.\n    $a-b = \\frac{r(r+1) - (r+1)}{r^2} = \\frac{(r-1)(r+1)}{r^2} = \\frac{r^2-1}{r^2}$.\n    The term under the square root is\n    $(a-b)^2 + 4c^2 = \\left(\\frac{r^2-1}{r^2}\\right)^2 + 4\\left(-\\frac{1}{r}\\right)^2 = \\frac{r^4 - 2r^2 + 1}{r^4} + \\frac{4}{r^2} = \\frac{r^4 + 2r^2 + 1}{r^4} = \\left(\\frac{r^2+1}{r^2}\\right)^2$.\n    The eigenvalues are:\n    $$ \\lambda = \\frac{1}{2} \\left[ \\frac{(r+1)^2}{r^2} \\pm \\frac{r^2+1}{r^2} \\right] $$\n    $\\lambda_{\\max} = \\frac{1}{2r^2} \\left( (r^2+2r+1) + (r^2+1) \\right) = \\frac{2r^2+2r+2}{2r^2} = \\frac{r^2+r+1}{r^2}$.\n    $\\lambda_{\\min} = \\frac{1}{2r^2} \\left( (r^2+2r+1) - (r^2+1) \\right) = \\frac{2r}{2r^2} = \\frac{1}{r}$.\n    The condition number is the ratio of the largest to the smallest eigenvalue:\n    $$ \\kappa_2(K) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{(r^2+r+1)/r^2}{1/r} = \\frac{r^2+r+1}{r} $$\n\n2.  Condition number after row-sum symmetric equilibration, $\\kappa_2(S_{\\mathrm{row}} K S_{\\mathrm{row}})$.\n    Let $\\hat{K}_{\\mathrm{row}} = S_{\\mathrm{row}} K S_{\\mathrm{row}}$ with $S_{\\mathrm{row}} = \\mathrm{diag}(s_1, s_2)$. The condition $\\sum_j |\\hat{K}_{\\mathrm{row}, ij}| = 1$ for $i=1,2$ implies:\n    $s_1^2 K_{11} + s_1 s_2 |K_{12}| = 1$\n    $s_2 s_1 |K_{12}| + s_2^2 K_{22} = 1$\n    This immediately implies $s_1^2 K_{11} = s_2^2 K_{22}$, so the diagonal entries of $\\hat{K}_{\\mathrm{row}}$ are equal. Let this common value be $\\alpha$. Then $\\hat{K}_{\\mathrm{row}} = \\begin{pmatrix} \\alpha & \\beta \\\\ \\beta & \\alpha \\end{pmatrix}$ where $\\beta = s_1 s_2 K_{12}$.\n    The row-sum condition becomes $\\alpha + |\\beta| = 1$. The eigenvalues of $\\hat{K}_{\\mathrm{row}}$ are $\\alpha+\\beta$ and $\\alpha-\\beta$. The condition number is $\\kappa_2(\\hat{K}_{\\mathrm{row}}) = \\frac{\\alpha+|\\beta|}{\\alpha-|\\beta|} = \\frac{1}{\\alpha-|\\beta|}$.\n    We have $s_1/s_2 = \\sqrt{K_{22}/K_{11}} = \\sqrt{((r+1)/r^2)/((r+1)/r)} = 1/\\sqrt{r}$. So $s_2 = s_1 \\sqrt{r}$.\n    Substitute into the first equation: $s_1^2 K_{11} + s_1 (s_1\\sqrt{r}) |K_{12}| = 1$.\n    With $K_{11}=\\frac{r+1}{r}$ and $|K_{12}|=\\frac{1}{r}$, we get $s_1^2 \\left( \\frac{r+1}{r} + \\frac{\\sqrt{r}}{r} \\right) = 1$, which gives $s_1^2 = \\frac{r}{r+\\sqrt{r}+1}$.\n    $\\alpha = s_1^2 K_{11} = \\frac{r}{r+\\sqrt{r}+1} \\cdot \\frac{r+1}{r} = \\frac{r+1}{r+\\sqrt{r}+1}$.\n    $|\\beta| = s_1 s_2 |K_{12}| = s_1^2 \\sqrt{r} |K_{12}| = \\frac{r}{r+\\sqrt{r}+1} \\cdot \\sqrt{r} \\cdot \\frac{1}{r} = \\frac{\\sqrt{r}}{r+\\sqrt{r}+1}$.\n    $\\alpha-|\\beta| = \\frac{r+1}{r+\\sqrt{r}+1} - \\frac{\\sqrt{r}}{r+\\sqrt{r}+1} = \\frac{r-\\sqrt{r}+1}{r+\\sqrt{r}+1}$.\n    The condition number is:\n    $$ \\kappa_2(S_{\\mathrm{row}} K S_{\\mathrm{row}}) = \\frac{1}{\\alpha-|\\beta|} = \\frac{r+\\sqrt{r}+1}{r-\\sqrt{r}+1} $$\n\n3.  Condition number after geometric-mean equilibration, $\\kappa_2(S_{\\mathrm{geo}} K S_{\\mathrm{geo}})$.\n    The scaling is $S_{\\mathrm{geo}} = \\mathrm{diag}(1/\\sqrt{K_{11}}, 1/\\sqrt{K_{22}})$. The scaled matrix $\\hat{K}_{\\mathrm{geo}} = S_{\\mathrm{geo}} K S_{\\mathrm{geo}}$ has unit diagonal entries.\n    $$ \\hat{K}_{\\mathrm{geo}} = \\begin{pmatrix} 1 & \\frac{K_{12}}{\\sqrt{K_{11}K_{22}}} \\\\ \\frac{K_{21}}{\\sqrt{K_{11}K_{22}}} & 1 \\end{pmatrix} $$\n    Let the off-diagonal term be $\\rho = \\frac{K_{12}}{\\sqrt{K_{11}K_{22}}}$.\n    $K_{11}K_{22} = \\left(\\frac{r+1}{r}\\right)\\left(\\frac{r+1}{r^2}\\right) = \\frac{(r+1)^2}{r^3}$.\n    $\\rho = \\frac{-1/r}{\\sqrt{(r+1)^2/r^3}} = \\frac{-1/r}{(r+1)/r^{3/2}} = -\\frac{r^{3/2}}{r(r+1)} = -\\frac{\\sqrt{r}}{r+1}$.\n    The eigenvalues of $\\begin{pmatrix} 1 & \\rho \\\\ \\rho & 1 \\end{pmatrix}$ are $1+\\rho$ and $1-\\rho$.\n    Since $r>0$, $\\rho$ is negative, so $1-\\rho > 1+\\rho$.\n    $\\lambda_{\\max} = 1-\\rho = 1 + \\frac{\\sqrt{r}}{r+1} = \\frac{r+1+\\sqrt{r}}{r+1}$.\n    $\\lambda_{\\min} = 1+\\rho = 1 - \\frac{\\sqrt{r}}{r+1} = \\frac{r+1-\\sqrt{r}}{r+1}$.\n    These eigenvalues are positive since $r-\\sqrt{r}+1 > 0$ for all $r>0$. The condition number is:\n    $$ \\kappa_2(S_{\\mathrm{geo}} K S_{\\mathrm{geo}}) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{(r+1+\\sqrt{r})/(r+1)}{(r+1-\\sqrt{r})/(r+1)} = \\frac{r+\\sqrt{r}+1}{r-\\sqrt{r}+1} $$\n    The result is identical to that of row-sum symmetric equilibration, a known property for $2 \\times 2$ symmetric positive definite matrices.\n\nThe three requested quantities are assembled into a single row matrix.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{r^{2}+r+1}{r} & \\frac{r+\\sqrt{r}+1}{r-\\sqrt{r}+1} & \\frac{r+\\sqrt{r}+1}{r-\\sqrt{r}+1}\n\\end{pmatrix}\n}\n$$", "id": "2546522"}, {"introduction": "Our focus now expands from static problems to the dynamics of time-dependent systems, such as heat diffusion. This practice examines the conditioning of the linear system that must be solved at each time step when using an implicit method like backward Euler. By analyzing the system matrix in the limits of very small and very large time steps, you will gain insight into how the problem's character shifts between being dominated by the mass matrix and the stiffness matrix, a critical concept for solver selection in transient analysis. [@problem_id:2546532]", "problem": "Consider the initial-value problem for a scalar diffusion equation on the interval $\\Omega=(0,1)$ with homogeneous Dirichlet boundary conditions:\n$$\nu_t - u_{xx} = f \\quad \\text{in } (0,1)\\times(0,T], \\qquad u(0,t)=u(1,t)=0, \\qquad u(x,0)=u_0(x).\n$$\nDiscretize in time by backward Euler with time step $\\Delta t>0$, and in space by the standard conforming finite element method using continuous, piecewise linear basis functions on a uniform mesh with $n$ interior nodes and mesh size $h = \\frac{1}{n+1}$. Denote by $M\\in\\mathbb{R}^{n\\times n}$ and $K\\in\\mathbb{R}^{n\\times n}$ the consistent mass and stiffness matrices assembled from the bilinear forms\n$$\nm(u_h,v_h)=\\int_0^1 u_h v_h\\,dx, \\qquad a(u_h,v_h)=\\int_0^1 u_h' v_h'\\,dx.\n$$\nThe fully discrete linear system at each time step takes the form\n$$\nA(\\Delta t)\\, \\mathbf{u}^{k+1} = \\mathbf{b}^k, \\qquad \\text{with } A(\\Delta t)=M+\\Delta t\\,K,\n$$\nwhere $\\mathbf{u}^{k+1}\\in\\mathbb{R}^n$ collects the nodal coefficients of the finite element solution at time level $k+1$. Let $\\kappa_2(\\cdot)$ denote the spectral condition number in the Euclidean $2$-norm.\n\nUsing only fundamental definitions and well-tested properties of the assembled matrices on a uniform mesh, derive the exact closed-form expressions (as functions of $n$) for the two limits\n$$\n\\lim_{\\Delta t\\to 0} \\kappa_2\\big(A(\\Delta t)\\big) \\quad \\text{and} \\quad \\lim_{\\Delta t\\to \\infty} \\kappa_2\\big(A(\\Delta t)\\big).\n$$\nExpress your final answer as two explicit analytic expressions involving only $n$ and elementary functions. Your answer must consist of the two expressions in a single row, in the order $\\left(\\lim_{\\Delta t\\to 0}\\kappa_2(A(\\Delta t)),\\ \\lim_{\\Delta t\\to \\infty}\\kappa_2(A(\\Delta t))\\right)$. No numerical evaluation or rounding is required.", "solution": "The matrix $A(\\Delta t) = M + \\Delta t K$ is symmetric. The mass matrix $M$ and stiffness matrix $K$ are known to be symmetric positive definite for this problem. As $\\Delta t > 0$, the matrix $A(\\Delta t)$ is also symmetric positive definite. The spectral condition number is therefore given by the ratio of its largest to its smallest eigenvalue:\n$$\n\\kappa_2(A(\\Delta t)) = \\frac{\\lambda_{\\max}(A(\\Delta t))}{\\lambda_{\\min}(A(\\Delta t))}\n$$\nFor a uniform mesh with size $h = \\frac{1}{n+1}$ and continuous piecewise linear basis functions, the consistent mass matrix $M \\in \\mathbb{R}^{n \\times n}$ and stiffness matrix $K \\in \\mathbb{R}^{n \\times n}$ are given by:\n$$\nM = \\frac{h}{6} \n\\begin{pmatrix}\n4 & 1 & 0 & \\dots & 0 \\\\\n1 & 4 & 1 & \\dots & 0 \\\\\n0 & \\ddots & \\ddots & \\ddots & 0 \\\\\n0 & \\dots & 1 & 4 & 1 \\\\\n0 & \\dots & 0 & 1 & 4\n\\end{pmatrix},\n\\quad\nK = \\frac{1}{h} \n\\begin{pmatrix}\n2 & -1 & 0 & \\dots & 0 \\\\\n-1 & 2 & -1 & \\dots & 0 \\\\\n0 & \\ddots & \\ddots & \\ddots & 0 \\\\\n0 & \\dots & -1 & 2 & -1 \\\\\n0 & \\dots & 0 & -1 & 2\n\\end{pmatrix}\n$$\nThese matrices are simultaneously diagonalizable, as they can be expressed as polynomials of the same tridiagonal matrix. Their eigenvalues, corresponding to the same set of eigenvectors, are known in closed form. For $j=1, 2, \\dots, n$, the eigenvalues are:\n$$\n\\lambda_j(M) = \\frac{h}{3} \\left(2 + \\cos\\left(\\frac{j\\pi}{n+1}\\right)\\right)\n$$\n$$\n\\lambda_j(K) = \\frac{2}{h} \\left(1 - \\cos\\left(\\frac{j\\pi}{n+1}\\right)\\right) = \\frac{4}{h} \\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right)\n$$\nThe eigenvalues of $A(\\Delta t) = M + \\Delta t K$ are therefore\n$$\n\\lambda_j(A(\\Delta t)) = \\lambda_j(M) + \\Delta t \\lambda_j(K) = \\frac{h}{3} \\left(2 + \\cos\\left(\\frac{j\\pi}{n+1}\\right)\\right) + \\Delta t \\frac{4}{h} \\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right)\n$$\nTo analyze the ordering of these eigenvalues, we use the identity $\\cos(2\\theta) = 1 - 2\\sin^2(\\theta)$. Let $\\theta_j = \\frac{j\\pi}{2(n+1)}$. Then $\\frac{j\\pi}{n+1} = 2\\theta_j$.\n$$\n\\lambda_j(A(\\Delta t)) = \\frac{h}{3} \\left(2 + 1 - 2\\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right)\\right) + \\Delta t \\frac{4}{h} \\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right)\n$$\n$$\n\\lambda_j(A(\\Delta t)) = h - \\frac{2h}{3} \\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right) + \\Delta t \\frac{4}{h} \\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right)\n$$\n$$\n\\lambda_j(A(\\Delta t)) = h + \\left(\\frac{4\\Delta t}{h} - \\frac{2h}{3}\\right) \\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right)\n$$\nThe term $\\sin^2\\left(\\frac{j\\pi}{2(n+1)}\\right)$ is a strictly increasing function of $j$ for $j \\in \\{1, \\dots, n\\}$. The ordering of the eigenvalues $\\lambda_j(A(\\Delta t))$ depends on the sign of the coefficient $\\left(\\frac{4\\Delta t}{h} - \\frac{2h}{3}\\right)$.\n\nCase 1: Limit as $\\Delta t \\to 0$.\nFor sufficiently small $\\Delta t$, specifically for $\\Delta t < \\frac{h^2}{6}$, the coefficient $\\left(\\frac{4\\Delta t}{h} - \\frac{2h}{3}\\right)$ is negative. Consequently, $\\lambda_j(A(\\Delta t))$ is a decreasing function of $j$.\nThe maximum and minimum eigenvalues are:\n$$\n\\lambda_{\\max}(A(\\Delta t)) = \\lambda_1(A(\\Delta t)) = \\lambda_1(M) + \\Delta t \\lambda_1(K)\n$$\n$$\n\\lambda_{\\min}(A(\\Delta t)) = \\lambda_n(A(\\Delta t)) = \\lambda_n(M) + \\Delta t \\lambda_n(K)\n$$\nThe condition number is $\\kappa_2(A(\\Delta t)) = \\frac{\\lambda_1(M) + \\Delta t \\lambda_1(K)}{\\lambda_n(M) + \\Delta t \\lambda_n(K)}$.\nTaking the limit as $\\Delta t \\to 0$:\n$$\n\\lim_{\\Delta t\\to 0} \\kappa_2(A(\\Delta t)) = \\frac{\\lambda_1(M)}{\\lambda_n(M)} = \\kappa_2(M)\n$$\nWe compute this value using the expressions for the eigenvalues of $M$:\n$$\n\\lambda_1(M) = \\frac{h}{3} \\left(2 + \\cos\\left(\\frac{\\pi}{n+1}\\right)\\right)\n$$\n$$\n\\lambda_n(M) = \\frac{h}{3} \\left(2 + \\cos\\left(\\frac{n\\pi}{n+1}\\right)\\right) = \\frac{h}{3} \\left(2 + \\cos\\left(\\pi - \\frac{\\pi}{n+1}\\right)\\right) = \\frac{h}{3} \\left(2 - \\cos\\left(\\frac{\\pi}{n+1}\\right)\\right)\n$$\nThus, the first limit is:\n$$\n\\lim_{\\Delta t\\to 0} \\kappa_2(A(\\Delta t)) = \\frac{\\frac{h}{3} \\left(2 + \\cos\\left(\\frac{\\pi}{n+1}\\right)\\right)}{\\frac{h}{3} \\left(2 - \\cos\\left(\\frac{\\pi}{n+1}\\right)\\right)} = \\frac{2 + \\cos\\left(\\frac{\\pi}{n+1}\\right)}{2 - \\cos\\left(\\frac{\\pi}{n+1}\\right)}\n$$\n\nCase 2: Limit as $\\Delta t \\to \\infty$.\nFor sufficiently large $\\Delta t$, specifically for $\\Delta t > \\frac{h^2}{6}$, the coefficient $\\left(\\frac{4\\Delta t}{h} - \\frac{2h}{3}\\right)$ is positive. Consequently, $\\lambda_j(A(\\Delta t))$ is an increasing function of $j$.\nThe minimum and maximum eigenvalues are:\n$$\n\\lambda_{\\min}(A(\\Delta t)) = \\lambda_1(A(\\Delta t)) = \\lambda_1(M) + \\Delta t \\lambda_1(K)\n$$\n$$\n\\lambda_{\\max}(A(\\Delta t)) = \\lambda_n(A(\\Delta t)) = \\lambda_n(M) + \\Delta t \\lambda_n(K)\n$$\nThe condition number is $\\kappa_2(A(\\Delta t)) = \\frac{\\lambda_n(M) + \\Delta t \\lambda_n(K)}{\\lambda_1(M) + \\Delta t \\lambda_1(K)}$.\nTo evaluate the limit as $\\Delta t \\to \\infty$, we divide the numerator and denominator by $\\Delta t$:\n$$\n\\lim_{\\Delta t\\to \\infty} \\kappa_2(A(\\Delta t)) = \\lim_{\\Delta t\\to \\infty} \\frac{\\frac{1}{\\Delta t}\\lambda_n(M) + \\lambda_n(K)}{\\frac{1}{\\Delta t}\\lambda_1(M) + \\lambda_1(K)} = \\frac{\\lambda_n(K)}{\\lambda_1(K)} = \\kappa_2(K)\n$$\nWe compute this value using the expressions for the eigenvalues of $K$:\n$$\n\\lambda_1(K) = \\frac{4}{h} \\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\n$$\n\\lambda_n(K) = \\frac{4}{h} \\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right) = \\frac{4}{h} \\sin^2\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2(n+1)}\\right) = \\frac{4}{h} \\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\nThus, the second limit is:\n$$\n\\lim_{\\Delta t\\to \\infty} \\kappa_2(A(\\Delta t)) = \\frac{\\frac{4}{h} \\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right)}{\\frac{4}{h} \\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\frac{\\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right)}{\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\nThe two required limits have been derived in closed form as functions of $n$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2 + \\cos\\left(\\frac{\\pi}{n+1}\\right)}{2 - \\cos\\left(\\frac{\\pi}{n+1}\\right)} & \\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right) \\end{pmatrix}}\n$$", "id": "2546532"}]}