{"hands_on_practices": [{"introduction": "The fundamental properties of a stiffness matrix—sparsity, symmetry, and positive definiteness—are not arbitrary mathematical artifacts; they are direct consequences of the underlying physical problem and the Galerkin method. This first exercise, [@problem_id:2600099], grounds our understanding by guiding you through the derivation of a stiffness matrix from first principles for a simple one-dimensional boundary value problem. By performing this calculation, you will see precisely how the choice of local basis functions leads to sparsity and how the structure of the weak form guarantees symmetry and positive definiteness.", "problem": "Consider the scalar, second-order elliptic boundary value problem on the unit interval with homogeneous Dirichlet boundary conditions: find $u$ such that $- \\frac{d}{dx}\\!\\left(a(x)\\,\\frac{du}{dx}\\right) = f$ in $(0,1)$ with $u(0)=u(1)=0$, where $a(x)$ is strictly positive and essentially bounded. Starting from the weak formulation obtained by multiplying the strong form by a test function $v$ and integrating by parts on $(0,1)$, use the standard continuous, piecewise-linear finite element method (finite element method) on the uniform partition $0=x_0<x_1<x_2<x_3<x_4=1$ with $x_i = i/4$ and interior nodes $x_1$, $x_2$, $x_3$. Let the coefficient be constant, $a(x) \\equiv 1$, and let $\\{\\varphi_1,\\varphi_2,\\varphi_3\\}$ denote the canonical nodal basis of the discrete space $V_h \\subset H_0^1(0,1)$.\n\nUsing only the definition of the bilinear form $b(u,v) = \\int_0^1 a(x)\\,u'(x)\\,v'(x)\\,dx$, derive the assembled stiffness matrix $K \\in \\mathbb{R}^{3 \\times 3}$ with entries $K_{ij} = b(\\varphi_j,\\varphi_i)$. From first principles, justify why $K$ is sparse, symmetric, and positive definite. Finally, determine the smallest eigenvalue of $K$ in closed form. Give your final answer as a single exact expression (no numerical rounding).", "solution": "We start from the strong form $- \\frac{d}{dx}\\!\\left(a(x)\\,\\frac{du}{dx}\\right) = f$ in $(0,1)$ with $u(0)=u(1)=0$. Let $v \\in H_0^1(0,1)$ be arbitrary. Multiplying the strong form by $v$ and integrating over $(0,1)$ gives $\\int_0^1 - \\frac{d}{dx}\\!\\left(a(x)\\,\\frac{du}{dx}\\right)v\\,dx = \\int_0^1 f\\,v\\,dx$. Integration by parts together with $v(0)=v(1)=0$ yields the weak form\n\n$$\n\\int_0^1 a(x)\\,u'(x)\\,v'(x)\\,dx = \\int_0^1 f(x)\\,v(x)\\,dx,\n$$\n\ni.e., $b(u,v) = \\ell(v)$ with bilinear form $b(u,v) = \\int_0^1 a(x)\\,u'(x)\\,v'(x)\\,dx$ and linear functional $\\ell(v) = \\int_0^1 f\\,v\\,dx$.\n\nWe discretize with continuous, piecewise-linear functions on the uniform mesh with nodes $x_i = i/4$, $i=0,1,2,3,4$, and homogeneous Dirichlet boundary conditions incorporated by restricting to the interior nodes $x_1$, $x_2$, $x_3$. The basis $\\{\\varphi_1,\\varphi_2,\\varphi_3\\}$ satisfies $\\varphi_i(x_j) = \\delta_{ij}$ for $i,j \\in \\{1,2,3\\}$, with support of $\\varphi_i$ equal to $[x_{i-1},x_{i+1}]$. On each element, the derivative of a basis function is constant: on $[x_{i-1},x_i]$ we have $\\varphi_i'(x) = \\frac{1}{h}$ and $\\varphi_{i-1}'(x) = -\\frac{1}{h}$, while on $[x_i,x_{i+1}]$ we have $\\varphi_i'(x) = -\\frac{1}{h}$ and $\\varphi_{i+1}'(x) = \\frac{1}{h}$, where $h = x_i - x_{i-1} = \\frac{1}{4}$.\n\nWith $a(x) \\equiv 1$, the element stiffness matrix on any interval $[x_{e},x_{e+1}]$ for the local nodal basis $\\{\\widehat{\\varphi}_{e},\\widehat{\\varphi}_{e+1}\\}$ is\n\n$$\nk^{(e)}_{lm} \\;=\\; \\int_{x_e}^{x_{e+1}} \\widehat{\\varphi}'_{l}(x)\\,\\widehat{\\varphi}'_{m}(x)\\,dx\n\\;=\\; \\frac{1}{h}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}_{lm}.\n$$\n\nAssembling the three identical contributions from the elements $[x_0,x_1]$, $[x_1,x_2]$, $[x_2,x_3]$, and $[x_3,x_4]$ into the interior-node basis $\\{\\varphi_1,\\varphi_2,\\varphi_3\\}$ yields the global stiffness matrix\n\n$$\nK \\;=\\; \\frac{1}{h}\n\\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix}\n\\;=\\;\n4\\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix},\n$$\n\nbecause $h = \\frac{1}{4}$.\n\nWe now justify the three properties.\n\nSparsity: For $|i-j| \\geq 2$, the supports of $\\varphi_i$ and $\\varphi_j$ are disjoint, hence $\\varphi_i'(x)\\,\\varphi_j'(x) = 0$ almost everywhere. Therefore, $K_{ij} = \\int_0^1 \\varphi_j'(x)\\,\\varphi_i'(x)\\,dx = 0$ for $|i-j|\\geq 2$. Only $K_{ii}$ and $K_{i,i\\pm 1}$ can be nonzero, which gives a tridiagonal matrix. This sparsity arises solely from the locality of the basis functions and the elementwise definition of the bilinear form.\n\nSymmetry: For any basis functions $\\varphi_i$ and $\\varphi_j$, we have\n\n$$\nK_{ij} \\;=\\; b(\\varphi_j,\\varphi_i) \\;=\\; \\int_0^1 a(x)\\,\\varphi_j'(x)\\,\\varphi_i'(x)\\,dx \\;=\\; \\int_0^1 a(x)\\,\\varphi_i'(x)\\,\\varphi_j'(x)\\,dx \\;=\\; b(\\varphi_i,\\varphi_j) \\;=\\; K_{ji},\n$$\n\nbecause multiplication of real-valued functions is commutative and $a(x)>0$ is scalar. Hence $K$ is symmetric.\n\nPositive definiteness: For any nonzero coefficient vector $c = (c_1,c_2,c_3)^{\\mathsf{T}}$, define $u_h = \\sum_{j=1}^{3} c_j\\,\\varphi_j \\in V_h$, which is not the zero function if $c \\neq 0$. Then\n\n$$\nc^{\\mathsf{T}} K c \\;=\\; \\sum_{i,j=1}^{3} c_i\\,c_j\\,K_{ij} \\;=\\; \\sum_{i,j=1}^{3} c_i\\,c_j\\,b(\\varphi_j,\\varphi_i) \\;=\\; b(u_h,u_h) \\;=\\; \\int_0^1 a(x)\\,|u_h'(x)|^2\\,dx.\n$$\n\nWith $a(x) \\equiv 1$, we have $c^{\\mathsf{T}} K c = \\int_0^1 |u_h'(x)|^2\\,dx$. For $u_h \\in H_0^1(0,1)$ and $u_h \\neq 0$, one has $u_h' \\not\\equiv 0$, so $\\int_0^1 |u_h'(x)|^2\\,dx > 0$. Hence $K$ is positive definite.\n\nWe now compute the smallest eigenvalue of $K$. Let\n\n$$\nT \\;=\\; \\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix}.\n$$\n\nBecause $K = \\frac{1}{h}\\,T$ with $h=\\frac{1}{4}$, the eigenvalues of $K$ are $\\frac{1}{h}$ times the eigenvalues of $T$. It suffices to find the eigenvalues of $T$. Consider vectors $w^{(m)} \\in \\mathbb{R}^3$ with components $w^{(m)}_j = \\sin\\!\\left(j\\,\\theta_m\\right)$ for $j \\in \\{1,2,3\\}$, where $\\theta_m = \\frac{m\\pi}{n+1}$, $n=3$, and $m \\in \\{1,2,3\\}$. For $1 \\leq j \\leq 3$ we compute\n\n$$\n(T w^{(m)})_j \\;=\\; 2 \\sin(j\\theta_m) - \\sin((j-1)\\theta_m) - \\sin((j+1)\\theta_m).\n$$\n\nUsing the trigonometric identity $\\sin((j+1)\\theta) + \\sin((j-1)\\theta) = 2\\sin(j\\theta)\\cos(\\theta)$, we obtain\n\n$$\n(T w^{(m)})_j \\;=\\; 2 \\sin(j\\theta_m) - 2\\sin(j\\theta_m)\\cos(\\theta_m) \\;=\\; 2\\bigl(1-\\cos(\\theta_m)\\bigr)\\,\\sin(j\\theta_m).\n$$\n\nThus $w^{(m)}$ is an eigenvector of $T$ with eigenvalue\n\n$$\n\\mu_m \\;=\\; 2\\bigl(1-\\cos(\\theta_m)\\bigr) \\;=\\; 2 - 2\\cos\\!\\left(\\frac{m\\pi}{4}\\right), \\quad m \\in \\{1,2,3\\}.\n$$\n\nTherefore, the eigenvalues of $K$ are\n\n$$\n\\lambda_m \\;=\\; \\frac{1}{h}\\,\\mu_m \\;=\\; 4\\,\\mu_m \\;=\\; 4\\left(2 - 2\\cos\\!\\left(\\frac{m\\pi}{4}\\right)\\right), \\quad m \\in \\{1,2,3\\}.\n$$\n\nThe smallest eigenvalue corresponds to $m=1$ (since $\\cos(\\cdot)$ is decreasing on $(0,\\pi)$), giving\n\n$$\n\\lambda_{\\min}(K) \\;=\\; 4\\left(2 - 2\\cos\\!\\left(\\frac{\\pi}{4}\\right)\\right) \\;=\\; 8 - 8\\cdot\\frac{\\sqrt{2}}{2} \\;=\\; 8 - 4\\sqrt{2}.\n$$\n\nThis is a closed-form exact expression.", "answer": "$$\\boxed{8-4\\sqrt{2}}$$", "id": "2600099"}, {"introduction": "While well-posed problems with sufficient boundary conditions yield positive definite stiffness matrices, systems without enough constraints to prevent rigid body motion result in singular, or positive semi-definite, matrices. This thought experiment, [@problem_id:2600103], delves into this crucial concept by examining a linearized elasticity problem on a domain with two sub-regions connected at a single point. Characterizing the nullspace of the resulting stiffness matrix reveals its direct correspondence to the physical rigid body motions of the unconstrained system, a vital insight for structural analysis.", "problem": "Consider the two-dimensional linearized elasticity model on a polygonal domain $\\Omega \\subset \\mathbb{R}^{2}$ with Lamé parameters $\\lambda>0$ and $\\mu>0$. Let the total domain be the union $\\Omega=\\Omega_{1}\\cup \\Omega_{2}$ of two polygonal subdomains $\\Omega_{1}$ and $\\Omega_{2}$ whose interiors are disjoint. Assume there is a conforming simplicial triangulation $\\mathcal{T}_{h}$ of $\\Omega$ such that $\\Omega_{1}$ and $\\Omega_{2}$ are each unions of elements of $\\mathcal{T}_{h}$ and share exactly one vertex $x_{0}$ in common, with no common edge of positive length. Consider the conforming vector finite element space $V_{h}\\subset H^{1}(\\Omega;\\mathbb{R}^{2})$ of continuous, piecewise affine vector fields with respect to $\\mathcal{T}_{h}$.\n\nThe bilinear form associated with the elastic energy is\n$$\na(u,v)\\;=\\;\\int_{\\Omega}\\Big(2\\mu\\,\\varepsilon(u):\\varepsilon(v)\\;+\\;\\lambda\\,\\operatorname{div}u\\,\\operatorname{div}v\\Big)\\,\\mathrm{d}x,\n$$\nwhere $\\varepsilon(u)=\\tfrac{1}{2}\\left(\\nabla u+(\\nabla u)^{\\top}\\right)$ is the symmetric gradient. Assemble the global stiffness matrix $K$ by $K_{ij}=a(\\varphi_{j},\\varphi_{i})$ using the standard nodal basis $\\{\\varphi_{i}\\}$ of $V_{h}$, under traction-free (homogeneous Neumann) boundary conditions on all of $\\partial\\Omega$ and with no Dirichlet constraints.\n\nStarting only from foundational facts about the linearized elastic energy and the definition of the symmetric gradient, reason from first principles to characterize the discrete nullspace of $K$ in terms of discrete rigid body motions on $\\Omega_{1}$ and $\\Omega_{2}$ and the imposed inter-subdomain continuity at the single shared vertex $x_{0}$. Determine the dimension of the nullspace of $K$ as a single real number. Your answer must be a single integer with no units. No rounding is required.", "solution": "The problem statement is subjected to validation before any solution is attempted.\n\nGivens are extracted verbatim as follows:\n- Model: Two-dimensional linearized elasticity on a polygonal domain $\\Omega \\subset \\mathbb{R}^{2}$.\n- Lamé parameters: $\\lambda>0$ and $\\mu>0$.\n- Domain decomposition: $\\Omega=\\Omega_{1}\\cup \\Omega_{2}$, where $\\Omega_{1}$, $\\Omega_{2}$ are polygonal subdomains with disjoint interiors.\n- Subdomain interface: $\\Omega_{1}$ and $\\Omega_{2}$ share exactly one vertex $x_{0}$ in common, with no common edge of positive length.\n- Discretization: A conforming simplicial triangulation $\\mathcal{T}_{h}$ of $\\Omega$ is given, such that $\\Omega_{1}$ and $\\Omega_{2}$ are unions of elements of $\\mathcal{T}_{h}$.\n- Finite Element Space: $V_{h}\\subset H^{1}(\\Omega;\\mathbb{R}^{2})$ of continuous, piecewise affine vector fields with respect to $\\mathcal{T}_{h}$.\n- Bilinear form: $a(u,v)\\;=\\;\\int_{\\Omega}\\Big(2\\mu\\,\\varepsilon(u):\\varepsilon(v)\\;+\\;\\lambda\\,\\operatorname{div}u\\,\\operatorname{div}v\\Big)\\,\\mathrm{d}x$.\n- Strain tensor definition: $\\varepsilon(u)=\\tfrac{1}{2}\\left(\\nabla u+(\\nabla u)^{\\top}\\right)$.\n- Stiffness matrix definition: $K_{ij}=a(\\varphi_{j},\\varphi_{i})$ for the standard nodal basis $\\{\\varphi_{i}\\}$ of $V_{h}$.\n- Boundary conditions: Homogeneous Neumann boundary conditions on all of $\\partial\\Omega$.\n- Constraints: No Dirichlet constraints.\n\nThe problem is subjected to validation based on these givens.\n- **Scientific Grounding**: The problem is formulated within the standard mathematical framework of linearized elasticity and the finite element method. The equations and definitions are fundamental to solid mechanics. The setup is scientifically sound.\n- **Well-Posedness**: The problem asks for the dimension of the nullspace of a specific matrix. The setup, while featuring a geometrically specific connection between subdomains, is mathematically precise and allows for a unique, deterministic answer.\n- **Objectivity**: The problem is stated in precise, objective mathematical language, free of ambiguity or subjective claims.\n\nThe problem contains no scientific or logical contradictions, is complete, and is properly structured. The premise of two domains connected at a single point is a valid idealization used to test fundamental concepts of continuity and constraints in numerical analysis. The problem is deemed valid and a solution will be provided.\n\nThe objective is to determine the dimension of the nullspace of the global stiffness matrix $K$. A vector function $u_{h} \\in V_{h}$ belongs to the nullspace of $K$ if and only if the associated vector of nodal values lies in the nullspace of the matrix $K$. This is equivalent to the condition $a(u_{h}, v_{h}) = 0$ for all $v_{h} \\in V_{h}$.\n\nBy setting $v_{h} = u_{h}$, we find that any element $u_{h}$ in the nullspace must satisfy $a(u_{h}, u_{h}) = 0$. The elastic energy is given by:\n$$\na(u_{h}, u_{h}) = \\int_{\\Omega} \\Big( 2\\mu\\,\\varepsilon(u_{h}):\\varepsilon(u_{h}) + \\lambda\\,(\\operatorname{div}u_{h})^2 \\Big)\\,\\mathrm{d}x\n$$\nThe Lamé parameters are given as strictly positive, $\\mu > 0$ and $\\lambda > 0$. The terms $\\varepsilon(u_{h}):\\varepsilon(u_{h})$ and $(\\operatorname{div}u_{h})^2$ are non-negative. Therefore, the integrand is a sum of non-negative quantities. The integral $a(u_{h}, u_{h})$ can be zero if and only if the integrand is zero almost everywhere in $\\Omega$. This requires that $\\varepsilon(u_{h}):\\varepsilon(u_{h}) = 0$ and $(\\operatorname{div}u_{h})^2=0$ almost everywhere. The first condition is sufficient, as $\\operatorname{div}u_h = \\operatorname{tr}(\\varepsilon(u_h))$.\nHence, an element $u_{h}$ is in the nullspace of $K$ if and only if its symmetric gradient (strain tensor) vanishes almost everywhere in $\\Omega$:\n$$\n\\varepsilon(u_{h}) = \\frac{1}{2} \\left( \\nabla u_{h} + (\\nabla u_{h})^{\\top} \\right) = 0 \\quad \\text{a.e. in } \\Omega.\n$$\nFrom Korn's inequality, a vector field $u \\in H^{1}(\\Omega;\\mathbb{R}^{2})$ having zero strain, $\\varepsilon(u)=0$, on a connected domain must be a rigid body motion (RBM). For a two-dimensional space, the space of rigid body motions is $3$-dimensional. A general RBM can be expressed as a superposition of two translations and one infinitesimal rotation:\n$$\nu(x) = c + A x\n$$\nwhere $c \\in \\mathbb{R}^{2}$ is a constant translation vector and $A$ is a $2 \\times 2$ skew-symmetric matrix. A skew-symmetric matrix in two dimensions has the form $A = \\omega \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}$ for some scalar $\\omega \\in \\mathbb{R}$.\n\nThe problem domain $\\Omega = \\Omega_1 \\cup \\Omega_2$ is composed of two connected subdomains, $\\Omega_1$ and $\\Omega_2$, which are joined only at a single vertex $x_0$. Because $u_{h}$ is piecewise affine and $\\varepsilon(u_{h})=0$ on each element, and because $u_h$ is continuous, the restriction of $u_{h}$ to any connected part of the domain must be a single rigid body motion.\nSince $\\Omega_1$ and $\\Omega_2$ are connected components of the domain that are only linked at a single point, the condition $\\varepsilon(u_{h})=0$ on $\\Omega$ implies that:\n$1$. The restriction of $u_{h}$ to $\\Omega_1$, let us call it $u_1$, must be a rigid body motion on $\\Omega_1$.\n$2$. The restriction of $u_{h}$ to $\\Omega_2$, let us call it $u_2$, must be a rigid body motion on $\\Omega_2$.\n\nThe space of rigid body motions on $\\Omega_1$ is $3$-dimensional. Let this space be $\\mathcal{R}_1$. An element $u_1 \\in \\mathcal{R}_1$ is determined by $3$ parameters (e.g., two for translation, one for rotation).\nSimilarly, the space of rigid body motions on $\\Omega_2$ is also $3$-dimensional. Let this space be $\\mathcal{R}_2$. An element $u_2 \\in \\mathcal{R}_2$ is determined by $3$ parameters.\n\nTherefore, a pair of independent rigid body motions $(u_1, u_2)$ is defined by $3+3=6$ parameters.\n\nHowever, the function $u_{h}$ must belong to the finite element space $V_h$, which is a subspace of $H^{1}(\\Omega;\\mathbb{R}^{2})$ consisting of continuous functions. The continuity of $u_{h}$ must be enforced across the entire domain $\\Omega$, including at the interface between $\\Omega_1$ and $\\Omega_2$. The problem states that this interface consists of a single vertex, $x_0$.\nThe continuity constraint is thus:\n$$\nu_1(x_0) = u_2(x_0)\n$$\nTo analyze this constraint, we represent the rigid body motions relative to the shared vertex $x_0$.\nFor $x \\in \\Omega_1$, the motion $u_1(x)$ can be written as:\n$$\nu_1(x) = c_1 + \\omega_1 \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} (x - x_0)\n$$\nwhere $c_1 \\in \\mathbb{R}^2$ and $\\omega_1 \\in \\mathbb{R}$ are the parameters defining the motion.\nFor $x \\in \\Omega_2$, the motion $u_2(x)$ can be written as:\n$$\nu_2(x) = c_2 + \\omega_2 \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} (x - x_0)\n$$\nwhere $c_2 \\in \\mathbb{R}^2$ and $\\omega_2 \\in \\mathbb{R}$ are the parameters.\nThe total number of parameters is $2$ (for $c_1$) $+ 1$ (for $\\omega_1$) $+ 2$ (for $c_2$) $+ 1$ (for $\\omega_2$), which is $6$.\n\nNow we apply the continuity constraint at $x=x_0$:\n$$\nu_1(x_0) = c_1 + \\omega_1 \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} (x_0 - x_0) = c_1\n$$\n$$\nu_2(x_0) = c_2 + \\omega_2 \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} (x_0 - x_0) = c_2\n$$\nThe constraint $u_1(x_0) = u_2(x_0)$ simplifies to $c_1 = c_2$.\nThis is a vector equation in $\\mathbb{R}^2$, which corresponds to two independent scalar linear constraints on the $6$ parameters. Specifically, if $c_1=(c_{1x}, c_{1y})$ and $c_2=(c_{2x}, c_{2y})$, the constraints are $c_{1x}=c_{2x}$ and $c_{1y}=c_{2y}$.\n\nThe dimension of the nullspace of $K$, $\\operatorname{dim}(\\operatorname{ker}(K))$, is the number of degrees of freedom of the system of piecewise rigid body motions satisfying the continuity constraint. This is the initial number of parameters minus the number of independent constraints.\n$$\n\\operatorname{dim}(\\operatorname{ker}(K)) = (\\text{parameters for } u_1) + (\\text{parameters for } u_2) - (\\text{constraints})\n$$\n$$\n\\operatorname{dim}(\\operatorname{ker}(K)) = 3 + 3 - 2 = 4\n$$\nThe four basis vectors of this nullspace can be physically interpreted. Let $c = c_1 = c_2$. The free parameters are the two components of $c$, and the two rotation scalars $\\omega_1$ and $\\omega_2$.\n$1$. Global translation in the first coordinate direction: $c=(1,0)$, $\\omega_1=0$, $\\omega_2=0$.\n$2$. Global translation in the second coordinate direction: $c=(0,1)$, $\\omega_1=0$, $\\omega_2=0$.\n$3$. Rotation of $\\Omega_1$ about $x_0$ while $\\Omega_2$ is stationary: $c=(0,0)$, $\\omega_1=1$, $\\omega_2=0$.\n$4$. Rotation of $\\Omega_2$ about $x_0$ while $\\Omega_1$ is stationary: $c=(0,0)$, $\\omega_1=0$, $\\omega_2=1$.\nThese four modes are linearly independent and span the nullspace. Any global rotation of the entire body $\\Omega$ about $x_0$ corresponds to the case where $\\omega_1 = \\omega_2$, which is a linear combination of modes $3$ and $4$.\n\nThe dimension of the nullspace of the stiffness matrix $K$ is therefore $4$.", "answer": "$$\n\\boxed{4}\n$$", "id": "2600103"}, {"introduction": "In large-scale finite element analysis, it is often computationally advantageous to eliminate certain degrees of freedom before the final global solve, a technique known as static condensation. This practice, [@problem_id:2600113], provides hands-on experience with this powerful method by deriving the Schur complement matrix for a simple two-element substructure. You will explore how properties like symmetry and positive semidefiniteness are preserved through this algebraic reduction and discover the important concept of 'fill-in,' where the condensed matrix can become denser than the original.", "problem": "Consider the steady diffusion problem on a one-dimensional, two-element patch with no essential boundary conditions enforced on the patch itself (the patch will be thought of as a free substructure). The governing equation in strong form is $-\\frac{d}{dx}\\big(\\kappa(x)\\,u'(x)\\big)=0$ and the associated energy functional is \n$$\n\\mathcal{E}(u) \\;=\\; \\frac{1}{2}\\int_{\\Omega}\\kappa(x)\\,\\big(u'(x)\\big)^{2}\\,dx.\n$$\nDiscretize the patch with linear finite elements (hat functions) using nodes at $x_{0}=0$, $x_{1}=1$, and $x_{2}=3$. The material (diffusivity) is piecewise constant: $\\kappa(x)=\\kappa_{1}$ on $[x_{0},x_{1}]$ and $\\kappa(x)=\\kappa_{2}$ on $[x_{1},x_{2}]$. Treat the parameters as nondimensional. Let the degrees of freedom be the nodal values $(u_{0},u_{1},u_{2})$.\n\n1) Starting from the energy functional and the Galerkin principle for the finite element method (FEM), derive the $3\\times 3$ assembled stiffness matrix $\\mathbf{K}$ for this patch. Using only the variational definition of $\\mathbf{K}$, justify its symmetry, its positive semidefiniteness, and identify a basis for its nullspace. Explain how the compact support of the basis functions implies the sparsity pattern of $\\mathbf{K}$.\n\n2) Partition the degrees of freedom into the boundary set $b=\\{0,2\\}$ and the interior set $i=\\{1\\}$. Perform exact static condensation by eliminating the interior degree of freedom $u_{1}$ to obtain the Schur complement $\\mathbf{S}$ acting on the boundary degrees of freedom $u_{b}=(u_{0},u_{2})$. Prove from first principles (energy minimization on the eliminated interior degree of freedom) that $\\mathbf{S}$ is symmetric and positive semidefinite for this free substructure. Briefly discuss how static condensation affects sparsity in general.\n\n3) Now specialize to the numerical values $\\kappa_{1}=3$, $\\kappa_{2}=1$, $x_{1}-x_{0}=1$, and $x_{2}-x_{1}=2$. Compute the unique positive eigenvalue of the $2\\times 2$ Schur complement matrix $\\mathbf{S}$. Express your final answer as an exact rational number.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard, canonical exercise in the application of the Finite Element Method to a one-dimensional boundary value problem. All necessary data and definitions are provided, and the questions posed are unambiguous and solvable using established principles of computational mechanics and linear algebra. The problem is therefore deemed valid. We proceed with the solution.\n\nPart 1: Derivation and Properties of the Stiffness Matrix $\\mathbf{K}$\n\nThe finite element approximation $u_{h}(x)$ is a linear combination of the nodal values $\\mathbf{u} = \\{u_{0}, u_{1}, u_{2}\\}^{T}$ and the corresponding linear basis (hat) functions $N_{j}(x)$:\n$$\nu_{h}(x) = \\sum_{j=0}^{2} u_{j} N_{j}(x)\n$$\nThe basis functions are defined piecewise over the two elements, $\\Omega_{1} = [x_{0}, x_{1}]=[0, 1]$ and $\\Omega_{2} = [x_{1}, x_{2}]=[1, 3]$, and satisfy the property $N_{j}(x_{k}) = \\delta_{jk}$. The lengths of the elements are $L_{1} = x_{1}-x_{0} = 1$ and $L_{2} = x_{2}-x_{1} = 2$.\nThe basis functions and their derivatives are:\n$$\nN_{0}(x) = \\begin{cases} 1 - \\frac{x}{L_{1}} & x \\in \\Omega_{1} \\\\ 0 & x \\in \\Omega_{2} \\end{cases} \\quad \\implies \\quad N'_{0}(x) = \\begin{cases} -\\frac{1}{L_{1}} & x \\in \\Omega_{1} \\\\ 0 & x \\in \\Omega_{2} \\end{cases}\n$$\n$$\nN_{1}(x) = \\begin{cases} \\frac{x}{L_{1}} & x \\in \\Omega_{1} \\\\ 1 - \\frac{x-x_{1}}{L_{2}} & x \\in \\Omega_{2} \\end{cases} \\quad \\implies \\quad N'_{1}(x) = \\begin{cases} \\frac{1}{L_{1}} & x \\in \\Omega_{1} \\\\ -\\frac{1}{L_{2}} & x \\in \\Omega_{2} \\end{cases}\n$$\n$$\nN_{2}(x) = \\begin{cases} 0 & x \\in \\Omega_{1} \\\\ \\frac{x-x_{1}}{L_{2}} & x \\in \\Omega_{2} \\end{cases} \\quad \\implies \\quad N'_{2}(x) = \\begin{cases} 0 & x \\in \\Omega_{1} \\\\ \\frac{1}{L_{2}} & x \\in \\Omega_{2} \\end{cases}\n$$\nSubstituting $u_{h}(x)$ into the energy functional $\\mathcal{E}(u)$ yields the discrete energy expression $\\mathcal{E}(u_{h}) = \\frac{1}{2}\\mathbf{u}^{T}\\mathbf{K}\\mathbf{u}$, from which the stiffness matrix components $K_{ij}$ are identified through the variational definition:\n$$\nK_{ij} = \\int_{\\Omega} \\kappa(x) N'_{i}(x) N'_{j}(x) dx = \\int_{\\Omega_{1}} \\kappa_{1} N'_{i}(x) N'_{j}(x) dx + \\int_{\\Omega_{2}} \\kappa_{2} N'_{i}(x) N'_{j}(x) dx\n$$\nThe assembly of $\\mathbf{K}$ is performed by summing the contributions from the two element stiffness matrices. For a generic 1D element of length $L$ and constant diffusivity $\\kappa$, the element stiffness matrix is $\\mathbf{k} = \\frac{\\kappa}{L}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\nFor element $1$ (nodes $0, 1$): $\\mathbf{k}^{(1)} = \\frac{\\kappa_1}{L_1} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\nFor element $2$ (nodes $1, 2$): $\\mathbf{k}^{(2)} = \\frac{\\kappa_2}{L_2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\nAssembling these into the global matrix for nodes $(0, 1, 2)$:\n$$\n\\mathbf{K} = \\begin{pmatrix}\n\\frac{\\kappa_1}{L_1} & -\\frac{\\kappa_1}{L_1} & 0 \\\\\n-\\frac{\\kappa_1}{L_1} & \\frac{\\kappa_1}{L_1} + \\frac{\\kappa_2}{L_2} & -\\frac{\\kappa_2}{L_2} \\\\\n0 & -\\frac{\\kappa_2}{L_2} & \\frac{\\kappa_2}{L_2}\n\\end{pmatrix}\n$$\nThe properties of $\\mathbf{K}$ are justified as follows:\n- **Symmetry**: The definition $K_{ij} = \\int \\kappa N'_{i} N'_{j} dx$ is inherently symmetric under interchange of indices $i$ and $j$, since scalar multiplication is commutative: $N'_{i}N'_{j} = N'_{j}N'_{i}$. Thus, $K_{ij} = K_{ji}$, and $\\mathbf{K}$ is symmetric.\n- **Positive Semidefiniteness**: For any non-zero vector of nodal values $\\mathbf{v}$, the quadratic form $\\mathbf{v}^{T}\\mathbf{K}\\mathbf{v}$ corresponds to twice the energy of the field $v_{h}(x) = \\sum v_{j}N_{j}(x)$.\n$$\n\\mathbf{v}^{T}\\mathbf{K}\\mathbf{v} = 2\\mathcal{E}(v_{h}) = \\int_{\\Omega} \\kappa(x) (v'_{h}(x))^2 dx\n$$\nGiven that $\\kappa(x) > 0$ and $(v'_{h}(x))^2 \\ge 0$, the integrand is non-negative, and thus the integral is non-negative. Therefore, $\\mathbf{v}^{T}\\mathbf{K}\\mathbf{v} \\ge 0$, which proves that $\\mathbf{K}$ is positive semidefinite.\n- **Nullspace**: The energy $\\mathbf{v}^{T}\\mathbf{K}\\mathbf{v}$ is zero if and only if the integrand is zero almost everywhere, meaning $v'_{h}(x) = 0$ over $\\Omega$. This implies that $v_{h}(x)$ must be a constant function. For a piecewise linear function, this requires all nodal values to be equal: $v_0 = v_1 = v_2 = c$ for some constant $c \\neq 0$. Thus, any vector $\\mathbf{v}$ of the form $c\\{1, 1, 1\\}^{T}$ belongs to the nullspace of $\\mathbf{K}$. The basis for this one-dimensional nullspace is the vector $\\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}^{T}$. This corresponds to a rigid-body mode, which is expected for a free structure with no essential boundary conditions.\n- **Sparsity**: The entry $K_{ij}$ is non-zero only if the integral $\\int N'_{i}N'_{j} dx$ is non-zero. The basis functions have compact support, meaning $N_{j}(x)$ (and its derivative) is non-zero only on elements adjacent to node $j$. The product $N'_{i}(x) N'_{j}(x)$ is non-zero only if there is at least one element that contains both nodes $i$ and $j$. For a 1D chain of elements, this occurs only if $|i-j| \\le 1$. Consequently, $K_{ij}=0$ for $|i-j| > 1$, which makes $\\mathbf{K}$ a tridiagonal (sparse) matrix.\n\nPart 2: Static Condensation and the Schur Complement $\\mathbf{S}$\n\nWe partition the degrees of freedom into the interior set $i=\\{1\\}$ and boundary set $b=\\{0,2\\}$. The system of equations $\\mathbf{K}\\mathbf{u}=\\mathbf{f}$ (with $\\mathbf{f}=\\mathbf{0}$ for a problem with no sources) is partitioned as:\n$$\n\\begin{pmatrix} K_{11} & \\mathbf{K}_{1b} \\\\ \\mathbf{K}_{b1} & \\mathbf{K}_{bb} \\end{pmatrix}\n\\begin{pmatrix} u_{1} \\\\ \\mathbf{u}_{b} \\end{pmatrix} =\n\\begin{pmatrix} 0 \\\\ \\mathbf{f}_{b} \\end{pmatrix}\n$$\nwhere $\\mathbf{u}_{b} = \\{u_{0}, u_{2}\\}^{T}$, $\\mathbf{K}_{1b} = \\begin{pmatrix} K_{10} & K_{12} \\end{pmatrix}$, and $\\mathbf{K}_{b1} = \\mathbf{K}_{1b}^{T}$. The partitioned matrices are:\n$K_{11} = \\frac{\\kappa_1}{L_1} + \\frac{\\kappa_2}{L_2}$, $\\mathbf{K}_{1b} = \\begin{pmatrix} -\\frac{\\kappa_1}{L_1} & -\\frac{\\kappa_2}{L_2} \\end{pmatrix}$, and $\\mathbf{K}_{bb} = \\begin{pmatrix} \\frac{\\kappa_1}{L_1} & 0 \\\\ 0 & \\frac{\\kappa_2}{L_2} \\end{pmatrix}$.\nStatic condensation is equivalent to minimizing the energy functional $\\mathcal{E}(u_1, \\mathbf{u}_b)$ with respect to the interior degree of freedom $u_1$ for a fixed $\\mathbf{u}_b$.\n$$\n\\mathcal{E}(u_{1}, \\mathbf{u}_{b}) = \\frac{1}{2} \\left( K_{11}u_{1}^{2} + 2u_{1}\\mathbf{K}_{1b}\\mathbf{u}_{b} + \\mathbf{u}_{b}^{T}\\mathbf{K}_{bb}\\mathbf{u}_{b} \\right)\n$$\nThe minimum occurs where $\\frac{\\partial\\mathcal{E}}{\\partial u_{1}} = 0$, which gives $K_{11}u_{1} + \\mathbf{K}_{1b}\\mathbf{u}_{b} = 0$, so $u_1 = -K_{11}^{-1}\\mathbf{K}_{1b}\\mathbf{u}_{b}$. Substituting this back into the energy functional yields the condensed energy $\\mathcal{E}_{cond}(\\mathbf{u}_{b}) = \\frac{1}{2}\\mathbf{u}_{b}^{T}\\mathbf{S}\\mathbf{u}_{b}$:\n$$\n\\mathcal{E}_{cond}(\\mathbf{u}_{b}) = \\frac{1}{2}\\mathbf{u}_{b}^{T}\\left( \\mathbf{K}_{bb} - \\mathbf{K}_{b1}K_{11}^{-1}\\mathbf{K}_{1b} \\right)\\mathbf{u}_{b}\n$$\nThe Schur complement is thus $\\mathbf{S} = \\mathbf{K}_{bb} - \\mathbf{K}_{b1}K_{11}^{-1}\\mathbf{K}_{1b}$.\n- **Symmetry of S**: Since $\\mathbf{K}$ is symmetric, $\\mathbf{K}_{bb}$ is symmetric and $\\mathbf{K}_{b1} = \\mathbf{K}_{1b}^{T}$. Then $\\mathbf{S}^{T} = \\mathbf{K}_{bb}^{T} - (\\mathbf{K}_{b1}K_{11}^{-1}\\mathbf{K}_{1b})^{T} = \\mathbf{K}_{bb} - \\mathbf{K}_{1b}^{T}(K_{11}^{-1})^{T}\\mathbf{K}_{b1}^{T} = \\mathbf{K}_{bb} - \\mathbf{K}_{b1}K_{11}^{-1}\\mathbf{K}_{1b} = \\mathbf{S}$. Thus, $\\mathbf{S}$ is symmetric.\n- **Positive Semidefiniteness of S**: The quadratic form for $\\mathbf{S}$ represents twice the minimum energy of the patch for given boundary displacements $\\mathbf{u}_b$. Let $\\mathbf{u}^{*} = \\{u_{1}^{*}, \\mathbf{u}_{b}\\}^{T}$, where $u_{1}^{*}$ is the energy-minimizing interior displacement. Then $\\mathbf{u}_{b}^{T}\\mathbf{S}\\mathbf{u}_{b} = (\\mathbf{u}^{*})^{T}\\mathbf{K}\\mathbf{u}^{*}$. Since $\\mathbf{K}$ is positive semidefinite, $(\\mathbf{u}^{*})^{T}\\mathbf{K}\\mathbf{u}^{*} \\ge 0$. Therefore, $\\mathbf{u}_{b}^{T}\\mathbf{S}\\mathbf{u}_{b} \\ge 0$ for any $\\mathbf{u}_b$, proving that $\\mathbf{S}$ is positive semidefinite.\n- **Effect on Sparsity**: The matrix $\\mathbf{S}$ connects the boundary nodes $\\{0,2\\}$. In the original matrix $\\mathbf{K}$, these nodes were not directly connected ($K_{02}=K_{20}=0$). However, the Schur complement $\\mathbf{S}$ will generally have a non-zero entry $S_{02}$. This process, which creates non-zero entries where there were previously zeros, is called \"fill-in\". Static condensation typically reduces the sparsity of the system by creating a dense block connecting all boundary nodes of the condensed substructure.\n\nPart 3: Eigenvalue Calculation for Specific Parameters\n\nWe are given $\\kappa_1=3$, $\\kappa_2=1$, $L_1=1$, and $L_2=2$.\nThe specific stiffness matrix $\\mathbf{K}$ is:\n$$\n\\mathbf{K} = \\begin{pmatrix}\n3 & -3 & 0 \\\\\n-3 & 3 + \\frac{1}{2} & -\\frac{1}{2} \\\\\n0 & -\\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix} = \\begin{pmatrix}\n3 & -3 & 0 \\\\\n-3 & \\frac{7}{2} & -\\frac{1}{2} \\\\\n0 & -\\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}\n$$\nThe partitioned components for condensation are:\n$K_{11} = \\frac{7}{2}$\n$\\mathbf{K}_{bb} = \\begin{pmatrix} 3 & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}$\n$\\mathbf{K}_{1b} = \\begin{pmatrix} -3 & -\\frac{1}{2} \\end{pmatrix}$\n$\\mathbf{K}_{b1} = \\begin{pmatrix} -3 \\\\ -\\frac{1}{2} \\end{pmatrix}$\nWe compute the Schur complement $\\mathbf{S} = \\mathbf{K}_{bb} - \\mathbf{K}_{b1}K_{11}^{-1}\\mathbf{K}_{1b}$:\n$$\n\\mathbf{S} = \\begin{pmatrix} 3 & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} - \\begin{pmatrix} -3 \\\\ -\\frac{1}{2} \\end{pmatrix} \\left(\\frac{7}{2}\\right)^{-1} \\begin{pmatrix} -3 & -\\frac{1}{2} \\end{pmatrix}\n$$\n$$\n\\mathbf{S} = \\begin{pmatrix} 3 & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} - \\frac{2}{7} \\begin{pmatrix} (-3)(-3) & (-3)(-\\frac{1}{2}) \\\\ (-\\frac{1}{2})(-3) & (-\\frac{1}{2})(-\\frac{1}{2}) \\end{pmatrix} = \\begin{pmatrix} 3 & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} - \\frac{2}{7} \\begin{pmatrix} 9 & \\frac{3}{2} \\\\ \\frac{3}{2} & \\frac{1}{4} \\end{pmatrix}\n$$\n$$\n\\mathbf{S} = \\begin{pmatrix} 3 & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} - \\begin{pmatrix} \\frac{18}{7} & \\frac{3}{7} \\\\ \\frac{3}{7} & \\frac{1}{14} \\end{pmatrix} = \\begin{pmatrix} 3 - \\frac{18}{7} & -\\frac{3}{7} \\\\ -\\frac{3}{7} & \\frac{1}{2} - \\frac{1}{14} \\end{pmatrix} = \\begin{pmatrix} \\frac{21-18}{7} & -\\frac{3}{7} \\\\ -\\frac{3}{7} & \\frac{7-1}{14} \\end{pmatrix}\n$$\n$$\n\\mathbf{S} = \\begin{pmatrix} \\frac{3}{7} & -\\frac{3}{7} \\\\ -\\frac{3}{7} & \\frac{6}{14} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{7} & -\\frac{3}{7} \\\\ -\\frac{3}{7} & \\frac{3}{7} \\end{pmatrix} = \\frac{3}{7}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nTo find the eigenvalues $\\lambda$ of $\\mathbf{S}$, we solve the characteristic equation $\\det(\\mathbf{S} - \\lambda\\mathbf{I}) = 0$.\n$$\n\\det\\begin{pmatrix} \\frac{3}{7}-\\lambda & -\\frac{3}{7} \\\\ -\\frac{3}{7} & \\frac{3}{7}-\\lambda \\end{pmatrix} = \\left(\\frac{3}{7}-\\lambda\\right)^2 - \\left(-\\frac{3}{7}\\right)^2 = 0\n$$\n$$\n\\left(\\frac{3}{7}-\\lambda\\right)^2 - \\frac{9}{49} = 0 \\implies \\lambda^2 - \\frac{6}{7}\\lambda + \\frac{9}{49} - \\frac{9}{49} = 0\n$$\n$$\n\\lambda\\left(\\lambda - \\frac{6}{7}\\right) = 0\n$$\nThe eigenvalues are $\\lambda_1 = 0$ and $\\lambda_2 = \\frac{6}{7}$. The zero eigenvalue corresponds to the rigid-body mode of the free substructure. The unique positive eigenvalue is $\\frac{6}{7}$.", "answer": "$$\\boxed{\\frac{6}{7}}$$", "id": "2600113"}]}