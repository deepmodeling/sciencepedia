{"hands_on_practices": [{"introduction": "Before we can solve complex physical equations on a mesh, we must first learn its language. This practice focuses on translating a mesh's visual structure into precise mathematical data structures. By constructing incidence and adjacency matrices from a list of triangles, you will build a foundational understanding of how mesh connectivity is formally represented, a crucial first step in any finite element analysis [@problem_id:2575961].", "problem": "Consider a two-dimensional simplicial complex representing a triangular mesh used in the finite element method (FEM). The mesh is specified by the vertex set $\\mathcal{V}$ with coordinates and the triangle set $\\mathcal{T}$ as follows:\n- Vertices (indexed by integers): $\\mathcal{V}=\\{1,2,3,4,5,6\\}$ with positions $x_{1}=(0,0)$, $x_{2}=(1,0)$, $x_{3}=(0,1)$, $x_{4}=(1,1)$, $x_{5}=(2,0)$, $x_{6}=(2,1)$.\n- Triangles (listed by their vertex indices): $\\mathcal{T}=\\{(1,2,3),\\,(2,4,3),\\,(2,5,4),\\,(5,6,4)\\}$.\n\nFrom first principles of mesh topology, do the following:\n- Enumerate the unique edge set $\\mathcal{E}$ implied by $\\mathcal{T}$ as unordered vertex pairs and fix an orientation of each edge from the lower to the higher vertex index. Construct the oriented edge-to-vertex incidence matrix $B\\in\\mathbb{R}^{|\\mathcal{E}|\\times |\\mathcal{V}|}$ with the convention that for an oriented edge $e=(i,j)$ with $i<j$, the row of $B$ has entry $-1$ in column $i$, entry $+1$ in column $j$, and $0$ elsewhere.\n- Using only the definitions of incidence and adjacency among $0$-simplices (vertices) and $1$-simplices (edges), compute the valence $d_{v}$ of each vertex $v\\in\\mathcal{V}$, where valence means the number of edges incident to $v$.\n- Define two distinct edges to be adjacent if and only if they share at least one vertex. Using only the edge-to-vertex incidence, construct the symmetric edge-edge adjacency matrix $A_{e}\\in\\mathbb{R}^{|\\mathcal{E}|\\times |\\mathcal{E}|}$ with zero diagonal and unit off-diagonal entries when the corresponding edges are adjacent and zero otherwise.\n- Using only the triangle list $\\mathcal{T}$ and edge-to-triangle incidence, identify which edges are boundary edges (those that belong to exactly one triangle) and which are interior edges (those that belong to exactly two triangles).\n\nFinally, based on the counts obtained, compute the Euler characteristic $\\chi$ of the underlying topological space of the mesh domain. Give your final answer as the exact value of $\\chi$ (a single integer, without units). No rounding is required.", "solution": "The problem statement is a well-posed exercise in elementary algebraic topology and computational geometry, specifically concerning the data structures of a two-dimensional simplicial complex. All provided data—the vertex set $\\mathcal{V}$, their coordinates, and the triangle set $\\mathcal{T}$—are self-contained, consistent, and scientifically grounded. The problem asks for the computation of standard mesh-related entities and the Euler characteristic, based on first principles. The problem is therefore deemed **valid**, and we proceed with the solution.\n\nThe provided mesh consists of:\n- Number of vertices, $|\\mathcal{V}| = V = 6$.\n- Number of triangles (2-simplices), $|\\mathcal{T}| = F = 4$.\n\nOur first task is to determine the set of unique edges ($1$-simplices) and construct the oriented edge-to-vertex incidence matrix $B$. An edge is a pair of vertices, and we extract these pairs from the triangle list $\\mathcal{T}=\\{(1,2,3),\\,(2,4,3),\\,(2,5,4),\\,(5,6,4)\\}$.\n\nThe edges from each triangle are:\n- From $T_1=(1,2,3)$: $\\{1,2\\}, \\{2,3\\}, \\{1,3\\}$\n- From $T_2=(2,4,3)$: $\\{2,4\\}, \\{4,3\\}, \\{2,3\\}$\n- From $T_3=(2,5,4)$: $\\{2,5\\}, \\{5,4\\}, \\{2,4\\}$\n- From $T_4=(5,6,4)$: $\\{5,6\\}, \\{6,4\\}, \\{5,4\\}$\n\nThe set of unique unordered edges $\\mathcal{E}_{\\text{unordered}}$ is the union of these sets:\n$$\n\\mathcal{E}_{\\text{unordered}} = \\{\\{1,2\\}, \\{1,3\\}, \\{2,3\\}, \\{2,4\\}, \\{3,4\\}, \\{2,5\\}, \\{4,5\\}, \\{4,6\\}, \\{5,6\\}\\}\n$$\nThe total number of unique edges is $|\\mathcal{E}| = E = 9$.\n\nWe now fix an orientation for each edge by ordering the vertices by their index, from lower to higher. This gives the oriented edge set $\\mathcal{E}$:\n- $e_1 = (1,2)$\n- $e_2 = (1,3)$\n- $e_3 = (2,3)$\n- $e_4 = (2,4)$\n- $e_5 = (2,5)$\n- $e_6 = (3,4)$\n- $e_7 = (4,5)$\n- $e_8 = (4,6)$\n- $e_9 = (5,6)$\n\nThe oriented edge-to-vertex incidence matrix $B \\in \\mathbb{R}^{9 \\times 6}$ is constructed according to the rule: for an edge $e=(i,j)$ with $i<j$, the corresponding row in $B$ has $B_{e,i} = -1$ and $B_{e,j} = +1$, and all other entries are $0$.\n$$\nB = \n\\begin{pmatrix}\n% v1  v2  v3  v4  v5  v6\n -1 & +1 &  0 &  0 &  0 &  0 \\\\ % e1=(1,2)\n -1 &  0 & +1 &  0 &  0 &  0 \\\\ % e2=(1,3)\n  0 & -1 & +1 &  0 &  0 &  0 \\\\ % e3=(2,3)\n  0 & -1 &  0 & +1 &  0 &  0 \\\\ % e4=(2,4)\n  0 & -1 &  0 &  0 & +1 &  0 \\\\ % e5=(2,5)\n  0 &  0 & -1 & +1 &  0 &  0 \\\\ % e6=(3,4)\n  0 &  0 &  0 & -1 & +1 &  0 \\\\ % e7=(4,5)\n  0 &  0 &  0 & -1 &  0 & +1 \\\\ % e8=(4,6)\n  0 &  0 &  0 &  0 & -1 & +1   % e9=(5,6)\n\\end{pmatrix}\n$$\n\nNext, we compute the valence $d_v$ for each vertex $v \\in \\mathcal{V}$. The valence is the number of edges incident to the vertex, which is equivalent to the number of non-zero entries in the corresponding column of the incidence matrix $B$.\n- $d_1$: Vertex $1$ is in edges $e_1=(1,2)$ and $e_2=(1,3)$. So, $d_1 = 2$.\n- $d_2$: Vertex $2$ is in edges $e_1=(1,2)$, $e_3=(2,3)$, $e_4=(2,4)$, and $e_5=(2,5)$. So, $d_2 = 4$.\n- $d_3$: Vertex $3$ is in edges $e_2=(1,3)$, $e_3=(2,3)$, and $e_6=(3,4)$. So, $d_3 = 3$.\n- $d_4$: Vertex $4$ is in edges $e_4=(2,4)$, $e_6=(3,4)$, $e_7=(4,5)$, and $e_8=(4,6)$. So, $d_4 = 4$.\n- $d_5$: Vertex $5$ is in edges $e_5=(2,5)$, $e_7=(4,5)$, and $e_9=(5,6)$. So, $d_5 = 3$.\n- $d_6$: Vertex $6$ is in edges $e_8=(4,6)$ and $e_9=(5,6)$. So, $d_6 = 2$.\n\nThen, we construct the symmetric edge-edge adjacency matrix $A_e \\in \\mathbb{R}^{9 \\times 9}$. An entry $(A_e)_{ij}$ is $1$ if edges $e_i$ and $e_j$ share a common vertex (and $i \\neq j$), and $0$ otherwise. The diagonal entries are $0$. We systematically check adjacency for each edge pair based on our oriented edge list $\\mathcal{E}$.\nFor example, $e_1=(1,2)$ is adjacent to $e_2=(1,3)$ because they share vertex $1$. It is also adjacent to $e_3=(2,3)$, $e_4=(2,4)$, and $e_5=(2,5)$ through vertex $2$. Thus, row $1$ of $A_e$ has $1$s in columns $2, 3, 4, 5$. Proceeding in this manner for all edges yields the matrix:\n$$\nA_e = \n\\begin{pmatrix}\n%e1 e2 e3 e4 e5 e6 e7 e8 e9\n 0 & 1 & 1 & 1 & 1 & 0 & 0 & 0 & 0 \\\\\n 1 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 0 \\\\\n 1 & 1 & 0 & 1 & 1 & 1 & 0 & 0 & 0 \\\\\n 1 & 0 & 1 & 0 & 1 & 1 & 1 & 1 & 0 \\\\\n 1 & 0 & 1 & 1 & 0 & 0 & 1 & 0 & 1 \\\\\n 0 & 1 & 1 & 1 & 0 & 0 & 1 & 1 & 0 \\\\\n 0 & 0 & 0 & 1 & 1 & 1 & 0 & 1 & 1 \\\\\n 0 & 0 & 0 & 1 & 0 & 1 & 1 & 0 & 1 \\\\\n 0 & 0 & 0 & 0 & 1 & 0 & 1 & 1 & 0 \n\\end{pmatrix}\n$$\n\nNext, we distinguish between boundary and interior edges. An edge is a boundary edge if it belongs to exactly one triangle, and an interior edge if it belongs to exactly two. We examine each edge from our unique list $\\mathcal{E}$ against the triangle list $\\mathcal{T}$.\n- $e_1=(1,2)$: in $T_1$. Count=$1$. Boundary.\n- $e_2=(1,3)$: in $T_1$. Count=$1$. Boundary.\n- $e_3=(2,3)$: in $T_1, T_2$. Count=$2$. Interior.\n- $e_4=(2,4)$: in $T_2, T_3$. Count=$2$. Interior.\n- $e_5=(2,5)$: in $T_3$. Count=$1$. Boundary.\n- $e_6=(3,4)$: in $T_2$. Count=$1$. Boundary.\n- $e_7=(4,5)$: in $T_3, T_4$. Count=$2$. Interior.\n- $e_8=(4,6)$: in $T_4$. Count=$1$. Boundary.\n- $e_9=(5,6)$: in $T_4$. Count=$1$. Boundary.\n\nSummary of edge classification:\n- Boundary edges: $\\{(1,2), (1,3), (2,5), (3,4), (4,6), (5,6)\\}$. There are $6$ boundary edges.\n- Interior edges: $\\{(2,3), (2,4), (4,5)\\}$. There are $3$ interior edges.\nThe total is $6+3=9$ edges, which is consistent.\n\nFinally, we compute the Euler characteristic $\\chi$ of the simplicial complex. The formula is $\\chi = V - E + F$, where $V$ is the number of vertices, $E$ is the number of edges, and $F$ is the number of faces (triangles).\nUsing the counts derived from the problem statement and our analysis:\n- $V = |\\mathcal{V}| = 6$\n- $E = |\\mathcal{E}| = 9$\n- $F = |\\mathcal{T}| = 4$\n\nSubstituting these values into the formula:\n$$\n\\chi = 6 - 9 + 4 = 1\n$$\nThis result is consistent with the fact that the given mesh tiles a rectangular domain, which is a contractible space (topologically a disk), for which the Euler characteristic is known to be $1$.", "answer": "$$\\boxed{1}$$", "id": "2575961"}, {"introduction": "Building upon the concept of mesh entities, this exercise explores their geometric properties and connection to fundamental physical laws. You will compute the oriented area vectors for all faces of a closed polyhedral cell and demonstrate that their sum is the zero vector, $\\boldsymbol{S} = \\boldsymbol{0}$. This calculation provides a concrete verification of a discrete form of the Divergence Theorem, which is indispensable for modeling physical conservation laws on a computational grid [@problem_id:2576002].", "problem": "In a three-dimensional finite element mesh, a polyhedral cell is represented as an oriented hexahedron. Consider the cell that is the affine image of the unit cube under the mapping $\\boldsymbol{x}(\\alpha,\\beta,\\gamma) = \\alpha \\boldsymbol{v}_1 + \\beta \\boldsymbol{v}_2 + \\gamma \\boldsymbol{v}_3$ with $\\alpha,\\beta,\\gamma \\in [0,1]$, where the edge vectors are\n$\\boldsymbol{v}_1 = (2,1,0)$, $\\boldsymbol{v}_2 = (1,2,1)$, and $\\boldsymbol{v}_3 = (0,1,3)$.\nThe boundary of this cell consists of six planar faces, each spanned by two of the edge vectors and oriented outward according to the right-hand rule induced by the sign of the scalar triple product $\\boldsymbol{v}_1 \\cdot (\\boldsymbol{v}_2 \\times \\boldsymbol{v}_3)$.\n\nUsing mesh-topological notions of boundary entities, for each face $f$ define its outward unit normal $\\boldsymbol{n}_f$ and area $A_f$, and denote by $\\boldsymbol{a}_f = A_f \\boldsymbol{n}_f$ the oriented area vector. Compute the oriented sum\n$$\n\\boldsymbol{S} \\equiv \\sum_{f \\in \\partial K} \\boldsymbol{a}_f\n$$\nby parameterizing each face with its spanning edge vectors and determining its outward orientation consistently with the cell orientation. Then, verify that this sum is the zero vector, expressing a discrete manifestation of the divergence theorem (Gauss’s law) for the constant vector field. Provide the final result for $\\boldsymbol{S}$ as a $1 \\times 3$ row matrix. No rounding is required and no physical units are needed.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Cell definition: An affine image of the unit cube defined by the mapping $\\boldsymbol{x}(\\alpha,\\beta,\\gamma) = \\alpha \\boldsymbol{v}_1 + \\beta \\boldsymbol{v}_2 + \\gamma \\boldsymbol{v}_3$.\n- Parameter range: $\\alpha, \\beta, \\gamma \\in [0,1]$.\n- Edge vectors: $\\boldsymbol{v}_1 = (2,1,0)$, $\\boldsymbol{v}_2 = (1,2,1)$, $\\boldsymbol{v}_3 = (0,1,3)$.\n- Boundary faces: Six planar faces, each spanned by two edge vectors.\n- Orientation rule: Outward normal is defined by the right-hand rule, consistent with the sign of the scalar triple product $V = \\boldsymbol{v}_1 \\cdot (\\boldsymbol{v}_2 \\times \\boldsymbol{v}_3)$.\n- Oriented area vector: $\\boldsymbol{a}_f = A_f \\boldsymbol{n}_f$.\n- Task: Compute the sum $\\boldsymbol{S} \\equiv \\sum_{f \\in \\partial K} \\boldsymbol{a}_f$ and verify it is the zero vector.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is based on fundamental principles of vector calculus and linear algebra, specifically the properties of parallelepipeds, vector cross products, and their relation to the Divergence Theorem. These concepts are central to physics and engineering, particularly in fields like fluid dynamics and electromagnetism, and their computational treatment in finite element analysis.\n- **Well-Posedness:** The problem provides all necessary data (the three edge vectors) and a clear, unambiguous objective. The underlying mathematical structure guarantees a unique solution.\n- **Objectivity:** The problem is stated in precise mathematical language, free from subjective or ambiguous terminology.\n- **Consistency and Completeness:** The data and constraints are self-contained and free of contradictions.\n\n**Verdict:** The problem is valid. It is a well-posed exercise in vector algebra with direct relevance to the geometric foundations of continuum mechanics and computational methods.\n\nThe problem requires the computation of the sum of oriented area vectors over the boundary of a closed volume, a parallelepiped denoted by $K$. This sum is a discrete representation of the surface integral $\\oint_{\\partial K} d\\boldsymbol{S}$, where $d\\boldsymbol{S} = \\boldsymbol{n} dS$. According to the Divergence Theorem, for any constant vector field $\\boldsymbol{C}$, we have $\\int_K (\\nabla \\cdot \\boldsymbol{C}) dV = \\oint_{\\partial K} \\boldsymbol{C} \\cdot d\\boldsymbol{S}$. Since $\\nabla \\cdot \\boldsymbol{C} = 0$ for a constant field, we have $\\oint_{\\partial K} \\boldsymbol{C} \\cdot d\\boldsymbol{S} = \\boldsymbol{C} \\cdot \\oint_{\\partial K} d\\boldsymbol{S} = 0$. As this must hold for any arbitrary constant vector $\\boldsymbol{C}$, it follows that the vector area of any closed surface must be the zero vector:\n$$\n\\oint_{\\partial K} d\\boldsymbol{S} = \\boldsymbol{0}\n$$\nThe problem is a verification of this fundamental geometric identity for a specific case. We proceed with the explicit calculation.\n\nThe cell $K$ is a parallelepiped defined by the origin and the three edge vectors $\\boldsymbol{v}_1 = (2,1,0)$, $\\boldsymbol{v}_2 = (1,2,1)$, and $\\boldsymbol{v}_3 = (0,1,3)$. Its boundary $\\partial K$ is composed of six faces, forming three pairs of parallel parallelograms.\n\nFirst, we determine the orientation of the cell by computing the scalar triple product $V$:\n$$\nV = \\boldsymbol{v}_1 \\cdot (\\boldsymbol{v}_2 \\times \\boldsymbol{v}_3)\n$$\nWe calculate the cross product $\\boldsymbol{v}_2 \\times \\boldsymbol{v}_3$:\n$$\n\\boldsymbol{v}_2 \\times \\boldsymbol{v}_3 = \\begin{vmatrix} \\boldsymbol{i} & \\boldsymbol{j} & \\boldsymbol{k} \\\\ 1 & 2 & 1 \\\\ 0 & 1 & 3 \\end{vmatrix} = \\boldsymbol{i}(2 \\cdot 3 - 1 \\cdot 1) - \\boldsymbol{j}(1 \\cdot 3 - 1 \\cdot 0) + \\boldsymbol{k}(1 \\cdot 1 - 2 \\cdot 0) = (5, -3, 1)\n$$\nNow, we compute the dot product with $\\boldsymbol{v}_1$:\n$$\nV = (2,1,0) \\cdot (5, -3, 1) = 2(5) + 1(-3) + 0(1) = 10 - 3 = 7\n$$\nSince $V = 7 > 0$, the set of vectors $\\{\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\boldsymbol{v}_3\\}$ forms a right-handed system. This will be used to determine the direction of the outward normals.\n\nThe boundary $\\partial K$ consists of faces located at $\\alpha=0, \\alpha=1$; $\\beta=0, \\beta=1$; and $\\gamma=0, \\gamma=1$. The oriented area vector $\\boldsymbol{a}_f$ for each face is its area multiplied by its outward unit normal. For a parallelogram spanned by vectors $\\boldsymbol{u}$ and $\\boldsymbol{w}$, the oriented area vector is $\\boldsymbol{u} \\times \\boldsymbol{w}$, with the sign chosen to ensure the vector points outward from the volume $K$.\n\nLet us analyze the three pairs of faces:\n\n**1. Faces at $\\alpha=0$ and $\\alpha=1$:**\nThese faces are spanned by the vectors $\\boldsymbol{v}_2$ and $\\boldsymbol{v}_3$. The unoriented area vector is $\\boldsymbol{A}_{23} = \\boldsymbol{v}_2 \\times \\boldsymbol{v}_3 = (5, -3, 1)$. The vector from the face at $\\alpha=0$ to the face at $\\alpha=1$ is $\\boldsymbol{v}_1$. An outward normal must have a positive projection onto $\\boldsymbol{v}_1$ for the face at $\\alpha=1$ and a negative projection for the face at $\\alpha=0$.\nThe projection of $\\boldsymbol{A}_{23}$ onto $\\boldsymbol{v}_1$ is $\\boldsymbol{A}_{23} \\cdot \\boldsymbol{v}_1 = (\\boldsymbol{v}_2 \\times \\boldsymbol{v}_3) \\cdot \\boldsymbol{v}_1 = V = 7 > 0$.\nThus, $\\boldsymbol{A}_{23}$ points outward from the face at $\\alpha=1$. The corresponding oriented area vector is $\\boldsymbol{a}_{\\alpha=1} = +\\boldsymbol{A}_{23}$.\nFor the face at $\\alpha=0$, the outward normal must be in the opposite direction, so $\\boldsymbol{a}_{\\alpha=0} = -\\boldsymbol{A}_{23}$.\nThe sum for this pair is $\\boldsymbol{a}_{\\alpha=0} + \\boldsymbol{a}_{\\alpha=1} = -\\boldsymbol{A}_{23} + \\boldsymbol{A}_{23} = \\boldsymbol{0}$.\n\n**2. Faces at $\\beta=0$ and $\\beta=1$:**\nThese faces are spanned by $\\boldsymbol{v}_3$ and $\\boldsymbol{v}_1$. The unoriented area vector is $\\boldsymbol{A}_{31} = \\boldsymbol{v}_3 \\times \\boldsymbol{v}_1$.\n$$\n\\boldsymbol{A}_{31} = \\boldsymbol{v}_3 \\times \\boldsymbol{v}_1 = \\begin{vmatrix} \\boldsymbol{i} & \\boldsymbol{j} & \\boldsymbol{k} \\\\ 0 & 1 & 3 \\\\ 2 & 1 & 0 \\end{vmatrix} = \\boldsymbol{i}(1 \\cdot 0 - 3 \\cdot 1) - \\boldsymbol{j}(0 \\cdot 0 - 3 \\cdot 2) + \\boldsymbol{k}(0 \\cdot 1 - 1 \\cdot 2) = (-3, 6, -2)\n$$\nThe vector from the face at $\\beta=0$ to the face at $\\beta=1$ is $\\boldsymbol{v}_2$. We check the projection of $\\boldsymbol{A}_{31}$ onto $\\boldsymbol{v}_2$:\n$\\boldsymbol{A}_{31} \\cdot \\boldsymbol{v}_2 = (\\boldsymbol{v}_3 \\times \\boldsymbol{v}_1) \\cdot \\boldsymbol{v}_2$. Using the cyclic property of the scalar triple product, this is equal to $\\boldsymbol{v}_1 \\cdot (\\boldsymbol{v}_2 \\times \\boldsymbol{v}_3) = V = 7 > 0$.\nSo, $\\boldsymbol{A}_{31}$ points outward from the face at $\\beta=1$. The oriented area vector is $\\boldsymbol{a}_{\\beta=1} = +\\boldsymbol{A}_{31}$.\nFor the face at $\\beta=0$, the outward normal is opposite, so $\\boldsymbol{a}_{\\beta=0} = -\\boldsymbol{A}_{31}$.\nThe sum for this pair is $\\boldsymbol{a}_{\\beta=0} + \\boldsymbol{a}_{\\beta=1} = -\\boldsymbol{A}_{31} + \\boldsymbol{A}_{31} = \\boldsymbol{0}$.\n\n**3. Faces at $\\gamma=0$ and $\\gamma=1$:**\nThese faces are spanned by $\\boldsymbol{v}_1$ and $\\boldsymbol{v}_2$. The unoriented area vector is $\\boldsymbol{A}_{12} = \\boldsymbol{v}_1 \\times \\boldsymbol{v}_2$.\n$$\n\\boldsymbol{A}_{12} = \\boldsymbol{v}_1 \\times \\boldsymbol{v}_2 = \\begin{vmatrix} \\boldsymbol{i} & \\boldsymbol{j} & \\boldsymbol{k} \\\\ 2 & 1 & 0 \\\\ 1 & 2 & 1 \\end{vmatrix} = \\boldsymbol{i}(1 \\cdot 1 - 0 \\cdot 2) - \\boldsymbol{j}(2 \\cdot 1 - 0 \\cdot 1) + \\boldsymbol{k}(2 \\cdot 2 - 1 \\cdot 1) = (1, -2, 3)\n$$\nThe vector from the face at $\\gamma=0$ to the face at $\\gamma=1$ is $\\boldsymbol{v}_3$. We check the projection of $\\boldsymbol{A}_{12}$ onto $\\boldsymbol{v}_3$:\n$\\boldsymbol{A}_{12} \\cdot \\boldsymbol{v}_3 = (\\boldsymbol{v}_1 \\times \\boldsymbol{v}_2) \\cdot \\boldsymbol{v}_3 = V = 7 > 0$.\nSo, $\\boldsymbol{A}_{12}$ points outward from the face at $\\gamma=1$. The oriented area vector is $\\boldsymbol{a}_{\\gamma=1} = +\\boldsymbol{A}_{12}$.\nFor the face at $\\gamma=0$, the outward normal is opposite, so $\\boldsymbol{a}_{\\gamma=0} = -\\boldsymbol{A}_{12}$.\nThe sum for this pair is $\\boldsymbol{a}_{\\gamma=0} + \\boldsymbol{a}_{\\gamma=1} = -\\boldsymbol{A}_{12} + \\boldsymbol{A}_{12} = \\boldsymbol{0}$.\n\nThe total sum $\\boldsymbol{S}$ is the sum of the oriented area vectors of all six faces:\n$$\n\\boldsymbol{S} = (\\boldsymbol{a}_{\\alpha=0} + \\boldsymbol{a}_{\\alpha=1}) + (\\boldsymbol{a}_{\\beta=0} + \\boldsymbol{a}_{\\beta=1}) + (\\boldsymbol{a}_{\\gamma=0} + \\boldsymbol{a}_{\\gamma=1})\n$$\n$$\n\\boldsymbol{S} = (-\\boldsymbol{A}_{23} + \\boldsymbol{A}_{23}) + (-\\boldsymbol{A}_{31} + \\boldsymbol{A}_{31}) + (-\\boldsymbol{A}_{12} + \\boldsymbol{A}_{12})\n$$\n$$\n\\boldsymbol{S} = \\boldsymbol{0} + \\boldsymbol{0} + \\boldsymbol{0} = \\boldsymbol{0}\n$$\nTo be explicit with the computed vectors:\n$\\boldsymbol{a}_{\\alpha=0} = -(5, -3, 1) = (-5, 3, -1)$\n$\\boldsymbol{a}_{\\alpha=1} = +(5, -3, 1)$\n$\\boldsymbol{a}_{\\beta=0} = -(-3, 6, -2) = (3, -6, 2)$\n$\\boldsymbol{a}_{\\beta=1} = +(-3, 6, -2)$\n$\\boldsymbol{a}_{\\gamma=0} = -(1, -2, 3) = (-1, 2, -3)$\n$\\boldsymbol{a}_{\\gamma=1} = +(1, -2, 3)$\n\nSumming all six vectors:\n$$\n\\boldsymbol{S} = (-5, 3, -1) + (5, -3, 1) + (3, -6, 2) + (-3, 6, -2) + (-1, 2, -3) + (1, -2, 3) = (0, 0, 0)\n$$\nThe calculation confirms the theoretical result. The sum of the oriented area vectors over the closed boundary of the parallelepiped is the zero vector.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0\n\\end{pmatrix}\n}\n$$", "id": "2576002"}, {"introduction": "This final practice tackles a subtle yet critical implementation detail: ensuring normal vectors on boundary faces possess the correct outward orientation. The sign of a computed normal can depend on arbitrary choices like local vertex ordering, leading to errors when applying boundary conditions. This exercise challenges you to derive a robust algebraic protocol to determine the correct orientation based on the element's geometry, a vital skill for writing reliable finite element code [@problem_id:2576089].", "problem": "Consider a single $3$-dimensional simplex (a tetrahedron) in the Finite Element Method (FEM) setting. Let $\\hat{K} \\subset \\mathbb{R}^{3}$ be the reference tetrahedron with vertices $\\hat{\\boldsymbol{a}}_{0}$, $\\hat{\\boldsymbol{a}}_{1}$, $\\hat{\\boldsymbol{a}}_{2}$, $\\hat{\\boldsymbol{a}}_{3}$ and let $F:\\hat{K}\\to K$ be an isoparametric affine mapping onto a physical tetrahedron $K$ with vertices $\\boldsymbol{x}_{i}=F(\\hat{\\boldsymbol{a}}_{i})$ for $i\\in\\{0,1,2,3\\}$. Let $\\hat{f}\\subset \\partial\\hat{K}$ be a reference face with canonical local node ordering $(\\hat{\\boldsymbol{a}}_{i_{1}},\\hat{\\boldsymbol{a}}_{i_{2}},\\hat{\\boldsymbol{a}}_{i_{3}})$ inherited from $\\hat{K}$. On the physical face $f=F(\\hat{f})$, a local unit normal $\\boldsymbol{n}_{\\text{loc}}$ is computed from the chosen local node ordering $(\\boldsymbol{x}_{j_{1}},\\boldsymbol{x}_{j_{2}},\\boldsymbol{x}_{j_{3}})$ by taking the cross product of the corresponding edge vectors and normalizing.\n\nStarting only from the fundamental definition of a surface normal to a parametric surface $\\boldsymbol{x}(\\xi,\\eta)$ as proportional to $\\partial_{\\xi}\\boldsymbol{x}\\times \\partial_{\\eta}\\boldsymbol{x}$, and the linear change of variables induced by $F$, do the following:\n\n- Explain conceptually and derive algebraically how the orientation of the reference facet (i.e., the parity of the permutation mapping $(\\hat{\\boldsymbol{a}}_{i_{1}},\\hat{\\boldsymbol{a}}_{i_{2}},\\hat{\\boldsymbol{a}}_{i_{3}})$ to $(\\hat{\\boldsymbol{a}}_{j_{1}},\\hat{\\boldsymbol{a}}_{j_{2}},\\hat{\\boldsymbol{a}}_{j_{3}})$) and the orientation of $F$ (i.e., the sign of the Jacobian determinant of $F$) impact the sign of the computed physical normal $\\boldsymbol{n}_{\\text{loc}}$ on $f$.\n- Using only these principles, formulate a concrete correction protocol that produces the outward unit normal $\\boldsymbol{n}_{\\text{out}}$ of $K$ on $f$ by applying a scalar factor $s\\in\\{-1,+1\\}$ to $\\boldsymbol{n}_{\\text{loc}}$. Your protocol must be expressed as an explicit scalar expression for $s$ in terms of quantities that can be assembled from the element geometry and the chosen local node ordering, without invoking any external orientation data structures.\n\nThen apply your protocol to the specific tetrahedron with vertices\n$\\boldsymbol{x}_{0}=(0,0,0)$, $\\boldsymbol{x}_{1}=(1,0,0)$, $\\boldsymbol{x}_{2}=(0,1,0)$, $\\boldsymbol{x}_{3}=(0,0,1)$, and the face $f$ opposite $\\boldsymbol{x}_{3}$ lying in the plane $z=0$. Suppose the local node ordering used to compute $\\boldsymbol{n}_{\\text{loc}}$ on $f$ is $(\\boldsymbol{x}_{0},\\boldsymbol{x}_{1},\\boldsymbol{x}_{2})$. Compute the scalar correction factor $s\\in\\{-1,+1\\}$ produced by your protocol for this face. Provide the single value of $s$ as your final answer. No rounding is required.", "solution": "The problem posed is valid. It is a well-defined question in the field of computational geometry as applied to the Finite Element Method. It is scientifically grounded, internally consistent, and requires a rigorous derivation based on fundamental principles of vector calculus and linear algebra. We shall proceed.\n\nThe problem asks for two things: first, a conceptual explanation of how orientation affects the computed normal vector on a face of a tetrahedron; second, a concrete algebraic protocol to compute a correction factor $s$ to ensure this normal points outward. Finally, this protocol is to be applied to a specific case.\n\nLet us begin with the conceptual derivation. We consider a physical tetrahedron $K$ as the image of a reference tetrahedron $\\hat{K}$ under an affine mapping $F(\\hat{\\boldsymbol{x}}) = \\mathbf{B}\\hat{\\boldsymbol{x}} + \\boldsymbol{b}$. The Jacobian of this map is the constant matrix $\\mathbf{J}_F = \\mathbf{B}$, whose determinant $\\det(\\mathbf{J}_F)$ is proportional to the signed volume of the physical tetrahedron $K$. The sign of this determinant, $\\sigma_{F} = \\text{sgn}(\\det(\\mathbf{J}_F))$, defines the orientation of the mapping. If $\\sigma_{F}=+1$, the mapping is orientation-preserving; if $\\sigma_{F}=-1$, it is orientation-reversing.\n\nA face $\\hat{f}$ of the reference element $\\hat{K}$ has a canonical ordering of vertices, say $(\\hat{\\boldsymbol{a}}_{i_1}, \\hat{\\boldsymbol{a}}_{i_2}, \\hat{\\boldsymbol{a}}_{i_3})$, which is conventionally chosen to produce an outward-pointing normal $\\hat{\\boldsymbol{n}}$ on $\\hat{K}$. The corresponding physical face $f=F(\\hat{f})$ inherits a canonical vertex ordering $(\\boldsymbol{x}_{i_1}, \\boldsymbol{x}_{i_2}, \\boldsymbol{x}_{i_3})$, which defines a canonical normal $\\boldsymbol{n}_{\\text{can}}$.\n\nThe relationship between a normal vector on a reference surface and its image on the physical surface is given by the Piola transformation. The transformed normal vector is proportional to $\\det(\\mathbf{J}_F)(\\mathbf{J}_F^{-T})\\hat{\\boldsymbol{n}}$. Consequently, the orientation of the canonical physical normal $\\boldsymbol{n}_{\\text{can}}$ relative to the true outward physical normal $\\boldsymbol{n}_{\\text{out}}$ depends on the orientation of the mapping $F$. If $F$ is orientation-preserving ($\\sigma_F = +1$), the outward normal of $\\hat{K}$ maps to the outward normal of $K$, so $\\boldsymbol{n}_{\\text{can}}$ has the same orientation as $\\boldsymbol{n}_{\\text{out}}$. If $F$ is orientation-reversing ($\\sigma_F = -1$), the outward normal of $\\hat{K}$ maps to an inward normal of $K$, so $\\boldsymbol{n}_{\\text{can}}$ has the opposite orientation to $\\boldsymbol{n}_{\\text{out}}$. Therefore, the orientation of $\\boldsymbol{n}_{\\text{out}}$ is related to the orientation of $\\boldsymbol{n}_{\\text{can}}$ by the factor $\\sigma_F$.\n\nThe second factor is the local node ordering used for computation. The computed local normal, $\\boldsymbol{n}_{\\text{loc}}$, is derived from a chosen ordering of vertices $(\\boldsymbol{x}_{j_1}, \\boldsymbol{x}_{j_2}, \\boldsymbol{x}_{j_3})$. This ordering is a permutation of the canonical ordering $(\\boldsymbol{x}_{i_1}, \\boldsymbol{x}_{i_2}, \\boldsymbol{x}_{i_3})$. The vector normal computed via the cross product, e.g., $(\\boldsymbol{v}_2 - \\boldsymbol{v}_1) \\times (\\boldsymbol{v}_3 - \\boldsymbol{v}_1)$, maintains its direction for any cyclic permutation of the vertices $(\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\boldsymbol{v}_3)$ and reverses its direction for any anti-cyclic permutation. Let $\\sigma_{\\pi} \\in \\{-1, +1\\}$ be the sign of the permutation that maps the canonical cyclic order to the chosen local cyclic order. Then the orientation of $\\boldsymbol{n}_{\\text{loc}}$ is related to the orientation of $\\boldsymbol{n}_{\\text{can}}$ by the factor $\\sigma_{\\pi}$.\n\nCombining these two effects, we have $\\boldsymbol{n}_{\\text{out}} \\propto \\sigma_{F} \\cdot \\boldsymbol{n}_{\\text{can}}$ and $\\boldsymbol{n}_{\\text{loc}} \\propto \\sigma_{\\pi} \\cdot \\boldsymbol{n}_{\\text{can}}$. The correction factor $s$ in $\\boldsymbol{n}_{\\text{out}} = s \\cdot \\boldsymbol{n}_{\\text{loc}}$ must reconcile these two relations, which leads to $s \\cdot \\sigma_{\\pi} = \\sigma_{F}$, or $s = \\sigma_{F} \\cdot \\sigma_{\\pi}$. This explains conceptually how both the Jacobian sign and the permutation parity determine the final sign of the normal.\n\nNow, we formulate a concrete correction protocol that does not require explicit knowledge of any canonical ordering or reference element data, as required. Let the face $f$ be defined by the vertices $\\{\\boldsymbol{x}_{j_1}, \\boldsymbol{x}_{j_2}, \\boldsymbol{x}_{j_3}\\}$ and let $\\boldsymbol{x}_k$ be the fourth vertex of the tetrahedron, not lying on $f$. The local ordering chosen for computation is $(\\boldsymbol{x}_{j_1}, \\boldsymbol{x}_{j_2}, \\boldsymbol{x}_{j_3})$.\n\nThe un-normalized local normal vector is computed as:\n$$\n\\boldsymbol{N}_{\\text{loc}} = (\\boldsymbol{x}_{j_2} - \\boldsymbol{x}_{j_1}) \\times (\\boldsymbol{x}_{j_3} - \\boldsymbol{x}_{j_1})\n$$\nThe unit local normal is $\\boldsymbol{n}_{\\text{loc}} = \\boldsymbol{N}_{\\text{loc}} / ||\\boldsymbol{N}_{\\text{loc}}||$.\nThe desired outward unit normal, $\\boldsymbol{n}_{\\text{out}}$, is defined by the property that it points away from the interior of the tetrahedron. This can be expressed by the condition that the vector from a point on the face (e.g., $\\boldsymbol{x}_{j_1}$) to the fourth vertex $\\boldsymbol{x}_k$ must form an obtuse angle with $\\boldsymbol{n}_{\\text{out}}$:\n$$\n(\\boldsymbol{x}_k - \\boldsymbol{x}_{j_1}) \\cdot \\boldsymbol{n}_{\\text{out}} < 0\n$$\nWe seek a scalar factor $s \\in \\{-1, +1\\}$ such that $\\boldsymbol{n}_{\\text{out}} = s \\cdot \\boldsymbol{n}_{\\text{loc}}$. Substituting this into the inequality gives:\n$$\n(\\boldsymbol{x}_k - \\boldsymbol{x}_{j_1}) \\cdot (s \\cdot \\boldsymbol{n}_{\\text{loc}}) < 0\n$$\nSince $s$ is a scalar, we have:\n$$\ns \\cdot \\left( (\\boldsymbol{x}_k - \\boldsymbol{x}_{j_1}) \\cdot \\frac{\\boldsymbol{N}_{\\text{loc}}}{||\\boldsymbol{N}_{\\text{loc}}||} \\right) < 0\n$$\nAs $||\\boldsymbol{N}_{\\text{loc}}|| > 0$ for a non-degenerate face, this is equivalent to:\n$$\ns \\cdot \\left( (\\boldsymbol{x}_k - \\boldsymbol{x}_{j_1}) \\cdot \\boldsymbol{N}_{\\text{loc}} \\right) < 0\n$$\nLet $V$ be the scalar triple product:\n$$\nV = (\\boldsymbol{x}_k - \\boldsymbol{x}_{j_1}) \\cdot ((\\boldsymbol{x}_{j_2} - \\boldsymbol{x}_{j_1}) \\times (\\boldsymbol{x}_{j_3} - \\boldsymbol{x}_{j_1}))\n$$\nThis value $V$ is proportional to the signed volume of the tetrahedron, and it is non-zero for a non-degenerate element. The condition becomes $s \\cdot V < 0$. This inequality is satisfied if and only if $s$ has the opposite sign of $V$. Therefore, the correction factor is given by:\n$$\ns = -\\text{sgn}(V)\n$$\nThis is the required correction protocol. It depends only on the coordinates of the four vertices and the chosen local ordering for the face normal computation.\n\nWe now apply this protocol to the specified case. The tetrahedron vertices are $\\boldsymbol{x}_{0}=(0,0,0)$, $\\boldsymbol{x}_{1}=(1,0,0)$, $\\boldsymbol{x}_{2}=(0,1,0)$, and $\\boldsymbol{x}_{3}=(0,0,1)$.\nThe face $f$ is opposite $\\boldsymbol{x}_{3}$, so its vertices are $\\{\\boldsymbol{x}_{0}, \\boldsymbol{x}_{1}, \\boldsymbol{x}_{2}\\}$. The fourth vertex is $\\boldsymbol{x}_{k}=\\boldsymbol{x}_3$.\nThe local node ordering used to compute $\\boldsymbol{n}_{\\text{loc}}$ is $(\\boldsymbol{x}_{0}, \\boldsymbol{x}_{1}, \\boldsymbol{x}_{2})$.\n\nWe identify the indices for our protocol:\n$j_1 = 0$, $j_2 = 1$, $j_3 = 2$, and $k = 3$.\nThe vectors required are:\n- $\\boldsymbol{x}_{j_2} - \\boldsymbol{x}_{j_1} = \\boldsymbol{x}_{1} - \\boldsymbol{x}_{0} = (1,0,0) - (0,0,0) = (1,0,0)$.\n- $\\boldsymbol{x}_{j_3} - \\boldsymbol{x}_{j_1} = \\boldsymbol{x}_{2} - \\boldsymbol{x}_{0} = (0,1,0) - (0,0,0) = (0,1,0)$.\n- $\\boldsymbol{x}_{k} - \\boldsymbol{x}_{j_1} = \\boldsymbol{x}_{3} - \\boldsymbol{x}_{0} = (0,0,1) - (0,0,0) = (0,0,1)$.\n\nFirst, compute the un-normalized normal vector:\n$$\n\\boldsymbol{N}_{\\text{loc}} = (\\boldsymbol{x}_{1} - \\boldsymbol{x}_{0}) \\times (\\boldsymbol{x}_{2} - \\boldsymbol{x}_{0}) = (1,0,0) \\times (0,1,0) = (0,0,1)\n$$\nNext, compute the scalar triple product $V$:\n$$\nV = (\\boldsymbol{x}_{3} - \\boldsymbol{x}_{0}) \\cdot \\boldsymbol{N}_{\\text{loc}} = (0,0,1) \\cdot (0,0,1) = 1\n$$\nThe value of $V$ is $1$.\nFinally, compute the correction factor $s$:\n$$\ns = -\\text{sgn}(V) = -\\text{sgn}(1) = -1\n$$\nThe local normal computed from the ordering $(\\boldsymbol{x}_{0}, \\boldsymbol{x}_{1}, \\boldsymbol{x}_{2})$ points along the positive $z$-axis. The tetrahedron body lies in the region $z>0$ near this face. Therefore, this normal is pointing inward. The correction factor must be $-1$ to produce the outward normal, which must point along the negative $z$-axis. Our protocol yields the correct result.", "answer": "$$\\boxed{-1}$$", "id": "2576089"}]}