{"hands_on_practices": [{"introduction": "Before constructing specific finite elements, it's essential to understand the fundamental algebraic conditions that guarantee interelement continuity. This exercise formalizes the concept of $C^1$ continuity by translating it into a set of precise requirements on the polynomial coefficients that describe the function and its derivatives along a shared edge. By focusing on this abstract representation, you will develop a deeper understanding of what it truly means for two adjacent elements to 'match up' smoothly, a principle that underpins all conforming finite element methods. [@problem_id:2553906]", "problem": "Consider two adjacent two-dimensional finite elements that share a straight common edge $e$ with endpoints mapped to the parameter interval $[-1,1]$ through an affine parametrization $t \\mapsto \\boldsymbol{x}(t)$. On each element, the finite element space is continuously differentiable to first order ($C^1$), and its edge traces are polynomials: the trace of the field $u$ along $e$ belongs to the polynomial space $\\mathbb{P}_p([-1,1])$, and the trace of the normal derivative $\\partial_{\\boldsymbol{n}} u := \\nabla u \\cdot \\boldsymbol{n}$ along $e$ belongs to $\\mathbb{P}_q([-1,1])$, where $\\boldsymbol{n}$ is a fixed unit normal chosen consistently on $e$ (the same $\\boldsymbol{n}$ is used to define both traces from the left and the right element). Let $u_L(t)$, $u_R(t) \\in \\mathbb{P}_p([-1,1])$ denote the left and right traces of $u$ on $e$, and let $\\lambda_L(t)$, $\\lambda_R(t) \\in \\mathbb{P}_q([-1,1])$ denote the corresponding traces of $\\partial_{\\boldsymbol{n}} u$. Assume that on each side these traces are represented in the monomial bases $\\{t^k\\}_{k=0}^p$ and $\\{t^k\\}_{k=0}^q$, respectively:\n$$\nu_L(t) = \\sum_{k=0}^{p} a_{L,k}\\, t^k,\\quad u_R(t) = \\sum_{k=0}^{p} a_{R,k}\\, t^k,\\quad\n\\lambda_L(t) = \\sum_{k=0}^{q} b_{L,k}\\, t^k,\\quad \\lambda_R(t) = \\sum_{k=0}^{q} b_{R,k}\\, t^k,\n$$\nwith coefficients $\\{a_{L,k}\\}_{k=0}^{p}$, $\\{a_{R,k}\\}_{k=0}^{p}$, $\\{b_{L,k}\\}_{k=0}^{q}$, and $\\{b_{R,k}\\}_{k=0}^{q}$ that are a priori independent.\n\nStarting from the definitions of continuity and the fundamental characterization of polynomial equality, do the following:\n\n1. Derive necessary and sufficient algebraic conditions on the edge coefficients that enforce continuity of $u$ and continuity of its normal derivative $\\partial_{\\boldsymbol{n}} u$ across $e$ in the sense that $u_L(t) = u_R(t)$ for all $t \\in [-1,1]$ and $\\lambda_L(t) = \\lambda_R(t)$ for all $t \\in [-1,1]$. Your derivation must be independent of any particular choice of nodal points or quadrature and should rely only on the fact that two polynomials in the same space are equal if and only if all coefficients in a common basis coincide.\n\n2. Using your result in part 1 and a dimension-counting argument, determine the minimal number of independent scalar linear constraints that must be imposed on the $2(p+1) + 2(q+1)$ edge coefficients to ensure these two continuities hold generically, assuming both elements use the same polynomial degrees $p$ and $q$ on $e$. Express your final answer as a closed-form analytic expression in terms of $p$ and $q$. No rounding is required, and no physical units apply.\n\nProvide only the final expression requested in part 2 as your final answer.", "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, and objective. It represents a standard theoretical question in the finite element method. There are no identifiable flaws. We may proceed with the solution.\n\nThe problem requires a derivation of continuity conditions across a shared element edge and a subsequent enumeration of these conditions. The derivation must be based on the fundamental principle of polynomial equality.\n\nA polynomial is uniquely determined by its coefficients in a given basis. Two polynomials, $P(t) = \\sum_{k=0}^{n} c_k \\phi_k(t)$ and $Q(t) = \\sum_{k=0}^{n} d_k \\phi_k(t)$, expressed in the same basis $\\{\\phi_k(t)\\}_{k=0}^{n}$, are equal for all $t$ in an interval if and only if their corresponding coefficients are equal, i.e., $c_k = d_k$ for all $k \\in \\{0, 1, \\dots, n\\}$. This follows from the linear independence of the basis functions. If $P(t) = Q(t)$, then their difference is the zero polynomial: $\\sum_{k=0}^{n} (c_k - d_k) \\phi_k(t) = 0$. The linear independence of $\\{\\phi_k(t)\\}$ implies that all coefficients of this linear combination must be zero, so $c_k - d_k = 0$. This establishes both necessity and sufficiency. We apply this principle to the given problem.\n\nThe monomial basis $\\{t^k\\}$ is a set of linearly independent functions on any interval, including $[-1, 1]$.\n\nPart $1$: Derivation of conditions.\n\nFirst, we enforce the continuity of the field $u$. The condition is that the trace from the left element, $u_L(t)$, must be identical to the trace from the right element, $u_R(t)$, for all $t \\in [-1, 1]$.\n$$\nu_L(t) = u_R(t) \\quad \\forall t \\in [-1, 1]\n$$\nSubstituting the given polynomial representations in the monomial basis:\n$$\n\\sum_{k=0}^{p} a_{L,k}\\, t^k = \\sum_{k=0}^{p} a_{R,k}\\, t^k\n$$\nThis equation can be rearranged to express the equality of two polynomials as a single polynomial being identically zero:\n$$\n\\sum_{k=0}^{p} a_{L,k}\\, t^k - \\sum_{k=0}^{p} a_{R,k}\\, t^k = 0\n$$\n$$\n\\sum_{k=0}^{p} (a_{L,k} - a_{R,k})\\, t^k = 0 \\quad \\forall t \\in [-1, 1]\n$$\nBased on the principle of polynomial equality stated above, for this polynomial of degree $p$ to be zero over an interval, all of its coefficients must be zero. This gives the following set of necessary and sufficient conditions on the coefficients $\\{a_{L,k}\\}$ and $\\{a_{R,k}\\}$:\n$$\na_{L,k} - a_{R,k} = 0 \\quad \\text{for } k = 0, 1, \\dots, p\n$$\nor equivalently,\n$$\na_{L,k} = a_{R,k} \\quad \\text{for } k = 0, 1, \\dots, p\n$$\n\nSecond, we enforce the continuity of the normal derivative, $\\partial_{\\boldsymbol{n}} u$. The condition is that the trace of the normal derivative from the left, $\\lambda_L(t)$, must equal the trace from the right, $\\lambda_R(t)$, for all $t \\in [-1, 1]$.\n$$\n\\lambda_L(t) = \\lambda_R(t) \\quad \\forall t \\in [-1, 1]\n$$\nSubstituting the polynomial representations from the space $\\mathbb{P}_q([-1,1])$:\n$$\n\\sum_{k=0}^{q} b_{L,k}\\, t^k = \\sum_{k=0}^{q} b_{R,k}\\, t^k\n$$\nFollowing the same logic as for the field $u$, we rearrange the equation:\n$$\n\\sum_{k=0}^{q} (b_{L,k} - b_{R,k})\\, t^k = 0 \\quad \\forall t \\in [-1, 1]\n$$\nThe linear independence of the monomial basis functions $\\{t^k\\}_{k=0}^q$ requires that each coefficient be zero. This yields the necessary and sufficient conditions on the coefficients $\\{b_{L,k}\\}$ and $\\{b_{R,k}\\}$:\n$$\nb_{L,k} - b_{R,k} = 0 \\quad \\text{for } k = 0, 1, \\dots, q\n$$\nor equivalently,\n$$\nb_{L,k} = b_{R,k} \\quad \\text{for } k = 0, 1, \\dots, q\n$$\nThis completes the derivation of the algebraic conditions.\n\nPart $2$: Counting the constraints.\n\nThe problem asks for the minimal number of independent scalar linear constraints imposed on the total set of $2(p+1) + 2(q+1)$ coefficients. A constraint is a linear algebraic equation that relates these coefficients.\n\nFor the continuity of the field $u$, the condition is $a_{L,k} = a_{R,k}$ for each value of the index $k$ from $0$ to $p$. The index $k$ takes on $p+1$ distinct integer values ($0, 1, \\dots, p$). Therefore, we have a set of $p+1$ linear equations. Each equation, $a_{L,k} - a_{R,k} = 0$, involves a unique pair of coefficients $(a_{L,k}, a_{R,k})$ that does not appear in any other equation in this set. Thus, these $p+1$ constraints are linearly independent.\n\nFor the continuity of the normal derivative $\\partial_{\\boldsymbol{n}} u$, the condition is $b_{L,k} = b_{R,k}$ for each value of the index $k$ from $0$ to $q$. The index $k$ takes on $q+1$ distinct integer values ($0, 1, \\dots, q$). This gives a set of $q+1$ linear equations. Similarly, these $q+1$ constraints are linearly independent.\n\nThe total set of coefficients is partitioned into $\\{a_{L,k}, a_{R,k}\\}$ and $\\{b_{L,k}, b_{R,k}\\}$. The first set of constraints involves only the 'a' coefficients, and the second set involves only the 'b' coefficients. Therefore, the two sets of constraints are themselves independent of each other.\n\nThe total number of independent scalar linear constraints is the sum of the number of constraints for the field and the number of constraints for its normal derivative.\nTotal number of constraints = (Number of constraints for $u$) + (Number of constraints for $\\partial_{\\boldsymbol{n}} u$)\n$$\n\\text{Total constraints} = (p+1) + (q+1)\n$$\nSimplifying this expression gives the final result:\n$$\n\\text{Total constraints} = p+q+2\n$$\nThis is the minimal number of constraints required to ensure $C^1$ continuity across the edge in the sense defined by the problem. This can be viewed through a dimension-counting argument. The initial dimension of the coefficient space is $2(p+1) + 2(q+1)$. After enforcing continuity, the degrees of freedom are reduced to $(p+1) + (q+1)$, as the coefficients from one element determine the coefficients on the adjacent element. The reduction in dimension, which is the number of constraints, is $[2(p+1) + 2(q+1)] - [(p+1) + (q+1)] = (p+1) + (q+1) = p+q+2$.", "answer": "$$\\boxed{p+q+2}$$", "id": "2553906"}, {"introduction": "With the abstract conditions for interelement compatibility established, we now turn to a concrete application: the construction of a $C^1$-conforming element. This practice guides you through the step-by-step derivation of the bicubic Hermite element, a classic tool used for problems requiring smooth solutions, such as in the theory of plate bending. By building the shape functions from one-dimensional Hermite polynomials, you will see firsthand how the degrees of freedom at the nodes, which include derivative values, enforce continuity of both the function and its gradients across element boundaries. [@problem_id:2553873]", "problem": "Let the reference element be the rectangle $\\Omega_{e} = \\{ (\\xi,\\eta) \\,:\\, \\xi \\in [-1,1], \\ \\eta \\in [-1,1] \\}$. Consider approximating a scalar field $u(\\xi,\\eta)$ by a bicubic polynomial on $\\Omega_{e}$ that is suitable for use in the Finite Element Method (FEM). The target is to construct a two-dimensional cubic Hermite element that enforces continuity of first derivatives (denoted $C^1$ continuity) across interelement boundaries on a mesh of axis-aligned rectangles.\n\nStarting from the core definition that $C^1$ interelement compatibility requires the trace of $u$ and its first derivatives to be continuous across any common edge, proceed as follows:\n\n1) In one dimension on the interval $[-1,1]$, derive four cubic polynomials $H_{1}(\\xi)$, $H_{2}(\\xi)$, $H_{3}(\\xi)$, $H_{4}(\\xi)$ that serve as the Hermite basis associated with nodal data at the endpoints $\\xi=-1$ and $\\xi=1$. Specifically, require that each $H_{i}$ satisfies the interpolation conditions that ensure exact reproduction of the nodal value and nodal first derivative at its associated endpoint and vanishing of the same quantities at the opposite endpoint. Concretely, for the endpoint at $\\xi=-1$, enforce $H_{1}(-1)=1$, $H_{1}'(-1)=0$, $H_{1}(1)=0$, $H_{1}'(1)=0$ and $H_{2}(-1)=0$, $H_{2}'(-1)=1$, $H_{2}(1)=0$, $H_{2}'(1)=0$. For the endpoint at $\\xi=1$, enforce $H_{3}(-1)=0$, $H_{3}'(-1)=0$, $H_{3}(1)=1$, $H_{3}'(1)=0$ and $H_{4}(-1)=0$, $H_{4}'(-1)=0$, $H_{4}(1)=0$, $H_{4}'(1)=1$.\n\n2) Using the tensor-product construction on $\\Omega_{e}$, build the bicubic Hermite shape functions for the $16$ nodal quantities located at the four corners $(\\xi,\\eta) \\in \\{(-1,-1),(1,-1),(1,1),(-1,1)\\}$, where at each corner the degrees of freedom are $\\{u, u_{,\\xi}, u_{,\\eta}, u_{,\\xi\\eta}\\}$. The shape function for each nodal quantity must be a product of appropriate one-dimensional Hermite polynomials in $\\xi$ and $\\eta$ matching its role as a value, first derivative in $\\xi$, first derivative in $\\eta$, or mixed derivative in $\\xi$ and $\\eta$.\n\n3) Justify from the definition of $C^1$ continuity which nodal quantities must be shared (assembled to be single-valued) between two adjacent rectangular elements that meet along a common edge, and explain briefly why the tensor-product construction satisfies $C^1$ along edges when those quantities are shared.\n\nFinally, evaluate the shape function corresponding to the nodal displacement $u$ at the corner $(\\xi,\\eta)=(1,1)$ at the parametric point $(\\xi,\\eta)=(\\tfrac{1}{2},-\\tfrac{1}{2})$. Provide this value as your final answer. No rounding is required; give the exact value.", "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information for a unique solution. It is a standard problem in the theory of the Finite Element Method. We proceed with the solution.\n\nFirst, we derive the one-dimensional cubic Hermite basis functions on the interval $\\xi \\in [-1,1]$. A general cubic polynomial may be written as $p(\\xi) = a\\xi^3 + b\\xi^2 + c\\xi + d$, with its derivative being $p'(\\xi) = 3a\\xi^2 + 2b\\xi + c$. We must find four such polynomials, $H_1(\\xi)$, $H_2(\\xi)$, $H_3(\\xi)$, and $H_4(\\xi)$, each satisfying a set of four given interpolation conditions.\n\nFor $H_1(\\xi)$, the conditions are $H_1(-1)=1$, $H_1'(-1)=0$, $H_1(1)=0$, and $H_1'(1)=0$. These lead to the following system of linear equations for the coefficients $(a,b,c,d)$:\n$$\n\\begin{cases}\n-a + b - c + d = 1 \\\\\na + b + c + d = 0 \\\\\n3a - 2b + c = 0 \\\\\n3a + 2b + c = 0\n\\end{cases}\n$$\nFrom the last two equations, subtracting one from the other yields $4b=0$, so $b=0$. Adding them gives $6a+2c=0$, so $c=-3a$. Substituting $b=0$ and $c=-3a$ into the first two equations gives $-a+3a+d=1$ (i.e., $2a+d=1$) and $a-3a+d=0$ (i.e., $-2a+d=0$). From the second of these, $d=2a$. Substituting this into the first gives $2a+2a=1$, so $a=1/4$. Consequently, $d=1/2$, $c=-3/4$, and $b=0$. The polynomial is:\n$$H_1(\\xi) = \\frac{1}{4}\\xi^3 - \\frac{3}{4}\\xi + \\frac{1}{2}$$\n\nFor $H_2(\\xi)$, the conditions are $H_2(-1)=0$, $H_2'(-1)=1$, $H_2(1)=0$, and $H_2'(1)=0$. The system is:\n$$\n\\begin{cases}\n-a + b - c + d = 0 \\\\\na + b + c + d = 0 \\\\\n3a - 2b + c = 1 \\\\\n3a + 2b + c = 0\n\\end{cases}\n$$\nThe first two equations imply $b+d=0$ and $a+c=0$, so $d=-b$ and $c=-a$. The last two equations give $6a+2c=1$ and $-4b=1$. From $-4b=1$, we have $b=-1/4$, so $d=1/4$. From $6a+2c=1$ and $c=-a$, we have $6a-2a=1$, which gives $a=1/4$. Thus, $c=-1/4$. The polynomial is:\n$$H_2(\\xi) = \\frac{1}{4}\\xi^3 - \\frac{1}{4}\\xi^2 - \\frac{1}{4}\\xi + \\frac{1}{4}$$\n\nThe functions $H_3(\\xi)$ and $H_4(\\xi)$ can be found by symmetry. $H_3(\\xi)$ must satisfy $H_3(-1)=0$, $H_3'(-1)=0$, $H_3(1)=1$, $H_3'(1)=0$. These are the same conditions that $H_1(-\\xi)$ satisfies. Therefore, $H_3(\\xi) = H_1(-\\xi)$:\n$$H_3(\\xi) = \\frac{1}{4}(-\\xi)^3 - \\frac{3}{4}(-\\xi) + \\frac{1}{2} = -\\frac{1}{4}\\xi^3 + \\frac{3}{4}\\xi + \\frac{1}{2}$$\nSimilarly, $H_4(\\xi)$ must satisfy $H_4(-1)=0$, $H_4'(-1)=0$, $H_4(1)=0$, $H_4'(1)=1$. These conditions are satisfied by $-H_2(-\\xi)$. Therefore, $H_4(\\xi) = -H_2(-\\xi)$:\n$$H_4(\\xi) = - \\left( \\frac{1}{4}(-\\xi)^3 - \\frac{1}{4}(-\\xi)^2 - \\frac{1}{4}(-\\xi) + \\frac{1}{4} \\right) = \\frac{1}{4}\\xi^3 + \\frac{1}{4}\\xi^2 - \\frac{1}{4}\\xi - \\frac{1}{4}$$\n\nNext, we construct the bicubic Hermite shape functions on the reference square $\\Omega_e$ using a tensor-product construction. The $16$ degrees of freedom (DOFs) are the values of the function $u$, its first derivatives $u_{,\\xi}$ and $u_{,\\eta}$, and its mixed derivative $u_{,\\xi\\eta}$ at the four corners $(\\xi_i, \\eta_j)$ where $\\xi_i, \\eta_j \\in \\{-1,1\\}$. The approximation $u_h(\\xi, \\eta)$ is a linear combination of $16$ shape functions, each multiplying a nodal DOF. A shape function $N(\\xi,\\eta)$ is a product of a one-dimensional basis function in $\\xi$ and one in $\\eta$. Let's distinguish between basis functions for function values, which we call \"value\" functions ($H_1, H_3$), and those for derivative values, \"derivative\" functions ($H_2, H_4$). The shape function for a particular DOF is constructed by choosing the 1D function in each variable that corresponds to that DOF type. For example, the shape function for the DOF $u_{,\\xi}$ at a corner involves a \"derivative\" function in $\\xi$ and a \"value\" function in $\\eta$. At a corner with coordinates $(\\xi_i, \\eta_j)$, the four shape functions are:\n-   For $u$: $N^u(\\xi,\\eta) = H_{val}(\\xi, \\xi_i) H_{val}(\\eta, \\eta_j)$\n-   For $u_{,\\xi}$: $N^{u_\\xi}(\\xi,\\eta) = H_{der}(\\xi, \\xi_i) H_{val}(\\eta, \\eta_j)$\n-   For $u_{,\\eta}$: $N^{u_\\eta}(\\xi,\\eta) = H_{val}(\\xi, \\xi_i) H_{der}(\\eta, \\eta_j)$\n-   For $u_{,\\xi\\eta}$: $N^{u_{\\xi\\eta}}(\\xi,\\eta) = H_{der}(\\xi, \\xi_i) H_{der}(\\eta, \\eta_j)$\nwhere $H_{val}(\\cdot, -1)=H_1$, $H_{der}(\\cdot, -1)=H_2$, $H_{val}(\\cdot, 1)=H_3$, and $H_{der}(\\cdot, 1)=H_4$.\n\nWe now justify $C^1$ continuity across interelement boundaries. Consider an edge shared by two elements, for instance, the edge at $\\xi=1$ for element A and $\\xi=-1$ for element B.\nContinuity of the function, $u$, requires that the trace of $u_h(\\xi,\\eta)$ along the edge is uniquely defined by the DOFs on that edge. Let's examine the trace of $u_h$ along $\\xi=1$:\n$u_h(1,\\eta)$. The full expansion is a sum over all $16$ DOFs. However, by construction, $H_1(1)=0$, $H_2(1)=0$, $H_1'(1)=0$, and $H_2'(1)=0$. This means any shape function associated with a node at $\\xi=-1$ is zero along the line $\\xi=1$. The trace $u_h(1,\\eta)$ is thus determined only by the DOFs at the nodes on that edge, namely at $(1,-1)$ and $(1,1)$. The expression simplifies to:\n$$ u_h(1, \\eta) = u(1,-1)H_3(1)H_1(\\eta) + u_{,\\eta}(1,-1)H_3(1)H_2(\\eta) + u(1,1)H_3(1)H_3(\\eta) + u_{,\\eta}(1,1)H_3(1)H_4(\\eta) $$\nSince $H_3(1)=1$, this becomes:\n$$ u_h(1, \\eta) = u(1,-1)H_1(\\eta) + u_{,\\eta}(1,-1)H_2(\\eta) + u(1,1)H_3(\\eta) + u_{,\\eta}(1,1)H_4(\\eta) $$\nThis is a 1D cubic Hermite representation along the edge, completely defined by the four nodal DOFs $\\{u, u_{,\\eta}\\}$ at the two corner nodes of that edge.\nSimilarly, for element B, the trace $u_h(-1,\\eta)$ is determined by the DOFs $\\{u, u_{,\\eta}\\}$ on its edge at $\\xi=-1$. If two elements share these four DOFs at their common nodes, the function $u$ will be continuous across their boundary.\n\nContinuity of the first derivatives requires continuity of the normal derivative. For an axis-aligned rectangular mesh, the normal derivative across a vertical edge is, up to a scaling from the element Jacobian, $\\frac{\\partial u}{\\partial \\xi}$. We examine the trace of $\\frac{\\partial u_h}{\\partial \\xi}$ along $\\xi=1$. Differentiating the expansion for $u_h$ with respect to $\\xi$ and evaluating at $\\xi=1$ involves terms like $H_i'(1)$. By construction, $H_1'(1)=0, H_2'(1)=0, H_3'(1)=0$, but $H_4'(1)=1$. Thus, only terms involving $H_4'(\\xi)$ or originating from DOFs $u_{,\\xi}$ and $u_{,\\xi\\eta}$ at $\\xi=1$ survive. The trace is:\n$$ \\frac{\\partial u_h}{\\partial \\xi}(1,\\eta) = u_{,\\xi}(1,-1)H_4'(1)H_1(\\eta) + u_{,\\xi\\eta}(1,-1)H_4'(1)H_2(\\eta) + u_{,\\xi}(1,1)H_4'(1)H_3(\\eta) + u_{,\\xi\\eta}(1,1)H_4'(1)H_4(\\eta) $$\nSince $H_4'(1)=1$, this becomes:\n$$ \\frac{\\partial u_h}{\\partial \\xi}(1, \\eta) = u_{,\\xi}(1,-1)H_1(\\eta) + u_{,\\xi\\eta}(1,-1)H_2(\\eta) + u_{,\\xi}(1,1)H_3(\\eta) + u_{,\\xi\\eta}(1,1)H_4(\\eta) $$\nThis trace is again a 1D cubic Hermite representation, determined by the four nodal DOFs $\\{u_{,\\xi}, u_{,\\xi\\eta}\\}$ at the corners of the edge. If these four DOFs are shared between adjacent elements, the normal derivative will be continuous.\nTherefore, to ensure $C^1$ continuity, all DOFs $\\{u, u_{,\\xi}, u_{,\\eta}, u_{,\\xi\\eta}\\}$ at the nodes on a common boundary must be shared. The tensor-product construction inherently satisfies this requirement because the behavior on any edge is governed exclusively by the DOFs residing on that edge.\n\nFinally, we evaluate the shape function corresponding to the nodal displacement $u$ at the corner $(\\xi, \\eta)=(1,1)$ at the point $(\\xi,\\eta)=(\\frac{1}{2},-\\frac{1}{2})$. This shape function is $N(\\xi,\\eta) = H_3(\\xi)H_3(\\eta)$. We must compute $N(\\frac{1}{2}, -\\frac{1}{2}) = H_3(\\frac{1}{2}) H_3(-\\frac{1}{2})$.\nWe use the expression $H_3(s) = -\\frac{1}{4}s^3 + \\frac{3}{4}s + \\frac{1}{2}$.\nFirst, for $s = \\frac{1}{2}$:\n$$ H_3\\left(\\frac{1}{2}\\right) = -\\frac{1}{4}\\left(\\frac{1}{2}\\right)^3 + \\frac{3}{4}\\left(\\frac{1}{2}\\right) + \\frac{1}{2} = -\\frac{1}{4}\\left(\\frac{1}{8}\\right) + \\frac{3}{8} + \\frac{1}{2} = -\\frac{1}{32} + \\frac{12}{32} + \\frac{16}{32} = \\frac{27}{32} $$\nNext, for $s = -\\frac{1}{2}$:\n$$ H_3\\left(-\\frac{1}{2}\\right) = -\\frac{1}{4}\\left(-\\frac{1}{2}\\right)^3 + \\frac{3}{4}\\left(-\\frac{1}{2}\\right) + \\frac{1}{2} = -\\frac{1}{4}\\left(-\\frac{1}{8}\\right) - \\frac{3}{8} + \\frac{1}{2} = \\frac{1}{32} - \\frac{12}{32} + \\frac{16}{32} = \\frac{5}{32} $$\nThe value of the shape function is the product of these two values:\n$$ N\\left(\\frac{1}{2}, -\\frac{1}{2}\\right) = \\left(\\frac{27}{32}\\right) \\times \\left(\\frac{5}{32}\\right) = \\frac{135}{1024} $$", "answer": "$$\\boxed{\\frac{135}{1024}}$$", "id": "2553873"}, {"introduction": "Ensuring continuity in finite element analysis can be deceptively complex, with subtle failure points that are not immediately obvious. This exercise presents a critical counterexample to illustrate that satisfying continuity conditions along element edges is not always sufficient to guarantee true $C^1$ continuity at the vertices where multiple elements meet. By analyzing the specifically constructed piecewise polynomial function in this problem, you will uncover why continuity of the full gradient vector is a more stringent condition than continuity of just the tangential derivative, thereby appreciating the challenges in developing robust $C^1$ finite element spaces. [@problem_id:2553950]", "problem": "Consider the following setting in the Finite Element Method (FEM) for constructing globally $C^1$ functions over a triangulation. Let $\\Omega = [0,1] \\times [0,1] \\subset \\mathbb{R}^{2}$ be partitioned into two triangles by the diagonal from $(1,0)$ to $(0,1)$:\n- $T_{1} = \\operatorname{conv}\\{(0,0),(1,0),(0,1)\\}$,\n- $T_{2} = \\operatorname{conv}\\{(1,1),(1,0),(0,1)\\}$.\nThe shared interior edge is $E = \\{(s,1-s) : s \\in [0,1]\\}$, with unit tangent $t = \\frac{1}{\\sqrt{2}}(1,-1)$.\n\nDefine a piecewise polynomial $u$ by\n- $u|_{T_{1}}(x,y) = p_{1}(x,y) = x(x+y-1)$,\n- $u|_{T_{2}}(x,y) = p_{2}(x,y) = y(x+y-1)$.\n\nUse only fundamental definitions of $C^0$ and $C^1$ continuity and of tangential derivatives along an edge: a function is $C^0$ across an edge if its traces match, it is $C^1$ across an edge if, in addition, its gradients match along the edge; the tangential derivative is $\\partial_{t} u = \\nabla u \\cdot t$ along the edge.\n\nTasks:\n1) Verify from first principles that along the entire interior of $E$, the traces of $u$ from $T_{1}$ and $T_{2}$ coincide, and that $\\partial_{t} u$ is also continuous across $E$ (i.e., the tangential derivatives from $T_{1}$ and $T_{2}$ coincide along $E$).\n2) Evaluate the gradients $\\nabla p_{1}$ and $\\nabla p_{2}$ at the vertex $v = (1,0)$, and explain why this shows that $u$ fails to be $C^1$ at $v$ in spite of satisfying the edgewise continuity of $u$ and $\\partial_{t} u$.\n3) Let the gradient jump at $v$ be the vector $J = \\nabla p_{1}(v) - \\nabla p_{2}(v)$. Compute the Euclidean norm $\\|J\\|_{2}$ exactly.\n\nProvide as your final answer the exact value of $\\|J\\|_{2}$ (no units, no rounding).", "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It presents a standard, non-trivial exercise in the Finite Element Method (FEM) concerning interelement continuity. We will proceed with the solution.\n\nThe problem requires us to analyze the continuity of a piecewise polynomial function $u$ defined over a domain $\\Omega = [0,1] \\times [0,1]$, which is partitioned into two triangles $T_{1} = \\operatorname{conv}\\{(0,0),(1,0),(0,1)\\}$ and $T_{2} = \\operatorname{conv}\\{(1,1),(1,0),(0,1)\\}$. The function $u$ is defined as $u|_{T_{1}}(x,y) = p_{1}(x,y) = x(x+y-1)$ and $u|_{T_{2}}(x,y) = p_{2}(x,y) = y(x+y-1)$. The shared edge is $E = \\{(s, 1-s) : s \\in [0,1]\\}$.\n\n**Task 1: Verification of $C^{0}$ and tangential derivative continuity along the edge $E$.**\n\nFirst, we verify $C^{0}$ continuity. A function is $C^{0}$ continuous across an edge if its values (traces) from both adjacent elements coincide along the entire edge. A point $(x,y)$ on the edge $E$ satisfies the linear equation $x+y-1=0$.\nThe trace of $p_{1}$ on $E$ is obtained by substituting $y=1-x$ (or more generally, recognizing $x+y-1=0$) into its expression:\n$$ u|_{T_{1}, E} = p_{1}(x,y)|_{x+y-1=0} = x(0) = 0 $$\nThe trace of $p_{2}$ on $E$ is similarly evaluated:\n$$ u|_{T_{2}, E} = p_{2}(x,y)|_{x+y-1=0} = y(0) = 0 $$\nSince both traces are identically zero along the edge $E$, we have $p_{1} = p_{2}$ on $E$. Therefore, the function $u$ is $C^{0}$ continuous across the interior of the edge $E$.\n\nNext, we verify the continuity of the tangential derivative, $\\partial_{t}u = \\nabla u \\cdot t$, where $t = \\frac{1}{\\sqrt{2}}(1,-1)$ is the unit tangent vector to $E$. We must first compute the gradients of $p_{1}$ and $p_{2}$.\nFor $p_{1}(x,y) = x^{2} + xy - x$, the gradient is:\n$$ \\nabla p_{1}(x,y) = \\left( \\frac{\\partial p_{1}}{\\partial x}, \\frac{\\partial p_{1}}{\\partial y} \\right) = (2x + y - 1, x) $$\nFor $p_{2}(x,y) = xy + y^{2} - y$, the gradient is:\n$$ \\nabla p_{2}(x,y) = \\left( \\frac{\\partial p_{2}}{\\partial x}, \\frac{\\partial p_{2}}{\\partial y} \\right) = (y, x + 2y - 1) $$\nNow, we evaluate these gradients along the edge $E$, which can be parametrized by $(x,y) = (s, 1-s)$ for $s \\in [0,1]$.\nThe trace of the gradient $\\nabla p_{1}$ on $E$ is:\n$$ \\nabla p_{1}(s, 1-s) = (2s + (1-s) - 1, s) = (s+s-s, s) = (s, s) $$\nThe trace of the gradient $\\nabla p_{2}$ on $E$ is:\n$$ \\nabla p_{2}(s, 1-s) = (1-s, s + 2(1-s) - 1) = (1-s, s+2-2s-1) = (1-s, 1-s) $$\nNow we compute the tangential derivatives along the edge $E$ for $s \\in (0,1)$:\nFor $p_{1}$:\n$$ \\partial_{t} p_{1}|_{E} = \\nabla p_{1}(s, 1-s) \\cdot t = (s,s) \\cdot \\frac{1}{\\sqrt{2}}(1,-1) = \\frac{1}{\\sqrt{2}}(s \\cdot 1 + s \\cdot (-1)) = \\frac{1}{\\sqrt{2}}(s-s) = 0 $$\nFor $p_{2}$:\n$$ \\partial_{t} p_{2}|_{E} = \\nabla p_{2}(s, 1-s) \\cdot t = (1-s, 1-s) \\cdot \\frac{1}{\\sqrt{2}}(1,-1) = \\frac{1}{\\sqrt{2}}((1-s) \\cdot 1 + (1-s) \\cdot (-1)) = 0 $$\nSince the tangential derivatives from both sides are identically zero along the interior of the edge $E$, $\\partial_{t} u$ is indeed continuous across $E$.\n\n**Task 2: Analysis of continuity at vertex $v = (1,0)$.**\n\nFor a function to be $C^{1}$ continuous in the domain $\\Omega$, its gradient must be continuous at every point in $\\Omega$. This requires that at any point on a shared boundary, the gradient must have a unique value, regardless of the direction of approach (i.e., from which element). We test this condition at the vertex $v=(1,0)$, which is a shared vertex of $T_{1}$ and $T_{2}$.\n\nWe evaluate the gradients of $p_{1}$ and $p_{2}$ at this vertex:\n$$ \\nabla p_{1}(1,0) = (2(1) + 0 - 1, 1) = (1,1) $$\n$$ \\nabla p_{2}(1,0) = (0, 1 + 2(0) - 1) = (0,0) $$\nThe limit of the gradient of $u$ as $(x,y)$ approaches $v=(1,0)$ from within $T_{1}$ is $(1,1)$, whereas the limit from within $T_{2}$ is $(0,0)$. Since $\\nabla p_{1}(v) \\neq \\nabla p_{2}(v)$, the gradient of $u$ is not uniquely defined at the vertex $v$. Consequently, $u$ is not differentiable at $v$ and fails to be $C^{1}$ in any open neighborhood of $v$, and therefore is not $C^{1}$ on $\\Omega$.\n\nThe satisfaction of edgewise continuity for $u$ and its tangential derivative $\\partial_{t} u$ is a necessary but not sufficient condition for $C^{1}$ continuity at a vertex where elements meet. A vertex involves constraints from all adjoining elements, and ensuring continuity of the full gradient vector is a more restrictive condition than ensuring continuity of a single directional derivative along one edge. This example illustrates a fundamental difficulty in constructing $C^{1}$ finite elements.\n\n**Task 3: Computation of the gradient jump norm.**\n\nThe gradient jump at the vertex $v=(1,0)$ is defined as the vector $J = \\nabla p_{1}(v) - \\nabla p_{2}(v)$. Using the values computed in Task 2:\n$$ J = (1,1) - (0,0) = (1,1) $$\nThe Euclidean norm of this jump vector, $\\|J\\|_{2}$, is calculated as:\n$$ \\|J\\|_{2} = \\sqrt{1^{2} + 1^{2}} = \\sqrt{1 + 1} = \\sqrt{2} $$\nThis non-zero jump quantifies the discontinuity of the gradient at the vertex $v$.", "answer": "$$\\boxed{\\sqrt{2}}$$", "id": "2553950"}]}