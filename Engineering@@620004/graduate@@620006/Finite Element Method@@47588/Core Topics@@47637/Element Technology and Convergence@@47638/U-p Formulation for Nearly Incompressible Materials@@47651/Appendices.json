{"hands_on_practices": [{"introduction": "Before we can solve a problem with finite elements, we must deeply understand the continuous equations we are approximating. The Method of Manufactured Solutions (MMS) is a powerful technique for code verification that turns the problem on its head: starting with a desired exact solution, we derive the required forcing terms. This practice [@problem_id:2609089] solidifies your command of the strong form of the governing equations for linear elasticity, forcing you to meticulously apply the definitions of strain, stress, and boundary traction.", "problem": "Consider the mixed displacement–pressure formulation (u-p formulation) of static, incompressible, linear elasticity in two spatial dimensions on the unit square domain $\\Omega = (0,1)\\times(0,1)$. Let the unknown displacement be $u:\\Omega\\to\\mathbb{R}^{2}$ and pressure be $p:\\Omega\\to\\mathbb{R}$. The governing equations are the linear momentum balance and the incompressibility constraint,\n$$-\\nabla\\cdot\\sigma = f \\quad\\text{in } \\Omega,\\qquad \\nabla\\cdot u = 0 \\quad\\text{in } \\Omega,$$\nwith the Cauchy stress\n$$\\sigma = 2\\mu\\,\\varepsilon(u) - p\\,I,$$\nwhere $\\mu>0$ is the constant shear modulus, $I$ is the second-order identity tensor, and $\\varepsilon(u) = \\tfrac{1}{2}\\left(\\nabla u + (\\nabla u)^{\\top}\\right)$ is the linearized strain. Let the natural boundary condition be the traction\n$$t = \\sigma n \\quad\\text{on } \\partial\\Omega,$$\nwhere $n$ is the unit outward normal to $\\partial\\Omega$.\n\nUsing the method of manufactured solutions, consider the stream function $\\psi(x,y) = \\sin(\\pi x)\\sin(\\pi y)$ and define the displacement and pressure fields by\n$$u(x,y) = \\begin{pmatrix}\\dfrac{\\partial\\psi}{\\partial y}(x,y) \\\\ -\\dfrac{\\partial\\psi}{\\partial x}(x,y)\\end{pmatrix} = \\begin{pmatrix}\\pi \\cos(\\pi y)\\sin(\\pi x) \\\\ -\\pi \\cos(\\pi x)\\sin(\\pi y)\\end{pmatrix},\\qquad p(x,y) = \\cos(\\pi x)\\cos(\\pi y).$$\nThese choices ensure $\\nabla\\cdot u = 0$ in $\\Omega$ and a nonzero pressure with zero mean over $\\Omega$.\n\nTask: Starting only from the stated field equations, definitions, and the given $(u,p)$, derive the body force $f:\\Omega\\to\\mathbb{R}^{2}$ and the boundary traction $t$ on each side of $\\partial\\Omega$ required so that $(u,p)$ exactly satisfies the model. Express the traction in terms of the boundary coordinate on each side of the square, using the outward normals on $x=0$, $x=1$, $y=0$, and $y=1$.\n\nAnswer specification:\n- Provide your final answer as a single row matrix containing the ten analytical expressions, in the following order:\n$$\\big(f_{x}(x,y),\\ f_{y}(x,y),\\ t_{x}(0,y),\\ t_{y}(0,y),\\ t_{x}(1,y),\\ t_{y}(1,y),\\ t_{x}(x,0),\\ t_{y}(x,0),\\ t_{x}(x,1),\\ t_{y}(x,1)\\big).$$\n- Do not include units. Do not approximate any constants; keep $\\pi$ and $\\mu$ symbolic.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Domain: $\\Omega = (0,1)\\times(0,1)$.\n- Governing Equations:\n  - Momentum balance: $-\\nabla\\cdot\\sigma = f$ in $\\Omega$.\n  - Incompressibility: $\\nabla\\cdot u = 0$ in $\\Omega$.\n- Constitutive Relation (Cauchy stress): $\\sigma = 2\\mu\\,\\varepsilon(u) - p\\,I$, with $\\mu>0$.\n- Linearized Strain: $\\varepsilon(u) = \\tfrac{1}{2}\\left(\\nabla u + (\\nabla u)^{\\top}\\right)$.\n- Boundary Traction: $t = \\sigma n$ on $\\partial\\Omega$.\n- Manufactured Displacement: $u(x,y) = \\begin{pmatrix}\\pi \\cos(\\pi y)\\sin(\\pi x) \\\\ -\\pi \\cos(\\pi x)\\sin(\\pi y)\\end{pmatrix}$.\n- Manufactured Pressure: $p(x,y) = \\cos(\\pi x)\\cos(\\pi y)$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it concerns the standard equations of linear elastostatics. It is well-posed, as it asks for the computation of source terms ($f$, $t$) for a given manufactured solution $(u, p)$, which is a standard procedure in the method of manufactured solutions for code verification. The problem is objective and provides all necessary information to proceed. The statement correctly asserts that the given displacement field $u$ is divergence-free:\n$$ \\nabla \\cdot u = \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_y}{\\partial y} = \\frac{\\partial}{\\partial x}(\\pi \\cos(\\pi y)\\sin(\\pi x)) + \\frac{\\partial}{\\partial y}(-\\pi \\cos(\\pi x)\\sin(\\pi y)) $$\n$$ = \\pi^2 \\cos(\\pi y)\\cos(\\pi x) - \\pi^2 \\cos(\\pi x)\\cos(\\pi y) = 0 $$\nThe problem is self-contained, consistent, and scientifically sound.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be derived.\n\nThe task is to determine the body force $f$ and the boundary traction $t$ that are consistent with the provided displacement field $u$ and pressure field $p$. This requires computing the stress tensor $\\sigma$ and then its divergence and its product with the boundary normal vector.\n\nFirst, we compute the components of the linearized strain tensor $\\varepsilon(u)$. The components of the displacement are $u_x = \\pi \\sin(\\pi x) \\cos(\\pi y)$ and $u_y = -\\pi \\cos(\\pi x) \\sin(\\pi y)$. The components of the gradient of the displacement $\\nabla u$ are:\n$$ \\frac{\\partial u_x}{\\partial x} = \\pi^2 \\cos(\\pi x) \\cos(\\pi y) $$\n$$ \\frac{\\partial u_x}{\\partial y} = -\\pi^2 \\sin(\\pi x) \\sin(\\pi y) $$\n$$ \\frac{\\partial u_y}{\\partial x} = \\pi^2 \\sin(\\pi x) \\sin(\\pi y) $$\n$$ \\frac{\\partial u_y}{\\partial y} = -\\pi^2 \\cos(\\pi x) \\sin(\\pi y) $$\nThe diagonal components of the strain tensor are:\n$$ \\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\pi^2 \\cos(\\pi x) \\cos(\\pi y) $$\n$$ \\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = -\\pi^2 \\cos(\\pi x) \\cos(\\pi y) $$\nThe off-diagonal component of the strain tensor is:\n$$ \\varepsilon_{xy} = \\varepsilon_{yx} = \\frac{1}{2} \\left( \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} \\right) = \\frac{1}{2} \\left( -\\pi^2 \\sin(\\pi x) \\sin(\\pi y) + \\pi^2 \\sin(\\pi x) \\sin(\\pi y) \\right) = 0 $$\nThe strain tensor is therefore:\n$$ \\varepsilon(u) = \\begin{pmatrix} \\pi^2 \\cos(\\pi x) \\cos(\\pi y) & 0 \\\\ 0 & -\\pi^2 \\cos(\\pi x) \\cos(\\pi y) \\end{pmatrix} $$\n\nNext, we compute the Cauchy stress tensor $\\sigma = 2\\mu\\,\\varepsilon(u) - p\\,I$. With $p(x,y) = \\cos(\\pi x)\\cos(\\pi y)$, the components of the stress tensor are:\n$$ \\sigma_{xx} = 2\\mu\\varepsilon_{xx} - p = 2\\mu\\pi^2 \\cos(\\pi x) \\cos(\\pi y) - \\cos(\\pi x) \\cos(\\pi y) = (2\\mu\\pi^2 - 1) \\cos(\\pi x) \\cos(\\pi y) $$\n$$ \\sigma_{yy} = 2\\mu\\varepsilon_{yy} - p = -2\\mu\\pi^2 \\cos(\\pi x) \\cos(\\pi y) - \\cos(\\pi x) \\cos(\\pi y) = -(2\\mu\\pi^2 + 1) \\cos(\\pi x) \\cos(\\pi y) $$\n$$ \\sigma_{xy} = \\sigma_{yx} = 2\\mu\\varepsilon_{xy} = 0 $$\nSo, the stress tensor is:\n$$ \\sigma = \\cos(\\pi x)\\cos(\\pi y) \\begin{pmatrix} 2\\mu\\pi^2 - 1 & 0 \\\\ 0 & -(2\\mu\\pi^2 + 1) \\end{pmatrix} $$\n\nNow, we derive the body force $f = - \\nabla \\cdot \\sigma$. The components of $f$ are:\n$$ f_x = -\\left(\\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{yx}}{\\partial y}\\right) = -\\frac{\\partial \\sigma_{xx}}{\\partial x} $$\n$$ f_x = -\\frac{\\partial}{\\partial x} \\left[ (2\\mu\\pi^2 - 1) \\cos(\\pi x) \\cos(\\pi y) \\right] = -(2\\mu\\pi^2 - 1) (-\\pi \\sin(\\pi x)) \\cos(\\pi y) $$\n$$ f_x(x,y) = \\pi(2\\mu\\pi^2 - 1) \\sin(\\pi x) \\cos(\\pi y) $$\n$$ f_y = -\\left(\\frac{\\partial \\sigma_{xy}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y}\\right) = -\\frac{\\partial \\sigma_{yy}}{\\partial y} $$\n$$ f_y = -\\frac{\\partial}{\\partial y} \\left[ -(2\\mu\\pi^2 + 1) \\cos(\\pi x) \\cos(\\pi y) \\right] = (2\\mu\\pi^2 + 1) \\cos(\\pi x) (-\\pi \\sin(\\pi y)) $$\n$$ f_y(x,y) = -\\pi(2\\mu\\pi^2 + 1) \\cos(\\pi x) \\sin(\\pi y) $$\n\nFinally, we compute the boundary traction $t = \\sigma n$ on each of the four sides of the unit square $\\partial\\Omega$.\nThe traction vector is $t = \\begin{pmatrix} t_x \\\\ t_y \\end{pmatrix} = \\begin{pmatrix} \\sigma_{xx} n_x + \\sigma_{xy} n_y \\\\ \\sigma_{yx} n_x + \\sigma_{yy} n_y \\end{pmatrix} = \\begin{pmatrix} \\sigma_{xx} n_x \\\\ \\sigma_{yy} n_y \\end{pmatrix}$.\n\n1.  On the boundary $x=0$, the outward normal is $n = (-1, 0)^T$.\n    $$ t_x(0,y) = \\sigma_{xx}|_{x=0} \\cdot (-1) = -(2\\mu\\pi^2 - 1) \\cos(0) \\cos(\\pi y) = (1 - 2\\mu\\pi^2) \\cos(\\pi y) $$\n    $$ t_y(0,y) = \\sigma_{yy}|_{x=0} \\cdot (0) = 0 $$\n\n2.  On the boundary $x=1$, the outward normal is $n = (1, 0)^T$.\n    $$ t_x(1,y) = \\sigma_{xx}|_{x=1} \\cdot (1) = (2\\mu\\pi^2 - 1) \\cos(\\pi) \\cos(\\pi y) = -(2\\mu\\pi^2 - 1) \\cos(\\pi y) = (1 - 2\\mu\\pi^2) \\cos(\\pi y) $$\n    $$ t_y(1,y) = \\sigma_{yy}|_{x=1} \\cdot (0) = 0 $$\n\n3.  On the boundary $y=0$, the outward normal is $n = (0, -1)^T$.\n    $$ t_x(x,0) = \\sigma_{xx}|_{y=0} \\cdot (0) = 0 $$\n    $$ t_y(x,0) = \\sigma_{yy}|_{y=0} \\cdot (-1) = -[-(2\\mu\\pi^2 + 1) \\cos(\\pi x) \\cos(0)] = (2\\mu\\pi^2 + 1) \\cos(\\pi x) $$\n\n4.  On the boundary $y=1$, the outward normal is $n = (0, 1)^T$.\n    $$ t_x(x,1) = \\sigma_{xx}|_{y=1} \\cdot (0) = 0 $$\n    $$ t_y(x,1) = \\sigma_{yy}|_{y=1} \\cdot (1) = -(2\\mu\\pi^2 + 1) \\cos(\\pi x) \\cos(\\pi) = (2\\mu\\pi^2 + 1) \\cos(\\pi x) $$\n\nThe ten required expressions are assembled into a single row matrix for the final answer.\n- $f_{x}(x,y) = \\pi(2\\mu\\pi^2 - 1) \\sin(\\pi x) \\cos(\\pi y)$\n- $f_{y}(x,y) = -\\pi(2\\mu\\pi^2 + 1) \\cos(\\pi x) \\sin(\\pi y)$\n- $t_{x}(0,y) = (1 - 2\\mu\\pi^2) \\cos(\\pi y)$\n- $t_{y}(0,y) = 0$\n- $t_{x}(1,y) = (1 - 2\\mu\\pi^2) \\cos(\\pi y)$\n- $t_{y}(1,y) = 0$\n- $t_{x}(x,0) = 0$\n- $t_{y}(x,0) = (2\\mu\\pi^2 + 1) \\cos(\\pi x)$\n- $t_{x}(x,1) = 0$\n- $t_{y}(x,1) = (2\\mu\\pi^2 + 1) \\cos(\\pi x)$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\pi(2\\mu\\pi^2 - 1) \\sin(\\pi x) \\cos(\\pi y) & -\\pi(2\\mu\\pi^2 + 1) \\cos(\\pi x) \\sin(\\pi y) & (1 - 2\\mu\\pi^2) \\cos(\\pi y) & 0 & (1 - 2\\mu\\pi^2) \\cos(\\pi y) & 0 & 0 & (2\\mu\\pi^2 + 1) \\cos(\\pi x) & 0 & (2\\mu\\pi^2 + 1) \\cos(\\pi x)\n\\end{pmatrix}\n}\n$$", "id": "2609089"}, {"introduction": "The primary motivation for the U-p formulation is the failure of standard displacement-based elements—a phenomenon known as volumetric locking. This exercise provides a direct, elemental view of how this failure occurs. By interpolating a perfectly incompressible displacement field onto a simple bilinear quadrilateral element, you will discover that the resulting discrete field is, in fact, compressible [@problem_id:2609062]. This spurious volumetric strain is the root cause of locking and demonstrates why low-order elements are inadequate for enforcing the incompressibility constraint.", "problem": "Consider a single isoparametric bilinear quadrilateral element ($Q_1$) in plane strain within the Finite Element Method (FEM) using the displacement-pressure ($u-p$) formulation for a nearly incompressible material. The weak incompressibility constraint in this formulation is enforced via the pressure test functions, so the key kinematic quantity is the volumetric strain (the divergence of the displacement), denoted by $\\varepsilon_v = \\nabla \\cdot u$.\n\nLet the physical element occupy the square $\\Omega = \\{(x,y) \\,|\\, -1 \\le x \\le 1,\\, -1 \\le y \\le 1\\}$, with the standard bilinear shape functions\n$$\nN_1(x,y) = \\tfrac{1}{4}(1-x)(1-y),\\quad\nN_2(x,y) = \\tfrac{1}{4}(1+x)(1-y),\\quad\nN_3(x,y) = \\tfrac{1}{4}(1+x)(1+y),\\quad\nN_4(x,y) = \\tfrac{1}{4}(1-x)(1+y).\n$$\nAssume the exact kinematically admissible displacement field is divergence-free (perfectly incompressible) and is generated by the stream function $\\psi(x,y) = x y^{2}$ via\n$$\nu_x(x,y) = \\frac{\\partial \\psi}{\\partial y} = 2 x y,\\qquad\nu_y(x,y) = -\\frac{\\partial \\psi}{\\partial x} = - y^{2},\n$$\nso that $\\nabla \\cdot u = 0$ exactly in $\\Omega$.\n\nConstruct the discrete $Q_1$ displacement field $u^h = (u_x^h,u_y^h)$ by nodal interpolation of the exact values, that is,\n$$\nu_x^h(x,y) = \\sum_{a=1}^{4} N_a(x,y)\\,u_x(x_a,y_a),\\qquad\nu_y^h(x,y) = \\sum_{a=1}^{4} N_a(x,y)\\,u_y(x_a,y_a),\n$$\nwhere $(x_a,y_a)$ are the four element corner coordinates $(\\pm 1,\\pm 1)$. Define the discrete volumetric strain as $\\varepsilon_v^h(x,y) := \\nabla \\cdot u^h(x,y)$.\n\nUsing the standard $2\\times 2$ Gaussian quadrature points at $(x,y) = \\big(\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3}\\big)$, compute the value of the discrete volumetric strain $\\varepsilon_v^h$ at the Gauss point $(x,y) = \\big(1/\\sqrt{3}, -1/\\sqrt{3}\\big)$. Provide your answer as an exact value. No rounding is required.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It is a standard exercise in the Finite Element Method, testing the fundamental properties of bilinear interpolation and its consequences for enforcing incompressibility. All necessary data and functions are provided, and there are no contradictions or ambiguities. The problem is valid.\n\nThe objective is to compute the discrete volumetric strain, $\\varepsilon_v^h(x,y) = \\nabla \\cdot u^h(x,y)$, at the Gauss point $(x_g, y_g) = (1/\\sqrt{3}, -1/\\sqrt{3})$. The discrete displacement field $u^h = (u_x^h, u_y^h)$ is obtained by nodal interpolation of an exact, divergence-free displacement field.\n\nFirst, we must determine the nodal displacement values. The element nodes are the corners of the square domain $\\Omega$, which we number in standard counter-clockwise order:\nNode $1$: $(x_1, y_1) = (-1, -1)$\nNode $2$: $(x_2, y_2) = (1, -1)$\nNode $3$: $(x_3, y_3) = (1, 1)$\nNode $4$: $(x_4, y_4) = (-1, 1)$\n\nThe exact displacement field is given by $u_x(x,y) = 2xy$ and $u_y(x,y) = -y^2$. We evaluate these functions at the nodal coordinates to find the nodal displacements.\n\nFor the $x$-component of displacement, $u_x$:\n$u_{x1} = u_x(-1, -1) = 2(-1)(-1) = 2$\n$u_{x2} = u_x(1, -1) = 2(1)(-1) = -2$\n$u_{x3} = u_x(1, 1) = 2(1)(1) = 2$\n$u_{x4} = u_x(-1, 1) = 2(-1)(1) = -2$\n\nFor the $y$-component of displacement, $u_y$:\n$u_{y1} = u_y(-1, -1) = -(-1)^2 = -1$\n$u_{y2} = u_y(1, -1) = -(-1)^2 = -1$\n$u_{y3} = u_y(1, 1) = -(1)^2 = -1$\n$u_{y4} = u_y(-1, 1) = -(1)^2 = -1$\n\nThe discrete displacement field $u^h(x,y)$ is then given by the interpolation formulas:\n$$u_x^h(x,y) = \\sum_{a=1}^{4} N_a(x,y)\\,u_{xa}$$\n$$u_y^h(x,y) = \\sum_{a=1}^{4} N_a(x,y)\\,u_{ya}$$\nThe discrete volumetric strain is the divergence of this interpolated field:\n$$\\varepsilon_v^h(x,y) = \\frac{\\partial u_x^h}{\\partial x} + \\frac{\\partial u_y^h}{\\partial y} = \\sum_{a=1}^{4} \\frac{\\partial N_a(x,y)}{\\partial x} u_{xa} + \\sum_{a=1}^{4} \\frac{\\partial N_a(x,y)}{\\partial y} u_{ya}$$\n\nLet us analyze the term involving $u_y$. Since all nodal values $u_{ya}$ are equal to $-1$, the interpolated field $u_y^h$ is:\n$$u_y^h(x,y) = \\sum_{a=1}^{4} N_a(x,y)(-1) = -1 \\cdot \\sum_{a=1}^{4} N_a(x,y)$$\nA fundamental property of isoparametric shape functions is that they form a partition of unity, i.e., $\\sum_{a=1}^{4} N_a(x,y) = 1$ for all $(x,y)$ in the element. Therefore, $u_y^h(x,y) = -1$.\nThe derivative of a constant is zero, so:\n$$\\frac{\\partial u_y^h}{\\partial y} = \\frac{\\partial}{\\partial y}(-1) = 0$$\nThis simplifies the calculation of the discrete volumetric strain considerably. The total expression reduces to:\n$$\\varepsilon_v^h(x,y) = \\frac{\\partial u_x^h}{\\partial x} = \\sum_{a=1}^{4} \\frac{\\partial N_a(x,y)}{\\partial x} u_{xa}$$\n\nWe now require the derivatives of the shape functions with respect to $x$:\n$\\frac{\\partial N_1}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{4}(1-x)(1-y)\\right) = -\\frac{1}{4}(1-y)$\n$\\frac{\\partial N_2}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{4}(1+x)(1-y)\\right) = \\frac{1}{4}(1-y)$\n$\\frac{\\partial N_3}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{4}(1+x)(1+y)\\right) = \\frac{1}{4}(1+y)$\n$\\frac{\\partial N_4}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{4}(1-x)(1+y)\\right) = -\\frac{1}{4}(1+y)$\n\nNext, we evaluate these derivatives at the specified Gauss point $(x_g, y_g) = (1/\\sqrt{3}, -1/\\sqrt{3})$:\n$\\frac{\\partial N_1}{\\partial x}\\bigg|_{(x_g, y_g)} = -\\frac{1}{4}(1 - (-\\frac{1}{\\sqrt{3}})) = -\\frac{1}{4}(1 + \\frac{1}{\\sqrt{3}})$\n$\\frac{\\partial N_2}{\\partial x}\\bigg|_{(x_g, y_g)} = \\frac{1}{4}(1 - (-\\frac{1}{\\sqrt{3}})) = \\frac{1}{4}(1 + \\frac{1}{\\sqrt{3}})$\n$\\frac{\\partial N_3}{\\partial x}\\bigg|_{(x_g, y_g)} = \\frac{1}{4}(1 + (-\\frac{1}{\\sqrt{3}})) = \\frac{1}{4}(1 - \\frac{1}{\\sqrt{3}})$\n$\\frac{\\partial N_4}{\\partial x}\\bigg|_{(x_g, y_g)} = -\\frac{1}{4}(1 + (-\\frac{1}{\\sqrt{3}})) = -\\frac{1}{4}(1 - \\frac{1}{\\sqrt{3}})$\n\nFinally, we compute the sum for $\\varepsilon_v^h(x_g, y_g)$ using the nodal values $u_{xa} = \\{2, -2, 2, -2\\}$:\n$\\varepsilon_v^h = \\left(-\\frac{1}{4}(1 + \\frac{1}{\\sqrt{3}})\\right)(2) + \\left(\\frac{1}{4}(1 + \\frac{1}{\\sqrt{3}})\\right)(-2) + \\left(\\frac{1}{4}(1 - \\frac{1}{\\sqrt{3}})\\right)(2) + \\left(-\\frac{1}{4}(1 - \\frac{1}{\\sqrt{3}})\\right)(-2)$\n$\\varepsilon_v^h = -\\frac{1}{2}(1 + \\frac{1}{\\sqrt{3}}) - \\frac{1}{2}(1 + \\frac{1}{\\sqrt{3}}) + \\frac{1}{2}(1 - \\frac{1}{\\sqrt{3}}) + \\frac{1}{2}(1 - \\frac{1}{\\sqrt{3}})$\n$\\varepsilon_v^h = -1 \\cdot (1 + \\frac{1}{\\sqrt{3}}) + 1 \\cdot (1 - \\frac{1}{\\sqrt{3}})$\n$\\varepsilon_v^h = -1 - \\frac{1}{\\sqrt{3}} + 1 - \\frac{1}{\\sqrt{3}}$\n$\\varepsilon_v^h = -\\frac{2}{\\sqrt{3}}$\n\nTo express the result with a rational denominator:\n$\\varepsilon_v^h = -\\frac{2\\sqrt{3}}{3}$\n\nThis non-zero result for the discrete volumetric strain, which arises from a continuous field that is perfectly incompressible ($\\nabla \\cdot u = 0$), is a manifestation of the phenomenon known as volumetric locking in low-order finite elements.", "answer": "$$\n\\boxed{-\\frac{2\\sqrt{3}}{3}}\n$$", "id": "2609062"}, {"introduction": "The stability of a mixed finite element method is guaranteed by the discrete inf-sup (or LBB) condition, which relates the pressure and displacement approximation spaces. When this condition is not met, non-physical pressure oscillations can corrupt the solution. This advanced exercise guides you through a formal proof that the popular equal-order linear triangular ($P_1/P_1$) element pairing is unstable [@problem_id:2609099]. By constructing an explicit \"spurious pressure mode\", you will show that the inf-sup constant $\\beta_h$ is zero, providing a definitive demonstration of instability.", "problem": "Consider the plane strain mixed displacement–pressure formulation of linear elasticity for a nearly incompressible solid in the Finite Element Method (FEM). Let the computational domain be the unit square $\\Omega = (0,1)^{2}$, triangulated by a uniform $2\\times 2$ macro-partition into four congruent squares, each further split into two triangles by the same diagonal from the lower-left corner to the upper-right corner. Denote this conforming triangulation by $\\mathcal{T}_{h}$, and let $V_{h}\\subset [H^{1}_{0}(\\Omega)]^{2}$ be the continuous, piecewise linear vector-valued space (equal-order $P_{1}$ for displacement) and $Q_{h}\\subset L^{2}_{0}(\\Omega)$ be the continuous, piecewise linear scalar-valued space with zero mean (equal-order $P_{1}$ for pressure). The mixed bilinear coupling is\n$$\nb(u,p) \\;=\\; -\\int_{\\Omega} p\\,\\nabla\\cdot u\\,\\mathrm{d}x,\n$$\nand the discrete inf-sup (Ladyzhenskaya–Babuška–Brezzi (LBB)) constant is\n$$\n\\beta_{h} \\;=\\; \\inf_{\\substack{p_{h}\\in Q_{h}\\\\ \\|p_{h}\\|_{0}=1}} \\;\\; \\sup_{\\substack{u_{h}\\in V_{h}\\\\ u_{h}\\neq 0}} \\frac{b(u_{h},p_{h})}{\\|u_{h}\\|_{1}},\n$$\nwhere $\\|\\cdot\\|_{0}$ and $\\|\\cdot\\|_{1}$ are the standard $L^{2}(\\Omega)$ norm and $H^{1}(\\Omega)$ norm, respectively.\n\nUsing only:\n- the definitions above,\n- the fact that for $P_{1}$ functions the divergence $\\nabla\\cdot u_{h}$ is constant on each triangle $K\\in\\mathcal{T}_{h}$, and\n- the elementary identity for linear functions on a triangle $K$ with vertices $\\{z_{1},z_{2},z_{3}\\}$,\n$$\n\\int_{K} \\ell\\,\\mathrm{d}x \\;=\\; \\frac{|K|}{3}\\,\\big(\\ell(z_{1})+\\ell(z_{2})+\\ell(z_{3})\\big),\n$$\nconstruct an explicit nonzero $p_{h}\\in Q_{h}$ on this mesh such that $b(u_{h},p_{h})=0$ for every $u_{h}\\in V_{h}$. Conclude the value of the discrete inf-sup constant $\\beta_{h}$ for this equal-order $P_{1}$–$P_{1}$ pairing on this uniform, consistently diagonalized mesh.\n\nYour final answer must be the value of $\\beta_{h}$ as a single real number. No units are required. Do not round.", "solution": "The problem requires the construction of a specific spurious pressure mode and the subsequent determination of the discrete inf-sup constant $\\beta_{h}$ for a given finite element discretization. The analysis proceeds as follows.\n\nFirst, let us examine the bilinear form $b(u_{h}, p_{h})$. The computational domain $\\Omega$ is the union of the triangles $K$ in the triangulation $\\mathcal{T}_{h}$. We can write the integral over $\\Omega$ as a sum of integrals over each triangle $K$:\n$$\nb(u_{h}, p_{h}) = -\\int_{\\Omega} p_{h} \\nabla \\cdot u_{h} \\, \\mathrm{d}x = -\\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} p_{h} \\nabla \\cdot u_{h} \\, \\mathrm{d}x\n$$\nWe are given that for a function $u_{h} \\in V_{h}$, which is composed of continuous piecewise linear vector fields, the divergence $\\nabla \\cdot u_{h}$ is constant on each triangle $K$. Let us denote this constant value by $(\\nabla \\cdot u_{h})|_{K}$. We can therefore factor this constant out of the integral for each triangle:\n$$\nb(u_{h}, p_{h}) = -\\sum_{K \\in \\mathcal{T}_{h}} (\\nabla \\cdot u_{h})|_{K} \\int_{K} p_{h} \\, \\mathrm{d}x\n$$\nThe function $p_{h} \\in Q_{h}$ is continuous and piecewise linear. The problem provides an identity for integrating a linear function $\\ell$ over a triangle $K$ with vertices $\\{z_{1}, z_{2}, z_{3}\\}$:\n$$\n\\int_{K} \\ell \\, \\mathrm{d}x = \\frac{|K|}{3} \\left( \\ell(z_{1}) + \\ell(z_{2}) + \\ell(z_{3}) \\right)\n$$\nApplying this to $p_{h}$, we get:\n$$\nb(u_{h}, p_{h}) = -\\sum_{K \\in \\mathcal{T}_{h}} (\\nabla \\cdot u_{h})|_{K} \\frac{|K|}{3} \\sum_{i=1}^{3} p_{h}(z_{K,i})\n$$\nwhere $\\{z_{K,i}\\}_{i=1}^{3}$ are the vertices of triangle $K$.\n\nOur objective is to find a nonzero pressure field $p_{h} \\in Q_{h}$ such that $b(u_{h}, p_{h})=0$ for every $u_{h} \\in V_{h}$. This pressure field is known as a spurious pressure mode or a checkerboard mode for this specific mesh and element choice.\n\nLet us define the nodal values of $p_{h}$ on the $3 \\times 3$ grid of nodes. The nodes are located at coordinates $(0.5i, 0.5j)$ for $i, j \\in \\{0, 1, 2\\}$. We define the pressure at these nodes using a checkerboard pattern:\n$$\np_{h}(0.5i, 0.5j) = (-1)^{i+j}\n$$\nThis defines a continuous, piecewise linear function $p_{h}$ which is non-zero. To be an element of $Q_{h}$, it must also have a zero mean over $\\Omega$, i.e., $\\int_{\\Omega} p_{h} \\, \\mathrm{d}x = 0$. Let us verify this condition.\nThe domain $\\Omega$ is composed of $8$ triangles of equal area $|K| = \\frac{1}{2}(0.5)^{2} = 0.125$. The integral is $\\int_{\\Omega} p_{h} \\, \\mathrm{d}x = \\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} p_{h} \\, \\mathrm{d}x = \\frac{|K|}{3} \\sum_{K \\in \\mathcal{T}_{h}} \\sum_{i=1}^{3} p_{h}(z_{K,i})$.\nLet's list the sum of nodal pressure values for each of the $8$ triangles, based on the specified mesh structure where each of the four $0.5 \\times 0.5$ squares is split by a diagonal from lower-left to upper-right.\nThe nodal values are: $p(0,0)=1, p(0.5,0)=-1, p(1,0)=1, p(0,0.5)=-1, p(0.5,0.5)=1, p(1,0.5)=-1, p(0,1)=1, p(0.5,1)=-1, p(1,1)=1$.\n- Lower-left square (2 triangles): vertices $(0,0), (0.5,0), (0,0.5), (0.5,0.5)$. Nodal values $1, -1, -1, 1$. The sum of nodal values for each of the two triangles is $1 - 1 + 1 = 1$.\n- Lower-right square (2 triangles): vertices $(0.5,0), (1,0), (0.5,0.5), (1,0.5)$. Nodal values $-1, 1, 1, -1$. The sum of nodal values for each of the two triangles is $-1 + 1 - 1 = -1$.\n- Upper-left square (2 triangles): vertices $(0,0.5), (0.5,0.5), (0,1), (0.5,1)$. Nodal values $-1, 1, 1, -1$. The sum of nodal values for each of the two triangles is $-1 + 1 - 1 = -1$.\n- Upper-right square (2 triangles): vertices $(0.5,0.5), (1,0.5), (0.5,1), (1,1)$. Nodal values $1, -1, -1, 1$. The sum of nodal values for each of the two triangles is $1 - 1 + 1 = 1$.\nSumming the contributions from all $8$ triangles: $\\frac{|K|}{3} (2 \\times 1 + 2 \\times (-1) + 2 \\times (-1) + 2 \\times 1) = \\frac{|K|}{3} (2-2-2+2) = 0$.\nThus, this checkerboard pressure $p_{h}$ has zero mean and is an element of $Q_{h}$.\n\nNow we must show that $b(u_{h}, p_{h}) = 0$ for all $u_{h} \\in V_{h}$. The space $V_{h} \\subset [H^{1}_{0}(\\Omega)]^{2}$ consists of vector functions that are zero on the boundary $\\partial\\Omega$. This means that the only non-zero nodal values for any $u_{h} \\in V_{h}$ can occur at the single interior node $z_{c} = (0.5, 0.5)$. Therefore, any function $u_{h} \\in V_{h}$ can be written as a linear combination of two vector basis functions: one corresponding to a unit displacement in the $x$-direction at $z_{c}$, and the other a unit displacement in the $y$-direction at $z_{c}$. Let these basis functions be $u_{h}^{(1)}$ and $u_{h}^{(2)}$. If we prove that $b(u_{h}^{(1)}, p_{h}) = 0$ and $b(u_{h}^{(2)}, p_{h}) = 0$, then by linearity $b(u_{h}, p_{h}) = 0$ for all $u_{h} \\in V_{h}$.\n\nLet's compute $b(u_{h}^{(1)}, p_{h})$, where $u_{h}^{(1)}$ corresponds to a displacement $(1,0)$ at $z_c$. We have:\n$$\nb(u_{h}^{(1)}, p_{h}) = -\\frac{|K|}{3} \\sum_{K \\in \\mathcal{T}_{h}} (\\nabla \\cdot u_{h}^{(1)})|_{K} \\sum_{i=1}^{3} p_{h}(z_{K,i})\n$$\nThe sum of nodal pressures is $+1$ for triangles in the lower-left and upper-right squares, and $-1$ for triangles in the lower-right and upper-left squares. Let $\\mathcal{T}_{h}^{+}$ and $\\mathcal{T}_{h}^{-}$ be these sets of triangles, respectively.\n$$\nb(u_{h}^{(1)}, p_{h}) = -\\frac{|K|}{3} \\left( \\sum_{K \\in \\mathcal{T}_{h}^{+}} (\\nabla \\cdot u_{h}^{(1)})|_{K} - \\sum_{K \\in \\mathcal{T}_{h}^{-}} (\\nabla \\cdot u_{h}^{(1)})|_{K} \\right)\n$$\nWe need to calculate $(\\nabla \\cdot u_{h}^{(1)})|_{K} = (\\partial u_{x}/\\partial x)|_{K}$ for each triangle. The function $u_{x}$ is a pyramid function centered at $z_{c}$. Let $h=0.5$. The divergence values on the $8$ triangles (denoted $K_{1a}, K_{1b}$ for the LL square, etc.) are:\n- For $u_h^{(1)}$ (x-displacement), the constant divergence on each of the 8 triangles can be computed. Due to the symmetry of the hat function and the mesh, the divergence on triangles to the left of the center will be equal and opposite to the divergence on triangles to the right. The sum of divergences over $\\mathcal{T}_{h}^{+}$ (LL and UR quadrants) is $(d_1+d_2) + (d_7+d_8)$. The sum over $\\mathcal{T}_{h}^{-}$ (LR and UL quadrants) is $(d_3+d_4) + (d_5+d_6)$. By symmetry, $d_1+d_2 = -(d_3+d_4)$ and $d_5+d_6 = -(d_7+d_8)$. This leads to the total sum being zero. The same argument holds for the $y$-displacement basis function $u_h^{(2)}$.\nA more direct calculation shows that for $u_h^{(1)}$, the non-zero divergences are on the four triangles adjacent to the central vertical line, with values proportional to $\\{+1, -1, +1, -1\\}$ (or a permutation), while for $u_h^{(2)}$ they are on the four triangles adjacent to the central horizontal line. The sum of nodal pressures for these groups of triangles always results in cancellation.\nFor instance, the four triangles adjacent to the central vertical line belong to all four quadrants, one from each. Their pressure sums are $\\{+1, -1, -1, +1\\}$. The divergence values are symmetric/anti-symmetric. The combination results in a zero sum.\n\nSince $b(u_{h}, p_{h})=0$ for the basis functions of $V_{h}$, it holds for all $u_{h} \\in V_{h}$.\n\nWe have constructed a nonzero $p_{h}^{*} \\in Q_{h}$ (our checkerboard mode) such that $b(u_{h}, p_{h}^{*}) = 0$ for all $u_{h} \\in V_{h}$. Now, consider the definition of the discrete inf-sup constant:\n$$\n\\beta_{h} = \\inf_{\\substack{p_{h}\\in Q_{h}\\\\ \\|p_{h}\\|_{0}=1}} \\;\\; \\sup_{\\substack{u_{h}\\in V_{h}\\\\ u_{h}\\neq 0}} \\frac{b(u_{h},p_{h})}{\\|u_{h}\\|_{1}}\n$$\nLet's choose the specific pressure $\\hat{p}_{h} = p_{h}^{*}/\\|p_{h}^{*}\\|_{0}$. This is a valid pressure for the infimum calculation as it is in $Q_h$ and has unit $L^{2}$-norm. For this $\\hat{p}_{h}$, the supremum is:\n$$\n\\sup_{\\substack{u_{h}\\in V_{h}\\\\ u_{h}\\neq 0}} \\frac{b(u_{h},\\hat{p}_{h})}{\\|u_{h}\\|_{1}} = \\sup_{\\substack{u_{h}\\in V_{h}\\\\ u_{h}\\neq 0}} \\frac{b(u_{h}, p_{h}^{*}/\\|p_{h}^{*}\\|_{0})}{\\|u_{h}\\|_{1}} = \\frac{1}{\\|p_{h}^{*}\\|_{0}} \\sup_{\\substack{u_{h}\\in V_{h}\\\\ u_{h}\\neq 0}} \\frac{b(u_{h},p_{h}^{*})}{\\|u_{h}\\|_{1}}\n$$\nSince we proved $b(u_{h}, p_{h}^{*}) = 0$ for all $u_{h} \\in V_{h}$, the supremum is $0$.\nThe infimum over all possible normalized pressures must be less than or equal to this particular value of $0$.\n$$\n\\beta_{h} \\leq 0\n$$\nFurthermore, for any $p_{h}$, the term $\\sup_{u_{h}} \\frac{b(u_{h},p_{h})}{\\|u_{h}\\|_{1}}$ is non-negative. If it were negative, say $-C$ with $C>0$, then for the displacement field $-u_{h}$ we would have $\\frac{b(-u_{h},p_{h})}{\\|-u_{h}\\|_{1}} = \\frac{-b(u_{h},p_{h})}{\\|u_{h}\\|_{1}}$, and the supremum would include positive values. Hence, $\\sup(\\ldots) \\geq 0$. This implies that the infimum over all $p_h$ must also be non-negative, $\\beta_{h} \\geq 0$.\nCombining the two inequalities, we must have $\\beta_{h}=0$.\nThis result demonstrates the well-known instability of the equal-order $P_{1}$–$P_{1}$ element pairing for the Stokes or mixed elasticity problem on this type of uniform mesh.", "answer": "$$\n\\boxed{0}\n$$", "id": "2609099"}]}