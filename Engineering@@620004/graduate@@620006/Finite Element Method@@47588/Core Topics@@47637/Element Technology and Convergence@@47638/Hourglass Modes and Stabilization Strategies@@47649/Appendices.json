{"hands_on_practices": [{"introduction": "To effectively control hourglass modes, we must first understand their mathematical origin. These non-physical deformation patterns are troublesome because they produce zero strain at an element's integration points, rendering them invisible to a reduced-integration scheme and thus contributing no strain energy. This foundational exercise guides you through the process of deriving the analytical form of these zero-energy modes for a trilinear hexahedral element from first principles, providing a concrete understanding of the null-space of the strain-displacement matrix that must be penalized [@problem_id:2565900].", "problem": "Consider an eight-node trilinear hexahedral element ($\\text{Hex8}$) on the reference cube with parent coordinates $(\\xi,\\eta,\\zeta) \\in [-1,1]^3$. The node ordering and coordinates are:\n- Node $1$: $(\\xi_1,\\eta_1,\\zeta_1)=(-1,-1,-1)$,\n- Node $2$: $(\\xi_2,\\eta_2,\\zeta_2)=(1,-1,-1)$,\n- Node $3$: $(\\xi_3,\\eta_3,\\zeta_3)=(1,1,-1)$,\n- Node $4$: $(\\xi_4,\\eta_4,\\zeta_4)=(-1,1,-1)$,\n- Node $5$: $(\\xi_5,\\eta_5,\\zeta_5)=(-1,-1,1)$,\n- Node $6$: $(\\xi_6,\\eta_6,\\zeta_6)=(1,-1,1)$,\n- Node $7$: $(\\xi_7,\\eta_7,\\zeta_7)=(1,1,1)$,\n- Node $8$: $(\\xi_8,\\eta_8,\\zeta_8)=(-1,1,1)$.\n\nAssume the physical mapping is the identity, so that $\\partial/\\partial x=\\partial/\\partial \\xi$, $\\partial/\\partial y=\\partial/\\partial \\eta$, and $\\partial/\\partial z=\\partial/\\partial \\zeta$. The standard trilinear shape functions are\n$$\nN_i(\\xi,\\eta,\\zeta)=\\frac{1}{8}\\left(1+\\xi_i \\xi\\right)\\left(1+\\eta_i \\eta\\right)\\left(1+\\zeta_i \\zeta\\right),\\quad i=1,\\dots,8.\n$$\nLet the displacement field be approximated as $u^x(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{8} N_i(\\xi,\\eta,\\zeta)\\,u_i^x$ with analogous expressions for $u^y$ and $u^z$. The small strain tensor in Voigt form at the single Gauss point $(\\xi,\\eta,\\zeta)=(0,0,0)$ involves the derivatives $\\partial N_i/\\partial \\xi$, $\\partial N_i/\\partial \\eta$, and $\\partial N_i/\\partial \\zeta$ at that point.\n\nDefine four scalar hourglass shape functions $\\gamma^{\\alpha}(\\xi,\\eta,\\zeta)$, for $\\alpha=1,2,3,4$, such that the associated nodal hourglass displacement patterns\n$$\nu_i^x=\\gamma^{\\alpha}(\\xi_i,\\eta_i,\\zeta_i)\\,a,\\quad u_i^y=0,\\quad u_i^z=0,\\quad i=1,\\dots,8,\n$$\nproduce zero strains at the Gauss point for any scalar amplitude $a$. Enforce the additional constraint $\\sum_{i=1}^{8}\\gamma^{\\alpha}(\\xi_i,\\eta_i,\\zeta_i)=0$ for each $\\alpha$ to exclude rigid translations. Use polynomial functions of $(\\xi,\\eta,\\zeta)$ with minimal total degree that satisfy these conditions.\n\nConstruct such a set of four linearly independent $\\gamma^{\\alpha}(\\xi,\\eta,\\zeta)$ and, using the node ordering above, assemble the corresponding nodal hourglass vectors $g^{\\alpha}=\\big(\\gamma^{\\alpha}(\\xi_1,\\eta_1,\\zeta_1),\\dots,\\gamma^{\\alpha}(\\xi_8,\\eta_8,\\zeta_8)\\big)$ for each $\\alpha$. Your derivation must start from the definitions of the trilinear shape functions and the small strain-displacement relation at the Gauss point, and justify why your choice yields zero strains.\n\nProvide your final answer as the row matrix $\\big(\\gamma^{1}(\\xi,\\eta,\\zeta)\\ \\gamma^{2}(\\xi,\\eta,\\zeta)\\ \\gamma^{3}(\\xi,\\eta,\\zeta)\\ \\gamma^{4}(\\xi,\\eta,\\zeta)\\big)$. No rounding is required. No physical units are required.", "solution": "The problem statement is subjected to validation.\n\nGivens are extracted verbatim:\n- Element type: eight-node trilinear hexahedral element ($\\text{Hex8}$).\n- Parent coordinates: $(\\xi,\\eta,\\zeta) \\in [-1,1]^3$.\n- Node ordering and coordinates: Node $1: (\\xi_1,\\eta_1,\\zeta_1)=(-1,-1,-1)$, up to Node $8: (\\xi_8,\\eta_8,\\zeta_8)=(-1,1,1)$.\n- Physical mapping: Identity, $\\partial/\\partial x=\\partial/\\partial \\xi$, $\\partial/\\partial y=\\partial/\\partial \\eta$, $\\partial/\\partial z=\\partial/\\partial \\zeta$.\n- Shape functions: $N_i(\\xi,\\eta,\\zeta)=\\frac{1}{8}\\left(1+\\xi_i \\xi\\right)\\left(1+\\eta_i \\eta\\right)\\left(1+\\zeta_i \\zeta\\right)$ for $i=1,\\dots,8$.\n- Displacement field: $u^x(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{8} N_i(\\xi,\\eta,\\zeta)\\,u_i^x$.\n- Integration point: Single Gauss point at $(\\xi,\\eta,\\zeta)=(0,0,0)$.\n- Strain definition: Small strain tensor in Voigt form at the Gauss point.\n- Hourglass shape functions: Four scalar functions $\\gamma^{\\alpha}(\\xi,\\eta,\\zeta)$ for $\\alpha=1,2,3,4$.\n- Hourglass condition: Nodal displacement patterns $u_i^x=\\gamma^{\\alpha}(\\xi_i,\\eta_i,\\zeta_i)\\,a$, $u_i^y=0$, $u_i^z=0$ ($i=1,\\dots,8$) produce zero strains at the Gauss point.\n- Orthogonality to translation: $\\sum_{i=1}^{8}\\gamma^{\\alpha}(\\xi_i,\\eta_i,\\zeta_i)=0$ for each $\\alpha$.\n- Minimality condition: $\\gamma^{\\alpha}(\\xi,\\eta,\\zeta)$ are polynomial functions of minimal total degree.\n\nValidation verdict:\nThe problem is scientifically grounded, well-posed, and objective. It is a standard exercise in the theory of the finite element method, specifically concerning the analysis of spurious zero-energy modes (hourglass modes) that arise from under-integration of elements. All definitions are standard, and the conditions are mathematically precise and consistent. The problem is complete and solvable. No violations of the specified criteria are found. The problem is deemed valid.\n\nThe solution proceeds as follows.\n\nThe displacement field in the $x$-direction is given by $u^x(\\xi,\\eta,\\zeta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta,\\zeta) u_i^x$. The components of the small strain tensor are functions of the spatial derivatives of the displacement field. Given the identity mapping, physical derivatives are equal to parent-coordinate derivatives. We are concerned with the strains at the single Gauss point $(\\xi, \\eta, \\zeta) = (0,0,0)$. For the given displacement pattern where only $u_i^x$ components are non-zero, the relevant strain components are $\\epsilon_{xx}$, $\\gamma_{xy}$, and $\\gamma_{zx}$ (engineering shear strains).\n\nThe strain components are:\n$$\n\\epsilon_{xx} = \\frac{\\partial u^x}{\\partial x} = \\frac{\\partial u^x}{\\partial \\xi} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} u_i^x\n$$\n$$\n\\gamma_{xy} = \\frac{\\partial u^x}{\\partial y} + \\frac{\\partial u^y}{\\partial x} = \\frac{\\partial u^x}{\\partial \\eta} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} u_i^x\n$$\n$$\n\\gamma_{zx} = \\frac{\\partial u^x}{\\partial z} + \\frac{\\partial u^z}{\\partial x} = \\frac{\\partial u^x}{\\partial \\zeta} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\zeta} u_i^x\n$$\nOther strain components, $\\epsilon_{yy}$, $\\epsilon_{zz}$, and $\\gamma_{yz}$, are identically zero because $u^y$ and $u^z$ are zero.\n\nTo evaluate these strains at the Gauss point $(\\xi,\\eta,\\zeta)=(0,0,0)$, we must first compute the derivatives of the shape functions at this point. The shape function for node $i$ is:\n$$\nN_i(\\xi,\\eta,\\zeta) = \\frac{1}{8}(1+\\xi_i\\xi)(1+\\eta_i\\eta)(1+\\zeta_i\\zeta)\n$$\nIts derivatives are:\n$$\n\\frac{\\partial N_i}{\\partial \\xi} = \\frac{1}{8}\\xi_i(1+\\eta_i\\eta)(1+\\zeta_i\\zeta)\n$$\n$$\n\\frac{\\partial N_i}{\\partial \\eta} = \\frac{1}{8}\\eta_i(1+\\xi_i\\xi)(1+\\zeta_i\\zeta)\n$$\n$$\n\\frac{\\partial N_i}{\\partial \\zeta} = \\frac{1}{8}\\zeta_i(1+\\xi_i\\xi)(1+\\eta_i\\eta)\n$$\nEvaluating these derivatives at $(\\xi, \\eta, \\zeta) = (0,0,0)$ yields:\n$$\n\\left.\\frac{\\partial N_i}{\\partial \\xi}\\right|_{(0,0,0)} = \\frac{1}{8}\\xi_i\n$$\n$$\n\\left.\\frac{\\partial N_i}{\\partial \\eta}\\right|_{(0,0,0)} = \\frac{1}{8}\\eta_i\n$$\n$$\n\\left.\\frac{\\partial N_i}{\\partial \\zeta}\\right|_{(0,0,0)} = \\frac{1}{8}\\zeta_i\n$$\nThe strains at the center are therefore:\n$$\n\\epsilon_{xx}|_{(0,0,0)} = \\frac{1}{8} \\sum_{i=1}^{8} \\xi_i u_i^x, \\quad\n\\gamma_{xy}|_{(0,0,0)} = \\frac{1}{8} \\sum_{i=1}^{8} \\eta_i u_i^x, \\quad\n\\gamma_{zx}|_{(0,0,0)} = \\frac{1}{8} \\sum_{i=1}^{8} \\zeta_i u_i^x\n$$\nAn hourglass mode is a nodal displacement pattern $\\{u_i^x\\}$ that produces zero strain at the integration point. Thus, the following conditions must hold:\n$$\n\\sum_{i=1}^{8} \\xi_i u_i^x = 0\n$$\n$$\n\\sum_{i=1}^{8} \\eta_i u_i^x = 0\n$$\n$$\n\\sum_{i=1}^{8} \\zeta_i u_i^x = 0\n$$\nThe problem defines the nodal displacement pattern in terms of a scalar function $\\gamma^{\\alpha}(\\xi,\\eta,\\zeta)$ evaluated at the nodal coordinates: $u_i^x = \\gamma^{\\alpha}(\\xi_i, \\eta_i, \\zeta_i) a$. Dropping the arbitrary amplitude $a$, we require:\n$$\n\\sum_{i=1}^{8} \\xi_i \\gamma^{\\alpha}(\\xi_i, \\eta_i, \\zeta_i) = 0\n$$\n$$\n\\sum_{i=1}^{8} \\eta_i \\gamma^{\\alpha}(\\xi_i, \\eta_i, \\zeta_i) = 0\n$$\n$$\n\\sum_{i=1}^{8} \\zeta_i \\gamma^{\\alpha}(\\xi_i, \\eta_i, \\zeta_i) = 0\n$$\nAdditionally, the problem requires the modes to be orthogonal to rigid body translation, which translates to:\n$$\n\\sum_{i=1}^{8} (1) \\cdot \\gamma^{\\alpha}(\\xi_i, \\eta_i, \\zeta_i) = 0\n$$\nLet us define four nodal vectors in $\\mathbb{R}^8$:\n$\\mathbf{h}_0 = (1, 1, \\dots, 1)^T$ (representing constant field)\n$\\mathbf{h}_1 = (\\xi_1, \\xi_2, \\dots, \\xi_8)^T = (-1, 1, 1, -1, -1, 1, 1, -1)^T$ (representing linear field in $\\xi$)\n$\\mathbf{h}_2 = (\\eta_1, \\eta_2, \\dots, \\eta_8)^T = (-1, -1, 1, 1, -1, -1, 1, 1)^T$ (representing linear field in $\\eta$)\n$\\mathbf{h}_3 = (\\zeta_1, \\zeta_2, \\dots, \\zeta_8)^T = (-1, -1, -1, -1, 1, 1, 1, 1)^T$ (representing linear field in $\\zeta$)\n\nThe nodal hourglass vector $\\mathbf{g}^{\\alpha} = (\\gamma^{\\alpha}(\\xi_1, \\eta_1, \\zeta_1), \\dots, \\gamma^{\\alpha}(\\xi_8, \\eta_8, \\zeta_8))^T$ must be orthogonal to each of these four vectors:\n$\\mathbf{g}^{\\alpha} \\cdot \\mathbf{h}_0 = 0$, $\\mathbf{g}^{\\alpha} \\cdot \\mathbf{h}_1 = 0$, $\\mathbf{g}^{\\alpha} \\cdot \\mathbf{h}_2 = 0$, $\\mathbf{g}^{\\alpha} \\cdot \\mathbf{h}_3 = 0$.\n\nThe vectors $\\mathbf{h}_0, \\mathbf{h}_1, \\mathbf{h}_2, \\mathbf{h}_3$ are mutually orthogonal, as $\\sum \\xi_i = \\sum \\eta_i = \\sum \\zeta_i = \\sum \\xi_i\\eta_i = \\sum \\eta_i\\zeta_i = \\sum \\zeta_i\\xi_i = 0$. Hence, they span a $4$-dimensional subspace of $\\mathbb{R}^8$. The hourglass modes must belong to the orthogonal complement of this subspace, which is also $4$-dimensional. We need to find four linearly independent polynomial functions $\\gamma^{\\alpha}(\\xi, \\eta, \\zeta)$ that generate a basis for this complement when evaluated at the nodes.\n\nWe seek polynomials of minimal degree.\nA degree-$0$ polynomial, $\\gamma(\\xi,\\eta,\\zeta) = c$, gives the nodal vector $c\\mathbf{h}_0$. The orthogonality condition $\\mathbf{g} \\cdot \\mathbf{h}_0 = 0$ gives $c \\mathbf{h}_0 \\cdot \\mathbf{h}_0 = 8c = 0$, so $c=0$.\nA degree-$1$ polynomial, $\\gamma(\\xi,\\eta,\\zeta) = c_0 + c_1\\xi + c_2\\eta + c_3\\zeta$, generates the nodal vector $\\mathbf{g} = c_0\\mathbf{h}_0 + c_1\\mathbf{h}_1 + c_2\\mathbf{h}_2 + c_3\\mathbf{h}_3$. For $\\mathbf{g}$ to be an hourglass mode, it must be orthogonal to $\\mathbf{h}_0, \\mathbf{h}_1, \\mathbf{h}_2, \\mathbf{h}_3$. Taking the dot product with $\\mathbf{h}_1$: $\\mathbf{g} \\cdot \\mathbf{h}_1 = c_1(\\mathbf{h}_1 \\cdot \\mathbf{h}_1) = 8c_1 = 0$, so $c_1=0$. Similarly, $c_2=0, c_3=0, c_0=0$. The only linear polynomial is the trivial one.\n\nTherefore, we search for polynomials of at least degree $2$. Consider the monomials $\\xi\\eta$, $\\eta\\zeta$, and $\\zeta\\xi$.\nLet $\\gamma^1(\\xi, \\eta, \\zeta) = \\xi\\eta$. The corresponding nodal vector $\\mathbf{g}^1$ has components $g_i^1 = \\xi_i \\eta_i$. Let's check orthogonality:\n$\\mathbf{g}^1 \\cdot \\mathbf{h}_0 = \\sum \\xi_i\\eta_i = 0$.\n$\\mathbf{g}^1 \\cdot \\mathbf{h}_1 = \\sum \\xi_i(\\xi_i\\eta_i) = \\sum \\xi_i^2\\eta_i = \\sum \\eta_i = 0$ (since $\\xi_i^2 = 1$).\n$\\mathbf{g}^1 \\cdot \\mathbf{h}_2 = \\sum \\eta_i(\\xi_i\\eta_i) = \\sum \\xi_i\\eta_i^2 = \\sum \\xi_i = 0$ (since $\\eta_i^2=1$).\n$\\mathbf{g}^1 \\cdot \\mathbf{h}_3 = \\sum \\zeta_i(\\xi_i\\eta_i) = \\sum \\xi_i\\eta_i\\zeta_i = (-1)+1+(-1)+1+1+(-1)+1+(-1) = 0$.\nThus, $\\gamma^1(\\xi,\\eta,\\zeta) = \\xi\\eta$ is a valid choice.\n\nBy symmetry, $\\gamma^2(\\xi,\\eta,\\zeta) = \\eta\\zeta$ and $\\gamma^3(\\xi,\\eta,\\zeta) = \\zeta\\xi$ are also valid choices. Let us confirm for $\\gamma^2=\\eta\\zeta$:\n$\\mathbf{g}^2 \\cdot \\mathbf{h}_0=\\sum\\eta_i\\zeta_i = 0$.\n$\\mathbf{g}^2 \\cdot \\mathbf{h}_1=\\sum\\xi_i\\eta_i\\zeta_i = 0$.\n$\\mathbf{g}^2 \\cdot \\mathbf{h}_2=\\sum\\eta_i^2\\zeta_i = \\sum\\zeta_i = 0$.\n$\\mathbf{g}^2 \\cdot \\mathbf{h}_3=\\sum\\zeta_i^2\\eta_i = \\sum\\eta_i = 0$.\nThe logic holds for $\\gamma^3 = \\zeta\\xi$ as well.\n\nFor the fourth mode, we look for a simple polynomial that is linearly independent of the first three. The next logical choice is the degree-$3$ monomial $\\gamma^4(\\xi,\\eta,\\zeta) = \\xi\\eta\\zeta$. The nodal vector $\\mathbf{g}^4$ has components $g_i^4 = \\xi_i\\eta_i\\zeta_i$. Checking orthogonality:\n$\\mathbf{g}^4 \\cdot \\mathbf{h}_0 = \\sum \\xi_i\\eta_i\\zeta_i = 0$.\n$\\mathbf{g}^4 \\cdot \\mathbf{h}_1 = \\sum \\xi_i(\\xi_i\\eta_i\\zeta_i) = \\sum \\eta_i\\zeta_i = 0$.\n$\\mathbf{g}^4 \\cdot \\mathbf{h}_2 = \\sum \\eta_i(\\xi_i\\eta_i\\zeta_i) = \\sum \\xi_i\\zeta_i = 0$.\n$\\mathbf{g}^4 \\cdot \\mathbf{h}_3 = \\sum \\zeta_i(\\xi_i\\eta_i\\zeta_i) = \\sum \\xi_i\\eta_i = 0$.\nThis is also a valid hourglass mode.\n\nThe four functions $\\gamma^1=\\xi\\eta$, $\\gamma^2=\\eta\\zeta$, $\\gamma^3=\\zeta\\xi$, and $\\gamma^4=\\xi\\eta\\zeta$ are linearly independent polynomials. They satisfy all the conditions posed by the problem and represent the standard set of hourglass modes for the trilinear hexahedron with one-point integration. These polynomials satisfy the minimal degree requirement as degree-$1$ modes were shown to be trivial.\n\nThe requested set of four linearly independent hourglass shape functions is thus established.\nThe nodal vectors are:\nFor $\\gamma^1 = \\xi\\eta$: $\\mathbf{g}^1 = (1, -1, 1, -1, 1, -1, 1, -1)^T$\nFor $\\gamma^2 = \\eta\\zeta$: $\\mathbf{g}^2 = (1, 1, -1, -1, -1, -1, 1, 1)^T$\nFor $\\gamma^3 = \\zeta\\xi$: $\\mathbf{g}^3 = (1, -1, -1, 1, -1, 1, 1, -1)^T$\nFor $\\gamma^4 = \\xi\\eta\\zeta$: $\\mathbf{g}^4 = (-1, 1, -1, 1, 1, -1, 1, -1)^T$\nThese four vectors are mutually orthogonal, confirming their linear independence.\n\nThe final answer is the set of functions themselves.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\xi\\eta & \\eta\\zeta & \\zeta\\xi & \\xi\\eta\\zeta\n\\end{pmatrix}\n}\n$$", "id": "2565900"}, {"introduction": "Knowing what hourglass modes are, our next task is to design a robust method to suppress them. Simply adding an arbitrary penalty stiffness is insufficient, as it can lead to results that depend inappropriately on element size or material properties. This practice elevates the discussion by introducing the principles of dimensional analysis and energetic consistency, guiding you to derive the correct scaling for the stabilization coefficient $c_{\\alpha}$ in terms of the material's shear modulus $\\mu$ and the element's characteristic size $h$. Mastering this concept is key to creating finite element formulations that are physically meaningful and reliable [@problem_id:2565907].", "problem": "Consider a homogeneous, isotropic, small-strain linear elastic solid in spatial dimension $d$, discretized by underintegrated low-order elements within the Finite Element Method (FEM). Let a representative element have characteristic size $h$, and let $\\mu$ denote the shear modulus. The shear contribution to the strain energy in an element $\\Omega_e$ for a displacement field $\\mathbf{u}$ is given by the integral of the shear energy density, with density proportional to $\\mu \\, \\varepsilon^{\\text{dev}} : \\varepsilon^{\\text{dev}}$, where $\\varepsilon = \\nabla^{s} \\mathbf{u}$ is the small-strain tensor and $\\varepsilon^{\\text{dev}}$ its deviatoric part. Assume a deformation with characteristic displacement amplitude $U$ and characteristic length scale $h$, so that the gradient magnitude scales like $\\|\\nabla \\mathbf{u}\\| \\sim U / h$. In underintegrated elements, there exist zero-energy modes (hourglass modes) that do not contribute to the strain energy computed by the reduced integration. A common stabilization augments the element energy by an hourglass penalty of the form\n$$\nE_{\\text{hg}} \\;=\\; \\sum_{\\alpha=1}^{m} c_{\\alpha} \\, q_{\\alpha}^{2},\n$$\nwhere $q_{\\alpha}$ are generalized coordinates measuring the amplitude of $m$ independent hourglass modes in the element and $c_{\\alpha}$ are stabilization coefficients. Assume that $m$ does not depend on $h$, and that each $q_{\\alpha}$ scales linearly with the displacement amplitude, i.e., $q_{\\alpha} \\sim U$, so that $\\dim(q_{\\alpha}) = \\dim(U)$.\n\nUsing only dimensional analysis and energetic consistency with the underlying linear elastic shear energy, determine the dependence of $c_{\\alpha}$ on $\\mu$ and $h$ in dimension $d$ such that $E_{\\text{hg}}$ scales with $U$ and $h$ in the same way as the continuum shear energy stored by a deformation with characteristic gradient $\\|\\nabla \\mathbf{u}\\| \\sim U/h$. Express your final result as a single closed-form expression in terms of $\\mu$, $h$, and $d$ that gives the correct scaling of $c_{\\alpha}$ with respect to $\\mu$ and $h$. Provide only this expression as your final answer, with no units attached.", "solution": "The problem requires the determination of the scaling dependence of the hourglass stabilization coefficient, denoted $c_{\\alpha}$, on the shear modulus $\\mu$ and the characteristic element size $h$ in a $d$-dimensional space. The method to be used is dimensional analysis and the enforcement of energetic consistency between the numerical penalty energy and the continuum shear energy.\n\nFirst, we establish the scaling of the continuum shear energy, $E_{\\text{shear}}$, within a representative finite element of volume $\\Omega_e$. The problem states that the shear energy density, $W_{\\text{shear}}$, is proportional to $\\mu \\, \\varepsilon^{\\text{dev}} : \\varepsilon^{\\text{dev}}$, where $\\varepsilon^{\\text{dev}}$ is the deviatoric part of the small-strain tensor $\\varepsilon$. The strain tensor is defined as the symmetric gradient of the displacement field $\\mathbf{u}$, i.e., $\\varepsilon = \\nabla^s \\mathbf{u}$.\n\nFor a deformation characterized by a displacement amplitude $U$ over a length scale $h$, the magnitude of the strain tensor scales as $\\|\\varepsilon\\| \\sim U/h$. Since strain is a ratio of a displacement to a length, it is a dimensionless quantity. The deviatoric part $\\varepsilon^{\\text{dev}}$ and the scalar invariant $\\varepsilon^{\\text{dev}} : \\varepsilon^{\\text{dev}}$ also scale in the same manner, so $\\varepsilon^{\\text{dev}} : \\varepsilon^{\\text{dev}} \\sim (U/h)^2$.\nThe shear energy density, therefore, scales as:\n$$\nW_{\\text{shear}} \\sim \\mu \\left( \\frac{U}{h} \\right)^2\n$$\nThe total shear energy within the element is obtained by integrating this density over the element's volume. In $d$ spatial dimensions, the volume of an element with characteristic size $h$ scales as $V_e \\sim h^d$. Thus, the scaling of the total shear energy is:\n$$\nE_{\\text{shear}} = \\int_{\\Omega_e} W_{\\text{shear}} \\, dV \\sim W_{\\text{shear}} \\cdot V_e \\sim \\left( \\mu \\frac{U^2}{h^2} \\right) h^d = \\mu U^2 h^{d-2}\n$$\nThis provides the target scaling that the hourglass stabilization energy must match.\n\nNext, we analyze the scaling of the provided hourglass penalty energy term, $E_{\\text{hg}}$. The formula is given as:\n$$\nE_{\\text{hg}} = \\sum_{\\alpha=1}^{m} c_{\\alpha} \\, q_{\\alpha}^{2}\n$$\nThe problem specifies that the number of modes, $m$, is a constant, and that the generalized hourglass coordinates, $q_{\\alpha}$, scale linearly with the displacement amplitude $U$. That is, $q_{\\alpha} \\sim U$. Assuming all stabilization coefficients $c_{\\alpha}$ share the same scaling behavior, the total penalty energy scales as:\n$$\nE_{\\text{hg}} \\sim c_{\\alpha} \\cdot q_{\\alpha}^{2} \\sim c_{\\alpha} \\cdot U^2\n$$\nTo ensure energetic consistency, the purpose of the hourglass stabilization is to account for the energy of the modes that are not captured by the reduced integration. Therefore, the scaling of $E_{\\text{hg}}$ must be identical to the scaling of the physical energy it represents, which is $E_{\\text{shear}}$. Equating the two scaling relations:\n$$\nc_{\\alpha} U^2 \\sim \\mu U^2 h^{d-2}\n$$\nThe factor $U^2$, which represents the quadratic dependence of energy on the amplitude of deformation, is common to both expressions and can be cancelled. This yields the scaling relation for the stabilization coefficient $c_{\\alpha}$:\n$$\nc_{\\alpha} \\sim \\mu h^{d-2}\n$$\nThis expression describes the required dependence of the stabilization coefficients on the shear modulus and element size in any spatial dimension $d$.", "answer": "$$\n\\boxed{\\mu h^{d-2}}\n$$", "id": "2565907"}, {"introduction": "This final practice serves as a computational laboratory, bridging the gap between theory and tangible results. You will implement a finite element program to simulate a cantilever beam, a structure whose bending behavior is notoriously sensitive to numerical artifacts. By comparing a fully integrated element to an under-integrated one, you will directly witness the severe, non-physical softening caused by hourglassing. You will then implement a stabilization scheme and quantitatively track how increasing the stabilization parameter recovers the correct physical stiffness, providing a powerful, hands-on demonstration of the entire topic [@problem_id:2565868].", "problem": "Consider the Finite Element Method (FEM) formulation for a single, four-node bilinear quadrilateral element (Q4) modeling a cantilever of length $L$ and height $H$ in plane stress, with constant thickness $t$ out of plane. The left edge ($x=0$) is clamped and a vertical tip load $P$ is applied at the top-right node. The material is linear elastic with Young’s modulus $E$ and Poisson’s ratio $\\nu$. The element nodes are ordered counterclockwise as $(0,0)$, $(L,0)$, $(L,H)$, $(0,H)$, labeled $1,2,3,4$. Each node has two displacement components, $u_x$ and $u_y$.\n\nStart from the Principle of Virtual Work and the standard bilinear isoparametric formulation. For plane stress, use the constitutive matrix\n$$\n\\mathbf{C} \\;=\\; \\frac{E}{1-\\nu^2}\\begin{bmatrix}\n1 & \\nu & 0\\\\\n\\nu & 1 & 0\\\\\n0 & 0 & \\tfrac{1-\\nu}{2}\n\\end{bmatrix}.\n$$\nLet $\\mathbf{B}(\\xi,\\eta)$ be the strain-displacement matrix built from the shape function derivatives at isoparametric coordinates $(\\xi,\\eta)$ and $\\mathbf{J}(\\xi,\\eta)$ the Jacobian. The element stiffness under numerical integration is\n$$\n\\mathbf{K} \\;=\\; \\int_{\\Omega_e} \\mathbf{B}^T \\mathbf{C} \\,\\mathbf{B}\\; t \\, d\\Omega \\;\\approx\\; \\sum_{g} \\mathbf{B}(\\xi_g,\\eta_g)^T \\mathbf{C}\\,\\mathbf{B}(\\xi_g,\\eta_g)\\; t\\;\\det\\big(\\mathbf{J}(\\xi_g,\\eta_g)\\big)\\; w_g.\n$$\nUse two integration schemes:\n- Fully integrated: a $2\\times 2$ Gauss rule with points at $\\xi,\\eta=\\pm 1/\\sqrt{3}$ and weights $w_g=1$.\n- Reduced integration: a $1\\times 1$ Gauss rule with a single point at $(\\xi,\\eta)=(0,0)$ and weight $w_g=4$.\n\nIt is well known that the reduced integration Q4 in bending admits spurious zero-energy “hourglass” modes that cause severe stiffness softening. To control hourglassing, augment the reduced-integration stiffness by a simple stiffness-based hourglass control of the Flanagan–Belytschko type. Define two nodal hourglass patterns for the four nodes:\n$$\n\\mathbf{s}^{(1)} \\;=\\; [\\,1,\\,-1,\\,1,\\,-1\\,],\\quad \\mathbf{s}^{(2)} \\;=\\; [\\,1,\\,1,\\,-1,\\,-1\\,].\n$$\nEmbed each pattern into the element’s $8$-component displacement vector by interleaving $x$- and $y$-components to form four hourglass vectors:\n$$\n\\mathbf{h}_{x}^{(k)} \\;=\\; [\\,s^{(k)}_1,\\,0,\\,s^{(k)}_2,\\,0,\\,s^{(k)}_3,\\,0,\\,s^{(k)}_4,\\,0\\,]^T,\\quad\n\\mathbf{h}_{y}^{(k)} \\;=\\; [\\,0,\\,s^{(k)}_1,\\,0,\\,s^{(k)}_2,\\,0,\\,s^{(k)}_3,\\,0,\\,s^{(k)}_4\\,]^T,\n$$\nfor $k\\in\\{1,2\\}$. Let the hourglass stiffness be\n$$\n\\mathbf{K}_{\\mathrm{hg}} \\;=\\; k_0 \\sum_{k=1}^{2}\\big(\\,\\mathbf{h}_{x}^{(k)} \\mathbf{h}_{x}^{(k)T} \\;+\\; \\mathbf{h}_{y}^{(k)} \\mathbf{h}_{y}^{(k)T}\\,\\big),\n$$\nwith scaling\n$$\nk_0 \\;=\\; c_{\\alpha}\\, G\\, t,\\qquad G \\;=\\; \\frac{E}{2(1+\\nu)},\n$$\nwhere $c_{\\alpha}\\ge 0$ is a dimensionless stabilization parameter. The reduced-integration stabilized stiffness is then\n$$\n\\mathbf{K}_{\\mathrm{RI,stab}}(c_{\\alpha}) \\;=\\; \\mathbf{K}_{\\mathrm{RI}} \\;+\\; \\mathbf{K}_{\\mathrm{hg}}(c_{\\alpha}).\n$$\nBoundary conditions: enforce a clamped left edge by fixing both $u_x$ and $u_y$ at nodes $1$ and $4$. Loading: apply a vertical point load $P$ downward at node $3$ (its $y$-degree of freedom).\n\nTo demonstrate hourglass softening and stiffness recovery, compute the ratio\n$$\nr(c_{\\alpha}) \\;=\\; \\frac{u_{y,\\,\\text{node }3}^{\\mathrm{(RI+hg)}}(c_{\\alpha})}{u_{y,\\,\\text{node }3}^{\\mathrm{(FI)}}},\n$$\nwhere the denominator uses the fully integrated stiffness and the numerator uses the reduced-integration stiffness augmented by the hourglass control with parameter $c_{\\alpha}$. A ratio $r(c_{\\alpha})>1$ indicates softening relative to the fully integrated reference; increasing $c_{\\alpha}$ should recover stiffness and drive $r(c_{\\alpha})$ toward $1$ or below, depending on over-stabilization.\n\nBecause $\\mathbf{K}_{\\mathrm{RI}}$ is rank-deficient for $c_{\\alpha}=0$, introduce a vanishing Tikhonov regularization on the free degrees of freedom to ensure solvability of the linear system only for the reduced-integration branch:\n$$\n\\mathbf{K}_{\\mathrm{RI,stab}}^{\\epsilon}(c_{\\alpha}) \\;=\\; \\mathbf{K}_{\\mathrm{RI,stab}}(c_{\\alpha}) \\;+\\; \\epsilon\\, E\\, t\\, \\mathbf{I}_{\\text{free}},\n$$\nwith $\\epsilon = 10^{-9}$, where $\\mathbf{I}_{\\text{free}}$ is the identity on the free-degree-of-freedom subspace. This perturbation is negligible for $c_{\\alpha}>0$ and only serves to regularize the $c_{\\alpha}=0$ case.\n\nUse the following physically consistent parameters:\n- $E = 2.10\\times 10^{11}\\,\\text{Pa}$,\n- $\\nu = 0.30$,\n- $t = 1.0\\times 10^{-2}\\,\\text{m}$,\n- $L = 1.0\\,\\text{m}$,\n- $H = 2.0\\times 10^{-1}\\,\\text{m}$,\n- $P = 1.0\\times 10^{3}\\,\\text{N}$.\n\nTest suite for the stabilization parameter:\n- Case $1$: $c_{\\alpha} = 0.0$ (pure reduced integration with vanishing regularization),\n- Case $2$: $c_{\\alpha} = 0.05$,\n- Case $3$: $c_{\\alpha} = 0.5$,\n- Case $4$: $c_{\\alpha} = 5.0$.\n\nYour task is to implement a complete program that:\n- assembles $\\mathbf{K}_{\\mathrm{FI}}$ via the $2\\times 2$ Gauss rule,\n- assembles $\\mathbf{K}_{\\mathrm{RI}}$ via the $1\\times 1$ Gauss rule,\n- augments $\\mathbf{K}_{\\mathrm{RI}}$ with $\\mathbf{K}_{\\mathrm{hg}}(c_{\\alpha})$ and $\\epsilon$-regularization as specified,\n- applies the boundary conditions and load,\n- solves for the displacement vector in each case,\n- extracts $u_{y}$ at node $3$ and forms $r(c_{\\alpha})$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in scientific notation with $6$ significant digits, in the order of the test suite. For example, the output must have the form\n$$\n[\\text{r}(0.0),\\text{r}(0.05),\\text{r}(0.5),\\text{r}(5.0)].\n$$\nAll outputs are dimensionless ratios, so no physical units are required.", "solution": "The problem as stated is subjected to rigorous validation.\n\nStep 1: Extract Givens.\n- **Element Type**: A single, four-node bilinear quadrilateral element (Q4) in plane stress.\n- **Geometry**: Length $L = 1.0\\,\\text{m}$, height $H = 2.0 \\times 10^{-1}\\,\\text{m}$, constant thickness $t = 1.0 \\times 10^{-2}\\,\\text{m}$.\n- **Nodal Coordinates**: Node 1: $(0,0)$, Node 2: $(L,0)$, Node 3: $(L,H)$, Node 4: $(0,H)$.\n- **Material Properties**: Young’s modulus $E = 2.10 \\times 10^{11}\\,\\text{Pa}$, Poisson’s ratio $\\nu = 0.30$.\n- **Constitutive Matrix (Plane Stress)**: $\\mathbf{C} = \\frac{E}{1-\\nu^2}\\begin{bmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\tfrac{1-\\nu}{2} \\end{bmatrix}$.\n- **Stiffness Matrix Integral**: $\\mathbf{K} \\approx \\sum_{g} \\mathbf{B}(\\xi_g,\\eta_g)^T \\mathbf{C}\\,\\mathbf{B}(\\xi_g,\\eta_g)\\; t\\;\\det\\big(\\mathbf{J}(\\xi_g,\\eta_g)\\big)\\; w_g$.\n- **Integration Schemes**:\n    - Full Integration (FI): $2 \\times 2$ Gauss rule, points at $\\xi,\\eta=\\pm 1/\\sqrt{3}$, weights $w_g=1$.\n    - Reduced Integration (RI): $1 \\times 1$ Gauss rule, point at $(\\xi,\\eta)=(0,0)$, weight $w_g=4$.\n- **Hourglass Control**:\n    - Nodal patterns: $\\mathbf{s}^{(1)} = [\\,1,\\,-1,\\,1,\\,-1\\,]$, $\\mathbf{s}^{(2)} = [\\,1,\\,1,\\,-1,\\,-1\\,]$.\n    - Hourglass vectors: $\\mathbf{h}_{x}^{(k)}$ and $\\mathbf{h}_{y}^{(k)}$ from embedded patterns $\\mathbf{s}^{(k)}$.\n    - Hourglass stiffness: $\\mathbf{K}_{\\mathrm{hg}} = k_0 \\sum_{k=1}^{2}\\big(\\,\\mathbf{h}_{x}^{(k)} \\mathbf{h}_{x}^{(k)T} \\;+\\; \\mathbf{h}_{y}^{(k)} \\mathbf{h}_{y}^{(k)T}\\,\\big)$.\n    - Scaling: $k_0 = c_{\\alpha}\\, G\\, t$, with $G = \\frac{E}{2(1+\\nu)}$ and $c_{\\alpha}$ as a dimensionless parameter.\n- **Stabilized Stiffness Matrix**: $\\mathbf{K}_{\\mathrm{RI,stab}}(c_{\\alpha}) = \\mathbf{K}_{\\mathrm{RI}} + \\mathbf{K}_{\\mathrm{hg}}(c_{\\alpha})$.\n- **Regularization for RI cases**: $\\mathbf{K}_{\\mathrm{RI,stab}}^{\\epsilon}(c_{\\alpha}) = \\mathbf{K}_{\\mathrm{RI,stab}}(c_{\\alpha}) + \\epsilon\\, E\\, t\\, \\mathbf{I}_{\\text{free}}$, with $\\epsilon = 10^{-9}$.\n- **Boundary Conditions**: Clamped left edge. Nodes $1$ and $4$ have all displacement components fixed ($u_x=0, u_y=0$).\n- **Loading**: Vertical point load $P = 1.0 \\times 10^{3}\\,\\text{N}$ applied downward at node $3$.\n- **Objective**: Compute the ratio $r(c_{\\alpha}) = \\frac{u_{y,\\,\\text{node }3}^{\\mathrm{(RI+hg)}}(c_{\\alpha})}{u_{y,\\,\\text{node }3}^{\\mathrm{(FI)}}}$.\n- **Test Suite**: $c_{\\alpha} \\in \\{0.0, 0.05, 0.5, 5.0\\}$.\n\nStep 2: Validate Using Extracted Givens.\n- **Scientific Grounding**: The problem is rooted in the finite element method, a cornerstone of computational mechanics. The concepts of bilinear elements, reduced integration, hourglass instability, and Flanagan-Belytschko stabilization are standard textbook material. All equations and definitions are scientifically correct.\n- **Well-Posedness**: The problem is well-posed. It details the geometry, material, loads, and boundary conditions. The potential singularity of the reduced integration stiffness matrix is explicitly acknowledged and addressed with a Tikhonov regularization, ensuring a unique solution can be found in all cases.\n- **Objectivity**: The problem is stated in precise, objective, and mathematical language, free from any subjectivity or ambiguity.\n- **Conclusion**: The problem does not violate any of the specified invalidity criteria. It is a complete, consistent, and scientifically sound problem suitable for computational analysis.\n\nStep 3: Verdict and Action.\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe analysis begins with the standard isoparametric formulation for a four-node quadrilateral element. The element has eight degrees of freedom (DOFs), contained in the nodal displacement vector $\\mathbf{d} = [u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4]^T$.\n\n**1. Isoparametric Formulation**\n\nThe physical coordinates $(x,y)$ are mapped from the isoparametric coordinates $(\\xi, \\eta)$, where $\\xi, \\eta \\in [-1, 1]$, using the bilinear shape functions $N_i(\\xi, \\eta)$:\n$$\nN_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\quad N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\n$$\n$$\nN_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\quad N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n$$\nThe coordinate transformation is $x(\\xi, \\eta) = \\sum_{i=1}^4 N_i(\\xi, \\eta) x_i$ and $y(\\xi, \\eta) = \\sum_{i=1}^4 N_i(\\xi, \\eta) y_i$. For the specified rectangular element with nodes at $(0,0)$, $(L,0)$, $(L,H)$, and $(0,H)$, this simplifies to:\n$$\nx(\\xi, \\eta) = \\frac{L}{2}(1+\\xi) \\quad y(\\xi, \\eta) = \\frac{H}{2}(1+\\eta)\n$$\nThe Jacobian of this transformation is a constant matrix:\n$$\n\\mathbf{J} = \\begin{pmatrix} \\partial x / \\partial\\xi & \\partial y / \\partial\\xi \\\\ \\partial x / \\partial\\eta & \\partial y / \\partial\\eta \\end{pmatrix} = \\begin{pmatrix} L/2 & 0 \\\\ 0 & H/2 \\end{pmatrix}\n$$\nThe determinant of the Jacobian is $\\det(\\mathbf{J}) = L H / 4$.\n\nThe strain field $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^T$ is related to the nodal displacements $\\mathbf{d}$ via the strain-displacement matrix $\\mathbf{B}(\\xi, \\eta)$: $\\boldsymbol{\\varepsilon} = \\mathbf{B}(\\xi, \\eta) \\mathbf{d}$. The matrix $\\mathbf{B}$ is formulated using the derivatives of the shape functions. For a node $i$, the matrix $\\mathbf{B}_i$ is:\n$$\n\\mathbf{B}_i(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{pmatrix}\n$$\nwhere the derivatives with respect to $x$ and $y$ are found using the chain rule:\n$$\n\\begin{Bmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{Bmatrix} = \\mathbf{J}^{-1} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{Bmatrix} = \\begin{pmatrix} 2/L & 0 \\\\ 0 & 2/H \\end{pmatrix} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{Bmatrix}\n$$\nThe full $3 \\times 8$ matrix $\\mathbf{B}$ is constructed by concatenating the individual $\\mathbf{B}_i$ matrices: $\\mathbf{B} = [\\mathbf{B}_1, \\mathbf{B}_2, \\mathbf{B}_3, \\mathbf{B}_4]$.\n\n**2. Stiffness Matrix Assembly**\n\nThe element stiffness matrix is given by the integral $\\mathbf{K} = \\int_{V_e} \\mathbf{B}^T \\mathbf{C} \\mathbf{B} \\, dV$. For a constant thickness $t$, this becomes $\\mathbf{K} = t \\int_{A_e} \\mathbf{B}^T \\mathbf{C} \\mathbf{B} \\, dA$. In isoparametric coordinates, this is:\n$$\n\\mathbf{K} = t \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{B}(\\xi, \\eta)^T \\mathbf{C} \\,\\mathbf{B}(\\xi, \\eta) \\det(\\mathbf{J}) \\, d\\xi d\\eta\n$$\nThis integral is evaluated numerically using Gauss quadrature.\n\n- **Fully Integrated Stiffness ($\\mathbf{K}_{\\mathrm{FI}}$)**: A $2 \\times 2$ Gauss rule is used. The four integration points are $(\\xi_g, \\eta_g) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$, and all weights are $w_g=1$.\n$$\n\\mathbf{K}_{\\mathrm{FI}} = t \\cdot \\det(\\mathbf{J}) \\sum_{g=1}^{4} \\mathbf{B}(\\xi_g, \\eta_g)^T \\mathbf{C} \\,\\mathbf{B}(\\xi_g, \\eta_g) \\cdot (1)\n$$\nThis scheme integrates the stiffness terms exactly for a rectangular element and produces a robust, non-singular stiffness matrix.\n\n- **Reduced Integration Stiffness ($\\mathbf{K}_{\\mathrm{RI}}$)**: A $1 \\times 1$ Gauss rule is used with a single integration point at the element center, $(\\xi_g, \\eta_g) = (0, 0)$, and a weight $w_g=4$.\n$$\n\\mathbf{K}_{\\mathrm{RI}} = t \\cdot \\det(\\mathbf{J}) \\cdot \\mathbf{B}(0, 0)^T \\mathbf{C} \\,\\mathbf{B}(0, 0) \\cdot (4)\n$$\nThis scheme is computationally efficient but fails to capture certain deformation modes, known as hourglass or zero-energy modes, leading to a rank-deficient stiffness matrix.\n\n**3. Hourglass Stabilization**\n\nTo counteract the rank deficiency of $\\mathbf{K}_{\\mathrm{RI}}$, an artificial stiffness term $\\mathbf{K}_{\\mathrm{hg}}$ is added. The method prescribed is of the Flanagan-Belytschko type. The hourglass vectors $\\mathbf{h}_{x}^{(k)}$ and $\\mathbf{h}_{y}^{(k)}$ for $k \\in \\{1,2\\}$ are constructed to be orthogonal to the constant-strain modes captured by the reduced integration. The hourglass stiffness is:\n$$\n\\mathbf{K}_{\\mathrm{hg}}(c_{\\alpha}) = k_0 \\sum_{k=1}^{2}\\big(\\,\\mathbf{h}_{x}^{(k)} \\mathbf{h}_{x}^{(k)T} \\;+\\; \\mathbf{h}_{y}^{(k)} \\mathbf{h}_{y}^{(k)T}\\,\\big)\n$$\nThe scaling factor $k_0 = c_{\\alpha} G t$ depends on the shear modulus $G = E / (2(1+\\nu))$, thickness $t$, and the dimensionless stabilization parameter $c_{\\alpha}$. The total stabilized stiffness for the reduced integration case is:\n$$\n\\mathbf{K}_{\\mathrm{RI,stab}}(c_{\\alpha}) = \\mathbf{K}_{\\mathrm{RI}} + \\mathbf{K}_{\\mathrm{hg}}(c_{\\alpha})\n$$\n\n**4. System Solution**\n\nThe governing static equilibrium equation is $\\mathbf{K}\\mathbf{d} = \\mathbf{F}$.\n- **Boundary Conditions (BCs)**: The left edge is clamped, so nodes $1$ and $4$ are fixed. This means DOFs $u_1, v_1, u_4, v_4$ (indices $0, 1, 6, 7$) are zero. The free DOFs are $u_2, v_2, u_3, v_3$ (indices $2, 3, 4, 5$). The system is partitioned into free and fixed components. Let $\\mathbf{d}_{\\text{free}} = [u_2, v_2, u_3, v_3]^T$. The reduced system is $\\mathbf{K}_{\\text{free}} \\mathbf{d}_{\\text{free}} = \\mathbf{F}_{\\text{free}}$. $\\mathbf{K}_{\\text{free}}$ is the $4 \\times 4$ submatrix of $\\mathbf{K}$ corresponding to the free DOFs.\n- **Load Vector**: A vertical load $P$ acts downward on node $3$. The force vector for the free DOFs is $\\mathbf{F}_{\\text{free}} = [0, 0, 0, -P]^T$.\n- **Regularization**: For the RI cases, a small perturbation is added to the diagonal of the partitioned free stiffness matrix to ensure invertibility when $c_{\\alpha} = 0$:\n$$\n\\mathbf{K}_{\\text{free, stab}}^{\\epsilon}(c_{\\alpha}) = \\mathbf{K}_{\\text{free, (RI+hg)}}(c_{\\alpha}) + \\epsilon E t \\mathbf{I}_{4 \\times 4}\n$$\n- **Solving**: The system is solved for the displacement vector $\\mathbf{d}_{\\text{free}}$. The vertical displacement of node $3$, $u_{y, \\text{node } 3}$, corresponds to the fourth component of the solution vector $\\mathbf{d}_{\\text{free}}$.\n\nThe procedure is:\n1.  Compute $\\mathbf{K}_{\\mathrm{FI}}$, partition it, solve for $\\mathbf{d}_{\\text{free}}^{\\mathrm{(FI)}}$, and extract the reference displacement $u_{y, \\text{node } 3}^{\\mathrm{(FI)}}$.\n2.  For each test value of $c_{\\alpha}$:\n    a. Compute $\\mathbf{K}_{\\mathrm{RI}}$ and $\\mathbf{K}_{\\mathrm{hg}}(c_{\\alpha})$.\n    b. Form $\\mathbf{K}_{\\mathrm{RI,stab}}(c_{\\alpha}) = \\mathbf{K}_{\\mathrm{RI}} + \\mathbf{K}_{\\mathrm{hg}}(c_{\\alpha})$.\n    c. Partition to get $\\mathbf{K}_{\\text{free, (RI+hg)}}$.\n    d. Add regularization: $\\mathbf{K}_{\\text{free, stab}}^{\\epsilon} = \\mathbf{K}_{\\text{free, (RI+hg)}} + (\\epsilon E t) \\mathbf{I}$.\n    e. Solve $\\mathbf{K}_{\\text{free, stab}}^{\\epsilon} \\mathbf{d}_{\\text{free}}^{\\mathrm{(RI+hg)}} = \\mathbf{F}_{\\text{free}}$.\n    f. Extract $u_{y, \\text{node } 3}^{\\mathrm{(RI+hg)}}(c_{\\alpha})$.\n    g. Calculate the ratio $r(c_{\\alpha}) = u_{y, \\text{node } 3}^{\\mathrm{(RI+hg)}}(c_{\\alpha}) / u_{y, \\text{node } 3}^{\\mathrm{(FI)}}$.\n\nWhen $c_{\\alpha}=0$, the element is overly flexible, so $r(0)$ is expected to be large. As $c_{\\alpha}$ increases, the added stiffness controls the spurious modes, and $r(c_{\\alpha})$ should decrease, approaching a value near $1.0$. A very large $c_{\\alpha}$ can lead to over-stiffening (locking), causing $r(c_{\\alpha}) < 1$.", "answer": "$$\n[3.93175e+02,1.25881e+00,1.02677e+00,9.15589e-01]\n$$", "id": "2565868"}]}