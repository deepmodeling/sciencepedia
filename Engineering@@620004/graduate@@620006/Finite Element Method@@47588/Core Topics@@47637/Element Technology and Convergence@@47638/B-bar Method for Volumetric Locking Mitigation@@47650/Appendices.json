{"hands_on_practices": [{"introduction": "We begin our practical exploration with the three-node triangular element (T3), also known as the Constant Strain Triangle (CST). This exercise serves as a crucial baseline to understand the scope and limitations of the B-bar method. By deriving its strain-displacement matrix, you will discover firsthand why the B-bar modification is trivial for this specific element, thereby highlighting the conditions under which volumetric locking becomes a problem that necessitates a targeted solution. [@problem_id:2542571]", "problem": "Consider a small-strain two-dimensional triangular $T3$ element in the Finite Element Method (FEM) with nodes at coordinates $(x_{1},y_{1})=(0,0)$, $(x_{2},y_{2})=(L,0)$, and $(x_{3},y_{3})=(0,H)$. Let the in-plane displacement field be interpolated by linear shape functions as $u(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)\\,u_{i}$ and $v(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)\\,v_{i}$, where $(u_{i},v_{i})$ are the nodal displacement components. Adopt the small-strain kinematics with $\\epsilon_{xx}=\\partial u/\\partial x$, $\\epsilon_{yy}=\\partial v/\\partial y$, and $\\gamma_{xy}=\\partial u/\\partial y+\\partial v/\\partial x$. The strain-displacement matrix $B$ is defined by $\\epsilon=B\\,d$ with the nodal displacement vector $d=[u_{1},v_{1},u_{2},v_{2},u_{3},v_{3}]^{\\mathsf{T}}$. The B-bar method (also called the modified volumetric strain method) replaces the volumetric strain operator by its element $L^{2}$-projection, i.e., the element-average of the volumetric strain field.\n\nStarting from these definitions only (do not assume a priori formulas for the $T3$ element), perform the following:\n\n- Derive the linear shape functions $N_{1}(x,y)$, $N_{2}(x,y)$, and $N_{3}(x,y)$ for this right triangle and compute all their first derivatives with respect to $x$ and $y$.\n- Assemble the $3\\times 6$ strain-displacement matrix $B$ for the in-plane strains $(\\epsilon_{xx},\\epsilon_{yy},\\gamma_{xy})^{\\mathsf{T}}$.\n- Using $B$, determine the volumetric strain field $\\epsilon_{v}(x,y)=\\epsilon_{xx}(x,y)+\\epsilon_{yy}(x,y)$ and verify whether it is constant across the element domain.\n- Then, apply the B-bar methodâ€™s elementwise $L^{2}$-projection of the volumetric strain and compute the projected volumetric strain $\\bar{\\epsilon}_{v}=\\dfrac{1}{A}\\int_{\\Omega_{e}}\\epsilon_{v}\\,\\mathrm{d}A$, where $A$ is the element area and $\\Omega_{e}$ is the element domain.\n\nExpress your final answer as a single closed-form analytic expression for $\\bar{\\epsilon}_{v}$ in terms of $L$, $H$, and the nodal displacement components $u_{1}$, $v_{1}$, $u_{2}$, $v_{2}$, $u_{3}$, $v_{3}$. No numerical evaluation is required. State the result without units. Also, justify in your derivation whether the B-bar modification alters the volumetric strain for this element and briefly discuss the implication for volumetric locking in the nearly incompressible limit of plane strain elasticity. The final answer must be a single analytic expression only.", "solution": "The problem will first be subjected to a rigorous validation.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- Element: Two-dimensional triangular $T3$ element.\n- Nodal Coordinates: $(x_{1},y_{1})=(0,0)$, $(x_{2},y_{2})=(L,0)$, $(x_{3},y_{3})=(0,H)$.\n- Displacement Field Interpolation: $u(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)\\,u_{i}$ and $v(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)\\,v_{i}$.\n- Nodal Displacements: $(u_{i},v_{i})$.\n- Small-Strain Kinematics: $\\epsilon_{xx}=\\partial u/\\partial x$, $\\epsilon_{yy}=\\partial v/\\partial y$, and $\\gamma_{xy}=\\partial u/\\partial y+\\partial v/\\partial x$.\n- Strain-Displacement Relation: $\\epsilon=B\\,d$.\n- Nodal Displacement Vector: $d=[u_{1},v_{1},u_{2},v_{2},u_{3},v_{3}]^{\\mathsf{T}}$.\n- Strain Vector: $\\epsilon = (\\epsilon_{xx},\\epsilon_{yy},\\gamma_{xy})^{\\mathsf{T}}$.\n- B-bar Method Definition: Volumetric strain operator is replaced by its element $L^{2}$-projection (element-average).\n- Projected Volumetric Strain: $\\bar{\\epsilon}_{v}=\\dfrac{1}{A}\\int_{\\Omega_{e}}\\epsilon_{v}\\,\\mathrm{d}A$, where $\\epsilon_v = \\epsilon_{xx}+\\epsilon_{yy}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed for validity:\n- **Scientifically Grounded**: The problem is a standard exercise in the Finite Element Method (FEM), specifically dealing with the formulation of a constant strain triangular (T3) element and the application of the B-bar method. All concepts are fundamental to computational mechanics. It is scientifically sound.\n- **Well-Posed**: The problem is clearly defined, with all necessary information provided to derive the requested quantities. A unique, meaningful solution exists.\n- **Objective**: The problem is stated using precise, formal language, free of ambiguity or subjective content.\n\nThe problem does not violate any of the invalidity criteria. It is a well-posed, scientifically grounded problem from the field of computational solid mechanics.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will now be provided.\n\n**Derivation of Solution**\n\nThe derivation will proceed in the sequence requested.\n\n**1. Linear Shape Functions and Their Derivatives**\nA linear polynomial in two dimensions is of the form $f(x,y) = a + bx + cy$. The shape functions $N_{i}(x,y)$ must satisfy the property $N_{i}(x_{j},y_{j}) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n\nFor $N_{1}(x,y) = a_{1} + b_{1}x + c_{1}y$:\n$N_{1}(x_{1},y_{1}) = N_{1}(0,0) = a_{1} = 1$.\n$N_{1}(x_{2},y_{2}) = N_{1}(L,0) = a_{1} + b_{1}L = 1 + b_{1}L = 0 \\implies b_{1} = -\\frac{1}{L}$.\n$N_{1}(x_{3},y_{3}) = N_{1}(0,H) = a_{1} + c_{1}H = 1 + c_{1}H = 0 \\implies c_{1} = -\\frac{1}{H}$.\nThus, $N_{1}(x,y) = 1 - \\frac{x}{L} - \\frac{y}{H}$.\n\nFor $N_{2}(x,y) = a_{2} + b_{2}x + c_{2}y$:\n$N_{2}(x_{1},y_{1}) = N_{2}(0,0) = a_{2} = 0$.\n$N_{2}(x_{2},y_{2}) = N_{2}(L,0) = a_{2} + b_{2}L = b_{2}L = 1 \\implies b_{2} = \\frac{1}{L}$.\n$N_{2}(x_{3},y_{3}) = N_{2}(0,H) = a_{2} + c_{2}H = c_{2}H = 0 \\implies c_{2} = 0$.\nThus, $N_{2}(x,y) = \\frac{x}{L}$.\n\nFor $N_{3}(x,y) = a_{3} + b_{3}x + c_{3}y$:\n$N_{3}(x_{1},y_{1}) = N_{3}(0,0) = a_{3} = 0$.\n$N_{3}(x_{2},y_{2}) = N_{3}(L,0) = a_{3} + b_{3}L = b_{3}L = 0 \\implies b_{3} = 0$.\n$N_{3}(x_{3},y_{3}) = N_{3}(0,H) = a_{3} + c_{3}H = c_{3}H = 1 \\implies c_{3} = \\frac{1}{H}$.\nThus, $N_{3}(x,y) = \\frac{y}{H}$.\n\nThe first derivatives of the shape functions are:\n$\\frac{\\partial N_{1}}{\\partial x} = -\\frac{1}{L}$, $\\frac{\\partial N_{1}}{\\partial y} = -\\frac{1}{H}$\n$\\frac{\\partial N_{2}}{\\partial x} = \\frac{1}{L}$, $\\frac{\\partial N_{2}}{\\partial y} = 0$\n$\\frac{\\partial N_{3}}{\\partial x} = 0$, $\\frac{\\partial N_{3}}{\\partial y} = \\frac{1}{H}$\nObserve that all first derivatives are constant with respect to $x$ and $y$.\n\n**2. Strain-Displacement Matrix $B$**\nThe strain field $\\epsilon$ is related to the nodal displacement vector $d$ by $\\epsilon = B d$. The components of the strain field are:\n$\\epsilon_{xx} = \\frac{\\partial u}{\\partial x} = \\sum_{i=1}^{3} \\frac{\\partial N_{i}}{\\partial x} u_{i} = \\frac{\\partial N_{1}}{\\partial x}u_{1} + \\frac{\\partial N_{2}}{\\partial x}u_{2} + \\frac{\\partial N_{3}}{\\partial x}u_{3} = -\\frac{1}{L}u_{1} + \\frac{1}{L}u_{2}$.\n$\\epsilon_{yy} = \\frac{\\partial v}{\\partial y} = \\sum_{i=1}^{3} \\frac{\\partial N_{i}}{\\partial y} v_{i} = \\frac{\\partial N_{1}}{\\partial y}v_{1} + \\frac{\\partial N_{2}}{\\partial y}v_{2} + \\frac{\\partial N_{3}}{\\partial y}v_{3} = -\\frac{1}{H}v_{1} + \\frac{1}{H}v_{3}$.\n$\\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = \\left(\\sum_{i=1}^{3} \\frac{\\partial N_{i}}{\\partial y} u_{i}\\right) + \\left(\\sum_{i=1}^{3} \\frac{\\partial N_{i}}{\\partial x} v_{i}\\right) = \\left(-\\frac{1}{H}u_{1} + \\frac{1}{H}u_{3}\\right) + \\left(-\\frac{1}{L}v_{1} + \\frac{1}{L}v_{2}\\right)$.\n\nThe matrix $B$ is constructed by placing the coefficients of the nodal displacements $(u_i, v_i)$ in the appropriate columns.\n$$\n\\begin{pmatrix} \\epsilon_{xx} \\\\ \\epsilon_{yy} \\\\ \\gamma_{xy} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial N_1}{\\partial x} & 0 & \\frac{\\partial N_2}{\\partial x} & 0 & \\frac{\\partial N_3}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_1}{\\partial y} & 0 & \\frac{\\partial N_2}{\\partial y} & 0 & \\frac{\\partial N_3}{\\partial y} \\\\ \\frac{\\partial N_1}{\\partial y} & \\frac{\\partial N_1}{\\partial x} & \\frac{\\partial N_2}{\\partial y} & \\frac{\\partial N_2}{\\partial x} & \\frac{\\partial N_3}{\\partial y} & \\frac{\\partial N_3}{\\partial x} \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ v_1 \\\\ u_2 \\\\ v_2 \\\\ u_3 \\\\ v_3 \\end{pmatrix}\n$$\n\nSubstituting the constant derivatives gives the strain-displacement matrix $B$:\n$$B = \\begin{pmatrix} -\\frac{1}{L} & 0 & \\frac{1}{L} & 0 & 0 & 0 \\\\ 0 & -\\frac{1}{H} & 0 & 0 & 0 & \\frac{1}{H} \\\\ -\\frac{1}{H} & -\\frac{1}{L} & 0 & \\frac{1}{L} & \\frac{1}{H} & 0 \\end{pmatrix}$$\n\n**3. Volumetric Strain Field $\\epsilon_{v}(x,y)$**\nThe volumetric strain is $\\epsilon_{v} = \\epsilon_{xx} + \\epsilon_{yy}$. From the expressions derived above:\n$\\epsilon_{v}(x,y) = \\left(-\\frac{1}{L}u_{1} + \\frac{1}{L}u_{2}\\right) + \\left(-\\frac{1}{H}v_{1} + \\frac{1}{H}v_{3}\\right)$.\nThis can be written as:\n$\\epsilon_{v} = \\frac{1}{L}(u_{2} - u_{1}) + \\frac{1}{H}(v_{3} - v_{1})$.\nSince the nodal displacements $(u_{i}, v_{i})$ and the element dimensions $L$ and $H$ are constants for a given analysis step, the quantities $\\epsilon_{xx}$, $\\epsilon_{yy}$, and consequently $\\epsilon_{v}$, are constant throughout the element domain $\\Omega_{e}$. This is the defining characteristic of the Constant Strain Triangle (CST) element.\n\n**4. Projected Volumetric Strain $\\bar{\\epsilon}_{v}$ and Discussion**\nThe B-bar method computes the element-averaged volumetric strain $\\bar{\\epsilon}_{v}$ by the formula:\n$\\bar{\\epsilon}_{v} = \\frac{1}{A} \\int_{\\Omega_{e}} \\epsilon_{v}(x,y) \\, \\mathrm{d}A$.\nThe area of the right triangular element is $A = \\frac{1}{2}LH$.\nAs established, $\\epsilon_{v}$ is constant over the domain $\\Omega_{e}$. Therefore, it can be factored out of the integral:\n$\\bar{\\epsilon}_{v} = \\frac{1}{A} \\epsilon_{v} \\int_{\\Omega_{e}} \\, \\mathrm{d}A = \\frac{1}{A} \\epsilon_{v} A = \\epsilon_{v}$.\nThe projected volumetric strain is identical to the original volumetric strain field:\n$\\bar{\\epsilon}_{v} = \\frac{1}{L}(u_{2} - u_{1}) + \\frac{1}{H}(v_{3} - v_{1})$.\n\n**Justification and Discussion**:\nFor the linear triangular (T3) element, the B-bar modification does not alter the volumetric strain, i.e., $\\bar{\\epsilon}_{v} = \\epsilon_{v}$. This is because the standard formulation of the T3 element already produces a constant volumetric strain field, and the average of a constant field is the constant itself. The operation is a trivial identity.\n\nThe implication for volumetric locking is significant. Volumetric locking is a numerical artifact in FEM where an element becomes overly stiff when analyzing nearly-incompressible materials (Poisson's ratio $\\nu \\to 0.5$). This occurs because the element's kinematic description (the shape functions) cannot adequately represent the zero-volume-change (isochoric) deformation modes required by the material law. The T3 element, with its constant strain field, is particularly poor in this regard. Because the B-bar method does not change the volumetric strain operator for the T3 element ($\\bar{B}=B$), it offers no improvement and is completely ineffective at mitigating volumetric locking for this element type. To alleviate locking, one must use higher-order elements (e.g., quadratic elements with reduced integration) or mixed formulations, where the B-bar method or equivalent techniques genuinely modify the strain field to relax the incompressibility constraint.", "answer": "$$\\boxed{\\frac{u_{2}-u_{1}}{L} + \\frac{v_{3}-v_{1}}{H}}$$", "id": "2542571"}, {"introduction": "Having established why the B-bar method is not needed for a T3 element, we now turn to the four-node bilinear quadrilateral (Q4), a workhorse element that is susceptible to volumetric locking. This practice is a fundamental exercise in deriving the core component of the B-bar method: the element-averaged volumetric strain-displacement operator, $\\bar{\\boldsymbol{B}}_{\\text{vol}}$. Completing this derivation will solidify your understanding of the isoparametric formulation and the practical mechanics of implementing the B-bar correction in a situation where it is genuinely required. [@problem_id:2542562]", "problem": "Consider a four-node bilinear quadrilateral (Q4) finite element in two-dimensional plane strain. Let the physical element occupy the unit square with vertices at $(0,0)$, $(1,0)$, $(1,1)$, $(0,1)$ in the physical coordinates $(x,y)$. The isoparametric parent coordinates are $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$, and the mapping to the physical element is affine, given by $x=\\tfrac{1}{2}(1+\\xi)$ and $y=\\tfrac{1}{2}(1+\\eta)$. The nodal displacement vector for the element is ordered as\n$$\n\\boldsymbol{d}_e=\\begin{bmatrix}u_{1x} & u_{1y} & u_{2x} & u_{2y} & u_{3x} & u_{3y} & u_{4x} & u_{4y}\\end{bmatrix}^{\\mathsf{T}}.\n$$\nIn plane strain, the volumetric strain at a point is defined as the trace of the infinitesimal strain tensor, $\\epsilon_v=\\epsilon_{xx}+\\epsilon_{yy}$. The associated volumetric strain-displacement operator row is $\\boldsymbol{B}_{\\text{vol}}(x,y)$ such that $\\epsilon_v(x,y)=\\boldsymbol{B}_{\\text{vol}}(x,y)\\,\\boldsymbol{d}_e$. For a Q4 element,\n$$\n\\boldsymbol{B}_{\\text{vol}}(x,y)=\\begin{bmatrix}N_{1,x} & N_{1,y} & N_{2,x} & N_{2,y} & N_{3,x} & N_{3,y} & N_{4,x} & N_{4,y}\\end{bmatrix},\n$$\nwhere $N_i(\\xi,\\eta)$ are the standard bilinear shape functions and subscripts $x,y$ denote partial derivatives with respect to the physical coordinates. The $B$-bar method replaces $\\boldsymbol{B}_{\\text{vol}}(x,y)$ by its element-wise average\n$$\n\\bar{\\boldsymbol{B}}_{\\text{vol}}=\\frac{1}{A_e}\\int_{\\Omega_e}\\boldsymbol{B}_{\\text{vol}}(x,y)\\,\\mathrm{d}\\Omega,\n$$\nwhere $A_e$ is the element area and $\\Omega_e$ its domain.\n\nStarting from these definitions and using only the mapping, the standard bilinear shape functions on $[-1,1]^2$, and the change of variables formula for integrals, derive a closed-form expression for the averaged volumetric operator row $\\bar{\\boldsymbol{B}}_{\\text{vol}}$ for this unit-square element. Show explicitly from your derivation why the result is constant over the element. Express your final result as an $1\\times 8$ row matrix in exact rational numbers, ordered as $\\begin{bmatrix}N_{1,x} & N_{1,y} & N_{2,x} & N_{2,y} & N_{3,x} & N_{3,y} & N_{4,x} & N_{4,y}\\end{bmatrix}$. No rounding is required and no physical units are needed.", "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It constitutes a standard exercise in the theory of the finite element method. All provided information is consistent and sufficient for deriving a unique, verifiable solution. We shall therefore proceed with the derivation.\n\nThe objective is to compute the averaged volumetric strain-displacement operator, $\\bar{\\boldsymbol{B}}_{\\text{vol}}$, for a specific four-node bilinear quadrilateral (Q$4$) element. This operator is defined as the element-wise average of the local operator $\\boldsymbol{B}_{\\text{vol}}(x,y)$:\n$$\n\\bar{\\boldsymbol{B}}_{\\text{vol}} = \\frac{1}{A_e}\\int_{\\Omega_e}\\boldsymbol{B}_{\\text{vol}}(x,y)\\,\\mathrm{d}\\Omega\n$$\nwhere $A_e$ is the area of the element $\\Omega_e$. The local operator is given as:\n$$\n\\boldsymbol{B}_{\\text{vol}}(x,y) = \\begin{bmatrix} N_{1,x} & N_{1,y} & N_{2,x} & N_{2,y} & N_{3,x} & N_{3,y} & N_{4,x} & N_{4,y} \\end{bmatrix}\n$$\nThe derivation proceeds by first expressing the derivatives of the shape functions with respect to physical coordinates $(x,y)$ in terms of derivatives with respect to parent coordinates $(\\xi,\\eta)$, and then performing the integration over the element domain.\n\nFirst, we define the standard bilinear shape functions $N_i(\\xi, \\eta)$ on the parent domain $[-1,1] \\times [-1,1]$. The node numbering $1,2,3,4$ corresponds to the vertices $(0,0), (1,0), (1,1), (0,1)$ in physical space, which in turn correspond to vertices $(-1,-1), (1,-1), (1,1), (-1,1)$ in parent space. The shape functions are:\n$$\n\\begin{aligned}\nN_1(\\xi, \\eta) &= \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) &= \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) &= \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) &= \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\nNext, we compute the derivatives of these shape functions with respect to the parent coordinates $\\xi$ and $\\eta$.\n$$\n\\begin{array}{ll}\nN_{1,\\xi} = -\\frac{1}{4}(1-\\eta), & N_{1,\\eta} = -\\frac{1}{4}(1-\\xi) \\\\\nN_{2,\\xi} = \\frac{1}{4}(1-\\eta), & N_{2,\\eta} = -\\frac{1}{4}(1+\\xi) \\\\\nN_{3,\\xi} = \\frac{1}{4}(1+\\eta), & N_{3,\\eta} = \\frac{1}{4}(1+\\xi) \\\\\nN_{4,\\xi} = -\\frac{1}{4}(1+\\eta), & N_{4,\\eta} = \\frac{1}{4}(1-\\xi)\n\\end{array}\n$$\nTo transform these derivatives into physical coordinates, we require the Jacobian matrix $\\boldsymbol{J}$ of the given mapping: $x=\\frac{1}{2}(1+\\xi)$ and $y=\\frac{1}{2}(1+\\eta)$.\n$$\n\\boldsymbol{J} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{2} \\end{bmatrix}\n$$\nThe determinant of the Jacobian is $\\det(\\boldsymbol{J}) = (\\frac{1}{2})(\\frac{1}{2}) - (0)(0) = \\frac{1}{4}$. The inverse of the Jacobian is:\n$$\n\\boldsymbol{J}^{-1} = \\frac{1}{\\det(\\boldsymbol{J})} \\begin{bmatrix} \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{2} \\end{bmatrix} = 4 \\begin{bmatrix} \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{2} \\end{bmatrix} = \\begin{bmatrix} 2 & 0 \\\\ 0 & 2 \\end{bmatrix}\n$$\nSince the mapping is affine, both $\\boldsymbol{J}$ and $\\boldsymbol{J}^{-1}$ are constant matrices. The chain rule for derivatives states:\n$$\n\\begin{Bmatrix} N_{i,x} \\\\ N_{i,y} \\end{Bmatrix} = \\boldsymbol{J}^{-1} \\begin{Bmatrix} N_{i,\\xi} \\\\ N_{i,\\eta} \\end{Bmatrix} = \\begin{bmatrix} 2 & 0 \\\\ 0 & 2 \\end{bmatrix} \\begin{Bmatrix} N_{i,\\xi} \\\\ N_{i,\\eta} \\end{Bmatrix} = \\begin{Bmatrix} 2 N_{i,\\xi} \\\\ 2 N_{i,\\eta} \\end{Bmatrix}\n$$\nThus, we find the components of $\\boldsymbol{B}_{\\text{vol}}$ as functions of $(\\xi,\\eta)$:\n$$\n\\begin{array}{ll}\nN_{1,x} = 2 N_{1,\\xi} = -\\frac{1}{2}(1-\\eta), & N_{1,y} = 2 N_{1,\\eta} = -\\frac{1}{2}(1-\\xi) \\\\\nN_{2,x} = 2 N_{2,\\xi} = \\frac{1}{2}(1-\\eta), & N_{2,y} = 2 N_{2,\\eta} = -\\frac{1}{2}(1+\\xi) \\\\\nN_{3,x} = 2 N_{3,\\xi} = \\frac{1}{2}(1+\\eta), & N_{3,y} = 2 N_{3,\\eta} = \\frac{1}{2}(1+\\xi) \\\\\nN_{4,x} = 2 N_{4,\\xi} = -\\frac{1}{2}(1+\\eta), & N_{4,y} = 2 N_{4,\\eta} = \\frac{1}{2}(1-\\xi) \\\\\n\\end{array}\n$$\nThe physical element is a unit square, so its area is $A_e = 1$. The integral for $\\bar{\\boldsymbol{B}}_{\\text{vol}}$ is transformed to the parent domain:\n$$\n\\bar{\\boldsymbol{B}}_{\\text{vol}} = \\frac{1}{A_e} \\int_{\\Omega_e} \\boldsymbol{B}_{\\text{vol}} \\, \\mathrm{d}\\Omega = \\frac{1}{1} \\int_{-1}^1 \\int_{-1}^1 \\boldsymbol{B}_{\\text{vol}}(\\xi,\\eta) \\det(\\boldsymbol{J}) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta = \\frac{1}{4} \\int_{-1}^1 \\int_{-1}^1 \\boldsymbol{B}_{\\text{vol}}(\\xi,\\eta) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta\n$$\nWe evaluate this integral for each component of the operator. For any linear function $f(\\xi,\\eta) = c_0 + c_1\\xi + c_2\\eta$, its integral over the parent domain is:\n$$\n\\int_{-1}^1 \\int_{-1}^1 (c_0 + c_1\\xi + c_2\\eta) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta = 4c_0\n$$\nsince the integrals of the terms linear in $\\xi$ or $\\eta$ are zero. Thus, for each component which is a linear function of $\\xi$ and $\\eta$, we only need its constant term.\n\n- For $N_{1,x} = -\\frac{1}{2}(1-\\eta) = -\\frac{1}{2}+\\frac{1}{2}\\eta$, the constant term is $-\\frac{1}{2}$. The integral is $4(-\\frac{1}{2}) = -2$.\n- For $N_{1,y} = -\\frac{1}{2}(1-\\xi) = -\\frac{1}{2}+\\frac{1}{2}\\xi$, the integral is $4(-\\frac{1}{2}) = -2$.\n- For $N_{2,x} = \\frac{1}{2}(1-\\eta) = \\frac{1}{2}-\\frac{1}{2}\\eta$, the integral is $4(\\frac{1}{2}) = 2$.\n- For $N_{2,y} = -\\frac{1}{2}(1+\\xi) = -\\frac{1}{2}-\\frac{1}{2}\\xi$, the integral is $4(-\\frac{1}{2}) = -2$.\n- For $N_{3,x} = \\frac{1}{2}(1+\\eta) = \\frac{1}{2}+\\frac{1}{2}\\eta$, the integral is $4(\\frac{1}{2}) = 2$.\n- For $N_{3,y} = \\frac{1}{2}(1+\\xi) = \\frac{1}{2}+\\frac{1}{2}\\xi$, the integral is $4(\\frac{1}{2}) = 2$.\n- For $N_{4,x} = -\\frac{1}{2}(1+\\eta) = -\\frac{1}{2}-\\frac{1}{2}\\eta$, the integral is $4(-\\frac{1}{2}) = -2$.\n- For $N_{4,y} = \\frac{1}{2}(1-\\xi) = \\frac{1}{2}-\\frac{1}{2}\\xi$, the integral is $4(\\frac{1}{2}) = 2$.\n\nThe vector of integrated components is $\\begin{bmatrix} -2 & -2 & 2 & -2 & 2 & 2 & -2 & 2 \\end{bmatrix}$. Now we apply the pre-factor $\\frac{1}{4}$:\n$$\n\\bar{\\boldsymbol{B}}_{\\text{vol}} = \\frac{1}{4} \\begin{bmatrix} -2 & -2 & 2 & -2 & 2 & 2 & -2 & 2 \\end{bmatrix}\n$$\nThis yields the final expression for the constant averaged operator row:\n$$\n\\bar{\\boldsymbol{B}}_{\\text{vol}} = \\begin{bmatrix} -\\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{2} \\end{bmatrix}\n$$\nThe result is constant because $\\bar{\\boldsymbol{B}}_{\\text{vol}}$ is defined as the average value of the spatially varying function $\\boldsymbol{B}_{\\text{vol}}(x,y)$ over the element domain $\\Omega_e$. A definite integral over a fixed domain results in a single value, not a function of the integration variables. The derivation above explicitly calculates this constant vector by performing the definite integration, thereby demonstrating why the result is independent of position within the element.", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{2} \\end{pmatrix}}\n$$", "id": "2542562"}, {"introduction": "This final practice provides a concrete demonstration of the B-bar method's effectiveness by analyzing its impact on a notorious spurious deformation known as the 'hourglass mode'. You will quantify the non-physical volumetric strain energy that the standard Q4 element formulation assigns to this mode and show how the B-bar method correctly eliminates this spurious stiffness. This exercise offers a quantitative illustration of how volumetric locking manifests at the element level and how the B-bar technique provides an effective remedy. [@problem_id:2542578]", "problem": "Consider a two-dimensional (2D) isoparametric four-node bilinear quadrilateral (Q4) finite element in plane strain with side length $L$ and constant thickness $t$. The material is isotropic with bulk modulus $\\kappa$, and the volumetric-deviatoric split of the strain energy is assumed. The volumetric strain is $\\operatorname{tr}(\\boldsymbol{\\varepsilon})=\\partial u/\\partial x+\\partial v/\\partial y$, and the volumetric energy density is $w_{\\text{vol}}=(\\kappa/2)(\\operatorname{tr}(\\boldsymbol{\\varepsilon}))^{2}$. Let the elementâ€™s nodal degrees of freedom be ordered as $\\boldsymbol{d}=\\{u_{1},v_{1},u_{2},v_{2},u_{3},v_{3},u_{4},v_{4}\\}^{\\mathsf{T}}$ with the standard counterclockwise node ordering and the isoparametric mapping $x=(L/2)\\,\\xi$, $y=(L/2)\\,\\eta$, where $(\\xi,\\eta)\\in[-1,1]^{2}$.\n\nStarting from the volumetric energy functional and the definition of the volumetric strain, perform the following steps:\n- Derive the original volumetric stiffness contribution $K_{\\text{vol}}$ of the element, expressed in terms of the volumetric strain-displacement operator $B_{\\text{vol}}$.\n- Using the idea of an elementwise $L^{2}$-projection of $\\operatorname{tr}(\\boldsymbol{\\varepsilon})$ onto the space of constants (the essence of the B-bar method for volumetric locking mitigation), derive the B-bar volumetric contribution $\\bar{K}_{\\text{vol}}$ and the corresponding projected operator $\\bar{B}_{\\text{vol}}$.\n- For the specific nodal displacement pattern defined by $u$-components $[u_{1},u_{2},u_{3},u_{4}]=[\\gamma,-\\gamma,\\gamma,-\\gamma]$ and $v$-components $[v_{1},v_{2},v_{3},v_{4}]=[0,0,0,0]$, show that the interpolated displacement field is $u(\\xi,\\eta)=\\gamma\\,\\xi\\,\\eta$ and $v(\\xi,\\eta)=0$. Then evaluate the scalar quantities $\\boldsymbol{d}^{\\mathsf{T}}K_{\\text{vol}}\\boldsymbol{d}$ and $\\boldsymbol{d}^{\\mathsf{T}}\\bar{K}_{\\text{vol}}\\boldsymbol{d}$ in terms of $\\kappa$, $t$, $L$, and $\\gamma$.\n\nDefine the normalized difference\n$$\\Delta R=\\frac{\\boldsymbol{d}^{\\mathsf{T}}K_{\\text{vol}}\\boldsymbol{d}-\\boldsymbol{d}^{\\mathsf{T}}\\bar{K}_{\\text{vol}}\\boldsymbol{d}}{\\kappa\\,t\\,\\gamma^{2}}.$$\nCompute $\\Delta R$ in closed form. Give your final answer as a single simplified analytic value. Do not include units in your final answer. No rounding is required.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It presents a standard exercise in the field of computational solid mechanics, specifically the finite element method. No inconsistencies or fallacies are detected. The problem is valid, and I will proceed with its solution.\n\nThe analysis concerns a $2$D, four-node isoparametric quadrilateral element under plane strain conditions. The element geometry is a square of side length $L$, mapped from a canonical parent element in the $(\\xi, \\eta)$ coordinate system where $\\xi, \\eta \\in [-1, 1]$. The mapping is given by $x=(L/2)\\xi$ and $y=(L/2)\\eta$.\n\nThe Jacobian matrix of this transformation is\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} L/2 & 0 \\\\ 0 & L/2 \\end{pmatrix} $$\nThe determinant of the Jacobian is $\\det(\\mathbf{J}) = L^2/4$. The differential area element is $dA = \\det(\\mathbf{J}) d\\xi d\\eta = (L^2/4) d\\xi d\\eta$.\n\nThe displacement field $(u, v)$ is interpolated from nodal displacements using the bilinear shape functions $N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i\\xi)(1+\\eta_i\\eta)$, where $(\\xi_i, \\eta_i)$ are the coordinates of node $i$. Let the vector of nodal degrees of freedom be $\\boldsymbol{d}=\\{u_{1},v_{1},u_{2},v_{2},u_{3},v_{3},u_{4},v_{4}\\}^{\\mathsf{T}}$.\n\nThe volumetric strain is $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}$. The relationship between physical and parent element derivatives is $\\left\\{\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y}\\right\\}^{\\mathsf{T}} = \\mathbf{J}^{-1} \\left\\{\\frac{\\partial}{\\partial \\xi}, \\frac{\\partial}{\\partial \\eta}\\right\\}^{\\mathsf{T}} = \\frac{2}{L}\\mathbf{I} \\left\\{\\frac{\\partial}{\\partial \\xi}, \\frac{\\partial}{\\partial \\eta}\\right\\}^{\\mathsf{T}}$.\nThe volumetric strain can be expressed as $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = B_{\\text{vol}} \\boldsymbol{d}$, where $B_{\\text{vol}}$ is a $1 \\times 8$ row vector given by:\n$$ B_{\\text{vol}} = \\left[ \\frac{\\partial N_1}{\\partial x}, \\frac{\\partial N_1}{\\partial y}, \\dots, \\frac{\\partial N_4}{\\partial x}, \\frac{\\partial N_4}{\\partial y} \\right] $$\nwhere $\\frac{\\partial N_i}{\\partial x} = \\frac{2}{L}\\frac{\\partial N_i}{\\partial \\xi}$ and $\\frac{\\partial N_i}{\\partial y} = \\frac{2}{L}\\frac{\\partial N_i}{\\partial \\eta}$.\n\nThe volumetric strain energy functional is $W_{\\text{vol}} = \\frac{1}{2}\\int_{V} \\kappa (\\operatorname{tr}(\\boldsymbol{\\varepsilon}))^2 dV$. For an element of constant thickness $t$, this becomes $W_{\\text{vol}} = \\frac{1}{2} \\boldsymbol{d}^{\\mathsf{T}} K_{\\text{vol}} \\boldsymbol{d}$, where the volumetric stiffness matrix $K_{\\text{vol}}$ is:\n$$ K_{\\text{vol}} = \\int_A t B_{\\text{vol}}^{\\mathsf{T}} \\kappa B_{\\text{vol}} dA = \\kappa t \\int_{-1}^1 \\int_{-1}^1 B_{\\text{vol}}^{\\mathsf{T}}(\\xi,\\eta) B_{\\text{vol}}(\\xi,\\eta) \\det(\\mathbf{J}) d\\xi d\\eta $$\n\nThe B-bar method aims to mitigate volumetric locking by replacing the local volumetric strain $\\operatorname{tr}(\\boldsymbol{\\varepsilon})$ with its average over the element volume, $\\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})}$. This is equivalent to an $L^2$-projection of the strain onto the space of constant functions over the element.\n$$ \\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})} = \\frac{1}{V_{el}} \\int_{V_{el}} \\operatorname{tr}(\\boldsymbol{\\varepsilon}) dV = \\frac{1}{A_{el}} \\int_{A_{el}} \\operatorname{tr}(\\boldsymbol{\\varepsilon}) dA $$\nwhere $A_{el} = L^2$.\nSubstituting $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = B_{\\text{vol}} \\boldsymbol{d}$, we get $\\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})} = \\bar{B}_{\\text{vol}} \\boldsymbol{d}$, where the modified strain-displacement operator $\\bar{B}_{\\text{vol}}$ is constant over the element:\n$$ \\bar{B}_{\\text{vol}} = \\frac{1}{A_{el}} \\int_{A_{el}} B_{\\text{vol}} dA = \\frac{1}{L^2} \\int_{-1}^1 \\int_{-1}^1 B_{\\text{vol}}(\\xi, \\eta) \\frac{L^2}{4} d\\xi d\\eta = \\frac{1}{4} \\int_{-1}^1 \\int_{-1}^1 B_{\\text{vol}}(\\xi, \\eta) d\\xi d\\eta $$\nThe modified volumetric stiffness matrix, $\\bar{K}_{\\text{vol}}$, is derived using this constant operator:\n$$ \\bar{K}_{\\text{vol}} = \\int_A t \\bar{B}_{\\text{vol}}^{\\mathsf{T}} \\kappa \\bar{B}_{\\text{vol}} dA = \\kappa t \\bar{B}_{\\text{vol}}^{\\mathsf{T}} \\bar{B}_{\\text{vol}} \\int_A dA = \\kappa t A_{el} \\bar{B}_{\\text{vol}}^{\\mathsf{T}} \\bar{B}_{\\text{vol}} $$\nThe corresponding strain energy is $\\frac{1}{2} \\boldsymbol{d}^{\\mathsf{T}} \\bar{K}_{\\text{vol}} \\boldsymbol{d} = \\frac{1}{2} \\kappa t A_{el} (\\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})})^2$.\n\nWe now analyze the specific nodal displacement vector $\\boldsymbol{d}$ with components $u_1=\\gamma, u_2=-\\gamma, u_3=\\gamma, u_4=-\\gamma$ and $v_1=v_2=v_3=v_4=0$.\nThe interpolated displacement field is $u(\\xi, \\eta) = \\sum_{i=1}^4 N_i u_i$ and $v(\\xi, \\eta) = \\sum_{i=1}^4 N_i v_i$.\n$$ v(\\xi, \\eta) = N_1(0) + N_2(0) + N_3(0) + N_4(0) = 0 $$\n$$ u(\\xi, \\eta) = \\gamma(N_1 - N_2 + N_3 - N_4) $$\nUsing the definitions $N_i = \\frac{1}{4}(1+\\xi_i\\xi)(1+\\eta_i\\eta)$ with $(\\xi_1, \\eta_1)=(-1,-1)$, $(\\xi_2, \\eta_2)=(1,-1)$, $(\\xi_3, \\eta_3)=(1,1)$, $(\\xi_4, \\eta_4)=(-1,1)$:\n$$ N_1 - N_2 = \\frac{1}{4}(1-\\eta)(1-\\xi - (1+\\xi)) = -\\frac{1}{2}\\xi(1-\\eta) $$\n$$ N_3 - N_4 = \\frac{1}{4}(1+\\eta)(1+\\xi - (1-\\xi)) = \\frac{1}{2}\\xi(1+\\eta) $$\n$$ u(\\xi, \\eta) = \\gamma \\left( -\\frac{1}{2}\\xi(1-\\eta) + \\frac{1}{2}\\xi(1+\\eta) \\right) = \\gamma \\left( -\\frac{1}{2}\\xi + \\frac{1}{2}\\xi\\eta + \\frac{1}{2}\\xi + \\frac{1}{2}\\xi\\eta \\right) = \\gamma \\xi \\eta $$\nThe displacement field is indeed $u(\\xi, \\eta) = \\gamma\\xi\\eta$ and $v(\\xi, \\eta)=0$. This is the well-known hourglass mode.\n\nNext, we evaluate the resulting volumetric strain:\n$$ \\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = \\frac{2}{L}\\frac{\\partial u}{\\partial \\xi} + \\frac{2}{L}\\frac{\\partial v}{\\partial \\eta} = \\frac{2}{L}\\frac{\\partial}{\\partial \\xi}(\\gamma\\xi\\eta) + \\frac{2}{L}\\frac{\\partial}{\\partial \\eta}(0) = \\frac{2\\gamma\\eta}{L} $$\nThe strain energy for the standard formulation is $\\frac{1}{2} \\boldsymbol{d}^{\\mathsf{T}} K_{\\text{vol}} \\boldsymbol{d}$. Thus, the quadratic form $\\boldsymbol{d}^{\\mathsf{T}} K_{\\text{vol}} \\boldsymbol{d}$ is:\n$$ \\boldsymbol{d}^{\\mathsf{T}} K_{\\text{vol}} \\boldsymbol{d} = \\kappa t \\int_A (\\operatorname{tr}(\\boldsymbol{\\varepsilon}))^2 dA = \\kappa t \\int_{-1}^1 \\int_{-1}^1 \\left(\\frac{2\\gamma\\eta}{L}\\right)^2 \\frac{L^2}{4} d\\xi d\\eta $$\n$$ \\boldsymbol{d}^{\\mathsf{T}} K_{\\text{vol}} \\boldsymbol{d} = \\kappa t \\frac{4\\gamma^2}{L^2} \\frac{L^2}{4} \\int_{-1}^1 \\int_{-1}^1 \\eta^2 d\\xi d\\eta = \\kappa t \\gamma^2 \\left( \\int_{-1}^1 d\\xi \\right) \\left( \\int_{-1}^1 \\eta^2 d\\eta \\right) $$\nThe integrals evaluate to $\\int_{-1}^1 d\\xi = 2$ and $\\int_{-1}^1 \\eta^2 d\\eta = [\\eta^3/3]_{-1}^1 = 2/3$.\n$$ \\boldsymbol{d}^{\\mathsf{T}} K_{\\text{vol}} \\boldsymbol{d} = \\kappa t \\gamma^2 (2) \\left(\\frac{2}{3}\\right) = \\frac{4}{3} \\kappa t \\gamma^2 $$\nThis non-zero energy is spurious, as the hourglass mode should ideally be a pure shear deformation with zero volumetric change.\n\nFor the B-bar formulation, we first compute the averaged volumetric strain:\n$$ \\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})} = \\frac{1}{A_{el}} \\int_A \\operatorname{tr}(\\boldsymbol{\\varepsilon}) dA = \\frac{1}{L^2} \\int_{-1}^1 \\int_{-1}^1 \\left(\\frac{2\\gamma\\eta}{L}\\right) \\frac{L^2}{4} d\\xi d\\eta $$\n$$ \\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})} = \\frac{\\gamma}{2L} \\int_{-1}^1 \\int_{-1}^1 \\eta d\\xi d\\eta = \\frac{\\gamma}{2L} \\left( \\int_{-1}^1 d\\xi \\right) \\left( \\int_{-1}^1 \\eta d\\eta \\right) $$\nThe integral $\\int_{-1}^1 \\eta d\\eta = [\\eta^2/2]_{-1}^1 = 0$. Therefore, $\\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})} = 0$.\nThe strain energy for the B-bar formulation is:\n$$ \\boldsymbol{d}^{\\mathsf{T}} \\bar{K}_{\\text{vol}} \\boldsymbol{d} = \\kappa t A_{el} (\\overline{\\operatorname{tr}(\\boldsymbol{\\varepsilon})})^2 = \\kappa t L^2 (0)^2 = 0 $$\nThe B-bar method correctly assigns zero volumetric energy to this mode.\n\nFinally, we compute the normalized difference $\\Delta R$:\n$$ \\Delta R = \\frac{\\boldsymbol{d}^{\\mathsf{T}} K_{\\text{vol}} \\boldsymbol{d} - \\boldsymbol{d}^{\\mathsf{T}} \\bar{K}_{\\text{vol}} \\boldsymbol{d}}{\\kappa t \\gamma^2} = \\frac{\\frac{4}{3} \\kappa t \\gamma^2 - 0}{\\kappa t \\gamma^2} $$\n$$ \\Delta R = \\frac{4}{3} $$\nThe result is a dimensionless constant.", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "2542578"}]}