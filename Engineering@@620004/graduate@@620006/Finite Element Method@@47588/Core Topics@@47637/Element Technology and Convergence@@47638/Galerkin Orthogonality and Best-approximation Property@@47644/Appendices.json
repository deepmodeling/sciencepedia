{"hands_on_practices": [{"introduction": "The first step toward mastering an abstract theoretical concept is often to see it in action through a concrete example. This practice provides a direct, hands-on verification of the foundational Galerkin orthogonality property. By assembling the system matrices for a simple one-dimensional problem, solving for the finite element solution $u_h$, and then explicitly computing the weak residual, you will confirm that the error in the approximation is indeed \"orthogonal\" to the test space, as predicted by the theory [@problem_id:2561440].", "problem": "Consider the boundary value problem defined on the interval $[0,1]$: find $u$ satisfying $-u'' = f$ with $u(0)=0$ and $u(1)=0$, where $f(x) = 1$. The variational formulation seeks $u \\in H_0^1(0,1)$ such that\n$$\na(u,v) = \\ell(v) \\quad \\text{for all } v \\in H_0^1(0,1),\n$$\nwhere the bilinear form and linear functional are\n$$\na(u,v) := \\int_0^1 u'(x) v'(x)\\,dx, \n\\qquad \n\\ell(v) := \\int_0^1 f(x)\\,v(x)\\,dx.\n$$\nLet $V_h \\subset H_0^1(0,1)$ be the continuous piecewise linear finite element space on the uniform mesh with nodes at $x_0=0$, $x_1=\\frac{1}{3}$, $x_2=\\frac{2}{3}$, $x_3=1$. Denote by $\\{\\phi_1, \\phi_2\\}$ the nodal basis of $V_h$ associated with the interior nodes $x_1=\\frac{1}{3}$ and $x_2=\\frac{2}{3}$, respectively. The Galerkin approximation $u_h \\in V_h$ satisfies\n$$\na(u_h, v_h) = \\ell(v_h) \\quad \\text{for all } v_h \\in V_h.\n$$\nTasks:\n- Assemble the stiffness matrix $K \\in \\mathbb{R}^{2 \\times 2}$ and load vector $F \\in \\mathbb{R}^{2}$ with entries $K_{ij} := a(\\phi_j,\\phi_i)$ and $F_i := \\ell(\\phi_i)$, using only the above definitions and the specifics of the mesh and basis.\n- Solve the assembled linear system to obtain the coefficient vector $U_h = (u_1, u_2)^{\\top}$ of $u_h = u_1 \\phi_1 + u_2 \\phi_2$.\n- Define the weak residual functional $R: V_h \\to \\mathbb{R}$ by $R(v_h) := a(u_h, v_h) - \\ell(v_h)$. Compute $R(\\phi_1)$ and $R(\\phi_2)$ explicitly by evaluating the integrals that define $a(\\cdot,\\cdot)$ and $\\ell(\\cdot)$. Use these values to verify the Galerkin orthogonality $R(v_h)=0$ for all $v_h \\in V_h$.\n- Let \n$$\nE := |R(\\phi_1)|^2 + |R(\\phi_2)|^2.\n$$\nProvide the value of $E$ as your final answer. No rounding is required and no units should be included.", "solution": "The nodal basis functions $\\{\\phi_1, \\phi_2\\}$ for the space $V_h$ are piecewise linear \"hat\" functions. Given the mesh nodes $x_0=0$, $x_1=\\frac{1}{3}$, $x_2=\\frac{2}{3}$, $x_3=1$, the explicit expressions for $\\phi_1(x)$ and $\\phi_2(x)$ are:\n$$\n\\phi_1(x) = \\begin{cases} 3x,  x \\in [0, \\frac{1}{3}] \\\\ 2 - 3x,  x \\in [\\frac{1}{3}, \\frac{2}{3}] \\\\ 0,  \\text{otherwise} \\end{cases}\n\\quad \\text{and} \\quad\n\\phi_2(x) = \\begin{cases} 3x - 1,  x \\in [\\frac{1}{3}, \\frac{2}{3}] \\\\ 3 - 3x,  x \\in [\\frac{2}{3}, 1] \\\\ 0,  \\text{otherwise} \\end{cases}\n$$\nTheir derivatives are piecewise constant:\n$$\n\\phi_1'(x) = \\begin{cases} 3,  x \\in (0, \\frac{1}{3}) \\\\ -3,  x \\in (\\frac{1}{3}, \\frac{2}{3}) \\\\ 0,  \\text{otherwise} \\end{cases}\n\\quad \\text{and} \\quad\n\\phi_2'(x) = \\begin{cases} 3,  x \\in (\\frac{1}{3}, \\frac{2}{3}) \\\\ -3,  x \\in (\\frac{2}{3}, 1) \\\\ 0,  \\text{otherwise} \\end{cases}\n$$\nThe first task is to assemble the stiffness matrix $K$ and load vector $F$. The entries of the stiffness matrix $K_{ij} = a(\\phi_j, \\phi_i) = \\int_0^1 \\phi_j'(x) \\phi_i'(x) dx$ are computed as follows:\n$$\nK_{11} = a(\\phi_1, \\phi_1) = \\int_0^1 (\\phi_1'(x))^2 dx = \\int_0^{1/3} (3)^2 dx + \\int_{1/3}^{2/3} (-3)^2 dx = 9(\\frac{1}{3}) + 9(\\frac{1}{3}) = 6\n$$\n$$\nK_{22} = a(\\phi_2, \\phi_2) = \\int_0^1 (\\phi_2'(x))^2 dx = \\int_{1/3}^{2/3} (3)^2 dx + \\int_{2/3}^{1} (-3)^2 dx = 9(\\frac{1}{3}) + 9(\\frac{1}{3}) = 6\n$$\n$$\nK_{12} = a(\\phi_2, \\phi_1) = \\int_0^1 \\phi_2'(x) \\phi_1'(x) dx = \\int_{1/3}^{2/3} (3)(-3) dx = -9(\\frac{1}{3}) = -3\n$$\nSince the bilinear form $a(\\cdot, \\cdot)$ is symmetric, $K_{21} = a(\\phi_1, \\phi_2) = K_{12} = -3$. Thus, the stiffness matrix is:\n$$\nK = \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix}\n$$\nThe entries of the load vector $F_i = \\ell(\\phi_i) = \\int_0^1 f(x) \\phi_i(x) dx$ with $f(x)=1$ are computed:\n$$\nF_1 = \\ell(\\phi_1) = \\int_0^1 \\phi_1(x) dx = \\int_0^{1/3} 3x \\,dx + \\int_{1/3}^{2/3} (2-3x) \\,dx = \\left[\\frac{3x^2}{2}\\right]_0^{1/3} + \\left[2x - \\frac{3x^2}{2}\\right]_{1/3}^{2/3} = \\frac{1}{6} + \\left( (\\frac{4}{3} - \\frac{2}{3}) - (\\frac{2}{3} - \\frac{1}{6}) \\right) = \\frac{1}{6} + (\\frac{2}{3} - \\frac{3}{6}) = \\frac{1}{6} + \\frac{1}{6} = \\frac{1}{3}\n$$\n$$\nF_2 = \\ell(\\phi_2) = \\int_0^1 \\phi_2(x) dx = \\int_{1/3}^{2/3} (3x-1) \\,dx + \\int_{2/3}^{1} (3-3x) \\,dx = \\left[\\frac{3x^2}{2} - x\\right]_{1/3}^{2/3} + \\left[3x - \\frac{3x^2}{2}\\right]_{2/3}^{1} = \\left( (\\frac{2}{3} - \\frac{2}{3}) - (\\frac{1}{6} - \\frac{1}{3}) \\right) + \\left( (3 - \\frac{3}{2}) - (2 - \\frac{2}{3}) \\right) = \\frac{1}{6} + (\\frac{3}{2} - \\frac{4}{3}) = \\frac{1}{6} + \\frac{1}{6} = \\frac{1}{3}\n$$\nThus, the load vector is:\n$$\nF = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{1}{3} \\end{pmatrix}\n$$\nThe next task is to solve the linear system $K U_h = F$ for the coefficient vector $U_h = (u_1, u_2)^\\top$:\n$$\n\\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{1}{3} \\end{pmatrix}\n$$\nThe inverse of $K$ is $K^{-1} = \\frac{1}{\\det(K)} \\begin{pmatrix} 6  3 \\\\ 3  6 \\end{pmatrix}$, where $\\det(K) = (6)(6) - (-3)(-3) = 36-9=27$.\n$$\nK^{-1} = \\frac{1}{27} \\begin{pmatrix} 6  3 \\\\ 3  6 \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\nSolving for $U_h$:\n$$\nU_h = K^{-1}F = \\frac{1}{9} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{1}{3} \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} \\frac{2}{3} + \\frac{1}{3} \\\\ \\frac{1}{3} + \\frac{2}{3} \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{9} \\\\ \\frac{1}{9} \\end{pmatrix}\n$$\nSo, $u_1 = \\frac{1}{9}$ and $u_2 = \\frac{1}{9}$, and the Galerkin solution is $u_h(x) = \\frac{1}{9}\\phi_1(x) + \\frac{1}{9}\\phi_2(x)$.\n\nThe third task is to compute the weak residual $R(v_h) = a(u_h, v_h) - \\ell(v_h)$ for the basis functions $v_h=\\phi_1$ and $v_h=\\phi_2$.\nFor $v_h=\\phi_1$:\n$$\nR(\\phi_1) = a(u_h, \\phi_1) - \\ell(\\phi_1) = a\\left(\\frac{1}{9}\\phi_1 + \\frac{1}{9}\\phi_2, \\phi_1\\right) - \\ell(\\phi_1)\n$$\nBy linearity of $a(\\cdot,\\cdot)$:\n$$\na(u_h, \\phi_1) = \\frac{1}{9} a(\\phi_1, \\phi_1) + \\frac{1}{9} a(\\phi_2, \\phi_1) = \\frac{1}{9} K_{11} + \\frac{1}{9} K_{12} = \\frac{1}{9}(6) + \\frac{1}{9}(-3) = \\frac{3}{9} = \\frac{1}{3}\n$$\nWe previously computed $\\ell(\\phi_1) = F_1 = \\frac{1}{3}$. Therefore,\n$$\nR(\\phi_1) = \\frac{1}{3} - \\frac{1}{3} = 0\n$$\nFor $v_h=\\phi_2$:\n$$\nR(\\phi_2) = a(u_h, \\phi_2) - \\ell(\\phi_2) = a\\left(\\frac{1}{9}\\phi_1 + \\frac{1}{9}\\phi_2, \\phi_2\\right) - \\ell(\\phi_2)\n$$\nBy linearity:\n$$\na(u_h, \\phi_2) = \\frac{1}{9} a(\\phi_1, \\phi_2) + \\frac{1}{9} a(\\phi_2, \\phi_2) = \\frac{1}{9} K_{21} + \\frac{1}{9} K_{22} = \\frac{1}{9}(-3) + \\frac{1}{9}(6) = \\frac{3}{9} = \\frac{1}{3}\n$$\nWe previously computed $\\ell(\\phi_2) = F_2 = \\frac{1}{3}$. Therefore,\n$$\nR(\\phi_2) = \\frac{1}{3} - \\frac{1}{3} = 0\n$$\nThe Galerkin orthogonality property states $a(u_h, v_h) - \\ell(v_h) = 0$ for all $v_h \\in V_h$. Any $v_h \\in V_h$ can be written as $v_h = c_1 \\phi_1 + c_2 \\phi_2$. The residual functional $R$ is linear, so $R(v_h) = R(c_1 \\phi_1 + c_2 \\phi_2) = c_1 R(\\phi_1) + c_2 R(\\phi_2)$. Since we have explicitly computed $R(\\phi_1)=0$ and $R(\\phi_2)=0$, it follows that $R(v_h)=0$ for all $v_h \\in V_h$, thus verifying the property.\n\nFinally, we calculate $E := |R(\\phi_1)|^2 + |R(\\phi_2)|^2$. Using the computed values:\n$$\nE = |0|^2 + |0|^2 = 0\n$$", "answer": "$$\n\\boxed{0}\n$$", "id": "2561440"}, {"introduction": "Galerkin orthogonality is not just an elegant mathematical property; it is the key that unlocks the quasi-optimality of the finite element solution. This exercise guides you through the canonical derivation of this \"best-approximation\" property, famously known as Céa's Lemma, which directly follows from the orthogonality condition established in the previous practice [@problem_id:2561440]. You will then move from abstract inequalities to tangible analysis by computing the exact continuity ($M$) and coercivity ($\\alpha$) constants for a given problem, revealing how physical properties dictate the quality of the finite element approximation [@problem_id:2561496].", "problem": "Consider the one-dimensional Poisson boundary value problem with a variable diffusion coefficient on the unit interval. Let $V := H_{0}^{1}(0,1)$ and define the bilinear form $a(\\cdot,\\cdot)$ and linear functional $\\ell(\\cdot)$ by\n$$\na(u,v) := \\int_{0}^{1} p(x)\\, u'(x)\\, v'(x)\\, dx, \\qquad \\ell(v) := \\int_{0}^{1} f(x)\\, v(x)\\, dx,\n$$\nwhere $p \\in L^{\\infty}(0,1)$ satisfies $p(x) \\geq p_{\\min}  0$ almost everywhere. The weak formulation of the model problem is: find $u \\in V$ such that\n$$\na(u,v) = \\ell(v) \\quad \\text{for all } v \\in V.\n$$\nLet $V_{h} \\subset V$ be the conforming piecewise-linear Lagrange finite element space on a uniform mesh of $[0,1]$ with $N$ subintervals of equal length, and let $u_{h} \\in V_{h}$ solve the discrete problem\n$$\na(u_{h}, v_{h}) = \\ell(v_{h}) \\quad \\text{for all } v_{h} \\in V_{h}.\n$$\nAdopt the energy seminorm $\\|v\\|_{E} := \\left(\\int_{0}^{1} |v'(x)|^{2}\\, dx\\right)^{1/2}$ on $V$. Starting only from the definitions of continuity and coercivity of $a(\\cdot,\\cdot)$ with respect to $\\|\\cdot\\|_{E}$ (namely, there exist constants $\\alpha  0$ and $M \\geq \\alpha$ such that $a(v,v) \\geq \\alpha \\|v\\|_{E}^{2}$ for all $v \\in V$, and $|a(w,z)| \\leq M \\|w\\|_{E}\\|z\\|_{E}$ for all $w,z \\in V$), perform a concrete derivation that:\n- establishes Galerkin orthogonality $a(u-u_{h}, v_{h}) = 0$ for all $v_{h} \\in V_{h}$,\n- and shows the best-approximation bound in the energy seminorm,\n$$\n\\|u - u_{h}\\|_{E} \\leq \\frac{M}{\\alpha} \\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{E}.\n$$\n\nThen specialize to the explicit diffusion coefficient $p(x) := 1 + x$ on $[0,1]$. Using only the definitions above and without appealing to any shortcuts beyond those definitions, compute the exact values of the continuity and coercivity constants with respect to $\\|\\cdot\\|_{E}$, and hence determine the exact value of the ratio $M/\\alpha$ for this $p(x)$. Provide your final answer as a single real number. No units are required. Do not round your answer.", "solution": "First, we derive the general properties of the Galerkin method as requested.\n\nThe weak formulation of the problem is to find $u \\in V$ such that\n$$a(u,v) = \\ell(v) \\quad \\forall v \\in V.$$\nThe finite element approximation is to find $u_{h} \\in V_{h}$ such that\n$$a(u_{h}, v_{h}) = \\ell(v_{h}) \\quad \\forall v_{h} \\in V_{h}.$$\nHere, $V = H_{0}^{1}(0,1)$ and $V_{h}$ is a conforming finite-dimensional subspace, i.e., $V_{h} \\subset V$.\n\n**1. Derivation of Galerkin Orthogonality**\n\nThe property known as Galerkin orthogonality establishes a relationship between the error $u - u_{h}$ and the discrete space $V_{h}$.\nSince $V_{h} \\subset V$, the weak formulation for the exact solution $u$ must also hold for any test function $v_{h} \\in V_{h}$. Thus, we have\n$$a(u, v_{h}) = \\ell(v_{h}) \\quad \\forall v_{h} \\in V_{h}.$$\nWe have the discrete problem satisfied by $u_{h}$:\n$$a(u_{h}, v_{h}) = \\ell(v_{h}) \\quad \\forall v_{h} \\in V_{h}.$$\nSubtracting the second equation from the first yields\n$$a(u, v_{h}) - a(u_{h}, v_{h}) = 0 \\quad \\forall v_{h} \\in V_{h}.$$\nBy the linearity of the bilinear form $a(\\cdot, \\cdot)$ in its first argument, we can combine the terms:\n$$a(u - u_{h}, v_{h}) = 0 \\quad \\forall v_{h} \\in V_{h}.$$\nThis is the Galerkin orthogonality property. It states that the error $u - u_{h}$ is \"orthogonal\" to the entire approximation space $V_{h}$ with respect to the bilinear form $a(\\cdot, \\cdot)$.\n\n**2. Derivation of the Best-Approximation Bound**\n\nThis result, often called Céa's Lemma, provides an upper bound on the error of the finite element solution. The derivation relies on Galerkin orthogonality and the assumed properties of the bilinear form.\n\nLet $e = u - u_{h}$ be the error. By the definition of coercivity of $a(\\cdot, \\cdot)$ with respect to the energy seminorm $\\| \\cdot \\|_{E}$, we have for any $v \\in V$:\n$$a(v,v) \\geq \\alpha \\|v\\|_{E}^{2},$$\nwhere $\\alpha  0$ is the coercivity constant. Applying this to the error $e = u-u_h \\in V$, we get\n$$\\alpha \\|u - u_{h}\\|_{E}^{2} \\leq a(u - u_{h}, u - u_{h}).$$\nNow, for any arbitrary function $v_{h} \\in V_{h}$, we can write $u - u_h = (u - v_h) + (v_h - u_h)$. Using the bilinearity of $a(\\cdot, \\cdot)$, we have\n$$a(u - u_{h}, u - u_{h}) = a(u - u_{h}, (u - v_{h}) + (v_{h} - u_{h})) = a(u - u_{h}, u - v_{h}) + a(u - u_{h}, v_{h} - u_{h}).$$\nThe term $v_{h} - u_{h}$ is a difference of two functions in the subspace $V_{h}$, and since $V_{h}$ is a vector space, $v_{h} - u_{h} \\in V_{h}$. By the Galerkin orthogonality property derived above, the second term vanishes:\n$$a(u - u_{h}, v_{h} - u_{h}) = 0.$$\nThis simplifies the expression to\n$$a(u - u_{h}, u - u_{h}) = a(u - u_{h}, u - v_{h}).$$\nWe now apply the continuity of the bilinear form $a(\\cdot, \\cdot)$, which is defined as\n$$|a(w,z)| \\leq M \\|w\\|_{E}\\|z\\|_{E}$$\nfor some constant $M \\geq \\alpha$. Applying this inequality, we obtain\n$$a(u - u_{h}, u - u_{h}) = a(u - u_{h}, u - v_{h}) \\leq |a(u - u_{h}, u - v_{h})| \\leq M \\|u - u_{h}\\|_{E} \\|u - v_{h}\\|_{E}.$$\nCombining our inequalities, we have:\n$$\\alpha \\|u - u_{h}\\|_{E}^{2} \\leq a(u - u_{h}, u - u_{h}) \\leq M \\|u - u_{h}\\|_{E} \\|u - v_{h}\\|_{E}.$$\nIf $\\|u - u_{h}\\|_{E} = 0$, the desired inequality holds trivially. If $\\|u - u_{h}\\|_{E}  0$, we can divide by $\\alpha \\|u - u_{h}\\|_{E}$ to get\n$$\\|u - u_{h}\\|_{E} \\leq \\frac{M}{\\alpha} \\|u - v_{h}\\|_{E}.$$\nThis inequality holds for any arbitrary $v_{h} \\in V_{h}$. Therefore, we can take the infimum over all possible choices of $v_{h}$ in $V_{h}$ on the right-hand side, which yields the best-approximation bound:\n$$\\|u - u_{h}\\|_{E} \\leq \\frac{M}{\\alpha} \\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{E}.$$\nThis completes the requested derivation.\n\nNext, we compute the explicit values of the constants $\\alpha$ and $M$ for the specific case $p(x) = 1+x$. The constants are defined as the optimal (sharpest) bounds.\n\n**3. Computation of the Coercivity Constant $\\alpha$**\n\nThe coercivity constant $\\alpha$ is the largest real number such that $a(v,v) \\geq \\alpha \\|v\\|_{E}^{2}$ for all $v \\in V = H_0^1(0,1)$. By definition, this means:\n$$\\alpha = \\inf_{v \\in V \\setminus \\{0\\}} \\frac{a(v,v)}{\\|v\\|_{E}^{2}} = \\inf_{v \\in V \\setminus \\{0\\}} \\frac{\\int_{0}^{1} p(x) |v'(x)|^{2} dx}{\\int_{0}^{1} |v'(x)|^{2} dx}.$$\nSubstituting $p(x) = 1+x$:\n$$\\alpha = \\inf_{v \\in V \\setminus \\{0\\}} \\frac{\\int_{0}^{1} (1+x) |v'(x)|^{2} dx}{\\int_{0}^{1} |v'(x)|^{2} dx}.$$\nLet $g(x) = |v'(x)|^2$. Then $g(x)$ is a non-negative function in $L^1(0,1)$ which is not identically zero. The expression is a weighted average of the function $p(x)=1+x$ with the weight function $g(x)$. The infimum of such a weighted average is the essential infimum of the function being averaged.\n$$\\alpha = \\underset{x \\in (0,1)}{\\mathrm{ess\\,inf}} \\, p(x) = \\underset{x \\in (0,1)}{\\mathrm{ess\\,inf}} \\, (1+x).$$\nSince $p(x)=1+x$ is a continuous function on the closed interval $[0,1]$, its essential infimum is simply its minimum value. The function $1+x$ is strictly increasing, so its minimum on $[0,1]$ is attained at $x=0$.\n$$\\alpha = \\min_{x \\in [0,1]} (1+x) = 1+0 = 1.$$\n\n**4. Computation of the Continuity Constant $M$**\n\nThe continuity constant $M$ is the smallest real number such that $|a(w,z)| \\leq M \\|w\\|_{E}\\|z\\|_{E}$ for all $w,z \\in V$. This is equivalent to the operator norm of the bilinear form:\n$$M = \\sup_{w,z \\in V \\setminus \\{0\\}} \\frac{|a(w,z)|}{\\|w\\|_{E}\\|z\\|_{E}} = \\sup_{w,z \\in V \\setminus \\{0\\}} \\frac{|\\int_{0}^{1} p(x) w'(x) z'(x) dx|}{\\left(\\int_{0}^{1} |w'(x)|^{2} dx\\right)^{1/2} \\left(\\int_{0}^{1} |z'(x)|^{2} dx\\right)^{1/2}}.$$\nA standard result in functional analysis states that for a real, symmetric bilinear form, the supremum is achieved when $w=z$. Thus,\n$$M = \\sup_{v \\in V \\setminus \\{0\\}} \\frac{|a(v,v)|}{\\|v\\|_{E}^{2}} = \\sup_{v \\in V \\setminus \\{0\\}} \\frac{\\int_{0}^{1} p(x) |v'(x)|^{2} dx}{\\int_{0}^{1} |v'(x)|^{2} dx}.$$\nSubstituting $p(x)=1+x$:\n$$M = \\sup_{v \\in V \\setminus \\{0\\}} \\frac{\\int_{0}^{1} (1+x) |v'(x)|^{2} dx}{\\int_{0}^{1} |v'(x)|^{2} dx}.$$\nSimilar to the coercivity constant, this expression represents a weighted average of $p(x)=1+x$. The supremum of such an average is the essential supremum of the function $p(x)$.\n$$M = \\underset{x \\in (0,1)}{\\mathrm{ess\\,sup}} \\, p(x) = \\underset{x \\in (0,1)}{\\mathrm{ess\\,sup}} \\, (1+x).$$\nAgain, since $p(x)=1+x$ is continuous, its essential supremum is its maximum value on $[0,1]$. This is attained at $x=1$.\n$$M = \\max_{x \\in [0,1]} (1+x) = 1+1 = 2.$$\n\n**5. Final Ratio**\n\nThe problem asks for the exact value of the ratio $M/\\alpha$. Using the computed constants:\n$$ \\frac{M}{\\alpha} = \\frac{2}{1} = 2. $$\nThis ratio quantifies the conditioning of the problem in the energy seminorm.", "answer": "$$\n\\boxed{2}\n$$", "id": "2561496"}, {"introduction": "The powerful theoretical results of Galerkin orthogonality and best approximation hinge on the crucial assumption of conformity, namely that the discrete space $V_h$ is a subset of the continuous solution space $V$. This advanced practice [@problem_id:2561497] challenges you to explore what happens when this condition is broken. By analyzing a \"nonconforming\" finite element method, you will pinpoint exactly where the standard proof of Galerkin orthogonality fails and derive the consistency error term that appears in its place, giving you a deeper appreciation for the theoretical structure of the finite element method.", "problem": "Let $V := H_{0}^{1}(0,1)$ and consider the boundary value problem for the one-dimensional linear partial differential equation (PDE)\n$$\n-u'' = x \\quad \\text{in } (0,1), \\qquad u(0)=u(1)=0,\n$$\nwith the weak formulation: find $u \\in V$ such that\n$$\na(u,v) = \\ell(v) \\quad \\text{for all } v \\in V,\n$$\nwhere\n$$\na(w,v) := \\int_{0}^{1} w'(x)\\,v'(x)\\,dx, \n\\qquad \n\\ell(v) := \\int_{0}^{1} x\\,v(x)\\,dx.\n$$\nDefine a nonconforming discrete space $V_{h}$ by\n$$\nV_{h} := \\left\\{ v_{h} \\,\\middle|\\, v_{h}|_{(0,\\frac{1}{2})} \\text{ and } v_{h}|_{(\\frac{1}{2},1)} \\text{ are linear, } v_{h}(0)=0,\\ v_{h}(1)=0 \\right\\},\n$$\nwith no continuity enforced at $x=\\tfrac{1}{2}$. Let the basis functions $\\{\\varphi_{L},\\varphi_{R}\\} \\subset V_{h}$ be defined by\n$$\n\\varphi_{L}(x) := \n\\begin{cases}\n2x,  x \\in [0,\\tfrac{1}{2}],\\\\\n0,  x \\in (\\tfrac{1}{2},1],\n\\end{cases}\n\\qquad\n\\varphi_{R}(x) := \n\\begin{cases}\n0,  x \\in [0,\\tfrac{1}{2}),\\\\\n2(1-x),  x \\in [\\tfrac{1}{2},1].\n\\end{cases}\n$$\nConsider the naive nonconforming finite element method defined by: find $u_{h} \\in V_{h}$ such that\n$$\na_{h}(u_{h},v_{h}) = \\ell(v_{h}) \\quad \\text{for all } v_{h} \\in V_{h},\n$$\nwhere\n$$\na_{h}(w_{h},v_{h}) := \\int_{0}^{\\frac{1}{2}} w_{h}'(x)\\,v_{h}'(x)\\,dx \\;+\\; \\int_{\\frac{1}{2}}^{1} w_{h}'(x)\\,v_{h}'(x)\\,dx.\n$$\nTasks:\n1) Starting from the strong PDE and boundary conditions, determine the exact solution $u$.\n2) Parameterize $u_{h} \\in V_{h}$ as $u_{h}(x) = \\alpha x$ on $[0,\\tfrac{1}{2}]$ and $u_{h}(x) = \\beta(1-x)$ on $[\\tfrac{1}{2},1]$, and determine the coefficients $\\alpha$ and $\\beta$ from the discrete equations tested with $\\varphi_{L}$ and $\\varphi_{R}$.\n3) Using only the definitions above, compute the Galerkin orthogonality defect\n$$\n\\delta := a(u-u_{h},\\varphi_{L}).\n$$\n4) Identify precisely which step of the usual Galerkin orthogonality proof (i.e., the derivation that yields $a(u-u_{h},v_{h})=0$ for all $v_{h}$) cannot be applied here because $V_{h} \\not\\subset V$, and express the interface consistency term that replaces it in this example; verify that it equals the value of $\\delta$ you computed.\n\nReport the single real number $\\delta$ as your final answer, in exact form (no rounding). No units are required.", "solution": "**1. Determination of the Exact Solution $u$**\n\nThe strong form of the boundary value problem is given by the differential equation $-u'' = x$ for $x \\in (0,1)$, with homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$.\n\nWe begin by integrating the differential equation twice with respect to $x$.\nThe first integration yields:\n$$\n-u'(x) = \\int x \\,dx = \\frac{x^2}{2} + C_1\n$$\nwhere $C_1$ is a constant of integration.\nThe second integration yields:\n$$\n-u(x) = \\int \\left(\\frac{x^2}{2} + C_1\\right) dx = \\frac{x^3}{6} + C_1 x + C_2\n$$\nwhere $C_2$ is a second constant of integration. The general solution is thus $u(x) = -\\frac{x^3}{6} - C_1 x - C_2$.\n\nWe now apply the boundary conditions to determine the constants $C_1$ and $C_2$.\nThe condition $u(0)=0$ implies:\n$$\nu(0) = -\\frac{0^3}{6} - C_1(0) - C_2 = 0 \\implies C_2 = 0\n$$\nThe condition $u(1)=0$ implies:\n$$\nu(1) = -\\frac{1^3}{6} - C_1(1) - 0 = 0 \\implies -\\frac{1}{6} - C_1 = 0 \\implies C_1 = -\\frac{1}{6}\n$$\nSubstituting the values of $C_1$ and $C_2$ back into the general solution, we obtain the exact solution:\n$$\nu(x) = -\\frac{x^3}{6} - \\left(-\\frac{1}{6}\\right)x = \\frac{x - x^3}{6}\n$$\nFor later use, we also compute the derivative of the exact solution:\n$$\nu'(x) = \\frac{d}{dx}\\left(\\frac{x - x^3}{6}\\right) = \\frac{1 - 3x^2}{6}\n$$\n\n**2. Determination of the Discrete Solution $u_h$**\n\nThe discrete solution $u_h \\in V_h$ is found by solving the discrete weak formulation $a_h(u_h,v_h) = \\ell(v_h)$ for all $v_h \\in V_h$. It is sufficient to test this equation against the basis functions $\\{\\varphi_L, \\varphi_R\\}$.\n\nThe discrete solution is parameterized as $u_h(x) = \\alpha x$ on $[0,\\tfrac{1}{2}]$ and $u_h(x) = \\beta(1-x)$ on $[\\tfrac{1}{2},1]$. The derivatives are therefore $u_h'(x) = \\alpha$ on $(0,\\tfrac{1}{2})$ and $u_h'(x) = -\\beta$ on $(\\tfrac{1}{2},1)$.\n\nThe basis functions have derivatives $\\varphi_L'(x) = 2$ on $(0,\\tfrac{1}{2})$ and $\\varphi_L'(x) = 0$ on $(\\tfrac{1}{2},1)$, while $\\varphi_R'(x) = 0$ on $(0,\\tfrac{1}{2})$ and $\\varphi_R'(x) = -2$ on $(\\tfrac{1}{2},1)$.\n\nWe form a $2 \\times 2$ linear system for the coefficients $\\alpha$ and $\\beta$.\n\nFor the first equation, we test with $v_h = \\varphi_L$:\n$$\na_h(u_h, \\varphi_L) = \\ell(\\varphi_L)\n$$\nThe left-hand side is:\n$$\na_h(u_h, \\varphi_L) = \\int_0^{\\frac{1}{2}} u_h'(x)\\varphi_L'(x) dx + \\int_{\\frac{1}{2}}^1 u_h'(x)\\varphi_L'(x) dx = \\int_0^{\\frac{1}{2}} (\\alpha)(2)\\,dx + \\int_{\\frac{1}{2}}^1 (-\\beta)(0)\\,dx = 2\\alpha \\int_0^{\\frac{1}{2}} dx = 2\\alpha\\left(\\frac{1}{2}\\right) = \\alpha\n$$\nThe right-hand side is:\n$$\n\\ell(\\varphi_L) = \\int_0^1 x \\varphi_L(x) dx = \\int_0^{\\frac{1}{2}} x(2x) dx = 2\\int_0^{\\frac{1}{2}} x^2 dx = 2\\left[\\frac{x^3}{3}\\right]_0^{\\frac{1}{2}} = 2\\left(\\frac{(1/2)^3}{3}\\right) = 2\\left(\\frac{1}{24}\\right) = \\frac{1}{12}\n$$\nThus, the first equation is $\\alpha = \\frac{1}{12}$.\n\nFor the second equation, we test with $v_h = \\varphi_R$:\n$$\na_h(u_h, \\varphi_R) = \\ell(\\varphi_R)\n$$\nThe left-hand side is:\n$$\na_h(u_h, \\varphi_R) = \\int_0^{\\frac{1}{2}} u_h'(x)\\varphi_R'(x) dx + \\int_{\\frac{1}{2}}^1 u_h'(x)\\varphi_R'(x) dx = \\int_0^{\\frac{1}{2}} (\\alpha)(0)\\,dx + \\int_{\\frac{1}{2}}^1 (-\\beta)(-2)\\,dx = 2\\beta \\int_{\\frac{1}{2}}^1 dx = 2\\beta\\left(\\frac{1}{2}\\right) = \\beta\n$$\nThe right-hand side is:\n$$\n\\ell(\\varphi_R) = \\int_0^1 x \\varphi_R(x) dx = \\int_{\\frac{1}{2}}^1 x(2(1-x)) dx = 2\\int_{\\frac{1}{2}}^1 (x - x^2) dx = 2\\left[\\frac{x^2}{2} - \\frac{x^3}{3}\\right]_{\\frac{1}{2}}^1\n$$\n$$\n= 2\\left[ \\left(\\frac{1}{2}-\\frac{1}{3}\\right) - \\left(\\frac{(1/2)^2}{2} - \\frac{(1/2)^3}{3}\\right) \\right] = 2\\left[ \\frac{1}{6} - \\left(\\frac{1}{8} - \\frac{1}{24}\\right) \\right] = 2\\left[ \\frac{1}{6} - \\frac{2}{24} \\right] = 2\\left[ \\frac{1}{6} - \\frac{1}{12} \\right] = 2\\left(\\frac{1}{12}\\right) = \\frac{1}{6}\n$$\nThus, the second equation is $\\beta = \\frac{1}{6}$.\n\nThe discrete solution is $u_h(x) = \\frac{1}{12}x$ on $[0,\\tfrac{1}{2}]$ and $u_h(x) = \\frac{1}{6}(1-x)$ on $[\\tfrac{1}{2},1]$.\n\n**3. Computation of the Galerkin Orthogonality Defect $\\delta$**\n\nThe defect is defined as $\\delta := a(u-u_h,\\varphi_{L})$. The bilinear form $a(\\cdot,\\cdot)$ is an integral over the entire domain $(0,1)$.\n$$\n\\delta = \\int_0^1 (u'(x) - u_h'(x))\\varphi_L'(x) dx\n$$\nSince $\\varphi_L'(x) = 0$ for $x > \\frac{1}{2}$, the integral reduces to the interval $(0, \\frac{1}{2})$:\n$$\n\\delta = \\int_0^{\\frac{1}{2}} (u'(x) - u_h'(x))\\varphi_L'(x) dx\n$$\nOn this interval, we have $u'(x) = \\frac{1-3x^2}{6}$, $u_h'(x) = \\alpha = \\frac{1}{12}$, and $\\varphi_L'(x) = 2$.\n$$\n\\delta = \\int_0^{\\frac{1}{2}} \\left( \\frac{1-3x^2}{6} - \\frac{1}{12} \\right) (2) dx = 2 \\int_0^{\\frac{1}{2}} \\frac{2(1-3x^2) - 1}{12} dx = \\frac{1}{6} \\int_0^{\\frac{1}{2}} (1 - 6x^2) dx\n$$\nEvaluating the integral:\n$$\n\\delta = \\frac{1}{6} \\left[ x - 2x^3 \\right]_0^{\\frac{1}{2}} = \\frac{1}{6} \\left( \\left(\\frac{1}{2}\\right) - 2\\left(\\frac{1}{2}\\right)^3 \\right) = \\frac{1}{6} \\left( \\frac{1}{2} - 2\\left(\\frac{1}{8}\\right) \\right) = \\frac{1}{6} \\left( \\frac{1}{2} - \\frac{1}{4} \\right) = \\frac{1}{6} \\left( \\frac{1}{4} \\right) = \\frac{1}{24}\n$$\n\n**4. Analysis of Galerkin Orthogonality Failure**\n\nFor a standard conforming method, where the discrete space $V_h$ is a subspace of the continuous space $V$ (i.e., $V_h \\subset V$), Galerkin orthogonality holds: $a(u-u_h, v_h) = 0$ for all $v_h \\in V_h$. This is proven as follows:\n$$\na(u-u_h, v_h) = a(u, v_h) - a(u_h, v_h)\n$$\nSince $v_h \\in V_h \\subset V$, we can use $v_h$ as a test function in the continuous weak formulation, giving $a(u, v_h) = \\ell(v_h)$. The conforming discrete formulation is $a(u_h, v_h) = \\ell(v_h)$. Substituting these gives:\n$$\na(u-u_h, v_h) = \\ell(v_h) - \\ell(v_h) = 0\n$$\nThe step that fails in the current problem is the assumption $V_h \\subset V$. The space $V=H_0^1(0,1)$ contains functions which are (equivalent to) continuous functions. The discrete space $V_h$ consists of functions that are piecewise linear but are not required to be continuous at the interface $x=\\frac{1}{2}$. For instance, for the basis function $\\varphi_L$, we have $\\varphi_L(\\frac{1}{2}^-) = 1$ and $\\varphi_L(\\frac{1}{2}^+) = 0$. This jump discontinuity means $\\varphi_L \\notin H^1(0,1)$, and therefore $V_h \\not\\subset V$. Consequently, we cannot set $v = v_h$ in the continuous weak formulation $a(u,v) = \\ell(v)$.\n\nTo find the correct relation, we must return to first principles. For a smooth solution $u$ and a test function $v_h \\in V_h$, we integrate $-u''=x$ against $v_h$ and integrate by parts element-wise:\n$$\n\\ell(v_h) = \\int_0^1 x v_h(x) dx = \\int_0^1 (-u''(x)) v_h(x) dx = \\int_0^{\\frac{1}{2}} (-u'') v_h dx + \\int_{\\frac{1}{2}}^1 (-u'') v_h dx\n$$\nApplying integration by parts to each integral:\n$$\n\\ell(v_h) = \\left[-u'v_h\\right]_0^{\\frac{1}{2}^-} + \\int_0^{\\frac{1}{2}} u' v_h' dx + \\left[-u'v_h\\right]_{\\frac{1}{2}^+}^1 + \\int_{\\frac{1}{2}}^1 u' v_h' dx\n$$\nThe sum of the integrals is by definition $a(u, v_h)$. The boundary terms at $x=0$ and $x=1$ vanish because $v_h(0)=v_h(1)=0$. The remaining terms are the interface terms at $x=\\frac{1}{2}$:\n$$\n\\left(-u'(\\tfrac{1}{2})v_h(\\tfrac{1}{2}^-)\\right) - \\left(-u'(\\tfrac{1}{2})v_h(\\tfrac{1}{2}^+)\\right) = u'(\\tfrac{1}{2}) \\left( v_h(\\tfrac{1}{2}^+) - v_h(\\tfrac{1}{2}^-) \\right) = u'(\\tfrac{1}{2}) [|v_h|]_{\\frac{1}{2}}\n$$\nwhere $[|v_h|]_{\\frac{1}{2}}$ is the jump of $v_h$ at $x=\\frac{1}{2}$.\nThis gives the identity (a form of Green's identity):\n$$\n\\ell(v_h) = a(u, v_h) + u'(\\tfrac{1}{2})[|v_h|]_{\\frac{1}{2}}\n$$\nThis can be rewritten as $a(u, v_h) = \\ell(v_h) - u'(\\tfrac{1}{2})[|v_h|]_{\\frac{1}{2}}$. The term $u'(\\tfrac{1}{2})[|v_h|]_{\\frac{1}{2}}$ is the interface consistency term. This term is zero for conforming elements (where the jump is zero) but is non-zero here.\n\nNow, we can express the error:\n$$\na(u-u_h, v_h) = a(u,v_h) - a(u_h, v_h)\n$$\nIn this problem, $a_h(w_h, v_h)$ is defined as the element-wise sum of integrals, so $a_h(u_h, v_h) = a(u_h, v_h)$. From the discrete formulation, $a(u_h, v_h) = \\ell(v_h)$.\n$$\na(u-u_h, v_h) = \\left( \\ell(v_h) - u'(\\tfrac{1}{2})[|v_h|]_{\\frac{1}{2}} \\right) - \\ell(v_h) = -u'(\\tfrac{1}{2})[|v_h|]_{\\frac{1}{2}}\n$$\nThe Galerkin orthogonality relation is replaced by this expression, which measures the consistency error of the method.\n\nWe verify this formula for $v_h = \\varphi_L$, for which the defect is $\\delta$.\nFirst, calculate $u'(\\frac{1}{2})$:\n$$\nu'(\\tfrac{1}{2}) = \\frac{1-3(\\frac{1}{2})^2}{6} = \\frac{1 - \\frac{3}{4}}{6} = \\frac{\\frac{1}{4}}{6} = \\frac{1}{24}\n$$\nNext, calculate the jump $[|\\varphi_L|]_{\\frac{1}{2}}$:\n$$\n\\varphi_L(\\tfrac{1}{2}^-) = 2x \\big|_{x=\\frac{1}{2}} = 1, \\qquad \\varphi_L(\\tfrac{1}{2}^+) = 0\n$$\n$$\n[|\\varphi_L|]_{\\frac{1}{2}} = \\varphi_L(\\tfrac{1}{2}^+) - \\varphi_L(\\tfrac{1}{2}^-) = 0 - 1 = -1\n$$\nUsing the derived formula for the defect:\n$$\n\\delta = a(u-u_h, \\varphi_L) = -u'(\\tfrac{1}{2})[|\\varphi_L|]_{\\frac{1}{2}} = -\\left(\\frac{1}{24}\\right)(-1) = \\frac{1}{24}\n$$\nThis result matches the value of $\\delta$ computed directly in Task 3, which serves as a verification of our analysis.", "answer": "$$\\boxed{\\frac{1}{24}}$$", "id": "2561497"}]}