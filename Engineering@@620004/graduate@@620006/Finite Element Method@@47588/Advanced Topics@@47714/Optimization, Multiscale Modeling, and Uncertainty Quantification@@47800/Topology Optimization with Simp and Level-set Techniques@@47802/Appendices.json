{"hands_on_practices": [{"introduction": "The foundation of the Solid Isotropic Material with Penalization (SIMP) method is its 'ersatz' material model, which mathematically relates an element's density to its stiffness. This first exercise [@problem_id:2606482] challenges you to reconstruct the standard SIMP interpolation law from a set of fundamental modelling conditions. By doing so and then calculating the effective stiffness for different density values, you will gain a concrete understanding of how the penalization exponent $p$ discourages intermediate densities and why a minimum stiffness $E_{\\min}$ is crucial for numerical stability.", "problem": "Consider a linear elastic compliance-minimization topology optimization problem discretized by the Finite Element Method (FEM). The material distribution is represented by element-wise densities $\\rho_e \\in [0,1]$ over a fixed mesh, and an ersatz material approach is used to avoid singular stiffness matrices by assigning a small but nonzero stiffness to elements with $\\rho_e \\approx 0$. In the Solid Isotropic Material with Penalization (SIMP) framework, the effective element-wise Young’s modulus $E(\\rho_e)$ is required to satisfy the following fundamental conditions derived from the modeling assumptions:\n1) $E(\\rho_e)$ is monotonically increasing in $\\rho_e$.\n2) $E(0) = E_{\\min}$ and $E(1) = E_0$, where $E_0$ is the Young’s modulus of the fully solid material and $E_{\\min} \\ll E_0$ is the ersatz stiffness for near-void elements.\n3) The element stiffness matrix scales linearly with $E(\\rho_e)$, i.e., $K_e(\\rho_e) = E(\\rho_e)\\,\\tilde{K}_e$, where $\\tilde{K}_e$ is the reference stiffness matrix computed for unit modulus.\n4) A penalization exponent $p>1$ enforces the energetic disfavoring of intermediate densities by accentuating the contrast between $E(0)$ and $E(1)$.\n\nUsing only these conditions and dimensional consistency, first reconstruct the simplest smooth power-law interpolation for $E(\\rho_e)$ consistent with the above constraints for a given exponent $p$. Then, for $p=3$, $E_{\\min}=10^{-3}E_0$, and three representative element densities $\\rho_e \\in \\{0.1,\\,0.5,\\,0.9\\}$, compute the normalized effective stiffnesses $E(\\rho_e)/E_0$. Explain, in the context of topology optimization and in contrast to level-set formulations with crisp material boundaries, how these values reflect the penalization of intermediate densities and the role of $E_{\\min}$ in numerical stability.\n\nReport your answer as the row vector $[\\,E(0.1)/E_0,\\;E(0.5)/E_0,\\;E(0.9)/E_0\\,]$ using exact values (no rounding). No units are required because the normalization by $E_0$ renders the quantities dimensionless.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nThe givens are as follows:\n- A linear elastic compliance-minimization problem is discretized using the Finite Element Method (FEM).\n- Material distribution is described by element-wise densities $\\rho_e \\in [0,1]$.\n- An ersatz material approach is used.\n- The framework is the Solid Isotropic Material with Penalization (SIMP) model.\n- The effective element-wise Young’s modulus $E(\\rho_e)$ must satisfy four conditions:\n    1. $E(\\rho_e)$ is monotonically increasing in $\\rho_e$.\n    2. Boundary conditions: $E(0) = E_{\\min}$ and $E(1) = E_0$, where $E_0$ is the solid material modulus and $E_{\\min} \\ll E_0$ is the ersatz stiffness.\n    3. The element stiffness matrix scales linearly with the modulus: $K_e(\\rho_e) = E(\\rho_e)\\,\\tilde{K}_e$.\n    4. A penalization exponent $p > 1$ is used to energetically disfavor intermediate densities.\n- Specific values for computation: $p=3$, $E_{\\min}=10^{-3}E_0$.\n- Representative densities for evaluation: $\\rho_e \\in \\{0.1,\\,0.5,\\,0.9\\}$.\n\nValidation of the problem statement:\n- **Scientific Grounding**: The problem is firmly grounded in the established theory of continuum mechanics and computational structural optimization. The SIMP method is a canonical and widely used technique in topology optimization. All assumptions and conditions are standard in the field.\n- **Well-Posedness**: The problem is well-posed. The constraints provided are sufficient to uniquely determine the simplest form of the interpolation function. The subsequent calculation is a direct application of this derived function.\n- **Objectivity**: The problem is stated in precise, objective, and technical language, free from ambiguity or subjective claims.\n\nThe problem statement is found to be valid as it is scientifically sound, well-posed, objective, and complete. No flaws from the checklist are identified. The solution process may proceed.\n\nFirst, we must reconstruct the simplest smooth power-law interpolation for the effective Young's modulus, $E(\\rho_e)$, based on the given conditions. Let the function be a general power-law relationship. The penalization (Condition 4) is introduced through the term $\\rho_e^p$. To satisfy the boundary conditions (Condition 2), we seek a function that maps the penalized density range, which is $[0^p, 1^p] = [0, 1]$, to the stiffness range $[E_{\\min}, E_0]$. A simple linear mapping of the penalized density variable $\\rho_e^p$ to the stiffness $E$ is the most straightforward approach.\n\nLet us propose the following functional form:\n$$\nE(\\rho_e) = A + B \\cdot \\rho_e^p\n$$\nwhere $A$ and $B$ are constants to be determined by the boundary conditions.\n\nUsing Condition 2, we have:\nAt $\\rho_e = 0$: $E(0) = A + B \\cdot (0)^p = A$. We are given $E(0) = E_{\\min}$, therefore $A = E_{\\min}$.\nAt $\\rho_e = 1$: $E(1) = A + B \\cdot (1)^p = A + B$. We are given $E(1) = E_0$.\nSubstituting $A = E_{\\min}$, we get $E_0 = E_{\\min} + B$, which implies $B = E_0 - E_{\\min}$.\n\nSubstituting the constants $A$ and $B$ back into the proposed form gives the interpolation scheme:\n$$\nE(\\rho_e) = E_{\\min} + (E_0 - E_{\\min})\\rho_e^p\n$$\nThis is the standard SIMP interpolation model. We must verify this against the remaining conditions.\n\n- **Condition 1 (Monotonicity)**: We check the derivative of $E(\\rho_e)$ with respect to $\\rho_e$:\n$$\n\\frac{dE}{d\\rho_e} = \\frac{d}{d\\rho_e} \\left( E_{\\min} + (E_0 - E_{\\min})\\rho_e^p \\right) = (E_0 - E_{\\min}) p \\rho_e^{p-1}\n$$\nGiven that $E_{\\min} \\ll E_0$, the term $(E_0 - E_{\\min})$ is positive. The penalization exponent $p > 1$ is also positive. For $\\rho_e \\in [0, 1]$, the term $\\rho_e^{p-1}$ is non-negative. Thus, $\\frac{dE}{d\\rho_e} \\ge 0$ over the entire domain, confirming that the function is monotonically increasing.\n\n- **Condition 3 (Linear Scaling of Stiffness Matrix)**: This is satisfied by the problem's own setup, where the element stiffness is defined as $K_e(\\rho_e) = E(\\rho_e)\\,\\tilde{K}_e$. Our derived $E(\\rho_e)$ is a scalar function that multiplies the reference stiffness matrix, which is consistent.\n\n- **Condition 4 (Penalization)**: For any $\\rho_e \\in (0, 1)$ and $p > 1$, we have $\\rho_e^p < \\rho_e$. The derived formula shows that the modulus scales with $\\rho_e^p$, not $\\rho_e$. In a typical compliance minimization problem, the total material volume is constrained, and it scales linearly with $\\rho_e$. The stiffness, however, scales with $\\rho_e^p$. This mismatch makes intermediate densities structurally inefficient (low stiffness for their \"cost\" in volume), thus driving the optimization algorithm to select nearly binary densities ($0$ or $1$).\n\nNext, we compute the normalized effective stiffness, $E(\\rho_e)/E_0$, for the given parameters $p=3$ and $E_{\\min} = 10^{-3}E_0$.\nThe normalized stiffness is:\n$$\n\\frac{E(\\rho_e)}{E_0} = \\frac{E_{\\min} + (E_0 - E_{\\min})\\rho_e^p}{E_0} = \\frac{E_{\\min}}{E_0} + \\left(1 - \\frac{E_{\\min}}{E_0}\\right)\\rho_e^p\n$$\nSubstituting the given values $\\frac{E_{\\min}}{E_0} = 10^{-3} = 0.001$ and $p=3$:\n$$\n\\frac{E(\\rho_e)}{E_0} = 0.001 + (1 - 0.001)\\rho_e^3 = 0.001 + 0.999 \\rho_e^3\n$$\nNow we evaluate this expression for the three specified values of $\\rho_e$:\n\n1. For $\\rho_e = 0.1$:\n$$\n\\frac{E(0.1)}{E_0} = 0.001 + 0.999 \\cdot (0.1)^3 = 0.001 + 0.999 \\cdot 0.001 = 0.001 \\cdot (1 + 0.999) = 0.001999\n$$\n\n2. For $\\rho_e = 0.5$:\n$$\n\\frac{E(0.5)}{E_0} = 0.001 + 0.999 \\cdot (0.5)^3 = 0.001 + 0.999 \\cdot 0.125 = 0.001 + 0.124875 = 0.125875\n$$\n\n3. For $\\rho_e = 0.9$:\n$$\n\\frac{E(0.9)}{E_0} = 0.001 + 0.999 \\cdot (0.9)^3 = 0.001 + 0.999 \\cdot 0.729 = 0.001 + 0.728271 = 0.729271\n$$\n\nFinally, we provide the required explanations.\n\n- **Penalization of intermediate densities**: The computed values demonstrate the effect of penalization. For an element with density $\\rho_e=0.5$, its normalized stiffness is only about $0.126$. This value is significantly lower than the density itself. If there were no penalization (i.e., $p=1$), the normalized stiffness would be approximately $\\frac{E(0.5)}{E_0} \\approx 0.5$. The exponent $p=3$ has reduced the stiffness contribution of this intermediate density element by a factor of approximately $0.5 / 0.126 \\approx 4$. An optimization algorithm that seeks to maximize stiffness for a given material volume will therefore find it highly inefficient to use material at this density, and will be driven to push the density towards either $0$ or $1$, resulting in a more black-and-white, manufacturable design.\n\n- **Role of $E_{\\min}$**: The minimum modulus $E_{\\min}$ is a numerical device, not a physical one. In the finite element formulation, the global stiffness matrix $K$ must be inverted to solve the system of linear equations $KU=F$. If elements were allowed to have zero stiffness ($E=0$), large regions of \"void\" elements could render the global matrix $K$ singular (non-invertible), causing the simulation to fail. By assigning a small, non-zero stiffness $E_{\\min}$ to void elements ($\\rho_e \\approx 0$), we guarantee that $K$ remains positive definite and invertible throughout the optimization process. The result for $\\rho_e=0.1$ shows the effect: the stiffness $0.001999 E_0$ is very small, dominated by the $E_{\\min}$ term (which contributes $0.001 E_0$) but critically, it is not zero.\n\n- **Contrast with Level-Set Formulations**: SIMP is a density-based method where the design variable is a material property field $\\rho_e(x)$ defined over a fixed mesh. This field can contain regions of intermediate density (\"gray\" material), and the penalization scheme is essential to suppress them. In contrast, level-set methods are boundary-based. They represent the structure implicitly via the zero-isocontour of a higher-dimensional function $\\phi(x)$. The domain is partitioned into distinct solid ($\\phi(x)\\ge 0$) and void ($\\phi(x)\\lt 0$) regions, with a sharp, well-defined boundary. There are no intermediate densities in the material model itself. Therefore, the concept of \"penalizing\" intermediate densities is irrelevant to level-set methods. The optimization in level-set methods evolves the boundary shape to minimize compliance, whereas SIMP evolves a material distribution. Consequently, level-set methods inherently produce crisp, analysis-ready designs but face greater challenges in initiating topological changes (e.g., creating new holes), a task that SIMP handles naturally.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.001999 & 0.125875 & 0.729271\n\\end{pmatrix}\n}\n$$", "id": "2606482"}, {"introduction": "While the SIMP model is powerful, its naïve application can lead to numerical instabilities, most notably the formation of checkerboard patterns. This exercise [@problem_id:2606624] dives into the root cause of this issue, demonstrating how these patterns can exhibit an artificially high stiffness, making them a spurious local minimum for the optimization algorithm. By comparing a checkerboard design to a uniform one, you will quantify this artificial stiffness advantage and see firsthand how a density filter fundamentally resolves the problem by enforcing a geometric length scale.", "problem": "Consider linear elastic topology optimization with the Solid Isotropic Material with Penalization (SIMP) interpolation for the elastic modulus. Let a unit-thickness, unit-square domain $\\Omega = [0,1]\\times [0,1]$ be discretized by a uniform $2 \\times 2$ mesh of bilinear quadrilateral finite elements. Assume plane stress with Poisson’s ratio $\\nu = 0$ so that the uniaxial energy density simplifies to the one-dimensional form. The elastic modulus is interpolated by SIMP as $E(\\rho) = E_{\\min} + \\rho^{p}\\left(E_{0} - E_{\\min}\\right)$ with penalization exponent $p > 1$. For this problem, set $E_{\\min} = 0$ to focus on the instability mechanism, and take $E_{0} > 0$ as a constant.\n\nImpose Kinematic Uniform Boundary Conditions (KUBC) by prescribing the displacement field $\\mathbf{u}(x,y) = (U x, 0)$ on all boundary nodes, with $U = 1$. With bilinear shape functions, this boundary condition is reproduced exactly within each element so that the strain is uniform, $\\epsilon_{xx} = 1$ and all other components vanish.\n\nDefine the effective stiffness $K_{\\mathrm{eff}}$ as the total reaction in the $x$-direction on the boundary $\\{x=1\\}$ divided by the imposed scalar $U$.\n\nConstruct two designs with the same volume fraction $\\bar{\\rho} = \\frac{1}{2}$:\n(1) a uniform design with $\\rho_{e} \\equiv \\bar{\\rho}$ in all four elements, and\n(2) a checkerboard design with $\\rho_{e} \\in \\{0,1\\}$ arranged such that two diagonally opposite elements have $\\rho_{e} = 1$ and the other two have $\\rho_{e} = 0$, yielding the same average $\\bar{\\rho} = \\frac{1}{2}$.\n\nStarting from the principle of minimum potential energy and the definition of $K_{\\mathrm{eff}}$, derive the expression for the apparent stiffness advantage factor $R_{\\mathrm{pre}}$, defined as the ratio of the checkerboard effective stiffness to the uniform effective stiffness, $R_{\\mathrm{pre}} = \\dfrac{K_{\\mathrm{eff}}^{\\mathrm{checker}}}{K_{\\mathrm{eff}}^{\\mathrm{uniform}}}$, in terms of $p$ only.\n\nThen, apply a linear density filter with uniform weights over all four elements, i.e., for each element $e$, define the filtered density $\\tilde{\\rho}_{e} = \\dfrac{1}{4}\\sum_{j=1}^{4} \\rho_{j}$, and recompute the effective stiffness of the filtered checkerboard. Explain, using the same reasoning base, why the post-filter ratio $R_{\\mathrm{post}} = \\dfrac{K_{\\mathrm{eff}}^{\\mathrm{filtered\\ checker}}}{K_{\\mathrm{eff}}^{\\mathrm{uniform}}}$ becomes unity.\n\nProvide as your final answer the closed-form analytic expression for $R_{\\mathrm{pre}}$ in terms of $p$. No numerical substitution is required. Express the final answer as a single analytic expression with no units.", "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. We may proceed.\n\nThe core of this problem lies in the relationship between the total strain energy $\\mathcal{U}$ of the system and its effective stiffness $K_{\\mathrm{eff}}$. For a linear elastic system subjected to prescribed boundary displacements, the total strain energy at equilibrium is given by $\\mathcal{U} = \\frac{1}{2} K_{\\mathrm{eff}} U^2$, where $U$ is the characteristic magnitude of the imposed displacement. In this problem, we are given $U=1$. Thus, the relationship simplifies to $K_{\\mathrm{eff}} = 2\\mathcal{U}$.\n\nThe total strain energy $\\mathcal{U}$ is the integral of the strain energy density $w$ over the entire domain volume $V$. As the domain is discretized into $4$ finite elements, this is the sum of the energies in each element:\n$$ \\mathcal{U} = \\sum_{e=1}^{4} \\mathcal{U}_e = \\sum_{e=1}^{4} \\int_{\\Omega_e} w_e \\, dV $$\nThe strain energy density is $w = \\frac{1}{2} \\boldsymbol{\\epsilon}^T \\mathbf{C} \\boldsymbol{\\epsilon}$. For a plane stress condition with Poisson's ratio $\\nu=0$, the constitutive matrix $\\mathbf{C}$ is diagonal:\n$$ \\mathbf{C} = E(\\rho) \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} $$\nThe problem states that the Kinematic Uniform Boundary Conditions (KUBC) result in a uniform strain field $\\epsilon_{xx}=1$ with all other components being zero. Thus, the strain vector is $\\boldsymbol{\\epsilon} = (1, 0, 0)^T$. The strain energy density within an element $e$ with density $\\rho_e$ is:\n$$ w_e = \\frac{1}{2} E(\\rho_e) (1)^2 = \\frac{1}{2} E(\\rho_e) $$\nThe domain is a unit square of unit thickness, so its total volume is $1$. The $2 \\times 2$ uniform mesh means each of the $4$ elements has a volume $V_e = \\frac{1}{4}$. Since the strain field is uniform and the material properties are constant within each element, the strain energy for a single element is:\n$$ \\mathcal{U}_e = w_e V_e = \\left(\\frac{1}{2} E(\\rho_e)\\right) \\left(\\frac{1}{4}\\right) = \\frac{1}{8} E(\\rho_e) $$\nThe total strain energy for the $4$-element assembly is the sum:\n$$ \\mathcal{U} = \\sum_{e=1}^{4} \\mathcal{U}_e = \\frac{1}{8} \\sum_{e=1}^{4} E(\\rho_e) $$\nUsing the given SIMP law, $E(\\rho) = E_0 \\rho^p$ (since $E_{\\min}=0$), the total strain energy is:\n$$ \\mathcal{U} = \\frac{E_0}{8} \\sum_{e=1}^{4} \\rho_e^p $$\nThe effective stiffness is therefore:\n$$ K_{\\mathrm{eff}} = 2\\mathcal{U} = \\frac{E_0}{4} \\sum_{e=1}^{4} \\rho_e^p $$\nThis general expression allows us to compute the stiffness for any given density distribution $\\{\\rho_e\\}$.\n\nFirst, we analyze the uniform design. Here, $\\rho_e = \\bar{\\rho} = \\frac{1}{2}$ for all $4$ elements.\n$$ K_{\\mathrm{eff}}^{\\mathrm{uniform}} = \\frac{E_0}{4} \\sum_{e=1}^{4} \\left(\\frac{1}{2}\\right)^p = \\frac{E_0}{4} \\left(4 \\cdot \\left(\\frac{1}{2}\\right)^p\\right) = E_0 \\left(\\frac{1}{2}\\right)^p = E_0 2^{-p} $$\n\nNext, we analyze the checkerboard design. Here, two diagonal elements have density $\\rho_e = 1$ and the other two have $\\rho_e = 0$.\n$$ K_{\\mathrm{eff}}^{\\mathrm{checker}} = \\frac{E_0}{4} \\left(1^p + 0^p + 1^p + 0^p\\right) = \\frac{E_0}{4} (1 + 0 + 1 + 0) = \\frac{E_0}{4}(2) = \\frac{E_0}{2} $$\nNote that $0^p=0$ for $p>1$. The stiffness of an element with zero density is correctly zero.\n\nThe apparent stiffness advantage factor $R_{\\mathrm{pre}}$ is the ratio of these two stiffnesses:\n$$ R_{\\mathrm{pre}} = \\frac{K_{\\mathrm{eff}}^{\\mathrm{checker}}}{K_{\\mathrm{eff}}^{\\mathrm{uniform}}} = \\frac{E_0/2}{E_0 2^{-p}} = \\frac{1}{2} \\cdot 2^p = 2^{p-1} $$\nThis result demonstrates the artificial stiffening effect of checkerboard patterns under the SIMP model. Because the penalization function $f(\\rho) = \\rho^p$ is convex for $p>1$, Jensen's inequality implies that the arithmetic average of the interpolated moduli is greater than the modulus of the average density: $\\frac{1}{N}\\sum E(\\rho_i) \\geq E(\\frac{1}{N}\\sum \\rho_i)$. The KUBC setup physically realizes the arithmetic average (Voigt bound), giving the checkerboard a higher apparent stiffness.\n\nNow we consider the application of a linear density filter with uniform weights over all $4$ elements. The filtered, or physical, density $\\tilde{\\rho}_e$ of any element $e$ is given by the average of the design densities $\\rho_j$:\n$$ \\tilde{\\rho}_{e} = \\frac{1}{4} \\sum_{j=1}^{4} \\rho_{j} $$\nFor the checkerboard design, the design densities are $\\{\\rho_1, \\rho_2, \\rho_3, \\rho_4\\} = \\{1, 0, 1, 0\\}$ (or a permutation thereof). The sum is $\\sum \\rho_j = 1+0+1+0 = 2$.\nApplying the filter, we find the physical density for every element is:\n$$ \\tilde{\\rho}_{e} = \\frac{1}{4}(2) = \\frac{1}{2} $$\nAfter filtering, the checkerboard design is transformed into a design where every element has a physical density of $\\frac{1}{2}$. This is identical to the original uniform design. The stiffness is calculated using these physical densities $\\tilde{\\rho}_e$:\n$$ K_{\\mathrm{eff}}^{\\mathrm{filtered\\ checker}} = \\frac{E_0}{4} \\sum_{e=1}^{4} (\\tilde{\\rho}_e)^p = \\frac{E_0}{4} \\sum_{e=1}^{4} \\left(\\frac{1}{2}\\right)^p = E_0 2^{-p} $$\nThis is, by construction, identical to $K_{\\mathrm{eff}}^{\\mathrm{uniform}}$.\nTherefore, the post-filter ratio $R_{\\mathrm{post}}$ is:\n$$ R_{\\mathrm{post}} = \\frac{K_{\\mathrm{eff}}^{\\mathrm{filtered\\ checker}}}{K_{\\mathrm{eff}}^{\\mathrm{uniform}}} = \\frac{E_0 2^{-p}}{E_0 2^{-p}} = 1 $$\nThe filter eliminates the artificial stiffness advantage by enforcing a length scale, effectively smearing out the high-frequency checkerboard pattern into its volumetric average before the physics (stiffness calculation) is applied. In this specific case with a global averaging filter, the checkerboard design becomes physically indistinguishable from the uniform design, and their stiffnesses are necessarily equal.\n\nThe problem asks for the analytic expression for $R_{\\mathrm{pre}}$.", "answer": "$$\\boxed{2^{p-1}}$$", "id": "2606624"}, {"introduction": "Topology optimization is a gradient-driven process, where material is redistributed based on its structural contribution. This exercise [@problem_id:2606569] guides you through the essential derivation of the objective function's sensitivity—the gradient that informs the optimizer where to add or remove material. By applying the adjoint method to a multi-load compliance objective, you will derive the exact expression that links an element's local strain energy to its global impact on performance, forming the computational engine of the entire optimization loop.", "problem": "A linearly elastic structure is discretized by the finite element method into $n_{\\mathrm{el}}$ elements with design variables $\\rho_{e} \\in (0,1]$ for $e \\in \\{1,\\dots,n_{\\mathrm{el}}\\}$. The effective elastic modulus in the Solid Isotropic Material with Penalization (SIMP) interpolation is $E(\\rho_{e}) = E_{\\min} + \\rho_{e}^{p}\\left(E_{0} - E_{\\min}\\right)$, where $E_{0} > 0$ is the modulus of the solid phase, $E_{\\min} > 0$ is a small background stiffness, and $p \\geq 1$ is the penalization exponent. Let $\\mathbf{K}(\\boldsymbol{\\rho})$ be the assembled global stiffness matrix, obtained by standard finite element assembly of element stiffness matrices $\\mathbf{K}_{e}(\\rho_{e}) = E(\\rho_{e})\\,\\mathbf{K}_{e}^{0}$, where $\\mathbf{K}_{e}^{0}$ is the element stiffness template computed for unit modulus.\n\nConsider $m$ independent static load cases indexed by $i \\in \\{1,\\dots,m\\}$ with load vectors $\\mathbf{f}_{i}$ that do not depend on $\\boldsymbol{\\rho}$. For each load case, the state vector $\\mathbf{u}_{i}(\\boldsymbol{\\rho})$ satisfies the equilibrium equations $\\mathbf{K}(\\boldsymbol{\\rho})\\,\\mathbf{u}_{i}(\\boldsymbol{\\rho}) = \\mathbf{f}_{i}$. The multi-load weighted compliance objective is\n$$\nC(\\boldsymbol{\\rho}) = \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{f}_{i}^{\\mathsf{T}}\\,\\mathbf{u}_{i}(\\boldsymbol{\\rho}),\n$$\nwhere $\\omega_{i} > 0$ are given weights. In embedded level-set approaches that use density sensitivities to define the Hamilton–Jacobi normal velocity field, the quantity $\\partial C/\\partial \\rho_{e}$ serves as a driving signal.\n\nStarting only from the definitions above, the symmetry of $\\mathbf{K}(\\boldsymbol{\\rho})$, and the fact that $\\mathbf{f}_{i}$ are independent of $\\boldsymbol{\\rho}$, derive a closed-form expression for the exact sensitivity $\\partial C/\\partial \\rho_{e}$ in terms of the local element displacement vectors $\\mathbf{u}_{e,i}$ (the restriction of $\\mathbf{u}_{i}$ to the degrees of freedom of element $e$), the weights $\\omega_{i}$, and the SIMP parameters. Express your final answer using $\\mathbf{K}_{e}^{0}$, $p$, $E_{0}$, $E_{\\min}$, $\\rho_{e}$, and $\\mathbf{u}_{e,i}$, without introducing any additional approximations or filters.\n\nYour final answer must be a single closed-form analytic expression. No numerical approximation is required, and no units should be included in the final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It represents a standard derivation in the field of continuum structural topology optimization. Therefore, a solution will be provided.\n\nThe objective is to derive the sensitivity $\\frac{\\partial C}{\\partial \\rho_{e}}$ of the multi-load weighted compliance function $C(\\boldsymbol{\\rho})$ with respect to the design variable $\\rho_{e}$ of element $e$.\n\nThe weighted compliance is given by\n$$\nC(\\boldsymbol{\\rho}) = \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{f}_{i}^{\\mathsf{T}}\\,\\mathbf{u}_{i}(\\boldsymbol{\\rho})\n$$\nwhere $\\omega_{i} > 0$ are weights, $\\mathbf{f}_{i}$ are the load vectors, and $\\mathbf{u}_{i}(\\boldsymbol{\\rho})$ are the displacement vectors for each load case $i \\in \\{1,\\dots,m\\}$.\n\nThe sensitivity of $C(\\boldsymbol{\\rho})$ with respect to a single design variable $\\rho_{e}$ is found by direct differentiation. Applying the chain rule, and noting that the load vectors $\\mathbf{f}_{i}$ and weights $\\omega_{i}$ are independent of the design variables $\\boldsymbol{\\rho}$, we have:\n$$\n\\frac{\\partial C}{\\partial \\rho_{e}} = \\frac{\\partial}{\\partial \\rho_{e}} \\left( \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{f}_{i}^{\\mathsf{T}}\\,\\mathbf{u}_{i} \\right) = \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{f}_{i}^{\\mathsf{T}}\\,\\frac{\\partial \\mathbf{u}_{i}}{\\partial \\rho_{e}}\n$$\nThis expression contains the term $\\frac{\\partial \\mathbf{u}_{i}}{\\partial \\rho_{e}}$, which is the sensitivity of the state vector. To find this term, we utilize the governing static equilibrium equation for each load case $i$:\n$$\n\\mathbf{K}(\\boldsymbol{\\rho})\\,\\mathbf{u}_{i}(\\boldsymbol{\\rho}) = \\mathbf{f}_{i}\n$$\nWe differentiate this equation with respect to $\\rho_{e}$, applying the product rule for differentiation on the left-hand side. Since $\\mathbf{f}_{i}$ does not depend on $\\boldsymbol{\\rho}$, its derivative is zero.\n$$\n\\frac{\\partial}{\\partial \\rho_{e}} \\left( \\mathbf{K}\\,\\mathbf{u}_{i} \\right) = \\frac{\\partial \\mathbf{f}_{i}}{\\partial \\rho_{e}}\n$$\n$$\n\\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}}\\,\\mathbf{u}_{i} + \\mathbf{K}\\,\\frac{\\partial \\mathbf{u}_{i}}{\\partial \\rho_{e}} = \\mathbf{0}\n$$\nThis is a standard result in sensitivity analysis for linear systems.\n\nThis equation could be solved for $\\frac{\\partial \\mathbf{u}_{i}}{\\partial \\rho_{e}} = -\\mathbf{K}^{-1} \\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}} \\mathbf{u}_{i}$ and substituted back into the expression for $\\frac{\\partial C}{\\partial \\rho_{e}}$. However, a more direct route, known as the adjoint method, is to use the original state equation to rewrite $\\mathbf{f}_{i}^{\\mathsf{T}}$.\nFrom the state equation, $\\mathbf{f}_{i} = \\mathbf{K}\\mathbf{u}_{i}$. Taking the transpose gives $\\mathbf{f}_{i}^{\\mathsf{T}} = (\\mathbf{K}\\mathbf{u}_{i})^{\\mathsf{T}} = \\mathbf{u}_{i}^{\\mathsf{T}}\\mathbf{K}^{\\mathsf{T}}$. The problem states that the global stiffness matrix $\\mathbf{K}$ is symmetric, so $\\mathbf{K}^{\\mathsf{T}} = \\mathbf{K}$. Thus, we have $\\mathbf{f}_{i}^{\\mathsf{T}} = \\mathbf{u}_{i}^{\\mathsf{T}}\\mathbf{K}$.\n\nSubstituting this expression for $\\mathbf{f}_{i}^{\\mathsf{T}}$ into the sensitivity equation for $C$:\n$$\n\\frac{\\partial C}{\\partial \\rho_{e}} = \\sum_{i=1}^{m} \\omega_{i}\\,\\left(\\mathbf{u}_{i}^{\\mathsf{T}}\\mathbf{K}\\right)\\,\\frac{\\partial \\mathbf{u}_{i}}{\\partial \\rho_{e}} = \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{u}_{i}^{\\mathsf{T}} \\left( \\mathbf{K}\\,\\frac{\\partial \\mathbf{u}_{i}}{\\partial \\rho_{e}} \\right)\n$$\nFrom the differentiated state equation, we can substitute the term in the parenthesis: $\\mathbf{K}\\,\\frac{\\partial \\mathbf{u}_{i}}{\\partial \\rho_{e}} = -\\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}}\\,\\mathbf{u}_{i}$.\nThis yields:\n$$\n\\frac{\\partial C}{\\partial \\rho_{e}} = \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{u}_{i}^{\\mathsf{T}} \\left( -\\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}}\\,\\mathbf{u}_{i} \\right) = - \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{u}_{i}^{\\mathsf{T}}\\,\\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}}\\,\\mathbf{u}_{i}\n$$\nThis is the general form of the compliance sensitivity. The problem is self-adjoint, as the adjoint field is identical to the primal field $\\mathbf{u}_{i}$.\n\nNext, we evaluate the derivative of the global stiffness matrix, $\\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}}$. The global matrix $\\mathbf{K}$ is assembled from element stiffness matrices $\\mathbf{K}_{j}(\\rho_{j})$. The matrix $\\mathbf{K}$ depends on a specific design variable $\\rho_{e}$ only through the element stiffness matrix $\\mathbf{K}_{e}(\\rho_{e})$ of that element. Therefore, the derivative of the assembly sum with respect to $\\rho_{e}$ isolates the term for element $e$. The quadratic form $\\mathbf{u}_{i}^{\\mathsf{T}}\\,\\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}}\\,\\mathbf{u}_{i}$ can be expressed using only the local quantities for element $e$:\n$$\n\\mathbf{u}_{i}^{\\mathsf{T}}\\,\\frac{\\partial \\mathbf{K}}{\\partial \\rho_{e}}\\,\\mathbf{u}_{i} = \\mathbf{u}_{e,i}^{\\mathsf{T}}\\,\\frac{d \\mathbf{K}_{e}}{d \\rho_{e}}\\,\\mathbf{u}_{e,i}\n$$\nwhere $\\mathbf{u}_{e,i}$ is the element displacement vector containing the degrees of freedom of element $e$ from the global displacement vector $\\mathbf{u}_{i}$.\n\nSubstituting this into the sensitivity expression gives:\n$$\n\\frac{\\partial C}{\\partial \\rho_{e}} = - \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{u}_{e,i}^{\\mathsf{T}}\\,\\frac{d \\mathbf{K}_{e}}{d \\rho_{e}}\\,\\mathbf{u}_{e,i}\n$$\nNow, we must find the derivative of the element stiffness matrix, $\\frac{d \\mathbf{K}_{e}}{d \\rho_{e}}$.\nGiven $\\mathbf{K}_{e}(\\rho_{e}) = E(\\rho_{e})\\,\\mathbf{K}_{e}^{0}$, where $\\mathbf{K}_{e}^{0}$ is the constant element stiffness template, the derivative is:\n$$\n\\frac{d \\mathbf{K}_{e}}{d \\rho_{e}} = \\frac{dE(\\rho_{e})}{d\\rho_{e}}\\,\\mathbf{K}_{e}^{0}\n$$\nThe SIMP interpolation rule is $E(\\rho_{e}) = E_{\\min} + \\rho_{e}^{p}\\left(E_{0} - E_{\\min}\\right)$. Differentiating with respect to $\\rho_{e}$:\n$$\n\\frac{dE(\\rho_{e})}{d\\rho_{e}} = \\frac{d}{d\\rho_{e}} \\left( E_{\\min} + \\rho_{e}^{p}\\left(E_{0} - E_{\\min}\\right) \\right) = p\\,\\rho_{e}^{p-1}\\left(E_{0} - E_{\\min}\\right)\n$$\nSubstituting this back into the expression for $\\frac{d \\mathbf{K}_{e}}{d \\rho_{e}}$ yields:\n$$\n\\frac{d \\mathbf{K}_{e}}{d \\rho_{e}} = p\\,\\rho_{e}^{p-1}\\left(E_{0} - E_{\\min}\\right)\\,\\mathbf{K}_{e}^{0}\n$$\nFinally, we substitute this result into the equation for $\\frac{\\partial C}{\\partial \\rho_{e}}$:\n$$\n\\frac{\\partial C}{\\partial \\rho_{e}} = - \\sum_{i=1}^{m} \\omega_{i}\\,\\mathbf{u}_{e,i}^{\\mathsf{T}}\\,\\left( p\\,\\rho_{e}^{p-1}\\left(E_{0} - E_{\\min}\\right)\\,\\mathbf{K}_{e}^{0} \\right)\\,\\mathbf{u}_{e,i}\n$$\nThe scalar terms can be moved outside the quadratic form and the summation:\n$$\n\\frac{\\partial C}{\\partial \\rho_{e}} = -p\\,\\left(E_{0} - E_{\\min}\\right)\\,\\rho_{e}^{p-1} \\sum_{i=1}^{m} \\omega_{i}\\,\\left( \\mathbf{u}_{e,i}^{\\mathsf{T}}\\,\\mathbf{K}_{e}^{0}\\,\\mathbf{u}_{e,i} \\right)\n$$\nThis is the final closed-form expression for the sensitivity, expressed in terms of the quantities specified in the problem statement. The term $\\mathbf{u}_{e,i}^{\\mathsf{T}}\\,\\mathbf{K}_{e}^{0}\\,\\mathbf{u}_{e,i}$ represents the strain energy of element $e$ for load case $i$, calculated with a unit elastic modulus.", "answer": "$$\n\\boxed{-p \\left(E_{0} - E_{\\min}\\right) \\rho_{e}^{p-1} \\sum_{i=1}^{m} \\omega_{i} \\left( \\mathbf{u}_{e,i}^{\\mathsf{T}} \\mathbf{K}_{e}^{0} \\mathbf{u}_{e,i} \\right)}\n$$", "id": "2606569"}]}