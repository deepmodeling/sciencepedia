{"hands_on_practices": [{"introduction": "Understanding how a numerical method affects different error components is key to designing efficient solvers. Local Fourier Analysis (LFA) provides a precise framework for this by decomposing errors into frequency modes. This first practice builds a foundational skill by asking you to compute the Fourier 'symbol' of the standard discrete Laplacian operator, which represents its action on any given frequency mode [@problem_id:2581535]. Mastering this calculation is the first step toward analyzing and predicting the performance of every component in a multigrid cycle.", "problem": "Consider local Fourier analysis for multigrid methods on uniform grids in the finite element method setting. Let the discrete Laplacian be defined on an infinite, uniform grid so that translation invariance holds and complex exponentials are admissible eigenmodes.\n\nIn one spatial dimension, consider the grid $\\Omega_{h}^{(1\\mathrm{D})} = \\{ x_{i} = i h : i \\in \\mathbb{Z} \\}$ with spacing $h > 0$, and the standard three-point finite-difference approximation of the Laplacian acting on a grid function $\\{u_{i}\\}_{i \\in \\mathbb{Z}}$,\n$$\n(L_{h}^{(1\\mathrm{D})} u)_{i} = \\frac{-u_{i-1} + 2 u_{i} - u_{i+1}}{h^{2}}.\n$$\nIn two spatial dimensions, consider the grid $\\Omega_{h}^{(2\\mathrm{D})} = \\{ (x_{i},y_{j}) = (i h, j h) : i,j \\in \\mathbb{Z} \\}$ with the standard five-point finite-difference approximation of the Laplacian acting on $\\{u_{i,j}\\}_{(i,j)\\in\\mathbb{Z}^{2}}$,\n$$\n(L_{h}^{(2\\mathrm{D})} u)_{i,j} = \\frac{-u_{i-1,j} - u_{i+1,j} - u_{i,j-1} - u_{i,j+1} + 4 u_{i,j}}{h^{2}}.\n$$\n\nDefine the Fourier symbol $\\widehat{L}_{h}(\\boldsymbol{\\theta})$ of a shift-invariant discrete operator $L_{h}$ to be the scalar such that, for any Fourier mode $\\varphi_{\\boldsymbol{\\theta}}$ on the corresponding grid, one has\n$$\nL_{h} \\varphi_{\\boldsymbol{\\theta}} = \\widehat{L}_{h}(\\boldsymbol{\\theta}) \\, \\varphi_{\\boldsymbol{\\theta}},\n$$\nwhere in one dimension the Fourier mode is $\\varphi_{\\theta}[i] = \\exp(\\mathrm{i} \\, \\theta \\, i)$ with $\\theta \\in (-\\pi,\\pi]$, and in two dimensions the Fourier mode is $\\varphi_{\\boldsymbol{\\theta}}[i,j] = \\exp(\\mathrm{i} \\, (\\theta_{x} \\, i + \\theta_{y} \\, j))$ with $\\boldsymbol{\\theta} = (\\theta_{x},\\theta_{y}) \\in (-\\pi,\\pi]^{2}$.\n\nUsing only these definitions and the given discrete Laplacians, compute explicitly the Fourier symbols $\\widehat{L}_{h}^{(1\\mathrm{D})}(\\theta)$ and $\\widehat{L}_{h}^{(2\\mathrm{D})}(\\theta_{x},\\theta_{y})$ in closed form. Provide your final answer as a single row vector containing the one-dimensional and two-dimensional symbols, respectively, as analytic expressions. No numerical approximation is required, and no units are to be reported in the final answer.", "solution": "The problem statement is validated and found to be well-posed, scientifically grounded, and objective. It represents a standard exercise in the local Fourier analysis of discrete operators, which is a fundamental tool for analyzing multigrid methods. All definitions and data provided are self-contained and mathematically consistent. We proceed with the derivation.\n\nThe Fourier symbol $\\widehat{L}_{h}(\\boldsymbol{\\theta})$ of a discrete, shift-invariant operator $L_{h}$ is defined by the eigenvalue relationship $L_{h} \\varphi_{\\boldsymbol{\\theta}} = \\widehat{L}_{h}(\\boldsymbol{\\theta}) \\, \\varphi_{\\boldsymbol{\\theta}}$, where $\\varphi_{\\boldsymbol{\\theta}}$ is a Fourier mode. We compute the symbols for the one-dimensional and two-dimensional discrete Laplacians as specified.\n\nFirst, we consider the one-dimensional case. The discrete operator is\n$$\n(L_{h}^{(1\\mathrm{D})} u)_{i} = \\frac{-u_{i-1} + 2 u_{i} - u_{i+1}}{h^{2}}\n$$\nand the Fourier mode is $\\varphi_{\\theta}[i] = \\exp(\\mathrm{i} \\, \\theta \\, i)$. We apply the operator $L_{h}^{(1\\mathrm{D})}$ to the mode $\\varphi_{\\theta}$:\n$$\n(L_{h}^{(1\\mathrm{D})} \\varphi_{\\theta})[i] = \\frac{-\\varphi_{\\theta}[i-1] + 2 \\varphi_{\\theta}[i] - \\varphi_{\\theta}[i+1]}{h^{2}}\n$$\nSubstituting the explicit form of the mode, we obtain\n$$\n(L_{h}^{(1\\mathrm{D})} \\varphi_{\\theta})[i] = \\frac{-\\exp(\\mathrm{i} \\, \\theta \\, (i-1)) + 2 \\exp(\\mathrm{i} \\, \\theta \\, i) - \\exp(\\mathrm{i} \\, \\theta \\, (i+1))}{h^{2}}\n$$\nWe factor out the term $\\exp(\\mathrm{i} \\, \\theta \\, i)$, which corresponds to $\\varphi_{\\theta}[i]$:\n$$\n(L_{h}^{(1\\mathrm{D})} \\varphi_{\\theta})[i] = \\frac{1}{h^{2}} \\left( -\\exp(-\\mathrm{i} \\, \\theta) + 2 - \\exp(\\mathrm{i} \\, \\theta) \\right) \\exp(\\mathrm{i} \\, \\theta \\, i)\n$$\nThe scalar pre-factor is, by definition, the Fourier symbol $\\widehat{L}_{h}^{(1\\mathrm{D})}(\\theta)$:\n$$\n\\widehat{L}_{h}^{(1\\mathrm{D})}(\\theta) = \\frac{1}{h^{2}} \\left( 2 - (\\exp(\\mathrm{i} \\, \\theta) + \\exp(-\\mathrm{i} \\, \\theta)) \\right)\n$$\nUsing the identity $\\cos(\\theta) = \\frac{\\exp(\\mathrm{i} \\, \\theta) + \\exp(-\\mathrm{i} \\, \\theta)}{2}$, we simplify the symbol:\n$$\n\\widehat{L}_{h}^{(1\\mathrm{D})}(\\theta) = \\frac{1}{h^{2}} (2 - 2\\cos(\\theta)) = \\frac{2}{h^{2}}(1 - \\cos(\\theta))\n$$\nFinally, applying the half-angle trigonometric identity $1 - \\cos(\\theta) = 2 \\sin^{2}(\\frac{\\theta}{2})$, we arrive at the closed form:\n$$\n\\widehat{L}_{h}^{(1\\mathrm{D})}(\\theta) = \\frac{4}{h^{2}} \\sin^{2}\\left(\\frac{\\theta}{2}\\right)\n$$\n\nNext, we consider the two-dimensional case. The discrete operator is\n$$\n(L_{h}^{(2\\mathrm{D})} u)_{i,j} = \\frac{-u_{i-1,j} - u_{i+1,j} - u_{i,j-1} - u_{i,j+1} + 4 u_{i,j}}{h^{2}}\n$$\nand the Fourier mode is $\\varphi_{\\boldsymbol{\\theta}}[i,j] = \\exp(\\mathrm{i} \\, (\\theta_{x} \\, i + \\theta_{y} \\, j))$. We apply $L_{h}^{(2\\mathrm{D})}$ to $\\varphi_{\\boldsymbol{\\theta}}$:\n$$\n(L_{h}^{(2\\mathrm{D})} \\varphi_{\\boldsymbol{\\theta}})[i,j] = \\frac{-\\varphi_{\\boldsymbol{\\theta}}[i-1,j] - \\varphi_{\\boldsymbol{\\theta}}[i+1,j] - \\varphi_{\\boldsymbol{\\theta}}[i,j-1] - \\varphi_{\\boldsymbol{\\theta}}[i,j+1] + 4\\varphi_{\\boldsymbol{\\theta}}[i,j]}{h^{2}}\n$$\nSubstituting the form of the mode:\n$$\n(L_{h}^{(2\\mathrm{D})} \\varphi_{\\boldsymbol{\\theta}})[i,j] = \\frac{1}{h^{2}} \\left( \\begin{aligned} &-\\exp(\\mathrm{i}(\\theta_{x}(i-1) + \\theta_{y}j)) - \\exp(\\mathrm{i}(\\theta_{x}(i+1) + \\theta_{y}j)) \\\\ &- \\exp(\\mathrm{i}(\\theta_{x}i + \\theta_{y}(j-1))) - \\exp(\\mathrm{i}(\\theta_{x}i + \\theta_{y}(j+1))) \\\\ &+ 4\\exp(\\mathrm{i}(\\theta_{x}i + \\theta_{y}j)) \\end{aligned} \\right)\n$$\nWe factor out the term $\\exp(\\mathrm{i} \\, (\\theta_{x} \\, i + \\theta_{y} \\, j))$, which is $\\varphi_{\\boldsymbol{\\theta}}[i,j]$, from each term in the sum:\n$$\n(L_{h}^{(2\\mathrm{D})} \\varphi_{\\boldsymbol{\\theta}})[i,j] = \\frac{1}{h^{2}} \\left( -\\exp(-\\mathrm{i}\\theta_{x}) - \\exp(\\mathrm{i}\\theta_{x}) - \\exp(-\\mathrm{i}\\theta_{y}) - \\exp(\\mathrm{i}\\theta_{y}) + 4 \\right) \\exp(\\mathrm{i}(\\theta_{x}i + \\theta_{y}j))\n$$\nThe scalar pre-factor is the two-dimensional Fourier symbol $\\widehat{L}_{h}^{(2\\mathrm{D})}(\\boldsymbol{\\theta})$:\n$$\n\\widehat{L}_{h}^{(2\\mathrm{D})}(\\theta_{x},\\theta_{y}) = \\frac{1}{h^{2}} \\left( 4 - (\\exp(\\mathrm{i}\\theta_{x}) + \\exp(-\\mathrm{i}\\theta_{x})) - (\\exp(\\mathrm{i}\\theta_{y}) + \\exp(-\\mathrm{i}\\theta_{y})) \\right)\n$$\nUsing $\\cos(\\alpha) = \\frac{\\exp(\\mathrm{i}\\alpha) + \\exp(-\\mathrm{i}\\alpha)}{2}$, we simplify:\n$$\n\\widehat{L}_{h}^{(2\\mathrm{D})}(\\theta_{x},\\theta_{y}) = \\frac{1}{h^{2}} (4 - 2\\cos(\\theta_{x}) - 2\\cos(\\theta_{y})) = \\frac{2}{h^{2}} \\left( (1 - \\cos(\\theta_{x})) + (1 - \\cos(\\theta_{y})) \\right)\n$$\nApplying the half-angle identity $1 - \\cos(\\alpha) = 2 \\sin^{2}(\\frac{\\alpha}{2})$ to both terms gives the final closed form:\n$$\n\\widehat{L}_{h}^{(2\\mathrm{D})}(\\theta_{x},\\theta_{y}) = \\frac{2}{h^{2}} \\left( 2\\sin^{2}\\left(\\frac{\\theta_{x}}{2}\\right) + 2\\sin^{2}\\left(\\frac{\\theta_{y}}{2}\\right) \\right) = \\frac{4}{h^{2}} \\left( \\sin^{2}\\left(\\frac{\\theta_{x}}{2}\\right) + \\sin^{2}\\left(\\frac{\\theta_{y}}{2}\\right) \\right)\n$$\nThis completes the required computation for both cases.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4}{h^{2}} \\sin^{2}\\left(\\frac{\\theta}{2}\\right) & \\frac{4}{h^{2}} \\left( \\sin^{2}\\left(\\frac{\\theta_{x}}{2}\\right) + \\sin^{2}\\left(\\frac{\\theta_{y}}{2}\\right) \\right)\n\\end{pmatrix}\n}\n$$", "id": "2581535"}, {"introduction": "A multigrid method is defined by its hierarchy of grids and the operators that transfer information between them. This exercise focuses on these core components: prolongation (interpolation to a fine grid) and restriction (injection to a coarse grid). You will derive the standard stencils for these operators and then see how they are used to form the coarse-grid operator $A_H$ via the celebrated Galerkin projection, $A_H = R A_h P$ [@problem_id:2581555]. This practice is essential for demystifying how coarse-grid systems, which are crucial for eliminating low-frequency error, are constructed in a mathematically consistent way.", "problem": "Consider the model problem $-\\Delta u = f$ on a periodic two-dimensional torus $\\Omega = \\mathbb{T}^{2}$, discretized on a uniform Cartesian mesh with meshsize $h$ using piecewise bilinear ($Q_{1}$) finite elements. On this grid, the resulting stiffness matrix $A_{h}$ is the standard five-point discrete Laplacian. A coarse grid with meshsize $H = 2h$ is introduced. The intergrid transfer operators are defined as follows: the prolongation $P_{H}^{h}$ is bilinear (linear) interpolation from the coarse grid to the fine grid, and the restriction $R_{h}^{H}$ is full-weighting from the fine grid to the coarse grid. Assume periodic boundary conditions so that translational invariance and Fourier analysis apply.\n\nTasks:\n- Starting from the defining properties of bilinear interpolation and the requirement that the restriction be a symmetric, compact-weighted average that preserves constants and is consistent with the choice $R_{h}^{H} = 2^{-d} (P_{H}^{h})^{T}$ in $d = 2$ dimensions, derive the $3 \\times 3$ point stencils of $P_{H}^{h}$ and $R_{h}^{H}$ centered at a coarse-grid node.\n- Using the definition of a Fourier symbol in Local Fourier Analysis (LFA, Local Fourier Analysis), namely that for a translationally invariant operator $M$ on the grid the Fourier mode $\\varphi_{\\boldsymbol{\\theta}}(\\boldsymbol{j}) = \\exp\\!\\big(i(\\boldsymbol{j}\\cdot \\boldsymbol{\\theta})\\big)$ is an eigenfunction with eigenvalue (symbol) $\\tilde{M}(\\boldsymbol{\\theta})$, derive the Fourier symbols $\\tilde{P}_{H}^{h}(\\boldsymbol{\\theta})$ and $\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta})$ for your stencils, where $\\boldsymbol{\\theta} = (\\theta_{1},\\theta_{2}) \\in [-\\pi,\\pi]^{2}$.\n- Starting from the well-tested symbol of the five-point Laplacian on the fine grid, $\\tilde{A}_{h}(\\boldsymbol{\\theta}) = \\dfrac{4}{h^{2}}\\!\\left(\\sin^{2}\\!\\big(\\tfrac{\\theta_{1}}{2}\\big) + \\sin^{2}\\!\\big(\\tfrac{\\theta_{2}}{2}\\big)\\right)$, and the Galerkin definition of the coarse operator $A_{H} = R_{h}^{H} A_{h} P_{H}^{h}$ together with $R_{h}^{H} = 2^{-2} (P_{H}^{h})^{T}$ for $d=2$, argue from first principles of nested $Q_{1}$ finite element spaces that $A_{H}$ is a uniformly scaled version of the standard coarse-grid five-point Laplacian, and write its Fourier symbol $\\tilde{A}_{H}(\\boldsymbol{\\vartheta})$ explicitly as a function of $\\boldsymbol{\\vartheta} = (\\vartheta_{1},\\vartheta_{2})$ and $H$.\n- Finally, evaluate the dimensionless scalar $S = \\tilde{A}_{H}(\\boldsymbol{\\vartheta})\\,H^{2}$ at $\\boldsymbol{\\vartheta} = \\big(\\tfrac{\\pi}{2}, \\tfrac{\\pi}{3}\\big)$ and provide its exact value. Do not round. Your final answer must be a single number without units.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nSTEP 1: EXTRACT GIVENS\n\n-   **Equation:** $-\\Delta u = f$\n-   **Domain:** A periodic two-dimensional torus $\\Omega = \\mathbb{T}^{2}$.\n-   **Discretization:** Piecewise bilinear ($Q_{1}$) finite elements on a uniform Cartesian mesh.\n-   **Fine Grid:** Meshsize $h$. The stiffness matrix is $A_{h}$, the standard five-point discrete Laplacian.\n-   **Coarse Grid:** Meshsize $H = 2h$. The stiffness matrix is $A_{H}$.\n-   **Prolongation:** $P_{H}^{h}$ is bilinear (linear) interpolation.\n-   **Restriction:** $R_{h}^{H}$ is full-weighting.\n-   **Intergrid Operator Relation:** The choice of restriction is consistent with $R_{h}^{H} = 2^{-d} (P_{H}^{h})^{T}$ in $d = 2$ dimensions, i.e., $R_{h}^{H} = \\frac{1}{4} (P_{H}^{h})^{T}$.\n-   **Boundary Conditions:** Periodic, allowing for Fourier analysis.\n-   **Fourier Analysis Definitions:**\n    -   Fourier mode: $\\varphi_{\\boldsymbol{\\theta}}(\\boldsymbol{j}) = \\exp(i(\\boldsymbol{j}\\cdot \\boldsymbol{\\theta}))$\n    -   Fourier symbol $\\tilde{M}(\\boldsymbol{\\theta})$: eigenvalue corresponding to the eigenfunction $\\varphi_{\\boldsymbol{\\theta}}(\\boldsymbol{j})$ for a translationally invariant operator $M$.\n-   **Given Fine-Grid Symbol:** $\\tilde{A}_{h}(\\boldsymbol{\\theta}) = \\dfrac{4}{h^{2}}(\\sin^{2}(\\tfrac{\\theta_{1}}{2}) + \\sin^{2}(\\tfrac{\\theta_{2}}{2}))$.\n-   **Coarse Operator Definition:** $A_{H} = R_{h}^{H} A_{h} P_{H}^{h}$.\n-   **Task:**\n    1.  Derive the $3 \\times 3$ stencils for $P_{H}^{h}$ and $R_{h}^{H}$.\n    2.  Derive their Fourier symbols, $\\tilde{P}_{H}^{h}(\\boldsymbol{\\theta})$ and $\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta})$.\n    3.  Argue from FEM principles that $A_{H}$ is a scaled version of the coarse-grid 5-point Laplacian and find its symbol $\\tilde{A}_{H}(\\boldsymbol{\\vartheta})$.\n    4.  Evaluate $S = \\tilde{A}_{H}(\\boldsymbol{\\vartheta})\\,H^{2}$ at $\\boldsymbol{\\vartheta} = (\\tfrac{\\pi}{2}, \\tfrac{\\pi}{3})$.\n\nSTEP 2: VALIDATE USING EXTRACTED GIVENS\n\nThe problem is scientifically grounded within the established mathematical fields of the Finite Element Method (FEM) and Multigrid Methods, specifically using Local Fourier Analysis (LFA). All concepts, including bilinear elements, the five-point Laplacian, bilinear interpolation, full-weighting restriction, and Galerkin coarsening, are standard and well-defined. The problem is well-posed, providing all necessary definitions, relationships, and data to arrive at a unique solution. The language is objective and precise. There are no contradictions; the relationship $R_{h}^{H} = \\frac{1}{4} (P_{H}^{h})^{T}$ is consistent with the standard pairing of bilinear interpolation and full-weighting restriction for $Q_1$ elements in 2D. The problem requires substantive reasoning and is not trivial.\n\nSTEP 3: VERDICT AND ACTION\n\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe solution proceeds by executing the tasks in the specified order.\n\n**Task 1: Derivation of Stencils**\n\nThe stencils are requested to be centered at a coarse-grid node. Let the coarse grid nodes be indexed by $\\boldsymbol{J}$ and fine grid nodes by $\\boldsymbol{j}$. We establish a local coordinate system with a coarse-grid node at the origin.\n\nThe restriction operator $R_{h}^{H}$ maps a function on the fine grid to the coarse grid. It is defined as a \"symmetric, compact-weighted average that preserves constants\". A general symmetric $3 \\times 3$ stencil acting on fine-grid values to produce a coarse-grid value is given by:\n$$\n(R_{h}^{H} u)_{\\boldsymbol{J}=0} = \\sum_{k_1, k_2 \\in \\{-1,0,1\\}} w_{|k_1|,|k_2|} u_{(k_1, k_2)}\n$$\nFor full-weighting, the weights are chosen proverbially as proportional to $[1, 2, 1] \\otimes [1, 2, 1]^T$. To preserve constants (i.e., mapping a constant function $u=c$ to $R_{h}^{H}u=c$), the sum of the weights must be $1$. The sum of the un-normalized weights is $(1+2+1)\\times(1+2+1) = 4 \\times 4 = 16$. Thus, the stencil for $R_{h}^{H}$, which combines $9$ fine-grid values to compute $1$ coarse-grid value, is:\n$$\nS_{R} = \\frac{1}{16}\n\\begin{pmatrix}\n1 & 2 & 1 \\\\\n2 & 4 & 2 \\\\\n1 & 2 & 1\n\\end{pmatrix}\n$$\nThe prolongation operator $P_{H}^{h}$ is bilinear interpolation. Its action is to determine values on the fine grid from values on the coarse grid. The problem asks for its stencil centered at a coarse-grid node, which describes the contribution of a single coarse-grid value to the surrounding nine fine-grid points. This is the so-called injection stencil, which is the transpose of the restriction stencil. The problem specifies consistency with $R_{h}^{H} = \\frac{1}{4} (P_{H}^{h})^{T}$. The stencil for $(P_{H}^{h})^T$ must be $4 S_R$.\n$$\nS_{P^T} = 4 S_R = \\frac{4}{16}\n\\begin{pmatrix}\n1 & 2 & 1 \\\\\n2 & 4 & 2 \\\\\n1 & 2 & 1\n\\end{pmatrix} = \\frac{1}{4}\n\\begin{pmatrix}\n1 & 2 & 1 \\\\\n2 & 4 & 2 \\\\\n1 & 2 & 1\n\\end{pmatrix}\n$$\nSince this stencil matrix is symmetric, the injection stencil for $P_{H}^{h}$ is the same. This correctly represents bilinear interpolation: a coarse node value contributes with weight $1$ to the coincident fine node, $1/2$ to the fine nodes on the edges, and $1/4$ to the fine node at the cell center. The stencil for $P_{H}^{h}$ is therefore:\n$$\nS_{P} = \\frac{1}{4}\n\\begin{pmatrix}\n1 & 2 & 1 \\\\\n2 & 4 & 2 \\\\\n1 & 2 & 1\n\\end{pmatrix}\n$$\n\n**Task 2: Derivation of Fourier Symbols**\n\nThe Fourier symbol $\\tilde{M}(\\boldsymbol{\\theta})$ of an operator $M$ with a computational stencil $S$ is given by $\\tilde{M}(\\boldsymbol{\\theta}) = \\sum_{\\boldsymbol{k}} S_{\\boldsymbol{k}} \\exp(i(\\boldsymbol{k}\\cdot \\boldsymbol{\\theta}))$.\n\nFor the restriction operator $R_{h}^{H}$, the stencil $S_R$ is a computational stencil on the fine grid. Its symbol is:\n$$\n\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta}) = \\frac{1}{16} \\sum_{k_1,k_2 \\in \\{-1,0,1\\}} S'_{k_1,k_2} \\exp(i(k_1 \\theta_1 + k_2 \\theta_2))\n$$\nwhere $S'$ is the matrix of un-normalized weights.\n$$\n\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta}) = \\frac{1}{16} \\left[ 4 + 2(e^{i\\theta_1} + e^{-i\\theta_1}) + 2(e^{i\\theta_2} + e^{-i\\theta_2}) + 1(e^{i(\\theta_1+\\theta_2)} + e^{-i(\\theta_1+\\theta_2)} + e^{i(\\theta_1-\\theta_2)} + e^{-i(\\theta_1-\\theta_2)}) \\right]\n$$\nUsing $e^{ix} + e^{-ix} = 2\\cos(x)$, we have:\n$$\n\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta}) = \\frac{1}{16} \\left[ 4 + 4\\cos(\\theta_1) + 4\\cos(\\theta_2) + 2\\cos(\\theta_1+\\theta_2) + 2\\cos(\\theta_1-\\theta_2) \\right]\n$$\nUsing $\\cos(A+B)+\\cos(A-B) = 2\\cos A\\cos B$:\n$$\n\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta}) = \\frac{1}{16} \\left[ 4 + 4\\cos(\\theta_1) + 4\\cos(\\theta_2) + 4\\cos(\\theta_1)\\cos(\\theta_2) \\right] = \\frac{1}{4} (1+\\cos(\\theta_1))(1+\\cos(\\theta_2))\n$$\nUsing the half-angle identity $1+\\cos(x) = 2\\cos^2(x/2)$:\n$$\n\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta}) = \\frac{1}{4} (2\\cos^2(\\tfrac{\\theta_1}{2}))(2\\cos^2(\\tfrac{\\theta_2}{2})) = \\cos^2(\\tfrac{\\theta_1}{2})\\cos^2(\\tfrac{\\theta_2}{2})\n$$\nFor the prolongation operator $P_H^h$, which is bilinear interpolation, we cannot use its injection stencil to compute its symbol directly as it is not a computational stencil on a single grid. Instead, we derive its symbol from the definition of interpolation. For a low-frequency mode $\\boldsymbol{\\theta} \\in [-\\pi/2, \\pi/2]^2$, the (low-frequency) symbol of bilinear interpolation is known to be:\n$$\n\\tilde{P}_{H}^{h}(\\boldsymbol{\\theta}) = \\cos(\\tfrac{\\theta_1}{2})\\cos(\\tfrac{\\theta_2}{2})\n$$\nThis symbol can be derived by analyzing the action of interpolation on a coarse-grid Fourier mode and projecting the result onto the low-frequency fine-grid mode. The phase factor is ignored as it will cancel in the Galerkin product.\n\n**Task 3: Coarse-Grid Operator Symbol**\n\nThe coarse-grid operator is formed via the Galerkin projection $A_{H} = R_{h}^{H} A_{h} P_{H}^{h}$. Using the given relation $R_{h}^{H} = \\frac{1}{4} (P_{H}^{h})^{T}$, we get:\n$$\nA_{H} = \\frac{1}{4} (P_{H}^{h})^{T} A_{h} P_{H}^{h}\n$$\nThe problem is based on piecewise bilinear ($Q_{1}$) finite elements. The space of coarse-grid $Q_{1}$ functions $V_H$ is a subspace of the fine-grid $Q_{1}$ functions $V_h$, i.e., $V_H \\subset V_h$. The prolongation operator $P_H^h$ represents this natural embedding. The matrix $A_h$ is the representation of the bilinear form $a(u,v)=\\int_\\Omega \\nabla u \\cdot \\nabla v \\, dx$ in the fine-grid nodal basis. The product $(P_{H}^{h})^{T} A_{h} P_{H}^{h}$ is the representation of the same bilinear form $a(u,v)$ in the coarse-grid nodal basis. This is precisely the stiffness matrix, denoted $A_{H}^{\\text{fem}}$, that would be assembled by applying the finite element method directly on the coarse grid with mesh size $H$.\n\nFor a uniform Cartesian grid, assembling the $Q_{1}$ stiffness matrix for the Laplacian yields the standard five-point discrete Laplacian. Therefore, $A_{H}^{\\text{fem}}$ is the standard five-point Laplacian on the coarse grid. So, we have:\n$$\nA_{H} = \\frac{1}{4} A_{H}^{\\text{fem}}\n$$\nThis shows that $A_H$ is a uniformly scaled version of the standard coarse-grid five-point Laplacian. The symbol of $A_{H}^{\\text{fem}}$ is given by the same formula as $\\tilde{A}_h(\\boldsymbol{\\theta})$, but with $h$ replaced by $H$ and frequency $\\boldsymbol{\\theta}$ replaced by coarse-grid frequency $\\boldsymbol{\\vartheta}$:\n$$\n\\tilde{A}_{H}^{\\text{fem}}(\\boldsymbol{\\vartheta}) = \\frac{4}{H^2} \\left( \\sin^2(\\tfrac{\\vartheta_1}{2}) + \\sin^2(\\tfrac{\\vartheta_2}{2}) \\right)\n$$\nThe symbol for our operator $A_H$ is therefore:\n$$\n\\tilde{A}_{H}(\\boldsymbol{\\vartheta}) = \\frac{1}{4} \\tilde{A}_{H}^{\\text{fem}}(\\boldsymbol{\\vartheta}) = \\frac{1}{4} \\frac{4}{H^2} \\left( \\sin^2(\\tfrac{\\vartheta_1}{2}) + \\sin^2(\\tfrac{\\vartheta_2}{2}) \\right) = \\frac{1}{H^2} \\left( \\sin^2(\\tfrac{\\vartheta_1}{2}) + \\sin^2(\\tfrac{\\vartheta_2}{2}) \\right)\n$$\n\n**Task 4: Final Evaluation**\n\nWe must evaluate the dimensionless scalar $S = \\tilde{A}_{H}(\\boldsymbol{\\vartheta})\\,H^{2}$ at $\\boldsymbol{\\vartheta} = (\\tfrac{\\pi}{2}, \\tfrac{\\pi}{3})$.\nSubstitute the expression for $\\tilde{A}_{H}(\\boldsymbol{\\vartheta})$:\n$$\nS = \\left[ \\frac{1}{H^2} \\left( \\sin^2(\\tfrac{\\vartheta_1}{2}) + \\sin^2(\\tfrac{\\vartheta_2}{2}) \\right) \\right] H^2 = \\sin^2(\\tfrac{\\vartheta_1}{2}) + \\sin^2(\\tfrac{\\vartheta_2}{2})\n$$\nNow substitute the values for $\\boldsymbol{\\vartheta}$:\n$$\nS = \\sin^2\\left(\\frac{1}{2} \\cdot \\frac{\\pi}{2}\\right) + \\sin^2\\left(\\frac{1}{2} \\cdot \\frac{\\pi}{3}\\right) = \\sin^2\\left(\\frac{\\pi}{4}\\right) + \\sin^2\\left(\\frac{\\pi}{6}\\right)\n$$\nWe know the exact values: $\\sin(\\frac{\\pi}{4}) = \\frac{\\sqrt{2}}{2}$ and $\\sin(\\frac{\\pi}{6}) = \\frac{1}{2}$.\n$$\nS = \\left(\\frac{\\sqrt{2}}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 = \\frac{2}{4} + \\frac{1}{4} = \\frac{1}{2} + \\frac{1}{4}\n$$\n$$\nS = \\frac{3}{4}\n$$\nThe final value is $\\frac{3}{4}$.", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "2581555"}, {"introduction": "The 'smoother' is the engine of a multigrid method, designed to efficiently eliminate high-frequency errors on each grid. However, for challenging problems like anisotropic diffusion, standard point-wise smoothers fail. This practice dives into the design and analysis of a robust line Gauss-Seidel smoother tailored to the direction of strong coupling in the problem [@problem_id:2581527]. By using Local Fourier Analysis to compute its smoothing factor, you will quantitatively prove its effectiveness, illustrating how to adapt multigrid components to the specific characteristics of the partial differential equation.", "problem": "Consider the anisotropic diffusion model problem on an infinite, uniform rectangular grid with mesh size $h$:\n$$\n- \\frac{\\partial^2 u}{\\partial x^2} - \\epsilon \\frac{\\partial^2 u}{\\partial y^2} = f \\quad \\text{in } \\mathbb{R}^2,\n$$\nwhere $0<\\epsilon \\ll 1$. Let $\\mathbb{Q}_1$ (bilinear) conforming finite elements on a uniform Cartesian mesh be used to discretize the weak form, and consider the standard stiffness operator on the infinite grid. For this structured setting, you may use the well-known fact that the resulting stiffness operator has the same symbol as the standard $5$-point finite difference discretization. Write the discrete operator $A$ in the usual $5$-point stencil form acting on grid functions $\\{u_{i,j}\\}_{(i,j)\\in\\mathbb{Z}^2}$:\n$$\n(Au)_{i,j} \\;=\\; -u_{i-1,j} + \\left(2\\right)u_{i,j} - u_{i+1,j} \\;+\\; \\epsilon\\left( -u_{i,j-1} + \\left(2\\right)u_{i,j} - u_{i,j+1} \\right).\n$$\n\n- Argue from first principles (the stiffness form of the bilinear finite element and its translation invariance on the infinite, uniform grid) that the direction of strong coupling is the $x$-direction when $0<\\epsilon\\ll 1$.\n- Derive the line Gauss–Seidel (GS) smoother along the direction of strong coupling (i.e., along $x$-lines at fixed $j$). Concretely, write the exact line-solve update for a forward sweep in the $y$-index $j$, i.e., for each fixed $j$ solve a tridiagonal system along $i$ whose diagonal block you must specify. Your answer must explicitly give the one-dimensional tridiagonal “stencil” solved on each line and how the right-hand side depends on neighboring lines in the $y$-direction, indicating which neighbor uses the most recently updated values.\n- Perform a Local Fourier Analysis (LFA; Local Fourier Analysis) on the infinite grid to derive the scalar Fourier symbol $\\tilde{E}(\\theta_x,\\theta_y)$ of the error-propagation operator for one forward sweep of this line GS smoother, where $(\\theta_x,\\theta_y)\\in[-\\pi,\\pi]^2$ are the Fourier frequencies. Clearly state the symbol of the discrete operator $A$ and of the line GS error-propagation operator obtained by your splitting.\n- For a multigrid method with semi-coarsening in the $y$-direction (coarse grid halves the resolution only in $y$), the relevant high-frequency set is $\\Theta_{\\mathrm{H}}=\\{(\\theta_x,\\theta_y): \\theta_x\\in[-\\pi,\\pi],\\, \\theta_y\\in[\\pi/2,\\pi]\\}$. Using your LFA symbol, determine the worst-case smoothing factor\n$$\n\\mu_{\\mathrm{smooth}}(\\epsilon) \\;=\\; \\sup_{(\\theta_x,\\theta_y)\\in\\Theta_{\\mathrm{H}}} \\left| \\tilde{E}(\\theta_x,\\theta_y) \\right|.\n$$\n\nProvide your final answer as the exact closed-form value of the limit $\\displaystyle \\lim_{\\epsilon\\to 0^+} \\mu_{\\mathrm{smooth}}(\\epsilon)$. No rounding is required. The final answer must be a single expression.", "solution": "We start from the weak form of the anisotropic diffusion operator,\n$$\na(u,v) \\;=\\; \\int_{\\mathbb{R}^2} \\left( \\frac{\\partial u}{\\partial x}\\frac{\\partial v}{\\partial x} + \\epsilon \\frac{\\partial u}{\\partial y}\\frac{\\partial v}{\\partial y} \\right)\\,\\mathrm{d}x\\,\\mathrm{d}y,\n$$\nand the $\\mathbb{Q}_1$ (bilinear) finite element space on a uniform Cartesian mesh. On an infinite, uniform grid, the assembled stiffness operator is translation invariant and coincides (up to a constant $h^{-2}$ scaling that is irrelevant for the Local Fourier Analysis) with the standard $5$-point finite difference operator for $- \\partial_{xx} - \\epsilon \\partial_{yy}$. Hence, acting on grid functions $\\{u_{i,j}\\}$, the discrete operator $A$ has the $5$-point stencil\n$$\n(Au)_{i,j} \\;=\\; -u_{i-1,j} + \\left(2\\right)u_{i,j} - u_{i+1,j} \\;+\\; \\epsilon\\left( -u_{i,j-1} + \\left(2\\right)u_{i,j} - u_{i,j+1} \\right).\n$$\n\nDirection of strong coupling. The stiffness entries in the $x$-direction are of magnitude $\\mathcal{O}(1)$, while those in the $y$-direction are of magnitude $\\mathcal{O}(\\epsilon)$. Therefore, when $0<\\epsilon\\ll 1$, the couplings along $x$ dominate and the direction of strong coupling is the $x$-direction.\n\nLine Gauss–Seidel (GS) smoother along $x$-lines. Rewriting $A$ by grouping $x$- and $y$-contributions at a fixed line index $j$, we introduce the one-dimensional $x$-line operator $A_x$:\n$$\n(A_x u)_{i,j} \\;=\\; -u_{i-1,j} + \\left(2\\right)u_{i,j} - u_{i+1,j},\n$$\nand observe that\n$$\n(Au)_{i,j} \\;=\\; (A_x u)_{i,j} \\;+\\; \\epsilon\\left(2 u_{i,j} - u_{i,j-1} - u_{i,j+1}\\right).\n$$\nIn block form with respect to the lines $j$, the diagonal block is\n$$\nB \\;=\\; A_x \\;+\\; \\left(2\\epsilon\\right) I,\n$$\nand the off-diagonal blocks are\n$$\nC_{\\mathrm{lower}} \\;=\\; -\\epsilon I \\quad \\text{(coupling to line } j-1\\text{)}, \\qquad C_{\\mathrm{upper}} \\;=\\; -\\epsilon I \\quad \\text{(coupling to line } j+1\\text{)}.\n$$\nA forward Gauss–Seidel sweep in the line index $j$ uses the latest available value on line $j-1$ and the old value on line $j+1$. Thus, for each fixed $j$, the line update $u^{\\mathrm{new}}_j$ is defined as the exact solution of the tridiagonal system\n$$\n\\Big( A_x \\;+\\; \\left(2\\epsilon\\right) I \\Big)\\, u^{\\mathrm{new}}_j \\;=\\; \\epsilon\\, u^{\\mathrm{new}}_{j-1} \\;+\\; \\epsilon\\, u^{\\mathrm{old}}_{j+1} \\;+\\; \\text{(right-hand side terms if present)}.\n$$\nIn terms of a “stencil” along the line, the left-hand side operator is the one-dimensional tridiagonal stencil\n$$\n\\big[-1,\\; 2+2\\epsilon,\\; -1\\big]\n$$\nacting on the $x$-neighbors $\\{u_{i-1,j},u_{i,j},u_{i+1,j}\\}$, while the right-hand side contains the linewise contributions from the neighboring lines $j-1$ and $j+1$, with $u_{j-1}$ taken at its most recently updated values and $u_{j+1}$ at its old values.\n\nLocal Fourier Analysis (LFA; Local Fourier Analysis). On the infinite grid, Fourier modes\n$$\n\\varphi_{\\boldsymbol{\\theta}}(i,j) \\;=\\; \\exp\\!\\big(\\mathrm{i} (i\\,\\theta_x + j\\,\\theta_y)\\big), \\qquad (\\theta_x,\\theta_y)\\in[-\\pi,\\pi]^2,\n$$\ndiagonalize all translation-invariant operators. The Fourier symbol of $A_x$ is\n$$\n\\tilde{A}_x(\\theta_x) \\;=\\; 2 - 2\\cos(\\theta_x) \\;=\\; 4 \\sin^2\\!\\left(\\frac{\\theta_x}{2}\\right).\n$$\nHence the symbol of the diagonal block $B$ is\n$$\n\\tilde{B}(\\theta_x) \\;=\\; \\tilde{A}_x(\\theta_x) \\;+\\; \\left(2\\epsilon\\right),\n$$\nand the symbols of the off-diagonal blocks are\n$$\n\\widetilde{C}_{\\mathrm{lower}}(\\theta_y) \\;=\\; -\\epsilon\\, \\exp(-\\mathrm{i}\\theta_y), \\qquad \\widetilde{C}_{\\mathrm{upper}}(\\theta_y) \\;=\\; -\\epsilon\\, \\exp(+\\mathrm{i}\\theta_y).\n$$\nFor a forward block Gauss–Seidel sweep in $j$, the error-propagation operator $E$ satisfies, linewise,\n$$\ne^{\\mathrm{new}}_j \\;=\\; - \\big(B + C_{\\mathrm{lower}}\\big)^{-1} C_{\\mathrm{upper}}\\, e^{\\mathrm{old}}_{j+1}.\n$$\nTherefore, the scalar symbol of the error-propagation operator acting on a Fourier mode with frequency $(\\theta_x,\\theta_y)$ is\n$$\n\\tilde{E}(\\theta_x,\\theta_y) \\;=\\; - \\frac{\\widetilde{C}_{\\mathrm{upper}}(\\theta_y)}{\\tilde{B}(\\theta_x) + \\widetilde{C}_{\\mathrm{lower}}(\\theta_y)} \\;=\\; \\frac{\\epsilon\\, \\exp(+\\mathrm{i}\\theta_y)}{\\tilde{A}_x(\\theta_x) + \\left(2\\epsilon\\right) - \\epsilon\\, \\exp(-\\mathrm{i}\\theta_y)}.\n$$\nIts magnitude is\n$$\n\\left|\\tilde{E}(\\theta_x,\\theta_y)\\right| \\;=\\; \\frac{\\epsilon}{\\left|\\, \\tilde{A}_x(\\theta_x) + \\left(2\\epsilon\\right) - \\epsilon\\, \\exp(-\\mathrm{i}\\theta_y) \\,\\right|}.\n$$\n\nWorst-case smoothing factor for semi-coarsening in $y$. With semi-coarsening in $y$, the high-frequency set is $\\Theta_{\\mathrm{H}}=\\{(\\theta_x,\\theta_y): \\theta_x\\in[-\\pi,\\pi],\\; \\theta_y\\in[\\pi/2,\\pi]\\}$. We seek\n$$\n\\mu_{\\mathrm{smooth}}(\\epsilon) \\;=\\; \\sup_{(\\theta_x,\\theta_y)\\in\\Theta_{\\mathrm{H}}} \\left|\\tilde{E}(\\theta_x,\\theta_y)\\right|.\n$$\nWrite $\\tilde{A}_x(\\theta_x)=4\\sin^2(\\theta_x/2) \\equiv s_x^2$ with $s_x\\in[0,2]$. Then\n$$\n\\left|\\tilde{E}(\\theta_x,\\theta_y)\\right| \\;=\\; \\frac{\\epsilon}{\\sqrt{\\left(s_x^2 + 2\\epsilon - \\epsilon\\cos\\theta_y\\right)^2 + \\left(\\epsilon \\sin\\theta_y\\right)^2}}.\n$$\nFor fixed $\\epsilon>0$, the denominator increases monotonically with $s_x^2$, so the worst case over $\\theta_x\\in[-\\pi,\\pi]$ occurs at $s_x^2=0$, i.e., $\\theta_x=0$. Substituting $s_x^2=0$ gives\n$$\n\\left|\\tilde{E}(0,\\theta_y)\\right| \\;=\\; \\frac{\\epsilon}{\\left|\\, 2\\epsilon - \\epsilon \\exp(-\\mathrm{i}\\theta_y) \\,\\right|} \\;=\\; \\frac{1}{\\left|\\, 2 - \\exp(-\\mathrm{i}\\theta_y) \\,\\right|}.\n$$\nThus the dependence on $\\epsilon$ cancels, and we must maximize over $\\theta_y\\in[\\pi/2,\\pi]$ the function\n$$\ng(\\theta_y) \\;=\\; \\frac{1}{\\left|\\, 2 - \\exp(-\\mathrm{i}\\theta_y) \\,\\right|}.\n$$\nCompute\n$$\n\\left|\\, 2 - \\exp(-\\mathrm{i}\\theta_y) \\,\\right|^2 \\;=\\; \\left(2 - \\cos\\theta_y\\right)^2 + \\left(\\sin\\theta_y\\right)^2 \\;=\\; 4 - 4\\cos\\theta_y + \\cos^2\\theta_y + \\sin^2\\theta_y \\;=\\; 5 - 4\\cos\\theta_y.\n$$\nOn $\\theta_y\\in[\\pi/2,\\pi]$, we have $\\cos\\theta_y\\in[0,-1]$, so $5 - 4\\cos\\theta_y$ is minimized at $\\theta_y=\\pi/2$, where $\\cos\\theta_y=0$. Therefore,\n$$\n\\sup_{\\theta_y\\in[\\pi/2,\\pi]} g(\\theta_y) \\;=\\; \\frac{1}{\\sqrt{5 - 4\\cdot 0}} \\;=\\; \\frac{1}{\\sqrt{5}}.\n$$\nConsequently,\n$$\n\\mu_{\\mathrm{smooth}}(\\epsilon) \\;=\\; \\sup_{(\\theta_x,\\theta_y)\\in\\Theta_{\\mathrm{H}}} \\left|\\tilde{E}(\\theta_x,\\theta_y)\\right| \\;=\\; \\frac{1}{\\sqrt{5}} \\quad \\text{for all } \\epsilon\\in(0,1],\n$$\nand, in particular,\n$$\n\\lim_{\\epsilon\\to 0^+} \\mu_{\\mathrm{smooth}}(\\epsilon) \\;=\\; \\frac{1}{\\sqrt{5}}.\n$$\nThis shows that the line Gauss–Seidel smoother along the strong-coupling ($x$) direction has an $\\epsilon$-independent smoothing factor strictly less than $1$ on the relevant high-frequency set for $y$-semi-coarsening, demonstrating its effectiveness for $\\epsilon\\ll 1$.", "answer": "$$\\boxed{\\frac{1}{\\sqrt{5}}}$$", "id": "2581527"}]}