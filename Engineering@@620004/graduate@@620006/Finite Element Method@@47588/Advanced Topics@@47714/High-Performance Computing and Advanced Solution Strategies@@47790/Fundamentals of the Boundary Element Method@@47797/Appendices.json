{"hands_on_practices": [{"introduction": "The journey from a partial differential equation to a solvable algebraic system is the essence of any numerical method. This first practice focuses on that foundational process for the Boundary Element Method (BEM). By starting with Green's second identity and discretizing the resulting boundary integral equation using a nodal collocation scheme, you will construct the core matrix system and confront the characteristic singular integrals that define BEM [@problem_id:2560745]. This exercise is crucial for understanding the origin of the BEM influence matrices and the role of the geometric 'free-term' coefficient.", "problem": "Consider a bounded, simply connected domain $\\Omega \\subset \\mathbb{R}^{2}$ with a piecewise $\\mathcal{C}^{1}$ boundary $\\Gamma$, outward unit normal $\\boldsymbol{n}$, and an interior Dirichlet boundary-value problem for Laplace’s equation: find $u$ such that $\\Delta u = 0$ in $\\Omega$ and $u = \\bar{u}$ on $\\Gamma$, where $\\bar{u}$ is prescribed and sufficiently smooth. Use Green’s second identity together with the free-space fundamental solution of the Laplace operator in $\\mathbb{R}^{2}$, namely $G(\\boldsymbol{x},\\boldsymbol{\\xi}) = -\\dfrac{1}{2\\pi}\\ln|\\boldsymbol{x}-\\boldsymbol{\\xi}|$, to derive the direct boundary integral equation for the limit of the interior solution trace approaching a boundary point. Then, construct the collocation Boundary Element Method (BEM) by:\n- discretizing $\\Gamma$ into $N$ straight elements with nodes $\\{\\boldsymbol{\\xi}_{i}\\}_{i=1}^{N}$ ordered along $\\Gamma$,\n- approximating both the boundary potential $u$ and its outward normal derivative $q := \\partial u/\\partial n$ on $\\Gamma$ using scalar shape functions $\\{N_{j}\\}_{j=1}^{N}$ associated with the same nodal set,\n- enforcing the boundary integral equation at the set of nodal collocation points $\\{\\boldsymbol{\\xi}_{i}\\}_{i=1}^{N}$.\n\nExplicitly identify the matrix kernels that arise and their limiting interpretations at the diagonal. Discuss, from first principles, how the singular behavior of the kernels is treated at the diagonal entries, distinguishing between the weakly singular logarithmic kernel and the Cauchy principal value kernel, and relate the diagonal coefficient $c_{i}$ to the local interior wedge angle $\\theta_{i}$ at $\\boldsymbol{\\xi}_{i}$ (measured in radians). Finally, for a point $\\boldsymbol{\\xi}_{i}$ where $\\Gamma$ is locally smooth (i.e., $\\theta_{i} = \\pi$), state the exact value of the diagonal coefficient $c_{i}$. Your final answer must be a single number. Use radians for any angle considerations. No rounding is required.", "solution": "We begin from Green’s second identity: for sufficiently smooth scalar fields $u,v$ on $\\Omega$ with boundary $\\Gamma$ and outward unit normal $\\boldsymbol{n}$,\n$$\n\\int_{\\Omega}\\left(u\\,\\Delta v - v\\,\\Delta u\\right)\\,\\mathrm{d}\\Omega\n=\n\\int_{\\Gamma}\\left(u\\,\\frac{\\partial v}{\\partial n} - v\\,\\frac{\\partial u}{\\partial n}\\right)\\,\\mathrm{d}\\Gamma.\n$$\nLet $v(\\boldsymbol{x}) = G(\\boldsymbol{x},\\boldsymbol{\\xi})$, where $G$ is the free-space fundamental solution of the Laplace operator in $\\mathbb{R}^{2}$,\n$$\nG(\\boldsymbol{x},\\boldsymbol{\\xi}) = -\\frac{1}{2\\pi}\\ln|\\boldsymbol{x}-\\boldsymbol{\\xi}|,\n$$\nwhich satisfies $\\Delta_{\\boldsymbol{x}} G(\\boldsymbol{x},\\boldsymbol{\\xi}) = \\delta(\\boldsymbol{x}-\\boldsymbol{\\xi})$. Since $u$ is harmonic, $\\Delta u = 0$ in $\\Omega$. Substituting into Green’s identity yields, for any fixed $\\boldsymbol{\\xi}\\in \\Omega$,\n$$\n\\int_{\\Omega} u(\\boldsymbol{x})\\,\\delta(\\boldsymbol{x}-\\boldsymbol{\\xi})\\,\\mathrm{d}\\Omega(\\boldsymbol{x})\n=\n\\int_{\\Gamma}\\left(u(\\boldsymbol{x})\\,\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi})}{\\partial n(\\boldsymbol{x})} - G(\\boldsymbol{x},\\boldsymbol{\\xi})\\,\\frac{\\partial u(\\boldsymbol{x})}{\\partial n(\\boldsymbol{x})}\\right)\\,\\mathrm{d}\\Gamma(\\boldsymbol{x}).\n$$\nThe left-hand side reduces to $u(\\boldsymbol{\\xi})$, hence for $\\boldsymbol{\\xi}\\in \\Omega$,\n$$\nu(\\boldsymbol{\\xi}) = \\int_{\\Gamma}\\left(u(\\boldsymbol{x})\\,\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi})}{\\partial n(\\boldsymbol{x})} - q(\\boldsymbol{x})\\,G(\\boldsymbol{x},\\boldsymbol{\\xi})\\right)\\,\\mathrm{d}\\Gamma(\\boldsymbol{x}),\n$$\nwith $q := \\partial u/\\partial n$. Taking the limit as $\\boldsymbol{\\xi}\\to \\boldsymbol{\\xi}_{0}\\in \\Gamma$ from the interior, the classic jump relations for layer potentials yield the boundary integral equation in the “direct” form\n$$\nc(\\boldsymbol{\\xi}_{0})\\,u(\\boldsymbol{\\xi}_{0})\n+\n\\int_{\\Gamma} u(\\boldsymbol{x})\\,\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi}_{0})}{\\partial n(\\boldsymbol{x})}\\,\\mathrm{d}\\Gamma(\\boldsymbol{x})\n=\n\\int_{\\Gamma} q(\\boldsymbol{x})\\,G(\\boldsymbol{x},\\boldsymbol{\\xi}_{0})\\,\\mathrm{d}\\Gamma(\\boldsymbol{x}),\n$$\nwhere $c(\\boldsymbol{\\xi}_{0})$ is a geometric coefficient determined by the interior wedge angle at $\\boldsymbol{\\xi}_{0}$:\n$$\nc(\\boldsymbol{\\xi}_{0}) = \\frac{\\theta(\\boldsymbol{\\xi}_{0})}{2\\pi},\n$$\nwith $\\theta(\\boldsymbol{\\xi}_{0})$ the interior angle (in radians) of $\\Omega$ at $\\boldsymbol{\\xi}_{0}$. For a smooth point, $\\theta(\\boldsymbol{\\xi}_{0}) = \\pi$, hence $c(\\boldsymbol{\\xi}_{0}) = 1/2$.\n\nTo construct a collocation Boundary Element Method (BEM), partition $\\Gamma$ into $N$ straight boundary elements $\\{\\Gamma_{e}\\}_{e=1}^{N_{el}}$ with nodal points $\\{\\boldsymbol{\\xi}_{i}\\}_{i=1}^{N}$ ordered along $\\Gamma$. Introduce scalar shape functions $\\{N_{j}\\}_{j=1}^{N}$ associated with these nodes, and approximate the boundary fields as\n$$\nu(\\boldsymbol{x}) \\approx \\sum_{j=1}^{N} N_{j}(\\boldsymbol{x})\\,u_{j}, \n\\qquad\nq(\\boldsymbol{x}) \\approx \\sum_{j=1}^{N} N_{j}(\\boldsymbol{x})\\,q_{j},\n\\quad \\boldsymbol{x}\\in \\Gamma.\n$$\nEnforce the boundary integral equation at the collocation points $\\boldsymbol{\\xi}_{i}$, $i=1,\\dots,N$, to obtain\n$$\nc_{i}\\,u_{i} + \\sum_{j=1}^{N} \\left(\\int_{\\Gamma} N_{j}(\\boldsymbol{x})\\,\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i})}{\\partial n(\\boldsymbol{x})}\\,\\mathrm{d}\\Gamma(\\boldsymbol{x})\\right) u_{j}\n=\n\\sum_{j=1}^{N} \\left(\\int_{\\Gamma} N_{j}(\\boldsymbol{x})\\,G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i})\\,\\mathrm{d}\\Gamma(\\boldsymbol{x})\\right) q_{j}.\n$$\nDefine the influence matrices\n$$\nH_{ij} := \\int_{\\Gamma} N_{j}(\\boldsymbol{x})\\,\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i})}{\\partial n(\\boldsymbol{x})}\\,\\mathrm{d}\\Gamma(\\boldsymbol{x}), \n\\qquad\nG_{ij} := \\int_{\\Gamma} N_{j}(\\boldsymbol{x})\\,G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i})\\,\\mathrm{d}\\Gamma(\\boldsymbol{x}),\n$$\nso the discrete collocation system reads\n$$\nc_{i}\\,u_{i} + \\sum_{j=1}^{N} H_{ij}\\,u_{j} = \\sum_{j=1}^{N} G_{ij}\\,q_{j}, \\quad i=1,\\dots,N.\n$$\nFor the interior Dirichlet problem, the boundary values $u_{j}$ are known (from $u|_{\\Gamma}=\\bar{u}$), and the unknowns are $\\{q_{j}\\}_{j=1}^{N}$. The right-hand side is assembled from the known $u_{j}$ and the matrix $H_{ij}$, while the left-hand side matrix acting on the unknowns is $G_{ij}$.\n\nWe now discuss the singular behavior and the diagonal terms:\n\n$1.$ The kernel $G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i}) = -\\dfrac{1}{2\\pi}\\ln|\\boldsymbol{x}-\\boldsymbol{\\xi}_{i}|$ is weakly singular (logarithmic) as $\\boldsymbol{x}\\to \\boldsymbol{\\xi}_{i}$. For $j$ such that the support of $N_{j}$ contains $\\boldsymbol{\\xi}_{i}$, the integral $G_{ij}$ is finite and can be evaluated exactly by analytic integration on straight elements or by singularity subtraction. No jump term arises from $G_{ij}$; the singularity is integrable.\n\n$2.$ The kernel $\\dfrac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i})}{\\partial n(\\boldsymbol{x})}$ behaves like $\\mathcal{O}(|\\boldsymbol{x}-\\boldsymbol{\\xi}_{i}|^{-1})$ as $\\boldsymbol{x}\\to \\boldsymbol{\\xi}_{i}$ and must be interpreted in the Cauchy principal value sense. The classical jump relation for the double-layer potential yields that, upon taking the interior limit to the boundary, one obtains an additional local term $c_{i}\\,u_{i}$ with\n$$\nc_{i}=\\frac{\\theta_{i}}{2\\pi},\n$$\nwhere $\\theta_{i}$ is the interior wedge angle of $\\Omega$ at $\\boldsymbol{\\xi}_{i}$ (in radians). In practice, one either:\n- evaluates $H_{ij}$ as a principal value integral and treats $c_{i}$ explicitly, or\n- groups the diagonal contribution into $H_{ii}$ by adding or subtracting $c_{i}$ so that the implemented $H_{ii}$ is finite and consistent with the jump relation.\n\nFor a smooth point on $\\Gamma$, the local geometry has interior angle $\\theta_{i}=\\pi$, hence\n$$\nc_{i}=\\frac{\\pi}{2\\pi}=\\frac{1}{2}.\n$$\n\nTherefore, the exact value of the diagonal coefficient at a smooth boundary collocation point is $c_{i} = 1/2$.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2560745"}, {"introduction": "The accuracy of a numerical method is fundamentally limited by the smoothness of the underlying solution. For problems on domains with corners, particularly re-entrant ones, solutions to elliptic PDEs like Laplace's equation exhibit singularities that degrade numerical performance. This analytical exercise uses separation of variables to reveal the mathematical structure of these corner singularities, allowing you to derive the characteristic exponent that governs the solution's local behavior [@problem_id:2560760]. Mastering this analysis provides a deep, predictive understanding of BEM's convergence properties on non-smooth domains.", "problem": "Consider a planar domain with a single reentrant corner located at the origin. In a local polar coordinate system $\\left(r,\\varphi\\right)$ centered at the corner, the domain near the corner is a wedge $\\{(r,\\varphi)\\,:\\, r>0,\\; 0<\\varphi<\\theta\\}$ with interior angle $\\theta$ satisfying $\\theta>\\pi$. Let $u$ be the solution to the Dirichlet problem for the Laplace equation,\n$$\n\\Delta u \\,=\\, 0 \\quad \\text{in the wedge}, \\qquad u\\,=\\,g \\quad \\text{on } \\{\\varphi=0\\}\\cup\\{\\varphi=\\theta\\},\n$$\nwith $g$ continuous up to the corner and not identically zero in any neighborhood of the corner. Assume the boundary data $g$ are such that the leading singular corner mode is excited. Your tasks are:\n\n- Starting from the polar form of the Laplace operator, use separation-of-variables and boundary conditions intrinsic to the wedge geometry to identify the leading-order asymptotic behavior of $u(r,\\varphi)$ as $r\\to 0^{+}$.\n- From this analysis, determine the unique positive singular exponent $\\lambda(\\theta)$ such that there exists a nontrivial angular function $\\Phi(\\varphi)$ with \n$$\nu(r,\\varphi)\\sim r^{\\lambda(\\theta)}\\,\\Phi(\\varphi)\\quad \\text{as } r\\to 0^{+}.\n$$\n- Briefly explain why this exponent governs the reduced smoothness of traces and fluxes at the corner that, in turn, limits the convergence order of boundary element discretizations for the Dirichlet problem.\n\nReport only the explicit closed-form expression for the exponent $\\lambda(\\theta)$ as a function of $\\theta$ in radians. No numerical approximation is required.", "solution": "The task is to determine the leading-order singular behavior of a solution to the Laplace equation in a planar wedge with a reentrant corner. The governing equation is the Laplace equation, $\\Delta u = 0$. In a polar coordinate system $(r, \\varphi)$ centered at the corner, the Laplacian operator is given by:\n$$\n\\Delta = \\frac{\\partial^{2}}{\\partial r^{2}} + \\frac{1}{r} \\frac{\\partial}{\\partial r} + \\frac{1}{r^{2}} \\frac{\\partial^{2}}{\\partial \\varphi^{2}}\n$$\nSo, the equation to solve is:\n$$\n\\frac{\\partial^{2} u}{\\partial r^{2}} + \\frac{1}{r} \\frac{\\partial u}{\\partial r} + \\frac{1}{r^{2}} \\frac{\\partial^{2} u}{\\partial \\varphi^{2}} = 0\n$$\nWe employ the method of separation of variables, postulating a solution of the form $u(r, \\varphi) = R(r)\\Phi(\\varphi)$. Substituting this ansatz into the Laplace equation gives:\n$$\nR''(r)\\Phi(\\varphi) + \\frac{1}{r}R'(r)\\Phi(\\varphi) + \\frac{1}{r^{2}}R(r)\\Phi''(\\varphi) = 0\n$$\nMultiplying by $\\frac{r^{2}}{R(r)\\Phi(\\varphi)}$ separates the variables:\n$$\n\\frac{r^{2}R''(r) + rR'(r)}{R(r)} = -\\frac{\\Phi''(\\varphi)}{\\Phi(\\varphi)}\n$$\nSince the left side depends only on $r$ and the right side depends only on $\\varphi$, both must be equal to a constant, which we denote by $k$. This yields two ordinary differential equations:\n$$\nr^{2}R''(r) + rR'(r) - k R(r) = 0 \\quad (\\text{Radial Equation})\n$$\n$$\n\\Phi''(\\varphi) + k \\Phi(\\varphi) = 0 \\quad (\\text{Angular Equation})\n$$\nWe are interested in the singular behavior intrinsic to the corner geometry. The singular functions are solutions to the problem with homogeneous boundary conditions. The general solution can be expanded in terms of these singular functions. We thus impose homogeneous Dirichlet conditions on the angular part, corresponding to the boundaries of the wedge: $\\Phi(0) = 0$ and $\\Phi(\\theta) = 0$.\n\nLet us solve the angular equation. A non-trivial solution satisfying these boundary conditions requires $k > 0$. Let $k = \\lambda^{2}$ with $\\lambda > 0$. The general solution for $\\Phi(\\varphi)$ is:\n$$\n\\Phi(\\varphi) = A \\cos(\\lambda\\varphi) + B \\sin(\\lambda\\varphi)\n$$\nApplying the first boundary condition, $\\Phi(0) = 0$, gives:\n$$\nA \\cos(0) + B \\sin(0) = A = 0\n$$\nThus, the solution must be of the form $\\Phi(\\varphi) = B \\sin(\\lambda\\varphi)$. Applying the second boundary condition, $\\Phi(\\theta)=0$, gives:\n$$\nB \\sin(\\lambda\\theta) = 0\n$$\nFor a non-trivial solution ($B \\neq 0$), we must have $\\sin(\\lambda\\theta) = 0$. This implies $\\lambda\\theta = n\\pi$ for any non-zero integer $n$. We take $n$ to be positive integers, $n=1, 2, 3, \\dots$, as negative integers do not produce independent solutions.\nThe eigenvalues are therefore $\\lambda_{n} = \\frac{n\\pi}{\\theta}$, and the corresponding separation constants are $k_{n} = \\lambda_{n}^{2} = \\left(\\frac{n\\pi}{\\theta}\\right)^{2}$. The eigenfunctions are $\\Phi_{n}(\\varphi) = \\sin\\left(\\frac{n\\pi\\varphi}{\\theta}\\right)$.\n\nNext, we solve the radial equation, which is a Cauchy-Euler equation:\n$$\nr^{2}R''(r) + rR'(r) - k_{n} R(r) = 0\n$$\nWe seek solutions of the form $R(r) = r^{\\alpha}$. Substituting this into the equation yields the characteristic equation for $\\alpha$:\n$$\n\\alpha(\\alpha-1) + \\alpha - k_{n} = 0 \\implies \\alpha^{2} = k_{n} \\implies \\alpha = \\pm\\sqrt{k_{n}} = \\pm\\lambda_{n}\n$$\nThe general solution for the radial part is $R_{n}(r) = C_{1}r^{\\lambda_{n}} + C_{2}r^{-\\lambda_{n}}$. For the solution to be physically meaningful (e.g., have finite energy $\\int |\\nabla u|^2$ in a neighborhood of the origin), the exponents must be positive. This leads us to discard the terms with negative exponents.\nThe general solution for $u(r,\\varphi)$ can be written as a superposition of these separated solutions:\n$$\nu(r, \\varphi) = \\sum_{n=1}^{\\infty} c_{n} r^{\\lambda_{n}} \\Phi_{n}(\\varphi) = \\sum_{n=1}^{\\infty} c_{n} r^{n\\pi/\\theta} \\sin\\left(\\frac{n\\pi\\varphi}{\\theta}\\right)\n$$\nThe asymptotic behavior as $r \\to 0^{+}$ is governed by the term with the smallest positive exponent. The exponents are $\\lambda_{n} = \\frac{n\\pi}{\\theta}$ for $n=1, 2, 3, \\ldots$. The smallest such exponent corresponds to $n=1$:\n$$\n\\lambda_{1} = \\frac{\\pi}{\\theta}\n$$\nThe problem specifies a reentrant corner, where the interior angle $\\theta > \\pi$. This implies that the leading exponent $\\lambda_{1} = \\frac{\\pi}{\\theta}$ is less than $1$. An exponent less than $1$ signifies a singularity in the gradient of the solution, as $\\nabla u \\sim \\nabla(r^{\\pi/\\theta}) \\sim r^{\\pi/\\theta - 1}$, which tends to infinity as $r \\to 0$ because the exponent $\\frac{\\pi}{\\theta}-1$ is negative.\nTherefore, the leading-order asymptotic behavior as $r \\to 0^{+}$ is:\n$$\nu(r,\\varphi) \\sim c_{1} r^{\\pi/\\theta} \\sin\\left(\\frac{\\pi\\varphi}{\\theta}\\right)\n$$\nThis matches the form $r^{\\lambda(\\theta)}\\Phi(\\varphi)$ where the singular exponent $\\lambda(\\theta)$ is $\\frac{\\pi}{\\theta}$.\n\nFinally, we address the implication for the boundary element method (BEM). The BEM solves a boundary integral equation for unknown data on the boundary $\\partial\\Omega$. For the Dirichlet problem, the unknown is the normal derivative (flux), $q = \\frac{\\partial u}{\\partial n}$. Near the corner, on the side $\\varphi=0$, the flux behaves as:\n$$\nq = \\frac{\\partial u}{\\partial n} \\approx -\\frac{1}{r} \\frac{\\partial u}{\\partial \\varphi}\\bigg|_{\\varphi=0} \\sim -\\frac{1}{r} r^{\\pi/\\theta} \\frac{\\pi}{\\theta} \\cos(0) \\sim r^{\\pi/\\theta - 1}\n$$\nAs established, for a reentrant corner with $\\theta > \\pi$, the exponent $\\frac{\\pi}{\\theta}-1$ is negative. This proves that the flux is singular at the corner tip. Standard BEM discretizations employ polynomial basis functions (piecewise constant, linear, etc.) to approximate the unknown boundary data. Such functions are smooth and fundamentally incapable of accurately representing the $r^{\\pi/\\theta-1}$ singularity. This poor local approximation introduces a large error that pollutes the global solution and critically degrades the method's rate of convergence. The convergence order is no longer determined by the polynomial degree of the basis functions, but is instead limited by the value of the singular exponent $\\lambda(\\theta) = \\frac{\\pi}{\\theta}$. This reduced regularity of the solution is the primary obstacle to achieving high accuracy with standard BEM in domains with reentrant corners.\n\nThe explicit closed-form expression for the exponent $\\lambda(\\theta)$ is the leading term in the series of exponents $\\frac{n\\pi}{\\theta}$.", "answer": "$$\\boxed{\\frac{\\pi}{\\theta}}$$", "id": "2560760"}, {"introduction": "Theory becomes tangible through implementation and verification. This final practice challenges you to build a functional, Fourier-based BEM solver for a canonical two-dimensional coupling problem on a circular interface [@problem_id:2560737]. You will derive the exact Dirichlet-to-Neumann (DtN) map for the exterior domain and use a highly efficient spectral BEM implementation to enforce it numerically. This exercise provides invaluable experience in translating boundary integral operators into code and rigorously testing the results against an analytical solution.", "problem": "Consider the two-dimensional Laplace equation in the plane, with a circular interface of radius $a$ separating an interior disk $\\Omega^{-}$ and the unbounded exterior $\\Omega^{+}$. Let the outward unit normal $\\mathbf{n}$ point from $\\Omega^{-}$ into $\\Omega^{+}$. The potential $u$ satisfies $\\Delta u = 0$ in both $\\Omega^{-}$ and $\\Omega^{+}$. On the interface $\\Gamma = \\{ (x,y) : x^{2} + y^{2} = a^{2} \\}$, the continuity conditions for a perfect coupling without sources are the continuity of the trace $u^{-}|_{\\Gamma} = u^{+}|_{\\Gamma}$ and the balance of normal fluxes $q^{-} + q^{+} = 0$, where $q^{\\pm} = \\partial u^{\\pm} / \\partial \\mathbf{n}$ denotes the normal derivative taken with the normal pointing from $\\Omega^{-}$ to $\\Omega^{+}$. Assume the exterior solution in $\\Omega^{+}$ decays at infinity.\n\nStarting only from the following fundamental base:\n- The two-dimensional fundamental solution of the Laplace operator, $G(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi} \\ln \\lvert \\mathbf{x} - \\mathbf{y} \\rvert$.\n- Green’s identities and the boundary integral representation of harmonic functions.\n- The definitions of the single-layer and double-layer potentials and their boundary traces on smooth curves.\n\nDerive the boundary equation that couples the prescribed Dirichlet data $u|_{\\Gamma}$ on the circle to the unknown exterior Neumann data $q^{+}$ via boundary integral operators. Specialize this equation to the case of a circular interface and deduce the action of the exterior Dirichlet-to-Neumann map on Fourier modes $\\cos(n\\theta)$, where $\\theta$ is the polar angle on $\\Gamma$ measured in radians.\n\nThen implement a numerical scheme that uses this boundary integral coupling to enforce the exterior Dirichlet-to-Neumann map for the exterior domain. For the interior field, use the analytic harmonic polynomial $u^{-}(r,\\theta) = r^{n} \\cos(n\\theta)$ in polar coordinates $(r,\\theta)$; this provides the boundary Dirichlet data $g(\\theta) = u^{-}(a,\\theta)$ and the interior normal flux $q^{-}(\\theta) = \\partial u^{-}/\\partial r \\big|_{r=a}$. Use a Fourier-based implementation of the boundary integral coupling specialized to the circle to map $g(\\theta)$ to an approximation of the exterior flux $q^{+}(\\theta)$, and verify both:\n- That the numerically enforced Dirichlet-to-Neumann map for the exterior agrees with the exact map derived from first principles.\n- That the coupling condition $q^{-} + q^{+} = 0$ holds on $\\Gamma$.\n\nYour program must:\n- Parameterize the circle $\\Gamma$ by $N$ equispaced angles $\\theta_{j} = 2\\pi j / N$ for $j = 0,\\dots,N-1$ (angles in radians), sample $g(\\theta_{j})$ on these points, and compute the numerical exterior Neumann data $q^{+}_{\\mathrm{num}}(\\theta_{j})$ using a Fourier-symbol application of the boundary integral coupling specialized to the circle.\n- Compute the exact exterior Neumann data $q^{+}_{\\mathrm{exact}}(\\theta_{j})$ corresponding to $g(\\theta)$ obtained from $u^{-}(r,\\theta) = r^{n}\\cos(n\\theta)$, based on your derivation of the exact Dirichlet-to-Neumann map for the circle.\n- Report two scalar errors for each test case:\n  1. The maximum absolute error of the exterior Dirichlet-to-Neumann map on the nodes, $E_{\\mathrm{DtN}} = \\max_{j} \\lvert q^{+}_{\\mathrm{num}}(\\theta_{j}) - q^{+}_{\\mathrm{exact}}(\\theta_{j}) \\rvert$.\n  2. The maximum absolute violation of the coupling condition, $E_{\\mathrm{cpl}} = \\max_{j} \\lvert q^{-}(\\theta_{j}) + q^{+}_{\\mathrm{num}}(\\theta_{j}) \\rvert$.\n\nTest suite:\n- Use the following parameter triples $(a,n,N)$:\n  1. $(a,n,N) = (1.0, 1, 128)$.\n  2. $(a,n,N) = (1.0, 5, 128)$.\n  3. $(a,n,N) = (2.0, 3, 128)$.\n  4. $(a,n,N) = (1.0, 30, 64)$.\n  5. $(a,n,N) = (1.0, 10, 16)$.\nThese cover a typical case, higher harmonics, a different radius, a near-Nyquist mode, and an under-resolved edge case, respectively.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each item is a two-element list of floats $[E_{\\mathrm{DtN}}, E_{\\mathrm{cpl}}]$ for the corresponding test case, in the order listed above. For example: [[e1_dtn,e1_cpl],[e2_dtn,e2_cpl],...].\n\nNo external input is required. All angles must be treated in radians, and no physical units are involved; all quantities are dimensionless. The code must be fully self-contained and runnable as provided.", "solution": "The problem requires the derivation and numerical implementation of a boundary integral equation (BIE) method to determine the exterior Dirichlet-to-Neumann (DtN) map for the 2D Laplace equation on a circular interface.\n\n### Part 1: Derivation of the Boundary Integral Equation\n\nLet $\\Omega^{-}$ be the interior disk of radius $a$ and $\\Omega^{+}$ be the unbounded exterior region. The interface is the circle $\\Gamma$. The potential $u$ is harmonic, i.e., $\\Delta u = 0$, in $\\Omega^{-}$ and $\\Omega^{+}$. Let $g = u|_{\\Gamma}$ be the Dirichlet data on the interface, and let $q^{\\pm} = \\partial u^{\\pm}/\\partial\\mathbf{n}$ be the normal derivatives, where $\\mathbf{n}$ is the outward normal from $\\Omega^{-}$.\n\nGreen's third identity for a harmonic function $u$ in a domain $\\Omega$ with boundary $\\partial\\Omega$ is:\n$$\nu(\\mathbf{x}) = \\int_{\\partial\\Omega} \\left( G(\\mathbf{x}, \\mathbf{y}) \\frac{\\partial u}{\\partial \\mathbf{n}_{\\mathbf{y}}}(\\mathbf{y}) - u(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial \\mathbf{n}_{\\mathbf{y}}} \\right) dS_{\\mathbf{y}}, \\quad \\mathbf{x} \\in \\Omega\n$$\nwhere $G(\\mathbf{x}, \\mathbf{y}) = -\\frac{1}{2\\pi} \\ln|\\mathbf{x} - \\mathbf{y}|$ is the fundamental solution and $\\mathbf{n}_{\\mathbf{y}}$ is the outward normal at $\\mathbf{y} \\in \\partial\\Omega$.\n\nWe apply this identity to the exterior domain $\\Omega^{+}$. The boundary of $\\Omega^{+}$ is $\\Gamma \\cup \\Gamma_{\\infty}$, where $\\Gamma_{\\infty}$ is a circle at infinity. The normal vector pointing out of $\\Omega^{+}$ is $-\\mathbf{n}$ on $\\Gamma$. The contribution from $\\Gamma_{\\infty}$ vanishes due to the decay condition on $u^{+}$. We assume a standard decay condition, ensuring $u \\to 0$ at infinity. Applying Green's identity to $u^{+}$ in $\\Omega^{+}$ for a point $\\mathbf{x} \\in \\Omega^{+}$:\n$$\nu^{+}(\\mathbf{x}) = \\int_{\\Gamma} \\left( G(\\mathbf{x}, \\mathbf{y}) \\frac{\\partial u^{+}}{\\partial (-\\mathbf{n})}(\\mathbf{y}) - u^{+}(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial (-\\mathbf{n})} \\right) dS_{\\mathbf{y}}\n$$\nSubstituting $g=u^{+}|_{\\Gamma}$, $q^{+} = \\partial u^{+}/\\partial\\mathbf{n}$, and $\\partial/\\partial(-\\mathbf{n}) = -\\partial/\\partial\\mathbf{n}$:\n$$\nu^{+}(\\mathbf{x}) = \\int_{\\Gamma} \\left( -G(\\mathbf{x}, \\mathbf{y}) q^{+}(\\mathbf{y}) + g(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial \\mathbf{n}_{\\mathbf{y}}} \\right) dS_{\\mathbf{y}}\n$$\nLet us define the single-layer potential operator $\\mathcal{S}_{\\Gamma}$ and double-layer potential operator $\\mathcal{D}_{\\Gamma}$:\n$$\n(\\mathcal{S}_{\\Gamma} \\sigma)(\\mathbf{x}) = \\int_{\\Gamma} G(\\mathbf{x}, \\mathbf{y}) \\sigma(\\mathbf{y}) dS_{\\mathbf{y}}\n$$\n$$\n(\\mathcal{D}_{\\Gamma} \\mu)(\\mathbf{x}) = \\int_{\\Gamma} \\mu(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial \\mathbf{n}_{\\mathbf{y}}} dS_{\\mathbf{y}}\n$$\nThe representation for $u^{+}$ is thus $u^{+}(\\mathbf{x}) = -(\\mathcal{S}_{\\Gamma} q^{+})(\\mathbf{x}) + (\\mathcal{D}_{\\Gamma} g)(\\mathbf{x})$ for $\\mathbf{x} \\in \\Omega^{+}$.\n\nTo obtain a boundary integral equation, we take the limit as $\\mathbf{x} \\to \\mathbf{p} \\in \\Gamma$ from the exterior $\\Omega^{+}$. Using the standard jump relations for layer potentials on a smooth boundary:\n$$\n\\lim_{\\mathbf{x} \\to \\mathbf{p}^{+}} (\\mathcal{S}_{\\Gamma} \\sigma)(\\mathbf{x}) = (S_{\\Gamma} \\sigma)(\\mathbf{p})\n$$\n$$\n\\lim_{\\mathbf{x} \\to \\mathbf{p}^{+}} (\\mathcal{D}_{\\Gamma} \\mu)(\\mathbf{x}) = (K_{\\Gamma} \\mu)(\\mathbf{p}) + \\frac{1}{2}\\mu(\\mathbf{p})\n$$\nwhere $S_{\\Gamma}$ and $K_{\\Gamma}$ are the boundary integral operators (the non-singular parts of the potentials on $\\Gamma$). Applying these limits to the representation of $u^{+}$:\n$$\ng(\\mathbf{p}) = -(S_{\\Gamma} q^{+})(\\mathbf{p}) + \\left((K_{\\Gamma} g)(\\mathbf{p}) + \\frac{1}{2}g(\\mathbf{p})\\right)\n$$\nRearranging gives the desired boundary integral equation coupling the Dirichlet data $g$ to the exterior Neumann data $q^{+}$:\n$$\n\\left(\\frac{1}{2}I - K_{\\Gamma}\\right)g = -S_{\\Gamma} q^{+}\n$$\n\n### Part 2: Specialization to a Circle and the DtN Map\n\nFor a circular boundary of radius $a$, the operators $S_{\\Gamma}$ and $K_{\\Gamma}$ are convolution operators and are diagonalized by the complex Fourier basis $\\{e^{ik\\theta}\\}_{k \\in \\mathbb{Z}}$. We find their eigenvalues (symbols), denoted $\\hat{S}_k$ and $\\hat{K}_k$.\nThe kernel of $K_{\\Gamma}$ is constant for a circle, $K(\\mathbf{x},\\mathbf{y}) = \\frac{\\partial G}{\\partial n_y} = -\\frac{1}{4\\pi a}$. Its symbol is:\n$$\n\\hat{K}_k =\n\\begin{cases}\n-1/2 & \\text{if } k=0 \\\\\n0 & \\text{if } k \\neq 0\n\\end{cases}\n$$\nThe kernel of $S_{\\Gamma}$ is $G(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi} \\ln \\lvert \\mathbf{x} - \\mathbf{y} \\rvert = -\\frac{1}{2\\pi} \\ln \\left( 2a \\left|\\sin\\left(\\frac{\\theta'-\\theta}{2}\\right)\\right| \\right)$. Its symbol is:\n$$\n\\hat{S}_k =\n\\begin{cases}\n-a\\ln a & \\text{if } k=0 \\text{ and } a \\neq 1 \\\\\na/(2|k|) & \\text{if } k \\neq 0\n\\end{cases}\n$$\nFor $a=1$, a special case related to the capacity of the unit circle implies a specific compatibility condition on the data, but we proceed with the general formula as the code handles it.\n\nThe BIE in Fourier space becomes an algebraic equation for the Fourier coefficients $\\hat{g}_k$ and $\\hat{q}^{+}_k$:\n$$\n(\\frac{1}{2} - \\hat{K}_k)\\hat{g}_k = -\\hat{S}_k \\hat{q}^{+}_k\n$$\nWe can now solve for $\\hat{q}^{+}_k$, which defines the DtN map $\\Lambda^{+}: g \\mapsto q^{+}$.\n\nFor $k \\neq 0$:\n$$\n(\\frac{1}{2} - 0)\\hat{g}_k = -\\frac{a}{2|k|} \\hat{q}^{+}_k \\quad \\implies \\quad \\hat{q}^{+}_k = -\\frac{|k|}{a}\\hat{g}_k\n$$\n\nThe problem specifies boundary data derived from an interior solution $u^{-}(r,\\theta)=r^n\\cos(n\\theta)$, so $g(\\theta)=a^n\\cos(n\\theta)$. For $n>0$, this function has zero mean, so $\\hat{g}_0=0$, which in turn implies $\\hat{q}^{+}_0=0$. We do not need to analyze the $k=0$ case further for the given test cases.\n\nLet's find the action of $\\Lambda^{+}$ on $g(\\theta) = a^n \\cos(n\\theta)$.\n$g(\\theta) = \\frac{a^n}{2}(e^{in\\theta} + e^{-in\\theta})$. The mode $e^{in\\theta}$ for $g$ maps to $-\\frac{|n|}{a}e^{in\\theta}$ for $q^+$. Linearity implies:\n$$\n\\Lambda^{+}(a^n\\cos(n\\theta)) = a^n \\Lambda^{+}(\\cos(n\\theta)) = a^n \\left( -\\frac{n}{a} \\cos(n\\theta) \\right) = -n a^{n-1} \\cos(n\\theta)\n$$\nThis is the exact exterior Neumann data, $q^{+}_{\\mathrm{exact}}(\\theta)$.\n\n### Part 3: Numerical Implementation and Verification\n\nThe numerical scheme proceeds as follows:\n1. Discretize $\\Gamma$ with $N$ points $\\theta_j = 2\\pi j/N$. Sample $g(\\theta_j) = a^n \\cos(n\\theta_j)$.\n2. Compute the Discrete Fourier Transform (DFT) of $g$, yielding $\\hat{g}_k$.\n3. Apply the DtN map in Fourier space: for each wavenumber $k$, compute $\\hat{q}^{+}_{k, \\text{num}} = - \\frac{|k|}{a} \\hat{g}_k$. For $k=0$, $\\hat{q}^{+}_{0, \\text{num}}=0$.\n4. Compute the numerical exterior flux $q^{+}_{\\mathrm{num}}$ by applying the Inverse DFT to $\\hat{q}^{+}_{k, \\text{num}}$.\n5. Compute the exact interior flux $q^{-}(\\theta_j) = \\partial_r(r^n\\cos(n\\theta))|_{r=a} = na^{n-1}\\cos(n\\theta_j)$.\n6. Compute the exact exterior flux $q^{+}_{\\mathrm{exact}}(\\theta_j) = -na^{n-1}\\cos(n\\theta_j) = -q^{-}(\\theta_j)$.\n7. Calculate the errors:\n   - $E_{\\mathrm{DtN}} = \\max_{j} \\lvert q^{+}_{\\mathrm{num}}(\\theta_{j}) - q^{+}_{\\mathrm{exact}}(\\theta_{j}) \\rvert$\n   - $E_{\\mathrm{cpl}} = \\max_{j} \\lvert q^{-}(\\theta_{j}) + q^{+}_{\\mathrm{num}}(\\theta_{j}) \\rvert$\n\nAs $q^{-}(\\theta_j) = -q^{+}_{\\mathrm{exact}}(\\theta_j)$, the two error metrics are mathematically equivalent:\n$E_{\\mathrm{cpl}} = \\max_{j} \\lvert -q^{+}_{\\mathrm{exact}}(\\theta_{j}) + q^{+}_{\\mathrm{num}}(\\theta_{j}) \\rvert = E_{\\mathrm{DtN}}$.\nThe numerical implementation will confirm this. The error arises from the discretization of the Fourier transform and floating-point arithmetic. For the under-resolved case ($n > N/2$), aliasing will be the dominant source of error.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    This program implements a Fourier-based boundary integral method to solve for the\n    exterior Dirichlet-to-Neumann (DtN) map for the 2D Laplace equation on a circle.\n    It verifies the numerical DtN map against the exact analytical map for specific\n    harmonic boundary data derived from an interior solution.\n    \"\"\"\n\n    # Test suite: (a, n, N)\n    # a: radius of the circular interface\n    # n: mode number of the harmonic data (cos(n*theta))\n    # N: number of discretization points on the circle\n    test_cases = [\n        (1.0, 1, 128),\n        (1.0, 5, 128),\n        (2.0, 3, 128),\n        (1.0, 30, 64),\n        (1.0, 10, 16),\n    ]\n\n    results = []\n\n    for a, n, N in test_cases:\n        # 1. Discretize the boundary and define data from the interior problem.\n        # N equispaced points on the circle of radius a.\n        theta = 2 * np.pi * np.arange(N) / N\n\n        # The interior potential is u^-(r, theta) = r^n * cos(n*theta).\n        # This provides the Dirichlet data g(theta) on the boundary r=a.\n        g = (a**n) * np.cos(n * theta)\n\n        # The interior normal flux is q^-(theta) = du^-/dr |_(r=a).\n        # For n=0, q- is 0. For n>0, it is n*a^(n-1)*cos(n*theta).\n        if n == 0:\n            q_minus = np.zeros(N)\n        else:\n            q_minus = n * (a**(n - 1)) * np.cos(n * theta)\n\n        # 2. Compute the numerical exterior flux q_plus_num using BIE in Fourier space.\n        # The BIE relating exterior flux q+ to Dirichlet data g is:\n        # (1/2 * I - K) * g = -S * q+\n        # This implies the DtN map in Fourier space for mode k is:\n        # q_hat_k = -inv(S_k) * (1/2 - K_k) * g_hat_k\n        \n        g_hat = np.fft.fft(g)\n        k = np.fft.fftfreq(N) * N\n\n        # The DtN map symbol (eigenvalue) for mode k is -(k/a).\n        # For k=0, the map is more complex, but for mean-zero data, flux is mean-zero.\n        # Since n>0 for all test cases, g has zero mean, so g_hat[0] is zero.\n        # This implies q_plus_hat_num[0] is also zero.\n        \n        dtn_symbol = np.zeros(N, dtype=float)\n        k_nonzero_indices = np.where(k != 0)\n        k_nonzero = k[k_nonzero_indices]\n        dtn_symbol[k_nonzero_indices] = -np.abs(k_nonzero) / a\n        \n        q_plus_hat_num = dtn_symbol * g_hat\n\n        # Transform back to physical space. Result should be real.\n        q_plus_num = np.fft.ifft(q_plus_hat_num).real\n\n        # 3. Compute the exact exterior flux q_plus_exact.\n        # The exterior solution is u^+(r,theta) = a^(2n)*r^(-n)*cos(n*theta).\n        # q_plus_exact = du+/dr |_(r=a) = -n*a^(n-1)*cos(n*theta).\n        if n == 0:\n            q_plus_exact = np.zeros(N)\n        else:\n            q_plus_exact = -n * (a**(n - 1)) * np.cos(n * theta)\n        \n        # 4. Calculate errors.\n        # Error 1: DtN map error\n        e_dtn = np.max(np.abs(q_plus_num - q_plus_exact))\n\n        # Error 2: Coupling condition violation\n        e_cpl = np.max(np.abs(q_minus + q_plus_num))\n        \n        results.append([e_dtn, e_cpl])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(res) for res in results)}]\")\n\nsolve()\n```", "id": "2560737"}]}