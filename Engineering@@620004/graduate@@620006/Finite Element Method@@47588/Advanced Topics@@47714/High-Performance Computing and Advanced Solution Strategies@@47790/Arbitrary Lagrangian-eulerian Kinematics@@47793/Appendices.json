{"hands_on_practices": [{"introduction": "The first step in mastering the Arbitrary Lagrangian-Eulerian (ALE) method is understanding how governing equations transform from a fixed (Eulerian) to a moving reference frame. This foundational practice guides you to derive the ALE form of a simple advection equation from first principles [@problem_id:2541251]. The goal is to see how mesh velocity, $w$, alters the transport equation and gives rise to the crucial concept of the relative convective velocity, which is central to all ALE formulations.", "problem": "Consider the one-dimensional linear advection of a scalar field $u(x,t)$ in a physical (spatial) frame on the interval $x \\in (0,L(t))$, governed in the spatial frame by the conservation law $\\frac{\\partial u}{\\partial t} + a \\,\\frac{\\partial u}{\\partial x} = 0$, where $a$ is a spatially uniform constant advection speed relative to the spatial frame. The computational mesh is allowed to move according to an Arbitrary Lagrangian-Eulerian (ALE) mapping $x = \\chi(X,t)$ from a fixed referential coordinate $X \\in (0,L_{0})$ to the physical coordinate $x$, with mesh velocity defined kinematically as $w(x,t) = \\left.\\frac{\\partial \\chi}{\\partial t}\\right|_{X}$ evaluated at the current spatial position $x = \\chi(X,t)$. \n\nStarting strictly from fundamental kinematics and calculus (in particular, the chain rule for multivariable functions and the definition of the mesh velocity as the time rate of change of the ALE mapping at fixed referential coordinate), and without assuming any ALE-form transport identity, derive the strong form of the advection equation expressed in the ALE frame, namely as an equation involving the time derivative of $u$ at fixed referential coordinate $X$ and spatial gradients with respect to $x$. In your derivation, clearly identify the function that multiplies $\\frac{\\partial u}{\\partial x}$ in the ALE strong form as an effective advection speed.\n\nYour final answer must be the analytical expression for this effective advection speed $v_{\\mathrm{eff}}(x,t)$ in terms of $a$ and $w(x,t)$. Provide only this expression as your final answer. No numerical evaluation is required.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It presents a standard derivation in the field of continuum mechanics and computational methods, specifically concerning Arbitrary Lagrangian-Eulerian (ALE) kinematics. There are no logical contradictions, missing information, or violations of fundamental principles. The problem is valid and a solution will be derived.\n\nThe objective is to derive the strong form of the one-dimensional linear advection equation in the ALE reference frame, starting from the given equation in the spatial (Eulerian) frame.\n\nThe governing equation in the spatial frame is:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\nHere, the scalar field $u$ is considered a function of the spatial coordinate $x$ and time $t$, so $u = u(x,t)$. The partial derivative $\\frac{\\partial u}{\\partial t}$ is therefore taken at a fixed spatial position $x$. This is the Eulerian time derivative.\n\nThe ALE formulation introduces a referential coordinate $X$, which is fixed for a given mesh point. The physical position $x$ of this mesh point is given by the mapping $x = \\chi(X,t)$. The scalar field $u$ can now be considered a function of the referential coordinate $X$ and time $t$, which we may denote as $\\hat{u}(X,t) = u(\\chi(X,t), t)$.\n\nThe problem asks for an equation involving the time derivative of $u$ at a fixed referential coordinate $X$. This is the ALE time derivative, $\\left.\\frac{\\partial u}{\\partial t}\\right|_{X}$, which corresponds to the time derivative of $\\hat{u}$ with respect to $t$ holding $X$ constant:\n$$\n\\left.\\frac{\\partial u}{\\partial t}\\right|_{X} \\equiv \\frac{\\partial \\hat{u}}{\\partial t}(X,t) = \\frac{\\partial}{\\partial t} \\left[ u(\\chi(X,t), t) \\right]\n$$\nWe apply the chain rule for multivariable functions to the right-hand side. The function $u$ depends on time $t$ through its first argument, $\\chi(X,t)$, and its second argument, $t$.\n$$\n\\left.\\frac{\\partial u}{\\partial t}\\right|_{X} = \\frac{\\partial u}{\\partial x} \\frac{\\partial \\chi}{\\partial t} + \\frac{\\partial u}{\\partial t} \\frac{dt}{dt}\n$$\nIn this expression, $\\frac{\\partial u}{\\partial x}$ and $\\frac{\\partial u}{\\partial t}$ are the partial derivatives of $u(x,t)$ with respect to its arguments, evaluated at $(x,t) = (\\chi(X,t), t)$. The derivative $\\frac{\\partial \\chi}{\\partial t}$ is taken holding $X$ fixed. The problem defines this quantity as the mesh velocity, $w(x,t)$:\n$$\nw(x,t) = \\left.\\frac{\\partial \\chi}{\\partial t}\\right|_{X}\n$$\nThe derivative $\\frac{\\partial u}{\\partial t}$ on the right-hand side of the chain rule expansion is the rate of change of $u$ at a fixed spatial position $x$, which is the Eulerian time derivative. Substituting the definition of the mesh velocity, we obtain the fundamental kinematic relationship between the ALE (or material) time derivative and the Eulerian (or spatial) time derivative:\n$$\n\\left.\\frac{\\partial u}{\\partial t}\\right|_{X} = \\left.\\frac{\\partial u}{\\partial t}\\right|_{x} + w(x,t) \\frac{\\partial u}{\\partial x}\n$$\nTo find the governing equation in the ALE frame, we must substitute the Eulerian time derivative from the original conservation law. First, we rearrange the kinematic relationship to solve for the Eulerian time derivative:\n$$\n\\left.\\frac{\\partial u}{\\partial t}\\right|_{x} = \\left.\\frac{\\partial u}{\\partial t}\\right|_{X} - w(x,t) \\frac{\\partial u}{\\partial x}\n$$\nNow, substitute this expression into the given spatial conservation law, $\\left.\\frac{\\partial u}{\\partial t}\\right|_{x} + a \\frac{\\partial u}{\\partial x} = 0$:\n$$\n\\left( \\left.\\frac{\\partial u}{\\partial t}\\right|_{X} - w(x,t) \\frac{\\partial u}{\\partial x} \\right) + a \\frac{\\partial u}{\\partial x} = 0\n$$\nFinally, we group the terms containing the spatial gradient $\\frac{\\partial u}{\\partial x}$ to obtain the strong form of the advection equation in the ALE frame:\n$$\n\\left.\\frac{\\partial u}{\\partial t}\\right|_{X} + (a - w(x,t)) \\frac{\\partial u}{\\partial x} = 0\n$$\nThis equation describes the evolution of the scalar field $u$ as observed from the moving computational mesh. The term multiplying the spatial gradient $\\frac{\\partial u}{\\partial x}$ represents the velocity of the advected quantity relative to the moving mesh. This is the effective advection speed, $v_{\\mathrm{eff}}(x,t)$.\n\nBy inspection, the effective advection speed is:\n$$\nv_{\\mathrm{eff}}(x,t) = a - w(x,t)\n$$\nThis result is physically intuitive: $a$ is the velocity of the fluid in the stationary frame, and $w(x,t)$ is the velocity of the mesh a point is convected with, and the rate of transport observed in the mesh frame is driven by the relative velocity between the fluid and the mesh, which is $a - w(x,t)$.", "answer": "$$\\boxed{a - w(x,t)}$$", "id": "2541251"}, {"introduction": "Building upon the concept of relative convective velocity, $v^{\\mathrm{rel}} = v - w$, this practice explores a critical and often counter-intuitive consequence for defining boundary conditions. Mesh motion can be prescribed such that a physical outflow boundary (where $v \\cdot n \\gt 0$) becomes an inflow boundary in the computational frame (where $v^{\\mathrm{rel}} \\cdot n \\lt 0$). Analyzing this scenario [@problem_id:2541226] is essential for understanding how to formulate well-posed boundary value problems and ensure the stability of numerical schemes in complex ALE simulations.", "problem": "Consider a conserved scalar field $u$ transported by a fluid with physical velocity $v$ in a time-dependent spatial domain $\\Omega(t)$ that is discretized with an Arbitrary Lagrangian-Eulerian (ALE) mesh moving with prescribed mesh velocity $w$. Let $\\Gamma(t)=\\partial\\Omega(t)$ denote the boundary with outward unit normal $n$. The relative convective velocity is defined by $v^{\\mathrm{rel}}:=v-w$. Assume negligible diffusion on a portion of the boundary and consider an open boundary subset $\\Gamma_{o}(t)\\subset\\Gamma(t)$ that is initially intended to be an outflow boundary according to the physical velocity, in the sense that $v\\cdot n>0$ on $\\Gamma_{o}(t)$. However, due to the prescribed mesh motion, there exists a time interval and a nontrivial subset $\\Gamma_{o}^{-}(t)\\subset\\Gamma_{o}(t)$ where $w\\cdot n>v\\cdot n$, so that $v^{\\mathrm{rel}}\\cdot n<0$ holds on $\\Gamma_{o}^{-}(t)$. Starting from the Reynolds transport theorem and the definition of relative convective flux in ALE kinematics, reason about the well-posedness of the transport problem and the stability of standard finite element semidiscretizations that use upwinding based on the sign of a convective normal flux. Then decide which of the following statements correctly describe the consequences and appropriate remedies when $v^{\\mathrm{rel}}\\cdot n$ changes sign due to $w$ locally exceeding $v$ on a boundary that was originally designated as an outflow.\n\nA. For the purposes of boundary classification in the ALE transport operator, $\\Gamma_{o}^{-}(t)$ must be treated as an inflow boundary because $v^{\\mathrm{rel}}\\cdot n<0$, and suitable inflow data (e.g., Dirichlet or characteristic) for $u$ must be prescribed there; otherwise, the initial outflow-type condition is incompatible and can lead to loss of well-posedness and energy growth.\n\nB. It is sufficient to keep the original outflow classification on $\\Gamma_{o}(t)$ based on the sign of $v\\cdot n$, because the physical flow is still outward; the mismatch $v^{\\mathrm{rel}}\\cdot n<0$ does not affect stability or weak formulations that are posed on the moving mesh.\n\nC. In a consistent upwind finite element or finite volume discretization of the ALE formulation, the numerical flux at the boundary depends on the sign of $v^{\\mathrm{rel}}\\cdot n$, so when $v^{\\mathrm{rel}}\\cdot n<0$ on $\\Gamma_{o}^{-}(t)$ the boundary must supply exterior data for $u$; using the interior state alone would be inconsistent with the direction of characteristics relative to the moving mesh.\n\nD. Enforcing the Geometric Conservation Law (GCL) exactly is sufficient to prevent the sign change of $v^{\\mathrm{rel}}\\cdot n$ produced by the mesh motion; thus, with GCL, the outflow classification based on $v\\cdot n$ remains valid for the ALE formulation.\n\nE. A robust remedy is to constrain the normal component of the mesh velocity at intended outflow boundaries, for example by enforcing $w\\cdot n=v\\cdot n$ (or $w\\cdot n\\le v\\cdot n$), so that $v^{\\mathrm{rel}}\\cdot n\\ge 0$ and the boundary remains outflow in the ALE sense; alternatively, one may adopt characteristic open-boundary conditions that dynamically switch type with the sign of $v^{\\mathrm{rel}}\\cdot n$.\n\nSelect all correct statements.", "solution": "We begin from first principles. The Reynolds transport theorem applied to a scalar field $u$ over a time-dependent control volume $\\Omega(t)$ with boundary velocity $w$ gives that the time rate of change of the integral of $u$ over $\\Omega(t)$ equals the integral over $\\Omega(t)$ of the local time derivative plus the net flux through the boundary accounting for the motion. In differential form for a purely advective process with physical velocity $v$, the Arbitrary Lagrangian-Eulerian (ALE) formulation writes the conservation law as\n$$\n\\partial_{t} u\\big|_{X} + \\nabla\\cdot\\big(u\\, v^{\\mathrm{rel}}\\big) \\;=\\; 0,\n$$\nwhere $v^{\\mathrm{rel}} := v - w$ is the relative convective velocity and $\\partial_{t}\\big|_{X}$ denotes the time derivative at fixed referential coordinate. In integral form over $\\Omega(t)$, with outward unit normal $n$ on $\\partial\\Omega(t)$, this reads\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_{\\Omega(t)} u \\,\\mathrm{d}x \\;+\\; \\int_{\\partial\\Omega(t)} u\\, (v^{\\mathrm{rel}}\\cdot n)\\, \\mathrm{d}s \\;=\\; 0.\n$$\nThus, the normal convective flux through the boundary is governed by $v^{\\mathrm{rel}}\\cdot n$, not by $v\\cdot n$ alone. The sign of $v^{\\mathrm{rel}}\\cdot n$ determines whether characteristics are entering or leaving the moving domain relative to the ALE frame.\n\nTo analyze stability, consider the $L^{2}$-energy method for the scalar advection equation in the ALE frame with negligible diffusion. Multiply the differential equation by $u$ and integrate over $\\Omega(t)$. Accounting for domain motion via Reynolds transport and integration by parts of the divergence term yields\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{1}{2}\\int_{\\Omega(t)} u^{2}\\,\\mathrm{d}x\\right) \\;+\\; \\frac{1}{2}\\int_{\\partial\\Omega(t)} u^{2}\\, (v^{\\mathrm{rel}}\\cdot n)\\, \\mathrm{d}s \\;=\\; 0,\n$$\nunder the assumption that the mesh motion satisfies the Geometric Conservation Law so that constant solutions are preserved. The boundary contribution involves $v^{\\mathrm{rel}}\\cdot n$. For stability without externally supplied boundary control, one requires that the net boundary term be nonnegative outflow, i.e., $v^{\\mathrm{rel}}\\cdot n\\ge 0$ on parts where no Dirichlet inflow data is prescribed. If $v^{\\mathrm{rel}}\\cdot n<0$ on a portion of the boundary, then energy enters through that portion unless the entering state is prescribed or otherwise controlled.\n\nIn a finite element or finite volume discretization with upwind numerical fluxes consistent with characteristics, the boundary numerical flux is built using the sign of $v^{\\mathrm{rel}}\\cdot n$. If $v^{\\mathrm{rel}}\\cdot n<0$, the incoming state must be provided by boundary data; otherwise, using the interior state would contradict the direction of information propagation, yielding inconsistency and potential instability.\n\nWith this foundation, we assess each statement:\n\nA. This statement asserts that when $v^{\\mathrm{rel}}\\cdot n<0$ on $\\Gamma_{o}^{-}(t)$, the boundary must be treated as inflow for the ALE transport operator, and appropriate inflow data should be imposed. This follows directly from the integral and energy identities above: the boundary flux is $u (v^{\\mathrm{rel}}\\cdot n)$ and the energy boundary term is $\\frac{1}{2}u^{2}(v^{\\mathrm{rel}}\\cdot n)$. A negative sign corresponds to incoming characteristics relative to the moving mesh, and failing to prescribe the entering state leads to ill-posedness and energy growth. Therefore, A is Correct.\n\nB. This statement claims that maintaining the outflow classification based on $v\\cdot n$ is sufficient and that $v^{\\mathrm{rel}}\\cdot n<0$ does not affect stability. This contradicts the ALE conservation law: the flux and characteristics that matter for the transport through the moving boundary are governed by $v^{\\mathrm{rel}}$, not $v$. If $v^{\\mathrm{rel}}\\cdot n<0$, then characteristics enter the domain in the ALE frame, and keeping an outflow-type (do-nothing) condition is incompatible and can destabilize the scheme. Therefore, B is Incorrect.\n\nC. This statement describes the dependence of upwind numerical fluxes on the sign of $v^{\\mathrm{rel}}\\cdot n$ and the consequent need for exterior boundary data if the sign is negative. This is consistent with characteristic-based discretizations: at a boundary face, the upwind state is taken from the exterior when the normal convective speed $v^{\\mathrm{rel}}\\cdot n$ is negative. Hence, when $v^{\\mathrm{rel}}\\cdot n<0$ on $\\Gamma_{o}^{-}(t)$, boundary data must be provided. Therefore, C is Correct.\n\nD. This statement attributes to the Geometric Conservation Law the prevention of sign changes in $v^{\\mathrm{rel}}\\cdot n$. The Geometric Conservation Law ensures that constant solutions are preserved under mesh motion and that metric terms are handled consistently; it does not constrain $w$ relative to $v$ nor does it prevent $w\\cdot n>v\\cdot n$. Thus, GCL does not preclude $v^{\\mathrm{rel}}\\cdot n$ from changing sign. Therefore, D is Incorrect.\n\nE. This statement proposes remedies: constraining the mesh normal velocity so that $w\\cdot n=v\\cdot n$ (or $w\\cdot n\\le v\\cdot n$) at intended outflow boundaries, which implies $v^{\\mathrm{rel}}\\cdot n\\ge 0$, preserving outflow classification in the ALE sense; alternatively, using characteristic open boundary conditions that switch type with the sign of $v^{\\mathrm{rel}}\\cdot n$. These are established practices. Enforcing $w\\cdot n=v\\cdot n$ at outflow makes the relative normal speed zero, eliminating convective exchange across the moving boundary. Allowing $w\\cdot n\\le v\\cdot n$ ensures nonnegative relative outflow. Dynamic characteristic conditions are also consistent with the energy analysis. Therefore, E is Correct.\n\nIn summary, the correct statements are A, C, and E.", "answer": "$$\\boxed{ACE}$$", "id": "2541226"}, {"introduction": "Transitioning from continuous ALE equations to a robust finite element code requires careful treatment of the geometric terms arising from the mesh mapping. This advanced exercise provides hands-on practice with the linearization of the pullback of a weak form with respect to the mesh nodal coordinates [@problem_id:2541234]. Successfully performing this calculation is a key step in developing implicit solvers, particularly for fluid-structure interaction problems where the mesh configuration is part of the solution.", "problem": "Consider an Arbitrary Lagrangian-Eulerian (ALE) pullback of a scalar weak form over the reference triangle $\\hat{K} \\subset \\mathbb{R}^{2}$ with vertices at $(0,0)$, $(1,0)$, and $(0,1)$. Let the mesh motion mapping be the linear finite element map $X_{\\chi}(\\hat{\\boldsymbol{x}}) = \\sum_{a=1}^{3} \\boldsymbol{x}_{a} N_{a}(\\hat{\\boldsymbol{x}})$ with nodal positions $\\boldsymbol{x}_{1} = (0,0)$, $\\boldsymbol{x}_{2} = (2,0)$, and $\\boldsymbol{x}_{3} = (0,1)$, where the standard linear shape functions on $\\hat{K}$ are $N_{1}(\\hat{\\boldsymbol{x}}) = 1 - \\hat{\\xi} - \\hat{\\eta}$, $N_{2}(\\hat{\\boldsymbol{x}}) = \\hat{\\xi}$, and $N_{3}(\\hat{\\boldsymbol{x}}) = \\hat{\\eta}$ with $\\hat{\\boldsymbol{x}} = (\\hat{\\xi}, \\hat{\\eta})$. Denote by $F_{\\chi} = \\partial X_{\\chi}/\\partial \\hat{\\boldsymbol{x}}$ the deformation gradient of the mesh map and by $J_{\\chi} = \\det(F_{\\chi})$ its Jacobian determinant. Consider the following metric-weighted contribution to a residual component for a scalar field,\n$$\nR_{i}^{(\\text{metric})} = \\int_{\\hat{K}} J_{\\chi} \\left(F_{\\chi}^{-1} \\nabla_{\\hat{\\boldsymbol{x}}} N_{j}\\right) \\cdot \\boldsymbol{q}\\, N_{i}\\, \\mathrm{d}\\hat{\\boldsymbol{x}},\n$$\nwhere $\\boldsymbol{q} \\in \\mathbb{R}^{2}$ is a constant vector in physical space, $N_{i}$ is the test function, and $N_{j}$ is the trial function. For this problem, take $i=2$, $j=3$, and $\\boldsymbol{q} = (3,4)$.\n\nUsing only fundamental definitions and standard matrix calculus identities (namely, $F_{\\chi} = \\sum_{a} \\boldsymbol{x}_{a} \\otimes \\nabla_{\\hat{\\boldsymbol{x}}} N_{a}$, $J_{\\chi} = \\det(F_{\\chi})$, and the variations of determinant and matrix inverse), derive the linearization of $R_{2}^{(\\text{metric})}$ with respect to the mesh nodal degrees of freedom and evaluate the partial derivative of $R_{2}^{(\\text{metric})}$ with respect to the $x$-component of node $2$, i.e., compute\n$$\n\\frac{\\partial R_{2}^{(\\text{metric})}}{\\partial x_{2,1}}\n$$\nat the given nodal positions. Here $x_{2,1}$ denotes the first Cartesian component of $\\boldsymbol{x}_{2}$. Express your final answer as a single real number. No rounding is required.", "solution": "The problem requires the computation of the partial derivative of a residual component, $R_{2}^{(\\text{metric})}$, with respect to the first component of the second nodal coordinate, $x_{2,1}$. The residual component is given by:\n$$\nR_{i}^{(\\text{metric})} = \\int_{\\hat{K}} J_{\\chi} \\left(F_{\\chi}^{-1} \\nabla_{\\hat{\\boldsymbol{x}}} N_{j}\\right) \\cdot \\boldsymbol{q}\\, N_{i}\\, \\mathrm{d}\\hat{\\boldsymbol{x}}\n$$\nFor this problem, we are given $i=2$, $j=3$, and $\\boldsymbol{q} = (3,4)^T$. Thus, we have:\n$$\nR_{2}^{(\\text{metric})} = \\int_{\\hat{K}} J_{\\chi} \\left(F_{\\chi}^{-1} \\nabla_{\\hat{\\boldsymbol{x}}} N_{3}\\right) \\cdot \\boldsymbol{q}\\, N_{2}\\, \\mathrm{d}\\hat{\\boldsymbol{x}}\n$$\nTo find the derivative with respect to $x_{2,1}$, we can differentiate under the integral sign, as the domain of integration $\\hat{K}$ is fixed and does not depend on the mesh coordinates.\n$$\n\\frac{\\partial R_{2}^{(\\text{metric})}}{\\partial x_{2,1}} = \\int_{\\hat{K}} \\frac{\\partial}{\\partial x_{2,1}} \\left[ J_{\\chi} \\left(F_{\\chi}^{-1} \\nabla_{\\hat{\\boldsymbol{x}}} N_{3}\\right) \\cdot \\boldsymbol{q} \\right] N_{2}\\, \\mathrm{d}\\hat{\\boldsymbol{x}}\n$$\nThe expression within the brackets depends on $x_{2,1}$ through the deformation gradient $F_{\\chi}$ and its determinant $J_{\\chi}$. Let us first compute $F_{\\chi}$. The mesh mapping is $X_{\\chi}(\\hat{\\boldsymbol{x}}) = \\sum_{a=1}^{3} \\boldsymbol{x}_{a} N_{a}(\\hat{\\boldsymbol{x}})$. The deformation gradient is $F_{\\chi} = \\frac{\\partial X_{\\chi}}{\\partial \\hat{\\boldsymbol{x}}} = \\sum_{a=1}^{3} \\boldsymbol{x}_{a} \\otimes \\nabla_{\\hat{\\boldsymbol{x}}} N_{a}$.\nThe gradients of the linear shape functions are constant vectors:\n$\\nabla_{\\hat{\\boldsymbol{x}}} N_{1} = (-1, -1)^T$, $\\nabla_{\\hat{\\boldsymbol{x}}} N_{2} = (1, 0)^T$, $\\nabla_{\\hat{\\boldsymbol{x}}} N_{3} = (0, 1)^T$.\nThus, $F_{\\chi}$ is a constant matrix over the element $\\hat{K}$:\n$$\nF_{\\chi} = \\boldsymbol{x}_{1} \\otimes \\nabla_{\\hat{\\boldsymbol{x}}} N_{1}^T + \\boldsymbol{x}_{2} \\otimes \\nabla_{\\hat{\\boldsymbol{x}}} N_{2}^T + \\boldsymbol{x}_{3} \\otimes \\nabla_{\\hat{\\boldsymbol{x}}} N_{3}^T = \\begin{pmatrix} x_{2,1} - x_{1,1} & x_{3,1} - x_{1,1} \\\\ x_{2,2} - x_{1,2} & x_{3,2} - x_{1,2} \\end{pmatrix}\n$$\nSubstituting the given nodal positions $\\boldsymbol{x}_{1} = (0,0)$, $\\boldsymbol{x}_{2} = (2,0)$, and $\\boldsymbol{x}_{3} = (0,1)$:\n$$\nF_{\\chi} = \\begin{pmatrix} 2 - 0 & 0 - 0 \\\\ 0 - 0 & 1 - 0 \\end{pmatrix} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nThe Jacobian determinant is $J_{\\chi} = \\det(F_{\\chi}) = (2)(1) - (0)(0) = 2$.\nThe inverse of the deformation gradient is $F_{\\chi}^{-1} = \\frac{1}{2}\\begin{pmatrix} 1 & 0 \\\\ 0 & 2 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1 \\end{pmatrix}$.\n\nNext, we compute the derivatives of $F_{\\chi}$, $J_{\\chi}$, and $F_{\\chi}^{-1}$ with respect to $x_{2,1}$.\nThe derivative of $F_{\\chi}$ with respect to a nodal coordinate component $x_{b,k}$ is given by $\\frac{\\partial F_{\\chi}}{\\partial x_{b,k}} = \\boldsymbol{e}_{k} \\otimes \\nabla_{\\hat{\\boldsymbol{x}}} N_{b}$. For $b=2$ and $k=1$, we get:\n$$\n\\frac{\\partial F_{\\chi}}{\\partial x_{2,1}} = \\boldsymbol{e}_{1} \\otimes \\nabla_{\\hat{\\boldsymbol{x}}} N_{2} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\nUsing Jacobi's formula, $\\frac{\\partial J_{\\chi}}{\\partial x_{2,1}} = J_{\\chi} \\text{tr}\\left(F_{\\chi}^{-1} \\frac{\\partial F_{\\chi}}{\\partial x_{2,1}}\\right)$:\n$$\n\\frac{\\partial J_{\\chi}}{\\partial x_{2,1}} = 2 \\cdot \\text{tr}\\left( \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\right) = 2 \\cdot \\text{tr}\\left( \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 0 \\end{pmatrix} \\right) = 2 \\cdot \\frac{1}{2} = 1\n$$\nThe derivative of the inverse is given by $\\frac{\\partial F_{\\chi}^{-1}}{\\partial x_{2,1}} = -F_{\\chi}^{-1} \\frac{\\partial F_{\\chi}}{\\partial x_{2,1}} F_{\\chi}^{-1}$:\n$$\n\\frac{\\partial F_{\\chi}^{-1}}{\\partial x_{2,1}} = - \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1 \\end{pmatrix} = - \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} -1/4 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\nNow we can compute the derivative of the term in the integrand. Let $S = J_{\\chi} \\left(F_{\\chi}^{-1} \\nabla_{\\hat{\\boldsymbol{x}}} N_{3}\\right) \\cdot \\boldsymbol{q}$. We differentiate $S$ with respect to $x_{2,1}$ using the product rule. The term $J_{\\chi} F_{\\chi}^{-1} \\nabla_{\\hat{\\boldsymbol{x}}} N_{3}$ is a vector; let's apply the rule to the matrix-vector product $(J_{\\chi} F_{\\chi}^{-1}) (\\nabla_{\\hat{\\boldsymbol{x}}} N_3)$.\n$$\n\\frac{\\partial S}{\\partial x_{2,1}} = \\left( \\frac{\\partial}{\\partial x_{2,1}} (J_{\\chi} F_{\\chi}^{-1}) \\nabla_{\\hat{\\boldsymbol{x}}} N_{3} \\right) \\cdot \\boldsymbol{q}\n$$\nLet's compute the derivative of the matrix term $M = J_{\\chi} F_{\\chi}^{-1}$:\n$$\n\\frac{\\partial M}{\\partial x_{2,1}} = \\frac{\\partial J_{\\chi}}{\\partial x_{2,1}} F_{\\chi}^{-1} + J_{\\chi} \\frac{\\partial F_{\\chi}^{-1}}{\\partial x_{2,1}}\n$$\nSubstituting the calculated values:\n$$\n\\frac{\\partial M}{\\partial x_{2,1}} = (1) \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1 \\end{pmatrix} + (2) \\begin{pmatrix} -1/4 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\begin{pmatrix} -1/2 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nThis resulting matrix is constant over the element. We now use it to find the derivative of $S$:\n$$\n\\frac{\\partial S}{\\partial x_{2,1}} = \\left( \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix} \\nabla_{\\hat{\\boldsymbol{x}}} N_{3} \\right) \\cdot \\boldsymbol{q}\n$$\nWith $\\nabla_{\\hat{\\boldsymbol{x}}} N_3 = (0, 1)^T$ and $\\boldsymbol{q} = (3, 4)^T$:\n$$\n\\frac{\\partial S}{\\partial x_{2,1}} = \\left( \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\right) \\cdot \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\cdot \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix} = (0)(3) + (1)(4) = 4\n$$\nSince this derivative is a constant, the integral becomes:\n$$\n\\frac{\\partial R_{2}^{(\\text{metric})}}{\\partial x_{2,1}} = \\int_{\\hat{K}} 4 \\cdot N_{2}\\, \\mathrm{d}\\hat{\\boldsymbol{x}} = 4 \\int_{\\hat{K}} N_{2}\\, \\mathrm{d}\\hat{\\boldsymbol{x}}\n$$\nThe integral of a linear shape function over the reference triangle $\\hat{K}$ is equal to one-third of the area of the triangle. The area of $\\hat{K}$ with vertices at $(0,0)$, $(1,0)$, and $(0,1)$ is $1/2$. Therefore:\n$$\n\\int_{\\hat{K}} N_{2}\\, \\mathrm{d}\\hat{\\boldsymbol{x}} = \\frac{\\text{Area}(\\hat{K})}{3} = \\frac{1/2}{3} = \\frac{1}{6}\n$$\nAlternatively, we compute the integral directly with $N_{2}(\\hat{\\xi}, \\hat{\\eta}) = \\hat{\\xi}$:\n$$\n\\int_{\\hat{K}} N_2 \\, \\mathrm{d}\\hat{\\boldsymbol{x}} = \\int_{0}^{1} \\int_{0}^{1-\\hat{\\xi}} \\hat{\\xi} \\, \\mathrm{d}\\hat{\\eta} \\, \\mathrm{d}\\hat{\\xi} = \\int_{0}^{1} \\hat{\\xi} [\\hat{\\eta}]_{0}^{1-\\hat{\\xi}} \\, \\mathrm{d}\\hat{\\xi} = \\int_{0}^{1} \\hat{\\xi}(1-\\hat{\\xi}) \\, \\mathrm{d}\\hat{\\xi} = \\int_{0}^{1} (\\hat{\\xi} - \\hat{\\xi}^2) \\, \\mathrm{d}\\hat{\\xi} = \\left[\\frac{\\hat{\\xi}^2}{2} - \\frac{\\hat{\\xi}^3}{3}\\right]_{0}^{1} = \\frac{1}{2} - \\frac{1}{3} = \\frac{1}{6}\n$$\nFinally, we obtain the answer:\n$$\n\\frac{\\partial R_{2}^{(\\text{metric})}}{\\partial x_{2,1}} = 4 \\left( \\frac{1}{6} \\right) = \\frac{4}{6} = \\frac{2}{3}\n$$", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "2541234"}]}