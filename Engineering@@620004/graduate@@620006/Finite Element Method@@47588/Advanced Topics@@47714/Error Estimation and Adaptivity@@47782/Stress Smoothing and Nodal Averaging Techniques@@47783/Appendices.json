{"hands_on_practices": [{"introduction": "Understanding stress smoothing begins with its most fundamental mathematical basis: the $L^2$-projection. This exercise provides a foundational look at projecting a known, discontinuous stress field onto the continuous space defined by a single finite element's shape functions. By working through this problem for a simple one-dimensional bar element, you will see how the theoretical projection translates into a solvable system of equations and verify the crucial property of exactness for linear fields, a concept that underpins the reliability of more advanced recovery methods [@problem_id:2603491].", "problem": "Consider a single two-node linear bar element occupying the physical interval $x \\in [0, L]$ with constant Jacobian $J = \\frac{L}{2}$ under the Finite Element Method (FEM). Let the exact axial stress field over this element be linear: $\\sigma(x) = \\sigma_{0} + k x$, where $\\sigma_{0}$ and $k$ are constants. A standard stress smoothing and nodal averaging approach is to recover a continuous nodal stress field by the $L^{2}$-projection of $\\sigma(x)$ onto the elementâ€™s nodal basis spanned by the linear shape functions $N_{1}(x)$ and $N_{2}(x)$. Define the recovered stress field as $\\tilde{\\sigma}(x) = N_{1}(x)\\,\\hat{\\sigma}_{1} + N_{2}(x)\\,\\hat{\\sigma}_{2}$, where $\\hat{\\sigma}_{1}$ and $\\hat{\\sigma}_{2}$ are the unknown nodal stresses to be determined by minimizing the squared error functional $\\int_{0}^{L} \\left(\\sigma(x) - \\tilde{\\sigma}(x)\\right)^{2} \\,\\mathrm{d}x$.\n\nWork in the parent coordinate $\\xi \\in [-1, 1]$ with the isoparametric mapping $x(\\xi) = \\frac{L}{2}(1 + \\xi)$ and parent-domain shape functions $N_{1}(\\xi) = \\frac{1 - \\xi}{2}$ and $N_{2}(\\xi) = \\frac{1 + \\xi}{2}$. Evaluate the $L^{2}$-projection normal equations using $2$-point Gauss quadrature on $[-1,1]$ with abscissae $\\xi = \\pm \\frac{1}{\\sqrt{3}}$ and weights $w = 1$.\n\nCompute the recovered nodal stress vector $(\\hat{\\sigma}_{1}, \\hat{\\sigma}_{2})$ in terms of $\\sigma_{0}$, $k$, and $L$, and verify from first principles that this $2$-point Gauss projection is exact for any linear axial stress distribution over the element.\n\nProvide your final answer as a single $1 \\times 2$ closed-form analytic row matrix in terms of $\\sigma_{0}$, $k$, and $L$. Do not include units in your final answer. No rounding is required.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Element: Two-node linear bar element.\n- Physical domain: $x \\in [0, L]$.\n- Jacobian: Constant, $J = \\frac{L}{2}$.\n- Exact stress field: $\\sigma(x) = \\sigma_{0} + k x$.\n- Recovered stress field: $\\tilde{\\sigma}(x) = N_{1}(x)\\,\\hat{\\sigma}_{1} + N_{2}(x)\\,\\hat{\\sigma}_{2}$.\n- Method: $L^{2}$-projection by minimizing $E = \\int_{0}^{L} \\left(\\sigma(x) - \\tilde{\\sigma}(x)\\right)^{2} \\,\\mathrm{d}x$.\n- Parent domain: $\\xi \\in [-1, 1]$.\n- Isoparametric mapping: $x(\\xi) = \\frac{L}{2}(1 + \\xi)$.\n- Parent domain shape functions: $N_{1}(\\xi) = \\frac{1 - \\xi}{2}$, $N_{2}(\\xi) = \\frac{1 + \\xi}{2}$.\n- Numerical integration: $2$-point Gauss quadrature on $[-1,1]$.\n- Gauss abscissae: $\\xi = \\pm \\frac{1}{\\sqrt{3}}$.\n- Gauss weights: $w = 1$.\n- Objective: Compute the recovered nodal stress vector $(\\hat{\\sigma}_{1}, \\hat{\\sigma}_{2})$ and verify from first principles that the projection is exact for any linear stress distribution.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard procedure in the Finite Element Method for stress recovery, known as $L^2$-projection. All terms and parameters are defined clearly. The given Jacobian $J = \\frac{L}{2}$ is consistent with the isoparametric mapping, as $\\frac{dx}{d\\xi} = \\frac{d}{d\\xi}\\left(\\frac{L}{2}(1 + \\xi)\\right) = \\frac{L}{2}$. The problem contains no scientific or factual unsoundness, no incompleteness or contradiction, and no ambiguity. It is a formalizable problem directly related to the specified topic.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed with a complete solution.\n\nThe objective is to find the nodal stresses $\\hat{\\sigma}_{1}$ and $\\hat{\\sigma}_{2}$ that minimize the squared error functional $E = \\int_{0}^{L} (\\sigma(x) - \\tilde{\\sigma}(x))^{2} \\,\\mathrm{d}x$. The necessary condition for a minimum is that the partial derivatives of $E$ with respect to the unknown nodal values are zero:\n$$ \\frac{\\partial E}{\\partial \\hat{\\sigma}_{i}} = 0 \\quad \\text{for } i = 1, 2 $$\nSubstituting $\\tilde{\\sigma}(x) = \\sum_{j=1}^{2} N_{j}(x)\\hat{\\sigma}_{j}$, we have:\n$$ \\frac{\\partial E}{\\partial \\hat{\\sigma}_{i}} = \\int_{0}^{L} 2 \\left(\\sigma(x) - \\sum_{j=1}^{2} N_{j}(x)\\hat{\\sigma}_{j}\\right) (-N_{i}(x)) \\,\\mathrm{d}x = 0 $$\nThis yields the standard $L^2$-projection equations, which can be expressed in matrix form as $\\mathbf{M}\\hat{\\boldsymbol{\\sigma}} = \\mathbf{f}$:\n$$ \\begin{pmatrix} \\int_{0}^{L} N_1^2 \\,\\mathrm{d}x & \\int_{0}^{L} N_1 N_2 \\,\\mathrm{d}x \\\\ \\int_{0}^{L} N_2 N_1 \\,\\mathrm{d}x & \\int_{0}^{L} N_2^2 \\,\\mathrm{d}x \\end{pmatrix} \\begin{pmatrix} \\hat{\\sigma}_1 \\\\ \\hat{\\sigma}_2 \\end{pmatrix} = \\begin{pmatrix} \\int_{0}^{L} N_1 \\sigma \\,\\mathrm{d}x \\\\ \\int_{0}^{L} N_2 \\sigma \\,\\mathrm{d}x \\end{pmatrix} $$\nTo evaluate these integrals, we transform them to the parent domain $\\xi \\in [-1, 1]$ using the given isoparametric mapping. The differential element transforms as $\\mathrm{d}x = J\\,\\mathrm{d}\\xi = \\frac{L}{2}\\,\\mathrm{d}\\xi$. The constant Jacobian $J$ can be factored out and cancelled from both sides of the matrix equation.\n$$ \\begin{pmatrix} \\int_{-1}^{1} N_1^2(\\xi) \\,\\mathrm{d}\\xi & \\int_{-1}^{1} N_1(\\xi) N_2(\\xi) \\,\\mathrm{d}\\xi \\\\ \\int_{-1}^{1} N_2(\\xi) N_1(\\xi) \\,\\mathrm{d}\\xi & \\int_{-1}^{1} N_2^2(\\xi) \\,\\mathrm{d}\\xi \\end{pmatrix} \\begin{pmatrix} \\hat{\\sigma}_1 \\\\ \\hat{\\sigma}_2 \\end{pmatrix} = \\begin{pmatrix} \\int_{-1}^{1} N_1(\\xi) \\sigma(\\xi) \\,\\mathrm{d}\\xi \\\\ \\int_{-1}^{1} N_2(\\xi) \\sigma(\\xi) \\,\\mathrm{d}\\xi \\end{pmatrix} $$\nThe integrals are evaluated using $2$-point Gauss quadrature, where for a function $g(\\xi)$, $\\int_{-1}^{1} g(\\xi)\\,\\mathrm{d}\\xi \\approx \\sum_{j=1}^{2} w_j g(\\xi_j)$. With $w_1=w_2=1$ and $\\xi_{1,2} = \\mp \\frac{1}{\\sqrt{3}}$, this is $\\int_{-1}^{1} g(\\xi)\\,\\mathrm{d}\\xi \\approx g(-\\frac{1}{\\sqrt{3}}) + g(\\frac{1}{\\sqrt{3}})$.\n\nFirst, we compute the components of the matrix $\\mathbf{M}$:\n$M_{11} = \\int_{-1}^{1} N_1^2(\\xi) \\,\\mathrm{d}\\xi \\approx \\left(N_1(-\\frac{1}{\\sqrt{3}})\\right)^2 + \\left(N_1(\\frac{1}{\\sqrt{3}})\\right)^2$. With $N_1(\\xi)=\\frac{1-\\xi}{2}$, this becomes $\\left(\\frac{1+\\frac{1}{\\sqrt{3}}}{2}\\right)^2 + \\left(\\frac{1-\\frac{1}{\\sqrt{3}}}{2}\\right)^2 = \\frac{1}{4}\\left(1+\\frac{2}{\\sqrt{3}}+\\frac{1}{3} + 1-\\frac{2}{\\sqrt{3}}+\\frac{1}{3}\\right) = \\frac{1}{4}\\left(2+\\frac{2}{3}\\right) = \\frac{2}{3}$.\nBy symmetry of the shape functions ($N_2(\\xi) = N_1(-\\xi)$), $M_{22} = \\int_{-1}^{1} N_2^2(\\xi)\\,\\mathrm{d}\\xi = M_{11} = \\frac{2}{3}$.\n$M_{12} = \\int_{-1}^{1} N_1(\\xi)N_2(\\xi) \\,\\mathrm{d}\\xi \\approx N_1(-\\frac{1}{\\sqrt{3}})N_2(-\\frac{1}{\\sqrt{3}}) + N_1(\\frac{1}{\\sqrt{3}})N_2(\\frac{1}{\\sqrt{3}})$. With $N_2(\\xi) = \\frac{1+\\xi}{2}$, this is $\\left(\\frac{1+\\frac{1}{\\sqrt{3}}}{2}\\right)\\left(\\frac{1-\\frac{1}{\\sqrt{3}}}{2}\\right) + \\left(\\frac{1-\\frac{1}{\\sqrt{3}}}{2}\\right)\\left(\\frac{1+\\frac{1}{\\sqrt{3}}}{2}\\right) = 2 \\frac{1 - (\\frac{1}{\\sqrt{3}})^2}{4} = 2 \\frac{1-\\frac{1}{3}}{4} = \\frac{1}{3}$.\nThus, the matrix $\\mathbf{M}$ is:\n$$ \\mathbf{M} = \\begin{pmatrix} \\frac{2}{3} & \\frac{1}{3} \\\\ \\frac{1}{3} & \\frac{2}{3} \\end{pmatrix} $$\nNext, we compute the components of the vector $\\mathbf{f}$. The stress function $\\sigma(x)=\\sigma_0+kx$ is expressed in parent coordinates: $\\sigma(\\xi) = \\sigma_0 + k\\left(\\frac{L}{2}(1+\\xi)\\right)$.\n$f_1 = \\int_{-1}^{1} N_1(\\xi)\\sigma(\\xi)\\,\\mathrm{d}\\xi \\approx N_1(-\\frac{1}{\\sqrt{3}})\\sigma(-\\frac{1}{\\sqrt{3}}) + N_1(\\frac{1}{\\sqrt{3}})\\sigma(\\frac{1}{\\sqrt{3}})$.\n$f_1 \\approx \\left(\\frac{1+\\frac{1}{\\sqrt{3}}}{2}\\right)\\left(\\sigma_0 + \\frac{kL}{2}(1-\\frac{1}{\\sqrt{3}})\\right) + \\left(\\frac{1-\\frac{1}{\\sqrt{3}}}{2}\\right)\\left(\\sigma_0 + \\frac{kL}{2}(1+\\frac{1}{\\sqrt{3}})\\right)$.\n$f_1 \\approx \\frac{\\sigma_0}{2}(1+\\frac{1}{\\sqrt{3}} + 1-\\frac{1}{\\sqrt{3}}) + \\frac{kL}{4}\\left((1+\\frac{1}{\\sqrt{3}})(1-\\frac{1}{\\sqrt{3}}) + (1-\\frac{1}{\\sqrt{3}})(1+\\frac{1}{\\sqrt{3}})\\right) = \\sigma_0 + \\frac{kL}{4}\\left(2(1-\\frac{1}{3})\\right) = \\sigma_0 + \\frac{kL}{3}$.\n$f_2 = \\int_{-1}^{1} N_2(\\xi)\\sigma(\\xi)\\,\\mathrm{d}\\xi \\approx N_2(-\\frac{1}{\\sqrt{3}})\\sigma(-\\frac{1}{\\sqrt{3}}) + N_2(\\frac{1}{\\sqrt{3}})\\sigma(\\frac{1}{\\sqrt{3}})$.\n$f_2 \\approx \\left(\\frac{1-\\frac{1}{\\sqrt{3}}}{2}\\right)\\left(\\sigma_0 + \\frac{kL}{2}(1-\\frac{1}{\\sqrt{3}})\\right) + \\left(\\frac{1+\\frac{1}{\\sqrt{3}}}{2}\\right)\\left(\\sigma_0 + \\frac{kL}{2}(1+\\frac{1}{\\sqrt{3}})\\right)$.\n$f_2 \\approx \\frac{\\sigma_0}{2}(1-\\frac{1}{\\sqrt{3}} + 1+\\frac{1}{\\sqrt{3}}) + \\frac{kL}{4}\\left((1-\\frac{1}{\\sqrt{3}})^2 + (1+\\frac{1}{\\sqrt{3}})^2\\right) = \\sigma_0 + \\frac{kL}{4}\\left(1-\\frac{2}{\\sqrt{3}}+\\frac{1}{3} + 1+\\frac{2}{\\sqrt{3}}+\\frac{1}{3}\\right) = \\sigma_0 + \\frac{kL}{4}\\left(2+\\frac{2}{3}\\right) = \\sigma_0 + \\frac{2kL}{3}$.\n\nThe system of equations is:\n$$ \\begin{pmatrix} \\frac{2}{3} & \\frac{1}{3} \\\\ \\frac{1}{3} & \\frac{2}{3} \\end{pmatrix} \\begin{pmatrix} \\hat{\\sigma}_1 \\\\ \\hat{\\sigma}_2 \\end{pmatrix} = \\begin{pmatrix} \\sigma_0 + \\frac{kL}{3} \\\\ \\sigma_0 + \\frac{2kL}{3} \\end{pmatrix} $$\nThe inverse of $\\mathbf{M}$ is $\\mathbf{M}^{-1} = \\frac{1}{\\det(\\mathbf{M})} \\begin{pmatrix} \\frac{2}{3} & -\\frac{1}{3} \\\\ -\\frac{1}{3} & \\frac{2}{3} \\end{pmatrix}$. With $\\det(\\mathbf{M}) = (\\frac{2}{3})^2 - (\\frac{1}{3})^2 = \\frac{4}{9} - \\frac{1}{9} = \\frac{1}{3}$, the inverse is $\\mathbf{M}^{-1} = 3 \\begin{pmatrix} \\frac{2}{3} & -\\frac{1}{3} \\\\ -\\frac{1}{3} & \\frac{2}{3} \\end{pmatrix} = \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}$.\nSolving for $\\hat{\\boldsymbol{\\sigma}} = \\mathbf{M}^{-1}\\mathbf{f}$:\n$$ \\begin{pmatrix} \\hat{\\sigma}_1 \\\\ \\hat{\\sigma}_2 \\end{pmatrix} = \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} \\begin{pmatrix} \\sigma_0 + \\frac{kL}{3} \\\\ \\sigma_0 + \\frac{2kL}{3} \\end{pmatrix} $$\n$$ \\hat{\\sigma}_1 = 2\\left(\\sigma_0 + \\frac{kL}{3}\\right) - \\left(\\sigma_0 + \\frac{2kL}{3}\\right) = 2\\sigma_0 + \\frac{2kL}{3} - \\sigma_0 - \\frac{2kL}{3} = \\sigma_0 $$\n$$ \\hat{\\sigma}_2 = -1\\left(\\sigma_0 + \\frac{kL}{3}\\right) + 2\\left(\\sigma_0 + \\frac{2kL}{3}\\right) = -\\sigma_0 - \\frac{kL}{3} + 2\\sigma_0 + \\frac{4kL}{3} = \\sigma_0 + \\frac{3kL}{3} = \\sigma_0 + kL $$\nThe recovered nodal stress vector is $(\\hat{\\sigma}_1, \\hat{\\sigma}_2) = (\\sigma_0, \\sigma_0 + kL)$.\n\nTo verify the exactness from first principles, we examine the properties of the Gauss quadrature rule. An $n$-point Gauss quadrature rule integrates polynomials of degree up to $2n-1$ exactly. For this problem, $n=2$, so the quadrature is exact for polynomials of degree up to $2(2)-1=3$.\nThe integrands for the matrix $\\mathbf{M}$ are of the form $N_i(\\xi)N_j(\\xi)$. Since $N_i(\\xi)$ are linear polynomials (degree $1$), their product is a quadratic polynomial (degree $2$). Because $2<3$, the Gauss quadrature evaluates the integrals for $\\mathbf{M}$ exactly.\nThe integrands for the vector $\\mathbf{f}$ are of the form $N_i(\\xi)\\sigma(\\xi)$. The stress $\\sigma(\\xi)$ is a linear function of $\\xi$ (degree $1$), and $N_i(\\xi)$ is also linear (degree $1$). Their product is a quadratic polynomial (degree $2$). Again, because $2<3$, the Gauss quadrature evaluates the integrals for $\\mathbf{f}$ exactly.\nSince the numerical integration scheme computes all integrals in the system $\\mathbf{M}\\hat{\\boldsymbol{\\sigma}} = \\mathbf{f}$ without error, the resulting solution for $\\hat{\\boldsymbol{\\sigma}}$ is the true mathematical solution to the $L^2$-projection problem.\nThe exact values of the stress at the nodes are $\\sigma(x=0) = \\sigma_0 + k(0) = \\sigma_0$ and $\\sigma(x=L) = \\sigma_0 + kL$. Our recovered nodal values are $\\hat{\\sigma}_1 = \\sigma_0$ and $\\hat{\\sigma}_2 = \\sigma_0 + kL$, which precisely match the exact nodal stresses. This confirms that the projection using $2$-point Gauss quadrature is exact for any linear stress distribution, because the method is equivalent to an exact analytical evaluation of the $L^2$-projection integrals. The projection of a function from a polynomial space onto the same space is simply the identity operation.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sigma_{0} & \\sigma_{0} + kL\n\\end{pmatrix}\n}\n$$", "id": "2603491"}, {"introduction": "Beyond formal projection, smoothing techniques can also be interpreted through direct physical averaging. This practice explores strain smoothing for a linear triangular element, where the smoothed strain is defined as the average of the compatible strain over the element's area. You will use the powerful Divergence Theorem to elegantly transform the area integral into a boundary integral, providing deep insight into the connection between internal strains and boundary displacements and reinforcing the concept of exactness for linear fields [@problem_id:2603444].", "problem": "Consider a single three-node linear triangle (T3) element occupying a bounded, nondegenerate, simply connected polygonal domain $\\Omega_{e} \\subset \\mathbb{R}^{2}$ with area $A_{e}$. Let the displacement field over $\\Omega_{e}$ be linear, given by\n$$u(x,y) = a_{0} + a_{1} x + a_{2} y, \\quad v(x,y) = b_{0} + b_{1} x + b_{2} y,$$\nwhere $a_{0}, a_{1}, a_{2}, b_{0}, b_{1}, b_{2}$ are real constants. In the small-strain setting of the Finite Element Method (FEM), the compatible strain tensor is defined by the symmetric gradient of displacement, and the strain smoothing with one triangular smoothing cell per element (the element itself as the smoothing cell) defines the smoothed strain as the cell-wise average of the compatible strain over $\\Omega_{e}$.\n\nUsing only fundamental definitions and the Divergence Theorem (Gaussâ€™s theorem) in $\\mathbb{R}^{2}$, compute the smoothed normal strain component $\\tilde{\\varepsilon}_{xx}$ for this element and verify that it is exact for any linear displacement field of the form above, irrespective of the shape of the nondegenerate triangle. Your derivation must explicitly justify each transformation from area to boundary integrals and the evaluation of any geometric boundary integrals using constants, coordinates, and normals. Express the final answer as a closed-form symbolic expression in terms of $a_{0}, a_{1}, a_{2}, b_{0}, b_{1}, b_{2}$. No numerical rounding is required. Since strain is dimensionless, no physical units are needed in the final answer.", "solution": "The problem as stated is scientifically sound, well-posed, and objective. It represents a fundamental derivation in the theory of the Finite Element Method, specifically concerning strain smoothing. We will proceed with the solution.\n\nThe objective is to compute the smoothed normal strain component $\\tilde{\\varepsilon}_{xx}$ for a three-node linear triangular element and verify its exactness under the specified conditions.\n\nThe compatible normal strain in the $x$-direction, $\\varepsilon_{xx}$, is defined as the partial derivative of the displacement component $u$ with respect to the coordinate $x$. Given the linear displacement field,\n$$\nu(x,y) = a_{0} + a_{1} x + a_{2} y\n$$\nthe compatible strain is\n$$\n\\varepsilon_{xx}(x,y) = \\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x}(a_{0} + a_{1} x + a_{2} y) = a_{1}\n$$\nIt is observed that for a linear displacement field, the resulting strain is constant throughout the element domain $\\Omega_{e}$.\n\nThe smoothed strain, $\\tilde{\\varepsilon}_{xx}$, is defined as the average of the compatible strain over the area of the element, $A_{e}$.\n$$\n\\tilde{\\varepsilon}_{xx} = \\frac{1}{A_{e}} \\int_{\\Omega_{e}} \\varepsilon_{xx}(x,y) \\, dA = \\frac{1}{A_{e}} \\int_{\\Omega_{e}} \\frac{\\partial u}{\\partial x} \\, dA\n$$\nThe problem requires this integral to be evaluated using the Divergence Theorem. The Divergence Theorem in two dimensions for a vector field $\\mathbf{F}(x,y) = (P(x,y), Q(x,y))$ over a domain $\\Omega$ with boundary $\\partial \\Omega$ states:\n$$\n\\int_{\\Omega} \\left( \\frac{\\partial P}{\\partial x} + \\frac{\\partial Q}{\\partial y} \\right) \\, dA = \\oint_{\\partial \\Omega} \\mathbf{F} \\cdot \\mathbf{n} \\, ds\n$$\nwhere $\\mathbf{n} = (n_x, n_y)$ is the outward unit normal vector to the boundary $\\partial \\Omega$ and $ds$ is the differential arc length along the boundary.\n\nTo transform the integral of $\\frac{\\partial u}{\\partial x}$, we define a vector field $\\mathbf{F}$ such that its divergence, $\\nabla \\cdot \\mathbf{F}$, equals $\\frac{\\partial u}{\\partial x}$. A suitable choice is $\\mathbf{F}(x,y) = (u(x,y), 0)$. For this field, the divergence is\n$$\n\\nabla \\cdot \\mathbf{F} = \\frac{\\partial}{\\partial x}(u) + \\frac{\\partial}{\\partial y}(0) = \\frac{\\partial u}{\\partial x}\n$$\nApplying the Divergence Theorem, the area integral for the strain becomes a boundary integral:\n$$\n\\int_{\\Omega_{e}} \\frac{\\partial u}{\\partial x} \\, dA = \\oint_{\\partial \\Omega_{e}} (u, 0) \\cdot \\mathbf{n} \\, ds = \\oint_{\\partial \\Omega_{e}} u n_x \\, ds\n$$\nThus, the expression for the smoothed strain is\n$$\n\\tilde{\\varepsilon}_{xx} = \\frac{1}{A_{e}} \\oint_{\\partial \\Omega_{e}} u n_x \\, ds\n$$\nThe boundary $\\partial \\Omega_{e}$ of the triangular element is composed of three straight edges. Let the vertices of the triangle be labeled $1, 2, 3$ in counter-clockwise order, with coordinates $(x_{1}, y_{1})$, $(x_{2}, y_{2})$, and $(x_{3}, y_{3})$. The boundary integral is the sum of integrals over these three edges:\n$$\n\\oint_{\\partial \\Omega_{e}} u n_x \\, ds = \\int_{1 \\to 2} u n_x \\, ds + \\int_{2 \\to 3} u n_x \\, ds + \\int_{3 \\to 1} u n_x \\, ds\n$$\nConsider a generic edge from vertex $i$ to vertex $j$. The vector along this edge is $(x_{j}-x_{i}, y_{j}-y_{i})$. For a counter-clockwise traversal of the boundary, the outward normal vector is proportional to $(y_{j}-y_{i}, -(x_{j}-x_{i}))$. The length of this normal vector is $L_{ij} = \\sqrt{(x_{j}-x_{i})^{2} + (y_{j}-y_{i})^{2}}$, which is the length of the edge. The unit outward normal vector $\\mathbf{n}_{ij}$ is therefore\n$$\n\\mathbf{n}_{ij} = \\frac{1}{L_{ij}} (y_{j}-y_{i}, -(x_{j}-x_{i}))\n$$\nThe $x$-component of the unit normal, $n_x$, is constant along this edge: $n_{x,ij} = \\frac{y_{j}-y_{i}}{L_{ij}}$.\nThe integral over the edge from $i$ to $j$ is\n$$\n\\int_{i \\to j} u n_x \\, ds = \\int_{i \\to j} u(x,y) \\left(\\frac{y_{j}-y_{i}}{L_{ij}}\\right) ds = \\left(\\frac{y_{j}-y_{i}}{L_{ij}}\\right) \\int_{i \\to j} u(x,y) \\, ds\n$$\nSince $u(x,y)$ is a linear function, its integral along a straight line segment can be evaluated exactly using the trapezoidal rule, which yields the average value of the function at the endpoints multiplied by the length of the segment.\n$$\n\\int_{i \\to j} u(x,y) \\, ds = \\frac{u(x_{i}, y_{i}) + u(x_{j}, y_{j})}{2} L_{ij} = \\frac{u_{i} + u_{j}}{2} L_{ij}\n$$\nSubstituting this into the expression for the edge integral gives\n$$\n\\int_{i \\to j} u n_x \\, ds = \\left(\\frac{y_{j}-y_{i}}{L_{ij}}\\right) \\left(\\frac{u_{i} + u_{j}}{2}\\right) L_{ij} = \\frac{1}{2} (u_{i} + u_{j})(y_{j}-y_{i})\n$$\nNow, we sum the contributions from all three edges ($1 \\to 2$, $2 \\to 3$, $3 \\to 1$):\n$$\n\\oint_{\\partial \\Omega_{e}} u n_x \\, ds = \\frac{1}{2} \\left[ (u_{1} + u_{2})(y_{2}-y_{1}) + (u_{2} + u_{3})(y_{3}-y_{2}) + (u_{3} + u_{1})(y_{1}-y_{3}) \\right]\n$$\nExpanding and regrouping terms by $u_{1}, u_{2}, u_{3}$:\n$$\n= \\frac{1}{2} \\left[ u_{1}((y_{2}-y_{1}) + (y_{1}-y_{3})) + u_{2}((y_{2}-y_{1}) + (y_{3}-y_{2})) + u_{3}((y_{3}-y_{2}) + (y_{1}-y_{3})) \\right]\n$$\n$$\n= \\frac{1}{2} \\left[ u_{1}(y_{2}-y_{3}) + u_{2}(y_{3}-y_{1}) + u_{3}(y_{1}-y_{2}) \\right]\n$$\nNext, we substitute the expression for nodal displacements $u_{i} = a_{0} + a_{1} x_{i} + a_{2} y_{i}$:\n$$\n= \\frac{1}{2} \\sum_{i,j,k \\text{ cyclic}} (a_{0} + a_{1} x_{i} + a_{2} y_{i})(y_{j}-y_{k})\n$$\nwhere $(i,j,k)$ permutations are $(1,2,3)$, $(2,3,1)$, and $(3,1,2)$. We can separate the sum based on the coefficients $a_{0}, a_{1}, a_{2}$:\n$$\n= \\frac{1}{2} \\left[ a_{0} \\sum_{cyc} (y_{j}-y_{k}) + a_{1} \\sum_{cyc} x_{i}(y_{j}-y_{k}) + a_{2} \\sum_{cyc} y_{i}(y_{j}-y_{k}) \\right]\n$$\nLet's evaluate each summation:\n1.  The sum for $a_{0}$: $(y_{2}-y_{3}) + (y_{3}-y_{1}) + (y_{1}-y_{2}) = 0$.\n2.  The sum for $a_{1}$: $x_{1}(y_{2}-y_{3}) + x_{2}(y_{3}-y_{1}) + x_{3}(y_{1}-y_{2})$. This is a standard formula for twice the signed area of a triangle, $2A_{e}$.\n3.  The sum for $a_{2}$: $y_{1}(y_{2}-y_{3}) + y_{2}(y_{3}-y_{1}) + y_{3}(y_{1}-y_{2}) = y_{1}y_{2} - y_{1}y_{3} + y_{2}y_{3} - y_{2}y_{1} + y_{3}y_{1} - y_{3}y_{2} = 0$.\n\nTherefore, the boundary integral simplifies significantly:\n$$\n\\oint_{\\partial \\Omega_{e}} u n_x \\, ds = \\frac{1}{2} \\left[ a_{0}(0) + a_{1}(2A_{e}) + a_{2}(0) \\right] = a_{1} A_{e}\n$$\nFinally, we substitute this result back into the expression for the smoothed strain $\\tilde{\\varepsilon}_{xx}$:\n$$\n\\tilde{\\varepsilon}_{xx} = \\frac{1}{A_{e}} (a_{1} A_{e}) = a_{1}\n$$\nThis completes the computation of the smoothed strain.\n\nTo verify that it is exact, we compare this result with the compatible strain $\\varepsilon_{xx}$ derived at the beginning. We found that for the given linear displacement field, $\\varepsilon_{xx} = a_{1}$, which is a constant value across the entire element. The smoothed strain $\\tilde{\\varepsilon}_{xx}$ is also equal to $a_{1}$. Since $\\tilde{\\varepsilon}_{xx} = \\varepsilon_{xx}$, the strain smoothing procedure is exact for any linear displacement field over a triangular element, regardless of its specific shape, as confirmed by the cancellation of all geometric terms except for the area $A_e$, which itself cancels in the final step. The coefficients $a_{0}, a_{2}, b_{0}, b_{1}, b_{2}$ do not influence the result for $\\tilde{\\varepsilon}_{xx}$, as expected from the definition of $\\varepsilon_{xx}$.", "answer": "$$\n\\boxed{a_{1}}\n$$", "id": "2603444"}, {"introduction": "In practical finite element analysis, stress recovery occurs at nodes shared by multiple, often distorted, elements. This exercise simulates this real-world scenario by examining a patch of elements and testing different nodal averaging schemes. By deriving the conditions under which an averaging scheme can exactly reproduce a linear stress fieldâ€”a critical benchmark known as the patch testâ€”you will gain a concrete understanding of why the choice of weights is crucial for obtaining accurate nodal stresses on non-uniform meshes [@problem_id:2603511].", "problem": "Consider a stress recovery by nodal averaging in the Finite Element Method (FEM) for a two-dimensional linear elastic problem. A single interior node at coordinates $(0,0)$ is surrounded by a patch of $4$ distorted quadrilateral elements. For each element $e$, let $(x_{e}^{c},y_{e}^{c})$ denote the centroid of the element, and let $A_{e}$ denote its area. The element centroids and areas (in consistent units) are prescribed as follows:\n- Element $1$: $(x_{1}^{c},y_{1}^{c})=(1,1)$ with $A_{1}=2$,\n- Element $2$: $(x_{2}^{c},y_{2}^{c})=(0,2)$ with $A_{2}=3$,\n- Element $3$: $(x_{3}^{c},y_{3}^{c})=(-1,1)$ with $A_{3}=2$,\n- Element $4$: $(x_{4}^{c},y_{4}^{c})=(0,-t)$ with $A_{4}=1$,\n\nwhere $t>0$ is a distortion parameter controlling the centroid location of element $4$.\n\nAssume the exact Cauchy stress component of interest varies linearly over the patch as $\\sigma(x,y)=a+bx+cy$, where $a$, $b$, and $c$ are arbitrary constants. The nodal-averaged recovered stress at the node, $\\sigma^{\\star}(0,0)$, is defined, for a chosen set of nonnegative weights $\\{w_{e}\\}_{e=1}^{4}$ normalized by $\\sum_{e=1}^{4}w_{e}=1$, as\n$$\n\\sigma^{\\star}(0,0)=\\sum_{e=1}^{4}w_{e}\\,\\sigma\\!\\left(x_{e}^{c},y_{e}^{c}\\right).\n$$\nTwo weighting schemes are considered:\n- Equal-weight averaging: $w_{e}=\\frac{1}{4}$ for $e=1,2,3,4$.\n- Area-weight averaging: $w_{e}=\\dfrac{A_{e}}{\\sum_{j=1}^{4}A_{j}}$ for $e=1,2,3,4$.\n\nStarting only from the definition of $\\sigma(x,y)$ as a linear field and the definition of $\\sigma^{\\star}(0,0)$ above, derive the necessary and sufficient conditions on the centroids and weights that guarantee that $\\sigma^{\\star}(0,0)$ reproduces the exact nodal value $\\sigma(0,0)$ for all choices of $(a,b,c)$. Then, for the specific patch data given, determine the unique values of the distortion parameter under each scheme, denoted $t_{\\mathrm{eq}}$ for equal-weight averaging and $t_{\\mathrm{ar}}$ for area-weight averaging, such that each scheme preserves all linear stress fields at the node.\n\nReport your final answer as a row matrix $(t_{\\mathrm{eq}}\\;\\;t_{\\mathrm{ar}})$. No units are required. Provide exact values; no rounding is needed.", "solution": "The problem as stated will be validated before a solution is attempted.\n\nStep 1: Extract Givens\n- The problem is a two-dimensional linear elastic problem analyzed using the Finite Element Method (FEM).\n- The focus is on stress recovery by nodal averaging at an interior node located at coordinates $(0,0)$.\n- The node is surrounded by a patch of $4$ quadrilateral elements.\n- For each element $e$, the centroid is $(x_{e}^{c}, y_{e}^{c})$ and the area is $A_{e}$.\n- Element data:\n  - Element $1$: $(x_{1}^{c},y_{1}^{c})=(1,1)$, $A_{1}=2$.\n  - Element $2$: $(x_{2}^{c},y_{2}^{c})=(0,2)$, $A_{2}=3$.\n  - Element $3$: $(x_{3}^{c},y_{3}^{c})=(-1,1)$, $A_{3}=2$.\n  - Element $4$: $(x_{4}^{c},y_{4}^{c})=(0,-t)$, $A_{4}=1$, where $t > 0$.\n- The exact Cauchy stress component is a linear field: $\\sigma(x,y) = a+bx+cy$, where $a, b, c$ are arbitrary constants.\n- The nodal-averaged recovered stress is defined as $\\sigma^{\\star}(0,0)=\\sum_{e=1}^{4}w_{e}\\,\\sigma\\!\\left(x_{e}^{c},y_{e}^{c}\\right)$.\n- The weights $\\{w_{e}\\}$ are non-negative and satisfy the normalization condition $\\sum_{e=1}^{4}w_{e}=1$.\n- Two weighting schemes are defined:\n  - Equal-weight averaging: $w_{e}=\\frac{1}{4}$ for $e=1,2,3,4$.\n  - Area-weight averaging: $w_{e}=\\dfrac{A_{e}}{\\sum_{j=1}^{4}A_{j}}$ for $e=1,2,3,4$.\n- The objective is to first derive the general conditions on weights and centroids such that $\\sigma^{\\star}(0,0) = \\sigma(0,0)$ for all $a, b, c$.\n- The second objective is to find the unique values of the parameter $t$, denoted $t_{\\mathrm{eq}}$ and $t_{\\mathrm{ar}}$, for each scheme, that satisfy these conditions.\n\nStep 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded**: The problem is well-grounded in the theory of the Finite Element Method. The concept of using nodal averaging to recover stresses and the requirement that the recovery scheme be exact for linear fields (a form of the \"patch test\") are fundamental topics in computational mechanics. The mathematical formulation is standard. The problem is scientifically sound.\n- **Well-Posed**: The problem is well-posed. All necessary data and definitions are provided to derive the conditions and solve for the unknown parameter $t$. The existence and uniqueness of the solution for $t$ under each scheme can be determined from the given equations.\n- **Objective**: The problem is stated using precise, objective mathematical language. It is free from subjectivity or ambiguity.\n- **Completeness and Consistency**: The problem is self-contained and internally consistent. No information is missing, and no constraints are contradictory. The condition $t>0$ is explicitly stated.\n- **Feasibility**: The geometric and physical setup, represented by the specified centroid coordinates and areas, is abstract but poses no physical or mathematical impossibility.\n- **Structure**: The problem is clearly structured, asking for a general derivation followed by specific calculations. There is no circular reasoning.\n\nStep 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, objective, and complete. A full solution will be provided.\n\nThe core requirement is that the nodal-averaged stress $\\sigma^{\\star}(0,0)$ exactly reproduces the true stress value $\\sigma(0,0)$ when the exact stress field is linear. The exact stress at the node $(0,0)$ is:\n$$\n\\sigma(0,0) = a + b(0) + c(0) = a\n$$\nThe recovered stress is given by the weighted average of the exact stress evaluated at the centroid of each element in the patch:\n$$\n\\sigma^{\\star}(0,0) = \\sum_{e=1}^{4} w_{e}\\,\\sigma(x_{e}^{c}, y_{e}^{c})\n$$\nSubstituting the linear stress field into this definition yields:\n$$\n\\sigma^{\\star}(0,0) = \\sum_{e=1}^{4} w_{e} \\left(a + b x_{e}^{c} + c y_{e}^{c}\\right)\n$$\nDistributing the summation and factoring out the constants $a$, $b$, and $c$, which are independent of the element index $e$:\n$$\n\\sigma^{\\star}(0,0) = a \\left( \\sum_{e=1}^{4} w_{e} \\right) + b \\left( \\sum_{e=1}^{4} w_{e} x_{e}^{c} \\right) + c \\left( \\sum_{e=1}^{4} w_{e} y_{e}^{c} \\right)\n$$\nFor this recovered stress to be equal to the exact stress $\\sigma(0,0) = a$ for all possible values of the arbitrary constants $a$, $b$, and $c$, the coefficients of $a$, $b$, and $c$ in the expression for $\\sigma^{\\star}(0,0)$ must match those in the expression for $\\sigma(0,0)$. This leads to a system of three conditions:\n$1$. Coefficient of $a$: $\\sum_{e=1}^{4} w_{e} = 1$. This condition is satisfied by definition for both weighting schemes.\n$2$. Coefficient of $b$: $\\sum_{e=1}^{4} w_{e} x_{e}^{c} = 0$.\n$3$. Coefficient of $c$: $\\sum_{e=1}^{4} w_{e} y_{e}^{c} = 0$.\nThese are the necessary and sufficient conditions that guarantee the exact recovery of any linear stress field at the node $(0,0)$. The conditions state that the weighted average of the element centroid coordinates must coincide with the coordinates of the node itself.\n\nNow, we apply these conditions to find the specific values of $t$ for each weighting scheme.\n\nCase 1: Equal-weight averaging ($t_{\\mathrm{eq}}$)\nThe weights are $w_{e} = \\frac{1}{4}$ for $e=1,2,3,4$.\nCondition $2$:\n$$\n\\sum_{e=1}^{4} w_{e} x_{e}^{c} = \\frac{1}{4} \\sum_{e=1}^{4} x_{e}^{c} = \\frac{1}{4}(x_{1}^{c} + x_{2}^{c} + x_{3}^{c} + x_{4}^{c}) = 0\n$$\nSubstituting the given centroid coordinates:\n$$\n\\frac{1}{4}(1 + 0 + (-1) + 0) = \\frac{1}{4}(0) = 0\n$$\nThis condition is satisfied for any value of $t$. It does not impose a constraint on $t$.\n\nCondition $3$:\n$$\n\\sum_{e=1}^{4} w_{e} y_{e}^{c} = \\frac{1}{4} \\sum_{e=1}^{4} y_{e}^{c} = \\frac{1}{4}(y_{1}^{c} + y_{2}^{c} + y_{3}^{c} + y_{4}^{c}) = 0\n$$\nSubstituting the given centroid coordinates:\n$$\n\\frac{1}{4}(1 + 2 + 1 + (-t)) = 0\n$$\n$$\n4 - t = 0\n$$\nThis yields $t_{\\mathrm{eq}} = 4$. This value satisfies the given constraint $t>0$.\n\nCase 2: Area-weight averaging ($t_{\\mathrm{ar}}$)\nFirst, we compute the total area of the patch:\n$$\nA_{\\mathrm{total}} = \\sum_{j=1}^{4} A_{j} = A_{1} + A_{2} + A_{3} + A_{4} = 2 + 3 + 2 + 1 = 8\n$$\nThe weights are calculated as $w_{e} = \\frac{A_{e}}{A_{\\mathrm{total}}}$:\n- $w_{1} = \\frac{A_{1}}{8} = \\frac{2}{8} = \\frac{1}{4}$\n- $w_{2} = \\frac{A_{2}}{8} = \\frac{3}{8}$\n- $w_{3} = \\frac{A_{3}}{8} = \\frac{2}{8} = \\frac{1}{4}$\n- $w_{4} = \\frac{A_{4}}{8} = \\frac{1}{8}$\n\nCondition $2$:\n$$\n\\sum_{e=1}^{4} w_{e} x_{e}^{c} = w_{1}x_{1}^{c} + w_{2}x_{2}^{c} + w_{3}x_{3}^{c} + w_{4}x_{4}^{c} = 0\n$$\nSubstituting the weights and centroid coordinates:\n$$\n\\left(\\frac{1}{4}\\right)(1) + \\left(\\frac{3}{8}\\right)(0) + \\left(\\frac{1}{4}\\right)(-1) + \\left(\\frac{1}{8}\\right)(0) = \\frac{1}{4} - \\frac{1}{4} = 0\n$$\nAgain, this condition is satisfied for any value of $t$ and does not impose a constraint.\n\nCondition $3$:\n$$\n\\sum_{e=1}^{4} w_{e} y_{e}^{c} = w_{1}y_{1}^{c} + w_{2}y_{2}^{c} + w_{3}y_{3}^{c} + w_{4}y_{4}^{c} = 0\n$$\nSubstituting the weights and centroid coordinates:\n$$\n\\left(\\frac{1}{4}\\right)(1) + \\left(\\frac{3}{8}\\right)(2) + \\left(\\frac{1}{4}\\right)(1) + \\left(\\frac{1}{8}\\right)(-t) = 0\n$$\nTo simplify, we multiply the entire equation by $8$:\n$$\n8\\left(\\frac{1}{4}\\right) + 8\\left(\\frac{6}{8}\\right) + 8\\left(\\frac{1}{4}\\right) - 8\\left(\\frac{t}{8}\\right) = 0\n$$\n$$\n2 + 6 + 2 - t = 0\n$$\n$$\n10 - t = 0\n$$\nThis yields $t_{\\mathrm{ar}} = 10$. This value also satisfies the constraint $t>0$.\n\nThe unique values of the distortion parameter are $t_{\\mathrm{eq}} = 4$ for equal-weight averaging and $t_{\\mathrm{ar}} = 10$ for area-weight averaging. The solution is presented as a row matrix $(t_{\\mathrm{eq}}\\;\\;t_{\\mathrm{ar}})$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4 & 10\n\\end{pmatrix}\n}\n$$", "id": "2603511"}]}