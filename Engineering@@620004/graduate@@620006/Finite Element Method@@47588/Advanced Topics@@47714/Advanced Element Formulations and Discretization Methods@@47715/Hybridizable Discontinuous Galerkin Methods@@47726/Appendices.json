{"hands_on_practices": [{"introduction": "The power of the Hybridizable Discontinuous Galerkin (HDG) method lies in its ability to be constructed element by element. This first practice is a fundamental exercise in translating the abstract weak formulation of a problem into a concrete, local matrix system [@problem_id:2566501]. By explicitly deriving the matrices that link the trace unknown $\\widehat{u}_h$ to the interior unknowns $(q_h, u_h)$, you will gain a hands-on understanding of the core algebraic structure of the HDG local solver.", "problem": "Consider the Hybridizable Discontinuous Galerkin (HDG) method for the Poisson equation on the reference triangle $\\widehat{T}$ with vertices $(0,0)$, $(1,0)$, and $(0,1)$. Let the diffusion coefficient be constant and equal to $1$, and let the stabilization parameter $\\tau$ be constant on each edge. Work with the first-order system\n$\\boldsymbol{q} + \\nabla u = \\boldsymbol{0}$ and $\\nabla \\cdot \\boldsymbol{q} = f$ on $\\widehat{T}$, and assume $f \\equiv 0$ so that the local solver maps the trace unknown $\\widehat{u}_h$ to the element unknowns $(q_h,u_h)$ without load contributions.\n\nUse the polynomial spaces $V_h(\\widehat{T}) = [\\mathcal{P}_k(\\widehat{T})]^2$, $W_h(\\widehat{T}) = \\mathcal{P}_k(\\widehat{T})$, and $M_h(\\partial \\widehat{T}) = \\mathcal{P}_k(\\mathcal{F})$ on each edge $\\mathcal{F} \\subset \\partial \\widehat{T}$, with $k = 1$. Let $\\{\\boldsymbol{\\varphi}_i\\}_{i=1}^{N_v}$ be a basis for $V_h(\\widehat{T})$, $\\{\\phi_j\\}_{j=1}^{N_w}$ be a basis for $W_h(\\widehat{T})$, and $\\{\\psi_m\\}_{m=1}^{N_m}$ be a basis for $M_h(\\partial \\widehat{T})$ assembled from the edgewise bases. Adopt the numerical flux $\\widehat{q}_h \\cdot n = q_h \\cdot n + \\tau\\,(u_h - \\widehat{u}_h)$ on $\\partial \\widehat{T}$.\n\nStarting from the weak form of the first-order system, derive the element-local linear system that maps the trace coefficients $\\widehat{\\boldsymbol{u}} \\in \\mathbb{R}^{N_m}$ to the local coefficients of $(q_h,u_h)$, written in the block form\n$$\n\\begin{pmatrix}\n\\mathbf{M} & \\mathbf{D}^\\top \\\\\n\\mathbf{B} & \\mathbf{N}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\boldsymbol{q} \\\\\n\\boldsymbol{u}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{C} \\\\\n\\mathbf{T}\n\\end{pmatrix}\n\\widehat{\\boldsymbol{u}}.\n$$\nHere, the vectors $\\boldsymbol{q} \\in \\mathbb{R}^{N_v}$ and $\\boldsymbol{u} \\in \\mathbb{R}^{N_w}$ collect the coefficients of $q_h$ and $u_h$ in the chosen bases, respectively, and $\\widehat{\\boldsymbol{u}}$ collects the coefficients of $\\widehat{u}_h$ on $\\partial \\widehat{T}$. Explicitly write each local matrix $\\mathbf{M}$, $\\mathbf{D}$, $\\mathbf{B}$, $\\mathbf{N}$, $\\mathbf{C}$, and $\\mathbf{T}$ in terms of element or edge integrals against the chosen bases. Then, compute the sizes (row and column counts) of these matrices for $k=1$ on the reference triangle $\\widehat{T}$.\n\nFinally, based on your derivation, determine the total number $N_{\\text{tot}}$ of element-local unknowns per element when assembling the HDG local system, that is, the dimension of the concatenated vector $(\\boldsymbol{q}, \\boldsymbol{u}, \\widehat{\\boldsymbol{u}})$ for $k=1$ on $\\widehat{T}$. Report $N_{\\text{tot}}$ as a single integer with no units.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It is a standard derivation in the field of numerical analysis, specifically concerning the finite element method. There are no contradictions, ambiguities, or factual inaccuracies. The problem is therefore deemed valid and a solution will be provided.\n\nThe problem requires the derivation of the local linear system for the Hybridizable Discontinuous Galerkin (HDG) method applied to the Poisson equation on a reference triangle $\\widehat{T}$. The governing first-order system is given by:\n$$\n\\boldsymbol{q} + \\nabla u = \\boldsymbol{0} \\quad \\text{in } \\widehat{T}\n$$\n$$\n\\nabla \\cdot \\boldsymbol{q} = f \\quad \\text{in } \\widehat{T}\n$$\nWe are given that the source term $f \\equiv 0$, the diffusion coefficient is $1$, and the polynomial degree is $k=1$.\n\nThe derivation of the element-local system proceeds by formulating the weak form of these equations. We multiply the first equation by a vector test function $\\boldsymbol{v} \\in V_h(\\widehat{T})$ and the second by a scalar test function $w \\in W_h(\\widehat{T})$, and integrate over the element $\\widehat{T}$.\n\nFor the first equation, we have:\n$$\n\\int_{\\widehat{T}} (\\boldsymbol{q}_h \\cdot \\boldsymbol{v}) \\, d\\boldsymbol{x} + \\int_{\\widehat{T}} (\\nabla u_h \\cdot \\boldsymbol{v}) \\, d\\boldsymbol{x} = 0\n$$\nApplying integration by parts (Green's first identity) to the second term yields:\n$$\n\\int_{\\widehat{T}} (\\nabla u_h \\cdot \\boldsymbol{v}) \\, d\\boldsymbol{x} = -\\int_{\\widehat{T}} u_h (\\nabla \\cdot \\boldsymbol{v}) \\, d\\boldsymbol{x} + \\int_{\\partial \\widehat{T}} u_h (\\boldsymbol{v} \\cdot \\boldsymbol{n}) \\, dS\n$$\nIn the HDG method, the trace of the scalar field $u_h$ on the boundary $\\partial \\widehat{T}$ is replaced by a new independent unknown, the numerical trace $\\widehat{u}_h \\in M_h(\\partial \\widehat{T})$. Substituting this into the equation, we obtain the weak form for the first PDE:\n$$\n\\int_{\\widehat{T}} (\\boldsymbol{q}_h \\cdot \\boldsymbol{v}) \\, d\\boldsymbol{x} - \\int_{\\widehat{T}} u_h (\\nabla \\cdot \\boldsymbol{v}) \\, d\\boldsymbol{x} + \\int_{\\partial \\widehat{T}} \\widehat{u}_h (\\boldsymbol{v} \\cdot \\boldsymbol{n}) \\, dS = 0, \\quad \\forall \\boldsymbol{v} \\in V_h(\\widehat{T})\n$$\n\nFor the second equation, $\\nabla \\cdot \\boldsymbol{q}_h = 0$, the weak formulation is:\n$$\n\\int_{\\widehat{T}} (\\nabla \\cdot \\boldsymbol{q}_h) w \\, d\\boldsymbol{x} = 0\n$$\nApplying integration by parts gives:\n$$\n-\\int_{\\widehat{T}} (\\boldsymbol{q}_h \\cdot \\nabla w) \\, d\\boldsymbol{x} + \\int_{\\partial \\widehat{T}} (\\boldsymbol{q}_h \\cdot \\boldsymbol{n}) w \\, dS = 0\n$$\nThe normal component of the flux, $\\boldsymbol{q}_h \\cdot \\boldsymbol{n}$, is replaced by the numerical flux $\\widehat{\\boldsymbol{q}}_h \\cdot \\boldsymbol{n} = \\boldsymbol{q}_h \\cdot \\boldsymbol{n} + \\tau (u_h - \\widehat{u}_h)$, where $\\tau$ is the stabilization parameter. This leads to the second weak form:\n$$\n-\\int_{\\widehat{T}} (\\boldsymbol{q}_h \\cdot \\nabla w) \\, d\\boldsymbol{x} + \\int_{\\partial \\widehat{T}} (\\boldsymbol{q}_h \\cdot \\boldsymbol{n} + \\tau (u_h - \\widehat{u}_h)) w \\, dS = 0, \\quad \\forall w \\in W_h(\\widehat{T})\n$$\n\nTo obtain the matrix system, we expand the discrete solutions in their respective bases:\n$\\boldsymbol{q}_h = \\sum_{j=1}^{N_v} q_j \\boldsymbol{\\varphi}_j(\\boldsymbol{x})$, $u_h = \\sum_{j=1}^{N_w} u_j \\phi_j(\\boldsymbol{x})$, and $\\widehat{u}_h = \\sum_{j=1}^{N_m} \\widehat{u}_j \\psi_j(\\boldsymbol{x})$. We test against each basis function in turn. Let the test functions be $\\boldsymbol{v} = \\boldsymbol{\\varphi}_i$ and $w = \\phi_i$.\n\nFrom the first weak equation, setting $\\boldsymbol{v} = \\boldsymbol{\\varphi}_i$ for $i=1, \\dots, N_v$:\n$$\n\\sum_{j=1}^{N_v} \\left( \\int_{\\widehat{T}} \\boldsymbol{\\varphi}_j \\cdot \\boldsymbol{\\varphi}_i \\, d\\boldsymbol{x} \\right) q_j - \\sum_{j=1}^{N_w} \\left( \\int_{\\widehat{T}} (\\nabla \\cdot \\boldsymbol{\\varphi}_i) \\phi_j \\, d\\boldsymbol{x} \\right) u_j = - \\sum_{j=1}^{N_m} \\left( \\int_{\\partial \\widehat{T}} (\\boldsymbol{\\varphi}_i \\cdot \\boldsymbol{n}) \\psi_j \\, dS \\right) \\widehat{u}_j\n$$\nComparing this with the first block row of the target system, $\\mathbf{M}\\boldsymbol{q} + \\mathbf{D}^\\top\\boldsymbol{u} = \\mathbf{C}\\widehat{\\boldsymbol{u}}$, we identify the matrices (using row index $i$, column index $j$):\n- $\\mathbf{M}_{ij} = \\int_{\\widehat{T}} \\boldsymbol{\\varphi}_j \\cdot \\boldsymbol{\\varphi}_i \\, d\\boldsymbol{x}$\n- $(\\mathbf{D}^\\top)_{ij} = - \\int_{\\widehat{T}} (\\nabla \\cdot \\boldsymbol{\\varphi}_i) \\phi_j \\, d\\boldsymbol{x}$\n- $\\mathbf{C}_{ij} = -\\int_{\\partial \\widehat{T}} (\\boldsymbol{\\varphi}_i \\cdot \\boldsymbol{n}) \\psi_j \\, dS$\n\nFrom the second weak equation, setting $w = \\phi_i$ for $i=1, \\dots, N_w$:\n$$\n\\sum_{j=1}^{N_v} \\left( -\\int_{\\widehat{T}} \\boldsymbol{\\varphi}_j \\cdot \\nabla \\phi_i \\, d\\boldsymbol{x} + \\int_{\\partial \\widehat{T}} (\\boldsymbol{\\varphi}_j \\cdot \\boldsymbol{n}) \\phi_i \\, dS \\right) q_j + \\sum_{j=1}^{N_w} \\left( \\int_{\\partial \\widehat{T}} \\tau \\phi_j \\phi_i \\, dS \\right) u_j = \\sum_{j=1}^{N_m} \\left( \\int_{\\partial \\widehat{T}} \\tau \\phi_i \\psi_j \\, dS \\right) \\widehat{u}_j\n$$\nUsing integration by parts on the first term: $-\\int_{\\widehat{T}} \\boldsymbol{\\varphi}_j \\cdot \\nabla \\phi_i \\, d\\boldsymbol{x} = \\int_{\\widehat{T}} (\\nabla \\cdot \\boldsymbol{\\varphi}_j) \\phi_i \\, d\\boldsymbol{x} - \\int_{\\partial \\widehat{T}} (\\boldsymbol{\\varphi}_j \\cdot \\boldsymbol{n}) \\phi_i \\, dS$. The boundary terms cancel, simplifying the expression.\nComparing with the second block row, $\\mathbf{B}\\boldsymbol{q} + \\mathbf{N}\\boldsymbol{u} = \\mathbf{T}\\widehat{\\boldsymbol{u}}$, we identify:\n- $\\mathbf{B}_{ij} = \\int_{\\widehat{T}} (\\nabla \\cdot \\boldsymbol{\\varphi}_j) \\phi_i \\, d\\boldsymbol{x}$\n- $\\mathbf{N}_{ij} = \\int_{\\partial \\widehat{T}} \\tau \\phi_j \\phi_i \\, dS$\n- $\\mathbf{T}_{ij} = \\int_{\\partial \\widehat{T}} \\tau \\phi_i \\psi_j \\, dS$\n\nFrom these definitions, we observe the relationship $\\mathbf{B} = -\\mathbf{D}$, where the matrix $\\mathbf{D}$ is the transpose of $\\mathbf{D}^\\top$, i.e., $D_{ji} = (\\mathbf{D}^\\top)_{ij}$.\n\nNext, we compute the sizes of these matrices for $k=1$ on the reference triangle $\\widehat{T}$, a $2$-dimensional domain.\nThe dimension of the polynomial space $\\mathcal{P}_k(\\mathbb{R}^d)$ is $\\binom{k+d}{d}$.\n- For the scalar space $W_h(\\widehat{T}) = \\mathcal{P}_1(\\widehat{T})$, we have $d=2, k=1$. The dimension is $N_w = \\binom{1+2}{2} = 3$.\n- For the vector space $V_h(\\widehat{T}) = [\\mathcal{P}_1(\\widehat{T})]^2$, each of the two components lies in a $3$-dimensional space. Thus, the total dimension is $N_v = 2 \\times 3 = 6$.\n- For the trace space $M_h(\\partial \\widehat{T})$, the boundary consists of $3$ edges. On each edge $\\mathcal{F}$, a $1$-dimensional domain, the space is $\\mathcal{P}_1(\\mathcal{F})$. Its dimension is $\\binom{1+1}{1} = 2$. Since the trace space is the direct sum of spaces on each edge, the total dimension is $N_m = 3 \\times 2 = 6$.\n\nThe sizes (rows $\\times$ columns) of the matrices are determined by the dimensions of the corresponding spaces:\n- $\\mathbf{M}: N_v \\times N_v \\implies 6 \\times 6$\n- $\\mathbf{D}^\\top: N_v \\times N_w \\implies 6 \\times 3$\n- $\\mathbf{B}: N_w \\times N_v \\implies 3 \\times 6$\n- $\\mathbf{N}: N_w \\times N_w \\implies 3 \\times 3$\n- $\\mathbf{C}: N_v \\times N_m \\implies 6 \\times 6$\n- $\\mathbf{T}: N_w \\times N_m \\implies 3 \\times 6$\n\nFinally, the total number of element-local unknowns, $N_{\\text{tot}}$, is the sum of the number of coefficients for $\\boldsymbol{q}_h$, $u_h$, and $\\widehat{u}_h$.\n$$\nN_{\\text{tot}} = N_v + N_w + N_m\n$$\nSubstituting the computed dimensions for $k=1$:\n$$\nN_{\\text{tot}} = 6 + 3 + 6 = 15\n$$\nThis is the total dimension of the local unknown vector $(\\boldsymbol{q}, \\boldsymbol{u}, \\widehat{\\boldsymbol{u}})$.", "answer": "$$\\boxed{15}$$", "id": "2566501"}, {"introduction": "After constructing the local systems, the next step in the HDG method is to perform static condensation and assemble a global system for the trace unknowns on the mesh skeleton. This exercise demystifies this process by examining the simplest case: a one-dimensional problem with piecewise constant approximations ($k=0$) [@problem_id:2566544]. You will derive the condensed skeleton system and discover its remarkable equivalence to a standard finite difference stencil, providing deep intuition into the method's structure and the role of the stabilization parameter $\\tau$.", "problem": "Consider the diffusion model problem in one spatial dimension: find $u$ such that $- (\\kappa u^{\\prime})^{\\prime} = f$ in $(0,L)$ with homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(L)=0$, where $\\kappa>0$ is constant. Discretize the interval into a uniform mesh of $N$ elements of size $h = L/N$ with nodes $\\{x_i\\}_{i=0}^{N}$. Apply the Hybridizable Discontinuous Galerkin (HDG) method using polynomial degree $k=0$ for the element unknowns on each element $K=[x_{i-1},x_i]$, with stabilization parameter $\\tau>0$ constant on all faces. Use the first-order system with flux $q = -\\kappa u^{\\prime}$ and the standard HDG numerical flux $\\widehat{q}\\,n = q\\,n + \\tau\\,(u - \\widehat{u})$ on $\\partial K$, where $n$ is the outward normal, $u$ and $q$ denote the elementwise unknowns (constants on $K$), and $\\widehat{u}$ is the single-valued trace unknown defined on the mesh skeleton (one scalar per node).\n\nStarting from the HDG local equations on each element $K$,\n- $(\\kappa^{-1} q, r)_K - (u, r^{\\prime})_K + \\langle \\widehat{u}, r\\,n \\rangle_{\\partial K} = 0$ for all constant $r$ on $K$,\n- $-(q, v^{\\prime})_K + \\langle \\widehat{q}\\,n, v \\rangle_{\\partial K} = (f, v)_K$ for all constant $v$ on $K$,\nand enforcing the global HDG transmission condition that the sum of numerical fluxes $\\widehat{q}\\,n$ vanishes at each interior node, eliminate the elementwise unknowns $u$ and $q$ to obtain the condensed global (skeleton) system for the nodal trace unknowns $\\{\\widehat{u}_i\\}_{i=1}^{N-1}$. Show that this condensed skeleton system has a tridiagonal three-point stencil proportional to the standard second-difference stencil $[1,\\,-2,\\,1]$ on the interior nodes.\n\nWhat is the exact proportionality constant $c$ such that the condensed skeleton stiffness matrix equals $c$ times the standard second-difference tridiagonal matrix on the interior nodes, expressed in terms of $\\kappa$, $h$, and $\\tau$? Provide your answer as a single closed-form analytic expression for $c$.", "solution": "We begin from the diffusion equation $- (\\kappa u^{\\prime})^{\\prime} = f$ on $(0,L)$ with homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(L)=0$. Introduce the first-order system\n$$\nq = -\\kappa u^{\\prime}, \\qquad -q^{\\prime} = f.\n$$\nIn the Hybridizable Discontinuous Galerkin (HDG) method with polynomial degree $k=0$ on a uniform mesh, the elementwise unknowns $(q,u)$ are constant on each element $K=[x_{i-1},x_i]$ with length $h$, and the trace $\\widehat{u}$ is a single scalar at each node $x_i$. The numerical flux is\n$$\n\\widehat{q}\\,n = q\\,n + \\tau\\,(u - \\widehat{u}) \\quad \\text{on } \\partial K,\n$$\nwith stabilization parameter $\\tau>0$ constant.\n\nLet $(\\cdot,\\cdot)_K$ denote the $L^2$ inner product on $K$ and $\\langle \\cdot, \\cdot \\rangle_{\\partial K}$ denote the sum over the two element faces. Since $k=0$, the test functions $r$ and $v$ are constants on $K$, thus $r^{\\prime} = 0$ and $v^{\\prime} = 0$. The local HDG equations on an element $K$ reduce to:\n$$\n(\\kappa^{-1} q, r)_K + \\langle \\widehat{u}, r\\,n \\rangle_{\\partial K} = 0, \\qquad \\langle \\widehat{q}\\,n, v \\rangle_{\\partial K} = (f, v)_K,\n$$\nfor all constant $r$ and $v$. Taking $r=1$ and $v=1$ and using $(\\kappa^{-1} q, 1)_K = \\kappa^{-1} q\\, h$ and $(f,1)_K = \\bar{f}_K\\, h$, where $\\bar{f}_K$ is the elementwise average of $f$ on $K$, and denoting the nodal trace values by $\\widehat{u}_{i-1}$ and $\\widehat{u}_{i}$ at the left and right endpoints, respectively, we obtain:\n$$\n\\kappa^{-1} q\\, h + \\big(\\widehat{u}_i \\cdot (+1) + \\widehat{u}_{i-1} \\cdot (-1)\\big) = 0,\n$$\nthat is,\n$$\nq = -\\kappa\\,\\frac{\\widehat{u}_i - \\widehat{u}_{i-1}}{h}.\n$$\nFor the second local equation, we sum the numerical flux contributions at both faces. With outward unit normals $n=-1$ at $x_{i-1}$ and $n=+1$ at $x_i$, and using $\\widehat{q}\\,n = q\\,n + \\tau (u - \\widehat{u})$ at each face, we get:\n$$\n\\langle \\widehat{q}\\,n, 1 \\rangle_{\\partial K}\n= \\big[q\\cdot(+1) + \\tau\\,(u - \\widehat{u}_i)\\big] + \\big[q\\cdot(-1) + \\tau\\,(u - \\widehat{u}_{i-1})\\big]\n= \\tau\\,[2u - (\\widehat{u}_i + \\widehat{u}_{i-1})].\n$$\nEquating with $(f,1)_K = \\bar{f}_K h$ gives the local relation\n$$\n\\tau\\,[2u - (\\widehat{u}_i + \\widehat{u}_{i-1})] = \\bar{f}_K\\, h,\n$$\nso that\n$$\nu = \\frac{1}{2}\\,(\\widehat{u}_i + \\widehat{u}_{i-1}) + \\frac{h}{2\\tau}\\,\\bar{f}_K.\n$$\n\nWe now impose the global HDG transmission condition at each interior node $x_i$, namely that the sum of numerical fluxes from the adjacent elements across the node vanishes:\n$$\n\\big(\\widehat{q}\\,n\\big)\\big|_{K_{L},\\,\\text{right face at }x_i} + \\big(\\widehat{q}\\,n\\big)\\big|_{K_{R},\\,\\text{left face at }x_i} = 0,\n$$\nwhere $K_L=[x_{i-1},x_i]$ and $K_R=[x_i,x_{i+1}]$. Using the previously derived local expressions on $K_L$ with $q_L = -\\kappa(\\widehat{u}_i - \\widehat{u}_{i-1})/h$ and $u_L = \\tfrac{1}{2}(\\widehat{u}_i + \\widehat{u}_{i-1}) + \\tfrac{h}{2\\tau}\\,\\bar{f}_{L}$, the numerical flux from the right face of $K_L$ is\n$$\n\\big(\\widehat{q}\\,n\\big)_{K_L,\\text{ right}} = q_L\\cdot(+1) + \\tau\\,(u_L - \\widehat{u}_i)\n= -\\frac{\\kappa}{h}\\,(\\widehat{u}_i - \\widehat{u}_{i-1}) + \\frac{\\tau}{2}\\,(\\widehat{u}_{i-1} - \\widehat{u}_i) + \\frac{h}{2}\\,\\bar{f}_L.\n$$\nSimilarly, on $K_R$ with $q_R = -\\kappa(\\widehat{u}_{i+1} - \\widehat{u}_i)/h$ and $u_R = \\tfrac{1}{2}(\\widehat{u}_{i+1} + \\widehat{u}_{i}) + \\tfrac{h}{2\\tau}\\,\\bar{f}_{R}$, the numerical flux from the left face is\n$$\n\\big(\\widehat{q}\\,n\\big)_{K_R,\\text{ left}} = q_R\\cdot(-1) + \\tau\\,(u_R - \\widehat{u}_i)\n= \\frac{\\kappa}{h}\\,(\\widehat{u}_{i+1} - \\widehat{u}_i) + \\frac{\\tau}{2}\\,(\\widehat{u}_{i+1} - \\widehat{u}_i) + \\frac{h}{2}\\,\\bar{f}_R.\n$$\nSumming and setting the result to zero yields the condensed global equation at interior node $x_i$:\n$$\n\\Big(\\frac{\\kappa}{h} + \\frac{\\tau}{2}\\Big)\\,\\widehat{u}_{i-1} - \\Big(2\\,\\frac{\\kappa}{h} + \\tau\\Big)\\,\\widehat{u}_{i} + \\Big(\\frac{\\kappa}{h} + \\frac{\\tau}{2}\\Big)\\,\\widehat{u}_{i+1}\n= -\\frac{h}{2}\\,(\\bar{f}_L + \\bar{f}_R).\n$$\nObserve that the left-hand side can be factored as\n$$\n\\Big(\\frac{\\kappa}{h} + \\frac{\\tau}{2}\\Big)\\,\\big(\\widehat{u}_{i-1} - 2\\,\\widehat{u}_i + \\widehat{u}_{i+1}\\big),\n$$\nbecause $- \\big(2\\,\\tfrac{\\kappa}{h} + \\tau\\big) = -2 \\big(\\tfrac{\\kappa}{h} + \\tfrac{\\tau}{2}\\big)$. Therefore, the condensed skeleton stiffness matrix on the interior nodes is exactly a constant multiple of the standard second-difference tridiagonal matrix with stencil $[1,\\,-2,\\,1]$.\n\nConsequently, the proportionality constant $c$ such that the condensed skeleton matrix equals $c$ times the standard second-difference matrix is\n$$\nc = \\frac{\\kappa}{h} + \\frac{\\tau}{2}.\n$$\nThis constant is independent of the source term $f$ and depends only on $\\kappa$, $h$, and the stabilization parameter $\\tau$.", "answer": "$$\\boxed{\\frac{\\kappa}{h}+\\frac{\\tau}{2}}$$", "id": "2566544"}, {"introduction": "A critical aspect of any numerical method is the efficiency with which the resulting linear system can be solved, a property governed by the system's condition number. This final practice moves beyond specific examples to the general analysis of the HDG skeleton system's spectral properties [@problem_id:2566528]. By applying core principles of numerical analysis, you will determine how the condition number scales with the mesh size $h$, polynomial degree $k$, and stabilization parameter $\\tau$, offering crucial insights into the method's robustness and performance in practical scenarios.", "problem": "Consider the diffusion model problem on a bounded, convex polygonal domain $\\Omega \\subset \\mathbb{R}^{2}$:\n$$\n-\\nabla \\cdot (\\nabla u) = f \\quad \\text{in } \\Omega, \\qquad u = 0 \\quad \\text{on } \\partial \\Omega,\n$$\nwith $f \\in L^{2}(\\Omega)$. Let $\\{\\mathcal{T}_{h}\\}_{h}$ be a family of shape-regular, quasi-uniform, simplicial meshes of $\\Omega$, with meshsize $h = \\max_{K \\in \\mathcal{T}_{h}} h_{K}$, where $h_{K} \\simeq h$. Consider the Hybridizable Discontinuous Galerkin (HDG) discretization of polynomial degree $k \\ge 1$ using the elemental spaces $[\\mathcal{P}_{k}(K)]^{2}$ for the flux, $\\mathcal{P}_{k}(K)$ for the scalar, and the skeleton trace space $\\mathcal{P}_{k}(F)$ on each mesh edge $F \\subset \\partial K$. Let the stabilization parameter be a positive scalar $\\tau$, assumed constant per face and independent of $h$ and $k$ unless explicitly shown; the numerical flux on faces is\n$$\n\\widehat{\\boldsymbol{q}}_{h} \\cdot \\boldsymbol{n} = \\boldsymbol{q}_{h} \\cdot \\boldsymbol{n} + \\tau \\,(u_{h} - \\widehat{u}_{h}),\n$$\nwhere $\\boldsymbol{n}$ is the outward unit normal to $\\partial K$. After static condensation of the local elemental unknowns $(\\boldsymbol{q}_{h}, u_{h})$, one obtains a global symmetric positive definite (SPD) linear system for the trace unknown $\\widehat{u}_{h}$ on the mesh skeleton,\n$$\nS \\,\\widehat{\\mathbf{u}} = \\widehat{\\mathbf{f}},\n$$\nwhere $S$ is assembled from elemental contributions and $\\widehat{\\mathbf{u}}$ collects the coefficients of $\\widehat{u}_{h}$ in a basis of the skeleton space. Denote by $M_{f}$ the skeleton (face) mass matrix corresponding to the $L^{2}$ inner product on $\\bigcup_{F} F$.\n\nDefine the generalized (spectral) condition number\n$$\n\\kappa\\big(M_{f}^{-1} S\\big) = \\frac{\\lambda_{\\max}\\big(M_{f}^{-1} S\\big)}{\\lambda_{\\min}\\big(M_{f}^{-1} S\\big)} = \\sup_{\\mu \\neq 0} \\frac{s(\\mu,\\mu)}{\\|\\mu\\|_{f}^{2}} \\,\\bigg/\\, \\inf_{\\mu \\neq 0} \\frac{s(\\mu,\\mu)}{\\|\\mu\\|_{f}^{2}},\n$$\nwhere $s(\\cdot,\\cdot)$ is the bilinear form associated with $S$ and $\\|\\mu\\|_{f}^{2} := \\sum_{F} \\int_{F} \\mu^{2} \\, \\mathrm{d}s$.\n\nStarting only from (i) the variational formulation of diffusion, (ii) the HDG local-global decomposition and numerical flux definition above, and (iii) standard polynomial inverse and trace inequalities on shape-regular meshes, derive the asymptotic dependence of $\\kappa(M_{f}^{-1} S)$ on the meshsize $h$, the polynomial degree $k$, and the stabilization $\\tau$. You may use the fact that, on each element $K$, the local Schur complement (Steklov–Poincaré) operator for the Laplacian maps traces in $\\mathcal{P}_{k}(\\partial K)$ to normal fluxes in $\\mathcal{P}_{k}(\\partial K)$ with spectrum, measured in the $L^{2}(\\partial K)$ inner product, whose extremal values scale like $c h^{-1}$ and $C k h^{-1}$ for $h$-quasiuniform meshes and shape-regular $K$, with constants $c, C$ independent of $h$, $k$, and $\\tau$.\n\nProvide your final asymptotic estimate for $\\kappa(M_{f}^{-1} S)$ as a single closed-form analytic expression that shows its dependence on $h$, $k$, and $\\tau$, up to multiplicative constants independent of $h$, $k$, and $\\tau$. No numerical rounding is required, and no physical units are to be reported. Express angles, if any, in radians. The final answer must be a single analytic expression.", "solution": "The problem as stated is valid. It is a well-posed question within the established field of numerical analysis for partial differential equations, specifically concerning the Hybridizable Discontinuous Galerkin (HDG) method. All terms are defined, the premises are scientifically sound, and the objective is clear. No contradictions or ambiguities are present.\n\nThe objective is to determine the asymptotic dependence of the spectral condition number $\\kappa(M_{f}^{-1} S)$ on the mesh size $h$, the polynomial degree $k$, and the stabilization parameter $\\tau$. The matrix $S$ is the global Schur complement matrix for the trace unknown $\\widehat{u}_{h}$, and $M_f$ is the face mass matrix. The condition number is defined as the ratio of the maximum to the minimum eigenvalue of the preconditioned operator $M_{f}^{-1} S$:\n$$\n\\kappa\\big(M_{f}^{-1} S\\big) \\;=\\; \\frac{\\lambda_{\\max}\\big(M_{f}^{-1} S\\big)}{\\lambda_{\\min}\\big(M_{f}^{-1} S\\big)}\n$$\nThe eigenvalues of $M_{f}^{-1} S$ are the generalized eigenvalues of the pair $(S, M_f)$, which can be found from the Rayleigh quotient:\n$$\n\\lambda\\big(M_{f}^{-1} S\\big) \\;=\\; \\frac{s(\\mu, \\mu)}{\\|\\mu\\|_{f}^{2}}\n$$\nwhere $s(\\cdot, \\cdot)$ is the bilinear form associated with the matrix $S$, and $\\|\\mu\\|_{f}^{2} = (\\mu, \\mu)_{M_f}$ is the squared $L^2$-norm on the mesh skeleton. The space of trace functions $\\mu$ is taken to be the space for $\\widehat{u}_h$, which incorporates the homogeneous Dirichlet boundary conditions $\\widehat{u}_h=0$ on $\\partial\\Omega$.\n\nThe bilinear form $s(\\mu, \\nu)$ is obtained by solving the local HDG equations on each element $K \\in \\mathcal{T}_h$ with trace data $\\mu$ and zero source term ($f=0$), yielding local solutions $(u_\\mu, \\boldsymbol{q}_\\mu)$, and then assembling the global weak form of the flux conservation law tested against $\\nu$. A standard result in HDG theory provides a symmetric, positive definite form for $s(\\mu, \\mu)$ which represents the energy of the system:\n$$\ns(\\mu, \\mu) = \\sum_{K \\in \\mathcal{T}_h} \\left( \\| \\nabla u_{\\mu} \\|_{0,K}^{2} + \\tau \\| u_{\\mu} - \\mu \\|_{0, \\partial K}^{2} \\right)\n$$\nHere, $\\| \\cdot \\|_{0,K}$ and $\\| \\cdot \\|_{0,\\partial K}$ denote the $L^2$-norms on the element $K$ and its boundary $\\partial K$, respectively. The skeleton norm is $\\|\\mu\\|_{f}^{2} = \\sum_{F \\in \\mathcal{E}_h} \\|\\mu\\|_{0,F}^2 \\simeq \\sum_{K \\in \\mathcal{T}_h} \\|\\mu\\|_{0,\\partial K}^2$, where the equivalence holds up to a constant factor due to the shape-regularity of the mesh.\n\nWe analyze the two terms in the bilinear form separately. Let us denote the part of the global matrix $S$ corresponding to the first term by $S_{DG}$ and the part corresponding to the second term by $S_{\\text{stab}}$. Then $S = S_{DG} + S_{\\text{stab}}$. Both matrices are symmetric and positive semi-definite. The preconditioned operator is $M_f^{-1} S = M_f^{-1} S_{DG} + M_f^{-1} S_{\\text{stab}}$.\n\n1.  **Analysis of the Steklov-Poincaré Term ($S_{DG}$):**\n    The first term, $\\sum_{K} \\| \\nabla u_{\\mu} \\|_{0,K}^{2}$, corresponds to the assembly of local discrete Steklov-Poincaré operators. The problem provides that the local operator $S_K^h$ which maps trace data $\\mu$ to the energy $\\|\\nabla u_\\mu\\|_{0,K}^2$ has eigenvalues (measured in the $L^2(\\partial K)$ inner product) bounded by:\n    $$\n    \\lambda_{\\min}(S_K^h) \\asymp c h^{-1}\n    $$\n    $$\n    \\lambda_{\\max}(S_K^h) \\asymp C k h^{-1}\n    $$\n    The notation $A \\asymp B$ signifies that the two quantities are proportional, i.e., $c_1 B \\le A \\le c_2 B$ for constants $c_1, c_2$ independent of $h, k, \\tau$.\n    The global operator $M_f^{-1} S_{DG}$ is the assembly of these local operators. For elliptic problems on quasi-uniform meshes, the spectrum of the global assembled operator inherits the bounds of the local operators. Thus, the eigenvalues of the preconditioned Steklov-Poincaré operator are bounded by:\n    $$\n    \\lambda_{\\min}\\big(M_{f}^{-1} S_{DG}\\big) \\asymp h^{-1}\n    $$\n    $$\n    \\lambda_{\\max}\\big(M_{f}^{-1} S_{DG}\\big) \\asymp k h^{-1}\n    $$\n    The lower bound is strictly positive due to the imposition of Dirichlet boundary conditions on $\\partial\\Omega$, which prevents constant trace functions from being in the trial space.\n\n2.  **Analysis of the Stabilization Term ($S_{\\text{stab}}$):**\n    The second term is $\\tau \\sum_{K} \\| u_{\\mu} - \\mu \\|_{0, \\partial K}^{2}$. The local function $u_\\mu$ is the discrete harmonic extension of the trace data $\\mu$. Let $P_K: \\mathcal{P}_k(\\partial K) \\to \\mathcal{P}_k(\\partial K)$ be the operator that maps $\\mu$ to $u_{\\mu}|_{\\partial K}$. The second term's contribution to the Rayleigh quotient is $\\tau \\frac{\\sum_K \\|(P_K-I)\\mu\\|^2_{0, \\partial K}}{\\sum_K \\|\\mu\\|^2_{0, \\partial K}}$. This is determined by the spectrum of the operator $(P-I)$, where $P$ is the block-diagonal operator with blocks $P_K$. A fundamental stability result for HDG methods is that the operator norm $\\|P_K - I\\|_{L^2(\\partial K) \\to L^2(\\partial K)}$ is bounded by a constant independent of $h$ and $k$. Furthermore, its kernel is trivial for any non-constant trace function due to the properties of harmonic extensions. Therefore, the eigenvalues of the corresponding preconditioned stabilization operator $M_f^{-1} S_{\\text{stab}} / \\tau$ are bounded from above and below by constants independent of $h, k, \\tau$.\n    $$\n    \\lambda_{\\min}\\big(\\tau^{-1} M_{f}^{-1} S_{\\text{stab}}\\big) \\asymp c_{\\text{stab}} > 0\n    $$\n    $$\n    \\lambda_{\\max}\\big(\\tau^{-1} M_{f}^{-1} S_{\\text{stab}}\\big) \\asymp C_{\\text{stab}}\n    $$\n    This implies:\n    $$\n    \\lambda_{\\min}\\big(M_{f}^{-1} S_{\\text{stab}}\\big) \\asymp \\tau\n    $$\n    $$\n    \\lambda_{\\max}\\big(M_{f}^{-1} S_{\\text{stab}}\\big) \\asymp \\tau\n    $$\n\n3.  **Combining the Bounds:**\n    We use the property for symmetric positive definite matrices that $\\lambda_{\\max}(A+B) \\le \\lambda_{\\max}(A) + \\lambda_{\\max}(B)$ and $\\lambda_{\\min}(A+B) \\ge \\lambda_{\\min}(A) + \\lambda_{\\min}(B)$.\n    \n    For the maximum eigenvalue of $M_f^{-1} S$:\n    $$\n    \\lambda_{\\max}\\big(M_{f}^{-1} S\\big) \\le \\lambda_{\\max}\\big(M_{f}^{-1} S_{DG}\\big) + \\lambda_{\\max}\\big(M_{f}^{-1} S_{\\text{stab}}\\big)\n    $$\n    Since both terms contribute to the upper bound, we have $\\lambda_{\\max}\\big(M_{f}^{-1} S\\big) \\asymp \\lambda_{\\max}\\big(M_{f}^{-1} S_{DG}\\big) + \\lambda_{\\max}\\big(M_{f}^{-1} S_{\\text{stab}}\\big)$.\n    $$\n    \\lambda_{\\max}\\big(M_{f}^{-1} S\\big) \\asymp k h^{-1} + \\tau\n    $$\n    For the minimum eigenvalue of $M_f^{-1} S$:\n    $$\n    \\lambda_{\\min}\\big(M_{f}^{-1} S\\big) \\ge \\lambda_{\\min}\\big(M_{f}^{-1} S_{DG}\\big) + \\lambda_{\\min}\\big(M_{f}^{-1} S_{\\text{stab}}\\big)\n    $$\n    The infimum will be determined by whichever term is smaller, but the sum provides a lower bound. A tighter argument shows that the minimum eigenvalue is asymptotically equivalent to the sum of the minimum eigenvalues.\n    $$\n    \\lambda_{\\min}\\big(M_{f}^{-1} S\\big) \\asymp h^{-1} + \\tau\n    $$\n\n4.  **Final Asymptotic Estimate:**\n    The condition number is the ratio of these bounds:\n    $$\n    \\kappa\\big(M_{f}^{-1} S\\big) = \\frac{\\lambda_{\\max}\\big(M_{f}^{-1} S\\big)}{\\lambda_{\\min}\\big(M_{f}^{-1} S\\big)} \\asymp \\frac{k h^{-1} + \\tau}{h^{-1} + \\tau}\n    $$\n    To obtain a cleaner form, we multiply the numerator and denominator by $h$:\n    $$\n    \\kappa\\big(M_{f}^{-1} S\\big) \\asymp \\frac{k + \\tau h}{1 + \\tau h}\n    $$\n    This expression shows that if the stabilization is small ($\\tau h \\ll 1$), the condition number scales with the polynomial degree $k$. If the stabilization is large ($\\tau h \\gg 1$), the condition number approaches a constant independent of $k$ and $h$.", "answer": "$$\n\\boxed{\\frac{k + \\tau h}{1 + \\tau h}}\n$$", "id": "2566528"}]}