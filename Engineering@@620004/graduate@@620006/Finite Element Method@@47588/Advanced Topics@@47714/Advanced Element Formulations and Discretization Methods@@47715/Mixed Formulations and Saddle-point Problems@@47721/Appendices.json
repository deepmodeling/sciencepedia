{"hands_on_practices": [{"introduction": "The stability of any mixed formulation hinges on the Ladyzhenskaya–Babuška–Brezzi (LBB), or \"inf-sup\", condition, which guarantees a unique and stable solution. This foundational exercise guides you through the exact calculation of the inf-sup constant $\\beta$ for a simplified one-dimensional problem. By directly manipulating the definitions of the function spaces, you will develop a concrete intuition for this critical theoretical requirement.", "problem": "Consider the one-dimensional domain $\\Omega=(0,1)$ and the mixed formulation with bilinear form $b:V\\times Q\\to\\mathbb{R}$ defined by\n$$\nb(v,q)=\\int_{0}^{1} v'(x)\\,q(x)\\,dx,\n$$\nwhere $V$ and $Q$ are Hilbert spaces specified below, and the norms are given by $\\|v\\|_{V}=\\|v'\\|_{L^{2}(0,1)}$ and $\\|q\\|_{Q}=\\|q\\|_{L^{2}(0,1)}$. The inf-sup constant $\\beta$ associated with $b$ is defined by\n$$\n\\beta=\\inf_{q\\in Q\\setminus\\{0\\}}\\ \\sup_{v\\in V\\setminus\\{0\\}}\\ \\frac{b(v,q)}{\\|v\\|_{V}\\,\\|q\\|_{Q}}.\n$$\nAssume the primary setting $V=H_{0}^{1}(0,1)$ and $Q=L_{0}^{2}(0,1)$, where $H_{0}^{1}(0,1)$ denotes the Sobolev space with trace zero at $x=0$ and $x=1$, and $L_{0}^{2}(0,1)$ denotes the subspace of $L^{2}(0,1)$ consisting of functions with zero mean over $(0,1)$. Starting from the fundamental definition of the Sobolev space $H^{1}(0,1)$ and the Cauchy–Schwarz inequality, compute the exact value of the inf-sup constant $\\beta$ for this primary setting.\n\nWithin your solution, briefly and rigorously discuss how $\\beta$ would change (increase, decrease, or remain the same) under the following alternative boundary and codomain choices, justifying your conclusions from first principles without invoking pre-packaged formulas:\n- Case $\\mathrm{A}$: $V=H_{0}^{1}(0,1)$ and $Q=L^{2}(0,1)$.\n- Case $\\mathrm{B}$: $V=\\{v\\in H^{1}(0,1): v(0)=0\\}$ and $Q=L^{2}(0,1)$.\n\nYour final submitted answer must be the exact value of $\\beta$ for the primary setting, expressed as a single real number with no units.", "solution": "The problem is to compute the inf-sup constant $\\beta$ associated with the bilinear form $b(v,q)=\\int_{0}^{1} v'(x)\\,q(x)\\,dx$ for specified Hilbert spaces $V$ and $Q$. The constant is defined as\n$$\n\\beta=\\inf_{q\\in Q\\setminus\\{0\\}}\\ \\sup_{v\\in V\\setminus\\{0\\}}\\ \\frac{b(v,q)}{\\|v\\|_{V}\\,\\|q\\|_{Q}}\n$$\nwhere the norms are given by $\\|v\\|_{V}=\\|v'\\|_{L^{2}(0,1)}$ and $\\|q\\|_{Q}=\\|q\\|_{L^{2}(0,1)}$. The $L^2(0,1)$ inner product is denoted by $(f,g)_{L^2} = \\int_{0}^{1} f(x)g(x)\\,dx$.\n\nThe problem is mathematically well-posed. The seminorm $\\|v'\\|_{L^2(0,1)}$ qualifies as a norm on $V=H_0^1(0,1)$ and on $V=\\{v\\in H^1(0,1):v(0)=0\\}$ due to the Poincaré-Friedrichs inequality, which guarantees control of the $\\|v\\|_{L^2(0,1)}$ norm by the $\\|v'\\|_{L^2(0,1)}$ norm for functions vanishing at least at one point in the domain. We proceed to solve for each case.\n\n**Primary Setting: $V=H_{0}^{1}(0,1)$ and $Q=L_{0}^{2}(0,1)$**\n\nFor this setting, the inf-sup constant is\n$$\n\\beta=\\inf_{q\\in L_{0}^{2}(0,1)\\setminus\\{0\\}}\\ \\sup_{v\\in H_{0}^{1}(0,1)\\setminus\\{0\\}}\\ \\frac{(v',q)_{L^2}}{\\|v'\\|_{L^{2}(0,1)}\\,\\|q\\|_{L^{2}(0,1)}}.\n$$\nLet us fix an arbitrary $q \\in Q \\setminus \\{0\\}$, which is $L_{0}^{2}(0,1)$; this means $\\int_{0}^{1} q(x)\\,dx=0$ and $\\|q\\|_{L^2(0,1)} \\neq 0$. We first evaluate the supremum term:\n$$\nS_q = \\sup_{v\\in H_{0}^{1}(0,1)\\setminus\\{0\\}}\\ \\frac{(v',q)_{L^2}}{\\|v'\\|_{L^{2}(0,1)}}.\n$$\nLet $V'$ be the space of derivatives of functions in $V$, i.e., $V'=\\{u=v' : v \\in H_{0}^{1}(0,1)\\}$. The term $S_q$ can be rewritten as\n$$\nS_q = \\sup_{u\\in V'\\setminus\\{0\\}}\\ \\frac{(u,q)_{L^2}}{\\|u\\|_{L^{2}(0,1)}}.\n$$\nWe must characterize the space $V'$.\nA function $v$ is in $H^1(0,1)$ if $v$ and its weak derivative $v'$ are in $L^2(0,1)$. This implies $v$ is absolutely continuous. By the fundamental theorem of calculus for Lebesgue integrals, for any $v \\in H_0^1(0,1)$, we have $v(1)-v(0) = \\int_0^1 v'(x) dx$. Since $v \\in H_0^1(0,1)$, $v(0)=v(1)=0$, which implies $\\int_0^1 v'(x) dx = 0$. This shows that $v' \\in L_0^2(0,1)$. Therefore, $V' \\subseteq L_0^2(0,1)$.\n\nConversely, let $u$ be an arbitrary function in $L_0^2(0,1)$. Define a function $v$ by $v(x) = \\int_0^x u(t) dt$. Since $u \\in L^2(0,1)$, $v$ is absolutely continuous and its derivative is $v'(x)=u(x)$ almost everywhere. Thus, $v \\in H^1(0,1)$. We check the boundary conditions:\n- $v(0) = \\int_0^0 u(t) dt = 0$.\n- $v(1) = \\int_0^1 u(t) dt = 0$, because $u \\in L_0^2(0,1)$.\nTherefore, $v \\in H_0^1(0,1)$ and $v'=u$. This establishes that for any $u \\in L_0^2(0,1)$, there exists a $v \\in H_0^1(0,1)$ such that $v'=u$. So, $L_0^2(0,1) \\subseteq V'$.\n\nCombining both inclusions, we have $V' = L_0^2(0,1)$, which is exactly the space $Q$.\nThe supremum term $S_q$ is thus taken over $u \\in L_0^2(0,1)$:\n$$\nS_q = \\sup_{u\\in L_{0}^{2}(0,1)\\setminus\\{0\\}}\\ \\frac{(u,q)_{L^2}}{\\|u\\|_{L^{2}(0,1)}}.\n$$\nSince $q$ itself is in $L_0^2(0,1)$, we can choose $u=q$. This choice gives $\\frac{(q,q)_{L^2}}{\\|q\\|_{L^2(0,1)}} = \\|q\\|_{L^2(0,1)}$. By the Cauchy-Schwarz inequality, $|(u,q)_{L^2}| \\le \\|u\\|_{L^2(0,1)}\\|q\\|_{L^2(0,1)}$, so the supremum is indeed achieved when $u$ is proportional to $q$, and its value is $\\|q\\|_{L^2(0,1)}$. Thus, $S_q = \\|q\\|_{Q}$.\n\nFinally, we substitute this result back into the definition of $\\beta$:\n$$\n\\beta = \\inf_{q\\in Q\\setminus\\{0\\}} \\frac{S_q}{\\|q\\|_Q} = \\inf_{q\\in L_0^2(0,1)\\setminus\\{0\\}} \\frac{\\|q\\|_{L^2(0,1)}}{\\|q\\|_{L^2(0,1)}} = \\inf_{q\\in L_0^2(0,1)\\setminus\\{0\\}} 1 = 1.\n$$\nThe exact value of the inf-sup constant is $1$.\n\n**Analysis of Alternative Settings**\n\n**Case A: $V=H_{0}^{1}(0,1)$ and $Q=L^{2}(0,1)$**\nThe space $V$ is unchanged, so the space of derivatives $V'$ is still $L_0^2(0,1)$. The space $Q$ is now the full $L^2(0,1)$. The inf-sup constant is\n$$\n\\beta_A = \\inf_{q\\in L^{2}(0,1)\\setminus\\{0\\}}\\ \\sup_{v\\in H_{0}^{1}(0,1)\\setminus\\{0\\}}\\ \\frac{(v',q)_{L^2}}{\\|v'\\|_{L^{2}(0,1)}\\,\\|q\\|_{L^{2}(0,1)}}.\n$$\nFix an arbitrary $q \\in L^2(0,1) \\setminus \\{0\\}$. The supremum is over $v' = u \\in L_0^2(0,1)$.\nAny $q \\in L^2(0,1)$ can be uniquely decomposed as $q = q_0 + c$, where $q_0 \\in L_0^2(0,1)$ and $c$ is a constant function. The constant is the mean value of $q$, $c=\\int_0^1 q(x) dx$. This decomposition is orthogonal, i.e., $(q_0, c)_{L^2}=0$.\nFor any $u \\in L_0^2(0,1)$, the inner product with $q$ is\n$$\n(u,q)_{L^2} = (u, q_0+c)_{L^2} = (u,q_0)_{L^2} + (u,c)_{L^2}.\n$$\nThe second term is $(u,c)_{L^2} = \\int_0^1 u(x)c\\,dx = c \\int_0^1 u(x)\\,dx = 0$, since $u \\in L_0^2(0,1)$.\nTherefore, $(u,q)_{L^2} = (u,q_0)_{L^2}$. The supremum term is\n$$\n\\sup_{u\\in L_0^2(0,1)\\setminus\\{0\\}} \\frac{(u,q_0)_{L^2}}{\\|u\\|_{L^2(0,1)}} = \\|q_0\\|_{L^2(0,1)}.\n$$\nThe inf-sup constant is the infimum of the ratio of this supremum to $\\|q\\|_{L^2(0,1)}$:\n$$\n\\beta_A = \\inf_{q\\in L^2(0,1)\\setminus\\{0\\}} \\frac{\\|q_0\\|_{L^2(0,1)}}{\\|q\\|_{L^2(0,1)}}.\n$$\nBy orthogonality, $\\|q\\|_{L^2(0,1)}^2 = \\|q_0\\|_{L^2(0,1)}^2 + \\|c\\|_{L^2(0,1)}^2$. We seek the infimum of $\\frac{\\|q_0\\|_{L^2(0,1)}}{\\sqrt{\\|q_0\\|_{L^2(0,1)}^2 + \\|c\\|_{L^2(0,1)}^2}}$.\nConsider a non-zero constant function $q(x) = C \\neq 0$. For such a function, its mean value is $c=C$, and its zero-mean part is $q_0 = q-c = 0$. For this choice of $q$, the ratio is $\\frac{0}{\\|C\\|_{L^2(0,1)}} = 0$.\nThe infimum is thus $0$. So, $\\beta_A=0$. The constant decreases from $1$ to $0$. This signifies that the problem is ill-posed for this choice of spaces, because there are functions in $Q$ (constant functions) that are in the kernel of the adjoint operator.\n\n**Case B: $V=\\{v\\in H^{1}(0,1): v(0)=0\\}$ and $Q=L^{2}(0,1)$**\nIn this case, the space $V$ is enlarged, imposing only one boundary condition. The space $Q$ is $L^2(0,1)$. The inf-sup constant is\n$$\n\\beta_B = \\inf_{q\\in L^{2}(0,1)\\setminus\\{0\\}}\\ \\sup_{v\\in V\\setminus\\{0\\}}\\ \\frac{(v',q)_{L^2}}{\\|v'\\|_{L^{2}(0,1)}\\,\\|q\\|_{L^{2}(0,1)}}.\n$$\nLet us characterize the space of derivatives $V' = \\{u=v' : v \\in V\\}$.\nLet $u$ be any function in $L^2(0,1)$. Define $v(x) = \\int_0^x u(t) dt$. Then $v \\in H^1(0,1)$ with $v'=u$ a.e., and $v(0)=0$. Thus, $v \\in V$. This construction shows that any $u \\in L^2(0,1)$ is the derivative of some function in $V$. Therefore, $V'=L^2(0,1)$, which is the same as the space $Q$.\nFor a fixed $q \\in Q \\setminus \\{0\\}$, the supremum is\n$$\n\\sup_{v\\in V\\setminus\\{0\\}} \\frac{(v',q)_{L^2}}{\\|v'\\|_{L^2(0,1)}} = \\sup_{u\\in L^2(0,1)\\setminus\\{0\\}} \\frac{(u,q)_{L^2}}{\\|u\\|_{L^2(0,1)}}.\n$$\nSince $q$ itself is in $L^2(0,1)$, by choosing $u=q$ and invoking the Cauchy-Schwarz inequality, we find the supremum to be $\\|q\\|_{L^2(0,1)}$.\nSubstituting this into the definition of $\\beta_B$:\n$$\n\\beta_B = \\inf_{q\\in L^2(0,1)\\setminus\\{0\\}} \\frac{\\|q\\|_{L^2(0,1)}}{\\|q\\|_{L^2(0,1)}} = 1.\n$$\nIn this case, the value of the inf-sup constant is $1$, which means it remains the same as in the primary setting. By relaxing the boundary condition on $v$ at $x=1$, we enlarge the space of test functions $V$ such that the space of their derivatives $V'$ becomes the entire $L^2(0,1)$. This larger set of derivatives is sufficient to overcome the issue seen in Case A, leading to a stable formulation.", "answer": "$$\n\\boxed{1}\n$$", "id": "2577764"}, {"introduction": "While theoretically essential, many convenient finite element pairings—such as equal-order elements for velocity and pressure—fail to satisfy the LBB condition. This practice introduces a powerful solution: the Pressure-Stabilizing/Petrov-Galerkin (PSPG) method, which restores stability by augmenting the weak form. Deriving the stabilized formulation for the Stokes equations will give you hands-on experience in designing robust numerical methods for systems that are inherently unstable.", "problem": "Consider the steady incompressible Stokes system on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{d}$ with $d \\in \\{2,3\\}$, viscosity $\\mu > 0$, body force $\\boldsymbol{f} \\in [L^{2}(\\Omega)]^{d}$, and homogeneous Dirichlet boundary conditions for the velocity on $\\partial \\Omega$:\n$$\n-\\mu \\Delta \\boldsymbol{u} + \\nabla p = \\boldsymbol{f} \\quad \\text{in } \\Omega, \n\\qquad \n\\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega,\n\\qquad \n\\boldsymbol{u} = \\boldsymbol{0} \\quad \\text{on } \\partial \\Omega.\n$$\nStart from the standard variational formulation obtained by multiplying the momentum equation by a velocity test function $\\boldsymbol{v} \\in [H_{0}^{1}(\\Omega)]^{d}$ and the incompressibility equation by a pressure test function $q \\in L_{0}^{2}(\\Omega)$, integrating over $\\Omega$, and integrating by parts where appropriate under the given boundary conditions. Assume conforming equal-order finite element spaces $V_{h} \\subset [H_{0}^{1}(\\Omega)]^{d}$ and $Q_{h} \\subset L_{0}^{2}(\\Omega)$ for velocity and pressure, respectively, constructed from continuous piecewise polynomials of the same degree on a shape-regular mesh $\\mathcal{T}_{h}$ of $\\Omega$.\n\nTo circumvent violation of the Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup condition for equal-order spaces, adopt a Pressure-Stabilizing/Petrov–Galerkin (PSPG) stabilization: augment the discrete continuity equation by a consistent elementwise least-squares term formed from the momentum residual weighted by the pressure test function gradient. Specifically, on each element $K \\in \\mathcal{T}_{h}$ with a stabilization parameter $\\tau_{K} > 0$, add\n$$\n\\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} \\, \\big( -\\mu \\Delta \\boldsymbol{u}_{h} + \\nabla p_{h} - \\boldsymbol{f} , \\nabla q_{h} \\big)_{K},\n$$\nwhere $(\\cdot,\\cdot)_{K}$ denotes the $L^{2}(K)$ inner product. Under the common equal-order choice with piecewise linear trial and test spaces, the velocity is affine on each element, so that $\\Delta \\boldsymbol{u}_{h} = \\boldsymbol{0}$ in each $K$, and the above PSPG term reduces to the pressure-gradient stabilization\n$$\n\\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} \\, \\big( \\nabla p_{h}, \\nabla q_{h} \\big)_{K} - \\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} \\, \\big( \\boldsymbol{f}, \\nabla q_{h} \\big)_{K}.\n$$\nDerive the stabilized weak form and write the full stabilized bilinear form $A_{h} \\big( (\\boldsymbol{u}_{h},p_{h}), (\\boldsymbol{v}_{h}, q_{h}) \\big)$ and stabilized linear functional $F_{h}(\\boldsymbol{v}_{h},q_{h})$ that incorporate the Galerkin terms and the reduced PSPG pressure-gradient stabilization term above.\n\nThen, to verify consistency of the stabilization term, consider the single-element case $\\Omega = K = (0,1)^{2}$ with constant $\\tau_{K} = \\tau > 0$. For the purely stabilization contribution involving pressure and pressure test functions, take\n$$\np_{h}(x,y) = \\kappa x + \\lambda y, \n\\qquad \nq_{h}(x,y) = \\zeta (x + y),\n$$\nwith constants $\\kappa, \\lambda, \\zeta \\in \\mathbb{R}$. Compute the value of the elementwise stabilization term\n$$\ns_{p}(p_{h}, q_{h}) := \\tau \\, \\big( \\nabla p_{h}, \\nabla q_{h} \\big)_{K}.\n$$\nExpress your final result as a single symbolic expression in terms of $\\tau, \\kappa, \\lambda, \\zeta$. No numerical rounding is required. No units are required.", "solution": "The problem presented is a standard exercise in the numerical analysis of partial differential equations, specifically concerning the finite element method for the incompressible Stokes equations. It is scientifically sound, mathematically well-posed, and contains all necessary information for its resolution. We will proceed with the derivation and calculation as requested.\n\nThe strong form of the steady incompressible Stokes problem is given as:\n$$\n-\\mu \\Delta \\boldsymbol{u} + \\nabla p = \\boldsymbol{f} \\quad \\text{in } \\Omega\n$$\n$$\n\\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega\n$$\n$$\n\\boldsymbol{u} = \\boldsymbol{0} \\quad \\text{on } \\partial \\Omega\n$$\nHere, $\\boldsymbol{u}$ is the velocity field, $p$ is the pressure, $\\boldsymbol{f}$ is a body force, and $\\mu > 0$ is the constant fluid viscosity. The domain $\\Omega \\subset \\mathbb{R}^{d}$ for $d \\in \\{2, 3\\}$ is a bounded Lipschitz domain.\n\nTo derive the standard weak formulation, we select test functions $\\boldsymbol{v}$ for the momentum equation and $q$ for the continuity equation from appropriate function spaces. We choose the velocity test function $\\boldsymbol{v}$ from $[H_{0}^{1}(\\Omega)]^{d}$ to naturally incorporate the homogeneous Dirichlet boundary condition, and the pressure test function $q$ from $L_{0}^{2}(\\Omega)$, the space of square-integrable functions with zero mean over $\\Omega$.\n\nWe multiply the momentum equation by $\\boldsymbol{v}$, integrate over $\\Omega$, and apply integration by parts to the viscous term and the pressure gradient term.\nFor the viscous term, using Green's first identity:\n$$\n\\int_{\\Omega} (-\\mu \\Delta \\boldsymbol{u}) \\cdot \\boldsymbol{v} \\, d\\Omega = \\int_{\\Omega} \\mu \\nabla \\boldsymbol{u} : \\nabla \\boldsymbol{v} \\, d\\Omega - \\int_{\\partial \\Omega} \\mu (\\nabla \\boldsymbol{u} \\cdot \\boldsymbol{n}) \\cdot \\boldsymbol{v} \\, dS\n$$\nThe boundary integral vanishes because $\\boldsymbol{v} = \\boldsymbol{0}$ on $\\partial \\Omega$.\nFor the pressure term, using the definition of the divergence operator and its adjoint relationship with the gradient:\n$$\n\\int_{\\Omega} (\\nabla p) \\cdot \\boldsymbol{v} \\, d\\Omega = - \\int_{\\Omega} p (\\nabla \\cdot \\boldsymbol{v}) \\, d\\Omega + \\int_{\\partial \\Omega} p (\\boldsymbol{v} \\cdot \\boldsymbol{n}) \\, dS\n$$\nAgain, the boundary integral vanishes because $\\boldsymbol{v} = \\boldsymbol{0}$ on $\\partial \\Omega$.\nThus, the weak form of the momentum equation is:\n$$\n\\mu (\\nabla \\boldsymbol{u}, \\nabla \\boldsymbol{v})_{\\Omega} - (p, \\nabla \\cdot \\boldsymbol{v})_{\\Omega} = (\\boldsymbol{f}, \\boldsymbol{v})_{\\Omega}\n$$\nwhere $(\\cdot, \\cdot)_{\\Omega}$ denotes the $L^{2}(\\Omega)$ inner product.\n\nThe weak form of the continuity equation is obtained by multiplying by $q$ and integrating over $\\Omega$:\n$$\n(\\nabla \\cdot \\boldsymbol{u}, q)_{\\Omega} = 0\n$$\n\nCombining these two equations yields the standard mixed variational formulation: find $(\\boldsymbol{u}, p) \\in [H_{0}^{1}(\\Omega)]^{d} \\times L_{0}^{2}(\\Omega)$ such that for all $(\\boldsymbol{v}, q) \\in [H_{0}^{1}(\\Omega)]^{d} \\times L_{0}^{2}(\\Omega)$:\n$$\n\\mu (\\nabla \\boldsymbol{u}, \\nabla \\boldsymbol{v})_{\\Omega} - (p, \\nabla \\cdot \\boldsymbol{v})_{\\Omega} + (\\nabla \\cdot \\boldsymbol{u}, q)_{\\Omega} = (\\boldsymbol{f}, \\boldsymbol{v})_{\\Omega}\n$$\n\nUpon discretization using conforming finite element spaces $V_{h} \\subset [H_{0}^{1}(\\Omega)]^{d}$ and $Q_{h} \\subset L_{0}^{2}(\\Omega)$, the problem becomes: find $(\\boldsymbol{u}_{h}, p_{h}) \\in V_{h} \\times Q_{h}$ such that for all $(\\boldsymbol{v}_{h}, q_{h}) \\in V_{h} \\times Q_{h}$:\n$$\n\\mu (\\nabla \\boldsymbol{u}_{h}, \\nabla \\boldsymbol{v}_{h})_{\\Omega} - (p_{h}, \\nabla \\cdot \\boldsymbol{v}_{h})_{\\Omega} + (\\nabla \\cdot \\boldsymbol{u}_{h}, q_{h})_{\\Omega} = (\\boldsymbol{f}, \\boldsymbol{v}_{h})_{\\Omega}\n$$\n\nThe problem states that for equal-order interpolation, a Pressure-Stabilizing/Petrov-Galerkin (PSPG) term must be added to satisfy the discrete inf-sup condition. The specified term, simplified for piecewise linear elements where $\\Delta \\boldsymbol{u}_{h} = \\boldsymbol{0}$ elementwise, is added to the weak formulation. This term acts on the test pressure function $q_{h}$ and is given by:\n$$\n\\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} \\, \\big( \\nabla p_{h}, \\nabla q_{h} \\big)_{K} - \\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} \\, \\big( \\boldsymbol{f}, \\nabla q_{h} \\big)_{K}\n$$\nAdding this to the standard Galerkin formulation gives the stabilized problem: find $(\\boldsymbol{u}_{h}, p_{h}) \\in V_{h} \\times Q_{h}$ such that for all $(\\boldsymbol{v}_{h}, q_{h}) \\in V_{h} \\times Q_{h}$:\n$$\n\\mu (\\nabla \\boldsymbol{u}_{h}, \\nabla \\boldsymbol{v}_{h})_{\\Omega} - (p_{h}, \\nabla \\cdot \\boldsymbol{v}_{h})_{\\Omega} + (\\nabla \\cdot \\boldsymbol{u}_{h}, q_{h})_{\\Omega} + \\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} (\\nabla p_{h}, \\nabla q_{h})_{K} = (\\boldsymbol{f}, \\boldsymbol{v}_{h})_{\\Omega} + \\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} (\\boldsymbol{f}, \\nabla q_{h})_{K}\n$$\n\nWe are asked to write this in the form $A_{h} \\big( (\\boldsymbol{u}_{h},p_{h}), (\\boldsymbol{v}_{h}, q_{h}) \\big) = F_{h}(\\boldsymbol{v}_{h},q_{h})$. The bilinear form $A_{h}$ consists of terms dependent on the trial functions $(\\boldsymbol{u}_{h},p_{h})$, while the linear functional $F_{h}$ consists of terms dependent only on the test functions $(\\boldsymbol{v}_{h},q_{h})$ and data.\nBy inspection, we identify:\nThe stabilized bilinear form is:\n$$\nA_{h} \\big( (\\boldsymbol{u}_{h},p_{h}), (\\boldsymbol{v}_{h}, q_{h}) \\big) = \\mu (\\nabla \\boldsymbol{u}_{h}, \\nabla \\boldsymbol{v}_{h})_{\\Omega} - (p_{h}, \\nabla \\cdot \\boldsymbol{v}_{h})_{\\Omega} + (\\nabla \\cdot \\boldsymbol{u}_{h}, q_{h})_{\\Omega} + \\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} (\\nabla p_{h}, \\nabla q_{h})_{K}\n$$\nThe stabilized linear functional is:\n$$\nF_{h}(\\boldsymbol{v}_{h},q_{h}) = (\\boldsymbol{f}, \\boldsymbol{v}_{h})_{\\Omega} + \\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} (\\boldsymbol{f}, \\nabla q_{h})_{K}\n$$\nNoting that integrals over $\\Omega$ can be written as a sum of integrals over elements $K$, these forms are:\n$$\nA_{h} \\big( (\\boldsymbol{u}_{h},p_{h}), (\\boldsymbol{v}_{h}, q_{h}) \\big) = \\sum_{K \\in \\mathcal{T}_{h}} \\Big[ \\mu (\\nabla \\boldsymbol{u}_{h}, \\nabla \\boldsymbol{v}_{h})_{K} - (p_{h}, \\nabla \\cdot \\boldsymbol{v}_{h})_{K} + (\\nabla \\cdot \\boldsymbol{u}_{h}, q_{h})_{K} + \\tau_{K} (\\nabla p_{h}, \\nabla q_{h})_{K} \\Big]\n$$\n$$\nF_{h}(\\boldsymbol{v}_{h},q_{h}) = \\sum_{K \\in \\mathcal{T}_{h}} \\Big[ (\\boldsymbol{f}, \\boldsymbol{v}_{h})_{K} + \\tau_{K} (\\boldsymbol{f}, \\nabla q_{h})_{K} \\Big]\n$$\n\nNext, we address the second part of the problem. We must compute the value of the pressure-pressure part of the stabilization term, $s_{p}(p_{h}, q_{h}) := \\tau \\, \\big( \\nabla p_{h}, \\nabla q_{h} \\big)_{K}$, on a single element.\nThe given data are:\n-   Domain: A single square element $K = (0,1)^{2}$.\n-   Stabilization parameter: A constant $\\tau > 0$.\n-   Pressure trial function: $p_{h}(x,y) = \\kappa x + \\lambda y$, where $\\kappa, \\lambda \\in \\mathbb{R}$.\n-   Pressure test function: $q_{h}(x,y) = \\zeta (x + y)$, where $\\zeta \\in \\mathbb{R}$.\n\nFirst, we compute the gradients of $p_{h}$ and $q_{h}$.\nThe gradient of $p_{h}$ is:\n$$\n\\nabla p_{h}(x,y) = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(\\kappa x + \\lambda y) \\\\ \\frac{\\partial}{\\partial y}(\\kappa x + \\lambda y) \\end{pmatrix} = \\begin{pmatrix} \\kappa \\\\ \\lambda \\end{pmatrix}\n$$\nThe gradient of $q_{h}$ is:\n$$\n\\nabla q_{h}(x,y) = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(\\zeta x + \\zeta y) \\\\ \\frac{\\partial}{\\partial y}(\\zeta x + \\zeta y) \\end{pmatrix} = \\begin{pmatrix} \\zeta \\\\ \\zeta \\end{pmatrix}\n$$\nBoth gradients are constant vectors on the element $K$.\n\nNext, we compute the dot product of these gradients:\n$$\n\\nabla p_{h} \\cdot \\nabla q_{h} = \\begin{pmatrix} \\kappa \\\\ \\lambda \\end{pmatrix} \\cdot \\begin{pmatrix} \\zeta \\\\ \\zeta \\end{pmatrix} = \\kappa \\zeta + \\lambda \\zeta = (\\kappa + \\lambda) \\zeta\n$$\nThis product is also a constant.\n\nFinally, we compute the term $s_{p}(p_{h}, q_{h})$ by integrating this constant dot product over the element $K$ and multiplying by $\\tau$:\n$$\ns_{p}(p_{h}, q_{h}) = \\tau \\int_{K} (\\nabla p_{h} \\cdot \\nabla q_{h}) \\, dK = \\tau \\int_{(0,1)^2} (\\kappa + \\lambda) \\zeta \\, dx dy\n$$\nSince the integrand is constant, we can factor it out of the integral:\n$$\ns_{p}(p_{h}, q_{h}) = \\tau (\\kappa + \\lambda) \\zeta \\int_{0}^{1} \\int_{0}^{1} \\, dx dy\n$$\nThe integral $\\int_{0}^{1} \\int_{0}^{1} \\, dx dy$ is simply the area of the unit square $K$, which is $1$.\nTherefore, the value of the stabilization term is:\n$$\ns_{p}(p_{h}, q_{h}) = \\tau (\\kappa + \\lambda) \\zeta \\cdot 1 = \\tau \\zeta (\\kappa + \\lambda)\n$$\nThis is the final symbolic expression for the requested term.", "answer": "$$\\boxed{\\tau \\zeta (\\kappa + \\lambda)}$$", "id": "2577752"}, {"introduction": "A theoretically stable method can still fail in practice if implemented carelessly. This exercise tackles a subtle but crucial aspect of implementation: the impact of numerical quadrature on stability. You will determine the minimum quadrature accuracy needed to preserve the stability of the classic Taylor-Hood element, learning to connect the polynomial degree of your basis functions to the practical choice of an integration rule.", "problem": "Consider the steady Stokes equations on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{2}$ with viscosity $\\nu>0$: find velocity $u \\in [H_{0}^{1}(\\Omega)]^{2}$ and pressure $p \\in L_{0}^{2}(\\Omega)$ such that the saddle-point variational problem holds for all $v \\in [H_{0}^{1}(\\Omega)]^{2}$ and $q \\in L_{0}^{2}(\\Omega)$,\n$$\na(u,v)+b(v,p)+b(u,q)=\\ell(v),\n$$\nwhere $a(u,v):=\\int_{\\Omega} 2\\nu\\,\\varepsilon(u):\\varepsilon(v)\\,dx$, $b(v,q):=-\\int_{\\Omega} q\\,\\nabla\\cdot v\\,dx$, and $\\ell(v):=\\int_{\\Omega} f\\cdot v\\,dx$, with $\\varepsilon(u):=\\tfrac{1}{2}(\\nabla u+\\nabla u^{\\top})$. Let $\\mathcal{T}_{h}$ be a shape-regular triangulation of $\\Omega$ into triangles. Consider the Taylor–Hood finite element pair: for an integer $k\\geq 1$, the discrete spaces are $V_{h}:=\\{v_{h}\\in [C^{0}(\\Omega)]^{2}: v_{h}|_{K}\\in [\\mathbb{P}_{k+1}(K)]^{2}\\ \\forall K\\in \\mathcal{T}_{h},\\ v_{h}|_{\\partial\\Omega}=0\\}$ and $Q_{h}:=\\{q_{h}\\in C^{0}(\\Omega): q_{h}|_{K}\\in \\mathbb{P}_{k}(K)\\ \\forall K\\in \\mathcal{T}_{h},\\ \\int_{\\Omega} q_{h}\\,dx=0\\}$, where $\\mathbb{P}_{r}(K)$ denotes scalar polynomials of total degree at most $r$ on an element $K$.\n\nAssume there exists a Fortin operator $\\Pi_{F}:[H_{0}^{1}(\\Omega)]^{2}\\to V_{h}$ such that $\\|\\Pi_{F} v\\|_{H^{1}(\\Omega)}\\leq C\\|v\\|_{H^{1}(\\Omega)}$ for all $v\\in [H_{0}^{1}(\\Omega)]^{2}$ and, for all $q_{h}\\in Q_{h}$,\n$$\nb(\\Pi_{F}v,q_{h})=b(v,q_{h}).\n$$\nTo assemble the discrete method, suppose the coupling bilinear form $b$ is replaced by elementwise numerical quadrature. Specifically, for each $K\\in \\mathcal{T}_{h}$, let $Q_{K}$ be a quadrature rule exact for all polynomials on $K$ of total degree at most $q$ (the quadrature exactness degree), and define\n$$\nb_{h}(v,q):=-\\sum_{K\\in \\mathcal{T}_{h}} Q_{K}\\big(q\\,\\nabla\\cdot v\\big).\n$$\n\nYour tasks are:\n- Using only the polynomial-degree structure of the Taylor–Hood spaces and the definition of quadrature exactness degree, analyze how a non-exact quadrature for $b$ can break the Fortin property when $b$ is replaced by $b_{h}$, and thereby potentially destroy the discrete inf–sup stability.\n- Derive a sufficient condition on the quadrature exactness degree $q$ (as a function of the velocity–pressure polynomial degree parameter $k$) that guarantees, for all $v_{h}\\in V_{h}$ and $q_{h}\\in Q_{h}$,\n$$\nb_{h}(v_{h},q_{h})=b(v_{h},q_{h}).\n$$\nThis condition is sufficient to ensure that the stability inherited from the Fortin operator is preserved under quadrature.\n\nReport, as your final answer, the minimal such exactness degree $q_{\\min}$ as a closed-form expression in $k$. Your final answer must be a single analytic expression with no units.", "solution": "The stability of the mixed finite element method for the Stokes problem depends on satisfying the discrete inf-sup (or Ladyzhenskaya-Babuška-Brezzi) condition. For the exact bilinear form $b$, this condition states that there exists a constant $\\beta > 0$, independent of the mesh size $h$, such that\n$$\n\\sup_{v_{h}\\in V_{h}\\setminus\\{0\\}} \\frac{b(v_{h}, q_{h})}{\\|v_{h}\\|_{[H^{1}(\\Omega)]^{2}}} \\geq \\beta \\|q_{h}\\|_{L^{2}(\\Omega)} \\quad \\forall q_{h} \\in Q_{h}.\n$$\nThe existence of a Fortin operator $\\Pi_{F}$ is a standard tool to prove that this condition holds for the Taylor-Hood element.\n\nThe first task is to analyze how using an approximate bilinear form $b_{h}$ can compromise the stability analysis. The stability of the discrete system with numerical quadrature depends on an analogous inf-sup condition for $b_{h}$:\n$$\n\\sup_{v_{h}\\in V_{h}\\setminus\\{0\\}} \\frac{b_{h}(v_{h}, q_{h})}{\\|v_{h}\\|_{[H^{1}(\\Omega)]^{2}}} \\geq \\beta_{h} \\|q_{h}\\|_{L^{2}(\\Omega)} \\quad \\forall q_{h} \\in Q_{h}.\n$$\nThe proof of the inf-sup condition for $b$ using the Fortin operator proceeds by taking an arbitrary $q_{h} \\in Q_{h}$ and using the continuous inf-sup condition to find a $v \\in [H^{1}_{0}(\\Omega)]^{2}$ such that $b(v, q_{h}) = \\|q_{h}\\|_{L^{2}(\\Omega)}^{2}$ and $\\|v\\|_{[H^{1}(\\Omega)]^{2}} \\leq C \\|q_{h}\\|_{L^{2}(\\Omega)}$. Then, one selects $v_{h} = \\Pi_{F}v \\in V_{h}$. Using the properties of the Fortin operator, we have $b(\\Pi_{F}v, q_{h}) = b(v, q_{h}) = \\|q_{h}\\|_{L^{2}(\\Omega)}^{2}$. Combined with the operator's stability, $\\|\\Pi_{F}v\\|_{[H^{1}(\\Omega)]^{2}} \\leq C_{F}\\|v\\|_{[H^{1}(\\Omega)]^{2}}$, this establishes the discrete inf-sup condition.\n\nThis line of reasoning breaks down when $b$ is replaced by $b_{h}$. The core of the argument is the identity $b(\\Pi_{F}v, q_{h}) = b(v, q_{h})$. If we attempt a similar argument for $b_{h}$, we must analyze the term $b_{h}(\\Pi_{F}v, q_{h})$. In general, $b_{h}(v_{h}, q_{h}) \\neq b(v_{h}, q_{h})$ if the quadrature is not exact for the integrand $q_{h}(\\nabla \\cdot v_{h})$. The difference is the quadrature error:\n$$\nb(v_{h}, q_{h}) - b_{h}(v_{h}, q_{h}) = \\sum_{K\\in\\mathcal{T}_{h}} \\left( Q_{K}(q_{h} \\nabla \\cdot v_{h}) - \\int_{K} q_{h} \\nabla \\cdot v_{h} \\,dx \\right).\n$$\nThis error term, which depends on higher-order derivatives of the integrand, can disrupt the stability proof. In the context of the Fortin-based proof, we would have $b_{h}(\\Pi_{F}v, q_{h}) = b(\\Pi_{F}v, q_{h}) - \\text{error} = b(v, q_{h}) - \\text{error}$. If the quadrature is not sufficiently accurate, the error term is not controlled, and we cannot guarantee that $b_{h}(\\Pi_{F}v, q_{h})$ is bounded away from zero. It is possible to construct a pair $(v_h, q_h)$ such that the integrand $q_{h}\\nabla \\cdot v_{h}$ is a polynomial that is large in the $L^1$ norm, but evaluates to zero at the quadrature points of an insufficiently accurate rule. In such a case, $b(v_{h}, q_{h})$ could be large while $b_{h}(v_{h}, q_{h}) = 0$, which signals a catastrophic loss of stability. The Fortin property itself is not \"broken\"—it is a property of the operator $\\Pi_F$ with respect to the exact form $b$. Rather, its utility in proving stability for the approximate system is lost because the crucial identity no longer holds for $b_h$.\n\nThe second task is to find a sufficient condition on the quadrature exactness degree, denoted by $q$, to ensure that the stability argument is preserved. The most direct way to ensure the stability properties of the pair $(V_{h}, Q_{h})$ are not degraded by quadrature is to require the quadrature rule to be exact for the bilinear form $b(\\cdot, \\cdot)$ when evaluated with discrete functions. That is, we seek the condition on $q$ such that\n$$\nb_{h}(v_{h}, q_{h}) = b(v_{h}, q_{h}) \\quad \\forall v_{h} \\in V_{h}, \\forall q_{h} \\in Q_{h}.\n$$\nThis equality holds if the quadrature rule $Q_{K}$ is exact for the integrand $q_{h}(\\nabla \\cdot v_{h})$ on every element $K \\in \\mathcal{T}_{h}$. To determine the required degree of exactness, we must find the maximum possible polynomial degree of this integrand.\n\nLet $v_{h} \\in V_{h}$ and $q_{h} \\in Q_{h}$. On a single triangular element $K \\in \\mathcal{T}_{h}$:\n1.  The discrete pressure $q_{h}|_{K}$ is a polynomial of total degree at most $k$. Thus, $q_{h}|_{K} \\in \\mathbb{P}_{k}(K)$.\n2.  The discrete velocity $v_{h}|_{K}$ is a vector of polynomials, with each component being of total degree at most $k+1$. So, $v_{h}|_{K} \\in [\\mathbb{P}_{k+1}(K)]^{2}$.\n3.  The divergence of the discrete velocity, $\\nabla \\cdot v_{h}$, involves taking first-order partial derivatives of the components of $v_{h}$. The derivative of a polynomial of degree $m$ is a polynomial of degree at most $m-1$. Therefore, for $v_{h}|_K = (v_{h,1}, v_{h,2})^T$ with $v_{h,1}, v_{h,2} \\in \\mathbb{P}_{k+1}(K)$, the divergence is $\\nabla \\cdot v_{h}|_{K} = \\frac{\\partial v_{h,1}}{\\partial x} + \\frac{\\partial v_{h,2}}{\\partial y}$. Since $\\frac{\\partial v_{h,1}}{\\partial x}$ and $\\frac{\\partial v_{h,2}}{\\partial y}$ are both polynomials in $\\mathbb{P}_{k}(K)$, their sum is also a polynomial in $\\mathbb{P}_{k}(K)$. Thus, $\\nabla \\cdot v_{h}|_{K} \\in \\mathbb{P}_{k}(K)$.\n4.  The integrand is the product of the discrete pressure and the divergence of the discrete velocity: $q_{h}|_{K} (\\nabla \\cdot v_{h}|_{K})$. This is the product of a polynomial from $\\mathbb{P}_{k}(K)$ and another polynomial from $\\mathbb{P}_{k}(K)$. The product of a polynomial of degree $d_{1}$ and a polynomial of degree $d_{2}$ is a polynomial of degree at most $d_{1} + d_{2}$.\n5.  Therefore, the integrand $q_{h}(\\nabla \\cdot v_{h})$ on element $K$ is a polynomial of total degree at most $k+k = 2k$.\n\nFor the quadrature rule $Q_{K}$ to exactly compute the integral $\\int_{K} q_{h}(\\nabla \\cdot v_{h}) \\,dx$, it must be exact for all polynomials of degree up to the degree of the integrand. This yields the sufficient condition:\n$$\nq \\geq 2k.\n$$\nThe problem asks for the minimal such exactness degree, $q_{\\min}$, that guarantees the equality for all choices of discrete functions. This minimal value is achieved when the inequality is sharp.\n\nTherefore, the minimal sufficient quadrature exactness degree is $q_{\\min} = 2k$.", "answer": "$$\n\\boxed{2k}\n$$", "id": "2577726"}]}