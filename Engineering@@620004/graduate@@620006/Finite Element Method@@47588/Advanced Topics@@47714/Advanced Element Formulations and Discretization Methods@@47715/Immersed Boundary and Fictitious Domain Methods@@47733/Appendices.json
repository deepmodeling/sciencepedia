{"hands_on_practices": [{"introduction": "The Brinkman penalization method is a popular fictitious domain approach that approximates a no-slip boundary condition by adding a penalty term to drive velocity to zero within the solid region. This \"soft\" enforcement introduces a consistency error, which this exercise explores in a simplified one-dimensional setting. By analytically deriving the velocity profile and the resulting error in the computed drag force, you will gain a quantitative understanding of how the penalization parameter $\\eta$ controls accuracy and defines a characteristic boundary layer thickness within the fictitious solid [@problem_id:2567670].", "problem": "Consider a two-dimensional, steady, incompressible Stokes flow in a channel occupying the region $0  y  H$, driven by a constant streamwise body force $g$ (with units of acceleration) acting only in the fluid region. The bottom wall at $y=0$ is represented by a fictitious solid occupying $y0$ and enforced by Brinkman penalization in a single-domain formulation. Let the velocity be unidirectional, $u = u(y)$ in the streamwise direction, and assume the kinematic viscosity is $\\nu$, the penalization time-scale is $\\eta$, and the mask function is $\\chi(y)$ with $\\chi(y)=0$ for $0yH$ and $\\chi(y)=1$ for $y0$. The steady, one-dimensional momentum equation is\n$$\n\\nu\\,\\frac{d^2 u}{dy^2} + \\big(1-\\chi(y)\\big)\\,g - \\chi(y)\\,\\frac{1}{\\eta}\\,u = 0,\n$$\nwith no-slip at the top wall $u(H)=0$, boundedness as $y\\to -\\infty$, and continuity of $u$ and of the viscous shear $\\nu\\,u'(y)$ at $y=0$.\n\nTasks:\n- Starting from the above governing equation and interface conditions, derive the boundary layer equation in the penalized (solid) region and show that the velocity boundary layer thickness $\\delta$ scales as $\\sqrt{\\nu \\eta}$.\n- Solve the coupled piecewise problem to obtain the force on the fictitious solid computed by the Brinkman method. Define the computed drag per unit span as\n$$\nF_{\\mathrm{pen}} = \\int_{-\\infty}^{0} \\frac{1}{\\eta}\\,u(y)\\,dy,\n$$\nand the exact drag for a true no-slip bottom wall in a Stokes channel as\n$$\nF_{\\mathrm{exact}} = \\frac{gH}{2}.\n$$\nCompute the relative drag error, defined as\n$$\n\\mathcal{E}_{\\mathrm{rel}} = \\frac{F_{\\mathrm{pen}}-F_{\\mathrm{exact}}}{F_{\\mathrm{exact}}}.\n$$\n\nAnswer specification:\n- Provide your final answer as a single closed-form analytical expression for $\\mathcal{E}_{\\mathrm{rel}}$ in terms of $H$, $\\nu$, and $\\eta$ only. Do not include any units in your final answer.", "solution": "The problem presented is a valid, well-posed problem in mathematical physics, specifically in the context of the finite element method and computational fluid dynamics. It is scientifically grounded in the theory of Stokes flow and the Brinkman penalization method. All necessary data, equations, and conditions are provided, and no contradictions are apparent. Therefore, a rigorous solution can be derived.\n\nThe governing equation for the steady, unidirectional velocity profile $u(y)$ is given by\n$$\n\\nu\\,\\frac{d^2 u}{dy^2} + \\big(1-\\chi(y)\\big)\\,g - \\chi(y)\\,\\frac{1}{\\eta}\\,u = 0,\n$$\nwhere the mask function $\\chi(y)$ partitions the domain. We analyze the equation in two separate regions: the fluid region ($0  y  H$) and the fictitious solid region ($y  0$).\n\n1.  **Analysis in the Fictitious Solid Region ($y  0$)**\n\nIn this region, $\\chi(y) = 1$. The governing equation simplifies to a homogeneous second-order ordinary differential equation:\n$$\n\\nu\\,\\frac{d^2 u}{dy^2} - \\frac{1}{\\eta}\\,u = 0\n$$\n$$\n\\frac{d^2 u}{dy^2} - \\frac{1}{\\nu\\eta}\\,u = 0\n$$\nThis is the boundary layer equation for the penalized solid region. We define a characteristic length scale $\\delta = \\sqrt{\\nu\\eta}$. The equation becomes:\n$$\n\\frac{d^2 u}{dy^2} - \\frac{1}{\\delta^2}\\,u = 0\n$$\nThe general solution for $u(y)$ in this region, which we denote $u_s(y)$, is:\n$$\nu_s(y) = C_1 \\exp\\left(\\frac{y}{\\delta}\\right) + C_2 \\exp\\left(-\\frac{y}{\\delta}\\right)\n$$\nThe problem specifies that the velocity must remain bounded as $y \\to -\\infty$. As $y \\to -\\infty$, the term $\\exp(-y/\\delta)$ grows without bound. To satisfy the boundedness condition, its coefficient must be zero, so $C_2 = 0$. The velocity profile in the solid region is thus an exponentially decaying function:\n$$\nu_s(y) = A \\exp\\left(\\frac{y}{\\delta}\\right)\n$$\nwhere $A$ is a constant. This exponential decay defines a velocity boundary layer within the fictitious solid, and its thickness, $\\delta$, scales as $\\sqrt{\\nu\\eta}$. This completes the first task.\n\n2.  **Analysis in the Fluid Region ($0  y  H$)**\n\nIn this region, $\\chi(y) = 0$. The governing equation simplifies to an inhomogeneous equation:\n$$\n\\nu\\,\\frac{d^2 u}{dy^2} + g = 0\n$$\n$$\n\\frac{d^2 u}{dy^2} = -\\frac{g}{\\nu}\n$$\nIntegrating this equation twice with respect to $y$ gives the general solution for the velocity profile in the fluid region, which we denote $u_f(y)$:\n$$\n\\frac{du_f}{dy} = -\\frac{g}{\\nu}y + B\n$$\n$$\nu_f(y) = -\\frac{g}{2\\nu}y^2 + By + C\n$$\nwhere $B$ and $C$ are constants of integration.\n\n3.  **Application of Boundary and Interface Conditions**\n\nWe have three unknown constants, $A$, $B$, and $C$, which can be determined using the given conditions:\ni.  **Continuity of velocity at $y=0$**: $u_s(0) = u_f(0)$.\n    $$\n    A \\exp(0) = -\\frac{g}{2\\nu}(0)^2 + B(0) + C \\implies A = C\n    $$\nii. **Continuity of viscous shear at $y=0$**: $\\nu \\frac{du_s}{dy}|_{y=0} = \\nu \\frac{du_f}{dy}|_{y=0}$, which simplifies to $\\frac{du_s}{dy}|_{y=0} = \\frac{du_f}{dy}|_{y=0}$.\n    The derivatives are:\n    $$\n    \\frac{du_s}{dy} = \\frac{A}{\\delta}\\exp\\left(\\frac{y}{\\delta}\\right) \\implies \\frac{du_s}{dy}|_{y=0} = \\frac{A}{\\delta}\n    $$\n    $$\n    \\frac{du_f}{dy} = -\\frac{g}{\\nu}y + B \\implies \\frac{du_f}{dy}|_{y=0} = B\n    $$\n    Equating them gives:\n    $$\n    B = \\frac{A}{\\delta}\n    $$\niii. **No-slip condition at the top wall**: $u_f(H) = 0$.\n    $$\n    -\\frac{g}{2\\nu}H^2 + BH + C = 0\n    $$\nNow, we solve this system of three linear equations for $A$, $B$, and $C$. Substitute $C=A$ and $B=A/\\delta$ into the third equation:\n$$\n-\\frac{gH^2}{2\\nu} + \\left(\\frac{A}{\\delta}\\right)H + A = 0\n$$\n$$\nA\\left(\\frac{H}{\\delta} + 1\\right) = \\frac{gH^2}{2\\nu}\n$$\n$$\nA\\left(\\frac{H+\\delta}{\\delta}\\right) = \\frac{gH^2}{2\\nu}\n$$\nSolving for $A$:\n$$\nA = \\frac{gH^2\\delta}{2\\nu(H+\\delta)}\n$$\n\n4.  **Calculation of Penalized Drag**\n\nThe drag per unit span computed by the Brinkman method is defined as:\n$$\nF_{\\mathrm{pen}} = \\int_{-\\infty}^{0} \\frac{1}{\\eta}\\,u(y)\\,dy\n$$\nSubstituting the solution $u_s(y) = A \\exp(y/\\delta)$:\n$$\nF_{\\mathrm{pen}} = \\frac{1}{\\eta} \\int_{-\\infty}^{0} A \\exp\\left(\\frac{y}{\\delta}\\right) dy = \\frac{A}{\\eta} \\left[ \\delta \\exp\\left(\\frac{y}{\\delta}\\right) \\right]_{-\\infty}^{0}\n$$\n$$\nF_{\\mathrm{pen}} = \\frac{A\\delta}{\\eta} \\left( \\exp(0) - \\lim_{y\\to-\\infty}\\exp\\left(\\frac{y}{\\delta}\\right) \\right) = \\frac{A\\delta}{\\eta} (1 - 0) = \\frac{A\\delta}{\\eta}\n$$\nUsing the relationship $\\delta = \\sqrt{\\nu\\eta}$, we have $\\delta^2 = \\nu\\eta$, which implies $\\frac{\\delta}{\\eta} = \\frac{\\nu}{\\delta}$. Therefore:\n$$\nF_{\\mathrm{pen}} = A \\frac{\\nu}{\\delta}\n$$\nNow, substituting the expression for the constant $A$:\n$$\nF_{\\mathrm{pen}} = \\left( \\frac{gH^2\\delta}{2\\nu(H+\\delta)} \\right) \\frac{\\nu}{\\delta} = \\frac{gH^2}{2(H+\\delta)}\n$$\n\n5.  **Calculation of Relative Drag Error**\n\nThe exact drag for a true no-slip wall is given as $F_{\\mathrm{exact}} = \\frac{gH}{2}$. The relative drag error $\\mathcal{E}_{\\mathrm{rel}}$ is defined as:\n$$\n\\mathcal{E}_{\\mathrm{rel}} = \\frac{F_{\\mathrm{pen}}-F_{\\mathrm{exact}}}{F_{\\mathrm{exact}}} = \\frac{F_{\\mathrm{pen}}}{F_{\\mathrm{exact}}} - 1\n$$\nLet's compute the ratio $\\frac{F_{\\mathrm{pen}}}{F_{\\mathrm{exact}}}$:\n$$\n\\frac{F_{\\mathrm{pen}}}{F_{\\mathrm{exact}}} = \\frac{\\frac{gH^2}{2(H+\\delta)}}{\\frac{gH}{2}} = \\frac{gH^2}{2(H+\\delta)} \\cdot \\frac{2}{gH} = \\frac{H}{H+\\delta}\n$$\nNow, substitute this back into the expression for the relative error:\n$$\n\\mathcal{E}_{\\mathrm{rel}} = \\frac{H}{H+\\delta} - 1 = \\frac{H - (H+\\delta)}{H+\\delta} = \\frac{-\\delta}{H+\\delta}\n$$\nFinally, we express the result in terms of the given parameters $H$, $\\nu$, and $\\eta$ by substituting back $\\delta = \\sqrt{\\nu\\eta}$:\n$$\n\\mathcal{E}_{\\mathrm{rel}} = \\frac{-\\sqrt{\\nu\\eta}}{H+\\sqrt{\\nu\\eta}}\n$$\nThis expression represents the relative error in the drag force computed using the Brinkman penalization method compared to the exact analytical solution for a solid wall. The negative sign indicates that the penalized drag is an underestimation of the exact drag. As the penalization parameter $\\eta \\to 0$, the boundary layer thickness $\\delta \\to 0$, and the error $\\mathcal{E}_{\\mathrm{rel}} \\to 0$, which correctly implies that the penalization method converges to the exact solution in the limit of strong penalization.", "answer": "$$\n\\boxed{\\frac{-\\sqrt{\\nu\\eta}}{H+\\sqrt{\\nu\\eta}}}\n$$", "id": "2567670"}, {"introduction": "A major challenge in immersed and fictitious domain methods is the accurate evaluation of integrals over elements that are arbitrarily \"cut\" by the immersed boundary, as standard quadrature rules become invalid. This practice guides you through the construction of a custom, high-order quadrature rule for a cut element using the method of moments. By enforcing exactness for a basis of polynomials, you will determine the precise weights for a given set of quadrature points, illuminating the sophisticated numerical machinery required to maintain accuracy when dealing with non-conforming geometries [@problem_id:2567751].", "problem": "In an Immersed Boundary (IB) and Fictitious Domain (FD) finite element setting, consider a single background element $E = [0,1] \\times [0,1]$ cut by a smooth interface described implicitly by the level set function $\\phi(x,y) = x + y - \\frac{3}{5}$. The physical subdomain occupying the portion of $E$ is $K^{-} := \\{(x,y) \\in E \\,\\mid\\, \\phi(x,y) \\lt 0\\}$.\n\nYou are tasked with constructing, from first principles, a moment-fitted quadrature rule on $K^{-}$ that is exact for all polynomials of total degree up to $2$. Use the following node set on the cut polygon $K^{-}$ (which, for this $\\phi$, is a right triangle with vertices on the coordinate axes):\n- The three vertices $A=(0,0)$, $B=\\left(\\frac{3}{5},0\\right)$, and $C=\\left(0,\\frac{3}{5}\\right)$.\n- The three edge midpoints $M_{AB}=\\left(\\frac{3}{10},0\\right)$, $M_{BC}=\\left(\\frac{3}{10},\\frac{3}{10}\\right)$, and $M_{CA}=\\left(0,\\frac{3}{10}\\right)$.\n\nLet the associated unknown weights be $w_A$, $w_B$, $w_C$, $w_{AB}$, $w_{BC}$, and $w_{CA}$, respectively. Impose exactness of the quadrature for the six monomials $\\{1, x, y, x^{2}, xy, y^{2}\\}$ over $K^{-}$ to uniquely determine these weights.\n\nProvide your final answer as the single row matrix $\\bigl(w_A,\\, w_B,\\, w_C,\\, w_{AB},\\, w_{BC},\\, w_{CA}\\bigr)$ in exact form. No rounding is required and no units are involved.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nGivens are extracted verbatim:\n- Background element: $E = [0,1] \\times [0,1]$.\n- Interface level set function: $\\phi(x,y) = x + y - \\frac{3}{5}$.\n- Physical subdomain: $K^{-} := \\{(x,y) \\in E \\,\\mid\\, \\phi(x,y) \\lt 0\\}$.\n- Quadrature nodes on $K^{-}$:\n  - Vertices: $A=(0,0)$, $B=\\left(\\frac{3}{5},0\\right)$, $C=\\left(0,\\frac{3}{5}\\right)$.\n  - Edge midpoints: $M_{AB}=\\left(\\frac{3}{10},0\\right)$, $M_{BC}=\\left(\\frac{3}{10},\\frac{3}{10}\\right)$, $M_{CA}=\\left(0,\\frac{3}{10}\\right)$.\n- Associated unknown weights: $w_A$, $w_B$, $w_C$, $w_{AB}$, $w_{BC}$, $w_{CA}$.\n- Exactness condition: The quadrature rule must be exact for all polynomials of total degree up to $2$, which corresponds to the monomial basis $\\{1, x, y, x^{2}, xy, y^{2}\\}$.\n\nValidation using extracted givens:\n- **Scientifically Grounded and Objective**: The problem is a standard exercise in numerical analysis, specifically the construction of a quadrature rule via the method of moments. It is based on established mathematical principles and is stated with objective, precise language.\n- **Well-Posed and Complete**: The problem is self-contained. It provides a clearly defined domain, a set of quadrature nodes, and a condition of exactness for a specific polynomial space. The number of constraints (six, from the six basis monomials) matches the number of unknown weights, suggesting a unique solution may exist. The problem is well-posed.\n\nVerdict: The problem is valid. It is a rigorous, solvable problem within the field of numerical methods for partial differential equations. We proceed to the solution.\n\nThe problem requires the construction of a quadrature rule of the form\n$$ \\int_{K^{-}} f(x,y) \\,dA \\approx w_A f(A) + w_B f(B) + w_C f(C) + w_{AB} f(M_{AB}) + w_{BC} f(M_{BC}) + w_{CA} f(M_{CA}) $$\nthat is exact for any polynomial $p(x,y)$ of total degree at most $2$. This is equivalent to enforcing exactness for each monomial in the basis $\\{1, x, y, x^2, xy, y^2\\}$.\n\nThe domain of integration $K^{-}$ is the region where $x+y  \\frac{3}{5}$ within the first quadrant, which is a right triangle. Let $h = \\frac{3}{5}$. The vertices of this triangle are $(0,0)$, $(h,0)$, and $(0,h)$. The quadrature nodes are specified as the three vertices $A(0,0)$, $B(h,0)$, $C(0,h)$, and the three edge midpoints $M_{AB}(h/2, 0)$, $M_{BC}(h/2, h/2)$, $M_{CA}(0, h/2)$.\n\nThe exactness condition for a monomial $p_{m,n}(x,y) = x^m y^n$ is:\n$$ \\sum_{i=1}^{6} w_i p_{m,n}(x_i, y_i) = \\int_{K^{-}} x^m y^n \\,dA $$\nWe must first compute the moments, $I_{m,n} = \\int_{K^{-}} x^m y^n \\,dA$. The integral of $x^m y^n$ over a triangle with vertices $(0,0)$, $(h,0)$, and $(0,h)$ is given by the formula:\n$$ I_{m,n} = h^{m+n+2} \\frac{m! n!}{(m+n+2)!} $$\nWe compute the required moments for $(m+n) \\le 2$:\n$I_{0,0} = \\int_{K^{-}} 1 \\,dA = h^2 \\frac{0!0!}{2!} = \\frac{h^2}{2} = \\frac{1}{2}\\left(\\frac{3}{5}\\right)^2 = \\frac{9}{50}$.\n$I_{1,0} = \\int_{K^{-}} x \\,dA = h^3 \\frac{1!0!}{3!} = \\frac{h^3}{6} = \\frac{1}{6}\\left(\\frac{3}{5}\\right)^3 = \\frac{27}{750} = \\frac{9}{250}$.\n$I_{0,1} = \\int_{K^{-}} y \\,dA = h^3 \\frac{0!1!}{3!} = \\frac{h^3}{6} = \\frac{9}{250}$.\n$I_{2,0} = \\int_{K^{-}} x^2 \\,dA = h^4 \\frac{2!0!}{4!} = \\frac{2h^4}{24} = \\frac{h^4}{12} = \\frac{1}{12}\\left(\\frac{3}{5}\\right)^4 = \\frac{81}{7500} = \\frac{27}{2500}$.\n$I_{1,1} = \\int_{K^{-}} xy \\,dA = h^4 \\frac{1!1!}{4!} = \\frac{h^4}{24} = \\frac{1}{24}\\left(\\frac{3}{5}\\right)^4 = \\frac{81}{15000} = \\frac{27}{5000}$.\n$I_{0,2} = \\int_{K^{-}} y^2 \\,dA = h^4 \\frac{0!2!}{4!} = \\frac{h^4}{12} = \\frac{27}{2500}$.\n\nNow, we set up the system of six linear equations by evaluating each basis monomial at the six quadrature points. Let the vector of weights be $W = (w_A, w_B, w_C, w_{AB}, w_{BC}, w_{CA})^T$.\n\n1. For $p(x,y)=1$:\n$w_A + w_B + w_C + w_{AB} + w_{BC} + w_{CA} = I_{0,0} = \\frac{h^2}{2}$.\n2. For $p(x,y)=x$:\n$0 \\cdot w_A + h \\cdot w_B + 0 \\cdot w_C + \\frac{h}{2} \\cdot w_{AB} + \\frac{h}{2} \\cdot w_{BC} + 0 \\cdot w_{CA} = I_{1,0} = \\frac{h^3}{6}$.\n3. For $p(x,y)=y$:\n$0 \\cdot w_A + 0 \\cdot w_B + h \\cdot w_C + 0 \\cdot w_{AB} + \\frac{h}{2} \\cdot w_{BC} + \\frac{h}{2} \\cdot w_{CA} = I_{0,1} = \\frac{h^3}{6}$.\n4. For $p(x,y)=x^2$:\n$0 \\cdot w_A + h^2 \\cdot w_B + 0 \\cdot w_C + \\frac{h^2}{4} \\cdot w_{AB} + \\frac{h^2}{4} \\cdot w_{BC} + 0 \\cdot w_{CA} = I_{2,0} = \\frac{h^4}{12}$.\n5. For $p(x,y)=xy$:\n$0 \\cdot w_A + 0 \\cdot w_B + 0 \\cdot w_C + 0 \\cdot w_{AB} + \\frac{h^2}{4} \\cdot w_{BC} + 0 \\cdot w_{CA} = I_{1,1} = \\frac{h^4}{24}$.\n6. For $p(x,y)=y^2$:\n$0 \\cdot w_A + 0 \\cdot w_B + h^2 \\cdot w_C + 0 \\cdot w_{AB} + \\frac{h^2}{4} \\cdot w_{BC} + \\frac{h^2}{4} \\cdot w_{CA} = I_{0,2} = \\frac{h^4}{12}$.\n\nWe solve this system. From equation (5):\n$\\frac{h^2}{4} w_{BC} = \\frac{h^4}{24} \\implies w_{BC} = \\frac{4}{h^2} \\frac{h^4}{24} = \\frac{h^2}{6}$.\n\nNow consider equations (2) and (4) after dividing by $h \\neq 0$ and $h^2 \\neq 0$:\n(2') $w_B + \\frac{1}{2} w_{AB} + \\frac{1}{2} w_{BC} = \\frac{h^2}{6}$.\n(4') $w_B + \\frac{1}{4} w_{AB} + \\frac{1}{4} w_{BC} = \\frach^2}{12}$.\nMultiplying equation (4') by $2$ gives $2w_B + \\frac{1}{2} w_{AB} + \\frac{1}{2} w_{BC} = \\frac{h^2}{6}$.\nComparing this with (2'), we have $2w_B = w_B$, which implies $w_B = 0$.\nSubstituting $w_B=0$ into (2'):\n$\\frac{1}{2} w_{AB} + \\frac{1}{2} w_{BC} = \\frac{h^2}{6} \\implies w_{AB} + w_{BC} = \\frac{h^2}{3}$.\nUsing $w_{BC} = \\frac{h^2}{6}$, we find $w_{AB} = \\frac{h^2}{3} - \\frac{h^2}{6} = \\frac{h^2}{6}$.\n\nBy symmetry of the problem with respect to the line $y=x$, the weights associated with nodes reflected across this line must be equal. Thus, we expect $w_C = w_B$ and $w_{CA} = w_{AB}$. We formally verify this using equations (3) and (6). Dividing by $h$ and $h^2$:\n(3') $w_C + \\frac{1}{2} w_{BC} + \\frac{1}{2} w_{CA} = \\frac{h^2}{6}$.\n(6') $w_C + \\frac{1}{4} w_{BC} + \\frac{1}{4} w_{CA} = \\frac{h^2}{12}$.\nThis system is structurally identical to the system for $w_B$ and $w_{AB}$. The same logic implies $w_C = 0$.\nSubstituting $w_C=0$ into (3') gives $\\frac{1}{2} w_{BC} + \\frac{1}{2} w_{CA} = \\frac{h^2}{6}$, which leads to $w_{CA} = \\frac{h^2}{3} - w_{BC} = \\frac{h^2}{3} - \\frac{h^2}{6} = \\frac{h^2}{6}$.\n\nFinally, we use equation (1) to find $w_A$:\n$w_A + w_B + w_C + w_{AB} + w_{BC} + w_{CA} = \\frac{h^2}{2}$.\n$w_A + 0 + 0 + \\frac{h^2}{6} + \\frac{h^2}{6} + \\frac{h^2}{6} = \\frac{h^2}{2}$.\n$w_A + 3\\left(\\frac{h^2}{6}\\right) = \\frac{h^2}{2}$.\n$w_A + \\frac{h^2}{2} = \\frac{h^2}{2} \\implies w_A = 0$.\n\nThe weights are:\n$w_A = 0$\n$w_B = 0$\n$w_C = 0$\n$w_{AB} = \\frac{h^2}{6} = \\frac{1}{6}\\left(\\frac{3}{5}\\right)^2 = \\frac{1}{6} \\cdot \\frac{9}{25} = \\frac{3}{50}$.\n$w_{BC} = \\frac{h^2}{6} = \\frac{3}{50}$.\n$w_{CA} = \\frac{h^2}{6} = \\frac{3}{50}$.\n\nThe resulting quadrature rule, which is exact for polynomials of degree up to $2$, uses only the midpoints of the triangle's edges. This is a known result for triangular elements. The vector of weights is $(0, 0, 0, \\frac{3}{50}, \\frac{3}{50}, \\frac{3}{50})$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  0  \\frac{3}{50}  \\frac{3}{50}  \\frac{3}{50}\n\\end{pmatrix}\n}\n$$", "id": "2567751"}, {"introduction": "Before applying a complex numerical method to an unsolved research problem, it is crucial to verify its implementation against a known analytical solution. Stokes' second problem, the flow generated by an oscillating plate, provides a classic benchmark for unsteady viscous flows. This exercise involves deriving the exact solution and using it to establish a rigorous verification suite by computing target values for amplitude decay and phase lag, underscoring the indispensable role of benchmarking in computational science [@problem_id:2567789].", "problem": "You are asked to formalize a reproducible, code-verifiable benchmark for an oscillating rigid plate in a viscous incompressible fluid that serves as a target for Immersed Boundary (IB) and Fictitious Domain (FD) methods within the Finite Element Method (FEM) framework. The goal is to compute the amplitude attenuation and phase lag of the tangential fluid velocity field normal to an oscillating plate, based on the exact solution of the linearized unsteady Stokes problem. This provides reference targets for verification of numerical IB and FD implementations that enforce the plate–fluid kinematic constraint via a distributed Lagrange multiplier or a penalty formulation that approaches a no-slip boundary condition in the stiff limit.\n\nConsider an unbounded half-space fluid domain occupying $\\{ y \\ge 0 \\}$ with a rigid, infinitely extended plate located at $y = 0$. The plate has prescribed tangential velocity $u_{\\text{plate}}(t) = U_0 \\cos(\\omega t)$, where $U_0$ is the amplitude and $\\omega$ is the angular frequency. Assume the following:\n- The fluid is Newtonian, incompressible, and at constant density and viscosity.\n- The motion is planar and parallel to the plate, so the only nonzero velocity component is the tangential component $u(y,t)$, which depends only on $y$ and $t$.\n- The amplitude is sufficiently small so that convective terms are negligible, yielding the linearized unsteady Stokes equation with no background pressure gradient.\n- The physically relevant target for IB/FD enforcement corresponds to the limit in which the constraint recovers a no-slip boundary at the plate.\n\nFrom first principles, start with the linearized momentum balance for the tangential component $u(y,t)$ in the absence of a pressure gradient,\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial y^2},\n$$\nwhere $\\nu$ is the kinematic viscosity. The boundary conditions are\n$$\nu(0,t) = U_0 \\cos(\\omega t), \\quad \\lim_{y \\to \\infty} u(y,t) = 0.\n$$\nDefine the amplitude ratio $A(y)/U_0$ as the ratio of the local harmonic amplitude of $u(y,t)$ to the plate amplitude $U_0$, and define the phase lag $\\phi(y)$ (in radians) as the temporal phase by which the local response at position $y$ lags the plate oscillation $\\cos(\\omega t)$.\n\nYour tasks:\n1. Derive, from the stated governing equation and boundary conditions, the closed-form expressions for the amplitude ratio $A(y)/U_0$ and the phase lag $\\phi(y)$ as functions of $y$, $\\nu$, and $\\omega$. Angles must be expressed in radians.\n2. Implement a program that, for each test case below, computes the pair $[A(y)/U_0,\\;\\phi(y)]$ using your derived expressions, rounds each quantity to six decimal places, and outputs all results on a single line in the specified format. You may assume $U_0 \\ne 0$ and normalize by $U_0$ as defined.\n\nPhysical units and reporting requirements:\n- Distance $y$ in meters.\n- Kinematic viscosity $\\nu$ in $\\text{m}^2/\\text{s}$.\n- Angular frequency $\\omega$ in $\\text{rad}/\\text{s}$.\n- Amplitude ratio $A(y)/U_0$ is dimensionless.\n- Phase lag $\\phi(y)$ must be reported in radians.\n- Round all reported numbers to six decimal places.\n\nTest suite (five cases):\n- Case 1: $(\\nu, \\omega, y) = (0.01, 2.0, 0.05)$.\n- Case 2: $(\\nu, \\omega, y) = (0.01, 2.0, 0.0)$.\n- Case 3: $(\\nu, \\omega, y) = (0.01, 2.0, 0.3)$.\n- Case 4: $(\\nu, \\omega, y) = (0.001, 8.0, 0.02)$.\n- Case 5: $(\\nu, \\omega, y) = (0.004, 0.5, 0.05)$.\n\nFinal output format:\n- Your program should produce a single line of output containing a Python-style list of length five, where each entry is a two-element list $[A(y)/U_0,\\;\\phi(y)]$ corresponding to the cases above in the same order. For example:\n\"[ [a1,p1],[a2,p2],[a3,p3],[a4,p4],[a5,p5] ]\"\nDo not print any additional text before or after this list.\n\nYour implementation must be fully self-contained and runnable without user input. Angles must be returned in radians, and all numerical outputs must be rounded to six decimal places as specified. The numerical results produced by your program will be used as the acceptance criterion for correctness.", "solution": "The problem presented is a classical exercise in fluid dynamics, specifically the analysis of Stokes' second problem, which describes the flow induced by an oscillating flat plate. The problem is well-posed, scientifically grounded, and provides all necessary information to derive a unique, analytical solution. Therefore, it is deemed valid. We shall proceed with the derivation.\n\nThe governing equation for the tangential fluid velocity $u(y,t)$ in the domain $y \\ge 0$ is the one-dimensional unsteady Stokes equation, which is mathematically equivalent to the diffusion equation:\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial y^2}\n$$\nHere, $\\nu$ is the kinematic viscosity of the fluid. The motion is driven by the plate at $y=0$, which oscillates tangentially. The boundary conditions are:\n$$\nu(0,t) = U_0 \\cos(\\omega t)\n$$\n$$\n\\lim_{y \\to \\infty} u(y,t) = 0\n$$\nThe second condition indicates that the fluid is at rest far from the plate. We seek a periodic steady-state solution that oscillates with the same angular frequency $\\omega$ as the plate.\n\nTo solve this linear partial differential equation, it is advantageous to employ complex variables. We represent the real velocity $u(y,t)$ as the real part of a complex velocity field $\\tilde{u}(y,t)$. Let $u(y,t) = \\text{Re}[\\tilde{u}(y,t)]$. The boundary condition at the plate can be written as $u(0,t) = \\text{Re}[U_0 e^{i\\omega t}]$, where $i$ is the imaginary unit. We thus pose the problem in terms of $\\tilde{u}(y,t)$ with the complex boundary condition:\n$$\n\\tilde{u}(0,t) = U_0 e^{i\\omega t}\n$$\nWe assume a solution of the form $\\tilde{u}(y,t) = f(y)e^{i\\omega t}$, which separates the spatial and temporal dependencies. Substituting this ansatz into the governing PDE gives:\n$$\n\\frac{\\partial}{\\partial t} \\left( f(y) e^{i\\omega t} \\right) = \\nu \\frac{\\partial^2}{\\partial y^2} \\left( f(y) e^{i\\omega t} \\right)\n$$\n$$\ni\\omega f(y) e^{i\\omega t} = \\nu f''(y) e^{i\\omega t}\n$$\nDividing by the non-zero term $e^{i\\omega t}$ yields a second-order ordinary differential equation for the complex amplitude function $f(y)$:\n$$\nf''(y) - \\frac{i\\omega}{\\nu} f(y) = 0\n$$\nThis is a linear, homogeneous ODE with constant coefficients. The characteristic equation is $\\lambda^2 - i\\omega/\\nu = 0$, which gives $\\lambda^2 = i\\omega/\\nu$. To find the roots $\\lambda$, we must compute the square root of the imaginary unit $i$. In polar form, $i=e^{i\\pi/2}$. Its square roots are $\\pm e^{i\\pi/4} = \\pm(\\cos(\\pi/4) + i\\sin(\\pi/4)) = \\pm\\frac{1+i}{\\sqrt{2}}$.\nThus, the characteristic roots are:\n$$\n\\lambda = \\pm \\sqrt{\\frac{\\omega}{\\nu}} \\sqrt{i} = \\pm \\sqrt{\\frac{\\omega}{\\nu}} \\frac{1+i}{\\sqrt{2}} = \\pm (1+i) \\sqrt{\\frac{\\omega}{2\\nu}}\n$$\nLet us define a characteristic length scale, $\\delta = \\sqrt{2\\nu/\\omega}$, often called the viscous penetration depth or Stokes boundary layer thickness. With this definition, the roots simplify to $\\lambda = \\pm (1+i)/\\delta$.\n\nThe general solution for $f(y)$ is a linear combination of the two exponential solutions:\n$$\nf(y) = C_1 e^{(1+i)y/\\delta} + C_2 e^{-(1+i)y/\\delta}\n$$\nThe constants $C_1$ and $C_2$ are determined by the boundary conditions. The condition at infinity, $\\lim_{y \\to \\infty} u(y,t) = 0$, implies that the complex amplitude must also vanish, $\\lim_{y \\to \\infty} f(y) = 0$. The term $e^{(1+i)y/\\delta} = e^{y/\\delta}e^{iy/\\delta}$ has a magnitude $e^{y/\\delta}$ that grows exponentially with $y$. For the solution to remain bounded and decay to zero, its coefficient $C_1$ must be zero.\nTherefore, the solution form reduces to:\n$$\nf(y) = C_2 e^{-(1+i)y/\\delta}\n$$\nThe remaining constant $C_2$ is found using the boundary condition at the plate, $y=0$. We have $\\tilde{u}(0,t) = f(0)e^{i\\omega t} = U_0 e^{i\\omega t}$, which requires $f(0) = U_0$. Applying this to our solution for $f(y)$:\n$$\nf(0) = C_2 e^0 = C_2 = U_0\n$$\nThus, the specific solution for the complex amplitude is:\n$$\nf(y) = U_0 e^{-(1+i)y/\\delta} = U_0 e^{-y/\\delta} e^{-iy/\\delta}\n$$\nThe complete complex velocity field is then:\n$$\n\\tilde{u}(y,t) = f(y)e^{i\\omega t} = U_0 e^{-y/\\delta} e^{-iy/\\delta} e^{i\\omega t} = U_0 e^{-y/\\delta} e^{i(\\omega t - y/\\delta)}\n$$\nThe physical velocity $u(y,t)$ is the real part of $\\tilde{u}(y,t)$:\n$$\nu(y,t) = \\text{Re}\\left[ U_0 e^{-y/\\delta} \\left(\\cos(\\omega t - y/\\delta) + i\\sin(\\omega t - y/\\delta)\\right) \\right]\n$$\n$$\nu(y,t) = U_0 e^{-y/\\delta} \\cos(\\omega t - y/\\delta)\n$$\nThis solution represents a damped transverse wave propagating from the plate into the fluid.\n\nFrom this final expression, we can directly identify the quantities of interest. The solution is of the form $u(y,t) = A(y) \\cos(\\omega t - \\phi(y))$, where $A(y)$ is the local amplitude and $\\phi(y)$ is the phase lag relative to the plate's motion $\\cos(\\omega t)$.\nBy comparison, we find:\n$1$. The local amplitude is $A(y) = U_0 e^{-y/\\delta}$. The required amplitude ratio is:\n$$\n\\frac{A(y)}{U_0} = e^{-y/\\delta}\n$$\n$2$. The phase lag is $\\phi(y) = y/\\delta$.\n\nSubstituting the definition of $\\delta = \\sqrt{2\\nu/\\omega}$ into these expressions gives the final formulae as functions of the given physical parameters:\nThe amplitude ratio is:\n$$\n\\frac{A(y)}{U_0} = \\exp\\left(-y \\sqrt{\\frac{\\omega}{2\\nu}}\\right)\n$$\nThe phase lag in radians is:\n$$\n\\phi(y) = y \\sqrt{\\frac{\\omega}{2\\nu}}\n$$\nThese are the closed-form expressions required to compute the benchmark values. Note that for $y0$, the amplitude is attenuated and the phase positively lagged, consistent with physical intuition. For the case $y=0$, the formulae correctly yield an amplitude ratio of $1$ and a phase lag of $0$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the amplitude attenuation and phase lag for an oscillating plate\n    in a viscous fluid (Stokes' second problem).\n    \"\"\"\n    # Test cases: tuples of (kinematic_viscosity, angular_frequency, distance_y)\n    # Units: nu (m^2/s), omega (rad/s), y (m)\n    test_cases = [\n        (0.01, 2.0, 0.05),\n        (0.01, 2.0, 0.0),\n        (0.01, 2.0, 0.3),\n        (0.001, 8.0, 0.02),\n        (0.004, 0.5, 0.05),\n    ]\n\n    # A list to store the formatted results for each case.\n    formatted_results = []\n\n    for case in test_cases:\n        nu, omega, y = case\n\n        # The core term y * sqrt(omega / (2 * nu)) appears in both amplitude\n        # and phase calculations.\n        # Handle the case where nu is zero to avoid division errors, although not\n        # present in the test suite.\n        if nu = 0:\n            # Physically, zero viscosity means no momentum transfer, so amplitude\n            # is zero for y > 0.\n            # However, the problem formulation implies nu > 0.\n            # In the limit nu->0, the exponent goes to infinity for y>0.\n            # Amp ratio would be 0, phase lag infinite.\n            # At y=0, the results are 1 and 0.\n            if y == 0:\n                amplitude_ratio = 1.0\n                phase_lag = 0.0\n            else:\n                # This case is physically ill-defined in the context of this problem\n                # but we handle it for robustness.\n                amplitude_ratio = 0.0\n                phase_lag = float('inf')\n        else:\n            alpha = y * np.sqrt(omega / (2 * nu))\n            amplitude_ratio = np.exp(-alpha)\n            phase_lag = alpha\n\n        # Format each number to six decimal places, ensuring trailing zeros.\n        amp_str = f\"{amplitude_ratio:.6f}\"\n        lag_str = f\"{phase_lag:.6f}\"\n\n        # Create the string representation for the pair [amplitude, phase].\n        formatted_results.append(f\"[{amp_str},{lag_str}]\")\n\n    # Combine all formatted pairs into the final output string.\n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2567789"}]}