{"hands_on_practices": [{"introduction": "The primary motivation for introducing incompatible modes is to improve an element's performance, often by counteracting artificial stiffness from phenomena like shear locking. This first practice provides a direct, quantitative look at this process. By calculating the contribution of a specific incompatible mode to the overall bending stiffness of a plate element, you will witness firsthand the 'softening' effect that arises from static condensation and understand how this enriches the element's kinematic capabilities. [@problem_id:2568518]", "problem": "Consider a single four-node isoparametric quadrilateral element in the Finite Element Method (FEM) for the bending of a thin plate modeled by the Mindlin–Reissner theory, occupying the unit square domain $\\Omega = [0,1] \\times [0,1]$ in the $x$–$y$ plane. Focus only on the bending part of the energy (ignore transverse shear). Let the plate’s bending constitutive matrix be taken as\n$$\n\\mathbf{D}_{b} \\;=\\; D_{0}\\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix},\n$$\nwith the normalization $D_{0} = 1$ and $\\nu = 0$, so that $\\mathbf{D}_{b} = \\mathrm{diag}(1,\\,1,\\,\\tfrac{1}{2})$. The bending strains (curvatures) are defined in terms of the rotations $\\theta_{x}(x,y)$ and $\\theta_{y}(x,y)$ as\n$$\n\\kappa_{x} = -\\frac{\\partial \\theta_{x}}{\\partial x}, \\quad\n\\kappa_{y} = -\\frac{\\partial \\theta_{y}}{\\partial y}, \\quad\n\\kappa_{xy} = -\\frac{\\partial \\theta_{x}}{\\partial y} - \\frac{\\partial \\theta_{y}}{\\partial x}.\n$$\nLet the compatible rotations be interpolated bilinearly from nodal values, and consider the specific compatible bending mode corresponding to a uniform curvature about the $y$-axis:\n$$\n\\theta_{x}^{c}(x,y) = x, \\qquad \\theta_{y}^{c}(x,y) = 0,\n$$\nwhich is exactly representable by bilinear interpolation on $\\Omega$ by assigning nodal values equal to the $x$-coordinates for $\\theta_{x}$ and zero for $\\theta_{y}$. Augment the element with a single scalar incompatible internal mode $a \\in \\mathbb{R}$ of the form\n$$\n\\theta_{x}^{i}(x,y) = a\\,x\\,y, \\qquad \\theta_{y}^{i}(x,y) = 0,\n$$\nto be eliminated by static condensation at the element level. Denote by $\\mathbf{K}_{cc}$ the compatible (condensed) bending stiffness associated with the compatible degrees of freedom, by $\\mathbf{K}_{ii}$ the self-stiffness of the single incompatible mode, and by $\\mathbf{K}_{ci}$, $\\mathbf{K}_{ic}$ the coupling blocks. Using the bending energy functional\n$$\n\\Pi_{b}(\\theta_{x},\\theta_{y}) \\;=\\; \\frac{1}{2}\\int_{\\Omega} \\boldsymbol{\\kappa}^{T}\\,\\mathbf{D}_{b}\\,\\boldsymbol{\\kappa}\\, \\mathrm{d}A,\n$$\ncompute, for the above fields, the scalar quadratic form\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q,\n$$\nwhere $q$ is the compatible nodal vector that reproduces $\\theta_{x}^{c}(x,y)=x$, $\\theta_{y}^{c}(x,y)=0$. Then quantify the change in bending stiffness along this mode by the ratio\n$$\nr \\;=\\; \\frac{q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q}{q^{T}\\mathbf{K}_{cc}q}.\n$$\nEvaluate $r$ exactly as a real number. Express the final answer as an exact number without units. No rounding is required.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It is a standard problem in the theory of the Finite Element Method concerning incompatible modes and static condensation. All necessary data and definitions are provided. The problem is valid and admits a unique solution. We proceed.\n\nThe task is to compute the ratio $r$, defined as:\n$$\nr \\;=\\; \\frac{q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q}{q^{T}\\mathbf{K}_{cc}q}\n$$\nThe terms in this expression originate from the element's bending energy functional, $\\Pi_b$. The total rotation field is a sum of a compatible part, interpolated from nodal degrees of freedom $q$, and an incompatible part, parameterized by an internal degree of freedom $a$. Let the rotation fields be $\\boldsymbol{\\theta} = (\\theta_x, \\theta_y)$. The strain vector $\\boldsymbol{\\kappa} = (\\kappa_x, \\kappa_y, \\kappa_{xy})$ is derived from $\\boldsymbol{\\theta}$ via a differential operator, which we denote $\\boldsymbol{\\kappa} = \\mathcal{L}(\\boldsymbol{\\theta})$. This relation is linear. Therefore, the total strain can be decomposed as $\\boldsymbol{\\kappa} = \\boldsymbol{\\kappa}^c + \\boldsymbol{\\kappa}^i$, where $\\boldsymbol{\\kappa}^c = \\mathcal{L}(\\boldsymbol{\\theta}^c)$ and $\\boldsymbol{\\kappa}^i = \\mathcal{L}(\\boldsymbol{\\theta}^i)$.\n\nThe bending energy functional is given by:\n$$\n\\Pi_{b} \\;=\\; \\frac{1}{2}\\int_{\\Omega} \\boldsymbol{\\kappa}^{T}\\,\\mathbf{D}_{b}\\,\\boldsymbol{\\kappa}\\, \\mathrm{d}A\n$$\nSubstituting the decomposed strain, we have:\n$$\n\\Pi_{b} \\;=\\; \\frac{1}{2}\\int_{\\Omega} (\\boldsymbol{\\kappa}^c + \\boldsymbol{\\kappa}^i)^{T}\\,\\mathbf{D}_{b}\\,(\\boldsymbol{\\kappa}^c + \\boldsymbol{\\kappa}^i)\\, \\mathrm{d}A \\;=\\; \\frac{1}{2}\\int_{\\Omega} \\left( (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c + 2 (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^i + (\\boldsymbol{\\kappa}^i)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^i \\right) \\mathrm{d}A\n$$\nThe strain fields are related to the degrees of freedom $q$ and $a$ by strain-displacement matrices $\\mathbf{B}_c$ and $\\mathbf{B}_i$ such that $\\boldsymbol{\\kappa}^c = \\mathbf{B}_c q$ and $\\boldsymbol{\\kappa}^i = \\mathbf{B}_i a$. The energy can then be written in matrix form:\n$$\n\\Pi_{b} \\;=\\; \\frac{1}{2} q^T \\mathbf{K}_{cc} q + q^T \\mathbf{K}_{ci} a + \\frac{1}{2} a^T \\mathbf{K}_{ii} a\n$$\nwhere the stiffness sub-matrices are defined by integrals over the element domain $\\Omega$:\n$\\mathbf{K}_{cc} = \\int_{\\Omega} \\mathbf{B}_c^T \\mathbf{D}_b \\mathbf{B}_c \\mathrm{d}A$, $\\mathbf{K}_{ci} = \\int_{\\Omega} \\mathbf{B}_c^T \\mathbf{D}_b \\mathbf{B}_i \\mathrm{d}A$, and $\\mathbf{K}_{ii} = \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\mathrm{d}A$.\n\nThe quadratic forms in the ratio $r$ can be expressed directly in terms of the strain fields:\nThe denominator is $q^T \\mathbf{K}_{cc} q = \\int_{\\Omega} (\\mathbf{B}_c q)^T \\mathbf{D}_b (\\mathbf{B}_c q) \\mathrm{d}A = \\int_{\\Omega} (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\mathrm{d}A$.\nFor the numerator, since $a$ is a scalar degree of freedom, $\\mathbf{K}_{ii}$ is a $1 \\times 1$ matrix (a scalar), $\\mathbf{K}_{ic}$ is a $1 \\times N$ row vector (where $N$ is the size of $q$), and $\\mathbf{K}_{ci} = \\mathbf{K}_{ic}^T$ is a $N \\times 1$ column vector. The numerator becomes:\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q = \\frac{(q^T \\mathbf{K}_{ci})(\\mathbf{K}_{ic} q)}{\\mathbf{K}_{ii}} = \\frac{(\\mathbf{K}_{ic}q)^2}{\\mathbf{K}_{ii}}\n$$\nwhere $\\mathbf{K}_{ic} q = \\left(\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_c \\mathrm{d}A\\right) q = \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b (\\mathbf{B}_c q) \\mathrm{d}A = \\int_{\\Omega} (\\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c) \\mathrm{d}A$. Also, $\\mathbf{K}_{ii}$ is the scalar integral $\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\mathrm{d}A$.\nThus, the numerator is:\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q = \\frac{\\left( \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\mathrm{d}A \\right)^2}{\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\mathrm{d}A}\n$$\n\nWe now compute the necessary components using the provided data.\nThe domain is $\\Omega = [0,1] \\times [0,1]$.\nThe constitutive matrix is $\\mathbf{D}_{b} = \\mathrm{diag}(1, 1, \\frac{1}{2})$.\n\nFirst, determine the strain fields.\nThe compatible rotation fields are $\\theta_{x}^{c}(x,y) = x$ and $\\theta_{y}^{c}(x,y) = 0$. The corresponding compatible strains (curvatures) are:\n$$\n\\boldsymbol{\\kappa}^c = \\begin{pmatrix} -\\frac{\\partial \\theta_{x}^{c}}{\\partial x} \\\\ -\\frac{\\partial \\theta_{y}^{c}}{\\partial y} \\\\ -\\frac{\\partial \\theta_{x}^{c}}{\\partial y} - \\frac{\\partial \\theta_{y}^{c}}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} -\\frac{\\partial (x)}{\\partial x} \\\\ -\\frac{\\partial (0)}{\\partial y} \\\\ -\\frac{\\partial (x)}{\\partial y} - \\frac{\\partial (0)}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe incompatible rotation fields are $\\theta_{x}^{i}(x,y) = a\\,x\\,y$ and $\\theta_{y}^{i}(x,y) = 0$. The corresponding incompatible strains are:\n$$\n\\boldsymbol{\\kappa}^i = \\begin{pmatrix} -\\frac{\\partial (a\\,x\\,y)}{\\partial x} \\\\ -\\frac{\\partial (0)}{\\partial y} \\\\ -\\frac{\\partial (a\\,x\\,y)}{\\partial y} - \\frac{\\partial (0)}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} -a\\,y \\\\ 0 \\\\ -a\\,x \\end{pmatrix} = a \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix}\n$$\nFrom this, we identify the incompatible strain shape matrix $\\mathbf{B}_i = \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix}$.\n\nNow, we compute the integrals.\n1. Denominator of $r$: $q^T \\mathbf{K}_{cc} q = \\int_{\\Omega} (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\mathrm{d}A$.\nThe integrand is:\n$$\n(\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c = \\begin{pmatrix} -1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 1\n$$\nThe integral is over the unit square:\n$$\nq^T \\mathbf{K}_{cc} q = \\int_{0}^{1}\\int_{0}^{1} 1\\, \\mathrm{d}x\\mathrm{d}y = 1\n$$\n\n2. Numerator of $r$: $q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q$. This requires two separate integrals.\na. The coupling integral term $\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\mathrm{d}A$:\nThe integrand is:\n$$\n\\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c = \\begin{pmatrix} -y & 0 & -x \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -y & 0 & -\\frac{x}{2} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = y\n$$\nThe integral is:\n$$\n\\int_{0}^{1}\\int_{0}^{1} y\\, \\mathrm{d}x\\mathrm{d}y = \\int_{0}^{1} y \\left[ x \\right]_{0}^{1} \\mathrm{d}y = \\int_{0}^{1} y\\, \\mathrm{d}y = \\left[ \\frac{y^2}{2} \\right]_{0}^{1} = \\frac{1}{2}\n$$\nSo, the squared term is $(\\frac{1}{2})^2 = \\frac{1}{4}$.\n\nb. The incompatible stiffness term $\\mathbf{K}_{ii} = \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\mathrm{d}A$:\nThe integrand is:\n$$\n\\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i = \\begin{pmatrix} -y & 0 & -x \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix} = \\begin{pmatrix} -y & 0 & -\\frac{x}{2} \\end{pmatrix} \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix} = y^2 + \\frac{x^2}{2}\n$$\nThe integral is:\n$$\n\\mathbf{K}_{ii} = \\int_{0}^{1}\\int_{0}^{1} \\left(y^2 + \\frac{x^2}{2}\\right) \\mathrm{d}x\\mathrm{d}y = \\int_{0}^{1} \\left[ y^2 x + \\frac{x^3}{6} \\right]_{0}^{1} \\mathrm{d}y = \\int_{0}^{1} \\left(y^2 + \\frac{1}{6}\\right) \\mathrm{d}y\n$$\n$$\n\\mathbf{K}_{ii} = \\left[ \\frac{y^3}{3} + \\frac{y}{6} \\right]_{0}^{1} = \\frac{1}{3} + \\frac{1}{6} = \\frac{2}{6} + \\frac{1}{6} = \\frac{3}{6} = \\frac{1}{2}\n$$\n\nc. Assemble the numerator:\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q = \\frac{\\left( \\frac{1}{2} \\right)^2}{\\frac{1}{2}} = \\frac{\\frac{1}{4}}{\\frac{1}{2}} = \\frac{1}{2}\n$$\n\n3. Finally, compute the ratio $r$:\n$$\nr = \\frac{q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q}{q^{T}\\mathbf{K}_{cc}q} = \\frac{\\frac{1}{2}}{1} = \\frac{1}{2}\n$$\nThe ratio representing the change in bending stiffness for the given mode due to the addition of the incompatible mode is precisely $\\frac{1}{2}$. This change corresponds to a reduction in stiffness, as the effective stiffness matrix after static condensation is $\\mathbf{K}_{eff} = \\mathbf{K}_{cc} - \\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}$. This softening effect is a known consequence of such incompatible mode formulations, often introduced to alleviate locking phenomena.", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "2568518"}, {"introduction": "While incompatible modes are designed to correct specific deficiencies, a crucial aspect of their design is to avoid negatively impacting the element's performance in other deformation modes. This exercise explores the vital concept of energy orthogonality, where a carefully chosen incompatible mode is shown to have no energetic coupling with a fundamental compatible deformation. Completing this practice [@problem_id:2568586] will illuminate how incompatible modes can be precisely targeted to alleviate locking without introducing unwanted side effects.", "problem": "Consider a single eight-node trilinear hexahedral element occupying the unit cube domain $\\Omega = [0,1] \\times [0,1] \\times [0,1]$ in Cartesian coordinates $(x,y,z)$. The material is linear elastic, homogeneous, and isotropic with Lamé parameters $\\lambda$ and $\\mu$, where the shear modulus is $G = \\mu$. Assume infinitesimal kinematics with the small-strain tensor defined by $\\varepsilon_{ij} = \\tfrac{1}{2}(\\partial u_i/\\partial x_j + \\partial u_j/\\partial x_i)$, and the Cauchy stress satisfying $\\sigma_{ij} = \\lambda \\,\\varepsilon_{kk} \\delta_{ij} + 2 G \\,\\varepsilon_{ij}$.\n\nA simple shear test is considered in the $x$-$y$ plane with a single compatible generalized degree of freedom $\\gamma$ inducing the displacement field $u_x^{(c)}(x,y,z) = \\gamma\\, y$, $u_y^{(c)}(x,y,z) = 0$, and $u_z^{(c)}(x,y,z) = 0$. This compatible mode produces a constant engineering shear $\\gamma_{xy} = \\gamma$ in the element.\n\nAugment the element kinematics with one specific incompatible shear mode that is condensed at the element level, defined by the displacement enrichment\n$u_x^{(i)}(x,y,z) = 0$, $u_y^{(i)}(x,y,z) = a\\,\\psi(x)$, and $u_z^{(i)}(x,y,z) = 0$,\nwhere $a$ is an internal amplitude and $\\psi(x) = 4x(1-x)$. This choice corresponds to a bubble mode originating from the natural coordinate function $(1-\\xi^2)$ under the standard isoparametric map to the unit cube.\n\nTreat $\\gamma$ as the single compatible degree of freedom and $a$ as an internal degree of freedom. Using the principle of virtual work and total strain energy, form the quadratic energy $U(\\gamma,a)$ over $\\Omega$, identify the scalar stiffness subblocks $K_{cc}$, $K_{ci}=K_{ic}$, and $K_{ii}$ corresponding to $\\gamma$ and $a$, and perform static condensation to obtain the condensed scalar stiffness $\\overline{K} = K_{cc} - K_{ci} K_{ii}^{-1} K_{ic}$ associated with the compatible mode $\\gamma$.\n\nDefine the condensed stiffness contribution of the incompatible mode as $\\Delta k = \\overline{K} - K_{cc}$. Compute $\\Delta k$ for this test. Express your final answer as the dimensionless ratio $\\Delta k/G$. No rounding is required. Do not include any units in your final answer.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nStep 1: Extract Givens.\n- Element Type and Domain: An eight-node trilinear hexahedral element on the unit cube $\\Omega = [0,1] \\times [0,1] \\times [0,1]$ in Cartesian coordinates $(x,y,z)$.\n- Material Model: Linear elastic, homogeneous, isotropic with Lamé parameters $\\lambda$ and $\\mu$, and shear modulus $G = \\mu$.\n- Constitutive Law: Cauchy stress $\\sigma_{ij} = \\lambda \\,\\varepsilon_{kk} \\delta_{ij} + 2 G \\,\\varepsilon_{ij}$.\n- Strain Measure: Infinitesimal strain tensor $\\varepsilon_{ij} = \\tfrac{1}{2}(\\partial u_i/\\partial x_j + \\partial u_j/\\partial x_i)$.\n- Compatible Displacement Field: $u^{(c)}$ corresponding to a generalized degree of freedom $\\gamma$, given by $u_x^{(c)} = \\gamma\\, y$, $u_y^{(c)} = 0$, $u_z^{(c)} = 0$. This field produces a constant engineering shear strain $\\gamma_{xy} = \\gamma$.\n- Incompatible Displacement Field: $u^{(i)}$ corresponding to an internal amplitude $a$, given by $u_x^{(i)} = 0$, $u_y^{(i)} = a\\,\\psi(x)$, $u_z^{(i)} = 0$, where the bubble function is $\\psi(x) = 4x(1-x)$.\n- Objective: Form the quadratic energy $U(\\gamma,a)$, identify the stiffness subblocks $K_{cc}$, $K_{ci}=K_{ic}$, and $K_{ii}$. Then, compute the condensed stiffness $\\overline{K} = K_{cc} - K_{ci} K_{ii}^{-1} K_{ic}$ and the stiffness contribution of the incompatible mode, $\\Delta k = \\overline{K} - K_{cc}$. The final result is the dimensionless ratio $\\Delta k/G$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, being a standard exercise in the theory of the finite element method, specifically concerning element technology for mitigating shear locking. It is well-posed, providing all necessary functions, material laws, and a clear objective. The terminology is precise and objective. The problem does not violate any criteria for invalidity. It is a formalizable problem within continuum mechanics and numerical analysis.\n\nStep 3: Verdict and Action.\nThe problem is valid. A solution will be formulated.\n\nThe total displacement field $u$ is the sum of the compatible and incompatible parts, $u = u^{(c)} + u^{(i)}$. The components are:\n$$u_x = \\gamma y$$\n$$u_y = a \\psi(x) = a(4x(1-x)) = 4ax - 4ax^2$$\n$$u_z = 0$$\n\nNext, we calculate the components of the infinitesimal strain tensor $\\varepsilon_{ij} = \\frac{1}{2}(\\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i})$.\nThe non-zero derivatives of the displacement components are:\n$$\\frac{\\partial u_x}{\\partial y} = \\gamma$$\n$$\\frac{\\partial u_y}{\\partial x} = a \\frac{d\\psi}{dx} = a(4 - 8x)$$\nAll other first-order partial derivatives are zero.\n\nThe components of the strain tensor are:\n$\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = 0$\n$\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = 0$\n$\\varepsilon_{zz} = \\frac{\\partial u_z}{\\partial z} = 0$\n$\\varepsilon_{yz} = \\frac{1}{2}(\\frac{\\partial u_y}{\\partial z} + \\frac{\\partial u_z}{\\partial y}) = 0$\n$\\varepsilon_{xz} = \\frac{1}{2}(\\frac{\\partial u_x}{\\partial z} + \\frac{\\partial u_z}{\\partial x}) = 0$\nThe only non-zero strain component is $\\varepsilon_{xy}$:\n$$\\varepsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right) = \\frac{1}{2}(\\gamma + a(4-8x))$$\nDue to symmetry of the strain tensor, $\\varepsilon_{yx} = \\varepsilon_{xy}$.\n\nThe volumetric strain is the trace of the strain tensor:\n$$\\varepsilon_{kk} = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz} = 0$$\nWith zero volumetric strain, the constitutive relation for the Cauchy stress $\\sigma_{ij}$ simplifies to:\n$$\\sigma_{ij} = 2G \\varepsilon_{ij}$$\nThe only non-zero stress components are therefore $\\sigma_{xy}$ and $\\sigma_{yx}$:\n$$\\sigma_{xy} = \\sigma_{yx} = 2G \\varepsilon_{xy} = G(\\gamma + a(4-8x))$$\n\nThe strain energy density $U_0$ is given by $U_0 = \\frac{1}{2} \\sigma_{ij} \\varepsilon_{ij}$. Summing over all indices:\n$$U_0 = \\frac{1}{2} (\\sigma_{xy} \\varepsilon_{xy} + \\sigma_{yx} \\varepsilon_{yx}) = \\sigma_{xy} \\varepsilon_{xy}$$\nSubstituting the expressions for stress and strain:\n$$U_0 = \\left[G(\\gamma + a(4-8x))\\right] \\left[\\frac{1}{2}(\\gamma + a(4-8x))\\right] = \\frac{G}{2} (\\gamma + a(4-8x))^2$$\n\nThe total strain energy $U$ is the integral of the strain energy density over the element volume $\\Omega = [0,1]^3$:\n$$U(\\gamma, a) = \\int_{\\Omega} U_0 \\,dV = \\int_0^1 \\int_0^1 \\int_0^1 \\frac{G}{2} (\\gamma + a(4-8x))^2 \\,dx\\,dy\\,dz$$\nSince the integrand is independent of $y$ and $z$, the integration over these variables yields a factor of $1$.\n$$U(\\gamma, a) = \\frac{G}{2} \\int_0^1 (\\gamma + a(4-8x))^2 \\,dx$$\nExpanding the integrand:\n$$U(\\gamma, a) = \\frac{G}{2} \\int_0^1 \\left(\\gamma^2 + 2\\gamma a (4-8x) + a^2 (4-8x)^2\\right) \\,dx$$\nThis quadratic form for the energy can be written as $U = \\frac{1}{2} \\begin{pmatrix} \\gamma & a \\end{pmatrix} \\begin{pmatrix} K_{cc} & K_{ci} \\\\ K_{ic} & K_{ii} \\end{pmatrix} \\begin{pmatrix} \\gamma \\\\ a \\end{pmatrix}$. The stiffness subblocks are determined by the integrals of the corresponding terms.\n\n$$K_{cc} = G \\int_0^1 1 \\,dx = G [x]_0^1 = G$$\n$$K_{ci} = K_{ic} = G \\int_0^1 (4-8x) \\,dx = G [4x - 4x^2]_0^1 = G((4-4) - (0-0)) = 0$$\n$$K_{ii} = G \\int_0^1 (4-8x)^2 \\,dx = G \\int_0^1 (16 - 64x + 64x^2) \\,dx = G \\left[16x - 32x^2 + \\frac{64}{3}x^3\\right]_0^1$$\n$$K_{ii} = G \\left(16 - 32 + \\frac{64}{3}\\right) = G \\left(-16 + \\frac{64}{3}\\right) = G \\left(-\\frac{48}{3} + \\frac{64}{3}\\right) = \\frac{16}{3}G$$\n\nSo, the stiffness matrix components are:\n$$K_{cc} = G$$\n$$K_{ci} = K_{ic} = 0$$\n$$K_{ii} = \\frac{16}{3}G$$\nThe fact that the coupling stiffness $K_{ci}$ is zero indicates that the chosen compatible and incompatible modes are orthogonal in energy for this material law and geometry.\n\nThe condensed stiffness $\\overline{K}$ is obtained by static condensation:\n$$\\overline{K} = K_{cc} - K_{ci} K_{ii}^{-1} K_{ic}$$\nSubstituting the calculated values:\n$$\\overline{K} = G - (0) \\left(\\frac{16}{3}G\\right)^{-1} (0) = G$$\n\nThe condensed stiffness contribution of the incompatible mode is defined as $\\Delta k$:\n$$\\Delta k = \\overline{K} - K_{cc}$$\n$$\\Delta k = G - G = 0$$\n\nThe problem asks for the dimensionless ratio $\\Delta k/G$:\n$$\\frac{\\Delta k}{G} = \\frac{0}{G} = 0$$\nThe result indicates that for this specific problem of pure shear, the chosen incompatible \"bubble\" mode does not alter the element's stiffness response. This is a consequence of the energy orthogonality between the constant shear strain field and the linearly varying shear strain field produced by the incompatible mode.", "answer": "$$\\boxed{0}$$", "id": "2568586"}, {"introduction": "Moving from theory to robust numerical implementation introduces new challenges, particularly regarding numerical stability. This final practice [@problem_id:2568531] tackles the critical issue of ill-conditioning that can arise in the internal stiffness matrix when elements become distorted. By writing a short program to analyze an element with a large aspect ratio, you will numerically investigate this problem and implement a standard scaling technique that ensures the robustness and reliability of the incompatible mode formulation in practical simulations.", "problem": "You are given a rectangular, isoparametric, four-node quadrilateral finite element in two-dimensional linear elasticity under plane strain. Consider an Enhanced Assumed Strain (EAS) incompatible-mode enrichment with $2$ internal strain parameters collected in the vector $\\boldsymbol{\\alpha} = [\\alpha_{x}, \\alpha_{y}]^{\\mathsf{T}}$. The incompatible strain field is assumed directly in physical coordinates $(x,y)$ as\n$$\n\\boldsymbol{\\varepsilon}^{\\text{inc}}(x,y) \\;=\\; \\mathbf{H}(x,y)\\,\\boldsymbol{\\alpha}, \\qquad \n\\mathbf{H}(x,y) \\;=\\; \n\\begin{bmatrix}\nx & 0 \\\\\n0 & y \\\\\n0 & 0\n\\end{bmatrix},\n$$\nso that $\\varepsilon_{xx}^{\\text{inc}} = \\alpha_{x}\\,x$, $\\varepsilon_{yy}^{\\text{inc}} = \\alpha_{y}\\,y$, and $\\gamma_{xy}^{\\text{inc}} = 0$.\n\nLet the element occupy the rectangle $[-a/2,\\,a/2] \\times [-b/2,\\,b/2]$ in physical coordinates, with side lengths $a>0$ and $b>0$ and aspect ratio $r = a/b$. The linear elastic constitutive matrix for plane strain is\n$$\n\\mathbf{D} \\;=\\; \n\\begin{bmatrix}\n\\lambda + 2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2\\mu & 0 \\\\\n0 & 0 & 2\\mu\n\\end{bmatrix}, \\qquad\n\\lambda \\;=\\; \\dfrac{E\\,\\nu}{(1+\\nu)(1-2\\nu)}, \\quad\n\\mu \\;=\\; \\dfrac{E}{2(1+\\nu)},\n$$\nwhere $E>0$ is the Young’s modulus and $\\nu \\in (0,\\,0.5)$ is the Poisson’s ratio. The incompatible-mode internal stiffness submatrix $\\mathbf{K}_{ii} \\in \\mathbb{R}^{2\\times 2}$ is defined by the strain energy of the incompatible modes:\n$$\n\\mathbf{K}_{ii} \\;=\\; \\int_{\\Omega_e} \\mathbf{H}(x,y)^{\\mathsf{T}} \\,\\mathbf{D}\\, \\mathbf{H}(x,y) \\,\\mathrm{d}A,\n$$\nwith $\\Omega_e$ the element domain in physical coordinates. Assume thickness equal to $1$ so that $\\mathrm{d}A$ is area measure, and all quantities are unit-consistent; the requested condition numbers are therefore unitless and must be reported as pure numbers without any unit.\n\nTo mitigate ill-conditioning with large aspect ratios, consider a length-based scaled variant of the incompatible strain mapping,\n$$\n\\widetilde{\\mathbf{H}}(x,y) \\;=\\; \n\\begin{bmatrix}\n\\dfrac{x}{a} & 0 \\\\\n0 & \\dfrac{y}{b} \\\\\n0 & 0\n\\end{bmatrix},\n\\qquad\n\\widetilde{\\mathbf{K}}_{ii} \\;=\\; \\int_{\\Omega_e} \\widetilde{\\mathbf{H}}(x,y)^{\\mathsf{T}} \\,\\mathbf{D}\\, \\widetilde{\\mathbf{H}}(x,y) \\,\\mathrm{d}A,\n$$\nwhich corresponds to scaling the internal parameters by characteristic element lengths in each direction. The numerical task is to evaluate the sensitivity of the conditioning of $\\mathbf{K}_{ii}$ to the aspect ratio and to assess the effectiveness of the above scaling.\n\nStarting from the total elastic energy functional and the definition of the Enhanced Assumed Strain incompatible modes, derive the expressions needed to numerically evaluate $\\mathbf{K}_{ii}$ and its condition number. Then implement a program that uses tensor-product Gauss–Legendre quadrature on the parent square $[-1,1]\\times[-1,1]$ with the isoparametric mapping\n$$\nx = \\dfrac{a}{2}\\,\\xi, \\qquad y = \\dfrac{b}{2}\\,\\eta, \\qquad \\mathrm{d}A = \\dfrac{ab}{4}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\nto compute the following for each test case:\n- the spectral condition number $\\kappa(\\mathbf{K}_{ii})$ of the unscaled matrix, and\n- the spectral condition number $\\kappa(\\widetilde{\\mathbf{K}}_{ii})$ of the length-scaled matrix.\n\nYour program must implement the following steps from first principles:\n- construct $\\mathbf{D}$ from $(E,\\nu)$,\n- assemble $\\mathbf{K}_{ii}$ and $\\widetilde{\\mathbf{K}}_{ii}$ via numerical quadrature of the given integrals, and\n- compute the spectral condition number using the matrix $2$-norm.\n\nUse the following test suite of element and material parameters $(a,b,E,\\nu)$:\n- Case $1$: $(a,b,E,\\nu) = (\\,1,\\,1,\\,1,\\,0.3\\,)$,\n- Case $2$: $(a,b,E,\\nu) = (\\,10,\\,1,\\,1,\\,0.3\\,)$,\n- Case $3$: $(a,b,E,\\nu) = (\\,1,\\,10,\\,1,\\,0.3\\,)$,\n- Case $4$: $(a,b,E,\\nu) = (\\,10^{-3},\\,1,\\,1,\\,0.3\\,)$,\n- Case $5$: $(a,b,E,\\nu) = (\\,4,\\,1,\\,1,\\,0.4999\\,)$.\n\nAll outputs must be unitless real numbers. For each case, return a pair $[\\kappa(\\mathbf{K}_{ii}),\\,\\kappa(\\widetilde{\\mathbf{K}}_{ii})]$ as floating-point numbers.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing a comma-separated list of the pair results for all cases, enclosed in square brackets. For example, the conceptual format is $[\\,[\\kappa_{1}^{\\text{un}},\\kappa_{1}^{\\text{sc}}],\\,[\\kappa_{2}^{\\text{un}},\\kappa_{2}^{\\text{sc}}],\\,\\dots\\,]$.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Element Definition**: Rectangular, isoparametric, four-node quadrilateral finite element in two-dimensional linear elasticity under plane strain.\n- **Domain**: $\\Omega_e = [-a/2, a/2] \\times [-b/2, b/2]$ with $a > 0$, $b > 0$.\n- **Incompatible Modes**: An Enhanced Assumed Strain (EAS) enrichment with $2$ internal parameters $\\boldsymbol{\\alpha} = [\\alpha_{x}, \\alpha_{y}]^{\\mathsf{T}}$.\n- **Unscaled Incompatible Strain Mapping**: $\\boldsymbol{\\varepsilon}^{\\text{inc}}(x,y) = \\mathbf{H}(x,y)\\,\\boldsymbol{\\alpha}$, with $\\mathbf{H}(x,y) = \\begin{bmatrix} x & 0 \\\\ 0 & y \\\\ 0 & 0 \\end{bmatrix}$.\n- **Length-Scaled Incompatible Strain Mapping**: $\\widetilde{\\boldsymbol{\\varepsilon}}^{\\text{inc}}(x,y) = \\widetilde{\\mathbf{H}}(x,y)\\,\\boldsymbol{\\alpha}$, with $\\widetilde{\\mathbf{H}}(x,y) = \\begin{bmatrix} x/a & 0 \\\\ 0 & y/b \\\\ 0 & 0 \\end{bmatrix}$.\n- **Constitutive Matrix (Plane Strain)**: $\\mathbf{D} = \\begin{bmatrix} \\lambda + 2\\mu & \\lambda & 0 \\\\ \\lambda & \\lambda + 2\\mu & 0 \\\\ 0 & 0 & 2\\mu \\end{bmatrix}$, where $\\lambda = \\frac{E\\,\\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\frac{E}{2(1+\\nu)}$. $E>0$, $\\nu \\in (0, 0.5)$.\n- **Internal Stiffness Matrices**:\n  - Unscaled: $\\mathbf{K}_{ii} = \\int_{\\Omega_e} \\mathbf{H}(x,y)^{\\mathsf{T}} \\,\\mathbf{D}\\, \\mathbf{H}(x,y) \\,\\mathrm{d}A$.\n  - Scaled: $\\widetilde{\\mathbf{K}}_{ii} = \\int_{\\Omega_e} \\widetilde{\\mathbf{H}}(x,y)^{\\mathsf{T}} \\,\\mathbf{D}\\, \\widetilde{\\mathbf{H}}(x,y) \\,\\mathrm{d}A$.\n- **Isoparametric Mapping**: $x = \\frac{a}{2}\\,\\xi$, $y = \\frac{b}{2}\\,\\eta$ for $(\\xi, \\eta) \\in [-1,1]\\times[-1,1]$. The area differential is $\\mathrm{d}A = \\frac{ab}{4}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$.\n- **Numerical Method**: Tensor-product Gauss–Legendre quadrature on the parent element.\n- **Task**: For each test case, compute the spectral condition numbers $\\kappa(\\mathbf{K}_{ii})$ and $\\kappa(\\widetilde{\\mathbf{K}}_{ii})$.\n- **Test Cases**: $(a,b,E,\\nu)$\n  1. $(1, 1, 1, 0.3)$\n  2. $(10, 1, 1, 0.3)$\n  3. $(1, 10, 1, 0.3)$\n  4. $(10^{-3}, 1, 1, 0.3)$\n  5. $(4, 1, 1, 0.4999)$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The problem is formulated within the standard theory of the Finite Element Method, specifically using the Enhanced Assumed Strain (EAS) concept for linear elasticity. All provided equations are correct representations of established principles.\n- **Well-Posed**: The problem is well-posed. The integrals for the stiffness matrices $\\mathbf{K}_{ii}$ and $\\widetilde{\\mathbf{K}}_{ii}$ are defined over a simple rectangular domain with polynomial integrands, ensuring they are well-defined and computable. The material parameters are in valid physical ranges. The task is specific and leads to a unique numerical result.\n- **Objective**: The problem is stated using precise, objective, and standard scientific terminology. There are no subjective or ambiguous statements.\n\nThe problem contains no scientific or factual unsoundness, is formalizable, self-contained, physically plausible, and well-structured.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n---\n\nThe task is to compute the spectral condition numbers of two internal stiffness matrices, $\\mathbf{K}_{ii}$ and $\\widetilde{\\mathbf{K}}_{ii}$, associated with an incompatible-mode formulation. The derivation must originate from first principles and the computation must be performed using numerical quadrature as specified.\n\nFirst, we derive the integrands for the stiffness matrices. The unscaled shape matrix for incompatible strains is $\\mathbf{H}(x,y) = \\begin{bmatrix} x & 0 \\\\ 0 & y \\\\ 0 & 0 \\end{bmatrix}$. The constitutive matrix is $\\mathbf{D}$. The integrand for $\\mathbf{K}_{ii}$ is the $2 \\times 2$ matrix $\\mathbf{H}^{\\mathsf{T}}\\mathbf{D}\\mathbf{H}$.\n$$\n\\mathbf{H}^{\\mathsf{T}}\\mathbf{D}\\mathbf{H} =\n\\begin{bmatrix} x & 0 & 0 \\\\ 0 & y & 0 \\end{bmatrix}\n\\begin{bmatrix}\n\\lambda + 2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2\\mu & 0 \\\\\n0 & 0 & 2\\mu\n\\end{bmatrix}\n\\begin{bmatrix} x & 0 \\\\ 0 & y \\\\ 0 & 0 \\end{bmatrix}\n=\n\\begin{bmatrix} (\\lambda + 2\\mu)x^2 & \\lambda xy \\\\ \\lambda xy & (\\lambda + 2\\mu)y^2 \\end{bmatrix}\n$$\nThe matrix $\\mathbf{K}_{ii}$ is obtained by integrating this expression over the element domain $\\Omega_e = [-a/2, a/2] \\times [-b/2, b/2]$.\n$$\n\\mathbf{K}_{ii} = \\int_{-b/2}^{b/2} \\int_{-a/2}^{a/2}\n\\begin{bmatrix} (\\lambda + 2\\mu)x^2 & \\lambda xy \\\\ \\lambda xy & (\\lambda + 2\\mu)y^2 \\end{bmatrix}\n\\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\nDue to the symmetry of the integration domain about the origin, the integrals of the off-diagonal terms, which are odd functions ($xy$), evaluate to zero.\n$$\n\\int_{-a/2}^{a/2} x \\,\\mathrm{d}x = 0, \\quad \\int_{-b/2}^{b/2} y \\,\\mathrm{d}y = 0 \\quad \\implies \\quad \\int_{\\Omega_e} xy \\,\\mathrm{d}A = 0\n$$\nThe diagonal terms are computed as:\n$$\n(\\mathbf{K}_{ii})_{11} = (\\lambda + 2\\mu) \\int_{-b/2}^{b/2} \\int_{-a/2}^{a/2} x^2 \\,\\mathrm{d}x\\,\\mathrm{d}y = (\\lambda + 2\\mu) \\left( b \\right) \\left( \\frac{x^3}{3} \\right)\\bigg|_{-a/2}^{a/2} = (\\lambda + 2\\mu) \\frac{a^3b}{12}\n$$\n$$\n(\\mathbf{K}_{ii})_{22} = (\\lambda + 2\\mu) \\int_{-b/2}^{b/2} \\int_{-a/2}^{a/2} y^2 \\,\\mathrm{d}x\\,\\mathrm{d}y = (\\lambda + 2\\mu) \\left( a \\right) \\left( \\frac{y^3}{3} \\right)\\bigg|_{-b/2}^{b/2} = (\\lambda + 2\\mu) \\frac{ab^3}{12}\n$$\nThus, the unscaled internal stiffness matrix is diagonal:\n$$\n\\mathbf{K}_{ii} = \\frac{\\lambda + 2\\mu}{12}\n\\begin{bmatrix} a^3b & 0 \\\\ 0 & ab^3 \\end{bmatrix}\n$$\nThe spectral condition number $\\kappa(\\mathbf{K}_{ii})$ is the ratio of the largest to the smallest eigenvalue. For a positive definite diagonal matrix, this is the ratio of the maximum to the minimum diagonal entry.\n$$\n\\kappa(\\mathbf{K}_{ii}) = \\frac{\\max(a^3b, ab^3)}{\\min(a^3b, ab^3)} = \\frac{\\max(a^2, b^2)}{\\min(a^2, b^2)} = \\left( \\frac{\\max(a, b)}{\\min(a, b)} \\right)^2 = \\max\\left( \\frac{a^2}{b^2}, \\frac{b^2}{a^2} \\right)\n$$\nIf we define the aspect ratio $r = a/b$, then $\\kappa(\\mathbf{K}_{ii}) = \\max(r^2, 1/r^2)$. This directly shows the sensitivity of the conditioning to the element aspect ratio.\n\nNext, we analyze the length-scaled formulation. The scaled shape matrix is $\\widetilde{\\mathbf{H}}(x,y) = \\begin{bmatrix} x/a & 0 \\\\ 0 & y/b \\\\ 0 & 0 \\end{bmatrix}$. The integrand is $\\widetilde{\\mathbf{H}}^{\\mathsf{T}}\\mathbf{D}\\widetilde{\\mathbf{H}}$. Following the same procedure, we replace $x$ with $x/a$ and $y$ with $y/b$ in the integrand expression.\n$$\n\\widetilde{\\mathbf{H}}^{\\mathsf{T}}\\mathbf{D}\\widetilde{\\mathbf{H}} =\n\\begin{bmatrix} (\\lambda + 2\\mu)(x/a)^2 & \\lambda (x/a)(y/b) \\\\ \\lambda (x/a)(y/b) & (\\lambda + 2\\mu)(y/b)^2 \\end{bmatrix}\n$$\nIntegrating over $\\Omega_e$:\n$$\n(\\widetilde{\\mathbf{K}}_{ii})_{11} = \\frac{\\lambda + 2\\mu}{a^2} \\int_{\\Omega_e} x^2 \\,\\mathrm{d}A = \\frac{\\lambda + 2\\mu}{a^2} \\frac{a^3b}{12} = (\\lambda + 2\\mu) \\frac{ab}{12}\n$$\n$$\n(\\widetilde{\\mathbf{K}}_{ii})_{22} = \\frac{\\lambda + 2\\mu}{b^2} \\int_{\\Omega_e} y^2 \\,\\mathrm{d}A = \\frac{\\lambda + 2\\mu}{b^2} \\frac{ab^3}{12} = (\\lambda + 2\\mu) \\frac{ab}{12}\n$$\nThe off-diagonal terms are again zero. The resulting scaled matrix is:\n$$\n\\widetilde{\\mathbf{K}}_{ii} = (\\lambda + 2\\mu) \\frac{ab}{12}\n\\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}\n$$\nThis is a multiple of the identity matrix. The condition number of any non-zero multiple of the identity matrix is identically $1$.\n$$\n\\kappa(\\widetilde{\\mathbf{K}}_{ii}) = 1\n$$\nThis analytical derivation confirms that the length scaling eliminates the dependency of the internal stiffness matrix conditioning on the element aspect ratio. Notably, the material parameters $E$ and $\\nu$ do not influence the condition numbers in either case, as they appear as a common scaling factor on the diagonal entries.\n\nFor the numerical implementation, we use a tensor-product Gauss-Legendre quadrature. The transformation from the parent element $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ to the physical element is $x = \\frac{a}{2}\\xi$ and $y = \\frac{b}{2}\\eta$. The differential area is $\\mathrm{d}A = \\det(\\mathbf{J})\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta = \\frac{ab}{4}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$.\nThe integral for any component of $\\mathbf{K}_{ii}$ or $\\widetilde{\\mathbf{K}}_{ii}$ takes the form:\n$$\n\\int_{\\Omega_e} f(x,y) \\,\\mathrm{d}A = \\int_{-1}^{1} \\int_{-1}^{1} f\\left(\\frac{a}{2}\\xi, \\frac{b}{2}\\eta\\right) \\frac{ab}{4} \\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta \\approx \\frac{ab}{4} \\sum_{i=1}^{N_p} \\sum_{j=1}^{N_p} w_i w_j f\\left(\\frac{a}{2}\\xi_i, \\frac{b}{2}\\eta_j\\right)\n$$\nwhere $(\\xi_i, w_i)$ and $(\\eta_j, w_j)$ are the Gauss points and weights, and $N_p$ is the number of points in one dimension. The integrands are polynomials in $x$ and $y$ of degree at most $2$. After mapping to the parent element, they become polynomials in $\\xi$ and $\\eta$ of the same degree. A $2$-point Gauss rule ($N_p=2$) integrates polynomials of degree up to $2 \\times 2 - 1 = 3$ exactly. Thus, a $2 \\times 2$ tensor-product quadrature rule is sufficient for an exact evaluation of the integrals.\n\nThe implementation will construct the constitutive matrix $\\mathbf{D}$, perform the numerical integration for $\\mathbf{K}_{ii}$ and $\\widetilde{\\mathbf{K}}_{ii}$ using a $2 \\times 2$ Gauss quadrature for each test case, and then compute their spectral condition numbers.", "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Solves the finite element problem for all specified test cases.\n    \"\"\"\n    \n    # Test suite of element and material parameters (a, b, E, nu).\n    test_cases = [\n        # Case 1: Square element, standard material.\n        (1.0, 1.0, 1.0, 0.3),\n        # Case 2: High aspect ratio (a > b).\n        (10.0, 1.0, 1.0, 0.3),\n        # Case 3: High aspect ratio (b > a).\n        (1.0, 10.0, 1.0, 0.3),\n        # Case 4: Extreme aspect ratio (a << b).\n        (1e-3, 1.0, 1.0, 0.3),\n        # Case 5: High aspect ratio, near-incompressible material.\n        (4.0, 1.0, 1.0, 0.4999),\n    ]\n\n    results = []\n    for case in test_cases:\n        kappa_pair = compute_condition_numbers(*case)\n        results.append(kappa_pair)\n\n    # Format the final output as a comma-separated list of lists.\n    # str([a, b]) produces '[a, b]'. join combines these strings.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef compute_condition_numbers(a: float, b: float, E: float, nu: float):\n    \"\"\"\n    Computes the spectral condition numbers for K_ii and tilde(K)_ii.\n    \n    Args:\n        a: Length of the element in the x-direction.\n        b: Length of the element in the y-direction.\n        E: Young's modulus.\n        nu: Poisson's ratio.\n        \n    Returns:\n        A list containing the condition numbers [kappa(K_ii), kappa(tilde(K)_ii)].\n    \"\"\"\n    \n    # 1. Construct the plane strain constitutive matrix D.\n    # Lamé parameters\n    lmbda = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n    mu = E / (2 * (1 + nu))\n    \n    D = np.array([\n        [lmbda + 2 * mu, lmbda,         0],\n        [lmbda,         lmbda + 2 * mu, 0],\n        [0,             0,             2 * mu]\n    ])\n    \n    # 2. Set up tensor-product Gauss-Legendre quadrature.\n    # A 2-point rule is exact for the polynomial integrands.\n    n_gauss_points = 2\n    gauss_points, gauss_weights = roots_legendre(n_gauss_points)\n    \n    # Isoparametric mapping Jacobian determinant (constant for a rectangle).\n    det_J = (a * b) / 4.0\n    \n    # 3. Assemble K_ii (unscaled) and tilde(K)_ii (scaled).\n    K_ii = np.zeros((2, 2))\n    tilde_K_ii = np.zeros((2, 2))\n    \n    for i in range(n_gauss_points):\n        for j in range(n_gauss_points):\n            xi = gauss_points[i]\n            eta = gauss_points[j]\n            w_i = gauss_weights[i]\n            w_j = gauss_weights[j]\n            \n            # Map from parent to physical coordinates.\n            x = (a / 2.0) * xi\n            y = (b / 2.0) * eta\n            \n            # --- Unscaled version ---\n            # H matrix: epsilon_inc = H * alpha\n            H = np.array([\n                [x,   0.0],\n                [0.0,   y],\n                [0.0, 0.0]\n            ])\n            \n            # Integrand for K_ii\n            integrand_K = H.T @ D @ H\n            K_ii += integrand_K * w_i * w_j * det_J\n\n            # --- Scaled version ---\n            # tilde(H) matrix\n            tilde_H = np.array([\n                [x / a, 0.0],\n                [0.0, y / b],\n                [0.0, 0.0]\n            ])\n\n            # Integrand for tilde(K)_ii\n            integrand_tilde_K = tilde_H.T @ D @ tilde_H\n            tilde_K_ii += integrand_tilde_K * w_i * w_j * det_J\n\n    # 4. Compute spectral condition numbers (using 2-norm).\n    kappa_K_ii = np.linalg.cond(K_ii, 2)\n    kappa_tilde_K_ii = np.linalg.cond(tilde_K_ii, 2)\n    \n    return [kappa_K_ii, kappa_tilde_K_ii]\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2568531"}]}