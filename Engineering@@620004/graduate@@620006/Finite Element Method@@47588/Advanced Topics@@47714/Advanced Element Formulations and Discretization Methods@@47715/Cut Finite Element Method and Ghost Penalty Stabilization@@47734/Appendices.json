{"hands_on_practices": [{"introduction": "Before diving into complex dynamics, let's start with a foundational concept: how does a cut-cell approach alter the degrees of freedom in our problem? This exercise provides a minimal, one-dimensional example to contrast the degrees of freedom in a traditional \"fitted\" mesh with those in an \"unfitted\" background mesh. Mastering this distinction is the first step toward understanding the unique structure of the Cut Finite Element Method [@problem_id:2551896].", "problem": "Consider the one-dimensional setting with background (computational) domain $\\widetilde{\\Omega}=(0,1)$ equipped with a uniform partition (background mesh) of mesh size $h=\\frac{1}{4}$, i.e., nodes at $\\{0,\\frac{1}{4},\\frac{1}{2},\\frac{3}{4},1\\}$. Let the physical domain be $\\Omega=(0.48,0.52)\\subset\\widetilde{\\Omega}$. Use the conforming, continuous, piecewise-linear (linear Lagrange) finite element space on intervals.\n\nDefine two discrete spaces:\n- The fitted space $V_{h}^{\\mathrm{fit}}$ is built on a mesh that conforms to $\\Omega$, with target element size $h=\\frac{1}{4}$, obtained by partitioning $\\Omega$ into subintervals of length at most $h$ starting from the left endpoint of $\\Omega$ and ending at the right endpoint of $\\Omega$. The degrees of freedom are the nodal values at the mesh nodes on this fitted mesh over $\\Omega$.\n- The unfitted (cut) space $V_{h}^{\\mathrm{cut}}$ is built on the background mesh by restricting the basis functions to $\\Omega$: the active elements are those background elements whose intersection with $\\Omega$ is nonempty, and the active degrees of freedom are those associated with all vertices of the active elements. Assume a standard Cut Finite Element Method (CutFEM) with ghost penalty stabilization across interior faces of the active mesh to ensure robustness with respect to small cuts; the ghost penalty does not introduce additional degrees of freedom.\n\nWorking strictly from these definitions (and counting prior to any enforcement of essential boundary conditions on $\\partial\\Omega$), compute the difference\n$$\nD \\;=\\; \\dim V_{h}^{\\mathrm{cut}} \\;-\\; \\dim V_{h}^{\\mathrm{fit}}.\n$$\nReport $D$ as a single integer. No rounding is required.", "solution": "The problem requires the computation of the difference in dimension between two discrete finite element spaces, one fitted to the physical domain $\\Omega$ and one unfitted, defined by restricting a background mesh to $\\Omega$. The problem is well-posed and contains all necessary information for a unique solution. We will proceed by determining the dimension of each space, $V_{h}^{\\mathrm{fit}}$ and $V_{h}^{\\mathrm{cut}}$, according to their definitions. The dimension of a finite element space is equal to the number of its basis functions, which, in the context of Lagrange elements, is the number of degrees of freedom (nodes) before the application of any essential boundary conditions.\n\nFirst, we determine the dimension of the fitted space, $\\dim V_{h}^{\\mathrm{fit}}$.\nThe physical domain is given as $\\Omega=(0.48, 0.52)$. The length of this domain is $L = 0.52 - 0.48 = 0.04$. The target element size for the fitted mesh is specified as $h = \\frac{1}{4} = 0.25$.\nThe definition of the fitted mesh states that it is constructed by partitioning $\\Omega$ into subintervals of length at most $h$. Since the total length of the domain $L=0.04$ is less than the maximum allowed element size $h=0.25$, the entire domain $\\Omega$ is treated as a single finite element. This element is the interval $[0.48, 0.52]$.\nThe finite element space is composed of continuous, piecewise-linear functions. For a single linear element, the basis functions are uniquely determined by the nodal values at its vertices. The vertices of the element $[0.48, 0.52]$ are the points $0.48$ and $0.52$.\nThese two points are the nodes of the fitted mesh. The number of degrees of freedom is therefore $2$.\nThus, the dimension of the fitted space is:\n$$\n\\dim V_{h}^{\\mathrm{fit}} = 2\n$$\n\nNext, we determine the dimension of the unfitted (cut) space, $\\dim V_{h}^{\\mathrm{cut}}$.\nThis space is built upon a background mesh covering the computational domain $\\widetilde{\\Omega}=(0,1)$. This background mesh is a uniform partition with mesh size $h=\\frac{1}{4}$. The nodes of the background mesh are located at $\\{0, \\frac{1}{4}, \\frac{1}{2}, \\frac{3}{4}, 1\\}$, which correspond to the numerical values $\\{0, 0.25, 0.5, 0.75, 1\\}$.\nThe background elements are the intervals between these nodes: $I_1 = (0, 0.25)$, $I_2 = (0.25, 0.5)$, $I_3 = (0.5, 0.75)$, and $I_4 = (0.75, 1)$.\n\nAccording to the definition of $V_{h}^{\\mathrm{cut}}$, we must first identify the \"active elements\", which are the background elements whose intersection with the physical domain $\\Omega=(0.48, 0.52)$ is non-empty. We check each background element:\n- Intersection with $I_1$: $(0, 0.25) \\cap (0.48, 0.52) = \\emptyset$.\n- Intersection with $I_2$: $(0.25, 0.5) \\cap (0.48, 0.52) = (0.48, 0.5)$. This intersection is non-empty, so $I_2$ is an active element.\n- Intersection with $I_3$: $(0.5, 0.75) \\cap (0.48, 0.52) = (0.5, 0.52)$. This intersection is non-empty, so $I_3$ is an active element.\n- Intersection with $I_4$: $(0.75, 1) \\cap (0.48, 0.52) = \\emptyset$.\n\nThe set of active elements is $\\{I_2, I_3\\}$. The \"active degrees of freedom\" are defined as those associated with *all* vertices of the active elements.\n- The vertices of active element $I_2 = (0.25, 0.5)$ are the nodes at $0.25$ and $0.5$.\n- The vertices of active element $I_3 = (0.5, 0.75)$ are the nodes at $0.5$ and $0.75$.\n\nThe set of all active nodes is the union of the sets of vertices from all active elements: $\\{0.25, 0.5\\} \\cup \\{0.5, 0.75\\} = \\{0.25, 0.5, 0.75\\}$.\nThe number of distinct active nodes is $3$. The dimension of the unfitted space is the number of these active degrees of freedom. The mention of ghost penalty stabilization is a distraction, as the problem correctly states it does not add degrees of freedom.\nThus, the dimension of the unfitted space is:\n$$\n\\dim V_{h}^{\\mathrm{cut}} = 3\n$$\n\nFinally, we compute the required difference, $D$:\n$$\nD = \\dim V_{h}^{\\mathrm{cut}} - \\dim V_{h}^{\\mathrm{fit}} = 3 - 2 = 1\n$$\nThe difference is an integer, and no rounding is necessary.", "answer": "$$\n\\boxed{1}\n$$", "id": "2551896"}, {"introduction": "The primary challenge in CutFEM arises when the physical domain cuts a mesh element into a very small portion, which can lead to severe numerical instability. This practice guides you through a classic one-dimensional example to mathematically diagnose this instability by analyzing the condition number, $\\kappa$, of the system matrix as a function of the cut size $\\varepsilon$. You will then see firsthand how introducing a \"ghost penalty\" term restores stability, demonstrating that the condition number remains bounded regardless of how severely the element is cut [@problem_id:2551856].", "problem": "Consider the scalar diffusion model problem on a one-dimensional physical domain cut out of a fixed background mesh. Let the background interval be $[0,2h]$ with nodes $x_0=0$, $x_1=h$, and $x_2=2h$, where $h>0$ is fixed. Let the physical domain be $\\Omega=((1-\\varepsilon)h,2h)$, where the cut fraction $\\varepsilon\\in(0,1)$ satisfies $|K_1\\cap\\Omega|/|K_1|=\\varepsilon$ for the leftmost element $K_1=[0,h]$. Consider the homogeneous diffusion equation $-u''=0$ on $\\Omega$ with a homogeneous Neumann boundary condition at $x=(1-\\varepsilon)h$ and a homogeneous Dirichlet boundary condition at $x=2h$. Let the trial space be the continuous, piecewise linear background finite element space on the mesh $\\{[0,h],[h,2h]\\}$, restricted to $\\Omega$, and let the Dirichlet condition at $x=2h$ be imposed strongly (by eliminating the degree of freedom at $x_2$).\n\nUsing only the foundational variational definition of the stiffness bilinear form $a_h(u_h,v_h)=\\sum_{K}\\int_{K\\cap\\Omega} u_h'(x)\\,v_h'(x)\\,dx$ and the definitions of the standard hat basis functions on each element, do the following:\n\n1. Assemble the unstabilized discrete stiffness matrix on the remaining two degrees of freedom (associated with $x_0$ and $x_1$), and from first principles derive its exact eigenvalues and its spectral condition number $\\kappa_{\\mathrm{unstab}}(\\varepsilon)$ as a closed-form function of $\\varepsilon$ (no dependence on $h$ should remain).\n\n2. Introduce a face-based ghost penalty (defined on the interior face at $x=h$) in the form $g_h(u_h,v_h)=\\gamma\\,h\\,[\\![u_h']\\!]_F[\\![v_h']\\!]_F$, where $[\\![\\cdot]\\!]_F$ denotes the jump across the face $F=\\{h\\}$, and $\\gamma>0$ is a stabilization parameter independent of $\\varepsilon$ and $h$. Assemble the stabilized stiffness matrix and derive its exact eigenvalues and spectral condition number $\\kappa_{\\mathrm{stab}}(\\varepsilon,\\gamma)$ as a closed-form function of $\\varepsilon$ and $\\gamma$ (no dependence on $h$ should remain).\n\n3. Show, by exact calculation from the expressions in parts $1$ and $2$, that the unstabilized condition number grows like $\\varepsilon^{-1}$ as $\\varepsilon\\to 0$, while the stabilized condition number remains bounded uniformly in $\\varepsilon$. As your final answer, report the pair of limits\n$\\lim_{\\varepsilon\\to 0}\\varepsilon\\,\\kappa_{\\mathrm{unstab}}(\\varepsilon)$ and $\\lim_{\\varepsilon\\to 0}\\kappa_{\\mathrm{stab}}(\\varepsilon,\\gamma)$\nin a single row matrix. No rounding is required, and no physical units are associated with the final answer.", "solution": "The problem is first validated against the required criteria.\n\n**Step 1: Extract Givens**\n- **Model Problem:** Scalar diffusion equation $-u''=0$.\n- **Physical Domain:** $\\Omega=((1-\\varepsilon)h, 2h)$, where $\\varepsilon \\in(0,1)$.\n- **Background Mesh:** A fixed mesh with two elements $K_1=[0,h]$ and $K_2=[h,2h]$, and nodes $x_0=0$, $x_1=h$, $x_2=2h$.\n- **Cut Condition:** $|K_1\\cap\\Omega|/|K_1| = \\varepsilon$.\n- **Boundary Conditions:** Homogeneous Neumann at $x=(1-\\varepsilon)h$ (i.e., $u'((1-\\varepsilon)h)=0$), and homogeneous Dirichlet at $x=2h$ (i.e., $u(2h)=0$).\n- **Finite Element Space:** Continuous, piecewise linear functions on the background mesh $\\{K_1, K_2\\}$, with the degree of freedom at $x_2$ eliminated to enforce the Dirichlet condition. The trial and test space is thus spanned by the hat basis functions $\\phi_0(x)$ and $\\phi_1(x)$.\n- **Unstabilized Bilinear Form:** $a_h(u_h,v_h)=\\sum_{K}\\int_{K\\cap\\Omega} u_h'(x)\\,v_h'(x)\\,dx$.\n- **Stabilization Term (Ghost Penalty):** $g_h(u_h,v_h)=\\gamma\\,h\\,[\\![u_h']\\!]_F[\\![v_h']\\!]_F$, where $F=\\{h\\}$ is the interior face, $[\\![\\cdot]\\!]_F$ is the jump operator, and $\\gamma>0$ is a constant.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is a standard, canonical example used in the mathematical analysis of the cut finite element method (CutFEM) to illustrate the ill-conditioning caused by small cut cells and its remedy via ghost penalty stabilization. All concepts (FEM, diffusion equation, stabilization) are fundamentally sound.\n- **Well-Posedness:** The problem asks for the derivation of specific, uniquely defined mathematical quantities (eigenvalues, condition numbers, limits) from a complete and consistent set of definitions. A unique solution exists.\n- **Objectivity:** The problem is stated in precise, objective mathematical language, free from ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe finite element solution $u_h$ is sought in the space $V_h = \\mathrm{span}\\{\\phi_0, \\phi_1\\}$, where $\\phi_0$ and $\\phi_1$ are the standard linear hat basis functions associated with nodes $x_0=0$ and $x_1=h$. The basis function $\\phi_2$ is excluded due to the strong imposition of the Dirichlet condition $u_h(2h)=0$.\n\nThe basis functions and their derivatives on the two background elements $K_1=[0,h]$ and $K_2=[h,2h]$ are:\n- $\\phi_0(x) = \\frac{h-x}{h}$ for $x\\in K_1$, and $0$ otherwise. Its derivative is $\\phi_0'(x) = -\\frac{1}{h}$ on $K_1$.\n- $\\phi_1(x) = \\frac{x}{h}$ for $x\\in K_1$, $\\phi_1(x) = \\frac{2h-x}{h}$ for $x\\in K_2$, and $0$ otherwise. Its derivatives are $\\phi_1'(x) = \\frac{1}{h}$ on $K_1$ and $\\phi_1'(x) = -\\frac{1}{h}$ on $K_2$.\n\nThe integration domain is $\\Omega \\cap (K_1 \\cup K_2) = ((1-\\varepsilon)h, h] \\cup [h, 2h)$.\n\n**Part 1: Unstabilized System**\n\nThe entries of the $2 \\times 2$ unstabilized stiffness matrix $A_{\\mathrm{unstab}}$ are given by $(A_{\\mathrm{unstab}})_{ij} = a_h(\\phi_{j-1}, \\phi_{i-1})$ for $i,j \\in \\{1,2\\}$.\n\n$A_{11} = a_h(\\phi_0, \\phi_0) = \\int_{(1-\\varepsilon)h}^{h} (\\phi_0'(x))^2 dx = \\int_{(1-\\varepsilon)h}^{h} \\left(-\\frac{1}{h}\\right)^2 dx = \\frac{1}{h^2} [h - (1-\\varepsilon)h] = \\frac{\\varepsilon}{h}$.\n\n$A_{12} = a_h(\\phi_1, \\phi_0) = \\int_{(1-\\varepsilon)h}^{h} \\phi_1'(x)\\phi_0'(x) dx = \\int_{(1-\\varepsilon)h}^{h} \\left(\\frac{1}{h}\\right)\\left(-\\frac{1}{h}\\right) dx = -\\frac{1}{h^2} [h - (1-\\varepsilon)h] = -\\frac{\\varepsilon}{h}$. By symmetry, $A_{21}=A_{12}$.\n\n$A_{22} = a_h(\\phi_1, \\phi_1) = \\int_{(1-\\varepsilon)h}^{h} (\\phi_1'(x))^2 dx + \\int_{h}^{2h} (\\phi_1'(x))^2 dx = \\int_{(1-\\varepsilon)h}^{h} \\left(\\frac{1}{h}\\right)^2 dx + \\int_{h}^{2h} \\left(-\\frac{1}{h}\\right)^2 dx = \\frac{\\varepsilon}{h} + \\frac{1}{h} = \\frac{1+\\varepsilon}{h}$.\n\nThe stiffness matrix is $A_{\\mathrm{unstab}} = \\frac{1}{h} \\begin{pmatrix} \\varepsilon & -\\varepsilon \\\\ -\\varepsilon & 1+\\varepsilon \\end{pmatrix}$.\nTo find the condition number independent of $h$, we analyze the matrix $\\tilde{A}_{\\mathrm{unstab}} = h A_{\\mathrm{unstab}} = \\begin{pmatrix} \\varepsilon & -\\varepsilon \\\\ -\\varepsilon & 1+\\varepsilon \\end{pmatrix}$.\nThe eigenvalues $\\lambda$ are roots of the characteristic equation $\\det(\\tilde{A}_{\\mathrm{unstab}} - \\lambda I) = 0$:\n$(\\varepsilon-\\lambda)(1+\\varepsilon-\\lambda) - (-\\varepsilon)^2 = 0 \\implies \\lambda^2 - (1+2\\varepsilon)\\lambda + \\varepsilon = 0$.\nThe solutions are $\\lambda = \\frac{(1+2\\varepsilon) \\pm \\sqrt{(1+2\\varepsilon)^2 - 4\\varepsilon}}{2} = \\frac{1+2\\varepsilon \\pm \\sqrt{1+4\\varepsilon^2}}{2}$.\nLet $\\lambda_{\\min}$ and $\\lambda_{\\max}$ be the smaller and larger eigenvalues, respectively. The spectral condition number is their ratio:\n$\\kappa_{\\mathrm{unstab}}(\\varepsilon) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{1+2\\varepsilon + \\sqrt{1+4\\varepsilon^2}}{1+2\\varepsilon - \\sqrt{1+4\\varepsilon^2}}$.\n\n**Part 2: Stabilized System**\n\nThe stabilization matrix $G$ has entries $G_{ij} = g_h(\\phi_{j-1}, \\phi_{i-1})$. First, we compute the jump of the derivatives of the basis functions at the face $F=\\{h\\}$:\n$[\\![\\phi_0']\\!]_F = \\phi_0'(h^+) - \\phi_0'(h^-) = 0 - (-\\frac{1}{h}) = \\frac{1}{h}$.\n$[\\![\\phi_1']\\!]_F = \\phi_1'(h^+) - \\phi_1'(h^-) = (-\\frac{1}{h}) - (\\frac{1}{h}) = -\\frac{2}{h}$.\n\nNow we compute the entries of $G$:\n$G_{11} = \\gamma h ([\\![\\phi_0']\\!]_F)^2 = \\gamma h (\\frac{1}{h})^2 = \\frac{\\gamma}{h}$.\n$G_{12} = \\gamma h [\\![\\phi_1']\\!]_F [\\![\\phi_0']\\!]_F = \\gamma h (-\\frac{2}{h})(\\frac{1}{h}) = -\\frac{2\\gamma}{h}$. $G_{21}=G_{12}$.\n$G_{22} = \\gamma h ([\\![\\phi_1']\\!]_F)^2 = \\gamma h (-\\frac{2}{h})^2 = \\frac{4\\gamma}{h}$.\n\nThe stabilization matrix is $G = \\frac{1}{h}\\begin{pmatrix} \\gamma & -2\\gamma \\\\ -2\\gamma & 4\\gamma \\end{pmatrix}$.\nThe stabilized stiffness matrix is $A_{\\mathrm{stab}} = A_{\\mathrm{unstab}} + G = \\frac{1}{h} \\begin{pmatrix} \\varepsilon+\\gamma & -(\\varepsilon+2\\gamma) \\\\ -(\\varepsilon+2\\gamma) & 1+\\varepsilon+4\\gamma \\end{pmatrix}$.\nWe find the eigenvalues of $\\tilde{A}_{\\mathrm{stab}} = h A_{\\mathrm{stab}}$. The characteristic equation is $\\lambda^2 - \\text{tr}(\\tilde{A}_{\\mathrm{stab}})\\lambda + \\det(\\tilde{A}_{\\mathrm{stab}}) = 0$.\n$\\text{tr}(\\tilde{A}_{\\mathrm{stab}}) = (\\varepsilon+\\gamma) + (1+\\varepsilon+4\\gamma) = 1+2\\varepsilon+5\\gamma$.\n$\\det(\\tilde{A}_{\\mathrm{stab}}) = (\\varepsilon+\\gamma)(1+\\varepsilon+4\\gamma) - (\\varepsilon+2\\gamma)^2 = (\\varepsilon+\\varepsilon^2+5\\varepsilon\\gamma+\\gamma+4\\gamma^2) - (\\varepsilon^2+4\\varepsilon\\gamma+4\\gamma^2) = \\varepsilon+\\gamma+\\varepsilon\\gamma$.\nThe characteristic equation is $\\lambda^2 - (1+2\\varepsilon+5\\gamma)\\lambda + (\\varepsilon+\\gamma+\\varepsilon\\gamma) = 0$.\nThe eigenvalues are given by $\\lambda = \\frac{(1+2\\varepsilon+5\\gamma) \\pm \\sqrt{(1+2\\varepsilon+5\\gamma)^2 - 4(\\varepsilon+\\gamma+\\varepsilon\\gamma)}}{2}$.\nThe discriminant simplifies to $1+6\\gamma+25\\gamma^2+16\\varepsilon\\gamma+4\\varepsilon^2$.\nThe condition number is $\\kappa_{\\mathrm{stab}}(\\varepsilon, \\gamma) = \\frac{1+2\\varepsilon+5\\gamma + \\sqrt{1+6\\gamma+25\\gamma^2+16\\varepsilon\\gamma+4\\varepsilon^2}}{1+2\\varepsilon+5\\gamma - \\sqrt{1+6\\gamma+25\\gamma^2+16\\varepsilon\\gamma+4\\varepsilon^2}}$.\n\n**Part 3: Limiting Behavior**\n\nFirst, for the unstabilized case, we analyze the behavior as $\\varepsilon \\to 0$. We multiply the numerator and denominator of $\\kappa_{\\mathrm{unstab}}(\\varepsilon)$ by the conjugate of the denominator:\n$\\kappa_{\\mathrm{unstab}}(\\varepsilon) = \\frac{1+2\\varepsilon + \\sqrt{1+4\\varepsilon^2}}{1+2\\varepsilon - \\sqrt{1+4\\varepsilon^2}} \\cdot \\frac{1+2\\varepsilon + \\sqrt{1+4\\varepsilon^2}}{1+2\\varepsilon + \\sqrt{1+4\\varepsilon^2}} = \\frac{(1+2\\varepsilon + \\sqrt{1+4\\varepsilon^2})^2}{(1+2\\varepsilon)^2 - (1+4\\varepsilon^2)} = \\frac{(1+2\\varepsilon + \\sqrt{1+4\\varepsilon^2})^2}{1+4\\varepsilon+4\\varepsilon^2 - 1-4\\varepsilon^2} = \\frac{(1+2\\varepsilon + \\sqrt{1+4\\varepsilon^2})^2}{4\\varepsilon}$.\nThis shows that $\\kappa_{\\mathrm{unstab}}(\\varepsilon)$ grows like $\\varepsilon^{-1}$. We compute the requested limit:\n$\\lim_{\\varepsilon\\to 0} \\varepsilon\\,\\kappa_{\\mathrm{unstab}}(\\varepsilon) = \\lim_{\\varepsilon\\to 0} \\varepsilon \\frac{(1+2\\varepsilon + \\sqrt{1+4\\varepsilon^2})^2}{4\\varepsilon} = \\frac{(1+0+\\sqrt{1})^2}{4} = \\frac{2^2}{4} = 1$.\n\nSecond, for the stabilized case, we take the limit as $\\varepsilon \\to 0$:\n$\\lim_{\\varepsilon\\to 0} \\kappa_{\\mathrm{stab}}(\\varepsilon, \\gamma) = \\frac{1+5\\gamma + \\sqrt{1+6\\gamma+25\\gamma^2}}{1+5\\gamma - \\sqrt{1+6\\gamma+25\\gamma^2}}$.\nFor $\\gamma>0$, we have $(1+5\\gamma)^2 = 1+10\\gamma+25\\gamma^2 > 1+6\\gamma+25\\gamma^2$, which ensures the denominator is positive and non-zero. The limit is a finite constant that depends on $\\gamma$. This demonstrates that the condition number of the stabilized system remains bounded uniformly in $\\varepsilon$.\n\nThe two required limits are therefore $1$ and $\\frac{1+5\\gamma + \\sqrt{1+6\\gamma+25\\gamma^2}}{1+5\\gamma - \\sqrt{1+6\\gamma+25\\gamma^2}}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & \\frac{1+5\\gamma + \\sqrt{1+6\\gamma+25\\gamma^2}}{1+5\\gamma - \\sqrt{1+6\\gamma+25\\gamma^2}}\n\\end{pmatrix}\n}\n$$", "id": "2551856"}, {"introduction": "With a stabilized system, we can confidently perform complex simulations, but how do we handle boundary conditions on an arbitrary cut interface? This hands-on exercise challenges you to compute the local matrix contribution from Nitsche's method, a powerful technique for weakly imposing Dirichlet conditions. By working through the calculations for a 2D element cut by a level-set function, you will sharpen your skills in handling the geometric mappings and line integrals essential for practical CutFEM implementations [@problem_id:2551924].", "problem": "Consider the scalar Poisson model with homogeneous Dirichlet boundary conditions on a smooth boundary segment cutting a background mesh, posed in the cut finite element method (CutFEM) framework. The background mesh is a Cartesian grid of bilinear quadrilateral elements obtained from the affine mapping of the reference square. On a single cut element, you will compute the contribution of the symmetric Nitsche boundary terms to the local bilinear form for a specific basis-function pair. Assume a standard ghost penalty stabilization is present in the overall method to control small cut cells, but you are not asked to compute any ghost-penalty term in this task.\n\nLet the reference element be the square with coordinates $\\{ (\\xi,\\eta) : 0 \\le \\xi \\le 1, 0 \\le \\eta \\le 1 \\}$, and let the affine element mapping be\n$$\nF(\\xi,\\eta) = (x(\\xi,\\eta),y(\\xi,\\eta)) := (2\\,\\xi,\\ 1\\,\\eta),\n$$\nso that the physical element is the rectangle $K = [0,2]\\times[0,1]$. The bilinear (first-order) Lagrange basis functions on the reference square are\n$$\nN_{1}(\\xi,\\eta)=(1-\\xi)(1-\\eta),\\quad N_{2}(\\xi,\\eta)=\\xi(1-\\eta),\\quad N_{3}(\\xi,\\eta)=(1-\\xi)\\eta,\\quad N_{4}(\\xi,\\eta)=\\xi\\eta.\n$$\nThe physical domain is defined by the level-set function\n$$\n\\phi(x,y) := x + y - \\frac{6}{5},\n$$\nwith interior $\\Omega\\cap K = \\{(x,y)\\in K: \\phi(x,y) < 0\\}$ and boundary segment $\\Gamma_{K} := \\{(x,y)\\in K: \\phi(x,y)=0\\}$ crossing $K$ along the straight line from the bottom-edge intersection point $P_{b}=(\\frac{6}{5},0)$ to the top-edge intersection point $P_{t}=(\\frac{1}{5},1)$. Take the outward unit normal to the interior $\\Omega\\cap K$ on $\\Gamma_{K}$ as\n$$\n\\boldsymbol{n} = \\frac{\\nabla \\phi}{\\lVert \\nabla \\phi\\rVert} = \\frac{(1,1)}{\\sqrt{2}}.\n$$\n\nUsing the symmetric Nitsche method for weak imposition of homogeneous Dirichlet data on $\\Gamma_{K}$, the boundary contribution to the bilinear form on $K$ for trial function $u_{h}$ and test function $v_{h}$ is defined by the sum of the consistency, symmetry, and penalty terms on $\\Gamma_{K}$ with penalty parameter $\\gamma>0$ and mesh size $h_{K}:=\\max\\{2,1\\}=2$. Starting from the standard weak form of the Poisson problem and the definition of the symmetric Nitsche method, derive the explicit expression for the single-entry local boundary contribution obtained by choosing $u_{h}=v_{h}=N_{1}\\circ F^{-1}$ on $K$. Parametrize the boundary segment $\\Gamma_{K}$ exactly, compute all line integrals in closed form, and express your final result as a simplified analytic expression that depends only on $\\gamma$. Do not approximate integrals numerically.\n\nProvide your final answer as a single closed-form analytic expression in terms of $\\gamma$. No units are required. No rounding should be performed.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains all necessary information for a unique solution. It is a standard exercise in the Cut Finite Element Method framework. We shall proceed with the derivation.\n\nThe local boundary contribution to the bilinear form for the symmetric Nitsche method for homogeneous Dirichlet conditions is given by\n$$\nB(u_h, v_h) = - \\int_{\\Gamma_K} v_h (\\nabla u_h \\cdot \\boldsymbol{n}) ds - \\int_{\\Gamma_K} u_h (\\nabla v_h \\cdot \\boldsymbol{n}) ds + \\frac{\\gamma}{h_K} \\int_{\\Gamma_K} u_h v_h ds\n$$\nwhere $\\Gamma_K$ is the portion of the boundary intersecting the element $K$, $\\boldsymbol{n}$ is the outward unit normal to the physical domain $\\Omega$, $\\gamma$ is the penalty parameter, and $h_K$ is the characteristic mesh size of the element.\n\nThe problem specifies the trial function $u_h$ and test function $v_h$ to be identical, specifically $u_h = v_h = N_1 \\circ F^{-1}$. Let us denote this function simply as $u_h$. The expression thus simplifies to:\n$$\nB(u_h, u_h) = -2 \\int_{\\Gamma_K} u_h (\\nabla u_h \\cdot \\boldsymbol{n}) ds + \\frac{\\gamma}{h_K} \\int_{\\Gamma_K} u_h^2 ds\n$$\n\nFirst, we determine the physical basis function $u_h(x,y)$ and its gradient. The affine mapping is $F(\\xi, \\eta) = (2\\xi, \\eta)$, which gives the physical coordinates $(x,y)$. The inverse mapping is $F^{-1}(x,y) = (\\frac{x}{2}, y)$, so $(\\xi, \\eta) = (\\frac{x}{2}, y)$.\nThe reference basis function is $N_1(\\xi, \\eta) = (1-\\xi)(1-\\eta)$.\nSubstituting the inverse mapping, we obtain the basis function in physical coordinates:\n$$\nu_h(x,y) = N_1\\left(\\frac{x}{2}, y\\right) = \\left(1-\\frac{x}{2}\\right)(1-y)\n$$\nThe gradient of $u_h$ in physical coordinates is\n$$\n\\nabla u_h = \\left(\\frac{\\partial u_h}{\\partial x}, \\frac{\\partial u_h}{\\partial y}\\right) = \\left(-\\frac{1}{2}(1-y), -\\left(1-\\frac{x}{2}\\right)\\right)\n$$\nThe outward unit normal vector is given as $\\boldsymbol{n} = \\frac{(1,1)}{\\sqrt{2}} = \\left(\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}\\right)$.\nThe dot product $\\nabla u_h \\cdot \\boldsymbol{n}$ is\n$$\n\\nabla u_h \\cdot \\boldsymbol{n} = \\left(-\\frac{1}{2}(1-y)\\right)\\frac{1}{\\sqrt{2}} + \\left(-\\left(1-\\frac{x}{2}\\right)\\right)\\frac{1}{\\sqrt{2}} = \\frac{1}{\\sqrt{2}}\\left(-\\frac{1}{2} + \\frac{y}{2} - 1 + \\frac{x}{2}\\right) = \\frac{1}{\\sqrt{2}}\\left(\\frac{x+y}{2} - \\frac{3}{2}\\right)\n$$\nThe integration path $\\Gamma_K$ is defined by the line segment $\\phi(x,y) = x+y-\\frac{6}{5}=0$ within the element $K$. On $\\Gamma_K$, we have $x+y=\\frac{6}{5}$. Substituting this into the expression for the dot product yields\n$$\n\\nabla u_h \\cdot \\boldsymbol{n} = \\frac{1}{\\sqrt{2}}\\left(\\frac{1}{2}\\left(\\frac{6}{5}\\right) - \\frac{3}{2}\\right) = \\frac{1}{\\sqrt{2}}\\left(\\frac{3}{5} - \\frac{3}{2}\\right) = \\frac{1}{\\sqrt{2}}\\left(\\frac{6-15}{10}\\right) = -\\frac{9}{10\\sqrt{2}}\n$$\nThis quantity is constant along the integration path $\\Gamma_K$.\n\nNext, we parametrize the boundary segment $\\Gamma_K$, which connects $P_b=(\\frac{6}{5},0)$ and $P_t=(\\frac{1}{5},1)$. A suitable parametrization is $\\boldsymbol{r}(t) = (1-t)P_b + tP_t$ for $t \\in [0,1]$.\n$$\n\\boldsymbol{r}(t) = (1-t)\\left(\\frac{6}{5}, 0\\right) + t\\left(\\frac{1}{5}, 1\\right) = \\left(\\frac{6}{5}(1-t) + \\frac{t}{5}, t\\right) = \\left(\\frac{6-6t+t}{5}, t\\right) = \\left(\\frac{6-5t}{5}, t\\right)\n$$\nAn alternative, simpler parameterization given the direction vector $P_t - P_b = (-1, 1)$ is $\\boldsymbol{r}(t) = (\\frac{6}{5}-t, t)$ for $t \\in [0,1]$. We will use this one. The differential arc length element is $ds = \\|\\boldsymbol{r}'(t)\\| dt$.\n$$\n\\boldsymbol{r}'(t) = (-1, 1) \\implies \\|\\boldsymbol{r}'(t)\\| = \\sqrt{(-1)^2 + 1^2} = \\sqrt{2}\n$$\nSo, $ds = \\sqrt{2} dt$.\n\nNow we compute the two integrals required for $B(u_h, u_h)$.\nThe first integral is $I_1 = \\int_{\\Gamma_K} u_h (\\nabla u_h \\cdot \\boldsymbol{n}) ds$. Since $\\nabla u_h \\cdot \\boldsymbol{n}$ is constant, we have:\n$$\nI_1 = \\left(-\\frac{9}{10\\sqrt{2}}\\right) \\int_{\\Gamma_K} u_h ds\n$$\nWe express $u_h$ along the path $\\boldsymbol{r}(t)$:\n$$\nu_h(\\boldsymbol{r}(t)) = \\left(1-\\frac{1}{2}\\left(\\frac{6}{5}-t\\right)\\right)(1-t) = \\left(1 - \\frac{3}{5} + \\frac{t}{2}\\right)(1-t) = \\left(\\frac{2}{5} + \\frac{t}{2}\\right)(1-t)\n$$\nThe integral of $u_h$ is\n$$\n\\int_{\\Gamma_K} u_h ds = \\int_0^1 \\left(\\frac{2}{5} + \\frac{t}{2}\\right)(1-t) (\\sqrt{2} dt) = \\sqrt{2} \\int_0^1 \\left(\\frac{2}{5} - \\frac{2}{5}t + \\frac{1}{2}t - \\frac{1}{2}t^2\\right) dt\n$$\n$$\n= \\sqrt{2} \\int_0^1 \\left(\\frac{2}{5} + \\frac{1}{10}t - \\frac{1}{2}t^2\\right) dt = \\sqrt{2} \\left[\\frac{2}{5}t + \\frac{1}{20}t^2 - \\frac{1}{6}t^3\\right]_0^1 = \\sqrt{2} \\left(\\frac{2}{5} + \\frac{1}{20} - \\frac{1}{6}\\right)\n$$\n$$\n= \\sqrt{2} \\left(\\frac{24+3-10}{60}\\right) = \\sqrt{2} \\left(\\frac{17}{60}\\right) = \\frac{17\\sqrt{2}}{60}\n$$\nSubstituting this back into the expression for $I_1$:\n$$\nI_1 = \\left(-\\frac{9}{10\\sqrt{2}}\\right) \\left(\\frac{17\\sqrt{2}}{60}\\right) = -\\frac{9 \\times 17}{10 \\times 60} = -\\frac{153}{600} = -\\frac{51}{200}\n$$\nThe second integral is $I_2 = \\int_{\\Gamma_K} u_h^2 ds$.\n$$\nu_h(t) = \\left(\\frac{2}{5} + \\frac{t}{2}\\right)(1-t) = \\frac{1}{10}(4+5t)(1-t) = \\frac{1}{10}(4+t-5t^2)\n$$\n$$\nu_h^2(t) = \\frac{1}{100}(4+t-5t^2)^2 = \\frac{1}{100}(16+t^2+25t^4+8t-40t^2-10t^3) = \\frac{1}{100}(25t^4 - 10t^3 - 39t^2 + 8t + 16)\n$$\n$$\nI_2 = \\int_0^1 u_h^2(t) (\\sqrt{2} dt) = \\frac{\\sqrt{2}}{100} \\int_0^1 (25t^4 - 10t^3 - 39t^2 + 8t + 16) dt\n$$\n$$\n= \\frac{\\sqrt{2}}{100} \\left[\\frac{25}{5}t^5 - \\frac{10}{4}t^4 - \\frac{39}{3}t^3 + \\frac{8}{2}t^2 + 16t\\right]_0^1 = \\frac{\\sqrt{2}}{100} \\left[5t^5 - \\frac{5}{2}t^4 - 13t^3 + 4t^2 + 16t\\right]_0^1\n$$\n$$\n= \\frac{\\sqrt{2}}{100} \\left(5 - \\frac{5}{2} - 13 + 4 + 16\\right) = \\frac{\\sqrt{2}}{100} \\left(12 - \\frac{5}{2}\\right) = \\frac{\\sqrt{2}}{100} \\left(\\frac{19}{2}\\right) = \\frac{19\\sqrt{2}}{200}\n$$\nFinally, we assemble the total boundary contribution. The mesh size is given as $h_K = \\max\\{2,1\\}=2$.\n$$\nB(u_h, u_h) = -2 I_1 + \\frac{\\gamma}{h_K} I_2 = -2\\left(-\\frac{51}{200}\\right) + \\frac{\\gamma}{2}\\left(\\frac{19\\sqrt{2}}{200}\\right)\n$$\n$$\n= \\frac{102}{200} + \\frac{19\\sqrt{2}}{400}\\gamma = \\frac{51}{100} + \\frac{19\\sqrt{2}}{400}\\gamma\n$$\nThis is the final simplified expression as a function of the parameter $\\gamma$.", "answer": "$$\n\\boxed{\\frac{51}{100} + \\frac{19\\sqrt{2}}{400}\\gamma}\n$$", "id": "2551924"}]}