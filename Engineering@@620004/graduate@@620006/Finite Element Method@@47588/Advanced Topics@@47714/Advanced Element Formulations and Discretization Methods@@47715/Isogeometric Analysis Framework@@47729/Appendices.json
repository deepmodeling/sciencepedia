{"hands_on_practices": [{"introduction": "A cornerstone of isogeometric analysis is its ability to seamlessly integrate with existing finite element codes. This is primarily achieved through Bézier extraction, a procedure that decomposes the global B-spline basis into a series of local Bernstein polynomial bases on each element. This practice [@problem_id:2569829] provides a foundational exercise in deriving the Bézier extraction matrix from first principles, solidifying your understanding of the crucial link between the smooth, global B-spline representation and the computationally convenient, element-wise Bézier form.", "problem": "Consider a one-dimensional isogeometric analysis (IGA) setting on the parametric domain $[0,1]$ with a quadratic ($p=2$) B-spline basis defined by the open, non-uniform knot vector $\\Xi = [0,0,0,a,1,1,1]$, where $a \\in (0,1)$. Focus on the left element $e$ associated with the parametric span $[0,a]$. Let $\\xi \\in [0,a]$ denote the parametric coordinate, and define the local affine mapping to the reference element $[0,1]$ by $t = \\xi/a$. Let $\\{B_0(t), B_1(t), B_2(t)\\}$ denote the quadratic Bernstein polynomials on $[0,1]$, where $B_0(t) = (1-t)^2$, $B_1(t) = 2t(1-t)$, and $B_2(t) = t^2$.\n\nBy definition of Bézier extraction, the element-wise restriction of the B-spline basis $\\{N_0^2(\\xi), N_1^2(\\xi), N_2^2(\\xi)\\}$ over the span $[0,a]$ can be represented as a linear combination of $\\{B_0(t), B_1(t), B_2(t)\\}$ via a $3 \\times 3$ Bézier extraction matrix $C^{e}$ such that\n$$\n\\begin{pmatrix}\nN_0^2(\\xi)\\\\\nN_1^2(\\xi)\\\\\nN_2^2(\\xi)\n\\end{pmatrix}\n= C^{e}\n\\begin{pmatrix}\nB_0(t)\\\\\nB_1(t)\\\\\nB_2(t)\n\\end{pmatrix},\n\\qquad t=\\xi/a,\\ \\xi\\in[0,a].\n$$\n\nStarting only from the Cox–de Boor recursion for B-splines and the definition of the Bernstein basis together with the affine reparameterization $t=\\xi/a$, derive $C^{e}$ for the element $[0,a]$ and then compute $\\det(C^{e})$ as a closed-form analytic expression in terms of $a$.\n\nYour final answer must be a single, closed-form expression in $a$ (no units). No numerical approximation or rounding is required.", "solution": "We begin from the fundamental definitions. The quadratic ($p=2$) B-spline basis functions $\\{N_i^2(\\xi)\\}$ are defined via the Cox–de Boor recursion. The open knot vector is $\\Xi = [\\xi_0,\\xi_1,\\xi_2,\\xi_3,\\xi_4,\\xi_5,\\xi_6]=[0,0,0,a,1,1,1]$. On the left element $[0,a]$, the nonzero B-spline basis functions are $N_0^2(\\xi)$, $N_1^2(\\xi)$, and $N_2^2(\\xi)$.\n\nWe will derive the explicit forms of these three functions on the interval $\\xi\\in[0,a]$ using the Cox–de Boor recursion, then re-express them in the Bernstein basis $\\{B_0(t),B_1(t),B_2(t)\\}$ with $t=\\xi/a$ to identify the Bézier extraction matrix $C^{e}$.\n\nStep 1: Degree-zero basis. By definition,\n- $N_i^0(\\xi)=1$ if $\\xi_i \\le \\xi < \\xi_{i+1}$ and $0$ otherwise.\nOver $\\xi\\in[0,a)$, the only nonzero degree-zero basis is $N_2^0(\\xi)=1$ on $[\\xi_2,\\xi_3)=[0,a)$; all others vanish on this interval.\n\nStep 2: Degree-one basis via Cox–de Boor. For degree one,\n$$\nN_i^1(\\xi) = \\frac{\\xi-\\xi_i}{\\xi_{i+1}-\\xi_i}N_i^0(\\xi) + \\frac{\\xi_{i+2}-\\xi}{\\xi_{i+2}-\\xi_{i+1}}N_{i+1}^0(\\xi),\n$$\nwith the convention that any term with a zero denominator is taken as zero.\n\nCompute the two relevant nonzero functions on $[0,a)$:\n\n- For $i=1$,\n$$\nN_1^1(\\xi) = \\frac{\\xi-\\xi_1}{\\xi_2-\\xi_1}N_1^0(\\xi) + \\frac{\\xi_3-\\xi}{\\xi_3-\\xi_2}N_2^0(\\xi).\n$$\nHere $\\xi_1=\\xi_2=0$ gives the first term zero by convention, while $\\xi_3=a$, $\\xi_2=0$, and $N_2^0(\\xi)=1$ on $[0,a)$. Hence\n$$\nN_1^1(\\xi) = \\frac{a-\\xi}{a}.\n$$\n\n- For $i=2$,\n$$\nN_2^1(\\xi) = \\frac{\\xi-\\xi_2}{\\xi_3-\\xi_2}N_2^0(\\xi) + \\frac{\\xi_4-\\xi}{\\xi_4-\\xi_3}N_3^0(\\xi).\n$$\nOn $[0,a)$, $N_3^0(\\xi)=0$, and with $\\xi_2=0$, $\\xi_3=a$, we obtain\n$$\nN_2^1(\\xi) = \\frac{\\xi}{a}.\n$$\n\nAll other $N_i^1(\\xi)$ vanish on $[0,a)$.\n\nStep 3: Degree-two basis via Cox–de Boor. For degree two,\n$$\nN_i^2(\\xi) = \\frac{\\xi-\\xi_i}{\\xi_{i+2}-\\xi_i}N_i^1(\\xi) + \\frac{\\xi_{i+3}-\\xi}{\\xi_{i+3}-\\xi_{i+1}}N_{i+1}^1(\\xi),\n$$\nagain with the zero-denominator convention.\n\nCompute $N_0^2(\\xi)$, $N_1^2(\\xi)$, $N_2^2(\\xi)$ on $[0,a)$:\n\n- For $i=0$,\n$$\nN_0^2(\\xi) = \\frac{\\xi-\\xi_0}{\\xi_2-\\xi_0}N_0^1(\\xi) + \\frac{\\xi_3-\\xi}{\\xi_3-\\xi_1}N_1^1(\\xi).\n$$\nHere $\\xi_0=\\xi_2=0$ makes the first term zero, and with $\\xi_3=a$, $\\xi_1=0$ we obtain\n$$\nN_0^2(\\xi) = \\frac{a-\\xi}{a}\\,N_1^1(\\xi) = \\frac{a-\\xi}{a}\\cdot \\frac{a-\\xi}{a} = \\frac{(a-\\xi)^2}{a^2}.\n$$\n\n- For $i=1$,\n$$\nN_1^2(\\xi) = \\frac{\\xi-\\xi_1}{\\xi_3-\\xi_1}N_1^1(\\xi) + \\frac{\\xi_4-\\xi}{\\xi_4-\\xi_2}N_2^1(\\xi).\n$$\nUsing $\\xi_1=0$, $\\xi_3=a$, $\\xi_4=1$, $\\xi_2=0$, and the expressions from Step 2,\n$$\nN_1^2(\\xi) = \\frac{\\xi}{a}\\cdot \\frac{a-\\xi}{a} + (1-\\xi)\\cdot \\frac{\\xi}{a} = \\frac{\\xi(a-\\xi)}{a^2} + \\frac{\\xi(1-\\xi)}{a}.\n$$\n\n- For $i=2$,\n$$\nN_2^2(\\xi) = \\frac{\\xi-\\xi_2}{\\xi_4-\\xi_2}N_2^1(\\xi) + \\frac{\\xi_5-\\xi}{\\xi_5-\\xi_3}N_3^1(\\xi).\n$$\nOn $[0,a)$, $N_3^1(\\xi)=0$, and with $\\xi_2=0$, $\\xi_4=1$,\n$$\nN_2^2(\\xi) = \\xi \\cdot \\frac{\\xi}{a} = \\frac{\\xi^2}{a}.\n$$\n\nStep 4: Reparameterize to the reference element and express in the Bernstein basis. Set $t=\\xi/a$, so $\\xi = a t$ and $t\\in[0,1]$. Substitute:\n\n- $N_0^2(\\xi) = \\dfrac{(a-\\xi)^2}{a^2} = \\dfrac{(a-a t)^2}{a^2} = (1-t)^2 = B_0(t).$\n\n- $N_1^2(\\xi) = \\dfrac{\\xi(a-\\xi)}{a^2} + \\dfrac{\\xi(1-\\xi)}{a} = t(1-t) + t(1-a t) = 2t - (1+a)t^2.$\n\n- $N_2^2(\\xi) = \\dfrac{\\xi^2}{a} = \\dfrac{a^2 t^2}{a} = a\\,t^2 = a\\,B_2(t).$\n\nNow express $N_1^2(\\xi)$ in the Bernstein basis $\\{B_0(t),(B_1(t),B_2(t)\\}$, where\n$$\nB_0(t)=(1-t)^2=1-2t+t^2,\\quad B_1(t)=2t(1-t)=2t-2t^2,\\quad B_2(t)=t^2.\n$$\nSeek coefficients $c_0,c_1,c_2$ with\n$$\nN_1^2(\\xi) = c_0 B_0(t) + c_1 B_1(t) + c_2 B_2(t).\n$$\nMatch coefficients in powers of $t$. The left-hand side is $2t-(1+a)t^2$, which has zero constant term, hence $c_0=0$. The $t$-coefficient gives $2c_1 = 2$, so $c_1=1$. The $t^2$-coefficient yields $(-2)c_1 + c_2 = -(1+a)$, i.e., $-2 + c_2 = -(1+a)$, so $c_2 = 1 - a$.\n\nTherefore, on the element $[0,a]$ we have\n$$\n\\begin{aligned}\nN_0^2(\\xi) &= 1\\cdot B_0(t) + 0\\cdot B_1(t) + 0\\cdot B_2(t),\\\\\nN_1^2(\\xi) &= 0\\cdot B_0(t) + 1\\cdot B_1(t) + (1-a)\\cdot B_2(t),\\\\\nN_2^2(\\xi) &= 0\\cdot B_0(t) + 0\\cdot B_1(t) + a\\cdot B_2(t).\n\\end{aligned}\n$$\n\nHence the Bézier extraction matrix $C^{e}$ satisfying\n$$\n\\begin{pmatrix}\nN_0^2(\\xi)\\\\\nN_1^2(\\xi)\\\\\nN_2^2(\\xi)\n\\end{pmatrix}\n= C^{e}\n\\begin{pmatrix}\nB_0(t)\\\\\nB_1(t)\\\\\nB_2(t)\n\\end{pmatrix}\n$$\nis\n$$\nC^{e} =\n\\begin{pmatrix}\n1 & 0 & 0\\\\\n0 & 1 & 1-a\\\\\n0 & 0 & a\n\\end{pmatrix}.\n$$\n\nThis is an upper triangular matrix, so its determinant is the product of its diagonal entries:\n$$\n\\det(C^{e}) = 1 \\cdot 1 \\cdot a = a.\n$$\n\nThus, the determinant of the Bézier extraction matrix for the left element $[0,a]$ is $a$.", "answer": "$$\\boxed{a}$$", "id": "2569829"}, {"introduction": "Moving from the abstract basis functions to physical application, this exercise [@problem_id:2555182] delves into the \"isogeometric\" concept by using Non-Uniform Rational B-Splines (NURBS) to define a curved geometry. You will construct the element mapping and compute the Jacobian, which is the geometric scaling factor essential for transforming integrals from the simple parent element domain to the complex physical domain. This practice builds critical skills for handling the non-affine geometries that are a hallmark of IGA's power.", "problem": "Consider a one-dimensional isogeometric element induced by a quadratic Non-Uniform Rational B-Splines (NURBS) curve of degree $p=2$ with the open knot vector $\\{0,0,0,\\tfrac{1}{2},1,1,1\\}$, control points $\\mathbf{P}_0=(0,0)$, $\\mathbf{P}_1=(1,2)$, $\\mathbf{P}_2=(3,2)$, $\\mathbf{P}_3=(4,0)$, and weights $w_0=1$, $w_1=2$, $w_2=1$, $w_3=1$. Focus on the first element corresponding to the parametric knot span $[0,\\tfrac{1}{2}]$, and use a parent-element coordinate $s \\in [-1,1]$ mapped linearly onto this span.\n\nStarting only from the definitions of B-spline basis functions, the construction of rational basis functions via weights, and the isoparametric mapping used in isogeometric analysis, perform the following:\n\n- Construct the quadratic B-spline basis functions active on the first span and their first derivatives with respect to the curve parameter.\n- Construct the corresponding quadratic NURBS curve on the first span and the isogeometric element mapping $\\mathbf{x}(s)$ obtained by composing the NURBS curve with the linear map from $s$ to the curve parameter.\n- Using the definition of the scalar Jacobian for a one-dimensional mapping, $J(s) = \\|\\mathrm{d}\\mathbf{x}/\\mathrm{d}s\\|$, compute $J(s)$ and its first derivative with respect to $s$ at the parent Gauss point $s=0$.\n\nFinally, report the exact closed-form expression for $J(0)$. Use the same length units as the control point coordinates; do not attach units in your final boxed answer.", "solution": "The goal is to construct the element mapping for a quadratic Non-Uniform Rational B-Splines (NURBS) curve and evaluate the scalar Jacobian $J(s)=\\|\\mathrm{d}\\mathbf{x}/\\mathrm{d}s\\|$ at $s=0$. We start from the foundational definitions: the Cox–de Boor recursion for B-spline basis functions, the rationalization that defines NURBS basis functions, and the standard isoparametric parent-to-parameter mapping on an element.\n\nData: degree $p=2$, knot vector $\\{0,0,0,\\tfrac{1}{2},1,1,1\\}$, control points $\\mathbf{P}_0=(0,0)$, $\\mathbf{P}_1=(1,2)$, $\\mathbf{P}_2=(3,2)$, $\\mathbf{P}_3=(4,0)$, weights $w_0=1$, $w_1=2$, $w_2=1$, $w_3=1$.\n\nOn the first knot span $[0,\\tfrac{1}{2})$, only the three quadratic B-spline basis functions $N_{0,2}$, $N_{1,2}$, $N_{2,2}$ are nonzero. Using the Cox–de Boor recursion and the given knot vector, one obtains on $u \\in [0,\\tfrac{1}{2})$:\n- $N_{0,2}(u) = 4\\left(\\tfrac{1}{2}-u\\right)^{2} = 1 - 4u + 4u^{2}$,\n- $N_{1,2}(u) = 4u - 6u^{2}$,\n- $N_{2,2}(u) = 2u^{2}$.\n\nTheir first and second derivatives with respect to $u$ on $[0,\\tfrac{1}{2})$ are:\n- $N_{0,2}'(u) = -4 + 8u$, $N_{0,2}''(u)=8$,\n- $N_{1,2}'(u) = 4 - 12u$, $N_{1,2}''(u)=-12$,\n- $N_{2,2}'(u) = 4u$, $N_{2,2}''(u)=4$.\n\nThe rational quadratic NURBS basis functions on this span are\n$$\nR_i(u) = \\frac{w_i N_{i,2}(u)}{W(u)},\\quad W(u)=\\sum_{j=0}^{2} w_j N_{j,2}(u),\n$$\nsince $N_{3,2}(u)=0$ for $u \\in [0,\\tfrac{1}{2})$. The NURBS curve is\n$$\n\\mathbf{x}(u) = \\sum_{i=0}^{2} R_i(u)\\,\\mathbf{P}_i = \\frac{\\sum_{i=0}^{2} w_i N_{i,2}(u)\\,\\mathbf{P}_i}{W(u)}.\n$$\nDefine the homogeneous numerator\n$$\n\\mathbf{S}(u) = \\sum_{i=0}^{2} w_i N_{i,2}(u)\\,\\mathbf{P}_i = w_0 N_{0,2}(u)\\,\\mathbf{P}_0 + w_1 N_{1,2}(u)\\,\\mathbf{P}_1 + w_2 N_{2,2}(u)\\,\\mathbf{P}_2.\n$$\nSince $\\mathbf{P}_0=(0,0)$, the first term vanishes. Thus, $\\mathbf{S}(u) = 2 N_{1,2}(u)\\,\\mathbf{P}_1 + N_{2,2}(u)\\,\\mathbf{P}_2$. Then $\\mathbf{x}(u) = \\mathbf{S}(u)/W(u)$.\n\nThe first and second derivatives with respect to $u$ follow from the quotient rule:\n$$\n\\mathbf{x}'(u) = \\frac{\\mathbf{S}'(u) W(u) - \\mathbf{S}(u) W'(u)}{[W(u)]^{2}},\\qquad\n\\mathbf{x}''(u) = \\frac{\\left[\\mathbf{S}''(u) W(u) - \\mathbf{S}(u) W''(u)\\right] W(u) - 2\\left[\\mathbf{S}'(u) W(u) - \\mathbf{S}(u) W'(u)\\right] W'(u)}{[W(u)]^{3}}.\n$$\nHere,\n$$\n\\mathbf{S}'(u) = 2 N_{1,2}'(u)\\,\\mathbf{P}_1 + N_{2,2}'(u)\\,\\mathbf{P}_2,\\quad\n\\mathbf{S}''(u) = 2 N_{1,2}''(u)\\,\\mathbf{P}_1 + N_{2,2}''(u)\\,\\mathbf{P}_2,\\quad\nW'(u) = N_{0,2}'(u) + 2 N_{1,2}'(u) + N_{2,2}'(u),\\quad\nW''(u) = N_{0,2}''(u) + 2 N_{1,2}''(u) + N_{2,2}''(u).\n$$\n\nThe isogeometric element is defined by the parent coordinate $s \\in [-1,1]$ mapped linearly to $u \\in [0,\\tfrac{1}{2}]$:\n$$\nu(s) = \\frac{s+1}{4},\\quad \\frac{\\mathrm{d}u}{\\mathrm{d}s} = \\frac{1}{4},\\quad \\frac{\\mathrm{d}^{2}u}{\\mathrm{d}s^{2}}=0.\n$$\nThe physical mapping is $\\mathbf{x}(s) = \\mathbf{x}(u(s))$. By the chain rule,\n$$\n\\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}s} = \\mathbf{x}'(u)\\,\\frac{\\mathrm{d}u}{\\mathrm{d}s},\\qquad\n\\frac{\\mathrm{d}^{2}\\mathbf{x}}{\\mathrm{d}s^{2}} = \\mathbf{x}''(u)\\left(\\frac{\\mathrm{d}u}{\\mathrm{d}s}\\right)^{2},\n$$\nbecause $\\mathrm{d}^{2}u/\\mathrm{d}s^{2}=0$. The scalar Jacobian for this one-dimensional mapping is\n$$\nJ(s) = \\left\\|\\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}s}\\right\\| = \\left\\|\\mathbf{x}'\\big(u(s)\\big)\\right\\|\\,\\frac{1}{4}.\n$$\n\nWe now evaluate all quantities at the parent Gauss point $s=0$, hence $u=\\tfrac{1}{4}$.\n\nAt $u=\\tfrac{1}{4}$, evaluate the basis and derivatives:\n- $N_{0,2}\\!\\left(\\tfrac{1}{4}\\right) = 1 - 4\\cdot \\tfrac{1}{4} + 4\\cdot \\tfrac{1}{16} = \\tfrac{1}{4}$,\n- $N_{1,2}\\!\\left(\\tfrac{1}{4}\\right) = 4\\cdot \\tfrac{1}{4} - 6\\cdot \\tfrac{1}{16} = \\tfrac{5}{8}$,\n- $N_{2,2}\\!\\left(\\tfrac{1}{4}\\right) = 2\\cdot \\tfrac{1}{16} = \\tfrac{1}{8}$,\n- $N_{0,2}'\\!\\left(\\tfrac{1}{4}\\right) = -4 + 8\\cdot \\tfrac{1}{4} = -2$,\n- $N_{1,2}'\\!\\left(\\tfrac{1}{4}\\right) = 4 - 12\\cdot \\tfrac{1}{4} = 1$,\n- $N_{2,2}'\\!\\left(\\tfrac{1}{4}\\right) = 4\\cdot \\tfrac{1}{4} = 1$.\n\nCompute the weight function and its derivative:\n$$\nW\\!\\left(\\tfrac{1}{4}\\right) = w_0 N_{0,2} + w_1 N_{1,2} + w_2 N_{2,2} = 1 \\cdot \\tfrac{1}{4} + 2\\cdot \\tfrac{5}{8} + 1 \\cdot \\tfrac{1}{8} = \\tfrac{13}{8},\n$$\n$$\nW'\\!\\left(\\tfrac{1}{4}\\right) = w_0 N_{0,2}' + w_1 N_{1,2}' + w_2 N_{2,2}' = 1 \\cdot (-2) + 2\\cdot 1 + 1 \\cdot 1 = 1.\n$$\n\nCompute $\\mathbf{S}$ and $\\mathbf{S}'$:\n$$\n\\mathbf{S}\\!\\left(\\tfrac{1}{4}\\right) = 2 N_{1,2}\\,\\mathbf{P}_1 + N_{2,2}\\,\\mathbf{P}_2 = 2\\cdot \\tfrac{5}{8}(1,2) + \\tfrac{1}{8}(3,2) = \\left(\\tfrac{13}{8}, \\tfrac{11}{4}\\right),\n$$\n$$\n\\mathbf{S}'\\!\\left(\\tfrac{1}{4}\\right) = 2 N_{1,2}'\\,\\mathbf{P}_1 + N_{2,2}'\\,\\mathbf{P}_2 = 2\\cdot 1\\cdot (1,2) + 1\\cdot (3,2) = (5,6).\n$$\n\nNow form the first derivative of the curve:\n$$\n\\mathbf{x}'\\!\\left(\\tfrac{1}{4}\\right) = \\frac{\\mathbf{S}' W - \\mathbf{S} W'}{W^{2}} = \\frac{(5,6)\\cdot \\tfrac{13}{8} - \\left(\\tfrac{13}{8}, \\tfrac{11}{4}\\right)\\cdot 1}{\\left(\\tfrac{13}{8}\\right)^{2}}.\n$$\nCompute the numerator:\n$$\n(5,6)\\cdot \\tfrac{13}{8} - \\left(\\tfrac{13}{8}, \\tfrac{22}{8}\\right) = \\left(\\tfrac{65}{8}, \\tfrac{78}{8}\\right) - \\left(\\tfrac{13}{8}, \\tfrac{22}{8}\\right) = \\left(\\tfrac{52}{8}, \\tfrac{56}{8}\\right) = \\left(\\tfrac{13}{2}, 7\\right).\n$$\nDivide by $W^{2} = \\left(\\tfrac{13}{8}\\right)^{2} = \\tfrac{169}{64}$:\n$$\n\\mathbf{x}'\\!\\left(\\tfrac{1}{4}\\right) = \\left(\\tfrac{13}{2}, 7\\right)\\cdot \\frac{64}{169} = \\left(\\frac{416}{169}, \\frac{448}{169}\\right).\n$$\n\nHence, at $s=0$ (so $u=\\tfrac{1}{4}$),\n$$\n\\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}s} = \\mathbf{x}'(u)\\,\\frac{\\mathrm{d}u}{\\mathrm{d}s} = \\left(\\frac{416}{169}, \\frac{448}{169}\\right)\\cdot \\frac{1}{4} = \\left(\\frac{104}{169}, \\frac{112}{169}\\right).\n$$\nTherefore, the scalar Jacobian magnitude is\n$$\nJ(0) = \\left\\|\\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}s}\\right\\| = \\sqrt{\\left(\\frac{104}{169}\\right)^{2} + \\left(\\frac{112}{169}\\right)^{2}} = \\frac{1}{169}\\sqrt{104^{2} + 112^{2}} = \\frac{1}{169}\\sqrt{10816 + 12544} = \\frac{1}{169}\\sqrt{23360}.\n$$\nFactor $23360 = 64\\cdot 365$, so\n$$\nJ(0) = \\frac{1}{169}\\cdot 8\\sqrt{365} = \\frac{8\\sqrt{365}}{169}.\n$$\nThe requested final quantity is $J(0)$ in exact closed form. While the derivative $J'(s)$ was also computed as part of the problem statement, only the value of $J(0)$ is required for the final answer.", "answer": "$$\\boxed{\\frac{8\\sqrt{365}}{169}}$$", "id": "2555182"}, {"introduction": "One of the most powerful features of the isogeometric framework is its versatile and sophisticated approach to mesh refinement, which allows for local improvements in accuracy. This exercise [@problem_id:2572197] invites you to compare and contrast two fundamental refinement strategies: traditional h-refinement, which subdivides elements, and the more advanced k-refinement, which elevates polynomial degree. By working through both paths, you will gain a deeper appreciation for how IGA provides independent control over mesh size, basis degree, and continuity, enabling more efficient and robust simulations.", "problem": "Consider a univariate open B-spline basis used in Isogeometric Analysis (IGA) with initial open knot vector $\\Xi=(0,0,0,1,1,1)$ and polynomial degree $p=2$. The basis spans a single parametric element on $[0,1]$. You will compare two refinement paths and reason from the foundational definitions of B-splines: an open clamped knot vector has end-knot multiplicity $p+1$, the inter-element continuity across an interior knot of multiplicity $r$ is $C^{p-r}$, and the dimension of the spline space (the number of basis functions) is given by $n+1 = m - p - 1$, where $m$ is the total number of knots counted with multiplicity. Also recall that Bézier extraction partitions the parameter domain into Bézier elements coincident with unique knot spans, with $(p+1)$ Bernstein polynomials per element.\n\nPerform the following two refinement paths and fully justify each step using these definitions.\n\nPath A (h-refinement at fixed degree): Insert a single interior knot at $\\xi=0.5$ with minimal multiplicity required for a standard halving of the single element. Determine the resulting open knot vector, the inter-element continuity at $\\xi=0.5$, the number of parametric elements (unique spans), and the global dimension of the spline space. Explain how the Bézier extraction viewpoint accounts for the element count and local basis size.\n\nPath B (k-refinement): First raise the degree from $p=2$ to $p=3$ while preserving the open clamped structure. Then insert an interior knot at $\\xi=0.5$ with an integer multiplicity chosen so that the inter-element continuity at $\\xi=0.5$ matches the inter-element continuity obtained in Path A. Determine the resulting open knot vector, the inter-element continuity at $\\xi=0.5$, the number of parametric elements (unique spans), and the global dimension of the spline space. Again, explain how the Bézier extraction viewpoint accounts for the element count and local basis size.\n\nFinally, let $R$ be the ratio of the total number of basis functions after Path B to that after Path A. Provide $R$ in lowest terms as your final answer. No rounding is required, and no units are involved.", "solution": "We begin by analyzing the initial state. The given knot vector is $\\Xi_0 = (0, 0, 0, 1, 1, 1)$ with polynomial degree $p_0 = 2$. The number of knots is $m_0 = 6$. The number of basis functions, which is the dimension of the spline space, is $n_0+1 = m_0 - p_0 - 1 = 6 - 2 - 1 = 3$. The distinct knots are $0$ and $1$, defining a single knot span $[0, 1]$. This confirms there is one parametric element.\n\n**Path A: h-refinement**\n\nIn this path, we perform h-refinement by inserting a knot.\n$1$. The knot $\\xi = 0.5$ is inserted into the knot vector $\\Xi_0$. A \"standard halving\" implies splitting the element $[0, 1]$ into two new elements, $[0, 0.5]$ and $[0.5, 1]$. This is achieved by inserting the new knot with the minimal possible multiplicity, which is $r_A = 1$.\n$2$. The resulting knot vector, $\\Xi_A$, is obtained by adding $0.5$ to $\\Xi_0$ while maintaining the non-decreasing order: $\\Xi_A = (0, 0, 0, 0.5, 1, 1, 1)$. The total number of knots is now $m_A = 7$. The polynomial degree remains unchanged at $p_A = 2$.\n$3$. The inter-element continuity at the new interior knot $\\xi=0.5$ is given by the formula $C^{p_A - r_A}$. With $p_A = 2$ and multiplicity $r_A = 1$, the continuity is $C^{2-1} = C^1$.\n$4$. The number of parametric elements is determined by the number of unique non-zero knot spans. The distinct knots in $\\Xi_A$ are $0, 0.5, 1$. This creates two unique spans, $[0, 0.5]$ and $[0.5, 1]$. Thus, there are $2$ parametric elements.\n$5$. The global dimension of the new spline space is $n_A+1 = m_A - p_A - 1 = 7 - 2 - 1 = 4$. There are now $4$ basis functions.\n$6$. From the Bézier extraction perspective, the initial single element on $[0, 1]$ is now partitioned into two Bézier elements, corresponding to the knot spans $[0, 0.5]$ and $[0.5, 1]$. For a spline of degree $p_A=2$, each Bézier element is described by a local basis of $p_A+1 = 3$ Bernstein polynomials.\n\n**Path B: k-refinement**\n\nThis path involves degree elevation followed by knot insertion.\n$1$. First, the degree is raised from $p_0=2$ to $p_B=3$. To preserve the open clamped structure, the multiplicity of the end knots $0$ and $1$ must be increased to $p_B+1 = 3+1=4$. This is achieved by adding one knot at $0$ and one at $1$ to $\\Xi_0$. The knot vector after degree elevation is $\\Xi_B' = (0, 0, 0, 0, 1, 1, 1, 1)$. The number of knots becomes $m_B' = 8$. The dimension of this intermediate space is $n_B'+1 = m_B' - p_B - 1 = 8 - 3 - 1 = 4$.\n$2$. Next, we insert a knot at $\\xi=0.5$. The multiplicity, $r_B$, must be chosen such that the resulting continuity matches that of Path A, which was $C^1$. The degree for this path is $p_B = 3$. Using the continuity formula $C^{p_B-r_B}$, we set $p_B - r_B = 1$. This gives $3 - r_B = 1$, which requires a multiplicity of $r_B = 2$.\n$3$. We insert the knot $0.5$ with multiplicity $r_B=2$ into $\\Xi_B'$. The final knot vector is $\\Xi_B = (0, 0, 0, 0, 0.5, 0.5, 1, 1, 1, 1)$. The total number of knots is $m_B = 10$.\n$4$. By construction, the inter-element continuity at $\\xi=0.5$ is $C^{p_B - r_B} = C^{3-2} = C^1$.\n$5$. The unique knot spans in $\\Xi_B$ are $[0, 0.5]$ and $[0.5, 1]$, same as in Path A. Thus, there are $2$ parametric elements.\n$6$. The global dimension of the final spline space in this path is $n_B+1 = m_B - p_B - 1 = 10 - 3 - 1 = 6$. There are $6$ basis functions.\n$7$. From the Bézier extraction viewpoint, the domain is again partitioned into two Bézier elements on $[0, 0.5]$ and $[0.5, 1]$. Since the degree is now $p_B=3$, each element requires a local basis of $p_B+1 = 4$ Bernstein polynomials.\n\n**Final Calculation**\n\nThe problem asks for the ratio $R$ of the total number of basis functions after Path B to that after Path A.\nThe number of basis functions from Path A is $n_A+1 = 4$.\nThe number of basis functions from Path B is $n_B+1 = 6$.\nThe ratio $R$ is therefore:\n$$R = \\frac{n_B+1}{n_A+1} = \\frac{6}{4}$$\nIn lowest terms, this fraction is:\n$$R = \\frac{3}{2}$$", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "2572197"}]}