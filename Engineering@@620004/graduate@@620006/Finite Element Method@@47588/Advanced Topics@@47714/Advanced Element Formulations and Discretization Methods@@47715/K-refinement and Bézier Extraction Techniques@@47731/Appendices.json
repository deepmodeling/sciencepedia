{"hands_on_practices": [{"introduction": "The knot vector serves as the fundamental blueprint for a B-spline basis. This exercise provides foundational practice in decoding this blueprint to determine the essential properties of the resulting spline space, such as the order of continuity at element boundaries and the total number of basis functions. Mastering this skill is the first step toward understanding and manipulating isogeometric discretizations [@problem_id:2572161].", "problem": "In the context of the finite element method with isogeometric concepts of $k$-refinement and Bézier extraction, consider the univariate open knot vector $\\Xi=(0,0,0,0.25,0.5,0.5,0.75,1,1,1)$ and polynomial degree $p=2$. Assume that this spline space is used to construct basis functions for isogeometric analysis, and that Bézier extraction is to be applied to obtain element-level Bernstein bases.\n\nStarting from the core definitions of B-splines and knot multiplicities, determine:\n- the continuity order $C^{s}$ at each internal knot (i.e., at $0.25$, $0.5$, and $0.75$),\n- the number of elements induced by Bézier extraction (interpreted as the number of nonzero-length knot spans),\n- the dimension of the spline space $S_{p,\\Xi}$.\n\nProvide your final answer as a single row vector in the order $\\big($continuity order at $0.25$, continuity order at $0.5$, continuity order at $0.75$, number of elements, dimension of $S_{p,\\Xi}\\big)$. No rounding is required. No units are required. The final answer must be a single row vector as specified.", "solution": "The posed problem is valid as it is scientifically grounded in the mathematical theory of B-splines, which is the foundation of isogeometric analysis. It is well-posed, providing all necessary information—the knot vector and polynomial degree—to uniquely determine the required properties of the spline space. The problem is objective and formalizable. We will proceed with the solution.\n\nThe problem requires the determination of three properties for a B-spline space defined by a given knot vector and polynomial degree. Let us analyze each requirement systematically.\n\nFirst, we are given the polynomial degree $p=2$ and the open knot vector $\\Xi=(\\xi_1, \\xi_2, ..., \\xi_{10}) = (0,0,0,0.25,0.5,0.5,0.75,1,1,1)$.\n\nThe first task is to determine the continuity order, denoted as $C^s$, at each of the internal knots. The internal knots are those that lie strictly between the minimum and maximum knot values. The unique knots in $\\Xi$ are $\\hat{\\Xi}=\\{0, 0.25, 0.5, 0.75, 1\\}$. The internal knots are therefore $\\{0.25, 0.5, 0.75\\}$.\n\nThe continuity of a B-spline function at a knot $\\xi$ is determined by the multiplicity of that knot in the knot vector. If a knot $\\xi$ has multiplicity $m$, the spline basis functions are $C^{p-m}$ continuous at that knot. The continuity order $s$ is thus $s = p - m$.\n\n1.  At the knot $\\xi = 0.25$: This knot appears once in the knot vector $\\Xi$. Thus, its multiplicity is $m=1$. The continuity order $s$ at this knot is calculated as:\n    $$s_{0.25} = p - m = 2 - 1 = 1$$\n    So, the spline is $C^1$ continuous at $\\xi = 0.25$.\n\n2.  At the knot $\\xi = 0.5$: This knot appears twice in the knot vector $\\Xi$. Thus, its multiplicity is $m=2$. The continuity order $s$ at this knot is:\n    $$s_{0.5} = p - m = 2 - 2 = 0$$\n    So, the spline is $C^0$ continuous at $\\xi = 0.5$.\n\n3.  At the knot $\\xi = 0.75$: This knot appears once in the knot vector $\\Xi$. Its multiplicity is $m=1$. The continuity order $s$ at this knot is:\n    $$s_{0.75} = p - m = 2 - 1 = 1$$\n    So, the spline is $C^1$ continuous at $\\xi = 0.75$.\n\nThe second task is to determine the number of elements induced by Bézier extraction. In the context of isogeometric analysis, an \"element\" corresponds to a knot span of non-zero length. Bézier extraction is the process that yields an element-local Bernstein representation of the B-spline basis. The number of such elements is equal to the number of intervals defined by the unique knots in the knot vector.\n\nThe set of unique knots is $\\hat{\\Xi}=\\{0, 0.25, 0.5, 0.75, 1\\}$. These knots define the following knot spans (intervals) of non-zero length:\n$[0, 0.25]$, $[0.25, 0.5]$, $[0.5, 0.75]$, and $[0.75, 1]$.\nThere are $4$ such intervals. Therefore, the number of elements is $4$.\n\nThe third task is to find the dimension of the spline space $S_{p,\\Xi}$. The dimension of a B-spline space, which is equal to the number of B-spline basis functions, is given by the formula:\n$$\\text{dim}(S_{p,\\Xi}) = n = (\\text{number of knots}) - p - 1$$\nThe length of the given knot vector $\\Xi$ is $10$. The polynomial degree is $p=2$.\nSubstituting these values into the formula:\n$$\\text{dim}(S_{p,\\Xi}) = 10 - 2 - 1 = 7$$\nThus, the dimension of the spline space is $7$.\n\nFinally, we are required to present the results as a single row vector in the specified order: (continuity order at $0.25$, continuity order at $0.5$, continuity order at $0.75$, number of elements, dimension of $S_{p,\\Xi}$).\nFrom our calculations, this vector is $(1, 0, 1, 4, 7)$.", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 0 & 1 & 4 & 7 \\end{pmatrix}}$$", "id": "2572161"}, {"introduction": "Building on the ability to interpret a knot vector, we now move to the active construction of a spline space with specific, desirable characteristics. This practice introduces $k$-refinement, a powerful technique that combines degree elevation and knot insertion to engineer a basis with high-order continuity. You will see how to start from a simple representation and systematically refine it to create a cubic, $C^2$-continuous discretization, demonstrating a key advantage of isogeometric analysis [@problem_id:2572192].", "problem": "Consider a $1$D parametric domain represented by the open knot vector $\\Xi=(0,0,0,1,1,1)$ with polynomial degree $p=2$ (quadratic). You are asked to apply $k$-refinement to obtain exactly $2$ elements of uniform parametric length and to enforce interior continuity $C^{2}$ for the resulting cubic basis. Proceed as follows, starting only from core definitions of B-splines and $k$-refinement:\n\n- Use the definition of an open knot vector to characterize endpoint multiplicities for a degree-$p$ spline and how degree elevation affects them.\n- Use the relation between interior knot multiplicity $r$ and continuity $C^{p-r}$ to determine the required multiplicity at the interior knot to achieve $C^{2}$ continuity for the cubic case.\n- Use the standard counting relation between the number of knots and the number of basis functions for open B-splines to determine the new basis count after refinement.\n- Interpret the result in the context of Bézier extraction to justify that the resulting parameterization admits element-wise Bernstein polynomial representations of order $p$, without explicitly constructing any extraction matrices.\n\nPerform the following steps concretely:\n1. Elevate the degree from $p=2$ to $p=3$ while preserving the open end condition.\n2. Insert a single interior knot at $\\xi=\\frac{1}{2}$ with the minimum multiplicity needed to achieve interior continuity $C^{2}$ for the cubic basis.\n3. Determine the resulting knot vector and the total number of basis functions.\n\nExpress the final result as a row matrix where the first entry is the resulting knot vector written as a parenthesized, nondecreasing sequence, and the second entry is the basis count. No rounding is necessary, and no units are involved. Your final answer must be a single mathematical object as specified.", "solution": "The problem requires the application of $k$-refinement, which consists of degree elevation and knot insertion, to a given one-dimensional B-spline space. We will proceed by systematically applying the definitions and theorems of B-spline theory.\n\nThe initial configuration is a spline of degree $p=2$ defined by the open knot vector $\\Xi = (0, 0, 0, 1, 1, 1)$. The number of knots is $m+1 = 6$. The number of basis functions, $n$, for an open knot vector is given by the relation $n = (m+1) - p - 1$, which yields $n = 6 - 2 - 1 = 3$. The endpoint knots $0$ and $1$ have a multiplicity of $k=3$. Since this multiplicity equals $p+1$, this configuration describes a single quadratic Bézier curve over the parametric domain $[0, 1]$.\n\nThe first step is degree elevation from $p=2$ to $p'=3$. To preserve the geometry and parameterization of the spline, the degree of each polynomial segment is raised by one. This is achieved by increasing the multiplicity of every existing knot by one. The initial knot vector $\\Xi = (0, 0, 0, 1, 1, 1)$ contains the unique knots $0$ and $1$, both with multiplicity $3$. Increasing each multiplicity by $1$ results in a new knot vector $\\Xi'$ for the cubic spline:\n$$\n\\Xi' = (0, 0, 0, 0, 1, 1, 1, 1)\n$$\nThis new knot vector has $m'+1 = 8$ knots. The degree is now $p'=3$. The number of basis functions is $n' = (m'+1) - p' - 1 = 8 - 3 - 1 = 4$. The endpoint multiplicities are now $4$, which correctly satisfies the condition for an open knot vector of degree $3$ (multiplicity of $p'+1 = 3+1=4$). This space represents a single cubic Bézier curve, which is the degree-elevated form of the original quadratic.\n\nThe second step is to insert an interior knot to create two elements and achieve a specific continuity at the new interface. The problem requests two elements of uniform parametric length over the domain $[0, 1]$, which necessitates the insertion of a knot at $\\xi=1/2$. The required interior continuity for the resulting cubic basis ($p'=3$) is specified as $C^{2}$. The continuity of a B-spline at a knot is determined by the relation $C^{p-r}$, where $p$ is the polynomial degree and $r$ is the multiplicity of the knot. To achieve $C^2$ continuity with a cubic ($p'=3$) basis, we must satisfy the equation:\n$$\n2 = p' - r = 3 - r\n$$\nSolving for the required multiplicity $r$ gives $r=1$. Therefore, we must insert the knot $\\xi=1/2$ into the knot vector $\\Xi'$ with a multiplicity of $1$. Starting with $\\Xi' = (0, 0, 0, 0, 1, 1, 1, 1)$, we insert the value $1/2$ once, while maintaining the nondecreasing order of knots.\n\nThe third step is to determine the final knot vector and the corresponding number of basis functions. The insertion process yields the final knot vector $\\Xi_{final}$:\n$$\n\\Xi_{final} = (0, 0, 0, 0, \\frac{1}{2}, 1, 1, 1, 1)\n$$\nThis knot vector has a total of $m_{final}+1 = 9$ knots. With the degree being $p_{final}=p'=3$, the total number of basis functions $n_{final}$ is calculated as:\n$$\nn_{final} = (m_{final}+1) - p_{final} - 1 = 9 - 3 - 1 = 5\n$$\nSo, the final refined space consists of $5$ cubic B-spline basis functions. The unique knots are $0$, $1/2$, and $1$, which define two distinct elements (spans with non-zero length): $[0, 1/2]$ and $[1/2, 1]$.\n\nFinally, we address the interpretation in the context of Bézier extraction. The process of Bézier extraction is founded on the principle that any B-spline can be represented as a collection of Bézier segments, one for each element. This is accomplished by using knot insertion to increase the multiplicity of element-boundary knots until the continuity at these boundaries is reduced to $C^0$. For a spline of degree $p$, this requires the multiplicity of an interior knot to be $p$. Our final spline has degree $p=3$ and an interior knot $\\xi=1/2$ with multiplicity $r=1$. The continuity is $C^{3-1} = C^2$. By applying Boehm's knot insertion algorithm, we can insert the knot $\\xi=1/2$ an additional $p-r = 3-1=2$ times without altering the geometry. This would raise its multiplicity to $3$. At this point, the continuity at $\\xi=1/2$ becomes $C^{3-3}=C^0$. The resulting basis functions on the element $[0, 1/2]$ become the cubic Bernstein polynomials scaled to that interval. The same is true for the element $[1/2, 1]$. The existence of this refinement pathway, which does not change the spline, confirms that the parameterization admits an element-wise Bernstein polynomial representation of degree $p=3$. The original B-spline basis and the piecewise Bernstein basis are related by a linear transformation, the matrix of which is the Bézier extraction operator.\n\nThe final answer consists of the resulting knot vector and the total number of basis functions.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n(0, 0, 0, 0, \\frac{1}{2}, 1, 1, 1, 1) & 5\n\\end{pmatrix}\n}\n$$", "id": "2572192"}, {"introduction": "This final practice connects the geometric concepts of splines to their practical application in the finite element method. Bézier extraction provides the crucial bridge, enabling the use of an elegant, element-based assembly process that leverages the underlying Bernstein polynomial representation. By assembling a global mass matrix from first principles, this exercise demonstrates how the high-continuity of splines is efficiently handled in a computational framework, revealing the true power of isogeometric analysis for engineering simulation [@problem_id:2572110].", "problem": "Consider a one-dimensional bar occupying the parametric interval $[0,1]$. Assume a non-dimensionalized mass density times cross-sectional area equal to $1$ so that the consistent mass matrix is purely geometric. The trial space is the quadratic, $C^{1}$-continuous B-spline basis obtained by $k$-refinement on the open, uniform knot vector\n$$\\Xi = \\big[0,0,0,\\tfrac{1}{4},\\tfrac{1}{2},\\tfrac{3}{4},1,1,1\\big],$$\nwhich yields a uniform mesh of four elements of size $h=\\tfrac{1}{4}$ and $6$ global basis functions. Using Bézier extraction, carry out the following steps from first principles:\n\n1. Define the quadratic Bernstein basis $\\{B_{0}(t),B_{1}(t),B_{2}(t)\\}$ on the unit interval $t\\in[0,1]$ and the element-wise affine map $x = x_{e}(t)$ from $[0,1]$ to each element $e$ of size $h=\\tfrac{1}{4}$. Denote the Bézier extraction operator for element $e$ by $C^{(e)}\\in\\mathbb{R}^{3\\times 3}$, so that the vector of element B-spline basis functions restricted to element $e$ can be written as $N^{(e)}(t) = C^{(e)}\\,b(t)$, where $b(t) = [B_{0}(t),B_{1}(t),B_{2}(t)]^{T}$.\n\n2. Using the definition of the consistent mass matrix and the change of variables under the element map, derive an expression for the element mass matrix $M^{(e)}\\in\\mathbb{R}^{3\\times 3}$ in terms of $h$, the extraction matrix $C^{(e)}$, and the Bernstein Gram matrix $G_{B} = \\int_{0}^{1} b(t)b(t)^{T}\\,\\mathrm{d}t$.\n\n3. Compute $G_{B}$ exactly by integrating products of quadratic Bernstein polynomials on $[0,1]$.\n\n4. Assemble the global mass matrix $M\\in\\mathbb{R}^{6\\times 6}$ from the four element matrices $\\{M^{(e)}\\}_{e=1}^{4}$ using the canonical $C^{1}$ B-spline connectivity implied by $\\Xi$. Your assembly must be written explicitly in terms of $h$, $G_{B}$, and the extraction matrices $\\{C^{(e)}\\}$.\n\n5. Using only the defining properties of B-splines and Bézier extraction, verify that the assembled $M$ is symmetric and symmetric positive definite (SPD), where symmetric positive definite (SPD) means that $M^{T}=M$ and $\\mathbf{v}^{T}M\\mathbf{v}>0$ for all nonzero vectors $\\mathbf{v}$.\n\n6. Let $\\mathbf{1}\\in\\mathbb{R}^{6}$ denote the vector with all entries equal to $1$. Compute the scalar\n$$q \\;=\\; \\mathbf{1}^{T} M \\mathbf{1}.$$\nReport $q$ as an exact real number with no units.\n\nYour final answer must be the single value of $q$ only. Do not include any intermediate expressions in your final answer.", "solution": "The problem is to assemble the global consistent mass matrix for a one-dimensional bar using a $C^{1}$-continuous quadratic B-spline basis defined by a specific knot vector and then calculate the scalar quantity $q = \\mathbf{1}^{T} M \\mathbf{1}$.\n\nThis problem is valid. It is scientifically grounded in the principles of the finite element method and isogeometric analysis. It is well-posed, objective, and contains all necessary information to derive a unique solution.\n\nThe solution will be constructed by following the six steps prescribed in the problem statement.\n\nStep 1: Bernstein Basis and Element Map\n\nThe quadratic Bernstein basis functions on the unit interval $t \\in [0,1]$ are defined as:\n$$B_{0}(t) = \\binom{2}{0} (1-t)^{2}t^{0} = (1-t)^{2}$$\n$$B_{1}(t) = \\binom{2}{1} (1-t)^{1}t^{1} = 2t(1-t)$$\n$$B_{2}(t) = \\binom{2}{2} (1-t)^{0}t^{2} = t^{2}$$\nThe vector of Bernstein basis functions is $b(t) = [B_{0}(t), B_{1}(t), B_{2}(t)]^{T}$. These functions form a partition of unity, i.e., $\\sum_{i=0}^{2} B_{i}(t) = 1$.\n\nThe mesh consists of four uniform elements of size $h=\\frac{1}{4}$: $[0,\\frac{1}{4}]$, $[\\frac{1}{4},\\frac{1}{2}]$, $[\\frac{1}{2},\\frac{3}{4}]$, and $[\\frac{3}{4},1]$. The affine map from the parametric coordinate $t \\in [0,1]$ to the physical coordinate $x$ in element $e$, which spans the interval $[x_{e-1}, x_{e}]$, is given by:\n$$x_{e}(t) = x_{e-1} + (x_{e} - x_{e-1})t = (e-1)h + ht$$\nThe Jacobian of this transformation is $\\frac{\\mathrm{d}x}{\\mathrm{d}t} = h = \\frac{1}{4}$.\n\nStep 2: Element Mass Matrix Formulation\n\nThe entries of the element mass matrix $M^{(e)}$ for the basis functions active on element $e$, denoted by the vector $N^{(e)}(x)$, are given by:\n$$(M^{(e)})_{ij} = \\int_{x_{e-1}}^{x_e} N^{(e)}_i(x) N^{(e)}_j(x) \\,\\mathrm{d}x$$\nUsing the change of variables $x=x_e(t)$ and $\\mathrm{d}x = h\\,\\mathrm{d}t$, we get:\n$$M^{(e)} = \\int_{0}^{1} N^{(e)}(x_e(t)) (N^{(e)}(x_e(t)))^{T} h \\,\\mathrm{d}t$$\nUsing the Bézier extraction relation $N^{(e)}(t) = C^{(e)} b(t)$, where $C^{(e)}$ is the constant extraction operator for element $e$:\n$$M^{(e)} = h \\int_{0}^{1} (C^{(e)} b(t)) (C^{(e)} b(t))^{T} \\,\\mathrm{d}t = h \\int_{0}^{1} C^{(e)} b(t) b(t)^{T} (C^{(e)})^{T} \\,\\mathrm{d}t$$\nSince $C^{(e)}$ is constant, it can be taken out of the integral:\n$$M^{(e)} = h C^{(e)} \\left( \\int_{0}^{1} b(t) b(t)^{T} \\,\\mathrm{d}t \\right) (C^{(e)})^{T}$$\nThis gives the expression for the element mass matrix in terms of the Bernstein Gram matrix $G_{B} = \\int_{0}^{1} b(t)b(t)^{T}\\,\\mathrm{d}t$:\n$$M^{(e)} = h C^{(e)} G_{B} (C^{(e)})^{T}$$\n\nStep 3: Computation of the Bernstein Gram Matrix $G_B$\n\nThe entries of $G_{B}$ are $(G_{B})_{ij} = \\int_{0}^{1} B_{i-1}(t) B_{j-1}(t) \\,\\mathrm{d}t$. We compute the required integrals:\n$\\int_{0}^{1} B_{0}(t)^2 \\,\\mathrm{d}t = \\int_{0}^{1} (1-t)^4 \\,\\mathrm{d}t = \\frac{1}{5}$\n$\\int_{0}^{1} B_{1}(t)^2 \\,\\mathrm{d}t = \\int_{0}^{1} 4t^2(1-t)^2 \\,\\mathrm{d}t = 4 \\frac{2!2!}{5!} = \\frac{2}{15}$\n$\\int_{0}^{1} B_{2}(t)^2 \\,\\mathrm{d}t = \\int_{0}^{1} t^4 \\,\\mathrm{d}t = \\frac{1}{5}$\n$\\int_{0}^{1} B_{0}(t)B_{1}(t) \\,\\mathrm{d}t = \\int_{0}^{1} 2t(1-t)^3 \\,\\mathrm{d}t = 2 \\frac{1!3!}{5!} = \\frac{1}{10}$\n$\\int_{0}^{1} B_{0}(t)B_{2}(t) \\,\\mathrm{d}t = \\int_{0}^{1} t^2(1-t)^2 \\,\\mathrm{d}t = \\frac{2!2!}{5!} = \\frac{1}{30}$\n$\\int_{0}^{1} B_{1}(t)B_{2}(t) \\,\\mathrm{d}t = \\int_{0}^{1} 2t^3(1-t) \\,\\mathrm{d}t = 2 \\frac{3!1!}{5!} = \\frac{1}{10}$\nThe resulting Bernstein Gram matrix is:\n$$G_{B} = \\begin{pmatrix} \\frac{1}{5} & \\frac{1}{10} & \\frac{1}{30} \\\\ \\frac{1}{10} & \\frac{2}{15} & \\frac{1}{10} \\\\ \\frac{1}{30} & \\frac{1}{10} & \\frac{1}{5} \\end{pmatrix} = \\frac{1}{30} \\begin{pmatrix} 6 & 3 & 1 \\\\ 3 & 4 & 3 \\\\ 1 & 3 & 6 \\end{pmatrix}$$\n\nStep 4: Assembly of the Global Mass Matrix $M$\n\nThe knot vector $\\Xi = \\left[0,0,0,\\frac{1}{4},\\frac{1}{2},\\frac{3}{4},1,1,1\\right]$ defines $n=6$ quadratic ($p=2$) B-spline basis functions. The active basis functions on each element are:\n- Element $1 \\ [0, \\frac{1}{4}]$: $\\{N_1, N_2, N_3\\}$\n- Element $2 \\ [\\frac{1}{4}, \\frac{1}{2}]$: $\\{N_2, N_3, N_4\\}$\n- Element $3 \\ [\\frac{1}{2}, \\frac{3}{4}]$: $\\{N_3, N_4, N_5\\}$\n- Element $4 \\ [\\frac{3}{4}, 1]$: $\\{N_4, N_5, N_6\\}$\n\nThe standard Bézier extraction matrices for a uniform $C^1$-continuous quadratic spline are:\n$$C^{(1)} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & \\frac{1}{2} \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix}, \\quad C^{(2)}=C^{(3)}=C^{(\\text{int})} = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ \\frac{1}{2} & 1 & \\frac{1}{2} \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix}, \\quad C^{(4)} = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ \\frac{1}{2} & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\nWe compute the element mass matrices with $h=\\frac{1}{4}$:\n$$M^{(1)} = \\frac{1}{4} C^{(1)} G_B (C^{(1)})^{T} = \\frac{1}{240} \\begin{pmatrix} 12 & 7 & 1 \\\\ 7 & 17 & 6 \\\\ 1 & 6 & 3 \\end{pmatrix} = \\frac{1}{480} \\begin{pmatrix} 24 & 14 & 2 \\\\ 14 & 34 & 12 \\\\ 2 & 12 & 6 \\end{pmatrix}$$\n$$M^{(2)} = M^{(3)} = \\frac{1}{4} C^{(\\text{int})} G_B (C^{(\\text{int})})^{T} = \\frac{1}{480} \\begin{pmatrix} 6 & 13 & 1 \\\\ 13 & 54 & 13 \\\\ 1 & 13 & 6 \\end{pmatrix}$$\n$$M^{(4)} = \\frac{1}{4} C^{(4)} G_B (C^{(4)})^{T} = \\frac{1}{240} \\begin{pmatrix} 3 & 6 & 1 \\\\ 6 & 17 & 7 \\\\ 1 & 7 & 12 \\end{pmatrix} = \\frac{1}{480} \\begin{pmatrix} 6 & 12 & 2 \\\\ 12 & 34 & 14 \\\\ 2 & 14 & 24 \\end{pmatrix}$$\nThe global mass matrix $M \\in \\mathbb{R}^{6 \\times 6}$ is assembled by summing the element contributions based on their degrees of freedom:\n$M(1:3, 1:3) \\mathrel{+}= M^{(1)}$\n$M(2:4, 2:4) \\mathrel{+}= M^{(2)}$\n$M(3:5, 3:5) \\mathrel{+}= M^{(3)}$\n$M(4:6, 4:6) \\mathrel{+}= M^{(4)}$\nThis yields the global mass matrix:\n$$M = \\frac{1}{480} \\begin{pmatrix}\n24 & 14 & 2 & 0 & 0 & 0 \\\\\n14 & 40 & 25 & 1 & 0 & 0 \\\\\n2 & 25 & 66 & 26 & 1 & 0 \\\\\n0 & 1 & 26 & 66 & 25 & 2 \\\\\n0 & 0 & 1 & 25 & 40 & 14 \\\\\n0 & 0 & 0 & 2 & 14 & 24\n\\end{pmatrix}$$\n\nStep 5: Verification of Symmetry and Positive Definiteness\n\nSymmetry: The mass matrix is defined as $M_{ij} = \\int_{0}^{1} N_i(x)N_j(x)\\,\\mathrm{d}x$. Since scalar multiplication is commutative, $N_i(x)N_j(x) = N_j(x)N_i(x)$, which implies $M_{ij} = M_{ji}$. Thus, $M$ is symmetric by definition. Our assembled matrix is visibly symmetric.\n\nSymmetric Positive Definite (SPD): We must show that $\\mathbf{v}^{T}M\\mathbf{v}>0$ for any non-zero vector $\\mathbf{v} \\in \\mathbb{R}^6$. Let $u(x) = \\sum_{i=1}^6 v_i N_i(x)$ be a function in the B-spline space. The quadratic form is:\n$$\\mathbf{v}^{T}M\\mathbf{v} = \\sum_{i=1}^6 \\sum_{j=1}^6 v_i M_{ij} v_j = \\sum_{i=1}^6 \\sum_{j=1}^6 v_i \\left( \\int_0^1 N_i(x) N_j(x) \\,\\mathrm{d}x \\right) v_j = \\int_0^1 \\left(\\sum_{i=1}^6 v_i N_i(x)\\right)\\left(\\sum_{j=1}^6 v_j N_j(x)\\right) \\,\\mathrm{d}x = \\int_0^1 [u(x)]^2 \\,\\mathrm{d}x$$\nThe B-spline basis functions $\\{N_i(x)\\}_{i=1}^6$ are linearly independent. Thus, if $\\mathbf{v} \\neq \\mathbf{0}$, then $u(x)$ is not the zero function. Since $u(x)$ is continuous and not identically zero, its square $[u(x)]^2$ is non-negative and is strictly positive over some subinterval of $[0,1]$. Therefore, the integral $\\int_0^1 [u(x)]^2 \\,\\mathrm{d}x$ is strictly positive. This establishes that $M$ is symmetric positive definite.\n\nStep 6: Computation of $q = \\mathbf{1}^{T} M \\mathbf{1}$\n\nThe quantity $q$ can be computed by setting $\\mathbf{v} = \\mathbf{1} = [1, 1, 1, 1, 1, 1]^T$ in the quadratic form derived above. The corresponding function is $u(x) = \\sum_{i=1}^6 (1) \\cdot N_i(x)$. A fundamental property of a B-spline basis defined on an open knot vector (where the first and last knots have multiplicity $p+1$) is that the basis functions form a partition of unity over the domain. The knot vector $\\Xi$ has ends with multiplicity $3$ for degree $p=2$, so the basis functions sum to one on the domain $[0,1]$:\n$$\\sum_{i=1}^6 N_i(x) = 1, \\quad \\forall x \\in [0,1]$$\nTherefore, $u(x)=1$. The calculation for $q$ becomes trivial:\n$$q = \\mathbf{1}^{T} M \\mathbf{1} = \\int_0^1 \\left( \\sum_{i=1}^6 N_i(x) \\right)^2 \\,\\mathrm{d}x = \\int_0^1 (1)^2 \\,\\mathrm{d}x = \\int_0^1 1 \\,\\mathrm{d}x = [x]_0^1 = 1$$\nThis result can be verified by directly summing all the entries of the assembled matrix $M$:\n$$q = \\sum_{i=1}^6 \\sum_{j=1}^6 M_{ij} = \\frac{1}{480} \\left( (24+14+2) + (14+40+25+1) + \\dots \\right)$$\nSumming the row sums:\n$$q = \\frac{1}{480} (40 + 80 + 120 + 120 + 80 + 40) = \\frac{480}{480} = 1$$\nThe direct summation confirms the theoretical result.", "answer": "$$\\boxed{1}$$", "id": "2572110"}]}