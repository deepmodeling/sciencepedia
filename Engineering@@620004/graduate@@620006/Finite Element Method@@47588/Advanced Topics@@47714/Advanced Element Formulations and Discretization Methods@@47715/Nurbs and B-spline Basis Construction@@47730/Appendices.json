{"hands_on_practices": [{"introduction": "A key advantage of B-splines and NURBS in geometric modeling and isogeometric analysis is the precise control they offer over the smoothness of a curve. This smoothness is not uniform; it is dictated locally by the multiplicity of knots in the knot vector. This exercise [@problem_id:2584828] provides a direct, hands-on opportunity to master the fundamental relationship between knot multiplicity, $s$, and the resulting order of derivative continuity, $C^{p-s}$, for a spline of degree $p$.", "problem": "Consider a univariate B-spline space used in the Finite Element Method (FEM) and in Non-Uniform Rational B-Splines (NURBS) constructions, defined over a nondecreasing knot vector $U=\\{0,0,0,0.2,0.2,0.5,0.7,1,1,1\\}$ with polynomial degree $p=2$. Let the spline basis be built by the Cox窶電e Boor recursion, and let the corresponding spline (or NURBS) functions be linear combinations of these basis functions with finite control data and strictly positive weights. Starting from the Cox窶電e Boor definition and the piecewise-polynomial nature of B-splines, deduce the derivative continuity class at each unique knot as a function of the knot multiplicity and the polynomial degree. Then, for the given $U$ and $p$, compute the sequence of derivative continuity orders at the increasing sequence of unique knots $\\{0,0.2,0.5,0.7,1\\}$.\n\nProvide your final answer as a row matrix containing only the continuity orders, aligned with the order of the unique knots $\\{0,0.2,0.5,0.7,1\\}$. No rounding is required, and no units are involved.", "solution": "The problem as stated is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Knot Vector:** $U = \\{0, 0, 0, 0.2, 0.2, 0.5, 0.7, 1, 1, 1\\}$\n- **Polynomial Degree:** $p=2$\n- **Basis Definition:** Cox窶電e Boor recursion.\n- **Task 1:** Deduce the derivative continuity class at a unique knot as a function of knot multiplicity $s$ and polynomial degree $p$.\n- **Task 2:** Compute the sequence of derivative continuity orders for the unique knots $\\{0, 0.2, 0.5, 0.7, 1\\}$ using the given $U$ and $p$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is a standard problem in the theory of B-splines and NURBS, which are fundamental tools in computer-aided design, computer graphics, and isogeometric analysis (a branch of the finite element method). The provided data ($U$ and $p$) are complete and consistent for defining a B-spline space. The tasks are specific, formalizable, and admit a unique, verifiable solution based on established mathematical principles. No flaws are identified.\n\n**Verdict:** The problem is deemed valid.\n\nA B-spline is a piecewise polynomial function of degree $p$. The points where the polynomial pieces join are called knots. The smoothness of the spline at these knots is a critical property, determined by the multiplicity of the knots in the knot vector.\n\nFirst, we deduce the general rule for continuity. A spline function $S(u)$ of degree $p$ over a knot vector $U$ is defined as a linear combination of B-spline basis functions $N_{i,p}(u)$:\n$$ S(u) = \\sum_{i=0}^{n} C_i N_{i,p}(u) $$\nThe basis functions $N_{i,p}(u)$ are defined by the Cox-de Boor recursion formula:\n$$ N_{i,0}(u) = \\begin{cases} 1 & \\text{if } u_i \\le u < u_{i+1} \\\\ 0 & \\text{otherwise} \\end{cases} $$\n$$ N_{i,p}(u) = \\frac{u - u_i}{u_{i+p} - u_i} N_{i,p-1}(u) + \\frac{u_{i+p+1} - u}{u_{i+p+1} - u_{i+1}} N_{i+1,p-1}(u) $$\nA critical property of B-splines is the formula for the derivative of a basis function:\n$$ \\frac{d}{du} N_{i,p}(u) = p \\left( \\frac{N_{i,p-1}(u)}{u_{i+p} - u_i} - \\frac{N_{i+1,p-1}(u)}{u_{i+p+1} - u_{i+1}} \\right) $$\nThis equation shows that the derivative of a degree-$p$ B-spline basis function is a linear combination of two degree-$(p-1)$ basis functions. By extension, the derivative of a degree-$p$ spline function is a degree-$(p-1)$ spline function, defined on the same knot vector (up to a constant scaling factor).\n$$ S'(u) = \\sum_{i=0}^{n} C_i N'_{i,p}(u) = \\sum_{i=1}^{n} p \\frac{C_i - C_{i-1}}{u_{i+p} - u_i} N_{i,p-1}(u) $$\nRepeating this differentiation $k$ times, the $k$-th derivative of a degree-$p$ spline, $S^{(k)}(u)$, is a spline of degree $p-k$. This resulting spline is itself continuous. The continuity of $S^{(k)}(u)$ determines the continuity class of $S(u)$. Specifically, if $S^{(k)}(u)$ is continuous, then $S(u)$ is $C^k$ continuous.\n\nThe continuity of a spline of degree $q=p-k$ at a knot $\\xi$ with multiplicity $s$ must be analyzed. A spline of degree $q$ is guaranteed to be continuous across any knot, provided $q \\ge 0$. So, $S(u)$ is at least $C^{p-1}$ at a simple knot ($s=1$).\nHowever, knot multiplicity reduces continuity. A knot $\\xi$ of multiplicity $s$ provides fewer constraints on the polynomial segments that meet at $\\xi$. A degree-$p$ spline is $C^\\infty$ on any open interval $(u_i, u_{i+1})$ where $u_i < u_{i+1}$. At a knot $\\xi=u_j$, the two polynomial segments from $(u_{j-1}, u_j)$ and $(u_j, u_{j+1})$ are joined. For a simple knot ($s=1$), there are $p$ continuity conditions (the function value and its first $p-1$ derivatives must match), ensuring $C^{p-1}$ continuity. Each repetition of the knot removes one such constraint. Thus, a knot of multiplicity $s$ imposes only $(p+1)-s$ conditions on the derivatives. This implies that the function and its derivatives up to order $p-s$ are continuous.\nTherefore, a spline of degree $p$ is $C^{p-s}$ continuous at a knot of multiplicity $s$. The order of derivative continuity is $k = p-s$. A negative order $k=-1$ indicates a discontinuity in the function value itself ($C^{-1}$ continuity).\n\nThis result extends directly to Non-Uniform Rational B-Splines (NURBS). A NURBS curve is the projection of a higher-dimensional non-rational B-spline curve. It is defined as:\n$$ R(u) = \\frac{\\sum_{i=0}^{n} w_i P_i N_{i,p}(u)}{\\sum_{i=0}^{n} w_i N_{i,p}(u)} $$\nwhere $w_i > 0$ are weights. The numerator is a vector-valued B-spline, and the denominator is a scalar-valued B-spline. Both are of degree $p$ and defined on the same knot vector $U$. Consequently, both have $C^{p-s}$ continuity at a knot of multiplicity $s$. Since the denominator is strictly positive over the domain of interest, the rational function $R(u)$ is also $C^{p-s}$ continuous.\n\nNow, we apply this rule to the given problem.\n- **Degree:** $p=2$.\n- **Knot Vector:** $U = \\{0, 0, 0, 0.2, 0.2, 0.5, 0.7, 1, 1, 1\\}$.\n- **Unique Knots:** $\\{0, 0.2, 0.5, 0.7, 1\\}$.\n\nWe compute the multiplicity $s$ for each unique knot and then find the continuity order $k = p-s = 2-s$.\n\n1.  **Knot $\\xi_1 = 0$**:\n    The knot $0$ appears $3$ times. Thus, its multiplicity is $s_1=3$.\n    The continuity order is $k_1 = p - s_1 = 2 - 3 = -1$. This corresponds to $C^{-1}$ continuity, meaning the function is discontinuous at $u=0$. This is expected for an open knot vector where the first knot has multiplicity $p+1 = 3$.\n\n2.  **Knot $\\xi_2 = 0.2$**:\n    The knot $0.2$ appears $2$ times. Thus, its multiplicity is $s_2=2$.\n    The continuity order is $k_2 = p - s_2 = 2 - 2 = 0$. This corresponds to $C^0$ continuity. The spline is continuous at $u=0.2$, but its first derivative is not.\n\n3.  **Knot $\\xi_3 = 0.5$**:\n    The knot $0.5$ appears $1$ time. This is a simple knot, so its multiplicity is $s_3=1$.\n    The continuity order is $k_3 = p - s_3 = 2 - 1 = 1$. This corresponds to $C^1$ continuity. The spline and its first derivative are continuous at $u=0.5$.\n\n4.  **Knot $\\xi_4 = 0.7$**:\n    The knot $0.7$ appears $1$ time. This is also a simple knot, so its multiplicity is $s_4=1$.\n    The continuity order is $k_4 = p - s_4 = 2 - 1 = 1$. This corresponds to $C^1$ continuity. The spline and its first derivative are continuous at $u=0.7$.\n\n5.  **Knot $\\xi_5 = 1$**:\n    The knot $1$ appears $3$ times. Thus, its multiplicity is $s_5=3$.\n    The continuity order is $k_5 = p - s_5 = 2 - 3 = -1$. This corresponds to $C^{-1}$ continuity. The function is discontinuous at $u=1$, as expected for the end of the parametric domain with a knot of multiplicity $p+1$.\n\nThe sequence of derivative continuity orders corresponding to the unique knots $\\{0, 0.2, 0.5, 0.7, 1\\}$ is $\\{-1, 0, 1, 1, -1\\}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1 & 0 & 1 & 1 & -1\n\\end{pmatrix}\n}\n$$", "id": "2584828"}, {"introduction": "Building upon the analysis of spline continuity, this practice challenges you to engage in the inverse problem: design. Instead of deducing continuity from a given knot vector, you will construct a knot vector that enforces predetermined smoothness conditions at specific locations [@problem_id:2584870]. This exercise is central to the practical art of geometric design, where models must be built to meet specific engineering and manufacturing constraints.", "problem": "Consider a univariate Non-Uniform Rational B-Splines (NURBS) curve whose scalar B-spline basis functions are built on an open (clamped), nondecreasing knot vector over the parametric domain $\\left[0,1\\right]$. The polynomial degree is $p=4$. You are tasked with imposing distinct smoothness requirements at two interior parameter locations: enforce $C^{1}$ continuity at $\\xi=a$ and $C^{0}$ continuity at $\\xi=b$, where $0<a<b<1$. \n\nUsing only the Cox窶電e Boor recursive definition of B-spline basis functions, the concept of knot multiplicity, and the piecewise polynomial structure of B-splines, first deduce the interior knot multiplicities needed at $\\xi=a$ and $\\xi=b$ to produce the stated continuities. Then, construct the shortest open, clamped knot vector that:\n- has the parametric domain $\\left[0,1\\right]$,\n- uses only the two interior parameter values $\\xi=a$ and $\\xi=b$ as interior knots (no other interior values),\n- achieves $C^{1}$ continuity at $\\xi=a$ and $C^{0}$ continuity at $\\xi=b$,\n- and is nondecreasing.\n\nFinally, specialize to the concrete values $a=\\tfrac{1}{4}$ and $b=\\tfrac{3}{4}$, and provide the resulting knot vector as a single row matrix. No rounding is required. The final answer must be presented as a single row matrix expression.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extracted Givens**\n-   The object is a univariate Non-Uniform Rational B-Splines (NURBS) curve.\n-   The basis functions are scalar B-spline basis functions.\n-   The knot vector is open (clamped) and nondecreasing.\n-   The parametric domain is $\\left[0,1\\right]$.\n-   The polynomial degree is $p=4$.\n-   A continuity of $C^{1}$ is required at the interior parameter location $\\xi=a$.\n-   A continuity of $C^{0}$ is required at the interior parameter location $\\xi=b$.\n-   Constraints on interior knots are $0<a<b<1$.\n-   The only interior knots to be used are at $\\xi=a$ and $\\xi=b$.\n-   The task is to deduce the interior knot multiplicities and construct the shortest possible knot vector satisfying these conditions.\n-   The methodology is restricted to the use of the Cox窶電e Boor recursive definition, the concept of knot multiplicity, and the piecewise polynomial structure of B-splines.\n-   Finally, the knot vector must be provided for the specific values $a=\\tfrac{1}{4}$ and $b=\\tfrac{3}{4}$.\n\n**Step 2: Validation Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is a standard exercise in the theory of B-splines, a core topic in computational geometry and isogeometric analysis. All terms are well-defined, and the constraints are consistent and sufficient to determine a unique, meaningful solution for the shortest knot vector. The problem statement contains no scientific or factual unsoundness, is not metaphorical, is complete, and is not trivial.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be constructed.\n\nWe begin by recalling the fundamental relationship between the continuity of a B-spline curve of degree $p$ at a knot and the multiplicity of that knot. For a B-spline curve defined on a knot vector $\\Xi$, if an interior knot $\\xi_i$ has a multiplicity of $k$ (i.e., it appears $k$ times consecutively in the knot vector), then the curve is at most $C^{p-k}$ continuous at that parameter value $\\xi_i$. The curve generically possesses $C^{p-1}$ continuity at any simple knot (where $k=1$).\n\nThe problem requires us to enforce specific continuity levels at two distinct interior locations, $\\xi=a$ and $\\xi=b$, for a B-spline of polynomial degree $p=4$.\n\nFirst, consider the continuity requirement at $\\xi=a$. We must enforce $C^{1}$ continuity. Let the multiplicity of the knot at $\\xi=a$ be $k_a$. Applying the continuity formula:\n$$\nC^{p-k_a} = C^{1}\n$$\nGiven the degree $p=4$, we have:\n$$\n4 - k_a = 1\n$$\nSolving for $k_a$ yields the required multiplicity at $\\xi=a$:\n$$\nk_a = 4 - 1 = 3\n$$\nThus, to achieve exactly $C^{1}$ continuity at $\\xi=a$, the knot value $a$ must be repeated $3$ times in the knot vector.\n\nSecond, consider the continuity requirement at $\\xi=b$. We must enforce $C^{0}$ continuity. Let the multiplicity of the knot at $\\xi=b$ be $k_b$. Applying the continuity formula again:\n$$\nC^{p-k_b} = C^{0}\n$$\nWith $p=4$, we have:\n$$\n4 - k_b = 0\n$$\nSolving for $k_b$ yields the required multiplicity at $\\xi=b$:\n$$\nk_b = 4 - 0 = 4\n$$\nTherefore, to achieve $C^{0}$ continuity at $\\xi=b$, the knot value $b$ must be repeated $4$ times in the knot vector.\n\nNow, we construct the shortest possible open, clamped knot vector over the domain $\\left[0,1\\right]$ that incorporates these multiplicities. An open (or clamped) knot vector for a curve of degree $p$ has the first $p+1$ knots equal to the starting parameter value and the last $p+1$ knots equal to the ending parameter value. This ensures that the B-spline curve interpolates the first and last control points.\n\nFor our case, $p=4$, and the parametric domain is $\\left[0,1\\right]$. This dictates that the knot vector must begin with $p+1=5$ knots of value $0$ and end with $p+1=5$ knots of value $1$.\n\nThe problem specifies that the only interior knots are at $\\xi=a$ and $\\xi=b$. We place the interior knots between the clamped ends, maintaining a nondecreasing sequence. The structure of the knot vector $\\Xi$ is as follows:\n1.  The first $p+1=5$ knots are $0$.\n2.  These are followed by the interior knots at $a$, with multiplicity $k_a=3$.\n3.  These are followed by the interior knots at $b$, with multiplicity $k_b=4$.\n4.  The final $p+1=5$ knots are $1$.\n\nThe condition $0 < a < b < 1$ ensures that this ordering is nondecreasing. Assembling the full knot vector, we get:\n$$\n\\Xi = \\{\\underbrace{0, 0, 0, 0, 0}_{p+1 \\text{ times}}, \\underbrace{a, a, a}_{k_a=3 \\text{ times}}, \\underbrace{b, b, b, b}_{k_b=4 \\text{ times}}, \\underbrace{1, 1, 1, 1, 1}_{p+1 \\text{ times}}\\}\n$$\n\nFinally, we specialize this general form to the concrete values provided: $a = \\frac{1}{4}$ and $b = \\frac{3}{4}$. Substituting these into the knot vector structure gives:\n$$\n\\Xi = \\left\\{0, 0, 0, 0, 0, \\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4}, \\frac{3}{4}, \\frac{3}{4}, \\frac{3}{4}, \\frac{3}{4}, 1, 1, 1, 1, 1\\right\\}\n$$\nThis is the shortest open, clamped knot vector of degree $p=4$ on $\\left[0,1\\right]$ that has $C^{1}$ continuity at $\\xi=\\frac{1}{4}$ and $C^{0}$ continuity at $\\xi=\\frac{3}{4}$, using only these two values as interior knots.\nThe total number of knots is $m+1 = 5 + 3 + 4 + 5 = 17$. The number of basis functions is $n+1 = m - p = 16 - 4 = 12$. This is a consistent and valid B-spline construction.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 & 0 & 0 & 0 & \\frac{1}{4} & \\frac{1}{4} & \\frac{1}{4} & \\frac{3}{4} & \\frac{3}{4} & \\frac{3}{4} & \\frac{3}{4} & 1 & 1 & 1 & 1 & 1 \\end{pmatrix}}\n$$", "id": "2584870"}, {"introduction": "To effectively integrate B-splines into the finite element method, we must bridge the global nature of spline basis functions with the element-local structure of FEM. The technique of Bﾃｩzier extraction, explored in this exercise [@problem_id:2584863], provides this crucial link. You will derive the transformation that expresses the B-spline basis in terms of a local Bernstein-Bﾃｩzier basis, a foundational procedure in isogeometric analysis that facilitates standard element-level integration and assembly.", "problem": "Consider the open, clamped cubic B-spline (degree $p=3$) defined on the knot vector $\\boldsymbol{U} = [\\,0,\\,0,\\,0,\\,0,\\,0.25,\\,0.5,\\,0.75,\\,1,\\,1,\\,1,\\,1\\,]$ with simple interior knots. In isogeometric finite element analysis, element-level Bernstein窶釘ﾃｩzier representations are constructed via Bﾃｩzier extraction to interface spline bases with standard finite element assembly. Focus on the second element (the span $[\\,0.25,\\,0.5\\,]$), and let the local nonzero B-spline basis functions on this element be $\\{N_{1,3}, N_{2,3}, N_{3,3}, N_{4,3}\\}$ (global indices relative to $\\boldsymbol{U}$).\n\nDefine the element-local affine coordinate $s \\in [\\,0,1\\,]$ by $u = 0.25 + 0.25\\,s$. Starting from the Cox窶電e Boor recursion for B-splines and the degree-$0$ functions $N_{i,0}(u)$ on $\\boldsymbol{U}$, derive the explicit polynomial forms of $N_{i,3}(u)$, $i \\in \\{1,2,3,4\\}$, restricted to the element $[\\,0.25,\\,0.5\\,]$ and expressed in $s$. Then, using the degree-$3$ Bernstein polynomials on $[\\,0,1\\,]$,\n$$\nB_{0}(s) = (1-s)^{3},\\quad B_{1}(s) = 3\\,s\\,(1-s)^{2},\\quad B_{2}(s) = 3\\,s^{2}\\,(1-s),\\quad B_{3}(s) = s^{3},\n$$\nexpress each $N_{i,3}(u(s))$ as a linear combination of $\\{B_{0},B_{1},B_{2},B_{3}\\}$ and assemble the $4 \\times 4$ Bﾃｩzier extraction matrix $C^{(e)}$ for this element, defined by\n$$\n\\begin{pmatrix}\nN_{1,3}(u(s))\\\\\nN_{2,3}(u(s))\\\\\nN_{3,3}(u(s))\\\\\nN_{4,3}(u(s))\n\\end{pmatrix}\n=\nC^{(e)}\n\\begin{pmatrix}\nB_{0}(s)\\\\\nB_{1}(s)\\\\\nB_{2}(s)\\\\\nB_{3}(s)\n\\end{pmatrix}.\n$$\n\nVerify the reconstruction by evaluating both sides at the midpoint $s = 1/2$ (i.e., $u = 0.375$), showing that the values obtained from the Cox窶電e Boor recursion match those obtained by $C^{(e)} \\boldsymbol{B}(1/2)$. As your final answer, report the exact value of $N_{3,3}(u)$ at $u = 0.375$. Provide the value as a reduced rational number. No rounding is required, and no units are involved.", "solution": "The problem requires the derivation of the Bﾃｩzier extraction matrix for a specific element of a cubic B-spline curve and the evaluation of a basis function at a particular parameter value. The problem is well-defined and mathematically sound. We proceed with the solution.\n\nThe B-spline is of degree $p=3$ and defined on the knot vector $\\boldsymbol{U} = [u_0, u_1, \\dots, u_{10}] = [0, 0, 0, 0, 0.25, 0.5, 0.75, 1, 1, 1, 1]$. We are interested in the second non-zero element, the interval $[u_4, u_5] = [0.25, 0.5]$. On this interval, the non-zero basis functions are $N_{1,3}(u)$, $N_{2,3}(u)$, $N_{3,3}(u)$, and $N_{4,3}(u)$. The local coordinate $s \\in [0, 1]$ is related to the global coordinate $u$ by the affine map $u = 0.25 + 0.25s$, which is equivalent to $s = 4u - 1$.\n\nWe use the Cox-de Boor recursion formula:\n$$N_{i,p}(u) = \\frac{u - u_i}{u_{i+p} - u_i} N_{i, p-1}(u) + \\frac{u_{i+p+1} - u}{u_{i+p+1} - u_{i+1}} N_{i+1, p-1}(u)$$\nwhere any term with a zero denominator is taken to be zero. For $p=0$, the basis functions are step functions: $N_{i,0}(u) = 1$ if $u \\in [u_i, u_{i+1})$ and $0$ otherwise. For $u \\in [0.25, 0.5)$, the only non-zero degree-$0$ basis function is $N_{4,0}(u) = 1$.\n\nWe build the basis functions up from degree $p=0$ to $p=3$. All calculations are performed for $u \\in [0.25, 0.5)$.\n\nFor $p=1$:\nThe only basis functions that are non-zero on this interval are those whose definition involves $N_{4,0}(u)$. These are $N_{3,1}(u)$ and $N_{4,1}(u)$.\n$$N_{3,1}(u) = \\frac{u-u_3}{u_4-u_3}N_{3,0}(u) + \\frac{u_5-u}{u_5-u_4}N_{4,0}(u) = 0 + \\frac{0.5-u}{0.5-0.25}(1) = \\frac{0.5-u}{0.25} = 2 - 4u$$\n$$N_{4,1}(u) = \\frac{u-u_4}{u_5-u_4}N_{4,0}(u) + \\frac{u_6-u}{u_6-u_5}N_{5,0}(u) = \\frac{u-0.25}{0.5-0.25}(1) + 0 = \\frac{u-0.25}{0.25} = 4u-1$$\nIn terms of $s$:\n$N_{3,1}(u(s)) = 2 - 4(0.25+0.25s) = 2 - (1+s) = 1-s$.\n$N_{4,1}(u(s)) = 4(0.25+0.25s) - 1 = (1+s) - 1 = s$.\n\nFor $p=2$:\nThe non-zero functions are $N_{2,2}(u)$, $N_{3,2}(u)$, and $N_{4,2}(u)$, which depend on $N_{2,1}, N_{3,1}, N_{4,1}$. On $(0.25, 0.5)$, $N_{2,1}(u)$ is zero, as its support is $[u_2, u_4] = [0, 0.25]$.\n$$N_{2,2}(u) = \\frac{u-u_2}{u_4-u_2}N_{2,1}(u) + \\frac{u_5-u}{u_5-u_3}N_{3,1}(u) = 0 + \\frac{0.5-u}{0.5-0}(2-4u) = 2(0.5-u) \\cdot 2(1-2u) = 2(1-2u)^2$$\nIn terms of $s$: $1-2u = 1 - 2(0.25+0.25s) = 1 - 0.5 - 0.5s = 0.5(1-s)$.\n$N_{2,2}(u(s)) = 2(0.5(1-s))^2 = 2 \\cdot 0.25(1-s)^2 = \\frac{1}{2}(1-s)^2$.\n\n$$N_{3,2}(u) = \\frac{u-u_3}{u_5-u_3}N_{3,1}(u) + \\frac{u_6-u}{u_6-u_4}N_{4,1}(u) = \\frac{u}{0.5}(2-4u) + \\frac{0.75-u}{0.5}(4u-1)$$\nIn terms of $s$:\n$N_{3,2}(u(s)) = \\frac{0.25(1+s)}{0.5}(1-s) + \\frac{0.75-0.25(1+s)}{0.5}(s) = \\frac{1}{2}(1+s)(1-s) + \\frac{0.5-0.25s}{0.5}s = \\frac{1}{2}(1-s^2) + (1-0.5s)s = \\frac{1}{2} - \\frac{1}{2}s^2 + s - \\frac{1}{2}s^2 = -s^2+s+\\frac{1}{2}$.\n\n$$N_{4,2}(u) = \\frac{u-u_4}{u_6-u_4}N_{4,1}(u) + \\frac{u_7-u}{u_7-u_5}N_{5,1}(u)$$\nOn $(0.25, 0.5)$, $N_{5,1}(u)$ is zero as its support is $[u_5, u_7]=[0.5, 1]$.\n$$N_{4,2}(u) = \\frac{u-0.25}{0.75-0.25}(4u-1) = \\frac{u-0.25}{0.5}(4u-1)$$\nIn terms of $s$: $N_{4,2}(u(s)) = \\frac{0.25s}{0.5}(s) = \\frac{1}{2}s^2$.\nChecking partition of unity for $p=2$: $N_{2,2}+N_{3,2}+N_{4,2} = \\frac{1}{2}(1-s)^2 + (-s^2+s+\\frac{1}{2}) + \\frac{1}{2}s^2 = \\frac{1}{2}-s+\\frac{1}{2}s^2-s^2+s+\\frac{1}{2}+\\frac{1}{2}s^2 = 1$. The calculation is correct.\n\nFor $p=3$:\nThe non-zero basis functions are $N_{1,3}, N_{2,3}, N_{3,3}, N_{4,3}$.\n$N_{1,2}(u)$ is zero on $(0.25, 0.5)$ as its support is $[u_1, u_4]=[0, 0.25]$. Therefore,\n$$N_{1,3}(u) = \\frac{u_5-u}{u_5-u_2}N_{2,2}(u) = \\frac{0.5-u}{0.5} N_{2,2}(u)$$\nIn terms of $s$: $N_{1,3}(u(s)) = \\frac{0.5-(0.25+0.25s)}{0.5} \\frac{1}{2}(1-s)^2 = \\frac{0.25-0.25s}{0.5} \\frac{1}{2}(1-s)^2 = \\frac{1}{2}(1-s)\\frac{1}{2}(1-s)^2 = \\frac{1}{4}(1-s)^3$.\n\n$$N_{2,3}(u) = \\frac{u-u_2}{u_5-u_2}N_{2,2}(u) + \\frac{u_6-u}{u_6-u_3}N_{3,2}(u) = \\frac{u}{0.5}N_{2,2}(u) + \\frac{0.75-u}{0.75}N_{3,2}(u)$$\nIn terms of $s$:\n$N_{2,3}(s) = \\frac{0.25(1+s)}{0.5}\\frac{1}{2}(1-s)^2 + \\frac{0.75-0.25(1+s)}{0.75}(-s^2+s+\\frac{1}{2})$\n$= \\frac{1}{4}(1+s)(1-s)^2 + \\frac{1-1/3(1+s)}{1}(-s^2+s+\\frac{1}{2}) = \\frac{1}{4}(1-s-s^2+s^3) + \\frac{2-s}{3}(-s^2+s+\\frac{1}{2})$\n$= \\frac{1}{4}(s^3-s^2-s+1) + \\frac{1}{3}(s^3-3s^2+1.5s+1)$\n$= s^3(\\frac{1}{4}+\\frac{1}{3}) + s^2(-\\frac{1}{4}-1) + s(-\\frac{1}{4}+\\frac{1}{2}) + (\\frac{1}{4}+\\frac{1}{3}) = \\frac{7}{12}s^3 - \\frac{5}{4}s^2 + \\frac{1}{4}s + \\frac{7}{12} = \\frac{1}{12}(7s^3 - 15s^2 + 3s + 7)$.\n\n$$N_{3,3}(u) = \\frac{u-u_3}{u_6-u_3}N_{3,2}(u) + \\frac{u_7-u}{u_7-u_4}N_{4,2}(u) = \\frac{u}{0.75}N_{3,2}(u) + \\frac{1-u}{0.75}N_{4,2}(u)$$\nIn terms of $s$:\n$N_{3,3}(s) = \\frac{0.25(1+s)}{0.75}(-s^2+s+\\frac{1}{2}) + \\frac{1-0.25(1+s)}{0.75}(\\frac{1}{2}s^2) = \\frac{1}{3}(1+s)(-s^2+s+\\frac{1}{2}) + \\frac{0.75-0.25s}{0.75}(\\frac{1}{2}s^2)$\n$= \\frac{1}{3}(-s^3+1.5s+0.5) + (1-\\frac{1}{3}s)(\\frac{1}{2}s^2) = -\\frac{1}{3}s^3+\\frac{1}{2}s+\\frac{1}{6} + \\frac{1}{2}s^2-\\frac{1}{6}s^3 = -\\frac{1}{2}s^3+\\frac{1}{2}s^2+\\frac{1}{2}s+\\frac{1}{6} = \\frac{1}{6}(-3s^3+3s^2+3s+1)$.\n\n$N_{5,2}(u)$ is zero on $(0.25, 0.5)$ as its support is $[u_5, u_8]=[0.5, 1]$.\n$$N_{4,3}(u) = \\frac{u-u_4}{u_7-u_4}N_{4,2}(u) = \\frac{u-0.25}{1-0.25} N_{4,2}(u) = \\frac{u-0.25}{0.75}N_{4,2}(u)$$\nIn terms of $s$: $N_{4,3}(s) = \\frac{0.25s}{0.75}(\\frac{1}{2}s^2) = \\frac{1}{3}s(\\frac{1}{2}s^2) = \\frac{1}{6}s^3$.\n\nThe B-spline basis functions on the element are:\n$N_{1,3}(s) = \\frac{1}{4}(1-s)^3$\n$N_{2,3}(s) = \\frac{1}{12}(7s^3 - 15s^2 + 3s + 7)$\n$N_{3,3}(s) = \\frac{1}{6}(-3s^3+3s^2+3s+1)$\n$N_{4,3}(s) = \\frac{1}{6}s^3$\nWe express these in the degree-$3$ Bernstein basis $\\{B_0, B_1, B_2, B_3\\}$ where $B_k(s) = \\binom{3}{k} s^k (1-s)^{3-k}$.\n$N_{1,3}(s) = \\frac{1}{4}B_0(s)$.\n$N_{4,3}(s) = \\frac{1}{6}B_3(s)$.\nFor $N_{2,3}(s)$ and $N_{3,3}(s)$, we find the coefficients $c_{ij}$ such that $N_{i,3}(s) = \\sum_{j=0}^3 c_{ij} B_j(s)$. This can be done by a change of basis from the monomial basis $\\{1, s, s^2, s^3\\}$ to the Bernstein basis.\nThe coefficients of $N_{i,3}$ in the monomial basis form the rows of a matrix $A_N$:\n$$A_N = \\begin{pmatrix} 1/4 & -3/4 & 3/4 & -1/4 \\\\ 7/12 & 3/12 & -15/12 & 7/12 \\\\ 1/6 & 3/6 & 3/6 & -3/6 \\\\ 0 & 0 & 0 & 1/6 \\end{pmatrix}$$\nThe transformation matrix from the monomial to Bernstein basis is $M_{P \\to B}$:\n$$M_{P \\to B} = \\begin{pmatrix} 1 & 1 & 1 & 1 \\\\ 0 & 1/3 & 2/3 & 1 \\\\ 0 & 0 & 1/3 & 1 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}$$\nThe Bﾃｩzier extraction matrix $C^{(e)}$ is given by $C^{(e)} = A_N M_{P \\to B}$.\nFirst row of $C^{(e)}$: $[\\frac{1}{4}, 0, 0, 0]$.\nFourth row of $C^{(e)}$: $[0, 0, 0, \\frac{1}{6}]$.\nSecond row: $c_{21} = \\frac{7}{12}$, $c_{22} = \\frac{7}{12} + \\frac{3}{12}\\frac{1}{3} = \\frac{8}{12} = \\frac{2}{3}$, $c_{23} = \\frac{7}{12} + \\frac{3}{12}\\frac{2}{3} - \\frac{15}{12}\\frac{1}{3} = \\frac{7+2-5}{12} = \\frac{4}{12} = \\frac{1}{3}$, $c_{24} = \\frac{7+3-15+7}{12} = \\frac{2}{12} = \\frac{1}{6}$.\nThird row: $c_{31} = \\frac{1}{6}$, $c_{32} = \\frac{1}{6} + \\frac{3}{6}\\frac{1}{3} = \\frac{2}{6} = \\frac{1}{3}$, $c_{33} = \\frac{1}{6} + \\frac{3}{6}\\frac{2}{3} + \\frac{3}{6}\\frac{1}{3} = \\frac{1+2+1}{6} = \\frac{4}{6} = \\frac{2}{3}$, $c_{34} = \\frac{1+3+3-3}{6} = \\frac{4}{6} = \\frac{2}{3}$.\nThe Bﾃｩzier extraction matrix is:\n$$C^{(e)} = \\begin{pmatrix} 1/4 & 0 & 0 & 0 \\\\ 7/12 & 2/3 & 1/3 & 1/6 \\\\ 1/6 & 1/3 & 2/3 & 2/3 \\\\ 0 & 0 & 0 & 1/6 \\end{pmatrix} = \\frac{1}{12} \\begin{pmatrix} 3 & 0 & 0 & 0 \\\\ 7 & 8 & 4 & 2 \\\\ 2 & 4 & 8 & 8 \\\\ 0 & 0 & 0 & 2 \\end{pmatrix}$$\n\nFinally, we verify the result at $s=1/2$, which corresponds to $u=0.375$.\nFirst, using de Boor's algorithm at $u=0.375$:\n$p=0$: $N_{4,0}=1$.\n$p=1$: $N_{3,1}=\\frac{0.5-0.375}{0.25}=1/2$, $N_{4,1}=\\frac{0.375-0.25}{0.25}=1/2$.\n$p=2$: $N_{2,2}=\\frac{0.5-0.375}{0.5}N_{3,1}=1/8$, $N_{3,2}=\\frac{0.375}{0.5}N_{3,1}+\\frac{0.75-0.375}{0.5}N_{4,1}=3/4$, $N_{4,2}=\\frac{0.375-0.25}{0.5}N_{4,1}=1/8$.\n$p=3$:\n$N_{1,3} = \\frac{0.5-0.375}{0.5} N_{2,2} = \\frac{1}{4}\\frac{1}{8} = \\frac{1}{32}$.\n$N_{2,3} = \\frac{0.375}{0.5}N_{2,2}+\\frac{0.75-0.375}{0.75}N_{3,2} = \\frac{3}{4}\\frac{1}{8}+\\frac{1}{2}\\frac{3}{4}=\\frac{3}{32}+\\frac{12}{32}=\\frac{15}{32}$.\n$N_{3,3} = \\frac{0.375}{0.75}N_{3,2}+\\frac{1-0.375}{0.75}N_{4,2} = \\frac{1}{2}\\frac{3}{4}+\\frac{0.625}{0.75}\\frac{1}{8}=\\frac{3}{8}+\\frac{5}{6}\\frac{1}{8} = \\frac{18+5}{48}=\\frac{23}{48}$.\n$N_{4,3} = \\frac{0.375-0.25}{0.75}N_{4,2} = \\frac{0.125}{0.75}\\frac{1}{8}=\\frac{1}{6}\\frac{1}{8}=\\frac{1}{48}$.\nThe vector of B-spline values is $\\boldsymbol{N}(1/2) = (1/32, 15/32, 23/48, 1/48)^T$.\n\nSecond, using the extraction matrix. At $s=1/2$, the Bernstein polynomials are $\\boldsymbol{B}(1/2) = (1/8, 3/8, 3/8, 1/8)^T$.\n$$C^{(e)}\\boldsymbol{B}(\\frac{1}{2}) = \\frac{1}{12} \\begin{pmatrix} 3 & 0 & 0 & 0 \\\\ 7 & 8 & 4 & 2 \\\\ 2 & 4 & 8 & 8 \\\\ 0 & 0 & 0 & 2 \\end{pmatrix} \\frac{1}{8} \\begin{pmatrix} 1 \\\\ 3 \\\\ 3 \\\\ 1 \\end{pmatrix} = \\frac{1}{96} \\begin{pmatrix} 3 \\\\ 7+24+12+2 \\\\ 2+12+24+8 \\\\ 2 \\end{pmatrix} = \\frac{1}{96} \\begin{pmatrix} 3 \\\\ 45 \\\\ 46 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 3/96 \\\\ 45/96 \\\\ 46/96 \\\\ 2/96 \\end{pmatrix} = \\begin{pmatrix} 1/32 \\\\ 15/32 \\\\ 23/48 \\\\ 1/48 \\end{pmatrix}$$\nThe results match perfectly, confirming the correctness of the derived extraction matrix. The value of $N_{3,3}(u)$ at $u=0.375$ is $23/48$.", "answer": "$$\\boxed{\\frac{23}{48}}$$", "id": "2584863"}]}