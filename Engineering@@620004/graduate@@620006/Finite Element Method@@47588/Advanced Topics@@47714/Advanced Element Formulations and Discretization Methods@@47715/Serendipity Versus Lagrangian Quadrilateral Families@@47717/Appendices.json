{"hands_on_practices": [{"introduction": "The foundation of any finite element is its set of shape functions, which interpolate the solution field across the element domain. This first exercise guides you through the process of constructing the quadratic serendipity ($S_2$) shape functions from first principles. By directly applying the Lagrange interpolation principle and nodal constraints, you will derive the explicit formulas for these functions and verify their key properties, solidifying your understanding of how these computationally efficient elements are built. [@problem_id:2594808]", "problem": "Let $\\hat K = [-1,1] \\times [-1,1]$ be the reference square with coordinates $(\\xi,\\eta)$. Consider the tensor-product quadratic Lagrangian family $Q_2(\\hat K)$ with nodes at the four vertices $(\\pm 1,\\pm 1)$, the four edge midpoints $(0,\\pm 1)$ and $(\\pm 1,0)$, and the interior node $(0,0)$. The serendipity quadratic family $S_2(\\hat K)$ uses the same eight boundary nodes but omits the interior node, and its polynomial space is the set of all polynomials in $\\xi$ and $\\eta$ whose superlinear degree is at most two.\n\nUsing only the finite element triple definition $(\\hat K, \\mathcal{P}, \\mathcal{N})$ (domain, polynomial space, and nodal functionals) and the Lagrange interpolation principle, derive explicit formulas in terms of $\\xi$ and $\\eta$ for the eight nodal shape functions $\\{N_i\\}_{i=1}^{8} \\subset S_2(\\hat K)$ that satisfy the Kronecker property $N_i(\\xi_j,\\eta_j)=\\delta_{ij}$ at the ordered node set\n- $N_1$ at $(-1,-1)$, $N_2$ at $(1,-1)$, $N_3$ at $(1,1)$, $N_4$ at $(-1,1)$,\n- $N_5$ at $(0,-1)$, $N_6$ at $(1,0)$, $N_7$ at $(0,1)$, $N_8$ at $(-1,0)$.\n\nThen, starting from the one-dimensional quadratic Lagrange basis on $\\{-1,0,1\\}$ and the requirement that restrictions to edges reproduce this basis, verify that:\n- On each edge $\\eta=\\pm 1$ or $\\xi=\\pm 1$, the restrictions of the three shape functions associated with that edge form the univariate quadratic Lagrange basis on $\\{-1,0,1\\}$ (i.e., edge quadratics are retained).\n- The interior bubble of $Q_2(\\hat K)$, namely $\\beta(\\xi,\\eta) = (1-\\xi^2)(1-\\eta^2)$, is eliminated in $S_2(\\hat K)$ in the sense that $\\beta \\notin \\operatorname{span}\\{N_1,\\dots,N_8\\}$.\n\nExpress your final answer as the ordered octuple $(N_1,\\dots,N_8)$ corresponding to the node order listed above. No numerical rounding is required, and no physical units apply.", "solution": "We begin from the finite element definition: a Lagrange finite element on $\\hat K$ is determined by a polynomial space $\\mathcal{P}$ and nodal functionals $\\mathcal{N}=\\{\\delta_{(\\xi_i,\\eta_i)}\\}$, with shape functions $\\{N_i\\}$ defined by $N_i \\in \\mathcal{P}$ and $N_i(\\xi_j,\\eta_j)=\\delta_{ij}$. For $Q_2(\\hat K)$, the univariate quadratic Lagrange basis on the nodes $\\{-1,0,1\\}$ is given by\n$$\n\\ell_{-1}(t)=\\tfrac{1}{2}t(t-1),\\qquad \\ell_0(t)=1-t^2,\\qquad \\ell_{1}(t)=\\tfrac{1}{2}t(t+1).\n$$\nOn an edge, the two-dimensional shape functions must restrict to these one-dimensional polynomials in the appropriate edge variable. The serendipity space $S_2(\\hat K)$ of order two in two variables is the span of monomials with superlinear degree at most two, namely\n$$\n\\mathcal{P}_{\\mathrm{ser},2}=\\operatorname{span}\\{1,\\ \\xi,\\ \\eta,\\ \\xi\\eta,\\ \\xi^2,\\ \\eta^2,\\ \\xi^2\\eta,\\ \\xi\\eta^2\\},\n$$\nwhich has dimension eight and is unisolvent for the eight boundary nodes.\n\nWe construct edge-midpoint shape functions first, because their factorization is direct from the edge restriction requirement. For the midpoint on the bottom edge at $(0,-1)$, we want the restriction on $\\eta=-1$ to equal $\\ell_0(\\xi)=1-\\xi^2$ and to vanish on the other three edges. The factor $(1-\\eta)$ vanishes on $\\eta=1$ and is nonzero on $\\eta=-1$, and the factor $(1-\\xi^2)$ vanishes at $\\xi=\\pm 1$. Thus\n$$\nN_5(\\xi,\\eta)=\\tfrac{1}{2}(1-\\xi^2)(1-\\eta),\n$$\nsince $N_5(0,-1)=\\tfrac{1}{2}\\cdot 1\\cdot 2=1$ enforces the Kronecker condition at the node. By symmetry, the other edge-midpoint functions are\n$$\nN_6(\\xi,\\eta)=\\tfrac{1}{2}(1+\\xi)(1-\\eta^2),\\quad\nN_7(\\xi,\\eta)=\\tfrac{1}{2}(1-\\xi^2)(1+\\eta),\\quad\nN_8(\\xi,\\eta)=\\tfrac{1}{2}(1-\\xi)(1-\\eta^2).\n$$\nEach satisfies its own nodal conditions and vanishes at the other seven nodes. Moreover, on their corresponding edges they reduce to $\\ell_0$ in the edge variable: for example, $N_6(1,\\eta)=\\tfrac{1}{2}\\cdot 2\\cdot (1-\\eta^2)=1-\\eta^2=\\ell_0(\\eta)$, and on the other three edges at $\\xi=-1$ or $\\eta=\\pm 1$ they vanish.\n\nFor a vertex, say the bottom-left corner $(-1,-1)$, we require that on the bottom edge $\\eta=-1$, the restriction equals $\\ell_{-1}(\\xi)=\\tfrac{1}{2}\\xi(\\xi-1)$, and on the left edge $\\xi=-1$, the restriction equals $\\ell_{-1}(\\eta)=\\tfrac{1}{2}\\eta(\\eta-1)$. We seek $N_1$ in the form\n$$\nN_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)\\big(\\alpha+\\beta\\,\\xi+\\gamma\\,\\eta\\big),\n$$\nwhich lies in $S_2(\\hat K)$ because the product generates only monomials in $\\mathcal{P}_{\\mathrm{ser},2}$: expanding yields terms among $\\{1,\\xi,\\eta,\\xi\\eta,\\xi^2,\\eta^2,\\xi^2\\eta,\\xi\\eta^2\\}$, and never $\\xi^2\\eta^2$. Impose the edge restrictions:\n- On $\\eta=-1$,\n$$\nN_1(\\xi,-1)=\\tfrac{1}{4}(1-\\xi)\\cdot 2\\cdot (\\alpha+\\beta\\,\\xi-\\gamma)=\\tfrac{1}{2}(1-\\xi)\\big((\\alpha-\\gamma)+\\beta\\,\\xi\\big)\\stackrel{!}{=}\\tfrac{1}{2}\\xi(\\xi-1)=-\\tfrac{1}{2}(1-\\xi)\\xi,\n$$\nso $(\\alpha-\\gamma)+\\beta\\,\\xi=-\\xi$, which gives $\\beta=-1$ and $\\alpha-\\gamma=0$.\n- On $\\xi=-1$,\n$$\nN_1(-1,\\eta)=\\tfrac{1}{4}\\cdot 2\\cdot (1-\\eta)\\cdot (\\alpha-\\beta+\\gamma\\,\\eta)=\\tfrac{1}{2}(1-\\eta)\\big((\\alpha-\\beta)+\\gamma\\,\\eta\\big)\\stackrel{!}{=}\\tfrac{1}{2}\\eta(\\eta-1)=-\\tfrac{1}{2}(1-\\eta)\\eta,\n$$\nso $(\\alpha-\\beta)+\\gamma\\,\\eta=-\\eta$, which gives $\\gamma=-1$ and $\\alpha-\\beta=0$.\n\nCombining, $\\beta=-1$, $\\gamma=-1$, and $\\alpha=-1$. Therefore,\n$$\nN_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)\\big(-1-\\xi-\\eta\\big)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)(-\\xi-\\eta-1).\n$$\nBy symmetry, the remaining vertex functions that satisfy the corresponding edge restrictions are\n\\begin{align*}\nN_2(\\xi,\\eta)&=\\tfrac{1}{4}(1+\\xi)(1-\\eta)(\\xi-\\eta-1),\\\\\nN_3(\\xi,\\eta)&=\\tfrac{1}{4}(1+\\xi)(1+\\eta)(\\xi+\\eta-1),\\\\\nN_4(\\xi,\\eta)&=\\tfrac{1}{4}(1-\\xi)(1+\\eta)(-\\xi+\\eta-1).\n\\end{align*}\nIt is immediate to check the Kronecker property: for instance, $N_1(-1,-1)=\\tfrac{1}{4}\\cdot 2\\cdot 2\\cdot (1+1-1)=1$, and $N_1$ vanishes at the other seven nodes because at least one linear factor $(1\\pm \\xi)$ or $(1\\pm \\eta)$ or the parenthesis enforces zero at each.\n\nEdge-quadratic retention. On an edge, the three shape functions tied to that edge reduce to the univariate Lagrange basis on $\\{-1,0,1\\}$. Consider the bottom edge $\\eta=-1$. We have\n\\begin{align*}\nN_1(\\xi,-1)&=\\tfrac{1}{2}\\xi(\\xi-1)=\\ell_{-1}(\\xi),\\\\\nN_5(\\xi,-1)&=(1-\\xi^2)=\\ell_0(\\xi),\\\\\nN_2(\\xi,-1)&=\\tfrac{1}{2}\\xi(\\xi+1)=\\ell_{1}(\\xi),\n\\end{align*}\nand the other five shape functions vanish there. Analogous statements hold for the other three edges by symmetry. Hence the edge restrictions reproduce the quadratic Lagrange family along each edge.\n\nElimination of the $Q_2$ interior bubble. The $Q_2$ interior bubble is $\\beta(\\xi,\\eta)=(1-\\xi^2)(1-\\eta^2)$, which vanishes at all eight serendipity nodes but is nonzero in the interior (for example, $\\beta(0,0)=1$). Suppose, to the contrary, that $\\beta$ lies in $\\operatorname{span}\\{N_1,\\dots,N_8\\}$. Then\n$$\n\\beta=\\sum_{i=1}^{8} c_i N_i\n$$\nfor some coefficients $c_i$. Evaluating at each node $(\\xi_j,\\eta_j)$ gives $\\beta(\\xi_j,\\eta_j)=0$ for all eight nodes, but $N_i(\\xi_j,\\eta_j)=\\delta_{ij}$ by construction, so $0=\\beta(\\xi_j,\\eta_j)=c_j$ for each $j$. Therefore all $c_j=0$, implying $\\beta\\equiv 0$, a contradiction. Hence $\\beta\\notin \\operatorname{span}\\{N_1,\\dots,N_8\\}$, so the interior bubble of $Q_2(\\hat K)$ is eliminated in $S_2(\\hat K)$.\n\nCollecting the eight shape functions in the requested order gives the explicit formulas below.", "answer": "$$\\boxed{\\begin{pmatrix}\n\\tfrac{1}{4}(1-\\xi)(1-\\eta)(-\\xi-\\eta-1) & \\tfrac{1}{4}(1+\\xi)(1-\\eta)(\\xi-\\eta-1) & \\tfrac{1}{4}(1+\\xi)(1+\\eta)(\\xi+\\eta-1) & \\tfrac{1}{4}(1-\\xi)(1+\\eta)(-\\xi+\\eta-1) & \\tfrac{1}{2}(1-\\xi^2)(1-\\eta) & \\tfrac{1}{2}(1+\\xi)(1-\\eta^2) & \\tfrac{1}{2}(1-\\xi^2)(1+\\eta) & \\tfrac{1}{2}(1-\\xi)(1-\\eta^2)\n\\end{pmatrix}}$$", "id": "2594808"}, {"introduction": "After constructing the serendipity shape functions, a critical next step is to understand precisely what distinguishes their polynomial space from that of the fuller tensor-product Lagrangian ($Q_2$) family. This practice provides deep insight into this distinction by focusing on the highest-order monomial, $\\xi^2\\eta^2$. By performing a unique decomposition of this term, you will quantitatively isolate the \"bubble\" function that $S_2$ elements omit, clarifying how they achieve a reduced number of degrees of freedom. [@problem_id:2594813]", "problem": "Let $\\hat K=[-1,1]^{2}$ with coordinates $(\\xi,\\eta)$ denote the reference quadrilateral. Let $\\mathcal{Q}_{2}(\\hat K)$ be the space of polynomials of separate degree at most $2$ in each variable, and let the quadratic serendipity space $\\mathcal{S}_{2}(\\hat K)$ be defined by the superlinear-degree characterization: a monomial $\\xi^{a}\\eta^{b}$ belongs to $\\mathcal{S}_{r}(\\hat K)$ if and only if the sum of exponents that are at least $2$ is at most $r$. Equivalently, $\\mathcal{S}_{2}(\\hat K)$ is the $8$-dimensional subspace of $\\mathcal{Q}_{2}(\\hat K)$ whose traces on $\\partial\\hat K$ coincide with those of $\\mathcal{Q}_{2}(\\hat K)$, and which omits the interior bubble mode.\n\nDefine the quadratic bubble $b(\\xi,\\eta)=(1-\\xi^{2})(1-\\eta^{2})$. It is known that any $p\\in \\mathcal{Q}_{2}(\\hat K)$ admits a unique decomposition $p=\\alpha\\,b+s$, with $\\alpha\\in\\mathbb{R}$ and $s\\in \\mathcal{S}_{2}(\\hat K)$.\n\nUsing only the foundational definitions above and reasoning from first principles, determine the unique scalar $\\alpha\\in\\mathbb{R}$ in the decomposition\n$$\np(\\xi,\\eta)=\\xi^{2}\\eta^{2}=\\alpha\\,b(\\xi,\\eta)+s(\\xi,\\eta),\\quad s\\in \\mathcal{S}_{2}(\\hat K).\n$$\nYour derivation must justify whether $\\xi^{2}\\eta^{2}$ lies in $\\mathcal{S}_{2}(\\hat K)$ by explicitly constructing $s$ or by exhibiting a constraint functional that annihilates $\\mathcal{S}_{2}(\\hat K)$ but not $\\xi^{2}\\eta^{2}$. Provide the value of $\\alpha$ as your final answer. No rounding is required.", "solution": "The problem is to determine the unique scalar $\\alpha \\in \\mathbb{R}$ in the decomposition of the polynomial $p(\\xi, \\eta) = \\xi^{2}\\eta^{2}$ into a component proportional to the quadratic bubble function $b(\\xi, \\eta)$ and a component $s(\\xi, \\eta)$ from the quadratic serendipity space $\\mathcal{S}_{2}(\\hat K)$. The given decomposition is\n$$\np(\\xi, \\eta) = \\alpha \\, b(\\xi, \\eta) + s(\\xi, \\eta)\n$$\nwhere $p(\\xi, \\eta) = \\xi^{2}\\eta^{2}$, $b(\\xi, \\eta) = (1 - \\xi^{2})(1 - \\eta^{2})$, and $s(\\xi, \\eta) \\in \\mathcal{S}_{2}(\\hat K)$.\n\nFirst, we must precisely characterize the space $\\mathcal{S}_{2}(\\hat K)$. The problem provides a definitive characterization based on its monomial basis. A monomial $\\xi^{a}\\eta^{b}$ is a basis element of $\\mathcal{S}_{r}(\\hat K)$ if the sum of its exponents that are at least $2$ is at most $r$. For our case, $r=2$. The space of biquadratic polynomials $\\mathcal{Q}_{2}(\\hat K)$ on the reference square $\\hat K = [-1, 1]^{2}$ is spanned by the $9$ monomials $\\{ \\xi^{a}\\eta^{b} \\mid a, b \\in \\{0, 1, 2\\} \\}$. We test each monomial for inclusion in the basis of $\\mathcal{S}_{2}(\\hat K)$. Let $\\delta(k) = k$ if $k \\ge 2$ and $\\delta(k)=0$ if $k < 2$. The condition for inclusion of $\\xi^{a}\\eta^{b}$ is $\\delta(a) + \\delta(b) \\le 2$.\n\n- For $\\{1, \\xi, \\eta, \\xi\\eta\\}$, both exponents are less than $2$, so $\\delta(a)+\\delta(b) = 0 \\le 2$. These are in $\\mathcal{S}_{2}(\\hat K)$.\n- For $\\xi^{2}$, we have $a=2, b=0$. $\\delta(2) + \\delta(0) = 2+0=2 \\le 2$. This is in $\\mathcal{S}_{2}(\\hat K)$.\n- For $\\eta^{2}$, we have $a=0, b=2$. $\\delta(0) + \\delta(2) = 0+2=2 \\le 2$. This is in $\\mathcal{S}_{2}(\\hat K)$.\n- For $\\xi^{2}\\eta$, we have $a=2, b=1$. $\\delta(2) + \\delta(1) = 2+0=2 \\le 2$. This is in $\\mathcal{S}_{2}(\\hat K)$.\n- For $\\xi\\eta^{2}$, we have $a=1, b=2$. $\\delta(1) + \\delta(2) = 0+2=2 \\le 2$. This is in $\\mathcal{S}_{2}(\\hat K)$.\n- For $\\xi^{2}\\eta^{2}$, we have $a=2, b=2$. $\\delta(2) + \\delta(2) = 2+2=4 > 2$. This monomial is not in $\\mathcal{S}_{2}(\\hat K)$.\n\nThis analysis explicitly demonstrates that the polynomial $p(\\xi, \\eta) = \\xi^{2}\\eta^{2}$ does not belong to the space $\\mathcal{S}_{2}(\\hat K)$, as required by the problem prompt. The space $\\mathcal{S}_{2}(\\hat K)$ is the $8$-dimensional space spanned by the monomial basis $\\{1, \\xi, \\eta, \\xi\\eta, \\xi^{2}, \\eta^{2}, \\xi^{2}\\eta, \\xi\\eta^{2}\\}$. Consequently, any polynomial $s \\in \\mathcal{S}_{2}(\\hat K)$, when written in the monomial basis of $\\mathcal{Q}_{2}(\\hat K)$, must have a zero coefficient for the $\\xi^{2}\\eta^{2}$ term.\n\nNow we proceed to find $\\alpha$. The bubble function is expanded as\n$$\nb(\\xi, \\eta) = (1 - \\xi^{2})(1 - \\eta^{2}) = 1 - \\xi^{2} - \\eta^{2} + \\xi^{2}\\eta^{2}.\n$$\nSubstitute this and $p(\\xi, \\eta) = \\xi^{2}\\eta^{2}$ into the decomposition equation:\n$$\n\\xi^{2}\\eta^{2} = \\alpha (1 - \\xi^{2} - \\eta^{2} + \\xi^{2}\\eta^{2}) + s(\\xi, \\eta).\n$$\nTo determine the properties of $s(\\xi, \\eta)$, we isolate it:\n$$\ns(\\xi, \\eta) = \\xi^{2}\\eta^{2} - \\alpha (1 - \\xi^{2} - \\eta^{2} + \\xi^{2}\\eta^{2})\n$$\n$$\ns(\\xi, \\eta) = \\xi^{2}\\eta^{2} - \\alpha + \\alpha\\xi^{2} + \\alpha\\eta^{2} - \\alpha\\xi^{2}\\eta^{2}.\n$$\nCollecting terms by monomial, we obtain the expression for $s(\\xi, \\eta)$ in the standard monomial basis:\n$$\ns(\\xi, \\eta) = (1 - \\alpha)\\xi^{2}\\eta^{2} + \\alpha\\xi^{2} + \\alpha\\eta^{2} - \\alpha.\n$$\nFor $s(\\xi, \\eta)$ to be an element of $\\mathcal{S}_{2}(\\hat K)$, the coefficient of the $\\xi^{2}\\eta^{2}$ term must be zero. This provides a necessary and sufficient condition on $\\alpha$:\n$$\n1 - \\alpha = 0.\n$$\nSolving for $\\alpha$ yields the unique value:\n$$\n\\alpha = 1.\n$$\nWith $\\alpha=1$, we can explicitly construct the serendipity component $s(\\xi, \\eta)$ as required:\n$$\ns(\\xi, \\eta) = (1 - 1)\\xi^{2}\\eta^{2} + (1)\\xi^{2} + (1)\\eta^{2} - 1 = \\xi^{2} + \\eta^{2} - 1.\n$$\nThis polynomial $s(\\xi, \\eta) = \\xi^{2} + \\eta^{2} - 1$ is a linear combination of the basis elements $\\{1, \\xi^{2}, \\eta^{2}\\}$, all of which belong to $\\mathcal{S}_{2}(\\hat K)$. Therefore, $s(\\xi, \\eta)$ is indeed in $\\mathcal{S}_{2}(\\hat K)$. The unique decomposition is thus:\n$$\n\\xi^{2}\\eta^{2} = 1 \\cdot (1 - \\xi^{2})(1 - \\eta^{2}) + (\\xi^{2} + \\eta^{2} - 1).\n$$\nThe value of the scalar $\\alpha$ is unequivocally determined to be $1$.", "answer": "$$\n\\boxed{1}\n$$", "id": "2594813"}, {"introduction": "The utility of the finite element method is realized when we map our abstract formulations from a simple reference element to a complex physical geometry. This final practice bridges that gap by tasking you with computing the physical gradient of a shape function on a distorted element, a fundamental step in calculating strain and stress. This exercise synthesizes previous concepts and demonstrates the crucial role of the Jacobian matrix and the chain rule in transforming derivatives from the reference to the physical domain. [@problem_id:2594816]", "problem": "Consider the serendipity family $S_k$ of quadrilateral finite elements within the finite element method (FEM). Let the reference element be $\\hat K=[-1,1]^2$ with local coordinates $(\\xi,\\eta)$. The serendipity family $S_k$ of order $k$ on a quadrilateral places degrees of freedom on the vertices and edges so that on each edge the trace reduces to the univariate Lagrange polynomial of degree $k$, and no interior degree of freedom is used for $k=2$. In contrast, the tensor-product Lagrange family $Q_k$ has $(k+1)^2$ nodes.\n\nStart from the definition of the univariate Lagrange polynomials on the nodes $\\{-1,0,1\\}$:\n- $l_{-1}(t)$, $l_0(t)$, and $l_1(t)$ are the unique degree-$2$ polynomials satisfying $l_i(j)=\\delta_{ij}$ for $i,j\\in\\{-1,0,1\\}$.\n\nUsing only these univariate polynomials and the geometric constraints that (i) the vertex shape functions take the value $1$ at their vertex and $0$ at all other serendipity nodes, (ii) the midside shape functions take the value $1$ at their edge midpoint and $0$ at all other serendipity nodes, (iii) all shape functions reduce on each edge to the univariate quadratic Lagrange basis associated with that edge, and (iv) the shape functions form a partition of unity, derive explicit formulas for the eight $S_2$ serendipity shape functions $N_i(\\xi,\\eta)$ on $\\hat K$ for the nodes ordered as follows: $N_1$ at $(-1,-1)$, $N_2$ at $(1,-1)$, $N_3$ at $(1,1)$, $N_4$ at $(-1,1)$, and edge-midpoint nodes $N_5$ at $(0,-1)$, $N_6$ at $(1,0)$, $N_7$ at $(0,1)$, $N_8$ at $(-1,0)$. Then compute their reference gradients $\\nabla_{\\xi,\\eta}N_i(\\xi,\\eta)$.\n\nNext, let $F:\\hat K\\to K$ be the isoparametric mapping to a physical parallelogram $K$ with vertices\n- $x_1=(0,0)$, $x_2=(3,1)$, $x_3=(4,3)$, $x_4=(1,2)$,\nso that $F$ is affine and $DF$ is constant. Express the physical gradient $\\nabla_x N_i$ in terms of the reference gradient via the inverse transpose of the Jacobian $DF$ using the chain rule. Finally, evaluate the physical gradient of the corner shape function $N_3$ at the reference point $(\\xi^\\star,\\eta^\\star)=\\left(\\frac{1}{3},-\\frac{1}{2}\\right)$ and report it as a row vector with exact rational entries. Do not round. No units are required.", "solution": "First, we define the required univariate quadratic Lagrange polynomials on the interval $[-1,1]$ with nodes at $\\{-1, 0, 1\\}$.\nThe polynomial for the node at $t=-1$ is $l_{-1}(t) = \\frac{(t-0)(t-1)}{(-1-0)(-1-1)} = \\frac{1}{2}t(t-1)$.\nThe polynomial for the node at $t=0$ is $l_0(t) = \\frac{(t-(-1))(t-1)}{(0-(-1))(0-1)} = -(t+1)(t-1) = 1-t^2$.\nThe polynomial for the node at $t=1$ is $l_1(t) = \\frac{(t-(-1))(t-0)}{(1-(-1))(1-0)} = \\frac{1}{2}t(t+1)$.\n\nNext, we construct the eight shape functions $N_i(\\xi, \\eta)$ for the $S_2$ element, satisfying the given constraints. A standard construction procedure is employed.\n\nThe midside node shape functions are constructed as the product of a quadratic Lagrange polynomial in one direction and a linear Lagrange polynomial in the other.\nFor node $5$ at $(0,-1)$, the shape function must be $l_0(\\xi)=1-\\xi^2$ along the edge $\\eta=-1$ and $0$ along the edge $\\eta=1$. This is achieved by multiplying by the linear shape function $\\frac{1}{2}(1-\\eta)$.\n$N_5(\\xi, \\eta) = l_0(\\xi) \\cdot \\frac{1}{2}(1-\\eta) = \\frac{1}{2}(1-\\xi^2)(1-\\eta)$.\nBy cyclic permutation of coordinates, we obtain the other midside shape functions:\n$N_6(\\xi, \\eta) = \\frac{1}{2}(1-\\eta^2)(1+\\xi)$ for node $(1,0)$.\n$N_7(\\xi, \\eta) = \\frac{1}{2}(1-\\xi^2)(1+\\eta)$ for node $(0,1)$.\n$N_8(\\xi, \\eta) = \\frac{1}{2}(1-\\eta^2)(1-\\xi)$ for node $(-1,0)$.\n\nThe corner node shape functions are constructed by starting with the corresponding bilinear ($Q_1$) shape functions and subtracting contributions from the adjacent midside shape functions to enforce the zero condition at those nodes.\nFor node $1$ at $(-1,-1)$, the bilinear shape function is $\\hat{N}_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$. This function is $1$ at node $1$ but $\\frac{1}{2}$ at the adjacent midside nodes $5$ and $8$. We correct this:\n$N_1(\\xi, \\eta) = \\hat{N}_1(\\xi, \\eta) - \\frac{1}{2}N_5(\\xi, \\eta) - \\frac{1}{2}N_8(\\xi, \\eta)$\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) - \\frac{1}{2}\\left(\\frac{1}{2}(1-\\xi^2)(1-\\eta)\\right) - \\frac{1}{2}\\left(\\frac{1}{2}(1-\\eta^2)(1-\\xi)\\right)$\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)\\left[1 - (1+\\xi) - (1+\\eta)\\right] = \\frac{1}{4}(1-\\xi)(1-\\eta)(-\\xi-\\eta-1)$.\nGeneralizing for any corner node $i$ with coordinates $(\\xi_i, \\eta_i)$, the formula is:\n$N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i\\xi)(1+\\eta_i\\eta)(\\xi_i\\xi + \\eta_i\\eta - 1)$ for $i=1,2,3,4$.\nSpecifically for node $3$ at $(1,1)$:\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)(\\xi + \\eta - 1)$.\n\nWe now compute the reference gradient $\\nabla_{\\xi,\\eta}N_3$. First, we expand the expression for $N_3$:\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi+\\eta+\\xi\\eta)(\\xi+\\eta-1) = \\frac{1}{4}(\\xi^2+\\eta^2+\\xi\\eta-1+\\xi^2\\eta+\\xi\\eta^2)$.\nThe partial derivatives with respect to $\\xi$ and $\\eta$ are:\n$\\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(2\\xi + \\eta + 2\\xi\\eta + \\eta^2)$.\n$\\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(\\xi + 2\\eta + \\xi^2 + 2\\xi\\eta)$.\n\nThe next step is to find the Jacobian matrix $J = DF$ of the isoparametric map $F$. Since the physical element $K$ is a parallelogram, the map is affine and $J$ is constant. A simple method is to compute the vectors along the edges of the reference element.\nThe first column of $J$ is $\\frac{\\partial x}{\\partial\\xi} = \\frac{1}{2}(x(1,0) - x(-1,0))$. The point $x(1,0)$ is the physical midpoint of the edge connecting $x_2$ and $x_3$, and $x(-1,0)$ is the midpoint between $x_4$ and $x_1$.\n$x(1,0) = \\frac{x_2+x_3}{2} = \\frac{(3,1)+(4,3)}{2} = (\\frac{7}{2}, 2)$.\n$x(-1,0) = \\frac{x_4+x_1}{2} = \\frac{(1,2)+(0,0)}{2} = (\\frac{1}{2}, 1)$.\n$\\frac{\\partial x}{\\partial\\xi} = \\frac{1}{2}\\left((\\frac{7}{2}, 2) - (\\frac{1}{2}, 1)\\right) = \\frac{1}{2}(3, 1) = (\\frac{3}{2}, \\frac{1}{2})$.\nThe second column is $\\frac{\\partial x}{\\partial\\eta} = \\frac{1}{2}(x(0,1) - x(0,-1))$.\n$x(0,1) = \\frac{x_3+x_4}{2} = \\frac{(4,3)+(1,2)}{2} = (\\frac{5}{2}, \\frac{5}{2})$.\n$x(0,-1) = \\frac{x_1+x_2}{2} = \\frac{(0,0)+(3,1)}{2} = (\\frac{3}{2}, \\frac{1}{2})$.\n$\\frac{\\partial x}{\\partial\\eta} = \\frac{1}{2}\\left((\\frac{5}{2}, \\frac{5}{2}) - (\\frac{3}{2}, \\frac{1}{2})\\right) = \\frac{1}{2}(1, 2) = (\\frac{1}{2}, 1)$.\nThe Jacobian matrix is $J = \\begin{pmatrix} \\frac{3}{2} & \\frac{1}{2} \\\\ \\frac{1}{2} & 1 \\end{pmatrix}$.\n\nThe physical gradient $\\nabla_x N_i$ is related to the reference gradient $\\nabla_{\\xi,\\eta}N_i$ by the chain rule: $\\nabla_x N_i = J^{-T} \\nabla_{\\xi,\\eta}N_i$. We compute $J^{-1}$ and then $J^{-T}$.\n$\\det(J) = (\\frac{3}{2})(1) - (\\frac{1}{2})(\\frac{1}{2}) = \\frac{3}{2} - \\frac{1}{4} = \\frac{5}{4}$.\n$J^{-1} = \\frac{1}{\\det(J)}\\begin{pmatrix} 1 & -\\frac{1}{2} \\\\ -\\frac{1}{2} & \\frac{3}{2} \\end{pmatrix} = \\frac{4}{5}\\begin{pmatrix} 1 & -\\frac{1}{2} \\\\ -\\frac{1}{2} & \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{5} & -\\frac{2}{5} \\\\ -\\frac{2}{5} & \\frac{6}{5} \\end{pmatrix}$.\nSince $J$ is symmetric, $J^{-1}$ is also symmetric, so $J^{-T} = J^{-1}$.\n\nNow we evaluate the reference gradient of $N_3$ at the point $(\\xi^\\star, \\eta^\\star) = (\\frac{1}{3}, -\\frac{1}{2})$.\n$\\frac{\\partial N_3}{\\partial \\xi}\\bigg|_{(\\frac{1}{3}, -\\frac{1}{2})} = \\frac{1}{4}\\left(2(\\frac{1}{3}) + (-\\frac{1}{2}) + 2(\\frac{1}{3})(-\\frac{1}{2}) + (-\\frac{1}{2})^2\\right) = \\frac{1}{4}\\left(\\frac{2}{3} - \\frac{1}{2} - \\frac{1}{3} + \\frac{1}{4}\\right) = \\frac{1}{4}\\left(\\frac{1}{3} - \\frac{1}{2} + \\frac{1}{4}\\right) = \\frac{1}{4}\\left(\\frac{4-6+3}{12}\\right) = \\frac{1}{48}$.\n$\\frac{\\partial N_3}{\\partial \\eta}\\bigg|_{(\\frac{1}{3}, -\\frac{1}{2})} = \\frac{1}{4}\\left(\\frac{1}{3} + 2(-\\frac{1}{2}) + (\\frac{1}{3})^2 + 2(\\frac{1}{3})(-\\frac{1}{2})\\right) = \\frac{1}{4}\\left(\\frac{1}{3} - 1 + \\frac{1}{9} - \\frac{1}{3}\\right) = \\frac{1}{4}\\left(-1 + \\frac{1}{9}\\right) = \\frac{1}{4}\\left(-\\frac{8}{9}\\right) = -\\frac{2}{9}$.\nThus, $\\nabla_{\\xi,\\eta}N_3(\\frac{1}{3}, -\\frac{1}{2}) = \\begin{pmatrix} \\frac{1}{48} \\\\ -\\frac{2}{9} \\end{pmatrix}$.\n\nFinally, we compute the physical gradient $\\nabla_x N_3$ at this point.\n$\\nabla_x N_3 = \\begin{pmatrix} \\frac{\\partial N_3}{\\partial x} \\\\ \\frac{\\partial N_3}{\\partial y} \\end{pmatrix} = J^{-T} \\nabla_{\\xi,\\eta}N_3 = \\begin{pmatrix} \\frac{4}{5} & -\\frac{2}{5} \\\\ -\\frac{2}{5} & \\frac{6}{5} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{48} \\\\ -\\frac{2}{9} \\end{pmatrix}$.\nThe first component is:\n$\\frac{\\partial N_3}{\\partial x} = \\frac{4}{5} \\cdot \\frac{1}{48} - \\frac{2}{5} \\cdot \\left(-\\frac{2}{9}\\right) = \\frac{1}{5 \\cdot 12} + \\frac{4}{45} = \\frac{1}{60} + \\frac{4}{45} = \\frac{3}{180} + \\frac{16}{180} = \\frac{19}{180}$.\nThe second component is:\n$\\frac{\\partial N_3}{\\partial y} = -\\frac{2}{5} \\cdot \\frac{1}{48} + \\frac{6}{5} \\cdot \\left(-\\frac{2}{9}\\right) = -\\frac{1}{5 \\cdot 24} - \\frac{12}{45} = -\\frac{1}{120} - \\frac{4}{15} = -\\frac{1}{120} - \\frac{32}{120} = -\\frac{33}{120} = -\\frac{11}{40}$.\nThe resulting physical gradient is the vector $(\\frac{19}{180}, -\\frac{11}{40})$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{19}{180} & -\\frac{11}{40}\n\\end{pmatrix}\n}\n$$", "id": "2594816"}]}