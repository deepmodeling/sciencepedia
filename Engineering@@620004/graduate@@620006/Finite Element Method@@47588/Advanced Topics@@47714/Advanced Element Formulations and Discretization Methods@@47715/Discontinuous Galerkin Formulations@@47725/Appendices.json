{"hands_on_practices": [{"introduction": "The choice of basis functions is fundamental in any finite element method. Discontinuous Galerkin (DG) methods often leverage the analytical convenience of orthogonal modal bases, such as Legendre polynomials, for theoretical development, while practical implementations frequently rely on nodal bases for simpler handling of inter-element coupling. This exercise provides essential hands-on practice in bridging this theoretical and practical gap. By explicitly constructing the mass and stiffness matrices in a modal basis and transforming them to a nodal basis [@problem_id:2552249], you will solidify your understanding of how these different representations are connected and develop a core skill for implementing high-order DG schemes.", "problem": "Consider a single reference element of a discontinuous Galerkin finite element method on the interval $[-1,1]$ with polynomial degree $p=2$. Let the modal basis be the first three Legendre polynomials on $[-1,1]$, namely $P_{0}(x)$, $P_{1}(x)$, and $P_{2}(x)$, where $P_{0}(x)=1$, $P_{1}(x)=x$, and $P_{2}(x)=(3x^{2}-1)/2$. The modal mass and stiffness matrices on the element are defined by the bilinear forms\n$$\n(M_{\\mathrm{modal}})_{ij}=\\int_{-1}^{1} P_{i}(x)\\,P_{j}(x)\\,dx,\\qquad (K_{\\mathrm{modal}})_{ij}=\\int_{-1}^{1} P_{i}'(x)\\,P_{j}'(x)\\,dx,\n$$\nfor $i,j\\in\\{0,1,2\\}$. Introduce the nodal basis associated with the Legendre–Gauss–Lobatto points $x_{1}=-1$, $x_{2}=0$, $x_{3}=1$, and define the Vandermonde matrix $V\\in\\mathbb{R}^{3\\times 3}$ by $V_{i j}=P_{j-1}(x_{i})$ for $i,j\\in\\{1,2,3\\}$, so that the nodal values vector equals $V$ times the modal coefficient vector. Using only fundamental properties of Legendre polynomials and the definitions above, construct $M_{\\mathrm{modal}}$ and $K_{\\mathrm{modal}}$, then transform them to the nodal basis to obtain $M_{\\mathrm{nodal}}$ and $K_{\\mathrm{nodal}}$. Finally, compute the determinant of the nodal mass matrix $M_{\\mathrm{nodal}}$ and express your final result as a reduced fraction. Provide only the determinant as your final answer, with no rounding.", "solution": "We work on the reference interval $[-1,1]$ with polynomial degree $p=2$. The modal basis consists of $P_{0}(x)=1$, $P_{1}(x)=x$, and $P_{2}(x)=(3x^{2}-1)/2$. The modal mass matrix and stiffness matrix are defined by\n$$\n(M_{\\mathrm{modal}})_{ij}=\\int_{-1}^{1} P_{i}(x)\\,P_{j}(x)\\,dx,\\qquad (K_{\\mathrm{modal}})_{ij}=\\int_{-1}^{1} P_{i}'(x)\\,P_{j}'(x)\\,dx,\\quad i,j\\in\\{0,1,2\\}.\n$$\nWe begin from fundamental properties of the Legendre polynomials. They are orthogonal on $[-1,1]$ with unit weight, that is,\n$$\n\\int_{-1}^{1} P_{n}(x)\\,P_{m}(x)\\,dx=\\frac{2}{2n+1}\\,\\delta_{nm},\n$$\nwhere $\\delta_{nm}$ is the Kronecker delta. For $n\\in\\{0,1,2\\}$, this yields\n$$\n\\int_{-1}^{1} P_{0}^{2}(x)\\,dx=2,\\qquad \\int_{-1}^{1} P_{1}^{2}(x)\\,dx=\\frac{2}{3},\\qquad \\int_{-1}^{1} P_{2}^{2}(x)\\,dx=\\frac{2}{5},\n$$\nand $\\int_{-1}^{1} P_{i}(x)\\,P_{j}(x)\\,dx=0$ for $i\\neq j$. Therefore,\n$$\nM_{\\mathrm{modal}}=\\mathrm{diag}\\!\\left(2,\\frac{2}{3},\\frac{2}{5}\\right).\n$$\nFor the stiffness matrix, we use $P_{0}'(x)=0$, $P_{1}'(x)=1$, and $P_{2}'(x)=3x$. Hence,\n$$\n(K_{\\mathrm{modal}})_{00}=\\int_{-1}^{1} 0\\cdot 0\\,dx=0,\\quad (K_{\\mathrm{modal}})_{01}=\\int_{-1}^{1} 0\\cdot 1\\,dx=0,\\quad (K_{\\mathrm{modal}})_{02}=\\int_{-1}^{1} 0\\cdot 3x\\,dx=0,\n$$\n$$\n(K_{\\mathrm{modal}})_{11}=\\int_{-1}^{1} 1\\cdot 1\\,dx=2,\\quad (K_{\\mathrm{modal}})_{12}=\\int_{-1}^{1} 1\\cdot 3x\\,dx=3\\int_{-1}^{1} x\\,dx=0,\n$$\n$$\n(K_{\\mathrm{modal}})_{22}=\\int_{-1}^{1} (3x)\\,(3x)\\,dx=9\\int_{-1}^{1} x^{2}\\,dx=9\\cdot\\frac{2}{3}=6.\n$$\nBy symmetry, $(K_{\\mathrm{modal}})_{ij}=(K_{\\mathrm{modal}})_{ji}$. Collecting these, we obtain\n$$\nK_{\\mathrm{modal}}=\\mathrm{diag}\\!\\left(0,2,6\\right).\n$$\nNext, we define the nodal basis associated with the Legendre–Gauss–Lobatto points $x_{1}=-1$, $x_{2}=0$, $x_{3}=1$. The Vandermonde matrix $V\\in\\mathbb{R}^{3\\times 3}$ is defined by $V_{i j}=P_{j-1}(x_{i})$ for $i,j\\in\\{1,2,3\\}$. Evaluating the polynomials at the nodes gives\n$$\nP_{0}(-1)=1,\\quad P_{1}(-1)=-1,\\quad P_{2}(-1)=1;\n$$\n$$\nP_{0}(0)=1,\\quad P_{1}(0)=0,\\quad P_{2}(0)=-\\frac{1}{2};\n$$\n$$\nP_{0}(1)=1,\\quad P_{1}(1)=1,\\quad P_{2}(1)=1.\n$$\nTherefore,\n$$\nV=\\begin{pmatrix}\n1 & -1 & 1\\\\\n1 & 0 & -\\frac{1}{2}\\\\\n1 & 1 & 1\n\\end{pmatrix}.\n$$\nLet the vector of modal coefficients be $a\\in\\mathbb{R}^{3}$ and the vector of nodal values be $u\\in\\mathbb{R}^{3}$. By construction, $u=V\\,a$. Hence $a=V^{-1}u$. For any two functions with nodal vectors $u$ and $v$, the mass bilinear form satisfies\n$$\nu^{\\top} M_{\\mathrm{nodal}} v = a^{\\top} M_{\\mathrm{modal}} b = (V^{-1}u)^{\\top}M_{\\mathrm{modal}}(V^{-1}v)=u^{\\top}\\left(V^{-\\top}M_{\\mathrm{modal}}V^{-1}\\right)v.\n$$\nThus,\n$$\nM_{\\mathrm{nodal}}=V^{-\\top}M_{\\mathrm{modal}}V^{-1},\\qquad K_{\\mathrm{nodal}}=V^{-\\top}K_{\\mathrm{modal}}V^{-1}.\n$$\nWe compute $V^{-1}$ explicitly by solving $V a=u$. Writing the equations componentwise using $x_{1}=-1$, $x_{2}=0$, $x_{3}=1$,\n$$\na_{0}-a_{1}+a_{2}=u_{1},\\qquad a_{0}-\\frac{1}{2}a_{2}=u_{2},\\qquad a_{0}+a_{1}+a_{2}=u_{3}.\n$$\nAdding the first and third equations gives $a_{0}+a_{2}=(u_{1}+u_{3})/2$, subtracting the first from the third gives $a_{1}=(u_{3}-u_{1})/2$, and combining with the second yields\n$$\na_{2}=\\frac{1}{3}\\left(u_{1}-2u_{2}+u_{3}\\right),\\qquad a_{0}=\\frac{1}{6}\\left(u_{1}+4u_{2}+u_{3}\\right).\n$$\nTherefore,\n$$\nV^{-1}=\n\\begin{pmatrix}\n\\frac{1}{6} & \\frac{2}{3} & \\frac{1}{6} \\\\[4pt]\n-\\frac{1}{2} & 0 & \\frac{1}{2} \\\\[4pt]\n\\frac{1}{3} & -\\frac{2}{3} & \\frac{1}{3}\n\\end{pmatrix}.\n$$\nSet $W=V^{-1}$ and note that $M_{\\mathrm{modal}}=\\mathrm{diag}(2,2/3,2/5)$. Then\n$$\nM_{\\mathrm{nodal}}=W^{\\top}M_{\\mathrm{modal}}W=\\sum_{j=0}^{2} m_{j}\\,r_{j}^{\\top}r_{j},\n$$\nwhere $m_{0}=2$, $m_{1}=2/3$, $m_{2}=2/5$, and $r_{j}$ is the $j$-th row of $W$. With\n$$\nr_{0}=\\left(\\frac{1}{6},\\frac{2}{3},\\frac{1}{6}\\right),\\quad r_{1}=\\left(-\\frac{1}{2},0,\\frac{1}{2}\\right),\\quad r_{2}=\\left(\\frac{1}{3},-\\frac{2}{3},\\frac{1}{3}\\right),\n$$\nthe outer-product sum produces\n$$\nM_{\\mathrm{nodal}}=\n\\begin{pmatrix}\n\\frac{4}{15} & \\frac{2}{15} & -\\frac{1}{15} \\\\[4pt]\n\\frac{2}{15} & \\frac{16}{15} & \\frac{2}{15} \\\\[4pt]\n-\\frac{1}{15} & \\frac{2}{15} & \\frac{4}{15}\n\\end{pmatrix}.\n$$\nFor completeness, an analogous computation with $K_{\\mathrm{modal}}=\\mathrm{diag}(0,2,6)$ yields\n$$\nK_{\\mathrm{nodal}}=\n\\begin{pmatrix}\n\\frac{7}{6} & -\\frac{4}{3} & \\frac{1}{6} \\\\[4pt]\n-\\frac{4}{3} & \\frac{8}{3} & -\\frac{4}{3} \\\\[4pt]\n\\frac{1}{6} & -\\frac{4}{3} & \\frac{7}{6}\n\\end{pmatrix}.\n$$\nWe now compute the determinant of $M_{\\mathrm{nodal}}$. It is convenient to factor out a common denominator. Define\n$$\nN=15\\,M_{\\mathrm{nodal}}=\n\\begin{pmatrix}\n4 & 2 & -1\\\\\n2 & 16 & 2\\\\\n-1 & 2 & 4\n\\end{pmatrix},\n$$\nso that $\\det(M_{\\mathrm{nodal}})=\\det(N)/15^{3}$. Expanding the determinant of $N$,\n$$\n\\det(N)=4\\begin{vmatrix}16 & 2\\\\ 2 & 4\\end{vmatrix}-2\\begin{vmatrix}2 & 2\\\\ -1 & 4\\end{vmatrix}-1\\begin{vmatrix}2 & 16\\\\ -1 & 2\\end{vmatrix}=4(64-4)-2(8+2)-(4+16)=240-20-20=200.\n$$\nTherefore,\n$$\n\\det(M_{\\mathrm{nodal}})=\\frac{200}{15^{3}}=\\frac{200}{3375}=\\frac{8}{135}.\n$$\nThis fraction is reduced, so the determinant of the nodal mass matrix is $\\frac{8}{135}$.", "answer": "$$\\boxed{\\frac{8}{135}}$$", "id": "2552249"}, {"introduction": "A defining feature of Discontinuous Galerkin methods is their flexible approach to boundary conditions, which are imposed weakly as part of the variational formulation. For elliptic problems like the Poisson equation, the Symmetric Interior Penalty Galerkin (SIPG) method provides a robust framework for handling Dirichlet data through a technique known as Nitsche's method. This practice problem [@problem_id:2552258] focuses on the practical mechanics of this weak imposition. By deriving the specific contributions to the right-hand side vector that arise from the Dirichlet boundary data, you will gain concrete insight into how penalty and consistency terms work together to enforce the solution at the domain boundary.", "problem": "Consider the one-dimensional Poisson problem $-u''(x) = 0$ on the open interval $(0,1)$ with Dirichlet boundary data $u(0)=0$ and $u(1)=1$. Let the domain be partitioned into two elements $K_{1} = (0, \\tfrac{1}{2})$ and $K_{2} = (\\tfrac{1}{2}, 1)$, and let the trial and test spaces be discontinuous piecewise-polynomial functions of degree $p=1$ on this mesh. Use the symmetric interior penalty Galerkin (SIPG) method, where Dirichlet boundary data are imposed weakly via the symmetric Nitsche approach consistent with SIPG. Assume unit diffusion coefficient $a(x) \\equiv 1$. Let the outward unit normal be $n(0)=-1$ at $x=0$ and $n(1)=+1$ at $x=1$. On boundary faces, use the penalty parameter $\\sigma_{F} = \\dfrac{2}{h_{F}}$, where $h_{F}$ is the element length adjacent to the boundary face.\n\nOn each element $K=[x_{L},x_{R}]$, use the standard linear basis $\\{\\phi_{1},\\phi_{2}\\}$ with $\\phi_{1}(x_{L})=1$, $\\phi_{1}(x_{R})=0$, $\\phi_{2}(x_{L})=0$, $\\phi_{2}(x_{R})=1$, and constant derivatives $\\phi_{1}'=-\\dfrac{1}{h}$, $\\phi_{2}'=\\dfrac{1}{h}$, where $h=x_{R}-x_{L}$. Denote the global degrees of freedom in the natural local-to-global ordering as\n$[\\phi_{1}^{(1)}, \\phi_{2}^{(1)}, \\phi_{1}^{(2)}, \\phi_{2}^{(2)}]$, where the superscript indicates the element number.\n\nStarting from the elementwise weak form obtained by integration by parts and the requirement of consistency and symmetry at the boundary in the SIPG framework, derive the boundary contributions to the right-hand side vector that arise from the Dirichlet data at $x=0$ and $x=1$. Then, evaluate these contributions explicitly for the given data and mesh, and assemble them into the global right-hand side vector (boundary terms only) in the ordering $[\\phi_{1}^{(1)}, \\phi_{2}^{(1)}, \\phi_{1}^{(2)}, \\phi_{2}^{(2)}]$.\n\nProvide your final answer as a single row matrix. No rounding is required.", "solution": "The problem is to find the boundary contributions to the right-hand side (RHS) vector for the one-dimensional Poisson equation $-u''(x) = 0$ on the domain $\\Omega = (0,1)$ with discontinuous piecewise linear basis functions. The method specified is the symmetric interior penalty Galerkin (SIPG) method, where the Dirichlet boundary conditions $u(0)=g_0=0$ and $u(1)=g_1=1$ are imposed weakly using Nitsche's method.\n\nWe start from the weak form of the equation on a single element $K$. For a test function $v \\in V_h$, we have:\n$$ -\\int_K u'' v \\, dx = \\int_K 0 \\cdot v \\, dx = 0 $$\nIntegrating by parts once yields:\n$$ \\int_K u' v' \\, dx - [u' v]_{\\partial K} = 0 $$\nSumming over all elements $K$ in the mesh $\\mathcal{T}_h$ and using a diffusion coefficient $a(x)=1$:\n$$ \\sum_{K \\in \\mathcal{T}_h} \\int_K u' v' \\, dx - \\sum_{K \\in \\mathcal{T}_h} [u' v]_{\\partial K} = 0 $$\nThe SIPG method modifies this formulation to handle the discontinuities at element interfaces and to impose boundary conditions. The resulting global problem is to find $u_h \\in V_h$ such that for all $v_h \\in V_h$:\n$$ B_h(u_h, v_h) = L_h(v_h) $$\nThe terms involving the known Dirichlet data $g_D$ are moved to the right-hand side, forming the linear functional $L_h(v_h)$. The task is to find the contributions to $L_h(v_h)$ that arise from the boundary faces.\n\nFor a symmetric Nitsche's formulation consistent with SIPG, the terms arizing from a Dirichlet boundary face $F \\in \\mathcal{F}_D$ are derived by considering the interior, penalty, and symmetry terms, but with the \"exterior\" solution value taken as the Dirichlet data $g_D$. The resulting contribution to the RHS for a single boundary face $F$ is:\n$$ L_F(v_h) = \\int_F \\sigma_F g_D v_h \\, dS - \\int_F (a \\nabla v_h \\cdot n) g_D \\, dS $$\nHere, $n$ is the outward unit normal to the domain $\\Omega$, $\\sigma_F$ is the penalty parameter, and $g_D$ is the specified Dirichlet value on face $F$.\n\nThe total boundary contribution to the RHS vector is the sum over all Dirichlet faces:\n$$ L^{bnd}(v_h) = \\sum_{F \\in \\mathcal{F}_D} \\left( \\int_F \\sigma_F g_D v_h \\, dS - \\int_F (a \\nabla v_h \\cdot n) g_D \\, dS \\right) $$\nIn our one-dimensional case, the domain is $\\Omega=(0,1)$, and the integration over a face $F$ (which is a point) simplifies to evaluation at that point.\n\nThe boundary faces are at $x=0$ and $x=1$.\nCase 1: Face at $x=0$.\nThe Dirichlet datum is $g_D = u(0) = 0$.\nThe contribution to the RHS is therefore:\n$$ L_{x=0}(v_h) = (\\sigma_F g_D v_h)|_{x=0} - (a v_h' n g_D)|_{x=0} = (\\sigma_F \\cdot 0 \\cdot v_h(0)) - (1 \\cdot v_h'(0) \\cdot (-1) \\cdot 0) = 0 $$\nThe contribution from the boundary at $x=0$ is zero for any test function $v_h$.\n\nCase 2: Face at $x=1$.\nThe Dirichlet datum is $g_D = u(1) = 1$.\nThe outward unit normal is $n = +1$.\nThe diffusion coefficient is $a=1$.\nThe face at $x=1$ is adjacent to element $K_2 = (1/2, 1)$, which has length $h_2 = 1 - 1/2 = 1/2$.\nThe penalty parameter is given by $\\sigma_F = 2/h_F = 2/(1/2) = 4$.\nThe contribution to the RHS for the face at $x=1$ is:\n$$ L_{x=1}(v_h) = (\\sigma_F g_D v_h)|_{x=1} - (a v_h' n g_D)|_{x=1} $$\n$$ L_{x=1}(v_h) = (4 \\cdot 1 \\cdot v_h(1)) - (1 \\cdot v_h'(1) \\cdot 1 \\cdot 1) = 4 v_h(1) - v_h'(1) $$\nThis is the only non-zero source for boundary contributions to the RHS vector.\n\nWe now evaluate this expression for each global basis function $v_h \\in \\{\\phi_{1}^{(1)}, \\phi_{2}^{(1)}, \\phi_{1}^{(2)}, \\phi_{2}^{(2)}\\}$ to assemble the vector of boundary contributions, which we denote as $\\mathbf{b}^{bnd}$.\n\n1.  Test with $v_h = \\phi_1^{(1)}$. This basis function is supported only on element $K_1 = (0, 1/2)$. Thus, $\\phi_1^{(1)}(1) = 0$ and $\\phi_1^{(1)'}(1) = 0$.\n    The contribution is $\\mathbf{b}^{bnd}_1 = 4(0) - 0 = 0$.\n\n2.  Test with $v_h = \\phi_2^{(1)}$. This basis function is also supported only on element $K_1$. Thus, $\\phi_2^{(1)}(1) = 0$ and $\\phi_2^{(1)'}(1) = 0$.\n    The contribution is $\\mathbf{b}^{bnd}_2 = 4(0) - 0 = 0$.\n\n3.  Test with $v_h = \\phi_1^{(2)}$. This basis function is supported on element $K_2 = (1/2, 1)$. Here, $x_L=1/2$ and $x_R=1$, with element length $h_2=1/2$.\n    According to the definition, $\\phi_1^{(2)}(x_L) = \\phi_1^{(2)}(1/2) = 1$ and $\\phi_1^{(2)}(x_R) = \\phi_1^{(2)}(1) = 0$.\n    The derivative is constant: $\\phi_1^{(2)'}(x) = -1/h_2 = -1/(1/2) = -2$.\n    The contribution is:\n    $$ \\mathbf{b}^{bnd}_3 = 4 \\phi_1^{(2)}(1) - \\phi_1^{(2)'}(1) = 4(0) - (-2) = 2 $$\n\n4.  Test with $v_h = \\phi_2^{(2)}$. This basis function is supported on element $K_2 = (1/2, 1)$.\n    According to the definition, $\\phi_2^{(2)}(x_L) = \\phi_2^{(2)}(1/2) = 0$ and $\\phi_2^{(2)}(x_R) = \\phi_2^{(2)}(1) = 1$.\n    The derivative is constant: $\\phi_2^{(2)'}(x) = 1/h_2 = 1/(1/2) = 2$.\n    The contribution is:\n    $$ \\mathbf{b}^{bnd}_4 = 4 \\phi_2^{(2)}(1) - \\phi_2^{(2)'}(1) = 4(1) - (2) = 2 $$\n\nAssembling these components into the global right-hand side vector (boundary terms only) in the specified order gives the final result.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 & 2 & 2 \\end{pmatrix}}\n$$", "id": "2552258"}, {"introduction": "When solving time-dependent PDEs such as the advection equation, the DG method first produces a system of ordinary differential equations (ODEs), a process known as semi-discretization. The properties of the resulting spatial operator matrix are critical, as its spectrum dictates the stability of the subsequent time integration scheme. This exercise [@problem_id:2552265] delves into this crucial link between space and time discretization. By assembling the semi-discrete operator and analyzing its eigenvalues, you will determine the maximum stable time step ($\\Delta t_{\\max}$) for an explicit scheme, a fundamental procedure known as Courant-Friedrichs-Lewy (CFL) stability analysis, providing direct insight into the practical constraints of solving hyperbolic problems with DG methods.", "problem": "Consider the nondimensional one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ on the periodic domain $[0,2h]$, where $a>0$ is a constant advection speed and $h>0$ is the element length. Discretize the domain with a mesh of $2$ elements of equal length $h$, and on each element use a discontinuous Galerkin finite element space of degree $p=1$ spanned by the nodal basis on the reference interval $[-1,1]$ with local basis functions $\\varphi_{1}(\\xi) = \\frac{1-\\xi}{2}$ and $\\varphi_{2}(\\xi) = \\frac{1+\\xi}{2}$. Use the standard weak (once-integrated-by-parts) discontinuous Galerkin formulation with the upwind numerical flux consistent with $a>0$ and periodic boundary conditions.\n\n1. Starting from the weak form over each element, assemble the semi-discrete system $\\dot{\\mathbf{u}} = \\mathbf{A}\\,\\mathbf{u}$, where the global vector of degrees of freedom is ordered as $\\mathbf{u} = \\big(u_{1,L},\\,u_{1,R},\\,u_{2,L},\\,u_{2,R}\\big)^{\\top}$ collecting the left and right nodal values on element $1$ and element $2$, respectively. Explicitly compute the $4\\times 4$ matrix $\\mathbf{A}$ in terms of $a$ and $h$.\n\n2. Using eigenvalue analysis of $\\mathbf{A}$ and the known stability region of the forward Euler time integrator (the set of complex numbers $z$ such that $\\lvert 1 + z \\rvert \\le 1$), determine the maximum stable time step $\\Delta t_{\\max}$ such that forward Euler applied to $\\dot{\\mathbf{u}} = \\mathbf{A}\\,\\mathbf{u}$ is stable. Express your final answer as an exact symbolic expression in terms of $a$ and $h$. All quantities are nondimensional. Do not include units in your answer.", "solution": "The one-dimensional linear advection equation is given by:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\non a periodic domain $[0, 2h]$, with $a > 0$ and $h > 0$. The domain is discretized into two elements, $K_1 = [0, h]$ and $K_2 = [h, 2h]$. On each element $K_j$, the solution $u_h$ is approximated by a polynomial of degree $p=1$.\n\nThe DG weak formulation on an element $K_j = [x_{j-1/2}, x_{j+1/2}]$ is obtained by multiplying the PDE by a test function $v_h$ and integrating over $K_j$:\n$$\n\\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx + \\int_{K_j} a \\frac{\\partial u_h}{\\partial x} v_h \\, dx = 0\n$$\nIntegrating the second term by parts yields:\n$$\n\\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx - \\int_{K_j} a u_h \\frac{\\partial v_h}{\\partial x} \\, dx + [a u_h v_h]_{x_{j-1/2}}^{x_{j+1/2}} = 0\n$$\nThe boundary term is replaced by a numerical flux $\\hat{f}(u_h) = a \\hat{u}_h$:\n$$\n\\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx = \\int_{K_j} a u_h \\frac{\\partial v_h}{\\partial x} \\, dx - \\left( a \\hat{u}_h(x_{j+1/2}) v_h(x_{j+1/2}^-) - a \\hat{u}_h(x_{j-1/2}) v_h(x_{j-1/2}^+) \\right)\n$$\nwhere $v_h(x^\\pm)$ denotes the limit of $v_h$ from within/outside the element. Since $v_h$ is taken from the same space as $u_h$ on element $K_j$, we consider its internal values, so we have $v_h(x_{j-1/2}^+)$ and $v_h(x_{j+1/2}^-)$. For $a>0$, the upwind flux is defined by the value from the left (upwind) side of the interface, i.e., $\\hat{u}_h(x) = u_h(x^-)$.\nAt the right boundary $x_{j+1/2}$ of element $K_j$, the upwind value is $u_h(x_{j+1/2}^-)$.\nAt the left boundary $x_{j-1/2}$ of element $K_j$, the upwind value is taken from the right boundary of the neighboring element to the left, $K_{j-1}$, which is $u_h(x_{j-1/2}^-)$.\nThe weak form becomes:\n$$\n\\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx = \\int_{K_j} a u_h \\frac{\\partial v_h}{\\partial x} \\, dx - a u_h(x_{j+1/2}^-) v_h(x_{j+1/2}^-) + a u_h(x_{j-1/2}^-) v_h(x_{j-1/2}^+)\n$$\nOn each element $K_j$, the solution is expanded in the local nodal basis: $u_h(x, t) = u_{j,L}(t) \\phi_{j,1}(x) + u_{j,R}(t) \\phi_{j,2}(x)$. For calculations, we map each physical element $K_j$ to the reference element $\\hat{K} = [-1, 1]$ using $x(\\xi) = x_{j,c} + \\frac{h}{2}\\xi$, where $x_{j,c}$ is the center of the element. This gives $dx = \\frac{h}{2}d\\xi$ and $\\frac{d}{dx} = \\frac{2}{h}\\frac{d}{d\\xi}$. The basis functions on the reference element are $\\varphi_1(\\xi) = \\frac{1-\\xi}{2}$ and $\\varphi_2(\\xi) = \\frac{1+\\xi}{2}$, with derivatives $\\frac{d\\varphi_1}{d\\xi}=-\\frac{1}{2}$ and $\\frac{d\\varphi_2}{d\\xi}=\\frac{1}{2}$.\n\nChoosing $v_h$ to be one of the basis functions $\\phi_{j,i}$ in turn, we obtain a system of ODEs for each element, $\\mathbf{M} \\dot{\\mathbf{u}}_j = \\mathbf{S} \\mathbf{u}_j + \\mathbf{F}_j$, where $\\mathbf{u}_j = (u_{j,L}, u_{j,R})^\\top$. The elemental mass matrix $\\mathbf{M}$ and stiffness matrix $\\mathbf{S}$ entries are:\n$$\nM_{ik} = \\int_{K_j} \\phi_{j,k} \\phi_{j,i} \\, dx = \\int_{-1}^{1} \\varphi_k(\\xi) \\varphi_i(\\xi) \\frac{h}{2} \\, d\\xi\n$$\n$$\nS_{ik} = \\int_{K_j} a \\phi_{j,k} \\frac{d\\phi_{j,i}}{dx} \\, dx = \\int_{-1}^{1} a \\varphi_k(\\xi) \\left(\\frac{2}{h}\\frac{d\\varphi_i}{d\\xi}\\right) \\frac{h}{2} \\, d\\xi = a \\int_{-1}^{1} \\varphi_k(\\xi) \\frac{d\\varphi_i}{d\\xi} \\, d\\xi\n$$\nCalculating these integrals gives:\n$$\n\\mathbf{M} = \\frac{h}{6}\\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}, \\quad \\mathbf{S} = \\frac{a}{2}\\begin{pmatrix} -1 & -1 \\\\ 1 & 1 \\end{pmatrix}\n$$\nThe right-hand side flux contribution is given by the term $- a u_h(x_{j+1/2}^-) v_h(x_{j+1/2}^-) + a u_h(x_{j-1/2}^-) v_h(x_{j-1/2}^+)$.\nWith $v_h=\\phi_{j,i}$, $u_h(x_{j+1/2}^-) = u_{j,R}$, $u_h(x_{j-1/2}^-) = u_{j-1, R}$, $v_h(x_{j-1/2}^+) = \\varphi_i(-1)$, and $v_h(x_{j+1/2}^-) = \\varphi_i(1)$, the flux terms for equation $i$ on element $j$ assemble into the following right-hand side contributions:\nFor $i=1$: $- a u_{j,R} \\varphi_1(1) + a u_{j-1,R} \\varphi_1(-1) = a u_{j-1,R}$.\nFor $i=2$: $- a u_{j,R} \\varphi_2(1) + a u_{j-1,R} \\varphi_2(-1) = -a u_{j,R}$.\n\nThe semi-discrete system for element $j$ is:\n$$\n\\frac{h}{6}\\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} \\begin{pmatrix} \\dot{u}_{j,L} \\\\ \\dot{u}_{j,R} \\end{pmatrix} = \\frac{a}{2}\\begin{pmatrix} -1 & -1 \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} u_{j,L} \\\\ u_{j,R} \\end{pmatrix} + \\begin{pmatrix} a u_{j-1,R} \\\\ -a u_{j,R} \\end{pmatrix}\n$$\nThis simplifies to:\n$$\n\\frac{h}{6}\\begin{pmatrix} 2\\dot{u}_{j,L} + \\dot{u}_{j,R} \\\\ \\dot{u}_{j,L} + 2\\dot{u}_{j,R} \\end{pmatrix} = \\begin{pmatrix} \\frac{a}{2}(-u_{j,L} - u_{j,R}) + a u_{j-1,R} \\\\ \\frac{a}{2}(u_{j,L} + u_{j,R}) - a u_{j,R} \\end{pmatrix} = \\begin{pmatrix} \\frac{a}{2}(-u_{j,L} - u_{j,R}) + a u_{j-1,R} \\\\ \\frac{a}{2}(u_{j,L} - u_{j,R}) \\end{pmatrix}\n$$\nWith two elements and periodic boundary conditions, we have $j=1, 2$. For $j=1$, $u_{0,R} = u_{2,R}$. For $j=2$, $u_{1,R}$ is used.\nThe global DOF vector is $\\mathbf{u} = (u_{1,L}, u_{1,R}, u_{2,L}, u_{2,R})^\\top$. The global system $\\mathbf{M}_{glob} \\dot{\\mathbf{u}} = \\mathbf{K}_{glob} \\mathbf{u}$ is:\n$$\n\\frac{h}{6}\\begin{pmatrix} 2&1&0&0 \\\\ 1&2&0&0 \\\\ 0&0&2&1 \\\\ 0&0&1&2 \\end{pmatrix} \\begin{pmatrix} \\dot{u}_{1,L} \\\\ \\dot{u}_{1,R} \\\\ \\dot{u}_{2,L} \\\\ \\dot{u}_{2,R} \\end{pmatrix} = a \\begin{pmatrix} -1/2 & -1/2 & 0 & 1 \\\\ 1/2 & -1/2 & 0 & 0 \\\\ 0 & 1 & -1/2 & -1/2 \\\\ 0 & 0 & 1/2 & -1/2 \\end{pmatrix} \\begin{pmatrix} u_{1,L} \\\\ u_{1,R} \\\\ u_{2,L} \\\\ u_{2,R} \\end{pmatrix}\n$$\nTo find $\\mathbf{A}$ in $\\dot{\\mathbf{u}} = \\mathbf{A} \\mathbf{u}$, we compute $\\mathbf{A} = \\mathbf{M}_{glob}^{-1} \\mathbf{K}_{glob}$.\nThe inverse of the block-diagonal mass matrix is $\\mathbf{M}_{glob}^{-1} = \\frac{2}{h} \\begin{pmatrix} 2 & -1 & 0 & 0 \\\\ -1 & 2 & 0 & 0 \\\\ 0 & 0 & 2 & -1 \\\\ 0 & 0 & -1 & 2 \\end{pmatrix}$.\n$$\n\\mathbf{A} = \\frac{2a}{h} \\begin{pmatrix} 2 & -1 & 0 & 0 \\\\ -1 & 2 & 0 & 0 \\\\ 0 & 0 & 2 & -1 \\\\ 0 & 0 & -1 & 2 \\end{pmatrix} \\begin{pmatrix} -1/2 & -1/2 & 0 & 1 \\\\ 1/2 & -1/2 & 0 & 0 \\\\ 0 & 1 & -1/2 & -1/2 \\\\ 0 & 0 & 1/2 & -1/2 \\end{pmatrix}\n$$\nPerforming the matrix multiplication:\n$$\n\\mathbf{A} = \\frac{a}{h} \\begin{pmatrix} 4 & -2 & 0 & 0 \\\\ -2 & 4 & 0 & 0 \\\\ 0 & 0 & 4 & -2 \\\\ 0 & 0 & -2 & 4 \\end{pmatrix} \\begin{pmatrix} -1/2 & -1/2 & 0 & 1 \\\\ 1/2 & -1/2 & 0 & 0 \\\\ 0 & 1 & -1/2 & -1/2 \\\\ 0 & 0 & 1/2 & -1/2 \\end{pmatrix}\n$$\n$$\n\\mathbf{A} = \\frac{a}{h} \\begin{pmatrix} -3 & -1 & 0 & 4 \\\\ 3 & -1 & 0 & -2 \\\\ 0 & 4 & -3 & -1 \\\\ 0 & -2 & 3 & -1 \\end{pmatrix}\n$$\nThis completes the first part of the problem.\n\nFor the second part, we analyze the stability of the forward Euler method, $\\mathbf{u}^{n+1} = \\mathbf{u}^n + \\Delta t \\mathbf{A} \\mathbf{u}^n$. The method is stable if for all eigenvalues $\\lambda_k$ of $\\mathbf{A}$, the value $z_k = \\Delta t \\lambda_k$ lies within the stability region of forward Euler, defined by $|1+z| \\le 1$. For an eigenvalue $\\lambda = \\mathrm{Re}(\\lambda) + i\\,\\mathrm{Im}(\\lambda)$, this condition becomes:\n$$\n|1 + \\Delta t \\lambda|^2 \\le 1 \\implies (1 + \\Delta t \\mathrm{Re}(\\lambda))^2 + (\\Delta t \\mathrm{Im}(\\lambda))^2 \\le 1\n$$\n$$\n1 + 2\\Delta t \\mathrm{Re}(\\lambda) + (\\Delta t)^2 (\\mathrm{Re}(\\lambda)^2 + \\mathrm{Im}(\\lambda)^2) \\le 1\n$$\n$$\n2\\Delta t \\mathrm{Re}(\\lambda) + (\\Delta t)^2 |\\lambda|^2 \\le 0\n$$\nFor stability, all eigenvalues must have non-positive real parts. If $\\mathrm{Re}(\\lambda) < 0$, the condition on $\\Delta t$ is:\n$$\n\\Delta t \\le \\frac{-2 \\mathrm{Re}(\\lambda)}{|\\lambda|^2}\n$$\nThe matrix $\\mathbf{A}$ has a block circulant structure $\\mathbf{A} = \\text{circ}(\\mathbf{A}_{11}, \\mathbf{A}_{12})$, where $\\mathbf{A}_{11} = \\frac{a}{h}\\begin{pmatrix} -3 & -1 \\\\ 3 & -1 \\end{pmatrix}$ and $\\mathbf{A}_{12} = \\frac{a}{h}\\begin{pmatrix} 0 & 4 \\\\ 0 & -2 \\end{pmatrix}$. The eigenvalues of $\\mathbf{A}$ are the eigenvalues of the matrices $\\mathbf{A}_{11} + \\omega^k \\mathbf{A}_{12}$ for $k=0,1$, where $\\omega = e^{i 2\\pi/2} = -1$.\n\nCase 1: $k=0$ ($\\omega^0 = 1$)\nThe eigenvalues are from $\\mathbf{E}_0 = \\mathbf{A}_{11} + \\mathbf{A}_{12} = \\frac{a}{h} \\left( \\begin{pmatrix} -3 & -1 \\\\ 3 & -1 \\end{pmatrix} + \\begin{pmatrix} 0 & 4 \\\\ 0 & -2 \\end{pmatrix} \\right) = \\frac{a}{h} \\begin{pmatrix} -3 & 3 \\\\ 3 & -3 \\end{pmatrix}$.\nThe characteristic equation is $(-3-\\mu)(-3-\\mu) - 9 = 0 \\Rightarrow (\\mu+3)^2=9 \\Rightarrow \\mu+3 = \\pm 3$. This gives eigenvalues $\\mu_1=0$ and $\\mu_2=-6$.\nSo, two eigenvalues of $\\mathbf{A}$ are $\\lambda_1 = 0$ and $\\lambda_2 = -6a/h$.\n\nCase 2: $k=1$ ($\\omega^1 = -1$)\nThe eigenvalues are from $\\mathbf{E}_1 = \\mathbf{A}_{11} - \\mathbf{A}_{12} = \\frac{a}{h} \\left( \\begin{pmatrix} -3 & -1 \\\\ 3 & -1 \\end{pmatrix} - \\begin{pmatrix} 0 & 4 \\\\ 0 & -2 \\end{pmatrix} \\right) = \\frac{a}{h} \\begin{pmatrix} -3 & -5 \\\\ 3 & 1 \\end{pmatrix}$.\nThe characteristic equation is $(-3-\\mu)(1-\\mu) - (-5)(3) = 0 \\Rightarrow \\mu^2 + 2\\mu + 12 = 0$.\nThe roots are $\\mu = \\frac{-2 \\pm \\sqrt{4-48}}{2} = -1 \\pm i\\sqrt{11}$.\nSo, the other two eigenvalues of $\\mathbf{A}$ are $\\lambda_{3,4} = \\frac{a}{h}(-1 \\pm i\\sqrt{11})$.\n\nNow we find the stability limit for each non-zero eigenvalue:\nFor $\\lambda_2 = -6a/h$: $\\mathrm{Re}(\\lambda_2) = -6a/h$, $|\\lambda_2|^2 = 36(a/h)^2$.\n$$\n\\Delta t \\le \\frac{-2(-6a/h)}{36(a/h)^2} = \\frac{12a/h}{36(a/h)^2} = \\frac{1}{3}\\frac{h}{a}\n$$\nFor $\\lambda_{3,4} = \\frac{a}{h}(-1 \\pm i\\sqrt{11})$: $\\mathrm{Re}(\\lambda_{3,4}) = -a/h$, $|\\lambda_{3,4}|^2 = (a/h)^2 ((-1)^2 + (\\pm\\sqrt{11})^2) = 12(a/h)^2$.\n$$\n\\Delta t \\le \\frac{-2(-a/h)}{12(a/h)^2} = \\frac{2a/h}{12(a/h)^2} = \\frac{1}{6}\\frac{h}{a}\n$$\nThe eigenvalue $\\lambda_1=0$ poses no restriction on $\\Delta t$. To ensure stability for all modes, we must take the most restrictive condition, which is the minimum of the calculated time step limits.\n$$\n\\Delta t_{\\max} = \\min\\left(\\frac{1}{3}\\frac{h}{a}, \\frac{1}{6}\\frac{h}{a}\\right) = \\frac{1}{6}\\frac{h}{a}\n$$\nThe Courant-Friedrichs-Lewy (CFL) number for this scheme is $\\frac{a \\Delta t}{h} \\le \\frac{1}{6}$.", "answer": "$$\\boxed{\\frac{h}{6a}}$$", "id": "2552265"}]}