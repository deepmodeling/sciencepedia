{"hands_on_practices": [{"introduction": "The concept of a \"partition of unity\" (PU) is the cornerstone of many advanced numerical methods, including the one this article is about. Before we enrich our approximations, it is essential to have a concrete understanding of what this property means for the standard finite element basis functions. This first exercise will guide you through the fundamental process of constructing the linear basis functions (barycentric coordinates) on a reference triangle from their defining properties and explicitly verifying that they indeed sum to one everywhere in the element ([@problem_id:2586364]).", "problem": "In the context of the Finite Element Method (FEM) and the Partition of Unity Method (PUM), consider the reference triangle $\\hat{T} \\subset \\mathbb{R}^{2}$ with vertices $\\hat{\\boldsymbol{a}}_{1} = (0,0)$, $\\hat{\\boldsymbol{a}}_{2} = (1,0)$, and $\\hat{\\boldsymbol{a}}_{3} = (0,1)$, so that $\\hat{T} = \\{(x,y) \\in \\mathbb{R}^{2} : x \\ge 0, \\, y \\ge 0, \\, x + y \\le 1\\}$. The barycentric coordinates on $\\hat{T}$ are defined as the unique affine functions $\\lambda_{i}(x,y)$ that satisfy the nodal interpolation properties $\\lambda_{i}(\\hat{\\boldsymbol{a}}_{j}) = \\delta_{ij}$ for $i,j \\in \\{1,2,3\\}$, where $\\delta_{ij}$ is the Kronecker delta.\n\nStarting from the defining properties above and the fact that each $\\lambda_{i}(x,y)$ is affine (i.e., of the form $\\alpha + \\beta x + \\gamma y$), construct the three barycentric coordinate functions $\\lambda_{1}(x,y)$, $\\lambda_{2}(x,y)$, and $\\lambda_{3}(x,y)$ on $\\hat{T}$ by solving for their coefficients. Then, using your constructed expressions, form the sum\n$$\nS(x,y) = \\lambda_{1}(x,y) + \\lambda_{2}(x,y) + \\lambda_{3}(x,y)\n$$\nand simplify it explicitly as a function of $x$ and $y$.\n\nYour final answer must be the simplified closed-form analytic expression for $S(x,y)$. No numerical rounding is required, and no units apply. Provide only the simplified expression as the final answer.", "solution": "The problem statement is validated and found to be well-posed and scientifically sound. It is a standard derivation in the theory of finite elements. We will proceed with the construction of the barycentric coordinate functions.\n\nThe problem defines barycentric coordinates, denoted $\\lambda_{i}(x,y)$ for $i \\in \\{1,2,3\\}$, on the reference triangle $\\hat{T}$. These functions are specified to be affine, meaning they take the general form:\n$$ \\lambda_{i}(x,y) = \\alpha_{i} + \\beta_{i} x + \\gamma_{i} y $$\nwhere $\\alpha_{i}$, $\\beta_{i}$, and $\\gamma_{i}$ are real coefficients. The coefficients for each function are uniquely determined by the nodal interpolation property $\\lambda_{i}(\\hat{\\boldsymbol{a}}_{j}) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta and the vertices are $\\hat{\\boldsymbol{a}}_{1} = (0,0)$, $\\hat{\\boldsymbol{a}}_{2} = (1,0)$, and $\\hat{\\boldsymbol{a}}_{3} = (0,1)$. We will now determine the coefficients for each function systematically.\n\nFirst, consider $\\lambda_{1}(x,y)$. The defining conditions are:\n$$ \\lambda_{1}(\\hat{\\boldsymbol{a}}_{1}) = \\lambda_{1}(0,0) = 1 $$\n$$ \\lambda_{1}(\\hat{\\boldsymbol{a}}_{2}) = \\lambda_{1}(1,0) = 0 $$\n$$ \\lambda_{1}(\\hat{\\boldsymbol{a}}_{3}) = \\lambda_{1}(0,1) = 0 $$\n\nSubstituting $(x,y)$ with the vertex coordinates into the affine form $\\lambda_{1}(x,y) = \\alpha_{1} + \\beta_{1} x + \\gamma_{1} y$, we obtain a system of $3$ linear equations for the $3$ unknown coefficients $\\alpha_{1}$, $\\beta_{1}$, $\\gamma_{1}$:\n$$ \\alpha_{1} + \\beta_{1}(0) + \\gamma_{1}(0) = 1 \\implies \\alpha_{1} = 1 $$\n$$ \\alpha_{1} + \\beta_{1}(1) + \\gamma_{1}(0) = 0 \\implies 1 + \\beta_{1} = 0 \\implies \\beta_{1} = -1 $$\n$$ \\alpha_{1} + \\beta_{1}(0) + \\gamma_{1}(1) = 0 \\implies 1 + \\gamma_{1} = 0 \\implies \\gamma_{1} = -1 $$\nThus, the first barycentric coordinate function is $\\lambda_{1}(x,y) = 1 - x - y$.\n\nNext, we construct $\\lambda_{2}(x,y) = \\alpha_{2} + \\beta_{2} x + \\gamma_{2} y$. The conditions are:\n$$ \\lambda_{2}(\\hat{\\boldsymbol{a}}_{1}) = \\lambda_{2}(0,0) = 0 $$\n$$ \\lambda_{2}(\\hat{\\boldsymbol{a}}_{2}) = \\lambda_{2}(1,0) = 1 $$\n$$ \\lambda_{2}(\\hat{\\boldsymbol{a}}_{3}) = \\lambda_{2}(0,1) = 0 $$\n\nThis leads to the following system of equations:\n$$ \\alpha_{2} + \\beta_{2}(0) + \\gamma_{2}(0) = 0 \\implies \\alpha_{2} = 0 $$\n$$ \\alpha_{2} + \\beta_{2}(1) + \\gamma_{2}(0) = 1 \\implies 0 + \\beta_{2} = 1 \\implies \\beta_{2} = 1 $$\n$$ \\alpha_{2} + \\beta_{2}(0) + \\gamma_{2}(1) = 0 \\implies 0 + \\gamma_{2} = 0 \\implies \\gamma_{2} = 0 $$\nTherefore, the second barycentric coordinate function is $\\lambda_{2}(x,y) = x$.\n\nFinally, we construct $\\lambda_{3}(x,y) = \\alpha_{3} + \\beta_{3} x + \\gamma_{3} y$. The conditions are:\n$$ \\lambda_{3}(\\hat{\\boldsymbol{a}}_{1}) = \\lambda_{3}(0,0) = 0 $$\n$$ \\lambda_{3}(\\hat{\\boldsymbol{a}}_{2}) = \\lambda_{3}(1,0) = 0 $$\n$$ \\lambda_{3}(\\hat{\\boldsymbol{a}}_{3}) = \\lambda_{3}(0,1) = 1 $$\n\nThis yields the system:\n$$ \\alpha_{3} + \\beta_{3}(0) + \\gamma_{3}(0) = 0 \\implies \\alpha_{3} = 0 $$\n$$ \\alpha_{3} + \\beta_{3}(1) + \\gamma_{3}(0) = 0 \\implies 0 + \\beta_{3} = 0 \\implies \\beta_{3} = 0 $$\n$$ \\alpha_{3} + \\beta_{3}(0) + \\gamma_{3}(1) = 1 \\implies 0 + \\gamma_{3} = 1 \\implies \\gamma_{3} = 1 $$\nThis gives the third barycentric coordinate function as $\\lambda_{3}(x,y) = y$.\n\nThe problem asks for the sum $S(x,y) = \\lambda_{1}(x,y) + \\lambda_{2}(x,y) + \\lambda_{3}(x,y)$. Substituting the derived expressions:\n$$ S(x,y) = (1 - x - y) + (x) + (y) $$\nSimplifying the expression by collecting terms:\n$$ S(x,y) = 1 + (-x + x) + (-y + y) $$\n$$ S(x,y) = 1 + 0 + 0 = 1 $$\nThe sum of the barycentric coordinates on the reference triangle is a constant, equal to $1$. This is the \"partition of unity\" property for the linear shape functions on a triangular element, which is a fundamental property used in the Finite Element Method. The simplified closed-form expression for $S(x,y)$ is $1$.", "answer": "$$ \\boxed{1} $$", "id": "2586364"}, {"introduction": "One of the most elegant features of the Partition of Unity Method (PUM) is its ability to seamlessly incorporate the existing finite element approximation space. An important consequence is that the enrichment only contributes when the standard basis is insufficient to represent the solution. This exercise ([@problem_id:2586321]) provides a hands-on demonstration of this principle by asking you to reproduce a simple linear field, which the standard basis can already capture perfectly, showing how the method automatically assigns zero weight to the enrichment functions.", "problem": "Consider a single bilinear quadrilateral finite element on the domain $\\Omega = [0,1]\\times[0,1]$ with nodes at coordinates $(x_{1},y_{1})=(0,0)$, $(x_{2},y_{2})=(1,0)$, $(x_{3},y_{3})=(1,1)$, and $(x_{4},y_{4})=(0,1)$. Let the associated standard bilinear shape functions be\n$$\nN_{1}(x,y) = (1 - x)(1 - y),\\quad\nN_{2}(x,y) = x(1 - y),\\quad\nN_{3}(x,y) = xy,\\quad\nN_{4}(x,y) = (1 - x)y,\n$$\nwhich form a partition of unity. Consider an unshifted Partition of Unity Method (PUM), also known as the Generalized Finite Element Method (GFEM), enrichment with a single nonpolynomial enrichment function\n$$\nL(x,y) = \\sqrt{(x - \\tfrac{1}{2})^{2} + (y - \\tfrac{1}{2})^{2}},\n$$\napplied at all nodes. The enriched trial space on this element is taken as\n$$\nu_{h}(x,y) = \\sum_{i=1}^{4} N_{i}(x,y)\\,a_{i} \\;+\\; \\sum_{i=1}^{4} N_{i}(x,y)\\,L(x,y)\\,b_{i},\n$$\nwhere $\\{a_{i}\\}_{i=1}^{4}$ are the standard degrees of freedom and $\\{b_{i}\\}_{i=1}^{4}$ are the enrichment degrees of freedom.\n\nUsing only the defining properties of the bilinear shape functions (partition of unity and linear reproduction) and the above enrichment construction, determine the unique set of nodal coefficients $\\{a_{i}\\}_{i=1}^{4}$ and $\\{b_{i}\\}_{i=1}^{4}$ such that $u_{h}(x,y)$ reproduces exactly the target field $u(x,y)=x+y$ for all $(x,y)\\in\\Omega$. Then verify, by derivation from first principles, that the resulting $u_{h}(x,y)$ equals $x+y$ identically over $\\Omega$.\n\nExpress your final answer as a single row matrix containing the ordered coefficients\n$$\n[a_{1}\\; a_{2}\\; a_{3}\\; a_{4}\\; b_{1}\\; b_{2}\\; b_{3}\\; b_{4}],\n$$\nand do not include any units. No rounding is required.", "solution": "The problem will first be validated for scientific soundness, self-consistency, and well-posedness.\n\nStep 1: Extract Givens\n- Domain: $\\Omega = [0,1]\\times[0,1]$.\n- Element: A single bilinear quadrilateral finite element.\n- Nodal Coordinates: $(x_{1},y_{1})=(0,0)$, $(x_{2},y_{2})=(1,0)$, $(x_{3},y_{3})=(1,1)$, and $(x_{4},y_{4})=(0,1)$.\n- Shape Functions:\n  - $N_{1}(x,y) = (1 - x)(1 - y)$\n  - $N_{2}(x,y) = x(1 - y)$\n  - $N_{3}(x,y) = xy$\n  - $N_{4}(x,y) = (1 - x)y$\n- Enrichment Function: $L(x,y) = \\sqrt{(x - \\frac{1}{2})^{2} + (y - \\frac{1}{2})^{2}}$.\n- Enriched Trial Space: $u_{h}(x,y) = \\sum_{i=1}^{4} N_{i}(x,y)\\,a_{i} \\;+\\; \\sum_{i=1}^{4} N_{i}(x,y)\\,L(x,y)\\,b_{i}$.\n- Target Field for Reproduction: $u(x,y)=x+y$.\n- Task: Determine the nodal coefficients $\\{a_{i}\\}_{i=1}^{4}$ and $\\{b_{i}\\}_{i=1}^{4}$ such that $u_{h}(x,y) = x+y$ for all $(x,y)\\in\\Omega$, and verify the result.\n\nStep 2: Validate Using Extracted Givens\nThe problem is well-defined within the mathematical framework of the Partition of Unity Method (PUM), also known as the Generalized/eXtended Finite Element Method (GFEM/XFEM).\n- **Scientifically Grounded**: The concepts presented—bilinear shape functions, partition of unity, enrichment, and linear reproduction—are standard and fundamental in computational mechanics and numerical analysis. The shape functions provided are the correct ones for a bilinear element on the unit square. They demonstrably form a partition of unity, as $\\sum_{i=1}^{4} N_i(x,y)=1$.\n- **Well-Posed**: The problem requires finding a set of coefficients for a given basis that exactly reproduces a target function. As the target function is a simple polynomial and the basis functions are well-behaved, a unique solution is expected. The problem is neither underspecified nor overconstrained.\n- **Objective**: The problem statement is composed of precise mathematical definitions and leaves no room for subjective interpretation.\n\nStep 3: Verdict and Action\nThe problem is valid. It is a straightforward test of understanding fundamental properties of finite element shape functions and their use in enriched approximation schemes. A solution will be derived.\n\nThe task is to find a unique set of constant coefficients $\\{a_i\\}_{i=1}^4$ and $\\{b_i\\}_{i=1}^4$ such that the enriched approximation $u_h(x,y)$ exactly reproduces the linear field $u(x,y) = x+y$ over the entire element domain $\\Omega$. The condition is:\n$$ u_{h}(x,y) = \\sum_{i=1}^{4} N_{i}(x,y)\\,a_{i} \\;+\\; \\sum_{i=1}^{4} N_{i}(x,y)\\,L(x,y)\\,b_{i} = x+y, \\quad \\forall (x,y) \\in \\Omega $$\nThe bilinear shape functions $\\{N_i\\}_{i=1}^4$ possess the property of linear reproduction. This means that the standard finite element approximation, $u_{std}(x,y) = \\sum_{i=1}^{4} N_{i}(x,y)u_i$, can represent any linear polynomial $p(x,y)=c_0+c_1x+c_2y$ exactly, provided the nodal degrees of freedom $u_i$ are set to the exact values of the polynomial at the nodes, i.e., $u_i = p(x_i, y_i)$.\n\nOur target function is $u(x,y) = x+y$, which is a linear polynomial. Let us calculate its values at the four nodes of the element:\n- $u_1 = u(x_1, y_1) = u(0,0) = 0+0 = 0$\n- $u_2 = u(x_2, y_2) = u(1,0) = 1+0 = 1$\n- $u_3 = u(x_3, y_3) = u(1,1) = 1+1 = 2$\n- $u_4 = u(x_4, y_4) = u(0,1) = 0+1 = 1$\n\nBy the linear reproduction property, it is a known identity that:\n$$ \\sum_{i=1}^{4} N_{i}(x,y) u_i = \\sum_{i=1}^{4} N_i(x,y) u(x_i, y_i) = x+y $$\nWe now have two expressions for the same function $x+y$. Equating them yields:\n$$ \\sum_{i=1}^{4} N_{i}(x,y)\\,a_{i} \\;+\\; \\sum_{i=1}^{4} N_{i}(x,y)\\,L(x,y)\\,b_{i} = \\sum_{i=1}^{4} N_{i}(x,y)\\,u_i $$\nRearranging the terms, we obtain a homogeneous equation:\n$$ \\sum_{i=1}^{4} (a_{i} - u_i) N_{i}(x,y) \\;+\\; \\sum_{i=1}^{4} b_{i} \\left(N_{i}(x,y)L(x,y)\\right) = 0 $$\nThis equation represents a linear combination of the $8$ basis functions of the trial space, $\\{\\{N_i\\}_{i=1}^4, \\{N_i L\\}_{i=1}^4\\}$, which must equal zero for all $(x,y) \\in \\Omega$.\nFor the coefficients of this combination to be uniquely determined as zero, the set of basis functions must be linearly independent. Let us prove this. Assume for some constants $\\{c_i\\}$ and $\\{d_i\\}$:\n$$ \\sum_{i=1}^{4} c_i N_i(x,y) + \\sum_{i=1}^{4} d_i N_i(x,y)L(x,y) = 0 $$\nThis can be written as $P(x,y) + Q(x,y)L(x,y) = 0$, where $P(x,y) = \\sum c_i N_i(x,y)$ and $Q(x,y) = \\sum d_i N_i(x,y)$ are both bilinear polynomials. If $Q(x,y)$ is not identically zero, then $L(x,y) = -P(x,y)/Q(x,y)$. The right-hand side is a rational function of $x$ and $y$. The left-hand side, $L(x,y)=\\sqrt{(x-\\frac{1}{2})^2 + (y-\\frac{1}{2})^2}$, is an irrational algebraic function. A non-constant irrational function cannot be identically equal to a rational function. Thus, the premise that $Q(x,y)$ is not identically zero must be false.\nSo, we must have $Q(x,y) \\equiv 0$. The equation becomes $\\sum_{i=1}^{4} d_i N_i(x,y) = 0$. Since the standard bilinear shape functions $\\{N_i\\}_{i=1}^4$ are linearly independent, this implies $d_i=0$ for all $i=1,2,3,4$.\nThe original equation then reduces to $P(x,y) \\equiv 0$, which is $\\sum_{i=1}^{4} c_i N_i(x,y) = 0$. Again, due to the linear independence of $\\{N_i\\}$, we must have $c_i=0$ for all $i=1,2,3,4$.\nThis proves that the set of $8$ basis functions is linearly independent.\nTherefore, for the homogeneous equation to hold, all of its coefficients must be zero:\n1. $a_i - u_i = 0 \\implies a_i = u_i$ for $i=1,2,3,4$.\n2. $b_i = 0$ for $i=1,2,3,4$.\n\nSubstituting the calculated nodal values $u_i$:\n- $a_1 = u_1 = 0$\n- $a_2 = u_2 = 1$\n- $a_3 = u_3 = 2$\n- $a_4 = u_4 = 1$\n- $b_1 = 0, b_2 = 0, b_3 = 0, b_4 = 0$\n\nThis result is conceptually sound: if the standard part of the approximation space is sufficient to represent the solution exactly, the coefficients for the enrichment part must be zero.\n\nFinally, we must verify by direct derivation that these coefficients yield the desired function.\nWith the determined coefficients, $u_h(x,y)$ becomes:\n$$ u_h(x,y) = a_1 N_1(x,y) + a_2 N_2(x,y) + a_3 N_3(x,y) + a_4 N_4(x,y) + \\sum_{i=1}^{4} 0 \\cdot N_i(x,y)L(x,y) $$\n$$ u_h(x,y) = 0 \\cdot (1-x)(1-y) + 1 \\cdot x(1-y) + 2 \\cdot xy + 1 \\cdot (1-x)y $$\n$$ u_h(x,y) = 0 + x(1-y) + 2xy + (1-x)y $$\n$$ u_h(x,y) = x - xy + 2xy + y - xy $$\n$$ u_h(x,y) = x + y + (-xy + 2xy - xy) $$\n$$ u_h(x,y) = x + y $$\nThe verification is complete. The approximation $u_h(x,y)$ with the derived coefficients is identically equal to the target function $u(x,y)=x+y$ over the domain $\\Omega$.\n\nThe final answer is the ordered set of coefficients $[a_1, a_2, a_3, a_4, b_1, b_2, b_3, b_4]$.\n$[0, 1, 2, 1, 0, 0, 0, 0]$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 1 & 2 & 1 & 0 & 0 & 0 & 0\n\\end{pmatrix}\n}\n$$", "id": "2586321"}, {"introduction": "The true power of partition of unity enrichment is realized when modeling complex physical phenomena that are intractable for standard FEM, such as cracks. In the eXtended Finite Element Method (XFEM), specific enrichment functions are applied to nodes near the crack to capture discontinuities and singularities. This final practice ([@problem_id:2586354]) simulates a critical step in setting up an XFEM analysis: applying the enrichment rules to a discretized domain with a crack to determine which nodes require special treatment and to quantify the resulting increase in computational cost.", "problem": "Consider a two-dimensional linear elasticity problem on the square domain $\\Omega = [0,2]\\times[0,2]$ discretized by a uniform mesh of linear triangular elements obtained by subdividing each unit square into two triangles along the lower-left to upper-right diagonal. The nodal coordinates are at integer grid points $(i,j)$ with $i,j\\in\\{0,1,2\\}$. Number the nodes as follows: node $1$ at $(0,0)$, node $2$ at $(1,0)$, node $3$ at $(2,0)$, node $4$ at $(0,1)$, node $5$ at $(1,1)$, node $6$ at $(2,1)$, node $7$ at $(0,2)$, node $8$ at $(1,2)$, and node $9$ at $(2,2)$. The eight triangular elements have the following vertex connectivity (by node numbers): element $E_{1}=(1,2,5)$, element $E_{2}=(1,5,4)$, element $E_{3}=(2,3,6)$, element $E_{4}=(2,6,5)$, element $E_{5}=(4,5,8)$, element $E_{6}=(4,8,7)$, element $E_{7}=(5,6,9)$, and element $E_{8}=(5,9,8)$.\n\nA straight crack $\\Gamma$ is present. Its tip is located at $\\boldsymbol{x}_{\\mathrm{tip}}=(0.75,0.6)$, lying strictly inside the triangular element $E_{1}$, and the crack extends horizontally to the right boundary along the line segment from $(0.75,0.6)$ to $(2,0.6)$. Assume the crack does not coincide with any element edge or node other than where specified and intersects element interiors transversely.\n\nAdopt the partition of unity framework and the eXtended Finite Element Method (XFEM) enrichment strategy with the following precise selection rules:\n- Heaviside enrichment: assign the discontinuous Heaviside function $H(\\boldsymbol{x})$ to all nodes belonging to any element whose interior is intersected by the interior of $\\Gamma$, except nodes that belong to any element containing the crack tip. Do not assign Heaviside enrichment to nodes that receive crack-tip enrichment.\n- Crack-tip enrichment: assign the four standard Linear Elastic Fracture Mechanics (LEFM) branch functions $F_{m}(\\boldsymbol{x})$, $m\\in\\{1,2,3,4\\}$, to all nodes of the unique triangular element that contains $\\boldsymbol{x}_{\\mathrm{tip}}$ in its interior.\n- Use the shifted enrichment (subtract the enrichment function value at the node), but note that this does not alter degree-of-freedom counting.\n- The primary unknown is the displacement vector field in plane problems, which has $d=2$ components per node.\n\nStarting from the partition of unity concept and these enrichment selection rules, determine which specific nodes receive Heaviside enrichment and which receive crack-tip enrichment. Then compute the total number of additional degrees of freedom introduced by these enrichments relative to the standard (unenriched) linear triangular displacement-based finite element approximation.\n\nProvide only the total number of additional degrees of freedom as your final answer. No rounding is required.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nFirst, the givens are extracted verbatim.\nDomain: $\\Omega = [0,2]\\times[0,2]$.\nMesh: Uniform mesh of linear triangular elements from subdividing unit squares along the lower-left to upper-right diagonal.\nNodal coordinates: $(i,j)$ with $i,j\\in\\{0,1,2\\}$.\nNode numbering: node $1$ at $(0,0)$, node $2$ at $(1,0)$, node $3$ at $(2,0)$, node $4$ at $(0,1)$, node $5$ at $(1,1)$, node $6$ at $(2,1)$, node $7$ at $(0,2)$, node $8$ at $(1,2)$, node $9$ at $(2,2)$.\nElement connectivity: $E_{1}=(1,2,5)$, $E_{2}=(1,5,4)$, $E_{3}=(2,3,6)$, $E_{4}=(2,6,5)$, $E_{5}=(4,5,8)$, $E_{6}=(4,8,7)$, $E_{7}=(5,6,9)$, and $E_{8}=(5,9,8)$.\nCrack geometry: Crack tip $\\boldsymbol{x}_{\\mathrm{tip}}=(0.75,0.6)$; crack $\\Gamma$ is a line segment from $(0.75,0.6)$ to $(2,0.6)$.\nEnrichment rules:\n1.  Heaviside enrichment ($H(\\boldsymbol{x})$): Applied to all nodes of any element whose interior is intersected by the interior of $\\Gamma$, but not to nodes belonging to any element containing the crack tip.\n2.  Crack-tip enrichment (four LEFM functions, $F_{m}(\\boldsymbol{x})$): Applied to all nodes of the unique element containing the crack tip.\nDimensionality: $d=2$ (plane problem).\n\nThe problem is validated against the required criteria. It is scientifically grounded, rooted in the standard theory of the eXtended Finite Element Method (XFEM) for linear elastic fracture mechanics. The mesh, crack geometry, and enrichment rules are defined unambiguously, making the problem well-posed and objective. All necessary information is provided, and there are no internal contradictions. For instance, the element connectivity, when analyzed, correctly corresponds to the described subdivision of unit squares. The location of the crack tip and path are precisely specified. The enrichment rules, while specific, are clear and follow a logical structure common in XFEM. Therefore, the problem is deemed valid and a full solution is warranted.\n\nThe solution requires determining the number of additional degrees of freedom (DOFs) introduced by the XFEM enrichments. This is a two-part calculation: one for crack-tip enrichment and one for Heaviside enrichment.\n\nStep 1: Identify nodes for crack-tip enrichment.\nThe rule states that all nodes of the unique triangular element containing the crack tip $\\boldsymbol{x}_{\\mathrm{tip}}$ in its interior are to be enriched with the $4$ crack-tip branch functions $F_m(\\boldsymbol{x})$.\nThe crack tip is at $\\boldsymbol{x}_{\\mathrm{tip}}=(0.75, 0.6)$. This point lies within the unit square $[0,1] \\times [0,1]$.\nThis square is partitioned into two triangular elements: $E_1$, with nodes $(1,2,5)$ corresponding to vertices $(0,0),(1,0),(1,1)$, and $E_2$, with nodes $(1,5,4)$ corresponding to vertices $(0,0),(1,1),(0,1)$.\nThe common edge for $E_1$ and $E_2$ is the segment connecting node $1$ and node $5$, which is the line $y=x$ for $x \\in [0,1]$.\nFor the crack tip location $(0.75, 0.6)$, we have $y=0.6$ and $x=0.75$. Since $0.6 < 0.75$, the point $(0.75, 0.6)$ lies in the region $y < x$, which corresponds to the interior of element $E_1$. The problem statement also confirms that the tip lies in $E_1$.\nTherefore, the nodes of element $E_1$ receive the crack-tip enrichment. The set of these nodes, which we denote as $N_{\\text{tip}}$, is $\\{1, 2, 5\\}$.\nThe number of nodes for crack-tip enrichment is $|N_{\\text{tip}}| = 3$.\n\nStep 2: Identify nodes for Heaviside enrichment.\nThe rule states that the Heaviside function $H(\\boldsymbol{x})$ is assigned to all nodes belonging to any element whose interior is intersected by the interior of the crack $\\Gamma$, with the exclusion of any node that belongs to an element containing the crack tip.\nFirst, we must identify all elements intersected by the crack $\\Gamma$. The crack is the horizontal line segment from $(0.75,0.6)$ to $(2,0.6)$.\nThe crack starts in element $E_1$ at $x=0.75$. It extends to the edge of $E_1$ at $x=1$. So, $E_1$ is an intersected element.\nFor $x \\in [1,2]$, the crack lies at $y=0.6$. We examine the elements in this region. The square $[1,2]\\times[0,1]$ is composed of elements $E_3$ and $E_4$.\n$E_3$ has vertices $(1,0),(2,0),(2,1)$. It is bounded by the lines $y=0$, $x=2$, and $y=x-1$. A point $(x,y)$ is in $E_3$ if $y \\ge 0$, $x \\le 2$, and $y \\le x-1$. The crack line $y=0.6$ is inside $E_3$ if $0.6 \\le x-1$, which means $x \\ge 1.6$. Thus, the crack intersects $E_3$ for $x \\in [1.6, 2]$.\n$E_4$ has vertices $(1,0),(2,1),(1,1)$. It is bounded by the lines $x=1$, $y=1$, and $y=x-1$. A point $(x,y)$ is in $E_4$ if $x \\ge 1$, $y \\le 1$, and $y \\ge x-1$. The crack line $y=0.6$ is inside $E_4$ if $0.6 \\ge x-1$, which means $x \\le 1.6$. Thus, the crack intersects $E_4$ for $x \\in [1, 1.6]$.\nNo other elements are intersected by the crack path $y=0.6$, $x \\in [0.75, 2]$.\nThe set of all elements intersected by the crack is $S_{\\text{split}} = \\{E_1, E_3, E_4\\}$.\nThe set of all nodes belonging to these intersected elements is $N_{\\text{split\\_nodes}} = N(E_1) \\cup N(E_3) \\cup N(E_4) = \\{1,2,5\\} \\cup \\{2,3,6\\} \\cup \\{2,6,5\\} = \\{1,2,3,5,6\\}$.\nThe exclusion rule removes all nodes that belong to any element containing the crack tip. The tip element is $E_1$. Its nodes are $N(E_1)=\\{1,2,5\\}$.\nThe set of Heaviside-enriched nodes, $N_{H}$, is therefore $N_{\\text{split\\_nodes}} \\setminus N(E_1) = \\{1,2,3,5,6\\} \\setminus \\{1,2,5\\} = \\{3,6\\}$.\nThe number of nodes for Heaviside enrichment is $|N_{H}| = 2$.\n\nStep 3: Calculate the total number of additional degrees of freedom.\nThe problem is $2$-dimensional, so $d=2$. Each enrichment function applied to a node introduces $d=2$ additional DOFs.\nNumber of additional DOFs from crack-tip enrichment:\nThis is given by the number of tip-enriched nodes, multiplied by the number of tip functions, multiplied by the problem dimension.\nDOFs$_{\\text{tip}} = |N_{\\text{tip}}| \\times 4 \\times d = 3 \\times 4 \\times 2 = 24$.\nNumber of additional DOFs from Heaviside enrichment:\nThis is given by the number of Heaviside-enriched nodes, multiplied by the number of Heaviside functions (which is $1$), multiplied by the problem dimension.\nDOFs$_{H} = |N_{H}| \\times 1 \\times d = 2 \\times 1 \\times 2 = 4$.\nThe total number of additional degrees of freedom is the sum of these two contributions.\nTotal additional DOFs = DOFs$_{\\text{tip}}$ + DOFs$_{H} = 24 + 4 = 28$.", "answer": "$$\n\\boxed{28}\n$$", "id": "2586354"}]}