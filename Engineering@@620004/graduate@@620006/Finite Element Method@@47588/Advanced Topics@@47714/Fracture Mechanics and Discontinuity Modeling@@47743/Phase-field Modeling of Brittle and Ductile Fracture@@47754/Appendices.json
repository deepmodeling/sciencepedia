{"hands_on_practices": [{"introduction": "Implementing a phase-field model within a finite element framework relies on robust numerical solution schemes, typically based on Newton's method. This, in turn, requires the consistent linearization of the governing equations, which gives rise to the algorithmic tangent modulus. This practice provides a foundational exercise in deriving the stress and the algorithmic tangent for a 1D bar model, highlighting the special care needed to handle the non-differentiable tension-compression split, a crucial skill for developing stable and efficient simulations [@problem_id:2587040].", "problem": "A one-dimensional small-strain bar is modeled by a phase-field approach to fracture within the Finite Element Method (FEM). The elastic free energy density of the undamaged material is taken as quadratic in strain, and a tension–compression split is adopted to prevent damage evolution under compression. The split is performed on the strain energy, with the positive (tensile) and negative (compressive) parts defined via the Macaulay brackets as follows. Let the small strain be $\\varepsilon$. Define $\\langle x \\rangle_{+} = \\max(x,0)$ and $\\langle x \\rangle_{-} = \\min(x,0)$. The undamaged energy density is $\\psi_{0}(\\varepsilon) = \\frac{1}{2} E \\varepsilon^{2}$ with Young’s modulus $E > 0$, and the split energies are\n$$\n\\psi_{0}^{+}(\\varepsilon) = \\tfrac{1}{2} E \\langle \\varepsilon \\rangle_{+}^{2},\n\\qquad\n\\psi_{0}^{-}(\\varepsilon) = \\tfrac{1}{2} E \\langle \\varepsilon \\rangle_{-}^{2}.\n$$\nDegradation is applied only to the tensile energy via a scalar degradation function $g(d)$, where the damage variable satisfies $0 \\le d \\le 1$. Consider the widely used choice\n$$\ng(d) = (1-d)^{2} + k,\n$$\nwith a small residual stiffness $k \\in (0,1)$. The degraded elastic free energy density reads\n$$\n\\psi(\\varepsilon,d) = g(d)\\,\\psi_{0}^{+}(\\varepsilon) + \\psi_{0}^{-}(\\varepsilon).\n$$\nAssume that during a global Newton iteration in the finite element solution, the damage variable $d$ is held fixed at a local Gauss point, and the algorithmic (consistent) tangent modulus entering the linearization is $C_{\\mathrm{alg}} = \\frac{\\partial \\sigma}{\\partial \\varepsilon}$, where the Cauchy stress is defined by hyperelasticity as $\\sigma(\\varepsilon,d) = \\frac{\\partial \\psi(\\varepsilon,d)}{\\partial \\varepsilon}$.\n\nStarting from the given free-energy decomposition and definitions, derive the piecewise expression for $\\sigma(\\varepsilon,d)$ and for the algorithmic tangent modulus $C_{\\mathrm{alg}}(\\varepsilon,d) = \\frac{\\partial \\sigma}{\\partial \\varepsilon}$ in one dimension, taking care of the tension–compression split. Then, evaluate the algorithmic tangent modulus for the parameters $E = 210 \\text{ GPa}$, $k = 1.0 \\times 10^{-6}$, $d = 0.6$, and strain $\\varepsilon = 2.0 \\times 10^{-3}$.\n\nRound your final numerical answer to four significant figures and express it in $\\text{GPa}$. Your final reported answer must be only the value of the algorithmic tangent modulus at the specified state.", "solution": "We begin from the given hyperelastic free energy density with tension–compression split,\n$$\n\\psi(\\varepsilon,d) = g(d)\\,\\psi_{0}^{+}(\\varepsilon) + \\psi_{0}^{-}(\\varepsilon),\n\\qquad\n\\psi_{0}^{+}(\\varepsilon) = \\tfrac{1}{2} E \\langle \\varepsilon \\rangle_{+}^{2},\n\\qquad\n\\psi_{0}^{-}(\\varepsilon) = \\tfrac{1}{2} E \\langle \\varepsilon \\rangle_{-}^{2},\n$$\nand degradation function $g(d) = (1-d)^{2} + k$ with $0  k \\ll 1$.\n\nBy hyperelasticity, the Cauchy stress is the derivative of the free energy with respect to strain,\n$$\n\\sigma(\\varepsilon,d) = \\frac{\\partial \\psi}{\\partial \\varepsilon}(\\varepsilon,d).\n$$\nTo compute this derivative, we use the properties of the Macaulay brackets. Recall that\n$$\n\\langle \\varepsilon \\rangle_{+} =\n\\begin{cases}\n\\varepsilon,  \\varepsilon \\ge 0,\\\\\n0,  \\varepsilon  0,\n\\end{cases}\n\\qquad\n\\langle \\varepsilon \\rangle_{-} =\n\\begin{cases}\n0,  \\varepsilon \\ge 0,\\\\\n\\varepsilon,  \\varepsilon  0,\n\\end{cases}\n$$\nand note that $\\varepsilon \\mapsto \\frac{1}{2}E\\langle \\varepsilon \\rangle_{\\pm}^{2}$ is differentiable for $\\varepsilon \\neq 0$ with derivatives\n$$\n\\frac{\\partial}{\\partial \\varepsilon}\\!\\left(\\tfrac{1}{2}E\\langle \\varepsilon \\rangle_{+}^{2}\\right) =\n\\begin{cases}\nE \\varepsilon,  \\varepsilon  0,\\\\\n0,  \\varepsilon  0,\n\\end{cases}\n\\qquad\n\\frac{\\partial}{\\partial \\varepsilon}\\!\\left(\\tfrac{1}{2}E\\langle \\varepsilon \\rangle_{-}^{2}\\right) =\n\\begin{cases}\n0,  \\varepsilon  0,\\\\\nE \\varepsilon,  \\varepsilon  0.\n\\end{cases}\n$$\nThe point $\\varepsilon=0$ is a kink where the derivative is not unique, but in finite element computations this set has measure zero and one treats each side separately. Therefore, for $\\varepsilon \\ne 0$,\n$$\n\\sigma(\\varepsilon,d)\n= g(d)\\,E\\,\\langle \\varepsilon \\rangle_{+} + E\\,\\langle \\varepsilon \\rangle_{-}\n=\n\\begin{cases}\ng(d)\\,E\\,\\varepsilon,  \\varepsilon  0,\\\\\nE\\,\\varepsilon,  \\varepsilon  0.\n\\end{cases}\n$$\n\nThe algorithmic (consistent) tangent modulus for a Newton iteration with fixed $d$ is the derivative of $\\sigma(\\varepsilon,d)$ with respect to $\\varepsilon$,\n$$\nC_{\\mathrm{alg}}(\\varepsilon,d) = \\frac{\\partial \\sigma}{\\partial \\varepsilon}(\\varepsilon,d).\n$$\nDifferentiating the piecewise expression for $\\sigma$ and holding $d$ fixed gives\n$$\nC_{\\mathrm{alg}}(\\varepsilon,d) =\n\\begin{cases}\ng(d)\\,E,  \\varepsilon  0,\\\\\nE,  \\varepsilon  0.\n\\end{cases}\n$$\n\nWe now evaluate this expression at the specified state. The parameters are\n$$\nE = 210 \\text{ GPa}, \\quad k = 1.0 \\times 10^{-6}, \\quad d = 0.6, \\quad \\varepsilon = 2.0 \\times 10^{-3}.\n$$\nSince $\\varepsilon = 2.0 \\times 10^{-3} > 0$, we use the tensile branch,\n$$\nC_{\\mathrm{alg}} = g(d)\\,E.\n$$\nCompute the degradation function:\n$$\ng(d) = (1-d)^{2} + k = (1 - 0.6)^{2} + 1.0 \\times 10^{-6} = (0.4)^{2} + 1.0 \\times 10^{-6} = 0.16 + 1.0 \\times 10^{-6} = 0.160001.\n$$\nTherefore,\n$$\nC_{\\mathrm{alg}} = 0.160001 \\times 210 \\text{ GPa} = 33.60021 \\text{ GPa}.\n$$\nRounding to four significant figures yields\n$$\nC_{\\mathrm{alg}} \\approx 33.60 \\text{ GPa}.\n$$", "answer": "$$\\boxed{33.60}$$", "id": "2587040"}, {"introduction": "A predictive physical model requires parameters that are well-calibrated to physical reality. Phase-field models introduce parameters like the critical energy release rate, $G_c$, and the length scale, $\\ell$, which must be connected to measurable material properties. This exercise bridges the gap between abstract theory and practical experiment by guiding you through the derivation of calibration formulas that link the model's internal parameters to macroscopic test data, such as the material's tensile strength and the width of the fracture process zone, a critical step in applying these models to engineering problems [@problem_id:2587016].", "problem": "Consider a one-dimensional small-strain uniaxial bar of length $L$ and cross-sectional area $A$ subjected to monotonically increasing tensile displacement at its ends, modeled using a brittle phase-field approach of Ambrosio-Tortorelli type (AT2). Let $u(x)$ denote the displacement and $d(x) \\in [0,1]$ the crack phase-field variable, where $d=0$ corresponds to the intact state and $d=1$ to the fully broken state. Assume linear elastic constitutive behavior with Young’s modulus $E$, and adopt the standard AT2 energy regularization for brittle fracture with internal length scale $\\ell$ and critical energy release rate $G_c$.\n\nThe total energy functional per unit area (suppressing the constant cross-section and integrating over the bar) is given by\n$$\n\\mathcal{E}[u,d] \\;=\\; \\int_{0}^{L} \\left( g(d)\\,\\psi_e(\\varepsilon(u)) \\;+\\; G_c\\,\\gamma_\\ell(d,d') \\right)\\,\\mathrm{d}x,\n$$\nwith the small-strain tensor reduced to the one-dimensional strain $\\varepsilon(u)=u'(x)$, the elastic energy density $\\psi_e(\\varepsilon) = \\tfrac{1}{2}E\\,\\varepsilon^2$, the degradation function $g(d)=(1-d)^2+\\eta$ with $\\eta \\to 0^{+}$, and the crack surface density\n$$\n\\gamma_\\ell(d,d') \\;=\\; \\frac{1}{2\\ell}\\,d^2 \\;+\\; \\frac{\\ell}{2}\\,(d')^2.\n$$\n\nStarting from the calculus of variations and energy minimization principles, and employing only the above definitions and standard small-strain linear elasticity, perform the following:\n\n1) Derive the stationarity condition with respect to the uniform phase-field $d$ for a homogeneous strain $\\varepsilon$ state, and from it obtain the nominal stress $\\sigma(\\varepsilon)$ as a function of $\\varepsilon$ at energetic stationarity. Using a bifurcation-onset argument for softening in a displacement-controlled test, determine the critical nominal stress $\\sigma_c$ at which the homogeneous response reaches a peak and begins to degrade. Your derivation must explicitly show how the scaling of $\\sigma_c$ depends on $E$, $G_c$, and $\\ell$, based solely on the provided energy structure.\n\n2) Consider the zero-load stationary isolated-crack profile in an infinite one-dimensional domain, determined by minimizing only the fracture regularization term subject to $d(0)=1$ and $\\lim_{|x|\\to\\infty}d(x)=0$. Derive the closed-form solution for $d(x)$ and use it to define the full width at half maximum $w$ of the phase-field profile, i.e., the distance between the two points where $d(x)=\\tfrac{1}{2}$. Express $w$ in terms of $\\ell$.\n\n3) Use your results from (1) and (2) to eliminate $\\ell$ and $G_c$ in favor of measurable quantities. Given the elastic modulus $E$, a measured critical nominal stress $\\sigma_c$ at peak load, and a measured full width at half maximum $w$ of the observed damage band, derive explicit calibration formulas for $G_c$ and $\\ell$ using the AT2 model equations you obtained.\n\n4) Implement a program that, for each test case below, takes as inputs $E$ (in pascals), $\\sigma_c$ (in pascals), and $w$ (in meters), computes $\\ell$ (in meters) and $G_c$ (in joules per square meter), and returns the pair $(G_c,\\ell)$.\n\nUse the following test suite (each test is a triple $(E,\\sigma_c,w)$ in SI units):\n- Test 1: $(7.0\\times 10^{10},\\; 3.0\\times 10^{8},\\; 6.0\\times 10^{-4})$\n- Test 2: $(2.10\\times 10^{11},\\; 1.0\\times 10^{9},\\; 2.0\\times 10^{-4})$\n- Test 3: $(3.0\\times 10^{9},\\; 6.0\\times 10^{7},\\; 3.0\\times 10^{-3})$\n- Test 4: $(5.0\\times 10^{10},\\; 2.0\\times 10^{8},\\; 1.0\\times 10^{-6})$\n\nFinal output requirements:\n- Units: Report $G_c$ in joules per square meter and $\\ell$ in meters.\n- Output format: Your program should produce a single line of output containing the results for all tests as a comma-separated list enclosed in square brackets, with pairs flattened in order, namely $[G_{c}^{(1)},\\ell^{(1)},G_{c}^{(2)},\\ell^{(2)},G_{c}^{(3)},\\ell^{(3)},G_{c}^{(4)},\\ell^{(4)}]$.\n- Numerical format: Each number must be printed as a floating-point value with six significant figures.", "solution": "**Part 1: Derivation of Critical Stress**\n\nFor a homogeneous state, both the strain $\\varepsilon$ and the phase-field $d$ are uniform, so $d' = 0$. The energy density $\\Psi$ is:\n$$\n\\Psi(\\varepsilon, d) = g(d)\\,\\psi_e(\\varepsilon) + G_c\\,\\gamma_\\ell(d,0) = (1-d)^2 \\frac{1}{2}E\\varepsilon^2 + \\frac{G_c}{2\\ell}d^2\n$$\nEnergetic stationarity requires minimizing $\\Psi$ with respect to $d$ for a given strain $\\varepsilon$:\n$$\n\\frac{\\partial \\Psi}{\\partial d} = - (1-d)E\\varepsilon^2 + \\frac{G_c}{\\ell}d = 0\n$$\nSolving for the equilibrium phase-field value $d(\\varepsilon)$:\n$$\nd(\\varepsilon) = \\frac{E\\varepsilon^2}{E\\varepsilon^2 + G_c/\\ell}\n$$\nThe nominal stress $\\sigma$ is given by $\\sigma = g(d) \\frac{\\partial \\psi_e}{\\partial \\varepsilon} = (1-d)^2 E \\varepsilon$. Substituting the equilibrium expression for $d(\\varepsilon)$:\n$$\n1 - d(\\varepsilon) = \\frac{G_c/\\ell}{E\\varepsilon^2 + G_c/\\ell}\n$$\n$$\n\\sigma(\\varepsilon) = \\left(\\frac{G_c/\\ell}{E\\varepsilon^2 + G_c/\\ell}\\right)^2 E\\varepsilon = \\frac{(G_c/\\ell)^2 E \\varepsilon}{(E\\varepsilon^2 + G_c/\\ell)^2}\n$$\nThe critical stress $\\sigma_c$ is the maximum of $\\sigma(\\varepsilon)$. We find this by setting $\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon} = 0$:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon} \\left[ \\frac{\\varepsilon}{(E\\varepsilon^2 + G_c/\\ell)^2} \\right] = 0 \\implies (E\\varepsilon^2 + G_c/\\ell) - 4E\\varepsilon^2 = 0\n$$\nThis gives the critical strain $\\varepsilon_c$ at which the stress is maximum:\n$$\n\\varepsilon_c^2 = \\frac{G_c}{3E\\ell} \\quad \\implies \\quad \\varepsilon_c = \\sqrt{\\frac{G_c}{3E\\ell}}\n$$\nSubstituting $\\varepsilon_c$ back into the expression for $\\sigma(\\varepsilon)$ yields the critical stress $\\sigma_c$:\n$$\n\\sigma_c = \\sigma(\\varepsilon_c) = \\frac{(G_c/\\ell)^2 E \\sqrt{G_c/(3E\\ell)}}{(E(G_c/(3E\\ell)) + G_c/\\ell)^2} = \\frac{9}{16} E \\sqrt{\\frac{G_c}{3E\\ell}} = \\frac{3\\sqrt{3}}{16}\\sqrt{\\frac{EG_c}{\\ell}}\n$$\n\n**Part 2: Isolated Crack Profile and Width**\n\nFor an isolated crack under zero load ($\\psi_e=0$), we minimize the fracture energy:\n$$\n\\mathcal{E}[d] = \\int_{-\\infty}^{\\infty} G_c \\left( \\frac{d^2}{2\\ell} + \\frac{\\ell (d')^2}{2} \\right) \\mathrm{d}x\n$$\nThe corresponding Euler-Lagrange equation is:\n$$\nd''(x) - \\frac{1}{\\ell^2}d(x) = 0\n$$\nThe solution that satisfies the boundary conditions $d(0)=1$ and $\\lim_{|x|\\to\\infty}d(x)=0$ is:\n$$\nd(x) = e^{-|x|/\\ell}\n$$\nThe full width at half maximum, $w$, is the distance between the two points where $d(x) = \\frac{1}{2}$. Let $x_h > 0$ be one such point:\n$$\nd(x_h) = e^{-x_h/\\ell} = \\frac{1}{2} \\implies -\\frac{x_h}{\\ell} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2) \\implies x_h = \\ell\\ln(2)\n$$\nBy symmetry, the full width is $w = 2x_h = 2\\ell\\ln(2)$.\n\n**Part 3: Calibration Formulas for $G_c$ and $\\ell$**\n\nWe have two key relationships:\n1.  $\\sigma_c = \\frac{3\\sqrt{3}}{16}\\sqrt{\\frac{EG_c}{\\ell}}$\n2.  $w = 2\\ell\\ln(2)$\n\nFrom equation (2), we directly solve for the length scale $\\ell$:\n$$\n\\ell = \\frac{w}{2\\ln(2)}\n$$\nNext, we rearrange equation (1) to solve for $G_c$:\n$$\nG_c = \\frac{\\ell}{E} \\left(\\frac{16\\sigma_c}{3\\sqrt{3}}\\right)^2 = \\frac{256\\sigma_c^2 \\ell}{27E}\n$$\nSubstituting the expression for $\\ell$ to eliminate it:\n$$\nG_c = \\frac{256\\sigma_c^2}{27E} \\left(\\frac{w}{2\\ln(2)}\\right) = \\frac{128\\sigma_c^2 w}{27E\\ln(2)}\n$$\nThe final calibration formulas are:\n$$\n\\ell = \\frac{w}{2\\ln(2)} \\quad \\text{and} \\quad G_c = \\frac{128\\sigma_c^2 w}{27E\\ln(2)}\n$$\n\n**Part 4: Implementation**\nThe program below implements these derived calibration formulas for the provided test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the phase-field parameters Gc and l based on macroscopic\n    material properties E, sigma_c, and w for the AT2 model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (E, sigma_c, w) in SI units.\n    test_cases = [\n        (7.0e10, 3.0e8, 6.0e-4),    # Test 1\n        (2.10e11, 1.0e9, 2.0e-4),   # Test 2\n        (3.0e9, 6.0e7, 3.0e-3),     # Test 3\n        (5.0e10, 2.0e8, 1.0e-6),    # Test 4\n    ]\n\n    results = []\n    \n    # Pre-calculate the natural logarithm of 2 for efficiency.\n    ln2 = np.log(2)\n\n    for E, sigma_c, w in test_cases:\n        # Based on the derived calibration formulas:\n        # l = w / (2 * ln(2))\n        # Gc = (128 * sigma_c^2 * w) / (27 * E * ln(2))\n\n        # Calculate the internal length scale, l (in meters).\n        ell = w / (2 * ln2)\n\n        # Calculate the critical energy release rate, Gc (in J/m^2).\n        # numerator = 128 * sigma_c**2 * w\n        # denominator = 27 * E * ln2\n        # Gc = numerator / denominator\n        \n        # Alternatively, using the derived relation involving ell:\n        # Gc = (256 * sigma_c**2 / (27 * E)) * ell\n        # This form is also valid but reuses a calculated value. Let's use the\n        # primary formula derived in the solution.\n        Gc = (128 * sigma_c**2 * w) / (27 * E * ln2)\n\n        # Append the formatted results to the list.\n        # The format specifier \".6g\" ensures 6 significant figures.\n        results.append(f\"{Gc:.6g}\")\n        results.append(f\"{ell:.6g}\")\n\n    # Final print statement in the exact required format:\n    # [Gc_1, l_1, Gc_2, l_2, ...]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2587016"}, {"introduction": "Moving from one-dimensional theory to multi-axial engineering applications requires extending the model to handle complex stress and strain states. This practice addresses the core of a finite element implementation: the calculation of the energy density for a 2D mixed-mode fracture scenario under plane strain conditions. You will implement the powerful spectral decomposition for the tension-compression split, providing direct, hands-on experience in coding the constitutive logic that forms the basis of a user material subroutine (e.g., a UMAT) in a production finite element code [@problem_id:2586994].", "problem": "Construct a program that evaluates the phase-field mixed-mode brittle fracture energy density at a material point under small-strain, plane-strain linear elasticity with a tension-compression spectral split. The underlying base is the elastic strain energy density and the crack surface density functional. Begin from the fundamental elastic energy of isotropic linear elasticity, the spectral decomposition of the small-strain tensor, and a standard quadratic degradation function for the phase-field.\n\nStart from the following foundational statements:\n- The infinitesimal strain tensor is $\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}}\\right)$, where $\\boldsymbol{u}$ is the displacement field.\n- For isotropic linear elasticity (plane strain), the undamaged strain energy density is $\\psi_{0}(\\boldsymbol{\\varepsilon}) = \\frac{1}{2}\\lambda \\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}\\right)^{2} + \\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}$, with Lamé parameters $\\lambda$ and $\\mu$, which are related to Young’s modulus $E$ and Poisson’s ratio $\\nu$ by $\\mu = \\frac{E}{2(1+\\nu)}$ and $\\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}$.\n- Let the spectral decomposition of $\\boldsymbol{\\varepsilon}$ be $\\boldsymbol{\\varepsilon} = \\sum_{i=1}^{2}\\varepsilon_{i}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i}$ with principal strains $\\varepsilon_{i}$ and orthonormal eigenvectors $\\boldsymbol{n}_{i}$ in the plane. Define the positive and negative strain tensors by\n$$\n\\boldsymbol{\\varepsilon}_{+} = \\sum_{i=1}^{2}\\langle \\varepsilon_{i}\\rangle_{+}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i},\\qquad \n\\boldsymbol{\\varepsilon}_{-} = \\sum_{i=1}^{2}\\langle \\varepsilon_{i}\\rangle_{-}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i},\n$$\nwhere $\\langle x\\rangle_{+} = \\max(x,0)$ and $\\langle x\\rangle_{-} = \\min(x,0)$.\n- The tension-compression split of the undamaged energy is given by\n$$\n\\psi_{+}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{+}:\\boldsymbol{\\varepsilon}_{+},\\qquad\n\\psi_{-}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{-}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{-}:\\boldsymbol{\\varepsilon}_{-}.\n$$\nThis implements a compression split that prevents compressive states from driving damage evolution while retaining their elastic energy.\n- Let the degradation function be $g(d) = (1-d)^{2} + \\kappa$ with a small residual stiffness $\\kappa0$. The crack surface density term per unit volume is\n$$\n\\gamma(d,\\nabla d) = \\frac{G_{c}}{2\\ell}d^{2} + \\frac{G_{c}\\ell}{2}\\,|\\nabla d|^{2},\n$$\nwhere $G_{c}$ is the critical energy release rate and $\\ell$ is the internal length scale.\n- The total mixed-mode fracture energy density with compression split is\n$$\nW(\\boldsymbol{\\varepsilon},d,\\nabla d) = g(d)\\,\\psi_{+}(\\boldsymbol{\\varepsilon}) + \\psi_{-}(\\boldsymbol{\\varepsilon}) + \\gamma(d,\\nabla d).\n$$\n\nYour task is to implement a program that, for a given set of material parameters and multiple test cases of $\\boldsymbol{\\varepsilon}$, $d$, and $\\nabla d$, computes $W(\\boldsymbol{\\varepsilon},d,\\nabla d)$ at a point. The computation must:\n- Use the spectral decomposition of $\\boldsymbol{\\varepsilon}$ to build $\\boldsymbol{\\varepsilon}_{+}$ and $\\boldsymbol{\\varepsilon}_{-}$.\n- Use the compression split so that only $\\psi_{+}$ is degraded by $g(d)$.\n- Use consistent plane-strain expressions for $\\lambda$ and $\\mu$ in terms of $E$ and $\\nu$.\n\nAll inputs are given in International System of Units (SI):\n- Young’s modulus $E$ in pascals ($\\mathrm{Pa}$).\n- Poisson’s ratio $\\nu$ dimensionless.\n- Critical energy release rate $G_{c}$ in joules per square meter ($\\mathrm{J}/\\mathrm{m}^{2}$).\n- Length scale $\\ell$ in meters ($\\mathrm{m}$).\n- Strain tensor components are dimensionless.\n- Phase-field $d$ is dimensionless.\n- Phase-field gradient components are in inverse meters ($\\mathrm{m}^{-1}$).\n- The output energy density $W$ must be reported in joules per cubic meter ($\\mathrm{J}/\\mathrm{m}^{3}$).\n\nTest suite and required numerical values:\n- Common material parameters for all cases: $E = 2.10\\times 10^{11}\\ \\mathrm{Pa}$, $\\nu = 0.30$, $G_{c} = 2.70\\times 10^{3}\\ \\mathrm{J}/\\mathrm{m}^{2}$, $\\ell = 1.0\\times 10^{-3}\\ \\mathrm{m}$, $\\kappa = 1.0\\times 10^{-6}$.\n- Case $1$ (uniaxial tension, mixed-mode check via split): \n  - $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 1.0\\times 10^{-3}  0 \\\\ 0  0 \\end{bmatrix}$, \n  - $d = 4.0\\times 10^{-1}$, \n  - $\\nabla d = \\begin{bmatrix} 1.0\\times 10^{2} \\\\ -5.0\\times 10^{1} \\end{bmatrix}\\ \\mathrm{m}^{-1}$.\n- Case $2$ (pure shear, Mode II): \n  - Let $\\gamma = 2.0\\times 10^{-3}$, $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 0  \\gamma/2 \\\\ \\gamma/2  0 \\end{bmatrix}$,\n  - $d = 2.0\\times 10^{-1}$,\n  - $\\nabla d = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}\\ \\mathrm{m}^{-1}$.\n- Case $3$ (uniform compression, compression split): \n  - $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} -8.0\\times 10^{-4}  0 \\\\ 0  -8.0\\times 10^{-4} \\end{bmatrix}$,\n  - $d = 9.0\\times 10^{-1}$,\n  - $\\nabla d = \\begin{bmatrix} 2.0\\times 10^{2} \\\\ 2.0\\times 10^{2} \\end{bmatrix}\\ \\mathrm{m}^{-1}$.\n- Case $4$ (zero strain, gradient-only crack surface term): \n  - $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix}$,\n  - $d = 5.0\\times 10^{-1}$,\n  - $\\nabla d = \\begin{bmatrix} 1.0\\times 10^{1} \\\\ -1.0\\times 10^{1} \\end{bmatrix}\\ \\mathrm{m}^{-1}$.\n- Case $5$ (biaxial mixed tension-compression): \n  - $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 1.5\\times 10^{-3}  0 \\\\ 0  -5.0\\times 10^{-4} \\end{bmatrix}$,\n  - $d = 1.0\\times 10^{-1}$,\n  - $\\nabla d = \\begin{bmatrix} 0 \\\\ 1.0\\times 10^{2} \\end{bmatrix}\\ \\mathrm{m}^{-1}$.\n\nYour program must compute $W$ for each of the above cases and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[w_{1},w_{2},w_{3},w_{4},w_{5}]$, where each $w_{i}$ is $W$ for case $i$ in $\\mathrm{J}/\\mathrm{m}^{3}$, printed as a decimal float rounded to six digits after the decimal point (for example, $123.456789$ should be printed as $123.456789$ and $1.0\\times 10^{3}$ should be printed as $1000.000000$). No additional text should be printed. The program must not read any input and must be executable as-is.", "solution": "The problem requires the computation of the total phase-field fracture energy density, denoted by $W(\\boldsymbol{\\varepsilon},d,\\nabla d)$, at a material point under plane-strain linear elasticity. The model incorporates a tension-compression split of the elastic strain energy to ensure that only tensile states contribute to material degradation. The task is to evaluate this energy density for five distinct test cases, given a set of material parameters and state variables.\n\nFirst, we establish the theoretical framework based on the provided definitions. The total energy density $W$ is composed of three parts: the degraded tensile elastic energy, the non-degraded compressive elastic energy, and the crack surface energy. The governing equation is:\n$$\nW(\\boldsymbol{\\varepsilon},d,\\nabla d) = g(d)\\,\\psi_{+}(\\boldsymbol{\\varepsilon}) + \\psi_{-}(\\boldsymbol{\\varepsilon}) + \\gamma(d,\\nabla d)\n$$\nwhere $\\boldsymbol{\\varepsilon}$ is the infinitesimal strain tensor, $d$ is the phase-field variable representing damage ($d=0$ for intact material, $d=1$ for fully broken material), and $\\nabla d$ is its gradient.\n\nThe components of the total energy are defined as follows:\n1.  **Strain Energy Split**: The strain energy is additively decomposed into a tensile part $\\psi_{+}(\\boldsymbol{\\varepsilon})$ and a compressive part $\\psi_{-}(\\boldsymbol{\\varepsilon})$. This split is based on the spectral decomposition of the strain tensor $\\boldsymbol{\\varepsilon} = \\sum_{i=1}^{2}\\varepsilon_{i}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i}$, where $\\varepsilon_{i}$ are the principal strains.\n    The tensile and compressive energy parts are:\n    $$\n    \\psi_{+}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{+}:\\boldsymbol{\\varepsilon}_{+}\n    $$\n    $$\n    \\psi_{-}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{-}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{-}:\\boldsymbol{\\varepsilon}_{-}\n    $$\n    Here, $\\langle x\\rangle_{+} = \\max(x,0)$ and $\\langle x\\rangle_{-} = \\min(x,0)$. The terms $\\boldsymbol{\\varepsilon}_{+}:\\boldsymbol{\\varepsilon}_{+}$ and $\\boldsymbol{\\varepsilon}_{-}:\\boldsymbol{\\varepsilon}_{-}$ are computed from the principal strains as $\\sum_{i=1}^{2}(\\langle \\varepsilon_{i}\\rangle_{+})^{2}$ and $\\sum_{i=1}^{2}(\\langle \\varepsilon_{i}\\rangle_{-})^{2}$, respectively. The Lamé parameters $\\lambda$ and $\\mu$ are defined for plane strain in terms of Young’s modulus $E$ and Poisson’s ratio $\\nu$:\n    $$\n    \\mu = \\frac{E}{2(1+\\nu)}, \\qquad \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}\n    $$\n2.  **Degradation Function**: The tensile part of the energy is degraded by the function $g(d)$:\n    $$\n    g(d) = (1-d)^{2} + \\kappa\n    $$\n    where $\\kappa$ is a small parameter to ensure the well-posedness of the problem at full degradation ($d=1$).\n\n3.  **Crack Surface Density**: The energy associated with the formation of crack surfaces is regularized using the phase-field and its gradient:\n    $$\n    \\gamma(d,\\nabla d) = \\frac{G_{c}}{2\\ell}d^{2} + \\frac{G_{c}\\ell}{2}\\,|\\nabla d|^{2}\n    $$\n    where $G_{c}$ is the material's critical energy release rate and $\\ell$ is a length scale parameter that controls the width of the regularized crack.\n\nThe computational procedure for each test case is as follows:\n\n1.  Calculate the Lamé parameters $\\lambda$ and $\\mu$ from the given material properties $E = 2.10\\times 10^{11}\\,\\mathrm{Pa}$ and $\\nu = 0.30$.\n2.  For a given strain tensor $\\boldsymbol{\\varepsilon}$, compute its principal strains $\\varepsilon_1, \\varepsilon_2$ by finding the eigenvalues of the matrix representation of $\\boldsymbol{\\varepsilon}$.\n3.  Compute the positive and negative parts of the principal strains and the trace: $\\langle \\varepsilon_{i}\\rangle_{+}$, $\\langle \\varepsilon_{i}\\rangle_{-}$, $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{+}$, and $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{-}$.\n4.  Calculate the energy components $\\psi_{+}(\\boldsymbol{\\varepsilon})$ and $\\psi_{-}(\\boldsymbol{\\varepsilon})$.\n5.  Calculate the degradation function $g(d)$ using the given value of $d$ and $\\kappa = 1.0\\times 10^{-6}$.\n6.  Calculate the crack surface density $\\gamma(d,\\nabla d)$ using the given $d$, $\\nabla d$, $G_{c} = 2.70\\times 10^{3}\\,\\mathrm{J}/\\mathrm{m}^{2}$, and $\\ell = 1.0\\times 10^{-3}\\,\\mathrm{m}$.\n7.  Finally, assemble the total energy density $W$ using the main formula.\nThe implementation will proceed based on these calculations.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the phase-field mixed-mode brittle fracture energy density\n    for a set of test cases.\n    \"\"\"\n    # Common material parameters (SI units)\n    E = 2.10e11  # Young's modulus (Pa)\n    nu = 0.30    # Poisson's ratio\n    Gc = 2.70e3  # Critical energy release rate (J/m^2)\n    l = 1.0e-3   # Length scale (m)\n    kappa = 1.0e-6 # Residual stiffness parameter\n\n    # Define the test cases\n    test_cases = [\n        # Case 1: Uniaxial tension, mixed-mode check via split\n        {\n            \"eps\": np.array([[1.0e-3, 0.0], [0.0, 0.0]]),\n            \"d\": 4.0e-1,\n            \"grad_d\": np.array([1.0e2, -5.0e1])\n        },\n        # Case 2: Pure shear, Mode II\n        {\n            \"eps\": np.array([[0.0, 1.0e-3], [1.0e-3, 0.0]]), # gamma = 2e-3, eps_xy = gamma/2\n            \"d\": 2.0e-1,\n            \"grad_d\": np.array([0.0, 0.0])\n        },\n        # Case 3: Uniform compression, compression split\n        {\n            \"eps\": np.array([[-8.0e-4, 0.0], [0.0, -8.0e-4]]),\n            \"d\": 9.0e-1,\n            \"grad_d\": np.array([2.0e2, 2.0e2])\n        },\n        # Case 4: Zero strain, gradient-only crack surface term\n        {\n            \"eps\": np.array([[0.0, 0.0], [0.0, 0.0]]),\n            \"d\": 5.0e-1,\n            \"grad_d\": np.array([1.0e1, -1.0e1])\n        },\n        # Case 5: Biaxial mixed tension-compression\n        {\n            \"eps\": np.array([[1.5e-3, 0.0], [0.0, -5.0e-4]]),\n            \"d\": 1.0e-1,\n            \"grad_d\": np.array([0.0, 1.0e2])\n        }\n    ]\n\n    # Calculate Lamé parameters for plane strain\n    mu = E / (2 * (1 + nu))\n    lambda_ = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n\n    results = []\n    for case in test_cases:\n        eps = case[\"eps\"]\n        d = case[\"d\"]\n        grad_d = case[\"grad_d\"]\n\n        # 1. Spectral decomposition of the strain tensor\n        # For a 2x2 symmetric matrix, eigenvalues are the principal strains\n        principal_strains = np.linalg.eigvalsh(eps)\n\n        # 2. Compute positive and negative parts\n        tr_eps = np.sum(principal_strains)\n        tr_eps_plus = max(tr_eps, 0)\n        tr_eps_minus = min(tr_eps, 0)\n\n        eps_plus_vals = np.maximum(principal_strains, 0)\n        eps_minus_vals = np.minimum(principal_strains, 0)\n        \n        # The term eps_p:eps_p is sum(eps_p_i^2)\n        eps_plus_dot_eps_plus = np.sum(eps_plus_vals**2)\n        # The term eps_m:eps_m is sum(eps_m_i^2)\n        eps_minus_dot_eps_minus = np.sum(eps_minus_vals**2)\n        \n        # 3. Calculate tensile and compressive strain energy densities\n        psi_plus = 0.5 * lambda_ * tr_eps_plus**2 + mu * eps_plus_dot_eps_plus\n        psi_minus = 0.5 * lambda_ * tr_eps_minus**2 + mu * eps_minus_dot_eps_minus\n\n        # 4. Calculate degradation function\n        g_d = (1 - d)**2 + kappa\n\n        # 5. Calculate crack surface density\n        grad_d_norm_sq = np.sum(grad_d**2)\n        gamma = (Gc / (2 * l)) * d**2 + (Gc * l / 2) * grad_d_norm_sq\n\n        # 6. Assemble total energy density\n        W = g_d * psi_plus + psi_minus + gamma\n        results.append(W)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```", "id": "2586994"}]}