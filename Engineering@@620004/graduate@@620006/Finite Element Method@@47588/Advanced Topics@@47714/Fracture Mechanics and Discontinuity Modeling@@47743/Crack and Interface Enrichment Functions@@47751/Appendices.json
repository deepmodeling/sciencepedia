{"hands_on_practices": [{"introduction": "Theory is the foundation, but verification is the cornerstone of reliable engineering simulation. This first exercise guides you through a fundamental validation procedure in the eXtended Finite Element Method (XFEM): the patch test. By attempting to exactly reproduce a known piecewise-linear displacement field across a crack [@problem_id:2551501], you will confirm the representative power of Heaviside enrichment functions and, crucially, determine the necessary numerical integration scheme to maintain exactness, linking theoretical completeness to practical implementation.", "problem": "Consider small-strain linear elasticity on a bounded polygonal domain $\\Omega \\subset \\mathbb{R}^{2}$ with a straight crack $\\Gamma_{c}$ that partitions $\\Omega$ into two disjoint open subdomains $\\Omega^{+}$ and $\\Omega^{-}$. The crack is represented by the signed-distance level set $\\phi(\\mathbf{x}) = \\mathbf{n}\\cdot \\mathbf{x} - c$ with unit normal $\\mathbf{n}$ and constant $c \\in \\mathbb{R}$, so that $H(\\phi(\\mathbf{x})) = +1$ for $\\mathbf{x} \\in \\Omega^{+}$ and $H(\\phi(\\mathbf{x})) = -1$ for $\\mathbf{x} \\in \\Omega^{-}$, where $H$ denotes the Heaviside function. Assume a homogeneous, isotropic, and linear elastic stiffness tensor $\\mathbf{C}$ with no body forces. The exact displacement field to be reproduced in a patch test is piecewise affine,\n$$\n\\mathbf{u}^{\\star}(\\mathbf{x}) = \n\\begin{cases}\n\\mathbf{A}^{+}\\mathbf{x} + \\mathbf{b}^{+},  \\mathbf{x} \\in \\Omega^{+},\\\\\n\\mathbf{A}^{-}\\mathbf{x} + \\mathbf{b}^{-},  \\mathbf{x} \\in \\Omega^{-},\n\\end{cases}\n$$\nwith constant matrices $\\mathbf{A}^{\\pm} \\in \\mathbb{R}^{2 \\times 2}$ and vectors $\\mathbf{b}^{\\pm} \\in \\mathbb{R}^{2}$. The crack faces are traction-free and Dirichlet boundary conditions on $\\partial \\Omega$ are set equal to $\\mathbf{u}^{\\star}$.\n\nDiscretize $\\Omega$ with a conforming patch of $P_{1}$ (linear) triangular finite elements with standard nodal shape functions $\\{N_{i}\\}$. Use the partition of unity framework of the eXtended Finite Element Method (XFEM) with Heaviside enrichment: enrich exactly those nodes whose support is cut by $\\Gamma_{c}$ with the shifted enrichment $H_{s}(\\mathbf{x}) = H(\\phi(\\mathbf{x})) - H(\\phi(\\mathbf{x}_{i}))$. The discrete trial space is then\n$$\n\\mathbf{u}_{h}(\\mathbf{x}) = \\sum_{i \\in \\mathcal{I}} N_{i}(\\mathbf{x})\\, \\mathbf{d}_{i} \\;+\\; \\sum_{j \\in \\mathcal{J}} N_{j}(\\mathbf{x})\\, \\mathbf{a}_{j}\\,\\big(H(\\phi(\\mathbf{x})) - H(\\phi(\\mathbf{x}_{j}))\\big),\n$$\nwhere $\\mathcal{I}$ is the full node set, $\\mathcal{J} \\subset \\mathcal{I}$ is the set of enriched nodes, and $\\mathbf{d}_{i}, \\mathbf{a}_{j} \\in \\mathbb{R}^{2}$ are the standard and enriched nodal unknowns, respectively. The weak form uses the bilinear form $a(\\mathbf{u},\\mathbf{v}) = \\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\mathbf{v})^{\\mathsf{T}} \\mathbf{C}\\, \\boldsymbol{\\varepsilon}(\\mathbf{u}) \\, \\mathrm{d}\\Omega$, where $\\boldsymbol{\\varepsilon}(\\cdot)$ is the small-strain operator.\n\nDesign a strong-discontinuity patch test that verifies exact reproduction of $\\mathbf{u}^{\\star}$ by $\\mathbf{u}_{h}$, and specify quadrature sufficient to integrate the stiffness contributions exactly. In particular, argue from first principles why $\\mathbf{u}_{h}$ can represent $\\mathbf{u}^{\\star}$ and determine, on each cut element, the polynomial degree of the integrand of the element stiffness matrix when the element is partitioned into the two subdomains $\\Omega^{+}$ and $\\Omega^{-}$ by the straight crack segment. Then, consider the following quadrature strategy for cut elements: subdivide each cut triangle into two triangles by inserting the straight crack segment as an internal edge, and apply standard Gaussian quadrature on each resulting subtriangle. For uncut elements, use standard triangular Gaussian quadrature.\n\nLet $n_{\\ast}$ denote the smallest integer number of Gauss points per (sub)triangle that guarantees exact evaluation of the element stiffness contribution under this strategy. Determine $n_{\\ast}$. Provide only the value of $n_{\\ast}$ as your final answer. No rounding is required, and no units are needed.", "solution": "The objective is to determine the minimum number of quadrature points, $n_{\\ast}$, required for the exact integration of element stiffness matrices in a patch test designed to reproduce a piecewise affine displacement field. The patch test is passed if the finite element solution $\\mathbf{u}_{h}$ exactly matches the analytical solution $\\mathbf{u}^{\\star}$ for the given boundary conditions. This is guaranteed by Galerkin orthogonality if the analytical solution can be exactly represented by the trial function space, i.e., $\\mathbf{u}^{\\star} \\in \\{\\mathbf{u}_h\\}$, and the bilinear form is integrated exactly.\n\nFirst, we verify the representability of $\\mathbf{u}^{\\star}$ in the XFEM space. The piecewise affine solution $\\mathbf{u}^{\\star}$ can be expressed globally using the problem-defined Heaviside function $H(\\phi(\\mathbf{x}))$. Let us define an average field and a jump field:\n$$\n\\mathbf{u}_{avg}(\\mathbf{x}) = \\frac{1}{2}\\big((\\mathbf{A}^{+}+\\mathbf{A}^{-})\\mathbf{x} + (\\mathbf{b}^{+}+\\mathbf{b}^{-})\\big)\n$$\n$$\n\\mathbf{u}_{jump}(\\mathbf{x}) = \\frac{1}{2}\\big((\\mathbf{A}^{+}-\\mathbf{A}^{-})\\mathbf{x} + (\\mathbf{b}^{+}-\\mathbf{b}^{-})\\big)\n$$\nBoth $\\mathbf{u}_{avg}(\\mathbf{x})$ and $\\mathbf{u}_{jump}(\\mathbf{x})$ are affine functions. The exact solution can then be written as:\n$$\n\\mathbf{u}^{\\star}(\\mathbf{x}) = \\mathbf{u}_{avg}(\\mathbf{x}) + H(\\phi(\\mathbf{x}))\\mathbf{u}_{jump}(\\mathbf{x})\n$$\nThe XFEM approximation is:\n$$\n\\mathbf{u}_{h}(\\mathbf{x}) = \\sum_{i \\in \\mathcal{I}} N_{i}(\\mathbf{x})\\, \\mathbf{d}_{i} + \\sum_{j \\in \\mathcal{J}} N_{j}(\\mathbf{x})\\, \\mathbf{a}_{j}\\, H(\\phi(\\mathbf{x})) - \\sum_{j \\in \\mathcal{J}} N_{j}(\\mathbf{x})\\, \\mathbf{a}_{j}\\, H(\\phi(\\mathbf{x}_{j}))\n$$\nThis can be rearranged into the form $\\mathbf{P}(\\mathbf{x}) + H(\\phi(\\mathbf{x}))\\mathbf{Q}(\\mathbf{x})$, where:\n$$\n\\mathbf{P}(\\mathbf{x}) = \\sum_{i \\in \\mathcal{I}} N_{i}(\\mathbf{x})\\, \\mathbf{d}_{i} - \\sum_{j \\in \\mathcal{J}} N_{j}(\\mathbf{x})\\, \\mathbf{a}_{j}\\, H(\\phi(\\mathbf{x}_{j}))\n$$\n$$\n\\mathbf{Q}(\\mathbf{x}) = \\sum_{j \\in \\mathcal{J}} N_{j}(\\mathbf{x})\\, \\mathbf{a}_{j}\n$$\nSince the basis functions $N_{i}(\\mathbf{x})$ are linear ($P_1$ elements), and the summations form linear combinations, both $\\mathbf{P}(\\mathbf{x})$ and $\\mathbf{Q}(\\mathbf{x})$ are vector fields whose components are linear polynomials. The full space of linear polynomials can be spanned by choosing the nodal degrees of freedom $\\mathbf{d}_i$ and $\\mathbf{a}_j$ appropriately. Since $\\mathbf{u}_{avg}(\\mathbf{x})$ and $\\mathbf{u}_{jump}(\\mathbf{x})$ are affine (linear polynomials), there exist sets of coefficients $\\{\\mathbf{d}_i, \\mathbf{a}_j\\}$ such that $\\mathbf{P}(\\mathbf{x}) = \\mathbf{u}_{avg}(\\mathbf{x})$ and $\\mathbf{Q}(\\mathbf{x}) = \\mathbf{u}_{jump}(\\mathbf{x})$. Thus, $\\mathbf{u}^{\\star}$ is representable by $\\mathbf{u}_{h}$.\n\nFor the patch test to pass, the stiffness matrix must be computed exactly. The element stiffness matrix components are given by integrals of the form $k_{ab}^{el} = a(\\boldsymbol{\\psi}_a, \\boldsymbol{\\psi}_b)|_{K}$, where $\\boldsymbol{\\psi}_a, \\boldsymbol{\\psi}_b$ are vector-valued basis functions and $K$ is an element. The integrand on $K$ is $\\boldsymbol{\\varepsilon}(\\boldsymbol{\\psi}_b)^{\\mathsf{T}} \\mathbf{C}\\, \\boldsymbol{\\varepsilon}(\\boldsymbol{\\psi}_a)$. Since $\\mathbf{C}$ is a constant tensor, the polynomial degree of the integrand is determined by the product of the components of the strain fields $\\boldsymbol{\\varepsilon}(\\boldsymbol{\\psi}_a)$ and $\\boldsymbol{\\varepsilon}(\\boldsymbol{\\psi}_b)$.\n\nLet us analyze the strain field $\\boldsymbol{\\varepsilon}(\\boldsymbol{\\psi})$ for a generic basis function $\\boldsymbol{\\psi}$ over a cut element $K$. The basis functions are of two types:\n1.  Standard basis function: $\\boldsymbol{\\psi}_i(\\mathbf{x}) = N_i(\\mathbf{x}) \\mathbf{e}_k$, where $\\mathbf{e}_k$ is a coordinate basis vector. Since $N_i$ is a linear polynomial for a $P_1$ element, its gradient $\\nabla N_i$ is a constant vector on $K$. Thus, the strain tensor $\\boldsymbol{\\varepsilon}(\\boldsymbol{\\psi}_i)$ is constant over the element $K$.\n2.  Enriched basis function: $\\boldsymbol{\\psi}_j(\\mathbf{x}) = N_j(\\mathbf{x}) E_j(\\mathbf{x}) \\mathbf{e}_k$, where $E_j(\\mathbf{x}) = H(\\phi(\\mathbf{x})) - H(\\phi(\\mathbf{x}_j))$ is the enrichment function.\n\nThe gradient of the enrichment function is $\\nabla E_j(\\mathbf{x}) = \\nabla H(\\phi(\\mathbf{x})) = \\delta(\\phi(\\mathbf{x}))\\mathbf{n}$, where $\\delta$ is the Dirac delta function. This singularity is handled in XFEM by performing integration separately on the subdomains $\\Omega^+$ and $\\Omega^-$, as prescribed by the quadrature strategy.\n\nConsider a cut element $K$. It is partitioned into $K^+ = K \\cap \\Omega^+$ and $K^- = K \\cap \\Omega^-$.\n- On the subdomain $K^+$, $\\phi(\\mathbf{x})  0$, so $H(\\phi(\\mathbf{x})) = +1$. The enrichment function becomes $E_j(\\mathbf{x}) = 1 - H(\\phi(\\mathbf{x}_j))$, which is a constant value on $K^+$.\n- On the subdomain $K^-$, $\\phi(\\mathbf{x})  0$, so $H(\\phi(\\mathbf{x})) = -1$. The enrichment function becomes $E_j(\\mathbf{x}) = -1 - H(\\phi(\\mathbf{x}_j))$, which is also a constant value on $K^-$.\n\nThe gradient of the enriched basis function $\\boldsymbol{\\psi}_j$, away from the crack, is:\n$$\n\\nabla \\boldsymbol{\\psi}_j(\\mathbf{x}) = \\nabla(N_j E_j)\\otimes \\mathbf{e}_k = (\\nabla N_j \\otimes \\mathbf{e}_k) E_j + (N_j \\nabla E_j \\otimes \\mathbf{e}_k)\n$$\nOn $K^+$ or $K^-$ separately, $\\nabla E_j = \\mathbf{0}$, and $E_j$ is a constant. Since $\\nabla N_j$ is a constant vector for a $P_1$ element, the gradient $\\nabla \\boldsymbol{\\psi}_j$ is a constant tensor field on $K^+$ and a (generally different) constant tensor field on $K^-$.\n\nConsequently, for any basis function $\\boldsymbol{\\psi}$ (standard or enriched), the associated strain tensor $\\boldsymbol{\\varepsilon}(\\boldsymbol{\\psi})$ is piecewise constant over a cut element $K$, with the constant value depending on whether the point is in $K^+$ or $K^-$.\n\nThe integrand of the stiffness matrix, $\\boldsymbol{\\varepsilon}(\\boldsymbol{\\psi}_b)^{\\mathsf{T}} \\mathbf{C}\\, \\boldsymbol{\\varepsilon}(\\boldsymbol{\\psi}_a)$, is therefore a product of constants. This means the integrand is itself a constant function on $K^+$ and a different constant function on $K^-$. A constant function is a polynomial of degree $0$.\n\nThe quadrature strategy is to subdivide $K$ into subtriangles, each lying entirely within either $K^+$ or $K^-$. On each of these subtriangles, the integrand is a constant, i.e., a polynomial of degree $0$.\n\nTo exactly integrate a polynomial of degree $d$ over a triangle, a Gaussian quadrature rule must have a degree of precision of at least $d$. The question asks for the smallest number of points, $n_{\\ast}$.\n- A 1-point rule (evaluating at the centroid) has a degree of precision of $1$. It integrates any linear polynomial exactly.\n- A 3-point rule has a degree of precision of $2$.\n\nTo integrate a polynomial of degree $d=0$ exactly, a rule with precision $0$ is sufficient. The 1-point rule, with precision $1$, will be exact. A quadrature rule with fewer than $1$ point is not possible. Therefore, the minimum number of Gauss points required per subtriangle is $1$.\n\nThus, $n_{\\ast}=1$. This holds for uncut elements as well, as the strain field for the trial function on an uncut element is constant, making the integrand for the stiffness matrix also a constant.", "answer": "$$\\boxed{1}$$", "id": "2551501"}, {"introduction": "Having confirmed that our enriched approximation can represent discontinuities, we now turn to a more subtle but equally important question: how accurately do we represent the geometry of the discontinuity itself? This practice explores the geometric error inherent in approximating a curved interface with the linear interpolation commonly used within finite elements [@problem_id:2551518]. Analyzing this error provides critical insight into the convergence properties of the method and motivates the development of higher-order geometric reconstructions for improved accuracy.", "problem": "Consider a smooth material interface represented implicitly as the zero level set of a scalar field $\\phi(\\boldsymbol{x})$, with $\\boldsymbol{x} \\in \\mathbb{R}^{2}$, such that $\\Gamma=\\{\\boldsymbol{x}:\\phi(\\boldsymbol{x})=0\\}$ and $|\\nabla \\phi|\\neq 0$ in a neighborhood of $\\Gamma$. Within a single square finite element of side length $h$, a standard piecewise-linear interpolation of $\\phi$ over the element yields a linear (straight-line) approximation to the interface inside the element by connecting the two edge intersection points where the interpolated $\\phi$ changes sign. Assume that, over the extent of this element, the exact interface $\\Gamma$ is well approximated by an osculating circular arc of constant curvature $\\kappa$ and radius $R=1/|\\kappa|$, and that the straight-line reconstruction spans a chord of length $L=h$ inside the element.\n\nStarting from fundamental geometric relations and Taylor expansions that follow from the smoothness of $\\phi$ and the definition of curvature, derive the leading-order expression for the maximum normal distance between the true interface and its straight-line reconstruction within the element. Express this leading-order maximum geometric error $\\delta_{\\max}$ in closed form as a function of $h$ and $\\kappa$.\n\nThen, propose a sub-element interface reconstruction based on a quadratic approximation of $\\phi$ that attains at least second-order accuracy in the interface position within the element. Justify the order of accuracy of your proposed method from first principles using Taylor’s theorem and the implicit function representation of $\\Gamma$.\n\nReport only the closed-form analytic expression you obtain for $\\delta_{\\max}$ as your final answer. No numerical rounding is required and no physical units are needed.", "solution": "**Part 1: Derivation of the Leading-Order Maximum Geometric Error $\\delta_{\\max}$**\n\nThe problem specifies that the true interface, $\\Gamma$, is locally approximated by a circular arc of constant curvature $\\kappa$, and its piecewise-linear reconstruction within a finite element is a chord of this arc. The radius of the circular arc is $R = 1/|\\kappa|$, and the length of the chord is given as $L=h$, where $h$ is the side length of the square element.\n\nWe aim to find the maximum normal distance, $\\delta_{\\max}$, between the circular arc and its chord. This distance is the sagitta of the circular segment defined by the arc and the chord. Let us set up a coordinate system with the center of the circle at the origin $(0,0)$. The equation of the circle is $x^2 + y^2 = R^2$. We can align the chord vertically, parallel to the $y$-axis, connecting the points $(x_c, -L/2)$ and $(x_c, L/2)$. The maximum distance $\\delta_{\\max}$ will lie along the $x$-axis.\n\nThe endpoints of the chord lie on the circle. Substituting one endpoint, $(x_c, L/2)$, into the circle's equation gives:\n$$ x_c^2 + \\left(\\frac{L}{2}\\right)^2 = R^2 $$\nSolving for $x_c$, we get $x_c = \\sqrt{R^2 - \\frac{L^2}{4}}$. The maximum distance, $\\delta_{\\max}$, is the difference between the radius $R$ (the extent of the arc along the $x$-axis) and the coordinate $x_c$ of the chord.\n$$ \\delta_{\\max} = R - x_c = R - \\sqrt{R^2 - \\frac{L^2}{4}} $$\nThis is the exact expression for the maximum geometric error under the stated assumptions. To find the leading-order expression for a small element size $h$ (and thus $L$), where $h \\ll R$, we perform a Taylor expansion. We factor out $R$ from the square root term:\n$$ \\delta_{\\max} = R - R\\left(1 - \\frac{L^2}{4R^2}\\right)^{1/2} $$\nWe use the binomial series expansion for $(1-z)^{1/2}$ where $z = \\frac{L^2}{4R^2}$ is a small quantity. The expansion is:\n$$ (1-z)^{1/2} = 1 - \\frac{1}{2}z - \\frac{1}{8}z^2 - O(z^3) $$\nSubstituting this into our expression for $\\delta_{\\max}$:\n$$ \\delta_{\\max} = R \\left[ 1 - \\left( 1 - \\frac{1}{2}\\left(\\frac{L^2}{4R^2}\\right) - \\frac{1}{8}\\left(\\frac{L^2}{4R^2}\\right)^2 - \\dots \\right) \\right] $$\n$$ \\delta_{\\max} = R \\left[ \\frac{L^2}{8R^2} + \\frac{L^4}{128R^4} + O\\left(\\left(\\frac{L}{R}\\right)^6\\right) \\right] $$\n$$ \\delta_{\\max} = \\frac{L^2}{8R} + \\frac{L^4}{128R^3} + \\dots $$\nThe problem asks for the leading-order expression, which is the first and most dominant term in this series as $L \\to 0$.\n$$ \\delta_{\\max} \\approx \\frac{L^2}{8R} $$\nFinally, we substitute the given relations $L=h$ and $R = 1/|\\kappa|$:\n$$ \\delta_{\\max} \\approx \\frac{h^2}{8(1/|\\kappa|)} = \\frac{|\\kappa| h^2}{8} $$\nThis result indicates that the geometric error of the piecewise-linear interface reconstruction is of second order, $O(h^2)$, with respect to the element size $h$.\n\n**Part 2: Proposal for a Higher-Order Interface Reconstruction**\n\nThe linear reconstruction yields a geometric error of order $O(h^2)$. To achieve higher accuracy, we must use a higher-order approximation for the level set function $\\phi(\\boldsymbol{x})$.\n\n**Proposed Method:** I propose a sub-element interface reconstruction based on a **quadratic interpolation** of the level set function $\\phi(\\boldsymbol{x})$. This requires a finite element formulation that supports quadratic basis functions, for example, a 6-node triangle ($T_2$) or a 9-node quadrilateral ($Q_2$). The interpolated level set function, $\\phi^h_{quad}(\\boldsymbol{x})$, is given by:\n$$ \\phi^h_{quad}(\\boldsymbol{x}) = \\sum_{j} M_j(\\boldsymbol{x}) \\phi(\\boldsymbol{x}_j) $$\nwhere $M_j(\\boldsymbol{x})$ are the quadratic shape functions and the sum is over the nodes $\\boldsymbol{x}_j$ of the higher-order element. The approximate interface, $\\Gamma^h$, is then the zero-isoline of this quadratic field:\n$$ \\Gamma^h = \\{ \\boldsymbol{x} \\in \\Omega_e \\mid \\phi^h_{quad}(\\boldsymbol{x}) = 0 \\} $$\nThis defines the interface as a conic section within the element, which can represent curvature and thus offers a more accurate approximation than a straight line.\n\n**Justification of Accuracy:** The accuracy of the interface position can be related to the interpolation error of the function $\\phi$. Let $\\boldsymbol{x}_\\Gamma$ be a point on the exact interface $\\Gamma$ (so $\\phi(\\boldsymbol{x}_\\Gamma) = 0$), and let $\\boldsymbol{x}^h_\\Gamma$ be the corresponding point on the approximate interface $\\Gamma^h$. The point $\\boldsymbol{x}^h_\\Gamma$ is at a normal distance $\\delta$ from $\\boldsymbol{x}_\\Gamma$, so $\\boldsymbol{x}^h_\\Gamma = \\boldsymbol{x}_\\Gamma + \\delta \\boldsymbol{n}$, where $\\boldsymbol{n}$ is the unit normal to $\\Gamma$ at $\\boldsymbol{x}_\\Gamma$.\n\nBy definition, $\\phi^h(\\boldsymbol{x}^h_\\Gamma) = 0$. The value of the exact function at this approximate point is $\\phi(\\boldsymbol{x}^h_\\Gamma) = \\phi(\\boldsymbol{x}^h_\\Gamma) - \\phi^h(\\boldsymbol{x}^h_\\Gamma) = E(\\boldsymbol{x}^h_\\Gamma)$, where $E$ is the interpolation error.\nA first-order Taylor expansion of $\\phi$ about $\\boldsymbol{x}_\\Gamma$ gives:\n$$ \\phi(\\boldsymbol{x}^h_\\Gamma) = \\phi(\\boldsymbol{x}_\\Gamma) + \\nabla \\phi(\\boldsymbol{x}_\\Gamma) \\cdot (\\delta \\boldsymbol{n}) + O(\\delta^2) $$\nSince $\\phi(\\boldsymbol{x}_\\Gamma) = 0$ and $\\boldsymbol{n} = \\nabla\\phi/|\\nabla\\phi|$, this simplifies to $\\phi(\\boldsymbol{x}^h_\\Gamma) \\approx \\delta |\\nabla\\phi(\\boldsymbol{x}_\\Gamma)|$. The problem states $|\\nabla\\phi| \\neq 0$, so we can write the geometric error $\\delta$ as:\n$$ \\delta \\approx \\frac{\\phi(\\boldsymbol{x}^h_\\Gamma)}{|\\nabla\\phi(\\boldsymbol{x}_\\Gamma)|} = \\frac{E(\\boldsymbol{x}^h_\\Gamma)}{|\\nabla\\phi(\\boldsymbol{x}_\\Gamma)|} $$\nThis shows that the geometric error is directly proportional to the interpolation error of $\\phi$. From standard approximation theory, for a sufficiently smooth function, interpolation with polynomials of degree $p$ on an element of size $h$ yields an error of order $O(h^{p+1})$.\n\nFor the linear reconstruction in Part 1, $p=1$, leading to an interpolation error $E = O(h^2)$ and a geometric error $\\delta = O(h^2)$, which agrees with our derivation.\n\nFor the proposed quadratic reconstruction, $p=2$. The interpolation error is $E = O(h^{p+1}) = O(h^3)$. Consequently, the geometric error of the interface is $\\delta = O(h^3)$. This method is third-order accurate, thus exceeding the \"at least second-order accuracy\" requirement and providing a significant improvement over the linear method.", "answer": "$$\\boxed{\\frac{|\\kappa| h^{2}}{8}}$$", "id": "2551518"}, {"introduction": "We now advance from modeling simple jumps to the singular stress fields at a crack tip, which requires a different class of 'branch' enrichment functions. While powerful, these singular functions introduce new numerical challenges, particularly concerning stability. This exercise confronts a common pitfall—the loss of positive definiteness in the stiffness matrix due to under-integration [@problem_id:2551528]. By analyzing this failure and deriving a stabilization scheme, you will gain a deeper appreciation for the mathematical robustness required for a successful fracture mechanics simulation.", "problem": "Consider a two-dimensional small-strain, linear elastic solid with a traction-free crack. Let the discretization be performed by the extended finite element method (XFEM), using the partition-of-unity framework with near-tip branch enrichment functions. Denote by the fourth-order elasticity tensor $\\mathbb{C}$ a symmetric positive-definite constitutive map, and by the bilinear form $a(u,v)=\\int_{\\Omega} \\varepsilon(v):\\mathbb{C}:\\varepsilon(u)\\,\\mathrm{d}\\Omega$, where $\\varepsilon(\\,\\cdot\\,)$ is the linearized strain operator and $\\Omega$ is the domain of an element that contains the crack tip. Let the vector of enriched degrees of freedom be $d_{b}\\in\\mathbb{R}^{n_{b}}$ and define the exact enriched subblock of the element stiffness matrix as\n$$\nS \\;=\\; \\int_{\\Omega} B_{b}^{\\mathsf{T}}\\,\\mathbb{C}\\,B_{b}\\,\\mathrm{d}\\Omega,\n$$\nwhere $B_{b}$ is the strain-displacement matrix associated with the branch-enriched shape functions. By construction, $S$ is symmetric positive definite.\n\nSuppose the element-level numerical integration of the enriched terms is performed with an under-integrated quadrature that does not resolve the crack-tip singular fields, resulting in a stiffness subblock approximation\n$$\n\\widetilde{K}_{e} \\;=\\; S \\;-\\; \\beta\\, v\\,v^{\\mathsf{T}},\n$$\nwith $\\beta0$ and $v\\in\\mathbb{R}^{n_{b}}\\setminus\\{0\\}$ representing, respectively, the magnitude and direction of a dominant spurious mode arising from the quadrature deficit. Assume the under-integration is sufficiently severe that\n$$\n\\beta\\, v^{\\mathsf{T}} S^{-1} v \\;>\\; 1.\n$$\n\n1) Using only the symmetry of $\\mathbb{C}$ and the definition of $S$ as a Galerkin stiffness block, analyze how such under-integration affects the symmetry and positive definiteness of $\\widetilde{K}_{e}$.\n\n2) As a remedy, consider a consistency-based stabilization that rescales the enriched block by adding a multiple of the exact integrand stiffness, leading to the stabilized subblock\n$$\n\\widehat{K}_{e}(\\delta) \\;=\\; (1+\\delta)\\,S \\;-\\; \\beta\\, v\\,v^{\\mathsf{T}},\n$$\nwith a scalar stabilization parameter $\\delta0$. Derive, from first principles, the minimal $\\delta$ such that $\\widehat{K}_{e}(\\delta)$ is positive definite. Your final answer must be a single closed-form analytic expression in terms of $\\beta$ and $v^{\\mathsf{T}} S^{-1} v$. Do not introduce any additional parameters or numerical values. Provide the expression with no units.", "solution": "Part $1$: Analysis of the symmetry and positive definiteness of $\\widetilde{K}_{e}$.\n\nThe under-integrated stiffness subblock is defined as $\\widetilde{K}_{e} = S - \\beta\\, v\\,v^{\\mathsf{T}}$. The matrix $S$ is the exact enriched subblock of the element stiffness matrix. By its construction as a Galerkin stiffness matrix from a symmetric bilinear form (stemming from a symmetric elasticity tensor $\\mathbb{C}$), $S$ is symmetric.\n\nFirst, we analyze the symmetry of $\\widetilde{K}_{e}$. We compute its transpose:\n$$\n\\widetilde{K}_{e}^{\\mathsf{T}} \\;=\\; (S - \\beta\\, v\\,v^{\\mathsf{T}})^{\\mathsf{T}} \\;=\\; S^{\\mathsf{T}} - (\\beta\\, v\\,v^{\\mathsf{T}})^{\\mathsf{T}}\n$$\nSince $S$ is symmetric, $S^{\\mathsf{T}} = S$. The term $\\beta$ is a scalar. The transpose of the outer product $v\\,v^{\\mathsf{T}}$ is:\n$$\n(v\\,v^{\\mathsf{T}})^{\\mathsf{T}} \\;=\\; (v^{\\mathsf{T}})^{\\mathsf{T}}v^{\\mathsf{T}} \\;=\\; v\\,v^{\\mathsf{T}}\n$$\nThis shows that $v\\,v^{\\mathsf{T}}$ is a symmetric matrix. Therefore, $\\widetilde{K}_{e}^{\\mathsf{T}} = S - \\beta\\, v\\,v^{\\mathsf{T}} = \\widetilde{K}_{e}$. The matrix $\\widetilde{K}_{e}$ is symmetric, irrespective of the under-integration. The symmetry property is unaffected.\n\nNext, we analyze the positive definiteness of $\\widetilde{K}_{e}$. A symmetric matrix $A$ is positive definite if the quadratic form $x^{\\mathsf{T}}Ax > 0$ for all non-zero vectors $x$. For $\\widetilde{K}_{e}$, this condition is:\n$$\nx^{\\mathsf{T}}\\widetilde{K}_{e}x \\;=\\; x^{\\mathsf{T}}(S - \\beta\\, v\\,v^{\\mathsf{T}})x \\;=\\; x^{\\mathsf{T}}Sx - \\beta\\,x^{\\mathsf{T}}v v^{\\mathsf{T}}x > 0\n$$\nThe term $v^{\\mathsf{T}}x$ is a scalar, so $x^{\\mathsf{T}}v v^{\\mathsf{T}}x = (x^{\\mathsf{T}}v)(v^{\\mathsf{T}}x) = (v^{\\mathsf{T}}x)^2$. The condition becomes:\n$$\nx^{\\mathsf{T}}Sx - \\beta\\,(v^{\\mathsf{T}}x)^2 > 0\n$$\nThe problem states that $S$ is positive definite, so $x^{\\mathsf{T}}Sx > 0$ for any $x \\neq 0$. However, the second term, $-\\beta\\,(v^{\\mathsf{T}}x)^2$, is non-positive since $\\beta > 0$. We must check if the sum can become non-positive for some $x \\neq 0$. We are given the condition $\\beta\\, v^{\\mathsf{T}} S^{-1} v > 1$. This suggests we should examine a specific vector related to $S^{-1}v$.\n\nLet us choose the test vector $x_0 = S^{-1}v$. Since $S$ is invertible and $v \\neq 0$, it follows that $x_0 \\neq 0$. Substituting $x_0$ into the quadratic form:\n$$\nx_0^{\\mathsf{T}}\\widetilde{K}_{e}x_0 \\;=\\; (S^{-1}v)^{\\mathsf{T}}S(S^{-1}v) - \\beta\\,((v^{\\mathsf{T}}S^{-1})v)^2\n$$\nSince $S$ is symmetric, its inverse $S^{-1}$ is also symmetric, thus $(S^{-1})^{\\mathsf{T}} = S^{-1}$.\n$$\nx_0^{\\mathsf{T}}\\widetilde{K}_{e}x_0 \\;=\\; v^{\\mathsf{T}}S^{-1}SS^{-1}v - \\beta\\,(v^{\\mathsf{T}}S^{-1}v)^2\n$$\n$$\nx_0^{\\mathsf{T}}\\widetilde{K}_{e}x_0 \\;=\\; v^{\\mathsf{T}}S^{-1}v - \\beta\\,(v^{\\mathsf{T}}S^{-1}v)^2\n$$\nFactoring out the term $v^{\\mathsf{T}}S^{-1}v$:\n$$\nx_0^{\\mathsf{T}}\\widetilde{K}_{e}x_0 \\;=\\; (v^{\\mathsf{T}}S^{-1}v) (1 - \\beta\\, v^{\\mathsf{T}}S^{-1}v)\n$$\nAs $S$ is positive definite, $S^{-1}$ is also positive definite. Thus, for $v \\neq 0$, the quadratic form $v^{\\mathsf{T}}S^{-1}v$ is strictly positive. The sign of the expression is determined by the sign of the second factor, $(1 - \\beta\\, v^{\\mathsf{T}}S^{-1}v)$.\nFrom the problem's premise, we have $\\beta\\, v^{\\mathsf{T}} S^{-1} v > 1$. This implies that $1 - \\beta\\, v^{\\mathsf{T}} S^{-1} v  0$.\nConsequently, for the specific non-zero vector $x_0 = S^{-1}v$, the quadratic form $x_0^{\\mathsf{T}}\\widetilde{K}_{e}x_0$ is the product of a positive term and a negative term, which is negative.\n$$\nx_0^{\\mathsf{T}}\\widetilde{K}_{e}x_0  0\n$$\nSince we have found a vector for which the quadratic form is negative, the matrix $\\widetilde{K}_{e}$ is not positive definite. It is indefinite. The under-integration has destroyed the positive definiteness of the stiffness matrix, which is a catastrophic failure for a static analysis.\n\nPart $2$: Derivation of the minimal stabilization parameter $\\delta$.\n\nThe stabilized subblock is given by $\\widehat{K}_{e}(\\delta) = (1+\\delta)\\,S - \\beta\\, v\\,v^{\\mathsf{T}}$, with $\\delta > 0$. We seek the minimal $\\delta$ that makes $\\widehat{K}_{e}(\\delta)$ positive definite. The condition for positive definiteness is:\n$$\nx^{\\mathsf{T}}\\widehat{K}_{e}(\\delta)x > 0 \\quad \\forall x \\in \\mathbb{R}^{n_b}\\setminus\\{0\\}\n$$\nSubstituting the definition of $\\widehat{K}_{e}(\\delta)$:\n$$\nx^{\\mathsf{T}}((1+\\delta)\\,S - \\beta\\, v\\,v^{\\mathsf{T}})x > 0\n$$\n$$\n(1+\\delta)\\,x^{\\mathsf{T}}Sx - \\beta\\,(v^{\\mathsf{T}}x)^2 > 0\n$$\nThis inequality must hold for all non-zero vectors $x$. If $v^{\\mathsf{T}}x = 0$, the inequality becomes $(1+\\delta)\\,x^{\\mathsf{T}}Sx > 0$, which is true since $\\delta>0$ and $S$ is positive definite. If $v^{\\mathsf{T}}x \\neq 0$, we can rearrange the inequality as:\n$$\n1+\\delta > \\beta\\,\\frac{(v^{\\mathsf{T}}x)^2}{x^{\\mathsf{T}}Sx}\n$$\nFor this condition to be universally true for all $x \\neq 0$, the term $1+\\delta$ must be strictly greater than the maximum possible value of the right-hand side.\n$$\n1+\\delta > \\max_{x\\neq 0} \\left( \\beta\\,\\frac{(v^{\\mathsf{T}}x)^2}{x^{\\mathsf{T}}Sx} \\right) = \\beta \\max_{x\\neq 0} \\left( \\frac{(v^{\\mathsf{T}}x)^2}{x^{\\mathsf{T}}Sx} \\right)\n$$\nWe must find the maximum of the generalized Rayleigh quotient $R(x) = \\frac{(v^{\\mathsf{T}}x)^2}{x^{\\mathsf{T}}Sx}$. Since $S$ is symmetric positive definite, we can introduce a change of variables $y = S^{1/2}x$, where $S^{1/2}$ is the unique symmetric positive definite square root of $S$. Then $x = S^{-1/2}y$.\n$$\nR(x) = \\frac{(v^{\\mathsf{T}}S^{-1/2}y)^2}{(S^{-1/2}y)^{\\mathsf{T}}S(S^{-1/2}y)} = \\frac{((S^{-1/2}v)^{\\mathsf{T}}y)^2}{y^{\\mathsf{T}}S^{-1/2}SS^{-1/2}y} = \\frac{((S^{-1/2}v)^{\\mathsf{T}}y)^2}{y^{\\mathsf{T}}y}\n$$\nLet $u = S^{-1/2}v$. The expression becomes $\\frac{(u^{\\mathsf{T}}y)^2}{\\|y\\|^2_2}$. By the Cauchy-Schwarz inequality, $|u^{\\mathsf{T}}y| \\leq \\|u\\|_2 \\|y\\|_2$, so $(u^{\\mathsf{T}}y)^2 \\leq \\|u\\|^2_2 \\|y\\|^2_2$. The maximum value is $\\|u\\|^2_2$, which is attained when $y$ is collinear with $u$.\n$$\n\\max_{x\\neq 0} R(x) = \\|u\\|^2_2 = \\|S^{-1/2}v\\|^2_2 = (S^{-1/2}v)^{\\mathsf{T}}(S^{-1/2}v) = v^{\\mathsf{T}}S^{-1/2}S^{-1/2}v = v^{\\mathsf{T}}S^{-1}v\n$$\nSubstituting this maximum value back into our inequality for stabilization:\n$$\n1+\\delta > \\beta\\,(v^{\\mathsf{T}}S^{-1}v)\n$$\nSolving for $\\delta$:\n$$\n\\delta > \\beta\\,(v^{\\mathsf{T}}S^{-1}v) - 1\n$$\nThe problem asks for the minimal $\\delta$ that ensures positive definiteness. This corresponds to the infimum of the set of valid $\\delta$ values. This boundary value is where the matrix ceases to be strictly positive definite and becomes positive semi-definite (i.e., its smallest eigenvalue becomes zero). Therefore, the critical value is the lower bound of this inequality.\nThe minimal required stabilization parameter is\n$$\n\\delta_{min} = \\beta\\,(v^{\\mathsf{T}}S^{-1}v) - 1\n$$\nThe condition $\\beta\\,(v^{\\mathsf{T}}S^{-1}v) > 1$ given in the problem ensures that this minimal $\\delta$ is indeed positive, as required. Any $\\delta > \\delta_{min}$ will render the matrix $\\widehat{K}_{e}(\\delta)$ positive definite.", "answer": "$$\\boxed{\\beta \\left(v^{\\mathsf{T}} S^{-1} v\\right) - 1}$$", "id": "2551528"}]}