{"hands_on_practices": [{"introduction": "To begin our exploration of singular elements, we'll start with a direct verification exercise. This practice demonstrates the remarkable accuracy of the quarter-point mapping by comparing its ability to represent the known analytical crack-face displacement field against that of a standard quadratic element. By implementing this comparison [@problem_id:2596472], you will gain a concrete, quantitative understanding of a quarter-point element's power to capture the characteristic $\\sqrt{r}$ behavior near a crack tip.", "problem": "Consider verification of singular crack-tip interpolation against analytical near-tip fields in two-dimensional isotropic Linear Elastic Fracture Mechanics (LEFM) for a Mode I crack under plane strain. Assume a homogeneous, isotropic material with Young’s modulus $E$ and Poisson’s ratio $\\nu$, and let the shear modulus be $\\mu = \\dfrac{E}{2(1+\\nu)}$ and the Kolosov constant be $\\kappa = 3 - 4 \\nu$ (plane strain). Near the crack tip, in polar coordinates $(r,\\theta)$ centered at the tip with the crack lying along the negative $x$-axis, the leading-order asymptotic displacement on the crack faces at $\\theta = \\pm \\pi$ for Mode I with stress intensity factor $K_I$ is the well-tested LEFM result\n$$\nu_y^{\\pm}(r) = \\pm \\frac{K_I}{2 \\mu} \\sqrt{\\frac{r}{2 \\pi}} \\, (\\kappa + 1), \\quad u_x^{\\pm}(r) = 0,\n$$\nwhere angles are in radians and $r$ is in meters. Define the constant\n$$\nC = \\frac{K_I}{2 \\mu} \\sqrt{\\frac{1}{2 \\pi}} (\\kappa + 1),\n$$\nso that $u_y^{+}(r) = C \\sqrt{r}$ on the upper crack face $\\theta = \\pi$.\n\nFocus on approximating $u_y^{+}(r)$ along the upper crack face over a segment $r \\in [0, L]$ using a single quadratic edge (three-node) isoparametric interpolation with the natural coordinate $\\xi \\in [-1,1]$ and quadratic Lagrange shape functions on the edge:\n- $N_1(\\xi) = \\dfrac{1}{2} \\xi (\\xi - 1)$ for the tip node at $\\xi = -1$,\n- $N_5(\\xi) = 1 - \\xi^2$ for the midside node at $\\xi = 0$,\n- $N_2(\\xi) = \\dfrac{1}{2} \\xi (\\xi + 1)$ for the far node at $\\xi = +1$.\n\nTwo geometric mappings are to be considered for the isoparametric relation $r(\\xi) = N_1(\\xi) r_1 + N_5(\\xi) r_5 + N_2(\\xi) r_2$:\n- Standard non-singular mapping: $r_1 = 0$, $r_5 = L/2$, $r_2 = L$.\n- Quarter-point singular crack-tip mapping: $r_1 = 0$, $r_5 = L/4$, $r_2 = L$.\n\nIn both cases, the nodal displacement values are taken from the analytical solution at the nodal physical positions: $u_1 = C \\sqrt{r_1}$, $u_5 = C \\sqrt{r_5}$, $u_2 = C \\sqrt{r_2}$. The finite element interpolation along the edge is\n$$\nu_h(\\xi) = N_1(\\xi) u_1 + N_5(\\xi) u_5 + N_2(\\xi) u_2.\n$$\nThe exact analytical value at a parametric location $\\xi$ is $u_{\\text{ex}}(\\xi) = C \\sqrt{r(\\xi)}$.\n\nYour tasks:\n- For each mapping, evaluate the approximation error at the sample set of parametric points $\\Xi = [-0.5, 0.0, 0.5, 0.8]$. Use the relative discrete $L^2$-error\n$$\ne_{L^2} = \\sqrt{\\frac{\\sum_{\\xi \\in \\Xi} \\left(u_h(\\xi) - u_{\\text{ex}}(\\xi)\\right)^2}{\\sum_{\\xi \\in \\Xi} u_{\\text{ex}}(\\xi)^2}}.\n$$\n- For each mapping, estimate $K_I$ using the displacement correlation idea at the midside location $\\xi = 0$. Let $\\delta = 2 u_h(0)$ denote the crack opening displacement at the upper face (twice the upper-face displacement magnitude), and let $r_m = r(0)$ be the midside physical distance from the tip. Invert the analytical relation $\\delta = 2 C \\sqrt{r}$ to compute\n$$\nK_{\\text{est}} = \\delta \\, \\mu \\, \\sqrt{2 \\pi} \\Big/ \\left((\\kappa + 1) \\sqrt{r_m}\\right),\n$$\nand measure the relative error $e_K = \\left|K_{\\text{est}} - K_I\\right|/K_I$.\n\nAll quantities are to be treated in the International System of Units (SI): $E$ in $\\text{Pa}$, $K_I$ in $\\text{Pa} \\cdot \\sqrt{\\text{m}}$, $L$ in $\\text{m}$, and displacements in $\\text{m}$. Angles are in radians. The computed errors $e_{L^2}$ and $e_K$ are dimensionless.\n\nTest suite:\n- Case $1$: $E = 210\\times 10^9$, $\\nu = 0.3$, $K_I = 25\\times 10^6$, $L = 1\\times 10^{-3}$.\n- Case $2$: $E = 70\\times 10^9$, $\\nu = 0.33$, $K_I = 1\\times 10^6$, $L = 1\\times 10^{-2}$.\n- Case $3$: $E = 3\\times 10^9$, $\\nu = 0.49$, $K_I = 5\\times 10^5$, $L = 5\\times 10^{-4}$.\n\nFor each case, compute four numbers: the relative discrete $L^2$-error for the standard mapping $e_{L^2}^{\\text{std}}$, the relative discrete $L^2$-error for the quarter-point mapping $e_{L^2}^{\\text{qp}}$, the relative $K$-error for the standard mapping $e_{K}^{\\text{std}}$, and the relative $K$-error for the quarter-point mapping $e_{K}^{\\text{qp}}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a Python-style list of lists, with one inner list per test case in the order given. Each inner list must be $[e_{L^2}^{\\text{std}}, e_{L^2}^{\\text{qp}}, e_{K}^{\\text{std}}, e_{K}^{\\text{qp}}]$, using decimal notation. For example, a line like $[[0.1,0.0,0.2,0.0],[\\dots],\\dots]$.", "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in the principles of Linear Elastic Fracture Mechanics and the Finite Element Method, is well-posed with sufficient and consistent data, and is formulated with objective, unambiguous language. The tasks constitute a standard verification exercise in computational fracture mechanics. We may thus proceed with the solution.\n\nThe problem requires the evaluation of two types of error for two different isoparametric mappings of a quadratic line element used to model the near-tip displacement field on a crack face. The analysis can be generalized before application to the specific test cases.\n\nLet us begin by defining the material constants from the given Young's modulus $E$ and Poisson's ratio $\\nu$:\nThe shear modulus $\\mu$ is given by\n$$ \\mu = \\frac{E}{2(1+\\nu)} $$\nThe Kolosov constant $\\kappa$ for plane strain is\n$$ \\kappa = 3 - 4\\nu $$\nThe analytical displacement on the upper crack face $(\\theta = \\pi)$ is $u_y^+(r) = C \\sqrt{r}$, where the constant $C$ is defined as\n$$ C = \\frac{K_I}{2 \\mu} \\sqrt{\\frac{1}{2 \\pi}} (\\kappa + 1) $$\nHere, $K_I$ is the Mode I Stress Intensity Factor.\n\nThe finite element approximation uses three-node quadratic Lagrange shape functions:\n$N_1(\\xi) = \\frac{1}{2}\\xi(\\xi-1)$, $N_5(\\xi) = 1-\\xi^2$, and $N_2(\\xi) = \\frac{1}{2}\\xi(\\xi+1)$.\nThe geometry $r(\\xi)$ and displacement $u_h(\\xi)$ are interpolated isoparametrically:\n$$ r(\\xi) = N_1(\\xi) r_1 + N_5(\\xi) r_5 + N_2(\\xi) r_2 $$\n$$ u_h(\\xi) = N_1(\\xi) u_1 + N_5(\\xi) u_5 + N_2(\\xi) u_2 $$\nThe nodal coordinates are defined with respect to the element length $L$, with the crack tip at $r_1=0$. The nodal displacements are set from the analytical solution: $u_1 = C\\sqrt{r_1}$, $u_5 = C\\sqrt{r_5}$, $u_2 = C\\sqrt{r_2}$. Since $r_1=0$, it follows that $u_1=0$.\n\nFirst, we analyze the quarter-point mapping, for which the nodal coordinates are $r_1=0$, $r_5=L/4$, and $r_2=L$. The geometric mapping is:\n$$ r(\\xi) = N_1(\\xi)(0) + N_5(\\xi)\\frac{L}{4} + N_2(\\xi)L = (1-\\xi^2)\\frac{L}{4} + \\frac{1}{2}\\xi(\\xi+1)L $$\n$$ r(\\xi) = \\frac{L}{4} (1-\\xi^2 + 2\\xi(\\xi+1)) = \\frac{L}{4} (1-\\xi^2 + 2\\xi^2 + 2\\xi) = \\frac{L}{4} (1 + 2\\xi + \\xi^2) = \\frac{L}{4}(1+\\xi)^2 $$\nThe exact displacement at a parametric location $\\xi$ is $u_{\\text{ex}}(\\xi) = C\\sqrt{r(\\xi)}$. Substituting the mapping gives:\n$$ u_{\\text{ex}}(\\xi) = C \\sqrt{\\frac{L}{4}(1+\\xi)^2} = \\frac{C\\sqrt{L}}{2}(1+\\xi) $$\nNow, we evaluate the finite element interpolation $u_h(\\xi)$. The nodal displacements are $u_1 = 0$, $u_5 = C\\sqrt{L/4} = C\\sqrt{L}/2$, and $u_2 = C\\sqrt{L}$.\n$$ u_h(\\xi) = N_1(\\xi)(0) + N_5(\\xi)\\frac{C\\sqrt{L}}{2} + N_2(\\xi)C\\sqrt{L} = C\\sqrt{L} \\left( \\frac{1}{2}(1-\\xi^2) + \\frac{1}{2}\\xi(\\xi+1) \\right) $$\n$$ u_h(\\xi) = \\frac{C\\sqrt{L}}{2} (1-\\xi^2 + \\xi^2+\\xi) = \\frac{C\\sqrt{L}}{2}(1+\\xi) $$\nWe find that $u_h(\\xi) = u_{\\text{ex}}(\\xi)$ for all $\\xi \\in [-1,1]$. This is a fundamental property of the quarter-point element: it exactly reproduces the $\\sqrt{r}$ singularity behavior along its edge. Consequently, the approximation error $(u_h(\\xi) - u_{\\text{ex}}(\\xi))$ is identically zero for all sample points. Therefore, the relative discrete $L^2$-error for the quarter-point mapping must be zero:\n$$ e_{L^2}^{\\text{qp}} = 0 $$\n\nNext, we analyze the error in the estimated Stress Intensity Factor, $e_K$. The estimation formula is:\n$$ K_{\\text{est}} = \\frac{\\delta \\mu \\sqrt{2\\pi}}{(\\kappa+1)\\sqrt{r_m}} $$\nwhere $\\delta = 2 u_h(0)$ and $r_m = r(0)$. At the midside location $\\xi=0$, the shape functions are $N_1(0)=0$, $N_5(0)=1$, and $N_2(0)=0$.\nThis gives $r_m = r(0) = r_5$ and $u_h(0) = u_5$.\nThe crack opening is $\\delta = 2u_5$. Substituting these into the $K_{\\text{est}}$ formula:\n$$ K_{\\text{est}} = \\frac{(2u_5) \\mu \\sqrt{2\\pi}}{(\\kappa+1)\\sqrt{r_5}} $$\nThe nodal displacement $u_5$ is prescribed from the analytical solution, $u_5 = C\\sqrt{r_5}$. Substituting this and the definition of $C$:\n$$ K_{\\text{est}} = \\frac{2 \\left( \\frac{K_I}{2 \\mu} \\sqrt{\\frac{1}{2 \\pi}} (\\kappa + 1) \\sqrt{r_5} \\right) \\mu \\sqrt{2\\pi}}{(\\kappa+1)\\sqrt{r_5}} $$\nThe terms algebraically cancel:\n$$ K_{\\text{est}} = \\frac{2 K_I (\\kappa+1) \\sqrt{r_5} \\mu \\sqrt{2\\pi}}{2 \\mu \\sqrt{2\\pi} (\\kappa+1) \\sqrt{r_5}} = K_I $$\nThis result holds regardless of the position of the midside node, $r_5$. It applies to both the standard mapping ($r_5 = L/2$) and the quarter-point mapping ($r_5 = L/4$). The method of estimating $K_I$ is tautological given that the nodal displacements are set from the analytical solution. Thus, the relative error $e_K = |K_{\\text{est}} - K_I|/K_I$ is zero for both mappings:\n$$ e_{K}^{\\text{std}} = 0 \\quad \\text{and} \\quad e_{K}^{\\text{qp}} = 0 $$\n\nFinally, we analyze the $L^2$-error for the standard non-singular mapping, where $r_1=0$, $r_5=L/2$, and $r_2=L$. The geometric mapping is:\n$$ r(\\xi) = (1-\\xi^2)\\frac{L}{2} + \\frac{1}{2}\\xi(\\xi+1)L = \\frac{L}{2}(1-\\xi^2 + \\xi^2+\\xi) = \\frac{L}{2}(1+\\xi) $$\nThe exact displacement is $u_{\\text{ex}}(\\xi) = C\\sqrt{r(\\xi)} = C\\sqrt{\\frac{L}{2}(1+\\xi)}$.\nThe nodal displacements are $u_1=0$, $u_5=C\\sqrt{L/2}$, $u_2=C\\sqrt{L}$. The interpolation is:\n$$ u_h(\\xi) = u_5 N_5(\\xi) + u_2 N_2(\\xi) = C\\sqrt{L/2}\\,(1-\\xi^2) + C\\sqrt{L}\\,\\frac{1}{2}\\xi(\\xi+1) $$\n$$ u_h(\\xi) = C\\sqrt{L} \\left( \\frac{1-\\xi^2}{\\sqrt{2}} + \\frac{\\xi(\\xi+1)}{2} \\right) $$\nUnlike the quarter-point case, $u_h(\\xi)$ is not equal to $u_{\\text{ex}}(\\xi)$. We must compute the relative error:\n$$ e_{L^2}^{\\text{std}} = \\sqrt{\\frac{\\sum_{\\xi \\in \\Xi} \\left(u_h(\\xi) - u_{\\text{ex}}(\\xi)\\right)^2}{\\sum_{\\xi \\in \\Xi} u_{\\text{ex}}(\\xi)^2}} $$\nNotice that both $u_h(\\xi)$ and $u_{\\text{ex}}(\\xi)$ are proportional to the factor $C\\sqrt{L}$. This factor cancels from the numerator and denominator of the relative error expression. Thus, $e_{L^2}^{\\text{std}}$ is a constant value independent of $E, \\nu, K_I, L$. We calculate this value for the sample points $\\Xi = [-0.5, 0.0, 0.5, 0.8]$.\nLet us define normalized displacements $\\tilde{u}_h(\\xi) = u_h(\\xi)/(C\\sqrt{L})$ and $\\tilde{u}_{\\text{ex}}(\\xi) = u_{\\text{ex}}(\\xi)/(C\\sqrt{L})$.\n$$ \\tilde{u}_{\\text{ex}}(\\xi) = \\sqrt{\\frac{1+\\xi}{2}} $$\n$$ \\tilde{u}_h(\\xi) = \\frac{1-\\xi^2}{\\sqrt{2}} + \\frac{\\xi(\\xi+1)}{2} $$\nWe evaluate the sums for $\\xi \\in \\Xi$:\n- For $\\xi = -0.5$: $\\tilde{u}_{\\text{ex}} = \\sqrt{0.25} = 0.5$, $\\tilde{u}_h = \\frac{0.75}{\\sqrt{2}} - 0.125 \\approx 0.40533$.\n- For $\\xi = 0.0$: $\\tilde{u}_{\\text{ex}} = \\sqrt{0.5} \\approx 0.70711$, $\\tilde{u}_h = \\frac{1}{\\sqrt{2}} \\approx 0.70711$. (Error is zero at the node).\n- For $\\xi = 0.5$: $\\tilde{u}_{\\text{ex}} = \\sqrt{0.75} \\approx 0.86603$, $\\tilde{u}_h = \\frac{0.75}{\\sqrt{2}} + 0.375 \\approx 0.90533$.\n- For $\\xi = 0.8$: $\\tilde{u}_{\\text{ex}} = \\sqrt{0.9} \\approx 0.94868$, $\\tilde{u}_h = \\frac{0.36}{\\sqrt{2}} + 0.72 \\approx 0.97456$.\n\nSum of squared errors: $\\sum (\\tilde{u}_h - \\tilde{u}_{\\text{ex}})^2 \\approx (-0.09467)^2 + 0^2 + (0.03930)^2 + (0.02588)^2 \\approx 0.008962 + 0 + 0.001545 + 0.000670 = 0.011177$.\nSum of squared exact values: $\\sum \\tilde{u}_{\\text{ex}}^2 = 0.25 + 0.5 + 0.75 + 0.9 = 2.4$.\nThe relative error is:\n$$ e_{L^2}^{\\text{std}} = \\sqrt{\\frac{0.011177}{2.4}} \\approx \\sqrt{0.004657} \\approx 0.06824 $$\nTherefore, for any valid set of physical parameters, the four computed error metrics will be $[0.06824, 0.0, 0.0, 0.0]$. This result applies to all three test cases provided.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the FEM crack-tip interpolation verification problem for three test cases.\n    \"\"\"\n\n    # Define the set of parametric points for error evaluation.\n    xi_points = np.array([-0.5, 0.0, 0.5, 0.8])\n\n    # Define the quadratic Lagrange shape functions.\n    # N1 is not needed since r1=u1=0.\n    def N5(xi):\n        return 1 - xi**2\n\n    def N2(xi):\n        return 0.5 * xi * (xi + 1)\n\n    test_cases = [\n        # Case 1: E (Pa), nu, K_I (Pa.sqrt(m)), L (m)\n        (210e9, 0.3, 25e6, 1e-3),\n        # Case 2\n        (70e9, 0.33, 1e6, 1e-2),\n        # Case 3\n        (3e9, 0.49, 5e5, 5e-4),\n    ]\n\n    all_results = []\n\n    for E, nu, K_I, L in test_cases:\n        \n        # As derived in the solution, the relative errors e_L2^qp, e_K^std, and e_K^qp\n        # are analytically zero for this problem setup.\n        # The error e_L2^std is a constant, independent of the physical parameters.\n        # The full calculation is performed here for completeness and to demonstrate\n        # the procedure for a general case.\n\n        # ----- 1. Standard Mapping -----\n        \n        # Midside node at L/2\n        r5_std = L / 2.0\n        r2_std = L\n        \n        # Normalized displacements (division by C*sqrt(L)) for error calculation\n        # This makes the calculation independent of C and L.\n        # u_h_norm = u_h / (C*sqrt(L))\n        # u_ex_norm = u_ex / (C*sqrt(L))\n\n        sum_sq_err_std = 0.0\n        sum_sq_ex_std = 0.0\n        \n        for xi in xi_points:\n            # Physical coordinate r(xi) = L/2 * (1+xi)\n            r_val = (L / 2.0) * (1 + xi)\n            \n            # Exact solution (normalized)\n            u_ex_norm = np.sqrt(r_val / L) # = sqrt(0.5*(1+xi))\n            \n            # Interpolated solution (normalized)\n            # u5_norm = sqrt(r5_std/L) = sqrt(0.5)\n            # u2_norm = sqrt(r2_std/L) = 1.0\n            u_h_norm = np.sqrt(0.5) * N5(xi) + 1.0 * N2(xi)\n\n            sum_sq_err_std += (u_h_norm - u_ex_norm)**2\n            sum_sq_ex_std += u_ex_norm**2\n        \n        # The denominator sum_sq_ex_std cannot be zero for the given Xi.\n        e_L2_std = np.sqrt(sum_sq_err_std / sum_sq_ex_std) if sum_sq_ex_std > 0 else 0.0\n        \n        # As shown analytically, K_est = K_I, so the error is zero.\n        e_K_std = 0.0\n\n        # ----- 2. Quarter-Point Mapping -----\n        \n        # The QP element exactly reproduces the sqrt(r) field.\n        # Therefore, the interpolation error is identically zero.\n        e_L2_qp = 0.0\n        \n        # As shown analytically, K_est = K_I, so the error is zero.\n        e_K_qp = 0.0\n\n        all_results.append([e_L2_std, e_L2_qp, e_K_std, e_K_qp])\n\n    # Final print statement in the exact required format.\n    print(f\"{all_results}\")\n\nsolve()\n```", "id": "2596472"}, {"introduction": "Having seen *that* quarter-point elements work, our next practice delves into *how* they achieve this. The magic lies in the interaction between the isoparametric mapping and the numerical integration process. This exercise [@problem_id:2602837] tasks you with implementing a Gaussian quadrature routine to see firsthand how the Jacobian determinant of a quarter-point mapping elegantly regularizes a singular integrand, making it suitable for standard numerical evaluation.", "problem": "You are tasked with implementing an element-level Gaussian quadrature procedure to evaluate a domain integral appearing in the computation of Stress Intensity Factors (SIF) within the Finite Element Method (FEM). The evaluation must be performed in isoparametric elements, with correct handling of elements employing a quarter-point mapping at a crack tip. Your program will compute a singular, yet integrable, domain integral that serves as a proxy for the singular kernel arising in the domain form of path-independent integrals used for SIF extraction.\n\nStart from a fundamental base appropriate for advanced computations of crack-tip fields in linear elasticity:\n- Conservation of energy and the definition of the energy release rate, which undergirds the path-independent crack integrals.\n- The divergence theorem, justifying conversion of line integrals into domain integrals.\n- The near-tip asymptotic nature of fields in linear elastic fracture mechanics, which implies singular integrands in the vicinity of the crack tip, and motivates special isoparametric mappings.\n\nYou must not use any prepackaged or shortcut SIF formulas. Instead, your implementation should be based on the following principles:\n- The isoparametric mapping from a square reference domain with local coordinates $(\\xi,\\eta)\\in[-1,1]^2$ to a physical element.\n- Gaussian quadrature to evaluate an area integral by sampling the integrand at quadrature points in the reference domain and multiplying by the determinant of the Jacobian of the isoparametric mapping.\n- The need for special treatment for elements with quarter-point mapping near a crack tip, where mid-side nodes on edges emanating from the crack tip are shifted to quarter points so that the mapping reproduces the correct square-root singularity in strain fields and regularizes the composite integrand-with-Jacobian for numerical integration.\n\nTarget integral to evaluate:\n- Define the crack tip to be located at the origin in Cartesian coordinates. Let $r=\\sqrt{x^2+y^2}$ denote the distance to the crack tip. Consider the scalar function $g(x,y)=r^{-1/2}$, which captures, in a surrogate sense, the algebraic singularity structure relevant to crack-tip energies.\n- For a given physical rectangular element of size $L$ (in the $x$-direction) and $H$ (half-height in the $y$-direction), aligned such that the crack lies along the $x$-axis and the crack tip is at the left edge at $x=0$, define the physical domain for a single element as $\\Omega=\\{(x,y): 0\\le x\\le L,\\ -H\\le y\\le H\\}$.\n- The integral to evaluate is the domain integral\n$$\nI(L,H)=\\iint_{\\Omega} g(x,y)\\,d\\Omega=\\iint_{\\Omega} r^{-1/2}\\,dx\\,dy.\n$$\nThis integral has units of $\\mathrm{m}^{3/2}$ when $L$ and $H$ are expressed in meters.\n\nElement types and mappings:\n- Case A uses a $4$-node bilinear isoparametric quadrilateral (commonly denoted Q4) mapping the reference square to $\\Omega$ with corner nodes at $(0,-H)$, $(L,-H)$, $(L,H)$, $(0,H)$.\n- Case B and Case C use an $8$-node serendipity isoparametric quadrilateral (commonly denoted Q8) with quarter-point placement to model a crack tip: the tip is located at the mid-side node on the left edge. The physical coordinates of the $8$ nodes (ordered in the standard serendipity convention with mid-side nodes) are:\n    - Node $1$: $(0,-H)$ at $(\\xi,\\eta)=(-1,-1)$,\n    - Node $2$: $(L,-H)$ at $(\\xi,\\eta)=(1,-1)$,\n    - Node $3$: $(L,H)$ at $(\\xi,\\eta)=(1,1)$,\n    - Node $4$: $(0,H)$ at $(\\xi,\\eta)=(-1,1)$,\n    - Node $5$: $(L/4,-H)$ at $(\\xi,\\eta)=(0,-1)$ (bottom edge mid-side shifted to quarter point),\n    - Node $6$: $(L,0)$ at $(\\xi,\\eta)=(1,0)$ (right edge mid-side),\n    - Node $7$: $(L/4,H)$ at $(\\xi,\\eta)=(0,1)$ (top edge mid-side shifted to quarter point),\n    - Node $8$: $(0,0)$ at $(\\xi,\\eta)=(-1,0)$ (left edge mid-side at the crack tip).\nThis quarter-point mapping emulates the square-root behavior of crack-tip fields by causing the physical radial coordinate to scale quadratically with a reference coordinate along edges emanating from the tip.\n\nQuadrature and algorithmic requirements:\n- Use tensor-product Gaussian quadrature of order $n$ per direction on the reference square for each element. At each quadrature point $(\\xi_i,\\eta_j)$ with weights $(w_i,w_j)$:\n    1. Evaluate isoparametric shape functions and their derivatives to compute the physical coordinates $(x,y)$ and the Jacobian matrix $J(\\xi,\\eta)$.\n    2. Compute the determinant $\\det J(\\xi,\\eta)$.\n    3. Evaluate $g(x,y)=\\left(x^2+y^2\\right)^{-1/4}$ taking care to avoid division by zero by a suitable limiting treatment at $r=0$.\n    4. Accumulate the contribution $g(x,y)\\,\\det J(\\xi,\\eta)\\,w_i\\,w_j$.\n- Ensure all computations are in the International System of Units (SI), with $L$ and $H$ in meters and the integral $I$ reported in $\\mathrm{m}^{3/2}$.\n\nSpecial treatment justification:\n- Explain, in your approach, why the quarter-point mapping is necessary near a crack tip for accurate numerical integration of singular fields, and how it alters the Jacobian to regularize the integrand in the reference space.\n\nTest suite and required output:\n- Implement and evaluate the integral $I(L,H)$ for the following three test cases:\n    1. Case A (baseline, standard isoparametric Q4): $L=1.0, H=0.5, quadrature order n=8$.\n    2. Case B (quarter-point isoparametric Q8): $L=1.0, H=0.5, quadrature order n=8$.\n    3. Case C (quarter-point isoparametric Q8, smaller domain and higher resolution): $L=0.1, H=0.05, quadrature order n=16$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, \"[result1,result2,result3]\". Each result must be a floating-point number representing $I(L,H)$ in $\\mathrm{m}^{3/2}$ for the corresponding test case, using standard decimal notation with no units in the text output. Internally, you must work consistently in SI units.\n\nDeliverables:\n- A complete, runnable program that implements the above, adheres to the specified quadrature and isoparametric mappings, computes the three requested integrals, and outputs them exactly in the specified single-line format.", "solution": "The problem requires the numerical evaluation of a singular domain integral, a task frequently encountered in computational fracture mechanics for the calculation of stress intensity factors using domain-based conservation integrals like the J-integral. The integral is defined as:\n$$\nI(L,H) = \\iint_{\\Omega} g(x,y)\\,d\\Omega = \\iint_{\\Omega} (x^2+y^2)^{-1/4}\\,dx\\,dy\n$$\nThe function $g(x,y) = r^{-1/2} = (x^2+y^2)^{-1/4}$, where $r = \\sqrt{x^2+y^2}$ is the radial distance from the origin, possesses a singularity at the crack tip located at $(0,0)$. This singularity is integrable, as a change to polar coordinates reveals an integrand of the form $r^{-1/2} \\cdot r \\,dr\\,d\\theta = r^{1/2}\\,dr\\,d\\theta$, which is finite at $r=0$. However, standard numerical quadrature schemes perform poorly on singular integrands. The solution is to use an isoparametric mapping from a regular reference domain, the square $(\\xi,\\eta) \\in [-1,1]^2$, to the physical element domain $\\Omega$.\n\nThe integral transforms as:\n$$\nI = \\iint_{\\Omega} g(x,y)\\,dx\\,dy = \\int_{-1}^{1}\\int_{-1}^{1} g\\left(x(\\xi,\\eta), y(\\xi,\\eta)\\right) \\det[J(\\xi,\\eta)] \\,d\\xi\\,d\\eta\n$$\nwhere $J(\\xi,\\eta)$ is the Jacobian matrix of the mapping $(x,y) = \\mathbf{X}(\\xi,\\eta)$. This transformed integral is then approximated using a tensor-product Gaussian quadrature rule:\n$$\nI \\approx \\sum_{i=1}^{n} \\sum_{j=1}^{n} w_i w_j g\\left(x(\\xi_i,\\eta_j), y(\\xi_i,\\eta_j)\\right) \\det[J(\\xi_i,\\eta_j)]\n$$\nHere, $(\\xi_i, \\eta_j)$ are the quadrature points and $(w_i, w_j)$ are the corresponding weights for an order-$n$ rule. The core of the problem lies in the formulation of the mapping $\\mathbf{X}(\\xi,\\eta)$ and its Jacobian. The mapping is defined using shape functions $N_k(\\xi,\\eta)$ and nodal coordinates $(x_k, y_k)$:\n$$\nx(\\xi,\\eta) = \\sum_{k} N_k(\\xi,\\eta) x_k \\quad , \\quad y(\\xi,\\eta) = \\sum_{k} N_k(\\xi,\\eta) y_k\n$$\nThe Jacobian matrix components are computed as:\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\sum_k \\frac{\\partial N_k}{\\partial \\xi} x_k & \\sum_k \\frac{\\partial N_k}{\\partial \\xi} y_k \\\\ \\sum_k \\frac{\\partial N_k}{\\partial \\eta} x_k & \\sum_k \\frac{\\partial N_k}{\\partial \\eta} y_k \\end{pmatrix}\n$$\nWe analyze each case as specified.\n\nCase A: $4$-Node Bilinear Quadrilateral (Q4)\nFor the specified physical corner nodes $(0,-H), (L,-H), (L,H), (0,H)$, the standard Q4 isoparametric mapping from $(\\xi,\\eta) \\in [-1,1]^2$ simplifies to:\n$$\nx(\\xi,\\eta) = \\frac{L}{2}(1+\\xi) \\quad , \\quad y(\\xi,\\eta) = H\\eta\n$$\nThe Jacobian matrix is constant and diagonal:\n$$\nJ = \\begin{pmatrix} L/2 & 0 \\\\ 0 & H \\end{pmatrix} \\implies \\det(J) = \\frac{LH}{2}\n$$\nThe integrand in the reference space is $g \\det(J) = \\left( (\\frac{L}{2}(1+\\xi))^2 + (H\\eta)^2 \\right)^{-1/4} \\frac{LH}{2}$. The singularity of $g$ at the physical origin $(0,0)$ is mapped to the point $(\\xi,\\eta)=(-1,0)$ on the boundary of the reference domain. Standard Gauss-Legendre quadrature points lie in $(-1,1)$, so division by zero is not encountered, but the integrand varies sharply near this point, compromising the accuracy of the quadrature for low orders.\n\nCases B and C: $8$-Node Serendipity Quadrilateral (Q8) with Quarter-Point Mapping\nThis configuration is designed specifically to handle the crack-tip singularity. The crack tip is located at node $8$ with physical coordinate $(0,0)$ and reference coordinate $(\\xi,\\eta)=(-1,0)$. The crucial feature is the placement of mid-side nodes $5$ and $7$ at the quarter-points of the top and bottom physical edges ($x=L/4$), rather than the mid-points ($x=L/2$).\n\nJustification for Special Treatment:\nThe purpose of the quarter-point element is to embed the known asymptotic behavior of the near-tip field into the element's mapping. For a mode-I crack, displacements are proportional to $\\sqrt{r}$ and strains/stresses are proportional to $1/\\sqrt{r}$, where $r$ is the distance from the tip. The energy density, related to strain squared, is proportional to $1/r$. The current integrand $g(x,y)$ has a $1/\\sqrt{r}$ behavior, characteristic of certain terms in domain integral formulations.\n\nLet us analyze the mapping provided by the specified Q8 element along the line $\\eta=0$, which corresponds to the physical crack line $y=0$. The mapping reduces to:\n$$\nx(\\xi,0) = \\frac{L}{4}(1+\\xi)^2\n$$\nNear the crack tip $(\\xi \\to -1)$, let $\\zeta = 1+\\xi$. The physical radial coordinate $r$ scales as $r=x \\propto \\zeta^2$. This implies $\\sqrt{r} \\propto \\zeta = 1+\\xi$.\n\nNow, we examine the Jacobian determinant. A detailed analysis shows that near the crack tip at $(\\xi,\\eta)=(-1,0)$, the Jacobian matrix has the asymptotic form $J \\approx \\begin{pmatrix} \\frac{L}{2}(1+\\xi) & 0 \\\\ 0 & H \\end{pmatrix}$, leading to a determinant:\n$$\n\\det(J) \\propto (1+\\xi) \\propto \\sqrt{r}\n$$\nThe term to be integrated in the reference space is the product $g(x,y)\\det(J)$. Near the tip, its behavior is:\n$$\ng \\cdot \\det(J) \\propto \\frac{1}{\\sqrt{r}} \\cdot \\sqrt{r} = 1\n$$\nThe singularity in the original function $g(x,y)$ is canceled by the singularity embedded in the Jacobian determinant. The resulting integrand $g\\det(J)$ is regular (and nearly constant) in the reference space $(\\xi,\\eta)$, even at the point corresponding to the crack tip. Therefore, standard Gaussian quadrature can evaluate the integral with high accuracy. This regularization is the fundamental reason for using quarter-point elements in fracture mechanics.\n\nThe implementation will proceed by defining the shape functions and their derivatives for both Q4 and Q8 elements, constructing the Jacobian at each Gauss point, and accumulating the weighted sum.", "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef shape_functions_q4(xi, eta):\n    \"\"\"\n    Computes shape functions and their derivatives for a 4-node quad element.\n    Nodes are ordered CCW from bottom-left (-1,-1).\n    \"\"\"\n    xi_nodes = np.array([-1, 1, 1, -1])\n    eta_nodes = np.array([-1, -1, 1, 1])\n\n    N = 0.25 * (1 + xi * xi_nodes) * (1 + eta * eta_nodes)\n    \n    dN_dxi = 0.25 * xi_nodes * (1 + eta * eta_nodes)\n    dN_deta = 0.25 * eta_nodes * (1 + xi * xi_nodes)\n\n    return N, dN_dxi, dN_deta\n\ndef shape_functions_q8(xi, eta):\n    \"\"\"\n    Computes shape functions and their derivatives for an 8-node serendipity quad element.\n    Node numbering is as specified in the problem statement.\n    \"\"\"\n    N = np.zeros(8)\n    dN_dxi = np.zeros(8)\n    dN_deta = np.zeros(8)\n    \n    xi2 = xi * xi\n    eta2 = eta * eta\n\n    # Corner nodes (i=0 to 3, corresponding to nodes 1 to 4)\n    xi_n = np.array([-1, 1, 1, -1])\n    eta_n = np.array([-1, -1, 1, 1])\n\n    for i in range(4):\n        s = xi * xi_n[i]\n        t = eta * eta_n[i]\n        N[i] = 0.25 * (1 + s) * (1 + t) * (s + t - 1)\n        dN_dxi[i] = 0.25 * xi_n[i] * (1 + t) * (2 * s + t)\n        dN_deta[i] = 0.25 * eta_n[i] * (1 + s) * (s + 2 * t)\n\n    # Midside nodes (i=4 to 7, corresponding to nodes 5 to 8)\n    # Node 5: (xi=0, eta=-1)\n    N[4] = 0.5 * (1 - xi2) * (1 - eta)\n    dN_dxi[4] = -xi * (1 - eta)\n    dN_deta[4] = -0.5 * (1 - xi2)\n    \n    # Node 6: (xi=1, eta=0)\n    N[5] = 0.5 * (1 + xi) * (1 - eta2)\n    dN_dxi[5] = 0.5 * (1 - eta2)\n    dN_deta[5] = -eta * (1 + xi)\n\n    # Node 7: (xi=0, eta=1)\n    N[6] = 0.5 * (1 - xi2) * (1 + eta)\n    dN_dxi[6] = -xi * (1 + eta)\n    dN_deta[6] = 0.5 * (1 - xi2)\n    \n    # Node 8: (xi=-1, eta=0)\n    N[7] = 0.5 * (1 - xi) * (1 - eta2)\n    dN_dxi[7] = -0.5 * (1 - eta2)\n    dN_deta[7] = -eta * (1 - xi)\n    \n    return N, dN_dxi, dN_deta\n\ndef evaluate_integral(L, H, n, element_type):\n    \"\"\"\n    Evaluates the domain integral using Gaussian quadrature.\n    \"\"\"\n    # Get Gaussian quadrature points and weights\n    xi_p, w = roots_legendre(n)\n    \n    # Physical nodal coordinates\n    if element_type == 'Q4':\n        x_nodes = np.array([0, L, L, 0])\n        y_nodes = np.array([-H, -H, H, H])\n        shape_func = shape_functions_q4\n    elif element_type == 'Q8':\n        x_nodes = np.array([0, L, L, 0, L/4, L, L/4, 0])\n        y_nodes = np.array([-H, -H, H, H, -H, 0, H, 0])\n        shape_func = shape_functions_q8\n    else:\n        raise ValueError(\"Unknown element type\")\n\n    integral_val = 0.0\n\n    # Tensor product quadrature loop\n    for i in range(n):\n        for j in range(n):\n            xi = xi_p[i]\n            eta = xi_p[j]\n            wi = w[i]\n            wj = w[j]\n\n            N, dN_dxi, dN_deta = shape_func(xi, eta)\n\n            # Isoparametric mapping\n            x = np.dot(N, x_nodes)\n            y = np.dot(N, y_nodes)\n\n            # Jacobian matrix\n            J11 = np.dot(dN_dxi, x_nodes)\n            J12 = np.dot(dN_dxi, y_nodes)\n            J21 = np.dot(dN_deta, x_nodes)\n            J22 = np.dot(dN_deta, y_nodes)\n\n            detJ = J11 * J22 - J12 * J21\n            \n            # Integrand a(x,y) = (x^2 + y^2)^(-1/4)\n            # Quadrature points are in (-1,1), so r will not be exactly 0\n            # for the mappings used.\n            r_squared = x*x + y*y\n            g = r_squared**(-0.25)\n            \n            integral_val += g * detJ * wi * wj\n            \n    return integral_val\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (L, H, n, element_type)\n        (1.0, 0.5, 8, 'Q4'),\n        (1.0, 0.5, 8, 'Q8'),\n        (0.1, 0.05, 16, 'Q8'),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, H, n, element_type = case\n        result = evaluate_integral(L, H, n, element_type)\n        results.append(result)\n        \n    # Format the output as specified\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "2602837"}, {"introduction": "Understanding a single singular element is crucial, but its true power is realized within a well-designed mesh. This final practice shifts our focus from the element level to the broader strategy of mesh construction around a crack tip. By analyzing different meshing strategies [@problem_id:2596483], you will learn to identify the principles of an asymptotically optimal mesh, one that combines the correct element type with appropriate radial grading and angular resolution to achieve maximum accuracy efficiently.", "problem": "A homogeneous, isotropic, linear elastic body in plane strain contains a straight crack with tip at the origin in polar coordinates $\\left(r,\\theta\\right)$ attached to the crack tip. In Linear Elastic Fracture Mechanics (LEFM), the leading-order near-tip asymptotics of the displacement and stress fields for Mode $I$ loading have the forms $u \\sim C_{u} \\, K \\, r^{1/2} \\, \\Phi_{u}\\!\\left(\\theta,\\nu\\right)$ and $\\sigma \\sim C_{\\sigma} \\, K \\, r^{-1/2} \\, \\Phi_{\\sigma}\\!\\left(\\theta,\\nu\\right)$, where $K$ is the stress intensity factor, $\\nu$ is Poisson’s ratio, and $C_{u}$, $C_{\\sigma}$, $\\Phi_{u}$, $\\Phi_{\\sigma}$ are constants and angular functions independent of $r$. In the Finite Element Method (FEM), “singular crack-tip elements” seek to incorporate this $r^{\\pm 1/2}$ behavior into the approximation space by suitable isoparametric mappings (for example, through quarter-point node placement) and mesh grading.\n\nYou are asked to select, among the following candidate near-tip mesh designs, the one(s) that is(are) asymptotically optimal for accurate recovery of the Mode $I$ stress intensity factor $K$ with a fixed number of degrees of freedom in the near-tip zone. “Asymptotically optimal” here means that, for a given number of unknowns concentrated in a small annular neighborhood of the crack tip, the design both:\n(i) embeds the correct $r^{1/2}$ displacement singularity in the finite element shape functions along the radial direction so that the leading-order singular field is represented without pollution by regular terms, and\n(ii) equidistributes the energy-norm error density in the near-tip annulus by appropriate radial mesh grading and resolves the angular dependence $\\left(\\sim \\sin\\!\\left(\\theta/2\\right), \\cos\\!\\left(\\theta/2\\right)\\right)$ sufficiently well to avoid an angular-resolution-controlled error.\n\nAssume isoparametric elements with standard Gauss integration suitable for the chosen interpolation order, and that $K$ is extracted using a convergent equivalent domain integral (for example, the $J$-integral in its domain form). Consider the following four designs for the first few rings of elements surrounding the tip:\n\nA. Use $8$-node isoparametric quadrilateral elements arranged in concentric rings. On the two edges that emanate from the crack tip and bound the crack faces, place the mid-side nodes at the quarter points so that the radial mapping along the crack line satisfies $r\\!\\left(\\xi\\right)\\propto \\left(1+\\xi\\right)^{2}$, where $\\xi\\in[-1,1]$ is the parent-coordinate in the radial direction. Choose radial element thicknesses in geometric progression such that $\\Delta r_{k}=\\alpha\\, r_{k}$ with a constant $\\alpha\\in\\left(0,1\\right)$, and place at least $8$ elements per ring in the circumferential direction in the first ring.\n\nB. Use $6$-node isoparametric triangular elements with all mid-side nodes at edge midpoints (no quarter-point mapping). Perform strong local $h$-refinement near the tip but keep the radial element thickness uniform, i.e., $\\Delta r_{k}=\\text{const}$ for the first several rings, and use $4$ elements around the tip in the first ring.\n\nC. Use $4$-node isoparametric quadrilateral elements with uniform mesh spacing in both radial and circumferential directions in a small disk around the tip. Do not modify node locations (no singular mapping), but make the mesh sufficiently fine so that the smallest elements have radial size comparable to the process zone, with $12$ elements around the tip in the first ring.\n\nD. Use $8$-node isoparametric quadrilateral quarter-point elements as in Design A for the first ring only, but keep the radial spacing uniform $\\left(\\Delta r_{k}=\\text{const}\\right)$ for the next rings and use only $2$ circumferential elements in each ring.\n\nWhich design(s) satisfy criteria $(i)$ and $(ii)$ above and thus deliver the fastest asymptotic convergence of the computed $K$ with respect to the number of near-tip degrees of freedom?\n\nChoose one or more of the following:\nA. Design A\nB. Design B\nC. Design C\nD. Design D", "solution": "The user has provided a problem from the field of computational fracture mechanics, specifically concerning the design of finite element meshes for accurately calculating the Mode $I$ stress intensity factor, $K_I$. I shall first validate the problem statement and then proceed to a detailed solution.\n\n### Step 1: Extract Givens\n- **Physical System**: A homogeneous, isotropic, linear elastic body in plane strain.\n- **Geometry**: A straight crack with its tip at the origin of a polar coordinate system $(r, \\theta)$.\n- **LEFM Asymptotics**: For Mode $I$ loading, the near-tip fields are given as:\n  - Displacement: $u \\sim C_{u} \\, K \\, r^{1/2} \\, \\Phi_{u}\\!\\left(\\theta,\\nu\\right)$\n  - Stress: $\\sigma \\sim C_{\\sigma} \\, K \\, r^{-1/2} \\, \\Phi_{\\sigma}\\!\\left(\\theta,\\nu\\right)$\n- **FEM Objective**: To use \"singular crack-tip elements\" to incorporate the $r^{\\pm 1/2}$ behavior via isoparametric mappings.\n- **Definition of \"Asymptotically Optimal\" Mesh Design**:\n  - (i) Embeds the correct $r^{1/2}$ displacement singularity in the shape functions along the radial direction.\n  - (ii) Equidistributes the energy-norm error density in the near-tip annulus through appropriate radial mesh grading and sufficiently resolves the angular dependence.\n- **Assumptions**:\n  - Isoparametric elements with suitable Gauss integration.\n  - $K$ is extracted via a convergent equivalent domain integral (e.g., $J$-integral).\n- **Question**: Select the mesh design(s) from the given options that satisfy criteria (i) and (ii).\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is evaluated against the validation criteria.\n\n- **Scientific Groundedness**: The problem is based on the well-established theories of Linear Elastic Fracture Mechanics (LEFM) and the Finite Element Method (FEM). The $r^{1/2}$ displacement and $r^{-1/2}$ stress singularities are canonical results for a crack in a linear elastic material. The technique of using quarter-point singular elements to model this singularity is a standard and validated procedure in computational fracture mechanics, first proposed by R.S. Barsoum and R.D. Henshell and K.G. Shaw. The concept of an asymptotically optimal mesh is also a cornerstone of advanced FEM theory. The problem is scientifically and factually sound.\n- **Well-Posedness**: The problem is well-posed. It clearly defines the objective (accurate recovery of $K$) and provides two explicit criteria for what constitutes an \"asymptotically optimal\" design. These criteria are precise and allow for a unique, correct answer to be determined based on established FEM principles.\n- **Objectivity**: The problem is stated in precise, objective, and technical language. Terms like \"isoparametric mapping\", \"quarter-point node\", \"energy-norm error\", and \"geometric progression\" have unambiguous meanings in this context.\n\n### Step 3: Verdict and Action\nThe problem statement is **VALID**. It is a standard, well-posed problem in advanced computational mechanics that tests fundamental knowledge of finite element techniques for fracture analysis. I will now proceed with the solution.\n\n### Derivation and Analysis\n\nThe goal is to find the mesh design that is \"asymptotically optimal\" for recovering the stress intensity factor $K$. This requires satisfying two criteria: (i) correctly representing the field singularity and (ii) efficiently distributing the discretization error.\n\n**Analysis of Criterion (i): Embedding the Singularity**\n\nThe near-tip displacement field behaves as $u \\sim r^{1/2}$. Consequently, the strain $\\varepsilon = \\nabla_s u$ and stress $\\sigma = C:\\varepsilon$ fields behave as $\\sigma, \\varepsilon \\sim r^{-1/2}$. Standard polynomial shape functions used in FEM cannot represent such a function with a singularity at $r=0$. This leads to poor accuracy and a suboptimal rate of convergence unless the mesh is extremely fine near the tip.\n\nSingular elements are designed to overcome this. The standard method involves using quadratic isoparametric elements ($8$-node quadrilaterals or $6$-node triangles) and shifting the mid-side nodes to the \"quarter-point\" position.\n\nConsider a straight edge of a quadratic element of length $L$ starting at the crack tip ($r=0$). The nodes along this edge are at the tip, the mid-side, and the far end. Let the parent coordinate along this edge be $\\xi \\in [-1, 1]$, with $\\xi=-1$ at the crack tip. The nodal coordinates in the parent element are $\\xi_1 = -1$, $\\xi_2 = 0$, $\\xi_3 = 1$. The quadratic shape functions for the mapping are $N_1(\\xi)=-\\frac{1}{2}\\xi(1-\\xi)$, $N_2(\\xi)=1-\\xi^2$, and $N_3(\\xi)=\\frac{1}{2}\\xi(1+\\xi)$.\n\nThe quarter-point technique places the physical nodes at $r_1=0$, $r_2=L/4$, and $r_3=L$. The isoparametric mapping for the radial coordinate $r$ along this edge is then:\n$$r(\\xi) = N_1(\\xi)r_1 + N_2(\\xi)r_2 + N_3(\\xi)r_3 = (1-\\xi^2)\\frac{L}{4} + \\frac{1}{2}\\xi(1+\\xi)L$$\n$$r(\\xi) = \\frac{L}{4}(1-\\xi^2+2\\xi+2\\xi^2) = \\frac{L}{4}(1+2\\xi+\\xi^2) = \\frac{L}{4}(1+\\xi)^2$$\nThis confirms the relation given in Option A. Now, we examine the displacement field. The displacement $u$ is interpolated using the same shape functions from the nodal displacements $u_1, u_2, u_3$:\n$$u(\\xi) = N_1(\\xi)u_1 + N_2(\\xi)u_2 + N_3(\\xi)u_3$$\nThis is a general quadratic polynomial in $\\xi$: $u(\\xi) = A_0 + A_1\\xi + A_2\\xi^2$. From the coordinate mapping, we have $(1+\\xi) = \\sqrt{4r/L}$, so $\\xi = \\sqrt{4r/L} - 1$. Substituting this into the displacement interpolation:\n$$u(r) = A_0 + A_1\\left(\\sqrt{\\frac{4r}{L}}-1\\right) + A_2\\left(\\sqrt{\\frac{4r}{L}}-1\\right)^2$$\n$$u(r) = (A_0 - A_1 + A_2) + \\left(\\frac{2A_1}{\\sqrt{L}} - \\frac{4A_2}{\\sqrt{L}}\\right)\\sqrt{r} + \\left(\\frac{4A_2}{L}\\right)r$$\nThis shows that the displacement field along the radial edge is of the form $u(r) = C_1 + C_2\\sqrt{r} + C_3 r$. This function space contains the required $r^{1/2}$ term, allowing the element to exactly represent the leading-order singular displacement field. Consequently, the strain field, $\\varepsilon_{rr} = \\partial u/\\partial r$, will contain the necessary $r^{-1/2}$ term.\n\nTherefore, criterion (i) is satisfied **only** by designs that employ quadratic elements with quarter-point node placement.\n\n**Analysis of Criterion (ii): Error Equidistribution and Angular Resolution**\n\nThe strain energy density $U_0$ near the crack tip scales as $U_0 \\sim (\\sigma \\cdot \\varepsilon) \\sim (r^{-1/2})^2 \\sim r^{-1}$. For an optimal mesh, the error in the energy norm should be distributed as evenly as possible among all elements. For a singularity of this type, theory and practice have firmly established that the optimal radial grading is a geometric progression. This means the radial size of the elements, $\\Delta r_k$, should increase proportionally with their distance from the tip, $r_k$. That is, $\\Delta r_k / r_k = \\text{constant}$, or $\\Delta r_k = \\alpha r_k$ for some constant ratio $\\alpha$. A uniform mesh ($\\Delta r_k = \\text{constant}$) is suboptimal, concentrating too much error in the elements closest to the tip and requiring significantly more degrees of freedom for the same accuracy.\n\nFor the angular resolution, the near-tip fields have a characteristic benign angular dependence, typically involving $\\sin(\\theta/2)$ and $\\cos(\\theta/2)$. These are smooth functions. However, they must be adequately resolved. A design with only $2$ or $4$ elements around the circumference ($180^\\circ$ or $90^\\circ$ per element, respectively) would introduce large interpolation errors in the angular direction. A reasonable number, such as $8$ or more elements, is required to keep the angular error from dominating the total error.\n\n### Option-by-Option Analysis\n\n**A. Design A**\n- **Criterion (i)**: Uses $8$-node (quadratic) isoparametric elements with quarter-point mid-side nodes. As derived above, this correctly embeds the $r^{1/2}$ displacement singularity. This criterion is **satisfied**.\n- **Criterion (ii)**: Employs radial mesh grading in a geometric progression ($\\Delta r_{k}=\\alpha\\, r_{k}$). This is the asymptotically optimal strategy for radial error equidistribution. Uses at least $8$ elements per ring, which provides sufficient angular resolution. This criterion is **satisfied**.\n- **Verdict**: Design A meets both criteria for an asymptotically optimal mesh design. It is the textbook example of a state-of-the-art mesh for LEFM problems. **Correct**.\n\n**B. Design B**\n- **Criterion (i)**: Uses $6$-node (quadratic) triangles but explicitly states \"no quarter-point mapping\". Without this mapping, the element cannot capture the $r^{1/2}$ singularity. This criterion is **not satisfied**.\n- **Criterion (ii)**: Employs uniform radial thickness ($\\Delta r_{k}=\\text{const}$), which is a suboptimal grading scheme. It also uses only $4$ elements around the tip, which is a coarse angular resolution. This criterion is **not satisfied**.\n- **Verdict**: This design fails on all critical aspects. **Incorrect**.\n\n**C. Design C**\n- **Criterion (i)**: Uses $4$-node (linear) quadrilateral elements. These elements lack the mid-side nodes required for the quarter-point mapping and cannot embed the singularity. This criterion is **not satisfied**.\n- **Criterion (ii)**: Employs uniform mesh spacing in both directions, which is suboptimal for the radial direction. This criterion is **not satisfied**.\n- **Verdict**: Brute-force uniform refinement with linear elements is highly inefficient for singular problems. This design is far from optimal. **Incorrect**.\n\n**D. Design D**\n- **Criterion (i)**: Uses quarter-point elements for the first ring, which is a correct step to capture the singularity. This criterion is **partially satisfied**, as the most important region is handled correctly.\n- **Criterion (ii)**: Employs uniform radial spacing for subsequent rings, which is a suboptimal grading strategy. More critically, it uses \"only $2$ circumferential elements in each ring\". This angular resolution is catastrophically poor. An element spanning $180^\\circ$ cannot possibly resolve the angular functions of the Williams expansion (e.g., $\\cos(\\theta/2)$). The resulting angular error would be enormous and would dominate the solution entirely. This criterion is **not satisfied**.\n- **Verdict**: Despite using the correct element type in the first ring, the abysmal angular resolution and suboptimal radial grading make this a very poor design. **Incorrect**.\n\n### Conclusion\nBased on the analysis, only Design A incorporates all the necessary features of an asymptotically optimal mesh for this class of problem: the correct singular element formulation, the optimal radial mesh grading, and sufficient angular resolution.", "answer": "$$\\boxed{A}$$", "id": "2596483"}]}