{"hands_on_practices": [{"introduction": "In modern Finite Element Method (FEM) software, the $J$-integral is a common output for fracture analysis due to its numerical robustness. This first exercise provides practice in translating this energy-based result into the more intuitive stress intensity factor, $K_I$. By converting a given $J$-value to $K_I$ and comparing it with a known analytical solution, you will reinforce your understanding of the fundamental relationship between these key fracture parameters and practice a crucial validation skill. [@problem_id:2574927]", "problem": "A very wide, thick plate made of a homogeneous, isotropic, linear elastic material contains a central through-crack of total length $2a$. The plate is subjected to a uniform remote tensile stress $\\sigma$ perpendicular to the crack plane. Owing to its large thickness, plane strain conditions apply in the crack-tip region. A Finite Element Method (FEM) analysis using the domain form of the path-independent $J$-integral (denoted $J$) yields a mesh-converged value for the energy release rate at the crack tip.\n\nMaterial properties and loading are:\n- Young’s modulus $E = 210\\,\\text{GPa}$,\n- Poisson’s ratio $\\nu = 0.30$,\n- Remote tensile stress $\\sigma = 120\\,\\text{MPa}$,\n- Half-crack length $a = 20\\,\\text{mm}$.\n\nThe domain integral result is $J = 3.900 \\times 10^{3}\\,\\text{N/m}$.\n\nAssume the plate is sufficiently wide that finite-width effects are negligible and the central-crack solution for an infinite plate is applicable. Using fundamental concepts from linear elastic fracture mechanics and the relationship between energy release rate and stress intensity factor under plane strain, compute the Mode I stress intensity factor $K_I$ corresponding to the given $J$. Express $K_I$ in $\\text{MPa}\\sqrt{\\text{m}}$ and round your value to four significant figures.\n\nThen, validate this result by comparing it to the analytical Mode I stress intensity factor for a very wide plate with a central through-crack under uniform tension. As your final reported value, provide the relative difference between the FEM-derived $K_I$ and the analytical $K_I$, defined as $\\left|K_I^{\\text{FEM}}-K_I^{\\text{an}}\\right|/K_I^{\\text{an}}$, expressed as a decimal (not with a percent sign) and rounded to four significant figures.", "solution": "The solution proceeds in three steps. First, the Mode I stress intensity factor, $K_I^{\\text{FEM}}$, is computed from the given $J$-integral value under plane strain conditions. Second, the analytical Mode I stress intensity factor, $K_I^{\\text{an}}$, is calculated for a central crack in an infinite plate. Third, the relative difference between $K_I^{\\text{FEM}}$ and $K_I^{\\text{an}}$ is determined.\n\nThe givens are:\n- Material properties: Young’s modulus $E = 210\\,\\text{GPa}$, Poisson’s ratio $\\nu = 0.30$.\n- Geometric parameter: half-crack length $a = 20\\,\\text{mm}$.\n- Loading condition: uniform remote tensile stress $\\sigma = 120\\,\\text{MPa}$.\n- State of stress: plane strain.\n- Result from FEM: $J$-integral $J = 3.900 \\times 10^{3}\\,\\text{N/m}$.\n- Assumption: Infinite plate (finite-width correction factor is unity).\n\n**Step 1: Computation of $K_I$ from the $J$-integral.**\nFor a homogeneous, linear elastic material, the $J$-integral is equal to the energy release rate, $G$. For a pure Mode I loading condition under plane strain, the relationship is:\n$$J = G_I = \\frac{1-\\nu^2}{E} K_I^2$$\nSolving for $K_I$ to find the value derived from the FEM result:\n$$K_I^{\\text{FEM}} = \\sqrt{\\frac{J E}{1-\\nu^2}}$$\nUsing a consistent set of SI units (meters, Newtons, Pascals):\n- $J = 3.900 \\times 10^{3}\\,\\text{N/m}$\n- $E = 210\\,\\text{GPa} = 210 \\times 10^9\\,\\text{N/m}^2$\n- $\\nu = 0.30$\n\nSubstituting these values:\n$$K_I^{\\text{FEM}} = \\sqrt{\\frac{(3.900 \\times 10^3\\,\\text{N/m})(210 \\times 10^9\\,\\text{N/m}^2)}{1 - (0.30)^2}}$$\n$$K_I^{\\text{FEM}} = \\sqrt{\\frac{8.19 \\times 10^{14}\\,\\text{N}^2/\\text{m}^3}{1 - 0.09}} = \\sqrt{\\frac{8.19 \\times 10^{14}}{0.91}\\,\\text{N}^2/\\text{m}^3}$$\n$$K_I^{\\text{FEM}} = \\sqrt{9.00 \\times 10^{14}\\,\\text{N}^2/\\text{m}^3} = 3.00 \\times 10^7\\,\\text{Pa}\\sqrt{\\text{m}}$$\nConverting to the required units ($1\\,\\text{MPa} = 10^6\\,\\text{Pa}$):\n$$K_I^{\\text{FEM}} = 30.00\\,\\text{MPa}\\sqrt{\\text{m}}$$\n\n**Step 2: Computation of the analytical $K_I$.**\nFor a central through-crack of total length $2a$ in an infinite plate under uniform remote tension $\\sigma$, the analytical solution for the Mode I stress intensity factor is:\n$$K_I^{\\text{an}} = \\sigma \\sqrt{\\pi a}$$\nThe given values are:\n- $\\sigma = 120\\,\\text{MPa}$\n- $a = 20\\,\\text{mm} = 0.020\\,\\text{m}$\nTo obtain $K_I^{\\text{an}}$ in units of $\\text{MPa}\\sqrt{\\text{m}}$, we use $\\sigma$ in MPa and $a$ in meters:\n$$K_I^{\\text{an}} = 120\\,\\text{MPa} \\sqrt{\\pi (0.020\\,\\text{m})}$$\n$$K_I^{\\text{an}} = 120 \\sqrt{0.020 \\pi} \\,\\text{MPa}\\sqrt{\\text{m}} \\approx 30.079539\\,\\text{MPa}\\sqrt{\\text{m}}$$\n\n**Step 3: Computation of the relative difference.**\nThe relative difference is defined as $\\frac{|K_I^{\\text{FEM}} - K_I^{\\text{an}}|}{K_I^{\\text{an}}}$. Using the calculated values:\n$$K_I^{\\text{FEM}} = 30.00\\,\\text{MPa}\\sqrt{\\text{m}}$$\n$$K_I^{\\text{an}} \\approx 30.079539\\,\\text{MPa}\\sqrt{\\text{m}}$$\nThe relative difference is:\n$$\\text{Relative Difference} = \\frac{|30.00 - 30.079539|}{30.079539} = \\frac{0.079539}{30.079539} \\approx 0.00264427$$\nRounding this result to four significant figures as instructed:\n$$\\text{Relative Difference} \\approx 0.002644$$\nThis small difference indicates a high degree of accuracy in the Finite Element Method analysis.", "answer": "$$\\boxed{0.002644}$$", "id": "2574927"}, {"introduction": "While FEM solvers can compute fracture parameters automatically, understanding the underlying methods is crucial for an expert analyst. This practice challenges you to implement one of the most direct techniques for extracting stress intensity factors: the displacement correlation method. By fitting the near-tip displacement field from a simulation to the theoretical asymptotic solution, you will gain hands-on experience in how the foundational equations of LEFM are used to post-process numerical data. [@problem_id:2574883]", "problem": "Consider a two-dimensional, homogeneous, isotropic, linear elastic body containing a sharp crack with its tip at the origin and crack line aligned with the negative $x$-axis. Under the framework of Linear Elastic Fracture Mechanics (LEFM), the displacement field near the crack tip exhibits an $O(\\sqrt{r})$ singularity in polar coordinates $(r,\\theta)$ centered at the crack tip. Assume plane strain conditions, and that the material is characterized by Young’s modulus $E$ and Poisson’s ratio $\\nu$. Let the shear modulus be $\\mu = \\dfrac{E}{2(1+\\nu)}$, and the Kolosov constant be $\\kappa = 3 - 4\\nu$.\n\nYour task is to write a complete program that, given finite element nodal displacements around the crack tip, estimates the Mode I and Mode II stress intensity factors, $K_I$ and $K_{II}$, by least-squares fitting to the $O(\\sqrt{r})$ displacement asymptotics. The approach should treat $K_I$ and $K_{II}$ as unknown linear coefficients multiplying known shape functions of $\\theta$ and $\\sqrt{r}$.\n\nStarting from fundamental elasticity and fracture definitions, use the near-tip asymptotic displacement field for isotropic plane strain to set up a linear regression model for the measured Cartesian displacements $(u_x, u_y)$ at a set of nodes with known $(r_i,\\theta_i)$. Construct a design matrix from the asymptotic shape functions so that a least-squares solution yields estimates $\\widehat{K}_I$ and $\\widehat{K}_{II}$.\n\nYou must implement the following for each test case:\n- Compute the predicted near-tip displacement basis functions consistent with isotropic plane strain LEFM at each node $(r_i,\\theta_i)$.\n- Assemble an overdetermined linear system that maps the two unknowns $K_I$ and $K_{II}$ to the stacked vector of measured displacements.\n- Solve for $K_I$ and $K_{II}$ in a least-squares sense.\n- Report the estimated values in $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$, rounded to three decimal places.\n\nUse the following test suite. In all tests: plane strain is assumed, angles are in radians, distances are in meters, displacements are in meters, $E$ is in gigapascals (to be converted to pascals within your computation), and $K_I, K_{II}$ are in $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$ (to be converted to $\\mathrm{Pa}\\sqrt{\\mathrm{m}}$ for internal calculations). For synthetic \"finite element\" nodal displacements, generate data by evaluating the asymptotic displacement field and then adding a small, deterministic noise: for node index $i$ (starting at $i=1$ for each test), add $\\delta u_{x,i} = \\eta \\sin(i)$ and $\\delta u_{y,i} = \\eta \\cos(2i)$, where $\\eta$ is specified per test. Use the nodes in the listed order to define the index $i$.\n\n- Test $1$ (pure Mode I):\n  - $E = 210 \\,\\mathrm{GPa}$, $\\nu = 0.3$.\n  - True values for synthetic data generation: $K_I = 25 \\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$, $K_{II} = 0 \\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$.\n  - Node polar coordinates:\n    - $r = [1.5\\times 10^{-3}, 2.5\\times 10^{-3}, 3.5\\times 10^{-3}, 4.5\\times 10^{-3}, 2.0\\times 10^{-3}, 3.0\\times 10^{-3}]$,\n    - $\\theta = [-\\pi/4, 0, \\pi/6, \\pi/3, -\\pi/6, \\pi/2]$.\n  - Noise amplitude: $\\eta = 1.0\\times 10^{-12} \\,\\mathrm{m}$.\n\n- Test $2$ (pure Mode II):\n  - $E = 210 \\,\\mathrm{GPa}$, $\\nu = 0.3$.\n  - True values for synthetic data generation: $K_I = 0 \\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$, $K_{II} = 18 \\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$.\n  - Node polar coordinates:\n    - $r = [0.8\\times 10^{-3}, 1.2\\times 10^{-3}, 2.2\\times 10^{-3}, 3.8\\times 10^{-3}, 5.0\\times 10^{-3}, 4.0\\times 10^{-3}]$,\n    - $\\theta = [-\\pi/3, -\\pi/6, 0.2, 0.9, 1.3, -0.7]$.\n  - Noise amplitude: $\\eta = 2.0\\times 10^{-12} \\,\\mathrm{m}$.\n\n- Test $3$ (mixed mode):\n  - $E = 210 \\,\\mathrm{GPa}$, $\\nu = 0.3$.\n  - True values for synthetic data generation: $K_I = 30 \\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$, $K_{II} = -20 \\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$.\n  - Node polar coordinates:\n    - $r = [0.5\\times 10^{-3}, 1.0\\times 10^{-3}, 1.5\\times 10^{-3}, 2.5\\times 10^{-3}, 3.5\\times 10^{-3}, 4.5\\times 10^{-3}, 5.0\\times 10^{-3}, 2.2\\times 10^{-3}]$,\n    - $\\theta = [-1.9, -1.0, -0.2, 0.0, 0.4, 1.0, 1.5, 2.2]$.\n  - Noise amplitude: $\\eta = 5.0\\times 10^{-13} \\,\\mathrm{m}$.\n\nAngle unit: radians. All distances are in meters. The final output must be in $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$, rounded to three decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list of lists, where each inner list is $\\left[\\widehat{K}_I,\\widehat{K}_{II}\\right]$ in $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$, for Tests $1$, $2$, and $3$ in that order. For example: $[[a_1,b_1],[a_2,b_2],[a_3,b_3]]$, where $a_j$ and $b_j$ are decimal numbers with three digits after the decimal point.", "solution": "The problem requires the estimation of Mode I and Mode II stress intensity factors, denoted $K_I$ and $K_{II}$ respectively, from a given set of nodal displacements in the vicinity of a crack tip. This will be accomplished by fitting the displacements to the known asymptotic near-tip field derived from Linear Elastic Fracture Mechanics (LEFM). The problem is formulated under the assumption of a two-dimensional, homogeneous, isotropic, linear elastic material under plane strain conditions.\n\nThe fundamental principle is that the displacement field $(u_x, u_y)$ in a region close to a crack tip can be expressed as a series expansion in terms of the polar coordinates $(r, \\theta)$ centered at the tip. For LEFM, the dominant term is proportional to $\\sqrt{r}$. The Cartesian components of displacement are given by:\n$$ u_x(r, \\theta) = \\frac{K_I}{2\\mu} \\sqrt{\\frac{r}{2\\pi}} f_{I,x}(\\theta) + \\frac{K_{II}}{2\\mu} \\sqrt{\\frac{r}{2\\pi}} f_{II,x}(\\theta) $$\n$$ u_y(r, \\theta) = \\frac{K_I}{2\\mu} \\sqrt{\\frac{r}{2\\pi}} f_{I,y}(\\theta) + \\frac{K_{II}}{2\\mu} \\sqrt{\\frac{r}{2\\pi}} f_{II,y}(\\theta) $$\nHere, $\\mu$ is the shear modulus, defined as $\\mu = \\frac{E}{2(1+\\nu)}$, where $E$ is Young's modulus and $\\nu$ is Poisson's ratio. The angular functions $f(\\theta)$ for plane strain are:\n$$ f_{I,x}(\\theta) = \\cos\\frac{\\theta}{2} \\left(\\kappa - 1 + 2\\sin^2\\frac{\\theta}{2}\\right) $$\n$$ f_{II,x}(\\theta) = \\sin\\frac{\\theta}{2} \\left(\\kappa + 1 + 2\\cos^2\\frac{\\theta}{2}\\right) $$\n$$ f_{I,y}(\\theta) = \\sin\\frac{\\theta}{2} \\left(\\kappa + 1 - 2\\cos^2\\frac{\\theta}{2}\\right) $$\n$$ f_{II,y}(\\theta) = \\cos\\frac{\\theta}{2} \\left(-\\kappa + 1 + 2\\sin^2\\frac{\\theta}{2}\\right) $$\nThe Kolosov constant $\\kappa$ is given as $\\kappa = 3 - 4\\nu$ for plane strain.\nThese equations establish a linear relationship between the displacement vector $(u_x, u_y)$ and the unknown stress intensity factors $(K_I, K_{II})$.\n\nWe are given $N$ nodal locations $(r_i, \\theta_i)$ and their corresponding \"measured\" Cartesian displacements $(u_{x,i}^{meas}, u_{y,i}^{meas})$ for $i=1, \\dots, N$. The task is to find the values of $K_I$ and $K_{II}$ that best fit this data. This can be formulated as a linear least-squares problem. For each node $i$, we have a pair of equations:\n$$ u_{x,i}^{meas} \\approx K_I \\cdot F_{I,x}(r_i, \\theta_i) + K_{II} \\cdot F_{II,x}(r_i, \\theta_i) $$\n$$ u_{y,i}^{meas} \\approx K_I \\cdot F_{I,y}(r_i, \\theta_i) + K_{II} \\cdot F_{II,y}(r_i, \\theta_i) $$\nwhere the basis functions $F$ incorporate all known terms:\n$$ F_{J,k}(r, \\theta) = \\frac{1}{2\\mu} \\sqrt{\\frac{r}{2\\pi}} f_{J,k}(\\theta) \\quad \\text{for } J \\in \\{I, II\\}, k \\in \\{x, y\\} $$\nWe can assemble these $2N$ equations into a single matrix system $\\mathbf{A}\\mathbf{k} \\approx \\mathbf{u}$, where:\n- $\\mathbf{k} = \\begin{pmatrix} K_I \\\\ K_{II} \\end{pmatrix}$ is the $2 \\times 1$ vector of unknown SIFs.\n- $\\mathbf{u}$ is the $2N \\times 1$ vector of stacked measured displacements: $\\mathbf{u} = (u_{x,1}^{meas}, u_{y,1}^{meas}, u_{x,2}^{meas}, u_{y,2}^{meas}, \\dots, u_{x,N}^{meas}, u_{y,N}^{meas})^T$.\n- $\\mathbf{A}$ is the $2N \\times 2$ design matrix constructed from the basis functions:\n$$ \\mathbf{A} = \\begin{pmatrix}\nF_{I,x}(r_1, \\theta_1) & F_{II,x}(r_1, \\theta_1) \\\\\nF_{I,y}(r_1, \\theta_1) & F_{II,y}(r_1, \\theta_1) \\\\\n\\vdots & \\vdots \\\\\nF_{I,x}(r_N, \\theta_N) & F_{II,x}(r_N, \\theta_N) \\\\\nF_{I,y}(r_N, \\theta_N) & F_{II,y}(r_N, \\theta_N)\n\\end{pmatrix} $$\nThe least-squares solution $\\widehat{\\mathbf{k}}$ that minimizes the Euclidean norm of the residual $\\|\\mathbf{A}\\mathbf{k} - \\mathbf{u}\\|_2$ is found by solving the normal equations $(\\mathbf{A}^T\\mathbf{A})\\widehat{\\mathbf{k}} = \\mathbf{A}^T\\mathbf{u}$. Numerically, this is best solved using robust methods like QR decomposition or Singular Value Decomposition, as implemented in standard numerical libraries.\n\nThe implementation will proceed as follows for each test case:\n$1$. Convert all input quantities to a consistent set of base SI units (Pascals, meters). Specifically, $E$ is converted from GPa to Pa, and the true $K_I, K_{II}$ values are converted from $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$ to $\\mathrm{Pa}\\sqrt{\\mathrm{m}}$.\n$2$. Calculate the material constants $\\mu$ and $\\kappa$ from the given $E$ and $\\nu$.\n$3$. Generate the synthetic \"measured\" displacement data. For each node $i$ (with $1$-based index), the true displacements $(u_{x,i}^{true}, u_{y,i}^{true})$ are first calculated using the asymptotic field equations with the provided true $K_I$ and $K_{II}$. Then, a deterministic noise is added: $u_{x,i}^{meas} = u_{x,i}^{true} + \\eta \\sin(i)$ and $u_{y,i}^{meas} = u_{y,i}^{true} + \\eta \\cos(2i)$.\n$4$. Construct the design matrix $\\mathbf{A}$ and the measurement vector $\\mathbf{u}$ using the nodal coordinates and the generated measured displacements.\n$5$. Solve the overdetermined linear system $\\mathbf{A}\\mathbf{k} \\approx \\mathbf{u}$ for the unknown vector $\\mathbf{k}$ using a least-squares solver.\n$6$. Convert the estimated SIFs, $\\widehat{K}_I$ and $\\widehat{K}_{II}$, from $\\mathrm{Pa}\\sqrt{\\mathrm{m}}$ back to $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$ by dividing by $10^6$.\n$7$. The final results are rounded to three decimal places as required.\nThis procedure is applied to each of the three test cases provided.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for Stress Intensity Factors (SIFs) for three test cases\n    using a least-squares displacement correlation method.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"E_GPa\": 210.0, \"nu\": 0.3,\n            \"K_I_true_MPa\": 25.0, \"K_II_true_MPa\": 0.0,\n            \"r_m\": np.array([1.5e-3, 2.5e-3, 3.5e-3, 4.5e-3, 2.0e-3, 3.0e-3]),\n            \"theta_rad\": np.array([-np.pi/4, 0, np.pi/6, np.pi/3, -np.pi/6, np.pi/2]),\n            \"eta_m\": 1.0e-12\n        },\n        {\n            \"E_GPa\": 210.0, \"nu\": 0.3,\n            \"K_I_true_MPa\": 0.0, \"K_II_true_MPa\": 18.0,\n            \"r_m\": np.array([0.8e-3, 1.2e-3, 2.2e-3, 3.8e-3, 5.0e-3, 4.0e-3]),\n            \"theta_rad\": np.array([-np.pi/3, -np.pi/6, 0.2, 0.9, 1.3, -0.7]),\n            \"eta_m\": 2.0e-12\n        },\n        {\n            \"E_GPa\": 210.0, \"nu\": 0.3,\n            \"K_I_true_MPa\": 30.0, \"K_II_true_MPa\": -20.0,\n            \"r_m\": np.array([0.5e-3, 1.0e-3, 1.5e-3, 2.5e-3, 3.5e-3, 4.5e-3, 5.0e-3, 2.2e-3]),\n            \"theta_rad\": np.array([-1.9, -1.0, -0.2, 0.0, 0.4, 1.0, 1.5, 2.2]),\n            \"eta_m\": 5.0e-13\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        sifs = estimate_sifs(case)\n        results.append(sifs)\n\n    # Format the final output as a string representing a list of lists.\n    # e.g., [[25.000,0.000],[0.000,18.000],[30.000,-20.000]]\n    formatted_results = [f\"[{r[0]:.3f},{r[1]:.3f}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef estimate_sifs(case_data):\n    \"\"\"\n    Estimates K_I and K_II for a single test case.\n    \"\"\"\n    # Unpack data and convert to SI units\n    E_Pa = case_data[\"E_GPa\"] * 1e9\n    nu = case_data[\"nu\"]\n    K_I_true_Pa = case_data[\"K_I_true_MPa\"] * 1e6\n    K_II_true_Pa = case_data[\"K_II_true_MPa\"] * 1e6\n    r_coords = case_data[\"r_m\"]\n    theta_coords = case_data[\"theta_rad\"]\n    eta = case_data[\"eta_m\"]\n\n    # Calculate material constants\n    mu = E_Pa / (2 * (1 + nu))        # Shear modulus\n    kappa = 3 - 4 * nu                # Kolosov constant for plane strain\n\n    num_nodes = len(r_coords)\n    u_meas_vec = np.zeros(2 * num_nodes)\n    design_matrix = np.zeros((2 * num_nodes, 2))\n    \n    # Constant factor in displacement equations\n    const_factor = 1 / (2 * mu * np.sqrt(2 * np.pi))\n\n    for i in range(num_nodes):\n        r = r_coords[i]\n        theta = theta_coords[i]\n\n        # Calculate angular functions from simplified forms for efficiency\n        cos_th = np.cos(theta)\n        cos_th_half = np.cos(theta / 2)\n        sin_th_half = np.sin(theta / 2)\n\n        # Mode I and Mode II basis functions for u_x and u_y\n        f_Ix = const_factor * np.sqrt(r) * cos_th_half * (kappa - cos_th)\n        f_Iy = const_factor * np.sqrt(r) * sin_th_half * (kappa - cos_th)\n        f_IIx = const_factor * np.sqrt(r) * sin_th_half * (kappa + 2 + cos_th)\n        f_IIy = const_factor * np.sqrt(r) * cos_th_half * (-kappa + 2 - cos_th)\n\n        # 1. Generate synthetic data\n        # Calculate true displacements\n        u_x_true = K_I_true_Pa * f_Ix + K_II_true_Pa * f_IIx\n        u_y_true = K_I_true_Pa * f_Iy + K_II_true_Pa * f_IIy\n        \n        # Add deterministic noise (using 1-based index)\n        node_index = i + 1\n        u_x_meas = u_x_true + eta * np.sin(node_index)\n        u_y_meas = u_y_true + eta * np.cos(2 * node_index)\n\n        # Populate measurement vector\n        u_meas_vec[2*i] = u_x_meas\n        u_meas_vec[2*i + 1] = u_y_meas\n        \n        # 2. Assemble design matrix\n        design_matrix[2*i, 0] = f_Ix\n        design_matrix[2*i, 1] = f_IIx\n        design_matrix[2*i + 1, 0] = f_Iy\n        design_matrix[2*i + 1, 1] = f_IIy\n\n    # 3. Solve the least-squares problem\n    K_estimated_Pa, _, _, _ = np.linalg.lstsq(design_matrix, u_meas_vec, rcond=None)\n    \n    # 4. Convert results back to MPa*sqrt(m)\n    K_I_est_MPa = K_estimated_Pa[0] / 1e6\n    K_II_est_MPa = K_estimated_Pa[1] / 1e6\n    \n    return [K_I_est_MPa, K_II_est_MPa]\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2574883"}, {"introduction": "Building on our toolkit for SIF extraction, we now explore an elegant and powerful energy-based approach closely related to the Virtual Crack Closure Technique (VCCT). This exercise uses discrete nodal forces and displacements from a simulation to approximate the energy released during a small crack extension, $G_I$. This hands-on implementation demonstrates how a global energy balance concept can be applied locally at the crack tip to yield the stress intensity factor, providing a valuable alternative to field-fitting methods. [@problem_id:2574899]", "problem": "A two-dimensional finite element method (FEM) model in the framework of Linear Elastic Fracture Mechanics (LEFM) is used to evaluate Mode I crack driving force by a compliance-based energy balance. Consider a straight crack advancing by a small extension of length $\\Delta a$ in a body of uniform out-of-plane thickness $B$. Assume linear elasticity and small deformations. The fracture parameter of interest is the Mode I stress intensity factor $K_I$. The task is to compute $K_I$ by evaluating the change in total potential energy associated with a small crack advance and then relating the energy release rate to $K_I$.\n\nStart from the following fundamental bases:\n- The total strain energy in linear elasticity is $U = \\dfrac{1}{2}\\int_V \\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\\,dV$, and the total potential energy is $\\Pi = U - W_{\\text{ext}}$.\n- The energy release rate is $G = -\\dfrac{d\\Pi}{dA}$, where $A$ is the crack surface area (in two dimensions with thickness $B$, the increment is $dA = B\\,da$).\n- Under linear elasticity, the work associated with releasing a set of nodal forces through their corresponding relative crack face displacements is one-half the force–displacement product.\n- The Irwin relation connects the Mode I energy release rate and the Mode I stress intensity factor by $K_I^2 = E' G$, where for plane stress $E' = E$ and for plane strain $E' = \\dfrac{E}{1-\\nu^2}$.\n\nIn a virtual crack extension setting closely related to the Virtual Crack Closure Technique (VCCT), the local data available from the FEM solution consist of:\n- The set of nodal reaction forces in the local opening direction at the nodes just ahead of the crack tip for the extended-crack model, $\\{F_i\\}$.\n- The set of corresponding relative opening displacements between crack faces at nodes just behind the crack tip for the shorter-crack model, $\\{\\Delta v_i\\}$.\nAssume that the nodes $\\{i\\}$ on opposite crack faces are paired consistently so that $F_i$ and $\\Delta v_i$ correspond across the crack extension $\\Delta a$.\n\nYour program must, for each test case, do the following:\n1. From $\\{F_i\\}$, $\\{\\Delta v_i\\}$, $B$, and $\\Delta a$, approximate the Mode I energy release rate $G_I$ by the compliance-based energy change due to a small crack extension. Use the linear elastic work principle to combine the paired nodal data and normalize by the created crack surface area.\n2. From $G_I$ and the material elastic constants $(E,\\nu)$ under the specified kinematic condition (plane stress or plane strain), compute $K_I$ using the Irwin relation.\n3. Express $K_I$ in megapascals times square root meters (MPa$\\sqrt{\\text{m}}$), rounded to six decimal places.\n\nAll quantities are given in International System of Units (SI) unless noted otherwise:\n- Force in newtons (N),\n- Lengths in meters (m),\n- Young’s modulus in pascals (Pa),\n- Poisson’s ratio dimensionless,\n- Thickness in meters (m),\n- The final $K_I$ must be reported in MPa$\\sqrt{\\text{m}}$.\n\nTest suite (each case is independent and should be processed in the stated units):\n- Test Case $1$ (happy path, plane strain):\n  - $E = 210\\times 10^9$ Pa, $\\nu = 0.3$, plane strain.\n  - $B = 0.01$ m, $\\Delta a = 0.001$ m.\n  - Opening-direction nodal forces just ahead of the crack tip: $\\{F_i\\} = [1200.0,\\,800.0]$ N.\n  - Corresponding crack opening displacements just behind the tip: $\\{\\Delta v_i\\} = [3.0\\times 10^{-5},\\,2.0\\times 10^{-5}]$ m.\n- Test Case $2$ (boundary case with vanishing driving force, plane stress):\n  - $E = 70\\times 10^9$ Pa, $\\nu = 0.33$, plane stress.\n  - $B = 0.005$ m, $\\Delta a = 0.0015$ m.\n  - $\\{F_i\\} = [0.0,\\,0.0]$ N.\n  - $\\{\\Delta v_i\\} = [1.0\\times 10^{-5},\\,2.0\\times 10^{-5}]$ m.\n- Test Case $3$ (small crack increment sensitivity, plane stress):\n  - $E = 200\\times 10^9$ Pa, $\\nu = 0.25$, plane stress.\n  - $B = 0.008$ m, $\\Delta a = 0.0005$ m.\n  - $\\{F_i\\} = [500.0,\\,400.0,\\,300.0]$ N.\n  - $\\{\\Delta v_i\\} = [6.0\\times 10^{-6},\\,5.0\\times 10^{-6},\\,4.0\\times 10^{-6}]$ m.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results for the test cases in order as a comma-separated list enclosed in square brackets. Each entry must be a floating-point number giving $K_I$ in MPa$\\sqrt{\\text{m}}$ rounded to six decimal places (for example, $[1.234567,0.000000,3.210000]$).", "solution": "The energy release rate, $G$, is defined as the negative rate of change of the total potential energy, $\\Pi$, with respect to the crack area, $A$. For a finite crack growth, $\\Delta a$, this is approximated as:\n$$G \\approx -\\frac{\\Delta \\Pi}{\\Delta A}$$\nThe change in crack surface area, $\\Delta A$, for a through-crack in a body of thickness $B$ is given by $\\Delta A = B \\cdot \\Delta a$.\n\nThe quantity $-\\Delta \\Pi$ represents the energy that becomes available to drive the fracture process. In a discrete FEM context, this energy can be calculated as the work required to close the newly formed crack faces. Under the assumption of linear elasticity, the work done by a nodal force $F_i$ moving through a displacement $\\Delta v_i$ is $\\dfrac{1}{2} F_i \\Delta v_i$. The logic of the Virtual Crack Closure Technique (VCCT) posits that the work to close the crack over an extension $\\Delta a$ is approximately equal to the work done by the nodal forces at the original crack tip moving through the opening displacements of the extended crack.\n\nThe total energy released is the sum of the work done by all the paired nodal forces:\n$$-\\Delta \\Pi = \\frac{1}{2} \\sum_{i} F_i \\Delta v_i$$\nThis is the work released during the creation of the new crack surface.\n\nThe Mode I energy release rate, $G_I$, is then computed by normalizing this energy by the created crack area:\n$$G_I = \\frac{-\\Delta \\Pi}{\\Delta A} = \\frac{\\frac{1}{2} \\sum_{i} F_i \\Delta v_i}{B \\cdot \\Delta a}$$\n\nNext, we relate $G_I$ to the Mode I stress intensity factor, $K_I$, using the Irwin relation:\n$$K_I^2 = E' G_I$$\nwhere $E'$ is the effective Young's modulus, which depends on the kinematic constraint:\n- For plane stress: $E' = E$\n- For plane strain: $E' = \\frac{E}{1 - \\nu^2}$\n\nCombining these equations, we obtain the expression for $K_I$:\n$$K_I = \\sqrt{E' G_I} = \\sqrt{E' \\left( \\frac{\\sum_{i} F_i \\Delta v_i}{2 B \\Delta a} \\right)}$$\nThe units for all input quantities are SI base units (Pa, N, m). The calculation of $G_I$ results in units of Joules per square meter (J/m$^2$), which is equivalent to N/m. The computation of $K_I^2 = E' G_I$ has units of Pa $\\cdot$ (N/m) = Pa$^2\\cdot$m. Consequently, $K_I$ has units of Pa$\\cdot\\sqrt{\\text{m}}$. The final result must be converted to MPa$\\cdot\\sqrt{\\text{m}}$ by dividing by $10^6$.\n\nWe now apply this formulation to each test case.\n\n**Test Case 1: Plane Strain**\n- $E = 210 \\times 10^9$ Pa, $\\nu = 0.3$, $B = 0.01$ m, $\\Delta a = 0.001$ m.\n- $F = [1200.0, 800.0]$ N, $\\Delta v = [3.0 \\times 10^{-5}, 2.0 \\times 10^{-5}]$ m.\n- Work term:\n  $$\\sum_{i} F_i \\Delta v_i = (1200.0)(3.0 \\times 10^{-5}) + (800.0)(2.0 \\times 10^{-5}) = 0.036 + 0.016 = 0.052 \\text{ J}$$\n- $G_I$:\n  $$G_I = \\frac{\\frac{1}{2}(0.052)}{0.01 \\cdot 0.001} = \\frac{0.026}{10^{-5}} = 2.6 \\times 10^6 \\text{ J/m}^2$$\n- Effective modulus $E'$ (plane strain):\n  $$E' = \\frac{210 \\times 10^9}{1 - (0.3)^2} = \\frac{210 \\times 10^9}{0.91} \\approx 2.30769 \\times 10^{11} \\text{ Pa}$$\n- $K_I$:\n  $$K_I = \\sqrt{(2.30769... \\times 10^{11}) \\cdot (2.6 \\times 10^6)} \\approx 7.74596669 \\times 10^8 \\text{ Pa}\\cdot\\sqrt{\\text{m}}$$\n- Convert to MPa$\\cdot\\sqrt{\\text{m}}$:\n  $$K_I = 774.596669 \\text{ MPa}\\cdot\\sqrt{\\text{m}}$$\n\n**Test Case 2: Plane Stress**\n- $E = 70 \\times 10^9$ Pa, $\\nu = 0.33$, $B = 0.005$ m, $\\Delta a = 0.0015$ m.\n- $F = [0.0, 0.0]$ N, $\\Delta v = [1.0 \\times 10^{-5}, 2.0 \\times 10^{-5}]$ m.\n- The work term is zero, so $G_I = 0$ and $K_I = 0$.\n- In the required format: $K_I = 0.000000 \\text{ MPa}\\cdot\\sqrt{\\text{m}}$.\n\n**Test Case 3: Plane Stress**\n- $E = 200 \\times 10^9$ Pa, $\\nu = 0.25$, $B = 0.008$ m, $\\Delta a = 0.0005$ m.\n- $F = [500.0, 400.0, 300.0]$ N, $\\Delta v = [6.0 \\times 10^{-6}, 5.0 \\times 10^{-6}, 4.0 \\times 10^{-6}]$ m.\n- Work term:\n  $$\\sum_{i} F_i \\Delta v_i = (500.0)(6.0 \\times 10^{-6}) + (400.0)(5.0 \\times 10^{-6}) + (300.0)(4.0 \\times 10^{-6}) = 0.0062 \\text{ J}$$\n- $G_I$:\n  $$G_I = \\frac{\\frac{1}{2}(0.0062)}{0.008 \\cdot 0.0005} = \\frac{0.0031}{4 \\times 10^{-6}} = 7.75 \\times 10^5 \\text{ J/m}^2$$\n- Effective modulus $E'$ (plane stress): $E' = E = 200 \\times 10^9$ Pa.\n- $K_I$:\n  $$K_I = \\sqrt{(200 \\times 10^9) \\cdot (7.75 \\times 10^5)} = \\sqrt{1.55 \\times 10^{14}} \\approx 1.24498996 \\times 10^7 \\text{ Pa}\\cdot\\sqrt{\\text{m}}$$\n- Convert to MPa$\\cdot\\sqrt{\\text{m}}$:\n  $$K_I \\approx 12.449900 \\text{ MPa}\\cdot\\sqrt{\\text{m}}$$", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Mode I stress intensity factor (K_I) for multiple test cases\n    based on a compliance-based energy balance method from FEM results.\n    \"\"\"\n    \n    # Test cases defined as a list of dictionaries.\n    # All values are in SI units (Pa, m, N).\n    test_cases = [\n        {\n            \"E\": 210e9, \"nu\": 0.3, \"condition\": \"plane strain\",\n            \"B\": 0.01, \"delta_a\": 0.001,\n            \"F_i\": np.array([1200.0, 800.0]),\n            \"delta_v_i\": np.array([3.0e-5, 2.0e-5])\n        },\n        {\n            \"E\": 70e9, \"nu\": 0.33, \"condition\": \"plane stress\",\n            \"B\": 0.005, \"delta_a\": 0.0015,\n            \"F_i\": np.array([0.0, 0.0]),\n            \"delta_v_i\": np.array([1.0e-5, 2.0e-5])\n        },\n        {\n            \"E\": 200e9, \"nu\": 0.25, \"condition\": \"plane stress\",\n            \"B\": 0.008, \"delta_a\": 0.0005,\n            \"F_i\": np.array([500.0, 400.0, 300.0]),\n            \"delta_v_i\": np.array([6.0e-6, 5.0e-6, 4.0e-6])\n        }\n    ]\n\n    formatted_results = []\n\n    for case in test_cases:\n        E = case[\"E\"]\n        nu = case[\"nu\"]\n        B = case[\"B\"]\n        delta_a = case[\"delta_a\"]\n        F_i = case[\"F_i\"]\n        delta_v_i = case[\"delta_v_i\"]\n        condition = case[\"condition\"]\n\n        # Step 1: Approximate the Mode I energy release rate G_I.\n        # The energy released is 1/2 * sum(F_i * delta_v_i).\n        work_released = 0.5 * np.sum(F_i * delta_v_i)\n        \n        # The new crack surface area is B * delta_a.\n        delta_A = B * delta_a\n\n        if delta_A == 0:\n            # Avoid division by zero, although not expected in these test cases.\n            G_I = 0.0\n        else:\n            G_I = work_released / delta_A\n\n        # Step 2: Compute K_I from G_I using the Irwin relation.\n        # First, determine the effective Young's modulus E'.\n        if condition == \"plane stress\":\n            E_prime = E\n        elif condition == \"plane strain\":\n            E_prime = E / (1 - nu**2)\n        else:\n            # Invalid condition, though not present in tests.\n            E_prime = 0.0\n\n        if E_prime = 0 or G_I  0:\n            # Handle non-physical cases.\n            K_I_pa_sqrt_m = 0.0\n        else:\n            K_I_pa_sqrt_m = np.sqrt(E_prime * G_I)\n\n        # Step 3: Express K_I in MPa*sqrt(m) and round.\n        # 1 Pa = 1e-6 MPa\n        K_I_mpa_sqrt_m = K_I_pa_sqrt_m * 1e-6\n\n        # Format the result to six decimal places for the final output string.\n        formatted_results.append(f\"{K_I_mpa_sqrt_m:.6f}\")\n\n    # Print the final results in the required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2574899"}]}