{"hands_on_practices": [{"introduction": "Understanding the Streamline Upwind/Petrov-Galerkin (SUPG) method begins with its name. This first practice [@problem_id:2602075] focuses on the 'streamline' aspect by connecting the strong residual of the advection-diffusion equation directly to the streamline derivative. By performing this foundational calculation, you will clarify how the advection term $\\boldsymbol{\\beta}\\cdot\\nabla u$ can be viewed as a derivative along the direction of flow, a key concept upon which SUPG stabilization is built.", "problem": "Consider the steady, non-dimensional linear advection–diffusion–reaction model problem posed on a smooth, simply connected domain $\\Omega \\subset \\mathbb{R}^{2}$ with homogeneous Dirichlet boundary conditions. The strong form is\n$$\n-\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u = f \\quad \\text{in } \\Omega,\n$$\nwhere $\\epsilon>0$ is the (constant) diffusivity, $\\boldsymbol{\\beta}\\in\\mathbb{R}^{2}$ is a constant advection field, $\\sigma\\ge 0$ is a (constant) reaction coefficient, and $f$ is a given source. The strong residual associated with a sufficiently smooth function $u$ is defined by\n$$\nr(u) \\coloneqq -\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u - f.\n$$\nIn the Streamline Upwind/Petrov–Galerkin (SUPG) stabilization, the streamline direction is taken along the flow $\\boldsymbol{\\beta}$, and the streamline derivative is defined by\n$$\n\\partial_{\\boldsymbol{t}} u \\coloneqq \\boldsymbol{t}\\cdot\\nabla u, \\quad \\boldsymbol{t} \\coloneqq \\frac{\\boldsymbol{\\beta}}{\\lVert\\boldsymbol{\\beta}\\rVert}.\n$$\nLet the advection field be constant, $\\boldsymbol{\\beta}=(2,1)$, and let the candidate solution be $u(x,y)=\\exp(x+2y)$. Assume $f(x,y)=0$.\n\nStarting from the definitions above and only basic vector calculus identities, derive $\\partial_{\\boldsymbol{t}} u$ and use it to rewrite the residual in the form\n$$\nr(u)= -\\epsilon\\,\\Delta u + \\lVert\\boldsymbol{\\beta}\\rVert\\,\\partial_{\\boldsymbol{t}} u + \\sigma\\,u - f,\n$$\nthen evaluate $r(u)(x,y)$ for the given $u$, $\\boldsymbol{\\beta}$, and $f$. Provide your final answer as a single closed-form analytic expression in terms of $x$, $y$, $\\epsilon$, and $\\sigma$. Do not include units. No numerical rounding is required.", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens.\n- The strong form of the steady, non-dimensional linear advection–diffusion–reaction equation: $-\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u = f$ in $\\Omega \\subset \\mathbb{R}^{2}$.\n- Diffusivity: $\\epsilon > 0$, constant.\n- Advection field: $\\boldsymbol{\\beta} \\in \\mathbb{R}^{2}$, constant.\n- Reaction coefficient: $\\sigma \\ge 0$, constant.\n- Source term: $f$.\n- Definition of the strong residual: $r(u) \\coloneqq -\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u - f$.\n- Definition of the streamline direction: $\\boldsymbol{t} \\coloneqq \\frac{\\boldsymbol{\\beta}}{\\lVert\\boldsymbol{\\beta}\\rVert}$.\n- Definition of the streamline derivative: $\\partial_{\\boldsymbol{t}} u \\coloneqq \\boldsymbol{t}\\cdot\\nabla u$.\n- Specific advection field: $\\boldsymbol{\\beta}=(2,1)$.\n- Specific candidate solution: $u(x,y)=\\exp(x+2y)$.\n- Specific source term: $f(x,y)=0$.\n\nStep 2: Validate Using Extracted Givens.\n- **Scientifically Grounded:** The problem is based on the advection-diffusion-reaction partial differential equation, a fundamental model in transport phenomena. The Streamline Upwind/Petrov-Galerkin (SUPG) method is a standard and well-established stabilization technique in computational fluid dynamics and the finite element method. All definitions are standard and mathematically correct.\n- **Well-Posed:** The problem requires the derivation of an identity and the evaluation of a resulting expression. This is a direct calculation with a unique, well-defined result.\n- **Objective:** The problem is stated in precise, mathematical language, free from subjectivity.\n- **Completeness and Consistency:** All necessary functions ($u$, $\\boldsymbol{\\beta}$, $f$) and definitions ($r(u)$, $\\partial_{\\boldsymbol{t}} u$) are provided to perform the required calculations. There are no contradictions.\n\nStep 3: Verdict and Action.\nThe problem is valid. It is a standard exercise in vector calculus and the analysis of partial differential equations. The solution process may proceed.\n\nThe task is twofold: first, to rewrite the residual $r(u)$ in terms of the streamline derivative $\\partial_{\\boldsymbol{t}} u$, and second, to evaluate this residual for the given functions.\n\nPart 1: Derivation of the residual in terms of the streamline derivative.\n\nThe strong residual is defined as:\n$$\nr(u) = -\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u - f\n$$\nThe streamline direction $\\boldsymbol{t}$ is defined as the unit vector in the direction of the advection field $\\boldsymbol{\\beta}$:\n$$\n\\boldsymbol{t} = \\frac{\\boldsymbol{\\beta}}{\\lVert\\boldsymbol{\\beta}\\rVert}\n$$\nFrom this definition, it follows directly that the advection field can be expressed as:\n$$\n\\boldsymbol{\\beta} = \\lVert\\boldsymbol{\\beta}\\rVert\\,\\boldsymbol{t}\n$$\nThe streamline derivative $\\partial_{\\boldsymbol{t}} u$ is defined as the directional derivative of $u$ in the direction of $\\boldsymbol{t}$:\n$$\n\\partial_{\\boldsymbol{t}} u = \\boldsymbol{t}\\cdot\\nabla u\n$$\nNow, consider the advection term $\\boldsymbol{\\beta}\\cdot\\nabla u$ in the residual. Substitute the expression for $\\boldsymbol{\\beta}$ in terms of $\\boldsymbol{t}$:\n$$\n\\boldsymbol{\\beta}\\cdot\\nabla u = (\\lVert\\boldsymbol{\\beta}\\rVert\\,\\boldsymbol{t})\\cdot\\nabla u\n$$\nUsing the scalar-vector product property, we can write:\n$$\n\\boldsymbol{\\beta}\\cdot\\nabla u = \\lVert\\boldsymbol{\\beta}\\rVert\\,(\\boldsymbol{t}\\cdot\\nabla u)\n$$\nSubstituting the definition of the streamline derivative $\\partial_{\\boldsymbol{t}} u$ into this expression gives:\n$$\n\\boldsymbol{\\beta}\\cdot\\nabla u = \\lVert\\boldsymbol{\\beta}\\rVert\\,\\partial_{\\boldsymbol{t}} u\n$$\nFinally, we substitute this result back into the original definition of the residual $r(u)$:\n$$\nr(u) = -\\epsilon\\,\\Delta u + \\lVert\\boldsymbol{\\beta}\\rVert\\,\\partial_{\\boldsymbol{t}} u + \\sigma\\,u - f\n$$\nThis completes the first part of the task, demonstrating the required relationship.\n\nPart 2: Evaluation of the residual $r(u)(x,y)$.\n\nWe are given the candidate solution $u(x,y) = \\exp(x+2y)$, the advection field $\\boldsymbol{\\beta} = (2,1)$, and the source term $f(x,y)=0$. To evaluate $r(u)$, we must compute the necessary derivatives of $u$.\n\nFirst, we compute the gradient of $u$, $\\nabla u$:\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\exp(x+2y) = \\exp(x+2y)\n$$\n$$\n\\frac{\\partial u}{\\partial y} = \\frac{\\partial}{\\partial y} \\exp(x+2y) = 2\\exp(x+2y)\n$$\nSo, the gradient is:\n$$\n\\nabla u = \\begin{pmatrix} \\exp(x+2y) \\\\ 2\\exp(x+2y) \\end{pmatrix}\n$$\nNext, we compute the Laplacian of $u$, $\\Delta u = \\nabla \\cdot \\nabla u$. We need the second-order partial derivatives:\n$$\n\\frac{\\partial^2 u}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left(\\exp(x+2y)\\right) = \\exp(x+2y)\n$$\n$$\n\\frac{\\partial^2 u}{\\partial y^2} = \\frac{\\partial}{\\partial y} \\left(2\\exp(x+2y)\\right) = 4\\exp(x+2y)\n$$\nThe Laplacian is the sum of these pure second derivatives:\n$$\n\\Delta u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = \\exp(x+2y) + 4\\exp(x+2y) = 5\\exp(x+2y)\n$$\nNow, we can evaluate each term in the original residual expression $r(u) = -\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u - f$.\nThe diffusion term is:\n$$\n-\\epsilon\\,\\Delta u = -\\epsilon(5\\exp(x+2y)) = -5\\epsilon\\exp(x+2y)\n$$\nThe advection term is:\n$$\n\\boldsymbol{\\beta}\\cdot\\nabla u = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} \\cdot \\begin{pmatrix} \\exp(x+2y) \\\\ 2\\exp(x+2y) \\end{pmatrix} = 2\\exp(x+2y) + 1 \\cdot 2\\exp(x+2y) = 4\\exp(x+2y)\n$$\nThe reaction term is:\n$$\n\\sigma\\,u = \\sigma\\exp(x+2y)\n$$\nThe source term is given as $f=0$.\n\nWe assemble the residual by summing these terms:\n$$\nr(u)(x,y) = -5\\epsilon\\exp(x+2y) + 4\\exp(x+2y) + \\sigma\\exp(x+2y) - 0\n$$\nFactoring out the common term $\\exp(x+2y)$ gives the final expression for the residual:\n$$\nr(u)(x,y) = (4 + \\sigma - 5\\epsilon)\\exp(x+2y)\n$$\nThis is the required closed-form analytic expression for the residual.", "answer": "$$\n\\boxed{(4 + \\sigma - 5\\epsilon)\\exp(x+2y)}\n$$", "id": "2602075"}, {"introduction": "With the fundamental concepts in place, we can now explore the behavior of SUPG in a simplified one-dimensional setting to gain deeper insight. This exercise [@problem_id:2602080] is designed to reveal a remarkable connection: for a specific choice of the stabilization parameter $\\tau$, the SUPG finite element method precisely recovers the classic first-order upwind finite difference scheme. Completing this derivation provides an 'aha' moment that demystifies SUPG by linking it to a more intuitive, historically significant method for handling advection.", "problem": "Consider the steady linear advection equation in one spatial dimension,\n$$\na\\,\\frac{d u}{d x} = f(x) \\quad \\text{on } [0,L],\n$$\nwith constant advection speed $a>0$. Let $u(x)$ be approximated by a continuous, piecewise linear finite element function on a uniform mesh with nodes $x_i=i\\,h$, where $h=L/N$ and $i=0,1,\\dots,N$. Use the standard continuous basis functions $\\{\\varphi_i\\}$ associated with the nodes. Adopt the Streamline Upwind/Petrov-Galerkin (SUPG) method, in which the test function associated with node $i$ is modified to\n$$\n\\widetilde{w}_i \\equiv \\varphi_i + \\tau\\,a\\,\\frac{d \\varphi_i}{d x},\n$$\nwith stabilization parameter\n$$\n\\tau = \\frac{h}{2a}.\n$$\nStart from the standard Galerkin weak form for advection (without integrating the advection term by parts), add the SUPG perturbation consistently, and derive the element-level contributions to the stiffness matrix. Assemble these to obtain, for an interior node $i$ (away from boundaries), the three-point stencil coefficients multiplying the nodal unknowns $\\{u_{i-1},u_i,u_{i+1}\\}$ in the discrete residual equation. Ignore the load vector contributions from $f(x)$; compute only the stiffness (left-hand side) contributions.\n\nThen compare the resulting SUPG stencil with the classical first-order upwind finite difference stencil for $a>0$ on the same uniform grid. \n\nProvide your final answer as the ordered triple of coefficients multiplying $\\{u_{i-1},u_i,u_{i+1}\\}$, written as a single row matrix. No rounding is required and no units are needed.", "solution": "The problem statement must first be validated for scientific soundness, well-posedness, and objectivity.\n\n**Step 1: Extract Givens**\n-   Governing Equation: $a\\,\\frac{d u}{d x} = f(x)$ on the domain $[0,L]$.\n-   Advection Speed: $a$ is a positive constant, $a>0$.\n-   Approximation Method: Continuous, piecewise linear finite element method on a uniform mesh.\n-   Mesh Nodes: $x_i=i\\,h$, where $h=L/N$ for $i=0,1,\\dots,N$.\n-   Basis Functions: Standard linear hat functions, $\\{\\varphi_i\\}$.\n-   Numerical Scheme: Streamline Upwind/Petrov-Galerkin (SUPG).\n-   Test Functions: $\\widetilde{w}_i = \\varphi_i + \\tau\\,a\\,\\frac{d \\varphi_i}{d x}$.\n-   Stabilization Parameter: $\\tau = \\frac{h}{2a}$.\n-   Task: Derive the three-point stencil coefficients for an interior node $i$ by assembling element-level stiffness contributions, ignoring the load vector $f(x)$. The coefficients are to be found for the nodal unknowns $\\{u_{i-1}, u_i, u_{i+1}\\}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is subjected to rigorous validation.\n-   **Scientifically Grounded**: The problem is a standard, canonical exercise in the numerical analysis of partial differential equations, specifically concerning the finite element method for advection-dominated problems. The SUPG method is a well-established and fundamental technique.\n-   **Well-Posed**: The problem is precisely specified. All necessary components—the equation, the discretization, the basis and test functions, and the specific form of the stabilization parameter—are provided. The objective is clear and achievable.\n-   **Objective**: The language is formal, technical, and free of any subjective or ambiguous terminology.\n\nThe problem exhibits none of the invalidity flaws. It is self-contained, scientifically correct, and unambiguously formulated.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be derived.\n\n**Derivation of the SUPG Stencil**\n\nThe weak form of the advection equation using the Petrov-Galerkin test function $\\widetilde{w}_i$ is:\nFind $u_h \\in V_h$ such that for each basis function index $i$,\n$$\n\\int_0^L \\widetilde{w}_i \\left( a\\,\\frac{d u_h}{d x} - f(x) \\right) dx = 0\n$$\nwhere $u_h(x) = \\sum_{j=0}^{N} u_j \\varphi_j(x)$ is the finite element approximation. Substituting the expression for $\\widetilde{w}_i$, we have:\n$$\n\\int_0^L \\left( \\varphi_i + \\tau\\,a\\,\\frac{d \\varphi_i}{d x} \\right) \\left( a\\,\\frac{d u_h}{d x} - f(x) \\right) dx = 0\n$$\nThe problem specifies to ignore the load vector contribution from $f(x)$. The left-hand side (stiffness) contribution for the $i$-th equation is:\n$$\n\\sum_{j=0}^{N} u_j \\left[ \\int_0^L a\\,\\varphi_i \\frac{d \\varphi_j}{d x} dx + \\int_0^L \\tau\\,a^2\\,\\frac{d \\varphi_i}{d x} \\frac{d \\varphi_j}{d x} dx \\right] = 0\n$$\nThe term in the square brackets represents the entry $K_{ij}$ of the global stiffness matrix.\n$$\nK_{ij} = \\underbrace{\\int_0^L a\\,\\varphi_i \\frac{d \\varphi_j}{d x} dx}_{K_G} + \\underbrace{\\int_0^L \\tau\\,a^2\\,\\frac{d \\varphi_i}{d x} \\frac{d \\varphi_j}{d x} dx}_{K_S}\n$$\nThese integrals are computed on an element-by-element basis. Consider a generic element $[x_k, x_{k+1}]$ of length $h$. We use a local coordinate $\\xi = (x-x_k)/h$, where $\\xi \\in [0,1]$. The linear basis functions on this element are:\n$$\nN_1(\\xi) = 1-\\xi \\quad \\text{(associated with node } k)\n$$\n$$\nN_2(\\xi) = \\xi \\quad \\text{(associated with node } k+1)\n$$\nTheir derivatives with respect to $x$ are:\n$$\n\\frac{d N_1}{d x} = \\frac{d N_1}{d \\xi} \\frac{d \\xi}{d x} = -1 \\cdot \\frac{1}{h} = -\\frac{1}{h}\n$$\n$$\n\\frac{d N_2}{d x} = \\frac{d N_2}{d \\xi} \\frac{d \\xi}{d x} = 1 \\cdot \\frac{1}{h} = \\frac{1}{h}\n$$\nThe $2 \\times 2$ element stiffness matrix $K^e$ has entries $K^e_{mn}$ where $m,n \\in \\{1,2\\}$.\n\nFirst, we compute the standard Galerkin contribution, $K_G^e$:\n$$\nK_{G,mn}^e = \\int_{x_k}^{x_{k+1}} a\\,N_m \\frac{d N_n}{d x} dx = \\int_0^1 a\\,N_m(\\xi) \\frac{d N_n}{d x} h\\,d\\xi\n$$\n$$\nK_{G,11}^e = a \\int_0^1 (1-\\xi) \\left(-\\frac{1}{h}\\right) h\\,d\\xi = -a \\left[\\xi - \\frac{\\xi^2}{2}\\right]_0^1 = -\\frac{a}{2}\n$$\n$$\nK_{G,12}^e = a \\int_0^1 (1-\\xi) \\left(\\frac{1}{h}\\right) h\\,d\\xi = a \\left[\\xi - \\frac{\\xi^2}{2}\\right]_0^1 = \\frac{a}{2}\n$$\n$$\nK_{G,21}^e = a \\int_0^1 \\xi \\left(-\\frac{1}{h}\\right) h\\,d\\xi = -a \\left[\\frac{\\xi^2}{2}\\right]_0^1 = -\\frac{a}{2}\n$$\n$$\nK_{G,22}^e = a \\int_0^1 \\xi \\left(\\frac{1}{h}\\right) h\\,d\\xi = a \\left[\\frac{\\xi^2}{2}\\right]_0^1 = \\frac{a}{2}\n$$\nThus, the Galerkin element matrix is:\n$$\nK_G^e = \\frac{a}{2} \\begin{pmatrix} -1 & 1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nNext, we compute the SUPG stabilization contribution, $K_S^e$:\n$$\nK_{S,mn}^e = \\int_{x_k}^{x_{k+1}} \\tau\\,a^2\\,\\frac{d N_m}{d x} \\frac{d N_n}{d x} dx = \\int_0^1 \\tau\\,a^2\\,\\frac{d N_m}{d x} \\frac{d N_n}{d x} h\\,d\\xi\n$$\nSince the derivatives are constant over the element, the matrix of derivative products is $\\frac{1}{h^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\n$$\nK_S^e = \\tau a^2 h \\frac{1}{h^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\frac{\\tau a^2}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nNow, substitute the given stabilization parameter $\\tau = \\frac{h}{2a}$:\n$$\nK_S^e = \\frac{(h/2a) a^2}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\frac{a}{2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nThe total element stiffness matrix $K^e$ is the sum $K_G^e + K_S^e$:\n$$\nK^e = \\frac{a}{2} \\begin{pmatrix} -1 & 1 \\\\ -1 & 1 \\end{pmatrix} + \\frac{a}{2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\frac{a}{2} \\begin{pmatrix} 0 & 0 \\\\ -2 & 2 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ -a & a \\end{pmatrix}\n$$\nTo find the stencil for an interior node $i$, we assemble the contributions from the two adjacent elements: element $e_{i-1} = [x_{i-1}, x_i]$ and element $e_i = [x_i, x_{i+1}]$. The discrete equation for node $i$ is $\\sum_j K_{ij} u_j = F_i$. We seek the coefficients $K_{i,i-1}$, $K_{i,i}$, and $K_{i,i+1}$.\n\n-   **Contribution from element $e_{i-1} = [x_{i-1}, x_i]$**:\n    The local nodes $1,2$ correspond to global nodes $i-1, i$. We are interested in row $i$ of the global matrix, which corresponds to the second row ($m=2$) of $K^e$.\n    -   The coefficient for $u_{i-1}$ (global column $i-1$, local column $n=1$) is $K_{21}^e = -a$.\n    -   The coefficient for $u_i$ (global column $i$, local column $n=2$) is $K_{22}^e = a$.\n\n-   **Contribution from element $e_i = [x_i, x_{i+1}]$**:\n    The local nodes $1,2$ correspond to global nodes $i, i+1$. We are interested in row $i$ of the global matrix, which corresponds to the first row ($m=1$) of $K^e$.\n    -   The coefficient for $u_i$ (global column $i$, local column $n=1$) is $K_{11}^e = 0$.\n    -   The coefficient for $u_{i+1}$ (global column $i+1$, local column $n=2$) is $K_{12}^e = 0$.\n\nSumming the contributions for row $i$:\n-   Coefficient of $u_{i-1}$: $K_{i,i-1} = -a$.\n-   Coefficient of $u_i$: $K_{i,i} = a + 0 = a$.\n-   Coefficient of $u_{i+1}$: $K_{i,i+1} = 0$.\n\nThe resulting stencil of coefficients for $\\{u_{i-1}, u_i, u_{i+1}\\}$ is $(-a, a, 0)$. The discrete equation at node $i$ is $-a u_{i-1} + a u_i = (\\text{RHS})_i$.\n\nA comparison to the first-order upwind finite difference method is instructive. For $a>0$, the upwind scheme for $a \\frac{du}{dx} = f$ is $a\\frac{u_i - u_{i-1}}{h} = f_i$. The operator $a(u_i - u_{i-1})/h$ is produced by coefficients $(-a/h, a/h, 0)$. Our derived SUPG coefficients $(-a, a, 0)$ result in an operator that is proportional. The methods become identical for constant source term $f$, as the lumped FEM right-hand side vector yields $F_i = f \\cdot h$, giving $a(u_i - u_{i-1}) = f \\cdot h$, which is equivalent to the finite difference scheme. The problem asks for the coefficients of the stiffness matrix, which have been derived as requested.\n\nThe ordered triple of coefficients multiplying $\\{u_{i-1},u_i,u_{i+1}\\}$ is therefore $(-a, a, 0)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-a & a & 0\n\\end{pmatrix}\n}\n$$", "id": "2602080"}, {"introduction": "Moving from a simplified 1D case to a more realistic two-dimensional problem requires a method for computing the stabilization parameters on a general mesh. This final practice [@problem_id:2602150] addresses this practical necessity by guiding you through the calculation of the directional element length $h_{\\boldsymbol{t}}$ and the stabilization parameter $\\tau$ on a standard triangular finite element. Mastering this procedure is a critical step in translating the theory of SUPG into a working implementation for solving real-world transport problems.", "problem": "Consider the steady, dimensionless advection–diffusion–reaction boundary value problem in two spatial dimensions,\n$$-\\,\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u = f \\quad \\text{in a polygonal domain},$$\nwith constant coefficients. Focus on a single affine, linear triangular finite element with vertices at\n$$\\boldsymbol{x}_1=(0,0),\\quad \\boldsymbol{x}_2=(0.04,0),\\quad \\boldsymbol{x}_3=(0,0.03),$$\nand associated linear Lagrange nodal shape functions $N_i$ that satisfy the partition of unity and linear completeness. Let the advection velocity be $\\boldsymbol{\\beta}=(10,0.5)$, the diffusivity be $\\epsilon=10^{-4}$, and the reaction coefficient be $\\sigma=0$.\n\n(a) Starting only from (i) the one-dimensional identity for a linear two-node element that the sum of the absolute values of the shape function derivatives equals $2/h$ (where $h$ is the element length), and (ii) the affine mapping and directional derivative concept for a triangle, derive a formula for the directional element length $h_{\\boldsymbol{t}}$ in the streamline direction $\\boldsymbol{t}=\\boldsymbol{\\beta}/\\|\\boldsymbol{\\beta}\\|$ expressed in terms of the constant gradients $\\nabla N_i$ and $\\boldsymbol{t}$. Then evaluate $h_{\\boldsymbol{t}}$ for the given triangle and $\\boldsymbol{\\beta}$.\n\n(b) Using the one-dimensional constant-coefficient analysis that yields the optimal Streamline Upwind/Petrov–Galerkin (SUPG) stabilization parameter along the streamline direction, derive the expression of the stabilization parameter $\\tau$ in terms of $h_{\\boldsymbol{t}}$, $\\|\\boldsymbol{\\beta}\\|$, $\\epsilon$, and the element Péclet number. Then evaluate $\\tau$ for the given data.\n\nProvide your final numerical values for $h_{\\boldsymbol{t}}$ and $\\tau$. Round both to six significant figures. Express your final answer as the ordered pair $(h_{\\boldsymbol{t}},\\ \\tau)$ with no units.", "solution": "The problem statement is validated and found to be well-posed, scientifically grounded, and self-contained. It presents a standard, albeit non-trivial, exercise in the finite element analysis of advection-dominated problems. We proceed with the solution.\n\nThe problem is partitioned into two parts. We address each in sequence.\n\n(a) Derivation and evaluation of the directional element length $h_{\\boldsymbol{t}}$.\n\nFor a linear triangular element, the Lagrange nodal shape functions $N_i(\\boldsymbol{x})$ are linear functions of the spatial coordinates $\\boldsymbol{x}=(x,y)$. Consequently, their gradients, $\\nabla N_i$, are constant vectors over the element. These gradients are determined by the element geometry. Given the vertices $\\boldsymbol{x}_1=(0,0)$, $\\boldsymbol{x}_2=(0.04,0)$, and $\\boldsymbol{x}_3=(0,0.03)$, the area of the triangle is $A = \\frac{1}{2}(0.04)(0.03) = 0.0006$. The gradients are computed as:\n$$\n\\nabla N_i = \\frac{1}{2A} \\begin{pmatrix} y_j - y_k \\\\ x_k - x_j \\end{pmatrix}\n$$\nwhere $(i,j,k)$ is a cyclic permutation of $(1,2,3)$. For the given vertices:\n$$\n\\nabla N_1 = \\frac{1}{0.0012} \\begin{pmatrix} 0 - 0.03 \\\\ 0 - 0.04 \\end{pmatrix} = \\begin{pmatrix} -25 \\\\ -100/3 \\end{pmatrix}\n$$\n$$\n\\nabla N_2 = \\frac{1}{0.0012} \\begin{pmatrix} 0.03 - 0 \\\\ 0 - 0 \\end{pmatrix} = \\begin{pmatrix} 25 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\nabla N_3 = \\frac{1}{0.0012} \\begin{pmatrix} 0 - 0 \\\\ 0.04 - 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 100/3 \\end{pmatrix}\n$$\nThe condition of linear completeness, $\\sum_{i=1}^3 \\nabla N_i = \\boldsymbol{0}$, is satisfied.\n\nThe problem instructs to start from the one-dimensional identity for a linear two-node element of length $h$, which is $\\sum_{i=1}^2 |N_i'| = \\frac{2}{h}$. This identity can be rearranged to define the element length as $h = 2 / (\\sum_{i=1}^2 |N_i'|)$.\n\nWe generalize this concept to multiple dimensions. The role of the derivative $N_i'$ along the single spatial coordinate is replaced by the directional derivative of $N_i$ along a specified streamline direction, given by the unit vector $\\boldsymbol{t}$. The directional derivative is $\\nabla N_i \\cdot \\boldsymbol{t}$. The sum is taken over all nodes of the element, in this case $i=1, 2, 3$. This yields the definition for the directional element length $h_{\\boldsymbol{t}}$:\n$$\nh_{\\boldsymbol{t}} = \\frac{2}{\\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{t}|}\n$$\nThe streamline direction is aligned with the advection velocity $\\boldsymbol{\\beta}=(10, 0.5)$. The unit vector is $\\boldsymbol{t} = \\boldsymbol{\\beta} / \\|\\boldsymbol{\\beta}\\|$.\nFirst, we compute the dot products $\\nabla N_i \\cdot \\boldsymbol{\\beta}$:\n$$\n\\nabla N_1 \\cdot \\boldsymbol{\\beta} = (-25)(10) + (-\\frac{100}{3})(0.5) = -250 - \\frac{50}{3} = -\\frac{800}{3}\n$$\n$$\n\\nabla N_2 \\cdot \\boldsymbol{\\beta} = (25)(10) + (0)(0.5) = 250\n$$\n$$\n\\nabla N_3 \\cdot \\boldsymbol{\\beta} = (0)(10) + (\\frac{100}{3})(0.5) = \\frac{50}{3}\n$$\nThe sum of their absolute values is:\n$$\n\\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{\\beta}| = |-\\frac{800}{3}| + |250| + |\\frac{50}{3}| = \\frac{800}{3} + \\frac{750}{3} + \\frac{50}{3} = \\frac{1600}{3}\n$$\nThe magnitude of the advection velocity is $\\|\\boldsymbol{\\beta}\\| = \\sqrt{10^2 + 0.5^2} = \\sqrt{100.25}$.\nWe can now write the sum of the absolute values of the directional derivatives:\n$$\n\\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{t}| = \\sum_{i=1}^3 \\left|\\nabla N_i \\cdot \\frac{\\boldsymbol{\\beta}}{\\|\\boldsymbol{\\beta}\\|}\\right| = \\frac{1}{\\|\\boldsymbol{\\beta}\\|} \\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{\\beta}| = \\frac{1600/3}{\\sqrt{100.25}}\n$$\nSubstituting this into the formula for $h_{\\boldsymbol{t}}$:\n$$\nh_{\\boldsymbol{t}} = \\frac{2}{\\frac{1600/3}{\\sqrt{100.25}}} = \\frac{6 \\sqrt{100.25}}{1600} = \\frac{3 \\sqrt{100.25}}{800}\n$$\nNumerically evaluating this expression, we find:\n$$\nh_{\\boldsymbol{t}} \\approx \\frac{3 \\times 10.0124922}{800} \\approx 0.03754684575\n$$\nRounding to six significant figures, $h_{\\boldsymbol{t}} = 0.0375468$.\n\n(b) Derivation and evaluation of the SUPG stabilization parameter $\\tau$.\n\nThe optimal SUPG stabilization parameter for the one-dimensional, constant-coefficient advection-diffusion equation on a linear element of length $h$ is given by:\n$$\n\\tau_{\\text{1D}} = \\frac{h}{2\\beta} \\left( \\coth(Pe_{\\text{1D}}) - \\frac{1}{Pe_{\\text{1D}}} \\right)\n$$\nwhere the one-dimensional Péclet number is $Pe_{\\text{1D}} = \\frac{\\beta h}{2\\epsilon}$.\n\nTo derive the expression for the multidimensional case, we generalize this formula by consistently replacing the one-dimensional quantities with their multidimensional counterparts. The element length $h$ is replaced by the directional element length $h_{\\boldsymbol{t}}$ along the streamline. The scalar velocity $\\beta$ is replaced by its magnitude $\\|\\boldsymbol{\\beta}\\|$. This yields the expression for the stabilization parameter $\\tau$ as:\n$$\n\\tau = \\frac{h_{\\boldsymbol{t}}}{2\\|\\boldsymbol{\\beta}\\|} \\left( \\coth(Pe) - \\frac{1}{Pe} \\right)\n$$\nwhere the element Péclet number is now defined as:\n$$\nPe = \\frac{\\|\\boldsymbol{\\beta}\\| h_{\\boldsymbol{t}}}{2\\epsilon}\n$$\nThis constitutes the required derivation. We now evaluate this for the given data. First, we compute the element Péclet number $Pe$:\n$$\nPe = \\frac{\\|\\boldsymbol{\\beta}\\| h_{\\boldsymbol{t}}}{2\\epsilon} = \\frac{\\sqrt{100.25}}{2 \\times 10^{-4}} \\left( \\frac{3 \\sqrt{100.25}}{800} \\right) = \\frac{3 (100.25)}{1600 \\times 10^{-4}} = \\frac{300.75}{0.16} = 1879.6875\n$$\nThe value of the Péclet number is very large, signifying a strongly advection-dominated regime. For large arguments $x$, the hyperbolic cotangent function $\\coth(x)$ rapidly approaches $1$. For $Pe = 1879.6875$, the value of $\\coth(Pe)$ is computationally indistinguishable from $1$. Therefore, we can use the high-Péclet number asymptotic form.\nSubstituting the expressions for $h_{\\boldsymbol{t}}$ and $Pe$ into the formula for $\\tau$:\n$$\n\\tau = \\frac{1}{2\\|\\boldsymbol{\\beta}\\|} \\left(\\frac{3 \\sqrt{100.25}}{800}\\right) \\left( \\coth(Pe) - \\frac{1}{Pe} \\right) = \\frac{3 \\sqrt{100.25}}{1600\\|\\boldsymbol{\\beta}\\|} \\left( \\coth(Pe) - \\frac{1}{Pe} \\right)\n$$\nSince $\\|\\boldsymbol{\\beta}\\| = \\sqrt{100.25}$, this simplifies to:\n$$\n\\tau = \\frac{3}{1600} \\left( \\coth(Pe) - \\frac{1}{Pe} \\right)\n$$\nUsing the value of $Pe$ and the approximation $\\coth(Pe) \\approx 1$:\n$$\n\\tau \\approx \\frac{3}{1600} \\left( 1 - \\frac{1}{1879.6875} \\right)\n$$\n$$\n\\tau \\approx 0.001875 \\left( 1 - 0.0005320053... \\right) \\approx 0.001875 \\times 0.99946799... \\approx 0.00187400249\n$$\nRounding to six significant figures, $\\tau = 0.00187400$.", "answer": "$$\\boxed{\\begin{pmatrix} 0.0375468 & 0.00187400 \\end{pmatrix}}$$", "id": "2602150"}]}