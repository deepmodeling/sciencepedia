{"hands_on_practices": [{"introduction": "Central to the finite element method is the translation of continuum physics into discrete algebraic equations. This foundational practice guides you through this process for a simple thermoelastic bar, deriving the essential element matrices from the principles of virtual work and the weak form of the heat equation. Mastering this derivation is a critical first step toward understanding, implementing, and customizing advanced thermo-mechanical simulation tools [@problem_id:2605803].", "problem": "A straight, slender thermoelastic bar of constant cross-section undergoes coupled deformation and heat conduction. Consider a single two-node finite element of length $L$ and cross-sectional area $A$, with the axial displacement field $u(x)$ and the temperature field $\\Theta(x)$ both interpolated by linear shape functions. Let the modulus of elasticity be $E$, the coefficient of linear thermal expansion be $\\alpha$, and the thermal conductivity be $k$. Assume small strain, quasi-static mechanics, steady-state heat conduction, no mechanical body forces, and no internal heat sources. The reference temperature is $T_{0}$, and nodal temperatures are prescribed relative to $T_{0}$.\n\nStarting from first principles, use:\n- the mechanical principle of virtual work, with Cauchy stress $\\sigma = E\\left(\\epsilon - \\epsilon_{\\text{th}}\\right)$ and axial strain $\\epsilon = \\frac{du}{dx}$, together with thermal strain $\\epsilon_{\\text{th}} = \\alpha\\left(\\Theta - T_{0}\\right)$, and\n- the weak form of the steady heat equation with Fourierâ€™s law (heat flux $q = -k\\,\\frac{d\\Theta}{dx}$),\n\nto derive, for this two-node linear element, the element-level expressions for:\n- the mechanical stiffness matrix,\n- the thermo-mechanical coupling matrix that maps nodal temperatures to mechanical internal forces,\n- the thermal conductivity matrix, and\n- the equivalent mechanical thermal load vector arising from the thermal strain.\n\nThen, specialize to the following data and compute the second component of the equivalent mechanical thermal load vector for the element:\n- $L = 0.40~\\text{m}$,\n- $A = 2.0 \\times 10^{-4}~\\text{m}^{2}$,\n- $E = 210 \\times 10^{9}~\\text{Pa}$,\n- $\\alpha = 12 \\times 10^{-6}~\\text{K}^{-1}$,\n- $k = 50~\\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$,\n- nodal temperatures relative to $T_{0}$ are $\\Theta_{1} = 0~\\text{K}$ and $\\Theta_{2} = 60~\\text{K}$.\n\nUse linear Lagrange shape functions over the element for both $u$ and $\\Theta$, and take the cross-section and material properties to be constant within the element. Express the requested final numerical value in newtons (N), and round your answer to four significant figures.", "solution": "The problem statement has been subjected to rigorous validation and is found to be valid. It is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. We may therefore proceed with the derivation and calculation.\n\nThe problem requires the derivation of element matrices for a $2$-node linear thermoelastic bar element of length $L$ and constant cross-sectional area $A$. The element is oriented along the $x$-axis, with node $1$ at $x=0$ and node $2$ at $x=L$.\n\nThe axial displacement field $u(x)$ and the temperature field $\\Theta(x)$ (relative to the reference temperature $T_0$) are interpolated from their nodal values using linear Lagrange shape functions:\n$$\nu(x) = N_1(x) u_1 + N_2(x) u_2 = \\mathbf{N}(x) \\mathbf{u}^e\n$$\n$$\n\\Theta(x) = N_1(x) \\Theta_1 + N_2(x) \\Theta_2 = \\mathbf{N}(x) \\mathbf{\\Theta}^e\n$$\nwhere $u_1, u_2$ are the nodal displacements and $\\Theta_1, \\Theta_2$ are the nodal temperatures. The shape function vector is $\\mathbf{N} = \\begin{pmatrix} N_1(x) & N_2(x) \\end{pmatrix}$ and the nodal vectors are $\\mathbf{u}^e = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$ and $\\mathbf{\\Theta}^e = \\begin{pmatrix} \\Theta_1 \\\\ \\Theta_2 \\end{pmatrix}$. The linear shape functions are:\n$$\nN_1(x) = 1 - \\frac{x}{L}, \\quad N_2(x) = \\frac{x}{L}\n$$\nThe axial strain $\\epsilon = \\frac{du}{dx}$ is related to the nodal displacements through the strain-displacement matrix $\\mathbf{B}_u$:\n$$\n\\epsilon(x) = \\frac{d\\mathbf{N}}{dx} \\mathbf{u}^e = \\begin{pmatrix} -\\frac{1}{L} & \\frac{1}{L} \\end{pmatrix} \\mathbf{u}^e = \\mathbf{B}_u \\mathbf{u}^e\n$$\nThus, $\\mathbf{B}_u = \\frac{1}{L}\\begin{pmatrix} -1 & 1 \\end{pmatrix}$.\nSimilarly, the temperature gradient $\\frac{d\\Theta}{dx}$ is related to nodal temperatures by $\\mathbf{B}_\\Theta$:\n$$\n\\frac{d\\Theta}{dx} = \\frac{d\\mathbf{N}}{dx} \\mathbf{\\Theta}^e = \\begin{pmatrix} -\\frac{1}{L} & \\frac{1}{L} \\end{pmatrix} \\mathbf{\\Theta}^e = \\mathbf{B}_\\Theta \\mathbf{\\Theta}^e\n$$\nwhere $\\mathbf{B}_\\Theta = \\frac{1}{L}\\begin{pmatrix} -1 & 1 \\end{pmatrix}$.\n\nFirst, we derive the mechanical components. The principle of virtual work for a quasi-static problem with no body forces states that the internal virtual work equals the external virtual work done by nodal forces $\\mathbf{F}_{\\text{ext}}^e$:\n$$\n\\delta W_{\\text{int}} = \\int_{V} \\delta\\epsilon^T \\sigma \\, dV = (\\delta \\mathbf{u}^e)^T \\mathbf{F}_{\\text{ext}}^e\n$$\nSubstituting $\\delta\\epsilon = \\mathbf{B}_u \\delta\\mathbf{u}^e$, we have $\\int_{V} (\\delta\\mathbf{u}^e)^T \\mathbf{B}_u^T \\sigma \\, dV = (\\delta\\mathbf{u}^e)^T \\mathbf{F}_{\\text{ext}}^e$. Since the virtual displacements $\\delta\\mathbf{u}^e$ are arbitrary, this leads to the element equilibrium equation:\n$$\n\\mathbf{F}_{\\text{int}}^e = \\int_{V} \\mathbf{B}_u^T \\sigma \\, dV = \\mathbf{F}_{\\text{ext}}^e\n$$\nUsing the constitutive relation $\\sigma = E(\\epsilon - \\epsilon_{\\text{th}})$ with $\\epsilon = \\mathbf{B}_u \\mathbf{u}^e$ and thermal strain $\\epsilon_{\\text{th}} = \\alpha \\Theta = \\alpha \\mathbf{N} \\mathbf{\\Theta}^e$:\n$$\n\\int_V \\mathbf{B}_u^T E (\\mathbf{B}_u \\mathbf{u}^e - \\alpha \\mathbf{N} \\mathbf{\\Theta}^e) \\, dV = \\mathbf{F}_{\\text{ext}}^e\n$$\nSeparating the terms, we get:\n$$\n\\left( \\int_V E \\mathbf{B}_u^T \\mathbf{B}_u \\, dV \\right) \\mathbf{u}^e - \\left( \\int_V E \\alpha \\mathbf{B}_u^T \\mathbf{N} \\, dV \\right) \\mathbf{\\Theta}^e = \\mathbf{F}_{\\text{ext}}^e\n$$\nThe standard form of the equilibrium equation is $\\mathbf{K}_{uu} \\mathbf{u}^e = \\mathbf{F}_{\\text{ext}}^e + \\mathbf{F}_{\\text{th}}^{\\text{eq}}$. Thus, we can identify the matrices.\n\n$1$. The mechanical stiffness matrix, $\\mathbf{K}_{uu}$:\n$$\n\\mathbf{K}_{uu} = \\int_V E \\mathbf{B}_u^T \\mathbf{B}_u \\, dV = \\int_0^L A E \\mathbf{B}_u^T \\mathbf{B}_u \\, dx\n$$\nSince $A$, $E$, and $\\mathbf{B}_u$ are constant over the element:\n$$\n\\mathbf{K}_{uu} = A E L (\\mathbf{B}_u^T \\mathbf{B}_u) = A E L \\left( \\frac{1}{L^2} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} -1 & 1 \\end{pmatrix} \\right) = \\frac{AE}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n\n$2$. The equivalent mechanical thermal load vector, $\\mathbf{F}_{\\text{th}}^{\\text{eq}}$, is the term moved to the right-hand side:\n$$\n\\mathbf{F}_{\\text{th}}^{\\text{eq}} = \\left( \\int_V E \\alpha \\mathbf{B}_u^T \\mathbf{N} \\, dV \\right) \\mathbf{\\Theta}^e = \\left( \\int_0^L A E \\alpha \\mathbf{B}_u^T \\mathbf{N} \\, dx \\right) \\mathbf{\\Theta}^e\n$$\nThis defines the thermo-mechanical coupling matrix $\\mathbf{K}_{u\\Theta}$ which maps nodal temperatures to mechanical forces.\n\n$3$. The thermo-mechanical coupling matrix, $\\mathbf{K}_{u\\Theta}$:\n$$\n\\mathbf{K}_{u\\Theta} = \\int_0^L A E \\alpha \\mathbf{B}_u^T \\mathbf{N}(x) \\, dx\n$$\nIntegrating $\\mathbf{N}(x)$ over the element length: $\\int_0^L \\mathbf{N}(x) dx = \\int_0^L \\begin{pmatrix} 1 - \\frac{x}{L} & \\frac{x}{L} \\end{pmatrix} dx = \\begin{pmatrix} \\frac{L}{2} & \\frac{L}{2} \\end{pmatrix}$.\n$$\n\\mathbf{K}_{u\\Theta} = A E \\alpha \\mathbf{B}_u^T \\int_0^L \\mathbf{N}(x) \\, dx = A E \\alpha \\left( \\frac{1}{L} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} \\right) \\begin{pmatrix} \\frac{L}{2} & \\frac{L}{2} \\end{pmatrix} = \\frac{AE\\alpha}{2} \\begin{pmatrix} -1 & -1 \\\\ 1 & 1 \\end{pmatrix}\n$$\n\n$4$. The equivalent mechanical thermal load vector is therefore:\n$$\n\\mathbf{F}_{\\text{th}}^{\\text{eq}} = \\mathbf{K}_{u\\Theta} \\mathbf{\\Theta}^e = \\frac{AE\\alpha}{2} \\begin{pmatrix} -1 & -1 \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} \\Theta_1 \\\\ \\Theta_2 \\end{pmatrix}\n$$\n\nNext, we derive the thermal component. The weak form of the steady-state heat equation, $-\\frac{d}{dx}(k \\frac{d\\Theta}{dx})=0$, is obtained by multiplying by a weight function $w(x)$ and integrating by parts. This results in the Galerkin form:\n$$\n\\int_0^L A k \\frac{dw}{dx} \\frac{d\\Theta}{dx} \\, dx = \\mathbf{Q}^e\n$$\nwhere $\\mathbf{Q}^e$ is the vector of nodal heat fluxes. Using $w = \\mathbf{N}\\mathbf{w}^e$ and $\\Theta = \\mathbf{N}\\mathbf{\\Theta}^e$, we get:\n$$\n\\left( \\int_0^L A k \\mathbf{B}_\\Theta^T \\mathbf{B}_\\Theta \\, dx \\right) \\mathbf{\\Theta}^e = \\mathbf{Q}^e\n$$\n\n$5$. The thermal conductivity matrix, $\\mathbf{K}_{\\Theta\\Theta}$:\n$$\n\\mathbf{K}_{\\Theta\\Theta} = \\int_0^L A k \\mathbf{B}_\\Theta^T \\mathbf{B}_\\Theta \\, dx\n$$\nThe form is identical to that of the mechanical stiffness matrix, with $E$ replaced by $k$:\n$$\n\\mathbf{K}_{\\Theta\\Theta} = A k L (\\mathbf{B}_\\Theta^T \\mathbf{B}_\\Theta) = A k L \\left( \\frac{1}{L^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\right) = \\frac{Ak}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n\nSummary of derived expressions:\n- Mechanical stiffness matrix: $\\mathbf{K}_{uu} = \\frac{AE}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$\n- Thermo-mechanical coupling matrix: $\\mathbf{K}_{u\\Theta} = \\frac{AE\\alpha}{2} \\begin{pmatrix} -1 & -1 \\\\ 1 & 1 \\end{pmatrix}$\n- Thermal conductivity matrix: $\\mathbf{K}_{\\Theta\\Theta} = \\frac{Ak}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$\n- Equivalent mechanical thermal load vector: $\\mathbf{F}_{\\text{th}}^{\\text{eq}} = \\frac{AE\\alpha}{2} (\\Theta_1+\\Theta_2) \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$\n\nNow, we compute the second component of the equivalent mechanical thermal load vector, $(\\mathbf{F}_{\\text{th}}^{\\text{eq}})_2$, using the given data.\nThe formula for the second component is:\n$$\n(\\mathbf{F}_{\\text{th}}^{\\text{eq}})_2 = \\frac{AE\\alpha}{2} (1 \\cdot \\Theta_1 + 1 \\cdot \\Theta_2) = \\frac{AE\\alpha}{2} (\\Theta_1 + \\Theta_2)\n$$\nThe provided values are:\n- $L = 0.40~\\text{m}$\n- $A = 2.0 \\times 10^{-4}~\\text{m}^2$\n- $E = 210 \\times 10^9~\\text{Pa}$\n- $\\alpha = 12 \\times 10^{-6}~\\text{K}^{-1}$\n- $\\Theta_1 = 0~\\text{K}$\n- $\\Theta_2 = 60~\\text{K}$\n\nSubstituting these values into the expression:\n$$\n(\\mathbf{F}_{\\text{th}}^{\\text{eq}})_2 = \\frac{(2.0 \\times 10^{-4}) \\times (210 \\times 10^9) \\times (12 \\times 10^{-6})}{2} (0 + 60)\n$$\nFirst, calculate the product $AE\\alpha$:\n$$\nAE\\alpha = (2.0 \\times 10^{-4}~\\text{m}^2) \\times (210 \\times 10^9~\\text{N/m}^2) \\times (12 \\times 10^{-6}~\\text{K}^{-1})\n$$\n$$\nAE\\alpha = (2.0 \\times 210 \\times 12) \\times (10^{-4} \\times 10^9 \\times 10^{-6})~\\text{N/K}\n$$\n$$\nAE\\alpha = (5040) \\times (10^{-1})~\\text{N/K} = 504~\\text{N/K}\n$$\nNow, substitute this back into the equation for the force component:\n$$\n(\\mathbf{F}_{\\text{th}}^{\\text{eq}})_2 = \\frac{504~\\text{N/K}}{2} \\times (60~\\text{K}) = 252~\\text{N} \\times 60 = 15120~\\text{N}\n$$\nThe problem requires the answer to be rounded to four significant figures. The calculated value $15120$ already has exactly four significant figures.", "answer": "$$\\boxed{15120}$$", "id": "2605803"}, {"introduction": "A numerical model is only as reliable as its verification. This exercise moves from single-element derivation to assembling a simple model and critically assessing its accuracy against a known analytical solution [@problem_id:2605808]. By solving for the stress in a constrained bi-material bar both on paper and with finite elements, you will gain practical experience in model validation and uncover important properties about the performance of linear elements in thermo-mechanical analysis.", "problem": "Consider a perfectly bonded, prismatic, one-dimensional bi-material bar composed of two segments in series. Segment $1$ has length $L_{1}$, Young's modulus $E_{1}$, and coefficient of thermal expansion $\\alpha_{1}$; segment $2$ has length $L_{2}$, Young's modulus $E_{2}$, and coefficient of thermal expansion $\\alpha_{2}$. The cross-sectional area $A$ is uniform and identical in both segments. The bar is subjected to a uniform temperature change $\\Delta T$ throughout both segments. The left end at $x=0$ and the right end at $x=L_{1}+L_{2}$ are both axially fixed so that $u(0)=0$ and $u(L_{1}+L_{2})=0$. There are no external mechanical distributed or concentrated axial loads. Assume small strains and small displacements.\n\nTask A (derivation). Starting exclusively from fundamental principles appropriate for thermo-mechanical coupling in solids and the finite element method, namely: (i) axial equilibrium in the absence of axial body forces, (ii) one-dimensional small-strain kinematics, and (iii) the linear thermoelastic constitutive relation for each segment, derive the exact analytical axial stress distribution $\\sigma(x)$ along the bar. Your derivation must explicitly use:\n- Axial equilibrium in one dimension, expressed in terms of axial force $N(x)$.\n- The one-dimensional small-strain kinematic relation $\\varepsilon(x)=\\dfrac{du}{dx}$.\n- The one-dimensional linear thermoelastic constitutive relation for each segment, relating stress $\\sigma$, total strain $\\varepsilon$, Young's modulus $E$, and coefficient of thermal expansion $\\alpha$ under temperature change $\\Delta T$.\n- Compatibility of displacements across the bi-material interface and the essential boundary conditions at $x=0$ and $x=L_{1}+L_{2}$.\n\nTask B (finite element formulation). Using two-node linear bar elements, construct a one-dimensional finite element model with one element per segment. Derive, from first principles, the element stiffness matrix and the consistent thermal equivalent nodal force vector for an element of length $\\ell$, modulus $E$, cross-sectional area $A$, and coefficient of thermal expansion $\\alpha$ under a uniform temperature change $\\Delta T$. Clearly indicate how the thermal strain enters the weak form and how it produces the consistent nodal forces. Assemble the global system, impose the essential boundary conditions $u(0)=0$ and $u(L_{1}+L_{2})=0$, solve for the nodal displacements, and compute the constant stress within each element from the recovered strains.\n\nTask C (comparison and numerical test suite). Implement a program that:\n- Computes the analytical stress distribution derived in Task A.\n- Computes the finite element stresses in each element from Task B.\n- Reports, for each test case, a single scalar defined as the maximum absolute difference between the analytical stress and the finite element element-wise stresses. This scalar must be expressed in Pascals (Pa) as a floating-point number.\n\nYour program must evaluate the following test suite. Use the specified physical units exactly as stated:\n- Case $1$ (general asymmetric case): $L_{1}=0.6$ m, $L_{2}=0.4$ m, $E_{1}=70\\times 10^{9}$ Pa, $E_{2}=210\\times 10^{9}$ Pa, $\\alpha_{1}=23\\times 10^{-6}$ K$^{-1}$, $\\alpha_{2}=12\\times 10^{-6}$ K$^{-1}$, $\\Delta T=50$ K, $A=1\\times 10^{-3}$ m$^{2}$.\n- Case $2$ (symmetric material case): $L_{1}=1.0$ m, $L_{2}=1.0$ m, $E_{1}=200\\times 10^{9}$ Pa, $E_{2}=200\\times 10^{9}$ Pa, $\\alpha_{1}=10\\times 10^{-6}$ K$^{-1}$, $\\alpha_{2}=10\\times 10^{-6}$ K$^{-1}$, $\\Delta T=100$ K, $A=2\\times 10^{-4}$ m$^{2}$.\n- Case $3$ (high mismatch and cooling): $L_{1}=0.8$ m, $L_{2}=0.2$ m, $E_{1}=1\\times 10^{9}$ Pa, $E_{2}=200\\times 10^{9}$ Pa, $\\alpha_{1}=100\\times 10^{-6}$ K$^{-1}$, $\\alpha_{2}=12\\times 10^{-6}$ K$^{-1}$, $\\Delta T=-30$ K, $A=5\\times 10^{-4}$ m$^{2}$.\n- Case $4$ (one segment with negative thermal expansion): $L_{1}=0.5$ m, $L_{2}=0.5$ m, $E_{1}=100\\times 10^{9}$ Pa, $E_{2}=50\\times 10^{9}$ Pa, $\\alpha_{1}=12\\times 10^{-6}$ K$^{-1}$, $\\alpha_{2}=-5\\times 10^{-6}$ K$^{-1}$, $\\Delta T=75$ K, $A=1\\times 10^{-3}$ m$^{2}$.\n\nFinal output format. Your program should produce a single line of output containing the results for the four cases as a comma-separated list enclosed in square brackets, with no spaces. For example, the line should look like $[$result\\_1,result\\_2,result\\_3,result\\_4$]$, where each result is the maximum absolute stress difference for the corresponding case in Pa as a floating-point number.", "solution": "The problem presented is a standard, well-posed problem in one-dimensional thermoelasticity. It is scientifically sound, contains all necessary information, and is free of contradictions or ambiguities. It requires the application of fundamental principles from continuum mechanics and the finite element method. We shall proceed directly to the derivation and solution.\n\nThe analysis is divided into three parts as requested: analytical derivation, finite element formulation, and numerical comparison.\n\n**Task A: Analytical Derivation**\n\nThe derivation of the stress distribution $\\sigma(x)$ is founded on three pillars: equilibrium, kinematics, and the constitutive law.\n\n1.  **Axial Equilibrium**: The problem states there are no axial body forces. The one-dimensional differential equation for axial equilibrium is $\\frac{dN}{dx} + b(x) = 0$, where $N(x)$ is the axial force and $b(x)$ is the distributed axial force per unit length. With $b(x)=0$, the equation simplifies to $\\frac{dN}{dx}=0$. This implies that the axial force $N(x)$ is constant along the entire length of the bar. Since the cross-sectional area $A$ is also uniform, the axial stress $\\sigma(x) = N(x)/A$ must be constant throughout the bar. Let us denote this constant stress as $\\sigma_0$. Therefore, $\\sigma(x) = \\sigma_0$ for $x \\in [0, L_{1}+L_{2}]$.\n\n2.  **Constitutive Relation**: The one-dimensional linear thermoelastic constitutive relation relates stress $\\sigma$, total strain $\\varepsilon$, Young's modulus $E$, coefficient of thermal expansion $\\alpha$, and temperature change $\\Delta T$. The total strain $\\varepsilon$ is the sum of the mechanical strain $\\varepsilon_m$ and the thermal strain $\\varepsilon_{th}$.\n    $$ \\varepsilon = \\varepsilon_m + \\varepsilon_{th} $$\n    The stress is proportional to the mechanical strain, $\\sigma = E \\varepsilon_m$, and the thermal strain is $\\varepsilon_{th} = \\alpha \\Delta T$. Combining these gives the total stress-strain relation:\n    $$ \\sigma = E (\\varepsilon - \\alpha \\Delta T) $$\n    This relation can be rearranged to express the total strain as a function of stress:\n    $$ \\varepsilon = \\frac{\\sigma}{E} + \\alpha \\Delta T $$\n    Applying this to each segment with the constant stress $\\sigma_0$:\n    - For Segment 1 ($0 \\leq x \\leq L_{1}$): $\\varepsilon_{1}(x) = \\frac{\\sigma_0}{E_{1}} + \\alpha_{1} \\Delta T$\n    - For Segment 2 ($L_{1} < x \\leq L_{1}+L_{2}$): $\\varepsilon_{2}(x) = \\frac{\\sigma_0}{E_{2}} + \\alpha_{2} \\Delta T$\n    The strain in each segment is constant because $\\sigma_0$, $E$, $\\alpha$, and $\\Delta T$ are constant within each segment.\n\n3.  **Kinematics and Boundary Conditions**: The total strain is defined by the small-strain kinematic relation $\\varepsilon(x) = \\frac{du}{dx}$, where $u(x)$ is the axial displacement. The total change in length of the bar is obtained by integrating the strain over its entire length:\n    $$ \\Delta L_{total} = u(L_{1}+L_{2}) - u(0) = \\int_{0}^{L_{1}+L_{2}} \\varepsilon(x) dx $$\n    The bar is fixed at both ends, so the essential boundary conditions are $u(0)=0$ and $u(L_{1}+L_{2})=0$. This imposes the constraint that the total elongation is zero:\n    $$ \\int_{0}^{L_{1}+L_{2}} \\varepsilon(x) dx = 0 $$\n    We can split the integral over the two segments:\n    $$ \\int_{0}^{L_{1}} \\varepsilon_{1}(x) dx + \\int_{L_{1}}^{L_{1}+L_{2}} \\varepsilon_{2}(x) dx = 0 $$\n    Since $\\varepsilon_{1}$ and $\\varepsilon_{2}$ are constant within their respective domains:\n    $$ \\varepsilon_{1} L_{1} + \\varepsilon_{2} L_{2} = 0 $$\n    Substituting the constitutive expressions for strain:\n    $$ \\left( \\frac{\\sigma_0}{E_{1}} + \\alpha_{1} \\Delta T \\right) L_{1} + \\left( \\frac{\\sigma_0}{E_{2}} + \\alpha_{2} \\Delta T \\right) L_{2} = 0 $$\n    We now solve for the unknown constant stress $\\sigma_0$:\n    $$ \\sigma_0 \\left( \\frac{L_{1}}{E_{1}} + \\frac{L_{2}}{E_{2}} \\right) + (\\alpha_{1} L_{1} + \\alpha_{2} L_{2}) \\Delta T = 0 $$\n    $$ \\sigma_0 = - \\frac{(\\alpha_{1} L_{1} + \\alpha_{2} L_{2}) \\Delta T}{\\frac{L_{1}}{E_{1}} + \\frac{L_{2}}{E_{2}}} $$\n    This is the exact analytical expression for the axial stress, which is uniform throughout the entire bar. For calculation, it is convenient to write this as:\n    $$ \\sigma_0 = - \\frac{E_{1} E_{2} (\\alpha_{1} L_{1} + \\alpha_{2} L_{2})}{E_{1} L_{2} + E_{2} L_{1}} \\Delta T $$\n\n**Task B: Finite Element Formulation**\n\nWe model the system using two two-node linear bar elements. Element $1$ spans nodes $1$ and $2$ (from $x=0$ to $x=L_{1}$), and Element $2$ spans nodes $2$ and $3$ (from $x=L_{1}$ to $x=L_{1}+L_{2}$).\n\n1.  **Element Formulation from First Principles**:\n    The formulation is based on the Principle of Virtual Work. For a single element of length $\\ell$, the virtual work equation is:\n    $$ \\int_{0}^{\\ell} \\delta \\varepsilon^T \\sigma A dx = \\delta \\mathbf{d}^{eT} \\mathbf{f}_{ext}^{e} $$\n    where $\\delta \\varepsilon$ is the virtual strain, $\\sigma$ is the stress, $A$ is the area, $\\delta \\mathbf{d}^{e}$ is the vector of virtual nodal displacements, and $\\mathbf{f}_{ext}^{e}$ is the vector of external nodal forces.\n\n    The displacement field $u(x)$ inside a linear element is interpolated from nodal displacements $\\mathbf{d}^e=[u_1, u_2]^T$ using shape functions $\\mathbf{N}(x) = [1-x/\\ell, x/\\ell]$: $u(x) = \\mathbf{N}(x) \\mathbf{d}^e$.\n    The strain $\\varepsilon(x)$ is given by $\\varepsilon(x) = \\frac{du}{dx} = \\frac{d\\mathbf{N}}{dx} \\mathbf{d}^e = \\mathbf{B} \\mathbf{d}^e$, where $\\mathbf{B} = [-1/\\ell, 1/\\ell]$ is the strain-displacement matrix.\n    The virtual strain is $\\delta\\varepsilon = \\mathbf{B} \\delta\\mathbf{d}^e$.\n    The stress is given by the thermoelastic constitutive law: $\\sigma = E(\\varepsilon - \\varepsilon_{th}) = E(\\mathbf{B}\\mathbf{d}^e - \\alpha\\Delta T)$.\n\n    Substituting these into the virtual work equation:\n    $$ \\int_{0}^{\\ell} (\\mathbf{B} \\delta\\mathbf{d}^e)^T E(\\mathbf{B}\\mathbf{d}^e - \\alpha\\Delta T) A dx = \\delta\\mathbf{d}^{eT} \\mathbf{f}_{ext}^{e} $$\n    $$ \\delta\\mathbf{d}^{eT} \\int_{0}^{\\ell} \\mathbf{B}^T E \\mathbf{B} A dx \\ \\mathbf{d}^e - \\delta\\mathbf{d}^{eT} \\int_{0}^{\\ell} \\mathbf{B}^T E \\alpha \\Delta T A dx = \\delta\\mathbf{d}^{eT} \\mathbf{f}_{ext}^{e} $$\n    As this holds for any $\\delta\\mathbf{d}^e$, we obtain the element matrix equation:\n    $$ \\left( \\int_{0}^{\\ell} \\mathbf{B}^T E \\mathbf{B} A dx \\right) \\mathbf{d}^e = \\mathbf{f}_{ext}^{e} + \\left( \\int_{0}^{\\ell} \\mathbf{B}^T E \\alpha \\Delta T A dx \\right) $$\n    This is in the form $\\mathbf{k}^e \\mathbf{d}^e = \\mathbf{f}_{ext}^{e} + \\mathbf{f}_{th}^{e}$.\n\n2.  **Element Stiffness Matrix and Thermal Force Vector**:\n    The element stiffness matrix $\\mathbf{k}^e$ is:\n    $$ \\mathbf{k}^e = A \\int_{0}^{\\ell} \\begin{bmatrix} -1/\\ell \\\\ 1/\\ell \\end{bmatrix} E [-1/\\ell \\ 1/\\ell] dx = \\frac{EA}{\\ell^2} \\int_{0}^{\\ell} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} dx = \\frac{EA}{\\ell} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} $$\n    The thermal strain $\\varepsilon_{th} = \\alpha \\Delta T$ enters the weak form through the constitutive law. Its contribution results in the consistent thermal equivalent nodal force vector $\\mathbf{f}_{th}^e$:\n    $$ \\mathbf{f}_{th}^e = A \\int_{0}^{\\ell} \\mathbf{B}^T E \\alpha \\Delta T dx = A E \\alpha \\Delta T \\int_{0}^{\\ell} \\begin{bmatrix} -1/\\ell \\\\ 1/\\ell \\end{bmatrix} dx = A E \\alpha \\Delta T \\begin{bmatrix} -1 \\\\ 1 \\end{bmatrix} $$\n\n3.  **Global System Assembly and Solution**:\n    The global system involves three nodes with displacements $\\mathbf{U} = [U_1, U_2, U_3]^T$. As there are no external mechanical loads, $\\mathbf{F}_{ext} = \\mathbf{0}$. The global system is $\\mathbf{K}\\mathbf{U} = \\mathbf{F}_{th}$.\n    - Element 1 ($e=1$): $\\ell=L_1$, $E=E_1$, $\\alpha=\\alpha_1$. Connects nodes 1, 2.\n    - Element 2 ($e=2$): $\\ell=L_2$, $E=E_2$, $\\alpha=\\alpha_2$. Connects nodes 2, 3.\n    The assembled global stiffness matrix $\\mathbf{K}$ and thermal force vector $\\mathbf{F}_{th}$ are:\n    $$ \\mathbf{K} = A \\begin{bmatrix} \\frac{E_{1}}{L_{1}} & -\\frac{E_{1}}{L_{1}} & 0 \\\\ -\\frac{E_{1}}{L_{1}} & \\frac{E_{1}}{L_{1}} + \\frac{E_{2}}{L_{2}} & -\\frac{E_{2}}{L_{2}} \\\\ 0 & -\\frac{E_{2}}{L_{2}} & \\frac{E_{2}}{L_{2}} \\end{bmatrix}, \\quad \\mathbf{F}_{th} = A \\Delta T \\begin{Bmatrix} -E_{1}\\alpha_{1} \\\\ E_{1}\\alpha_{1} - E_{2}\\alpha_{2} \\\\ E_{2}\\alpha_{2} \\end{Bmatrix} $$\n    Applying boundary conditions $U_1=0$ and $U_3=0$, we only need to solve the second equation of the system for the unknown displacement $U_2$:\n    $$ A \\left( \\frac{E_{1}}{L_{1}} + \\frac{E_{2}}{L_{2}} \\right) U_2 = A \\Delta T (E_{1}\\alpha_{1} - E_{2}\\alpha_{2}) $$\n    $$ U_2 = \\frac{(E_{1}\\alpha_{1} - E_{2}\\alpha_{2}) \\Delta T}{\\frac{E_{1}}{L_{1}} + \\frac{E_{2}}{L_{2}}} $$\n\n4.  **Element Stress Recovery**:\n    The stress in each element is constant and is computed as $\\sigma^e = E(\\varepsilon^e - \\alpha\\Delta T)$.\n    - For Element 1: $\\varepsilon^{(1)} = \\mathbf{B}^{(1)} [U_1, U_2]^T = [-1/L_1, 1/L_1] [0, U_2]^T = U_2/L_1$.\n        $$ \\sigma^{(1)} = E_{1} \\left( \\frac{U_2}{L_{1}} - \\alpha_{1}\\Delta T \\right) $$\n    - For Element 2: $\\varepsilon^{(2)} = \\mathbf{B}^{(2)} [U_2, U_3]^T = [-1/L_2, 1/L_2] [U_2, 0]^T = -U_2/L_2$.\n        $$ \\sigma^{(2)} = E_{2} \\left( -\\frac{U_2}{L_{2}} - \\alpha_{2}\\Delta T \\right) $$\n\n**Task C: Comparison and Numerical Implementation**\n\nThe problem asks for the maximum absolute difference between the analytical stress $\\sigma_0$ and the element-wise finite element stresses $\\sigma^{(1)}$ and $\\sigma^{(2)}$.\n\nLet us substitute the derived expression for $U_2$ into the equation for $\\sigma^{(1)}$:\n$$ \\sigma^{(1)} = E_{1} \\left( \\frac{1}{L_{1}} \\frac{(E_{1}\\alpha_{1} - E_{2}\\alpha_{2})\\Delta T}{\\frac{E_{1}}{L_{1}} + \\frac{E_{2}}{L_{2}}} - \\alpha_{1}\\Delta T \\right) $$\n$$ \\sigma^{(1)} = \\Delta T \\frac{\\frac{E_{1}}{L_1}(E_{1}\\alpha_{1} - E_{2}\\alpha_{2}) - E_{1}\\alpha_{1}(\\frac{E_{1}}{L_1} + \\frac{E_{2}}{L_2})}{\\frac{E_{1}}{L_{1}} + \\frac{E_{2}}{L_{2}}} $$\n$$ \\sigma^{(1)} = \\Delta T \\frac{ - \\frac{E_{1}E_{2}\\alpha_{2}}{L_1} - \\frac{E_{1}E_{2}\\alpha_{1}}{L_2} }{\\frac{E_{1}L_{2} + E_{2}L_{1}}{L_1 L_2}} = \\Delta T \\frac{ - E_{1}E_{2} \\frac{\\alpha_{2}L_{2} + \\alpha_{1}L_{1}}{L_1 L_2} }{\\frac{E_{1}L_{2} + E_{2}L_{1}}{L_1 L_2}} $$\n$$ \\sigma^{(1)} = - \\frac{E_{1}E_{2}(\\alpha_{1}L_{1} + \\alpha_{2}L_{2})}{E_{1}L_{2} + E_{2}L_{1}} \\Delta T $$\nThis expression is identical to the analytical stress $\\sigma_0$. A similar substitution for $\\sigma^{(2)}$ confirms that $\\sigma^{(2)}=\\sigma_0$ as well.\n\nThe finite element model with two linear elements is therefore exact for this problem. This is a direct consequence of the fact that the exact analytical solution for strain is piecewise constant, which is a state that the linear element can represent exactly. The nodal displacement $U_2$ found from the FEM model is the exact displacement of the material interface. Consequently, the calculated difference between analytical and FE stresses should be zero, subject to the limits of floating-point precision in a numerical implementation. The program below will verify this.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares analytical and FEM solutions for stress in a bi-material bar.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general asymmetric case)\n        {\n            \"L1\": 0.6, \"L2\": 0.4,\n            \"E1\": 70e9, \"E2\": 210e9,\n            \"a1\": 23e-6, \"a2\": 12e-6,\n            \"dT\": 50.0,\n        },\n        # Case 2 (symmetric material case)\n        {\n            \"L1\": 1.0, \"L2\": 1.0,\n            \"E1\": 200e9, \"E2\": 200e9,\n            \"a1\": 10e-6, \"a2\": 10e-6,\n            \"dT\": 100.0,\n        },\n        # Case 3 (high mismatch and cooling)\n        {\n            \"L1\": 0.8, \"L2\": 0.2,\n            \"E1\": 1e9, \"E2\": 200e9,\n            \"a1\": 100e-6, \"a2\": 12e-6,\n            \"dT\": -30.0,\n        },\n        # Case 4 (one segment with negative thermal expansion)\n        {\n            \"L1\": 0.5, \"L2\": 0.5,\n            \"E1\": 100e9, \"E2\": 50e9,\n            \"a1\": 12e-6, \"a2\": -5e-6,\n            \"dT\": 75.0,\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        L1, L2 = params[\"L1\"], params[\"L2\"]\n        E1, E2 = params[\"E1\"], params[\"E2\"]\n        a1, a2 = params[\"a1\"], params[\"a2\"]\n        dT = params[\"dT\"]\n\n        # ----------------------------------------------------------------------\n        # Task A: Analytical Stress Calculation\n        # sigma_an = - (a1*L1 + a2*L2) * dT / (L1/E1 + L2/E2)\n        # The form below is more numerically stable for a wide range of E values.\n        # ----------------------------------------------------------------------\n        numerator_an = - (a1 * L1 + a2 * L2) * dT\n        denominator_an = (L1 / E1) + (L2 / E2)\n        \n        # Avoid division by zero if both segments have infinite stiffness (hypothetical)\n        if denominator_an == 0:\n            sigma_an = 0.0 # No strain is possible, so stress is from constrained thermal expansion\n                           # In a more complete model, this would be -E*a*dT, but here we assume nonzero compliance\n        else:\n            sigma_an = numerator_an / denominator_an\n\n        # ----------------------------------------------------------------------\n        # Task B: Finite Element Stress Calculation\n        # 1. Solve for nodal displacement U2 at the interface\n        # ----------------------------------------------------------------------\n        numerator_U2 = (E1 * a1 - E2 * a2) * dT\n        denominator_U2 = (E1 / L1) + (E2 / L2)\n\n        # Avoid division by zero\n        if denominator_U2 == 0:\n            U2 = 0.0\n        else:\n            U2 = numerator_U2 / denominator_U2\n\n        # ----------------------------------------------------------------------\n        # 2. Compute stress in each element\n        # ----------------------------------------------------------------------\n        # Strain in element 1\n        epsilon1 = U2 / L1\n        # Stress in element 1\n        sigma_fem1 = E1 * (epsilon1 - a1 * dT)\n\n        # Strain in element 2\n        epsilon2 = -U2 / L2\n        # Stress in element 2\n        sigma_fem2 = E2 * (epsilon2 - a2 * dT)\n\n        # ----------------------------------------------------------------------\n        # Task C: Comparison\n        # Calculate the maximum absolute difference between analytical and FEM stresses.\n        # This is expected to be near zero, limited by floating-point precision.\n        # ----------------------------------------------------------------------\n        diff1 = abs(sigma_an - sigma_fem1)\n        diff2 = abs(sigma_an - sigma_fem2)\n        \n        max_abs_diff = max(diff1, diff2)\n        results.append(max_abs_diff)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2605808"}, {"introduction": "As we move from one-dimensional idealizations to more complex scenarios, we often encounter numerical challenges that require sophisticated solutions. This practice explores the critical issue of volumetric locking, a form of numerical stiffening that can corrupt simulations of thermally expanding, nearly incompressible materials [@problem_id:2605832]. You will delve into the mathematical origins of this problem and discover how advanced techniques like selective reduced integration are employed to ensure physically meaningful and accurate results.", "problem": "Consider small-strain, linear, isotropic thermoelasticity for a solid with LamÃ© parameters $\\lambda$ and $\\mu$, bulk modulus $\\kappa = \\lambda + \\tfrac{2}{3}\\mu$, and a constant coefficient of thermal expansion $\\alpha$. Let the absolute temperature change be spatially uniform and equal to $\\Delta T$. The Cauchy stress is related to the total strain $\\boldsymbol{\\varepsilon}$ by\n$$\n\\boldsymbol{\\sigma} = 2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon} - 3\\alpha \\Delta T\\right)\\mathbf{I},\n$$\nwhere $\\boldsymbol{\\varepsilon}^{\\text{dev}} = \\boldsymbol{\\varepsilon} - \\tfrac{1}{3}(\\operatorname{tr}\\boldsymbol{\\varepsilon})\\mathbf{I}$. Assume plane strain kinematics in the $x$-$y$ plane. Consider a single isoparametric bilinear quadrilateral ($Q4$) element with standard $C^{0}$ interpolation of displacements assembled into a global displacement vector $\\mathbf{d}$, such that the finite element (FEM) displacement field is $\\mathbf{u}^{h}(\\mathbf{x}) = \\mathbf{N}(\\mathbf{x})\\,\\mathbf{d}$ and the small-strain tensor is $\\boldsymbol{\\varepsilon}^{h} = \\mathbf{B}(\\mathbf{x})\\,\\mathbf{d}$. Assume traction-free boundaries with only minimal constraints to remove rigid body motions. Work at the element level and consider the displacement-displacement tangent stiffness $\\mathbf{K}_{uu}$ corresponding to the linearization of the internal virtual work.\n\nStarting strictly from the thermoelastic internal energy functional and its first variation, and without invoking any specialized element formulas, perform the following conceptual derivations and reasonings:\n\n- Show how the internal virtual work naturally splits into deviatoric and volumetric contributions of the form\n$$\n\\delta W_{\\text{int}} = \\int_{\\Omega_{e}} \\left[ 2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}}(\\mathbf{d}) : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}}(\\delta\\mathbf{d}) + \\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}(\\mathbf{d}) - 3\\alpha \\Delta T\\right)\\,\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon}(\\delta\\mathbf{d}) \\right]\\mathrm{d}\\Omega.\n$$\n\n- Using $\\boldsymbol{\\varepsilon}^{h}=\\mathbf{B}\\mathbf{d}$ and the trace operator, identify the element-level deviatoric and volumetric contributions to the tangent stiffness,\n$$\n\\mathbf{K}_{uu}^{\\text{dev}} = \\int_{\\Omega_{e}} 2\\mu\\,\\mathbf{B}_{\\text{dev}}^{T}\\mathbf{B}_{\\text{dev}}\\,\\mathrm{d}\\Omega,\\qquad\n\\mathbf{K}_{uu}^{\\text{vol}} = \\int_{\\Omega_{e}} \\kappa\\,\\mathbf{m}(\\mathbf{x})\\,\\mathbf{m}(\\mathbf{x})^{T}\\,\\mathrm{d}\\Omega,\n$$\nwhere $\\mathbf{m}(\\mathbf{x})$ is the vector field whose contraction with $\\mathbf{d}$ yields $\\operatorname{tr}\\boldsymbol{\\varepsilon}^{h}(\\mathbf{x})$, and $\\mathbf{B}_{\\text{dev}}$ maps $\\mathbf{d}$ to $\\boldsymbol{\\varepsilon}^{\\text{dev}}$. Explain why the thermal driving enters only the volumetric part for isotropic $\\alpha$ and uniform $\\Delta T$, and give the corresponding consistent element thermal load vector.\n\n- Argue, in the limit $\\kappa \\gg \\mu$, how the choice of numerical quadrature for $\\mathbf{K}_{uu}^{\\text{vol}}$ determines how many independent constraints are effectively enforced on the discrete dilatation $\\operatorname{tr}\\boldsymbol{\\varepsilon}^{h}(\\mathbf{x})$. Contrast full $2\\times 2$ Gauss integration versus selective reduced $1\\times 1$ Gauss integration for the volumetric term, while keeping $\\mathbf{K}_{uu}^{\\text{dev}}$ fully integrated. Connect this to the mechanism of volumetric locking under thermally driven dilatation in plane strain.\n\nBased on your derivations and reasoning, select all statements that are correct.\n\nA. In a bilinear quadrilateral element under plane strain with uniform $\\Delta T$ and traction-free boundaries, full $2\\times 2$ integration of $\\mathbf{K}_{uu}^{\\text{vol}}$ enforces the condition $\\operatorname{tr}\\boldsymbol{\\varepsilon}^{h} \\approx 3\\alpha\\Delta T$ at four Gauss points when $\\kappa \\gg \\mu$, which over-constrains the bilinear field and produces volumetric locking. Selective $1\\times 1$ integration enforces only the element-mean dilatation, allowing the thermally driven volumetric strain to be represented without spurious stiffening.\n\nB. Locking in the regime $\\kappa \\gg \\mu$ is primarily caused by the deviatoric stiffness, so reducing the integration order of $\\mathbf{K}_{uu}^{\\text{dev}}$ (while keeping $\\mathbf{K}_{uu}^{\\text{vol}}$ fully integrated) is the appropriate remedy for thermo-mechanical problems with large thermal dilatations.\n\nC. Selective reduced integration of the volumetric term is, to leading order, equivalent to a $\\bar{\\mathbf{B}}$-type projection that replaces $\\operatorname{tr}\\boldsymbol{\\varepsilon}^{h}$ by its elementwise mean. Consequently, as $\\kappa/\\mu \\to \\infty$, the computed hydrostatic stress under uniform $\\Delta T$ approaches the correct bounded continuum value rather than diverging spuriously.\n\nD. Using reduced integration only for $\\mathbf{K}_{uu}^{\\text{vol}}$ in a bilinear element under uniform $\\Delta T$ necessarily introduces hourglass modes and rank deficiency, even if $\\mathbf{K}_{uu}^{\\text{dev}}$ is fully integrated.\n\nSelect all that apply.", "solution": "The problem statement will first be validated, and then a solution will be derived based on fundamental principles of continuum mechanics and the finite element method.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Theory**: Small-strain, linear, isotropic thermoelasticity.\n-   **Material Constants**: LamÃ© parameters $\\lambda$ and $\\mu$; bulk modulus $\\kappa = \\lambda + \\frac{2}{3}\\mu$; coefficient of thermal expansion $\\alpha$.\n-   **Thermal Load**: Uniform absolute temperature change $\\Delta T$.\n-   **Constitutive Law**: Cauchy stress $\\boldsymbol{\\sigma} = 2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon} - 3\\alpha \\Delta T\\right)\\mathbf{I}$, with deviatoric strain $\\boldsymbol{\\varepsilon}^{\\text{dev}} = \\boldsymbol{\\varepsilon} - \\frac{1}{3}(\\operatorname{tr}\\boldsymbol{\\varepsilon})\\mathbf{I}$.\n-   **Kinematics**: Plane strain in the $x$-$y$ plane.\n-   **Finite Element Discretization**: A single isoparametric bilinear quadrilateral ($Q4$) element with $C^{0}$ displacement interpolation $\\mathbf{u}^{h}(\\mathbf{x}) = \\mathbf{N}(\\mathbf{x})\\,\\mathbf{d}$ and strain $\\boldsymbol{\\varepsilon}^{h} = \\mathbf{B}(\\mathbf{x})\\,\\mathbf{d}$.\n-   **Boundary Conditions**: Traction-free, with minimal constraints to prevent rigid body motion.\n-   **Objective**: Analyze the element-level tangent stiffness $\\mathbf{K}_{uu}$ and the phenomenon of volumetric locking under thermal load.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is scientifically grounded in standard linear thermoelasticity and finite element theory. The constitutive law is the standard representation in terms of deviatoric and volumetric components. The decomposition of a mechanical response into these parts is a cornerstone of solid mechanics. The concepts of plane strain, bilinear interpolation, and numerical quadrature are fundamental to computational mechanics. The phenomenon of volumetric locking in nearly incompressible materials modeled with low-order elements is a classic, well-posed topic. The problem is self-contained, providing all necessary definitions and context to perform the required conceptual derivations. There are no scientific flaws, ambiguities, or contradictions.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A rigorous analysis can proceed.\n\n### Derivations and Reasoning\n\nAs instructed, we proceed by deriving the required relations from first principles.\n\n**1. Derivation of the Internal Virtual Work Expression**\n\nThe internal virtual work, $\\delta W_{\\text{int}}$, is the variation of the strain energy with respect to the displacement field, which is expressed as the work done by the stresses on a virtual strain field $\\delta\\boldsymbol{\\varepsilon}$:\n$$\n\\delta W_{\\text{int}} = \\int_{\\Omega_{e}} \\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} \\, \\mathrm{d}\\Omega\n$$\nThe stress tensor $\\boldsymbol{\\sigma}$ and the virtual strain tensor $\\delta\\boldsymbol{\\varepsilon}$ can be additively decomposed into their deviatoric and volumetric (spherical) parts:\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\text{dev}} + \\frac{1}{3}(\\operatorname{tr}\\boldsymbol{\\sigma})\\mathbf{I}\n$$\n$$\n\\delta\\boldsymbol{\\varepsilon} = \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\frac{1}{3}(\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon})\\mathbf{I}\n$$\nThe double dot product of a deviatoric tensor and a spherical tensor is zero. Consequently, the product $\\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon}$ simplifies to:\n$$\n\\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} = \\boldsymbol{\\sigma}^{\\text{dev}} : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\frac{1}{9}(\\operatorname{tr}\\boldsymbol{\\sigma})(\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon})(\\mathbf{I}:\\mathbf{I})\n$$\nAssuming a 3D context, where $\\mathbf{I}:\\mathbf{I} = 3$, this becomes:\n$$\n\\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} = \\boldsymbol{\\sigma}^{\\text{dev}} : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\frac{1}{3}(\\operatorname{tr}\\boldsymbol{\\sigma})(\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon})\n$$\nThe provided constitutive law is $\\boldsymbol{\\sigma} = 2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon} - 3\\alpha \\Delta T\\right)\\mathbf{I}$. From this, we identify the deviatoric stress as $\\boldsymbol{\\sigma}^{\\text{dev}} = 2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}}$ and the trace of the stress as $\\operatorname{tr}\\boldsymbol{\\sigma} = 3\\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon} - 3\\alpha \\Delta T\\right)$. Substituting these into the expression for $\\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon}$ yields:\n$$\n\\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} = (2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}}) : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\frac{1}{3}\\left[3\\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon} - 3\\alpha \\Delta T\\right)\\right](\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon})\n$$\n$$\n\\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} = 2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}} : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon} - 3\\alpha \\Delta T\\right)\\,\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon}\n$$\nThe variation of the deviatoric strain, $\\delta(\\boldsymbol{\\varepsilon}^{\\text{dev}})$, is denoted $\\delta\\boldsymbol{\\varepsilon}^{\\text{dev}}$. Inserting the finite element approximations $\\boldsymbol{\\varepsilon}(\\mathbf{d})$ and $\\delta\\boldsymbol{\\varepsilon}(\\delta\\mathbf{d})$, we integrate over the element volume $\\Omega_e$ to obtain the internal virtual work as requested:\n$$\n\\delta W_{\\text{int}} = \\int_{\\Omega_{e}} \\left[ 2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}}(\\mathbf{d}) : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}}(\\delta\\mathbf{d}) + \\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}(\\mathbf{d}) - 3\\alpha \\Delta T\\right)\\,\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon}(\\delta\\mathbf{d}) \\right]\\mathrm{d}\\Omega\n$$\nThis demonstrates the natural split of the internal virtual work into deviatoric and volumetric contributions.\n\n**2. Element Stiffness and Thermal Load Vector**\n\nThe tangent stiffness matrix $\\mathbf{K}_{uu}$ is obtained by taking the directional derivative of the internal force vector, which is equivalent to the second variation of the internal energy functional. From the expression for $\\delta W_{\\text{int}}$, we can linearize it with respect to the displacement vector $\\mathbf{d}$. The terms that are quadratic in displacement variations contribute to the tangent stiffness.\n$$\n\\delta^2 W_{\\text{int}} = \\int_{\\Omega_{e}} \\left[ 2\\mu\\,\\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\kappa\\,\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon}\\,\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon} \\right]\\mathrm{d}\\Omega\n$$\nThe connection between the discrete degrees of freedom $\\mathbf{d}$ and the strain fields is given by $\\boldsymbol{\\varepsilon}^h = \\mathbf{B}\\mathbf{d}$. The trace of the strain is $\\operatorname{tr}\\boldsymbol{\\varepsilon}^h(\\mathbf{x}) = \\mathbf{m}(\\mathbf{x})^T\\mathbf{d}$, where $\\mathbf{m}(\\mathbf{x})^T$ is constructed from the appropriate components of $\\mathbf{B}(\\mathbf{x})$. The deviatoric strain is mapped from $\\mathbf{d}$ via another operator $\\mathbf{B}_{\\text{dev}}$.\n\nThe volumetric contribution to the stiffness is derived from the second term:\n$$\n\\delta^2 W_{\\text{int}}^{\\text{vol}} = \\int_{\\Omega_{e}} \\kappa \\left( \\operatorname{tr}\\delta\\boldsymbol{\\varepsilon} \\right)^2 \\mathrm{d}\\Omega = \\int_{\\Omega_{e}} \\kappa (\\mathbf{m}^T \\delta\\mathbf{d})^2 \\mathrm{d}\\Omega = \\delta\\mathbf{d}^T \\left( \\int_{\\Omega_e} \\kappa\\,\\mathbf{m}\\,\\mathbf{m}^T \\mathrm{d}\\Omega \\right) \\delta\\mathbf{d}\n$$\nThus, $\\mathbf{K}_{uu}^{\\text{vol}} = \\int_{\\Omega_{e}} \\kappa\\,\\mathbf{m}(\\mathbf{x})\\,\\mathbf{m}(\\mathbf{x})^{T}\\,\\mathrm{d}\\Omega$.\n\nThe deviatoric contribution is similarly derived from the first term:\n$$\n\\delta^2 W_{\\text{int}}^{\\text{dev}} = \\int_{\\Omega_{e}} 2\\mu\\,\\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} \\mathrm{d}\\Omega = \\delta\\mathbf{d}^T \\left( \\int_{\\Omega_e} 2\\mu\\,\\mathbf{B}_{\\text{dev}}^{T}\\mathbf{B}_{\\text{dev}}\\,\\mathrm{d}\\Omega \\right) \\delta\\mathbf{d}\n$$\nThus, $\\mathbf{K}_{uu}^{\\text{dev}} = \\int_{\\Omega_{e}} 2\\mu\\,\\mathbf{B}_{\\text{dev}}^{T}\\mathbf{B}_{\\text{dev}}\\,\\mathrm{d}\\Omega$.\n\nThe thermal load enters only the volumetric part for isotropic materials because the thermal strain tensor, $\\boldsymbol{\\varepsilon}^{th} = \\alpha\\Delta T \\mathbf{I}$, is purely spherical. Its deviatoric part is zero. The stress is generated by the elastic strain $\\boldsymbol{\\varepsilon}^e = \\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{th}$. The deviatoric stress is $\\boldsymbol{\\sigma}^{\\text{dev}} = 2\\mu(\\boldsymbol{\\varepsilon}^e)^{\\text{dev}} = 2\\mu(\\boldsymbol{\\varepsilon}^{\\text{dev}} - (\\boldsymbol{\\varepsilon}^{th})^{\\text{dev}}) = 2\\mu\\boldsymbol{\\varepsilon}^{\\text{dev}}$, which is independent of $\\Delta T$. The volumetric stress, however, depends on $\\operatorname{tr}\\boldsymbol{\\varepsilon}^e = \\operatorname{tr}\\boldsymbol{\\varepsilon} - \\operatorname{tr}\\boldsymbol{\\varepsilon}^{th} = \\operatorname{tr}\\boldsymbol{\\varepsilon} - 3\\alpha\\Delta T$.\n\nThe consistent thermal load vector $\\mathbf{F}_{\\text{th}}$ is derived from the term in $\\delta W_{\\text{int}}$ that is linear in $\\delta\\mathbf{d}$ but independent of $\\mathbf{d}$. This term is $\\int_{\\Omega_e} \\kappa(-3\\alpha\\Delta T) \\operatorname{tr}\\delta\\boldsymbol{\\varepsilon}\\,\\mathrm{d}\\Omega$.\n$$\n\\delta W_{\\text{th}} = \\int_{\\Omega_e} -3\\kappa\\alpha\\Delta T (\\mathbf{m}^T\\delta\\mathbf{d}) \\mathrm{d}\\Omega = \\delta\\mathbf{d}^T \\left( -\\int_{\\Omega_e} 3\\kappa\\alpha\\Delta T \\mathbf{m}(\\mathbf{x})\\,\\mathrm{d}\\Omega \\right)\n$$\nThe internal force vector contains a thermal component $\\mathbf{F}_{\\text{th,int}} = -\\int 3\\kappa\\alpha\\Delta T \\mathbf{m}\\,\\mathrm{d}\\Omega$. The equivalent nodal force vector applied externally is $\\mathbf{F}_{\\text{th}} = - \\mathbf{F}_{\\text{th,int}} = \\int_{\\Omega_e} 3\\kappa\\alpha\\Delta T \\mathbf{m}(\\mathbf{x}) \\mathrm{d}\\Omega$.\n\n**3. Volumetric Locking and Numerical Integration**\n\nIn the nearly incompressible limit, $\\kappa \\gg \\mu$, the volumetric stiffness $\\mathbf{K}_{uu}^{\\text{vol}}$ dominates the total stiffness $\\mathbf{K}_{uu}$. The governing discrete equation $\\mathbf{K}_{uu}\\mathbf{d} = \\mathbf{F}_{\\text{th}}$ becomes a penalty enforcement of a constraint. Dividing by $\\kappa$:\n$$\n\\left(\\frac{1}{\\kappa}\\mathbf{K}_{uu}^{\\text{dev}} + \\int_{\\Omega_e} \\mathbf{m}\\mathbf{m}^T \\mathrm{d}\\Omega \\right)\\mathbf{d} \\approx \\int_{\\Omega_e} 3\\alpha\\Delta T \\mathbf{m}\\,\\mathrm{d}\\Omega\n$$\nAs $\\kappa \\to \\infty$, this enforces $\\left(\\int \\mathbf{m}\\mathbf{m}^T \\mathrm{d}\\Omega\\right)\\mathbf{d} = \\int 3\\alpha\\Delta T\\mathbf{m}\\,\\mathrm{d}\\Omega$.\n\nUsing numerical quadrature with $N_q$ points, this becomes:\n$$\n\\left( \\sum_{i=1}^{N_q} w_i J_i \\mathbf{m}_i \\mathbf{m}_i^T \\right)\\mathbf{d} \\approx \\sum_{i=1}^{N_q} w_i J_i (3\\alpha\\Delta T)\\mathbf{m}_i\n$$\nThis is a weighted least-squares enforcement of the condition $\\mathbf{m}_i^T\\mathbf{d} = 3\\alpha\\Delta T$, which is $\\operatorname{tr}\\boldsymbol{\\varepsilon}^h(\\boldsymbol{\\xi}_i) = 3\\alpha\\Delta T$, at the $N_q$ quadrature points $\\boldsymbol{\\xi}_i$.\n\nFor a bilinear quadrilateral ($Q4$) element, the displacement field components are bilinear in coordinates, e.g., $u_x = c_1+c_2x+c_3y+c_4xy$. The strain components $\\varepsilon_{xx}=\\partial u_x/\\partial x$ and $\\varepsilon_{yy}=\\partial u_y/\\partial y$ are linear in one coordinate. The dilatation $\\operatorname{tr}\\boldsymbol{\\varepsilon}^h = \\varepsilon_{xx}+\\varepsilon_{yy}$ is therefore a general linear function of position, e.g., $A+Bx+Cy$. This field is described by $3$ independent parameters.\n\n-   **Full ($2\\times 2$) Integration**: There are $N_q=4$ Gauss points. This imposes $4$ independent constraints, $\\operatorname{tr}\\boldsymbol{\\varepsilon}^h(\\boldsymbol{\\xi}_i) = 3\\alpha\\Delta T$ for $i=1..4$, on a function space with only $3$ degrees of freedom. This over-constrains the element. The only possible solution is the trivial one where the linear part of the dilatation field is zero, forcing it to be constant. This prevents the element from representing deformation modes it should be able to, leading to an artificially stiff response known as **volumetric locking**.\n\n-   **Selective Reduced ($1\\times 1$) Integration**: There is only $N_q=1$ Gauss point at the element center $(\\boldsymbol{\\xi}_1 = \\mathbf{0})$. This imposes a single constraint: $\\operatorname{tr}\\boldsymbol{\\varepsilon}^h(\\mathbf{0}) = 3\\alpha\\Delta T$. For a linear function over a rectangular/parallelogram domain, the value at the center is equal to its average value over the domain. Thus, this single constraint enforces that the element-mean dilatation matches the thermal dilatation: $\\frac{1}{V_e}\\int_{\\Omega_e} \\operatorname{tr}\\boldsymbol{\\varepsilon}^h \\mathrm{d}\\Omega = 3\\alpha\\Delta T$. This is a single, physically reasonable constraint on the $3$-parameter dilatation field, which does not over-constrain the element and allows it to deform correctly without spurious stiffening.\n\n### Option-by-Option Analysis\n\n**A. In a bilinear quadrilateral element under plane strain with uniform $\\Delta T$ and traction-free boundaries, full $2\\times 2$ integration of $\\mathbf{K}_{uu}^{\\text{vol}}$ enforces the condition $\\operatorname{tr}\\boldsymbol{\\varepsilon}^{h} \\approx 3\\alpha\\Delta T$ at four Gauss points when $\\kappa \\gg \\mu$, which over-constrains the bilinear field and produces volumetric locking. Selective $1\\times 1$ integration enforces only the element-mean dilatation, allowing the thermally driven volumetric strain to be represented without spurious stiffening.**\n\nThis statement is a precise and accurate summary of the analysis above. Full integration leads to $4$ constraints on a $3$-DOF field, causing locking. Reduced integration imposes a single, meaningful average constraint, which resolves the issue.\n**Verdict: Correct.**\n\n**B. Locking in the regime $\\kappa \\gg \\mu$ is primarily caused by the deviatoric stiffness, so reducing the integration order of $\\mathbf{K}_{uu}^{\\text{dev}}$ (while keeping $\\mathbf{K}_{uu}^{\\text{vol}}$ fully integrated) is the appropriate remedy for thermo-mechanical problems with large thermal dilatations.**\n\nThis statement is fundamentally flawed. Locking in the limit of large bulk modulus $\\kappa$ is called volumetric locking and is caused by the volumetric stiffness term, not the deviatoric one. The remedy is to address the integration of the volumetric term $\\mathbf{K}_{uu}^{\\text{vol}}$. Reducing the integration of the deviatoric term is irrelevant to this problem and addresses different issues (like shear locking) or can introduce other pathologies (like hourglassing).\n**Verdict: Incorrect.**\n\n**C. Selective reduced integration of the volumetric term is, to leading order, equivalent to a $\\bar{\\mathbf{B}}$-type projection that replaces $\\operatorname{tr}\\boldsymbol{\\varepsilon}^{h}$ by its elementwise mean. Consequently, as $\\kappa/\\mu \\to \\infty$, the computed hydrostatic stress under uniform $\\Delta T$ approaches the correct bounded continuum value rather than diverging spuriously.**\n\nThis statement is correct. For a bilinear element, the dilatation is linear, and its integral is exactly its center-point value (the $1\\times1$ Gauss point) times the area. This makes selective reduced integration (SRI) analytically equivalent to replacing the dilatation field with its element-average, a technique known as the $\\bar{\\mathbf{B}}$ method. By satisfying the volumetric constraint only in an average sense, the element avoids spurious stiffening, allowing the computed stresses to converge to the correct physical values instead of exhibiting large, non-physical oscillations characteristic of locking.\n**Verdict: Correct.**\n\n**D. Using reduced integration only for $\\mathbf{K}_{uu}^{\\text{vol}}$ in a bilinear element under uniform $\\Delta T$ necessarily introduces hourglass modes and rank deficiency, even if $\\mathbf{K}_{uu}^{\\text{dev}}$ is fully integrated.**\n\nThis statement is false. Hourglass modes (spurious zero-energy deformation modes) appear when the stiffness matrix is rank-deficient. In a $Q4$ element, this occurs if the deviatoric part of the stiffness is also under-integrated ($1\\times 1$ quadrature). However, in selective reduced integration, the deviatoric stiffness $\\mathbf{K}_{uu}^{\\text{dev}}$ is fully integrated using a $2\\times 2$ rule. This provides the correct rank to the deviatoric part of the stiffness matrix, which in turn ensures that the total stiffness matrix $\\mathbf{K}_{uu} = \\mathbf{K}_{uu}^{\\text{dev}} + \\mathbf{K}_{uu}^{\\text{vol}}$ has the proper rank to be stable against all non-rigid-body modes. The method is specifically designed to cure locking while avoiding hourglass instability.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{AC}$$", "id": "2605832"}]}