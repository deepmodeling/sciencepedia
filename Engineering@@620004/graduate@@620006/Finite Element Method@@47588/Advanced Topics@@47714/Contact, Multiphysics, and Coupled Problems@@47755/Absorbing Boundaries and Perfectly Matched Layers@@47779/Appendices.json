{"hands_on_practices": [{"introduction": "Our first practice tackles a core question in Perfectly Matched Layer (PML) design: for a given target attenuation, what is the most efficient way to construct the layer? This exercise [@problem_id:2540286] frames this as a formal optimization problem, guiding you to discover the relationship between the PML thickness $L$ and the absorption profile $\\sigma(x)$. By solving it, you will derive a fundamental principle that underpins the design of any effective PML, demonstrating how to achieve maximum absorption with minimum computational domain overhead.", "problem": "Consider a one-dimensional scalar time-harmonic wave governed by the Helmholtz equation at angular frequency $\\omega$ and free-space wavenumber $k>0$ incident on a perfectly matched layer (PML) occupying the interval $x \\in [0,L]$. In the model used for PML design in this problem, the complex-stretched coordinate is defined by $x' = \\int_{0}^{x} s(\\xi)\\,d\\xi$, and the outgoing wave amplitude within the PML is modeled to decay as $|u(x)| \\propto \\exp\\!\\left(-\\int_{0}^{x} \\Re(k\\,s(\\xi))\\,d\\xi\\right)$, where $s(x)$ is a dimensionless stretching profile tied to a nonnegative design \"conductivity\" profile $\\sigma(x)$ by the relation\n$$\ns(x) = \\frac{\\sigma(x)}{\\omega}.\n$$\nAssume the design conductivity satisfies the pointwise bound $0 \\le \\sigma(x) \\le \\sigma_{\\max}$ almost everywhere in $[0,L]$.\n\nYou are tasked with minimizing the PML thickness $L$ while ensuring a prescribed integrated attenuation budget, namely\n$$\n\\int_{0}^{L} \\Re\\!\\big(k\\,s(x)\\big)\\,dx \\;\\ge\\; \\eta,\n$$\nwhere $\\eta>0$ is given. Treat this as a joint optimization over the thickness $L>0$ and the measurable function $\\sigma(x)$ subject to its bound.\n\n1. Formulate the constrained optimization problem to minimize $L$ subject to the integrated attenuation constraint and the pointwise bound on $\\sigma(x)$.\n2. Using only fundamental properties of monotonicity and integral inequalities, and without invoking any pre-derived PML formulas beyond the definitions above, derive the optimal PML thickness $L^{\\star}$ and characterize the corresponding optimal profile $\\sigma^{\\star}(x)$.\n3. Evaluate $L^{\\star}$ for the data $k = 20\\,\\text{m}^{-1}$, $\\eta = 12$, and a design bound $\\sigma_{\\max} = 5\\,\\omega$. Round your final numerical answer to four significant figures. Express the final thickness in meters.\n\nYour final answer must be the value of $L^{\\star}$ only. Do not include any intermediate expressions in the final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. There are no contradictions or missing information. We may proceed to the solution.\n\nThe task is to solve a constrained optimization problem. We must minimize the thickness $L$ of a perfectly matched layer (PML) subject to an integrated attenuation constraint and a pointwise bound on a design parameter.\n\nFirst, let us formalize the optimization problem as requested. The objective is to minimize the function $f(L, \\sigma) = L$, where $L > 0$. The optimization is over both the scalar $L$ and the measurable function $\\sigma(x)$ defined on the interval $[0,L]$. The constraints are:\n$1$. The integrated attenuation budget: $\\int_{0}^{L} \\Re\\!\\big(k\\,s(x)\\big)\\,dx \\ge \\eta$.\n$2$. The pointwise bound on the design conductivity: $0 \\le \\sigma(x) \\le \\sigma_{\\max}$ for almost every $x \\in [0,L]$.\n\nThe stretching profile $s(x)$ is related to the conductivity profile $\\sigma(x)$ by $s(x) = \\frac{\\sigma(x)}{\\omega}$. We are given that the free-space wavenumber $k > 0$, the angular frequency $\\omega > 0$, and the conductivity profile is non-negative, $\\sigma(x) \\ge 0$. Consequently, the stretching function $s(x)$ is real and non-negative. The real part operator $\\Re$ in the constraint is thus redundant, as $\\Re(k s(x)) = k s(x)$. The attenuation constraint simplifies to:\n$$\n\\int_{0}^{L} k\\,s(x)\\,dx \\ge \\eta\n$$\nSubstituting the definition of $s(x)$, we have:\n$$\n\\int_{0}^{L} k \\frac{\\sigma(x)}{\\omega} \\,dx \\ge \\eta\n$$\nSince $k$ and $\\omega$ are positive constants, we can write this as:\n$$\n\\frac{k}{\\omega} \\int_{0}^{L} \\sigma(x) \\,dx \\ge \\eta\n$$\nWe wish to find the minimum value of $L$ that allows this inequality to be satisfied. Let us analyze the integral term, $\\int_{0}^{L} \\sigma(x) \\,dx$. The integrand $\\sigma(x)$ is subject to the pointwise constraint $0 \\le \\sigma(x) \\le \\sigma_{\\max}$. To make the value of the integral as large as possible for a given length $L$, we must choose the integrand $\\sigma(x)$ to be as large as possible at every point $x$ in the domain of integration. This is a direct consequence of the monotonicity property of the definite integral.\n\nThe maximum possible value for $\\sigma(x)$ is $\\sigma_{\\max}$. Therefore, for any valid profile $\\sigma(x)$, we have the inequality:\n$$\n\\sigma(x) \\le \\sigma_{\\max}\n$$\nIntegrating this inequality over the interval $[0,L]$ yields:\n$$\n\\int_{0}^{L} \\sigma(x) \\,dx \\le \\int_{0}^{L} \\sigma_{\\max} \\,dx = \\sigma_{\\max} L\n$$\nNow, we can combine this result with the attenuation constraint:\n$$\n\\eta \\le \\frac{k}{\\omega} \\int_{0}^{L} \\sigma(x) \\,dx \\le \\frac{k}{\\omega} (\\sigma_{\\max} L)\n$$\nThis chain of inequalities gives us a lower bound for the PML thickness $L$:\n$$\n\\eta \\le \\frac{k\\,\\sigma_{\\max}}{\\omega} L\n$$\nSolving for $L$, we find:\n$$\nL \\ge \\frac{\\eta\\,\\omega}{k\\,\\sigma_{\\max}}\n$$\nThis inequality demonstrates that no thickness $L$ smaller than $\\frac{\\eta\\,\\omega}{k\\,\\sigma_{\\max}}$ can satisfy the constraints, regardless of the choice of the profile $\\sigma(x)$. The minimum possible value for $L$ is therefore:\n$$\nL^{\\star} = \\frac{\\eta\\,\\omega}{k\\,\\sigma_{\\max}}\n$$\nThis minimum thickness is achieved if and only if both inequalities in the chain become equalities. The first inequality, $\\eta \\le \\frac{k}{\\omega} \\int_{0}^{L} \\sigma(x) \\,dx$, becomes an equality by definition of satisfying the attenuation budget at its minimum. The second inequality, $\\frac{k}{\\omega} \\int_{0}^{L} \\sigma(x) \\,dx \\le \\frac{k\\,\\sigma_{\\max}}{\\omega} L$, becomes an equality if and only if $\\sigma(x) = \\sigma_{\\max}$ for almost every $x \\in [0,L]$.\n\nThus, the optimal conductivity profile $\\sigma^{\\star}(x)$ that allows for the minimal thickness $L^{\\star}$ is the one that is uniformly at its maximum allowed value:\n$$\n\\sigma^{\\star}(x) = \\sigma_{\\max} \\quad \\text{for a.e. } x \\in [0, L^{\\star}]\n$$\nThis choice maximizes the attenuation per unit length, thereby minimizing the total length required to achieve the target attenuation $\\eta$.\n\nFinally, we evaluate the optimal thickness $L^{\\star}$ for the given numerical data: $k = 20\\,\\text{m}^{-1}$, $\\eta = 12$, and $\\sigma_{\\max} = 5\\,\\omega$.\nSubstituting $\\sigma_{\\max} = 5\\,\\omega$ into the expression for $L^{\\star}$:\n$$\nL^{\\star} = \\frac{\\eta\\,\\omega}{k\\,\\sigma_{\\max}} = \\frac{\\eta\\,\\omega}{k\\,(5\\,\\omega)} = \\frac{\\eta}{5\\,k}\n$$\nNote that the optimal thickness is independent of the angular frequency $\\omega$. Plugging in the numerical values for $\\eta$ and $k$:\n$$\nL^{\\star} = \\frac{12}{5 \\times 20} = \\frac{12}{100} = 0.12 \\text{ m}\n$$\nThe problem requires the answer to be rounded to four significant figures. Therefore, $L^{\\star} = 0.1200$ meters.", "answer": "$$\n\\boxed{0.1200}\n$$", "id": "2540286"}, {"introduction": "To appreciate the sophistication of PMLs, it is instructive to analyze their predecessors. This exercise [@problem_id:2540259] delves into the performance of local Absorbing Boundary Conditions (ABCs), which are simpler but less effective alternatives for wave termination. You will practice the essential skill of deriving the reflection coefficient $R(\\theta)$ for a plane wave at various incidence angles, revealing the inherent angle-dependent limitations of these classical methods and motivating the development of the more robust PML.", "problem": "Consider the two-dimensional time-harmonic Helmholtz equation for a homogeneous medium,\n$$\\Delta u + k^{2} u = 0,$$\nposed in the half-space $\\{x \\le 0\\}$ with a planar artificial boundary at $x=0$. A plane wave of wavenumber $k>0$ is incident from the interior at angle $\\theta \\in (0,\\pi/2)$ (measured from the outward normal), so that the incident field is\n$$u_{\\mathrm{inc}}(x,y) = \\exp\\!\\big(i (k \\cos\\theta) x + i (k \\sin\\theta) y\\big).$$\nDenote the tangential coordinate on the boundary by $y$. The total field in the interior is modeled as the sum of the incident wave and a specularly reflected wave,\n$$u(x,y) = \\exp\\!\\big(i (k \\cos\\theta) x + i (k \\sin\\theta) y\\big) + R(\\theta)\\,\\exp\\!\\big(-i (k \\cos\\theta) x + i (k \\sin\\theta) y\\big),$$\nwhere $R(\\theta)$ is the complex reflection coefficient induced by the boundary condition at $x=0$. The exact nonreflecting boundary would produce $R(\\theta)=0$; in practice one uses local absorbing boundary conditions (ABCs). Two standard local ABCs on $x=0$ are:\n- First-order (impedance) ABC: $\\partial_{x} u = i k\\, u$.\n- Second-order ABC: $\\partial_{x} u = i k\\, u - \\frac{1}{2 i k}\\,\\partial_{y}^{2} u$.\n\nStarting only from the above Helmholtz model and these boundary operators, do the following:\n1. Derive a closed-form expression for $R(\\theta)$ induced by imposing $\\partial_{x} u = i k\\, Q(\\partial_{y})\\,u$ on $x=0$, where $Q(\\partial_{y})$ is the boundary operator symbol. Then, by evaluating $Q$ on the plane-wave factor $\\exp(i k \\sin\\theta\\, y)$, show that for the first-order ABC, $Q_{1}(\\theta)=1$, and for the second-order ABC, $Q_{2}(\\theta)=1 - \\frac{1}{2}\\sin^{2}\\theta$.\n2. Using your expression for $R(\\theta)$, analyze the phase of the reflected wave for the set of incidence angles $\\Theta=\\{\\pi/6,\\ \\pi/4,\\ \\pi/3\\}$ and determine the common value of the phase $\\arg(R(\\theta))$ (if it is independent of $\\theta$ and the ABC order, state and justify this).\n3. Express the final phase value in radians.\n\nYour final answer must be a single number or a single closed-form analytic expression. Express the phase in radians. No rounding is required.", "solution": "The problem presented is a standard exercise in the analysis of absorbing boundary conditions for wave propagation phenomena. It is scientifically grounded, well-posed, and contains all necessary information for a unique solution. We shall proceed with the derivation.\n\nThe governing equation is the two-dimensional time-harmonic Helmholtz equation for a homogeneous medium, posed in the half-space $\\{x \\le 0\\}$:\n$$ \\Delta u + k^{2} u = 0 $$\nwhere $k > 0$ is the wavenumber. The total field $u(x,y)$ in the domain is given as a superposition of an incident and a reflected plane wave:\n$$ u(x,y) = \\exp(i (k \\cos\\theta) x + i (k \\sin\\theta) y) + R(\\theta)\\,\\exp(-i (k \\cos\\theta) x + i (k \\sin\\theta) y) $$\nwhere $R(\\theta)$ is the complex reflection coefficient and $\\theta \\in (0, \\pi/2)$ is the angle of incidence. For brevity, we define the wavevector components $k_x = k \\cos\\theta$ and $k_y = k \\sin\\theta$. The field can be written as:\n$$ u(x,y) = \\exp(i k_y y) \\left( \\exp(i k_x x) + R(\\theta) \\exp(-i k_x x) \\right) $$\nThe analysis requires evaluating the field and its derivatives on the artificial boundary at $x=0$. At $x=0$, the field is:\n$$ u(0,y) = (1 + R(\\theta)) \\exp(i k_y y) $$\nThe partial derivative of the field with respect to $x$ is:\n$$ \\partial_x u(x,y) = \\exp(i k_y y) \\left( i k_x \\exp(i k_x x) - i k_x R(\\theta) \\exp(-i k_x x) \\right) $$\nAt the boundary $x=0$, this becomes:\n$$ \\partial_x u(0,y) = i k_x (1 - R(\\theta)) \\exp(i k_y y) $$\nThe general form of the absorbing boundary condition (ABC) at $x=0$ is given as:\n$$ \\partial_x u = i k\\, Q(\\partial_y)\\,u $$\nThe operator $Q(\\partial_y)$ acts on the tangential part of the wave, $\\exp(i k_y y)$. The action of the tangential derivative operator $\\partial_y$ on this plane wave is equivalent to multiplication by the complex number $i k_y = i k \\sin\\theta$. Consequently, the operator $Q(\\partial_y)$ becomes a multiplicative symbol, denoted $Q(\\theta)$, when applied to the plane wave.\n\nFirst, we determine the symbols $Q_1(\\theta)$ and $Q_2(\\theta)$ for the two given ABCs.\nFor the first-order ABC, $\\partial_{x} u = i k\\, u$. Comparing this to the general form $\\partial_{x} u = i k\\, Q_1(\\partial_{y})\\,u$, we see that $Q_1(\\partial_{y})$ is the identity operator, $Q_1(\\partial_{y}) = 1$. The corresponding symbol is therefore a constant, $Q_1(\\theta)=1$, independent of the angle $\\theta$. This confirms the first part of the problem statement.\nFor the second-order ABC, $\\partial_{x} u = i k\\, u - \\frac{1}{2 i k}\\,\\partial_{y}^{2} u$. We can factor this as:\n$$ \\partial_x u = i k \\left( 1 - \\frac{1}{2 (i k) (i k)} \\partial_y^2 \\right) u = i k \\left( 1 + \\frac{1}{2 k^2} \\partial_y^2 \\right) u $$\nComparing this to the general form $\\partial_x u = i k\\, Q_2(\\partial_y)\\,u$, we identify the operator $Q_2(\\partial_y) = 1 + \\frac{1}{2 k^2} \\partial_y^2$. To find its symbol $Q_2(\\theta)$, we replace the operator $\\partial_y^2$ with its action on the plane wave factor $\\exp(i k_y y)$, which is multiplication by $(i k_y)^2 = (i k \\sin\\theta)^2 = -k^2 \\sin^2\\theta$. This yields:\n$$ Q_2(\\theta) = 1 + \\frac{1}{2 k^2} (-k^2 \\sin^2\\theta) = 1 - \\frac{1}{2} \\sin^2\\theta $$\nThis confirms the second part of the problem statement.\n\nNow, we derive the general expression for the reflection coefficient $R(\\theta)$. We substitute the expressions for $u(0,y)$ and $\\partial_x u(0,y)$ into the general ABC, evaluated at the symbol level:\n$$ i k_x (1 - R(\\theta)) \\exp(i k_y y) = i k Q(\\theta) (1 + R(\\theta)) \\exp(i k_y y) $$\nSince $k>0$ and $\\exp(i k_y y)$ is non-zero, we can cancel the terms $i$ and $\\exp(i k_y y)$:\n$$ k_x (1 - R(\\theta)) = k Q(\\theta) (1 + R(\\theta)) $$\nSubstituting $k_x = k \\cos\\theta$ and dividing by $k$:\n$$ \\cos\\theta (1 - R(\\theta)) = Q(\\theta) (1 + R(\\theta)) $$\nWe rearrange this algebraic equation to solve for $R(\\theta)$:\n$$ \\cos\\theta - R(\\theta) \\cos\\theta = Q(\\theta) + R(\\theta) Q(\\theta) $$\n$$ \\cos\\theta - Q(\\theta) = R(\\theta) (\\cos\\theta + Q(\\theta)) $$\nThis yields the closed-form expression for the reflection coefficient:\n$$ R(\\theta) = \\frac{\\cos\\theta - Q(\\theta)}{\\cos\\theta + Q(\\theta)} $$\nNext, we analyze the phase of $R(\\theta)$ for the two ABCs. The domain for the incidence angle is $\\theta \\in (0, \\pi/2)$, which includes the specified set $\\Theta=\\{\\pi/6,\\ \\pi/4,\\ \\pi/3\\}$. The phase of a complex number $z$ is its argument, $\\arg(z)$.\nFor the first-order ABC, $Q_1(\\theta) = 1$. The reflection coefficient is:\n$$ R_1(\\theta) = \\frac{\\cos\\theta - 1}{\\cos\\theta + 1} $$\nFor $\\theta \\in (0, \\pi/2)$, we have $0 < \\cos\\theta < 1$. Consequently, the numerator $\\cos\\theta - 1$ is a negative real number, and the denominator $\\cos\\theta + 1$ is a positive real number. The ratio $R_1(\\theta)$ is therefore a negative real number. The argument of any negative real number is $\\pi$. Thus, $\\arg(R_1(\\theta)) = \\pi$ for all $\\theta \\in (0, \\pi/2)$.\n\nFor the second-order ABC, $Q_2(\\theta) = 1 - \\frac{1}{2} \\sin^2\\theta$. The reflection coefficient is:\n$$ R_2(\\theta) = \\frac{\\cos\\theta - \\left(1 - \\frac{1}{2} \\sin^2\\theta\\right)}{\\cos\\theta + \\left(1 - \\frac{1}{2} \\sin^2\\theta\\right)} $$\nFor $\\theta \\in (0, \\pi/2)$, both $\\cos\\theta$ and $Q_2(\\theta)$ are real-valued. The denominator is $\\cos\\theta + 1 - \\frac{1}{2} \\sin^2\\theta$. Since $\\cos\\theta > 0$ and $1 - \\frac{1}{2} \\sin^2\\theta > 1 - \\frac{1}{2} = \\frac{1}{2}$, the denominator is strictly positive.\nWe analyze the numerator using the identity $\\sin^2\\theta = 1 - \\cos^2\\theta$:\n$$ \\cos\\theta - 1 + \\frac{1}{2} \\sin^2\\theta = \\cos\\theta - 1 + \\frac{1}{2}(1 - \\cos^2\\theta) = -\\frac{1}{2}\\cos^2\\theta + \\cos\\theta - \\frac{1}{2} = -\\frac{1}{2}(\\cos^2\\theta - 2\\cos\\theta + 1) = -\\frac{1}{2}(\\cos\\theta - 1)^2 $$\nSince $\\theta \\in (0, \\pi/2)$, $\\cos\\theta \\neq 1$, so $(\\cos\\theta - 1)^2 > 0$. The numerator is therefore a strictly negative real number.\nAs the numerator is negative real and the denominator is positive real, the ratio $R_2(\\theta)$ is a negative real number. Its argument is therefore $\\arg(R_2(\\theta)) = \\pi$.\n\nIn both cases, for any angle of incidence $\\theta \\in (0, \\pi/2)$ (including all angles in the set $\\Theta$), the reflection coefficient $R(\\theta)$ is a negative real number. This is a direct consequence of the fact that the symbols $Q(\\theta)$ for these specific ABCs are real-valued, and the numerator $\\cos\\theta - Q(\\theta)$ is always negative while the denominator $\\cos\\theta + Q(\\theta)$ is always positive within the specified range of $\\theta$.\nTherefore, the phase of the reflected wave is independent of both the angle of incidence $\\theta$ and the order of the ABC (for the two cases considered). The common value of the phase is $\\pi$. Expressed in radians, this is the final answer.", "answer": "$$\\boxed{\\pi}$$", "id": "2540259"}, {"introduction": "An ideal continuous PML is perfectly non-reflecting, but its implementation within a finite element framework introduces a new challenge: the discretization itself can generate spurious reflections. This advanced practice [@problem_id:2540247] addresses this critical issue by modeling the error introduced by the finite element mesh. You will explore how to formulate and minimize this discretization-induced reflection, leading to a powerful co-design principle that links the optimal absorption grading $\\sigma(x)$ directly to the local mesh size $h(x)$ for achieving maximal accuracy.", "problem": "Consider a one-dimensional time-harmonic scalar wave governed by the Helmholtz equation $u''(x) + k^{2} u(x) = 0$ in a homogeneous medium of wavenumber $k > 0$. The physical domain occupies $x < 0$ and is terminated at $x = 0$ by a Perfectly Matched Layer (PML) of thickness $L > 0$, occupying $0 \\leq x \\leq L$. The PML is implemented via a complex coordinate stretch with stretching factor $s(x) = 1 + i\\,\\sigma(x)/\\omega$, where $\\sigma(x) \\geq 0$ is the PML absorption profile and $\\omega > 0$ is the angular frequency. For a right-going plane wave normally incident on the PML, the local amplitude decays at the rate $\\alpha(x) = k\\,\\mathrm{Im}\\,s(x) = k\\,\\sigma(x)/\\omega$, and the corresponding local attenuation length is $\\ell(x) = 1/\\alpha(x)$.\n\nThe PML is discretized using the Finite Element Method (FEM) with continuous, piecewise-linear basis functions on a mesh $\\{x_{j}\\}_{j=0}^{N}$ with $x_{0} = 0$, $x_{N} = L$, and element sizes $h_{j} = x_{j+1} - x_{j}$. Assume that $\\alpha(x)$ and $h(x)$ vary slowly enough for a local Wentzel–Kramers–Brillouin (WKB) approximation to be meaningful, and that the truncation at $x = L$ is reflection-free. Define the total PML attenuation budget\n$$\nA_{0} \\;=\\; \\int_{0}^{L} \\alpha(x)\\,dx \\;=\\; \\int_{0}^{L} \\frac{dx}{\\ell(x)} \\,,\n$$\nwhich is fixed by accuracy considerations independent of discretization.\n\n1) Starting from first principles of consistency for linear FEM in one dimension, analyze a semi-infinite uniform PML with constant $\\alpha$ and uniform mesh size $h$, and show that the discrete nodal log-derivative computed by the centered difference\n$$\n\\delta \\;=\\; \\frac{u(x+h) - u(x-h)}{2h\\,u(x)}\n$$\napproximates the exact log-derivative $u'(x)/u(x) = -\\alpha$ with a relative error of order $(\\alpha h)^2$. Use this to model the discrete impedance mismatch at $x=0$ and derive the leading-order reflection amplitude for the uniform case in terms of the non-dimensional ratio $h/\\ell$.\n\n2) Extend the result heuristically to a graded PML with variable $\\ell(x)$ and $h(x)$ by superposition of locally generated backscatter weighted by the decay from $x=0$, and argue that a worst-case bound (attained when all phases align constructively) has the form\n$$\nR_{\\mathrm{worst}} \\;\\approx\\; C \\sum_{j=0}^{N-1} \\left(\\frac{h_{j}}{\\ell_{j}}\\right)^{2} \\exp\\!\\left(-2 \\int_{0}^{x_{j}} \\frac{ds}{\\ell(s)}\\right),\n$$\nfor some constant $C$ determined by the discretization of the log-derivative at leading order, where $\\ell_{j}$ denotes the value of $\\ell$ on element $j$ and $x_{j}$ its left endpoint.\n\n3) By ignoring the exponential factors to obtain a worst-case upper bound, formulate the optimization problem of minimizing $R_{\\mathrm{worst}}$ over choices of positive $\\{h_{j}\\}_{j=0}^{N-1}$ and $\\{\\ell_{j}\\}_{j=0}^{N-1}$ subject to the constraints\n$$\n\\sum_{j=0}^{N-1} \\frac{h_{j}}{\\ell_{j}} \\;=\\; A_{0}, \n\\qquad\n\\sum_{j=0}^{N-1} h_{j} \\;=\\; L,\n$$\nand a fixed number of elements $N$. Prove that the minimizer equidistributes the element-wise ratios $h_{j}/\\ell_{j}$, and express the minimum attainable $R_{\\mathrm{worst}}$ in terms of $A_{0}$ and $N$ only.\n\n4) Use the identity $\\ell(x) = \\omega/(k\\,\\sigma(x))$ to express the optimal absorption grading $\\sigma(x)$ in terms of the local element size $h(x)$ for the minimizing design obtained in part 3. Your final answer should be delivered as a row vector with three entries: the minimized worst-case reflection amplitude, the optimal constant ratio $r$ defined by $r = h(x)/\\ell(x)$, and the absorption profile $\\sigma(x)$ as a function of $h(x)$. No numerical approximations are required, and no units should be included in the final boxed answer.", "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded, well-posed, objective, and contains sufficient information for a rigorous solution. We will proceed with the derivation as requested.\n\nThe problem requires a multi-part analysis of discretization-induced reflection in a Perfectly Matched Layer (PML) for the one-dimensional Helmholtz equation, culminating in an optimization of the PML parameters.\n\nPart 1: Analysis of a Uniform PML\n\nWe are asked to analyze the error of a discrete approximation to the logarithmic derivative and use it to model the reflection from a uniform PML. The governing equation is $u''(x) + k^2 u(x) = 0$. In the PML, a complex coordinate stretching $x \\to \\tilde{x} = \\int_0^x s(t)dt$ with $s(x) = 1 + i\\sigma(x)/\\omega$ is used. For a right-going wave, the solution in the PML is of the form $u(x) \\propto \\exp(ik\\tilde{x})$. For a uniform PML, $s(x)=s$ is constant, and the solution is $u(x) = \\exp(iksx)$. The decay rate is $\\alpha = k\\,\\mathrm{Im}(s)$, so $s=1+i\\alpha/k$. The solution for the decaying part of the wave can be written as $u(x) \\sim \\exp(-\\alpha x)$. The problem asks to analyze the log-derivative of this purely decaying wave.\n\nThe exact log-derivative is $\\gamma_{\\text{exact}} = \\frac{u'(x)}{u(x)} = \\frac{-\\alpha \\exp(-\\alpha x)}{\\exp(-\\alpha x)} = -\\alpha$.\n\nThe problem provides a centered difference approximation for the nodal log-derivative:\n$$\n\\delta = \\frac{u(x+h) - u(x-h)}{2h\\,u(x)}\n$$\nSubstituting $u(x) = \\exp(-\\alpha x)$, we find the discrete log-derivative:\n$$\n\\delta = \\frac{\\exp(-\\alpha(x+h)) - \\exp(-\\alpha(x-h))}{2h \\exp(-\\alpha x)} = \\frac{\\exp(-\\alpha h) - \\exp(\\alpha h)}{2h} = -\\frac{\\sinh(\\alpha h)}{h}\n$$\nTo find the relative error, we expand $\\delta$ for small $\\alpha h$:\n$$\n\\delta = -\\frac{1}{h} \\left( (\\alpha h) + \\frac{(\\alpha h)^3}{3!} + \\mathcal{O}((\\alpha h)^5) \\right) = -\\alpha \\left( 1 + \\frac{(\\alpha h)^2}{6} + \\mathcal{O}((\\alpha h)^4) \\right)\n$$\nThe relative error in approximating $\\gamma_{\\text{exact}} = -\\alpha$ is:\n$$\n\\text{Error}_{\\text{rel}} = \\frac{\\delta - \\gamma_{\\text{exact}}}{\\gamma_{\\text{exact}}} = \\frac{-\\alpha(1 + (\\alpha h)^2/6) - (-\\alpha)}{-\\alpha} = \\frac{-\\alpha (\\alpha h)^2/6}{-\\alpha} = \\frac{(\\alpha h)^2}{6}\n$$\nThe leading-order relative error is indeed of order $(\\alpha h)^2$.\n\nNext, we model the discrete impedance mismatch. The numerical error introduces an effective impedance for the discretized medium, $Z_{\\text{num}}$, that is different from the impedance of the continuous medium, $Z_{\\text{cont}}$. This mismatch generates reflection. The impedance $Z$ is related to the log-derivative $\\gamma = u'/u$. A common convention is $Z \\propto 1/\\gamma$. The reflection coefficient $R$ for a small impedance mismatch is $R \\approx \\frac{\\Delta Z}{2Z}$. Given $Z \\propto 1/\\gamma$, a small change $\\Delta \\gamma$ results in $\\frac{\\Delta Z}{Z} \\approx -\\frac{\\Delta \\gamma}{\\gamma}$.\nThe reflection amplitude is thus $|R| \\approx \\frac{1}{2} \\left|\\frac{\\Delta \\gamma}{\\gamma}\\right|$.\nHere, the 'change' in the log-derivative is the error introduced by discretization, $\\Delta\\gamma = \\delta - \\gamma_{\\text{exact}} \\approx -\\alpha \\frac{(\\alpha h)^2}{6}$.\nThe reflection amplitude is then:\n$$\n|R| \\approx \\frac{1}{2} \\left| \\frac{-\\alpha (\\alpha h)^2 / 6}{-\\alpha} \\right| = \\frac{(\\alpha h)^2}{12}\n$$\nUsing the definition of the attenuation length $\\ell = 1/\\alpha$, the leading-order reflection amplitude is $\\frac{1}{12}\\left(\\frac{h}{\\ell}\\right)^2$. This suggests that the constant $C$ in Part 2 is $C=1/12$.\n\nPart 2: Graded PML and Worst-Case Reflection\n\nWe extend this result heuristically to a graded PML where mesh size $h(x)$ and attenuation length $\\ell(x)$ vary. The reflection generated locally by element $j$ at position $x_j$ has an amplitude proportional to $(h_j/\\ell_j)^2$, where $h_j$ and $\\ell_j$ are the local element size and attenuation length, respectively. Based on Part 1, this local reflection amplitude is $dR_j \\approx \\frac{1}{12}(h_j/\\ell_j)^2$.\n\nThis locally generated backward-propagating wave must travel from its point of origin $x_j$ back to the interface $x=0$. During this travel, its amplitude is attenuated. The round-trip attenuation factor for a wave traveling from $x=0$ to $x_j$ and back is $\\exp\\left(-2\\int_0^{x_j} \\alpha(s)\\,ds\\right) = \\exp\\left(-2\\int_0^{x_j} \\frac{ds}{\\ell(s)}\\right)$.\n\nThe total reflection at $x=0$ is the superposition of reflections from all elements. A worst-case bound is obtained by summing the magnitudes of these contributions, which corresponds to constructive interference of all back-scattered waves.\n$$\nR_{\\mathrm{worst}} \\approx \\sum_{j=0}^{N-1} |dR_j| \\times (\\text{attenuation factor}) = \\sum_{j=0}^{N-1} \\frac{1}{12} \\left(\\frac{h_{j}}{\\ell_{j}}\\right)^{2} \\exp\\!\\left(-2 \\int_{0}^{x_{j}} \\frac{ds}{\\ell(s)}\\right)\n$$\nThis matches the form given in the problem, with $C=1/12$.\n\nPart 3: Optimization Problem\n\nThe problem asks to minimize a worst-case upper bound of $R_{\\mathrm{worst}}$ by ignoring the exponential factors. The objective function to minimize is a simplified reflection measure, $R_{\\text{up}}$:\n$$\nR_{\\text{up}}(\\{h_j\\}, \\{\\ell_j\\}) = \\frac{1}{12} \\sum_{j=0}^{N-1} \\left(\\frac{h_{j}}{\\ell_{j}}\\right)^{2}\n$$\nThis minimization is subject to two constraints on the $N$ elements:\n1. Total attenuation budget: $\\sum_{j=0}^{N-1} \\frac{h_{j}}{\\ell_{j}} = A_{0}$\n2. Total PML thickness: $\\sum_{j=0}^{N-1} h_{j} = L$\n\nLet $r_j = h_j/\\ell_j$. The optimization problem for the ratios $\\{r_j\\}$ is to minimize $\\sum_{j=0}^{N-1} r_j^2$ subject to the constraint $\\sum_{j=0}^{N-1} r_j = A_0$. The second constraint, $\\sum h_j=L$, does not constrain the choice of $\\{r_j\\}$ directly.\n\nWe can solve this using the Cauchy-Schwarz inequality. For two vectors $\\vec{a}=(1, 1, \\dots, 1)$ and $\\vec{b}=(r_0, r_1, \\dots, r_{N-1})$ in $\\mathbb{R}^N$:\n$$\n(\\vec{a} \\cdot \\vec{b})^2 \\le \\|\\vec{a}\\|^2 \\|\\vec{b}\\|^2\n$$\n$$\n\\left(\\sum_{j=0}^{N-1} 1 \\cdot r_j\\right)^2 \\le \\left(\\sum_{j=0}^{N-1} 1^2\\right) \\left(\\sum_{j=0}^{N-1} r_j^2\\right)\n$$\nSubstituting the constraint $\\sum r_j = A_0$:\n$$\nA_0^2 \\le N \\left(\\sum_{j=0}^{N-1} r_j^2\\right)\n$$\nThis gives a lower bound on the objective function: $\\sum r_j^2 \\ge \\frac{A_0^2}{N}$.\nEquality, and thus the minimum, is achieved when the vectors are collinear, i.e., $r_j = c \\cdot 1$ for some constant $c$. This proves that the minimizer equidistributes the element-wise ratios: $r_j = r$ for all $j=0, \\dots, N-1$.\n\nUsing this result in the first constraint:\n$$\n\\sum_{j=0}^{N-1} r = N r = A_0 \\implies r = \\frac{A_0}{N}\n$$\nThe minimum value of the sum is $\\sum r_j^2 = \\sum (A_0/N)^2 = N (A_0/N)^2 = A_0^2/N$.\nTherefore, the minimum attainable value for the simplified reflection measure is:\n$$\nR_{\\text{up, min}} = \\frac{1}{12} \\frac{A_0^2}{N}\n$$\n\nPart 4: Optimal Absorption Grading\n\nThe final step is to find the optimal absorption profile $\\sigma(x)$ for the minimizing design. The optimal design requires the ratio $h(x)/\\ell(x)$ to be constant everywhere in the PML. Taking a continuous limit of the discrete result from Part 3:\n$$\nr(x) = \\frac{h(x)}{\\ell(x)} = \\frac{A_0}{N}\n$$\nHere, $h(x)$ is the local element size. We are given the relation $\\ell(x) = \\omega/(k\\,\\sigma(x))$. Substituting this into the optimality condition:\n$$\n\\frac{h(x)}{\\omega / (k\\,\\sigma(x))} = \\frac{A_0}{N}\n$$\n$$\n\\frac{h(x) k \\sigma(x)}{\\omega} = \\frac{A_0}{N}\n$$\nSolving for $\\sigma(x)$ gives the optimal absorption profile as a function of the local mesh spacing $h(x)$:\n$$\n\\sigma(x) = \\frac{A_0 \\omega}{N k h(x)}\n$$\nThis completes the derivation. We gather the three required results for the final answer.\n\n1.  Minimized worst-case reflection amplitude: $\\frac{A_0^2}{12N}$\n2.  Optimal constant ratio $r = h(x)/\\ell(x)$: $\\frac{A_0}{N}$\n3.  Absorption profile $\\sigma(x)$: $\\frac{A_0 \\omega}{N k h(x)}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{A_0^2}{12N} & \\frac{A_0}{N} & \\frac{A_0 \\omega}{N k h(x)}\n\\end{pmatrix}\n}\n$$", "id": "2540247"}]}