{"hands_on_practices": [{"introduction": "Before comparing solution strategies, it is essential to understand how coupling can fundamentally alter the physics of a system. When a structure accelerates through a fluid, it must displace the fluid, which in turn exerts an inertial force back on the structure. This exercise guides you through a first-principles derivation of this 'added mass' effect, starting from the basic conservation laws for a simple fluid-structure interaction (FSI) model [@problem_id:2598435]. Understanding how to quantify this added mass is a critical first step in analyzing the stability and performance of partitioned FSI algorithms.", "problem": "Consider a one-dimensional fluid-structure interaction model in which a rigid, frictionless piston at position $x=0$ is attached to a linear elastic structure and pushes an inviscid fluid that fills a straight, rigid tube of constant cross-sectional area $A$ over the interval $x \\in [0,L]$. The far end at $x=L$ opens into a large reservoir maintained at zero gauge pressure. The fluid has uniform density $\\rho$, and the motion is confined to the axial direction. Assume small motions, negligible gravity, and that the fluid behaves as incompressible over the time scales of interest. The piston has displacement $u_{s}(t)$ and, by continuity, the fluid has axial velocity field $v(x,t)$. The fluid exerts a net force on the piston equal to the pressure at $x=0$ times the area $A$. \n\nWithin the finite element method (FEM) context for fluid-structure interaction (FSI), it is known that the so-called added-mass effect controls the stability of staggered (partitioned) versus monolithic (fully coupled) solution strategies. Starting from the fundamental balance laws for the fluid (conservation of mass and linear momentum) and Newtonâ€™s second law for the piston, derive the effective added mass $m_{a}$ attributed to the fluid that augments the structural inertia in a monolithic coupling. Express $m_{a}$ purely in terms of the fluid density $\\rho$, the tube length $L$, and the cross-sectional area $A$. \n\nYour derivation must start from the governing one-dimensional balance equations and conclude with a closed-form expression for $m_{a}$ obtained by eliminating the fluid field in favor of the piston acceleration through the fluid pressure distribution. Provide the final expression symbolically. Do not substitute numerical values. Do not report intermediate equations as your final result. The final answer must be a single analytic expression.", "solution": "The problem as stated is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Model:** A one-dimensional fluid-structure interaction (FSI) system.\n- **Geometry:** A straight, rigid tube of constant cross-sectional area $A$ and length $L$, extending over the domain $x \\in [0,L]$.\n- **Structure:** A rigid, frictionless piston located at $x=0$ with axial displacement $u_s(t)$. The piston is attached to a linear elastic structure.\n- **Fluid:** An inviscid, incompressible fluid with uniform density $\\rho$ fills the tube.\n- **Boundary Conditions:**\n    1.  At the piston face ($x=0$), the fluid velocity matches the piston velocity.\n    2.  At the tube outlet ($x=L$), the fluid opens into a large reservoir maintained at zero gauge pressure, i.e., $p(L,t) = 0$.\n- **Assumptions:**\n    1.  Motion is small and confined to the axial direction. The kinematic boundary condition at the piston can be applied at $x=0$.\n    2.  Gravity is negligible.\n- **Interaction Force:** The net force exerted by the fluid on the piston is equal to the pressure at the face, $p(0,t)$, times the area $A$.\n- **Objective:** Derive the effective added mass, $m_a$, attributed to the fluid, expressed in terms of $\\rho$, $L$, and $A$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it is based on the fundamental principles of continuum mechanics: conservation of mass and momentum for a fluid, and Newton's second law for a solid. The model presented is a standard, simplified representation used to study the fundamentals of FSI, particularly the added-mass effect. The problem is well-posed, providing all necessary physical laws, boundary conditions, and geometric parameters to arrive at a unique solution. The language is objective and precise. The problem is directly relevant to the stated topic of solution strategies in computational FSI. It does not exhibit any characteristics of an invalid problem such as scientific unsoundness, missing information, or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete derivation will be provided.\n\nThe derivation begins with the governing equations for the fluid.\n\nFirst, we consider the conservation of mass. For a one-dimensional, incompressible fluid flowing in a tube of constant cross-sectional area $A$, the continuity equation is:\n$$ \\frac{\\partial v}{\\partial x} = 0 $$\nwhere $v(x,t)$ is the axial fluid velocity. This equation implies that the velocity $v$ is not a function of the spatial coordinate $x$ and can only depend on time $t$. We may write $v(x,t) = v(t)$.\n\nNext, we apply the kinematic boundary condition at the interface between the piston and the fluid. For small motions, this condition is applied at the mean piston position, $x=0$. The fluid velocity at this point must match the piston's velocity, which is the time derivative of its displacement, $\\dot{u}_s(t)$.\n$$ v(0,t) = \\frac{d u_s}{d t} = \\dot{u}_s(t) $$\nCombining this with the result from the continuity equation, we conclude that the velocity of the entire fluid column is uniform in space and equal to the piston's velocity:\n$$ v(x,t) = \\dot{u}_s(t) \\quad \\text{for all } x \\in [0,L] $$\n\nNow, we consider the conservation of linear momentum. For an inviscid fluid with negligible body forces (gravity is ignored), the one-dimensional Euler momentum equation is:\n$$ \\rho \\left( \\frac{\\partial v}{\\partial t} + v \\frac{\\partial v}{\\partial x} \\right) = - \\frac{\\partial p}{\\partial x} $$\nwhere $p(x,t)$ is the fluid pressure. From the continuity equation, we know $\\frac{\\partial v}{\\partial x} = 0$. The momentum equation simplifies to:\n$$ \\rho \\frac{\\partial v}{\\partial t} = - \\frac{\\partial p}{\\partial x} $$\nThe time derivative of the fluid velocity is the fluid acceleration, which is equal to the piston's acceleration:\n$$ \\frac{\\partial v}{\\partial t} = \\frac{d}{dt} \\left( \\dot{u}_s(t) \\right) = \\ddot{u}_s(t) $$\nSubstituting this into the simplified Euler equation gives the relationship between the pressure gradient and the piston's acceleration:\n$$ \\rho \\ddot{u}_s(t) = - \\frac{\\partial p}{\\partial x} $$\nSince the left-hand side is a function of time only, we can integrate this equation with respect to the spatial coordinate $x$ to find the pressure distribution $p(x,t)$:\n$$ p(x,t) = \\int - \\rho \\ddot{u}_s(t) \\, dx = - \\rho \\ddot{u}_s(t) x + C(t) $$\nwhere $C(t)$ is an integration constant that may depend on time. We identify $C(t)$ by evaluating the expression at $x=0$, which gives $C(t) = p(0,t)$. Thus, the pressure distribution is:\n$$ p(x,t) = p(0,t) - \\rho x \\ddot{u}_s(t) $$\nThis shows a linear pressure drop along the tube length, driven by the fluid's inertia.\n\nTo determine the pressure at the piston face, $p(0,t)$, we apply the pressure boundary condition at the tube outlet, $x=L$. The problem states that the gauge pressure here is zero, so $p(L,t) = 0$. Substituting this into our pressure distribution equation:\n$$ 0 = p(L,t) = p(0,t) - \\rho L \\ddot{u}_s(t) $$\nSolving for $p(0,t)$, we find:\n$$ p(0,t) = \\rho L \\ddot{u}_s(t) $$\nThe force exerted by the fluid on the piston, $F_{fluid}$, is the pressure at the piston face multiplied by the area $A$. This force acts in the negative $x$-direction, opposing the acceleration.\n$$ F_{fluid}(t) = -p(0,t) A $$\nSubstituting our expression for $p(0,t)$:\n$$ F_{fluid}(t) = - \\left( \\rho L \\ddot{u}_s(t) \\right) A = - (\\rho A L) \\ddot{u}_s(t) $$\nThe equation of motion for the piston (the \"structure\" with mass $m_s$) is of the form $m_s \\ddot{u}_s(t) + \\dots = F_{fluid}(t)$. In a monolithic formulation, the fluid force is treated as an inertial term coupled to the structure. Substituting the expression for $F_{fluid}(t)$:\n$$ m_s \\ddot{u}_s(t) + \\dots = - (\\rho A L) \\ddot{u}_s(t) $$\nMoving the fluid force term to the left-hand side yields:\n$$ m_s \\ddot{u}_s(t) + (\\rho A L) \\ddot{u}_s(t) + \\dots = 0 $$\n$$ \\left(m_s + \\rho A L\\right) \\ddot{u}_s(t) + \\dots = 0 $$\nThe term multiplying the structural acceleration, $\\ddot{u}_s(t)$, represents the total effective inertia of the coupled system. The term $\\rho A L$ is the contribution from the fluid, which augments the structural mass $m_s$. This is, by definition, the added mass $m_a$.\nThe quantity $\\rho A L$ is the total mass of the fluid in the tube. This result is physically correct: under the given assumptions of an incompressible fluid in a rigid tube, the entire fluid column must accelerate as a single rigid body with the piston.\n\nTherefore, the effective added mass is the total mass of the fluid.", "answer": "$$\n\\boxed{\\rho A L}\n$$", "id": "2598435"}, {"introduction": "Staggered schemes are appealing for their implementation simplicity, but this simplicity can come at a great cost. In tightly coupled multiphysics problems like poroelasticity, a naive staggered approach can lead to a catastrophic numerical failure known as 'locking.' This practice problem presents a classic example where a staggered scheme fails to capture the correct physical deformation by violating the underlying compatibility constraints between displacement and pressure fields [@problem_id:2598463]. By contrasting this with the correct monolithic solution, you will gain a clear, practical understanding of why robust, monolithic coupling is often indispensable.", "problem": "Consider one-dimensional linear poroelasticity (Biot theory) on the interval $[0,1]$ with cross-sectional area $A=1$. The unknowns are the solid displacement $u(x,t)$ and the pore pressure $p(x,t)$. The quasi-static balance of linear momentum and the fluid mass conservation law are, respectively,\n- balance of momentum: $\\nabla \\cdot \\sigma' - \\alpha \\nabla p = 0$ with $\\sigma' = E \\nabla u$ in one dimension,\n- fluid mass conservation: $s\\,\\dot{p} + \\alpha\\,\\nabla \\cdot \\dot{u} = w$, with zero Darcy flux (impermeable) so that no diffusion term appears.\n\nHere $E>0$ is the drained elastic modulus, $\\alpha \\in (0,1]$ is the Biot coefficient, $s>0$ is the specific storage, and $w$ is a prescribed volumetric fluid source per unit length.\n\nDiscretize the domain into two equal linear finite elements of length $h=1/2$. Use $P_1$ (continuous, piecewise-linear) for displacement and $P_0$ (discontinuous, elementwise-constant) for pressure, with nodal displacement unknowns $\\{u_0,u_1,u_2\\}$ and elementwise pressures $\\{p_1,p_2\\}$. Impose $u(0,t)=0$ (so $u_0=0$) and traction-free boundary at $x=1$, and take initial conditions $u^n(x)=0$, $p^n(x)=0$ at time $t^n$. At the next time $t^{n+1}=t^n+\\Delta t$, apply a uniform fluid source $w^{n+1}=W$ (constant in space and time step), with no external mechanical tractions.\n\nAdopt backward Euler time discretization. For this single time step from $t^n$ to $t^{n+1}$, do the following.\n\n1. Form the semi-discrete $P_1$â€“$P_0$ mixed system in matrix form for the monolithic solve at $t^{n+1}$:\n   - the displacement block $K$ comes from the standard $P_1$ stiffness assembly in one dimension;\n   - the displacementâ€“pressure coupling is via the discrete divergence operator $B$ consistent with the weak form;\n   - the storage term contributes a diagonal block proportional to $s h$ for the $P_0$ pressure space;\n   - the source contributes a load vector proportional to $h \\Delta t W$ in the pressure equations.\n\n2. Solve the monolithic system to obtain the right-end nodal displacement $u^{n+1}_{\\mathrm{mono}} := u_2^{n+1}$ as a closed-form expression in the parameters $E$, $\\alpha$, $s$, $\\Delta t$, and $W$.\n\n3. Consider a naive staggered (segregated) scheme that first solves the mechanics subproblem with the pressure lagged at its previous time level, and then solves the mass conservation subproblem with the freshly computed displacement. For this scheme, compute the right-end nodal displacement $u^{n+1}_{\\mathrm{stag}} := u_2^{n+1}$ at the end of the same time step, under the same data.\n\nFinally, compute the ratio\n$$\nR \\;=\\; \\frac{u^{n+1}_{\\mathrm{stag}}}{u^{n+1}_{\\mathrm{mono}}} \\, .\n$$\nProvide the exact value of $R$ as your final answer. No numerical values are to be substituted for $E$, $\\alpha$, $s$, $\\Delta t$, or $W$. The ratio is dimensionless, so no units are required. Your final answer must be a single number or a single closed-form expression.", "solution": "The problem requires the analysis of a one-dimensional linear poroelastic system, comparing a monolithic solution to a staggered solution for a single time step.\n\nFirst, we establish the weak formulation of the governing equations. The domain is the interval $\\Omega = [0,1]$. The unknowns are the solid displacement $u(x,t)$ and the pore pressure $p(x,t)$. The strong form of the quasi-static equations is given as:\nBalance of momentum: $E \\frac{\\partial^2 u}{\\partial x^2} - \\alpha \\frac{\\partial p}{\\partial x} = 0$ for $x \\in (0,1)$.\nFluid mass conservation: $s \\frac{\\partial p}{\\partial t} + \\alpha \\frac{\\partial^2 u}{\\partial x \\partial t} = w$.\n\nLet $V$ be the space of test functions for displacement, and $Q$ be the space for pressure test functions. We multiply the momentum equation by a test function $v \\in V$ and integrate over $\\Omega$.\n$\\int_0^1 \\left( E \\frac{\\partial^2 u}{\\partial x^2} \\right) v \\,dx - \\int_0^1 \\left( \\alpha \\frac{\\partial p}{\\partial x} \\right) v \\,dx = 0$.\nIntegrating by parts yields:\n$\\left[ E \\frac{\\partial u}{\\partial x} v \\right]_0^1 - \\int_0^1 E \\frac{\\partial u}{\\partial x} \\frac{\\partial v}{\\partial x} \\,dx - \\left[ \\alpha p v \\right]_0^1 + \\int_0^1 \\alpha p \\frac{\\partial v}{\\partial x} \\,dx = 0$.\nThe boundary conditions are $u(0,t)=0$ and traction-free at $x=1$. The traction-free condition means the total stress $\\sigma = E \\frac{\\partial u}{\\partial x} - \\alpha p$ is zero at $x=1$. Test functions for displacement must satisfy the essential boundary condition, so $v(0)=0$. The boundary terms become:\n$[ (E \\frac{\\partial u}{\\partial x} - \\alpha p) v ]_0^1 = (E \\frac{\\partial u}{\\partial x}(1) - \\alpha p(1))v(1) - (E \\frac{\\partial u}{\\partial x}(0) - \\alpha p(0))v(0) = 0 \\cdot v(1) - \\dots \\cdot 0 = 0$.\nThe weak form of the momentum balance is thus:\n$\\int_0^1 E \\frac{\\partial u}{\\partial x} \\frac{\\partial v}{\\partial x} \\,dx - \\int_0^1 \\alpha p \\frac{\\partial v}{\\partial x} \\,dx = 0$.\n\nFor the mass conservation equation, we multiply by a test function $q \\in Q$ and integrate over $\\Omega$:\n$\\int_0^1 s \\frac{\\partial p}{\\partial t} q \\,dx + \\int_0^1 \\alpha \\frac{\\partial^2 u}{\\partial x \\partial t} q \\,dx = \\int_0^1 w q \\,dx$.\n\nWe apply the backward Euler method for time discretization. For a generic function $f(t)$, $\\dot{f}(t^{n+1}) \\approx \\frac{f^{n+1}-f^n}{\\Delta t}$. Given initial conditions $u^n=0$ and $p^n=0$, and source $w^{n+1}=W$, the time-discretized weak forms at time $t^{n+1}$ are:\n1. $\\int_0^1 E \\frac{d u^{n+1}}{d x} \\frac{d v}{d x} \\,dx - \\int_0^1 \\alpha p^{n+1} \\frac{d v}{d x} \\,dx = 0$.\n2. $\\int_0^1 \\frac{s}{\\Delta t} p^{n+1} q \\,dx + \\int_0^1 \\frac{\\alpha}{\\Delta t} \\frac{d u^{n+1}}{d x} q \\,dx = \\int_0^1 W q \\,dx$.\n\nThe spatial discretization uses two equal linear elements of length $h=1/2$. Displacement $u$ is approximated using continuous, piecewise-linear ($P_1$) functions, and pressure $p$ using piecewise-constant ($P_0$) functions. The nodal displacements are $\\{u_0, u_1, u_2\\}$ at nodes $x_0=0$, $x_1=h$, $x_2=2h=1$. The elemental pressures are $\\{p_1, p_2\\}$.\nThe condition $u(0,t)=0$ implies $u_0=0$. The discrete unknowns are $\\mathbf{U} = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$ and $\\mathbf{P} = \\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix}$.\n\nThe semi-discrete system can be written in block matrix form:\n$$\n\\begin{pmatrix} K & -\\alpha B^T \\\\ \\frac{\\alpha}{\\Delta t} B & \\frac{s}{\\Delta t} M_p \\end{pmatrix}\n\\begin{pmatrix} \\mathbf{U}^{n+1} \\\\ \\mathbf{P}^{n+1} \\end{pmatrix}\n=\n\\begin{pmatrix} \\mathbf{0} \\\\ \\mathbf{F}_W \\end{pmatrix}\n$$\nwhere the matrix and vector components are derived from the weak forms:\n- Stiffness matrix $K_{ij} = \\int_0^1 E N'_i N'_j \\,dx$. For the $2$ active degrees of freedom ($u_1, u_2$), this assembles to $K = \\frac{E}{h} \\begin{pmatrix} 2 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\n- Coupling matrix $B_{ki} = \\int_0^1 N'_i \\Psi_k \\,dx$. $\\Psi_k$ is the basis function for pressure on element $k$ (characteristic function of the element).\n  $B_{11} = \\int_0^h N'_1 \\,dx = \\int_0^h \\frac{1}{h} \\,dx = 1$.\n  $B_{12} = \\int_0^h N'_2 \\,dx = 0$.\n  $B_{21} = \\int_h^{2h} N'_1 \\,dx = \\int_h^{2h} (-\\frac{1}{h}) \\,dx = -1$.\n  $B_{22} = \\int_h^{2h} N'_2 \\,dx = \\int_h^{2h} \\frac{1}{h} \\,dx = 1$.\n  So, $B = \\begin{pmatrix} 1 & 0 \\\\ -1 & 1 \\end{pmatrix}$, and $B^T = \\begin{pmatrix} 1 & -1 \\\\ 0 & 1 \\end{pmatrix}$.\n- Pressure mass matrix $(M_p)_{kl} = \\int_0^1 \\Psi_k \\Psi_l \\,dx$. For $P_0$ elements, this is diagonal: $M_p = h \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$.\n- Fluid source vector $(\\mathbf{F}_W)_k = \\int_0^1 \\frac{W}{\\Delta t} \\Psi_k \\,dx$. This gives $\\mathbf{F}_W = \\frac{W h}{\\Delta t} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$.\n\nMultiplying the second block row by $\\Delta t$, the monolithic system is:\n$$\n\\begin{pmatrix} K & -\\alpha B^T \\\\ \\alpha B & s M_p \\end{pmatrix}\n\\begin{pmatrix} \\mathbf{U}^{n+1} \\\\ \\mathbf{P}^{n+1} \\end{pmatrix}\n=\n\\begin{pmatrix} \\mathbf{0} \\\\ \\Delta t W h \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\end{pmatrix}\n$$\nSubstituting the matrices and vectors gives four linear equations for the unknowns $(u_1, u_2, p_1, p_2)$:\n(1) $\\frac{2E}{h} u_1 - \\frac{E}{h} u_2 - \\alpha p_1 + \\alpha p_2 = 0$\n(2) $-\\frac{E}{h} u_1 + \\frac{E}{h} u_2 - \\alpha p_2 = 0$\n(3) $\\alpha u_1 + sh p_1 = \\Delta t W h$\n(4) $-\\alpha u_1 + \\alpha u_2 + sh p_2 = \\Delta t W h$\n\nTo solve this system, we can first use equation (2) to express $p_2$ in terms of the displacements: $p_2 = \\frac{E}{\\alpha h}(u_2-u_1)$.\nNext, we add equations (1) and (2) to eliminate $u_2$ and $p_2$, yielding a simple relation between $u_1$ and $p_1$: $\\frac{E}{h}u_1 - \\alpha p_1 = 0 \\implies p_1 = \\frac{E}{\\alpha h}u_1$.\nSubstitute this into equation (3) to solve for $u_1$:\n$\\alpha u_1 + sh \\left(\\frac{E}{\\alpha h} u_1\\right) = \\Delta t W h \\implies u_1 \\left(\\alpha + \\frac{sE}{\\alpha}\\right) = \\Delta t W h \\implies u_1 = \\frac{\\alpha \\Delta t W h}{\\alpha^2 + sE}$.\nNow we use equation (4) and substitute the expression for $p_2$:\n$-\\alpha u_1 + \\alpha u_2 + sh \\left(\\frac{E}{\\alpha h}(u_2 - u_1)\\right) = \\Delta t W h$.\nRearranging this equation gives: $(\\alpha + \\frac{sE}{\\alpha})(u_2 - u_1) = \\Delta t W h \\implies u_2 - u_1 = \\frac{\\alpha \\Delta t W h}{\\alpha^2 + sE}$.\nComparing the expressions for $u_1$ and $u_2-u_1$, we find $u_1 = u_2 - u_1$, which implies $u_2 = 2u_1$.\nTherefore, the monolithic solution for the right-end displacement is:\n$u^{n+1}_{\\mathrm{mono}} = u_2^{n+1} = 2u_1 = \\frac{2 \\alpha \\Delta t W h}{sE + \\alpha^2}$.\n\nNow we analyze the naive staggered scheme. The scheme is:\n1. Solve the mechanics subproblem for $\\mathbf{U}^{n+1}$ using the pressure from the previous time step, $\\mathbf{P}^n$.\n2. Solve the mass conservation subproblem for $\\mathbf{P}^{n+1}$ using the newly computed displacement $\\mathbf{U}^{n+1}$.\n\nFor Step 1, the mechanics subproblem is $K \\mathbf{U}^{n+1} - \\alpha B^T \\mathbf{P}^n = \\mathbf{0}$.\nThe initial pressure is given as $p^n(x)=0$, so $\\mathbf{P}^n = \\mathbf{0}$. The equation simplifies to $K \\mathbf{U}^{n+1} = \\mathbf{0}$.\nThe matrix $K = \\frac{E}{h} \\begin{pmatrix} 2 & -1 \\\\ -1 & 1 \\end{pmatrix}$ for the unconstrained degrees of freedom is invertible, since its determinant is $(E/h)^2(2-1) = E^2/h^2 \\ne 0$.\nThe unique solution to $K \\mathbf{U}^{n+1} = \\mathbf{0}$ is $\\mathbf{U}^{n+1} = \\mathbf{0}$.\nThis means $u_1^{n+1} = 0$ and $u_2^{n+1} = 0$.\nThe displacement at the right end for the staggered scheme is therefore $u^{n+1}_{\\mathrm{stag}} = u_2^{n+1} = 0$.\n\nFinally, we compute the ratio $R = \\frac{u^{n+1}_{\\mathrm{stag}}}{u^{n+1}_{\\mathrm{mono}}}$.\nWe have $u^{n+1}_{\\mathrm{stag}} = 0$ and $u^{n+1}_{\\mathrm{mono}} = \\frac{2 \\alpha \\Delta t W h}{sE + \\alpha^2}$.\nAssuming a non-trivial source term ($W \\ne 0$) and positive physical parameters ($E, \\alpha, s, \\Delta t, h$), the monolithic displacement $u^{n+1}_{\\mathrm{mono}}$ is non-zero.\nThe ratio is therefore:\n$$\nR = \\frac{0}{\\frac{2 \\alpha \\Delta t W h}{sE + \\alpha^2}} = 0\n$$", "answer": "$$\n\\boxed{0}\n$$", "id": "2598463"}, {"introduction": "Beyond catastrophic failures like locking, a staggered scheme's deficiencies can be more subtle, affecting the long-term physical fidelity of a simulation. A crucial test for any time-integration scheme is its ability to respect fundamental conservation laws, such as the conservation of energy. This exercise provides a concrete counterexample where a loosely coupled staggered scheme for thermoelasticity, while seemingly stable for a single step, systematically injects spurious energy into the system [@problem_id:2598449]. Deriving the exact amount of this non-physical energy growth highlights a key weakness of explicit coupling and demonstrates why monolithic or energy-conserving schemes are vital for long-duration dynamic simulations.", "problem": "Consider a reduced finite element method (FEM) model of linear thermoelasticity with a single mechanical degree of freedom $u \\in \\mathbb{R}$ and a single thermal degree of freedom $\\theta \\in \\mathbb{R}$ representing a single spatial mode. The Helmholtz free energy at any configuration $(u,\\theta)$ is\n$$\n\\Psi(u,\\theta) \\;=\\; \\frac{1}{2}\\,k\\,\\big(u - \\alpha\\,\\theta\\big)^{2} \\;+\\; \\frac{1}{2}\\,\\eta\\,\\theta^{2},\n$$\nwith stiffness $k>0$, thermal expansion coefficient $\\alpha \\neq 0$, and thermal storage coefficient $\\eta>0$. The thermal evolution obeys the linear first-order balance law\n$$\nM\\,\\dot{\\theta} \\;+\\; L\\,\\theta \\;=\\; 0,\n$$\nwith $M>0$ the lumped heat capacity and $L>0$ a lumped conduction parameter. Time discretization is performed with backward Euler over a time step $\\Delta t>0$, so that $\\theta^{n+1}$ satisfies\n$$\n\\frac{M}{\\Delta t}\\,\\big(\\theta^{n+1} - \\theta^{n}\\big) \\;+\\; L\\,\\theta^{n+1} \\;=\\; 0,\n$$\nwhich is equivalent to $\\theta^{n+1} \\,=\\, r\\,\\theta^{n}$ with $r \\,=\\, \\frac{M}{M + L\\,\\Delta t} \\in (0,1)$.\n\nTwo solution strategies are considered at each time step from $t^{n}$ to $t^{n+1}$:\n\n(a) A monolithic solve enforces mechanical equilibrium and the thermal update simultaneously, i.e., $k\\,(u^{n+1} - \\alpha\\,\\theta^{n+1}) = 0$ together with the backward Euler thermal equation above.\n\n(b) A loosely coupled staggered scheme first updates temperature by backward Euler to get $\\theta^{n+1}$, but then updates mechanics by enforcing $k\\,(u^{n+1} - \\alpha\\,\\theta^{n}) = 0$, i.e., the temperature entering the mechanical equilibrium is lagged.\n\nAssume the configuration at time $t^{n}$ is mechanically relaxed with respect to the current temperature, i.e., $u^{n} = \\alpha\\,\\theta^{n}$. Define the lagging error $\\delta\\theta := \\theta^{n} - \\theta^{n+1}$, which is nonzero whenever $r \\neq 1$.\n\nUsing only the free energy $\\Psi$ and the stated discrete equations, construct a concrete counterexample showing that the loosely coupled staggered scheme injects spurious energy relative to the monolithic scheme, even though the thermal dynamics is dissipative. Quantify the spurious energy growth per time step by deriving an exact closed-form expression for\n$$\n\\Delta E_{\\mathrm{spur}} \\;:=\\; \\Psi\\big(u^{n+1}_{\\mathrm{stag}},\\theta^{n+1}\\big) \\;-\\; \\Psi\\big(u^{n+1}_{\\mathrm{mono}},\\theta^{n+1}\\big)\n$$\nin terms of the lagging error $\\delta\\theta$ and the parameters $k$ and $\\alpha$. Express your final answer as a single symbolic expression. No numerical approximation is required and no units should be reported.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard, albeit simplified, model of coupled thermoelasticity and requests a direct comparison between two common numerical solution strategies, monolithic and staggered. All necessary definitions, equations, and parameters are provided to derive the required quantity. The problem is valid, and a solution will be provided.\n\nThe objective is to quantify the spurious energy growth per time step, defined as $\\Delta E_{\\mathrm{spur}} := \\Psi(u^{n+1}_{\\mathrm{stag}},\\theta^{n+1}) - \\Psi(u^{n+1}_{\\mathrm{mono}},\\theta^{n+1})$. To do this, we must first determine the state variables $(u^{n+1}, \\theta^{n+1})$ under each scheme.\n\nThe thermal update is identical for both schemes and is given by the backward Euler discretization:\n$$\n\\frac{M}{\\Delta t}\\,(\\theta^{n+1} - \\theta^{n}) + L\\,\\theta^{n+1} = 0\n$$\nThis yields $\\theta^{n+1} = r\\,\\theta^{n}$, where $r = \\frac{M}{M + L\\,\\Delta t}$. Since $M > 0$, $L > 0$, and $\\Delta t > 0$, it follows that $r \\in (0,1)$.\n\nFirst, consider the monolithic solution strategy. The mechanical and thermal equations are solved simultaneously. The mechanical equilibrium equation is enforced at time $t^{n+1}$ using the contemporaneously computed temperature $\\theta^{n+1}$:\n$$\nk\\,(u^{n+1}_{\\mathrm{mono}} - \\alpha\\,\\theta^{n+1}) = 0\n$$\nGiven that the stiffness $k > 0$, this implies that the mechanical degree of freedom for the monolithic scheme is:\n$$\nu^{n+1}_{\\mathrm{mono}} = \\alpha\\,\\theta^{n+1}\n$$\nThis result physically corresponds to a state of mechanical relaxation with respect to the final temperature $\\theta^{n+1}$.\n\nNext, consider the loosely coupled staggered solution strategy. After the thermal update provides $\\theta^{n+1}$, the mechanical equilibrium is enforced using the lagged temperature from time $t^{n}$:\n$$\nk\\,(u^{n+1}_{\\mathrm{stag}} - \\alpha\\,\\theta^{n}) = 0\n$$\nAgain, since $k > 0$, this implies:\n$$\nu^{n+1}_{\\mathrm{stag}} = \\alpha\\,\\theta^{n}\n$$\nThis shows that the mechanical state is out of equilibrium with the final temperature $\\theta^{n+1}$, instead being relaxed with respect to the initial temperature $\\theta^n$.\n\nNow we evaluate the Helmholtz free energy, $\\Psi(u,\\theta) = \\frac{1}{2}\\,k\\,(u - \\alpha\\,\\theta)^{2} + \\frac{1}{2}\\,\\eta\\,\\theta^{2}$, for both final states. The thermal degree of freedom is $\\theta^{n+1}$ in both cases.\n\nFor the monolithic scheme, the final state is $(u^{n+1}_{\\mathrm{mono}}, \\theta^{n+1})$. The free energy is:\n$$\n\\Psi(u^{n+1}_{\\mathrm{mono}},\\theta^{n+1}) = \\Psi(\\alpha\\,\\theta^{n+1}, \\theta^{n+1}) = \\frac{1}{2}\\,k\\,(\\alpha\\,\\theta^{n+1} - \\alpha\\,\\theta^{n+1})^{2} + \\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2}\n$$\nThe first term vanishes, yielding:\n$$\n\\Psi(u^{n+1}_{\\mathrm{mono}},\\theta^{n+1}) = \\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2}\n$$\nThis represents the energy of the system when it is fully mechanically relaxed at the temperature $\\theta^{n+1}$.\n\nFor the staggered scheme, the final state is $(u^{n+1}_{\\mathrm{stag}}, \\theta^{n+1})$. The free energy is:\n$$\n\\Psi(u^{n+1}_{\\mathrm{stag}},\\theta^{n+1}) = \\Psi(\\alpha\\,\\theta^{n}, \\theta^{n+1}) = \\frac{1}{2}\\,k\\,(\\alpha\\,\\theta^{n} - \\alpha\\,\\theta^{n+1})^{2} + \\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2}\n$$\nThis state contains both mechanical strain energy (due to the lag) and thermal energy.\n\nWe can now compute the spurious energy growth $\\Delta E_{\\mathrm{spur}}$ by taking the difference:\n$$\n\\Delta E_{\\mathrm{spur}} = \\Psi(u^{n+1}_{\\mathrm{stag}},\\theta^{n+1}) - \\Psi(u^{n+1}_{\\mathrm{mono}},\\theta^{n+1})\n$$\n$$\n\\Delta E_{\\mathrm{spur}} = \\left[ \\frac{1}{2}\\,k\\,(\\alpha\\,\\theta^{n} - \\alpha\\,\\theta^{n+1})^{2} + \\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2} \\right] - \\left[ \\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2} \\right]\n$$\nThe thermal energy terms, $\\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2}$, cancel out, leaving:\n$$\n\\Delta E_{\\mathrm{spur}} = \\frac{1}{2}\\,k\\,(\\alpha\\,\\theta^{n} - \\alpha\\,\\theta^{n+1})^{2}\n$$\nThe problem asks for this expression in terms of the lagging error $\\delta\\theta := \\theta^{n} - \\theta^{n+1}$. We can factor $\\alpha$ from the squared term:\n$$\n\\Delta E_{\\mathrm{spur}} = \\frac{1}{2}\\,k\\,\\alpha^{2}\\,(\\theta^{n} - \\theta^{n+1})^{2}\n$$\nSubstituting the definition of $\\delta\\theta$:\n$$\n\\Delta E_{\\mathrm{spur}} = \\frac{1}{2}\\,k\\,\\alpha^{2}\\,(\\delta\\theta)^{2}\n$$\nSince $k > 0$ and $\\alpha \\neq 0$, the term $\\frac{1}{2}\\,k\\,\\alpha^{2}$ is strictly positive. The term $(\\delta\\theta)^{2}$ is non-negative. For any non-trivial thermal evolution where $\\theta^{n} \\neq \\theta^{n+1}$, we have $\\delta\\theta \\neq 0$, and therefore $\\Delta E_{\\mathrm{spur}} > 0$. This demonstrates that the staggered scheme spuriously injects mechanical energy into the system at each time step due to the time lag in the coupling term, despite the underlying thermal physics being dissipative. This unphysical energy growth is a well-known artifact of such explicit coupling schemes and can lead to numerical instability. The monolithic scheme, by contrast, correctly finds the minimum energy state for the given temperature and is thus unconditionally stable in this regard.", "answer": "$$\n\\boxed{\\frac{1}{2}\\,k\\,\\alpha^{2}\\,(\\delta\\theta)^{2}}\n$$", "id": "2598449"}]}