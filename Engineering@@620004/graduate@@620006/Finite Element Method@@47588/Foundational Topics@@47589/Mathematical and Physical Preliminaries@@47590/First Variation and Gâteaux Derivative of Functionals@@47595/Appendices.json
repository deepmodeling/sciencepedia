{"hands_on_practices": [{"introduction": "The first step toward mastering the concept of a functional derivative is to apply its definition directly to a concrete example. This exercise provides a hands-on opportunity to compute the Gâteaux derivative for a nonlinear functional that depends on the gradient of a function. By working through this calculation, you will solidify your understanding of the definition and practice essential calculus techniques in the context of infinite-dimensional spaces.", "problem": "The first variation, or Gâteaux derivative, of a functional $J[u]$ at a function $u_0$ in the direction of a function $v$ is defined as\n$$\n\\delta J[u_0; v] = \\frac{d}{d\\epsilon} \\Big|_{\\epsilon=0} J[u_0 + \\epsilon v]\n$$\nThis represents the rate of change of the functional $J$ at $u_0$ along the direction specified by $v$.\n\nConsider the functional\n$$\nJ[u] = \\int_D \\log(1 + a|\\nabla u|^2) \\,d^2x\n$$\nwhere $u$ is a real-valued function on a domain $D$, $\\nabla u$ is its gradient, and $a$ is a positive constant. The domain $D$ is the unit disk in $\\mathbb{R}^2$, i.e., $D = \\{(x,y) \\in \\mathbb{R}^2 : x^2+y^2 \\le 1\\}$.\n\nLet the function $u_0$ be given by\n$$\nu_0(x,y) = A(x^2+y^2)\n$$\nand the direction $v$ be given by\n$$\nv(x,y) = B(1 - (x^2+y^2))\n$$\nwhere $A$ and $B$ are non-zero real constants. The functions $u_0$ and $v$ belong to a space of functions (e.g., $C^1(\\bar{D})$) where the functional and its variation are well-defined. Note that $v$ vanishes on the boundary of the disk $\\partial D$.\n\nCalculate the first variation $\\delta J[u_0; v]$.", "solution": "We use the formula for the Gâteaux derivative of \n$$J[u]=\\int_D\\log\\bigl(1+a|\\nabla u|^2\\bigr)\\,d^2x$$\nin the direction $v$ at $u_0$:\n$$\n\\delta J[u_0;v]\n=\\frac{d}{d\\epsilon}\\Big|_{\\epsilon=0}J[u_0+\\epsilon v]\n=\\int_D\\frac{1}{1+a|\\nabla u_0|^2}\\,a\\cdot2\\,\\nabla u_0\\cdot\\nabla v\\,d^2x\n=\\int_D\\frac{2a\\,\\nabla u_0\\cdot\\nabla v}{1+a|\\nabla u_0|^2}\\,d^2x.\n$$\n\nCompute the gradients for $u_0(x,y)=A(x^2+y^2)$ and $v(x,y)=B(1-(x^2+y^2))$.  With $r^2=x^2+y^2$:\n$$\n\\nabla u_0=(2Ax,2Ay),\\quad|\\nabla u_0|^2=4A^2r^2,\n\\quad\\nabla v=(-2Bx,-2By),\n$$\nso\n$$\n\\nabla u_0\\cdot\\nabla v=-4AB\\,r^2.\n$$\nThus the integrand becomes\n$$\n\\frac{2a(-4AB\\,r^2)}{1+4aA^2r^2}\n=-\\frac{8aAB\\,r^2}{1+4aA^2r^2},\n$$\nand hence\n$$\n\\delta J[u_0;v]\n=-8aAB\\int_D\\frac{r^2}{1+4aA^2r^2}\\,d^2x\n=-8aAB\\int_0^{2\\pi}\\int_0^1\\frac{r^3}{1+\\alpha r^2}\\,dr\\,d\\theta,\n\\quad\\alpha=4aA^2.\n$$\nIntegrate over $\\theta$ and set \n$$I=\\int_0^1\\frac{r^3}{1+\\alpha r^2}\\,dr.\n$$\nSubstitute $t=r^2$, $dt=2r\\,dr$ to get\n$$\nI=\\frac12\\int_0^1\\frac{t}{1+\\alpha t}\\,dt\n=\\frac{1}{2}\\Bigl[\\frac{1}{\\alpha}\\Bigl(t-\\frac{1}{\\alpha}\\ln(1+\\alpha t)\\Bigr)\\Bigr]_0^1\n=\\frac{1}{2\\alpha}\\Bigl[1-\\frac{\\ln(1+\\alpha)}{\\alpha}\\Bigr].\n$$\nTherefore\n$$\n\\delta J[u_0;v]\n=-8aAB\\cdot2\\pi\\cdot I\n=-16\\pi aAB\\Bigl[\\frac{1}{2\\alpha}-\\frac{\\ln(1+\\alpha)}{2\\alpha^2}\\Bigr],\n\\quad\\alpha=4aA^2.\n$$\nSubstituting $\\alpha=4aA^2$ gives\n$$\n\\delta J[u_0;v]\n=-2\\pi\\frac{B}{A}+\\frac{\\pi B\\ln(1+4aA^2)}{2aA^3}.\n$$", "answer": "$$\\boxed{-\\frac{2\\pi B}{A}+\\frac{\\pi B\\ln\\bigl(1+4aA^2\\bigr)}{2aA^3}}$$", "id": "433893"}, {"introduction": "The first variation is far more than a notational convenience; it is the theoretical engine that connects variational principles to differential equations. This foundational practice demonstrates this by starting with the Poisson energy functional, whose minimizer describes numerous physical phenomena. By finding the stationarity condition—that is, by setting the first variation to zero—you will derive the weak formulation of the Poisson equation and connect it to the rigorous existence theory guaranteed by the Lax–Milgram theorem.", "problem": "Let $\\Omega \\subset \\mathbb{R}^{n}$ be a bounded Lipschitz domain with outward unit normal $\\nu$, and let $f \\in L^{2}(\\Omega)$. Consider the Poisson energy functional $J:H^{1}(\\Omega)\\to \\mathbb{R}$ defined by\n$$\nJ(u)\\equiv \\frac{1}{2}\\int_{\\Omega}|\\nabla u|^{2}\\,dx-\\int_{\\Omega}f\\,u\\,dx.\n$$\nUse the calculus of variations starting from the definition of the Gâteaux derivative and the divergence theorem to carry out the following steps without appealing to any pre-stated Euler–Lagrange formulas.\n\n(1) Derive the weak stationarity condition for $J$ at a minimizer $u \\in H^{1}(\\Omega)$ by computing the first variation $\\delta J(u;v)$ in an arbitrary direction $v \\in H^{1}(\\Omega)$.\n\n(2) Specialize to the Dirichlet class $H^{1}_{0}(\\Omega)$, where the trace of $v$ vanishes on $\\partial\\Omega$. From the weak stationarity condition, identify the associated partial differential equation (PDE) and boundary condition that the minimizer satisfies in the classical sense, assuming sufficient regularity.\n\n(3) Repeat the derivation for the Neumann class, where $u$ is free on $\\partial\\Omega$ and variations $v$ need not vanish on $\\partial\\Omega$. Identify the natural boundary condition implied by stationarity, and state any compatibility condition on $f$ needed for solvability.\n\n(4) For the Dirichlet class $H^{1}_{0}(\\Omega)$, identify the bilinear form $a(u,v)$ and the linear functional $\\ell(v)$ arising from the weak formulation. Using the norm $\\|u\\|_{H^{1}_{0}(\\Omega)}\\equiv \\left(\\int_{\\Omega}|\\nabla u|^{2}\\,dx\\right)^{1/2}$, verify the continuity and coercivity hypotheses of the Lax–Milgram theorem for $a(\\cdot,\\cdot)$ and $\\ell(\\cdot)$, and compute the coercivity constant $\\alpha$ defined by\n$$\na(u,u)\\ge \\alpha\\,\\|u\\|_{H^{1}_{0}(\\Omega)}^{2}\\quad\\text{for all }u\\in H^{1}_{0}(\\Omega).\n$$\n\nYour final reported answer should be the value of the coercivity constant $\\alpha$ as a single real number. No rounding is required, and no units are involved. Do not report any intermediate equations in the final answer.", "solution": "The problem asks for a multi-step derivation concerning the Poisson energy functional, its stationarity conditions, and the application of the Lax-Milgram theorem. We will proceed by addressing each part sequentially, starting from fundamental principles as instructed.\n\n(1) Derivation of the weak stationarity condition.\n\nThe Gâteaux derivative, or first variation, of the functional $J(u)$ at a point $u \\in H^{1}(\\Omega)$ in the direction of $v \\in H^{1}(\\Omega)$ is defined as\n$$\n\\delta J(u;v) = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} J(u+\\epsilon v) = \\lim_{\\epsilon \\to 0} \\frac{J(u+\\epsilon v) - J(u)}{\\epsilon}.\n$$\nWe first compute $J(u+\\epsilon v)$ for a scalar $\\epsilon \\in \\mathbb{R}$:\n$$\nJ(u+\\epsilon v) = \\frac{1}{2}\\int_{\\Omega}|\\nabla (u+\\epsilon v)|^{2}\\,dx - \\int_{\\Omega}f(u+\\epsilon v)\\,dx.\n$$\nThe squared norm of the gradient term can be expanded:\n$$\n|\\nabla (u+\\epsilon v)|^{2} = |\\nabla u + \\epsilon \\nabla v|^{2} = (\\nabla u + \\epsilon \\nabla v) \\cdot (\\nabla u + \\epsilon \\nabla v) = |\\nabla u|^{2} + 2\\epsilon(\\nabla u \\cdot \\nabla v) + \\epsilon^{2}|\\nabla v|^{2}.\n$$\nSubstituting this back into the expression for $J(u+\\epsilon v)$ and using the linearity of the integral, we get\n$$\nJ(u+\\epsilon v) = \\frac{1}{2}\\int_{\\Omega} (|\\nabla u|^{2} + 2\\epsilon(\\nabla u \\cdot \\nabla v) + \\epsilon^{2}|\\nabla v|^{2})\\,dx - \\int_{\\Omega} (fu + \\epsilon fv)\\,dx\n$$\n$$\nJ(u+\\epsilon v) = \\left(\\frac{1}{2}\\int_{\\Omega}|\\nabla u|^{2}\\,dx - \\int_{\\Omega}fu\\,dx\\right) + \\epsilon \\left(\\int_{\\Omega}(\\nabla u \\cdot \\nabla v)\\,dx - \\int_{\\Omega}fv\\,dx\\right) + \\frac{\\epsilon^{2}}{2}\\int_{\\Omega}|\\nabla v|^{2}\\,dx.\n$$\nThe first term is exactly $J(u)$. Therefore, the difference is\n$$\nJ(u+\\epsilon v) - J(u) = \\epsilon \\left(\\int_{\\Omega}(\\nabla u \\cdot \\nabla v)\\,dx - \\int_{\\Omega}fv\\,dx\\right) + \\frac{\\epsilon^{2}}{2}\\int_{\\Omega}|\\nabla v|^{2}\\,dx.\n$$\nDividing by $\\epsilon$ and taking the limit as $\\epsilon \\to 0$:\n$$\n\\delta J(u;v) = \\lim_{\\epsilon \\to 0} \\left[ \\left(\\int_{\\Omega}(\\nabla u \\cdot \\nabla v)\\,dx - \\int_{\\Omega}fv\\,dx\\right) + \\frac{\\epsilon}{2}\\int_{\\Omega}|\\nabla v|^{2}\\,dx \\right]\n$$\n$$\n\\delta J(u;v) = \\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx - \\int_{\\Omega}f v\\,dx.\n$$\nA minimizer $u$ is a stationary point of the functional $J$, which means its first variation must vanish for all admissible directions $v$. Thus, the weak stationarity condition is $\\delta J(u;v) = 0$, which explicitly is:\n$$\n\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx - \\int_{\\Omega}f v\\,dx = 0 \\quad \\text{for all } v \\in H^{1}(\\Omega).\n$$\n\n(2) Dirichlet problem on $H^{1}_{0}(\\Omega)$.\n\nWe now specialize to the case where the function space is $H^{1}_{0}(\\Omega)$, the space of $H^{1}$ functions with zero trace on the boundary $\\partial\\Omega$. A minimizer $u$ must belong to $H^{1}_{0}(\\Omega)$, and the variations $v$ must also be in $H^{1}_{0}(\\Omega)$. The weak stationarity condition is\n$$\n\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx = \\int_{\\Omega}f v\\,dx \\quad \\text{for all } v \\in H^{1}_{0}(\\Omega).\n$$\nTo derive the PDE, we assume the minimizer $u$ is sufficiently regular (e.g., $u \\in H^{2}(\\Omega)$) so that classical derivatives and the divergence theorem apply. We use Green's first identity, which is a consequence of the divergence theorem applied to the vector field $v\\nabla u$: $\\text{div}(v\\nabla u) = v\\Delta u + \\nabla v \\cdot \\nabla u$. Integrating over $\\Omega$ gives\n$$\n\\int_{\\Omega} (v\\Delta u + \\nabla v \\cdot \\nabla u) \\,dx = \\int_{\\partial\\Omega} (v\\nabla u) \\cdot \\nu \\,dS.\n$$\nRearranging, we get\n$$\n\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx = -\\int_{\\Omega}v \\Delta u \\,dx + \\int_{\\partial\\Omega}v (\\nabla u \\cdot \\nu)\\,dS.\n$$\nSince $v \\in H^{1}_{0}(\\Omega)$, its trace on the boundary is zero, so $v|_{\\partial\\Omega}=0$. The boundary integral vanishes. Substituting this into the weak form:\n$$\n-\\int_{\\Omega}v \\Delta u \\,dx = \\int_{\\Omega}f v\\,dx \\quad \\implies \\quad \\int_{\\Omega}(-\\Delta u - f)v\\,dx = 0.\n$$\nThis equation must hold for all $v \\in H^{1}_{0}(\\Omega)$. Since the space of smooth functions with compact support, $C_{c}^{\\infty}(\\Omega)$, is a dense subspace of $H^{1}_{0}(\\Omega)$, the equality holds for all $v \\in C_{c}^{\\infty}(\\Omega)$. By the fundamental lemma of the calculus of variations, if the integral of a function against all smooth, compactly supported functions is zero, the function itself must be zero almost everywhere. Therefore, we obtain the PDE:\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega.\n$$\nThe boundary condition is imposed by the function space for the solution: $u \\in H^{1}_{0}(\\Omega)$, which implies the homogeneous Dirichlet boundary condition:\n$$\nu = 0 \\quad \\text{on } \\partial\\Omega.\n$$\n\n(3) Neumann problem.\n\nFor the Neumann problem, the solution $u$ and variations $v$ are in $H^{1}(\\Omega)$, with no a priori constraint on their boundary values. The weak stationarity condition is again\n$$\n\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx - \\int_{\\Omega}f v\\,dx = 0 \\quad \\text{for all } v \\in H^{1}(\\Omega).\n$$\nApplying Green's first identity as before (again assuming $u$ is sufficiently regular):\n$$\n\\left(-\\int_{\\Omega}v \\Delta u \\,dx + \\int_{\\partial\\Omega}v (\\nabla u \\cdot \\nu)\\,dS\\right) - \\int_{\\Omega}f v\\,dx = 0.\n$$\nRearranging gives\n$$\n\\int_{\\Omega}(-\\Delta u - f)v\\,dx + \\int_{\\partial\\Omega} (\\nabla u \\cdot \\nu) v \\,dS = 0 \\quad \\text{for all } v \\in H^{1}(\\Omega).\n$$\nThis equality must hold for any choice of $v \\in H^{1}(\\Omega)$. We can first choose variations $v$ from the subspace $H^{1}_{0}(\\Omega)$, for which $v|_{\\partial\\Omega}=0$. For such $v$, the boundary integral vanishes, and we are left with $\\int_{\\Omega}(-\\Delta u - f)v\\,dx = 0$. As in part (2), this implies the PDE:\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega.\n$$\nSince this PDE must hold, it must be satisfied within the full stationarity condition. Substituting $-\\Delta u = f$ back into the condition yields:\n$$\n\\int_{\\partial\\Omega} (\\nabla u \\cdot \\nu) v \\,dS = 0 \\quad \\text{for all } v \\in H^{1}(\\Omega).\n$$\nSince the trace operator from $H^{1}(\\Omega)$ to $L^{2}(\\partial\\Omega)$ is surjective, we can choose $v$ such that its trace $v|_{\\partial\\Omega}$ can be any function in $L^{2}(\\partial\\Omega)$ (or a dense subset thereof). For the integral to be zero for all such choices, the other factor in the integrand must be zero. This gives the natural boundary condition:\n$$\n\\nabla u \\cdot \\nu = \\frac{\\partial u}{\\partial \\nu} = 0 \\quad \\text{on } \\partial\\Omega.\n$$\nThis is the homogeneous Neumann boundary condition.\nFor solvability, there is a compatibility condition on $f$. Integrating the PDE $-\\Delta u = f$ over the domain $\\Omega$:\n$$\n-\\int_{\\Omega}\\Delta u \\,dx = \\int_{\\Omega}f\\,dx.\n$$\nApplying the divergence theorem to the left side:\n$$\n-\\int_{\\Omega}\\text{div}(\\nabla u) \\,dx = -\\int_{\\partial\\Omega}\\nabla u \\cdot \\nu \\,dS.\n$$\nUsing the natural boundary condition $\\nabla u \\cdot \\nu = 0$, the left side becomes $0$. Therefore, for a solution to exist, the right side must also be zero. This gives the compatibility condition:\n$$\n\\int_{\\Omega}f\\,dx = 0.\n$$\n\n(4) Lax-Milgram hypotheses for the Dirichlet problem.\n\nThe weak formulation for the Dirichlet problem is: find $u \\in H^{1}_{0}(\\Omega)$ such that\n$$\n\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx = \\int_{\\Omega}f v\\,dx \\quad \\text{for all } v \\in H^{1}_{0}(\\Omega).\n$$\nThis is of the form $a(u,v) = \\ell(v)$, where:\n- The bilinear form is $a(u,v) = \\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx$.\n- The linear functional is $\\ell(v) = \\int_{\\Omega}f v\\,dx$.\nThe Hilbert space is $V = H^{1}_{0}(\\Omega)$ with the specified norm $\\|w\\|_{H^{1}_{0}(\\Omega)} = \\left(\\int_{\\Omega}|\\nabla w|^{2}\\,dx\\right)^{1/2}$. This is a valid norm on $H^{1}_{0}(\\Omega)$ by the Poincaré inequality.\n\nWe verify the hypotheses of the Lax-Milgram theorem: continuity and coercivity of $a(\\cdot,\\cdot)$, and continuity of $\\ell(\\cdot)$.\n\n- **Continuity of $a(u,v)$**: We must show there exists a constant $M > 0$ such that $|a(u,v)| \\le M \\|u\\|_{H^{1}_{0}(\\Omega)}\\|v\\|_{H^{1}_{0}(\\Omega)}$ for all $u, v \\in H^{1}_{0}(\\Omega)$.\nBy the Cauchy-Schwarz inequality for integrals, applied to the scalar function $|\\nabla u||\\nabla v|$:\n$$\n|a(u,v)| = \\left|\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx\\right| \\le \\int_{\\Omega}|\\nabla u \\cdot \\nabla v|\\,dx.\n$$\nBy the point-wise Cauchy-Schwarz inequality for vectors in $\\mathbb{R}^n$: $|\\nabla u \\cdot \\nabla v| \\le |\\nabla u||\\nabla v|$. Thus,\n$$\n\\int_{\\Omega}|\\nabla u \\cdot \\nabla v|\\,dx \\le \\int_{\\Omega}|\\nabla u||\\nabla v|\\,dx.\n$$\nApplying the Cauchy-Schwarz inequality for integrals again:\n$$\n\\int_{\\Omega}|\\nabla u||\\nabla v|\\,dx \\le \\left(\\int_{\\Omega}|\\nabla u|^{2}\\,dx\\right)^{1/2} \\left(\\int_{\\Omega}|\\nabla v|^{2}\\,dx\\right)^{1/2}.\n$$\nUsing the given definition of the norm, this is\n$$\n|a(u,v)| \\le \\|u\\|_{H^{1}_{0}(\\Omega)}\\|v\\|_{H^{1}_{0}(\\Omega)}.\n$$\nThus, $a(\\cdot,\\cdot)$ is continuous with a continuity constant $M = 1$.\n\n- **Continuity of $\\ell(v)$**: We must show there exists a constant $C > 0$ such that $|\\ell(v)| \\le C \\|v\\|_{H^{1}_{0}(\\Omega)}$ for all $v \\in H^{1}_{0}(\\Omega)$.\n$$\n|\\ell(v)| = \\left|\\int_{\\Omega}f v\\,dx\\right|.\n$$\nBy the Cauchy-Schwarz inequality,\n$$\n|\\ell(v)| \\le \\left(\\int_{\\Omega}|f|^{2}\\,dx\\right)^{1/2} \\left(\\int_{\\Omega}|v|^{2}\\,dx\\right)^{1/2} = \\|f\\|_{L^{2}(\\Omega)}\\|v\\|_{L^{2}(\\Omega)}.\n$$\nThe Poincaré inequality for a bounded domain $\\Omega$ states that there exists a constant $C_{P} > 0$ depending only on $\\Omega$ and $n$ such that for any $v \\in H^{1}_{0}(\\Omega)$,\n$$\n\\|v\\|_{L^{2}(\\Omega)} \\le C_{P} \\|\\nabla v\\|_{L^{2}(\\Omega)} = C_{P} \\left(\\int_{\\Omega}|\\nabla v|^{2}\\,dx\\right)^{1/2}.\n$$\nUsing the problem's definition for the norm on $H^{1}_{0}(\\Omega)$, this is $\\|v\\|_{L^{2}(\\Omega)} \\le C_{P} \\|v\\|_{H^{1}_{0}(\\Omega)}$. Substituting this into the inequality for $|\\ell(v)|$:\n$$\n|\\ell(v)| \\le \\|f\\|_{L^{2}(\\Omega)} (C_{P} \\|v\\|_{H^{1}_{0}(\\Omega)}) = (C_{P}\\|f\\|_{L^{2}(\\Omega)}) \\|v\\|_{H^{1}_{0}(\\Omega)}.\n$$\nSince $f \\in L^{2}(\\Omega)$, $\\|f\\|_{L^{2}(\\Omega)}$ is finite. Thus, $\\ell(\\cdot)$ is continuous, with continuity constant $C = C_{P}\\|f\\|_{L^{2}(\\Omega)}$.\n\n- **Coercivity of $a(u,u)$**: We must find a constant $\\alpha > 0$ such that $a(u,u) \\ge \\alpha \\|u\\|_{H^{1}_{0}(\\Omega)}^{2}$ for all $u \\in H^{1}_{0}(\\Omega)$.\nBy definition of the bilinear form,\n$$\na(u,u) = \\int_{\\Omega}\\nabla u \\cdot \\nabla u\\,dx = \\int_{\\Omega}|\\nabla u|^{2}\\,dx.\n$$\nBy definition of the norm provided in the problem,\n$$\n\\|u\\|_{H^{1}_{0}(\\Omega)}^{2} = \\left(\\left(\\int_{\\Omega}|\\nabla u|^{2}\\,dx\\right)^{1/2}\\right)^{2} = \\int_{\\Omega}|\\nabla u|^{2}\\,dx.\n$$\nTherefore, we have the equality\n$$\na(u,u) = \\|u\\|_{H^{1}_{0}(\\Omega)}^{2}.\n$$\nThis can be written as the inequality $a(u,u) \\ge \\alpha \\|u\\|_{H^{1}_{0}(\\Omega)}^{2}$ by choosing $\\alpha = 1$. Since $1 > 0$, the bilinear form is coercive. The coercivity constant is $\\alpha = 1$.", "answer": "$$\\boxed{1}$$", "id": "3035874"}, {"introduction": "The abstract concept of the Gâteaux derivative finds its most powerful application in the numerical solution of nonlinear equations. For nonlinear problems discretized via the Finite Element Method, the first variation gives rise to the system's residual, while its Gâteaux derivative defines the Jacobian matrix essential for Newton's method. This advanced exercise puts you in the role of a software developer, using the Method of Manufactured Solutions to verify a numerical implementation by deriving the exact element-level residual and Jacobian from first principles.", "problem": "Consider the one-dimensional nonlinear boundary value problem obtained as the Euler–Lagrange equation of the energy functional\n$$\\Pi(u) \\;=\\; \\int_{0}^{1} \\left( \\tfrac{1}{2}\\,(u'(x))^{2} \\;+\\; \\tfrac{\\alpha}{4}\\,u(x)^{4} \\;-\\; f(x)\\,u(x) \\right)\\,dx,$$\nwhere $\\alpha>0$ is a given constant. In the Finite Element Method (FEM, Finite Element Method), the element-level residual and Jacobian used in Newton’s method arise from the first variation and the Gâteaux derivative of $\\Pi$. Your task is to derive these objects from first principles and then evaluate them for a manufactured solution to test a Newton solver at the element level.\n\nWork on the single element $e=[0,1]$ with the linear nodal basis $\\{\\varphi_{1}(x),\\varphi_{2}(x)\\}$ defined by $\\varphi_{1}(x)=1-x$ and $\\varphi_{2}(x)=x$. Let $\\alpha=2$. Use the manufactured solution\n$$u_{m}(x)\\;=\\;1+2x,$$\nand define the source term $f$ so that $u_{m}$ satisfies the Euler–Lagrange equation in strong form, i.e., $-u_{m}''(x)+\\alpha\\,u_{m}(x)^{3}=f(x)$ on $[0,1]$. Let $u_{h}$ be the linear finite element interpolant of $u_{m}$ on $e$, i.e., $u_{h}(x)=u_{1}\\,\\varphi_{1}(x)+u_{2}\\,\\varphi_{2}(x)$ with $u_{1}=u_{m}(0)$ and $u_{2}=u_{m}(1)$.\n\nTasks:\n- Starting strictly from the definition of the first variation $\\delta\\Pi(u;v)=\\left.\\dfrac{d}{d\\varepsilon}\\Pi(u+\\varepsilon v)\\right|_{\\varepsilon=0}$, derive the element-level residual operator $R(u_{h})[v_{h}]$ on $e$.\n- Starting strictly from the definition of the Gâteaux derivative of the residual, $J(u_{h})[\\delta u_{h},v_{h}]=\\left.\\dfrac{d}{d\\varepsilon}R(u_{h}+\\varepsilon\\,\\delta u_{h})[v_{h}]\\right|_{\\varepsilon=0}$, derive the element-level Jacobian bilinear form on $e$.\n- With $\\alpha=2$ and $u_{m}(x)=1+2x$, construct $f(x)$ and then evaluate the element residual vector $\\boldsymbol{r}_{e}=\\big(R(u_{h})[\\varphi_{1}],\\,R(u_{h})[\\varphi_{2}]\\big)$ and the element Jacobian matrix $\\boldsymbol{K}_{e}=\\big(J(u_{h})[\\varphi_{j},\\varphi_{i}]\\big)_{i,j=1}^{2}$ exactly (no quadrature error).\n- Finally, compute the single scalar\n$$S \\;=\\; R(u_{h})[\\psi_{h}] \\;+\\; J(u_{h})[\\delta u_{h},\\psi_{h}],$$\nfor the specific choices $\\psi_{h}=\\varphi_{1}+2\\,\\varphi_{2}$ and $\\delta u_{h}=3\\,\\varphi_{1}-\\varphi_{2}$.\n\nExpress your final answer for $S$ as an exact rational number. Do not round.", "solution": "We begin from the definitions. The first variation of the energy functional $\\Pi$ at $u$ in the direction $v$ is\n$$\\delta\\Pi(u;v)\\;=\\;\\left.\\dfrac{d}{d\\varepsilon}\\,\\Pi(u+\\varepsilon v)\\right|_{\\varepsilon=0}.$$\nWith\n$$\\Pi(u)\\;=\\;\\int_{0}^{1}\\left(\\tfrac{1}{2}(u')^{2}+\\tfrac{\\alpha}{4}u^{4}-f\\,u\\right)\\,dx,$$\nwe compute\n$$\\Pi(u+\\varepsilon v)\\;=\\;\\int_{0}^{1}\\left(\\tfrac{1}{2}(u'+\\varepsilon v')^{2}+\\tfrac{\\alpha}{4}(u+\\varepsilon v)^{4}-f\\,(u+\\varepsilon v)\\right)\\,dx.$$\nDifferentiating with respect to $\\varepsilon$ and evaluating at $\\varepsilon=0$ gives\n$$\\delta\\Pi(u;v)\\;=\\;\\int_{0}^{1}\\left(u'\\,v'\\;+\\;\\alpha\\,u^{3}\\,v\\;-\\;f\\,v\\right)\\,dx.$$\nThus, for a finite element function $u_{h}$ and a test function $v_{h}$ supported on the element $e=[0,1]$, the element residual operator is\n$$R(u_{h})[v_{h}]\\;=\\;\\int_{0}^{1}\\left(u_{h}'\\,v_{h}'\\;+\\;\\alpha\\,u_{h}^{3}\\,v_{h}\\;-\\;f\\,v_{h}\\right)\\,dx.$$\n\nNext, the Gâteaux derivative of the residual at $u_{h}$ in the direction $\\delta u_{h}$ applied to $v_{h}$ is\n$$J(u_{h})[\\delta u_{h},v_{h}]\\;=\\;\\left.\\dfrac{d}{d\\varepsilon}\\,R(u_{h}+\\varepsilon\\,\\delta u_{h})[v_{h}]\\right|_{\\varepsilon=0}.$$\nWe substitute $u_{h}+\\varepsilon\\,\\delta u_{h}$ into $R$:\n$$R(u_{h}+\\varepsilon\\,\\delta u_{h})[v_{h}]\\;=\\;\\int_{0}^{1}\\left((u_{h}'+\\varepsilon\\,\\delta u_{h}')\\,v_{h}'\\;+\\;\\alpha\\,(u_{h}+\\varepsilon\\,\\delta u_{h})^{3}\\,v_{h}\\;-\\;f\\,v_{h}\\right)\\,dx.$$\nDifferentiating at $\\varepsilon=0$ yields\n$$J(u_{h})[\\delta u_{h},v_{h}]\\;=\\;\\int_{0}^{1}\\left(\\delta u_{h}'\\,v_{h}'\\;+\\;3\\,\\alpha\\,u_{h}^{2}\\,\\delta u_{h}\\,v_{h}\\right)\\,dx.$$\n\nNow specialize to $\\alpha=2$ and the manufactured solution $u_{m}(x)=1+2x$. The corresponding load $f$ is chosen to satisfy the strong form $-u_{m}''+\\alpha\\,u_{m}^{3}=f$ on $[0,1]$. Since $u_{m}''(x)=0$, it follows that\n$$f(x)\\;=\\;\\alpha\\,u_{m}(x)^{3}\\;=\\;2\\,(1+2x)^{3}.$$\nLet $u_{h}$ be the linear interpolant of $u_{m}$ on $e=[0,1]$, $u_{h}(x)=u_{1}\\,\\varphi_{1}(x)+u_{2}\\,\\varphi_{2}(x)$ with $u_{1}=u_{m}(0)=1$ and $u_{2}=u_{m}(1)=3$. Because $u_{m}$ is linear, $u_{h}=u_{m}$ pointwise on $[0,1]$, and therefore $u_{h}'(x)=2$ and $u_{h}(x)^{3}=(1+2x)^{3}$.\n\nElement residual vector. Using the basis tests $v_{h}=\\varphi_{i}$, $i\\in\\{1,2\\}$,\n$$r_{i}\\;=\\;R(u_{h})[\\varphi_{i}]\\;=\\;\\int_{0}^{1}\\left(u_{h}'\\,\\varphi_{i}'\\;+\\;\\alpha\\,u_{h}^{3}\\,\\varphi_{i}\\;-\\;f\\,\\varphi_{i}\\right)\\,dx.$$\nWith $f=\\alpha\\,u_{h}^{3}$, the reaction terms cancel, leaving\n$$r_{i}\\;=\\;\\int_{0}^{1}u_{h}'\\,\\varphi_{i}'\\,dx\\;=\\;\\int_{0}^{1}2\\,\\varphi_{i}'\\,dx.$$\nSince $\\varphi_{1}(x)=1-x$ and $\\varphi_{2}(x)=x$, we have $\\varphi_{1}'(x)=-1$ and $\\varphi_{2}'(x)=1$. Hence\n$$r_{1}\\;=\\;\\int_{0}^{1}2\\,(-1)\\,dx\\;=\\;-2,\\qquad r_{2}\\;=\\;\\int_{0}^{1}2\\,(1)\\,dx\\;=\\;2.$$\nThus $\\boldsymbol{r}_{e}=(-2,\\,2)$.\n\nElement Jacobian matrix. The entries are\n$$a_{ij}\\;=\\;J(u_{h})[\\varphi_{j},\\varphi_{i}]\\;=\\;\\int_{0}^{1}\\left(\\varphi_{j}'\\,\\varphi_{i}'\\;+\\;3\\,\\alpha\\,u_{h}^{2}\\,\\varphi_{j}\\,\\varphi_{i}\\right)\\,dx.$$\nWith $\\alpha=2$ and $u_{h}(x)=1+2x$, we have $3\\,\\alpha=6$ and $u_{h}(x)^{2}=(1+2x)^{2}=1+4x+4x^{2}$. Define the gradient part\n$$k^{(0)}_{ij}=\\int_{0}^{1}\\varphi_{j}'\\,\\varphi_{i}'\\,dx,$$\nand the nonlinear mass-like part\n$$m_{ij}=\\int_{0}^{1}6\\,u_{h}^{2}\\,\\varphi_{j}\\,\\varphi_{i}\\,dx.$$\nThe gradient contributions on $[0,1]$ with linear basis are\n$$k^{(0)}_{11}=\\int_{0}^{1}(-1)(-1)\\,dx=1,\\quad k^{(0)}_{12}=\\int_{0}^{1}(1)(-1)\\,dx=-1,$$\n$$k^{(0)}_{21}=\\int_{0}^{1}(-1)(1)\\,dx=-1,\\quad k^{(0)}_{22}=\\int_{0}^{1}(1)(1)\\,dx=1.$$\nFor the nonlinear part, write $\\varphi_{1}\\varphi_{1}=(1-x)^{2}=1-2x+x^{2}$, $\\varphi_{1}\\varphi_{2}=(1-x)x=x-x^{2}$, and $\\varphi_{2}\\varphi_{2}=x^{2}$. With $u_{h}^{2}=1+4x+4x^{2}$,\n\n$$\n\\begin{aligned}\nI_{11}&=\\int_{0}^{1}(1+4x+4x^{2})(1-2x+x^{2})\\,dx=\\int_{0}^{1}\\big(1+2x-3x^{2}-4x^{3}+4x^{4}\\big)\\,dx=\\tfrac{4}{5},\\\\\nI_{12}&=\\int_{0}^{1}(1+4x+4x^{2})(x-x^{2})\\,dx=\\int_{0}^{1}\\big(x+3x^{2}-4x^{4}\\big)\\,dx=\\tfrac{7}{10},\\\\\nI_{22}&=\\int_{0}^{1}(1+4x+4x^{2})x^{2}\\,dx=\\int_{0}^{1}\\big(x^{2}+4x^{3}+4x^{4}\\big)\\,dx=\\tfrac{32}{15}.\n\\end{aligned}\n$$\n\nMultiplying by $6$ gives\n$$m_{11}=6\\,I_{11}=\\tfrac{24}{5},\\quad m_{12}=6\\,I_{12}=\\tfrac{21}{5},\\quad m_{22}=6\\,I_{22}=\\tfrac{64}{5},$$\nand $m_{21}=m_{12}$. Therefore,\n\n$$\n\\boldsymbol{K}_{e}=\\big[a_{ij}\\big]=\\big[k^{(0)}_{ij}+m_{ij}\\big]\n=\\begin{pmatrix}\n1+\\tfrac{24}{5} & -1+\\tfrac{21}{5}\\\\\n-1+\\tfrac{21}{5} & 1+\\tfrac{64}{5}\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\tfrac{29}{5} & \\tfrac{16}{5}\\\\\n\\tfrac{16}{5} & \\tfrac{69}{5}\n\\end{pmatrix}.\n$$\n\n\nScalar $S$. Let $\\psi_{h}=\\varphi_{1}+2\\,\\varphi_{2}$ and $\\delta u_{h}=3\\,\\varphi_{1}-\\varphi_{2}$. In nodal-vector form, write $\\boldsymbol{w}=(1,\\,2)$ and $\\boldsymbol{d}=(3,\\,-1)$. Then\n$$R(u_{h})[\\psi_{h}]=\\boldsymbol{r}_{e}\\cdot\\boldsymbol{w}=(-2,\\,2)\\cdot(1,\\,2)=-2+4=2.$$\nAlso,\n$$J(u_{h})[\\delta u_{h},\\psi_{h}]=\\boldsymbol{d}^{\\top}\\,\\boldsymbol{K}_{e}\\,\\boldsymbol{w}.$$\nCompute\n\n$$\n\\boldsymbol{K}_{e}\\,\\boldsymbol{w}\n=\n\\begin{pmatrix}\n\\tfrac{29}{5} & \\tfrac{16}{5}\\\\\n\\tfrac{16}{5} & \\tfrac{69}{5}\n\\end{pmatrix}\n\\begin{pmatrix}1\\\\\n2\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\tfrac{29}{5}+2\\,\\tfrac{16}{5}\\\\\n\\tfrac{16}{5}+2\\,\\tfrac{69}{5}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\tfrac{61}{5}\\\\\n\\tfrac{154}{5}\n\\end{pmatrix},\n$$\n\nhence\n$$\\boldsymbol{d}^{\\top}(\\boldsymbol{K}_{e}\\,\\boldsymbol{w})=3\\,\\tfrac{61}{5}-1\\cdot\\tfrac{154}{5}=\\tfrac{183}{5}-\\tfrac{154}{5}=\\tfrac{29}{5}.$$\nTherefore,\n$$S=R(u_{h})[\\psi_{h}]+J(u_{h})[\\delta u_{h},\\psi_{h}]=2+\\tfrac{29}{5}=\\tfrac{39}{5}.$$\n\nThis exact rational value simultaneously exercises the residual and Jacobian consistent with the first variation and the Gâteaux derivative of the nonlinear functional.", "answer": "$$\\boxed{\\tfrac{39}{5}}$$", "id": "2559329"}]}