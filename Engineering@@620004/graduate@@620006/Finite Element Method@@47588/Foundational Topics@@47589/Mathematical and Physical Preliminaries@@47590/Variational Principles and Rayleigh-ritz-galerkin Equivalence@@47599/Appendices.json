{"hands_on_practices": [{"introduction": "The powerful equivalence between the energy-minimizing Rayleigh-Ritz method and the weak-form Galerkin method is not universal. This fundamental connection holds only when the underlying bilinear form is symmetric, which guarantees that the Galerkin equations represent the gradient of a quadratic energy functional. This exercise provides a concrete demonstration of this crucial requirement. You will compute the stiffness matrix for a non-symmetric bilinear form and prove by direct calculation that the resulting matrix is not symmetric, thereby confirming that the Galerkin system cannot be derived from a simple energy minimization principle.", "problem": "Let $V$ be the Sobolev space $H^{1}(0,1)$ and let $V_{h} \\subset V$ be the finite-dimensional trial and test space spanned by the two linearly independent functions $\\phi_{1}(x)=x$ and $\\phi_{2}(x)=x^{2}$. Consider the bilinear form $a:V\\times V\\to \\mathbb{R}$ defined by\n$$\na(u,v)\\;=\\;\\int_{0}^{1} u'(x)\\,v(x)\\,dx\\;+\\;\\int_{0}^{1} u(x)\\,v(x)\\,dx,\n$$\nand an arbitrary continuous linear form $\\ell:V\\to\\mathbb{R}$. The Galerkin method for finding $u_{h}\\in V_{h}$ such that $a(u_{h},v_{h})=\\ell(v_{h})$ for all $v_{h}\\in V_{h}$ yields the linear system $\\mathbf{K}\\,\\mathbf{c}=\\mathbf{f}$ in the coefficient vector $\\mathbf{c}\\in\\mathbb{R}^{2}$, where the stiffness matrix $\\mathbf{K}\\in\\mathbb{R}^{2\\times 2}$ has entries $K_{ij}=a(\\phi_{j},\\phi_{i})$ for $i,j\\in\\{1,2\\}$ and the load vector $\\mathbf{f}$ has entries $f_{i}=\\ell(\\phi_{i})$.\n\nStarting from first principles about gradients of scalar functionals in the standard Euclidean inner product on $\\mathbb{R}^{2}$, explain why the existence of a quadratic functional $J(\\mathbf{c})$ whose first-order necessary condition is $\\nabla J(\\mathbf{c})=\\mathbf{K}\\mathbf{c}-\\mathbf{f}$ for all $\\mathbf{c}\\in\\mathbb{R}^{2}$ requires $\\mathbf{K}$ to be symmetric. Then, for the specific choice of $a(\\cdot,\\cdot)$ and $V_{h}$ above, compute the quantity $K_{12}-K_{21}$ explicitly to confirm that $\\mathbf{K}$ is not symmetric and hence the Galerkin equations cannot be obtained by minimizing a quadratic functional in the standard Euclidean inner product.\n\nReport your final result for $K_{12}-K_{21}$ as an exact reduced fraction with no rounding.", "solution": "The problem presents two tasks. First, to demonstrate from first principles why the existence of a quadratic potential functional for a linear system implies the symmetry of the system matrix. Second, to compute the asymmetry of a specific stiffness matrix derived from a non-symmetric bilinear form.\n\nFirst, we address the theoretical requirement. Let $J(\\mathbf{c})$ be a scalar-valued functional on $\\mathbb{R}^{n}$, where $\\mathbf{c} = (c_{1}, c_{2}, \\dots, c_{n})^{T}$. The problem states that the first-order necessary condition for an extremum of $J$ is given by the equation $\\nabla J(\\mathbf{c}) = \\mathbf{K}\\mathbf{c} - \\mathbf{f}$, where $\\mathbf{K}$ is an $n \\times n$ matrix and $\\mathbf{f}$ is a constant vector in $\\mathbb{R}^{n}$. The vector field $\\mathbf{F}(\\mathbf{c}) = \\mathbf{K}\\mathbf{c} - \\mathbf{f}$ is asserted to be the gradient of $J$.\n\nFor a vector field $\\mathbf{F}$ to be the gradient of a scalar potential $J$ (i.e., $\\mathbf{F} = \\nabla J$), a necessary condition is that its Jacobian matrix must be symmetric. The Jacobian matrix of $\\mathbf{F}$, denoted $\\mathbf{J}_{\\mathbf{F}}$, has entries $(\\mathbf{J}_{\\mathbf{F}})_{ij} = \\frac{\\partial F_{i}}{\\partial c_{j}}$.\nGiven $F_{i} = \\frac{\\partial J}{\\partial c_{i}}$, the Jacobian entries become $(\\mathbf{J}_{\\mathbf{F}})_{ij} = \\frac{\\partial}{\\partial c_{j}}\\left(\\frac{\\partial J}{\\partial c_{i}}\\right) = \\frac{\\partial^{2} J}{\\partial c_{j} \\partial c_{i}}$. This matrix is the Hessian matrix of $J$, denoted $\\mathbf{H}_{J}$.\n\nAccording to Schwarz's theorem (or Clairaut's theorem) on the equality of mixed partial derivatives, if the second partial derivatives of a function are continuous, then the Hessian matrix is symmetric. That is, $\\frac{\\partial^{2} J}{\\partial c_{j} \\partial c_{i}} = \\frac{\\partial^{2} J}{\\partial c_{i} \\partial c_{j}}$, which implies $(\\mathbf{H}_{J})_{ij} = (\\mathbf{H}_{J})_{ji}$.\nThe problem specifies a quadratic functional. The second derivatives of such a functional are constants, and thus continuous, so the theorem applies unconditionally.\n\nNow, we compute the Jacobian of the specific vector field $\\mathbf{F}(\\mathbf{c}) = \\mathbf{K}\\mathbf{c} - \\mathbf{f}$. The $i$-th component is $F_{i}(\\mathbf{c}) = \\sum_{k=1}^{n} K_{ik}c_{k} - f_{i}$.\nThe partial derivative with respect to $c_{j}$ is:\n$$\n\\frac{\\partial F_{i}}{\\partial c_{j}} = \\frac{\\partial}{\\partial c_{j}} \\left( \\sum_{k=1}^{n} K_{ik}c_{k} - f_{i} \\right) = \\sum_{k=1}^{n} K_{ik} \\frac{\\partial c_{k}}{\\partial c_{j}} = \\sum_{k=1}^{n} K_{ik} \\delta_{kj} = K_{ij}\n$$\nwhere $\\delta_{kj}$ is the Kronecker delta.\nThus, the Jacobian matrix of $\\mathbf{F}(\\mathbf{c})$ is the matrix $\\mathbf{K}$ itself.\nEquating the two results, we have $\\mathbf{H}_{J} = \\mathbf{K}$. Since the Hessian $\\mathbf{H}_{J}$ must be symmetric, it follows necessarily that the matrix $\\mathbf{K}$ must be symmetric, i.e., $K_{ij} = K_{ji}$. This concludes the first part of the argument.\n\nNext, we compute the stiffness matrix for the specific problem and verify its asymmetry. The space $V_{h}$ is spanned by the basis functions $\\phi_{1}(x) = x$ and $\\phi_{2}(x) = x^{2}$. Their derivatives are $\\phi_{1}'(x) = 1$ and $\\phi_{2}'(x) = 2x$.\nThe bilinear form is given by:\n$$\na(u,v) = \\int_{0}^{1} u'(x)v(x)dx + \\int_{0}^{1} u(x)v(x)dx\n$$\nThe entries of the stiffness matrix $\\mathbf{K} \\in \\mathbb{R}^{2 \\times 2}$ are defined by $K_{ij} = a(\\phi_{j}, \\phi_{i})$ for $i,j \\in \\{1,2\\}$. We are required to compute $K_{12} - K_{21}$.\n\nLet us compute the term $K_{12}$:\n$$\nK_{12} = a(\\phi_{2}, \\phi_{1}) = \\int_{0}^{1} \\phi_{2}'(x)\\phi_{1}(x)dx + \\int_{0}^{1} \\phi_{2}(x)\\phi_{1}(x)dx\n$$\nSubstituting the expressions for the functions and their derivatives:\n$$\nK_{12} = \\int_{0}^{1} (2x)(x)dx + \\int_{0}^{1} (x^{2})(x)dx = \\int_{0}^{1} 2x^{2}dx + \\int_{0}^{1} x^{3}dx\n$$\nPerforming the integration:\n$$\nK_{12} = \\left[\\frac{2x^{3}}{3}\\right]_{0}^{1} + \\left[\\frac{x^{4}}{4}\\right]_{0}^{1} = \\frac{2}{3} + \\frac{1}{4} = \\frac{8+3}{12} = \\frac{11}{12}\n$$\nNow, let us compute the term $K_{21}$:\n$$\nK_{21} = a(\\phi_{1}, \\phi_{2}) = \\int_{0}^{1} \\phi_{1}'(x)\\phi_{2}(x)dx + \\int_{0}^{1} \\phi_{1}(x)\\phi_{2}(x)dx\n$$\nSubstituting the functions and derivatives:\n$$\nK_{21} = \\int_{0}^{1} (1)(x^{2})dx + \\int_{0}^{1} (x)(x^{2})dx = \\int_{0}^{1} x^{2}dx + \\int_{0}^{1} x^{3}dx\n$$\nPerforming the integration:\n$$\nK_{21} = \\left[\\frac{x^{3}}{3}\\right]_{0}^{1} + \\left[\\frac{x^{4}}{4}\\right]_{0}^{1} = \\frac{1}{3} + \\frac{1}{4} = \\frac{4+3}{12} = \\frac{7}{12}\n$$\nThe asymmetry is evident, as $K_{12} \\neq K_{21}$. The quantity requested is the difference:\n$$\nK_{12} - K_{21} = \\frac{11}{12} - \\frac{7}{12} = \\frac{4}{12} = \\frac{1}{3}\n$$\nAlternatively, the difference can be computed more directly:\n$$\nK_{12} - K_{21} = a(\\phi_{2}, \\phi_{1}) - a(\\phi_{1}, \\phi_{2}) = \\left(\\int_{0}^{1} \\phi_{2}'\\phi_{1}dx + \\int_{0}^{1} \\phi_{2}\\phi_{1}dx\\right) - \\left(\\int_{0}^{1} \\phi_{1}'\\phi_{2}dx + \\int_{0}^{1} \\phi_{1}\\phi_{2}dx\\right)\n$$\nThe terms involving $\\int \\phi_{1}\\phi_{2}dx$ cancel, as multiplication is commutative. The asymmetry arises solely from the $u'v$ term in the bilinear form.\n$$\nK_{12} - K_{21} = \\int_{0}^{1} (\\phi_{2}'\\phi_{1} - \\phi_{1}'\\phi_{2})dx = \\int_{0}^{1} ((2x)(x) - (1)(x^{2}))dx = \\int_{0}^{1} (2x^{2} - x^{2})dx = \\int_{0}^{1} x^{2}dx\n$$\n$$\n\\int_{0}^{1} x^{2}dx = \\left[\\frac{x^{3}}{3}\\right]_{0}^{1} = \\frac{1}{3}\n$$\nSince $K_{12} - K_{21} \\neq 0$, the stiffness matrix $\\mathbf{K}$ is not symmetric. Therefore, the Galerkin system $\\mathbf{K}\\mathbf{c} = \\mathbf{f}$ for this specific choice of bilinear form and basis cannot be derived from the minimization of a quadratic functional $J(\\mathbf{c})$ in the standard Euclidean inner product, as this would require a symmetric matrix $\\mathbf{K}$.", "answer": "$$\n\\boxed{\\frac{1}{3}}\n$$", "id": "2609992"}, {"introduction": "Having established the theoretical conditions for the Ritz-Galerkin equivalence, we now apply it to a practical boundary value problem. For self-adjoint problems, the solution uniquely minimizes an energy functional, and the finite element method seeks the best approximation within a chosen subspace by minimizing that same functional. This hands-on exercise guides you through the complete process of finding a Rayleigh-Ritz approximation for a differential equation with a variable coefficient. By explicitly computing the energy of your approximate solution and comparing it to the energy of the exact solution, you will reinforce the core minimization principle of the method.", "problem": "Consider the scalar boundary value problem\n$$\n-\\big((1+x)\\,u'(x)\\big)' \\;=\\; 1 \\quad \\text{for } x\\in(0,1), \\qquad u(0)=0,\\; u(1)=0.\n$$\nStarting from the variational formulation based on the energy principle, define the energy functional and justify why the exact solution is its unique minimizer over the Sobolev space $H^{1}_{0}(0,1)$. Use the Rayleigh–Ritz–Galerkin equivalence to construct the finite element method with two linear finite elements, i.e., the conforming trial space of continuous, piecewise-linear functions on the uniform partition with nodes at $x=0$, $x=\\tfrac{1}{2}$, and $x=1$, with homogeneous Dirichlet boundary conditions enforced at $x=0$ and $x=1$. Compute explicitly:\n- the unique Ritz–Galerkin approximation $u_{h}$ in this space,\n- the energy of the approximation, $J(u_{h})$,\n- the energy of the exact solution, $J(u)$.\n\nFinally, report the energy gap\n$$\nE_{\\mathrm{gap}} \\;=\\; J(u_{h}) - J(u)\n$$\nas a single exact closed-form expression. No rounding is required, and no units are involved. The final answer must be this single expression.", "solution": "The given scalar boundary value problem is\n$$\n-\\big((1+x)\\,u'(x)\\big)' \\;=\\; 1 \\quad \\text{for } x\\in(0,1)\n$$\nwith homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$.\n\nFirst, we derive the variational formulation. Let the solution space be the Sobolev space $H^{1}_{0}(0,1)$, which consists of functions with square-integrable weak first derivatives that are zero at the boundaries $x=0$ and $x=1$. We multiply the differential equation by an arbitrary test function $v \\in H^{1}_{0}(0,1)$ and integrate over the domain $(0,1)$:\n$$\n-\\int_{0}^{1} \\big((1+x)\\,u'(x)\\big)' v(x) \\, dx \\;=\\; \\int_{0}^{1} 1 \\cdot v(x) \\, dx\n$$\nApplying integration by parts to the left-hand side yields:\n$$\n-\\Big[(1+x)u'(x)v(x)\\Big]_{0}^{1} + \\int_{0}^{1} (1+x)u'(x)v'(x) \\, dx \\;=\\; \\int_{0}^{1} v(x) \\, dx\n$$\nSince $v \\in H^{1}_{0}(0,1)$, we have $v(0)=0$ and $v(1)=0$, so the boundary term vanishes. This leads to the weak formulation: Find $u \\in H^{1}_{0}(0,1)$ such that\n$$\na(u,v) \\;=\\; F(v) \\quad \\forall v \\in H^{1}_{0}(0,1)\n$$\nwhere the bilinear form $a(\\cdot,\\cdot)$ and the linear functional $F(\\cdot)$ are defined as:\n$$\na(w,v) \\;=\\; \\int_{0}^{1} (1+x)w'(x)v'(x) \\, dx\n$$\n$$\nF(v) \\;=\\; \\int_{0}^{1} v(x) \\, dx\n$$\nThe corresponding energy functional $J(v)$ is given by $J(v) = \\frac{1}{2}a(v,v) - F(v)$:\n$$\nJ(v) \\;=\\; \\frac{1}{2} \\int_{0}^{1} (1+x)(v'(x))^{2} \\, dx - \\int_{0}^{1} v(x) \\, dx\n$$\nThe exact solution $u$ is the unique minimizer of this functional over $H^{1}_{0}(0,1)$. This is justified by the properties of the bilinear form $a(\\cdot,\\cdot)$. It is symmetric, continuous, and coercive on $H^{1}_{0}(0,1)$. Coercivity is established by observing that for $x \\in [0,1]$, we have $1+x \\ge 1$. Thus,\n$$\na(v,v) = \\int_{0}^{1} (1+x)(v'(x))^{2} \\, dx \\ge \\int_{0}^{1} (v'(x))^{2} \\, dx = \\|v'\\|_{L^{2}(0,1)}^{2}\n$$\nBy Poincaré's inequality, there exists a constant $C > 0$ such that $\\|v\\|_{H^{1}(0,1)} \\le C \\|v'\\|_{L^{2}(0,1)}$ for all $v \\in H^{1}_{0}(0,1)$. Therefore, $a(v,v)$ is coercive on $H^{1}_{0}(0,1)$. For a symmetric, continuous, and coercive bilinear form, the energy functional $J(v)$ is strictly convex and continuous. A standard theorem in functional analysis guarantees that such a functional possesses a unique minimizer in a Hilbert space, which coincides with the unique solution of the weak formulation.\n\nNext, we construct the Rayleigh-Ritz-Galerkin approximation $u_{h}$. The finite element space $V_{h}$ consists of continuous, piecewise-linear functions on the uniform partition with nodes $x_{0}=0$, $x_{1}=\\frac{1}{2}$, and $x_{2}=1$, satisfying the homogeneous boundary conditions. This space is one-dimensional and is spanned by the single basis \"hat\" function $\\phi_{1}(x)$ associated with the interior node $x_{1}=\\frac{1}{2}$:\n$$\n\\phi_{1}(x) = \\begin{cases} 2x & \\text{if } x \\in [0, \\frac{1}{2}] \\\\ 2(1-x) & \\text{if } x \\in [\\frac{1}{2}, 1] \\end{cases}\n$$\nThe derivative of this basis function is piecewise constant:\n$$\n\\phi'_{1}(x) = \\begin{cases} 2 & \\text{if } x \\in (0, \\frac{1}{2}) \\\\ -2 & \\text{if } x \\in (\\frac{1}{2}, 1) \\end{cases}\n$$\nThe Ritz-Galerkin approximation is of the form $u_{h}(x) = c_{1}\\phi_{1}(x)$, where the coefficient $c_{1}$ is determined by the Galerkin equation $a(u_{h}, \\phi_{1}) = F(\\phi_{1})$. This gives the linear system $c_{1} a(\\phi_{1}, \\phi_{1}) = F(\\phi_{1})$. We compute the components:\n$$\na(\\phi_{1},\\phi_{1}) = \\int_{0}^{1} (1+x)(\\phi'_{1}(x))^{2} \\, dx = \\int_{0}^{1/2} (1+x)(2)^{2} \\, dx + \\int_{1/2}^{1} (1+x)(-2)^{2} \\, dx\n$$\n$$\na(\\phi_{1},\\phi_{1}) = 4 \\int_{0}^{1} (1+x) \\, dx = 4 \\left[x + \\frac{x^{2}}{2}\\right]_{0}^{1} = 4 \\left(1 + \\frac{1}{2}\\right) = 6\n$$\n$$\nF(\\phi_{1}) = \\int_{0}^{1} \\phi_{1}(x) \\, dx = \\int_{0}^{1/2} 2x \\, dx + \\int_{1/2}^{1} 2(1-x) \\, dx = \\left[x^{2}\\right]_{0}^{1/2} + 2\\left[x - \\frac{x^{2}}{2}\\right]_{1/2}^{1} = \\frac{1}{4} + 2\\left(\\frac{1}{2} - \\frac{3}{8}\\right) = \\frac{1}{2}\n$$\nThe linear equation for $c_{1}$ is $6 c_{1} = \\frac{1}{2}$, which gives $c_{1} = \\frac{1}{12}$. The approximation is thus:\n$$\nu_{h}(x) = \\frac{1}{12} \\phi_{1}(x)\n$$\nThe energy of the approximation $J(u_{h})$ is computed as $J(u_{h}) = \\frac{1}{2}a(u_{h}, u_{h}) - F(u_{h})$. From Galerkin orthogonality, $a(u_{h}, u_{h}) = F(u_{h})$. Thus, $J(u_{h}) = -\\frac{1}{2} F(u_{h})$.\n$$\nF(u_{h}) = F(c_{1}\\phi_{1}) = c_{1}F(\\phi_{1}) = \\frac{1}{12} \\cdot \\frac{1}{2} = \\frac{1}{24}\n$$\nTherefore, the energy of the approximation is:\n$$\nJ(u_{h}) = -\\frac{1}{2} \\left(\\frac{1}{24}\\right) = -\\frac{1}{48}\n$$\nNow, we find the exact solution $u(x)$ by direct integration of the differential equation:\n$$\n-\\big((1+x)u'(x)\\big)' = 1 \\implies -(1+x)u'(x) = x + C_{1} \\implies u'(x) = -\\frac{x+C_{1}}{1+x} = -1 - \\frac{C_{1}-1}{1+x}\n$$\nIntegrating again gives:\n$$\nu(x) = -x - (C_{1}-1)\\ln(1+x) + C_{2}\n$$\nApplying the boundary conditions:\n$u(0)=0 \\implies 0 = -0 - (C_{1}-1)\\ln(1) + C_{2} \\implies C_{2}=0$.\n$u(1)=0 \\implies 0 = -1 - (C_{1}-1)\\ln(2) \\implies C_{1}-1 = -\\frac{1}{\\ln(2)}$.\nThe exact solution is:\n$$\nu(x) = -x - \\left(-\\frac{1}{\\ln(2)}\\right)\\ln(1+x) = \\frac{\\ln(1+x)}{\\ln(2)} - x\n$$\nThe energy of the exact solution $J(u)$ is determined similarly: $J(u) = -\\frac{1}{2}F(u)$.\n$$\nF(u) = \\int_{0}^{1} u(x) \\, dx = \\int_{0}^{1} \\left(\\frac{\\ln(1+x)}{\\ln(2)} - x\\right) \\, dx = \\frac{1}{\\ln(2)} \\int_{0}^{1} \\ln(1+x) \\, dx - \\int_{0}^{1} x \\, dx\n$$\nThe integrals are evaluated as:\n$\\int_{0}^{1} x \\, dx = \\frac{1}{2}$.\n$\\int_{0}^{1} \\ln(1+x) \\, dx = \\Big[(1+x)\\ln(1+x) - (1+x)\\Big]_{0}^{1} = (2\\ln(2)-2) - (1\\ln(1)-1) = 2\\ln(2) - 1$.\nSo,\n$$\nF(u) = \\frac{1}{\\ln(2)}(2\\ln(2) - 1) - \\frac{1}{2} = 2 - \\frac{1}{\\ln(2)} - \\frac{1}{2} = \\frac{3}{2} - \\frac{1}{\\ln(2)}\n$$\nThe energy of the exact solution is:\n$$\nJ(u) = -\\frac{1}{2} F(u) = -\\frac{1}{2} \\left(\\frac{3}{2} - \\frac{1}{\\ln(2)}\\right) = \\frac{1}{2\\ln(2)} - \\frac{3}{4}\n$$\nFinally, we compute the energy gap $E_{\\mathrm{gap}} = J(u_{h}) - J(u)$:\n$$\nE_{\\mathrm{gap}} = -\\frac{1}{48} - \\left(\\frac{1}{2\\ln(2)} - \\frac{3}{4}\\right) = -\\frac{1}{48} - \\frac{1}{2\\ln(2)} + \\frac{36}{48}\n$$\n$$\nE_{\\mathrm{gap}} = \\frac{35}{48} - \\frac{1}{2\\ln(2)}\n$$\nThis gap is guaranteed to be non-negative by the Rayleigh-Ritz principle, as $u$ is the global minimizer of $J$ and $u_h$ is the minimizer over the subspace $V_h$.", "answer": "$$\n\\boxed{\\frac{35}{48} - \\frac{1}{2\\ln(2)}}\n$$", "id": "2609997"}, {"introduction": "The power of variational principles extends beyond solving source problems to approximating eigenvalues and eigenmodes, which are critical in analyzing vibrations, stability, and quantum states. Eigenvalues of a self-adjoint operator can be characterized as stationary values of the Rayleigh quotient. This exercise applies the Rayleigh-Ritz method to this principle, transforming the search for eigenfunctions into a tangible matrix eigenvalue problem. By performing this calculation, you will gain hands-on experience with one of the most effective methods for computing approximate eigenvalues and understand its connection to the underlying variational structure.", "problem": "Consider the Sturm–Liouville eigenvalue problem on the unit interval: find an eigenpair $(\\lambda,u)$ with $u \\neq 0$ such that $-u''=\\lambda u$ on $(0,1)$ with $u(0)=u(1)=0$. Work entirely within the Sobolev space $H_{0}^{1}(0,1)$ and the standard $L^{2}(0,1)$ inner product. Denote by $a(u,v)=\\int_{0}^{1} u'(x)\\,v'(x)\\,\\mathrm{d}x$ and $m(u,v)=\\int_{0}^{1} u(x)\\,v(x)\\,\\mathrm{d}x$. Define the Rayleigh quotient $R(v)=\\dfrac{a(v,v)}{m(v,v)}$ for $v \\in H_{0}^{1}(0,1)$, $v \\neq 0$.\n\n1. Starting from the strong form $-u''=\\lambda u$ with homogeneous Dirichlet boundary conditions, derive the weak (variational) formulation and show that eigenpairs $(\\lambda,u)$ are precisely the stationary points of the Rayleigh quotient $R(v)$ under the normalization constraint $m(v,v)=1$. Make explicit all steps and assumptions, including integration by parts and the vanishing of boundary terms.\n\n2. Let $V_{h}=\\mathrm{span}\\{\\varphi_{1},\\varphi_{2}\\}$ with $\\varphi_{1}(x)=\\sin(\\pi x)$ and $\\varphi_{2}(x)=\\sin(2\\pi x)$. Formulate the Rayleigh–Ritz approximation on $V_{h}$ and show its equivalence to the Galerkin generalized matrix eigenproblem, namely: find $(\\lambda_{h},\\mathbf{c})$ with $\\mathbf{c}\\neq \\mathbf{0}$ such that $\\mathbf{K}\\mathbf{c}=\\lambda_{h}\\,\\mathbf{M}\\mathbf{c}$, where $\\mathbf{K}_{ij}=a(\\varphi_{i},\\varphi_{j})$ and $\\mathbf{M}_{ij}=m(\\varphi_{i},\\varphi_{j})$. Compute the entries of $\\mathbf{K}$ and $\\mathbf{M}$ explicitly.\n\n3. Solve the resulting $2\\times 2$ generalized eigenvalue problem to obtain closed-form expressions for the two Rayleigh–Ritz approximations to the smallest two eigenvalues.\n\n4. The exact spectrum of this boundary value problem is known analytically. Compare your two approximations with the exact first two eigenvalues and briefly justify any coincidence or discrepancy based on the structure of $V_{h}$.\n\nProvide your final answer as the two approximate eigenvalues in closed form. Do not round your answer.", "solution": "Part 1: Weak Formulation and Variational Principle\nThe starting point is the strong form of the eigenvalue problem: find $(\\lambda, u)$ such that\n$$ -u''(x) = \\lambda u(x) \\quad \\text{for } x \\in (0,1) $$\nwith boundary conditions $u(0)=0$ and $u(1)=0$. The solution $u$ is sought in the Sobolev space $H_{0}^{1}(0,1)$, which consists of functions in $H^{1}(0,1)$ that vanish at the boundaries $x=0$ and $x=1$. Let $v$ be an arbitrary test function from the same space, $v \\in H_{0}^{1}(0,1)$. We multiply the strong form by $v(x)$ and integrate over the domain $[0,1]$:\n$$ -\\int_{0}^{1} u''(x)v(x)\\,\\mathrm{d}x = \\int_{0}^{1} \\lambda u(x)v(x)\\,\\mathrm{d}x $$\nApplying integration by parts to the left-hand side gives:\n$$ -\\left[ u'(x)v(x) \\right]_{0}^{1} + \\int_{0}^{1} u'(x)v'(x)\\,\\mathrm{d}x = \\lambda \\int_{0}^{1} u(x)v(x)\\,\\mathrm{d}x $$\nThe boundary term, $[u'(x)v(x)]_{0}^{1} = u'(1)v(1) - u'(0)v(0)$, is identically zero because the test function $v$ is in $H_{0}^{1}(0,1)$, which requires $v(0)=v(1)=0$. This leaves:\n$$ \\int_{0}^{1} u'(x)v'(x)\\,\\mathrm{d}x = \\lambda \\int_{0}^{1} u(x)v(x)\\,\\mathrm{d}x $$\nUsing the provided definitions of the bilinear forms $a(u,v)$ and $m(u,v)$, this is precisely the weak (or variational) formulation: find an eigenpair $(\\lambda, u)$ with $u \\in H_{0}^{1}(0,1)$, $u \\neq 0$, such that for all $v \\in H_{0}^{1}(0,1)$,\n$$ a(u,v) = \\lambda m(u,v) $$\nNext, we show that the solutions to this weak problem are the stationary points of the Rayleigh quotient $R(v) = a(v,v)/m(v,v)$. A function $u$ is a stationary point of $R(v)$ if the directional derivative of $R$ at $u$ in any direction $\\eta \\in H_{0}^{1}(0,1)$ is zero. The Gâteaux derivative is:\n$$ \\frac{d}{d\\epsilon} R(u+\\epsilon\\eta) \\Big|_{\\epsilon=0} = 0 \\quad \\forall \\eta \\in H_{0}^{1}(0,1) $$\nUsing the quotient rule for differentiation:\n$$ \\frac{\\frac{d}{d\\epsilon}\\left[a(u+\\epsilon\\eta, u+\\epsilon\\eta)\\right]_{\\epsilon=0} m(u,u) - a(u,u) \\frac{d}{d\\epsilon}\\left[m(u+\\epsilon\\eta, u+\\epsilon\\eta)\\right]_{\\epsilon=0}}{[m(u,u)]^2} = 0 $$\nThe derivatives of the bilinear forms are computed as follows, using their symmetry and bilinearity:\n$$ \\frac{d}{d\\epsilon} a(u+\\epsilon\\eta, u+\\epsilon\\eta) \\Big|_{\\epsilon=0} = \\frac{d}{d\\epsilon} [a(u,u) + 2\\epsilon a(u,\\eta) + \\epsilon^2 a(\\eta,\\eta)] \\Big|_{\\epsilon=0} = 2a(u,\\eta) $$\n$$ \\frac{d}{d\\epsilon} m(u+\\epsilon\\eta, u+\\epsilon\\eta) \\Big|_{\\epsilon=0} = \\frac{d}{d\\epsilon} [m(u,u) + 2\\epsilon m(u,\\eta) + \\epsilon^2 m(\\eta,\\eta)] \\Big|_{\\epsilon=0} = 2m(u,\\eta) $$\nSubstituting these into the quotient rule expression and setting it to zero yields:\n$$ \\frac{2a(u,\\eta)m(u,u) - 2a(u,u)m(u,\\eta)}{[m(u,u)]^2} = 0 $$\nFor $u \\neq 0$, $m(u,u) \\neq 0$, so we must have:\n$$ a(u,\\eta)m(u,u) - a(u,u)m(u,\\eta) = 0 $$\n$$ a(u,\\eta) = \\frac{a(u,u)}{m(u,u)} m(u,\\eta) $$\nBy defining $\\lambda = \\frac{a(u,u)}{m(u,u)} = R(u)$, we recover the weak formulation $a(u,\\eta) = \\lambda m(u,\\eta)$ for all test functions $\\eta \\in H_{0}^{1}(0,1)$. This demonstrates that the eigenpairs $(\\lambda, u)$ of the weak problem are precisely the stationary values and stationary points of the Rayleigh quotient. The constraint $m(v,v)=1$ is a normalization that simplifies the problem to finding stationary points of $a(v,v)$ on the unit sphere in the $L^2$ norm, where the Lagrange multiplier directly corresponds to the eigenvalue.\n\nPart 2: Rayleigh-Ritz Approximation and Galerkin Equivalence\nThe Rayleigh-Ritz method restricts the variational problem to a finite-dimensional subspace $V_{h} \\subset H_{0}^{1}(0,1)$. Here, $V_{h} = \\mathrm{span}\\{\\varphi_{1}, \\varphi_{2}\\}$. An approximate solution $u_{h} \\in V_{h}$ is sought, which can be expressed as a linear combination of the basis functions:\n$$ u_{h}(x) = c_{1}\\varphi_{1}(x) + c_{2}\\varphi_{2}(x) = \\sum_{j=1}^{2} c_{j}\\varphi_{j}(x) $$\nThe Galerkin method requires the residual of the weak form to be orthogonal to the approximation space $V_{h}$. This means the weak form must hold for $u_{h}$ with test functions restricted to the basis of $V_{h}$: find $(\\lambda_{h}, u_{h})$ such that for $i=1,2$,\n$$ a(u_{h}, \\varphi_{i}) = \\lambda_{h} m(u_{h}, \\varphi_{i}) $$\nSubstituting the expansion for $u_h$:\n$$ a\\left(\\sum_{j=1}^{2} c_{j}\\varphi_{j}, \\varphi_{i}\\right) = \\lambda_{h} m\\left(\\sum_{j=1}^{2} c_{j}\\varphi_{j}, \\varphi_{i}\\right) $$\nBy linearity of the forms, this becomes a system of two linear equations ($i=1,2$):\n$$ \\sum_{j=1}^{2} c_{j} a(\\varphi_{j}, \\varphi_{i}) = \\lambda_{h} \\sum_{j=1}^{2} c_{j} m(\\varphi_{j}, \\varphi_{i}) $$\nUsing the definitions $\\mathbf{K}_{ij} = a(\\varphi_{i}, \\varphi_{j})$ and $\\mathbf{M}_{ij} = m(\\varphi_{i}, \\varphi_{j})$, and exploiting the symmetry of the forms ($a(u,v)=a(v,u)$ and $m(u,v)=m(v,u)$), we can write this system in matrix form:\n$$ \\mathbf{K}\\mathbf{c} = \\lambda_{h}\\mathbf{M}\\mathbf{c} $$\nwhere $\\mathbf{c}=[c_{1}, c_{2}]^{T}$. This is the generalized matrix eigenvalue problem, establishing the equivalence between the Rayleigh-Ritz formulation and the Galerkin method.\n\nNow, we compute the matrices $\\mathbf{K}$ and $\\mathbf{M}$. The basis functions are $\\varphi_{1}(x) = \\sin(\\pi x)$ and $\\varphi_{2}(x) = \\sin(2\\pi x)$, with derivatives $\\varphi'_{1}(x) = \\pi\\cos(\\pi x)$ and $\\varphi'_{2}(x) = 2\\pi\\cos(2\\pi x)$.\nThe entries of the mass matrix $\\mathbf{M}$ are:\n$$ \\mathbf{M}_{ij} = \\int_{0}^{1} \\sin(i\\pi x) \\sin(j\\pi x) \\,\\mathrm{d}x $$\nDue to the orthogonality of sine functions on the interval $[0,1]$, $\\int_{0}^{1} \\sin(k\\pi x)\\sin(l\\pi x)\\,\\mathrm{d}x = \\frac{1}{2}\\delta_{kl}$, where $\\delta_{kl}$ is the Kronecker delta.\n$$ \\mathbf{M}_{11} = \\int_{0}^{1} \\sin^{2}(\\pi x)\\,\\mathrm{d}x = \\frac{1}{2} $$\n$$ \\mathbf{M}_{22} = \\int_{0}^{1} \\sin^{2}(2\\pi x)\\,\\mathrm{d}x = \\frac{1}{2} $$\n$$ \\mathbf{M}_{12} = \\mathbf{M}_{21} = \\int_{0}^{1} \\sin(\\pi x)\\sin(2\\pi x)\\,\\mathrm{d}x = 0 $$\nThus, the mass matrix is $\\mathbf{M} = \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1/2 \\end{pmatrix}$.\nThe entries of the stiffness matrix $\\mathbf{K}$ are:\n$$ \\mathbf{K}_{ij} = \\int_{0}^{1} \\varphi'_{i}(x)\\varphi'_{j}(x)\\,\\mathrm{d}x = (i\\pi)(j\\pi) \\int_{0}^{1} \\cos(i\\pi x)\\cos(j\\pi x)\\,\\mathrm{d}x $$\nCosine functions are also orthogonal on $[0,1]$: $\\int_{0}^{1} \\cos(k\\pi x)\\cos(l\\pi x)\\,\\mathrm{d}x = \\frac{1}{2}\\delta_{kl}$ for integers $k,l \\ge 1$.\n$$ \\mathbf{K}_{11} = \\pi^2 \\int_{0}^{1} \\cos^{2}(\\pi x)\\,\\mathrm{d}x = \\pi^2 \\left(\\frac{1}{2}\\right) = \\frac{\\pi^2}{2} $$\n$$ \\mathbf{K}_{22} = (2\\pi)^2 \\int_{0}^{1} \\cos^{2}(2\\pi x)\\,\\mathrm{d}x = 4\\pi^2\\left(\\frac{1}{2}\\right) = 2\\pi^2 $$\n$$ \\mathbf{K}_{12} = \\mathbf{K}_{21} = (\\pi)(2\\pi) \\int_{0}^{1} \\cos(\\pi x)\\cos(2\\pi x)\\,\\mathrm{d}x = 2\\pi^2(0) = 0 $$\nThus, the stiffness matrix is $\\mathbf{K} = \\begin{pmatrix} \\pi^2/2 & 0 \\\\ 0 & 2\\pi^2 \\end{pmatrix}$.\n\nPart 3: Solution of the Generalized Eigenvalue Problem\nWe must solve $\\mathbf{K}\\mathbf{c} = \\lambda_{h}\\mathbf{M}\\mathbf{c}$:\n$$ \\begin{pmatrix} \\pi^2/2 & 0 \\\\ 0 & 2\\pi^2 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = \\lambda_{h} \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1/2 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} $$\nSince both matrices are diagonal, the system decouples into two independent equations:\nFor the first eigenvalue (with $\\mathbf{c}=[1,0]^T$):\n$$ \\frac{\\pi^2}{2} c_1 = \\lambda_{h,1} \\frac{1}{2} c_1 \\implies \\lambda_{h,1} = \\pi^2 $$\nFor the second eigenvalue (with $\\mathbf{c}=[0,1]^T$):\n$$ 2\\pi^2 c_2 = \\lambda_{h,2} \\frac{1}{2} c_2 \\implies \\lambda_{h,2} = 4\\pi^2 $$\nThe two approximate eigenvalues, ordered by magnitude, are $\\lambda_{h,1} = \\pi^2$ and $\\lambda_{h,2} = 4\\pi^2$.\n\nPart 4: Comparison with Exact Solution\nThe exact analytical solution to the strong form $-u''=\\lambda u$ with $u(0)=u(1)=0$ is found by solving the ordinary differential equation. The general solution is $u(x) = A\\sin(\\sqrt{\\lambda}x) + B\\cos(\\sqrt{\\lambda}x)$.\nThe condition $u(0)=0$ implies $B\\cos(0)=0 \\implies B=0$.\nThe condition $u(1)=0$ implies $A\\sin(\\sqrt{\\lambda})=0$. For a non-trivial solution ($u \\neq 0$), we must have $A \\neq 0$, which requires $\\sin(\\sqrt{\\lambda})=0$. This is satisfied when $\\sqrt{\\lambda}=k\\pi$ for any integer $k \\ge 1$.\nThe exact eigenvalues are therefore $\\lambda_{k} = (k\\pi)^2 = k^2\\pi^2$ for $k=1, 2, 3, \\dots$.\nThe corresponding exact eigenfunctions are $u_{k}(x) = \\sin(k\\pi x)$.\nThe first two exact eigenvalues are $\\lambda_{1} = \\pi^2$ and $\\lambda_{2} = 4\\pi^2$.\nComparing the approximations with the exact values:\n- Approximate smallest eigenvalue: $\\lambda_{h,1} = \\pi^2$. Exact smallest eigenvalue: $\\lambda_{1} = \\pi^2$. They are identical.\n- Approximate second eigenvalue: $\\lambda_{h,2} = 4\\pi^2$. Exact second eigenvalue: $\\lambda_{2} = 4\\pi^2$. They are also identical.\nThe Rayleigh-Ritz approximations are not merely approximations in this case; they are exact. This is a direct consequence of the choice of the approximation subspace $V_{h}$. The basis functions chosen for $V_{h}$, $\\varphi_{1}(x)=\\sin(\\pi x)$ and $\\varphi_{2}(x)=\\sin(2\\pi x)$, are precisely the first two exact eigenfunctions of the original differential operator. The Rayleigh-Ritz method finds the best possible solution within the given subspace. Since the exact solutions are elements of the subspace, the method correctly identifies them, leading to the exact eigenvalues.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\pi^{2} & 4\\pi^{2}\n\\end{pmatrix}\n}\n$$", "id": "2610000"}]}