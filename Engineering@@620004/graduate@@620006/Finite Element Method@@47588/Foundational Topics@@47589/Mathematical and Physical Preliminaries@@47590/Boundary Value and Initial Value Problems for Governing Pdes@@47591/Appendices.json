{"hands_on_practices": [{"introduction": "Real-world engineering and physics problems often require specifying non-zero values at the boundaries, known as inhomogeneous Dirichlet conditions. A robust and common technique to handle these is the \"lifting\" strategy, which reformulates the problem for a new unknown function that satisfies homogeneous conditions. This practice will guide you through the derivation of how lifting modifies the right-hand side of the discrete system, solidifying your understanding of how essential boundary conditions are incorporated into the finite element framework [@problem_id:2543141].", "problem": "Consider the scalar diffusion model problem governed by the Partial Differential Equation (PDE)\n$$-\\,\\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right)=f \\quad \\text{in } \\Omega=(0,1),$$\nwith mixed boundary conditions\n$$u=g_{D}\\ \\text{on}\\ \\Gamma_{D}=\\{0\\}, \\qquad k\\,\\frac{du}{dx}=g_{N}\\ \\text{on}\\ \\Gamma_{N}=\\{1\\}.$$\nUse the Galerkin Finite Element Method (FEM) with trial and test space built from continuous, piecewise-linear functions on a single element mesh with nodes at $x=0$ and $x=1$. Let the discrete essential boundary condition be enforced via a lifting strategy: select a discrete lifting $u_{L}$ such that $u_{L}(0)=g_{D}$ and $u_{L}(1)=0$, and write $u_{h}=w_{h}+u_{L}$ with $w_{h}$ vanishing on $\\Gamma_{D}$. Starting from the variational statement obtained from integration by parts and the fundamental definition of the bilinear and linear forms, derive how the presence of $u_{L}$ modifies the right-hand side of the reduced discrete system for $w_{h}$.\n\nThen apply your derivation to the concrete data\n$$k=3,\\qquad f(x)=4,\\qquad g_{N}=5,\\qquad g_{D}=2,$$\non the single-element mesh with the standard nodal basis $\\{N_{1},N_{2}\\}$, where $N_{1}(x)=1-x$ and $N_{2}(x)=x$. Choose the lifting $u_{L}(x)=g_{D}\\,N_{1}(x)$. Using the single free basis function $N_{2}$ as test function, compute the resulting scalar modified right-hand side entry for the reduced one-degree-of-freedom system associated with $w_{h}$.\n\nExpress your final answer as a single real number. No rounding is required.", "solution": "The problem requires the derivation of the modified right-hand side of a Finite Element Method (FEM) system when using a lifting strategy for a non-homogeneous Dirichlet boundary condition, and then to compute this modified term for a specific case.\n\nThe governing Partial Differential Equation (PDE), or strong form of the problem, is:\n$$-\\frac{d}{dx}\\left(k\\,\\frac{du}{dx}\\right) = f \\quad \\text{for } x \\in \\Omega = (0,1)$$\nwith the mixed boundary conditions:\n$$u(0) = g_{D} \\quad (\\text{Essential/Dirichlet})$$\n$$k\\,\\frac{du}{dx}(1) = g_{N} \\quad (\\text{Natural/Neumann})$$\nTo derive the variational (or weak) formulation, we multiply the PDE by a test function $v$ from a suitable space of test functions $V$ and integrate over the domain $\\Omega$:\n$$-\\int_{0}^{1} v\\,\\frac{d}{dx}\\left(k\\,\\frac{du}{dx}\\right) dx = \\int_{0}^{1} v f dx$$\nApplying integration by parts to the left-hand side gives:\n$$\\int_{0}^{1} \\frac{dv}{dx} k \\frac{du}{dx} dx - \\left[v k \\frac{du}{dx}\\right]_{0}^{1} = \\int_{0}^{1} v f dx$$\nThe space of test functions $V$ is chosen such that its members vanish at locations where essential boundary conditions are specified. In this case, $v(0)=0$. The boundary term evaluates to:\n$$\\left[v k \\frac{du}{dx}\\right]_{0}^{1} = v(1) k \\frac{du}{dx}(1) - v(0) k \\frac{du}{dx}(0) = v(1) g_{N} - 0 = v(1) g_{N}$$\nSubstituting this back, the variational problem is: Find $u$ such that $u(0)=g_D$ and for all test functions $v$ with $v(0)=0$, the following holds:\n$$\\int_{0}^{1} k \\frac{du}{dx} \\frac{dv}{dx} dx = \\int_{0}^{1} v f dx + v(1) g_{N}$$\nThis is often written in abstract form as $a(u, v) = l(v)$, where $a(u,v)$ is the bilinear form and $l(v)$ is the linear functional.\n\nIn the Galerkin FEM, we seek an approximate solution $u_h$ in a finite-dimensional trial space $S_h$, and we test against functions $v_h$ from a finite-dimensional test space $V_h$. For this problem, both spaces are built from continuous, piecewise-linear functions. The essential boundary condition $u(0)=g_D$ is enforced using a lifting strategy. We decompose the discrete solution $u_h$ as:\n$$u_h = w_h + u_L$$\nHere, $u_L$ is a known lifting function that satisfies the non-homogeneous essential boundary condition, $u_L(0) = g_D$. The function $w_h$ is the unknown part of the solution and belongs to the discrete test space $V_h$, which consists of functions vanishing on the Dirichlet boundary $\\Gamma_D$. Thus, $w_h(0)=0$.\n\nSubstituting the decomposition $u_h = w_h + u_L$ into the variational form, with a discrete test function $v_h \\in V_h$:\n$$\\int_{0}^{1} k \\frac{d(w_h + u_L)}{dx} \\frac{dv_h}{dx} dx = \\int_{0}^{1} v_h f dx + v_h(1) g_{N}$$\nUsing the linearity of the derivative and the integral, we separate the terms on the left-hand side:\n$$\\int_{0}^{1} k \\frac{dw_h}{dx} \\frac{dv_h}{dx} dx + \\int_{0}^{1} k \\frac{du_L}{dx} \\frac{dv_h}{dx} dx = \\int_{0}^{1} v_h f dx + v_h(1) g_{N}$$\nThe problem for the unknown function $w_h \\in V_h$ is to find it such that for all $v_h \\in V_h$:\n$$\\int_{0}^{1} k \\frac{dw_h}{dx} \\frac{dv_h}{dx} dx = \\int_{0}^{1} v_h f dx + v_h(1) g_{N} - \\int_{0}^{1} k \\frac{du_L}{dx} \\frac{dv_h}{dx} dx$$\nThis equation is of the form $a(w_h, v_h) = l_{mod}(v_h)$. The bilinear form $a(w_h, v_h)$ constitutes the left-hand side (stiffness matrix), while the modified linear functional $l_{mod}(v_h)$ constitutes the right-hand side (load vector). The presence of the lifting function $u_L$ modifies the original right-hand side by introducing the term $-\\int_{0}^{1} k \\frac{du_L}{dx} \\frac{dv_h}{dx} dx$. This completes the derivation part of the problem.\n\nNow, we apply this to the given data:\n- Constants: $k=3$, $f(x)=4$, $g_{N}=5$, $g_{D}=2$.\n- Mesh: A single element on $\\Omega=(0,1)$ with nodes at $x=0$ and $x=1$.\n- Nodal basis functions: $N_1(x) = 1-x$ and $N_2(x) = x$.\n- Their derivatives are: $\\frac{dN_1}{dx} = -1$ and $\\frac{dN_2}{dx} = 1$.\n- Lifting function: $u_L(x) = g_D N_1(x) = 2(1-x)$.\n- The derivative of the lifting function is: $\\frac{du_L}{dx} = 2 \\frac{dN_1}{dx} = 2(-1) = -2$.\n\nThe unknown function $w_h$ must vanish at $x=0$, so it must be a multiple of $N_2(x)$. The trial space for $w_h$ is $V_h = \\text{span}\\{N_2\\}$. The reduced system for $w_h$ has a single degree of freedom. To find the corresponding entry in the right-hand side vector, we must use the basis function for this degree of freedom, $N_2(x)$, as the test function, i.e., $v_h = N_2(x)$.\n\nThe modified right-hand side entry is $l_{mod}(N_2)$:\n$$l_{mod}(N_2) = \\int_{0}^{1} N_2(x) f(x) dx + N_2(1) g_{N} - \\int_{0}^{1} k \\frac{d N_2}{dx} \\frac{du_L}{dx} dx$$\nWe compute each term separately:\n1. Contribution from the source term $f(x)$:\n$$\\int_{0}^{1} N_2(x) f(x) dx = \\int_{0}^{1} x \\cdot 4 dx = 4 \\left[ \\frac{x^2}{2} \\right]_{0}^{1} = 4 \\left( \\frac{1^2}{2} - 0 \\right) = 2$$\n2. Contribution from the Neumann boundary condition $g_N$:\n$$N_2(1) g_{N} = 1 \\cdot 5 = 5$$\n3. Contribution from the lifting function $u_L$:\n$$- \\int_{0}^{1} k \\frac{d N_2}{dx} \\frac{du_L}{dx} dx = - \\int_{0}^{1} 3 \\cdot (1) \\cdot (-2) dx = - \\int_{0}^{1} (-6) dx = 6 \\int_{0}^{1} dx = 6[x]_0^1 = 6$$\n\nSumming these contributions gives the total value of the modified right-hand side entry:\n$$l_{mod}(N_2) = 2 + 5 + 6 = 13$$\nThis is the single scalar value for the right-hand side of the reduced one-degree-of-freedom system for $w_h$.", "answer": "$$\\boxed{13}$$", "id": "2543141"}, {"introduction": "Moving beyond the enforcement of prescribed values, this exercise explores the fundamental mathematical structure of problems with \"natural\" or Neumann boundary conditions, such as insulated surfaces in heat transfer. You will investigate why the pure Neumann problem for the Laplacian operator is unique, giving rise to a zero eigenvalue and a non-unique solution that is determined only up to a constant [@problem_id:2543145]. Understanding these spectral properties is critical for correctly formulating and solving a wide range of physical problems and interpreting the singularity of the resulting stiffness matrix.", "problem": "Consider the scalar Laplace operator on a bounded, connected, Lipschitz domain $\\Omega \\subset \\mathbb{R}^d$ with outward unit normal $\\boldsymbol{n}$. Let $-\\Delta$ denote the negative Laplacian. Study the eigenvalue problem with homogeneous Neumann boundary conditions: find $\\lambda \\in \\mathbb{R}$ and a nontrivial $u$ such that\n$$\n-\\Delta u = \\lambda\\, u \\quad \\text{in } \\Omega,\\qquad \\frac{\\partial u}{\\partial \\boldsymbol{n}}= \\boldsymbol{n}\\cdot \\nabla u = 0 \\quad \\text{on } \\partial \\Omega.\n$$\nAssume the standard variational setting in the Sobolev space $H^1(\\Omega)$ with the $L^2(\\Omega)$ inner product and norm. In the context of the finite element method using a conforming $H^1$-approximation space spanned by continuous, piecewise-polynomial basis functions $\\{\\varphi_i\\}_{i=1}^N$ forming a partition of unity, consider the usual stiffness matrix $\\mathbf{K}$ with entries $K_{ij}=\\int_{\\Omega} \\nabla \\varphi_i \\cdot \\nabla \\varphi_j\\, dx$ and the mass matrix $\\mathbf{M}$ with entries $M_{ij}=\\int_{\\Omega} \\varphi_i \\varphi_j\\, dx$.\n\nSelect all statements that are correct regarding how Neumann boundary conditions change the spectrum, including the presence of a zero eigenvalue, and how this affects normalization and uniqueness of eigenfunctions, both in the continuous and finite element settings.\n\nA. For the Neumann eigenvalue problem on a bounded, connected $\\Omega$, $\\lambda=0$ is an eigenvalue with eigenspace consisting of the constant functions, and all other eigenvalues are strictly positive.\n\nB. For eigenfunctions corresponding to distinct Neumann eigenvalues, $L^2(\\Omega)$-orthogonality holds; furthermore, if $\\lambda0$, then the associated eigenfunctions have zero mean, i.e., $\\int_{\\Omega} u\\, dx = 0$.\n\nC. For the Poisson problem with pure Neumann boundary conditions,\n$$\n-\\Delta u = f \\ \\text{in } \\Omega,\\qquad \\frac{\\partial u}{\\partial \\boldsymbol{n}}=0 \\ \\text{on } \\partial \\Omega,\n$$\nthere exists a unique solution $u \\in H^1(\\Omega)$ for every $f\\in L^2(\\Omega)$, with no further conditions.\n\nD. In a conforming finite element discretization of the Neumann Laplacian, the stiffness matrix $\\mathbf{K}$ is singular. To compute nonzero eigenpairs or to make the discrete Poisson solution unique, one commonly imposes the zero-mean constraint $\\int_{\\Omega} u_h\\, dx = 0$, equivalently $\\mathbf{1}^\\top \\mathbf{M}\\mathbf{u} = 0$ where $\\mathbf{1}$ is the coefficient vector of the discrete constant function, thus removing the nullspace of constants.\n\nE. For the Neumann heat equation $u_t - \\Delta u = 0$ in $\\Omega$ with $\\frac{\\partial u}{\\partial \\boldsymbol{n}}=0$ on $\\partial\\Omega$, the total mass $\\int_{\\Omega} u(x,t)\\, dx$ is conserved in time, and if $\\Omega$ is connected then $u(\\cdot,t)$ converges in $L^2(\\Omega)$ as $t\\to \\infty$ to the constant equal to the initial mean value.\n\nChoose all that apply. Explain your reasoning from first principles, starting from the definitions of weak formulation, integration by parts, and basic properties of symmetric operators, without assuming any pre-tabulated spectral formulas or relying on unproven coercivity that fails for pure Neumann conditions.", "solution": "The problem as stated is mathematically sound and well-posed. We shall proceed by analyzing the governing equations from first principles.\n\nThe weak formulation of the eigenvalue problem $-\\Delta u = \\lambda u$ in $\\Omega$ with $\\frac{\\partial u}{\\partial \\boldsymbol{n}} = 0$ on $\\partial\\Omega$ is derived by multiplying the PDE by a test function $v \\in H^1(\\Omega)$ and integrating over the domain $\\Omega$. This yields:\n$$ -\\int_{\\Omega} (\\Delta u) v \\, dx = \\lambda \\int_{\\Omega} u v \\, dx $$\nApplying Green's first identity, which is a form of integration by parts, we have:\n$$ \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx - \\int_{\\partial\\Omega} (\\boldsymbol{n} \\cdot \\nabla u) v \\, dS = \\lambda \\int_{\\Omega} u v \\, dx $$\nThe homogeneous Neumann boundary condition $\\boldsymbol{n} \\cdot \\nabla u = \\frac{\\partial u}{\\partial \\boldsymbol{n}} = 0$ eliminates the boundary integral. Thus, the weak formulation is to find a non-trivial $u \\in H^1(\\Omega)$ and $\\lambda \\in \\mathbb{R}$ such that for all $v \\in H^1(\\Omega)$:\n$$ a(u, v) \\equiv \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx = \\lambda (u, v)_{L^2} \\equiv \\lambda \\int_{\\Omega} u v \\, dx $$\nThe bilinear form $a(\\cdot, \\cdot)$ is the inner product on the homogeneous Sobolev space $\\dot{H}^1(\\Omega)$, and $(\\cdot,\\cdot)_{L^2}$ is the standard $L^2(\\Omega)$ inner product. We now evaluate each statement.\n\n**Analysis of Statement A:**\nFor the Neumann eigenvalue problem on a bounded, connected $\\Omega$, $\\lambda=0$ is an eigenvalue with eigenspace consisting of the constant functions, and all other eigenvalues are strictly positive.\n\nTo investigate the possibility of a zero eigenvalue, we set $\\lambda=0$ in the weak formulation:\n$$ a(u, v) = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx = 0 \\quad \\forall v \\in H^1(\\Omega) $$\nChoosing the test function $v = u$, we obtain:\n$$ a(u, u) = \\int_{\\Omega} |\\nabla u|^2 \\, dx = 0 $$\nThis equality implies that $\\nabla u = \\mathbf{0}$ almost everywhere in $\\Omega$. Since the domain $\\Omega$ is given as connected, a function with a zero gradient must be a constant, i.e., $u(x) = c$ for some $c \\in \\mathbb{R}$. For an eigenfunction to be non-trivial, we require $u \\neq 0$, so $c \\neq 0$. Thus, any non-zero constant function is an eigenfunction corresponding to the eigenvalue $\\lambda=0$. The eigenspace for $\\lambda=0$ is the one-dimensional space of constant functions.\n\nNow, consider any eigenpair $(\\lambda, u)$. By setting $v=u$ in the weak formulation, we obtain the Rayleigh quotient for the eigenvalue:\n$$ \\lambda = \\frac{a(u, u)}{(u, u)_{L^2}} = \\frac{\\int_{\\Omega} |\\nabla u|^2 \\, dx}{\\int_{\\Omega} u^2 \\, dx} $$\nThe denominator is strictly positive for a non-trivial eigenfunction $u$. The numerator is always non-negative. Therefore, all eigenvalues must be non-negative, $\\lambda \\ge 0$. We have already shown that $\\lambda=0$ if and only if $u$ is a constant function. For any non-constant eigenfunction, $\\int_{\\Omega} |\\nabla u|^2 \\, dx  0$, which implies that the corresponding eigenvalue $\\lambda$ must be strictly positive.\nThe statement is completely consistent with this derivation.\n\nVerdict: **Correct**.\n\n**Analysis of Statement B:**\nFor eigenfunctions corresponding to distinct Neumann eigenvalues, $L^2(\\Omega)$-orthogonality holds; furthermore, if $\\lambda0$, then the associated eigenfunctions have zero mean, i.e., $\\int_{\\Omega} u\\, dx = 0$.\n\nLet $(\\lambda_1, u_1)$ and $(\\lambda_2, u_2)$ be two eigenpairs with $\\lambda_1 \\neq \\lambda_2$. From the weak formulation, we have:\n$1.$ $a(u_1, u_2) = \\lambda_1 (u_1, u_2)_{L^2}$\n$2.$ $a(u_2, u_1) = \\lambda_2 (u_2, u_1)_{L^2}$\nThe bilinear form $a(\\cdot, \\cdot)$ is symmetric, as is the $L^2$ inner product. Therefore, $a(u_1, u_2) = a(u_2, u_1)$, which gives:\n$$ \\lambda_1 (u_1, u_2)_{L^2} = \\lambda_2 (u_1, u_2)_{L^2} \\implies (\\lambda_1 - \\lambda_2) (u_1, u_2)_{L^2} = 0 $$\nSince $\\lambda_1 \\neq \\lambda_2$, it must be that $(u_1, u_2)_{L^2} = \\int_{\\Omega} u_1 u_2 \\, dx = 0$. This proves the $L^2$-orthogonality of eigenfunctions for distinct eigenvalues.\n\nFor the second part of the statement, consider an eigenfunction $u$ corresponding to an eigenvalue $\\lambda  0$. From statement A, we know that the constant function $u_0(x) = 1$ is an eigenfunction for the eigenvalue $\\lambda_0 = 0$. Since $\\lambda  0 \\neq \\lambda_0$, the eigenfunction $u$ must be $L^2$-orthogonal to the eigenfunction $u_0(x) = 1$:\n$$ (u, u_0)_{L^2} = \\int_{\\Omega} u(x) \\cdot 1 \\, dx = \\int_{\\Omega} u(x) \\, dx = 0 $$\nThis shows that any eigenfunction corresponding to a strictly positive eigenvalue must have a zero mean. This can also be seen directly from the weak form by choosing the test function $v=1$. Since $\\nabla v = \\nabla 1 = \\mathbf{0}$, the left hand side $a(u,1)$ is zero, which implies $\\lambda \\int_\\Omega u \\cdot 1 \\, dx = 0$. For $\\lambda  0$, the integral must be zero.\n\nVerdict: **Correct**.\n\n**Analysis of Statement C:**\nFor the Poisson problem with pure Neumann boundary conditions, $-\\Delta u = f$ in $\\Omega$, $\\frac{\\partial u}{\\partial \\boldsymbol{n}}=0$ on $\\partial\\Omega$, there exists a unique solution $u \\in H^1(\\Omega)$ for every $f\\in L^2(\\Omega)$, with no further conditions.\n\nThis statement is incorrect for two fundamental reasons.\nFirst, a compatibility condition on the source term $f$ is required for a solution to exist. To show this, we integrate the PDE over the domain $\\Omega$:\n$$ \\int_{\\Omega} f \\, dx = \\int_{\\Omega} (-\\Delta u) \\, dx $$\nApplying the divergence theorem (or Green's first identity with $v=1$):\n$$ \\int_{\\Omega} f \\, dx = -\\int_{\\partial\\Omega} \\boldsymbol{n} \\cdot \\nabla u \\, dS = -\\int_{\\partial\\Omega} \\frac{\\partial u}{\\partial \\boldsymbol{n}} \\, dS $$\nWith the boundary condition $\\frac{\\partial u}{\\partial \\boldsymbol{n}}=0$, the boundary integral vanishes, leading to the necessary condition:\n$$ \\int_{\\Omega} f \\, dx = 0 $$\nThe problem is solvable only if the source term $f$ has a zero mean. The statement that a solution exists \"for every $f \\in L^2(\\Omega)$\" is false.\n\nSecond, if a solution $u$ exists, it is not unique. The null space of the Neumann-Laplacian operator is the space of constant functions. If $u$ is a solution, then for any constant $c \\in \\mathbb{R}$, the function $u+c$ is also a solution because $\\nabla(u+c) = \\nabla u$. Therefore, uniqueness is only achieved up to an additive constant. To obtain a unique solution, an additional constraint, such as $\\int_{\\Omega} u \\, dx = 0$, must be imposed.\n\nVerdict: **Incorrect**.\n\n**Analysis of Statement D:**\nIn a conforming finite element discretization of the Neumann Laplacian, the stiffness matrix $\\mathbf{K}$ is singular. To compute nonzero eigenpairs or to make the discrete Poisson solution unique, one commonly imposes the zero-mean constraint $\\int_{\\Omega} u_h\\, dx = 0$, equivalently $\\mathbf{1}^\\top \\mathbf{M}\\mathbf{u} = 0$ where $\\mathbf{1}$ is the coefficient vector of the discrete constant function, thus removing the nullspace of constants.\n\nLet $u_h = \\sum_{j=1}^N u_j \\varphi_j$ be a finite element function. The basis functions $\\{\\varphi_i\\}$ form a partition of unity, meaning $\\sum_{i=1}^N \\varphi_i(x) = 1$ for all $x \\in \\Omega$. The constant function $1$ can thus be represented exactly in the finite element space with the coefficient vector $\\mathbf{1} = [1, 1, \\dots, 1]^\\top$.\nThe stiffness matrix entry is $K_{ij} = \\int_{\\Omega} \\nabla \\varphi_i \\cdot \\nabla \\varphi_j \\, dx$. Let us compute the product of $\\mathbf{K}$ with the vector $\\mathbf{1}$:\n$$ (\\mathbf{K}\\mathbf{1})_i = \\sum_{j=1}^N K_{ij} \\cdot 1 = \\sum_{j=1}^N \\int_{\\Omega} \\nabla\\varphi_i \\cdot \\nabla\\varphi_j \\, dx = \\int_{\\Omega} \\nabla\\varphi_i \\cdot \\left( \\sum_{j=1}^N \\nabla\\varphi_j \\right) \\, dx $$\nUsing the partition of unity property:\n$$ \\sum_{j=1}^N \\nabla\\varphi_j = \\nabla \\left( \\sum_{j=1}^N \\varphi_j \\right) = \\nabla(1) = \\mathbf{0} $$\nTherefore, $(\\mathbf{K}\\mathbf{1})_i = 0$ for all $i$, which means $\\mathbf{K}\\mathbf{1} = \\mathbf{0}$. Since $\\mathbf{1}$ is a non-zero vector, $\\mathbf{K}$ has a non-trivial null space and is thus singular. This is the discrete manifestation of the $\\lambda=0$ eigenvalue.\n\nTo make the solution of the discrete Poisson problem $\\mathbf{K}\\mathbf{u} = \\mathbf{f}$ unique, one must remove the ambiguity associated with the null space. A standard method is to enforce a zero-mean constraint on the solution $u_h$: $\\int_{\\Omega} u_h \\, dx = 0$. Let's verify the matrix form of this constraint.\n$$ \\int_{\\Omega} u_h \\, dx = \\int_{\\Omega} \\left(\\sum_j u_j \\varphi_j(x)\\right) \\, dx = \\sum_j u_j \\int_{\\Omega} \\varphi_j(x) \\, dx $$\nNow consider the expression $\\mathbf{1}^\\top \\mathbf{M}\\mathbf{u}$. With $\\mathbf{1} = [1, \\dots, 1]^\\top$:\n$$ \\mathbf{1}^\\top \\mathbf{M}\\mathbf{u} = \\sum_i (\\mathbf{M}\\mathbf{u})_i = \\sum_i \\sum_j M_{ij} u_j = \\sum_i \\sum_j \\left( \\int_{\\Omega} \\varphi_i \\varphi_j \\, dx \\right) u_j $$\nRearranging the sums:\n$$ \\sum_j u_j \\left( \\sum_i \\int_{\\Omega} \\varphi_i \\varphi_j \\, dx \\right) = \\sum_j u_j \\int_{\\Omega} \\left( \\sum_i \\varphi_i \\right) \\varphi_j \\, dx $$\nUsing the partition of unity property $\\sum_i \\varphi_i = 1$:\n$$ \\sum_j u_j \\int_{\\Omega} 1 \\cdot \\varphi_j \\, dx = \\sum_j u_j \\int_{\\Omega} \\varphi_j \\, dx $$\nThis is precisely the expression for $\\int_{\\Omega} u_h \\, dx$. So the constraint $\\int_{\\Omega} u_h \\, dx = 0$ is indeed equivalent to $\\mathbf{1}^\\top \\mathbf{M}\\mathbf{u} = 0$. This constraint projects out the null space component from the solution space, ensuring uniqueness for the Poisson problem and allowing solvers for the eigenvalue problem to find the non-zero eigenvalues by working with a modified, non-singular system.\n\nVerdict: **Correct**.\n\n**Analysis of Statement E:**\nFor the Neumann heat equation $u_t - \\Delta u = 0$ in $\\Omega$ with $\\frac{\\partial u}{\\partial \\boldsymbol{n}}=0$ on $\\partial\\Omega$, the total mass $\\int_{\\Omega} u(x,t)\\, dx$ is conserved in time, and if $\\Omega$ is connected then $u(\\cdot,t)$ converges in $L^2(\\Omega)$ as $t\\to \\infty$ to the constant equal to the initial mean value.\n\nLet $M(t) = \\int_{\\Omega} u(x,t) \\, dx$. Differentiating with respect to time gives:\n$$ \\frac{dM}{dt} = \\int_{\\Omega} u_t \\, dx = \\int_{\\Omega} \\Delta u \\, dx $$\nUsing the divergence theorem:\n$$ \\frac{dM}{dt} = \\int_{\\partial\\Omega} \\boldsymbol{n} \\cdot \\nabla u \\, dS = \\int_{\\partial\\Omega} \\frac{\\partial u}{\\partial \\boldsymbol{n}} \\, dS $$\nThe Neumann boundary condition $\\frac{\\partial u}{\\partial \\boldsymbol{n}} = 0$ makes the integral zero. Thus, $\\frac{dM}{dt} = 0$, which implies $M(t)$ is constant. The total \"mass\" or spatial integral of $u$ is conserved.\n\nFor the long-time behavior, we express the solution using separation of variables in terms of the eigenpairs $(\\lambda_k, u_k)$ of the Neumann-Laplacian:\n$$ u(x,t) = \\sum_{k=0}^{\\infty} c_k e^{-\\lambda_k t} u_k(x) $$\nThe initial condition $u(x,0)$ determines the coefficients $c_k = (u(\\cdot,0), u_k)_{L^2}$ (assuming normalized eigenfunctions $||u_k||_{L^2}=1$). As established in A, for a connected domain $\\Omega$, the eigenvalues are ordered $0 = \\lambda_0  \\lambda_1 \\le \\lambda_2 \\le \\dots$. As $t \\to \\infty$, all terms $e^{-\\lambda_k t}$ for $k \\ge 1$ decay to zero, because $\\lambda_k  0$. The only term that survives is the $k=0$ mode:\n$$ \\lim_{t\\to\\infty} u(x,t) = c_0 e^{-\\lambda_0 t} u_0(x) = c_0 u_0(x) $$\nThe eigenfunction for $\\lambda_0=0$ is a constant. The normalized eigenfunction is $u_0(x) = 1/\\sqrt{|\\Omega|}$, where $|\\Omega|$ is the measure of the domain. The coefficient $c_0$ is:\n$$ c_0 = \\int_{\\Omega} u(x,0) u_0(x) \\, dx = \\frac{1}{\\sqrt{|\\Omega|}} \\int_{\\Omega} u(x,0) \\, dx $$\nThe limiting solution is therefore:\n$$ c_0 u_0(x) = \\left( \\frac{1}{\\sqrt{|\\Omega|}} \\int_{\\Omega} u(x,0) \\, dx \\right) \\left( \\frac{1}{\\sqrt{|\\Omega|}} \\right) = \\frac{1}{|\\Omega|} \\int_{\\Omega} u(x,0) \\, dx $$\nThis is the constant function equal to the initial mean value of the solution. The convergence is in the $L^2(\\Omega)$ norm because the squared norm of the difference, $||u(\\cdot,t) - c_0 u_0(\\cdot)||_{L^2}^2 = \\sum_{k=1}^{\\infty} |c_k|^2 e^{-2\\lambda_k t}$, tends to zero as $t \\to \\infty$.\n\nVerdict: **Correct**.", "answer": "$$\\boxed{ABDE}$$", "id": "2543145"}, {"introduction": "Having addressed boundary value problems, we now transition to the dynamic realm of initial value problems, which govern phenomena like wave propagation and structural vibrations. This practice focuses on the celebrated Newmark family of time integrators, a cornerstone of transient analysis [@problem_id:2543112]. By deriving the method and analyzing its properties, you will gain deep insight into the critical concepts of numerical stability and accuracy, learning to select parameters that guarantee a physically meaningful and computationally sound simulation over time.", "problem": "Consider the semidiscrete form of the linear wave equation obtained by a standard Galerkin finite element method: find the vector of nodal unknowns $u(t) \\in \\mathbb{R}^{n}$ such that\n$$\nM \\ddot{u}(t) + K u(t) = f(t), \\quad t \\in (0,T],\n$$\nwith initial conditions $u(0) = u_{0}$ and $\\dot{u}(0) = v_{0}$, where $M \\in \\mathbb{R}^{n \\times n}$ is symmetric positive definite, $K \\in \\mathbb{R}^{n \\times n}$ is symmetric positive semidefinite, and $f(t) \\in \\mathbb{R}^{n}$ is a prescribed load. Let $t_{n} = n h$ denote a uniform partition of $[0,T]$ with time step $h  0$.\n\nStarting only from the kinematic relations $\\dot{u} = v$ and $\\dot{v} = a$ with $a(t) = \\ddot{u}(t)$, derive a one-step time integrator that advances $\\{u_{n}, v_{n}\\}$ to $\\{u_{n+1}, v_{n+1}\\}$ by assuming $a(t)$ is approximated over $[t_{n}, t_{n+1}]$ in a way that is affine in the endpoint values $a_{n}$ and $a_{n+1}$. Your derivation should yield the two-parameter Newmark family with parameters $\\beta$ and $\\gamma$ in the update formulas for $u_{n+1}$ and $v_{n+1}$ and an implicit equilibrium equation to determine $a_{n+1}$.\n\nThen, specialize to the homogeneous case $f \\equiv 0$ and analyze unconditional stability by considering the single-degree-of-freedom modal component governed by\n$$\n\\ddot{w}(t) + \\omega^{2} w(t) = 0,\n$$\nobtained by mass-normalizing the mode, where $\\omega \\ge 0$ is the natural frequency. Form the $2 \\times 2$ amplification matrix that maps $\\begin{pmatrix} w_{n} \\\\ \\dot{w}_{n} \\end{pmatrix}$ to $\\begin{pmatrix} w_{n+1} \\\\ \\dot{w}_{n+1} \\end{pmatrix}$, and determine necessary and sufficient conditions on $(\\beta,\\gamma)$ such that the spectral radius of this amplification matrix is at most $1$ for all nondimensional time steps $\\nu = \\omega h \\in [0,\\infty)$.\n\nNext, determine the condition on $(\\beta,\\gamma)$ required for second-order accuracy in time of the method for smooth solutions, by matching the truncation error through terms of order $h^{2}$ using Taylor expansions of $u(t)$ and $v(t)$ about $t_{n}$.\n\nFinally, under the simultaneous requirements of unconditional stability and second-order accuracy, determine the minimal value of $\\beta$. Provide only this minimal $\\beta$ as your final answer in exact form, with no units and no rounding.", "solution": "We begin with the semidiscrete system\n$$\nM \\ddot{u}(t) + K u(t) = f(t), \\quad \\dot{u}(t) = v(t), \\quad \\dot{v}(t) = a(t) = \\ddot{u}(t).\n$$\nIntegrating the kinematic relations over a single time step $[t_{n}, t_{n+1}]$ of size $h$ gives\n$$\nu_{n+1} = u_{n} + \\int_{t_{n}}^{t_{n+1}} v(t) \\, dt, \\quad\nv_{n+1} = v_{n} + \\int_{t_{n}}^{t_{n+1}} a(t) \\, dt.\n$$\nAssume that $a(t)$ over $[t_{n}, t_{n+1}]$ is approximated by a function affine in $a_{n}$ and $a_{n+1}$, which leads to the standard Newmark family formulas parameterized by $\\beta$ and $\\gamma$:\n$$\nv_{n+1} = v_{n} + h \\left[(1 - \\gamma) a_{n} + \\gamma a_{n+1}\\right],\n$$\n$$\nu_{n+1} = u_{n} + h v_{n} + h^{2} \\left[\\left(\\tfrac{1}{2} - \\beta\\right) a_{n} + \\beta a_{n+1}\\right].\n$$\nThese are closed by the semidiscrete equilibrium evaluated at $t_{n+1}$,\n$$\nM a_{n+1} + K u_{n+1} = f_{n+1},\n$$\nwhich, together with the two update relations, forms an implicit one-step method for $(u_{n+1}, v_{n+1}, a_{n+1})$ from $(u_{n}, v_{n}, a_{n})$.\n\nTo analyze unconditional stability, consider the homogeneous case $f \\equiv 0$ and a single modal component of the decoupled system with unit modal mass,\n$$\n\\ddot{w}(t) + \\omega^{2} w(t) = 0.\n$$\nLet $\\nu = \\omega h$ denote the nondimensional time step. For this scalar oscillator, $a_{n} = \\ddot{w}_{n} = -\\omega^{2} w_{n}$ and $a_{n+1} = -\\omega^{2} w_{n+1}$. Substituting into the Newmark updates yields\n$$\nw_{n+1} = w_{n} + h \\dot{w}_{n} + h^{2} \\left[ \\left(\\tfrac{1}{2} - \\beta \\right)(-\\omega^{2} w_{n}) + \\beta (-\\omega^{2} w_{n+1}) \\right],\n$$\n$$\n\\dot{w}_{n+1} = \\dot{w}_{n} + h \\left[(1 - \\gamma)(-\\omega^{2} w_{n}) + \\gamma (-\\omega^{2} w_{n+1})\\right].\n$$\nRearrange the displacement update to solve for $w_{n+1}$:\n$$\n\\left(1 + \\beta \\nu^{2}\\right) w_{n+1}\n= \\left[ 1 - \\left(\\tfrac{1}{2} - \\beta\\right) \\nu^{2} \\right] w_{n} + h \\dot{w}_{n}.\n$$\nDefine $c := \\left(1 + \\beta \\nu^{2}\\right)^{-1}$. Then\n$$\nw_{n+1} = c \\left[ 1 - \\left(\\tfrac{1}{2} - \\beta\\right) \\nu^{2} \\right] w_{n} + c h \\dot{w}_{n}.\n$$\nSubstitute this into the velocity update to write the one-step map in matrix form\n$$\n\\begin{pmatrix}\nw_{n+1} \\\\ \\dot{w}_{n+1}\n\\end{pmatrix}\n= G(\\nu; \\beta,\\gamma)\n\\begin{pmatrix}\nw_{n} \\\\ \\dot{w}_{n}\n\\end{pmatrix},\n$$\nwith\n$$\nG =\n\\begin{pmatrix}\nA  B \\\\\nC  D\n\\end{pmatrix},\n\\quad\nA = c \\left[ 1 - \\left(\\tfrac{1}{2} - \\beta\\right) \\nu^{2} \\right], \\quad\nB = c h,\n$$\n$$\nC = -\\frac{\\nu^{2}}{h} \\left[ (1 - \\gamma) + \\gamma c \\left( 1 - \\left(\\tfrac{1}{2} - \\beta\\right) \\nu^{2} \\right) \\right], \\quad\nD = 1 - \\gamma c \\nu^{2}.\n$$\nThe characteristic polynomial of $G$ is $\\lambda^{2} - \\tau \\lambda + \\Delta = 0$ with trace $\\tau = A + D$ and determinant $\\Delta = AD - BC$. A direct computation gives\n$$\n\\tau(\\nu) = \\frac{ 2 + \\left( 2 \\beta - \\gamma - \\tfrac{1}{2} \\right) \\nu^{2} }{ 1 + \\beta \\nu^{2} }, \n\\qquad\n\\Delta(\\nu) = \\frac{ 1 + \\left( \\tfrac{1}{2} + \\beta - \\gamma \\right) \\nu^{2} }{ 1 + \\beta \\nu^{2} }.\n$$\nA necessary and sufficient condition for all eigenvalues of $G$ to lie in the closed unit disk for all $\\nu \\ge 0$ (unconditional stability) is the set of Jury (discrete-time) inequalities for the polynomial $\\lambda^{2} - \\tau \\lambda + \\Delta$:\n$$\n1 - \\Delta(\\nu) \\ge 0, \\quad 1 + \\tau(\\nu) + \\Delta(\\nu) \\ge 0, \\quad 1 - \\tau(\\nu) + \\Delta(\\nu) \\ge 0 \\quad \\text{for all } \\nu \\ge 0.\n$$\nUsing the expressions for $\\tau$ and $\\Delta$,\n$$\n1 - \\Delta(\\nu) = \\frac{ (\\gamma - \\tfrac{1}{2}) \\nu^{2} }{ 1 + \\beta \\nu^{2} } \\ge 0 \\quad \\Longleftrightarrow \\quad \\gamma \\ge \\tfrac{1}{2},\n$$\n$$\n1 + \\tau(\\nu) + \\Delta(\\nu) = \\frac{ 4 + 2(2\\beta - \\gamma) \\nu^{2} }{ 1 + \\beta \\nu^{2} } \\ge 0 \\quad \\text{for all } \\nu \\ge 0 \\quad \\Longleftrightarrow \\quad \\beta \\ge \\tfrac{\\gamma}{2},\n$$\n$$\n1 - \\tau(\\nu) + \\Delta(\\nu) = \\frac{ \\nu^{2} }{ 1 + \\beta \\nu^{2} } \\ge 0 \\quad \\text{always}.\n$$\nTherefore, the necessary and sufficient conditions for unconditional stability are\n$$\n\\gamma \\ge \\tfrac{1}{2}, \\qquad \\beta \\ge \\tfrac{\\gamma}{2}.\n$$\n\nNext, we determine the condition for second-order accuracy. Perform Taylor expansions about $t_{n}$ for smooth solutions:\n$$\nu(t_{n+1}) = u_{n} + h v_{n} + \\tfrac{h^{2}}{2} a_{n} + \\tfrac{h^{3}}{6} j_{n} + \\mathcal{O}(h^{4}),\n\\quad\nv(t_{n+1}) = v_{n} + h a_{n} + \\tfrac{h^{2}}{2} j_{n} + \\mathcal{O}(h^{3}),\n$$\nwhere $j_{n} = \\dot{a}(t_{n}) = u^{(3)}(t_{n})$. Also expand $a_{n+1} = a_{n} + h j_{n} + \\mathcal{O}(h^{2})$.\n\nCompare the Newmark velocity update to the exact increment:\n$$\nv_{n+1} - v_{n} = h \\left[ (1 - \\gamma) a_{n} + \\gamma a_{n+1} \\right]\n= h \\left[ a_{n} + \\gamma h j_{n} \\right] + \\mathcal{O}(h^{3}).\n$$\nFor consistency through $\\mathcal{O}(h^{2})$, this must match $h a_{n} + \\tfrac{h^{2}}{2} j_{n}$, which requires\n$$\n\\gamma = \\tfrac{1}{2}.\n$$\nNow compare the displacement update:\n$$\nu_{n+1} - u_{n} - h v_{n} = h^{2} \\left[ \\left(\\tfrac{1}{2} - \\beta\\right) a_{n} + \\beta a_{n+1} \\right]\n= \\tfrac{h^{2}}{2} a_{n} + \\beta h^{3} j_{n} + \\mathcal{O}(h^{4}),\n$$\nwhile the exact increment is $\\tfrac{h^{2}}{2} a_{n} + \\tfrac{h^{3}}{6} j_{n} + \\mathcal{O}(h^{4})$. Matching the $\\mathcal{O}(h^{2})$ term imposes no additional condition on $\\beta$ because the coefficient of $a_{n}$ is exactly $\\tfrac{1}{2}$ for all $\\beta$. Hence, the Newmark family is second-order accurate if and only if\n$\n\\gamma = \\tfrac{1}{2},\n$\nwith no further restriction on $\\beta$ for order.\n\nFinally, impose both unconditional stability and second-order accuracy. Combining $\\gamma \\ge \\tfrac{1}{2}$ and $\\beta \\ge \\tfrac{\\gamma}{2}$ with $\\gamma = \\tfrac{1}{2}$ for second order yields\n$$\n\\beta \\ge \\tfrac{1}{4}.\n$$\nTherefore, the minimal $\\beta$ consistent with unconditional stability and second-order accuracy is\n$$\n\\beta_{\\min} = \\tfrac{1}{4}.\n$$", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "2543112"}]}