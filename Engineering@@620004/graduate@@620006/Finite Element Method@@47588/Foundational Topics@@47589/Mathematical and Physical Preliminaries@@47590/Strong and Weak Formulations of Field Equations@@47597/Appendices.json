{"hands_on_practices": [{"introduction": "The first and most crucial skill in the finite element method is the translation of a differential equation, or 'strong form', into an integral 'weak form'. This process is the foundation upon which the entire method is built. This exercise [@problem_id:2603817] will guide you through this fundamental procedure for a general second-order elliptic problem, demonstrating how integration by parts is used to lower the derivative requirements on the solution and transfer them to a test function. You will also uncover a key connection: how a physical property of the system, the symmetry of the diffusion tensor $\\kappa$, directly translates into the mathematical property of symmetry for the resulting bilinear form.", "problem": "Consider a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{d}$ with $d \\geq 1$ and outward unit normal $\\boldsymbol{n}$ on $\\partial \\Omega$. Let $f \\in L^{2}(\\Omega)$ and let $\\kappa:\\Omega \\to \\mathbb{R}^{d \\times d}$ be a measurable, uniformly elliptic, and essentially bounded matrix field, meaning there exist constants $\\alpha, \\beta \\in \\mathbb{R}$ with $0<\\alpha \\leq \\beta < \\infty$ such that for almost every $x \\in \\Omega$ and every $\\boldsymbol{\\xi} \\in \\mathbb{R}^{d}$ one has $\\alpha |\\boldsymbol{\\xi}|^{2} \\leq \\boldsymbol{\\xi}^{\\top}\\kappa(x)\\boldsymbol{\\xi} \\leq \\beta |\\boldsymbol{\\xi}|^{2}$. Assume that $\\kappa(x)$ is symmetric for almost every $x \\in \\Omega$. Consider the second-order linear elliptic Partial Differential Equation (PDE)\n$$\n-\\nabla \\cdot \\big( \\kappa(x) \\nabla u(x) \\big) = f(x) \\quad \\text{in } \\Omega, \\qquad u(x)=0 \\quad \\text{on } \\partial \\Omega.\n$$\nStarting from the strong form above and using only fundamental results of calculus such as the Gauss–Green divergence theorem and the definition of Sobolev spaces, do the following:\n\n$1.$ Derive the weak formulation of the boundary value problem by identifying appropriate trial and test spaces, transferring derivatives from the unknown solution to the test function via integration by parts, and justifying the vanishing of boundary terms.\n\n$2.$ Identify the bilinear form and the linear functional associated with the weak formulation and state their domains.\n\n$3.$ Using only the symmetry of $\\kappa(x)$ and basic properties of the dot product and transpose, show explicitly how the symmetry of $\\kappa(x)$ induces symmetry of the bilinear form.\n\n$4.$ Finally, compute the expression $a(u,v) - a(v,u)$ for arbitrary $u,v$ in the test space obtained in part $1$, and provide your final simplified expression. Your final answer must be a single closed-form expression. No rounding is required, and no units are to be reported.", "solution": "The problem statement is first subjected to validation.\n\n**Problem Validation**\n\nStep 1: Extract Givens.\n- Domain: A bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{d}$ with $d \\geq 1$.\n- Boundary unit normal: $\\boldsymbol{n}$ is the outward unit normal on $\\partial \\Omega$.\n- Source term: $f \\in L^{2}(\\Omega)$.\n- Diffusion tensor: $\\kappa:\\Omega \\to \\mathbb{R}^{d \\times d}$ is a measurable, uniformly elliptic, and essentially bounded matrix field.\n- Ellipticity and boundedness constants: $0<\\alpha \\leq \\beta < \\infty$.\n- Uniform ellipticity condition: $\\alpha |\\boldsymbol{\\xi}|^{2} \\leq \\boldsymbol{\\xi}^{\\top}\\kappa(x)\\boldsymbol{\\xi} \\leq \\beta |\\boldsymbol{\\xi}|^{2}$ for almost every $x \\in \\Omega$ and every $\\boldsymbol{\\xi} \\in \\mathbb{R}^{d}$.\n- Symmetry of tensor: $\\kappa(x)$ is symmetric for almost every $x \\in \\Omega$.\n- Partial Differential Equation (Strong Form): $-\\nabla \\cdot \\big( \\kappa(x) \\nabla u(x) \\big) = f(x)$ in $\\Omega$.\n- Boundary Condition: $u(x)=0$ on $\\partial \\Omega$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, well-posed, objective, and self-contained. It presents a standard second-order linear elliptic boundary value problem with homogeneous Dirichlet boundary conditions. The conditions on the domain $\\Omega$, the diffusion tensor $\\kappa$, and the source term $f$ are precisely the standard hypotheses required for the application of the Lax-Milgram theorem, which guarantees the existence and uniqueness of a weak solution in the Sobolev space $H_0^1(\\Omega)$. The problem is free of scientific inaccuracies, ambiguities, and any subjective or non-formalizable content. The tasks are a standard and fundamental exercise in the theory of partial differential equations and the finite element method.\n\nStep 3: Verdict and Action.\nThe problem is valid. I will proceed with a complete solution.\n\n**Solution**\n\n$1.$ Derivation of the weak formulation.\n\nWe begin with the strong form of the partial differential equation:\n$$\n-\\nabla \\cdot \\big( \\kappa(x) \\nabla u(x) \\big) = f(x) \\quad \\text{in } \\Omega.\n$$\nTo derive the weak form, we multiply the equation by a sufficiently smooth test function $v(x)$ that vanishes on the boundary $\\partial \\Omega$ and integrate over the domain $\\Omega$:\n$$\n\\int_{\\Omega} -\\nabla \\cdot \\big( \\kappa \\nabla u \\big) v \\, dx = \\int_{\\Omega} f v \\, dx.\n$$\nThe core idea is to transfer the derivative from the unknown solution $u$ to the test function $v$. We apply the product rule for divergence, which can be expressed as $\\nabla \\cdot (\\boldsymbol{F} \\phi) = (\\nabla \\cdot \\boldsymbol{F}) \\phi + \\boldsymbol{F} \\cdot \\nabla \\phi$. With $\\boldsymbol{F} = \\kappa \\nabla u$ and $\\phi=v$, we have $\\nabla \\cdot (v \\kappa \\nabla u) = (\\nabla \\cdot(\\kappa \\nabla u)) v + (\\kappa \\nabla u) \\cdot \\nabla v$. This implies $-(\\nabla \\cdot(\\kappa \\nabla u)) v = (\\kappa \\nabla u) \\cdot \\nabla v - \\nabla \\cdot (v \\kappa \\nabla u)$. Substituting this into the integral equation gives:\n$$\n\\int_{\\Omega} \\left( (\\kappa \\nabla u) \\cdot \\nabla v - \\nabla \\cdot (v \\kappa \\nabla u) \\right) \\, dx = \\int_{\\Omega} f v \\, dx.\n$$\nBy linearity of the integral, we separate the terms on the left-hand side:\n$$\n\\int_{\\Omega} (\\kappa \\nabla u) \\cdot \\nabla v \\, dx - \\int_{\\Omega} \\nabla \\cdot (v \\kappa \\nabla u) \\, dx = \\int_{\\Omega} f v \\, dx.\n$$\nWe apply the Gauss-Green divergence theorem to the second term, which states that for a sufficiently regular vector field $\\boldsymbol{G}$, $\\int_{\\Omega} \\nabla \\cdot \\boldsymbol{G} \\, dx = \\int_{\\partial \\Omega} \\boldsymbol{G} \\cdot \\boldsymbol{n} \\, dS$. Here, our vector field is $\\boldsymbol{G} = v \\kappa \\nabla u$:\n$$\n\\int_{\\Omega} \\nabla \\cdot (v \\kappa \\nabla u) \\, dx = \\int_{\\partial \\Omega} v (\\kappa \\nabla u) \\cdot \\boldsymbol{n} \\, dS.\n$$\nThis transforms the equation into:\n$$\n\\int_{\\Omega} (\\kappa \\nabla u) \\cdot \\nabla v \\, dx - \\int_{\\partial \\Omega} v (\\kappa \\nabla u) \\cdot \\boldsymbol{n} \\, dS = \\int_{\\Omega} f v \\, dx.\n$$\nNow we must define the appropriate function spaces. For the weak formulation to be well-defined, we need the integrals to be finite. The terms $\\int_{\\Omega} (\\nabla u) \\cdot (\\nabla v) \\, dx$ and $\\int_{\\Omega} f v \\, dx$ suggest that $u$, $v$, and their first derivatives should be in $L^2(\\Omega)$, and $f$ is given to be in $L^2(\\Omega)$. This leads to the Sobolev space $H^1(\\Omega) = \\{w \\in L^2(\\Omega) : \\nabla w \\in [L^2(\\Omega)]^d\\}$. The boundary condition $u=0$ on $\\partial \\Omega$ is enforced by seeking the solution $u$ in the subspace $H_0^1(\\Omega)$, which is the closure of $C_c^\\infty(\\Omega)$ (infinitely differentiable functions with compact support in $\\Omega$) in the $H^1(\\Omega)$ norm. Functions in $H_0^1(\\Omega)$ have a trace of zero on the boundary $\\partial \\Omega$. This space, $H_0^1(\\Omega)$, serves as the **trial space** for the solution $u$. We also choose it as the **test space** for $v$.\n\nWith $v \\in H_0^1(\\Omega)$, its trace on the boundary is zero, i.e., $v=0$ on $\\partial \\Omega$. Consequently, the boundary integral vanishes:\n$$\n\\int_{\\partial \\Omega} v (\\kappa \\nabla u) \\cdot \\boldsymbol{n} \\, dS = 0.\n$$\nThe resulting weak formulation is: Find $u \\in H_0^1(\\Omega)$ such that for all $v \\in H_0^1(\\Omega)$, the following holds:\n$$\n\\int_{\\Omega} (\\kappa(x) \\nabla u(x)) \\cdot \\nabla v(x) \\, dx = \\int_{\\Omega} f(x) v(x) \\, dx.\n$$\n\n$2.$ Identification of the bilinear and linear forms.\n\nThe weak formulation is an equation of the abstract form $a(u,v) = L(v)$. By comparing this to the derived equation, we identify the following:\n\n- The **bilinear form** $a(\\cdot, \\cdot)$ is given by:\n$$\na(u,v) = \\int_{\\Omega} (\\kappa(x) \\nabla u(x)) \\cdot \\nabla v(x) \\, dx.\n$$\nIts domain is $H_0^1(\\Omega) \\times H_0^1(\\Omega)$, so $a: H_0^1(\\Omega) \\times H_0^1(\\Omega) \\to \\mathbb{R}$.\n\n- The **linear functional** $L(\\cdot)$ is given by:\n$$\nL(v) = \\int_{\\Omega} f(x) v(x) \\, dx.\n$$\nIts domain is $H_0^1(\\Omega)$, so $L: H_0^1(\\Omega) \\to \\mathbb{R}$.\n\n$3.$ Symmetry of the bilinear form.\n\nWe are tasked to show that the symmetry of the tensor $\\kappa(x)$ implies the symmetry of the bilinear form $a(u,v)$, i.e., $a(u,v) = a(v,u)$ for all $u, v \\in H_0^1(\\Omega)$.\n\nLet $\\boldsymbol{\\xi} = \\nabla u$ and $\\boldsymbol{\\eta} = \\nabla v$. The bilinear form is $a(u,v) = \\int_{\\Omega} (\\kappa \\boldsymbol{\\xi}) \\cdot \\boldsymbol{\\eta} \\, dx$.\nThe dot product of two vectors $\\boldsymbol{a}$ and $\\boldsymbol{b}$ can be written as $\\boldsymbol{a} \\cdot \\boldsymbol{b} = \\boldsymbol{a}^\\top \\boldsymbol{b}$.\nUsing this, the integrand of $a(u,v)$ is $(\\kappa \\boldsymbol{\\xi}) \\cdot \\boldsymbol{\\eta} = \\boldsymbol{\\eta}^\\top (\\kappa \\boldsymbol{\\xi})$.\nSince this expression is a scalar, it is equal to its own transpose:\n$$\n\\boldsymbol{\\eta}^\\top (\\kappa \\boldsymbol{\\xi}) = (\\boldsymbol{\\eta}^\\top \\kappa \\boldsymbol{\\xi})^\\top.\n$$\nUsing the property of the transpose of a product, $(ABC)^\\top = C^\\top B^\\top A^\\top$, we obtain:\n$$\n(\\boldsymbol{\\eta}^\\top \\kappa \\boldsymbol{\\xi})^\\top = \\boldsymbol{\\xi}^\\top \\kappa^\\top (\\boldsymbol{\\eta}^\\top)^\\top = \\boldsymbol{\\xi}^\\top \\kappa^\\top \\boldsymbol{\\eta}.\n$$\nThus, we have shown that $\\boldsymbol{\\eta}^\\top \\kappa \\boldsymbol{\\xi} = \\boldsymbol{\\xi}^\\top \\kappa^\\top \\boldsymbol{\\eta}$ for any vectors $\\boldsymbol{\\xi}, \\boldsymbol{\\eta}$ and matrix $\\kappa$.\n\nThe problem states that the matrix field $\\kappa(x)$ is symmetric for almost every $x \\in \\Omega$. This means $\\kappa(x)^\\top = \\kappa(x)$ for a.e. $x \\in \\Omega$. Substituting this property, we get:\n$$\n\\boldsymbol{\\xi}(x)^\\top \\kappa(x)^\\top \\boldsymbol{\\eta}(x) = \\boldsymbol{\\xi}(x)^\\top \\kappa(x) \\boldsymbol{\\eta}(x) \\quad \\text{for a.e. } x \\in \\Omega.\n$$\nSo, for a.e. $x \\in \\Omega$, the integrands are equal:\n$$\n(\\kappa(x) \\nabla u(x)) \\cdot \\nabla v(x) = (\\nabla v(x))^\\top \\kappa(x) \\nabla u(x) = (\\nabla u(x))^\\top \\kappa(x)^\\top \\nabla v(x) = (\\nabla u(x))^\\top \\kappa(x) \\nabla v(x).\n$$\nThe expression on the right, $(\\nabla u(x))^\\top \\kappa(x) \\nabla v(x)$, is the integrand for $a(v,u)$:\n$$\na(v,u) = \\int_{\\Omega} (\\kappa(x) \\nabla v(x)) \\cdot \\nabla u(x) \\, dx = \\int_{\\Omega} (\\nabla u(x))^\\top \\kappa(x) \\nabla v(x) \\,dx.\n$$\nSince the integrands are equal almost everywhere on $\\Omega$, their integrals over $\\Omega$ are equal:\n$$\na(u,v) = \\int_{\\Omega} (\\nabla v)^\\top \\kappa \\nabla u \\, dx = \\int_{\\Omega} (\\nabla u)^\\top \\kappa \\nabla v \\, dx = a(v,u).\n$$\nThis explicitly demonstrates that the symmetry of $\\kappa$ induces the symmetry of the bilinear form $a(\\cdot,\\cdot)$.\n\n$4.$ Computation of $a(u,v) - a(v,u)$.\n\nWe are asked to compute the expression $a(u,v) - a(v,u)$ for arbitrary $u,v \\in H_0^1(\\Omega)$.\nBased on the derivation in part $3$, we have already proven that $a(u,v) = a(v,u)$ under the given problem conditions, which include the symmetry of $\\kappa(x)$.\nTherefore, for any choice of $u, v \\in H_0^1(\\Omega)$:\n$$\na(u,v) - a(v,u) = a(u,v) - a(u,v) = 0.\n$$\nTo be explicit, we write out the integrals:\n$$\na(u,v) - a(v,u) = \\int_{\\Omega} (\\kappa \\nabla u) \\cdot \\nabla v \\, dx - \\int_{\\Omega} (\\kappa \\nabla v) \\cdot \\nabla u \\, dx.\n$$\nCombining the terms under a single integral:\n$$\n= \\int_{\\Omega} \\left( (\\kappa \\nabla u) \\cdot \\nabla v - (\\kappa \\nabla v) \\cdot \\nabla u \\right) \\, dx.\n$$\nAs demonstrated in part $3$, the symmetry of $\\kappa$ implies that the two terms in the integrand are equal almost everywhere. Let's write the integrand as $\\mathcal{I}(x) = (\\kappa(x) \\nabla u(x)) \\cdot \\nabla v(x) - (\\kappa(x) \\nabla v(x)) \\cdot \\nabla u(x)$. Using matrix notation for clarity, this is $(\\nabla v)^\\top \\kappa (\\nabla u) - (\\nabla u)^\\top \\kappa (\\nabla v)$. Since $(\\nabla u)^\\top \\kappa (\\nabla v)$ is a scalar, it equals its transpose, which is $(\\nabla v)^\\top \\kappa^\\top (\\nabla u)$. Thus the integrand is $(\\nabla v)^\\top \\kappa (\\nabla u) - (\\nabla v)^\\top \\kappa^\\top (\\nabla u) = (\\nabla v)^\\top (\\kappa - \\kappa^\\top) (\\nabla u)$.\nGiven $\\kappa = \\kappa^\\top$, the term $\\kappa - \\kappa^\\top$ is the zero matrix. Therefore, the integrand $\\mathcal{I}(x)$ is identically zero for almost every $x \\in \\Omega$.\nThe integral of a function that is zero almost everywhere is zero.\n$$\na(u,v) - a(v,u) = \\int_{\\Omega} 0 \\, dx = 0.\n$$\nThe final simplified expression is $0$.", "answer": "$$\n\\boxed{0}\n$$", "id": "2603817"}, {"introduction": "Having mastered the basic derivation, we now explore the true power and elegance of the weak formulation, which naturally handles concepts that are ill-defined in a classical sense. In this practice [@problem_id:2603885], you will work with a point source, represented by a Dirac delta distribution $\\delta_{x_{0}}$, which is not a function in the typical sense. You will demonstrate how the fundamental solution to the Poisson equation satisfies the corresponding weak formulation, providing a concrete example of how this framework accommodates distributional sources and singular solutions.", "problem": "Let $n \\geq 2$ and let $x_{0} \\in \\mathbb{R}^{n}$ be fixed. Consider the Poisson equation in the whole space with a point source at $x_{0}$,\n$$\n- \\Delta u = \\delta_{x_{0}} \\quad \\text{in } \\mathbb{R}^{n},\n$$\nwhere $\\delta_{x_{0}}$ is the Dirac distribution concentrated at $x_{0}$ and $\\Delta$ is the Laplacian. Let $u$ be given by the fundamental solution centered at $x_{0}$, that is, $u(x) = \\Phi(x - x_{0})$, where\n$$\n\\Phi(x) =\n\\begin{cases}\n\\dfrac{1}{(n-2)\\,\\sigma_{n}}\\,|x|^{2-n}, & n \\geq 3, \\\\[1.2ex]\n\\dfrac{1}{2\\pi}\\,\\ln\\!\\left(\\dfrac{1}{|x|}\\right), & n = 2,\n\\end{cases}\n$$\nand $\\sigma_{n}$ denotes the $(n-1)$-dimensional surface measure of the unit sphere in $\\mathbb{R}^{n}$. For any test function $v \\in C_{c}^{\\infty}(\\mathbb{R}^{n})$ (smooth with compact support), define the functional\n$$\nI(v) := \\int_{\\mathbb{R}^{n}} \\nabla u(x) \\cdot \\nabla v(x)\\, \\mathrm{d}x.\n$$\nUsing only fundamental principles (properties of the Dirac distribution, the divergence theorem, and smoothness/compact support of $v$), evaluate $I(v)$ in closed form in terms of $v$ and $x_{0}$. Express your final answer as an exact analytic expression. No rounding is required, and no physical units are involved.", "solution": "The problem as stated is valid. It is a standard, well-posed problem in the theory of partial differential equations concerning the weak formulation of the Poisson equation with a distributional source. All terms are mathematically well-defined, and the problem is scientifically grounded. We proceed with the solution.\n\nThe objective is to evaluate the functional $I(v)$ defined as\n$$\nI(v) := \\int_{\\mathbb{R}^{n}} \\nabla u(x) \\cdot \\nabla v(x)\\, \\mathrm{d}x,\n$$\nwhere $u(x) = \\Phi(x - x_0)$ is the fundamental solution to the Laplace operator satisfying $-\\Delta u = \\delta_{x_0}$, and $v \\in C_{c}^{\\infty}(\\mathbb{R}^{n})$ is a smooth test function with compact support.\n\nThe integrand involves the product of gradients, which suggests the use of integration by parts, or more generally, Green's first identity, which is a consequence of the divergence theorem. However, the function $u(x)$ has a singularity at $x = x_0$, as does its gradient $\\nabla u(x)$. Therefore, we cannot directly apply Green's identity over the entire space $\\mathbb{R}^n$.\n\nTo proceed correctly, we must excise the singularity. Let $B_{\\epsilon}(x_0)$ be an open ball of radius $\\epsilon > 0$ centered at the point $x_0$. Since the test function $v(x)$ has compact support, there exists a radius $R > 0$ such that the support of $v$ is contained within the ball $B_R(0)$. We choose $R$ large enough and $\\epsilon$ small enough such that $x_0 \\in B_R(0)$ and $B_\\epsilon(x_0) \\subset B_R(0)$. Let us define the domain $\\Omega_{R,\\epsilon} := B_R(0) \\setminus \\overline{B_{\\epsilon}(x_0)}$. This is a region where both $u$ and $v$ are smooth.\n\nApplying Green's first identity to $u$ and $v$ on the domain $\\Omega_{R,\\epsilon}$:\n$$\n\\int_{\\Omega_{R,\\epsilon}} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = -\\int_{\\Omega_{R,\\epsilon}} v (\\Delta u) \\, \\mathrm{d}x + \\int_{\\partial \\Omega_{R,\\epsilon}} v (\\nabla u \\cdot \\mathbf{n}) \\, \\mathrm{d}S,\n$$\nwhere $\\mathbf{n}$ is the outward unit normal vector to the boundary $\\partial \\Omega_{R,\\epsilon}$.\n\nLet us analyze each term in this identity.\nInside the domain $\\Omega_{R,\\epsilon}$, we have $x \\neq x_0$. The function $u$ is the fundamental solution which satisfies $\\Delta u = 0$ for all $x \\neq x_0$. Consequently, the volume integral vanishes:\n$$\n-\\int_{\\Omega_{R,\\epsilon}} v (\\Delta u) \\, \\mathrm{d}x = 0.\n$$\nThe boundary $\\partial \\Omega_{R,\\epsilon}$ consists of two components: the outer sphere $\\partial B_R(0)$ and the inner sphere $\\partial B_\\epsilon(x_0)$.\nThe boundary integral becomes:\n$$\n\\int_{\\partial \\Omega_{R,\\epsilon}} v (\\nabla u \\cdot \\mathbf{n}) \\, \\mathrm{d}S = \\int_{\\partial B_R(0)} v (\\nabla u \\cdot \\mathbf{n}) \\, \\mathrm{d}S + \\int_{\\partial B_\\epsilon(x_0)} v (\\nabla u \\cdot \\mathbf{n}) \\, \\mathrm{d}S.\n$$\nOn the outer boundary $\\partial B_R(0)$, the function $v$ is identically zero, since the support of $v$ is contained within $B_R(0)$. Therefore, the integral over $\\partial B_R(0)$ is zero.\n$$\n\\int_{\\partial B_R(0)} v (\\nabla u \\cdot \\mathbf{n}) \\, \\mathrm{d}S = 0.\n$$\nOn the inner boundary $\\partial B_\\epsilon(x_0)$, the outward unit normal $\\mathbf{n}$ to the domain $\\Omega_{R,\\epsilon}$ points towards the center $x_0$. If we denote by $\\mathbf{n}_\\epsilon$ the standard outward unit normal to the ball $B_\\epsilon(x_0)$, then $\\mathbf{n} = -\\mathbf{n}_\\epsilon$. The expression for the normal derivative is $\\frac{\\partial u}{\\partial \\mathbf{n}_\\epsilon} = \\nabla u \\cdot \\mathbf{n}_\\epsilon$. The integral over the inner boundary is thus:\n$$\n\\int_{\\partial B_\\epsilon(x_0)} v (\\nabla u \\cdot (-\\mathbf{n}_\\epsilon)) \\, \\mathrm{d}S = - \\int_{\\partial B_\\epsilon(x_0)} v \\frac{\\partial u}{\\partial \\mathbf{n}_\\epsilon} \\, \\mathrm{d}S.\n$$\nCombining these results, we have for any valid $R$ and $\\epsilon$:\n$$\n\\int_{\\Omega_{R,\\epsilon}} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = - \\int_{\\partial B_\\epsilon(x_0)} v(x) \\frac{\\partial u}{\\partial \\mathbf{n}_\\epsilon}(x) \\, \\mathrm{d}S.\n$$\nTo find the value of $I(v)$, we must take the limit as $\\epsilon \\to 0$ and $R \\to \\infty$. As $R \\to \\infty$, the domain of the left-hand integral becomes $\\mathbb{R}^n \\setminus \\overline{B_\\epsilon(x_0)}$. Taking the limit as $\\epsilon \\to 0$ then gives the desired integral $I(v)$ (as an improper integral, which converges).\n$$\nI(v) = \\lim_{\\epsilon \\to 0} \\left( - \\int_{\\partial B_\\epsilon(x_0)} v(x) \\frac{\\partial u}{\\partial \\mathbf{n}_\\epsilon}(x) \\, \\mathrm{d}S \\right).\n$$\nWe must now compute the normal derivative $\\frac{\\partial u}{\\partial \\mathbf{n}_\\epsilon}$. Let $y = x - x_0$, so that $u(x) = \\Phi(y)$. The normal derivative on the sphere $|y|=\\epsilon$ is the radial derivative $\\frac{\\partial \\Phi}{\\partial r}$ where $r = |y|$.\n\nCase $n \\geq 3$:\n$u(x) = \\Phi(x-x_0) = \\frac{1}{(n-2)\\sigma_n}|x-x_0|^{2-n}$. In terms of $r = |x-x_0|$, this is $\\Phi(r) = \\frac{1}{(n-2)\\sigma_n} r^{2-n}$.\nThe radial derivative is:\n$$\n\\frac{\\partial \\Phi}{\\partial r} = \\frac{(2-n)}{(n-2)\\sigma_n} r^{1-n} = -\\frac{1}{\\sigma_n} r^{1-n}.\n$$\nOn the sphere $\\partial B_\\epsilon(x_0)$, we have $r = \\epsilon$, so $\\frac{\\partial u}{\\partial \\mathbf{n}_\\epsilon} = -\\frac{1}{\\sigma_n} \\epsilon^{1-n}$.\nSubstituting this into the limit expression for $I(v)$:\n$$\nI(v) = \\lim_{\\epsilon \\to 0} \\left( - \\int_{\\partial B_\\epsilon(x_0)} v(x) \\left(-\\frac{1}{\\sigma_n \\epsilon^{n-1}}\\right) \\, \\mathrm{d}S \\right) = \\lim_{\\epsilon \\to 0} \\frac{1}{\\sigma_n \\epsilon^{n-1}} \\int_{\\partial B_\\epsilon(x_0)} v(x) \\, \\mathrm{d}S.\n$$\nThe quantity $\\sigma_n \\epsilon^{n-1}$ is the surface area of the $(n-1)$-sphere of radius $\\epsilon$. The expression under the limit is precisely the average value of $v(x)$ over the sphere $\\partial B_\\epsilon(x_0)$. Since $v$ is a continuous function (in fact, $C^\\infty$), the limit of the average value as the sphere shrinks to the point $x_0$ is the value of the function at that point.\n$$\nI(v) = v(x_0).\n$$\n\nCase $n=2$:\n$u(x) = \\Phi(x-x_0) = \\frac{1}{2\\pi}\\ln\\left(\\frac{1}{|x-x_0|}\\right)$. In terms of $r = |x-x_0|$, this is $\\Phi(r) = -\\frac{1}{2\\pi}\\ln(r)$.\nThe radial derivative is:\n$$\n\\frac{\\partial \\Phi}{\\partial r} = -\\frac{1}{2\\pi r}.\n$$\nOn the circle $\\partial B_\\epsilon(x_0)$, we have $r=\\epsilon$, so $\\frac{\\partial u}{\\partial \\mathbf{n}_\\epsilon} = -\\frac{1}{2\\pi \\epsilon}$.\nThe limit expression for $I(v)$ becomes:\n$$\nI(v) = \\lim_{\\epsilon \\to 0} \\left( - \\int_{\\partial B_\\epsilon(x_0)} v(x) \\left(-\\frac{1}{2\\pi\\epsilon}\\right) \\, \\mathrm{d}S \\right) = \\lim_{\\epsilon \\to 0} \\frac{1}{2\\pi\\epsilon} \\int_{\\partial B_\\epsilon(x_0)} v(x) \\, \\mathrm{d}S.\n$$\nThe quantity $2\\pi\\epsilon$ is the circumference (surface measure) of the circle of radius $\\epsilon$. Again, the expression is the average value of $v(x)$ over the circle. By continuity of $v$, this limit is $v(x_0)$.\n$$\nI(v) = v(x_0).\n$$\n\nIn all dimensions $n \\geq 2$, the result is the same. The calculation demonstrates that the weak formulation of the equation $-\\Delta u = \\delta_{x_0}$ is equivalent to the statement that for any test function $v$, the integral of the gradients is equal to the action of the source distribution on the test function. The final result is the evaluation of the test function at the point where the Dirac source is located.", "answer": "$$\n\\boxed{v(x_{0})}\n$$", "id": "2603885"}, {"introduction": "Real-world engineering problems, such as those involving fluid flow, often present numerical challenges that the standard Galerkin method struggles with, particularly instabilities in advection-dominated scenarios. This final practice [@problem_id:2603889] delves into a powerful remedy: stabilized finite element methods. You will construct a Galerkin/Least-Squares (GLS) formulation by augmenting the standard weak form with a term that penalizes the residual, and then analyze its core properties of consistency and symmetry. This exercise demonstrates the flexibility of the variational framework and its adaptation into robust computational tools.", "problem": "Consider the one-dimensional steady advection–diffusion–reaction boundary value problem on the open interval $\\Omega=(0,1)$ with homogeneous Dirichlet boundary conditions:\n$$\n-\\varepsilon\\,u''(x) + \\beta\\,u'(x) + \\sigma\\,u(x) = f(x)\\quad\\text{for } x\\in(0,1),\\qquad u(0)=u(1)=0,\n$$\nwhere $\\varepsilon>0$, $\\beta\\in\\mathbb{R}$, $\\sigma\\ge 0$ are constant coefficients and $f\\in L^{2}(\\Omega)$. Let $V:=H_{0}^{1}(\\Omega)$ be the trial and test space. Define the differential operator $L:V\\to L^{2}(\\Omega)$ by $L u := -\\varepsilon\\,u'' + \\beta\\,u' + \\sigma\\,u$.\n\nTasks:\n- Starting from the weighted residual principle and fundamental definitions, derive the standard Galerkin weak formulation for this problem.\n- Then, construct the Galerkin/Least-Squares (GLS) stabilized weak form that penalizes the $L^{2}$ norm of the strong-form residual elementwise. Assume an arbitrary conforming partition $\\mathcal{T}_{h}$ of $\\Omega$ into elements $K$ and an elementwise constant stabilization parameter $\\tau_{K}>0$ on each $K\\in\\mathcal{T}_{h}$. Provide the stabilized bilinear form and linear functional explicitly in terms of $\\varepsilon$, $\\beta$, $\\sigma$, the residual $L u - f$, and $\\{\\tau_{K}\\}_{K\\in\\mathcal{T}_{h}}$.\n- Prove the consistency of the stabilized method, in the sense that any sufficiently smooth exact solution $u$ of the strong form with $u\\in V$ also satisfies the stabilized weak form for all test functions in $V$.\n- Analyze the effect of the GLS stabilization on the symmetry of the total bilinear form. Determine the necessary and sufficient condition on $\\beta$ under which the total stabilized bilinear form is symmetric on $V$, for arbitrary choices of $\\varepsilon>0$, $\\sigma\\ge 0$, and elementwise constants $\\{\\tau_{K}\\}_{K\\in\\mathcal{T}_{h}}$.\n\nAnswer specification:\n- Report only the value of $\\beta$ that makes the total stabilized bilinear form symmetric on $V$.\n- Your final answer must be a single real number.", "solution": "The problem presented is a standard one-dimensional, steady-state advection-diffusion-reaction boundary value problem. It is mathematically well-posed and scientifically grounded. All necessary data and definitions are provided, and there are no inconsistencies. The problem is valid. We proceed with the solution.\n\nThe strong form of the boundary value problem is to find a function $u(x)$ such that:\n$$\n-\\varepsilon\\,u''(x) + \\beta\\,u'(x) + \\sigma\\,u(x) = f(x)\\quad\\text{for } x\\in\\Omega=(0,1)\n$$\nwith homogeneous Dirichlet boundary conditions $u(0)=u(1)=0$. The function space for both trial and test functions is given as $V:=H_{0}^{1}(\\Omega)$. The coefficients $\\varepsilon>0$, $\\beta\\in\\mathbb{R}$, and $\\sigma\\ge 0$ are constants, and the forcing function is $f\\in L^{2}(\\Omega)$. The differential operator is defined as $L u := -\\varepsilon\\,u'' + \\beta\\,u' + \\sigma\\,u$.\n\n**1. Derivation of the Standard Galerkin Weak Formulation**\n\nThe weak formulation is derived from the weighted residual principle, which requires the residual of the equation, $R(u) = Lu - f$, to be orthogonal to every test function $v$ in the test space $V$.\n$$\n\\int_{\\Omega} (Lu - f)v \\, dx = 0 \\quad \\forall v \\in V\n$$\nSubstituting the expression for the operator $L$:\n$$\n\\int_{0}^{1} (-\\varepsilon\\,u''(x) + \\beta\\,u'(x) + \\sigma\\,u(x)) v(x) \\, dx = \\int_{0}^{1} f(x) v(x) \\, dx\n$$\nTo reduce the order of differentiation, we apply integration by parts to the second-derivative term:\n$$\n\\int_{0}^{1} (-\\varepsilon\\,u'' v) \\, dx = -\\left[\\varepsilon u' v\\right]_{0}^{1} + \\int_{0}^{1} \\varepsilon u' v' \\, dx\n$$\nSince the test functions $v$ belong to the space $V = H_{0}^{1}(\\Omega)$, they satisfy the boundary conditions $v(0)=0$ and $v(1)=0$. Consequently, the boundary term vanishes: $-\\left[\\varepsilon u'(1) v(1) - \\varepsilon u'(0) v(0)\\right] = 0$.\nSubstituting this result back into the weighted residual equation gives the standard Galerkin weak formulation: Find $u \\in V$ such that\n$$\n\\int_{0}^{1} (\\varepsilon u'(x)v'(x) + \\beta u'(x)v(x) + \\sigma u(x)v(x)) \\, dx = \\int_{0}^{1} f(x) v(x) \\, dx \\quad \\forall v \\in V\n$$\nThis can be written in the abstract form $B(u,v) = F(v)$, where the bilinear form $B:V\\times V \\to \\mathbb{R}$ and the linear functional $F:V \\to \\mathbb{R}$ are defined as:\n$$\nB(u,v) := \\int_{0}^{1} (\\varepsilon u'v' + \\beta u'v + \\sigma uv) \\, dx\n$$\n$$\nF(v) := \\int_{0}^{1} fv \\, dx\n$$\n\n**2. Construction of the Galerkin/Least-Squares (GLS) Stabilized Weak Form**\n\nThe GLS method adds a term to the standard Galerkin formulation that penalizes the elementwise $L^2$-norm of the strong-form residual. The stabilized problem is constructed by adding a stabilization term to both sides of the standard weak form. The general form of the GLS stabilized weak problem is to find $u \\in V$ such that for all $v \\in V$:\n$$\nB(u,v) + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (Lu)(Lv) \\, dK = F(v) + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} f(Lv) \\, dK\n$$\nwhere $\\mathcal{T}_{h}$ is a partition of $\\Omega$ into elements $K$, and $\\tau_{K}>0$ is a constant stabilization parameter on each element $K$. The term $(Lu)(Lv)$ arises from penalizing the residual $Lu-f$ against a modified test function which includes a multiple of $Lv$.\n\nThis leads to the definition of the stabilized bilinear form $B_{\\text{total}}(u,v)$ and the stabilized linear functional $F_{\\text{total}}(v)$.\nThe stabilized bilinear form is:\n$$\nB_{\\text{total}}(u, v) = B(u,v) + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (Lu)(Lv) \\, dK\n$$\nSubstituting the definitions for $B(u,v)$ and $L$:\n$$\nB_{\\text{total}}(u, v) = \\int_{0}^{1} (\\varepsilon u'v' + \\beta u'v + \\sigma uv) \\, dx + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (-\\varepsilon u'' + \\beta u' + \\sigma u)(-\\varepsilon v'' + \\beta v' + \\sigma v) \\, dK\n$$\nThe stabilized linear functional is:\n$$\nF_{\\text{total}}(v) = F(v) + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} f(Lv) \\, dK\n$$\nSubstituting the definitions for $F(v)$ and $L$:\n$$\nF_{\\text{total}}(v) = \\int_{0}^{1} fv \\, dx + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} f(-\\varepsilon v'' + \\beta v' + \\sigma v) \\, dK\n$$\nThe stabilized weak formulation is to find $u \\in V$ such that $B_{\\text{total}}(u,v) = F_{\\text{total}}(v)$ for all $v \\in V$.\n\n**3. Proof of Consistency**\n\nA numerical method is consistent if the exact solution $u$ of the strong form also satisfies the discrete (or stabilized) weak form. Let $u$ be the exact solution, implying that $u$ is sufficiently smooth, satisfies the boundary conditions $u(0)=u(1)=0$, and satisfies the differential equation $Lu=f$ for all $x \\in (0,1)$.\n\nWe must show that for this exact solution $u$, the equality $B_{\\text{total}}(u,v) = F_{\\text{total}}(v)$ holds for all $v \\in V$.\nLet us examine the left-hand side (LHS) and right-hand side (RHS) of the stabilized formulation with the exact solution $u$.\nLHS: $B_{\\text{total}}(u,v) = B(u,v) + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (Lu)(Lv) \\, dK$.\nRHS: $F_{\\text{total}}(v) = F(v) + \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} f(Lv) \\, dK$.\n\nSince $u$ is the exact solution, $Lu=f$ everywhere in $\\Omega$. We can therefore substitute $f$ for $Lu$ in the stabilization term on the LHS:\n$$\n\\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (Lu)(Lv) \\, dK = \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} f(Lv) \\, dK\n$$\nThis is precisely the stabilization term on the RHS. As the stabilization terms on both sides are equal, the equality $B_{\\text{total}}(u,v) = F_{\\text{total}}(v)$ holds if and only if the standard Galerkin parts are equal: $B(u,v) = F(v)$.\nAs shown in the first part of this solution, the equality $B(u,v)=F(v)$ is the standard weak formulation, which is derived from the strong form $Lu=f$. Therefore, the exact solution $u$ satisfies $B(u,v)=F(v)$.\nSince both the Galerkin terms and the stabilization terms are equal for the exact solution, we have proven that $B_{\\text{total}}(u,v) = F_{\\text{total}}(v)$. The GLS method is consistent.\n\n**4. Analysis of Symmetry**\n\nA bilinear form $A(u,v)$ is symmetric if $A(u,v)=A(v,u)$ for all $u,v$ in the function space $V$. We must find the necessary and sufficient condition on $\\beta$ for $B_{\\text{total}}(u,v)$ to be symmetric.\nThe total bilinear form is $B_{\\text{total}}(u, v) = B(u,v) + S(u,v)$, where $S(u,v) = \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (Lu)(Lv) \\, dK$.\n\nFirst, let us examine the symmetry of the stabilization term $S(u,v)$.\n$$\nS(u,v) = \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (Lu)(Lv) \\, dK\n$$\nSince scalar multiplication is commutative, $(Lu)(Lv) = (Lv)(Lu)$. Therefore,\n$$\nS(u,v) = \\sum_{K\\in\\mathcal{T}_{h}} \\tau_{K} \\int_{K} (Lv)(Lu) \\, dK = S(v,u)\n$$\nThe stabilization bilinear form $S(u,v)$ is always symmetric, regardless of the values of $\\varepsilon$, $\\beta$, $\\sigma$, and $\\tau_K$.\n\nFor the total bilinear form $B_{\\text{total}}(u,v)$ to be symmetric, we require $B_{\\text{total}}(u,v) = B_{\\text{total}}(v,u)$.\n$$\nB(u,v) + S(u,v) = B(v,u) + S(v,u)\n$$\nSince $S(u,v)=S(v,u)$, this condition simplifies to requiring the standard Galerkin bilinear form $B(u,v)$ to be symmetric:\n$$\nB(u,v) = B(v,u)\n$$\nLet's analyze $B(u,v) = \\int_{0}^{1} (\\varepsilon u'v' + \\beta u'v + \\sigma uv) \\, dx$.\nThe diffusion term $\\int_{0}^{1} \\varepsilon u'v' \\, dx$ and the reaction term $\\int_{0}^{1} \\sigma uv \\, dx$ are clearly symmetric.\nThe advection term is $A(u,v) = \\int_{0}^{1} \\beta u'v \\, dx$. Let's examine its transpose, $A(v,u) = \\int_{0}^{1} \\beta v'u \\, dx$.\nUsing integration by parts on $A(v,u)$ and recalling that $u,v \\in H_0^1(\\Omega)$ (so $u(0)=u(1)=v(0)=v(1)=0$):\n$$\nA(v,u) = \\int_{0}^{1} \\beta v'u \\, dx = \\left[\\beta vu \\right]_{0}^{1} - \\int_{0}^{1} \\beta v u' \\, dx = 0 - \\int_{0}^{1} \\beta u'v \\, dx = -A(u,v)\n$$\nThe advection term is skew-symmetric. For $B(u,v)$ to be symmetric, its symmetric and skew-symmetric parts must be equal to the corresponding parts of $B(v,u)$. This requires the skew-symmetric component to be zero. The only skew-symmetric component of $B(u,v)$ is the advection term.\nThus, symmetry requires $A(u,v) = -A(u,v)$, which means $2A(u,v)=0$.\n$$\n2 \\beta \\int_{0}^{1} u'v \\, dx = 0 \\quad \\forall u, v \\in V\n$$\nThis condition must hold for all functions $u,v$ in the space $V=H_{0}^{1}(\\Omega)$. The integral $\\int_{0}^{1} u'v \\, dx$ is not identically zero for all choices of $u, v \\in V$. For example, one can construct functions $u,v \\in V$ for which this integral is non-zero.\nTherefore, for the equality to hold for arbitrary $u,v$, the coefficient must be zero.\nThe necessary and sufficient condition for the symmetry of $B(u,v)$, and consequently for the symmetry of $B_{\\text{total}}(u,v)$, is $\\beta=0$.\nThe GLS stabilization adds a symmetric part to the bilinear form, but it does not alter the skew-symmetric contribution from the advection term of the original operator. Thus, the condition for symmetry remains unaffected by the stabilization. The value of $\\beta$ that makes the total stabilized bilinear form symmetric is $0$.", "answer": "$$\n\\boxed{0}\n$$", "id": "2603889"}]}