{"hands_on_practices": [{"introduction": "Before discretizing a partial differential equation, we must first cast it into its \"weak\" or \"variational\" form. This foundational exercise guides you through this process for the 1D Poisson equation, contrasting the well-posed Dirichlet problem with the subtleties of the pure Neumann problem. By applying the principles of the Lax-Milgram theorem and analyzing solvability conditions, you will solidify your understanding of the theoretical underpinnings of the finite element method. [@problem_id:2579521]", "problem": "Consider the one-dimensional model Poisson problem on the open interval $\\Omega=(0,1)$ with constant source $f(x)\\equiv 1$. Start from the strong forms of the boundary value problems to derive the corresponding weak formulations based on the Sobolev spaces $H^{1}(0,1)$ and $H^{1}_{0}(0,1)$:\n- Dirichlet problem: find $u:\\Omega\\to\\mathbb{R}$ such that $-u''(x)=1$ for $x\\in(0,1)$ and $u(0)=u(1)=0$.\n- Pure Neumann problem: find $u:\\Omega\\to\\mathbb{R}$ such that $-u''(x)=1$ for $x\\in(0,1)$ and $u'(0)=u'(1)=0$.\n\nUsing the weak forms, justify existence and uniqueness (up to an additive constant where appropriate) by appealing to the Poincaré inequality and the Lax–Milgram theorem (stated without proof is acceptable), and then solve explicitly in the strong form to obtain:\n1. The unique solution of the Dirichlet problem.\n2. A characterization of the solution set of the pure Neumann problem, including the necessary compatibility condition on $f$ for solvability and a conclusion about solvability for the given $f(x)\\equiv 1$.\n\nReport as your final answer only the explicit closed-form expression for the Dirichlet solution $u_{D}(x)$. No rounding is required, and no physical units are involved.", "solution": "The problem as stated is mathematically well-defined and constitutes a standard exercise in the analysis of elliptic boundary value problems. We proceed to solve it by analyzing the Dirichlet and pure Neumann problems in turn.\n\nFirst, we consider the Dirichlet problem:\nFind $u: \\Omega \\to \\mathbb{R}$ such that\n$$\n-u''(x) = 1 \\text{ for } x \\in \\Omega = (0,1)\n$$\nwith homogeneous Dirichlet boundary conditions $u(0) = 0$ and $u(1) = 0$.\n\nTo derive the weak formulation, we first define the appropriate function space. The homogeneous boundary conditions are essential (or stable) conditions, and they must be built into the space of trial and test functions. The correct space is the Sobolev space $H^{1}_{0}(\\Omega)$, defined as the closure of $C^{\\infty}_{c}(\\Omega)$ (infinitely differentiable functions with compact support in $\\Omega$) with respect to the $H^{1}$ norm. Functions in $H^{1}_{0}(\\Omega)$ are zero at the boundary in a trace sense.\n\nWe multiply the strong form of the equation by an arbitrary test function $v \\in H^{1}_{0}(\\Omega)$ and integrate over the domain $\\Omega$:\n$$\n\\int_{0}^{1} -u''(x)v(x) \\,dx = \\int_{0}^{1} 1 \\cdot v(x) \\,dx\n$$\nApplying integration by parts to the left-hand side yields:\n$$\n\\int_{0}^{1} u'(x)v'(x) \\,dx - \\left[ u'(x)v(x) \\right]_{0}^{1} = \\int_{0}^{1} v(x) \\,dx\n$$\nSince the test function $v$ belongs to $H^{1}_{0}(\\Omega)$, we have $v(0) = v(1) = 0$. Consequently, the boundary term $\\left[ u'(x)v(x) \\right]_{0}^{1}$ vanishes. This leads to the weak formulation of the Dirichlet problem:\nFind $u \\in H^{1}_{0}(\\Omega)$ such that\n$$\n\\int_{0}^{1} u'(x)v'(x) \\,dx = \\int_{0}^{1} v(x) \\,dx \\quad \\forall v \\in H^{1}_{0}(\\Omega)\n$$\nThis can be written in the abstract form $a(u,v) = L(v)$, where the bilinear form $a(\\cdot, \\cdot): H^{1}_{0}(\\Omega) \\times H^{1}_{0}(\\Omega) \\to \\mathbb{R}$ is defined as $a(u,v) = \\int_{0}^{1} u'(x)v'(x) \\,dx$, and the linear functional $L(\\cdot): H^{1}_{0}(\\Omega) \\to \\mathbb{R}$ is defined as $L(v) = \\int_{0}^{1} v(x) \\,dx$.\n\nThe existence and uniqueness of a solution to this weak problem are guaranteed by the Lax-Milgram theorem. We must verify that the bilinear form $a(u,v)$ is bounded and coercive (or $H^{1}_{0}$-elliptic), and that the linear functional $L(v)$ is bounded.\n$1$. Boundedness of $a(u,v)$: By the Cauchy-Schwarz inequality,\n$|a(u,v)| = \\left| \\int_{0}^{1} u'v' \\,dx \\right| \\leq \\|u'\\|_{L^{2}} \\|v'\\|_{L^{2}} \\leq \\|u\\|_{H^{1}} \\|v\\|_{H^{1}}$. Thus $a(u,v)$ is bounded.\n$2$. Coercivity of $a(u,v)$: We have $a(u,u) = \\int_{0}^{1} (u'(x))^{2} \\,dx = \\|u'\\|_{L^{2}}^{2}$. For functions in $H^{1}_{0}(\\Omega)$, the Poincaré inequality states that there exists a constant $C_{P}  0$ such that $\\|u\\|_{L^{2}} \\leq C_{P} \\|u'\\|_{L^{2}}$. The full $H^{1}$ norm is $\\|u\\|_{H^{1}}^{2} = \\|u\\|_{L^{2}}^{2} + \\|u'\\|_{L^{2}}^{2}$. Using the Poincaré inequality, we get $\\|u\\|_{H^{1}}^{2} \\leq (C_{P}^{2} + 1)\\|u'\\|_{L^{2}}^{2} = (C_{P}^{2} + 1)a(u,u)$. Therefore, $a(u,u) \\geq \\frac{1}{C_{P}^{2}+1} \\|u\\|_{H^{1}}^{2}$. This establishes that $a(u,v)$ is coercive with coercivity constant $\\alpha = (C_{P}^{2}+1)^{-1}  0$.\n$3$. Boundedness of $L(v)$: By the Cauchy-Schwarz inequality, $|L(v)| = \\left| \\int_{0}^{1} 1 \\cdot v(x) \\,dx \\right| \\leq \\|1\\|_{L^{2}} \\|v\\|_{L^{2}} = \\sqrt{1} \\cdot \\|v\\|_{L^{2}} \\leq \\|v\\|_{H^{1}}$. Thus $L(v)$ is bounded.\nSince all conditions are met, the Lax-Milgram theorem guarantees the existence of a unique solution $u \\in H^{1}_{0}(\\Omega)$.\n\nTo find this solution explicitly, we solve the strong form by direct integration:\n$-u''(x) = 1$\nIntegrating once with respect to $x$ gives:\n$-u'(x) = x + C_{1}$\nIntegrating a second time gives:\n$-u(x) = \\frac{1}{2}x^{2} + C_{1}x + C_{2}$\nSo, the general solution is $u(x) = -\\frac{1}{2}x^{2} - C_{1}x - C_{2}$.\nWe apply the boundary conditions to determine the constants $C_1$ and $C_2$:\n$u(0) = 0 \\implies -\\frac{1}{2}(0)^{2} - C_{1}(0) - C_{2} = 0 \\implies C_{2} = 0$.\n$u(1) = 0 \\implies -\\frac{1}{2}(1)^{2} - C_{1}(1) - 0 = 0 \\implies -\\frac{1}{2} - C_{1} = 0 \\implies C_{1} = -\\frac{1}{2}$.\nSubstituting the constants back, the unique solution to the Dirichlet problem is:\n$u_{D}(x) = -\\frac{1}{2}x^{2} - \\left(-\\frac{1}{2}\\right)x = \\frac{1}{2}x - \\frac{1}{2}x^{2} = \\frac{1}{2}x(1-x)$.\n\nNext, we consider the pure Neumann problem:\nFind $u: \\Omega \\to \\mathbb{R}$ such that\n$$\n-u''(x) = 1 \\text{ for } x \\in \\Omega = (0,1)\n$$\nwith homogeneous Neumann boundary conditions $u'(0) = 0$ and $u'(1) = 0$.\n\nThe Neumann conditions are natural boundary conditions, so they are not imposed on the function space. The appropriate space for both trial and test functions is $H^{1}(\\Omega)$. We multiply by a test function $v \\in H^{1}(\\Omega)$ and integrate:\n$\\int_{0}^{1} -u''(x)v(x) \\,dx = \\int_{0}^{1} 1 \\cdot v(x) \\,dx$.\nIntegration by parts yields:\n$\\int_{0}^{1} u'(x)v'(x) \\,dx - \\left[ u'(x)v(x) \\right]_{0}^{1} = \\int_{0}^{1} v(x) \\,dx$.\nThe boundary term is $- (u'(1)v(1) - u'(0)v(0))$. Using the specified Neumann conditions $u'(0)=0$ and $u'(1)=0$, this term vanishes. The weak formulation is thus:\nFind $u \\in H^{1}(\\Omega)$ such that\n$$\n\\int_{0}^{1} u'(x)v'(x) \\,dx = \\int_{0}^{1} v(x) \\,dx \\quad \\forall v \\in H^{1}(\\Omega)\n$$\nThis is again of the form $a(u,v) = L(v)$, with $a(u,v) = \\int_{0}^{1} u'v' \\,dx$ and $L(v) = \\int_{0}^{1} v \\,dx$, but now on the space $H^{1}(\\Omega)$.\n\nFor this problem, the bilinear form $a(u,v)$ is not coercive on $H^{1}(\\Omega)$. Consider any non-zero constant function, $u(x) = c \\neq 0$. For such a function, $\\|u\\|_{H^{1}}^{2} = \\int_{0}^{1} c^{2} \\,dx + \\int_{0}^{1} 0^{2} \\,dx = c^{2}  0$. However, $a(u,u) = \\int_{0}^{1} (u'(x))^{2} \\,dx = \\int_{0}^{1} 0^{2} \\,dx = 0$. Therefore, there is no constant $\\alpha  0$ such that $a(u,u) \\ge \\alpha \\|u\\|_{H^{1}}^{2}$ for all $u \\in H^{1}(\\Omega)$. The kernel of the bilinear form consists of all constant functions. The Lax-Milgram theorem does not apply directly.\n\nA necessary condition for the existence of a solution is that the right-hand side functional $L(v)$ must vanish for all functions $v$ in the kernel of $a(\\cdot, \\cdot)$. Let us test this condition by choosing the test function $v(x)=1$, which is a basis for the kernel.\n$L(1) = \\int_{0}^{1} f(x) \\cdot 1 \\,dx = \\int_{0}^{1} 1 \\,dx = 1$.\nSince $L(1) = 1 \\neq 0$, the compatibility condition is not satisfied. Consequently, the pure Neumann problem with source $f(x)=1$ has no solution.\n\nThis can be confirmed by integrating the strong form of the equation over the domain:\n$\\int_{0}^{1} -u''(x) \\,dx = \\int_{0}^{1} f(x) \\,dx$\nApplying the fundamental theorem of calculus to the left side:\n$-[u'(x)]_{0}^{1} = \\int_{0}^{1} f(x) \\,dx$\n$-(u'(1) - u'(0)) = \\int_{0}^{1} f(x) \\,dx$\nSubstituting the Neumann boundary conditions $u'(0) = 0$ and $u'(1) = 0$ yields the compatibility (or solvability) condition:\n$0 = \\int_{0}^{1} f(x) \\,dx$.\nFor the given source term $f(x)=1$, we have $\\int_{0}^{1} 1 \\,dx = 1 \\neq 0$. The condition is violated, confirming that no classical solution exists.\n\nIf the source term $f$ did satisfy $\\int_{0}^{1} f(x) \\,dx = 0$, a solution would exist, but it would not be unique. If $u(x)$ is a solution, then $u(x)+C$ for any constant $C \\in \\mathbb{R}$ is also a solution, since $(u+C)'' = u''$ and $(u+C)'=u'$. The solution set would be an equivalence class of functions differing by an additive constant. A unique solution can be obtained by imposing an additional constraint, such as $\\int_{0}^{1} u(x) \\,dx = 0$.", "answer": "$$\n\\boxed{\\frac{1}{2}x(1-x)}\n$$", "id": "2579521"}, {"introduction": "The finite element method constructs a global system of equations by \"assembling\" contributions from individual elements. This practice takes you to the heart of this process: calculating the element stiffness matrix for a standard reference triangle. By explicitly deriving this matrix from the linear basis functions, you will gain direct insight into how an element's geometry and the choice of basis functions translate the differential operator into a concrete algebraic object. [@problem_id:2579542]", "problem": "Consider the model Poisson problem $-\\Delta u = f$ on a single reference element used in the Finite Element Method (FEM). Let $\\widehat{T}$ denote the reference right triangle in $\\mathbb{R}^{2}$ with vertices at $(0,0)$, $(1,0)$, and $(0,1)$. Let $\\{\\widehat{N}_{1},\\widehat{N}_{2},\\widehat{N}_{3}\\}$ be the standard linear Lagrange shape functions associated with these vertices. The element stiffness matrix $K^{e} \\in \\mathbb{R}^{3 \\times 3}$ for the Laplace operator with unit diffusion is defined by the bilinear form\n$$\nK^{e}_{ij} \\;=\\; \\int_{\\widehat{T}} \\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j} \\, d\\widehat{x}, \\quad i,j \\in \\{1,2,3\\}.\n$$\nStarting from the weak form of the Poisson equation and the definition of the linear shape functions on $\\widehat{T}$, derive $K^{e}$ explicitly by first principles (do not assume any precomputed element matrices), and use your derivation to verify symmetry and to rigorously characterize definiteness. In particular, determine whether $K^{e}$ is strictly positive definite or only positive semidefinite, and identify the nullspace if it exists.\n\nYour final reported quantity must be the exact value of $\\det(K^{e})$ as a single real number. No rounding is required and no units apply. Provide the full derivation and justification, then report only $\\det(K^{e})$ as the final answer.", "solution": "The problem requires the derivation and analysis of the element stiffness matrix $K^{e}$ for the Laplace operator on the standard two-dimensional linear triangular reference element, $\\widehat{T}$. The vertices of $\\widehat{T}$ are given as $\\widehat{\\mathbf{x}}_1 = (0,0)$, $\\widehat{\\mathbf{x}}_2 = (1,0)$, and $\\widehat{\\mathbf{x}}_3 = (0,1)$.\n\nFirst, we must determine the linear Lagrange shape functions $\\{\\widehat{N}_{1}, \\widehat{N}_{2}, \\widehat{N}_{3}\\}$ associated with these vertices. A linear function on $\\mathbb{R}^{2}$ has the general form $\\widehat{N}(\\widehat{x}, \\widehat{y}) = a\\widehat{x} + b\\widehat{y} + c$. The shape function $\\widehat{N}_{i}$ is defined by the property $\\widehat{N}_{i}(\\widehat{\\mathbf{x}}_{j}) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n\nFor $\\widehat{N}_{1}(\\widehat{x}, \\widehat{y}) = a_1\\widehat{x} + b_1\\widehat{y} + c_1$:\nThe conditions are $\\widehat{N}_{1}(0,0)=1$, $\\widehat{N}_{1}(1,0)=0$, $\\widehat{N}_{1}(0,1)=0$.\nFrom $\\widehat{N}_{1}(0,0)=1$, we get $c_1=1$.\nFrom $\\widehat{N}_{1}(1,0)=0$, we get $a_1 + c_1 = 0 \\implies a_1 = -1$.\nFrom $\\widehat{N}_{1}(0,1)=0$, we get $b_1 + c_1 = 0 \\implies b_1 = -1$.\nThus, $\\widehat{N}_{1}(\\widehat{x}, \\widehat{y}) = 1 - \\widehat{x} - \\widehat{y}$.\n\nFor $\\widehat{N}_{2}(\\widehat{x}, \\widehat{y}) = a_2\\widehat{x} + b_2\\widehat{y} + c_2$:\nThe conditions are $\\widehat{N}_{2}(0,0)=0$, $\\widehat{N}_{2}(1,0)=1$, $\\widehat{N}_{2}(0,1)=0$.\nFrom $\\widehat{N}_{2}(0,0)=0$, we get $c_2=0$.\nFrom $\\widehat{N}_{2}(1,0)=1$, we get $a_2 = 1$.\nFrom $\\widehat{N}_{2}(0,1)=0$, we get $b_2 = 0$.\nThus, $\\widehat{N}_{2}(\\widehat{x}, \\widehat{y}) = \\widehat{x}$.\n\nFor $\\widehat{N}_{3}(\\widehat{x}, \\widehat{y}) = a_3\\widehat{x} + b_3\\widehat{y} + c_3$:\nThe conditions are $\\widehat{N}_{3}(0,0)=0$, $\\widehat{N}_{3}(1,0)=0$, $\\widehat{N}_{3}(0,1)=1$.\nFrom $\\widehat{N}_{3}(0,0)=0$, we get $c_3=0$.\nFrom $\\widehat{N}_{3}(1,0)=0$, we get $a_3 = 0$.\nFrom $\\widehat{N}_{3}(0,1)=1$, we get $b_3 = 1$.\nThus, $\\widehat{N}_{3}(\\widehat{x}, \\widehat{y}) = \\widehat{y}$.\n\nNext, we compute the gradients of these shape functions. As the functions are linear, their gradients are constant vectors.\n$$\n\\nabla \\widehat{N}_{1} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}, \\quad\n\\nabla \\widehat{N}_{2} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\nabla \\widehat{N}_{3} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}.\n$$\n\nThe entries of the element stiffness matrix $K^{e}$ are defined by $K^{e}_{ij} = \\int_{\\widehat{T}} \\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j} \\, d\\widehat{x}$. Since the gradients are constant, the dot products $\\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j}$ are also constant. Therefore, the integral is simply the product of this constant value and the area of the domain $\\widehat{T}$.\n$$\nK^{e}_{ij} = (\\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j}) \\int_{\\widehat{T}} 1 \\, d\\widehat{x} = (\\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j}) \\cdot \\text{Area}(\\widehat{T}).\n$$\nThe area of the right triangle with vertices $(0,0)$, $(1,0)$, and $(0,1)$ is $\\text{Area}(\\widehat{T}) = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} \\times 1 \\times 1 = \\frac{1}{2}$.\n\nWe now compute the dot products of the gradients:\n$\\nabla \\widehat{N}_{1} \\cdot \\nabla \\widehat{N}_{1} = (-1)^2 + (-1)^2 = 2$.\n$\\nabla \\widehat{N}_{1} \\cdot \\nabla \\widehat{N}_{2} = (-1)(1) + (-1)(0) = -1$.\n$\\nabla \\widehat{N}_{1} \\cdot \\nabla \\widehat{N}_{3} = (-1)(0) + (-1)(1) = -1$.\n$\\nabla \\widehat{N}_{2} \\cdot \\nabla \\widehat{N}_{2} = (1)^2 + (0)^2 = 1$.\n$\\nabla \\widehat{N}_{2} \\cdot \\nabla \\widehat{N}_{3} = (1)(0) + (0)(1) = 0$.\n$\\nabla \\widehat{N}_{3} \\cdot \\nabla \\widehat{N}_{3} = (0)^2 + (1)^2 = 1$.\n\nUsing these values and $\\text{Area}(\\widehat{T}) = \\frac{1}{2}$, we assemble the matrix $K^{e}$:\n$K^{e}_{11} = 2 \\times \\frac{1}{2} = 1$.\n$K^{e}_{12} = -1 \\times \\frac{1}{2} = -\\frac{1}{2}$.\n$K^{e}_{13} = -1 \\times \\frac{1}{2} = -\\frac{1}{2}$.\n$K^{e}_{22} = 1 \\times \\frac{1}{2} = \\frac{1}{2}$.\n$K^{e}_{23} = 0 \\times \\frac{1}{2} = 0$.\n$K^{e}_{33} = 1 \\times \\frac{1}{2} = \\frac{1}{2}$.\n\nBy commutativity of the dot product, $\\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j} = \\nabla \\widehat{N}_{j} \\cdot \\nabla \\widehat{N}_{i}$, which implies $K^{e}_{ij} = K^{e}_{ji}$. The matrix is symmetric. The full matrix is:\n$$\nK^{e} = \\begin{pmatrix}\n1  -\\frac{1}{2}  -\\frac{1}{2} \\\\\n-\\frac{1}{2}  \\frac{1}{2}  0 \\\\\n-\\frac{1}{2}  0  \\frac{1}{2}\n\\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix}\n2  -1  -1 \\\\\n-1  1  0 \\\\\n-1  0  1\n\\end{pmatrix}.\n$$\n\nNow, we analyze the definiteness of $K^{e}$. Consider an arbitrary vector $\\mathbf{v} = (v_1, v_2, v_3)^T \\in \\mathbb{R}^3$ and the associated quadratic form $\\mathbf{v}^T K^e \\mathbf{v}$. Let $\\widehat{u}_h(\\widehat{\\mathbf{x}}) = \\sum_{j=1}^{3} v_j \\widehat{N}_j(\\widehat{\\mathbf{x}})$ be a function in the finite element space. The quadratic form is:\n$$\n\\mathbf{v}^T K^e \\mathbf{v} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} v_i K^{e}_{ij} v_j = \\sum_{i,j} v_i v_j \\int_{\\widehat{T}} \\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j} \\, d\\widehat{x}\n$$\nBy linearity of integration and differentiation, this becomes:\n$$\n\\mathbf{v}^T K^e \\mathbf{v} = \\int_{\\widehat{T}} \\left( \\sum_{i=1}^{3} v_i \\nabla \\widehat{N}_{i} \\right) \\cdot \\left( \\sum_{j=1}^{3} v_j \\nabla \\widehat{N}_{j} \\right) \\, d\\widehat{x} = \\int_{\\widehat{T}} |\\nabla \\widehat{u}_h|^2 \\, d\\widehat{x}.\n$$\nSince the integrand $|\\nabla \\widehat{u}_h|^2$ is non-negative, the integral is non-negative. Therefore, $\\mathbf{v}^T K^e \\mathbf{v} \\geq 0$ for all $\\mathbf{v} \\in \\mathbb{R}^3$, which proves that $K^{e}$ is positive semidefinite.\n\nFor $K^{e}$ to be positive definite, $\\mathbf{v}^T K^e \\mathbf{v} = 0$ must imply $\\mathbf{v} = \\mathbf{0}$. The condition $\\mathbf{v}^T K^e \\mathbf{v} = 0$ is equivalent to $\\int_{\\widehat{T}} |\\nabla \\widehat{u}_h|^2 \\, d\\widehat{x} = 0$. Since the integrand is continuous and non-negative, this implies $\\nabla \\widehat{u}_h(\\widehat{\\mathbf{x}}) = \\mathbf{0}$ for all $\\widehat{\\mathbf{x}} \\in \\widehat{T}$.\n$$\n\\nabla \\widehat{u}_h = \\nabla \\left( \\sum_{j=1}^{3} v_j \\widehat{N}_j \\right) = \\sum_{j=1}^{3} v_j \\nabla \\widehat{N}_j = v_1 \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} + v_2 \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + v_3 \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -v_1 + v_2 \\\\ -v_1 + v_3 \\end{pmatrix}.\n$$\nSetting the gradient to zero gives the system:\n$$\n-v_1 + v_2 = 0 \\implies v_1 = v_2\n$$\n$$\n-v_1 + v_3 = 0 \\implies v_1 = v_3\n$$\nThus, $\\nabla \\widehat{u}_h = \\mathbf{0}$ if and only if $v_1 = v_2 = v_3$. Any vector of the form $\\mathbf{v} = c(1, 1, 1)^T$ for a scalar $c \\in \\mathbb{R}$ will result in $\\mathbf{v}^T K^e \\mathbf{v} = 0$. If $c \\neq 0$, then $\\mathbf{v} \\neq \\mathbf{0}$. This proves that $K^{e}$ is not positive definite; it is only positive semidefinite.\nThe set of such vectors forms the nullspace (kernel) of $K^e$:\n$$\n\\text{ker}(K^e) = \\{ \\mathbf{v} \\in \\mathbb{R}^3 : K^e \\mathbf{v} = \\mathbf{0} \\} = \\text{span} \\left\\{ \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right\\}.\n$$\nThe physical meaning is that constant functions $\\widehat{u}_h = c \\sum \\widehat{N}_j = c(1) = c$ have zero gradient, and thus zero \"strain energy\" $\\int |\\nabla u|^2$.\n\nFinally, we must compute the determinant of $K^{e}$. A fundamental theorem of linear algebra states that a square matrix is singular (i.e., not invertible) if and only if its nullspace is non-trivial. As we have shown that $\\text{dim}(\\text{ker}(K^e)) = 1$, the matrix $K^{e}$ is singular. The determinant of any singular matrix is zero.\nTherefore, $\\det(K^{e}) = 0$.\n\nFor completeness, we verify this by direct computation:\n$$\n\\det(K^{e}) = \\det \\begin{pmatrix}\n1  -\\frac{1}{2}  -\\frac{1}{2} \\\\\n-\\frac{1}{2}  \\frac{1}{2}  0 \\\\\n-\\frac{1}{2}  0  \\frac{1}{2}\n\\end{pmatrix}\n$$\n$$\n= 1 \\left( (\\frac{1}{2})(\\frac{1}{2}) - (0)(0) \\right) - (-\\frac{1}{2}) \\left( (-\\frac{1}{2})(\\frac{1}{2}) - (0)(-\\frac{1}{2}) \\right) + (-\\frac{1}{2}) \\left( (-\\frac{1}{2})(0) - (\\frac{1}{2})(-\\frac{1}{2}) \\right)\n$$\n$$\n= 1 \\left( \\frac{1}{4} \\right) + \\frac{1}{2} \\left( -\\frac{1}{4} \\right) - \\frac{1}{2} \\left( \\frac{1}{4} \\right)\n$$\n$$\n= \\frac{1}{4} - \\frac{1}{8} - \\frac{1}{8} = \\frac{1}{4} - \\frac{2}{8} = \\frac{1}{4} - \\frac{1}{4} = 0.\n$$\nThe calculation confirms the theoretical result. The final answer is $0$.", "answer": "$$\n\\boxed{0}\n$$", "id": "2579542"}, {"introduction": "A good numerical method should not only be accurate but also preserve important qualitative properties of the original partial differential equation, such as the maximum principle. This exercise is a thought experiment that challenges you to connect mesh geometry directly to the algebraic properties of the stiffness matrix and, ultimately, to the behavior of the solution. By constructing a specific mesh that violates the discrete maximum principle, you will develop a crucial intuition for the importance of mesh quality in finite element analysis. [@problem_id:2579531]", "problem": "Consider the model problem for the Poisson equation: find $u:\\Omega \\to \\mathbb{R}$ such that $-\\Delta u = f$ in $\\Omega$ with $u = 0$ on $\\partial \\Omega$, where $\\Omega \\subset \\mathbb{R}^2$ is a polygonal domain. Let $V_h$ be the conforming space of continuous, piecewise linear functions ($P_1$ finite elements) over a shape-regular triangulation $\\mathcal{T}_h$ of $\\Omega$. The Galerkin method seeks $u_h \\in V_h$ such that $\\int_{\\Omega} \\nabla u_h \\cdot \\nabla v_h \\, dx = \\int_{\\Omega} f v_h \\, dx$ for all $v_h \\in V_h$ vanishing on $\\partial \\Omega$. For data $f \\le 0$ (pointwise almost everywhere), the continuous maximum principle implies $u \\le 0$ in $\\Omega$. A commonly used sufficient algebraic condition for the discrete maximum principle is that the assembled stiffness matrix has nonpositive off-diagonal entries and is an $M$-matrix.\n\nYour task is to identify a concrete mesh construction that contains an obtuse triangle and, for homogeneous Dirichlet boundary conditions, actually violates the discrete maximum principle for $P_1$ elements. Select the option that both:\n- specifies a triangulation with enough detail to identify an interior edge whose assembled off-diagonal stiffness entry becomes positive, and\n- correctly explains the algebraic reason in terms of the signs of the assembled off-diagonal stiffness entries.\n\nChoose exactly one option.\n\nA. Let $\\Omega = (0,1)^2$. Introduce interior nodes $i=(0.25,0.25)$ and $j=(0.75,0.25)$, and two additional vertices $k=(0.5,0.26)$ (just above the segment $\\overline{ij}$) and $\\ell=(0.5,0.80)$ (well above $\\overline{ij}$). Include the two triangles $T_1 = \\triangle(i,j,k)$ and $T_2 = \\triangle(i,j,\\ell)$ in the triangulation, and complete the mesh on $\\Omega$ with any shape-regular triangulation that uses these vertices and imposes $u_h=0$ on $\\partial \\Omega$. The angle at $k$ opposite the interior edge $(i,j)$ is obtuse, with $\\alpha_k \\approx \\pi - 2\\arctan\\left(\\frac{0.01}{0.25}\\right)$, so $\\cot \\alpha_k  0$ with large magnitude, while the angle at $\\ell$ opposite $(i,j)$ is acute, with $\\cot \\alpha_\\ell  0$ but moderate. Therefore, the assembled off-diagonal entry for the interior edge $(i,j)$ satisfies $K_{ij} = -\\tfrac{1}{2}\\big(\\cot \\alpha_k + \\cot \\alpha_\\ell\\big)  0$. This breaks the nonpositivity of off-diagonals, so the stiffness matrix is not an $M$-matrix and the discrete maximum principle can be violated for some $f \\le 0$.\n\nB. Let $\\Omega$ be the right triangle with vertices $(0,0)$, $(1,0)$, $(0,1)$. Insert a single interior node $p=(0.5,0.10)$ and connect $p$ to all three vertices to form three triangles, one of which has an obtuse angle at $p$ opposite the boundary edge $[(0,0),(1,0)]$. Since this produces a positive off-diagonal between the boundary nodes $(0,0)$ and $(1,0)$, the discrete maximum principle is violated.\n\nC. Let $\\Omega = (0,1)^2$. Introduce interior nodes $i=(0.25,0.25)$ and $j=(0.75,0.25)$, and place $k=(0.5,0.60)$ and $\\ell=(0.5,0.80)$ above the segment $\\overline{ij}$. Include $T_1=\\triangle(i,j,k)$ and $T_2=\\triangle(i,j,\\ell)$ and complete the mesh on $\\Omega$ with $u_h=0$ on $\\partial \\Omega$. Although both angles opposite $(i,j)$ in $T_1$ and $T_2$ are acute, the presence of two adjacent triangles around the interior edge is enough to force a violation of the discrete maximum principle due to mesh anisotropy.\n\nD. Let $\\Omega = (0,1)^2$. Introduce interior nodes $i=(0.25,0.25)$ and $j=(0.75,0.25)$, take $k=(0.5,0.40)$ slightly above $\\overline{ij}$ and use the boundary vertex $\\ell=(0.5,1)$, and triangulate so that $T_1=\\triangle(i,j,k)$ and $T_2=\\triangle(i,j,\\ell)$ are included. The angle at $k$ opposite $(i,j)$ is obtuse, hence the discrete maximum principle must fail because an obtuse angle always forces a positive assembled off-diagonal $K_{ij}$.", "solution": "The problem statement poses a valid question within the established theory of the finite element method for second-order elliptic partial differential equations. The premises are scientifically sound, the terminology is standard, and the task is a well-posed constructive problem. We will therefore proceed with the analysis.\n\nThe core of this problem rests upon the formula for the off-diagonal entries of the stiffness matrix $K$ for the negative Laplacian operator discretized with continuous, piecewise linear ($P_1$) basis functions. Let $i$ and $j$ be the indices of two distinct nodes in the triangulation $\\mathcal{T}_h$. The corresponding off-diagonal entry of the stiffness matrix is $K_{ij} = a(\\phi_j, \\phi_i) = \\int_{\\Omega} \\nabla \\phi_i \\cdot \\nabla \\phi_j \\, dx$, where $\\phi_i$ and $\\phi_j$ are the Lagrangian basis functions associated with nodes $i$ and $j$.\n\nThis integral is non-zero only if nodes $i$ and $j$ belong to a common triangle. If the edge connecting nodes $i$ and $j$, denoted by $e_{ij}$, is an interior edge of the mesh, it is typically shared by two triangles, say $T_1$ and $T_2$. Let the vertices of these triangles be $(i, j, k)$ and $(i, j, \\ell)$, respectively. The angles in $T_1$ and $T_2$ opposite the shared edge $e_{ij}$ are denoted by $\\alpha_k$ and $\\alpha_\\ell$. A standard result from finite element analysis states that the contribution from a single triangle $T_1$ to the stiffness entry is $\\int_{T_1} \\nabla \\phi_i \\cdot \\nabla \\phi_j \\, dx = -\\frac{1}{2} \\cot \\alpha_k$.\n\nConsequently, the assembled off-diagonal entry for the interior edge $e_{ij}$ is the sum of contributions from both triangles:\n$$ K_{ij} = -\\frac{1}{2} (\\cot \\alpha_k + \\cot \\alpha_\\ell) $$\nA sufficient condition for the discrete maximum principle (DMP) to hold is that the stiffness matrix (for interior nodes) is an $M$-matrix. A necessary property of an $M$-matrix is that all its off-diagonal entries are non-positive. Thus, we require $K_{ij} \\le 0$ for all $i \\neq j$. From the formula above, this is equivalent to the condition:\n$$ \\cot \\alpha_k + \\cot \\alpha_\\ell \\ge 0 $$\nThis is a local, geometry-based condition often called the Delaunay condition. An angle $\\alpha$ is acute if $0  \\alpha  \\pi/2$, for which $\\cot \\alpha  0$. An angle is obtuse if $\\pi/2  \\alpha  \\pi$, for which $\\cot \\alpha  0$. If both $\\alpha_k$ and $\\alpha_\\ell$ are acute, the condition is trivially satisfied and $K_{ij}  0$. A violation, leading to $K_{ij}  0$, can only occur if one of the angles is obtuse, say $\\alpha_k  \\pi/2$, such that its negative cotangent is large enough in magnitude to overcome the positive cotangent of the other angle: $|\\cot \\alpha_k|  \\cot \\alpha_\\ell$.\n\nWe now evaluate each option based on this principle.\n\n**Option A:**\nThis option proposes a specific mesh geometry. Let the nodes be $i=(0.25, 0.25)$, $j=(0.75, 0.25)$, $k=(0.5, 0.26)$, and $\\ell=(0.5, 0.80)$. The common edge is $\\overline{ij}$, which has length $d_{ij}=0.5$.\nFor triangle $T_1 = \\triangle(i,j,k)$, the vertex $k$ is at a height of $h_k = 0.26 - 0.25 = 0.01$ above the midpoint of $\\overline{ij}$. This is an isosceles triangle. The angle $\\alpha_k$ at vertex $k$ is obtuse. We can calculate its cotangent. The angle $\\theta$ at the base is given by $\\tan \\theta = h_k / (d_{ij}/2) = 0.01 / 0.25 = 1/25$. The angle $\\alpha_k = \\pi - 2\\theta$. Thus, $\\cot \\alpha_k = \\cot(\\pi-2\\theta) = -\\cot(2\\theta) = -\\frac{1-\\tan^2\\theta}{2\\tan\\theta} = -\\frac{1-(1/25)^2}{2(1/25)} = -\\frac{1 - 1/625}{2/25} = -\\frac{624/625}{2/25} = -\\frac{624}{625} \\cdot \\frac{25}{2} = -\\frac{312}{25} = -12.48$. This is a large-magnitude negative number.\nFor triangle $T_2 = \\triangle(i,j,\\ell)$, the vertex $\\ell$ is at a height of $h_\\ell = 0.80 - 0.25 = 0.55$ above the midpoint of $\\overline{ij}$. The angle $\\alpha_\\ell$ is acute. The angle $\\phi$ at the base is given by $\\tan \\phi = h_\\ell / (d_{ij}/2) = 0.55 / 0.25 = 55/25 = 11/5$. This is incorrect, $\\phi$ is not the base angle. The half angle at vertex $\\ell$, let's call it $\\gamma$, satisfies $\\tan \\gamma = (d_{ij}/2)/h_\\ell = 0.25/0.55 = 25/55 = 5/11$. Then $\\cot \\alpha_\\ell = \\frac{1-\\tan^2\\gamma}{2\\tan\\gamma} = \\frac{1-(5/11)^2}{2(5/11)} = \\frac{1-25/121}{10/11} = \\frac{96/121}{10/11} = \\frac{96}{110} = \\frac{48}{55} \\approx 0.8727$.\nThe sum of the cotangents is $\\cot \\alpha_k + \\cot \\alpha_\\ell = -12.48 + \\frac{48}{55} \\approx -12.48 + 0.8727 = -11.6073  0$.\nTherefore, the assembled off-diagonal entry is $K_{ij} = -\\frac{1}{2}(\\cot \\alpha_k + \\cot \\alpha_\\ell)  0$. This violates the non-positivity condition. The reasoning provided in the option is entirely consistent with this derivation.\nVerdict: **Correct**.\n\n**Option B:**\nThis option describes a triangulation where an obtuse angle is formed opposite a *boundary* edge. The nodes on the boundary are subject to Dirichlet conditions ($u_h = 0$). In the assembly of the linear system $Ku=F$, the equations corresponding to boundary nodes are not solved for; they are eliminated from the system. The matrix properties, such as being an M-matrix, that guarantee the DMP are required for the reduced stiffness matrix corresponding only to the *interior* degrees of freedom. An off-diagonal entry between two boundary nodes, such as $K_{(0,0),(1,0)}$, does not appear in this reduced system and has no influence on the interior solution's adherence to the DMP. Therefore, the reasoning is fundamentally flawed.\nVerdict: **Incorrect**.\n\n**Option C:**\nThis option proposes a configuration with nodes $i=(0.25,0.25)$, $j=(0.75,0.25)$, $k=(0.5,0.60)$, and $\\ell=(0.5,0.80)$. Both triangles $T_1 = \\triangle(i,j,k)$ and $T_2 = \\triangle(i,j,\\ell)$ are isosceles with a common base $\\overline{ij}$.\nFor $T_1$, the height is $h_k = 0.60 - 0.25 = 0.35$. The half-angle at $k$ is $\\gamma_k$ where $\\tan \\gamma_k = (0.5/2)/0.35 = 0.25/0.35 = 5/7  1$. Thus $\\gamma_k  \\pi/4$, which implies the full angle $\\alpha_k  \\pi/2$. It is acute, and $\\cot \\alpha_k  0$.\nFor $T_2$, the height is $h_\\ell = 0.80 - 0.25 = 0.55$. The half-angle at $\\ell$ is $\\gamma_\\ell$ where $\\tan \\gamma_\\ell = 0.25/0.55 = 5/11  1$. Thus the full angle $\\alpha_\\ell  \\pi/2$. It is also acute, and $\\cot \\alpha_\\ell  0$.\nThe assembled off-diagonal is $K_{ij} = -\\frac{1}{2}(\\cot \\alpha_k + \\cot \\alpha_\\ell)$. Since both cotangents are positive, their sum is positive, and $K_{ij}$ must be negative. The non-positivity condition is satisfied. The claim that this configuration forces a violation of the DMP is false; on the contrary, for this specific edge, the condition is met. The term \"mesh anisotropy\" is used vaguely and does not justify the incorrect conclusion.\nVerdict: **Incorrect**.\n\n**Option D:**\nThis option proposes a geometry with an obtuse triangle and makes the claim that an obtuse angle \"always forces a positive assembled off-diagonal $K_{ij}$.\" This claim is a logical fallacy. The sign of $K_{ij}$ depends on the sign of $-(\\cot \\alpha_k + \\cot \\alpha_\\ell)$. For $K_{ij}$ to be positive, we need $\\cot \\alpha_k + \\cot \\alpha_\\ell  0$. If one angle, $\\alpha_k$, is obtuse, $\\cot \\alpha_k$ is negative. This is a necessary condition, but not sufficient. If the other angle, $\\alpha_\\ell$, is acute and sufficiently \"sharp\" (close to $0$), its cotangent will be large and positive, potentially making the sum non-negative.\nLet us examine the specific geometry provided: $i=(0.25,0.25)$, $j=(0.75,0.25)$, $k=(0.5,0.40)$, $\\ell=(0.5,1)$.\nFor $T_1 = \\triangle(i,j,k)$, height $h_k=0.40-0.25=0.15$. Half-angle $\\gamma_k$ at $k$ has $\\tan \\gamma_k = (0.5/2)/0.15 = 0.25/0.15 = 5/3  1$. Thus, $\\alpha_k  \\pi/2$ (obtuse). We calculate $\\cot \\alpha_k = \\frac{1-\\tan^2\\gamma_k}{2\\tan\\gamma_k} = \\frac{1-(5/3)^2}{2(5/3)} = \\frac{1-25/9}{10/3} = \\frac{-16/9}{10/3} = -\\frac{16}{30} = -\\frac{8}{15}$.\nFor $T_2 = \\triangle(i,j,\\ell)$, height $h_\\ell = 1-0.25=0.75$. Half-angle $\\gamma_\\ell$ at $\\ell$ has $\\tan \\gamma_\\ell = (0.5/2)/0.75 = 0.25/0.75 = 1/3  1$. Thus, $\\alpha_\\ell  \\pi/2$ (acute). We calculate $\\cot \\alpha_\\ell = \\frac{1-(1/3)^2}{2(1/3)} = \\frac{1-1/9}{2/3} = \\frac{8/9}{2/3} = \\frac{12}{9} = \\frac{4}{3}$.\nThe sum is $\\cot \\alpha_k + \\cot \\alpha_\\ell = -8/15 + 4/3 = (-8 + 20)/15 = 12/15  0$.\nThe assembled stiffness entry is $K_{ij} = -\\frac{1}{2}(12/15)  0$.\nThe non-positivity condition is satisfied for this edge. The example provided in the option directly contradicts its own fallacious claim.\nVerdict: **Incorrect**.\n\nBased on this rigorous analysis, Option A is the only one that provides both a correct geometric construction and a correct algebraic explanation for the violation of the non-positivity of off-diagonal stiffness matrix entries, which is a key condition for the discrete maximum principle.", "answer": "$$\\boxed{A}$$", "id": "2579531"}]}