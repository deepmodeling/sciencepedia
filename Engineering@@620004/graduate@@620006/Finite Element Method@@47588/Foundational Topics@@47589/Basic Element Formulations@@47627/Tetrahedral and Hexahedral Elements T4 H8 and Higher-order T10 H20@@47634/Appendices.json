{"hands_on_practices": [{"introduction": "We begin our hands-on journey with the foundational building block of 3D analysis: the four-node linear tetrahedral element (T4). This exercise guides you through constructing its shape functions, $N_i$, not from a given formula but from first principles. By enforcing the definitional property that each shape function must be $1$ at its own node and $0$ at others ($N_i(\\mathbf{X}_j) = \\delta_{ij}$), you will see how these functions arise naturally from a system of linear equations. This practice [@problem_id:2604811] is crucial for understanding that shape functions are not arbitrary but are the unique affine interpolants for the element's geometry, and it reinforces their role as barycentric coordinates within the element.", "problem": "Consider a linear tetrahedral finite element (T4) with nodes at physical coordinates $\\mathbf{X}_1=(0,0,0)$, $\\mathbf{X}_2=(2,0,0)$, $\\mathbf{X}_3=(0,3,0)$, and $\\mathbf{X}_4=(1,1,6)$. For a T4 element, the scalar shape functions $N_i(x,y,z)$ are barycentric coordinates that are affine in $(x,y,z)$ and satisfy the interpolation property at the nodes.\n\nStarting only from the core definitions that (i) the T4 shape functions are affine functions $N_i(x,y,z)=\\alpha_i+\\beta_i x+\\gamma_i y+\\delta_i z$ and (ii) they satisfy $N_i(\\mathbf{X}_j)=\\delta_{ij}$ and $\\sum_{i=1}^{4}N_i(x,y,z)=1$, construct the explicit expressions $N_i(x,y,z)$ by solving the associated linear barycentric coordinate system. Then verify, using first principles, that $N_i(x,y,z)\\ge 0$ for every point $(x,y,z)$ inside the tetrahedron.\n\nProvide the final answer as the single row vector $\\big[N_1(x,y,z)\\;N_2(x,y,z)\\;N_3(x,y,z)\\;N_4(x,y,z)\\big]$ in closed form. No rounding is required.", "solution": "The nodal coordinates define a non-degenerate tetrahedron, as the volume is non-zero. The volume $V$ of a tetrahedron with vertices $\\mathbf{X}_1, \\mathbf{X}_2, \\mathbf{X}_3, \\mathbf{X}_4$ is given by $V = \\frac{1}{6} |\\det(\\mathbf{X}_2 - \\mathbf{X}_1, \\mathbf{X}_3 - \\mathbf{X}_1, \\mathbf{X}_4 - \\mathbf{X}_1)|$. With $\\mathbf{X}_1 = (0,0,0)$, this becomes:\n$$\nV = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 2 & 0 & 1 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & 6 \\end{pmatrix} \\right| = \\frac{1}{6} |(2)(3)(6)| = \\frac{36}{6} = 6\n$$\nSince $V \\neq 0$, the element is geometrically valid. We may proceed to construct the shape functions.\n\nThe shape functions $N_i(x,y,z)$ for a linear tetrahedral element are affine functions of the coordinates $(x,y,z)$, having the general form:\n$$\nN_i(x,y,z) = \\alpha_i + \\beta_i x + \\gamma_i y + \\delta_i z\n$$\nThese coefficients are determined by enforcing the fundamental interpolation property at the element's nodes, $\\mathbf{X}_j = (x_j, y_j, z_j)$:\n$$\nN_i(\\mathbf{X}_j) = \\delta_{ij}\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta. This property yields a system of four linear equations for the four unknown coefficients $(\\alpha_i, \\beta_i, \\gamma_i, \\delta_i)$ for each shape function $N_i$.\n\nThese separate systems can be consolidated into a single matrix equation. Let the coordinate vector in homogeneous form be $\\mathbf{p_h} = [1, x, y, z]^T$. Then the shape functions can be expressed as $\\mathbf{N} = \\mathbf{M} \\mathbf{p_h}$, where $\\mathbf{M}$ is a $4 \\times 4$ matrix of the coefficients $\\alpha_i, \\beta_i, \\gamma_i, \\delta_i$.\nThe interpolation property $N_i(\\mathbf{X}_j) = \\delta_{ij}$ implies $\\mathbf{M} \\mathbf{X} = \\mathbf{I}$, where $\\mathbf{I}$ is the $4 \\times 4$ identity matrix and $\\mathbf{X}$ is the matrix whose columns are the homogeneous coordinates of the nodes:\n$$\n\\mathbf{X} = \\begin{pmatrix}\n1 & 1 & 1 & 1 \\\\\nx_1 & x_2 & x_3 & x_4 \\\\\ny_1 & y_2 & y_3 & y_4 \\\\\nz_1 & z_2 & z_3 & z_4\n\\end{pmatrix}\n$$\nFrom this, it is clear that the coefficient matrix $\\mathbf{M}$ is the inverse of the nodal coordinate matrix $\\mathbf{X}$.\nSubstituting the given nodal coordinates $\\mathbf{X}_1=(0,0,0)$, $\\mathbf{X}_2=(2,0,0)$, $\\mathbf{X}_3=(0,3,0)$, and $\\mathbf{X}_4=(1,1,6)$:\n$$\n\\mathbf{X} = \\begin{pmatrix}\n1 & 1 & 1 & 1 \\\\\n0 & 2 & 0 & 1 \\\\\n0 & 0 & 3 & 1 \\\\\n0 & 0 & 0 & 6\n\\end{pmatrix}\n$$\nThe determinant of this upper triangular matrix is the product of its diagonal entries: $\\det(\\mathbf{X}) = 1 \\cdot 2 \\cdot 3 \\cdot 6 = 36$.\nWe find the inverse matrix $\\mathbf{M} = \\mathbf{X}^{-1}$. We can use Gauss-Jordan elimination or the adjugate matrix method. The result is:\n$$\n\\mathbf{M} = \\mathbf{X}^{-1} = \\begin{pmatrix}\n1 & -\\frac{1}{2} & -\\frac{1}{3} & -\\frac{1}{36} \\\\\n0 & \\frac{1}{2} & 0 & -\\frac{1}{12} \\\\\n0 & 0 & \\frac{1}{3} & -\\frac{1}{18} \\\\\n0 & 0 & 0 & \\frac{1}{6}\n\\end{pmatrix}\n$$\nThe rows of $\\mathbf{M}$ contain the coefficients for each shape function $N_i$.\nThus, by performing the multiplication $\\mathbf{N} = \\mathbf{M} \\mathbf{p_h}$:\n$$\n\\begin{pmatrix}\nN_1 \\\\ N_2 \\\\ N_3 \\\\ N_4\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & -\\frac{1}{2} & -\\frac{1}{3} & -\\frac{1}{36} \\\\\n0 & \\frac{1}{2} & 0 & -\\frac{1}{12} \\\\\n0 & 0 & \\frac{1}{3} & -\\frac{1}{18} \\\\\n0 & 0 & 0 & \\frac{1}{6}\n\\end{pmatrix}\n\\begin{pmatrix}\n1 \\\\ x \\\\ y \\\\ z\n\\end{pmatrix}\n$$\nThis gives the explicit expressions for the shape functions:\n$N_1(x,y,z) = 1 - \\frac{1}{2}x - \\frac{1}{3}y - \\frac{1}{36}z$\n$N_2(x,y,z) = \\frac{1}{2}x - \\frac{1}{12}z$\n$N_3(x,y,z) = \\frac{1}{3}y - \\frac{1}{18}z$\n$N_4(x,y,z) = \\frac{1}{6}z$\n\nNext, we must verify that $N_i(x,y,z) \\ge 0$ for any point $(x,y,z)$ inside the tetrahedron.\nA point $\\mathbf{P}=(x,y,z)$ is located inside or on the boundary of the tetrahedron if it can be expressed as a convex combination of the vertex coordinates: $\\mathbf{P} = \\sum_{j=1}^4 c_j \\mathbf{X}_j$, with coefficients $c_j \\ge 0$ and $\\sum_{j=1}^4 c_j = 1$. The coefficients $c_j$ are precisely the barycentric coordinates.\n\nThe shape functions $N_i(x,y,z)$ are affine (linear plus a constant). A fundamental property of affine functions defined over a convex set (such as a tetrahedron) is that they attain their maximum and minimum values at the vertices of the set.\nLet $T$ denote the convex hull of the nodes $\\{\\mathbf{X}_1, \\mathbf{X}_2, \\mathbf{X}_3, \\mathbf{X}_4\\}$.\nFor any shape function $N_i$, its minimum value over the domain $T$ is:\n$$\n\\min_{\\mathbf{P} \\in T} N_i(\\mathbf{P}) = \\min_{j \\in \\{1,2,3,4\\}} N_i(\\mathbf{X}_j)\n$$\nBy construction, the shape functions satisfy the interpolation property $N_i(\\mathbf{X}_j) = \\delta_{ij}$. This means that for a given $i$, the value of $N_i$ is $1$ at node $\\mathbf{X}_i$ and $0$ at all other nodes $\\mathbf{X}_j$ where $j \\neq i$.\nTherefore, the set of values for any $N_i$ at the vertices is $\\{1, 0, 0, 0\\}$.\nThe minimum value is clearly $0$.\n$$\n\\min_{\\mathbf{P} \\in T} N_i(\\mathbf{P}) = 0\n$$\nThis proves that for any point $\\mathbf{P}=(x,y,z)$ inside or on the boundary of the tetrahedron, $N_i(x,y,z) \\ge 0$. This holds for each $i=1, 2, 3, 4$. The verification is complete.\n\nThe final answer requires the expressions for the four shape functions arranged in a row vector.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 - \\frac{1}{2}x - \\frac{1}{3}y - \\frac{1}{36}z & \\frac{1}{2}x - \\frac{1}{12}z & \\frac{1}{3}y - \\frac{1}{18}z & \\frac{1}{6}z\n\\end{pmatrix}\n}\n$$", "id": "2604811"}, {"introduction": "Having established how to formulate basic shape functions, we now apply this knowledge to a higher-order element, the ten-node quadratic tetrahedron (T10), and tackle a core task in structural analysis. This problem involves calculating the strain-displacement matrix, $\\boldsymbol{B}$, which links nodal displacements to the internal strains within the element. You will construct the Jacobian matrix of the isoparametric mapping, $\\boldsymbol{J}$, and use it to transform local shape function derivatives into the global derivatives needed for the $\\boldsymbol{B}$ matrix. This exercise [@problem_id:2604787] provides direct, practical experience with the chain rule mechanics that are central to the entire isoparametric FEM framework.", "problem": "Consider a ten-node quadratic tetrahedral element ($T10$) used in the isoparametric finite element formulation for three-dimensional linearized kinematics. Let the global Cartesian coordinates of the nodes be given by:\n- Vertex nodes:\n  - Node $1$: $(x_1,y_1,z_1)=(0,0,0)$,\n  - Node $2$: $(x_2,y_2,z_2)=(2,0,0)$,\n  - Node $3$: $(x_3,y_3,z_3)=(0,3,0)$,\n  - Node $4$: $(x_4,y_4,z_4)=(0,0,4)$.\n- Midside nodes (located at the midpoints of the corresponding edges):\n  - Node $5$ on edge $(1,2)$: $(x_5,y_5,z_5)=(1,0,0)$,\n  - Node $6$ on edge $(2,3)$: $(x_6,y_6,z_6)=(1,1.5,0)$,\n  - Node $7$ on edge $(1,3)$: $(x_7,y_7,z_7)=(0,1.5,0)$,\n  - Node $8$ on edge $(1,4)$: $(x_8,y_8,z_8)=(0,0,2)$,\n  - Node $9$ on edge $(2,4)$: $(x_9,y_9,z_9)=(1,0,2)$,\n  - Node $10$ on edge $(3,4)$: $(x_{10},y_{10},z_{10})=(0,1.5,2)$.\n\nUse the standard isoparametric mapping with quadratic Lagrange shape functions on the reference tetrahedron defined by barycentric coordinates $(L_1,L_2,L_3,L_4)$, with $L_1=\\xi$, $L_2=\\eta$, $L_3=\\zeta$, and $L_4=1-\\xi-\\eta-\\zeta$. The mapping from the reference element to the physical element is $x_p(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{10} N_i(\\xi,\\eta,\\zeta)\\,X_{i,p}$ for $p\\in\\{x,y,z\\}$, where $X_{i,p}$ are the Cartesian coordinates of node $i$.\n\nStarting from the fundamental definitions of isoparametric interpolation and the Lagrange basis on a tetrahedron (i.e., that each shape function $N_i$ equals $1$ at its own node and $0$ at all other nodes in the reference element), perform the following at the centroid of the reference tetrahedron given by $(L_1,L_2,L_3,L_4)=(\\tfrac{1}{4},\\tfrac{1}{4},\\tfrac{1}{4},\\tfrac{1}{4})$:\n- Construct the local-to-global derivative mapping by computing the Jacobian matrix $J=\\partial \\boldsymbol{x}/\\partial(\\xi,\\eta,\\zeta)$ and its inverse transpose $J^{-T}$ at the centroid.\n- Using the small-strain tensor in Voigt notation for three dimensions, assemble the strain-displacement matrix $B(\\xi,\\eta,\\zeta)$ at the centroid.\n\nFinally, report the scalar value equal to the component of $B$ associated with the normal strain $\\varepsilon_{xx}$ and the $x$-direction displacement of node $6$, which is the quantity $\\partial N_6/\\partial x$ evaluated at the centroid. Express the final result as an exact value (no rounding). No units are required.", "solution": "The objective is to compute the value of $\\frac{\\partial N_6}{\\partial x}$ at the centroid of the reference element, where $N_6$ is the shape function for node $6$, and $x$ is the global Cartesian coordinate.\n\nThe relationship between derivatives in the global Cartesian coordinate system $(x,y,z)$ and the local reference coordinate system $(\\xi,\\eta,\\zeta)$ is given by the chain rule. For any shape function $N_i$, we have:\n$$\n\\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\\\ \\frac{\\partial N_i}{\\partial \\zeta} \\end{pmatrix}\n=\n\\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial z}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} & \\frac{\\partial z}{\\partial \\eta} \\\\ \\frac{\\partial x}{\\partial \\zeta} & \\frac{\\partial y}{\\partial \\zeta} & \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix}\n\\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial z} \\end{pmatrix}\n=\nJ^T\n\\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial z} \\end{pmatrix}\n$$\nwhere $J$ is the Jacobian matrix, defined as $J_{ij} = \\frac{\\partial x_i}{\\partial \\xi_j}$. To find the derivatives with respect to global coordinates, we must invert this relationship:\n$$\n\\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial z} \\end{pmatrix} = (J^T)^{-1} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\\\ \\frac{\\partial N_i}{\\partial \\zeta} \\end{pmatrix} = J^{-T} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\\\ \\frac{\\partial N_i}{\\partial \\zeta} \\end{pmatrix}\n$$\nThe procedure is as follows:\n1. Define the shape functions $N_i$ in terms of local coordinates $(\\xi,\\eta,\\zeta)$.\n2. Compute the derivatives of the required shape function, $N_6$, with respect to $(\\xi, \\eta, \\zeta)$ at the centroid.\n3. Compute the Jacobian matrix $J$ at the centroid.\n4. Calculate the inverse transpose of the Jacobian, $J^{-T}$.\n5. Multiply $J^{-T}$ by the vector of local derivatives of $N_6$ to obtain the global derivatives.\n\n**Step 1: Shape Functions**\nThe problem uses barycentric coordinates $L_1=\\xi, L_2=\\eta, L_3=\\zeta, L_4=1-\\xi-\\eta-\\zeta$. The physical nodes are mapped from the reference tetrahedron vertices such that node 1 is at the origin $(L_4=1)$, node 2 is on the $\\xi$-axis $(L_1=1)$, node 3 is on the $\\eta$-axis $(L_2=1)$, and node 4 is on the $\\zeta$-axis $(L_3=1)$. The quadratic shape functions for a midside node on the edge between vertices corresponding to $L_i$ and $L_j$ is $N_{ij} = 4L_iL_j$.\n\nNode 6 is on the edge between physical node 2 and node 3. These correspond to the reference vertices where $L_1=1$ and $L_2=1$, respectively. Thus, the shape function for node 6 is:\n$$\nN_6(L_1, L_2) = 4L_1L_2\n$$\nSubstituting $L_1=\\xi$ and $L_2=\\eta$:\n$$\nN_6(\\xi, \\eta, \\zeta) = 4\\xi\\eta\n$$\n\n**Step 2: Derivatives of $N_6$ at the Centroid**\nThe centroid of the reference tetrahedron is at $(\\xi, \\eta, \\zeta) = (\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4})$. We compute the partial derivatives of $N_6$ and evaluate them at this point:\n$$\n\\frac{\\partial N_6}{\\partial \\xi} = 4\\eta \\implies \\left.\\frac{\\partial N_6}{\\partial \\xi}\\right|_{\\text{centroid}} = 4\\left(\\frac{1}{4}\\right) = 1\n$$\n$$\n\\frac{\\partial N_6}{\\partial \\eta} = 4\\xi \\implies \\left.\\frac{\\partial N_6}{\\partial \\eta}\\right|_{\\text{centroid}} = 4\\left(\\frac{1}{4}\\right) = 1\n$$\n$$\n\\frac{\\partial N_6}{\\partial \\zeta} = 0\n$$\nSo, the vector of local derivatives for $N_6$ is $(1, 1, 0)^T$.\n\n**Step 3: Jacobian Matrix at the Centroid**\nThe coordinate transformation is given by $x_p(\\xi,\\eta,\\zeta) = \\sum_{i=1}^{10} N_i(\\xi,\\eta,\\zeta) X_{i,p}$, where $X_{i,p}$ are the nodal coordinates. Since the element sides are straight and midside nodes are at exact midpoints, the geometry is defined by the corner nodes only and the isoparametric coordinate mapping simplifies to a linear transformation:\n$$\nx(\\xi, \\eta, \\zeta) = 2\\xi\n$$\n$$\ny(\\xi, \\eta, \\zeta) = 3\\eta\n$$\n$$\nz(\\xi, \\eta, \\zeta) = 4\\zeta\n$$\nThis can be verified by substituting the expressions for all $10$ shape functions and the given nodal coordinates. For example, for $x$:\n$x = N_2 x_2 + N_5 x_5 + N_6 x_6 + N_9 x_9 = (2L_1-1)L_1(2) + 4L_1L_4(1) + 4L_1L_2(1) + 4L_1L_3(1)$. Substituting $L_1=\\xi, L_2=\\eta, L_3=\\zeta, L_4=1-\\xi-\\eta-\\zeta$, we get $x = (2\\xi-1)\\xi(2) + 4\\xi(1-\\xi-\\eta-\\zeta)(1) + 4\\xi\\eta(1) + 4\\xi\\zeta(1) = (4\\xi^2-2\\xi) + (4\\xi-4\\xi^2-4\\xi\\eta-4\\xi\\zeta) + 4\\xi\\eta + 4\\xi\\zeta = 2\\xi$.\nThe calculations for $y$ and $z$ follow similarly.\nSince the mapping is linear, the Jacobian matrix is constant throughout the element:\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial x}{\\partial \\zeta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\zeta} \\\\ \\frac{\\partial z}{\\partial \\xi} & \\frac{\\partial z}{\\partial \\eta} & \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix} = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 3 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix}\n$$\nThis is the Jacobian matrix at every point, including the centroid.\n\n**Step 4: Inverse Transpose Jacobian**\nThe Jacobian is a diagonal matrix, which simplifies finding its inverse and transpose.\n$$\nJ^{-1} = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & \\frac{1}{3} & 0 \\\\ 0 & 0 & \\frac{1}{4} \\end{pmatrix}\n$$\nThe transpose of $J^{-1}$ is itself, as it is diagonal:\n$$\nJ^{-T} = (J^{-1})^T = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & \\frac{1}{3} & 0 \\\\ 0 & 0 & \\frac{1}{4} \\end{pmatrix}\n$$\n\n**Step 5: Global Derivatives**\nFinally, we compute the derivatives of $N_6$ with respect to the global coordinates $(x,y,z)$ at the centroid:\n$$\n\\begin{pmatrix} \\frac{\\partial N_6}{\\partial x} \\\\ \\frac{\\partial N_6}{\\partial y} \\\\ \\frac{\\partial N_6}{\\partial z} \\end{pmatrix} = J^{-T} \\begin{pmatrix} \\frac{\\partial N_6}{\\partial \\xi} \\\\ \\frac{\\partial N_6}{\\partial \\eta} \\\\ \\frac{\\partial N_6}{\\partial \\zeta} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & \\frac{1}{3} & 0 \\\\ 0 & 0 & \\frac{1}{4} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{1}{3} \\\\ 0 \\end{pmatrix}\n$$\nThe requested quantity is the component of the strain-displacement matrix $B$ associated with the normal strain $\\varepsilon_{xx}$ and the $x$-direction displacement of node $6$, which corresponds to the term $\\frac{\\partial N_6}{\\partial x}$. From the result above, this value is $\\frac{1}{2}$.", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "2604787"}, {"introduction": "While higher-order elements like the twenty-node hexahedron (H20) offer greater accuracy, they are also more susceptible to geometric distortions that can invalidate the analysis. This final practice explores this critical issue through a thought experiment where midside nodes are unusually placed, leading to a pathological element mapping. Your task is to determine the precise point at which the element geometry becomes invalid by analyzing when the Jacobian determinant, $\\det \\boldsymbol{J}$, vanishes. This investigation [@problem_id:2604816] provides invaluable insight into the importance of mesh quality and the mathematical underpinnings of errors you might encounter in real-world FEM software.", "problem": "Consider a twenty-node serendipity hexahedral (H20) isoparametric element in the Finite Element Method (FEM). The parent (reference) domain is the cube $[-1,1]^3$ with local coordinates $(\\xi,\\eta,\\zeta)$. Let the physical mapping $\\boldsymbol{x}(\\xi,\\eta,\\zeta) = (x(\\xi,\\eta,\\zeta),y(\\xi,\\eta,\\zeta),z(\\xi,\\eta,\\zeta))$ be defined componentwise by\n$$\nx(\\xi,\\eta,\\zeta) \\;=\\; \\xi \\;+\\; \\alpha\\,\\xi\\big(\\eta^{2}+\\zeta^{2}-2\\big),\\qquad\ny(\\xi,\\eta,\\zeta) \\;=\\; \\eta,\\qquad\nz(\\xi,\\eta,\\zeta) \\;=\\; \\zeta,\n$$\nfor a real parameter $\\alpha \\ge 0$. This mapping is consistent with an H20 interpolation in which all eight corner nodes are fixed at the corners of the physical cube while the twelve mid-edge nodes on edges not parallel to the $\\xi$-axis are displaced in the $x$-direction by an amount proportional to $\\alpha$, with the other coordinates unaltered. Such a construction is often used to study the sensitivity of higher-order serendipity elements to extreme mid-edge node placement.\n\nStarting only from the definition of the isoparametric mapping and the Jacobian matrix $\\boldsymbol{J} = \\partial\\boldsymbol{x}/\\partial(\\xi,\\eta,\\zeta)$, and using the fact that well-posed isoparametric elements require $\\det\\boldsymbol{J}(\\xi,\\eta,\\zeta) > 0$ throughout the parent domain, do the following:\n\n- Derive an analytic expression for $\\det\\boldsymbol{J}(\\xi,\\eta,\\zeta)$.\n- Determine the smallest positive value $\\alpha_{\\mathrm{cr}}$ for which there exists at least one point strictly inside the parent domain (i.e., with $(\\xi,\\eta,\\zeta)\\in(-1,1)^3$) where $\\det\\boldsymbol{J} = 0$.\n- Briefly explain, in terms of numerical integration and stiffness assembly, why vanishing or negative values of $\\det\\boldsymbol{J}$ cause numerical failure for this H20 element.\n\nExpress your final answer as the exact value of $\\alpha_{\\mathrm{cr}}$ (no rounding).", "solution": "First, we derive an analytic expression for the Jacobian determinant, $\\det\\boldsymbol{J}(\\xi,\\eta,\\zeta)$. The Jacobian matrix $\\boldsymbol{J}$ of the transformation from parent coordinates $(\\xi,\\eta,\\zeta)$ to physical coordinates $(x,y,z)$ is defined as:\n$$\n\\boldsymbol{J} = \\frac{\\partial(x,y,z)}{\\partial(\\xi,\\eta,\\zeta)} = \\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial x}{\\partial \\zeta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\zeta} \\\\\n\\frac{\\partial z}{\\partial \\xi} & \\frac{\\partial z}{\\partial \\eta} & \\frac{\\partial z}{\\partial \\zeta}\n\\end{pmatrix}\n$$\nWe compute the partial derivatives from the given mapping functions:\n$x(\\xi,\\eta,\\zeta) = \\xi + \\alpha\\xi(\\eta^{2}+\\zeta^{2}-2)$\n$y(\\xi,\\eta,\\zeta) = \\eta$\n$z(\\xi,\\eta,\\zeta) = \\zeta$\n\nThe derivatives are:\n$\\frac{\\partial x}{\\partial \\xi} = 1 + \\alpha(\\eta^{2}+\\zeta^{2}-2)$\n$\\frac{\\partial x}{\\partial \\eta} = \\alpha\\xi(2\\eta) = 2\\alpha\\xi\\eta$\n$\\frac{\\partial x}{\\partial \\zeta} = \\alpha\\xi(2\\zeta) = 2\\alpha\\xi\\zeta$\n\n$\\frac{\\partial y}{\\partial \\xi} = 0$, $\\frac{\\partial y}{\\partial \\eta} = 1$, $\\frac{\\partial y}{\\partial \\zeta} = 0$\n\n$\\frac{\\partial z}{\\partial \\xi} = 0$, $\\frac{\\partial z}{\\partial \\eta} = 0$, $\\frac{\\partial z}{\\partial \\zeta} = 1$\n\nSubstituting these into the matrix $\\boldsymbol{J}$:\n$$\n\\boldsymbol{J} = \\begin{pmatrix}\n1 + \\alpha(\\eta^{2}+\\zeta^{2}-2) & 2\\alpha\\xi\\eta & 2\\alpha\\xi\\zeta \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\nThe determinant of this upper triangular matrix is the product of its diagonal entries.\n$$\n\\det\\boldsymbol{J}(\\xi,\\eta,\\zeta) = \\left(1 + \\alpha(\\eta^{2}+\\zeta^{2}-2)\\right) \\cdot 1 \\cdot 1\n$$\nThus, the analytical expression for the Jacobian determinant is:\n$$\n\\det\\boldsymbol{J}(\\xi,\\eta,\\zeta) = 1 + \\alpha(\\eta^2 + \\zeta^2 - 2)\n$$\nNext, we determine the critical parameter $\\alpha_{\\mathrm{cr}}$. A valid isoparametric mapping requires $\\det\\boldsymbol{J} > 0$ for all points in the parent domain. We are looking for the smallest positive $\\alpha$, denoted $\\alpha_{\\mathrm{cr}}$, for which $\\det\\boldsymbol{J} = 0$ at some point $(\\xi,\\eta,\\zeta)$ strictly inside the parent domain, i.e., $(\\xi,\\eta,\\zeta) \\in (-1,1)^3$.\n\nThe expression for $\\det\\boldsymbol{J}$ does not depend on $\\xi$. We must analyze its behavior over the domain $(\\eta,\\zeta) \\in (-1,1)^2$. The parameter $\\alpha$ is given as $\\alpha \\ge 0$. The case $\\alpha=0$ gives $\\det\\boldsymbol{J}=1$, which is valid. We consider $\\alpha > 0$.\n\nTo find the condition where $\\det\\boldsymbol{J}$ might become non-positive, we must find the minimum value of $\\det\\boldsymbol{J}$ within the domain. Since $\\alpha > 0$, the minimum of $\\det\\boldsymbol{J}$ occurs where the term $(\\eta^2 + \\zeta^2 - 2)$ is minimized. Let $f(\\eta, \\zeta) = \\eta^2 + \\zeta^2$. We need to find the minimum of $f(\\eta, \\zeta)$ for $(\\eta,\\zeta) \\in (-1,1)^2$. The function $f$ is a paraboloid with its minimum at $(\\eta,\\zeta) = (0,0)$. At this point, $f(0,0)=0$. This point is strictly inside the domain.\n\nThe minimum value of the expression $\\eta^2 + \\zeta^2 - 2$ is therefore $0^2 + 0^2 - 2 = -2$. This minimum occurs along the line segment defined by $\\eta=0$, $\\zeta=0$ for any $\\xi \\in (-1,1)$. This entire segment lies strictly inside the parent domain.\n\nSubstituting this minimum into the expression for the determinant gives the minimum value of the determinant within the domain:\n$$\n(\\det\\boldsymbol{J})_{\\min} = 1 + \\alpha(-2) = 1 - 2\\alpha\n$$\nThe critical condition occurs when this minimum value first becomes zero.\n$$\n1 - 2\\alpha = 0\n$$\nSolving for $\\alpha$ gives:\n$$\n\\alpha_{\\mathrm{cr}} = \\frac{1}{2}\n$$\nFor any $\\alpha  1/2$, the minimum value $1 - 2\\alpha$ is positive, so $\\det\\boldsymbol{J}$ is strictly positive throughout the interior of the domain. At $\\alpha=1/2$, the determinant becomes zero along the line segment $(\\xi, 0, 0)$ for $\\xi \\in (-1,1)$. For $\\alpha > 1/2$, the minimum becomes negative, and there exists a region within the element where $\\det\\boldsymbol{J}  0$. Therefore, the smallest positive value is $\\alpha_{\\mathrm{cr}} = 1/2$.\n\nFinally, we explain why the condition $\\det\\boldsymbol{J} \\le 0$ at any point within an element, particularly at a numerical integration (Gauss) point, causes catastrophic failure in the Finite Element Method.\n\n1.  **Singular Mapping ($\\det\\boldsymbol{J} = 0$)**: In the isoparametric formulation, derivatives with respect to physical coordinates $(x,y,z)$ are computed from derivatives with respect to parent coordinates $(\\xi,\\eta,\\zeta)$ using the inverse of the Jacobian matrix, $\\boldsymbol{J}^{-1}$. For example, the strain-displacement matrix $\\boldsymbol{B}$ depends on $\\boldsymbol{J}^{-1}$. If $\\det\\boldsymbol{J}=0$ at a Gauss point, the matrix $\\boldsymbol{J}$ is singular, and its inverse $\\boldsymbol{J}^{-1}$ is undefined. This leads to a division-by-zero error during the computation of the element stiffness matrix, halting the analysis. Geometrically, $\\det\\boldsymbol{J}=0$ signifies a degenerate mapping where a volume element in the parent domain collapses into a surface or line element in the physical domain, meaning the mapping is not locally one-to-one.\n\n2.  **Element Inversion ($\\det\\boldsymbol{J}  0$)**: The Jacobian determinant relates the differential volume element in the physical domain, $dV$, to the differential volume element in the parent domain, $d\\xi d\\eta d\\zeta$, via the relation $dV = \\det\\boldsymbol{J} \\, d\\xi d\\eta d\\zeta$. Element matrices, such as the stiffness matrix $\\boldsymbol{K}^e$, are computed by integrating over the element volume:\n    $$\n    \\boldsymbol{K}^e = \\int_{-1}^1\\int_{-1}^1\\int_{-1}^1 \\boldsymbol{F}(\\xi,\\eta,\\zeta) \\det\\boldsymbol{J} \\, d\\xi d\\eta d\\zeta\n    $$\n    where $\\boldsymbol{F}$ is a matrix function involving shape functions and material properties which is positive semi-definite. The Gauss quadrature weights are always positive. If $\\det\\boldsymbol{J}  0$ at a Gauss point, the contribution to the stiffness matrix at that point is scaled by a negative \"volume\", which is physically nonsensical. This can corrupt the integral such that the resulting element stiffness matrix $\\boldsymbol{K}^e$ is no longer positive semi-definite. A non-positive definite global stiffness matrix can lead to solver failure or a physically meaningless solution, corresponding to an \"inside-out\" or folded element.", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "2604816"}]}