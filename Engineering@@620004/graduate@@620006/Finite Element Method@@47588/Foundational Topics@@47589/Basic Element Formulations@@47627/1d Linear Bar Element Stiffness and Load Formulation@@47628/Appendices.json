{"hands_on_practices": [{"introduction": "Before applying a numerical method to complex problems, it is crucial to verify its fundamental correctness. This practice introduces the 'patch test,' a cornerstone of finite element validation. By prescribing a simple linear displacement field, which corresponds to a constant strain state, you will verify that the 1D linear bar element can reproduce this state exactly, resulting in a zero residual. This exercise [@problem_id:2538127] is not merely academic; it demonstrates the essential consistency property that guarantees the convergence of the method.", "problem": "Consider a prismatic, linearly elastic bar occupying the interval $[0,L]$ on the real line, with constant Young’s modulus $E>0$ and constant cross-sectional area $A>0$. The bar is discretized into $2$ two-node linear (affine) bar elements with nodes at $x_1=0$, $x_2=\\ell_1$, and $x_3=L$, where $\\ell_1>0$, $\\ell_2>0$, and $\\ell_1+\\ell_2=L$. Let the exact displacement field be the linear function $u^{\\ast}(x)=\\alpha+\\beta x$ with constants $\\alpha,\\beta\\in\\mathbb{R}$. There is no body force, i.e., $b(x)=0$. On the boundary, apply tractions consistent with $u^{\\ast}$: the Cauchy stress is $\\sigma^{\\ast}=E\\,\\beta$, the outward normals are $n(0)=-1$ and $n(L)=+1$, and the boundary tractions per unit area are $\\bar t(0)=\\sigma^{\\ast}\\,n(0)$ and $\\bar t(L)=\\sigma^{\\ast}\\,n(L)$. The total boundary forces are the products of these tractions with the area $A$.\n\nUsing the Finite Element Method (FEM) with exact integration, construct the assembled global stiffness matrix corresponding to this mesh of $2$ linear bar elements, form the global consistent load vector induced solely by the boundary tractions, and evaluate the assembled residual vector $r=K\\,u^{h}-f$, where $u^{h}$ is the vector of nodal values obtained by interpolating $u^{\\ast}(x)$ at the mesh nodes. Compute the Euclidean norm $\\|r\\|_{2}$. Express your final answer in Newtons, and give a single numerical value (no units in the box). No rounding instruction is necessary if your result is exact.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n- **Domain and Discretization**: A linearly elastic bar on the interval $[0,L]$ is discretized into $2$ two-node linear bar elements.\n- **Nodal Coordinates**: $x_1=0$, $x_2=\\ell_1$, $x_3=L$.\n- **Element Lengths**: The two elements have lengths $\\ell_1>0$ and $\\ell_2>0$, where $\\ell_1+\\ell_2=L$.\n- **Material and Geometric Properties**: Constant Young's modulus $E>0$ and constant cross-sectional area $A>0$.\n- **Exact Displacement Field**: $u^{\\ast}(x)=\\alpha+\\beta x$ for constants $\\alpha,\\beta\\in\\mathbb{R}$.\n- **Loading**: No body force, $b(x)=0$.\n- **Boundary Conditions**: Boundary tractions per unit area are prescribed, consistent with $u^{\\ast}(x)$. The Cauchy stress is $\\sigma^{\\ast}=E\\,\\beta$. The outward normals are $n(0)=-1$ and $n(L)=+1$. The tractions are $\\bar t(0)=\\sigma^{\\ast}\\,n(0) = -E\\beta$ and $\\bar t(L)=\\sigma^{\\ast}\\,n(L) = E\\beta$.\n- **Nodal Forces**: Total boundary forces are $F_0 = A\\,\\bar t(0) = -EA\\beta$ at $x=0$ and $F_L = A\\,\\bar t(L) = EA\\beta$ at $x=L$.\n- **Finite Element Unknowns**: The vector of nodal displacements $u^{h}$ is obtained by interpolating $u^{\\ast}(x)$ at the nodes.\n- **Task**: Compute the Euclidean norm of the assembled residual vector $r=K\\,u^{h}-f$, where $K$ is the global stiffness matrix and $f$ is the global consistent load vector from boundary tractions.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, based on the standard formulation of one-dimensional linear elasticity within the framework of the Finite Element Method. It is well-posed, providing all necessary information to uniquely determine the quantities required for the calculation. The definitions and relationships are consistent with established theory. The problem contains no contradictions, ambiguities, or scientifically unsound premises.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed with the solution.\n\nThe solution requires the systematic construction of the components of the residual vector $r=K\\,u^{h}-f$.\n\nFirst, we define the element stiffness matrix for a one-dimensional linear bar element of length $L_e$, Young's modulus $E$, and cross-sectional area $A$. The element stiffness matrix $k^{(e)}$ is given by:\n$$ k^{(e)} = \\frac{EA}{L_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\nFor the first element, connecting nodes $1$ and $2$, the length is $L_e = \\ell_1$. Its stiffness matrix is:\n$$ k^{(1)} = \\frac{EA}{\\ell_1} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\nFor the second element, connecting nodes $2$ and $3$, the length is $L_e = \\ell_2$. Its stiffness matrix is:\n$$ k^{(2)} = \\frac{EA}{\\ell_2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\nThe global stiffness matrix $K$ is a $3 \\times 3$ matrix formed by assembling the contributions from $k^{(1)}$ and $k^{(2)}$. The degrees of freedom for $k^{(1)}$ are $(1,2)$ and for $k^{(2)}$ are $(2,3)$.\n$$ K = \\begin{pmatrix} k^{(1)}_{11} & k^{(1)}_{12} & 0 \\\\ k^{(1)}_{21} & k^{(1)}_{22} + k^{(2)}_{11} & k^{(2)}_{12} \\\\ 0 & k^{(2)}_{21} & k^{(2)}_{22} \\end{pmatrix} = EA \\begin{pmatrix} \\frac{1}{\\ell_1} & -\\frac{1}{\\ell_1} & 0 \\\\ -\\frac{1}{\\ell_1} & \\frac{1}{\\ell_1} + \\frac{1}{\\ell_2} & -\\frac{1}{\\ell_2} \\\\ 0 & -\\frac{1}{\\ell_2} & \\frac{1}{\\ell_2} \\end{pmatrix} $$\nNext, we construct the global load vector $f$. The problem specifies that body forces are zero, $b(x)=0$, and loading arises solely from the prescribed boundary tractions. The total nodal forces are given at the boundaries $x=0$ (node $1$) and $x=L$ (node $3$).\nThe force at node $1$ is $F_1 = -EA\\beta$.\nThe force at node $3$ is $F_3 = EA\\beta$.\nNode $2$ is an internal node and has no externally applied force, so $F_2 = 0$.\nThe global load vector $f$ is therefore:\n$$ f = \\begin{pmatrix} F_1 \\\\ F_2 \\\\ F_3 \\end{pmatrix} = \\begin{pmatrix} -EA\\beta \\\\ 0 \\\\ EA\\beta \\end{pmatrix} $$\nNext, we determine the vector of nodal displacements $u^h$. These values are obtained by evaluating the exact displacement field $u^{\\ast}(x) = \\alpha + \\beta x$ at the nodal coordinates $x_1=0$, $x_2=\\ell_1$, and $x_3=L$.\n$$ u_1 = u^{\\ast}(0) = \\alpha + \\beta(0) = \\alpha $$\n$$ u_2 = u^{\\ast}(\\ell_1) = \\alpha + \\beta\\ell_1 $$\n$$ u_3 = u^{\\ast}(L) = \\alpha + \\beta L = \\alpha + \\beta(\\ell_1 + \\ell_2) $$\nThe nodal displacement vector is:\n$$ u^h = \\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\end{pmatrix} = \\begin{pmatrix} \\alpha \\\\ \\alpha + \\beta\\ell_1 \\\\ \\alpha + \\beta(\\ell_1 + \\ell_2) \\end{pmatrix} $$\nNow, we compute the product $K u^h$, which represents the vector of internal forces at the nodes.\n$$ K u^h = EA \\begin{pmatrix} \\frac{1}{\\ell_1} & -\\frac{1}{\\ell_1} & 0 \\\\ -\\frac{1}{\\ell_1} & \\frac{1}{\\ell_1} + \\frac{1}{\\ell_2} & -\\frac{1}{\\ell_2} \\\\ 0 & -\\frac{1}{\\ell_2} & \\frac{1}{\\ell_2} \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ \\alpha + \\beta\\ell_1 \\\\ \\alpha + \\beta(\\ell_1 + \\ell_2) \\end{pmatrix} $$\nWe evaluate each component of the resulting vector:\nRow $1$:\n$$ (K u^h)_1 = EA \\left[ \\frac{1}{\\ell_1}(\\alpha) - \\frac{1}{\\ell_1}(\\alpha + \\beta\\ell_1) \\right] = EA \\left[ \\frac{\\alpha}{\\ell_1} - \\frac{\\alpha}{\\ell_1} - \\frac{\\beta\\ell_1}{\\ell_1} \\right] = -EA\\beta $$\nRow $2$:\n$$ (K u^h)_2 = EA \\left[ -\\frac{1}{\\ell_1}(\\alpha) + \\left(\\frac{1}{\\ell_1} + \\frac{1}{\\ell_2}\\right)(\\alpha + \\beta\\ell_1) - \\frac{1}{\\ell_2}(\\alpha + \\beta(\\ell_1 + \\ell_2)) \\right] $$\n$$ = EA \\left[ -\\frac{\\alpha}{\\ell_1} + \\frac{\\alpha}{\\ell_1} + \\beta + \\frac{\\alpha}{\\ell_2} + \\frac{\\beta\\ell_1}{\\ell_2} - \\frac{\\alpha}{\\ell_2} - \\frac{\\beta\\ell_1}{\\ell_2} - \\beta \\right] = EA [0] = 0 $$\nRow $3$:\n$$ (K u^h)_3 = EA \\left[ -\\frac{1}{\\ell_2}(\\alpha + \\beta\\ell_1) + \\frac{1}{\\ell_2}(\\alpha + \\beta(\\ell_1 + \\ell_2)) \\right] $$\n$$ = EA \\left[ -\\frac{\\alpha}{\\ell_2} - \\frac{\\beta\\ell_1}{\\ell_2} + \\frac{\\alpha}{\\ell_2} + \\frac{\\beta\\ell_1}{\\ell_2} + \\beta \\right] = EA\\beta $$\nThus, the vector of internal forces is:\n$$ K u^h = \\begin{pmatrix} -EA\\beta \\\\ 0 \\\\ EA\\beta \\end{pmatrix} $$\nFinally, we compute the residual vector $r = K u^h - f$:\n$$ r = \\begin{pmatrix} -EA\\beta \\\\ 0 \\\\ EA\\beta \\end{pmatrix} - \\begin{pmatrix} -EA\\beta \\\\ 0 \\\\ EA\\beta \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nThe residual vector is the zero vector. This result is to be expected and serves as a verification of a fundamental principle of the Finite Element Method. Since the exact solution $u^{\\ast}(x)$ is a linear polynomial and the discretization uses linear (affine) basis functions, the finite element approximation space contains the exact solution. Consequently, the nodal values obtained from the exact solution, when used in the discrete system of equations, must satisfy these equations exactly. The residual vector $r$ represents the imbalance in the discrete equations of equilibrium at the nodes. A zero residual signifies that the internal forces $K u^h$ are in perfect balance with the external forces $f$.\n\nThe Euclidean norm of the residual vector $r$ is:\n$$ \\|r\\|_{2} = \\sqrt{0^2 + 0^2 + 0^2} = 0 $$\nThe result, expressed in Newtons, is $0$.", "answer": "$$\n\\boxed{0}\n$$", "id": "2538127"}, {"introduction": "This exercise bridges the gap between theory and a classic engineering problem: a constrained bar under its own weight or a uniform distributed force. You will apply the finite element machinery to derive the 'consistent' nodal load vector, a concept that arises directly from the principle of virtual work. By comparing the FEM solution with the exact analytical result, this practice [@problem_id:2538095] illuminates a powerful feature of the Galerkin method where nodal forces can be captured with perfect accuracy, even with a minimal mesh.", "problem": "A straight, prismatic, axially deformable bar of length $L$, constant cross-sectional area $A$, and Young’s modulus $E$ lies along the $x$-axis with $x \\in [0,L]$. The axial displacement field is $u(x)$. Both ends are fixed, so the essential boundary conditions are $u(0)=0$ and $u(L)=0$. The bar is subjected to a uniform axial body force of constant intensity $b$ (force per unit length) acting in the positive $x$-direction over the entire span. Adopt the sign convention that positive axial forces and reactions act in the positive $x$-direction.\n\nUsing the Finite Element Method (FEM) with a single two-node linear bar element that spans the entire bar, and starting from the principle of virtual work, derive the element stiffness matrix and the consistent element load vector for the uniform body force. Enforce the essential boundary conditions and compute the nodal reactions at $x=0$ and $x=L$. Then, starting from the strong form of the one-dimensional axial equilibrium equation with the given boundary conditions, obtain the exact continuous solution and the corresponding end reactions. Compare the two sets of reactions.\n\nExpress the final reactions as a single row vector $(R_{0}\\; R_{L})$ in terms of $b$ and $L$, where $R_{0}$ is the reaction at $x=0$ and $R_{L}$ is the reaction at $x=L$. Take $b$ in Newtons per meter and $L$ in meters so that reactions are in Newtons, but do not include units in your final boxed answer. No numerical rounding is required; provide an exact symbolic expression.", "solution": "The problem is well-posed and scientifically sound. We shall proceed with the derivation and solution in two parts: first, using the Finite Element Method (FEM), and second, by solving the governing differential equation for the exact continuous solution.\n\n### Part 1: Finite Element Method (FEM) Solution\n\nWe model the bar of length $L$ with a single two-node linear element. The nodes are located at $x_1=0$ and $x_2=L$. The corresponding nodal displacements are $d_1$ and $d_2$. The vector of nodal displacements is $\\mathbf{d} = \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix}$.\n\nThe displacement field $u(x)$ within the element is approximated using linear shape functions $N_1(x)$ and $N_2(x)$:\n$$u(x) \\approx u_h(x) = N_1(x)d_1 + N_2(x)d_2 = \\mathbf{N}(x)\\mathbf{d}$$\nFor a linear element defined on the domain $x \\in [0, L]$, the shape functions are:\n$$N_1(x) = 1 - \\frac{x}{L}, \\quad N_2(x) = \\frac{x}{L}$$\nThe axial strain $\\epsilon(x)$ is the derivative of the displacement:\n$$\\epsilon(x) = \\frac{du_h}{dx} = \\frac{dN_1}{dx}d_1 + \\frac{dN_2}{dx}d_2 = \\left[-\\frac{1}{L} \\quad \\frac{1}{L}\\right]\\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = \\mathbf{B}\\mathbf{d}$$\nThe strain-displacement matrix $\\mathbf{B}$ is therefore constant for this element:\n$$\\mathbf{B} = \\frac{1}{L}\\begin{pmatrix} -1 & 1 \\end{pmatrix}$$\n\nWe derive the element equations from the principle of virtual work, which states that the internal virtual work ($\\delta W_{int}$) equals the external virtual work ($\\delta W_{ext}$).\n$$\\delta W_{int} = \\delta W_{ext}$$\n\nThe internal virtual work is given by the integral of the virtual strain energy over the volume $V$:\n$$\\delta W_{int} = \\int_V \\delta\\epsilon^T \\sigma dV = \\int_0^L \\delta\\epsilon^T (E\\epsilon) A dx$$\nSubstituting the finite element expressions $\\epsilon = \\mathbf{B}\\mathbf{d}$ and $\\delta\\epsilon = \\mathbf{B}\\delta\\mathbf{d}$:\n$$\\delta W_{int} = \\int_0^L (\\mathbf{B}\\delta\\mathbf{d})^T E A (\\mathbf{B}\\mathbf{d}) dx = \\delta\\mathbf{d}^T \\left( \\int_0^L \\mathbf{B}^T E A \\mathbf{B} dx \\right) \\mathbf{d}$$\nThis defines the element stiffness matrix $\\mathbf{K}$:\n$$\\mathbf{K} = \\int_0^L \\mathbf{B}^T E A \\mathbf{B} dx$$\nSince $E$, $A$, and $\\mathbf{B}$ are constant over the element:\n$$\\mathbf{K} = EA \\mathbf{B}^T \\mathbf{B} \\int_0^L dx = EAL \\left( \\frac{1}{L}\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} \\right) \\left( \\frac{1}{L}\\begin{pmatrix} -1 & 1 \\end{pmatrix} \\right) = \\frac{EA}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n\nThe external virtual work is due to the uniform body force $b$ (force per unit length):\n$$\\delta W_{ext} = \\int_0^L \\delta u(x) b dx$$\nSubstituting $\\delta u(x) = \\mathbf{N}(x)\\delta\\mathbf{d}$:\n$$\\delta W_{ext} = \\int_0^L (\\mathbf{N}(x)\\delta\\mathbf{d})^T b dx = \\delta\\mathbf{d}^T \\left( \\int_0^L \\mathbf{N}(x)^T b dx \\right)$$\nThis defines the consistent nodal force vector $\\mathbf{f}_b$:\n$$\\mathbf{f}_b = \\int_0^L \\mathbf{N}(x)^T b dx = b \\int_0^L \\begin{pmatrix} 1 - x/L \\\\ x/L \\end{pmatrix} dx$$\nIntegrating, we find:\n$$\\mathbf{f}_b = b \\begin{pmatrix} \\left[x - \\frac{x^2}{2L}\\right]_0^L \\\\ \\left[\\frac{x^2}{2L}\\right]_0^L \\end{pmatrix} = b \\begin{pmatrix} L - \\frac{L^2}{2L} \\\\ \\frac{L^2}{2L} \\end{pmatrix} = \\frac{bL}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n\nThe governing system of equations for the element is $\\mathbf{K}\\mathbf{d} = \\mathbf{F}$, where $\\mathbf{F}$ is the total vector of external nodal forces, including applied loads and reactions. Let $\\mathbf{R} = \\begin{pmatrix} R_0 \\\\ R_L \\end{pmatrix}$ be the vector of nodal reactions. The total force vector is $\\mathbf{F} = \\mathbf{f}_b + \\mathbf{R}$.\n$$\\frac{EA}{L}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = \\frac{bL}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} R_0 \\\\ R_L \\end{pmatrix}$$\nThe essential boundary conditions are $u(0)=0$ and $u(L)=0$, which implies $d_1=0$ and $d_2=0$. Substituting these into the system:\n$$\\frac{EA}{L}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\frac{bL}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} R_0 \\\\ R_L \\end{pmatrix}$$\n$$\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{bL}{2} + R_0 \\\\ \\frac{bL}{2} + R_L \\end{pmatrix}$$\nFrom this, we solve for the reactions:\n$$R_0 = -\\frac{bL}{2}, \\quad R_L = -\\frac{bL}{2}$$\n\n### Part 2: Exact Analytical Solution\n\nThe strong form of the axial equilibrium equation for a prismatic bar is:\n$$\\frac{d}{dx}\\left(EA\\frac{du}{dx}\\right) + b(x) = 0$$\nGiven that $E$ and $A$ are constant, and $b(x)=b$ is a constant body force, this simplifies to:\n$$EA \\frac{d^2u}{dx^2} = -b$$\nIntegrating with respect to $x$ twice gives the general solution for the displacement field $u(x)$:\n$$\\frac{du}{dx} = -\\frac{b}{EA}x + C_1$$\n$$u(x) = -\\frac{b}{2EA}x^2 + C_1 x + C_2$$\nWe use the boundary conditions $u(0)=0$ and $u(L)=0$ to find the integration constants $C_1$ and $C_2$.\nFrom $u(0)=0$:\n$$u(0) = 0 + 0 + C_2 = 0 \\implies C_2=0$$\nFrom $u(L)=0$:\n$$u(L) = -\\frac{bL^2}{2EA} + C_1 L = 0 \\implies C_1 = \\frac{bL}{2EA}$$\nThe exact displacement field is:\n$$u(x) = \\frac{b}{2EA}(Lx - x^2)$$\nThe internal axial force is $N(x) = EA \\frac{du}{dx}$. Using our expression for the first derivative:\n$$N(x) = EA \\left(-\\frac{bx}{EA} + \\frac{bL}{2EA}\\right) = b\\left(\\frac{L}{2} - x\\right)$$\nThe reaction forces at the supports are the external forces required to balance the internal forces at the boundaries.\nAt the left support ($x=0$), the internal force is $N(0) = b(\\frac{L}{2} - 0) = \\frac{bL}{2}$. This positive value indicates tension; the bar is pulling the support to the right. The support must exert an equal and opposite force on the bar. According to the sign convention, a force acting in the negative $x$-direction is negative.\n$$R_0 = -N(0) = -\\frac{bL}{2}$$\nAt the right support ($x=L$), the internal force is $N(L) = b(\\frac{L}{2} - L) = -\\frac{bL}{2}$. This negative value indicates compression; the bar is pushing the support to the right. The support must push back on the bar to the left.\n$$R_L = N(L) = -\\frac{bL}{2}$$\n\n### Part 3: Comparison\n\nComparing the results from the two methods:\nFEM solution: $(R_0, R_L) = (-\\frac{bL}{2}, -\\frac{bL}{2})$.\nExact solution: $(R_0, R_L) = (-\\frac{bL}{2}, -\\frac{bL}{2})$.\n\nThe nodal reactions calculated by the Finite Element Method using a single linear element and a consistent load vector are identical to the exact reactions derived from the analytical solution of the governing differential equation. This is a known property of the Galerkin formulation of the Finite Element Method for this specific problem (a linear element under a uniform distributed load). While the displacement field approximation $u_h(x)=0$ from the FEM model is incorrect (the exact solution is parabolic), the nodal forces are exact.", "answer": "$$\\boxed{\\begin{pmatrix} -\\frac{bL}{2} & -\\frac{bL}{2} \\end{pmatrix}}$$", "id": "2538095"}, {"introduction": "Real-world components are rarely uniform. This practice addresses the formulation of elements with varying properties, such as a tapered bar, where integrals for the stiffness matrix and load vector become more complex. You will explore the crucial role of numerical quadrature (specifically Gauss quadrature) in evaluating these integrals, a standard procedure in all commercial FEM codes. This exercise [@problem_id:2538046] challenges you to determine when numerical integration is exact and to quantify the error when it is not, providing a vital lesson on the practical aspects of FEM implementation and convergence.", "problem": "A straight bar occupies a segment along the spatial coordinate $x \\in [0,h]$ and is modeled by a single $2$-node linear bar finite element. The bar has constant Young’s modulus $E$ but a linearly tapered cross-sectional area $A(x) = A_{0} + a x$, where $A_{0} > 0$ and $a$ are constants. The bar is subjected to a constant body force per unit volume $b_{0}$ in the axial direction; there are no other external tractions on the element. Using the Principle of Virtual Work as the fundamental starting point, consider the standard weak form for axial deformation,\n$\\int_{0}^{h} E A(x) \\frac{du}{dx} \\frac{dv}{dx} \\, dx = \\int_{0}^{h} A(x) b_{0} v \\, dx$,\nand the $2$-node linear shape functions over the element to construct the element stiffness matrix and the consistent element load vector.\n\nYour tasks:\n- Derive the exact element stiffness matrix and the exact consistent element load vector using exact integration, starting from the weak form and the $2$-node linear shape functions defined over $[0,h]$.\n- Evaluate the same stiffness and load integrals using one-point Gauss quadrature and two-point Gauss quadrature on the reference interval, and identify which quantities are integrated exactly by each rule.\n- Compare the numerical error incurred in the element stiffness and in the element load for one-point versus two-point Gauss quadrature when $A(x)$ is linear, and relate your findings to the expected convergence properties of the assembled finite element solution for a mesh of such elements under smooth data.\n\nFinally, report the element-level consistent load error vector for one-point Gauss quadrature relative to exact integration, i.e., the two-entry row-matrix \n$e_{f}^{(1\\mathrm{G})} = \\big(f^{(1\\mathrm{G})} - f^{(\\mathrm{exact})}\\big)^{\\top}$, \nexpressed symbolically in terms of $A_{0}$, $a$, $b_{0}$, and $h$. Do not substitute numerical values. No rounding is required. Express the final answer as a $1 \\times 2$ row matrix using LaTeX’s $\\mathrm{pmatrix}$ environment, as a closed-form analytic expression.", "solution": "The problem statement has been subjected to validation and is found to be scientifically grounded, well-posed, and objective. It presents a standard problem in the finite element method, providing all necessary information for a unique and meaningful solution. There are no contradictions, ambiguities, or factual errors. The problem is valid.\n\nWe proceed with the derivation and analysis. The problem concerns a single $2$-node linear bar element spanning the domain $x \\in [0, h]$.\n\nFirst, we define the linear shape functions for the $2$-node element on the physical domain $[0, h]$. The nodes are at $x_1 = 0$ and $x_2 = h$. The shape functions are:\n$$ N_1(x) = 1 - \\frac{x}{h} $$\n$$ N_2(x) = \\frac{x}{h} $$\nThe axial displacement field $u(x)$ is interpolated from the nodal displacements $d_1$ and $d_2$ as $u(x) = N_1(x)d_1 + N_2(x)d_2 = \\mathbf{N}(x)\\mathbf{d}$, where $\\mathbf{N}(x) = \\begin{pmatrix} N_1(x) & N_2(x) \\end{pmatrix}$ and $\\mathbf{d} = \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix}$.\n\nThe axial strain, $\\epsilon(x) = \\frac{du}{dx}$, is given by:\n$$ \\frac{du}{dx} = \\begin{pmatrix} \\frac{dN_1}{dx} & \\frac{dN_2}{dx} \\end{pmatrix} \\mathbf{d} = \\mathbf{B}\\mathbf{d} $$\nwhere the strain-displacement matrix $\\mathbf{B}$ is constant for a linear element:\n$$ \\mathbf{B} = \\begin{pmatrix} -\\frac{1}{h} & \\frac{1}{h} \\end{pmatrix} = \\frac{1}{h} \\begin{pmatrix} -1 & 1 \\end{pmatrix} $$\n\nThe element stiffness matrix $\\mathbf{K}$ and consistent load vector $\\mathbf{f}$ are derived from the weak form:\n$$ \\mathbf{K} = \\int_{0}^{h} \\mathbf{B}^{\\top} E A(x) \\mathbf{B} \\, dx $$\n$$ \\mathbf{f} = \\int_{0}^{h} \\mathbf{N}(x)^{\\top} A(x) b_0 \\, dx $$\nwhere $E$ is the Young's modulus, $A(x) = A_0 + ax$ is the cross-sectional area, and $b_0$ is the constant body force per unit volume.\n\nDerivation of the exact element stiffness matrix, $\\mathbf{K}^{(\\mathrm{exact})}$:\nWe substitute the expressions for $\\mathbf{B}$ and $A(x)$ into the formula for $\\mathbf{K}$:\n$$ \\mathbf{K}^{(\\mathrm{exact})} = \\int_{0}^{h} \\frac{1}{h}\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} E (A_0 + ax) \\frac{1}{h}\\begin{pmatrix} -1 & 1 \\end{pmatrix} \\, dx $$\n$$ \\mathbf{K}^{(\\mathrm{exact})} = \\frac{E}{h^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\int_{0}^{h} (A_0 + ax) \\, dx $$\nThe integral is evaluated as:\n$$ \\int_{0}^{h} (A_0 + ax) \\, dx = \\left[ A_0x + \\frac{ax^2}{2} \\right]_{0}^{h} = A_0h + \\frac{ah^2}{2} = h \\left( A_0 + \\frac{ah}{2} \\right) $$\nThis integral represents the total volume of the element if its area were $A(x)$ and its length were $h$, divided by $h$. It is equivalent to $h$ times the area at the midpoint, $A(h/2)$.\nThus, the exact stiffness matrix is:\n$$ \\mathbf{K}^{(\\mathrm{exact})} = \\frac{E}{h^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} h \\left( A_0 + \\frac{ah}{2} \\right) = \\frac{E}{h} \\left( A_0 + \\frac{ah}{2} \\right) \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n\nDerivation of the exact consistent element load vector, $\\mathbf{f}^{(\\mathrm{exact})}$:\nWe substitute $\\mathbf{N}(x)$ and $A(x)$ into the formula for $\\mathbf{f}$:\n$$ \\mathbf{f}^{(\\mathrm{exact})} = b_0 \\int_{0}^{h} \\begin{pmatrix} 1 - x/h \\\\ x/h \\end{pmatrix} (A_0 + ax) \\, dx $$\nThis requires evaluating two integrals for the components $f_1$ and $f_2$:\n$$ f_1^{(\\mathrm{exact})} = b_0 \\int_{0}^{h} \\left(1 - \\frac{x}{h}\\right)(A_0 + ax) \\, dx = b_0 \\int_{0}^{h} \\left( A_0 + \\left(a - \\frac{A_0}{h}\\right)x - \\frac{a}{h}x^2 \\right) dx $$\n$$ f_1^{(\\mathrm{exact})} = b_0 \\left[ A_0x + \\left(a - \\frac{A_0}{h}\\right)\\frac{x^2}{2} - \\frac{a}{h}\\frac{x^3}{3} \\right]_{0}^{h} = b_0 \\left( A_0h + \\frac{ah^2}{2} - \\frac{A_0h}{2} - \\frac{ah^2}{3} \\right) = b_0 \\left( \\frac{A_0h}{2} + \\frac{ah^2}{6} \\right) = \\frac{b_0h}{6}(3A_0 + ah) $$\n$$ f_2^{(\\mathrm{exact})} = b_0 \\int_{0}^{h} \\frac{x}{h}(A_0 + ax) \\, dx = \\frac{b_0}{h} \\int_{0}^{h} (A_0x + ax^2) \\, dx $$\n$$ f_2^{(\\mathrm{exact})} = \\frac{b_0}{h} \\left[ A_0\\frac{x^2}{2} + a\\frac{x^3}{3} \\right]_{0}^{h} = \\frac{b_0}{h} \\left( \\frac{A_0h^2}{2} + \\frac{ah^3}{3} \\right) = b_0 \\left( \\frac{A_0h}{2} + \\frac{ah^2}{3} \\right) = \\frac{b_0h}{6}(3A_0 + 2ah) $$\nThe exact load vector is:\n$$ \\mathbf{f}^{(\\mathrm{exact})} = \\frac{b_0h}{6} \\begin{pmatrix} 3A_0 + ah \\\\ 3A_0 + 2ah \\end{pmatrix} $$\n\nEvaluation using Gauss quadrature:\nNumerical integration is performed on the reference interval $\\xi \\in [-1, 1]$. The mapping is $x(\\xi) = \\frac{h}{2}(1+\\xi)$, with Jacobian $J = \\frac{dx}{d\\xi} = \\frac{h}{2}$.\nThe stiffness matrix integral transforms to:\n$$ \\mathbf{K} = \\int_{-1}^{1} \\mathbf{B}^{\\top} E A(x(\\xi)) \\mathbf{B} \\frac{h}{2} \\, d\\xi $$\nThe integrand for the scalar part of the stiffness integral is $I_K(\\xi) = E(A_0 + a\\frac{h}{2}(1+\\xi))$. This is a polynomial of degree $1$ in $\\xi$. One-point Gauss quadrature (with point $\\xi_1=0$, weight $w_1=2$) is exact for polynomials up to degree $2n-1 = 1$. Therefore, one-point Gauss quadrature will integrate the stiffness matrix exactly.\n$$ \\mathbf{K}^{(1\\mathrm{G})} = \\left( \\frac{E}{h^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\right) \\cdot w_1 \\left[ (A_0 + a x(0)) \\frac{h}{2} \\right] = \\left( \\dots \\right) \\cdot 2 \\left[ (A_0 + a\\frac{h}{2}) \\frac{h}{2} \\right] = \\frac{E}{h} \\left( A_0 + \\frac{ah}{2} \\right) \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\nThus, $\\mathbf{K}^{(1\\mathrm{G})} = \\mathbf{K}^{(\\mathrm{exact})}$. Since two-point Gauss quadrature is exact for polynomials up to degree $3$, it is trivially also exact, i.e., $\\mathbf{K}^{(2\\mathrm{G})} = \\mathbf{K}^{(\\mathrm{exact})}$.\n\nThe load vector integral transforms to:\n$$ \\mathbf{f} = \\int_{-1}^{1} \\mathbf{N}(\\xi)^{\\top} A(x(\\xi)) b_0 \\frac{h}{2} \\, d\\xi $$\nwhere $\\mathbf{N}(\\xi) = \\begin{pmatrix} \\frac{1-\\xi}{2} & \\frac{1+\\xi}{2} \\end{pmatrix}$. The integrand components are of the form constant$\\times(1\\pm\\xi)(C_1+C_2\\xi)$, which are polynomials of degree $2$ in $\\xi$.\nOne-point Gauss quadrature is not exact for quadratic polynomials.\n$$ \\mathbf{f}^{(1\\mathrm{G})} = w_1 \\left[ \\mathbf{N}(0)^{\\top} A(x(0)) b_0 \\frac{h}{2} \\right] = 2 \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix} (A_0 + a\\frac{h}{2}) b_0 \\frac{h}{2} = \\frac{b_0 h}{2} \\left(A_0 + \\frac{ah}{2}\\right) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\nTwo-point Gauss quadrature is exact for polynomials up to degree $3$. Therefore, it will integrate the load vector exactly. We do not need to perform the calculation; we know apriori that $\\mathbf{f}^{(2\\mathrm{G})} = \\mathbf{f}^{(\\mathrm{exact})}$.\n\nComparison and Error Analysis:\nThe stiffness matrix is integrated exactly by both one-point and two-point Gauss quadrature. The error is zero in both cases.\nThe load vector is integrated exactly only by the two-point rule. An error is incurred when using the one-point rule. The error vector is defined as $e_{f}^{(1\\mathrm{G})} = \\left(\\mathbf{f}^{(1\\mathrm{G})} - \\mathbf{f}^{(\\mathrm{exact})}\\right)^{\\top}$.\nThe components of the error vector are:\n$$ e_{f,1}^{(1\\mathrm{G})} = \\frac{b_0h}{2}\\left(A_0 + \\frac{ah}{2}\\right) - \\frac{b_0h}{6}(3A_0+ah) = \\frac{b_0h}{12}\\left[ 6\\left(A_0 + \\frac{ah}{2}\\right) - 2(3A_0+ah) \\right] = \\frac{b_0h}{12} [6A_0 + 3ah - 6A_0 - 2ah] = \\frac{ab_0h^2}{12} $$\n$$ e_{f,2}^{(1\\mathrm{G})} = \\frac{b_0h}{2}\\left(A_0 + \\frac{ah}{2}\\right) - \\frac{b_0h}{6}(3A_0+2ah) = \\frac{b_0h}{12}\\left[ 6\\left(A_0 + \\frac{ah}{2}\\right) - 2(3A_0+2ah) \\right] = \\frac{b_0h}{12} [6A_0 + 3ah - 6A_0 - 4ah] = -\\frac{ab_0h^2}{12} $$\nThe load error vector is thus $\\mathbf{e}_f^{(1\\mathrm{G})} = \\frac{ab_0h^2}{12} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$.\n\nRegarding convergence properties for a mesh of such elements, the use of inexact quadrature constitutes a \"variational crime\". According to Strang's first lemma, the overall error of the finite element solution is bounded by the sum of the best approximation error and a consistency term due to quadrature errors. In this case, the stiffness matrix is exact. The error in the load vector is of order $O(h^2)$. Standard error analysis shows that this quadrature error is of a higher order than the interpolation error in the energy norm, which is $O(h)$ for linear elements. Consequently, the use of one-point quadrature for the load vector, while being inexact, does not degrade the optimal $O(h)$ convergence rate in the energy norm nor the $O(h^2)$ rate in the $L^2$-norm for displacements. Hence, from an asymptotic standpoint, one-point quadrature is sufficient for this particular problem formulation.\n\nFinally, we report the element-level consistent load error vector for one-point Gauss quadrature as a $1 \\times 2$ row matrix.\n$$ e_{f}^{(1\\mathrm{G})} = \\left( \\mathbf{f}^{(1\\mathrm{G})} - \\mathbf{f}^{(\\mathrm{exact})} \\right)^{\\top} = \\begin{pmatrix} \\frac{ab_0h^2}{12} & -\\frac{ab_0h^2}{12} \\end{pmatrix} $$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{ab_{0}h^{2}}{12} & -\\frac{ab_{0}h^{2}}{12} \\end{pmatrix}}\n$$", "id": "2538046"}]}