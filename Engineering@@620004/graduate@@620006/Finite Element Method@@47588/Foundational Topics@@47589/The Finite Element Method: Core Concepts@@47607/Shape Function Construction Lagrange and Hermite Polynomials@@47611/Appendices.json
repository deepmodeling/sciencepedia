{"hands_on_practices": [{"introduction": "We begin with the fundamental building block of many finite elements: the one-dimensional Lagrange polynomial. This exercise guides you through the process of deriving quadratic shape functions from their defining property—the ability to be one at their own node and zero at all others. This practice is essential for understanding how interpolation works at the most basic level and for verifying key properties like the partition of unity [@problem_id:2595145].", "problem": "In the Finite Element Method (FEM), nodal Lagrange shape functions on a reference one-dimensional element are defined as polynomials that interpolate nodal values with the Kronecker-delta property. Consider the reference interval with parametric coordinate $\\xi$ and the quadratic polynomial space of degree at most $p=2$. Let the three nodal points be $\\xi_1=-1$, $\\xi_2=0$, and $\\xi_3=1$. Starting from the defining properties that each shape function $N_i(\\xi)$ is a polynomial of degree at most $2$ and satisfies $N_i(\\xi_j)=\\delta_{ij}$ for $i,j\\in\\{1,2,3\\}$, do the following:\n- Derive explicit formulas for the three shape functions $N_1(\\xi)$, $N_2(\\xi)$, and $N_3(\\xi)$.\n- Verify their first derivatives at the nodes by computing $N_i'(\\xi_j)$ for all $i,j\\in\\{1,2,3\\}$.\n- Confirm the partition-of-unity property $\\sum_{i=1}^{3}N_i(\\xi)=1$ and its implication for the derivatives at the nodes.\n\nYour final answer must be the three shape functions written as a single row of analytic expressions in $\\xi$. Do not include any units. Do not provide derivative values in the final answer.", "solution": "The problem statement is subjected to validation.\n\nGivens are extracted verbatim:\n- Field: Finite Element Method (FEM).\n- Topic: Nodal Lagrange shape functions on a reference one-dimensional element.\n- Property: Functions interpolate nodal values with the Kronecker-delta property.\n- Geometry: Reference interval with parametric coordinate $\\xi$.\n- Polynomial Space: Quadratic, degree at most $p=2$.\n- Nodal Points: $\\xi_1=-1$, $\\xi_2=0$, and $\\xi_3=1$.\n- Defining Properties of Shape Functions $N_i(\\xi)$:\n    1. $N_i(\\xi)$ is a polynomial of degree at most $2$.\n    2. $N_i(\\xi_j)=\\delta_{ij}$ for $i,j\\in\\{1,2,3\\}$, where $\\delta_{ij}$ is the Kronecker delta.\n- Required tasks:\n    1. Derive explicit formulas for $N_1(\\xi)$, $N_2(\\xi)$, and $N_3(\\xi)$.\n    2. Verify their first derivatives at the nodes by computing $N_i'(\\xi_j)$ for all $i,j\\in\\{1,2,3\\}$.\n    3. Confirm the partition-of-unity property $\\sum_{i=1}^{3}N_i(\\xi)=1$ and its implication for the derivatives at the nodes.\n\nThe problem is found to be valid. It is a standard, well-posed problem in numerical analysis and the finite element method. It is scientifically grounded, self-contained, consistent, and objectively stated. All necessary information is provided for the derivation of a unique solution. We may proceed.\n\nThe task is to construct three quadratic Lagrange polynomials, $N_1(\\xi)$, $N_2(\\xi)$, and $N_3(\\xi)$, on the interval $[\\!-1, 1\\!]$ with nodes at $\\xi_1 = -1$, $\\xi_2 = 0$, and $\\xi_3 = 1$. The defining property is the Kronecker-delta condition: $N_i(\\xi_j) = \\delta_{ij}$. A polynomial of degree at most $2$ is of the form $P(\\xi) = a\\xi^2 + b\\xi + c$.\n\nDerivation of $N_1(\\xi)$:\nBy definition, $N_1(\\xi)$ must satisfy:\n$N_1(\\xi_1) = N_1(-1) = 1$\n$N_1(\\xi_2) = N_1(0) = 0$\n$N_1(\\xi_3) = N_1(1) = 0$\nSince $N_1(\\xi)$ is zero at $\\xi=0$ and $\\xi=1$, it must be of the form $N_1(\\xi) = C_1(\\xi - 0)(\\xi - 1)$ for some constant $C_1$.\nTo find $C_1$, we use the condition $N_1(-1) = 1$:\n$1 = C_1(-1)(-1 - 1) = C_1(-1)(-2) = 2C_1$\nThis gives $C_1 = \\frac{1}{2}$.\nTherefore, the first shape function is:\n$N_1(\\xi) = \\frac{1}{2}\\xi(\\xi - 1) = \\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi$\n\nDerivation of $N_2(\\xi)$:\nBy definition, $N_2(\\xi)$ must satisfy:\n$N_2(\\xi_1) = N_2(-1) = 0$\n$N_2(\\xi_2) = N_2(0) = 1$\n$N_2(\\xi_3) = N_2(1) = 0$\nSince $N_2(\\xi)$ is zero at $\\xi=-1$ and $\\xi=1$, it must be of the form $N_2(\\xi) = C_2(\\xi - (-1))(\\xi - 1) = C_2(\\xi + 1)(\\xi - 1)$ for some constant $C_2$.\nTo find $C_2$, we use the condition $N_2(0) = 1$:\n$1 = C_2(0 + 1)(0 - 1) = C_2(1)(-1) = -C_2$\nThis gives $C_2 = -1$.\nTherefore, the second shape function is:\n$N_2(\\xi) = -1(\\xi^2 - 1) = 1 - \\xi^2$\n\nDerivation of $N_3(\\xi)$:\nBy definition, $N_3(\\xi)$ must satisfy:\n$N_3(\\xi_1) = N_3(-1) = 0$\n$N_3(\\xi_2) = N_3(0) = 0$\n$N_3(\\xi_3) = N_3(1) = 1$\nSince $N_3(\\xi)$ is zero at $\\xi=-1$ and $\\xi=0$, it must be of the form $N_3(\\xi) = C_3(\\xi - (-1))(\\xi - 0) = C_3(\\xi + 1)\\xi$ for some constant $C_3$.\nTo find $C_3$, we use the condition $N_3(1) = 1$:\n$1 = C_3(1 + 1)(1) = C_3(2)(1) = 2C_3$\nThis gives $C_3 = \\frac{1}{2}$.\nTherefore, the third shape function is:\n$N_3(\\xi) = \\frac{1}{2}\\xi(\\xi + 1) = \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi$\n\nVerification of derivatives at the nodes:\nFirst, we compute the first derivatives of the shape functions:\n$N_1'(\\xi) = \\frac{d}{d\\xi}\\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) = \\xi - \\frac{1}{2}$\n$N_2'(\\xi) = \\frac{d}{d\\xi}(1 - \\xi^2) = -2\\xi$\n$N_3'(\\xi) = \\frac{d}{d\\xi}\\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right) = \\xi + \\frac{1}{2}$\n\nNow, we evaluate these derivatives at each nodal point $\\xi_j \\in \\{-1, 0, 1\\}$.\nFor $\\xi_1 = -1$:\n$N_1'(-1) = -1 - \\frac{1}{2} = -\\frac{3}{2}$\n$N_2'(-1) = -2(-1) = 2$\n$N_3'(-1) = -1 + \\frac{1}{2} = -\\frac{1}{2}$\n\nFor $\\xi_2 = 0$:\n$N_1'(0) = 0 - \\frac{1}{2} = -\\frac{1}{2}$\n$N_2'(0) = -2(0) = 0$\n$N_3'(0) = 0 + \\frac{1}{2} = \\frac{1}{2}$\n\nFor $\\xi_3 = 1$:\n$N_1'(1) = 1 - \\frac{1}{2} = \\frac{1}{2}$\n$N_2'(1) = -2(1) = -2$\n$N_3'(1) = 1 + \\frac{1}{2} = \\frac{3}{2}$\n\nThis completes the verification of the first derivatives at the nodes.\n\nConfirmation of the partition-of-unity property:\nThe partition-of-unity property states that the sum of the shape functions must be equal to $1$ over the entire element domain.\n$\\sum_{i=1}^{3} N_i(\\xi) = N_1(\\xi) + N_2(\\xi) + N_3(\\xi)$\n$= \\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + (1 - \\xi^2) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right)$\n$= \\left(\\frac{1}{2}\\xi^2 - \\xi^2 + \\frac{1}{2}\\xi^2\\right) + \\left(-\\frac{1}{2}\\xi + \\frac{1}{2}\\xi\\right) + 1$\n$= (1 - 1)\\xi^2 + (0)\\xi + 1 = 1$\nThe property is confirmed.\n\nAn important implication of the partition-of-unity property is that the sum of the derivatives of the shape functions must be zero.\n$\\frac{d}{d\\xi} \\left( \\sum_{i=1}^{3} N_i(\\xi) \\right) = \\frac{d}{d\\xi}(1) = 0$\n$\\implies \\sum_{i=1}^{3} N_i'(\\xi) = 0$\nWe verify this sum at each nodal point using the derivatives calculated previously.\nAt $\\xi_1 = -1$:\n$\\sum_{i=1}^{3} N_i'(-1) = -\\frac{3}{2} + 2 - \\frac{1}{2} = -\\frac{4}{2} + 2 = -2 + 2 = 0$\nAt $\\xi_2 = 0$:\n$\\sum_{i=1}^{3} N_i'(0) = -\\frac{1}{2} + 0 + \\frac{1}{2} = 0$\nAt $\\xi_3 = 1$:\n$\\sum_{i=1}^{3} N_i'(1) = \\frac{1}{2} - 2 + \\frac{3}{2} = \\frac{4}{2} - 2 = 2 - 2 = 0$\nThe implication is confirmed. The calculations are consistent. The derived formulas for the shape functions are correct.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}\\xi(\\xi-1) & 1-\\xi^2 & \\frac{1}{2}\\xi(\\xi+1)\n\\end{pmatrix}\n}\n$$", "id": "2595145"}, {"introduction": "Not all physical problems can be modeled with simple value-based interpolation. For phenomena like beam bending, whose weak form involves second-order derivatives, the interpolation must ensure continuity of first derivatives ($C^{1}$ continuity) across elements. This exercise introduces cubic Hermite polynomials, which accomplish this by interpolating both nodal values and slopes, and immediately applies them to a practical scenario: the Euler-Bernoulli beam element. You will perform a \"patch test\" to verify that this element can correctly represent a state of constant curvature, a crucial test for its validity in structural analysis [@problem_id:2595153].", "problem": "Consider a single Euler–Bernoulli beam finite element of length $L$ and flexural rigidity $E I$, with the standard $C^{1}$-continuous cubic Hermite interpolation for the transverse displacement field $w(x)$. The nodal degrees of freedom are ordered as $d = [\\,w_{1},\\,\\theta_{1},\\,w_{2},\\,\\theta_{2}\\,]^{T}$, where $w_{a}$ and $\\theta_{a}$ denote, respectively, the transverse displacement and rotation at node $a \\in \\{1,2\\}$, with node $1$ at $x=0$ and node $2$ at $x=L$. The finite element interpolation is $w_{h}(x) = \\sum_{i=1}^{4} N_{i}(x)\\, d_{i}$, where the shape functions $N_{i}(x)$ are cubic polynomials chosen to interpolate both $w$ and $w^{\\prime}$ at the element ends. You may treat the element in the dimensionless local coordinate $\\xi = x/L \\in [0,1]$ when constructing shape functions, but all final integrals are to be taken over $x \\in [0,L]$.\n\nStarting from the defining interpolation conditions for $C^{1}$ Hermite shape functions and the principle of virtual work for the Euler–Bernoulli beam (internal virtual work $\\delta W_{\\text{int}} = \\int_{0}^{L} E I\\, w^{\\prime\\prime}(x)\\, \\delta w^{\\prime\\prime}(x)\\, dx$ and external virtual work from end moments $M$ acting on end rotations), proceed as follows:\n\n$1.$ Derive the explicit expressions of the four cubic Hermite shape functions $N_{1}(x)$, $N_{2}(x)$, $N_{3}(x)$, $N_{4}(x)$ from first principles by enforcing the interpolation conditions on $w$ and $w^{\\prime}$ at $x=0$ and $x=L$.\n\n$2.$ Consider the exact quadratic displacement field $w(x) = \\dfrac{\\kappa}{2}\\, x^{2} + b\\, x + c$, with constant curvature $\\kappa$, where $b$ and $c$ are constants. Express the corresponding nodal degrees of freedom $d$ implied by this field, and show that the finite element curvature $w_{h}^{\\prime\\prime}(x)$ computed from the Hermite interpolation equals the exact constant curvature $\\kappa$ for all $x \\in [0,L]$.\n\n$3.$ Using the internal virtual work expression and the derived shape functions, compute the internal nodal force vector $f_{\\text{int}}(d) \\in \\mathbb{R}^{4}$ for the exact quadratic field of part $2$. Here $f_{\\text{int},i}(d) = \\int_{0}^{L} E I\\, w_{h}^{\\prime\\prime}(x)\\, N_{i}^{\\prime\\prime}(x)\\, dx$.\n\n$4.$ Now specialize to the constant bending moment (constant curvature) patch test: there is no distributed load, and equal-and-opposite end moments of magnitude $M = E I\\, \\kappa$ are applied at $x=0$ and $x=L$ so that the internal bending moment is constant and the shear force is zero. Derive the consistent external nodal force vector $f_{\\text{ext}} \\in \\mathbb{R}^{4}$ from the external virtual work of the end moments on the nodal rotations. Then form the element residual $r = f_{\\text{int}}(d) - f_{\\text{ext}}$.\n\nYour task is to verify whether the cubic Hermite beam element passes the constant curvature patch test by evaluating the scaled Euclidean norm of the residual, $\\|r\\|_{2}/(E I)$, as a single real number. Express the final answer as a pure number (dimensionless), without units. If a numerical value is obtained, provide it in exact form; rounding is not required.", "solution": "The problem statement is scientifically sound, self-contained, and well-posed. It presents a standard verification procedure known as the patch test for a $C^{1}$ continuous Hermite finite element for an Euler-Bernoulli beam. All provided information is standard and correct within the framework of solid mechanics and the finite element method. The problem is therefore deemed **valid**. We proceed with the solution.\n\nThe problem is solved sequentially in four parts as requested.\n\n**1. Derivation of Hermite Shape Functions**\n\nThe transverse displacement field $w_{h}(x)$ is interpolated using four cubic Hermite shape functions $N_{i}(x)$ and the nodal degrees of freedom vector $d = [w_{1}, \\theta_{1}, w_{2}, \\theta_{2}]^{T}$. The interpolation is given by:\n$$\nw_{h}(x) = N_{1}(x)w_{1} + N_{2}(x)\\theta_{1} + N_{3}(x)w_{2} + N_{4}(x)\\theta_{2}\n$$\nwhere $w_{1} = w(0)$, $\\theta_{1} = w^{\\prime}(0)$, $w_{2} = w(L)$, and $\\theta_{2} = w^{\\prime}(L)$. The shape functions are cubic polynomials, $N_{i}(x) = a_{i}x^{3} + b_{i}x^{2} + c_{i}x + d_{i}$, and must satisfy the following Kronecker delta-type conditions at the nodes $x=0$ and $x=L$:\n\\begin{itemize}\n    \\item $N_{1}(x)$: $N_{1}(0)=1$, $N_{1}^{\\prime}(0)=0$, $N_{1}(L)=0$, $N_{1}^{\\prime}(L)=0$.\n    \\item $N_{2}(x)$: $N_{2}(0)=0$, $N_{2}^{\\prime}(0)=1$, $N_{2}(L)=0$, $N_{2}^{\\prime}(L)=0$.\n    \\item $N_{3}(x)$: $N_{3}(0)=0$, $N_{3}^{\\prime}(0)=0$, $N_{3}(L)=1$, $N_{3}^{\\prime}(L)=0$.\n    \\item $N_{4}(x)$: $N_{4}(0)=0$, $N_{4}^{\\prime}(0)=0$, $N_{4}(L)=0$, $N_{4}^{\\prime}(L)=1$.\n\\end{itemize}\nIt is more convenient to derive these in the dimensionless local coordinate $\\xi = x/L \\in [0,1]$. Let $N_{i}(x) = \\hat{N}_{i}(\\xi)$. Then $N_{i}^{\\prime}(x) = \\frac{d\\hat{N}_{i}}{d\\xi}\\frac{d\\xi}{dx} = \\frac{1}{L}\\hat{N}_{i}^{\\prime}(\\xi)$. The conditions on $\\hat{N}_i$ are derived from the physical conditions on $N_i$. For example, for $N_2$, $N_2'(0)=1 \\implies \\frac{1}{L}\\hat{N}_2'(0) = 1 \\implies \\hat{N}_2'(0) = L$.\n\nSolving the systems of equations for the coefficients of each cubic polynomial $\\hat{N}_i(\\xi)$ under the translated conditions yields:\n\\begin{itemize}\n    \\item $N_{1}(x) = 2(x/L)^{3} - 3(x/L)^{2} + 1$.\n\n    \\item $N_{2}(x) = x(1-x/L)^{2}$.\n\n    \\item $N_{3}(x) = -2(x/L)^{3} + 3(x/L)^{2}$.\n\n    \\item $N_{4}(x) = (x^{2}/L)(x/L - 1)$.\n\\end{itemize}\n\n**2. Constant Curvature Patch Test: Field Interpolation**\n\nWe are given an exact quadratic displacement field $w(x) = \\frac{\\kappa}{2}x^{2} + bx + c$.\nFirst, we evaluate the nodal degrees of freedom corresponding to this field:\n\\begin{itemize}\n    \\item $w_{1} = w(0) = c$.\n    \\item $\\theta_{1} = w^{\\prime}(0) = [\\kappa x + b]_{x=0} = b$.\n    \\item $w_{2} = w(L) = \\frac{\\kappa}{2}L^{2} + bL + c$.\n    \\item $\\theta_{2} = w^{\\prime}(L) = [\\kappa x + b]_{x=L} = \\kappa L + b$.\n\\end{itemize}\nThe nodal DOF vector is $d = [c, b, \\frac{\\kappa}{2}L^{2}+bL+c, \\kappa L+b]^{T}$.\n\nNext, we must show that the interpolated curvature $w_{h}^{\\prime\\prime}(x)$ equals the exact curvature $\\kappa$. The exact field $w(x)$ is a quadratic polynomial, which is a specific case of a cubic polynomial. The Hermite interpolant $w_{h}(x)$ is constructed to be a cubic polynomial that exactly matches the function values $w(x)$ and derivative values $w^{\\prime}(x)$ at two distinct points ($x=0$ and $x=L$). A cubic polynomial is uniquely determined by these four conditions. Since the exact solution $w(x)$ itself is a polynomial of degree less than or equal to $3$ that satisfies these conditions, the unique interpolating polynomial $w_{h}(x)$ must be identical to $w(x)$.\n$$\nw_{h}(x) \\equiv w(x) = \\frac{\\kappa}{2}x^{2} + bx + c\n$$\nTherefore, the second derivative of the interpolated field is:\n$$\nw_{h}^{\\prime\\prime}(x) = \\frac{d^{2}}{dx^{2}}\\left(\\frac{\\kappa}{2}x^{2} + bx + c\\right) = \\kappa\n$$\nThis demonstrates that the cubic Hermite element exactly reproduces a state of constant curvature, a necessary condition for passing the patch test.\n\n**3. Internal Nodal Force Vector**\n\nThe internal nodal force vector $f_{\\mathrm{int}}$ is computed from the internal virtual work. The $i$-th component is given by:\n$$\nf_{\\mathrm{int},i}(d) = \\int_{0}^{L} E I\\, w_{h}^{\\prime\\prime}(x)\\, N_{i}^{\\prime\\prime}(x)\\, dx\n$$\nFrom part 2, we have $w_{h}^{\\prime\\prime}(x) = \\kappa$. The expression simplifies to:\n$$\nf_{\\mathrm{int},i}(d) = E I \\kappa \\int_{0}^{L} N_{i}^{\\prime\\prime}(x)\\, dx\n$$\nUsing the Fundamental Theorem of Calculus, the integral is evaluated as:\n$$\n\\int_{0}^{L} N_{i}^{\\prime\\prime}(x)\\, dx = [N_{i}^{\\prime}(x)]_{0}^{L} = N_{i}^{\\prime}(L) - N_{i}^{\\prime}(0)\n$$\nWe use the defining properties of the shape functions established in part 1:\n\\begin{itemize}\n    \\item $ i=1: N_{1}^{\\prime}(L) - N_{1}^{\\prime}(0) = 0 - 0 = 0 \\implies f_{\\mathrm{int},1} = 0$.\n    \\item $ i=2: N_{2}^{\\prime}(L) - N_{2}^{\\prime}(0) = 0 - 1 = -1 \\implies f_{\\mathrm{int},2} = -E I \\kappa$.\n    \\item $ i=3: N_{3}^{\\prime}(L) - N_{3}^{\\prime}(0) = 0 - 0 = 0 \\implies f_{\\mathrm{int},3} = 0$.\n    \\item $ i=4: N_{4}^{\\prime}(L) - N_{4}^{\\prime}(0) = 1 - 0 = 1 \\implies f_{\\mathrm{int},4} = E I \\kappa$.\n\\end{itemize}\nThe internal nodal force vector is $f_{\\mathrm{int}}(d) = [0, -E I \\kappa, 0, E I \\kappa]^{T}$.\n\n**4. External Nodal Force Vector and Residual**\n\nThe patch test considers a state of constant bending moment $M = E I \\kappa$ with zero shear force. This is produced by applying equal-and-opposite external moments at the element ends. According to standard beam theory sign convention, constant positive internal moment $M$ requires an externally applied counter-clockwise moment of magnitude $M$ at node $2$ ($x=L$) and a clockwise moment of magnitude $M$ at node $1$ ($x=0$).\nThe external virtual work $\\delta W_{\\text{ext}}$ produced by these moments acting on the virtual nodal rotations $\\delta\\theta_{1}$ and $\\delta\\theta_{2}$ is:\n$$\n\\delta W_{\\text{ext}} = (-M)\\delta\\theta_{1} + (M)\\delta\\theta_{2}\n$$\nThe external force vector $f_{\\text{ext}}$ is defined via the relation $\\delta W_{\\text{ext}} = f_{\\text{ext}}^{T} \\delta d$. Since $\\delta d = [\\delta w_{1}, \\delta \\theta_{1}, \\delta w_{2}, \\delta \\theta_{2}]^{T}$, we can identify the components of $f_{\\text{ext}}$ by comparison:\n$$\nf_{\\text{ext}} = [0, -M, 0, M]^{T}\n$$\nSubstituting $M = E I \\kappa$, we obtain:\n$$\nf_{\\text{ext}} = [0, -E I \\kappa, 0, E I \\kappa]^{T}\n$$\nThe element residual vector $r$ is the difference between the internal and external nodal forces:\n$$\nr = f_{\\text{int}}(d) - f_{\\text{ext}} = \\begin{pmatrix} 0 \\\\ -E I \\kappa \\\\ 0 \\\\ E I \\kappa \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ -E I \\kappa \\\\ 0 \\\\ E I \\kappa \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe residual is the zero vector, which confirms that the element is in equilibrium under a constant bending moment state, thus passing the patch test.\n\nFinally, we compute the required scaled Euclidean norm of the residual:\n$$\n\\|r\\|_{2} = \\sqrt{0^{2} + 0^{2} + 0^{2} + 0^{2}} = 0\n$$\nThe scaled norm is therefore:\n$$\n\\frac{\\|r\\|_{2}}{E I} = \\frac{0}{E I} = 0\n$$\nThe result is a pure dimensionless number.", "answer": "$$\\boxed{0}$$", "id": "2595153"}, {"introduction": "With an understanding of both Lagrange interpolation and patch testing, we can now tackle more complex, multi-dimensional elements. This practice extends the 1D Lagrange polynomials to two dimensions using a tensor product to create a 9-node \"Q9\" quadrilateral element for plane stress analysis. You will then apply the patch test concept to this 2D element, confirming its ability to exactly represent a linear displacement field—a property known as linear completeness which is essential for convergence [@problem_id:2595182].", "problem": "Consider a single bi-quadratic Lagrange quadrilateral element, commonly denoted as a $Q_9$ element, occupying the physical domain $\\Omega = \\{(x,y)\\,|\\, x \\in [-1,1],\\, y \\in [-1,1]\\}$ with constant thickness $t>0$. Use an isoparametric description with parent coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ and place the nine nodes at the tensor-product grid $\\{ -1,0,1 \\}\\times\\{ -1,0,1 \\}$ so that the mapping is the identity $(x,y)=(\\xi,\\eta)$.\n\nStart from the definition of the one-dimensional quadratic Lagrange polynomials associated with nodes $\\xi\\in\\{-1,0,1\\}$, construct the two-dimensional $Q_9$ shape functions by tensor product, and justify from first principles that these shape functions reproduce all linear polynomials in $x$ and $y$ over $\\Omega$.\n\nAssume small-strain, linear, isotropic, plane-stress elasticity with Young’s modulus $E>0$ and Poisson’s ratio $\\nu\\in(-1,1)$, and zero body force $\\boldsymbol{b}=\\boldsymbol{0}$. Let the exact displacement field be the representative linear field\n$$\nu(x,y)=x+2y+3,\\qquad v(x,y)=-2x+y-1.\n$$\nLet the boundary traction be prescribed as $\\boldsymbol{t}=\\boldsymbol{\\sigma}\\,\\boldsymbol{n}$ on $\\partial\\Omega$, where $\\boldsymbol{\\sigma}$ is the Cauchy stress computed from the exact displacement field and $\\boldsymbol{n}$ is the outward unit normal. Using the $Q_9$ element with the constructed shape functions and exact integration, define the internal and external nodal force vectors\n$$\n\\boldsymbol{f}_{\\mathrm{int}}=\\int_{\\Omega} \\boldsymbol{B}^{\\top}\\,\\boldsymbol{\\sigma}\\,t\\,\\mathrm{d}A,\\qquad\n\\boldsymbol{f}_{\\mathrm{ext}}=\\int_{\\partial\\Omega} \\boldsymbol{N}^{\\top}\\,\\boldsymbol{t}\\,t\\,\\mathrm{d}\\Gamma,\n$$\nwhere $\\boldsymbol{N}$ is the matrix collecting the vector-valued shape functions and $\\boldsymbol{B}$ is the standard strain–displacement matrix in two dimensions (with small-strain symmetrized gradients). Consider the discrete residual $\\boldsymbol{r}=\\boldsymbol{f}_{\\mathrm{int}}-\\boldsymbol{f}_{\\mathrm{ext}}$ for this single-element patch test.\n\nCompute the Euclidean norm $\\|\\boldsymbolr\\|_{2}$ using exact symbolic reasoning. Express your final answer in Newtons. No rounding is required.", "solution": "The problem posed is a single-element patch test, a fundamental verification procedure in the finite element method. The objective is to determine if a given element formulation can exactly represent a state of constant strain. A linear displacement field, as provided, results in a constant strain field, making it the canonical case for this test. The test is passed if the discrete system of equations is satisfied exactly, which implies that the residual vector—the difference between the internal and external nodal forces—is zero.\n\nFirst, we address the construction and properties of the shape functions for the bi-quadratic, $9$-node ($Q_9$) quadrilateral element. The element nodes are located on a tensor-product grid of points $\\{-1, 0, 1\\} \\times \\{-1, 0, 1\\}$ in the parent domain $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$. The shape functions are constructed by the tensor product of one-dimensional quadratic Lagrange polynomials.\n\nLet us define the one-dimensional Lagrange polynomials, $L_i(\\xi)$, for nodes at $\\xi_1 = -1$, $\\xi_2 = 0$, and $\\xi_3 = 1$:\n$$\nL_1(\\xi) = \\frac{(\\xi - \\xi_2)(\\xi - \\xi_3)}{(\\xi_1 - \\xi_2)(\\xi_1 - \\xi_3)} = \\frac{(\\xi - 0)(\\xi - 1)}{(-1 - 0)(-1 - 1)} = \\frac{1}{2}\\xi(\\xi - 1)\n$$\n$$\nL_2(\\xi) = \\frac{(\\xi - \\xi_1)(\\xi - \\xi_3)}{(\\xi_2 - \\xi_1)(\\xi_2 - \\xi_3)} = \\frac{(\\xi - (-1))(\\xi - 1)}{(0 - (-1))(0 - 1)} = -(\\xi+1)(\\xi-1) = 1 - \\xi^2\n$$\n$$\nL_3(\\xi) = \\frac{(\\xi - \\xi_1)(\\xi - \\xi_2)}{(\\xi_3 - \\xi_1)(\\xi_3 - \\xi_2)} = \\frac{(\\xi - (-1))(\\xi - 0)}{(1 - (-1))(1 - 0)} = \\frac{1}{2}\\xi(\\xi + 1)\n$$\nThe two-dimensional shape functions $N_I(\\xi, \\eta)$ for the $9$ nodes are formed by the tensor product $N_{ij}(\\xi, \\eta) = L_i(\\xi) L_j(\\eta)$, where the single index $I$ maps to the pair $(i, j)$ with $i, j \\in \\{1, 2, 3\\}$. The problem states an isoparametric mapping $(x, y) = (\\xi, \\eta)$, so we may use these coordinate systems interchangeably.\n\nNext, we must justify that these shape functions can reproduce any linear polynomial of the form $p(x, y) = a_0 + a_1 x + a_2 y$. This property, known as linear completeness, is satisfied if the shape functions exhibit:\n$1$. Partition of unity: $\\sum_I N_I(x, y) = 1$\n$2$. Linear field reproduction: $\\sum_I x_I N_I(x, y) = x$ and $\\sum_I y_I N_I(x, y) = y$\n\nTo prove the partition of unity, we first sum the one-dimensional polynomials:\n$$\n\\sum_{i=1}^{3} L_i(\\xi) = \\frac{1}{2}\\xi(\\xi - 1) + (1 - \\xi^2) + \\frac{1}{2}\\xi(\\xi + 1) = \\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi + 1 - \\xi^2 + \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi = 1\n$$\nThe sum of the two-dimensional shape functions is then:\n$$\n\\sum_I N_I(\\xi, \\eta) = \\sum_{i=1}^{3} \\sum_{j=1}^{3} L_i(\\xi) L_j(\\eta) = \\left( \\sum_{i=1}^{3} L_i(\\xi) \\right) \\left( \\sum_{j=1}^{3} L_j(\\eta) \\right) = (1)(1) = 1\n$$\nThis confirms the partition of unity, which ensures the exact reproduction of the constant term $a_0$.\n\nTo prove linear field reproduction, we examine the weighted sum of nodal coordinates $\\xi_I$:\n$$\n\\sum_I \\xi_I N_I(\\xi, \\eta) = \\sum_{i=1}^{3} \\sum_{j=1}^{3} \\xi_i L_i(\\xi) L_j(\\eta) = \\left( \\sum_{i=1}^{3} \\xi_i L_i(\\xi) \\right) \\left( \\sum_{j=1}^{3} L_j(\\eta) \\right)\n$$\nThe first term is:\n$$\n\\sum_{i=1}^{3} \\xi_i L_i(\\xi) = (-1) \\left( \\frac{1}{2}\\xi(\\xi - 1) \\right) + (0) \\left( 1 - \\xi^2 \\right) + (1) \\left( \\frac{1}{2}\\xi(\\xi + 1) \\right) = -\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi + \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi = \\xi\n$$\nThus, using the identity $\\sum_j L_j(\\eta)=1$, we have:\n$$\n\\sum_I x_I N_I(x,y) = \\sum_I \\xi_I N_I(\\xi,\\eta) = \\xi \\cdot 1 = \\xi = x\n$$\nBy symmetry, a similar calculation for the $y$-coordinate yields:\n$$\n\\sum_I y_I N_I(x,y) = \\sum_I \\eta_I N_I(\\xi,\\eta) = \\left( \\sum_{i=1}^{3} L_i(\\xi) \\right) \\left( \\sum_{j=1}^{3} \\eta_j L_j(\\eta) \\right) = 1 \\cdot \\eta = \\eta = y\n$$\nThese results prove that the $Q_9$ shape functions are linearly complete. A consequence is that if the nodal displacements $\\boldsymbol{d}$ are set to the values of a linear displacement field at the nodes, the interpolated field $\\boldsymbol{u}_h = \\boldsymbol{N}\\boldsymbol{d}$ will be identical to the exact linear field $\\boldsymbol{u}$. The given displacement field is linear:\n$$\n\\boldsymbol{u}(x,y) = \\begin{pmatrix} u(x,y) \\\\ v(x,y) \\end{pmatrix} = \\begin{pmatrix} x+2y+3 \\\\ -2x+y-1 \\end{pmatrix}\n$$\nDue to completeness, the interpolated field $\\boldsymbol{u}_h(x, y)$ is exactly equal to $\\boldsymbol{u}(x, y)$ everywhere in the element. Therefore, the strains derived from the interpolated field, $\\boldsymbol{\\epsilon}_h = \\boldsymbol{B}\\boldsymbol{d}$, are identical to the exact strains, $\\boldsymbol{\\epsilon}$. Let us compute these exact strains:\n$$\n\\epsilon_{xx} = \\frac{\\partial u}{\\partial x} = 1, \\quad \\epsilon_{yy} = \\frac{\\partial v}{\\partial y} = 1, \\quad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = 2 + (-2) = 0\n$$\nSince the strains are constant, the stress field $\\boldsymbol{\\sigma} = \\boldsymbol{C}\\boldsymbol{\\epsilon}$ is also constant throughout the element. The local equilibrium equation in the absence of body forces is $\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0}$. For a constant stress field, this condition is satisfied trivially.\n\nThe nodal force vectors are defined by the Galerkin method applied to the weak form of the equilibrium equation. The integration by parts (Green-Gauss divergence theorem) of the weak form yields the general relationship between internal forces, external forces, and body forces:\n$$\n\\int_{\\Omega} \\boldsymbol{B}^{\\top} \\boldsymbol{\\sigma} \\, \\mathrm{d}A = \\int_{\\partial \\Omega} \\boldsymbol{N}^{\\top} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\, \\mathrm{d}\\Gamma + \\int_{\\Omega} \\boldsymbol{N}^{\\top} \\boldsymbol{b} \\, \\mathrm{d}A\n$$\nThis identity holds provided the stress field $\\boldsymbol{\\sigma}$ satisfies the strong-form equilibrium condition $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$ within the domain.\nMultiplying by the constant thickness $t > 0$ and using the definitions provided in the problem statement:\n$\\boldsymbol{f}_{\\mathrm{int}} = \\int_{\\Omega} \\boldsymbol{B}^{\\top}\\boldsymbol{\\sigma} \\, t \\, \\mathrm{d}A$\n$\\boldsymbol{f}_{\\mathrm{ext}} = \\int_{\\partial\\Omega} \\boldsymbol{N}^{\\top}\\boldsymbol{t} \\, t \\, \\mathrm{d}\\Gamma$, where $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$.\nThe relationship becomes:\n$$\n\\boldsymbol{f}_{\\mathrm{int}} = \\boldsymbol{f}_{\\mathrm{ext}} + \\int_{\\Omega} \\boldsymbol{N}^{\\top} \\boldsymbol{b} \\, t \\, \\mathrm{d}A\n$$\nIn this problem, the body force $\\boldsymbol{b} = \\boldsymbol{0}$. The stress field $\\boldsymbol{\\sigma}$ is constant, thus satisfying $\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0}$. Furthermore, \"exact integration\" is specified, meaning there is no numerical quadrature error. Under these conditions, the identity $\\boldsymbol{f}_{\\mathrm{int}} = \\boldsymbol{f}_{\\mathrm{ext}}$ holds exactly.\n\nThe discrete residual vector is defined as $\\boldsymbol{r} = \\boldsymbol{f}_{\\mathrm{int}} - \\boldsymbol{f}_{\\mathrm{ext}}$. Based on the preceding derivation, we have:\n$$\n\\boldsymbol{r} = \\boldsymbol{f}_{\\mathrm{int}} - \\boldsymbol{f}_{\\mathrm{ext}} = \\boldsymbol{0}\n$$\nThe residual vector is identically the zero vector. The Euclidean norm of the zero vector is, by definition, zero. The physical parameters $E$, $\\nu$, and $t$ enter into the calculation of the individual force vectors but cancel out or are irrelevant when establishing that the residual is zero. The ability of the element to pass this test is a purely kinematic property stemming from the completeness of its shape functions.\n\nTherefore, the computed Euclidean norm of the residual is exactly zero.", "answer": "$$\n\\boxed{0\\,\\text{N}}\n$$", "id": "2595182"}]}