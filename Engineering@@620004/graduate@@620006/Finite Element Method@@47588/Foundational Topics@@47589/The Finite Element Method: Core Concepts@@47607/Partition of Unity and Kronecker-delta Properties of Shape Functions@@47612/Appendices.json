{"hands_on_practices": [{"introduction": "This first exercise grounds the abstract concepts of shape functions in a concrete computational task. By constructing a set of linear shape functions for a given triangle from first principles, you will directly verify how the partition of unity and the Kronecker-delta property ensure the exact reproduction of linear fields—a cornerstone of Finite Element Method (FEM) accuracy [@problem_id:2586144].", "problem": "Let a triangle in the plane have vertices at $V_{1}=(1,2)$, $V_{2}=(4,3)$, and $V_{3}=(2,6)$. Consider the linear Lagrange element on this triangle used in the finite element method (FEM), where the nodal shape functions $\\{N_{i}(x,y)\\}_{i=1}^{3}$ are affine functions on the triangle and satisfy the Kronecker-delta property $N_{i}(V_{j})=\\delta_{ij}$ and the partition of unity $\\sum_{i=1}^{3}N_{i}(x,y)=1$. Let the point $P$ be given by $P=\\left(\\frac{11}{4},\\frac{7}{2}\\right)$, which lies strictly inside the triangle.\n\nTasks:\n- Starting from the defining properties of the linear Lagrange shape functions on a triangle (affine on the element, Kronecker-delta property at the vertices, and partition of unity), construct the explicit expressions for $N_{1}(x,y)$, $N_{2}(x,y)$, and $N_{3}(x,y)$. Show that they satisfy the partition of unity and Kronecker-delta properties.\n- Compute the barycentric coordinates of $P$ with respect to the triangle, defined by $\\lambda_{i}=N_{i}(P)$ for $i\\in\\{1,2,3\\}$.\n- Let $g(x,y)\\equiv c$ be any constant function with constant $c\\in\\mathbb{R}$, and let $\\ell(x,y)=3x-2y+1$ be a linear function. Using the nodal interpolation operator on this element, $I_{h}f(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)f(V_{i})$, evaluate $I_{h}g(P)$ and $I_{h}\\ell(P)$, and verify exactness by comparing to $g(P)$ and $\\ell(P)$.\n\nProvide as your final answer the value of the interpolated linear function at $P$, namely $I_{h}\\ell(P)$, expressed as an exact fraction. Do not include units. No rounding is required.", "solution": "The problem presented is a standard exercise in the Finite Element Method and is well-posed, scientifically grounded, and contains all necessary information for a unique solution. We shall proceed with the required calculations in three stages.\n\nFirst, we construct the linear Lagrange shape functions $N_{i}(x,y)$ for $i \\in \\{1, 2, 3\\}$. A linear shape function on a triangle is an affine function of the form $N_{i}(x,y) = a_{i}x + b_{i}y + c_{i}$. The coefficients $(a_{i}, b_{i}, c_{i})$ are determined by enforcing the Kronecker-delta property, $N_{i}(V_{j}) = \\delta_{ij}$, where $V_{j}$ are the vertices of the triangle. The vertices are given as $V_{1}=(1,2)$, $V_{2}=(4,3)$, and $V_{3}=(2,6)$.\n\nFor the shape function $N_{1}(x,y)$, the conditions are:\n$N_{1}(V_{1}) = a_{1}(1) + b_{1}(2) + c_{1} = 1$\n$N_{1}(V_{2}) = a_{1}(4) + b_{1}(3) + c_{1} = 0$\n$N_{1}(V_{3}) = a_{1}(2) + b_{1}(6) + c_{1} = 0$\nThis constitutes a system of three linear equations for the three unknown coefficients $a_{1}$, $b_{1}$, and $c_{1}$. Solving this system yields $a_{1} = -\\frac{3}{11}$, $b_{1} = -\\frac{2}{11}$, and $c_{1} = \\frac{18}{11}$. Thus, the first shape function is:\n$$N_{1}(x,y) = \\frac{1}{11}(-3x - 2y + 18)$$\n\nFor the shape function $N_{2}(x,y)$, the conditions are:\n$N_{2}(V_{1}) = a_{2}(1) + b_{2}(2) + c_{2} = 0$\n$N_{2}(V_{2}) = a_{2}(4) + b_{2}(3) + c_{2} = 1$\n$N_{2}(V_{3}) = a_{2}(2) + b_{2}(6) + c_{2} = 0$\nSolving this system gives $a_{2} = \\frac{4}{11}$, $b_{2} = -\\frac{1}{11}$, and $c_{2} = -\\frac{2}{11}$. The second shape function is:\n$$N_{2}(x,y) = \\frac{1}{11}(4x - y - 2)$$\n\nFor the shape function $N_{3}(x,y)$, the conditions are:\n$N_{3}(V_{1}) = a_{3}(1) + b_{3}(2) + c_{3} = 0$\n$N_{3}(V_{2}) = a_{3}(4) + b_{3}(3) + c_{3} = 0$\n$N_{3}(V_{3}) = a_{3}(2) + b_{3}(6) + c_{3} = 1$\nSolving this system gives $a_{3} = -\\frac{1}{11}$, $b_{3} = \\frac{3}{11}$, and $c_{3} = -\\frac{5}{11}$. The third shape function is:\n$$N_{3}(x,y) = \\frac{1}{11}(-x + 3y - 5)$$\n\nThe Kronecker-delta property is satisfied by construction. We must also verify the partition of unity property, $\\sum_{i=1}^{3}N_{i}(x,y)=1$. Summing the expressions:\n$$ \\sum_{i=1}^{3}N_{i}(x,y) = \\frac{1}{11}[(-3x - 2y + 18) + (4x - y - 2) + (-x + 3y - 5)] $$\n$$ = \\frac{1}{11}[(-3+4-1)x + (-2-1+3)y + (18-2-5)] $$\n$$ = \\frac{1}{11}[0 \\cdot x + 0 \\cdot y + 11] = \\frac{11}{11} = 1 $$\nThe partition of unity is therefore satisfied for all $(x,y)$.\n\nSecond, we compute the barycentric coordinates of the point $P=\\left(\\frac{11}{4},\\frac{7}{2}\\right)$. The barycentric coordinates $\\lambda_{i}$ are defined as $\\lambda_{i} = N_{i}(P)$.\n$$\\lambda_{1} = N_{1}\\left(\\frac{11}{4},\\frac{7}{2}\\right) = \\frac{1}{11}\\left(-3\\left(\\frac{11}{4}\\right) - 2\\left(\\frac{7}{2}\\right) + 18\\right) = \\frac{1}{11}\\left(-\\frac{33}{4} - 7 + 18\\right) = \\frac{1}{11}\\left(-\\frac{33}{4} + 11\\right) = \\frac{1}{11}\\left(\\frac{-33+44}{4}\\right) = \\frac{1}{11}\\left(\\frac{11}{4}\\right) = \\frac{1}{4}$$\n$$\\lambda_{2} = N_{2}\\left(\\frac{11}{4},\\frac{7}{2}\\right) = \\frac{1}{11}\\left(4\\left(\\frac{11}{4}\\right) - \\frac{7}{2} - 2\\right) = \\frac{1}{11}\\left(11 - \\frac{7}{2} - \\frac{4}{2}\\right) = \\frac{1}{11}\\left(11 - \\frac{11}{2}\\right) = \\frac{1}{11}\\left(\\frac{22-11}{2}\\right) = \\frac{1}{11}\\left(\\frac{11}{2}\\right) = \\frac{1}{2}$$\n$$\\lambda_{3} = N_{3}\\left(\\frac{11}{4},\\frac{7}{2}\\right) = \\frac{1}{11}\\left(-\\frac{11}{4} + 3\\left(\\frac{7}{2}\\right) - 5\\right) = \\frac{1}{11}\\left(-\\frac{11}{4} + \\frac{21}{2} - 5\\right) = \\frac{1}{11}\\left(\\frac{-11+42-20}{4}\\right) = \\frac{1}{11}\\left(\\frac{11}{4}\\right) = \\frac{1}{4}$$\nThe barycentric coordinates of $P$ are $(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = (\\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4})$. Note that they sum to $1$ ($\\frac{1}{4}+\\frac{1}{2}+\\frac{1}{4}=1$) and are all positive, which confirms the statement that $P$ lies strictly inside the triangle.\n\nThird, we evaluate the interpolations. The nodal interpolation of a function $f(x,y)$ is given by $I_{h}f(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)f(V_{i})$. At point $P$, this becomes $I_{h}f(P)=\\sum_{i=1}^{3}N_{i}(P)f(V_{i}) = \\sum_{i=1}^{3}\\lambda_{i}f(V_{i})$.\n\nFor the constant function $g(x,y) = c$, we have $g(V_{i}) = c$ for all $i$.\n$$I_{h}g(P) = \\sum_{i=1}^{3}\\lambda_{i}g(V_{i}) = \\lambda_{1}c + \\lambda_{2}c + \\lambda_{3}c = c(\\lambda_{1} + \\lambda_{2} + \\lambda_{3}) = c(1) = c$$\nThe exact value is $g(P) = c$. The interpolation is exact, as expected.\n\nFor the linear function $\\ell(x,y) = 3x - 2y + 1$, we first evaluate it at the vertices:\n$\\ell(V_{1}) = \\ell(1,2) = 3(1) - 2(2) + 1 = 3 - 4 + 1 = 0$\n$\\ell(V_{2}) = \\ell(4,3) = 3(4) - 2(3) + 1 = 12 - 6 + 1 = 7$\n$\\ell(V_{3}) = \\ell(2,6) = 3(2) - 2(6) + 1 = 6 - 12 + 1 = -5$\nNow we compute the interpolated value at $P$:\n$$I_{h}\\ell(P) = \\sum_{i=1}^{3}\\lambda_{i}\\ell(V_{i}) = \\lambda_{1}\\ell(V_{1}) + \\lambda_{2}\\ell(V_{2}) + \\lambda_{3}\\ell(V_{3})$$\n$$I_{h}\\ell(P) = \\left(\\frac{1}{4}\\right)(0) + \\left(\\frac{1}{2}\\right)(7) + \\left(\\frac{1}{4}\\right)(-5) = 0 + \\frac{7}{2} - \\frac{5}{4} = \\frac{14}{4} - \\frac{5}{4} = \\frac{9}{4}$$\nTo verify exactness, we compute the true value of $\\ell(P)$:\n$$\\ell(P) = \\ell\\left(\\frac{11}{4},\\frac{7}{2}\\right) = 3\\left(\\frac{11}{4}\\right) - 2\\left(\\frac{7}{2}\\right) + 1 = \\frac{33}{4} - 7 + 1 = \\frac{33}{4} - 6 = \\frac{33-24}{4} = \\frac{9}{4}$$\nThe interpolated value $I_{h}\\ell(P) = \\frac{9}{4}$ is identical to the true value $\\ell(P) = \\frac{9}{4}$. This confirms the theoretical property that linear Lagrange elements provide an exact interpolation for any function within the polynomial space from which the shape functions are constructed, which in this case includes all affine functions. The final required answer is the value of $I_{h}\\ell(P)$.", "answer": "$$\\boxed{\\frac{9}{4}}$$", "id": "2586144"}, {"introduction": "We now advance from linear triangles to higher-order quadrilaterals, a common element in engineering analysis. This practice guides you through the powerful tensor-product method to construct biquadratic shape functions, demonstrating how complex 2D elements arise from simple 1D polynomials and allowing you to concretely verify the pivotal Kronecker-delta property [@problem_id:2586159].", "problem": "Consider the standard $9$-node biquadratic Lagrange quadrilateral element used in the Finite Element Method (FEM). Let the natural coordinates be $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$, and let the nodal locations be the tensor grid points $\\{-1,0,1\\}\\times\\{-1,0,1\\}$. Use the following node numbering and coordinates:\n- Node $1$: $(\\xi,\\eta)=(-1,-1)$,\n- Node $2$: $(\\xi,\\eta)=(1,-1)$,\n- Node $3$: $(\\xi,\\eta)=(1,1)$,\n- Node $4$: $(\\xi,\\eta)=(-1,1)$,\n- Node $5$: $(\\xi,\\eta)=(0,0)$,\n- Node $6$: $(\\xi,\\eta)=(0,-1)$,\n- Node $7$: $(\\xi,\\eta)=(1,0)$,\n- Node $8$: $(\\xi,\\eta)=(0,1)$,\n- Node $9$: $(\\xi,\\eta)=(-1,0)$.\n\nStarting only from the definition of one-dimensional quadratic Lagrange interpolation on the nodes $\\{-1,0,1\\}$—namely, that the basis polynomials $\\ell_{-1}(\\xi)$, $\\ell_{0}(\\xi)$, and $\\ell_{1}(\\xi)$ satisfy $\\ell_{a}(b)=\\delta_{ab}$ for $a,b\\in\\{-1,0,1\\}$ and reproduce constants—construct the two-dimensional shape functions as tensor products $N_{(\\alpha,\\beta)}(\\xi,\\eta)=\\ell_{\\alpha}(\\xi)\\,\\ell_{\\beta}(\\eta)$ associated with each node $(\\alpha,\\beta)\\in\\{-1,0,1\\}\\times\\{-1,0,1\\}$ mapped to the numbering above. Then, by direct evaluation at the element center $(\\xi,\\eta)=(0,0)$:\n1. Compute $N_{5}(0,0)$ at the center node.\n2. Compute $N_{i}(0,0)$ for all corner nodes $i\\in\\{1,2,3,4\\}$ and all edge-midpoint nodes $i\\in\\{6,7,8,9\\}$.\n3. Use these values to verify both the Kronecker-delta property at node $5$ and the partition of unity property.\n\nReport your final answer as a single row matrix containing $(N_{1}(0,0),N_{2}(0,0),\\dots,N_{9}(0,0))$ in that order. No rounding is required and no units are involved.", "solution": "The problem is well-posed and scientifically sound, representing a fundamental exercise in the Finite Element Method. It is validated and I will proceed with the solution.\n\nThe task is to construct the shape functions for a $9$-node biquadratic Lagrange quadrilateral element and evaluate them at the element's center, $(\\xi, \\eta) = (0,0)$. The construction is based on the tensor product of one-dimensional quadratic Lagrange basis polynomials.\n\nFirst, we must define the one-dimensional quadratic Lagrange basis polynomials, $\\ell_a(\\xi)$, on the interval $[-1, 1]$ with nodes at $\\{-1, 0, 1\\}$. These polynomials are defined by the property $\\ell_a(b) = \\delta_{ab}$ for $a, b \\in \\{-1, 0, 1\\}$, where $\\delta_{ab}$ is the Kronecker delta. Since they are quadratic, they can be written as $c_2\\xi^2 + c_1\\xi + c_0$.\n\nFor the basis function associated with the node at $\\xi = -1$, denoted $\\ell_{-1}(\\xi)$:\nIt must satisfy $\\ell_{-1}(-1) = 1$, $\\ell_{-1}(0) = 0$, and $\\ell_{-1}(1) = 0$.\nThe conditions $\\ell_{-1}(0) = 0$ and $\\ell_{-1}(1) = 0$ imply that the polynomial must have roots at $\\xi=0$ and $\\xi=1$, so it is of the form $C \\cdot \\xi(\\xi-1)$ for some constant $C$.\nThe condition $\\ell_{-1}(-1) = 1$ determines the constant $C$:\n$C \\cdot (-1)(-1-1) = 1 \\implies C \\cdot (-1)(-2) = 1 \\implies 2C = 1 \\implies C = \\frac{1}{2}$.\nThus, $\\ell_{-1}(\\xi) = \\frac{1}{2}\\xi(\\xi-1) = \\frac{1}{2}(\\xi^2 - \\xi)$.\n\nFor the basis function associated with the node at $\\xi = 0$, denoted $\\ell_{0}(\\xi)$:\nIt must satisfy $\\ell_{0}(-1) = 0$, $\\ell_{0}(0) = 1$, and $\\ell_{0}(1) = 0$.\nThe conditions $\\ell_{0}(-1) = 0$ and $\\ell_{0}(1) = 0$ imply the polynomial is of the form $C \\cdot (\\xi+1)(\\xi-1) = C(\\xi^2-1)$.\nThe condition $\\ell_{0}(0) = 1$ determines $C$:\n$C \\cdot (0^2-1) = 1 \\implies -C = 1 \\implies C = -1$.\nThus, $\\ell_{0}(\\xi) = -(\\xi^2-1) = 1 - \\xi^2$.\n\nFor the basis function associated with the node at $\\xi = 1$, denoted $\\ell_{1}(\\xi)$:\nIt must satisfy $\\ell_{1}(-1) = 0$, $\\ell_{1}(0) = 0$, and $\\ell_{1}(1) = 1$.\nThe conditions $\\ell_{1}(-1) = 0$ and $\\ell_{1}(0) = 0$ imply the polynomial is of the form $C \\cdot (\\xi+1)\\xi$.\nThe condition $\\ell_{1}(1) = 1$ determines $C$:\n$C \\cdot (1+1)(1) = 1 \\implies 2C = 1 \\implies C = \\frac{1}{2}$.\nThus, $\\ell_{1}(\\xi) = \\frac{1}{2}\\xi(\\xi+1) = \\frac{1}{2}(\\xi^2 + \\xi)$.\n\nThe problem requires evaluating the two-dimensional shape functions at the central point $(\\xi, \\eta) = (0,0)$. For this, we first evaluate the one-dimensional basis functions at $\\xi=0$:\n$\\ell_{-1}(0) = \\frac{1}{2}(0^2 - 0) = 0$.\n$\\ell_{0}(0) = 1 - 0^2 = 1$.\n$\\ell_{1}(0) = \\frac{1}{2}(0^2 + 0) = 0$.\nThese results are a direct consequence of the Kronecker delta property, as $\\ell_a(0) = \\delta_{a0}$. By symmetry, the same values hold for the basis functions in the $\\eta$ direction: $\\ell_{-1}(0)=0$, $\\ell_{0}(0)=1$, and $\\ell_{1}(0)=0$.\n\nThe two-dimensional shape function $N_i(\\xi, \\eta)$ associated with node $i$, which has coordinates $(\\xi_i, \\eta_i) = (\\alpha, \\beta)$ where $\\alpha, \\beta \\in \\{-1, 0, 1\\}$, is given by the tensor product:\n$N_i(\\xi, \\eta) = \\ell_{\\alpha}(\\xi) \\ell_{\\beta}(\\eta)$.\nWe are asked to evaluate each $N_i$ at $(\\xi, \\eta) = (0,0)$. This yields $N_i(0,0) = \\ell_{\\alpha}(0) \\ell_{\\beta}(0)$.\n\nWe now evaluate this for each of the $9$ nodes using the node numbering provided:\n- Node $1$: $(\\xi_1, \\eta_1) = (-1, -1)$. This corresponds to $(\\alpha, \\beta) = (-1, -1)$.\n$N_1(0,0) = \\ell_{-1}(0) \\ell_{-1}(0) = 0 \\times 0 = 0$.\n- Node $2$: $(\\xi_2, \\eta_2) = (1, -1)$. This corresponds to $(\\alpha, \\beta) = (1, -1)$.\n$N_2(0,0) = \\ell_{1}(0) \\ell_{-1}(0) = 0 \\times 0 = 0$.\n- Node $3$: $(\\xi_3, \\eta_3) = (1, 1)$. This corresponds to $(\\alpha, \\beta) = (1, 1)$.\n$N_3(0,0) = \\ell_{1}(0) \\ell_{1}(0) = 0 \\times 0 = 0$.\n- Node $4$: $(\\xi_4, \\eta_4) = (-1, 1)$. This corresponds to $(\\alpha, \\beta) = (-1, 1)$.\n$N_4(0,0) = \\ell_{-1}(0) \\ell_{1}(0) = 0 \\times 0 = 0$.\n- Node $5$: $(\\xi_5, \\eta_5) = (0, 0)$. This corresponds to $(\\alpha, \\beta) = (0, 0)$.\n$N_5(0,0) = \\ell_{0}(0) \\ell_{0}(0) = 1 \\times 1 = 1$.\n- Node $6$: $(\\xi_6, \\eta_6) = (0, -1)$. This corresponds to $(\\alpha, \\beta) = (0, -1)$.\n$N_6(0,0) = \\ell_{0}(0) \\ell_{-1}(0) = 1 \\times 0 = 0$.\n- Node $7$: $(\\xi_7, \\eta_7) = (1, 0)$. This corresponds to $(\\alpha, \\beta) = (1, 0)$.\n$N_7(0,0) = \\ell_{1}(0) \\ell_{0}(0) = 0 \\times 1 = 0$.\n- Node $8$: $(\\xi_8, \\eta_8) = (0, 1)$. This corresponds to $(\\alpha, \\beta) = (0, 1)$.\n$N_8(0,0) = \\ell_{0}(0) \\ell_{1}(0) = 1 \\times 0 = 0$.\n- Node $9$: $(\\xi_9, \\eta_9) = (-1, 0)$. This corresponds to $(\\alpha, \\beta) = (-1, 0)$.\n$N_9(0,0) = \\ell_{-1}(0) \\ell_{0}(0) = 0 \\times 1 = 0$.\n\nThe problem also requires verification of key properties at the center point.\n1. Kronecker-delta property: This property states that $N_i(\\xi_j, \\eta_j) = \\delta_{ij}$. We must check this for evaluation at node $5$, which is at $(\\xi_5, \\eta_5) = (0,0)$. Our calculations show $N_5(0,0) = 1$ and $N_i(0,0) = 0$ for all $i \\neq 5$. This correctly demonstrates $N_i(\\xi_5, \\eta_5) = \\delta_{i5}$ for all $i \\in \\{1, \\dots, 9\\}$. The property is verified. Corner nodes $(1,2,3,4)$ and edge-midpoint nodes $(6,7,8,9)$ all have shape functions that evaluate to zero at the center node $(5)$, as required.\n2. Partition of unity property: This states that $\\sum_{i=1}^9 N_i(\\xi, \\eta) = 1$ for all $(\\xi, \\eta)$ in the element. Evaluating at the center point:\n$\\sum_{i=1}^9 N_i(0,0) = N_1(0,0) + N_2(0,0) + \\dots + N_9(0,0) = 0+0+0+0+1+0+0+0+0 = 1$.\nThe partition of unity is also verified at the center point.\n\nThe final result is the ordered set of values $(N_1(0,0), N_2(0,0), \\dots, N_9(0,0))$.\nThe vector of values is $(0, 0, 0, 0, 1, 0, 0, 0, 0)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\n\\end{pmatrix}\n}\n$$", "id": "2586159"}, {"introduction": "Why is the Kronecker-delta property so important? This final exercise explores the question through a powerful counterexample, using a set of basis functions that do not satisfy this property. By working through the consequences, you will uncover the crucial link between the basis functions and the direct imposition of nodal values, deepening your appreciation for the elegant structure of standard Lagrange elements [@problem_id:2586154].", "problem": "Consider the reference triangle $T$ with vertices $\\boldsymbol{v}_1=(0,0)$, $\\boldsymbol{v}_2=(1,0)$, and $\\boldsymbol{v}_3=(0,1)$ in the plane. Let $L_1(x,y)=1-x-y$, $L_2(x,y)=x$, and $L_3(x,y)=y$ denote the barycentric coordinates on $T$, which satisfy the foundational properties $L_1+L_2+L_3=1$ and $L_i(\\boldsymbol{v}_j)=\\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta. Define three functions on $T$ by\n$$\n\\phi_1 = L_1 + L_2, \\quad \\phi_2 = L_2 + L_3, \\quad \\phi_3 = L_3 + L_1.\n$$\nThese functions are candidates for shape functions in the finite element method (FEM).\n\nUsing only the properties of barycentric coordinates and the definitions above, do the following:\n- Demonstrate from first principles that $\\{\\phi_1,\\phi_2,\\phi_3\\}$ is a linearly independent set on $T$.\n- Evaluate the nodal values $\\phi_i(\\boldsymbol{v}_j)$ and thus show that the Kronecker-delta property $\\,\\phi_i(\\boldsymbol{v}_j)=\\delta_{ij}\\,$ fails for this basis. State whether the partition of unity property holds.\n- Consider an interpolant $u_h \\in \\operatorname{span}\\{\\phi_1,\\phi_2,\\phi_3\\}$ of the form $u_h = a_1 \\phi_1 + a_2 \\phi_2 + a_3 \\phi_3$. Let the prescribed nodal values be $u_1 = u_h(\\boldsymbol{v}_1)$, $u_2 = u_h(\\boldsymbol{v}_2)$, and $u_3 = u_h(\\boldsymbol{v}_3)$. Explain why the coefficients $a_1,a_2,a_3$ cannot be set directly equal to $u_1,u_2,u_3$, and derive the linear system that maps $\\begin{pmatrix}a_1 & a_2 & a_3\\end{pmatrix}^\\top$ to $\\begin{pmatrix}u_1 & u_2 & u_3\\end{pmatrix}^\\top$.\n\nProvide, as your final answer, the explicit analytical expression for the coefficient vector $\\begin{pmatrix}a_1 & a_2 & a_3\\end{pmatrix}$ in terms of the nodal values $\\begin{pmatrix}u_1 & u_2 & u_3\\end{pmatrix}$. Express your final answer as a single row matrix. No rounding is required.", "solution": "The problem statement provided is self-contained, logically consistent, and scientifically sound. It presents a standard exercise in the analysis of basis functions within the framework of the finite element method. All terms are well-defined, and the tasks are unambiguous. Therefore, the problem is valid, and we may proceed with its solution.\n\nThe foundational principle is the linear independence of the barycentric coordinates $\\{ L_1, L_2, L_3 \\}$. These functions form a basis for linear polynomials on the triangle $T$. Consequently, any linear combination $\\alpha_1 L_1 + \\alpha_2 L_2 + \\alpha_3 L_3 = 0$ for all points $(x,y) \\in T$ implies that $\\alpha_1 = \\alpha_2 = \\alpha_3 = 0$. We will use this fact to answer the first part of the problem.\n\nFirst, we demonstrate the linear independence of the set $\\{\\phi_1, \\phi_2, \\phi_3\\}$. We set up a linear combination equal to the zero function on $T$:\n$$\nc_1 \\phi_1 + c_2 \\phi_2 + c_3 \\phi_3 = 0\n$$\nSubstituting the definitions of $\\phi_i$ in terms of the barycentric coordinates $L_i$:\n$$\nc_1 (L_1 + L_2) + c_2 (L_2 + L_3) + c_3 (L_3 + L_1) = 0\n$$\nWe rearrange the terms by grouping the coefficients of each barycentric coordinate function:\n$$\n(c_1 + c_3) L_1 + (c_1 + c_2) L_2 + (c_2 + c_3) L_3 = 0\n$$\nSince the set $\\{L_1, L_2, L_3\\}$ is linearly independent, the coefficients of this linear combination must all be zero. This yields a system of linear equations for the unknown constants $c_1, c_2, c_3$:\n$$\n\\begin{cases}\nc_1 + c_3 = 0 \\\\\nc_1 + c_2 = 0 \\\\\nc_2 + c_3 = 0\n\\end{cases}\n$$\nFrom the first equation, $c_3 = -c_1$. From the second, $c_2 = -c_1$. Substituting these into the third equation gives $(-c_1) + (-c_1) = 0$, which simplifies to $-2c_1 = 0$, implying $c_1 = 0$. Consequently, $c_2 = 0$ and $c_3 = 0$. Since the only solution is the trivial one where all coefficients are zero, the set of functions $\\{\\phi_1, \\phi_2, \\phi_3\\}$ is proven to be linearly independent.\n\nNext, we evaluate the nodal values $\\phi_i(\\boldsymbol{v}_j)$ using the given property $L_i(\\boldsymbol{v}_j) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\nFor $\\phi_1 = L_1 + L_2$:\n$\\phi_1(\\boldsymbol{v}_1) = L_1(\\boldsymbol{v}_1) + L_2(\\boldsymbol{v}_1) = 1 + 0 = 1$.\n$\\phi_1(\\boldsymbol{v}_2) = L_1(\\boldsymbol{v}_2) + L_2(\\boldsymbol{v}_2) = 0 + 1 = 1$.\n$\\phi_1(\\boldsymbol{v}_3) = L_1(\\boldsymbol{v}_3) + L_2(\\boldsymbol{v}_3) = 0 + 0 = 0$.\n\nFor $\\phi_2 = L_2 + L_3$:\n$\\phi_2(\\boldsymbol{v}_1) = L_2(\\boldsymbol{v}_1) + L_3(\\boldsymbol{v}_1) = 0 + 0 = 0$.\n$\\phi_2(\\boldsymbol{v}_2) = L_2(\\boldsymbol{v}_2) + L_3(\\boldsymbol{v}_2) = 1 + 0 = 1$.\n$\\phi_2(\\boldsymbol{v}_3) = L_2(\\boldsymbol{v}_3) + L_3(\\boldsymbol{v}_3) = 0 + 1 = 1$.\n\nFor $\\phi_3 = L_3 + L_1$:\n$\\phi_3(\\boldsymbol{v}_1) = L_3(\\boldsymbol{v}_1) + L_1(\\boldsymbol{v}_1) = 0 + 1 = 1$.\n$\\phi_3(\\boldsymbol{v}_2) = L_3(\\boldsymbol{v}_2) + L_1(\\boldsymbol{v}_2) = 0 + 0 = 0$.\n$\\phi_3(\\boldsymbol{v}_3) = L_3(\\boldsymbol{v}_3) + L_1(\\boldsymbol{v}_3) = 1 + 0 = 1$.\n\nThe Kronecker-delta property requires that $\\phi_i(\\boldsymbol{v}_j) = \\delta_{ij}$. As an example, the property requires $\\phi_1(\\boldsymbol{v}_2) = \\delta_{12} = 0$, but we calculated $\\phi_1(\\boldsymbol{v}_2) = 1$. Since the values do not match the Kronecker delta, the property fails for this basis.\n\nTo check for the partition of unity property, we must verify if $\\sum_{i=1}^3 \\phi_i = 1$ over $T$. We sum the functions:\n$$\n\\sum_{i=1}^3 \\phi_i = \\phi_1 + \\phi_2 + \\phi_3 = (L_1 + L_2) + (L_2 + L_3) + (L_3 + L_1) = 2L_1 + 2L_2 + 2L_3\n$$\nUsing the given property that $L_1 + L_2 + L_3 = 1$, we find:\n$$\n\\sum_{i=1}^3 \\phi_i = 2(L_1 + L_2 + L_3) = 2(1) = 2\n$$\nSince the sum is $2$, not $1$, the partition of unity property is not satisfied.\n\nFinally, we consider the interpolant $u_h = a_1 \\phi_1 + a_2 \\phi_2 + a_3 \\phi_3$. The coefficients $a_i$ represent the degrees of freedom. The nodal values $u_j$ are given by $u_j = u_h(\\boldsymbol{v}_j)$. For coefficients $a_i$ to be directly equal to the nodal values $u_i$, i.e., $a_j = u_j$, the basis must satisfy the Kronecker-delta property. To see this, if $\\phi_i(\\boldsymbol{v}_j) = \\delta_{ij}$, then evaluating at a node $\\boldsymbol{v}_j$ would yield $u_h(\\boldsymbol{v}_j) = \\sum_{i=1}^3 a_i \\phi_i(\\boldsymbol{v}_j) = \\sum_{i=1}^3 a_i \\delta_{ij} = a_j$. Since we have demonstrated that the Kronecker-delta property fails for this basis, the coefficients $a_j$ are not, in general, equal to the nodal values $u_j$.\n\nTo find the relationship between the coefficients $\\boldsymbol{a} = \\begin{pmatrix} a_1 & a_2 & a_3 \\end{pmatrix}^\\top$ and the nodal values $\\boldsymbol{u} = \\begin{pmatrix} u_1 & u_2 & u_3 \\end{pmatrix}^\\top$, we evaluate the interpolant at each vertex:\n$u_1 = u_h(\\boldsymbol{v}_1) = a_1 \\phi_1(\\boldsymbol{v}_1) + a_2 \\phi_2(\\boldsymbol{v}_1) + a_3 \\phi_3(\\boldsymbol{v}_1) = a_1(1) + a_2(0) + a_3(1) = a_1 + a_3$.\n$u_2 = u_h(\\boldsymbol{v}_2) = a_1 \\phi_1(\\boldsymbol{v}_2) + a_2 \\phi_2(\\boldsymbol{v}_2) + a_3 \\phi_3(\\boldsymbol{v}_2) = a_1(1) + a_2(1) + a_3(0) = a_1 + a_2$.\n$u_3 = u_h(\\boldsymbol{v}_3) = a_1 \\phi_1(\\boldsymbol{v}_3) + a_2 \\phi_2(\\boldsymbol{v}_3) + a_3 \\phi_3(\\boldsymbol{v}_3) = a_1(0) + a_2(1) + a_3(1) = a_2 + a_3$.\n\nThis gives the linear system $\\boldsymbol{u} = M \\boldsymbol{a}$:\n$$\n\\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 1 \\\\ 1 & 1 & 0 \\\\ 0 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} a_1 \\\\ a_2 \\\\ a_3 \\end{pmatrix}\n$$\nTo solve for $\\boldsymbol{a}$, we must compute the inverse of the matrix $M$. The determinant of $M$ is $\\det(M) = 1(1-0) - 0(1-0) + 1(1-0) = 2$.\nThe inverse matrix $M^{-1}$ is given by $\\frac{1}{\\det(M)}\\text{adj}(M)$. The adjugate matrix is the transpose of the cofactor matrix.\nThe cofactor matrix is:\n$$\nC = \\begin{pmatrix}\n\\begin{vmatrix} 1 & 0 \\\\ 1 & 1 \\end{vmatrix} & -\\begin{vmatrix} 1 & 0 \\\\ 0 & 1 \\end{vmatrix} & \\begin{vmatrix} 1 & 1 \\\\ 0 & 1 \\end{vmatrix} \\\\\n-\\begin{vmatrix} 0 & 1 \\\\ 1 & 1 \\end{vmatrix} & \\begin{vmatrix} 1 & 1 \\\\ 0 & 1 \\end{vmatrix} & -\\begin{vmatrix} 1 & 0 \\\\ 0 & 1 \\end{vmatrix} \\\\\n\\begin{vmatrix} 0 & 1 \\\\ 1 & 0 \\end{vmatrix} & -\\begin{vmatrix} 1 & 1 \\\\ 1 & 0 \\end{vmatrix} & \\begin{vmatrix} 1 & 0 \\\\ 1 & 1 \\end{vmatrix}\n\\end{pmatrix}\n= \\begin{pmatrix} 1 & -1 & 1 \\\\ 1 & 1 & -1 \\\\ -1 & 1 & 1 \\end{pmatrix}\n$$\nThe adjugate matrix is $\\text{adj}(M) = C^\\top = \\begin{pmatrix} 1 & 1 & -1 \\\\ -1 & 1 & 1 \\\\ 1 & -1 & 1 \\end{pmatrix}$.\nTherefore, the inverse matrix is:\n$$\nM^{-1} = \\frac{1}{2} \\begin{pmatrix} 1 & 1 & -1 \\\\ -1 & 1 & 1 \\\\ 1 & -1 & 1 \\end{pmatrix}\n$$\nThe coefficients $\\boldsymbol{a}$ are found by $\\boldsymbol{a} = M^{-1} \\boldsymbol{u}$:\n$$\n\\begin{pmatrix} a_1 \\\\ a_2 \\\\ a_3 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1 & 1 & -1 \\\\ -1 & 1 & 1 \\\\ 1 & -1 & 1 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} u_1 + u_2 - u_3 \\\\ -u_1 + u_2 + u_3 \\\\ u_1 - u_2 + u_3 \\end{pmatrix}\n$$\nThis provides the explicit expressions for $a_1, a_2,$ and $a_3$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}(u_1 + u_2 - u_3) & \\frac{1}{2}(-u_1 + u_2 + u_3) & \\frac{1}{2}(u_1 - u_2 + u_3)\n\\end{pmatrix}\n}\n$$", "id": "2586154"}]}