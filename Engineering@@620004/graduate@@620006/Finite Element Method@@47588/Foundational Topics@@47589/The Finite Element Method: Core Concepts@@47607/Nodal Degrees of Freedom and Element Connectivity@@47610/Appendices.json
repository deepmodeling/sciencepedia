{"hands_on_practices": [{"introduction": "This first practice is foundational, bridging the gap between the abstract choice of a polynomial approximation space and the concrete placement of nodal degrees of freedom (DOFs) on a finite element. By working through this exercise for linear ($p=1$) and quadratic ($p=2$) tetrahedral elements, you will develop a first-principles understanding of how an element's complexity is determined. This exercise will clarify why \"p-refinement\"—increasing the polynomial order—directly impacts the number of DOFs and, consequently, the computational cost of a simulation [@problem_id:2583811].", "problem": "Consider the scalar Poisson problem $-\\nabla \\cdot (\\kappa \\nabla u) = f$ on a bounded domain $\\Omega \\subset \\mathbb{R}^{3}$ with appropriate boundary conditions, discretized by a conforming tetrahedral mesh. Suppose you construct a continuous Galerkin (CG) finite element method using standard Lagrange shape functions of total polynomial degree $p \\in \\{1,2\\}$ on each tetrahedral element $T$. In this setting, a nodal degree of freedom (DOF) corresponds to the value of the discrete field $u_{h}$ at an interpolation node associated with $T$, and the number of element-level DOFs equals the dimension of the local polynomial approximation space on $T$. \n\nStarting from first principles, do the following:\n1. From the characterization of monomials in three variables, determine the number of linearly independent polynomials of total degree at most $p$ on a tetrahedron for $p=1$ (linear) and $p=2$ (quadratic), and thus the number of nodal DOFs per tetrahedral element for a scalar unknown $u$ for each $p$.\n2. Identify where these nodal DOFs are geometrically located within a tetrahedral element (i.e., associated with vertices, edges, faces, and/or the interior) for $p=1$ and for $p=2$, consistent with standard Lagrange interpolation on tetrahedra.\n3. Based on your derivation, compute the increase in the number of element-level DOFs when moving from linear ($p=1$) to quadratic ($p=2$) tetrahedral elements for the scalar Poisson problem.\n\nReport only the increase in the number of DOFs per element as your final answer. No rounding is required, and no units are to be reported.", "solution": "The problem statement is subjected to validation before any attempt at a solution is made.\n\nFirst, the givens are extracted verbatim as required.\n- Problem: Scalar Poisson problem $-\\nabla \\cdot (\\kappa \\nabla u) = f$.\n- Domain: A bounded domain $\\Omega \\subset \\mathbb{R}^{3}$.\n- Mesh: A conforming tetrahedral mesh.\n- Method: Continuous Galerkin (CG) finite element method.\n- Shape functions: Standard Lagrange shape functions of total polynomial degree $p \\in \\{1,2\\}$.\n- Element type: A tetrahedral element $T$.\n- Nodal DOF definition: The value of the discrete field $u_{h}$ at an interpolation node associated with $T$.\n- Number of element-level DOFs: The dimension of the local polynomial approximation space on $T$.\n- Tasks:\n    1. Determine the number of linearly independent polynomials of total degree at most $p$ on a tetrahedron (i.e., the number of nodal DOFs) for $p=1$ and $p=2$.\n    2. Identify the geometric location of these nodal DOFs for $p=1$ and $p=2$.\n    3. Compute the increase in the number of element-level DOFs from $p=1$ to $p=2$.\n\nThe problem is now validated against the specified criteria.\n- **Scientifically Grounded**: The problem is a fundamental exercise in the theory of the finite element method. It deals with standard concepts: the Poisson equation, tetrahedral elements, Lagrange polynomials, and degrees of freedom. All premises are factually sound and central to computational mathematics.\n- **Well-Posed**: The problem is clearly stated and provides all necessary information to derive a unique, deterministic answer.\n- **Objective**: The language is formal, precise, and devoid of any subjective or non-scientific content.\n\nThe problem is therefore valid. It is a standard, well-posed question that can be answered rigorously from first principles. We proceed to the solution.\n\nThe number of nodal degrees of freedom (DOFs) for a scalar unknown on a single element corresponds to the dimension of the local polynomial space used for approximation. For a Lagrange element, this dimension is equal to the number of nodes required to uniquely define a polynomial of a given degree. We are asked to consider polynomials of total degree at most $p$ in three spatial dimensions $(x, y, z)$.\n\nThe space of polynomials of total degree at most $p$ in $d$ variables is denoted $\\mathcal{P}_p(\\mathbb{R}^d)$. The dimension of this space is the number of distinct monomials of the form $x_1^{\\alpha_1} x_2^{\\alpha_2} \\cdots x_d^{\\alpha_d}$ where the exponents $\\alpha_i$ are non-negative integers such that their sum is less than or equal to $p$: $\\sum_{i=1}^{d} \\alpha_i \\le p$.\n\nIn our case, the spatial dimension is $d=3$. The condition is $\\alpha_1 + \\alpha_2 + \\alpha_3 \\le p$. To count the number of such integer solutions, we can use a standard combinatorial argument, often referred to as \"stars and bars\". By introducing a slack variable $\\alpha_4 \\ge 0$, the inequality is transformed into an equality: $\\alpha_1 + \\alpha_2 + \\alpha_3 + \\alpha_4 = p$. The problem is now equivalent to finding the number of ways to distribute $p$ identical items (stars) into $d+1 = 4$ distinct bins (separated by $d=3$ bars). The formula for this is given by the binomial coefficient:\n$$ N_{\\text{dof}}(p, d) = \\binom{p+d}{d} $$\nFor our specific three-dimensional tetrahedral element, $d=3$, so the formula simplifies to:\n$$ N_{\\text{dof}}(p, 3) = \\binom{p+3}{3} $$\n\nWe now apply this formula for the specified polynomial degrees $p=1$ and $p=2$.\n\n1 . For linear elements, $p=1$.\nThe number of DOFs per element, $N_1$, is:\n$$ N_{1} = \\binom{1+3}{3} = \\binom{4}{3} = \\frac{4!}{3!(4-3)!} = \\frac{4!}{3!1!} = 4 $$\nThus, a linear tetrahedral element has $4$ DOFs. For a Lagrange element, these DOFs must uniquely determine a linear polynomial $P_1(x, y, z) = c_0 + c_1 x + c_2 y + c_3 z$. A tetrahedron is a geometric shape with $4$ vertices. Placing one node at each of the $4$ vertices provides the $4$ necessary and sufficient conditions to define the polynomial. Therefore, for $p=1$, the nodal DOFs are located at the $4$ vertices of the tetrahedron.\n\n2 . For quadratic elements, $p=2$.\nThe number of DOFs per element, $N_2$, is:\n$$ N_{2} = \\binom{2+3}{3} = \\binom{5}{3} = \\frac{5!}{3!(5-3)!} = \\frac{5!}{3!2!} = \\frac{5 \\times 4}{2 \\times 1} = 10 $$\nThus, a quadratic tetrahedral element has $10$ DOFs. To uniquely define a quadratic polynomial on the element, we need to place $10$ nodes. The geometric placement for standard Lagrange elements is determined by the unisolvence requirement. For continuity between elements, the nodes must be sufficient to uniquely define the polynomial trace on each face and edge. The trace of a $3$D quadratic polynomial on an edge (a line) is a $1$D quadratic polynomial. A $1$D quadratic requires $3$ points for its unique definition. An edge connects two vertices, so we must add one node to the interior of each edge. A tetrahedron has $4$ vertices and $6$ edges.\nThe locations of the $10$ nodes are therefore:\n- $4$ nodes at the vertices of the tetrahedron.\n- $6$ nodes at the midpoints of each of the $6$ edges.\nThis gives a total of $4 + 6 = 10$ nodes, which matches the dimension of the polynomial space. There are no nodes on the interior of the faces (other than the edges) and no nodes in the interior (volume) of the tetrahedron for the standard $p=2$ Lagrange element.\n\nFinally, we compute the increase in the number of element-level DOFs when moving from linear ($p=1$) to quadratic ($p=2$) elements.\nThe increase, $\\Delta N$, is the difference between the number of DOFs for the quadratic and linear cases:\n$$ \\Delta N = N_2 - N_1 = 10 - 4 = 6 $$\nThe increase in the number of element-level degrees of freedom is $6$.", "answer": "$$\\boxed{6}$$", "id": "2583811"}, {"introduction": "Having established how DOFs are defined on a single element, we now examine their collective behavior in an unconstrained, assembled system. This exercise explores the crucial link between the physics of rigid body motion and the mathematical properties of the global stiffness matrix, specifically its null space. Understanding why an unconstrained body has motions that produce zero strain energy is essential for learning how to apply the correct minimum set of boundary conditions to ensure a unique and stable solution in any finite element analysis [@problem_id:2583823].", "problem": "Consider a simply connected three-dimensional elastic body discretized by standard isoparametric 8-node hexahedral (trilinear) solid elements. Each node possesses exactly $3$ translational nodal degrees of freedom (DOFs), denoted by $u$, $v$, and $w$. The body undergoes small strains and small displacements, and the constitutive behavior is linear elastic with a positive-definite fourth-order elasticity tensor. No multipoint constraints, rotational DOFs, drilling DOFs, or penalty terms are present. Let $K_{e}$ be the element stiffness matrix obtained from the standard principle of virtual work and strain-displacement operator, and let $K$ be the assembled global stiffness matrix for the unconstrained mesh.\n\nStarting from the definition of the infinitesimal strain tensor $\\varepsilon(u) = \\tfrac{1}{2}\\left(\\nabla u + \\nabla u^{\\top}\\right)$ and the fact that the internal elastic energy density depends quadratically on $\\varepsilon(u)$, argue which displacement fields produce zero internal energy in the continuum limit and identify the corresponding nodal displacement patterns these induce in the discrete system. Use this to determine the dimension $r$ of the rigid body motion subspace for the $3$D body and hence the nullity of $K$ in the absence of essential boundary conditions. Then, reasoning from rank-nullity considerations and independence of constraints, determine the minimal number $N$ of independent nodal translational DOFs that must be prescribed on the boundary to render $K$ nonsingular for a connected domain without internal mechanisms. In your reasoning, you must also state a concrete example of a set of independent translational constraints that achieves this minimal number, using only nodal translations.\n\nProvide only the value of $N$ as your final answer. No rounding is needed, and no units are required.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It represents a fundamental question in the theory of the finite element method as applied to linear elastostatics. I shall proceed with the solution.\n\nThe internal elastic strain energy, $U$, stored within a deformable body occupying a volume $\\Omega$ is given by the integral of the strain energy density, $W(\\varepsilon)$, over the volume:\n$$\nU = \\int_{\\Omega} W(\\varepsilon) \\, dV\n$$\nThe problem states that the constitutive behavior is linear elastic with a positive-definite fourth-order elasticity tensor, $C$. The strain energy density is a quadratic form of the strain tensor, $\\varepsilon$:\n$$\nW(\\varepsilon) = \\frac{1}{2} \\varepsilon_{ij} C_{ijkl} \\varepsilon_{kl}\n$$\nwhere summation over repeated indices is implied. Since the tensor $C$ is positive-definite, the strain energy density $W(\\varepsilon)$ is zero if and only if the strain tensor $\\varepsilon$ is identically zero everywhere within the body. Consequently, the total internal energy $U$ is zero if and only if $\\varepsilon(\\mathbf{u}) = \\mathbf{0}$ for all points $\\mathbf{x} \\in \\Omega$.\n\nThe displacement fields $\\mathbf{u}(\\mathbf{x})$ that produce zero strain are found by solving the set of partial differential equations:\n$$\n\\varepsilon(\\mathbf{u}) = \\frac{1}{2} \\left( \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\top} \\right) = \\mathbf{0}\n$$\nThis is the defining equation for rigid body motion in continuum mechanics. The general solution in three dimensions is a displacement field of the form:\n$$\n\\mathbf{u}(\\mathbf{x}) = \\mathbf{a} + \\boldsymbol{\\omega} \\times \\mathbf{x}\n$$\nwhere $\\mathbf{a}$ is a constant vector representing an arbitrary rigid translation and $\\boldsymbol{\\omega}$ is a constant vector representing an arbitrary infinitesimal rigid rotation about the origin.\n\nThe vector $\\mathbf{a}$ has $3$ independent components ($a_x, a_y, a_z$) corresponding to translations along the coordinate axes. The vector $\\boldsymbol{\\omega}$ also has $3$ independent components ($\\omega_x, \\omega_y, \\omega_z$) corresponding to rotations about the coordinate axes. These two vectors define a $6$-dimensional vector space of displacement fields that result in zero strain and thus zero internal energy. These are the rigid body modes of the continuum. The dimension of this rigid body motion subspace is therefore $r = 3 (\\text{translations}) + 3 (\\text{rotations}) = 6$.\n\nIn the finite element discretization, the nodal displacements $\\mathbf{d}$ are related to the continuous displacement field $\\mathbf{u}$ by the shape functions. The unconstrained global stiffness matrix $K$ is positive semi-definite. Its null space consists of all nodal displacement vectors $\\mathbf{d}$ for which the strain energy is zero. Since the $8$-node hexahedral element has shape functions that are linear in each coordinate direction (trilinear), it can exactly represent any displacement field that is a linear function of the spatial coordinates $\\mathbf{x}$. The rigid body motion field $\\mathbf{u}(\\mathbf{x}) = \\mathbf{a} + \\boldsymbol{\\omega} \\times \\mathbf{x}$ is a linear function of $\\mathbf{x} = (x, y, z)$. Therefore, the discrete system can exactly represent all $6$ rigid body modes. This means that for any nodal displacement vector $\\mathbf{d}$ corresponding to one of these modes, the resulting strain in every element is zero. Consequently, the product $K\\mathbf{d}$ will be the zero vector. The dimension of the null space of $K$, which is its nullity, is equal to the number of independent rigid body modes. For a single, connected $3$D body, the nullity of the unconstrained global stiffness matrix $K$ is therefore $r=6$.\n\nTo render the matrix $K$ nonsingular (i.e., invertible), its nullity must be reduced to zero. This is achieved by applying essential boundary conditions, which are constraints on the nodal degrees of freedom (DOFs). Each independent constraint applied to the system that is capable of restricting at least one rigid body motion effectively removes one dimension from the null space. To eliminate all $6$ rigid body modes, one must apply a minimum of $6$ independent constraints. Applying fewer than $6$ constraints would leave at least one rigid body motion unconstrained, and the matrix $K$ would remain singular. Applying more than $6$ constraints would be redundant, assuming the first $6$ were chosen correctly to be independent. Therefore, the minimal number $N$ of independent nodal translational DOFs that must be prescribed to render $K$ nonsingular is equal to the number of rigid body modes, which is $6$.\n\nAs required, a concrete example of a minimal set of independent translational constraints that achieves this is the so-called \"$3-2-1$\" support condition. Consider three non-collinear nodes P1, P2, and P3.\n\\begin{enumerate}\n    \\item At node P1, fix all three translational DOFs ($u, v, w$). This requires $3$ constraints and prevents all three rigid translations ($T_x, T_y, T_z$). The body can now only rotate about axes passing through P1.\n    \\item At node P2, which does not coincide with P1, fix two translational DOFs. For instance, if the line P1-P2 is not parallel to the $x$-axis, fixing $v$ and $w$ at P2 requires $2$ more constraints. These prevent rotations about the $y$ and $z$ axes. The body can now only rotate about the axis defined by the line connecting P1 and P2.\n    \\item At node P3, which is not collinear with P1 and P2, fix one translational DOF. This single constraint must be perpendicular to the plane formed by P1, P2, and P3 if they are coplanar, or more generally, it must restrict the motion of P3 due to the final remaining rotation. For example, fixing the $w$ DOF at P3 would prevent rotation about an axis in the $xy$-plane. This final, $6$-th constraint eliminates the last rigid body mode.\n\\end{enumerate}\nThis set of $3+2+1=6$ constraints is independent and sufficient to suppress all $6$ rigid body modes, thus making the global stiffness matrix $K$ nonsingular. The minimal number of such constraints is therefore $N=6$.", "answer": "$$\\boxed{6}$$", "id": "2583823"}, {"introduction": "The previous practices established what DOFs are and why they must be constrained; we now turn to how their interconnections are managed computationally. This practice demonstrates how the topological map of a mesh—the list of nodes belonging to each element—can be encoded into a simple yet powerful matrix structure. By constructing a node-to-element incidence matrix and analyzing its properties, you will gain insight into the fundamental data structures that underpin the assembly and analysis of global systems in all finite element software [@problem_id:2583822].", "problem": "Consider a one-dimensional bar discretized for the finite element method (FEM) using $2$-node linear elements. The global node set is $\\mathcal{N} = \\{1,2,3\\}$ with coordinates $x_1 = 0$, $x_2 = a$, and $x_3 = L$, where $0 < a < L$. The element set is $\\mathcal{E} = \\{1,2\\}$ with the connectivity mapping $\\mathcal{C}(1) = (1,2)$ and $\\mathcal{C}(2) = (2,3)$. Each node carries one scalar degree of freedom, the axial displacement $u_i$ at node $i$. Define the node-to-element incidence matrix $B \\in \\{0,1\\}^{3 \\times 2}$ by the rule\n$$\nb_{i e} = \\begin{cases}\n1, & \\text{if node } i \\text{ is in element } e,\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\nUsing only fundamental definitions of nodes, elements, degrees of freedom, and connectivity in the finite element method, perform the following:\n\n- Construct the explicit matrix $B$.\n- Justify, from first principles, how $B$ encodes element adjacency via shared nodes by analyzing the product $C = B^{\\top} B$.\n\nFinally, compute the determinant of $C$. Express your final answer as an exact integer with no units. No rounding is required.", "solution": "We begin from the fundamental finite element abstractions:\n\n- Nodes are the discrete points $\\{x_i\\}_{i \\in \\mathcal{N}}$ at which unknowns (degrees of freedom) are defined. Here, each node $i \\in \\{1,2,3\\}$ carries one scalar displacement degree of freedom $u_i$.\n- Elements are subdomains with a connectivity that maps each element label to an ordered tuple of node labels. For a one-dimensional bar with linear segments, each element connects exactly $2$ nodes. The given connectivity is $\\mathcal{C}(1) = (1,2)$ and $\\mathcal{C}(2) = (2,3)$.\n- The node-to-element incidence matrix $B$ records membership of nodes in elements, with entries $b_{i e} \\in \\{0,1\\}$ indicating whether node $i$ belongs to element $e$.\n\nFrom these definitions, we construct $B$ by columns, one per element:\n\n- For element $e = 1$, the connected nodes are $1$ and $2$. Therefore, the first column has $b_{1,1} = 1$, $b_{2,1} = 1$, and $b_{3,1} = 0$.\n- For element $e = 2$, the connected nodes are $2$ and $3$. Therefore, the second column has $b_{1,2} = 0$, $b_{2,2} = 1$, and $b_{3,2} = 1$.\n\nHence,\n$$\nB = \\begin{pmatrix}\n1 & 0\\\\\n1 & 1\\\\\n0 & 1\n\\end{pmatrix}.\n$$\n\nTo justify how $B$ encodes element adjacency via shared nodes, consider the product $C = B^{\\top} B$. Its entries are given by\n$$\nC_{e e'} = \\sum_{i=1}^{3} b_{i e}\\, b_{i e'}.\n$$\nBy the definition of $b_{i e}$, the product $b_{i e}\\, b_{i e'}$ equals $1$ exactly when node $i$ belongs to both element $e$ and element $e'$, and equals $0$ otherwise. Therefore, $C_{e e'}$ counts the number of nodes shared by elements $e$ and $e'$. In particular:\n\n- The diagonal entries satisfy $C_{e e} = \\sum_{i=1}^{3} b_{i e}^2 = \\sum_{i=1}^{3} b_{i e}$, which equals the number of nodes in element $e$. For $2$-node linear elements, $C_{e e} = 2$.\n- The off-diagonal entry $C_{1 2} = C_{2 1}$ equals the number of common nodes between elements $1$ and $2$. Two elements are adjacent if and only if $C_{1 2} > 0$.\n\nCompute $C$ explicitly:\n$$\nC = B^{\\top} B\n= \\begin{pmatrix}\n1 & 1 & 0\\\\\n0 & 1 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n1 & 0\\\\\n1 & 1\\\\\n0 & 1\n\\end{pmatrix}\n= \\begin{pmatrix}\n2 & 1\\\\\n1 & 2\n\\end{pmatrix}.\n$$\nInterpreting $C$:\n- $C_{1 1} = 2$ and $C_{2 2} = 2$ confirm that each element has $2$ nodes.\n- $C_{1 2} = C_{2 1} = 1$ shows that elements $1$ and $2$ share exactly $1$ node (node $2$), hence they are adjacent.\n\nFinally, compute the determinant of $C$:\n$$\n\\det(C) = \\det\\!\\begin{pmatrix}\n2 & 1\\\\\n1 & 2\n\\end{pmatrix} = 2 \\cdot 2 - 1 \\cdot 1 = 3.\n$$\nThis is an exact integer, as required.", "answer": "$$\\boxed{3}$$", "id": "2583822"}]}