{"hands_on_practices": [{"introduction": "The remarkable efficiency of Gauss quadrature stems from the specific placement of its nodes and the values of its weights. This exercise takes you back to first principles, guiding you to derive the nodes and weights for the 2-point and 3-point Gauss-Legendre rules from scratch [@problem_id:2562003]. By directly engaging with the underlying properties of Legendre polynomials, you will gain a concrete understanding of how orthogonality is exploited to achieve a high degree of precision, a concept central to the finite element method.", "problem": "In the context of numerical integration on the reference interval $[-1,1]$ for the finite element method (FEM), consider Gauss–Legendre quadrature rules with respect to the unit weight. Let $(x_{i},w_{i})$ denote the nodes and weights of an $m$-point Gauss–Legendre rule on $[-1,1]$, so that the quadrature approximates $\\int_{-1}^{1} f(x)\\,\\mathrm{d}x$ by $\\sum_{i=1}^{m} w_{i} f(x_{i})$. Use only the following foundational facts: (i) the Legendre polynomials $\\{P_{n}\\}_{n\\ge 0}$ are orthogonal on $[-1,1]$ with respect to the unit weight, specifically $\\int_{-1}^{1} P_{n}(x) P_{m}(x)\\,\\mathrm{d}x = \\frac{2}{2n+1}\\delta_{nm}$, (ii) Rodrigues’ formula $P_{n}(x)=\\frac{1}{2^{n} n!}\\frac{\\mathrm{d}^{n}}{\\mathrm{d}x^{n}}\\bigl[(x^{2}-1)^{n}\\bigr]$, and (iii) the Gauss–Legendre nodes are the roots of $P_{m}(x)$ and the weights are determined by enforcing exactness for polynomials up to degree $2m-1$. Derive explicitly the nodes and weights for the two-point rule ($m=2$) and the three-point rule ($m=3$) on $[-1,1]$ by:\n- forming and solving $P_{2}(x)=0$ and $P_{3}(x)=0$ to obtain the nodes,\n- enforcing the exactness of the quadrature for monomials $x^{k}$ with $k$ up to $2m-1$ to solve for the weights, using symmetry as appropriate and the exact monomial integrals $\\int_{-1}^{1} x^{k}\\,\\mathrm{d}x$.\n\nReport your final result as a single row matrix that concatenates, in the following order, the nodes and weights of the two-point rule (nodes in strictly increasing order, followed by the corresponding weights) and then the nodes and weights of the three-point rule (again nodes in strictly increasing order, followed by the corresponding weights). Concretely, the row must be\n$$\n\\bigl(x_{1}^{(2)},\\,x_{2}^{(2)},\\,w_{1}^{(2)},\\,w_{2}^{(2)},\\,x_{1}^{(3)},\\,x_{2}^{(3)},\\,x_{3}^{(3)},\\,w_{1}^{(3)},\\,w_{2}^{(3)},\\,w_{3}^{(3)}\\bigr),\n$$\nwhere the superscript indicates the rule size $m$. Do not approximate; provide exact radicals and rational numbers. The final answer must be given exactly as a single row matrix with the entries in the specified order and no units.", "solution": "The objective is to derive the nodes $x_i$ and weights $w_i$ for the $m=2$-point and $m=3$-point Gauss-Legendre quadrature rules on the interval $[-1, 1]$. The quadrature approximation is given by $\\int_{-1}^{1} f(x)\\,\\mathrm{d}x \\approx \\sum_{i=1}^{m} w_{i} f(x_{i})$.\n\nThe procedure is as follows:\n$1$. For each rule of size $m$, find the Legendre polynomial $P_m(x)$ using Rodrigues’ formula: $P_{n}(x)=\\frac{1}{2^{n} n!}\\frac{\\mathrm{d}^{n}}{\\mathrm{d}x^{n}}\\bigl[(x^{2}-1)^{n}\\bigr]$.\n$2$. Determine the quadrature nodes, which are the roots of the equation $P_m(x)=0$.\n$3$. Determine the quadrature weights by constructing a system of linear equations that enforces the exactness of the quadrature rule for monomials $x^k$ for $k=0, 1, \\dots, 2m-1$. The exact integral of a monomial is $\\int_{-1}^{1} x^{k}\\,\\mathrm{d}x = \\frac{1-(-1)^{k+1}}{k+1}$, which is $\\frac{2}{k+1}$ for even $k$ and $0$ for odd $k$.\n\n**Part 1: Two-Point Gauss-Legendre Quadrature ($m=2$)**\n\nFirst, we find the Legendre polynomial $P_2(x)$. Using Rodrigues' formula for $n=2$:\n$$\nP_{2}(x) = \\frac{1}{2^{2} 2!} \\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}\\bigl[(x^{2}-1)^{2}\\bigr] = \\frac{1}{8} \\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}(x^{4} - 2x^{2} + 1)\n$$\nTaking the derivatives:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}(x^{4} - 2x^{2} + 1) = 4x^{3} - 4x\n$$\n$$\n\\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}(x^{4} - 2x^{2} + 1) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(4x^{3} - 4x) = 12x^{2} - 4\n$$\nSubstituting this back into the formula for $P_2(x)$:\n$$\nP_{2}(x) = \\frac{1}{8}(12x^{2} - 4) = \\frac{1}{2}(3x^{2} - 1)\n$$\nThe quadrature nodes $x_{1}^{(2)}, x_{2}^{(2)}$ are the roots of $P_2(x)=0$:\n$$\n\\frac{1}{2}(3x^{2} - 1) = 0 \\implies 3x^{2} = 1 \\implies x^{2} = \\frac{1}{3}\n$$\nThe nodes, in increasing order, are:\n$$\nx_{1}^{(2)} = -\\frac{1}{\\sqrt{3}} = -\\frac{\\sqrt{3}}{3} \\quad \\text{and} \\quad x_{2}^{(2)} = \\frac{1}{\\sqrt{3}} = \\frac{\\sqrt{3}}{3}\n$$\nNext, we find the weights $w_{1}^{(2)}, w_{2}^{(2)}$. The $2$-point rule is exact for all polynomials of degree up to $2m-1 = 2(2)-1 = 3$. We enforce this condition using a basis of monomials.\nFor $f(x)=x^0=1$:\n$$\n\\int_{-1}^{1} 1\\,\\mathrm{d}x = 2 \\quad \\Rightarrow \\quad w_{1}^{(2)}f(x_{1}^{(2)}) + w_{2}^{(2)}f(x_{2}^{(2)}) = w_{1}^{(2)}(1) + w_{2}^{(2)}(1) = w_{1}^{(2)} + w_{2}^{(2)} = 2\n$$\nFor $f(x)=x^1=x$:\n$$\n\\int_{-1}^{1} x\\,\\mathrm{d}x = 0 \\quad \\Rightarrow \\quad w_{1}^{(2)}x_{1}^{(2)} + w_{2}^{(2)}x_{2}^{(2)} = w_{1}^{(2)}\\left(-\\frac{\\sqrt{3}}{3}\\right) + w_{2}^{(2)}\\left(\\frac{\\sqrt{3}}{3}\\right) = 0\n$$\nFrom the second equation, we get $\\frac{\\sqrt{3}}{3}(-w_{1}^{(2)} + w_{2}^{(2)}) = 0$, which implies $w_{1}^{(2)} = w_{2}^{(2)}$. This is expected due to the symmetry of the nodes about $x=0$.\nSubstituting $w_{1}^{(2)} = w_{2}^{(2)}$ into the first equation:\n$$\nw_{1}^{(2)} + w_{1}^{(2)} = 2w_{1}^{(2)} = 2 \\implies w_{1}^{(2)} = 1\n$$\nThus, the weights are $w_{1}^{(2)} = 1$ and $w_{2}^{(2)} = 1$.\n\n**Part 2: Three-Point Gauss-Legendre Quadrature ($m=3$)**\n\nFirst, we find the Legendre polynomial $P_3(x)$. Using Rodrigues' formula for $n=3$:\n$$\nP_{3}(x) = \\frac{1}{2^{3} 3!} \\frac{\\mathrm{d}^{3}}{\\mathrm{d}x^{3}}\\bigl[(x^{2}-1)^{3}\\bigr] = \\frac{1}{48} \\frac{\\mathrm{d}^{3}}{\\mathrm{d}x^{3}}(x^{6} - 3x^{4} + 3x^{2} - 1)\n$$\nTaking the derivatives:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}(x^{6} - 3x^{4} + 3x^{2} - 1) = 6x^{5} - 12x^{3} + 6x\n$$\n$$\n\\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}(x^{6} - 3x^{4} + 3x^{2} - 1) = 30x^{4} - 36x^{2} + 6\n$$\n$$\n\\frac{\\mathrm{d}^{3}}{\\mathrm{d}x^{3}}(x^{6} - 3x^{4} + 3x^{2} - 1) = 120x^{3} - 72x\n$$\nSubstituting this back into the formula for $P_3(x)$:\n$$\nP_{3}(x) = \\frac{1}{48}(120x^{3} - 72x) = \\frac{24}{48}(5x^{3} - 3x) = \\frac{1}{2}(5x^{3} - 3x)\n$$\nThe quadrature nodes $x_{1}^{(3)}, x_{2}^{(3)}, x_{3}^{(3)}$ are the roots of $P_3(x)=0$:\n$$\n\\frac{1}{2}(5x^{3} - 3x) = 0 \\implies x(5x^{2} - 3) = 0\n$$\nThe roots are $x=0$ and $5x^2 = 3 \\implies x^2 = \\frac{3}{5}$. The nodes, in increasing order, are:\n$$\nx_{1}^{(3)} = -\\sqrt{\\frac{3}{5}} = -\\frac{\\sqrt{15}}{5}, \\quad x_{2}^{(3)} = 0, \\quad x_{3}^{(3)} = \\sqrt{\\frac{3}{5}} = \\frac{\\sqrt{15}}{5}\n$$\nNext, we find the weights $w_{1}^{(3)}, w_{2}^{(3)}, w_{3}^{(3)}$. The $3$-point rule is exact for all polynomials of degree up to $2m-1 = 2(3)-1 = 5$.\nFor $f(x)=x^0=1$:\n$$\n\\int_{-1}^{1} 1\\,\\mathrm{d}x = 2 \\quad \\Rightarrow \\quad w_{1}^{(3)} + w_{2}^{(3)} + w_{3}^{(3)} = 2\n$$\nFor $f(x)=x^1=x$:\n$$\n\\int_{-1}^{1} x\\,\\mathrm{d}x = 0 \\quad \\Rightarrow \\quad w_{1}^{(3)}\\left(-\\sqrt{\\frac{3}{5}}\\right) + w_{2}^{(3)}(0) + w_{3}^{(3)}\\left(\\sqrt{\\frac{3}{5}}\\right) = 0\n$$\nFrom the second equation, $\\sqrt{\\frac{3}{5}}(-w_{1}^{(3)} + w_{3}^{(3)}) = 0$, which implies $w_{1}^{(3)} = w_{3}^{(3)}$, as expected from symmetry.\nFor $f(x)=x^2$:\n$$\n\\int_{-1}^{1} x^{2}\\,\\mathrm{d}x = \\frac{2}{3} \\quad \\Rightarrow \\quad w_{1}^{(3)}\\left(-\\sqrt{\\frac{3}{5}}\\right)^{2} + w_{2}^{(3)}(0)^{2} + w_{3}^{(3)}\\left(\\sqrt{\\frac{3}{5}}\\right)^{2} = w_{1}^{(3)}\\left(\\frac{3}{5}\\right) + w_{3}^{(3)}\\left(\\frac{3}{5}\\right) = \\frac{2}{3}\n$$\nUsing $w_{1}^{(3)} = w_{3}^{(3)}$ in the third equation:\n$$\n2w_{1}^{(3)}\\left(\\frac{3}{5}\\right) = \\frac{2}{3} \\implies w_{1}^{(3)}\\left(\\frac{6}{5}\\right) = \\frac{2}{3} \\implies w_{1}^{(3)} = \\frac{2}{3} \\cdot \\frac{5}{6} = \\frac{10}{18} = \\frac{5}{9}\n$$\nSo, $w_{1}^{(3)} = w_{3}^{(3)} = \\frac{5}{9}$.\nFinally, using the first equation, $w_{1}^{(3)} + w_{2}^{(3)} + w_{3}^{(3)} = 2w_{1}^{(3)} + w_{2}^{(3)} = 2$:\n$$\n2\\left(\\frac{5}{9}\\right) + w_{2}^{(3)} = 2 \\implies \\frac{10}{9} + w_{2}^{(3)} = 2 \\implies w_{2}^{(3)} = 2 - \\frac{10}{9} = \\frac{18-10}{9} = \\frac{8}{9}\n$$\nThus, the weights are $w_{1}^{(3)} = \\frac{5}{9}$, $w_{2}^{(3)} = \\frac{8}{9}$, and $w_{3}^{(3)} = \\frac{5}{9}$.\n\nWe assemble the results into the required row matrix:\n$$\n(x_{1}^{(2)}, x_{2}^{(2)}, w_{1}^{(2)}, w_{2}^{(2)}, x_{1}^{(3)}, x_{2}^{(3)}, x_{3}^{(3)}, w_{1}^{(3)}, w_{2}^{(3)}, w_{3}^{(3)})\n$$\nSubstituting the derived values with rationalized denominators:\n$$\n\\left(-\\frac{\\sqrt{3}}{3}, \\frac{\\sqrt{3}}{3}, 1, 1, -\\frac{\\sqrt{15}}{5}, 0, \\frac{\\sqrt{15}}{5}, \\frac{5}{9}, \\frac{8}{9}, \\frac{5}{9}\\right)\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{\\sqrt{3}}{3} & \\frac{\\sqrt{3}}{3} & 1 & 1 & -\\frac{\\sqrt{15}}{5} & 0 & \\frac{\\sqrt{15}}{5} & \\frac{5}{9} & \\frac{8}{9} & \\frac{5}{9}\n\\end{pmatrix}\n}\n$$", "id": "2562003"}, {"introduction": "Moving from one dimension to two, we explore how Gauss quadrature is applied to quadrilateral elements in finite element analysis. This practice problem focuses on the integration of the consistent mass matrix and asks a critical question: is a standard $2\\times2$ quadrature rule always sufficient [@problem_id:2561927]? By analyzing the polynomial degree of the integrand, which includes the shape functions and the Jacobian determinant from the element's mapping, you will discover the conditions under which the integration is exact and when it introduces errors, a crucial consideration for distorted elements.", "problem": "Consider a bilinear quadrilateral finite element defined on the reference square $\\hat{K}=[-1,1]\\times[-1,1]$ with standard bilinear shape functions $N_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$, and $N_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$. The consistent mass matrix entry is\n$$\nM_{ij}=\\int_{\\hat{K}} N_{i}(\\xi,\\eta)\\,N_{j}(\\xi,\\eta)\\,J(\\xi,\\eta)\\,d\\xi\\,d\\eta,\n$$\nwhere $J(\\xi,\\eta)$ is the determinant of the Jacobian of the isoparametric mapping. The integral is to be evaluated by the tensor-product Gauss–Legendre quadrature with $2\\times 2$ points on $\\hat{K}$.\n\nStarting only from the basic property that the $2$-point Gauss–Legendre rule in one dimension is exact for univariate polynomials of degree at most $3$, analyze the polynomial degree structure of the integrand $N_{i}N_{j}J$ and determine whether the $2\\times 2$ rule is exact for all entries $M_{ij}$. State the necessary and sufficient condition on $J(\\xi,\\eta)$ for exactness and justify your conclusion by degree tracking.\n\nThen, as a concrete quantitative check of your conclusion, suppose that\n$$\nJ(\\xi,\\eta)=\\alpha+\\beta\\,\\xi+\\gamma\\,\\eta+\\delta\\,\\xi\\eta+\\varepsilon\\,\\xi^{2},\n$$\nwith $\\alpha,\\beta,\\gamma,\\delta,\\varepsilon\\in\\mathbb{R}$ and where $\\varepsilon$ is a small parameter representing a quadratic perturbation in the $\\xi$-direction. For the $(1,1)$ mass entry $M_{11}$, compute the quadrature error\n$$\nE(\\varepsilon)=\\iint_{\\hat{K}} N_{1}(\\xi,\\eta)^{2}\\,J(\\xi,\\eta)\\,d\\xi\\,d\\eta\\;-\\;\\sum_{i=1}^{2}\\sum_{j=1}^{2} w_{i}w_{j}\\,N_{1}(\\xi_{i},\\eta_{j})^{2}\\,J(\\xi_{i},\\eta_{j}),\n$$\nwhere $(\\xi_{i},w_{i})$ and $(\\eta_{j},w_{j})$ are the standard $2$-point Gauss–Legendre nodes and weights on $[-1,1]$ in each coordinate. Express your final answer as a closed-form analytic expression in terms of $\\varepsilon$ only. No rounding is required, and no physical units are involved. Provide only this final expression as your answer.", "solution": "We begin with the standard bilinear shape functions on the reference square $\\hat{K}=[-1,1]^{2}$. Each $N_{i}(\\xi,\\eta)$ is a product of linear factors in $\\xi$ and $\\eta$, hence is a bivariate polynomial that is of degree at most $1$ in $\\xi$ and at most $1$ in $\\eta$. Therefore, for any indices $i,j\\in\\{1,2,3,4\\}$, the product $N_{i}N_{j}$ is a bivariate polynomial that is of degree at most $2$ in $\\xi$ and at most $2$ in $\\eta$.\n\nThe $2$-point Gauss–Legendre rule on $[-1,1]$ is exact for univariate polynomials of degree at most $3$. The tensor-product $2\\times 2$ rule on $\\hat{K}$ results from applying the one-dimensional rule in each coordinate and is exact for any bivariate polynomial that is a finite linear combination of separable monomials $\\xi^{p}\\eta^{q}$ with $p\\leq 3$ and $q\\leq 3$. Thus, the $2\\times 2$ rule exactly integrates any integrand whose degree in each variable does not exceed $3$.\n\nThe mass-matrix integrand is $N_{i}N_{j}J$. If $J(\\xi,\\eta)$ is a polynomial that is at most degree $1$ in $\\xi$ and at most degree $1$ in $\\eta$ (that is, $J$ is bilinear: $J(\\xi,\\eta)=a_{0}+a_{1}\\xi+a_{2}\\eta+a_{3}\\xi\\eta$), then $N_{i}N_{j}J$ is at most degree $3$ in each variable, because multiplying a degree-$\\leq 2$ bivariate polynomial by a degree-$\\leq 1$ bivariate polynomial yields a degree-$\\leq 3$ bivariate polynomial in each variable separately. Hence, under the condition that $J$ is bilinear (which includes the special affine case where $J$ is constant), the $2\\times 2$ Gauss rule is exact for all entries $M_{ij}$.\n\nConversely, if $J$ contains any terms of degree $\\geq 2$ in either variable, then $N_{i}N_{j}J$ can contain monomials with degree $\\geq 4$ in that variable, and the $2\\times 2$ Gauss rule need not be exact. Therefore, a necessary and sufficient condition for exactness of the $2\\times 2$ rule for all entries $M_{ij}$ is that $J(\\xi,\\eta)$ be bilinear, i.e., of degree at most $1$ in each variable.\n\nWe now compute a quantitative error for a specific perturbation. Let\n$$\nJ(\\xi,\\eta)=\\alpha+\\beta\\,\\xi+\\gamma\\,\\eta+\\delta\\,\\xi\\eta+\\varepsilon\\,\\xi^{2}.\n$$\nFor the $(1,1)$ entry, the integrand is $N_{1}^{2}J$. The $2\\times 2$ rule is exact on the bilinear part $\\alpha+\\beta\\xi+\\gamma\\eta+\\delta\\xi\\eta$, so the quadrature error arises solely from the quadratic perturbation $\\varepsilon\\,\\xi^{2}$. Thus\n$$\nE(\\varepsilon)=\\varepsilon\\left(\\iint_{\\hat{K}} N_{1}(\\xi,\\eta)^{2}\\,\\xi^{2}\\,d\\xi\\,d\\eta\\;-\\;\\sum_{i=1}^{2}\\sum_{j=1}^{2} w_{i}w_{j}\\,N_{1}(\\xi_{i},\\eta_{j})^{2}\\,\\xi_{i}^{2}\\right).\n$$\nWe compute both the exact integral and the $2\\times 2$ quadrature of $f(\\xi,\\eta)=N_{1}(\\xi,\\eta)^{2}\\,\\xi^{2}$.\n\nFirst, write\n$$\nN_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)=\\frac{1}{4}\\left(1-\\xi-\\eta+\\xi\\eta\\right),\n$$\nso\n$$\nN_{1}(\\xi,\\eta)^{2}=\\frac{1}{16}\\left(1-\\xi-\\eta+\\xi\\eta\\right)^{2}.\n$$\nExpanding the square gives\n$$\n\\left(1-\\xi-\\eta+\\xi\\eta\\right)^{2}=1+\\xi^{2}+\\eta^{2}+\\xi^{2}\\eta^{2}-2\\xi-2\\eta+4\\xi\\eta-2\\xi^{2}\\eta-2\\xi\\eta^{2}.\n$$\nTherefore,\n$$\nf(\\xi,\\eta)=\\xi^{2}N_{1}(\\xi,\\eta)^{2}=\\frac{1}{16}\\Big(\\xi^{2}+\\xi^{4}+\\xi^{2}\\eta^{2}+\\xi^{4}\\eta^{2}-2\\xi^{3}-2\\xi^{2}\\eta+4\\xi^{3}\\eta-2\\xi^{4}\\eta-2\\xi^{3}\\eta^{2}\\Big).\n$$\n\nExact integral. Because $\\hat{K}$ is a product domain and the integrand is a sum of separable monomials, we use $\\int_{-1}^{1}\\xi^{n}\\,d\\xi=0$ for odd $n$ and $\\int_{-1}^{1}\\xi^{0}\\,d\\xi=2$, $\\int_{-1}^{1}\\xi^{2}\\,d\\xi=\\frac{2}{3}$, $\\int_{-1}^{1}\\xi^{4}\\,d\\xi=\\frac{2}{5}$. All monomials with an odd power in either variable integrate to zero. The surviving terms are\n$$\n\\iint_{\\hat{K}} f(\\xi,\\eta)\\,d\\xi\\,d\\eta=\\frac{1}{16}\\left(\\frac{4}{3}+\\frac{4}{5}+\\frac{4}{9}+\\frac{4}{15}\\right)=\\frac{1}{4}\\left(\\frac{1}{3}+\\frac{1}{5}+\\frac{1}{9}+\\frac{1}{15}\\right)=\\frac{8}{45}.\n$$\n\n$2\\times 2$ Gauss–Legendre quadrature. The one-dimensional $2$-point Gauss–Legendre rule on $[-1,1]$ has nodes $\\pm a$ with $a=\\frac{1}{\\sqrt{3}}$ and weights $1$. The tensor-product rule on $\\hat{K}$ uses the four nodes $(\\pm a,\\pm a)$ with weights $1$. Because $f$ factors as\n$$\nf(\\xi,\\eta)=\\frac{1}{16}\\big[\\xi^{2}(1-\\xi)^{2}\\big]\\big[(1-\\eta)^{2}\\big],\n$$\nthe quadrature sum factorizes:\n$$\n\\sum_{i=1}^{2}\\sum_{j=1}^{2} w_{i}w_{j}\\,f(\\xi_{i},\\eta_{j})=\\frac{1}{16}\\left(\\sum_{\\xi=\\pm a}\\xi^{2}(1-\\xi)^{2}\\right)\\left(\\sum_{\\eta=\\pm a}(1-\\eta)^{2}\\right).\n$$\nCompute\n$$\n\\sum_{\\xi=\\pm a}\\xi^{2}(1-\\xi)^{2}=a^{2}\\big[(1-a)^{2}+(1+a)^{2}\\big]=2a^{2}(1+a^{2}),\n$$\n$$\n\\sum_{\\eta=\\pm a}(1-\\eta)^{2}=(1-a)^{2}+(1+a)^{2}=2(1+a^{2}),\n$$\nso\n$$\n\\sum_{i,j} w_{i}w_{j}\\,f(\\xi_{i},\\eta_{j})=\\frac{1}{16}\\cdot 2a^{2}(1+a^{2})\\cdot 2(1+a^{2})=\\frac{1}{4}a^{2}(1+a^{2})^{2}.\n$$\nWith $a^{2}=\\frac{1}{3}$, we get\n$$\n\\sum_{i,j} w_{i}w_{j}\\,f(\\xi_{i},\\eta_{j})=\\frac{1}{4}\\cdot\\frac{1}{3}\\cdot\\left(1+\\frac{1}{3}\\right)^{2}=\\frac{1}{12}\\cdot\\frac{16}{9}=\\frac{4}{27}.\n$$\n\nTherefore, the quadrature error is\n$$\nE(\\varepsilon)=\\varepsilon\\left(\\frac{8}{45}-\\frac{4}{27}\\right)=\\varepsilon\\left(\\frac{24}{135}-\\frac{20}{135}\\right)=\\varepsilon\\cdot\\frac{4}{135}.\n$$\nThis expression depends only on $\\varepsilon$, as required. The sign is positive, indicating that the exact integral exceeds the $2\\times 2$ Gauss approximation for this perturbation.\n\nIn summary: the tensor-product $2\\times 2$ Gauss rule exactly integrates $M_{ij}$ if and only if $J(\\xi,\\eta)$ is bilinear (degree at most $1$ in each variable). For the specific perturbation $J(\\xi,\\eta)=\\alpha+\\beta\\xi+\\gamma\\eta+\\delta\\xi\\eta+\\varepsilon\\xi^{2}$, the quadrature error for $M_{11}$ is $E(\\varepsilon)=\\frac{4}{135}\\varepsilon$.", "answer": "$$\\boxed{\\frac{4}{135}\\,\\varepsilon}$$", "id": "2561927"}, {"introduction": "This exercise extends our application of Gauss quadrature to three dimensions, tackling the calculation of the element stiffness matrix for a linear tetrahedron [@problem_id:2561999]. Unlike the mass matrix, the stiffness matrix integrand involves gradients of the shape functions. You will investigate how the combination of linear shape functions and an affine geometric mapping leads to a constant integrand, revealing an elegant simplification where even a low-order quadrature rule yields the exact analytical result. This insight is fundamental to understanding the computational efficiency of linear finite elements.", "problem": "Consider the scalar diffusion model problem with unit diffusivity on a single three-dimensional linear tetrahedral finite element in the Finite Element Method (FEM). Let the physical element be the affine image of the standard right tetrahedron with vertices at $x_{1}=(0,0,0)$, $x_{2}=(1,0,0)$, $x_{3}=(0,1,0)$, and $x_{4}=(0,0,1)$. Denote the associated linear shape functions by $N_{1}$, $N_{2}$, $N_{3}$, and $N_{4}$. The element stiffness matrix is defined by\n$$\nK_{ij} \\;=\\; \\int_{T} \\nabla N_{i} \\cdot \\nabla N_{j}\\, dV,\\quad i,j\\in\\{1,2,3,4\\}.\n$$\nStarting only from the definitions of barycentric (affine) shape functions and the Gauss quadrature concept, do the following:\n1) Compute the element stiffness matrix by evaluating the integral with a tetrahedral Gauss quadrature rule that is exact for polynomials up to total degree $2$.\n2) Explain why, under an affine mapping of the reference tetrahedron, this degree-$2$ rule yields exactly the same matrix as exact analytical integration for linear tetrahedral elements.\n\nExpress your final answer as the $4\\times 4$ matrix $K$ in exact form (no rounding). Do not include physical units in your final answer. The final answer must be a single matrix expression.", "solution": "The problem asks for the computation of the element stiffness matrix $K$ for a linear tetrahedral element and an explanation for the exactness of a particular Gauss quadrature rule.\n\nThe stiffness matrix components are defined by the integral:\n$$\nK_{ij} \\;=\\; \\int_{T} \\nabla N_{i} \\cdot \\nabla N_{j}\\, dV\n$$\nwhere $T$ is the element domain, and $N_i$ are the linear shape functions. For the first part of the problem, the physical element $T$ is taken to be the standard right tetrahedron in a Cartesian coordinate system $(\\xi, \\eta, \\zeta)$, with vertices at $(0,0,0)$, $(1,0,0)$, $(0,1,0)$, and $(0,0,1)$. This domain is often referred to as the reference element.\n\nThe linear shape functions on this reference element, also known as barycentric coordinates, are:\n$N_1(\\xi, \\eta, \\zeta) = 1 - \\xi - \\eta - \\zeta$\n$N_2(\\xi, \\eta, \\zeta) = \\xi$\n$N_3(\\xi, \\eta, \\zeta) = \\eta$\n$N_4(\\xi, \\eta, \\zeta) = \\zeta$\n\nThe gradients of these shape functions with respect to the coordinates $(\\xi, \\eta, \\zeta)$ are computed. Let $\\nabla$ represent the gradient operator $(\\frac{\\partial}{\\partial \\xi}, \\frac{\\partial}{\\partial \\eta}, \\frac{\\partial}{\\partial \\zeta})^T$.\n$\\nabla N_1 = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix}$\n$\\nabla N_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n$\\nabla N_3 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$\n$\\nabla N_4 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$\n\nA critical observation is that the gradients of linear shape functions are constant vectors. Consequently, the integrand in the stiffness matrix definition, $f_{ij}(\\xi, \\eta, \\zeta) = \\nabla N_i \\cdot \\nabla N_j$, is a constant for each pair of indices $(i,j)$. This means the integrand is a polynomial of total degree $0$.\n\nThe integral for $K_{ij}$ is thus:\n$$\nK_{ij} = \\int_{T} (\\nabla N_i \\cdot \\nabla N_j) dV = (\\nabla N_i \\cdot \\nabla N_j) \\int_{T} dV\n$$\nThe volume $V$ of the standard right tetrahedron is given by $V = \\frac{1}{6} |(x_2-x_1) \\cdot ((x_3-x_1) \\times (x_4-x_1))|$. For the given vertices, this is $V = \\frac{1}{6}$.\nSo, $K_{ij} = \\frac{1}{6} (\\nabla N_i \\cdot \\nabla N_j)$.\n\nThe problem specifies using a Gauss quadrature rule exact for polynomials up to degree $2$. Since the integrand is a polynomial of degree $0$, any quadrature rule that is exact for constants (degree $0$ polynomials) will yield the exact value of the integral. A rule exact for degree $2$ polynomials is more than sufficient and will therefore be exact.\n\nWe now compute the components of the matrix $K$:\n$K_{11} = \\frac{1}{6} (\\nabla N_1 \\cdot \\nabla N_1) = \\frac{1}{6} ((-1)^2 + (-1)^2 + (-1)^2) = \\frac{3}{6} = \\frac{1}{2}$\n$K_{12} = \\frac{1}{6} (\\nabla N_1 \\cdot \\nabla N_2) = \\frac{1}{6} ((-1)(1) + (-1)(0) + (-1)(0)) = -\\frac{1}{6}$\n$K_{13} = \\frac{1}{6} (\\nabla N_1 \\cdot \\nabla N_3) = \\frac{1}{6} ((-1)(0) + (-1)(1) + (-1)(0)) = -\\frac{1}{6}$\n$K_{14} = \\frac{1}{6} (\\nabla N_1 \\cdot \\nabla N_4) = \\frac{1}{6} ((-1)(0) + (-1)(0) + (-1)(1)) = -\\frac{1}{6}$\n\n$K_{22} = \\frac{1}{6} (\\nabla N_2 \\cdot \\nabla N_2) = \\frac{1}{6} (1^2 + 0^2 + 0^2) = \\frac{1}{6}$\n$K_{23} = \\frac{1}{6} (\\nabla N_2 \\cdot \\nabla N_3) = \\frac{1}{6} (1 \\cdot 0 + 0 \\cdot 1 + 0 \\cdot 0) = 0$\n$K_{24} = \\frac{1}{6} (\\nabla N_2 \\cdot \\nabla N_4) = \\frac{1}{6} (1 \\cdot 0 + 0 \\cdot 0 + 0 \\cdot 1) = 0$\n\n$K_{33} = \\frac{1}{6} (\\nabla N_3 \\cdot \\nabla N_3) = \\frac{1}{6} (0^2 + 1^2 + 0^2) = \\frac{1}{6}$\n$K_{34} = \\frac{1}{6} (\\nabla N_3 \\cdot \\nabla N_4) = \\frac{1}{6} (0 \\cdot 0 + 1 \\cdot 0 + 0 \\cdot 1) = 0$\n\n$K_{44} = \\frac{1}{6} (\\nabla N_4 \\cdot \\nabla N_4) = \\frac{1}{6} (0^2 + 0^2 + 1^2) = \\frac{1}{6}$\n\nDue to the symmetry $K_{ij} = K_{ji}$, all components are determined. The resulting stiffness matrix is:\n$$\nK = \\frac{1}{6} \\begin{pmatrix} 3 & -1 & -1 & -1 \\\\ -1 & 1 & 0 & 0 \\\\ -1 & 0 & 1 & 0 \\\\ -1 & 0 & 0 & 1 \\end{pmatrix}\n$$\n\nFor the second part of the problem, we must explain why a degree-$2$ accurate quadrature rule provides the exact result for any affine mapping of the reference element.\nLet the reference element be $\\hat{T}$ in coordinates $\\boldsymbol{\\xi}$, and the physical element be $T$ in coordinates $\\mathbf{x}$. The mapping is affine, so $\\mathbf{x}(\\boldsymbol{\\xi}) = J \\boldsymbol{\\xi} + \\mathbf{b}$, where $J$ is the constant Jacobian matrix of the transformation.\nThe stiffness matrix on the physical element is $K_{ij} = \\int_{T} (\\nabla_{\\mathbf{x}} N_i) \\cdot (\\nabla_{\\mathbf{x}} N_j) dV_{\\mathbf{x}}$.\nWe transform this integral back to the reference element $\\hat{T}$. The chain rule for gradients gives $\\nabla_{\\boldsymbol{\\xi}} = J^T \\nabla_{\\mathbf{x}}$, so $\\nabla_{\\mathbf{x}} = (J^{-1})^T \\nabla_{\\boldsymbol{\\xi}}$. The volume element transforms as $dV_{\\mathbf{x}} = \\det(J) dV_{\\boldsymbol{\\xi}}$.\nSubstituting these into the integral gives:\n$$\nK_{ij} = \\int_{\\hat{T}} [ (J^{-1})^T \\nabla_{\\boldsymbol{\\xi}} N_i(\\boldsymbol{\\xi}) ] \\cdot [ (J^{-1})^T \\nabla_{\\boldsymbol{\\xi}} N_j(\\boldsymbol{\\xi}) ] \\det(J) dV_{\\boldsymbol{\\xi}}\n$$\nAs established, for linear elements, the gradients $\\nabla_{\\boldsymbol{\\xi}} N_i$ are constant vectors. Because the mapping is affine, the Jacobian matrix $J$ and its inverse $J^{-1}$ are constant matrices. Consequently, the entire expression within the integral:\n$$\n[ (J^{-1})^T \\nabla_{\\boldsymbol{\\xi}} N_i ] \\cdot [ (J^{-1})^T \\nabla_{\\boldsymbol{\\xi}} N_j ] \\det(J)\n$$\nis a product and dot product of constant vectors and matrices, resulting in a scalar value that is constant with respect to the integration variables $\\boldsymbol{\\xi}$.\nThe integrand is therefore a polynomial of degree $0$ (a constant). The task is to integrate a constant over the volume of the reference tetrahedron.\nAny numerical quadrature rule that can integrate a constant function exactly will provide the exact analytical result. All Gauss quadrature rules, by construction, can integrate constant functions exactly. A rule that is exact for polynomials up to degree $2$ is certainly exact for polynomials of degree $0$. Therefore, for linear tetrahedral elements, the stiffness matrix integrand is always a constant, and the specified degree-$2$ quadrature rule yields the exact analytical value of the integral, regardless of the affine mapping.", "answer": "$$\n\\boxed{\\frac{1}{6} \\begin{pmatrix} 3 & -1 & -1 & -1 \\\\ -1 & 1 & 0 & 0 \\\\ -1 & 0 & 1 & 0 \\\\ -1 & 0 & 0 & 1 \\end{pmatrix}}\n$$", "id": "2561999"}]}