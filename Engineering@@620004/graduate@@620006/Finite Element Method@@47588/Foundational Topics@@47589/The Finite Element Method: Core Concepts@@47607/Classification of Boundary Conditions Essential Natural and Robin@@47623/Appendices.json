{"hands_on_practices": [{"introduction": "Let's begin by exploring the profound implications of applying exclusively natural boundary conditions to a system. This practice [@problem_id:2544240] uses the classic Poisson equation to demonstrate how the weak formulation naturally gives rise to a critical solvability condition on the problem data. By carefully selecting a constant test function, you will uncover a fundamental principle of equilibrium, rooted in the divergence theorem, that must be satisfied for a solution to even exist.", "problem": "Consider the scalar elliptic boundary value problem (a partial differential equation) on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{2}$ with outward unit normal $\\boldsymbol{n}$:\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega, \n\\qquad \n\\boldsymbol{n}\\cdot \\nabla u = q \\quad \\text{on } \\partial\\Omega.\n$$\nWithin the framework of the Finite Element Method (FEM), proceed from fundamental principles of the weak formulation, namely integration by parts and the divergence theorem, to:\n(a) Derive the weak form on the Sobolev space $H^{1}(\\Omega)$ and clearly identify which boundary conditions are essential and which are natural in this setting. Explain why the given Neumann condition belongs to its classification.\n(b) By employing only the weak form and admissible test functions, derive a necessary compatibility condition on the data $f$ and $q$ for solvability. Present the condition as a single scalar functional of $(f,q)$ whose value must vanish for solvability.\n(c) Explain how this condition relates to existence and uniqueness, making precise in what sense the solution is unique.\n(d) Now take the specific data\n$$\n\\Omega = \\{(x,y)\\in\\mathbb{R}^{2}:\\; x^{2}+y^{2}<1\\}, \n\\qquad \nf(x,y) = x^{2}+y^{2}-1,\n\\qquad \nq|_{\\partial\\Omega}(\\theta) = \\cos\\theta,\n$$\nwhere $\\theta \\in [0,2\\pi)$ is the polar angle measured in radians and is used to parametrize $\\partial\\Omega$. Compute, in exact closed form, the scalar compatibility functional from part (b). Your final answer must be a single exact number with no units and no additional commentary.", "solution": "The problem posed is a standard boundary value problem for the Poisson equation with pure Neumann boundary conditions. We will proceed with its analysis step-by-step, adhering to rigorous mathematical principles.\n\nFirst, we validate the problem statement.\n**Step 1: Extracted Givens**\n- Partial Differential Equation (PDE): $-\\Delta u = f$ in a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{2}$.\n- Boundary Condition (BC): $\\boldsymbol{n}\\cdot \\nabla u = q$ on the boundary $\\partial\\Omega$, where $\\boldsymbol{n}$ is the outward unit normal.\n- Function Space: The solution $u$ and test functions are sought in the Sobolev space $H^{1}(\\Omega)$.\n- Part (a): Derive the weak form, classify boundary conditions as essential or natural, and justify the classification for the given Neumann condition.\n- Part (b): Derive a necessary compatibility condition for solvability on the data $(f,q)$.\n- Part (c): Explain the relation of this condition to existence and uniqueness of the solution.\n- Part (d): For the specific case where $\\Omega = \\{(x,y)\\in\\mathbb{R}^{2}:\\; x^{2}+y^{2}<1\\}$, $f(x,y) = x^{2}+y^{2}-1$, and $q|_{\\partial\\Omega}(\\theta) = \\cos\\theta$, compute the compatibility functional derived in part (b).\n\n**Step 2: Validation Using Extracted Givens**\nThe problem is scientifically grounded, well-posed for analysis (though the BVP itself has solvability issues which are the subject of the problem), and objective. It is a canonical problem in the theory of partial differential equations and their numerical solution via the Finite Element Method. All terms are defined, and the data provided is mathematically consistent and complete for the tasks required. The problem does not violate any of the invalidity criteria.\n\n**Verdict:** The problem is valid.\n\nWe now proceed to the solution.\n\n**(a) Weak Formulation and Classification of Boundary Conditions**\n\nTo derive the weak formulation, we start with the strong form of the PDE, $-\\Delta u = f$. We multiply this equation by an arbitrary test function $v$ from a suitable function space, which is specified as $H^{1}(\\Omega)$, and we integrate over the domain $\\Omega$:\n$$\n\\int_{\\Omega} (-\\Delta u) v \\, d\\boldsymbol{x} = \\int_{\\Omega} f v \\, d\\boldsymbol{x}\n$$\nThe core step is to apply integration by parts to the left-hand side. For multiple dimensions, this is achieved using the divergence theorem. Specifically, we use Green's first identity, which states:\n$$\n\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{F}) \\phi \\, d\\boldsymbol{x} = - \\int_{\\Omega} \\boldsymbol{F} \\cdot \\nabla \\phi \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} \\phi (\\boldsymbol{F} \\cdot \\boldsymbol{n}) \\, dS\n$$\nLetting $\\phi = v$ and $\\boldsymbol{F} = \\nabla u$, we have $\\nabla \\cdot \\boldsymbol{F} = \\Delta u$. Therefore, applying the identity to our integral gives:\n$$\n\\int_{\\Omega} (-\\Delta u) v \\, d\\boldsymbol{x} = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x} - \\int_{\\partial\\Omega} v (\\nabla u \\cdot \\boldsymbol{n}) \\, dS\n$$\nSubstituting this back into our integrated PDE yields the variational equation:\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x} - \\int_{\\partial\\Omega} v (\\boldsymbol{n} \\cdot \\nabla u) \\, dS = \\int_{\\Omega} f v \\, d\\boldsymbol{x}\n$$\nAt this point, we incorporate the boundary condition $\\boldsymbol{n}\\cdot \\nabla u = q$ on $\\partial\\Omega$. This condition is substituted into the boundary integral:\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x} - \\int_{\\partial\\Omega} q v \\, dS = \\int_{\\Omega} f v \\, d\\boldsymbol{x}\n$$\nRearranging terms, we arrive at the final weak formulation: Find $u \\in H^{1}(\\Omega)$ such that for all $v \\in H^{1}(\\Omega)$,\n$$\na(u,v) = L(v)\n$$\nwhere the bilinear form $a(u,v)$ and linear functional $L(v)$ are defined as:\n$$\na(u,v) = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x}\n\\qquad \\text{and} \\qquad\nL(v) = \\int_{\\Omega} f v \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q v \\, dS\n$$\nBoundary conditions in variational formulations are classified as follows:\n- **Essential Boundary Conditions**: These are conditions that must be explicitly satisfied by the functions in the trial (and often test) space. For example, a Dirichlet condition $u=g$ on $\\partial\\Omega_D \\subset \\partial\\Omega$ would require the solution to be sought in the affine subspace $\\{u \\in H^1(\\Omega) : u|_{\\partial\\Omega_D} = g \\}$. They are \"essential\" because they define the function space itself.\n- **Natural Boundary Conditions**: These are conditions that are satisfied \"weakly\" as a consequence of the variational equation holding for all test functions. They arise naturally from the integration-by-parts procedure and appear as boundary integrals in the weak form.\n\nIn this problem, the condition $\\boldsymbol{n} \\cdot \\nabla u = q$ is a **natural boundary condition**. This is because it is not imposed on the function space $H^1(\\Omega)$, but rather is incorporated into the definition of the linear functional $L(v)$. Its satisfaction is a consequence of the weak form being valid.\n\n**(b) Derivation of the Compatibility Condition**\n\nThe weak formulation must hold for all test functions $v \\in H^{1}(\\Omega)$. A characteristic of the space $H^{1}(\\Omega)$ for a bounded domain $\\Omega$ is that it contains constant functions. Let us choose a specific test function $v = c$, where $c$ is a non-zero real constant. For such a function, its gradient is identically zero: $\\nabla v = \\nabla c = \\boldsymbol{0}$.\n\nSubstituting $v=c$ into the weak form $a(u,v) = L(v)$:\nThe left-hand side becomes:\n$$\na(u,c) = \\int_{\\Omega} \\nabla u \\cdot \\nabla c \\, d\\boldsymbol{x} = \\int_{\\Omega} \\nabla u \\cdot \\boldsymbol{0} \\, d\\boldsymbol{x} = 0\n$$\nThe right-hand side becomes:\n$$\nL(c) = \\int_{\\Omega} f c \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q c \\, dS = c \\left( \\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS \\right)\n$$\nFor the equality $a(u,c)=L(c)$ to hold, we must have:\n$$\n0 = c \\left( \\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS \\right)\n$$\nSince this must hold for any non-zero constant $c$, it implies a necessary condition on the data $f$ and $q$:\n$$\n\\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS = 0\n$$\nThis is the compatibility condition for the existence of a solution. The scalar functional whose value must vanish is precisely this expression. From a physical perspective (e.g., steady-state heat transfer), this condition expresses global conservation: the total heat source inside the domain must be balanced by the total heat flux through the boundary.\n\n**(c) Relation to Existence and Uniqueness**\n\n- **Existence**: The compatibility condition $\\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS = 0$ is a necessary condition for a weak solution to exist. For this class of elliptic problems, the Fredholm alternative can be invoked, which shows that this condition is also sufficient for the existence of a solution $u \\in H^{1}(\\Omega)$.\n- **Uniqueness**: The solution is not unique. If $u$ is a solution to the weak form, then for any constant $C$, the function $u+C$ is also a solution. This is because $\\nabla(u+C) = \\nabla u$, so the bilinear form $a(u+C, v) = a(u,v)$ remains unchanged for all $v$. The linear functional $L(v)$ depends only on the data $(f,q)$ and is independent of $u$. Therefore, if $a(u,v) = L(v)$, then $a(u+C, v) = L(v)$ as well.\nTo demonstrate this formally, suppose $u_1$ and $u_2$ are two solutions. Their difference, $w = u_1 - u_2$, satisfies the homogeneous problem with $f=0$ and $q=0$. The weak form for $w$ is:\n$$\n\\int_{\\Omega} \\nabla w \\cdot \\nabla v \\, d\\boldsymbol{x} = 0 \\quad \\forall v \\in H^1(\\Omega)\n$$\nBy choosing the test function $v = w$, we get:\n$$\n\\int_{\\Omega} \\nabla w \\cdot \\nabla w \\, d\\boldsymbol{x} = \\int_{\\Omega} |\\nabla w|^2 \\, d\\boldsymbol{x} = 0\n$$\nSince the integrand $|\\nabla w|^2$ is non-negative, this equality implies that $\\nabla w = \\boldsymbol{0}$ almost everywhere in $\\Omega$. This means $w$ must be a constant function, $w=C$. Thus, any two solutions differ by a constant: $u_1 = u_2 + C$. The solution is unique up to an additive constant. To obtain a fully unique solution, an additional constraint is required, such as enforcing $\\int_{\\Omega} u \\, d\\boldsymbol{x} = 0$.\n\n**(d) Computation of the Compatibility Functional**\n\nWe must compute the value of the functional $F(f,q) = \\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS$ for the given data.\nThe domain is the unit disk, $\\Omega = \\{(x,y) : x^2+y^2 < 1\\}$. We use polar coordinates $(r,\\theta)$, where $x=r\\cos\\theta$ and $y=r\\sin\\theta$. The differential area element is $d\\boldsymbol{x} = r\\,dr\\,d\\theta$. The domain is described by $0 \\leq r < 1$ and $0 \\leq \\theta < 2\\pi$. The source term is $f(x,y) = x^2+y^2-1$, which in polar coordinates becomes $f(r,\\theta) = r^2-1$.\n\nThe first integral is over the domain $\\Omega$:\n$$\n\\int_{\\Omega} f \\, d\\boldsymbol{x} = \\int_{0}^{2\\pi} \\int_{0}^{1} (r^2 - 1) r \\, dr \\, d\\theta\n$$\nThe integrand is independent of $\\theta$, so we can separate the integrals:\n$$\n= \\left( \\int_{0}^{2\\pi} d\\theta \\right) \\left( \\int_{0}^{1} (r^3 - r) \\, dr \\right)\n$$\n$$\n= (2\\pi) \\left[ \\frac{r^4}{4} - \\frac{r^2}{2} \\right]_{0}^{1}\n$$\n$$\n= 2\\pi \\left( \\left(\\frac{1^4}{4} - \\frac{1^2}{2}\\right) - (0) \\right) = 2\\pi \\left( \\frac{1}{4} - \\frac{2}{4} \\right) = 2\\pi \\left( -\\frac{1}{4} \\right) = -\\frac{\\pi}{2}\n$$\nThe second integral is over the boundary $\\partial\\Omega$, which is the unit circle $r=1$. The differential arc length is $dS = (1) d\\theta = d\\theta$. The boundary flux is given as $q|_{\\partial\\Omega}(\\theta) = \\cos\\theta$.\n$$\n\\int_{\\partial\\Omega} q \\, dS = \\int_{0}^{2\\pi} \\cos\\theta \\, d\\theta\n$$\n$$\n= [\\sin\\theta]_{0}^{2\\pi} = \\sin(2\\pi) - \\sin(0) = 0 - 0 = 0\n$$\nFinally, we compute the value of the compatibility functional by summing the two results:\n$$\nF(f,q) = \\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS = -\\frac{\\pi}{2} + 0 = -\\frac{\\pi}{2}\n$$\nThe computed value is $-\\frac{\\pi}{2}$. Since this is non-zero, a solution to this specific boundary value problem does not exist. However, the question only asks for the computation of this value.", "answer": "$$\n\\boxed{-\\frac{\\pi}{2}}\n$$", "id": "2544240"}, {"introduction": "Essential boundary conditions constrain the solution space directly, but what are the physical consequences of such constraints? This exercise [@problem_id:2544278] guides you through the process of calculating the reaction force at a fixed support in an elastic bar. You will learn how to leverage the finite element solution and the weak form to recover this crucial engineering quantity, which represents the force required to enforce the prescribed displacement and is mathematically interpreted as a Lagrange multiplier.", "problem": "Consider a prismatic, linearly elastic bar of length $L$ aligned with the $x$-axis on the interval $[0,L]$, with constant Young’s modulus $E$ and cross-sectional area $A$. The axial displacement field is $u(x)$. The governing strong form in one dimension is the equilibrium equation $- (EA\\,u^{\\prime})^{\\prime} = q(x)$ subject to boundary conditions. In the finite element method (FEM), Dirichlet (essential) boundary conditions prescribe the primary field (here, displacement), Neumann (natural) boundary conditions prescribe tractions, and Robin boundary conditions prescribe an affine relation between the primary field and its flux. In this problem, the bar is subjected to:\n- an essential boundary condition $u(0) = \\bar{u} = 0$ on $\\Gamma_{D} = \\{0\\}$,\n- a constant natural traction $\\bar{t}$ applied at the right end $x = L$ on $\\Gamma_{N} = \\{L\\}$,\n- a constant distributed axial load $q(x) \\equiv q$ on $[0,L]$,\nwith no Robin boundary condition present.\n\nStarting from the principle of virtual work for small-strain linear elasticity, the weak form reads: find $u \\in H^{1}([0,L])$ with $u(0)=\\bar{u}$ such that\n$$\n\\int_{0}^{L} EA\\,u^{\\prime}(x)\\,v^{\\prime}(x)\\,dx \\;=\\; \\int_{0}^{L} q\\,v(x)\\,dx \\;+\\; \\bar{t}\\,v(L) \\quad \\text{for all } v \\in H^{1}([0,L]) \\text{ with } v(0)=0.\n$$\nDiscretize the bar with one linear finite element over $[0,L]$ having nodes at $x_{1}=0$ and $x_{2}=L$ and nodal basis functions $N_{1}(x)$ and $N_{2}(x)$ for the trial and test spaces. Enforce the essential boundary condition $u(0)=\\bar{u}=0$ strongly.\n\nUse the following material and loading data:\n- $E = 200 \\times 10^{9}\\,\\text{Pa}$,\n- $A = 1.0 \\times 10^{-4}\\,\\text{m}^{2}$,\n- $L = 2.0\\,\\text{m}$,\n- $q = 1.0 \\times 10^{3}\\,\\text{N/m}$,\n- $\\bar{t} = 3.0 \\times 10^{3}\\,\\text{N}$.\n\nTasks:\n1. Classify the boundary conditions at $x=0$ and $x=L$ as essential, natural, or Robin, and briefly state the physical quantity each prescribes.\n2. Assemble the one-element discrete system and solve for the unknown nodal displacement at $x=L$.\n3. Compute the reaction force at the essential boundary $\\Gamma_{D}$ by substituting the discrete finite element solution into the weak form while testing with a function that is supported on $\\Gamma_{D}$ (specifically, the nodal basis function $N_{1}$ that does not vanish at $x=0$). Interpret the resulting scalar as the discrete Lagrange multiplier associated with the essential constraint at $x=0$.\n\nExpress the final reaction force as a signed scalar in newtons (N). No rounding is required; provide the exact value implied by the given data.", "solution": "The problem statement is subjected to validation.\n\nGivens are extracted verbatim as follows:\n-   Domain: Prismatic, linearly elastic bar of length $L$ on the interval $[0,L]$.\n-   Constants: Constant Young’s modulus $E$ and cross-sectional area $A$.\n-   Field variable: Axial displacement $u(x)$.\n-   Strong form: $- (EA\\,u^{\\prime})^{\\prime} = q(x)$.\n-   Boundary Conditions:\n    -   Essential boundary condition: $u(0) = \\bar{u} = 0$ on $\\Gamma_{D} = \\{0\\}$.\n    -   Natural traction: $\\bar{t}$ at $x = L$ on $\\Gamma_{N} = \\{L\\}$.\n    -   Distributed load: $q(x) \\equiv q$ on $[0,L]$.\n-   Weak Form: Find $u \\in H^{1}([0,L])$ with $u(0)=\\bar{u}$ such that $\\int_{0}^{L} EA\\,u^{\\prime}(x)\\,v^{\\prime}(x)\\,dx = \\int_{0}^{L} q\\,v(x)\\,dx + \\bar{t}\\,v(L)$ for all $v \\in H^{1}([0,L])$ with $v(0)=0$.\n-   Discretization: One linear finite element on $[0,L]$ with nodes at $x_{1}=0$ and $x_{2}=L$. Nodal basis functions are $N_{1}(x)$ and $N_{2}(x)$. The essential boundary condition is enforced strongly.\n-   Data: $E = 200 \\times 10^{9}\\,\\text{Pa}$, $A = 1.0 \\times 10^{-4}\\,\\text{m}^{2}$, $L = 2.0\\,\\text{m}$, $q = 1.0 \\times 10^{3}\\,\\text{N/m}$, $\\bar{t} = 3.0 \\times 10^{3}\\,\\text{N}$.\n-   Tasks: 1. Classify boundary conditions. 2. Solve for nodal displacement at $x=L$. 3. Compute the reaction force at the essential boundary.\n\nValidation verdict: The problem is valid. It is a standard, well-posed problem in linear elastostatics, formulated correctly within the framework of the finite element method. The governing equations, weak form, and provided data are physically and mathematically consistent. All necessary information is provided.\n\nThe solution proceeds by addressing the three specified tasks.\n\nTask 1: Classification of Boundary Conditions\nThe boundary condition at $x=0$ is $u(0) = \\bar{u} = 0$. This condition directly prescribes the value of the primary field variable, the displacement $u$. By definition, this is an **essential** boundary condition. Physically, it represents a fixed support that prevents any displacement at that point.\nThe boundary condition at $x=L$ specifies a traction $\\bar{t}$. In the context of the weak form, the term $\\bar{t}v(L)$ originates from integration by parts of the strong form, where the resulting boundary term is $[(EA u')v]_0^L$. The natural boundary condition is therefore $EA u'(L) = \\bar{t}$. The quantity $EA u'$ represents the internal axial force in the bar. Thus, this condition prescribes the force on the boundary. By definition, this is a **natural** boundary condition.\n\nTask 2: Assembly and Solution of the Discrete System\nThe domain $[0,L]$ is discretized using a single linear finite element with nodes at $x_1=0$ and $x_2=L$. The displacement field $u(x)$ is approximated as $u^h(x) = d_1 N_1(x) + d_2 N_2(x)$, where $d_1$ and $d_2$ are the nodal displacements at $x_1$ and $x_2$, respectively.\nThe linear basis functions on the interval $[0,L]$ are:\n$$\nN_{1}(x) = 1 - \\frac{x}{L} \\quad \\text{and} \\quad N_{2}(x) = \\frac{x}{L}\n$$\nTheir derivatives are constant:\n$$\nN_{1}^{\\prime}(x) = -\\frac{1}{L} \\quad \\text{and} \\quad N_{2}^{\\prime}(x) = \\frac{1}{L}\n$$\nThe discrete system of equations is $\\mathbf{K}\\mathbf{d} = \\mathbf{f}$, where $\\mathbf{K}$ is the stiffness matrix and $\\mathbf{f}$ is the force vector.\n\nThe components of the stiffness matrix $K_{ij} = \\int_{0}^{L} E A N_{i}^{\\prime}(x) N_{j}^{\\prime}(x) dx$ are:\n$K_{11} = \\int_{0}^{L} E A (-\\frac{1}{L})(-\\frac{1}{L}) dx = \\frac{EA}{L}$\n$K_{12} = \\int_{0}^{L} E A (-\\frac{1}{L})(\\frac{1}{L}) dx = -\\frac{EA}{L}$\n$K_{21} = K_{12} = -\\frac{EA}{L}$\n$K_{22} = \\int_{0}^{L} E A (\\frac{1}{L})(\\frac{1}{L}) dx = \\frac{EA}{L}$\nThus, the stiffness matrix is:\n$$\n\\mathbf{K} = \\frac{EA}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nThe components of the force vector $f_i = \\int_{0}^{L} q N_{i}(x) dx + \\bar{t} N_i(L)$ are:\n$f_1 = \\int_{0}^{L} q (1-\\frac{x}{L}) dx + \\bar{t} N_1(L) = q \\left[x - \\frac{x^2}{2L}\\right]_{0}^{L} + \\bar{t}(0) = \\frac{qL}{2}$\n$f_2 = \\int_{0}^{L} q (\\frac{x}{L}) dx + \\bar{t} N_2(L) = q \\left[\\frac{x^2}{2L}\\right]_{0}^{L} + \\bar{t}(1) = \\frac{qL}{2} + \\bar{t}$\nThus, the force vector is:\n$$\n\\mathbf{f} = \\begin{pmatrix} \\frac{qL}{2} \\\\ \\frac{qL}{2} + \\bar{t} \\end{pmatrix}\n$$\nThe full discrete system is:\n$$\n\\frac{EA}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{qL}{2} \\\\ \\frac{qL}{2} + \\bar{t} \\end{pmatrix}\n$$\nThe essential boundary condition $u(0)=0$ is enforced strongly, which sets the nodal displacement $d_1 = 0$. The unknown displacement $d_2$ is found from the second equation of the system:\n$$\n\\frac{EA}{L} (-d_1 + d_2) = \\frac{qL}{2} + \\bar{t}\n$$\nSubstituting $d_1=0$:\n$$\n\\frac{EA}{L} d_2 = \\frac{qL}{2} + \\bar{t}\n$$\nSolving for $d_2$:\n$$\nd_2 = \\frac{L}{EA} \\left( \\frac{qL}{2} + \\bar{t} \\right)\n$$\nUsing the provided data: $E = 200 \\times 10^{9}\\,\\text{Pa}$, $A = 1.0 \\times 10^{-4}\\,\\text{m}^{2}$, $L = 2.0\\,\\text{m}$, $q = 1.0 \\times 10^{3}\\,\\text{N/m}$, $\\bar{t} = 3.0 \\times 10^{3}\\,\\text{N}$.\nThe axial rigidity is $EA = (200 \\times 10^{9}) \\times (1.0 \\times 10^{-4}) = 2.0 \\times 10^{7}\\,\\text{N}$.\nThe distributed load resultant component at node 2 is $\\frac{qL}{2} = \\frac{(1.0 \\times 10^{3})(2.0)}{2} = 1.0 \\times 10^{3}\\,\\text{N}$.\nThe displacement at $x=L$ is:\n$$\nd_2 = \\frac{2.0}{2.0 \\times 10^{7}} \\left( 1.0 \\times 10^{3} + 3.0 \\times 10^{3} \\right) = 1.0 \\times 10^{-7} (4.0 \\times 10^{3}) = 4.0 \\times 10^{-4}\\,\\text{m}\n$$\n\nTask 3: Computation of the Reaction Force\nThe reaction force $R$ at the essential boundary $x=0$ is computed by substituting the finite element solution $u^h(x)$ into the weak form and using a test function $v(x)$ that does not vanish at $x=0$. The problem specifies using the basis function $v(x) = N_1(x)$.\nThe full statement of virtual work, including the work done by the reaction force $R$ at $x=0$, is:\n$$\n\\int_{0}^{L} EA\\,u^{\\prime}(x)\\,v^{\\prime}(x)\\,dx = \\int_{0}^{L} q\\,v(x)\\,dx + \\bar{t}\\,v(L) + R\\,v(0)\n$$\nWe substitute $u(x) = u^h(x) = d_2 N_2(x)$ (since $d_1=0$) and $v(x) = N_1(x)$ into this equation. For this test function, $v(0)=N_1(0)=1$ and $v(L)=N_1(L)=0$. The equation becomes:\n$$\n\\int_{0}^{L} EA\\, (d_2 N_2'(x)) \\, N_1'(x)\\, dx = \\int_{0}^{L} q\\, N_1(x)\\, dx + \\bar{t}\\,(0) + R\\,(1)\n$$\nThis simplifies to:\n$$\nd_2 \\int_{0}^{L} EA\\, N_2'(x) N_1'(x)\\, dx = \\int_{0}^{L} q\\, N_1(x)\\, dx + R\n$$\nThe terms are recognized from the assembled system:\nThe integral on the left is $d_2 K_{12} = d_2 (-\\frac{EA}{L})$.\nThe integral on the right is the first component of the force vector, $f_1 = \\frac{qL}{2}$.\nSo we have:\n$$\n-d_2 \\frac{EA}{L} = \\frac{qL}{2} + R\n$$\nSolving for the reaction force $R$:\n$$\nR = -d_2 \\frac{EA}{L} - \\frac{qL}{2}\n$$\nSubstitute the expression for $d_2 = \\frac{L}{EA}(\\frac{qL}{2} + \\bar{t})$:\n$$\nR = -\\left(\\frac{L}{EA} \\left( \\frac{qL}{2} + \\bar{t} \\right)\\right) \\frac{EA}{L} - \\frac{qL}{2} = - \\left( \\frac{qL}{2} + \\bar{t} \\right) - \\frac{qL}{2} = -qL - \\bar{t}\n$$\nThis result is consistent with static equilibrium: the reaction force must balance the total applied external force, which is the sum of the integrated distributed load $qL$ and the point load $\\bar{t}$.\nNow, we compute the numerical value:\n$$\nqL = (1.0 \\times 10^{3}\\,\\text{N/m}) \\times (2.0\\,\\text{m}) = 2.0 \\times 10^{3}\\,\\text{N}\n$$\n$$\n\\bar{t} = 3.0 \\times 10^{3}\\,\\text{N}\n$$\nThe reaction force is:\n$$\nR = -(2.0 \\times 10^{3}\\,\\text{N}) - (3.0 \\times 10^{3}\\,\\text{N}) = -5.0 \\times 10^{3}\\,\\text{N}\n$$\nThe negative sign indicates that the reaction force exerted by the support on the bar acts in the negative $x$-direction, which is physically correct as it opposes the applied loads.", "answer": "$$\n\\boxed{-5.0 \\times 10^{3}}\n$$", "id": "2544278"}, {"introduction": "The distinction between essential and natural conditions becomes even more critical when dealing with higher-order differential equations, which are common in structural mechanics. In this advanced practice [@problem_id:2544282], you will derive the weak form for the fourth-order Euler-Bernoulli beam equation. This process, involving two successive integrations by parts, reveals how different physical supports, such as clamped or simply supported ends, correspond to unique combinations of essential and natural boundary conditions involving displacements, slopes, moments, and shear forces.", "problem": "Consider the Euler–Bernoulli beam model on the interval $(0,L)$ with flexural rigidity $EI>0$ and transverse deflection $u:(0,L)\\to\\mathbb{R}$ governed by the strong form\n$$\nEI\\,u^{(4)}(x)=f(x)\\quad\\text{for }x\\in(0,L),\n$$\nwhere $f\\in L^{2}(0,L)$. Let $H^{2}(0,L)$ denote the Sobolev space of functions whose second weak derivative is square-integrable. Work in a setting where test functions $v$ are taken from the same energy space as trial functions $u$, consistent with coercivity of the bending energy.\n\n1) Starting from the strong form and using only integration by parts and the definition of the Sobolev space $H^{2}(0,L)$, derive a weak form whose bilinear part is well-defined and coercive on $H^{2}(0,L)$. Make explicit the boundary term that pairs traces of $v$ and $v'$ with boundary functionals of $u$.\n\n2) Using the weak form from part 1), classify at a single boundary point (e.g., $x=0$) the following mechanical boundary sets into essential (Dirichlet-type) and natural (Neumann-type) boundary conditions in the finite element sense:\n- Clamped end: prescribed deflection and rotation, i.e., $u(0)=0$ and $u'(0)=0$.\n- Simply supported end: prescribed deflection and zero bending moment, i.e., $u(0)=0$ and $EI\\,u''(0)=0$ (interpreted in the weak sense).\n\nYour classification must be based solely on which conditions are imposed on the trial space (hence on the test space) versus which conditions arise as boundary terms in the weak form.\n\nReport your final result as the row matrix\n$$\n\\begin{pmatrix}\ne_{\\mathrm{clamped}} & n_{\\mathrm{clamped}} & e_{\\mathrm{supported}} & n_{\\mathrm{supported}}\n\\end{pmatrix},\n$$\nwhere $e_{\\mathrm{(\\cdot)}}$ is the number of essential conditions at the boundary and $n_{\\mathrm{(\\cdot)}}$ is the number of natural conditions at the boundary. No rounding is necessary. The answer must be given exactly, with no units.", "solution": "The posed problem is scientifically grounded, well-posed, objective, and complete. It represents a standard exercise in the variational formulation of boundary value problems, specifically within the context of the finite element method applied to elasticity. The problem is valid, and I will proceed with its solution.\n\nThe analysis begins with the strong form of the Euler-Bernoulli beam equation on the domain $\\Omega = (0, L)$:\n$$\nEI\\,u^{(4)}(x) = f(x)\n$$\nwhere $u$ is the transverse deflection, $EI$ is the constant flexural rigidity, and $f$ is the distributed transverse load. The trial function $u$ and the test function $v$ are both chosen from the Sobolev space $H^{2}(0,L)$.\n\nTo derive the weak formulation, we multiply the strong form by an arbitrary test function $v \\in H^{2}(0,L)$ and integrate over the domain $\\Omega$:\n$$\n\\int_{0}^{L} EI\\,u^{(4)}(x) v(x) \\,dx = \\int_{0}^{L} f(x) v(x) \\,dx\n$$\nThe primary task is to reduce the order of differentiation on the trial function $u$ by applying integration by parts to the left-hand side. We aim for a symmetric bilinear form where both $u$ and $v$ appear with the same order of differentiation. Since the functions belong to $H^{2}(0,L)$, the highest derivative guaranteed to be square-integrable is the second derivative. Therefore, we integrate by parts twice.\n\nFirst, let's apply integration by parts to $\\int_{0}^{L} EI\\,u^{(4)}(x) v(x) \\,dx$:\n$$\n\\int_{0}^{L} EI\\,u^{(4)}(x) v(x) \\,dx = \\left[ EI\\,u^{(3)}(x) v(x) \\right]_{0}^{L} - \\int_{0}^{L} EI\\,u^{(3)}(x) v'(x) \\,dx\n$$\nHere, $u^{(3)}$ is related to the shear force $V$, and $u^{(4)}$ is the distributed load. The boundary term involves the product of the shear force and the test function's value at the boundary.\n\nNext, we apply integration by parts to the remaining integral term, $-\\int_{0}^{L} EI\\,u^{(3)}(x) v'(x) \\,dx$:\n$$\n- \\int_{0}^{L} EI\\,u^{(3)}(x) v'(x) \\,dx = - \\left[ EI\\,u''(x) v'(x) \\right]_{0}^{L} + \\int_{0}^{L} EI\\,u''(x) v''(x) \\,dx\n$$\nHere, $u''$ is related to the bending moment $M = EIu''$. The new boundary term involves the product of the bending moment and the test function's derivative at the boundary.\n\nCombining these results, the original left-hand side becomes:\n$$\n\\int_{0}^{L} EI\\,u^{(4)}(x) v(x) \\,dx = \\int_{0}^{L} EI\\,u''(x) v''(x) \\,dx + \\left[ EI\\,u^{(3)}(x) v(x) - EI\\,u''(x) v'(x) \\right]_{0}^{L}\n$$\nSubstituting this back into the integrated equation gives the complete weak statement:\n$$\n\\int_{0}^{L} EI\\,u''(x) v''(x) \\,dx + \\left[ EI\\,u^{(3)}(x) v(x) - EI\\,u''(x) v'(x) \\right]_{x=L} - \\left[ EI\\,u^{(3)}(x) v(x) - EI\\,u''(x) v'(x) \\right]_{x=0} = \\int_{0}^{L} f(x) v(x) \\,dx\n$$\nThe standard weak form is written as $a(u,v) = l(v)$, where $a(u,v)$ is a bilinear form and $l(v)$ is a linear functional. From the equation above, the bilinear form is:\n$$\na(u,v) = \\int_{0}^{L} EI\\,u''(x) v''(x) \\,dx\n$$\nThis form is well-defined and coercive on $H^{2}(0,L)$ (or a suitable subspace thereof). The boundary terms are $[EIu^{(3)}v - EIu''v']_{0}^{L}$. These terms are critical for classifying boundary conditions.\n\nA boundary condition is classified as **essential** (or a Dirichlet-type condition) if it is a constraint on the solution space itself, meaning it must be explicitly enforced on the trial functions $u$. In a Galerkin method where test and trial spaces are the same, the homogeneous version of the condition must also hold for the test functions $v$. For the Euler-Bernoulli beam, these are conditions on the deflection $u$ and the slope $u'$.\n\nA boundary condition is classified as **natural** (or a Neumann-type condition) if it emerges from the variational formulation. Specifically, if a test function's trace ($v$ or $v'$) is not constrained to zero at the boundary, then for the weak form to hold for all such test functions, the corresponding coefficient in the boundary term must be zero. For the beam, these conditions involve the bending moment $M = EIu''$ and the shear force $V = EIu'''$.\n\nLet us analyze the boundary conditions at a single point, $x=0$. The boundary contribution at $x=0$ to the weak form is $EIu''(0)v'(0) - EIu^{(3)}(0)v(0)$.\n\n1) **Clamped end at $x=0$**: The conditions are $u(0)=0$ and $u'(0)=0$.\n- These conditions are constraints on the deflection $u$ and its first derivative $u'$. They are imposed directly on the function space for the trial solution $u$.\n- Consequently, the test functions $v$ must also satisfy the homogeneous conditions $v(0)=0$ and $v'(0)=0$.\n- When these constraints are applied to the test function $v$, the boundary term at $x=0$, which is $EIu''(0)v'(0) - EIu^{(3)}(0)v(0)$, vanishes automatically because both $v(0)$ and $v'(0)$ are zero.\n- Both conditions are imposed on the function space and are therefore **essential**.\n- Number of essential conditions, $e_{\\mathrm{clamped}} = 2$.\n- Number of natural conditions, $n_{\\mathrm{clamped}} = 0$.\n\n2) **Simply supported end at $x=0$**: The conditions are $u(0)=0$ and $EIu''(0)=0$.\n- The condition $u(0)=0$ is a constraint on the deflection. It is imposed on the trial space, so $u(0)=0$. The corresponding test function must also satisfy $v(0)=0$. This is an **essential** boundary condition.\n- Because $v(0)=0$, the part of the boundary term involving $v(0)$, which is $-EIu^{(3)}(0)v(0)$, vanishes.\n- The remaining part of the boundary term at $x=0$ is $EIu''(0)v'(0)$. The test function $v$ is not constrained in its derivative at $x=0$, meaning $v'(0)$ can take any arbitrary value.\n- For the weak form to be valid for all admissible test functions $v$, the coefficient of the non-zero $v'(0)$ must be zero. This implies that the solution $u$ must satisfy $EIu''(0)=0$.\n- This condition, $EIu''(0)=0$, is not imposed on the trial space but is a consequence of the weak formulation. It is therefore a **natural** boundary condition.\n- Number of essential conditions, $e_{\\mathrm{supported}} = 1$.\n- Number of natural conditions, $n_{\\mathrm{supported}} = 1$.\n\nCombining these results into the required matrix format $\\begin{pmatrix} e_{\\mathrm{clamped}} & n_{\\mathrm{clamped}} & e_{\\mathrm{supported}} & n_{\\mathrm{supported}} \\end{pmatrix}$:\n$$\n\\begin{pmatrix} 2 & 0 & 1 & 1 \\end{pmatrix}\n$$\nThis completes the classification based on the derivation from first principles.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2 & 0 & 1 & 1\n\\end{pmatrix}\n}\n$$", "id": "2544282"}]}