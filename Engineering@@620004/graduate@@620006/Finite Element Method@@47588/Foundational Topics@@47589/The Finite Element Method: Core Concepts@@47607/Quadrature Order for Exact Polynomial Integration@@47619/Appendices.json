{"hands_on_practices": [{"introduction": "The remarkable efficiency of Gaussian quadrature stems from a precise selection of nodes and weights to achieve the highest possible degree of polynomial exactness. This exercise demystifies this process by guiding you through the derivation of the classic two-point Gauss-Legendre rule from first principles. By setting up and solving the system of moment-matching equations, you will gain a foundational understanding of how these \"magic\" numbers are determined to ensure maximal accuracy. [@problem_id:2591926]", "problem": "In the finite element method, integrals on the reference interval are often evaluated by Gaussian quadrature. Consider the reference interval $[-1,1]$ with unit weight function $w(x)=1$. Seek a quadrature rule with $n=2$ nodes of the form\n$$\n\\int_{-1}^{1} f(x)\\,dx \\approx w_1 f(x_1) + w_2 f(x_2),\n$$\nwhere $x_1,x_2 \\in (-1,1)$ and $w_1,w_2 > 0$. Using only the requirement that this quadrature be exact for all polynomials $f(x)$ of degree at most $3$, construct the system of moment-matching equations associated with $f(x)=x^k$ for $k \\in \\{0,1,2,3\\}$ and solve it to determine $x_1,x_2,w_1,w_2$. Your derivation must not invoke special function tables or properties beyond the defining requirement of exactness on monomials and basic calculus on polynomial integrals.\n\nThen verify your result by directly substituting $f(x)=x^k$ for $k \\in \\{0,1,2,3\\}$ and confirming equality between the exact integral and the quadrature sum in each case.\n\nProvide your final answer as a single row matrix $\\big(x_1,\\;x_2,\\;w_1,\\;w_2\\big)$ with the ordering constraint $x_1  0  x_2$. No rounding is required, and no units are involved.", "solution": "The goal is to construct a quadrature rule on $[-1,1]$ with $n=2$ nodes that is exact for all polynomials of degree at most $3$. By definition, exactness for degree at most $3$ means that for $f(x)=x^k$ with $k \\in \\{0,1,2,3\\}$,\n$$\n\\int_{-1}^{1} x^k\\,dx \\;=\\; w_1 x_1^k + w_2 x_2^k.\n$$\nWe use only the integrals of monomials and set up the corresponding equations. The needed exact integrals are computed by elementary calculus:\n- For $k=0$, $\\displaystyle \\int_{-1}^{1} x^0\\,dx = \\int_{-1}^{1} 1\\,dx = 2$.\n- For $k=1$, $\\displaystyle \\int_{-1}^{1} x\\,dx = 0$ by symmetry.\n- For $k=2$, $\\displaystyle \\int_{-1}^{1} x^2\\,dx = \\left[\\frac{x^3}{3}\\right]_{-1}^{1} = \\frac{1}{3}-\\left(-\\frac{1}{3}\\right)=\\frac{2}{3}$.\n- For $k=3$, $\\displaystyle \\int_{-1}^{1} x^3\\,dx = 0$ by symmetry.\n\nThus the moment-matching system is\n\n$$\n\\begin{aligned}\nk=0:\\quad  w_1 + w_2 = 2, \\\\\nk=1:\\quad  w_1 x_1 + w_2 x_2 = 0, \\\\\nk=2:\\quad  w_1 x_1^2 + w_2 x_2^2 = \\frac{2}{3}, \\\\\nk=3:\\quad  w_1 x_1^3 + w_2 x_2^3 = 0.\n\\end{aligned}\n$$\n\n\nWe now exploit only these equations to determine the parameters. Consider the two equations for the odd moments:\n\n$$\nw_1 x_1 + w_2 x_2 = 0,\\qquad w_1 x_1^3 + w_2 x_2^3 = 0.\n$$\n\nIntroduce the variables $y_1 := w_1 x_1$ and $y_2 := w_2 x_2$. The system becomes\n\n$$\n\\begin{pmatrix}\n1  1 \\\\\nx_1^2  x_2^2\n\\end{pmatrix}\n\\begin{pmatrix}\ny_1 \\\\ y_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\ 0\n\\end{pmatrix}.\n$$\n\nFor a nontrivial solution $(y_1,y_2)$ to exist (which is necessary unless $x_1=x_2=0$, which is not allowed because distinct nodes are required for a two-point rule of nonzero degree of exactness), the determinant must vanish:\n\n$$\nx_2^2 - x_1^2 = 0 \\quad \\Rightarrow \\quad x_2^2 = x_1^2.\n$$\n\nHence $|x_1|=|x_2|$. Since the nodes must be distinct and in $(-1,1)$, we conclude\n\n$$\nx_2 = -x_1.\n$$\n\nReturning to $y_1 + y_2 = 0$ and substituting $x_2=-x_1$ yields\n\n$$\nw_1 x_1 + w_2 (-x_1) = 0 \\;\\Rightarrow\\; (w_1 - w_2) x_1 = 0.\n$$\n\nBecause $x_1 \\neq 0$, it follows that\n\n$$\nw_1 = w_2.\n$$\n\nDenote the common weight by $w$ and the positive node by $a > 0$, so that $x_1=-a$, $x_2=+a$, and $w_1=w_2=w$. The remaining two equations become\n\n$$\nw + w = 2 \\;\\Rightarrow\\; 2w = 2 \\;\\Rightarrow\\; w = 1,\n$$\n\nand\n\n$$\nw x_1^2 + w x_2^2 = \\frac{2}{3} \\;\\Rightarrow\\; 1\\cdot a^2 + 1\\cdot a^2 = \\frac{2}{3} \\;\\Rightarrow\\; 2a^2 = \\frac{2}{3} \\;\\Rightarrow\\; a^2 = \\frac{1}{3}.\n$$\n\nTaking $a > 0$ gives $a = \\frac{1}{\\sqrt{3}}$. Enforcing the ordering constraint $x_1  0  x_2$ yields\n\n$$\nx_1 = -\\frac{1}{\\sqrt{3}},\\quad x_2 = \\frac{1}{\\sqrt{3}},\\quad w_1 = 1,\\quad w_2 = 1.\n$$\n\n\nVerification for $k \\in \\{0,1,2,3\\}$:\n- $k=0$: $w_1+w_2 = 1+1 = 2 = \\int_{-1}^{1} 1\\,dx$.\n- $k=1$: $w_1 x_1 + w_2 x_2 = 1\\cdot\\left(-\\frac{1}{\\sqrt{3}}\\right) + 1\\cdot\\left(\\frac{1}{\\sqrt{3}}\\right) = 0 = \\int_{-1}^{1} x\\,dx$.\n- $k=2$: $w_1 x_1^2 + w_2 x_2^2 = 1\\cdot\\frac{1}{3} + 1\\cdot\\frac{1}{3} = \\frac{2}{3} = \\int_{-1}^{1} x^2\\,dx$.\n- $k=3$: $w_1 x_1^3 + w_2 x_2^3 = 1\\cdot\\left(-\\frac{1}{3\\sqrt{3}}\\right) + 1\\cdot\\left(\\frac{1}{3\\sqrt{3}}\\right) = 0 = \\int_{-1}^{1} x^3\\,dx$.\n\nTherefore, the constructed $n=2$ Gauss–Legendre rule on $[-1,1]$ has nodes and weights\n\n$$\nx_1 = -\\frac{1}{\\sqrt{3}},\\quad x_2 = \\frac{1}{\\sqrt{3}},\\quad w_1 = 1,\\quad w_2 = 1,\n$$\n\nwhich satisfy exactness for all polynomials up to degree $3$ as required.", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}}  1  1\\end{pmatrix}}$$", "id": "2591926"}, {"introduction": "While Gauss-Legendre quadrature is optimal for a given number of points, practical FEM applications often require rules with nodes fixed at element boundaries, such as Gauss-Radau and Gauss-Lobatto. This constraint, however, comes at the cost of a reduced degree of exactness. This practice provides a sharp, analytical demonstration of this trade-off by challenging you to use a specially constructed polynomial $q_n(x)$ to prove that an $n$-point Gauss-Radau rule succeeds where an $n$-point Gauss-Lobatto rule fails, illuminating the precise theoretical limits of these methods. [@problem_id:2591954]", "problem": "Consider numerical quadrature on the interval $[-1,1]$ with unit weight for integrands arising in the Finite Element Method (FEM). Let $P_{k}(x)$ denote the Legendre polynomial of degree $k$, normalized so that $P_{k}(1)=1$. Define the polynomial\n$$\nq_{n}(x) \\;=\\; \\bigl(1-x^{2}\\bigr)\\,\\bigl(P_{n-1}'(x)\\bigr)^{2},\n$$\nwhich has degree $2n-2$ for any integer $n \\ge 2$.\n\nYou will compare the $n$-point Gauss–Radau quadrature (including the endpoint $x=1$) and the $n$-point Gauss–Lobatto quadrature (including both endpoints $x = \\pm 1$) on this integrand.\n\nTasks:\n- Establish, from first principles based on degree-of-exactness and parameter-counting using moment conditions, the maximal algebraic degree of exactness achievable by an $n$-point quadrature on $[-1,1]$ when (i) no endpoints are preassigned, (ii) exactly one endpoint is preassigned, and (iii) both endpoints are preassigned. Explain why the Gauss–Radau and Gauss–Lobatto constructions attain the respective maxima.\n- Prove that $q_{n}(x)$ vanishes at all Gauss–Lobatto nodes for the $n$-point rule, and conclude what numerical value the Gauss–Lobatto rule returns on $\\int_{-1}^{1} q_{n}(x)\\,dx$.\n- Use properties of Legendre polynomials to evaluate the exact integral $\\int_{-1}^{1} q_{n}(x)\\,dx$ in closed form as a function of $n$.\n- Explain why the $n$-point Gauss–Radau rule returns the exact value for $\\int_{-1}^{1} q_{n}(x)\\,dx$ while the $n$-point Gauss–Lobatto rule does not.\n\nYour final answer must be a single closed-form expression in $n$ for the exact value of $\\int_{-1}^{1} q_{n}(x)\\,dx$. No rounding is required.", "solution": "The tasks given require a systematic analysis of Gaussian quadrature rules. We will address each point in sequence.\n\nFirst, we establish the maximal degree of exactness for an $n$-point quadrature rule on the interval $[-1,1]$ with a unit weight function, $w(x)=1$. An $n$-point quadrature rule is of the form:\n$$\n\\int_{-1}^{1} f(x) \\,dx \\approx \\sum_{i=1}^{n} w_i f(x_i)\n$$\nwhere $\\{x_i\\}_{i=1}^{n}$ are the nodes and $\\{w_i\\}_{i=1}^{n}$ are the weights. The rule is said to have a degree of exactness $d$ if it is exact for all polynomials of degree less than or equal to $d$, but not for some polynomial of degree $d+1$. To be exact for all polynomials up to degree $d$, the rule must satisfy the $d+1$ moment equations:\n$$\n\\int_{-1}^{1} x^k \\,dx = \\sum_{i=1}^{n} w_i x_i^k, \\quad \\text{for } k=0, 1, \\dots, d\n$$\n\n(i) When no nodes are preassigned (Gauss-Legendre quadrature), there are $2n$ free parameters: $n$ nodes $x_i$ and $n$ weights $w_i$. These $2n$ parameters can be chosen to satisfy $2n$ equations. This corresponds to setting $d+1 = 2n$, which implies a maximal possible degree of exactness of $d = 2n-1$. This maximum is indeed achieved by the Gauss-Legendre quadrature, whose nodes are the roots of the degree-$n$ Legendre polynomial $P_n(x)$.\n\n(ii) When exactly one endpoint is preassigned, for instance $x_n = 1$ (Gauss-Radau quadrature), one degree of freedom is lost. We have $n-1$ free nodes and $n$ free weights, for a total of $2n-1$ free parameters. These can be chosen to satisfy $2n-1$ moment equations. This corresponds to $d+1=2n-1$, yielding a maximal degree of exactness of $d = 2n-2$. This is achieved by the Gauss-Radau rule, whose unassigned nodes are the roots of a specific combination of Legendre polynomials (e.g., $P_n(x) - P_{n-1}(x)$).\n\n(iii) When both endpoints are preassigned, for instance $x_1 = -1$ and $x_n = 1$ (Gauss-Lobatto quadrature), two degrees of freedom are lost. We have $n-2$ free nodes and $n$ free weights, giving $2n-2$ free parameters. These can satisfy at most $2n-2$ moment equations. This corresponds to $d+1=2n-2$, which gives a maximal degree of exactness of $d=2n-3$. This maximum is achieved by the Gauss-Lobatto quadrature, whose interior nodes are the roots of $P_{n-1}'(x)$, the first derivative of the Legendre polynomial of degree $n-1$.\n\nSecond, we analyze the action of the $n$-point Gauss-Lobatto rule on the integrand $q_n(x) = (1-x^2)(P_{n-1}'(x))^2$. As established, the nodes $\\{x_i\\}_{i=1}^{n}$ for this rule consist of the endpoints $x_1 = -1$ and $x_n = 1$, and the $n-2$ roots of $P_{n-1}'(x)$. Let us evaluate $q_n(x)$ at these nodes:\n- For the endpoints $x = \\pm 1$, the factor $(1-x^2)$ is equal to $1 - (\\pm 1)^2 = 0$. Therefore, $q_n(1) = 0$ and $q_n(-1) = 0$.\n- For the interior nodes $x_i$ ($i=2, \\dots, n-1$), these are by definition the roots of $P_{n-1}'(x)$. Therefore, $P_{n-1}'(x_i) = 0$, which implies $(P_{n-1}'(x_i))^2 = 0$. Consequently, $q_n(x_i) = 0$ for all interior nodes.\n\nSince $q_n(x)$ is zero at every node $x_i$ of the $n$-point Gauss-Lobatto quadrature, the quadrature sum is\n$$\n\\sum_{i=1}^{n} w_i q_n(x_i) = \\sum_{i=1}^{n} w_i \\cdot 0 = 0\n$$\nThus, the numerical value returned by the Gauss-Lobatto rule for the integral of $q_n(x)$ is exactly $0$.\n\nThird, we evaluate the exact value of the integral $I = \\int_{-1}^{1} q_n(x) \\,dx$. The integrand is $q_n(x) = (1-x^2)(P_{n-1}'(x))^2$. A direct integration is not straightforward. We shall use integration by parts combined with the properties of Legendre polynomials. The Legendre differential equation is given by\n$$\n(1-x^2)y'' - 2xy' + k(k+1)y = 0\n$$\nwhere $y=P_k(x)$. For $k=n-1$, we have:\n$$\n(1-x^2)P_{n-1}''(x) - 2xP_{n-1}'(x) + (n-1)n P_{n-1}(x) = 0\n$$\nThis can be rearranged to give the relation:\n$$\n(1-x^2)P_{n-1}''(x) - 2xP_{n-1}'(x) = -n(n-1)P_{n-1}(x)\n$$\nThe expression on the left is the derivative of $(1-x^2)P_{n-1}'(x)$.\nNow, let us evaluate the integral $I = \\int_{-1}^{1} (1-x^2)(P_{n-1}'(x))^2 \\, dx$. We apply integration by parts with $u = (1-x^2)P_{n-1}'(x)$ and $dv = P_{n-1}'(x)dx$. Then $du = \\frac{d}{dx}[(1-x^2)P_{n-1}'(x)]dx$ and $v = P_{n-1}(x)$.\n$$\nI = \\left[ (1-x^2)P_{n-1}'(x)P_{n-1}(x) \\right]_{-1}^{1} - \\int_{-1}^{1} P_{n-1}(x) \\frac{d}{dx}\\left[(1-x^2)P_{n-1}'(x)\\right] \\,dx\n$$\nThe boundary term vanishes because the factor $(1-x^2)$ is zero at $x=\\pm 1$. The integral becomes:\n$$\nI = - \\int_{-1}^{1} P_{n-1}(x) \\left[ (1-x^2)P_{n-1}''(x) - 2xP_{n-1}'(x) \\right] \\,dx\n$$\nUsing the identity derived from the Legendre differential equation, we substitute the term in the brackets:\n$$\nI = - \\int_{-1}^{1} P_{n-1}(x) \\left[ -n(n-1)P_{n-1}(x) \\right] \\,dx = n(n-1) \\int_{-1}^{1} [P_{n-1}(x)]^2 \\,dx\n$$\nThe orthogonality property of Legendre polynomials (with standard normalization $P_k(1)=1$) is $\\int_{-1}^{1} [P_k(x)]^2 \\, dx = \\frac{2}{2k+1}$. For $k=n-1$, this gives:\n$$\n\\int_{-1}^{1} [P_{n-1}(x)]^2 \\,dx = \\frac{2}{2(n-1)+1} = \\frac{2}{2n-1}\n$$\nSubstituting this result back into the expression for $I$, we obtain the exact value of the integral:\n$$\nI = n(n-1) \\left(\\frac{2}{2n-1}\\right) = \\frac{2n(n-1)}{2n-1}\n$$\n\nFourth, we explain why the Gauss-Radau rule is exact for this integral while the Gauss-Lobatto rule is not.\nThe integrand is $q_n(x) = (1-x^2)(P_{n-1}'(x))^2$. The polynomial $P_{n-1}(x)$ has degree $n-1$, so its derivative $P_{n-1}'(x)$ has degree $n-2$. The square, $(P_{n-1}'(x))^2$, has degree $2(n-2) = 2n-4$. Multiplying by $(1-x^2)$, which has degree $2$, we find that the total degree of the polynomial $q_n(x)$ is $(2n-4) + 2 = 2n-2$.\n\n- The $n$-point Gauss-Radau rule has a degree of exactness of $2n-2$. Since the degree of the integrand $q_n(x)$ is exactly $2n-2$, the Gauss-Radau rule integrates this polynomial without error.\n\n- The $n$-point Gauss-Lobatto rule has a degree of exactness of $2n-3$. The degree of the integrand $q_n(x)$ is $2n-2$, which is one greater than the degree of exactness of the rule ($2n-2 > 2n-3$). Therefore, this rule is not guaranteed to be exact for $q_n(x)$. We have already shown that the Gauss-Lobatto approximation yields $0$, while the exact integral is $\\frac{2n(n-1)}{2n-1}$. For any integer $n \\ge 2$, this exact value is non-zero. For example, for $n=2$, the value is $\\frac{2(2)(1)}{3} = \\frac{4}{3}$. Thus, the Gauss-Lobatto rule is demonstrably not exact. The fact that the integrand vanishes at all quadrature nodes is a specific property for this particular polynomial which leads to a zero result, but this is a coincidence of structure, not a general condition for exactness. The error term for Gauss-Lobatto quadrature is proportional to the $(2n-2)$-th derivative of the integrand, which for the polynomial $q_n(x)$ is a non-zero constant, confirming that an error is expected and incurred.", "answer": "$$\\boxed{\\frac{2n(n-1)}{2n-1}}$$", "id": "2591954"}, {"introduction": "The ultimate goal of understanding quadrature theory is to apply it correctly within a finite element simulation, ensuring that integrals in the weak form are computed exactly. The integrand's complexity arises from products of basis functions, their derivatives, and coefficient functions. This final practice bridges theory and application by asking you to devise a general algorithm that determines the minimal quadrature degree $R$ required to integrate such composite functions exactly, a critical skill for developing accurate and reliable FEM codes. [@problem_id:2591935]", "problem": "Consider a finite element formulation on an element $K \\subset \\mathbb{R}^d$ obtained from an affine mapping $F : \\hat K \\to K$, $F(\\hat x) = B \\hat x + b$, with constant Jacobian matrix $B$ and determinant $|\\det B| \\neq 0$. Let the integrand on the physical element be assembled from products of basis functions and their derivatives with a polynomial coefficient. Pulling back to the reference element $\\hat K$, the integrand can be written as a finite sum\n$$\nI(\\hat x) \\;=\\; \\sum_{t=1}^{T} \\hat c_t(\\hat x)\\, \\prod_{\\ell=1}^{m_t} D^{\\alpha_{\\ell,t}} \\hat \\varphi_{\\ell,t}(\\hat x),\n$$\nwhere:\n- For each term index $t \\in \\{1,\\dots,T\\}$, the coefficient $\\hat c_t$ is a polynomial on $\\hat K$ of total degree $q_t \\in \\mathbb{N}_0$.\n- For each factor index $\\ell \\in \\{1,\\dots,m_t\\}$, $\\hat \\varphi_{\\ell,t}$ is a polynomial basis function on $\\hat K$ of total degree $p_{\\ell,t} \\in \\mathbb{N}_0$, and $D^{\\alpha_{\\ell,t}}$ denotes a partial derivative with multiindex $\\alpha_{\\ell,t} \\in \\mathbb{N}_0^d$ of total order $|\\alpha_{\\ell,t}| \\in \\mathbb{N}_0$.\n- The affine mapping implies that the transformation of derivatives introduces only constant coefficients, and the volume factor $|\\det B|$ is constant on $K$.\n\nSuppose one uses a quadrature rule on $\\hat K$ that is exact for all polynomials of total degree at most $R \\in \\mathbb{N}_0$ in $d$ dimensions. The objective is to determine an algorithm that, given the data $\\{q_t\\}$, $\\{p_{\\ell,t}\\}$, and $\\{|\\alpha_{\\ell,t}|\\}$, returns the minimal exactness degree $R$ such that the quadrature integrates $\\int_{\\hat K} I(\\hat x)\\, d\\hat x$ exactly for all such integrands under affine mappings.\n\nWhich of the following algorithms correctly computes this minimal $R$?\n\nA. For each term $t$, check whether there exists any $\\ell$ with $|\\alpha_{\\ell,t}| > p_{\\ell,t}$. If so, the entire product in term $t$ vanishes identically and can be discarded. Otherwise, set\n$M_t = q_t + \\sum_{\\ell=1}^{m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr)$.\nReturn $R = \\max_{1 \\le t \\le T} M_t$.\n\nB. For each term $t$, ignore derivatives and set\n$M_t = q_t + \\sum_{\\ell=1}^{m_t} p_{\\ell,t}$.\nReturn $R = \\max_{1 \\le t \\le T} M_t$.\n\nC. For each term $t$, include the spatial dimension as an additive safety factor and set\n$M_t = d + q_t + \\sum_{\\ell=1}^{m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr)$.\nReturn $R = \\max_{1 \\le t \\le T} M_t$.\n\nD. Reduce to a one-dimensional estimate by defining\n$S = \\max_{1 \\le t \\le T} \\left(q_t + \\sum_{\\ell=1}^{m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr)\\right)$,\nchoose the smallest one-dimensional Gauss rule whose point count $n \\in \\mathbb{N}$ satisfies $n \\ge S$, and declare the associated multidimensional tensor-product rule to have sufficient exactness for all $d$ and return $R = S$.\n\nE. For each term $t$, take only the largest surviving factor degree after differentiation and set\n$M_t = q_t + \\max_{1 \\le \\ell \\le m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr)$.\nReturn $R = \\max_{1 \\le t \\le T} M_t$.\n\nSelect all that apply. Explain your choice based on first principles, without assuming any specialized formula beyond the basic definitions of total degree, polynomial differentiation, affine change of variables, and exactness of quadrature rules.", "solution": "The problem requires the determination of a minimal quadrature exactness degree, denoted by $R$, for an integral over a reference finite element $\\hat K$. A quadrature rule with exactness degree $R$ can exactly integrate any polynomial of total degree up to $R$. The integrand in question, $I(\\hat x)$, is a sum of $T$ terms, $I(\\hat x) = \\sum_{t=1}^{T} I_t(\\hat x)$.\n\nBy the linearity of integration, the integral of the sum is the sum of the integrals:\n$$\n\\int_{\\hat K} I(\\hat x) \\, d\\hat x = \\int_{\\hat K} \\sum_{t=1}^{T} I_t(\\hat x) \\, d\\hat x = \\sum_{t=1}^{T} \\int_{\\hat K} I_t(\\hat x) \\, d\\hat x\n$$\nFor the quadrature rule to compute the total integral exactly, it must compute the integral of each term $I_t(\\hat x)$ exactly. This means the rule's exactness degree $R$ must be greater than or equal to the total polynomial degree of every term $I_t(\\hat x)$. To find the *minimal* such $R$, we must set $R$ equal to the maximum total degree found among all terms $I_t(\\hat x)$.\n$$\nR = \\max_{1 \\le t \\le T} \\left\\{ \\deg\\left(I_t(\\hat x)\\right) \\right\\}\n$$\nThis assumes that there is no fortuitous cancellation of the highest-degree parts between different terms $I_t(\\hat x)$, an assumption which must be made to guarantee exactness for all possible basis functions and coefficients.\n\nLet us analyze the total polynomial degree of a single term $I_t(\\hat x)$. The structure is given as:\n$$\nI_t(\\hat x) = \\hat c_t(\\hat x)\\, \\prod_{\\ell=1}^{m_t} D^{\\alpha_{\\ell,t}} \\hat \\varphi_{\\ell,t}(\\hat x)\n$$\nThis is a product of several polynomial functions. A fundamental property of polynomial degrees states that the degree of a product of polynomials is the sum of their individual degrees.\n$$\n\\deg(I_t) = \\deg(\\hat c_t) + \\sum_{\\ell=1}^{m_t} \\deg\\left(D^{\\alpha_{\\ell,t}} \\hat \\varphi_{\\ell,t}\\right)\n$$\nWe are given that $\\deg(\\hat c_t) = q_t$. We must determine the degree of each factor $D^{\\alpha_{\\ell,t}} \\hat \\varphi_{\\ell,t}(\\hat x)$.\n\nThe function $\\hat \\varphi_{\\ell,t}$ is a polynomial of total degree $p_{\\ell,t}$. The operator $D^{\\alpha_{\\ell,t}}$ represents partial differentiation of total order $|\\alpha_{\\ell,t}|$.\nWhen a polynomial of total degree $p$ is differentiated by an operator of total order $|\\alpha|$, the resulting polynomial has a total degree of at most $p - |\\alpha|$.\nCrucially, if the order of differentiation exceeds the polynomial degree, i.e., $|\\alpha_{\\ell,t}| > p_{\\ell,t}$, the derivative is identically the zero polynomial. The degree of the zero polynomial is, by convention, $-\\infty$.\nIf for a given term $t$, there exists even one factor $\\ell$ such that $|\\alpha_{\\ell,t}| > p_{\\ell,t}$, then the corresponding factor $D^{\\alpha_{\\ell,t}} \\hat \\varphi_{\\ell,t}(\\hat x)$ is zero. This renders the entire product $I_t(\\hat x)$ identically zero. The integral of a zero function is zero, and any valid quadrature rule will compute this exactly. Therefore, such vanishing terms impose no constraint on the minimal required degree $R$ (beyond $R \\ge 0$), and they can be excluded from the calculation of the maximum degree.\n\nFor a non-vanishing term, we must have $|\\alpha_{\\ell,t}| \\le p_{\\ell,t}$ for all $\\ell = 1, \\dots, m_t$. The degree of the derivative $D^{\\alpha_{\\ell,t}} \\hat \\varphi_{\\ell,t}$ is at most $p_{\\ell,t} - |\\alpha_{\\ell,t}|$. To ensure the algorithm is correct for\n*all* basis functions $\\hat \\varphi_{\\ell,t}$ of degree $p_{\\ell,t}$, we must consider the worst-case scenario where the degree reduction is minimal. The maximum possible degree of $D^{\\alpha_{\\ell,t}} \\hat \\varphi_{\\ell,t}$ is exactly $p_{\\ell,t} - |\\alpha_{\\ell,t}|$. For instance, for $\\varphi(x_1, \\dots, x_d) = x_1^p$, $\\deg(\\varphi)=p$, and the degree of $\\frac{\\partial^k \\varphi}{\\partial x_1^k}$ is $p-k$. The algorithm must be robust enough for such cases.\n\nThus, for a non-vanishing term $t$, the maximum possible total degree is:\n$$\nM_t = q_t + \\sum_{\\ell=1}^{m_t} \\left(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\right)\n$$\nThe minimal required exactness degree $R$ is the maximum of these degrees over all non-vanishing terms:\n$$\nR = \\max \\left\\{ M_t \\mid \\forall \\ell \\in \\{1,\\dots,m_t\\}, |\\alpha_{\\ell,t}| \\le p_{\\ell,t} \\right\\}\n$$\nThis completes the derivation of the correct algorithm.\n\nNow, we evaluate each option:\n\n**A. For each term $t$, check whether there exists any $\\ell$ with $|\\alpha_{\\ell,t}| > p_{\\ell,t}$. If so, the entire product in term $t$ vanishes identically and can be discarded. Otherwise, set $M_t = q_t + \\sum_{\\ell=1}^{m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr)$. Return $R = \\max_{1 \\le t \\le T} M_t$.**\nThis algorithm precisely implements the logic derived from first principles. It correctly identifies and handles vanishing terms, correctly calculates the maximum possible degree of each non-vanishing term by summing the degrees of its factors, and correctly determines the overall required exactness by taking the maximum over all terms.\nVerdict: **Correct**.\n\n**B. For each term $t$, ignore derivatives and set $M_t = q_t + \\sum_{\\ell=1}^{m_t} p_{\\ell,t}$. Return $R = \\max_{1 \\le t \\le T} M_t$.**\nThis algorithm incorrectly calculates the degree of the integrand. It fails to account for the reduction in polynomial degree caused by differentiation. The quantity $p_{\\ell,t} - |\\alpha_{\\ell,t}|$ is replaced by $p_{\\ell,t}$. Since $|\\alpha_{\\ell,t}| \\ge 0$, this formula yields an exactness degree that is greater than or equal to the correct minimal value. As the objective is to find the *minimal* degree $R$, this algorithm is incorrect because it is overly conservative and not minimal in general.\nVerdict: **Incorrect**.\n\n**C. For each term $t$, include the spatial dimension as an additive safety factor and set $M_t = d + q_t + \\sum_{\\ell=1}^{m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr)$. Return $R = \\max_{1 \\le t \\le T} M_t$.**\nThis algorithm adds the spatial dimension $d$ to the correctly calculated term degree. There is no principle-based justification for this modification. The total degree of a polynomial in $d$ variables is defined irrespective of $d$. The transformation from the physical element $K$ to the reference element $\\hat K$ is an affine map, for which the Jacobian determinant $|\\det B|$ is a constant. This constant factor does not change the polynomial degree of the integrand. The addition of $d$ makes the resulting degree $R$ non-minimal.\nVerdict: **Incorrect**.\n\n**D. Reduce to a one-dimensional estimate by defining $S = \\max_{1 \\le t \\le T} \\left(q_t + \\sum_{\\ell=1}^{m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr)\\right)$, choose the smallest one-dimensional Gauss rule whose point count $n \\in \\mathbb{N}$ satisfies $n \\ge S$, and declare the associated multidimensional tensor-product rule to have sufficient exactness for all $d$ and return $R = S$.**\nThis option has multiple flaws. First, and most critically, it omits the check for vanishing terms where $|\\alpha_{\\ell,t}| > p_{\\ell,t}$. If such a term exists, this formula can produce a positive degree for a zero polynomial, leading to an incorrect, non-minimal $R$. For example, if an integrand term is $\\frac{d^2}{dx^2}(x)$, its degree is $-\\infty$ (the function is $0$). The formula here would calculate $p-|\\alpha| = 1-2 = -1$. If this is part of a product, for example $x^3 \\cdot \\frac{d^2}{dx^2}(x)$, the result is $0$, but the formula would give $3 + (1-2) = 2$. This is incorrect. The check in option A is essential. Second, the justification concerning $1$D Gauss rules and tensor products is confused and contains errors (e.g., the condition for an $n$-point Gauss rule to be exact for degree $S$ is $2n-1 \\ge S$, not $n \\ge S$). The algorithm itself is flawed due to the missing check.\nVerdict: **Incorrect**.\n\n**E. For each term $t$, take only the largest surviving factor degree after differentiation and set $M_t = q_t + \\max_{1 \\le \\ell \\le m_t} \\bigl(p_{\\ell,t} - |\\alpha_{\\ell,t}|\\bigr)$. Return $R = \\max_{1 \\le t \\le T} M_t$.**\nThis algorithm is based on an incorrect property of polynomial degrees. The degree of a product of polynomials is the *sum* of their degrees, not the maximum. This algorithm substitutes a summation $\\sum_{\\ell}$ with a maximum $\\max_{\\ell}$. This will, in general, compute a degree that is too low, leading to insufficient quadrature and incorrect integration results. For example, the degree of $(x^2) \\cdot (x^3)$ is $2+3=5$, but this formula would calculate $\\max(2,3) = 3$.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2591935"}]}