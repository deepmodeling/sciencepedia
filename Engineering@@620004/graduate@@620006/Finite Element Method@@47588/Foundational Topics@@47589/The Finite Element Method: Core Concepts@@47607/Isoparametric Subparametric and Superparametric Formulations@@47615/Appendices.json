{"hands_on_practices": [{"introduction": "The foundation of the isoparametric technique lies in the mapping from a simple reference element to a more complex physical element. This first exercise explores this fundamental concept using the workhorse of 2D analysis: the bilinear quadrilateral. By examining a special case where the physical element is a parallelogram, you will uncover the properties of the underlying affine transformation and its constant Jacobian, providing an essential building block for understanding more general curved elements. [@problem_id:2570213]", "problem": "In the context of the Finite Element Method (FEM), consider the isoparametric bilinear quadrilateral mapping from the reference square $\\hat{\\Omega} = [-1, 1]^2$ with local coordinates $(\\xi,\\eta)$ to a physical quadrilateral with global coordinates $(x,y)$. The four reference nodes are at $(-1,-1)$, $(+1,-1)$, $(+1,+1)$, and $(-1,+1)$, with corresponding physical vertex positions $\\mathbf{X}_1$, $\\mathbf{X}_2$, $\\mathbf{X}_3$, and $\\mathbf{X}_4$. Suppose these physical vertices are arranged in an affine configuration forming a parallelogram:\n- $\\mathbf{X}_1 = (x_1, y_1)$,\n- $\\mathbf{X}_2 = (x_1 + a_x, y_1 + a_y)$,\n- $\\mathbf{X}_3 = (x_1 + a_x + b_x, y_1 + a_y + b_y)$,\n- $\\mathbf{X}_4 = (x_1 + b_x, y_1 + b_y)$,\nwhere $(a_x,a_y)$ and $(b_x,b_y)$ are fixed vectors defining two adjacent edges at $\\mathbf{X}_1$. Using the isoparametric concept (the same bilinear shape functions interpolate geometry and field), start from the standard bilinear shape functions on $\\hat{\\Omega}$ and:\n- write the mapping $\\mathbf{F}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{X}_i$ explicitly,\n- simplify it under the given affine vertex configuration,\n- compute the Jacobian matrix $\\mathbf{J}(\\xi,\\eta) = \\partial \\mathbf{F} / \\partial (\\xi,\\eta)$ and its determinant,\n- and reason whether interior points of $\\hat{\\Omega}$ map to interior points of the physical quadrilateral if $a_x b_y - a_y b_x > 0$.\n\nProvide, as your final answer, the closed-form expression for the determinant $\\det \\mathbf{J}$ as a function of $a_x$, $a_y$, $b_x$, and $b_y$. No rounding is required. Do not include units in your final answer.", "solution": "The problem as stated is a standard exercise in the theory of the Finite Element Method. It is scientifically grounded, well-posed, and contains sufficient information for a unique solution. We will proceed directly to the derivation.\n\nThe isoparametric formulation utilizes the same set of shape functions, $N_i$, to interpolate both the geometry of the element and the unknown field variable over the element. For a bilinear four-node quadrilateral element, the interpolation of a coordinate vector $\\mathbf{x} = (x, y)$ from the reference coordinates $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ is given by the mapping $\\mathbf{F}(\\xi, \\eta)$:\n$$\n\\mathbf{x}(\\xi, \\eta) = \\mathbf{F}(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) \\mathbf{X}_i\n$$\nwhere $\\mathbf{X}_i$ are the coordinates of the vertices of the physical element. The standard bilinear shape functions for the four nodes, ordered counter-clockwise starting from the bottom-left corner $(\\xi=-1, \\eta=-1)$, are:\n$$\n\\begin{aligned}\nN_1(\\xi, \\eta) &= \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) &= \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) &= \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) &= \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\nThe problem specifies the coordinates of the physical vertices which form a parallelogram:\n$$\n\\begin{aligned}\n\\mathbf{X}_1 &= (x_1, y_1) \\\\\n\\mathbf{X}_2 &= (x_1 + a_x, y_1 + a_y) \\\\\n\\mathbf{X}_3 &= (x_1 + a_x + b_x, y_1 + a_y + b_y) \\\\\n\\mathbf{X}_4 &= (x_1 + b_x, y_1 + b_y)\n\\end{aligned}\n$$\nHere, $\\mathbf{a} = (a_x, a_y)$ and $\\mathbf{b} = (b_x, b_y)$ represent the vectors of the two adjacent sides originating from vertex $\\mathbf{X}_1$.\n\nWe now explicitly write the mapping for the $x$ and $y$ coordinates separately.\nFor the $x$-coordinate:\n$$\nx(\\xi, \\eta) = N_1(\\xi, \\eta) x_1 + N_2(\\xi, \\eta) (x_1 + a_x) + N_3(\\xi, \\eta) (x_1 + a_x + b_x) + N_4(\\xi, \\eta) (x_1 + b_x)\n$$\nWe can regroup the terms:\n$$\nx(\\xi, \\eta) = x_1 (N_1 + N_2 + N_3 + N_4) + a_x (N_2 + N_3) + b_x (N_3 + N_4)\n$$\nA fundamental property of shape functions is that they form a partition of unity, i.e., $\\sum_{i=1}^{4} N_i(\\xi, \\eta) = 1$. Let us verify the other sums:\n$$\nN_2 + N_3 = \\frac{1}{4}(1+\\xi)(1-\\eta) + \\frac{1}{4}(1+\\xi)(1+\\eta) = \\frac{1}{4}(1+\\xi)[(1-\\eta)+(1+\\eta)] = \\frac{1}{2}(1+\\xi)\n$$\n$$\nN_3 + N_4 = \\frac{1}{4}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) = \\frac{1}{4}(1+\\eta)[(1+\\xi)+(1-\\xi)] = \\frac{1}{2}(1+\\eta)\n$$\nSubstituting these back into the expression for $x(\\xi, \\eta)$ gives:\n$$\nx(\\xi, \\eta) = x_1 + \\frac{1}{2}(1+\\xi)a_x + \\frac{1}{2}(1+\\eta)b_x\n$$\nBy identical logic, the mapping for the $y$-coordinate is:\n$$\ny(\\xi, \\eta) = y_1 + \\frac{1}{2}(1+\\xi)a_y + \\frac{1}{2}(1+\\eta)b_y\n$$\nThese two equations define the explicit affine mapping from the reference square to the physical parallelogram.\n\nThe next step is to compute the Jacobian matrix of this transformation, $\\mathbf{J}(\\xi, \\eta)$. The Jacobian matrix is defined as:\n$$\n\\mathbf{J}(\\xi, \\eta) = \\frac{\\partial \\mathbf{F}}{\\partial (\\xi, \\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\nWe compute the necessary partial derivatives from the simplified mapping equations:\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( x_1 + \\frac{1}{2}(1+\\xi)a_x + \\frac{1}{2}(1+\\eta)b_x \\right) = \\frac{1}{2}a_x\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( x_1 + \\frac{1}{2}(1+\\xi)a_x + \\frac{1}{2}(1+\\eta)b_x \\right) = \\frac{1}{2}b_x\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( y_1 + \\frac{1}{2}(1+\\xi)a_y + \\frac{1}{2}(1+\\eta)b_y \\right) = \\frac{1}{2}a_y\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( y_1 + \\frac{1}{2}(1+\\xi)a_y + \\frac{1}{2}(1+\\eta)b_y \\right) = \\frac{1}{2}b_y\n$$\nAssembling these components yields the Jacobian matrix:\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} \\frac{1}{2}a_x & \\frac{1}{2}b_x \\\\ \\frac{1}{2}a_y & \\frac{1}{2}b_y \\end{pmatrix}\n$$\nNotice that for an affine mapping, the Jacobian matrix is constant; it is not a function of the local coordinates $(\\xi, \\eta)$.\n\nFinally, we compute the determinant of the Jacobian matrix:\n$$\n\\det \\mathbf{J} = \\left(\\frac{1}{2}a_x\\right)\\left(\\frac{1}{2}b_y\\right) - \\left(\\frac{1}{2}b_x\\right)\\left(\\frac{1}{2}a_y\\right) = \\frac{1}{4}(a_x b_y - a_y b_x)\n$$\nThe expression $a_x b_y - a_y b_x$ is the magnitude of the cross product of the vectors $\\mathbf{a}=(a_x, a_y, 0)$ and $\\mathbf{b}=(b_x, b_y, 0)$, which geometrically represents the area of the parallelogram formed by these two vectors. Let $A$ be the area of the physical element. Then $\\det\\mathbf{J} = \\frac{A}{4}$, since the area of the reference square is $4$. The differential area relation is $dx\\,dy = (\\det \\mathbf{J}) \\,d\\xi\\,d\\eta$.\n\nRegarding the mapping of interior points: for the mapping to be valid (one-to-one and orientation-preserving), the determinant of the Jacobian must be positive everywhere in the domain. The problem specifies that $a_x b_y - a_y b_x > 0$. Consequently, $\\det \\mathbf{J} = \\frac{1}{4}(a_x b_y - a_y b_x) > 0$. Since the Jacobian determinant is a positive constant, the mapping is non-singular for all $(\\xi, \\eta) \\in \\hat{\\Omega}$. A non-singular affine transformation is a bijection. Therefore, it maps the boundary of the reference square onto the boundary of the physical parallelogram, and crucially, it maps the interior of the reference square uniquely to the interior of the physical parallelogram. The condition $\\det \\mathbf{J} > 0$ ensures the element is not degenerate (i.e. collapsed into a line or a point) and not inverted (i.e., the vertices are numbered in a consistent counter-clockwise order).", "answer": "$$\\boxed{\\frac{1}{4}(a_x b_y - a_y b_x)}$$", "id": "2570213"}, {"introduction": "Now that we've established the basics of mapping, we can directly compare the different 'parametric' formulations. This practice uses a one-dimensional setting to clearly distinguish the isoparametric, subparametric, and superparametric approaches by varying the polynomial orders used for geometry and the field variable. Calculating a physical quantity like the derivative $\\frac{du}{dx}$ for each case will provide a concrete understanding of how the choice of formulation directly influences the computed solution. [@problem_id:2570237]", "problem": "Consider a one-dimensional ($1$D) reference segment with parent coordinate $\\xi \\in [-1, 1]$. Let the nodal set for a cubic ($p=3$) Lagrange interpolation on this reference segment be $\\{\\xi_1,\\xi_2,\\xi_3,\\xi_4\\}=\\{-1,-\\frac{1}{3},\\frac{1}{3},1\\}$. Starting from the definition of Lagrange interpolation polynomials, derive the four cubic shape functions $\\{N_1(\\xi),N_2(\\xi),N_3(\\xi),N_4(\\xi)\\}$ associated with these nodes.\n\nUsing the Finite Element Method (FEM) paradigm that the geometry mapping $x(\\xi)$ and the field approximation $u(\\xi)$ are constructed by interpolating their nodal data with chosen shape functions, set up three distinct element configurations:\n\n- Isoparametric: use the cubic shape functions $\\{N_i(\\xi)\\}_{i=1}^4$ both for geometry and field, with physical coordinates $x_1=0$, $x_2=1$, $x_3=2$, $x_4=3$ and scalar field nodal values $u_1=2$, $u_2=-1$, $u_3=3$, $u_4=0$.\n\n- Subparametric: use a quadratic ($p=2$) geometry mapping with nodes at $\\xi=\\{-1,0,1\\}$ and physical coordinates $\\{x(-1),x(0),x(1)\\}=\\{0,1,4\\}$, while keeping the cubic field interpolation for $u(\\xi)$ with the same four field nodal values as above.\n\n- Superparametric: use a quartic ($p=4$) geometry mapping with nodes at $\\xi=\\{-1,-\\frac{1}{2},0,\\frac{1}{2},1\\}$ and physical coordinates $\\{x(-1),x(-\\frac{1}{2}),x(0),x(\\frac{1}{2}),x(1)\\}=\\{0,1,2,3,5\\}$, while again keeping the cubic field interpolation for $u(\\xi)$ with the same four field nodal values.\n\nFor each configuration, construct the geometry $x(\\xi)$ and the field $u(\\xi)$ from first principles, and compute the physical derivative $\\frac{du}{dx}$ at the point corresponding to $\\xi=0$ by combining the chain rule with the appropriate Jacobian $J(\\xi)=\\frac{dx}{d\\xi}$. Then evaluate the single quantity\n$$\nS \\;=\\; \\left.\\frac{du}{dx}\\right|_{\\text{iso},\\,\\xi=0} \\;+\\; \\left.\\frac{du}{dx}\\right|_{\\text{super},\\,\\xi=0} \\;-\\; 2\\,\\left.\\frac{du}{dx}\\right|_{\\text{sub},\\,\\xi=0}.\n$$\nExpress your final answer for $S$ in exact form (no rounding). Angle units and physical units are not involved in this problem.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n**Step 1: Extracted Givens**\n- Reference element: A one-dimensional segment with parent coordinate $\\xi \\in [-1,1]$.\n- Cubic shape functions: To be derived for a Lagrange interpolation of order $p=3$ on the nodal set $\\{\\xi_1, \\xi_2, \\xi_3, \\xi_4\\} = \\{-1, -1/3, 1/3, 1\\}$. These are denoted $\\{N_i(\\xi)\\}_{i=1}^4$.\n- Isoparametric case:\n    - Geometry interpolation: Cubic, using $\\{N_i(\\xi)\\}$. Nodal coordinates $\\{x_1, x_2, x_3, x_4\\} = \\{0, 1, 2, 3\\}$.\n    - Field interpolation: Cubic, using $\\{N_i(\\xi)\\}$. Nodal values $\\{u_1, u_2, u_3, u_4\\} = \\{2, -1, 3, 0\\}$.\n- Subparametric case:\n    - Geometry interpolation: Quadratic ($p=2$), with nodes at $\\{-1, 0, 1\\}$. Nodal coordinates $\\{x(-1), x(0), x(1)\\} = \\{0, 1, 4\\}$.\n    - Field interpolation: Cubic, using $\\{N_i(\\xi)\\}$ and the same nodal values as above.\n- Superparametric case:\n    - Geometry interpolation: Quartic ($p=4$), with nodes at $\\{-1, -1/2, 0, 1/2, 1\\}$. Nodal coordinates $\\{x(-1), x(-1/2), x(0), x(1/2), x(1)\\} = \\{0, 1, 2, 3, 5\\}$.\n    - Field interpolation: Cubic, using $\\{N_i(\\xi)\\}$ and the same nodal values as above.\n- Objective: For each of the three configurations, compute the physical derivative $\\frac{du}{dx}$ at the point corresponding to $\\xi = 0$. Then, evaluate the quantity $S = \\left.\\frac{du}{dx}\\right|_{\\text{iso},\\,\\xi=0} + \\left.\\frac{du}{dx}\\right|_{\\text{super},\\,\\xi=0} - 2\\,\\left.\\frac{du}{dx}\\right|_{\\text{sub},\\,\\xi=0}$.\n\n**Step 2: Validation of Problem Statement**\nThe problem is scientifically grounded in the theory of the Finite Element Method. It is well-posed, with all necessary data and conditions clearly specified for the derivation of shape functions and the construction of isoparametric, subparametric, and superparametric elements. The definitions are standard, and the tasks are objective and computationally verifiable. The problem is free of scientific inaccuracies, contradictions, or ambiguities.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A complete solution will now be provided.\n\nThe core of the problem lies in the application of Lagrange interpolation and the chain rule for derivatives in a finite element context. The physical derivative $\\frac{du}{dx}$ is related to the derivatives in the parent coordinate $\\xi$ by\n$$\n\\frac{du}{dx} = \\frac{du/d\\xi}{dx/d\\xi} = \\frac{1}{J(\\xi)} \\frac{du}{d\\xi}\n$$\nwhere $J(\\xi) = \\frac{dx}{d\\xi}$ is the Jacobian of the geometric mapping $x(\\xi)$.\n\nFirst, we derive the cubic Lagrange shape functions $N_i(\\xi)$ for the nodes $\\xi_1 = -1$, $\\xi_2 = -1/3$, $\\xi_3 = 1/3$, $\\xi_4 = 1$. The general formula is $N_i(\\xi) = \\prod_{j \\neq i} \\frac{\\xi - \\xi_j}{\\xi_i - \\xi_j}$.\n$$\nN_1(\\xi) = \\frac{(\\xi + 1/3)(\\xi - 1/3)(\\xi - 1)}{(-1 + 1/3)(-1 - 1/3)(-1 - 1)} = \\frac{(\\xi^2 - 1/9)(\\xi-1)}{(-2/3)(-4/3)(-2)} = -\\frac{9}{16}(\\xi^3-\\xi^2-\\frac{1}{9}\\xi+\\frac{1}{9}) = \\frac{1}{16}(-9\\xi^3+9\\xi^2+\\xi-1)\n$$\n$$\nN_2(\\xi) = \\frac{(\\xi + 1)(\\xi - 1/3)(\\xi - 1)}{(-1/3 + 1)(-1/3 - 1/3)(-1/3 - 1)} = \\frac{(\\xi^2 - 1)(\\xi-1/3)}{(2/3)(-2/3)(-4/3)} = \\frac{27}{16}(\\xi^3-\\frac{1}{3}\\xi^2-\\xi+\\frac{1}{3}) = \\frac{1}{16}(27\\xi^3-9\\xi^2-27\\xi+9)\n$$\nDue to the symmetric placement of nodes about $\\xi=0$, we have $N_3(\\xi) = N_2(-\\xi)$ and $N_4(\\xi) = N_1(-\\xi)$.\n$$\nN_3(\\xi) = N_2(-\\xi) = \\frac{1}{16}(-27\\xi^3-9\\xi^2+27\\xi+9)\n$$\n$$\nN_4(\\xi) = N_1(-\\xi) = \\frac{1}{16}(9\\xi^3+9\\xi^2-\\xi-1)\n$$\nWe require the derivatives of these shape functions, evaluated at $\\xi=0$.\n$$\n\\left.\\frac{dN_1}{d\\xi}\\right|_{\\xi=0} = \\left.\\frac{1}{16}(-27\\xi^2+18\\xi+1)\\right|_{\\xi=0} = \\frac{1}{16}\n$$\n$$\n\\left.\\frac{dN_2}{d\\xi}\\right|_{\\xi=0} = \\left.\\frac{1}{16}(81\\xi^2-18\\xi-27)\\right|_{\\xi=0} = -\\frac{27}{16}\n$$\n$$\n\\left.\\frac{dN_3}{d\\xi}\\right|_{\\xi=0} = \\left.\\frac{1}{16}(-81\\xi^2-18\\xi+27)\\right|_{\\xi=0} = \\frac{27}{16}\n$$\n$$\n\\left.\\frac{dN_4}{d\\xi}\\right|_{\\xi=0} = \\left.\\frac{1}{16}(27\\xi^2+18\\xi-1)\\right|_{\\xi=0} = -\\frac{1}{16}\n$$\nThe field approximation is $u(\\xi) = \\sum_{i=1}^4 u_i N_i(\\xi)$, and its derivative with respect to $\\xi$ is $\\frac{du}{d\\xi} = \\sum_{i=1}^4 u_i \\frac{dN_i}{d\\xi}$. The nodal values are given as $\\{u_1, u_2, u_3, u_4\\} = \\{2, -1, 3, 0\\}$. This field approximation is the same for all three configurations. We compute its derivative at $\\xi=0$:\n$$\n\\left.\\frac{du}{d\\xi}\\right|_{\\xi=0} = \\sum_{i=1}^4 u_i \\left.\\frac{dN_i}{d\\xi}\\right|_{\\xi=0} = (2)\\left(\\frac{1}{16}\\right) + (-1)\\left(-\\frac{27}{16}\\right) + (3)\\left(\\frac{27}{16}\\right) + (0)\\left(-\\frac{1}{16}\\right) = \\frac{2+27+81}{16} = \\frac{110}{16} = \\frac{55}{8}\n$$\nNow, we compute the Jacobian $J(\\xi=0)$ for each of the three configurations.\n\n**1. Isoparametric Case**\nThe geometry is interpolated using the same cubic shape functions: $x(\\xi) = \\sum_{i=1}^4 x_i N_i(\\xi)$. The nodal coordinates are $\\{x_1, x_2, x_3, x_4\\} = \\{0, 1, 2, 3\\}$.\nThe Jacobian at $\\xi=0$ is:\n$$\nJ_{\\text{iso}}(0) = \\left.\\frac{dx}{d\\xi}\\right|_{\\xi=0} = \\sum_{i=1}^4 x_i \\left.\\frac{dN_i}{d\\xi}\\right|_{\\xi=0} = (0)\\left(\\frac{1}{16}\\right) + (1)\\left(-\\frac{27}{16}\\right) + (2)\\left(\\frac{27}{16}\\right) + (3)\\left(-\\frac{1}{16}\\right) = \\frac{-27+54-3}{16} = \\frac{24}{16} = \\frac{3}{2}\n$$\nThe physical derivative is:\n$$\n\\left.\\frac{du}{dx}\\right|_{\\text{iso},\\,\\xi=0} = \\frac{1}{J_{\\text{iso}}(0)} \\left.\\frac{du}{d\\xi}\\right|_{\\xi=0} = \\frac{1}{3/2} \\cdot \\frac{55}{8} = \\frac{2}{3} \\cdot \\frac{55}{8} = \\frac{55}{12}\n$$\n\n**2. Subparametric Case**\nThe geometry is interpolated using quadratic Lagrange polynomials over nodes $\\{-1, 0, 1\\}$. The mapping is $x(\\xi) = x(-1)L_1(\\xi) + x(0)L_2(\\xi) + x(1)L_3(\\xi)$, where $L_1(\\xi)=\\frac{1}{2}(\\xi^2-\\xi)$, $L_2(\\xi)=1-\\xi^2$, $L_3(\\xi)=\\frac{1}{2}(\\xi^2+\\xi)$. With physical coordinates $\\{0, 1, 4\\}$, we have:\n$$\nx(\\xi) = (0)L_1(\\xi) + (1)L_2(\\xi) + (4)L_3(\\xi) = (1-\\xi^2) + 4\\left(\\frac{1}{2}(\\xi^2+\\xi)\\right) = 1-\\xi^2+2\\xi^2+2\\xi = \\xi^2+2\\xi+1 = (\\xi+1)^2\n$$\nThe Jacobian is $J_{\\text{sub}}(\\xi) = \\frac{dx}{d\\xi} = 2\\xi+2$. At $\\xi=0$, this is $J_{\\text{sub}}(0)=2$.\nThe physical derivative is:\n$$\n\\left.\\frac{du}{dx}\\right|_{\\text{sub},\\,\\xi=0} = \\frac{1}{J_{\\text{sub}}(0)} \\left.\\frac{du}{d\\xi}\\right|_{\\xi=0} = \\frac{1}{2} \\cdot \\frac{55}{8} = \\frac{55}{16}\n$$\n\n**3. Superparametric Case**\nThe geometry is a quartic polynomial $x(\\xi) = a\\xi^4+b\\xi^3+c\\xi^2+d\\xi+e$ passing through 5 points. The Jacobian at $\\xi=0$ is $J_{\\text{super}}(0) = \\left.\\frac{dx}{d\\xi}\\right|_{\\xi=0} = d$. To find the coefficient $d$, we use the given nodal pairs. The mapping passes through $(\\xi, x)$ pairs: $(-1, 0)$, $(-1/2, 1)$, $(0, 2)$, $(1/2, 3)$, $(1, 5)$.\nFrom $(\\xi,x)=(0,2)$, we find $e=2$.\nWe construct the odd part of the mapping, $x_{\\text{odd}}(\\xi) = \\frac{x(\\xi)-x(-\\xi)}{2} = b\\xi^3+d\\xi$.\nAt $\\xi=1$: $x_{\\text{odd}}(1) = \\frac{x(1)-x(-1)}{2} = \\frac{5-0}{2} = \\frac{5}{2}$. This gives $b+d = \\frac{5}{2}$.\nAt $\\xi=1/2$: $x_{\\text{odd}}(1/2) = \\frac{x(1/2)-x(-1/2)}{2} = \\frac{3-1}{2} = 1$. This gives $b(\\frac{1}{8}) + d(\\frac{1}{2}) = 1$, or $b+4d=8$.\nWe solve the system:\n$$\n\\begin{cases} b+d = 5/2 \\\\ b+4d = 8 \\end{cases}\n$$\nSubtracting the first equation from the second gives $3d = 8 - 5/2 = 11/2$, so $d=11/6$.\nThe Jacobian is $J_{\\text{super}}(0)=d=11/6$.\nThe physical derivative is:\n$$\n\\left.\\frac{du}{dx}\\right|_{\\text{super},\\,\\xi=0} = \\frac{1}{J_{\\text{super}}(0)} \\left.\\frac{du}{d\\xi}\\right|_{\\xi=0} = \\frac{1}{11/6} \\cdot \\frac{55}{8} = \\frac{6}{11} \\cdot \\frac{55}{8} = \\frac{6 \\cdot 5}{8} = \\frac{30}{8} = \\frac{15}{4}\n$$\n\n**Final Calculation**\nFinally, we compute the target quantity $S$:\n$$\nS = \\left.\\frac{du}{dx}\\right|_{\\text{iso},\\,\\xi=0} + \\left.\\frac{du}{dx}\\right|_{\\text{super},\\,\\xi=0} - 2\\,\\left.\\frac{du}{dx}\\right|_{\\text{sub},\\,\\xi=0}\n$$\n$$\nS = \\frac{55}{12} + \\frac{15}{4} - 2\\left(\\frac{55}{16}\\right) = \\frac{55}{12} + \\frac{15}{4} - \\frac{55}{8}\n$$\nThe least common multiple of $12$, $4$, and $8$ is $24$.\n$$\nS = \\frac{55 \\cdot 2}{24} + \\frac{15 \\cdot 6}{24} - \\frac{55 \\cdot 3}{24} = \\frac{110 + 90 - 165}{24} = \\frac{200 - 165}{24} = \\frac{35}{24}\n$$\nThe calculation is complete.", "answer": "$$\n\\boxed{\\frac{35}{24}}\n$$", "id": "2570237"}, {"introduction": "The final step in applying these formulations is to compute the element matrices, which almost always requires numerical integration. This practice connects the theoretical formulation to a crucial implementation detail: Gauss-Legendre quadrature. By determining the polynomial degree of the integrand for a consistent mass matrix, you will learn how to select the minimum number of integration points needed to compute the matrix exactly, a skill vital for developing efficient and accurate finite element codes. [@problem_id:2570264]", "problem": "Consider a four-node bilinear quadrilateral finite element used for structural dynamics in two dimensions with constant mass density $\\rho$ and constant thickness $t$. The element geometry is mapped from the bi-unit square in the parent coordinates $(\\xi,\\eta) \\in [-1, 1]\\times[-1, 1]$ to the physical element by an isoparametric bilinear mapping with arbitrary nondegenerate nodal coordinates. The field (e.g., displacement) is interpolated by the same four bilinear shape functions $N_i(\\xi,\\eta)$, $i=1,\\dots,4$ (that is, the formulation is isoparametric and the field interpolation is linear in each parent coordinate).\n\nThe consistent element mass matrix entries are defined by the fundamental relation\n$$\nM_{ij} \\;=\\; \\int_{\\Omega_e} \\rho\\, t \\, N_i(\\boldsymbol{x})\\,N_j(\\boldsymbol{x}) \\,\\mathrm{d}\\Omega \\,,\n$$\nwhere $\\Omega_e$ is the element domain in physical coordinates and $\\boldsymbol{x} = \\boldsymbol{x}(\\xi,\\eta)$ is the isoparametric mapping. Using the isoparametric change of variables to the parent domain and a tensor-product Gauss–Legendre quadrature with $(n_\\xi,n_\\eta)$ points in the $\\xi$- and $\\eta$-directions, respectively, determine the minimum pair $(n_\\xi,n_\\eta)$ required to integrate $M_{ij}$ exactly for all $i,j$ and for arbitrary bilinear element geometries.\n\nYour reasoning must start from first principles (the definition above and standard properties of isoparametric mappings and Gauss–Legendre quadrature) and proceed by determining the polynomial degree of the integrand in each parent coordinate. State the minimal $(n_\\xi,n_\\eta)$ as a single ordered pair. No rounding is required and no units are to be reported in the final answer.", "solution": "The posed problem is first subjected to a mandatory validation procedure.\n\nStep 1: Extract Givens\n- Element type: four-node bilinear quadrilateral finite element in two dimensions.\n- Physical properties: constant mass density $\\rho$, constant thickness $t$.\n- Parent domain: a bi-unit square in $(\\xi,\\eta)$ coordinates, where $(\\xi,\\eta) \\in [-1, 1]\\times[-1, 1]$.\n- Geometric mapping: isoparametric bilinear mapping from parent to physical domain, with arbitrary nondegenerate nodal coordinates. $ \\boldsymbol{x} = \\boldsymbol{x}(\\xi,\\eta) $.\n- Field interpolation: same four bilinear shape functions $N_i(\\xi,\\eta)$, $i=1, \\dots, 4$.\n- Definition of consistent mass matrix entries: $M_{ij} = \\int_{\\Omega_e} \\rho\\, t \\, N_i(\\boldsymbol{x})\\,N_j(\\boldsymbol{x}) \\,\\mathrm{d}\\Omega$.\n- Numerical integration method: tensor-product Gauss–Legendre quadrature with $(n_\\xi,n_\\eta)$ points.\n- Objective: determine the minimum pair $(n_\\xi,n_\\eta)$ for exact integration of $M_{ij}$ for all $i,j$ and for arbitrary bilinear element geometries.\n\nStep 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is a standard, fundamental question in the theory of the Finite Element Method. It deals with isoparametric formulation, consistent mass matrices, and numerical quadrature, all of which are well-established concepts in computational mechanics and applied mathematics.\n- **Well-Posed:** The problem is well-posed. It provides all necessary information (element type, interpolation, mapping, integration rule) to determine the polynomial order of the integrand, which directly leads to the required number of quadrature points for exact integration. The solution is unique and stable.\n- **Objective:** The language is precise, technical, and free of any subjectivity or ambiguity. Terms like \"bilinear\", \"isoparametric\", and \"Gauss-Legendre quadrature\" have rigorous mathematical definitions.\n\nStep 3: Verdict and Action\nThe problem is scientifically sound, self-contained, and well-posed. It is a valid problem of computational engineering. A solution will be formulated.\n\nThe consistent mass matrix for a two-dimensional element is given by\n$$ M_{ij} = \\int_{\\Omega_e} \\rho t N_i(\\boldsymbol{x}) N_j(\\boldsymbol{x}) \\, \\mathrm{d}\\Omega $$\nwhere $\\rho$ and $t$ are constants, and $\\Omega_e$ is the domain of the element in physical coordinates $\\boldsymbol{x} = (x,y)$.\n\nThe formulation is isoparametric, meaning the geometric mapping from the parent coordinates $(\\xi, \\eta)$ to the physical coordinates $(x,y)$ uses the same shape functions as the field interpolation. The integral must be transformed to the parent domain $[-1, 1] \\times [-1, 1]$:\n$$ \\mathrm{d}\\Omega = \\mathrm{d}x \\mathrm{d}y = |J| \\, \\mathrm{d}\\xi \\mathrm{d}\\eta $$\nwhere $|J|$ is the determinant of the Jacobian matrix of the geometric transformation. The mass matrix expression becomes:\n$$ M_{ij} = \\rho t \\int_{-1}^{1} \\int_{-1}^{1} N_i(\\xi, \\eta) N_j(\\xi, \\eta) |J|(\\xi, \\eta) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta $$\nTo determine the minimum number of Gauss-Legendre quadrature points $(n_\\xi, n_\\eta)$ for exact integration, we must find the polynomial degree of the integrand, $F(\\xi, \\eta) = N_i(\\xi, \\eta) N_j(\\xi, \\eta) |J|(\\xi, \\eta)$, with respect to each parent coordinate $\\xi$ and $\\eta$.\n\nFirst, we analyze the shape functions $N_i(\\xi, \\eta)$ for a four-node bilinear element. They are of the form $c(1 \\pm \\xi)(1 \\pm \\eta)$, for example $N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$. Each shape function is linear in $\\xi$ and linear in $\\eta$. The product of two such shape functions, $N_i(\\xi, \\eta) N_j(\\xi, \\eta)$, will therefore be a biquadratic polynomial. That is, it is a polynomial of degree at most $2$ in $\\xi$ and degree at most $2$ in $\\eta$. For example, $N_1(\\xi,\\eta) N_3(\\xi,\\eta) = \\frac{1}{16}(1-\\xi^2)(1-\\eta^2)$, which is quadratic in $\\xi$ and quadratic in $\\eta$.\n\nNext, we analyze the Jacobian determinant $|J|$. The geometric mapping is\n$$ \\boldsymbol{x}(\\xi, \\eta) = \\sum_{k=1}^{4} N_k(\\xi, \\eta) \\boldsymbol{x}_k $$\nwhere $\\boldsymbol{x}_k$ are the constant nodal coordinate vectors. The components of the Jacobian matrix $J$ are given by the partial derivatives of the mapping:\n$$ J = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\sum_k \\frac{\\partial N_k}{\\partial \\xi} x_k & \\sum_k \\frac{\\partial N_k}{\\partial \\xi} y_k \\\\ \\sum_k \\frac{\\partial N_k}{\\partial \\eta} x_k & \\sum_k \\frac{\\partial N_k}{\\partial \\eta} y_k \\end{pmatrix} $$\nThe partial derivatives of the bilinear shape functions are:\n$$ \\frac{\\partial N_k}{\\partial \\xi} \\text{ is linear in } \\eta \\text{ and constant in } \\xi. $$\n$$ \\frac{\\partial N_k}{\\partial \\eta} \\text{ is linear in } \\xi \\text{ and constant in } \\eta. $$\nConsequently, the entries of the Jacobian matrix have the following polynomial dependencies:\n$$ \\frac{\\partial x}{\\partial \\xi} = f_1(\\eta), \\quad \\frac{\\partial y}{\\partial \\xi} = f_2(\\eta) $$\n$$ \\frac{\\partial x}{\\partial \\eta} = g_1(\\xi), \\quad \\frac{\\partial y}{\\partial \\eta} = g_2(\\xi) $$\nwhere $f_1, f_2$ are linear functions of $\\eta$ and $g_1, g_2$ are linear functions of $\\xi$.\n\nThe determinant of the Jacobian is\n$$ |J|(\\xi, \\eta) = \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial y}{\\partial \\xi} \\frac{\\partial x}{\\partial \\eta} = f_1(\\eta) g_2(\\xi) - f_2(\\eta) g_1(\\xi) $$\nFor an arbitrary, non-degenerate element geometry, the nodal coordinates are such that these functions are not zero. The product of a linear function of $\\eta$ and a linear function of $\\xi$ is a bilinear polynomial of the form $a+b\\xi+c\\eta+d\\xi\\eta$. Therefore, $|J|$ is generally a bilinear polynomial, meaning it is of degree $1$ in $\\xi$ and degree $1$ in $\\eta$.\n\nThe total integrand is the product $N_i N_j |J|$.\n- The term $N_i N_j$ is a polynomial of degree $2$ in $\\xi$ and degree $2$ in $\\eta$.\n- The term $|J|$ is a polynomial of degree $1$ in $\\xi$ and degree $1$ in $\\eta$.\nThe degree of the product of two polynomials is the sum of their degrees.\n- The degree of the integrand in $\\xi$ is $2 + 1 = 3$.\n- The degree of the integrand in $\\eta$ is $2 + 1 = 3$.\n\nAn $n$-point Gauss-Legendre quadrature rule integrates polynomials of degree up to $2n-1$ exactly.\nTo integrate a polynomial of degree $p$ exactly, we require $2n-1 \\ge p$, which implies $n \\ge \\frac{p+1}{2}$.\n\nFor integration in the $\\xi$-direction, the polynomial degree is $p_\\xi = 3$. The required number of points $n_\\xi$ is:\n$$ n_\\xi \\ge \\frac{3+1}{2} = 2 $$\nThe minimum integer value is $n_\\xi = 2$.\n\nFor integration in the $\\eta$-direction, the polynomial degree is $p_\\eta = 3$. The required number of points $n_\\eta$ is:\n$$ n_\\eta \\ge \\frac{3+1}{2} = 2 $$\nThe minimum integer value is $n_\\eta = 2$.\n\nTherefore, the minimum pair of quadrature points $(n_\\xi, n_\\eta)$ required to integrate the consistent mass matrix exactly for an arbitrary four-node bilinear isoparametric element is $(2, 2)$. This corresponds to a $2 \\times 2$ Gauss quadrature rule.", "answer": "$$ \\boxed{ (2, 2) } $$", "id": "2570264"}]}