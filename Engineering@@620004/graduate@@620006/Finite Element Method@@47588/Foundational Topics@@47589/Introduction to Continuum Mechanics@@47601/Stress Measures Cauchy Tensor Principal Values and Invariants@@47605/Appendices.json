{"hands_on_practices": [{"introduction": "Understanding the state of stress within a material is fundamental to predicting its behavior. This practice exercise guides you through the core mathematical procedure of stress analysis: finding the principal stresses and their directions for a given Cauchy stress tensor [@problem_id:2603177]. By working through this numerical example, you will solidify your understanding of how a complex, multi-component stress state can be simplified into its most intuitive formâ€”a state of pure tension and compression.", "problem": "In the context of the Finite Element Method (FEM), consider the Cauchy stress tensor at a material point given in the orthonormal basis by the symmetric matrix\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n2 & 1 & 0 \\\\\n1 & 2 & 1 \\\\\n0 & 1 & 2\n\\end{pmatrix},\n$$\nwhere all entries are in megapascals (MPa). Principal stresses are defined as the eigenvalues of the Cauchy stress tensor, and principal directions are the corresponding eigenvectors. The first three principal invariants of the stress tensor are defined by $I_{1} = \\operatorname{tr}(\\boldsymbol{\\sigma})$, $I_{2} = \\frac{1}{2}\\big[(\\operatorname{tr}\\boldsymbol{\\sigma})^{2} - \\operatorname{tr}(\\boldsymbol{\\sigma}^{2})\\big]$, and $I_{3} = \\det(\\boldsymbol{\\sigma})$.\n\nStarting from these definitions and the spectral characterization of symmetric tensors, perform the following:\n\n1. Derive the characteristic equation of $\\boldsymbol{\\sigma}$ in terms of the invariants $I_{1}$, $I_{2}$, and $I_{3}$, and compute these invariants explicitly for the given $\\boldsymbol{\\sigma}$.\n2. Solve the characteristic equation exactly to obtain all principal stresses. Express the principal stresses in MPa. Do not use any numerical approximations.\n3. For each principal stress, compute a corresponding eigenvector and normalize it to unit length, yielding the principal directions. Verify explicitly that the resulting three normalized eigenvectors are mutually orthogonal and have unit norm.\n\nYour final reported answer must list, in a single row, the three principal stresses followed by the three normalized eigenvectors, each as a $3\\times 1$ column vector, in the same order as the corresponding eigenvalues. The final answer must be exact and must not be rounded. The principal stresses are to be expressed in MPa, but do not include units in the final boxed answer.", "solution": "The problem requires the determination of principal stresses and principal directions for a given Cauchy stress tensor $\\boldsymbol{\\sigma}$, along with the calculation of its invariants and the derivation of the characteristic equation. The problem is a standard exercise in continuum mechanics and linear algebra. It is scientifically grounded, well-posed, and contains all necessary information for a unique solution. We proceed with the solution.\n\nThe Cauchy stress tensor is given by the matrix:\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n2 & 1 & 0 \\\\\n1 & 2 & 1 \\\\\n0 & 1 & 2\n\\end{pmatrix} \\text{ MPa}\n$$\n\nPart 1: Characteristic Equation and Principal Invariants\n\nThe principal stresses, denoted by $\\lambda$, are the eigenvalues of the stress tensor $\\boldsymbol{\\sigma}$. They are the roots of the characteristic equation $\\det(\\boldsymbol{\\sigma} - \\lambda \\boldsymbol{I}) = 0$, where $\\boldsymbol{I}$ is the $3 \\times 3$ identity matrix. For a general $3 \\times 3$ tensor, this equation is a cubic polynomial in $\\lambda$.\n\nIt is a fundamental result of tensor algebra that the characteristic equation can be expressed in terms of the principal invariants $I_1$, $I_2$, and $I_3$ as:\n$$\n\\lambda^3 - I_1 \\lambda^2 + I_2 \\lambda - I_3 = 0\n$$\nThis is known as the secular equation. The invariants are independent of the coordinate system. In a coordinate system aligned with the principal directions, the stress tensor is diagonal with the principal stresses $\\sigma_1, \\sigma_2, \\sigma_3$ as its entries. The invariants can be expressed in terms of these principal stresses as the elementary symmetric polynomials:\n$I_1 = \\sigma_1 + \\sigma_2 + \\sigma_3$\n$I_2 = \\sigma_1 \\sigma_2 + \\sigma_2 \\sigma_3 + \\sigma_3 \\sigma_1$\n$I_3 = \\sigma_1 \\sigma_2 \\sigma_3$\nThe characteristic polynomial in terms of its roots is $(\\lambda - \\sigma_1)(\\lambda - \\sigma_2)(\\lambda - \\sigma_3) = 0$. Expanding this product yields $\\lambda^3 - (\\sigma_1+\\sigma_2+\\sigma_3)\\lambda^2 + (\\sigma_1\\sigma_2+\\sigma_2\\sigma_3+\\sigma_3\\sigma_1)\\lambda - \\sigma_1\\sigma_2\\sigma_3 = 0$, which directly confirms the formulation $\\lambda^3 - I_1 \\lambda^2 + I_2 \\lambda - I_3 = 0$.\n\nWe now compute the invariants for the given tensor $\\boldsymbol{\\sigma}$ using the definitions provided.\nThe first invariant, $I_1$, is the trace of $\\boldsymbol{\\sigma}$:\n$$\nI_1 = \\operatorname{tr}(\\boldsymbol{\\sigma}) = 2 + 2 + 2 = 6\n$$\nThe third invariant, $I_3$, is the determinant of $\\boldsymbol{\\sigma}$:\n$$\nI_3 = \\det(\\boldsymbol{\\sigma}) = 2\\begin{vmatrix} 2 & 1 \\\\ 1 & 2 \\end{vmatrix} - 1\\begin{vmatrix} 1 & 1 \\\\ 0 & 2 \\end{vmatrix} + 0 = 2(4-1) - 1(2-0) = 2(3) - 2 = 4\n$$\nThe second invariant, $I_2$, is given by $I_2 = \\frac{1}{2}[(\\operatorname{tr}\\boldsymbol{\\sigma})^2 - \\operatorname{tr}(\\boldsymbol{\\sigma}^2)]$. First, we compute $\\boldsymbol{\\sigma}^2$:\n$$\n\\boldsymbol{\\sigma}^2 = \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 2 & 1 \\\\ 0 & 1 & 2 \\end{pmatrix} \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 2 & 1 \\\\ 0 & 1 & 2 \\end{pmatrix} = \\begin{pmatrix} 5 & 4 & 1 \\\\ 4 & 6 & 4 \\\\ 1 & 4 & 5 \\end{pmatrix}\n$$\nThe trace of $\\boldsymbol{\\sigma}^2$ is:\n$$\n\\operatorname{tr}(\\boldsymbol{\\sigma}^2) = 5 + 6 + 5 = 16\n$$\nNow we compute $I_2$:\n$$\nI_2 = \\frac{1}{2}[6^2 - 16] = \\frac{1}{2}[36 - 16] = \\frac{20}{2} = 10\n$$\nThus, the principal invariants are $I_1=6$, $I_2=10$, and $I_3=4$.\nThe characteristic equation for the given stress tensor is:\n$$\n\\lambda^3 - 6\\lambda^2 + 10\\lambda - 4 = 0\n$$\n\nPart 2: Principal Stresses\n\nTo find the principal stresses, we must solve the characteristic equation. We test for rational roots, which must be divisors of the constant term $4$. The possible rational roots are $\\pm 1, \\pm 2, \\pm 4$.\nLet $P(\\lambda) = \\lambda^3 - 6\\lambda^2 + 10\\lambda - 4$.\nFor $\\lambda=2$: $P(2) = 2^3 - 6(2^2) + 10(2) - 4 = 8 - 24 + 20 - 4 = 0$.\nSo, $\\lambda_2 = 2$ is a root. We perform polynomial division of $P(\\lambda)$ by $(\\lambda - 2)$:\n$$\n(\\lambda^3 - 6\\lambda^2 + 10\\lambda - 4) \\div (\\lambda - 2) = \\lambda^2 - 4\\lambda + 2\n$$\nThe remaining roots are solutions to the quadratic equation $\\lambda^2 - 4\\lambda + 2 = 0$. Using the quadratic formula:\n$$\n\\lambda = \\frac{-(-4) \\pm \\sqrt{(-4)^2 - 4(1)(2)}}{2(1)} = \\frac{4 \\pm \\sqrt{16-8}}{2} = \\frac{4 \\pm \\sqrt{8}}{2} = \\frac{4 \\pm 2\\sqrt{2}}{2} = 2 \\pm \\sqrt{2}\n$$\nThe three principal stresses, ordered from largest to smallest, are:\n$\\sigma_1 = 2 + \\sqrt{2}$ MPa\n$\\sigma_2 = 2$ MPa\n$\\sigma_3 = 2 - \\sqrt{2}$ MPa\n\nPart 3: Principal Directions\n\nThe principal directions are the normalized eigenvectors corresponding to the principal stresses. We find each eigenvector $\\boldsymbol{v}$ by solving the system $(\\boldsymbol{\\sigma} - \\lambda \\boldsymbol{I})\\boldsymbol{v} = \\boldsymbol{0}$.\n\nFor $\\sigma_1 = 2 + \\sqrt{2}$:\n$$\n(\\boldsymbol{\\sigma} - \\sigma_1 \\boldsymbol{I})\\boldsymbol{v}_1 = \\begin{pmatrix} -\\sqrt{2} & 1 & 0 \\\\ 1 & -\\sqrt{2} & 1 \\\\ 0 & 1 & -\\sqrt{2} \\end{pmatrix} \\begin{pmatrix} v_{11} \\\\ v_{12} \\\\ v_{13} \\end{pmatrix} = \\boldsymbol{0}\n$$\nThis gives the equations: $-\\sqrt{2}v_{11} + v_{12} = 0$ and $v_{12} - \\sqrt{2}v_{13} = 0$.\nFrom these, we deduce $v_{12} = \\sqrt{2}v_{11}$ and $v_{11} = v_{13}$. An unnormalized eigenvector is $\\begin{pmatrix} 1 \\\\ \\sqrt{2} \\\\ 1 \\end{pmatrix}$.\nThe norm is $\\sqrt{1^2 + (\\sqrt{2})^2 + 1^2} = \\sqrt{1+2+1} = \\sqrt{4} = 2$.\nThe normalized principal direction is $\\boldsymbol{n}_1 = \\frac{1}{2} \\begin{pmatrix} 1 \\\\ \\sqrt{2} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{\\sqrt{2}}{2} \\\\ \\frac{1}{2} \\end{pmatrix}$.\n\nFor $\\sigma_2 = 2$:\n$$\n(\\boldsymbol{\\sigma} - \\sigma_2 \\boldsymbol{I})\\boldsymbol{v}_2 = \\begin{pmatrix} 0 & 1 & 0 \\\\ 1 & 0 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} v_{21} \\\\ v_{22} \\\\ v_{23} \\end{pmatrix} = \\boldsymbol{0}\n$$\nThis gives $v_{22} = 0$ and $v_{21} + v_{23} = 0$, so $v_{23} = -v_{21}$. An unnormalized eigenvector is $\\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$.\nThe norm is $\\sqrt{1^2 + 0^2 + (-1)^2} = \\sqrt{2}$.\nThe normalized principal direction is $\\boldsymbol{n}_2 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} \\frac{\\sqrt{2}}{2} \\\\ 0 \\\\ -\\frac{\\sqrt{2}}{2} \\end{pmatrix}$.\n\nFor $\\sigma_3 = 2 - \\sqrt{2}$:\n$$\n(\\boldsymbol{\\sigma} - \\sigma_3 \\boldsymbol{I})\\boldsymbol{v}_3 = \\begin{pmatrix} \\sqrt{2} & 1 & 0 \\\\ 1 & \\sqrt{2} & 1 \\\\ 0 & 1 & \\sqrt{2} \\end{pmatrix} \\begin{pmatrix} v_{31} \\\\ v_{32} \\\\ v_{33} \\end{pmatrix} = \\boldsymbol{0}\n$$\nThis gives $\\sqrt{2}v_{31} + v_{32} = 0$ and $v_{32} + \\sqrt{2}v_{33} = 0$.\nFrom these, we deduce $v_{32} = -\\sqrt{2}v_{31}$ and $v_{31} = v_{33}$. An unnormalized eigenvector is $\\begin{pmatrix} 1 \\\\ -\\sqrt{2} \\\\ 1 \\end{pmatrix}$.\nThe norm is $\\sqrt{1^2 + (-\\sqrt{2})^2 + 1^2} = \\sqrt{1+2+1} = \\sqrt{4} = 2$.\nThe normalized principal direction is $\\boldsymbol{n}_3 = \\frac{1}{2} \\begin{pmatrix} 1 \\\\ -\\sqrt{2} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{\\sqrt{2}}{2} \\\\ \\frac{1}{2} \\end{pmatrix}$.\n\nFinally, we verify orthonormality. The norms have already been shown to be unity. We check orthogonality via dot products:\n$\\boldsymbol{n}_1 \\cdot \\boldsymbol{n}_2 = (\\frac{1}{2})(\\frac{\\sqrt{2}}{2}) + (\\frac{\\sqrt{2}}{2})(0) + (\\frac{1}{2})(-\\frac{\\sqrt{2}}{2}) = \\frac{\\sqrt{2}}{4} - \\frac{\\sqrt{2}}{4} = 0$.\n$\\boldsymbol{n}_1 \\cdot \\boldsymbol{n}_3 = (\\frac{1}{2})(\\frac{1}{2}) + (\\frac{\\sqrt{2}}{2})(-\\frac{\\sqrt{2}}{2}) + (\\frac{1}{2})(\\frac{1}{2}) = \\frac{1}{4} - \\frac{2}{4} + \\frac{1}{4} = 0$.\n$\\boldsymbol{n}_2 \\cdot \\boldsymbol{n}_3 = (\\frac{\\sqrt{2}}{2})(\\frac{1}{2}) + (0)(-\\frac{\\sqrt{2}}{2}) + (-\\frac{\\sqrt{2}}{2})(\\frac{1}{2}) = \\frac{\\sqrt{2}}{4} - \\frac{\\sqrt{2}}{4} = 0$.\nThe principal directions form an orthonormal basis, as expected for a symmetric tensor.", "answer": "$$\n\\boxed{\n  \\begin{pmatrix}\n    2+\\sqrt{2} & 2 & 2-\\sqrt{2} &\n    \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{\\sqrt{2}}{2} \\\\ \\frac{1}{2} \\end{pmatrix} &\n    \\begin{pmatrix} \\frac{\\sqrt{2}}{2} \\\\ 0 \\\\ -\\frac{\\sqrt{2}}{2} \\end{pmatrix} &\n    \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{\\sqrt{2}}{2} \\\\ \\frac{1}{2} \\end{pmatrix}\n  \\end{pmatrix}\n}\n$$", "id": "2603177"}, {"introduction": "While solid mechanics is inherently three-dimensional, many engineering problems can be simplified to two dimensions without significant loss of accuracy. This symbolic derivation [@problem_id:2603132] explores the crucial case of 'plane stress', showing how the general 3D characteristic equation for principal stresses naturally reduces to the familiar 2D formulas. This practice is vital for understanding the theoretical underpinnings of 2D finite element analysis and the assumptions involved.", "problem": "In a two-dimensional plane stress setting within the Finite Element Method (FEM), the three-dimensional Cauchy stress tensor is represented as\n$$\n\\boldsymbol{\\sigma}=\\begin{bmatrix}\n\\sigma_{xx} & \\tau_{xy} & 0 \\\\\n\\tau_{xy} & \\sigma_{yy} & 0 \\\\\n0 & 0 & 0\n\\end{bmatrix}.\n$$\nStarting from the foundational definitions of the principal invariants of a second-order tensor in three dimensions, where the first invariant is the trace, the third invariant is the determinant, and the second invariant is defined via the trace of the square, derive explicit expressions for the three principal invariants of the above tensor in terms of $\\sigma_{xx}$, $\\sigma_{yy}$, and $\\tau_{xy}$. Then, using the characteristic polynomial that links these invariants to the principal stresses (eigenvalues) of the Cauchy stress tensor, demonstrate how the three-dimensional principal stresses reduce to the two in-plane principal stresses together with one zero out-of-plane stress in the plane stress case.\n\nProvide your final answer as a single row matrix containing the three principal stresses expressed symbolically in terms of $\\sigma_{xx}$, $\\sigma_{yy}$, and $\\tau_{xy}$. Do not include units in your final answer. No numerical rounding is required.", "solution": "The posed problem is subjected to validation and is found to be valid. It is a well-posed problem in continuum mechanics, scientifically grounded, and free of ambiguity or contradiction. All necessary information is provided. We proceed with the derivation.\n\nThe problem requires the derivation of the principal invariants and principal stresses for a Cauchy stress tensor under plane stress conditions. The given tensor is:\n$$\n\\boldsymbol{\\sigma}=\\begin{bmatrix}\n\\sigma_{xx} & \\tau_{xy} & 0 \\\\\n\\tau_{xy} & \\sigma_{yy} & 0 \\\\\n0 & 0 & 0\n\\end{bmatrix}\n$$\nThe principal invariants of a second-order tensor in three dimensions ($I_1$, $I_2$, $I_3$) are defined in terms of its components. We will derive the expressions for these invariants for the given stress tensor.\n\nFirst, the first principal invariant, $I_1$, is the trace of the tensor.\n$$\nI_1 = \\mathrm{tr}(\\boldsymbol{\\sigma}) = \\sum_{i=1}^{3} \\sigma_{ii} = \\sigma_{xx} + \\sigma_{yy} + 0\n$$\n$$\nI_1 = \\sigma_{xx} + \\sigma_{yy}\n$$\n\nSecond, the third principal invariant, $I_3$, is the determinant of the tensor.\n$$\nI_3 = \\det(\\boldsymbol{\\sigma}) = \\begin{vmatrix}\n\\sigma_{xx} & \\tau_{xy} & 0 \\\\\n\\tau_{xy} & \\sigma_{yy} & 0 \\\\\n0 & 0 & 0\n\\end{vmatrix}\n$$\nExpanding along the third row (or column) immediately shows that the determinant is zero.\n$$\nI_3 = 0 \\cdot \\begin{vmatrix} \\tau_{xy} & 0 \\\\ \\sigma_{yy} & 0 \\end{vmatrix} - 0 \\cdot \\begin{vmatrix} \\sigma_{xx} & 0 \\\\ \\tau_{xy} & 0 \\end{vmatrix} + 0 \\cdot \\begin{vmatrix} \\sigma_{xx} & \\tau_{xy} \\\\ \\tau_{xy} & \\sigma_{yy} \\end{vmatrix} = 0\n$$\nThus,\n$$\nI_3 = 0\n$$\n\nThird, the second principal invariant, $I_2$, is defined by the relation $I_2 = \\frac{1}{2} \\left[ (\\mathrm{tr}(\\boldsymbol{\\sigma}))^2 - \\mathrm{tr}(\\boldsymbol{\\sigma}^2) \\right]$. We have already computed $\\mathrm{tr}(\\boldsymbol{\\sigma})$. We now compute $\\boldsymbol{\\sigma}^2$.\n$$\n\\boldsymbol{\\sigma}^2 = \\boldsymbol{\\sigma}\\boldsymbol{\\sigma} = \\begin{bmatrix}\n\\sigma_{xx} & \\tau_{xy} & 0 \\\\\n\\tau_{xy} & \\sigma_{yy} & 0 \\\\\n0 & 0 & 0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\sigma_{xx} & \\tau_{xy} & 0 \\\\\n\\tau_{xy} & \\sigma_{yy} & 0 \\\\\n0 & 0 & 0\n\\end{bmatrix}\n$$\n$$\n\\boldsymbol{\\sigma}^2 = \\begin{bmatrix}\n\\sigma_{xx}^2 + \\tau_{xy}^2 & \\sigma_{xx}\\tau_{xy} + \\tau_{xy}\\sigma_{yy} & 0 \\\\\n\\tau_{xy}\\sigma_{xx} + \\sigma_{yy}\\tau_{xy} & \\tau_{xy}^2 + \\sigma_{yy}^2 & 0 \\\\\n0 & 0 & 0\n\\end{bmatrix}\n$$\nThe trace of $\\boldsymbol{\\sigma}^2$ is:\n$$\n\\mathrm{tr}(\\boldsymbol{\\sigma}^2) = (\\sigma_{xx}^2 + \\tau_{xy}^2) + (\\tau_{xy}^2 + \\sigma_{yy}^2) + 0 = \\sigma_{xx}^2 + \\sigma_{yy}^2 + 2\\tau_{xy}^2\n$$\nSubstituting this into the definition of $I_2$:\n$$\nI_2 = \\frac{1}{2} \\left[ (\\sigma_{xx} + \\sigma_{yy})^2 - (\\sigma_{xx}^2 + \\sigma_{yy}^2 + 2\\tau_{xy}^2) \\right]\n$$\n$$\nI_2 = \\frac{1}{2} \\left[ (\\sigma_{xx}^2 + 2\\sigma_{xx}\\sigma_{yy} + \\sigma_{yy}^2) - \\sigma_{xx}^2 - \\sigma_{yy}^2 - 2\\tau_{xy}^2 \\right]\n$$\n$$\nI_2 = \\frac{1}{2} \\left[ 2\\sigma_{xx}\\sigma_{yy} - 2\\tau_{xy}^2 \\right] = \\sigma_{xx}\\sigma_{yy} - \\tau_{xy}^2\n$$\nTo summarize the invariants:\n$$\nI_1 = \\sigma_{xx} + \\sigma_{yy}\n$$\n$$\nI_2 = \\sigma_{xx}\\sigma_{yy} - \\tau_{xy}^2\n$$\n$$\nI_3 = 0\n$$\nThe principal stresses, denoted here as $\\sigma_p$, are the eigenvalues of the stress tensor $\\boldsymbol{\\sigma}$. They are the roots of the characteristic equation $\\det(\\boldsymbol{\\sigma} - \\sigma_p \\mathbf{I}) = 0$, where $\\mathbf{I}$ is the identity tensor. This equation can be expressed in terms of the principal invariants as:\n$$\n\\sigma_p^3 - I_1 \\sigma_p^2 + I_2 \\sigma_p - I_3 = 0\n$$\nSubstituting the derived invariants for the plane stress case:\n$$\n\\sigma_p^3 - (\\sigma_{xx} + \\sigma_{yy})\\sigma_p^2 + (\\sigma_{xx}\\sigma_{yy} - \\tau_{xy}^2)\\sigma_p - 0 = 0\n$$\n$$\n\\sigma_p \\left[ \\sigma_p^2 - (\\sigma_{xx} + \\sigma_{yy})\\sigma_p + (\\sigma_{xx}\\sigma_{yy} - \\tau_{xy}^2) \\right] = 0\n$$\nThis cubic equation has three roots for $\\sigma_p$. One root is immediately apparent:\n$$\n\\sigma_{p3} = 0\n$$\nThis demonstrates that one of the three-dimensional principal stresses is zero, corresponding to the stress perpendicular to the plane of analysis, as is definitional for plane stress.\nThe other two principal stresses, which we will denote $\\sigma_{p1}$ and $\\sigma_{p2}$, are the roots of the quadratic equation remaining in the brackets:\n$$\n\\sigma_p^2 - (\\sigma_{xx} + \\sigma_{yy})\\sigma_p + (\\sigma_{xx}\\sigma_{yy} - \\tau_{xy}^2) = 0\n$$\nWe solve this using the quadratic formula, $\\sigma_p = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, where $a=1$, $b=-(\\sigma_{xx} + \\sigma_{yy})$, and $c=(\\sigma_{xx}\\sigma_{yy} - \\tau_{xy}^2)$.\n$$\n\\sigma_{p1,2} = \\frac{(\\sigma_{xx} + \\sigma_{yy}) \\pm \\sqrt{(-(\\sigma_{xx} + \\sigma_{yy}))^2 - 4(1)(\\sigma_{xx}\\sigma_{yy} - \\tau_{xy}^2)}}{2}\n$$\nLet us simplify the discriminant (the term under the square root):\n$$\n\\Delta = (\\sigma_{xx} + \\sigma_{yy})^2 - 4\\sigma_{xx}\\sigma_{yy} + 4\\tau_{xy}^2\n$$\n$$\n\\Delta = (\\sigma_{xx}^2 + 2\\sigma_{xx}\\sigma_{yy} + \\sigma_{yy}^2) - 4\\sigma_{xx}\\sigma_{yy} + 4\\tau_{xy}^2\n$$\n$$\n\\Delta = \\sigma_{xx}^2 - 2\\sigma_{xx}\\sigma_{yy} + \\sigma_{yy}^2 + 4\\tau_{xy}^2 = (\\sigma_{xx} - \\sigma_{yy})^2 + (2\\tau_{xy})^2\n$$\nSubstituting this back into the solution for $\\sigma_{p1,2}$:\n$$\n\\sigma_{p1,2} = \\frac{(\\sigma_{xx} + \\sigma_{yy}) \\pm \\sqrt{(\\sigma_{xx} - \\sigma_{yy})^2 + 4\\tau_{xy}^2}}{2}\n$$\nThis expression is commonly written as:\n$$\n\\sigma_{p1,2} = \\frac{\\sigma_{xx} + \\sigma_{yy}}{2} \\pm \\sqrt{\\left(\\frac{\\sigma_{xx} - \\sigma_{yy}}{2}\\right)^2 + \\tau_{xy}^2}\n$$\nTherefore, the three principal stresses are the two in-plane principal stresses, $\\sigma_{p1}$ and $\\sigma_{p2}$, and the zero out-of-plane principal stress, $\\sigma_{p3}$. The expressions for these three stresses are provided in the final answer.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sigma_{xx} + \\sigma_{yy}}{2} + \\sqrt{\\left(\\frac{\\sigma_{xx} - \\sigma_{yy}}{2}\\right)^2 + \\tau_{xy}^2} & \\frac{\\sigma_{xx} + \\sigma_{yy}}{2} - \\sqrt{\\left(\\frac{\\sigma_{xx} - \\sigma_{yy}}{2}\\right)^2 + \\tau_{xy}^2} & 0\n\\end{pmatrix}\n}\n$$", "id": "2603132"}, {"introduction": "Advanced material models, particularly in plasticity, are built upon the derivatives of stress invariants like an invariant $I_1$ or $J_2$. This hands-on coding exercise [@problem_id:2603149] takes you from theoretical tensor calculus to practical code verification, a crucial step in computational mechanics. You will derive the analytical gradients of important invariants and then validate them against a numerical approximation, mirroring the rigorous process used to develop and debug production-level finite element software.", "problem": "You are given the task of validating analytical gradients of scalar stress invariants with respect to the six independent components of a symmetric Cauchy stress tensor. Work in three spatial dimensions with second-order tensors represented as real, symmetric, $3 \\times 3$ matrices. All quantities are dimensionless.\n\nStart from the following fundamental definitions:\n\n- The Cauchy stress tensor is denoted by $\\boldsymbol{\\sigma} \\in \\mathbb{R}^{3 \\times 3}$ and is symmetric.\n- The first invariant is $I_1 = \\mathrm{tr}(\\boldsymbol{\\sigma})$.\n- The deviatoric part of $\\boldsymbol{\\sigma}$ is $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3} I_1 \\boldsymbol{I}$, where $\\boldsymbol{I}$ is the identity tensor.\n- The second invariant of the deviator is $J_2 = \\tfrac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}$, where $:$ denotes the double contraction.\n- The von Mises equivalent stress is $\\sigma_{\\mathrm{eq}} = \\sqrt{3 J_2}$.\n\nYour goal is to:\n\n1. Derive, from first principles and the above definitions only, analytical expressions for the gradients $\\dfrac{\\partial I_1}{\\partial \\boldsymbol{\\sigma}}$, $\\dfrac{\\partial J_2}{\\partial \\boldsymbol{\\sigma}}$, and $\\dfrac{\\partial \\sigma_{\\mathrm{eq}}}{\\partial \\boldsymbol{\\sigma}}$.\n2. Define the gradient with respect to the six independent components $(\\sigma_{xx},\\sigma_{yy},\\sigma_{zz},\\sigma_{xy},\\sigma_{xz},\\sigma_{yz})$ as follows. For a scalar function $f(\\boldsymbol{\\sigma})$, denote $\\boldsymbol{G} = \\dfrac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ as the tensor such that $\\mathrm{d}f = \\boldsymbol{G} : \\mathrm{d}\\boldsymbol{\\sigma}$ for any perturbation $\\mathrm{d}\\boldsymbol{\\sigma}$. Then the six-component gradient vector is:\n$$\n\\boldsymbol{g}(f) = \\big[ G_{xx},\\; G_{yy},\\; G_{zz},\\; 2 G_{xy},\\; 2 G_{xz},\\; 2 G_{yz} \\big],\n$$\nwhich corresponds to symmetric perturbations of the off-diagonal components (i.e., $\\mathrm{d}\\sigma_{ij} = \\mathrm{d}\\sigma_{ji}$ for $i \\neq j$).\n3. Validate your analytical gradients against numerical central-difference approximations computed by perturbing each of the six independent components. Use a step size $h = 10^{-6} \\max\\{1, \\|\\boldsymbol{\\sigma}\\|_F\\}$, where $\\|\\cdot\\|_F$ is the Frobenius norm. For off-diagonal components, perturb both symmetric entries by $\\pm h$ simultaneously.\n4. For $\\sigma_{\\mathrm{eq}}$, adopt the convention that if $J_2 = 0$, then $\\dfrac{\\partial \\sigma_{\\mathrm{eq}}}{\\partial \\boldsymbol{\\sigma}}$ is taken to be the zero tensor. Note that a symmetric central difference around a purely hydrostatic state yields a near-zero numerical gradient for $\\sigma_{\\mathrm{eq}}$.\n\nNumerical validation specification:\n\n- For each invariant $f \\in \\{I_1, J_2, \\sigma_{\\mathrm{eq}}\\}$ and each test case, compute the maximum absolute difference between the analytical and numerical six-component gradients, and report a boolean pass/fail using the criterion\n$$\n\\max_i |g_i^{\\text{analytical}} - g_i^{\\text{FD}}| \\le \\text{atol} + \\text{rtol} \\cdot \\max\\{1, \\max_i |g_i^{\\text{analytical}}|\\},\n$$\nwith absolute tolerance $\\text{atol} = 10^{-8}$ and relative tolerance $\\text{rtol} = 5 \\times 10^{-6}$.\n\nTest suite (use exactly these four symmetric Cauchy stress tensors):\n\n- Case A (general, mixed state):\n$$\n\\boldsymbol{\\sigma}_{A} =\n\\begin{bmatrix}\n120.5 & -35.2 & 12.0 \\\\\n-35.2 & 80.3 & 22.7 \\\\\n12.0 & 22.7 & -45.8\n\\end{bmatrix}.\n$$\n\n- Case B (pure hydrostatic):\n$$\n\\boldsymbol{\\sigma}_{B} = 50\n\\begin{bmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{bmatrix}.\n$$\n\n- Case C (pure shear in the $xy$ plane):\n$$\n\\boldsymbol{\\sigma}_{C} =\n\\begin{bmatrix}\n0 & 75 & 0 \\\\\n75 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{bmatrix}.\n$$\n\n- Case D (nearly hydrostatic with tiny deviatoric part):\n$$\n\\boldsymbol{\\sigma}_{D} = 50\n\\begin{bmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{bmatrix}\n+\n10^{-8}\n\\begin{bmatrix}\n2 & 1 & -1 \\\\\n1 & -1 & 2 \\\\\n-1 & 2 & -1\n\\end{bmatrix}.\n$$\n\nRequired program behavior:\n\n- Implement the analytical gradients based solely on the definitions stated above.\n- Implement central-difference numerical gradients with symmetric perturbations for off-diagonals.\n- For each case and each invariant $(I_1, J_2, \\sigma_{\\mathrm{eq}})$, append a boolean indicating whether the validation criterion passes.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order:\n  [CaseA_I1, CaseA_J2, CaseA_sigmaeq, CaseB_I1, CaseB_J2, CaseB_sigmaeq, CaseC_I1, CaseC_J2, CaseC_sigmaeq, CaseD_I1, CaseD_J2, CaseD_sigmaeq].", "solution": "The problem posed is a well-defined and standard task in continuum mechanics, specifically in the context of material modeling for finite element analysis. It requires the derivation of analytical gradients for common stress invariants and subsequent validation against a numerical approximation. All provided definitions and constraints are scientifically sound and internally consistent. The problem is valid.\n\nThe solution proceeds in two stages: first, the analytical derivation of the gradients from first principles, and second, the design of a numerical validation procedure.\n\n**1. Analytical Derivation of Gradients**\n\nWe are asked to find the gradient of the scalar functions $f(\\boldsymbol{\\sigma})$ of the symmetric Cauchy stress tensor $\\boldsymbol{\\sigma}$. The gradient is defined as the tensor $\\boldsymbol{G} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ satisfying the relation $\\mathrm{d}f = \\boldsymbol{G} : \\mathrm{d}\\boldsymbol{\\sigma}$, where $:$ denotes the double contraction, i.e., $A_{ij}B_{ij}$. We use indicial notation with the Einstein summation convention.\n\n**1.1. Gradient of the First Invariant, $I_1$**\n\nThe first invariant is the trace of the stress tensor: $I_1 = \\mathrm{tr}(\\boldsymbol{\\sigma}) = \\sigma_{kk}$.\nIts differential is $\\mathrm{d}I_1 = \\mathrm{d}(\\sigma_{kk}) = \\delta_{ij} \\mathrm{d}\\sigma_{ij}$.\nIn tensor notation, this is $\\mathrm{d}I_1 = \\boldsymbol{I} : \\mathrm{d}\\boldsymbol{\\sigma}$, where $\\boldsymbol{I}$ is the second-order identity tensor.\nBy comparing this with the definition $\\mathrm{d}I_1 = \\frac{\\partial I_1}{\\partial \\boldsymbol{\\sigma}} : \\mathrm{d}\\boldsymbol{\\sigma}$, we identify the gradient as:\n$$\n\\frac{\\partial I_1}{\\partial \\boldsymbol{\\sigma}} = \\boldsymbol{I}\n$$\n\n**1.2. Gradient of the Second Deviatoric Invariant, $J_2$**\n\nThe second invariant of the deviatoric stress is $J_2 = \\frac{1}{2} \\boldsymbol{s}:\\boldsymbol{s} = \\frac{1}{2} s_{ij}s_{ij}$, where $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}I_1\\boldsymbol{I}$.\nThe differential of $J_2$ is found using the product rule: $\\mathrm{d}J_2 = s_{ij} \\mathrm{d}s_{ij}$.\nThe differential of the deviatoric stress component $s_{ij}$ is:\n$$\n\\mathrm{d}s_{ij} = \\mathrm{d}\\left(\\sigma_{ij} - \\frac{1}{3}\\sigma_{kk}\\delta_{ij}\\right) = \\mathrm{d}\\sigma_{ij} - \\frac{1}{3}(\\mathrm{d}\\sigma_{kk})\\delta_{ij} = \\mathrm{d}\\sigma_{ij} - \\frac{1}{3}(\\mathrm{d}\\boldsymbol{\\sigma} : \\boldsymbol{I})\\delta_{ij}\n$$\nSubstituting this into the expression for $\\mathrm{d}J_2$:\n$$\n\\mathrm{d}J_2 = s_{ij}\\left(\\mathrm{d}\\sigma_{ij} - \\frac{1}{3}(\\mathrm{d}\\sigma_{kk})\\delta_{ij}\\right) = s_{ij}\\mathrm{d}\\sigma_{ij} - \\frac{1}{3}s_{ij}\\delta_{ij}(\\mathrm{d}\\sigma_{kk})\n$$\nThe term $s_{ij}\\delta_{ij}$ is the trace of the deviatoric stress, $\\mathrm{tr}(\\boldsymbol{s}) = \\mathrm{tr}(\\boldsymbol{\\sigma} - \\frac{1}{3}I_1\\boldsymbol{I}) = \\mathrm{tr}(\\boldsymbol{\\sigma}) - \\frac{1}{3}I_1\\mathrm{tr}(\\boldsymbol{I}) = I_1 - \\frac{1}{3}I_1(3) = 0$.\nTherefore, the second term vanishes, and we are left with $\\mathrm{d}J_2 = s_{ij}\\mathrm{d}\\sigma_{ij} = \\boldsymbol{s}:\\mathrm{d}\\boldsymbol{\\sigma}$.\nComparing with the definition $\\mathrm{d}J_2 = \\frac{\\partial J_2}{\\partial \\boldsymbol{\\sigma}} : \\mathrm{d}\\boldsymbol{\\sigma}$, we find:\n$$\n\\frac{\\partial J_2}{\\partial \\boldsymbol{\\sigma}} = \\boldsymbol{s}\n$$\n\n**1.3. Gradient of the Von Mises Equivalent Stress, $\\sigma_{\\mathrm{eq}}$**\n\nThe von Mises stress is $\\sigma_{\\mathrm{eq}} = \\sqrt{3 J_2}$. We apply the chain rule for differentiation.\nFor $J_2 > 0$, and thus $\\sigma_{\\mathrm{eq}} > 0$:\n$$\n\\frac{\\partial \\sigma_{\\mathrm{eq}}}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial \\sigma_{\\mathrm{eq}}}{\\partial J_2} \\frac{\\partial J_2}{\\partial \\boldsymbol{\\sigma}}\n$$\nThe scalar derivative is $\\frac{\\partial \\sigma_{\\mathrm{eq}}}{\\partial J_2} = \\frac{\\mathrm{d}}{\\mathrm{d}J_2}(3J_2)^{1/2} = \\frac{1}{2}(3J_2)^{-1/2} \\cdot 3 = \\frac{3}{2 \\sqrt{3J_2}} = \\frac{3}{2 \\sigma_{\\mathrm{eq}}}$.\nSubstituting this and the gradient of $J_2$ gives:\n$$\n\\frac{\\partial \\sigma_{\\mathrm{eq}}}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2 \\sigma_{\\mathrm{eq}}} \\boldsymbol{s} \\quad (\\text{for } \\sigma_{\\mathrm{eq}} > 0)\n$$\nFor hydrostatic stress states, $J_2 = 0$ and $\\boldsymbol{s}=\\boldsymbol{0}$. The expression becomes an indeterminate form $0/0$. The problem provides the standard convention for this singularity:\n$$\n\\frac{\\partial \\sigma_{\\mathrm{eq}}}{\\partial \\boldsymbol{\\sigma}} = \\boldsymbol{0} \\quad (\\text{for } \\sigma_{\\mathrm{eq}} = 0)\n$$\n\n**2. Six-Component Gradient Vector**\n\nThe problem defines a six-component gradient vector $\\boldsymbol{g}(f)$ derived from the tensor gradient $\\boldsymbol{G} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ as $\\boldsymbol{g}(f) = [ G_{xx}, G_{yy}, G_{zz}, 2G_{xy}, 2G_{xz}, 2G_{yz} ]$. This relates the differential $\\mathrm{d}f$ to the perturbations in the six independent components of $\\boldsymbol{\\sigma}$.\n\nUsing the analytical tensor gradients derived above, we obtain the following vector expressions:\n\n- For $f=I_1$, $\\boldsymbol{G} = \\boldsymbol{I}$. The components are $G_{11}=G_{22}=G_{33}=1$ and $G_{ij}=0$ for $i \\ne j$.\n  $$\n  \\boldsymbol{g}(I_1) = [1, 1, 1, 0, 0, 0]\n  $$\n- For $f=J_2$, $\\boldsymbol{G} = \\boldsymbol{s}$. The components are $G_{ij} = s_{ij}$.\n  $$\n  \\boldsymbol{g}(J_2) = [s_{xx}, s_{yy}, s_{zz}, 2s_{xy}, 2s_{xz}, 2s_{yz}]\n  $$\n- For $f=\\sigma_{\\mathrm{eq}}$, $\\boldsymbol{G} = \\frac{3}{2 \\sigma_{\\mathrm{eq}}} \\boldsymbol{s}$ (if $\\sigma_{\\mathrm{eq}}>0$), and $\\boldsymbol{G}=\\boldsymbol{0}$ otherwise.\n  $$\n  \\boldsymbol{g}(\\sigma_{\\mathrm{eq}}) = \\frac{3}{2 \\sigma_{\\mathrm{eq}}} [s_{xx}, s_{yy}, s_{zz}, 2s_{xy}, 2s_{xz}, 2s_{yz}] = \\frac{3}{2 \\sigma_{\\mathrm{eq}}} \\boldsymbol{g}(J_2) \\quad (\\text{for } \\sigma_{\\mathrm{eq}} > 0)\n  $$\n  If $\\sigma_{\\mathrm{eq}}=0$, then $\\boldsymbol{g}(\\sigma_{\\mathrm{eq}}) = [0, 0, 0, 0, 0, 0]$.\n\n**3. Numerical Validation Procedure**\n\nTo validate these analytical expressions, we compute a numerical gradient using the central finite difference method. The $k$-th component of the gradient vector $\\boldsymbol{g}(f)$ is approximated as:\n$$\ng_k^{\\text{FD}} = \\frac{f(\\boldsymbol{\\sigma}_k^+) - f(\\boldsymbol{\\sigma}_k^-)}{2h}\n$$\nHere, $h = 10^{-6} \\max\\{1, \\|\\boldsymbol{\\sigma}\\|_F\\}$ is the perturbation step size. The tensors $\\boldsymbol{\\sigma}_k^{\\pm}$ are the stress tensor perturbed in its $k$-th independent component. The six independent components are ordered as $(\\sigma_{xx}, \\sigma_{yy}, \\sigma_{zz}, \\sigma_{xy}, \\sigma_{xz}, \\sigma_{yz})$.\n\n- For a diagonal component (e.g., $\\sigma_{xx}$, $k=1$): The perturbation is applied only to that component. For instance, $\\boldsymbol{\\sigma}_1^{\\pm} = \\boldsymbol{\\sigma} \\pm h \\boldsymbol{E}_{11}$, where $\\boldsymbol{E}_{11}$ is a matrix with $1$ at the $(1,1)$ position and zeros elsewhere.\n- For an off-diagonal component (e.g., $\\sigma_{xy}$, $k=4$): To maintain the symmetry of the stress tensor, both $\\sigma_{xy}$ and $\\sigma_{yx}$ must be perturbed simultaneously. Thus, the perturbation is $\\boldsymbol{\\sigma}_4^{\\pm} = \\boldsymbol{\\sigma} \\pm h(\\boldsymbol{E}_{12} + \\boldsymbol{E}_{21})$.\n\nThe final validation is performed by comparing the analytical gradient vector $\\boldsymbol{g}^{\\text{analytical}}$ with the numerical one $\\boldsymbol{g}^{\\text{FD}}$ using the specified tolerance criterion:\n$$\n\\max_k |g_k^{\\text{analytical}} - g_k^{\\text{FD}}| \\le \\mathrm{atol} + \\mathrm{rtol} \\cdot \\max\\{1, \\max_k |g_k^{\\text{analytical}}|\\}\n$$\nwith $\\mathrm{atol} = 10^{-8}$ and $\\mathrm{rtol} = 5 \\times 10^{-6}$. A boolean result (pass/fail) is reported for each invariant and each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to derive, validate, and report on stress invariant gradients.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: General, mixed state\n        np.array([\n            [120.5, -35.2, 12.0],\n            [-35.2, 80.3, 22.7],\n            [12.0, 22.7, -45.8]\n        ]),\n        # Case B: Pure hydrostatic\n        np.array([\n            [50.0, 0.0, 0.0],\n            [0.0, 50.0, 0.0],\n            [0.0, 0.0, 50.0]\n        ]),\n        # Case C: Pure shear in the xy plane\n        np.array([\n            [0.0, 75.0, 0.0],\n            [75.0, 0.0, 0.0],\n            [0.0, 0.0, 0.0]\n        ]),\n        # Case D: Nearly hydrostatic with tiny deviatoric part\n        50.0 * np.eye(3) + 1e-8 * np.array([\n            [2.0, 1.0, -1.0],\n            [1.0, -1.0, 2.0],\n            [-1.0, 2.0, -1.0]\n        ])\n    ]\n\n    def calculate_invariants(sigma):\n        \"\"\"Calculates scalar invariants for a given stress tensor.\"\"\"\n        i1 = np.trace(sigma)\n        s = sigma - (i1 / 3.0) * np.eye(3)\n        j2 = 0.5 * np.sum(s * s)\n        # Ensure non-negative argument for sqrt due to potential floating point errors\n        sigma_eq = np.sqrt(max(0.0, 3.0 * j2))\n        return i1, j2, sigma_eq, s\n\n    def get_analytical_gradients(sigma):\n        \"\"\"Calculates the 6-component analytical gradients.\"\"\"\n        _, _, sigma_eq, s = calculate_invariants(sigma)\n\n        # Gradient of I1\n        g_i1 = np.array([1.0, 1.0, 1.0, 0.0, 0.0, 0.0])\n\n        # Gradient of J2\n        g_j2 = np.array([\n            s[0, 0], s[1, 1], s[2, 2],\n            2 * s[0, 1], 2 * s[0, 2], 2 * s[1, 2]\n        ])\n\n        # Gradient of sigma_eq\n        if sigma_eq  1e-14:  # Convention for J2 = 0 case\n            g_sigma_eq = np.zeros(6)\n        else:\n            g_sigma_eq = (3.0 / (2.0 * sigma_eq)) * g_j2\n        \n        return g_i1, g_j2, g_sigma_eq\n\n    def get_numerical_gradients(sigma, h):\n        \"\"\"Calculates the 6-component numerical gradients via central differences.\"\"\"\n        g_num_i1 = np.zeros(6)\n        g_num_j2 = np.zeros(6)\n        g_num_sigma_eq = np.zeros(6)\n        \n        idx_map = [(0, 0), (1, 1), (2, 2), (0, 1), (0, 2), (1, 2)]\n\n        for i in range(6):\n            p_mat = np.zeros((3, 3))\n            r, c = idx_map[i]\n            \n            p_mat[r, c] += h\n            if r != c:  # Symmetric perturbation for off-diagonals\n                p_mat[c, r] += h\n\n            sigma_p = sigma + p_mat\n            sigma_m = sigma - p_mat\n\n            i1_p, j2_p, sigma_eq_p, _ = calculate_invariants(sigma_p)\n            i1_m, j2_m, sigma_eq_m, _ = calculate_invariants(sigma_m)\n            \n            # Central difference formula\n            g_num_i1[i] = (i1_p - i1_m) / (2.0 * h)\n            g_num_j2[i] = (j2_p - j2_m) / (2.0 * h)\n            g_num_sigma_eq[i] = (sigma_eq_p - sigma_eq_m) / (2.0 * h)\n        \n        return g_num_i1, g_num_j2, g_num_sigma_eq\n\n    def validate(g_ana, g_num, atol, rtol):\n        \"\"\"Validates analytical against numerical gradient based on given tolerances.\"\"\"\n        max_abs_g_ana = max(1.0, np.max(np.abs(g_ana)))\n        tolerance = atol + rtol * max_abs_g_ana\n        max_diff = np.max(np.abs(g_ana - g_num))\n        return max_diff = tolerance\n\n    atol = 1e-8\n    rtol = 5e-6\n    results = []\n\n    for sigma in test_cases:\n        # Calculate step size h\n        norm_sigma = np.linalg.norm(sigma, 'fro')\n        h = 1e-6 * max(1.0, norm_sigma)\n\n        # Get analytical gradients\n        g_ana_i1, g_ana_j2, g_ana_sigma_eq = get_analytical_gradients(sigma)\n        \n        # Get numerical gradients\n        g_num_i1, g_num_j2, g_num_sigma_eq = get_numerical_gradients(sigma, h)\n\n        # Validate and append results\n        results.append(validate(g_ana_i1, g_num_i1, atol, rtol))\n        results.append(validate(g_ana_j2, g_num_j2, atol, rtol))\n        results.append(validate(g_ana_sigma_eq, g_num_sigma_eq, atol, rtol))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r) for r in results).replace('True', 'true').replace('False', 'false')}]\")\n\nsolve()\n```", "id": "2603149"}]}