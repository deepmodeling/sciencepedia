{"hands_on_practices": [{"introduction": "Before we can decompose a signal, we must rigorously understand the target of the decomposition: the Intrinsic Mode Function (IMF). This exercise challenges you to apply the two formal criteria of an IMF to a signal composed of two harmonics. By working through the fundamental definitions, you will determine if this composite signal can itself be an IMF, providing critical insight into the phenomenon of mode mixing and the precise, sometimes non-intuitive, nature of the EMD framework.", "problem": "Consider the real-valued signal $x(t)=\\cos\\!\\big(2\\pi f t\\big)+0.2\\,\\cos\\!\\big(2\\pi\\cdot 3 f\\, t\\big)$ with $f>0$. According to the definition used in Empirical Mode Decomposition (EMD), a component is an Intrinsic Mode Function (IMF) if it satisfies two criteria everywhere: (i) the numbers of local extrema and of zero crossings differ at most by one, and (ii) the local mean, defined as the pointwise average of the spline-interpolated upper envelope through local maxima and lower envelope through local minima, is identically zero.\n\nUsing only fundamental definitions, basic differentiation, and standard trigonometric identities, do the following over one fundamental period $T_{0}=1/f$ of $x(t)$:\n- Determine the numbers of zero crossings and local extrema of $x(t)$ and compare them.\n- Determine the upper and lower envelopes implied by the local maxima and minima and form their pointwise mean $m(t)$.\n\nDefine the scalar quantity\n$$D \\;=\\; \\max_{t\\in[0,T_{0}]} \\big|m(t)\\big|.$$\nReport the value of $D$ as your final answer. No rounding is required. The final answer is dimensionless; do not include units. Your reasoning must justify whether $x(t)$ itself qualifies as an Intrinsic Mode Function (IMF) based on the two criteria above, starting from these definitions without invoking any unproven shortcut formulas.", "solution": "The problem statement is scientifically grounded and mathematically well-posed. We shall proceed with a direct analysis based on the provided definitions.\n\nThe signal under consideration is given by\n$$x(t) = \\cos(2\\pi f t) + 0.2 \\cos(2\\pi \\cdot 3 f t)$$\nwhere the frequency $f$ is a positive constant. The analysis is to be conducted over one fundamental period $T_{0} = 1/f$. For analytical convenience, we introduce a normalized time variable $\\tau = 2\\pi f t$. As $t$ spans the interval $[0, T_{0}]$, $\\tau$ spans the interval $[0, 2\\pi]$. In terms of $\\tau$, the signal is expressed as\n$$x(\\tau) = \\cos(\\tau) + 0.2 \\cos(3\\tau)$$\nWe will analyze this function over the interval $\\tau \\in [0, 2\\pi)$.\n\nFirst, we address the two criteria for a function to be an Intrinsic Mode Function (IMF).\n\nCriterion (i): The numbers of local extrema and of zero crossings must differ at most by one.\n\nTo find the zero crossings, we set $x(\\tau)=0$:\n$$\\cos(\\tau) + 0.2 \\cos(3\\tau) = 0$$\nUsing the triple-angle identity $\\cos(3\\tau) = 4\\cos^{3}(\\tau) - 3\\cos(\\tau)$, we obtain\n$$\\cos(\\tau) + 0.2 (4\\cos^{3}(\\tau) - 3\\cos(\\tau)) = 0$$\n$$\\cos(\\tau) + 0.8\\cos^{3}(\\tau) - 0.6\\cos(\\tau) = 0$$\n$$0.8\\cos^{3}(\\tau) + 0.4\\cos(\\tau) = 0$$\n$$0.4\\cos(\\tau) (2\\cos^{2}(\\tau) + 1) = 0$$\nThe term $2\\cos^{2}(\\tau) + 1$ is strictly positive for all real $\\tau$, as its value lies in the range $[1, 3]$. Therefore, the only real solutions arise from $\\cos(\\tau) = 0$. In the interval $[0, 2\\pi)$, this occurs at $\\tau = \\pi/2$ and $\\tau = 3\\pi/2$. Thus, there are exactly $2$ zero crossings in one fundamental period.\n\nTo find the local extrema, we must find the roots of the first derivative, $x'(\\tau) = \\frac{dx}{d\\tau}$, and check the sign of the second derivative.\n$$x'(\\tau) = -\\sin(\\tau) - 0.2 \\cdot 3 \\sin(3\\tau) = -\\sin(\\tau) - 0.6 \\sin(3\\tau)$$\nSetting $x'(\\tau) = 0$:\n$$\\sin(\\tau) + 0.6 \\sin(3\\tau) = 0$$\nUsing the identity $\\sin(3\\tau) = 3\\sin(\\tau) - 4\\sin^{3}(\\tau)$:\n$$\\sin(\\tau) + 0.6(3\\sin(\\tau) - 4\\sin^{3}(\\tau)) = 0$$\n$$\\sin(\\tau) + 1.8\\sin(\\tau) - 2.4\\sin^{3}(\\tau) = 0$$\n$$2.8\\sin(\\tau) - 2.4\\sin^{3}(\\tau) = 0$$\n$$\\sin(\\tau) (2.8 - 2.4\\sin^{2}(\\tau)) = 0$$\nThis equation yields two possibilities: $\\sin(\\tau) = 0$ or $2.8 - 2.4\\sin^{2}(\\tau) = 0$.\nCase 1: $\\sin(\\tau) = 0$. In the interval $[0, 2\\pi)$, this occurs at $\\tau=0$ and $\\tau=\\pi$.\nCase 2: $\\sin^{2}(\\tau) = \\frac{2.8}{2.4} = \\frac{7}{6}$. Since $\\sin^{2}(\\tau)$ cannot exceed $1$, this case yields no real solutions.\nThus, the only critical points are $\\tau=0$ and $\\tau=\\pi$.\n\nTo classify these extrema, we examine the second derivative:\n$$x''(\\tau) = -\\cos(\\tau) - 1.8\\cos(3\\tau)$$\nAt $\\tau=0$: $x''(0) = -\\cos(0) - 1.8\\cos(0) = -1 - 1.8 = -2.8 < 0$. This indicates a local maximum.\nAt $\\tau=\\pi$: $x''(\\pi) = -\\cos(\\pi) - 1.8\\cos(3\\pi) = -(-1) - 1.8(-1) = 1 + 1.8 = 2.8 > 0$. This indicates a local minimum.\nIn one period $[0, T_{0})$, there is one local maximum (at $t=0$) and one local minimum (at $t=T_{0}/2$), for a total of $2$ local extrema.\n\nThe number of zero crossings is $2$ and the number of local extrema is $2$. Their difference is $2-2=0$, which satisfies the condition of being at most $1$. Criterion (i) is satisfied.\n\nCriterion (ii): The local mean $m(t)$ must be identically zero.\n\nThe local mean $m(t)$ is the pointwise average of the upper and lower envelopes. The upper envelope, $e_{upper}(t)$, is a spline function interpolating the local maxima. The lower envelope, $e_{lower}(t)$, interpolates the local minima.\nThe local maxima occur at $t = k T_{0}$ for any integer $k$. The value of the signal at these points is\n$$x(kT_{0}) = \\cos(2\\pi k) + 0.2 \\cos(6\\pi k) = 1 + 0.2(1) = 1.2$$\nThe local minima occur at $t = (k + 1/2) T_{0}$. The value of the signal at these points is\n$$x((k+1/2)T_{0}) = \\cos(\\pi(2k+1)) + 0.2 \\cos(3\\pi(2k+1)) = -1 + 0.2(-1) = -1.2$$\nThe upper envelope must pass through the points $(..., -T_{0}, 1.2), (0, 1.2), (T_{0}, 1.2), ...$. The signal's derivative is zero at these points. A spline (specifically a cubic Hermite spline) that interpolates these points with zero-derivative constraints is uniquely the constant function $e_{upper}(t) = 1.2$.\nSimilarly, the lower envelope must pass through the points $(..., -T_{0}/2, -1.2), (T_{0}/2, -1.2), (3T_{0}/2, -1.2), ...)$ with zero derivatives. This forces the lower envelope to be the constant function $e_{lower}(t) = -1.2$.\n\nThe local mean $m(t)$ is then calculated as:\n$$m(t) = \\frac{e_{upper}(t) + e_{lower}(t)}{2} = \\frac{1.2 + (-1.2)}{2} = \\frac{0}{2} = 0$$\nThe local mean is identically zero for all $t$. Therefore, criterion (ii) is also satisfied.\n\nSince both criteria are met, the signal $x(t)$ itself qualifies as an Intrinsic Mode Function according to the provided definition.\n\nThe final task is to compute the scalar quantity $D$:\n$$D = \\max_{t\\in[0,T_{0}]} |m(t)|$$\nAs we have established that $m(t) = 0$ for all $t$, the maximum of its absolute value is also $0$.\n$$D = \\max_{t\\in[0,T_{0}]} |0| = 0$$\nThis result demonstrates a known limitation of the EMD algorithm, often termed mode mixing, where multiple oscillatory components are not separated but are instead treated as a single IMF because the composite signal happens to satisfy the formal IMF criteria.", "answer": "$$\\boxed{0}$$", "id": "2869017"}, {"introduction": "The Empirical Mode Decomposition (EMD) algorithm is designed to sequentially \"sift\" a signal, peeling off IMFs from the highest frequency to the lowest. This thought experiment strips the sifting process down to its essential logic, allowing you to reason from first principles about its behavior. By analyzing a two-component signal under idealized conditions, you will predict the outcome of the decomposition and grasp why EMD is fundamentally an adaptive, scale-separating tool.", "problem": "Consider the continuous-time signal defined by $x(t)=\\cos(2\\pi f_1 t)+\\cos(2\\pi f_2 t)$ with strictly positive frequencies $f_1$ and $f_2$ satisfying $f_2/f_1=5$. Assume the Empirical Mode Decomposition (EMD) is applied in the idealized sense: upper and lower envelopes are constructed by perfect interpolation through the true local maxima and minima, the mean envelope is their pointwise average, the Intrinsic Mode Function (IMF) conditions are enforced exactly, and end effects are negligible. The Intrinsic Mode Function (IMF) conditions are that the number of zero-crossings and extrema differ at most by one and that the mean of the upper and lower envelopes is identically zero. Assume the sifting process is iterated to convergence for each IMF.\n\nUsing only the core definitions of EMD and IMF and the notion of envelope construction from local extrema, reason from first principles about how extrema spacing and envelope overlap govern which oscillatory content is isolated first. Then, predict which sinusoidal component is extracted as the first IMF and which remains to form the second IMF. Finally, using the definition of instantaneous frequency from the analytic signal via the Hilbert transform, identify the constant instantaneous frequency associated with each of the first two IMFs.\n\nReport your final answer as the ordered pair $(f_{\\mathrm{IMF1}}, f_{\\mathrm{IMF2}})$, where $f_{\\mathrm{IMF}k}$ denotes the constant instantaneous frequency of the $k$-th IMF as defined by the Hilbert transform. Express your final answer as a $1\\times 2$ row matrix in terms of $f_1$ and $f_2$. No numerical approximation or rounding is required.", "solution": "The core principle of the Empirical Mode Decomposition (EMD) is to sequentially extract oscillatory components from a signal, starting with the one that has the highest local frequency, or equivalently, the shortest local time scale. The process is entirely data-driven and adaptive.\n\nThe signal is $x(t) = \\cos(2\\pi f_1 t) + \\cos(2\\pi f_2 t)$. Given the constraint $f_2 = 5f_1$, it is clear that the component $\\cos(2\\pi f_2 t)$ oscillates at a much higher frequency than the component $\\cos(2\\pi f_1 t)$. The signal $x(t)$ can be conceptualized as a high-frequency oscillation, $\\cos(2\\pi f_2 t)$, superimposed on a slowly varying carrier, $\\cos(2\\pi f_1 t)$.\n\nThe EMD sifting process begins by identifying all local extrema (maxima and minima) of the signal $x(t)$. Due to the significant separation in frequencies ($f_2$ is $5$ times $f_1$), the locations of these local extrema are primarily determined by the high-frequency component, $\\cos(2\\pi f_2 t)$. The local maxima of $x(t)$ will occur near the peaks of $\\cos(2\\pi f_2 t)$, where the value of this component is $+1$. At these time instances, the value of the composite signal is approximately $x(t_{max}) \\approx \\cos(2\\pi f_1 t_{max}) + 1$. Similarly, the local minima of $x(t)$ will occur near the troughs of $\\cos(2\\pi f_2 t)$, where its value is $-1$, making the composite signal value approximately $x(t_{min}) \\approx \\cos(2\\pi f_1 t_{min}) - 1$.\n\nThe first step in sifting is to construct the upper envelope, $e_{up}(t)$, by interpolating through the local maxima, and the lower envelope, $e_{low}(t)$, by interpolating through the local minima. Under the idealization of perfect interpolation, the upper envelope will be a smooth function that closely follows $e_{up}(t) \\approx \\cos(2\\pi f_1 t) + 1$, and the lower envelope will closely follow $e_{low}(t) \\approx \\cos(2\\pi f_1 t) - 1$.\n\nThe mean envelope, $m_1(t)$, is then computed as the pointwise average of the two envelopes:\n$$m_1(t) = \\frac{e_{up}(t) + e_{low}(t)}{2}$$\nUsing our approximations, this becomes:\n$$m_1(t) \\approx \\frac{(\\cos(2\\pi f_1 t) + 1) + (\\cos(2\\pi f_1 t) - 1)}{2} = \\frac{2\\cos(2\\pi f_1 t)}{2} = \\cos(2\\pi f_1 t)$$\nIn the idealized case described, this approximation becomes an equality. The mean envelope is exactly the low-frequency component.\n\nThe first proto-IMF, $h_1(t)$, is obtained by subtracting this mean from the original signal:\n$$h_1(t) = x(t) - m_1(t) = (\\cos(2\\pi f_1 t) + \\cos(2\\pi f_2 t)) - \\cos(2\\pi f_1 t) = \\cos(2\\pi f_2 t)$$\nThe sifting process requires iterating this procedure on $h_1(t)$ until it satisfies the IMF conditions. However, $h_1(t) = \\cos(2\\pi f_2 t)$ is a pure sinusoid. Its upper envelope is the constant $1$ and its lower envelope is the constant $-1$. The mean of these envelopes is $(1 - 1)/2 = 0$. Since the mean is identically zero, the sifting process has converged on the very first iteration. Thus, the first Intrinsic Mode Function is:\n$$c_1(t) = \\cos(2\\pi f_2 t)$$\nThis demonstrates the fundamental behavior of EMD: it isolates the highest-frequency mode first.\n\nNext, we find the first residue, $r_1(t)$, by subtracting the first IMF from the original signal:\n$$r_1(t) = x(t) - c_1(t) = (\\cos(2\\pi f_1 t) + \\cos(2\\pi f_2 t)) - \\cos(2\\pi f_2 t) = \\cos(2\\pi f_1 t)$$\nThis residue, $r_1(t)$, becomes the input for the next stage of the decomposition. We must check if $r_1(t)$ is itself an IMF. As $r_1(t) = \\cos(2\\pi f_1 t)$ is a pure sinusoid, its upper envelope is $1$ and its lower envelope is $-1$. Its mean is identically zero. It also satisfies the condition on the number of extrema and zero-crossings. Therefore, $r_1(t)$ is already an IMF and no further sifting is required. The second Intrinsic Mode Function is:\n$$c_2(t) = r_1(t) = \\cos(2\\pi f_1 t)$$\n\nFinally, we determine the instantaneous frequency for each IMF using the Hilbert transform. The instantaneous frequency $f(t)$ is derived from the phase of the analytic signal $z(t) = s(t) + i\\mathcal{H}\\{s(t)\\} = A(t)\\exp(i\\phi(t))$, where $\\mathcal{H}$ denotes the Hilbert transform operator. The frequency is given by $f(t) = \\frac{1}{2\\pi}\\frac{d\\phi(t)}{dt}$.\n\nFor the first IMF, $c_1(t) = \\cos(2\\pi f_2 t)$:\nThe Hilbert transform is $\\mathcal{H}\\{c_1(t)\\} = \\sin(2\\pi f_2 t)$.\nThe analytic signal is $z_1(t) = \\cos(2\\pi f_2 t) + i\\sin(2\\pi f_2 t) = \\exp(i(2\\pi f_2 t))$.\nThe phase is $\\phi_1(t) = 2\\pi f_2 t$.\nThe instantaneous frequency is constant:\n$$f_{\\mathrm{IMF1}} = \\frac{1}{2\\pi}\\frac{d}{dt}(2\\pi f_2 t) = f_2$$\n\nFor the second IMF, $c_2(t) = \\cos(2\\pi f_1 t)$:\nThe Hilbert transform is $\\mathcal{H}\\{c_2(t)\\} = \\sin(2\\pi f_1 t)$.\nThe analytic signal is $z_2(t) = \\cos(2\\pi f_1 t) + i\\sin(2\\pi f_1 t) = \\exp(i(2\\pi f_1 t))$.\nThe phase is $\\phi_2(t) = 2\\pi f_1 t$.\nThe instantaneous frequency is constant:\n$$f_{\\mathrm{IMF2}} = \\frac{1}{2\\pi}\\frac{d}{dt}(2\\pi f_1 t) = f_1$$\n\nThe ordered pair of instantaneous frequencies is $(f_{\\mathrm{IMF1}}, f_{\\mathrm{IMF2}}) = (f_2, f_1)$. This is to be reported as a $1\\times 2$ row matrix.", "answer": "$$ \\boxed{\\begin{pmatrix} f_2 & f_1 \\end{pmatrix}} $$", "id": "2869022"}, {"introduction": "The ultimate goal of the Hilbert-Huang Transform (HHT) is to analyze a signal's time-frequency-energy distribution. After EMD decomposes the signal into IMFs, the Hilbert transform is applied to each one to obtain its instantaneous frequency. This computational practice focuses on this crucial second step: the construction of the analytic signal in the discrete domain. By implementing an FFT-based approach, you will bridge the gap between signal processing theory and practical application, handling important details like the treatment of DC and Nyquist frequencies.", "problem": "Consider the construction of the analytic signal used in Hilbert spectral analysis within the Hilbert-Huang Transform (HHT). Given a real, finite-length, discrete-time sequence $x[n]$ of length $N$, the analytic signal $z[n]$ is a complex sequence whose Discrete-Time Fourier Transform (DTFT) is supported only on nonnegative angular frequencies. In the discrete, finite-length setting, one can realize this by a frequency-domain construction using the Discrete Fourier Transform (DFT) implemented by the Fast Fourier Transform (FFT).\n\nYour task is to implement, from first principles, the FFT-based construction of the analytic signal for length-$N$ real sequences and then determine which one-sided frequency bins are effectively nonzero in the DFT of the analytic signal.\n\nBase your derivation and implementation only on the following well-tested facts:\n- The Discrete Fourier Transform (DFT) and its inverse are defined by\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n]\\, e^{-j \\frac{2\\pi}{N} kn}, \\quad k=0,\\dots,N-1,\n$$\n$$\nx[n] = \\frac{1}{N}\\sum_{k=0}^{N-1} X[k]\\, e^{j \\frac{2\\pi}{N} kn}, \\quad n=0,\\dots,N-1.\n$$\n- The analytic signal $z[n] = x[n] + j\\,\\hat{x}[n]$ is characterized in the continuous-time frequency domain by suppressing negative frequencies and preserving nonnegative frequencies appropriately. In particular, for a real signal, the continuous-time analytic spectrum $Z(\\omega)$ satisfies $Z(\\omega)=0$ for $\\omega < 0$, and $Z(\\omega)$ agrees with $X(\\omega)$ on $\\omega=0$ and retains the positive-frequency content in a way that ensures $z[n]$ is complex with $x[n]$ as its real part.\n- Real signals have conjugate-symmetric DFTs: if $x[n]\\in\\mathbb{R}$, then $X[k] = \\overline{X[(-k)\\bmod N]}$.\n\nYour program must:\n1. For each specified test case, form $x[n]$ for $n=0,\\dots,N-1$ with $N=64$, compute its DFT $X[k]$, construct the frequency-domain analytic spectrum via a frequency-domain window derived from the continuous signum-law characterization of the Hilbert transform, and then compute the analytic signal $z[n]$ via the inverse DFT of that windowed spectrum.\n2. From the analytic spectrum, extract the one-sided DFT magnitude on the bins $k=0,1,\\dots,N/2$ (since $N$ is even). Declare a bin $k$ as “effectively nonzero” if its magnitude exceeds a relative threshold $\\tau$ defined by\n$$\n\\tau = 10^{-12}\\,\\max_{0\\leq k \\leq N-1} |Z[k]|,\n$$\nwhere $Z[k]$ denotes the DFT of the analytic signal. Report the integer indices $k$ in the one-sided set $\\{0,1,\\dots,N/2\\}$ whose magnitudes exceed $\\tau$.\n3. Use angular frequency in radians per sample throughout. No physical units are involved, and there are no angles to convert between radians and degrees other than the specified angular frequencies.\n\nTest suite (all with $N=64$ and $n=0,\\dots,63$):\n- Case $1$ (general non-bin-centered cosine): $x[n] = \\cos(0.2\\pi\\, n)$.\n- Case $2$ (bin-centered cosine): $x[n] = \\cos(0.25\\pi\\, n)$.\n- Case $3$ (direct current signal): $x[n] = \\cos(0\\, n)$.\n- Case $4$ (Nyquist-frequency cosine): $x[n] = \\cos(\\pi\\, n)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a bracketed, comma-separated list of the integer indices of the effectively nonzero one-sided bins. For example, a valid output format is\n$[ [k\\_0^{(1)},k\\_1^{(1)},\\dots], [k\\_0^{(2)},\\dots], [\\dots], [\\dots] ]$\nbut printed with no spaces. Concretely, your program must print exactly one line in the form\n$[[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$\nwith integer indices and no spaces anywhere in the line.\n\nYour implementation must be self-contained and must not require any user input. The only outputs to be graded are the lists of indices as described above. The correctness criterion encompasses:\n- Correct derivation and use of the frequency-domain window that suppresses negative frequencies in the DFT while preserving $k=0$ and $k=N/2$ appropriately for even $N$.\n- Correct identification of one-sided, effectively nonzero bins under the relative threshold $\\tau$ for all test cases, including the boundary cases at direct current and the Nyquist frequency.", "solution": "The analytic signal $z[n]$ corresponding to a real signal $x[n]$ is a complex signal whose frequency content is restricted to the non-negative frequencies. For discrete signals of finite length $N$, this construction is most efficiently performed in the frequency domain using the Discrete Fourier Transform (DFT).\n\nThe DFT of a sequence $x[n]$ of length $N$ is given by\n$$ X[k] = \\sum_{n=0}^{N-1} x[n]\\, e^{-j \\frac{2\\pi}{N} kn}, \\quad k=0,\\dots,N-1 $$\nFor a real-valued signal $x[n]$, its DFT exhibits conjugate symmetry: $X[k] = \\overline{X[(-k)\\bmod N]}$. For an even length $N$, this implies $X[k] = \\overline{X[N-k]}$ for $k=1, \\dots, N-1$. The components $X[0]$ and $X[N/2]$ are necessarily real. The DFT bins from $k=1$ to $k=N/2-1$ represent positive frequencies, while the bins from $k=N/2+1$ to $k=N-1$ represent the corresponding negative frequencies. The bins $k=0$ (Direct Current, DC) and $k=N/2$ (Nyquist frequency) are their own negative frequency counterparts and are treated as boundary cases.\n\nTo construct the DFT of the analytic signal, $Z[k]$, we must suppress the negative frequency components. This is achieved by applying a specific windowing operation to the spectrum $X[k]$. The procedure, consistent with the continuous-time definition and ensuring that $\\operatorname{Re}\\{\\text{IDFT}(Z[k])\\} = x[n]$, is as follows for an even length $N$:\n\n1.  **Positive Frequencies ($1 \\le k < N/2$):** Both positive and negative frequency components of a real sinusoid contribute to its amplitude. To confine the total energy to the positive frequency range, we must double the amplitude of these components.\n    $$ Z[k] = 2X[k] \\quad \\text{for } 1 \\leq k < N/2 $$\n\n2.  **Negative Frequencies ($N/2 < k < N$):** These components are entirely suppressed.\n    $$ Z[k] = 0 \\quad \\text{for } N/2 < k < N $$\n\n3.  **Boundary Frequencies ($k=0$ and $k=N/2$):** The DC and Nyquist frequencies do not have distinct negative-frequency partners. Their energy is not split. Thus, they must not be doubled. We retain their original spectral values.\n    $$ Z[0] = X[0] $$\n    $$ Z[N/2] = X[N/2] $$\n\nThis completes the definition of $Z[k]$. The inverse DFT of $Z[k]$ would yield the complex analytic signal $z[n]$.\n\nThe problem requires us to identify which frequency bins in the one-sided spectrum, $k \\in \\{0, 1, \\dots, N/2\\}$, are \"effectively nonzero.\" A bin $k$ is deemed as such if its magnitude $|Z[k]|$ exceeds a relative threshold $\\tau$, defined as\n$$ \\tau = 10^{-12}\\,\\max_{0\\leq i \\leq N-1} |Z[i]| $$\nThis threshold is extremely low, meaning that any bin containing energy not diminished by more than a factor of $10^{12}$ relative to the peak will be included.\n\nWe now apply this methodology to the four specified test cases with $N=64$.\n\n**Case 1: $x[n] = \\cos(0.2\\pi\\, n)$**\nThe angular frequency $\\omega_0 = 0.2\\pi$ corresponds to a DFT index of $k_0 = \\omega_0 N / (2\\pi) = 0.2\\pi \\cdot 64 / (2\\pi) = 6.4$. Since this is not an integer, the signal is not periodic over the $N=64$ sample window. The DFT of this signal will exhibit spectral leakage, where the energy is centered around $k=6$ and $k=7$ but spreads across all other frequency bins. The DFT of a finite-length sinusoid is equivalent to the convolution of the ideal sinusoid's spectrum (two Dirac delta impulses) with the spectrum of the implicit rectangular window (a sinc function). The sinc function's magnitude decays slowly and never reaches zero. Consequently, when using double-precision floating-point arithmetic, all bins of the DFT, $X[k]$, will be numerically non-zero. After constructing $Z[k]$, and given the extremely small relative threshold $\\tau$, it is expected that all bins in the one-sided spectrum from $k=0$ to $k=N/2=32$ will have magnitudes exceeding $\\tau$.\n\n**Case 2: $x[n] = \\cos(0.25\\pi\\, n)$**\nThe angular frequency $\\omega_0 = 0.25\\pi$ corresponds to a DFT index of $k_0 = 0.25\\pi \\cdot 64 / (2\\pi) = 8$. This frequency is a bin center. As a result, there is no spectral leakage. The DFT, $X[k]$, will have exactly two non-zero components: $X[8]$ and its conjugate at $X[64-8] = X[56]$. According to our construction, $Z[8] = 2X[8]$ and all other $Z[k]$ will be zero (within machine precision). Therefore, only the bin $k=8$ will be identified as effectively nonzero.\n\n**Case 3: $x[n] = \\cos(0\\, n) = 1$**\nThis is a pure DC signal. Its frequency is $\\omega_0=0$, corresponding to the DFT index $k_0=0$. Its spectrum $X[k]$ is non-zero only at $k=0$, where $X[0]=N$. Our construction rule states $Z[0] = X[0]$. Thus, only the bin $k=0$ will be effectively nonzero.\n\n**Case 4: $x[n] = \\cos(\\pi\\, n)$**\nThis signal corresponds to the Nyquist frequency, $\\omega_0=\\pi$. The DFT index is $k_0 = \\pi \\cdot 64 / (2\\pi) = 32$. This is the special $k=N/2$ bin. The spectrum $X[k]$ is non-zero only at $k=32$. Our construction rule states $Z[N/2] = X[N/2]$. Therefore, only the bin $k=32$ will be effectively nonzero.\n\nThe implementation will proceed by calculating the DFT of each signal, constructing the analytic spectrum $Z[k]$ according to the derived rules, calculating the threshold $\\tau$, and comparing the magnitudes $|Z[k]|$ for $k=0, \\dots, 32$ against this threshold.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the effectively nonzero one-sided DFT bins of the analytic signal\n    for several test cases, based on the principles of the Hilbert-Huang Transform.\n    \"\"\"\n\n    def construct_analytic_spectrum(X):\n        \"\"\"\n        Constructs the DFT of the analytic signal from the DFT of a real signal.\n        This implementation is for even-length signals as specified in the problem.\n        \n        Args:\n            X (np.ndarray): The DFT of a real-valued signal x[n].\n        \n        Returns:\n            np.ndarray: The DFT of the corresponding analytic signal z[n].\n        \"\"\"\n        N = len(X)\n        Z = np.zeros_like(X, dtype=np.complex128)\n\n        if N % 2 == 0:\n            # For even N, as is the case here (N=64)\n            # Retain DC component\n            Z[0] = X[0]\n            # Double positive frequency components\n            Z[1:N//2] = 2.0 * X[1:N//2]\n            # Retain Nyquist component\n            Z[N//2] = X[N//2]\n            # Zero out negative frequency components (already zero by initialization)\n        else:\n            # Fallback for odd N (not used in this problem)\n            Z[0] = X[0]\n            Z[1:(N+1)//2] = 2.0 * X[1:(N+1)//2]\n\n        return Z\n\n    # Define common parameters for all test cases\n    N = 64\n    n = np.arange(N)\n\n    # Define the test signals as per the problem statement\n    test_cases = [\n        # Case 1: General non-bin-centered cosine\n        np.cos(0.2 * np.pi * n),\n        # Case 2: Bin-centered cosine\n        np.cos(0.25 * np.pi * n),\n        # Case 3: Direct current signal\n        np.cos(0.0 * n),\n        # Case 4: Nyquist-frequency cosine\n        np.cos(np.pi * n),\n    ]\n\n    results_all_cases = []\n    \n    for x in test_cases:\n        # Step 1: Compute the DFT of the signal\n        X = np.fft.fft(x)\n\n        # Step 2: Construct the DFT of the analytic signal\n        Z = construct_analytic_spectrum(X)\n        \n        # Step 3: Define the threshold for being 'effectively nonzero'\n        max_magnitude = np.max(np.abs(Z))\n        # Handle the case of an all-zero signal to prevent tau from being 0.\n        if max_magnitude == 0.0:\n            tau = 1.0 \n        else:\n            tau = 1e-12 * max_magnitude\n\n        # Step 4: Identify indices of effectively nonzero bins in the one-sided spectrum\n        # The one-sided spectrum includes bins k = 0, 1, ..., N/2\n        one_sided_magnitudes = np.abs(Z[0 : N//2 + 1])\n        nonzero_indices = np.where(one_sided_magnitudes > tau)[0].tolist()\n        \n        results_all_cases.append(nonzero_indices)\n\n    # Format the final output string as specified: [[...],[...],...] with no spaces.\n    list_of_strings = []\n    for sublist in results_all_cases:\n        list_of_strings.append(f\"[{','.join(map(str, sublist))}]\")\n    \n    final_output_string = f\"[{','.join(list_of_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "2868956"}]}