{"hands_on_practices": [{"introduction": "Before diving into complex applications, it's essential to grasp the fundamental properties of the Short-time Fourier Transform (STFT). This first exercise explores the modulation property, a cornerstone concept that describes how the STFT behaves when a signal is mixed with a carrier frequency. By working through this problem [@problem_id:1765456], you will gain a deeper intuition for how operations in the time domain affect the time-frequency representation, a skill vital for analyzing communication systems and other modulated signals.", "problem": "In digital signal processing, the Short-time Fourier Transform (STFT) is a fundamental tool for analyzing how the frequency content of a non-stationary signal changes over time. The STFT of a continuous-time signal $x(t)$ using a window function $w(t)$ is defined as:\n$$\nX(t, \\omega) = \\int_{-\\infty}^{\\infty} x(\\tau) w(\\tau - t) e^{-j\\omega\\tau} d\\tau\n$$\nwhere $t$ represents the time position of the window and $\\omega$ represents the angular frequency.\n\nConsider a baseband signal $x(t)$ whose STFT is given by $X(t, \\omega)$. In a simplified model of a quadrature amplitude modulation system, this signal is modulated by a complex exponential carrier wave with angular frequency $\\omega_0$ to produce a new signal $y(t)$, where $y(t) = x(t) \\exp(j\\omega_0 t)$.\n\nDetermine the STFT of the modulated signal, denoted as $Y(t, \\omega)$, expressed in terms of the original signal's STFT, $X(t, \\omega)$, and the modulation frequency $\\omega_0$.", "solution": "We start from the definition of the Short-time Fourier Transform (STFT) for a signal $z(t)$ with window $w(t)$:\n$$\nZ(t,\\omega)=\\int_{-\\infty}^{\\infty} z(\\tau)\\,w(\\tau-t)\\,\\exp\\!\\left(-j\\omega\\tau\\right)\\,d\\tau.\n$$\nFor the modulated signal $y(t)=x(t)\\exp\\!\\left(j\\omega_{0}t\\right)$, its STFT is\n$$\nY(t,\\omega)=\\int_{-\\infty}^{\\infty} y(\\tau)\\,w(\\tau-t)\\,\\exp\\!\\left(-j\\omega\\tau\\right)\\,d\\tau.\n$$\nSubstituting $y(\\tau)=x(\\tau)\\exp\\!\\left(j\\omega_{0}\\tau\\right)$ gives\n$$\nY(t,\\omega)=\\int_{-\\infty}^{\\infty} x(\\tau)\\,\\exp\\!\\left(j\\omega_{0}\\tau\\right)\\,w(\\tau-t)\\,\\exp\\!\\left(-j\\omega\\tau\\right)\\,d\\tau.\n$$\nCombine the exponentials inside the integrand:\n$$\n\\exp\\!\\left(j\\omega_{0}\\tau\\right)\\exp\\!\\left(-j\\omega\\tau\\right)=\\exp\\!\\left(-j(\\omega-\\omega_{0})\\tau\\right).\n$$\nHence,\n$$\nY(t,\\omega)=\\int_{-\\infty}^{\\infty} x(\\tau)\\,w(\\tau-t)\\,\\exp\\!\\left(-j(\\omega-\\omega_{0})\\tau\\right)\\,d\\tau.\n$$\nRecognizing this integral as the STFT of $x(t)$ evaluated at frequency $\\omega-\\omega_{0}$, by the given definition,\n$$\nY(t,\\omega)=X(t,\\omega-\\omega_{0}).\n$$\nThus, modulation by $\\exp\\!\\left(j\\omega_{0}t\\right)$ shifts the STFT in frequency by $\\omega_{0}$ without any additional phase factor depending on $t$.", "answer": "$$\\boxed{X(t,\\omega-\\omega_{0})}$$", "id": "1765456"}, {"introduction": "One of the most critical concepts in time-frequency analysis is the inherent trade-off between time resolution and frequency resolution. This exercise [@problem_id:1765486] provides a practical scenario to make this abstract principle tangible, asking you to determine the necessary window length to distinguish two closely spaced frequencies. Mastering this concept is key to effectively designing and interpreting STFT-based analyses, as the choice of window directly dictates what features of a signal can and cannot be resolved.", "problem": "An engineer is developing a signal processing system to analyze vibrations in a mechanical structure. A simplified model of the signal acquired from an accelerometer is the sum of two closely-spaced sinusoidal components: $x(t) = \\cos(2\\pi f_1 t) + \\cos(2\\pi f_2 t)$. To understand how the spectral content of these vibrations evolves, the engineer employs a Short-time Fourier Transform (STFT). The STFT is implemented by multiplying the signal $x(t)$ with a sliding rectangular window function, $w(t)$, and then computing the Fourier Transform of the windowed segment.\n\nThe rectangular window function has a duration $L$ and is defined as:\n$$\nw(t) = \n\\begin{cases} \n1 & \\text{for } |t| \\le L/2 \\\\ \n0 & \\text{otherwise} \n\\end{cases}\n$$\nFor the two frequencies to be distinguishable in any time-slice of the STFT, their spectral peaks must be resolved. We will use the Rayleigh resolution criterion, which states that two frequency components are considered 'just resolved' if the peak of the main lobe of one component's spectral response coincides with the first null (zero-crossing) of the other's.\n\nGiven that the two vibration frequencies are $f_1 = 525.0 \\text{ Hz}$ and $f_2 = 527.5 \\text{ Hz}$, determine the minimum window duration $L_{min}$ required to just resolve these two frequencies according to the specified criterion. Express your answer in milliseconds (ms), rounded to three significant figures.", "solution": "The STFT multiplies the signal by a rectangular window $w(t)$ of duration $L$ and then takes the Fourier transform. The Fourier transform of the rectangular window is\n$$\nW(f) = \\int_{-L/2}^{L/2} \\exp(-j 2\\pi f t)\\,dt = \\frac{2\\sin(\\pi f L)}{2\\pi f} = L\\,\\operatorname{sinc}(fL),\n$$\nwhere $\\operatorname{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$. For a windowed cosine at frequency $f_{0}$, the magnitude spectrum is proportional to $|W(f - f_{0})|$, whose main-lobe peak is at $f = f_{0}$ and whose first nulls occur when\n$$\n\\sin\\!\\big(\\pi L (f - f_{0})\\big) = 0 \\quad \\Rightarrow \\quad f - f_{0} = \\pm \\frac{1}{L}.\n$$\nThus, the frequency offset from the peak to the first null is $\\frac{1}{L}$. The Rayleigh resolution criterion requires that the separation between the two tones equals this offset:\n$$\n\\Delta f \\equiv |f_{2} - f_{1}| = \\frac{1}{L_{\\min}} \\quad \\Rightarrow \\quad L_{\\min} = \\frac{1}{|f_{2} - f_{1}|}.\n$$\nWith $f_{1} = 525.0$ and $f_{2} = 527.5$, the separation is $\\Delta f = 2.5$. Therefore,\n$$\nL_{\\min} = \\frac{1}{2.5}\\ \\text{s} = 0.4\\ \\text{s} = 400\\ \\text{ms}.\n$$\nRounded to three significant figures, this is $4.00 \\times 10^{2}$ in milliseconds.", "answer": "$$\\boxed{4.00 \\times 10^{2}}$$", "id": "1765486"}, {"introduction": "The true power of the STFT lies in its ability to analyze non-stationary signals whose frequency content evolves over time. This advanced exercise [@problem_id:2903421] guides you through the analysis of a linear chirp signal, a fundamental model for signals with time-varying frequency. By deriving the STFT and identifying its 'ridge' in the time-frequency plane, you will see precisely how the transform's peak magnitude tracks the instantaneous frequency of the signal, providing a clear visualization of its dynamic spectral behavior.", "problem": "Consider the linear frequency-modulated (chirp) signal $x(t) = \\exp\\!\\big(j(\\omega_{0}\\,t + \\alpha\\,t^{2}/2)\\big)$ with real constants $\\omega_{0}$ and $\\alpha$, and a Gaussian analysis window $w(t) = \\exp\\!\\big(-t^{2}/(2\\sigma^{2})\\big)$ with $\\sigma>0$. The Short-time Fourier Transform (STFT) of $x(t)$ with window $w(t)$ is defined by\n$$\nX(\\tau,\\omega) \\triangleq \\int_{-\\infty}^{\\infty} x(t)\\,w(t-\\tau)\\,\\exp(-j\\,\\omega\\,t)\\,dt.\n$$\nStarting from this definition and the elementary Gaussian-completion method for quadratic exponents, derive a closed-form analytic expression for $X(\\tau,\\omega)$ by explicitly completing the square in the complex quadratic exponent of the integrand. Then, by analyzing the resulting magnitude $|X(\\tau,\\omega)|$, determine the unique trajectory $\\omega=\\omega_{r}(\\tau)$ that maximizes $|X(\\tau,\\omega)|$ with respect to $\\omega$ at each fixed $\\tau$ (the time-frequency ridge). You may assume standard convergence conditions for Gaussian integrals with complex coefficients whose real part is negative.\n\nReport as your final answer only the ridge trajectory $\\omega_{r}(\\tau)$ as a single analytic expression in terms of $\\omega_{0}$, $\\alpha$, and $\\tau$. No numerical approximation or rounding is required.", "solution": "The Short-time Fourier Transform (STFT) of a signal $x(t)$ with a window function $w(t)$ is defined as:\n$$\nX(\\tau,\\omega) = \\int_{-\\infty}^{\\infty} x(t)\\,w(t-\\tau)\\,\\exp(-j\\,\\omega\\,t)\\,dt\n$$\nWe are given the signal $x(t) = \\exp(j(\\omega_{0}\\,t + \\alpha\\,t^{2}/2))$ and the Gaussian window $w(t) = \\exp(-t^{2}/(2\\sigma^{2}))$. The shifted window is $w(t-\\tau) = \\exp(-(t-\\tau)^{2}/(2\\sigma^{2}))$.\n\nSubstituting these into the STFT definition gives:\n$$\nX(\\tau,\\omega) = \\int_{-\\infty}^{\\infty} \\exp\\left(j\\left(\\omega_{0}t + \\frac{\\alpha}{2}t^{2}\\right)\\right) \\exp\\left(-\\frac{(t-\\tau)^{2}}{2\\sigma^{2}}\\right) \\exp(-j\\omega t) \\,dt\n$$\nThe next step is to combine the arguments of the exponential functions into a single exponent. Let this combined exponent be denoted by $P(t)$:\n$$\nP(t) = j\\left(\\omega_{0}t + \\frac{\\alpha}{2}t^{2}\\right) - \\frac{(t-\\tau)^{2}}{2\\sigma^{2}} - j\\omega t\n$$\nExpanding the terms and collecting powers of $t$:\n$$\nP(t) = j\\omega_{0}t + j\\frac{\\alpha}{2}t^{2} - \\frac{1}{2\\sigma^{2}}(t^{2} - 2t\\tau + \\tau^{2}) - j\\omega t\n$$\n$$\nP(t) = \\left(j\\frac{\\alpha}{2} - \\frac{1}{2\\sigma^{2}}\\right)t^{2} + \\left(j\\omega_{0} + \\frac{\\tau}{\\sigma^{2}} - j\\omega\\right)t - \\frac{\\tau^{2}}{2\\sigma^{2}}\n$$\nThis is a quadratic polynomial in $t$. We write it in the standard form $-A_{c}t^{2} + B_{c}t - C_{c}$, where the coefficients are complex in general:\n$$\nP(t) = -\\left(\\frac{1}{2\\sigma^{2}} - j\\frac{\\alpha}{2}\\right)t^{2} + \\left(\\frac{\\tau}{\\sigma^{2}} + j(\\omega_{0} - \\omega)\\right)t - \\frac{\\tau^{2}}{2\\sigma^{2}}\n$$\nTo evaluate the integral, we complete the square for the terms involving $t$. The expression is of the form $-A_{c}t^{2} + B_{c}t$. Completing the square yields:\n$$\n-A_{c}t^{2} + B_{c}t = -A_{c}\\left(t^{2} - \\frac{B_{c}}{A_{c}}t\\right) = -A_{c}\\left(t - \\frac{B_{c}}{2A_{c}}\\right)^{2} + \\frac{B_{c}^{2}}{4A_{c}}\n$$\nHere, the complex coefficients are:\n$$\nA_{c} = \\frac{1}{2\\sigma^{2}} - j\\frac{\\alpha}{2}\n$$\n$$\nB_{c} = \\frac{\\tau}{\\sigma^{2}} + j(\\omega_{0} - \\omega)\n$$\nThe real part of $A_{c}$ is $\\text{Re}(A_{c}) = 1/(2\\sigma^{2})$, which is positive since $\\sigma > 0$. This ensures the convergence of the integral.\n\nSubstituting the completed square back into the expression for $P(t)$:\n$$\nP(t) = -A_{c}\\left(t - \\frac{B_{c}}{2A_{c}}\\right)^{2} + \\frac{B_{c}^{2}}{4A_{c}} - \\frac{\\tau^{2}}{2\\sigma^{2}}\n$$\nThe STFT integral becomes:\n$$\nX(\\tau,\\omega) = \\int_{-\\infty}^{\\infty} \\exp\\left(-A_{c}\\left(t - \\frac{B_{c}}{2A_{c}}\\right)^{2} + \\frac{B_{c}^{2}}{4A_{c}} - \\frac{\\tau^{2}}{2\\sigma^{2}}\\right) dt\n$$\nThe terms not depending on the integration variable $t$ can be factored out of the integral:\n$$\nX(\\tau,\\omega) = \\exp\\left(\\frac{B_{c}^{2}}{4A_{c}} - \\frac{\\tau^{2}}{2\\sigma^{2}}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-A_{c}\\left(t - \\frac{B_{c}}{2A_{c}}\\right)^{2}\\right) dt\n$$\nThe remaining integral is a standard Gaussian integral of the form $\\int_{-\\infty}^{\\infty} \\exp(-a(z-b)^{2})dz = \\sqrt{\\pi/a}$, provided $\\text{Re}(a) > 0$. In our case, $a = A_{c}$, and we have already established that $\\text{Re}(A_{c}) > 0$. Therefore, the integral evaluates to $\\sqrt{\\pi/A_{c}}$.\n\nThe closed-form expression for the STFT is:\n$$\nX(\\tau,\\omega) = \\sqrt{\\frac{\\pi}{A_{c}}} \\exp\\left(\\frac{B_{c}^{2}}{4A_{c}} - \\frac{\\tau^{2}}{2\\sigma^{2}}\\right)\n$$\nTo find the ridge $\\omega_{r}(\\tau)$, we must maximize the magnitude $|X(\\tau,\\omega)|$ with respect to $\\omega$ for each fixed $\\tau$.\n$$\n|X(\\tau,\\omega)| = \\left|\\sqrt{\\frac{\\pi}{A_{c}}}\\right| \\left|\\exp\\left(\\frac{B_{c}^{2}}{4A_{c}} - \\frac{\\tau^{2}}{2\\sigma^{2}}\\right)\\right|\n$$\n$$\n|X(\\tau,\\omega)| = \\frac{\\sqrt{\\pi}}{|A_{c}|^{1/2}} \\exp\\left(\\text{Re}\\left(\\frac{B_{c}^{2}}{4A_{c}} - \\frac{\\tau^{2}}{2\\sigma^{2}}\\right)\\right)\n$$\nTo maximize $|X(\\tau,\\omega)|$ with respect to $\\omega$, we must maximize the term $\\text{Re}\\left(\\frac{B_{c}^{2}}{4A_{c}}\\right)$, as all other terms are either constant or independent of $\\omega$.\nLet us examine the argument of the real part function. Let $\\Omega = \\omega_{0} - \\omega$. The coefficient $B_{c}$ can be written as $B_{c} = \\tau/\\sigma^{2} + j\\Omega$.\n$$\nB_{c}^{2} = \\left(\\frac{\\tau}{\\sigma^{2}}\\right)^{2} + 2j\\frac{\\tau}{\\sigma^{2}}\\Omega + (j\\Omega)^{2} = \\frac{\\tau^{2}}{\\sigma^{4}} - \\Omega^{2} + 2j\\frac{\\tau}{\\sigma^{2}}\\Omega\n$$\nThe term $1/(4A_{c})$ is:\n$$\n\\frac{1}{4A_{c}} = \\frac{1}{4\\left(\\frac{1}{2\\sigma^{2}} - j\\frac{\\alpha}{2}\\right)} = \\frac{1}{2\\left(\\frac{1}{\\sigma^{2}} - j\\alpha\\right)} = \\frac{\\frac{1}{\\sigma^{2}} + j\\alpha}{2\\left(\\left(\\frac{1}{\\sigma^{2}}\\right)^{2} + \\alpha^{2}\\right)} = \\frac{\\sigma^{4}\\left(\\frac{1}{\\sigma^{2}} + j\\alpha\\right)}{2(1 + \\alpha^{2}\\sigma^{4})} = \\frac{\\sigma^{2}(1 + j\\alpha\\sigma^{2})}{2(1 + \\alpha^{2}\\sigma^{4})}\n$$\nLet $K = \\frac{\\sigma^{2}}{2(1 + \\alpha^{2}\\sigma^{4})}$, which is a positive real constant. Then $1/(4A_{c}) = K(1 + j\\alpha\\sigma^{2})$.\nNow we compute $\\text{Re}(B_{c}^{2}/(4A_{c}))$:\n$$\n\\text{Re}\\left(\\frac{B_{c}^{2}}{4A_{c}}\\right) = \\text{Re}\\left( \\left( \\frac{\\tau^{2}}{\\sigma^{4}} - \\Omega^{2} + 2j\\frac{\\tau}{\\sigma^{2}}\\Omega \\right) K(1 + j\\alpha\\sigma^{2}) \\right)\n$$\n$$\n= K \\cdot \\text{Re}\\left( \\left(\\frac{\\tau^{2}}{\\sigma^{4}} - \\Omega^{2}\\right) + 2j\\frac{\\tau}{\\sigma^{2}}\\Omega + j\\alpha\\sigma^{2}\\left(\\frac{\\tau^{2}}{\\sigma^{4}} - \\Omega^{2}\\right) - 2\\alpha\\sigma^{2}\\frac{\\tau}{\\sigma^{2}}\\Omega \\right)\n$$\n$$\n= K \\left[ \\left(\\frac{\\tau^{2}}{\\sigma^{4}} - \\Omega^{2}\\right) - 2\\alpha\\tau\\Omega \\right]\n$$\nThis function, which we denote $f(\\omega)$, must be maximized with respect to $\\omega$. Substituting back $\\Omega = \\omega_{0} - \\omega$:\n$$\nf(\\omega) = K \\left[ \\frac{\\tau^{2}}{\\sigma^{4}} - (\\omega_{0} - \\omega)^{2} - 2\\alpha\\tau(\\omega_{0} - \\omega) \\right]\n$$\nTo find the maximum, we compute the derivative with respect to $\\omega$ and set it to zero:\n$$\n\\frac{df}{d\\omega} = K \\left[ -2(\\omega_{0} - \\omega)(-1) - 2\\alpha\\tau(-1) \\right] = 2K \\left[ (\\omega_{0} - \\omega) + \\alpha\\tau \\right]\n$$\nSetting the derivative to zero:\n$$\n2K \\left[ (\\omega_{0} - \\omega) + \\alpha\\tau \\right] = 0\n$$\nSince $K \\neq 0$, we must have:\n$$\n\\omega_{0} - \\omega + \\alpha\\tau = 0\n$$\nSolving for $\\omega$ gives the ridge trajectory $\\omega_{r}(\\tau)$:\n$$\n\\omega_{r}(\\tau) = \\omega_{0} + \\alpha\\tau\n$$\nThe second derivative is $\\frac{d^{2}f}{d\\omega^{2}} = 2K(-1) = -2K$. Since $K > 0$, the second derivative is negative, which confirms that this value of $\\omega$ corresponds to a maximum. The result signifies that the STFT magnitude is maximized when the analysis frequency $\\omega$ matches the instantaneous frequency of the chirp signal at time $\\tau$.", "answer": "$$\n\\boxed{\\omega_{0} + \\alpha\\tau}\n$$", "id": "2903421"}]}