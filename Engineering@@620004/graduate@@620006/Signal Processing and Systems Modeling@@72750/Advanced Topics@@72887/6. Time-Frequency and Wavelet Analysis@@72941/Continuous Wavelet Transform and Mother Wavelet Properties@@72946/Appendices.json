{"hands_on_practices": [{"introduction": "Mastering the continuous wavelet transform begins with applying its definition to canonical signals. This practice problem [@problem_id:2860051] challenges you to derive the CWT of a Gaussian signal using the celebrated \"Mexican hat\" wavelet, which is proportional to the second derivative of a Gaussian function. Executing this derivation from first principles will solidify your understanding of the transform's integral definition and sharpen essential mathematical skills for manipulating Gaussian integrals.", "problem": "Consider the real mother wavelet $\\psi(t) = \\left(1 - t^{2}\\right)\\exp\\!\\left(-\\frac{t^{2}}{2}\\right)$ on $\\mathbb{R}$. Begin from the definition of the continuous wavelet transform (CWT), which for a square-integrable signal $x(t)$, scale $a>0$, and translation $b\\in\\mathbb{R}$ is\n$$\nW_{x}(a,b) \\triangleq \\int_{-\\infty}^{\\infty} x(t)\\,\\frac{1}{\\sqrt{a}}\\,\\psi\\!\\left(\\frac{t-b}{a}\\right)\\,dt.\n$$\nUsing only fundamental definitions, standard properties of Gaussian integrals, and first principles manipulations, do the following:\n- Justify that $\\psi$ has zero mean and is square-integrable, hence admissible as a mother wavelet in the sense of the CWT.\n- For the signal $x(t) = \\exp\\!\\left(-\\frac{t^{2}}{2\\beta^{2}}\\right)$ with parameter $\\beta0$, derive a closed-form analytic expression for $W_{x}(a,b)$ as a function of $a0$, $b\\in\\mathbb{R}$, and $\\beta0$.\n\nYour final answer must be a single closed-form analytic expression in terms of $a$, $b$, $\\beta$, and universal constants. Do not approximate or round. No units are required.", "solution": "The problem statement must first be subjected to rigorous validation before any attempt at a solution is made.\n\nFirst, we extract the givens verbatim.\n- Mother wavelet: $\\psi(t) = \\left(1 - t^{2}\\right)\\exp\\!\\left(-\\frac{t^{2}}{2}\\right)$ on $\\mathbb{R}$.\n- CWT definition for a signal $x(t)$, scale $a0$, translation $b\\in\\mathbb{R}$: $W_{x}(a,b) \\triangleq \\int_{-\\infty}^{\\infty} x(t)\\,\\frac{1}{\\sqrt{a}}\\,\\psi\\!\\left(\\frac{t-b}{a}\\right)\\,dt$.\n- Signal: $x(t) = \\exp\\!\\left(-\\frac{t^{2}}{2\\beta^{2}}\\right)$ with parameter $\\beta0$.\n- Tasks: $1$. Justify that $\\psi(t)$ has zero mean and is square-integrable. $2$. Derive a closed-form analytic expression for $W_{x}(a,b)$.\n\nNow, we validate these givens against fundamental criteria.\n- **Scientific Grounding**: The problem is situated within the standard mathematical theory of signal processing. The continuous wavelet transform, the specific mother wavelet (which is proportional to the second derivative of a Gaussian, known as the Ricker or \"Mexican hat\" wavelet), and the Gaussian signal are all standard, well-defined concepts. The problem is scientifically and mathematically sound.\n- **Well-Posedness**: The problem is clearly formulated. The functions involved, $\\psi(t)$ and $x(t)$, are smooth and rapidly decaying, ensuring the convergence of the integrals required. A unique, stable, and meaningful solution is expected.\n- **Objectivity and Completeness**: The problem is stated using precise, objective mathematical language. All necessary definitions and parameters are provided. There are no ambiguities, contradictions, or missing information.\n\nThe verdict is that the problem is **valid**. We may proceed with the solution. The solution consists of two parts as requested.\n\nPart $1$: Justification of $\\psi(t)$ as an Admissible Mother Wavelet\nA real-valued function $\\psi(t)$ is an admissible mother wavelet if it satisfies two primary conditions: it must have a zero mean (the admissibility condition) and be square-integrable (finite energy).\n\n1.  **Zero Mean Condition**: We must show that $\\int_{-\\infty}^{\\infty} \\psi(t) \\, dt = 0$.\n    We are given $\\psi(t) = (1 - t^{2}) \\exp(-t^{2}/2)$. Let us define a standard Gaussian function $g(t) = \\exp(-t^{2}/2)$.\n    The first derivative of $g(t)$ is $g'(t) = -t \\exp(-t^{2}/2)$.\n    The second derivative is $g''(t) = \\frac{d}{dt}(-t \\exp(-t^{2}/2)) = -1 \\cdot \\exp(-t^{2}/2) + (-t)(-t \\exp(-t^{2}/2)) = (t^{2} - 1) \\exp(-t^{2}/2)$.\n    By inspection, we see that $\\psi(t) = -g''(t)$.\n    The integral for the mean is therefore $\\int_{-\\infty}^{\\infty} \\psi(t) \\, dt = -\\int_{-\\infty}^{\\infty} g''(t) \\, dt$.\n    By the fundamental theorem of calculus, this is equal to $-[g'(t)]_{-\\infty}^{\\infty} = -[-t \\exp(-t^{2}/2)]_{-\\infty}^{\\infty}$.\n    We evaluate the boundary term: $\\lim_{t \\to \\pm\\infty} (-t \\exp(-t^{2}/2))$. Due to the rapid decay of the exponential function, this limit is $0$ at both positive and negative infinity.\n    Thus, the integral is $-(0 - 0) = 0$. The zero mean condition is satisfied.\n\n2.  **Square-Integrability Condition**: We must show that $\\int_{-\\infty}^{\\infty} |\\psi(t)|^{2} \\, dt  \\infty$.\n    Since $\\psi(t)$ is a real function, we compute the integral of its square:\n    $\\int_{-\\infty}^{\\infty} \\psi(t)^{2} \\, dt = \\int_{-\\infty}^{\\infty} \\left((1 - t^{2})\\exp(-t^{2}/2)\\right)^{2} \\, dt = \\int_{-\\infty}^{\\infty} (1 - 2t^{2} + t^{4}) \\exp(-t^{2}) \\, dt$.\n    We can solve this by using the standard Gaussian integral formula $\\int_{-\\infty}^{\\infty} \\exp(-cx^{2}) \\, dx = \\sqrt{\\pi/c}$ and related forms. For $c=1$:\n    $\\int_{-\\infty}^{\\infty} \\exp(-t^{2}) \\, dt = \\sqrt{\\pi}$.\n    $\\int_{-\\infty}^{\\infty} t^{2} \\exp(-t^{2}) \\, dt = - \\frac{d}{dc} \\left[ \\int_{-\\infty}^{\\infty} \\exp(-ct^{2}) \\, dt \\right]_{c=1} = - \\frac{d}{dc} [\\sqrt{\\pi} c^{-1/2}]_{c=1} = -\\sqrt{\\pi}(-\\frac{1}{2})c^{-3/2}|_{c=1} = \\frac{\\sqrt{\\pi}}{2}$.\n    $\\int_{-\\infty}^{\\infty} t^{4} \\exp(-t^{2}) \\, dt = \\frac{d^2}{dc^2} \\left[ \\int_{-\\infty}^{\\infty} \\exp(-ct^{2}) \\, dt \\right]_{c=1} = \\frac{d^2}{dc^2} [\\sqrt{\\pi} c^{-1/2}]_{c=1} = \\sqrt{\\pi}(\\frac{3}{4})c^{-5/2}|_{c=1} = \\frac{3\\sqrt{\\pi}}{4}$.\n    The total integral is therefore $\\sqrt{\\pi} - 2(\\frac{\\sqrt{\\pi}}{2}) + \\frac{3\\sqrt{\\pi}}{4} = \\sqrt{\\pi} - \\sqrt{\\pi} + \\frac{3\\sqrt{\\pi}}{4} = \\frac{3\\sqrt{\\pi}}{4}$.\n    Since this value is finite, $\\psi(t)$ is square-integrable. Both conditions being met, $\\psi(t)$ is an admissible mother wavelet.\n\nPart $2$: Derivation of the CWT $W_{x}(a,b)$\nWe begin with the definition of the CWT and substitute the given functions:\n$$W_{x}(a,b) = \\frac{1}{\\sqrt{a}} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{t^{2}}{2\\beta^{2}}\\right) \\left(1 - \\left(\\frac{t-b}{a}\\right)^{2}\\right) \\exp\\left(-\\frac{1}{2}\\left(\\frac{t-b}{a}\\right)^{2}\\right) dt$$\nThe product of the two exponential functions has the exponent:\n$$E(t) = -\\frac{t^{2}}{2\\beta^{2}} - \\frac{(t-b)^{2}}{2a^{2}} = -\\frac{1}{2}\\left[ \\left(\\frac{1}{\\beta^{2}}+\\frac{1}{a^{2}}\\right)t^{2} - \\frac{2b}{a^{2}}t + \\frac{b^{2}}{a^{2}} \\right]$$\nWe complete the square for the quadratic polynomial in $t$. The term in brackets can be written as $A(t-t_{0})^{2} + K$.\nThe coefficient of $t^{2}$ is $A = \\frac{1}{\\beta^{2}}+\\frac{1}{a^{2}} = \\frac{a^{2}+\\beta^{2}}{a^{2}\\beta^{2}}$.\nThe center of the new Gaussian is $t_{0} = \\frac{b/a^{2}}{A} = \\frac{b/a^{2}}{(a^{2}+\\beta^{2})/(a^{2}\\beta^{2})} = \\frac{b\\beta^{2}}{a^{2}+\\beta^{2}}$.\nThe constant term is $K = \\frac{b^{2}}{a^{2}} - At_{0}^{2} = \\frac{b^{2}}{a^{2}} - \\frac{a^{2}+\\beta^{2}}{a^{2}\\beta^{2}}\\left(\\frac{b\\beta^{2}}{a^{2}+\\beta^{2}}\\right)^{2} = \\frac{b^{2}}{a^{2}} - \\frac{b^{2}\\beta^{2}}{a^{2}(a^{2}+\\beta^{2})} = \\frac{b^{2}(a^{2}+\\beta^{2}) - b^{2}\\beta^{2}}{a^{2}(a^{2}+\\beta^{2})} = \\frac{b^{2}}{a^{2}+\\beta^{2}}$.\nThe exponent becomes $E(t) = -\\frac{1}{2}\\left[A(t-t_{0})^{2} + K\\right] = -\\frac{a^{2}+\\beta^{2}}{2a^{2}\\beta^{2}}(t-t_{0})^{2} - \\frac{b^{2}}{2(a^{2}+\\beta^{2})}$.\nLet us define $\\sigma^{2} = \\frac{a^{2}\\beta^{2}}{a^{2}+\\beta^{2}}$, so the first part of the exponent is $-\\frac{(t-t_{0})^{2}}{2\\sigma^{2}}$.\nThe CWT integral now separates into a constant exponential factor and an integral $\\mathcal{I}$:\n$$W_{x}(a,b) = \\frac{1}{\\sqrt{a}} \\exp\\left(-\\frac{b^{2}}{2(a^{2}+\\beta^{2})}\\right) \\mathcal{I}$$\nwhere $\\mathcal{I} = \\int_{-\\infty}^{\\infty} \\left(1 - \\frac{(t-b)^{2}}{a^{2}}\\right) \\exp\\left(-\\frac{(t-t_{0})^{2}}{2\\sigma^{2}}\\right) dt$.\nLet $u = t-t_{0}$, so $t = u+t_{0}$ and $dt=du$. The term $t-b$ becomes $u+t_{0}-b$.\nWe find $t_{0}-b = \\frac{b\\beta^{2}}{a^{2}+\\beta^{2}} - b = \\frac{b\\beta^{2}-b(a^{2}+\\beta^{2})}{a^{2}+\\beta^{2}} = -\\frac{ba^{2}}{a^{2}+\\beta^{2}}$.\nSo, $(t-b)^{2} = (u - \\frac{ba^{2}}{a^{2}+\\beta^{2}})^{2} = u^{2} - \\frac{2uba^{2}}{a^{2}+\\beta^{2}} + \\frac{b^{2}a^{4}}{(a^{2}+\\beta^{2})^{2}}$.\nThe integrand's pre-factor becomes $1 - \\frac{1}{a^{2}}\\left(u^{2} - \\frac{2uba^{2}}{a^{2}+\\beta^{2}} + \\frac{b^{2}a^{4}}{(a^{2}+\\beta^{2})^{2}}\\right) = 1 - \\frac{u^{2}}{a^{2}} + \\frac{2bu}{a^{2}+\\beta^{2}} - \\frac{b^{2}a^{2}}{(a^{2}+\\beta^{2})^{2}}$.\nThe integral $\\mathcal{I}$ is:\n$$\\mathcal{I} = \\int_{-\\infty}^{\\infty} \\left(1 - \\frac{b^{2}a^{2}}{(a^{2}+\\beta^{2})^{2}}\\right)\\exp\\left(-\\frac{u^{2}}{2\\sigma^{2}}\\right)du - \\frac{1}{a^{2}}\\int_{-\\infty}^{\\infty} u^{2}\\exp\\left(-\\frac{u^{2}}{2\\sigma^{2}}\\right)du + \\frac{2b}{a^{2}+\\beta^{2}}\\int_{-\\infty}^{\\infty} u\\exp\\left(-\\frac{u^{2}}{2\\sigma^{2}}\\right)du$$\nThe integrals are standard: $\\int \\exp(-\\frac{u^{2}}{2\\sigma^{2}})du = \\sqrt{2\\pi\\sigma^{2}}$, $\\int u \\exp(...)du=0$, and $\\int u^{2}\\exp(...)du = \\sigma^{2}\\sqrt{2\\pi\\sigma^{2}}$.\n$$\\mathcal{I} = \\left(1 - \\frac{b^{2}a^{2}}{(a^{2}+\\beta^{2})^{2}}\\right)\\sqrt{2\\pi}\\sigma - \\frac{1}{a^{2}}(\\sigma^{2}\\sqrt{2\\pi}\\sigma) + 0 = \\sqrt{2\\pi}\\sigma \\left(1 - \\frac{b^{2}a^{2}}{(a^{2}+\\beta^{2})^{2}} - \\frac{\\sigma^{2}}{a^{2}}\\right)$$\nSubstituting $\\frac{\\sigma^{2}}{a^{2}} = \\frac{\\beta^{2}}{a^{2}+\\beta^{2}}$:\n$$\\mathcal{I} = \\sqrt{2\\pi}\\sigma \\left( \\frac{a^{2}+\\beta^{2}-\\beta^{2}}{a^{2}+\\beta^{2}} - \\frac{b^{2}a^{2}}{(a^{2}+\\beta^{2})^{2}} \\right) = \\sqrt{2\\pi}\\sigma \\left( \\frac{a^{2}}{a^{2}+\\beta^{2}} - \\frac{b^{2}a^{2}}{(a^{2}+\\beta^{2})^{2}} \\right)$$\n$$\\mathcal{I} = \\sqrt{2\\pi}\\sigma \\frac{a^{2}(a^{2}+\\beta^{2}) - b^{2}a^{2}}{(a^{2}+\\beta^{2})^{2}} = \\sqrt{2\\pi}\\sigma \\frac{a^{2}(a^{2}+\\beta^{2}-b^{2})}{(a^{2}+\\beta^{2})^{2}}$$\nSubstituting $\\sigma = \\frac{a\\beta}{\\sqrt{a^{2}+\\beta^{2}}}$:\n$$\\mathcal{I} = \\sqrt{2\\pi} \\frac{a\\beta}{(a^{2}+\\beta^{2})^{1/2}} \\frac{a^{2}(a^{2}+\\beta^{2}-b^{2})}{(a^{2}+\\beta^{2})^{2}} = \\sqrt{2\\pi} \\frac{a^{3}\\beta(a^{2}+\\beta^{2}-b^{2})}{(a^{2}+\\beta^{2})^{5/2}}$$\nFinally, we assemble $W_{x}(a,b) = \\frac{1}{\\sqrt{a}} \\exp\\left(-\\frac{b^{2}}{2(a^{2}+\\beta^{2})}\\right) \\mathcal{I}$:\n$$W_{x}(a,b) = \\frac{1}{a^{1/2}} \\exp\\left(-\\frac{b^{2}}{2(a^{2}+\\beta^{2})}\\right) \\sqrt{2\\pi} \\frac{a^{3}\\beta(a^{2}+\\beta^{2}-b^{2})}{(a^{2}+\\beta^{2})^{5/2}}$$\nSimplifying the power of $a$ ($a^{3-1/2} = a^{5/2}$), we arrive at the final closed-form expression:\n$$W_{x}(a,b) = \\sqrt{2\\pi} \\frac{a^{5/2}\\beta}{(a^{2}+\\beta^{2})^{5/2}} (a^{2}+\\beta^{2}-b^{2}) \\exp\\left(-\\frac{b^{2}}{2(a^{2}+\\beta^{2})}\\right)$$\nThis can be rearranged to consolidate terms:\n$$W_{x}(a,b) = \\sqrt{2\\pi}\\beta \\left(\\frac{a}{a^{2}+\\beta^{2}}\\right)^{5/2} (a^{2}+\\beta^{2}-b^{2}) \\exp\\left(-\\frac{b^{2}}{2(a^{2}+\\beta^{2})}\\right)$$\nThis expression is the complete and final result of the derivation.", "answer": "$$\\boxed{\\sqrt{2\\pi}\\beta \\left(\\frac{a}{a^{2}+\\beta^{2}}\\right)^{\\frac{5}{2}} (a^{2}+\\beta^{2}-b^{2}) \\exp\\left(-\\frac{b^{2}}{2(a^{2}+\\beta^{2})}\\right)}$$", "id": "2860051"}, {"introduction": "Real-world signals are inevitably contaminated by noise, making a transform's response to random inputs a cornerstone concept in advanced signal processing. This exercise [@problem_id:2860049] guides you through deriving the expected energy of CWT coefficients when the input is idealized white noise. The resulting principle is not only elegant but also fundamental, explaining how the CWT distributes noise power uniformly across the time-scale plane, a vital insight for denoising and signal detection applications.", "problem": "Consider a zero-mean, circular complex Gaussian white noise process $x(t)$ on $\\mathbb{R}$, with second-order statistics defined by $\\mathbb{E}\\{x(t)x^{*}(s)\\}=\\sigma^{2}\\delta(t-s)$, where $\\sigma^{2}0$ is a constant and $\\delta(\\cdot)$ is the Dirac delta distribution. Let $\\psi(t)$ be an admissible mother wavelet that is square-integrable, has zero mean, and unit energy, i.e., $\\int_{-\\infty}^{\\infty}|\\psi(t)|^{2}\\,dt=1$. The Continuous Wavelet Transform (CWT) of $x(t)$ with mother wavelet $\\psi(t)$ is defined by\n$$\nW_{x}(a,b)=\\int_{-\\infty}^{\\infty} x(t)\\,\\frac{1}{\\sqrt{|a|}}\\,\\psi^{*}\\!\\left(\\frac{t-b}{a}\\right)\\,dt,\n$$\nfor any scale $a\\in\\mathbb{R}\\setminus\\{0\\}$ and time shift $b\\in\\mathbb{R}$. Using only the above definitions and properties, derive a closed-form expression for the expected squared magnitude $\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\}$ as a function of $a$, $b$, $\\sigma^{2}$, and $\\psi$. Express your final answer in its simplest exact form. Your final answer must be a single closed-form expression with no units.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It provides all necessary definitions and conditions to derive a unique, meaningful solution. All concepts—complex Gaussian white noise, the Continuous Wavelet Transform, and mother wavelet properties—are standard in the fields of signal processing and applied mathematics. The problem is valid. We will proceed with its solution.\n\nThe objective is to compute the expected squared magnitude of the Continuous Wavelet Transform (CWT) coefficients, $\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\}$, for a given noise process $x(t)$. The CWT is defined as:\n$$\nW_{x}(a,b) = \\int_{-\\infty}^{\\infty} x(t)\\,\\frac{1}{\\sqrt{|a|}}\\,\\psi^{*}\\!\\left(\\frac{t-b}{a}\\right)\\,dt\n$$\nWe begin by expressing the squared magnitude $|W_{x}(a,b)|^{2}$ as the product of $W_{x}(a,b)$ and its complex conjugate $W_{x}^{*}(a,b)$. To avoid confusion, we use distinct integration variables, $t$ and $s$, for each factor.\n$$\n|W_{x}(a,b)|^{2} = W_{x}(a,b) W_{x}^{*}(a,b)\n$$\nThe complex conjugate of $W_{x}(a,b)$ is:\n$$\nW_{x}^{*}(a,b) = \\left( \\int_{-\\infty}^{\\infty} x(s)\\,\\frac{1}{\\sqrt{|a|}}\\,\\psi^{*}\\!\\left(\\frac{s-b}{a}\\right)\\,ds \\right)^{*} = \\int_{-\\infty}^{\\infty} x^{*}(s)\\,\\frac{1}{\\sqrt{|a|}}\\,\\psi\\!\\left(\\frac{s-b}{a}\\right)\\,ds\n$$\nCombining these, we obtain a double integral representation for $|W_{x}(a,b)|^{2}$:\n$$\n|W_{x}(a,b)|^{2} = \\left( \\int_{-\\infty}^{\\infty} x(t)\\,\\frac{1}{\\sqrt{|a|}}\\,\\psi^{*}\\!\\left(\\frac{t-b}{a}\\right)\\,dt \\right) \\left( \\int_{-\\infty}^{\\infty} x^{*}(s)\\,\\frac{1}{\\sqrt{|a|}}\\,\\psi\\!\\left(\\frac{s-b}{a}\\right)\\,ds \\right)\n$$\n$$\n|W_{x}(a,b)|^{2} = \\frac{1}{|a|} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} x(t)x^{*}(s) \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\psi\\!\\left(\\frac{s-b}{a}\\right) \\,dt\\,ds\n$$\nNow, we take the statistical expectation of this expression. The expectation operator $\\mathbb{E}\\{\\cdot\\}$ is linear and can be interchanged with the integration, a step justified by the Fubini-Tonelli theorem for well-behaved functions and stochastic processes.\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\mathbb{E}\\left\\{ \\frac{1}{|a|} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} x(t)x^{*}(s) \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\psi\\!\\left(\\frac{s-b}{a}\\right) \\,dt\\,ds \\right\\}\n$$\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\frac{1}{|a|} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\mathbb{E}\\{x(t)x^{*}(s)\\} \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\psi\\!\\left(\\frac{s-b}{a}\\right) \\,dt\\,ds\n$$\nThe problem provides the second-order statistics for the zero-mean complex white noise process $x(t)$:\n$$\n\\mathbb{E}\\{x(t)x^{*}(s)\\} = \\sigma^{2}\\delta(t-s)\n$$\nwhere $\\sigma^{2}$ is a positive constant and $\\delta(\\cdot)$ is the Dirac delta distribution. Substituting this property into our integral:\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\frac{1}{|a|} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\sigma^{2}\\delta(t-s) \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\psi\\!\\left(\\frac{s-b}{a}\\right) \\,dt\\,ds\n$$\nWe can now evaluate the inner integral with respect to $s$ by applying the sifting property of the Dirac delta function, which states that $\\int_{-\\infty}^{\\infty} f(s)\\delta(t-s)\\,ds = f(t)$.\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\frac{\\sigma^{2}}{|a|} \\int_{-\\infty}^{\\infty} \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\left( \\int_{-\\infty}^{\\infty} \\psi\\!\\left(\\frac{s-b}{a}\\right) \\delta(t-s) \\,ds \\right) \\,dt\n$$\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\frac{\\sigma^{2}}{|a|} \\int_{-\\infty}^{\\infty} \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\psi\\!\\left(\\frac{t-b}{a}\\right) \\,dt\n$$\nThe expression simplifies to:\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\frac{\\sigma^{2}}{|a|} \\int_{-\\infty}^{\\infty} \\left| \\psi\\!\\left(\\frac{t-b}{a}\\right) \\right|^{2} \\,dt\n$$\nTo solve the remaining integral, we perform a change of variables. Let $u = \\frac{t-b}{a}$. This implies $t = au+b$ and $dt = a\\,du$. We must consider the limits of integration.\nIf $a0$, as $t$ goes from $-\\infty$ to $\\infty$, $u$ also goes from $-\\infty$ to $\\infty$.\nIf $a0$, as $t$ goes from $-\\infty$ to $\\infty$, $u$ goes from $\\infty$ to $-\\infty$.\nIn either case, the integral transforms correctly when using $|a|$.\nThe integral becomes:\n$$\n\\int_{-\\infty}^{\\infty} \\left| \\psi\\left(\\frac{t-b}{a}\\right) \\right|^{2} \\,dt = \\int_{L} |\\psi(u)|^{2} (a\\,du)\n$$\nwhere $L$ is $(-\\infty, \\infty)$ if $a0$ and $(\\infty, -\\infty)$ if $a0$.\nThis evaluates to $|a|\\int_{-\\infty}^{\\infty}|\\psi(u)|^{2}\\,du$. More formally:\n$$\n\\int_{-\\infty}^{\\infty} \\left| \\psi\\left(\\frac{t-b}{a}\\right) \\right|^{2} \\,dt = |a| \\int_{-\\infty}^{\\infty} |\\psi(u)|^{2} \\,du\n$$\nSubstituting this back into our expression for the expected value:\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\frac{\\sigma^{2}}{|a|} \\left( |a| \\int_{-\\infty}^{\\infty} |\\psi(u)|^{2} \\,du \\right) = \\sigma^{2} \\int_{-\\infty}^{\\infty} |\\psi(u)|^{2} \\,du\n$$\nThe problem states that the mother wavelet $\\psi(t)$ has unit energy, which is defined as:\n$$\n\\int_{-\\infty}^{\\infty}|\\psi(t)|^{2}\\,dt=1\n$$\nUsing this property, the integral $\\int_{-\\infty}^{\\infty} |\\psi(u)|^{2} \\,du$ is equal to $1$.\nTherefore, the final result is:\n$$\n\\mathbb{E}\\{|W_{x}(a,b)|^{2}\\} = \\sigma^{2} \\times 1 = \\sigma^{2}\n$$\nThe expected squared magnitude of the CWT coefficients is constant across all scales $a$ and time shifts $b$. It depends only on the variance parameter $\\sigma^{2}$ of the noise process. The other property given, that the wavelet has zero mean, is not required for this specific derivation, though it is a crucial component of the admissibility condition for a mother wavelet.", "answer": "$$\n\\boxed{\\sigma^{2}}\n$$", "id": "2860049"}, {"introduction": "This final practice moves from analysis to synthesis, applying the CWT's statistical properties to a practical problem in detection theory. In this scenario [@problem_id:2860073], you are tasked with designing a detector that identifies signals buried in Gaussian white noise by setting a threshold on the CWT energy, $|W_{x}(a,b)|^{2}$. Success requires deriving the probability distribution of this energy under the noise-only hypothesis, thereby connecting the mother wavelet's properties directly to the detector's performance, as quantified by the probability of false alarm, $\\mathsf{P}_{\\mathrm{FA}}$.", "problem": "Consider the continuous wavelet transform (CWT) of a real-valued observation process defined for all real time by\n$$\nW_{x}(a,b) \\triangleq \\int_{-\\infty}^{\\infty} x(t)\\,\\frac{1}{\\sqrt{a}}\\,\\psi^{*}\\!\\left(\\frac{t-b}{a}\\right)\\,dt,\n$$\nwhere $a \\in \\mathbb{R}_{+}$ is the scale, $b \\in \\mathbb{R}$ is the translation, and $\\psi(t)$ is a complex mother wavelet of unit energy, that is,\n$$\n\\int_{-\\infty}^{\\infty}|\\psi(t)|^{2}\\,dt \\;=\\; 1.\n$$\nAssume the mother wavelet is the complex Morlet wavelet (without the negligible zero-mean correction for large center frequency) given by\n$$\n\\psi(t) \\;=\\; \\pi^{-1/4}\\,\\exp\\!\\left(i\\,\\omega_{\\psi}\\,t\\right)\\,\\exp\\!\\left(-\\frac{t^{2}}{2}\\right),\n$$\nso that $\\Re\\{\\psi\\}$ and $\\Im\\{\\psi\\}$ are orthogonal in $L^{2}(\\mathbb{R})$. You observe\n$$\nx(t) \\;=\\; n(t),\n$$\nwhere $n(t)$ is a zero-mean, real, wide-sense stationary Gaussian white noise with two-sided power spectral density $S_{n}(\\omega)=N_{0}/2$, equivalently autocorrelation $R_{n}(\\tau)=(N_{0}/2)\\,\\delta(\\tau)$.\n\nFix a particular scale $a_{0}0$ and translation $b_{0}\\in\\mathbb{R}$. You wish to design a detector that declares a detection event when the local CWT energy exceeds a threshold,\n$$\n\\text{decide detection if}\\quad |W_{x}(a_{0},b_{0})|^{2}\\tau.\n$$\nUsing only fundamental principles of the continuous wavelet transform, linear functionals of Gaussian processes, and the properties of the Morlet mother wavelet stated above, derive the closed-form analytic expression for the threshold $\\tau$ that achieves a prescribed false-alarm probability $\\mathsf{P}_{\\mathrm{FA}} = \\alpha$, with $\\alpha\\in(0,1)$.\nExpress your final threshold as a single closed-form expression in terms of $N_{0}$ and $\\alpha$. Do not include units in your final expression.", "solution": "We begin from the definition of the continuous wavelet transform (CWT),\n$$\nW_{x}(a,b) \\;=\\; \\left\\langle x,\\,\\psi_{a,b}\\right\\rangle\n\\;\\triangleq\\; \\int_{-\\infty}^{\\infty} x(t)\\,\\psi_{a,b}^{*}(t)\\,dt,\n$$\nwhere\n$$\n\\psi_{a,b}(t) \\;=\\; \\frac{1}{\\sqrt{a}}\\,\\psi\\!\\left(\\frac{t-b}{a}\\right).\n$$\nUnder the null hypothesis (noise only), $x(t)=n(t)$ is a zero-mean real Gaussian process with autocorrelation $R_{n}(\\tau)=(N_{0}/2)\\,\\delta(\\tau)$. The CWT coefficient $W_{n}(a,b)$ is therefore a complex-valued linear functional of a zero-mean Gaussian process, hence itself a zero-mean complex Gaussian random variable.\n\nWe first compute its second moment $E\\!\\left[\\,|W_{n}(a,b)|^{2}\\,\\right]$ from first principles. Using Fubini’s theorem and the whiteness of $n(t)$,\n$$\n\\begin{aligned}\nE\\!\\left[\\,|W_{n}(a,b)|^{2}\\,\\right]\n= E\\!\\left[\\left(\\int n(t)\\,\\psi_{a,b}^{*}(t)\\,dt\\right)\\left(\\int n(t')\\,\\psi_{a,b}(t')\\,dt'\\right)\\right] \\\\\n= \\iint E\\!\\left[n(t)\\,n(t')\\right]\\,\\psi_{a,b}^{*}(t)\\,\\psi_{a,b}(t')\\,dt\\,dt' \\\\\n= \\iint \\frac{N_{0}}{2}\\,\\delta(t-t')\\,\\psi_{a,b}^{*}(t)\\,\\psi_{a,b}(t')\\,dt\\,dt' \\\\\n= \\frac{N_{0}}{2}\\,\\int \\left|\\psi_{a,b}(t)\\right|^{2}\\,dt.\n\\end{aligned}\n$$\nBy construction, the energy of each scaled and translated wavelet equals the energy of the mother wavelet,\n$$\n\\int \\left|\\psi_{a,b}(t)\\right|^{2}\\,dt \\;=\\; \\int \\left|\\frac{1}{\\sqrt{a}}\\,\\psi\\!\\left(\\frac{t-b}{a}\\right)\\right|^{2}\\,dt\n\\;=\\; \\int |\\psi(u)|^{2}\\,du \\;=\\; 1,\n$$\nwhere we used the change of variables $u=(t-b)/a$. Therefore,\n$$\nE\\!\\left[\\,|W_{n}(a,b)|^{2}\\,\\right] \\;=\\; \\frac{N_{0}}{2}.\n$$\n\nNext, we establish the distribution of $|W_{n}(a,b)|^{2}$. We decompose $W_n(a,b)$ into its real and imaginary parts, which are projections of the noise onto the real and imaginary parts of the wavelet kernel. Each projection is a real zero-mean Gaussian random variable because $n(t)$ is Gaussian and the functionals are linear. The variances of these two parts are\n$$\n\\mathrm{Var}\\!\\left(\\Re\\{W_n(a,b)\\}\\right)\n= \\frac{N_{0}}{2}\\,\\left\\|\\Re\\{\\psi_{a,b}\\}\\right\\|_{2}^{2},\\qquad\n\\mathrm{Var}\\!\\left(\\Im\\{W_n(a,b)\\}\\right)\n= \\frac{N_{0}}{2}\\,\\left\\|\\Im\\{\\psi_{a,b}\\}\\right\\|_{2}^{2}.\n$$\nFor the complex Morlet wavelet $\\psi(t)=\\pi^{-1/4}\\exp(i\\omega_{\\psi}t)\\exp(-t^{2}/2)$,\n$$\n\\Re\\{\\psi(t)\\}=\\pi^{-1/4}\\cos(\\omega_{\\psi} t)\\exp(-t^{2}/2),\\qquad\n\\Im\\{\\psi(t)\\}=\\pi^{-1/4}\\sin(\\omega_{\\psi} t)\\exp(-t^{2}/2).\n$$\nTheir $L^{2}(\\mathbb{R})$ inner product is\n$$\n\\left\\langle \\Re\\{\\psi\\},\\Im\\{\\psi\\}\\right\\rangle\n= \\pi^{-1/2}\\int_{-\\infty}^{\\infty}\\exp(-t^{2})\\,\\cos(\\omega_{\\psi} t)\\,\\sin(\\omega_{\\psi} t)\\,dt\n= \\frac{\\pi^{-1/2}}{2}\\int_{-\\infty}^{\\infty}\\exp(-t^{2})\\,\\sin(2\\omega_{\\psi} t)\\,dt\n= 0,\n$$\nbecause the integrand is odd. Scaling and translation preserve orthogonality:\n$$\n\\left\\langle \\Re\\{\\psi_{a,b}\\},\\Im\\{\\psi_{a,b}\\}\\right\\rangle\n= \\int \\frac{1}{a}\\,\\Re\\!\\left\\{\\psi\\!\\left(\\frac{t-b}{a}\\right)\\right\\}\\,\\Im\\!\\left\\{\\psi\\!\\left(\\frac{t-b}{a}\\right)\\right\\}\\,dt\n= \\int \\Re\\{\\psi(u)\\}\\,\\Im\\{\\psi(u)\\}\\,du\n= 0.\n$$\nMoreover, since $\\|\\psi_{a,b}\\|_{2}^{2}=1$ and $|\\psi|^{2}=(\\Re\\psi)^{2}+(\\Im\\psi)^{2}$, symmetry of sinusoid and cosinusoid envelopes yields\n$$\n\\left\\|\\Re\\{\\psi_{a,b}\\}\\right\\|_{2}^{2}=\\left\\|\\Im\\{\\psi_{a,b}\\}\\right\\|_{2}^{2}=\\frac{1}{2}.\n$$\nTherefore,\n$$\n\\mathrm{Var}\\!\\left(\\Re\\{W_n(a,b)\\}\\right)\n=\\mathrm{Var}\\!\\left(\\Im\\{W_n(a,b)\\}\\right)\n= \\frac{N_{0}}{4},\n$$\nand, since the two projections are jointly Gaussian and uncorrelated, they are independent. Consequently, $W_{n}(a,b)$ is a proper (circular) complex Gaussian random variable with zero mean and\n$$\nE\\!\\left[\\,|W_{n}(a,b)|^{2}\\,\\right]\n= \\mathrm{Var}\\!\\left(\\Re\\{W_{n}\\}\\right)+\\mathrm{Var}\\!\\left(\\Im\\{W_{n}\\}\\right)\n= \\frac{N_{0}}{4}+\\frac{N_{0}}{4}\n= \\frac{N_{0}}{2}.\n$$\n\nLet $U \\triangleq |W_{n}(a_{0},b_{0})|^{2}$. Because $W_{n}$ is proper complex Gaussian with independent real and imaginary parts of equal variance, $U$ has an exponential distribution with mean $E[U]=N_{0}/2$. Its complementary cumulative distribution function under the null hypothesis is\n$$\n\\mathsf{P}\\!\\left(U\\tau\\,\\middle|\\,H_{0}\\right) \\;=\\; \\exp\\!\\left(-\\frac{\\tau}{E[U]}\\right)\n\\;=\\; \\exp\\!\\left(-\\frac{2\\,\\tau}{N_{0}}\\right).\n$$\nThe detector declares a detection if $U\\tau$. To achieve a prescribed false-alarm probability $\\mathsf{P}_{\\mathrm{FA}}=\\alpha$, we impose\n$$\n\\alpha \\;=\\; \\mathsf{P}\\!\\left(U\\tau\\,\\middle|\\,H_{0}\\right) \\;=\\; \\exp\\!\\left(-\\frac{2\\,\\tau}{N_{0}}\\right),\n$$\nwhich solves uniquely for $\\tau$ as\n$$\n\\tau \\;=\\; -\\,\\frac{N_{0}}{2}\\,\\ln(\\alpha).\n$$\n\nThis threshold is independent of the scale $a_{0}$ and translation $b_{0}$ because the white-noise variance after projection onto any unit-energy wavelet is invariant, and the Morlet wavelet yields a proper complex Gaussian coefficient under the stated assumptions. The requested closed-form expression in terms of $N_{0}$ and $\\alpha$ is thus established.", "answer": "$$\\boxed{-\\frac{N_{0}}{2}\\,\\ln(\\alpha)}$$", "id": "2860073"}]}