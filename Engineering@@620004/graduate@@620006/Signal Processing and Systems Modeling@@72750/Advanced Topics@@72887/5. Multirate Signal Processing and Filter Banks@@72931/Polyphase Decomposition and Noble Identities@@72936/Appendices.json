{"hands_on_practices": [{"introduction": "The primary motivation for employing polyphase structures in multirate systems is the dramatic reduction in computational load. This exercise provides a foundational proof of this benefit by comparing a naive high-rate filtering approach with an efficient polyphase implementation. By deriving the speedup factor, $\\mathcal{S}$, from first principles [@problem_id:2892214], you will cement your understanding of why the noble identities are a cornerstone of efficient digital signal processing.", "problem": "Consider a discrete-time linear time-invariant system that reduces the sampling rate of a real-valued input sequence by an overall integer factor. The system consists of a single finite impulse response (FIR) anti-aliasing prototype filter followed by a cascade of decimators. Let the prototype filter have impulse response $h[n]$ with exactly $L$ nonzero real coefficients, $h[0],\\dots,h[L-1]$, and let the cascade of decimators consist of $K$ downsamplers with integer factors $M_1,\\dots,M_K\\geq 2$. The overall decimation factor is $D=\\prod_{i=1}^{K} M_i$.\n\nAssume the following:\n- The baseline implementation applies the length-$L$ FIR filter to all input samples at the original high rate and then performs the cascade of decimations. Count only real multiplications by nontrivial coefficients; ignore additions, memory operations, and any multiplications by zero or by $\\pm 1$.\n- The efficient implementation uses the noble identities to move the prototype filter entirely across the decimator cascade to the lowest sampling rate and realizes the result without redundant operations via a polyphase structure, so that no high-rate filtering is performed.\n- Decimators themselves have no multiplicative cost.\n- Long-run average cost is considered, ignoring transient startup and end effects.\n- Do not exploit coefficient symmetry or special structure beyond what is implied by the noble identities and polyphase decomposition.\n\nDefine the speedup factor $\\mathcal{S}$ as the ratio of the baseline multiplicative cost per input sample to the efficient multiplicative cost per input sample. Derive, from first principles and core definitions of discrete-time convolution, decimation, and the noble identities, a closed-form expression for $\\mathcal{S}$ in terms of $M_1,\\dots,M_K$ only. Express your final answer as a single simplified analytic expression. No rounding is required, and no units are needed.", "solution": "The problem requires the derivation of a speedup factor, $\\mathcal{S}$, which is defined as the ratio of the computational cost of a baseline decimator implementation to that of an efficient polyphase implementation. The cost is measured in terms of real multiplications per input sample.\n\nLet us begin by formalizing the system and the two implementation schemes. The input is a real-valued discrete-time sequence $x[n]$. The system consists of a finite impulse response (FIR) filter with impulse response $h[n]$ of length $L$ followed by a cascade of $K$ decimators with factors $M_1, M_2, \\dots, M_K$. The overall decimation factor is $D = \\prod_{i=1}^{K} M_i$.\n\nFirst, we analyze the baseline implementation.\nIn this configuration, the input signal $x[n]$ is first convolved with the FIR filter $h[n]$ to produce an intermediate signal $y[n]$. The convolution sum is given by:\n$$ y[n] = (x * h)[n] = \\sum_{k=0}^{L-1} h[k] x[n-k] $$\nThe problem states that the filter has exactly $L$ nonzero real coefficients, which are considered non-trivial (i.e., not equal to $\\pm 1$). To compute a single sample $y[n]$ of the intermediate signal, it is necessary to perform $L$ real multiplications. This filtering operation is performed at the high input sampling rate. For each new input sample $x[n]$, a new output sample $y[n]$ is computed. Therefore, the computational cost of the filtering stage is $L$ multiplications per input sample. The subsequent cascade of decimators discards samples of $y[n]$ but, according to the problem statement, contributes no multiplicative cost. Thus, the total cost of the baseline implementation, denoted $C_{baseline}$, is determined solely by the initial filtering stage.\n$$ C_{baseline} = L \\text{ multiplications per input sample} $$\n\nNext, we analyze the efficient implementation.\nThis implementation uses the noble identities to interchange the filtering and decimation operations, realizing the system in a polyphase structure. The cascade of $K$ decimators is equivalent to a single decimation operation by the total factor $D$. The overall system in the baseline case is thus a filter $H(z)$ followed by a downsampler $\\downarrow D$. The noble identity for decimation states that a filter $H(z)$ followed by a downsampler $\\downarrow D$ can be reconfigured. The most efficient realization avoids computing the intermediate samples of $y[n]$ that are ultimately discarded.\n\nThe final output sequence, let us call it $y_D[m]$, consists of samples of $y[n]$ taken at intervals of $D$. That is:\n$$ y_D[m] = y[mD] $$\nSubstituting the expression for $y[n]$, we obtain a direct relationship between the input $x[n]$ and the final output $y_D[m]$:\n$$ y_D[m] = \\sum_{k=0}^{L-1} h[k] x[mD - k] $$\nThis equation represents the computation that must be performed in any efficient implementation. To calculate a single output sample $y_D[m]$, one must perform a dot product of length $L$ between the filter coefficient vector $(h[0], \\dots, h[L-1])$ and a segment of the input signal. This requires $L$ real multiplications.\n\nCrucially, one output sample $y_D[m]$ is generated for every $D$ samples of the input signal $x[n]$. To determine the cost per input sample, we must amortize the cost of computing one output sample over the $D$ input samples that are processed to produce it. The average computational cost for the efficient implementation, denoted $C_{efficient}$, is therefore $L$ multiplications for every $D$ input samples.\n$$ C_{efficient} = \\frac{L}{D} \\text{ multiplications per input sample} $$\nThe polyphase decomposition is the canonical structure that achieves this minimal computational cost by splitting the filter $h[n]$ into $D$ sub-filters (the polyphase components) that operate at the low sampling rate, thereby avoiding any redundant computations at the high rate. Our direct cost analysis confirms the well-known efficiency of this structure.\n\nFinally, we compute the speedup factor $\\mathcal{S}$. It is defined as the ratio of the baseline cost to the efficient cost.\n$$ \\mathcal{S} = \\frac{C_{baseline}}{C_{efficient}} $$\nSubstituting the derived expressions for the costs:\n$$ \\mathcal{S} = \\frac{L}{L/D} = D $$\nThe problem asks for the expression in terms of the individual decimation factors $M_1, \\dots, M_K$. Substituting the definition of $D$:\n$$ \\mathcal{S} = \\prod_{i=1}^{K} M_i $$\nThis result shows that the speedup is equal to the total decimation factor, and as required, the filter length $L$ cancels out and does not appear in the final expression. The speedup is independent of the filter itself, and is purely a function of the rate-change structure.", "answer": "$$\\boxed{\\prod_{i=1}^{K} M_i}$$", "id": "2892214"}, {"introduction": "While polyphase structures offer immense efficiency, their performance in real-world systems hinges on the quality of the associated filters. This practice problem moves beyond ideal theory to explore the practical consequences of using a non-ideal anti-aliasing filter, a common scenario in system design. By quantifying the residual alias power, $P_{\\mathrm{alias}}$, for a given filter response [@problem_id:2892173], you will develop a deeper appreciation for the critical relationship between filter specifications and the integrity of the output signal in a decimator.", "problem": "A real, zero-mean, wide-sense stationary discrete-time input process $x[n]$ with variance $\\sigma_{x}^{2}$ and power spectral density $S_{x}(\\omega)=\\sigma_{x}^{2}$ for $\\omega\\in[-\\pi,\\pi]$ (white) is first passed through a causal, stable, linear time-invariant anti-aliasing filter with frequency response $H(\\mathrm{e}^{\\mathrm{j}\\omega})$, and then downsampled by an integer factor $M\\geq 2$. The anti-aliasing filter is implemented using a type-1 $M$-branch polyphase decomposition $H(z)=\\sum_{m=0}^{M-1}z^{-m}E_{m}(z^{M})$, together with the noble identity for decimation to move the downsampler across the polyphase network. The anti-alias filter transition band is insufficient in the sense that it is not completely attenuated before the folding frequency $\\omega=\\pi/M$, so that residual aliasing occurs.\n\nUsing only the definitions of linear time-invariant filtering of a wide-sense stationary process, the properties of decimation and the noble identities for multirate systems, and the polyphase decomposition of $H(z)$ (without invoking any shortcut formulas beyond these foundations), perform the following:\n\n1. Derive an exact expression for the residual aliasing power at the output, denoted $P_{\\mathrm{alias}}$, defined as the total output power contributed exclusively by the folded spectral images introduced by decimation (i.e., all images other than the baseband component). Express $P_{\\mathrm{alias}}$ in terms of $M$, $\\sigma_{x}^{2}$, and $H(\\mathrm{e}^{\\mathrm{j}\\omega})$ as a single closed-form analytic expression, and relate it explicitly to the overlap of aliased spectra.\n\n2. Specialize your result to the following insufficient-transition prototype magnitude response (angles in radians):\n   - $|H(\\mathrm{e}^{\\mathrm{j}\\omega})|=1$ for $|\\omega|\\leq \\omega_{c}$,\n   - $|H(\\mathrm{e}^{\\mathrm{j}\\omega})|=1-\\dfrac{|\\omega|-\\omega_{c}}{\\Delta}$ for $\\omega_{c}|\\omega|\\omega_{c}+\\Delta$,\n   - $|H(\\mathrm{e}^{\\mathrm{j}\\omega})|=0$ for $|\\omega|\\geq \\omega_{c}+\\Delta$,\n   with parameters obeying $0\\omega_{c}\\dfrac{\\pi}{M}\\omega_{c}+\\Delta\\pi$.\n\nEvaluate $P_{\\mathrm{alias}}$ in closed form in terms of $M$, $\\sigma_{x}^{2}$, $\\omega_{c}$, and $\\Delta$. Provide your final answer as a single analytic expression. No numerical approximation or rounding is required.", "solution": "The posed problem has undergone validation and is determined to be valid. It is a well-defined problem in the field of statistical digital signal processing, resting upon sound scientific and mathematical principles. It is self-contained, consistent, and admits a unique, meaningful solution. We may therefore proceed with the derivation and calculation.\n\nThe system under consideration involves a wide-sense stationary (WSS) input process $x[n]$ filtered by a linear time-invariant (LTI) system $H(z)$ to produce an intermediate signal $v[n]$, which is then downsampled by an integer factor $M$ to yield the output $y[n]$.\n\nThe input process $x[n]$ is real, zero-mean, and white, with a constant power spectral density (PSD) $S_x(\\omega) = \\sigma_x^2$ for $\\omega \\in [-\\pi, \\pi]$, where $\\sigma_x^2$ is the variance of the process.\n\nThe intermediate signal is $v[n] = (x * h)[n]$, where $h[n]$ is the impulse response of the filter $H(z)$. Since $x[n]$ is WSS and the filter is LTI, $v[n]$ is also WSS. Its PSD is given by:\n$$S_v(\\omega) = S_x(\\omega) |H(\\mathrm{e}^{\\mathrm{j}\\omega})|^2 = \\sigma_x^2 |H(\\mathrm{e}^{\\mathrm{j}\\omega})|^2$$\nThe problem statement indicates the use of a polyphase implementation for the filter-decimator system. This is an efficient implementation structure that is mathematically equivalent to the direct form of filtering followed by downsampling. The statistical properties of the output are identical, so for this analysis, we consider the direct form: $v[n]$ is first computed, and then the output $y[n]$ is formed by decimation: $y[n] = v[Mn]$.\n\nTo find the PSD of the output signal $y[n]$, we first find its autocorrelation function, $R_y[l]$:\n$$R_y[l] = E\\left[y[n] y^*[n-l]\\right] = E\\left[v[Mn] v^*[M(n-l)]\\right] = R_v[Ml]$$\nThe PSD of $y[n]$, denoted $S_y(\\omega)$, is the discrete-time Fourier transform of $R_y[l]$. Using the relation between the PSD of a decimated signal and the original signal's PSD, which can be derived from the expression for $R_y[l]$ using the Poisson summation formula, we have:\n$$S_y(\\omega) = \\frac{1}{M} \\sum_{k=0}^{M-1} S_v\\left(\\frac{\\omega - 2\\pi k}{M}\\right), \\quad \\omega \\in [-\\pi, \\pi]$$\nSubstituting the expression for $S_v(\\omega)$:\n$$S_y(\\omega) = \\frac{\\sigma_x^2}{M} \\sum_{k=0}^{M-1} \\left|H\\left(\\mathrm{e}^{\\mathrm{j}(\\omega - 2\\pi k)/M}\\right)\\right|^2$$\nThis expression shows that the output PSD is a sum of $M$ scaled and frequency-warped versions of the filtered PSD $|H(\\mathrm{e}^{\\mathrm{j}\\omega})|^2$. The term for $k=0$ corresponds to the baseband component of the spectrum. The terms for $k=1, 2, \\dots, M-1$ correspond to aliased components that are shifted by multiples of $2\\pi/M$ before frequency scaling and are folded into the baseband $[-\\pi, \\pi]$.\n\nThe aliasing power, $P_{\\mathrm{alias}}$, is defined as the total power contributed by these folded spectral images. This is the power associated with the terms $k=1, \\dots, M-1$. The PSD of the aliasing component is thus:\n$$S_{y, \\mathrm{alias}}(\\omega) = \\frac{\\sigma_x^2}{M} \\sum_{k=1}^{M-1} \\left|H\\left(\\mathrm{e}^{\\mathrm{j}(\\omega - 2\\pi k)/M}\\right)\\right|^2$$\nThe total aliasing power is the integral of this PSD over the frequency interval $[-\\pi, \\pi]$:\n$$P_{\\mathrm{alias}} = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} S_{y, \\mathrm{alias}}(\\omega) \\, d\\omega = \\frac{\\sigma_x^2}{2\\pi M} \\int_{-\\pi}^{\\pi} \\sum_{k=1}^{M-1} \\left|H\\left(\\mathrm{e}^{\\mathrm{j}(\\omega - 2\\pi k)/M}\\right)\\right|^2 \\, d\\omega$$\nWe can interchange the summation and integration:\n$$P_{\\mathrm{alias}} = \\frac{\\sigma_x^2}{2\\pi M} \\sum_{k=1}^{M-1} \\int_{-\\pi}^{\\pi} \\left|H\\left(\\mathrm{e}^{\\mathrm{j}(\\omega - 2\\pi k)/M}\\right)\\right|^2 \\, d\\omega$$\nFor each term in the summation, we perform a change of variable $\\theta = (\\omega - 2\\pi k)/M$. This gives $d\\omega = M d\\theta$. The limits of integration for $\\theta$ become $(-\\pi - 2\\pi k)/M$ and $(\\pi - 2\\pi k)/M$.\n$$P_{\\mathrm{alias}} = \\frac{\\sigma_x^2}{2\\pi M} \\sum_{k=1}^{M-1} \\int_{(-\\pi - 2\\pi k)/M}^{(\\pi - 2\\pi k)/M} |H(\\mathrm{e}^{\\mathrm{j}\\theta})|^2 \\, (M d\\theta) = \\frac{\\sigma_x^2}{2\\pi} \\sum_{k=1}^{M-1} \\int_{I_k} |H(\\mathrm{e}^{\\mathrm{j}\\theta})|^2 \\, d\\theta$$\nwhere $I_k = [-(2k+1)\\pi/M, (1-2k)\\pi/M]$. The collection of intervals $\\{I_k\\}_{k=1}^{M-1}$ along with their symmetric positive counterparts (since $|H(\\mathrm{e}^{\\mathrm{j}\\omega})|^2$ is an even function for a real filter) covers the entire frequency range $[-\\pi, \\pi]$ except for the baseband interval $[-\\pi/M, \\pi/M]$. Therefore, the sum of these integrals is equivalent to integrating $|H(\\mathrm{e}^{\\mathrm{j}\\omega})|^2$ over the region $|\\omega|  \\pi/M$.\nThis result explicitly relates the aliasing power to the overlap of aliased spectra, as it is derived from integrating the shifted spectral components. A more direct, equivalent interpretation is that aliasing power is the power of the signal $v[n]$ that lies outside the Nyquist band $[-\\pi/M, \\pi/M]$ of the downsampled signal. This power folds into the baseband upon decimation.\n\nThus, we arrive at the general expression for the aliasing power:\n$$P_{\\mathrm{alias}} = \\frac{\\sigma_x^2}{2\\pi} \\int_{|\\omega| \\in [\\pi/M, \\pi]} |H(\\mathrm{e}^{\\mathrm{j}\\omega})|^2 \\, d\\omega$$\nSince $|H(\\mathrm{e}^{\\mathrm{j}\\omega})|^2$ is an even function of $\\omega$, we can simplify this to:\n$$P_{\\mathrm{alias}} = 2 \\cdot \\frac{\\sigma_x^2}{2\\pi} \\int_{\\pi/M}^{\\pi} |H(\\mathrm{e}^{\\mathrm{j}\\omega})|^2 \\, d\\omega = \\frac{\\sigma_x^2}{\\pi} \\int_{\\pi/M}^{\\pi} |H(\\mathrm{e}^{\\mathrm{j}\\omega})|^2 \\, d\\omega$$\nThis completes the first part of the problem.\n\nFor the second part, we must evaluate this expression for the given filter magnitude response:\n$$|H(\\mathrm{e}^{\\mathrm{j}\\omega})| = \\begin{cases} 1  |\\omega|\\leq \\omega_{c} \\\\ 1-\\dfrac{|\\omega|-\\omega_{c}}{\\Delta}  \\omega_{c}|\\omega|\\omega_{c}+\\Delta \\\\ 0  |\\omega|\\geq \\omega_{c}+\\Delta \\end{cases}$$\nwith parameters satisfying $0  \\omega_c  \\pi/M  \\omega_c + \\Delta  \\pi$.\nThe integration is over the range $[\\pi/M, \\pi]$. Given the filter's stopband begins at $\\omega_c+\\Delta  \\pi$, the effective upper limit of integration is $\\omega_c+\\Delta$. The lower limit $\\pi/M$ falls within the filter's transition band since $\\omega_c  \\pi/M  \\omega_c+\\Delta$.\nFor $\\omega$ in the integration range $[\\pi/M, \\omega_c+\\Delta]$, the integrand is $|H(\\mathrm{e}^{\\mathrm{j}\\omega})|^2 = \\left(1-\\frac{\\omega-\\omega_{c}}{\\Delta}\\right)^2$, as $\\omega  0$.\nThe aliasing power is:\n$$P_{\\mathrm{alias}} = \\frac{\\sigma_x^2}{\\pi} \\int_{\\pi/M}^{\\omega_c+\\Delta} \\left(1-\\frac{\\omega-\\omega_c}{\\Delta}\\right)^2 d\\omega$$\nTo solve the integral, let's simplify the integrand:\n$$1-\\frac{\\omega-\\omega_c}{\\Delta} = \\frac{\\Delta - (\\omega-\\omega_c)}{\\Delta} = \\frac{\\Delta + \\omega_c - \\omega}{\\Delta}$$\nSo the integral is:\n$$I = \\int_{\\pi/M}^{\\omega_c+\\Delta} \\left(\\frac{\\Delta + \\omega_c - \\omega}{\\Delta}\\right)^2 d\\omega = \\frac{1}{\\Delta^2} \\int_{\\pi/M}^{\\omega_c+\\Delta} (\\Delta + \\omega_c - \\omega)^2 d\\omega$$\nLet $u = \\Delta + \\omega_c - \\omega$. Then $du = -d\\omega$. The limits of integration change as follows:\n- Lower limit: $\\omega = \\pi/M \\implies u = \\Delta + \\omega_c - \\pi/M$.\n- Upper limit: $\\omega = \\omega_c + \\Delta \\implies u = \\Delta + \\omega_c - (\\omega_c + \\Delta) = 0$.\n\n$$I = \\frac{1}{\\Delta^2} \\int_{\\Delta + \\omega_c - \\pi/M}^{0} u^2 (-du) = \\frac{1}{\\Delta^2} \\int_{0}^{\\Delta + \\omega_c - \\pi/M} u^2 du$$\n$$I = \\frac{1}{\\Delta^2} \\left[ \\frac{u^3}{3} \\right]_{0}^{\\Delta + \\omega_c - \\pi/M} = \\frac{1}{3\\Delta^2} (\\Delta + \\omega_c - \\pi/M)^3$$\nSubstituting this back into the expression for $P_{\\mathrm{alias}}$:\n$$P_{\\mathrm{alias}} = \\frac{\\sigma_x^2}{\\pi} \\cdot \\frac{(\\omega_c + \\Delta - \\pi/M)^3}{3\\Delta^2}$$\nThis is the final closed-form expression for the residual aliasing power under the specified conditions.", "answer": "$$\\boxed{\\frac{\\sigma_x^2 (\\omega_c + \\Delta - \\frac{\\pi}{M})^3}{3\\pi\\Delta^2}}$$", "id": "2892173"}, {"introduction": "The power of the polyphase framework extends far beyond simple decimators and into the design of sophisticated systems like perfect reconstruction (PR) filter banks. This exercise demonstrates how polyphase decomposition serves as a powerful analytical tool to achieve alias cancellation, a key requirement for PR systems. By deriving the alias-cancellation conditions and applying them to a concrete example [@problem_id:2892222], you will see how these components can be artfully arranged to perfectly deconstruct and then reconstruct a signal.", "problem": "Consider a critically sampled two-channel analysis–synthesis filter bank. The input sequence has bilateral $z$-transform $X(z)$, and the analysis filters are $H_{0}(z)$ and $H_{1}(z)$, followed by downsampling by $2$. The synthesis filters are $G_{0}(z)$ and $G_{1}(z)$, each preceded by upsampling by $2$, and their outputs are summed to form $Y(z)$. Perfect Reconstruction (PR) means there exist an integer delay $k \\in \\mathbb{Z}$ and a nonzero scalar $c \\in \\mathbb{R}$ such that $Y(z) = c z^{-k} X(z)$ for all $X(z)$.\n\nAll analysis and synthesis filters admit the type-1 polyphase decompositions\n$$\n\\begin{aligned}\nH_{0}(z) = E_{00}(z^{2}) + z^{-1} E_{01}(z^{2}), \\\\\nH_{1}(z) = E_{10}(z^{2}) + z^{-1} E_{11}(z^{2}), \\\\\nG_{0}(z) = R_{00}(z^{2}) + z^{-1} R_{01}(z^{2}), \\\\\nG_{1}(z) = R_{10}(z^{2}) + z^{-1} R_{11}(z^{2}),\n\\end{aligned}\n$$\nwhere $E_{ij}(z)$ and $R_{ij}(z)$ are the polyphase components. Use only fundamental multirate identities, the definition of downsampling and upsampling in the $z$-domain, and the above decompositions to do the following.\n\n1) Starting from first principles, derive an input–output relation of the form\n$$\nY(z) \\;=\\; \\tfrac{1}{2}\\Big(T_{0}(z)\\,X(z) \\;+\\; T_{1}(z)\\,X(-z)\\Big),\n$$\nwhere $T_{0}(z)$ and $T_{1}(z)$ depend on $H_{0}(z)$, $H_{1}(z)$, $G_{0}(z)$, and $G_{1}(z)$. Identify $T_{1}(z)$ as the alias transfer function. Then, using the type-1 polyphase decompositions shown above, express $T_{1}(z)$ explicitly in terms of $E_{ij}(z^{2})$ and $R_{ij}(z^{2})$, and derive necessary and sufficient alias-cancellation conditions purely as cross-relations among the polyphase components.\n\n2) Consider the concrete analysis–synthesis choice\n$$\nH_{0}(z) \\;=\\; \\tfrac{1}{2}\\big(1 + z^{-1}\\big), \\quad\nH_{1}(z) \\;=\\; \\tfrac{1}{2}\\big(1 - z^{-1}\\big), \\quad\nG_{0}(z) \\;=\\; \\tfrac{1}{2}\\big(1 + z^{-1}\\big), \\quad\nG_{1}(z) \\;=\\; -\\,\\tfrac{1}{2}\\big(1 - z^{-1}\\big).\n$$\nCompute the four polyphase components $E_{ij}(z)$ and $R_{ij}(z)$ for this example, verify your alias-cancellation conditions from part 1), and determine the overall distortion transfer function $D(z)$ such that $Y(z) = D(z)\\,X(z)$ when aliasing is cancelled. Express your final answer as a single closed-form expression in the complex indeterminate $z$. Do not include units. Do not present an equation; present only the expression for $D(z)$.", "solution": "The problem proposed is a standard exercise in multirate signal processing, involving the analysis of a two-channel filter bank. It is scientifically grounded, well-posed, and contains all necessary information for a unique solution. The problem is therefore deemed valid. We proceed with the solution in two parts as requested.\n\nPart 1: Derivation of the Input-Output Relation and Alias-Cancellation Conditions\n\nLet the input signal have a $z$-transform $X(z)$. The signal passes through two parallel channels, indexed by $k=0,1$. In each channel, the signal is first filtered by an analysis filter $H_k(z)$, then downsampled by a factor of $M=2$. The resulting signals are then upsampled by $M=2$, passed through synthesis filters $G_k(z)$, and summed to produce the output $Y(z)$.\n\nThe output of the $k$-th analysis filter is $V_k(z) = H_k(z)X(z)$. The $z$-transform of a signal downsampled by $2$ is given by the identity that relates the output transform to the input transform. Let the signal at the output of the downsampler be $v'_k(n)$, its transform is $V'_k(z)$. The signal at the input of the synthesis filter $G_k(z)$ is the upsampled version of $v'_k(n)$, its transform is $U_k(z) = V'_k(z^2)$. Using the fundamental identity for a downsampler followed by an upsampler, we can write the transform $U_k(z)$ directly in terms of $V_k(z)$:\n$$\nU_k(z) = \\frac{1}{2} \\Big( V_k(z) + V_k(-z) \\Big)\n$$\nSubstituting $V_k(z) = H_k(z)X(z)$, we find the signal at the input of the synthesis filter $G_k(z)$ to be:\n$$\nU_k(z) = \\frac{1}{2} \\Big( H_k(z)X(z) + H_k(-z)X(-z) \\Big)\n$$\nThe output of the $k$-th synthesis filter is $G_k(z)U_k(z)$. The final output $Y(z)$ is the sum over both channels:\n$$\nY(z) = \\sum_{k=0}^{1} G_k(z)U_k(z) = \\sum_{k=0}^{1} G_k(z) \\left[ \\frac{1}{2} \\Big( H_k(z)X(z) + H_k(-z)X(-z) \\Big) \\right]\n$$\nWe can regroup the terms with respect to $X(z)$ and $X(-z)$:\n$$\nY(z) = \\frac{1}{2} \\left( \\sum_{k=0}^{1} G_k(z)H_k(z) \\right) X(z) + \\frac{1}{2} \\left( \\sum_{k=0}^{1} G_k(z)H_k(-z) \\right) X(-z)\n$$\nThis matches the requested form $Y(z) = \\frac{1}{2}\\Big(T_0(z)X(z) + T_1(z)X(-z)\\Big)$, where the distortion transfer function is $T_0(z) = \\sum_{k=0}^{1} G_k(z)H_k(z)$ and the alias transfer function is $T_1(z) = \\sum_{k=0}^{1} G_k(z)H_k(-z)$.\n\nFor alias cancellation, we require $T_1(z) = 0$ for all $z$. We will now express $T_1(z)$ in terms of the polyphase components. The type-1 polyphase decompositions are given as:\n$H_k(z) = E_{k0}(z^2) + z^{-1}E_{k1}(z^2)$\n$G_k(z) = R_{k0}(z^2) + z^{-1}R_{k1}(z^2)$\nFrom this, we find the expression for $H_k(-z)$:\n$H_k(-z) = E_{k0}((-z)^2) + (-z)^{-1}E_{k1}((-z)^2) = E_{k0}(z^2) - z^{-1}E_{k1}(z^2)$.\n\nNow, we compute the product $G_k(z)H_k(-z)$:\n$$\nG_k(z)H_k(-z) = \\Big( R_{k0}(z^2) + z^{-1}R_{k1}(z^2) \\Big) \\Big( E_{k0}(z^2) - z^{-1}E_{k1}(z^2) \\Big)\n$$\n$$\n= R_{k0}(z^2)E_{k0}(z^2) - z^{-1}R_{k0}(z^2)E_{k1}(z^2) + z^{-1}R_{k1}(z^2)E_{k0}(z^2) - z^{-2}R_{k1}(z^2)E_{k1}(z^2)\n$$\nThe alias transfer function $T_1(z)$ is the sum of these products over $k=0,1$:\n$$\nT_1(z) = \\sum_{k=0}^{1} \\Big[ \\big( R_{k0}(z^2)E_{k0}(z^2) - z^{-2}R_{k1}(z^2)E_{k1}(z^2) \\big) + z^{-1}\\big( R_{k1}(z^2)E_{k0}(z^2) - R_{k0}(z^2)E_{k1}(z^2) \\big) \\Big]\n$$\nThis expression is a sum of an even function of $z$ (terms with even powers of $z$, which are functions of $z^2$) and an odd function of $z$ (the term proportional to $z^{-1}$). For $T_1(z)$ to be identically zero, both the even and odd parts must be zero independently. This gives two necessary and sufficient conditions for alias cancellation:\n\n1. The sum of coefficients of the $z^{-1}$ term must be zero:\n$$\n\\sum_{k=0}^{1} \\Big( R_{k1}(z^2)E_{k0}(z^2) - R_{k0}(z^2)E_{k1}(z^2) \\Big) = 0\n$$\n$$\n\\Big( R_{01}(z^2)E_{00}(z^2) - R_{00}(z^2)E_{01}(z^2) \\Big) + \\Big( R_{11}(z^2)E_{10}(z^2) - R_{10}(z^2)E_{11}(z^2) \\Big) = 0\n$$\n\n2. The sum of the purely even-powered terms must be zero:\n$$\n\\sum_{k=0}^{1} \\Big( R_{k0}(z^2)E_{k0}(z^2) - z^{-2}R_{k1}(z^2)E_{k1}(z^2) \\Big) = 0\n$$\n$$\n\\Big( R_{00}(z^2)E_{00}(z^2) + R_{10}(z^2)E_{10}(z^2) \\Big) - z^{-2}\\Big( R_{01}(z^2)E_{01}(z^2) + R_{11}(z^2)E_{11}(z^2) \\Big) = 0\n$$\nThese are the required alias-cancellation conditions expressed in terms of the polyphase components.\n\nPart 2: Verification and Calculation for a Specific Filter Bank\n\nThe given filters are:\n$H_0(z) = \\frac{1}{2} + \\frac{1}{2}z^{-1}$, $H_1(z) = \\frac{1}{2} - \\frac{1}{2}z^{-1}$\n$G_0(z) = \\frac{1}{2} + \\frac{1}{2}z^{-1}$, $G_1(z) = -\\frac{1}{2} + \\frac{1}{2}z^{-1}$\n\nWe extract the polyphase components $E_{ij}(z)$ and $R_{ij}(z)$ by decomposing each filter $F(z)$ into $F(z) = F_e(z^2) + z^{-1}F_o(z^2)$, where $F_e(z)$ and $F_o(z)$ are the polyphase components. For these simple FIR filters, the components are constants.\nFor $H_0(z)$: $E_{00}(z) = \\frac{1}{2}$, $E_{01}(z) = \\frac{1}{2}$.\nFor $H_1(z)$: $E_{10}(z) = \\frac{1}{2}$, $E_{11}(z) = -\\frac{1}{2}$.\nFor $G_0(z)$: $R_{00}(z) = \\frac{1}{2}$, $R_{01}(z) = \\frac{1}{2}$.\nFor $G_1(z)$: $R_{10}(z) = -\\frac{1}{2}$, $R_{11}(z) = \\frac{1}{2}$.\n\nNow, we verify the alias-cancellation conditions.\nCondition 1:\n$$\n\\Big( (\\frac{1}{2})(\\frac{1}{2}) - (\\frac{1}{2})(\\frac{1}{2}) \\Big) + \\Big( (\\frac{1}{2})(\\frac{1}{2}) - (-\\frac{1}{2})(-\\frac{1}{2}) \\Big) = \\Big( \\frac{1}{4} - \\frac{1}{4} \\Big) + \\Big( \\frac{1}{4} - \\frac{1}{4} \\Big) = 0 + 0 = 0\n$$\nThe first condition is satisfied.\n\nCondition 2:\n$$\n\\Big( (\\frac{1}{2})(\\frac{1}{2}) + (-\\frac{1}{2})(\\frac{1}{2}) \\Big) - z^{-2}\\Big( (\\frac{1}{2})(\\frac{1}{2}) + (\\frac{1}{2})(-\\frac{1}{2}) \\Big)\n$$\n$$\n= \\Big( \\frac{1}{4} - \\frac{1}{4} \\Big) - z^{-2}\\Big( \\frac{1}{4} - \\frac{1}{4} \\Big) = 0 - z^{-2}(0) = 0\n$$\nThe second condition is also satisfied. Thus, aliasing is perfectly cancelled for this system, and $T_1(z) = 0$.\n\nThe input-output relation simplifies to $Y(z) = \\frac{1}{2}T_0(z)X(z)$. The overall distortion transfer function is $D(z) = \\frac{1}{2}T_0(z)$. We compute $T_0(z)$:\n$$\nT_0(z) = G_0(z)H_0(z) + G_1(z)H_1(z)\n$$\n$$\nT_0(z) = \\left( \\frac{1}{2}(1+z^{-1}) \\right) \\left( \\frac{1}{2}(1+z^{-1}) \\right) + \\left( -\\frac{1}{2}(1-z^{-1}) \\right) \\left( \\frac{1}{2}(1-z^{-1}) \\right)\n$$\n$$\nT_0(z) = \\frac{1}{4}(1+z^{-1})^2 - \\frac{1}{4}(1-z^{-1})^2\n$$\n$$\nT_0(z) = \\frac{1}{4} \\Big( (1+2z^{-1}+z^{-2}) - (1-2z^{-1}+z^{-2}) \\Big)\n$$\n$$\nT_0(z) = \\frac{1}{4} \\Big( 1+2z^{-1}+z^{-2} - 1+2z^{-1}-z^{-2} \\Big) = \\frac{1}{4}(4z^{-1}) = z^{-1}\n$$\nFinally, the overall distortion transfer function $D(z)$ is:\n$$\nD(z) = \\frac{1}{2}T_0(z) = \\frac{1}{2}z^{-1}\n$$", "answer": "$$\n\\boxed{\\frac{1}{2}z^{-1}}\n$$", "id": "2892222"}]}