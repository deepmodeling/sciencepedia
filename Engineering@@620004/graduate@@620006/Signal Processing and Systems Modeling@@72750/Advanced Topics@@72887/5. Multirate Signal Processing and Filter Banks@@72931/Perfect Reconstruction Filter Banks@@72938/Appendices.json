{"hands_on_practices": [{"introduction": "The promise of perfect reconstruction (PR) rests on a simple yet powerful algebraic condition in the polyphase domain. This first exercise takes you back to basics, where you will analyze a given analysis polyphase matrix $E(z)$ to determine if it allows for PR with minimal delay [@problem_id:2890705]. By calculating its determinant and its inverse from first principles, you will solidify your understanding of how matrix unimodularity is the key to lossless signal reconstruction.", "problem": "Consider a critically sampled two-channel filter bank in polyphase form. Let the analysis polyphase matrix be the square polynomial matrix\n$$\nE(z) \\;=\\; \\begin{pmatrix}\n1 + z^{-1} & z^{-1} \\\\\n1 & 1\n\\end{pmatrix},\n$$\nwhose entries are polynomials in the delay variable $z^{-1}$. The perfect reconstruction (PR) condition in polyphase form states that there must exist a synthesis polyphase matrix $R(z)$ with polynomial entries and a nonnegative integer delay $d$ such that\n$$\nR(z)\\,E(z) \\;=\\; z^{-d}\\,I,\n$$\nwhere $I$ is the identity matrix. Assume throughout that all polynomial operations are carried out over the ring of polynomials in $z^{-1}$ with coefficients in the complex field.\n\nStarting only from the PR definition above and elementary linear-algebraic facts (determinant, adjugate, and invertibility over a commutative ring), do the following:\n\n- Determine whether $E(z)$ is unimodular and hence whether the minimal attainable delay $d$ can be taken to be $0$.\n- Derive a synthesis polyphase matrix $R(z)$ with minimal polynomial degrees in its entries that satisfies the PR condition with the minimal delay.\n- Verify PR by computing $R(z)\\,E(z)$ explicitly.\n- State your final answer as the explicit closed-form expression for $R(z)\\,E(z)$.\n\nYou may not invoke prepackaged filter bank synthesis formulas; your derivation must rely on the PR condition and basic properties of determinants and adjugates. The final answer must be a single closed-form analytic expression. No rounding is required. Angles, if any, must be in radians. No physical units are involved.", "solution": "The problem is first subjected to validation to ensure it is scientifically sound, well-posed, and objective.\n\nThe givens are as follows:\n- The analysis polyphase matrix is $E(z) = \\begin{pmatrix} 1 + z^{-1} & z^{-1} \\\\ 1 & 1 \\end{pmatrix}$.\n- The entries of $E(z)$ are polynomials in the delay variable $z^{-1}$ with complex coefficients.\n- The perfect reconstruction (PR) condition is $R(z)E(z) = z^{-d}I$, where $I$ is the identity matrix.\n- $R(z)$ is a synthesis polyphase matrix with polynomial entries in $z^{-1}$.\n- $d$ is a non-negative integer delay.\n\nThe problem asks for a derivation based on elementary linear-algebraic facts, specifically the determinant, adjugate, and invertibility over the ring of polynomials in $z^{-1}$. These concepts are standard and fundamental in the theory of multirate systems and filter banks. The problem is set in a well-defined mathematical framework, contains no factual or logical inconsistencies, is free from ambiguity, and possesses all necessary information for a unique solution. Therefore, the problem is deemed valid. We proceed with the solution.\n\nThe analysis proceeds in three steps as requested: establishing unimodularity and minimal delay, deriving the synthesis matrix, and verifying the result.\n\nFirst, we determine if the analysis polyphase matrix $E(z)$ is unimodular. A polynomial matrix is unimodular if its determinant is a non-zero constant. This property is critical because it implies that the matrix inverse is also a polynomial matrix. Let us compute the determinant of $E(z)$:\n$$\n\\det(E(z)) = (1 + z^{-1})(1) - (z^{-1})(1) = 1 + z^{-1} - z^{-1} = 1.\n$$\nSince $\\det(E(z)) = 1$, a non-zero constant, the matrix $E(z)$ is unimodular.\n\nThe perfect reconstruction (PR) condition is given by $R(z)E(z) = z^{-d}I$. Since $E(z)$ is unimodular, its inverse, $E^{-1}(z)$, exists and is a polynomial matrix. We can therefore express the synthesis polyphase matrix $R(z)$ as:\n$$\nR(z) = z^{-d}I E^{-1}(z) = z^{-d} E^{-1}(z).\n$$\nThe problem states that $R(z)$ must be a matrix with polynomial entries in $z^{-1}$. The inverse of a matrix $A$ is given by $A^{-1} = \\frac{1}{\\det(A)}\\text{adj}(A)$, where $\\text{adj}(A)$ is the adjugate matrix. For $E(z)$, we have:\n$$\nE^{-1}(z) = \\frac{1}{\\det(E(z))} \\text{adj}(E(z)) = \\frac{1}{1} \\text{adj}(E(z)) = \\text{adj}(E(z)).\n$$\nThe adjugate of a $2 \\times 2$ matrix $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ is $\\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$. Thus, for $E(z)$:\n$$\n\\text{adj}(E(z)) = \\begin{pmatrix}\n1 & -z^{-1} \\\\\n-1 & 1 + z^{-1}\n\\end{pmatrix}.\n$$\nThe entries of $\\text{adj}(E(z))$ are themselves polynomials in $z^{-1}$. The synthesis matrix is then:\n$$\nR(z) = z^{-d} \\text{adj}(E(z)) = z^{-d} \\begin{pmatrix}\n1 & -z^{-1} \\\\\n-1 & 1 + z^{-1}\n\\end{pmatrix} = \\begin{pmatrix}\nz^{-d} & -z^{-(d+1)} \\\\\n-z^{-d} & z^{-d} + z^{-(d+1)}\n\\end{pmatrix}.\n$$\nFor $R(z)$ to be a polynomial matrix in $z^{-1}$, all its entries must be polynomials in $z^{-1}$. This requires all exponents of $z$ to be non-positive. Given that $d$ must be a non-negative integer, this condition is always met. The problem seeks the minimal attainable delay $d$ and the corresponding $R(z)$ with minimal polynomial degrees. The degrees of the entries of $R(z)$ are minimized when $d$ is minimized. The minimal non-negative integer value for the delay is $d=0$.\n\nWith $d=0$, the PR condition becomes $R(z)E(z) = I$. The corresponding synthesis matrix is:\n$$\nR(z) = E^{-1}(z) = \\text{adj}(E(z)) = \\begin{pmatrix}\n1 & -z^{-1} \\\\\n-1 & 1 + z^{-1}\n\\end{pmatrix}.\n$$\nThis matrix satisfies the condition of having polynomial entries with minimal degrees.\n\nSecond, we must verify the perfect reconstruction property by explicitly computing the product $R(z)E(z)$.\n$$\nR(z)E(z) = \\begin{pmatrix}\n1 & -z^{-1} \\\\\n-1 & 1 + z^{-1}\n\\end{pmatrix}\n\\begin{pmatrix}\n1 + z^{-1} & z^{-1} \\\\\n1 & 1\n\\end{pmatrix}.\n$$\nWe compute each element of the product matrix:\n- The $(1,1)$ entry is $(1)(1 + z^{-1}) + (-z^{-1})(1) = 1 + z^{-1} - z^{-1} = 1$.\n- The $(1,2)$ entry is $(1)(z^{-1}) + (-z^{-1})(1) = z^{-1} - z^{-1} = 0$.\n- The $(2,1)$ entry is $(-1)(1 + z^{-1}) + (1 + z^{-1})(1) = -1 - z^{-1} + 1 + z^{-1} = 0$.\n- The $(2,2)$ entry is $(-1)(z^{-1}) + (1 + z^{-1})(1) = -z^{-1} + 1 + z^{-1} = 1$.\n\nThe resulting product is:\n$$\nR(z)E(z) = \\begin{pmatrix}\n1 & 0 \\\\\n0 & 1\n\\end{pmatrix} = I.\n$$\nThis result confirms that the PR condition $R(z)E(z) = z^{-d}I$ is satisfied with the minimal delay $d=0$.\n\nThe final answer is the explicit closed-form expression for the product $R(z)E(z)$. As derived and verified, this product is the $2 \\times 2$ identity matrix.", "answer": "$$\n\\boxed{\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}}\n$$", "id": "2890705"}, {"introduction": "Beyond analyzing existing filter banks, a crucial skill is designing new ones with specific desired properties. This practice introduces the elegant lattice structure, a factorization that guarantees the paraunitary property—and thus perfect reconstruction—by construction [@problem_id:2890750]. You will see how a simple design parameter, a rotation angle, can be precisely tuned to place a zero in the filter's frequency response, demonstrating a powerful method for synthesis.", "problem": "A real, two-channel, finite impulse response, perfect-reconstruction analysis filter bank is specified via its type-1 polyphase matrix factorization\n$$\n\\mathbf{E}(z) \\;=\\; \\mathbf{R}(\\theta_{1}) \\, \\mathbf{\\Lambda}(z) \\, \\mathbf{R}(\\theta_{0}),\n$$\nwhere\n$$\n\\mathbf{R}(\\theta) \\;=\\; \\begin{bmatrix} \\cos\\theta & \\sin\\theta \\\\ -\\sin\\theta & \\cos\\theta \\end{bmatrix}\n\\quad\\text{and}\\quad\n\\mathbf{\\Lambda}(z) \\;=\\; \\operatorname{diag}(1, z^{-1}).\n$$\nRecall that a two-by-two matrix of Laurent polynomials is paraunitary if it satisfies\n$$\n\\mathbf{E}(z)\\,\\mathbf{E}^{H}\\!\\left(z^{-1}\\right) \\;=\\; \\mathbf{I}\n$$\nfor all complex numbers $z$ on the unit circle. The analysis lowpass filter $H_{0}(z)$ associated with the first row $[\\;E_{00}(z)\\;\\;E_{01}(z)\\;]$ of $\\mathbf{E}(z)$ under the type-1 polyphase decomposition is defined by the well-tested relation\n$$\nH_{0}(z) \\;=\\; E_{00}\\!\\left(z^{2}\\right) \\;+\\; z^{-1}\\,E_{01}\\!\\left(z^{2}\\right).\n$$\n\nAssume $\\theta_{0} = \\pi/6$. You are tasked with choosing $\\theta_{1}$ so that the resulting analysis lowpass filter $H_{0}(z)$ has a zero on the unit circle at $z = -1$ (that is, at angular frequency $\\omega = \\pi$), while preserving paraunitarity through the given factorization. Using only the above definitions and standard trigonometric identities, derive the exact value of $\\theta_{1}$ that enforces $H_{0}\\!\\left(e^{j\\pi}\\right) = 0$.\n\nExpress your final answer as a single exact real number in radians. No rounding is required.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is a standard exercise in the design of perfect reconstruction quadrature mirror filter banks using the lattice structure factorization of the polyphase matrix. All definitions and conditions are consistent with established theory in digital signal processing. We shall proceed with the derivation.\n\nThe objective is to find the value of the angle $\\theta_{1}$ such that the analysis lowpass filter $H_{0}(z)$ has a zero at $z=-1$, i.e., $H_{0}(-1) = 0$. The filter $H_{0}(z)$ is constructed from the elements of the first row of the type-1 polyphase matrix $\\mathbf{E}(z)$.\n\nThe definition of $H_{0}(z)$ is given as:\n$$\nH_{0}(z) = E_{00}(z^{2}) + z^{-1}E_{01}(z^{2})\n$$\nWe must enforce the condition $H_{0}(-1) = 0$. Substituting $z=-1$ into this definition gives:\n$$\nH_{0}(-1) = E_{00}((-1)^{2}) + (-1)^{-1}E_{01}((-1)^{2}) = E_{00}(1) - E_{01}(1) = 0\n$$\nThis condition simplifies to $E_{00}(1) = E_{01}(1)$. We must now find the expressions for the polyphase components $E_{00}(z)$ and $E_{01}(z)$.\n\nThe polyphase matrix $\\mathbf{E}(z)$ is given by the factorization:\n$$\n\\mathbf{E}(z) = \\mathbf{R}(\\theta_{1}) \\mathbf{\\Lambda}(z) \\mathbf{R}(\\theta_{0})\n$$\nwhere\n$$\n\\mathbf{R}(\\theta) = \\begin{bmatrix} \\cos\\theta & \\sin\\theta \\\\ -\\sin\\theta & \\cos\\theta \\end{bmatrix} \\quad \\text{and} \\quad \\mathbf{\\Lambda}(z) = \\begin{bmatrix} 1 & 0 \\\\ 0 & z^{-1} \\end{bmatrix}\n$$\nLet us compute the product:\n$$\n\\mathbf{E}(z) = \\begin{bmatrix} \\cos\\theta_{1} & \\sin\\theta_{1} \\\\ -\\sin\\theta_{1} & \\cos\\theta_{1} \\end{bmatrix} \\left( \\begin{bmatrix} 1 & 0 \\\\ 0 & z^{-1} \\end{bmatrix} \\begin{bmatrix} \\cos\\theta_{0} & \\sin\\theta_{0} \\\\ -\\sin\\theta_{0} & \\cos\\theta_{0} \\end{bmatrix} \\right)\n$$\nFirst, we compute the product of the two rightmost matrices:\n$$\n\\mathbf{\\Lambda}(z) \\mathbf{R}(\\theta_{0}) = \\begin{bmatrix} 1 & 0 \\\\ 0 & z^{-1} \\end{bmatrix} \\begin{bmatrix} \\cos\\theta_{0} & \\sin\\theta_{0} \\\\ -\\sin\\theta_{0} & \\cos\\theta_{0} \\end{bmatrix} = \\begin{bmatrix} \\cos\\theta_{0} & \\sin\\theta_{0} \\\\ -z^{-1}\\sin\\theta_{0} & z^{-1}\\cos\\theta_{0} \\end{bmatrix}\n$$\nNow, we pre-multiply by $\\mathbf{R}(\\theta_{1})$:\n$$\n\\mathbf{E}(z) = \\begin{bmatrix} \\cos\\theta_{1} & \\sin\\theta_{1} \\\\ -\\sin\\theta_{1} & \\cos\\theta_{1} \\end{bmatrix} \\begin{bmatrix} \\cos\\theta_{0} & \\sin\\theta_{0} \\\\ -z^{-1}\\sin\\theta_{0} & z^{-1}\\cos\\theta_{0} \\end{bmatrix}\n$$\nThe resulting matrix is:\n$$\n\\mathbf{E}(z) = \\begin{bmatrix} \\cos\\theta_{1}\\cos\\theta_{0} - z^{-1}\\sin\\theta_{1}\\sin\\theta_{0} & \\cos\\theta_{1}\\sin\\theta_{0} + z^{-1}\\sin\\theta_{1}\\cos\\theta_{0} \\\\ -\\sin\\theta_{1}\\cos\\theta_{0} - z^{-1}\\cos\\theta_{1}\\sin\\theta_{0} & -\\sin\\theta_{1}\\sin\\theta_{0} + z^{-1}\\cos\\theta_{1}\\cos\\theta_{0} \\end{bmatrix}\n$$\nThe components $E_{00}(z)$ and $E_{01}(z)$ are the elements of the first row of $\\mathbf{E}(z)$:\n$$\nE_{00}(z) = \\cos\\theta_{1}\\cos\\theta_{0} - z^{-1}\\sin\\theta_{1}\\sin\\theta_{0}\n$$\n$$\nE_{01}(z) = \\cos\\theta_{1}\\sin\\theta_{0} + z^{-1}\\sin\\theta_{1}\\cos\\theta_{0}\n$$\nNow, we evaluate these components at $z=1$ to use the condition $E_{00}(1) = E_{01}(1)$:\n$$\nE_{00}(1) = \\cos\\theta_{1}\\cos\\theta_{0} - \\sin\\theta_{1}\\sin\\theta_{0}\n$$\n$$\nE_{01}(1) = \\cos\\theta_{1}\\sin\\theta_{0} + \\sin\\theta_{1}\\cos\\theta_{0}\n$$\nUsing standard trigonometric sum and difference identities, these simplify to:\n$$\nE_{00}(1) = \\cos(\\theta_{1} + \\theta_{0})\n$$\n$$\nE_{01}(1) = \\sin(\\theta_{1} + \\theta_{0})\n$$\nThe condition $E_{00}(1) = E_{01}(1)$ thus becomes:\n$$\n\\cos(\\theta_{1} + \\theta_{0}) = \\sin(\\theta_{1} + \\theta_{0})\n$$\nAssuming $\\cos(\\theta_{1} + \\theta_{0}) \\neq 0$, we can divide both sides by it to obtain:\n$$\n\\tan(\\theta_{1} + \\theta_{0}) = 1\n$$\nThe general solution for this equation is $\\theta_{1} + \\theta_{0} = \\frac{\\pi}{4} + n\\pi$ for any integer $n$.\nWe seek a particular value for $\\theta_{1}$. The principal value, corresponding to $n=0$, is typically chosen in this context.\n$$\n\\theta_{1} + \\theta_{0} = \\frac{\\pi}{4}\n$$\n$$\n\\theta_{1} = \\frac{\\pi}{4} - \\theta_{0}\n$$\nThe problem provides the value $\\theta_{0} = \\frac{\\pi}{6}$. Substituting this into our expression for $\\theta_{1}$:\n$$\n\\theta_{1} = \\frac{\\pi}{4} - \\frac{\\pi}{6} = \\frac{3\\pi}{12} - \\frac{2\\pi}{12} = \\frac{\\pi}{12}\n$$\nThis is the exact value of $\\theta_{1}$ that forces the analysis lowpass filter to have a zero at $z=-1$, as required. The paraunitarity of the system is structurally guaranteed by the given factorization and is not affected by the specific choice of angles.", "answer": "$$\n\\boxed{\\frac{\\pi}{12}}\n$$", "id": "2890750"}, {"introduction": "For real-world systems, computational efficiency and overall latency are critical design constraints. This exercise explores the 'lifting scheme,' a method for building complex PR filter banks from simple, invertible steps [@problem_id:2890769]. Your task is to invert a lifting-based factorization and trace how delays in the polyphase domain translate into the final, end-to-end delay of the complete system, a crucial skill for practical implementation.", "problem": "Consider a two-channel critically sampled analysis/synthesis filter bank described in the polyphase domain. The analysis polyphase matrix is factored into a product of lifting steps, a unimodular diagonal delay, a scaling, and a global scalar delay as follows:\n- The analysis polyphase matrix is\n$$\nE_{a}(z) \\;=\\; Q(z)\\, S_{2}(z)\\, D_{1}(z)\\, S_{1}(z)\\, K,\n$$\nwhere each factor is defined below.\n- The lifting steps are the upper- and lower-triangular unimodular matrices\n$$\nS_{1}(z) \\;=\\; \\begin{bmatrix} 1 & P(z) \\\\[4pt] 0 & 1 \\end{bmatrix},\n\\qquad\nS_{2}(z) \\;=\\; \\begin{bmatrix} 1 & 0 \\\\[4pt] U(z) & 1 \\end{bmatrix},\n$$\nwith\n$$\nP(z) \\;=\\; 1 \\;+\\; z^{-1} \\;+\\; z,\n\\qquad\nU(z) \\;=\\; -1 \\;+\\; 2\\,z^{-1}.\n$$\n- The unimodular diagonal delay is\n$$\nD_{1}(z) \\;=\\; \\operatorname{diag}\\!\\big(z^{-1},\\, z\\big),\n$$\nso that $\\det\\!\\big(D_{1}(z)\\big) \\,=\\, 1$.\n- The scaling is\n$$\nK \\;=\\; \\operatorname{diag}\\!\\big(\\alpha,\\, \\alpha^{-1}\\big),\n\\qquad \\text{with } \\alpha \\;=\\; 2,\n$$\nso that $\\det(K)\\,=\\,1$.\n- The global scalar delay is\n$$\nQ(z) \\;=\\; z^{-3}\\, I_{2},\n$$\nwhere $I_{2}$ is the $2\\times 2$ identity.\n\nThe subband signals produced by $E_{a}(z)$ are downsampled by a factor of two in each branch in the usual two-channel critically sampled structure. The synthesis polyphase matrix $E_{s}(z)$ should be chosen to realize perfect reconstruction in the sense that the end-to-end mapping from input to output is a pure delay when viewed in the original (non-decimated) time axis.\n\nTasks:\n1. Using only fundamental algebraic properties of matrix products and inverses, and the definitions of the given lifting steps, write an explicit expression for the synthesis polyphase matrix $E_{s}(z)$ as the reversed sequence of inverted steps corresponding to the unimodular part of $E_{a}(z)$, without cancelling the global scalar delay $Q(z)$.\n2. Using the polyphase representation identity for a scalar sequence $x(n)$ with $z$-transform $X(z)$,\n$$\nX(z) \\;=\\; X_{0}(z^{2}) \\;+\\; z^{-1}\\, X_{1}(z^{2}),\n$$\nand the corresponding identity for the reconstructed output $Y(z)$, derive the overall end-to-end scalar transfer from $X(z)$ to $Y(z)$ and determine the reconstruction delay measured in original time-domain samples.\n\nExpress your final answer as a single integer equal to the number of samples of reconstruction delay. No rounding is required. State your answer in units of samples (do not include the word “samples” in the final boxed answer).", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens\nThe given information is:\n- A two-channel critically sampled analysis/synthesis filter bank.\n- The analysis polyphase matrix is $E_{a}(z) \\;=\\; Q(z)\\, S_{2}(z)\\, D_{1}(z)\\, S_{1}(z)\\, K$.\n- Lifting step $S_{1}(z) \\;=\\; \\begin{bmatrix} 1 & P(z) \\\\ 0 & 1 \\end{bmatrix}$ with $P(z) \\;=\\; 1 \\;+\\; z^{-1} \\;+\\; z$.\n- Lifting step $S_{2}(z) \\;=\\; \\begin{bmatrix} 1 & 0 \\\\ U(z) & 1 \\end{bmatrix}$ with $U(z) \\;=\\; -1 \\;+\\; 2\\,z^{-1}$.\n- Diagonal delay $D_{1}(z) \\;=\\; \\operatorname{diag}\\!\\big(z^{-1},\\, z\\big)$.\n- Scaling matrix $K \\;=\\; \\operatorname{diag}\\!\\big(\\alpha,\\, \\alpha^{-1}\\big)$ with $\\alpha \\;=\\; 2$.\n- Global scalar delay $Q(z) \\;=\\; z^{-3}\\, I_{2}$, where $I_{2}$ is the $2\\times 2$ identity matrix.\n- The determinant of the unimodular factors are given as $\\det(S_1(z)) = 1$, $\\det(S_2(z)) = 1$, $\\det(D_1(z)) = 1$, and $\\det(K) = 1$.\n- The goal is perfect reconstruction, where the end-to-end mapping is a pure delay.\n- The polyphase representation identity for a signal $X(z)$ is $X(z) \\;=\\; X_{0}(z^{2}) \\;+\\; z^{-1}\\, X_{1}(z^{2})$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, rooted in the established theory of multirate signal processing and filter banks, specifically the lifting scheme or factoring of polyphase matrices. All terms are standard and well-defined. The problem is well-posed, providing all necessary mathematical constructs to derive the synthesis system and calculate the resultant system delay. The constraints are consistent; for instance, the unimodular property of the factors is correctly stated ($\\det(D_1(z))=z^{-1}z=1$, $\\det(K)=2 \\cdot 2^{-1}=1$). The language is objective and precise. The problem does not violate any of the invalidity criteria. It is a formalizable, complete, and solvable problem within its domain.\n\nStep 3: Verdict and Action\nThe problem is deemed valid. A solution will be provided.\n\nThe problem is solved in two parts as requested.\n\nPart 1: Derivation of the Synthesis Polyphase Matrix $E_{s}(z)$\n\nThe analysis polyphase matrix is given by $E_{a}(z) \\;=\\; Q(z)\\, S_{2}(z)\\, D_{1}(z)\\, S_{1}(z)\\, K$. The matrix $Q(z) = z^{-3} I_2$ represents a global delay and scaling of the polyphase vector, while the remaining product, let us call it $E'_{a}(z)$, represents the unimodular part of the transformation.\n$$\nE'_{a}(z) \\;=\\; S_{2}(z)\\, D_{1}(z)\\, S_{1}(z)\\, K\n$$\nThe problem specifies that the synthesis polyphase matrix $E_{s}(z)$ should be constructed as the reversed sequence of inverted steps corresponding to this unimodular part. This implies that $E_{s}(z)$ is the inverse of $E'_{a}(z)$.\n$$\nE_{s}(z) \\;=\\; (E'_{a}(z))^{-1} \\;=\\; (S_{2}(z)\\, D_{1}(z)\\, S_{1}(z)\\, K)^{-1}\n$$\nUsing the property that the inverse of a matrix product is the product of the inverses in reverse order, $(ABCD)^{-1} = D^{-1}C^{-1}B^{-1}A^{-1}$, we obtain:\n$$\nE_{s}(z) \\;=\\; K^{-1} S_{1}(z)^{-1} D_{1}(z)^{-1} S_{2}(z)^{-1}\n$$\nWe find the inverse of each component matrix:\n- The inverse of the scaling matrix $K = \\operatorname{diag}(\\alpha, \\alpha^{-1})$ is $K^{-1} = \\operatorname{diag}(\\alpha^{-1}, \\alpha)$. With $\\alpha = 2$, this is $K^{-1} = \\operatorname{diag}(1/2, 2)$.\n- The inverse of the upper-triangular lifting step $S_{1}(z) = \\begin{bmatrix} 1 & P(z) \\\\ 0 & 1 \\end{bmatrix}$ is $S_{1}(z)^{-1} = \\begin{bmatrix} 1 & -P(z) \\\\ 0 & 1 \\end{bmatrix}$.\n- The inverse of the diagonal delay matrix $D_{1}(z) = \\operatorname{diag}(z^{-1}, z)$ is $D_{1}(z)^{-1} = \\operatorname{diag}(z, z^{-1})$.\n- The inverse of the lower-triangular lifting step $S_{2}(z) = \\begin{bmatrix} 1 & 0 \\\\ U(z) & 1 \\end{bmatrix}$ is $S_{2}(z)^{-1} = \\begin{bmatrix} 1 & 0 \\\\ -U(z) & 1 \\end{bmatrix}$.\n\nThus, the explicit expression for the synthesis polyphase matrix is:\n$$\nE_{s}(z) \\;=\\; K^{-1} S_{1}(z)^{-1} D_{1}(z)^{-1} S_{2}(z)^{-1}\n$$\nThis completes the first task.\n\nPart 2: Derivation of the End-to-End Reconstruction Delay\n\nThe overall transfer function of the analysis-synthesis system is described by the product of the synthesis and analysis polyphase matrices, which we denote as $P(z)$.\n$$\nP(z) \\;=\\; E_{s}(z) E_{a}(z)\n$$\nSubstituting the expressions for $E_{s}(z)$ and $E_{a}(z)$:\n$$\nP(z) \\;=\\; ( (E'_{a}(z))^{-1} ) ( Q(z) E'_{a}(z) )\n$$\nThe matrix $Q(z) = z^{-3} I_2$ is a scalar matrix, meaning it is a scalar multiple of the identity matrix. Scalar matrices commute with any other matrix of the same dimension. Therefore, we can write:\n$$\nP(z) \\;=\\; Q(z) (E'_{a}(z))^{-1} E'_{a}(z)\n$$\nThe product of a matrix and its inverse is the identity matrix, $(E'_{a}(z))^{-1} E'_{a}(z) = I_2$.\n$$\nP(z) \\;=\\; Q(z) I_2 \\;=\\; Q(z) \\;=\\; z^{-3} I_2\n$$\nThe relationship between the polyphase components of the input signal, $X_0(z)$ and $X_1(z)$, and the polyphase components of the output signal, $Y_0(z)$ and $Y_1(z)$, is given by:\n$$\n\\begin{bmatrix} Y_0(z) \\\\ Y_1(z) \\end{bmatrix} \\;=\\; P(z) \\begin{bmatrix} X_0(z) \\\\ X_1(z) \\end{bmatrix} \\;=\\; z^{-3} I_2 \\begin{bmatrix} X_0(z) \\\\ X_1(z) \\end{bmatrix} \\;=\\; \\begin{bmatrix} z^{-3} X_0(z) \\\\ z^{-3} X_1(z) \\end{bmatrix}\n$$\nThis gives the relations:\n$$\nY_0(z) \\;=\\; z^{-3} X_0(z) \\qquad \\text{and} \\qquad Y_1(z) \\;=\\; z^{-3} X_1(z)\n$$\nThe reconstructed signal $y(n)$ has a $Z$-transform $Y(z)$ that is formed from its polyphase components according to the identity $Y(z) = Y_0(z^2) + z^{-1}Y_1(z^2)$. Similarly, the input $X(z)$ is related to its components by $X(z) = X_0(z^2) + z^{-1}X_1(z^2)$.\n\nTo find the overall transfer function from $X(z)$ to $Y(z)$, we must substitute the derived relations for the polyphase components. It is critical to replace the argument $z$ with $z^2$ as required by the synthesis identity.\n$$\nY_0(z^2) \\;=\\; (z^2)^{-3} X_0(z^2) \\;=\\; z^{-6} X_0(z^2)\n$$\n$$\nY_1(z^2) \\;=\\; (z^2)^{-3} X_1(z^2) \\;=\\; z^{-6} X_1(z^2)\n$$\nNow, substitute these into the expression for $Y(z)$:\n$$\nY(z) \\;=\\; (z^{-6} X_0(z^2)) \\;+\\; z^{-1} (z^{-6} X_1(z^2))\n$$\n$$\nY(z) \\;=\\; z^{-6} X_0(z^2) \\;+\\; z^{-7} X_1(z^2)\n$$\nFactor out the common term $z^{-6}$:\n$$\nY(z) \\;=\\; z^{-6} (X_0(z^2) \\;+\\; z^{-1} X_1(z^2))\n$$\nRecognizing that the term in the parentheses is the polyphase representation of the input signal $X(z)$, we have:\n$$\nY(z) \\;=\\; z^{-6} X(z)\n$$\nThis result shows that the output signal $Y(z)$ is a delayed version of the input signal $X(z)$. The overall system transfer function is $H_{eff}(z) = z^{-6}$. The reconstruction delay is the magnitude of the exponent, which corresponds to a delay of $6$ samples in the original time domain.", "answer": "$$\\boxed{6}$$", "id": "2890769"}]}