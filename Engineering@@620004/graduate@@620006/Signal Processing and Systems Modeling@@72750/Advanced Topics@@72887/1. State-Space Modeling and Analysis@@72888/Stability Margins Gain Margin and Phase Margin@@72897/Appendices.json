{"hands_on_practices": [{"introduction": "This first exercise builds a solid foundation by returning to first principles. You will derive the phase and gain margins for a classic second-order system directly from the definitions of its frequency response. This practice solidifies the core mathematical procedures and demonstrates how to manipulate a controller gain, $k$, to achieve a specific performance target for the phase margin, a fundamental skill in feedback system design [@problem_id:2906907].", "problem": "Consider a continuous-time, single-loop unity-feedback system whose open-loop transfer function is\n$$\nL(s) \\;=\\; \\frac{k}{\\,s\\bigl(1 + s/\\omega_{p}\\bigr)} \\,,\n$$\nwhere $k>0$ and $\\omega_{p}>0$. The loop has a single real pole at the origin and a single real pole at $s=-\\omega_{p}$. Use the foundational definitions that the gain crossover frequency is the frequency $\\omega_{gc}>0$ such that $\\lvert L(j\\omega_{gc})\\rvert = 1$, the phase margin (PM) is the additional phase lag (measured in degrees) required to reach $-180^\\circ$ at $\\omega_{gc}$, the phase crossover frequency is the frequency $\\omega_{pc}>0$ such that the open-loop phase equals $-180^\\circ$, and the gain margin (GM) is the reciprocal of the open-loop magnitude at $\\omega_{pc}$. Work from these definitions, along with fundamental properties of complex numbers and rational transfer functions, to:\n\n- Derive closed-form expressions for the magnitude $\\lvert L(j\\omega)\\rvert$ and phase $\\angle L(j\\omega)$ as functions of $\\omega$, $k$, and $\\omega_{p}$.\n- From the gain crossover condition, derive $\\omega_{gc}$ in terms of $k$ and $\\omega_{p}$, and then obtain the phase margin $\\mathrm{PM}(k,\\omega_{p})$ in degrees.\n- Determine the phase crossover behavior of this loop and deduce the gain margin $\\mathrm{GM}(k,\\omega_{p})$.\n- Finally, determine the largest admissible value of $k$ (expressed as a function of $\\omega_{p}$) such that the phase margin satisfies $\\mathrm{PM}\\geq 60^\\circ$.\n\nExpress any angle in degrees. Your final reported answer must be the single closed-form expression for the largest admissible $k$ that guarantees $\\mathrm{PM}\\geq 60^\\circ$. No rounding is required. Do not report intermediate results or inequalities as your final answer.", "solution": "The problem requires a systematic derivation of stability margins for a given second-order system and subsequent determination of a gain parameter constraint. We proceed by following the specified tasks.\n\nFirst, we must establish the frequency response of the open-loop transfer function $L(s)$. The given transfer function is\n$$\nL(s) = \\frac{k}{\\,s\\bigl(1 + s/\\omega_{p}\\bigr)}\n$$\nwhere the parameters $k$ and $\\omega_{p}$ are positive real numbers, $k>0$ and $\\omega_{p}>0$. The frequency response is obtained by making the substitution $s = j\\omega$, where $\\omega$ is the angular frequency.\n$$\nL(j\\omega) = \\frac{k}{j\\omega(1 + j\\omega/\\omega_{p})}\n$$\nThe magnitude of $L(j\\omega)$, denoted $|L(j\\omega)|$, is the ratio of the magnitudes of the numerator and denominator:\n$$\n|L(j\\omega)| = \\frac{|k|}{|j\\omega| \\cdot |1 + j\\omega/\\omega_{p}|}\n$$\nGiven $k > 0$, we have $|k|=k$. For $\\omega \\ge 0$, the magnitude $|j\\omega|$ is $\\omega$. The magnitude of the complex number $1 + j\\omega/\\omega_{p}$ is $\\sqrt{1^2 + (\\omega/\\omega_{p})^2}$. Therefore, the expression for the magnitude is:\n$$\n|L(j\\omega)| = \\frac{k}{\\omega \\sqrt{1 + \\frac{\\omega^2}{\\omega_{p}^2}}}\n$$\nThe phase of $L(j\\omega)$, denoted $\\angle L(j\\omega)$, is computed as the sum of the phases of the terms, where terms in the denominator contribute with a negative sign:\n$$\n\\angle L(j\\omega) = \\angle k - \\angle(j\\omega) - \\angle(1 + j\\omega/\\omega_{p})\n$$\nSince $k$ is a positive real number, its phase is $0^\\circ$. The phase of $j\\omega$ is precisely $90^\\circ$. The phase of $1 + j\\omega/\\omega_{p}$ is given by $\\arctan((\\omega/\\omega_{p})/1) = \\arctan(\\omega/\\omega_{p})$. Thus, the phase expression in degrees is:\n$$\n\\angle L(j\\omega) = 0^\\circ - 90^\\circ - \\arctan\\left(\\frac{\\omega}{\\omega_{p}}\\right) = -90^\\circ - \\arctan\\left(\\frac{\\omega}{\\omega_{p}}\\right)\n$$\nNext, we derive the gain crossover frequency, $\\omega_{gc}$, and the phase margin, $\\mathrm{PM}$. By definition, $\\omega_{gc}$ is the frequency at which $|L(j\\omega_{gc})| = 1$.\n$$\n1 = \\frac{k}{\\omega_{gc} \\sqrt{1 + \\frac{\\omega_{gc}^2}{\\omega_{p}^2}}}\n$$\nSquaring both sides and rearranging the terms leads to a polynomial equation for $\\omega_{gc}^2$:\n$$\n1 = \\frac{k^2}{\\omega_{gc}^2 (1 + \\frac{\\omega_{gc}^2}{\\omega_{p}^2})} \\implies \\omega_{gc}^2 \\left(1 + \\frac{\\omega_{gc}^2}{\\omega_{p}^2}\\right) = k^2\n$$\n$$\n\\frac{1}{\\omega_{p}^2}\\omega_{gc}^4 + \\omega_{gc}^2 - k^2 = 0\n$$\nThis is a quadratic equation in the variable $\\omega_{gc}^2$. We solve for $\\omega_{gc}^2$ using the quadratic formula, with coefficients $a=1/\\omega_{p}^2$, $b=1$, and $c=-k^2$:\n$$\n\\omega_{gc}^2 = \\frac{-1 \\pm \\sqrt{1^2 - 4(1/\\omega_{p}^2)(-k^2)}}{2(1/\\omega_{p}^2)} = \\frac{\\omega_{p}^2}{2} \\left(-1 \\pm \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}}\\right)\n$$\nSince $\\omega_{gc}^2$ must be a positive real number (as $\\omega_{gc} > 0$ by definition), we must select the solution with the plus sign:\n$$\n\\omega_{gc}^2 = \\frac{\\omega_{p}^2}{2} \\left(\\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\\right)\n$$\nThe phase margin, $\\mathrm{PM}$, is defined as $\\mathrm{PM} = 180^\\circ + \\angle L(j\\omega_{gc})$.\n$$\n\\mathrm{PM} = 180^\\circ + \\left(-90^\\circ - \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right)\\right) = 90^\\circ - \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right)\n$$\n\nNow, we analyze the phase crossover behavior and the gain margin, $\\mathrm{GM}$. The phase crossover frequency, $\\omega_{pc}$, is the frequency where $\\angle L(j\\omega_{pc}) = -180^\\circ$.\n$$\n-180^\\circ = -90^\\circ - \\arctan\\left(\\frac{\\omega_{pc}}{\\omega_{p}}\\right)\n$$\n$$\n-90^\\circ = - \\arctan\\left(\\frac{\\omega_{pc}}{\\omega_{p}}\\right) \\implies \\arctan\\left(\\frac{\\omega_{pc}}{\\omega_{p}}\\right) = 90^\\circ\n$$\nThe arctangent function approaches $90^\\circ$ only as its argument approaches infinity. This implies $\\omega_{pc}/\\omega_{p} \\to \\infty$, and thus $\\omega_{pc} \\to \\infty$. There is no finite positive frequency $\\omega_{pc}$ at which the phase reaches $-180^\\circ$. The gain margin is defined as $\\mathrm{GM} = 1/|L(j\\omega_{pc})|$. In this case, we must consider the limit as $\\omega \\to \\infty$:\n$$\n\\lim_{\\omega \\to \\infty} |L(j\\omega)| = \\lim_{\\omega \\to \\infty} \\frac{k}{\\omega \\sqrt{1 + \\omega^2/\\omega_{p}^2}} = \\lim_{\\omega \\to \\infty} \\frac{k}{\\omega (\\omega/\\omega_{p})} = \\lim_{\\omega \\to \\infty} \\frac{k \\omega_{p}}{\\omega^2} = 0\n$$\nThe magnitude at the frequency where the phase would be $-180^\\circ$ is zero. Therefore, the gain margin $\\mathrm{GM} = 1/0$ is infinite. This indicates that the closed-loop system is stable for all positive values of $k$.\n\nFinally, we determine the largest admissible value of $k$ such that the phase margin satisfies the condition $\\mathrm{PM} \\ge 60^\\circ$.\n$$\n90^\\circ - \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right) \\ge 60^\\circ\n$$\n$$\n30^\\circ \\ge \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right)\n$$\nSince $\\arctan(x)$ is a monotonically increasing function, we can apply the tangent function to both sides of the inequality. The value of $\\tan(30^\\circ)$ is $1/\\sqrt{3}$.\n$$\n\\frac{1}{\\sqrt{3}} \\ge \\frac{\\omega_{gc}}{\\omega_{p}}\n$$\nWe substitute the expression for $\\omega_{gc}/\\omega_p$:\n$$\n\\frac{1}{\\sqrt{3}} \\ge \\sqrt{\\frac{1}{2} \\left(\\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\\right)}\n$$\nSquaring both sides of the inequality:\n$$\n\\frac{1}{3} \\ge \\frac{1}{2} \\left(\\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\\right)\n$$\nWe now solve for $k$:\n$$\n\\frac{2}{3} \\ge \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\n$$\n$$\n\\frac{2}{3} + 1 \\ge \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} \\implies \\frac{5}{3} \\ge \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}}\n$$\nSquaring both sides again:\n$$\n\\left(\\frac{5}{3}\\right)^2 \\ge 1 + \\frac{4k^2}{\\omega_{p}^2} \\implies \\frac{25}{9} \\ge 1 + \\frac{4k^2}{\\omega_{p}^2}\n$$\n$$\n\\frac{25}{9} - 1 \\ge \\frac{4k^2}{\\omega_{p}^2} \\implies \\frac{16}{9} \\ge \\frac{4k^2}{\\omega_{p}^2}\n$$\n$$\n\\frac{16}{9}\\omega_{p}^2 \\ge 4k^2 \\implies \\frac{4}{9}\\omega_{p}^2 \\ge k^2\n$$\nSince $k > 0$ and $\\omega_{p} > 0$, taking the positive square root of both sides, we find the constraint on $k$:\n$$\n\\frac{2}{3}\\omega_{p} \\ge k\n$$\nThe problem requires the largest admissible value of $k$. This corresponds to the equality condition. Therefore, the largest value of $k$ is $\\frac{2}{3}\\omega_{p}$.", "answer": "$$\n\\boxed{\\frac{2}{3}\\omega_{p}}\n$$", "id": "2906907"}, {"introduction": "Stability margins derived from Bode plots are powerful shortcuts, but they rest on a critical assumption: the open-loop system must itself be stable. This practice explores a scenario where this assumption is violated, leading to an \"apparent\" positive phase margin that incorrectly suggests stability. By applying the full Nyquist stability criterion ($Z = N + P$), you will diagnose the system's true instability and understand why the simple Bode rules can be misleading, a crucial lesson for robustly analyzing any system [@problem_id:2906959].", "problem": "A continuous-time, single-input single-output, unity negative-feedback loop is formed around a strictly proper loop transfer function $L(s)$ with real coefficients. The loop transfer function is\n$$\nL(s) \\;=\\; K \\,\\frac{s+z}{(s-1)(s+1)(s+2)}\\,,\n$$\nwhere $K=\\dfrac{10\\sqrt{5}}{\\sqrt{29}}$ and $z=\\dfrac{2}{5}$. Note that $L(s)$ has one pole in the Right Half-Plane (RHP) at $s=1$.\n\nStarting only from core definitions (Bode magnitude and phase, and the Nyquist stability criterion derived from Cauchy’s argument principle), do the following:\n\n1) Define the gain crossover frequency $\\omega_{\\mathrm{gc}}$ as the positive real solution of $|L(j\\omega)|=1$. Compute $\\omega_{\\mathrm{gc}}$ and the corresponding loop phase $\\angle L(j\\omega_{\\mathrm{gc}})$. Then, using the standard definition of Phase Margin (PM) for Bode analysis, compute the “apparent” PM that one would report from the Bode plot if one were to (incorrectly) ignore the presence of RHP poles in $L(s)$. Express angles in degrees. You may leave intermediate symbolic expressions exact; if you present any decimal angles, round to four significant figures.\n\n2) Using the Nyquist stability criterion (based on Cauchy’s argument principle), determine the number $Z$ of zeros of $1+L(s)$ in the RHP, which equals the number of closed-loop poles in the RHP for the unity-feedback system. Justify your determination of the encirclement count by reasoning directly from the qualitative geometry of the Nyquist plot implied by your answer in part 1 and the low-frequency value $L(0)$.\n\n3) Provide a diagnostic explanation that reconciles a positive “apparent” PM from step 1 with an unstable closed loop from step 2, explicitly identifying which standard assumption behind interpreting gain margin (GM) and phase margin (PM) as stability guarantees has been violated and how to detect this situation a priori.\n\nReport as your final answer only the integer value of $Z$ (no units and no additional text). No rounding is needed for $Z$.", "solution": "The problem statement is first validated.\nGivens:\n- Loop transfer function: $L(s) = K \\frac{s+z}{(s-1)(s+1)(s+2)}$\n- Constants: $K = \\frac{10\\sqrt{5}}{\\sqrt{29}}$ and $z = \\frac{2}{5}$\n- System has a unity negative-feedback configuration.\n- $L(s)$ has an unstable pole at $s=1$.\n\nValidation:\nThe problem is scientifically grounded in classical control theory, specifically concerning frequency-domain stability analysis. It is well-posed, with all necessary information provided for a unique solution. The language is objective and precise. The setup, involving an open-loop unstable system, is a standard and important case study for understanding the full scope of the Nyquist stability criterion, and it is not trivial or ill-posed. The problem is deemed valid.\n\nPart 1: Computation of \"Apparent\" Phase Margin\n\nThe frequency response of the loop transfer function is $L(j\\omega)$. The magnitude squared of $L(j\\omega)$ is given by:\n$$\n|L(j\\omega)|^2 = \\left| K \\frac{j\\omega+z}{(j\\omega-1)(j\\omega+1)(j\\omega+2)} \\right|^2 = K^2 \\frac{|j\\omega+z|^2}{|(j\\omega)^2-1|^2 |j\\omega+2|^2} = K^2 \\frac{\\omega^2+z^2}{(\\omega^2+1)^2 (\\omega^2+4)}\n$$\nThe gain crossover frequency, $\\omega_{\\mathrm{gc}}$, is the positive frequency where $|L(j\\omega_{\\mathrm{gc}})| = 1$, which is equivalent to $|L(j\\omega_{\\mathrm{gc}})|^2 = 1$.\nThe given constants are $K=\\frac{10\\sqrt{5}}{\\sqrt{29}}$ and $z=\\frac{2}{5}$.\nThus, $K^2 = \\frac{100 \\times 5}{29} = \\frac{500}{29}$ and $z^2 = \\frac{4}{25}$.\nWe need to solve for $\\omega_{\\mathrm{gc}}$ from the equation:\n$$\n1 = \\frac{500}{29} \\frac{\\omega_{\\mathrm{gc}}^2 + \\frac{4}{25}}{(\\omega_{\\mathrm{gc}}^2+1)^2 (\\omega_{\\mathrm{gc}}^2+4)}\n$$\nLet us test the solution $\\omega_{\\mathrm{gc}}=1$ rad/s, which means $\\omega_{\\mathrm{gc}}^2=1$.\n$$\n\\frac{500}{29} \\frac{1 + \\frac{4}{25}}{(1+1)^2 (1+4)} = \\frac{500}{29} \\frac{\\frac{29}{25}}{(2^2)(5)} = \\frac{500}{29} \\frac{29/25}{20} = \\frac{500}{29} \\frac{29}{500} = 1\n$$\nThe equation holds. Therefore, the gain crossover frequency is $\\omega_{\\mathrm{gc}} = 1$ rad/s.\n\nNext, we compute the phase of $L(j\\omega)$ at $\\omega = \\omega_{\\mathrm{gc}} = 1$. The phase is given by:\n$$\n\\angle L(j\\omega) = \\angle(j\\omega+z) - \\angle(j\\omega-1) - \\angle(j\\omega+1) - \\angle(j\\omega+2)\n$$\nExpressing the angles in degrees:\n$$\n\\angle(j\\omega+z) = \\arctan\\left(\\frac{\\omega}{z}\\right)\n$$\n$$\n\\angle(j\\omega-1) = \\angle(-1+j\\omega) = 180^\\circ - \\arctan(\\omega)\n$$\n$$\n\\angle(j\\omega+1) = \\arctan(\\omega)\n$$\n$$\n\\angle(j\\omega+2) = \\arctan\\left(\\frac{\\omega}{2}\\right)\n$$\nSo, the total phase is:\n$$\n\\angle L(j\\omega) = \\arctan\\left(\\frac{\\omega}{z}\\right) - \\left(180^\\circ - \\arctan(\\omega)\\right) - \\arctan(\\omega) - \\arctan\\left(\\frac{\\omega}{2}\\right) = \\arctan\\left(\\frac{\\omega}{z}\\right) - \\arctan\\left(\\frac{\\omega}{2}\\right) - 180^\\circ\n$$\nAt $\\omega = \\omega_{\\mathrm{gc}}=1$ and with $z=\\frac{2}{5}$:\n$$\n\\angle L(j1) = \\arctan\\left(\\frac{1}{2/5}\\right) - \\arctan\\left(\\frac{1}{2}\\right) - 180^\\circ = \\arctan(2.5) - \\arctan(0.5) - 180^\\circ\n$$\nUsing the identity $\\arctan(a) - \\arctan(b) = \\arctan\\left(\\frac{a-b}{1+ab}\\right)$, we get:\n$$\n\\arctan(2.5) - \\arctan(0.5) = \\arctan\\left(\\frac{2.5 - 0.5}{1 + 2.5 \\times 0.5}\\right) = \\arctan\\left(\\frac{2}{1 + 1.25}\\right) = \\arctan\\left(\\frac{2}{2.25}\\right) = \\arctan\\left(\\frac{8}{9}\\right)\n$$\nSo, the phase at the gain crossover frequency is:\n$$\n\\angle L(j\\omega_{\\mathrm{gc}}) = \\arctan\\left(\\frac{8}{9}\\right) - 180^\\circ \\approx 41.6339^\\circ - 180^\\circ = -138.3661^\\circ\n$$\nRounding to four significant figures, $\\angle L(j\\omega_{\\mathrm{gc}}) \\approx -138.4^\\circ$.\n\nThe standard definition of Phase Margin (PM) is $PM = 180^\\circ + \\angle L(j\\omega_{\\mathrm{gc}})$. The \"apparent\" PM, ignoring the RHP pole, is:\n$$\nPM_{\\mathrm{apparent}} = 180^\\circ + \\left(\\arctan\\left(\\frac{8}{9}\\right) - 180^\\circ\\right) = \\arctan\\left(\\frac{8}{9}\\right) \\approx 41.63^\\circ\n$$\nThis is a positive phase margin.\n\nPart 2: Nyquist Stability Analysis\n\nThe Nyquist stability criterion states that $Z = N + P$, where:\n- $Z$ is the number of zeros of $1+L(s)$ in the RHP, which corresponds to the number of unstable closed-loop poles.\n- $P$ is the number of poles of the open-loop transfer function $L(s)$ in the RHP.\n- $N$ is the number of clockwise encirclements of the critical point $-1+j0$ by the Nyquist plot of $L(s)$.\n\nFrom the definition of $L(s) = K \\frac{s+z}{(s-1)(s+1)(s+2)}$, we can identify the poles at $s=1$, $s=-1$, and $s=-2$. The pole at $s=1$ is in the RHP. Thus, $P=1$.\n\nTo determine $N$, we analyze the Nyquist plot, which is the image of the standard Nyquist D-contour. We need to ascertain if the plot encircles the point $-1$.\n1.  For $\\omega \\to 0^+$, $L(j\\omega) \\to L(0) = K \\frac{z}{(-1)(1)(2)} = -\\frac{Kz}{2}$.\n    $L(0) = -\\frac{1}{2} \\left(\\frac{10\\sqrt{5}}{\\sqrt{29}}\\right) \\left(\\frac{2}{5}\\right) = -\\frac{2\\sqrt{5}}{\\sqrt{29}} \\approx -0.8318$.\n    The plot starts on the negative real axis at approximately $-0.8318$, which is to the right of $-1$.\n2.  The phase of $L(j\\omega)$ is $\\angle L(j\\omega) = \\arctan(2.5\\omega) - \\arctan(0.5\\omega) - 180^\\circ$. For $\\omega \\in (0, \\infty)$, both $\\arctan(2.5\\omega)$ and $\\arctan(0.5\\omega)$ are in $(0, 90^\\circ)$, and $\\arctan(2.5\\omega) > \\arctan(0.5\\omega)$. Thus, $\\arctan(2.5\\omega) - \\arctan(0.5\\omega)$ is in $(0, 90^\\circ)$. This implies $\\angle L(j\\omega)$ is always in $(-180^\\circ, -90^\\circ)$. The plot for $\\omega > 0$ remains entirely in the third quadrant. It never crosses the negative real axis.\n3.  As $\\omega \\to \\infty$, $L(j\\omega) \\to 0$ since the system is strictly proper. The phase approaches $\\lim_{\\omega\\to\\infty} (\\arctan(2.5\\omega) - \\arctan(0.5\\omega) - 180^\\circ) = 90^\\circ - 90^\\circ - 180^\\circ = -180^\\circ$. The plot approaches the origin along the negative real axis.\n4.  The large semicircle closure of the D-contour in the s-plane maps to a path at the origin in the L(s)-plane since $L(s)$ is strictly proper.\n\nThe Nyquist plot for $\\omega \\in (-\\infty, \\infty)$ starts at the origin for $\\omega \\to -\\infty$, moves to $L(0) \\approx -0.8318$, makes a loop in the second and third quadrants that passes through the point $L(j1)$ on the unit circle but never crosses the real axis to the left of $-1$, and returns to the origin for $\\omega \\to \\infty$. The critical point $-1+j0$ is never enclosed by the plot.\nTherefore, the number of encirclements is $N=0$.\n\nUsing the Nyquist criterion, the number of unstable closed-loop poles is:\n$$\nZ = N + P = 0 + 1 = 1\n$$\nThe closed-loop system has one pole in the RHP and is therefore unstable.\n\nPart 3: Reconciliation and Diagnostic Explanation\n\nThe analysis reveals an \"apparent\" contradiction: a positive phase margin ($PM \\approx 41.63^\\circ$), which is often associated with stability, yet the system is unstable ($Z=1$). This discrepancy is resolved by understanding the limitations of the Bode plot stability margins.\n\nThe standard interpretation that a positive phase margin and a gain margin greater than $1$ guarantee closed-loop stability is valid **only if the open-loop system $L(s)$ is stable**, meaning P = 0.\n\nIn this problem, this fundamental assumption is violated. The open-loop transfer function $L(s)$ has a pole at $s=1$, so it is unstable, and $P=1$. For an open-loop unstable system, the Nyquist criterion $Z=N+P$ must be used directly. For stability, we require $Z=0$. With $P=1$, this would necessitate $N = Z-P = 0-1 = -1$, meaning the Nyquist plot must encircle the critical point $-1$ one time in the counter-clockwise direction.\n\nA positive phase margin merely indicates that at the gain crossover frequency, the phase is less negative than $-180^\\circ$. It provides no information about the encirclement count $N$ without the additional context of the open-loop pole locations. In this case, the positive PM occurs in a system where the Nyquist plot does not encircle $-1$ at all ($N=0$), failing to provide the required stabilizing counter-clockwise encirclement.\n\nThe a priori detection of this situation is straightforward: one must always first determine the poles of the open-loop transfer function $L(s)$. The presence of any pole with a positive real part (in this case, $s=1$) immediately invalidates the simple stability rules of thumb associated with Bode plots and mandates the use of the full Nyquist stability criterion (or an equivalent method like root locus).", "answer": "$$\n\\boxed{1}\n$$", "id": "2906959"}, {"introduction": "This final practice shifts from pure analysis to comparative control design, focusing on a plant with a nonminimum-phase zero—a common feature in real-world systems that inherently limits achievable performance. You will implement and evaluate Proportional ($P$), Proportional-Integral ($PI$), and Lead controllers, analyzing how each strategy shapes the loop and alters the stability margins. This exercise illuminates the essential trade-offs in control engineering, particularly the unique challenges posed by right-half-plane zeros when trying to balance stability and performance [@problem_id:2906949].", "problem": "Consider the open-loop, single-input single-output plant with a nonminimum-phase zero given by the transfer function\n$$\nG(s)=\\frac{1-\\frac{s}{z}}{(s+1)(s+2)}, \\quad z=0.5.\n$$\nYou will study the loop stability margins for three compensators: a Proportional (P), a Proportional-Integral (PI), and a phase-lead controller. Let the compensators be defined as\n$$\nC_{P}(s)=K_{P}, \\quad C_{PI}(s)=K_{PI}\\left(1+\\frac{1}{T_{i}s}\\right), \\quad C_{L}(s)=K_{L}\\,\\frac{1+sT}{1+s\\alpha T},\n$$\nwith fixed parameters\n$$\nT_{i}=1, \\quad T=1, \\quad \\alpha=0.2.\n$$\nFor each compensator, choose the scalar gain so that the loop transfer function $L(s)=C(s)G(s)$ satisfies the unity-gain crossover condition\n$$\n|L(j\\omega_{c})|=1 \\quad \\text{at} \\quad \\omega_{c}=1 \\ \\text{rad/s}.\n$$\nThen, using only the definitions of gain margin and phase margin in the frequency domain and first principles of Bode frequency-response composition (sum of phase contributions from poles and zeros), perform the following:\n1) Derive expressions for the loop magnitude and phase at a general frequency $\\omega$ in terms of elementary functions for each compensator.\n2) Determine the required gains $K_{P}$, $K_{PI}$, and $K_{L}$ to enforce $|L(j1)|=1$.\n3) Compute the phase margin for each loop as the difference between $180$ degrees and the loop phase at $\\omega=1$ rad/s.\n4) Compute the gain margin for each loop by finding a frequency $\\omega_{180}$ at which the loop phase is $-180$ degrees and evaluating the reciprocal of the loop magnitude at that frequency (expressed as a dimensionless multiplicative factor).\n\nFinally, interpret the differences you obtain in the phase margin and gain margin across the three controllers by explicitly attributing them to the Bode phase contributions of the nonminimum-phase zero and of each compensator’s pole-zero pattern.\n\nAnswer specification: As your final reported quantity, provide the largest phase margin among the three compensators. Express angles in degrees. Round your final answer to four significant figures.", "solution": "We begin from the frequency-response definitions. For a loop transfer function $L(s)=C(s)G(s)$, the phase margin (PM) is defined as\n$$\n\\mathrm{PM}=180^{\\circ}+\\arg L(j\\omega_{gc}),\n$$\nwhere $\\omega_{gc}$ is a gain-crossover frequency such that $|L(j\\omega_{gc})|=1$. The gain margin (GM) is defined at a phase-crossover frequency $\\omega_{pc}$ satisfying $\\arg L(j\\omega_{pc})=-180^{\\circ}$ as\n$$\n\\mathrm{GM}=\\frac{1}{|L(j\\omega_{pc})|}.\n$$\nAll angles will be expressed in degrees. We construct $L(j\\omega)$ by composing the frequency responses of the plant and the compensator.\n\nPlant frequency response. With $z=0.5$, the plant is\n$$\nG(j\\omega)=\\frac{1-j\\frac{\\omega}{z}}{(j\\omega+1)(j\\omega+2)}=\\frac{1-j(2\\omega)}{(1+j\\omega)(2+j\\omega)}.\n$$\nIts magnitude and phase decompose into the factors of zeros and poles:\n$$\n|G(j\\omega)|=\\frac{\\sqrt{1+(2\\omega)^{2}}}{\\sqrt{1+\\omega^{2}}\\;\\sqrt{4+\\omega^{2}}}, \\quad\n\\arg G(j\\omega)=-\\arctan(2\\omega)-\\arctan(\\omega)-\\arctan\\!\\left(\\frac{\\omega}{2}\\right).\n$$\nThe negative contribution $-\\arctan(2\\omega)$ arises from the right-half-plane zero at $s=+z$ via the factor $1-j\\omega/z$.\n\nCompensators. We write each compensator’s magnitude and phase:\n1) Proportional: $C_{P}(j\\omega)=K_{P}$, so\n$$\n|C_{P}(j\\omega)|=K_{P}, \\quad \\arg C_{P}(j\\omega)=0^{\\circ}.\n$$\n2) Proportional-Integral with $T_{i}=1$:\n$$\nC_{PI}(s)=K_{PI}\\left(1+\\frac{1}{s}\\right)=K_{PI}\\frac{s+1}{s}, \\quad C_{PI}(j\\omega)=K_{PI}\\frac{1+j\\omega}{j\\omega}.\n$$\nThus\n$$\n|C_{PI}(j\\omega)|=K_{PI}\\frac{\\sqrt{1+\\omega^{2}}}{\\omega}, \\quad \\arg C_{PI}(j\\omega)=\\arctan(\\omega)-90^{\\circ}.\n$$\n3) Lead with $T=1$, $\\alpha=0.2$:\n$$\nC_{L}(s)=K_{L}\\frac{1+s}{1+0.2s}, \\quad C_{L}(j\\omega)=K_{L}\\frac{1+j\\omega}{1+j0.2\\omega}.\n$$\nHence\n$$\n|C_{L}(j\\omega)|=K_{L}\\frac{\\sqrt{1+\\omega^{2}}}{\\sqrt{1+(0.2\\omega)^{2}}}, \\quad \\arg C_{L}(j\\omega)=\\arctan(\\omega)-\\arctan(0.2\\omega).\n$$\n\nUnity-gain crossover at $\\omega_{c}=1$ rad/s. We enforce $|L(j1)|=1$ by solving for each gain.\n\nPlant at $\\omega=1$. Compute\n$$\nG(j1)=\\frac{1-2j}{(1+j)(2+j)}=\\frac{1-2j}{1+3j}.\n$$\nThus\n$$\n|G(j1)|=\\frac{\\sqrt{1+4}}{\\sqrt{1+9}}=\\frac{\\sqrt{5}}{\\sqrt{10}}=\\frac{1}{\\sqrt{2}}, \\quad \\arg G(j1)=-\\arctan(2)-\\arctan(1)-\\arctan\\!\\left(\\tfrac{1}{2}\\right)=-135^{\\circ}.\n$$\n\n1) Proportional. The unity crossover condition is\n$$\n|L_{P}(j1)|=K_{P}|G(j1)|=1 \\;\\Rightarrow\\; K_{P}=\\frac{1}{|G(j1)|}=\\sqrt{2}.\n$$\nPhase at $\\omega=1$ is $\\arg L_{P}(j1)=-135^{\\circ}$, so the phase margin is\n$$\n\\mathrm{PM}_{P}=180^{\\circ}-135^{\\circ}=45^{\\circ}.\n$$\nFor the gain margin, we solve for $\\omega_{pc}$ satisfying $\\arg L_{P}(j\\omega_{pc})=-180^{\\circ}$, i.e.,\n$$\n\\arctan(2\\omega_{pc})+\\arctan(\\omega_{pc})+\\arctan\\!\\left(\\frac{\\omega_{pc}}{2}\\right)=180^{\\circ}.\n$$\nNumerically, $\\omega_{pc}\\approx 1.868$. The loop magnitude at that frequency is\n$$\n|L_{P}(j\\omega_{pc})|=K_{P}|G(j\\omega_{pc})|=\\sqrt{2}\\,\\frac{\\sqrt{1+(2\\omega_{pc})^{2}}}{\\sqrt{1+\\omega_{pc}^{2}}\\sqrt{4+\\omega_{pc}^{2}}}.\n$$\nUsing $\\omega_{pc}\\approx 1.868$ yields $|G(j\\omega_{pc})|\\approx 0.667$, hence $|L_{P}(j\\omega_{pc})|\\approx 1.414\\times 0.667\\approx 0.943$. Therefore,\n$$\n\\mathrm{GM}_{P}=\\frac{1}{|L_{P}(j\\omega_{pc})|}\\approx 1.06.\n$$\n\n2) Proportional-Integral. At $\\omega=1$,\n$$\n|C_{PI}(j1)|=K_{PI}\\frac{\\sqrt{1+1^{2}}}{1}=K_{PI}\\sqrt{2}, \\quad |L_{PI}(j1)|=K_{PI}\\sqrt{2}\\,|G(j1)|=K_{PI}\\sqrt{2}\\cdot\\frac{1}{\\sqrt{2}}=K_{PI}.\n$$\nHence $K_{PI}=1$. The loop phase at $\\omega=1$ is\n$$\n\\arg L_{PI}(j1)=\\arg G(j1)+\\arg C_{PI}(j1)=-135^{\\circ}+(\\arctan(1)-90^{\\circ})=-135^{\\circ}+(45^{\\circ}-90^{\\circ})=-180^{\\circ}.\n$$\nTherefore,\n$$\n\\mathrm{PM}_{PI}=180^{\\circ}-180^{\\circ}=0^{\\circ}.\n$$\nFor the gain margin, the phase crossover occurs at $\\omega_{pc}=1$ rad/s, and $|L_{PI}(j1)|=1$, so\n$$\n\\mathrm{GM}_{PI}=\\frac{1}{|L_{PI}(j\\omega_{pc})|}=\\frac{1}{1}=1.\n$$\n\n3) Lead. At $\\omega=1$,\n$$\n|C_{L}(j1)|=K_{L}\\frac{\\sqrt{1+1^{2}}}{\\sqrt{1+(0.2\\cdot 1)^{2}}}=K_{L}\\frac{\\sqrt{2}}{\\sqrt{1.04}}.\n$$\nThe unity crossover condition $|L_{L}(j1)|=1$ becomes\n$$\nK_{L}\\frac{\\sqrt{2}}{\\sqrt{1.04}}\\cdot\\frac{1}{\\sqrt{2}}=1 \\;\\Rightarrow\\; K_{L}=\\sqrt{1.04}.\n$$\nThe loop phase at $\\omega=1$ is\n$$\n\\arg L_{L}(j1)=\\arg G(j1)+\\arg C_{L}(j1)=-135^{\\circ}+\\bigl(\\arctan(1)-\\arctan(0.2)\\bigr)\n=-135^{\\circ}+\\bigl(45^{\\circ}-11.3099^{\\circ}\\bigr)=-101.3099^{\\circ}.\n$$\nTherefore,\n$$\n\\mathrm{PM}_{L}=180^{\\circ}-101.3099^{\\circ}=78.6901^{\\circ}.\n$$\nFor the gain margin, the phase-crossover condition is\n$$\n\\arctan(2\\omega_{pc})+\\arctan\\!\\left(\\frac{\\omega_{pc}}{2}\\right)+\\arctan(0.2\\omega_{pc})=180^{\\circ},\n$$\nwhich numerically gives $\\omega_{pc}\\approx 3.66$. The loop magnitude at this frequency is calculated as $|L_{L}(j\\omega_{pc})| = |C_L(j\\omega_{pc})||G(j\\omega_{pc})|$. With $K_L = \\sqrt{1.04}$ and $\\omega_{pc} \\approx 3.66$, we compute $|L_{L}(j\\omega_{pc})| \\approx 1.456$. So,\n$$\n\\mathrm{GM}_{L}=\\frac{1}{|L_{L}(j\\omega_{pc})|}\\approx 0.687.\n$$\n\nInterpretation via Bode phase composition. The right-half-plane zero at $s=+0.5$ contributes a negative phase term $-\\arctan(2\\omega)$ while simultaneously increasing the high-frequency magnitude as $\\omega$ rises, a hallmark of nonminimum-phase behavior. The Proportional-Integral compensator introduces a pole at the origin and a zero at $s=-1$, with net phase $\\arctan(\\omega)-90^{\\circ}$; at the chosen crossover $\\omega=1$, this adds $-45^{\\circ}$ phase lag, driving the total loop phase to $-180^{\\circ}$ and yielding zero phase margin and unity gain margin. The Proportional compensator leaves the phase unchanged at crossover, giving a moderate phase margin ($45^{\\circ}$ here) and a gain margin slightly greater than one ($\\mathrm{GM}_{P} \\approx 1.06$). The lead compensator adds positive phase $\\arctan(\\omega)-\\arctan(0.2\\omega)$, which largely offsets part of the plant’s lag near $\\omega=1$ and results in a large phase margin ($\\approx 78.69^{\\circ}$). However, the lead also amplifies the magnitude at higher frequencies, and with the plant’s nonminimum-phase zero, the magnitude at the phase-crossover frequency rises further above unity, reducing the gain margin to a value less than one ($\\mathrm{GM}_{L} \\approx 0.687$). This illustrates the trade-off imposed by the nonminimum-phase zero: at fixed crossover, increasing phase margin via lead compensation can diminish gain margin because of increased high-frequency loop magnitude.\n\nFinal reported quantity. Among the three compensators, the largest phase margin is that of the lead-compensated loop. Using the above calculation,\n$$\n\\mathrm{PM}_{\\max}=\\mathrm{PM}_{L}\\approx 78.6901^{\\circ}.\n$$\nRounded to four significant figures and expressed in degrees, this is $78.69$ degrees.", "answer": "$$\\boxed{78.69}$$", "id": "2906949"}]}