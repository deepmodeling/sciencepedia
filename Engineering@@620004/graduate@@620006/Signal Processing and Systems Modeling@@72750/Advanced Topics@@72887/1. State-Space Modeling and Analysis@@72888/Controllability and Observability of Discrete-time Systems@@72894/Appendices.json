{"hands_on_practices": [{"introduction": "The concepts of controllability and observability are often first introduced through rank tests on large matrices. While computationally effective, this approach can obscure the deeper structural meaning. This practice delves into the heart of controllability by examining a system in Jordan canonical form, which provides a clear view of which dynamic modes are influenced by the input and which are not. By analyzing how the input matrix $B$ couples to the Jordan chains of the state matrix $A$, you will build a foundational intuition for why some systems are only partially controllable, a concept formally captured by the Popov-Belevitch-Hautus (PBH) test [@problem_id:2861179].", "problem": "Consider the discrete-time linear time-invariant (LTI) system defined by $x_{k+1} = A x_{k} + B u_{k}$ with state $x_{k} \\in \\mathbb{R}^{5}$ and input $u_{k} \\in \\mathbb{R}^{2}$. The state-transition matrix $A$ is in Jordan canonical form with two blocks,\n$$\nA \\;=\\; \\begin{pmatrix}\n2 & 1 & 0 & 0 & 0 \\\\\n0 & 2 & 1 & 0 & 0 \\\\\n0 & 0 & 2 & 0 & 0 \\\\\n0 & 0 & 0 & \\tfrac{1}{3} & 1 \\\\\n0 & 0 & 0 & 0 & \\tfrac{1}{3}\n\\end{pmatrix}\n\\;=\\; \\operatorname{diag}\\!\\Big(J_{3}(2),\\, J_{2}\\!\\big(\\tfrac{1}{3}\\big)\\Big),\n$$\nand the input matrix $B \\in \\mathbb{R}^{5 \\times 2}$ is chosen to actuate a non-leading state in the size-$3$ Jordan chain and the leading state in the size-$2$ Jordan chain,\n$$\nB \\;=\\; \\begin{pmatrix}\n0 & 0 \\\\\n1 & 0 \\\\\n0 & 0 \\\\\n0 & 1 \\\\\n0 & 0\n\\end{pmatrix}.\n$$\nUsing only the foundational definitions of reachability and controllability for discrete-time systems, analyze how the placement of nonzero entries in $B$ relative to the Jordan chains of $A$ determines which generalized eigenvector chains are controllable or uncontrollable. Then, from first principles, compute the rank of the controllability matrix\n$$\n\\mathcal{C}(A,B) \\;=\\; \\big[\\, B \\;\\; A B \\;\\; A^{2} B \\;\\; A^{3} B \\;\\; A^{4} B \\,\\big].\n$$\nGive your final answer as a single integer. No rounding is required and no units are involved.", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens\n- System equation: $x_{k+1} = A x_{k} + B u_{k}$\n- State vector: $x_{k} \\in \\mathbb{R}^{5}$\n- Input vector: $u_{k} \\in \\mathbb{R}^{2}$\n- State-transition matrix:\n$$\nA \\;=\\; \\begin{pmatrix}\n2 & 1 & 0 & 0 & 0 \\\\\n0 & 2 & 1 & 0 & 0 \\\\\n0 & 0 & 2 & 0 & 0 \\\\\n0 & 0 & 0 & \\tfrac{1}{3} & 1 \\\\\n0 & 0 & 0 & 0 & \\tfrac{1}{3}\n\\end{pmatrix}\n\\;=\\; \\operatorname{diag}\\!\\Big(J_{3}(2),\\, J_{2}\\!\\big(\\tfrac{1}{3}\\big)\\Big)\n$$\n- Input matrix:\n$$\nB \\;=\\; \\begin{pmatrix}\n0 & 0 \\\\\n1 & 0 \\\\\n0 & 0 \\\\\n0 & 1 \\\\\n0 & 0\n\\end{pmatrix}\n$$\n- Task: Analyze controllability based on the structure of $A$ and $B$, and compute the rank of the controllability matrix $\\mathcal{C}(A,B) \\;=\\; \\big[\\, B \\;\\; A B \\;\\; A^{2} B \\;\\; A^{3} B \\;\\; A^{4} B \\,\\big]$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It presents a standard problem in linear systems theory concerning the controllability of a discrete-time system. All matrices and dimensions are explicitly defined, and the system parameters are consistent. The problem is self-contained and does not violate any mathematical or scientific principles. No flaws are identified.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\nThe state space $\\mathbb{R}^{5}$ can be decomposed into a direct sum of two subspaces, $V_1 = \\operatorname{span}\\{e_1, e_2, e_3\\}$ and $V_2 = \\operatorname{span}\\{e_4, e_5\\}$, which are invariant under the action of $A$. Here, $e_i$ is the $i$-th standard basis vector. The controllability of the overall system $(A, B)$ can be analyzed by examining the controllability of the subsystems associated with each Jordan block.\n\nLet the state vector be $x_k = [x_{1k}, x_{2k}, x_{3k}, x_{4k}, x_{5k}]^T$ and the input vector be $u_k = [u_{1k}, u_{2k}]^T$. The system dynamics can be written as a set of scalar difference equations.\n\nAnalysis of the first Jordan block ($J_3(2)$):\nThe dynamics for the first three state components, corresponding to the subspace $V_1$, are:\n$x_{1,k+1} = 2x_{1k} + x_{2k}$\n$x_{2,k+1} = 2x_{2k} + x_{3k} + u_{1k}$\n$x_{3,k+1} = 2x_{3k}$\n\nThe third equation, $x_{3,k+1} = 2x_{3k}$, shows that the state component $x_3$ is driven only by its own value and is completely unaffected by the input $u_{1k}$ (or $u_{2k}$). The solution to this equation is $x_{3,k} = 2^k x_{3,0}$. If the initial state has $x_{3,0} \\neq 0$, it is impossible to drive $x_3$ to $0$ using any control input sequence. This means the system is not controllable. Conversely, if starting from $x_0=0$, no state with a non-zero $x_3$ component can be reached. The state vector $e_3$ represents an uncontrollable mode.\nThe input $u_{1k}$ directly actuates $x_2$. Through the coupling term $x_{2k}$ in the equation for $x_{1,k+1}$, the state $x_1$ is indirectly controlled. Thus, the subspace spanned by $\\{e_1, e_2\\}$ is controllable. The dimension of the controllable subspace associated with this Jordan block is $2$.\nThis outcome is a direct consequence of the structure of the input matrix $B$. For a Jordan chain, controllability is achieved if and only if the input acts on the end of the chain (the generalized eigenvector of highest rank). Here, the chain associated with $\\lambda=2$ is $e_1 \\leftarrow e_2 \\leftarrow e_3$, where $e_1$ is the eigenvector. The input acts on $e_2$, not $e_3$, rendering the chain uncontrollable.\n\nAnalysis of the second Jordan block ($J_2(1/3)$):\nThe dynamics for the last two state components, corresponding to the subspace $V_2$, are:\n$x_{4,k+1} = \\frac{1}{3}x_{4k} + x_{5k} + u_{2k}$\n$x_{5,k+1} = \\frac{1}{3}x_{5k}$\n\nSimilarly, the equation $x_{5,k+1} = \\frac{1}{3}x_{5k}$ shows that the state component $x_5$ is independent of any control input. The solution is $x_{5,k} = (\\frac{1}{3})^k x_{5,0}$. This mode is uncontrollable. The input $u_{2k}$ actuates $x_4$. The subspace spanned by $\\{e_4\\}$ is controllable. The dimension of the controllable subspace associated with this block is $1$.\nThe Jordan chain for $\\lambda=1/3$ is $e_4 \\leftarrow e_5$, where $e_4$ is the eigenvector. The input acts on the eigenvector $e_4$, not the end of the chain $e_5$, leading to uncontrollability of the $e_5$ mode.\n\nThe total controllable subspace is the direct sum of the controllable subspaces from each block, which is $\\operatorname{span}\\{e_1, e_2, e_4\\}$. The dimension of this subspace is $2 + 1 = 3$. The rank of the controllability matrix $\\mathcal{C}(A,B)$ is equal to the dimension of the controllable subspace. Therefore, the rank must be $3$.\n\nWe now verify this conclusion by direct computation of the rank of the controllability matrix $\\mathcal{C} = [B \\ AB \\ A^2B \\ A^3B \\ A^4B]$. The state dimension is $n=5$. Let the two columns of $B$ be $b_1 = e_2$ and $b_2 = e_4$.\n\nFirst, we compute the matrices $A^k B$ for $k=0, \\dots, 4$.\n$B = \\begin{pmatrix} 0 & 0 \\\\ 1 & 0 \\\\ 0 & 0 \\\\ 0 & 1 \\\\ 0 & 0 \\end{pmatrix}$\n\n$AB = A[b_1 \\ b_2] = [Ae_2 \\ Ae_4]$. From the definition of $A$:\n$Ae_2 = 2e_2 + e_1$\n$Ae_4 = \\frac{1}{3}e_4$\nSo, $AB = \\begin{pmatrix} 1 & 0 \\\\ 2 & 0 \\\\ 0 & 0 \\\\ 0 & 1/3 \\\\ 0 & 0 \\end{pmatrix}$.\n\n$A^2B = A(AB) = [A(e_1+2e_2) \\ A(\\frac{1}{3}e_4)]$.\n$A(e_1+2e_2) = Ae_1 + 2Ae_2 = (2e_1) + 2(e_1+2e_2) = 4e_1+4e_2$.\n$A(\\frac{1}{3}e_4) = \\frac{1}{3}Ae_4 = \\frac{1}{3}(\\frac{1}{3}e_4) = \\frac{1}{9}e_4$.\nSo, $A^2B = \\begin{pmatrix} 4 & 0 \\\\ 4 & 0 \\\\ 0 & 0 \\\\ 0 & 1/9 \\\\ 0 & 0 \\end{pmatrix}$.\n\n$A^3B = A(A^2B) = [A(4e_1+4e_2) \\ A(\\frac{1}{9}e_4)]$.\n$A(4e_1+4e_2) = 4Ae_1+4Ae_2 = 4(2e_1)+4(e_1+2e_2) = 12e_1+8e_2$.\n$A(\\frac{1}{9}e_4) = \\frac{1}{9}Ae_4 = \\frac{1}{27}e_4$.\nSo, $A^3B = \\begin{pmatrix} 12 & 0 \\\\ 8 & 0 \\\\ 0 & 0 \\\\ 0 & 1/27 \\\\ 0 & 0 \\end{pmatrix}$.\n\n$A^4B = A(A^3B) = [A(12e_1+8e_2) \\ A(\\frac{1}{27}e_4)]$.\n$A(12e_1+8e_2) = 12Ae_1+8Ae_2 = 12(2e_1)+8(e_1+2e_2) = 32e_1+16e_2$.\n$A(\\frac{1}{27}e_4) = \\frac{1}{27}Ae_4 = \\frac{1}{81}e_4$.\nSo, $A^4B = \\begin{pmatrix} 32 & 0 \\\\ 16 & 0 \\\\ 0 & 0 \\\\ 0 & 1/81 \\\\ 0 & 0 \\end{pmatrix}$.\n\nThe controllability matrix $\\mathcal{C}$ is a $5 \\times 10$ matrix:\n$$\n\\mathcal{C} = \\left[ \\begin{array}{cc|cc|cc|cc|cc}\n0 & 0 & 1 & 0 & 4 & 0 & 12 & 0 & 32 & 0 \\\\\n1 & 0 & 2 & 0 & 4 & 0 & 8 & 0 & 16 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & \\frac{1}{3} & 0 & \\frac{1}{9} & 0 & \\frac{1}{27} & 0 & \\frac{1}{81} \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\n\\end{array} \\right]\n$$\nTo find the rank of $\\mathcal{C}$, we inspect its rows. The third and fifth rows consist entirely of zeros. This immediately limits the rank to at most $5-2=3$. Let us examine the first, second, and fourth rows for linear independence.\nLet the non-zero row vectors be $r_1$, $r_2$, and $r_4$.\n$r_1 = [0, 0, 1, 0, 4, 0, 12, 0, 32, 0]$\n$r_2 = [1, 0, 2, 0, 4, 0, 8, 0, 16, 0]$\n$r_4 = [0, 1, 0, \\frac{1}{3}, 0, \\frac{1}{9}, 0, \\frac{1}{27}, 0, \\frac{1}{81}]$\n\nConsider a linear combination $c_1 r_1 + c_2 r_2 + c_4 r_4 = 0$.\nThe non-zero entries of $r_1$ and $r_2$ are in odd-numbered columns, while the non-zero entries of $r_4$ are in even-numbered columns.\nLooking at the even-numbered columns of the linear combination, we have $c_4$ times the entries of $r_4$. Since $r_4$ is not the zero vector, this implies $c_4 = 0$.\nThe equation reduces to $c_1 r_1 + c_2 r_2 = 0$.\nLooking at the first column gives $c_2 \\cdot 1 = 0$, so $c_2 = 0$.\nThe equation becomes $c_1 r_1 = 0$. Since $r_1$ is not the zero vector, this implies $c_1 = 0$.\nThe only solution is $c_1=c_2=c_4=0$, which proves that the three non-zero rows are linearly independent.\nThus, the rank of the matrix $\\mathcal{C}$ is $3$. This confirms the result from our initial analysis based on the system's structure.", "answer": "$$\\boxed{3}$$", "id": "2861179"}, {"introduction": "Once a system is determined to be controllable, what can we do with this property? This exercise demonstrates one of the most powerful applications of control theory: pole placement via state feedback, which allows a designer to reshape a system's dynamic behavior. You will derive Ackermann's formula from first principles, a cornerstone result that provides a direct method for calculating the state-feedback gain $K$ needed to place the closed-loop eigenvalues at any desired location in the complex plane. This practice transforms the abstract condition of controllability into a concrete tool for controller synthesis [@problem_id:2861105].", "problem": "Consider a Single-Input Single-Output (SISO) discrete-time linear time-invariant state-space system\n$$\nx_{k+1} = A x_k + B u_k, \\quad x_k \\in \\mathbb{R}^n, \\; u_k \\in \\mathbb{R},\n$$\nwith state feedback of the form\n$$\nu_k = -K x_k, \\quad K \\in \\mathbb{R}^{1 \\times n}.\n$$\nYou are asked to construct a closed-form expression for the state-feedback gain that assigns a prescribed monic characteristic polynomial to the closed-loop transition matrix. Work from first principles, beginning only with the following foundational elements:\n- The definition of reachability/controllability and the controllability matrix\n$$\n\\mathcal{C} \\triangleq \\big[\\, B \\; A B \\; \\cdots \\; A^{n-1} B \\,\\big] \\in \\mathbb{R}^{n \\times n}.\n$$\n- The Cayleyâ€“Hamilton Theorem and the evaluation of scalar polynomials on matrices.\n- The existence of a controllable canonical (companion) form under similarity transformations for controllable SISO pairs.\n\nYour tasks are:\n1) Derive, from the above bases without invoking any pre-packaged pole-placement formulas, a general closed-form expression for the state-feedback row vector $K$ that ensures the characteristic polynomial of the closed-loop matrix $A - B K$ equals a prescribed monic polynomial\n$$\n\\rho_d(z) = z^n + \\alpha_{n-1} z^{n-1} + \\cdots + \\alpha_1 z + \\alpha_0,\n$$\nwith real coefficients $\\alpha_i$. Clearly enumerate and justify all assumptions under which your final expression is valid, and discuss any minimality or structure requirements on $(A,B)$, including how and why Single-Input Single-Output (SISO) and reachability hypotheses enter.\n\n2) Apply your derived expression to the concrete data\n$$\nA=\\begin{bmatrix}\n1 & 2 & 0\\\\\n0 & 1 & 1\\\\\n0 & 0 & 1\n\\end{bmatrix}, \n\\quad\nB=\\begin{bmatrix}\n0\\\\\n0\\\\\n1\n\\end{bmatrix},\n$$\nand the desired closed-loop polynomial specified by the real zeros\n$$\n\\lambda_1=\\tfrac{1}{5},\\quad \\lambda_2=\\tfrac{2}{5},\\quad \\lambda_3=\\tfrac{4}{5},\n$$\nso that\n$$\n\\rho_d(z)=(z-\\tfrac{1}{5})(z-\\tfrac{2}{5})(z-\\tfrac{4}{5}).\n$$\nCompute the exact feedback gain $K$ as rational numbers. Do not round; report $K$ as a $1 \\times 3$ row vector in simplest fractional form. No units are required.", "solution": "The problem statement is validated as complete, consistent, and scientifically sound. It constitutes a standard problem in the theory of state-space control for linear systems. We proceed with a derivation from first principles as specified.\n\nThe problem requires the derivation of a closed-form expression for the state-feedback gain vector $K \\in \\mathbb{R}^{1 \\times n}$ for a Single-Input Single-Output (SISO) discrete-time system\n$$x_{k+1} = A x_k + B u_k$$\nwith control law $u_k = -K x_k$. The gain $K$ must be such that the closed-loop matrix $A_{cl} = A - B K$ has a prescribed characteristic polynomial $\\rho_d(z) = z^n + \\sum_{i=0}^{n-1} \\alpha_i z^i$.\n\n**Part 1: General Derivation**\n\nThe derivation hinges on the concept of controllability and the existence of a canonical form under similarity transformations.\n\n**Assumption:** The pair $(A, B)$ is controllable. For a discrete-time system, this means the system is reachable, which is equivalent to the condition that the controllability matrix $\\mathcal{C} = \\begin{bmatrix} B & AB & \\cdots & A^{n-1}B \\end{bmatrix}$ has full rank, i.e., $\\det(\\mathcal{C}) \\neq 0$ since $\\mathcal{C}$ is a square matrix for a SISO system of dimension $n$. This assumption is fundamental; without it, arbitrary pole placement is not possible.\n\n**Step 1: The Controllable Canonical Form (CCF)**\nIf $(A, B)$ is controllable, there exists an invertible similarity transformation matrix $T$ such that $x = T \\bar{x}$ transforms the system into the controllable canonical form $(\\bar{A}, \\bar{B})$, where:\n$$ \\bar{A} = T^{-1}AT = \\begin{pmatrix} 0 & 1 & 0 & \\cdots & 0 \\\\ 0 & 0 & 1 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & 0 & \\cdots & 1 \\\\ -a_0 & -a_1 & -a_2 & \\cdots & -a_{n-1} \\end{pmatrix}, \\quad \\bar{B} = T^{-1}B = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ 1 \\end{pmatrix} $$\nThe coefficients $a_i$ in $\\bar{A}$ are the coefficients of the characteristic polynomial of $A$, $\\rho_A(z) = \\det(zI-A) = z^n + \\sum_{i=0}^{n-1} a_i z^i$, which is invariant under similarity transformations.\n\n**Step 2: State Feedback in CCF**\nThe state feedback law in the new coordinates becomes $u_k = -Kx_k = -K(T\\bar{x}_k) = -(KT)\\bar{x}_k = -\\bar{K}\\bar{x}_k$, where $\\bar{K} = KT = \\begin{bmatrix} \\bar{k}_0 & \\bar{k}_1 & \\cdots & \\bar{k}_{n-1} \\end{bmatrix}$. The closed-loop state matrix in the transformed coordinates is $\\bar{A}_{cl} = \\bar{A} - \\bar{B}\\bar{K}$.\n$$ \\bar{B}\\bar{K} = \\begin{pmatrix} 0 \\\\ \\vdots \\\\ 0 \\\\ 1 \\end{pmatrix} \\begin{bmatrix} \\bar{k}_0 & \\cdots & \\bar{k}_{n-1} \\end{bmatrix} = \\begin{pmatrix} 0 & 0 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & \\cdots & 0 \\\\ \\bar{k}_0 & \\bar{k}_1 & \\cdots & \\bar{k}_{n-1} \\end{pmatrix} $$\n$$ \\bar{A}_{cl} = \\bar{A} - \\bar{B}\\bar{K} = \\begin{pmatrix} 0 & 1 & 0 & \\cdots & 0 \\\\ 0 & 0 & 1 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & 0 & \\cdots & 1 \\\\ -a_0-\\bar{k}_0 & -a_1-\\bar{k}_1 & \\cdots & \\cdots & -a_{n-1}-\\bar{k}_{n-1} \\end{pmatrix} $$\nThe structure of this companion matrix dictates its characteristic polynomial: $\\det(zI - \\bar{A}_{cl}) = z^n + \\sum_{i=0}^{n-1} (a_i+\\bar{k}_i) z^i$. To match this with the desired polynomial $\\rho_d(z) = z^n + \\sum_{i=0}^{n-1} \\alpha_i z^i$, we equate coefficients:\n$$ a_i + \\bar{k}_i = \\alpha_i \\implies \\bar{k}_i = \\alpha_i - a_i, \\quad \\text{for } i=0, \\dots, n-1. $$\nSo, the required gain in the transformed coordinates is $\\bar{K} = \\begin{bmatrix} \\alpha_0-a_0 & \\alpha_1-a_1 & \\cdots & \\alpha_{n-1}-a_{n-1} \\end{bmatrix}$.\n\n**Step 3: Transformation to Original Coordinates**\nTo find the gain $K$ in the original coordinates, we must find the transformation matrix $T$. We have $K = \\bar{K}T^{-1}$. The transformation matrix $T^{-1}$ can be constructed using the controllability matrix. Let $k_c^T$ be the last row of $\\mathcal{C}^{-1}$, i.e., $k_c^T = e_n^T \\mathcal{C}^{-1}$, where $e_n^T = \\begin{bmatrix} 0 & \\cdots & 0 & 1 \\end{bmatrix}$. The transformation matrix $T^{-1}$ is given by:\n$$ T^{-1} = \\begin{pmatrix} k_c^T \\\\ k_c^T A \\\\ \\vdots \\\\ k_c^T A^{n-1} \\end{pmatrix} $$\nThis construction indeed transforms $(A,B)$ to $(\\bar{A},\\bar{B})$. The last row of $\\bar{A}$ is determined by $k_c^T A^n$. By the Cayley-Hamilton Theorem, $\\rho_A(A) = A^n + \\sum_{i=0}^{n-1} a_i A^i = 0$, so $A^n = -\\sum_{i=0}^{n-1} a_i A^i$. The last row of $\\bar{A}$ is $(k_c^T A^n)T = -\\sum_{i=0}^{n-1} a_i (k_c^T A^i)T$. Since the $(i+1)$-th row of $T^{-1}$ is $k_c^T A^i$, we have $(k_c^T A^i)T = e_{i+1}^T$. This leads to the last row of $\\bar{A}$ being $-\\sum_{i=0}^{n-1} a_i e_{i+1}^T = \\begin{bmatrix} -a_0 & -a_1 & \\cdots & -a_{n-1} \\end{bmatrix}$, which confirms the structure of $\\bar{A}$.\n\n**Step 4: Final Expression for K**\nWe can now write $K$ as\n$$ K = \\bar{K}T^{-1} = \\sum_{i=0}^{n-1} \\bar{k}_i (\\text{row } i+1 \\text{ of } T^{-1}) = \\sum_{i=0}^{n-1} (\\alpha_i - a_i) k_c^T A^i $$\n$$ K = k_c^T \\left( \\sum_{i=0}^{n-1} \\alpha_i A^i - \\sum_{i=0}^{n-1} a_i A^i \\right) $$\nThe desired characteristic polynomial evaluated at $A$ is $\\rho_d(A) = A^n + \\sum_{i=0}^{n-1} \\alpha_i A^i$, so $\\sum_{i=0}^{n-1} \\alpha_i A^i = \\rho_d(A) - A^n$. Similarly, by Cayley-Hamilton, $\\rho_A(A) = A^n + \\sum_{i=0}^{n-1} a_i A^i = 0$, so $\\sum_{i=0}^{n-1} a_i A^i = -A^n$.\nSubstituting these into the expression for $K$:\n$$ K = k_c^T \\left( (\\rho_d(A) - A^n) - (-A^n) \\right) = k_c^T \\rho_d(A) $$\nSubstituting $k_c^T = e_n^T \\mathcal{C}^{-1}$, we obtain the final expression:\n$$ K = e_n^T \\mathcal{C}^{-1} \\rho_d(A) $$\nThis is a general closed-form expression, often known as Ackermann's formula. Its validity rests on the single, crucial assumption that the system pair $(A, B)$ is controllable, which makes $\\mathcal{C}$ invertible.\n\n**Part 2: Application to Concrete Data**\n\nWe are given the system with $n=3$:\n$$ A=\\begin{bmatrix} 1 & 2 & 0\\\\ 0 & 1 & 1\\\\ 0 & 0 & 1 \\end{bmatrix}, \\quad B=\\begin{bmatrix} 0\\\\ 0\\\\ 1 \\end{bmatrix} $$\nThe desired closed-loop poles are $\\lambda_1=\\frac{1}{5}, \\lambda_2=\\frac{2}{5}, \\lambda_3=\\frac{4}{5}$. The desired characteristic polynomial is:\n$$ \\rho_d(z) = (z-\\tfrac{1}{5})(z-\\tfrac{2}{5})(z-\\tfrac{4}{5}) = (z^2 - \\tfrac{3}{5}z + \\tfrac{2}{25})(z-\\tfrac{4}{5}) = z^3 - \\tfrac{7}{5}z^2 + \\tfrac{14}{25}z - \\tfrac{8}{125} $$\nThe coefficients are $\\alpha_2 = -\\frac{7}{5}$, $\\alpha_1 = \\frac{14}{25}$, $\\alpha_0 = -\\frac{8}{125}$.\n\n**Step 1: Verify Controllability**\nWe compute the controllability matrix $\\mathcal{C} = \\begin{bmatrix} B & AB & A^2B \\end{bmatrix}$.\n$B = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$\n$AB = \\begin{bmatrix} 1 & 2 & 0\\\\ 0 & 1 & 1\\\\ 0 & 0 & 1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\\\ 1 \\end{bmatrix}$\n$A^2B = A(AB) = \\begin{bmatrix} 1 & 2 & 0\\\\ 0 & 1 & 1\\\\ 0 & 0 & 1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 2 \\\\ 2 \\\\ 1 \\end{bmatrix}$\n$$ \\mathcal{C} = \\begin{bmatrix} 0 & 0 & 2 \\\\ 0 & 1 & 2 \\\\ 1 & 1 & 1 \\end{bmatrix} $$\nThe determinant is $\\det(\\mathcal{C}) = 0 - 0 + 2(0-1) = -2$. Since $\\det(\\mathcal{C}) \\neq 0$, the system is controllable.\n\n**Step 2: Compute $e_3^T \\mathcal{C}^{-1}$**\nWe find the inverse of $\\mathcal{C}$:\n$$ \\mathcal{C}^{-1} = \\frac{1}{\\det(\\mathcal{C})} \\text{adj}(\\mathcal{C}) = -\\frac{1}{2} \\begin{bmatrix} 1-2 & -(0-2) & 0-1 \\\\ -(0-2) & 0-2 & -(0-0) \\\\ 0-2 & -(0-0) & 0-0 \\end{bmatrix}^T = -\\frac{1}{2} \\begin{bmatrix} -1 & 2 & -1 \\\\ 2 & -2 & 0 \\\\ -2 & 0 & 0 \\end{bmatrix}^T = -\\frac{1}{2} \\begin{bmatrix} -1 & 2 & -2 \\\\ 2 & -2 & 0 \\\\ -1 & 0 & 0 \\end{bmatrix} = \\begin{bmatrix} 1/2 & -1 & 1 \\\\ -1 & 1 & 0 \\\\ 1/2 & 0 & 0 \\end{bmatrix} $$\nThe vector $e_3^T \\mathcal{C}^{-1}$ is the last row of $\\mathcal{C}^{-1}$:\n$$ e_3^T \\mathcal{C}^{-1} = \\begin{bmatrix} 1/2 & 0 & 0 \\end{bmatrix} $$\n\n**Step 3: Compute $\\rho_d(A)$**\nWe must evaluate $\\rho_d(A) = A^3 - \\frac{7}{5}A^2 + \\frac{14}{25}A - \\frac{8}{125}I$.\nFirst, we compute the powers of $A$:\n$A = \\begin{bmatrix} 1 & 2 & 0 \\\\ 0 & 1 & 1 \\\\ 0 & 0 & 1 \\end{bmatrix}$\n$A^2 = A \\cdot A = \\begin{bmatrix} 1 & 4 & 2 \\\\ 0 & 1 & 2 \\\\ 0 & 0 & 1 \\end{bmatrix}$\n$A^3 = A^2 \\cdot A = \\begin{bmatrix} 1 & 6 & 6 \\\\ 0 & 1 & 3 \\\\ 0 & 0 & 1 \\end{bmatrix}$\nNow, substitute into the polynomial expression:\n$$ \\rho_d(A) = \\begin{bmatrix} 1 & 6 & 6 \\\\ 0 & 1 & 3 \\\\ 0 & 0 & 1 \\end{bmatrix} - \\frac{7}{5}\\begin{bmatrix} 1 & 4 & 2 \\\\ 0 & 1 & 2 \\\\ 0 & 0 & 1 \\end{bmatrix} + \\frac{14}{25}\\begin{bmatrix} 1 & 2 & 0 \\\\ 0 & 1 & 1 \\\\ 0 & 0 & 1 \\end{bmatrix} - \\frac{8}{125}\\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} $$\n\n**Step 4: Compute K**\nThe gain is $K = (e_3^T \\mathcal{C}^{-1}) \\rho_d(A) = \\begin{bmatrix} 1/2 & 0 & 0 \\end{bmatrix} \\rho_d(A)$. This product results in a row vector which is $1/2$ times the first row of $\\rho_d(A)$. Let $R_1(\\cdot)$ be the first row operator.\n$$ R_1(\\rho_d(A)) = \\begin{bmatrix} 1 & 6 & 6 \\end{bmatrix} - \\frac{7}{5}\\begin{bmatrix} 1 & 4 & 2 \\end{bmatrix} + \\frac{14}{25}\\begin{bmatrix} 1 & 2 & 0 \\end{bmatrix} - \\frac{8}{125}\\begin{bmatrix} 1 & 0 & 0 \\end{bmatrix} $$\nWe compute each component of this row vector:\nComponent $1$: $1 - \\frac{7}{5} + \\frac{14}{25} - \\frac{8}{125} = \\frac{125 - 175 + 70 - 8}{125} = \\frac{12}{125}$.\nComponent $2$: $6 - \\frac{7}{5}(4) + \\frac{14}{25}(2) = 6 - \\frac{28}{5} + \\frac{28}{25} = \\frac{150 - 140 + 28}{25} = \\frac{38}{25}$.\nComponent $3$: $6 - \\frac{7}{5}(2) + 0 = 6 - \\frac{14}{5} = \\frac{30 - 14}{5} = \\frac{16}{5}$.\nSo, $R_1(\\rho_d(A)) = \\begin{bmatrix} \\frac{12}{125} & \\frac{38}{25} & \\frac{16}{5} \\end{bmatrix}$.\nFinally, we find $K$:\n$$ K = \\frac{1}{2} R_1(\\rho_d(A)) = \\frac{1}{2} \\begin{bmatrix} \\frac{12}{125} & \\frac{38}{25} & \\frac{16}{5} \\end{bmatrix} = \\begin{bmatrix} \\frac{6}{125} & \\frac{19}{25} & \\frac{8}{5} \\end{bmatrix} $$\nThis is the exact state-feedback gain vector required, with components in simplest fractional form.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{6}{125} & \\frac{19}{25} & \\frac{8}{5} \\end{pmatrix}}$$", "id": "2861105"}, {"introduction": "The interplay between controllability and observability is critical for robust system design, and overlooking it can lead to catastrophic failures. This problem explores the classic pitfall of unstable pole-zero cancellation, where a system appears stable from an input-output perspective while harboring a dangerously unstable internal mode. By constructing the full state-space model of a seemingly simple closed-loop system, you will uncover this 'hidden' instability and diagnose its root cause: a loss of observability of an unstable mode. This cautionary example underscores why a state-space perspective is essential for guaranteeing internal stability, a lesson that transfer function analysis alone cannot teach [@problem_id:2861162].", "problem": "Consider a Single-Input Single-Output (SISO) discrete-time plant with transfer function $G_{p}(z) = \\dfrac{z - 1.2}{z - 0.3}$ and a SISO discrete-time controller with transfer function $G_{c}(z) = \\dfrac{z - 0.3}{z - 1.2}$. Each is implemented by a minimal state-space realization consistent with the definition $G(z) = C (z I - A)^{-1} B + D$ as follows:\n- Plant: $x_{p}[k+1] = A_{p} x_{p}[k] + B_{p} u[k]$, $y[k] = C_{p} x_{p}[k] + D_{p} u[k]$, where $A_{p} = [\\,0.3\\,]$, $B_{p} = [\\,-0.9\\,]$, $C_{p} = [\\,1\\,]$, $D_{p} = [\\,1\\,]$.\n- Controller: $x_{c}[k+1] = A_{c} x_{c}[k] + B_{c} e[k]$, $u[k] = C_{c} x_{c}[k] + D_{c} e[k]$, where $A_{c} = [\\,1.2\\,]$, $B_{c} = [\\,0.9\\,]$, $C_{c} = [\\,1\\,]$, $D_{c} = [\\,1\\,]$.\n\nThe interconnection is unity negative feedback with error $e[k] = r[k] - y[k]$. The external reference input is $r[k]$ and the measured output is $y[k]$.\n\nUsing only the foundational definitions of discrete-time transfer functions from state-space, controllability, observability, and internal stability (all modes of the internal state matrix strictly inside the unit disk), carry out the following steps:\n1. Verify that $G_{p}(z)$ has an unstable zero at $z = 1.2$ and that $G_{c}(z)$ places a pole at $z = 1.2$, leading to a pole-zero cancellation in the closed-loop input-output map.\n2. Derive the closed-loop state-space realization with state vector $x[k] = \\begin{pmatrix} x_{p}[k] \\\\ x_{c}[k] \\end{pmatrix}$, eliminating algebraic variables as needed, and write its state-update matrix $A_{\\mathrm{cl}}$ explicitly.\n3. From the derived $A_{\\mathrm{cl}}$, compute its eigenvalues and determine whether the closed-loop interconnection is internally stable.\n4. Explain, in terms of observability and controllability of the closed-loop realization, why the unstable mode can be hidden from the input-output transfer function despite internal instability.\n5. Provide, as your final answer, the value of the unstable internal eigenvalue of $A_{\\mathrm{cl}}$.\n\nGive the final answer as a single real number. No rounding is required. No units are required.", "solution": "The problem is first validated for correctness and solvability.\n\nGivens:\nPlant Transfer Function: $G_{p}(z) = \\dfrac{z - 1.2}{z - 0.3}$\nPlant State-Space Realization:\n$x_{p}[k+1] = A_{p} x_{p}[k] + B_{p} u[k]$, $y[k] = C_{p} x_{p}[k] + D_{p} u[k]$\n$A_{p} = [\\,0.3\\,]$, $B_{p} = [\\,-0.9\\,]$, $C_{p} = [\\,1\\,]$, $D_{p} = [\\,1\\,]$\n\nController Transfer Function: $G_{c}(z) = \\dfrac{z - 0.3}{z - 1.2}$\nController State-Space Realization:\n$x_{c}[k+1] = A_{c} x_{c}[k] + B_{c} e[k]$, $u[k] = C_{c} x_{c}[k] + D_{c} e[k]$\n$A_{c} = [\\,1.2\\,]$, $B_{c} = [\\,0.9\\,]$, $C_{c} = [\\,1\\,]$, $D_{c} = [\\,1\\,]$\n\nInterconnection: Unity negative feedback, $e[k] = r[k] - y[k]$.\nCombined State Vector: $x[k] = \\begin{pmatrix} x_{p}[k] \\\\ x_{c}[k] \\end{pmatrix}$\n\nValidation:\nThe problem is scientifically grounded in linear systems theory. Before proceeding, we verify that the provided state-space realizations correspond to the given transfer functions using the formula $G(z) = C (zI - A)^{-1} B + D$.\nFor the plant:\n$G_{p}(z) = [\\,1\\,](z - 0.3)^{-1}[\\,-0.9\\,] + 1 = \\dfrac{-0.9}{z - 0.3} + 1 = \\dfrac{-0.9 + z - 0.3}{z - 0.3} = \\dfrac{z - 1.2}{z - 0.3}$. This is consistent.\nFor the controller:\n$G_{c}(z) = [\\,1\\,](z - 1.2)^{-1}[\\,0.9\\,] + 1 = \\dfrac{0.9}{z - 1.2} + 1 = \\dfrac{0.9 + z - 1.2}{z - 1.2} = \\dfrac{z - 0.3}{z - 1.2}$. This is also consistent.\nThe problem is self-contained, objective, and well-posed. No flaws are identified. The problem is valid.\n\nStep 1: Pole-Zero Cancellation\nThe plant transfer function $G_{p}(z)$ has a numerator $z - 1.2$, so it has a zero at $z = 1.2$. Since $|1.2| > 1$, this is an unstable zero.\nThe controller transfer function $G_{c}(z)$ has a denominator $z - 1.2$, so it has a pole at $z = 1.2$.\nThe open-loop transfer function is $L(z) = G_{p}(z) G_{c}(z)$.\n$$L(z) = \\left( \\dfrac{z - 1.2}{z - 0.3} \\right) \\left( \\dfrac{z - 0.3}{z - 1.2} \\right) = 1$$\nThe closed-loop transfer function from reference $r[k]$ to output $y[k]$ is $T(z) = \\dfrac{L(z)}{1 + L(z)}$.\n$$T(z) = \\dfrac{1}{1 + 1} = \\dfrac{1}{2}$$\nThe calculation shows a complete pole-zero cancellation. The unstable zero from the plant is cancelled by the unstable pole from the controller. The resulting input-output map is a constant gain, which is stable. This analysis, however, only concerns the external behavior and can hide internal instabilities.\n\nStep 2: Derivation of the Closed-Loop State-Space Realization\nThe state-space equations are:\n1. $x_{p}[k+1] = A_{p} x_{p}[k] + B_{p} u[k]$\n2. $y[k] = C_{p} x_{p}[k] + D_{p} u[k]$\n3. $x_{c}[k+1] = A_{c} x_{c}[k] + B_{c} e[k]$\n4. $u[k] = C_{c} x_{c}[k] + D_{c} e[k]$\n5. $e[k] = r[k] - y[k]$\n\nWe must eliminate the algebraic variables $u[k]$ and $e[k]$ to express the closed-loop system in terms of the state vector $x[k]$ and the external input $r[k]$.\nFirst, substitute (2) into (5):\n$e[k] = r[k] - (C_{p} x_{p}[k] + D_{p} u[k])$\nSubstitute this into (4):\n$u[k] = C_{c} x_{c}[k] + D_{c} (r[k] - C_{p} x_{p}[k] - D_{p} u[k])$\n$u[k] = C_{c} x_{c}[k] + D_{c} r[k] - D_{c} C_{p} x_{p}[k] - D_{c} D_{p} u[k]$\n$u[k] (1 + D_{p} D_{c}) = -D_{c} C_{p} x_{p}[k] + C_{c} x_{c}[k] + D_{c} r[k]$\nLet $M = (1 + D_{p} D_{c})^{-1}$.\n$u[k] = M(-D_{c} C_{p} x_{p}[k] + C_{c} x_{c}[k] + D_{c} r[k])$\nNow find $e[k]$ in terms of states and $r[k]$:\n$e[k] = r[k] - y[k] = r[k] - C_{p} x_{p}[k] - D_{p} u[k]$\n$e[k] = r[k] - C_{p} x_{p}[k] - D_{p} M(-D_{c} C_{p} x_{p}[k] + C_{c} x_{c}[k] + D_{c} r[k])$\n$e[k] = (1 - D_{p} M D_{c}) r[k] - (C_{p} - D_{p} M D_{c} C_{p}) x_{p}[k] - D_{p} M C_{c} x_{c}[k]$\nUsing the identity $(1+D_p D_c)^{-1} = 1 - D_p (1+D_c D_p)^{-1} D_c$, we can simplify. However, it is more direct to substitute the given numerical values: $A_{p}=0.3$, $B_{p}=-0.9$, $C_{p}=1$, $D_{p}=1$, and $A_{c}=1.2$, $B_{c}=0.9$, $C_{c}=1$, $D_{c}=1$.\n$u[k](1 + 1 \\cdot 1) = -(1)(1)x_{p}[k] + (1)x_{c}[k] + (1)r[k]$\n$2u[k] = -x_{p}[k] + x_{c}[k] + r[k] \\implies u[k] = -0.5 x_{p}[k] + 0.5 x_{c}[k] + 0.5 r[k]$\nAnd for $e[k]$:\n$e[k] = r[k] - y[k] = r[k] - (x_{p}[k] + u[k]) = r[k] - x_{p}[k] - (-0.5 x_{p}[k] + 0.5 x_{c}[k] + 0.5 r[k])$\n$e[k] = -0.5 x_{p}[k] - 0.5 x_{c}[k] + 0.5 r[k]$\nNow substitute these into the state-update equations:\n$x_{p}[k+1] = 0.3 x_{p}[k] - 0.9 u[k] = 0.3 x_{p}[k] - 0.9(-0.5 x_{p}[k] + 0.5 x_{c}[k] + 0.5 r[k])$\n$x_{p}[k+1] = (0.3 + 0.45)x_{p}[k] - 0.45 x_{c}[k] - 0.45 r[k] = 0.75 x_{p}[k] - 0.45 x_{c}[k] - 0.45 r[k]$\n$x_{c}[k+1] = 1.2 x_{c}[k] + 0.9 e[k] = 1.2 x_{c}[k] + 0.9(-0.5 x_{p}[k] - 0.5 x_{c}[k] + 0.5 r[k])$\n$x_{c}[k+1] = -0.45 x_{p}[k] + (1.2 - 0.45)x_{c}[k] + 0.45 r[k] = -0.45 x_{p}[k] + 0.75 x_{c}[k] + 0.45 r[k]$\nThe closed-loop state-space system is:\n$$ \\begin{pmatrix} x_{p}[k+1] \\\\ x_{c}[k+1] \\end{pmatrix} = \\begin{pmatrix} 0.75 & -0.45 \\\\ -0.45 & 0.75 \\end{pmatrix} \\begin{pmatrix} x_{p}[k] \\\\ x_{c}[k] \\end{pmatrix} + \\begin{pmatrix} -0.45 \\\\ 0.45 \\end{pmatrix} r[k] $$\nThe state-update matrix is $A_{\\mathrm{cl}} = \\begin{pmatrix} 0.75 & -0.45 \\\\ -0.45 & 0.75 \\end{pmatrix}$.\n\nStep 3: Eigenvalues of $A_{\\mathrm{cl}}$ and Internal Stability\nThe eigenvalues $\\lambda$ of $A_{\\mathrm{cl}}$ are found from $\\det(A_{\\mathrm{cl}} - \\lambda I) = 0$.\n$$ \\det \\begin{pmatrix} 0.75 - \\lambda & -0.45 \\\\ -0.45 & 0.75 - \\lambda \\end{pmatrix} = (0.75 - \\lambda)^{2} - (-0.45)^{2} = 0 $$\n$(0.75 - \\lambda)^{2} = (0.45)^{2}$\n$0.75 - \\lambda = \\pm 0.45$\nThe two eigenvalues are:\n$\\lambda_{1} = 0.75 - 0.45 = 0.3$\n$\\lambda_{2} = 0.75 + 0.45 = 1.2$\nFor a discrete-time system to be internally stable, all eigenvalues of the state matrix must have a magnitude strictly less than $1$. Here, $|\\lambda_{2}| = 1.2 > 1$. Therefore, the closed-loop system is internally unstable.\n\nStep 4: Explanation of the Hidden Unstable Mode\nThe unstable mode corresponds to the eigenvalue $\\lambda_{2} = 1.2$. The transfer function $T(z)=\\frac{1}{2}$ does not exhibit this instability. This phenomenon occurs because the unstable mode is unobservable from the output $y[k]$. We analyze the controllability and observability of the closed-loop system.\nThe full closed-loop system is $x[k+1] = A_{\\mathrm{cl}} x[k] + B_{\\mathrm{cl}} r[k]$, $y[k] = C_{\\mathrm{cl}} x[k] + D_{\\mathrm{cl}} r[k]$.\nFrom Step 2, $B_{\\mathrm{cl}} = \\begin{pmatrix} -0.45 \\\\ 0.45 \\end{pmatrix}$.\nWe derive $C_{\\mathrm{cl}}$ and $D_{\\mathrm{cl}}$:\n$y[k] = C_{p}x_{p}[k] + D_{p}u[k] = x_{p}[k] + u[k]$\n$y[k] = x_{p}[k] + (-0.5 x_{p}[k] + 0.5 x_{c}[k] + 0.5 r[k])$\n$y[k] = 0.5 x_{p}[k] + 0.5 x_{c}[k] + 0.5 r[k]$\nSo, $C_{\\mathrm{cl}} = \\begin{pmatrix} 0.5 & 0.5 \\end{pmatrix}$ and $D_{\\mathrm{cl}} = 0.5$.\n\nWe use the Popov-Belevitch-Hautus (PBH) test to check the observability of the unstable mode $\\lambda_2 = 1.2$. The mode is unobservable if the rank of the matrix $\\begin{pmatrix} \\lambda_{2} I - A_{\\mathrm{cl}} \\\\ C_{\\mathrm{cl}} \\end{pmatrix}$ is less than the state dimension $n=2$.\n$$ \\begin{pmatrix} \\lambda_{2} I - A_{\\mathrm{cl}} \\\\ C_{\\mathrm{cl}} \\end{pmatrix} = \\begin{pmatrix} 1.2 - 0.75 & -(-0.45) \\\\ -(-0.45) & 1.2 - 0.75 \\\\ \\hline 0.5 & 0.5 \\end{pmatrix} = \\begin{pmatrix} 0.45 & 0.45 \\\\ 0.45 & 0.45 \\\\ 0.5 & 0.5 \\end{pmatrix} $$\nAll three rows of this matrix are linearly dependent (each is a multiple of $\\begin{pmatrix} 1 & 1 \\end{pmatrix}$). The rank of this matrix is $1$, which is less than $n=2$. Therefore, the mode associated with the eigenvalue $\\lambda_2 = 1.2$ is unobservable.\nPhysically, this means that although the internal state corresponding to this mode can grow without bound, this growth is perfectly cancelled at the output and is therefore hidden from observation through $y[k]$. The eigenvector $v_2$ corresponding to $\\lambda_2 = 1.2$ is found by solving $(A_{\\mathrm{cl}} - 1.2 I)v_2 = 0$:\n$\\begin{pmatrix} -0.45 & -0.45 \\\\ -0.45 & -0.45 \\end{pmatrix} v_2 = 0$. This gives an eigenvector proportional to $v_2 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$.\nThe effect of this mode on the output is given by $C_{\\mathrm{cl}} v_2 = \\begin{pmatrix} 0.5 & 0.5 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = 0.5 - 0.5 = 0$. The output measurement is orthogonal to the direction of the unstable state mode, rendering it invisible. This is the state-space manifestation of the pole-zero cancellation in the transfer function domain.\n\nStep 5: Final Answer\nThe eigenvalues of $A_{\\mathrm{cl}}$ are $0.3$ and $1.2$. The unstable internal eigenvalue is the one with magnitude greater than $1$. This value is $1.2$.", "answer": "$$\\boxed{1.2}$$", "id": "2861162"}]}