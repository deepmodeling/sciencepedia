{"hands_on_practices": [{"introduction": "The fundamental goal of state feedback is not only to stabilize a system but also to make it perform a useful task, such as following a command. This first practice establishes this core skill by guiding you through a complete controller design. You will calculate the state feedback gain $K$ to place the closed-loop poles at desired locations for stability and transient response, and then determine the prefilter gain $N$ to ensure the system's output accurately tracks a reference input in steady-state [@problem_id:2907353].", "problem": "Consider the continuous-time linear time-invariant (LTI) single-input single-output state-space model with state vector $\\mathbf{x}(t) \\in \\mathbb{R}^{2}$, input $u(t) \\in \\mathbb{R}$, and output $y(t) \\in \\mathbb{R}$:\n$$\n\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t), \\quad y(t) = C \\mathbf{x}(t),\n$$\nwhere\n$$\nA = \\begin{bmatrix} 0 & 1 \\\\ -1 & -1 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & 0 \\end{bmatrix}.\n$$\nLet the control law be of the form\n$$\nu(t) = -K \\mathbf{x}(t) + N r(t),\n$$\nwhere $K \\in \\mathbb{R}^{1 \\times 2}$ is a state-feedback gain and $N \\in \\mathbb{R}$ is a scalar prefilter, and $r(t)$ is an external reference signal. The closed-loop state matrix is $A_{c} = A - B K$.\n\nStarting from first principles for linear systems, use the definition of the characteristic polynomial of a matrix and the steady-state balance of a linear time-invariant system under a constant input to:\n- Design $K = \\begin{bmatrix} k_{1} & k_{2} \\end{bmatrix}$ so that the closed-loop eigenvalues of $A_{c}$ are placed at the complex conjugate pair $\\{ -2 + j, -2 - j \\}$.\n- Determine the prefilter $N$ that achieves exact unit steady-state tracking for a unit step reference $r(t) = 1$ under the given control law.\n\nExpress your final answer as a single row matrix $\\begin{pmatrix} k_{1} & k_{2} & N \\end{pmatrix}$ with exact values (no rounding). Do not include any units.", "solution": "The problem as stated is scientifically sound, well-posed, and complete. It presents a standard exercise in linear control systems theory, specifically state-feedback controller design for pole placement and reference tracking. The system is described by a state-space model with given matrices $A$, $B$, and $C$. The system's controllability is a necessary condition for arbitrary pole placement. The controllability matrix is $\\mathcal{C} = \\begin{bmatrix} B & AB \\end{bmatrix}$.\nGiven $A = \\begin{bmatrix} 0 & 1 \\\\ -1 & -1 \\end{bmatrix}$ and $B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$, we compute $AB = \\begin{bmatrix} 0 & 1 \\\\ -1 & -1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix}$.\nThe controllability matrix is $\\mathcal{C} = \\begin{bmatrix} 0 & 1 \\\\ 1 & -1 \\end{bmatrix}$. The determinant is $\\det(\\mathcal{C}) = (0)(-1) - (1)(1) = -1 \\neq 0$. The system is controllable, thus the closed-loop poles can be placed arbitrarily. The problem is valid and a solution can be derived.\n\nThe solution proceeds in two parts as requested: first, the design of the state-feedback gain $K$ for pole placement, and second, the determination of the prefilter $N$ for steady-state tracking.\n\nPart 1: Design of State-Feedback Gain $K = \\begin{bmatrix} k_{1} & k_{2} \\end{bmatrix}$\nThe control law is $u(t) = -K \\mathbf{x}(t) + N r(t)$. The closed-loop state dynamics are given by $\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B(-K \\mathbf{x}(t) + N r(t)) = (A-BK)\\mathbf{x}(t) + BNr(t)$.\nThe closed-loop state matrix is $A_c = A - BK$. We compute this matrix symbolically:\n$$\nBK = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} k_1 & k_2 \\end{bmatrix} = \\begin{bmatrix} 0 & 0 \\\\ k_1 & k_2 \\end{bmatrix}\n$$\n$$\nA_c = A - BK = \\begin{bmatrix} 0 & 1 \\\\ -1 & -1 \\end{bmatrix} - \\begin{bmatrix} 0 & 0 \\\\ k_1 & k_2 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 \\\\ -1-k_1 & -1-k_2 \\end{bmatrix}\n$$\nThe eigenvalues of the closed-loop system are the roots of the characteristic polynomial $p_{A_c}(\\lambda) = \\det(\\lambda I - A_c)$, where $I$ is the $2 \\times 2$ identity matrix.\n$$\n\\lambda I - A_c = \\lambda \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} - \\begin{bmatrix} 0 & 1 \\\\ -1-k_1 & -1-k_2 \\end{bmatrix} = \\begin{bmatrix} \\lambda & -1 \\\\ 1+k_1 & \\lambda+1+k_2 \\end{bmatrix}\n$$\nThe characteristic polynomial is:\n$$\np_{A_c}(\\lambda) = \\det(\\lambda I - A_c) = \\lambda(\\lambda+1+k_2) - (-1)(1+k_1) = \\lambda^2 + (1+k_2)\\lambda + (1+k_1)\n$$\nThe desired closed-loop eigenvalues are specified as $\\{ -2 + j, -2 - j \\}$. The desired characteristic polynomial, $p_{des}(\\lambda)$, is formed from these roots:\n$$\np_{des}(\\lambda) = (\\lambda - (-2+j))(\\lambda - (-2-j)) = ((\\lambda+2)-j)((\\lambda+2)+j)\n$$\n$$\np_{des}(\\lambda) = (\\lambda+2)^2 - j^2 = (\\lambda+2)^2 + 1 = \\lambda^2 + 4\\lambda + 4 + 1 = \\lambda^2 + 4\\lambda + 5\n$$\nTo place the poles at the desired locations, the actual characteristic polynomial must be identical to the desired one: $p_{A_c}(\\lambda) = p_{des}(\\lambda)$. We equate the coefficients of like powers of $\\lambda$:\n$$\n\\lambda^2 + (1+k_2)\\lambda + (1+k_1) = \\lambda^2 + 4\\lambda + 5\n$$\nComparing the coefficient of $\\lambda^1$:\n$$\n1 + k_2 = 4 \\implies k_2 = 3\n$$\nComparing the coefficient of $\\lambda^0$ (the constant term):\n$$\n1 + k_1 = 5 \\implies k_1 = 4\n$$\nThus, the required state-feedback gain is $K = \\begin{bmatrix} 4 & 3 \\end{bmatrix}$.\n\nPart 2: Determination of Prefilter $N$\nThe goal is to achieve unit steady-state tracking for a unit step reference, which means the output $y(t)$ must approach $1$ as $t \\to \\infty$ when the input is $r(t) = 1$ for $t \\geq 0$. This steady-state value is denoted $y_{ss}=1$.\nThe closed-loop system dynamics are $\\dot{\\mathbf{x}}(t) = A_c \\mathbf{x}(t) + BNr(t)$, with the output $y(t) = C\\mathbf{x}(t)$.\nThe closed-loop eigenvalues have negative real parts ($-2$), so the closed-loop system is stable. For a constant reference input $r(t) = 1$, the state vector $\\mathbf{x}(t)$ will converge to a constant steady-state value $\\mathbf{x}_{ss}$, at which point its derivative is zero: $\\dot{\\mathbf{x}}_{ss} = \\mathbf{0}$.\nThe steady-state balance equation is:\n$$\n\\mathbf{0} = A_c \\mathbf{x}_{ss} + BN(1)\n$$\nThis gives $A_c \\mathbf{x}_{ss} = -BN$. Since the eigenvalues of $A_c$ are non-zero, $A_c$ is invertible. We can solve for $\\mathbf{x}_{ss}$:\n$$\n\\mathbf{x}_{ss} = -A_c^{-1}BN\n$$\nThe steady-state output $y_{ss}$ is then given by:\n$$\ny_{ss} = C \\mathbf{x}_{ss} = C (-A_c^{-1}BN) = -C A_c^{-1} B N\n$$\nWe require $y_{ss} = 1$. Therefore, we must solve for $N$ from the equation:\n$$\n1 = -C A_c^{-1} B N\n$$\nFirst, we substitute the values of $k_1=4$ and $k_2=3$ into $A_c$:\n$$\nA_c = \\begin{bmatrix} 0 & 1 \\\\ -1-4 & -1-3 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 \\\\ -5 & -4 \\end{bmatrix}\n$$\nThe inverse of $A_c$ is $A_c^{-1} = \\frac{1}{\\det(A_c)}\\text{adj}(A_c)$. The determinant is $\\det(A_c) = (0)(-4) - (1)(-5) = 5$.\n$$\nA_c^{-1} = \\frac{1}{5} \\begin{bmatrix} -4 & -1 \\\\ 5 & 0 \\end{bmatrix}\n$$\nNow we compute the scalar quantity $C A_c^{-1} B$:\n$$\nC A_c^{-1} B = \\begin{bmatrix} 1 & 0 \\end{bmatrix} \\left( \\frac{1}{5} \\begin{bmatrix} -4 & -1 \\\\ 5 & 0 \\end{bmatrix} \\right) \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n$$\n$$\nC A_c^{-1} B = \\frac{1}{5} \\begin{bmatrix} 1 & 0 \\end{bmatrix} \\begin{bmatrix} -4 & -1 \\\\ 5 & 0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\frac{1}{5} \\begin{bmatrix} -4 & -1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\frac{1}{5}((-4)(0) + (-1)(1)) = -\\frac{1}{5}\n$$\nSubstituting this result into the tracking condition:\n$$\n1 = - \\left( -\\frac{1}{5} \\right) N = \\frac{1}{5}N\n$$\nSolving for $N$ yields:\n$$\nN = 5\n$$\nThe required gain and prefilter values are $k_1 = 4$, $k_2 = 3$, and $N = 5$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4 & 3 & 5\n\\end{pmatrix}\n}\n$$", "id": "2907353"}, {"introduction": "Moving beyond the nominal design, a crucial aspect of engineering is ensuring robustness against real-world uncertainties. This exercise challenges you to think critically about *where* to place poles, not just how. You will explore why seemingly optimal pole placements, such as repeated poles for fast response, can lead to designs that are highly sensitive to small perturbations in the system model [@problem_id:2907415]. This practice teaches the important engineering trade-off between aggressive performance and the need for a design that remains reliable when implemented.", "problem": "Consider the single-input linear time-invariant (LTI) state-space system with full-state feedback,\n$$\\dot{x}(t) = A x(t) + b u(t), \\quad u(t) = -K x(t),$$\nwhere\n$$A = \\begin{bmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -6 & -11 & -6 \\end{bmatrix}, \\quad b = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix},$$\nand $K \\in \\mathbb{R}^{1 \\times 3}$ is to be designed by pole placement. The feedback-closed matrix is $A_{\\mathrm{cl}} = A - bK$ and its eigenvalues are the closed-loop poles. Assume that the plant is subject to norm-bounded modeling uncertainty so that the implemented closed-loop matrix is $A_{\\mathrm{cl}} + \\Delta A,$ with $\\lVert \\Delta A \\rVert_{2} \\le \\varepsilon,$ for a small but nonzero $\\varepsilon > 0.$\n\nYou are asked to choose a pole-placement target that mitigates sensitivity of the closed-loop eigenvalues to the perturbation $\\Delta A$ while preserving the time-domain specifications that the step response be non-oscillatory (all closed-loop poles real) and have a $2\\%$ settling time no greater than $1\\,\\mathrm{s}$. You may assume the system is controllable and any monic cubic real-coefficient characteristic polynomial can be assigned by an appropriate choice of $K$.\n\nWhich of the following desired closed-loop pole sets is the most appropriate choice?\n\nA. $\\{-5, -5, -5\\}$\n\nB. $\\{-5.4, -5, -4.6\\}$\n\nC. $\\{-5, -5 \\pm j\\,4\\}$\n\nD. $\\{-3, -5, -7\\}$\n\nSelect the single best option and justify your choice from first principles, namely by reasoning from the definition of the characteristic polynomial $\\det(s I - A_{\\mathrm{cl}})$, the structure of Jordan blocks for repeated eigenvalues, and the relationship between pole locations and dominant time constants for linear time-invariant systems. Do not assume or invoke any result not derivable from these bases. Explain why repeated poles increase sensitivity and how a slight pole split can mitigate it without violating the specifications, and argue why the other options fail to meet either robustness or specification requirements.", "solution": "The problem statement is first subjected to validation.\n\n**Step 1: Extract Givens**\n- System model: Single-input linear time-invariant (LTI) state-space system $\\dot{x}(t) = A x(t) + b u(t)$.\n- State feedback: $u(t) = -K x(t)$.\n- System matrices: $A = \\begin{bmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -6 & -11 & -6 \\end{bmatrix}$, $b = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$.\n- Feedback gain: $K \\in \\mathbb{R}^{1 \\times 3}$ to be designed.\n- Closed-loop system: $\\dot{x}(t) = (A - bK)x(t) = A_{\\mathrm{cl}}x(t)$.\n- Perturbation model: The implemented closed-loop matrix is $A_{\\mathrm{cl}} + \\Delta A$, with perturbation bound $\\lVert \\Delta A \\rVert_{2} \\le \\varepsilon$ for a small $\\varepsilon > 0$.\n- Design Objective: Choose a pole-placement target that mitigates eigenvalue sensitivity to $\\Delta A$.\n- Performance Specification 1: The step response must be non-oscillatory.\n- Performance Specification 2: The $2\\%$ settling time, $T_s$, must be no greater than $1\\,\\mathrm{s}$.\n- Assumption 1: The pair $(A, b)$ is controllable.\n- Assumption 2: Any monic cubic real-coefficient characteristic polynomial can be assigned.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is well-defined within the domain of control theory, specifically state-feedback design and robustness analysis.\n1.  **Scientific Grounding**: The concepts of state-space representation, pole placement, settling time, non-oscillatory response, and eigenvalue sensitivity to matrix perturbations are fundamental principles in control engineering and linear algebra. The given $A$ matrix is in companion form (specifically, controllable canonical form), a standard representation.\n2.  **Well-Posedness**: The state and input matrices define a third-order single-input system. The assumption of controllability is standard for pole placement problems and can be verified. The controllability matrix is $\\mathcal{C} = \\begin{bmatrix} b & Ab & A^2b \\end{bmatrix} = \\begin{bmatrix} 0 & 0 & 1 \\\\ 0 & 1 & -6 \\\\ 1 & -6 & 25 \\end{bmatrix}$. The determinant is $\\det(\\mathcal{C}) = -1 \\neq 0$, so the system is indeed controllable. Since the system is controllable, arbitrary pole placement is possible, validating the second assumption. The problem asks for the \"most appropriate\" choice among options based on a set of clear, quantitative, and qualitative criteria, which is a standard engineering design problem.\n3.  **Objectivity**: The problem uses precise, objective terminology ($2\\%$ settling time, non-oscillatory, norm-bounded uncertainty).\n4.  **Completeness**: The problem provides all necessary data and constraints to evaluate the given options.\n\n**Step 3: Verdict and Action**\nThe problem statement is scientifically sound, well-posed, objective, and complete. It is declared **valid**. We may proceed with the solution.\n\n**Derivation of Solution**\n\nThe solution requires selecting a set of desired closed-loop poles that satisfies two performance specifications and one robustness objective.\n\n**1. Analysis of Performance Specifications**\n\n- **Non-oscillatory Response**: For a linear time-invariant system, an oscillatory response (containing sinusoidal components) arises from poles with non-zero imaginary parts. To ensure a purely non-oscillatory response, all closed-loop eigenvalues (poles) $\\lambda_i$ must be real numbers.\n\n- **Settling Time**: The $2\\%$ settling time, $T_s$, is the time it takes for the system's response to a step input to settle within $2\\%$ of its final value. For a system with poles $\\lambda_1, \\lambda_2, \\dots, \\lambda_n$, the transient response is a linear combination of terms like $e^{\\lambda_i t}$ (or $t^k e^{\\lambda_i t}$ for repeated poles). The rate of decay is governed by the real parts of the poles. The slowest-decaying mode corresponds to the pole with the largest real part (i.e., the one closest to the imaginary axis). This is the dominant pole. Let $\\sigma_{\\min} = \\min_i |\\text{Re}(\\lambda_i)|$. The $2\\%$ settling time is approximated by $T_s \\approx \\frac{4}{\\sigma_{\\min}}$ for dominant poles. The specification $T_s \\le 1\\,\\mathrm{s}$ imposes the constraint $\\frac{4}{\\sigma_{\\min}} \\le 1$, which implies $\\sigma_{\\min} \\ge 4$. Since all poles must be in the left-half plane for stability, this means all poles $\\lambda_i$ must satisfy $\\text{Re}(\\lambda_i) \\le -4$.\n\nCombining both specifications, any valid set of poles must consist of only real numbers, all of which must be less than or equal to $-4$.\n\n**2. Analysis of Robustness Objective**\n\nThe objective is to mitigate the sensitivity of the closed-loop eigenvalues to perturbations, $\\Delta A$. This sensitivity is fundamentally related to the structure of the eigenvectors of the closed-loop matrix, $A_{\\mathrm{cl}}$.\n\n- **Case 1: Distinct Eigenvalues**: If $A_{\\mathrm{cl}}$ has distinct eigenvalues, it is diagonalizable. Its eigenvectors form a basis for $\\mathbb{R}^3$. The sensitivity of its eigenvalues to perturbation is related to the condition number of the matrix of its eigenvectors.\n- **Case 2: Repeated Eigenvalues**: If $A_{\\mathrm{cl}}$ has repeated eigenvalues, it may or may not be diagonalizable. If the geometric multiplicity of an eigenvalue (the dimension of its eigenspace) is less than its algebraic multiplicity (its repetition in the characteristic polynomial), the matrix is termed \"defective\" and cannot be diagonalized. Instead, its canonical form is the Jordan normal form, which contains Jordan blocks of size greater than $1$. Eigenvalues associated with non-trivial Jordan blocks are known to be extremely sensitive to perturbations. A perturbation of norm $\\varepsilon$ to a matrix with a Jordan block of size $n$ can cause its eigenvalue to shift by an amount on the order of $\\varepsilon^{1/n}$. For $n > 1$ and small $\\varepsilon$, $\\varepsilon^{1/n} \\gg \\varepsilon$, indicating extreme sensitivity.\n\nLet us determine if repeated poles for the given system lead to a defective matrix. The closed-loop matrix is $A_{\\mathrm{cl}} = A - bK$. Given $K = \\begin{bmatrix} k_1 & k_2 & k_3 \\end{bmatrix}$, we have:\n$$A_{\\mathrm{cl}} = \\begin{bmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -6 & -11 & -6 \\end{bmatrix} - \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} k_1 & k_2 & k_3 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -6-k_1 & -11-k_2 & -6-k_3 \\end{bmatrix}$$\nThis is a companion matrix. Its characteristic polynomial is $\\det(sI - A_{\\mathrm{cl}}) = s^3 + (6+k_3)s^2 + (11+k_2)s + (6+k_1)$.\nA companion matrix is non-derogatory, which means that the geometric multiplicity of each of its eigenvalues is always $1$. Therefore, if we choose a pole set with repeated eigenvalues (algebraic multiplicity $>1$), the resulting $A_{\\mathrm{cl}}$ matrix will necessarily be defective. For a triple pole at $s = \\lambda$, there will be a single $3 \\times 3$ Jordan block associated with $\\lambda$. This will lead to eigenvalue sensitivity of order $\\varepsilon^{1/3}$, which is undesirable.\n\nTo achieve robust pole placement, one must avoid defective closed-loop matrices. This means all closed-loop poles should be distinct.\n\n**3. Evaluation of Options**\n\nWe now evaluate each option against the derived criteria.\n\n**A. $\\{-5,-5,-5\\}$**\n- **Performance**:\n    - Non-oscillatory: All poles are real. This condition is met.\n    - Settling time: All poles are at $-5$. The dominant pole real part is $-5$. $|\\text{Re}(\\lambda)| = 5 \\ge 4$. This condition is met.\n- **Robustness**: This choice involves a triple pole at $s=-5$. As established above, this will force the closed-loop matrix $A_{\\mathrm{cl}}$ to be defective, with a $3 \\times 3$ Jordan block. The sensitivity of the poles to perturbations will be of order $\\varepsilon^{1/3}$. This is a very non-robust design.\n- **Verdict**: **Incorrect**. While it meets performance specifications, it fails catastrophically on the robustness requirement.\n\n**B. $\\{-5.4, -5.0, -4.6\\}$**\n- **Performance**:\n    - Non-oscillatory: All poles are real. This condition is met.\n    - Settling time: The dominant pole (closest to the imaginary axis) is $s=-4.6$. The real part is $-4.6$. We check $|\\text{Re}(\\lambda)| \\ge 4$, which is true since $4.6 \\ge 4$. The approximate settling time is $T_s \\approx 4/4.6 \\approx 0.87\\,\\mathrm{s}$, which is less than $1\\,\\mathrm{s}$. This condition is met.\n- **Robustness**: The poles are distinct ($-5.4 \\neq -5.0 \\neq -4.6$). This ensures that the resulting $A_{\\mathrm{cl}}$ matrix is diagonalizable, and its eigenvalues have sensitivity of order $\\varepsilon$. By slightly splitting the poles from the $\\{-5,-5,-5\\}$ configuration, robustness is drastically improved.\n- **Verdict**: **Correct**. This option satisfies both performance specifications and the robustness objective by selecting distinct, real poles that are sufficiently far into the left-half plane. It represents a standard engineering compromise to enhance robustness.\n\n**C. $\\{-5,-5 \\pm j\\,4\\}$**\n- **Performance**:\n    - Non-oscillatory: The pole set contains a complex conjugate pair $-5 \\pm j\\,4$. The system response will be oscillatory. This violates the first performance specification.\n- **Verdict**: **Incorrect**. It fails to meet a key performance requirement.\n\n**D. $\\{-3,-5,-7\\}$**\n- **Performance**:\n    - Non-oscillatory: All poles are real. This condition is met.\n    - Settling time: The dominant pole is $s=-3$. The real part $\\text{Re}(\\lambda) = -3$. We require $\\text{Re}(\\lambda) \\le -4$, but $-3 > -4$, so this condition is violated. The approximate settling time would be $T_s \\approx 4/3 \\approx 1.33\\,\\mathrm{s}$, which is greater than the maximum allowed $1\\,\\mathrm{s}$.\n- **Verdict**: **Incorrect**. It fails to meet the settling time specification.\n\n**Conclusion**\nOption B is the only choice that simultaneously satisfies the requirements for a non-oscillatory response, a settling time of no more than $1\\,\\mathrm{s}$, and robust placement of eigenvalues. It achieves this by placing distinct real poles, all of which are to the left of $s=-4$, thereby avoiding both the performance failures of C and D, and the robustness failure of A.", "answer": "$$\\boxed{B}$$", "id": "2907415"}, {"introduction": "Robustness issues can arise not only from the choice of target poles but also from the intrinsic properties of the system itself. This advanced practice delves into the numerical conditioning of the pole placement problem. You will analyze how a system that is theoretically controllable but \"nearly uncontrollable\" results in an ill-conditioned controllability matrix $\\mathcal{C}$, making the feedback gain calculation sensitive and fragile [@problem_id:2907397]. The exercise demonstrates how a simple coordinate scaling can dramatically improve the numerical health of the problem, leading to a more reliable and robust controller implementation.", "problem": "A continuous-time linear time-invariant (LTI) state-space model is given by\n$$\n\\dot{x}(t) = A x(t) + B u(t), \\quad A = \\begin{bmatrix} 0 & 1 \\\\ -1000 & -1 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}.\n$$\nThe controllability matrix is defined by\n$$\n\\mathcal{C} \\triangleq \\begin{bmatrix} B & A B & \\cdots & A^{n-1} B \\end{bmatrix}.\n$$\nState feedback pole placement seeks a feedback gain $K$ such that the closed-loop matrix $A_{\\mathrm{cl}} \\triangleq A - B K$ has a prescribed set of eigenvalues. Robustness of such a design is impacted by numerical sensitivity that arises when linear algebraic steps in the design algorithm are ill-conditioned.\n\nStarting from the definitions of controllability, similarity transformation, and matrix condition number, analyze how near uncontrollability (manifested as an ill-conditioned $\\mathcal{C}$) degrades the robustness of pole placement and how coordinate scaling can improve conditioning without changing the achievable closed-loop poles. Consider a similarity transformation $x = S z$ with $S = \\mathrm{diag}(1, 1000)$, leading to transformed data $A_{z} = S^{-1} A S$ and $B_{z} = S^{-1} B$, and a transformed controllability matrix $\\mathcal{C}_{z}$.\n\nSelect all statements that are correct.\n\nA. For the given $(A, B)$, the controllability matrix $\\mathcal{C}$ is ill-conditioned, which implies that small relative perturbations in $A$, $B$, or intermediate numerical quantities during pole placement can produce large relative perturbations in the computed feedback gain $K$, degrading robustness of the closed-loop pole locations.\n\nB. The similarity scaling $x = S z$ with $S = \\mathrm{diag}(1, 1000)$ improves the conditioning of the controllability matrix (in a spectral norm sense) and does not change controllability or the set of assignable closed-loop eigenvalues; if a gain $K_{z}$ is designed in $z$-coordinates and mapped back as $K = K_{z} S^{-1}$, the closed-loop eigenvalues are preserved.\n\nC. The scaling $x = S z$ can change the set of assignable poles because it post-multiplies the controllability matrix by $S$, altering the reachable subspace.\n\nD. For the given $(A, B)$ and $S = \\mathrm{diag}(1, 1000)$, the transformed controllability matrix $\\mathcal{C}_{z}$ has a spectral condition number equal to $1$, whereas the original $\\mathcal{C}$ has a spectral condition number equal to $1000$.\n\nE. If the pair $(A, B)$ is controllable, the conditioning of $\\mathcal{C}$ does not affect the sensitivity of pole placement; numerical conditioning only matters when $(A, B)$ is uncontrollable.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Continuous-time linear time-invariant (LTI) state-space model: $\\dot{x}(t) = A x(t) + B u(t)$.\n- State matrix: $A = \\begin{bmatrix} 0 & 1 \\\\ -1000 & -1 \\end{bmatrix}$.\n- Input matrix: $B = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$.\n- State dimension: $n=2$.\n- Controllability matrix definition: $\\mathcal{C} \\triangleq \\begin{bmatrix} B & A B & \\cdots & A^{n-1} B \\end{bmatrix}$.\n- Closed-loop matrix definition: $A_{\\mathrm{cl}} \\triangleq A - B K$.\n- Similarity transformation: $x = S z$ with scaling matrix $S = \\mathrm{diag}(1, 1000)$.\n- Transformed system matrices: $A_{z} = S^{-1} A S$ and $B_{z} = S^{-1} B$.\n- Transformed controllability matrix: $\\mathcal{C}_{z}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it deals with fundamental concepts of linear control theory, including state-space representation, controllability, pole placement, and the numerical aspects of these methods. The problem is well-posed, providing all necessary matrices and definitions to perform the required analysis. The language is objective and precise. The problem does not violate any scientific principles, is not based on false premises, and proposes a standard, verifiable analysis of a control system.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. We may proceed with the solution.\n\n**Derivation**\n\nFirst, we analyze the original system $(A, B)$.\nThe state dimension is $n=2$. The controllability matrix is $\\mathcal{C} = \\begin{bmatrix} B & AB \\end{bmatrix}$.\nWe compute the product $AB$:\n$$\nAB = \\begin{bmatrix} 0 & 1 \\\\ -1000 & -1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ -1000 \\end{bmatrix}\n$$\nThe controllability matrix $\\mathcal{C}$ is therefore:\n$$\n\\mathcal{C} = \\begin{bmatrix} 1 & 0 \\\\ 0 & -1000 \\end{bmatrix}\n$$\nThe system is controllable because $\\det(\\mathcal{C}) = (1)(-1000) - (0)(0) = -1000 \\neq 0$.\nThe numerical conditioning of $\\mathcal{C}$ is evaluated using the spectral condition number, $\\kappa_2(\\mathcal{C}) = \\lVert\\mathcal{C}\\rVert_2 \\lVert\\mathcal{C}^{-1}\\rVert_2 = \\sigma_{\\max}(\\mathcal{C}) / \\sigma_{\\min}(\\mathcal{C})$. For a diagonal matrix, the singular values are the absolute values of the diagonal entries. The singular values of $\\mathcal{C}$ are $\\sigma_1 = 1000$ and $\\sigma_2 = 1$.\nThe condition number is:\n$$\n\\kappa_2(\\mathcal{C}) = \\frac{1000}{1} = 1000\n$$\nA condition number of $1000$ indicates that the matrix is ill-conditioned.\n\nNext, we analyze the system after the similarity transformation $x = Sz$.\nThe scaling matrix is $S = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1000 \\end{bmatrix}$ and its inverse is $S^{-1} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1/1000 \\end{bmatrix}$.\nThe transformed system matrices $(A_z, B_z)$ are:\n$$\nA_z = S^{-1} A S = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1/1000 \\end{bmatrix} \\begin{bmatrix} 0 & 1 \\\\ -1000 & -1 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\\\ 0 & 1000 \\end{bmatrix} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1/1000 \\end{bmatrix} \\begin{bmatrix} 0 & 1000 \\\\ -1000 & -1000 \\end{bmatrix} = \\begin{bmatrix} 0 & 1000 \\\\ -1 & -1 \\end{bmatrix}\n$$\n$$\nB_z = S^{-1} B = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1/1000 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}\n$$\nThe transformed controllability matrix is $\\mathcal{C}_z = \\begin{bmatrix} B_z & A_z B_z \\end{bmatrix}$.\nWe compute the product $A_z B_z$:\n$$\nA_z B_z = \\begin{bmatrix} 0 & 1000 \\\\ -1 & -1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ -1 \\end{bmatrix}\n$$\nThe transformed controllability matrix $\\mathcal{C}_z$ is:\n$$\n\\mathcal{C}_z = \\begin{bmatrix} 1 & 0 \\\\ 0 & -1 \\end{bmatrix}\n$$\nThe singular values of $\\mathcal{C}_z$ are $\\sigma_1 = 1$ and $\\sigma_2 = 1$.\nThe condition number of $\\mathcal{C}_z$ is:\n$$\n\\kappa_2(\\mathcal{C}_z) = \\frac{1}{1} = 1\n$$\nA condition number of $1$ signifies a perfectly conditioned matrix. The scaling has dramatically improved the conditioning.\n\nA general property of similarity transformations is that they preserve controllability. The relationship between the controllability matrices is $\\mathcal{C}_z = S^{-1}\\mathcal{C}$. Since $S$ is invertible, $\\text{rank}(\\mathcal{C}_z) = \\text{rank}(\\mathcal{C})$. Thus, $(A_z, B_z)$ is controllable if and only if $(A, B)$ is.\n\nFurthermore, a similarity transformation preserves the eigenvalues of a closed-loop system. If a feedback gain $K_z$ is designed for the $z$-system, the control law is $u = -K_z z$. In the original coordinates, this becomes $u = -K_z (S^{-1} x) = -(K_z S^{-1}) x$. This corresponds to a feedback gain $K = K_z S^{-1}$ for the original system. The resulting closed-loop matrix is $A_{\\mathrm{cl}} = A - BK = A - B(K_z S^{-1})$. The closed-loop matrix for the $z$-system is $A_{z,cl} = A_z - B_z K_z$. These two matrices are related by a similarity transformation:\n$$\nS A_{z,cl} S^{-1} = S(A_z - B_z K_z)S^{-1} = S(S^{-1}AS - S^{-1}B K_z)S^{-1} = A - B K_z S^{-1} = A_{\\mathrm{cl}}\n$$\nSince $A_{\\mathrm{cl}}$ and $A_{z,cl}$ are similar, they have the same set of eigenvalues. Therefore, designing poles in the well-conditioned $z$-coordinates and transforming the gain back to the $x$-coordinates yields the desired closed-loop poles.\n\n**Option-by-Option Analysis**\n\nA. For the given $(A, B)$, the controllability matrix $\\mathcal{C}$ is ill-conditioned, which implies that small relative perturbations in $A$, $B$, or intermediate numerical quantities during pole placement can produce large relative perturbations in the computed feedback gain $K$, degrading robustness of the closed-loop pole locations.\nOur calculation shows $\\kappa_2(\\mathcal{C})=1000$, which is ill-conditioned. The statement correctly identifies the consequence of an ill-conditioned controllability matrix: pole placement algorithms become numerically sensitive. Small errors in the problem data or during computation are amplified, leading to large errors in the feedback gain $K$, and consequently, the actual closed-loop poles may deviate significantly from the desired ones. This is a standard result in the numerical analysis of control systems.\nVerdict: **Correct**.\n\nB. The similarity scaling $x = S z$ with $S = \\mathrm{diag}(1, 1000)$ improves the conditioning of the controllability matrix (in a spectral norm sense) and does not change controllability or the set of assignable closed-loop eigenvalues; if a gain $K_{z}$ is designed in $z$-coordinates and mapped back as $K = K_{z} S^{-1}$, the closed-loop eigenvalues are preserved.\nOur calculations show that the condition number improves from $1000$ to $1$. As established in our derivation, a similarity transformation preserves controllability, and thus the set of assignable poles. We also showed that the mapping $K = K_z S^{-1}$ preserves the closed-loop eigenvalues. The statement is entirely accurate.\nVerdict: **Correct**.\n\nC. The scaling $x = S z$ can change the set of assignable poles because it post-multiplies the controllability matrix by $S$, altering the reachable subspace.\nThis statement is incorrect on two counts. First, the transformation on the controllability matrix is $\\mathcal{C}_z = S^{-1}\\mathcal{C}$, not post-multiplication by $S$. Second, and more fundamentally, a similarity transformation preserves controllability. Since the original system is controllable, the transformed system is also controllable, and therefore the set of assignable poles remains the set of all possible self-conjugate pole configurations. The reachable subspace is not altered in a way that would limit pole assignability.\nVerdict: **Incorrect**.\n\nD. For the given $(A, B)$ and $S = \\mathrm{diag}(1, 1000)$, the transformed controllability matrix $\\mathcal{C}_{z}$ has a spectral condition number equal to $1$, whereas the original $\\mathcal{C}$ has a spectral condition number equal to $1000$.\nOur explicit calculations confirm these values: $\\kappa_2(\\mathcal{C}) = 1000$ and $\\kappa_2(\\mathcal{C}_z) = 1$. The statement is a correct report of the calculated values.\nVerdict: **Correct**.\n\nE. If the pair $(A, B)$ is controllable, the conditioning of $\\mathcal{C}$ does not affect the sensitivity of pole placement; numerical conditioning only matters when $(A, B)$ is uncontrollable.\nThis statement is fundamentally flawed. If a system is uncontrollable, arbitrary pole placement is impossible to begin with. The entire problem of numerical sensitivity in pole placement is pertinent precisely for systems that are controllable but \"close\" to being uncontrollable, a situation characterized by an ill-conditioned controllability matrix $\\mathcal{C}$. Therefore, the conditioning of $\\mathcal{C}$ is of paramount importance for controllable systems.\nVerdict: **Incorrect**.\n\nSummary: The correct statements are A, B, and D.", "answer": "$$\\boxed{ABD}$$", "id": "2907397"}]}