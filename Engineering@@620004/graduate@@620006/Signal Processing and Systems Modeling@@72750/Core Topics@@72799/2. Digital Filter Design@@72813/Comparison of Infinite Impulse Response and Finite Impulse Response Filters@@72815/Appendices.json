{"hands_on_practices": [{"introduction": "The names \"Finite Impulse Response\" (FIR) and \"Infinite Impulse Response\" (IIR) point to the most fundamental distinction between these two filter classes. This practice delves into the nature of the IIR filter's response by deriving its impulse response $h[n]$ from first principles for a second-order system [@problem_id:2859316]. By analyzing how the pole locations dictate whether the impulse response decays monotonically or oscillatorily, you will gain a concrete understanding of the time-domain implications of the feedback structure inherent to IIR filters.", "problem": "Consider a causal, stable, linear time-invariant (LTI) discrete-time infinite impulse response (IIR) filter of order $2$ with distinct real poles. Its system function is given by\n$$\nH(z) \\;=\\; \\frac{b_0 + b_1 z^{-1}}{\\left(1 - p_1 z^{-1}\\right)\\left(1 - p_2 z^{-1}\\right)},\n$$\nwhere $p_1$ and $p_2$ are real, distinct poles with $p_i = s_i r_i$, $s_i \\in \\{+1,-1\\}$, $r_i \\in (0,1)$ for $i \\in \\{1,2\\}$, and $b_0, b_1 \\in \\mathbb{R}$. Assume the region of convergence corresponds to causality and bounded-input bounded-output stability. The input is the Kronecker delta $\\delta[n]$, so the output is the impulse response $h[n]$.\n\nStarting from core definitions for the $z$-transform and geometric series, derive a closed-form expression for the impulse response $h[n]$ in terms of $b_0$, $b_1$, $p_1$, $p_2$, and the unit step $u[n]$. Then, by analyzing the real-pole contributions and their magnitudes $r_1$ and $r_2$ together with the signs $s_1$ and $s_2$, identify conditions on $(r_1,r_2)$ and $(s_1,s_2)$ under which the impulse response exhibits:\n- monotonic decay (no sign alternation, and the envelope decreases with $n$), versus\n- oscillatory decay (sign alternation present).\n\nYour final answer must be the single closed-form expression for $h[n]$ you derived. Do not include explanatory text in the final answer. No numerical approximation is required.", "solution": "The problem presented is a standard exercise in the analysis of discrete-time linear time-invariant systems. We will first perform a rigorous validation of the problem statement.\n\nProblem Validation:\n\nStep 1: Extract Givens\n- System Type: Causal, stable, linear time-invariant (LTI), discrete-time, infinite impulse response (IIR) filter.\n- Order: $2$.\n- Poles: $p_1$ and $p_2$, which are real and distinct ($p_1 \\neq p_2$).\n- Pole Representation: $p_i = s_i r_i$, where $s_i \\in \\{+1, -1\\}$ and $r_i \\in (0, 1)$ for $i \\in \\{1, 2\\}$.\n- Numerator Coefficients: $b_0, b_1 \\in \\mathbb{R}$.\n- System Function: $H(z) = \\frac{b_0 + b_1 z^{-1}}{\\left(1 - p_1 z^{-1}\\right)\\left(1 - p_2 z^{-1}\\right)}$.\n- Region of Convergence (ROC): Corresponds to causality and bounded-input bounded-output (BIBO) stability.\n- Input: Kronecker delta, $x[n] = \\delta[n]$.\n- Output: Impulse response, $y[n] = h[n]$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a fundamental topic in digital signal processing. It is well-posed, with sufficient information to derive a unique solution for the impulse response $h[n]$. The language is objective and precise. The conditions given are consistent: for a causal LTI system, the ROC must be the exterior of a circle containing all poles, i.e., $|z| > \\max(|p_1|, |p_2|)$. For BIBO stability, the ROC must include the unit circle, $|z|=1$. The given pole property $|p_i| = r_i \\in (0, 1)$ means both poles lie strictly inside the unit circle. Therefore, the ROC $|z| > \\max(r_1, r_2)$ satisfies both causality and stability. No scientific flaws, contradictions, or ambiguities are present.\n\nStep 3: Verdict and Action\nThe problem is valid. A complete solution will be derived.\n\nSolution Derivation:\n\nThe impulse response $h[n]$ of the LTI system is the inverse $z$-transform of its system function $H(z)$. To find $h[n]$, we first decompose $H(z)$ into simpler terms using partial fraction expansion. The system function is given as:\n$$\nH(z) = \\frac{b_0 + b_1 z^{-1}}{\\left(1 - p_1 z^{-1}\\right)\\left(1 - p_2 z^{-1}\\right)}\n$$\nSince the poles $p_1$ and $p_2$ are distinct, we can express $H(z)$ as a sum of two first-order terms:\n$$\nH(z) = \\frac{C_1}{1 - p_1 z^{-1}} + \\frac{C_2}{1 - p_2 z^{-1}}\n$$\nThe coefficients $C_1$ and $C_2$ can be determined using the residue method (cover-up method).\nTo find $C_1$, we multiply $H(z)$ by $(1 - p_1 z^{-1})$ and evaluate at $z^{-1} = 1/p_1$:\n$$\nC_1 = \\left. \\left(1 - p_1 z^{-1}\\right) H(z) \\right|_{z^{-1}=1/p_1} = \\left. \\frac{b_0 + b_1 z^{-1}}{1 - p_2 z^{-1}} \\right|_{z^{-1}=1/p_1} = \\frac{b_0 + b_1/p_1}{1 - p_2/p_1}\n$$\nMultiplying the numerator and denominator by $p_1$ gives:\n$$\nC_1 = \\frac{p_1(b_0 + b_1/p_1)}{p_1(1 - p_2/p_1)} = \\fracb_0 p_1 + b_1}{p_1 - p_2}\n$$\nSimilarly, to find $C_2$, we multiply $H(z)$ by $(1 - p_2 z^{-1})$ and evaluate at $z^{-1} = 1/p_2$:\n$$\nC_2 = \\left. \\left(1 - p_2 z^{-1}\\right) H(z) \\right|_{z^{-1}=1/p_2} = \\left. \\frac{b_0 + b_1 z^{-1}}{1 - p_1 z^{-1}} \\right|_{z^{-1}=1/p_2} = \\frac{b_0 + b_1/p_2}{1 - p_1/p_2}\n$$\nMultiplying the numerator and denominator by $p_2$ gives:\n$$\nC_2 = \\frac{p_2(b_0 + b_1/p_2)}{p_2(1 - p_1/p_2)} = \\frac{b_0 p_2 + b_1}{p_2 - p_1}\n$$\nThus, the partial fraction expansion of $H(z)$ is:\n$$\nH(z) = \\left(\\frac{b_0 p_1 + b_1}{p_1 - p_2}\\right) \\frac{1}{1 - p_1 z^{-1}} + \\left(\\frac{b_0 p_2 + b_1}{p_2 - p_1}\\right) \\frac{1}{1 - p_2 z^{-1}}\n$$\nThe inverse $z$-transform is found by applying the known transform pair derived from the geometric series summation formula $\\sum_{n=0}^{\\infty} a^n = \\frac{1}{1-a}$ for $|a|<1$. For a causal signal, this leads to the pair:\n$$\na^n u[n] \\quad \\overset{\\mathcal{Z}}{\\longleftrightarrow} \\quad \\frac{1}{1 - a z^{-1}}, \\quad \\text{ROC: } |z| > |a|\n$$\nwhere $u[n]$ is the Heaviside unit step function. Since the system is causal and stable, with poles $|p_1| < 1$ and $|p_2| < 1$, we must use the right-sided sequences for the inverse transform of each term.\nApplying the inverse $z$-transform and using its linearity property, we obtain the impulse response $h[n]$:\n$$\nh[n] = \\mathcal{Z}^{-1}\\{H(z)\\} = C_1 p_1^n u[n] + C_2 p_2^n u[n]\n$$\nSubstituting the expressions for $C_1$ and $C_2$:\n$$\nh[n] = \\left(\\frac{b_0 p_1 + b_1}{p_1 - p_2}\\right) p_1^n u[n] + \\left(\\frac{b_0 p_2 + b_1}{p_2 - p_1}\\right) p_2^n u[n]\n$$\nThis expression can be combined into a single fraction to yield the closed-form expression for $h[n]$:\n$$\nh[n] = \\frac{1}{p_1 - p_2} \\left[ (b_0 p_1 + b_1) p_1^n - (b_0 p_2 + b_1) p_2^n \\right] u[n]\n$$\nThis completes the first part of the problem.\n\nAnalysis of Decay Characteristics:\n\nWe now analyze the conditions for monotonic versus oscillatory decay. The behavior of $h[n]$ is determined by the signs of the poles $p_1$ and $p_2$, which are specified by the parameters $s_1$ and $s_2$. The term $p_i^n$ can be written as $(s_i r_i)^n = s_i^n r_i^n$.\n\n- If $s_i = +1$, the pole $p_i = r_i$ is positive. The corresponding term in the impulse response is $C_i r_i^n u[n]$, which is a non-oscillatory, decaying exponential since $r_i \\in (0,1)$.\n- If $s_i = -1$, the pole $p_i = -r_i$ is negative. The corresponding term is $C_i (-r_i)^n u[n] = C_i (-1)^n r_i^n u[n]$. The factor $(-1)^n$ causes the term to alternate in sign for each increment of $n$, which is characteristic of oscillation.\n\nBased on this, we classify the behavior as follows:\n\n1.  Monotonic Decay: This behavior is characterized by a response that does not exhibit sustained sign changes. The impulse response $h[n]$ is a sum of non-oscillatory terms. This occurs if and only if both poles are positive.\n    Condition: $s_1 = +1$ and $s_2 = +1$.\n    In this case, $h[n] = (C_1 r_1^n + C_2 r_2^n) u[n]$. Although a single zero crossing is possible if $C_1$ and $C_2$ have opposite signs, the response lacks the persistent sign alternation that defines oscillation. The decay of the envelope is fundamentally monotonic.\n\n2.  Oscillatory Decay: This behavior is characterized by the presence of sign alternations in the response. This occurs if at least one of the poles is negative, as this introduces an oscillatory component of the form $(-1)^n$ into the impulse response.\n    Condition: $s_1 = -1$ or $s_2 = -1$.\n    If at least one pole is negative, $h[n]$ is a sum containing at least one term of the form $C_i (-1)^n r_i^n$. This component induces oscillations. The overall behavior will be oscillatory, though the specific pattern depends on the relative magnitudes and coefficients of the monotonic and oscillatory parts. The presence of a negative pole is the definitive condition for an oscillatory nature.\n\nThe derived closed-form expression for $h[n]$ is the final required answer.", "answer": "$$\n\\boxed{\\frac{1}{p_1 - p_2} \\left[ (b_0 p_1 + b_1) p_1^n - (b_0 p_2 + b_1) p_2^n \\right] u[n]}\n$$", "id": "2859316"}, {"introduction": "A key performance trade-off between FIR and IIR filters lies in their phase characteristics. Many applications require linear phase, which corresponds to a constant group delay, ensuring that all frequency components of a signal are delayed by the same amount. This practice [@problem_id:2859340] directly contrasts the ease with which FIR filters achieve this property against the inherent frequency-dependent group delay of a typical IIR filter, providing a quantitative look at the phase distortion introduced by IIR systems.", "problem": "Consider two causal, linear time-invariant discrete-time systems used in signal processing and systems modeling:\n\n1) A real-coefficient Finite Impulse Response (FIR) filter of length $N \\in \\mathbb{N}$ with symmetric impulse response $h[n] = h[N-1-n]$ supported on $n \\in \\{0,1,\\dots,N-1\\}$, so that the frequency response $H_{\\mathrm{FIR}}(\\mathrm{e}^{\\mathrm{j}\\omega})$ has linear phase.\n\n2) A real-coefficient second-order Infinite Impulse Response (IIR) filter with complex-conjugate poles strictly inside the unit circle at $p_{1,2} = r \\mathrm{e}^{\\pm \\mathrm{j}\\theta}$ with $0<r<1$ and $\\theta \\in (0,\\pi)$, and with unity numerator gain, so that the transfer function is\n$$\nH_{\\mathrm{IIR}}(z) \\;=\\; \\frac{1}{1 - 2 r \\cos(\\theta)\\, z^{-1} + r^2 z^{-2}} \\, .\n$$\n\nAngles $\\omega$ and $\\theta$ are to be treated in radians. The group delay $\\tau_g(\\omega)$ is defined from first principles as the negative derivative of the unwrapped phase $\\phi(\\omega)$ of the frequency response, namely\n$$\n\\tau_g(\\omega) \\;=\\; - \\frac{\\mathrm{d}\\phi(\\omega)}{\\mathrm{d}\\omega} \\, ,\n$$\nwhere $H(\\mathrm{e}^{\\mathrm{j}\\omega}) = |H(\\mathrm{e}^{\\mathrm{j}\\omega})| \\,\\mathrm{e}^{\\mathrm{j}\\phi(\\omega)}$.\n\nTasks:\n- Starting from the definition of group delay and basic properties of real, symmetric FIR filters, derive the expression of $\\tau_{g,\\mathrm{FIR}}(\\omega)$ for the filter in (1).\n- Starting from the definition of group delay and a pole-factorization of the denominator, derive $\\tau_{g,\\mathrm{IIR}}(\\omega)$ for the filter in (2) as an explicit function of $\\omega$, $r$, and $\\theta$, without invoking any pre-memorized “shortcut” delay formulas.\n- Then, to highlight frequency dependence, evaluate the IIR group delay at the pole angle by setting $\\omega=\\theta$, and form the difference\n$$\n\\Delta \\tau \\;\\triangleq\\; \\tau_{g,\\mathrm{IIR}}(\\omega=\\theta) \\;-\\; \\tau_{g,\\mathrm{FIR}}(\\omega) \\, .\n$$\n\nProvide a single closed-form analytic expression for $\\Delta \\tau$ in terms of $N$, $r$, and $\\theta$. No numerical evaluation or rounding is required. Do not include units in your final boxed answer.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. All parameters and definitions are standard in the field of digital signal processing. The problem is valid. We proceed with the derivation.\n\nFirst, we derive the group delay of the specified Finite Impulse Response (FIR) filter, $\\tau_{g,\\mathrm{FIR}}(\\omega)$.\nThe frequency response $H_{\\mathrm{FIR}}(\\mathrm{e}^{\\mathrm{j}\\omega})$ is the Discrete-Time Fourier Transform of the real and symmetric impulse response $h[n]$, where $h[n] = h[N-1-n]$ for $n \\in \\{0, 1, \\dots, N-1\\}$.\n$$ H_{\\mathrm{FIR}}(\\mathrm{e}^{\\mathrm{j}\\omega}) = \\sum_{n=0}^{N-1} h[n] \\mathrm{e}^{-\\mathrm{j}\\omega n} $$\nThis expression can be rewritten by factoring out a term corresponding to the midpoint of the filter, $\\frac{N-1}{2}$:\n$$ H_{\\mathrm{FIR}}(\\mathrm{e}^{\\mathrm{j}\\omega}) = \\mathrm{e}^{-\\mathrm{j}\\omega \\frac{N-1}{2}} \\sum_{n=0}^{N-1} h[n] \\mathrm{e}^{-\\mathrm{j}\\omega(n - \\frac{N-1}{2})} $$\nLet the summation term be denoted as $A(\\omega)$. We will show that $A(\\omega)$ is a real-valued function.\n$$ A(\\omega) = \\sum_{n=0}^{N-1} h[n] \\mathrm{e}^{-\\mathrm{j}\\omega(n - \\frac{N-1}{2})} $$\nThe complex conjugate of $A(\\omega)$ is:\n$$ A^*(\\omega) = \\left( \\sum_{n=0}^{N-1} h[n] \\mathrm{e}^{-\\mathrm{j}\\omega(n - \\frac{N-1}{2})} \\right)^* = \\sum_{n=0}^{N-1} h^*[n] \\mathrm{e}^{\\mathrm{j}\\omega(n - \\frac{N-1}{2})} $$\nSince the coefficients $h[n]$ are real, $h^*[n] = h[n]$.\n$$ A^*(\\omega) = \\sum_{n=0}^{N-1} h[n] \\mathrm{e}^{\\mathrm{j}\\omega(n - \\frac{N-1}{2})} $$\nNow, let us perform a change of variable in the summation for $A(\\omega)$, with $k=N-1-n$. As $n$ goes from $0$ to $N-1$, $k$ also goes from $N-1$ to $0$. We use the symmetry $h[n]=h[k]$.\n$$ A(\\omega) = \\sum_{k=0}^{N-1} h[k] \\mathrm{e}^{-\\mathrm{j}\\omega(N-1-k - \\frac{N-1}{2})} = \\sum_{k=0}^{N-1} h[k] \\mathrm{e}^{-\\mathrm{j}\\omega(\\frac{N-1}{2} - k)} = \\sum_{k=0}^{N-1} h[k] \\mathrm{e}^{\\mathrm{j}\\omega(k - \\frac{N-1}{2})} $$\nThis expression is identical to the one for $A^*(\\omega)$, therefore $A(\\omega)=A^*(\\omega)$, which proves $A(\\omega)$ is real.\nThe frequency response is $H_{\\mathrm{FIR}}(\\mathrm{e}^{\\mathrm{j}\\omega}) = A(\\omega) \\mathrm{e}^{-\\mathrm{j}\\omega \\frac{N-1}{2}}$.\nThe phase of $H_{\\mathrm{FIR}}(\\mathrm{e}^{\\mathrm{j}\\omega})$ is the phase of this expression. $A(\\omega)$ is real, so its phase is $0$ if $A(\\omega)>0$ and $\\pi$ if $A(\\omega)<0$. These jumps of $\\pi$ are ignored when considering the unwrapped phase for group delay computation. The phase is thus dominated by the linear term.\nThe unwrapped phase is therefore $\\phi_{\\mathrm{FIR}}(\\omega) = -\\omega \\frac{N-1}{2}$.\nThe group delay is defined as $\\tau_g(\\omega) = -\\frac{\\mathrm{d}\\phi(\\omega)}{\\mathrm{d}\\omega}$.\n$$ \\tau_{g,\\mathrm{FIR}}(\\omega) = -\\frac{\\mathrm{d}}{\\mathrm{d}\\omega} \\left(-\\omega \\frac{N-1}{2}\\right) = \\frac{N-1}{2} $$\nThe group delay of the FIR filter is constant.\n\nSecond, we derive the group delay of the specified Infinite Impulse Response (IIR) filter, $\\tau_{g,\\mathrm{IIR}}(\\omega)$.\nThe transfer function is $H_{\\mathrm{IIR}}(z) = \\frac{1}{1 - 2 r \\cos(\\theta)\\, z^{-1} + r^2 z^{-2}}$. The denominator polynomial $D(z)$ can be factored based on the poles $p_1 = r\\mathrm{e}^{\\mathrm{j}\\theta}$ and $p_2 = r\\mathrm{e}^{-\\mathrm{j}\\theta}$:\n$$ D(z) = (1 - p_1 z^{-1})(1 - p_2 z^{-1}) $$\nThus, $H_{\\mathrm{IIR}}(z) = H_1(z)H_2(z)$, where $H_k(z) = (1-p_k z^{-1})^{-1}$. The phase of $H_{\\mathrm{IIR}}$ is the sum of the phases of $H_1$ and $H_2$. Consequently, the total group delay is the sum of the group delays of the individual first-order sections.\nLet us derive the group delay for a generic first-order section with a single pole at $p = r_p \\mathrm{e}^{\\mathrm{j}\\theta_p}$:\n$H(\\mathrm{e}^{\\mathrm{j}\\omega}) = (1 - p \\mathrm{e}^{-\\mathrm{j}\\omega})^{-1}$.\nThe phase is $\\phi(\\omega) = -\\arg(1 - p \\mathrm{e}^{-\\mathrm{j}\\omega}) = -\\arg(1 - r_p \\mathrm{e}^{\\mathrm{j}(\\theta_p-\\omega)})$.\nLet the complex number be $C = 1 - r_p\\cos(\\theta_p-\\omega) - \\mathrm{j}r_p\\sin(\\theta_p-\\omega)$.\n$\\phi(\\omega) = -\\arctan\\left(\\frac{-r_p\\sin(\\theta_p-\\omega)}{1 - r_p\\cos(\\theta_p-\\omega)}\\right) = \\arctan\\left(\\frac{r_p\\sin(\\theta_p-\\omega)}{1 - r_p\\cos(\\theta_p-\\omega)}\\right)$.\nLet $u = \\theta_p - \\omega$, so $\\frac{\\mathrm{d}u}{\\mathrm{d}\\omega} = -1$.\n$\\phi(\\omega) = \\arctan\\left(\\frac{r_p\\sin u}{1-r_p\\cos u}\\right)$.\nThe derivative is $\\frac{\\mathrm{d}\\phi}{\\mathrm{d}\\omega} = \\frac{\\mathrm{d}\\phi}{\\mathrm{d}u}\\frac{\\mathrm{d}u}{\\mathrm{d}\\omega} = -\\frac{\\mathrm{d}}{\\mathrm{d}u}\\arctan\\left(\\frac{r_p\\sin u}{1-r_p\\cos u}\\right)$.\n$$ \\frac{\\mathrm{d}\\phi}{\\mathrm{d}u} = \\frac{1}{1 + \\left(\\frac{r_p\\sin u}{1-r_p\\cos u}\\right)^2} \\frac{r_p\\cos u(1-r_p\\cos u) - r_p\\sin u(r_p\\sin u)}{(1-r_p\\cos u)^2} $$\n$$ = \\frac{(1-r_p\\cos u)^2}{(1-r_p\\cos u)^2 + r_p^2\\sin^2 u} \\frac{r_p\\cos u - r_p^2}{(1-r_p\\cos u)^2} $$\n$$ = \\frac{r_p\\cos u - r_p^2}{1-2r_p\\cos u + r_p^2\\cos^2 u + r_p^2\\sin^2 u} = \\frac{r_p\\cos u - r_p^2}{1-2r_p\\cos u + r_p^2} $$\nThe group delay for this section is $\\tau_g(\\omega) = -\\frac{\\mathrm{d}\\phi}{\\mathrm{d}\\omega} = -(-\\frac{\\mathrm{d}\\phi}{\\mathrm{d}u}) = \\frac{\\mathrm{d}\\phi}{\\mathrm{d}u} = \\frac{r_p\\cos(\\theta_p-\\omega) - r_p^2}{1-2r_p\\cos(\\theta_p-\\omega) + r_p^2}$.\n\nThe total IIR group delay is the sum of delays for poles $p_1$ ($r_p=r, \\theta_p=\\theta$) and $p_2$ ($r_p=r, \\theta_p=-\\theta$):\n$$ \\tau_{g,\\mathrm{IIR}}(\\omega) = \\frac{r\\cos(\\theta-\\omega) - r^2}{1-2r\\cos(\\theta-\\omega) + r^2} + \\frac{r\\cos(-\\theta-\\omega) - r^2}{1-2r\\cos(-\\theta-\\omega) + r^2} $$\nUsing $\\cos(-x)=\\cos(x)$, we have the general expression for the IIR group delay:\n$$ \\tau_{g,\\mathrm{IIR}}(\\omega) = \\frac{r\\cos(\\theta-\\omega) - r^2}{1-2r\\cos(\\theta-\\omega) + r^2} + \\frac{r\\cos(\\theta+\\omega) - r^2}{1-2r\\cos(\\theta+\\omega) + r^2} $$\n\nThird, we evaluate the IIR group delay at $\\omega=\\theta$.\nThe first term becomes:\n$$ \\frac{r\\cos(\\theta-\\theta) - r^2}{1-2r\\cos(\\theta-\\theta) + r^2} = \\frac{r\\cos(0) - r^2}{1-2r\\cos(0) + r^2} = \\frac{r-r^2}{1-2r+r^2} = \\frac{r(1-r)}{(1-r)^2} = \\frac{r}{1-r} $$\nThe second term becomes:\n$$ \\frac{r\\cos(\\theta+\\theta) - r^2}{1-2r\\cos(\\theta+\\theta) + r^2} = \\frac{r\\cos(2\\theta) - r^2}{1 - 2r\\cos(2\\theta) + r^2} $$\nThe sum gives the IIR group delay at the specified frequency:\n$$ \\tau_{g,\\mathrm{IIR}}(\\omega=\\theta) = \\frac{r}{1-r} + \\frac{r\\cos(2\\theta) - r^2}{1 - 2r\\cos(2\\theta) + r^2} $$\n\nFinally, we compute the difference $\\Delta \\tau = \\tau_{g,\\mathrm{IIR}}(\\omega=\\theta) - \\tau_{g,\\mathrm{FIR}}(\\omega)$.\nThe FIR group delay is constant and equal to $\\frac{N-1}{2}$.\n$$ \\Delta \\tau = \\frac{r}{1-r} + \\frac{r\\cos(2\\theta) - r^2}{1 - 2r\\cos(2\\theta) + r^2} - \\frac{N-1}{2} $$\nThis is the final closed-form expression in terms of the given parameters $N$, $r$, and $\\theta$.", "answer": "$$\n\\boxed{\\frac{r}{1-r} + \\frac{r\\cos(2\\theta) - r^2}{1 - 2r\\cos(2theta) + r^2} - \\frac{N-1}{2}}\n$$", "id": "2859340"}, {"introduction": "Perhaps the most critical consideration in choosing between an IIR and an FIR filter is stability. Due to their non-recursive structure, FIR filters are always stable, whereas the feedback mechanism in IIR filters creates a potential for instability. This exercise [@problem_id:2859321] quantifies the stability margin of an IIR filter by calculating the minimum coefficient perturbation that would render it unstable, highlighting a fundamental vulnerability that designers must manage and contrasting it with the inherent robustness of FIR filters.", "problem": "Consider the discrete-time linear time-invariant system with transfer function\n$$H(z)=\\frac{1+0.5\\,z^{-1}}{1-1.2\\,z^{-1}+0.36\\,z^{-2}}.$$\nUse first principles to decide stability of the infinite impulse response (IIR) filter by locating its poles via the denominator polynomial in the complex $z$-plane, and interpret stability in terms of pole radii. Then, model coefficient uncertainty in the IIR denominator by perturbing the forward polynomial\n$$A(z)=z^{2}+a_{1}z+a_{0},$$\nwith nominal values $a_{1}=-1.2$ and $a_{0}=0.36$, by an additive vector perturbation $\\Delta=\\begin{pmatrix}\\Delta a_{1}\\\\ \\Delta a_{0}\\end{pmatrix}$. Using the discrete-time Schur stability boundary (unit-circle boundary) characterized for second-order polynomials by equality in the Jury conditions, determine the smallest Euclidean norm $\\|\\Delta\\|_{2}$ of a perturbation that renders the IIR filter marginally stable (i.e., places a pole on $|z|=1$). Provide this smallest norm as an exact value.\n\nIn your reasoning, contrast the sensitivity of this IIR filter’s stability to denominator coefficient perturbations with that of a finite impulse response (FIR) filter that shares the same numerator,\n$$H_{\\mathrm{FIR}}(z)=1+0.5\\,z^{-1},$$\nnoting why the FIR filter’s stability is unaffected by such perturbations. Your final answer must be a single real number or a single closed-form analytic expression, without units. Do not round; give the exact value.", "solution": "The problem statement has been subjected to rigorous validation and is determined to be valid. It is scientifically grounded in the principles of digital signal processing, well-posed, and objective. We shall proceed with a complete solution.\n\nThe analysis begins with the infinite impulse response (IIR) filter defined by the transfer function:\n$$H(z)=\\frac{1+0.5\\,z^{-1}}{1-1.2\\,z^{-1}+0.36\\,z^{-2}}$$\nThe stability of a linear time-invariant (LTI) system is determined by the location of the poles of its transfer function in the complex $z$-plane. Poles are the roots of the denominator polynomial. Setting the denominator to zero gives:\n$$1-1.2\\,z^{-1}+0.36\\,z^{-2} = 0$$\nTo find the poles, we multiply by $z^2$ to obtain the characteristic polynomial in positive powers of $z$:\n$$z^{2}-1.2\\,z+0.36 = 0$$\nThis is a perfect square:\n$$(z-0.6)^{2} = 0$$\nThe system has a double pole at $z=0.6$. For a discrete-time system to be stable, all its poles must lie strictly inside the unit circle, i.e., their magnitudes must be less than $1$. The magnitude of the pole is $|0.6|=0.6$, which is less than $1$. Therefore, the nominal IIR filter is stable.\n\nNext, we analyze the filter's stability under coefficient perturbation. The denominator is represented by the forward polynomial $A(z)=z^{2}+a_{1}z+a_{0}$, with nominal coefficients $a_{1}=-1.2$ and $a_{0}=0.36$. A perturbation $\\Delta=\\begin{pmatrix}\\Delta a_{1} & \\Delta a_{0}\\end{pmatrix}^{T}$ is introduced, resulting in the perturbed polynomial $A_p(z)=z^{2}+(a_{1}+\\Delta a_{1})z+(a_{0}+\\Delta a_{0})$. Let the perturbed coefficients be $a'_{1}=a_{1}+\\Delta a_{1}$ and $a'_{0}=a_{0}+\\Delta a_{0}$.\n\nFor a second-order polynomial $P(z)=z^{2}+c_{1}z+c_{0}$ to have all its roots inside the unit circle, the Jury stability conditions must be satisfied:\n$1.$ $P(1) > 0 \\implies 1+c_{1}+c_{0} > 0$\n$2.$ $P(-1) > 0 \\implies 1-c_{1}+c_{0} > 0$\n$3.$ $|c_{0}| < 1$\n\nThe filter becomes marginally stable when one of these inequalities becomes an equality. This defines the stability boundary in the coefficient space $(c_1, c_0)$.\nThe boundaries are:\n$1.$ $1+c_{1}+c_{0} = 0$, which corresponds to a pole at $z=1$.\n$2.$ $1-c_{1}+c_{0} = 0$, which corresponds to a pole at $z=-1$.\n$3.$ $c_{0} = 1$ (for $|c_1| \\leq 2$), which corresponds to a pair of complex conjugate poles on the unit circle.\n$4.$ $c_{0} = -1$, which corresponds to marginal stability, but we will find it is not the closest boundary.\n\nThe problem is to find the minimum Euclidean norm of the perturbation vector, $\\|\\Delta\\|_{2}=\\sqrt{(\\Delta a_{1})^{2}+(\\Delta a_{0})^{2}}$, that moves the nominal coefficient point $(a_{1}, a_{0}) = (-1.2, 0.36)$ onto one of these boundaries. This is equivalent to finding the minimum geometric distance from the point $P_{\\mathrm{nom}}=(-1.2, 0.36)$ to the stability boundary defined by the set of lines:\n$L_1: a'_{0} = -a'_{1}-1$\n$L_2: a'_{0} = a'_{1}-1$\n$L_3: a'_{0} = 1$\n\nWe calculate the distance from the point $(x_0, y_0) = (-1.2, 0.36)$ to each of these lines. The distance from a point $(x_0, y_0)$ to a line $Ax+By+C=0$ is given by $d = \\frac{|Ax_{0}+By_{0}+C|}{\\sqrt{A^{2}+B^{2}}}$.\n\nDistance to $L_1$ ($a'_{1}+a'_{0}+1=0$):\n$$d_1 = \\frac{|(-1.2) + (0.36) + 1|}{\\sqrt{1^{2}+1^{2}}} = \\frac{|0.16|}{\\sqrt{2}} = \\frac{0.16}{\\sqrt{2}}$$\n\nDistance to $L_2$ ($a'_{1}-a'_{0}-1=0$):\n$$d_2 = \\frac{|(-1.2) - (0.36) - 1|}{\\sqrt{1^{2}+(-1)^{2}}} = \\frac{|-2.56|}{\\sqrt{2}} = \\frac{2.56}{\\sqrt{2}}$$\n\nDistance to $L_3$ ($a'_{0}-1=0$):\n$$d_3 = \\frac{|(0.36) - 1|}{\\sqrt{0^{2}+1^{2}}} = |-0.64| = 0.64$$\nThe contact point on this line would be $(-1.2, 1)$, which satisfies the constraint $|a'_1|=|-1.2| \\leq 2$.\n\nComparing the three distances:\n$d_1 = \\frac{0.16}{\\sqrt{2}} \\approx \\frac{0.16}{1.414} \\approx 0.113$\n$d_2 = \\frac{2.56}{\\sqrt{2}} \\approx \\frac{2.56}{1.414} \\approx 1.810$\n$d_3 = 0.64$\n\nThe smallest distance is $d_1$. We provide this smallest norm as an exact value.\nThe nominal coefficients are $a_{1}=-1.2 = -\\frac{6}{5}$ and $a_{0}=0.36 = \\frac{9}{25}$.\nThe line $L_1$ is $a'_{1}+a'_{0}+1=0$. The distance is:\n$$\\|\\Delta\\|_{2, \\min} = \\frac{|-\\frac{6}{5} + \\frac{9}{25} + 1|}{\\sqrt{2}} = \\frac{|-\\frac{30}{25} + \\frac{9}{25} + \\frac{25}{25}|}{\\sqrt{2}} = \\frac{|\\frac{4}{25}|}{\\sqrt{2}} = \\frac{4}{25\\sqrt{2}} = \\frac{2\\sqrt{2}}{25}$$\n\nFinally, we contrast this sensitivity with the case of a finite impulse response (FIR) filter, $H_{\\mathrm{FIR}}(z)=1+0.5\\,z^{-1}$. An FIR filter of length $N$ has a transfer function of the form:\n$$H(z) = \\sum_{k=0}^{N-1} b_k z^{-k}$$\nThis can be written as a rational function by multiplying the numerator and denominator by $z^{N-1}$:\n$$H(z) = \\frac{\\sum_{k=0}^{N-1} b_k z^{N-1-k}}{z^{N-1}}$$\nThe denominator is $z^{N-1}$, which means there are $N-1$ poles, all located at the origin of the $z$-plane ($z=0$). Since $|0| < 1$, all poles are strictly inside the unit circle, regardless of the values of the filter coefficients $b_k$. Consequently, a causal FIR filter is always stable. Coefficient perturbations, such as those arising from quantization, affect the numerator polynomial, thereby changing the locations of the filter's zeros, but not its poles. As stability is solely a function of pole locations, the stability of an FIR filter is inherently guaranteed by its structure and is completely insensitive to perturbations in its coefficients. This is a fundamental advantage of FIR filters over IIR filters, the latter of which can become unstable due to small coefficient variations, as demonstrated by our calculation.", "answer": "$$\\boxed{\\frac{2\\sqrt{2}}{25}}$$", "id": "2859321"}]}