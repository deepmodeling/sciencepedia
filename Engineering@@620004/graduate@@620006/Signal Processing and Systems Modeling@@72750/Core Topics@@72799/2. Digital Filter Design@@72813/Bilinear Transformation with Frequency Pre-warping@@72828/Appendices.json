{"hands_on_practices": [{"introduction": "To master the bilinear transform, we must first understand the \"why\" behind its mechanics. This exercise explores the fundamental non-linear relationship between the analog frequency $\\Omega$ and the digital frequency $\\omega$, which is the source of frequency warping. By analyzing the properties of the mapping function, you will understand why we can perfectly match specific frequencies using pre-warping, yet the frequency response between these points remains non-linearly distorted [@problem_id:2854927]. This conceptual problem builds a solid intuition for *why* pre-warping is both necessary and effective, moving beyond simple formula application to a deeper grasp of the transform's properties.", "problem": "A continuous-time analog prototype filter is to be mapped to a discrete-time digital filter by the bilinear transform (BLT). Let the bilinear transform be defined by the mapping between the Laplace variable $s$ and the $z$-transform variable $z$ as $s = \\dfrac{2}{T}\\,\\dfrac{1 - z^{-1}}{1 + z^{-1}}$, where $T > 0$ is the sampling period. Frequency response evaluation is performed on the imaginary axis and unit circle by setting $s = j\\Omega$ for continuous time and $z = e^{j\\omega}$ for discrete time, where $\\Omega$ is continuous-time radian frequency (radians per second) and $\\omega$ is discrete-time normalized radian frequency (radians per sample). Suppose a digital specification requires exact matching of $2$ distinct digital edge frequencies $\\omega_{1}$ and $\\omega_{2}$ (for example, the lower and upper passband edges of a bandpass). The common practice called frequency pre-warping chooses separate analog edge frequencies $\\Omega_{1}^{\\star}$ and $\\Omega_{2}^{\\star}$ for the prototype so that, after the bilinear transform, the digital filter has edges exactly at $\\omega_{1}$ and $\\omega_{2}$.\n\nWhich statement best explains, from first principles of the bilinear transform and the frequency-response evaluation mappings $s = j\\Omega$ and $z = e^{j\\omega}$, why exact pre-warping at the $2$ specified digital frequencies is possible by choosing separate analog pre-warped edges, yet the overall mapping between analog and digital frequency remains nonlinear between these edges?\n\nA. The mapping from $j\\Omega$ to $e^{j\\omega}$ induced by the bilinear transform is a one-to-one, strictly monotone bijection of the imaginary axis onto the unit circle under frequency evaluation, so the inverse mapping exists pointwise; thus one can select $\\Omega_{k}^{\\star}$ independently to hit each prescribed $\\omega_{k}$ exactly. However, the relationship $\\Omega(\\omega)$ is a nonlinear function of $\\omega$, so fixing finitely many points does not linearize the map over intervals; consequently, the spacing between frequencies is warped nonlinearly between $\\omega_{1}$ and $\\omega_{2}$.\n\nB. The bilinear transform is affine in frequency, hence linear in $\\omega$; matching any $2$ points forces the entire map between them to be linear, so the spacing between $\\omega_{1}$ and $\\omega_{2}$ is preserved without warping.\n\nC. Exact pre-warping at $2$ frequencies requires using two different sampling periods $T$ simultaneously, one per edge; this yields exactness at $\\omega_{1}$ and $\\omega_{2}$, and the mapping between them is then linear because each segment uses its own $T$.\n\nD. Because the bilinear transform is conformal, it preserves frequency spacing on the imaginary axis; therefore, once the edges are pre-warped to match $\\omega_{1}$ and $\\omega_{2}$, all intermediate frequencies are mapped with proportional spacing, implying linearity between the edges.\n\nE. Pre-warping forces the group delay to be equal at the two edges, and equal group delay implies a constant phase slope, which makes the frequency mapping linear between $\\omega_{1}$ and $\\omega_{2}$.", "solution": "The problem statement will first be subjected to rigorous validation.\n\nStep 1: Extract Givens\n- The bilinear transform mapping is given as $s = \\dfrac{2}{T}\\,\\dfrac{1 - z^{-1}}{1 + z^{-1}}$.\n- The sampling period is $T > 0$.\n- Frequency response evaluation is performed by setting $s = j\\Omega$ for the continuous-time system and $z = e^{j\\omega}$ for the discrete-time system.\n- $\\Omega$ is the continuous-time radian frequency.\n- $\\omega$ is the discrete-time normalized radian frequency.\n- A design requirement is to have exact matching at $2$ distinct digital frequencies, $\\omega_{1}$ and $\\omega_{2}$.\n- This is achieved by frequency pre-warping, which involves choosing corresponding analog frequencies $\\Omega_{1}^{\\star}$ and $\\Omega_{2}^{\\star}$.\n- The question asks for an explanation from first principles as to why this exact matching at two points is possible, while the frequency mapping between these points remains nonlinear.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. The bilinear transform and the concept of frequency pre-warping are standard, foundational topics in digital signal processing. All definitions and equations provided are correct and standard in the literature. The problem is well-posed; it asks for a conceptual explanation that can be derived directly from the provided mathematical relationships. The language is objective and precise. The problem is self-contained and does not contain any contradictions or ambiguities. It requires an understanding of the mathematical properties of the frequency mapping inherent in the bilinear transform.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be derived.\n\nThe core of this problem lies in the relationship between the continuous-time frequency $\\Omega$ and the discrete-time frequency $\\omega$ as established by the bilinear transform. We begin with the definition of the transform:\n$$s = \\dfrac{2}{T}\\,\\dfrac{1 - z^{-1}}{1 + z^{-1}}$$\nTo find the frequency mapping, we substitute the expressions for frequency response evaluation, $s = j\\Omega$ and $z = e^{j\\omega}$:\n$$j\\Omega = \\dfrac{2}{T}\\,\\dfrac{1 - e^{-j\\omega}}{1 + e^{-j\\omega}}$$\nTo simplify the right-hand side, we utilize a standard identity. We can factor out $e^{-j\\omega/2}$ from both the numerator and the denominator, or equivalently, multiply the numerator and denominator by $e^{j\\omega/2}$:\n$$j\\Omega = \\dfrac{2}{T}\\,\\dfrac{e^{j\\omega/2}(1 - e^{-j\\omega})}{e^{j\\omega/2}(1 + e^{-j\\omega})} = \\dfrac{2}{T}\\,\\dfrac{e^{j\\omega/2} - e^{-j\\omega/2}}{e^{j\\omega/2} + e^{-j\\omega/2}}$$\nUsing Euler's identities, we recognize the expressions for sine and cosine:\n$$e^{j\\theta} - e^{-j\\theta} = 2j\\sin(\\theta)$$\n$$e^{j\\theta} + e^{-j\\theta} = 2\\cos(\\theta)$$\nApplying these with $\\theta = \\omega/2$, the equation becomes:\n$$j\\Omega = \\dfrac{2}{T}\\,\\dfrac{2j\\sin(\\omega/2)}{2\\cos(\\omega/2)}$$\nSimplifying this expression yields:\n$$j\\Omega = \\dfrac{2}{T}\\,j\\tan\\left(\\dfrac{\\omega}{2}\\right)$$\nWe cancel the imaginary unit $j$ from both sides to obtain the frequency warping relationship:\n$$\\Omega = \\dfrac{2}{T}\\tan\\left(\\dfrac{\\omega}{2}\\right)$$\nThis equation explicitly defines the continuous-time frequency $\\Omega$ as a function of the discrete-time frequency $\\omega$. Let us analyze this function, $\\Omega(\\omega)$.\n\nThe domain for the unique range of discrete-time frequencies is typically $\\omega \\in (-\\pi, \\pi)$. In this interval, the argument of the tangent function, $\\omega/2$, lies in $(-\\pi/2, \\pi/2)$. The function $\\tan(x)$ is strictly monotone increasing on $(-\\pi/2, \\pi/2)$. Consequently, the function $\\Omega(\\omega)$ is also strictly monotone increasing for $\\omega \\in (-\\pi, \\pi)$. A strictly monotone function is, by definition, one-to-one (injective). The range of $\\Omega$ as $\\omega$ spans $(-\\pi, \\pi)$ is $(-\\infty, \\infty)$. Therefore, the mapping from $\\omega \\in (-\\pi, \\pi)$ to $\\Omega \\in (-\\infty, \\infty)$ is a bijection.\n\nThe existence of a bijection means that for every unique digital frequency $\\omega_{k}$, there exists a single, unique corresponding analog frequency $\\Omega_{k}$. The procedure of pre-warping involves using this relationship in reverse. Given a desired critical frequency $\\omega_{k}$ for the final digital filter, one calculates the required analog frequency $\\Omega_{k}^{\\star}$ for the prototype filter design using this formula:\n$$\\Omega_{k}^{\\star} = \\dfrac{2}{T}\\tan\\left(\\dfrac{\\omega_{k}}{2}\\right)$$\nSince this calculation can be performed for any given $\\omega_{k}$, it is certainly possible to perform it for two distinct frequencies, $\\omega_{1}$ and $\\omega_{2}$. We simply compute:\n$$\\Omega_{1}^{\\star} = \\dfrac{2}{T}\\tan\\left(\\dfrac{\\omega_{1}}{2}\\right)$$\n$$\\Omega_{2}^{\\star} = \\dfrac{2}{T}\\tan\\left(\\dfrac{\\omega_{2}}{2}\\right)$$\nBy designing an analog prototype filter with these exact edge frequencies $\\Omega_{1}^{\\star}$ and $\\Omega_{2}^{\\star}$, the subsequent application of the bilinear transform guarantees that the resulting digital filter will have its edges exactly at $\\omega_{1}$ and $\\omega_{2}$. This explains why exact matching at a finite number of points is possible.\n\nNow, we must address the second part of the question: why the mapping *between* these points remains nonlinear. The relationship is $\\Omega(\\omega) = \\frac{2}{T}\\tan(\\frac{\\omega}{2})$. A linear relationship would have the form $\\Omega(\\omega) = c_{1}\\omega + c_{0}$ for some constants $c_{1}$ and $c_{0}$. The tangent function is fundamentally nonlinear. Its graph is a curve, not a straight line. Forcing the mapping to pass through two specific points, $(\\omega_{1}, \\Omega_{1}^{\\star})$ and $(\\omega_{2}, \\Omega_{2}^{\\star})$, does not alter the intrinsic nonlinear nature of the tangent function itself. The frequency \"axis\" is stretched and compressed non-uniformly. This is precisely what is meant by \"warping\". For example, the midpoint frequency $\\omega_{m} = (\\omega_{1}+\\omega_{2})/2$ in the digital domain will not map to the midpoint frequency $\\Omega_{m} = (\\Omega_{1}^{\\star}+\\Omega_{2}^{\\star})/2$ in the analog domain. In general, $\\frac{2}{T}\\tan(\\frac{\\omega_{1}+\\omega_{2}}{4}) \\neq \\frac{1}{2}\\left(\\frac{2}{T}\\tan(\\frac{\\omega_{1}}{2}) + \\frac{2}{T}\\tan(\\frac{\\omega_{2}}{2})\\right)$.\n\nWe will now evaluate each option based on this derivation.\n\nA. This option states the mapping is a \"one-to-one, strictly monotone bijection\" of the frequency axes, which our derivation confirms. It correctly argues that the existence of an inverse mapping allows for pointwise selection of $\\Omega_{k}^{\\star}$ to match any $\\omega_{k}$. It then states that the relationship $\\Omega(\\omega)$ is nonlinear, which is true due to the tangent function. Finally, it concludes that fixing points does not linearize the map and that spacing is warped nonlinearly. This statement is entirely consistent with our derivation from first principles.\n**Verdict: Correct.**\n\nB. This option claims the bilinear transform is \"affine in frequency, hence linear in $\\omega$\". This is fundamentally false. The frequency mapping is $\\Omega = \\frac{2}{T}\\tan(\\frac{\\omega}{2})$, which is a nonlinear tangent function, not an affine one ($ax+b$). The assertion that matching $2$ points forces linearity is a grave mathematical error.\n**Verdict: Incorrect.**\n\nC. This option suggests using \"two different sampling periods $T$ simultaneously\". The bilinear transform is defined with a single sampling period $T$ for the entire system. Introducing multiple values of $T$ would be an entirely different, inconsistent transformation, not the bilinear transform. The pre-warping formula uses the same $T$ for all frequencies.\n**Verdict: Incorrect.**\n\nD. This option invokes the property that the bilinear transform is a \"conformal\" map. While true, the conclusion drawn is wrong. A conformal map preserves angles locally, but it does not in general preserve distances or spacing. The statement that it \"preserves frequency spacing\" and implies \"proportional spacing\" and \"linearity\" is the exact opposite of the warping effect described by $\\Omega \\propto \\tan(\\omega/2)$.\n**Verdict: Incorrect.**\n\nE. This option incorrectly links pre-warping to group delay. Pre-warping is a procedure to align frequency points, not to manipulate the phase or group delay characteristics of the filter in this manner. The claim that equal group delay implies a linear frequency mapping confuses two separate concepts: linear phase response of a filter (constant group delay) and the linear mapping of one frequency axis to another.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2854927"}, {"introduction": "With the conceptual foundation in place, this practice guides you through a complete, A-to-Z design workflow [@problem_id:2854942]. Starting with a common specification for a digital filter—a desired $-3$ dB cutoff frequency—you will use the pre-warping technique to define the necessary parameters of an analog prototype filter. By then applying the bilinear transform, you will derive the final difference equation, which is the direct implementation of the digital filter, bridging the gap between theory and practice.", "problem": "You are tasked with designing a discrete-time realization for an analog first-order low-pass system specified by the transfer function $H(s)=\\frac{1}{\\tau s+1}$ using the bilinear transform with frequency pre-warping. Your design requirement is that the $-3$ dB (half-power) frequency of the discrete-time filter should occur at the digital radian frequency $\\omega_{d}=\\frac{\\pi}{2}$, with a sampling period $T=0.001$ s. Work from first principles: use the defining property of the half-power frequency for a first-order low-pass analog system, and the canonical frequency mapping underlying the bilinear transform, together with the pre-warping condition that aligns the analog and digital $-3$ dB frequencies.\n\nConstruct the $z$-domain difference equation for the resulting digital filter in the normalized form $y[n]+a_{1}y[n-1]=b_{0}x[n]+b_{1}x[n-1]$. Your final answer must be the numerical coefficients as a row matrix $[b_{0}\\ b_{1}\\ a_{1}]$ with no units. Angles must be treated in radians. No rounding is necessary for this problem.", "solution": "The problem statement is evaluated and found to be valid. It is scientifically grounded in the principles of digital signal processing, well-posed with all necessary information provided, and objective in its formulation. No inconsistencies, ambiguities, or factual errors are present. We proceed with the solution.\n\nThe task is to design a discrete-time filter from an analog prototype $H(s)=\\frac{1}{\\tau s+1}$ using the bilinear transform with frequency pre-warping. The specifications are a sampling period $T=0.001$ s and a requirement that the discrete-time filter's $-3$ dB frequency matches the digital radian frequency $\\omega_{d}=\\frac{\\pi}{2}$.\n\nFirst, we analyze the analog prototype filter from first principles. The analog transfer function is $H(s) = \\frac{1}{\\tau s + 1}$. Its frequency response is obtained by the substitution $s = j\\omega_a$, where $\\omega_a$ is the analog radian frequency:\n$$H(j\\omega_a) = \\frac{1}{j\\omega_a \\tau + 1}$$\nThe magnitude-squared response is given by:\n$$|H(j\\omega_a)|^2 = H(j\\omega_a)H(-j\\omega_a) = \\frac{1}{(1 + j\\omega_a \\tau)(1 - j\\omega_a \\tau)} = \\frac{1}{1 + (\\omega_a \\tau)^2}$$\nThe $-3$ dB, or half-power, frequency $\\omega_c$ is defined as the frequency at which the magnitude-squared response is half its value at DC ($\\omega_a=0$). The DC gain is $|H(j0)| = 1$, so the DC power is $1^2 = 1$. Thus, at $\\omega_a = \\omega_c$:\n$$|H(j\\omega_c)|^2 = \\frac{1}{2}$$\nSubstituting this into the magnitude-squared expression:\n$$\\frac{1}{1 + (\\omega_c \\tau)^2} = \\frac{1}{2}$$\nThis yields $1 + (\\omega_c \\tau)^2 = 2$, which simplifies to $(\\omega_c \\tau)^2 = 1$. As both $\\omega_c$ and $\\tau$ are positive physical quantities, we find the fundamental relationship for the cutoff frequency of this analog filter:\n$$\\omega_c = \\frac{1}{\\tau}$$\nNext, we consider the frequency mapping property of the bilinear transform. The transform is defined by the substitution $s \\leftarrow \\frac{2}{T} \\frac{1-z^{-1}}{1+z^{-1}}$. This maps the imaginary axis $s=j\\omega_a$ of the $s$-plane to the unit circle $z=e^{j\\omega_d}$ of the $z$-plane, where $\\omega_d$ is the normalized digital radian frequency. The relationship between the frequencies is:\n$$\\omega_a = \\frac{2}{T} \\tan\\left(\\frac{\\omega_d}{2}\\right)$$\nThis non-linear relationship is known as frequency warping. To ensure the digital filter has its cutoff frequency at the desired location $\\omega_d = \\frac{\\pi}{2}$, we must pre-warp the analog filter's cutoff frequency $\\omega_c$ so that it maps to this specific digital frequency. We set:\n$$\\omega_c = \\frac{2}{T} \\tan\\left(\\frac{\\omega_d}{2}\\right) \\bigg|_{\\omega_d=\\frac{\\pi}{2}} = \\frac{2}{T} \\tan\\left(\\frac{\\pi/2}{2}\\right) = \\frac{2}{T} \\tan\\left(\\frac{\\pi}{4}\\right)$$\nSince $\\tan(\\frac{\\pi}{4}) = 1$, the required analog cutoff frequency is:\n$$\\omega_c = \\frac{2}{T}$$\nGiven $T = 0.001$ s, we calculate $\\omega_c$:\n$$\\omega_c = \\frac{2}{0.001} = 2000\\ \\text{rad/s}$$\nNow we can determine the required time constant $\\tau$ for the analog prototype:\n$$\\tau = \\frac{1}{\\omega_c} = \\frac{1}{2000}\\ \\text{s}$$\nWith the analog filter parameter determined, we perform the bilinear transformation on $H(s)$:\n$$H(z) = H(s)\\bigg|_{s=\\frac{2}{T}\\frac{1-z^{-1}}{1+z^{-1}}} = \\frac{1}{\\tau \\left(\\frac{2}{T}\\frac{1-z^{-1}}{1+z^{-1}}\\right) + 1}$$\nTo simplify, we evaluate the dimensionless product $\\frac{2\\tau}{T}$:\n$$\\frac{2\\tau}{T} = \\frac{2 \\cdot (1/2000)}{0.001} = \\frac{1/1000}{1/1000} = 1$$\nSubstituting this value back into the expression for $H(z)$:\n$$H(z) = \\frac{1}{1 \\cdot \\left(\\frac{1-z^{-1}}{1+z^{-1}}\\right) + 1} = \\frac{1+z^{-1}}{(1-z^{-1})+(1+z^{-1})} = \\frac{1+z^{-1}}{2}$$\nSo, the transfer function of the resulting digital filter is:\n$$H(z) = \\frac{1}{2} + \\frac{1}{2}z^{-1}$$\nThe transfer function relates the Z-transforms of the output $y[n]$ and input $x[n]$ as $H(z) = \\frac{Y(z)}{X(z)}$. Thus:\n$$Y(z) = \\left(\\frac{1}{2} + \\frac{1}{2}z^{-1}\\right)X(z) = \\frac{1}{2}X(z) + \\frac{1}{2}z^{-1}X(z)$$\nApplying the inverse Z-transform yields the difference equation:\n$$y[n] = \\frac{1}{2}x[n] + \\frac{1}{2}x[n-1]$$\nWe must express this in the normalized form $y[n]+a_{1}y[n-1]=b_{0}x[n]+b_{1}x[n-1]$. By rearranging our derived equation, we get:\n$$y[n] + 0 \\cdot y[n-1] = \\frac{1}{2}x[n] + \\frac{1}{2}x[n-1]$$\nBy comparing the two forms, we identify the coefficients as:\n$$b_0 = \\frac{1}{2}$$\n$$b_1 = \\frac{1}{2}$$\n$$a_1 = 0$$\nThe final answer is the row matrix of these coefficients $[b_{0}\\ b_{1}\\ a_{1}]$.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} & 0 \\end{pmatrix}}$$", "id": "2854942"}, {"introduction": "Real-world filter design often involves more detailed specifications, such as a passband ripple and a minimum stopband attenuation. This advanced exercise [@problem_id:2854931] integrates the pre-warping technique into the formal design methodology for Butterworth filters, a widely used class of IIR filters. You will derive a general formula for the minimum filter order $N$ required to meet a given set of digital specifications, revealing a powerful and non-obvious insight: the required filter complexity is independent of the chosen sampling period $T$.", "problem": "A fixed digital lowpass specification is to be realized by designing a continuous-time Butterworth prototype that is mapped to the discrete-time domain using the bilinear transformation with sampling period $T$. The digital specification is given in terms of discrete-time radian frequencies and magnitude constraints as follows:\n\n- Passband edge at $\\omega_{p}$ (radians per sample), with $0 < \\omega_{p} < \\pi$.\n- Stopband edge at $\\omega_{s}$ (radians per sample), with $\\omega_{p} < \\omega_{s} < \\pi$.\n- Maximum passband loss of $A_{p}$ decibels (dB), meaning the magnitude at $\\omega_{p}$ is at least $10^{-A_{p}/20}$.\n- Minimum stopband attenuation of $A_{s}$ decibels (dB), meaning the magnitude at $\\omega_{s}$ is at most $10^{-A_{s}/20}$.\n\nAngles are measured in radians. The mapping from the continuous-time prototype to the discrete-time filter is performed via the classical bilinear transformation arising from the trapezoidal integration of the continuous-time integrator, which maps the imaginary axis in the $s$-plane to the unit circle in the $z$-plane monotonically with frequency.\n\nStarting from (i) the definition of the Butterworth magnitude response $|H(j\\Omega)|^{2} = \\frac{1}{1 + (\\Omega/\\Omega_{c})^{2N}}$ for some cutoff $\\Omega_{c}$ and order $N$, (ii) the decibel definitions of the passband and stopband constraints, and (iii) the bilinear transformation as a conformal map between $\\omega$ on the unit circle and $\\Omega$ on the imaginary axis, derive the pre-warped analog passband and stopband radian frequencies $\\Omega_{p}(T)$ and $\\Omega_{s}(T)$ as functions of $T$, and then derive the real-valued minimal analog Butterworth order $N(T)$ (do not apply any integer rounding) required to meet the digitally specified constraints after mapping.\n\nYour final answer must be a single closed-form analytical expression for $N(T)$ in terms of $\\omega_{p}$, $\\omega_{s}$, $A_{p}$, and $A_{s}$, simplified as far as possible. Do not round. Angles must be in radians. No units should appear in the final boxed answer.", "solution": "The problem statement is subjected to validation and is found to be valid. It is a well-posed, scientifically grounded problem from the field of digital signal processing that is free of contradictions, ambiguities, or factual errors. The problem requests the derivation of the minimal real-valued Butterworth filter order required to meet a set of digital filter specifications after applying the bilinear transformation.\n\nWe begin the derivation from first principles as requested.\n\nThe bilinear transformation defines a mapping from the complex $s$-plane of continuous-time systems to the complex $z$-plane of discrete-time systems. The transformation is given by the substitution $s = \\frac{2}{T} \\frac{1-z^{-1}}{1+z^{-1}}$, where $T$ is the sampling period. To find the relationship between the continuous-time frequency $\\Omega$ and the discrete-time frequency $\\omega$, we evaluate this expression on the stability boundaries of each domain, which are $s=j\\Omega$ for the continuous-time domain (the imaginary axis) and $z=e^{j\\omega}$ for the discrete-time domain (the unit circle).\n\nSubstituting these into the transformation equation:\n$$j\\Omega = \\frac{2}{T} \\frac{1-e^{-j\\omega}}{1+e^{-j\\omega}}$$\nThe fraction on the right is a standard identity that simplifies to $j\\tan(\\frac{\\omega}{2})$. This can be shown by multiplying the numerator and denominator by $e^{j\\omega/2}$ and applying Euler's identities:\n$$ \\frac{1-e^{-j\\omega}}{1+e^{-j\\omega}} = \\frac{e^{j\\omega/2} - e^{-j\\omega/2}}{e^{j\\omega/2} + e^{-j\\omega/2}} = \\frac{2j\\sin(\\omega/2)}{2\\cos(\\omega/2)} = j\\tan\\left(\\frac{\\omega}{2}\\right) $$\nApplying this result, the equation becomes:\n$$j\\Omega = \\frac{2}{T} \\left( j\\tan\\left(\\frac{\\omega}{2}\\right) \\right)$$\nThis simplifies to the frequency warping relationship:\n$$\\Omega = \\frac{2}{T} \\tan\\left(\\frac{\\omega}{2}\\right)$$\nThis equation maps a digital frequency $\\omega$ (in radians per sample) to a corresponding analog frequency $\\Omega$ (in radians per second). To design an analog prototype filter that, after transformation, meets the digital specifications at $\\omega_p$ and $\\omega_s$, we must first map these digital frequencies to the analog domain. These are the pre-warped analog frequencies, $\\Omega_p$ and $\\Omega_s$. As requested, these are functions of $T$:\n$$\\Omega_p(T) = \\frac{2}{T} \\tan\\left(\\frac{\\omega_p}{2}\\right)$$\n$$\\Omega_s(T) = \\frac{2}{T} \\tan\\left(\\frac{\\omega_s}{2}\\right)$$\n\nNext, we consider the magnitude specifications for the analog Butterworth prototype. The magnitude-squared response of an $N$-th order Butterworth lowpass filter is given by:\n$$|H(j\\Omega)|^2 = \\frac{1}{1 + \\left(\\frac{\\Omega}{\\Omega_c}\\right)^{2N}}$$\nwhere $\\Omega_c$ is the analog cutoff frequency and $N$ is the filter order.\n\nThe digital filter specifications must be translated to the analog domain.\nThe passband specification requires the magnitude at $\\omega_p$ to be at least $10^{-A_p/20}$. This translates to a constraint on the magnitude-squared response at the corresponding analog frequency $\\Omega_p$:\n$$|H(j\\Omega_p)|^2 \\ge \\left(10^{-A_p/20}\\right)^2 = 10^{-A_p/10}$$\nSubstituting the Butterworth response formula:\n$$\\frac{1}{1 + \\left(\\frac{\\Omega_p}{\\Omega_c}\\right)^{2N}} \\ge 10^{-A_p/10}$$\n$$1 + \\left(\\frac{\\Omega_p}{\\Omega_c}\\right)^{2N} \\le 10^{A_p/10}$$\n$$\\left(\\frac{\\Omega_p}{\\Omega_c}\\right)^{2N} \\le 10^{A_p/10} - 1$$\n\nThe stopband specification requires the magnitude at $\\omega_s$ to be at most $10^{-A_s/20}$. This translates to a constraint at $\\Omega_s$:\n$$|H(j\\Omega_s)|^2 \\le \\left(10^{-A_s/20}\\right)^2 = 10^{-A_s/10}$$\nSubstituting the Butterworth response formula:\n$$\\frac{1}{1 + \\left(\\frac{\\Omega_s}{\\Omega_c}\\right)^{2N}} \\le 10^{-A_s/10}$$\n$$1 + \\left(\\frac{\\Omega_s}{\\Omega_c}\\right)^{2N} \\ge 10^{A_s/10}$$\n$$\\left(\\frac{\\Omega_s}{\\Omega_c}\\right)^{2N} \\ge 10^{A_s/10} - 1$$\n\nTo find the minimum order $N$ that satisfies both constraints, we can set them as equalities, which means the filter response will pass exactly through the corner points of the specification.\n$$1) \\quad \\left(\\frac{\\Omega_p}{\\Omega_c}\\right)^{2N} = 10^{A_p/10} - 1$$\n$$2) \\quad \\left(\\frac{\\Omega_s}{\\Omega_c}\\right)^{2N} = 10^{A_s/10} - 1$$\nTo solve for $N$, we eliminate the unknown cutoff frequency $\\Omega_c$ by dividing equation $(2)$ by equation $(1)$:\n$$\\frac{\\left(\\frac{\\Omega_s}{\\Omega_c}\\right)^{2N}}{\\left(\\frac{\\Omega_p}{\\Omega_c}\\right)^{2N}} = \\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}$$\n$$\\left(\\frac{\\Omega_s}{\\Omega_p}\\right)^{2N} = \\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}$$\nTo solve for $N$, we take the base-$10$ logarithm of both sides:\n$$\\log_{10}\\left[\\left(\\frac{\\Omega_s}{\\Omega_p}\\right)^{2N}\\right] = \\log_{10}\\left(\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}\\right)$$\n$$2N \\log_{10}\\left(\\frac{\\Omega_s}{\\Omega_p}\\right) = \\log_{10}\\left(\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}\\right)$$\nIsolating $N$ gives:\n$$N = \\frac{\\log_{10}\\left(\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}\\right)}{2\\log_{10}\\left(\\frac{\\Omega_s}{\\Omega_p}\\right)}$$\nThis gives the order $N$ in terms of the pre-warped analog frequencies. The final step is to substitute the expressions for $\\Omega_p$ and $\\Omega_s$ in terms of the digital frequencies $\\omega_p$ and $\\omega_s$. The ratio $\\frac{\\Omega_s}{\\Omega_p}$ is:\n$$\\frac{\\Omega_s}{\\Omega_p} = \\frac{\\frac{2}{T} \\tan\\left(\\frac{\\omega_s}{2}\\right)}{\\frac{2}{T} \\tan\\left(\\frac{\\omega_p}{2}\\right)} = \\frac{\\tan\\left(\\frac{\\omega_s}{2}\\right)}{\\tan\\left(\\frac{\\omega_p}{2}\\right)}$$\nNotice that the sampling period $T$ is cancelled. Therefore, the minimal order $N$ required for the analog prototype is independent of the sampling period $T$. The function $N(T)$ is a constant function with respect to $T$.\n\nSubstituting this ratio into the equation for $N$, we arrive at the final expression for the minimal real-valued order $N(T)$, which is written as $N$ for simplicity as it lacks dependence on $T$:\n$$N = \\frac{\\log_{10}\\left(\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}\\right)}{2\\log_{10}\\left(\\frac{\\tan(\\omega_s/2)}{\\tan(\\omega_p/2)}\\right)}$$\nThis expression represents the required a-priori (real-valued) Butterworth order for the analog prototype filter, derived from the fundamental principles of the bilinear transformation and filter design specifications.", "answer": "$$\n\\boxed{\n\\frac{\\log_{10}\\left(\\frac{10^{A_s/10} - 1}{10^{A_p/10} - 1}\\right)}{2\\log_{10}\\left(\\frac{\\tan(\\omega_s/2)}{\\tan(\\omega_p/2)}\\right)}\n}\n$$", "id": "2854931"}]}