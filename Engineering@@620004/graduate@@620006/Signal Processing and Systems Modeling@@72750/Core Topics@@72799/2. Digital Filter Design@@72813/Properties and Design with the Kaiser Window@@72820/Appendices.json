{"hands_on_practices": [{"introduction": "The first step in any practical filter design is to translate abstract requirements into concrete design parameters. This exercise provides direct practice in this crucial skill by applying one of the most powerful tools in FIR filter design: the Kaiser window order estimation formula. By working through this problem, you will learn how to determine the minimum filter order $N$ required to simultaneously meet specifications for stopband attenuation $A$ and transition width $\\Delta\\omega$, providing a solid foundation for building effective filters. [@problem_id:2894035]", "problem": "A causal, linear time-invariant, real-coefficient, lowpass finite impulse response filter is to be designed via windowing with the Kaiser window. The specification is given in terms of a two-sided transition width and a stopband attenuation: the transition width is $\\Delta \\omega = 0.02\\pi$ radians per sample, and the stopband attenuation is $A = 60$ decibels. Assume the ripple parameter is defined by $\\delta = 10^{-A/20}$ so that the peak passband and stopband ripples do not exceed $\\delta$, and that the window parameterization follows the standard Kaiser form based on the zeroth-order modified Bessel function of the first kind.\n\nStarting from the definition of the Kaiser window and the well-tested asymptotic properties of its discrete-time Fourier transform that relate:\n- the achievable stopband attenuation level (through the window parameter) to $A$, and\n- the main-lobe (transition) width to the window length,\n\nderive the commonly used order estimate for the Kaiser-window-based design that links the filter order $N$, the attenuation $A$, and the transition width $\\Delta \\omega$. Then, apply this estimate to the given specification to determine the minimum integer filter order $N$ predicted by this method. Report the smallest integer $N$ that meets the estimate. No rounding to significant figures is required beyond choosing the smallest integer order satisfying the estimate. All angles are in radians.", "solution": "The problem statement is subjected to validation before any attempt at a solution is made.\n\nFirst, the given data and conditions are extracted verbatim:\n-   **Filter properties**: Causal, linear time-invariant (LTI), real-coefficient, lowpass finite impulse response (FIR).\n-   **Design methodology**: Windowing with the Kaiser window.\n-   **Specification (transition width)**: $\\Delta \\omega = 0.02\\pi$ radians per sample.\n-   **Specification (stopband attenuation)**: $A = 60$ decibels.\n-   **Ripple parameter definition**: $\\delta = 10^{-A/20}$.\n-   **Task**: Derive the commonly used order estimate for the Kaiser-window-based design that links the filter order $N$, the attenuation $A$, and the transition width $\\Delta \\omega$. Then, apply this estimate to find the minimum integer filter order $N$.\n\nThe problem is evaluated against the validation criteria:\n-   **Scientific Grounding**: The problem is based on the well-established theory of digital FIR filter design using the Kaiser window, a standard topic in digital signal processing. All concepts, including stopband attenuation, transition width, and the Kaiser window itself, are fundamental and scientifically sound.\n-   **Well-Posedness and Completeness**: The problem provides a complete set of specifications ($A$ and $\\Delta\\omega$) required to determine the filter order $N$. The objective is clearly stated, and the relationships described lead to a unique, meaningful solution. The problem is unambiguous and self-contained.\n-   **Objectivity**: The language is technical and precise, free from subjective or non-scientific assertions.\n\nThe verdict is that the problem is **valid**. It is a standard exercise in digital filter design. I will now proceed with the solution.\n\nThe design of a Finite Impulse Response (FIR) filter using the window method involves truncating an ideal, infinite-length impulse response $h_d[n]$ to a finite length of $N+1$ samples, thereby defining the filter order as $N$. This truncation is performed by multiplying $h_d[n]$ by a finite-length window function $w[n]$:\n$$h[n] = h_d[n] w[n], \\quad 0 \\le n \\le N$$\nIn the frequency domain, this corresponds to the convolution of their respective Fourier transforms:\n$$H(e^{j\\omega}) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} H_d(e^{j\\theta}) W(e^{j(\\omega-\\theta)}) d\\theta$$\nThe characteristics of the resulting filter $H(e^{j\\omega})$ are critically dependent on the spectral properties of the window function $W(e^{j\\omega})$. Specifically:\n$1$. The stopband attenuation $A$, defined in terms of the peak ripple $\\delta$ as $A = -20 \\log_{10}(\\delta)$, is determined by the peak side-lobe level of $W(e^{j\\omega})$. A lower side-lobe level corresponds to a higher stopband attenuation.\n$2$. The transition width $\\Delta\\omega$ between the passband and stopband is determined by the width of the main lobe of $W(e^{j\\omega})$. A narrower main lobe allows for a sharper transition.\n\nThe Kaiser window is defined as:\n$$w[n] = \\frac{I_0\\left(\\beta \\sqrt{1 - \\left(\\frac{2n-N}{N}\\right)^2}\\right)}{I_0(\\beta)}, \\quad 0 \\le n \\le N$$\nwhere $I_0(\\cdot)$ is the zeroth-order modified Bessel function of the first kind. The parameter $\\beta$ provides a continuous trade-off between the main-lobe width and the side-lobe level. Increasing $\\beta$ decreases the side-lobe level (increasing attenuation) at the cost of increasing the main-lobe width (widening the transition band).\n\nThe problem requires the derivation of a direct relationship between the filter specifications ($A$, $\\Delta\\omega$) and the required filter order $N$. These relationships are not derived from first principles but are accurate empirical formulas established by J. F. Kaiser through extensive numerical simulation.\n\nThe \"derivation\" consists of stating these well-tested empirical formulas.\nFirst, the window parameter $\\beta$ is chosen based on the desired stopband attenuation $A$. For an attenuation $A$ greater than $50$ dB, the formula is:\n$$\\beta \\approx 0.1102(A - 8.7)$$\nFor the given $A=60$, this would yield a specific $\\beta$.\n\nSecond, for a given $\\beta$, the relationship between the filter order $N$ (or length $M=N+1$) and the transition width $\\Delta\\omega$ is also empirically determined. However, a more direct design formula that bypasses the explicit calculation of $\\beta$ was also developed. This formula directly links the design specifications $A$ and $\\Delta\\omega$ to the required filter order $N$. This is the \"commonly used order estimate\" that the problem asks for:\n$$N \\ge \\frac{A - 8}{2.285 \\Delta\\omega}$$\nIn this formula, the attenuation $A$ must be in decibels (dB) and the transition width $\\Delta\\omega$ must be in radians per sample. This expression consolidates the complex dependencies into a single, practical design rule. The constants $8$ and $2.285$ are empirically derived fitting parameters. The formula provides an estimate for the minimum filter order $N$ required to meet the given specifications.\n\nNow, we apply this formula to the given specifications:\n-   Stopband attenuation: $A = 60$ dB.\n-   Transition width: $\\Delta\\omega = 0.02\\pi$ radians/sample.\n\nSubstituting these values into the order estimation formula:\n$$N \\ge \\frac{60 - 8}{2.285 \\times (0.02\\pi)}$$\n$$N \\ge \\frac{52}{0.0457\\pi}$$\nWe compute the numerical value of the right-hand side:\n$$N \\ge \\frac{52}{0.14356636...}$$\n$$N \\ge 362.1936...$$\nSince the filter order $N$ must be an integer, we must choose the smallest integer that satisfies this inequality. This is found by taking the ceiling of the calculated value:\n$$N_{\\text{min}} = \\lceil 362.1936... \\rceil = 363$$\nTherefore, the minimum integer filter order predicted by the Kaiser window design formula to meet the specified attenuation and transition width is $363$.", "answer": "$$\\boxed{363}$$", "id": "2894035"}, {"introduction": "Once a filter's coefficients are determined, the next step is to analyze its frequency-domain characteristics. This practice focuses on a fundamental property: the direct-current (DC) gain, which is simply the sum of the filter's impulse response coefficients. You will derive the DC gain for a filter designed with the Kaiser window and determine the necessary scaling factor to achieve unity gain, a common requirement in signal processing systems, without disturbing the filter's desirable linear-phase property. [@problem_id:2894065]", "problem": "Consider an ideal, zero-phase, discrete-time lowpass filter obtained by truncating the ideal impulse response with a finite-length Kaiser window. Let the filter length be $L = 2M+1$ with $M = 25$, so that indices are centered as $n \\in \\{-M,-M+1,\\dots,0,\\dots,M-1,M\\}$. The ideal lowpass impulse response is \n$$\nh_{d}[n] = \n\\begin{cases}\n\\dfrac{\\sin(\\Omega_{c} n)}{\\pi n}, & n \\neq 0 \\\\\n\\dfrac{\\Omega_{c}}{\\pi}, & n=0\n\\end{cases}\n$$\nwith cutoff radian frequency $\\Omega_{c} = 0.45\\pi$ (radians per sample). The Kaiser window is defined for $|n| \\le M$ by\n$$\nw[n] = \\dfrac{I_{0}\\!\\left(\\beta \\sqrt{1 - \\left(\\dfrac{n}{M}\\right)^{2}}\\right)}{I_{0}(\\beta)},\n$$\nand $w[n]=0$ otherwise, where $I_{0}(\\cdot)$ denotes the order-zero modified Bessel function of the first kind. Take $\\beta = 5.2$. The windowed impulse response is $h[n] = w[n]\\,h_{d}[n]$.\n\nStarting from the definition of the Discrete-Time Fourier Transform (DTFT), and using only fundamental properties of symmetry and evenness where applicable, determine the direct-current (DC) gain $H(\\exp(j\\cdot 0))$ of the windowed filter and the real, positive scaling factor $\\alpha$ that must multiply $h[n]$ to enforce unity DC gain without altering linear phase. Express your final result as a single, closed-form analytic expression involving only finite sums and standard special functions, and do not numerically approximate any constants. Your final answer must be a single row matrix containing two entries, $\\big(H(\\exp(j\\cdot 0)),\\,\\alpha\\big)$, in that order. No units are required. Angles are in radians.", "solution": "The problem requires the determination of the direct-current (DC) gain of a finite impulse response (FIR) filter and the scaling factor needed to normalize this gain to unity. The problem statement is scientifically sound, well-posed, and contains all necessary information for a unique solution. We shall proceed.\n\nThe frequency response of a discrete-time signal $h[n]$ is given by its Discrete-Time Fourier Transform (DTFT):\n$$\nH(\\exp(j\\Omega)) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-j\\Omega n)\n$$\nThe DC gain is the value of the frequency response at zero frequency, $\\Omega=0$. Substituting $\\Omega=0$ into the DTFT definition gives:\n$$\nH(\\exp(j\\cdot 0)) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-j\\cdot 0 \\cdot n) = \\sum_{n=-\\infty}^{\\infty} h[n]\n$$\nThe impulse response $h[n]$ is the product of the ideal impulse response $h_d[n]$ and the Kaiser window $w[n]$, i.e., $h[n] = w[n]h_d[n]$. The filter is of finite length $L=2M+1$, so $h[n]$ is non-zero only for indices $n \\in \\{-M, -M+1, \\dots, M\\}$. The sum is therefore finite:\n$$\nH(\\exp(j\\cdot 0)) = \\sum_{n=-M}^{M} h[n] = \\sum_{n=-M}^{M} w[n]h_d[n]\n$$\nTo evaluate this sum, we first examine the symmetry properties of the functions involved. The ideal impulse response $h_d[n]$ for $n \\ne 0$ is $h_d[n] = \\frac{\\sin(\\Omega_c n)}{\\pi n}$. For $n \\to -n$, we have $h_d[-n] = \\frac{\\sin(\\Omega_c (-n))}{\\pi (-n)} = \\frac{-\\sin(\\Omega_c n)}{-\\pi n} = h_d[n]$. The function is even. At $n=0$, it is defined as a constant, which is consistent with even symmetry.\n\nThe Kaiser window is defined as $w[n] = \\frac{I_0(\\beta \\sqrt{1 - (n/M)^2})}{I_0(\\beta)}$ for $|n| \\le M$. Since the argument of $I_0(\\cdot)$ depends on $n^2$, the window is also an even function: $w[-n]=w[n]$.\n\nThe product of two even functions is an even function. Therefore, the windowed impulse response $h[n] = w[n]h_d[n]$ is even, i.e., $h[-n]=h[n]$ for all $n$. This property allows for simplification of the summation:\n$$\n\\sum_{n=-M}^{M} h[n] = h[0] + \\sum_{n=1}^{M} h[n] + \\sum_{n=-M}^{-1} h[n]\n$$\nSince $h[n]$ is even, the sum over negative indices is equal to the sum over positive indices: $\\sum_{n=-M}^{-1} h[n] = \\sum_{k=1}^{M} h[-k] = \\sum_{k=1}^{M} h[k]$. Thus,\n$$\nH(\\exp(j\\cdot 0)) = h[0] + 2\\sum_{n=1}^{M} h[n]\n$$\nNow we evaluate the terms. The term at $n=0$ is $h[0] = w[0]h_d[0]$.\nThe Kaiser window at $n=0$ is $w[0] = \\frac{I_0(\\beta \\sqrt{1-(0/M)^2})}{I_0(\\beta)} = \\frac{I_0(\\beta)}{I_0(\\beta)} = 1$.\nThe ideal impulse response at $n=0$ is given as $h_d[0] = \\frac{\\Omega_c}{\\pi}$.\nSo, $h[0] = 1 \\cdot \\frac{\\Omega_c}{\\pi} = \\frac{\\Omega_c}{\\pi}$.\n\nFor $n \\in \\{1, 2, \\dots, M\\}$, the impulse response is:\n$$\nh[n] = w[n]h_d[n] = \\frac{I_0(\\beta \\sqrt{1 - (n/M)^2})}{I_0(\\beta)} \\cdot \\frac{\\sin(\\Omega_c n)}{\\pi n}\n$$\nSubstituting these expressions into the formula for the DC gain:\n$$\nH(\\exp(j\\cdot 0)) = \\frac{\\Omega_c}{\\pi} + 2\\sum_{n=1}^{M} \\left( \\frac{I_0(\\beta \\sqrt{1 - (n/M)^2})}{I_0(\\beta)} \\cdot \\frac{\\sin(\\Omega_c n)}{\\pi n} \\right)\n$$\nWe can factor out constants from the summation:\n$$\nH(\\exp(j\\cdot 0)) = \\frac{\\Omega_c}{\\pi} + \\frac{2}{\\pi I_0(\\beta)} \\sum_{n=1}^{M} \\frac{\\sin(\\Omega_c n)}{n} I_0\\left(\\beta \\sqrt{1 - \\left(\\frac{n}{M}\\right)^2}\\right)\n$$\nSubstituting the given parameter values $\\Omega_c=0.45\\pi$, $M=25$, and $\\beta=5.2$:\n$$\nH(\\exp(j\\cdot 0)) = \\frac{0.45\\pi}{\\pi} + \\frac{2}{\\pi I_0(5.2)} \\sum_{n=1}^{25} \\frac{\\sin(0.45\\pi n)}{n} I_0\\left(5.2 \\sqrt{1 - \\left(\\frac{n}{25}\\right)^2}\\right)\n$$\n$$\nH(\\exp(j\\cdot 0)) = 0.45 + \\frac{2}{\\pi I_0(5.2)} \\sum_{n=1}^{25} \\frac{\\sin(0.45\\pi n)}{n} I_0\\left(5.2 \\sqrt{1 - \\left(\\frac{n}{25}\\right)^2}\\right)\n$$\nThis is the first required result.\n\nNext, we must find the real, positive scaling factor $\\alpha$ such that the scaled filter, with impulse response $h_{\\text{new}}[n] = \\alpha h[n]$, has unity DC gain. The frequency response of the new filter is $H_{\\text{new}}(\\exp(j\\Omega)) = \\alpha H(\\exp(j\\Omega))$. The unity DC gain requirement is $H_{\\text{new}}(\\exp(j\\cdot 0)) = 1$.\n$$\n\\alpha H(\\exp(j\\cdot 0)) = 1 \\implies \\alpha = \\frac{1}{H(\\exp(j\\cdot 0))}\n$$\nThe problem states that this scaling must not alter the linear phase property. As established, $h[n]$ is a real and even sequence. Its DTFT, $H(\\exp(j\\Omega))$, is therefore a purely real function of $\\Omega$. A real frequency response corresponds to a phase of $0$ or $\\pi$ radians, which is a special case of generalized linear phase known as zero phase. Since $H(\\exp(j\\cdot 0))$ will be a positive real number (as it is the integral of the main lobe of the filter's frequency response), the scaling factor $\\alpha$ will also be a positive real number. Multiplying a real function by a positive real constant does not alter its phase. Thus, the condition is satisfied.\n\nThe expression for $\\alpha$ is the reciprocal of the DC gain we derived:\n$$\n\\alpha = \\left( 0.45 + \\frac{2}{\\pi I_0(5.2)} \\sum_{n=1}^{25} \\frac{\\sin(0.45\\pi n)}{n} I_0\\left(5.2 \\sqrt{1 - \\left(\\frac{n}{25}\\right)^2}\\right) \\right)^{-1}\n$$\nThis is the second required result. The final answer is presented as a row matrix containing the DC gain and the scaling factor $\\alpha$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.45 + \\dfrac{2}{\\pi I_0(5.2)} \\displaystyle\\sum_{n=1}^{25} \\dfrac{\\sin(0.45\\pi n)}{n} I_0\\left(5.2 \\sqrt{1 - \\left(\\dfrac{n}{25}\\right)^2}\\right) & \\left( 0.45 + \\dfrac{2}{\\pi I_0(5.2)} \\displaystyle\\sum_{n=1}^{25} \\dfrac{\\sin(0.45\\pi n)}{n} I_0\\left(5.2 \\sqrt{1 - \\left(\\dfrac{n}{25}\\right)^2}\\right) \\right)^{-1} \\end{pmatrix}}\n$$", "id": "2894065"}, {"introduction": "While empirical formulas provide excellent starting points, a skilled designer understands their limitations. This computational exercise challenges you to move beyond accepting design rules and instead, to verify them through numerical analysis. You will write code to measure the actual sidelobe attenuation of a Kaiser window and compare it against the attenuation predicted by the standard empirical formulas, a process that reveals the true performance and helps build intuition for how design parameters interact, especially for filters with short lengths. [@problem_id:2893995]", "problem": "Consider the Kaiser window used in finite-duration discrete-time signal processing. Let the window length be $N \\in \\mathbb{Z}_{\\ge 1}$ and the Kaiser shape parameter be $\\beta \\in \\mathbb{R}_{\\ge 0}$. The Kaiser window in the time domain is defined by\n$$\nw[n] = \\frac{I_0\\!\\left(\\beta\\, \\sqrt{1 - \\left(\\frac{n-\\alpha}{\\alpha}\\right)^2}\\right)}{I_0(\\beta)}, \\quad \\alpha = \\frac{N-1}{2}, \\quad n = 0,1,\\dots,N-1,\n$$\nwhere $I_0(\\cdot)$ denotes the modified Bessel function of the first kind of order $0$. The Discrete-Time Fourier Transform (DTFT) of $w[n]$ is\n$$\nW(\\omega) = \\sum_{n=0}^{N-1} w[n]\\, e^{-j \\omega n}, \\quad \\omega \\in \\mathbb{R},\n$$\nwith angular frequency $\\omega$ expressed in radians.\n\nIn standard filter design practice, there is a widely used empirical mapping from a desired stopband attenuation $A$ (in decibels) to the Kaiser parameter $\\beta$. Assume this standard attenuation-to-parameter mapping is available to you as a well-tested design rule and implement it. Your task is to assess, for small $N$, how accurately this $A \\mapsto \\beta$ mapping predicts the observed sidelobe attenuation in the magnitude spectrum $\\lvert W(\\omega)\\rvert$.\n\nStarting from the above definitions and standard numerical approximations of the DTFT via zero-padding and the Discrete Fourier Transform (DFT), do the following for each test case:\n\n- Given $(N, A)$, compute $\\beta$ from $A$ using the standard empirical mapping used in Kaiser-window design.\n- Construct $w[n]$ using the Kaiser definition above.\n- Approximate $W(\\omega)$ on $[0,\\pi]$ radians by evaluating a zero-padded DFT of $w[n]$ of length $L$, where $L$ is a large power of two (use $L = 2^{18}$). Extract the nonnegative-frequency samples (which correspond to $\\omega \\in [0,\\pi]$ in radians).\n- Normalize the magnitude by the direct-current (DC) value: $\\tilde{M}[k] = \\frac{\\lvert W(\\omega_k)\\rvert}{\\lvert W(0)\\rvert}$.\n- Identify the end of the mainlobe region by locating the first strict local minimum of $\\tilde{M}[k]$ for $k > 0$ (equivalently, the first index $k_{\\min}>0$ where the discrete derivative changes sign from negative to positive). If no such index is found due to discretization, fall back to declaring the mainlobe region to end at the index $\\lfloor 0.01 K \\rfloor$, where $K$ is the number of nonnegative-frequency DFT bins.\n- Over the sidelobe region (all indices strictly greater than the mainlobe-ending index), compute the maximum sidelobe magnitude $\\max_{k>k_{\\min}} \\tilde{M}[k]$.\n- Convert this to an observed attenuation in decibels via\n$$\nA_{\\text{obs}} = -20 \\log_{10}\\!\\left(\\max_{k>k_{\\min}} \\tilde{M}[k]\\right).\n$$\n- Report the signed difference\n$$\n\\Delta = A_{\\text{obs}} - A,\n$$\nso that $\\Delta > 0$ indicates the observed sidelobe attenuation is stronger (larger in decibels) than predicted by the $A \\mapsto \\beta$ mapping, and $\\Delta < 0$ indicates it is weaker.\n\nAngle units must be radians throughout. All decibels are dimensionless as usual. For numerical stability, when evaluating the logarithm, you may add a negligible positive constant $\\varepsilon$ to the argument as needed, with $\\varepsilon$ chosen small enough not to affect the result at the requested precision.\n\nImplement a program that computes $\\Delta$ for the following test suite, specified as ordered pairs $(N,A)$:\n\n- $(N,A) = (\\,7,\\,20\\,)$\n- $(N,A) = (\\,9,\\,21\\,)$\n- $(N,A) = (\\,11,\\,30\\,)$\n- $(N,A) = (\\,11,\\,60\\,)$\n- $(N,A) = (\\,15,\\,50\\,)$\n- $(N,A) = (\\,15,\\,51\\,)$\n- $(N,A) = (\\,21,\\,35\\,)$\n- $(N,A) = (\\,21,\\,80\\,)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the exact same order as the test suite above. Each number must be a floating-point value rounded to three digits after the decimal point. For example, the output format must look like a single line\n\"[r1,r2,r3,r4,r5,r6,r7,r8]\"\nwhere each $r_i$ is a decimal string with three digits after the decimal point.", "solution": "The problem statement presented is a well-defined exercise in numerical signal processing. It requires an assessment of the accuracy of standard empirical formulas for the Kaiser window design, specifically for small window lengths $N$.\n\nBefore proceeding to the solution, a critical validation of the problem is required.\n\n**Step 1: Extract Givens**\n\n- **Kaiser Window Definition**:\n  $$\n  w[n] = \\frac{I_0\\!\\left(\\beta\\, \\sqrt{1 - \\left(\\frac{n-\\alpha}{\\alpha}\\right)^2}\\right)}{I_0(\\beta)}, \\quad \\alpha = \\frac{N-1}{2}, \\quad n = 0,1,\\dots,N-1.\n  $$\n- **Parameters**: Window length $N \\in \\mathbb{Z}_{\\ge 1}$, shape parameter $\\beta \\in \\mathbb{R}_{\\ge 0}$.\n- **Function**: $I_0(\\cdot)$ is the modified Bessel function of the first kind of order $0$.\n- **DTFT Definition**: $W(\\omega) = \\sum_{n=0}^{N-1} w[n]\\, e^{-j \\omega n}$.\n- **Task**: For given pairs $(N, A)$, where $A$ is the desired stopband attenuation in decibels, calculate the difference $\\Delta = A_{\\text{obs}} - A$.\n- **Procedure**:\n    1.  Compute $\\beta$ from $A$ using a standard empirical mapping.\n    2.  Construct the window $w[n]$.\n    3.  Approximate $W(\\omega)$ using a zero-padded DFT of length $L = 2^{18}$.\n    4.  Normalize the magnitude spectrum: $\\tilde{M}[k] = \\frac{\\lvert W(\\omega_k)\\rvert}{\\lvert W(0)\\rvert}$.\n    5.  Identify the end of the mainlobe at index $k_{\\min}$, defined as the first strict local minimum for $k > 0$.\n    6.  Use a fallback rule if no such minimum is found: mainlobe ends at $\\lfloor 0.01 K \\rfloor$, where $K$ is the number of non-negative frequency bins.\n    7.  Compute maximum sidelobe magnitude over indices $k > k_{\\min}$.\n    8.  Calculate observed attenuation: $A_{\\text{obs}} = -20 \\log_{10}(\\max_{k>k_{\\min}} \\tilde{M}[k])$.\n    9.  Calculate the difference $\\Delta = A_{\\text{obs}} - A$.\n- **Test Cases**: $(N,A) \\in \\{(\\,7,\\,20\\,), (\\,9,\\,21\\,), (\\,11,\\,30\\,), (\\,11,\\,60\\,), (\\,15,\\,50\\,), (\\,15,\\,51\\,), (\\,21,\\,35\\,), (\\,21,\\,80\\,)\\}$.\n- **Output Format**: A single-line comma-separated list of $\\Delta$ values, rounded to three decimal places, enclosed in square brackets.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the validation criteria.\n\n- **Scientific Grounding**: The problem is scientifically sound. The Kaiser window, its Fourier transform, and the empirical relations between attenuation $A$ and parameter $\\beta$ are foundational concepts in digital filter design. The proposed numerical procedure is a standard method for spectral analysis.\n- **Well-Posedness**: The procedure is algorithmic and unambiguous, leading to a unique numerical result for each input pair $(N,A)$. The inclusion of a fallback rule for identifying the mainlobe ensures the algorithm does not fail on discretely sampled spectra.\n- **Objectivity**: The problem is stated in objective, mathematical terms, free of subjective interpretation.\n- **Incompleteness/Contradiction**: There is a minor inconsistency. The formula for $w[n]$ includes division by $\\alpha = (N-1)/2$. If $N=1$, then $\\alpha=0$, causing a division by zero. The problem claims applicability for $N \\in \\mathbb{Z}_{\\ge 1}$. However, all specified test cases have $N \\ge 7$, for which $\\alpha > 0$. This minor theoretical flaw does not impede solving the problem for the given test suite. The problem also refers to a \"standard empirical mapping\" from $A$ to $\\beta$ without explicitly stating it. This requires using established formulas from signal processing literature, which is an acceptable implicit assumption in a specialized context.\n\n**Step 3: Verdict and Action**\n\nThe problem is deemed **valid** for the provided test cases. The minor inconsistency for $N=1$ is noted but does not affect the required computations. I will proceed with the solution.\n\nThe solution is a step-by-step implementation of the specified procedure.\n\n**1. Empirical Mapping from Attenuation $A$ to Parameter $\\beta$**\n\nThe standard empirical formulas for computing the Kaiser window parameter $\\beta$ from a desired stopband attenuation $A$ (in decibels) are piecewise:\n$$\n\\beta =\n\\begin{cases}\n0.1102 (A - 8.7) & \\text{if } A > 50 \\\\\n0.5842 (A - 21)^{0.4} + 0.07886 (A - 21) & \\text{if } 21 \\le A \\le 50 \\\\\n0 & \\text{if } A < 21\n\\end{cases}\n$$\nThese formulas are approximations derived by James Kaiser, intended for designing FIR filters, and their accuracy is known to depend on other filter parameters, including the length $N$. This exercise directly tests this dependency.\n\n**2. Kaiser Window Generation**\n\nFor each pair $(N, A)$, we first compute $\\beta$ using the formulas above. Then, the $N$-point window sequence $w[n]$ is synthesized for $n = 0, 1, \\dots, N-1$. The parameter $\\alpha$ is calculated as $\\alpha = (N-1)/2$. The window is given by:\n$$\nw[n] = \\frac{I_0\\!\\left(\\beta\\, \\sqrt{1 - \\left(\\frac{n-\\alpha}{\\alpha}\\right)^2}\\right)}{I_0(\\beta)}\n$$\nThe function $I_0(x)$ is the modified Bessel function of the first kind of order zero. Note that if $\\beta=0$, the formula simplifies. As $I_0(0)=1$, $w[n]$ becomes a constant value of $1$, which corresponds to a rectangular window.\n\n**3. Spectral Approximation via Zero-Padded DFT**\n\nThe continuous-frequency DTFT, $W(\\omega)$, is approximated by a dense set of samples using the Discrete Fourier Transform (DFT). The $N$-point sequence $w[n]$ is zero-padded to a much greater length $L = 2^{18} = 262144$. This increases the sampling density in the frequency domain, providing a high-resolution view of the spectrum. The DFT is computed as:\n$$\nW[k] = \\sum_{n=0}^{L-1} w_{\\text{padded}}[n]\\, e^{-j \\frac{2\\pi}{L} nk}, \\quad k = 0, 1, \\dots, L-1\n$$\nSince the time-domain window $w[n]$ is real-valued, its magnitude spectrum is symmetric. We need only analyze the non-negative frequency components, which correspond to the first $K = L/2 + 1$ DFT bins. The magnitude spectrum is $\\lvert W[k] \\rvert$ for $k = 0, \\dots, K-1$.\n\n**4. Normalization and Sidelobe Identification**\n\nThe magnitude spectrum is normalized by its value at zero frequency (the DC component), which is given by $W[0] = \\sum w[n]$. The normalized magnitude spectrum is:\n$$\n\\tilde{M}[k] = \\frac{\\lvert W[k]\\rvert}{\\lvert W[0]\\rvert}\n$$\nThe mainlobe of the window's spectrum is the central peak around $\\omega=0$. The problem defines the end of the mainlobe as the index $k_{\\min} > 0$ corresponding to the first strict local minimum in $\\tilde{M}[k]$. This is found by searching for the first index $k_{\\min} \\in \\{1, \\dots, K-2\\}$ where $\\tilde{M}[k_{\\min}-1] > \\tilde{M}[k_{\\min}]$ and $\\tilde{M}[k_{\\min}] < \\tilde{M}[k_{\\min}+1]$.\nIf no such minimum exists in the discrete data, the fallback index is used: $k_{\\min} = \\lfloor 0.01 K \\rfloor$. The sidelobe region consists of all indices $k$ such that $k > k_{\\min}$.\n\n**5. Sidelobe Attenuation and Error Calculation**\n\nThe peak sidelobe level is the maximum value of the normalized spectrum in the sidelobe region:\n$$\nS_{\\max} = \\max_{k > k_{\\min}} \\tilde{M}[k]\n$$\nThis quantity is converted to decibels to find the observed attenuation $A_{\\text{obs}}$. A small constant $\\varepsilon$ is added for numerical stability to avoid taking the logarithm of zero.\n$$\nA_{\\text{obs}} = -20 \\log_{10}(S_{\\max} + \\varepsilon)\n$$\nFinally, the signed difference $\\Delta$ between the observed and target attenuations is computed, providing a measure of the empirical formula's accuracy for the given $(N, A)$ pair.\n$$\n\\Delta = A_{\\text{obs}} - A\n$$\nThis procedure is repeated for all test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import i0\n\ndef solve():\n    \"\"\"\n    Solves the Kaiser window analysis problem for a suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (7, 20),\n        (9, 21),\n        (11, 30),\n        (11, 60),\n        (15, 50),\n        (15, 51),\n        (21, 35),\n        (21, 80),\n    ]\n\n    # DFT length, a large power of two for high-resolution spectral analysis.\n    L = 2**18\n\n    # Small constant for numerical stability in log10.\n    EPSILON = 1e-20\n\n    results = []\n    \n    for case in test_cases:\n        N, A = case\n\n        # 1. Compute beta from A using the standard empirical mapping.\n        if A > 50:\n            beta = 0.1102 * (A - 8.7)\n        elif A >= 21:\n            beta = 0.5842 * (A - 21)**0.4 + 0.07886 * (A - 21)\n        else:\n            beta = 0.0\n        \n        # 2. Construct w[n] using the Kaiser definition.\n        # Although problem states N>=1, test cases have N>=7, so alpha is non-zero.\n        alpha = (N - 1) / 2.0\n        n = np.arange(N)\n        \n        # Handle the case N=1 separately to avoid division by zero\n        if N == 1:\n            # For N=1, alpha=0, w[0] is defined as 1.\n            w = np.array([1.0])\n        else:\n            # The argument inside the square root is guaranteed to be non-negative.\n            radicand = 1.0 - ((n - alpha) / alpha)**2\n            bessel_arg = beta * np.sqrt(radicand)\n            \n            # The denominator i0(beta) can be a large number but is constant.\n            # i0(0) = 1, so no division by zero for beta=0.\n            w = i0(bessel_arg) / i0(beta)\n\n        # 3. Approximate W(omega) with a zero-padded DFT.\n        W_k = np.fft.fft(w, L)\n\n        # We only need the non-negative frequency samples.\n        K = L // 2 + 1\n        M_k = np.abs(W_k[:K])\n        \n        # 4. Normalize the magnitude by the DC value.\n        # M_k[0] is sum(w), which is non-zero for a valid window.\n        dc_val = M_k[0]\n        if dc_val  EPSILON:\n            # This case should not be reached with valid windows.\n            # If it were, the spectrum is essentially zero everywhere.\n            M_norm = np.zeros_like(M_k)\n        else:\n            M_norm = M_k / dc_val\n\n        # 5. Identify the end of the mainlobe region.\n        # Find the first strict local minimum for k > 0.\n        # A local minimum at k occurs where the diff changes from negative to positive.\n        diff_M = np.diff(M_norm)\n        # Find indices k-1 where diff[k-1]  0 and diff[k] > 0\n        minima_indices = np.where((diff_M[:-1]  0)  (diff_M[1:] > 0))[0]\n\n        if len(minima_indices) > 0:\n            # The first local minimum is at index `indices[0] + 1` in M_norm\n            k_min = minima_indices[0] + 1\n        else:\n            # Fallback rule if no strict local minimum is found.\n            k_min = int(0.01 * K)\n\n        # 6. Compute the maximum sidelobe magnitude.\n        sidelobe_region = M_norm[k_min + 1:]\n        if len(sidelobe_region) == 0:\n            max_sidelobe = 0.0\n        else:\n            max_sidelobe = np.max(sidelobe_region)\n            \n        # 7. Convert to observed attenuation in decibels.\n        A_obs = -20 * np.log10(max_sidelobe + EPSILON)\n\n        # 8. Report the signed difference.\n        delta = A_obs - A\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "2893995"}]}