{"hands_on_practices": [{"introduction": "The most fundamental trade-off in windowing for spectral analysis is between mainlobe width and sidelobe suppression. This practice delves into the origin of this trade-off by connecting the mathematical definition of a window to the width of its main spectral lobe. By approximating the window's Discrete-Time Fourier Transform (DTFT) for a large number of samples, you will see precisely how adding more cosine terms to the window function systematically widens the mainlobe, which directly impacts frequency resolution. [@problem_id:2895210]", "problem": "Consider three finite-duration deterministic windows of length $N \\in \\mathbb{N}$, defined for $n \\in \\{0,1,\\dots,N-1\\}$ by:\n- Rectangular: $w_{\\mathrm{rect}}[n] = 1$.\n- Hann (also called Hanning): $w_{\\mathrm{Hann}}[n] = \\tfrac{1}{2} - \\tfrac{1}{2} \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right)$.\n- Hamming: $w_{\\mathrm{Hamming}}[n] = 0.54 - 0.46 \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right)$.\n- Blackman: $w_{\\mathrm{Blackman}}[n] = 0.42 - 0.5 \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right) + 0.08 \\cos\\!\\left(\\tfrac{4\\pi n}{N-1}\\right)$.\n\nLet $W(\\omega)$ denote the Discrete-Time Fourier Transform (DTFT) of a window $w[n]$, defined by $W(\\omega) = \\sum_{n=0}^{N-1} w[n] \\, \\exp(-j \\omega n)$ for real radian frequency $\\omega$. Define the mainlobe width as the null-to-null distance in $\\omega$ (in radians) between the first negative and first positive zeros of $\\lvert W(\\omega) \\rvert$ closest to the origin.\n\nStarting only from the DTFT definition and the asymptotic Riemann-sum approximation for large $N$, model $w[n]$ as samples of a smooth function $g(t)$ on the unit interval via $t = n/(N-1)$, and use the large-$N$ scaling $W(\\omega) \\approx (N-1) \\int_{0}^{1} g(t) \\exp\\!\\big(-j \\omega (N-1) t\\big) \\, dt$. By evaluating the first spectral zeros of the integral kernel at harmonics of $2\\pi$, determine the scaling of the mainlobe width with $N$ for each window and extract the proportionality constants relative to the rectangular window baseline (that is, constants $\\kappa$ such that, for large $N$, $\\Delta \\omega_{\\mathrm{window}} \\approx \\kappa \\, \\Delta \\omega_{\\mathrm{rect}}$).\n\nYou must:\n1. Justify the scaling with $N$ from first principles using the integral approximation and properties of $\\int_{0}^{1} \\exp(-j 2\\pi k t) \\, dt$ for integer $k$.\n2. Determine, for each window, the location of the first positive null in $\\omega$ (in radians), and hence the null-to-null mainlobe width, in the large-$N$ limit.\n3. Report the three proportionality constants relative to the rectangular window in the order Hann, Hamming, Blackman.\n\nExpress the final answer as a row matrix containing the three proportionality constants in the order Hann, Hamming, Blackman, with no units. No numerical rounding is required. All angles are in radians.", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. There are no contradictions, missing information, or violations of scientific principles. A solution will be derived.\n\nThe Discrete-Time Fourier Transform (DTFT) of a window $w[n]$ of length $N$ is given by $W(\\omega) = \\sum_{n=0}^{N-1} w[n] \\exp(-j \\omega n)$. For large $N$, this sum can be approximated by an integral. By defining a continuous variable $t = \\frac{n}{N-1}$ for $n \\in \\{0, 1, \\dots, N-1\\}$, the discrete window $w[n]$ is modeled as samples of a continuous function $g(t)$ on the interval $t \\in [0, 1]$. The DTFT is then approximated as a Riemann sum:\n$$ W(\\omega) \\approx \\sum_{n=0}^{N-1} g\\left(\\frac{n}{N-1}\\right) \\exp\\left(-j \\omega (N-1) \\frac{n}{N-1}\\right) \\Delta n $$\nWith $\\Delta n=1$, this becomes an integral over $t$:\n$$ W(\\omega) \\approx (N-1) \\int_{0}^{1} g(t) \\exp(-j \\omega (N-1) t) \\, dt $$\nLet us define a scaled frequency variable $\\Omega = \\omega(N-1)$. The integral kernel is the continuous Fourier transform of $g(t)$ with respect to this scaled frequency:\n$$ G(\\Omega) = \\int_{0}^{1} g(t) \\exp(-j \\Omega t) \\, dt $$\nThe DTFT is then $W(\\omega) \\approx (N-1) G(\\Omega)$. The zeros of $W(\\omega)$ for large $N$ correspond to the zeros of $G(\\Omega)$.\n\nThe analysis of each window function relies on the transform of a constant function over the interval $[0, 1]$, which we denote as $S(\\Omega)$:\n$$ S(\\Omega) = \\int_{0}^{1} 1 \\cdot \\exp(-j \\Omega t) \\, dt = \\left[ \\frac{\\exp(-j \\Omega t)}{-j \\Omega} \\right]_{0}^{1} = \\frac{1 - \\exp(-j \\Omega)}{j \\Omega} $$\nThis can be written as a phase-shifted sinc function:\n$$ S(\\Omega) = \\exp(-j \\frac{\\Omega}{2}) \\frac{\\exp(j \\frac{\\Omega}{2}) - \\exp(-j \\frac{\\Omega}{2})}{j \\Omega} = \\exp(-j \\frac{\\Omega}{2}) \\frac{2j \\sin(\\frac{\\Omega}{2})}{j \\Omega} = \\exp(-j \\frac{\\Omega}{2}) \\frac{\\sin(\\frac{\\Omega}{2})}{\\frac{\\Omega}{2}} $$\nThe zeros of $S(\\Omega)$ occur when $\\sin(\\Omega/2) = 0$ but $\\Omega \\ne 0$. This gives $\\frac{\\Omega}{2} = k\\pi$ for any non-zero integer $k$, so $\\Omega = 2k\\pi$ for $k \\in \\mathbb{Z} \\setminus \\{0\\}$. At $\\Omega=0$, we have $S(0) = \\int_0^1 1 \\, dt = 1$. Consequently, for integer $m$, $S(2\\pi m) = \\delta_{m,0}$, where $\\delta$ is the Kronecker delta.\n\nWe now analyze each window in turn.\n\n1.  **Rectangular Window**\n    The continuous model is $g_{\\mathrm{rect}}(t) = 1$ for $t \\in [0, 1]$.\n    The transform is $G_{\\mathrm{rect}}(\\Omega) = \\int_{0}^{1} 1 \\cdot \\exp(-j \\Omega t) \\, dt = S(\\Omega)$.\n    The first positive zero of $S(\\Omega)$ is at $\\Omega = 2\\pi$. Since $\\Omega = \\omega(N-1)$, the first positive null of $W(\\omega)$ is at $\\omega_1 = \\frac{2\\pi}{N-1}$. The mainlobe is symmetric, so the first negative null is at $\\omega_{-1} = -\\frac{2\\pi}{N-1}$.\n    The mainlobe width is defined as the null-to-null distance:\n    $$ \\Delta \\omega_{\\mathrm{rect}} = \\omega_1 - \\omega_{-1} = \\frac{2\\pi}{N-1} - \\left(-\\frac{2\\pi}{N-1}\\right) = \\frac{4\\pi}{N-1} $$\n    This establishes the base scaling with $N$ as $\\frac{1}{N-1}$ (or $\\frac{1}{N}$ for large $N$).\n\n2.  **Hann Window**\n    The continuous model is $g_{\\mathrm{Hann}}(t) = \\frac{1}{2} - \\frac{1}{2} \\cos(2\\pi t)$. Using Euler's formula, $\\cos(x) = \\frac{1}{2}(\\exp(jx) + \\exp(-jx))$, we get:\n    $$ g_{\\mathrm{Hann}}(t) = \\frac{1}{2} - \\frac{1}{4} \\exp(j2\\pi t) - \\frac{1}{4} \\exp(-j2\\pi t) $$\n    By the linearity and frequency-shifting properties of the Fourier transform, its transform $G_{\\mathrm{Hann}}(\\Omega)$ is:\n    $$ G_{\\mathrm{Hann}}(\\Omega) = \\frac{1}{2} S(\\Omega) - \\frac{1}{4} S(\\Omega - 2\\pi) - \\frac{1}{4} S(\\Omega + 2\\pi) $$\n    We seek the first positive zero by evaluating at harmonics of $2\\pi$.\n    At $\\Omega=2\\pi$: $G_{\\mathrm{Hann}}(2\\pi) = \\frac{1}{2}S(2\\pi) - \\frac{1}{4}S(0) - \\frac{1}{4}S(4\\pi) = \\frac{1}{2}(0) - \\frac{1}{4}(1) - \\frac{1}{4}(0) = -\\frac{1}{4} \\ne 0$.\n    At $\\Omega=4\\pi$: $G_{\\mathrm{Hann}}(4\\pi) = \\frac{1}{2}S(4\\pi) - \\frac{1}{4}S(2\\pi) - \\frac{1}{4}S(6\\pi) = \\frac{1}{2}(0) - \\frac{1}{4}(0) - \\frac{1}{4}(0) = 0$.\n    The first positive zero is at $\\Omega = 4\\pi$. The first null of $W(\\omega)$ is at $\\omega_1 = \\frac{4\\pi}{N-1}$.\n    The mainlobe width is $\\Delta \\omega_{\\mathrm{Hann}} = 2 \\omega_1 = \\frac{8\\pi}{N-1}$.\n    The proportionality constant relative to the rectangular window is $\\kappa_{\\mathrm{Hann}} = \\frac{\\Delta \\omega_{\\mathrm{Hann}}}{\\Delta \\omega_{\\mathrm{rect}}} = \\frac{8\\pi/(N-1)}{4\\pi/(N-1)} = 2$.\n\n3.  **Hamming Window**\n    The continuous model is $g_{\\mathrm{Hamming}}(t) = 0.54 - 0.46 \\cos(2\\pi t)$. This has the same functional form as the Hann window, $g(t) = a_0 - a_1 \\cos(2\\pi t)$.\n    The transform is $G_{\\mathrm{Hamming}}(\\Omega) = 0.54 S(\\Omega) - 0.23 (S(\\Omega - 2\\pi) + S(\\Omega + 2\\pi))$.\n    The logic for finding zeros at harmonics of $2\\pi$ is identical.\n    At $\\Omega=2\\pi$: $G_{\\mathrm{Hamming}}(2\\pi) = 0.54 S(2\\pi) - 0.23 S(0) - 0.23 S(4\\pi) = -0.23 \\ne 0$.\n    At $\\Omega=4\\pi$: $G_{\\mathrm{Hamming}}(4\\pi) = 0.54 S(4\\pi) - 0.23 S(2\\pi) - 0.23 S(6\\pi) = 0$.\n    The first positive zero is also at $\\Omega = 4\\pi$. The mainlobe width is $\\Delta \\omega_{\\mathrm{Hamming}} = \\frac{8\\pi}{N-1}$.\n    The proportionality constant is $\\kappa_{\\mathrm{Hamming}} = \\frac{\\Delta \\omega_{\\mathrm{Hamming}}}{\\Delta \\omega_{\\mathrm{rect}}} = \\frac{8\\pi/(N-1)}{4\\pi/(N-1)} = 2$.\n\n4.  **Blackman Window**\n    The continuous model is $g_{\\mathrm{Blackman}}(t) = 0.42 - 0.5 \\cos(2\\pi t) + 0.08 \\cos(4\\pi t)$.\n    Using Euler's formula, the transform is composed of five shifted $S(\\Omega)$ functions:\n    $$ G_{\\mathrm{Blackman}}(\\Omega) = 0.42 S(\\Omega) - 0.25(S(\\Omega - 2\\pi) + S(\\Omega + 2\\pi)) + 0.04(S(\\Omega - 4\\pi) + S(\\Omega + 4\\pi)) $$\n    We check for zeros at harmonics of $2\\pi$:\n    At $\\Omega=2\\pi$: $G_{\\mathrm{Blackman}}(2\\pi) = 0.42 S(2\\pi) - 0.25(S(0)+S(4\\pi)) + 0.04(S(-2\\pi)+S(6\\pi)) = -0.25 \\ne 0$.\n    At $\\Omega=4\\pi$: $G_{\\mathrm{Blackman}}(4\\pi) = 0.42 S(4\\pi) - 0.25(S(2\\pi)+S(6\\pi)) + 0.04(S(0)+S(8\\pi)) = 0.04 \\ne 0$.\n    At $\\Omega=6\\pi$: $G_{\\mathrm{Blackman}}(6\\pi) = 0.42 S(6\\pi) - 0.25(S(4\\pi)+S(8\\pi)) + 0.04(S(2\\pi)+S(10\\pi)) = 0$.\n    The first positive zero is at $\\Omega = 6\\pi$. The first null is at $\\omega_1 = \\frac{6\\pi}{N-1}$.\n    The mainlobe width is $\\Delta \\omega_{\\mathrm{Blackman}} = 2 \\omega_1 = \\frac{12\\pi}{N-1}$.\n    The proportionality constant is $\\kappa_{\\mathrm{Blackman}} = \\frac{\\Delta \\omega_{\\mathrm{Blackman}}}{\\Delta \\omega_{\\mathrm{rect}}} = \\frac{12\\pi/(N-1)}{4\\pi/(N-1)} = 3$.\n\nIn summary, the mainlobe width for a window composed of cosines up to the $M$-th harmonic, $g(t) = \\sum_{k=0}^M a_k \\cos(2\\pi k t)$, has its first zero at $\\Omega=2\\pi(M+1)$ in this continuous approximation.\n- Rectangular: $M=0$, first null at $2\\pi$. Width factor $1$.\n- Hann/Hamming: $M=1$, first null at $4\\pi$. Width factor $2$.\n- Blackman: $M=2$, first null at $6\\pi$. Width factor $3$.\n\nThe proportionality constants for Hann, Hamming, and Blackman windows relative to the rectangular window are $2$, $2$, and $3$ respectively.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2 & 2 & 3\n\\end{pmatrix}\n}\n$$", "id": "2895210"}, {"introduction": "While mainlobe width describes frequency resolution, the Equivalent Noise Bandwidth (ENBW) quantifies how a window affects the random noise floor of a spectrum. The ENBW tells us the bandwidth of an idealized \"brick-wall\" filter that would pass the same amount of noise power as the window's actual spectral shape. This exercise guides you through a foundational derivation of the ENBW for common windows, providing a concrete metric for comparing their performance in noise. [@problem_id:2895221]", "problem": "An engineer uses three widely employed deterministic tapers—Hann (also called Hanning), Hamming, and Blackman—on a length-$N$ discrete-time record prior to computing a length-$N$ Discrete Fourier Transform (DFT). The cosine-sum windows are defined for $n \\in \\{0,1,\\dots,N-1\\}$ by\n- Hann: $w_{\\mathrm{Hann}}[n] = \\tfrac{1}{2} - \\tfrac{1}{2}\\cos\\!\\big(2\\pi n/(N-1)\\big)$,\n- Hamming: $w_{\\mathrm{Ham}}[n] = 0.54 - 0.46\\cos\\!\\big(2\\pi n/(N-1)\\big)$,\n- Blackman: $w_{\\mathrm{Blk}}[n] = 0.42 - 0.50\\cos\\!\\big(2\\pi n/(N-1)\\big) + 0.08\\cos\\!\\big(4\\pi n/(N-1)\\big)$,\n\nwhere all cosine arguments are in radians.\n\nConsider the Equivalent Noise Bandwidth (ENBW), defined as the bandwidth of an ideal rectangular filter that would pass the same mean noise power at the DFT output bin center as the actual windowed spectral response, when the input is discrete-time white noise with flat power spectral density. Work in the standard DFT frequency normalization where one bin corresponds to a frequency spacing of $1/N$ cycles per sample, so that the rectangular (no window) baseline ENBW is $1.0$ bin.\n\nStarting from the above definition of ENBW, Parseval’s theorem, and the Riemann-sum limit connecting sums to integrals as $N \\to \\infty$, derive an expression for the ENBW in units of DFT bins in the large-$N$ limit that depends only on window sample averages, and then evaluate it for the three windows given above. Report the three asymptotic ENBWs (in bins) in the order Hann, Hamming, Blackman. Round each value to four significant figures. Express the final answer as a single row vector.", "solution": "We begin from the definition of Equivalent Noise Bandwidth (ENBW) for a deterministic window $w[n]$ applied to white noise with flat power spectral density. The ENBW, in frequency units consistent with the discrete-time Fourier transform over normalized frequency $f \\in [-\\tfrac{1}{2}, \\tfrac{1}{2}]$ (cycles per sample), is\n$$\nB_{\\mathrm{e}} \\equiv \\frac{\\displaystyle \\int_{-1/2}^{1/2} \\big|W(f)\\big|^{2}\\,df}{\\displaystyle \\big|W(0)\\big|^{2}},\n$$\nwhere $W(f) = \\sum_{n=0}^{N-1} w[n]\\exp(-j 2\\pi f n)$ is the window’s frequency response and $W(0) = \\sum_{n=0}^{N-1} w[n]$. To express ENBW in DFT “bins,” we divide by the bin spacing $\\Delta f = 1/N$, yielding\n$$\n\\text{ENBW (bins)} \\;=\\; \\frac{B_{\\mathrm{e}}}{\\Delta f} \\;=\\; N \\,\\frac{\\displaystyle \\int_{-1/2}^{1/2} \\big|W(f)\\big|^{2}\\,df}{\\displaystyle \\big|W(0)\\big|^{2}}.\n$$\nBy Parseval’s theorem for the continuous-frequency Discrete-Time Fourier Transform (DTFT) convention used here,\n$$\n\\int_{-1/2}^{1/2} \\big|W(f)\\big|^{2}\\,df \\;=\\; \\sum_{n=0}^{N-1} w[n]^{2}.\n$$\nHence,\n$$\n\\text{ENBW (bins)} \\;=\\; N \\,\\frac{\\displaystyle \\sum_{n=0}^{N-1} w[n]^{2}}{\\displaystyle \\Big(\\sum_{n=0}^{N-1} w[n]\\Big)^{2}}.\n$$\nWe now consider the large-$N$ limit for cosine-sum windows of the form $w[n] = g\\!\\big(\\tfrac{n}{N-1}\\big)$, where $g$ is smooth on $[0,1]$. Define the normalized index $x \\equiv n/(N-1) \\in [0,1]$. As $N \\to \\infty$, Riemann sums converge to integrals:\n$$\n\\sum_{n=0}^{N-1} w[n] \\;\\approx\\; N \\int_{0}^{1} g(x)\\,dx \\;\\equiv\\; N\\,\\mu,\n\\quad\n\\sum_{n=0}^{N-1} w[n]^{2} \\;\\approx\\; N \\int_{0}^{1} g(x)^{2}\\,dx \\;\\equiv\\; N\\,\\nu,\n$$\nwhere $\\mu$ and $\\nu$ are the first and second moment (means) of $w$ and $w^{2}$ over $x \\in [0,1]$, respectively. Therefore, the asymptotic ENBW in bins is\n$$\n\\lim_{N\\to\\infty} \\text{ENBW} \\;=\\; \\lim_{N\\to\\infty} N \\,\\frac{N\\,\\nu}{(N\\,\\mu)^{2}} \\;=\\; \\frac{\\nu}{\\mu^{2}}.\n$$\nThus, it suffices to compute $\\mu$ and $\\nu$ for each window by averaging over $x \\in [0,1]$ using orthogonality of cosines:\n$$\n\\int_{0}^{1}\\cos(2\\pi k x)\\,dx = 0 \\;\\text{for}\\; k \\in \\mathbb{Z}\\setminus\\{0\\}, \n\\qquad\n\\int_{0}^{1}\\cos^{2}(2\\pi k x)\\,dx = \\frac{1}{2} \\;\\text{for}\\; k \\in \\mathbb{Z}\\setminus\\{0\\},\n$$\nand mixed products of different harmonics integrate to zero.\n\nHann window. Let $w(x) = \\tfrac{1}{2} - \\tfrac{1}{2}\\cos(2\\pi x)$. Then\n$$\n\\mu_{\\text{Hann}} = \\int_{0}^{1} \\Big(\\tfrac{1}{2} - \\tfrac{1}{2}\\cos(2\\pi x)\\Big)\\,dx = \\tfrac{1}{2},\n$$\nand\n\\begin{align*}\n\\nu_{\\text{Hann}} &= \\int_{0}^{1} \\Big(\\tfrac{1}{2} - \\tfrac{1}{2}\\cos(2\\pi x)\\Big)^{2} dx \\\\\n&= \\int_{0}^{1} \\Big(\\tfrac{1}{4} - \\tfrac{1}{2}\\cos(2\\pi x) + \\tfrac{1}{4}\\cos^{2}(2\\pi x)\\Big) dx \\\\\n&= \\tfrac{1}{4} + \\tfrac{1}{4}\\cdot \\tfrac{1}{2} \\;=\\; \\tfrac{3}{8}.\n\\end{align*}\nHence\n$$\n\\text{ENBW}_{\\text{Hann}} = \\frac{\\nu_{\\text{Hann}}}{\\mu_{\\text{Hann}}^{2}} = \\frac{\\tfrac{3}{8}}{(\\tfrac{1}{2})^{2}} = \\frac{3}{2} = 1.5 \\;\\text{bins}.\n$$\n\nHamming window. Let $w(x) = 0.54 - 0.46\\cos(2\\pi x)$. Then\n$$\n\\mu_{\\text{Ham}} = 0.54,\n$$\nand\n\\begin{align*}\n\\nu_{\\text{Ham}} &= \\int_{0}^{1} \\big(0.54 - 0.46\\cos(2\\pi x)\\big)^{2} dx \\\\\n&= 0.54^{2} + 0.46^{2}\\cdot \\tfrac{1}{2} \\\\\n&= \\frac{27^{2}}{50^{2}} + \\frac{1}{2}\\cdot \\frac{23^{2}}{50^{2}} \\\\\n&= \\frac{1987}{5000}.\n\\end{align*}\nThus\n$$\n\\text{ENBW}_{\\text{Ham}} = \\frac{\\nu_{\\text{Ham}}}{\\mu_{\\text{Ham}}^{2}} = \\frac{\\tfrac{1987}{5000}}{(\\tfrac{27}{50})^{2}} = \\frac{1987}{1458} \\approx 1.3628\\ \\text{bins}.\n$$\n\nBlackman window. Let $w(x) = 0.42 - 0.50\\cos(2\\pi x) + 0.08\\cos(4\\pi x)$. Then\n$$\n\\mu_{\\text{Blk}} = 0.42,\n$$\nand, using orthogonality to eliminate cross terms,\n\\begin{align*}\n\\nu_{\\text{Blk}} &= \\int_{0}^{1} \\Big(0.42 - 0.50\\cos(2\\pi x) + 0.08\\cos(4\\pi x)\\Big)^{2} dx \\\\\n&= 0.42^{2} + \\tfrac{1}{2}(0.50)^{2} + \\tfrac{1}{2}(0.08)^{2} \\\\\n&= \\frac{441}{2500} + \\frac{1}{8} + \\frac{2}{625} \\\\\n&= \\frac{1523}{5000}.\n\\end{align*}\nTherefore,\n$$\n\\text{ENBW}_{\\text{Blk}} = \\frac{\\nu_{\\text{Blk}}}{\\mu_{\\text{Blk}}^{2}} = \\frac{\\tfrac{1523}{5000}}{(\\tfrac{21}{50})^{2}} = \\frac{1523}{882} \\approx 1.7268\\ \\text{bins}.\n$$\n\nFor comparison, the rectangular window has $w[n] \\equiv 1$, so $\\mu = 1$ and $\\nu = 1$, giving $\\text{ENBW} = 1.0$ bin, which is the baseline specified.\n\nRounding each asymptotic value to four significant figures and listing in the order Hann, Hamming, Blackman, we obtain the requested row vector in bin units.", "answer": "$$\\boxed{\\begin{pmatrix} 1.500 & 1.363 & 1.727 \\end{pmatrix}}$$", "id": "2895221"}, {"introduction": "We have seen that tapered windows broaden the mainlobe and increase the equivalent noise bandwidth compared to a simple rectangular window. This naturally raises a critical question: under what circumstances is a tapered window actually better? This practice synthesizes these concepts by placing you in a realistic signal detection scenario, forcing you to analyze the trade-offs between processing gain, scalloping loss, and noise performance. You will explore why the theoretically optimal rectangular window can fail in practical situations where signal frequencies do not align perfectly with DFT bins. [@problem_id:2895198]", "problem": "A real-valued, narrowband sinusoid in additive white Gaussian noise is observed over a finite record of length $N$ samples at sampling frequency $f_s$. The data model is\n$$\nx[n] \\;=\\; A\\cos\\!\\Big(2\\pi \\tfrac{f_0}{f_s}\\,n + \\phi\\Big) + v[n],\\quad n=0,1,\\dots,N-1,\n$$\nwhere $A>0$ and $\\phi$ are deterministic but unknown, and $\\{v[n]\\}$ is zero-mean, independent and identically distributed Gaussian noise with variance $\\sigma^2$. Prior to forming the Discrete Fourier Transform (DFT), the data are multiplied by a deterministic, real, even window $w[n]$ supported on $0\\le n\\le N-1$, with $w[0]=w[N-1]=0$ for tapered windows and $w[n]=1$ for a rectangular window. Let\n$$\nX_w[k] \\;=\\; \\sum_{n=0}^{N-1} w[n]\\,x[n]\\,e^{-j 2\\pi kn/N},\\quad k\\in\\{0,1,\\dots,N-1\\}.\n$$\nConsider the single-bin detection statistic that measures the magnitude at the “closest” DFT bin to the sinusoid’s frequency. Two regimes are of interest:\n\n- Regime $\\mathcal{C}$ (coherent sampling): $f_0 = k_0 f_s/N$ for some integer $k_0$ (so the sinusoid completes an integer number of periods in the record).\n\n- Regime $\\mathcal{M}$ (mismatch/jitter): $f_0 = (k_0+\\delta)\\, f_s/N$ with $0<|\\delta|<\\tfrac{1}{2}$ and/or there is small timing jitter such that the phase samples are perturbed as $\\phi \\mapsto \\phi + \\epsilon[n]$ with $\\epsilon[n]$ zero-mean, independent and identically distributed, and $\\operatorname{Var}(\\epsilon[n])=\\sigma_\\phi^2$ that is small but nonzero.\n\nFor a fixed window $w[n]$, define the single-bin signal-to-noise ratio (SNR) at the chosen bin $k^\\star$ as the ratio of the expected signal power contribution in $X_w[k^\\star]$ to the expected noise power contribution in $X_w[k^\\star]$, where the expectation is over the noise (and also over the jitter in regime $\\mathcal{M}$ when present). Assume that in regime $\\mathcal{M}$ the detector selects the bin $k^\\star$ that maximizes $|X_w[k]|$ over $k\\in\\{k_0-1,k_0,k_0+1\\}$.\n\nWhich of the following statements are valid, based on first principles of windowed spectral analysis, the DFT, and the equivalent noise bandwidth concept, when comparing a rectangular window against Hann, Hamming, and Blackman windows?\n\nA. In regime $\\mathcal{C}$, the rectangular window achieves a strictly higher single-bin SNR at $k^\\star=k_0$ than the Hann, Hamming, and Blackman windows.\n\nB. In regime $\\mathcal{M}$ with small but nonzero $|\\delta|$ and/or small but nonzero $\\sigma_\\phi^2$, a tapered window (Hann, Hamming, or Blackman) can yield a higher peak single-bin SNR than the rectangular window because reduced spectral leakage and reduced scalloping loss can dominate the increase in equivalent noise bandwidth.\n\nC. In regime $\\mathcal{C}$, the Hamming window matches the rectangular window’s single-bin SNR at $k^\\star=k_0$ due to its reduced side-lobes.\n\nD. In regime $\\mathcal{M}$ with small detuning $|\\delta|<\\tfrac{1}{4}$ and small $\\sigma_\\phi^2$, the Blackman window always beats both Hann and Hamming in single-bin SNR because it has the lowest side-lobes among the three tapered windows.\n\nSelect all that apply. Justify your choice by appealing to definitions of windowing in the time domain, convolution in the frequency domain, and how window properties control signal concentration and noise power per DFT bin. Do not assume any particular numerical values for the windows’ parameters beyond their standard textbook definitions; your reasoning should rest on their qualitative and quantitative properties as established in classical spectral analysis.", "solution": "The problem asks for an evaluation of several statements comparing the performance of different spectral analysis windows (rectangular, Hann, Hamming, Blackman) for single-tone detection in noise. The performance metric is the single-bin signal-to-noise ratio (SNR). I shall first validate the problem statement and then proceed to a rigorous derivation based on first principles.\n\nThe problem statement is valid. It is scientifically grounded in the established theory of digital signal processing and spectral analysis. It is well-posed, providing a clear data model, definitions of two operational regimes, and a precise definition for the SNR. The terminology is standard and the question is objective. No flaws are identified.\n\nLet us define the quantities of interest. The windowed Discrete Fourier Transform (DFT) of the signal $x[n] = s[n] + v[n]$ is given by $X_w[k] = S_w[k] + V_w[k]$, where $s[n] = A\\cos(2\\pi \\frac{f_0}{f_s} n + \\phi)$ is the sinusoid and $v[n]$ is additive white Gaussian noise with variance $\\sigma^2$.\n\nThe expected noise power in any DFT bin $k$ is calculated as:\n$$\nE[|V_w[k]|^2] = E\\left[\\left|\\sum_{n=0}^{N-1} w[n]v[n]e^{-j 2\\pi kn/N}\\right|^2\\right] = \\sum_{n=0}^{N-1}\\sum_{m=0}^{N-1} w[n]w[m]e^{-j 2\\pi k(n-m)/N} E[v[n]v[m]]\n$$\nSince the noise is white, $E[v[n]v[m]] = \\sigma^2 \\delta_{nm}$, where $\\delta_{nm}$ is the Kronecker delta.\n$$\nE[|V_w[k]|^2] = \\sigma^2 \\sum_{n=0}^{N-1} w[n]^2\n$$\nThis quantity, which we denote $P_{noise}$, is the noise power per bin. It depends on the window's energy, $\\sum_{n=0}^{N-1} w[n]^2$, but is constant across all frequency bins $k$.\n\nThe signal component of the DFT is the transform of the windowed sinusoid, $s[n]$. Representing the cosine using Euler's formula, we have:\n$$\ns[n] = \\frac{A}{2} \\left( e^{j(2\\pi \\frac{f_0}{f_s} n + \\phi)} + e^{-j(2\\pi \\frac{f_0}{f_s} n + \\phi)} \\right)\n$$\nLet $W(\\omega) = \\sum_{n=0}^{N-1} w[n] e^{-j\\omega n}$ be the Discrete-Time Fourier Transform (DTFT) of the window $w[n]$. The signal component in the DFT is:\n$$\nS_w[k] = \\frac{A}{2}e^{j\\phi} W\\left(\\frac{2\\pi k}{N} - \\frac{2\\pi f_0}{f_s}\\right) + \\frac{A}{2}e^{-j\\phi} W\\left(\\frac{2\\pi k}{N} + \\frac{2\\pi f_0}{f_s}\\right)\n$$\nAssuming the frequency $f_0$ is positive and not near $0$ or $f_s/2$, for bins $k$ near the signal frequency, the second term is negligible. Thus, the signal power in bin $k$ is approximately:\n$$\n|S_w[k]|^2 \\approx \\frac{A^2}{4} \\left| W\\left(2\\pi \\frac{k - N f_0/f_s}{N}\\right) \\right|^2\n$$\nThe single-bin SNR at a chosen bin $k^\\star$ is defined as $SNR_{k^\\star} = E[|S_w[k^\\star]|^2] / E[|V_w[k^\\star]|^2]$. The expectation is over the noise $v[n]$ and any jitter $\\epsilon[n]$. The noise in the signal and the additive noise are independent, so the denominator is simply $P_{noise}$.\n\nNow, let us analyze each regime and evaluate the given options.\n\n**Analysis of Regime $\\mathcal{C}$ (Coherent Sampling)**\nIn this regime, $f_0 = k_0 f_s/N$ for some integer $k_0$, and there is no jitter. The signal frequency aligns perfectly with the center of bin $k_0$. We select $k^\\star=k_0$. The argument of the window's DTFT becomes $0$:\n$$\nE[|S_w[k_0]|^2] = |S_w[k_0]|^2 \\approx \\frac{A^2}{4} |W(0)|^2 = \\frac{A^2}{4} \\left(\\sum_{n=0}^{N-1} w[n]\\right)^2\n$$\nThe quantity $\\sum w[n]$ is the coherent gain of the window. The SNR is then:\n$$\nSNR_{k_0, \\mathcal{C}} = \\frac{\\frac{A^2}{4} \\left(\\sum_{n=0}^{N-1} w[n]\\right)^2}{\\sigma^2 \\sum_{n=0}^{N-1} w[n]^2} = \\frac{A^2}{4\\sigma^2} \\frac{\\left(\\sum_{n=0}^{N-1} w[n]\\right)^2}{\\sum_{n=0}^{N-1} w[n]^2}\n$$\nThe term $G_p(w) = \\frac{(\\sum w[n])^2}{\\sum w[n]^2}$ is known as the processing gain. By the Cauchy-Schwarz inequality, for any real sequences $a_n, b_n$, we have $(\\sum a_n b_n)^2 \\le (\\sum a_n^2)(\\sum b_n^2)$. Let $a_n = w[n]$ and $b_n=1$. Then $(\\sum w[n])^2 \\le (\\sum w[n]^2)(\\sum 1^2) = N \\sum w[n]^2$.\nSo, $G_p(w) \\le N$. Equality holds if and only if $w[n]$ is a constant sequence.\nFor the rectangular window, $w_{rect}[n] = 1$ for all $n$.\n$G_p(w_{rect}) = \\frac{(\\sum 1)^2}{\\sum 1^2} = \\frac{N^2}{N} = N$.\nFor any non-constant tapered window (Hann, Hamming, Blackman), $w[n]$ is not constant, so the inequality is strict: $G_p(w_{taper}) < N$.\nTherefore, the rectangular window provides the highest possible processing gain and thus the highest SNR in the coherent case.\n\n**Analysis of Regime $\\mathcal{M}$ (Mismatch/Jitter)**\nIn this regime, we have frequency mismatch, $f_0 = (k_0+\\delta) f_s/N$ with $0 < |\\delta| < 1/2$, and/or phase jitter $\\epsilon[n]$.\nLet us first consider the effect of frequency mismatch $\\delta$. The signal peak is shifted from the bin center. The signal power at bin $k_0$ is affected by the window's DTFT shape:\n$$\n|S_w[k_0]|^2 \\approx \\frac{A^2}{4} |W(2\\pi\\delta/N)|^2\n$$\nThe loss of power due to $|W(2\\pi\\delta/N)| < |W(0)|$ is called scalloping loss. The rectangular window has the narrowest main lobe, which means $|W_{rect}(2\\pi\\delta/N)|$ decreases more rapidly with $|\\delta|$ than for tapered windows, which have wider main lobes. Consequently, the rectangular window suffers the most severe scalloping loss.\nFor example, at the point of maximum mismatch between bins, $\\delta=0.5$, the power for a rectangular window drops by approximately $10 \\log_{10}((2/\\pi)^2) \\approx 3.9$ dB. For a Hann window, the maximum scalloping loss is much smaller, about $1.4$ dB.\nThe SNR in this case is $SNR_{k^\\star, \\mathcal{M}} \\propto |W(2\\pi\\delta'/N)|^2 / \\sum w[n]^2$, where $\\delta'$ is the distance to the chosen peak bin $k^\\star$. While the rectangular window has the highest processing gain at $\\delta=0$, this gain can be catastrophically eroded by scalloping loss for even small $\\delta$. A tapered window, despite its lower processing gain at $\\delta=0$, retains a much larger fraction of its signal power due to its wider main lobe. The lower scalloping loss can more than compensate for the initial processing gain deficit, resulting in a higher SNR.\nPhase jitter has a similar effect. It broadens the signal's spectral line, transferring power from the coherent peak to a broader pedestal. This power reduction at the peak is more severe for windows with narrower main lobes. The rectangular window, having the narrowest possible main lobe, is most sensitive to this effect.\n\nWith this foundation, we evaluate the options.\n\n**A. In regime $\\mathcal{C}$, the rectangular window achieves a strictly higher single-bin SNR at $k^\\star=k_0$ than the Hann, Hamming, and Blackman windows.**\nAs derived from the Cauchy-Schwarz inequality, the processing gain factor $G_p(w) = (\\sum w[n])^2 / (\\sum w[n]^2)$ is strictly maximized for a constant window function. All standard tapered windows are non-constant. Therefore, the rectangular window achieves a strictly higher SNR.\nVerdict: **Correct**.\n\n**B. In regime $\\mathcal{M}$ with small but nonzero $|\\delta|$ and/or small but nonzero $\\sigma_\\phi^2$, a tapered window (Hann, Hamming, or Blackman) can yield a higher peak single-bin SNR than the rectangular window because reduced spectral leakage and reduced scalloping loss can dominate the increase in equivalent noise bandwidth.**\nOur analysis of Regime $\\mathcal{M}$ confirms this. The rectangular window's superior processing gain at $\\delta=0$ is fragile. Its narrow main lobe leads to high scalloping loss from frequency mismatch and high sensitivity to phase jitter. Tapered windows are more robust due to their wider main lobes. For a sufficient mismatch, the signal power retained by a tapered window can be significantly greater than that retained by a rectangular window, enough to overcome the rectangular window's advantage in noise performance ($\\sum w_{rect}^2 = N$ vs. $\\sum w_{taper}^2 < N$) and its ideal processing gain. The qualitative reasoning in the statement is sound, although the primary effect is scalloping loss domination, not leakage in this single-tone context. The term \"increase in equivalent noise bandwidth\" is correct when windows are normalized for coherent gain, and represents the trade-off. Hence, a tapered window *can* yield a higher SNR.\nVerdict: **Correct**.\n\n**C. In regime $\\mathcal{C}$, the Hamming window matches the rectangular window’s single-bin SNR at $k^\\star=k_0$ due to its reduced side-lobes.**\nThis is false. As shown for option A, in regime $\\mathcal{C}$ the rectangular window's SNR is strictly the highest. The Hamming window, being a tapered window, has a lower processing gain $G_p(w_{hamm}) < N$. Its SNR will be strictly lower. Reduced side-lobes are irrelevant for single-tone SNR in the perfectly coherent case.\nVerdict: **Incorrect**.\n\n**D. In regime $\\mathcal{M}$ with small detuning $|\\delta|<\\tfrac{1}{4}$ and small $\\sigma_\\phi^2$, the Blackman window always beats both Hann and Hamming in single-bin SNR because it has the lowest side-lobes among the three tapered windows.**\nThis statement is incorrect for two reasons. First, the claim \"always beats\" is too strong. Among Hann, Hamming, and Blackman windows, there is a trade-off. The Hamming window has a higher processing gain at $\\delta=0$ than the Blackman window. The Blackman window has a wider main lobe and thus less scalloping loss. For very small $|\\delta|$, the higher processing gain of the Hamming window will dominate, leading to a higher SNR. As $|\\delta|$ increases, the lower scalloping loss of the Blackman window will eventually make it superior. There is a crossover point; one does not \"always\" beat the other. Second, the reason given (\"lowest side-lobes\") is not the dominant factor. The relevant property for this single-tone detection scenario is the main lobe width (which governs scalloping loss) and the processing gain at $\\delta=0$, not the far-out side-lobe suppression.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{AB}$$", "id": "2895198"}]}