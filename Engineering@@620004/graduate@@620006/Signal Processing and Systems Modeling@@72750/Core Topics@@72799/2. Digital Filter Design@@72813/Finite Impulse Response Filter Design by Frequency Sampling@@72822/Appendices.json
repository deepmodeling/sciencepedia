{"hands_on_practices": [{"introduction": "A powerful aspect of the frequency sampling method is the direct control it provides over specific points in a filter's frequency response. This first exercise explores the most fundamental of these control points: the DC gain. By working through this problem, you will solidify your understanding of the direct relationship between the frequency sample at zero frequency, $H(0)$, and the average value of the filter's impulse response, $h[n]$, a crucial link for controlling a filter's baseline behavior [@problem_id:1719160].", "problem": "An engineer is designing a digital Finite Impulse Response (FIR) filter of length $N=50$ for an audio processing application. The design is based on the frequency sampling method, where the filter's characteristics are defined by specifying $N$ samples, $H(k)$, of the desired frequency response at the normalized angular frequencies $\\omega_k = \\frac{2\\pi k}{N}$ for $k = 0, 1, \\dots, N-1$. A critical performance requirement for this filter is that the arithmetic average of all its impulse response coefficients, $h[n]$ for $n = 0, 1, \\dots, N-1$, must be precisely $0.15$.\n\nTo satisfy this design constraint, what numerical value must be assigned to the frequency sample $H(k)$ at the frequency corresponding to $k=0$? Express your answer as a single real number.", "solution": "The problem asks for the value of the frequency sample $H(0)$ for a length-$N$ FIR filter such that the arithmetic average of its impulse response coefficients $h[n]$ is a specific value.\n\nLet the FIR filter have an impulse response $h[n]$ for $n=0, 1, \\dots, N-1$. The length of the filter is given as $N=50$.\nThe problem states that the arithmetic average of the impulse response coefficients must be $0.15$. We can write this condition mathematically as:\n$$\n\\frac{1}{N} \\sum_{n=0}^{N-1} h[n] = 0.15\n$$\nFrom this expression, we can find the required sum of the impulse response coefficients:\n$$\n\\sum_{n=0}^{N-1} h[n] = N \\times 0.15\n$$\n\nThe frequency response of the FIR filter is given by the Discrete-Time Fourier Transform (DTFT) of its impulse response $h[n]$:\n$$\nH(e^{j\\omega}) = \\sum_{n=0}^{N-1} h[n] e^{-j\\omega n}\n$$\nThe DC gain of the filter is its frequency response evaluated at zero frequency, i.e., at $\\omega=0$.\n$$\nH(e^{j0}) = \\sum_{n=0}^{N-1} h[n] e^{-j(0)n} = \\sum_{n=0}^{N-1} h[n] (1) = \\sum_{n=0}^{N-1} h[n]\n$$\nThus, the sum of the impulse response coefficients is equal to the DC gain of the filter.\n\nIn the frequency sampling method of FIR filter design, the filter's frequency response is specified by $N$ samples, $H(k)$, taken at evenly spaced frequencies $\\omega_k = \\frac{2\\pi k}{N}$ for $k=0, 1, \\dots, N-1$. Each sample $H(k)$ is a sample of the continuous frequency response $H(e^{j\\omega})$ at the corresponding frequency $\\omega_k$.\n$$\nH(k) = H(e^{j\\omega_k}) = H\\left(e^{j \\frac{2\\pi k}{N}}\\right)\n$$\nWe are interested in the sample at $k=0$. The frequency for this sample is $\\omega_0 = \\frac{2\\pi(0)}{N} = 0$.\nTherefore, the frequency sample $H(0)$ is the value of the frequency response at $\\omega=0$:\n$$\nH(0) = H(e^{j0})\n$$\nThis means that the frequency sample $H(0)$ is exactly equal to the DC gain of the filter.\n\nBy combining our findings, we can relate $H(0)$ to the sum of the impulse response coefficients:\n$$\nH(0) = H(e^{j0}) = \\sum_{n=0}^{N-1} h[n]\n$$\nAnd from the problem's constraint, we know:\n$$\n\\sum_{n=0}^{N-1} h[n] = N \\times 0.15\n$$\nTherefore, we can conclude that:\n$$\nH(0) = N \\times 0.15\n$$\nThe problem specifies the filter length $N=50$. Substituting this value into the equation:\n$$\nH(0) = 50 \\times 0.15\n$$\n$$\nH(0) = 7.5\n$$\nSo, to meet the design constraint, the frequency sample at $k=0$ must be set to 7.5.", "answer": "$$\\boxed{7.5}$$", "id": "1719160"}, {"introduction": "While specifying individual frequency samples is the core of this design method, a deeper understanding comes from seeing how the complete impulse response arises from these discrete points. This practice moves from simple calculation to a full analytical derivation, challenging you to derive the closed-form impulse response for an idealized low-pass filter [@problem_id:2871626]. This exercise reveals the underlying mathematical structure, related to the Dirichlet kernel, that governs the interpolation between your chosen frequency samples and shapes the filter's final performance.", "problem": "A length-$L$ finite impulse response (FIR) filter with $L=21$ is to be designed by the frequency sampling method to have Type I linear phase (odd length, even symmetry). Let the group delay be $\\tau = \\frac{L-1}{2} = 10$. To enforce linear phase in the frequency-sampled design, define real and even amplitude samples $A[k]$ on the $N$-point frequency grid with $N=L=21$ as $A[k]=1$ for frequency indices $k$ corresponding to $|k|\\le 3$ modulo $N$ (that is, $k\\in\\{0,\\pm 1,\\pm 2,\\pm 3\\}$ mapped into $\\{0,1,\\dots,20\\}$), and $A[k]=0$ otherwise. The complex frequency samples are then constructed by imposing the linear-phase factor as $H[k] = A[k]\\exp(-j 2\\pi k \\tau/N)$. \n\nStarting only from the definitions of the discrete-time Fourier transform pair on an $N$-point grid and the linear-phase decomposition $H(\\mathrm{e}^{j\\omega})=\\mathrm{e}^{-j\\omega \\tau}A(\\mathrm{e}^{j\\omega})$ with $A(\\mathrm{e}^{j\\omega})$ real and even, derive the exact closed-form expression for the impulse response $h[n]$ for $0\\le n \\le 20$ by analytically summing the relevant finite sum of complex exponentials. All angles are in radians. Express your final result as a single simplified analytic formula valid for all integer $n$ (with the natural continuous extension at removable singularities). Do not round your answer.", "solution": "The problem statement is evaluated and deemed valid. It is scientifically grounded, well-posed, and objective, presenting a standard problem in digital signal processing without contradictions or missing information. We proceed to derive the solution.\n\nThe impulse response $h[n]$ of the finite impulse response (FIR) filter is obtained by computing the $N$-point Inverse Discrete Fourier Transform (IDFT) of its frequency samples $H[k]$. The definition of the IDFT is:\n$$\nh[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} H[k] \\exp\\left(j \\frac{2\\pi k n}{N}\\right), \\quad n \\in \\{0, 1, \\dots, N-1\\}\n$$\nThe problem provides the following parameters: a filter length $L=21$, a corresponding number of frequency samples $N=L=21$, and a group delay $\\tau = \\frac{L-1}{2}=10$. The complex frequency samples $H[k]$ are defined as $H[k] = A[k]\\exp\\left(-j \\frac{2\\pi k \\tau}{N}\\right)$, where the amplitude samples $A[k]$ are specified.\n\nSubstituting the expression for $H[k]$ into the IDFT formula, we obtain:\n$$\nh[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} A[k] \\exp\\left(-j \\frac{2\\pi k \\tau}{N}\\right) \\exp\\left(j \\frac{2\\pi k n}{N}\\right)\n$$\nCombining the exponential terms yields:\n$$\nh[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} A[k] \\exp\\left(j \\frac{2\\pi k (n-\\tau)}{N}\\right)\n$$\nWe are given $N=21$ and $\\tau=10$. The amplitude samples $A[k]$ are non-zero only for a specific set of indices. Specifically, $A[k]=1$ for $|k| \\le 3$ modulo $N$. For the range of indices $k \\in \\{0, 1, \\dots, 20\\}$, this corresponds to $k \\in \\{0, 1, 2, 3\\}$ and $k \\in \\{21-3, 21-2, 21-1\\}$, i.e., $k \\in \\{18, 19, 20\\}$. For all other values of $k$ in this range, $A[k]=0$.\n\nTherefore, the summation reduces to only these $7$ terms:\n$$\nh[n] = \\frac{1}{21} \\sum_{k \\in \\{0,1,2,3,18,19,20\\}} \\exp\\left(j \\frac{2\\pi k (n-10)}{21}\\right)\n$$\nThis sum can be split and rearranged as:\n$$\nh[n] = \\frac{1}{21} \\left[ \\sum_{k=0}^{3} \\exp\\left(j \\frac{2\\pi k (n-10)}{21}\\right) + \\sum_{k=18}^{20} \\exp\\left(j \\frac{2\\pi k (n-10)}{21}\\right) \\right]\n$$\nTo simplify, we can re-index the second sum. Let $k' = k - 21$. For $k \\in \\{18, 19, 20\\}$, $k'$ takes values $\\{-3, -2, -1\\}$. The exponential term becomes:\n$$\n\\exp\\left(j \\frac{2\\pi (k'+21) (n-10)}{21}\\right) = \\exp\\left(j \\frac{2\\pi k' (n-10)}{21}\\right) \\exp\\left(j 2\\pi (n-10)\\right)\n$$\nSince $n$ is an integer, $n-10$ is an integer, and thus $\\exp\\left(j 2\\pi (n-10)\\right) = 1$. So, the second sum is equivalent to a sum over negative indices:\n$$\n\\sum_{k=18}^{20} \\exp\\left(j \\frac{2\\pi k (n-10)}{21}\\right) = \\sum_{k'=-3}^{-1} \\exp\\left(j \\frac{2\\pi k' (n-10)}{21}\\right)\n$$\nCombining the re-indexed sum with the sum from $k=0$ to $k=3$ results in a single, symmetric sum:\n$$\nh[n] = \\frac{1}{21} \\sum_{k=-3}^{3} \\exp\\left(j \\frac{2\\pi k (n-10)}{21}\\right)\n$$\nThis is a finite sum of a geometric series. Let $\\theta_n = \\frac{2\\pi (n-10)}{21}$. The sum is $\\sum_{k=-3}^{3} (\\exp(j\\theta_n))^k$. This sum has a well-known closed-form expression related to the Dirichlet kernel, $D_M(x) = \\sum_{k=-M}^{M} e^{ikx} = \\frac{\\sin((M+1/2)x)}{\\sin(x/2)}$.\n\nApplying this identity with $M=3$ and $x = \\theta_n$, we get:\n$$\n\\sum_{k=-3}^{3} \\exp(j k \\theta_n) = \\frac{\\sin\\left(\\left(3+\\frac{1}{2}\\right)\\theta_n\\right)}{\\sin\\left(\\frac{1}{2}\\theta_n\\right)} = \\frac{\\sin(3.5 \\, \\theta_n)}{\\sin(0.5 \\, \\theta_n)}\n$$\nSubstituting this back into the expression for $h[n]$ and replacing $\\theta_n$ with its definition:\n$$\nh[n] = \\frac{1}{21} \\frac{\\sin\\left(3.5 \\cdot \\frac{2\\pi (n-10)}{21}\\right)}{\\sin\\left(0.5 \\cdot \\frac{2\\pi (n-10)}{21}\\right)}\n$$\nSimplifying the arguments of the sine functions:\n$$\nh[n] = \\frac{1}{21} \\frac{\\sin\\left(\\frac{7\\pi (n-10)}{21}\\right)}{\\sin\\left(\\frac{\\pi (n-10)}{21}\\right)} = \\frac{1}{21} \\frac{\\sin\\left(\\frac{\\pi (n-10)}{3}\\right)}{\\sin\\left(\\frac{\\pi (n-10)}{21}\\right)}\n$$\nThis expression is valid for all integer $n$. A special case occurs when the denominator is zero, which happens when $\\frac{\\pi (n-10)}{21}$ is an integer multiple of $\\pi$. For $n \\in \\{0, 1, \\dots, 20\\}$, this only occurs at $n=10$. In this case, the expression becomes an indeterminate form $0/0$. The value of $h[10]$ is found by taking the limit as $n \\to 10$, which corresponds to the L'Hôpital's rule for the continuous extension of the function, or by direct evaluation of the sum for $n=10$:\n$$\nh[10] = \\frac{1}{21} \\sum_{k=-3}^{3} \\exp(0) = \\frac{1}{21} \\sum_{k=-3}^{3} 1 = \\frac{7}{21} = \\frac{1}{3}\n$$\nThis confirms that the singularity at $n=10$ is removable. The derived closed-form expression, interpreted with its continuous extension at this point, provides the required single analytic formula for $h[n]$.", "answer": "$$\n\\boxed{\\frac{1}{21} \\frac{\\sin\\left(\\frac{\\pi(n-10)}{3}\\right)}{\\sin\\left(\\frac{\\pi(n-10)}{21}\\right)}}\n$$", "id": "2871626"}, {"introduction": "Theory becomes engineering through implementation. This final practice bridges the gap by guiding you through the computational steps of designing a linear-phase FIR filter, forcing careful attention to the constraints required for a real-world application. You will enforce conjugate symmetry in the frequency domain to guarantee a real-valued impulse response, correctly handle the special cases of the DC and Nyquist frequencies, and synthesize the complete filter, reinforcing the practical workflow from specification to implementation [@problem_id:2871608].", "problem": "You are to design a length-$N$ finite impulse response filter via the frequency-sampling method, enforcing the conditions required for a real-valued impulse response. Use the following foundations as the starting point for your derivation and implementation: the definitions of the Discrete-Time Fourier Transform (DTFT), the Discrete Fourier Transform (DFT), and the inverse Discrete Fourier Transform (IDFT), along with the real-valued sequence conjugate-symmetry property in the DFT domain. Angles are in radians.\n\nConsider an even-length sequence $h[n]$ of length $N$, with the $N$-point DFT $H[k]$, where $k \\in \\{0,1,\\dots,N-1\\}$, and the standard DFT/IDFT pair\n$$\nH[k] = \\sum_{n=0}^{N-1} h[n] e^{-j 2\\pi kn/N}, \\quad\nh[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} H[k] e^{j 2\\pi kn/N}.\n$$\nYou are given magnitude samples $\\lvert H_d(e^{j \\omega_k})\\rvert$ at the equally spaced angular frequencies $\\omega_k = 2\\pi k/N$. The target phase is linear, with group delay $\\tau$ samples, modeled by $e^{-j \\omega_k \\tau}$. You must construct a complex sequence $H[k]$ that simultaneously:\n- Enforces the conjugate-symmetry constraint required for $h[n] \\in \\mathbb{R}$, namely $H[k] = H^*[(N-k) \\bmod N]$.\n- Enforces that the self-conjugate DFT bins are real-valued when $N$ is even, i.e., $H[0] \\in \\mathbb{R}$ and $H[N/2] \\in \\mathbb{R}$.\n\nAfter constructing such an $H[k]$, compute the real impulse response $h[n]$ of length $N$ via the $N$-point IDFT. All computations must be performed in radians, and the final impulse response samples must be reported as real numbers.\n\nUse $N=16$ and $\\tau=7.5$. For the frequency-sampling construction, use the following rule: for the non-self-conjugate bins $k \\in \\{1,2,\\dots,(N/2-1)\\}$, combine the given magnitudes with the linear phase to get\n$$\nH[k] = \\lvert H_d(e^{j \\omega_k})\\rvert \\, e^{-j \\omega_k \\tau}.\n$$\nFor the self-conjugate bins, enforce real-valuedness directly by setting\n$$\nH[0] = \\lvert H_d(e^{j \\omega_0})\\rvert, \\quad\nH[N/2] = \\lvert H_d(e^{j \\omega_{N/2}})\\rvert \\, \\cos(\\pi \\tau),\n$$\nand then impose conjugate symmetry to fill the remaining upper-half spectrum:\n$$\nH[N-k] = H^*[k], \\quad \\text{for } k \\in \\{1,2,\\dots,(N/2-1)\\}.\n$$\nFinally, compute $h[n]$ via the IDFT. Your answers must be expressed as lists of real-valued samples with rounding applied as specified below.\n\nTest suite. For $N=16$ and $\\tau=7.5$, evaluate three cases. In each case you are given nine nonnegative real numbers that define the magnitude samples $\\lvert H_d(e^{j \\omega_k})\\rvert$ for $k \\in \\{0,1,\\dots,8\\}$, i.e., the lower half-spectrum including the direct current bin $k=0$ and the Nyquist bin $k=8$. Use the construction above to build the full $H[k]$ for $k \\in \\{0,1,\\dots,15\\}$, then compute $h[n]$.\n\n- Case A (lowpass-like): $\\big[1.0,\\,1.0,\\,1.0,\\,1.0,\\,1.0,\\,1.0,\\,0.0,\\,0.0,\\,0.0\\big]$.\n- Case B (mixed profile): $\\big[0.0,\\,0.2,\\,0.8,\\,1.0,\\,0.8,\\,0.2,\\,0.0,\\,0.4,\\,0.6\\big]$.\n- Case C (raised-cosine on $[0,\\pi]$): for $k \\in \\{0,1,\\dots,8\\}$,\n$$\n\\lvert H_d(e^{j \\omega_k})\\rvert = \\tfrac{1}{2}\\big(1 + \\cos(\\pi k/8)\\big),\n$$\nwhich numerically equals\n$$\n\\big[1.0000000000,\\,0.9619397663,\\,0.8535533906,\\,0.6913417162,\\,0.5000000000,\\,0.3086582838,\\,0.1464466094,\\,0.0380602337,\\,0.0000000000\\big].\n$$\n\nOutput specification. For each case, output the time-domain impulse response list $[h[0],h[1],\\dots,h[15]]$ with each entry rounded to $6$ decimal places. Your program should produce a single line of output containing the three lists as a comma-separated list enclosed in square brackets, for example, $[[\\dots],[\\dots],[\\dots]]$.\n\nYour program must not take any input and must use the definitions and rules above exactly as stated.", "solution": "The problem requires the design of a real-valued, linear-phase Finite Impulse Response (FIR) filter of length $N=16$ using the frequency-sampling method. The design process begins by specifying the filter's $N$-point Discrete Fourier Transform (DFT), $H[k]$, at discrete frequencies $\\omega_k = 2\\pi k/N$, and then obtaining the impulse response $h[n]$ via the Inverse Discrete Fourier Transform (IDFT).\n\nThe fundamental principle for ensuring the impulse response $h[n]$ is real-valued is that its DFT, $H[k]$, must exhibit conjugate symmetry. This property is expressed as:\n$$\nH[k] = H^*[(N-k) \\pmod N] \\quad \\text{for } k = 0, 1, \\dots, N-1\n$$\nwhere the asterisk ($*$) denotes the complex conjugate.\n\nThe problem specifies a target linear phase response corresponding to a group delay of $\\tau=7.5$ samples. For a filter of length $N=16$, this group delay is equal to $(N-1)/2 = (16-1)/2 = 7.5$. An impulse response with this group delay is symmetric, $h[n] = h[N-1-n]$. A filter with even length $N$ and a symmetric impulse response is classified as a Type II linear-phase FIR filter. A critical property of any Type II filter is that its frequency response must be zero at the Nyquist frequency, $\\omega = \\pi$. In the context of an $N$-point DFT, this corresponds to the frequency bin $k=N/2$. Therefore, we must have $H[N/2] = 0$.\n\nWe are given the magnitude samples $\\lvert H_d(e^{j \\omega_k})\\rvert$ for $k=0, 1, \\dots, N/2$. The construction of the full $N$-point DFT sequence $H[k]$ for $k=0, 1, \\dots, 15$ proceeds by enforcing the aforementioned constraints.\n\n1.  **Self-Conjugate Bins ($k=0$ and $k=N/2$):**\n    The conjugate symmetry condition implies that the bins at $k=0$ (DC frequency) and $k=N/2$ (Nyquist frequency, for even $N$) must be real-valued, since $H[0] = H^*[0]$ and $H[N/2] = H^*[N-N/2]=H^*[N/2]$.\n    -   For the DC bin, $k=0$, the problem specifies $H[0] = \\lvert H_d(e^{j \\omega_0})\\rvert$. As the magnitude is a real number, this correctly sets $H[0]$ to a real value.\n    -   For the Nyquist bin, $k=N/2=8$, the problem gives the rule $H[8] = \\lvert H_d(e^{j \\omega_8})\\rvert \\, \\cos(\\pi \\tau)$. With the specified group delay $\\tau = 7.5$, we evaluate the cosine term: $\\cos(\\pi \\times 7.5) = \\cos(7.5\\pi) = 0$. This forces $H[8]=0$, which precisely satisfies the necessary condition for a Type II linear-phase filter, regardless of the input magnitude at that frequency.\n\n2.  **Lower-Half Frequency Bins ($k=1, 2, \\dots, N/2-1$):**\n    For the bins $k \\in \\{1, 2, \\dots, 7\\}$, the complex frequency response samples are synthesized by combining the given magnitudes with the target linear phase:\n    $$\n    H[k] = \\lvert H_d(e^{j \\omega_k})\\rvert \\, e^{-j \\omega_k \\tau}\n    $$\n    Substituting $\\omega_k = 2\\pi k/N = \\pi k/8$ and $\\tau=7.5$, we have:\n    $$\n    H[k] = \\lvert H_d(e^{j \\pi k/8})\\rvert \\, e^{-j (\\pi k/8)(7.5)} = \\lvert H_d(e^{j \\pi k/8})\\rvert \\, e^{-j 7.5\\pi k/8}\n    $$\n\n3.  **Upper-Half Frequency Bins ($k=N/2+1, \\dots, N-1$):**\n    To satisfy the conjugate symmetry requirement, the remaining frequency samples for $k \\in \\{9, 10, \\dots, 15\\}$ are determined from the lower-half bins. The symmetry relation $H[N-k] = H^*[k]$ is applied for $k=1, \\dots, 7$. For instance, $H[15] = H^*[1]$, $H[14]=H^*[2]$, and so on.\n\nOnce the complete DFT sequence $H[k]$ for $k = 0, 1, \\dots, 15$ has been constructed according to these rules, the final real-valued impulse response $h[n]$ is computed using the $N$-point Inverse Discrete Fourier Transform (IDFT):\n$$\nh[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} H[k] e^{j 2\\pi kn/N} = \\frac{1}{16} \\sum_{k=0}^{15} H[k] e^{j \\pi kn/8}\n$$\nBecause $H[k]$ has been built with perfect conjugate symmetry, the resulting sequence $h[n]$ is guaranteed to be real-valued, and due to the choice of $\\tau$, it will also be symmetric, i.e., $h[n] = h[15-n]$. Any residual imaginary components in the computed $h[n]$ are artifacts of finite-precision floating-point arithmetic and should be discarded. The procedure is applied to the three specified test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Designs a real-valued FIR filter using the frequency-sampling method\n    for three test cases and prints the resulting impulse responses.\n    \"\"\"\n    \n    # Define problem parameters\n    N = 16\n    tau = 7.5\n\n    # Define the magnitude specifications for the three test cases.\n    # Magnitudes are for k = 0, 1, ..., N/2.\n    mag_a = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0]\n    mag_b = [0.0, 0.2, 0.8, 1.0, 0.8, 0.2, 0.0, 0.4, 0.6]\n    \n    # For Case C, calculate magnitudes from the given formula for precision.\n    k_vals_c = np.arange(N // 2 + 1)\n    mag_c = 0.5 * (1 + np.cos(np.pi * k_vals_c / 8))\n\n    test_cases = [\n        mag_a,\n        mag_b,\n        mag_c.tolist() # Convert numpy array to list for consistency\n    ]\n\n    results = []\n    for magnitudes in test_cases:\n        # Initialize the N-point DFT spectrum H[k] as a complex array.\n        H = np.zeros(N, dtype=np.complex128)\n        \n        # 1. Handle self-conjugate bins (k=0 and k=N/2)\n        # H[0] must be real.\n        H[0] = magnitudes[0]\n        \n        # H[N/2] must be real. The problem's formula correctly enforces the\n        # Type-II linear phase condition H[N/2]=0 since cos(pi*tau)=0 for tau=7.5.\n        H[N//2] = magnitudes[N//2] * np.cos(np.pi * tau)\n        \n        # 2. Handle lower-half frequency bins (1 <= k < N/2)\n        # 3. and simultaneously set upper-half bins by conjugate symmetry.\n        for k in range(1, N // 2):\n            omega_k = 2 * np.pi * k / N\n            phase = -omega_k * tau\n            \n            # Construct complex sample H[k]\n            H[k] = magnitudes[k] * np.exp(1j * phase)\n            \n            # Enforce conjugate symmetry for a real impulse response\n            H[N-k] = np.conj(H[k])\n            \n        # 4. Compute the impulse response h[n] via Inverse DFT.\n        # numpy.fft.ifft includes the 1/N scaling factor.\n        h = np.fft.ifft(H)\n        \n        # The result h should be real due to conjugate symmetry of H.\n        # We take the real part to discard negligible floating-point error.\n        h_real = np.real(h)\n        \n        # Round each sample to the specified number of decimal places.\n        h_rounded = np.round(h_real, 6)\n        \n        results.append(h_rounded.tolist())\n\n    # Format the final output as a string representing a list of lists.\n    # The str() on a list automatically creates the desired [item1, item2, ...] format.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    \n    # Python may add spaces after commas in lists, remove them for exact format consistency\n    output_str = output_str.replace(\" \", \"\")\n\n    print(output_str)\n\nsolve()\n```", "id": "2871608"}]}