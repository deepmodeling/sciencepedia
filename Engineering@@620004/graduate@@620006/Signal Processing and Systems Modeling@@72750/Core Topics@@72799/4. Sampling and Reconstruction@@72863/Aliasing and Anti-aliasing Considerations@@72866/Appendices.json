{"hands_on_practices": [{"introduction": "Understanding the fundamental mechanism of aliasing is the first step toward mastering its control. This exercise provides a concrete calculation of the 'fold-over' effect, where a high-frequency continuous-time tone appears as a lower-frequency tone after sampling. By working through this foundational problem [@problem_id:2851263], you will solidify your understanding of how frequencies are mapped from the continuous domain into the principal Nyquist interval $[0, f_s/2]$ and learn to predict the aliased frequency from first principles.", "problem": "A single-tone continuous-time signal $x(t) = \\cos\\!\\left(2\\pi f_{0}\\, t\\right)$ is acquired by an ideal sampler at sampling frequency $f_{s}$, producing the discrete-time sequence $x[n] = x(n T_{s})$ with $T_{s} = 1/f_{s}$. The measurement front-end lacks an analog anti-aliasing filter. You are told that $f_{0} = 3.2\\,\\text{kHz}$ and $f_{s} = 5\\,\\text{kHz}$.\n\nStarting only from the sampling relation and the standard spectral replication model for ideal sampling in the frequency domain, namely that the Continuous-Time Fourier Transform (CTFT) of the sampled signal equals a Dirac-comb replication of the original spectrum with spacing $f_{s}$, derive the observed discrete-time frequency content and its aliasing into the Nyquist band. In particular:\n\n1) When the discrete-time spectrum is displayed on a frequency axis labeled in hertz over the interval $[0, f_{s})$, determine the observed discrete-time frequency (in hertz) of the tone. This is the frequency location of the spectral line that corresponds directly to the discrete-time sinusoid’s positive-frequency component after mapping the Discrete-Time Fourier Transform (DTFT) angular frequency $\\omega$ to hertz via $f = \\omega f_{s}/(2\\pi)$.\n\n2) Identify the aliased tone location in the Nyquist interval $[0, f_{s}/2]$ (in hertz), i.e., the frequency at which an ideal discrete-time spectrum restricted to $[0, f_{s}/2]$ would exhibit the tone, accounting for spectral folding about $f_{s}/2$.\n\nExpress both requested values in hertz. Provide your final answer as two numbers in a single row matrix in the order described above. No rounding is necessary.", "solution": "We begin with the fundamental frequency-domain description of ideal sampling. Let $X(f)$ denote the Continuous-Time Fourier Transform (CTFT) of $x(t)$. Ideal sampling at period $T_{s} = 1/f_{s}$ produces a sampled signal whose CTFT is\n$$\nX_{s}(f) \\;=\\; \\frac{1}{T_{s}} \\sum_{k\\in\\mathbb{Z}} X\\!\\left(f - k f_{s}\\right).\n$$\nFor the single-tone input $x(t) = \\cos(2\\pi f_{0} t)$, the CTFT $X(f)$ consists of two impulses at frequencies $\\pm f_{0}$ with equal weights. Under sampling, $X_{s}(f)$ consists of impulses at $\\pm f_{0} + k f_{s}$ for all integers $k$.\n\nTo connect with the discrete-time sequence $x[n] = x(n T_{s})$, recall that the discrete-time angular frequency $\\omega$ (in radians per sample) relates to the continuous frequency $f$ (in hertz) by\n$$\n\\omega \\;=\\; 2\\pi\\, \\frac{f}{f_{s}} \\quad \\Longleftrightarrow \\quad f \\;=\\; \\frac{\\omega}{2\\pi} \\, f_{s}.\n$$\nBecause the Discrete-Time Fourier Transform (DTFT) is $2\\pi$-periodic in $\\omega$, the discrete-time spectrum is $f_{s}$-periodic in hertz when mapped via $f = \\omega f_{s}/(2\\pi)$. Consequently, any spectral line at $f$ can be considered modulo $f_{s}$.\n\nPart 1: Observed discrete-time frequency in hertz on $[0, f_{s})$.\nThe positive-frequency spectral line associated with the tone appears at the modular location\n$$\nf_{\\text{mod}} \\;=\\; f_{0} \\bmod f_{s}.\n$$\nHere, $f_{0} = 3.2\\,\\text{kHz}$ and $f_{s} = 5\\,\\text{kHz}$, so $f_{0} \\in [0, f_{s})$ already. Therefore,\n$$\nf_{\\text{obs},[0,f_{s})} \\;=\\; f_{0} \\;=\\; 3.2 \\times 10^{3}.\n$$\n\nPart 2: Aliased tone location in the Nyquist interval $[0, f_{s}/2]$.\nThe Nyquist interval is $[0, f_{s}/2] = [0, 2.5\\,\\text{kHz}]$. Spectral components above $f_{s}/2$ fold about $f_{s}/2$ into this interval. For a single tone at $f_{0}$ with $f_{0} > f_{s}/2$, the folded (aliased) frequency is found by reflecting about $f_{s}/2$ or equivalently taking the minimal distance to an integer multiple of $f_{s}$. A standard way to express this is\n$$\nf_{\\text{alias}} \\;=\\; \\min_{k\\in\\mathbb{Z}} \\left| f_{0} - k f_{s} \\right|, \\quad \\text{subject to } f_{\\text{alias}} \\in [0, f_{s}/2].\n$$\nSince $f_{0} = 3.2\\,\\text{kHz}$ and $f_{s} = 5\\,\\text{kHz}$, choose $k = 1$:\n$$\n\\left| f_{0} - 1\\cdot f_{s} \\right| \\;=\\; \\left| 3.2\\,\\text{kHz} - 5\\,\\text{kHz} \\right| \\;=\\; 1.8\\,\\text{kHz} \\;\\in\\; [0, 2.5\\,\\text{kHz}].\n$$\nThus the aliased tone location in the Nyquist band is\n$$\nf_{\\text{alias}} \\;=\\; 1.8 \\times 10^{3}.\n$$\n\nConsistency check via discrete-time angular frequency folding: The discrete-time angular frequency corresponding to $f_{0}$ is\n$$\n\\omega_{0} \\;=\\; 2\\pi \\frac{f_{0}}{f_{s}} \\;=\\; 2\\pi \\cdot \\frac{3.2}{5} \\;=\\; 1.28\\pi.\n$$\nFolding into $[0,\\pi]$ uses the fact that $\\cos(\\omega n) = \\cos\\!\\big((2\\pi - \\omega)n\\big)$, so the observed angular frequency in $[0,\\pi]$ is $\\omega_{\\text{obs}} = 2\\pi - \\omega_{0} = 0.72\\pi$. Mapping back to hertz,\n$$\nf_{\\text{alias}} \\;=\\; \\frac{\\omega_{\\text{obs}}}{2\\pi}\\, f_{s} \\;=\\; 0.36\\, f_{s} \\;=\\; 0.36 \\times 5\\,\\text{kHz} \\;=\\; 1.8\\,\\text{kHz},\n$$\nwhich matches the result above.\n\nTherefore, the two requested values are $f_{\\text{obs},[0,f_{s})} = 3200$ hertz and $f_{\\text{alias}} = 1800$ hertz.", "answer": "$$\\boxed{\\begin{pmatrix}3200 & 1800\\end{pmatrix}}$$", "id": "2851263"}, {"introduction": "Once we understand how aliasing occurs, a critical practical skill is to diagnose whether it, or other inconsistencies, may be corrupting experimental data. This practice moves beyond simple calculation to the design of a diagnostic test [@problem_id:2851316]. You will leverage a fundamental property of real-valued systems—conjugate symmetry in the frequency domain—to construct a metric that can reveal anomalies in a measured frequency response, distinguishing the system's true behavior from measurement noise.", "problem": "Consider a real-valued, linear time-invariant (LTI) discrete-time system with absolutely summable impulse response $h[n] \\in \\mathbb{R}$, $n \\in \\mathbb{Z}$. Its discrete-time Fourier transform (DTFT) is defined by $H(\\exp(j\\omega)) \\triangleq \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-j \\omega n)$, which is $2\\pi$-periodic in $\\omega$. You measure the complex frequency response on a uniform grid $\\{\\omega_{k}\\}_{k=0}^{N-1}$ that covers the interval $(-\\pi,\\pi]$, subject to small additive complex measurement disturbances, yielding measurements $H_{m}(\\exp(j\\omega_{k})) = H(\\exp(j\\omega_{k})) + n(\\omega_{k})$. Assume the disturbances satisfy the following: for distinct frequency samples $\\omega_{k} \\neq \\omega_{\\ell}$, the random variables $n(\\omega_{k})$ and $n(\\omega_{\\ell})$ are independent and identically distributed, circularly symmetric, zero-mean, complex random variables with second moment $\\mathbb{E}[|n(\\omega_{k})|^{2}] = \\sigma^{2}$, and are independent of $H(\\exp(j\\omega))$.\n\nTo diagnose aliasing in the measured frequency response, you decide to exploit the behavior of $H(\\exp(j\\omega))$ under the wraparound at $\\omega=\\pi$, that is, the continuity and periodicity in the transition from $\\omega \\rightarrow \\pi^{-}$ to $\\omega \\rightarrow -\\pi^{+}$. Let $\\Delta \\in (0,\\pi)$ be a grid spacing, and define a set of offsets $\\{\\delta_{k}\\}_{k=0}^{K-1}$ with $\\delta_{k} \\triangleq k \\Delta$, where $K \\Delta \\ll \\pi$ so that the band $[\\pi - K\\Delta, \\pi)$ is a small neighborhood of $\\omega=\\pi$. For each $k \\in \\{0,1,\\ldots,K-1\\}$, consider the pair of frequencies $ \\pi - \\delta_{k}$ and $-\\pi + \\delta_{k}$, which are mapped onto each other by the $2\\pi$-periodic wraparound.\n\nDefine the mismatch sequence\n$$\nD_{k} \\triangleq H_{m}\\!\\left(\\exp\\!\\big(j(\\pi - \\delta_{k})\\big)\\right) - \\overline{H_{m}\\!\\left(\\exp\\!\\big(j(-\\pi + \\delta_{k})\\big)\\right)} \\quad \\text{for } k=0,1,\\ldots,K-1,\n$$\nand the diagnostic statistic\n$$\nS_{K} \\triangleq \\frac{1}{K} \\sum_{k=0}^{K-1} \\left|D_{k}\\right|^{2}.\n$$\n\nTasks:\n- Starting only from the definitions given above and fundamental properties of the DTFT for real-valued impulse responses, derive the symmetry relation that must hold between $H(\\exp(j(\\pi - \\delta)))$ and $H(\\exp(j(-\\pi + \\delta)))$ in the absence of aliasing.\n- Using this relation and the disturbance model, derive a closed-form expression for the expectation $\\mathbb{E}[S_{K}]$ as a function of $\\sigma^{2}$.\n\nReport the final answer as a single closed-form analytic expression in terms of $\\sigma^{2}$. No numerical approximation is required; do not include units.", "solution": "The problem is well-posed and scientifically grounded within the domain of discrete-time signal processing. It requires the application of fundamental properties of the Discrete-Time Fourier Transform (DTFT) for real-valued signals and basic principles of probability theory for expectation computation. We shall proceed with the derivation.\n\nThe problem consists of two parts. First, we must derive the symmetry relation for the DTFT $H(\\exp(j\\omega))$ of a real-valued impulse response $h[n]$. Second, we use this relation to compute the expectation of the diagnostic statistic $S_{K}$.\n\nPart $1$: Derivation of the DTFT symmetry relation.\nThe DTFT of the impulse response $h[n]$ is defined as $H(\\exp(j\\omega)) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-j \\omega n)$.\nWe are given that the impulse response is real-valued, i.e., $h[n] \\in \\mathbb{R}$ for all $n \\in \\mathbb{Z}$. This implies that $h[n]$ is equal to its complex conjugate, $\\overline{h[n]} = h[n]$.\nLet us compute the complex conjugate of $H(\\exp(j\\omega))$:\n$$\n\\overline{H(\\exp(j\\omega))} = \\overline{\\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-j \\omega n)}\n$$\nUsing the properties of complex conjugation, the conjugate of a sum is the sum of the conjugates, and the conjugate of a product is the product of the conjugates:\n$$\n\\overline{H(\\exp(j\\omega))} = \\sum_{n=-\\infty}^{\\infty} \\overline{h[n]} \\overline{\\exp(-j \\omega n)}\n$$\nSince $h[n]$ is real, $\\overline{h[n]} = h[n]$. The conjugate of $\\exp(-j \\omega n)$ is $\\exp(j \\omega n)$. Therefore,\n$$\n\\overline{H(\\exp(j\\omega))} = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(j \\omega n)\n$$\nNow, let's evaluate the DTFT at frequency $-\\omega$:\n$$\nH(\\exp(j(-\\omega))) = H(\\exp(-j\\omega)) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-j(-\\omega)n) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(j \\omega n)\n$$\nComparing the two results, we establish the fundamental conjugate symmetry property of the DTFT for any real-valued sequence:\n$$\nH(\\exp(-j\\omega)) = \\overline{H(\\exp(j\\omega))}\n$$\nThe problem requires the symmetry relation between $H(\\exp(j(\\pi - \\delta)))$ and $H(\\exp(j(-\\pi + \\delta)))$. Let us substitute $\\omega = \\pi - \\delta$ into the conjugate symmetry relation. The left-hand side becomes:\n$$\nH(\\exp(-j(\\pi - \\delta))) = H(\\exp(j(-\\pi + \\delta)))\n$$\nThe right-hand side becomes:\n$$\n\\overline{H(\\exp(j(\\pi - \\delta)))}\n$$\nEquating these two provides the required symmetry relation:\n$$\nH(\\exp(j(-\\pi + \\delta))) = \\overline{H(\\exp(j(\\pi - \\delta)))}\n$$\nThis relation holds for any $\\delta \\in \\mathbb{R}$ in the absence of aliasing, meaning when $H(\\exp(j\\omega))$ is the true DTFT of a real sequence.\n\nPart $2$: Derivation of the expectation $\\mathbb{E}[S_{K}]$.\nThe diagnostic statistic is defined as $S_{K} \\triangleq \\frac{1}{K} \\sum_{k=0}^{K-1} |D_{k}|^{2}$, where the mismatch sequence is $D_{k} \\triangleq H_{m}(\\exp(j(\\pi - \\delta_{k}))) - \\overline{H_{m}(\\exp(j(-\\pi + \\delta_{k})))}$. We are interested in $\\mathbb{E}[S_K]$. By linearity of expectation,\n$$\n\\mathbb{E}[S_{K}] = \\frac{1}{K} \\sum_{k=0}^{K-1} \\mathbb{E}\\left[|D_{k}|^{2}\\right]\n$$\nLet us first find an expression for $D_k$. We substitute the measurement model $H_{m}(\\exp(j\\omega)) = H(\\exp(j\\omega)) + n(\\omega)$ into the definition of $D_k$:\n$$\nD_{k} = \\left[H(\\exp(j(\\pi - \\delta_{k}))) + n(\\pi - \\delta_{k})\\right] - \\overline{\\left[H(\\exp(j(-\\pi + \\delta_{k}))) + n(-\\pi + \\delta_{k})\\right]}\n$$\n$$\nD_{k} = H(\\exp(j(\\pi - \\delta_{k}))) + n(\\pi - \\delta_{k}) - \\overline{H(\\exp(j(-\\pi + \\delta_{k})))} - \\overline{n(-\\pi + \\delta_{k})}\n$$\nFrom Part $1$, we have the symmetry relation $H(\\exp(j(-\\pi + \\delta_{k}))) = \\overline{H(\\exp(j(\\pi - \\delta_{k})))}$. Taking the complex conjugate of both sides of this relation yields $\\overline{H(\\exp(j(-\\pi + \\delta_{k})))} = H(\\exp(j(\\pi - \\delta_{k})))$.\nSubstituting this into the expression for $D_k$:\n$$\nD_{k} = H(\\exp(j(\\pi - \\delta_{k}))) + n(\\pi - \\delta_{k}) - H(\\exp(j(\\pi - \\delta_{k}))) - \\overline{n(-\\pi + \\delta_{k})}\n$$\nThe terms involving the true DTFT $H$ cancel out, which is the principle of this diagnostic test. We are left with an expression that depends only on the measurement disturbances:\n$$\nD_{k} = n(\\pi - \\delta_{k}) - \\overline{n(-\\pi + \\delta_{k})}\n$$\nNow we compute the squared magnitude, $|D_{k}|^{2}$:\n$$\n|D_{k}|^{2} = \\left| n(\\pi - \\delta_{k}) - \\overline{n(-\\pi + \\delta_{k})} \\right|^{2}\n$$\nUsing the property $|z|^2 = z\\overline{z}$, we have:\n$$\n|D_{k}|^{2} = \\left( n(\\pi - \\delta_{k}) - \\overline{n(-\\pi + \\delta_{k})} \\right) \\left( \\overline{n(\\pi - \\delta_{k})} - n(-\\pi + \\delta_{k}) \\right)\n$$\nExpanding this product gives:\n$$\n|D_{k}|^{2} = |n(\\pi - \\delta_{k})|^{2} - n(\\pi - \\delta_{k})n(-\\pi + \\delta_{k}) - \\overline{n(-\\pi + \\delta_{k})}\\overline{n(\\pi - \\delta_{k})} + |\\overline{n(-\\pi + \\delta_{k})}|^{2}\n$$\nSince $|z|^2 = |\\overline{z}|^2$, this simplifies to:\n$$\n|D_{k}|^{2} = |n(\\pi - \\delta_{k})|^{2} + |n(-\\pi + \\delta_{k})|^{2} - \\left( n(\\pi - \\delta_{k})n(-\\pi + \\delta_{k}) + \\overline{n(\\pi - \\delta_{k})n(-\\pi + \\delta_{k})} \\right)\n$$\nNow we take the expectation of $|D_{k}|^{2}$:\n$$\n\\mathbb{E}[|D_{k}|^{2}] = \\mathbb{E}[|n(\\pi - \\delta_{k})|^{2}] + \\mathbb{E}[|n(-\\pi + \\delta_{k})|^{2}] - \\mathbb{E}[n(\\pi - \\delta_{k})n(-\\pi + \\delta_{k}) + \\overline{n(\\pi - \\delta_{k})n(-\\pi + \\delta_{k})}]\n$$\nWe are given that $\\mathbb{E}[|n(\\omega)|^{2}] = \\sigma^{2}$ for any frequency sample $\\omega$. Therefore,\n$\\mathbb{E}[|n(\\pi - \\delta_{k})|^{2}] = \\sigma^{2}$ and $\\mathbb{E}[|n(-\\pi + \\delta_{k})|^{2}] = \\sigma^{2}$.\nThe frequencies $\\omega_{k,1} = \\pi - \\delta_k$ and $\\omega_{k,2} = -\\pi + \\delta_k$ are distinct for all $k \\in \\{0, 1, \\ldots, K-1\\}$. For $k>0$, this is trivial as $\\delta_k = k\\Delta > 0$ and $K\\Delta \\ll \\pi$. For $k=0$, $\\delta_0=0$ and we have $\\omega_{0,1}=\\pi$ and $\\omega_{0,2}=-\\pi$. These are distinct frequency values in the specified interval $(-\\pi, \\pi]$.\nAccording to the problem statement, for distinct frequencies $\\omega_a \\neq \\omega_b$, the random variables $n(\\omega_a)$ and $n(\\omega_b)$ are independent. Therefore, $n(\\pi - \\delta_{k})$ and $n(-\\pi + \\delta_{k})$ are independent random variables.\nWe are also given that the disturbances are zero-mean, i.e., $\\mathbb{E}[n(\\omega)] = 0$ for all $\\omega$.\nFor the cross-term expectation, independence allows us to write:\n$$\n\\mathbb{E}[n(\\pi - \\delta_{k})n(-\\pi + \\delta_{k})] = \\mathbb{E}[n(\\pi - \\delta_{k})] \\mathbb{E}[n(-\\pi + \\delta_{k})] = 0 \\cdot 0 = 0\n$$\nSince the expectation of the cross-term is zero, the expectation of its complex conjugate is also zero. Thus, the expectation of the entire subtracted term is zero.\nSo, for each $k$, we have:\n$$\n\\mathbb{E}[|D_{k}|^{2}] = \\sigma^{2} + \\sigma^{2} - 0 = 2\\sigma^{2}\n$$\nThis result is independent of the index $k$. Now we can compute the expectation of $S_K$:\n$$\n\\mathbb{E}[S_{K}] = \\frac{1}{K} \\sum_{k=0}^{K-1} \\mathbb{E}\\left[|D_{k}|^{2}\\right] = \\frac{1}{K} \\sum_{k=0}^{K-1} 2\\sigma^{2}\n$$\nThe sum consists of $K$ identical terms, so the sum is $K \\cdot 2\\sigma^{2}$.\n$$\n\\mathbb{E}[S_{K}] = \\frac{1}{K} (K \\cdot 2\\sigma^{2}) = 2\\sigma^{2}\n$$\nThis is the final closed-form expression for the expectation of the diagnostic statistic.", "answer": "$$\n\\boxed{2\\sigma^{2}}\n$$", "id": "2851316"}, {"introduction": "The ultimate goal in many systems is not just to diagnose aliasing but to proactively prevent it. This advanced exercise places you in the role of a system designer, tasked with creating an optimal anti-aliasing filter [@problem_id:2851299]. Rather than simply using an ideal 'brick-wall' filter, you will apply optimization principles to shape the filter's response, minimizing the mean-squared aliasing error while adhering to practical constraints like a fixed energy budget. This practice bridges theory and application, demonstrating how to make principled design trade-offs in real-world scenarios.", "problem": "A zero-mean wide-sense stationary (WSS) continuous-time process with power spectral density (PSD) $S_{x}(f)$ is to be sampled at sampling frequency $f_{s} = 10 \\times 10^{3}$ Hz. Before sampling, the process is passed through a real linear time-invariant anti-alias filter with frequency response $H(f)$, where $|H(f)|$ is even and bounded by $0 \\leq |H(f)| \\leq 1$. The passband is required to be unity gain, that is, $|H(f)| = 1$ for $|f| \\leq 5 \\times 10^{3}$ Hz. Due to hardware constraints, the prefilter is strictly bandlimited: $|H(f)| = 0$ for $|f| > 10 \\times 10^{3}$ Hz.\n\nThe process PSD is piecewise constant:\n- $S_{x}(f) = 1$ for $|f| \\leq 5 \\times 10^{3}$ Hz,\n- $S_{x}(f) = \\tfrac{1}{2}$ for $5 \\times 10^{3} < |f| \\leq 7 \\times 10^{3}$ Hz,\n- $S_{x}(f) = \\tfrac{3}{2}$ for $7 \\times 10^{3} < |f| \\leq 10 \\times 10^{3}$ Hz,\n- $S_{x}(f) = 0$ for $|f| > 10 \\times 10^{3}$ Hz.\n\nLet $y(t)$ be the filtered signal and $y[n] = y(n T_{s})$ with $T_{s} = 1/f_{s}$. The discrete-time PSD of $y[n]$ (in the continuous-frequency representation over $|f| \\leq f_{s}/2$) equals the periodized spectrum induced by sampling. Define the mean-squared error (MSE) in estimating the continuous-time baseband second-order statistics via the sampled spectrum as the integrated squared deviation between the baseband periodized spectrum of $y[n]$ and the original baseband $S_{x}(f)$ over $|f| \\leq f_{s}/2$.\n\nAssume the sampling rate and $S_{x}(f)$ are such that, for each baseband frequency $|f| \\leq 5 \\times 10^{3}$ Hz, at most one aliased term from $|f| \\in (5 \\times 10^{3}, 10 \\times 10^{3}]$ folds into baseband.\n\nYou are to design the anti-alias prefilter magnitude $|H(f)|$ that minimizes the above MSE subject to the constraints stated and a fixed energy budget\n$$\n\\int_{-\\infty}^{\\infty} |H(f)|^{2} \\, df \\;=\\; 12 \\times 10^{3}.\n$$\nStart from first principles (the definition of the PSD of a filtered process, the periodization due to sampling, and the definition of an $L^{2}$-type MSE). Formulate the constrained optimization over $|H(f)|$ and solve it explicitly for the optimal $|H(f)|$ on the three regions $|f| \\leq 5 \\times 10^{3}$ Hz, $5 \\times 10^{3} < |f| \\leq 7 \\times 10^{3}$ Hz, and $7 \\times 10^{3} < |f| \\leq 10 \\times 10^{3}$ Hz. Express your final answer as a single piecewise-defined analytic expression for the optimal magnitude response $|H(f)|$. Do not include units in the final answer.", "solution": "The problem statement is first subjected to a critical validation process.\n\n**Step 1: Extracted Givens**\n-   A zero-mean wide-sense stationary (WSS) continuous-time process $x(t)$ has a power spectral density (PSD) $S_{x}(f)$.\n-   $S_{x}(f) = 1$ for $|f| \\leq 5 \\times 10^{3}$ Hz.\n-   $S_{x}(f) = \\frac{1}{2}$ for $5 \\times 10^{3} < |f| \\leq 7 \\times 10^{3}$ Hz.\n-   $S_{x}(f) = \\frac{3}{2}$ for $7 \\times 10^{3} < |f| \\leq 10 \\times 10^{3}$ Hz.\n-   $S_{x}(f) = 0$ for $|f| > 10 \\times 10^{3}$ Hz.\n-   The process is passed through a real linear time-invariant (LTI) anti-alias filter with frequency response $H(f)$.\n-   Filter constraints: $|H(f)|$ is an even function; $0 \\leq |H(f)| \\leq 1$; $|H(f)| = 1$ for $|f| \\leq 5 \\times 10^{3}$ Hz; $|H(f)| = 0$ for $|f| > 10 \\times 10^{3}$ Hz.\n-   The sampling frequency is $f_{s} = 10 \\times 10^{3}$ Hz. The sampling period is $T_s = 1/f_s$.\n-   The filtered signal is $y(t)$, and the sampled signal is $y[n] = y(nT_s)$.\n-   The mean-squared error (MSE) is defined as the integrated squared deviation between the baseband periodized spectrum of $y[n]$ and the original baseband $S_{x}(f)$ over $|f| \\leq f_{s}/2$.\n-   An assumption is made that at most one aliased term folds into the baseband for any baseband frequency.\n-   There is a fixed energy budget for the filter: $\\int_{-\\infty}^{\\infty} |H(f)|^{2} \\, df = 12 \\times 10^{3}$.\n\n**Step 2: Validation**\nThe problem is scientifically grounded in the principles of digital signal processing. It is well-posed, with a clear objective function (MSE) to be minimized subject to a set of well-defined constraints. The given values and constraints are self-consistent. The energy budget constraint can be verified: the integral over the passband $|f| \\leq 5 \\times 10^3$ Hz, where $|H(f)|=1$, is $\\int_{-5 \\times 10^3}^{5 \\times 10^3} 1^2 df = 10 \\times 10^3$. This leaves an energy of $(12-10) \\times 10^3 = 2 \\times 10^3$ for the remaining frequency bands. Since $|H(f)|$ is even, this implies $\\int_{5 \\times 10^3}^{10 \\times 10^3} |H(f)|^2 df = 1 \\times 10^3$. The constraints are not contradictory. The assumption regarding aliasing is verifiable and correct for the given sampling rate and signal bandwidth. The problem is a standard, albeit non-trivial, exercise in optimal filter design.\n\n**Verdict**\nThe problem is valid. We proceed to the solution.\n\n**Solution Derivation**\nThe PSD of the filtered signal $y(t)$ is $S_y(f) = |H(f)|^2 S_x(f)$.\nThe process of sampling $y(t)$ at a rate $f_s$ results in a periodized spectrum for the discrete-time signal $y[n]$. In terms of continuous frequency $f$, this spectrum is given by\n$$S_y^p(f) = \\sum_{k=-\\infty}^{\\infty} S_y(f - kf_s) = \\sum_{k=-\\infty}^{\\infty} |H(f - kf_s)|^2 S_x(f - kf_s)$$\nWe are interested in the baseband, $|f| \\leq f_s/2$. The sampling frequency is $f_s = 10 \\times 10^3$ Hz, so the baseband is $|f| \\leq 5 \\times 10^3$ Hz. The filter is bandlimited such that $|H(f)|=0$ for $|f| > 10 \\times 10^3$ Hz, which is equal to $f_s$. Therefore, for any $f$ in the baseband, only the $k=0, \\pm 1$ terms of the sum can be non-zero.\nFor $|f| \\leq f_s/2$:\n- The argument for $k=0$ is $f$, which is in the baseband.\n- The argument for $k=1$ is $f-f_s$, which is in $[-3f_s/2, -f_s/2]$. The support of $H$ is $[-f_s, f_s]$, so this term contributes.\n- The argument for $k=-1$ is $f+f_s$, which is in $[f_s/2, 3f_s/2]$. This term also contributes.\n- For $|k| \\geq 2$, the argument $|f-kf_s|$ is greater than $f_s$, so $|H(f-kf_s)|=0$.\n\nThe periodized spectrum in the baseband $|f| \\leq f_s/2$ is:\n$$S_y^p(f) = |H(f)|^2 S_x(f) + |H(f-f_s)|^2 S_x(f-f_s) + |H(f+f_s)|^2 S_x(f+f_s)$$\nLet's analyze for $f \\in [0, f_s/2]$. Since all functions are even, the result for negative frequencies will be symmetric.\nFor $f \\in [0, f_s/2]$:\n- $|H(f)|=1$ and $S_x(f)=1$.\n- $f+f_s > f_s$, so $|H(f+f_s)|=0$.\n- $f-f_s$ lies in $[-f_s, -f_s/2]$. Since $|H(f)|$ and $S_x(f)$ are even, $|H(f-f_s)|^2 S_x(f-f_s) = |H(f_s-f)|^2 S_x(f_s-f)$.\nThus, for $f \\in [0, f_s/2]$:\n$$S_y^p(f) = 1 + |H(f_s-f)|^2 S_x(f_s-f)$$\nThe desired spectrum in the baseband is $S_x(f) = 1$. The error spectrum is the aliasing component:\n$$E(f) = S_y^p(f) - S_x(f) = |H(f_s-f)|^2 S_x(f_s-f)$$\nThe Mean-Squared Error (MSE) is defined as $J = \\int_{-f_s/2}^{f_s/2} E(f)^2 df$. Since $E(f)$ is an even function of $f$:\n$$J = 2 \\int_{0}^{f_s/2} \\left( |H(f_s-f)|^2 S_x(f_s-f) \\right)^2 df$$\nLet's perform a change of variable $g = f_s-f$. Then $df = -dg$. When $f=0$, $g=f_s$. When $f=f_s/2$, $g=f_s/2$.\n$$J = 2 \\int_{f_s}^{f_s/2} \\left( |H(g)|^2 S_x(g) \\right)^2 (-dg) = 2 \\int_{f_s/2}^{f_s} \\left( |H(f)|^2 S_x(f) \\right)^2 df$$\nWe wish to minimize this functional $J$ subject to the energy constraint. The total energy is $12 \\times 10^3$. The energy in the passband is $\\int_{-5 \\times 10^3}^{5 \\times 10^3} 1^2 df = 10 \\times 10^3$.\nThe remaining energy is allocated to the stop band $|f| \\in (5 \\times 10^3, 10 \\times 10^3]$.\n$\\int_{|f| \\in (5 \\times 10^3, 10 \\times 10^3]} |H(f)|^2 df = 2 \\times 10^3$. By symmetry, $\\int_{5 \\times 10^3}^{10 \\times 10^3} |H(f)|^2 df = 1 \\times 10^3$.\nLet $h(f) = |H(f)|$. For clarity, let $f_1 = 5 \\times 10^3$, $f_2 = 7 \\times 10^3$, and $f_3 = 10 \\times 10^3$.\nThe optimization problem is: Minimize $J = 2 \\int_{f_1}^{f_3} h(f)^4 S_x(f)^2 df$ subject to $\\int_{f_1}^{f_3} h(f)^2 df = 10^3$ and $0 \\leq h(f) \\leq 1$.\nWe form the Lagrangian functional:\n$$\\mathcal{L}[h] = \\int_{f_1}^{f_3} \\left( 2 h(f)^4 S_x(f)^2 - \\lambda h(f)^2 \\right) df + \\lambda \\cdot 10^3$$\nTaking the functional derivative with respect to $h(f)$ and setting it to zero gives the Euler-Lagrange equation:\n$$8 h(f)^3 S_x(f)^2 - 2 \\lambda h(f) = 0 \\implies 2h(f) (4 h(f)^2 S_x(f)^2 - \\lambda) = 0$$\nFor a non-trivial solution $h(f) \\neq 0$, we have $h(f)^2 = \\frac{\\lambda}{4 S_x(f)^2}$, so $h(f) = \\frac{\\sqrt{\\lambda}}{2 S_x(f)}$. Let $K = \\frac{\\sqrt{\\lambda}}{2}$.\nThe solution has the form $h(f) = K/S_x(f)$, provided $K/S_x(f) \\leq 1$.\nThe PSD $S_x(f)$ is piecewise constant in the optimization region $[f_1, f_3]$:\n- $S_x(f) = S_2 = 1/2$ for $f \\in (f_1, f_2]$.\n- $S_x(f) = S_3 = 3/2$ for $f \\in (f_2, f_3]$.\nSo, the optimal $h(f)$ must also be piecewise constant:\n- $h(f) = K/S_2 = 2K$ for $f \\in (f_1, f_2]$.\n- $h(f) = K/S_3 = 2K/3$ for $f \\in (f_2, f_3]$.\nWe find $K$ using the energy constraint:\n$$\\int_{f_1}^{f_2} (2K)^2 df + \\int_{f_2}^{f_3} \\left(\\frac{2K}{3}\\right)^2 df = 10^3$$\n$$4K^2 (f_2 - f_1) + \\frac{4K^2}{9} (f_3 - f_2) = 10^3$$\n$$4K^2 (2 \\times 10^3) + \\frac{4K^2}{9} (3 \\times 10^3) = 10^3$$\n$$8 \\times 10^3 K^2 + \\frac{4}{3} \\times 10^3 K^2 = 10^3$$\nDividing by $10^3$:\n$$8K^2 + \\frac{4}{3}K^2 = 1 \\implies \\frac{28}{3}K^2 = 1 \\implies K^2 = \\frac{3}{28}$$\nSo, $K = \\sqrt{\\frac{3}{28}} = \\frac{\\sqrt{3}}{2\\sqrt{7}} = \\frac{\\sqrt{21}}{14}$.\nThe largest value of $h(f)$ is $2K = \\frac{\\sqrt{21}}{7}$. Since $21 < 49$, $\\sqrt{21}<7$, so $2K<1$. The constraint $h(f) \\leq 1$ is satisfied.\nThe optimal filter magnitude values are:\n- For $f \\in (5 \\times 10^3, 7 \\times 10^3]$: $h(f) = 2K = \\frac{\\sqrt{21}}{7}$.\n- For $f \\in (7 \\times 10^3, 10 \\times 10^3]$: $h(f) = \\frac{2K}{3} = \\frac{\\sqrt{21}}{21} = \\frac{1}{\\sqrt{21}}$.\n\nCombining all parts, the full expression for the optimal filter magnitude response $|H(f)|$, which is an even function of $f$, is given by its definition for $f \\geq 0$:\n- $|H(f)| = 1$ for $0 \\leq |f| \\leq 5 \\times 10^3$ Hz.\n- $|H(f)| = \\frac{\\sqrt{21}}{7}$ for $5 \\times 10^3 < |f| \\leq 7 \\times 10^3$ Hz.\n- $|H(f)| = \\frac{\\sqrt{21}}{21}$ for $7 \\times 10^3 < |f| \\leq 10 \\times 10^3$ Hz.\n- $|H(f)| = 0$ for $|f| > 10 \\times 10^3$ Hz.\nThis constitutes the final answer.", "answer": "$$\n\\boxed{\n|H(f)| = \n\\begin{cases} \n1 & |f| \\leq 5 \\times 10^3 \\\\\n\\frac{\\sqrt{21}}{7} & 5 \\times 10^3 < |f| \\leq 7 \\times 10^3 \\\\\n\\frac{\\sqrt{21}}{21} & 7 \\times 10^3 < |f| \\leq 10 \\times 10^3 \\\\\n0 & |f| > 10 \\times 10^3\n\\end{cases}\n}\n$$", "id": "2851299"}]}