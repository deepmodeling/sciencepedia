{"hands_on_practices": [{"introduction": "The foundation of any lattice filter is its constituent stage, a two-port computational unit that processes forward and backward prediction errors. A key feature of the orthonormal lattice structure is its energy-preserving nature, a direct consequence of the underlying orthogonal transformation. This exercise provides a concrete, hands-on opportunity to verify this abstract principle by performing a step-by-step numerical calculation of a single lattice stage and confirming that the total signal energy remains invariant before and after the transformation [@problem_id:2879873].", "problem": "Consider a single stage of an orthonormal lattice for a real-valued finite impulse response (FIR) filter. At stage index $m$, the forward and backward lattice signals are defined by the coupling\n$$\n\\begin{pmatrix}\nf_m[n] \\\\\nb_m[n]\n\\end{pmatrix}\n=\n\\gamma_m\n\\begin{pmatrix}\n1  -k_m \\\\\nk_m  1\n\\end{pmatrix}\n\\begin{pmatrix}\nf_{m-1}[n] \\\\\nb_{m-1}[n-1]\n\\end{pmatrix},\n\\quad\n\\gamma_m \\triangleq \\frac{1}{\\sqrt{1+k_m^2}},\n$$\nwith real reflection parameter $k_m \\in \\mathbb{R}$. Assume all sequences are extended by zeros outside their specified index ranges. You are given the length-$4$ sample sequences\n$$\nf_{m-1}[0]=2,\\; f_{m-1}[1]=-1,\\; f_{m-1}[2]=3,\\; f_{m-1}[3]=0,\n$$\n$$\nb_{m-1}[0]=1,\\; b_{m-1}[1]=2,\\; b_{m-1}[2]=-2,\\; b_{m-1}[3]=1,\n$$\nand $k_m=\\frac{3}{4}$. Using the coupling above, compute the outputs $f_m[n]$ and $b_m[n]$ for all $n$ such that either $f_{m-1}[n]$ or $b_{m-1}[n-1]$ is nonzero. Then, verify norm preservation numerically by evaluating\n$$\nE_{\\text{before}} \\triangleq \\sum_{n=-\\infty}^{\\infty} \\big( f_{m-1}[n]^2 + b_{m-1}[n]^2 \\big), \n\\qquad\nE_{\\text{after}} \\triangleq \\sum_{n=-\\infty}^{\\infty} \\big( f_m[n]^2 + b_m[n]^2 \\big),\n$$\nand computing the difference\n$$\n\\Delta \\triangleq E_{\\text{after}} - E_{\\text{before}}.\n$$\nAll sums are finite because of zero extension. Report the value of $\\Delta$. If you choose to approximate intermediate quantities, round your final value of $\\Delta$ to four significant figures. The final answer must be a single real number without units.", "solution": "The problem requires the numerical verification of the norm-preserving property of a single stage of an orthonormal lattice filter. First, we must validate the problem statement. The provided equations describe a standard orthonormal transformation used in signal processing for FIR lattice filters. The transformation matrix is a scaled Givens rotation, which is inherently orthogonal. All parameters and initial data are provided, making the problem well-posed, scientifically grounded, and computationally feasible. Therefore, the problem is valid. We proceed with the solution.\n\nThe core of the lattice filter stage is the transformation:\n$$\n\\begin{pmatrix}\nf_m[n] \\\\\nb_m[n]\n\\end{pmatrix}\n=\n\\gamma_m\n\\begin{pmatrix}\n1  -k_m \\\\\nk_m  1\n\\end{pmatrix}\n\\begin{pmatrix}\nf_{m-1}[n] \\\\\nb_{m-1}[n-1]\n\\end{pmatrix}\n$$\nThe matrix $R_m = \\gamma_m \\begin{pmatrix} 1  -k_m \\\\ k_m  1 \\end{pmatrix}$ is orthogonal, as $R_m^T R_m = I$. This property ensures that the norm of the vector is preserved at each time index $n$:\n$$\nf_m[n]^2 + b_m[n]^2 = f_{m-1}[n]^2 + b_{m-1}[n-1]^2\n$$\nSumming over all $n$ and performing a change of index for the second term on the right-hand side demonstrates that the total energy is conserved: $E_{\\text{after}} = E_{\\text{before}}$. The problem asks for a direct numerical verification of this fact.\n\nFirst, we calculate the scaling factor $\\gamma_m$ with the given reflection coefficient $k_m = \\frac{3}{4}$:\n$$\n\\gamma_m = \\frac{1}{\\sqrt{1 + k_m^2}} = \\frac{1}{\\sqrt{1 + \\left(\\frac{3}{4}\\right)^2}} = \\frac{1}{\\sqrt{1 + \\frac{9}{16}}} = \\frac{1}{\\sqrt{\\frac{25}{16}}} = \\frac{1}{\\frac{5}{4}} = \\frac{4}{5}\n$$\nNext, we compute the output sequences $f_m[n]$ and $b_m[n]$. The input sequences $f_{m-1}[n]$ and $b_{m-1}[n]$ are non-zero only for $n \\in \\{0, 1, 2, 3\\}$. The calculation must be performed for all $n$ where the input vector $(f_{m-1}[n], b_{m-1}[n-1])$ is non-zero. This corresponds to $n \\in \\{0, 1, 2, 3, 4\\}$. All other values are zero due to the zero-extension assumption.\n\nFor $n=0$: inputs are $f_{m-1}[0]=2$ and $b_{m-1}[-1]=0$.\n$$\nf_m[0] = \\frac{4}{5}\\left(f_{m-1}[0] - k_m b_{m-1}[-1]\\right) = \\frac{4}{5}\\left(2 - \\frac{3}{4} \\cdot 0\\right) = \\frac{8}{5}\n$$\n$$\nb_m[0] = \\frac{4}{5}\\left(k_m f_{m-1}[0] + b_{m-1}[-1]\\right) = \\frac{4}{5}\\left(\\frac{3}{4} \\cdot 2 + 0\\right) = \\frac{6}{5}\n$$\nFor $n=1$: inputs are $f_{m-1}[1]=-1$ and $b_{m-1}[0]=1$.\n$$\nf_m[1] = \\frac{4}{5}\\left(-1 - \\frac{3}{4} \\cdot 1\\right) = \\frac{4}{5}\\left(-\\frac{7}{4}\\right) = -\\frac{7}{5}\n$$\n$$\nb_m[1] = \\frac{4}{5}\\left(\\frac{3}{4} \\cdot (-1) + 1\\right) = \\frac{4}{5}\\left(\\frac{1}{4}\\right) = \\frac{1}{5}\n$$\nFor $n=2$: inputs are $f_{m-1}[2]=3$ and $b_{m-1}[1]=2$.\n$$\nf_m[2] = \\frac{4}{5}\\left(3 - \\frac{3}{4} \\cdot 2\\right) = \\frac{4}{5}\\left(3 - \\frac{3}{2}\\right) = \\frac{4}{5}\\left(\\frac{3}{2}\\right) = \\frac{6}{5}\n$$\n$$\nb_m[2] = \\frac{4}{5}\\left(\\frac{3}{4} \\cdot 3 + 2\\right) = \\frac{4}{5}\\left(\\frac{9}{4} + \\frac{8}{4}\\right) = \\frac{4}{5}\\left(\\frac{17}{4}\\right) = \\frac{17}{5}\n$$\nFor $n=3$: inputs are $f_{m-1}[3]=0$ and $b_{m-1}[2]=-2$.\n$$\nf_m[3] = \\frac{4}{5}\\left(0 - \\frac{3}{4} \\cdot (-2)\\right) = \\frac{4}{5}\\left(\\frac{3}{2}\\right) = \\frac{6}{5}\n$$\n$$\nb_m[3] = \\frac{4}{5}\\left(\\frac{3}{4} \\cdot 0 + (-2)\\right) = \\frac{4}{5}(-2) = -\\frac{8}{5}\n$$\nFor $n=4$: inputs are $f_{m-1}[4]=0$ and $b_{m-1}[3]=1$.\n$$\nf_m[4] = \\frac{4}{5}\\left(0 - \\frac{3}{4} \\cdot 1\\right) = \\frac{4}{5}\\left(-\\frac{3}{4}\\right) = -\\frac{3}{5}\n$$\n$$\nb_m[4] = \\frac{4}{5}\\left(\\frac{3}{4} \\cdot 0 + 1\\right) = \\frac{4}{5}(1) = \\frac{4}{5}\n$$\nNow, we compute the energy before the transformation, $E_{\\text{before}}$.\n$$\n\\sum_{n} f_{m-1}[n]^2 = (2)^2 + (-1)^2 + (3)^2 + (0)^2 = 4 + 1 + 9 = 14\n$$\n$$\n\\sum_{n} b_{m-1}[n]^2 = (1)^2 + (2)^2 + (-2)^2 + (1)^2 = 1 + 4 + 4 + 1 = 10\n$$\n$$\nE_{\\text{before}} = \\sum_{n} f_{m-1}[n]^2 + \\sum_{n} b_{m-1}[n]^2 = 14 + 10 = 24\n$$\nNext, we compute the energy after the transformation, $E_{\\text{after}}$.\n$$\n\\sum_{n} f_m[n]^2 = \\left(\\frac{8}{5}\\right)^2 + \\left(-\\frac{7}{5}\\right)^2 + \\left(\\frac{6}{5}\\right)^2 + \\left(\\frac{6}{5}\\right)^2 + \\left(-\\frac{3}{5}\\right)^2 = \\frac{64+49+36+36+9}{25} = \\frac{194}{25}\n$$\n$$\n\\sum_{n} b_m[n]^2 = \\left(\\frac{6}{5}\\right)^2 + \\left(\\frac{1}{5}\\right)^2 + \\left(\\frac{17}{5}\\right)^2 + \\left(-\\frac{8}{5}\\right)^2 + \\left(\\frac{4}{5}\\right)^2 = \\frac{36+1+289+64+16}{25} = \\frac{406}{25}\n$$\n$$\nE_{\\text{after}} = \\sum_{n} f_m[n]^2 + \\sum_{n} b_m[n]^2 = \\frac{194}{25} + \\frac{406}{25} = \\frac{600}{25} = 24\n$$\nFinally, we compute the difference $\\Delta$.\n$$\n\\Delta = E_{\\text{after}} - E_{\\text{before}} = 24 - 24 = 0\n$$\nThe numerical calculation confirms that the energy is conserved, as expected from the theoretical properties of an orthonormal lattice stage. The calculation was performed with exact fractions, so no approximation is necessary.", "answer": "$$\\boxed{0}$$", "id": "2879873"}, {"introduction": "A critical skill in digital filter design is the ability to convert between different filter realizations, such as the direct-form and the lattice structure. This practice guides you through the fundamental process of obtaining the lattice representation—comprising reflection coefficients $\\{k_m\\}$ and a gain $g$—from a given FIR filter's impulse response coefficients. By first deriving the step-down recursion from first principles and then applying it to a practical example, you will master the complete algorithm for analyzing and representing any stable, minimum-phase FIR filter in the lattice domain [@problem_id:2879931].", "problem": "Consider a causal finite impulse response (FIR) filter of order $N$ with system function $H(z)=\\sum_{n=0}^{N} h[n] z^{-n}$ and real coefficients. A lossless lattice FIR representation writes $H(z)=g\\,F_{N}(z)$, where $g=h[0]$ is the feedforward gain and $F_{N}(z)=1+\\sum_{n=1}^{N} f_{n} z^{-n}$ is the monic forward prediction-error polynomial generated by a sequence of reflection (also called partial correlation) coefficients $\\{k_{m}\\}_{m=1}^{N}$. Starting from the fundamental definition that the lattice step-up recursion constructs the forward polynomial via\n$$\nF_{0}(z)=1,\\qquad F_{m}(z)=F_{m-1}(z)+k_{m}\\,z^{-m}F_{m-1}\\!\\left(z^{-1}\\right),\\quad m=1,\\dots,N,\n$$\nand the normalization $F_{N}(0)=1$, derive from first principles a step-down procedure that, given $F_{N}(z)$ with real coefficients and $|k_{m}|1$, recovers the reflection coefficients $\\{k_{m}\\}$ and $g=h[0]$.\n\nThen, execute your procedure for the concrete FIR system\n$$\nH(z)=2+\\frac{2}{5}z^{-1}-\\frac{2}{5}z^{-2}+\\frac{2}{5}z^{-3}-\\frac{2}{5}z^{-4}.\n$$\nCompute the ordered tuple $(k_{1},k_{2},k_{3},k_{4},g)$ that reconstructs $H(z)=g\\,F_{4}(z)$ through the lossless lattice. Express your final answer exactly, with no rounding. Output your final tuple as a single row using parentheses-free matrix notation.", "solution": "The user-provided problem is first subjected to a rigorous validation process.\n\nThe givens are:\n- A causal Finite Impulse Response (FIR) filter of order $N$ with system function $H(z)=\\sum_{n=0}^{N} h[n] z^{-n}$ and real coefficients.\n- A lossless lattice representation $H(z)=g\\,F_{N}(z)$, where $g=h[0]$ is the feedforward gain.\n- $F_{N}(z)=1+\\sum_{n=1}^{N} f_{n} z^{-n}$ is a monic forward prediction-error polynomial.\n- The step-up recursion for the polynomial family $\\{F_m(z)\\}$ is $F_{0}(z)=1$ and $F_{m}(z)=F_{m-1}(z)+k_{m}\\,z^{-m}F_{m-1}(z^{-1})$ for $m=1, \\dots, N$.\n- The reflection coefficients $\\{k_{m}\\}$ satisfy $|k_{m}|1$.\n- The task is to derive a step-down procedure to find the reflection coefficients $\\{k_{m}\\}$ and the gain $g$ from a given $F_N(z)$, and then apply it to the specific system $H(z)=2+\\frac{2}{5}z^{-1}-\\frac{2}{5}z^{-2}+\\frac{2}{5}z^{-3}-\\frac{2}{5}z^{-4}$.\n\nThe problem is evaluated against the validation criteria.\n- **Scientific Grounding**: The problem is a standard exercise in digital signal processing, concerning the relationship between direct-form FIR filter coefficients and lattice-form reflection coefficients. The provided recursion is the well-known Levinson-Durbin recursion for prediction-error filters. The problem is scientifically sound.\n- **Well-Posedness**: The problem is well-posed. It asks for the derivation of a standard algorithm and its application. The conditions $|k_{m}|1$ and $g \\neq 0$ ensure that a unique solution exists and is stable.\n- **Objectivity**: The problem is stated in precise, objective mathematical language.\n- **Completeness and Consistency**: The problem provides all necessary definitions and equations to derive the required procedure. There are no contradictions.\n\nThe problem is deemed **valid** as it does not exhibit any of the specified flaws. We may proceed with the solution.\n\n**Part 1: Derivation of the Step-Down Procedure**\n\nThe objective is to invert the step-up recursion to find $\\{k_m\\}$ and $F_{m-1}(z)$ from $F_m(z)$, starting with $m=N$ and proceeding down to $m=1$.\n\nLet the polynomial $F_m(z)$ be written in terms of its coefficients as $F_m(z) = \\sum_{n=0}^{m} f_m[n] z^{-n}$. The problem states that $F_N(z)$ is monic, which means $f_N[0]=1$. The recursion starts with $F_0(z)=1$, so $f_0[0]=1$. For $m \\ge 1$, the constant term of $F_m(z)$ comes solely from $F_{m-1}(z)$ in the recursion $F_{m}(z)=F_{m-1}(z)+k_{m}\\,z^{-m}F_{m-1}(z^{-1})$, because the term $z^{-m}F_{m-1}(z^{-1})$ contains only negative powers of $z$. Thus, by induction, $f_m[0]=f_{m-1}[0]=1$ for all $m$, meaning all $F_m(z)$ are monic.\n\nFirst, we determine the reflection coefficient $k_m$ from $F_m(z)$. The highest power of $z^{-1}$ in $F_m(z)$ is $m$. The coefficient of $z^{-m}$ is $f_m[m]$. Examining the step-up recursion:\n$$\nF_{m}(z) = F_{m-1}(z) + k_{m}\\,z^{-m}F_{m-1}(z^{-1})\n$$\nThe polynomial $F_{m-1}(z)$ has degree $m-1$, so it does not contribute to the $z^{-m}$ term. The term $z^{-m}F_{m-1}(z^{-1})$ is:\n$$\nz^{-m}F_{m-1}(z^{-1}) = z^{-m}\\sum_{n=0}^{m-1} f_{m-1}[n] (z^{-1})^{-n} = z^{-m}\\sum_{n=0}^{m-1} f_{m-1}[n] z^{n} = \\sum_{n=0}^{m-1} f_{m-1}[n] z^{n-m}\n$$\nThe coefficient of $z^{-m}$ in this expression occurs when $n-m=-m$, which implies $n=0$. This coefficient is $f_{m-1}[0]$. Therefore, the coefficient of $z^{-m}$ in $F_m(z)$ is $k_m f_{m-1}[0]$. Since $f_{m-1}[0]=1$, we have:\n$$\nk_m = f_m[m]\n$$\nThis provides the first step of the downward recursion: the $m$-th reflection coefficient is the last coefficient of the $m$-th order polynomial.\n\nNext, we must find $F_{m-1}(z)$ from $F_m(z)$ and $k_m$. We have the step-up equation:\n$$\nF_m(z) = F_{m-1}(z) + k_m z^{-m} F_{m-1}(z^{-1}) \\quad (1)\n$$\nTo create a system of equations, we form another equation by replacing $z$ with $z^{-1}$ and manipulating the result:\n$$\nF_m(z^{-1}) = F_{m-1}(z^{-1}) + k_m (z^{-1})^{-m} F_{m-1}((z^{-1})^{-1}) = F_{m-1}(z^{-1}) + k_m z^m F_{m-1}(z)\n$$\nMultiplying by $z^{-m}$ gives the \"reversed\" equation:\n$$\nz^{-m}F_m(z^{-1}) = z^{-m}F_{m-1}(z^{-1}) + k_m F_{m-1}(z) \\quad (2)\n$$\nWe now have a linear system in $F_{m-1}(z)$ and $z^{-m}F_{m-1}(z^{-1})$. To solve for $F_{m-1}(z)$, we can eliminate $z^{-m}F_{m-1}(z^{-1})$. From $(1)$, we have $z^{-m}F_{m-1}(z^{-1}) = \\frac{1}{k_m} [F_m(z) - F_{m-1}(z)]$. Substituting this into $(2)$:\n$$\nz^{-m}F_m(z^{-1}) = \\frac{1}{k_m} [F_m(z) - F_{m-1}(z)] + k_m F_{m-1}(z)\n$$\nMultiplying by $k_m$ (since $|k_m|1$, $k_m$ can be zero in principle, but for a lossless lattice, we assume $k_m \\neq \\pm 1$):\n$$\nk_m z^{-m}F_m(z^{-1}) = F_m(z) - F_{m-1}(z) + k_m^2 F_{m-1}(z)\n$$\nRearranging to solve for $F_{m-1}(z)$:\n$$\nF_{m-1}(z) (1 - k_m^2) = F_m(z) - k_m z^{-m}F_m(z^{-1})\n$$\nGiven $|k_m|1$, we know $1-k_m^2 \\neq 0$. Thus, we can divide to obtain the step-down recursion for the polynomial:\n$$\nF_{m-1}(z) = \\frac{F_m(z) - k_m z^{-m}F_m(z^{-1})}{1 - k_m^2}\n$$\nThe complete step-down procedure is as follows:\n1. Given $H(z)=\\sum_{n=0}^{N} h[n] z^{-n}$, identify $g = h[0]$.\n2. Construct the monic polynomial $F_N(z) = \\frac{H(z)}{g} = 1 + \\sum_{n=1}^{N} \\frac{h[n]}{h[0]} z^{-n}$. Let its coefficients be $f_N[n]$.\n3. For $m = N, N-1, \\dots, 1$:\n    a. Determine the reflection coefficient: $k_m = f_m[m]$.\n    b. Compute the next polynomial $F_{m-1}(z)$ using the derived recursion. Its coefficients $f_{m-1}[n]$ for $n \\in \\{0, \\dots, m-1\\}$ are given by $f_{m-1}[n] = \\frac{f_m[n] - k_m f_m[m-n]}{1 - k_m^2}$.\n\n**Part 2: Application to the Concrete System**\n\nThe given filter is $H(z)=2+\\frac{2}{5}z^{-1}-\\frac{2}{5}z^{-2}+\\frac{2}{5}z^{-3}-\\frac{2}{5}z^{-4}$. The order is $N=4$.\n\n1. The gain is $g = h[0] = 2$.\n\n2. The monic polynomial $F_4(z)$ is:\n$$\nF_4(z) = \\frac{H(z)}{2} = 1 + \\frac{1}{5}z^{-1} - \\frac{1}{5}z^{-2} + \\frac{1}{5}z^{-3} - \\frac{1}{5}z^{-4}\n$$\nThe coefficients are $f_4[0]=1$, $f_4[1]=\\frac{1}{5}$, $f_4[2]=-\\frac{1}{5}$, $f_4[3]=\\frac{1}{5}$, $f_4[4]=-\\frac{1}{5}$.\n\n3. We apply the step-down procedure.\n\n**For $m=4$**:\na. $k_4 = f_4[4] = -\\frac{1}{5}$.\nb. We compute the coefficients of $F_3(z)$. The denominator is $1 - k_4^2 = 1 - (-\\frac{1}{5})^2 = 1 - \\frac{1}{25} = \\frac{24}{25}$.\n   $f_3[1] = \\frac{f_4[1] - k_4 f_4[3]}{1 - k_4^2} = \\frac{\\frac{1}{5} - (-\\frac{1}{5})(\\frac{1}{5})}{\\frac{24}{25}} = \\frac{\\frac{1}{5} + \\frac{1}{25}}{\\frac{24}{25}} = \\frac{\\frac{6}{25}}{\\frac{24}{25}} = \\frac{6}{24} = \\frac{1}{4}$.\n   $f_3[2] = \\frac{f_4[2] - k_4 f_4[2]}{1 - k_4^2} = \\frac{-\\frac{1}{5}(1 - (-\\frac{1}{5}))}{\\frac{24}{25}} = \\frac{-\\frac{1}{5}(\\frac{6}{5})}{\\frac{24}{25}} = \\frac{-\\frac{6}{25}}{\\frac{24}{25}} = -\\frac{6}{24} = -\\frac{1}{4}$.\n   $f_3[3] = \\frac{f_4[3] - k_4 f_4[1]}{1 - k_4^2} = \\frac{\\frac{1}{5} - (-\\frac{1}{5})(\\frac{1}{5})}{\\frac{24}{25}} = \\frac{1}{4}$.\n   Thus, $F_3(z) = 1 + \\frac{1}{4}z^{-1} - \\frac{1}{4}z^{-2} + \\frac{1}{4}z^{-3}$.\n\n**For $m=3$**:\na. $k_3 = f_3[3] = \\frac{1}{4}$.\nb. We compute the coefficients of $F_2(z)$. The denominator is $1 - k_3^2 = 1 - (\\frac{1}{4})^2 = 1 - \\frac{1}{16} = \\frac{15}{16}$.\n   $f_2[1] = \\frac{f_3[1] - k_3 f_3[2]}{1 - k_3^2} = \\frac{\\frac{1}{4} - (\\frac{1}{4})(-\\frac{1}{4})}{\\frac{15}{16}} = \\frac{\\frac{1}{4} + \\frac{1}{16}}{\\frac{15}{16}} = \\frac{\\frac{5}{16}}{\\frac{15}{16}} = \\frac{5}{15} = \\frac{1}{3}$.\n   $f_2[2] = \\frac{f_3[2] - k_3 f_3[1]}{1 - k_3^2} = \\frac{-\\frac{1}{4} - (\\frac{1}{4})(\\frac{1}{4})}{\\frac{15}{16}} = \\frac{-\\frac{1}{4} - \\frac{1}{16}}{\\frac{15}{16}} = \\frac{-\\frac{5}{16}}{\\frac{15}{16}} = -\\frac{5}{15} = -\\frac{1}{3}$.\n   Thus, $F_2(z) = 1 + \\frac{1}{3}z^{-1} - \\frac{1}{3}z^{-2}$.\n\n**For $m=2$**:\na. $k_2 = f_2[2] = -\\frac{1}{3}$.\nb. We compute the coefficients of $F_1(z)$. The denominator is $1 - k_2^2 = 1 - (-\\frac{1}{3})^2 = 1 - \\frac{1}{9} = \\frac{8}{9}$.\n   $f_1[1] = \\frac{f_2[1] - k_2 f_2[1]}{1 - k_2^2} = \\frac{f_2[1](1-k_2)}{1-k_2^2} = \\frac{f_2[1]}{1+k_2} = \\frac{\\frac{1}{3}}{1-\\frac{1}{3}} = \\frac{\\frac{1}{3}}{\\frac{2}{3}} = \\frac{1}{2}$.\n   Thus, $F_1(z) = 1 + \\frac{1}{2}z^{-1}$.\n\n**For $m=1$**:\na. $k_1 = f_1[1] = \\frac{1}{2}$.\nb. The recursion terminates. As a check, we can compute $F_0(z) = \\frac{F_1(z) - k_1 z^{-1}F_1(z^{-1})}{1 - k_1^2} = \\frac{(1+\\frac{1}{2}z^{-1}) - \\frac{1}{2}z^{-1}(1+\\frac{1}{2}z)}{1 - \\frac{1}{4}} = \\frac{1+\\frac{1}{2}z^{-1} - \\frac{1}{2}z^{-1} - \\frac{1}{4}}{\\frac{3}{4}} = \\frac{\\frac{3}{4}}{\\frac{3}{4}} = 1$, which is correct.\n\nThe computed parameters are:\n$g = 2$\n$k_1 = \\frac{1}{2}$\n$k_2 = -\\frac{1}{3}$\n$k_3 = \\frac{1}{4}$\n$k_4 = -\\frac{1}{5}$\n\nThe ordered tuple $(k_1, k_2, k_3, k_4, g)$ is $(\\frac{1}{2}, -\\frac{1}{3}, \\frac{1}{4}, -\\frac{1}{5}, 2)$.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2}  -\\frac{1}{3}  \\frac{1}{4}  -\\frac{1}{5}  2 \\end{pmatrix}}$$", "id": "2879931"}, {"introduction": "A profound connection exists between the locations of a filter's zeros in the $z$-plane and the magnitudes of its corresponding lattice reflection coefficients. The Schur-Cohn stability test formalizes this by stating that a filter is minimum-phase if and only if all $|k_m| \\lt 1$. This exercise explores the practical implications of this theorem by tasking you with analyzing a non-minimum-phase filter, demonstrating how a zero outside the unit circle directly manifests as a reflection coefficient with a magnitude greater than unity during the step-down recursion [@problem_id:2879882].", "problem": "Consider a causal, order-$2$ finite impulse response (FIR) all-zero filter with monic numerator polynomial $B(z)$ defined by the two real zeros $z_{1}=2$ and $z_{2}=0.6$ through the factorization $B(z)=\\left(1-z_{1}z^{-1}\\right)\\left(1-z_{2}z^{-1}\\right)$. The filter is thus non-minimum-phase because one zero lies outside the unit circle. Treating $B(z)$ as the prediction-error filter polynomial in the Schur step-down (lattice) recursion for all-zero FIR structures, carry out the step-down recursion to obtain the reflection coefficients $\\{k_{2},k_{1}\\}$ that parameterize the corresponding two-stage lattice.\n\nYour tasks are:\n- Derive $B(z)$ explicitly in the $z^{-1}$-domain and identify its monic coefficients.\n- From first principles of the Schur step-down recursion for monic polynomials with real coefficients, compute the reflection coefficients stage-by-stage.\n- Determine which reflection coefficients have magnitudes strictly exceeding unity and explain how this circumstance relates to the presence of zeros outside the unit circle for this FIR system.\n\nAnswer specification:\n- Provide, as your final answer, the numerical values (not just indices) of the reflection coefficients among $\\{k_{1},k_{2}\\}$ whose magnitudes exceed unity, listed in a single row matrix in ascending order of the stage index.\n- Express each entry as an exact rational number. No rounding is permitted.\n- No physical units or angle units are involved.", "solution": "The problem requires the determination of reflection coefficients for a second-order finite impulse response (FIR) filter using the Schur step-down recursion.\n\nThe first task is to explicitly derive the polynomial $B(z)$. This polynomial is the highest-order prediction-error filter in our recursion, which we denote as $B_{2}(z)$.\nGiven the zeros $z_{1}=2$ and $z_{2}=0.6$, we have:\n$$ B_{2}(z) = (1 - 2z^{-1})(1 - 0.6z^{-1}) $$\nExpanding this expression yields the polynomial in the $z^{-1}$-domain:\n$$ B_{2}(z) = 1 - 0.6z^{-1} - 2z^{-1} + (2)(0.6)z^{-2} $$\n$$ B_{2}(z) = 1 - 2.6z^{-1} + 1.2z^{-2} $$\nFor expediency in calculation, we express the coefficients as rational numbers:\n$$ B_{2}(z) = 1 - \\frac{13}{5}z^{-1} + \\frac{6}{5}z^{-2} $$\nThis polynomial is of the form $B_{2}(z) = 1 + b_{2,1}z^{-1} + b_{2,2}z^{-2}$, with monic coefficients $b_{2,1} = -\\frac{13}{5}$ and $b_{2,2} = \\frac{6}{5}$.\n\nNext, we apply the Schur step-down recursion to find the reflection coefficients. The recursion operates from stage $m=M$ down to $m=1$. For a monic polynomial $B_m(z)$, the reflection coefficient $k_m$ is its last coefficient, $b_{m,m}$. The polynomial of the next lower stage, $B_{m-1}(z)$, is then calculated.\n\n**Stage $m=2$:**\nWe begin with the polynomial $B_{2}(z) = 1 - \\frac{13}{5}z^{-1} + \\frac{6}{5}z^{-2}$.\nThe reflection coefficient $k_{2}$ is the last coefficient of $B_{2}(z)$:\n$$ k_{2} = b_{2,2} = \\frac{6}{5} $$\n\nNow, we must compute the polynomial for the next stage, $B_{1}(z)$. The recursive formula is:\n$$ B_{m-1}(z) = \\frac{1}{1-k_{m}^{2}} \\left[ B_{m}(z) - k_{m} B_{m}^{R}(z) \\right] $$\nwhere $B_{m}^{R}(z)$ is the reverse polynomial, defined as $B_{m}^{R}(z) = z^{-m}B_{m}(z^{-1})$.\nFor $m=2$, we first find $B_{2}^{R}(z)$:\n$$ B_{2}^{R}(z) = z^{-2}B_{2}(z^{-1}) = z^{-2}\\left(1 - \\frac{13}{5}z + \\frac{6}{5}z^{2}\\right) = \\frac{6}{5} - \\frac{13}{5}z^{-1} + z^{-2} $$\nNow we compute $B_{1}(z)$:\n$$ B_{1}(z) = \\frac{1}{1-k_{2}^{2}} \\left[ B_{2}(z) - k_{2} B_{2}^{R}(z) \\right] $$\nThe scaling factor is $1-k_{2}^{2} = 1 - \\left(\\frac{6}{5}\\right)^{2} = 1 - \\frac{36}{25} = -\\frac{11}{25}$.\nThe term in the brackets is:\n$$ \\left(1 - \\frac{13}{5}z^{-1} + \\frac{6}{5}z^{-2}\\right) - \\frac{6}{5}\\left(\\frac{6}{5} - \\frac{13}{5}z^{-1} + z^{-2}\\right) $$\n$$ = \\left(1 - \\frac{13}{5}z^{-1} + \\frac{6}{5}z^{-2}\\right) - \\left(\\frac{36}{25} - \\frac{78}{25}z^{-1} + \\frac{6}{5}z^{-2}\\right) $$\n$$ = \\left(1 - \\frac{36}{25}\\right) + \\left(-\\frac{13}{5} + \\frac{78}{25}\\right)z^{-1} + \\left(\\frac{6}{5} - \\frac{6}{5}\\right)z^{-2} $$\n$$ = \\left(\\frac{25-36}{25}\\right) + \\left(\\frac{-65+78}{25}\\right)z^{-1} + 0 \\cdot z^{-2} $$\n$$ = -\\frac{11}{25} + \\frac{13}{25}z^{-1} $$\nSubstituting this back into the expression for $B_{1}(z)$:\n$$ B_{1}(z) = \\frac{-\\frac{11}{25} + \\frac{13}{25}z^{-1}}{-\\frac{11}{25}} = 1 - \\frac{13}{11}z^{-1} $$\n\n**Stage $m=1$:**\nFrom the polynomial $B_{1}(z) = 1 - \\frac{13}{11}z^{-1}$, which is of the form $B_{1}(z) = 1 + b_{1,1}z^{-1}$, we find the reflection coefficient $k_{1}$ as its last coefficient:\n$$ k_{1} = b_{1,1} = -\\frac{13}{11} $$\nThe recursion is now complete, yielding the set of reflection coefficients $\\{k_{2}, k_{1}\\} = \\{\\frac{6}{5}, -\\frac{13}{11}\\}$.\n\nFinally, we analyze the magnitudes of these coefficients and their relation to the filter's zeros.\nThe problem specifies that the filter is non-minimum-phase because one zero, $z_{1}=2$, lies outside the unit circle $|z|=1$.\nAccording to the Schur-Cohn stability criterion, a polynomial has all its roots strictly inside the unit circle if and only if all reflection coefficients in its lattice realization have magnitudes strictly less than $1$. Conversely, if any $|k_{m}| \\ge 1$, the polynomial is not minimum-phase.\nLet us examine our computed coefficients:\n$$ |k_{2}| = \\left|\\frac{6}{5}\\right| = \\frac{6}{5} = 1.2 $$\n$$ |k_{1}| = \\left|-\\frac{13}{11}\\right| = \\frac{13}{11} \\approx 1.18 $$\nBoth $|k_{2}|$ and $|k_{1}|$ are strictly greater than $1$. This confirms the non-minimum-phase nature of the filter. The presence of a zero outside the unit circle necessitates that at least one reflection coefficient has a magnitude greater than or equal to unity. In this case, the first coefficient computed, $k_{2}$, already signals this property with $|k_{2}|  1$.\n\nThe final answer requires the listing of the reflection coefficients whose magnitudes exceed unity, in ascending order of their stage index. Both $k_{1}$ and $k_{2}$ satisfy this condition.", "answer": "$$ \\boxed{\\begin{pmatrix} -\\frac{13}{11}  \\frac{6}{5} \\end{pmatrix}} $$", "id": "2879882"}]}