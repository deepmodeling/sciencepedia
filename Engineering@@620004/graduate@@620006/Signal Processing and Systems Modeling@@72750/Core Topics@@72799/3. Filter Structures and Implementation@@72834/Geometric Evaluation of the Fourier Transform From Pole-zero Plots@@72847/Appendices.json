{"hands_on_practices": [{"introduction": "Understanding the frequency response of a system directly from its pole-zero plot is a cornerstone of intuitive filter analysis. For a second-order resonant system, it is tempting to assume the peak magnitude occurs precisely at the pole's angle, but this is often not the case. This exercise challenges you to use geometric reasoning to predict how the presence of a conjugate pole 'pulls' the peak frequency, a crucial insight into the behavior of all resonant filters [@problem_id:1722830].", "problem": "A stable, causal, second-order discrete-time linear time-invariant (LTI) system is characterized by the transfer function $H(z)$. The system has a pair of complex-conjugate poles located at $p_1 = re^{j\\theta_0}$ and $p_2 = re^{-j\\theta_0}$, and two zeros at the origin, $z=0$. The transfer function can be written as:\n$$\nH(z) = \\frac{K z^2}{(z - re^{j\\theta_0})(z - re^{-j\\theta_0})}\n$$\nwhere $K$ is a positive real constant. The pole radius $r$ is constrained by $0 < r < 1$, and the pole angle $\\theta_0$ is constrained by $0 < \\theta_0 < \\frac{\\pi}{2}$.\n\nThe frequency response of this system is given by the Discrete-Time Fourier Transform (DTFT), $H(e^{j\\omega})$, for a real frequency variable $\\omega$. Let $\\omega_{peak}$ be the frequency in the range $0 \\le \\omega \\le \\pi$ at which the magnitude of the frequency response, $|H(e^{j\\omega})|$, is maximized.\n\nBased on a geometric evaluation of the DTFT from the system's pole-zero plot, determine the relationship between the peak frequency $\\omega_{peak}$ and the pole angle $\\theta_0$.\n\nA. $\\omega_{peak}  \\theta_0$\n\nB. $\\omega_{peak} = \\theta_0$\n\nC. $\\omega_{peak} > \\theta_0$\n\nD. The relationship depends on the value of the gain $K$.\n\nE. The relationship cannot be determined without specific numerical values for $r$ and $\\theta_0$.", "solution": "For the frequency response, substitute $z=e^{j\\omega}$ into $H(z)$ to obtain\n$$\nH(e^{j\\omega})=\\frac{K e^{j2\\omega}}{\\left(e^{j\\omega}-r e^{j\\theta_{0}}\\right)\\left(e^{j\\omega}-r e^{-j\\theta_{0}}\\right)}.\n$$\nOn the unit circle $|e^{j2\\omega}|=1$, so the magnitude is\n$$\n|H(e^{j\\omega})|=\\frac{K}{\\left|e^{j\\omega}-r e^{j\\theta_{0}}\\right|\\left|e^{j\\omega}-r e^{-j\\theta_{0}}\\right|}.\n$$\nTherefore the peak of $|H(e^{j\\omega})|$ occurs where the product of the distances to the two poles is minimized. Define\n$$\nA(\\omega)=\\left|e^{j\\omega}-r e^{j\\theta_{0}}\\right|^{2}=1+r^{2}-2r\\cos(\\omega-\\theta_{0}),\n$$\n$$\nB(\\omega)=\\left|e^{j\\omega}-r e^{-j\\theta_{0}}\\right|^{2}=1+r^{2}-2r\\cos(\\omega+\\theta_{0}),\n$$\nand set\n$$\nP(\\omega)=A(\\omega)B(\\omega).\n$$\nMaximizing $|H(e^{j\\omega})|$ is equivalent to minimizing $P(\\omega)$ on $0\\leq\\omega\\leq\\pi$. Use the product form with $\\cos(\\omega\\pm\\theta_{0})$ expanded:\n$$\nA(\\omega)=1+r^{2}-2r\\left(\\cos\\omega\\cos\\theta_{0}+\\sin\\omega\\sin\\theta_{0}\\right),\n$$\n$$\nB(\\omega)=1+r^{2}-2r\\left(\\cos\\omega\\cos\\theta_{0}-\\sin\\omega\\sin\\theta_{0}\\right).\n$$\nThen\n$$\nP(\\omega)=\\left(1+r^{2}-2r\\cos\\omega\\cos\\theta_{0}\\right)^{2}-4r^{2}\\sin^{2}\\omega\\,\\sin^{2}\\theta_{0}.\n$$\nUsing $\\sin^{2}\\omega=1-\\cos^{2}\\omega$ and simplifying,\n$$\nP(\\omega)=4r^{2}\\cos^{2}\\omega-4r(1+r^{2})\\cos\\theta_{0}\\cos\\omega+\\left[(1+r^{2})^{2}-4r^{2}\\sin^{2}\\theta_{0}\\right].\n$$\nLet $X=\\cos\\omega\\in[-1,1]$. This is a convex quadratic in $X$:\n$$\nP(X)=4r^{2}X^{2}-4r(1+r^{2})\\cos\\theta_{0}\\,X+\\text{const}.\n$$\nThe unconstrained minimizer is at\n$$\nX^{\\ast}=\\frac{(1+r^{2})\\cos\\theta_{0}}{2r}.\n$$\nSince $0r1$, the factor $(1+r^{2})/(2r)=(r+1/r)/21$, and with $0\\theta_{0}\\pi/2$ we have $\\cos\\theta_{0}\\in(0,1)$, hence $X^{\\ast}\\cos\\theta_{0}0$. The constrained minimizer over $X\\in[-1,1]$ is therefore\n$$\n\\cos\\omega_{\\text{peak}}=\\min\\left\\{1,\\; \\frac{(1+r^{2})\\cos\\theta_{0}}{2r}\\right\\}.\n$$\nIn either case,\n- if $\\frac{(1+r^{2})\\cos\\theta_{0}}{2r}\\leq 1$, then $\\cos\\omega_{\\text{peak}}=\\frac{(1+r^{2})\\cos\\theta_{0}}{2r}\\cos\\theta_{0}$, hence $\\omega_{\\text{peak}}\\theta_{0}$ since $\\cos$ is strictly decreasing on $[0,\\pi]$,\n- if $\\frac{(1+r^{2})\\cos\\theta_{0}}{2r}1$, then $\\omega_{\\text{peak}}=0\\theta_{0}$.\n\nThus for all $0r1$ and $0\\theta_{0}\\pi/2$,\n$$\n\\omega_{\\text{peak}}\\theta_{0}.\n$$\nMoreover, the positive gain $K$ only scales the magnitude and does not affect the maximizing frequency. Therefore the correct relationship is $\\omega_{\\text{peak}}\\theta_{0}$.", "answer": "$$\\boxed{A}$$", "id": "1722830"}, {"introduction": "Moving from the qualitative analysis of response peaks to the quantitative characterization of filter notches, this practice focuses on the effect of a single zero. You will first derive a fundamental identity for the shape of the magnitude response created by a zero on the unit circle. You will then generalize this to a more practical case where the zero is near the unit circle, and calculate a key performance metric: the notch's full width at half maximum (FWHM) [@problem_id:2874556].", "problem": "Consider a discrete-time, linear time-invariant system with rational transfer function evaluated on the unit circle in the complex plane via the Discrete-Time Fourier Transform (DTFT). The geometric evaluation principle states that the magnitude of the frequency response at angular frequency $\\omega$ is given by the ratio of products of Euclidean distances in the complex plane from the point $e^{j\\omega}$ to the zeros and poles of the transfer function.\n\n1) Start from this geometric principle and the angle addition formulas from trigonometry. For a system having a single zero located on the unit circle at $z_{0}=e^{j\\omega_{0}}$, use the geometry of the complex plane to derive the identity\n$$\n\\left|e^{j\\omega}-e^{j\\omega_{0}}\\right| \\;=\\; 2\\left|\\sin\\!\\left(\\frac{\\omega-\\omega_{0}}{2}\\right)\\right|.\n$$\nBriefly interpret this identity in terms of how a unit-circle zero creates a notch in the magnitude of the frequency response at $\\omega=\\omega_{0}$.\n\n2) Now move the zero radially to $z_{0}=r\\,e^{j\\omega_{0}}$ with $0r\\leq 1$, and consider the one-zero transfer function\n$$\nH(z)\\;=\\;K\\,\\bigl(1 - z_{0}\\,z^{-1}\\bigr),\n$$\nwith real gain $K0$ chosen to normalize the far-from-notch magnitude so that\n$$\n\\bigl|H\\!\\left(e^{j(\\omega_{0}+\\pi)}\\right)\\bigr| \\;=\\; 1.\n$$\nUsing the same geometric distance interpretation, express $\\bigl|H(e^{j\\omega})\\bigr|$ as a function of the frequency offset $\\Delta\\!\\omega=\\omega-\\omega_{0}$ and the radius $r$, and use this to define and compute the full width at half maximum (FWHM) of the notch. Here, the FWHM is defined as the total width in radians between the two frequencies symmetric about $\\omega_{0}$ at which $\\bigl|H(e^{j\\omega})\\bigr|$ equals the half-power level $2^{-1/2}$ relative to the normalized far-from-notch magnitude. State any condition(s) on $r$ under which such half-power crossings exist, and determine the FWHM in closed form as a function of $r$.\n\nYour final answer must be the FWHM in radians as a single closed-form analytic expression in terms of $r$. No numerical approximation is required, and no rounding should be applied.", "solution": "The problem as stated is logically consistent, scientifically grounded in the principles of digital signal processing, and well-posed. All provided information is sufficient for a unique solution. We will therefore proceed with a rigorous derivation.\n\nFirst, we address the derivation of the identity in Part 1. We are asked to prove that for a single zero on the unit circle at $z_{0}=e^{j\\omega_{0}}$, the Euclidean distance from a point $e^{j\\omega}$ on the unit circle to this zero is given by $|e^{j\\omega}-e^{j\\omega_{0}}| = 2|\\sin(\\frac{\\omega-\\omega_{0}}{2})|$.\nWe begin with the expression $|e^{j\\omega}-e^{j\\omega_{0}}|$. A direct geometric approach is most efficient. We factor out a complex exponential term corresponding to the average of the two angles:\n$$\ne^{j\\omega}-e^{j\\omega_{0}} = e^{j\\frac{\\omega+\\omega_{0}}{2}} \\left( e^{j\\frac{\\omega-\\omega_{0}}{2}} - e^{-j\\frac{\\omega-\\omega_{0}}{2}} \\right).\n$$\nUsing Euler's formula, we recall the identity $\\sin(\\theta) = \\frac{e^{j\\theta} - e^{-j\\theta}}{2j}$, which implies $e^{j\\theta} - e^{-j\\theta} = 2j\\sin(\\theta)$. Applying this to our expression gives:\n$$\ne^{j\\omega}-e^{j\\omega_{0}} = e^{j\\frac{\\omega+\\omega_{0}}{2}} \\left( 2j\\sin\\left(\\frac{\\omega-\\omega_{0}}{2}\\right) \\right).\n$$\nWe now compute the magnitude of both sides. The magnitude of a product is the product of the magnitudes:\n$$\n|e^{j\\omega}-e^{j\\omega_{0}}| = \\left|e^{j\\frac{\\omega+\\omega_{0}}{2}}\\right| \\left|2j\\right| \\left|\\sin\\left(\\frac{\\omega-\\omega_{0}}{2}\\right)\\right|.\n$$\nThe magnitude of any complex exponential $e^{j\\phi}$ is always $1$, and the magnitude of $2j$ is $|2j| = \\sqrt{0^2 + 2^2} = 2$. Therefore, we arrive at the required identity:\n$$\n|e^{j\\omega}-e^{j\\omega_{0}}| = 1 \\cdot 2 \\cdot \\left|\\sin\\left(\\frac{\\omega-\\omega_{0}}{2}\\right)\\right| = 2\\left|\\sin\\left(\\frac{\\omega-\\omega_{0}}{2}\\right)\\right|.\n$$\nThe interpretation of this identity is straightforward. The magnitude of a system's frequency response $|H(e^{j\\omega})|$ is proportional to the distance from the point $e^{j\\omega}$ to the system's zeros. For a single zero at $e^{j\\omega_0}$, the magnitude response is proportional to $2|\\sin(\\frac{\\omega-\\omega_0}{2})|$. When the frequency $\\omega$ is equal to $\\omega_0$, this distance is zero because $\\sin(0) = 0$. This creates a perfect null, or \"notch,\" in the frequency response, completely attenuating the signal component at frequency $\\omega_0$. As $\\omega$ moves away from $\\omega_0$, the magnitude increases, characteristic of a notch filter.\n\nNext, for Part 2, we analyze the system with the transfer function $H(z) = K(1 - z_0 z^{-1})$, where the zero is $z_0 = r e^{j\\omega_0}$ with $0  r \\le 1$ and $K  0$. The frequency response is $H(e^{j\\omega}) = K(1 - r e^{j\\omega_0} e^{-j\\omega})$. The magnitude of the frequency response is given by the geometric principle as the gain $K$ multiplied by the distance from the point $e^{j\\omega}$ to the zero $z_0$.\n$$\n|H(e^{j\\omega})| = K |e^{j\\omega} - z_0| = K |e^{j\\omega} - r e^{j\\omega_0}|.\n$$\nTo calculate this magnitude, we find its square:\n$$\n|e^{j\\omega} - r e^{j\\omega_0}|^2 = (e^{j\\omega} - r e^{j\\omega_0})(e^{-j\\omega} - r e^{-j\\omega_0}) = 1 - r e^{j(\\omega-\\omega_0)} - r e^{-j(\\omega-\\omega_0)} + r^2 = 1 + r^2 - 2r \\cos(\\omega - \\omega_0).\n$$\nLetting $\\Delta\\omega = \\omega - \\omega_0$, the squared magnitude of the frequency response is $|H(e^{j\\omega})|^2 = K^2 (1 + r^2 - 2r \\cos(\\Delta\\omega))$.\nThe gain $K$ is determined by the normalization condition $|H(e^{j(\\omega_0+\\pi)})| = 1$. At this frequency, $\\Delta\\omega = (\\omega_0+\\pi) - \\omega_0 = \\pi$, and $\\cos(\\pi) = -1$.\n$$\n|H(e^{j(\\omega_0+\\pi)})|^2 = 1^2 = K^2 (1 + r^2 - 2r(-1)) = K^2 (1 + 2r + r^2) = K^2(1+r)^2.\n$$\nTaking the square root and using $K0, r0$, we find $1 = K(1+r)$, which gives $K = \\frac{1}{1+r}$.\nThe normalized magnitude response is thus:\n$$\n|H(e^{j\\omega})| = \\frac{\\sqrt{1 + r^2 - 2r \\cos(\\Delta\\omega)}}{1+r}.\n$$\nThe Full Width at Half Maximum (FWHM) is the width $2\\Delta\\omega_{1/2}$ between frequencies where the magnitude is at the half-power level relative to the normalized maximum. The reference magnitude is $1$, so the half-power level is $1/\\sqrt{2}$. We set $|H(e^{j\\omega})| = \\frac{1}{\\sqrt{2}}$ and solve for the corresponding frequency offset, which we denote $\\Delta\\omega_{1/2}$.\n$$\n\\frac{\\sqrt{1 + r^2 - 2r \\cos(\\Delta\\omega_{1/2})}}{1+r} = \\frac{1}{\\sqrt{2}}.\n$$\nSquaring both sides yields:\n$$\n\\frac{1 + r^2 - 2r \\cos(\\Delta\\omega_{1/2})}{(1+r)^2} = \\frac{1}{2}.\n$$\nWe solve for $\\cos(\\Delta\\omega_{1/2})$:\n$$\n2(1 + r^2 - 2r \\cos(\\Delta\\omega_{1/2})) = (1+r)^2 = 1 + 2r + r^2\n$$\n$$\n2 + 2r^2 - 4r \\cos(\\Delta\\omega_{1/2}) = 1 + 2r + r^2\n$$\n$$\n4r \\cos(\\Delta\\omega_{1/2}) = (2 + 2r^2) - (1 + 2r + r^2) = 1 - 2r + r^2 = (1-r)^2\n$$\n$$\n\\cos(\\Delta\\omega_{1/2}) = \\frac{(1-r)^2}{4r}.\n$$\nFor a real solution for $\\Delta\\omega_{1/2}$ to exist, we must have $|\\cos(\\Delta\\omega_{1/2})| \\le 1$. Since $r  0$ and $(1-r)^2 \\ge 0$, the expression is non-negative. We only need to check the condition:\n$$\n\\frac{(1-r)^2}{4r} \\le 1 \\implies (1-r)^2 \\le 4r \\implies 1 - 2r + r^2 \\le 4r \\implies r^2 - 6r + 1 \\le 0.\n$$\nThe roots of the quadratic equation $x^2 - 6x + 1 = 0$ are $x = 3 \\pm 2\\sqrt{2}$. Since the parabola opens upward, the inequality holds for $r$ between the roots: $3 - 2\\sqrt{2} \\le r \\le 3 + 2\\sqrt{2}$. Given the problem constraint $0  r \\le 1$, the condition for the existence of half-power crossings is the intersection of these ranges, which is $3 - 2\\sqrt{2} \\le r \\le 1$.\n\nUnder this condition, the half-width $\\Delta\\omega_{1/2}$ is found by taking the inverse cosine. By symmetry of the cosine function, there are two solutions, $\\pm \\Delta\\omega_{1/2}$, symmetrically placed around $\\Delta\\omega=0$.\n$$\n\\Delta\\omega_{1/2} = \\arccos\\left(\\frac{(1-r)^2}{4r}\\right).\n$$\nThe Full Width at Half Maximum (FWHM) is the total width, which is the difference between these two solutions: $\\Delta\\omega_{1/2} - (-\\Delta\\omega_{1/2}) = 2\\Delta\\omega_{1/2}$.\nTherefore, the FWHM is:\n$$\n\\text{FWHM} = 2 \\arccos\\left(\\frac{(1-r)^2}{4r}\\right).\n$$\nThis is the final closed-form expression for the FWHM of the notch as a function of the zero's radial position $r$.", "answer": "$$\\boxed{2\\arccos\\left(\\frac{(1-r)^{2}}{4r}\\right)}$$", "id": "2874556"}, {"introduction": "A truly deep understanding of a system comes not just from evaluating its response, but from knowing how sensitive that response is to perturbations in its parameters. This advanced practice explores the sensitivity of the frequency response to infinitesimal movements of a single pole. By comparing the impact of radial versus tangential pole shifts, you will develop a nuanced, geometric understanding of how pole location affects filter stability and performance, a concept vital for robust filter design and quantization error analysis [@problem_id:2874532].", "problem": "A linear time-invariant discrete-time system has a rational system function $H(z)$ with no poles or zeros on the unit circle. The discrete-time Fourier transform (DTFT) is $H(e^{j\\omega})$, obtained by evaluating $H(z)$ on the unit circle $z=e^{j\\omega}$. It is known from the pole-zero geometry of $H(z)$ that the magnitude $|H(e^{j\\omega})|$ can be represented in terms of distances from $e^{j\\omega}$ to the poles and zeros of $H(z)$ in the complex $z$-plane.\n\nFix a frequency $\\omega$ and assume all poles and zeros are held fixed except for one pole at $p=r e^{j\\theta}$ with $0r1$. Consider infinitesimal perturbations of the pole location by a Euclidean distance $\\delta$ in the complex $z$-plane along two directions:\n- Radially outward from the origin (increasing $r$) at fixed angle $\\theta$.\n- Tangentially along the circle centered at the origin with radius $r$ (increasing $\\theta$) at fixed $r$.\n\nUsing only first-order geometric approximations based on the distance interpretation of $|H(e^{j\\omega})|$, and treating the change in $|H(e^{j\\omega})|$ as dominated by the movement of this single pole, derive the ratio\n$$\nR(\\omega,r,\\theta) \\equiv \\frac{\\text{absolute first-order fractional change in }|H(e^{j\\omega})|\\text{ for a radial movement of length }\\delta}{\\text{absolute first-order fractional change in }|H(e^{j\\omega})|\\text{ for a tangential movement of length }\\delta}.\n$$\nAll angles are in radians. Express your final answer as a single, closed-form analytic expression in terms of $r$ and the angle difference $\\omega-\\theta$. No numerical evaluation is required. The two movements are to be compared for the same Euclidean displacement length $\\delta$ in the $z$-plane. The final answer must be a single analytic expression. No units are required.", "solution": "The magnitude of the system's frequency response, $|H(e^{j\\omega})|$, is given by:\n$$ |H(e^{j\\omega})| = |K| \\frac{\\prod_{m} |e^{j\\omega} - z_m|}{\\prod_{k} |e^{j\\omega} - p_k|} $$\nSince all poles and zeros are fixed except for one pole $p = re^{j\\theta}$, the change in $|H(e^{j\\omega})|$ is dominated by the change in the distance to this pole, $D = |e^{j\\omega} - p|$. We can express the magnitude response as $|H(e^{j\\omega})| \\approx C / D$, where $C$ is a constant incorporating all other fixed terms.\n\nThe first-order fractional change in the magnitude is given by its logarithmic derivative:\n$$ \\frac{d|H|}{|H|} = d(\\ln|H|) \\approx d(\\ln(C/D)) = -d(\\ln D) = -\\frac{dD}{D} $$\nThe absolute fractional change is therefore $|dD|/D$. We need to compare this change for radial and tangential movements of the pole $p$. The ratio to be found is:\n$$ R = \\frac{\\text{absolute fractional change (radial)}}{\\text{absolute fractional change (tangential)}} = \\frac{|dD_{\\text{rad}}|/D}{|dD_{\\text{tan}}|/D} = \\frac{|dD_{\\text{rad}}|}{|dD_{\\text{tan}}|} $$\nTo find the differential $dD$, we first express the squared distance $D^2$ using the law of cosines in the complex plane:\n$$ D^2 = |e^{j\\omega} - re^{j\\theta}|^2 = 1 + r^2 - 2r\\cos(\\omega - \\theta) $$\nTaking the total differential of this equation gives:\n$$ 2D \\, dD = (2r - 2\\cos(\\omega-\\theta))dr - 2r\\sin(\\omega-\\theta)d\\theta $$\n$$ dD = \\frac{r - \\cos(\\omega-\\theta)}{D} dr - \\frac{r\\sin(\\omega-\\theta)}{D} d\\theta $$\nNow, we analyze the two types of movement for a displacement of length $\\delta$:\n1.  **Radial Movement:** A move radially outward means $dr = \\delta$ and $d\\theta = 0$.\n    $$ dD_{\\text{rad}} = \\frac{r - \\cos(\\omega-\\theta)}{D} \\delta $$\n2.  **Tangential Movement:** A move tangentially in the direction of increasing $\\theta$ corresponds to an arc length of $\\delta$. For an infinitesimal move, this means $r \\cdot d\\theta = \\delta$, so $d\\theta = \\delta/r$. The radial change is $dr=0$.\n    $$ dD_{\\text{tan}} = -\\frac{r\\sin(\\omega-\\theta)}{D} \\left(\\frac{\\delta}{r}\\right) = -\\frac{\\sin(\\omega-\\theta)}{D} \\delta $$\nFinally, we compute the ratio $R$:\n$$ R = \\frac{|dD_{\\text{rad}}|}{|dD_{\\text{tan}}|} = \\frac{\\left|\\frac{r - \\cos(\\omega-\\theta)}{D} \\delta\\right|}{\\left|-\\frac{\\sin(\\omega-\\theta)}{D} \\delta\\right|} $$\nThe terms $|\\delta/D|$ cancel, leaving:\n$$ R = \\frac{|r - \\cos(\\omega-\\theta)|}{|\\sin(\\omega-\\theta)|} $$\nThis is the final expression for the ratio, which depends only on the pole's radius $r$ and the angle difference $\\omega-\\theta$.", "answer": "$$\n\\boxed{\\frac{|r - \\cos(\\omega - \\theta)|}{|\\sin(\\omega - \\theta)|}}\n$$", "id": "2874532"}]}