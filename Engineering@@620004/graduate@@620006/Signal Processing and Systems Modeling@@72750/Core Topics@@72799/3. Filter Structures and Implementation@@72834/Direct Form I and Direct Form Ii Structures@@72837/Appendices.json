{"hands_on_practices": [{"introduction": "Digital filters are often implemented using standard \"blueprints\" called realization structures. The Direct Form II structure is prized for its efficiency, minimizing memory usage by using a single set of delay elements for both the feedforward and feedback paths. This first practice focuses on the fundamental skill of translating the defining time-domain equations of a Direct Form II filter into its comprehensive z-domain transfer function, $H(z)$, which fully characterizes the system's input-output relationship. [@problem_id:1714613]", "problem": "A discrete-time, linear time-invariant (LTI) system, such as one used in a digital audio equalizer, is implemented using a computational structure known as the Direct Form II realization. This structure is efficient in terms of memory as it minimizes the number of delay elements.\n\nThe system's behavior is described by the relationship between its input sequence $x[n]$, its output sequence $y[n]$, and an internal intermediate sequence $w[n]$. The intermediate sequence $w[n]$ is generated from the input and its own past values according to the recursive difference equation:\n$$w[n] = x[n] - a_1 w[n-1] - a_2 w[n-2]$$\nThe output sequence $y[n]$ is then formed from the current and past values of this intermediate sequence according to the non-recursive difference equation:\n$$y[n] = b_0 w[n] + b_1 w[n-1] + b_2 w[n-2]$$\nFor a particular configuration of this system, the filter coefficients are given as:\n$a_1 = -0.7$\n$a_2 = 0.1$\n$b_0 = 2$\n$b_1 = 0.5$\n$b_2 = -0.3$\n\nDetermine the overall transfer function $H(z) = Y(z)/X(z)$ of the system.", "solution": "The problem asks for the transfer function $H(z)$ of a system described by two difference equations that define its Direct Form II structure. The transfer function is the ratio of the Z-transform of the output, $Y(z)$, to the Z-transform of the input, $X(z)$. We can find this by first taking the Z-transform of each difference equation and then combining them algebraically.\n\nThe first equation relates the intermediate signal $w[n]$ to the input signal $x[n]$:\n$$w[n] = x[n] - a_1 w[n-1] - a_2 w[n-2]$$\nWe apply the Z-transform to this equation. Using the time-shifting property of the Z-transform, which states that $\\mathcal{Z}\\{f[n-k]\\} = z^{-k}F(z)$, we get:\n$$W(z) = X(z) - a_1 z^{-1} W(z) - a_2 z^{-2} W(z)$$\nNow, we rearrange this equation to find the relationship between $W(z)$ and $X(z)$. We group all terms involving $W(z)$ on one side:\n$$W(z) + a_1 z^{-1} W(z) + a_2 z^{-2} W(z) = X(z)$$\nFactoring out $W(z)$, we have:\n$$W(z) (1 + a_1 z^{-1} + a_2 z^{-2}) = X(z)$$\nThis allows us to express the ratio of $W(z)$ to $X(z)$ as a transfer function, let's call it $H_1(z)$:\n$$H_1(z) = \\frac{W(z)}{X(z)} = \\frac{1}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\n\nNext, we consider the second equation, which relates the output signal $y[n]$ to the intermediate signal $w[n]$:\n$$y[n] = b_0 w[n] + b_1 w[n-1] + b_2 w[n-2]$$\nAgain, we apply the Z-transform and its time-shifting property:\n$$Y(z) = b_0 W(z) + b_1 z^{-1} W(z) + b_2 z^{-2} W(z)$$\nFactoring out $W(z)$ from the right side gives:\n$$Y(z) = W(z) (b_0 + b_1 z^{-1} + b_2 z^{-2})$$\nThis defines the transfer function from the intermediate signal to the output, let's call it $H_2(z)$:\n$$H_2(z) = \\frac{Y(z)}{W(z)} = b_0 + b_1 z^{-1} + b_2 z^{-2}$$\n\nThe overall transfer function $H(z) = Y(z)/X(z)$ is the product of these two transfer functions, as the system is a cascade of $H_1(z)$ followed by $H_2(z)$:\n$$H(z) = \\frac{Y(z)}{X(z)} = \\frac{Y(z)}{W(z)} \\cdot \\frac{W(z)}{X(z)} = H_2(z) H_1(z)$$\nSubstituting the expressions for $H_1(z)$ and $H_2(z)$:\n$$H(z) = (b_0 + b_1 z^{-1} + b_2 z^{-2}) \\cdot \\left( \\frac{1}{1 + a_1 z^{-1} + a_2 z^{-2}} \\right)$$\n$$H(z) = \\frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\nThis is the general form of the transfer function for a second-order IIR filter in Direct Form II.\n\nFinally, we substitute the given numerical values for the coefficients:\n$a_1 = -0.7$\n$a_2 = 0.1$\n$b_0 = 2$\n$b_1 = 0.5$\n$b_2 = -0.3$\n\nPlugging these into the general expression for $H(z)$:\n$$H(z) = \\frac{2 + (0.5) z^{-1} + (-0.3) z^{-2}}{1 + (-0.7) z^{-1} + (0.1) z^{-2}}$$\n$$H(z) = \\frac{2 + 0.5 z^{-1} - 0.3 z^{-2}}{1 - 0.7 z^{-1} + 0.1 z^{-2}}$$\nThis is the final closed-form expression for the system's transfer function.", "answer": "$$\\boxed{\\frac{2 + 0.5z^{-1} - 0.3z^{-2}}{1 - 0.7z^{-1} + 0.1z^{-2}}}$$", "id": "1714613"}, {"introduction": "While Direct Form I and Direct Form II structures appear different graphically, they can implement the exact same filter. This exercise reveals the elegant principle that connects them: the commutative property of cascaded Linear Time-Invariant (LTI) systems. By exploring what happens when you swap the feedforward and feedback sections of a Direct Form I structure, you will discover that the overall transfer function remains unchanged, conceptually revealing the origin of the memory-efficient Direct Form II realization. [@problem_id:1714590]", "problem": "A causal, linear time-invariant (LTI) system with input $x[n]$ and output $y[n]$ is implemented using a Direct Form I structure. This realization is conceptually divided into two cascaded subsystems: a feedforward section and a feedback section.\n\nThe feedforward section first processes the input $x[n]$ to generate an intermediate signal $w[n]$ according to the relation:\n$$w[n] = \\beta_0 x[n] + \\beta_1 x[n-1]$$\n\nThis intermediate signal $w[n]$ is then processed by the feedback section to produce the final output $y[n]$ based on the difference equation:\n$$y[n] - \\alpha_1 y[n-1] - \\alpha_2 y[n-2] = w[n]$$\nThe coefficients $\\alpha_1, \\alpha_2, \\beta_0, \\beta_1$ are real-valued constants.\n\nA new system is constructed by swapping the order of these two sections. In this new configuration, the input $x[n]$ is first sent to the block that was originally the feedback section, producing a new intermediate signal $v[n]$. This signal $v[n]$ is subsequently fed into the block that was originally the feedforward section, yielding a new final output $y_{new}[n]$.\n\nLet $H_{new}(z)$ be the transfer function of this new system. Which of the following expressions correctly represents $H_{new}(z)$?\n\nA. $H_{new}(z) = \\frac{\\beta_0 + \\beta_1 z^{-1}}{1 - \\alpha_1 z^{-1} - \\alpha_2 z^{-2}}$\n\nB. $H_{new}(z) = \\frac{1 - \\alpha_1 z^{-1} - \\alpha_2 z^{-2}}{\\beta_0 + \\beta_1 z^{-1}}$\n\nC. $H_{new}(z) = (\\beta_0 + \\beta_1 z^{-1})(1 - \\alpha_1 z^{-1} - \\alpha_2 z^{-2})$\n\nD. $H_{new}(z) = \\frac{1 + \\beta_0 + \\beta_1 z^{-1}}{1 - \\alpha_1 z^{-1} - \\alpha_2 z^{-2}}$\n\nE. $H_{new}(z) = \\beta_0 + \\beta_1 z^{-1} + \\frac{1}{1 - \\alpha_1 z^{-1} - \\alpha_2 z^{-2}}$", "solution": "We assume zero initial conditions for Z-transform derivations. The original system is the cascade of a feedforward FIR section followed by a feedback IIR section.\n\nFirst, obtain the transfer function of each section:\n- Feedforward section: given by $w[n] = \\beta_{0} x[n] + \\beta_{1} x[n-1]$. Taking Z-transforms,\n$$W(z) = \\left(\\beta_{0} + \\beta_{1} z^{-1}\\right) X(z),$$\nso the transfer function from $x$ to $w$ is\n$$H_{\\text{ff}}(z) = \\frac{W(z)}{X(z)} = \\beta_{0} + \\beta_{1} z^{-1}.$$\n- Feedback section: given by $y[n] - \\alpha_{1} y[n-1] - \\alpha_{2} y[n-2] = w[n]$. Taking Z-transforms,\n$$Y(z) - \\alpha_{1} z^{-1} Y(z) - \\alpha_{2} z^{-2} Y(z) = W(z),$$\nwhich yields the transfer function from $w$ to $y$:\n$$H_{\\text{fb}}(z) = \\frac{Y(z)}{W(z)} = \\frac{1}{1 - \\alpha_{1} z^{-1} - \\alpha_{2} z^{-2}}.$$\n\nIn the new configuration, the order is swapped. Let $v[n]$ be the output of the feedback block when its input is $x[n]$. Then\n$$\\frac{V(z)}{X(z)} = H_{\\text{fb}}(z) = \\frac{1}{1 - \\alpha_{1} z^{-1} - \\alpha_{2} z^{-2}}.$$\nNext, $v[n]$ is passed through the feedforward block to produce $y_{\\text{new}}[n]$, so\n$$\\frac{Y_{\\text{new}}(z)}{V(z)} = H_{\\text{ff}}(z) = \\beta_{0} + \\beta_{1} z^{-1}.$$\nTherefore, the overall transfer function of the new system is the product\n$$H_{\\text{new}}(z) = \\frac{Y_{\\text{new}}(z)}{X(z)} = \\left(\\beta_{0} + \\beta_{1} z^{-1}\\right) \\cdot \\frac{1}{1 - \\alpha_{1} z^{-1} - \\alpha_{2} z^{-2}}.$$\n\nThis matches option A.", "answer": "$$\\boxed{A}$$", "id": "1714590"}, {"introduction": "In practical engineering, we often work in reverse: instead of building a filter from known coefficients, we must determine the coefficients of an unknown \"black box\" system. This practice puts you in the role of a system analyst, using measured output data—the impulse response—to deduce a filter's internal feedback coefficients. This exercise demonstrates a fundamental technique in system identification and reinforces the direct link between a filter's time-domain behavior and its defining difference equation. [@problem_id:1714591]", "problem": "An engineer is tasked with characterizing an unknown causal, second-order Linear Time-Invariant (LTI) digital filter. This type of filter is often implemented using a Direct Form structure, and its input-output relationship can be described by a general rational transfer function $H(z)$:\n$$H(z) = \\frac{Y(z)}{X(z)} = \\frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\nThis is the general form for a second-order Infinite Impulse Response (IIR) filter.\n\nThrough preliminary analysis, the engineer determines that the filter has a simple feedforward path, described by the coefficients $b_0 = 2$, $b_1 = 0$, and $b_2 = 0$. To determine the feedback coefficients, a unit impulse input, defined as $x[n] = \\delta[n]$, is applied to the filter. The first three samples of the resulting output impulse response, $h[n]$, are measured to be:\n$h[0] = 2$\n$h[1] = 1.6$\n$h[2] = 0.48$\n\nBased on this information, determine the numerical values of the feedback coefficients $a_1$ and $a_2$. The answer should be provided as an ordered pair $(a_1, a_2)$.", "solution": "For a causal second-order LTI IIR filter with transfer function\n$$H(z)=\\frac{Y(z)}{X(z)}=\\frac{b_{0}+b_{1}z^{-1}+b_{2}z^{-2}}{1+a_{1}z^{-1}+a_{2}z^{-2}},$$\nthe corresponding time-domain difference equation is obtained by multiplying both sides by the denominator and taking the inverse $z$-transform:\n$$y[n]+a_{1}y[n-1]+a_{2}y[n-2]=b_{0}x[n]+b_{1}x[n-1]+b_{2}x[n-2].$$\nGiven $b_{0}=2$, $b_{1}=0$, and $b_{2}=0$, this simplifies to\n$$y[n]+a_{1}y[n-1]+a_{2}y[n-2]=2x[n].$$\nWith an impulse input $x[n]=\\delta[n]$ and zero initial conditions (causality and initial rest), the output is the impulse response $h[n]=y[n]$, which satisfies\n$$h[n]+a_{1}h[n-1]+a_{2}h[n-2]=2\\delta[n].$$\nEvaluate this recurrence for $n=0,1,2$ using $h[-1]=0$ and $h[-2]=0$:\n- For $n=0$:\n$$h[0]+a_{1}h[-1]+a_{2}h[-2]=2 \\implies h[0]=2,$$\nconsistent with the measurement.\n- For $n=1$:\n$$h[1]+a_{1}h[0]+a_{2}h[-1]=0 \\implies h[1]+a_{1}h[0]=0 \\implies a_{1}=-\\frac{h[1]}{h[0]}.$$\nUsing $h[1]=1.6=\\frac{8}{5}$ and $h[0]=2$,\n$$a_{1}=-\\frac{1.6}{2} = -0.8 = -\\frac{4}{5}.$$\n- For $n=2$:\n$$h[2]+a_{1}h[1]+a_{2}h[0]=0 \\implies a_{2}=-\\frac{h[2]+a_{1}h[1]}{h[0]}.$$\nUsing $h[2]=0.48$, $h[1]=1.6$, and $a_{1}=-0.8$,\n$$h[2]+a_{1}h[1]=0.48 + (-0.8)(1.6)=0.48 - 1.28 = -0.8,$$\nhence\n$$a_{2}=-\\frac{-0.8}{2}=0.4=\\frac{2}{5}.$$\nTherefore, the feedback coefficients are $a_{1}=-0.8$ and $a_{2}=0.4$.", "answer": "$$\\boxed{(a_1, a_2) = \\left(-\\frac{4}{5}, \\frac{2}{5}\\right)}$$", "id": "1714591"}]}