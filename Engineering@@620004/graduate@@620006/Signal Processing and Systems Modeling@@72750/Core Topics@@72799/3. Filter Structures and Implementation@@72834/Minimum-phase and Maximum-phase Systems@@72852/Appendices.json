{"hands_on_practices": [{"introduction": "One of the most critical properties distinguishing minimum-phase systems is their stable and causal invertibility. This practice explores the crucial consequence of violating the minimum-phase condition. By analyzing a simple nonminimum-phase system from first principles, you will confront the fundamental trade-off that arises when attempting to compute its inverse: a choice between a stable, non-causal system or a causal, unstable one [@problem_id:2883515]. This exercise makes the abstract definitions concrete by connecting pole-zero locations in the $z$-plane to these foundational system properties.", "problem": "Consider the discrete-time linear time-invariant system with transfer function\n$$\nH(z) \\triangleq \\frac{1 - \\frac{3}{2} z^{-1}}{1 - \\frac{1}{2} z^{-1}}.\n$$\nUsing only the foundational definitions of causality, region of convergence, and Bounded-Input Bounded-Output (BIBO) stability in the complex $z$-domain, proceed as follows.\n\n1. Verify from first principles that $H(z)$ is causal and BIBO stable, and that it is nonminimum-phase. Your verification should start from the definitions that for a rational transfer function the region of convergence of a causal system is the exterior of its outermost pole, and that BIBO stability requires that the unit circle $|z|=1$ lies in the region of convergence. Also use the definition that a stable causal system is minimum-phase if and only if all its zeros lie strictly inside the unit circle.\n\n2. Form the inverse transfer function $H^{-1}(z)$ explicitly. Using only the definitions of region of convergence for causal and anticausal systems and the requirement for BIBO stability, demonstrate rigorously that any causal realization of $H^{-1}(z)$ is not BIBO stable, while any BIBO-stable realization of $H^{-1}(z)$ is not causal.\n\n3. Compute the impulse response $h_{s}[n]$ of the BIBO-stable realization of $H^{-1}(z)$ explicitly as a single closed-form expression in terms of the Kronecker delta $\\delta[n]$ and the unit step $u[n]$. Provide this expression as your final answer. No numerical approximation or rounding is required; give an exact analytic expression.", "solution": "We begin from fundamental definitions for rational discrete-time linear time-invariant systems in the complex $z$-domain.\n\nA rational transfer function $H(z)$ is causal if its region of convergence is of the form $|z| > r_{p}$, where $r_{p}$ is the magnitude of the pole with largest magnitude. It is anticausal if its region of convergence is of the form $|z| < r_{p, \\min}$, where $r_{p, \\min}$ is the magnitude of the pole with smallest magnitude. A system is Bounded-Input Bounded-Output (BIBO) stable if and only if its region of convergence includes the unit circle $|z|=1$. A stable causal system is minimum-phase if and only if all of its zeros lie strictly inside the unit circle.\n\nStep 1: Analyze $H(z)$ for causality, stability, and minimum-phase property.\n\nGiven\n$$\nH(z) = \\frac{1 - \\frac{3}{2} z^{-1}}{1 - \\frac{1}{2} z^{-1}}.\n$$\nThe pole is at the root of $1 - \\frac{1}{2} z^{-1} = 0$, that is $z = \\frac{1}{2}$. The zero is at the root of $1 - \\frac{3}{2} z^{-1} = 0$, that is $z = \\frac{3}{2}$.\n\n- Causality: A rational transfer function with a single pole at $z = \\frac{1}{2}$ has the natural causal region of convergence $|z| > \\frac{1}{2}$. This is consistent with the right-sided impulse response of a first-order causal system. Therefore $H(z)$ is causal.\n\n- BIBO stability: The causal region of convergence $|z| > \\frac{1}{2}$ contains the unit circle $|z| = 1$, because $1 > \\frac{1}{2}$. Therefore the system is BIBO stable.\n\n- Minimum-phase: A stable causal system is minimum-phase when all zeros lie strictly inside the unit circle. Here the zero is at $z = \\frac{3}{2}$, which lies outside the unit circle. Therefore $H(z)$ is nonminimum-phase.\n\nStep 2: Form $H^{-1}(z)$ and analyze realizability and stability.\n\nCompute the inverse transfer function:\n$$\nH^{-1}(z) = \\frac{1}{H(z)} = \\frac{1 - \\frac{1}{2} z^{-1}}{1 - \\frac{3}{2} z^{-1}}.\n$$\nThe pole of $H^{-1}(z)$ is at the zero of $H(z)$, namely $z = \\frac{3}{2}$. The zero of $H^{-1}(z)$ is at the pole of $H(z)$, namely $z = \\frac{1}{2}$.\n\n- Causal realization of $H^{-1}(z)$: If we insist on causality, the region of convergence must be the exterior of the outermost pole, i.e., $|z| > \\frac{3}{2}$. However, $|z| = 1$ is not contained in $|z| > \\frac{3}{2}$, because $1$ is not greater than $\\frac{3}{2}$. Therefore the unit circle is excluded, and the causal realization of $H^{-1}(z)$ is not BIBO stable.\n\n- BIBO-stable realization of $H^{-1}(z)$: BIBO stability requires that the unit circle $|z| = 1$ be included in the region of convergence. Since the pole is at $z = \\frac{3}{2}$ (outside the unit circle), any region of convergence that includes $|z| = 1$ but does not cross a pole must satisfy $|z| < \\frac{3}{2}$. This is an interior region of convergence, which is the hallmark of an anticausal realization. Therefore any BIBO-stable realization of $H^{-1}(z)$ is necessarily noncausal (specifically, anticausal).\n\nThis establishes that $H^{-1}(z)$ is either noncausal (if BIBO-stable) or unstable (if causal).\n\nStep 3: Compute the impulse response $h_{s}[n]$ of the BIBO-stable realization of $H^{-1}(z)$.\n\nWe first perform a partial fraction decomposition to separate a term that is independent of the region of convergence from a first-order term:\n$$\nH^{-1}(z) = \\frac{1 - \\frac{1}{2} z^{-1}}{1 - \\frac{3}{2} z^{-1}} = A + \\frac{B}{1 - \\frac{3}{2} z^{-1}}.\n$$\nSolve for $A$ and $B$ by matching coefficients:\n$$\n1 - \\frac{1}{2} z^{-1} = A \\left(1 - \\frac{3}{2} z^{-1}\\right) + B.\n$$\nEquating constant and $z^{-1}$ coefficients,\n$$\n1 = A + B, \\quad -\\frac{1}{2} = -\\frac{3}{2} A.\n$$\nThus\n$$\nA = \\frac{1}{3}, \\quad B = \\frac{2}{3},\n$$\nand hence\n$$\nH^{-1}(z) = \\frac{1}{3} + \\frac{\\frac{2}{3}}{1 - \\frac{3}{2} z^{-1}}.\n$$\n\nFor the BIBO-stable realization, the region of convergence is $|z| < \\frac{3}{2}$. We now recall and derive the anticausal $z$-transform pair from the geometric series. For $|z| < |a|$,\n$$\n\\frac{1}{1 - a z^{-1}} = \\frac{z}{z - a} = - \\sum_{n=-\\infty}^{-1} a^{n} z^{-n},\n$$\nsince\n$$\n- \\sum_{n=-\\infty}^{-1} a^{n} z^{-n} = - \\sum_{m=1}^{\\infty} a^{-m} z^{m} = - \\sum_{m=1}^{\\infty} \\left(\\frac{z}{a}\\right)^{m} = - \\frac{\\frac{z}{a}}{1 - \\frac{z}{a}} = \\frac{z}{z - a}.\n$$\nTherefore, with $a = \\frac{3}{2}$ and region of convergence $|z| < \\frac{3}{2}$,\n$$\n\\frac{1}{1 - \\frac{3}{2} z^{-1}} \\;\\;\\xleftrightarrow{\\mathcal{Z}^{-1}}\\;\\; - \\left(\\frac{3}{2}\\right)^{n} u[-n-1],\n$$\nand\n$$\n\\frac{1}{3} \\;\\;\\xleftrightarrow{\\mathcal{Z}^{-1}}\\;\\; \\frac{1}{3} \\,\\delta[n].\n$$\n\nCombining these terms linearly,\n$$\nh_{s}[n] = \\frac{1}{3} \\,\\delta[n] + \\frac{2}{3} \\left[ - \\left(\\frac{3}{2}\\right)^{n} u[-n-1] \\right] = \\frac{1}{3} \\,\\delta[n] - \\frac{2}{3} \\left(\\frac{3}{2}\\right)^{n} u[-n-1].\n$$\nThis impulse response is anticausal (nonzero for $n \\leq -1$ and possibly at $n=0$), and its region of convergence $|z| < \\frac{3}{2}$ includes the unit circle, ensuring BIBO stability. Hence it is the BIBO-stable realization of $H^{-1}(z)$.\n\nThis completes the construction of a stable causal nonminimum-phase $H(z)$ and the explicit demonstration that $H^{-1}(z)$ is either noncausal (if BIBO-stable) or unstable (if causal), together with the requested exact expression for the impulse response of the BIBO-stable inverse.", "answer": "$$\\boxed{\\frac{1}{3}\\,\\delta[n]\\;-\\;\\frac{2}{3}\\left(\\frac{3}{2}\\right)^{n}u[-n-1]}$$", "id": "2883515"}, {"introduction": "Building on the understanding of how zero locations impact invertibility [@problem_id:2883515], we now explore a constructive method that directly links maximum-phase and minimum-phase systems. This exercise demonstrates the elegant duality between performing a time-reversal on an impulse response and inverting its corresponding zeros with respect to the unit circle. You will construct a maximum-phase filter and transform it into its minimum-phase counterpart, solidifying the geometric relationship between these two system classes in the $z$-plane [@problem_id:2883573].", "problem": "Let a finite impulse response (FIR) filter be characterized by a length-$4$ real-coefficient impulse response $\\{h[n]\\}_{n=0}^{3}$ with bilateral $Z$-transform $H(z) = \\sum_{n=0}^{3} h[n] z^{-n}$. Angles are to be interpreted in radians. Use only foundational definitions and properties of the $Z$-transform, causality, and the definitions of minimum-phase and maximum-phase systems stated as follows: a discrete-time linear time-invariant system is minimum-phase if and only if all its zeros are strictly inside the unit circle, and maximum-phase if and only if all its zeros are strictly outside the unit circle.\n\nConstruct an explicit real-coefficient $H(z)$ by specifying a set of zeros such that every zero is strictly outside the unit circle and the normalization $h[0]=1$ holds. Concretely, take the zeros to be at $z = 2 \\exp(j\\pi/3)$, $z = 2 \\exp(-j\\pi/3)$, and $z = 3$, and construct $H(z)$ accordingly. Starting from the definition of the bilateral $Z$-transform $H(z) = \\sum_{n=0}^{3} h[n] z^{-n}$ and the time-reversed impulse response $h_{\\mathrm{rev}}[n] \\triangleq h[3-n]$, derive the $Z$-transform $H_{\\mathrm{rev}}(z)$ of $h_{\\mathrm{rev}}[n]$ from first principles. Using this derivation, rigorously establish how the zeros of $H_{\\mathrm{rev}}(z)$ relate to those of $H(z)$ and use this relationship and the given zero locations to conclude whether $h_{\\mathrm{rev}}[n]$ is minimum-phase. Then, define the delay-aligned version $\\tilde{h}[n]$ to be the time-reversed impulse response normalized to satisfy $\\tilde{h}[0]=1$, and let $\\tilde{H}(z)$ be its $Z$-transform. Finally, provide the closed-form analytic expression for $\\tilde{H}(z)$.\n\nYour final answer must be this single expression for $\\tilde{H}(z)$ in terms of $z$ and $z^{-1}$. No numerical rounding is required.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded, well-posed, objective, and internally consistent, providing all necessary definitions and data for a unique solution. We will proceed with a rigorous derivation.\n\nFirst, we construct the transfer function $H(z)$ for the specified length-$4$ FIR filter. The filter has an impulse response $\\{h[n]\\}_{n=0}^{3}$ and its $Z$-transform is $H(z) = \\sum_{n=0}^{3} h[n] z^{-n}$. This is a polynomial of degree $3$ in the variable $z^{-1}$. A degree-$3$ polynomial is characterized by its $3$ zeros and a scaling constant.\n\nThe problem states the zeros are located at $z_1 = 2 \\exp(j\\pi/3)$, $z_2 = 2 \\exp(-j\\pi/3)$, and $z_3 = 3$. The general form of $H(z)$ is thus:\n$$H(z) = C \\left(1 - z_1 z^{-1}\\right) \\left(1 - z_2 z^{-1}\\right) \\left(1 - z_3 z^{-1}\\right)$$\nThe constant $C$ is determined by the normalization condition $h[0]=1$. By expanding the expression for $H(z)$, we see that the term independent of $z^{-1}$ is $C$. That is, $h[0] = C$. Therefore, we must have $C=1$.\n\nWith $C=1$, the transfer function is:\n$$H(z) = \\left(1 - 2 \\exp(j\\pi/3) z^{-1}\\right) \\left(1 - 2 \\exp(-j\\pi/3) z^{-1}\\right) \\left(1 - 3 z^{-1}\\right)$$\nTo verify the coefficients are real, we combine the complex-conjugate pair of factors:\n$$ \\left(1 - 2 \\exp(j\\pi/3) z^{-1}\\right) \\left(1 - 2 \\exp(-j\\pi/3) z^{-1}\\right) = 1 - 2\\left(\\exp(j\\pi/3) + \\exp(-j\\pi/3)\\right)z^{-1} + 4\\exp(0)z^{-2} $$\nUsing Euler's identity, $\\exp(j\\theta) + \\exp(-j\\theta) = 2 \\cos(\\theta)$, we have:\n$$ 1 - 2\\left(2\\cos(\\pi/3)\\right)z^{-1} + 4z^{-2} = 1 - 2\\left(2 \\cdot \\frac{1}{2}\\right)z^{-1} + 4z^{-2} = 1 - 2z^{-1} + 4z^{-2} $$\nMultiplying by the remaining factor $(1 - 3z^{-1})$ gives:\n$$ H(z) = (1 - 2z^{-1} + 4z^{-2})(1 - 3z^{-1}) = 1 - 3z^{-1} - 2z^{-1} + 6z^{-2} + 4z^{-2} - 12z^{-3} $$\n$$ H(z) = 1 - 5z^{-1} + 10z^{-2} - 12z^{-3} $$\nFrom this, the impulse response is $\\{h[n]\\} = \\{1, -5, 10, -12\\}$. The coefficients are real, as required. The magnitudes of the zeros are $|z_1|=2 > 1$, $|z_2|=2 > 1$, and $|z_3|=3 > 1$. Since all zeros are strictly outside the unit circle, the system $H(z)$ is, by definition, maximum-phase.\n\nNext, we derive the $Z$-transform $H_{\\mathrm{rev}}(z)$ of the time-reversed impulse response $h_{\\mathrm{rev}}[n] \\triangleq h[3-n]$. By the definition of the bilateral $Z$-transform:\n$$ H_{\\mathrm{rev}}(z) = \\sum_{n=-\\infty}^{\\infty} h_{\\mathrm{rev}}[n] z^{-n} = \\sum_{n=-\\infty}^{\\infty} h[3-n] z^{-n} $$\nThe sequence $h[n]$ is non-zero only for $n \\in \\{0, 1, 2, 3\\}$. Thus, $h_{\\mathrm{rev}}[n]$ is also non-zero only for $n \\in \\{0, 1, 2, 3\\}$. We introduce a change of variables in the summation, $m = 3-n$, which implies $n = 3-m$. As $n$ goes from $0$ to $3$, $m$ goes from $3$ to $0$.\n$$ H_{\\mathrm{rev}}(z) = \\sum_{m=0}^{3} h[m] z^{-(3-m)} = \\sum_{m=0}^{3} h[m] z^{-3} z^m = z^{-3} \\sum_{m=0}^{3} h[m] (z^{-1})^{-m} $$\nThe sum is the definition of $H(z^{-1})$, so we establish the relationship:\n$$ H_{\\mathrm{rev}}(z) = z^{-3} H(z^{-1}) $$\nTo find the zeros of $H_{\\mathrm{rev}}(z)$, let $p$ be a zero. Then $H_{\\mathrm{rev}}(p)=0$. For any $p \\neq 0$, this implies $p^{-3} H(p^{-1}) = 0$, which requires $H(p^{-1}) = 0$. This means that $p^{-1}$ must be a zero of $H(z)$. Therefore, if the zeros of $H(z)$ are $\\{z_k\\}$, the zeros of $H_{\\mathrm{rev}}(z)$ are $\\{p_k\\} = \\{1/z_k\\}$.\n\nThe zeros of $H(z)$ are $2 \\exp(j\\pi/3)$, $2 \\exp(-j\\pi/3)$, and $3$. The zeros of $H_{\\mathrm{rev}}(z)$ are therefore:\n$$ p_1 = \\frac{1}{2 \\exp(j\\pi/3)} = \\frac{1}{2} \\exp(-j\\pi/3) $$\n$$ p_2 = \\frac{1}{2 \\exp(-j\\pi/3)} = \\frac{1}{2} \\exp(j\\pi/3) $$\n$$ p_3 = \\frac{1}{3} $$\nThe magnitudes of these zeros are $|p_1|=1/2$, $|p_2|=1/2$, and $|p_3|=1/3$. All three magnitudes are strictly less than $1$. According to the problem's definition, a system is minimum-phase if and only if all its zeros are strictly inside the unit circle. Thus, the system with impulse response $h_{\\mathrm{rev}}[n]$ is minimum-phase.\n\nFinally, we construct the transfer function $\\tilde{H}(z)$ for the delay-aligned sequence $\\tilde{h}[n]$. This sequence is defined as the time-reversed impulse response normalized to satisfy $\\tilde{h}[0]=1$. The time-reversed sequence is $h_{\\mathrm{rev}}[n] = h[3-n]$. Its coefficients are:\n$h_{\\mathrm{rev}}[0] = h[3] = -12$\n$h_{\\mathrm{rev}}[1] = h[2] = 10$\n$h_{\\mathrm{rev}}[2] = h[1] = -5$\n$h_{\\mathrm{rev}}[3] = h[0] = 1$\nSo, the Z-transform is $H_{\\mathrm{rev}}(z) = -12 + 10z^{-1} - 5z^{-2} + z^{-3}$.\nThe sequence $\\tilde{h}[n]$ is a scaled version of $h_{\\mathrm{rev}}[n]$, i.e., $\\tilde{h}[n] = A \\cdot h_{\\mathrm{rev}}[n]$. The normalization constant $A$ is found from the condition $\\tilde{h}[0]=1$:\n$$ \\tilde{h}[0] = A \\cdot h_{\\mathrm{rev}}[0] = A \\cdot (-12) = 1 \\implies A = -\\frac{1}{12} $$\nThe Z-transform $\\tilde{H}(z)$ is therefore linearly related to $H_{\\mathrm{rev}}(z)$:\n$$ \\tilde{H}(z) = \\mathcal{Z}\\{\\tilde{h}[n]\\} = -\\frac{1}{12} H_{\\mathrm{rev}}(z) $$\nSubstituting the expression for $H_{\\mathrm{rev}}(z)$:\n$$ \\tilde{H}(z) = -\\frac{1}{12} \\left(-12 + 10z^{-1} - 5z^{-2} + z^{-3}\\right) $$\nDistributing the constant gives the final analytic expression:\n$$ \\tilde{H}(z) = 1 - \\frac{10}{12}z^{-1} + \\frac{5}{12}z^{-2} - \\frac{1}{12}z^{-3} = 1 - \\frac{5}{6}z^{-1} + \\frac{5}{12}z^{-2} - \\frac{1}{12}z^{-3} $$\nThis function $\\tilde{H}(z)$ corresponds to a minimum-phase system with real coefficients, normalized such that its first impulse response coefficient is $1$.", "answer": "$$\n\\boxed{1 - \\frac{5}{6}z^{-1} + \\frac{5}{12}z^{-2} - \\frac{1}{12}z^{-3}}\n$$", "id": "2883573"}, {"introduction": "The previous exercises established the theoretical foundations and consequences of zero locations. In practice, however, explicitly finding the zeros of high-order systems is often computationally expensive or unstable. This final hands-on practice introduces a powerful and practical numerical alternative based on cepstral analysis for decomposing any stable system $H(z)$ into its minimum-phase $M(z)$ and all-pass $A(z)$ components, a process known as spectral factorization [@problem_id:2883549]. By implementing this algorithm, you will translate the abstract concept of minimum-phase factorization into a tangible computational tool essential for modern signal processing.", "problem": "You are given a complex, stable, linear time-invariant discrete-time system with transfer function $H(z)$, represented by numerator coefficients $\\{b_{n}\\}_{n=0}^{N_{b}-1}$ and denominator coefficients $\\{a_{m}\\}_{m=0}^{N_{a}-1}$ in the standard rational form\n$$\nH(z) \\;=\\; \\frac{\\sum_{n=0}^{N_{b}-1} b_{n} \\, z^{-n}}{\\sum_{m=0}^{N_{a}-1} a_{m} \\, z^{-m}}, \\quad a_{0} \\neq 0.\n$$\nThe goal is to compute a minimum-phase factor $M(z)$ and an all-pass factor $A(z)$ such that $H(z) = M(z) \\, A(z)$, without explicitly finding any zeros of $H(z)$. You must base your construction on spectral factorization of the nonnegative trigonometric polynomial $|H(e^{j \\omega})|^{2}$ on the unit circle. Angles must be treated in radians.\n\nStart from the following fundamental base:\n- Definition of the Discrete-Time Fourier Transform (DTFT) on the unit circle: $H(e^{j \\omega}) = H(z)\\big|_{z=e^{j \\omega}}$.\n- The power spectrum $|H(e^{j \\omega})|^{2}$ is a nonnegative $2\\pi$-periodic function of $\\omega$ for any stable $H(z)$ with absolutely summable impulse response.\n- The minimum-phase factor $M(z)$ is the unique (up to a positive constant and a pure delay) causal, stable, outer spectral factor with all zeros strictly inside the unit circle that satisfies $|M(e^{j \\omega})|^{2} = |H(e^{j \\omega})|^{2}$. The residual factor $A(z) = H(z)/M(z)$ must be all-pass, that is $|A(e^{j \\omega})| = 1$ for all $\\omega$.\n- On the unit circle, Kolmogorov’s spectral factorization guarantees that if $\\log |H(e^{j \\omega})|$ is integrable then there exists a unique (up to a constant and delay) outer $M(z)$ with $\\log |M(e^{j \\omega})| = \\frac{1}{2} \\log |H(e^{j \\omega})|^{2}$, while the phase of $M(e^{j \\omega})$ is the harmonic conjugate (Hilbert transform on the unit circle) of its log-magnitude.\n\nYour constructive algorithm must be discrete and numerically implementable using the following rationale:\n- Sample $H(e^{j \\omega})$ uniformly on a grid of $K$ frequencies $\\omega_{k} = 2\\pi k/K$, $k \\in \\{0,1,\\dots,K-1\\}$.\n- Form $R(\\omega_{k}) = |H(e^{j \\omega_{k}})|^{2}$, clip numerically to stay away from zero, and compute $L(\\omega_{k}) = \\tfrac{1}{2} \\log R(\\omega_{k})$.\n- Compute the real cepstrum $c[n]$ via the length-$K$ inverse Discrete Fourier Transform (DFT) of $L(\\omega_{k})$. Enforce minimum-phase by constructing $c_{\\text{min}}[n]$ that retains nonnegative-time cepstral coefficients with the appropriate doubling rule for strictly positive indices and preserves the direct current and, when applicable, the Nyquist terms.\n- Exponentiate the DFT of $c_{\\text{min}}[n]$ to obtain $M(e^{j \\omega_{k}})$ on the grid. Then set $A(e^{j \\omega_{k}}) = H(e^{j \\omega_{k}})/M(e^{j \\omega_{k}})$.\n- The method avoids explicit zero-finding and produces $M(e^{j \\omega})$ and $A(e^{j \\omega})$ consistent with the spectral factorization of $|H(e^{j \\omega})|^{2}$.\n\nYour program must implement the above construction and validate it on the following test suite. For each test, define $H(z)$ by $(\\mathbf{b}, \\mathbf{a})$ and produce the requested error metrics. Use a uniform grid of $K = 4096$ points on $[0,2\\pi)$ in radians.\n\nTest suite:\n- Test $1$ (happy path, known all-pass): Let $M_{0}(z)$ be an already minimum-phase finite impulse response with coefficients $\\mathbf{m}_{0} = [0.5,\\,0.3,\\,0.2]$. Let the first-order all-pass be $A_{1}(z) = \\dfrac{a + z^{-1}}{1 + a z^{-1}}$ with $a = 0.8$. Define $H(z) = M_{0}(z)\\,A_{1}(z)$. Therefore, $\\mathbf{b} = \\text{conv}(\\mathbf{m}_{0}, [a,\\,1])$ and $\\mathbf{a} = [1,\\,a]$.\n- Test $2$ (boundary case: pure delay as all-pass): Let $M_{1}(z)$ be minimum-phase with $\\mathbf{m}_{1} = [0.6,\\,0.2,\\,0.1,\\,0.05]$ and a pure delay of $d = 4$. Define $H(z) = z^{-d} M_{1}(z)$, that is $\\mathbf{b} = [0,\\,0,\\,0,\\,0,\\,0.6,\\,0.2,\\,0.1,\\,0.05]$ and $\\mathbf{a} = [1]$. The ground-truth all-pass is $A_{2}(e^{j \\omega}) = e^{-j \\omega d}$.\n- Test $3$ (nonminimum-phase finite impulse response): Define a nonminimum-phase finite impulse response by $\\mathbf{b} = \\text{conv}([1,\\,-1.2],\\,[0.7,\\,0.4,\\,0.2])$ and $\\mathbf{a} = [1]$. This has at least one zero strictly outside the unit circle; the algorithm must still produce a valid $M(e^{j \\omega})$ and an all-pass $A(e^{j \\omega})$.\n\nFor each test, compute:\n- $E_{1} = \\max_{\\omega_{k}} \\left|\\,|A(e^{j \\omega_{k}})|^{2} - 1\\,\\right|$,\n- $E_{2} = \\dfrac{\\left\\|\\,|M(e^{j \\omega_{k}})| - |H(e^{j \\omega_{k}})|\\,\\right\\|_{2}}{\\left\\|\\,|H(e^{j \\omega_{k}})|\\,\\right\\|_{2}}$,\n- $E_{3}$ defined as follows:\n  - For Test $1$, let $A_{\\text{true}}(e^{j \\omega}) = \\dfrac{a + e^{-j \\omega}}{1 + a e^{-j \\omega}}$ and set $E_{3} = \\max_{\\omega_{k}} \\left|\\,A(e^{j \\omega_{k}}) - A_{\\text{true}}(e^{j \\omega_{k}})\\,\\right|$.\n  - For Test $2$, let $A_{\\text{true}}(e^{j \\omega}) = e^{-j \\omega d}$ and set $E_{3} = \\max_{\\omega_{k}} \\left|\\,A(e^{j \\omega_{k}}) - A_{\\text{true}}(e^{j \\omega_{k}})\\,\\right|$.\n  - For Test $3$, set $E_{3} = -1.0$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test contributes a sublist $[E_{1},E_{2},E_{3}]$. For example, the format must be exactly\n$$\n\\big[\\,[E_{1}^{(1)},E_{2}^{(1)},E_{3}^{(1)}],[E_{1}^{(2)},E_{2}^{(2)},E_{3}^{(2)}],[E_{1}^{(3)},E_{2}^{(3)},E_{3}^{(3)}]\\,\\big].\n$$\nNo other text should be printed.", "solution": "The problem statement is subjected to rigorous validation.\n\n### Step 1: Extract Givens\n- **System Model**: A complex, stable, linear time-invariant (LTI) discrete-time system with a rational transfer function $H(z) = \\frac{\\sum_{n=0}^{N_{b}-1} b_{n} z^{-n}}{\\sum_{m=0}^{N_{a}-1} a_{m} z^{-m}}$, where $a_0 \\neq 0$.\n- **Objective**: Decompose $H(z)$ into a minimum-phase factor $M(z)$ and an all-pass factor $A(z)$ such that $H(z) = M(z) A(z)$.\n- **Methodology**: The decomposition must be performed without explicit root-finding, using a numerical algorithm based on spectral factorization via the real cepstrum.\n- **Algorithm Steps**:\n    1. Sample $H(e^{j \\omega})$ on a uniform grid of $K$ points, $\\omega_k = 2\\pi k/K$.\n    2. Compute the power spectrum $R(\\omega_k) = |H(e^{j \\omega_k})|^2$.\n    3. Clip $R(\\omega_k)$ to avoid numerical issues with logarithms and compute the log-magnitude spectrum $L(\\omega_k) = \\frac{1}{2} \\log R(\\omega_k)$.\n    4. Compute the real cepstrum $c[n]$ via the inverse Discrete Fourier Transform (IDFT) of $L(\\omega_k)$.\n    5. Construct the minimum-phase cepstrum $c_{\\text{min}}[n]$ from $c[n]$ using a specific windowing and scaling rule.\n    6. Compute the frequency response of the minimum-phase factor $M(e^{j \\omega_k})$ by taking the exponential of the DFT of $c_{\\text{min}}[n]$.\n    7. Compute the frequency response of the all-pass factor as $A(e^{j \\omega_k}) = H(e^{j \\omega_k}) / M(e^{j \\omega_k})$.\n- **Parameters**: Grid size $K = 4096$.\n- **Test Cases**: Three specific systems defined by numerator ($\\mathbf{b}$) and denominator ($\\mathbf{a}$) coefficients are provided for validation.\n    - Test $1$: Known minimum-phase and all-pass factors, $H(z) = M_0(z)A_1(z)$.\n    - Test $2$: Minimum-phase FIR with a pure delay, $H(z) = z^{-d}M_1(z)$.\n    - Test $3$: Nonminimum-phase FIR filter.\n- **Error Metrics**: For each test, compute $E_1 = \\max_{\\omega_k} \\left|\\,|A(e^{j \\omega_k})|^{2} - 1\\,\\right|$, $E_2 = \\frac{\\left\\|\\,|M(e^{j \\omega_k})| - |H(e^{j \\omega_k}})|\\,\\right\\|_{2}}{\\left\\|\\,|H(e^{j \\omega_k}})|\\,\\right\\|_{2}}$, and a case-specific metric $E_3$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is firmly based on established principles of digital signal processing, specifically the theory of minimum-phase systems, all-pass decomposition, and homomorphic signal processing (cepstral analysis). The described algorithm is a standard, correct method for performing such a decomposition. Kolmogorov's theorem, mentioned as a foundation, is a cornerstone of spectral factorization theory. The problem is scientifically sound.\n- **Well-Posedness**: The problem is well-posed. The algorithm is constructive and deterministic. The input (filter coefficients) and output (error metrics) are clearly defined. The instruction to clip the spectrum addresses potential numerical instabilities, ensuring the procedure is robust.\n- **Objectivity**: The problem is stated in precise, objective mathematical language, free from any subjective or ambiguous terminology.\n- **Completeness and Consistency**: The problem is self-contained. It provides all necessary information, including the theoretical basis, the exact numerical procedure, all parameters for the test cases, and the required output format. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a clear, consistent, and scientifically sound exercise in computational signal processing. A solution will be provided.\n\n### Solution\n\nThe task is to perform a minimum-phase/all-pass decomposition of a given rational transfer function $H(z)$ without explicit root-finding. The prescribed method is based on the properties of the complex cepstrum and is implemented numerically using the Discrete Fourier Transform (DFT).\n\nThe fundamental principle is that any rational transfer function $H(z)$ can be factored into $H(z) = M(z) A(z)$, where $M(z)$ is a minimum-phase system (all its poles and zeros are inside the unit circle) and $A(z)$ is an all-pass system (its poles are reciprocals of its zeros, and its magnitude response is constant). This decomposition is unique up to a scale factor and a pure delay.\n\nOn the unit circle, $z = e^{j\\omega}$, the magnitude responses are related by $|H(e^{j\\omega})| = |M(e^{j\\omega})| |A(e^{j\\omega})|$. Since for an all-pass filter $|A(e^{j\\omega})|$ is constant (which can be normalized to $1$), we have $|M(e^{j\\omega})| = |H(e^{j\\omega})|$. Consequently, their log-magnitudes are also equal:\n$$\n\\log|M(e^{j\\omega})| = \\log|H(e^{j\\omega})|\n$$\nFor a minimum-phase system, its phase is uniquely determined by its log-magnitude via the Hilbert transform. The complex logarithm of its frequency response, $\\log M(e^{j\\omega}) = \\log|M(e^{j\\omega})| + j \\arg\\{M(e^{j\\omega})\\}$, has a real part and an imaginary part that form a Hilbert transform pair. The inverse Fourier transform of $\\log M(e^{j\\omega})$ is the complex cepstrum, denoted $\\hat{m}[n]$, which must be causal (i.e., $\\hat{m}[n] = 0$ for $n < 0$) because $M(z)$ is minimum-phase.\n\nThe specified algorithm leverages these properties in a discrete-frequency domain.\n\n1.  **Frequency Response Evaluation**: The frequency response $H(e^{j\\omega})$ is evaluated on a discrete grid of $K=4096$ equally spaced frequencies $\\omega_k = 2\\pi k/K$ for $k=0, 1, \\dots, K-1$. This is achieved by using the `scipy.signal.freqz` function on the given numerator coefficients $\\mathbf{b}$ and denominator coefficients $\\mathbf{a}$. We obtain the complex values $H_k = H(e^{j\\omega_k})$.\n\n2.  **Log-Magnitude Spectrum**: We compute the log-magnitude spectrum $L_k = \\log|H_k|$. To prevent numerical failure from $\\log(0)$ in case any $|H_k|$ is zero, a small positive constant $\\epsilon$ (machine epsilon) is added to $|H_k|$ before taking the logarithm. So, $L_k = \\log(\\max(|H_k|, \\epsilon))$.\n\n3.  **Real Cepstrum**: The real cepstrum $c[n]$ is the inverse DFT of the log-magnitude spectrum $L_k$.\n    $$\n    c[n] = \\text{IDFT}\\{L_k\\} = \\frac{1}{K} \\sum_{k=0}^{K-1} L_k e^{j 2\\pi nk/K}\n    $$\n    Since $L_k$ is a real and even sequence (as $|H(e^{j\\omega})|$ is an even function of $\\omega$), its IDFT, $c[n]$, is a real and symmetric sequence: $c[n] = c[K-n]$ for $n \\in \\{1, \\dots, K-1\\}$.\n\n4.  **Minimum-Phase Cepstrum**: From the real cepstrum $c[n]$, we construct the cepstrum of the minimum-phase factor, $c_{\\text{min}}[n]$. This sequence must be causal to correspond to a minimum-phase system. The standard construction is:\n    $$\n    c_{\\text{min}}[n] = \\begin{cases}\n    c[0] & \\text{for } n=0 \\\\\n    2c[n] & \\text{for } 1 \\le n < K/2 \\\\\n    c[n] & \\text{for } n = K/2 \\text{ (since } K \\text{ is even)} \\\\\n    0 & \\text{for } K/2 < n < K\n    \\end{cases}\n    $$\n    This operation effectively isolates the causal part of the complex cepstrum from the real cepstrum.\n\n5.  **Factor Reconstruction**: The DFT of $c_{\\text{min}}[n]$ yields the complex logarithm of the minimum-phase factor's frequency response, $\\log M_k = \\text{DFT}\\{c_{\\text{min}}[n]\\}$. The real part of $\\log M_k$ is identical to the original log-magnitude spectrum $L_k$, while its imaginary part is the discrete Hilbert transform of $L_k$.\n    The minimum-phase frequency response $M_k$ is then recovered by exponentiation:\n    $$\n    M_k = \\exp(\\log M_k)\n    $$\n    Finally, the all-pass factor's frequency response $A_k$ is computed by division:\n    $$\n    A_k = H_k / M_k\n    $$\n\n6.  **Error Calculation**: The computed factors $M_k$ and $A_k$ are evaluated against their theoretical properties using the specified error metrics $E_1$, $E_2$, and $E_3$. $E_1$ verifies that $|A_k|^2 \\approx 1$. $E_2$ verifies that $|M_k| \\approx |H_k|$. $E_3$ quantifies the accuracy of the computed all-pass factor against a known ground truth for a subset of the tests.\n\nThis procedure is implemented for each of the three test cases specified in the problem statement.", "answer": "```python\nimport numpy as np\nfrom scipy import signal\n\ndef solve():\n    \"\"\"\n    Implements the minimum-phase/all-pass decomposition using cepstral analysis\n    and validates it on the given test suite.\n    \"\"\"\n    K = 4096  # Number of points on the frequency grid\n\n    # Define test cases\n    m0 = np.array([0.5, 0.3, 0.2])\n    a_param = 0.8\n    test1_b = np.convolve(m0, [a_param, 1])\n    test1_a = np.array([1, a_param])\n\n    m1 = np.array([0.6, 0.2, 0.1, 0.05])\n    delay = 4\n    test2_b = np.concatenate((np.zeros(delay), m1))\n    test2_a = np.array([1.0])\n\n    test3_b = np.convolve([1, -1.2], [0.7, 0.4, 0.2])\n    test3_a = np.array([1.0])\n\n    test_cases = [\n        {'b': test1_b, 'a': test1_a, 'e3_type': 'test1', 'params': {'a': a_param}},\n        {'b': test2_b, 'a': test2_a, 'e3_type': 'test2', 'params': {'d': delay}},\n        {'b': test3_b, 'a': test3_a, 'e3_type': 'test3', 'params': {}},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        b = case['b']\n        a = case['a']\n        e3_type = case['e3_type']\n        params = case['params']\n\n        # 1. Sample H(e^jω) on a uniform grid\n        # Use whole=True to get K points on the full circle [0, 2*pi)\n        omega, h = signal.freqz(b, a, worN=K, whole=True)\n\n        # 2. Form R(ωk) and L(ωk)\n        abs_h = np.abs(h)\n        # Add machine epsilon to avoid log(0)\n        log_magnitude_h = np.log(np.maximum(abs_h, np.finfo(float).eps))\n\n        # 3. Compute real cepstrum c[n]\n        # IDFT of log magnitude. Result should be real, take real part to handle numerical noise.\n        c = np.fft.ifft(log_magnitude_h).real\n\n        # 4. Construct minimum-phase cepstrum c_min[n]\n        c_min = np.zeros(K)\n        c_min[0] = c[0]\n        # Since K is even\n        c_min[1:K//2] = 2 * c[1:K//2]\n        c_min[K//2] = c[K//2]\n        # The rest of c_min is already zero, satisfying causality.\n\n        # 5. Exponentiate DFT of c_min[n] to get M(e^jω)\n        log_M = np.fft.fft(c_min)\n        M = np.exp(log_M)\n\n        # 6. Compute A(e^jω) = H(e^jω) / M(e^jω)\n        A = h / M\n\n        # 7. Compute error metrics\n        # E1 = max| |A(e^jωk)|² - 1 |\n        E1 = np.max(np.abs(np.abs(A)**2 - 1))\n\n        # E2 = |||M(e^jωk)| - |H(e^jωk)|||₂ / |||H(e^jωk)|||₂\n        norm_h_abs = np.linalg.norm(abs_h)\n        if norm_h_abs  np.finfo(float).eps:\n            E2 = np.linalg.norm(np.abs(M) - abs_h)\n        else:\n            E2 = np.linalg.norm(np.abs(M) - abs_h) / norm_h_abs\n        \n        # E3 calculation depends on the test case\n        if e3_type == 'test1':\n            a_val = params['a']\n            z_inv = np.exp(-1j * omega)\n            A_true = (a_val + z_inv) / (1 + a_val * z_inv)\n            E3 = np.max(np.abs(A - A_true))\n        elif e3_type == 'test2':\n            d_val = params['d']\n            A_true = np.exp(-1j * omega * d_val)\n            E3 = np.max(np.abs(A - A_true))\n        elif e3_type == 'test3':\n            E3 = -1.0\n        else:\n            E3 = -1.0 # Should not happen\n\n        results.append([E1, E2, E3])\n\n    # Format the final output string\n    sub_results_str = [f\"[{','.join(map(str, r))}]\" for r in results]\n    final_output = f\"[{','.join(sub_results_str)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2883549"}]}