{"hands_on_practices": [{"introduction": "This first practice serves as a foundational exercise in deriving frequency response characteristics from first principles. By analyzing a simple yet ubiquitous system—a feedforward comb filter model—you will apply the Continuous-Time Fourier Transform (CTFT) to directly connect a time-domain impulse response, $h(t)=\\delta(t)+\\alpha\\delta(t-\\tau)$, to its magnitude and phase response. This hands-on derivation will build your intuition on how basic time-domain operations like delay and scaling manifest as periodic ripples and phase variations in the frequency domain [@problem_id:2882292].", "problem": "Consider a continuous-time, Linear Time-Invariant (LTI) system with impulse response $h(t)=\\delta(t)+\\alpha\\,\\delta(t-\\tau)$, where $\\delta(t)$ is the Dirac delta function, $\\alpha\\in\\mathbb{R}$, and $\\tau0$. Use only the definition of the Continuous-Time Fourier Transform (CTFT), $H(j\\omega)=\\int_{-\\infty}^{\\infty}h(t)\\,\\exp(-j\\omega t)\\,dt$, and core trigonometric identities (such as the Euler identity) to analyze this system.\n\nTasks:\n1) Derive the frequency response $H(j\\omega)$ from the CTFT definition.\n\n2) From first principles, derive closed-form expressions for the magnitude $|H(j\\omega)|$ and the principal-value phase $\\angle H(j\\omega)$ as functions of $\\omega$. All angles must be in radians.\n\n3) Characterize the magnitude ripple:\n- Determine the period in $\\omega$ of the magnitude response.\n- Determine the global maxima and minima of $|H(j\\omega)|$ over $\\omega\\in\\mathbb{R}$, and the full sets of frequencies where they occur, in terms of $\\alpha$ and $\\tau$.\n- Give a necessary and sufficient condition on $\\alpha$ for which $|H(j\\omega)|$ has exact spectral nulls (zeros), and specify the corresponding frequencies.\n\n4) Characterize the phase behavior:\n- Provide an explicit analytic expression for the principal-value phase $\\angle H(j\\omega)$ using the two-argument arctangent function $\\arctan2(\\cdot,\\cdot)$.\n- Identify the frequencies at which the principal-value phase exhibits jumps (discontinuities), and explain how these depend on $\\alpha$ and $\\tau$.\n\nProvide your reasoning steps clearly and justify each conclusion from the definitions and identities you use. Report as your final answer the single closed-form analytic expression for the magnitude $|H(j\\omega)|$ as a function of $\\omega$, $\\alpha$, and $\\tau$. No numerical evaluation or rounding is required.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n**Step 1: Extract Givens**\n- System type: Continuous-time, Linear Time-Invariant (LTI).\n- Impulse response: $h(t)=\\delta(t)+\\alpha\\,\\delta(t-\\tau)$.\n- Parameters: $\\alpha\\in\\mathbb{R}$ and $\\tau0$.\n- Definition of CTFT: $H(j\\omega)=\\int_{-\\infty}^{\\infty}h(t)\\,\\exp(-j\\omega t)\\,dt$.\n- Required tools: CTFT definition and core trigonometric identities.\n- Tasks:\n    1. Derive the frequency response $H(j\\omega)$.\n    2. Derive expressions for magnitude $|H(j\\omega)|$ and phase $\\angle H(j\\omega)$.\n    3. Characterize the magnitude response: period, global maxima/minima, and conditions for spectral nulls.\n    4. Characterize the phase response: provide the $\\arctan2$ form and identify frequencies of discontinuities.\n- Final Answer Requirement: A single closed-form analytic expression for $|H(j\\omega)|$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard FIR filter structure (a direct path plus a single echo), a fundamental model in signal processing known as a comb filter. The problem is self-contained, with all necessary parameters and definitions provided ($\\alpha$, $\\tau$, CTFT definition). The tasks are specific, logically structured, and solvable using standard mathematical techniques in system analysis. The problem is free of scientific flaws, ambiguities, or contradictions.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be derived.\n\nThe derivation proceeds by addressing each task in sequence.\n\n**1) Derivation of the Frequency Response $H(j\\omega)$**\n\nThe frequency response $H(j\\omega)$ is the Continuous-Time Fourier Transform (CTFT) of the impulse response $h(t)$. Using the provided definition:\n$$H(j\\omega) = \\int_{-\\infty}^{\\infty} h(t) \\exp(-j\\omega t) dt$$\nSubstitute the given impulse response $h(t) = \\delta(t) + \\alpha\\delta(t-\\tau)$:\n$$H(j\\omega) = \\int_{-\\infty}^{\\infty} (\\delta(t) + \\alpha\\delta(t-\\tau)) \\exp(-j\\omega t) dt$$\nBy the linearity of integration, this can be split into two integrals:\n$$H(j\\omega) = \\int_{-\\infty}^{\\infty} \\delta(t) \\exp(-j\\omega t) dt + \\alpha \\int_{-\\infty}^{\\infty} \\delta(t-\\tau) \\exp(-j\\omega t) dt$$\nWe apply the sifting property of the Dirac delta function, which states that $\\int_{-\\infty}^{\\infty} f(t)\\delta(t-t_0)dt = f(t_0)$.\nFor the first integral, the function is $\\exp(-j\\omega t)$ and the delta function is at $t_0=0$. This yields:\n$$\\int_{-\\infty}^{\\infty} \\delta(t) \\exp(-j\\omega t) dt = \\exp(-j\\omega \\cdot 0) = \\exp(0) = 1$$\nFor the second integral, the function is $\\exp(-j\\omega t)$ and the delta function is at $t_0=\\tau$. This yields:\n$$\\alpha \\int_{-\\infty}^{\\infty} \\delta(t-\\tau) \\exp(-j\\omega t) dt = \\alpha \\exp(-j\\omega\\tau)$$\nCombining these two results gives the frequency response:\n$$H(j\\omega) = 1 + \\alpha\\exp(-j\\omega\\tau)$$\n\n**2) Derivation of Magnitude $|H(j\\omega)|$ and Phase $\\angle H(j\\omega)$**\n\nTo find the magnitude and phase, we first express $H(j\\omega)$ in rectangular form $X(\\omega) + jY(\\omega)$. Using Euler's identity, $\\exp(-j\\theta) = \\cos(\\theta) - j\\sin(\\theta)$, we have:\n$$H(j\\omega) = 1 + \\alpha(\\cos(\\omega\\tau) - j\\sin(\\omega\\tau))$$\n$$H(j\\omega) = (1 + \\alpha\\cos(\\omega\\tau)) - j(\\alpha\\sin(\\omega\\tau))$$\nThe real part is $X(\\omega) = 1 + \\alpha\\cos(\\omega\\tau)$ and the imaginary part is $Y(\\omega) = -\\alpha\\sin(\\omega\\tau)$.\n\nThe magnitude $|H(j\\omega)|$ is given by $\\sqrt{X(\\omega)^2 + Y(\\omega)^2}$:\n$$|H(j\\omega)| = \\sqrt{(1 + \\alpha\\cos(\\omega\\tau))^2 + (-\\alpha\\sin(\\omega\\tau))^2}$$\nExpanding the terms inside the square root:\n$$|H(j\\omega)| = \\sqrt{1 + 2\\alpha\\cos(\\omega\\tau) + \\alpha^2\\cos^2(\\omega\\tau) + \\alpha^2\\sin^2(\\omega\\tau)}$$\nUsing the fundamental trigonometric identity $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$:\n$$|H(j\\omega)| = \\sqrt{1 + 2\\alpha\\cos(\\omega\\tau) + \\alpha^2(\\cos^2(\\omega\\tau) + \\sin^2(\\omega\\tau))}$$\n$$|H(j\\omega)| = \\sqrt{1 + 2\\alpha\\cos(\\omega\\tau) + \\alpha^2}$$\nThis is the closed-form expression for the magnitude.\n\nThe principal-value phase $\\angle H(j\\omega)$ is given by the two-argument arctangent function, $\\arctan2(Y(\\omega), X(\\omega))$:\n$$\\angle H(j\\omega) = \\arctan2(-\\alpha\\sin(\\omega\\tau), 1 + \\alpha\\cos(\\omega\\tau))$$\n\n**3) Characterization of Magnitude Ripple**\n\n- **Period of the Magnitude Response:**\nThe magnitude $|H(j\\omega)| = \\sqrt{1 + \\alpha^2 + 2\\alpha\\cos(\\omega\\tau)}$ is a function of $\\cos(\\omega\\tau)$. The function $\\cos(\\theta)$ has a period of $2\\pi$. Thus, the magnitude response is periodic in $\\omega$. The period $T_\\omega$ must satisfy $\\omega\\tau + T_\\omega\\tau = \\omega\\tau + 2\\pi k$ for some integer $k$. The fundamental period (for $k=1$) is given by $T_\\omega\\tau = 2\\pi$, which means:\n$$T_\\omega = \\frac{2\\pi}{\\tau}$$\n\n- **Global Maxima and Minima:**\nThe extrema of $|H(j\\omega)|$ correspond to the extrema of its square, $|H(j\\omega)|^2 = 1 + \\alpha^2 + 2\\alpha\\cos(\\omega\\tau)$, since the square root function is monotonically increasing for non-negative arguments. The extrema are determined by the term $2\\alpha\\cos(\\omega\\tau)$.\nThe maximum value of $|H(j\\omega)|^2$ is $1 + \\alpha^2 + 2|\\alpha|$, which equals $(1+|\\alpha|)^2$. The global maximum of the magnitude is therefore $1+|\\alpha|$. This occurs when $\\alpha\\cos(\\omega\\tau) = |\\alpha|$.\n    - If $\\alpha0$, this is when $\\cos(\\omega\\tau)=1$, so $\\omega\\tau=2n\\pi$ for $n\\in\\mathbb{Z}$. Frequencies: $\\omega = \\frac{2n\\pi}{\\tau}$.\n    - If $\\alpha0$, this is when $\\cos(\\omega\\tau)=-1$, so $\\omega\\tau=(2n+1)\\pi$ for $n\\in\\mathbb{Z}$. Frequencies: $\\omega = \\frac{(2n+1)\\pi}{\\tau}$.\nThe minimum value of $|H(j\\omega)|^2$ is $1 + \\alpha^2 - 2|\\alpha|$, which equals $(1-|\\alpha|)^2$. The global minimum of the magnitude is therefore $|1-|\\alpha||$. This occurs when $\\alpha\\cos(\\omega\\tau) = -|\\alpha|$.\n    - If $\\alpha0$, this is when $\\cos(\\omega\\tau)=-1$, so $\\omega\\tau=(2n+1)\\pi$ for $n\\in\\mathbb{Z}$. Frequencies: $\\omega = \\frac{(2n+1)\\pi}{\\tau}$.\n    - If $\\alpha0$, this is when $\\cos(\\omega\\tau)=1$, so $\\omega\\tau=2n\\pi$ for $n\\in\\mathbb{Z}$. Frequencies: $\\omega = \\frac{2n\\pi}{\\tau}$.\n\n- **Spectral Nulls:**\nExact spectral nulls occur when $|H(j\\omega)| = 0$. This requires the global minimum to be zero: $|1-|\\alpha|| = 0$. This implies $|\\alpha|=1$.\nThe necessary and sufficient condition for spectral nulls is $\\alpha=1$ or $\\alpha=-1$.\n    - If $\\alpha=1$, the nulls occur at frequencies where the minimum is reached: $\\omega = \\frac{(2n+1)\\pi}{\\tau}$ for $n\\in\\mathbb{Z}$.\n    - If $\\alpha=-1$, the nulls occur at frequencies where the minimum is reached: $\\omega = \\frac{2n\\pi}{\\tau}$ for $n\\in\\mathbb{Z}$.\n\n**4) Characterization of Phase Behavior**\n\n- **Analytic Expression for Phase:**\nAs derived in part 2, the explicit analytic expression for the principal-value phase is:\n$$\\angle H(j\\omega) = \\arctan2(-\\alpha\\sin(\\omega\\tau), 1 + \\alpha\\cos(\\omega\\tau))$$\n\n- **Phase Discontinuities (Jumps):**\nDiscontinuities in the principal-value phase occur when the complex number $H(j\\omega)$ crosses the negative real axis. This happens when the imaginary part is zero and the real part is negative.\n1. Imaginary part is zero: $Y(\\omega) = -\\alpha\\sin(\\omega\\tau) = 0$. Assuming $\\alpha \\neq 0$, this implies $\\sin(\\omega\\tau)=0$, which occurs when $\\omega\\tau = k\\pi$ for any integer $k \\in \\mathbb{Z}$. The frequencies are $\\omega_k = \\frac{k\\pi}{\\tau}$.\n2. Real part is negative: $X(\\omega_k) = 1+\\alpha\\cos(\\omega_k\\tau) = 1+\\alpha\\cos(k\\pi)  0$. Since $\\cos(k\\pi) = (-1)^k$, the condition is $1+\\alpha(-1)^k  0$.\n\nWe analyze this condition for even and odd $k$:\n- If $k$ is an even integer ($k=2n$), the condition becomes $1 + \\alpha  0$, which is $\\alpha  -1$. The phase jumps occur at frequencies $\\omega = \\frac{2n\\pi}{\\tau}$ for $n\\in\\mathbb{Z}$.\n- If $k$ is an odd integer ($k=2n+1$), the condition becomes $1 - \\alpha  0$, which is $\\alpha  1$. The phase jumps occur at frequencies $\\omega = \\frac{(2n+1)\\pi}{\\tau}$ for $n\\in\\mathbb{Z}$.\n\nIn the edge cases where $|\\alpha|=1$, the real part becomes zero at these frequencies, which corresponds to the spectral nulls. At these points of zero magnitude, the phase is undefined, which manifests as a discontinuity of size $\\pi$ radians.\nIn summary, phase jumps occur if and only if $|\\alpha| \\ge 1$.\n- For $\\alpha \\ge 1$: Jumps are at $\\omega = \\frac{(2n+1)\\pi}{\\tau}$, for $n\\in\\mathbb{Z}$.\n- For $\\alpha \\le -1$: Jumps are at $\\omega = \\frac{2n\\pi}{\\tau}$, for $n\\in\\mathbb{Z}$.\n- For $|\\alpha|  1$: There are no phase discontinuities.", "answer": "$$\\boxed{\\sqrt{1 + \\alpha^{2} + 2\\alpha \\cos(\\omega \\tau)}}$$", "id": "2882292"}, {"introduction": "Moving beyond calculation, this practice explores the distinct physical roles of a system's magnitude and phase response. You will investigate two systems engineered to have identical magnitude responses but different phase characteristics by incorporating an all-pass filter. This thought experiment demonstrates a profound principle: while the magnitude response determines a system's effect on a signal's power spectral density, the phase response governs its time-domain waveform and transient behavior [@problem_id:2882263]. Understanding this separation is crucial in applications ranging from audio equalization to communication channel modeling.", "problem": "Consider continuous-time, linear time-invariant (LTI) systems with transfer functions in the Laplace domain. Let the first system be defined by $H_{1}(s)=\\dfrac{1}{s+1}$ and the all-pass factor be $A(s)=\\dfrac{s-3}{s+3}$. Construct the second system as $H_{2}(s)=H_{1}(s)A(s)$. The input $x(t)$ is either a zero-mean wide-sense stationary (WSS) random process with power spectral density (PSD) $S_{xx}(\\omega)$ or a deterministic signal as specified in the subtasks below.\n\nTasks:\n- Using the frequency responses $H_{1}(j\\omega)$ and $H_{2}(j\\omega)$, verify directly that $|H_{1}(j\\omega)|=|H_{2}(j\\omega)|$ for all real $\\,\\omega\\,$ by invoking only the definition of an all-pass system.\n- Starting from the definitions of autocorrelation and the Wiener–Khinchin theorem, and using only the LTI input–output relation in time and frequency domains, derive the general input–output PSD relation and conclude that the output PSDs $S_{y_{1}y_{1}}(\\omega)$ and $S_{y_{2}y_{2}}(\\omega)$ are identical for the same input PSD $S_{xx}(\\omega)$.\n- To demonstrate that transient responses can differ despite identical magnitude responses, consider the deterministic input $x(t)=\\delta(t)$, the Dirac delta. Compute the impulse responses $h_{1}(t)$ and $h_{2}(t)$ of the two systems, and then compute the energy in their difference\n$$\nE \\;=\\; \\int_{0}^{\\infty}\\big(h_{2}(t)-h_{1}(t)\\big)^{2}\\,dt.\n$$\nProvide the final answer for $E$ as an exact value. No rounding is required. There are no physical units to report.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of linear time-invariant (LTI) system theory, consistent, and well-posed. We shall proceed with a formal solution.\n\nThe problem provides two LTI systems. The first system has a transfer function $H_{1}(s) = \\dfrac{1}{s+1}$. The second system is constructed by cascading the first system with an all-pass filter $A(s) = \\dfrac{s-3}{s+3}$, resulting in the transfer function $H_{2}(s) = H_{1}(s)A(s)$.\n\nFirst Task: Verification of Magnitude Response Equality\nAn all-pass system is defined by the property that its magnitude response is unity for all frequencies. We must first verify that $A(s)$ is indeed an all-pass filter. We evaluate its frequency response $A(j\\omega)$ by substituting $s = j\\omega$:\n$$\nA(j\\omega) = \\frac{j\\omega - 3}{j\\omega + 3}\n$$\nThe magnitude of a complex function is the magnitude of the numerator divided by the magnitude of the denominator. The magnitude of a complex number $z = x+iy$ is $|z| = \\sqrt{x^2+y^2}$.\n$$\n|A(j\\omega)| = \\frac{|j\\omega - 3|}{|j\\omega + 3|} = \\frac{|-3 + j\\omega|}{|3 + j\\omega|} = \\frac{\\sqrt{(-3)^2 + \\omega^2}}{\\sqrt{3^2 + \\omega^2}} = \\frac{\\sqrt{9 + \\omega^2}}{\\sqrt{9 + \\omega^2}} = 1\n$$\nThis holds for all real $\\omega$. Thus, $A(s)$ is confirmed to be an all-pass filter.\nNow, we compare the magnitude responses of $H_{1}(s)$ and $H_{2}(s)$. The frequency response of the second system is $H_{2}(j\\omega) = H_{1}(j\\omega) A(j\\omega)$. Taking the magnitude of both sides:\n$$\n|H_{2}(j\\omega)| = |H_{1}(j\\omega) A(j\\omega)| = |H_{1}(j\\omega)| |A(j\\omega)|\n$$\nSince $|A(j\\omega)| = 1$, we conclude that:\n$$\n|H_{2}(j\\omega)| = |H_{1}(j\\omega)|\n$$\nThis verifies that the two systems have identical magnitude responses for all frequencies $\\omega$.\n\nSecond Task: Input-Output Power Spectral Density (PSD) Relation\nLet $x(t)$ be a wide-sense stationary (WSS) input to an LTI system with impulse response $h(t)$. The output $y(t)$ is given by the convolution integral:\n$$\ny(t) = (x*h)(t) = \\int_{-\\infty}^{\\infty} h(\\alpha) x(t-\\alpha) d\\alpha\n$$\nThe autocorrelation of the output is $R_{y y}(\\tau) = E[y(t) y^*(t-\\tau)]$, where $E[\\cdot]$ denotes the expectation operator. Substituting the convolution for $y(t)$:\n$$\nR_{y y}(\\tau) = E\\left[ \\left( \\int_{-\\infty}^{\\infty} h(\\alpha) x(t-\\alpha) d\\alpha \\right) \\left( \\int_{-\\infty}^{\\infty} h^*(\\beta) x^*(t-\\tau-\\beta) d\\beta \\right) \\right]\n$$\nBy linearity of expectation, we move it inside the integrals:\n$$\nR_{y y}(\\tau) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} h(\\alpha) h^*(\\beta) E[x(t-\\alpha) x^*(t-\\tau-\\beta)] d\\alpha d\\beta\n$$\nThe expectation term is the autocorrelation of the input, $R_{xx}((t-\\alpha)-(t-\\tau-\\beta)) = R_{xx}(\\tau+\\beta-\\alpha)$, as the process is WSS.\n$$\nR_{y y}(\\tau) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} h(\\alpha) h^*(\\beta) R_{xx}(\\tau+\\beta-\\alpha) d\\alpha d\\beta\n$$\nThis expression can be recognized as a sequence of convolutions: $R_{y y}(\\tau) = R_{xx}(\\tau) * h(\\tau) * h^*(-\\tau)$.\nThe Wiener-Khinchin theorem states that the PSD is the Fourier transform of the autocorrelation function, $S(\\omega) = \\mathcal{F}\\{R(\\tau)\\}$. Applying the Fourier transform to the convolution relation and using the property that convolution in the time domain corresponds to multiplication in the frequency domain:\n$$\nS_{y y}(\\omega) = \\mathcal{F}\\{R_{y y}(\\tau)\\} = \\mathcal{F}\\{R_{xx}(\\tau)\\} \\cdot \\mathcal{F}\\{h(\\tau)\\} \\cdot \\mathcal{F}\\{h^*(-\\tau)\\}\n$$\nWe know that $\\mathcal{F}\\{R_{xx}(\\tau)\\} = S_{xx}(\\omega)$ and $\\mathcal{F}\\{h(\\tau)\\} = H(j\\omega)$. The Fourier transform of $h^*(-\\tau)$ is $H^*(j\\omega)$. Therefore,\n$$\nS_{y y}(\\omega) = S_{xx}(\\omega) H(j\\omega) H^*(j\\omega) = S_{xx}(\\omega) |H(j\\omega)|^2\n$$\nThis is the general input-output PSD relation for an LTI system.\nFor our two systems, the output PSDs are:\n$$\nS_{y_{1}y_{1}}(\\omega) = |H_{1}(j\\omega)|^2 S_{xx}(\\omega)\n$$\n$$\nS_{y_{2}y_{2}}(\\omega) = |H_{2}(j\\omega)|^2 S_{xx}(\\omega)\n$$\nFrom the first task, we established that $|H_{1}(j\\omega)| = |H_{2}(j\\omega)|$. Consequently, $|H_{1}(j\\omega)|^2 = |H_{2}(j\\omega)|^2$. It follows directly that for the same input PSD $S_{xx}(\\omega)$, the output PSDs are identical:\n$$\nS_{y_{1}y_{1}}(\\omega) = S_{y_{2}y_{2}}(\\omega)\n$$\n\nThird Task: Energy of the Difference in Impulse Responses\nThe input is the Dirac delta function, $x(t) = \\delta(t)$. The output of an LTI system to a delta input is, by definition, its impulse response $h(t)$.\nFirst, we find $h_{1}(t) = \\mathcal{L}^{-1}\\{H_{1}(s)\\}$.\n$$\nH_{1}(s) = \\frac{1}{s+1} \\implies h_{1}(t) = \\exp(-t) u(t)\n$$\nwhere $u(t)$ is the Heaviside step function.\nNext, we find $h_{2}(t) = \\mathcal{L}^{-1}\\{H_{2}(s)\\}$. The transfer function is:\n$$\nH_{2}(s) = H_{1}(s)A(s) = \\frac{1}{s+1} \\cdot \\frac{s-3}{s+3} = \\frac{s-3}{(s+1)(s+3)}\n$$\nWe perform a partial fraction expansion of $H_{2}(s)$:\n$$\nH_{2}(s) = \\frac{C_{1}}{s+1} + \\frac{C_{2}}{s+3}\n$$\nThe residues are calculated as follows:\n$$\nC_{1} = \\lim_{s \\to -1} (s+1)H_{2}(s) = \\lim_{s \\to -1} \\frac{s-3}{s+3} = \\frac{-1-3}{-1+3} = \\frac{-4}{2} = -2\n$$\n$$\nC_{2} = \\lim_{s \\to -3} (s+3)H_{2}(s) = \\lim_{s \\to -3} \\frac{s-3}{s+1} = \\frac{-3-3}{-3+1} = \\frac{-6}{-2} = 3\n$$\nSo, the expanded transfer function is:\n$$\nH_{2}(s) = \\frac{-2}{s+1} + \\frac{3}{s+3}\n$$\nThe corresponding impulse response is:\n$$\nh_{2}(t) = (-2\\exp(-t) + 3\\exp(-3t))u(t)\n$$\nWe are asked to compute the energy $E$ in the difference of the impulse responses, $d(t) = h_{2}(t) - h_{1}(t)$. For $t \\geq 0$:\n$$\nd(t) = (-2\\exp(-t) + 3\\exp(-3t)) - \\exp(-t) = 3\\exp(-3t) - 3\\exp(-t) = 3(\\exp(-3t) - \\exp(-t))\n$$\nThe energy is given by the integral of the squared difference:\n$$\nE = \\int_{0}^{\\infty} (d(t))^2 dt = \\int_{0}^{\\infty} [3(\\exp(-3t) - \\exp(-t))]^2 dt\n$$\n$$\nE = 9 \\int_{0}^{\\infty} (\\exp(-6t) - 2\\exp(-4t) + \\exp(-2t)) dt\n$$\nWe integrate term by term:\n$$\nE = 9 \\left[ \\int_{0}^{\\infty} \\exp(-6t) dt - 2\\int_{0}^{\\infty} \\exp(-4t) dt + \\int_{0}^{\\infty} \\exp(-2t) dt \\right]\n$$\nUsing the standard integral $\\int_{0}^{\\infty} \\exp(-at) dt = \\frac{1}{a}$ for $a  0$:\n$$\nE = 9 \\left[ \\left. -\\frac{1}{6}\\exp(-6t) \\right|_{0}^{\\infty} - 2\\left. \\left( -\\frac{1}{4}\\exp(-4t) \\right) \\right|_{0}^{\\infty} + \\left. \\left( -\\frac{1}{2}\\exp(-2t) \\right) \\right|_{0}^{\\infty} \\right]\n$$\n$$\nE = 9 \\left[ \\left( 0 - (-\\frac{1}{6}) \\right) - 2 \\left( 0 - (-\\frac{1}{4}) \\right) + \\left( 0 - (-\\frac{1}{2}) \\right) \\right]\n$$\n$$\nE = 9 \\left[ \\frac{1}{6} - 2\\left(\\frac{1}{4}\\right) + \\frac{1}{2} \\right] = 9 \\left[ \\frac{1}{6} - \\frac{1}{2} + \\frac{1}{2} \\right] = 9 \\left( \\frac{1}{6} \\right) = \\frac{9}{6}\n$$\nSimplifying the fraction gives the final result.\n$$\nE = \\frac{3}{2}\n$$\nThis non-zero energy demonstrates that although the systems have identical magnitude responses and thus identical steady-state power characteristics, their phase differences lead to distinct transient responses.", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "2882263"}, {"introduction": "This final practice offers a deeper, quantitative look into phase manipulation in the discrete-time domain. Building on the concept of all-pass systems, you will explore the specific technique of reflecting a system's zero across the unit circle—a fundamental operation in converting between minimum-phase and non-minimum-phase systems. The core task is to derive the exact analytical expression for the resulting change in group delay [@problem_id:2882304]. Mastering this relationship equips you with a powerful tool for analyzing phase distortion and designing phase equalizers.", "problem": "Consider a linear time-invariant (LTI) discrete-time system with transfer function $H_{1}(z)$ whose zeros and poles are all strictly off the unit circle except possibly at the origin, and let $z_{0} \\in \\mathbb{C}$ be a single zero of $H_{1}(z)$ with $|z_{0}| \\neq 1$. Suppose $H_{1}(z)$ factors as $H_{1}(z) = C \\left(1 - z_{0} z^{-1}\\right) G(z)$, where $C \\in \\mathbb{C}$ is a nonzero constant and $G(z)$ contains all the remaining factors (zeros and poles) of $H_{1}(z)$ and has no zeros or poles on the unit circle. Construct a second system $H_{2}(z)$ by replacing the factor $\\left(1 - z_{0} z^{-1}\\right)$ with $\\left(1 - z_{0}^{- \\ast} z^{-1}\\right)$, where $z_{0}^{- \\ast} \\triangleq 1/z_{0}^{\\ast}$ is the reflection of $z_{0}$ across the unit circle, and scale $H_{2}(z)$ by a complex constant $\\tilde{C}$ chosen so that $|H_{1}(\\exp(j \\omega))| = |H_{2}(\\exp(j \\omega))|$ for all real $\\omega$ (in radians). That is,\n$$\nH_{2}(z) \\triangleq \\tilde{C} \\left(1 - z_{0}^{- \\ast} z^{-1}\\right) G(z).\n$$\nWork from first principles using only the definitions of the discrete-time frequency response, magnitude, phase, and group delay, namely $H(\\exp(j \\omega)) \\triangleq H(z)\\big|_{z=\\exp(j\\omega)}$, $|H(\\exp(j\\omega))| \\triangleq \\sqrt{H(\\exp(j\\omega)) H^{\\ast}(\\exp(j\\omega))}$, $\\angle H(\\exp(j\\omega)) \\triangleq \\arg H(\\exp(j\\omega))$, and the group delay $\\tau_{g}(\\omega) \\triangleq - \\frac{d}{d \\omega} \\angle H(\\exp(j \\omega))$. Starting from these definitions and without invoking any pre-memorized “shortcut” formulas:\n\n1) Prove that there exists a choice of $\\tilde{C}$ that ensures $|H_{1}(\\exp(j \\omega))| = |H_{2}(\\exp(j \\omega))|$ for all real $\\omega$, and identify such a choice.\n\n2) Show that, with this choice, the ratio\n$$\nQ(\\exp(j \\omega)) \\triangleq \\frac{H_{2}(\\exp(j \\omega))}{H_{1}(\\exp(j \\omega))}\n$$\nhas unit magnitude for all real $\\omega$ and therefore can be interpreted as an all-pass factor on the unit circle that accounts for the phase change introduced by the zero reflection.\n\n3) Derive a closed-form expression for the group delay difference\n$$\n\\Delta \\tau_{g}(\\omega) \\triangleq \\tau_{g,2}(\\omega) - \\tau_{g,1}(\\omega) \\, ,\n$$\nentirely in terms of $z_{0}$ and $\\omega$, where $\\tau_{g,i}(\\omega)$ denotes the group delay of $H_{i}$ for $i \\in \\{1,2\\}$. Express your final result using $|z_{0}|$ and $\\arg(z_{0})$, as an explicit function of $\\omega$ (in radians). Express the group delay difference in samples.\n\nYour final answer must be a single closed-form analytic expression for $\\Delta \\tau_{g}(\\omega)$ in terms of $|z_{0}|$, $\\arg(z_{0})$, and $\\omega$; no numerical evaluation is required.", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens\n- System 1 transfer function: $H_{1}(z) = C \\left(1 - z_{0} z^{-1}\\right) G(z)$.\n- $z_{0} \\in \\mathbb{C}$ is a single zero of $H_1(z)$ with $|z_{0}| \\neq 1$.\n- $C \\in \\mathbb{C}$ is a nonzero constant.\n- $G(z)$ contains all other poles and zeros of $H_1(z)$ and has no poles or zeros on the unit circle.\n- System 2 transfer function: $H_{2}(z) = \\tilde{C} \\left(1 - z_{0}^{- \\ast} z^{-1}\\right) G(z)$.\n- Definition of reflected zero: $z_{0}^{- \\ast} \\triangleq 1/z_{0}^{\\ast}$.\n- Condition: The scaling constant $\\tilde{C}$ is chosen such that $|H_{1}(\\exp(j \\omega))| = |H_{2}(\\exp(j \\omega))|$ for all real $\\omega$.\n- Frequency response: $H(\\exp(j \\omega)) \\triangleq H(z)\\big|_{z=\\exp(j\\omega)}$.\n- Magnitude: $|H(\\exp(j\\omega))| \\triangleq \\sqrt{H(\\exp(j\\omega)) H^{\\ast}(\\exp(j\\omega))}$.\n- Phase: $\\angle H(\\exp(j\\omega)) \\triangleq \\arg H(\\exp(j\\omega))$.\n- Group delay: $\\tau_{g}(\\omega) \\triangleq - \\frac{d}{d \\omega} \\angle H(\\exp(j \\omega))$, in samples.\n- Ratio: $Q(\\exp(j \\omega)) \\triangleq \\frac{H_{2}(\\exp(j \\omega))}{H_{1}(\\exp(j \\omega))}$.\n- Group delay difference: $\\Delta \\tau_{g}(\\omega) \\triangleq \\tau_{g,2}(\\omega) - \\tau_{g,1}(\\omega)$.\n\nStep 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is a standard exercise in digital signal processing, concerning the properties of all-pass filters and the relationship between minimum-phase and non-minimum-phase systems. All concepts and definitions are fundamental to the field.\n- **Well-Posed**: The problem is structured as a sequence of three related tasks. Each task is clearly defined, and the necessary information to proceed from one to the next is provided or derivable. A unique solution for the group delay difference is expected.\n- **Objective**: The problem is stated using precise mathematical language, free from any subjectivity or ambiguity.\n\nStep 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, and objective. It is a standard, non-trivial problem in signal processing theory. I will proceed with the solution.\n\nThe solution is structured in three parts as requested by the problem.\n\n1) Existence and identification of $\\tilde{C}$\n\nThe condition to be satisfied is $|H_{1}(\\exp(j \\omega))| = |H_{2}(\\exp(j \\omega))|$. We evaluate the magnitudes of the transfer functions on the unit circle, where $z = \\exp(j \\omega)$.\n$$|H_{1}(\\exp(j \\omega))| = |C| |1 - z_{0} \\exp(-j \\omega)| |G(\\exp(j \\omega))|$$\n$$|H_{2}(\\exp(j \\omega))| = |\\tilde{C}| |1 - z_{0}^{- \\ast} \\exp(-j \\omega)| |G(\\exp(j \\omega))|$$\nEquating these two expressions and noting that $|G(\\exp(j \\omega))|$ is finite and nonzero, we can cancel this term to obtain:\n$$|C| |1 - z_{0} \\exp(-j \\omega)| = |\\tilde{C}| |1 - z_{0}^{- \\ast} \\exp(-j \\omega)|$$\nWe must now relate the terms $|1 - z_{0} \\exp(-j \\omega)|$ and $|1 - z_{0}^{- \\ast} \\exp(-j \\omega)|$. Let us analyze the second term, using the definition $z_{0}^{- \\ast} = 1/z_{0}^{\\ast}$.\n$$|1 - z_{0}^{- \\ast} \\exp(-j \\omega)| = \\left|1 - \\frac{1}{z_{0}^{\\ast}} \\exp(-j \\omega)\\right| = \\left|\\frac{z_{0}^{\\ast} - \\exp(-j \\omega)}{z_{0}^{\\ast}}\\right| = \\frac{|z_{0}^{\\ast} - \\exp(-j \\omega)|}{|z_{0}^{\\ast}|}$$\nUsing the property that $|w^{\\ast}| = |w|$ for any complex number $w$, we have $|z_{0}^{\\ast}| = |z_{0}|$ and $|z_{0}^{\\ast} - \\exp(-j \\omega)| = |(z_{0} - \\exp(j \\omega))^{\\ast}| = |z_{0} - \\exp(j \\omega)|$.\n$$|1 - z_{0}^{- \\ast} \\exp(-j \\omega)| = \\frac{|z_{0} - \\exp(j \\omega)|}{|z_{0}|}$$\nNow, for the first term:\n$$|1 - z_{0} \\exp(-j \\omega)| = |\\exp(-j \\omega) (\\exp(j \\omega) - z_{0})| = |\\exp(-j \\omega)| |\\exp(j \\omega) - z_{0}|$$\nSince $|\\exp(-j \\omega)| = 1$, we have $|1 - z_{0} \\exp(-j \\omega)| = |z_{0} - \\exp(j \\omega)|$.\nBy combining these results, we find the relationship between the two factors:\n$$|1 - z_{0} \\exp(-j \\omega)| = |z_{0}| |1 - z_{0}^{- \\ast} \\exp(-j \\omega)|$$\nSubstituting this back into the condition on the magnitudes:\n$$|C| \\left(|z_{0}| |1 - z_{0}^{- \\ast} \\exp(-j \\omega)|\\right) = |\\tilde{C}| |1 - z_{0}^{- \\ast} \\exp(-j \\omega)|$$\nSince $z_0$ is not on the unit circle, its reflection $z_0^{-*}$ is also not on the unit circle. Therefore, the term $1 - z_{0}^{- \\ast} \\exp(-j \\omega)$ is never zero for any $\\omega$, and its magnitude can be cancelled. This yields:\n$$|C| |z_{0}| = |\\tilde{C}|$$\nThis proves that a constant $\\tilde{C}$ satisfying the magnitude condition exists. Its magnitude is determined, but its phase is arbitrary. A valid choice for $\\tilde{C}$ is one that satisfies this magnitude relation, for example, by scaling $C$ by the positive real number $|z_0|$. A simple choice is $\\tilde{C} = C |z_{0}|$.\n\n2) Verification of the all-pass property of $Q(\\exp(j \\omega))$\n\nThe ratio $Q(\\exp(j \\omega))$ is defined as:\n$$Q(\\exp(j \\omega)) = \\frac{H_{2}(\\exp(j \\omega))}{H_{1}(\\exp(j \\omega))} = \\frac{\\tilde{C} \\left(1 - z_{0}^{- \\ast} \\exp(-j \\omega)\\right) G(\\exp(j \\omega))}{C \\left(1 - z_{0} \\exp(-j \\omega)\\right) G(\\exp(j \\omega))}$$\nThe factor $G(\\exp(j \\omega))$ cancels out:\n$$Q(\\exp(j \\omega)) = \\frac{\\tilde{C}}{C} \\frac{1 - z_{0}^{- \\ast} \\exp(-j \\omega)}{1 - z_{0} \\exp(-j \\omega)}$$\nTo show it has unit magnitude, we compute $|Q(\\exp(j \\omega))|$:\n$$|Q(\\exp(j \\omega))| = \\left|\\frac{\\tilde{C}}{C}\\right| \\left|\\frac{1 - z_{0}^{- \\ast} \\exp(-j \\omega)}{1 - z_{0} \\exp(-j \\omega)}\\right|$$\nFrom Part 1, we established that any valid choice of $\\tilde{C}$ must satisfy $|\\tilde{C}| = |C||z_{0}|$, which implies $|\\tilde{C}/C| = |z_{0}|$. We also established that $|1 - z_{0}^{- \\ast} \\exp(-j \\omega)| = \\frac{1}{|z_{0}|} |1 - z_{0} \\exp(-j \\omega)|$, which implies $\\left|\\frac{1 - z_{0}^{- \\ast} \\exp(-j \\omega)}{1 - z_{0} \\exp(-j \\omega)}\\right| = \\frac{1}{|z_{0}|}$.\nSubstituting these two results into the expression for $|Q(\\exp(j \\omega))|$:\n$$|Q(\\exp(j \\omega))| = |z_{0}| \\cdot \\frac{1}{|z_{0}|} = 1$$\nThis holds for all real $\\omega$. Thus, $Q(\\exp(j \\omega))$ is an all-pass factor that alters the phase response while maintaining a constant magnitude of $1$.\n\n3) Derivation of the group delay difference $\\Delta \\tau_{g}(\\omega)$\n\nThe group delay difference is $\\Delta \\tau_{g}(\\omega) = \\tau_{g,2}(\\omega) - \\tau_{g,1}(\\omega)$. Using the definition of group delay:\n$$\\Delta \\tau_{g}(\\omega) = \\left(-\\frac{d}{d \\omega} \\angle H_{2}(\\exp(j \\omega))\\right) - \\left(-\\frac{d}{d \\omega} \\angle H_{1}(\\exp(j \\omega))\\right) = -\\frac{d}{d \\omega} \\left( \\angle H_{2}(\\exp(j \\omega)) - \\angle H_{1}(\\exp(j \\omega)) \\right)$$\nThe difference in phase angles is the phase angle of the ratio:\n$$\\angle H_{2}(\\exp(j \\omega)) - \\angle H_{1}(\\exp(j \\omega)) = \\angle \\frac{H_{2}(\\exp(j \\omega))}{H_{1}(\\exp(j \\omega))} = \\angle Q(\\exp(j \\omega))$$\nSo, $\\Delta \\tau_{g}(\\omega) = -\\frac{d}{d \\omega} \\angle Q(\\exp(j \\omega))$.\nTo compute this derivative, we use the identity $\\frac{d}{d\\omega} \\arg(f(\\omega)) = \\Im\\left(\\frac{1}{f(\\omega)} \\frac{df(\\omega)}{d\\omega}\\right) = \\Im\\left(\\frac{d}{d\\omega} \\ln(f(\\omega))\\right)$.\nLet's find the logarithmic derivative of $Q(z)$ at $z=\\exp(j\\omega)$.\n$$Q(z) = \\frac{\\tilde{C}}{C} \\frac{1 - z_{0}^{- \\ast} z^{-1}}{1 - z_{0} z^{-1}}$$\n$$\\ln(Q(z)) = \\ln\\left(\\frac{\\tilde{C}}{C}\\right) + \\ln(1 - z_{0}^{- \\ast} z^{-1}) - \\ln(1 - z_{0} z^{-1})$$\nDifferentiating with respect to $\\omega$ (with $z=\\exp(j\\omega)$, so $dz/d\\omega = j\\exp(j\\omega) = jz$):\n$$\\frac{d}{d\\omega} \\ln(Q(\\exp(j\\omega))) = \\frac{d}{dz}[\\ln(Q(z))] \\frac{dz}{d\\omega} = \\left( \\frac{-z_{0}^{- \\ast} (-z^{-2})}{1 - z_{0}^{- \\ast} z^{-1}} - \\frac{-z_{0} (-z^{-2})}{1 - z_{0} z^{-1}} \\right) (jz)$$\n$$= \\left( \\frac{z_{0}^{- \\ast} z^{-2}}{1 - z_{0}^{- \\ast} z^{-1}} - \\frac{z_{0} z^{-2}}{1 - z_{0} z^{-1}} \\right) (jz) = j \\left( \\frac{z_{0}^{- \\ast} z^{-1}}{1 - z_{0}^{- \\ast} z^{-1}} - \\frac{z_{0} z^{-1}}{1 - z_{0} z^{-1}} \\right)$$\nThe phase derivative is the imaginary part of this expression. Since the entire expression is multiplied by $j$, we need the real part of the term in the parenthesis.\n$$\\frac{d}{d\\omega} \\angle Q(\\exp(j\\omega)) = \\Re\\left(\\frac{z_{0}^{- \\ast} z^{-1}}{1 - z_{0}^{- \\ast} z^{-1}} - \\frac{z_{0} z^{-1}}{1 - z_{0} z^{-1}}\\right)\\bigg|_{z=\\exp(j\\omega)}$$\nLet $a = z_0$ and $b = z_0^{-*}$. The group delay contribution from a factor $(1 - p z^{-1})$ is $-\\Re\\left(\\frac{p z^{-1}}{1 - p z^{-1}}\\right)$. Thus, the expression we have is $-(\\tau_{g, \\text{zero } z_0^{-*}} - \\tau_{g, \\text{zero } z_0})$.\nLet's compute $\\Re\\left(\\frac{p z^{-1}}{1 - p z^{-1}}\\right)$ for a generic complex number $p$ and $z=\\exp(j\\omega)$.\n$$\\frac{p z^{-1}}{1 - p z^{-1}} = \\frac{p z^{-1}(1 - p^{\\ast} z)}{|1 - p z^{-1}|^2} = \\frac{p z^{-1} - |p|^2}{|1 - p z^{-1}|^2}$$\nLet $p = r \\exp(j\\theta)$. Then $p z^{-1} = r \\exp(j\\theta) \\exp(-j\\omega) = r \\exp(j(\\theta-\\omega))$.\n$$\\Re(p z^{-1} - |p|^2) = \\Re(r(\\cos(\\theta-\\omega) + j\\sin(\\theta-\\omega)) - r^2) = r\\cos(\\theta-\\omega) - r^2$$\nThe denominator is $|1 - p z^{-1}|^2 = (1-pz^{-1})(1-p^*z) = 1 - pz^{-1} - p^*z + |p|^2 = 1 - 2\\Re(pz^{-1}) + |p|^2 = 1 - 2r\\cos(\\theta-\\omega) + r^2$.\nSo, $\\Re\\left(\\frac{p z^{-1}}{1 - p z^{-1}}\\right) = \\frac{r\\cos(\\theta-\\omega) - r^2}{1 - 2r\\cos(\\theta-\\omega) + r^2}$.\nLet $r_0 = |z_0|$ and $\\theta_0 = \\arg(z_0)$.\nFor the term with $p = z_0$, we have $r=r_0$ and $\\theta=\\theta_0$.\nFor the term with $p = z_0^{-*} = 1/z_0^*$, we have $p = (1/r_0)\\exp(j\\theta_0)$. So $r=1/r_0$ and $\\theta=\\theta_0$.\nLet's compute the difference:\n$$\\frac{d}{d\\omega} \\angle Q = \\frac{\\frac{1}{r_0}\\cos(\\theta_0-\\omega) - (\\frac{1}{r_0})^2}{1 - \\frac{2}{r_0}\\cos(\\theta_0-\\omega) + (\\frac{1}{r_0})^2} - \\frac{r_0\\cos(\\theta_0-\\omega) - r_0^2}{1 - 2r_0\\cos(\\theta_0-\\omega) + r_0^2}$$\nSimplifying the first term by multiplying numerator and denominator by $r_0^2$:\n$$\\frac{r_0\\cos(\\theta_0-\\omega) - 1}{r_0^2 - 2r_0\\cos(\\theta_0-\\omega) + 1}$$\nThe denominators are now identical. Let $D = 1 - 2r_0\\cos(\\theta_0-\\omega) + r_0^2$.\n$$\\frac{d}{d\\omega} \\angle Q = \\frac{(r_0\\cos(\\theta_0-\\omega) - 1) - (r_0\\cos(\\theta_0-\\omega) - r_0^2)}{D} = \\frac{r_0^2 - 1}{D}$$\nThe group delay difference is the negative of this quantity:\n$$\\Delta \\tau_{g}(\\omega) = -\\frac{r_0^2 - 1}{1 - 2r_0\\cos(\\theta_0-\\omega) + r_0^2} = \\frac{1 - r_0^2}{1 - 2r_0\\cos(\\theta_0-\\omega) + r_0^2}$$\nFinally, substituting $r_0 = |z_0|$ and $\\theta_0 = \\arg(z_0)$:\n$$\\Delta \\tau_{g}(\\omega) = \\frac{1 - |z_{0}|^2}{1 - 2|z_{0}|\\cos(\\arg(z_{0}) - \\omega) + |z_{0}|^2}$$\nThis expression gives the group delay difference in samples.", "answer": "$$ \\boxed{ \\frac{1 - |z_{0}|^2}{1 - 2|z_{0}|\\cos(\\arg(z_{0}) - \\omega) + |z_{0}|^2} } $$", "id": "2882304"}]}