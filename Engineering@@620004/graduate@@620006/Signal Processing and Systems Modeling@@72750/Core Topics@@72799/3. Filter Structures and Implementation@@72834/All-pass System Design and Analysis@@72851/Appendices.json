{"hands_on_practices": [{"introduction": "The first-order all-pass filter is a fundamental building block for a wide range of phase manipulation and equalization tasks. This practice bridges the gap between the filter's abstract mathematical description, specified by a single complex pole $a$, and its functional behavior, characterized by the group delay profile. By deriving the group delay from first principles and then solving the inverse problem of finding the pole location for a desired delay peak, you will develop a concrete intuition for engineering specific phase responses.[@problem_id:2851787]", "problem": "Consider the discrete-time first-order all-pass section\n$$\nH_1(z) \\;=\\; \\frac{z^{-1} - a}{1 - a^{*}\\, z^{-1}},\n$$\nwhere $a \\in \\mathbb{C}$, $|a|<1$, and $(\\cdot)^{*}$ denotes complex conjugation. The all-pass property means that for every angular frequency $\\omega$, the frequency response $H_1(\\exp(\\mathrm{j}\\,\\omega))$ has unit magnitude. The group delay is defined by\n$$\n\\tau(\\omega) \\;=\\; -\\,\\frac{\\mathrm{d}}{\\mathrm{d}\\omega}\\,\\arg\\!\\big(H_1(\\exp(\\mathrm{j}\\,\\omega))\\big).\n$$\nStarting from these definitions and without assuming any pre tabulated formulas, do the following:\n\n1) Derive an explicit analytic expression for the group delay $\\tau(\\omega)$ in terms of $a$ and $\\omega$.\n\n2) Show that $\\tau(\\omega)$ attains a unique maximum (the group-delay peak) at an angular frequency $\\omega_p$ aligned with the pole angle, and express the peak value $\\tau_{\\text{peak}}$ in terms of $|a|$.\n\n3) A design requirement specifies that the group delay must attain a peak value $\\tau_p>1$ at the angular frequency $\\omega_p$ (in radians). Determine the parameter $a$ that satisfies this requirement, and express your final answer as a single closed-form symbolic expression for $a$ in terms of $\\tau_p$ and $\\omega_p$ (in radians). No rounding is required.\n\n4) Briefly discuss, for the real-axis case $a\\in(-1,1)$, the trade-off that arises as $a\\to \\pm 1$ from within the unit disk, in terms of the peak height of the group delay, the bandwidth over which the delay is elevated, and the stability/time-domain implications.\n\nYour final reported answer must be the single closed-form symbolic expression for $a$ requested in item 3), with the angle expressed in radians.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on fundamental principles of discrete-time signal processing and is suitable for rigorous analysis. All necessary information and definitions are provided, and there are no internal contradictions. Therefore, the problem is valid and I will proceed with a full derivation.\n\nThe transfer function of the first-order all-pass section is given by\n$$H_1(z) = \\frac{z^{-1} - a}{1 - a^{*} z^{-1}}$$\nwhere $a \\in \\mathbb{C}$ and $|a| < 1$. The condition $|a|<1$ ensures that the pole of the system, located at $z=a^*$, is inside the unit circle, which guarantees stability.\n\nFirst, we will derive the group delay $\\tau(\\omega)$. The frequency response is obtained by evaluating $H_1(z)$ on the unit circle, $z = \\exp(\\mathrm{j}\\,\\omega)$:\n$$H_1(\\exp(\\mathrm{j}\\,\\omega)) = \\frac{\\exp(-\\mathrm{j}\\,\\omega) - a}{1 - a^{*} \\exp(-\\mathrm{j}\\,\\omega)}$$\nTo simplify the analysis of the phase, we can rewrite the numerator as $\\exp(-\\mathrm{j}\\,\\omega) - a = \\exp(-\\mathrm{j}\\,\\omega)(1 - a \\exp(\\mathrm{j}\\,\\omega))$. Let us define the complex function $C(\\omega) = 1 - a \\exp(\\mathrm{j}\\,\\omega)$. Its complex conjugate is $C^*(\\omega) = (1 - a \\exp(\\mathrm{j}\\,\\omega))^* = 1 - a^* (\\exp(\\mathrm{j}\\,\\omega))^* = 1 - a^* \\exp(-\\mathrm{j}\\,\\omega)$.\nSubstituting these into the frequency response expression, we get:\n$$H_1(\\exp(\\mathrm{j}\\,\\omega)) = \\frac{\\exp(-\\mathrm{j}\\,\\omega) C(\\omega)}{C^*(\\omega)}$$\nThis form confirms the all-pass property, as $|H_1(\\exp(\\mathrm{j}\\,\\omega))| = |\\exp(-\\mathrm{j}\\,\\omega)| \\frac{|C(\\omega)|}{|C^*(\\omega)|} = 1 \\cdot \\frac{|C(\\omega)|}{|C(\\omega)|} = 1$.\nThe phase angle of the frequency response, $\\Theta(\\omega) = \\arg(H_1(\\exp(\\mathrm{j}\\,\\omega)))$, can be found from the sum of the arguments of the terms:\n$$\\Theta(\\omega) = \\arg(\\exp(-\\mathrm{j}\\,\\omega)) + \\arg(C(\\omega)) - \\arg(C^*(\\omega))$$\nSince $\\arg(C^*(\\omega)) = -\\arg(C(\\omega))$, we have:\n$$\\Theta(\\omega) = -\\omega + 2\\arg(C(\\omega)) = -\\omega + 2\\arg(1 - a \\exp(\\mathrm{j}\\,\\omega))$$\nLet $a = r \\exp(\\mathrm{j}\\,\\phi)$, where $r = |a|$ and $\\phi = \\arg(a)$. The term inside the argument is:\n$$1 - a \\exp(\\mathrm{j}\\,\\omega) = 1 - r \\exp(\\mathrm{j}\\,\\phi) \\exp(\\mathrm{j}\\,\\omega) = 1 - r \\exp(\\mathrm{j}(\\omega+\\phi))$$\n$$1 - r\\exp(\\mathrm{j}(\\omega+\\phi)) = (1 - r\\cos(\\omega+\\phi)) - \\mathrm{j}\\,r\\sin(\\omega+\\phi)$$\nSo, the phase of this term is $\\psi(\\omega) = \\arctan\\left(\\frac{-r\\sin(\\omega+\\phi)}{1 - r\\cos(\\omega+\\phi)}\\right)$. The total phase is $\\Theta(\\omega) = -\\omega + 2\\psi(\\omega)$.\nThe group delay is defined as $\\tau(\\omega) = -\\frac{\\mathrm{d}\\Theta}{\\mathrm{d}\\omega}$:\n$$\\tau(\\omega) = -\\frac{\\mathrm{d}}{\\mathrm{d}\\omega} \\left[-\\omega + 2 \\arctan\\left(\\frac{-r\\sin(\\omega+\\phi)}{1 - r\\cos(\\omega+\\phi)}\\right)\\right] = 1 - 2 \\frac{\\mathrm{d}}{\\mathrm{d}\\omega} \\left[\\arctan\\left(\\frac{-r\\sin(\\omega+\\phi)}{1 - r\\cos(\\omega+\\phi)}\\right)\\right]$$\nUsing the chain rule for differentiation, $\\frac{\\mathrm{d}}{\\mathrm{d}x}\\arctan(u) = \\frac{1}{1+u^2}\\frac{\\mathrm{d}u}{\\mathrm{d}x}$, with $u(\\omega) = \\frac{-r\\sin(\\omega+\\phi)}{1 - r\\cos(\\omega+\\phi)}$, we find the derivative of the arctan term. The derivative of $u(\\omega)$ with respect to $\\omega$ is:\n$$\\frac{\\mathrm{d}u}{\\mathrm{d}\\omega} = \\frac{-r\\cos(\\omega+\\phi)(1 - r\\cos(\\omega+\\phi)) - (-r\\sin(\\omega+\\phi))(r\\sin(\\omega+\\phi))}{(1 - r\\cos(\\omega+\\phi))^2} = \\frac{-r\\cos(\\omega+\\phi) + r^2}{(1 - r\\cos(\\omega+\\phi))^2}$$\nAnd $1+u^2$ is:\n$$1+u^2 = 1 + \\frac{r^2\\sin^2(\\omega+\\phi)}{(1 - r\\cos(\\omega+\\phi))^2} = \\frac{1 - 2r\\cos(\\omega+\\phi) + r^2\\cos^2(\\omega+\\phi) + r^2\\sin^2(\\omega+\\phi)}{(1-r\\cos(\\omega+\\phi))^2} = \\frac{1 - 2r\\cos(\\omega+\\phi) + r^2}{(1-r\\cos(\\omega+\\phi))^2}$$\nCombining these results, the derivative of the arctan term is:\n$$\\frac{\\mathrm{d}\\psi}{\\mathrm{d}\\omega} = \\frac{(1-r\\cos(\\omega+\\phi))^2}{1 - 2r\\cos(\\omega+\\phi) + r^2} \\cdot \\frac{r^2 - r\\cos(\\omega+\\phi)}{(1 - r\\cos(\\omega+\\phi))^2} = \\frac{r^2 - r\\cos(\\omega+\\phi)}{1 - 2r\\cos(\\omega+\\phi) + r^2}$$\nSubstituting this back into the expression for $\\tau(\\omega)$:\n$$\\tau(\\omega) = 1 - 2\\left(\\frac{r^2 - r\\cos(\\omega+\\phi)}{1 - 2r\\cos(\\omega+\\phi) + r^2}\\right) = \\frac{(1 - 2r\\cos(\\omega+\\phi) + r^2) - 2(r^2 - r\\cos(\\omega+\\phi))}{1 - 2r\\cos(\\omega+\\phi) + r^2}$$\n$$\\tau(\\omega) = \\frac{1 - 2r\\cos(\\omega+\\phi) + r^2 - 2r^2 + 2r\\cos(\\omega+\\phi)}{1 - 2r\\cos(\\omega+\\phi) + r^2} = \\frac{1 - r^2}{1 - 2r\\cos(\\omega+\\phi) + r^2}$$\nReplacing $r$ with $|a|$ and $\\phi$ with $\\arg(a)$, we obtain the final expression for the group delay, completing item 1):\n$$\\tau(\\omega) = \\frac{1 - |a|^2}{1 - 2|a|\\cos(\\omega + \\arg(a)) + |a|^2}$$\n\nFor item 2), we seek to find the maximum of $\\tau(\\omega)$. The numerator $1 - |a|^2$ is a positive constant. Therefore, $\\tau(\\omega)$ is maximized when its denominator is minimized. The denominator is $D(\\omega) = 1 + |a|^2 - 2|a|\\cos(\\omega + \\arg(a))$. To minimize $D(\\omega)$, we must maximize the term $\\cos(\\omega + \\arg(a))$. The maximum value of the cosine function is $1$, which occurs when its argument is an integer multiple of $2\\pi$.\n$$\\omega_p + \\arg(a) = 2k\\pi, \\quad k \\in \\mathbb{Z}$$\nThis gives the peak frequency $\\omega_p = -\\arg(a) + 2k\\pi$. The pole of the system is $p = a^* = |a|\\exp(-\\mathrm{j}\\arg(a))$, so its angle is $-\\arg(a)$. Thus, the peak group delay frequency $\\omega_p$ is indeed aligned with the angle of the pole. The function $\\cos(\\cdot)$ has a unique maximum over any interval of length $2\\pi$, so the peak frequency is unique within a principal interval like $[-\\pi, \\pi]$.\nThe peak value of the group delay, $\\tau_{\\text{peak}}$, is found by substituting $\\cos(\\omega_p + \\arg(a)) = 1$ into the expression for $\\tau(\\omega)$:\n$$\\tau_{\\text{peak}} = \\frac{1 - |a|^2}{1 - 2|a|(1) + |a|^2} = \\frac{1 - |a|^2}{(1-|a|)^2} = \\frac{(1-|a|)(1+|a|)}{(1-|a|)^2} = \\frac{1+|a|}{1-|a|}$$\nThis completes item 2). The peak value depends only on the magnitude of $a$.\n\nFor item 3), we are given the design requirements: a peak group delay $\\tau_p > 1$ occurring at an angular frequency $\\omega_p$. From our analysis in item 2), we have two conditions:\n$$ \\tau_p = \\frac{1+|a|}{1-|a|} \\quad \\text{and} \\quad \\omega_p = -\\arg(a) $$\nWe can solve the first equation for $|a|$:\n$$\\tau_p(1-|a|) = 1+|a|$$\n$$\\tau_p - \\tau_p|a| = 1+|a|$$\n$$\\tau_p - 1 = |a|(1+\\tau_p)$$\n$$|a| = \\frac{\\tau_p - 1}{\\tau_p + 1}$$\nThe condition $\\tau_p > 1$ ensures that $0 < |a| < 1$, which is consistent with the stability requirement. From the second equation, we have $\\arg(a) = -\\omega_p$.\nThe parameter $a$ can be constructed from its magnitude $|a|$ and argument $\\arg(a)$ using the polar form $a = |a|\\exp(\\mathrm{j}\\,\\arg(a))$:\n$$a = \\left(\\frac{\\tau_p - 1}{\\tau_p + 1}\\right) \\exp(-\\mathrm{j}\\,\\omega_p)$$\nThis is the required closed-form expression for $a$.\n\nFor item 4), we discuss the trade-off for a real parameter $a \\in (-1, 1)$.\nIf $a \\in \\mathbb{R}$, then $\\arg(a)$ is either $0$ (for $a>0$) or $\\pi$ (for $a<0$).\nThe peak delay is $\\tau_{\\text{peak}} = \\frac{1+|a|}{1-|a|}$. As $|a| \\to 1$, $\\tau_{\\text{peak}} \\to \\infty$.\nIf $a \\to 1^-$, we have $|a| \\to 1$ and $\\arg(a) = 0$. The group delay peak occurs at $\\omega_p = 0$ (DC) and its height becomes very large. The delay expression near $\\omega=0$ can be approximated as a Lorentzian function $\\tau(\\omega) \\approx \\frac{2(1-a)}{(1-a)^2 + a\\omega^2}$. The bandwidth of this peak, characterized by its half-width, is proportional to $1-a$. Thus, as $a$ approaches $1$, the peak delay becomes higher but also much narrower. In the time domain, the pole at $z=a$ approaches the unit circle at $z=1$. This causes the system's impulse response, which contains a term $a^n$, to decay very slowly, leading to poor transient response and long settling times.\nIf $a \\to -1^+$, we have $|a| \\to 1$ and $\\arg(a) = \\pi$. The group delay peak occurs at $\\omega_p = \\pi$ (Nyquist frequency). A similar analysis shows that the peak becomes infinitely high and narrow as $a$ approaches $-1$. In the time domain, the pole at $z=a$ approaches $z=-1$, causing the impulse response, with its term $a^n = (-|a|)^n$, to be a slowly decaying alternating sequence.\nThe fundamental trade-off is this: achieving a very large group delay at a specific frequency requires placing a pole very close to the unit circle. This inevitably leads to a sharp, narrow-band peak in the group delay profile and a slow-settling (nearly unstable) response in the time domain. High selectivity in group delay comes at the cost of reduced bandwidth and poor time-domain performance.", "answer": "$$\\boxed{\\left(\\frac{\\tau_p - 1}{\\tau_p + 1}\\right) \\exp(-\\mathrm{j}\\,\\omega_p)}$$", "id": "2851787"}, {"introduction": "While designing a single filter section is instructive, practical applications often require approximating a complex, arbitrary group delay curve. This exercise elevates the design task by guiding you to formulate group delay equalization as a formal constrained optimization problem, a powerful paradigm used in modern filter design software. By setting up the objective function and constraints, you will learn how to translate a high-level design goal into a precise mathematical framework ready for computational solution.[@problem_id:2851788]", "problem": "Consider the design of a discrete-time, real-coefficient, all-pass system realized as a cascade of $M$ first-order sections\n$$\nA(z;\\mathbf{a}) \\;=\\; \\prod_{k=1}^{M} \\frac{z^{-1} - a_k}{1 - a_k z^{-1}},\n$$\nwhere $\\mathbf{a} = [a_1,\\dots,a_M]^{\\mathsf{T}}$ and each $a_k \\in \\mathbb{R}$. The system is driven by angular frequency $\\omega \\in [0,\\pi]$ in radians. By construction, each section is all-pass provided the numerator is the time-reversed and conjugated version of the denominator, and stability requires all poles to lie strictly inside the unit circle.\n\nLet the group delay be defined as $\\tau_A(\\omega) \\triangleq -\\frac{d}{d\\omega}\\arg\\{A(\\exp(j\\omega);\\mathbf{a})\\}$, and let $\\tau_d(\\omega)$ be a given desired group-delay function defined on a design band $\\Omega \\subseteq [0,\\pi]$. Let $w(\\omega) \\ge 0$ be a bounded weighting function on $\\Omega$. Define the weighted Euclidean (L2) norm of the group-delay error over $\\Omega$ by\n$$\n\\left\\| \\tau_A - \\tau_d \\right\\|_{2,w,\\Omega} \\;\\triangleq\\; \\left(\\int_{\\Omega} w(\\omega)\\,\\big(\\tau_A(\\omega)-\\tau_d(\\omega)\\big)^2\\,d\\omega\\right)^{\\frac{1}{2}}.\n$$\nTo obtain a computable surrogate, approximate the integral by a positive-weight quadrature on nodes $\\{\\omega_n\\}_{n=1}^{N}\\subset \\Omega$ with weights $\\{\\gamma_n\\}_{n=1}^{N}$, where each $\\gamma_n>0$ and the nodes $\\omega_n$ are in radians. For robust stability margin, replace $|a_k|<1$ by the inequality bounds $|a_k| \\le \\rho$ with a given design margin $\\rho \\in (0,1)$.\n\nStarting from the definitions above and fundamental properties of all-pass sections and group delay, do the following:\n- Derive an explicit, analytic expression for the group delay $\\tau_A(\\omega)$ of the cascade in terms of the coefficients $\\{a_k\\}_{k=1}^{M}$ and $\\omega$.\n- Write the discretized, weighted squared-error objective $J(\\mathbf{a})$ obtained by applying the specified quadrature to the integrand of the squared norm.\n- Formulate the constrained optimization problem that minimizes $J(\\mathbf{a})$ subject to the stability-margin constraints $|a_k|\\le \\rho$ for $k=1,\\dots,M$.\n- Introduce nonnegative Lagrange multipliers $\\boldsymbol{\\mu}^+ = [\\mu_1^+,\\dots,\\mu_M^+]^{\\mathsf{T}}$ and $\\boldsymbol{\\mu}^- = [\\mu_1^-,\\dots,\\mu_M^-]^{\\mathsf{T}}$ for the inequality constraints $a_k - \\rho \\le 0$ and $-a_k - \\rho \\le 0$, respectively, and provide the exact closed-form Lagrangian function $L(\\mathbf{a},\\boldsymbol{\\mu}^+,\\boldsymbol{\\mu}^-)$ of the discretized problem.\n\nYour final answer must be a single, closed-form analytic expression for the Lagrangian $L(\\mathbf{a},\\boldsymbol{\\mu}^+,\\boldsymbol{\\mu}^-)$ in terms of $\\{\\gamma_n\\}$, $\\{\\omega_n\\}$, $\\tau_d(\\cdot)$, $\\rho$, and the variables $(\\mathbf{a},\\boldsymbol{\\mu}^+,\\boldsymbol{\\mu}^-)$. No numerical approximation is required. The answer must not include units and must be written in radians.", "solution": "The problem statement is scientifically grounded, formally coherent, and complete. It presents a standard task in digital filter designâ€”specifically, the formulation of a group delay equalization problem as a constrained optimization problem. We shall proceed with the derivation as requested.\n\nThe derivation is structured into four parts: first, the analytic expression for the group delay of the cascaded all-pass system; second, the formulation of the discretized objective function; third, the statement of the constrained optimization problem; and finally, the construction of the Lagrangian function.\n\nFirst, we derive the group delay $\\tau_A(\\omega)$ of the cascaded system. The transfer function is given by\n$$\nA(z;\\mathbf{a}) = \\prod_{k=1}^{M} A_k(z)\n$$\nwhere each first-order section is\n$$\nA_k(z) = \\frac{z^{-1} - a_k}{1 - a_k z^{-1}}.\n$$\nThe system is evaluated at the angular frequency $\\omega$ by substituting $z = \\exp(j\\omega)$, where $j = \\sqrt{-1}$. The total phase of the system is the sum of the phases of the individual sections:\n$$\n\\arg\\{A(\\exp(j\\omega);\\mathbf{a})\\} = \\arg\\left\\{\\prod_{k=1}^{M} A_k(\\exp(j\\omega))\\right\\} = \\sum_{k=1}^{M} \\arg\\{A_k(\\exp(j\\omega))\\}.\n$$\nThe group delay $\\tau_A(\\omega)$ is defined as the negative derivative of the phase with respect to $\\omega$. By linearity of differentiation, the total group delay is the sum of the group delays of the individual sections:\n$$\n\\tau_A(\\omega) = -\\frac{d}{d\\omega} \\arg\\{A(\\exp(j\\omega);\\mathbf{a})\\} = \\sum_{k=1}^{M} \\left(-\\frac{d}{d\\omega} \\arg\\{A_k(\\exp(j\\omega))\\}\\right) = \\sum_{k=1}^{M} \\tau_{A_k}(\\omega).\n$$\nWe now derive the group delay $\\tau_{A_k}(\\omega)$ for a single first-order section. Let $\\phi_k(\\omega) = \\arg\\{A_k(\\exp(j\\omega))\\}$.\n$$\nA_k(\\exp(j\\omega)) = \\frac{\\exp(-j\\omega) - a_k}{1 - a_k \\exp(-j\\omega)}.\n$$\nThe numerator is $N_k(\\omega) = \\exp(-j\\omega) - a_k = \\cos(\\omega) - a_k - j\\sin(\\omega)$.\nThe denominator is $D_k(\\omega) = 1 - a_k \\exp(-j\\omega) = 1 - a_k\\cos(\\omega) + ja_k\\sin(\\omega)$.\nThe phase is $\\phi_k(\\omega) = \\arg\\{N_k(\\omega)\\} - \\arg\\{D_k(\\omega)\\}$.\nUsing the arctangent function,\n$$\n\\phi_k(\\omega) = \\arctan\\left(\\frac{-\\sin(\\omega)}{\\cos(\\omega) - a_k}\\right) - \\arctan\\left(\\frac{a_k\\sin(\\omega)}{1-a_k\\cos(\\omega)}\\right).\n$$\nThe derivative of $\\arctan(u(x))$ is $\\frac{1}{1+u(x)^2} \\frac{du(x)}{dx}$. Applying this to both terms and executing the differentiation yields the well-known result for a first-order real all-pass section:\n$$\n\\tau_{A_k}(\\omega) = -\\frac{d\\phi_k(\\omega)}{d\\omega} = \\frac{1 - a_k^2}{1 - 2a_k\\cos(\\omega) + a_k^2}.\n$$\nSumming over all $M$ sections, the total group delay is:\n$$\n\\tau_A(\\omega) = \\sum_{k=1}^{M} \\frac{1 - a_k^2}{1 - 2a_k\\cos(\\omega) + a_k^2}.\n$$\n\nSecond, we formulate the discretized, weighted squared-error objective function $J(\\mathbf{a})$. The continuous squared-error norm is given by $\\left\\| \\tau_A - \\tau_d \\right\\|_{2,w,\\Omega}^2 = \\int_{\\Omega} w(\\omega)\\,\\big(\\tau_A(\\omega)-\\tau_d(\\omega)\\big)^2\\,d\\omega$. This integral is to be approximated by a quadrature rule on nodes $\\{\\omega_n\\}_{n=1}^{N}$ with weights $\\{\\gamma_n\\}_{n=1}^{N}$. The problem statement implies that this quadrature approximates the weighted integral, i.e., $\\int_{\\Omega} w(\\omega)f(\\omega)d\\omega \\approx \\sum_{n=1}^{N} \\gamma_n f(\\omega_n)$, where the weights $\\gamma_n$ incorporate the information from $w(\\omega)$. Thus, we set $f(\\omega) = (\\tau_A(\\omega)-\\tau_d(\\omega))^2$. The objective function $J(\\mathbf{a})$ is the discretized squared error:\n$$\nJ(\\mathbf{a}) = \\sum_{n=1}^{N} \\gamma_n \\left( \\tau_A(\\omega_n) - \\tau_d(\\omega_n) \\right)^2.\n$$\nSubstituting the derived expression for $\\tau_A(\\omega)$:\n$$\nJ(\\mathbf{a}) = \\sum_{n=1}^{N} \\gamma_n \\left( \\left( \\sum_{k=1}^{M} \\frac{1 - a_k^2}{1 - 2a_k \\cos(\\omega_n) + a_k^2} \\right) - \\tau_d(\\omega_n) \\right)^2.\n$$\n\nThird, the constrained optimization problem is formulated. We seek to find the vector of coefficients $\\mathbf{a}$ that minimizes the objective function $J(\\mathbf{a})$ subject to the given stability-margin constraints. The problem is:\n$$\n\\min_{\\mathbf{a} \\in \\mathbb{R}^M} J(\\mathbf{a})\n$$\nsubject to the constraints:\n$$\n|a_k| \\le \\rho \\quad \\text{for } k = 1, \\dots, M.\n$$\nThese constraints are equivalent to the set of $2M$ linear inequalities:\n$$\na_k - \\rho \\le 0 \\quad \\text{for } k = 1, \\dots, M,\n$$\n$$\n-a_k - \\rho \\le 0 \\quad \\text{for } k = 1, \\dots, M.\n$$\n\nFourth, we construct the Lagrangian function $L(\\mathbf{a}, \\boldsymbol{\\mu}^+, \\boldsymbol{\\mu}^-)$. For a constrained optimization problem of the form $\\min f(x)$ subject to $g_i(x) \\le 0$, the Lagrangian is $L(x, \\lambda) = f(x) + \\sum_i \\lambda_i g_i(x)$, with nonnegative Lagrange multipliers $\\lambda_i \\ge 0$.\nHere, the objective is $J(\\mathbf{a})$. The constraints are $g_{k,1}(\\mathbf{a}) = a_k - \\rho \\le 0$ and $g_{k,2}(\\mathbf{a}) = -a_k - \\rho \\le 0$. The corresponding Lagrange multipliers are given as $\\mu_k^+$ and $\\mu_k^-$.\nThe Lagrangian is therefore:\n$$\nL(\\mathbf{a}, \\boldsymbol{\\mu}^+, \\boldsymbol{\\mu}^-) = J(\\mathbf{a}) + \\sum_{k=1}^{M} \\mu_k^+ (a_k - \\rho) + \\sum_{k=1}^{M} \\mu_k^- (-a_k - \\rho).\n$$\nThis can be written more compactly as:\n$$\nL(\\mathbf{a}, \\boldsymbol{\\mu}^+, \\boldsymbol{\\mu}^-) = J(\\mathbf{a}) + \\sum_{k=1}^{M} \\left[ \\mu_k^+ (a_k - \\rho) + \\mu_k^- (-a_k - \\rho) \\right].\n$$\nSubstituting the complete expression for $J(\\mathbf{a})$ gives the final, closed-form expression for the Lagrangian function.\n$$\nL(\\mathbf{a}, \\boldsymbol{\\mu}^+, \\boldsymbol{\\mu}^-) = \\sum_{n=1}^{N} \\gamma_n \\left( \\left( \\sum_{k=1}^{M} \\frac{1 - a_k^2}{1 - 2a_k \\cos(\\omega_n) + a_k^2} \\right) - \\tau_d(\\omega_n) \\right)^2 + \\sum_{k=1}^{M} \\left[ \\mu_k^+ (a_k - \\rho) + \\mu_k^- (-a_k - \\rho) \\right].\n$$\nThis is the requested expression in terms of the specified parameters and variables.", "answer": "$$\n\\boxed{\\sum_{n=1}^{N} \\gamma_n \\left( \\left( \\sum_{k=1}^{M} \\frac{1 - a_k^2}{1 - 2a_k \\cos(\\omega_n) + a_k^2} \\right) - \\tau_d(\\omega_n) \\right)^2 + \\sum_{k=1}^{M} \\left( \\mu_k^+ (a_k - \\rho) + \\mu_k^- (-a_k - \\rho) \\right)}\n$$", "id": "2851788"}, {"introduction": "An ideal mathematical design is only the first step in an engineering workflow; its real-world performance depends critically on its implementation. This final practice confronts the practical challenge of coefficient quantization, an unavoidable effect in digital hardware with finite precision. By using perturbation analysis to assess the sensitivity of a second-order all-pass filter to small coefficient errors, you will learn to quantify the deviation from ideal performance, a crucial skill for ensuring the robustness of any digital filter implementation.[@problem_id:2851748]", "problem": "Consider the ideal real-coefficient second-order discrete-time all-pass filter\n$$\nH(z) \\;=\\; \\frac{r^{2} \\;-\\; 2 r \\cos(\\theta)\\, z^{-1} \\;+\\; z^{-2}}{1 \\;-\\; 2 r \\cos(\\theta)\\, z^{-1} \\;+\\; r^{2} z^{-2}},\n$$\nwith pole radius $0<r<1$ and pole angle $0<\\theta<\\pi$. The coefficients are implemented in fixed-point with a mid-tread uniform rounding quantizer of step size $\\Delta>0$, and the six scalar coefficients appearing in the numerator and denominator are quantized independently. That is, if $N(z)$ and $D(z)$ denote the numerator and denominator of $H(z)$, the implemented transfer function is\n$$\n\\widetilde{H}(z) \\;=\\; \\frac{N(z) + \\Delta N(z)}{D(z) + \\Delta D(z)},\n$$\nwhere $\\Delta N(z) \\,=\\, \\Delta n_{0} \\;+\\; \\Delta n_{1} z^{-1} \\;+\\; \\Delta n_{2} z^{-2}$ and $\\Delta D(z) \\,=\\, \\Delta d_{0} \\;+\\; \\Delta d_{1} z^{-1} \\;+\\; \\Delta d_{2} z^{-2}$, with coefficient errors satisfying $|\\Delta n_{k}| \\le \\Delta/2$ and $|\\Delta d_{k}| \\le \\Delta/2$ for $k\\in\\{0,1,2\\}$.\n\nStarting from first principles in linear systems and perturbation theory:\n- Use the characteristic polynomial in $z$ of the ideal denominator to derive the first-order sensitivity of the pole locations to the coefficient perturbations $\\Delta d_{0}$, $\\Delta d_{1}$, and $\\Delta d_{2}$. Express the magnitude of the pole perturbation in terms of $r$, $\\theta$, and $\\Delta$.\n- Using the fact that an ideal all-pass filter has unit magnitude on the unit circle, derive an analytic upper bound on the deviation of the implemented magnitude response from unity,\n$$\n\\sup_{\\omega \\in \\mathbb{R}} \\left|\\,|\\widetilde{H}(\\exp(j\\omega))| - 1\\,\\right|,\n$$\nin terms of $r$ and $\\Delta$. Your derivation must rely only on fundamental inequalities, first-order perturbations of rational functions, and lower bounds that are valid for all $\\omega$ given $0<r<1$ and $0<\\theta<\\pi$.\n\nProvide as your final answer a single closed-form analytic expression for the uniform upper bound as a function of $r$ and $\\Delta$. No numerical evaluation or rounding is required. State all intermediate steps and justifications clearly, beginning from the above definitions and assumptions. Angles, if present, must be treated symbolically (no degrees or radians conversion is needed for the final bound).", "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It addresses a standard topic in digital signal processing, namely, the effects of coefficient quantization on the performance of an all-pass filter. All provided definitions and parameters are consistent with established theory. We may therefore proceed with a full solution. The problem asks for two derivations: the first-order sensitivity of pole locations and an upper bound on the magnitude response deviation.\n\nFirst, we analyze the sensitivity of the pole locations. The poles of the ideal filter\n$$\nH(z) = \\frac{r^{2} - 2 r \\cos(\\theta) z^{-1} + z^{-2}}{1 - 2 r \\cos(\\theta) z^{-1} + r^{2} z^{-2}}\n$$\nare the roots of the denominator polynomial $D(z) = 1 - 2 r \\cos(\\theta) z^{-1} + r^{2} z^{-2}$. To find these roots, we solve $D(z)=0$, which is equivalent to solving the characteristic polynomial in positive powers of $z$, $P(z) = z^2 D(z) = z^2 - 2r\\cos(\\theta)z + r^2 = 0$. The roots are a complex conjugate pair $p = r \\exp(j\\theta)$ and $p^* = r \\exp(-j\\theta)$, as $0 < r < 1$ and $0 < \\theta < \\pi$.\nThe denominator can be written in factored form as $D(z) = (1 - p z^{-1})(1 - p^* z^{-1})$.\n\nThe implemented filter has a perturbed denominator $\\widetilde{D}(z) = D(z) + \\Delta D(z)$, where $\\Delta D(z) = \\Delta d_0 + \\Delta d_1 z^{-1} + \\Delta d_2 z^{-2}$. The perturbed pole $\\tilde{p} = p + \\Delta p$ must be a root of $\\widetilde{D}(\\tilde{p}) = 0$. Using a first-order Taylor series expansion around the original pole $p$, we have:\n$$\n\\widetilde{D}(p + \\Delta p) \\approx \\widetilde{D}(p) + \\widetilde{D}'(p) \\Delta p = 0\n$$\nSince $p$ is a root of the ideal denominator, $D(p)=0$, we have $\\widetilde{D}(p) = D(p) + \\Delta D(p) = \\Delta D(p)$. For the derivative, a first-order approximation uses the unperturbed polynomial: $\\widetilde{D}'(p) \\approx D'(p)$. The pole perturbation $\\Delta p$ is thus given by:\n$$\n\\Delta p \\approx -\\frac{\\Delta D(p)}{D'(p)}\n$$\nThe error polynomial evaluated at the pole $p$ is $\\Delta D(p) = \\Delta d_0 + \\Delta d_1 p^{-1} + \\Delta d_2 p^{-2}$.\nThe derivative of the denominator is $D'(z) = p z^{-2}(1-p^*z^{-1}) + p^*z^{-2}(1-pz^{-1})$. Evaluating at $z=p$:\n$$\nD'(p) = p p^{-2}(1 - p^* p^{-1}) = p^{-1}(1 - p^* p^{-1}) = \\frac{p-p^*}{p^2}\n$$\nThe difference between the poles is $p - p^* = r \\exp(j\\theta) - r \\exp(-j\\theta) = 2jr\\sin(\\theta)$.\nSubstituting this into the expression for $\\Delta p$:\n$$\n\\Delta p \\approx -\\frac{\\Delta D(p)}{(p-p^*)p^{-2}} = -\\frac{\\Delta d_0 + \\Delta d_1 p^{-1} + \\Delta d_2 p^{-2}}{2jr\\sin(\\theta)p^{-2}} = -\\frac{\\Delta d_0 p^2 + \\Delta d_1 p + \\Delta d_2}{2jr\\sin(\\theta)}\n$$\nThe problem asks for the magnitude of this perturbation. Taking the magnitude and using the triangle inequality:\n$$\n|\\Delta p| \\approx \\frac{|\\Delta d_0 p^2 + \\Delta d_1 p + \\Delta d_2|}{2r\\sin(\\theta)} \\le \\frac{|\\Delta d_0||p^2| + |\\Delta d_1||p| + |\\Delta d_2|}{2r\\sin(\\theta)}\n$$\nUsing $|p| = r$ and the uniform quantization error bound $|\\Delta d_k| \\le \\Delta/2$ for $k \\in \\{0, 1, 2\\}$:\n$$\n|\\Delta p| \\le \\frac{(\\Delta/2)r^2 + (\\Delta/2)r + (\\Delta/2)}{2r\\sin(\\theta)} = \\frac{(1+r+r^2)\\Delta}{4r\\sin(\\theta)}\n$$\nThis expression provides the first-order upper bound on the magnitude of the pole displacement due to coefficient quantization, as a function of $r$, $\\theta$, and $\\Delta$.\n\nNext, we derive an upper bound on the magnitude deviation from unity, $\\sup_{\\omega} \\left||\\widetilde{H}(\\exp(j\\omega))| - 1\\right|$.\nThe ideal filter is all-pass, so $|H(\\exp(j\\omega))|=1$ for all $\\omega \\in \\mathbb{R}$. This implies that for $z = \\exp(j\\omega)$, the magnitudes of the numerator and denominator are equal: $|N(z)| = |D(z)|$. The deviation of the perturbed filter's magnitude response from unity is $||\\widetilde{H}(z)| - 1|$. By the reverse triangle inequality, this deviation is bounded by the magnitude of the function's perturbation:\n$$\n||\\widetilde{H}(z)| - 1| = ||\\widetilde{H}(z)| - |H(z)|| \\le |\\widetilde{H}(z) - H(z)|\n$$\nThe perturbation in the transfer function is $\\Delta H(z) = \\widetilde{H}(z) - H(z)$:\n$$\n\\Delta H(z) = \\frac{N(z) + \\Delta N(z)}{D(z) + \\Delta D(z)} - \\frac{N(z)}{D(z)} = \\frac{D(z)\\Delta N(z) - N(z)\\Delta D(z)}{D(z)(D(z) + \\Delta D(z))}\n$$\nFor a first-order perturbation analysis, we assume the coefficient errors are small, which implies that $|\\Delta D(z)| \\ll |D(z)|$. Thus, in the denominator of the error term, we can approximate $D(z) + \\Delta D(z) \\approx D(z)$. This yields:\n$$\n\\Delta H(z) \\approx \\frac{D(z)\\Delta N(z) - N(z)\\Delta D(z)}{D(z)^2}\n$$\nTaking the magnitude and applying the triangle inequality:\n$$\n|\\Delta H(z)| \\le \\frac{|D(z)||\\Delta N(z)| + |N(z)||\\Delta D(z)|}{|D(z)|^2}\n$$\nOn the unit circle, $z=\\exp(j\\omega)$, we have $|N(z)|=|D(z)|$. The inequality simplifies to:\n$$\n|\\Delta H(z)| \\le \\frac{|D(z)|(|\\Delta N(z)| + |\\Delta D(z)|)}{|D(z)|^2} = \\frac{|\\Delta N(z)| + |\\Delta D(z)|}{|D(z)|}\n$$\nTo obtain a uniform upper bound, we must find the supremum of the right-hand side over all $\\omega$. This involves finding the maximum value of the numerator and the minimum value of the denominator.\nFor the numerator, for $z=\\exp(j\\omega)$:\n$$\n|\\Delta N(z)| = |\\Delta n_0 + \\Delta n_1 z^{-1} + \\Delta n_2 z^{-2}| \\le |\\Delta n_0| + |\\Delta n_1| + |\\Delta n_2| \\le \\frac{\\Delta}{2} + \\frac{\\Delta}{2} + \\frac{\\Delta}{2} = \\frac{3\\Delta}{2}\n$$\nSimilarly, $|\\Delta D(z)| \\le 3\\Delta/2$. The sum is bounded by $|\\Delta N(z)| + |\\Delta D(z)| \\le 3\\Delta$.\n\nFor the denominator $|D(z)|$, we must find its minimum value, $\\inf_{\\omega, \\theta} |D(\\exp(j\\omega))|$.\n$|D(\\exp(j\\omega))| = |(1-p\\exp(-j\\omega))(1-p^*\\exp(-j\\omega))| = |1-p\\exp(-j\\omega)| \\cdot |1-p^*\\exp(-j\\omega))|$.\nThe distance from the point 1 on the complex plane to a point on a circle of radius $r$ centered at the origin is minimized when the point lies on the real axis. By the reverse triangle inequality, $|1-z_0| \\ge |1|-|z_0|$. Thus, for any complex number $z_0$ with $|z_0|=r$, we have $|1-z_0| \\ge 1-r$.\nApplying this to both terms in our denominator:\n$|1-p\\exp(-j\\omega)| \\ge 1-|p| = 1-r$\n$|1-p^*\\exp(-j\\omega))| \\ge 1-|p^*| = 1-r$\nTherefore, a uniform lower bound for the denominator's magnitude is:\n$$\n|D(\\exp(j\\omega))| \\ge (1-r)^2 \\quad \\forall \\omega \\in \\mathbb{R}, \\theta \\in (0, \\pi)\n$$\nCombining the bounds for the numerator and denominator, we arrive at the uniform upper bound for the magnitude deviation:\n$$\n\\sup_{\\omega \\in \\mathbb{R}} \\left|\\,|\\widetilde{H}(\\exp(j\\omega))| - 1\\,\\right| \\le \\sup_{\\omega \\in \\mathbb{R}} |\\Delta H(\\exp(j\\omega))| \\le \\frac{3\\Delta}{(1-r)^2}\n$$\nThis expression provides the required analytic upper bound in terms of $r$ and $\\Delta$.", "answer": "$$ \\boxed{\\frac{3\\Delta}{(1-r)^2}} $$", "id": "2851748"}]}