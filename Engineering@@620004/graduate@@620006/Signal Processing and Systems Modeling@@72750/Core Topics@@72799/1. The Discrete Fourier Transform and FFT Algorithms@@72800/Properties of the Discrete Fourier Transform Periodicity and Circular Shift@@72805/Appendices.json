{"hands_on_practices": [{"introduction": "To build a robust understanding of the Discrete Fourier Transform (DFT), we begin with the simplest possible time-domain event: a single, instantaneous impulse. This foundational practice explores the DFT of a circularly shifted Kronecker delta function, $x[n]=\\delta[n-n_{0}]$. By deriving the result from first principles, you will directly observe how a pure delay in the time domain transforms into a linear phase progression across frequency bins, establishing the cornerstone of the circular shift property [@problem_id:2896576].", "problem": "Let $N \\in \\mathbb{Z}_{\\ge 2}$ and let $x[n]$ be an $N$-point discrete-time sequence defined on the index set $\\{0,1,\\dots,N-1\\}$ by $x[n]=\\delta[n-n_{0}]$ with an integer shift $n_{0}$ satisfying $0 \\le n_{0} < N$, where $\\delta[\\cdot]$ denotes the Kronecker delta. Consider the $N$-point discrete Fourier transform (DFT), defined for $k \\in \\{0,1,\\dots,N-1\\}$ by\n$$\nX[k] \\triangleq \\sum_{n=0}^{N-1} x[n] \\exp\\!\\left(-\\mathrm{j}\\,\\frac{2\\pi}{N}\\,kn\\right).\n$$\nAll angles are in radians.\n\nTasks:\n- Derive $X[k]$ starting only from the given DFT definition and the defining property of the Kronecker delta.\n- Using your derived $X[k]$, demonstrate analytically that the magnitude $|X[k]|$ is independent of $k$ and explain how this constancy across the uniformly spaced frequency samples $k \\mapsto \\frac{2\\pi}{N}k$ reflects both the periodicity in $k$ and the uniformity of DFT sampling when compared to the discrete-time Fourier transform (DTFT).\n- Define the scalar diagnostic\n$$\nQ(N,n_{0}) \\triangleq \\frac{1}{N}\\sum_{k=0}^{N-1} |X[k]|^{2}.\n$$\nCompute $Q(N,n_{0})$ in exact closed form. Report only the value of $Q(N,n_{0})$ as your final answer. No rounding is required and no units are involved.", "solution": "The problem as stated is well-posed and scientifically sound, permitting a rigorous derivation.\n\nThe first task is to derive the discrete Fourier transform (DFT), $X[k]$, for the given sequence $x[n]$. The $N$-point sequence is defined as $x[n] = \\delta[n-n_0]$ for $n \\in \\{0, 1, \\dots, N-1\\}$, where $\\delta[\\cdot]$ is the Kronecker delta and $n_0$ is an integer satisfying $0 \\le n_0  N$. The DFT is defined as:\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi}{N}\\,kn\\right)\n$$\nSubstituting the expression for $x[n]$ gives:\n$$\nX[k] = \\sum_{n=0}^{N-1} \\delta[n-n_0] \\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi}{N}\\,kn\\right)\n$$\nBy the sifting property of the Kronecker delta, the sum evaluates to the value of the function $\\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi}{N}\\,kn\\right)$ at the index where the argument of the delta function is zero, which is $n=n_0$. Since $n_0$ lies within the summation range $[0, N-1]$, the summation collapses to a single term:\n$$\nX[k] = \\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi}{N}\\,kn_0\\right)\n$$\nThis expression is valid for all $k \\in \\{0, 1, \\dots, N-1\\}$.\n\nThe second task is to analyze the magnitude $|X[k]|$ and its implications. The magnitude of a complex exponential $\\exp(\\mathrm{j}\\theta)$ is $1$ for any real argument $\\theta$. Here, the argument is $-\\frac{2\\pi}{N}kn_0$, which is a real number. Therefore, the magnitude of $X[k]$ is:\n$$\n|X[k]| = \\left|\\exp\\left(-\\mathrm{j}\\,\\frac{2\\pi}{N}\\,kn_0\\right)\\right| = 1\n$$\nThis result demonstrates that the magnitude $|X[k]|$ is equal to $1$ for all frequency indices $k$, meaning it is independent of $k$. This constancy reflects fundamental properties. The DFT $X[k]$ is inherently periodic in $k$ with period $N$, a property trivially satisfied by a constant function. Furthermore, the DFT provides uniformly spaced samples of the discrete-time Fourier transform (DTFT), $X(\\omega) = \\sum_{n=-\\infty}^{\\infty} x[n] \\exp(-\\mathrm{j}\\omega n)$. For $x[n]=\\delta[n-n_0]$, the DTFT is $X(\\omega) = \\exp(-\\mathrm{j}\\omega n_0)$, which has a constant magnitude $|X(\\omega)| = 1$ for all continuous frequencies $\\omega$. The DFT samples this continuous spectrum at $\\omega_k = \\frac{2\\pi}{N}k$. A flat, continuous spectrum, when sampled uniformly, necessarily yields a sequence of constant values. Thus, $|X[k]|=1$ is the expected outcome.\n\nThe third task is to compute the scalar diagnostic $Q(N, n_0)$, defined as:\n$$\nQ(N, n_0) \\triangleq \\frac{1}{N}\\sum_{k=0}^{N-1} |X[k]|^2\n$$\nUsing the result $|X[k]|=1$, we substitute this into the definition:\n$$\nQ(N, n_0) = \\frac{1}{N}\\sum_{k=0}^{N-1} (1)^2 = \\frac{1}{N}\\sum_{k=0}^{N-1} 1\n$$\nThe summation $\\sum_{k=0}^{N-1} 1$ contains $N$ terms, each with a value of $1$. The sum is therefore equal to $N$.\n$$\nQ(N, n_0) = \\frac{1}{N} \\cdot N = 1\n$$\nThis result is also a direct consequence of Parseval's theorem for the DFT, which states that $\\frac{1}{N}\\sum_{k=0}^{N-1} |X[k]|^2 = \\sum_{n=0}^{N-1} |x[n]|^2$. The left side is $Q(N, n_0)$. The right side is the energy of the signal:\n$$\n\\sum_{n=0}^{N-1} |x[n]|^2 = \\sum_{n=0}^{N-1} |\\delta[n-n_0]|^2 = \\sum_{n=0}^{N-1} \\delta[n-n_0] = 1\n$$\nBoth methods confirm that $Q(N, n_0)$ is exactly $1$. The final answer is this value.", "answer": "$$\\boxed{1}$$", "id": "2896576"}, {"introduction": "Theoretical knowledge of the circular shift property is essential, but its power is only realized through correct implementation. This exercise bridges theory and practice by presenting a realistic and common scenario: an off-by-one error in code resulting from confusion between 0-based and 1-based array indexing. Your task is to mathematically dissect this implementation bug, determine the actual shift it performs, and derive the resulting frequency-domain error, solidifying your ability to diagnose and debug signal processing algorithms [@problem_id:2896564].", "problem": "A team is modeling a circular time shift within the context of the Discrete Fourier Transform (DFT). Let an $N$-point discrete-time sequence be denoted by $x[n]$ with $n \\in \\{0,1,\\ldots,N-1\\}$, and let its Discrete Fourier Transform (DFT) be defined by\n$$\nX[k] \\triangleq \\sum_{n=0}^{N-1} x[n] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn\\right), \\quad k \\in \\{0,1,\\ldots,N-1\\}.\n$$\nA desired circular right shift by $n_{0}$ samples is specified in $0$-based indexing by\n$$\ny[n] \\triangleq x\\big((n - n_{0}) \\bmod N\\big).\n$$\nHowever, the implementation team uses $1$-based indexing $m \\in \\{1,2,\\ldots,N\\}$ for array access and informally “converts” the above rule into\n$$\ny_{\\mathrm{wrong}}[m] \\triangleq x\\Big(\\big((m - n_{0}) \\bmod N\\big) + 1\\Big),\n$$\nwhere the $\\bmod$ operator returns values in $\\{0,1,\\ldots,N-1\\}$, and the final $+1$ is intended to map to $1$-based array indices. They claim this realizes the same $n_{0}$-sample circular right shift.\n\n1. Using only the definitions of circular shift, DFT, and modulo arithmetic on the index set $\\{0,1,\\ldots,N-1\\}$, show that the rule above actually realizes a different circular shift when viewed back in $0$-based indexing, and write that realized shift explicitly as $y_{\\mathrm{wrong}}[n] = x\\big((n - \\tilde{n}_{0}) \\bmod N\\big)$ for some $\\tilde{n}_{0}$ expressed in terms of $n_{0}$.\n\n2. Let $Y[k]$ and $Y_{\\mathrm{wrong}}[k]$ denote the DFTs of $y[n]$ and $y_{\\mathrm{wrong}}[n]$, respectively, computed with the same DFT definition as $X[k]$. Derive, from first principles, the exact multiplicative discrepancy factor\n$$\nR(k) \\triangleq \\frac{Y_{\\mathrm{wrong}}[k]}{Y[k]}\n$$\nin closed form as a symbolic expression in $k$ and $N$ only, independent of the particular $x[n]$.\n\nTo make the off-by-one effect concrete, consider the specific indices $N=7$, $n_{0}=4$, and $m=1$. Under the team’s rule, evaluate the source index inside $x(\\cdot)$, and compare it to the correctly converted $1$-based rule $y[m] = x\\big(((m-1 - n_{0}) \\bmod N) + 1\\big)$; use this as part of your reasoning to justify the corrected modulo arithmetic. Your final answer must be the expression for $R(k)$ only. No rounding is required.", "solution": "The problem statement has been validated and is deemed to be scientifically and mathematically sound, well-posed, and complete. It presents a standard, albeit subtle, problem in digital signal processing concerning the implementation of the circular shift property of the Discrete Fourier Transform (DFT), focusing on the common pitfall of off-by-one errors arising from mixed indexing conventions. We will now proceed with a formal derivation.\n\nThe analysis is divided into two primary parts as requested. First, we will determine the actual circular shift implemented by the incorrect rule. Second, we will derive the multiplicative discrepancy factor in the frequency domain.\n\nLet us establish the relationship between the $0$-based signal index $n \\in \\{0, 1, \\ldots, N-1\\}$ and the $1$-based array index $m \\in \\{1, 2, \\ldots, N\\}$. This is a simple offset: $n = m - 1$, or conversely, $m = n + 1$.\n\nThe correct circular shift of a sequence $x[n]$ by $n_0$ samples is defined as $y[n] \\triangleq x \\big( (n - n_{0}) \\bmod N \\big)$.\n\nThe implementation team uses an incorrect rule based on the $1$-based index $m$:\n$$\ny_{\\mathrm{wrong}}[m] \\triangleq x\\Big(\\big((m - n_{0}) \\bmod N\\big) + 1\\Big)\n$$\nThe problem states that the final \"$+1$\" is intended to map to $1$-based array indices. This implies that the entire argument of $x(\\cdot)$ is a $1$-based index. The original sequence $x[n]$ is $0$-indexed. Therefore, to find the value from the signal $x[n]$, we must convert the $1$-based index to a $0$-based index by subtracting $1$. The $0$-based source index is $\\left[ \\big((m - n_{0}) \\bmod N\\big) + 1 \\right] - 1 = (m - n_{0}) \\bmod N$.\n\nThe value of the $m$-th sample of the incorrectly shifted sequence is thus $x\\left[(m - n_{0}) \\bmod N\\right]$. To express this as a $0$-indexed sequence $y_{\\mathrm{wrong}}[n]$, we substitute $m = n + 1$, where $n$ is the $0$-based index corresponding to the $m$-th position.\n$$\ny_{\\mathrm{wrong}}[n] \\triangleq x\\Big( \\big((n+1) - n_{0}\\big) \\bmod N \\Big) = x\\Big( \\big(n - (n_{0}-1)\\big) \\bmod N \\Big)\n$$\nThis expression is of the form $x\\big((n - \\tilde{n}_{0}) \\bmod N\\big)$, where the effective shift is $\\tilde{n}_{0} \\triangleq n_{0} - 1$. The implemented rule creates a circular shift by $n_{0}-1$, not $n_{0}$. This is a different shift, as $n_{0}-1 \\neq n_{0}$.\n\nTo illustrate this fundamental error with the provided example ($N=7$, $n_{0}=4$, $m=1$):\nThe correctly converted $1$-based rule is $y[m] = x\\big(((m-1 - n_{0}) \\bmod N) + 1\\big)$. For $m=1$, this gives the source index inside $x(\\cdot)$ as $\\big(((1-1 - 4) \\bmod 7) + 1\\big) = \\big((-4 \\bmod 7) + 1\\big) = 3 + 1 = 4$. This corresponds to the value $x[3]$. This is consistent with the $0$-based definition for $n=0$: $y[0] = x((0-4)\\bmod 7) = x[3]$.\n\nThe team's incorrect rule is $y_{\\mathrm{wrong}}[m] = x\\Big(\\big((m - n_{0}) \\bmod N\\big) + 1\\Big)$. For $m=1$, this gives the source index inside $x(\\cdot)$ as $\\big((1 - 4) \\bmod 7\\big) + 1 = \\big(-3 \\bmod 7\\big) + 1 = 4 + 1 = 5$. This corresponds to the value $x[4]$.\nOur derived formula for the effective shift $\\tilde{n}_{0} = n_{0}-1 = 4-1 = 3$ predicts this. For $n=0$: $y_{\\mathrm{wrong}}[0] = x((0-3)\\bmod 7) = x[4]$. The concrete example confirms our analysis. The intended shift was by $4$ samples; the implemented shift is by $3$ samples.\n\nNow, we derive the discrepancy factor $R(k) \\triangleq \\frac{Y_{\\mathrm{wrong}}[k]}{Y[k]}$. We must derive the DFTs $Y[k]$ and $Y_{\\mathrm{wrong}}[k]$ from first principles.\n\nThe DFT of the correctly shifted sequence $y[n] = x\\big((n-n_{0}) \\bmod N\\big)$ is:\n$$\nY[k] \\triangleq \\sum_{n=0}^{N-1} y[n] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn\\right) = \\sum_{n=0}^{N-1} x\\big((n-n_{0}) \\bmod N\\big) \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn\\right)\n$$\nLet $p = (n-n_{0}) \\bmod N$. This implies $n = (p+n_{0}) \\bmod N$. As $n$ traverses the set $\\{0, 1, \\ldots, N-1\\}$, so does $p$. We can change the summation variable:\n$$\nY[k] = \\sum_{p=0}^{N-1} x[p] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}k(p+n_{0})\\right)\n$$\nThe term $\\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}k(p+n_{0})\\right)$ can be separated:\n$$\nY[k] = \\sum_{p=0}^{N-1} x[p] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kp\\right) \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn_{0}\\right)\n$$\nThe term $\\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn_{0}\\right)$ is constant with respect to the summation variable $p$.\n$$\nY[k] = \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn_{0}\\right) \\sum_{p=0}^{N-1} x[p] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kp\\right) = X[k] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn_{0}\\right)\n$$\n\nThe DFT of the incorrectly shifted sequence $y_{\\mathrm{wrong}}[n] = x\\big((n-(n_{0}-1)) \\bmod N\\big)$ is found through identical reasoning:\n$$\nY_{\\mathrm{wrong}}[k] \\triangleq \\sum_{n=0}^{N-1} y_{\\mathrm{wrong}}[n] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn\\right) = \\sum_{n=0}^{N-1} x\\big((n-(n_{0}-1)) \\bmod N\\big) \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn\\right)\n$$\nLet $q = (n-(n_{0}-1)) \\bmod N$. Then $n = (q+n_{0}-1) \\bmod N$. Change of variable yields:\n$$\nY_{\\mathrm{wrong}}[k] = \\sum_{q=0}^{N-1} x[q] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}k(q+n_{0}-1)\\right)\n$$\n$$\nY_{\\mathrm{wrong}}[k] = \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}k(n_{0}-1)\\right) \\sum_{q=0}^{N-1} x[q] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kq\\right) = X[k] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}k(n_{0}-1)\\right)\n$$\n\nFinally, we compute the ratio $R(k)$, assuming $X[k] \\neq 0$. The problem asks for a factor independent of $x[n]$, justifying this cancellation.\n$$\nR(k) = \\frac{Y_{\\mathrm{wrong}}[k]}{Y[k]} = \\frac{X[k] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}k(n_{0}-1)\\right)}{X[k] \\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn_{0}\\right)}\n$$\n$$\nR(k) = \\frac{\\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn_{0}\\right) \\exp\\!\\left(\\mathrm{j}\\frac{2\\pi}{N}k\\right)}{\\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi}{N}kn_{0}\\right)} = \\exp\\!\\left(\\mathrm{j}\\frac{2\\pi}{N}k\\right)\n$$\nThis is the required multiplicative discrepancy factor, expressed in closed form and independent of $x[n]$ and $n_0$. It represents a frequency-dependent phase error whose magnitude is a rotation by $k$ increments of $\\frac{2\\pi}{N}$ radians in the complex plane. This is equivalent to a circular shift by $-1$ sample in the time domain, which is precisely the error in the shift amount ($n_0-1$ instead of $n_0$).", "answer": "$$\n\\boxed{\\exp\\left(\\mathrm{j}\\frac{2\\pi k}{N}\\right)}\n$$", "id": "2896564"}, {"introduction": "Moving from theory to application, a common engineering task is to estimate an unknown time shift between a received signal and a known template. This advanced practice challenges you to think critically about the limitations of using the DFT's phase to estimate a shift. By analyzing a specific signal with spectral zeros, you will confront the practical issues of phase ambiguity, the impact of measurement noise, and the relative merits of different estimation strategies, including a powerful connection to weighted least-squares estimation [@problem_id:2896545].", "problem": "Consider a length-$N$ real sequence $x[n]$ with $N \\in \\mathbb{Z}_{0}$, and its length-$N$ Discrete Fourier Transform (DFT) $X[k]$, where Discrete Fourier Transform (DFT) is defined in the usual way and $n \\in \\{0,1,\\dots,N-1\\}$, $k \\in \\{0,1,\\dots,N-1\\}$. Let $y[n]$ be a circular shift of $x[n]$ by an unknown integer $n_{0} \\in \\{0,1,\\dots,N-1\\}$, i.e., $y[n] = x[(n - n_{0}) \\bmod N]$, and let $Y[k]$ denote the DFT of $y[n]$. In this problem, you will reason from first principles about DFT periodicity and the circular-shift property to understand how zeros in $X[k]$ affect phase and how to estimate $n_{0}$ using only bins with nonzero magnitude.\n\nWork with the specific example $N = 12$ and\n$x[n] = 2 \\cos\\!\\big(2\\pi \\cdot 3 \\, n / 12\\big)$ for $n \\in \\{0,1,\\dots,11\\}$.\nDefine $y[n] = x[(n - n_{0}) \\bmod 12]$ for an unknown integer shift $n_{0} \\in \\{0,1,\\dots,11\\}$. For general considerations about spectral estimation in the presence of noise, assume that any measured DFT coefficients may be corrupted by small independent circularly symmetric complex Gaussian perturbations, and that the Signal-to-Noise Ratio (SNR) is sufficiently high so that phase perturbations are small.\n\nSelect all statements that are correct for this setup.\n\nA. In this example, $X[k]$ is exactly zero for all $k \\notin \\{3,9\\}$; therefore the phase $\\arg X[k]$ is undefined at those bins. After any circular shift by $n_{0}$, the same bins remain exactly zero in $Y[k]$, and $\\arg Y[k]$ is undefined there as well.\n\nB. Using only the two nonzero spectral bins $k = 3$ and $k = 9$, and without any prior knowledge of the unshifted phases $\\arg X[3]$ and $\\arg X[9]$, one cannot uniquely identify $n_{0}$ from phase information alone; at best, a phase-difference method determines $n_{0}$ modulo $N / \\gcd(\\Delta k, N)$ with $\\Delta k = |9 - 3|$. For this example, this resolves only the parity of $n_{0}$.\n\nC. A consistent strategy that uses only bins with nonzero magnitude is to unwrap $\\arg Y[k]$ over those bins and solve an unweighted least-squares fit of a line in $k$. This line-fit estimator is unbiased for arbitrary $x[n]$ and any support pattern of nonzero spectral bins.\n\nD. In the high-SNR regime where phase noise at bin $k$ is approximately zero-mean with variance inversely proportional to $\\lvert Y[k]\\rvert^{2}$, a weighted least-squares fit of unwrapped $\\arg Y[k]$ versus $k$ over the set of indices with $\\lvert Y[k]\\rvert$ above a threshold, using weights proportional to $\\lvert Y[k]\\rvert^{2}$, provides an approximation to the maximum-likelihood estimate of $n_{0}$.\n\nE. If a perfectly known time-domain template $x[n]$ is available, the circular cross-correlation between $y[n]$ and $x[n]$ has a unique global maximum at $n = n_{0}$ for any nonzero $x[n]$, regardless of the spectral zeros of $X[k]$.\n\nYour task is to decide which options are correct. Your reasoning should begin from the DFT definition and the circular-shift property and must explicitly address the role of spectral zeros, DFT periodicity in $k$, and phase wrapping. Do not assume any unstated formulas beyond these fundamentals.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It is based on established principles of digital signal processing, specifically the Discrete Fourier Transform (DFT). All provided information is self-contained and consistent. Therefore, the problem is valid, and I will proceed with a full solution.\n\nHere are the first principles that will be used for the derivation:\n1.  The length-$N$ DFT of a sequence $x[n]$ is defined as $X[k] = \\sum_{n=0}^{N-1} x[n] e^{-\\mathrm{j} 2\\pi nk/N}$.\n2.  The circular shift property states that if $y[n] = x[(n-n_0) \\bmod N]$, its DFT is $Y[k] = X[k] e^{-\\mathrm{j} 2\\pi k n_0/N}$.\n3.  For a real-valued sequence $x[n]$, its DFT exhibits conjugate symmetry: $X[k] = X^*[(N-k)\\bmod N]$ for $k \\in \\{1, \\dots, N-1\\}$, and $X[0]$ and $X[N/2]$ (for even $N$) are real. This implies $|X[k]| = |X[N-k]|$ and $\\arg X[k] = -\\arg X[N-k]$.\n\nFirst, let's analyze the given signal $x[n]$ with $N=12$ and $x[n] = 2 \\cos(2\\pi \\cdot 3 n / 12)$.\nUsing Euler's identity, $2 \\cos(\\theta) = e^{\\mathrm{j}\\theta} + e^{-\\mathrm{j}\\theta}$, we can write $x[n]$ as:\n$$ x[n] = e^{\\mathrm{j} 2\\pi \\frac{3n}{12}} + e^{-\\mathrm{j} 2\\pi \\frac{3n}{12}} $$\nSince the DFT is a linear operator, we can compute the DFT of each term. The DFT of a complex sinusoid $e^{\\mathrm{j} 2\\pi k_0 n/N}$ is a scaled and shifted discrete delta function, specifically $\\sum_{n=0}^{N-1} e^{\\mathrm{j} 2\\pi k_0 n/N} e^{-\\mathrm{j} 2\\pi k n/N} = \\sum_{n=0}^{N-1} e^{\\mathrm{j} 2\\pi (k_0-k)n/N} = N\\delta[(k_0-k) \\bmod N]$.\nFor the first term, $k_0 = 3$. The DFT is $12\\delta[(3-k) \\bmod 12]$, which is $12$ at $k=3$ and $0$ otherwise.\nFor the second term, we can write $e^{-\\mathrm{j} 2\\pi \\frac{3n}{12}}$ as $e^{\\mathrm{j} 2\\pi \\frac{(12-3)n}{12}} = e^{\\mathrm{j} 2\\pi \\frac{9n}{12}}$. Here, $k_0 = 9$. The DFT is $12\\delta[(9-k)\\bmod 12]$, which is $12$ at $k=9$ and $0$ otherwise.\nTherefore, the DFT of $x[n]$ is:\n$$ X[k] = \\begin{cases} 12  \\text{if } k=3 \\\\ 12  \\text{if } k=9 \\\\ 0  \\text{for } k \\in \\{0,1,2,4,5,6,7,8,10,11\\} \\end{cases} $$\nThe spectrum $X[k]$ has non-zero values only at $k=3$ and $k=9$. Since these values are real and positive, their phase is $\\arg X[3] = 0$ and $\\arg X[9] = 0$.\n\nFor the shifted sequence $y[n] = x[(n-n_0) \\bmod 12]$, its DFT is $Y[k] = X[k]e^{-\\mathrm{j} 2\\pi k n_0 / 12}$.\nThe magnitudes are $|Y[k]| = |X[k]|$. So, $Y[k]$ is also zero for all $k \\notin \\{3, 9\\}$.\nAt the non-zero frequencies:\n$$ Y[3] = 12 e^{-\\mathrm{j} 2\\pi \\cdot 3 n_0 / 12} = 12 e^{-\\mathrm{j} \\pi n_0 / 2} $$\n$$ Y[9] = 12 e^{-\\mathrm{j} 2\\pi \\cdot 9 n_0 / 12} = 12 e^{-\\mathrm{j} 3\\pi n_0 / 2} $$\nThe phases are $\\arg Y[3] = -\\pi n_0 / 2 \\pmod{2\\pi}$ and $\\arg Y[9] = -3\\pi n_0 / 2 \\pmod{2\\pi}$.\n\nNow we shall evaluate each statement.\n\n**A. In this example, $X[k]$ is exactly zero for all $k \\notin \\{3,9\\}$; therefore the phase $\\arg X[k]$ is undefined at those bins. After any circular shift by $n_{0}$, the same bins remain exactly zero in $Y[k]$, and $\\arg Y[k]$ is undefined there as well.**\n\nOur derivation shows that $X[k]$ is indeed zero for all $k$ except $k=3$ and $k=9$. The complex number $z=0$ can be written as $0 \\cdot e^{j\\theta}$ for any angle $\\theta$, so its phase is multivalued, i.e., undefined.\nThe DFT of the shifted sequence is $Y[k] = X[k] e^{-\\mathrm{j} 2\\pi k n_0/N}$. If $X[k]=0$ for some $k$, then $Y[k] = 0 \\cdot e^{-\\mathrm{j} 2\\pi k n_0/N} = 0$. Thus, $Y[k]$ has the same zero-valued bins as $X[k]$. Consequently, the phase $\\arg Y[k]$ is also undefined at these bins. The statement is a direct and correct consequence of the DFT properties.\nVerdict: **Correct**.\n\n**B. Using only the two nonzero spectral bins $k = 3$ and $k = 9$, and without any prior knowledge of the unshifted phases $\\arg X[3]$ and $\\arg X[9]$, one cannot uniquely identify $n_{0}$ from phase information alone; at best, a phase-difference method determines $n_{0}$ modulo $N / \\gcd(\\Delta k, N)$ with $\\Delta k = |9 - 3|$. For this example, this resolves only the parity of $n_{0}$.**\n\nThe premise is that we do not know the initial phases $\\phi_X(k) = \\arg X[k]$, only that $x[n]$ is real, which implies $\\phi_X(9) = -\\phi_X(3) \\pmod{2\\pi}$.\nWe observe phases $\\phi_Y(3)$ and $\\phi_Y(9)$.\nLet a candidate solution be a shift $n_0$ and an initial phase $\\phi_X(3)$. This must be consistent with the observations:\n$\\phi_Y(3) = \\phi_X(3) - 2\\pi \\cdot 3 n_0/12 \\pmod{2\\pi}$.\n$\\phi_Y(9) = -\\phi_X(3) - 2\\pi \\cdot 9 n_0/12 \\pmod{2\\pi}$.\nConsider an alternative shift $n_0' = n_0 + \\Delta n_0$. Can this also explain the observations, but with a different initial phase $\\phi_X'(3)$?\n$\\phi_Y(3) = \\phi_X'(3) - 2\\pi \\cdot 3 (n_0+\\Delta n_0)/12 \\pmod{2\\pi}$.\nComparing the two expressions for $\\phi_Y(3)$, we must have: $\\phi_X'(3) = \\phi_X(3) + 2\\pi \\cdot 3 \\Delta n_0/12 \\pmod{2\\pi}$.\nFor this new initial phase profile to be valid for a real signal, we must have $\\phi_X'(9) = -\\phi_X'(3)$. Let's check. The second observation gives:\n$\\phi_Y(9) = \\phi_X'(9) - 2\\pi \\cdot 9 (n_0+\\Delta n_0)/12 \\pmod{2\\pi}$, so $\\phi_X'(9) = \\phi_Y(9) + 2\\pi \\cdot 9 (n_0+\\Delta n_0)/12$.\n$\\phi_Y(9) = -\\phi_X(3) - 2\\pi \\cdot 9 n_0/12$.\n$\\phi_X'(9) = -\\phi_X(3) - 2\\pi \\cdot 9 n_0/12 + 2\\pi \\cdot 9 (n_0+\\Delta n_0)/12 = -\\phi_X(3) + 2\\pi \\cdot 9 \\Delta n_0/12$.\nThe condition $\\phi_X'(9) = -\\phi_X'(3)$ becomes:\n$-\\phi_X(3) + \\frac{18\\pi \\Delta n_0}{12} \\equiv -(\\phi_X(3) + \\frac{6\\pi \\Delta n_0}{12}) \\pmod{2\\pi}$\n$-\\phi_X(3) + \\frac{3\\pi \\Delta n_0}{2} \\equiv -\\phi_X(3) - \\frac{\\pi \\Delta n_0}{2} \\pmod{2\\pi}$\n$\\frac{4\\pi \\Delta n_0}{2} \\equiv 0 \\pmod{2\\pi} \\implies 2\\pi \\Delta n_0 \\equiv 0 \\pmod{2\\pi}$. This is true for any integer $\\Delta n_0$. My previous analysis that led to total ambiguity stands if we allow $\\phi'_X(3)$ to be anything. However, the standard phase-difference method ambiguity is what is referenced.\n\nLet's analyze the ambiguity from the phase difference measurement $\\Delta\\phi_Y = \\phi_Y(k_2) - \\phi_Y(k_1)$.\n$\\Delta\\phi_Y = \\Delta\\phi_X - \\frac{2\\pi n_0 \\Delta k}{N}$. Since we can only measure phase modulo $2\\pi$, we effectively determine $\\frac{n_0 \\Delta k}{N}$ modulo $1$. This means $\\frac{(n_0'-n_0)\\Delta k}{N}$ must be an integer, say $m$.\nThis implies $\\Delta n_0 = n_0'-n_0$ is a multiple of $\\frac{N}{\\Delta k/ \\gcd(\\Delta k, N)} = \\frac{N \\gcd(\\Delta k, N)}{\\Delta k}$. This is not right.\nThe condition is $\\frac{\\Delta k \\cdot \\Delta n_0}{N} \\in \\mathbb{Z}$. Writing $\\Delta k = g \\cdot a$ and $N=g \\cdot b$ where $g = \\gcd(\\Delta k, N)$, the condition is $\\frac{g \\cdot a \\cdot \\Delta n_0}{g \\cdot b} = \\frac{a \\cdot \\Delta n_0}{b} \\in \\mathbb{Z}$. Since $\\gcd(a,b)=1$, this implies $b | \\Delta n_0$. The smallest integer ambiguity is $\\Delta n_0 = b = N/g = N/\\gcd(\\Delta k, N)$.\nFor this problem, $N=12$ and $\\Delta k = |9-3|=6$.\nThe ambiguity is $\\Delta n_0 = 12/\\gcd(6,12) = 12/6 = 2$.\nSo, $n_0$ can only be determined modulo $2$. This means we can only determine if $n_0$ is even or odd (its parity). Thus, the statement is correct.\nVerdict: **Correct**.\n\n**C. A consistent strategy that uses only bins with nonzero magnitude is to unwrap $\\arg Y[k]$ over those bins and solve an unweighted least-squares fit of a line in $k$. This line-fit estimator is unbiased for arbitrary $x[n]$ and any support pattern of nonzero spectral bins.**\n\nThe unwrapped phase of the shifted signal is $\\phi_Y(k) = \\phi_X(k) - \\frac{2\\pi n_0}{N}k$. The strategy is to fit a line $\\hat{\\phi}(k) = c + s \\cdot k$ to the points $(k, \\phi_Y(k))$ for $k$ in the support set. The slope $s$ is an estimator for $-\\frac{2\\pi n_0}{N}$.\nAn estimator is unbiased if its expected value equals the true parameter value. The expected value of the least-squares slope estimate depends on the true function being fitted. Here, the true \"function\" is $\\phi_Y(k)$.\n$E[\\hat{s}] = \\text{slope of best linear fit to } \\phi_Y(k)$.\n$E[\\hat{s}] = \\text{slope of best linear fit to } (\\phi_X(k) - \\frac{2\\pi n_0}{N}k) = (\\text{slope of } \\phi_X(k)) - \\frac{2\\pi n_0}{N}$.\nThe resulting estimate for $n_0$ is $\\hat{n}_0 = -\\frac{N}{2\\pi}\\hat{s}$. Its expected value is $E[\\hat{n}_0] = -\\frac{N}{2\\pi}E[\\hat{s}] = n_0 - \\frac{N}{2\\pi}(\\text{slope of } \\phi_X(k))$.\nThe estimator is unbiased if and only if the slope of the best linear fit to the initial phase spectrum $\\phi_X(k)$ over the support set is zero. For an \"arbitrary $x[n]$\", the phase spectrum $\\phi_X(k)$ is not guaranteed to be constant or have a zero linear trend. For instance, if $x[n]$ is itself a shifted signal, e.g., $x[n]=\\delta[n-1]$, its phase spectrum $\\phi_X(k) = -2\\pi k/N$ is a line. The estimator would then be biased by this inherent slope. Thus, the statement that the estimator is unbiased for arbitrary $x[n]$ is false.\nVerdict: **Incorrect**.\n\n**D. In the high-SNR regime where phase noise at bin $k$ is approximately zero-mean with variance inversely proportional to $\\lvert Y[k]\\rvert^{2}$, a weighted least-squares fit of unwrapped $\\arg Y[k]$ versus $k$ over the set of indices with $\\lvert Y[k]\\rvert$ above a threshold, using weights proportional to $\\lvert Y[k]\\rvert^{2}$, provides an approximation to the maximum-likelihood estimate of $n_{0}$.**\n\nIn the presence of additive circularly symmetric complex Gaussian noise $W[k]$ on the DFT, the measured DFT is $\\tilde{Y}[k] = Y[k]+W[k]$. For high SNR, $|Y[k]| \\gg |W[k]|$, the phase of $\\tilde{Y}[k]$ is approximately $\\phi_Y(k) + \\frac{\\text{Im}(W[k]e^{-\\mathrm{j}\\phi_Y(k)})}{|Y[k]|}$. This phase noise is approximately Gaussian, zero-mean, and its variance is $\\text{Var}(\\Delta\\phi_k) \\approx \\frac{\\text{Var}(\\text{noise component})}{|Y[k]|^2}$. So, the premise that the phase noise variance is inversely proportional to $|Y[k]|^2$ is correct.\nWe want to estimate $n_0$ from the model $\\phi_Y(k) = \\phi_X(k) - \\frac{2\\pi n_0}{N}k + \\text{noise}_k$. This is a linear regression problem. If the noise is Gaussian and independent across bins $k$, the maximum-likelihood estimator (MLE) minimizes the sum of squared, weighted residuals: $\\sum_k w_k (\\text{observation}_k - \\text{model}_k)^2$. The optimal weights $w_k$ are the inverse of the noise variance at each bin, $w_k = 1/\\sigma_k^2$.\nGiven $\\sigma_k^2 \\propto 1/|Y[k]|^2$, the optimal weights are $w_k \\propto |Y[k]|^2$. The procedure described — a weighted least-squares fit with weights proportional to $|Y[k]|^2$ — is indeed the MLE under these assumptions. It's called an \"approximation\" because the noise model is itself an approximation for high SNR, and because fitting a simple line models $\\phi_X(k)$ as a constant, which may not be true. The thresholding is a practical step to ensure the high-SNR assumption holds. The statement is a correct description of a robust statistical estimation procedure.\nVerdict: **Correct**.\n\n**E. If a perfectly known time-domain template $x[n]$ is available, the circular cross-correlation between $y[n]$ and $x[n]$ has a unique global maximum at $n = n_{0}$ for any nonzero $x[n]$, regardless of the spectral zeros of $X[k]$.**\n\nThe circular cross-correlation is $r_{yx}[m] = \\sum_{n=0}^{N-1} y[n] x^*[(n-m)\\bmod N]$. Using the correlation theorem, its DFT is $R_{yx}[k] = Y[k]X^*[k]$.\nSubstituting $Y[k] = X[k]e^{-\\mathrm{j} 2\\pi k n_0/N}$, we get $R_{yx}[k] = |X[k]|^2 e^{-\\mathrm{j} 2\\pi k n_0/N}$.\nThe inverse DFT gives $r_{yx}[m]$. Let $p[m] = \\text{IDFT}\\{|X[k]|^2\\}$. This $p[m]$ is the circular autocorrelation of $x[n]$. From the shift property, $r_{yx}[m] = p[(m-n_0)\\bmod N]$.\nThe autocorrelation $p[m]$ achieves its maximum value at $m=0$, as per the Cauchy-Schwarz inequality: $|p[m]| \\le p[0]$. Therefore, $r_{yx}[m]$ achieves its maximum value when $(m-n_0)\\bmod N = 0$, i.e., at $m=n_0$.\nThe question is whether this maximum is unique. The equality $|p[m]| = p[0]$ holds if and only if the sequence $x[(n-m)\\bmod N]$ is a scalar multiple of $x[n]$. If $x[n]$ is periodic with a period $P$ that divides $N$, then $x[n] = x[(n-P)\\bmod N]$ for all $n$. In this case, $p[P] = p[0]$, and the maximum of the autocorrelation is not unique. Consequently, the maximum of the cross-correlation $r_{yx}[m]$ will occur at $m=n_0, (n_0+P)\\bmod N$, etc., and will not be unique.\nThe specific signal in this problem, $x[n] = 2\\cos(\\pi n/2)$, is periodic with period $P=4$. Since $N=12$ is a multiple of $4$, its autocorrelation function will have identical maxima at lags $m=0, 4, 8$. The cross-correlation will therefore not have a unique maximum. The statement \"for any nonzero $x[n]$\" is thus false. A counterexample is the very signal provided in the problem setup.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{ABD}$$", "id": "2896545"}]}