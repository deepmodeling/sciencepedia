{"hands_on_practices": [{"introduction": "A single algebraic expression for a Z-transform, such as $X(z)$, can represent multiple distinct time-domain sequences. The key to disambiguating them lies in specifying the Region of Convergence (ROC). This foundational exercise will guide you through deriving all possible sequences corresponding to a given rational transform, reinforcing the direct link between the ROC's structure and the sidedness (right-sided, left-sided, or two-sided) of the time-domain signal [@problem_id:2906629].", "problem": "Consider the bilateral discrete-time $z$-transform $X(z)$ of an unknown sequence $x[n]$, where\n$$\nX(z) \\;=\\; \\frac{z}{\\left(z - 0.5\\right)\\left(z - 2\\right)}.\n$$\nStarting from the definition of the bilateral $z$-transform and the geometric-series expansion, determine all admissible Regions of Convergence (ROC) for $X(z)$, and for each ROC compute the inverse $z$-transform $x[n]$ by expressing $X(z)$ as a sum of first-order terms and expanding them appropriately. For each ROC, identify whether $x[n]$ is right-sided, left-sided, or two-sided, and justify your classification from first principles. In your reasoning, explicitly invoke only core definitions and the geometric-series identity, without assuming transform pairs as given facts.\n\nLet $u[n]$ denote the unit-step sequence defined by $u[n] = 1$ for $n \\ge 0$ and $u[n] = 0$ for $n  0$. Your final answer must consist solely of the three closed-form expressions for $x[n]$ corresponding to the three admissible ROC cases, ordered as follows: \n- first entry for $|z| > 2$, \n- second entry for $0.5  |z|  2$, \n- third entry for $|z|  0.5$.\n\nExpress the three results together as a single row matrix using the $\\mathrm{pmatrix}$ environment, exactly in that order. No numerical approximation or rounding is required.", "solution": "The problem is scientifically grounded, well-posed, and based on the established principles of discrete-time signal processing. It is a canonical exercise in the theory of the $z$-transform. We will proceed with a full, reasoned solution.\n\nThe bilateral $z$-transform of a discrete-time sequence $x[n]$ is defined by the Laurent series:\n$$X(z) = \\sum_{n=-\\infty}^{\\infty} x[n] z^{-n}$$\nThe set of all values of $z$ for which this summation converges is called the Region of Convergence (ROC). The given transform is:\n$$X(z) = \\frac{z}{(z - 0.5)(z - 2)}$$\nThe poles of $X(z)$ are the roots of the denominator, which are $z_1 = 0.5$ and $z_2 = 2$. The ROC is an annular region in the complex plane bounded by circles whose radii are given by the magnitudes of the poles. The ROC cannot contain any poles. Therefore, the two poles at $|z|=0.5$ and $|z|=2$ define three possible ROCs:\n1. An exterior region: $|z|  2$.\n2. An annular region: $0.5  |z|  2$.\n3. An interior region: $|z|  0.5$. Note that since the $z$-transform is a Laurent series, the ROC technically cannot include $z=0$ unless $x[n]$ is nonzero only for $n \\ge 0$ and the transform has no poles, which is not the case here. We interpret this ROC as $0  |z|  0.5$.\n\nTo find the inverse transform for each case, we first perform a partial-fraction expansion of $X(z)$. It is standard practice to expand $X(z)/z$:\n$$\\frac{X(z)}{z} = \\frac{1}{(z - 0.5)(z - 2)} = \\frac{A}{z - 0.5} + \\frac{B}{z - 2}$$\nThe coefficients $A$ and $B$ are found using the residue method:\n$$A = \\lim_{z \\to 0.5} (z - 0.5) \\frac{1}{(z - 0.5)(z - 2)} = \\frac{1}{0.5 - 2} = \\frac{1}{-1.5} = -\\frac{2}{3}$$\n$$B = \\lim_{z \\to 2} (z - 2) \\frac{1}{(z - 0.5)(z - 2)} = \\frac{1}{2 - 0.5} = \\frac{1}{1.5} = \\frac{2}{3}$$\nMultiplying by $z$ gives the expansion for $X(z)$:\n$$X(z) = -\\frac{2}{3} \\frac{z}{z - 0.5} + \\frac{2}{3} \\frac{z}{z - 2}$$\nTo facilitate the use of the geometric series identity, we rewrite each term as a function of $z^{-1}$:\n$$X(z) = -\\frac{2}{3} \\frac{1}{1 - 0.5z^{-1}} + \\frac{2}{3} \\frac{1}{1 - 2z^{-1}}$$\nLet $X_1(z) = -\\frac{2}{3} \\frac{1}{1 - 0.5z^{-1}}$ and $X_2(z) = \\frac{2}{3} \\frac{1}{1 - 2z^{-1}}$.\n\nThe inversion process relies on the two expansions of the geometric series, which lead to two distinct inverse transforms for a first-order term $\\frac{1}{1-az^{-1}}$.\n1.  **Right-Sided Sequence**: Using the identity $\\sum_{n=0}^{\\infty} r^n = \\frac{1}{1-r}$ for $|r|1$. Let $r=az^{-1}$. Convergence requires $|az^{-1}|  1$, or $|z|  |a|$.\n    $$ \\frac{1}{1-az^{-1}} = \\sum_{n=0}^{\\infty} (az^{-1})^n = \\sum_{n=0}^{\\infty} a^n z^{-n} $$\n    By comparing this to the $z$-transform definition, we identify the corresponding sequence as $a^n u[n]$.\n2.  **Left-Sided Sequence**: For the case $|z|  |a|$, we rewrite the term:\n    $$ \\frac{1}{1-az^{-1}} = \\frac{-1}{az^{-1}-1} = \\frac{-1}{az^{-1}(1-a^{-1}z)} = -a^{-1}z \\frac{1}{1-a^{-1}z} $$\n    Since $|a^{-1}z|  1$, we can expand the fraction as a geometric series.\n    $$ -a^{-1}z \\sum_{k=0}^{\\infty} (a^{-1}z)^k = -\\sum_{k=0}^{\\infty} a^{-k-1} z^{k+1} $$\n    Let $n = -(k+1)$. As $k$ ranges from $0$ to $\\infty$, $n$ ranges from $-1$ to $-\\infty$.\n    $$ -\\sum_{n=-1}^{-\\infty} a^{n} z^{-n} = \\sum_{n=-\\infty}^{-1} (-a^n) z^{-n} $$\n    The corresponding sequence is $-a^n u[-n-1]$.\n\nWe now apply these principles to each ROC.\n\n**Case 1: ROC is $|z|  2$**\nThis ROC is exterior to both poles, $|z|  2$ and $|z|  0.5$. Thus, both terms $X_1(z)$ and $X_2(z)$ correspond to right-sided sequences.\n- For $X_1(z)$, with $a=0.5$ and ROC $|z|2$ (which is a subset of $|z|0.5$), the inverse is:\n  $$x_1[n] = -\\frac{2}{3} (0.5)^n u[n]$$\n- For $X_2(z)$, with $a=2$ and ROC $|z|2$, the inverse is:\n  $$x_2[n] = \\frac{2}{3} (2)^n u[n]$$\nThe total sequence is $x[n] = x_1[n] + x_2[n]$:\n$$x[n] = \\left( \\frac{2}{3} (2)^n - \\frac{2}{3} (0.5)^n \\right) u[n]$$\n**Classification**: The sequence is zero for all $n  0$. By definition, this is a **right-sided** sequence.\n\n**Case 2: ROC is $0.5  |z|  2$**\nThis ROC is exterior to the pole at $z=0.5$ but interior to the pole at $z=2$.\n- For $X_1(z)$, with $a=0.5$ and ROC $|z|0.5$, we use the right-sided inverse:\n  $$x_1[n] = -\\frac{2}{3} (0.5)^n u[n]$$\n- For $X_2(z)$, with $a=2$ and ROC $|z|2$, we use the left-sided inverse:\n  $$x_2[n] = \\frac{2}{3} \\left( -(2)^n u[-n-1] \\right) = -\\frac{2}{3} (2)^n u[-n-1]$$\nThe total sequence is $x[n] = x_1[n] + x_2[n]$:\n$$x[n] = -\\frac{2}{3} (0.5)^n u[n] - \\frac{2}{3} (2)^n u[-n-1]$$\n**Classification**: The first term is non-zero for $n \\ge 0$, and the second term is non-zero for $n \\le -1$. The sequence is non-zero for both positive and negative time indices, extending to $n \\to \\infty$ and $n \\to -\\infty$. This is a **two-sided** sequence.\n\n**Case 3: ROC is $|z|  0.5$**\nThis ROC is interior to both poles, $|z|  0.5$ and $|z|  2$. Thus, both terms correspond to left-sided sequences.\n- For $X_1(z)$, with $a=0.5$ and ROC $|z|0.5$, the inverse is:\n  $$x_1[n] = -\\frac{2}{3} \\left( -(0.5)^n u[-n-1] \\right) = \\frac{2}{3} (0.5)^n u[-n-1]$$\n- For $X_2(z)$, with $a=2$ and ROC $|z|0.5$ (which is a subset of $|z|2$), the inverse is:\n  $$x_2[n] = \\frac{2}{3} \\left( -(2)^n u[-n-1] \\right) = -\\frac{2}{3} (2)^n u[-n-1]$$\nThe total sequence is $x[n] = x_1[n] + x_2[n]$:\n$$x[n] = \\left( \\frac{2}{3} (0.5)^n - \\frac{2}{3} (2)^n \\right) u[-n-1]$$\n**Classification**: The sequence is zero for all $n  -1$. By definition, this is a **left-sided** sequence.\n\nThe three possible sequences have been determined strictly from first principles as required.", "answer": "$$\\boxed{\\begin{pmatrix} \\left( \\frac{2}{3} (2)^n - \\frac{2}{3} (0.5)^n \\right) u[n]  -\\frac{2}{3} (0.5)^n u[n] - \\frac{2}{3} (2)^n u[-n-1]  \\left( \\frac{2}{3} (0.5)^n - \\frac{2}{3} (2)^n \\right) u[-n-1] \\end{pmatrix}}$$", "id": "2906629"}, {"introduction": "Building on the relationship between the ROC and sequence properties, we now apply these concepts to analyze a Linear Time-Invariant (LTI) system. Starting from a system's difference equation—a common way to describe physical processes—this practice involves deriving the system function $H(z)$ and examining how the choice of ROC determines fundamental system properties: causality and stability. This exercise solidifies the understanding of how pole locations, combined with the ROC, dictate a system's real-world behavior [@problem_id:2906555].", "problem": "Consider the discrete-time Linear Time-Invariant (LTI) system governed by the mixed-order difference equation $y[n] + 0.4\\,y[n-2] = x[n-1]$. Use the bilateral $z$-transform definition and the shift property to derive the system function $H(z)$ defined by $H(z) = \\frac{Y(z)}{X(z)}$ under zero-state conditions. Identify all poles and zeros of $H(z)$ and enumerate all admissible regions of convergence (ROCs) consistent with rational $z$-transforms. Using only the foundational definitions of the region of convergence, causality (impulse response $h[n]$ supported on $n \\ge 0$), and bounded-input bounded-output stability (absolute summability of $h[n]$, equivalently the unit circle $|z|=1$ belonging to the ROC), decide for each admissible ROC whether the system is causal and whether it is stable.\n\nFinally, let $r$ denote the common magnitude of the poles of $H(z)$, and let $N$ be the number of admissible ROCs for which the system is simultaneously causal and stable. Define the scalar $Q$ by $Q = r + N$. Report $Q$ as a closed-form analytic expression. No rounding is required.", "solution": "We start from the bilateral $z$-transform definition for a sequence $x[n]$,\n$$\nX(z) = \\sum_{n=-\\infty}^{\\infty} x[n] z^{-n},\n$$\ntogether with the shift property,\n$$\n\\mathcal{Z}\\{x[n-k]\\} = z^{-k} X(z),\n$$\nwhenever the sums converge in a shared region of convergence (ROC). Applying the $z$-transform to both sides of the given difference equation under zero-state conditions yields\n$$\nY(z) + 0.4\\,z^{-2} Y(z) = z^{-1} X(z).\n$$\nBy rearranging terms, the system function $H(z)$ is\n$$\nH(z) = \\frac{Y(z)}{X(z)} = \\frac{z^{-1}}{1 + 0.4\\,z^{-2}}.\n$$\nMultiplying numerator and denominator by $z^{2}$ gives an equivalent proper rational form,\n$$\nH(z) = \\frac{z}{z^{2} + 0.4}.\n$$\n\nWe identify the poles and zeros from this rational representation. The poles are the roots of the denominator $z^{2} + 0.4 = 0$, namely\n$$\nz = \\pm j\\sqrt{0.4} = \\pm j\\sqrt{\\frac{2}{5}} = \\pm j\\,\\frac{\\sqrt{10}}{5}.\n$$\nThus, both poles lie on the imaginary axis with a common magnitude\n$$\nr = \\left|\\pm j\\,\\frac{\\sqrt{10}}{5}\\right| = \\frac{\\sqrt{10}}{5}.\n$$\nThe numerator is $z$, which contributes a single zero at $z = 0$.\n\nNext, we enumerate admissible ROCs. For a rational $H(z)$ with finitely many poles, the ROC is an annulus bounded by circles centered at the origin and cannot include any pole. Since both poles have the same magnitude $r$, there are two canonical admissible ROCs:\n1. The exterior ROC, given by $|z|  r$, which extends outward to infinity and excludes the poles.\n2. The interior ROC, given by $|z|  r$, which extends inward to the origin and excludes the poles.\n\nThere is no nontrivial “between-poles” annulus because both poles lie on the same circle $|z| = r$, so there is no distinct inner and outer pole radius to create a strictly positive-width annulus between them. Zeros do not restrict the ROC, so the zero at $z=0$ is permissible within an ROC.\n\nWe now decide causality and stability for each ROC using the definitions:\n- Causality for an LTI system requires a right-sided impulse response $h[n]$ with $h[n]=0$ for $n0$. For rational $H(z)$, this corresponds to the ROC being of the form $|z|  r_{\\max}$, that is, the exterior ROC extending to infinity while excluding all poles.\n- Bounded-input bounded-output (BIBO) stability requires absolute summability of $h[n]$, which for rational $H(z)$ is equivalent to the unit circle $|z|=1$ lying in the ROC.\n\nEvaluate each ROC:\n1. ROC $|z|  r$: Because it is an exterior ROC extending to infinity and excluding poles, it corresponds to a right-sided impulse response, hence the system is causal. Since $r = \\frac{\\sqrt{10}}{5}  1$, the unit circle $|z|=1$ satisfies $1  r$ and therefore lies within this ROC. Hence the system is also stable under this ROC.\n2. ROC $|z|  r$: This is an interior ROC extending to the origin, which corresponds to a left-sided impulse response, so the system is not causal. Moreover, since $r  1$, the unit circle $|z|=1$ is not contained in $|z|  r$, hence the system is not stable under this ROC.\n\nTherefore, there is exactly one admissible ROC that makes the system both causal and stable (the exterior ROC $|z|  r$). Denote by $N$ the number of such ROCs; we have $N = 1$. The common pole magnitude is $r = \\frac{\\sqrt{10}}{5}$. The requested scalar is\n$$\nQ = r + N = \\frac{\\sqrt{10}}{5} + 1.\n$$\nThis is already a closed-form expression, and no rounding is required.", "answer": "$$\\boxed{\\frac{\\sqrt{10}}{5}+1}$$", "id": "2906555"}, {"introduction": "While theory allows for perfect mathematical cancellations, real-world systems are subject to small imperfections and parameter drift. This advanced practice explores the critical concept of structural stability by investigating a system where an unstable pole at $z=p$ with $|p| > 1$ is theoretically cancelled by a zero. By introducing arbitrarily small perturbations, you will uncover the \"hidden\" instability and quantify its dramatic impact on the system's frequency response, bridging the gap between abstract models and robust engineering design [@problem_id:2906587].", "problem": "Consider discrete-time, linear time-invariant systems in the $z$-domain with transfer function $H(z) = \\dfrac{B(z)}{A(z)}$, where $A(z)$ and $B(z)$ are polynomials in $z^{-1}$. For causal, rational systems, the Region of Convergence (ROC) is the exterior of the outermost pole, and the system is bounded-input bounded-output (BIBO) stable if and only if the unit circle is contained in the ROC. The frequency response $H\\!\\left(e^{j\\omega}\\right)$ is defined by evaluating $H(z)$ on the unit circle whenever the ROC includes the unit circle.\n\nThis problem investigates how an exact pole-zero cancellation that masks an unstable pole can be destroyed by arbitrarily small perturbations of coefficients, and how such perturbations produce large changes in the frequency response magnitude near the phase of the canceled factor.\n\nSetup. Fix a pole-like complex number $p = r e^{j \\omega_0}$ with $r > 1$ and a stable, strictly causal factor $A_s(z) = 1 - a z^{-1}$ with $|a|  1$. Define the nominal transfer function\n$$\nH_0(z) \\;=\\; \\frac{(1 - p z^{-1})}{(1 - p z^{-1}) \\, A_s(z)} \\;=\\; \\frac{1}{1 - a z^{-1}},\n$$\nin which the unstable factor $(1 - p z^{-1})$ cancels exactly. Now break the exact cancellation by perturbing only the numerator factor so that the zero moves radially to $p(1+\\varepsilon)$ while preserving its angle $\\omega_0$, with a small real $\\varepsilon$. That is, consider the perturbed family\n$$\nH_{\\varepsilon}(z) \\;=\\; \\frac{(1 - p(1+\\varepsilon) z^{-1})}{(1 - p z^{-1}) \\, (1 - a z^{-1})},\n$$\nwith the same $p = r e^{j \\omega_0}$, $r > 1$, and $|a|  1$.\n\nTasks.\n\n1) Using only the core definitions of the $z$-transform, poles/zeros, causality, and BIBO stability via the Region of Convergence, argue from first principles that:\n- For $\\varepsilon = 0$, the exact cancellation removes the pole at $z = p$, and the system reduces to $H_0(z) = 1/(1 - a z^{-1})$, which is BIBO stable if $|a|  1$.\n- For any $\\varepsilon \\neq 0$, the denominator still has a pole at $z = p$ with $|p| = r > 1$, so a causal realization has an ROC $|z| > r$ that does not include the unit circle, hence the system is not BIBO stable. Conclude that arbitrarily small perturbations $\\varepsilon$ can unmask the hidden unstable pole and destroy stability.\n\n2) Let $C_{\\varepsilon}(\\omega)$ denote the magnitude ratio of the perturbed to unperturbed frequency responses at frequency $\\omega$:\n$$\nC_{\\varepsilon}(\\omega) \\;\\triangleq\\; \\frac{\\left|H_{\\varepsilon}\\!\\left(e^{j\\omega}\\right)\\right|}{\\left|H_{0}\\!\\left(e^{j\\omega}\\right)\\right|}\n\\;=\\; \\frac{\\left|1 - p(1+\\varepsilon) e^{-j\\omega}\\right|}{\\left|1 - p e^{-j\\omega}\\right|}.\n$$\nStarting from this definition and without invoking any unproven “shortcut” formulas, derive a first-order, small-$\\varepsilon$ approximation to $C_{\\varepsilon}(\\omega_0)$, i.e., its leading dependence on $\\varepsilon$ at the cancellation angle $\\omega_0$ where $p = r e^{j\\omega_0}$. Express your approximation as a function of $r$ and $\\varepsilon$, to leading order in $\\varepsilon$.\n\n3) Implementation and test suite. Implement a program that, for each test case below, computes:\n- a boolean indicating BIBO stability of the causal perturbed system (with the understanding from Task 1),\n- the first-order approximation you derived in Task 2 for $C_{\\varepsilon}(\\omega_0)$, evaluated at the given parameters,\n- the exact value of $C_{\\varepsilon}(\\omega_0)$ from the defining formula above.\n\nUse angles in radians. No physical units are involved. The test suite consists of the following four parameter sets, each specified as $(r,\\omega_0,a,\\varepsilon)$:\n- Test A (general case): $(1.2,\\; 1.0,\\; 0.5,\\; 10^{-3})$,\n- Test B (near-unit circle pole, tiny perturbation): $(1.01,\\; 0.75,\\; 0.5,\\; 10^{-6})$,\n- Test C (exact cancellation): $(1.1,\\; 2.3,\\; 0.3,\\; 0)$,\n- Test D (larger perturbation, stable part near boundary): $(1.05,\\; 1.8,\\; 0.9,\\; 0.05)$.\n\nYour program should output a single line with the results for all test cases, formatted as a list of lists:\n- For each test case, output a list $[b,\\; s,\\; m]$, where $b$ is the stability boolean, $s$ is the first-order approximation to $C_{\\varepsilon}(\\omega_0)$, and $m$ is the exact $C_{\\varepsilon}(\\omega_0)$.\n- The final line must be a single list containing the four per-test lists, printed as a comma-separated list enclosed in square brackets, for example: $[[b_1,s_1,m_1],[b_2,s_2,m_2],[b_3,s_3,m_3],[b_4,s_4,m_4]]$.\n\nYour derivations must start only from the definitions of the $z$-transform, causality and ROC, and the definition of $C_{\\varepsilon}(\\omega)$ as given above. Do not assume any unproven sensitivity formulas a priori.", "solution": "The problem as stated is scientifically grounded, well-posed, and complete. It presents a canonical and illustrative exercise in the stability analysis of discrete-time linear time-invariant systems, focusing on the practical consequences of inexact pole-zero cancellation. All provided information is sufficient and consistent for a rigorous solution. I shall proceed.\n\nThe solution is organized into three parts, corresponding to the tasks defined in the problem statement.\n\n### Task 1: Stability Analysis\n\nThis task requires an analysis of the system's Bounded-Input Bounded-Output (BIBO) stability based on the location of its poles and the corresponding Region of Convergence (ROC) for a causal system.\n\n**Case 1: Exact Cancellation ($\\varepsilon = 0$)**\n\nThe nominal transfer function is given by\n$$\nH_0(z) = \\frac{(1 - p z^{-1})}{(1 - p z^{-1}) \\, A_s(z)}\n$$\nwhere $A_s(z) = 1 - a z^{-1}$. The numerator has a zero at $z = p$, and the denominator has poles at $z=p$ and $z=a$. In the algebra of rational functions, the common factor $(1 - p z^{-1})$ in the numerator and denominator can be cancelled. This cancellation is mathematically valid and reflects the fact that the mode corresponding to the pole at $z=p$ is not observable at the output.\n\nAfter cancellation, the system is described by the reduced-order transfer function:\n$$\nH_0(z) = \\frac{1}{A_s(z)} = \\frac{1}{1 - a z^{-1}}\n$$\nThis simplified system has a single pole at $z=a$. For a causal system, the ROC is the region in the complex plane exterior to the outermost pole. Here, the ROC is $|z|  |a|$.\n\nA discrete-time LTI system is BIBO stable if and only if its ROC includes the unit circle, i.e., the set of all $z$ such that $|z|=1$. This condition is satisfied if $|a|  1$. The problem statement specifies that $|a|  1$, so the unit circle is indeed within the ROC $|z||a|$. Therefore, for $\\varepsilon=0$, the system is BIBO stable.\n\n**Case 2: Perturbed System ($\\varepsilon \\neq 0$)**\n\nThe perturbed transfer function is given by:\n$$\nH_{\\varepsilon}(z) = \\frac{1 - p(1+\\varepsilon) z^{-1}}{(1 - p z^{-1}) \\, (1 - a z^{-1})}\n$$\nThe poles of $H_{\\varepsilon}(z)$ are the roots of the denominator, which are $z=p$ and $z=a$. The zero is the root of the numerator, which is $z=p(1+\\varepsilon)$. Since $\\varepsilon \\neq 0$, the zero at $z=p(1+\\varepsilon)$ is distinct from the pole at $z=p$, and no pole-zero cancellation occurs.\n\nThe system therefore has two poles: one at $z=a$ and one at $z=p$. We are given that $|p| = r > 1$ and $|a|1$. This means the pole at $z=p$ lies outside the unit circle, while the pole at $z=a$ lies inside.\n\nFor a causal system, the ROC must be the region exterior to the outermost pole. The magnitudes of the poles are $|p|=r$ and $|a|$. Since $r1$ and $|a|1$, the outermost pole is $p$. Thus, the ROC is $|z|  |p| = r$.\n\nBecause $r1$, the ROC $|z|  r$ does not contain the unit circle $|z|=1$. Consequently, the system is not BIBO stable.\n\n**Conclusion for Task 1**\n\nFor any non-zero perturbation $\\varepsilon$, no matter how small, the exact pole-zero cancellation is broken. The unstable pole at $z=p$ (with $|p|1$) is \"unmasked\" and determines the system's ROC for a causal realization. Since this ROC does not include the unit circle, the system becomes unstable. This demonstrates that stability achieved via cancellation of an unstable pole is structurally unstable; it can be destroyed by arbitrarily small parameter variations.\n\n### Task 2: Derivation of First-Order Approximation\n\nWe need to derive a first-order, small-$\\varepsilon$ approximation for the magnitude ratio $C_{\\varepsilon}(\\omega)$ evaluated at the specific frequency $\\omega = \\omega_0$. The definition is:\n$$\nC_{\\varepsilon}(\\omega_0) = \\frac{\\left|H_{\\varepsilon}\\!\\left(e^{j\\omega_0}\\right)\\right|}{\\left|H_{0}\\!\\left(e^{j\\omega_0}\\right)\\right|} = \\frac{\\left|1 - p(1+\\varepsilon) e^{-j\\omega_0}\\right|}{\\left|1 - p e^{-j\\omega_0}\\right|}\n$$\nThe pole location is defined as $p = r e^{j \\omega_0}$. We substitute this and $e^{-j\\omega_0}$ into the expression.\n\nLet us analyze the numerator and the denominator separately.\n\n**Numerator:**\nThe term inside the magnitude is $1 - p(1+\\varepsilon) e^{-j\\omega_0}$. Substituting $p=re^{j\\omega_0}$:\n$$\n1 - (r e^{j\\omega_0})(1+\\varepsilon) e^{-j\\omega_0} = 1 - r(1+\\varepsilon) (e^{j\\omega_0} e^{-j\\omega_0}) = 1 - r(1+\\varepsilon)\n$$\nThis expression is purely real. The magnitude is therefore $|1 - r(1+\\varepsilon)|$.\nGiven $r > 1$ and a small real $\\varepsilon$, the quantity $r(1+\\varepsilon)$ will also be greater than $1$. Thus, $1 - r(1+\\varepsilon)$ is negative.\n$$\n|1 - r(1+\\varepsilon)| = -(1 - r(1+\\varepsilon)) = r(1+\\varepsilon) - 1\n$$\n\n**Denominator:**\nThe term inside the magnitude is $1 - p e^{-j\\omega_0}$. Substituting $p=re^{j\\omega_0}$:\n$$\n1 - (r e^{j\\omega_0}) e^{-j\\omega_0} = 1 - r (e^{j\\omega_0} e^{-j\\omega_0}) = 1 - r\n$$\nThis expression is also purely real. The magnitude is $|1 - r|$.\nSince $r > 1$, the quantity $1-r$ is negative.\n$$\n|1 - r| = -(1 - r) = r - 1\n$$\n\n**Combining the results:**\nWe can now write the expression for $C_{\\varepsilon}(\\omega_0)$:\n$$\nC_{\\varepsilon}(\\omega_0) = \\frac{r(1+\\varepsilon) - 1}{r - 1}\n$$\nWe can simplify this expression:\n$$\nC_{\\varepsilon}(\\omega_0) = \\frac{r + r\\varepsilon - 1}{r - 1} = \\frac{(r - 1) + r\\varepsilon}{r - 1} = \\frac{r-1}{r-1} + \\frac{r\\varepsilon}{r-1}\n$$\nThis simplifies to:\n$$\nC_{\\varepsilon}(\\omega_0) = 1 + \\frac{r}{r-1}\\varepsilon\n$$\nThis expression is exactly linear in $\\varepsilon$. The problem asks for a first-order, small-$\\varepsilon$ approximation. A first-order Taylor series expansion of a linear function about $\\varepsilon=0$ is the function itself. Therefore, the derived formula is not an approximation but the exact expression for $C_{\\varepsilon}(\\omega_0)$. The leading dependence on $\\varepsilon$ is captured by the term $\\frac{r}{r-1}\\varepsilon$. The sensitivity factor $\\frac{r}{r-1}$ becomes very large as $r \\to 1^+$, indicating extreme sensitivity to perturbation when the unstable pole is close to the unit circle.\n\n### Task 3: Implementation Logic\n\nThe implementation will compute three values for each test case $(r, \\omega_0, a, \\varepsilon)$:\n1.  **BIBO Stability ($b$)**: Based on the analysis in Task 1, the causal system is BIBO stable if and only if $\\varepsilon = 0$. So, the boolean value $b$ is `True` if $\\varepsilon = 0$ and `False` otherwise.\n2.  **First-Order Approximation ($s$)**: Based on the derivation in Task 2, the approximation is $s = 1 + \\frac{r}{r-1}\\varepsilon$.\n3.  **Exact Value ($m$)**: As shown in Task 2, for the specific frequency $\\omega_0$, the exact value of $C_{\\varepsilon}(\\omega_0)$ is identical to the first-order approximation. Thus, $m = s = 1 + \\frac{r}{r-1}\\varepsilon$. This identity will be reflected in the code's output. For the special case $\\varepsilon=0$, both formulas correctly yield $1$.\n\nThe program will iterate through the provided test cases, compute these three values for each, and format the output as a list of lists.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes stability and frequency response magnitude ratio for perturbed LTI systems.\n    \"\"\"\n    # Test cases are defined as tuples (r, omega_0, a, epsilon).\n    test_cases = [\n        # Test A (general case)\n        (1.2, 1.0, 0.5, 1e-3),\n        # Test B (near-unit circle pole, tiny perturbation)\n        (1.01, 0.75, 0.5, 1e-6),\n        # Test C (exact cancellation)\n        (1.1, 2.3, 0.3, 0.0),\n        # Test D (larger perturbation, stable part near boundary)\n        (1.05, 1.8, 0.9, 0.05)\n    ]\n\n    results = []\n    for case in test_cases:\n        r, omega_0, a, epsilon = case\n        \n        # 1. Determine BIBO stability of the causal system.\n        # The system is stable iff the pole-zero cancellation is exact (epsilon = 0).\n        # For any epsilon != 0, the unstable pole at z=p with |p| = r > 1 is not cancelled,\n        # making the causal system unstable.\n        is_stable = (epsilon == 0)\n\n        # 2. Calculate the first-order approximation for C_epsilon(omega_0).\n        # From the derivation, s = 1 + (r / (r - 1)) * epsilon.\n        # This formula is valid for r > 1.\n        if r = 1:\n            # This case is excluded by the problem statement (r > 1) but handled for robustness.\n            # The sensitivity factor r/(r-1) would be undefined or negative.\n            # We'll set results to NaN to indicate an issue.\n            approx_C = np.nan\n            exact_C = np.nan\n        else:\n            sensitivity_factor = r / (r - 1)\n            approx_C = 1.0 + sensitivity_factor * epsilon\n            \n            # 3. Calculate the exact value of C_epsilon(omega_0).\n            # As derived in the solution, for the specific frequency omega_0, the\n            # first-order approximation is identical to the exact value.\n            # C_exact = (r*(1+epsilon) - 1) / (r - 1)\n            # This algebraically simplifies to 1 + (r / (r-1)) * epsilon.\n            exact_C = approx_C\n\n        results.append([is_stable, approx_C, exact_C])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    print(results)\n\nsolve()\n```", "id": "2906587"}]}