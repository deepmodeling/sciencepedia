{"hands_on_practices": [{"introduction": "One of the most remarkable features of the integer quantum Hall effect is the extreme robustness and universality of the quantized Hall resistance. This exercise employs the Landauer-Büttiker formalism, a cornerstone of mesoscopic physics, to investigate this phenomenon directly. By modeling a four-terminal Hall bar with an imperfectly coupled voltage probe [@problem_id:1155444], you will see how the quantized value of the Hall resistance is topologically protected by the chiral nature of the edge channels, remaining completely insensitive to such local defects.", "problem": "A four-terminal Hall bar is fabricated from a two-dimensional electron gas (2DEG). The terminals are arranged in a cross geometry and labeled 1, 2, 3, 4 in a counter-clockwise manner. A strong perpendicular magnetic field $B$ places the system in the integer quantum Hall (IQH) regime, with a bulk filling factor of $\\nu$, giving rise to $\\nu$ chiral edge channels that also propagate counter-clockwise.\n\nThe Hall resistance, $R_H$, is measured by injecting a current $I$ into terminal 1 and extracting it from terminal 3, while measuring the voltage difference $V_H = V_2 - V_4$ between terminals 2 and 4, which act as ideal voltage probes (drawing no current).\n\nTerminal 4 is imperfectly coupled to the 2DEG. The coupling is modeled by a local, time-reversal symmetric scatterer. An electron arriving at the junction of terminal 4 via an edge channel has a probability $T$ of being transmitted into the reservoir of terminal 4, and a probability $1-T$ of being reflected to continue along the next segment of the edge. The transmission probability $T$ satisfies $0 < T < 1$.\n\nUsing the Landauer-Büttiker formalism, determine the Hall resistance $R_H = V_H / I$.", "solution": "The system is in the integer quantum Hall regime with filling factor $\\nu$, resulting in $\\nu$ chiral edge channels propagating counter-clockwise. The Hall resistance $R_H$ is defined as $R_H = V_H / I$, where $V_H = V_2 - V_4$ and $I$ is the current injected into terminal 1 and extracted from terminal 3. Terminals 2 and 4 are ideal voltage probes, so $I_2 = 0$ and $I_4 = 0$. Terminal 4 has a scatterer with transmission probability $T$ ($0 < T < 1$).\n\nUsing the Landauer-Büttiker formalism for one edge channel, the currents at each terminal are:\n\n- $I_1 = \\frac{e}{h} \\left[ \\mu_1 - (1 - T) \\mu_3 - T \\mu_4 \\right]$\n- $I_2 = \\frac{e}{h} (\\mu_2 - \\mu_1)$\n- $I_3 = \\frac{e}{h} (\\mu_3 - \\mu_2)$\n- $I_4 = \\frac{e}{h} T (\\mu_4 - \\mu_3)$\n\nFor $\\nu$ independent edge channels, the total currents are scaled by $\\nu$:\n\n- $I_1 = \\nu \\frac{e}{h} \\left[ \\mu_1 - (1 - T) \\mu_3 - T \\mu_4 \\right]$\n- $I_2 = \\nu \\frac{e}{h} (\\mu_2 - \\mu_1)$\n- $I_3 = \\nu \\frac{e}{h} (\\mu_3 - \\mu_2)$\n- $I_4 = \\nu \\frac{e}{h} T (\\mu_4 - \\mu_3)$\n\nGiven the measurement conditions:\n- $I_1 = I$\n- $I_3 = -I$\n- $I_2 = 0$\n- $I_4 = 0$\n\nSolving the equations:\n\n1. From $I_2 = 0$:\n   $$\n   \\nu \\frac{e}{h} (\\mu_2 - \\mu_1) = 0 \\implies \\mu_2 = \\mu_1\n   $$\n\n2. From $I_4 = 0$ (and $T \\neq 0$):\n   $$\n   \\nu \\frac{e}{h} T (\\mu_4 - \\mu_3) = 0 \\implies \\mu_4 = \\mu_3\n   $$\n\n3. From $I_3 = -I$ and $\\mu_2 = \\mu_1$:\n   $$\n   \\nu \\frac{e}{h} (\\mu_3 - \\mu_2) = -I \\implies \\nu \\frac{e}{h} (\\mu_3 - \\mu_1) = -I\n   $$\n   Rearranging:\n   $$\n   \\mu_1 - \\mu_3 = \\frac{I h}{\\nu e}\n   $$\n\n4. The Hall voltage is $V_H = V_2 - V_4 = \\frac{\\mu_2 - \\mu_4}{e}$. Substituting $\\mu_2 = \\mu_1$ and $\\mu_4 = \\mu_3$:\n   $$\n   V_H = \\frac{\\mu_1 - \\mu_3}{e} = \\frac{1}{e} \\cdot \\frac{I h}{\\nu e} = \\frac{I h}{\\nu e^2}\n   $$\n\n5. The Hall resistance is:\n   $$\n   R_H = \\frac{V_H}{I} = \\frac{\\frac{I h}{\\nu e^2}}{I} = \\frac{h}{\\nu e^2}\n   $$\n\nThe result is independent of $T$ due to the voltage probe conditions constraining the chemical potentials.", "answer": "$$\\boxed{\\dfrac{h}{\\nu e^2}}$$", "id": "1155444"}, {"introduction": "While the edge-state picture provides a powerful model for quantized transport, the ultimate origin of the integer quantum Hall effect lies in the interplay between topology and disorder in the bulk of the material. This practice challenges you to synthesize these concepts to explain the key experimental signatures: the formation of wide Hall plateaus where the Hall conductivity $\\sigma_{xy}$ is perfectly quantized, and the simultaneous, precipitous drop in the longitudinal conductivity $\\sigma_{xx}$. Correctly analyzing this scenario [@problem_id:2830190] is crucial for understanding how a perfect quantum phenomenon can emerge from a realistic, imperfect solid.", "problem": "A two-dimensional ($2$D) disordered electron gas in a strong perpendicular magnetic field $B$ exhibits the integer quantum Hall effect (IQHE). Disorder broadens each Landau level into a band in which states in the tails are localized while a narrow set of states near the band center is delocalized. Consider a Hall bar at magnetic field $B$ and carrier density such that the chemical potential $\\mu$ lies within a localized portion (a mobility gap of width $\\Delta$ to the nearest delocalized states). The temperature satisfies $k_{\\mathrm{B}} T \\ll \\Delta \\ll \\hbar \\omega_{c}$, with $\\omega_{c}$ the cyclotron frequency, and inelastic electron–phonon scattering is present but weak. In this regime experiments show that the Hall conductivity remains quantized to very high accuracy while the longitudinal conductivity becomes extremely small.\n\nWhich statement best explains, from basic principles of linear response and localization in disordered systems, why the Hall conductivity remains quantized at finite but low temperature $T$ while the longitudinal conductivity $\\sigma_{xx}$ becomes exponentially small, and correctly identifies the role played by inelastic hopping processes? Select all that apply.\n\nA. The off-diagonal conductivity $\\sigma_{xy}$ is a topological invariant (a Chern number) associated with the projector onto occupied states; as long as $\\mu$ lies in an energy interval containing only localized states and $k_{\\mathrm{B}} T \\ll \\Delta$, the thermal occupation of delocalized states is exponentially suppressed, so $\\sigma_{xy}$ remains quantized up to corrections $\\sim e^{-\\Delta / (k_{\\mathrm{B}} T)}$. In contrast, bulk charge motion requires dissipation and proceeds via inelastic, phonon-assisted hopping between localized states, yielding an exponentially small $\\sigma_{xx}(T)$ that crosses over from activated behavior $\\propto e^{-\\Delta / (k_{\\mathrm{B}} T)}$ near mobility edges to variable-range hopping $\\propto \\exp[-(T_{0}/T)^{\\alpha}]$ at lower $T$, with $\\alpha$ set by the density of states and Coulomb interactions.\n\nB. Quantization of $\\sigma_{xy}$ at low $T$ requires purely elastic, phase-coherent transport; any inelastic hopping immediately destroys quantization by breaking coherence in the edge channels, so the observation of quantization implies that inelastic processes are absent. The smallness of $\\sigma_{xx}$ is unrelated to hopping.\n\nC. The longitudinal conductivity is exponentially small because all bulk states are completely localized and there is no conduction path at any finite $T$, so $\\sigma_{xx}=0$ exactly. The Hall quantization persists because the system behaves as an ideal classical Hall gas in a strong magnetic field. Inelastic hopping is irrelevant in this regime.\n\nD. Quantization of $\\sigma_{xy}$ at low $T$ requires that the inelastic dephasing length $L_{\\phi}$ be much shorter than the localization length $\\xi$, preventing localization; the exponentially small $\\sigma_{xx}$ arises from coherent elastic tunneling between opposite edges of the sample, while inelastic hopping between localized bulk states reduces $\\sigma_{xx}$ further and tends to destroy quantization.", "solution": "The problem statement must first be validated for scientific and logical integrity.\n\n**Step 1: Extract Givens**\n- **System:** A two-dimensional ($2$D) disordered electron gas.\n- **External Field:** A strong perpendicular magnetic field $B$.\n- **Phenomenon:** The integer quantum Hall effect (IQHE).\n- **Disorder Model:** Each Landau level is broadened into a band. States in the band tails are localized, while states near the band center are delocalized.\n- **System State:** The chemical potential $\\mu$ is located within a localized portion of a Landau band, with a mobility gap of width $\\Delta$ to the nearest delocalized states.\n- **Temperature Condition:** The temperature $T$ satisfies $k_{\\mathrm{B}} T \\ll \\Delta \\ll \\hbar \\omega_{c}$, where $\\omega_{c}$ is the cyclotron frequency.\n- **Scattering Mechanism:** Inelastic electron-phonon scattering is present but weak.\n- **Experimental Observations:** The Hall conductivity, $\\sigma_{xy}$, remains quantized with high accuracy. The longitudinal conductivity, $\\sigma_{xx}$, becomes extremely small.\n- **Question:** The task is to identify the statement that best explains these observations based on linear response theory and localization, and clarifies the role of inelastic hopping.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem formulation is examined against the criteria for validity.\n\n- **Scientifically Grounded:** The description is a standard textbook model of the integer quantum Hall effect in a disordered two-dimensional electron gas. The concepts of Landau levels, disorder-induced broadening, localized and delocalized (extended) states, the mobility gap, and the specified energy hierarchy ($k_{\\mathrm{B}} T \\ll \\Delta \\ll \\hbar \\omega_{c}$) are all fundamental and well-established in condensed matter physics.\n- **Well-Posed:** The problem is unambiguous. It presents a set of established physical facts and asks for the correct theoretical explanation from a list of choices. A definite, unique answer exists within the accepted theoretical framework.\n- **Objective:** The language is technical and precise, devoid of subjectivity or non-scientific claims.\n\nThe problem statement does not exhibit any flaws such as scientific unsoundness, incompleteness, contradiction, or ambiguity. It is a standard conceptual problem in solid-state physics.\n\n**Step 3: Verdict and Action**\nThe problem statement is **VALID**. A solution will be derived.\n\n**Derivation of Solution**\n\nThe behavior of the conductivity tensor components, $\\sigma_{xx}$ and $\\sigma_{xy}$, in the IQHE regime is a profound consequence of quantum mechanics, topology, and localization theory.\n\n1.  **Hall Conductivity ($\\sigma_{xy}$):**\n    The quantization of the Hall conductivity in integer multiples of $e^2/h$ is a topological phenomenon. As shown by Thouless, Kohmoto, Nightingale, and den Nijs (TKNN), for a system where the chemical potential $\\mu$ lies in an energy gap, the Hall conductivity is determined by a topological invariant known as the Chern number, which is an integer.\n    $$ \\sigma_{xy} = N \\frac{e^2}{h}, \\quad N \\in \\mathbb{Z} $$\n    In a disordered system, the Landau levels broaden into bands with localized states in the tails and extended states at the center. When $\\mu$ lies in a region of localized states (a mobility gap), these localized states do not contribute to the net Hall current. The value of $\\sigma_{xy}$ is determined solely by the number of filled bands of extended states below $\\mu$. As long as $\\mu$ remains within the mobility gap, varying the carrier density or other parameters merely changes the occupation of localized states, which does not alter the topological invariant. Hence, $\\sigma_{xy}$ remains fixed on a plateau.\n    At a finite, low temperature $T$ such that $k_{\\mathrm{B}} T \\ll \\Delta$, where $\\Delta$ is the energy to excite an electron to the nearest extended state, there is a small probability of thermal activation of carriers into the extended states above the chemical potential. This probability is governed by the Boltzmann factor, $e^{-\\Delta / (k_{\\mathrm{B}} T)}$. Consequently, any deviation from the perfectly quantized value of $\\sigma_{xy}$ is exponentially suppressed and becomes negligible at low temperatures.\n\n2.  **Longitudinal Conductivity ($\\sigma_{xx}$):**\n    The longitudinal conductivity, $\\sigma_{xx}$, is associated with dissipation. For current to flow in the direction of an applied electric field and dissipate energy, electrons must be able to transition between states at the chemical potential.\n    At zero temperature ($T=0$), if $\\mu$ lies in the mobility gap, all states at this energy are localized. An electron in a localized state is spatially confined and cannot contribute to a macroscopic DC current. Therefore, at $T=0$, $\\sigma_{xx}=0$.\n    At a finite, non-zero temperature $T>0$, conduction becomes possible through inelastic processes, which allow electrons to \"hop\" between different localized states. This transport mechanism is typically assisted by phonons, which can provide or absorb the small energy difference between the initial and final localized states. Since this process is required for a non-zero $\\sigma_{xx}$, the presence of weak inelastic scattering is essential.\n    The temperature dependence of this hopping conductivity follows two main forms:\n    -   At relatively higher temperatures (though still low, $k_{\\mathrm{B}} T < \\Delta$), conductivity is dominated by thermal activation to the mobility edge, leading to an Arrhenius law: $\\sigma_{xx} \\propto e^{-\\Delta_a / (k_{\\mathrm{B}} T)}$, where $\\Delta_a$ is the activation energy.\n    -   At very low temperatures, it becomes energetically more favorable for an electron to hop over a longer distance to a state that is closer in energy. This is known as variable-range hopping (VRH), described by $\\sigma_{xx} \\propto \\exp[-(T_{0}/T)^{\\alpha}]$, where $T_0$ is a characteristic temperature and the exponent $\\alpha$ depends on the dimensionality and the details of the density of states and interactions.\n    In both cases, because hopping is a probabilistic process that is infrequent at low temperatures, the resulting $\\sigma_{xx}$ is exponentially small.\n\nIn summary, the quantization of $\\sigma_{xy}$ is protected by topology and the localization of states at the chemical potential, with only exponentially small thermal corrections. The longitudinal conductivity $\\sigma_{xx}$ is non-zero only due to inelastic, thermally-assisted hopping between these localized states, which results in an exponentially small value.\n\n**Evaluation of Options**\n\n**A. The off-diagonal conductivity $\\sigma_{xy}$ is a topological invariant (a Chern number) associated with the projector onto occupied states; as long as $\\mu$ lies in an energy interval containing only localized states and $k_{\\mathrm{B}} T \\ll \\Delta$, the thermal occupation of delocalized states is exponentially suppressed, so $\\sigma_{xy}$ remains quantized up to corrections $\\sim e^{-\\Delta / (k_{\\mathrm{B}} T)}$. In contrast, bulk charge motion requires dissipation and proceeds via inelastic, phonon-assisted hopping between localized states, yielding an exponentially small $\\sigma_{xx}(T)$ that crosses over from activated behavior $\\propto e^{-\\Delta / (k_{\\mathrm{B}} T)}$ near mobility edges to variable-range hopping $\\propto \\exp[-(T_{0}/T)^{\\alpha}]$ at lower $T$, with $\\alpha$ set by the density of states and Coulomb interactions.**\n\nThis statement is a precise and complete summary of the modern understanding of the IQHE in disordered systems at finite temperature. It correctly identifies $\\sigma_{xy}$ as a topological invariant, explains its stability at low $T$ due to the mobility gap, quantifies the thermal corrections, and correctly describes $\\sigma_{xx}$ as arising from inelastic hopping with the correct characteristic temperature dependencies.\n**Verdict: Correct.**\n\n**B. Quantization of $\\sigma_{xy}$ at low $T$ requires purely elastic, phase-coherent transport; any inelastic hopping immediately destroys quantization by breaking coherence in the edge channels, so the observation of quantization implies that inelastic processes are absent. The smallness of $\\sigma_{xx}$ is unrelated to hopping.**\n\nThis statement is fundamentally incorrect. The quantization of $\\sigma_{xy}$ is robust *against* weak inelastic scattering; it does not require its complete absence. Inelastic scattering is, in fact, necessary to establish thermal equilibrium. The claim that the smallness of $\\sigma_{xx}$ is unrelated to hopping is false; hopping is the very mechanism that gives rise to a non-zero $\\sigma_{xx}$ in this regime.\n**Verdict: Incorrect.**\n\n**C. The longitudinal conductivity is exponentially small because all bulk states are completely localized and there is no conduction path at any finite $T$, so $\\sigma_{xx}=0$ exactly. The Hall quantization persists because the system behaves as an ideal classical Hall gas in a strong magnetic field. Inelastic hopping is irrelevant in this regime.**\n\nThis statement contains several errors. First, at any finite $T$, there is a conduction path via hopping, so $\\sigma_{xx}$ is exponentially small but not exactly zero. Second, the IQHE is a distinctly quantum mechanical phenomenon, and explaining it via a classical Hall gas analogy is a severe misrepresentation that ignores the role of quantum states and topology. Third, inelastic hopping is not irrelevant; it is the essential mechanism for the finite value of $\\sigma_{xx}$.\n**Verdict: Incorrect.**\n\n**D. Quantization of $\\sigma_{xy}$ at low $T$ requires that the inelastic dephasing length $L_{\\phi}$ be much shorter than the localization length $\\xi$, preventing localization; the exponentially small $\\sigma_{xx}$ arises from coherent elastic tunneling between opposite edges of the sample, while inelastic hopping between localized bulk states reduces $\\sigma_{xx}$ further and tends to destroy quantization.**\n\nThis statement is entirely confused. Localization requires a long dephasing length, $L_{\\phi} > \\xi$, not the other way around. Requiring $L_{\\phi} \\ll \\xi$ would destroy localization, which is essential for the plateaus. The mechanism for $\\sigma_{xx}$ is bulk hopping, not tunneling between edges. Finally, inelastic hopping *enables* a non-zero $\\sigma_{xx}$, it does not reduce it.\n**Verdict: Incorrect.**\n\nOnly statement A provides a physically sound and detailed explanation consistent with established theory.", "answer": "$$\\boxed{A}$$", "id": "2830190"}, {"introduction": "To connect quantum Hall theory to real-world materials like semiconductor heterostructures, we must account for the detailed electronic structure and electron-electron interactions. This computational practice guides you through building a self-consistent model of a two-dimensional electron gas confined in a wide quantum well [@problem_id:2830254]. By numerically solving the coupled Schrödinger and Poisson equations, you will determine the subband structure, the shape of the Hartree potential, and which electronic states contribute to the integer quantum Hall effect at a given magnetic field and density, bridging the gap between abstract models and materials engineering.", "problem": "Consider a two-dimensional electron system confined in a single symmetric wide quantum well grown along the $z$ direction, with motion free in the $x$–$y$ plane and quantized along $z$. In a perpendicular magnetic field $B$ along $+\\hat{z}$, assume translational invariance in the $x$–$y$ plane and model the electrons with an effective mass $m^\\ast$ and a static dielectric constant $\\varepsilon=\\varepsilon_r\\varepsilon_0$. Work at zero temperature. You are to compute, for given parameters, a self-consistent Hartree potential along $z$ and the resulting subband structure, and then determine which subbands contribute to the integer filling factor in the Integer Quantum Hall Effect (IQHE).\n\nFundamental base and modeling assumptions to start from:\n- The one-dimensional single-particle Schrödinger equation for motion along $z$ reads\n$$\n\\left[-\\frac{\\hbar^2}{2 m^\\ast}\\frac{d^2}{dz^2} + V_{\\mathrm{conf}}(z) + V_{\\mathrm{H}}(z)\\right]\\psi_n(z) = \\varepsilon_n \\,\\psi_n(z),\n$$\nwhere $V_{\\mathrm{conf}}(z)$ is the structural confinement potential of the well and $V_{\\mathrm{H}}(z)$ is the Hartree potential energy due to electron–electron repulsion and the positive background.\n- Within the plane, Landau quantization yields Landau levels with energies\n$$\nE_{n,\\ell} = \\varepsilon_n + \\left(\\ell + \\tfrac{1}{2}\\right)\\hbar\\omega_c,\n$$\nwhere $\\omega_c = eB/m^\\ast$ and $\\ell \\in \\{0,1,2,\\dots\\}$. Each Landau level carries a degeneracy per unit area\n$$\ng_B = \\frac{eB}{h}.\n$$\n- The electrostatic potential $\\phi(z)$ satisfies the Poisson equation\n$$\n\\frac{d^2 \\phi}{dz^2} = -\\frac{\\rho(z)}{\\varepsilon},\n$$\nwith charge density $\\rho(z) = e\\left[n_{\\mathrm{bg}}(z) - n_e(z)\\right]$. The Hartree potential energy for an electron is $V_{\\mathrm{H}}(z) = -e\\,\\phi(z)$, so that\n$$\n\\frac{d^2 V_{\\mathrm{H}}}{dz^2} = \\frac{e^2}{\\varepsilon}\\left[n_{\\mathrm{bg}}(z) - n_e(z)\\right].\n$$\n- The three-dimensional electron density is given by\n$$\nn_e(z) = \\sum_{n} n_n\\,|\\psi_n(z)|^2,\n$$\nwhere $n_n$ is the sheet density contributed by subband $n$ and the envelope functions are normalized as $\\int |\\psi_n(z)|^2\\,dz = 1$.\n- The well is symmetric and wide. For definiteness, take $V_{\\mathrm{conf}}(z)$ as a perfectly hard-wall potential of width $W$ centered on the growth axis, i.e., motion is confined to a segment of length $W$ with Dirichlet boundary conditions $\\psi_n=0$ at the two walls and $V_{\\mathrm{conf}}(z)=0$ inside. Impose Dirichlet boundary conditions $V_{\\mathrm{H}}=0$ at the two well edges for the Hartree potential energy.\n- To maintain overall charge neutrality, use a uniform positive background within the well, $n_{\\mathrm{bg}}(z) = N_s/W$, where $N_s$ is the specified total electron sheet density.\n\nAlgorithmic task:\n1. Discretize the $z$ domain uniformly over the interval of width $W$ with Dirichlet boundary conditions for $\\psi_n$ and $V_{\\mathrm{H}}$ at the edges. Use central finite differences for the second derivative.\n2. Initialize $V_{\\mathrm{H}}(z)=0$. Solve the one-dimensional Schrödinger eigenproblem and retain a fixed number of the lowest subbands with energies $\\varepsilon_n$ and normalized envelope functions $\\psi_n(z)$.\n3. For a given magnetic field $B$ and sheet density $N_s$, determine the subband-resolved sheet densities $n_n$ at zero temperature by filling the discrete set of energies $\\{E_{n,\\ell}\\}$ in increasing order until the total sheet density $N_s$ is accounted for by the degeneracy $g_B$. Allow for the possibility of multiple subbands contributing Landau levels before higher Landau levels of the lowest subband, depending on the relative offsets $\\varepsilon_n$ and the cyclotron energy. If the filling factor is not an integer, the highest partially filled Landau level contributes a fractional weight; however, in the test suite below the parameters are chosen so that the filling factor is an integer.\n4. Construct $n_e(z)$ from the occupied states via $n_e(z) = \\sum_n n_n |\\psi_n(z)|^2$.\n5. Solve the Poisson equation for $V_{\\mathrm{H}}(z)$ with the specified boundary conditions and update $V_{\\mathrm{H}}(z)$ by linear mixing to achieve self-consistency. Iterate steps $2$–$5$ until convergence of $V_{\\mathrm{H}}(z)$.\n6. After convergence, identify the set of subband indices $\\{n\\}$ for which $n_n > 0$, i.e., at least one Landau level in subband $n$ is filled. The integer filling factor is $\\nu = N_s/g_B = N_s h/(eB)$.\n\nConstants for material parameters:\n- Use $m^\\ast = 0.067\\,m_e$, where $m_e$ is the electron mass.\n- Use $\\varepsilon_r = 12.9$ for Gallium Arsenide, so that $\\varepsilon = \\varepsilon_r \\varepsilon_0$.\n- Use standard values for $e$, $h$, and $\\hbar$.\n\nNumerical requirements:\n- Ensure the finite-difference discretization and eigenvalue solver are sufficiently accurate for the given well widths.\n- Use a robust iterative mixing scheme for the Hartree potential update.\n- Self-consistency tolerance should be chosen so that the identified contributing subbands are stable with respect to further iteration.\n\nTest suite:\nCompute and report results for the following three parameter sets. Each case specifies the well width $W$, magnetic field $B$, and total sheet density $N_s$. All physical input numbers are given in SI units. The outputs are dimensionless integers.\n\n- Case $1$: $W = 30\\,\\mathrm{nm}$, $B = 8\\,\\mathrm{T}$, $N_s = 3.8690469\\times 10^{15}\\,\\mathrm{m}^{-2}$.\n- Case $2$: $W = 60\\,\\mathrm{nm}$, $B = 6\\,\\mathrm{T}$, $N_s = 5.8029803\\times 10^{15}\\,\\mathrm{m}^{-2}$.\n- Case $3$: $W = 80\\,\\mathrm{nm}$, $B = 6\\,\\mathrm{T}$, $N_s = 8.7044704\\times 10^{15}\\,\\mathrm{m}^{-2}$.\n\nRequired final outputs for each case:\n- The integer filling factor $\\nu$ computed as $\\nu = N_s h/(eB)$, rounded to the nearest integer.\n- The number $K$ of subbands that contribute to $\\nu$ (i.e., those with $n_n > 0$).\n- The $K$ contributing subband indices in ascending order, using $1$-based indexing for the subbands as ordered by increasing $\\varepsilon_n$.\n\nFinal output format:\nYour program should produce a single line of output containing a list of three lists, one per case, where each case list is of the form $[\\nu, K, s_1, s_2, \\dots, s_K]$ with integers only. The entire output must be a single line in the exact format\n$$\n[[\\nu_1, K_1, s_{1,1}, \\dots, s_{1,K_1}], [\\nu_2, K_2, s_{2,1}, \\dots, s_{2,K_2}], [\\nu_3, K_3, s_{3,1}, \\dots, s_{3,K_3}]].\n$$\nNo units should appear in the output. Angle units are not used. All intermediate calculations must be done in SI units internally.", "solution": "The problem as stated is valid. It presents a standard, well-posed problem in condensed matter physics: the self-consistent calculation of the electronic structure of a two-dimensional electron gas in a wide quantum well under a perpendicular magnetic field. The physical model is based on the Schrödinger-Poisson equations within the Hartree approximation, a cornerstone of many-body physics. The parameters, boundary conditions, and algorithmic steps are specified with sufficient clarity and are scientifically sound. The problem is a non-trivial computational task that correctly models the competition between quantum confinement, electron-electron interactions, and Landau quantization in the Integer Quantum Hall Effect regime.\n\nThe solution is obtained by implementing the prescribed iterative self-consistent field (SCF) procedure. The core of the method is to find a stationary solution for the Hartree potential $V_{\\mathrm{H}}(z)$ and the corresponding electron wavefunctions $\\psi_n(z)$ and subband energies $\\varepsilon_n$.\n\nThe domain, a one-dimensional quantum well of width $W$, is discretized along the $z$-axis into a uniform grid with $N_z$ points and a spacing of $\\Delta z$. I use $z=0$ as the center of the well, so the domain is $[-W/2, W/2]$. Dirichlet boundary conditions, $\\psi_n(\\pm W/2)=0$ and $V_{\\mathrm{H}}(\\pm W/2)=0$, are imposed at the well edges.\n\nThe one-dimensional Schrödinger equation for the envelope functions $\\psi_n(z)$ is\n$$\n\\left[-\\frac{\\hbar^2}{2 m^\\ast}\\frac{d^2}{dz^2} + V_{\\mathrm{H}}(z)\\right]\\psi_n(z) = \\varepsilon_n \\psi_n(z)\n$$\nThis equation is solved as a matrix eigenvalue problem on the discretized grid. The second derivative operator is approximated using a central finite difference scheme, resulting in a tridiagonal Hamiltonian matrix for the internal grid points. The eigensolutions $(\\varepsilon_n, \\psi_n)$ are found using a numerical eigensolver. The computed eigenvectors are normalized such that $\\int_{-W/2}^{W/2} |\\psi_n(z)|^2 dz = 1$. A sufficiently large number of subbands, $N_{sub}$, must be computed to form a complete enough basis for the occupied states.\n\nOnce the subband energies $\\varepsilon_n$ are known for a given iterate of $V_{\\mathrm{H}}(z)$, the energies of the Landau levels are given by $E_{n,\\ell} = \\varepsilon_n + (\\ell + 1/2)\\hbar\\omega_c$, where $\\omega_c = eB/m^\\ast$ is the cyclotron frequency. At zero temperature, electrons fill these discrete energy levels starting from the lowest one. The degeneracy of each Landau level per unit area is $g_B = eB/h$. Given a total electron sheet density $N_s$, the integer filling factor is $\\nu = N_s/g_B$. We populate the lowest $\\nu$ energy levels from the combined list of all states $\\{E_{n,\\ell}\\}$. The sheet density $n_n$ for each subband is then calculated by summing the degeneracies of all occupied Landau levels belonging to that subband: $n_n = g_B \\times (\\text{number of occupied levels in subband } n)$.\n\nWith the subband densities $n_n$ and the wavefunctions $\\psi_n(z)$, the three-dimensional electron density is constructed as $n_e(z) = \\sum_n n_n |\\psi_n(z)|^2$. This density serves as input for the Poisson equation, which determines the new Hartree potential:\n$$\n\\frac{d^2 V_{\\mathrm{H}}}{dz^2} = \\frac{e^2}{\\varepsilon}\\left[n_{\\mathrm{bg}}(z) - n_e(z)\\right]\n$$\nHere, $n_{\\mathrm{bg}}(z) = N_s/W$ is the uniform positive background charge density required for overall neutrality. This is a one-dimensional boundary value problem, which is solved on the grid by converting it into a system of linear equations for the potential values at the internal grid points, $V_{\\mathrm{H}}(z_i)$.\n\nThe self-consistent loop proceeds as follows:\n1. Initialize the Hartree potential, typically $V_{\\mathrm{H}}^{(0)}(z) = 0$.\n2. In iteration $k$:\n   a. Solve the Schrödinger equation using $V_{\\mathrm{H}}^{(k-1)}(z)$ to find $\\varepsilon_n$ and $\\psi_n(z)$.\n   b. Determine the subband occupations $n_n$ by filling the Landau levels.\n   c. Calculate the new electron density $n_e(z)$.\n   d. Solve the Poisson equation to find the resulting potential, $V_{\\mathrm{H, new}}(z)$.\n   e. Update the Hartree potential using linear mixing to ensure stable convergence: $V_{\\mathrm{H}}^{(k)}(z) = (1-\\alpha)V_{\\mathrm{H}}^{(k-1)}(z) + \\alpha V_{\\mathrm{H, new}}(z)$, where $\\alpha$ is a small mixing parameter.\n3. The loop is terminated when the change in the potential between iterations falls below a specified tolerance, e.g., $\\max_z|V_{\\mathrm{H}}^{(k)}(z) - V_{\\mathrm{H}}^{(k-1)}(z)| < \\delta$.\n\nUpon convergence, the final set of occupations $\\{n_n\\}$ is used to identify the subbands that contribute to the total density ($n_n>0$). The number of such subbands $K$ and their $1$-based indices are reported along with the filling factor $\\nu$. The provided code implements this full numerical procedure for the three specified test cases. For the numerical implementation, I use a grid of $N_z=401$ points, compute $N_{sub}=20$ subbands, a mixing parameter $\\alpha=0.1$, and a convergence tolerance of $10^{-6} \\text{ eV}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal, solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the self-consistent Hartree problem for a 2DEG in a wide quantum well\n    under a magnetic field for the given test cases.\n    \"\"\"\n    \n    # Physical Constants (CODATA 2018)\n    e = 1.602176634e-19      # Elementary charge in C\n    m_e = 9.1093837015e-31   # Electron mass in kg\n    h = 6.62607015e-34      # Planck constant in J*s\n    hbar = h / (2 * np.pi)   # Reduced Planck constant in J*s\n    eps0 = 8.8541878128e-12 # Vacuum permittivity in F/m\n\n    # Material Parameters for GaAs\n    m_star = 0.067 * m_e  # Effective mass\n    eps_r = 12.9          # Relative permittivity\n    epsilon = eps_r * eps0 # Permittivity\n\n    # Numerical parameters for the simulation\n    Nz = 401             # Number of grid points (must be odd for centering)\n    Nsub = 20            # Number of subbands to compute\n    Lmax = 20            # Maximum Landau level index to consider\n    alpha = 0.1          # Mixing parameter for SCF\n    tolerance = 1e-6 * e # Convergence tolerance in Joules (1 micro-eV)\n    max_iter = 200       # Maximum SCF iterations\n\n    def run_scf(W, B, Ns):\n        \"\"\"\n        Performs the self-consistent field calculation for a single case.\n        \"\"\"\n        # Discretization of the well from -W/2 to W/2\n        z_grid = np.linspace(-W / 2, W / 2, Nz)\n        dz = z_grid[1] - z_grid[0]\n\n        # Schrödinger equation: Kinetic part setup (tridiagonal matrix)\n        # H = (-hbar^2/2m*) d^2/dz^2 + V(z)\n        diag_kin = np.full(Nz - 2, 2.0)\n        offdiag_kin = np.full(Nz - 3, -1.0)\n        K_factor = -hbar**2 / (2 * m_star * dz**2)\n        \n        # Poisson equation: Laplacian setup (tridiagonal matrix)\n        # solve_banded expects the matrix in a specific banded format.\n        # For a tridiagonal matrix, it's 3 rows: (super-diag, main-diag, sub-diag)\n        A_poisson = np.zeros((3, Nz - 2))\n        A_poisson[0, 1:] = 1.0   # Superdiagonal\n        A_poisson[1, :] = -2.0  # Main diagonal\n        A_poisson[2, :-1] = 1.0  # Subdiagonal\n        \n        # Pre-calculate constants for the current case\n        g_B = e * B / h\n        nu = int(round(Ns / g_B))\n        hbar_wc = e * B / m_star * hbar\n        n_bg_val = Ns / W\n        \n        # SCF iteration loop\n        V_H = np.zeros_like(z_grid)\n        \n        final_occupied_levels = []\n\n        for i in range(max_iter):\n            V_H_old = V_H.copy()\n            \n            # 1. Solve Schrödinger equation for eigenvalues and eigenvectors\n            V_total_internal = V_H[1:-1]\n            main_diag = K_factor * diag_kin + V_total_internal\n            off_diag = K_factor * offdiag_kin\n            \n            eigenvalues, eigenvectors = eigh_tridiagonal(main_diag, off_diag)\n            \n            eps_n = eigenvalues[:Nsub]\n            \n            # Normalize wavefunctions: integral |psi|^2 dz = 1\n            psi_n_unnorm = eigenvectors[:, :Nsub]\n            norm_factor = np.sqrt(np.sum(psi_n_unnorm**2, axis=0) * dz)\n            psi_n_norm = psi_n_unnorm / norm_factor\n            \n            # 2. Populate Landau levels based on energy\n            levels = []\n            for n_idx in range(Nsub):\n                for l_idx in range(Lmax):\n                    E_nl = eps_n[n_idx] + (l_idx + 0.5) * hbar_wc\n                    levels.append({'E': E_nl, 'n': n_idx + 1, 'l': l_idx})\n            \n            levels.sort(key=lambda x: x['E'])\n            occupied_levels = levels[:nu]\n            \n            # 3. Calculate subband densities n_n\n            n_n = np.zeros(Nsub)\n            for level in occupied_levels:\n                n_n[level['n'] - 1] += g_B\n                \n            # 4. Construct total electron density profile n_e(z)\n            n_e = np.zeros_like(z_grid)\n            n_e[1:-1] = np.sum(n_n * np.abs(psi_n_norm)**2, axis=1)\n            \n            # 5. Solve Poisson equation for the new Hartree potential\n            source = (e**2 / epsilon) * (n_bg_val - n_e[1:-1])\n            rhs = source * dz**2\n            V_H_internal = solve_banded((1, 1), A_poisson, rhs)\n            \n            V_H_new = np.zeros_like(z_grid)\n            V_H_new[1:-1] = V_H_internal\n            \n            # 6. Mix potentials and check for convergence\n            V_H = (1 - alpha) * V_H_old + alpha * V_H_new\n            \n            diff = np.max(np.abs(V_H - V_H_old))\n            if diff < tolerance:\n                final_occupied_levels = occupied_levels\n                break\n        else: # If loop finishes without break\n            final_occupied_levels = occupied_levels\n\n        if not final_occupied_levels:\n            final_occupied_levels = occupied_levels\n\n        # After convergence, determine the set of contributing subbands\n        occupied_subband_indices = sorted(list({level['n'] for level in final_occupied_levels}))\n        K = len(occupied_subband_indices)\n        \n        return [nu, K] + occupied_subband_indices\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (W in m, B in T, Ns in m^-2)\n        (30e-9, 8.0, 3.8690469e15),\n        (60e-9, 6.0, 5.8029803e15),\n        (80e-9, 6.0, 8.7044704e15),\n    ]\n\n    results = []\n    for case in test_cases:\n        W, B, Ns = case\n        result = run_scf(W, B, Ns)\n        results.append(result)\n\n    # Final print statement in the exact required format without spaces.\n    output_str = '[' + ','.join([f\"[{','.join(map(str, r))}]\" for r in results]) + ']'\n    print(output_str)\n\nsolve()\n```", "id": "2830254"}]}