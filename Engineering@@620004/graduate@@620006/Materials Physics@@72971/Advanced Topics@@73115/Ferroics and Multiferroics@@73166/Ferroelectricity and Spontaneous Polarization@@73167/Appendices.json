{"hands_on_practices": [{"introduction": "While we often first think of ferroelectrics as being uniformly polarized, in reality they typically form domains to minimize electrostatic and elastic energies. This exercise [@problem_id:2823165] delves into the structure of the domain wall, the interface separating regions of different polarization orientation. Using the Landau-Ginzburg-Devonshire (LGD) continuum theory, you will apply the calculus of variations to derive the classic hyperbolic-tangent polarization profile and the concept of domain wall width, a foundational result that describes how the order parameter varies smoothly in space.", "problem": "Consider a one-dimensional ferroelectric described by the Landau-Ginzburg-Devonshire (LGD) free-energy functional along a Cartesian coordinate $x$,\n$$\n\\mathcal{F}[P]=\\int_{-\\infty}^{+\\infty}\\left[\\frac{g}{2}\\left(\\frac{dP}{dx}\\right)^{2}+\\frac{\\alpha}{2}P^{2}+\\frac{\\beta}{4}P^{4}\\right]\\,dx,\n$$\nwhere $P(x)$ is the polarization order parameter, $g>0$ is the gradient-energy coefficient, and the Landau coefficients satisfy $\\alpha<0$ and $\\beta>0$ at the temperature of interest. Assume a static $180^{\\circ}$ Ising-like domain wall along $x$ that connects the two symmetry-related uniform bulk states as $x\\to\\pm\\infty$, with $P(\\pm\\infty)=\\pm P_{\\mathrm{s}}$, where $P_{\\mathrm{s}}$ is the bulk spontaneous polarization magnitude obtained by minimizing the spatially uniform part of the free-energy density. \n\nStarting only from the variational principle applied to $\\mathcal{F}[P]$ and the stated boundary conditions, determine the exact stationary profile $P(x)$ of the minimum-energy domain wall and an explicit closed-form expression for its characteristic width $\\delta$ defined by\n$$\n\\delta\\equiv \\frac{P_{\\mathrm{s}}}{\\left|\\left.\\frac{dP}{dx}\\right|_{x=0}\\right|}.\n$$\nExpress your final results in terms of $x$, $g$, $\\alpha$, and $\\beta$ only. Your answer must be a closed-form symbolic expression. Do not perform any numerical evaluation. Present both the profile $P(x)$ and the width $\\delta$ as analytic expressions. No rounding is required, and no units are necessary in the final expressions.", "solution": "The problem requires the determination of the stationary polarization profile $P(x)$ for a $180^{\\circ}$ domain wall and its characteristic width $\\delta$ by minimizing the Landau-Ginzburg-Devonshire (LGD) free-energy functional,\n$$\n\\mathcal{F}[P]=\\int_{-\\infty}^{+\\infty}\\left[\\frac{g}{2}\\left(\\frac{dP}{dx}\\right)^{2}+\\frac{\\alpha}{2}P^{2}+\\frac{\\beta}{4}P^{4}\\right]\\,dx.\n$$\nThe parameters are given as $g>0$, $\\alpha<0$, and $\\beta>0$. The analysis will proceed in three stages: first, determination of the bulk spontaneous polarization $P_{\\mathrm{s}}$; second, derivation and solution of the Euler-Lagrange equation for the profile $P(x)$; and third, calculation of the domain wall width $\\delta$.\n\nFirst, we determine the magnitude of the spontaneous polarization, $P_{\\mathrm{s}}$, by minimizing the homogeneous part of the free energy density, $f(P) = \\frac{\\alpha}{2}P^{2}+\\frac{\\beta}{4}P^{4}$. The stationary points are found by setting the first derivative of $f(P)$ with respect to $P$ to zero:\n$$\n\\frac{df}{dP} = \\alpha P + \\beta P^{3} = P(\\alpha + \\beta P^{2}) = 0.\n$$\nThis equation has three real solutions for $P$: $P=0$ and $P=\\pm\\sqrt{-\\frac{\\alpha}{\\beta}}$, since $\\alpha<0$ and $\\beta>0$. To determine which corresponds to a minimum, we examine the second derivative:\n$$\n\\frac{d^{2}f}{dP^{2}} = \\alpha + 3\\beta P^{2}.\n$$\nAt $P=0$, the second derivative is $\\alpha$, which is negative, indicating a local maximum. For $P=\\pm\\sqrt{-\\frac{\\alpha}{\\beta}}$, we have $P^{2}=-\\frac{\\alpha}{\\beta}$, and the second derivative becomes $\\alpha + 3\\beta(-\\frac{\\alpha}{\\beta}) = \\alpha - 3\\alpha = -2\\alpha$. Since $\\alpha<0$, $-2\\alpha$ is positive, indicating that these two states are the degenerate minima. The magnitude of the spontaneous polarization is therefore\n$$\nP_{\\mathrm{s}} = \\sqrt{-\\frac{\\alpha}{\\beta}}.\n$$\nThe boundary conditions for the domain wall are $P(x \\to \\pm\\infty) = \\pm P_{\\mathrm{s}}$.\n\nNext, to find the stationary profile $P(x)$ that minimizes the total free energy functional $\\mathcal{F}[P]$, we apply the calculus of variations. The integrand, $L(P, P') = \\frac{g}{2}(P')^{2}+\\frac{\\alpha}{2}P^{2}+\\frac{\\beta}{4}P^{4}$ with $P' \\equiv \\frac{dP}{dx}$, serves as the Lagrangian density. The Euler-Lagrange equation is\n$$\n\\frac{\\partial L}{\\partial P} - \\frac{d}{dx}\\left(\\frac{\\partial L}{\\partial P'}\\right) = 0.\n$$\nCalculating the partial derivatives, we have $\\frac{\\partial L}{\\partial P} = \\alpha P + \\beta P^{3}$ and $\\frac{\\partial L}{\\partial P'} = gP'$. The Euler-Lagrange equation is thus\n$$\n\\alpha P + \\beta P^{3} - g\\frac{d^{2}P}{dx^{2}} = 0.\n$$\nThis is a second-order nonlinear ordinary differential equation. Since the Lagrangian does not explicitly depend on $x$, there exists a first integral of motion (analogous to conservation of energy), given by the Beltrami identity: $P'\\frac{\\partial L}{\\partial P'} - L = \\text{constant}$.\n$$\nP'(gP') - \\left[\\frac{g}{2}(P')^{2}+\\frac{\\alpha}{2}P^{2}+\\frac{\\beta}{4}P^{4}\\right] = C_{1}.\n$$\n$$\n\\frac{g}{2}(P')^{2} - \\frac{\\alpha}{2}P^{2} - \\frac{\\beta}{4}P^{4} = C_{1}.\n$$\nThe constant $C_{1}$ is determined by the boundary conditions. As $x \\to \\pm\\infty$, the polarization approaches a uniform bulk state, so $P \\to \\pm P_{\\mathrm{s}}$ and its gradient vanishes, $\\frac{dP}{dx} \\to 0$. Substituting these into the first integral:\n$$\nC_{1} = \\frac{g}{2}(0)^{2} - \\frac{\\alpha}{2}P_{\\mathrm{s}}^{2} - \\frac{\\beta}{4}P_{\\mathrm{s}}^{4}.\n$$\nUsing $P_{\\mathrm{s}}^{2} = -\\frac{\\alpha}{\\beta}$, we find\n$$\nC_{1} = -\\frac{\\alpha}{2}\\left(-\\frac{\\alpha}{\\beta}\\right) - \\frac{\\beta}{4}\\left(-\\frac{\\alpha}{\\beta}\\right)^{2} = \\frac{\\alpha^{2}}{2\\beta} - \\frac{\\alpha^{2}}{4\\beta} = \\frac{\\alpha^{2}}{4\\beta}.\n$$\nThe equation for $P(x)$ becomes\n$$\n\\frac{g}{2}\\left(\\frac{dP}{dx}\\right)^{2} = \\frac{\\alpha}{2}P^{2} + \\frac{\\beta}{4}P^{4} + \\frac{\\alpha^{2}}{4\\beta} = \\frac{\\beta}{4}\\left(P^{4} + \\frac{2\\alpha}{\\beta}P^{2} + \\frac{\\alpha^{2}}{\\beta^{2}}\\right).\n$$\nRecognizing that $P_{\\mathrm{s}}^{2} = -\\frac{\\alpha}{\\beta}$, we can rewrite the expression in parentheses as a perfect square:\n$$\n\\frac{g}{2}\\left(\\frac{dP}{dx}\\right)^{2} = \\frac{\\beta}{4}\\left(P^{4} - 2P_{\\mathrm{s}}^{2}P^{2} + P_{\\mathrm{s}}^{4}\\right) = \\frac{\\beta}{4}(P^{2} - P_{\\mathrm{s}}^{2})^{2}.\n$$\nSolving for $\\frac{dP}{dx}$:\n$$\n\\frac{dP}{dx} = \\pm \\sqrt{\\frac{\\beta}{2g}}(P^{2} - P_{\\mathrm{s}}^{2}).\n$$\nFor a domain wall where $P$ increases from $-P_{\\mathrm{s}}$ to $+P_{\\mathrm{s}}$, we must have $\\frac{dP}{dx} > 0$. Since $|P| < P_{\\mathrm{s}}$ within the wall, the term $(P^{2} - P_{\\mathrm{s}}^{2})$ is negative. We therefore must choose the negative sign:\n$$\n\\frac{dP}{dx} = -\\sqrt{\\frac{\\beta}{2g}}(P^{2} - P_{\\mathrm{s}}^{2}) = \\sqrt{\\frac{\\beta}{2g}}(P_{\\mathrm{s}}^{2} - P^{2}).\n$$\nThis is a separable first-order differential equation. We rearrange and integrate:\n$$\n\\int \\frac{dP}{P_{\\mathrm{s}}^{2} - P^{2}} = \\int \\sqrt{\\frac{\\beta}{2g}} dx.\n$$\nThe integral on the left is a standard form, yielding\n$$\n\\frac{1}{P_{\\mathrm{s}}}\\operatorname{arctanh}\\left(\\frac{P}{P_{\\mathrm{s}}}\\right) = x\\sqrt{\\frac{\\beta}{2g}} + C_{2}.\n$$\nWe center the domain wall at $x=0$, which implies the physical condition $P(0)=0$. Substituting this gives $\\operatorname{arctanh}(0) = 0$, so the integration constant $C_{2}=0$. The solution for $P(x)$ is\n$$\nP(x) = P_{\\mathrm{s}}\\tanh\\left(x P_{\\mathrm{s}}\\sqrt{\\frac{\\beta}{2g}}\\right).\n$$\nSubstituting $P_{\\mathrm{s}} = \\sqrt{-\\frac{\\alpha}{\\beta}}$, we obtain the final expression for the profile in terms of the given parameters:\n$$\nP(x) = \\sqrt{-\\frac{\\alpha}{\\beta}}\\tanh\\left(x \\sqrt{-\\frac{\\alpha}{\\beta}}\\sqrt{\\frac{\\beta}{2g}}\\right) = \\sqrt{-\\frac{\\alpha}{\\beta}}\\tanh\\left(x \\sqrt{\\frac{-\\alpha}{2g}}\\right).\n$$\nFinally, we calculate the characteristic domain wall width, $\\delta$, defined as\n$$\n\\delta \\equiv \\frac{P_{\\mathrm{s}}}{\\left|\\left.\\frac{dP}{dx}\\right|_{x=0}\\right|}.\n$$\nFrom our first-order equation, the derivative at $x=0$ (where $P(0)=0$) is\n$$\n\\left.\\frac{dP}{dx}\\right|_{x=0} = \\sqrt{\\frac{\\beta}{2g}}(P_{\\mathrm{s}}^{2} - P(0)^{2}) = P_{\\mathrm{s}}^{2}\\sqrt{\\frac{\\beta}{2g}}.\n$$\nSince $P_s > 0$, the derivative is positive, so the absolute value is redundant. Substituting this into the definition for $\\delta$:\n$$\n\\delta = \\frac{P_{\\mathrm{s}}}{P_{\\mathrm{s}}^{2}\\sqrt{\\frac{\\beta}{2g}}} = \\frac{1}{P_{\\mathrm{s}}\\sqrt{\\frac{\\beta}{2g}}}.\n$$\nNow, substituting $P_{\\mathrm{s}} = \\sqrt{-\\frac{\\alpha}{\\beta}}$:\n$$\n\\delta = \\frac{1}{\\sqrt{-\\frac{\\alpha}{\\beta}}\\sqrt{\\frac{\\beta}{2g}}} = \\frac{1}{\\sqrt{\\frac{-\\alpha\\beta}{2g\\beta}}} = \\frac{1}{\\sqrt{\\frac{-\\alpha}{2g}}} = \\sqrt{\\frac{-2g}{\\alpha}}.\n$$\nThis expression is well-defined because $\\alpha<0$. Both required expressions have now been derived.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{-\\frac{\\alpha}{\\beta}} \\tanh\\left(x \\sqrt{\\frac{-\\alpha}{2g}}\\right) & \\sqrt{\\frac{-2g}{\\alpha}} \\end{pmatrix}}\n$$", "id": "2823165"}, {"introduction": "Having explored the phenomenological description of spatial structures, we now turn to the fundamental quantum mechanical origin of spontaneous polarization. The modern theory of polarization recasts this bulk property as a geometric phase of the electronic wavefunctions, known as the Zak phase in one dimension. This practice [@problem_id:2823117] provides a first-principles calculation of polarization for a simple tight-binding model, revealing its connection to the winding of Bloch states and explaining the concept of the polarization quantum, a cornerstone of modern condensed matter physics.", "problem": "A one-dimensional tight-binding insulator with a basis of two orbitals per unit cell (labeled $A$ and $B$) has lattice constant $a>0$ and Bloch Hamiltonian in the $(A,B)$ basis\n$$\nH(k) \\;=\\; \\begin{pmatrix}\n0 & q(k) \\\\\nq^{\\ast}(k) & 0\n\\end{pmatrix}, \n\\qquad \nq(k) \\;=\\; t_{1} \\;+\\; t_{2}\\,\\exp(- i k a),\n$$\nwith $t_{2} > t_{1} > 0$. Assume the lower (valence) band is fully occupied and the upper (conduction) band is empty, and neglect spin. Using the modern theory of polarization starting from the definition of the Berry connection and Zak phase for the occupied band, compute the reduced polarization per unit cell\n$$\np \\;\\equiv\\; \\frac{P\\,a}{e},\n$$\nwhere $P$ is the bulk polarization and $e$ is the elementary charge. Your computation must proceed from first principles (definitions of Berry connection and Zak phase) and must not assume any topological quantization a priori. Use angles in radians. Express the final value of $p$ as a single exact dimensionless number in the interval $[0,1)$.\n\nThen, justify from the same first principles why $p$ is only well defined modulo an integer under smooth $U(1)$ gauge transformations of the occupied Bloch eigenstates and under changes of the real-space origin (choice of the unit cell). Your final answer must be the single exact value of $p$ as specified above.", "solution": "The primary task is to compute the reduced polarization $p \\equiv \\frac{P a}{e}$, where $P$ is the bulk electric polarization, $a$ is the lattice constant, and $e$ is the elementary charge. The modern theory of polarization relates the bulk polarization to the geometric phase acquired by the Bloch eigenstates of the occupied bands across the Brillouin zone.\n\nIn one dimension, the polarization $P$ is the electric dipole moment per unit length. The dipole moment of a unit cell is determined by the position of the center of charge of the occupied electronic states, described by the Wannier functions. The center of the Wannier function $\\bar{x}$ in the home unit cell for the occupied band is given by the Zak phase, $\\phi_{Zak}$:\n$$\n\\bar{x} = \\frac{a}{2\\pi} \\phi_{Zak}\n$$\nThe Zak phase here is defined as the integral of the Berry connection over the first Brillouin zone (BZ), using a dimensionless wavevector, which makes $\\phi_{Zak}$ a dimensionless quantity. The polarization is thus $P = \\frac{-e \\bar{x}}{a}$, representing the dipole of an electron charge $-e$ at position $\\bar{x}$ relative to the cell origin where the compensating positive charge resides.\n\nThe reduced polarization $p$ is then:\n$$\np = \\frac{P a}{e} = \\frac{(-e \\bar{x} / a) a}{e} = -\\frac{\\bar{x}}{a} = -\\frac{1}{a} \\left(\\frac{a}{2\\pi} \\phi_{Zak}\\right) = -\\frac{\\phi_{Zak}}{2\\pi}\n$$\nOur main task is therefore to calculate the Zak phase for the occupied band.\n\nThe Bloch Hamiltonian is given as:\n$$\nH(k) = \\begin{pmatrix} 0 & q(k) \\\\ q^{\\ast}(k) & 0 \\end{pmatrix}, \\quad \\text{with} \\quad q(k) = t_{1} + t_{2} \\exp(-ika)\n$$\nThe eigenvalues are found from the characteristic equation $\\lambda^2 - |q(k)|^2 = 0$, which gives the energy bands $E_{\\pm}(k) = \\pm |q(k)|$. The condition $t_2 > t_1 > 0$ ensures that $|q(k)|^2 = t_1^2 + t_2^2 + 2t_1 t_2 \\cos(ka) \\ge (t_2 - t_1)^2 > 0$, so the system is a gapped insulator. The occupied valence band corresponds to the lower energy, $E_-(k) = -|q(k)|$.\n\nLet the eigenvector for the valence band be $|u_-(k)\\rangle = (u_A, u_B)^T$. It satisfies $H(k)|u_-(k)\\rangle = E_-(k)|u_-(k)\\rangle$. This yields the relation $q(k) u_B = -|q(k)| u_A$. We can express $q(k)$ in polar form as $q(k) = |q(k)| \\exp(i\\theta(k))$. The relation becomes $\\exp(i\\theta(k)) u_B = -u_A$. A normalized eigenvector can be chosen as:\n$$\n|u_-(k)\\rangle = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -\\exp(-i\\theta(k)) \\end{pmatrix}\n$$\nThis choice of gauge ensures the Bloch function is periodic in the BZ, i.e., $|u_-(k + 2\\pi/a)\\rangle = |u_-(k)\\rangle$, since $q(k)$ is periodic.\n\nThe Zak phase is defined from the Berry connection. Let us define a dimensionless wavevector $\\tilde{k} = ka \\in [-\\pi, \\pi]$. The Berry connection is $\\mathcal{A}(\\tilde{k}) = i \\langle u_-(\\tilde{k}) | \\frac{d}{d\\tilde{k}} | u_-(\\tilde{k}) \\rangle$.\nThe derivative of the state vector is:\n$$\n\\frac{d}{d\\tilde{k}} |u_-(\\tilde{k})\\rangle = \\frac{1}{\\sqrt{2}} \\frac{d}{d\\tilde{k}} \\begin{pmatrix} 1 \\\\ -\\exp(-i\\theta(\\tilde{k})) \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0 \\\\ -(-i \\frac{d\\theta}{d\\tilde{k}}) \\exp(-i\\theta(\\tilde{k})) \\end{pmatrix} = \\frac{i}{\\sqrt{2}} \\frac{d\\theta}{d\\tilde{k}} \\begin{pmatrix} 0 \\\\ \\exp(-i\\theta(\\tilde{k})) \\end{pmatrix}\n$$\nThe Berry connection is then:\n$$\n\\mathcal{A}(\\tilde{k}) = i \\left[ \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & -\\exp(i\\theta(\\tilde{k})) \\end{pmatrix} \\right] \\left[ \\frac{i}{\\sqrt{2}} \\frac{d\\theta}{d\\tilde{k}} \\begin{pmatrix} 0 \\\\ \\exp(-i\\theta(\\tilde{k})) \\end{pmatrix} \\right] = \\frac{i^2}{2} \\frac{d\\theta}{d\\tilde{k}} (-\\exp(i\\theta(\\tilde{k}))\\exp(-i\\theta(\\tilde{k}))) = \\frac{1}{2}\\frac{d\\theta}{d\\tilde{k}}\n$$\nThe Zak phase is the integral of the Berry connection over the one-dimensional BZ:\n$$\n\\phi_{Zak} = \\int_{-\\pi}^{\\pi} \\mathcal{A}(\\tilde{k}) d\\tilde{k} = \\int_{-\\pi}^{\\pi} \\frac{1}{2} \\frac{d\\theta}{d\\tilde{k}} d\\tilde{k} = \\frac{1}{2} [\\theta(\\pi) - \\theta(-\\pi)]\n$$\nThis integral represents half the total change in the phase of $q(k)$ as $\\tilde{k}$ sweeps from $-\\pi$ to $\\pi$. This change is $2\\pi$ times the winding number $W$ of the path traced by $q(k)$ in the complex plane around the origin.\nThe path of $q(\\tilde{k}) = t_1 + t_2 \\exp(-i\\tilde{k})$ is a circle of radius $t_2$ centered at $t_1$ on the real axis. Since $t_2 > t_1 > 0$, the center $t_1$ is closer to the origin than the radius $t_2$, so the origin is enclosed within the circle. As $\\tilde{k}$ increases from $-\\pi$ to $\\pi$, the term $\\exp(-i\\tilde{k})$ traverses the unit circle clockwise. Therefore, the path of $q(\\tilde{k})$ also winds around the origin once in the clockwise direction, giving a winding number $W = -1$.\n\nThe total change in phase is $\\Delta\\theta = 2\\pi W = -2\\pi$.\nThe Zak phase is therefore:\n$$\n\\phi_{Zak} = \\frac{1}{2} (-2\\pi) = -\\pi\n$$\nNow we compute the reduced polarization $p$:\n$$\np = -\\frac{\\phi_{Zak}}{2\\pi} = -\\frac{-\\pi}{2\\pi} = \\frac{1}{2}\n$$\nThis value lies in the required interval $[0,1)$.\n\nFinally, we must justify why $p$ is well-defined only modulo an integer. This arises from two fundamental ambiguities: the choice of gauge for the Bloch functions and the choice of the real-space unit cell origin.\n\n1.  **Gauge Transformation**: The Bloch eigenstates $|u_-(\\tilde{k})\\rangle$ are defined only up to a $U(1)$ phase factor. A new choice of state $|u'_-(\\tilde{k})\\rangle = \\exp(i\\chi(\\tilde{k}))|u_-(\\tilde{k})\\rangle$, where $\\chi(\\tilde{k})$ is a smooth real function, represents the same physical state. Under this transformation, the Berry connection becomes $\\mathcal{A}'(\\tilde{k}) = \\mathcal{A}(\\tilde{k}) - \\frac{d\\chi}{d\\tilde{k}}$. The new Zak phase is $\\phi'_{Zak} = \\phi_{Zak} - [\\chi(\\pi) - \\chi(-\\pi)]$. For $|u'_-(\\tilde{k})\\rangle$ to be a valid periodic part of a Bloch function, the gauge factor $\\exp(i\\chi(\\tilde{k}))$ must be periodic in the reciprocal lattice, i.e., $\\exp(i\\chi(\\tilde{k}+2\\pi)) = \\exp(i\\chi(\\tilde{k}))$. This implies $\\chi(\\tilde{k}+2\\pi) = \\chi(\\tilde{k}) + 2\\pi n$ for some integer $n$. Consequently, $\\chi(\\pi) - \\chi(-\\pi) = 2\\pi n$. The Zak phase changes by an integer multiple of $2\\pi$: $\\phi'_{Zak} = \\phi_{Zak} - 2\\pi n$. The reduced polarization transforms as $p' = -\\frac{\\phi'_{Zak}}{2\\pi} = p + n$. Thus, $p$ is defined only modulo an integer.\n\n2.  **Change of Real-Space Origin**: The bulk polarization is defined relative to the boundaries of a unit cell. Changing the definition of the unit cell, for instance by shifting its origin by a lattice vector $-m a$ (where $m$ is an integer), will change the calculated position of the Wannier center $\\bar{x}$. If the Wannier functions for the original cell choice are $W_n(x) = W(x-na)$, the new choice corresponds to re-indexing so that the Wannier function $W_{n+m}(x)$ is associated with cell $n$. The Wannier function in the new home cell ($n=0$) is $W'_0(x) = W_m(x)=W(x-ma)$. Its center of position is $\\bar{x}' = \\langle W'_0|\\hat{x}|W'_0 \\rangle = \\langle W_0(x-ma) | \\hat{x} | W_0(x-ma) \\rangle = \\langle W_0 | \\hat{x}+ma | W_0 \\rangle = \\bar{x} + ma$. The Wannier center location $\\bar{x}$ is therefore only defined modulo a lattice constant $a$.\nSince $p = -\\bar{x}/a$, a change in $\\bar{x}$ to $\\bar{x}+ma$ results in a new value $p' = -(\\bar{x}+ma)/a = -\\bar{x}/a - m = p - m$. This again shows that the reduced polarization $p$ is only well-defined modulo an integer.\n\nThe calculated value $p=1/2$ is the unique value in the interval $[0,1)$.", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "2823117"}, {"introduction": "A powerful theory must make testable predictions, and the modern theory's most striking prediction is the bulk-boundary correspondence: the bulk Berry phase polarization dictates the amount of bound charge that must appear at a surface. This hands-on computational exercise [@problem_id:2823123] guides you through a numerical workflow to verify this principle, mirroring the methods used in state-of-the-art Density Functional Theory ($DFT$) calculations. By comparing the bulk Berry phase result with the surface charge calculated for a finite slab, you will gain a practical understanding of this profound connection between bulk topology and boundary physics.", "problem": "Consider a first-principles workflow for computing spontaneous polarization in an insulating crystal using the Berry-phase formalism and verifying consistency with the surface bound charge in a slab geometry. The core physical principles to be used are: (i) the definition of polarization in solids as a bulk geometric phase of occupied Bloch states over the Brillouin zone, modulo a polarization quantum, and (ii) the relation between bulk polarization and surface bound charge from classical electrodynamics stating that the bound surface charge equals the polarization flux through the surface. Your goal is to instantiate this workflow in a minimal tight-binding system that captures the same geometric structure as a full Density Functional Theory (DFT) calculation and to test its internal consistency numerically.\n\nUse the one-dimensional Rice–Mele model, which is a two-band, two-site-per-cell tight-binding model that captures a prototypical ferroelectric chain. Let the unit cell contain sublattices $A$ and $B$ with on-site energies $+\\Delta$ and $-\\Delta$, respectively. Let the intracell hopping amplitude be $t_{1} = t - \\delta$ and the intercell hopping amplitude be $t_{2} = t + \\delta$. The Bloch Hamiltonian in the $(A,B)$ basis at crystal momentum $k$ is\n$$\nH(k) = \\begin{pmatrix}\n\\Delta & t_{1} + t_{2} e^{-ika} \\\\\nt_{1} + t_{2} e^{ika} & -\\Delta\n\\end{pmatrix},\n$$\nwhere $a$ is the lattice constant. Assume spinless electrons and one electron per unit cell, so that the lower (valence) band is completely filled in the insulating regime.\n\nThe spontaneous polarization to be computed follows the modern theory of polarization based on the Berry phase of the occupied valence band over the Brillouin zone. Because polarization is only defined modulo a quantum, adopt the protocol used in first-principles workflows: choose an adiabatic path from a centrosymmetric nonpolar reference structure to the target polar structure that avoids closing the energy gap, and track the continuous branch of the Berry phase along this path to produce a physically meaningful difference. For the Rice–Mele model with fixed $\\Delta \\neq 0$, take the nonpolar reference at $\\delta = 0$ as the centrosymmetric state; this ensures the path in parameter space $(\\delta)$ from $\\delta = 0$ to a target $\\delta$ remains insulating. The reduced polarization, expressed as an end charge per termination, is the scalar quantity that directly predicts the bound charge at a surface of a one-dimensional slab when the termination cuts between unit cells, consistent with the chosen Bloch convention.\n\nVerification step: build a finite open-boundary slab of $N$ unit cells (hence $2N$ sites), fill the $N$ lowest-energy single-particle states (half filling), compute the electronic charge distribution, and determine the bound charge at the left end by subtracting a uniform positive background of $+e/2$ on each site (to mimic ionic neutrality of $+e$ per cell) and summing the excess electronic charge over the left half of the slab. In the insulating regime, the integrated end charge must agree with the bulk reduced polarization predicted from the Berry phase, up to negligible finite-size and discretization errors.\n\nTasks to implement in a single program:\n1. Compute the Berry phase of the occupied valence band over the Brillouin zone by discretizing $k$ uniformly and evaluating the geometric phase of the cell-periodic Bloch eigenvectors of $H(k)$. Convert this Berry phase into a reduced spontaneous polarization (an end charge per termination) by choosing the branch continuously connected to the reference at $\\delta = 0$ with fixed $\\Delta$.\n2. Construct a finite Rice–Mele chain with open boundaries for a given number of unit cells $N$, diagonalize the Hamiltonian, fill the valence states, and compute the left-end bound charge by subtracting a uniform background of $+e/2$ per site and summing over the left half of the chain.\n3. For each test case below, report the absolute difference between the Berry-phase-reduced spontaneous polarization (interpreted as an end charge per termination) and the left-end bound charge from the slab model. Express the difference in Coulombs ($C$) as a floating-point number.\n\nUse the elementary charge $e = 1.602176634 \\times 10^{-19}\\,C$. Angles and wavevectors should be treated in radians. You may choose any sufficiently fine $k$-point mesh and slab size $N$ necessary for numerical convergence, but you must use the specific $N$ values given below for the slab.\n\nTest suite (each tuple is $(t, \\delta, \\Delta, a, N)$):\n- Case 1 (general polar state): $(1.0, 0.3, 0.2, 4.0 \\times 10^{-10}\\,\\text{m}, 200)$.\n- Case 2 (opposite polarization state): $(1.0, -0.3, 0.2, 4.0 \\times 10^{-10}\\,\\text{m}, 200)$.\n- Case 3 (near-centrosymmetric, small gap but insulating): $(1.0, 0.3, 1.0 \\times 10^{-3}, 4.0 \\times 10^{-10}\\,\\text{m}, 300)$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test cases, for example, \"[x1,x2,x3]\". Each $x_i$ must be the absolute difference in Coulombs ($C$) for the corresponding test case.", "solution": "The problem requires a numerical verification of the bulk-boundary correspondence for electric polarization within the framework of the one-dimensional Rice-Mele model. The core task is to compute the spontaneous polarization using two distinct but theoretically equivalent methods and compare their results. The first method calculates the bulk polarization from the Berry phase of the occupied Bloch states. The second method computes the bound charge that accumulates at the surface of a finite slab. The consistency between these two results provides a stringent test of the modern theory of polarization.\n\nThe procedure is as follows:\n$1$. The bulk spontaneous polarization is determined by calculating the Berry phase of the valence band along an adiabatic path connecting a non-polar, centrosymmetric reference state to the target polar state.\n$2$. The surface bound charge is computed by direct diagonalization of a large, finite slab with open boundaries, followed by summing the net electronic charge over one half of the slab.\n$3$. The absolute difference between the polarization charge predicted by the bulk calculation and the surface charge from the slab calculation is reported for the specified test cases.\n\nLet us detail the theoretical and numerical implementation for each method.\n\n**1. Bulk Polarization from Berry Phase**\n\nThe electronic structure of the infinite one-dimensional chain is described by the Bloch Hamiltonian, which is a $2 \\times 2$ matrix for each crystal momentum $k$. To simplify the notation, we introduce the dimensionless wavevector $k' = ka$, where $a$ is the lattice constant. The Brillouin Zone (BZ) for $k'$ spans from $0$ to $2\\pi$. The Hamiltonian is given by:\n$$\nH(k') =\n\\begin{pmatrix}\n\\Delta & t_{1} + t_{2} e^{-ik'} \\\\\nt_{1} + t_{2} e^{ik'} & -\\Delta\n\\end{pmatrix}\n$$\nwhere $t_{1} = t - \\delta$ and $t_{2} = t + \\delta$. This Hamiltonian is Hermitian for any real parameters $t, \\delta, \\Delta$ and wavevector $k'$. Its eigenvalues are $E_{\\pm}(k') = \\pm \\sqrt{\\Delta^2 + |t_1 + t_2 e^{-ik'}|^2}$. For the system to be insulating, the energy gap $E_g = \\min(2|E_{\\pm}(k')|)$ must be non-zero for all $k'$. This condition is met as long as $\\Delta$ and the hopping terms do not simultaneously vanish at some $k'$.\n\nWith one electron per unit cell, the lower band (valence band), corresponding to the eigenvalue $E_{-}(k')$, is completely filled. Let $|u_{k'}\\rangle$ be the corresponding cell-periodic part of the Bloch eigenvector. The electronic polarization is related to the Berry phase of this state integrated over the BZ. The change in polarization along an adiabatic path is given by the change in the Berry phase. We compute the spontaneous polarization $P_{sp}$ by taking the centrosymmetric state with $\\delta=0$ as the reference. For this reference state ($\\delta=0, \\Delta \\neq 0$), the polarization is zero. Therefore, the spontaneous polarization of the target state is simply its total Berry-phase polarization.\n\nThe reduced polarization $Q_{BP}$, which corresponds to the end charge, is given by:\n$$\nQ_{BP} = \\frac{e}{2\\pi} \\gamma\n$$\nwhere $\\gamma$ is the Berry phase of the occupied band. For a numerical calculation, the BZ is discretized into $M$ uniform steps $k'_j = j(2\\pi/M)$ for $j=0, \\dots, M-1$. The Berry phase is then computed using the formula:\n$$\n\\gamma = \\mathrm{Im} \\left[ \\ln \\left( \\prod_{j=0}^{M-1} \\langle u_{k'_j} | u_{k'_{j+1}} \\rangle \\right) \\right]\n$$\nwhere $k'_{M} \\equiv k'_0$ due to periodicity. This formulation is numerically stable and gauge-invariant.\n\n**2. Surface Bound Charge from Finite Slab Calculation**\n\nTo verify the bulk prediction, we construct a finite chain (a slab) of $N$ unit cells, which contains a total of $2N$ atomic sites. We impose open boundary conditions, meaning there is no hopping out of the ends of the chain. The tight-binding Hamiltonian $H_{\\text{slab}}$ for this finite system is a $2N \\times 2N$ real symmetric matrix. In the basis ordered as $(A_1, B_1, A_2, B_2, \\dots A_N, B_N)$, the non-zero elements are:\n- On-site energies: $(H_{\\text{slab}})_{2i-1, 2i-1} = \\Delta$ and $(H_{\\text{slab}})_{2i, 2i} = -\\Delta$ for $i=1, \\dots, N$.\n- Intracell hopping: $(H_{\\text{slab}})_{2i-1, 2i} = (H_{\\text{slab}})_{2i, 2i-1} = t_1$ for $i=1, \\dots, N$.\n- Intercell hopping: $(H_{\\text{slab}})_{2i, 2i+1} = (H_{\\text{slab}})_{2i+1, 2i} = t_2$ for $i=1, \\dots, N-1$.\n\nWe find the $2N$ single-particle eigenstates $|\\psi_j\\rangle$ and energies by diagonalizing $H_{\\text{slab}}$. Since the system has $N$ electrons (one per cell), the ground state is formed by filling the $N$ eigenstates with the lowest energies. The electronic charge density at each site $i$ (where $i=1, \\dots, 2N$) is calculated by summing the probabilities from all occupied states:\n$$\nn_i = \\sum_{j=1}^{N} |\\langle i | \\psi_j \\rangle|^2\n$$\nThe problem states that a uniform positive background charge of $+e/2$ per site maintains overall charge neutrality. The net charge at site $i$ is thus $q_i = e/2 - e \\cdot n_i$. The total bound charge at one end of the slab is obtained by summing these net charges over half of the chain. We define the left-end charge $Q_{\\text{slab}}$ as the sum over the first $N$ sites (corresponding to the first $N/2$ cells):\n$$\nQ_{\\text{slab}} = \\sum_{i=1}^{N} q_i = e \\left( \\frac{N}{2} - \\sum_{i=1}^{N} n_i \\right)\n$$\nIn the limit of a large slab ($N \\to \\infty$), the value of $Q_{\\text{slab}}$ is expected to converge to the bulk polarization charge $Q_{BP}$.\n\n**3. Numerical Verification**\n\nFor each set of parameters $(t, \\delta, \\Delta, a, N)$ provided in the test suite, we compute both $Q_{BP}$ and $Q_{\\text{slab}}$. The elementary charge is $e = 1.602176634 \\times 10^{-19}\\,C$. A sufficiently fine $k$-point mesh ($M=4000$) is used for the Berry phase calculation to ensure convergence. The absolute difference $|Q_{BP} - Q_{\\text{slab}}|$ is then calculated and reported in units of Coulombs ($C$). The lattice constant $a$ is not required for the calculation of the dimensionless reduced polarization values, as both methods compute a total charge, not a charge density.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the absolute difference between the Berry-phase polarization and \n    the slab-model surface charge for the Rice-Mele model.\n    \"\"\"\n    # Define physical constants and test cases.\n    e_charge = 1.602176634e-19\n    test_cases = [\n        # (t, delta, Delta, a, N)\n        (1.0, 0.3, 0.2, 4.0e-10, 200),\n        (1.0, -0.3, 0.2, 4.0e-10, 200),\n        (1.0, 0.3, 1.0e-3, 4.0e-10, 300),\n    ]\n\n    results = []\n    # A sufficiently fine k-point mesh is necessary for numerical convergence.\n    M_k_points = 4000\n\n    for case in test_cases:\n        t, delta, Delta, a, N = case\n        \n        # ----------- Part 1: Berry Phase Polarization Calculation -----------\n        \n        t1 = t - delta\n        t2 = t + delta\n        \n        # Discretize the Brillouin Zone for k' = ka from 0 to 2*pi\n        k_mesh = np.linspace(0, 2 * np.pi, M_k_points, endpoint=False)\n        # Store eigenvectors of the lower (valence) band\n        u_vals = np.zeros((M_k_points, 2), dtype=np.complex128)\n        \n        for i, k_prime in enumerate(k_mesh):\n            # Define the Bloch Hamiltonian H(k')\n            off_diag = t1 + t2 * np.exp(-1j * k_prime)\n            H_k = np.array([[Delta, off_diag], [np.conj(off_diag), -Delta]], dtype=np.complex128)\n            \n            # Diagonalize the Hermitian matrix. `eigh` sorts eigenvalues, so the\n            # first eigenvector corresponds to the lowest energy (valence band).\n            eigvals, eigvecs = np.linalg.eigh(H_k)\n            u_vals[i, :] = eigvecs[:, 0]\n            \n        # Compute the product of overlaps <u_k|u_{k+dk}> along the k-path.\n        # np.roll provides the periodic shift for u_{k+dk}.\n        u_next = np.roll(u_vals, -1, axis=0)\n        overlaps = np.einsum('ij,ij->i', np.conj(u_vals), u_next)\n        \n        # The Berry phase is the argument of the total product of overlaps.\n        berry_phase = np.angle(np.prod(overlaps))\n        \n        # The reduced polarization (end charge) in units of `e`, is related to the Berry phase.\n        # The value is taken from the branch continuously connected to the delta=0 state (P=0).\n        pol_BP_reduced = berry_phase / (2 * np.pi)\n\n        # ----------- Part 2: Slab Calculation for Bound Surface Charge -----------\n        \n        # Construct the 2N x 2N real symmetric Hamiltonian for the finite slab.\n        H_slab = np.zeros((2 * N, 2 * N), dtype=np.float64)\n        \n        for i in range(N):\n            # On-site energies (diagonal elements)\n            H_slab[2 * i, 2 * i] = Delta      # A-site\n            H_slab[2 * i + 1, 2 * i + 1] = -Delta # B-site\n            \n            # Intracell hopping t1 (within cell i)\n            H_slab[2 * i, 2 * i + 1] = t1\n            H_slab[2 * i + 1, 2 * i] = t1\n            \n            # Intercell hopping t2 (between cell i and i+1), with open boundaries\n            if i < N - 1:\n                H_slab[2 * i + 1, 2 * i + 2] = t2\n                H_slab[2 * i + 2, 2 * i + 1] = t2\n                \n        # Diagonalize the slab Hamiltonian.\n        slab_eigvals, slab_eigvecs = np.linalg.eigh(H_slab)\n        \n        # Fill the N lowest energy states (N electrons in total).\n        occupied_vecs = slab_eigvecs[:, :N]\n        \n        # Compute electron probability density n_i at each of the 2N sites.\n        n_density = np.sum(np.square(occupied_vecs), axis=1)\n        \n        # Calculate the total bound charge on the left half of the slab (first N sites).\n        # Site charge is q_i = e/2 - e*n_i. The sum gives the total end charge.\n        # Calculation is done in units of elementary charge `e`.\n        sum_n_left_half = np.sum(n_density[:N])\n        pol_slab_reduced = (N / 2.0 - sum_n_left_half)\n        \n        # ----------- Part 3: Compute Absolute Difference -----------\n        \n        # Calculate the difference between the two methods, in units of e.\n        abs_diff_in_e = abs(pol_BP_reduced - pol_slab_reduced)\n        \n        # Convert the final result to Coulombs.\n        abs_diff_in_C = abs_diff_in_e * e_charge\n        \n        results.append(abs_diff_in_C)\n\n    # Print the final results in the exact required format.\n    print(f\"[{','.join(f'{r:.10e}' for r in results)}]\")\n\nsolve()\n```", "id": "2823123"}]}