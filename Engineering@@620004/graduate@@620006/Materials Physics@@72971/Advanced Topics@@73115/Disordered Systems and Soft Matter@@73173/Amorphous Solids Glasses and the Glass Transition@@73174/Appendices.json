{"hands_on_practices": [{"introduction": "Unlike crystals, amorphous solids lack long-range periodic order, which presents a fundamental challenge: how do we quantitatively describe their structure? This practice introduces Voronoi tessellation, a powerful geometric method for partitioning space and unambiguously defining the local environment and coordination number of each atom in a disordered packing. By analyzing the population of different Voronoi polyhedra in a model metallic glass, you will connect the microscopic structural details to a critical macroscopic property, the packing fraction. [@problem_id:2799722]", "problem": "A monatomic metallic glass exhibits a distribution of local atomic environments characterized by Voronoi indices. For an atom, the Voronoi index is written as $\\langle n_{3}, n_{4}, n_{5}, n_{6} \\rangle$, where $n_{k}$ is the number of Voronoi faces with $k$ edges. The coordination number is, by definition, the total number of faces on the Voronoi polyhedron.\n\nConsider the following five most populated motifs and their populations in the sample:\n- $\\langle 0,0,12,0 \\rangle$ with fraction $f_{1} = 0.42$,\n- $\\langle 0,1,10,2 \\rangle$ with fraction $f_{2} = 0.18$,\n- $\\langle 0,2,8,2 \\rangle$ with fraction $f_{3} = 0.15$,\n- $\\langle 0,3,6,0 \\rangle$ with fraction $f_{4} = 0.12$,\n- $\\langle 0,0,10,2 \\rangle$ with fraction $f_{5} = 0.13$.\n\nIndependent structural analysis indicates that, for equal-sized atoms of radius $r$, the mean Voronoi cell volumes for atoms in each of these motifs, measured in units of the single-atom volume $v_{\\mathrm{atom}} = \\frac{4}{3} \\pi r^{3}$, are:\n- $V_{1} = 1.52 \\, v_{\\mathrm{atom}}$,\n- $V_{2} = 1.58 \\, v_{\\mathrm{atom}}$,\n- $V_{3} = 1.56 \\, v_{\\mathrm{atom}}$,\n- $V_{4} = 1.72 \\, v_{\\mathrm{atom}}$,\n- $V_{5} = 1.54 \\, v_{\\mathrm{atom}}$.\n\nStarting from first principles, do the following:\n1. Using the definition of coordination number for a Voronoi polyhedron, compute the sample’s average coordination number.\n2. Using the definition of packing fraction as the fraction of space occupied by atoms and the interpretation of a Voronoi tessellation as a space-filling partition that assigns a unique volume per atom, derive an expression for the macroscopic packing fraction in terms of the motif fractions, the motif-resolved Voronoi volumes, and $v_{\\mathrm{atom}}$. Evaluate this expression numerically for the given data.\n\nReport only the packing fraction as your final answer, expressed as a dimensionless decimal and rounded to four significant figures.", "solution": "The problem requires an analysis of the structural properties of a monatomic metallic glass, specifically the calculation of its average coordination number and macroscopic packing fraction, based on a given distribution of local atomic environments described by Voronoi indices.\n\nFirst, a validation of the problem statement is necessary.\n\n**Step 1: Extract Givens**\n- **Voronoi Index:** $\\langle n_{3}, n_{4}, n_{5}, n_{6} \\rangle$, where $n_k$ is the number of Voronoi faces with $k$ edges.\n- **Coordination Number ($CN$):** Defined as the total number of faces of the Voronoi polyhedron, so $CN = \\sum_k n_k$.\n- **Motif Populations:**\n  - Motif 1: $\\langle 0,0,12,0 \\rangle$, fraction $f_{1} = 0.42$\n  - Motif 2: $\\langle 0,1,10,2 \\rangle$, fraction $f_{2} = 0.18$\n  - Motif 3: $\\langle 0,2,8,2 \\rangle$, fraction $f_{3} = 0.15$\n  - Motif 4: $\\langle 0,3,6,0 \\rangle$, fraction $f_{4} = 0.12$\n  - Motif 5: $\\langle 0,0,10,2 \\rangle$, fraction $f_{5} = 0.13$\n- **Single-atom volume:** $v_{\\mathrm{atom}} = \\frac{4}{3} \\pi r^{3}$ for an atom of radius $r$.\n- **Mean Voronoi Cell Volumes ($V_i$):**\n  - $V_{1} = 1.52 \\, v_{\\mathrm{atom}}$\n  - $V_{2} = 1.58 \\, v_{\\mathrm{atom}}$\n  - $V_{3} = 1.56 \\, v_{\\mathrm{atom}}$\n  - $V_{4} = 1.72 \\, v_{\\mathrm{atom}}$\n  - $V_{5} = 1.54 \\, v_{\\mathrm{atom}}$\n- **Packing Fraction ($\\phi$):** Defined as the fraction of space occupied by atoms.\n- **Tasks:**\n  1. Compute the average coordination number, $\\overline{CN}$.\n  2. Derive an expression for and evaluate the macroscopic packing fraction, $\\phi$.\n- **Final Answer:** Report only the numerical value of the packing fraction, rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, employing standard concepts from materials physics such as Voronoi analysis for characterizing amorphous structures. The data provided are consistent; the sum of the motif fractions is $f_1+f_2+f_3+f_4+f_5 = 0.42 + 0.18 + 0.15 + 0.12 + 0.13 = 1.00$, making the problem self-contained. The provided Voronoi indices correspond to known, stable polyhedra (e.g., $\\langle 0,0,12,0 \\rangle$ is the icosahedron). The definitions are clear and unambiguous. The problem is well-posed and objective.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be formulated.\n\nThe solution proceeds in two parts as requested, although only the result of the second part constitutes the final answer.\n\n**Part 1: Average Coordination Number**\n\nThe coordination number, $CN_i$, for an atom in motif $i$ is the sum of the integers in its Voronoi index, $CN_i = n_3 + n_4 + n_5 + n_6$.\nFor each motif:\n- $CN_1$ for $\\langle 0,0,12,0 \\rangle$ is $0+0+12+0 = 12$.\n- $CN_2$ for $\\langle 0,1,10,2 \\rangle$ is $0+1+10+2 = 13$.\n- $CN_3$ for $\\langle 0,2,8,2 \\rangle$ is $0+2+8+2 = 12$.\n- $CN_4$ for $\\langle 0,3,6,0 \\rangle$ is $0+3+6+0 = 9$.\n- $CN_5$ for $\\langle 0,0,10,2 \\rangle$ is $0+0+10+2 = 12$.\n\nThe sample's average coordination number, $\\overline{CN}$, is the weighted average of the individual coordination numbers, where the weights are the motif fractions $f_i$:\n$$\n\\overline{CN} = \\sum_{i=1}^{5} f_i CN_i\n$$\nSubstituting the given values:\n$$\n\\overline{CN} = (0.42)(12) + (0.18)(13) + (0.15)(12) + (0.12)(9) + (0.13)(12)\n$$\n$$\n\\overline{CN} = 5.04 + 2.34 + 1.80 + 1.08 + 1.56 = 11.82\n$$\nThis result is physically reasonable for a dense metallic glass. However, it is not the requested final answer.\n\n**Part 2: Macroscopic Packing Fraction**\n\nThe macroscopic packing fraction, $\\phi$, is defined as the total volume occupied by the atoms divided by the total volume of the system.\n$$\n\\phi = \\frac{V_{\\text{atoms}}}{V_{\\text{total}}}\n$$\nConsider a system containing a large number $N$ of atoms. The total volume of atoms is $V_{\\text{atoms}} = N \\cdot v_{\\mathrm{atom}}$, as all atoms are identical.\nThe Voronoi tessellation partitions the total system volume into $N$ cells, one for each atom. The total volume is the sum of the volumes of these cells. This sum can be grouped by motif type. The number of atoms of motif type $i$ is $N_i = f_i N$. The average volume of a Voronoi cell for motif $i$ is $V_i$. Thus, the total volume of the system is:\n$$\nV_{\\text{total}} = \\sum_{i=1}^{5} N_i V_i = \\sum_{i=1}^{5} (f_i N) V_i = N \\sum_{i=1}^{5} f_i V_i\n$$\nThe packing fraction is then:\n$$\n\\phi = \\frac{N \\cdot v_{\\mathrm{atom}}}{N \\sum_{i=1}^{5} f_i V_i} = \\frac{v_{\\mathrm{atom}}}{\\sum_{i=1}^{5} f_i V_i}\n$$\nThe problem provides the mean Voronoi cell volumes in units of the single-atom volume, i.e., $V_i = c_i v_{\\mathrm{atom}}$, where $c_i$ are the given dimensionless constants ($c_1=1.52$, $c_2=1.58$, etc.). Substituting this into the expression for $\\phi$:\n$$\n\\phi = \\frac{v_{\\mathrm{atom}}}{\\sum_{i=1}^{5} f_i (c_i v_{\\mathrm{atom}})} = \\frac{v_{\\mathrm{atom}}}{v_{\\mathrm{atom}} \\sum_{i=1}^{5} f_i c_i} = \\frac{1}{\\sum_{i=1}^{5} f_i c_i}\n$$\nThis is the derived analytical expression. The packing fraction is the reciprocal of the average Voronoi cell volume expressed in units of $v_{\\mathrm{atom}}$.\n\nNow, we evaluate this expression numerically. The denominator is the average dimensionless volume, $\\bar{c}$.\n$$\n\\bar{c} = \\sum_{i=1}^{5} f_i c_i = f_1 c_1 + f_2 c_2 + f_3 c_3 + f_4 c_4 + f_5 c_5\n$$\nSubstituting the given values:\n$$\n\\bar{c} = (0.42)(1.52) + (0.18)(1.58) + (0.15)(1.56) + (0.12)(1.72) + (0.13)(1.54)\n$$\n$$\n\\bar{c} = 0.6384 + 0.2844 + 0.2340 + 0.2064 + 0.2002 = 1.5634\n$$\nThe packing fraction is the reciprocal of this value:\n$$\n\\phi = \\frac{1}{1.5634} \\approx 0.63963157...\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\phi \\approx 0.6396\n$$\nThis value is consistent with the typical packing fraction for dense random packing of spheres.", "answer": "$$\\boxed{0.6396}$$", "id": "2799722"}, {"introduction": "Beyond local geometry, the connectivity of the atomic network governs the mechanical properties of a glass. This exercise introduces Topological Constraint Theory, an elegant framework that predicts the rigidity of a covalent network simply by counting the number of mechanical constraints (from bond lengths and angles) and comparing them to the available atomic degrees of freedom. You will apply these counting rules to a specific chalcogenide glass composition to determine if the network is flexible, stressed-rigid, or at the special 'isostatic' point, providing a direct link between chemical composition and mechanical stability. [@problem_id:2799773]", "problem": "Consider a macroscopically homogeneous, chemically ordered chalcogenide glass in the germanium–arsenic–selenium system with composition by atomic fraction $\\mathrm{Ge}_{0.17}\\mathrm{As}_{0.19}\\mathrm{Se}_{0.64}$. Assume a fully polymerized, three-dimensional covalent network in the large-$N$ limit, with no dangling bonds and no redundant ring constraints. Use the octet ($8-N$) rule to assign the local coordinations: germanium is fourfold ($r_{\\mathrm{Ge}}=4$), arsenic is threefold ($r_{\\mathrm{As}}=3$), and selenium is twofold ($r_{\\mathrm{Se}}=2$). Assume that all central-force bond-stretching and bond-bending interactions are intact and independent.\n\nUsing Topological Constraint Theory (TCT), start from Maxwell counting of degrees of freedom and constraints in $3$ dimensions to determine from first principles:\n- the number of bond-stretching constraints per atom, $n_s$,\n- the number of bond-bending constraints per atom, $n_b$,\n- and the total number of constraints per atom, $n_c=n_s+n_b$,\n\nfor this composition. Based on your $n_c$ value, state whether the network is flexible, isostatic, or stressed-rigid, using the criterion that in $3$ dimensions mechanical isostaticity occurs when the number of constraints per atom equals the number of translational degrees of freedom per atom.\n\nProvide as your final answer only the total constraint count per atom $n_c$ as a single dimensionless number. Round your final answer to $4$ significant figures.", "solution": "The problem statement is first subjected to validation.\n\nStep 1: Extract Givens.\n- System: Macroscopically homogeneous, chemically ordered chalcogenide glass in the germanium–arsenic–selenium system.\n- Composition: Atomic fractions are $\\mathrm{Ge}_{x}\\mathrm{As}_{y}\\mathrm{Se}_{z}$ with $x=0.17$, $y=0.19$, and $z=0.64$.\n- Network Assumptions: Fully polymerized, three-dimensional ($d=3$) covalent network in the large-$N$ limit, with no dangling bonds and no redundant ring constraints.\n- Coordination Numbers: From the octet ($8-N$) rule, $r_{\\mathrm{Ge}}=4$, $r_{\\mathrm{As}}=3$, and $r_{\\mathrm{Se}}=2$.\n- Interactions: All central-force bond-stretching and bond-bending interactions are intact and independent.\n- Theoretical Framework: Topological Constraint Theory (TCT) using Maxwell counting.\n- Objective: Determine the number of bond-stretching constraints per atom ($n_s$), bond-bending constraints per atom ($n_b$), and total constraints per atom ($n_c$), and classify the network's rigidity.\n- Isostaticity Criterion: Mechanical isostaticity in $3$ dimensions occurs when $n_c=3$.\n\nStep 2: Validate Using Extracted Givens.\n- The problem is scientifically grounded. It concerns the application of Topological Constraint Theory, a standard and well-established model in condensed matter physics for describing the properties of amorphous networks like chalcogenide glasses. The composition and coordination rules are standard for this class of materials.\n- The problem is well-posed and self-contained. It provides all necessary parameters (atomic fractions, coordination numbers, dimensionality) to perform the calculations. The objectives are clear and unambiguous.\n- The problem is objective. The language is precise and quantitative, free of any speculative or subjective claims.\n- The sum of atomic fractions is $0.17 + 0.19 + 0.64 = 1.00$, confirming a consistent composition.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid as it is scientifically sound, well-posed, objective, and complete. A rigorous solution can be constructed.\n\nThe fundamental principle of Topological Constraint Theory is the comparison of the number of mechanical constraints per atom, $n_c$, with the number of translational degrees of freedom per atom, $d$. For the specified three-dimensional network, $d=3$. The stability of the network is determined by the sign of the difference $d - n_c$.\n\nThe first step is to compute the average coordination number of the network, denoted $\\langle r \\rangle$. This is the weighted average of the coordination numbers of the constituent atoms, where the weights are their atomic fractions.\nGiven the composition $\\mathrm{Ge}_{0.17}\\mathrm{As}_{0.19}\\mathrm{Se}_{0.64}$ and the coordination numbers $r_{\\mathrm{Ge}}=4$, $r_{\\mathrm{As}}=3$, and $r_{\\mathrm{Se}}=2$, the average coordination number is:\n$$\n\\langle r \\rangle = x \\cdot r_{\\mathrm{Ge}} + y \\cdot r_{\\mathrm{As}} + z \\cdot r_{\\mathrm{Se}}\n$$\nSubstituting the given values:\n$$\n\\langle r \\rangle = (0.17)(4) + (0.19)(3) + (0.64)(2) = 0.68 + 0.57 + 1.28 = 2.53\n$$\n\nNext, we determine the number of constraints per atom, which is the sum of bond-stretching and bond-bending constraints per atom, $n_c = n_s + n_b$.\n\nThe number of bond-stretching constraints per atom, $n_s$, is determined from the number of bonds. In a network of $N$ atoms, the total number of bonds is $\\frac{1}{2} N \\langle r \\rangle$, since each bond connects two atoms. As each bond represents a single central-force constraint, the number of stretching constraints per atom is:\n$$\nn_s = \\frac{\\frac{1}{2} N \\langle r \\rangle}{N} = \\frac{\\langle r \\rangle}{2}\n$$\nUsing the calculated value for $\\langle r \\rangle$:\n$$\nn_s = \\frac{2.53}{2} = 1.265\n$$\n\nThe number of bond-bending constraints per atom, $n_b$, arises from the angular constraints at each atom. For a central atom of coordination $r_i \\geq 2$ in $d=3$ dimensions, there are $2r_i - 3$ independent bond-bending constraints. Atoms with $r_i < 2$ do not contribute to bending constraints. In this problem, all atomic species have $r_i \\geq 2$. The total number of bond-bending constraints per atom is the compositional average:\n$$\nn_b = \\sum_{i} x_i (2r_i - 3) = x(2r_{\\mathrm{Ge}} - 3) + y(2r_{\\mathrm{As}} - 3) + z(2r_{\\mathrm{Se}} - 3)\n$$\nThis expression can be simplified in terms of the average coordination number:\n$$\nn_b = 2 \\left( \\sum_{i} x_i r_i \\right) - 3 \\left( \\sum_{i} x_i \\right) = 2\\langle r \\rangle - 3\n$$\nSubstituting the value for $\\langle r \\rangle$:\n$$\nn_b = 2(2.53) - 3 = 5.06 - 3 = 2.06\n$$\n\nThe total number of constraints per atom, $n_c$, is the sum of the stretching and bending constraints:\n$$\nn_c = n_s + n_b = \\frac{\\langle r \\rangle}{2} + (2\\langle r \\rangle - 3) = \\frac{5}{2}\\langle r \\rangle - 3\n$$\nUsing the calculated values:\n$$\nn_c = 1.265 + 2.06 = 3.325\n$$\nAlternatively, using the final formula:\n$$\nn_c = \\frac{5}{2}(2.53) - 3 = 6.325 - 3 = 3.325\n$$\nThe results are consistent.\n\nFinally, we classify the network based on the Maxwell criterion for isostaticity in $d=3$ dimensions, which occurs when $n_c = d = 3$.\n- If $n_c < 3$, the network is flexible (underconstrained).\n- If $n_c = 3$, the network is isostatic (optimally constrained).\n- If $n_c > 3$, the network is stressed-rigid (overconstrained).\n\nIn this case, we have found that $n_c = 3.325$. Since $n_c > 3$, the network is classified as stressed-rigid.\n\nThe problem asks for the total constraint count per atom, $n_c$, as a single dimensionless number rounded to $4$ significant figures. The calculated value is $3.325$, which is already presented with $4$ significant figures.", "answer": "$$\\boxed{3.325}$$", "id": "2799773"}, {"introduction": "The defining characteristic of the glass transition is the dramatic and non-Arrhenius slowing down of structural relaxation upon cooling. This hands-on problem delves into the kinetics of this transition by using the Williams-Landel-Ferry (WLF) equation, a cornerstone empirical model for the viscoelastic behavior of polymers. You will fit this model to hypothetical experimental data and then use the results to derive and calculate the dynamic fragility index, $m$, a key parameter that quantifies how rapidly a material's dynamics slow as it approaches the glass transition temperature, $T_g$. [@problem_id:2799721]", "problem": "Consider a polymeric glass former characterized by the principle of time-temperature superposition (TTS), for which the horizontal shift factor $a_T$ connects the temperature dependence of viscoelastic response functions. Near the glass transition, a widely used empirical relation for the base-$10$ logarithm of the shift factor is the Williams–Landel–Ferry (WLF) equation, which expresses the temperature dependence of $a_T$ about a reference temperature $T_{\\mathrm{ref}}$ through two material-specific constants $C_1$ and $C_2$. The dynamic fragility index $m$ quantifies the steepness of the temperature dependence of the characteristic relaxation time (or viscosity) at the glass transition temperature $T_g$, and is defined as the slope of $\\log_{10}$ of the relaxation time with respect to $T_g/T$ evaluated at $T=T_g$.\n\nStarting from the definitions above and treating the WLF equation as a well-tested empirical law for polymers near the glass transition, write a program that, for each test case below, performs the following tasks:\n\n- Using nonlinear least squares, fit the WLF parameters $C_1$ and $C_2$ to the provided measured values of $\\log_{10} a_T$ as a function of temperature $T$ about a specified reference temperature $T_{\\mathrm{ref}}$.\n- From the fitted parameters and the definition of the fragility index $m$ as the slope of $\\log_{10}$ of the characteristic time with respect to $T_g/T$ at $T=T_g$, derive and compute $m$ using calculus and the WLF fit. Assume that the measured $\\log_{10} a_T$ captures the temperature dependence of the characteristic time through TTS such that the slope of $\\log_{10} a_T$ controls the fragility.\n- Return $m$ as a floating-point number for each test case.\n\nAll temperatures must be treated and reported in kelvin, i.e., $\\mathrm{K}$. The fragility index $m$ is dimensionless. Your program should compute $m$ for each test case and report the results rounded to three decimal places.\n\nTest suite (each case provides $T_{\\mathrm{ref}}$, $T_g$, a list of temperatures $T_i$ in $\\mathrm{K}$, and measured $\\log_{10} a_T(T_i)$):\n\n- Case A (happy path; moderate data spread with small experimental noise):\n  - $T_{\\mathrm{ref}} = 373\\,\\mathrm{K}$, $T_g = 373\\,\\mathrm{K}$.\n  - Temperatures: $[353,363,373,383,393]\\,\\mathrm{K}$.\n  - Measured $\\log_{10} a_T$: $[11.058,4.182,0.000,-2.821,-4.893]$.\n- Case B (stronger glass former; lower fragility; small experimental noise):\n  - $T_{\\mathrm{ref}} = 323\\,\\mathrm{K}$, $T_g = 323\\,\\mathrm{K}$.\n  - Temperatures: $[303,313,323,333,343]\\,\\mathrm{K}$.\n  - Measured $\\log_{10} a_T$: $[4.970,2.020,0.000,-1.439,-2.470]$.\n- Case C (coverage of $T_{\\mathrm{ref}} \\neq T_g$; exact WLF-consistent data):\n  - $T_{\\mathrm{ref}} = 333\\,\\mathrm{K}$, $T_g = 348\\,\\mathrm{K}$.\n  - Temperatures: $[313,323,333,343,353]\\,\\mathrm{K}$.\n  - Measured $\\log_{10} a_T$: $[5.000,2.142857,0.000,-1.666667,-3.000]$.\n\nAlgorithmic requirements:\n\n- Use a nonlinear least-squares fit to estimate $C_1$ and $C_2$ from the data $\\{(T_i, \\log_{10} a_T(T_i))\\}$ for each case, with $C_1>0$ and $C_2>0$ constraints.\n- Derive $m$ from the definition $m = \\left.\\dfrac{d \\log_{10} \\tau(T)}{d \\left(T_g/T\\right)}\\right|_{T=T_g}$, where by TTS one may take $\\tau(T) \\propto a_T(T)$ up to a temperature-independent multiplicative constant near $T_g$. Use the WLF-based fit to evaluate this derivative at $T=T_g$.\n\nOutput requirements:\n\n- Express $m$ as dimensionless floats rounded to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[m_{\\mathrm{A}}, m_{\\mathrm{B}}, m_{\\mathrm{C}}]$.\n\nNo user input is required; the program must be fully self-contained and must use the test suite above exactly as written.", "solution": "The problem as stated is subjected to validation against established scientific and mathematical principles. It is found to be valid. The problem is scientifically grounded in the established physics of amorphous materials, it is well-posed, unambiguous, and provides all necessary information for a unique solution. We may therefore proceed with a formal solution.\n\nThe objective is to compute the dynamic fragility index, $m$, for a polymeric glass former, given its viscoelastic response data. The solution is predicated on two key concepts: the Williams–Landel–Ferry (WLF) equation and the definition of fragility.\n\nThe WLF equation describes the temperature dependence of the viscoelastic shift factor, $a_T$, relative to a reference temperature $T_{\\mathrm{ref}}$:\n$$ \\log_{10} a_T(T) = -\\frac{C_1 (T - T_{\\mathrm{ref}})}{C_2 + (T - T_{\\mathrm{ref}})} $$\nHere, $C_1$ and $C_2$ are positive material constants.\n\nThe dynamic fragility index, $m$, is defined as the steepness of the relaxation dynamics at the glass transition temperature, $T_g$:\n$$ m = \\left. \\frac{d (\\log_{10} \\tau)}{d (T_g/T)} \\right|_{T=T_g} $$\nwhere $\\tau(T)$ is the characteristic structural relaxation time. The problem posits that the principle of time-temperature superposition (TTS) applies, which relates $\\tau(T)$ to the shift factor $a_T$ via $\\tau(T) = \\tau(T_{\\mathrm{ref}}) a_T(T)$. Consequently, $\\log_{10} \\tau(T) = \\log_{10} \\tau(T_{\\mathrm{ref}}) + \\log_{10} a_T(T)$. Since $\\tau(T_{\\mathrm{ref}})$ is a constant, the derivative of $\\log_{10} \\tau(T)$ with respect to any variable is identical to the derivative of $\\log_{10} a_T(T)$. The definition of $m$ can thus be rewritten in terms of $a_T$:\n$$ m = \\left. \\frac{d (\\log_{10} a_T)}{d (T_g/T)} \\right|_{T=T_g} $$\nTo derive an analytical expression for $m$, we apply the chain rule. Let $f(T) = \\log_{10} a_T(T)$ and $x(T) = T_g/T$. We seek to evaluate $df/dx$ at $T=T_g$.\n$$ \\frac{df}{dx} = \\frac{df/dT}{dx/dT} $$\nFirst, we compute the derivative of $f(T)$ with respect to temperature $T$, using the WLF equation and the quotient rule for differentiation:\n$$ \\frac{df}{dT} = \\frac{d}{dT} \\left( -\\frac{C_1 (T - T_{\\mathrm{ref}})}{C_2 + (T - T_{\\mathrm{ref}})} \\right) = -C_1 \\left[ \\frac{(1)(C_2 + T - T_{\\mathrm{ref}}) - (T - T_{\\mathrm{ref}})(1)}{(C_2 + T - T_{\\mathrm{ref}})^2} \\right] $$\n$$ \\frac{df}{dT} = -\\frac{C_1 C_2}{(C_2 + T - T_{\\mathrm{ref}})^2} $$\nSecond, we compute the derivative of $x(T)$ with respect to temperature $T$:\n$$ \\frac{dx}{dT} = \\frac{d}{dT} \\left( \\frac{T_g}{T} \\right) = -\\frac{T_g}{T^2} $$\nCombining these results, we find the expression for the slope:\n$$ \\frac{df}{dx} = \\frac{-C_1 C_2 / (C_2 + T - T_{\\mathrm{ref}})^2}{-T_g / T^2} = \\frac{C_1 C_2 T^2}{T_g (C_2 + T - T_{\\mathrm{ref}})^2} $$\nTo find the fragility $m$, we evaluate this expression at $T = T_g$:\n$$ m = \\left. \\frac{df}{dx} \\right|_{T=T_g} = \\frac{C_1 C_2 T_g^2}{T_g (C_2 + T_g - T_{\\mathrm{ref}})^2} $$\nThis simplifies to the final analytical formula for the fragility index based on the WLF parameters:\n$$ m = \\frac{C_1 C_2 T_g}{(C_2 + T_g - T_{\\mathrm{ref}})^2} $$\nA special case arises when the reference temperature is chosen to be the glass transition temperature, i.e., $T_{\\mathrm{ref}} = T_g$. The formula simplifies to:\n$$ m = \\frac{C_1 C_2 T_g}{(C_2)^2} = \\frac{C_1 T_g}{C_2} $$\n\nThe computational procedure involves two steps for each test case:\n$1$. Fit the WLF parameters $C_1$ and $C_2$ to the provided experimental data pairs $(T_i, \\log_{10} a_T(T_i))$. This is a nonlinear regression problem, which is solved using a least-squares algorithm. The constraints $C_1 > 0$ and $C_2 > 0$ must be enforced, as they are physically mandated.\n$2$. Substitute the fitted parameters $C_1$ and $C_2$, along with the given $T_g$ and $T_{\\mathrm{ref}}$, into the derived analytical expression for $m$ to compute the fragility index.\n\nThe provided program implements this procedure. For each case, it defines the WLF model as a function and utilizes the `scipy.optimize.curve_fit` routine to perform the nonlinear least-squares fit. The bounds parameter is used to enforce the positivity of $C_1$ and $C_2$. The resulting optimal parameters are then used to calculate $m$. The final results are rounded to three decimal places and formatted as required.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Fits WLF parameters to viscoelastic data and computes the fragility index.\n    \"\"\"\n    test_cases = [\n        {\n            \"id\": \"A\",\n            \"T_ref\": 373.0,\n            \"T_g\": 373.0,\n            \"T_data\": np.array([353.0, 363.0, 373.0, 383.0, 393.0]),\n            \"log_aT_data\": np.array([11.058, 4.182, 0.000, -2.821, -4.893])\n        },\n        {\n            \"id\": \"B\",\n            \"T_ref\": 323.0,\n            \"T_g\": 323.0,\n            \"T_data\": np.array([303.0, 313.0, 323.0, 333.0, 343.0]),\n            \"log_aT_data\": np.array([4.970, 2.020, 0.000, -1.439, -2.470])\n        },\n        {\n            \"id\": \"C\",\n            \"T_ref\": 333.0,\n            \"T_g\": 348.0,\n            \"T_data\": np.array([313.0, 323.0, 333.0, 343.0, 353.0]),\n            \"log_aT_data\": np.array([5.000, 2.142857, 0.000, -1.666667, -3.000])\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        T_ref = case[\"T_ref\"]\n        T_g = case[\"T_g\"]\n        T_data = case[\"T_data\"]\n        log_aT_data = case[\"log_aT_data\"]\n        \n        # Define the WLF model function. T_ref is captured from the outer scope.\n        def wlf_model(T, C1, C2):\n            \"\"\"Williams-Landel-Ferry (WLF) equation.\"\"\"\n            return -C1 * (T - T_ref) / (C2 + (T - T_ref))\n\n        # Initial guess for the parameters [C1, C2].\n        # These are typical values for many polymers.\n        initial_guess = [10.0, 50.0]\n        \n        # Define bounds for the parameters, C1 > 0 and C2 > 0.\n        bounds = ([0, 0], [np.inf, np.inf])\n\n        # Perform nonlinear least-squares fitting.\n        try:\n            popt, _ = curve_fit(\n                wlf_model,\n                T_data,\n                log_aT_data,\n                p0=initial_guess,\n                bounds=bounds\n            )\n        except RuntimeError:\n            # If fit fails, append a placeholder and continue.\n            # This is for robustness, though not expected for the given test cases.\n            results.append(float('nan'))\n            continue\n\n        C1_fit, C2_fit = popt\n\n        # Derived formula for fragility index m:\n        # m = (C1 * C2 * T_g) / (C2 + T_g - T_ref)^2\n        numerator = C1_fit * C2_fit * T_g\n        denominator = (C2_fit + T_g - T_ref)**2\n        \n        fragility_m = numerator / denominator\n\n        results.append(fragility_m)\n\n    # Format the results for final output\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2799721"}]}