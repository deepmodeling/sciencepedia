{"hands_on_practices": [{"introduction": "The most fundamental relationship in Scanning Tunneling Microscopy (STM) is the exponential decay of the tunneling current $I$ with tip-sample separation $z$. This remarkable sensitivity is governed by the \"apparent barrier height\" $\\phi_{\\mathrm{app}}$, a parameter closely related to the work functions of the tip and sample. This exercise [@problem_id:2856462] provides hands-on practice in extracting this key parameter from simulated experimental data using the Wentzel–Kramers–Brillouin (WKB) approximation. You will also explore the important correction needed to account for the trapezoidal nature of the barrier at finite bias, solidifying your understanding of the quantum mechanical foundations of STM.", "problem": "A Scanning Tunneling Microscopy (STM) experiment measures the distance dependence of the tunneling current between a metallic tip and a metallic sample at low temperature. The measured logarithmic slope of the current with respect to tip-sample separation is $\\partial_{z} \\ln I = -20\\,\\mathrm{nm}^{-1}$ at a sample bias of $V = 100\\,\\mathrm{mV}$. Assume an electron of free-electron mass $m_{e}$ tunnels through a vacuum barrier and neglect image-potential and density-of-states variations.\n\nStarting from the one-dimensional Wentzel–Kramers–Brillouin (WKB) approximation for tunneling through a classically forbidden region, use the exponential distance dependence of the tunneling transmission to derive the relation between the slope $\\partial_{z} \\ln I$ and an apparent barrier height $\\phi_{\\mathrm{app}}$ in the low-bias, rectangular-barrier limit. Then compute $\\phi_{\\mathrm{app}}$.\n\nNext, consider that a finite bias $V$ produces a trapezoidal vacuum barrier between two identical metals (symmetric electrodes). Using a first-order treatment in the small parameter $e|V|/\\phi$ that is consistent with the WKB picture, show how the finite bias modifies the effective barrier height inferred from $\\partial_{z}\\ln I$ and use this to estimate a corrected work-function-equivalent barrier height $\\phi_{\\mathrm{corr}}$ from the measured slope at $V = 100\\,\\mathrm{mV}$.\n\nExpress both $\\phi_{\\mathrm{app}}$ and $\\phi_{\\mathrm{corr}}$ in $\\mathrm{eV}$ and round your answers to four significant figures. Use $m_{e}$ for the electron mass, $\\hbar$ for the reduced Planck constant, and $e$ for the elementary charge. Treat $V$ as positive in the energy drop $e|V|$ across the vacuum.", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. It represents a standard analysis of scanning tunneling microscopy data within a simplified but instructive theoretical framework. We shall proceed with the derivation and computation as requested.\n\nThe foundation of our analysis is the one-dimensional Wentzel–Kramers–Brillouin (WKB) approximation for the transmission probability $T$ of a particle with mass $m_e$ and energy $E$ tunneling through a potential barrier $U(x)$ extending from $x=x_1$ to $x=x_2$:\n$$ T \\approx \\exp\\left( -2 \\int_{x_1}^{x_2} \\sqrt{\\frac{2m_e (U(x)-E)}{\\hbar^2}} \\, dx \\right) $$\nThe tunneling current $I$ is proportional to this transmission probability, $I \\propto T$. Therefore, the logarithm of the current is related to the WKB exponent:\n$$ \\ln I = C - 2 \\int_{x_1}^{x_2} \\sqrt{\\frac{2m_e (U(x)-E)}{\\hbar^2}} \\, dx $$\nwhere $C$ is a constant independent of the tip-sample separation $z$. The derivative of $\\ln I$ with respect to $z$ will thus depend on the derivative of this integral.\n\nFirst, we analyze the low-bias limit, where the applied voltage $V \\to 0$. In this limit, the potential barrier between the metallic tip and sample is a simple rectangular barrier of width $z$ (the tip-sample separation) and height $\\phi$. The electrons tunneling are those at the Fermi energy $E_F$. We can set $E=E_F=0$ as our energy reference. The potential barrier is then $U(x) = \\phi$ for $0 \\le x \\le z$. The problem defines the barrier height inferred in this limit as the \"apparent barrier height,\" $\\phi_{\\mathrm{app}}$.\n\nThe WKB integral becomes:\n$$ \\int_{0}^{z} \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} \\, dx = z \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} $$\nSubstituting this into the expression for $\\ln I$:\n$$ \\ln I = C - 2z \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} $$\nThe logarithmic slope of the current with respect to separation $z$ is the derivative:\n$$ \\frac{\\partial \\ln I}{\\partial z} = -2 \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} $$\nThis is the requested relation between the slope and the apparent barrier height. The problem provides the measured value of this slope, which we denote as $S = \\partial_{z} \\ln I = -20\\,\\mathrm{nm}^{-1}$. We can now solve for $\\phi_{\\mathrm{app}}$:\n$$ S = -2 \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} $$\n$$ S^2 = 4 \\left( \\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2} \\right) = \\frac{8m_e \\phi_{\\mathrm{app}}}{\\hbar^2} $$\n$$ \\phi_{\\mathrm{app}} = \\frac{\\hbar^2 S^2}{8m_e} $$\nTo compute the numerical value, we use the given slope $S = -20\\,\\mathrm{nm}^{-1} = -2 \\times 10^{10}\\,\\mathrm{m}^{-1}$, along with the fundamental constants for the reduced Planck constant $\\hbar$ and the electron mass $m_e$:\n$$ \\phi_{\\mathrm{app}} = \\frac{(1.05457 \\times 10^{-34}\\,\\mathrm{J}\\cdot\\mathrm{s})^2 (-2 \\times 10^{10}\\,\\mathrm{m}^{-1})^2}{8 (9.10938 \\times 10^{-31}\\,\\mathrm{kg})} \\approx 6.1043 \\times 10^{-19}\\,\\mathrm{J} $$\nTo express this in electron-volts ($\\mathrm{eV}$), we divide by the elementary charge $e$:\n$$ \\phi_{\\mathrm{app}} (\\mathrm{eV}) = \\frac{6.1043 \\times 10^{-19}\\,\\mathrm{J}}{1.60218 \\times 10^{-19}\\,\\mathrm{C}} \\approx 3.8100\\,\\mathrm{eV} $$\nRounding to four significant figures, $\\phi_{\\mathrm{app}} = 3.810\\,\\mathrm{eV}$.\n\nNext, we consider the effect of a finite bias voltage $V$. For two identical metals with work function $\\phi_{\\mathrm{corr}}$, a bias $V$ applied to the sample creates a trapezoidal potential barrier. The potential energy of an electron in the gap is approximately linear:\n$$ U(x) = \\phi_{\\mathrm{corr}} - \\frac{eV}{z}x \\quad \\text{for } 0 \\le x \\le z $$\nHere, $\\phi_{\\mathrm{corr}}$ is the true, bias-independent work-function-equivalent barrier height we wish to find. We again evaluate the tunneling exponent for an electron at the tip's Fermi level ($E=0$). The WKB integral is now:\n$$ \\int_{0}^{z} \\sqrt{\\frac{2m_e}{\\hbar^2} \\left( \\phi_{\\mathrm{corr}} - \\frac{eV}{z}x \\right)} \\, dx = \\sqrt{\\frac{2m_e\\phi_{\\mathrm{corr}}}{\\hbar^2}} \\int_{0}^{z} \\sqrt{1 - \\frac{eV}{\\phi_{\\mathrm{corr}} z}x} \\, dx $$\nThe problem specifies a first-order treatment in the small parameter $e|V|/\\phi_{\\mathrm{corr}}$. We use the Taylor expansion $\\sqrt{1-u} \\approx 1 - u/2$ for small $u$:\n$$ \\sqrt{1 - \\frac{eV}{\\phi_{\\mathrm{corr}} z}x} \\approx 1 - \\frac{1}{2}\\frac{eV}{\\phi_{\\mathrm{corr}} z}x $$\nThe integral becomes:\n$$ \\int_{0}^{z} \\left(1 - \\frac{eV}{2\\phi_{\\mathrm{corr}} z}x\\right) \\, dx = \\left[ x - \\frac{eV}{4\\phi_{\\mathrm{corr}} z}x^2 \\right]_{0}^{z} = z - \\frac{eV z^2}{4\\phi_{\\mathrm{corr}} z} = z \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) $$\nSubstituting this back, the full tunneling exponent is modified. The logarithm of the current is:\n$$ \\ln I \\approx C - 2 \\sqrt{\\frac{2m_e\\phi_{\\mathrm{corr}}}{\\hbar^2}} \\cdot z \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) $$\nThe measured slope $S$ at finite bias $V$ is the derivative with respect to $z$, holding $V$ constant:\n$$ S = \\frac{\\partial \\ln I}{\\partial z} = -2\\sqrt{\\frac{2m_e\\phi_{\\mathrm{corr}}}{\\hbar^2}} \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) $$\nThis expression shows how the finite bias modifies the slope. To relate this to the apparent barrier height $\\phi_{\\mathrm{app}}$, we equate the two expressions for $S$:\n$$ -2 \\sqrt{\\frac{2m_e\\phi_{\\mathrm{app}}}{\\hbar^2}} = -2\\sqrt{\\frac{2m_e\\phi_{\\mathrm{corr}}}{\\hbar^2}} \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) $$\n$$ \\sqrt{\\phi_{\\mathrm{app}}} = \\sqrt{\\phi_{\\mathrm{corr}}} \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) $$\nSquaring both sides and keeping terms up to first order in $V$:\n$$ \\phi_{\\mathrm{app}} = \\phi_{\\mathrm{corr}} \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right)^2 \\approx \\phi_{\\mathrm{corr}} \\left(1 - 2\\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) = \\phi_{\\mathrm{corr}} \\left(1 - \\frac{eV}{2\\phi_{\\mathrm{corr}}}\\right) $$\n$$ \\phi_{\\mathrm{app}} \\approx \\phi_{\\mathrm{corr}} - \\frac{eV}{2} $$\nThis result shows that the apparent barrier height measured at a finite bias $V$ is lower than the true barrier height $\\phi_{\\mathrm{corr}}$ by approximately $eV/2$. We can now solve for the corrected barrier height:\n$$ \\phi_{\\mathrm{corr}} \\approx \\phi_{\\mathrm{app}} + \\frac{eV}{2} $$\nUsing the given bias $V=100\\,\\mathrm{mV} = 0.1\\,\\mathrm{V}$, the correction term is $\\frac{eV}{2} = \\frac{e(0.1\\,\\mathrm{V})}{2} = 0.05\\,\\mathrm{eV}$.\n$$ \\phi_{\\mathrm{corr}} \\approx 3.8100\\,\\mathrm{eV} + 0.05\\,\\mathrm{eV} = 3.8600\\,\\mathrm{eV} $$\nRounding to four significant figures, $\\phi_{\\mathrm{corr}} = 3.860\\,\\mathrm{eV}$.\nThe two requested values are $\\phi_{\\mathrm{app}}$ and $\\phi_{\\mathrm{corr}}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.810 & 3.860\n\\end{pmatrix}\n}\n$$", "id": "2856462"}, {"introduction": "An STM image is not a simple photograph of a surface's geometric topography; it is a sophisticated map of the sample's local density of states (LDOS). This practice [@problem_id:2856448] delves into this crucial concept by presenting a classic experimental scenario of \"contrast inversion,\" where the apparent atomic heights change dramatically upon reversing the bias voltage. By systematically analyzing the provided topographic and spectroscopic evidence, you will develop the critical skill of disentangling true electronic structure from geometric features and experimental artifacts, a core competency in surface science.", "problem": "An ultra-high vacuum, low-temperature Scanning Tunneling Microscopy (STM) and Scanning Tunneling Spectroscopy (STS) experiment is performed on a binary compound surface with two crystallographically inequivalent atomic sites, labeled site $\\mathrm{A}$ and site $\\mathrm{B}$. The temperature is $T = 4\\,\\mathrm{K}$. Constant-current topographs are acquired at sample biases $V = +0.8\\,\\mathrm{V}$ and $V = -0.8\\,\\mathrm{V}$ with setpoints $I_{\\mathrm{sp}} = 0.5\\,\\mathrm{nA}$ and apparent barrier height near $\\phi \\approx 4\\,\\mathrm{eV}$. The tip-sample separation is on the order of $5\\,\\text{\\AA}$.\n\nThe following robust observations are made:\n1) Upon reversing the bias polarity from $V = +0.8\\,\\mathrm{V}$ to $V = -0.8\\,\\mathrm{V}$, the atomic contrast inverts: the sites that appear bright at $+0.8\\,\\mathrm{V}$ appear dark at $-0.8\\,\\mathrm{V}$, and vice versa.\n2) Spatially resolved STS $dI/dV$ spectra, averaged over many unit cells, show a pronounced peak localized on site $\\mathrm{B}$ at $E - E_{\\mathrm{F}} \\approx +0.6\\,\\mathrm{eV}$ and a pronounced peak localized on site $\\mathrm{A}$ at $E - E_{\\mathrm{F}} \\approx -0.9\\,\\mathrm{eV}$. Away from these energies the spectra are relatively featureless over the window $[-1.5\\,\\mathrm{eV}, +1.5\\,\\mathrm{eV}]$.\n3) Varying the setpoint over $I_{\\mathrm{sp}} \\in [0.1\\,\\mathrm{nA}, 2.0\\,\\mathrm{nA}]$ does not change the sense of the contrast inversion, only the corrugation amplitude.\n4) The same inversion behavior is observed with several independently prepared tungsten tips. Imaging a reference Au$(111)$ surface with the same tips yields the expected bias-symmetric atomic corrugation and Shockley surface state features, without bias-induced contrast inversions, suggesting a predominantly $s$-like apex.\n5) Constant-height $dI/dV$ maps at $E - E_{\\mathrm{F}} = +0.6\\,\\mathrm{eV}$ are bright on site $\\mathrm{B}$ and at $E - E_{\\mathrm{F}} = -0.9\\,\\mathrm{eV}$ are bright on site $\\mathrm{A}$.\n\nUsing only fundamental tunneling theory (overlap of tip and sample wave functions across a barrier), the role of orbital symmetry in tunneling matrix elements, and the energy selection implied by bias polarity (occupied versus unoccupied states), decide which of the following explanations is most consistent with the observations. Select the best-supported option.\n\nA) The contrast inversion primarily reflects an asymmetry of the sample’s local density of states (LDOS) between occupied and unoccupied energies on the two sites, consistent with an approximately $s$-wave tip apex; bias reversal selects different sample states with distinct spatial character.\n\nB) The contrast inversion requires a change in the dominant orbital symmetry of the tip states with bias polarity; an energy-dependent switch between $s$-like and higher angular momentum tip states in the tip density of states produces inversion even if the sample LDOS is symmetric.\n\nC) The contrast inversion is most likely a feedback artifact arising from the exponential distance dependence of the tunneling current in constant-current mode and does not carry information about the LDOS.\n\nD) The contrast inversion is due to a reversal in the sign of the tunneling matrix element upon switching the bias polarity, independent of the LDOS distribution on the sample.", "solution": "The problem will be validated before a solution is attempted.\n\n### Step 1: Extract Givens\n- **System:** Binary compound surface with two crystallographically inequivalent atomic sites, site $\\mathrm{A}$ and site $\\mathrm{B}$.\n- **Experimental Conditions:** Ultra-high vacuum (UHV), low-temperature Scanning Tunneling Microscopy (STM) and Scanning Tunneling Spectroscopy (STS).\n- **Temperature:** $T = 4\\,\\mathrm{K}$.\n- **STM Mode:** Constant-current topography.\n- **Imaging Biases:** $V = +0.8\\,\\mathrm{V}$ and $V = -0.8\\,\\mathrm{V}$.\n- **Setpoint Current:** $I_{\\mathrm{sp}} = 0.5\\,\\mathrm{nA}$, variable over $[0.1\\,\\mathrm{nA}, 2.0\\,\\mathrm{nA}]$.\n- **Apparent Barrier Height:** $\\phi \\approx 4\\,\\mathrm{eV}$.\n- **Tip-Sample Separation:** Order of $5\\,\\text{\\AA}$.\n- **Observation 1:** Atomic contrast inverts upon reversing bias polarity from $+0.8\\,\\mathrm{V}$ to $-0.8\\,\\mathrm{V}$.\n- **Observation 2:** Spatially resolved STS $dI/dV$ spectra show a peak on site $\\mathrm{B}$ at $E - E_{\\mathrm{F}} \\approx +0.6\\,\\mathrm{eV}$ and a peak on site $\\mathrm{A}$ at $E - E_{\\mathrm{F}} \\approx -0.9\\,\\mathrm{eV}$. Spectra are \"relatively featureless\" over $[-1.5\\,\\mathrm{eV}, +1.5\\,\\mathrm{eV}]$ away from these peaks.\n- **Observation 3:** Varying $I_{\\mathrm{sp}}$ does not change the sense of the contrast inversion.\n- **Observation 4:** The inversion is observed with multiple tungsten tips. The same tips on a Au$(111)$ reference surface show no inversion and expected electronic features, suggesting a predominantly $s$-like tip apex.\n- **Observation 5:** Constant-height $dI/dV$ maps at $E - E_{\\mathrm{F}} = +0.6\\,\\mathrm{eV}$ are bright on site $\\mathrm{B}$, and at $E - E_{\\mathrm{F}} = -0.9\\,\\mathrm{eV}$ are bright on site $\\mathrm{A}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a realistic experimental scenario in surface science using STM and STS.\n- **Scientifically Grounded:** The setup and observations are standard in the field. Contrast inversion due to electronic structure is a well-documented phenomenon. The described values for temperature, bias, current, and barrier height are typical.\n- **Well-Posed:** The problem provides a set of consistent observations and asks for the most plausible physical explanation among a set of choices. It is structured to test the understanding of fundamental STM/STS theory.\n- **Objective:** The language is precise and quantitative. Observations are presented as \"robust,\" implying experimental fact.\n- **Completeness and Consistency:** The data are internally consistent. Observation 1 (topographic inversion) is explained by Observations 2 and 5 (spectroscopic asymmetry). Observation 4 provides a crucial control experiment that isolates the origin of the phenomenon to the sample, not the tip. Observation 3 confirms the effect is not a trivial feedback artifact. There are no contradictions. The fact that the imaging bias for occupied states ($V = -0.8\\,\\mathrm{V}$) does not precisely match the peak energy on site $\\mathrm{A}$ ($E - E_{\\mathrm{F}} \\approx -0.9\\,\\mathrm{eV}$) is not a flaw; it requires a correct physical interpretation of how constant-current images are formed from an integral of the density of states, accounting for peak broadening.\n\n### Step 3: Verdict and Action\nThe problem statement is valid, scientifically sound, and internally consistent. A solution can be derived from first principles.\n\n### Solution Derivation\nThe tunneling current $I$ in an STM, at low temperature, depends on the electronic structure of both the tip and the sample. For a bias voltage $V$ applied to the sample, the current is approximately proportional to the integral of the product of the tip's density of states, $\\rho_t(E)$, and the sample's local density of states (LDOS), $\\rho_s(\\vec{r}, E)$, over the energy window opened by the bias. For an idealized metallic tip with a constant density of states near its Fermi level $E_{\\mathrm{F},t}$ and a spherically symmetric $s$-wave apex state, the differential conductance $dI/dV$ at a position $\\vec{r}$ is directly proportional to the sample's LDOS at the corresponding energy:\n$$\n\\frac{dI}{dV}(\\vec{r}, V) \\propto \\rho_s(\\vec{r}, E = E_{\\mathrm{F}} + eV)\n$$\nHere, $E_{\\mathrm{F}}$ is the sample's Fermi level. STS spectra ($dI/dV$ vs. $V$) therefore map the LDOS of the sample.\n\nA constant-current topographic image, $z(x,y)$, is a map of the tip height required to maintain a constant tunneling current $I_{\\mathrm{sp}}$ at a fixed bias $V$. The current has an exponential dependence on the tip height $z$ and the integrated LDOS. For a given position $(x,y)$, a higher integrated LDOS means a larger current would flow at a fixed height. To maintain constant current, the feedback loop retracts the tip to a larger height $z$. Therefore, \"bright\" features in a topographic image correspond to regions of higher integrated LDOS.\n\n- For positive sample bias ($V > 0$), electrons tunnel from tip to sample. The current is an integral over the sample's *unoccupied* states from $E_{\\mathrm{F}}$ to $E_{\\mathrm{F}} + eV$:\n$$\nI(\\vec{r}, V>0) \\propto \\int_{E_{\\mathrm{F}}}^{E_{\\mathrm{F}}+eV} \\rho_s(\\vec{r}, E) dE\n$$\n- For negative sample bias ($V < 0$), electrons tunnel from sample to tip. The current is an integral over the sample's *occupied* states from $E_{\\mathrm{F}} + eV$ to $E_{\\mathrm{F}}$:\n$$\nI(\\vec{r}, V<0) \\propto \\int_{E_{\\mathrm{F}}+eV}^{E_{\\mathrm{F}}} \\rho_s(\\vec{r}, E) dE\n$$\n\nNow we apply these principles to the observations.\n\n1.  **Tip Characterization (Observation 4):** The experiments on a Au$(111)$ reference surface establish that the tungsten tips behave as simple, metallic probes with a dominant $s$-wave character. This means the tip's electronic structure is not strongly featured and its contribution to contrast is primarily its spherical symmetry. This allows us to attribute the observed phenomena to the sample's electronic properties.\n\n2.  **Spectroscopic Information (Observations 2 and 5):**\n    - The STS spectra show a peak in the LDOS on site $\\mathrm{B}$ at an energy of $E-E_{\\mathrm{F}} \\approx +0.6\\,\\mathrm{eV}$. This is a high density of *unoccupied* states spatially localized on site $\\mathrm{B}$.\n    - The spectra show a peak in the LDOS on site $\\mathrm{A}$ at an energy of $E-E_{\\mathrm{F}} \\approx -0.9\\,\\mathrm{eV}$. This is a high density of *occupied* states spatially localized on site $\\mathrm{A}$.\n    - Observation 5, the $dI/dV$ maps, provides direct spatial confirmation of this LDOS localization.\n\n3.  **Explanation of Contrast Inversion (Observation 1):**\n    - **At $V = +0.8\\,\\mathrm{V}$:** The current is determined by integrating the sample's unoccupied LDOS from $E_{\\mathrm{F}}$ to $E_{\\mathrm{F}} + 0.8\\,\\mathrm{eV}$. This energy window, $[0, +0.8]\\,\\mathrm{eV}$ relative to $E_{\\mathrm{F}}$, fully includes the strong peak at $+0.6\\,\\mathrm{eV}$ localized on site $\\mathrm{B}$. Site $\\mathrm{A}$ is described as \"relatively featureless\" in this range. Consequently, the integrated LDOS will be much larger over site $\\mathrm{B}$ than over site $\\mathrm{A}$. To maintain constant current, the tip retracts over site $\\mathrm{B}$, making it appear bright.\n    - **At $V = -0.8\\,\\mathrm{V}$:** The current is determined by integrating the sample's occupied LDOS from $E_{\\mathrm{F}} - 0.8\\,\\mathrm{eV}$ to $E_{\\mathrm{F}}$. This energy window is $[-0.8, 0]\\,\\mathrm{eV}$ relative to $E_{\\mathrm{F}}$. The strong peak in the occupied LDOS of site $\\mathrm{A}$ is centered at $-0.9\\,\\mathrm{eV}$. Although the center of the peak is slightly outside the integration window, any realistic spectral peak has a finite width (due to lifetime, instrumental, and other broadening effects). The tail of this pronounced peak at $-0.9\\,\\mathrm{eV}$ will extend into the $[-0.8, 0]\\,\\mathrm{eV}$ window, contributing significantly to the integrated LDOS. Site $\\mathrm{B}$ is featureless in this occupied energy range. Therefore, the integrated LDOS will be dominated by the contribution from site $\\mathrm{A}$. The tip retracts over site $\\mathrm{A}$, making it appear bright.\n    - **Conclusion:** The reversal of bias from positive to negative switches the tunneling process from probing unoccupied states (dominant on site $\\mathrm{B}$) to probing occupied states (dominant on site $\\mathrm{A}$). This directly causes the observed contrast inversion where site $\\mathrm{B}$ is bright at positive bias and site $\\mathrm{A}$ is bright at negative bias.\n\n### Option-by-Option Analysis\n\n**A) The contrast inversion primarily reflects an asymmetry of the sample’s local density of states (LDOS) between occupied and unoccupied energies on the two sites, consistent with an approximately $s$-wave tip apex; bias reversal selects different sample states with distinct spatial character.**\nThis statement is a precise summary of our derivation. The phenomenon is caused by an asymmetric LDOS (unoccupied states on site $\\mathrm{B}$, occupied states on site $\\mathrm{A}$). The bias reversal acts as a selector for these different energy ranges. The s-wave tip apex, confirmed by observation 4, is a necessary condition for this simple interpretation to hold. All parts of this statement are consistent with the provided data.\n**Verdict: Correct.**\n\n**B) The contrast inversion requires a change in the dominant orbital symmetry of the tip states with bias polarity; an energy-dependent switch between $s$-like and higher angular momentum tip states in the tip density of states produces inversion even if the sample LDOS is symmetric.**\nThis option is directly contradicted by the evidence. Observation 4 establishes that the tip behaves as a simple $s$-wave probe and does not produce inversion on a reference Au$(111)$ surface, indicating its electronic structure is not the cause. Furthermore, Observations 2 and 5 show that the sample LDOS is demonstrably *not* symmetric.\n**Verdict: Incorrect.**\n\n**C) The contrast inversion is most likely a feedback artifact arising from the exponential distance dependence of the tunneling current in constant-current mode and does not carry information about the LDOS.**\nThis is fundamentally incorrect. The exponential dependence of current on distance is the physical principle that allows STM to measure topography; it is not an artifact. The claim that the inversion carries no LDOS information is falsified by Observations 2 and 5, which show a clear correlation between the topographic contrast and the spectroscopically measured LDOS. Finally, Observation 3, showing the effect is robust against changes in setpoint current (and thus average tip-sample distance), argues against it being a sensitive feedback artifact.\n**Verdict: Incorrect.**\n\n**D) The contrast inversion is due to a reversal in the sign of the tunneling matrix element upon switching the bias polarity, independent of the LDOS distribution on the sample.**\nThis statement is physically unsound. The tunneling current $I$ and differential conductance $dI/dV$ are proportional to the squared magnitude of the tunneling matrix element, $|M|^2$. The sign of $M$ is irrelevant. A change in the sign of $M$ would have zero effect on the measured current or the resulting topographic image. Also, the claim that the effect is \"independent of the LDOS\" is in direct contradiction with the spectroscopic data in Observations 2 and 5.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2856448"}, {"introduction": "Beyond real-space imaging, STM can be used to map a material's electronic band structure in reciprocal space, a technique known as Fourier-Transform Scanning Tunneling Spectroscopy (FT-STS). This advanced method analyzes standing wave patterns caused by quasiparticle interference (QPI) to probe the momentum-space dispersion relation, $E(\\mathbf{k})$. This practice [@problem_id:2856483] guides you through the entire analysis pipeline, from synthesizing QPI data to performing a direction-aware regression that inverts the data to reconstruct an anisotropic band structure. By extracting fundamental parameters like effective masses, you will see how STM serves as a powerful, complementary tool to techniques like ARPES for characterizing the elementary electronic properties of materials.", "problem": "You are given the task of reconstructing an anisotropic electronic band structure from synthetic Fourier-transform scanning tunneling spectroscopy (FT-STS) dispersions and comparing the result to Angle-Resolved Photoemission Spectroscopy (ARPES)-derived dispersions. The objective is to design and implement a principled inversion that starts only from fundamental definitions of quasiparticle interference and the effective-mass approximation and produces a quantitative comparison to a reference. All energies must be expressed in electronvolts (eV), all wavevectors in inverse angstroms ($\\text{Å}^{-1}$), and all angles in radians.\n\nThe base physical assumptions you may use are the following fundamental definitions and well-tested facts:\n- Quasiparticle interference in FT-STS measures scattering wavevectors that connect equal-energy points in reciprocal space. For dominant backscattering between opposite points of the same constant-energy contour, the scattering wavevector magnitude satisfies $q(\\theta,E) = 2 k(\\theta,E)$, where $\\theta$ denotes the direction in the two-dimensional Brillouin zone and $k(\\theta,E)$ is the radial magnitude of the crystal momentum along direction $\\theta$ at energy $E$.\n- Near an extremum, the band dispersion may be described by the effective-mass approximation with a diagonal effective-mass tensor, namely an anisotropic quadratic form in the crystal momentum components. Use a constant $C = \\hbar^2/(2 m_e)$ with numerical value $C = 3.809982 \\, \\text{eV}\\cdot\\text{Å}^2$, where $m_e$ is the electron rest mass and $\\hbar$ is the reduced Planck constant. The dispersion is centered at an energy offset $E_0$ and characterized by principal-direction masses $m_x$ and $m_y$. It is convenient to express these as dimensionless ratios $\\alpha_x = m_x/m_e$ and $\\alpha_y = m_y/m_e$.\n\nFrom these bases, implement a general, direction-resolved inversion procedure that, given triplets $(E_i,\\theta_j,q_{ij})$, infers the anisotropic band structure parameters and provides a quantitative comparison to ARPES-derived dispersions.\n\nTest suite specification:\n- Use three test cases. For each case, you must synthesize the FT-STS datasets $(E_i,\\theta_j,q_{ij})$ deterministically from the specification below, assuming dominant backscattering $q_{ij} = 2 k(\\theta_j,E_i)$ and energies greater than the band minimum $E_0$. For a direction $\\theta$, the effective radial magnitude $k(\\theta,E)$ is defined implicitly by the constant-energy condition of the anisotropic quadratic band in the effective-mass approximation. The angles must be $\\theta \\in \\{0, \\pi/4, \\pi/2\\}$ in radians. For each case, the ARPES reference consists of the exact same band parameters used to synthesize the FT-STS data, against which your inverted result must be compared.\n- For each case, energies $E_i$ are given as a fixed list. Synthesize $q_{ij}$ deterministically from the above physical definitions using $C = 3.809982$. No additional noise should be added.\n\nCase A (isotropic reference):\n- Reference offset and masses (ARPES): $E_0 = 0.10$ eV, $\\alpha_x = 0.50$, $\\alpha_y = 0.50$.\n- Energy grid: $[0.12, 0.16, 0.20, 0.24, 0.28]$ eV.\n- Angles: $[0, \\pi/4, \\pi/2]$ radians.\n\nCase B (moderately anisotropic reference):\n- Reference offset and masses (ARPES): $E_0 = 0.05$ eV, $\\alpha_x = 0.30$, $\\alpha_y = 0.90$.\n- Energy grid: $[0.08, 0.14, 0.20, 0.26, 0.32]$ eV.\n- Angles: $[0, \\pi/4, \\pi/2]$ radians.\n\nCase C (strongly anisotropic with negative offset):\n- Reference offset and masses (ARPES): $E_0 = -0.02$ eV, $\\alpha_x = 0.15$, $\\alpha_y = 1.20$.\n- Energy grid: $[0.00, 0.04, 0.08, 0.12, 0.16]$ eV.\n- Angles: $[0, \\pi/4, \\pi/2]$ radians.\n\nAlgorithmic requirements:\n- For each case, first synthesize the FT-STS data by computing, for each energy $E$ and direction $\\theta$, the scattering wavevector magnitude $q(E,\\theta) = 2 k(E,\\theta)$, where $k(E,\\theta)$ satisfies the anisotropic constant-energy condition implied by the effective-mass approximation with the given $(E_0,\\alpha_x,\\alpha_y)$ and constant $C$.\n- Then, implement an inversion to estimate $(\\hat{E}_0,\\hat{\\alpha}_x,\\hat{\\alpha}_y)$ from the synthesized set $\\{(E,\\theta,q)\\}$. Your inversion must be direction-aware and should not assume isotropy. Design it as a regression that uses only the above-stated physical bases and definitions.\n- Using the ARPES reference parameters $(E_0,\\alpha_x,\\alpha_y)$, compute for each case the following metrics:\n  1. Relative mass error in the $x$ direction: $\\left|\\hat{\\alpha}_x - \\alpha_x\\right|/\\alpha_x$.\n  2. Relative mass error in the $y$ direction: $\\left|\\hat{\\alpha}_y - \\alpha_y\\right|/\\alpha_y$.\n  3. Absolute offset error: $\\left|\\hat{E}_0 - E_0\\right|$ in eV.\n  4. The maximum absolute energy discrepancy (in eV) between the inverted dispersion and the ARPES dispersion, evaluated on the measured set of wavevectors $k = q/2$ and angles $\\theta \\in \\{0,\\pi/4,\\pi/2\\}$ for the given energy grids.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist of four floats in the order specified above. For example, the outer list should look like [[caseA_values],[caseB_values],[caseC_values]]. Each float must be rounded to $6$ decimal places, energies in eV, and relative errors dimensionless. The angles must be in radians. No additional text should be printed.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of solid-state physics, specifically the effective-mass approximation and quasiparticle interference, and is a well-posed computational task. All necessary data, models, and constants are provided, and there are no internal contradictions or ambiguities. I will now provide the complete solution.\n\nThe objective is to reconstruct the parameters of an anisotropic electronic band structure—the energy offset $E_0$ and dimensionless effective masses $\\alpha_x$ and $\\alpha_y$—from synthetic Fourier-transform scanning tunneling spectroscopy (FT-STS) data. The solution is then compared against the known ground-truth parameters, which simulate an Angle-Resolved Photoemission Spectroscopy (ARPES) reference.\n\nThe theoretical foundation is the effective-mass approximation for a parabolic band near an extremum in a two-dimensional system. The energy $E$ as a function of the crystal momentum wavevector $\\vec{k} = (k_x, k_y)$ is given by:\n$$ E(\\vec{k}) = E_0 + C \\left( \\frac{k_x^2}{\\alpha_x} + \\frac{k_y^2}{\\alpha_y} \\right) $$\nHere, $E_0$ is the energy of the band extremum, $C = \\frac{\\hbar^2}{2m_e} = 3.809982 \\, \\text{eV}\\cdot\\text{Å}^2$ is a physical constant, and $\\alpha_x = m_x/m_e$ and $\\alpha_y = m_y/m_e$ are the dimensionless effective mass ratios along the principal axes.\n\nIn polar coordinates, with $k_x = k \\cos\\theta$ and $k_y = k \\sin\\theta$, the dispersion relation becomes:\n$$ E(k, \\theta) = E_0 + C k^2 \\left( \\frac{\\cos^2\\theta}{\\alpha_x} + \\frac{\\sin^2\\theta}{\\alpha_y} \\right) $$\nwhere $k$ is the magnitude of the wavevector $\\vec{k}$ and $\\theta$ is its angle with respect to the $k_x$-axis. A constant-energy contour (CEC) at energy $E$ is described by solving for $k$ as a function of $\\theta$:\n$$ k(E, \\theta) = \\sqrt{\\frac{E - E_0}{C \\left( \\frac{\\cos^2\\theta}{\\alpha_x} + \\frac{\\sin^2\\theta}{\\alpha_y} \\right)}} $$\nThis expression is valid for energies $E > E_0$. FT-STS measures scattering wavevectors $\\vec{q}$ that connect two points on a CEC. We are instructed to assume dominant backscattering, where the two points are antipodal, i.e., $\\vec{k}$ and $-\\vec{k}$. The magnitude of the scattering wavevector is therefore $q = |\\vec{k} - (-\\vec{k})| = 2|\\vec{k}|$, or:\n$$ q(E, \\theta) = 2 k(E, \\theta) $$\nThis equation forms the basis for synthesizing the FT-STS data pairs $(E_i, \\theta_j, q_{ij})$.\n\nThe core of the task is to perform the inversion: given a set of measured triplets $\\{ (E, \\theta, q) \\}$, we must estimate the parameters $(\\hat{E}_0, \\hat{\\alpha}_x, \\hat{\\alpha}_y)$. To achieve this, we first rearrange the dispersion relation into a form suitable for linear regression. Starting from the dispersion relation and substituting $k = q/2$:\n$$ E - E_0 = C \\left( \\frac{( (q/2) \\cos\\theta )^2}{\\alpha_x} + \\frac{( (q/2) \\sin\\theta )^2}{\\alpha_y} \\right) $$\n$$ E - E_0 = \\frac{C}{4} \\left( \\frac{(q \\cos\\theta)^2}{\\alpha_x} + \\frac{(q \\sin\\theta)^2}{\\alpha_y} \\right) $$\nRearranging to isolate $E$ yields a linear model:\n$$ E = E_0 + \\left(\\frac{C}{4\\alpha_x}\\right) (q \\cos\\theta)^2 + \\left(\\frac{C}{4\\alpha_y}\\right) (q \\sin\\theta)^2 $$\nThis equation is of the form $y = \\beta_0 x_0 + \\beta_1 x_1 + \\beta_2 x_2$ for each data point, where:\n- Response variable $y = E$.\n- Predictor variables are $x_0 = 1$ (for the intercept), $x_1 = (q \\cos\\theta)^2$, and $x_2 = (q \\sin\\theta)^2$.\n- The regression coefficients $\\beta_0, \\beta_1, \\beta_2$ are related to the physical parameters:\n  - $\\beta_0 = \\hat{E}_0$\n  - $\\beta_1 = \\frac{C}{4\\hat{\\alpha}_x} \\implies \\hat{\\alpha}_x = \\frac{C}{4\\beta_1}$\n  - $\\beta_2 = \\frac{C}{4\\hat{\\alpha}_y} \\implies \\hat{\\alpha}_y = \\frac{C}{4\\beta_2}$\n\nFor a set of $N$ data points, this can be expressed in matrix form as $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta}$, where:\n$$ \\mathbf{y} = \\begin{pmatrix} E_1 \\\\ E_2 \\\\ \\vdots \\\\ E_N \\end{pmatrix}, \\quad \\mathbf{X} = \\begin{pmatrix} 1 & (q_1 \\cos\\theta_1)^2 & (q_1 \\sin\\theta_1)^2 \\\\ 1 & (q_2 \\cos\\theta_2)^2 & (q_2 \\sin\\theta_2)^2 \\\\ \\vdots & \\vdots & \\vdots \\\\ 1 & (q_N \\cos\\theta_N)^2 & (q_N \\sin\\theta_N)^2 \\end{pmatrix}, \\quad \\boldsymbol{\\beta} = \\begin{pmatrix} \\beta_0 \\\\ \\beta_1 \\\\ \\beta_2 \\end{pmatrix} $$\nThe optimal vector of coefficients $\\hat{\\boldsymbol{\\beta}}$ is found by solving this system using a standard linear least-squares algorithm, for which the canonical solution is $\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}$. Once $\\hat{\\boldsymbol{\\beta}}$ is determined, the physical parameters $(\\hat{E}_0, \\hat{\\alpha}_x, \\hat{\\alpha}_y)$ are calculated from the relations above. Since the synthetic data is noise-free, this inversion procedure is expected to recover the original parameters with high precision, limited only by floating-point arithmetic.\n\nFinally, the quality of the inversion is quantified using four metrics:\n1.  Relative mass error in the x-direction: $|\\hat{\\alpha}_x - \\alpha_x| / \\alpha_x$.\n2.  Relative mass error in the y-direction: $|\\hat{\\alpha}_y - \\alpha_y| / \\alpha_y$.\n3.  Absolute offset error: $|\\hat{E}_0 - E_0|$.\n4.  Maximum absolute energy discrepancy: $\\max | \\hat{E}(\\vec{k}) - E_{\\text{ARPES}}(\\vec{k}) |$ over all measured wavevectors. The inverted energy is $\\hat{E}(\\vec{k}) = \\hat{E}_0 + C(k_x^2/\\hat{\\alpha}_x + k_y^2/\\hat{\\alpha}_y)$, and the reference ARPES energy is the true energy $E_{\\text{ARPES}}(\\vec{k}) = E_0 + C(k_x^2/\\alpha_x + k_y^2/\\alpha_y)$, which, by construction, is equal to the energy $E$ of the corresponding synthetic data point.\n\nThe implementation will follow these steps for each test case: synthesize the data from the true parameters, perform the linear regression to find the estimated parameters, and compute the required error metrics.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of reconstructing an anisotropic electronic band structure\n    from synthetic FT-STS data and comparing it to ARPES-derived dispersions.\n    \"\"\"\n    # Physical constant C = h_bar^2 / (2*m_e) in eV·Å^2\n    C = 3.809982\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A (isotropic)\",\n            \"arpes_params\": {\"E0\": 0.10, \"alpha_x\": 0.50, \"alpha_y\": 0.50},\n            \"energies\": [0.12, 0.16, 0.20, 0.24, 0.28],\n            \"angles\": [0, np.pi / 4, np.pi / 2],\n        },\n        {\n            \"name\": \"Case B (moderately anisotropic)\",\n            \"arpes_params\": {\"E0\": 0.05, \"alpha_x\": 0.30, \"alpha_y\": 0.90},\n            \"energies\": [0.08, 0.14, 0.20, 0.26, 0.32],\n            \"angles\": [0, np.pi / 4, np.pi / 2],\n        },\n        {\n            \"name\": \"Case C (strongly anisotropic with negative offset)\",\n            \"arpes_params\": {\"E0\": -0.02, \"alpha_x\": 0.15, \"alpha_y\": 1.20},\n            \"energies\": [0.00, 0.04, 0.08, 0.12, 0.16],\n            \"angles\": [0, np.pi / 4, np.pi / 2],\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        E0_true = case[\"arpes_params\"][\"E0\"]\n        alpha_x_true = case[\"arpes_params\"][\"alpha_x\"]\n        alpha_y_true = case[\"arpes_params\"][\"alpha_y\"]\n        energies = case[\"energies\"]\n        angles = case[\"angles\"]\n\n        # Step 1: Synthesize FT-STS data (E, theta, q)\n        synthetic_data = []\n        for E in energies:\n            for theta in angles:\n                cos_theta_sq = np.cos(theta) ** 2\n                sin_theta_sq = np.sin(theta) ** 2\n                \n                denominator = C * (cos_theta_sq / alpha_x_true + sin_theta_sq / alpha_y_true)\n                \n                # We are guaranteed E > E0 by the problem statement\n                k_squared = (E - E0_true) / denominator\n                k = np.sqrt(k_squared)\n                q = 2 * k\n                synthetic_data.append({\"E\": E, \"theta\": theta, \"q\": q})\n\n        # Step 2: Implement the inversion via linear regression\n        num_points = len(synthetic_data)\n        y_vec = np.zeros(num_points)\n        X_matrix = np.zeros((num_points, 3))\n\n        for i, data_point in enumerate(synthetic_data):\n            E, theta, q = data_point[\"E\"], data_point[\"theta\"], data_point[\"q\"]\n            y_vec[i] = E\n            X_matrix[i, 0] = 1.0\n            X_matrix[i, 1] = (q * np.cos(theta)) ** 2\n            X_matrix[i, 2] = (q * np.sin(theta)) ** 2\n\n        # Solve the linear system y = X * beta\n        betas, _, _, _ = np.linalg.lstsq(X_matrix, y_vec, rcond=None)\n        beta0_hat, beta1_hat, beta2_hat = betas\n\n        # Step 3: Recover the physical parameters from regression coefficients\n        E0_hat = beta0_hat\n        alpha_x_hat = C / (4 * beta1_hat) if beta1_hat != 0 else np.inf\n        alpha_y_hat = C / (4 * beta2_hat) if beta2_hat != 0 else np.inf\n        \n        # Step 4: Compute the required metrics\n        # Metric 1: Relative mass error in x\n        rel_err_ax = np.abs(alpha_x_hat - alpha_x_true) / alpha_x_true\n\n        # Metric 2: Relative mass error in y\n        rel_err_ay = np.abs(alpha_y_hat - alpha_y_true) / alpha_y_true\n\n        # Metric 3: Absolute offset error\n        abs_err_E0 = np.abs(E0_hat - E0_true)\n\n        # Metric 4: Maximum absolute energy discrepancy\n        max_energy_discrepancy = 0.0\n        for data_point in synthetic_data:\n            E_true_point = data_point[\"E\"]\n            q = data_point[\"q\"]\n            theta = data_point[\"theta\"]\n            \n            k = q / 2.0\n            kx = k * np.cos(theta)\n            ky = k * np.sin(theta)\n\n            E_inverted = E0_hat + C * (kx**2 / alpha_x_hat + ky**2 / alpha_y_hat)\n            discrepancy = np.abs(E_inverted - E_true_point)\n            \n            if discrepancy > max_energy_discrepancy:\n                max_energy_discrepancy = discrepancy\n\n        case_metrics = [rel_err_ax, rel_err_ay, abs_err_E0, max_energy_discrepancy]\n        all_results.append(case_metrics)\n\n    # Final print statement in the exact required format.\n    formatted_results = []\n    for result_set in all_results:\n        formatted_case = [f\"{val:.6f}\" for val in result_set]\n        formatted_results.append(f\"[{','.join(formatted_case)}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2856483"}]}