{"hands_on_practices": [{"introduction": "The existence of surface plasmon polaritons (SPPs) is not a given; it hinges on the specific optical properties of the metal and dielectric materials at the interface. This first practice grounds our understanding in these fundamental properties by tasking you with a foundational calculation. Using the Drude model, a cornerstone for describing electron behavior in metals, you will calculate the complex permittivity $\\epsilon_m(\\omega)$ for gold and verify if the essential condition for SPP excitation, $\\mathrm{Re}(\\epsilon_m) + \\epsilon_d \\lt 0$, is satisfied at a given wavelength. This exercise illustrates the direct link between a material's microscopic electronic response and its ability to support macroscopic plasmonic phenomena. [@problem_id:2864084]", "problem": "A planar interface between a metal and a dielectric can support a surface plasmon polariton (SPP) if the real part of the metal permittivity added to the dielectric permittivity is negative. Consider gold described by a free-electron Drude model that neglects interband transitions and assumes a unity background permittivity. The metal is interfaced with water, whose relative permittivity at visible frequencies may be taken as approximately constant, $\\epsilon_{d} \\simeq 1.77$. At a free-space wavelength $\\lambda = 633\\ \\mathrm{nm}$, compute the complex metal permittivity $\\epsilon_{m}(\\omega)$ from first principles using the Drude model, given the metal plasma frequency $\\omega_{p} = 1.37 \\times 10^{16}\\ \\mathrm{s}^{-1}$ and phenomenological damping rate $\\gamma = 1.05 \\times 10^{14}\\ \\mathrm{s}^{-1}$. Use the speed of light $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m/s}$ and the angular frequency $\\omega = 2\\pi c/\\lambda$.\n\nThen, evaluate the quantity $\\mathrm{Re}(\\epsilon_{m}(\\omega)) + \\epsilon_{d}$ and decide, based on its sign, whether the SPP existence condition is met at the gold–water interface at $\\lambda = 633\\ \\mathrm{nm}$. Express your final numerical answer as a pure number (dimensionless) equal to $\\mathrm{Re}(\\epsilon_{m}(\\omega)) + \\epsilon_{d}$, rounded to three significant figures.", "solution": "The problem statement has been validated and found to be scientifically sound, well-posed, objective, and self-contained. It presents a standard problem in materials physics that can be solved using established principles. Therefore, I will proceed with the solution.\n\nThe problem requires the calculation of the complex permittivity of gold, $\\epsilon_{m}(\\omega)$, using the free-electron Drude model and then to use this result to check the existence condition for surface plasmon polaritons (SPPs) at a gold-water interface. The condition for SPP existence at the interface between a metal (permittivity $\\epsilon_m$) and a dielectric (permittivity $\\epsilon_d > 0$) is that the real part of the metal permittivity must be negative and its magnitude greater than the dielectric permittivity, $\\mathrm{Re}(\\epsilon_m) < -\\epsilon_d$, which is equivalent to the condition $\\mathrm{Re}(\\epsilon_{m}) + \\epsilon_{d} < 0$.\n\nThe complex relative permittivity of a metal, $\\epsilon_{m}(\\omega)$, within the framework of the Drude model assuming unity background permittivity ($\\epsilon_{\\infty} = 1$) is given by the expression:\n$$ \\epsilon_{m}(\\omega) = 1 - \\frac{\\omega_{p}^{2}}{\\omega(\\omega + i\\gamma)} $$\nwhere $\\omega$ is the angular frequency of the electromagnetic field, $\\omega_{p}$ is the plasma frequency of the metal, and $\\gamma$ is the phenomenological damping rate.\n\nFirst, we must calculate the angular frequency $\\omega$ corresponding to the given free-space wavelength $\\lambda = 633 \\ \\mathrm{nm} = 633 \\times 10^{-9} \\ \\mathrm{m}$. Using the speed of light $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m/s}$, we have:\n$$ \\omega = \\frac{2\\pi c}{\\lambda} = \\frac{2\\pi (2.99792458 \\times 10^{8}\\ \\mathrm{m/s})}{633 \\times 10^{-9}\\ \\mathrm{m}} \\approx 2.9759235 \\times 10^{15}\\ \\mathrm{s}^{-1} $$\n\nNext, to evaluate the SPP existence condition, we need the real part of $\\epsilon_{m}(\\omega)$. We begin by rationalizing the denominator of the frequency-dependent term in the Drude formula:\n$$ \\frac{\\omega_{p}^{2}}{\\omega(\\omega + i\\gamma)} = \\frac{\\omega_{p}^{2}}{\\omega^{2} + i\\gamma\\omega} = \\frac{\\omega_{p}^{2}(\\omega^{2} - i\\gamma\\omega)}{(\\omega^{2} + i\\gamma\\omega)(\\omega^{2} - i\\gamma\\omega)} = \\frac{\\omega_{p}^{2}(\\omega^{2} - i\\gamma\\omega)}{\\omega^{4} + \\gamma^{2}\\omega^{2}} = \\frac{\\omega_{p}^{2}}{\\omega^{2} + \\gamma^{2}} - i \\frac{\\omega_{p}^{2} \\gamma}{\\omega(\\omega^{2} + \\gamma^{2})} $$\nSubstituting this back into the expression for $\\epsilon_{m}(\\omega)$:\n$$ \\epsilon_{m}(\\omega) = 1 - \\left( \\frac{\\omega_{p}^{2}}{\\omega^{2} + \\gamma^{2}} - i \\frac{\\omega_{p}^{2} \\gamma}{\\omega(\\omega^{2} + \\gamma^{2})} \\right) = \\left( 1 - \\frac{\\omega_{p}^{2}}{\\omega^{2} + \\gamma^{2}} \\right) + i \\left( \\frac{\\omega_{p}^{2} \\gamma}{\\omega(\\omega^{2} + \\gamma^{2})} \\right) $$\nFrom this, the real part is identified as:\n$$ \\mathrm{Re}(\\epsilon_{m}(\\omega)) = 1 - \\frac{\\omega_{p}^{2}}{\\omega^{2} + \\gamma^{2}} $$\n\nWe are given the Drude model parameters for gold: $\\omega_{p} = 1.37 \\times 10^{16}\\ \\mathrm{s}^{-1}$ and $\\gamma = 1.05 \\times 10^{14}\\ \\mathrm{s}^{-1}$. We now substitute these values, along with the calculated value of $\\omega$, into the expression for $\\mathrm{Re}(\\epsilon_{m}(\\omega))$. Let us compute the squared frequencies:\n$$ \\omega_{p}^{2} = (1.37 \\times 10^{16}\\ \\mathrm{s}^{-1})^{2} = 1.8769 \\times 10^{32}\\ \\mathrm{s}^{-2} $$\n$$ \\omega^{2} \\approx (2.9759235 \\times 10^{15}\\ \\mathrm{s}^{-1})^{2} \\approx 8.856116 \\times 10^{30}\\ \\mathrm{s}^{-2} $$\n$$ \\gamma^{2} = (1.05 \\times 10^{14}\\ \\mathrm{s}^{-1})^{2} = 1.1025 \\times 10^{28}\\ \\mathrm{s}^{-2} $$\nThe denominator is thus:\n$$ \\omega^{2} + \\gamma^{2} \\approx 8.856116 \\times 10^{30}\\ \\mathrm{s}^{-2} + 1.1025 \\times 10^{28}\\ \\mathrm{s}^{-2} \\approx 8.867141 \\times 10^{30}\\ \\mathrm{s}^{-2} $$\nNow, we compute the real part of the permittivity:\n$$ \\mathrm{Re}(\\epsilon_{m}(\\omega)) = 1 - \\frac{1.8769 \\times 10^{32}\\ \\mathrm{s}^{-2}}{8.867141 \\times 10^{30}\\ \\mathrm{s}^{-2}} \\approx 1 - 21.16733 = -20.16733 $$\n\nFinally, we evaluate the quantity $\\mathrm{Re}(\\epsilon_{m}(\\omega)) + \\epsilon_{d}$. With the given permittivity for water, $\\epsilon_{d} = 1.77$, we have:\n$$ \\mathrm{Re}(\\epsilon_{m}(\\omega)) + \\epsilon_{d} \\approx -20.16733 + 1.77 = -18.39733 $$\nThe result is strongly negative, which confirms that the condition for the existence of a surface plasmon polariton at the gold-water interface is met for a wavelength of $\\lambda = 633 \\ \\mathrm{nm}$, under the simplifications of the specified Drude model.\n\nThe problem requests the final numerical answer for $\\mathrm{Re}(\\epsilon_{m}(\\omega)) + \\epsilon_{d}$ rounded to three significant figures.\n$$ -18.39733 \\approx -18.4 $$\nThis is the required value.", "answer": "$$ \\boxed{-18.4} $$", "id": "2864084"}, {"introduction": "Moving from fundamental principles to real-world applications, this problem explores the use of Surface Plasmon Resonance (SPR) as a powerful tool in label-free biosensing. The core principle of SPR sensing is that the resonance condition is highly sensitive to the mass concentration at the sensor surface. This exercise requires you to calculate the maximum expected signal for a binding event, connecting the stoichiometry of molecular interactions to a measurable output signal. By working through this scenario, you will gain a quantitative appreciation for the sensitivity of SPR and also confront one of its key practical limitations: the challenge of detecting very small molecules. [@problem_id:1478750]", "problem": "A biochemist is investigating the binding interaction between a large enzyme and a small-molecule inhibitor using a Surface Plasmon Resonance (SPR) instrument. The enzyme, which acts as the ligand, is first immobilized onto the surface of a sensor chip. This immobilization process results in a stable baseline increase of $RU_L = 12,000$ resonance units (RU). The molar mass of the enzyme is $M_L = 250 \\text{ kDa}$, and the molar mass of the inhibitor, which is the analyte, is $M_A = 80 \\text{ Da}$.\n\nThe fundamental principle of this SPR instrument is that the response signal, measured in RU, is directly proportional to the mass concentration on the sensor surface. For this specific setup, a signal change of 1.0 RU is known to correspond to a surface mass concentration change of 1.0 pg/mm$^2$.\n\nAssuming an ideal 1:1 binding stoichiometry (one inhibitor molecule binds to one enzyme molecule) and that 100% of the immobilized enzyme molecules are active and accessible for binding, calculate the maximum theoretical SPR signal change that would be observed when the inhibitor is flowed over the surface and binds to saturation.\n\nExpress your answer in resonance units, rounded to three significant figures.", "solution": "The SPR response is proportional to the surface mass density. Let $k$ be the proportionality constant between response in RU and surface mass density; here $k=1\\,\\text{RU}/(\\text{pg}/\\text{mm}^{2})$, but we will use it symbolically so it cancels.\n\nLet $n_{L}$ be the surface number density (molecules per unit area) of immobilized ligand. The immobilized ligand mass per unit area is\n$$\nm_{L}^{\\text{area}}=n_{L}\\frac{M_{L}}{N_{A}},\n$$\nwhere $M_{L}$ is the molar mass of the ligand and $N_{A}$ is Avogadro’s number. The corresponding immobilization response is\n$$\nRU_{L}=k\\,m_{L}^{\\text{area}}=k\\,n_{L}\\frac{M_{L}}{N_{A}}.\n$$\nFor ideal $1{:}1$ binding with all ligand sites active, the surface number density of bound analyte at saturation equals $n_{L}$. The analyte mass per unit area at saturation is\n$$\nm_{A}^{\\text{area}}=n_{L}\\frac{M_{A}}{N_{A}},\n$$\nso the binding-induced response at saturation is\n$$\n\\Delta RU_{\\max}=k\\,m_{A}^{\\text{area}}=k\\,n_{L}\\frac{M_{A}}{N_{A}}.\n$$\nTaking the ratio,\n$$\n\\frac{\\Delta RU_{\\max}}{RU_{L}}=\\frac{k\\,n_{L}\\frac{M_{A}}{N_{A}}}{k\\,n_{L}\\frac{M_{L}}{N_{A}}}=\\frac{M_{A}}{M_{L}}.\n$$\nTherefore,\n$$\n\\Delta RU_{\\max}=RU_{L}\\frac{M_{A}}{M_{L}}.\n$$\nWith $RU_{L}=12000$, $M_{L}=250\\,\\text{kDa}=2.5\\times 10^{5}\\,\\text{Da}$, and $M_{A}=80\\,\\text{Da}$,\n$$\n\\frac{M_{A}}{M_{L}}=\\frac{80}{2.5\\times 10^{5}}=3.2\\times 10^{-4},\n$$\nand thus\n$$\n\\Delta RU_{\\max}=12000\\times 3.2\\times 10^{-4}=3.84.\n$$\nRounded to three significant figures, the maximum theoretical SPR signal change is $3.84$ RU.", "answer": "$$\\boxed{3.84}$$", "id": "1478750"}, {"introduction": "In experimental physics, deriving meaningful physical quantities from raw measurement data is a critical skill. This practice simulates the final stage of an SPR experiment, where you are presented with angle-resolved reflectivity data and must extract the intrinsic properties of the surface plasmon. You will fit the characteristic dip in reflectivity to a Lorentzian model, a common approach for analyzing resonance phenomena, to determine the resonance width $\\Gamma_{\\mathrm{tot}}$. By carefully accounting for different loss channels, you will then calculate the intrinsic propagation length $L_{\\mathrm{int}}$ of the SPP, a key figure of merit for any plasmonic waveguide. [@problem_id:2864092]", "problem": "You are given angle-resolved reflectivity data produced under a prism-coupled Surface Plasmon Polariton (SPP) excitation (Kretschmann configuration), where the reflectivity exhibits a dip near the phase-matching angle due to coupling into the SPP. Your task is to write a complete program that, for each provided dataset, extracts the intrinsic SPP propagation length by fitting the dip width while accounting for known prism radiative losses.\n\nFundamental base and modeling assumptions to be used:\n- Start from Maxwell’s equations and boundary conditions for planar interfaces to justify the existence of a bound SPP mode on a metal-dielectric interface. The in-plane SPP wavevector is denoted by $k_{\\mathrm{sp}} = \\beta = \\mathrm{Re}(\\beta) + i\\,\\mathrm{Im}(\\beta)$, where $\\mathrm{Im}(\\beta) &gt; 0$ encodes loss.\n- The intrinsic SPP propagation length along the interface is defined by the exponential amplitude decay $e^{-\\mathrm{Im}(\\beta) x}$ and is given by $L_{\\mathrm{int}} = 1/(2\\,\\mathrm{Im}(\\beta))$.\n- In a prism-coupling experiment, the in-plane wavevector component of the incident light is $k_x(\\theta) = n_p\\,k_0\\,\\sin(\\theta)$, where $n_p$ is the prism refractive index, $\\theta$ is the incidence angle inside the prism, and $k_0 = 2\\pi/\\lambda_0$ is the free-space wavenumber at wavelength $\\lambda_0$.\n- Near resonance, the reflectivity dip as a function of $k_x$ can be modeled by a Lorentzian line shape due to a single dominant mode coupled to a continuum. The total half-width in the in-plane wavevector domain, denoted $\\,\\Gamma_{\\mathrm{tot}}\\,$, is the sum of an intrinsic loss contribution $\\,\\Gamma_{\\mathrm{int}}\\,$ (ohmic) and an external radiative contribution $\\,\\Gamma_{\\mathrm{rad}}\\,$ due to leakage back into the prism: $\\Gamma_{\\mathrm{tot}} = \\Gamma_{\\mathrm{int}} + \\Gamma_{\\mathrm{rad}}$. This additivity is the momentum-domain analogue of additivity of decay rates in temporal coupled-mode theory.\n- Consequently, the intrinsic propagation length is $L_{\\mathrm{int}} = 1/\\left(2\\,\\Gamma_{\\mathrm{int}}\\right) = 1/\\left(2\\,(\\Gamma_{\\mathrm{tot}} - \\Gamma_{\\mathrm{rad}})\\right)$.\n\nAlgorithmic specification to implement:\n1. Convert the given reflectivity-versus-angle data $R(\\theta)$ into a function of in-plane wavevector $k_x(\\theta) = n_p\\,k_0\\,\\sin(\\theta)$, with $\\theta$ in radians and $k_0 = 2\\pi/\\lambda_0$.\n2. Fit the measured dip using the following model in the angle domain, which implicitly represents a Lorentzian in $k_x$:\n   $$R_{\\mathrm{model}}(\\theta) = R_{\\mathrm{bg}} - \\frac{A}{1 + \\left(\\dfrac{k_x(\\theta) - k_{\\mathrm{res}}}{\\Gamma_{\\mathrm{tot}}}\\right)^2},$$\n   where $R_{\\mathrm{bg}}$ is a baseline reflectivity, $A$ is the dip depth, $k_{\\mathrm{res}}$ is the resonant in-plane wavevector, and $\\Gamma_{\\mathrm{tot}}$ is the total half-width in the in-plane wavevector domain. The parameters $R_{\\mathrm{bg}}$, $A$, $k_{\\mathrm{res}}$, and $\\Gamma_{\\mathrm{tot}}$ should be obtained by nonlinear least-squares fitting to the provided data.\n3. Using the known prism radiative half-width $\\Gamma_{\\mathrm{rad}}$ (given for each case), compute $\\Gamma_{\\mathrm{int}} = \\Gamma_{\\mathrm{tot}} - \\Gamma_{\\mathrm{rad}}$ and then compute $L_{\\mathrm{int}} = 1/\\left(2\\,\\Gamma_{\\mathrm{int}}\\right)$.\n4. Express $L_{\\mathrm{int}}$ in micrometers by multiplying by $10^{6}$, and round the result to three decimal places.\n\nYour program must process the following test suite. For each case, synthesize the reflectivity data $R(\\theta)$ on the specified angle grid using the model above, with no added noise, and then perform the fit and compute $L_{\\mathrm{int}}$.\n\nFor each test case, the data-generation parameters are:\n- Case $1$:\n  - $\\lambda_0 = 6.33\\times 10^{-7}\\,\\mathrm{m}$, $n_p = 1.515$\n  - True resonance angle $\\theta_{\\mathrm{res}} = 43.5\\,\\mathrm{deg}$\n  - Radiative half-width $\\Gamma_{\\mathrm{rad}} = 2.0\\times 10^{4}\\,\\mathrm{m}^{-1}$\n  - Total half-width $\\Gamma_{\\mathrm{tot}} = 7.0\\times 10^{4}\\,\\mathrm{m}^{-1}$ (implying intrinsic half-width $\\Gamma_{\\mathrm{int}} = 5.0\\times 10^{4}\\,\\mathrm{m}^{-1}$)\n  - Baseline $R_{\\mathrm{bg}} = 0.85$, dip depth $A = 0.25$\n  - Angle grid: $\\theta \\in [\\theta_{\\mathrm{res}} - 2.0\\,\\mathrm{deg},\\, \\theta_{\\mathrm{res}} + 2.0\\,\\mathrm{deg}]$ sampled every $0.02\\,\\mathrm{deg}$\n- Case $2$:\n  - $\\lambda_0 = 7.85\\times 10^{-7}\\,\\mathrm{m}$, $n_p = 1.6$\n  - True resonance angle $\\theta_{\\mathrm{res}} = 41.0\\,\\mathrm{deg}$\n  - Radiative half-width $\\Gamma_{\\mathrm{rad}} = 5.0\\times 10^{4}\\,\\mathrm{m}^{-1}$\n  - Total half-width $\\Gamma_{\\mathrm{tot}} = 2.1666666667\\times 10^{5}\\,\\mathrm{m}^{-1}$ (implying intrinsic half-width $\\Gamma_{\\mathrm{int}} \\approx 1.6666666667\\times 10^{5}\\,\\mathrm{m}^{-1}$)\n  - Baseline $R_{\\mathrm{bg}} = 0.90$, dip depth $A = 0.20$\n  - Angle grid: $\\theta \\in [\\theta_{\\mathrm{res}} - 2.0\\,\\mathrm{deg},\\, \\theta_{\\mathrm{res}} + 2.0\\,\\mathrm{deg}]$ sampled every $0.02\\,\\mathrm{deg}$\n- Case $3$:\n  - $\\lambda_0 = 5.32\\times 10^{-7}\\,\\mathrm{m}$, $n_p = 1.7$\n  - True resonance angle $\\theta_{\\mathrm{res}} = 44.0\\,\\mathrm{deg}$\n  - Radiative half-width $\\Gamma_{\\mathrm{rad}} = 1.5\\times 10^{4}\\,\\mathrm{m}^{-1}$\n  - Total half-width $\\Gamma_{\\mathrm{tot}} = 2.5\\times 10^{4}\\,\\mathrm{m}^{-1}$ (implying intrinsic half-width $\\Gamma_{\\mathrm{int}} = 1.0\\times 10^{4}\\,\\mathrm{m}^{-1}$)\n  - Baseline $R_{\\mathrm{bg}} = 0.75$, dip depth $A = 0.15$\n  - Angle grid: $\\theta \\in [\\theta_{\\mathrm{res}} - 2.0\\,\\mathrm{deg},\\, \\theta_{\\mathrm{res}} + 2.0\\,\\mathrm{deg}]$ sampled every $0.02\\,\\mathrm{deg}$\n\nIn all cases, compute $k_{\\mathrm{res}} = n_p\\,k_0\\,\\sin(\\theta_{\\mathrm{res}})$ and then synthesize the reflectivity data on the angle grid using the model $R_{\\mathrm{model}}(\\theta)$ given above with the stated $R_{\\mathrm{bg}}$, $A$, $\\Gamma_{\\mathrm{tot}}$, and $k_{\\mathrm{res}}$. Use these synthetic data as the “measured” inputs to your fitting procedure.\n\nAngle unit and output unit requirements:\n- All angles $\\theta$ in the model must be handled in radians internally, but the provided grids are in degrees, so convert degrees to radians using $\\theta_{\\mathrm{rad}} = \\theta_{\\mathrm{deg}} \\times \\pi/180$.\n- Express the final intrinsic SPP propagation length $L_{\\mathrm{int}}$ in micrometers, rounded to three decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain the three values of $L_{\\mathrm{int}}$ (in micrometers) for Cases $1$, $2$, and $3$, in that order. For example, an output with three values should look like $[x_1,x_2,x_3]$ where each $x_i$ is a decimal rounded to three decimal places.", "solution": "The problem presented is a straightforward computational exercise in the analysis of surface plasmon resonance (SPR) data derived from a Kretschmann-Raether prism-coupling configuration. It requires the extraction of the intrinsic propagation length of a surface plasmon polariton (SPP) by fitting a theoretical model to synthetic data. The problem is scientifically grounded, internally consistent, and well-posed. Although the task of fitting a model to ideal, noise-free data generated from that same model is somewhat trivial and serves only as a verification of the algorithm's implementation rather than a genuine scientific problem, we will execute the required procedure with the expected rigor.\n\nFirst, we must establish the physical principles. Surface plasmon polaritons are transverse-magnetic (TM) electromagnetic surface waves that propagate along the interface between a dielectric and a conductor with a negative real part of its permittivity, such as a metal. Their existence is a direct consequence of Maxwell's equations subject to boundary conditions at the interface. The SPP dispersion relation, which connects the frequency $\\omega$ to the wavevector $k$, does not intersect the light line in the surrounding dielectric medium. This means SPPs cannot be excited by light directly incident on the interface.\n\nThe Kretschmann configuration circumvents this momentum mismatch. A high-refractive-index prism ($n_p$) is placed in close proximity to the metal film. P-polarized light incident on the prism base at an angle $\\theta$ greater than the critical angle for total internal reflection generates an evanescent field that penetrates the metal film. The in-plane component of the incident light's wavevector is given by:\n$$k_x(\\theta) = n_p k_0 \\sin(\\theta)$$\nwhere $k_0 = 2\\pi/\\lambda_0$ is the free-space wavenumber for a given vacuum wavelength $\\lambda_0$. At a specific resonance angle, $\\theta_{\\mathrm{res}}$, this wavevector matches the real part of the SPP wavevector, $k_x(\\theta_{\\mathrm{res}}) \\approx \\mathrm{Re}(k_{\\mathrm{sp}})$. This phase-matching condition allows for efficient coupling of energy from the incident light into the SPP mode, resulting in a sharp dip in the attenuated total reflectance (ATR) spectrum, $R(\\theta)$.\n\nThe SPP wavevector is a complex quantity, $k_{\\mathrm{sp}} = \\beta = \\mathrm{Re}(\\beta) + i\\,\\mathrm{Im}(\\beta)$, where the imaginary part $\\mathrm{Im}(\\beta)$ represents damping due to losses. In the momentum ($k$-)space domain, the resonance has a finite width, which can be modeled by a Lorentzian lineshape. The total half-width at half-maximum (HWHM) of this Lorentzian, denoted $\\Gamma_{\\mathrm{tot}}$, arises from two primary decay channels:\n$1$. Intrinsic damping, $\\Gamma_{\\mathrm{int}}$, due to ohmic losses (absorption) within the metal.\n$2$. Radiative damping, $\\Gamma_{\\mathrm{rad}}$, due to the re-radiation or \"leakage\" of the SPP energy back into the prism.\n\nThese loss rates are additive, as dictated by coupled-mode theory:\n$$\\Gamma_{\\mathrm{tot}} = \\Gamma_{\\mathrm{int}} + \\Gamma_{\\mathrm{rad}}$$\nThe intrinsic propagation length, $L_{\\mathrm{int}}$, is the distance over which the SPP *intensity* decays to $1/e$ of its initial value due to ohmic losses alone. This is related to the intrinsic damping constant by:\n$$L_{\\mathrm{int}} = \\frac{1}{2\\Gamma_{\\mathrm{int}}}$$\nThe factor of $2$ appears because the intensity is proportional to the square of the field amplitude, which decays as $e^{-\\Gamma_{\\mathrm{int}} x}$.\n\nThe problem requires us to fit the simulated reflectivity data $R(\\theta)$ to the following model:\n$$R_{\\mathrm{model}}(\\theta) = R_{\\mathrm{bg}} - \\frac{A}{1 + \\left(\\dfrac{k_x(\\theta) - k_{\\mathrm{res}}}{\\Gamma_{\\mathrm{tot}}}\\right)^2}$$\nHere, $R_{\\mathrm{bg}}$ is the background reflectivity away from the resonance, $A$ is the dip depth, $k_{\\mathrm{res}}$ is the resonant in-plane wavevector, and $\\Gamma_{\\mathrm{tot}}$ is the total HWHM in the wavevector domain.\n\nThe procedure for each test case is as follows:\n$1$. For a given set of parameters ($\\lambda_0, n_p, \\theta_{\\mathrm{res}}, \\Gamma_{\\mathrm{rad}}, \\Gamma_{\\mathrm{tot}}, R_{\\mathrm{bg}}, A$), we first synthesize the \"measured\" reflectivity data. We define an angle grid $\\theta$ around the true resonance angle $\\theta_{\\mathrm{res}}$. Angles must be converted from degrees to radians for trigonometric functions. We calculate the true resonant wavevector $k_{\\mathrm{res}} = n_p (2\\pi/\\lambda_0) \\sin(\\theta_{\\mathrm{res}})$. Then, for each angle $\\theta_i$ in the grid, we calculate $k_x(\\theta_i)$ and subsequently the model reflectivity $R(\\theta_i)$.\n$2$. We then subject these synthetic data to a non-linear least-squares fitting procedure, using the `scipy.optimize.curve_fit` function. The function to be fitted is precisely the $R_{\\mathrm{model}}(\\theta)$ defined above, with $R_{\\mathrm{bg}}, A, k_{\\mathrm{res}},$ and $\\Gamma_{\\mathrm{tot}}$ as the free parameters.\n$3$. From the fitting results, we extract the optimized value for the total width, $\\Gamma_{\\mathrm{tot,fit}}$.\n$4$. We calculate the intrinsic width by subtracting the known radiative width: $\\Gamma_{\\mathrm{int}} = \\Gamma_{\\mathrm{tot,fit}} - \\Gamma_{\\mathrm{rad}}$.\n$5$. Finally, we compute the intrinsic propagation length: $L_{\\mathrm{int}} = 1 / (2\\Gamma_{\\mathrm{int}})$. This result, originally in meters, is converted to micrometers by multiplying by $10^6$ and is then rounded to three decimal places as required.\n\nSince the data is generated without noise from the same model used for fitting, the fitting procedure is expected to recover the original parameters with high precision, making this a test of correct implementation.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves the surface plasmon resonance analysis problem for three test cases.\n    For each case, it synthesizes reflectivity data and then fits a model to\n    extract the intrinsic SPP propagation length.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (lambda_0, n_p, theta_res_deg, Gamma_rad, Gamma_tot, R_bg, A)\n    test_cases = [\n        # Case 1\n        (6.33e-7, 1.515, 43.5, 2.0e4, 7.0e4, 0.85, 0.25),\n        # Case 2\n        (7.85e-7, 1.6, 41.0, 5.0e4, 2.1666666667e5, 0.90, 0.20),\n        # Case 3\n        (5.32e-7, 1.7, 44.0, 1.5e4, 2.5e4, 0.75, 0.15),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        lambda_0, n_p, theta_res_deg, Gamma_rad, Gamma_tot_true, R_bg_true, A_true = case\n\n        # --- 1. Synthesize Reflectivity Data ---\n\n        # Calculate free-space wavenumber\n        k0 = 2 * np.pi / lambda_0\n        \n        # Convert resonance angle to radians\n        theta_res_rad = np.deg2rad(theta_res_deg)\n        \n        # Calculate the true resonant in-plane wavevector\n        k_res_true = n_p * k0 * np.sin(theta_res_rad)\n        \n        # Define the model function for data generation and fitting.\n        # It takes angle theta (in radians) as the independent variable.\n        # This wrapper handles the conversion from angle to k_x internally.\n        def reflectivity_model(theta_rad, R_bg, A, k_res, Gamma_tot):\n            k_x = n_p * k0 * np.sin(theta_rad)\n            lorentzian_term = 1 + ((k_x - k_res) / Gamma_tot)**2\n            return R_bg - A / lorentzian_term\n            \n        # Generate the angle grid for the synthetic data\n        theta_grid_deg = np.arange(theta_res_deg - 2.0, theta_res_deg + 2.0, 0.02)\n        theta_grid_rad = np.deg2rad(theta_grid_deg)\n        \n        # Generate synthetic reflectivity data without noise\n        R_synthetic = reflectivity_model(theta_grid_rad, R_bg_true, A_true, k_res_true, Gamma_tot_true)\n\n        # --- 2. Fit the Model to the Data ---\n\n        # Provide initial guesses for the fitting parameters.\n        # Using the true values is a good strategy for this verification task.\n        initial_guesses = [R_bg_true, A_true, k_res_true, Gamma_tot_true]\n        \n        # Perform non-linear least-squares fitting\n        try:\n            popt, _ = optimize.curve_fit(reflectivity_model, theta_grid_rad, R_synthetic, p0=initial_guesses)\n        except RuntimeError:\n            # Handle cases where the fit might fail, although unlikely with noise-free data\n            results.append(np.nan)\n            continue\n            \n        # Extract the fitted total width\n        _R_bg_fit, _A_fit, _k_res_fit, Gamma_tot_fit = popt\n        \n        # --- 3. Compute Intrinsic Propagation Length ---\n        \n        # Calculate the intrinsic width\n        Gamma_int = Gamma_tot_fit - Gamma_rad\n        \n        # Calculate the intrinsic propagation length\n        # L_int = 1 / (2 * Gamma_int)\n        # Check for division by zero or negative Gamma_int, although not expected here\n        if Gamma_int > 0:\n            L_int_meters = 1.0 / (2.0 * Gamma_int)\n        else:\n            L_int_meters = np.inf\n        \n        # Convert from meters to micrometers\n        L_int_micrometers = L_int_meters * 1e6\n        \n        # Round to three decimal places\n        L_int_rounded = round(L_int_micrometers, 3)\n        \n        results.append(L_int_rounded)\n        \n    # Final print statement in the exact required format.\n    # Using format specifier to ensure three decimal places, e.g., 10.0 becomes 10.000\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2864092"}]}