{"hands_on_practices": [{"introduction": "To build a solid understanding of phonon dispersion, we begin with the simplest possible model: an infinite one-dimensional chain of identical atoms connected by springs. This problem acts as the \"hydrogen atom\" of lattice dynamics, allowing for a complete analytical derivation of the dispersion relation from first principles. By applying Newton's laws to this idealized crystal, you will see precisely how the collective vibrations of atoms give rise to wave-like excitations (phonons) whose frequency $\\omega$ is intrinsically linked to their wave vector $q$ [@problem_id:2848415].", "problem": "Consider an infinite one-dimensional monatomic Bravais lattice of identical atoms of mass $M$, with lattice constant $a$. Neighboring atoms are coupled by identical, linear, harmonic springs with spring constant $K$ that act only between nearest neighbors. Assume small displacements $u_n(t)$ from equilibrium so that Hooke's law is valid. Impose Born–von Karman (BvK) periodic boundary conditions on a chain of $N$ atoms and then take the limit $N \\to \\infty$ at the end if needed. \n\nStarting from Newton's second law and Hooke's law for the restoring forces between nearest neighbors, derive the linear equations of motion for the displacements {$u_n(t)$}. From these equations, construct the dynamical matrix $D(q)$ in reciprocal space for this monatomic lattice and solve the corresponding eigenvalue problem to obtain the explicit analytic form of the phonon angular frequency $\\omega(q)$ for wave vector $q$ in the first Brillouin zone of the one-dimensional lattice. \n\nUse radians for all angular quantities, and take the first Brillouin zone to be $q \\in [-\\pi/a,\\pi/a]$. Express the final frequency $\\omega(q)$ in radians per second as a closed-form analytic expression in terms of $K$, $M$, $a$, and $q$. Your final answer must be a single expression for $\\omega(q)$ (do not include an equality sign). No numerical evaluation or rounding is required.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- System: Infinite one-dimensional monatomic Bravais lattice.\n- Atomic properties: Mass $M$.\n- Lattice geometry: Lattice constant $a$.\n- Interactions: Linear harmonic springs with spring constant $K$, acting between nearest neighbors only.\n- Dynamics: Small displacements $u_n(t)$ from equilibrium.\n- Governing laws: Newton's second law, Hooke's law.\n- Boundary conditions: Born–von Karman (BvK) periodic boundary conditions on a chain of $N$ atoms, with the limit $N \\to \\infty$.\n- Tasks:\n    1. Derive the linear equations of motion for {$u_n(t)$}.\n    2. Construct the dynamical matrix $D(q)$.\n    3. Solve the eigenvalue problem to find the phonon angular frequency $\\omega(q)$.\n- Domain: Wave vector $q$ is in the first Brillouin zone, $q \\in [-\\frac{\\pi}{a}, \\frac{\\pi}{a}]$.\n- Required output format: A single closed-form analytic expression for $\\omega(q)$ in terms of $K$, $M$, $a$, and $q$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a canonical exercise in solid-state physics, concerning the lattice dynamics of a one-dimensional monatomic chain.\n- **Scientifically Grounded:** The problem is based on fundamental principles of classical mechanics (Newton's second law, Hooke's law) and standard models of condensed matter physics (Bravais lattice, Born-von Karman conditions). It is scientifically sound.\n- **Well-Posed:** All necessary parameters ($M$, $K$, $a$) are provided. The objective is clearly defined, and the problem structure leads to a unique and meaningful solution for the dispersion relation $\\omega(q)$.\n- **Objective:** The problem is stated in precise, unambiguous scientific language.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. It is a standard, well-posed problem in introductory solid-state physics. A full solution will be provided.\n\nWe begin by modeling the one-dimensional lattice. The equilibrium position of the $n$-th atom is given by $x_n = na$, where $n$ is an integer. Let $u_n(t)$ be the displacement of the $n$-th atom from its equilibrium position. The analysis assumes small displacements, so Hooke's law applies.\n\nThe force exerted on the $n$-th atom is the sum of forces from its nearest neighbors, the atoms at positions $(n-1)$ and $(n+1)$.\nThe force from the atom at $(n+1)$ on the atom at $n$, denoted $F_{n \\leftarrow n+1}$, is due to the extension of the spring connecting them. The change in length of this spring is $(x_{n+1} + u_{n+1}) - (x_n + u_n) - a = (na+a+u_{n+1}) - (na+u_n) - a = u_{n+1} - u_n$. According to Hooke's law, this results in a restoring force on atom $n$ given by $F_{n \\leftarrow n+1} = K(u_{n+1} - u_n)$.\nSimilarly, the force from the atom at $(n-1)$ on the atom at $n$ is $F_{n \\leftarrow n-1}$. The extension of the spring between atoms $n$ and $(n-1)$ is $(x_n+u_n)-(x_{n-1}+u_{n-1})-a = u_n - u_{n-1}$. This results in a restoring force on atom $n$ given by $F_{n \\leftarrow n-1} = -K(u_n - u_{n-1})$.\n\nThe total force on the $n$-th atom is the sum of these two forces:\n$$F_n = F_{n \\leftarrow n+1} + F_{n \\leftarrow n-1} = K(u_{n+1} - u_n) - K(u_n - u_{n-1}) = K(u_{n+1} + u_{n-1} - 2u_n)$$\nAccording to Newton's second law, $F_n = M \\ddot{u}_n$, where $\\ddot{u}_n = \\frac{d^2u_n}{dt^2}$. This gives the equation of motion for the $n$-th atom:\n$$M \\ddot{u}_n(t) = K \\left( u_{n+1}(t) + u_{n-1}(t) - 2u_n(t) \\right)$$\nThis is the linear equation of motion for the displacement $u_n(t)$.\n\nDue to the translational symmetry of the lattice, we seek traveling wave solutions (normal modes) of the form:\n$$u_n(t) = A \\exp[i(q x_n - \\omega t)] = A \\exp[i(qna - \\omega t)]$$\nwhere $A$ is the amplitude, $q$ is the wave vector, and $\\omega$ is the angular frequency. Substituting this ansatz into the equation of motion requires the following terms:\n$$ \\ddot{u}_n(t) = (-i\\omega)^2 u_n(t) = -\\omega^2 u_n(t) $$\n$$ u_{n+1}(t) = A \\exp[i(q(n+1)a - \\omega t)] = u_n(t) \\exp(iqa) $$\n$$ u_{n-1}(t) = A \\exp[i(q(n-1)a - \\omega t)] = u_n(t) \\exp(-iqa) $$\nSubstituting these into the equation of motion yields:\n$$ M(-\\omega^2) u_n(t) = K \\left( u_n(t)\\exp(iqa) + u_n(t)\\exp(-iqa) - 2u_n(t) \\right) $$\nFor a non-trivial solution ($u_n(t) \\neq 0$), we can divide by $u_n(t)$:\n$$ -M\\omega^2 = K (\\exp(iqa) + \\exp(-iqa) - 2) $$\nUsing Euler's identity, $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$, we have:\n$$ -M\\omega^2 = K(2\\cos(qa) - 2) = -2K(1 - \\cos(qa)) $$\n$$ M\\omega^2 = 2K(1 - \\cos(qa)) $$\nThis equation is the phonon dispersion relation. We can simplify it using the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$:\n$$ M\\omega^2(q) = 2K \\left( 2\\sin^2\\left(\\frac{qa}{2}\\right) \\right) = 4K \\sin^2\\left(\\frac{qa}{2}\\right) $$\nThis expression relates the angular frequency $\\omega$ to the wave vector $q$.\n\nThe problem also requires the construction of the dynamical matrix $D(q)$. The general form of the equations of motion in matrix form is $M\\omega^2 \\vec{u} = D(q) \\vec{u}$. For a monatomic basis, this becomes a scalar equation $M\\omega^2 = D(q)$. The dynamical matrix is the spatial Fourier transform of the interatomic force constants $\\Phi_{nn'}$. The equation of motion can be written as $M\\ddot{u}_n = -\\sum_{n'} \\Phi_{nn'} u_{n'}$. From our derived EOM, $M \\ddot{u}_n = K u_{n+1} + K u_{n-1} - 2K u_{n}$, we can identify the force constants:\n$$ \\Phi_{nn} = 2K $$\n$$ \\Phi_{n, n+1} = -K $$\n$$ \\Phi_{n, n-1} = -K $$\n$$ \\Phi_{nn'} = 0 \\quad \\text{for } |n-n'|  1 $$\nThe dynamical matrix (a scalar in this case) is given by:\n$$ D(q) = \\sum_{n'} \\Phi_{n, n'} \\exp[iq(x_{n'} - x_n)] $$\nDue to translational invariance, this sum is independent of $n$. Let $n=0$:\n$$ D(q) = \\sum_{n'} \\Phi_{0, n'} \\exp[iq x_{n'}] = \\Phi_{0,0} + \\Phi_{0,1}\\exp(iqa) + \\Phi_{0,-1}\\exp(-iqa) $$\n$$ D(q) = 2K - K\\exp(iqa) - K\\exp(-iqa) = 2K - K(\\exp(iqa) + \\exp(-iqa)) $$\n$$ D(q) = 2K - 2K\\cos(qa) = 2K(1 - \\cos(qa)) $$\nThe eigenvalue problem is $M\\omega^2(q) = D(q)$, which gives:\n$$ M\\omega^2(q) = 2K(1 - \\cos(qa)) = 4K \\sin^2\\left(\\frac{qa}{2}\\right) $$\nThis confirms the result obtained previously.\n\nSolving for $\\omega(q)$, we take the square root. Since frequency is a physically positive quantity, we take the positive root:\n$$ \\omega^2(q) = \\frac{4K}{M} \\sin^2\\left(\\frac{qa}{2}\\right) $$\n$$ \\omega(q) = \\sqrt{\\frac{4K}{M}} \\sqrt{\\sin^2\\left(\\frac{qa}{2}\\right)} = \\sqrt{\\frac{4K}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right| $$\nThe absolute value is necessary because the wave vector $q$ belongs to the first Brillouin zone, $q \\in [-\\frac{\\pi}{a}, \\frac{\\pi}{a}]$, for which the argument of the sine function, $\\frac{qa}{2}$, ranges from $-\\frac{\\pi}{2}$ to $\\frac{\\pi}{2}$. In this interval, $\\sin(\\frac{qa}{2})$ can be negative, whereas $\\omega$ must be non-negative.\n\nThe final expression for the phonon angular frequency is:\n$$ \\omega(q) = 2\\sqrt{\\frac{K}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right| $$\nThis is the dispersion relation for the one-dimensional monatomic chain. It shows that for small $q$ (long wavelengths), $\\omega \\approx a\\sqrt{K/M}|q|$, which is a linear relationship characteristic of acoustic waves. At the boundary of the Brillouin zone, $q = \\pm \\frac{\\pi}{a}$, the frequency reaches its maximum value $\\omega_{max} = 2\\sqrt{\\frac{K}{M}}$.", "answer": "$$ \\boxed{2\\sqrt{\\frac{K}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right|} $$", "id": "2848415"}, {"introduction": "Simple models are powerful, but real materials exhibit more complex interactions. This exercise demonstrates how to refine our basic model by including forces from not just the nearest, but also the next-nearest-neighboring atoms [@problem_id:2848436]. You will derive the modified dispersion relation and then, using a hypothetical experimental observation, determine the relative strength of these two types of interactions. This practice bridges the gap between idealized theory and experimental reality, teaching you how to parameterize a model to explain observed physical phenomena.", "problem": "A monatomic cubic crystal is probed along the crystallographic direction $[100]$, and the acoustic branch exhibits a deviation from the simple sinusoidal shape expected from only nearest-neighbor harmonic interactions as the wave vector approaches the Brillouin zone boundary at the high-symmetry point $X$. To rationalize this anomaly, consider a one-dimensional monatomic chain model representing longitudinal phonons along $[100]$, with lattice spacing $a$, atomic mass $m$, and harmonic interactions up to next-nearest neighbors characterized by force constants $C_{1}$ (nearest neighbor) and $C_{2}$ (next-nearest neighbor). \n\nStarting only from Newton’s second law and the definition of the plane-wave normal mode $u_{n}(t)=u\\,\\exp(i k n a - i \\omega t)$ for the displacement of the $n$-th atom, derive the dispersion relation $\\omega(k)$ for this chain including both $C_{1}$ and $C_{2}$. Then use the experimentally observed ratio of frequencies\n$\\omega(k_{0})/\\omega(X)=0.96$ at $k_{0}=3\\pi/(4a)$ and $X=\\pi/a$ to eliminate the unknowns $m$ and $C_{1}$ and solve for the ratio $\\alpha=C_{2}/C_{1}$. \n\nProvide your final value of $\\alpha$ rounded to $3$ significant figures. The final answer is dimensionless and should be given as a pure number without units.", "solution": "The problem requires the derivation of the phonon dispersion relation for a one-dimensional monatomic chain with nearest and next-nearest neighbor interactions, and then the determination of the ratio of the force constants. The problem is well-posed and scientifically grounded. We proceed with the derivation from first principles.\n\nLet the equilibrium position of the $n$-th atom be $na$, where $a$ is the lattice spacing. Let $u_n$ be the longitudinal displacement of the $n$-th atom from its equilibrium position. In a harmonic approximation, the force exerted on an atom is linearly proportional to the relative displacement of its neighbors.\n\nThe force on the $n$-th atom due to its nearest neighbors at positions $(n-1)a$ and $(n+1)a$ is given by Hooke's law:\n$F_{n, \\text{nn}} = C_1(u_{n+1} - u_n) + C_1(u_{n-1} - u_n) = C_1(u_{n+1} + u_{n-1} - 2u_n)$, where $C_1$ is the nearest-neighbor force constant.\n\nThe force on the $n$-th atom due to its next-nearest neighbors at positions $(n-2)a$ and $(n+2)a$ is:\n$F_{n, \\text{nnn}} = C_2(u_{n+2} - u_n) + C_2(u_{n-2} - u_n) = C_2(u_{n+2} + u_{n-2} - 2u_n)$, where $C_2$ is the next-nearest-neighbor force constant.\n\nThe total force $F_n$ on the $n$-th atom is the sum of these contributions. According to Newton's second law, the equation of motion for the $n$-th atom of mass $m$ is $m \\ddot{u}_n = F_n$:\n$$m \\frac{d^2 u_n}{dt^2} = C_1(u_{n+1} + u_{n-1} - 2u_n) + C_2(u_{n+2} + u_{n-2} - 2u_n)$$\n\nWe seek plane-wave solutions, representing the normal modes of the chain, of the form given in the problem statement:\n$$u_n(t) = u \\exp(i(kna - \\omega t))$$\nwhere $k$ is the wave vector, $\\omega$ is the angular frequency, and $u$ is the amplitude. The displacements of the neighboring atoms are related by a phase factor: $u_{n\\pm p}(t) = u_n(t) \\exp(\\pm ikpa)$. The second time derivative is $\\ddot{u}_n = (-i\\omega)^2 u_n = -\\omega^2 u_n$.\n\nSubstituting these into the equation of motion:\n$$-\\omega^2 m u_n = C_1(u_n e^{ika} + u_n e^{-ika} - 2u_n) + C_2(u_n e^{i2ka} + u_n e^{-i2ka} - 2u_n)$$\nFor a non-trivial solution ($u_n \\neq 0$), we can divide by $u_n$:\n$$-\\omega^2 m = C_1(e^{ika} + e^{-ika} - 2) + C_2(e^{i2ka} + e^{-i2ka} - 2)$$\nUsing the Euler identity $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, we get:\n$$-\\omega^2 m = C_1(2\\cos(ka) - 2) + C_2(2\\cos(2ka) - 2)$$\n$$\\omega^2 m = 2C_1(1 - \\cos(ka)) + 2C_2(1 - \\cos(2ka))$$\nEmploying the trigonometric identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$$\\omega^2 m = 2C_1 \\left(2\\sin^2\\left(\\frac{ka}{2}\\right)\\right) + 2C_2 \\left(2\\sin^2\\left(\\frac{2ka}{2}\\right)\\right)$$\n$$\\omega^2 m = 4C_1 \\sin^2\\left(\\frac{ka}{2}\\right) + 4C_2 \\sin^2(ka)$$\nThis gives the dispersion relation $\\omega(k)$:\n$$\\omega^2(k) = \\frac{4}{m} \\left(C_1 \\sin^2\\left(\\frac{ka}{2}\\right) + C_2 \\sin^2(ka)\\right)$$\nTaking the positive square root for the frequency:\n$$\\omega(k) = 2 \\sqrt{\\frac{1}{m} \\left(C_1 \\sin^2\\left(\\frac{ka}{2}\\right) + C_2 \\sin^2(ka)\\right)}$$\nThis completes the first part of the problem.\n\nNext, we must determine the ratio $\\alpha = C_2/C_1$ using the provided experimental data. Let us rewrite $\\omega^2(k)$ in terms of $\\alpha$:\n$$\\omega^2(k) = \\frac{4C_1}{m} \\left(\\sin^2\\left(\\frac{ka}{2}\\right) + \\alpha \\sin^2(ka)\\right)$$\nThe problem gives the ratio of frequencies at two specific wave vectors: $k_0 = 3\\pi/(4a)$ and the Brillouin zone boundary point $X$, where $k_X = \\pi/a$.\n\nFirst, we evaluate $\\omega^2(k)$ at $k_X = \\pi/a$:\n$$ka = \\pi \\implies \\frac{ka}{2} = \\frac{\\pi}{2}$$\n$$\\omega^2(X) = \\frac{4C_1}{m} \\left(\\sin^2\\left(\\frac{\\pi}{2}\\right) + \\alpha \\sin^2(\\pi)\\right) = \\frac{4C_1}{m} \\left(1^2 + \\alpha \\cdot 0^2\\right) = \\frac{4C_1}{m}$$\n\nNext, we evaluate $\\omega^2(k)$ at $k_0 = 3\\pi/(4a)$:\n$$ka = \\frac{3\\pi}{4} \\implies \\frac{ka}{2} = \\frac{3\\pi}{8}$$\n$$\\omega^2(k_0) = \\frac{4C_1}{m} \\left(\\sin^2\\left(\\frac{3\\pi}{8}\\right) + \\alpha \\sin^2\\left(\\frac{3\\pi}{4}\\right)\\right)$$\nWe use the identities $\\sin^2(\\theta) = (1-\\cos(2\\theta))/2$ and $\\sin(3\\pi/4) = \\sqrt{2}/2$:\n$$\\sin^2\\left(\\frac{3\\pi}{8}\\right) = \\frac{1 - \\cos(3\\pi/4)}{2} = \\frac{1 - (-\\sqrt{2}/2)}{2} = \\frac{2+\\sqrt{2}}{4}$$\n$$\\sin^2\\left(\\frac{3\\pi}{4}\\right) = \\left(\\frac{\\sqrt{2}}{2}\\right)^2 = \\frac{2}{4} = \\frac{1}{2}$$\nSubstituting these into the expression for $\\omega^2(k_0)$:\n$$\\omega^2(k_0) = \\frac{4C_1}{m} \\left(\\frac{2+\\sqrt{2}}{4} + \\alpha \\frac{1}{2}\\right)$$\n\nNow we construct the ratio $\\omega^2(k_0)/\\omega^2(X)$:\n$$\\frac{\\omega^2(k_0)}{\\omega^2(X)} = \\frac{\\frac{4C_1}{m} \\left(\\frac{2+\\sqrt{2}}{4} + \\frac{\\alpha}{2}\\right)}{\\frac{4C_1}{m}} = \\frac{2+\\sqrt{2}}{4} + \\frac{\\alpha}{2}$$\nThe problem provides the frequency ratio $\\omega(k_0)/\\omega(X) = 0.96$. Squaring this value gives the ratio of the squared frequencies:\n$$\\left(\\frac{\\omega(k_0)}{\\omega(X)}\\right)^2 = 0.96^2 = 0.9216$$\nWe can now form an equation for $\\alpha$:\n$$0.9216 = \\frac{2+\\sqrt{2}}{4} + \\frac{\\alpha}{2}$$\nSolving for $\\alpha$:\n$$\\frac{\\alpha}{2} = 0.9216 - \\frac{2+\\sqrt{2}}{4}$$\n$$\\alpha = 2 \\left(0.9216 - \\frac{2+\\sqrt{2}}{4}\\right) = 1.8432 - (1 + \\frac{\\sqrt{2}}{2}) = 0.8432 - \\frac{\\sqrt{2}}{2}$$\nTo obtain the numerical value, we use $\\sqrt{2} \\approx 1.41421356$:\n$$\\alpha \\approx 0.8432 - \\frac{1.41421356}{2} = 0.8432 - 0.70710678 = 0.13609322$$\nThe problem requires the value rounded to $3$ significant figures.\n$$\\alpha \\approx 0.136$$\nThis positive value for $\\alpha$ signifies that the next-nearest neighbor interaction is also a restoring force, which is physically expected for a stable crystal lattice.", "answer": "$$\\boxed{0.136}$$", "id": "2848436"}, {"introduction": "When examining computed or measured phonon dispersion curves, you will often encounter \"avoided crossings,\" where two branches approach but seem to repel each other. This is a tell-tale sign of an interaction or coupling between two different vibrational modes. In this practice, you will use a simple yet powerful $2 \\times 2$ matrix model to describe this phenomenon and extract the coupling strength $g$ from the \"observed\" frequencies of the coupled modes [@problem_id:2848464]. This exercise is fundamental to interpreting the rich information encoded in phonon band structures and understanding mode-mixing in solids.", "problem": "A two-mode avoided crossing between phonon branches near a wavevector can be modeled by the diagonalization of a real symmetric $2\\times 2$ subspace of the dynamical matrix that captures the interaction of two bare dispersions. Consider two bare (uncoupled) phonon frequencies $\\omega_1(k)$ and $\\omega_2(k)$ that depend linearly on the scalar wavevector $k$ (in inverse angstrom), and an off-diagonal, $k$-independent real coupling parameter $g$ (in terahertz). The coupled frequencies at each $k$ are obtained by diagonalizing the $2\\times 2$ matrix with diagonal entries $\\omega_1(k)$ and $\\omega_2(k)$ and off-diagonal entries $g$. Starting from the fundamental definition of normal modes as eigenvalues of the dynamical matrix and the fact that the subspace of two interacting branches is represented by a real symmetric $2\\times 2$ matrix, derive the coupled-mode frequencies as functions of $k$, $\\omega_1(k)$, $\\omega_2(k)$, and $g$, and then derive an explicit strategy to invert these relations to estimate $g$ from observed coupled frequencies at the same $k$ values. Your derivation must begin from the eigenvalue problem for a real symmetric $2\\times 2$ matrix and proceed without assuming any pre-derived spectral formulas.\n\nYou will then implement a program that:\n- Constructs synthetic \"observed\" coupled branches by exact diagonalization of the $2\\times 2$ model at a set of prescribed wavevectors $k$ using known bare dispersions and a known true coupling $g_{\\mathrm{true}}$ (noise-free).\n- Estimates the coupling $g$ from the synthetic observations and the known bare dispersions, using your derived inversion strategy at each $k$, aggregating the per-$k$ estimates into a single scalar estimate for each test case.\n- Reports the estimated $g$ for each test case in terahertz (THz), rounded to six decimals.\n\nAll frequencies must be expressed in terahertz (THz) and all wavevectors in inverse angstrom. The final output format must be a single line containing a comma-separated list of the estimated couplings for all test cases, enclosed in square brackets (e.g., $\"[0.123456,0.234567,0.345678]\"$).\n\nUse the following test suite of three cases. In each case, the bare dispersions are linear functions of $k$ of the form $\\omega_1(k)=c_1+v_1\\,(k-k_0)$ and $\\omega_2(k)=c_2+v_2\\,(k-k_0)$, with the given constants, and the synthetic observations are generated by diagonalizing the corresponding $2\\times 2$ matrix with off-diagonal coupling $g_{\\mathrm{true}}$ at the listed $k$ values.\n\n- Test case $1$ (happy path, moderate coupling and opposite slopes near the crossing):\n  - Parameters: $k_0=1.0$, $c_1=6.0$, $v_1=2.0$, $c_2=6.0$, $v_2=-1.0$, $g_{\\mathrm{true}}=0.30$.\n  - Wavevectors: $k\\in\\{0.8,\\,0.85,\\,0.9,\\,0.95,\\,1.0,\\,1.05,\\,1.1,\\,1.15,\\,1.2\\}$.\n\n- Test case $2$ (small coupling near a crossing away from $k=0$):\n  - Parameters: $k_0=0.0$, $c_1=5.0$, $v_1=1.5$, $c_2=6.0$, $v_2=-1.0$, $g_{\\mathrm{true}}=0.02$.\n  - Wavevectors: $k\\in\\{0.2,\\,0.3,\\,0.35,\\,0.4,\\,0.45,\\,0.5,\\,0.6\\}$.\n\n- Test case $3$ (one flat mode interacting with a dispersive mode):\n  - Parameters: $k_0=0.0$, $c_1=2.0$, $v_1=4.0$, $c_2=3.5$, $v_2=0.0$, $g_{\\mathrm{true}}=0.15$.\n  - Wavevectors: $k\\in\\{0.2,\\,0.3,\\,0.35,\\,0.375,\\,0.4,\\,0.45,\\,0.5\\}$.\n\nImplementation requirements:\n- For each test case, first compute the synthetic observed coupled frequencies at each $k$ by exactly diagonalizing the corresponding $2\\times 2$ matrix.\n- Then, using only the observed coupled frequencies and the known bare dispersions, compute an estimate $\\hat{g}(k)$ at each $k$ via your derived inversion, and aggregate these per-$k$ estimates into a single $\\hat{g}$ for the test case by taking the arithmetic mean over $k$.\n- Report the final estimates for the three test cases as a single line, formatted exactly as a Python list with values rounded to six decimals, in terahertz (THz).\n\nYour program must be self-contained, use no external input, and must produce a single line of output in the exact format described above.", "solution": "The problem statement has been subjected to rigorous validation and is found to be valid. It is scientifically grounded, well-posed, and objective. It presents a standard, albeit simplified, model of mode interaction in condensed matter physics, providing all necessary information for a complete and unique solution. We shall therefore proceed with the derivation and subsequent implementation.\n\nThe problem requires the derivation of coupled phonon frequencies from a simplified $2 \\times 2$ dynamical matrix and the subsequent inversion of this relationship to estimate the coupling parameter.\n\nLet the two uncoupled, or \"bare,\" phonon branches have frequencies $\\omega_1(k)$ and $\\omega_2(k)$, where $k$ is the scalar wavevector. The interaction between these two modes is described by a constant real coupling parameter $g$. The system's behavior is captured by the eigenvalues of the following $2 \\times 2$ real symmetric matrix, which represents the relevant subspace of the full dynamical matrix:\n$$\nD(k) = \\begin{pmatrix} \\omega_1(k)  g \\\\ g  \\omega_2(k) \\end{pmatrix}\n$$\nThe coupled-mode frequencies, which we denote as $\\omega$, are the eigenvalues of this matrix. The eigenvalues are found by solving the characteristic equation, $\\det(D(k) - \\omega I) = 0$, where $I$ is the $2 \\times 2$ identity matrix.\n$$\n\\det \\begin{pmatrix} \\omega_1(k) - \\omega  g \\\\ g  \\omega_2(k) - \\omega \\end{pmatrix} = 0\n$$\nExpanding the determinant gives the quadratic equation for $\\omega$:\n$$\n(\\omega_1(k) - \\omega)(\\omega_2(k) - \\omega) - g^2 = 0\n$$\n$$\n\\omega^2 - (\\omega_1(k) + \\omega_2(k))\\omega + (\\omega_1(k)\\omega_2(k) - g^2) = 0\n$$\nApplying the quadratic formula, $\\omega = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with $a=1$, $b = -(\\omega_1(k) + \\omega_2(k))$, and $c = \\omega_1(k)\\omega_2(k) - g^2$, we find the two solutions for $\\omega$, which represent the upper and lower coupled branches, denoted $\\omega_+(k)$ and $\\omega_-(k)$:\n$$\n\\omega_{\\pm}(k) = \\frac{(\\omega_1(k) + \\omega_2(k)) \\pm \\sqrt{(-(\\omega_1(k) + \\omega_2(k)))^2 - 4(1)(\\omega_1(k)\\omega_2(k) - g^2)}}{2}\n$$\nThe discriminant simplifies as follows:\n$$\n(\\omega_1(k) + \\omega_2(k))^2 - 4\\omega_1(k)\\omega_2(k) + 4g^2 = \\omega_1(k)^2 + 2\\omega_1(k)\\omega_2(k) + \\omega_2(k)^2 - 4\\omega_1(k)\\omega_2(k) + 4g^2\n$$\n$$\n= \\omega_1(k)^2 - 2\\omega_1(k)\\omega_2(k) + \\omega_2(k)^2 + 4g^2 = (\\omega_1(k) - \\omega_2(k))^2 + 4g^2\n$$\nThus, the frequencies of the coupled modes are:\n$$\n\\omega_{\\pm}(k) = \\frac{\\omega_1(k) + \\omega_2(k)}{2} \\pm \\frac{\\sqrt{(\\omega_1(k) - \\omega_2(k))^2 + 4g^2}}{2}\n$$\nThese are the so-called \"observed\" frequencies. Let us denote the upper observed branch as $\\Omega_{upper}(k) \\equiv \\omega_+(k)$ and the lower observed branch as $\\Omega_{lower}(k) \\equiv \\omega_-(k)$.\n\nNext, we must derive an explicit strategy to invert this relationship. The goal is to determine the coupling parameter $g$ from the knowledge of the bare frequencies, $\\omega_1(k)$ and $\\omega_2(k)$, and the observed coupled frequencies, $\\Omega_{upper}(k)$ and $\\Omega_{lower}(k)$.\n\nConsider the difference between the upper and lower observed frequencies:\n$$\n\\Delta\\Omega(k) = \\Omega_{upper}(k) - \\Omega_{lower}(k) = \\left( \\frac{\\omega_1(k) + \\omega_2(k)}{2} + \\frac{\\sqrt{(\\omega_1(k) - \\omega_2(k))^2 + 4g^2}}{2} \\right) - \\left( \\frac{\\omega_1(k) + \\omega_2(k)}{2} - \\frac{\\sqrt{(\\omega_1(k) - \\omega_2(k))^2 + 4g^2}}{2} \\right)\n$$\n$$\n\\Delta\\Omega(k) = \\sqrt{(\\omega_1(k) - \\omega_2(k))^2 + 4g^2}\n$$\nThis equation provides a direct path to $g$. Let $\\Delta\\omega(k) = \\omega_1(k) - \\omega_2(k)$ be the difference in the bare frequencies. Then:\n$$\n(\\Delta\\Omega(k))^2 = (\\Delta\\omega(k))^2 + 4g^2\n$$\nRearranging to solve for $g^2$:\n$$\n4g^2 = (\\Delta\\Omega(k))^2 - (\\Delta\\omega(k))^2\n$$\n$$\ng^2 = \\frac{(\\Omega_{upper}(k) - \\Omega_{lower}(k))^2 - (\\omega_1(k) - \\omega_2(k))^2}{4}\n$$\nSince the coupling strength $g$ is a real, positive-definite parameter by convention, we take the positive square root:\n$$\ng = \\frac{1}{2} \\sqrt{(\\Omega_{upper}(k) - \\Omega_{lower}(k))^2 - (\\omega_1(k) - \\omega_2(k))^2}\n$$\nThis is the required inversion formula. For each wavevector $k$, it provides an estimate $\\hat{g}(k)$ based on the observed and bare frequencies at that specific $k$.\n\nThe computational task requires implementing this procedure. For each test case:\n$1$. We are given the functional form of the bare dispersions, $\\omega_1(k) = c_1 + v_1(k - k_0)$ and $\\omega_2(k) = c_2 + v_2(k - k_0)$, a true coupling $g_{\\mathrm{true}}$, and a set of discrete wavevectors $k_i$.\n$2$. For each $k_i$, we first compute the synthetic \"observed\" coupled frequencies. This is achieved by constructing the matrix $D(k_i)$ with the known $\\omega_1(k_i)$, $\\omega_2(k_i)$, and $g_{\\mathrm{true}}$, and then computing its eigenvalues. These eigenvalues are our $\\Omega_{upper}(k_i)$ and $\\Omega_{lower}(k_i)$.\n$3$. With these synthetic data points, we then apply the derived inversion formula to compute an estimate $\\hat{g}(k_i)$.\n$4$. Since the synthetic data are generated from the model without noise, each $\\hat{g}(k_i)$ should be exactly equal to $g_{\\mathrm{true}}$, up to floating-point precision.\n$5$. Finally, we aggregate these per-$k$ estimates into a single value for the test case by calculating their arithmetic mean, $\\hat{g} = \\frac{1}{N} \\sum_{i=1}^{N} \\hat{g}(k_i)$. This final value is then reported.\n\nThe program will execute this logic for the three provided test cases and format the output as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating phonon mode coupling from synthetic data.\n    The process involves:\n    1. Defining the test cases with parameters for bare dispersions and true coupling.\n    2. For each test case, iterating through a set of wavevectors k.\n    3. At each k, generating synthetic \"observed\" coupled frequencies by diagonalizing\n       the 2x2 interaction matrix with the true coupling parameter.\n    4. Using the derived inversion formula to estimate the coupling g from the\n       synthetic data and known bare dispersions.\n    5. Averaging the estimates of g over all k-points for each test case.\n    6. Formatting and printing the final results.\n    \"\"\"\n\n    # Test cases are defined as tuples:\n    # (k0, c1, v1, c2, v2, g_true, k_values_list)\n    test_cases = [\n        # Test case 1\n        (1.0, 6.0, 2.0, 6.0, -1.0, 0.30, \n         [0.8, 0.85, 0.9, 0.95, 1.0, 1.05, 1.1, 1.15, 1.2]),\n        # Test case 2\n        (0.0, 5.0, 1.5, 6.0, -1.0, 0.02, \n         [0.2, 0.3, 0.35, 0.4, 0.45, 0.5, 0.6]),\n        # Test case 3\n        (0.0, 2.0, 4.0, 3.5, 0.0, 0.15,\n         [0.2, 0.3, 0.35, 0.375, 0.4, 0.45, 0.5])\n    ]\n\n    final_results = []\n\n    for case in test_cases:\n        k0, c1, v1, c2, v2, g_true, k_values = case\n        \n        g_estimates_per_k = []\n\n        for k in k_values:\n            # Step 1: Calculate bare frequencies\n            omega1_k = c1 + v1 * (k - k0)\n            omega2_k = c2 + v2 * (k - k0)\n\n            # Step 2: Generate synthetic \"observed\" data\n            # Construct the 2x2 dynamical matrix subspace\n            D_k = np.array([\n                [omega1_k, g_true],\n                [g_true,   omega2_k]\n            ])\n            \n            # Diagonalize to get observed coupled frequencies (eigenvalues)\n            # np.linalg.eigh returns sorted eigenvalues for Hermitian matrices\n            observed_omegas = np.linalg.eigh(D_k)[0]\n            omega_lower_obs = observed_omegas[0]\n            omega_upper_obs = observed_omegas[1]\n\n            # Step 3: Use the inversion formula to estimate g\n            # The formula is g = 0.5 * sqrt((Omega_upper - Omega_lower)^2 - (omega_1 - omega_2)^2)\n            \n            # Difference of observed frequencies, squared\n            delta_omega_obs_sq = (omega_upper_obs - omega_lower_obs)**2\n            \n            # Difference of bare frequencies, squared\n            delta_omega_bare_sq = (omega1_k - omega2_k)**2\n            \n            # Ensure the argument of the square root is non-negative to avoid NaN\n            # due to floating point inaccuracies. In this noise-free case, it\n            # should be mathematically non-negative.\n            term_inside_sqrt = delta_omega_obs_sq - delta_omega_bare_sq\n            if term_inside_sqrt  0:\n                term_inside_sqrt = 0 # Clamp at zero\n            \n            g_estimated = 0.5 * np.sqrt(term_inside_sqrt)\n            \n            g_estimates_per_k.append(g_estimated)\n\n        # Step 4: Aggregate per-k estimates by taking the arithmetic mean\n        final_g_estimate = np.mean(g_estimates_per_k)\n        final_results.append(final_g_estimate)\n\n    # Format the output as a single line: a comma-separated list of values\n    # rounded to six decimals, enclosed in square brackets.\n    formatted_results = [\"{:.6f}\".format(r) for r in final_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2848464"}]}