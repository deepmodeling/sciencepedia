{"hands_on_practices": [{"introduction": "The predictive power of any physical model is rooted in its derivation from fundamental principles. This first exercise grounds your understanding of the Einstein model by guiding you through its core derivation using the tools of statistical mechanics. Starting with a single quantum harmonic oscillator, you will build up to the expression for the total heat capacity, $C_V$, of a crystalline solid, reinforcing the crucial link between quantum energy levels and macroscopic thermodynamic properties. [@problem_id:2508240]", "problem": "A crystalline solid contains $N$ identical atoms arranged on a three-dimensional lattice. In the Einstein picture of lattice vibrations, each atom contributes independent vibrational modes that can be modeled as quantized oscillations.\n\n(a) State the physical assumptions of the Einstein model for lattice vibrations that you will use to analyze this system.\n\n(b) Starting only from the following fundamental elements:\n- the energy spectrum of a single quantum harmonic oscillator (QHO), $E_{n}=\\hbar \\omega \\left(n+\\tfrac{1}{2}\\right)$ with $n\\in\\{0,1,2,\\dots\\}$,\n- the canonical partition function definition $Z=\\sum_{n} \\exp(-\\beta E_{n})$ with $\\beta=1/(k_{\\mathrm{B}}T)$,\n- the relations $U=-\\partial \\ln Z/\\partial \\beta$ and $C_{V}=\\left(\\partial U/\\partial T\\right)_{V}$,\n\nderive a closed-form expression for the constant-volume heat capacity $C_{V}(T)$ of the solid in terms of $N$, the Boltzmann constant $k_{\\mathrm{B}}$, the temperature $T$, and the Einstein temperature $\\Theta_{E}\\equiv \\hbar \\omega_{E}/k_{\\mathrm{B}}$, where $\\omega_{E}$ is the characteristic angular frequency of the Einstein oscillators. Express the final result as a single analytic expression in simplest form. No numerical evaluation is required. Do not include units in your final boxed answer.", "solution": "The problem statement presented is a standard, well-posed problem in introductory solid-state physics and statistical mechanics. It is scientifically grounded, free of contradictions, and contains all necessary information for a rigorous derivation. The problem is therefore deemed **valid**. We proceed to the solution.\n\n(a) The assumptions of the Einstein model for the vibrational properties of a crystalline solid are as follows:\n$1$. The solid is composed of $N$ identical atoms arranged in a regular crystal lattice.\n$2$. Each atom vibrates about its fixed equilibrium lattice site. The vibrations of different atoms are assumed to be entirely independent of one another.\n$3$. The motion of each atom is isotropic and can be decomposed into three independent one-dimensional simple harmonic oscillators, corresponding to the three spatial dimensions. Consequently, the entire solid is modeled as a collection of $3N$ independent one-dimensional quantum harmonic oscillators (QHOs).\n$4$. All $3N$ of these QHOs are assumed to vibrate with the same, single characteristic angular frequency, denoted as $\\omega_{E}$. This is the central and most drastic simplification of the model.\n\n(b) The derivation of the heat capacity $C_{V}(T)$ proceeds from the fundamental principles provided.\n\nFirst, we determine the canonical partition function for a single one-dimensional quantum harmonic oscillator, $Z_{1}$. The energy levels are given as $E_{n} = \\hbar \\omega_{E} \\left(n + \\frac{1}{2}\\right)$ for $n \\in \\{0, 1, 2, \\dots\\}$. The partition function $Z_{1}$ is the sum over all states:\n$$Z_{1} = \\sum_{n=0}^{\\infty} \\exp(-\\beta E_{n}) = \\sum_{n=0}^{\\infty} \\exp\\left(-\\beta \\hbar \\omega_{E} \\left(n + \\frac{1}{2}\\right)\\right)$$\nwhere $\\beta = 1/(k_{\\mathrm{B}}T)$. We can factor out the term independent of the summation index $n$:\n$$Z_{1} = \\exp\\left(-\\frac{\\beta \\hbar \\omega_{E}}{2}\\right) \\sum_{n=0}^{\\infty} \\exp(-n \\beta \\hbar \\omega_{E}) = \\exp\\left(-\\frac{\\beta \\hbar \\omega_{E}}{2}\\right) \\sum_{n=0}^{\\infty} \\left[\\exp(-\\beta \\hbar \\omega_{E})\\right]^{n}$$\nThe sum is a geometric series of the form $\\sum_{n=0}^{\\infty} x^{n} = 1/(1-x)$ with $x = \\exp(-\\beta \\hbar \\omega_{E})$. The condition for convergence, $|x| < 1$, is satisfied since $T > 0$, which implies $\\beta \\hbar \\omega_{E} > 0$ and $\\exp(-\\beta \\hbar \\omega_{E}) < 1$. Therefore, the partition function for a single oscillator is:\n$$Z_{1} = \\frac{\\exp(-\\beta \\hbar \\omega_{E}/2)}{1 - \\exp(-\\beta \\hbar \\omega_{E})}$$\n\nAccording to the model assumptions, the solid consists of $3N$ independent and identical (and distinguishable by their lattice sites) oscillators. The total partition function of the system, $Z$, is the product of the individual partition functions:\n$$Z = (Z_{1})^{3N} = \\left[ \\frac{\\exp(-\\beta \\hbar \\omega_{E}/2)}{1 - \\exp(-\\beta \\hbar \\omega_{E})} \\right]^{3N}$$\nFor the calculation of thermodynamic properties, it is more convenient to work with the natural logarithm of the partition function:\n$$\\ln Z = 3N \\ln Z_{1} = 3N \\left[ \\ln\\left(\\exp\\left(-\\frac{\\beta \\hbar \\omega_{E}}{2}\\right)\\right) - \\ln\\left(1 - \\exp(-\\beta \\hbar \\omega_{E})\\right) \\right]$$\n$$\\ln Z = 3N \\left[ -\\frac{\\beta \\hbar \\omega_{E}}{2} - \\ln\\left(1 - \\exp(-\\beta \\hbar \\omega_{E})\\right) \\right]$$\n\nNext, we calculate the total internal energy $U$ of the solid using the relation $U = -\\frac{\\partial \\ln Z}{\\partial \\beta}$:\n$$U = -\\frac{\\partial}{\\partial \\beta} \\left( 3N \\left[ -\\frac{\\beta \\hbar \\omega_{E}}{2} - \\ln\\left(1 - \\exp(-\\beta \\hbar \\omega_{E})\\right) \\right] \\right)$$\n$$U = -3N \\left[ -\\frac{\\hbar \\omega_{E}}{2} - \\frac{1}{1 - \\exp(-\\beta \\hbar \\omega_{E})} \\cdot (-\\exp(-\\beta \\hbar \\omega_{E})) \\cdot (-\\hbar \\omega_{E}) \\right]$$\n$$U = -3N \\left[ -\\frac{\\hbar \\omega_{E}}{2} - \\frac{\\hbar \\omega_{E} \\exp(-\\beta \\hbar \\omega_{E})}{1 - \\exp(-\\beta \\hbar \\omega_{E})} \\right]$$\n$$U = 3N \\hbar \\omega_{E} \\left[ \\frac{1}{2} + \\frac{\\exp(-\\beta \\hbar \\omega_{E})}{1 - \\exp(-\\beta \\hbar \\omega_{E})} \\right]$$\nTo simplify the fraction, we can multiply the numerator and denominator by $\\exp(\\beta \\hbar \\omega_{E})$:\n$$\\frac{\\exp(-\\beta \\hbar \\omega_{E})}{1 - \\exp(-\\beta \\hbar \\omega_{E})} = \\frac{1}{\\exp(\\beta \\hbar \\omega_{E}) - 1}$$\nThe internal energy becomes:\n$$U = 3N \\hbar \\omega_{E} \\left[ \\frac{1}{2} + \\frac{1}{\\exp(\\beta \\hbar \\omega_{E}) - 1} \\right] = \\frac{3N \\hbar \\omega_{E}}{2} + \\frac{3N \\hbar \\omega_{E}}{\\exp(\\beta \\hbar \\omega_{E}) - 1}$$\nThe first term is the constant zero-point energy of the crystal, which does not depend on temperature.\n\nFinally, we find the heat capacity at constant volume, $C_{V} = \\left(\\frac{\\partial U}{\\partial T}\\right)_{V}$. We use the chain rule: $C_{V} = \\frac{\\partial U}{\\partial \\beta} \\frac{\\partial \\beta}{\\partial T}$.\nGiven $\\beta = \\frac{1}{k_{\\mathrm{B}}T}$, its derivative with respect to temperature is $\\frac{\\partial \\beta}{\\partial T} = -\\frac{1}{k_{\\mathrm{B}}T^{2}}$.\nNow we compute $\\frac{\\partial U}{\\partial \\beta}$. The constant zero-point energy term vanishes upon differentiation.\n$$\\frac{\\partial U}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta} \\left( \\frac{3N \\hbar \\omega_{E}}{\\exp(\\beta \\hbar \\omega_{E}) - 1} \\right)$$\n$$\\frac{\\partial U}{\\partial \\beta} = 3N \\hbar \\omega_{E} \\cdot (-1) \\cdot \\left(\\exp(\\beta \\hbar \\omega_{E}) - 1\\right)^{-2} \\cdot \\left(\\exp(\\beta \\hbar \\omega_{E}) \\cdot \\hbar \\omega_{E}\\right)$$\n$$\\frac{\\partial U}{\\partial \\beta} = -3N (\\hbar \\omega_{E})^{2} \\frac{\\exp(\\beta \\hbar \\omega_{E})}{\\left(\\exp(\\beta \\hbar \\omega_{E}) - 1\\right)^{2}}$$\nNow, combine the pieces to find $C_V$:\n$$C_{V} = \\left( -3N (\\hbar \\omega_{E})^{2} \\frac{\\exp(\\beta \\hbar \\omega_{E})}{(\\exp(\\beta \\hbar \\omega_{E}) - 1)^{2}} \\right) \\left( -\\frac{1}{k_{\\mathrm{B}}T^{2}} \\right)$$\n$$C_{V} = \\frac{3N (\\hbar \\omega_{E})^{2}}{k_{\\mathrm{B}}T^{2}} \\frac{\\exp(\\beta \\hbar \\omega_{E})}{(\\exp(\\beta \\hbar \\omega_{E}) - 1)^{2}}$$\nTo express this in terms of the given Einstein temperature, $\\Theta_{E} = \\frac{\\hbar \\omega_{E}}{k_{\\mathrm{B}}}$, we substitute $\\hbar \\omega_{E} = k_{\\mathrm{B}} \\Theta_{E}$. The exponent becomes $\\beta \\hbar \\omega_{E} = \\frac{1}{k_{\\mathrm{B}}T} (k_{\\mathrm{B}} \\Theta_{E}) = \\frac{\\Theta_{E}}{T}$. The prefactor becomes:\n$$\\frac{3N (\\hbar \\omega_{E})^{2}}{k_{\\mathrm{B}}T^{2}} = \\frac{3N (k_{\\mathrm{B}} \\Theta_{E})^{2}}{k_{\\mathrm{B}}T^{2}} = 3N k_{\\mathrm{B}} \\left(\\frac{\\Theta_{E}}{T}\\right)^{2}$$\nSubstituting these into the expression for $C_{V}$ gives the final result:\n$$C_{V}(T) = 3N k_{\\mathrm{B}} \\left(\\frac{\\Theta_{E}}{T}\\right)^{2} \\frac{\\exp(\\Theta_{E}/T)}{\\left(\\exp(\\Theta_{E}/T) - 1\\right)^{2}}$$\nThis is the heat capacity of a solid in the Einstein model.", "answer": "$$\n\\boxed{3 N k_{\\mathrm{B}} \\left(\\frac{\\Theta_{E}}{T}\\right)^{2} \\frac{\\exp(\\Theta_{E}/T)}{(\\exp(\\Theta_{E}/T) - 1)^{2}}}\n$$", "id": "2508240"}, {"introduction": "A powerful test of a physical model is its ability to predict how a system's properties change in response to a controlled modification. This practice challenges you to apply the Einstein model to a tangible physical scenario: the effect of isotopic mass on lattice heat capacity. Successfully solving this requires connecting the model's abstract frequency parameter, $\\omega_E$, to the physical mass of the vibrating atoms, thereby demonstrating a deeper command of the model's predictive capabilities. [@problem_id:2817503]", "problem": "A monatomic cubic crystal is well described in the Einstein model as an assembly of $3N$ independent quantum harmonic oscillators of a single characteristic angular frequency $\\omega_{E}$. Consider two isotopically enriched but otherwise identical samples, in which the atomic mass per lattice site is $m$ for sample A and $m+\\Delta m$ for sample B, with the interatomic force constant assumed independent of isotopic mass. Define $T^{\\ast}$ for a sample as the unique temperature at which the lattice heat capacity at constant volume (CV) equals one-half of the Dulong–Petit limit, i.e., $C_{V}(T^{\\ast}) = \\tfrac{1}{2}\\times 3N k_{\\mathrm{B}}$, where $k_{\\mathrm{B}}$ is the Boltzmann constant. Working within the Einstein model and starting from the canonical partition function of a single quantum harmonic oscillator, derive an analytic expression for the fractional shift in this characteristic temperature upon isotopic substitution,\n$$(T^{\\ast}_{B}-T^{\\ast}_{A})/T^{\\ast}_{A},$$\nexpressed solely in terms of $\\Delta m/m$. Do not assume any classical or asymptotic temperature limits. Your final answer must be a single closed-form expression (no units required).", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on the established Einstein model of lattice heat capacity, a standard topic in solid-state physics. The givens are sufficient and consistent for a unique solution. We shall therefore proceed with the derivation.\n\nThe problem requires a derivation starting from the canonical partition function of a single quantum harmonic oscillator (QHO). The energy levels of a QHO with angular frequency $\\omega_{E}$ are given by\n$$E_n = \\hbar \\omega_E \\left(n + \\frac{1}{2}\\right), \\quad n = 0, 1, 2, \\ldots$$\nThe partition function $Z_1$ for a single oscillator at a temperature $T$ is the sum over all states of the Boltzmann factor, $\\exp(-\\beta E_n)$, where $\\beta = (k_{\\mathrm{B}} T)^{-1}$.\n$$Z_1 = \\sum_{n=0}^{\\infty} \\exp(-\\beta E_n) = \\sum_{n=0}^{\\infty} \\exp\\left[-\\beta \\hbar \\omega_E \\left(n + \\frac{1}{2}\\right)\\right]$$\n$$Z_1 = \\exp\\left(-\\frac{\\beta \\hbar \\omega_E}{2}\\right) \\sum_{n=0}^{\\infty} \\left[\\exp(-\\beta \\hbar \\omega_E)\\right]^n$$\nThe summation is a geometric series with a ratio less than $1$, which converges to $(1 - \\exp(-\\beta \\hbar \\omega_E))^{-1}$. Thus,\n$$Z_1 = \\frac{\\exp(-\\beta \\hbar \\omega_E / 2)}{1 - \\exp(-\\beta \\hbar \\omega_E)}$$\nThe crystal consists of $N$ atoms, each free to oscillate in $3$ dimensions, modeled as $3N$ independent, distinguishable QHOs. The total partition function $Z$ for the system is $Z = (Z_1)^{3N}$. The mean internal energy $U$ of the crystal is found from the total partition function:\n$$U = -\\frac{\\partial \\ln Z}{\\partial \\beta} = -3N \\frac{\\partial \\ln Z_1}{\\partial \\beta}$$\nUsing the expression for $Z_1$, we find $\\ln Z_1$:\n$$\\ln Z_1 = -\\frac{\\beta \\hbar \\omega_E}{2} - \\ln\\left(1 - \\exp(-\\beta \\hbar \\omega_E)\\right)$$\nDifferentiating with respect to $\\beta$ yields:\n$$\\frac{\\partial \\ln Z_1}{\\partial \\beta} = -\\frac{\\hbar \\omega_E}{2} - \\frac{\\hbar \\omega_E}{\\exp(\\beta \\hbar \\omega_E) - 1}$$\nSubstituting this back into the expression for $U$:\n$$U = -3N \\left(-\\frac{\\hbar \\omega_E}{2} - \\frac{\\hbar \\omega_E}{\\exp(\\beta \\hbar \\omega_E) - 1}\\right) = 3N \\hbar \\omega_E \\left(\\frac{1}{2} + \\frac{1}{\\exp(\\beta \\hbar \\omega_E) - 1}\\right)$$\nThe heat capacity at constant volume is $C_V = \\left(\\frac{\\partial U}{\\partial T}\\right)_V$. It is more convenient to calculate this via $\\beta$, using $C_V = \\frac{\\partial U}{\\partial \\beta} \\frac{d\\beta}{dT} = \\frac{\\partial U}{\\partial \\beta} \\left(-\\frac{1}{k_{\\mathrm{B}} T^2}\\right) = -k_{\\mathrm{B}} \\beta^2 \\frac{\\partial U}{\\partial \\beta}$.\nDifferentiating $U$ with respect to $\\beta$:\n$$\\frac{\\partial U}{\\partial \\beta} = 3N \\hbar \\omega_E \\left[(-1)\\left(\\exp(\\beta \\hbar \\omega_E) - 1\\right)^{-2} \\cdot \\exp(\\beta \\hbar \\omega_E) \\cdot (\\hbar \\omega_E)\\right] = -3N(\\hbar \\omega_E)^2 \\frac{\\exp(\\beta \\hbar \\omega_E)}{(\\exp(\\beta \\hbar \\omega_E) - 1)^2}$$\nThus, the heat capacity is:\n$$C_V = -k_{\\mathrm{B}} \\beta^2 \\left[-3N(\\hbar \\omega_E)^2 \\frac{\\exp(\\beta \\hbar \\omega_E)}{(\\exp(\\beta \\hbar \\omega_E) - 1)^2}\\right] = 3N k_{\\mathrm{B}} (\\beta \\hbar \\omega_E)^2 \\frac{\\exp(\\beta \\hbar \\omega_E)}{(\\exp(\\beta \\hbar \\omega_E) - 1)^2}$$\nThe problem defines a characteristic temperature $T^{\\ast}$ where $C_V(T^{\\ast})$ equals one-half of the Dulong-Petit limit, $C_V(T^{\\ast}) = \\frac{1}{2} (3N k_{\\mathrm{B}})$. We set up the equation:\n$$\\frac{1}{2} (3N k_{\\mathrm{B}}) = 3N k_{\\mathrm{B}} \\left(\\frac{\\hbar \\omega_E}{k_{\\mathrm{B}} T^{\\ast}}\\right)^2 \\frac{\\exp\\left(\\frac{\\hbar \\omega_E}{k_{\\mathrm{B}} T^{\\ast}}\\right)}{\\left(\\exp\\left(\\frac{\\hbar \\omega_E}{k_{\\mathrm{B}} T^{\\ast}}\\right) - 1\\right)^2}$$\nLet us define the dimensionless variable $x^{\\ast} = \\frac{\\hbar \\omega_E}{k_{\\mathrm{B}} T^{\\ast}}$. The equation simplifies to:\n$$\\frac{1}{2} = (x^{\\ast})^2 \\frac{\\exp(x^{\\ast})}{(\\exp(x^{\\ast}) - 1)^2}$$\nThis is a transcendental equation for $x^{\\ast}$. A plot of the right-hand side as a function of $x^{\\ast}$ shows that it is a monotonically decreasing function for $x^{\\ast} > 0$, ensuring that there is a unique positive solution for $x^{\\ast}$. Let us denote this unique numerical constant by $x_0$. The crucial insight is that this value $x_0$ is universal for any substance within the Einstein model; it does not depend on $\\omega_E$ or any other material-specific parameter.\nTherefore, for any sample, we have the relation:\n$$x_0 = \\frac{\\hbar \\omega_E}{k_{\\mathrm{B}} T^{\\ast}}$$\nThis implies that $T^{\\ast}$ is directly proportional to the Einstein frequency $\\omega_E$:\n$$T^{\\ast} = \\frac{\\hbar}{k_{\\mathrm{B}} x_0} \\omega_E \\implies T^{\\ast} \\propto \\omega_E$$\nNext, we relate $\\omega_E$ to the atomic mass $m$. The oscillator's angular frequency is given by $\\omega_E = \\sqrt{k_{ifc}/m}$, where $k_{ifc}$ is the interatomic force constant. The problem states that $k_{ifc}$ is independent of isotopic mass. Thus, $\\omega_E$ is inversely proportional to the square root of the atomic mass:\n$$\\omega_E \\propto m^{-1/2}$$\nCombining the two proportionalities, we find the dependence of $T^{\\ast}$ on the atomic mass:\n$$T^{\\ast} \\propto m^{-1/2}$$\nNow, we can compare the two samples, A and B. For sample A, the mass is $m_A = m$ and the characteristic temperature is $T^{\\ast}_A$. For sample B, the mass is $m_B = m + \\Delta m$ and the characteristic temperature is $T^{\\ast}_B$. Using the proportionality, we form a ratio:\n$$\\frac{T^{\\ast}_B}{T^{\\ast}_A} = \\left(\\frac{m_B}{m_A}\\right)^{-1/2} = \\sqrt{\\frac{m_A}{m_B}}$$\nSubstituting the expressions for the masses:\n$$\\frac{T^{\\ast}_B}{T^{\\ast}_A} = \\sqrt{\\frac{m}{m + \\Delta m}} = \\sqrt{\\frac{1}{1 + \\frac{\\Delta m}{m}}} = \\left(1 + \\frac{\\Delta m}{m}\\right)^{-1/2}$$\nThe problem asks for the fractional shift in the characteristic temperature, which is $\\frac{T^{\\ast}_B - T^{\\ast}_A}{T^{\\ast}_A}$.\n$$\\frac{T^{\\ast}_B - T^{\\ast}_A}{T^{\\ast}_A} = \\frac{T^{\\ast}_B}{T^{\\ast}_A} - 1 = \\left(1 + \\frac{\\Delta m}{m}\\right)^{-1/2} - 1$$\nThis is the final expression, given entirely in terms of the fractional mass change $\\Delta m/m$, as required.", "answer": "$$\n\\boxed{\\left(1 + \\frac{\\Delta m}{m}\\right)^{-\\frac{1}{2}} - 1}\n$$", "id": "2817503"}, {"introduction": "An analytical formula is only as useful as our ability to evaluate it accurately. This final practice transitions from pen-and-paper theory to the practical realm of computational physics, a critical skill for any modern scientist or engineer. You will develop a numerically robust algorithm to calculate the Einstein heat capacity, confronting and solving common numerical pitfalls such as overflow at low temperatures and catastrophic cancellation at high temperatures. [@problem_id:2817515]", "problem": "An Einstein solid is modeled as a system of independent, identical quantum harmonic oscillators of angular frequency $\\omega$, each contributing to the constant-volume heat capacity ($C_V$) of the crystal. Let $\\hbar$ denote the reduced Planck constant, $k_{\\mathrm{B}}$ denote the Boltzmann constant, and $T$ denote the absolute temperature. Define the Einstein temperature $\\Theta_{\\mathrm{E}}$ by $\\Theta_{\\mathrm{E}} = \\hbar \\omega / k_{\\mathrm{B}}$ and the dimensionless variable $x = \\hbar \\omega / (k_{\\mathrm{B}} T) = \\Theta_{\\mathrm{E}} / T$. For a monatomic crystal, the molar heat capacity at constant volume is the sum of the contributions from three orthogonal oscillator degrees of freedom per atom.\n\nStarting from the canonical ensemble for a quantum harmonic oscillator and the definition of heat capacity as the temperature derivative of the internal energy at constant volume, derive a numerically stable expression for the molar constant-volume heat capacity $C_V$ of a monatomic Einstein solid as a function of $x$. Your derivation must be based on the following fundamental facts:\n- The canonical partition function $Z$ for a single quantum harmonic oscillator at temperature $T$.\n- The internal energy $U$ as the thermal average derived from $Z$.\n- The definition $C_V = \\left(\\partial U / \\partial T\\right)_V$.\nDo not use any pre-provided final formulas for $C_V$ in the statement of the problem; instead, build up from these fundamentals.\n\nYou must implement a program that evaluates the molar $C_V$ robustly for all regimes of $x$:\n- For $x \\ll 1$, avoid catastrophic cancellation; the result must recover the high-temperature limit and be accurate to within floating-point roundoff by using a controlled series expansion derived from first principles.\n- For $x \\gg 1$, avoid overflow in exponential functions; your algorithm must remain stable and return physically meaningful values that decrease rapidly toward zero.\n- For intermediate $x$, use algebraic rearrangements that avoid loss of significance, including functions that compute $e^x - 1$ and $\\ln(1 + y)$ in a numerically stable way.\n\nYour program must compute the molar $C_V$ in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ for the following test cases, each given by an Einstein temperature $\\Theta_{\\mathrm{E}}$ and temperature $T$, both in $\\mathrm{K}$:\n- Test $1$: $\\Theta_{\\mathrm{E}} = 300\\,\\mathrm{K}$, $T = 300\\,\\mathrm{K}$.\n- Test $2$: $\\Theta_{\\mathrm{E}} = 50\\,\\mathrm{K}$, $T = 1500\\,\\mathrm{K}$.\n- Test $3$: $\\Theta_{\\mathrm{E}} = 1200\\,\\mathrm{K}$, $T = 1\\,\\mathrm{K}$.\n- Test $4$: $\\Theta_{\\mathrm{E}} = 200\\,\\mathrm{K}$, $T = 600\\,\\mathrm{K}$.\n\nImplementation requirements:\n- Treat the solid as monatomic so that there are $3$ oscillator degrees of freedom per mole of atoms at high temperature.\n- Use the ideal-gas constant $R = N_{\\mathrm{A}} k_{\\mathrm{B}}$ with value $R = 8.31446261815324\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- Your algorithm must explicitly avoid naive use of $e^{x}$ when it would overflow and must avoid subtractive cancellation when $x$ is small. Use mathematically equivalent transformations and stable special functions (for example, an exponential-minus-one function) where appropriate.\n- Express all outputs in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, each rounded to $6$ decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the four results, in the order of the tests above, as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,r_3,r_4]$), where each $r_i$ is a floating-point number rounded to $6$ decimal places in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.", "solution": "We model the crystal as a set of independent, identical quantum harmonic oscillators. The canonical partition function for a single oscillator of angular frequency $\\omega$ at temperature $T$ is\n$$\nZ_1 = \\sum_{n=0}^{\\infty} \\exp\\!\\left(-\\beta \\hbar \\omega \\left(n + \\tfrac{1}{2}\\right)\\right)\n= \\frac{\\exp\\!\\left(-\\tfrac{1}{2}\\beta \\hbar \\omega\\right)}{1 - \\exp\\!\\left(-\\beta \\hbar \\omega\\right)},\n$$\nwhere $\\beta = 1/(k_{\\mathrm{B}} T)$. Define the dimensionless variable $x = \\beta \\hbar \\omega = \\hbar \\omega/(k_{\\mathrm{B}} T) = \\Theta_{\\mathrm{E}}/T$.\n\nThe Helmholtz free energy for one oscillator is $F_1 = -k_{\\mathrm{B}} T \\ln Z_1$. The internal energy for one oscillator is obtained via\n$$\nU_1 = -\\frac{\\partial}{\\partial \\beta} \\ln Z_1.\n$$\nUsing $\\ln Z_1 = -\\tfrac{1}{2} x - \\ln\\!\\left(1 - e^{-x}\\right)$ and $\\partial x/\\partial \\beta = \\hbar \\omega$, we obtain\n$$\nU_1 = \\hbar \\omega \\left(\\tfrac{1}{2} + \\frac{1}{e^{x} - 1}\\right).\n$$\nThe constant-volume heat capacity for one oscillator is\n$$\nC_{V,1} = \\left(\\frac{\\partial U_1}{\\partial T}\\right)_V\n= \\left(\\frac{\\partial U_1}{\\partial x}\\right)_V \\left(\\frac{\\partial x}{\\partial T}\\right)_V,\n$$\nwith $\\partial x/\\partial T = -\\Theta_{\\mathrm{E}}/T^2 = -x/T$. Differentiating $U_1$ with respect to $x$ yields\n$$\n\\frac{\\partial U_1}{\\partial x} = - \\hbar \\omega \\frac{e^{x}}{(e^{x} - 1)^{2}}.\n$$\nHence\n$$\nC_{V,1} = \\hbar \\omega \\frac{e^{x}}{(e^{x} - 1)^{2}} \\frac{x}{T}\n= k_{\\mathrm{B}} x^{2} \\frac{e^{x}}{(e^{x} - 1)^{2}}.\n$$\nFor a monatomic solid, there are $3$ orthogonal oscillator degrees of freedom per atom, so per mole of atoms,\n$$\nC_V = 3 N_{\\mathrm{A}} k_{\\mathrm{B}}\\, x^{2} \\frac{e^{x}}{(e^{x} - 1)^{2}} = 3 R\\, f(x),\n\\quad \\text{with} \\quad f(x) = x^{2} \\frac{e^{x}}{(e^{x} - 1)^{2}}.\n$$\n\nDirect evaluation of $f(x)$ can be numerically unstable:\n- For $x \\ll 1$, $e^{x} - 1 \\approx x$ leads to a near-zero denominator and subtractive cancellation in $e^{x} - 1$. A stable small-$x$ expansion is obtained via Bernoulli numbers or equivalently expanding $f(x)$:\n$$\nf(x) = 1 - \\frac{x^{2}}{12} + \\frac{x^{4}}{240} - \\frac{x^{6}}{6048} + \\frac{x^{8}}{172800} + \\mathcal{O}(x^{10}).\n$$\nThis recovers the Dulong–Petit limit $C_V \\to 3 R$ as $x \\to 0$.\n- For intermediate $x$, rewrite $f(x)$ using the Bose–Einstein occupation number\n$$\nn(x) = \\frac{1}{e^{x} - 1}.\n$$\nThen $f(x) = x^{2} n(x)\\bigl(1 + n(x)\\bigr)$, which avoids squaring small denominators and allows stable use of an exponential-minus-one function. One evaluates $n(x)$ using a numerically stable function for $e^{x} - 1$, namely an exponential-minus-one primitive. This prevents loss of significance when $x$ is small and prevents unnecessary overflow from forming $e^{x}$ directly when $x$ is moderate to large.\n- For $x \\gg 1$, the physically correct asymptotic is $f(x) \\sim x^{2} e^{-x}$, which is exponentially small. It is numerically stable to use $n(x) \\approx e^{-x}$ for very large $x$. In floating-point arithmetic, $e^{-x}$ underflows to zero for sufficiently large $x$, and the correct physical limit is then $C_V \\approx 0$.\n\nAlgorithm design:\n- Given $\\Theta_{\\mathrm{E}}$ and $T$ in $\\mathrm{K}$, compute $x = \\Theta_{\\mathrm{E}}/T$.\n- If $x < x_{\\mathrm{small}}$ with $x_{\\mathrm{small}}$ chosen as $10^{-3}$, evaluate $f(x)$ using the truncated series\n$$\nf(x) \\approx 1 - \\frac{x^{2}}{12} + \\frac{x^{4}}{240} - \\frac{x^{6}}{6048} + \\frac{x^{8}}{172800}.\n$$\nThis delivers machine-precision accuracy in double precision for $x \\lesssim 10^{-3}$.\n- Else, compute $t = \\mathrm{expm1}(x) = e^{x} - 1$ using a stable exponential-minus-one primitive. If $t$ is finite, set $n = 1/t$ and $f(x) = x^{2} n (1 + n)$. If $t$ is not finite (overflow), use the asymptotic $f(x) \\approx x^{2} e^{-x}$, computed as $\\exp(-x)$, which will underflow to zero for very large $x$ and is physically correct.\n- Return $C_V = 3 R f(x)$ in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n\nThis approach is stable in all regimes:\n- For $x \\ll 1$, the series eliminates cancellation and enforces the correct high-temperature limit $C_V \\to 3 R$.\n- For $x \\gg 1$, no large exponentials are ever formed; the algorithm decays $C_V$ to zero without overflow.\n- For intermediate $x$, using $n(x)$ and an exponential-minus-one primitive avoids loss of significance and overflow.\n\nThe program implements this logic and applies it to the specified tests:\n- Test $1$: $\\Theta_{\\mathrm{E}} = 300\\,\\mathrm{K}$, $T = 300\\,\\mathrm{K}$.\n- Test $2$: $\\Theta_{\\mathrm{E}} = 50\\,\\mathrm{K}$, $T = 1500\\,\\mathrm{K}$.\n- Test $3$: $\\Theta_{\\mathrm{E}} = 1200\\,\\mathrm{K}$, $T = 1\\,\\mathrm{K}$.\n- Test $4$: $\\Theta_{\\mathrm{E}} = 200\\,\\mathrm{K}$, $T = 600\\,\\mathrm{K}$.\n\nEach result is printed as a floating-point number rounded to $6$ decimal places in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, aggregated into a single bracketed, comma-separated list.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef einstein_molar_cv(theta_E_K: float, T_K: float) -> float:\n    \"\"\"\n    Compute the molar constant-volume heat capacity C_V (J/mol/K)\n    for a monatomic Einstein solid with Einstein temperature theta_E_K (K)\n    at temperature T_K (K), using a numerically stable formulation.\n    \"\"\"\n    R = 8.31446261815324  # J/mol/K\n    x = theta_E_K / T_K   # dimensionless\n\n    # Small-x threshold for series expansion\n    x_small = 1e-3\n\n    if x < x_small:\n        # Use stable series expansion: f(x) = 1 - x^2/12 + x^4/240 - x^6/6048 + x^8/172800\n        x2 = x * x\n        x4 = x2 * x2\n        x6 = x4 * x2\n        x8 = x4 * x4\n        f = (1.0\n             - x2 / 12.0\n             + x4 / 240.0\n             - x6 / 6048.0\n             + x8 / 172800.0)\n    else:\n        # Use Bose-Einstein occupation number with expm1 for stability\n        t = np.expm1(x)  # e^x - 1; may overflow to inf for huge x\n        if np.isfinite(t):\n            n = 1.0 / t\n            f = x * x * n * (1.0 + n)\n        else:\n            # For extremely large x, use asymptotic form x^2 e^{-x} ~ 0\n            f = x * x * np.exp(-x)\n\n    Cv = 3.0 * R * f\n    return Cv\n\ndef solve():\n    # Define the test cases from the problem statement: (Theta_E [K], T [K])\n    test_cases = [\n        (300.0, 300.0),   # Test 1\n        (50.0, 1500.0),   # Test 2\n        (1200.0, 1.0),    # Test 3\n        (200.0, 600.0),   # Test 4\n    ]\n\n    results = []\n    for theta_E, T in test_cases:\n        Cv = einstein_molar_cv(theta_E, T)\n        results.append(f\"{Cv:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2817515"}]}