{"hands_on_practices": [{"introduction": "While intrinsic defects are a natural consequence of entropy at finite temperatures, their equilibrium concentration is not solely determined by temperature. Introducing extrinsic dopants, particularly those with a different valence than the host ions (aliovalent doping), can dramatically alter the defect landscape. This is governed by the principle of charge neutrality, which demands that the total positive charge from defects and dopants must balance the total negative charge. This exercise [@problem_id:1977042] provides essential practice in combining the law of mass action for an intrinsic defect reaction with the charge neutrality condition in a doped ionic crystal, a cornerstone calculation in the field of defect chemistry.", "problem": "Magnesium oxide (MgO) is a ceramic material whose dominant intrinsic point defects at high temperature are Schottky pairs. A Schottky pair in MgO consists of one magnesium vacancy and one oxygen vacancy. Using KrÃ¶ger-Vink notation, these defects are denoted as $V_{Mg}^{''}$ and $V_{O}^{\\bullet\\bullet}$, respectively. The formation of these pairs is a thermally activated process governed by the equilibrium reaction: $\\text{null} \\rightleftharpoons V_{Mg}^{''} + V_{O}^{\\bullet\\bullet}$, where `null` represents the perfect crystal lattice. The corresponding mass-action equilibrium constant at a given temperature $T$ is denoted by $K_S$.\n\nTo modify its electrical properties, the MgO crystal is doped with a specific concentration of aluminum oxide ($\\text{Al}_2\\text{O}_3$). The aluminum ions ($\\text{Al}^{3+}$) are known to substitute for magnesium ions ($\\text{Mg}^{2+}$) on the cation sublattice, forming $Al_{Mg}^{\\bullet}$ defects. Let the total concentration of these substitutional aluminum defects be $C_{Al}$.\n\nAssume that the system is in thermodynamic equilibrium and that the concentrations of electronic defects (electrons and holes) are negligible compared to ionic defect concentrations. All defect concentrations are expressed as dimensionless mole fractions.\n\nDetermine the equilibrium concentration of oxygen vacancies, $[V_{O}^{\\bullet\\bullet}]$, in the doped MgO crystal. Express your answer as a formula in terms of $K_S$ and $C_{Al}$.", "solution": "Let $[V_{O}^{\\bullet\\bullet}] \\equiv c_{O}$, $[V_{Mg}^{''}] \\equiv c_{Mg}$, and $[Al_{Mg}^{\\bullet}] \\equiv C_{Al}$. The Schottky formation reaction is\n$$\\text{null} \\rightleftharpoons V_{Mg}^{''} + V_{O}^{\\bullet\\bullet},$$\nwith mass-action equilibrium constant\n$$K_{S} = [V_{Mg}^{''}][V_{O}^{\\bullet\\bullet}] = c_{Mg} c_{O}.$$\n\nCharge neutrality requires the sum of effective charges to vanish. The charges are: $V_{Mg}^{''}$ carries $-2$, $V_{O}^{\\bullet\\bullet}$ carries $+2$, and $Al_{Mg}^{\\bullet}$ carries $+1$. Thus,\n$$2 c_{O} + C_{Al} - 2 c_{Mg} = 0 \\quad \\Rightarrow \\quad c_{Mg} = c_{O} + \\frac{C_{Al}}{2}.$$\n\nSubstituting into the mass-action relation gives\n$$K_{S} = \\left(c_{O} + \\frac{C_{Al}}{2}\\right) c_{O} = c_{O}^{2} + \\frac{C_{Al}}{2} c_{O}.$$\nRewriting,\n$$c_{O}^{2} + \\frac{C_{Al}}{2} c_{O} - K_{S} = 0.$$\n\nSolving this quadratic for $c_{O}$ and choosing the physically meaningful (nonnegative) root,\n$$c_{O} = \\frac{-\\frac{C_{Al}}{2} + \\sqrt{\\left(\\frac{C_{Al}}{2}\\right)^{2} + 4 K_{S}}}{2} = \\frac{-C_{Al} + \\sqrt{C_{Al}^{2} + 16 K_{S}}}{4}.$$\n\nTherefore, the equilibrium oxygen vacancy concentration is\n$$[V_{O}^{\\bullet\\bullet}] = \\frac{-C_{Al} + \\sqrt{C_{Al}^{2} + 16 K_{S}}}{4}.$$", "answer": "$$\\boxed{\\frac{-C_{Al}+\\sqrt{C_{Al}^{2}+16K_{S}}}{4}}$$", "id": "1977042"}, {"introduction": "Beyond temperature and chemical composition, external thermodynamic variables like pressure provide another powerful lever for controlling defect populations. The formation of any defect is associated with a change in the crystal's volume, $\\Delta V_d$. When external hydrostatic pressure $P$ is applied, it introduces a work term, $P \\Delta V_d$, into the defect formation Gibbs free energy. This practice [@problem_id:1324770] explores this effect by comparing how pressure distinctively influences Schottky and Frenkel defect concentrations, offering insight into how mechanical stress can be used to engineer material properties at the atomic scale.", "problem": "In crystalline solids, the presence of intrinsic point defects is a thermodynamically driven phenomenon. The equilibrium concentration of these defects is determined by the Gibbs free energy of their formation. Consider two common types of defects in ionic crystals: Schottky defects, which consist of a pair of cation and anion vacancies, and Frenkel defects, which consist of a vacancy and an interstitial ion.\n\nWe wish to compare the behavior of these defects under external hydrostatic pressure. Consider two different model systems maintained at a constant absolute temperature $T$:\n1. Sodium chloride (NaCl), where Schottky defects are dominant. The formation of one Schottky defect pair results in a net volume change of the crystal by an amount $\\Delta V_S$, which is a positive quantity.\n2. Silver chloride (AgCl), where Frenkel defects in the cation sublattice are dominant. The formation of one Frenkel defect (a silver ion vacancy and a silver interstitial ion) results in a net volume change of the crystal by an amount $\\Delta V_F$, which is a negative quantity.\n\nThe change in the Gibbs free energy of defect formation, $\\Delta G_d$, due to an applied hydrostatic pressure $P$ is given by $\\Delta G_d(P) = \\Delta G_d(0) + P\\Delta V_d$, where $\\Delta G_d(0)$ is the formation energy at zero pressure and $\\Delta V_d$ is the volume change per defect.\n\nLet $n_S(P)$ and $n_F(P)$ be the equilibrium concentrations of Schottky defects in NaCl and Frenkel defects in AgCl, respectively, at pressure $P$. Let $n_S(0)$ and $n_F(0)$ be their respective concentrations at zero pressure.\n\nDerive a closed-form analytic expression for the ratio $R = \\frac{n_S(P)/n_S(0)}{n_F(P)/n_F(0)}$ in terms of the applied pressure $P$, temperature $T$, the activation volumes $\\Delta V_S$ and $\\Delta V_F$, and the Boltzmann constant $k_B$.", "solution": "At thermal equilibrium, the concentration of a defect species $d$ at pressure $P$ and temperature $T$ is proportional to the Boltzmann factor of its formation Gibbs free energy:\n$$\nn_{d}(P) \\propto \\exp\\left(-\\frac{\\Delta G_{d}(P)}{k_B T}\\right).\n$$\nThe pressure dependence of the formation Gibbs free energy is given by\n$$\n\\Delta G_{d}(P) = \\Delta G_{d}(0) + P \\Delta V_{d},\n$$\nwhere $\\Delta V_{d}$ is the volume change per defect. Therefore, the ratio of concentrations at pressure $P$ and at zero pressure for the same defect type $d$ is\n$$\n\\frac{n_{d}(P)}{n_{d}(0)} = \\exp\\left(-\\frac{\\Delta G_{d}(P) - \\Delta G_{d}(0)}{k_B T}\\right) = \\exp\\left(-\\frac{P \\Delta V_{d}}{k_B T}\\right).\n$$\nApplying this to Schottky defects in NaCl and Frenkel defects in AgCl gives\n$$\n\\frac{n_{S}(P)}{n_{S}(0)} = \\exp\\left(-\\frac{P \\Delta V_{S}}{k_B T}\\right), \\quad \\frac{n_{F}(P)}{n_{F}(0)} = \\exp\\left(-\\frac{P \\Delta V_{F}}{k_B T}\\right).\n$$\nThe requested ratio is thus\n$$\nR = \\frac{n_{S}(P)/n_{S}(0)}{n_{F}(P)/n_{F}(0)} = \\exp\\left(-\\frac{P}{k_B T}\\left(\\Delta V_{S} - \\Delta V_{F}\\right)\\right).\n$$\nBecause $\\Delta V_{S} > 0$ and $\\Delta V_{F} < 0$, the exponent is negative for $P>0$, implying that pressure suppresses Schottky defects and enhances Frenkel defects, consistent with physical expectations.", "answer": "$$\\boxed{\\exp\\left(-\\frac{P}{k_B T}\\left(\\Delta V_{S}-\\Delta V_{F}\\right)\\right)}$$", "id": "1324770"}, {"introduction": "In many materials, particularly semiconductors and insulators, defects are electronically active, existing in various charge states. The formation energy of a charged defect is not a fixed value but depends linearly on the electronic chemical potential, or Fermi level, $E_F$. In turn, the equilibrium Fermi level is determined by the overall charge balance between these charged defects and free electronic carriers (electrons and holes). This intricate coupling creates a self-consistent problem that is central to understanding the electronic properties of materials. This advanced computational exercise [@problem_id:2820008] walks you through the process of building a numerical model to solve for the equilibrium Fermi level and all corresponding defect and carrier concentrations, mirroring a fundamental methodology in modern computational materials physics.", "problem": "You are given a model for equilibrium concentrations of charged point defects in a crystalline solid, where the electron reservoir is characterized by a Fermi level $E_{\\mathrm{F}}$ measured relative to the valence-band maximum at $E_{\\mathrm{V}}=0$. The conduction-band minimum is at $E_{\\mathrm{C}}=E_{\\mathrm{g}}$. The system is assumed to be dilute and nondegenerate, and the temperature is $T$. The goal is to determine the equilibrium Fermi level and the resulting concentrations of mobile carriers and defects by enforcing charge neutrality.\n\nFundamental base and modeling assumptions:\n- Each defect species has a large reservoir of equivalent lattice sites with count $N_{\\mathrm{sites}}$ (in $\\mathrm{cm^{-3}}$). In the dilute limit, configurational interactions between defects are negligible, and each distinguishable charge state $q$ of a defect contributes independently to the equilibrium, with a degeneracy factor $g_q$ accounting for microstate multiplicity. The equilibrium thermally averaged concentration $c_q$ of charge state $q$ is controlled by its formation free energy $E_{\\mathrm{f}}(q;E_{\\mathrm{F}})$ via the Boltzmann factor.\n- Electron and hole populations in the conduction and valence bands are nondegenerate and can be described by effective densities of states. The carrier populations respond to $E_{\\mathrm{F}}$ at temperature $T$.\n- Electroneutrality holds at equilibrium: total positive charge density equals total negative charge density. Positive charge arises from positively charged defects and holes; negative charge arises from negatively charged defects and electrons.\n\nFrom these principles, derive the expressions needed to compute:\n1. The equilibrium concentration $c_q$ of a defect charge state $q$ at a given $E_{\\mathrm{F}}$ and $T$, given its formation free energy intercept at $E_{\\mathrm{F}}=0$, its charge $q$, and degeneracy $g_q$.\n2. The electron density $n$ and hole density $p$ as functions of $E_{\\mathrm{F}}$, the band gap $E_{\\mathrm{g}}$, and the effective densities of states $N_{\\mathrm{C}}$ and $N_{\\mathrm{V}}$.\n3. The charge-neutrality condition as a scalar equation in $E_{\\mathrm{F}}$ on the interval $[0,E_{\\mathrm{g}}]$.\n\nThen implement a robust numerical method that finds the unique solution $E_{\\mathrm{F}} \\in [0,E_{\\mathrm{g}}]$ to the charge-neutrality equation, and computes the total concentrations of two defect species:\n- A donor-like species $\\mathrm{D}$ with charge states $q \\in \\{0,+1,+2\\}$,\n- An acceptor-like species $\\mathrm{A}$ with charge states $q \\in \\{0,-1,-2\\}$.\n\nFor each test case below, use the provided parameters. Use the following constants and conventions:\n- Use the Boltzmann constant $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}$.\n- All energies must be in $\\mathrm{eV}$.\n- All carrier and defect concentrations must be in $\\mathrm{cm^{-3}}$.\n- The Fermi level $E_{\\mathrm{F}}$ is constrained to $[0,E_{\\mathrm{g}}]$.\n\nTest suite (three cases), each specified by $(T, E_{\\mathrm{g}}, N_{\\mathrm{C}}, N_{\\mathrm{V}}, \\mathrm{D}, \\mathrm{A})$:\n- Case 1:\n  - $T = 1200\\,\\mathrm{K}$,\n  - $E_{\\mathrm{g}} = 3.2\\,\\mathrm{eV}$,\n  - $N_{\\mathrm{C}} = 5.0\\times 10^{19}\\,\\mathrm{cm^{-3}}$,\n  - $N_{\\mathrm{V}} = 1.0\\times 10^{20}\\,\\mathrm{cm^{-3}}$,\n  - $\\mathrm{D}$: $N_{\\mathrm{sites}} = 1.0\\times 10^{22}\\,\\mathrm{cm^{-3}}$, charge states with $(q,E_{\\mathrm{f}}^{0}(q),g_q)$ given by:\n    - $(0, 2.8\\,\\mathrm{eV}, 1)$,\n    - $(+1, 2.0\\,\\mathrm{eV}, 2)$,\n    - $(+2, 3.0\\,\\mathrm{eV}, 1)$,\n  - $\\mathrm{A}$: $N_{\\mathrm{sites}} = 1.0\\times 10^{22}\\,\\mathrm{cm^{-3}}$, charge states:\n    - $(0, 2.7\\,\\mathrm{eV}, 1)$,\n    - $(-1, 2.2\\,\\mathrm{eV}, 1)$,\n    - $(-2, 4.0\\,\\mathrm{eV}, 1)$.\n- Case 2:\n  - $T = 800\\,\\mathrm{K}$,\n  - $E_{\\mathrm{g}} = 1.1\\,\\mathrm{eV}$,\n  - $N_{\\mathrm{C}} = 3.0\\times 10^{19}\\,\\mathrm{cm^{-3}}$,\n  - $N_{\\mathrm{V}} = 2.0\\times 10^{19}\\,\\mathrm{cm^{-3}}$,\n  - $\\mathrm{D}$: $N_{\\mathrm{sites}} = 1.0\\times 10^{22}\\,\\mathrm{cm^{-3}}$, charge states:\n    - $(0, 3.0\\,\\mathrm{eV}, 1)$,\n    - $(+1, 3.0\\,\\mathrm{eV}, 2)$,\n    - $(+2, 4.5\\,\\mathrm{eV}, 1)$,\n  - $\\mathrm{A}$: $N_{\\mathrm{sites}} = 1.0\\times 10^{22}\\,\\mathrm{cm^{-3}}$, charge states:\n    - $(0, 2.0\\,\\mathrm{eV}, 1)$,\n    - $(-1, 1.5\\,\\mathrm{eV}, 1)$,\n    - $(-2, 3.5\\,\\mathrm{eV}, 1)$.\n- Case 3:\n  - $T = 1000\\,\\mathrm{K}$,\n  - $E_{\\mathrm{g}} = 6.0\\,\\mathrm{eV}$,\n  - $N_{\\mathrm{C}} = 3.0\\times 10^{19}\\,\\mathrm{cm^{-3}}$,\n  - $N_{\\mathrm{V}} = 3.0\\times 10^{19}\\,\\mathrm{cm^{-3}}$,\n  - $\\mathrm{D}$: $N_{\\mathrm{sites}} = 1.0\\times 10^{22}\\,\\mathrm{cm^{-3}}$, charge states:\n    - $(0, 1.8\\,\\mathrm{eV}, 1)$,\n    - $(+1, 1.2\\,\\mathrm{eV}, 2)$,\n    - $(+2, 1.6\\,\\mathrm{eV}, 1)$,\n  - $\\mathrm{A}$: $N_{\\mathrm{sites}} = 1.0\\times 10^{22}\\,\\mathrm{cm^{-3}}$, charge states:\n    - $(0, 3.0\\,\\mathrm{eV}, 1)$,\n    - $(-1, 3.2\\,\\mathrm{eV}, 1)$,\n    - $(-2, 5.0\\,\\mathrm{eV}, 1)$.\n\nTasks:\n- For each case, solve the charge-neutrality condition to obtain $E_{\\mathrm{F}}$.\n- Compute the electron density $n$ and hole density $p$ corresponding to that $E_{\\mathrm{F}}$.\n- Compute the total concentration of defects of species $\\mathrm{D}$ and $\\mathrm{A}$ as $c_{\\mathrm{D}} = \\sum_{q\\in\\{0,+1,+2\\}} c_q$ and $c_{\\mathrm{A}} = \\sum_{q\\in\\{0,-1,-2\\}} c_q$.\n\nRequired numerical output and formatting:\n- Units: Report $E_{\\mathrm{F}}$ in $\\mathrm{eV}$, and $n$, $p$, $c_{\\mathrm{D}}$, $c_{\\mathrm{A}}$ in $\\mathrm{cm^{-3}}$. Do not print unit symbols; the units are implied.\n- Rounding: Round each reported number to $6$ significant figures.\n- Output format: Your program should produce a single line of output containing a list of three lists, one per test case, each inner list ordered as $[E_{\\mathrm{F}}, n, p, c_{\\mathrm{D}}, c_{\\mathrm{A}}]$. The outer and inner lists must be comma-separated and enclosed in square brackets. For example, the printed line should look like\n  $[ [x_{1},y_{1},z_{1},u_{1},v_{1}], [x_{2},y_{2},z_{2},u_{2},v_{2}], [x_{3},y_{3},z_{3},u_{3},v_{3}] ]$,\n  where each symbol denotes a float rounded to $6$ significant figures.", "solution": "The problem statement has been subjected to rigorous validation and is found to be scientifically sound, well-posed, and complete. It presents a standard, canonical problem in the physics of materials concerning the self-consistent calculation of equilibrium defect and carrier concentrations. The provided parameters and assumptions are physically reasonable and mathematically consistent. Therefore, we proceed with the solution.\n\nThe analysis is based on the principles of statistical mechanics applied to a crystalline solid at thermal equilibrium. The system consists of a crystal lattice with possible point defects, and a reservoir of electrons described by the Fermi-Dirac distribution, which in the non-degenerate limit simplifies to the Boltzmann distribution. The equilibrium state is determined by minimizing the total free energy of the system, which is equivalent to satisfying the charge neutrality condition.\n\nFirst, we derive the necessary expressions. All energies are expressed in electron-volts ($\\mathrm{eV}$) and the Fermi level $E_{\\mathrm{F}}$ is measured from the valence band maximum, i.e., $E_{\\mathrm{V}} = 0$. The conduction band minimum is at $E_{\\mathrm{C}} = E_{\\mathrm{g}}$.\n\n1.  **Concentration of a Defect Charge State ($c_q$)**\n    The formation free energy of a defect in a charge state $q$ is a linear function of the Fermi level $E_{\\mathrm{F}}$:\n    $$E_{\\mathrm{f}}(q; E_{\\mathrm{F}}) = E_{\\mathrm{f}}^{0}(q) + q E_{\\mathrm{F}}$$\n    where $E_{\\mathrm{f}}^{0}(q)$ is the formation energy at $E_{\\mathrm{F}} = 0$. In the dilute approximation, where defect concentrations are far less than the density of available lattice sites $N_{\\mathrm{sites}}$, the equilibrium concentration $c_q$ follows the Boltzmann statistics:\n    $$c_q(E_{\\mathrm{F}}) = N_{\\mathrm{sites}} g_q \\exp\\left(-\\frac{E_{\\mathrm{f}}(q; E_{\\mathrm{F}})}{k_{\\mathrm{B}}T}\\right)$$\n    Substituting the expression for the formation energy, we obtain the concentration of a single charge state $q$ of a given defect species as a function of $E_{\\mathrm{F}}$ and temperature $T$:\n    $$c_q(E_{\\mathrm{F}}) = N_{\\mathrm{sites}} g_q \\exp\\left(-\\frac{E_{\\mathrm{f}}^{0}(q) + q E_{\\mathrm{F}}}{k_{\\mathrm{B}}T}\\right)$$\n    Here, $g_q$ is the degeneracy factor for the charge state, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $T$ is the absolute temperature.\n\n2.  **Electron and Hole Concentrations ($n, p$)**\n    Under the assumption of non-degenerate statistics for the charge carriers, the concentrations of electrons ($n$) in the conduction band and holes ($p$) in the valence band are given by:\n    $$n(E_{\\mathrm{F}}) = N_{\\mathrm{C}} \\exp\\left(-\\frac{E_{\\mathrm{C}} - E_{\\mathrm{F}}}{k_{\\mathrm{B}}T}\\right)$$\n    $$p(E_{\\mathrm{F}}) = N_{\\mathrm{V}} \\exp\\left(-\\frac{E_{\\mathrm{F}} - E_{\\mathrm{V}}}{k_{\\mathrm{B}}T}\\right)$$\n    where $N_{\\mathrm{C}}$ and $N_{\\mathrm{V}}$ are the effective densities of states in the conduction and valence bands, respectively. Using the established energy references ($E_{\\mathrm{V}} = 0$, $E_{\\mathrm{C}} = E_{\\mathrm{g}}$), these become:\n    $$n(E_{\\mathrm{F}}) = N_{\\mathrm{C}} \\exp\\left(-\\frac{E_{\\mathrm{g}} - E_{\\mathrm{F}}}{k_{\\mathrm{B}}T}\\right)$$\n    $$p(E_{\\mathrm{F}}) = N_{\\mathrm{V}} \\exp\\left(-\\frac{E_{\\mathrm{F}}}{k_{\\mathrm{B}}T}\\right)$$\n\n3.  **Charge-Neutrality Condition**\n    The cornerstone of this equilibrium problem is the enforcement of macroscopic charge neutrality. The total density of positive charge must equal the total density of negative charge. Positive charges are holes and positively charged defects. Negative charges are electrons and negatively charged defects.\n    $$\\sum_{\\text{positive charges}} \\text{density} = \\sum_{\\text{negative charges}} \\text{density}$$\n    We define a net charge density function, $\\rho(E_{\\mathrm{F}})$, whose root corresponds to the equilibrium Fermi level.\n    $$\\rho(E_{\\mathrm{F}}) = p(E_{\\mathrm{F}}) - n(E_{\\mathrm{F}}) + \\sum_{i \\in \\{\\mathrm{D}, \\mathrm{A}\\}} \\sum_q q \\cdot c_q^i(E_{\\mathrm{F}}) = 0$$\n    The term $q \\cdot c_q^i$ correctly accounts for the contribution of each defect state to the net charge density. For the specified donor ($\\mathrm{D}$) and acceptor ($\\mathrm{A}$) defects, the equation is:\n    $$\\rho(E_{\\mathrm{F}}) = p(E_{\\mathrm{F}}) - n(E_{\\mathrm{F}}) + \\left[ (1)c_{+1}^{\\mathrm{D}}(E_{\\mathrm{F}}) + (2)c_{+2}^{\\mathrm{D}}(E_{\\mathrm{F}}) \\right] + \\left[ (-1)c_{-1}^{\\mathrm{A}}(E_{\\mathrm{F}}) + (-2)c_{-2}^{\\mathrm{A}}(E_{\\mathrm{F}}) \\right] = 0$$\n    Each term in this equation depends on $E_{\\mathrm{F}}$. The function $\\rho(E_{\\mathrm{F}})$ is strictly monotonic (specifically, a decreasing function) over the interval $E_{\\mathrm{F}} \\in [0, E_{\\mathrm{g}}]$, because the concentration of every positive species decreases with increasing $E_{\\mathrm{F}}$ while the concentration of every negative species increases with increasing $E_{\\mathrm{F}}$. This guarantees a unique solution for $E_{\\mathrm{F}}$ within the band gap, provided a sign change occurs, which is characteristic of physically realistic systems.\n\n**Numerical Solution Strategy**\n\nThe problem reduces to finding the root of the scalar, monotonic function $\\rho(E_{\\mathrm{F}}) = 0$ on the bounded interval $[0, E_{\\mathrm{g}}]$. For this task, a robust bracketing root-finding algorithm is appropriate. We will employ Brent's method, as implemented in the `scipy.optimize.brentq` library function, which combines the reliability of the bisection method with the speed of secant and inverse quadratic interpolation methods.\n\nFor each test case, the following procedure is executed:\n1.  Define the charge neutrality function $\\rho(E_{\\mathrm{F}})$ using the specific parameters ($T$, $E_{\\mathrm{g}}$, $N_{\\mathrm{C}}$, $N_{\\mathrm{V}}$, and defect properties) for that case.\n2.  Numerically solve for the equilibrium Fermi level $E_{\\mathrm{F}}^{*}$ by finding the root of $\\rho(E_{\\mathrm{F}}) = 0$ in the interval $[0, E_{\\mathrm{g}}]$.\n3.  Using the obtained $E_{\\mathrm{F}}^{*}$, calculate the final quantities:\n    -   Electron concentration $n = n(E_{\\mathrm{F}}^{*})$.\n    -   Hole concentration $p = p(E_{\\mathrm{F}}^{*})$.\n    -   Total donor concentration $c_{\\mathrm{D}} = \\sum_{q \\in \\{0, +1, +2\\}} c_q^{\\mathrm{D}}(E_{\\mathrm{F}}^{*})$.\n    -   Total acceptor concentration $c_{\\mathrm{A}} = \\sum_{q \\in \\{0, -1, -2\\}} c_q^{\\mathrm{A}}(E_{\\mathrm{F}}^{*})$.\n4.  The results are formatted to $6$ significant figures and presented in the specified nested list structure.\nThe implementation will use the provided value of the Boltzmann constant $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}$.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for equilibrium Fermi level and defect/carrier concentrations\n    in a crystalline solid for a given set of test cases.\n    \"\"\"\n    KB = 8.617333262145e-5  # Boltzmann constant in eV/K\n\n    test_cases = [\n        # Case 1\n        {\n            \"T\": 1200, \"Eg\": 3.2, \"NC\": 5.0e19, \"NV\": 1.0e20,\n            \"D\": {\"Nsites\": 1.0e22, \"states\": [(0, 2.8, 1), (+1, 2.0, 2), (+2, 3.0, 1)]},\n            \"A\": {\"Nsites\": 1.0e22, \"states\": [(0, 2.7, 1), (-1, 2.2, 1), (-2, 4.0, 1)]}\n        },\n        # Case 2\n        {\n            \"T\": 800, \"Eg\": 1.1, \"NC\": 3.0e19, \"NV\": 2.0e19,\n            \"D\": {\"Nsites\": 1.0e22, \"states\": [(0, 3.0, 1), (+1, 3.0, 2), (+2, 4.5, 1)]},\n            \"A\": {\"Nsites\": 1.0e22, \"states\": [(0, 2.0, 1), (-1, 1.5, 1), (-2, 3.5, 1)]}\n        },\n        # Case 3\n        {\n            \"T\": 1000, \"Eg\": 6.0, \"NC\": 3.0e19, \"NV\": 3.0e19,\n            \"D\": {\"Nsites\": 1.0e22, \"states\": [(0, 1.8, 1), (+1, 1.2, 2), (+2, 1.6, 1)]},\n            \"A\": {\"Nsites\": 1.0e22, \"states\": [(0, 3.0, 1), (-1, 3.2, 1), (-2, 5.0, 1)]}\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        T = case[\"T\"]\n        Eg = case[\"Eg\"]\n        NC = case[\"NC\"]\n        NV = case[\"NV\"]\n        defect_D_props = case[\"D\"]\n        defect_A_props = case[\"A\"]\n        \n        kBT = KB * T\n\n        def calculate_concentrations(EF, defects):\n            \"\"\"Calculates concentrations for a defect species at a given EF.\"\"\"\n            concs = {}\n            for q, E0, g in defects[\"states\"]:\n                # Formation energy: E_f = E0 + q*EF\n                # Concentration: c = N_sites * g * exp(-E_f / kBT)\n                exponent = -(E0 + q * EF) / kBT\n                concs[q] = defects[\"Nsites\"] * g * np.exp(exponent)\n            return concs\n\n        def net_charge_density(EF):\n            \"\"\"\n            Calculates the total net charge density in the system\n            as a function of the Fermi level EF. The root of this function\n            is the equilibrium Fermi level.\n            rho(EF) = p - n + sum(q * c_q)\n            \"\"\"\n            # Carrier concentrations\n            n = NC * np.exp(-(Eg - EF) / kBT)\n            p = NV * np.exp(-EF / kBT)\n            \n            # Defect concentrations and their charge contribution\n            donor_concs = calculate_concentrations(EF, defect_D_props)\n            acceptor_concs = calculate_concentrations(EF, defect_A_props)\n            \n            defect_charge = 0.0\n            for q, c in donor_concs.items():\n                defect_charge += q * c\n            for q, c in acceptor_concs.items():\n                defect_charge += q * c\n                \n            return p - n + defect_charge\n\n        # Find the root of the net charge density function to get equilibrium EF\n        # The search interval is the band gap [0, Eg].\n        try:\n            EF_eq = brentq(net_charge_density, 0, Eg, xtol=1e-12, rtol=1e-12)\n        except ValueError:\n            # This would happen if net_charge_density(0) and net_charge_density(Eg)\n            # have the same sign, indicating no root in the interval.\n            # For this well-posed problem, this should not occur.\n            EF_eq = np.nan # Or handle error appropriately\n\n        # Calculate final quantities at equilibrium EF\n        n_eq = NC * np.exp(-(Eg - EF_eq) / kBT)\n        p_eq = NV * np.exp(-EF_eq / kBT)\n\n        donor_concs_eq = calculate_concentrations(EF_eq, defect_D_props)\n        cD_total = sum(donor_concs_eq.values())\n\n        acceptor_concs_eq = calculate_concentrations(EF_eq, defect_A_props)\n        cA_total = sum(acceptor_concs_eq.values())\n\n        # Store results for this case\n        case_results = [EF_eq, n_eq, p_eq, cD_total, cA_total]\n        all_results.append(case_results)\n\n    # Format output to 6 significant figures and print in the required format\n    output_parts = []\n    for inner_list in all_results:\n        formatted_list = [f\"{val:.6g}\" for val in inner_list]\n        output_parts.append(f\"[{','.join(formatted_list)}]\")\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2820008"}]}