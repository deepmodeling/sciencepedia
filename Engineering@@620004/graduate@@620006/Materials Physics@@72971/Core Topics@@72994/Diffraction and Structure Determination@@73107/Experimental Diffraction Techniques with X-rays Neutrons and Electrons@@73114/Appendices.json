{"hands_on_practices": [{"introduction": "Understanding any diffraction pattern fundamentally requires fluency in the language of reciprocal space. This mathematical construct, which is the Fourier transform of the real-space crystal lattice, provides the map upon which diffraction spots are located. This exercise [@problem_id:2821810] provides essential practice in deriving the basis vectors of the reciprocal lattice from those of a direct lattice, using a monoclinic crystal as a non-trivial example. Mastering this direct-to-reciprocal transformation is the first and most critical step toward indexing experimental diffraction data and comprehending the geometric conditions for diffraction.", "problem": "In a diffraction experiment on a monoclinic crystal (unique axis $\\,\\mathbf{b}\\,$), the direct lattice is characterized by edge lengths $\\,a\\,$, $\\,b\\,$, and $\\,c\\,$ and interaxial angles $\\,\\alpha = \\gamma = 90^{\\circ}\\,$ and $\\,\\beta \\in (0,\\pi)\\,$ between $\\,\\mathbf{a}\\,$ and $\\,\\mathbf{c}\\,$. The metric tensor $\\,G\\,$ in the direct lattice basis has elements $\\,g_{ij} = \\mathbf{a}_{i}\\cdot \\mathbf{a}_{j}\\,$ given by\n$$\nG \\equiv \\begin{pmatrix}\na^{2} & 0 & a c \\cos\\beta \\\\\n0 & b^{2} & 0 \\\\\na c \\cos\\beta & 0 & c^{2}\n\\end{pmatrix}.\n$$\nAdopt a right-handed orthonormal Cartesian frame $\\,\\{\\hat{\\mathbf{x}},\\hat{\\mathbf{y}},\\hat{\\mathbf{z}}\\}\\,$ that is consistent with this metric and the conventional monoclinic setting, namely $\\,\\mathbf{a}\\,$ lies along $\\,\\hat{\\mathbf{x}}\\,$, $\\,\\mathbf{b}\\,$ lies along $\\,\\hat{\\mathbf{y}}\\,$, and $\\,\\mathbf{c}\\,$ lies in the $\\,\\hat{\\mathbf{x}}$â€“$\\,\\hat{\\mathbf{z}}\\,$ plane with positive $\\,\\hat{\\mathbf{z}}\\,$ component.\n\nStarting from the fundamental definition of the reciprocal basis vectors $\\,\\{\\mathbf{a}^{\\ast},\\mathbf{b}^{\\ast},\\mathbf{c}^{\\ast}\\}\\,$ through $\\,\\mathbf{a}_{i}\\cdot \\mathbf{a}_{j}^{\\ast} = 2\\pi\\,\\delta_{ij}\\,$, derive closed-form expressions for the Cartesian components of $\\,\\mathbf{a}^{\\ast}\\,$, $\\,\\mathbf{b}^{\\ast}\\,$, and $\\,\\mathbf{c}^{\\ast}\\,$ in terms of $\\,a\\,$, $\\,b\\,$, $\\,c\\,$, and $\\,\\beta\\,$. Then verify the orthogonality and normalization relations $\\,\\mathbf{a}\\cdot\\mathbf{a}^{\\ast} = 2\\pi\\,$, $\\,\\mathbf{b}\\cdot\\mathbf{b}^{\\ast} = 2\\pi\\,$, $\\,\\mathbf{c}\\cdot\\mathbf{c}^{\\ast} = 2\\pi\\,$ and $\\,\\mathbf{a}\\cdot\\mathbf{b}^{\\ast} = \\mathbf{a}\\cdot\\mathbf{c}^{\\ast} = \\mathbf{b}\\cdot\\mathbf{a}^{\\ast} = \\mathbf{b}\\cdot\\mathbf{c}^{\\ast} = \\mathbf{c}\\cdot\\mathbf{a}^{\\ast} = \\mathbf{c}\\cdot\\mathbf{b}^{\\ast} = 0\\,$.\n\nAnswer specification:\n- Provide your final answer as the single row containing the nine Cartesian components $\\,\\left(a^{\\ast}_{x},a^{\\ast}_{y},a^{\\ast}_{z},\\,b^{\\ast}_{x},b^{\\ast}_{y},b^{\\ast}_{z},\\,c^{\\ast}_{x},c^{\\ast}_{y},c^{\\ast}_{z}\\right)\\,$.\n- The final answer must be a closed-form analytic expression in terms of $\\,a\\,$, $\\,b\\,$, $\\,c\\,$, and $\\,\\beta\\,$.\n- Do not include units in the boxed answer.", "solution": "The problem is well-posed and scientifically sound, representing a standard exercise in crystallography. We shall proceed with its formal derivation.\n\nThe first step is to represent the direct lattice basis vectors, $\\mathbf{a}$, $\\mathbf{b}$, and $\\mathbf{c}$, in the specified right-handed orthonormal Cartesian frame $\\{\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}}, \\hat{\\mathbf{z}}\\}$. According to the problem statement:\nThe vector $\\mathbf{a}$ has length $a$ and lies along the $\\hat{\\mathbf{x}}$-axis.\n$$\n\\mathbf{a} = a \\hat{\\mathbf{x}}\n$$\nThe vector $\\mathbf{b}$ has length $b$ and lies along the $\\hat{\\mathbf{y}}$-axis.\n$$\n\\mathbf{b} = b \\hat{\\mathbf{y}}\n$$\nThe vector $\\mathbf{c}$ has length $c$ and lies in the $\\hat{\\mathbf{x}}$-$\\hat{\\mathbf{z}}$ plane. Let its components be $(c_x, 0, c_z)$. The problem states that its component along $\\hat{\\mathbf{z}}$ is positive, so $c_z > 0$.\nThe magnitude of $\\mathbf{c}$ is $c$, so $c_x^{2} + c_z^{2} = c^{2}$.\nThe angle $\\beta$ between $\\mathbf{a}$ and $\\mathbf{c}$ is given by the dot product $\\mathbf{a} \\cdot \\mathbf{c} = ac \\cos\\beta$. In Cartesian coordinates, this is:\n$$\n\\mathbf{a} \\cdot \\mathbf{c} = (a \\hat{\\mathbf{x}}) \\cdot (c_x \\hat{\\mathbf{x}} + c_z \\hat{\\mathbf{z}}) = a c_x\n$$\nComparing the two expressions, we find $a c_x = ac \\cos\\beta$, which implies $c_x = c \\cos\\beta$.\nSubstituting this into the magnitude equation:\n$$\n(c \\cos\\beta)^{2} + c_z^{2} = c^{2} \\implies c_z^{2} = c^{2} (1 - \\cos^{2}\\beta) = c^{2} \\sin^{2}\\beta\n$$\nSince $\\beta \\in (0, \\pi)$, $\\sin\\beta > 0$. As we require $c_z > 0$, we take the positive root: $c_z = c \\sin\\beta$.\nThus, the vector $\\mathbf{c}$ is:\n$$\n\\mathbf{c} = c \\cos\\beta \\hat{\\mathbf{x}} + c \\sin\\beta \\hat{\\mathbf{z}}\n$$\nIn column vector notation with respect to the Cartesian basis, the direct lattice vectors are:\n$$\n\\mathbf{a} = \\begin{pmatrix} a \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{b} = \\begin{pmatrix} 0 \\\\ b \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{c} = \\begin{pmatrix} c \\cos\\beta \\\\ 0 \\\\ c \\sin\\beta \\end{pmatrix}\n$$\nThe volume $V$ of the direct unit cell is given by the scalar triple product $V = |\\mathbf{a} \\cdot (\\mathbf{b} \\times \\mathbf{c})|$. This can be computed as the absolute value of the determinant of the matrix formed by these vectors:\n$$\nV = \\left| \\det \\begin{pmatrix} a & 0 & c \\cos\\beta \\\\ 0 & b & 0 \\\\ 0 & 0 & c \\sin\\beta \\end{pmatrix} \\right| = | a(b c \\sin\\beta) |\n$$\nSince $a, b, c > 0$ and $\\sin\\beta > 0$ for $\\beta \\in (0, \\pi)$, the volume is $V = abc \\sin\\beta$.\n\nThe reciprocal basis vectors $\\{\\mathbf{a}^{\\ast}, \\mathbf{b}^{\\ast}, \\mathbf{c}^{\\ast}\\}$ are defined such that $\\mathbf{a}_{i} \\cdot \\mathbf{a}_{j}^{\\ast} = 2\\pi \\delta_{ij}$, where $\\mathbf{a}_1=\\mathbf{a}$, $\\mathbf{a}_2=\\mathbf{b}$, $\\mathbf{a}_3=\\mathbf{c}$. These definitions lead to the standard formulae:\n$$\n\\mathbf{a}^{\\ast} = \\frac{2\\pi}{V} (\\mathbf{b} \\times \\mathbf{c})\n\\quad , \\quad\n\\mathbf{b}^{\\ast} = \\frac{2\\pi}{V} (\\mathbf{c} \\times \\mathbf{a})\n\\quad , \\quad\n\\mathbf{c}^{\\ast} = \\frac{2\\pi}{V} (\\mathbf{a} \\times \\mathbf{b})\n$$\nWe now compute the cross products in the Cartesian frame.\nFor $\\mathbf{a}^{\\ast}$:\n$$\n\\mathbf{b} \\times \\mathbf{c} = \\det \\begin{pmatrix} \\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\ 0 & b & 0 \\\\ c \\cos\\beta & 0 & c \\sin\\beta \\end{pmatrix} = (bc \\sin\\beta) \\hat{\\mathbf{x}} - 0 \\cdot \\hat{\\mathbf{y}} + (-bc \\cos\\beta) \\hat{\\mathbf{z}}\n$$\n$$\n\\mathbf{a}^{\\ast} = \\frac{2\\pi}{abc \\sin\\beta} (bc \\sin\\beta \\hat{\\mathbf{x}} - bc \\cos\\beta \\hat{\\mathbf{z}}) = \\frac{2\\pi}{a} \\hat{\\mathbf{x}} - \\frac{2\\pi \\cos\\beta}{a \\sin\\beta} \\hat{\\mathbf{z}} = \\frac{2\\pi}{a} \\hat{\\mathbf{x}} - \\frac{2\\pi \\cot\\beta}{a} \\hat{\\mathbf{z}}\n$$\nFor $\\mathbf{b}^{\\ast}$:\n$$\n\\mathbf{c} \\times \\mathbf{a} = \\det \\begin{pmatrix} \\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\ c \\cos\\beta & 0 & c \\sin\\beta \\\\ a & 0 & 0 \\end{pmatrix} = 0 \\cdot \\hat{\\mathbf{x}} - (-ac \\sin\\beta) \\hat{\\mathbf{y}} + 0 \\cdot \\hat{\\mathbf{z}}\n$$\n$$\n\\mathbf{b}^{\\ast} = \\frac{2\\pi}{abc \\sin\\beta} (ac \\sin\\beta \\hat{\\mathbf{y}}) = \\frac{2\\pi}{b} \\hat{\\mathbf{y}}\n$$\nFor $\\mathbf{c}^{\\ast}$:\n$$\n\\mathbf{a} \\times \\mathbf{b} = \\det \\begin{pmatrix} \\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\ a & 0 & 0 \\\\ 0 & b & 0 \\end{pmatrix} = 0 \\cdot \\hat{\\mathbf{x}} - 0 \\cdot \\hat{\\mathbf{y}} + (ab) \\hat{\\mathbf{z}}\n$$\n$$\n\\mathbf{c}^{\\ast} = \\frac{2\\pi}{abc \\sin\\beta} (ab \\hat{\\mathbf{z}}) = \\frac{2\\pi}{c \\sin\\beta} \\hat{\\mathbf{z}}\n$$\nThe Cartesian components $(a^{\\ast}_x, a^{\\ast}_y, a^{\\ast}_z)$, $(b^{\\ast}_x, b^{\\ast}_y, b^{\\ast}_z)$, and $(c^{\\ast}_x, c^{\\ast}_y, c^{\\ast}_z)$ are therefore:\n$$\n\\mathbf{a}^{\\ast} = \\left( \\frac{2\\pi}{a}, 0, -\\frac{2\\pi \\cot\\beta}{a} \\right)\n$$\n$$\n\\mathbf{b}^{\\ast} = \\left( 0, \\frac{2\\pi}{b}, 0 \\right)\n$$\n$$\n\\mathbf{c}^{\\ast} = \\left( 0, 0, \\frac{2\\pi}{c \\sin\\beta} \\right)\n$$\nWe must now verify the relations $\\mathbf{a}_{i} \\cdot \\mathbf{a}_{j}^{\\ast} = 2\\pi\\delta_{ij}$.\n$$\n\\mathbf{a} \\cdot \\mathbf{a}^{\\ast} = (a\\hat{\\mathbf{x}}) \\cdot (\\frac{2\\pi}{a}\\hat{\\mathbf{x}} - \\frac{2\\pi \\cot\\beta}{a}\\hat{\\mathbf{z}}) = a(\\frac{2\\pi}{a}) = 2\\pi\n$$\n$$\n\\mathbf{a} \\cdot \\mathbf{b}^{\\ast} = (a\\hat{\\mathbf{x}}) \\cdot (\\frac{2\\pi}{b}\\hat{\\mathbf{y}}) = 0\n$$\n$$\n\\mathbf{a} \\cdot \\mathbf{c}^{\\ast} = (a\\hat{\\mathbf{x}}) \\cdot (\\frac{2\\pi}{c \\sin\\beta}\\hat{\\mathbf{z}}) = 0\n$$\n$$\n\\mathbf{b} \\cdot \\mathbf{a}^{\\ast} = (b\\hat{\\mathbf{y}}) \\cdot (\\frac{2\\pi}{a}\\hat{\\mathbf{x}} - \\frac{2\\pi \\cot\\beta}{a}\\hat{\\mathbf{z}}) = 0\n$$\n$$\n\\mathbf{b} \\cdot \\mathbf{b}^{\\ast} = (b\\hat{\\mathbf{y}}) \\cdot (\\frac{2\\pi}{b}\\hat{\\mathbf{y}}) = b(\\frac{2\\pi}{b}) = 2\\pi\n$$\n$$\n\\mathbf{b} \\cdot \\mathbf{c}^{\\ast} = (b\\hat{\\mathbf{y}}) \\cdot (\\frac{2\\pi}{c \\sin\\beta}\\hat{\\mathbf{z}}) = 0\n$$\n$$\n\\mathbf{c} \\cdot \\mathbf{a}^{\\ast} = (c \\cos\\beta \\hat{\\mathbf{x}} + c \\sin\\beta \\hat{\\mathbf{z}}) \\cdot (\\frac{2\\pi}{a}\\hat{\\mathbf{x}} - \\frac{2\\pi \\cot\\beta}{a}\\hat{\\mathbf{z}}) = c \\cos\\beta (\\frac{2\\pi}{a}) + c \\sin\\beta (-\\frac{2\\pi \\cot\\beta}{a}) = \\frac{2\\pi c \\cos\\beta}{a} - \\frac{2\\pi c \\sin\\beta}{a}\\frac{\\cos\\beta}{\\sin\\beta} = 0\n$$\n$$\n\\mathbf{c} \\cdot \\mathbf{b}^{\\ast} = (c \\cos\\beta \\hat{\\mathbf{x}} + c \\sin\\beta \\hat{\\mathbf{z}}) \\cdot (\\frac{2\\pi}{b}\\hat{\\mathbf{y}}) = 0\n$$\n$$\n\\mathbf{c} \\cdot \\mathbf{c}^{\\ast} = (c \\cos\\beta \\hat{\\mathbf{x}} + c \\sin\\beta \\hat{\\mathbf{z}}) \\cdot (\\frac{2\\pi}{c \\sin\\beta}\\hat{\\mathbf{z}}) = c \\sin\\beta (\\frac{2\\pi}{c \\sin\\beta}) = 2\\pi\n$$\nAll nine relations are satisfied, confirming the correctness of our derived expressions. The final result is the ordered list of the nine Cartesian components of the reciprocal basis vectors.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2\\pi}{a} & 0 & -\\frac{2\\pi \\cot\\beta}{a} & 0 & \\frac{2\\pi}{b} & 0 & 0 & 0 & \\frac{2\\pi}{c \\sin\\beta} \\end{pmatrix}}\n$$", "id": "2821810"}, {"introduction": "While the reciprocal lattice dictates the possible positions of Bragg reflections, their observed intensities are determined by the crystal's structure factor, $F_{hkl}$. This exercise [@problem_id:2821795] delves into the calculation of the structure factor, which coherently sums the scattering amplitudes from all atoms within the unit cell, accounting for their relative positions. Furthermore, it explores the powerful technique of anomalous (or resonant) diffraction, demonstrating how tuning the X-ray energy across an atom's absorption edge alters its scattering factor ($f^{\\prime}$ and $f^{\\prime\\prime}$ terms) and produces measurable changes in intensity, providing element-sensitive structural information.", "problem": "A single crystal of a binary compound has a primitive simple-cubic Bravais lattice with one atom of species A at fractional coordinates $\\left(0,0,0\\right)$ and one atom of species B at fractional coordinates $\\left(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2}\\right)$ in each unit cell. Consider kinematic X-ray diffraction in a narrow photon-energy range where all geometric and thermal factors can be treated as constant. You will examine the Bragg reflection indexed by Miller indices $\\left(1,1,1\\right)$.\n\nAtom A is tuned through one of its absorption edges. In this energy range the atomic scattering factor of atom A is written as $f_{A}=f_{0,A}+f_{A}^{\\prime}+i\\,f_{A}^{\\prime\\prime}$, where $f_{0,A}$ is the normal (Thomson) term, $f_{A}^{\\prime}$ is the dispersive correction, and $f_{A}^{\\prime\\prime}$ is the absorptive (anomalous) term. Atom B may be treated as nonresonant in this range with $f_{B}=f_{0,B}$ real and energy independent.\n\nAt an incident energy just below the edge, the scattering factors are characterized by\n- $f_{0,A}=20$ (in electrons),\n- $f_{A}^{\\prime}=-4$ and $f_{A}^{\\prime\\prime}=2$,\n- $f_{0,B}=12$ (in electrons), with negligible dispersive and absorptive parts.\n\nAs the incident energy is increased across the edge, the changes for atom A are\n- $\\Delta f_{A}^{\\prime}=-5$,\n- $\\Delta f_{A}^{\\prime\\prime}=+3$,\nwhile $f_{0,A}$ and $f_{0,B}$ remain unchanged and atom B remains nonresonant.\n\nUsing only the fundamental definition of the crystal structure factor as a sum over atoms in the unit cell with appropriate phase factors, the decomposition of an atomic scattering factor into its normal and anomalous parts, and the fact that diffracted intensity in the kinematic limit is proportional to the squared magnitude of the structure factor, determine for the $\\left(1,1,1\\right)$ reflection:\n\n1. The change in the structure factor magnitude between just below and just above the edge, $\\Delta\\lvert F\\rvert=\\lvert F\\rvert_{\\text{above}}-\\lvert F\\rvert_{\\text{below}}$.\n2. The ratio of diffracted intensities $I_{\\text{above}}/I_{\\text{below}}$.\n\nExpress the change in magnitude in electrons and the intensity ratio as a dimensionless number. Round both reported values to four significant figures. Provide your final result as two numbers in the order $\\Delta\\lvert F\\rvert$ (electrons), $I_{\\text{above}}/I_{\\text{below}}$.", "solution": "The problem requires the calculation of the change in the structure factor magnitude and the ratio of diffracted intensities for a specific Bragg reflection when the incident X-ray energy is tuned across an absorption edge of one atomic species. We begin with the fundamental definition of the crystal structure factor and proceed with strict logical deduction.\n\nThe crystal structure factor, $F_{hkl}$, for a reflection indexed by Miller indices $(h,k,l)$ is defined as the sum over all $j$ atoms within one unit cell:\n$$F_{hkl} = \\sum_{j} f_j \\exp[2\\pi i (h x_j + k y_j + l z_j)]$$\nwhere $f_j$ is the atomic scattering factor of atom $j$ and $(x_j, y_j, z_j)$ are its fractional coordinates.\n\nThe unit cell contains two atoms:\n1. Atom A at position $\\vec{\\tau}_A = (0, 0, 0)$.\n2. Atom B at position $\\vec{\\tau}_B = (\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$.\n\nSubstituting these positions into the definition of the structure factor yields:\n$$F_{hkl} = f_A \\exp[2\\pi i (h \\cdot 0 + k \\cdot 0 + l \\cdot 0)] + f_B \\exp[2\\pi i (h \\cdot \\frac{1}{2} + k \\cdot \\frac{1}{2} + l \\cdot \\frac{1}{2})]$$\n$$F_{hkl} = f_A \\exp(0) + f_B \\exp[i\\pi(h+k+l)]$$\n$$F_{hkl} = f_A + f_B (-1)^{h+k+l}$$\n\nWe are to examine the $(1,1,1)$ reflection. For this reflection, the sum of the Miller indices is $h+k+l = 1+1+1=3$, which is an odd integer. The structure factor for this reflection is therefore:\n$$F_{111} = f_A - f_B$$\n\nThe atomic scattering factors are given. For atom A, the scattering factor is complex and energy-dependent due to anomalous dispersion:\n$$f_A = f_{0,A} + f_A' + i f_A''$$\nwhere $f_{0,A}$ is the Thomson scattering term, and $f_A'$ and $f_A''$ are the real and imaginary anomalous corrections, respectively. For atom B, the scattering is non-resonant and its scattering factor is real and constant:\n$$f_B = f_{0,B}$$\n\nSubstituting these into the expression for $F_{111}$:\n$$F_{111} = (f_{0,A} + f_A' + i f_A'') - f_{0,B}$$\n$$F_{111} = (f_{0,A} + f_A' - f_{0,B}) + i f_A''$$\nThe diffracted intensity $I_{hkl}$ is proportional to the squared magnitude of the structure factor, $I_{hkl} \\propto |F_{hkl}|^2$. The magnitude of $F_{111}$ is:\n$$|F_{111}| = \\sqrt{(\\text{Re}(F_{111}))^2 + (\\text{Im}(F_{111}))^2} = \\sqrt{(f_{0,A} + f_A' - f_{0,B})^2 + (f_A'')^2}$$\n\nWe now evaluate these quantities for the two specified energy conditions.\n\nFirst, at an energy just below the absorption edge:\nThe given scattering factor components are:\n- $f_{0,A} = 20$\n- $(f_A')_{\\text{below}} = -4$\n- $(f_A'')_{\\text{below}} = 2$\n- $f_{0,B} = 12$\n\nThe real and imaginary parts of the structure factor $F_{\\text{below}}$ are:\n$$\\text{Re}(F_{\\text{below}}) = f_{0,A} + (f_A')_{\\text{below}} - f_{0,B} = 20 + (-4) - 12 = 4$$\n$$\\text{Im}(F_{\\text{below}}) = (f_A'')_{\\text{below}} = 2$$\nThe magnitude of the structure factor below the edge is:\n$$|F|_{\\text{below}} = \\sqrt{(4)^2 + (2)^2} = \\sqrt{16+4} = \\sqrt{20}$$\n\nSecond, at an energy just above the absorption edge:\nThe scattering factor for atom A changes. The changes are given as $\\Delta f_A' = -5$ and $\\Delta f_A'' = +3$. The new components are:\n$$(f_A')_{\\text{above}} = (f_A')_{\\text{below}} + \\Delta f_A' = -4 + (-5) = -9$$\n$$(f_A'')_{\\text{above}} = (f_A'')_{\\text{below}} + \\Delta f_A'' = 2 + 3 = 5$$\nThe regular scattering terms $f_{0,A}$ and $f_{0,B}$ are constant.\n\nThe real and imaginary parts of the structure factor $F_{\\text{above}}$ are:\n$$\\text{Re}(F_{\\text{above}}) = f_{0,A} + (f_A')_{\\text{above}} - f_{0,B} = 20 + (-9) - 12 = -1$$\n$$\\text{Im}(F_{\\text{above}}) = (f_A'')_{\\text{above}} = 5$$\nThe magnitude of the structure factor above the edge is:\n$$|F|_{\\text{above}} = \\sqrt{(-1)^2 + (5)^2} = \\sqrt{1+25} = \\sqrt{26}$$\n\nNow we can compute the required quantities.\n\n1. The change in the structure factor magnitude, $\\Delta |F|$:\n$$\\Delta|F| = |F|_{\\text{above}} - |F|_{\\text{below}} = \\sqrt{26} - \\sqrt{20}$$\nNumerically, $|F|_{\\text{above}} \\approx 5.0990195$ electrons and $|F|_{\\text{below}} \\approx 4.4721360$ electrons.\n$$\\Delta|F| \\approx 5.0990195 - 4.4721360 = 0.6268835$$\nRounding to four significant figures, we get $\\Delta|F| \\approx 0.6269$ electrons.\n\n2. The ratio of diffracted intensities, $I_{\\text{above}}/I_{\\text{below}}$:\nSince $I \\propto |F|^2$, the ratio is:\n$$\\frac{I_{\\text{above}}}{I_{\\text{below}}} = \\frac{|F|_{\\text{above}}^2}{|F|_{\\text{below}}^2} = \\frac{(\\sqrt{26})^2}{(\\sqrt{20})^2} = \\frac{26}{20} = 1.3$$\nTo express this with four significant figures as requested, the value is $1.300$.\n\nThe final results are the numerical values for the change in magnitude and the intensity ratio.", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.6269 & 1.300 \\end{pmatrix} } $$", "id": "2821795"}, {"introduction": "Moving from the ideal diffraction of perfect single crystals to the characterization of real-world materials often involves powder diffraction, where peak profiles are broadened by a combination of factors. This practical exercise [@problem_id:2821831] challenges you to build a quantitative model for powder diffraction peak shapes by synthesizing contributions from the instrument resolution, finite crystallite size, and internal microstrain. By implementing this model computationally and comparing it to observed data, you will develop a core skill in modern materials analysis: extracting microstructural information from the detailed shape of diffraction peaks.", "problem": "You are tasked with building a program that models the angular dependence of powder diffraction peak broadening by combining instrument and specimen contributions, and then compares the simulated Full Width at Half Maximum (FWHM) with observed values as a function of the scattering angle. Work within the Gaussian approximation for all line breadth contributions, and base your derivation on the following well-tested and widely used facts and definitions: (i) under convolution of independent Gaussian profiles, variances add; (ii) the instrumental resolution function for a Bragg-Brentano diffractometer is described by the Caglioti form specified by three instrument parameters; (iii) crystallite size broadening follows the Scherrer equation; and (iv) microstrain broadening follows the Williamsonâ€“Hall framework. All trigonometric dependences must be expressed in terms of the Bragg angle $\\,\\theta\\,$ where $\\,2\\theta\\,$ is the conventional diffraction scattering angle. Angles will be measured in degrees for input and output, but when using trigonometric functions you must convert to radians internally. Your program must output the quantitative comparison as a Root Mean Square Error (RMSE) for each test case.\n\nStarting from these base facts, derive a working expression for the predicted total FWHM, $\\,H_{\\text{tot}}(2\\theta)\\,$, in degrees of $\\,2\\theta\\,$, by appropriately expressing the instrumental, size, and strain contributions and combining them under the Gaussian-convolution assumption. Ensure that any required unit conversions are handled consistently. The instrumental resolution is fully characterized by three constants $\\,U\\,$, $\\,V\\,$, and $\\,W\\,$ specified in units of squared degrees, and the line profile broadening from specimen size and microstrain is to be parameterized by a shape factor $\\,K\\,$ (dimensionless), X-ray wavelength $\\,\\lambda\\,$ (in Ã¥ngstrÃ¶m), volume-averaged crystallite size $\\,L\\,$ (in nanometers), and root-mean-square microstrain $\\,\\varepsilon\\,$ (dimensionless). The observed FWHM values are given in degrees of $\\,2\\theta\\,$. The program must compute the predicted FWHM at the provided list of $\\,2\\theta\\,$ values, compare with the observed values, and report the RMSE in degrees.\n\nAngle unit: all given angles $\\,2\\theta\\,$ are in degrees, and all trigonometric functions must be evaluated at $\\,\\theta = (2\\theta)/2\\,$ expressed in radians. Output unit: report the RMSE values in degrees of $\\,2\\theta\\,$, rounded to six decimal places.\n\nTest suite. Implement your program to evaluate exactly the following three cases. For each case, compute the RMSE between the simulated and observed FWHM values. Your program should produce a single line of output containing the RMSEs as a comma-separated list enclosed in square brackets, in the order Case A, Case B, Case C; for example, output of the form $\\,\\texttt{[x\\_A,x\\_B,x\\_C]}\\,$ with each $\\,x\\,$ rounded to six decimal places.\n\n- Case A (typical mixed broadening with moderate size and strain):\n  - Instrument parameters (Caglioti): $\\,U = 0.003\\,$, $\\,V = 0.000\\,$, $\\,W = 0.002\\,$ (all in squared degrees).\n  - Specimen parameters: $\\,K = 0.9\\,$, $\\,\\lambda = 1.5406\\,$ Ã¥ngstrÃ¶m, $\\,L = 80\\,$ nanometers, $\\,\\varepsilon = 0.001\\,$.\n  - Scattering angles (degrees of $\\,2\\theta\\,$): $\\,\\{20,\\,40,\\,60,\\,80,\\,100\\}\\,$.\n  - Observed FWHM (degrees of $\\,2\\theta\\,$): $\\,\\{0.1179,\\,0.1432,\\,0.1835,\\,0.2406,\\,0.3236\\}\\,$.\n\n- Case B (instrument-dominated broadening):\n  - Instrument parameters (Caglioti): $\\,U = 0.010\\,$, $\\,V = 0.000\\,$, $\\,W = 0.002\\,$ (all in squared degrees).\n  - Specimen parameters approximating negligible size/strain: $\\,K = 0.9\\,$, $\\,\\lambda = 1.5406\\,$ Ã¥ngstrÃ¶m, $\\,L = 10^{9}\\,$ nanometers, $\\,\\varepsilon = 0.000\\,$.\n  - Scattering angles (degrees of $\\,2\\theta\\,$): $\\,\\{15,\\,30,\\,60,\\,120\\}\\,$.\n  - Observed FWHM (degrees of $\\,2\\theta\\,$): $\\,\\{0.0466,\\,0.0522,\\,0.0730,\\,0.1789\\}\\,$.\n\n- Case C (high-angle microstrain-dominated broadening):\n  - Instrument parameters (Caglioti): $\\,U = 0.000\\,$, $\\,V = 0.000\\,$, $\\,W = 0.005\\,$ (all in squared degrees).\n  - Specimen parameters: $\\,K = 0.9\\,$, $\\,\\lambda = 1.5406\\,$ Ã¥ngstrÃ¶m, $\\,L = 10^{9}\\,$ nanometers, $\\,\\varepsilon = 0.002\\,$.\n  - Scattering angles (degrees of $\\,2\\theta\\,$): $\\,\\{30,\\,90,\\,150\\}\\,$.\n  - Observed FWHM (degrees of $\\,2\\theta\\,$): $\\,\\{0.1418,\\,0.4640,\\,1.7116\\}\\,$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the exact order $\\,\\texttt{[RMSE\\_A,RMSE\\_B,RMSE\\_C]}\\,$. Each $\\,\\texttt{RMSE}\\,$ must be rounded to six decimal places. No other output is permitted.", "solution": "The problem requires the derivation of a model for X-ray diffraction peak broadening and its application to compute the Root Mean Square Error (RMSE) between predicted and observed Full Width at Half Maximum (FWHM) values. The derivation must be based on first principles and established models as specified.\n\nThe fundamental principle for combining different sources of peak broadening is based on the assumption that each contribution to the line profile (instrumental, crystallite size, microstrain) can be described by a Gaussian function. The total observed peak profile is the convolution of these individual profiles. A key mathematical property of Gaussian functions is that the convolution of two or more Gaussians results in another Gaussian whose variance ($\\sigma^2$) is the sum of the variances of the individual Gaussians.\n\nThe Full Width at Half Maximum ($H$) of a Gaussian function is related to its standard deviation ($\\sigma$) by the constant factor $H = 2\\sqrt{2\\ln{2}} \\sigma$. Consequently, the FWHM squared is directly proportional to the variance: $H^2 = (8\\ln{2})\\sigma^2$. Therefore, the addition of variances is equivalent to the addition of the FWHM squared values:\n$$\nH_{\\text{tot}}^2 = H_{\\text{instr}}^2 + H_{\\text{specimen}}^2\n$$\nThe specimen broadening itself is a combination of contributions from finite crystallite size ($H_{\\text{size}}$) and lattice microstrain ($H_{\\text{strain}}$). Assuming these are also independent Gaussian contributions, the total FWHM squared is given by:\n$$\nH_{\\text{pred}}^2(2\\theta) = H_{\\text{instr}}^2(2\\theta) + H_{\\text{size}}^2(2\\theta) + H_{\\text{strain}}^2(2\\theta)\n$$\nwhere $H_{\\text{pred}}$ is the predicted total FWHM. Each term is a function of the scattering angle $2\\theta$. We now derive the expression for each contribution in units of degrees of $2\\theta$. All angles used in trigonometric functions must be converted to radians. The Bragg angle $\\theta$ is half the scattering angle, $\\theta = (2\\theta)/2$.\n\n1.  **Instrumental Broadening, $H_{\\text{instr}}(2\\theta)$**: The problem states that the instrumental resolution is described by the Caglioti equation. This empirical formula gives the FWHM squared as a polynomial in $\\tan\\theta$:\n    $$\n    H_{\\text{instr}}^2(2\\theta) = U \\tan^2\\theta + V \\tan\\theta + W\n    $$\n    The parameters $U$, $V$, and $W$ are instrument-specific constants provided in units of squared degrees (deg$^2$). The Bragg angle $\\theta$ must be in radians when passed to the $\\tan$ function, and the resulting $H_{\\text{instr}}^2$ is in deg$^2$.\n\n2.  **Crystallite Size Broadening, $H_{\\text{size}}(2\\theta)$**: This contribution is governed by the Scherrer equation, which relates the volume-averaged crystallite size $L$ to the FWHM of the peak, $\\beta_{\\text{size}}$, expressed in radians:\n    $$\n    L = \\frac{K \\lambda}{\\beta_{\\text{size}} \\cos\\theta}\n    $$\n    Here, $K$ is the dimensionless Scherrer shape factor, and $\\lambda$ is the X-ray wavelength. To ensure consistent units, we must express $L$ and $\\lambda$ in the same unit, such as Ã¥ngstrÃ¶ms (Ã…). Given $L$ in nanometers (nm) and $\\lambda$ in Ã…, we use the conversion $1 \\text{ nm} = 10 \\text{ Ã…}$. Solving for $\\beta_{\\text{size}}$:\n    $$\n    \\beta_{\\text{size}} \\text{ [radians]} = \\frac{K \\lambda_{\\text{[Ã…]}}}{(L_{\\text{[nm]}} \\times 10) \\cos\\theta}\n    $$\n    The FWHM in degrees, $H_{\\text{size}}$, is obtained by converting $\\beta_{\\text{size}}$ from radians: $H_{\\text{size}} = \\beta_{\\text{size}} \\times \\frac{180}{\\pi}$. Squaring this expression gives the contribution in deg$^2$:\n    $$\n    H_{\\text{size}}^2(2\\theta) = \\left( \\frac{K \\lambda}{10 L \\cos\\theta} \\cdot \\frac{180}{\\pi} \\right)^2\n    $$\n\n3.  **Microstrain Broadening, $H_{\\text{strain}}(2\\theta)$**: Within the Williamson-Hall framework, the FWHM contribution from root-mean-square microstrain, $\\varepsilon$, is related to $\\tan\\theta$. The broadening in radians, $\\beta_{\\text{strain}}$, is given by:\n    $$\n    \\beta_{\\text{strain}} \\text{ [radians]} = 4 \\varepsilon \\tan\\theta\n    $$\n    The factor of $4$ is a conventional constant for this model. Similar to the size contribution, we convert this to degrees and square it to obtain the FWHM squared in deg$^2$:\n    $$\n    H_{\\text{strain}}^2(2\\theta) = \\left( 4 \\varepsilon \\tan\\theta \\cdot \\frac{180}{\\pi} \\right)^2\n    $$\n\nCombining these three contributions gives the total predicted FWHM squared:\n$$\nH_{\\text{pred}}^2(2\\theta) = (U \\tan^2\\theta + V \\tan\\theta + W) + \\left( \\frac{K \\lambda}{10 L \\cos\\theta} \\frac{180}{\\pi} \\right)^2 + \\left( 4 \\varepsilon \\tan\\theta \\frac{180}{\\pi} \\right)^2\n$$\nThe predicted FWHM in degrees is the square root of this expression:\n$$\nH_{\\text{pred}}(2\\theta) = \\sqrt{(U \\tan^2\\theta + V \\tan\\theta + W) + \\left( \\frac{K \\lambda}{10 L \\cos\\theta} \\frac{180}{\\pi} \\right)^2 + \\left( 4 \\varepsilon \\tan\\theta \\frac{180}{\\pi} \\right)^2}\n$$\nIn this formula, $\\theta = \\frac{2\\theta_{\\text{deg}}}{2}$, which must be converted to radians for the trigonometric functions. The parameters $\\lambda$ and $L$ are given in Ã… and nm, respectively.\n\nFinally, to quantify the agreement between the model and the observations, we calculate the Root Mean Square Error (RMSE). For a set of $N$ observations, the RMSE is defined as:\n$$\n\\text{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (H_{\\text{pred}}(2\\theta_i) - H_{\\text{obs}}(2\\theta_i))^2}\n$$\nwhere $H_{\\text{pred}}(2\\theta_i)$ is the predicted FWHM at angle $2\\theta_i$ and $H_{\\text{obs}}(2\\theta_i)$ is the corresponding observed FWHM. The final RMSE will be reported in degrees.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the RMSE between simulated and observed powder diffraction FWHM values\n    for three distinct test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case A: Typical mixed broadening\n        {\n            \"params\": {\"U\": 0.003, \"V\": 0.000, \"W\": 0.002, \"K\": 0.9, \"lam\": 1.5406, \"L\": 80, \"eps\": 0.001},\n            \"two_theta_deg\": np.array([20, 40, 60, 80, 100]),\n            \"h_obs_deg\": np.array([0.1179, 0.1432, 0.1835, 0.2406, 0.3236]),\n        },\n        # Case B: Instrument-dominated broadening\n        {\n            \"params\": {\"U\": 0.010, \"V\": 0.000, \"W\": 0.002, \"K\": 0.9, \"lam\": 1.5406, \"L\": 1e9, \"eps\": 0.000},\n            \"two_theta_deg\": np.array([15, 30, 60, 120]),\n            \"h_obs_deg\": np.array([0.0466, 0.0522, 0.0730, 0.1789]),\n        },\n        # Case C: High-angle microstrain-dominated broadening\n        {\n            \"params\": {\"U\": 0.000, \"V\": 0.000, \"W\": 0.005, \"K\": 0.9, \"lam\": 1.5406, \"L\": 1e9, \"eps\": 0.002},\n            \"two_theta_deg\": np.array([30, 90, 150]),\n            \"h_obs_deg\": np.array([0.1418, 0.4640, 1.7116]),\n        },\n    ]\n\n    def calculate_predicted_fwhm(params, two_theta_deg):\n        \"\"\"\n        Calculates the predicted total FWHM based on instrumental, size, and strain broadening.\n\n        Args:\n            params (dict): Dictionary of model parameters (U, V, W, K, lam, L, eps).\n            two_theta_deg (np.ndarray): Array of 2-theta scattering angles in degrees.\n\n        Returns:\n            np.ndarray: Predicted FWHM values in degrees of 2-theta.\n        \"\"\"\n        U, V, W, K, lam, L, eps = params[\"U\"], params[\"V\"], params[\"W\"], params[\"K\"], params[\"lam\"], params[\"L\"], params[\"eps\"]\n        \n        # Calculate theta in radians\n        theta_rad = np.deg2rad(two_theta_deg / 2.0)\n\n        # Trigonometric terms\n        tan_theta = np.tan(theta_rad)\n        cos_theta = np.cos(theta_rad)\n\n        # 1. Instrumental broadening contribution (Caglioti)\n        # U, V, W are given in deg^2, so H_instr_sq is in deg^2\n        h_instr_sq = U * tan_theta**2 + V * tan_theta + W\n\n        # 2. Crystallite size broadening contribution (Scherrer)\n        # Convert beta_size from radians to degrees, then square\n        # L must be converted from nm to Angstroms by multiplying by 10\n        # The np.divide handles potential division by zero for cos(theta), although not for theta=90 deg.\n        # At 2theta=180, cos(theta)=0. We protect against this case.\n        h_size_sq = np.zeros_like(cos_theta)\n        non_zero_cos = cos_theta != 0\n        beta_size_rad = (K * lam) / (10 * L * cos_theta[non_zero_cos])\n        h_size_deg = np.rad2deg(beta_size_rad)\n        h_size_sq[non_zero_cos] = h_size_deg**2\n        \n        # 3. Microstrain broadening contribution (Williamson-Hall)\n        # Convert beta_strain from radians to degrees, then square\n        beta_strain_rad = 4 * eps * tan_theta\n        h_strain_deg = np.rad2deg(beta_strain_rad)\n        h_strain_sq = h_strain_deg**2\n\n        # Total FWHM squared is the sum of the squared contributions\n        h_pred_sq = h_instr_sq + h_size_sq + h_strain_sq\n        \n        # Predicted FWHM is the square root\n        h_pred = np.sqrt(h_pred_sq)\n        \n        return h_pred\n\n    results = []\n    for case in test_cases:\n        h_pred = calculate_predicted_fwhm(case[\"params\"], case[\"two_theta_deg\"])\n        \n        # Calculate Root Mean Square Error (RMSE)\n        squared_errors = np.square(h_pred - case[\"h_obs_deg\"])\n        mean_squared_error = np.mean(squared_errors)\n        rmse = np.sqrt(mean_squared_error)\n        \n        results.append(rmse)\n\n    # Format the final output string as [RMSE_A,RMSE_B,RMSE_C]\n    # with each RMSE rounded to six decimal places.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2821831"}]}