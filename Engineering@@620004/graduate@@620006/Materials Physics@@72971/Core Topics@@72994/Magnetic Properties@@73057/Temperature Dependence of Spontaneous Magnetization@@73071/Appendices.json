{"hands_on_practices": [{"introduction": "The stability of ferromagnetic order against thermal fluctuations is rooted in the powerful quantum mechanical exchange interaction. Mean-field theory provides an intuitive, albeit simplified, picture by replacing the complex many-body interaction with an effective magnetic field, the Weiss exchange field, $H_{\\text{ex}}$. This exercise [@problem_id:2865526] invites you to quantify this internal field for a model ferromagnet and compare its magnitude to that of typical external laboratory fields, providing a stark illustration of which energy scale governs magnetic ordering.", "problem": "A three-dimensional ferromagnet on a simple cubic lattice is modeled by the isotropic Heisenberg exchange and a Zeeman coupling to a uniform magnetic field. The exchange part of the Hamiltonian between nearest neighbors is taken as $-J \\sum_{\\langle i j \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j$, where $J0$ favors parallel alignment and $\\langle i j \\rangle$ denotes nearest-neighbor pairs. Consider the zero-temperature, fully aligned state where each spin has magnitude $S$ and all neighbors are parallel. Using the Zeeman energy $-g \\mu_B \\mathbf{S} \\cdot \\mathbf{H}$ for a single spin in a magnetic field, estimate the magnitude of the effective Weiss exchange field $H_{\\mathrm{ex}}$ by matching the exchange energy per spin to an equivalent Zeeman energy. Then, for a simple cubic lattice with coordination $z=6$, spin quantum number $S=1$, Landé factor $g=2$, and exchange $J$ specified by $J/k_B=10\\,\\mathrm{K}$ (with Boltzmann constant $(k_B)$ and Bohr magneton $(\\mu_B)$ given below), compute the dimensionless ratio\n$$\nr \\equiv \\frac{H_{\\mathrm{ex}}}{1\\,\\mathrm{T}} .\n$$\nUse $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$ and $\\mu_B = 9.2740100783 \\times 10^{-24}\\,\\mathrm{J\\,T^{-1}}$. Report the final ratio $r$ as a pure number, rounded to three significant figures. Express any intermediate field you calculate in tesla, but only the ratio $r$ will be graded.\n\nFinally, briefly justify, based on the magnitude of $r$, which field scale predominantly governs the temperature dependence of the spontaneous magnetization $M_s(T)$ near and below the Curie temperature $(T_C)$. Your qualitative justification will not be graded; only the numerical value of $r$ will be graded.", "solution": "The problem requires the calculation of the effective Weiss exchange field, $H_{\\mathrm{ex}}$, for a Heisenberg ferromagnet and a subsequent dimensionless ratio, $r$. The foundation of this calculation is the mean-field theory, where the interaction of a single magnetic moment with all its neighbors is replaced by the interaction with an average, or \"mean,\" field generated by these neighbors.\n\nFirst, we consider the exchange energy for a single spin, which we label with the index $i$. According to the provided Hamiltonian, $H_{\\mathrm{exch}} = -J \\sum_{\\langle k l \\rangle} \\mathbf{S}_k \\cdot \\mathbf{S}_l$, the part of the energy that involves spin $\\mathbf{S}_i$ is due to its interaction with its $z$ nearest neighbors (denoted by index $j$):\n$$\nE_{\\mathrm{exch}, i} = -J \\mathbf{S}_i \\cdot \\sum_{j \\in \\text{n.n.}} \\mathbf{S}_j\n$$\nIn the mean-field approximation, the explicit interaction with each neighboring spin operator $\\mathbf{S}_j$ is replaced by an interaction with their statistical average, $\\langle \\mathbf{S} \\rangle$. The mean-field energy for spin $i$ is thus:\n$$\nE_{\\mathrm{MF}, i} = -z J (\\mathbf{S}_i \\cdot \\langle \\mathbf{S} \\rangle)\n$$\nThe problem specifies the zero-temperature ($T=0\\,\\mathrm{K}$) limit, where the system is in a fully aligned ferromagnetic state. In this ground state, the expectation value of any spin, $\\langle \\mathbf{S} \\rangle$, is a vector pointing along the direction of magnetization with a magnitude given by the spin quantum number, $S$. Therefore, the dot product $\\mathbf{S}_i \\cdot \\langle \\mathbf{S} \\rangle$ can be treated classically as $S \\cdot S \\cos(0) = S^2$. However, the more rigorous derivation comes from equating the operator forms.\n\nThe effective Weiss exchange field, $\\mathbf{H}_{\\mathrm{ex}}$, is defined as the magnetic field that would produce an equivalent Zeeman energy. The Zeeman energy of spin $\\mathbf{S}_i$ in this effective field is given as:\n$$\nE_{\\mathrm{Z}, i} = -g \\mu_B \\mathbf{S}_i \\cdot \\mathbf{H}_{\\mathrm{ex}}\n$$\nwhere $g$ is the Landé g-factor and $\\mu_B$ is the Bohr magneton.\n\nBy equating the mean-field exchange energy expression to the equivalent Zeeman energy expression, we establish the definition of $\\mathbf{H}_{\\mathrm{ex}}$:\n$$\n-z J (\\mathbf{S}_i \\cdot \\langle \\mathbf{S} \\rangle) = -g \\mu_B \\mathbf{S}_i \\cdot \\mathbf{H}_{\\mathrm{ex}}\n$$\nThis implies the following relationship between the fields and the average spin:\n$$\ng \\mu_B \\mathbf{H}_{\\mathrm{ex}} = z J \\langle \\mathbf{S} \\rangle\n$$\nTo find the magnitude $H_{\\mathrm{ex}}$, we consider the magnitudes of the vectors. At zero temperature, the magnitude of $\\langle \\mathbf{S} \\rangle$ is $S$. This yields:\n$$\ng \\mu_B H_{\\mathrm{ex}} = z J S\n$$\nFrom this, we derive the expression for $H_{\\mathrm{ex}}$:\n$$\nH_{\\mathrm{ex}} = \\frac{z J S}{g \\mu_B}\n$$\nNow, we must substitute the numerical values provided in the problem statement:\n- Coordination number for a simple cubic lattice: $z=6$.\n- Spin quantum number: $S=1$.\n- Landé g-factor: $g=2$.\n- Exchange constant relative to Boltzmann constant: $J/k_B = 10\\,\\mathrm{K}$. This gives $J = 10 \\times k_B$.\n- Boltzmann constant: $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$.\n- Bohr magneton: $\\mu_B = 9.2740100783 \\times 10^{-24}\\,\\mathrm{J\\,T^{-1}}$.\n\nPlugging these values into the formula for $H_{\\mathrm{ex}}$:\n$$\nH_{\\mathrm{ex}} = \\frac{6 \\times (10 \\times 1.380649 \\times 10^{-23}\\,\\mathrm{J}) \\times 1}{2 \\times (9.2740100783 \\times 10^{-24}\\,\\mathrm{J\\,T^{-1}})}\n$$\n$$\nH_{\\mathrm{ex}} = \\frac{8.283894 \\times 10^{-22}\\,\\mathrm{J}}{1.85480201566 \\times 10^{-23}\\,\\mathrm{J\\,T^{-1}}}\n$$\n$$\nH_{\\mathrm{ex}} \\approx 44.6622\\,\\mathrm{T}\n$$\nThe problem asks for the dimensionless ratio $r$, defined as $r \\equiv \\frac{H_{\\mathrm{ex}}}{1\\,\\mathrm{T}}$.\n$$\nr = \\frac{44.6622\\,\\mathrm{T}}{1\\,\\mathrm{T}} \\approx 44.6622\n$$\nRounding this result to three significant figures as requested:\n$$\nr \\approx 44.7\n$$\nAs a brief justification for the final, ungraded question: The magnitude of this internal exchange field, $H_{\\mathrm{ex}} \\approx 45\\,\\mathrm{T}$, is immense compared to typical externally applied magnetic fields (which are usually on the order of $1\\,\\mathrm{T}$). The existence of spontaneous magnetization $M_s(T)$ below the Curie temperature $T_C$ is due to this powerful quantum mechanical exchange interaction. The behavior of $M_s(T)$ is determined by the balance between the ordering effect of this enormous internal field and the disordering effect of thermal energy, $k_B T$. Consequently, it is the exchange field scale, not the scale of any typical external laboratory field, that predominantly governs the temperature dependence of spontaneous magnetization.", "answer": "$$\n\\boxed{44.7}\n$$", "id": "2865526"}, {"introduction": "As temperature rises from absolute zero, thermal energy creates excitations that reduce the spontaneous magnetization. The functional form of this decrease depends critically on the energy spectrum of these elementary excitations. This practice [@problem_id:1808252] explores the fundamental difference between systems with gapped excitations, which require a minimum energy to create, and those with gapless excitations like spin waves, revealing why they lead to exponentially suppressed versus power-law temperature dependencies, respectively.", "problem": "Consider two distinct three-dimensional ferromagnetic materials, System A and System B, both having a saturation magnetization $M_s$ at absolute zero temperature ($T=0$). As the temperature is raised slightly, thermal energy excites deviations from the perfectly ordered ferromagnetic ground state, causing the magnetization $M(T)$ to decrease. The deviation from saturation is defined as $\\delta M(T) = M_s - M(T)$.\n\nFor System A, the lowest-energy excitations are localized spin flips. Creating such an excitation requires surmounting a finite energy gap, $\\Delta  0$, which is independent of temperature.\n\nFor System B, the elementary excitations are collective, wavelike modes known as spin waves (or magnons). These modes are characterized by a wavevector $\\vec{k}$. For long wavelengths (small magnitude $k = |\\vec{k}|$), the energy of a spin wave is well-approximated by the quadratic dispersion relation $\\epsilon(\\vec{k}) = Dk^2$, where $D$ is a positive constant known as the spin-wave stiffness. Note that these excitations are \"gapless\" because $\\epsilon(\\vec{k}) \\to 0$ as $k \\to 0$.\n\nAssuming that at low temperatures the deviation $\\delta M(T)$ is directly proportional to the total number of thermally excited modes, determine the leading-order functional dependence of $\\delta M(T)$ on temperature $T$ for both systems. Let $\\delta M_A(T)$ and $\\delta M_B(T)$ be the deviations for System A and System B, respectively. Boltzmann's constant is denoted by $k_B$.\n\nWhich of the following statements correctly describes the low-temperature behavior for both systems?\n\nA. $\\delta M_A(T) \\propto T^{3/2}$ and $\\delta M_B(T) \\propto \\exp(-\\Delta / k_B T)$\n\nB. $\\delta M_A(T) \\propto \\exp(-\\Delta / k_B T)$ and $\\delta M_B(T) \\propto T^{3/2}$\n\nC. $\\delta M_A(T) \\propto T$ and $\\delta M_B(T) \\propto T^2$\n\nD. $\\delta M_A(T) \\propto T^2$ and $\\delta M_B(T) \\propto T^{5/2}$\n\nE. $\\delta M_A(T) \\propto \\exp(-\\Delta / k_B T)$ and $\\delta M_B(T) \\propto T$", "solution": "We are told that at low temperatures the deviation from saturation, $\\delta M(T)$, is directly proportional to the total number of thermally excited modes. Therefore, for each system we need the low-temperature scaling of the number of excitations.\n\nSystem A (localized, gapped spin flips). Each excitation costs a fixed energy $\\Delta0$, independent of $\\vec{k}$ or position. In the dilute low-temperature limit $k_{B}T \\ll \\Delta$, the probability to thermally create an excitation at a given site is dominated by the Boltzmann factor. For a two-level local degree of freedom with energies $0$ and $\\Delta$, the average excitation number per site is\n$$\n\\langle n \\rangle=\\frac{\\exp(-\\Delta/(k_{B}T))}{1+\\exp(-\\Delta/(k_{B}T))}\\sim \\exp\\!\\left(-\\frac{\\Delta}{k_{B}T}\\right)\\quad \\text{for }k_{B}T\\ll \\Delta.\n$$\nSince excitations are localized, there is no momentum-space phase-space factor; hence the total number of excitations, and therefore $\\delta M_{A}(T)$, is proportional to $\\exp(-\\Delta/(k_{B}T))$ to leading order. Thus\n$$\n\\delta M_{A}(T)\\propto \\exp\\!\\left(-\\frac{\\Delta}{k_{B}T}\\right).\n$$\n\nSystem B (gapless spin waves with quadratic dispersion). Magnons are bosonic modes with energy $\\epsilon(\\vec{k})=Dk^{2}$ for small $k$. The magnon occupation number is the Bose-Einstein factor $n_{\\vec{k}}=[\\exp(\\epsilon(\\vec{k})/(k_{B}T))-1]^{-1}$. The total magnon density is\n$$\nn_{\\text{mag}}(T)=\\int \\frac{d^{3}k}{(2\\pi)^{3}}\\frac{1}{\\exp(Dk^{2}/(k_{B}T))-1}.\n$$\nEvaluating the scaling, write in spherical coordinates and change variables $x=Dk^{2}/(k_{B}T)$:\n$$\nn_{\\text{mag}}(T)=\\frac{1}{2\\pi^{2}}\\int_{0}^{\\infty}\\frac{k^{2}\\,dk}{\\exp(Dk^{2}/(k_{B}T))-1}\n=\\frac{1}{2\\pi^{2}}\\cdot \\frac{1}{2}\\left(\\frac{k_{B}T}{D}\\right)^{3/2}\\int_{0}^{\\infty}\\frac{x^{1/2}}{\\exp(x)-1}\\,dx.\n$$\nThe integral is a pure number equal to $\\Gamma(3/2)\\zeta(3/2)$, so\n$$\nn_{\\text{mag}}(T)=C\\left(\\frac{k_{B}T}{D}\\right)^{3/2},\n$$\nwith $C=\\frac{1}{4\\pi^{2}}\\int_{0}^{\\infty}\\frac{x^{1/2}}{\\exp(x)-1}\\,dx$. Since each magnon reduces the magnetization by a fixed amount, $\\delta M_{B}(T)\\propto n_{\\text{mag}}(T)\\propto T^{3/2}$. Thus\n$$\n\\delta M_{B}(T)\\propto T^{3/2}.\n$$\n\nCombining, the correct low-temperature behaviors are $\\delta M_{A}(T)\\propto \\exp(-\\Delta/(k_{B}T))$ and $\\delta M_{B}(T)\\propto T^{3/2}$, which corresponds to option B.", "answer": "$$\\boxed{B}$$", "id": "1808252"}, {"introduction": "Moving from theoretical models to experimental reality, the low-temperature behavior of magnetization provides a direct window into a material's fundamental properties. Spin-wave theory predicts that the leading deviation from saturation magnetization follows Bloch's law, $\\Delta M_s(T) \\propto T^{3/2}$. This advanced practice [@problem_id:2865514] guides you through a complete data analysis workflow: deriving the connection between the $T^{3/2}$ coefficient and the spin-wave stiffness $D$, fitting experimental data, and rigorously propagating uncertainties to determine a confidence interval for this crucial material parameter.", "problem": "You are tasked with developing a complete program that performs principled inference of the spin-wave stiffness from low-temperature spontaneous magnetization data. Your program must implement both the physics-constrained model and statistically sound uncertainty quantification. The goal is to fit low-temperature spontaneous magnetization data $M_s(T)$ for a three-dimensional isotropic ferromagnet to a low-temperature expansion and to extract the spin-wave stiffness from the fit coefficient, together with a confidence interval obtained via uncertainty propagation.\n\nUse the following fundamental base for your derivation and algorithm design:\n- Spin-wave excitations in an isotropic ferromagnet have a long-wavelength dispersion relation $\\,\\epsilon_{\\mathbf{k}} = D k^2\\,$, where $\\,D\\,$ is the spin-wave stiffness and $\\,k = \\lvert \\mathbf{k} \\rvert\\,$.\n- The Bose-Einstein distribution (BED) for bosons is $\\,n_{\\mathbf{k}} = 1/\\left(\\exp(\\beta \\epsilon_{\\mathbf{k}}) - 1\\right)\\,$ with $\\,\\beta = 1/(k_{\\mathrm{B}} T)\\,$ and Boltzmann constant $\\,k_{\\mathrm{B}}\\,$.\n- Each magnon reduces the magnetization by $\\,g \\mu_{\\mathrm{B}}\\,$, where $\\,g\\,$ is the Landé $\\,g\\,$-factor and $\\,\\mu_{\\mathrm{B}}\\,$ is the Bohr magneton; the total reduction is given by the number density of magnons computed in the continuum limit $\\,\\int d^3 k/(2\\pi)^3\\,$.\n- The leading correction to $\\,M_s(T)\\,$ at low temperature scales as $\\,T^{3/2}\\,$; subleading corrections may appear at order $\\,T^{5/2}\\,$ due to magnon-magnon interactions and other higher-order effects.\n\nFrom this base, derive the low-temperature form\n- $\\,M_s(T) = M_s(0) - A\\,T^{3/2} - B\\,T^{5/2}\\,$ for sufficiently small $\\,T\\,$,\n- and a relation between $\\,A\\,$ and $\\,D\\,$ that follows from the dispersion relation and BED without invoking any empirical shortcut.\n\nThen implement the following computational procedure:\n- Fit the measurements $\\,\\{(T_i, M_i)\\}\\,$ to $\\,M_i \\approx M_s(0) - A T_i^{3/2} - B T_i^{5/2}\\,$ using ordinary least squares under independent, homoscedastic Gaussian noise. Estimate $\\,M_s(0)\\,$, $\\,A\\,$, and $\\,B\\,$ and their covariance matrix from the linear regression normal equations.\n- Using your derived analytic relation $\\,D = f(A)\\,$, compute an estimate $\\,\\hat{D}\\,$ from the fitted coefficient $\\,\\hat{A}\\,$. Propagate the uncertainty from $\\,\\hat{A}\\,$ to $\\,\\hat{D}\\,$ using first-order error propagation (delta method) to obtain a $\\,95\\,$-percent confidence interval. Use Student’s $\\,t\\,$-quantile with $\\,\\nu = N - p\\,$ degrees of freedom, where $\\,N\\,$ is the number of data points and $\\,p = 3\\,$ is the number of fitted parameters.\n\nConstants and units:\n- Use International System of Units (SI). Take $\\,k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}\\,$, $\\,\\mu_{\\mathrm{B}} = 9.2740100783 \\times 10^{-24}\\,\\mathrm{A \\cdot m^2}\\,$, and $\\,g = 2.0\\,$. All magnetizations $\\,M_s\\,$ are in $\\,\\mathrm{A/m}\\,$, temperature $\\,T\\,$ is in $\\,\\mathrm{K}\\,$, and $\\,D\\,$ must be reported in $\\,\\mathrm{J \\cdot m^2}\\,$.\n\nTest suite specification:\n- Your program must internally generate three synthetic datasets using the model $\\,M_s(T) = M_s(0) - A_{\\mathrm{true}} T^{3/2} - B_{\\mathrm{true}} T^{5/2} + \\varepsilon\\,$ with independent Gaussian noise $\\,\\varepsilon \\sim \\mathcal{N}(0,\\sigma^2)\\,$. For each case, compute $\\,A_{\\mathrm{true}}\\,$ from your derived $\\,A\\!-\\!D\\,$ relation using the listed $\\,D_{\\mathrm{true}}\\,$. The three cases are:\n  - Case $\\,1\\,$ (general \"happy path\"): $\\,M_s(0) = 1.70 \\times 10^6\\,\\mathrm{A/m}\\,$, $\\,D_{\\mathrm{true}} = 4.5 \\times 10^{-40}\\,\\mathrm{J \\cdot m^2}\\,$, $\\,B_{\\mathrm{true}} = 2.0 \\times 10^{-2}\\,\\mathrm{A \\cdot m^{-1} \\cdot K^{-5/2}}\\,$, $\\,T \\in [2,20]\\,\\mathrm{K}\\,$ with $\\,N=25\\,$ points uniformly spaced, noise standard deviation $\\,\\sigma = 50\\,\\mathrm{A/m}\\,$, random seed $\\,12345\\,$.\n  - Case $\\,2\\,$ (negligible subleading term): $\\,M_s(0) = 8.00 \\times 10^5\\,\\mathrm{A/m}\\,$, $\\,D_{\\mathrm{true}} = 6.0 \\times 10^{-40}\\,\\mathrm{J \\cdot m^2}\\,$, $\\,B_{\\mathrm{true}} = 0\\,$, $\\,T \\in [2,12]\\,\\mathrm{K}\\,$ with $\\,N=20\\,$, $\\,\\sigma = 30\\,\\mathrm{A/m}\\,$, seed $\\,24680\\,$.\n  - Case $\\,3\\,$ (boundary: very low $\\,T\\,$ window and larger noise): $\\,M_s(0) = 1.40 \\times 10^6\\,\\mathrm{A/m}\\,$, $\\,D_{\\mathrm{true}} = 3.0 \\times 10^{-40}\\,\\mathrm{J \\cdot m^2}\\,$, $\\,B_{\\mathrm{true}} = 1.0 \\times 10^{-2}\\,\\mathrm{A \\cdot m^{-1} \\cdot K^{-5/2}}\\,$, $\\,T \\in [2,6]\\,\\mathrm{K}\\,$ with $\\,N=6\\,$, $\\,\\sigma = 80\\,\\mathrm{A/m}\\,$, seed $\\,13579\\,$.\n\nRequirements for statistical estimation:\n- Compute the ordinary least squares estimates by minimizing the sum of squared residuals for the linear model in parameters $\\,M_s(0)\\,$, $\\,A\\,$, $\\,B\\,$.\n- Estimate the parameter covariance matrix as $\\,\\hat{\\sigma}^2 (X^\\top X)^{-1}\\,$ with $\\,\\hat{\\sigma}^2 = \\mathrm{RSS}/(N-p)\\,$, where $\\,X\\,$ is the design matrix and $\\,\\mathrm{RSS}\\,$ is the residual sum of squares.\n\nUncertainty propagation and confidence intervals:\n- Let $\\,\\hat{D} = f(\\hat{A})\\,$ be the estimator for $\\,D\\,$ implied by your physics derivation. Use the delta method $\\,\\mathrm{Var}[\\hat{D}] \\approx (f'(\\hat{A}))^2 \\mathrm{Var}[\\hat{A}]\\,$ and a two-sided $\\,95\\,$-percent confidence interval $\\,\\hat{D} \\pm t_{0.975,\\nu} \\sqrt{\\mathrm{Var}[\\hat{D}]}\\,$ with $\\,\\nu = N-p\\,$.\n\nFinal output format:\n- Your program must produce a single line of output containing a list of three lists, one per case, in the order cases $\\,1\\,$, $\\,2\\,$, $\\,3\\,$. Each inner list must be $[\\hat{D}, D_{\\mathrm{low}}, D_{\\mathrm{high}}]$ with all three values in $\\,\\mathrm{J \\cdot m^2}\\,$. Express all numbers in scientific notation with $\\,6\\,$ significant figures. The exact required format is a single line:\n\"[ [d1,d1_lo,d1_hi],[d2,d2_lo,d2_hi],[d3,d3_lo,d3_hi] ]\"\nwith no spaces (for example: \"[[1.234000e-03,1.000000e-03,1.468000e-03],[...],[...]]\").", "solution": "The solution is presented in two parts: first, the required theoretical derivation of the relationship between the spin-wave stiffness and the coefficient of the $T^{3/2}$ term in the low-temperature magnetization; second, an outline of the computational methodology for implementing the statistical analysis.\n\n**1. Theoretical Derivation**\n\nThe spontaneous magnetization $M_s(T)$ of a ferromagnet at a finite temperature $T$ is reduced from its saturation value at absolute zero, $M_s(0)$, due to the thermal excitation of magnons, which are the quanta of spin waves. Each magnon carries a spin that opposes the net magnetization, and in the simplest model, its creation reduces the total magnetic moment by $g \\mu_{\\mathrm{B}}$, where $g$ is the Landé g-factor and $\\mu_{\\mathrm{B}}$ is the Bohr magneton.\n\nThe total reduction in magnetization, $\\Delta M_s(T) = M_s(0) - M_s(T)$, is proportional to the number density of magnons, $n_{\\text{mag}}$.\n$$\n\\Delta M_s(T) = g \\mu_{\\mathrm{B}} n_{\\text{mag}}\n$$\nThe number density of magnons is calculated by integrating the Bose-Einstein distribution function, $n_{\\mathbf{k}}$, over all wavevectors $\\mathbf{k}$ in the first Brillouin zone. At low temperatures, only long-wavelength magnons are significantly populated, so the integral can be extended over all of k-space and the lattice structure can be replaced by a continuum.\n$$\nn_{\\text{mag}} = \\int_{\\mathbb{R}^3} \\frac{d^3k}{(2\\pi)^3} n_{\\mathbf{k}} = \\int_{\\mathbb{R}^3} \\frac{d^3k}{(2\\pi)^3} \\frac{1}{\\exp(\\beta \\epsilon_{\\mathbf{k}}) - 1}\n$$\nwhere $\\beta = 1/(k_{\\mathrm{B}}T)$ and $\\epsilon_{\\mathbf{k}}$ is the magnon dispersion relation. For an isotropic ferromagnet, the long-wavelength dispersion is quadratic: $\\epsilon_{\\mathbf{k}} = Dk^2$, where $D$ is the spin-wave stiffness and $k = |\\mathbf{k}|$.\n\nTo evaluate the integral, we transform to spherical coordinates in k-space, where the volume element is $d^3k = 4\\pi k^2 dk$.\n$$\nn_{\\text{mag}} = \\frac{4\\pi}{(2\\pi)^3} \\int_{0}^{\\infty} \\frac{k^2}{\\exp(\\beta D k^2) - 1} dk = \\frac{1}{2\\pi^2} \\int_{0}^{\\infty} \\frac{k^2}{\\exp(\\beta D k^2) - 1} dk\n$$\nWe perform a change of variables. Let $x = \\beta D k^2$. Then $k = (x/\\beta D)^{1/2}$ and $dk = \\frac{1}{2}(x\\beta D)^{-1/2} dx$.\nSubstituting these into the integral gives:\n$$\nn_{\\text{mag}} = \\frac{1}{2\\pi^2} \\int_{0}^{\\infty} \\frac{x}{\\beta D} \\frac{1}{e^x - 1} \\frac{1}{2\\sqrt{\\beta D}} \\frac{1}{\\sqrt{x}} dx\n= \\frac{1}{4\\pi^2 (\\beta D)^{3/2}} \\int_{0}^{\\infty} \\frac{x^{1/2}}{e^x - 1} dx\n$$\nThe integral is a standard form related to the Riemann zeta function $\\zeta(s)$ and the Gamma function $\\Gamma(s)$:\n$$\n\\int_{0}^{\\infty} \\frac{x^{s-1}}{e^x - 1} dx = \\Gamma(s)\\zeta(s)\n$$\nFor our integral, $s-1 = 1/2$, which implies $s = 3/2$. The relevant values are $\\Gamma(3/2) = \\sqrt{\\pi}/2$ and $\\zeta(3/2)$. The value of $\\zeta(3/2)$ is approximately $2.612375$.\nThe integral evaluates to $\\Gamma(3/2)\\zeta(3/2) = \\zeta(3/2)\\sqrt{\\pi}/2$. Substituting this back:\n$$\nn_{\\text{mag}} = \\frac{1}{4\\pi^2 (\\beta D)^{3/2}} \\left( \\frac{\\sqrt{\\pi}}{2} \\zeta(3/2) \\right) = \\frac{\\zeta(3/2)}{8\\pi^{3/2}} (\\beta D)^{-3/2}\n$$\nNow, substituting $\\beta = 1/(k_{\\mathrm{B}}T)$:\n$$\nn_{\\text{mag}} = \\frac{\\zeta(3/2)}{8\\pi^{3/2}} \\left(\\frac{D}{k_{\\mathrm{B}}T}\\right)^{-3/2} = \\frac{\\zeta(3/2)}{8\\pi^{3/2}} \\left(\\frac{k_{\\mathrm{B}}T}{D}\\right)^{3/2}\n$$\nThe reduction in magnetization is then:\n$$\n\\Delta M_s(T) = g \\mu_{\\mathrm{B}} \\frac{\\zeta(3/2)}{8\\pi^{3/2}} \\left(\\frac{k_{\\mathrm{B}}}{D}\\right)^{3/2} T^{3/2}\n$$\nThis is the famous Bloch $T^{3/2}$ law. The problem statement gives the low-temperature expansion as $M_s(T) = M_s(0) - A T^{3/2} - B T^{5/2}$. Comparing the leading term, we identify the coefficient $A$:\n$$\nA = g \\mu_{\\mathrm{B}} \\frac{\\zeta(3/2)}{8\\pi^{3/2}} \\left(\\frac{k_{\\mathrm{B}}}{D}\\right)^{3/2} = g \\mu_{\\mathrm{B}} \\zeta(3/2) \\left(\\frac{k_{\\mathrm{B}}}{4\\pi D}\\right)^{3/2}\n$$\nThis is the relation between $A$ and $D$. To perform inference on $D$, we need to express $D$ as a function of $A$, which is $D = f(A)$. Inverting the relation gives:\n$$\nD^{3/2} = g \\mu_{\\mathrm{B}} \\zeta(3/2) \\left(\\frac{k_{\\mathrm{B}}}{4\\pi}\\right)^{3/2} A^{-1}\n$$\n$$\nD = \\left( g \\mu_{\\mathrm{B}} \\zeta(3/2) \\left(\\frac{k_{\\mathrm{B}}}{4\\pi}\\right)^{3/2} A^{-1} \\right)^{2/3} = \\left( g \\mu_{\\mathrm{B}} \\zeta(3/2) \\right)^{2/3} \\frac{k_{\\mathrm{B}}}{4\\pi} A^{-2/3}\n$$\nThis is the required analytical relation $D = f(A)$. This derivation provides the physical basis for the subsequent data analysis.\n\n**2. Computational Methodology**\n\nThe analysis proceeds by fitting the experimental data $\\{(T_i, M_i)\\}$ to the model $M_s(T) = M_s(0) - AT^{3/2} - BT^{5/2}$. This is a multiple linear regression problem.\n\n**a. Linear Model Formulation:**\nThe model can be expressed in matrix form as $\\mathbf{y} = X\\mathbf{\\beta} + \\mathbf{\\epsilon}$.\n- The response vector $\\mathbf{y}$ contains the magnetization measurements, $y_i = M_i$.\n- The parameter vector is $\\mathbf{\\beta} = [M_s(0), A, B]^\\top$.\n- The design matrix $X$ has $N$ rows (for $N$ data points) and $p=3$ columns. The $i$-th row is $[1, -T_i^{3/2}, -T_i^{5/2}]$.\n- $\\mathbf{\\epsilon}$ is the vector of unobserved random errors, assumed to be independent and identically distributed with $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$.\n\n**b. Parameter Estimation:**\nThe Ordinary Least Squares (OLS) estimate of the parameter vector $\\hat{\\mathbf{\\beta}}$ is found by solving the normal equations:\n$$\n\\hat{\\mathbf{\\beta}} = (X^\\top X)^{-1} X^\\top \\mathbf{y}\n$$\nThis yields the estimates $\\hat{M}_s(0)$, $\\hat{A}$, and $\\hat{B}$.\n\n**c. Uncertainty Quantification:**\nThe covariance matrix of the estimated parameters is given by $\\mathrm{Cov}(\\hat{\\mathbf{\\beta}}) = \\sigma^2 (X^\\top X)^{-1}$. Since $\\sigma^2$ is unknown, it is estimated from the residuals.\n- Residuals: $\\mathbf{r} = \\mathbf{y} - X\\hat{\\mathbf{\\beta}}$\n- Residual Sum of Squares (RSS): $\\mathrm{RSS} = \\mathbf{r}^\\top\\mathbf{r}$\n- Unbiased estimator for $\\sigma^2$: $\\hat{\\sigma}^2 = \\frac{\\mathrm{RSS}}{N-p}$\nThe estimated covariance matrix is then $\\widehat{\\mathrm{Cov}}(\\hat{\\mathbf{\\beta}}) = \\hat{\\sigma}^2 (X^\\top X)^{-1}$. The variance of the coefficient of interest, $\\hat{A}$, is the second diagonal element of this matrix, $\\mathrm{Var}(\\hat{A}) = [\\widehat{\\mathrm{Cov}}(\\hat{\\mathbf{\\beta}})]_{1,1}$ (using 0-based indexing).\n\n**d. Error Propagation (Delta Method):**\nWe estimate the spin-wave stiffness using our derived function: $\\hat{D} = f(\\hat{A})$. To find the uncertainty in $\\hat{D}$, we use a first-order Taylor expansion (the delta method):\n$$\n\\mathrm{Var}(\\hat{D}) \\approx \\left( \\frac{df}{dA} \\bigg|_{A=\\hat{A}} \\right)^2 \\mathrm{Var}(\\hat{A})\n$$\nThe required derivative is:\n$$\n\\frac{df}{dA} = \\frac{d}{dA} \\left( C A^{-2/3} \\right) = C \\left(-\\frac{2}{3}\\right) A^{-5/3} = -\\frac{2}{3} \\frac{C A^{-2/3}}{A} = -\\frac{2}{3}\\frac{D}{A}\n$$\nwhere $C$ is the constant term in the expression for $D$.\nThus, the estimated variance is $\\mathrm{Var}(\\hat{D}) \\approx \\left(-\\frac{2}{3}\\frac{\\hat{D}}{\\hat{A}}\\right)^2 \\mathrm{Var}(\\hat{A})$. The standard error is $\\mathrm{SE}(\\hat{D}) = \\sqrt{\\mathrm{Var}(\\hat{D})}$.\n\n**e. Confidence Interval:**\nA two-sided $95\\%$ confidence interval for $D$ is constructed using the t-distribution because $\\sigma^2$ was estimated. The degrees of freedom are $\\nu = N-p = N-3$.\n$$\n\\text{CI}_{95\\%}(D) = \\hat{D} \\pm t_{1-0.05/2, \\nu} \\cdot \\mathrm{SE}(\\hat{D})\n$$\nwhere $t_{0.975, \\nu}$ is the upper critical value of the Student's t-distribution with $\\nu$ degrees of freedom. This procedure is implemented for each synthetic dataset provided in the problem specification.", "answer": "```python\nimport numpy as np\nfrom scipy.special import zeta as riemann_zeta\nfrom scipy.stats import t as t_distribution\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the final result.\n    \"\"\"\n    # Physical constants in SI units\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    MU_B = 9.2740100783e-24  # Bohr magneton in A*m^2\n    G_FACTOR = 2.0  # Landé g-factor\n    ZETA_3_2 = riemann_zeta(1.5)  # Riemann zeta function at 3/2\n\n    # Pre-calculate the constant factor connecting D and A\n    # D = (C/A)^(2/3), where C = G_FACTOR * MU_B * ZETA_3_2 * (K_B / (4 * np.pi))**(3/2)\n    CONSTANT_DA = G_FACTOR * MU_B * ZETA_3_2 * (K_B / (4 * np.pi))**(1.5)\n\n    def d_from_a(a_val):\n        \"\"\"Computes spin-wave stiffness D from coefficient A.\"\"\"\n        return (CONSTANT_DA / a_val)**(2.0 / 3.0)\n\n    def a_from_d(d_val):\n        \"\"\"Computes coefficient A from spin-wave stiffness D.\"\"\"\n        return CONSTANT_DA / (d_val**(1.5))\n\n    def process_case(m0_true, d_true, b_true, t_range, n_points, sigma, seed):\n        \"\"\"\n        Analyzes a single synthetic dataset to infer D and its confidence interval.\n        \"\"\"\n        # 1. Generate synthetic data\n        a_true = a_from_d(d_true)\n        rng = np.random.default_rng(seed)\n        t_values = np.linspace(t_range[0], t_range[1], n_points)\n        \n        m_true = m0_true - a_true * t_values**1.5 - b_true * t_values**2.5\n        noise = rng.normal(0, sigma, n_points)\n        m_observed = m_true + noise\n\n        # 2. Perform Ordinary Least Squares regression\n        # The model is M = M0 - A*T^1.5 - B*T^2.5, which is linear in parameters M0, A, B.\n        # M = beta_0 * 1 + beta_1 * (-T^1.5) + beta_2 * (-T^2.5)\n        # where beta = [M0, A, B]^T.\n        x0 = np.ones(n_points)\n        x1 = -t_values**1.5\n        x2 = -t_values**2.5\n        X = np.stack([x0, x1, x2], axis=1)\n        y = m_observed\n\n        # Solve normal equations: beta_hat = (X.T @ X)^-1 @ X.T @ y\n        try:\n            XTX_inv = np.linalg.inv(X.T @ X)\n        except np.linalg.LinAlgError:\n            # Handle cases of singular matrix, which might occur with very few points\n            # or extreme collinearity, although unlikely with given test cases.\n            return [np.nan, np.nan, np.nan]\n            \n        beta_hat = XTX_inv @ X.T @ y\n        m0_hat, a_hat, b_hat = beta_hat[0], beta_hat[1], beta_hat[2]\n\n        # 3. Estimate parameter uncertainties\n        num_params = 3\n        dof = n_points - num_params\n        residuals = y - X @ beta_hat\n        rss = np.sum(residuals**2)\n        sigma_sq_hat = rss / dof\n        \n        cov_beta = sigma_sq_hat * XTX_inv\n        var_a_hat = cov_beta[1, 1]\n\n        # 4. Propagate uncertainty to D using the delta method\n        if a_hat = 0:  # Physically non-sensical, would lead to complex D\n            return [np.nan, np.nan, np.nan]\n        \n        d_hat = d_from_a(a_hat)\n        \n        # Derivative of D = f(A) is f'(A) = -2/3 * D/A\n        deriv_d_a = - (2.0 / 3.0) * d_hat / a_hat\n        var_d_hat = (deriv_d_a**2) * var_a_hat\n        se_d_hat = np.sqrt(var_d_hat)\n\n        # 5. Calculate the 95% confidence interval\n        # Use Student's t-distribution as sigma was estimated\n        t_crit = t_distribution.ppf(0.975, df=dof)\n        ci_margin = t_crit * se_d_hat\n        d_low = d_hat - ci_margin\n        d_high = d_hat + ci_margin\n\n        return [d_hat, d_low, d_high]\n\n    # Test cases as specified in the problem\n    test_cases = [\n        # Case 1: General \"happy path\"\n        (1.70e6, 4.5e-40, 2.0e-2, (2, 20), 25, 50.0, 12345),\n        # Case 2: Negligible subleading term\n        (8.00e5, 6.0e-40, 0.0, (2, 12), 20, 30.0, 24680),\n        # Case 3: Boundary (low T, few points, high noise)\n        (1.40e6, 3.0e-40, 1.0e-2, (2, 6), 6, 80.0, 13579),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = process_case(*case)\n        results.append(result)\n\n    # Format the output string as per requirement\n    # \"[[d1,d1_lo,d1_hi],[d2,d2_lo,d2_hi],[d3,d3_lo,d3_hi]]\" with scientific notation and 6 sig figs.\n    # The format specifier {:.5e} provides 1 digit before and 5 after the decimal point.\n    def format_val(v):\n        return f\"{v:.6e}\"\n        \n    inner_strings = []\n    for res in results:\n        formatted_res = [format_val(v) for v in res]\n        inner_strings.append(f\"[{','.join(formatted_res)}]\")\n    \n    final_output = f\"[{','.join(inner_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2865514"}]}