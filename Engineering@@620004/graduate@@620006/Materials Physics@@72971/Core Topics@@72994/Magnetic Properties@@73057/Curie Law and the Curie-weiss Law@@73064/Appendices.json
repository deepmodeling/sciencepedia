{"hands_on_practices": [{"introduction": "The Curie-Weiss law, $\\chi = C / (T - \\Theta)$, is a cornerstone for understanding magnetism in interacting spin systems. This exercise delves into its microscopic origins using the powerful mean-field approximation. By applying this method to a general Heisenberg model for an antiferromagnet, you will derive expressions for both the Weiss temperature $\\Theta$ and the Néel temperature $T_N$, revealing how these macroscopic parameters are directly determined by the underlying exchange interactions and lattice geometry [@problem_id:2811973]. This practice is fundamental for connecting abstract theoretical models to the tangible magnetic behavior of materials.", "problem": "Consider a three-dimensional bipartite antiferromagnet on a lattice decomposed into sublattices $A$ and $B$. Each spin has $z_{1}$ nearest neighbors on the opposite sublattice and $z_{2}$ same-sublattice neighbors. The system is described by the isotropic Heisenberg Hamiltonian with an external magnetic field,\n$$\n\\mathcal{H} \\;=\\; J_{1} \\sum_{\\langle i \\in A,\\, j \\in B \\rangle} \\mathbf{S}_{i} \\cdot \\mathbf{S}_{j} \\;+\\; J_{2} \\sum_{\\langle i,\\, j \\in A \\rangle} \\mathbf{S}_{i} \\cdot \\mathbf{S}_{j} \\;+\\; J_{2} \\sum_{\\langle i,\\, j \\in B \\rangle} \\mathbf{S}_{i} \\cdot \\mathbf{S}_{j} \\;-\\; g \\mu_{B} \\, \\mathbf{B} \\cdot \\sum_{i} \\mathbf{S}_{i},\n$$\nwhere $J_{1} \\gt 0$ is the antiferromagnetic intersublattice exchange, $J_{2}$ is the same-sublattice exchange (which may have either sign), $g$ is the Landé $g$-factor, $\\mu_{B}$ is the Bohr magneton, and $\\mathbf{B}$ is a uniform magnetic field. Each site hosts a localized quantum spin of magnitude $S$.\n\nUsing Weiss molecular-field theory (mean-field decoupling of exchange interactions) and linear response in the high-temperature paramagnetic regime $T \\gt T_{N}$, derive the Curie–Weiss law for the uniform susceptibility and determine both the Weiss temperature $\\Theta$ and the Néel temperature $T_{N}$ in terms of $z_{1}$, $z_{2}$, $J_{1}$, $J_{2}$, $S$, and $k_{B}$, where $k_{B}$ is the Boltzmann constant. Then, eliminate all microscopic and thermodynamic prefactors to obtain a closed-form expression for the dimensionless ratio\n$$\nR \\;=\\; -\\,\\frac{\\Theta}{T_{N}}\n$$\nas a function of $z_{1}$, $z_{2}$, $J_{1}$, and $J_{2}$ only. Provide $R$ as a single simplified analytic expression. No units are required for $R$.", "solution": "We begin from the given Heisenberg Hamiltonian with the convention that $J_{1} \\gt 0$ favors antiparallel alignment between opposite sublattices. In Weiss molecular-field theory (mean-field approximation), the interaction of a spin with its neighbors is replaced by an effective Zeeman coupling to the average neighbor spin. Denote the sublattice magnetizations per site by $m_{A}$ and $m_{B}$, defined along the direction of the applied field $\\mathbf{B} = B \\hat{\\mathbf{z}}$, with $m_{\\alpha} = g \\mu_{B} \\langle S_{\\alpha}^{z} \\rangle$ for $\\alpha \\in \\{A,B\\}$.\n\nFor a spin on sublattice $A$, the exchange contribution to the effective field arises from $z_{1}$ neighbors on sublattice $B$ with coupling $J_{1}$ and $z_{2}$ neighbors on sublattice $A$ with coupling $J_{2}$. The exchange term $J \\,\\mathbf{S}_{i} \\cdot \\langle \\mathbf{S}_{j} \\rangle$ can be written as a Zeeman-like term $- g \\mu_{B} \\,\\mathbf{S}_{i} \\cdot \\mathbf{B}_{\\mathrm{ex}}$ with\n$$\n\\mathbf{B}_{\\mathrm{ex}} \\;=\\; - \\frac{J}{g \\mu_{B}} \\,\\langle \\mathbf{S}_{j} \\rangle \\;=\\; - \\frac{J}{(g \\mu_{B})^{2}} \\,\\mathbf{m}_{\\text{neighbor}},\n$$\nwhere $\\mathbf{m}_{\\text{neighbor}} = g \\mu_{B} \\langle \\mathbf{S}_{j} \\rangle$ is the neighbor magnetization per site. Summing over neighbors, the effective field on sublattice $A$ is\n$$\nB_{\\mathrm{eff}}^{A} \\;=\\; B \\;-\\; \\frac{z_{1} J_{1}}{(g \\mu_{B})^{2}} \\, m_{B} \\;-\\; \\frac{z_{2} J_{2}}{(g \\mu_{B})^{2}} \\, m_{A}.\n$$\nBy symmetry, on sublattice $B$,\n$$\nB_{\\mathrm{eff}}^{B} \\;=\\; B \\;-\\; \\frac{z_{1} J_{1}}{(g \\mu_{B})^{2}} \\, m_{A} \\;-\\; \\frac{z_{2} J_{2}}{(g \\mu_{B})^{2}} \\, m_{B}.\n$$\n\nIn the high-temperature paramagnetic regime and for small fields, the magnetization of a single spin in an effective field is linear in that field with Curie susceptibility. The single-site Curie constant is\n$$\nC_{\\mathrm{site}} \\;=\\; \\frac{(g \\mu_{B})^{2} S (S+1)}{3 k_{B}},\n$$\nso that the linear response on each sublattice reads\n$$\nm_{A} \\;=\\; \\frac{C_{\\mathrm{site}}}{T} \\, B_{\\mathrm{eff}}^{A}, \\qquad\nm_{B} \\;=\\; \\frac{C_{\\mathrm{site}}}{T} \\, B_{\\mathrm{eff}}^{B}.\n$$\nIntroduce the abbreviations\n$$\n\\alpha \\;=\\; \\frac{z_{2} J_{2}}{(g \\mu_{B})^{2}}, \\qquad \\beta \\;=\\; \\frac{z_{1} J_{1}}{(g \\mu_{B})^{2}}.\n$$\nThe coupled linear equations become\n$$\n\\left[ 1 + \\frac{C_{\\mathrm{site}}}{T} \\alpha \\right] m_{A} + \\frac{C_{\\mathrm{site}}}{T} \\beta \\, m_{B} \\;=\\; \\frac{C_{\\mathrm{site}}}{T} B,\n$$\n$$\n\\frac{C_{\\mathrm{site}}}{T} \\beta \\, m_{A} + \\left[ 1 + \\frac{C_{\\mathrm{site}}}{T} \\alpha \\right] m_{B} \\;=\\; \\frac{C_{\\mathrm{site}}}{T} B.\n$$\nAdding the two equations yields an equation for the uniform magnetization per site $m \\equiv \\frac{m_{A} + m_{B}}{2}$:\n$$\n\\left[ 1 + \\frac{C_{\\mathrm{site}}}{T} (\\alpha + \\beta) \\right] (m_{A} + m_{B}) \\;=\\; \\frac{2 C_{\\mathrm{site}}}{T} B,\n$$\nhence\n$$\nm \\;=\\; \\frac{C_{\\mathrm{site}}}{T} \\, \\frac{1}{1 + \\frac{C_{\\mathrm{site}}}{T} (\\alpha + \\beta)} \\, B.\n$$\nTherefore, the uniform susceptibility per site is\n$$\n\\chi_{\\mathrm{site}}(T) \\;\\equiv\\; \\frac{m}{B} \\;=\\; \\frac{C_{\\mathrm{site}}}{T + C_{\\mathrm{site}} (\\alpha + \\beta)}.\n$$\nThis is the Curie–Weiss form\n$$\n\\chi_{\\mathrm{site}}(T) \\;=\\; \\frac{C_{\\mathrm{site}}}{T - \\Theta},\n$$\nwith the Weiss temperature\n$$\n\\Theta \\;=\\; - \\, C_{\\mathrm{site}} (\\alpha + \\beta) \\;=\\; - \\, \\frac{(g \\mu_{B})^{2} S (S+1)}{3 k_{B}} \\, \\frac{z_{1} J_{1} + z_{2} J_{2}}{(g \\mu_{B})^{2}} \\;=\\; - \\, \\frac{S (S+1)}{3 k_{B}} \\, \\big( z_{1} J_{1} + z_{2} J_{2} \\big).\n$$\n\nNext, we determine the Néel temperature $T_{N}$ from the zero-field instability. Set $B = 0$ and search for the temperature at which a nontrivial solution for $(m_{A}, m_{B})$ first appears. The homogeneous linear system\n$$\nm_{A} \\;=\\; - \\frac{C_{\\mathrm{site}}}{T} \\left( \\alpha \\, m_{A} + \\beta \\, m_{B} \\right), \\qquad\nm_{B} \\;=\\; - \\frac{C_{\\mathrm{site}}}{T} \\left( \\beta \\, m_{A} + \\alpha \\, m_{B} \\right)\n$$\ncan be written as $\\big[ \\mathbf{I} + \\frac{C_{\\mathrm{site}}}{T} \\mathbf{M} \\big] \\mathbf{m} = \\mathbf{0}$ with\n$$\n\\mathbf{M} \\;=\\; \\begin{pmatrix} \\alpha & \\beta \\\\ \\beta & \\alpha \\end{pmatrix}, \\qquad \\mathbf{m} \\;=\\; \\begin{pmatrix} m_{A} \\\\ m_{B} \\end{pmatrix}.\n$$\nNontrivial solutions require $\\det \\big[ \\mathbf{I} + \\frac{C_{\\mathrm{site}}}{T} \\mathbf{M} \\big] = 0$. The eigenvalues of $\\mathbf{M}$ are\n$$\n\\lambda_{+} \\;=\\; \\alpha + \\beta \\quad \\text{with eigenvector } (1,1), \\qquad\n\\lambda_{-} \\;=\\; \\alpha - \\beta \\quad \\text{with eigenvector } (1,-1).\n$$\nAntiferromagnetic order corresponds to the staggered mode with eigenvector $(1,-1)$, hence the ordering temperature is set by\n$$\n1 + \\frac{C_{\\mathrm{site}}}{T_{N}} \\, \\lambda_{-} \\;=\\; 0 \\;\\;\\Rightarrow\\;\\; T_{N} \\;=\\; - \\, C_{\\mathrm{site}} \\, \\lambda_{-}.\n$$\nSubstituting $\\lambda_{-} = \\alpha - \\beta$ and the definitions of $\\alpha$ and $\\beta$ gives\n$$\nT_{N} \\;=\\; - \\, \\frac{(g \\mu_{B})^{2} S (S+1)}{3 k_{B}} \\, \\frac{z_{2} J_{2} - z_{1} J_{1}}{(g \\mu_{B})^{2}} \\;=\\; \\frac{S (S+1)}{3 k_{B}} \\, \\big( z_{1} J_{1} - z_{2} J_{2} \\big),\n$$\nwhich is positive when $z_{1} J_{1} \\gt z_{2} J_{2}$, as required for stable antiferromagnetic ordering.\n\nFinally, the requested dimensionless ratio is\n$$\nR \\;\\equiv\\; - \\, \\frac{\\Theta}{T_{N}} \\;=\\; - \\, \\frac{ - \\frac{S (S+1)}{3 k_{B}} \\, ( z_{1} J_{1} + z_{2} J_{2} ) }{ \\frac{S (S+1)}{3 k_{B}} \\, ( z_{1} J_{1} - z_{2} J_{2} ) } \\;=\\; \\frac{ z_{1} J_{1} + z_{2} J_{2} }{ z_{1} J_{1} - z_{2} J_{2} }.\n$$\nAll microscopic and thermodynamic prefactors cancel, leaving $R$ expressed solely in terms of geometry and exchange parameters. This completes the derivation.", "answer": "$$\\boxed{\\frac{z_{1} J_{1} + z_{2} J_{2}}{z_{1} J_{1} - z_{2} J_{2}}}$$", "id": "2811973"}, {"introduction": "Ideal materials are a theoretical convenience; real samples often contain defects that can significantly influence their measured properties. This practice addresses a common experimental observation in magnetic susceptibility measurements: a low-temperature upturn known as a \"Curie tail,\" which often masks the intrinsic magnetic behavior. You will learn to model this tail as arising from a dilute concentration of non-interacting paramagnetic defect spins and, using the simple Curie law, quantify the defect fraction from a given experimental data point [@problem_id:2811981]. This skill is essential for correctly interpreting magnetic data and separating intrinsic properties from extrinsic effects.", "problem": "A transition-metal oxide is synthesized with a magnetically active sublattice of localized spins that is randomly diluted by nonmagnetic ions, so that only a fraction $p$ of the crystallographic sites participate in exchange interactions. In the paramagnetic regime well above any ordering temperature, the exchange can be treated in a mean-field picture that introduces an internal field proportional to the magnetization. In a separate measurement, the inverse molar susceptibility $1/\\chi_{\\mathrm{mol}}(T)$ of the host (after subtracting small temperature-independent background contributions) is found to be linear in $T$ at high temperature, enabling a reliable extrapolation of the host response down to low temperature. At $T = 10.0\\,\\mathrm{K}$ the measured molar susceptibility exceeds this extrapolated host value by a small amount $\\Delta \\chi_{\\mathrm{mol}}(10.0\\,\\mathrm{K})$, which is attributed to a dilute population of unpaired, noninteracting defect spins that do not participate in the exchange network. This low-temperature upturn is the so-called Curie tail.\n\nAssume the following.\n- Each defect is an isolated localized spin with quantum number $S_{d} = \\tfrac{1}{2}$ and Landé factor $g_{d} = 2.00$, with no crystal-field splitting of the spin multiplet.\n- The applied field is sufficiently weak that the response is in the linear regime and the Zeeman energy is small compared to $k_{B}T$.\n- Demagnetizing effects can be neglected so that the magnetic induction experienced by the defect spins satisfies $B \\approx \\mu_{0} H$.\n- Any temperature-independent Pauli or Van Vleck contributions have already been subtracted in constructing $\\Delta \\chi_{\\mathrm{mol}}(T)$.\n\nStarting from the canonical partition function for a single spin in a magnetic field and using only linear-response and high-temperature expansions consistent with the above assumptions, derive the leading-order expression for the molar susceptibility of $x$ moles of such defect spins per mole of material, and then determine the defect molar fraction $x$ from the measured low-temperature upturn\n$$\n\\Delta \\chi_{\\mathrm{mol}}(10.0\\,\\mathrm{K}) = 2.00 \\times 10^{-9}\\,\\mathrm{m^{3}\\,mol^{-1}}.\n$$\nYou may use the fundamental constants $k_{B} = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$, $\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\mathrm{N\\,A^{-2}}$, $N_{A} = 6.022\\,140\\,76 \\times 10^{23}\\,\\mathrm{mol^{-1}}$, and $\\mu_{B} = 9.274\\,010\\,0783 \\times 10^{-24}\\,\\mathrm{J\\,T^{-1}}$. Express your final answer for $x$ as a dimensionless decimal fraction and round to three significant figures.", "solution": "The objective is to find the molar fraction $x$ of non-interacting defect spins. This requires deriving the expression for the molar magnetic susceptibility of these spins, a result known as Curie's Law.\n\nWe begin with the canonical partition function for a single defect spin $S_d$ in an external magnetic field $B$. The energy levels of the spin are given by the Zeeman effect:\n$$\nE_{m_S} = -m_S g_d \\mu_B B\n$$\nwhere $m_S$ is the magnetic spin quantum number. For a spin $S_d = \\frac{1}{2}$, $m_S$ can take values of $+\\frac{1}{2}$ and $-\\frac{1}{2}$. The two energy levels are:\n$$\nE_{+} = -\\frac{1}{2} g_d \\mu_B B \\quad \\text{and} \\quad E_{-} = +\\frac{1}{2} g_d \\mu_B B\n$$\nThe partition function for a single spin, $Z_1$, is the sum over all states of the Boltzmann factor:\n$$\nZ_1 = \\sum_{m_S} \\exp\\left(-\\frac{E_{m_S}}{k_B T}\\right) = \\exp\\left(-\\frac{E_{+}}{k_B T}\\right) + \\exp\\left(-\\frac{E_{-}}{k_B T}\\right)\n$$\n$$\nZ_1 = \\exp\\left(\\frac{g_d \\mu_B B}{2 k_B T}\\right) + \\exp\\left(-\\frac{g_d \\mu_B B}{2 k_B T}\\right) = 2 \\cosh\\left(\\frac{g_d \\mu_B B}{2 k_B T}\\right)\n$$\nThe average magnetic moment of a single spin along the field direction, $\\langle \\mu_z \\rangle$, is found from the partition function:\n$$\n\\langle \\mu_z \\rangle = k_B T \\frac{\\partial (\\ln Z_1)}{\\partial B}\n$$\nSubstituting the expression for $Z_1$:\n$$\n\\ln Z_1 = \\ln(2) + \\ln\\left[\\cosh\\left(\\frac{g_d \\mu_B B}{2 k_B T}\\right)\\right]\n$$\n$$\n\\frac{\\partial (\\ln Z_1)}{\\partial B} = \\frac{1}{\\cosh\\left(\\frac{g_d \\mu_B B}{2 k_B T}\\right)} \\sinh\\left(\\frac{g_d \\mu_B B}{2 k_B T}\\right) \\cdot \\frac{g_d \\mu_B}{2 k_B T} = \\frac{g_d \\mu_B}{2 k_B T} \\tanh\\left(\\frac{g_d \\mu_B B}{2 k_B T}\\right)\n$$\nThus, the average moment is:\n$$\n\\langle \\mu_z \\rangle = k_B T \\left[ \\frac{g_d \\mu_B}{2 k_B T} \\tanh\\left(\\frac{g_d \\mu_B B}{2 k_B T}\\right) \\right] = \\frac{1}{2} g_d \\mu_B \\tanh\\left(\\frac{g_d \\mu_B B}{2 k_B T}\\right)\n$$\nThe problem states that the applied field is weak, corresponding to the linear response regime where $g_d \\mu_B B \\ll k_B T$. In this limit, the argument of the hyperbolic tangent is small, and we can use the Taylor expansion $\\tanh(y) \\approx y$ for $y \\ll 1$. Let $y = \\frac{g_d \\mu_B B}{2 k_B T}$.\n$$\n\\langle \\mu_z \\rangle \\approx \\frac{1}{2} g_d \\mu_B \\left( \\frac{g_d \\mu_B B}{2 k_B T} \\right) = \\frac{g_d^2 \\mu_B^2}{4 k_B T} B\n$$\nThis result can be generalized for any spin quantum number $S_d$ in the same limit, leading to:\n$$\n\\langle \\mu_z \\rangle = \\frac{g_d^2 \\mu_B^2 S_d(S_d+1)}{3 k_B T} B\n$$\nFor $S_d = \\frac{1}{2}$, $S_d(S_d+1) = \\frac{1}{2}(\\frac{3}{2}) = \\frac{3}{4}$. Substituting this into the general formula yields $\\frac{g_d^2 \\mu_B^2 (3/4)}{3 k_B T} B = \\frac{g_d^2 \\mu_B^2}{4 k_B T} B$, confirming consistency.\n\nThe molar susceptibility contribution from the defects, $\\Delta \\chi_{\\mathrm{mol}}$, is what we must calculate. If there are $x$ moles of defect spins per mole of material, the total magnetic moment per mole of material due to these defects is $M_{d, \\mathrm{mol}} = x N_A \\langle \\mu_z \\rangle$.\n$$\nM_{d, \\mathrm{mol}} = x N_A \\frac{g_d^2 \\mu_B^2 S_d(S_d+1)}{3 k_B T} B\n$$\nThe molar susceptibility is defined as $\\chi_{\\mathrm{mol}} = \\frac{M_{\\mathrm{mol}}}{H}$, where $H$ is the magnetic field strength. The problem specifies the approximation $B \\approx \\mu_0 H$. Therefore, $H \\approx B / \\mu_0$. The defect contribution is:\n$$\n\\Delta \\chi_{\\mathrm{mol}}(T) = \\frac{M_{d, \\mathrm{mol}}}{H} \\approx \\frac{M_{d, \\mathrm{mol}}}{B/\\mu_0} = \\mu_0 \\frac{M_{d, \\mathrm{mol}}}{B}\n$$\nSubstituting the expression for $M_{d, \\mathrm{mol}}$:\n$$\n\\Delta \\chi_{\\mathrm{mol}}(T) = \\mu_0 \\frac{1}{B} \\left( x N_A \\frac{g_d^2 \\mu_B^2 S_d(S_d+1)}{3 k_B T} B \\right) = \\frac{\\mu_0 x N_A g_d^2 \\mu_B^2 S_d(S_d+1)}{3 k_B T}\n$$\nThis is the required expression for the molar susceptibility of the defect spins. We can rearrange this to solve for the molar fraction $x$:\n$$\nx = \\frac{3 k_B T \\Delta \\chi_{\\mathrm{mol}}(T)}{\\mu_0 N_A g_d^2 \\mu_B^2 S_d(S_d+1)}\n$$\nNow we substitute the given numerical values:\n- $T = 10.0\\,\\mathrm{K}$\n- $\\Delta \\chi_{\\mathrm{mol}}(10.0\\,\\mathrm{K}) = 2.00 \\times 10^{-9}\\,\\mathrm{m^{3}\\,mol^{-1}}$\n- $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$\n- $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{N\\,A^{-2}}$\n- $N_A = 6.02214076 \\times 10^{23}\\,\\mathrm{mol^{-1}}$\n- $g_d = 2.00$\n- $\\mu_B = 9.2740100783 \\times 10^{-24}\\,\\mathrm{J\\,T^{-1}}$\n- $S_d = \\frac{1}{2}$, so $S_d(S_d+1) = \\frac{3}{4} = 0.75$\n\nFirst, compute the numerator:\n$$\n\\text{Numerator} = 3 \\times (1.380649 \\times 10^{-23}) \\times (10.0) \\times (2.00 \\times 10^{-9}) = 8.283894 \\times 10^{-31}\\,\\mathrm{J\\,m^3\\,mol^{-1}}\n$$\nNext, compute the denominator:\n$$\n\\text{Denominator} = \\mu_0 N_A g_d^2 \\mu_B^2 S_d(S_d+1)\n$$\n$$\n\\text{Denominator} = (4\\pi \\times 10^{-7}) \\times (6.02214076 \\times 10^{23}) \\times (2.00)^2 \\times (9.2740100783 \\times 10^{-24})^2 \\times (0.75)\n$$\nThe product $g_d^2 S_d(S_d+1) = (2.00)^2 \\times 0.75 = 4 \\times 0.75 = 3$.\n$$\n\\text{Denominator} = (4\\pi \\times 10^{-7}) \\times (6.02214076 \\times 10^{23}) \\times 3 \\times (9.2740100783 \\times 10^{-24})^2\n$$\n$$\n\\text{Denominator} \\approx (1.256637 \\times 10^{-6}) \\times (6.022141 \\times 10^{23}) \\times 3 \\times (8.60073 \\times 10^{-47})\n$$\n$$\n\\text{Denominator} \\approx 1.95282 \\times 10^{-28}\\,\\mathrm{J\\,m^3\\,mol^{-1}}\n$$\nFinally, we compute the ratio for $x$:\n$$\nx = \\frac{8.283894 \\times 10^{-31}}{1.95282 \\times 10^{-28}} \\approx 4.2419 \\times 10^{-3}\n$$\nThe problem requires the answer as a decimal fraction rounded to three significant figures.\n$$\nx \\approx 0.00424\n$$\nThis value represents the molar fraction of defect spins in the material.", "answer": "$$\n\\boxed{0.00424}\n$$", "id": "2811981"}, {"introduction": "Extracting accurate physical parameters from raw experimental data requires a careful and systematic data-reduction process. This computational exercise simulates the full workflow, from a synthetic \"measurement\" of magnetization $M$ versus applied field $H_{\\mathrm{app}}$ to the final determination of the Curie constant $C$ and Weiss temperature $\\Theta$. You will implement crucial corrections for sample shape effects (demagnetization) and background signals before fitting the corrected data to the Curie-Weiss model [@problem_id:2811974]. This hands-on programming task bridges the gap between theoretical laws and the practical realities of experimental magnetometry, building invaluable skills for data analysis.", "problem": "Anisotropic specimens measured in a magnetometer exhibit demagnetization effects that distort the relation between the applied magnetic field and the internal magnetic field. In a local-moment paramagnet above cooperative ordering, the response of the internal magnetization to the internal magnetic field is governed by first principles of statistical mechanics in the weak-field, high-temperature regime. Starting from the Boltzmann distribution for localized moments and the definition of magnetization as the derivative of the free energy with respect to the internal magnetic field, it follows that the internal magnetic susceptibility is inversely proportional to temperature in the absence of interactions. Within a mean-field treatment of weak exchange interactions, the internal susceptibility becomes a rational function of temperature that remains linear when inverted as a function of temperature. The measurement, however, is performed at an applied field, so the internal field must be reconstructed by accounting for demagnetization. Your task is to derive a correct data-reduction pipeline from these fundamentals and implement it to perform parameter extraction from synthetic measurement data.\n\nYou must write a program that, for each test case described below, does the following using purely algebraic manipulations and ordinary least squares:\n- Compute the apparent susceptibility from the measured magnetization and applied field.\n- Correct the apparent susceptibility for demagnetization to obtain the total internal susceptibility.\n- Subtract a known temperature-independent background to obtain the intrinsic internal susceptibility.\n- Fit the inverse intrinsic susceptibility as a linear function of temperature and map the fit coefficients to the Curie constant and the Weiss temperature.\n\nUse the following physically and numerically consistent relations:\n- Let $H_{\\mathrm{app}}$ denote the applied magnetic field strength in $\\mathrm{A/m}$, $M$ the measured magnetization in $\\mathrm{A/m}$, $N$ the dimensionless demagnetization factor, and $\\chi$ the dimensionless magnetic susceptibility.\n- The internal field is $H_{\\mathrm{int}} = H_{\\mathrm{app}} - N M$.\n- The measured magnetization satisfies $M = \\chi_{\\mathrm{tot,int}} H_{\\mathrm{int}}$, where $\\chi_{\\mathrm{tot,int}}(T) = \\chi_{\\mathrm{int}}(T) + \\chi_{0}$ and $\\chi_{0}$ is a known temperature-independent background susceptibility.\n- Define the apparent (measured) susceptibility $\\chi_{\\mathrm{app}}(T) = M(T)/H_{\\mathrm{app}}$. From $M = \\chi_{\\mathrm{tot,int}} (H_{\\mathrm{app}} - N M)$, algebraically eliminate $M$ to get an explicit relation between $\\chi_{\\mathrm{app}}$ and $\\chi_{\\mathrm{tot,int}}$, and invert it to express $\\chi_{\\mathrm{tot,int}}$ in terms of $\\chi_{\\mathrm{app}}$ and $N$.\n- The intrinsic internal susceptibility is $\\chi_{\\mathrm{int}}(T) = \\chi_{\\mathrm{tot,int}}(T) - \\chi_{0}$.\n- Under the assumptions stated above, in the temperature regime of interest, the inverse intrinsic susceptibility is an affine function of temperature: $[\\chi_{\\mathrm{int}}(T)]^{-1} = a T + b$, where the slope and intercept are related to the Curie constant $C$ and the Weiss temperature $\\Theta$ by $C = 1/a$ and $\\Theta = -\\,b/a$. You must obtain $a$ and $b$ by an ordinary least squares linear fit of $[\\chi_{\\mathrm{int}}(T)]^{-1}$ versus $T$.\n\nFor each test case below, synthetic “measured” data are defined by a deterministic model. You must use these definitions to produce $M(T)$, then apply the steps above to recover estimates of $C$ and $\\Theta$. All physical quantities are in the International System of Units (SI). All temperatures must be treated in kelvin, magnetic fields in $\\mathrm{A/m}$, magnetization in $\\mathrm{A/m}$, and susceptibilities are dimensionless. You must report the Curie constants and Weiss temperatures in $\\mathrm{K}$. Round each reported number to exactly $6$ decimal places.\n\nSynthetic data generation for each test case:\n- Given parameters $\\{T_{i}\\}$ (in $\\mathrm{K}$), $H_{\\mathrm{app}}$ (in $\\mathrm{A/m}$), $N$ (dimensionless), $C$ (in $\\mathrm{K}$), $\\Theta$ (in $\\mathrm{K}$), $\\chi_{0}$ (dimensionless), and a small dimensionless distortion amplitude $\\beta$, define\n  - $\\chi_{\\mathrm{int}}(T) = C/(T - \\Theta)$,\n  - $\\chi_{\\mathrm{tot,int}}(T) = \\chi_{\\mathrm{int}}(T) + \\chi_{0}$,\n  - $M_{\\mathrm{true}}(T) = \\dfrac{\\chi_{\\mathrm{tot,int}}(T)}{1 + N \\,\\chi_{\\mathrm{tot,int}}(T)} \\, H_{\\mathrm{app}}$,\n  - Let $T_{\\mathrm{mean}}$ be the arithmetic mean of $\\{T_{i}\\}$, and define a small deterministic measurement distortion $\\Delta M(T) = \\beta \\, H_{\\mathrm{app}} \\dfrac{T - T_{\\mathrm{mean}}}{T_{\\mathrm{mean}}}$,\n  - The measured magnetization is $M(T) = M_{\\mathrm{true}}(T) + \\Delta M(T)$.\n\nYour program must implement the following data-reduction pipeline for each test case:\n- Compute $\\chi_{\\mathrm{app}}(T) = M(T)/H_{\\mathrm{app}}$.\n- Compute $\\chi_{\\mathrm{tot,int}}(T) = \\dfrac{\\chi_{\\mathrm{app}}(T)}{1 - N \\,\\chi_{\\mathrm{app}}(T)}$.\n- Compute $\\chi_{\\mathrm{int}}(T) = \\chi_{\\mathrm{tot,int}}(T) - \\chi_{0}$.\n- Perform an unweighted ordinary least squares fit of $y = [\\chi_{\\mathrm{int}}(T)]^{-1}$ versus $x = T$ over the provided $\\{T_{i}\\}$ to obtain the best-fit slope $a$ and intercept $b$.\n- Return $C = 1/a$ and $\\Theta = -\\,b/a$.\n\nTest suite:\n- Case $1$ (no demagnetization, no background, no distortion):\n  - $T = [160, 180, 200, 240, 300]$ in $\\mathrm{K}$,\n  - $H_{\\mathrm{app}} = 80000\\,\\mathrm{A/m}$,\n  - $N = 0.0$,\n  - $C = 1.80\\,\\mathrm{K}$,\n  - $\\Theta = 35.0\\,\\mathrm{K}$,\n  - $\\chi_{0} = 0.0$,\n  - $\\beta = 0.0$.\n- Case $2$ (thin plate, negative Weiss temperature, diamagnetic background, small positive distortion):\n  - $T = [100, 140, 200, 260, 320]$ in $\\mathrm{K}$,\n  - $H_{\\mathrm{app}} = 40000\\,\\mathrm{A/m}$,\n  - $N = 0.85$,\n  - $C = 0.95\\,\\mathrm{K}$,\n  - $\\Theta = -12.0\\,\\mathrm{K}$,\n  - $\\chi_{0} = -1.0\\times 10^{-4}$,\n  - $\\beta = 2.0\\times 10^{-4}$.\n- Case $3$ (moderate demagnetization, small positive Weiss temperature, small paramagnetic background, small negative distortion):\n  - $T = [50, 80, 120, 200, 280]$ in $\\mathrm{K}$,\n  - $H_{\\mathrm{app}} = 120000\\,\\mathrm{A/m}$,\n  - $N = 0.33$,\n  - $C = 0.42\\,\\mathrm{K}$,\n  - $\\Theta = 5.0\\,\\mathrm{K}$,\n  - $\\chi_{0} = 2.5\\times 10^{-5}$,\n  - $\\beta = -1.5\\times 10^{-4}$.\n- Case $4$ (very large demagnetization, small Curie constant, negligible background, small positive distortion):\n  - $T = [30, 40, 60, 100, 180]$ in $\\mathrm{K}$,\n  - $H_{\\mathrm{app}} = 60000\\,\\mathrm{A/m}$,\n  - $N = 0.95$,\n  - $C = 0.20\\,\\mathrm{K}$,\n  - $\\Theta = 1.0\\,\\mathrm{K}$,\n  - $\\chi_{0} = 0.0$,\n  - $\\beta = 1.0\\times 10^{-4}$.\n\nOutput specification:\n- For each case, compute the fitted $(C, \\Theta)$ in $\\mathrm{K}$ from the reduction pipeline above, each rounded to exactly $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order $[C_{1}, \\Theta_{1}, C_{2}, \\Theta_{2}, C_{3}, \\Theta_{3}, C_{4}, \\Theta_{4}]$ where subscripts denote the case index, with no additional text.", "solution": "The fundamental principle is that the magnetic susceptibility of a paramagnetic material above its ordering temperature often follows the Curie-Weiss law. The measured magnetization $M$, however, is a response to the *internal* magnetic field $H_{\\mathrm{int}}$, not the externally applied field $H_{\\mathrm{app}}$. The internal and applied fields are related by $H_{\\mathrm{int}} = H_{\\mathrm{app}} - H_{\\mathrm{demag}}$, where the demagnetizing field $H_{\\mathrm{demag}} = N M$ arises from the magnetic poles induced on the surface of a finite-sized sample and depends on the sample shape through the demagnetization factor $N$.\n\nThe intrinsic magnetic response of the material is described by the Curie-Weiss law for the intrinsic susceptibility, $\\chi_{\\mathrm{int}}(T)$:\n$$\n\\chi_{\\mathrm{int}}(T) = \\frac{C}{T - \\Theta}\n$$\nwhere $C$ is the Curie constant and $\\Theta$ is the Weiss temperature. A real material may also exhibit a small, temperature-independent susceptibility contribution, $\\chi_{0}$, due to effects like core-electron diamagnetism or Pauli paramagnetism. The total internal susceptibility is therefore $\\chi_{\\mathrm{tot,int}}(T) = \\chi_{\\mathrm{int}}(T) + \\chi_{0}$.\n\nThe measured magnetization is related to the internal field and total internal susceptibility by:\n$$\nM = \\chi_{\\mathrm{tot,int}} H_{\\mathrm{int}} = \\chi_{\\mathrm{tot,int}} (H_{\\mathrm{app}} - N M)\n$$\nThe goal of the data reduction is to invert this process: starting from the measured quantities $M$ and $H_{\\mathrm{app}}$, and known sample parameters $N$ and $\\chi_{0}$, we must extract the parameters $C$ and $\\Theta$.\n\nThe procedure is as follows:\n\nFirst, one generates synthetic \"measured\" magnetization data, $M(T)$, for a set of temperatures $\\{T_i\\}$ using the provided model parameters. This mimics an experimental measurement that includes a small systematic distortion term, $\\Delta M(T)$:\n$$\nM(T) = M_{\\mathrm{true}}(T) + \\Delta M(T) = \\frac{\\chi_{\\mathrm{tot,int}}(T)}{1 + N \\chi_{\\mathrm{tot,int}}(T)} H_{\\mathrm{app}} + \\beta H_{\\mathrm{app}} \\frac{T - T_{\\mathrm{mean}}}{T_{\\mathrm{mean}}}\n$$\n\nNext, we execute the data-reduction pipeline.\n\nStep 1: Compute the apparent susceptibility, $\\chi_{\\mathrm{app}}(T)$. This is the raw susceptibility calculated directly from the applied field, neglecting the demagnetization effect.\n$$\n\\chi_{\\mathrm{app}}(T) = \\frac{M(T)}{H_{\\mathrm{app}}}\n$$\n\nStep 2: Correct for the demagnetization effect to find the total internal susceptibility, $\\chi_{\\mathrm{tot,int}}(T)$. We must algebraically solve for $\\chi_{\\mathrm{tot,int}}$ from the relation between the apparent and internal susceptibilities. Starting from $M = \\chi_{\\mathrm{app}} H_{\\mathrm{app}}$ and the constitutive relation $M = \\chi_{\\mathrm{tot,int}} (H_{\\mathrm{app}} - N M)$, we substitute for $M$:\n$$\n\\chi_{\\mathrm{app}} H_{\\mathrm{app}} = \\chi_{\\mathrm{tot,int}} (H_{\\mathrm{app}} - N \\chi_{\\mathrm{app}} H_{\\mathrm{app}})\n$$\nDividing by $H_{\\mathrm{app}}$ (which is non-zero) and factoring $\\chi_{\\mathrm{tot,int}}$ gives:\n$$\n\\chi_{\\mathrm{app}} = \\chi_{\\mathrm{tot,int}} (1 - N \\chi_{\\mathrm{app}})\n$$\nThis yields the required correction formula:\n$$\n\\chi_{\\mathrm{tot,int}}(T) = \\frac{\\chi_{\\mathrm{app}}(T)}{1 - N \\chi_{\\mathrm{app}}(T)}\n$$\n\nStep 3: Isolate the intrinsic Curie-Weiss susceptibility, $\\chi_{\\mathrm{int}}(T)$, by subtracting the known temperature-independent background contribution, $\\chi_{0}$.\n$$\n\\chi_{\\mathrm{int}}(T) = \\chi_{\\mathrm{tot,int}}(T) - \\chi_{0}\n$$\n\nStep 4: Perform a linear fit to extract the parameters. The Curie-Weiss law is non-linear in $T$, but its inverse is linear:\n$$\n\\frac{1}{\\chi_{\\mathrm{int}}(T)} = \\frac{T - \\Theta}{C} = \\left(\\frac{1}{C}\\right)T - \\frac{\\Theta}{C}\n$$\nThis is an equation of the form $y = a x + b$, where the dependent variable is $y = [\\chi_{\\mathrm{int}}(T)]^{-1}$ and the independent variable is $x = T$. We perform an unweighted ordinary least squares (OLS) linear regression on the set of data points $(T_i, [\\chi_{\\mathrm{int}}(T_i)]^{-1})$ to find the best-fit slope $a$ and intercept $b$.\n\nBy comparing the fit equation to the theoretical form, we identify the coefficients:\n$$\na = \\frac{1}{C} \\quad \\text{and} \\quad b = -\\frac{\\Theta}{C}\n$$\nFrom these, we solve for the physical parameters $C$ and $\\Theta$:\n$$\nC = \\frac{1}{a}\n$$\n$$\n\\Theta = -b C = -b \\left(\\frac{1}{a}\\right) = -\\frac{b}{a}\n$$\nThis completes the derivation of the data-reduction pipeline. The implementation will follow these steps precisely for each test case provided.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the magnetic susceptibility analysis problem for a series of test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"T_values\": [160, 180, 200, 240, 300],\n            \"H_app\": 80000.0,\n            \"N\": 0.0,\n            \"C\": 1.80,\n            \"Theta\": 35.0,\n            \"chi0\": 0.0,\n            \"beta\": 0.0,\n        },\n        {\n            \"T_values\": [100, 140, 200, 260, 320],\n            \"H_app\": 40000.0,\n            \"N\": 0.85,\n            \"C\": 0.95,\n            \"Theta\": -12.0,\n            \"chi0\": -1.0e-4,\n            \"beta\": 2.0e-4,\n        },\n        {\n            \"T_values\": [50, 80, 120, 200, 280],\n            \"H_app\": 120000.0,\n            \"N\": 0.33,\n            \"C\": 0.42,\n            \"Theta\": 5.0,\n            \"chi0\": 2.5e-5,\n            \"beta\": -1.5e-4,\n        },\n        {\n            \"T_values\": [30, 40, 60, 100, 180],\n            \"H_app\": 60000.0,\n            \"N\": 0.95,\n            \"C\": 0.20,\n            \"Theta\": 1.0,\n            \"chi0\": 0.0,\n            \"beta\": 1.0e-4,\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters for the current case\n        T = np.array(case[\"T_values\"], dtype=float)\n        H_app = case[\"H_app\"]\n        N = case[\"N\"]\n        C_true = case[\"C\"]\n        Theta_true = case[\"Theta\"]\n        chi0 = case[\"chi0\"]\n        beta = case[\"beta\"]\n\n        # --- Synthetic Data Generation ---\n        \n        # Avoid division by zero if T is exactly Theta\n        # Add a small epsilon to the denominator for numerical stability\n        chi_int_true = C_true / (T - Theta_true + 1e-9)\n        \n        chi_tot_int_true = chi_int_true + chi0\n        \n        # The denominator 1 + N*chi_tot_int_true can be zero or negative for large N and chi.\n        # This is physically plausible (e.g., instability), but for the sake of the problem,\n        # we assume the inputs are in a stable regime.\n        M_true = (chi_tot_int_true / (1.0 + N * chi_tot_int_true)) * H_app\n        \n        T_mean = np.mean(T)\n        delta_M = beta * H_app * (T - T_mean) / T_mean\n        \n        M_measured = M_true + delta_M\n        \n        # --- Data Reduction Pipeline ---\n\n        # Step 1: Compute apparent susceptibility\n        chi_app = M_measured / H_app\n\n        # Step 2: Correct for demagnetization\n        # Denominator can be close to zero if N*chi_app is near 1\n        chi_tot_int_corrected = chi_app / (1.0 - N * chi_app)\n        \n        # Step 3: Subtract temperature-independent background\n        chi_int_corrected = chi_tot_int_corrected - chi0\n        \n        # Step 4: Perform linear fit and extract parameters\n        inv_chi_int = 1.0 / chi_int_corrected\n        \n        # Perform ordinary least squares fit: y = a*x + b\n        # where y = inv_chi_int and x = T\n        # polyfit returns [a, b] for degree 1\n        a, b = np.polyfit(T, inv_chi_int, 1)\n        \n        # Calculate C and Theta from fit coefficients a and b\n        # a = 1/C  => C = 1/a\n        # b = -Theta/C => Theta = -b*C = -b/a\n        if a == 0:\n            # This case is highly unlikely with the given inputs\n            # but is handled for robustness.\n            C_fit = float('inf')\n            Theta_fit = float('nan')\n        else:\n            C_fit = 1.0 / a\n            Theta_fit = -b / a\n            \n        # Append rounded results to the list\n        results.append(f\"{C_fit:.6f}\")\n        results.append(f\"{Theta_fit:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2811974"}]}