{"hands_on_practices": [{"introduction": "The Kramers-Kronig relations are a direct consequence of causality, but seeing this connection through an explicit calculation is a crucial step in mastering the concept. This practice invites you to explore the Drude model, a cornerstone of solid-state physics describing electron transport in metals. By deriving the real and imaginary parts of the Drude conductivity and explicitly verifying that they satisfy the Kramers-Kronig integrals, you will build a concrete understanding of this profound physical-mathematical link [@problem_id:2998517].", "problem": "Consider a homogeneous, isotropic electron gas described within linear response by the causal retarded optical conductivity kernel. Adopt the Fourier transform convention in which the frequency-domain conductivity is given by the one-sided time transform of the causal time-domain response, so that analyticity holds in the upper half of the complex frequency plane. In the Drude model, the frequency-dependent conductivity is postulated to be\n$$\n\\sigma(\\omega)=\\frac{n e^{2}}{m}\\,\\frac{1}{\\gamma - i \\omega}\\,,\n$$\nwhere $n$ is the carrier density, $e$ is the elementary charge, $m$ is the effective mass, $\\gamma0$ is the scattering rate, and $\\omega \\in \\mathbb{R}$ is the real frequency.\n\nTasks:\n1. Compute the real and imaginary parts, $\\operatorname{Re}\\sigma(\\omega)$ and $\\operatorname{Im}\\sigma(\\omega)$, as explicit functions of $\\omega$, $n$, $e$, $m$, and $\\gamma$.\n2. Starting from causality and analyticity of the retarded response, derive the Kramers–Kronig (KK) relations that connect the real and imaginary parts of a generic retarded response function, and use them to verify explicitly that your results for $\\operatorname{Re}\\sigma(\\omega)$ and $\\operatorname{Im}\\sigma(\\omega)$ satisfy these relations. Your verification should evaluate the required principal value integrals.\n3. State the frequency integral of the real part over positive frequencies and briefly comment on its consistency with the optical $f$-sum rule, but do not use this in place of the explicit KK verification.\n\nProvide your final answer as the ordered pair $\\big(\\operatorname{Re}\\sigma(\\omega),\\,\\operatorname{Im}\\sigma(\\omega)\\big)$ in closed form. No numerical evaluation is required, and no units are to be included in the final answer.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. All provided information is consistent with the principles of linear response theory and condensed matter physics. The Drude model is a standard approximation, and its causal structure, characterized by a pole in the lower half-plane, makes it a suitable example for applying and verifying the Kramers-Kronig relations. The problem is a standard exercise in this field and contains no flaws.\n\nThe solution proceeds by addressing the three tasks sequentially.\n\n**1. Computation of Real and Imaginary Parts**\n\nThe frequency-dependent Drude conductivity is given as\n$$\n\\sigma(\\omega)=\\frac{n e^{2}}{m}\\,\\frac{1}{\\gamma - i \\omega}\n$$\nwhere $n$ is the carrier density, $e$ is the elementary charge, $m$ is the effective mass, $\\gamma  0$ is the scattering rate, and $\\omega$ is the real angular frequency. To find the real and imaginary parts, we multiply the numerator and denominator by the complex conjugate of the denominator, which is $\\gamma + i \\omega$.\n$$\n\\sigma(\\omega) = \\frac{n e^{2}}{m} \\frac{1}{\\gamma - i \\omega} \\frac{\\gamma + i \\omega}{\\gamma + i \\omega} = \\frac{n e^{2}}{m} \\frac{\\gamma + i \\omega}{\\gamma^{2} - (i\\omega)^{2}} = \\frac{n e^{2}}{m} \\frac{\\gamma + i \\omega}{\\gamma^{2} + \\omega^{2}}\n$$\nWe can now separate this expression into its real and imaginary components, denoted by $\\sigma_1(\\omega) = \\operatorname{Re}\\sigma(\\omega)$ and $\\sigma_2(\\omega) = \\operatorname{Im}\\sigma(\\omega)$ respectively.\n$$\n\\sigma(\\omega) = \\frac{n e^{2}}{m} \\left( \\frac{\\gamma}{\\gamma^{2} + \\omega^{2}} + i \\frac{\\omega}{\\gamma^{2} + \\omega^{2}} \\right)\n$$\nThus, the real and imaginary parts are:\n$$\n\\sigma_1(\\omega) = \\frac{n e^{2} \\gamma}{m(\\gamma^{2} + \\omega^{2})}\n$$\n$$\n\\sigma_2(\\omega) = \\frac{n e^{2} \\omega}{m(\\gamma^{2} + \\omega^{2})}\n$$\nNote that $\\sigma_1(\\omega)$ is an even function of $\\omega$, while $\\sigma_2(\\omega)$ is an odd function of $\\omega$. This is a general property of the real and imaginary parts of a response function corresponding to a real-valued response in the time domain, which manifests as $\\sigma(-\\omega) = \\sigma^*(\\omega)$.\n\n**2. Derivation and Verification of Kramers–Kronig Relations**\n\nThe problem states that the Fourier transform convention used implies that the response function $\\sigma(\\omega)$ is analytic in the upper half of the complex frequency plane. This is a direct consequence of causality, i.e., the time-domain response $\\sigma(t)$ is zero for $t  0$. The Drude conductivity $\\sigma(z) = \\frac{n e^{2}}{m} \\frac{1}{\\gamma - i z}$ has a single pole at $z = -i\\gamma$. Since $\\gamma  0$, this pole lies in the lower half-plane, consistent with the required analyticity in the upper half-plane. Additionally, for large $|z|$ in the upper half-plane, $|\\sigma(z)| \\to 0$.\n\nConsider the contour integral of $\\frac{\\sigma(z')}{z'-\\omega}$ over a closed contour $C$ in the upper half-plane, where $\\omega$ is a point on the real axis. The contour $C$ is composed of a line segment along the real axis from $-R$ to $R$, a small semicircular indentation of radius $\\epsilon$ into the upper half-plane to avoid the pole at $\\omega$, and a large semicircle $C_R$ of radius $R$ in the upper half-plane. Since $\\sigma(z')$ is analytic inside this contour, Cauchy's integral theorem states that the integral is zero:\n$$\n\\oint_C \\frac{\\sigma(z')}{z' - \\omega} dz' = 0\n$$\nThe integral can be broken into four parts:\n$$\n\\int_{-R}^{\\omega-\\epsilon} \\frac{\\sigma(\\omega')}{\\omega' - \\omega} d\\omega' + \\int_{\\omega+\\epsilon}^{R} \\frac{\\sigma(\\omega')}{\\omega' - \\omega} d\\omega' + \\int_{C_\\epsilon} \\frac{\\sigma(z')}{z' - \\omega} dz' + \\int_{C_R} \\frac{\\sigma(z')}{z' - \\omega} dz' = 0\n$$\nIn the limit $R \\to \\infty$, the integral over the large semicircle $C_R$ vanishes because $|\\sigma(z')| \\to 0$ as $|z'| \\to \\infty$. The integral over the small semicircle around the pole at $\\omega$ gives $-i\\pi\\sigma(\\omega)$. The two remaining integrals along the real axis combine to form the Cauchy principal value $\\mathcal{P}$ in the limit $\\epsilon \\to 0$.\nSo, we have:\n$$\n\\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\sigma(\\omega')}{\\omega' - \\omega} d\\omega' - i\\pi \\sigma(\\omega) = 0\n$$\nRearranging gives:\n$$\n\\sigma(\\omega) = \\frac{1}{i\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\sigma(\\omega')}{\\omega' - \\omega} d\\omega'\n$$\nSubstituting $\\sigma(\\omega) = \\sigma_1(\\omega) + i \\sigma_2(\\omega)$:\n$$\n\\sigma_1(\\omega) + i \\sigma_2(\\omega) = \\frac{1}{i\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\sigma_1(\\omega') + i \\sigma_2(\\omega')}{\\omega' - \\omega} d\\omega' = \\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\sigma_2(\\omega')}{\\omega' - \\omega} d\\omega' - \\frac{i}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\sigma_1(\\omega')}{\\omega' - \\omega} d\\omega'\n$$\nEquating the real and imaginary parts yields the Kramers-Kronig relations:\n$$\n\\sigma_1(\\omega) = \\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\sigma_2(\\omega')}{\\omega' - \\omega} d\\omega'\n$$\n$$\n\\sigma_2(\\omega) = -\\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\sigma_1(\\omega')}{\\omega' - \\omega} d\\omega'\n$$\nUsing the even/odd properties $\\sigma_1(-\\omega')=\\sigma_1(\\omega')$ and $\\sigma_2(-\\omega')=-\\sigma_2(\\omega')$, these can be rewritten as integrals over positive frequencies only:\n$$\n\\sigma_1(\\omega) = \\frac{2}{\\pi} \\mathcal{P} \\int_0^{\\infty} \\frac{\\omega' \\sigma_2(\\omega')}{\\omega'^2 - \\omega^2} d\\omega'\n$$\n$$\n\\sigma_2(\\omega) = -\\frac{2\\omega}{\\pi} \\mathcal{P} \\int_0^{\\infty} \\frac{\\sigma_1(\\omega')}{\\omega'^2 - \\omega^2} d\\omega'\n$$\nNow, we explicitly verify these relations for the Drude model.\n\nVerification of the first relation:\nLet's calculate the right-hand side using $\\sigma_2(\\omega') = \\frac{n e^{2} \\omega'}{m(\\gamma^{2} + \\omega'^{2})}$. For convenience, let $\\sigma_0 = \\frac{n e^2}{m}$.\n$$\n\\frac{2}{\\pi} \\mathcal{P} \\int_0^{\\infty} \\frac{\\omega'}{\\omega'^2 - \\omega^2} \\left( \\frac{\\sigma_0 \\omega'}{\\gamma^2 + \\omega'^2} \\right) d\\omega' = \\frac{2\\sigma_0}{\\pi} \\mathcal{P} \\int_0^{\\infty} \\frac{\\omega'^2}{(\\omega'^2 - \\omega^2)(\\gamma^2 + \\omega'^2)} d\\omega'\n$$\nUsing partial fraction decomposition on the integrand with respect to the variable $x = \\omega'^2$:\n$$\n\\frac{x}{(x - \\omega^2)(x + \\gamma^2)} = \\frac{A}{x - \\omega^2} + \\frac{B}{x + \\gamma^2} = \\frac{\\omega^2/(\\omega^2+\\gamma^2)}{x - \\omega^2} + \\frac{\\gamma^2/(\\omega^2+\\gamma^2)}{x + \\gamma^2}\n$$\nThe integral becomes:\n$$\n\\frac{2\\sigma_0}{\\pi(\\omega^2+\\gamma^2)} \\mathcal{P} \\int_0^{\\infty} \\left( \\frac{\\omega^2}{\\omega'^2-\\omega^2} + \\frac{\\gamma^2}{\\omega'^2+\\gamma^2} \\right) d\\omega'\n$$\nWe use the standard results: $\\mathcal{P} \\int_0^{\\infty} \\frac{d\\omega'}{\\omega'^2-a^2} = 0$ and $\\int_0^{\\infty} \\frac{d\\omega'}{\\omega'^2+b^2} = \\frac{\\pi}{2b}$.\n$$\n= \\frac{2\\sigma_0}{\\pi(\\omega^2+\\gamma^2)} \\left( \\omega^2 \\cdot 0 + \\gamma^2 \\cdot \\frac{\\pi}{2\\gamma} \\right) = \\frac{2\\sigma_0}{\\pi(\\omega^2+\\gamma^2)} \\frac{\\pi\\gamma}{2} = \\frac{\\sigma_0 \\gamma}{\\omega^2+\\gamma^2} = \\frac{n e^2 \\gamma}{m(\\gamma^2 + \\omega^2)}\n$$\nThis is precisely $\\sigma_1(\\omega)$, so the first relation is verified.\n\nVerification of the second relation:\nUsing $\\sigma_1(\\omega') = \\frac{\\sigma_0 \\gamma}{\\gamma^2 + \\omega'^2}$:\n$$\n-\\frac{2\\omega}{\\pi} \\mathcal{P} \\int_0^{\\infty} \\frac{1}{\\omega'^2 - \\omega^2} \\left( \\frac{\\sigma_0 \\gamma}{\\gamma^2 + \\omega'^2} \\right) d\\omega' = -\\frac{2\\omega \\sigma_0 \\gamma}{\\pi} \\mathcal{P} \\int_0^{\\infty} \\frac{d\\omega'}{(\\omega'^2 - \\omega^2)(\\gamma^2 + \\omega'^2)}\n$$\nUsing partial fractions for $x=\\omega'^2$: $\\frac{1}{(x-\\omega^2)(x+\\gamma^2)} = \\frac{1/(\\omega^2+\\gamma^2)}{x - \\omega^2} - \\frac{1/(\\omega^2+\\gamma^2)}{x + \\gamma^2}$.\nThe integral becomes:\n$$\n-\\frac{2\\omega \\sigma_0 \\gamma}{\\pi(\\omega^2+\\gamma^2)} \\mathcal{P} \\int_0^{\\infty} \\left( \\frac{1}{\\omega'^2-\\omega^2} - \\frac{1}{\\omega'^2+\\gamma^2} \\right) d\\omega'\n$$\nUsing the same standard integrals as before:\n$$\n= -\\frac{2\\omega \\sigma_0 \\gamma}{\\pi(\\omega^2+\\gamma^2)} \\left( 0 - \\frac{\\pi}{2\\gamma} \\right) = -\\frac{2\\omega \\sigma_0 \\gamma}{\\pi(\\omega^2+\\gamma^2)} \\left(-\\frac{\\pi}{2\\gamma}\\right) = \\frac{\\omega \\sigma_0}{\\omega^2+\\gamma^2} = \\frac{n e^2 \\omega}{m(\\gamma^2 + \\omega^2)}\n$$\nThis is precisely $\\sigma_2(\\omega)$, so the second relation is also verified.\n\n**3. Frequency Integral and the $f$-Sum Rule**\n\nThe frequency integral of the real part of the conductivity over positive frequencies is:\n$$\n\\int_0^\\infty \\sigma_1(\\omega) d\\omega = \\int_0^\\infty \\frac{n e^2 \\gamma}{m(\\gamma^2 + \\omega^2)} d\\omega = \\frac{n e^2 \\gamma}{m} \\int_0^\\infty \\frac{d\\omega}{\\gamma^2 + \\omega^2}\n$$\nThe integral is evaluated as:\n$$\n\\int_0^\\infty \\frac{d\\omega}{\\gamma^2 + \\omega^2} = \\left[ \\frac{1}{\\gamma} \\arctan\\left(\\frac{\\omega}{\\gamma}\\right) \\right]_0^\\infty = \\frac{1}{\\gamma} \\left( \\frac{\\pi}{2} - 0 \\right) = \\frac{\\pi}{2\\gamma}\n$$\nTherefore, the total integral is:\n$$\n\\int_0^\\infty \\sigma_1(\\omega) d\\omega = \\frac{n e^2 \\gamma}{m} \\left( \\frac{\\pi}{2\\gamma} \\right) = \\frac{\\pi n e^2}{2m}\n$$\nThis result is independent of the scattering rate $\\gamma$. This is a specific instance of the more general optical $f$-sum rule (or Thomas-Reiche-Kuhn sum rule for conductivity). The sum rule is a fundamental consequence of causality (via the Kramers-Kronig relations) and the fact that at very high frequencies, the electrons behave as a gas of free particles. The high-frequency limit of the conductivity is $\\sigma(\\omega) \\approx i n e^2 / (m\\omega)$, which determines the total spectral weight. Our explicit calculation for the Drude model yields a value consistent with this general principle, providing a check on the physical and mathematical correctness of the model.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{n e^{2} \\gamma}{m(\\gamma^{2} + \\omega^{2})}  \\frac{n e^{2} \\omega}{m(\\gamma^{2} + \\omega^{2})}\n\\end{pmatrix}\n}\n$$", "id": "2998517"}, {"introduction": "While the Drude model describes free carriers, many crucial optical phenomena arise from bound charges undergoing resonant absorption. This exercise focuses on the Lorentzian lineshape, the classic model for such a resonance, which you might encounter describing excitons, phonons, or atomic transitions. By calculating the Hilbert transform of a Lorentzian absorption peak, you will directly derive its associated dispersive lineshape and gain a hands-on feel for the phenomenon of anomalous dispersion [@problem_id:2833482].", "problem": "In materials physics, a single damped resonance often produces an absorptive line shape that is well approximated by a Lorentzian. Let $f(\\omega)$ denote such a line shape centered at angular frequency $\\omega_{0}$ with half-width at half-maximum $\\gamma0$:\n$$\nf(\\omega)=\\frac{\\gamma}{\\left(\\omega-\\omega_{0}\\right)^{2}+\\gamma^{2}}.\n$$\nDefine the Hilbert transform $\\mathcal{H}[f](\\omega)$ by\n$$\n\\mathcal{H}[f](\\omega)=\\frac{1}{\\pi}\\,\\operatorname{PV}\\int_{-\\infty}^{\\infty}\\frac{f(\\Omega)}{\\omega-\\Omega}\\,d\\Omega,\n$$\nwhere $\\operatorname{PV}$ denotes the Cauchy principal value. \n\nTask:\n1) Compute the closed-form expression of $\\mathcal{H}[f](\\omega)$ as a function of $\\omega$, $\\omega_{0}$, and $\\gamma$. Your final answer must be a single analytic expression.\n\n2) Briefly interpret your result in the context of Kramers–Kronig (KK) relations by explaining how the computed Hilbert transform encodes the dispersive component of a causal response near a single resonance. No numerical evaluation is required. The final answer must be the analytic expression from part (1).", "solution": "The problem requires the computation of the Hilbert transform of a Lorentzian function and its physical interpretation in the context of the Kramers-Kronig relations. The problem is well-posed and scientifically sound, representing a standard and fundamental calculation in a course on mathematical physics or solid-state theory. We shall proceed with a rigorous evaluation.\n\nThe task is to compute the Hilbert transform $\\mathcal{H}[f](\\omega)$ of the function $f(\\omega) = \\frac{\\gamma}{(\\omega-\\omega_{0})^{2}+\\gamma^{2}}$, which is defined as:\n$$\n\\mathcal{H}[f](\\omega)=\\frac{1}{\\pi}\\,\\operatorname{PV}\\int_{-\\infty}^{\\infty}\\frac{f(\\Omega)}{\\omega-\\Omega}\\,d\\Omega\n$$\nSubstituting the expression for $f(\\Omega)$, we must evaluate the Cauchy Principal Value ($\\operatorname{PV}$) of the following integral:\n$$\nI(\\omega) = \\operatorname{PV}\\int_{-\\infty}^{\\infty}\\frac{1}{\\omega-\\Omega} \\frac{\\gamma}{(\\Omega-\\omega_{0})^{2}+\\gamma^{2}}\\,d\\Omega\n$$\nThis integral is most efficiently computed using the techniques of complex analysis, specifically the residue theorem. We define the complex function $g(z)$:\n$$\ng(z) = \\frac{1}{\\omega-z} \\frac{\\gamma}{(z-\\omega_{0})^{2}+\\gamma^{2}}\n$$\nThe poles of $g(z)$ are the values of $z$ for which the denominator is zero.\n$1$. A simple pole on the real axis at $z = \\omega$.\n$2$. Poles from $(z-\\omega_{0})^{2}+\\gamma^{2} = 0$, which gives $z-\\omega_{0} = \\pm i\\gamma$. These are two simple poles at $z_{+} = \\omega_{0} + i\\gamma$ and $z_{-} = \\omega_{0} - i\\gamma$.\n\nSince $\\gamma  0$, the pole $z_{+}$ is in the upper half-plane, and the pole $z_{-}$ is in the lower half-plane.\n\nTo evaluate the principal value integral, we use a contour $C$ in the complex plane. The contour consists of a large semicircle $C_R$ of radius $R$ in the upper half-plane, and the real axis from $-R$ to $R$, with a small semicircular indentation $C_\\epsilon$ of radius $\\epsilon$ around the pole at $z=\\omega$, also in the upper half-plane. The contour is traversed in the counter-clockwise direction. The parts of the contour are:\n- $L_{1}$: from $-R$ to $\\omega - \\epsilon$.\n- $C_{\\epsilon}$: a semicircle from $\\omega - \\epsilon$ to $\\omega + \\epsilon$ in the upper half-plane, with parametrization $z = \\omega + \\epsilon e^{i\\theta}$ for $\\theta$ from $\\pi$ to $0$.\n- $L_{2}$: from $\\omega + \\epsilon$ to $R$.\n- $C_{R}$: a semicircle from $R$ to $-R$ in the upper half-plane, with parametrization $z = Re^{i\\theta}$ for $\\theta$ from $0$ to $\\pi$.\n\nBy the residue theorem, the integral over the closed contour $C = L_{1} \\cup C_{\\epsilon} \\cup L_{2} \\cup C_{R}$ is given by $2\\pi i$ times the sum of the residues of the poles enclosed within $C$. The only pole inside is $z_{+} = \\omega_{0} + i\\gamma$.\n$$\n\\oint_{C} g(z)\\,dz = 2\\pi i \\, \\operatorname{Res}(g(z), z=z_{+})\n$$\nThe residue at the simple pole $z_{+}$ is:\n$$\n\\operatorname{Res}(g(z), z=z_{+}) = \\lim_{z \\to z_{+}} (z-z_{+}) g(z) = \\lim_{z \\to z_{+}} \\frac{\\gamma}{(\\omega-z)(z-z_{-})} = \\frac{\\gamma}{(\\omega-z_{+})(z_{+}-z_{-})}\n$$\nSubstituting $z_{+} = \\omega_{0} + i\\gamma$ and $z_{-} = \\omega_{0} - i\\gamma$:\n$$\n\\operatorname{Res}(g(z), z=z_{+}) = \\frac{\\gamma}{(\\omega - (\\omega_{0} + i\\gamma))((\\omega_{0} + i\\gamma) - (\\omega_{0} - i\\gamma))} = \\frac{\\gamma}{(\\omega - \\omega_{0} - i\\gamma)(2i\\gamma)} = \\frac{1}{2i(\\omega - \\omega_{0} - i\\gamma)}\n$$\nThus, the contour integral is:\n$$\n\\oint_{C} g(z)\\,dz = 2\\pi i \\left( \\frac{1}{2i(\\omega - \\omega_{0} - i\\gamma)} \\right) = \\frac{\\pi}{\\omega - \\omega_{0} - i\\gamma}\n$$\nThe contour integral can also be written as the sum of integrals over its parts:\n$$\n\\oint_{C} g(z)\\,dz = \\int_{L_{1} \\cup L_{2}} g(z)\\,dz + \\int_{C_{\\epsilon}} g(z)\\,dz + \\int_{C_{R}} g(z)\\,dz\n$$\nWe evaluate each part in the limit $R \\to \\infty$ and $\\epsilon \\to 0$:\n- The integral over the large semicircle $C_R$ vanishes as $R \\to \\infty$, since $|g(z)|$ decays as $O(R^{-3})$. This is a standard result from Jordan's Lemma. $\\lim_{R \\to \\infty} \\int_{C_{R}} g(z)\\,dz = 0$.\n- The sum of integrals over $L_1$ and $L_2$ becomes the Cauchy Principal Value of the integral: $\\lim_{R \\to \\infty, \\epsilon \\to 0} \\int_{L_{1} \\cup L_{2}} g(x)\\,dx = \\operatorname{PV}\\int_{-\\infty}^{\\infty}g(x)\\,dx = I(\\omega)$.\n- The integral over the small semicircle $C_\\epsilon$ is given by $-i\\pi$ times the residue at the pole on the real axis, $z = \\omega$. The residue is:\n$$\n\\operatorname{Res}(g(z), z=\\omega) = \\lim_{z \\to \\omega} (z-\\omega) g(z) = \\lim_{z \\to \\omega} -\\frac{\\gamma}{(z-\\omega_{0})^{2}+\\gamma^{2}} = -\\frac{\\gamma}{(\\omega-\\omega_{0})^{2}+\\gamma^{2}} = -f(\\omega)\n$$\nTherefore, the integral over $C_\\epsilon$ is:\n$$\n\\int_{C_{\\epsilon}} g(z)\\,dz = -i\\pi\\,\\operatorname{Res}(g(z), z=\\omega) = -i\\pi(-f(\\omega)) = i\\pi f(\\omega)\n$$\nCombining these results:\n$$\n\\frac{\\pi}{\\omega - \\omega_{0} - i\\gamma} = I(\\omega) + i\\pi f(\\omega) + 0\n$$\nSolving for $I(\\omega)$:\n$$\nI(\\omega) = \\frac{\\pi}{\\omega - \\omega_{0} - i\\gamma} - i\\pi f(\\omega)\n$$\nWe rationalize the first term:\n$$\n\\frac{\\pi}{\\omega - \\omega_{0} - i\\gamma} = \\frac{\\pi(\\omega - \\omega_{0} + i\\gamma)}{(\\omega - \\omega_{0} - i\\gamma)(\\omega - \\omega_{0} + i\\gamma)} = \\frac{\\pi(\\omega - \\omega_{0}) + i\\pi\\gamma}{(\\omega-\\omega_{0})^{2}+\\gamma^{2}}\n$$\nRecognizing that $f(\\omega)=\\frac{\\gamma}{(\\omega-\\omega_{0})^{2}+\\gamma^{2}}$, we have:\n$$\n\\frac{\\pi}{\\omega - \\omega_{0} - i\\gamma} = \\frac{\\pi(\\omega - \\omega_{0})}{(\\omega-\\omega_{0})^{2}+\\gamma^{2}} + i\\pi f(\\omega)\n$$\nSubstituting this back into the expression for $I(\\omega)$:\n$$\nI(\\omega) = \\left( \\frac{\\pi(\\omega - \\omega_{0})}{(\\omega-\\omega_{0})^{2}+\\gamma^{2}} + i\\pi f(\\omega) \\right) - i\\pi f(\\omega) = \\frac{\\pi(\\omega - \\omega_{0})}{(\\omega-\\omega_{0})^{2}+\\gamma^{2}}\n$$\nFinally, the Hilbert transform is $\\mathcal{H}[f](\\omega) = \\frac{1}{\\pi} I(\\omega)$:\n$$\n\\mathcal{H}[f](\\omega) = \\frac{1}{\\pi} \\left( \\frac{\\pi(\\omega - \\omega_{0})}{(\\omega-\\omega_{0})^{2}+\\gamma^{2}} \\right) = \\frac{\\omega - \\omega_{0}}{(\\omega-\\omega_{0})^{2}+\\gamma^{2}}\n$$\n\nFor the second part of the task, we provide a physical interpretation. In linear response theory, a system's behavior is described by a complex susceptibility, $\\chi(\\omega) = \\chi'(\\omega) + i\\chi''(\\omega)$. The imaginary part, $\\chi''(\\omega)$, represents energy absorption, while the real part, $\\chi'(\\omega)$, describes the dispersive response (related to the refractive index).\n\nCausality dictates that $\\chi(\\omega)$ must be analytic in the upper complex frequency plane. This leads to the Kramers-Kronig (KK) relations, which connect the real and imaginary parts. Specifically, the real part is determined by the imaginary part via:\n$$ \\chi'(\\omega) = \\frac{1}{\\pi}\\operatorname{PV}\\int_{-\\infty}^{\\infty}\\frac{\\chi''(\\Omega)}{\\Omega-\\omega}\\,d\\Omega $$\nThe problem defines the Hilbert transform as $\\mathcal{H}[f](\\omega) = \\frac{1}{\\pi}\\operatorname{PV}\\int_{-\\infty}^{\\infty}\\frac{f(\\Omega)}{\\omega-\\Omega}\\,d\\Omega$. Comparing these two definitions, we see that the KK relation can be expressed as $\\chi'(\\omega) = -\\mathcal{H}[\\chi''](\\omega)$.\n\nIn our problem, the absorptive part $\\chi''(\\omega)$ is modeled by the Lorentzian lineshape $f(\\omega)$. Our calculation yielded the Hilbert transform:\n$$ \\mathcal{H}[f](\\omega) = \\frac{\\omega - \\omega_{0}}{(\\omega-\\omega_{0})^{2}+\\gamma^{2}} $$\nTherefore, the corresponding physical dispersive part, $\\chi'(\\omega)$, must be proportional to $-\\mathcal{H}[f](\\omega)$:\n$$ \\chi'(\\omega) \\propto -\\mathcal{H}[f](\\omega) = -\\frac{\\omega - \\omega_{0}}{(\\omega - \\omega_{0})^{2} + \\gamma^{2}} = \\frac{\\omega_{0} - \\omega}{(\\omega - \\omega_{0})^{2} + \\gamma^{2}} $$\nThis function describes the phenomenon of \"anomalous dispersion\" near the resonance frequency $\\omega_{0}$. It is positive for frequencies below resonance ($\\omega  \\omega_{0}$), passes through zero exactly at resonance ($\\omega = \\omega_{0}$), and becomes negative for frequencies above resonance ($\\omega  \\omega_{0}$). This characteristic 'wiggle' of the refractive index in the vicinity of an absorption line is a cornerstone of optics, and our calculation shows how it emerges directly from causality.", "answer": "$$\n\\boxed{\\frac{\\omega - \\omega_{0}}{(\\omega - \\omega_{0})^{2} + \\gamma^{2}}}\n$$", "id": "2833482"}, {"introduction": "Theoretical models provide continuous functions, but experimental data and computational analysis are inherently discrete. This practice bridges that gap by tackling the numerical implementation of the Kramers-Kronig transform, a vital skill for any experimental spectroscopist or computational materials scientist. You will develop a stable quadrature scheme by discretizing the principal value integral, learning how the mathematical singularity can be handled analytically to create a robust algorithm [@problem_id:2833503].", "problem": "A scalar, causal linear response function $\\chi(\\omega)$ of a homogeneous material is analytic in the upper half of the complex frequency plane and satisfies the Kramers–Kronig relations. Assume that $\\chi(\\omega)$ approaches a finite high-frequency limit $\\chi_{\\infty}$ and that the imaginary part $\\chi''(\\omega)$ is negligible beyond a finite cutoff $\\Omega_{\\max}$. Under these conditions and causality, the real part $\\chi'(\\omega)$ is related to $\\chi''(\\omega)$ by a Cauchy principal value integral over $[0,\\Omega_{\\max}]$.\n\nYou uniformly sample $\\chi''(\\omega)$ on a midpoint frequency grid over $[0,\\Omega_{\\max}]$ with spacing $\\Delta = \\Omega_{\\max}/M$ for a positive integer $M$, at midpoints $\\omega_{m} = \\left(m+\\tfrac{1}{2}\\right)\\Delta$ for $m=0,1,\\dots,M-1$. You will approximate $\\chi''(\\omega)$ as piecewise constant on each bin $[m\\Delta,(m+1)\\Delta]$ with value $\\chi''(\\omega_{m})$ and evaluate the contribution of each bin exactly by integrating the kernel of the principal value integral over that bin.\n\nStarting from the causality-based frequency-domain Kramers–Kronig relation that expresses $\\chi'(\\omega)$ in terms of $\\chi''(\\omega)$ via a principal value integral on $[0,\\infty)$, restrict the integral to $[0,\\Omega_{\\max}]$ under the stated assumption and derive a stable quadrature that treats the singular kernel exactly on the uniform midpoint grid. In particular, for a target frequency $\\omega_{n}=\\left(n+\\tfrac{1}{2}\\right)\\Delta$ with $n\\in\\{0,1,\\dots,M-1\\}$, show that the approximation can be written in the form\n$$\n\\chi'(\\omega_{n}) \\approx \\chi_{\\infty} + \\sum_{m=0}^{M-1} W_{nm}\\,\\chi''(\\omega_{m}),\n$$\nwhere $W_{nm}$ are bin-integrated kernel weights that remain finite for all $m,n$ and correctly implement the principal value at $\\omega'=\\omega_{n}$.\n\nWhat is the closed-form expression for the weight $W_{nm}$ on this uniform midpoint grid, expressed only in terms of integers $m,n$ and universal constants? Provide your answer as a single analytic expression. No rounding is required, and no units are needed for $W_{nm}$ because it is dimensionless.", "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information for a unique solution. It describes a standard and non-trivial numerical method for evaluating Kramers-Kronig transforms. I will proceed with the derivation.\n\nThe analysis begins with the Kramers-Kronig relation for a causal linear response function $\\chi(\\omega)$ that approaches a constant, real value $\\chi_{\\infty}$ at high frequencies. This relation connects the real part, $\\chi'(\\omega)$, to the imaginary part, $\\chi''(\\omega)$, and is derived from Cauchy's integral theorem applied to the function $\\chi(z) - \\chi_{\\infty}$ in the upper half of the complex frequency plane. For a real-valued response in the time domain, $\\chi(t)$, the frequency-domain response satisfies $\\chi(-\\omega) = \\chi^*(\\omega)$, which implies that $\\chi'(\\omega)$ is an even function of frequency and $\\chi''(\\omega)$ is an odd function. This symmetry allows the integral over $(-\\infty, \\infty)$ to be folded onto $[0, \\infty)$. The correct relation is:\n$$\n\\chi'(\\omega) = \\chi_{\\infty} + \\frac{2}{\\pi} \\mathcal{P} \\int_{0}^{\\infty} \\frac{\\omega'\\chi''(\\omega')}{(\\omega')^2 - \\omega^2} d\\omega'\n$$\nwhere $\\mathcal{P}$ denotes the Cauchy principal value.\n\nThe problem states that $\\chi''(\\omega)$ is negligible for $\\omega  \\Omega_{\\max}$. We may therefore truncate the integral at $\\Omega_{\\max}$:\n$$\n\\chi'(\\omega) \\approx \\chi_{\\infty} + \\frac{2}{\\pi} \\mathcal{P} \\int_{0}^{\\Omega_{\\max}} \\frac{\\omega'\\chi''(\\omega')}{(\\omega')^2 - \\omega^2} d\\omega'\n$$\nWe are asked to evaluate this integral at the discrete target frequencies $\\omega_{n} = \\left(n+\\tfrac{1}{2}\\right)\\Delta$, where $\\Delta = \\Omega_{\\max}/M$ and $n \\in \\{0, 1, \\dots, M-1\\}$. The function $\\chi''(\\omega')$ is approximated as a piecewise constant function. On each interval $[m\\Delta, (m+1)\\Delta]$, its value is taken to be constant and equal to its value at the midpoint, $\\chi''(\\omega_m)$, where $\\omega_{m} = \\left(m+\\tfrac{1}{2}\\right)\\Delta$.\n\nSubstituting this piecewise approximation into the integral, we transform the integral into a summation over the $M$ bins:\n$$\n\\chi'(\\omega_{n}) \\approx \\chi_{\\infty} + \\sum_{m=0}^{M-1} \\chi''(\\omega_{m}) \\left( \\frac{2}{\\pi} \\mathcal{P} \\int_{m\\Delta}^{(m+1)\\Delta} \\frac{\\omega'}{(\\omega')^2 - \\omega_n^2} d\\omega' \\right)\n$$\nThis expression matches the desired form, $\\chi'(\\omega_{n}) \\approx \\chi_{\\infty} + \\sum_{m=0}^{M-1} W_{nm}\\,\\chi''(\\omega_{m})$, where the quadrature weights $W_{nm}$ are given by the integral:\n$$\nW_{nm} = \\frac{2}{\\pi} \\mathcal{P} \\int_{m\\Delta}^{(m+1)\\Delta} \\frac{\\omega'}{(\\omega')^2 - \\omega_n^2} d\\omega'\n$$\nThe antiderivative of the integrand is found by a simple substitution, $u = (\\omega')^2 - \\omega_n^2$, $du = 2\\omega'd\\omega'$:\n$$\n\\int \\frac{2\\omega'}{(\\omega')^2 - \\omega_n^2} d\\omega' = \\ln|(\\omega')^2 - \\omega_n^2|\n$$\nThus, the weight is given by:\n$$\nW_{nm} = \\frac{1}{\\pi} \\mathcal{P} \\left[ \\ln|(\\omega')^2 - \\omega_n^2| \\right]_{m\\Delta}^{(m+1)\\Delta}\n$$\nWe must evaluate this expression for two distinct cases.\n\nCase 1: $m \\neq n$.\nIn this case, the target frequency $\\omega_n$ is not within the integration interval $[m\\Delta, (m+1)\\Delta]$, because the midpoints $\\omega_k$ are unique to their respective intervals. The integrand is non-singular over the interval, so the principal value operator $\\mathcal{P}$ is superfluous.\n$$\nW_{nm} = \\frac{1}{\\pi} \\left( \\ln|((m+1)\\Delta)^2 - \\omega_n^2| - \\ln|(m\\Delta)^2 - \\omega_n^2| \\right) = \\frac{1}{\\pi} \\ln \\left| \\frac{((m+1)\\Delta)^2 - \\omega_n^2}{(m\\Delta)^2 - \\omega_n^2} \\right|\n$$\n\nCase 2: $m = n$.\nHere, the singularity at $\\omega' = \\omega_n$ lies within the integration interval $[n\\Delta, (n+1)\\Delta]$. In fact, it is located precisely at the midpoint of the interval. We must evaluate the integral using the definition of the Cauchy principal value:\n$$\nW_{nn} = \\frac{1}{\\pi} \\lim_{\\epsilon \\to 0^+} \\left( \\int_{n\\Delta}^{\\omega_n - \\epsilon} \\frac{2\\omega'd\\omega'}{(\\omega')^2 - \\omega_n^2} + \\int_{\\omega_n + \\epsilon}^{(n+1)\\Delta} \\frac{2\\omega'd\\omega'}{(\\omega')^2 - \\omega_n^2} \\right)\n$$\nUsing the antiderivative:\n$$\nW_{nn} = \\frac{1}{\\pi} \\lim_{\\epsilon \\to 0^+} \\left( \\left[\\ln|(\\omega')^2 - \\omega_n^2|\\right]_{n\\Delta}^{\\omega_n-\\epsilon} + \\left[\\ln|(\\omega')^2 - \\omega_n^2|\\right]_{\\omega_n+\\epsilon}^{(n+1)\\Delta} \\right)\n$$\n$$\nW_{nn} = \\frac{1}{\\pi} \\lim_{\\epsilon \\to 0^+} \\left( \\ln|(\\omega_n-\\epsilon)^2 - \\omega_n^2| - \\ln|(n\\Delta)^2 - \\omega_n^2| + \\ln|((n+1)\\Delta)^2 - \\omega_n^2| - \\ln|(\\omega_n+\\epsilon)^2 - \\omega_n^2| \\right)\n$$\nThe terms involving $\\epsilon$ are:\n$$\n\\lim_{\\epsilon \\to 0^+} \\left( \\ln|(\\omega_n-\\epsilon)^2 - \\omega_n^2| - \\ln|(\\omega_n+\\epsilon)^2 - \\omega_n^2| \\right) = \\lim_{\\epsilon \\to 0^+} \\left( \\ln|-2\\epsilon\\omega_n + \\epsilon^2| - \\ln|2\\epsilon\\omega_n + \\epsilon^2| \\right)\n$$\nFor small positive $\\epsilon$, this becomes:\n$$\n\\lim_{\\epsilon \\to 0^+} \\left( \\ln(2\\epsilon\\omega_n - \\epsilon^2) - \\ln(2\\epsilon\\omega_n + \\epsilon^2) \\right) = \\lim_{\\epsilon \\to 0^+} \\ln\\left(\\frac{2\\epsilon\\omega_n - \\epsilon^2}{2\\epsilon\\omega_n + \\epsilon^2}\\right) = \\lim_{\\epsilon \\to 0^+} \\ln\\left(\\frac{2\\omega_n - \\epsilon}{2\\omega_n + \\epsilon}\\right) = \\ln(1) = 0\n$$\nThe singular contributions exactly cancel. Therefore, the expression for $W_{nn}$ is formally identical to the one for $W_{nm}$ with $m=n$:\n$$\nW_{nn} = \\frac{1}{\\pi} \\ln \\left| \\frac{((n+1)\\Delta)^2 - \\omega_n^2}{(n\\Delta)^2 - \\omega_n^2} \\right|\n$$\nSince the expression is the same for both cases, we can write a single, unified formula for $W_{nm}$. We substitute the definitions $\\omega_n = (n+\\tfrac{1}{2})\\Delta$ and cancel the common factor of $\\Delta^2$:\n$$\nW_{nm} = \\frac{1}{\\pi} \\ln \\left| \\frac{(m+1)^2 - (n+\\tfrac{1}{2})^2}{m^2 - (n+\\tfrac{1}{2})^2} \\right|\n$$\nTo obtain the final expression in terms of integers, we use the difference of squares formula, $a^2 - b^2 = (a-b)(a+b)$:\nNumerator: $((m+1) - (n+\\tfrac{1}{2}))((m+1) + (n+\\tfrac{1}{2})) = (m-n+\\tfrac{1}{2})(m+n+\\tfrac{3}{2})$\nDenominator: $(m-(n+\\tfrac{1}{2}))(m+(n+\\tfrac{1}{2})) = (m-n-\\tfrac{1}{2})(m+n+\\tfrac{1}{2})$\nSo,\n$$\nW_{nm} = \\frac{1}{\\pi} \\ln \\left| \\frac{(m-n+\\tfrac{1}{2})(m+n+\\tfrac{3}{2})}{(m-n-\\tfrac{1}{2})(m+n+\\tfrac{1}{2})} \\right|\n$$\nMultiplying the numerator and denominator inside the absolute value by $4$ to eliminate fractions gives the final, clean expression:\n$$\nW_{nm} = \\frac{1}{\\pi} \\ln \\left| \\frac{(2(m-n+\\tfrac{1}{2})) (2(m+n+\\tfrac{3}{2}))}{(2(m-n-\\tfrac{1}{2})) (2(m+n+\\tfrac{1}{2}))} \\right| = \\frac{1}{\\pi} \\ln \\left| \\frac{(2m-2n+1)(2m+2n+3)}{(2m-2n-1)(2m+2n+1)} \\right|\n$$\nThis expression is the closed-form representation of the quadrature weight $W_{nm}$ and is valid for all $m,n \\in \\{0, 1, \\dots, M-1\\}$.", "answer": "$$\n\\boxed{\\frac{1}{\\pi} \\ln \\left| \\frac{(2m-2n+1)(2m+2n+3)}{(2m-2n-1)(2m+2n+1)} \\right|}\n$$", "id": "2833503"}]}