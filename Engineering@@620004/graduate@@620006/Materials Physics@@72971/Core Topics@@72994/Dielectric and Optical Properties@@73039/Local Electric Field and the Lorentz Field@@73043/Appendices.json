{"hands_on_practices": [{"introduction": "The familiar result for the Lorentz field, $E_L = P/(3\\epsilon_0)$, holds for materials with cubic lattice symmetry. This practice delves into what happens when this symmetry is broken by examining a tetragonal lattice. By directly summing the electric fields from nearest-neighbor dipoles, you will discover that the local field's magnitude depends on its orientation relative to the crystal axes, a phenomenon known as anisotropy [@problem_id:1818305]. This exercise provides a crucial, microscopic understanding of why dielectric properties are described by tensors in non-cubic materials.", "problem": "A hypothetical dielectric crystal is composed of atoms arranged on a simple tetragonal lattice, characterized by lattice constants $a=b$ and $c$, where $a \\neq c$. When an external electric field is applied, each atom develops an induced dipole moment $\\vec{p}$, which is aligned with the local electric field at its position.\n\nThe local electric field at any given atom is the sum of the external field and the field produced by the dipoles of all other atoms in the crystal. To analyze the contribution from the surrounding dipoles, we focus on the field generated by the nearest neighbors of an atom located at the origin $(0,0,0)$. For a simple tetragonal lattice, these nearest neighbors are located at the six positions: $(\\pm a, 0, 0)$, $(0, \\pm a, 0)$, and $(0, 0, \\pm c)$.\n\nWe will investigate how the orientation of the induced dipoles affects this nearest-neighbor field contribution, which we denote as $\\vec{E}_{nn}$.\n\nConsider two distinct scenarios:\n1.  All atoms in the crystal have a dipole moment $\\vec{p} = p\\hat{k}$, where $p$ is a constant magnitude and $\\hat{k}$ is the unit vector along the z-axis (parallel to the c-axis). Let $(E_{nn})_z$ be the component of the nearest-neighbor field $\\vec{E}_{nn}$ along the z-axis at the origin.\n2.  All atoms in the crystal have a dipole moment $\\vec{p} = p\\hat{i}$, where $\\hat{i}$ is the unit vector along the x-axis (parallel to one of the a-axes). Let $(E_{nn})_x$ be the component of the nearest-neighbor field $\\vec{E}_{nn}$ along the x-axis at the origin.\n\nCalculate the difference $(E_{nn})_z - (E_{nn})_x$. Express your final answer as an analytic expression in terms of the dipole moment magnitude $p$, the lattice constants $a$ and $c$, and the permittivity of free space $\\epsilon_0$.", "solution": "The electric field $\\vec{E}$ produced by a point dipole $\\vec{p}$ at a position given by the vector $\\vec{r}$ from the dipole is:\n$$ \\vec{E}(\\vec{r}) = \\frac{1}{4\\pi\\epsilon_0} \\left( \\frac{3(\\vec{p} \\cdot \\vec{r})\\vec{r}}{r^5} - \\frac{\\vec{p}}{r^3} \\right) $$\nThe field $\\vec{E}_{nn}$ at the origin is the vector sum of the fields from the six nearest neighbors.\n\n**Step 1: Calculate $(E_{nn})_z$ for Scenario 1**\n\nIn this scenario, all dipoles are $\\vec{p} = p\\hat{k}$. We need to find the z-component of the total field at the origin, $(E_{nn})_z = \\vec{E}_{nn} \\cdot \\hat{k}$.\n\nThe six nearest neighbors are at:\n- Two neighbors at $\\vec{r}_{1,2} = \\pm a\\hat{i}$. For these, $r=a$ and $\\vec{p} \\cdot \\vec{r} = (p\\hat{k}) \\cdot (\\pm a\\hat{i}) = 0$.\nThe field from each of these two dipoles is $\\vec{E}_{1,2} = \\frac{1}{4\\pi\\epsilon_0} (0 - \\frac{p\\hat{k}}{a^3})$. The z-component is $-\\frac{p}{4\\pi\\epsilon_0 a^3}$.\n- Two neighbors at $\\vec{r}_{3,4} = \\pm a\\hat{j}$. For these, $r=a$ and $\\vec{p} \\cdot \\vec{r} = (p\\hat{k}) \\cdot (\\pm a\\hat{j}) = 0$.\nThe field from each is $\\vec{E}_{3,4} = \\frac{1}{4\\pi\\epsilon_0} (0 - \\frac{p\\hat{k}}{a^3})$. The z-component is $-\\frac{p}{4\\pi\\epsilon_0 a^3}$.\n- Two neighbors at $\\vec{r}_{5,6} = \\pm c\\hat{k}$. For these, $r=c$. For $\\vec{r}_5 = c\\hat{k}$, $\\vec{p} \\cdot \\vec{r}_5 = (p\\hat{k}) \\cdot (c\\hat{k}) = pc$.\nThe field from this dipole is $\\vec{E}_5 = \\frac{1}{4\\pi\\epsilon_0} (\\frac{3(pc)(c\\hat{k})}{c^5} - \\frac{p\\hat{k}}{c^3}) = \\frac{p}{4\\pi\\epsilon_0 c^3}(3\\hat{k} - \\hat{k}) = \\frac{2p}{4\\pi\\epsilon_0 c^3}\\hat{k}$.\nThe z-component is $\\frac{2p}{4\\pi\\epsilon_0 c^3}$.\nFor $\\vec{r}_6 = -c\\hat{k}$, $\\vec{p} \\cdot \\vec{r}_6 = (p\\hat{k}) \\cdot (-c\\hat{k}) = -pc$.\nThe field is $\\vec{E}_6 = \\frac{1}{4\\pi\\epsilon_0} (\\frac{3(-pc)(-c\\hat{k})}{c^5} - \\frac{p\\hat{k}}{c^3}) = \\frac{p}{4\\pi\\epsilon_0 c^3}(3\\hat{k} - \\hat{k}) = \\frac{2p}{4\\pi\\epsilon_0 c^3}\\hat{k}$.\nThe z-component is also $\\frac{2p}{4\\pi\\epsilon_0 c^3}$.\n\nSumming the z-components from all six neighbors:\n$$ (E_{nn})_z = 2 \\left( -\\frac{p}{4\\pi\\epsilon_0 a^3} \\right) + 2 \\left( -\\frac{p}{4\\pi\\epsilon_0 a^3} \\right) + 2 \\left( \\frac{2p}{4\\pi\\epsilon_0 c^3} \\right) $$\n$$ (E_{nn})_z = \\frac{p}{4\\pi\\epsilon_0} \\left( -\\frac{4}{a^3} + \\frac{4}{c^3} \\right) = \\frac{p}{\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) $$\n\n**Step 2: Calculate $(E_{nn})_x$ for Scenario 2**\n\nIn this scenario, all dipoles are $\\vec{p} = p\\hat{i}$. We need to find the x-component of the total field, $(E_{nn})_x = \\vec{E}_{nn} \\cdot \\hat{i}$.\n\n- Two neighbors at $\\vec{r}_{1,2} = \\pm a\\hat{i}$. For these, $r=a$. For $\\vec{r}_1=a\\hat{i}$, $\\vec{p}\\cdot\\vec{r}_1 = (p\\hat{i})\\cdot(a\\hat{i}) = pa$.\nThe field from this dipole is $\\vec{E}_1 = \\frac{1}{4\\pi\\epsilon_0} (\\frac{3(pa)(a\\hat{i})}{a^5} - \\frac{p\\hat{i}}{a^3}) = \\frac{2p}{4\\pi\\epsilon_0 a^3}\\hat{i}$. The x-component is $\\frac{2p}{4\\pi\\epsilon_0 a^3}$. By symmetry, the dipole at $\\vec{r}_2=-a\\hat{i}$ gives the same field.\n- Two neighbors at $\\vec{r}_{3,4} = \\pm a\\hat{j}$. For these, $r=a$ and $\\vec{p} \\cdot \\vec{r} = (p\\hat{i}) \\cdot (\\pm a\\hat{j}) = 0$.\nThe field from each is $\\vec{E}_{3,4} = \\frac{1}{4\\pi\\epsilon_0} (0 - \\frac{p\\hat{i}}{a^3})$. The x-component is $-\\frac{p}{4\\pi\\epsilon_0 a^3}$.\n- Two neighbors at $\\vec{r}_{5,6} = \\pm c\\hat{k}$. For these, $r=c$ and $\\vec{p} \\cdot \\vec{r} = (p\\hat{i}) \\cdot (\\pm c\\hat{k}) = 0$.\nThe field from each is $\\vec{E}_{5,6} = \\frac{1}{4\\pi\\epsilon_0} (0 - \\frac{p\\hat{i}}{c^3})$. The x-component is $-\\frac{p}{4\\pi\\epsilon_0 c^3}$.\n\nSumming the x-components from all six neighbors:\n$$ (E_{nn})_x = 2 \\left( \\frac{2p}{4\\pi\\epsilon_0 a^3} \\right) + 2 \\left( -\\frac{p}{4\\pi\\epsilon_0 a^3} \\right) + 2 \\left( -\\frac{p}{4\\pi\\epsilon_0 c^3} \\right) $$\n$$ (E_{nn})_x = \\frac{p}{4\\pi\\epsilon_0} \\left( \\frac{4}{a^3} - \\frac{2}{a^3} - \\frac{2}{c^3} \\right) = \\frac{p}{4\\pi\\epsilon_0} \\left( \\frac{2}{a^3} - \\frac{2}{c^3} \\right) = \\frac{p}{2\\pi\\epsilon_0} \\left( \\frac{1}{a^3} - \\frac{1}{c^3} \\right) $$\n\n**Step 3: Calculate the difference $(E_{nn})_z - (E_{nn})_x$**\n\nNow we subtract the expression for $(E_{nn})_x$ from the expression for $(E_{nn})_z$:\n$$ (E_{nn})_z - (E_{nn})_x = \\frac{p}{\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) - \\frac{p}{2\\pi\\epsilon_0} \\left( \\frac{1}{a^3} - \\frac{1}{c^3} \\right) $$\nTo combine these terms, let's factor out $\\frac{p}{2\\pi\\epsilon_0}$ and rewrite the second term:\n$$ (E_{nn})_z - (E_{nn})_x = \\frac{p}{\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) + \\frac{p}{2\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) $$\n$$ (E_{nn})_z - (E_{nn})_x = \\frac{p}{2\\pi\\epsilon_0} \\left[ 2\\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) + \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) \\right] $$\n$$ (E_{nn})_z - (E_{nn})_x = \\frac{p}{2\\pi\\epsilon_0} \\left[ 3\\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) \\right] $$\n$$ (E_{nn})_z - (E_{nn})_x = \\frac{3p}{2\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right) $$\nThis result shows that the internal field contribution is anisotropic (i.e., it depends on direction), and this anisotropy vanishes only if $a=c$, which corresponds to the cubic lattice case.", "answer": "$$\\boxed{\\frac{3p}{2\\pi\\epsilon_0} \\left( \\frac{1}{c^3} - \\frac{1}{a^3} \\right)}$$", "id": "1818305"}, {"introduction": "The Lorentz field model is predicated on a conceptual tool: a fictitious spherical cavity within a uniformly polarized continuum. This exercise challenges you to contrast this theoretical model with a physically realizable scenario—an actual spherical void within a dielectric material [@problem_id:2836885]. By solving the electrostatic boundary-value problem for the void and comparing it to the Lorentz field, you will develop a more nuanced understanding of the model's assumptions and a deeper appreciation for the power of exact electrostatic solutions.", "problem": "An infinite, homogeneous, linear, isotropic dielectric of relative permittivity $\\varepsilon_{r}$ contains a spherical void (vacuum) of radius $a$. Far from the void, the macroscopic electric field inside the dielectric is uniform, of magnitude $E$, and directed along the $z$-axis. Assume electrostatics (no time dependence), no free charges in the bulk, and that the void is sufficiently small that edge effects from any remote boundaries are negligible.\n\nStarting only from Maxwell’s equations in electrostatics, the constitutive relation $\\mathbf{D}=\\varepsilon \\mathbf{E}$ in a linear dielectric, and the standard boundary conditions at a dielectric interface, perform the following:\n\n- Determine the exact electric field at the center of the spherical void by solving the appropriate boundary value problem for the scalar potential in the two regions (vacuum inside the void and dielectric outside).\n- Independently, define the Lorentz cavity field at the cavity center as the sum of the macroscopic field and the field generated at the center by the bound surface charge that would reside on the surface of a spherical cavity carved out of a uniformly polarized dielectric. Compute this Lorentz cavity field using the polarization of the surrounding dielectric.\n\nLet $\\varepsilon=\\varepsilon_{0}\\varepsilon_{r}$ be the permittivity of the dielectric, where $\\varepsilon_{0}$ is the vacuum permittivity. Report, as a single closed-form analytic expression in $\\varepsilon_{r}$, the ratio\n$$\nR(\\varepsilon_{r})=\\frac{E_{\\text{void}}}{E_{\\text{L}}},\n$$\nwhere $E_{\\text{void}}$ is the magnitude of the exact electric field at the center of the void and $E_{\\text{L}}$ is the magnitude of the Lorentz cavity field at that point. The final answer is unitless and requires no rounding.", "solution": "The problem requires two separate calculations: the exact field in the void, $E_{\\text{void}}$, and the Lorentz cavity field, $E_{\\text{L}}$.\n\n#### Part 1: Calculation of the Exact Electric Field ($E_{\\text{void}}$)\n\nWe solve for the electrostatic potential $\\Phi$ in two regions: inside the void (region $1$: $r < a$) and outside in the dielectric (region $2$: $r > a$). Since there are no free charges, the potential satisfies Laplace's equation, $\\nabla^{2}\\Phi = 0$, in both regions. Due to the axial symmetry imposed by the external field along the $z$-axis, we use spherical coordinates $(r, \\theta, \\phi)$ and look for solutions independent of $\\phi$.\n\nThe general solution to Laplace's equation with azimuthal symmetry is a series of Legendre polynomials $P_{l}(\\cos\\theta)$:\n$$ \\Phi(r, \\theta) = \\sum_{l=0}^{\\infty} (A_{l}r^{l} + B_{l}r^{-(l+1)}) P_{l}(\\cos\\theta) $$\n\n**Region 1: Inside the void ($r < a$)**\nThe potential $\\Phi_{1}$ must be finite at the origin ($r=0$). This requires that all coefficients $B_{l}$ be zero.\n$$ \\Phi_{1}(r, \\theta) = \\sum_{l=0}^{\\infty} A_{l}r^{l} P_{l}(\\cos\\theta) $$\n\n**Region 2: Outside in the dielectric ($r > a$)**\nFar from the void ($r \\to \\infty$), the potential $\\Phi_{2}$ must correspond to the uniform macroscopic field $\\mathbf{E} = E\\hat{\\mathbf{z}}$. The potential for this field is $\\Phi_{\\infty} = -Ez = -Er\\cos\\theta = -ErP_{1}(\\cos\\theta)$. The potential due to the presence of the void must vanish at infinity. Thus, the solution has the form:\n$$ \\Phi_{2}(r, \\theta) = -Er\\cos\\theta + \\sum_{l=0}^{\\infty} B_{l}r^{-(l+1)} P_{l}(\\cos\\theta) $$\n\nWe apply boundary conditions at the surface of the sphere, $r=a$:\n1.  Continuity of the potential: $\\Phi_{1}(a, \\theta) = \\Phi_{2}(a, \\theta)$.\n    $$ \\sum_{l=0}^{\\infty} A_{l}a^{l} P_{l}(\\cos\\theta) = -EaP_{1}(\\cos\\theta) + \\sum_{l=0}^{\\infty} B_{l}a^{-(l+1)} P_{l}(\\cos\\theta) $$\n    By orthogonality of Legendre polynomials, we can equate coefficients for each $l$:\n    $$ A_{l}a^{l} = -Ea\\delta_{l1} + B_{l}a^{-(l+1)} $$\n    where $\\delta_{l1}$ is the Kronecker delta.\n\n2.  Continuity of the normal component of the electric displacement field $\\mathbf{D} = \\varepsilon\\mathbf{E} = -\\varepsilon\\nabla\\Phi$. The normal direction is $\\hat{\\mathbf{r}}$.\n    $$ \\varepsilon_{1} \\frac{\\partial\\Phi_{1}}{\\partial r}\\bigg|_{r=a} = \\varepsilon_{2} \\frac{\\partial\\Phi_{2}}{\\partial r}\\bigg|_{r=a} $$\n    Here, $\\varepsilon_1 = \\varepsilon_0$ (vacuum) and $\\varepsilon_2 = \\varepsilon = \\varepsilon_{0}\\varepsilon_{r}$.\n    $$ \\varepsilon_{0} \\sum_{l=0}^{\\infty} A_{l}la^{l-1} P_{l}(\\cos\\theta) = \\varepsilon_{0}\\varepsilon_{r} \\left( -EP_{1}(\\cos\\theta) - \\sum_{l=0}^{\\infty} B_{l}(l+1)a^{-(l+2)} P_{l}(\\cos\\theta) \\right) $$\n    Equating coefficients for each $l$:\n    $$ A_{l}la^{l-1} = \\varepsilon_{r} \\left( -E\\delta_{l1} - B_{l}(l+1)a^{-(l+2)} \\right) $$\n\nFor $l \\neq 1$, the equations become:\n$A_{l}a^{l} = B_{l}a^{-(l+1)}$\n$A_{l}l a^{l-1} = -\\varepsilon_{r}B_{l}(l+1)a^{-(l+2)}$\nSubstituting $B_{l} = A_{l}a^{2l+1}$ into the second equation gives $A_{l}l = -\\varepsilon_{r}A_{l}(l+1)$, or $A_{l}(l + \\varepsilon_{r}(l+1)) = 0$. Since $l \\ge 0$ and $\\varepsilon_{r} \\ge 1$, the term in parenthesis is non-zero, so $A_{l}=0$ and thus $B_{l}=0$ for all $l \\neq 1$.\n\nFor $l=1$, the system of equations is:\n1) $A_{1}a = -Ea + B_{1}a^{-2}$\n2) $A_{1} = \\varepsilon_{r}(-E - 2B_{1}a^{-3})$\n\nFrom (1), we express $B_{1}$ as $B_{1} = a^{3}(A_{1} + E)$. Substituting this into (2):\n$A_{1} = \\varepsilon_{r}(-E - 2a^{-3} \\cdot a^{3}(A_{1} + E))$\n$A_{1} = -\\varepsilon_{r}E - 2\\varepsilon_{r}(A_{1} + E) = -\\varepsilon_{r}E - 2\\varepsilon_{r}A_{1} - 2\\varepsilon_{r}E$\n$A_{1}(1 + 2\\varepsilon_{r}) = -3\\varepsilon_{r}E$\n$$ A_{1} = -\\frac{3\\varepsilon_{r}}{2\\varepsilon_{r}+1} E $$\nThe potential inside the void is then $\\Phi_{1}(r, \\theta) = A_{1}rP_{1}(\\cos\\theta) = A_{1}r\\cos\\theta = A_{1}z$.\nThe electric field inside the void is uniform:\n$$ \\mathbf{E}_{\\text{void}} = -\\nabla\\Phi_{1} = -\\frac{\\partial}{\\partial z}(A_{1}z)\\hat{\\mathbf{z}} = -A_{1}\\hat{\\mathbf{z}} $$\n$$ \\mathbf{E}_{\\text{void}} = \\frac{3\\varepsilon_{r}}{2\\varepsilon_{r}+1} E \\hat{\\mathbf{z}} $$\nThe magnitude of this field is:\n$$ E_{\\text{void}} = \\frac{3\\varepsilon_{r}}{2\\varepsilon_{r}+1} E $$\n\n#### Part 2: Calculation of the Lorentz Cavity Field ($E_{\\text{L}}$)\n\nThe Lorentz cavity field is the sum of the macroscopic field $\\mathbf{E}$ and the field $\\mathbf{E}_{\\text{surf}}$ produced at the center of the cavity by the bound surface charges on the cavity wall.\n$$ \\mathbf{E}_{\\text{L}} = \\mathbf{E} + \\mathbf{E}_{\\text{surf}} $$\nThe macroscopic field is given as $\\mathbf{E} = E\\hat{\\mathbf{z}}$. The polarization $\\mathbf{P}$ in the linear dielectric is related to $\\mathbf{E}$ by $\\mathbf{P} = \\varepsilon_{0}(\\varepsilon_{r}-1)\\mathbf{E}$.\n$$ \\mathbf{P} = \\varepsilon_{0}(\\varepsilon_{r}-1)E\\hat{\\mathbf{z}} = P\\hat{\\mathbf{z}} $$\nThe bound surface charge density $\\sigma_{b}$ on the cavity surface is given by $\\sigma_{b} = \\mathbf{P} \\cdot \\hat{\\mathbf{n}}$, where $\\hat{\\mathbf{n}}$ is the normal vector pointing out of the dielectric, i.e., into the cavity. At a point on the sphere surface described by radius vector $\\mathbf{r}'$, $\\hat{\\mathbf{n}} = -\\hat{\\mathbf{r}}'$.\n$$ \\sigma_{b} = (P\\hat{\\mathbf{z}}) \\cdot (-\\hat{\\mathbf{r}}') = -P(\\hat{\\mathbf{z}}\\cdot\\hat{\\mathbf{r}}') = -P\\cos\\theta' $$\nwhere $\\theta'$ is the angle between $\\mathbf{r}'$ and the $z$-axis.\nThe electric field $\\mathbf{E}_{\\text{surf}}$ at the center of the sphere (the origin) due to this charge distribution is calculated by integrating over the sphere's surface $S'$:\n$$ \\mathbf{E}_{\\text{surf}} = \\frac{1}{4\\pi\\varepsilon_{0}} \\int_{S'} \\frac{\\sigma_{b}dS'}{|\\mathbf{r}'|^{2}}(-\\hat{\\mathbf{r}}') = \\frac{1}{4\\pi\\varepsilon_{0}} \\int_{S'} \\frac{(-P\\cos\\theta')dS'}{a^{2}}(-\\hat{\\mathbf{r}}') = \\frac{P}{4\\pi\\varepsilon_{0}a^{2}} \\int_{S'} \\cos\\theta'\\hat{\\mathbf{r}}'dS' $$\nWe express $\\hat{\\mathbf{r}}'$ in Cartesian coordinates: $\\hat{\\mathbf{r}}' = \\sin\\theta'\\cos\\phi'\\hat{\\mathbf{x}} + \\sin\\theta'\\sin\\phi'\\hat{\\mathbf{y}} + \\cos\\theta'\\hat{\\mathbf{z}}$. The surface element is $dS' = a^{2}\\sin\\theta'd\\theta'd\\phi'$.\nThe $x$ and $y$ components of the integral vanish due to the integration over $\\phi'$ from $0$ to $2\\pi$ ($\\int_{0}^{2\\pi}\\cos\\phi'd\\phi'=0$ and $\\int_{0}^{2\\pi}\\sin\\phi'd\\phi'=0$).\nThe $z$-component of the integral is:\n$$ \\hat{\\mathbf{z}} \\int_{0}^{2\\pi}d\\phi' \\int_{0}^{\\pi} \\cos\\theta'(\\cos\\theta') a^{2}\\sin\\theta'd\\theta' = \\hat{\\mathbf{z}} (2\\pi a^{2}) \\int_{0}^{\\pi} \\cos^{2}\\theta'\\sin\\theta'd\\theta' $$\nLet $u=\\cos\\theta'$, $du=-\\sin\\theta'd\\theta'$. The integral becomes $\\int_{1}^{-1} u^{2}(-du) = \\int_{-1}^{1} u^{2}du = [\\frac{u^{3}}{3}]_{-1}^{1} = \\frac{2}{3}$.\nSo, the integral is $\\hat{\\mathbf{z}} (2\\pi a^{2})(\\frac{2}{3}) = \\frac{4\\pi a^{2}}{3}\\hat{\\mathbf{z}}$.\nSubstituting this back into the expression for $\\mathbf{E}_{\\text{surf}}$:\n$$ \\mathbf{E}_{\\text{surf}} = \\frac{P}{4\\pi\\varepsilon_{0}a^{2}} \\left( \\frac{4\\pi a^{2}}{3}\\hat{\\mathbf{z}} \\right) = \\frac{P}{3\\varepsilon_{0}}\\hat{\\mathbf{z}} $$\nNow, substitute $P = \\varepsilon_{0}(\\varepsilon_{r}-1)E$:\n$$ \\mathbf{E}_{\\text{surf}} = \\frac{\\varepsilon_{0}(\\varepsilon_{r}-1)E}{3\\varepsilon_{0}}\\hat{\\mathbf{z}} = \\frac{\\varepsilon_{r}-1}{3}E\\hat{\\mathbf{z}} $$\nThe Lorentz field is then:\n$$ \\mathbf{E}_{\\text{L}} = E\\hat{\\mathbf{z}} + \\frac{\\varepsilon_{r}-1}{3}E\\hat{\\mathbf{z}} = \\left(1 + \\frac{\\varepsilon_{r}-1}{3}\\right)E\\hat{\\mathbf{z}} = \\left(\\frac{3+\\varepsilon_{r}-1}{3}\\right)E\\hat{\\mathbf{z}} = \\frac{\\varepsilon_{r}+2}{3}E\\hat{\\mathbf{z}} $$\nThe magnitude of the Lorentz field is:\n$$ E_{\\text{L}} = \\frac{\\varepsilon_{r}+2}{3} E $$\n\n#### Part 3: Calculation of the Ratio $R(\\varepsilon_{r})$\nFinally, we compute the ratio $R(\\varepsilon_{r})=\\frac{E_{\\text{void}}}{E_{\\text{L}}}$.\n$$ R(\\varepsilon_{r}) = \\frac{\\frac{3\\varepsilon_{r}}{2\\varepsilon_{r}+1} E}{\\frac{\\varepsilon_{r}+2}{3} E} = \\frac{3\\varepsilon_{r}}{2\\varepsilon_{r}+1} \\cdot \\frac{3}{\\varepsilon_{r}+2} $$\n$$ R(\\varepsilon_{r}) = \\frac{9\\varepsilon_{r}}{(2\\varepsilon_{r}+1)(\\varepsilon_{r}+2)} $$\nThis is the required closed-form analytic expression.", "answer": "$$\n\\boxed{\\frac{9\\varepsilon_{r}}{(2\\varepsilon_{r}+1)(\\varepsilon_{r}+2)}}\n$$", "id": "2836885"}, {"introduction": "A key step in deriving the Lorentz field is treating the polarized material outside the conceptual cavity as a smooth continuum. This computational practice allows you to directly scrutinize this approximation by replacing the continuum integration with a discrete summation over a finite lattice of explicit dipoles [@problem_id:2836909]. Implementing this numerical experiment will provide powerful insight into how macroscopic continuum properties emerge from the underlying microscopic, discrete nature of matter and how finite-size effects can introduce corrections.", "problem": "You are tasked with computing finite-cavity corrections to the Lorentz local field in a crystalline dielectric by explicitly summing the discrete dipole field outside a spherical cavity carved around a lattice site. Start from the following fundamental bases:\n\n- The definition of polarization: for a uniform polarization $\\mathbf{P} = P \\,\\hat{\\mathbf{z}}$, the dipole moment per site is $\\boldsymbol{\\mu} = \\mu \\,\\hat{\\mathbf{z}}$ with $\\mu = P \\, V_{\\text{site}}$, where $V_{\\text{site}}$ is the volume per lattice site.\n- The electrostatic field of a point dipole: the electric field at position $\\mathbf{r}$ caused by a point dipole $\\boldsymbol{\\mu}$ located at the origin is\n$$\n\\mathbf{E}(\\mathbf{r}) = \\frac{1}{4\\pi \\varepsilon_0} \\left[\\frac{3(\\boldsymbol{\\mu}\\cdot \\hat{\\mathbf{r}})\\,\\hat{\\mathbf{r}} - \\boldsymbol{\\mu}}{r^3}\\right],\n$$\nwith $\\hat{\\mathbf{r}} = \\mathbf{r}/r$ and $r=\\|\\mathbf{r}\\|$.\n- For a spherical cavity embedded in a uniformly polarized continuum, the field at the center due to the polarized matter outside the cavity equals $E_{z}^{\\text{cont}} = P/(3\\varepsilon_0)$ along $\\hat{\\mathbf{z}}$. In units where $1/(4\\pi\\varepsilon_0)=1$, this reference equals $E_{z}^{\\text{cont}} = 4\\pi P/3$.\n\nYou will model three cubic lattices: simple cubic (SC), body-centered cubic (BCC), and face-centered cubic (FCC). Take a conventional cubic cell of lattice constant $a$ with basis:\n- SC: a single site at fractional coordinates $(0,0,0)$, so $n_{\\text{site}}=1$,\n- BCC: sites at $(0,0,0)$ and $(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2})$, so $n_{\\text{site}}=2$,\n- FCC: sites at $(0,0,0)$, $(0,\\tfrac{1}{2},\\tfrac{1}{2})$, $(\\tfrac{1}{2},0,\\tfrac{1}{2})$, and $(\\tfrac{1}{2},\\tfrac{1}{2},0)$, so $n_{\\text{site}}=4$.\n\nLet $\\mathbf{P}=P\\,\\hat{\\mathbf{z}}$ with $P$ a constant. For each lattice type, construct a finite cubic array of conventional cells with integer indices $(i,j,k)$ bounded by $-N \\le i,j,k \\le N$, yielding a supercell of side length $(2N+1)a$. Place dipoles at positions $\\mathbf{r} = a\\,(i+\\xi, j+\\eta, k+\\zeta)$ for each basis vector $(\\xi,\\eta,\\zeta)$ in the chosen lattice. Remove the dipoles whose centers lie within a spherical cavity of radius $R_c$ centered at the origin by excluding all sites with $r < R_c$. Exclude also the central site at the origin if present. Assign to each site a dipole moment $\\boldsymbol{\\mu} = \\mu \\hat{\\mathbf{z}}$ with $\\mu = P a^3 / n_{\\text{site}}$, consistent with uniform polarization.\n\nCompute the discrete estimate of the $z$-component of the field at the origin due to all included dipoles,\n$$\nE_{z}^{\\text{disc}}(R_c,N;\\text{lattice}) = \\sum_{\\mathbf{r}} \\left[\\frac{1}{4\\pi \\varepsilon_0}\\left(\\frac{3(\\boldsymbol{\\mu}\\cdot\\mathbf{r})\\,z}{r^5} - \\frac{\\mu}{r^3}\\right)\\right],\n$$\nwhere $z$ is the $z$-coordinate of $\\mathbf{r}$, and the sum runs over all included dipoles in the finite array.\n\nAdopt dimensionless units with $1/(4\\pi \\varepsilon_0)=1$ and $P=1$, so that $E_{z}^{\\text{cont}}=4\\pi/3$ and $\\mu = a^3/n_{\\text{site}}$.\n\nDefine the dimensionless finite-cavity correction as\n$$\n\\delta(R_c,N;\\text{lattice}) = \\frac{E_{z}^{\\text{disc}}(R_c,N;\\text{lattice})}{E_{z}^{\\text{cont}}} - 1.\n$$\n\nYour task is to implement a program that:\n- Constructs the specified lattice and basis.\n- Sums the discrete dipole contributions outside the spherical cavity of radius $R_c$ and inside the cubic cutoff set by $N$.\n- Computes $\\delta(R_c,N;\\text{lattice})$ for each test case.\n\nAll outputs must be dimensionless real numbers (floats). Angles, if any appear internally, must be treated in radians. No International System of Units (SI) dimensions appear in the outputs because of the chosen unit normalization.\n\nTest suite to evaluate coverage:\n- Case $1$: lattice $\\in\\{\\text{SC}\\}$, $a=1.0$, $R_c=1.2$, $N=10$ (general convergence case).\n- Case $2$: lattice $\\in\\{\\text{SC}\\}$, $a=1.0$, $R_c=0.51$, $N=10$ (small cavity radius close to the nearest-site exclusion).\n- Case $3$: lattice $\\in\\{\\text{SC}\\}$, $a=1.0$, $R_c=1.2$, $N=3$ (small cutoff to probe incomplete shell convergence).\n- Case $4$: lattice $\\in\\{\\text{BCC}\\}$, $a=1.0$, $R_c=1.2$, $N=10$ (different basis density).\n- Case $5$: lattice $\\in\\{\\text{FCC}\\}$, $a=1.0$, $R_c=1.2$, $N=10$ (close-packed basis).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"). The list elements correspond to the cases above in order and must be the numerical values of $\\delta$ for each case, as defined. All intermediate choices must follow the definitions above, and no external input is allowed.", "solution": "The task is to compute the finite-cavity correction to the Lorentz local field. The local field, $\\mathbf{E}_{\\text{local}}$, at a given lattice site is the total electric field from all sources *except* the dipole at that site. P. A. M. Lorentz proposed a method to calculate this by conceptually carving out a small spherical cavity around the site. The field is then decomposed into contributions from dipoles inside the cavity (the \"near field\") and the polarized medium outside the cavity (the \"far field\").\n\nIn the standard Lorentz model, the far field from the uniformly polarized continuum outside the sphere contributes $\\mathbf{E}_{\\text{cont}} = \\mathbf{P}/(3\\varepsilon_0)$ at the center of the cavity. The near field sum over the discrete dipoles inside the cavity is then performed. For lattices with high (e.g., cubic) symmetry, this near-field sum evaluates to zero, leading to the famous Lorentz relation.\n\nThis problem re-examines the far-field contribution. Instead of treating it as a continuum, we compute it by a direct, discrete sum of dipole fields from sites outside a cavity of radius $R_c$ and within a larger finite cube of size $(2N+1)a$. The deviation of this discrete sum from the continuum value gives the finite-cavity correction $\\delta$.\n\nThe electric field at the origin due to a point dipole $\\boldsymbol{\\mu}$ at position $\\mathbf{r}$ is given by:\n$$\n\\mathbf{E}(\\mathbf{r}) = \\frac{1}{4\\pi \\varepsilon_0} \\left[ \\frac{3(\\boldsymbol{\\mu} \\cdot \\mathbf{r})\\mathbf{r}}{r^5} - \\frac{\\boldsymbol{\\mu}}{r^3} \\right]\n$$\nThe problem specifies a uniform polarization $\\mathbf{P} = P \\hat{\\mathbf{z}}$, so each dipole moment is $\\boldsymbol{\\mu} = \\mu \\hat{\\mathbf{z}}$. For a position vector $\\mathbf{r} = (x, y, z)$, the dot product is $\\boldsymbol{\\mu} \\cdot \\mathbf{r} = \\mu z$. The $z$-component of the electric field from this single dipole is:\n$$\nE_z = \\frac{1}{4\\pi \\varepsilon_0} \\left[ \\frac{3(\\mu z)z}{r^5} - \\frac{\\mu}{r^3} \\right] = \\frac{\\mu}{4\\pi \\varepsilon_0} \\left( \\frac{3z^2}{r^5} - \\frac{1}{r^3} \\right)\n$$\nWe adopt dimensionless units such that $1/(4\\pi\\varepsilon_0) = 1$ and the polarization magnitude $P=1$. The dipole moment per site is $\\mu = P V_{\\text{site}}$. For a conventional cubic cell of side $a$ containing $n_{\\text{site}}$ basis atoms, the volume per site is $V_{\\text{site}} = a^3/n_{\\text{site}}$. Thus, the dipole moment in these units is $\\mu = a^3/n_{\\text{site}}$.\n\nThe discrete sum for the $z$-component of the field, $E_z^{\\text{disc}}$, is performed over all lattice sites $\\mathbf{r}_{i,j,k,\\beta}$ that satisfy two conditions:\n$1$. They lie within the computational supercell defined by integer indices $-N \\le i, j, k \\le N$.\n$2$. They lie outside the spherical cavity of radius $R_c$, i.e., $\\|\\mathbf{r}_{i,j,k,\\beta}\\| \\ge R_c$.\nThe position of a site is given by $\\mathbf{r}_{i,j,k,\\beta} = a((i, j, k) + (\\xi, \\eta, \\zeta)_{\\beta})$, where $(i,j,k)$ is the cell index and $(\\xi, \\eta, \\zeta)_{\\beta}$ is the fractional coordinate of a basis site $\\beta$. The site at the origin $(\\mathbf{r} = \\mathbf{0})$ is explicitly excluded.\n\nThe total discrete field is the sum:\n$$\nE_{z}^{\\text{disc}}(R_c, N; \\text{lattice}) = \\sum_{i,j,k,\\beta \\text{ s.t. } r \\ge R_c, r \\ne 0} \\mu \\left( \\frac{3z_{i,j,k,\\beta}^2}{r_{i,j,k,\\beta}^5} - \\frac{1}{r_{i,j,k,\\beta}^3} \\right)\n$$\nThe reference continuum field in our chosen units is $E_z^{\\text{cont}} = 4\\pi P/3$. With $P=1$, this is $E_z^{\\text{cont}} = 4\\pi/3$.\n\nThe dimensionless finite-cavity correction $\\delta$ is then calculated as:\n$$\n\\delta(R_c, N; \\text{lattice}) = \\frac{E_{z}^{\\text{disc}}(R_c, N; \\text{lattice})}{E_{z}^{\\text{cont}}} - 1\n$$\nThis quantity measures the relative error incurred by replacing the discrete lattice outside the cavity with a uniform continuum. This error arises from the granularity of the lattice and the finite, cubic shape of the summation volume. For an infinite, spherically-summed lattice, this correction would vanish.\n\nThe algorithm to be implemented is as follows:\n$1$. For each test case, specified by lattice type (SC, BCC, or FCC), lattice constant $a$, cavity radius $R_c$, and supercell size parameter $N$, we initialize the total discrete field $E_{z}^{\\text{disc}}$ to $0$.\n$2$. We define the basis vectors $(\\xi, \\eta, \\zeta)$ and the number of sites $n_{\\text{site}}$ for the chosen lattice. We calculate the dipole moment $\\mu = a^3/n_{\\text{site}}$.\n$3$. We iterate through all cell indices $(i, j, k)$ from $-N$ to $N$.\n$4$. Within each cell, we iterate through all basis vectors. For each site, we compute its position vector $\\mathbf{r} = (x, y, z)$.\n$5$. We check if the site is at the origin ($r=0$). If it is, we skip it.\n$6$. We check if the site is within the spherical cavity ($r < R_c$). If it is, we skip it.\n$7. If the site is included, we calculate its contribution to the field, $\\Delta E_z = \\mu (3z^2/r^5 - 1/r^3)$, and add it to $E_{z}^{\\text{disc}}$.\n$8$. After summing over all included sites, we calculate the reference field $E_z^{\\text{cont}} = 4\\pi/3$.\n$9$. Finally, we compute the correction $\\delta = E_{z}^{\\text{disc}}/E_z^{\\text{cont}} - 1$ and report the result.\n\nThis procedure constitutes a direct numerical evaluation of the problem as stated.", "answer": "```python\nimport numpy as np\n\ndef calculate_delta(lattice_type: str, a: float, Rc: float, N: int) -> float:\n    \"\"\"\n    Computes the finite-cavity correction to the Lorentz local field.\n\n    Args:\n        lattice_type: The type of cubic lattice ('SC', 'BCC', 'FCC').\n        a: The lattice constant.\n        Rc: The radius of the spherical exclusion cavity.\n        N: The half-size of the cubic supercell in units of conventional cells.\n\n    Returns:\n        The dimensionless finite-cavity correction delta.\n    \"\"\"\n    # Define lattice basis vectors in fractional coordinates and number of sites per conventional cell.\n    bases = {\n        'SC': np.array([[0.0, 0.0, 0.0]]),\n        'BCC': np.array([[0.0, 0.0, 0.0], [0.5, 0.5, 0.5]]),\n        'FCC': np.array([[0.0, 0.0, 0.0], [0.0, 0.5, 0.5], [0.5, 0.0, 0.5], [0.5, 0.5, 0.0]]),\n    }\n    nsites = {\n        'SC': 1,\n        'BCC': 2,\n        'FCC': 4,\n    }\n\n    n_site = nsites[lattice_type]\n    basis_vectors = bases[lattice_type]\n    \n    # In dimensionless units, P=1, so mu = V_site = a^3 / n_site.\n    mu = a**3 / n_site\n    \n    E_z_disc = 0.0\n    \n    # Loop over conventional cells indexed by (i, j, k) from -N to N.\n    cell_indices = np.arange(-N, N + 1)\n    for i in cell_indices:\n        for j in cell_indices:\n            for k in cell_indices:\n                # Loop over basis sites within the cell.\n                for basis_vec in basis_vectors:\n                    pos_vec = a * (np.array([i, j, k]) + basis_vec)\n                    \n                    r_sq = np.sum(pos_vec**2)\n                    \n                    # Exclude the site at the origin where the field is calculated.\n                    # A small tolerance is used for floating-point comparison to zero.\n                    if r_sq < 1e-12:\n                        continue\n                    \n                    r = np.sqrt(r_sq)\n                    \n                    # Include only dipoles outside the cavity radius Rc.\n                    if r >= Rc:\n                        z = pos_vec[2]\n                        # The z-component of the field from a single dipole, with 1/(4*pi*eps_0) = 1.\n                        # E_z = mu * (3*z^2/r^5 - 1/r^3)\n                        r_cubed = r**3\n                        r_fifth = r_cubed * r**2 # Computationally cheaper than r**5\n                        E_z_single = mu * (3 * z**2 / r_fifth - 1 / r_cubed)\n                        E_z_disc += E_z_single\n\n    # The continuum field at the center of a spherical cavity, with P=1 and 1/(4*pi*eps_0)=1.\n    E_z_cont = 4 * np.pi / 3.0\n    \n    # Calculate the dimensionless finite-cavity correction.\n    delta = E_z_disc / E_z_cont - 1.0\n    \n    return delta\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'lattice': 'SC', 'a': 1.0, 'R_c': 1.2, 'N': 10},\n        {'lattice': 'SC', 'a': 1.0, 'R_c': 0.51, 'N': 10},\n        {'lattice': 'SC', 'a': 1.0, 'R_c': 1.2, 'N': 3},\n        {'lattice': 'BCC', 'a': 1.0, 'R_c': 1.2, 'N': 10},\n        {'lattice': 'FCC', 'a': 1.0, 'R_c': 1.2, 'N': 10},\n    ]\n\n    results = []\n    for case in test_cases:\n        delta = calculate_delta(case['lattice'], case['a'], case['R_c'], case['N'])\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2836909"}]}