{"hands_on_practices": [{"introduction": "The foundation of ionic conductivity in many materials lies in the controlled introduction of point defects. This exercise explores the fundamental principle of charge compensation in an acceptor-doped perovskite oxide [@problem_id:2831042]. By applying the concept of electroneutrality, you will derive a direct relationship between the concentration of a dopant and the resulting concentration of mobile oxygen vacancies, providing a crucial first step in designing solid electrolytes with tailored transport properties.", "problem": "Consider a stoichiometric perovskite oxide of the form ABO$_{3}$ in which the B-site cation has charge number $z_{B}$ and the oxygen anion has charge number $z_{O} = -2$. The material is doped with an acceptor cation $M$ that substitutes exclusively on the B sublattice with charge number $z_{M}  z_{B}$. Let the dopant mole fraction on the B sublattice be $x$, defined as the fraction of B sites occupied by $M$ (that is, $x = 0$ corresponds to no dopant and $x = 1$ corresponds to complete replacement of B by $M$ on the B sublattice). Assume:\n- The crystal is fully dehydrated, so no protonic defects are present.\n- Electronic defects are negligible in concentration compared to ionic defects under the conditions considered.\n- The only compensating point defects are oxygen vacancies on the oxygen sublattice.\n- All dopants are fully ionized, there is no defect association, and the dilute limit holds.\n- The oxygen sublattice contains $N_{O}$ sites per unit volume and the B sublattice contains $N_{B}$ sites per unit volume, with the perovskite stoichiometry implying $N_{O} = 3 N_{B}$.\n\nStarting only from local electroneutrality, site counting, and the given stoichiometry, derive a closed-form expression for the equilibrium fraction of oxygen sites that are vacant, $y_{V}$, as a function of $x$, $z_{B}$, and $z_{M}$. Express your final answer as $y_{V}(x, z_{B}, z_{M})$ in its simplest analytic form. No numerical evaluation is required, and no units should be included in the final expression.", "solution": "The problem as stated is valid. It is a well-posed, scientifically grounded problem in the field of solid-state defect chemistry, free of contradictions or ambiguities. All assumptions and parameters are clearly defined, permitting a rigorous derivation. I shall now proceed with the solution.\n\nThe objective is to derive an expression for $y_V$, the fraction of vacant oxygen sites, as a function of the dopant mole fraction $x$ and the charge numbers of the host and dopant B-site cations, $z_B$ and $z_M$. The derivation will be based strictly on the principles of local electroneutrality and site counting, under the given assumptions.\n\nFirst, we must identify the charged defect species in the crystal. According to the problem statement, the system contains an acceptor dopant $M$ substituting for the host cation $B$ on the B-sublattice, with compensation occurring exclusively through the formation of oxygen vacancies. Electronic defects and protonic defects are negligible. Therefore, the only charged species we need to consider for the charge balance are the dopant ions and the oxygen vacancies.\n\nLet us determine the effective charges of these species. The effective charge of a defect is its charge relative to the charge of the site it occupies in the perfect, undoped crystal.\n1.  An oxygen vacancy, which we denote as $V_O$, is formed by removing an oxygen ion, $O^{2-}$, from an oxygen lattice site. The charge of the site changes from that of the ion, $z_O = -2$, to zero. The effective charge of the oxygen vacancy, $q_{V_O}$, is therefore $q_{V_O} = 0 - z_O = 0 - (-2) = +2$.\n2.  An acceptor dopant ion, $M$, with charge number $z_M$, substitutes for a host B-site cation, $B$, which has a charge number $z_B$. The effective charge of this substitution defect, which we can denote as $M_B$, is the difference in charge numbers: $q_{M_B} = z_M - z_B$. As specified, $z_M  z_B$, which makes this effective charge negative, consistent with an acceptor defect.\n\nThe principle of local electroneutrality requires that the crystal remains macroscopically charge-neutral. This means the sum of the products of the concentration and effective charge for all defect species must be zero. Let $[V_O]$ be the volume concentration (number per unit volume) of oxygen vacancies and $[M_B]$ be the volume concentration of dopant ions on B-sites. The electroneutrality condition is:\n$$[V_O] \\cdot q_{V_O} + [M_B] \\cdot q_{M_B} = 0$$\nSubstituting the effective charges we derived:\n$$[V_O] \\cdot (+2) + [M_B] \\cdot (z_M - z_B) = 0$$\nThis equation can be rearranged to separate the positively and negatively charged species:\n$$2[V_O] = [M_B](z_B - z_M)$$\n\nNext, we must relate these volume concentrations to the fractional quantities given in the problem statement.\n1.  The variable $y_V$ is defined as the fraction of oxygen sites that are vacant. If $N_O$ is the total number of oxygen sites per unit volume, then the concentration of oxygen vacancies is $[V_O] = y_V N_O$.\n2.  The variable $x$ is defined as the fraction of B-sublattice sites occupied by the dopant $M$. If $N_B$ is the total number of B-sublattice sites per unit volume, then the concentration of dopants is $[M_B] = x N_B$.\n\nSubstituting these expressions for concentration into the electroneutrality equation:\n$$2(y_V N_O) = (x N_B)(z_B - z_M)$$\n\nThe final step is to use the stoichiometric relationship for the ABO$_3$ perovskite structure. The chemical formula indicates there are $3$ oxygen atoms for every $1$ B-site cation. This implies a direct relationship between the site densities of the respective sublattices: $N_O = 3 N_B$.\n\nSubstituting this stoichiometric constraint into our equation:\n$$2 y_V (3 N_B) = x N_B (z_B - z_M)$$\n$$6 y_V N_B = x N_B (z_B - z_M)$$\nThe B-sublattice site density, $N_B$, is a non-zero quantity and can be cancelled from both sides of the equation:\n$$6 y_V = x(z_B - z_M)$$\nFinally, we solve for $y_V$ to obtain the desired expression:\n$$y_V = \\frac{x(z_B - z_M)}{6}$$\nThis is the closed-form expression for the equilibrium fraction of vacant oxygen sites as a function of the dopant fraction $x$ and the charge states $z_B$ and $z_M$, derived strictly from the given premises.", "answer": "$$\\boxed{\\frac{x(z_B - z_M)}{6}}$$", "id": "2831042"}, {"introduction": "Once charge carriers are present, their movement through the crystal lattice is typically an activated process, strongly dependent on temperature. This practice bridges the microscopic theory of ion hopping with macroscopic experimental data [@problem_id:2858758]. You will first derive the famous Arrhenius relationship for conductivity from fundamental principles and then apply it to analyze experimental data, extracting the activation energy ($E_{a}$) and pre-exponential factor ($\\sigma_{0}$), two key parameters that characterize the transport mechanism.", "problem": "A dense polycrystalline superionic conductor exhibits ionic transport dominated by thermally activated hopping of monovalent cations between equivalent lattice sites. Assume that, over the temperature window of interest, the mobile ion concentration is temperature independent and the dominant temperature dependence of the jump rate arises from overcoming a migration barrier.\n\nStarting from a hopping picture and the Einstein relation between the diffusion coefficient and mobility, together with the definition of electrical conductivity, use fundamental principles to derive a linear relationship between $\\ln \\sigma$ and $1/T$, identifying the slope and intercept in terms of physically meaningful parameters. You may assume that over a limited temperature window any slowly varying prefactors can be treated as approximately constant so that an effective pre-exponential factor captures them.\n\nAn Arrhenius plot of $\\ln \\sigma$ versus $1/T$ (with the horizontal axis expressed in $\\mathrm{K}^{-1}$) for this material yields a best-fit straight line with slope $m$ and intercept $b$ given by:\n- $m = -3.481355436 \\times 10^{3} \\ \\mathrm{K}$,\n- $b = 9.210340372$.\n\nTake the Boltzmann constant as $k_{B} = 8.617333262 \\times 10^{-5} \\ \\mathrm{eV/K}$.\n\nUsing your derived linear relationship, determine the activation energy $E_{a}$ and the pre-exponential factor $\\sigma_{0}$. Report $E_{a}$ in electronvolts and $\\sigma_{0}$ in siemens per meter. Round both quantities to four significant figures.\n\nBriefly explain the physical interpretation of $E_{a}$ and $\\sigma_{0}$ in the context of solid electrolytes and superionic conductors, based on your derivation.\n\nYour final answer must be a pair consisting of $E_{a}$ and $\\sigma_{0}$ in that order.", "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of solid-state physics, specifically the theory of ionic transport in crystalline solids. The problem is well-posed, providing sufficient information and clear, objective instructions to derive a standard physical model and apply it to a given dataset. All provided data and assumptions are consistent and physically reasonable.\n\nThe task is to derive the Arrhenius relationship for ionic conductivity, and then use provided experimental data to determine the activation energy $E_{a}$ and the pre-exponential factor $\\sigma_{0}$.\n\nThe electrical conductivity, $\\sigma$, is defined as the product of the mobile charge carrier concentration $n$, the charge per carrier $q$, and the carrier mobility $\\mu$:\n$$\n\\sigma = n q \\mu\n$$\nThe problem states that the mobile carriers are monovalent cations, so their charge is the elementary charge, $q = e$. The concentration $n$ is assumed to be independent of temperature $T$.\n\nThe mobility $\\mu$ is related to the diffusion coefficient $D$ by the Einstein relation (or Nernst-Einstein relation in this context):\n$$\n\\mu = \\frac{q D}{k_{B} T}\n$$\nwhere $k_{B}$ is the Boltzmann constant and $T$ is the absolute temperature.\n\nSubstituting the expression for $\\mu$ into the equation for $\\sigma$ yields:\n$$\n\\sigma = n q \\left( \\frac{q D}{k_{B} T} \\right) = \\frac{n q^{2} D}{k_{B} T}\n$$\nThe problem specifies that ionic transport is dominated by thermally activated hopping. The diffusion coefficient $D$ for a hopping mechanism in a three-dimensional lattice is given by:\n$$\nD = \\frac{1}{6} z a^{2} f \\Gamma\n$$\nwhere $z$ is the number of nearest-neighbor sites, $a$ is the jump distance, $f$ is a correlation factor (which can be considered constant for this problem and absorbed into the prefactor), and $\\Gamma$ is the ionic jump rate. For simplicity, we can express this as $D = D_0 \\Gamma$, where $D_0$ is a temperature-independent geometric factor.\n\nThe jump rate $\\Gamma$ is thermally activated and follows an Arrhenius law:\n$$\n\\Gamma = \\nu_{0} \\exp\\left(-\\frac{E_{a}}{k_{B} T}\\right)\n$$\nHere, $\\nu_{0}$ is the attempt frequency, which is related to the vibrational frequency of the ion in its potential well, and $E_{a}$ is the activation energy for migration, representing the energy barrier for a hop.\n\nCombining these expressions, the conductivity becomes:\n$$\n\\sigma = \\frac{n q^{2}}{k_{B} T} D = \\frac{n q^{2}}{k_{B} T} \\left( \\frac{1}{6} z a^{2} f \\nu_{0} \\exp\\left(-\\frac{E_{a}}{k_{B} T}\\right) \\right)\n$$\nThis can be written as:\n$$\n\\sigma = \\frac{1}{T} \\left( \\frac{n q^{2} z a^{2} f \\nu_{0}}{6 k_{B}} \\right) \\exp\\left(-\\frac{E_{a}}{k_{B} T}\\right)\n$$\nThe problem instructs to assume that over a limited temperature window, any slowly varying prefactors can be treated as approximately constant. The term $1/T$ varies much more slowly than the exponential term $\\exp(-E_{a}/(k_{B}T))$. Therefore, we can absorb the $1/T$ term and all other temperature-independent factors into a single effective pre-exponential factor, $\\sigma_{0}$.\n$$\n\\sigma_{0} \\approx \\frac{n q^{2} z a^{2} f \\nu_{0}}{6 k_{B} T_{\\text{avg}}}\n$$\nwhere $T_{\\text{avg}}$ is a representative average temperature in the measurement range. With this standard approximation, the conductivity equation simplifies to the well-known Arrhenius form:\n$$\n\\sigma(T) = \\sigma_{0} \\exp\\left(-\\frac{E_{a}}{k_{B} T}\\right)\n$$\nTo obtain the required linear relationship, we take the natural logarithm of both sides:\n$$\n\\ln \\sigma = \\ln \\left( \\sigma_{0} \\exp\\left(-\\frac{E_{a}}{k_{B} T}\\right) \\right) = \\ln \\sigma_{0} + \\ln \\left( \\exp\\left(-\\frac{E_{a}}{k_{B} T}\\right) \\right)\n$$\n$$\n\\ln \\sigma = \\ln \\sigma_{0} - \\frac{E_{a}}{k_{B}} \\frac{1}{T}\n$$\nThis equation is of the form $y = b + mx$, where $y = \\ln \\sigma$ and $x = 1/T$. The slope $m$ and the y-intercept $b$ are identified as:\n- Slope: $m = -\\frac{E_{a}}{k_{B}}$\n- Intercept: $b = \\ln \\sigma_{0}$\n\nThe problem provides the experimental values for the slope and intercept from an Arrhenius plot:\n- $m = -3.481355436 \\times 10^{3} \\ \\mathrm{K}$\n- $b = 9.210340372$\n\nWe can now calculate $E_{a}$ and $\\sigma_{0}$.\nFrom the slope:\n$$\nE_{a} = -m \\cdot k_{B}\n$$\nSubstituting the given values:\n$$\nE_{a} = -(-3.481355436 \\times 10^{3} \\ \\mathrm{K}) \\times (8.617333262 \\times 10^{-5} \\ \\mathrm{eV/K})\n$$\n$$\nE_{a} = 0.2999999999... \\ \\mathrm{eV}\n$$\nRounding to four significant figures, we get $E_{a} = 0.3000 \\ \\mathrm{eV}$.\n\nFrom the intercept:\n$$\n\\sigma_{0} = \\exp(b)\n$$\nSubstituting the given value for $b$:\n$$\n\\sigma_{0} = \\exp(9.210340372)\n$$\nSince $\\ln(10^{4}) = 4 \\ln(10) \\approx 4 \\times 2.302585 = 9.21034$, the value of $b$ corresponds to $\\ln(10000)$.\n$$\n\\sigma_{0} = 10000.0... \\ \\mathrm{S/m}\n$$\nRounding to four significant figures, we get $\\sigma_{0} = 1.000 \\times 10^{4} \\ \\mathrm{S/m}$.\n\nPhysical Interpretation:\n- **Activation Energy ($E_{a}$)**: In this context, where the mobile ion concentration is constant, $E_{a}$ represents the migration enthalpy. It is the minimum kinetic energy a mobile cation must possess to overcome the electrostatic potential energy barrier created by the surrounding lattice ions and hop into an adjacent, equivalent, vacant site. It is a direct measure of the difficulty of ionic motion through the crystal structure.\n- **Pre-exponential Factor ($\\sigma_{0}$)**: This factor represents the theoretical conductivity at infinite temperature, where the exponential term becomes unity. It consolidates several material-specific parameters: $\\sigma_{0} \\propto n q^{2} a^{2} \\nu_{0}$. Physically, it depends on the number of available charge carriers ($n$), their charge squared ($q^{2}$), the geometry of the hopping path (jump distance $a$ and structural factors), and the characteristic frequency at which ions attempt to hop ($\\nu_{0}$, the attempt frequency, related to lattice vibrations). It sets the upper limit for the conductivity for a given transport mechanism.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.3000  1.000 \\times 10^4\n\\end{pmatrix}\n}\n$$", "id": "2858758"}, {"introduction": "A deeper understanding of ionic transport requires moving beyond the independent-particle approximation and considering the collective, correlated motion of ions. This advanced computational practice challenges you to connect the fundamental Green-Kubo relations of statistical mechanics to practical data analysis of molecular dynamics (MD) simulations [@problem_id:2831047]. By implementing an algorithm to compute velocity correlation functions, you will calculate the Haven ratio, a key parameter that quantifies the degree of cooperativity in ionic motion and distinguishes mass transport from charge transport.", "problem": "You are given deterministic Molecular Dynamics (MD) velocity time series for identical monovalent ions in a three-dimensional crystalline solid. Your task is to start from fundamental fluctuation-dissipation relations and construct a program that separates the self and distinct contributions to multi-particle velocity correlation functions in order to compute the tracer diffusivity and the Haven ratio for several synthetic test cases.\n\nUse the following well-tested and widely accepted starting points as the foundation for your derivation and algorithm design, without assuming any shortcut expressions beyond these bases:\n\n- The Green–Kubo (GK) relation for ionic conductivity states that the macroscopic conductivity is proportional to the time integral of the equilibrium autocorrelation of the microscopic charge current. For a single ionic species of charge $q$ and number density $n$, the microscopic current is $\\mathbf{J}(t)=q\\sum_{i=1}^{N}\\mathbf{v}_i(t)$ and the conductivity satisfies\n  $$\n  \\sigma=\\frac{1}{3Vk_{\\mathrm{B}}T}\\int_{0}^{\\infty}\\langle\\mathbf{J}(0)\\cdot\\mathbf{J}(t)\\rangle\\,dt,\n  $$\n  where $V$ is volume, $T$ is temperature, and $k_{\\mathrm{B}}$ is Boltzmann’s constant.\n- The tracer diffusivity $D_{\\mathrm{tr}}$ can be obtained from the velocity autocorrelation function (VACF) of a tagged ion via the fluctuation–dissipation theorem:\n  $$\n  D_{\\mathrm{tr}}=\\frac{1}{3}\\int_{0}^{\\infty}\\langle\\mathbf{v}_i(0)\\cdot\\mathbf{v}_i(t)\\rangle\\,dt,\n  $$\n  where the average is over equilibrium initial conditions and ion index $i$ for identical particles.\n- The Nernst–Einstein (NE) diffusivity $D_{\\sigma}$ is defined by $\\sigma=nq^2D_{\\sigma}/(k_{\\mathrm{B}}T)$.\n\nFrom these bases, derive a decomposition that isolates the self and distinct parts of the velocity correlation matrix to relate $D_{\\mathrm{tr}}$ and $D_{\\sigma}$ to time integrals over these correlations, and thereby define the Haven ratio $H_R$ as a dimensionless measure of correlation between ions. Implement a numerically stable discrete-time algorithm that estimates the required correlation functions from the provided finite-length velocity trajectories, and uses a consistent time-integration rule over the available correlation window.\n\nDiscrete-time definitions and requirements:\n\n- You are given $N$ ions, discrete times $t_m=m\\Delta t$ for $m\\in\\{0,1,\\dots,M-1\\}$ with time step $\\Delta t$, and velocity vectors $\\mathbf{v}_i(t_m)\\in\\mathbb{R}^3$ in SI units. For any nonnegative integer lag $k$, define the unbiased discrete cross-correlation estimator\n  $$\n  C_{ij}(k)=\\frac{1}{M-k}\\sum_{m=0}^{M-k-1}\\mathbf{v}_i(t_m)\\cdot\\mathbf{v}_j(t_{m+k}).\n  $$\n- Define the per-lag self and total velocity correlation scalars\n  $$\n  Z_{\\mathrm{self}}(k)=\\frac{1}{3N}\\sum_{i=1}^{N}C_{ii}(k),\\quad Z_{\\mathrm{tot}}(k)=\\frac{1}{3N}\\sum_{i=1}^{N}\\sum_{j=1}^{N}C_{ij}(k).\n  $$\n  The distinct contribution is $Z_{\\mathrm{distinct}}(k)=Z_{\\mathrm{tot}}(k)-Z_{\\mathrm{self}}(k)$.\n- Use the trapezoidal rule over the available nonnegative lags to approximate the time integrals:\n  $$\n  D_{\\mathrm{tr}}\\approx\\Delta t\\left(\\frac{Z_{\\mathrm{self}}(0)}{2}+\\sum_{k=1}^{M-2}Z_{\\mathrm{self}}(k)+\\frac{Z_{\\mathrm{self}}(M-1)}{2}\\right),\n  $$\n  $$\n  D_{\\sigma}\\approx\\Delta t\\left(\\frac{Z_{\\mathrm{tot}}(0)}{2}+\\sum_{k=1}^{M-2}Z_{\\mathrm{tot}}(k)+\\frac{Z_{\\mathrm{tot}}(M-1)}{2}\\right).\n  $$\n  Then the Haven ratio is\n  $$\n  H_R=\\frac{D_{\\mathrm{tr}}}{D_{\\sigma}}.\n  $$\n\nTest suite (three cases; all quantities are deterministic and in SI units):\n\nFor all cases, define the scalar speed profile\n$$\ns(t)=A\\,e^{-\\gamma t}\\cos(\\omega t),\n$$\nwith $A=100\\,\\mathrm{m/s}$, $\\gamma=5\\times 10^{11}\\,\\mathrm{s}^{-1}$, $\\omega=1\\times 10^{12}\\,\\mathrm{rad/s}$, time step $\\Delta t=5\\times 10^{-15}\\,\\mathrm{s}$, and $M=2001$ samples (so the maximum time is $(M-1)\\Delta t=1.0005\\times 10^{-11}\\,\\mathrm{s}$). For each ion $i$, the velocity is\n$$\n\\mathbf{v}_i(t_m)=s(t_m)\\,\\mathbf{u}_i,\n$$\nwhere $\\mathbf{u}_i$ is a constant unit vector specifying the direction of motion for ion $i$.\n\n- Case A (uncorrelated distinct motion by orthogonality): $N=3$ with $\\mathbf{u}_1=(1,0,0)$, $\\mathbf{u}_2=(0,1,0)$, $\\mathbf{u}_3=(0,0,1)$.\n- Case B (maximally correlated distinct motion): $N=4$ with $\\mathbf{u}_i=(1,0,0)$ for all $i\\in\\{1,2,3,4\\}$.\n- Case C (maximally anticorrelated distinct motion with zero net current): $N=4$ with $\\mathbf{u}_1=\\mathbf{u}_2=(1,0,0)$ and $\\mathbf{u}_3=\\mathbf{u}_4=(-1,0,0)$.\n\nYour program must:\n\n- Construct the velocity arrays $\\mathbf{v}_i(t_m)$ for each case exactly as defined.\n- Compute $C_{ij}(k)$, $Z_{\\mathrm{self}}(k)$, and $Z_{\\mathrm{tot}}(k)$ over all nonnegative lags $k\\in\\{0,1,\\dots,M-1\\}$.\n- Compute $D_{\\mathrm{tr}}$ and $H_R$ as above. Express $D_{\\mathrm{tr}}$ in $\\mathrm{m}^2/\\mathrm{s}$ and $H_R$ as a pure number. Round each $D_{\\mathrm{tr}}$ to six significant figures and each $H_R$ to six digits after the decimal point.\n- Output format: Your program should produce a single line of output containing all six results as a comma-separated list enclosed in square brackets in the order\n  $$\n  [D_{\\mathrm{tr}}^{(A)},H_R^{(A)},D_{\\mathrm{tr}}^{(B)},H_R^{(B)},D_{\\mathrm{tr}}^{(C)},H_R^{(C)}].\n  $$\n\nAll computations must be performed using the definitions above, without using any external data. Ensure scientific realism by adhering strictly to the specified units and definitions. The answers for each test case must be numeric floats. The three cases together are chosen to test: a baseline with vanishing distinct correlations, a maximally correlated regime, and a maximally anticorrelated regime.", "solution": "The problem statement is first subjected to a rigorous validation process. All provided definitions, including the Green-Kubo relation for conductivity, the definitions for tracer and Nernst-Einstein diffusivities, and the discrete estimators for correlation functions, are standard and well-established in the field of statistical mechanics and materials physics. The parameters for the synthetic test cases are clearly defined, dimensionally consistent, and physically plausible within the context of a simplified model. The problem is self-contained, mathematically well-posed, and free from scientific or logical contradictions. It is therefore deemed valid, and we may proceed with a formal derivation and solution.\n\nThe objective is to compute the tracer diffusivity, `$D_{\\mathrm{tr}}$`, and the Haven ratio, `$H_R = D_{\\mathrm{tr}}/D_{\\sigma}$`, from molecular dynamics data. The solution requires a derivation that connects the macroscopic transport coefficients to the microscopic velocity correlation functions.\n\nWe begin with the Green-Kubo relation for the DC ionic conductivity, `$\\sigma$`:\n$$\n\\sigma=\\frac{1}{3Vk_{\\mathrm{B}}T}\\int_{0}^{\\infty}\\langle\\mathbf{J}(0)\\cdot\\mathbf{J}(t)\\rangle\\,dt\n$$\nThe microscopic charge current `$\\mathbf{J}(t)$` for `$N$` identical monovalent ions of charge `$q$` is given by `$\\mathbf{J}(t)=q\\sum_{i=1}^{N}\\mathbf{v}_i(t)$`. Substituting this into the expression for `$\\sigma$` yields:\n$$\n\\sigma=\\frac{q^2}{3Vk_{\\mathrm{B}}T}\\int_{0}^{\\infty}\\left\\langle \\left(\\sum_{i=1}^{N}\\mathbf{v}_i(0)\\right)\\cdot\\left(\\sum_{j=1}^{N}\\mathbf{v}_j(t)\\right) \\right\\rangle\\,dt\n$$\nBy linearity of the ensemble average `$\\langle \\cdot \\rangle$`, we can move the summation outside:\n$$\n\\sigma=\\frac{q^2}{3Vk_{\\mathrm{B}}T}\\int_{0}^{\\infty} \\sum_{i=1}^{N}\\sum_{j=1}^{N} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_j(t) \\rangle \\,dt\n$$\nNext, we use the Nernst-Einstein relation, which defines the diffusivity `$D_{\\sigma}$` via `$\\sigma = nq^2D_{\\sigma}/(k_{\\mathrm{B}}T)$`, where `$n=N/V$` is the number density of the ions. Equating the two expressions for `$\\sigma$` gives:\n$$\n\\frac{Nq^2}{Vk_{\\mathrm{B}}T} D_{\\sigma} = \\frac{q^2}{3Vk_{\\mathrm{B}}T}\\int_{0}^{\\infty} \\sum_{i=1}^{N}\\sum_{j=1}^{N} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_j(t) \\rangle \\,dt\n$$\nCanceling the common prefactors `$q^2/(Vk_{\\mathrm{B}}T)$` on both sides leaves:\n$$\nN D_{\\sigma} = \\frac{1}{3} \\int_{0}^{\\infty} \\sum_{i=1}^{N}\\sum_{j=1}^{N} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_j(t) \\rangle \\,dt\n$$\nIsolating `$D_{\\sigma}$`, we obtain the expression for the Nernst-Einstein diffusivity in terms of the total velocity correlation function:\n$$\nD_{\\sigma} = \\frac{1}{3N} \\int_{0}^{\\infty} \\sum_{i=1}^{N}\\sum_{j=1}^{N} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_j(t) \\rangle \\,dt\n$$\nThe double summation can be split into a \"self\" part (where `$i=j$`) and a \"distinct\" part (where `$i \\neq j$`):\n$$\nD_{\\sigma} = \\frac{1}{3N} \\int_{0}^{\\infty} \\left( \\sum_{i=1}^{N} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_i(t) \\rangle + \\sum_{i=1}^{N}\\sum_{j \\neq i}^{N} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_j(t) \\rangle \\right) \\,dt\n$$\nSince all ions are identical, the single-particle velocity autocorrelation function (VACF) `$\\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_i(t) \\rangle$` is the same for all ions `$i$`. The summation `$\\sum_{i=1}^{N}$` simply yields `$N$` times this value. We can therefore write:\n$$\nD_{\\sigma} = \\frac{1}{3} \\int_{0}^{\\infty} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_i(t) \\rangle \\,dt + \\frac{1}{3N} \\int_{0}^{\\infty} \\sum_{i=1}^{N}\\sum_{j \\neq i}^{N} \\langle \\mathbf{v}_i(0)\\cdot\\mathbf{v}_j(t) \\rangle \\,dt\n$$\nThe first term is precisely the definition of the tracer diffusivity, `$D_{\\mathrm{tr}}$`. This reveals the fundamental decomposition:\n$$\nD_{\\sigma} = D_{\\mathrm{tr}} + D_{\\mathrm{distinct}}\n$$\nwhere `$D_{\\mathrm{distinct}}$` represents the contribution from correlations between different ions. The Haven ratio, `$H_R = D_{\\mathrm{tr}} / D_{\\sigma}$`, is then:\n$$\nH_R = \\frac{D_{\\mathrm{tr}}}{D_{\\sigma}} = \\frac{D_{\\mathrm{tr}}}{D_{\\mathrm{tr}} + D_{\\mathrm{distinct}}} = \\frac{1}{1 + D_{\\mathrm{distinct}}/D_{\\mathrm{tr}}}\n$$\nThis ratio quantifies the degree of correlation in the ionic motion. `$H_R=1$` indicates uncorrelated motion, `$0 \\le H_R  1$` indicates positive velocity correlations (as in a vacancy mechanism where a backward jump is likely), and `$H_R  1$` indicates negative velocity correlations.\n\nFor numerical implementation, we use the provided discrete estimators. The core calculation is the cross-correlation `$C_{ij}(k)$`. The problem specifies a highly structured velocity profile: `$\\mathbf{v}_i(t_m)=s(t_m)\\,\\mathbf{u}_i$`. This allows for a significant simplification.\nThe dot product inside the summation for `$C_{ij}(k)$` becomes:\n$$\n\\mathbf{v}_i(t_m)\\cdot\\mathbf{v}_j(t_{m+k}) = \\left(s(t_m)\\mathbf{u}_i\\right) \\cdot \\left(s(t_{m+k})\\mathbf{u}_j\\right) = s(t_m)s(t_{m+k}) (\\mathbf{u}_i \\cdot \\mathbf{u}_j)\n$$\nSubstituting this into the definition of `$C_{ij}(k)$`:\n$$\nC_{ij}(k) = (\\mathbf{u}_i \\cdot \\mathbf{u}_j) \\left( \\frac{1}{M-k}\\sum_{m=0}^{M-k-1} s(t_m)s(t_{m+k}) \\right)\n$$\nLet us define the scalar speed autocorrelation function `$S(k) = \\frac{1}{M-k}\\sum_{m=0}^{M-k-1} s(t_m)s(t_{m+k})$`. Then `$C_{ij}(k) = (\\mathbf{u}_i \\cdot \\mathbf{u}_j) S(k)$`.\n\nNow, we can write the per-lag scalars `$Z_{\\mathrm{self}}(k)$` and `$Z_{\\mathrm{tot}}(k)$`:\n$$\nZ_{\\mathrm{self}}(k)=\\frac{1}{3N}\\sum_{i=1}^{N}C_{ii}(k) = \\frac{1}{3N}\\sum_{i=1}^{N}(\\mathbf{u}_i\\cdot\\mathbf{u}_i) S(k)\n$$\nSince `$\\mathbf{u}_i$` are unit vectors, `$\\mathbf{u}_i\\cdot\\mathbf{u}_i = 1$`. Thus:\n$$\nZ_{\\mathrm{self}}(k) = \\frac{1}{3N} (N \\cdot 1) S(k) = \\frac{1}{3}S(k)\n$$\nThis demonstrates that `$Z_{\\mathrm{self}}(k)$` and therefore `$D_{\\mathrm{tr}}$` are identical for all three test cases, as they depend only on the common speed profile `$s(t)$`.\n\nFor `$Z_{\\mathrm{tot}}(k)$`:\n$$\nZ_{\\mathrm{tot}}(k)=\\frac{1}{3N}\\sum_{i=1}^{N}\\sum_{j=1}^{N}C_{ij}(k) = \\frac{S(k)}{3N} \\sum_{i=1}^{N}\\sum_{j=1}^{N}(\\mathbf{u}_i \\cdot \\mathbf{u}_j)\n$$\nLet `$U = \\sum_{i,j}(\\mathbf{u}_i \\cdot \\mathbf{u}_j)$`. Then the Nernst-Einstein diffusivity is `$D_{\\sigma} = (U/N) D_{\\mathrm{tr}}$`. This implies that the Haven ratio is `$H_R = D_{\\mathrm{tr}} / D_{\\sigma} = N / U$` (for `$U \\neq 0$).\n\nWe can now predict the Haven ratio for each case:\n- Case A: `$N=3$`, `$\\{\\mathbf{u}_i\\}$` are orthogonal. `$\\mathbf{u}_i \\cdot \\mathbf{u}_j = \\delta_{ij}$`. Thus, `$U_A = \\sum_{i,j}\\delta_{ij} = \\sum_i 1 = N = 3$`. The Haven ratio is `$H_{R,A} = N/U_A = 3/3 = 1$`.\n- Case B: `$N=4$`, `$\\{\\mathbf{u}_i\\}$` are all identical. `$\\mathbf{u}_i \\cdot \\mathbf{u}_j = 1$`. Thus, `$U_B = \\sum_{i,j} 1 = N^2 = 16$`. The Haven ratio is `$H_{R,B} = N/U_B = 4/16 = 0.25$`.\n- Case C: `$N=4$`, two vectors are `$(1,0,0)$` and two are `$(-1,0,0)$`. The sum of all dot products is `$U_C = 4(1) + 4(1) + 4(-1) + 4(-1) = 0$`. The Haven ratio `$H_{R,C} = N/U_C = 4/0$` is undefined. This pathological case arises because the net charge transport is exactly zero (`$D_\\sigma = 0$`).\n\nThe algorithm will first compute `$s(t)$`. Then, it will compute `$S(k)$` for all lags `$k$`, which determines `$Z_{\\mathrm{self}}(k)$`. Integrating `$Z_{\\mathrm{self}}(k)` via the trapezoidal rule yields `$D_{\\mathrm{tr}}$`. For each case, the scalar factor `$U$` is computed, which determines `$D_{\\sigma}$`, and finally `$H_R$` is calculated. The final numerical results will be rounded as specified.", "answer": "```python\nimport numpy as np\nimport math\n\ndef round_to_significant_figures(x, p):\n    \"\"\"\n    Rounds a number x to p significant figures.\n    \"\"\"\n    if x == 0:\n        return 0.0\n    if not np.isfinite(x):\n        return x\n    magnitude = math.floor(math.log10(abs(x)))\n    precision = p - 1 - magnitude\n    return round(x, precision)\n\ndef solve():\n    \"\"\"\n    Computes tracer diffusivity and Haven ratio for three synthetic test cases.\n    \"\"\"\n    #\n    # === Problem Parameters ===\n    # All are in SI units.\n    #\n    A = 100.0  # m/s\n    gamma = 5e11  # s^-1\n    omega = 1e12  # rad/s\n    dt = 5e-15  # s\n    M = 2001  # number of samples\n\n    #\n    # === Test Case Definitions ===\n    #\n    test_cases = [\n        # Case A: Uncorrelated distinct motion\n        {\"N\": 3, \"u_vectors\": np.array([[1.0, 0.0, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]])},\n        # Case B: Maximally correlated distinct motion\n        {\"N\": 4, \"u_vectors\": np.array([[1.0, 0.0, 0.0], [1.0, 0.0, 0.0], [1.0, 0.0, 0.0], [1.0, 0.0, 0.0]])},\n        # Case C: Maximally anticorrelated distinct motion\n        {\"N\": 4, \"u_vectors\": np.array([[1.0, 0.0, 0.0], [1.0, 0.0, 0.0], [-1.0, 0.0, 0.0], [-1.0, 0.0, 0.0]])}\n    ]\n\n    #\n    # === Common Computations (Independent of Test Case) ===\n    #\n    t = np.arange(M) * dt\n    s = A * np.exp(-gamma * t) * np.cos(omega * t)\n\n    S_k = np.zeros(M)\n    for k in range(M):\n        if M - k > 0:\n            sum_of_products = np.dot(s[:M - k], s[k:])\n            S_k[k] = sum_of_products / (M - k)\n    \n    Z_self = S_k / 3.0\n    D_tr_val = np.trapz(Z_self, dx=dt)\n    \n    #\n    # === Per-Case Computations ===\n    #\n    results = []\n    \n    for case in test_cases:\n        N = case[\"N\"]\n        u_vectors = case[\"u_vectors\"]\n        \n        dot_product_matrix = u_vectors @ u_vectors.T\n        U = np.sum(dot_product_matrix)\n\n        if N > 0:\n             Z_tot = (U / N) * Z_self\n        else:\n             Z_tot = np.zeros_like(Z_self)\n\n        D_sigma_val = np.trapz(Z_tot, dx=dt)\n        \n        if abs(D_sigma_val)  1e-20: # Treat as zero to avoid floating point issues and handle Case C\n            H_R_val = np.inf\n        else:\n            H_R_val = D_tr_val / D_sigma_val\n\n        D_tr_rounded = round_to_significant_figures(D_tr_val, 6)\n        H_R_rounded = round(H_R_val, 6)\n        \n        results.append(D_tr_rounded)\n        results.append(H_R_rounded)\n\n    #\n    # === Final Output ===\n    #\n    output_str = f\"[{results[0]},{results[1]},{results[2]},{results[3]},{results[4]},{results[5]}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2831047"}]}