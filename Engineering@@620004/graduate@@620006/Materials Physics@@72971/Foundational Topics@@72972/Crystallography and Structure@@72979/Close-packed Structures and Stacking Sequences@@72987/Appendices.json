{"hands_on_practices": [{"introduction": "Mastering crystallography begins with a firm grasp of the geometric first principles that govern close-packed structures. This foundational exercise challenges you to derive the essential relationships between atomic size and unit cell dimensions for both the face-centered cubic (FCC) and hexagonal close-packed (HCP) structures from the ground up. By demonstrating that both structures achieve the same maximum packing density, you will solidify your understanding of why they are so prevalent in nature [@problem_id:2808480].", "problem": "A monatomic crystal is modeled as a dense packing of identical rigid spheres of radius $r$ arranged in close-packed stacking sequences. Consider the two canonical close-packed structures: Face-Centered Cubic (fcc) with ABC stacking and Hexagonal Close-Packed (hcp) with AB stacking. For the fcc structure, let $a_{\\mathrm{fcc}}$ denote the conventional cubic lattice parameter. For the hcp structure, let $a_{\\mathrm{hcp}}$ denote the basal-plane lattice parameter and $c$ denote the out-of-plane lattice parameter of the conventional hexagonal unit cell. Starting from the geometric definition of close-packed triangular layers of touching spheres and the conventional definitions of $a_{\\mathrm{fcc}}$, $a_{\\mathrm{hcp}}$, and $c$, do the following without invoking any pre-memorized structure-specific formulas:\n\n- Derive the relationships between $r$ and $a_{\\mathrm{fcc}}$ for the fcc structure, and between $r$ and $a_{\\mathrm{hcp}}$ for the hcp structure.\n- Using the hard-sphere stacking geometry, determine the ideal ratio $c/a_{\\mathrm{hcp}}$ for the hcp structure.\n- Using only geometric facts and the above relations, compute the packing fraction $\\eta$ (the fraction of unit-cell volume occupied by the spheres) for each conventional unit cell and demonstrate that the two values coincide. Express the common analytic value.\n\nReport your final result as a single row matrix containing, in order, the three exact expressions $(r/a_{\\mathrm{fcc}},\\, r/a_{\\mathrm{hcp}},\\, \\eta)$. Do not round. No units are required because all quantities are dimensionless ratios or pure numbers.", "solution": "The problem statement presented is a standard, well-posed exercise in solid-state physics and crystallography. It is scientifically grounded, self-contained, and free of contradictions or ambiguities. It requests fundamental derivations based on geometric first principles, which is a valid and instructive task. We may proceed with the solution.\n\nThe problem requires the derivation of geometric relationships and the packing fraction for the Face-Centered Cubic (fcc) and Hexagonal Close-Packed (hcp) structures, modeling atoms as identical rigid spheres of radius $r$.\n\nFirst, we analyze the fcc structure. The conventional unit cell is a cube with lattice parameter $a_{\\mathrm{fcc}}$. Atoms are located at the $8$ corners and in the center of the $6$ faces. In a close-packed structure, the spheres are in contact. Within the fcc unit cell, the spheres touch along the face diagonal. A face diagonal connects two opposite corners of a face, passing through the atom at the face center. The length of this diagonal accommodates the radius of the corner atom, the diameter of the face-centered atom, and the radius of the other corner atom. Thus, the length of the face diagonal is $r + 2r + r = 4r$.\nFrom the geometry of a cube with side length $a_{\\mathrm{fcc}}$, the length of the face diagonal is given by the Pythagorean theorem: $\\sqrt{a_{\\mathrm{fcc}}^2 + a_{\\mathrm{fcc}}^2} = a_{\\mathrm{fcc}}\\sqrt{2}$.\nEquating these two expressions for the face diagonal length gives:\n$$a_{\\mathrm{fcc}}\\sqrt{2} = 4r$$\nThis establishes the relationship between the sphere radius $r$ and the lattice parameter $a_{\\mathrm{fcc}}$. From this, we derive the requested ratio $r/a_{\\mathrm{fcc}}$:\n$$\\frac{r}{a_{\\mathrm{fcc}}} = \\frac{\\sqrt{2}}{4} = \\frac{1}{2\\sqrt{2}}$$\n\nNext, we analyze the hcp structure. An hcp structure is formed by stacking close-packed planes in an ABAB... sequence. The conventional unit cell is a right prism with a hexagonal base. The lattice parameters are $a_{\\mathrm{hcp}}$ for the side length of the hexagonal base and $c$ for the height of the prism.\nIn the basal plane (e.g., the A layer), the atoms are arranged in a close-packed triangular lattice. The centers of adjacent, touching spheres are separated by a distance of $2r$. This distance corresponds to the lattice parameter $a_{\\mathrm{hcp}}$.\n$$a_{\\mathrm{hcp}} = 2r$$\nFrom this, the ratio $r/a_{\\mathrm{hcp}}$ is immediately:\n$$\\frac{r}{a_{\\mathrm{hcp}}} = \\frac{1}{2}$$\n\nNow, we determine the ideal ratio $c/a_{\\mathrm{hcp}}$. This ratio is determined by the spacing between the close-packed planes. A sphere in the B layer rests in the hollow formed by three touching spheres in the A layer. Let the centers of the three spheres in the A layer be at positions $A_1$, $A_2$, and $A_3$, and the center of the sphere in the B layer be at position $B$. These four points form a regular tetrahedron, as all spheres are in contact. The edge length of this tetrahedron is the distance between the centers of any two touching spheres, which is $2r = a_{\\mathrm{hcp}}$.\nThe height of this tetrahedron is the perpendicular distance from the B layer to the A layer, which is exactly half the height of the conventional unit cell, $c/2$.\nWe can calculate the height of a regular tetrahedron with side length $s = a_{\\mathrm{hcp}}$. The apex of the tetrahedron (point $B$) projects onto the center (centroid) of the equilateral triangular base formed by $A_1$, $A_2$, and $A_3$. The distance from any vertex of an equilateral triangle of side $s$ to its centroid is $d = \\frac{s}{\\sqrt{3}}$.\nUsing the Pythagorean theorem, the height $h_t$ of the tetrahedron satisfies $s^2 = h_t^2 + d^2$.\n$$h_t^2 = s^2 - \\left(\\frac{s}{\\sqrt{3}}\\right)^2 = s^2 - \\frac{s^2}{3} = \\frac{2s^2}{3}$$\n$$h_t = s\\sqrt{\\frac{2}{3}}$$\nSubstituting $h_t = c/2$ and $s = a_{\\mathrm{hcp}}$:\n$$\\frac{c}{2} = a_{\\mathrm{hcp}}\\sqrt{\\frac{2}{3}}$$\nThis gives the ideal $c/a_{\\mathrm{hcp}}$ ratio:\n$$\\frac{c}{a_{\\mathrm{hcp}}} = 2\\sqrt{\\frac{2}{3}} = \\sqrt{\\frac{8}{3}}$$\n\nFinally, we compute the packing fraction, $\\eta$, for both structures. The packing fraction is defined as the total volume of spheres within a unit cell divided by the volume of the unit cell itself, $\\eta = N V_{\\text{sphere}} / V_{\\text{cell}}$. The volume of a single sphere is $V_{\\text{sphere}} = \\frac{4}{3}\\pi r^3$.\n\nFor the fcc structure:\nThe number of atoms per conventional unit cell, $N_{\\mathrm{fcc}}$, is $8$ corner atoms $\\times$ ($1/8$ per cell) + $6$ face atoms $\\times$ ($1/2$ per cell) = $1 + 3 = 4$.\nThe volume of the unit cell is $V_{\\mathrm{fcc}} = a_{\\mathrm{fcc}}^3$. Using our derived relation $a_{\\mathrm{fcc}} = 2\\sqrt{2}r$:\n$$V_{\\mathrm{fcc}} = (2\\sqrt{2}r)^3 = 8 \\cdot 2\\sqrt{2} r^3 = 16\\sqrt{2}r^3$$\nThe packing fraction $\\eta_{\\mathrm{fcc}}$ is:\n$$\\eta_{\\mathrm{fcc}} = \\frac{N_{\\mathrm{fcc}} V_{\\text{sphere}}}{V_{\\mathrm{fcc}}} = \\frac{4 \\cdot \\frac{4}{3}\\pi r^3}{16\\sqrt{2}r^3} = \\frac{\\frac{16}{3}\\pi r^3}{16\\sqrt{2}r^3} = \\frac{\\pi}{3\\sqrt{2}}$$\n\nFor the hcp structure:\nThe number of atoms per conventional hexagonal unit cell, $N_{\\mathrm{hcp}}$, is $12$ corner atoms $\\times$ ($1/6$ per cell) + $2$ face-center atoms $\\times$ ($1/2$ per cell) + $3$ interior atoms = $2 + 1 + 3 = 6$.\nThe volume of the hexagonal unit cell, $V_{\\mathrm{hcp}}$, is the area of its hexagonal base multiplied by its height $c$. The base is composed of $6$ equilateral triangles of side length $a_{\\mathrm{hcp}}$. The area of one such triangle is $\\frac{\\sqrt{3}}{4} a_{\\mathrm{hcp}}^2$.\nThe area of the base is $A_{\\text{base}} = 6 \\cdot \\frac{\\sqrt{3}}{4} a_{\\mathrm{hcp}}^2 = \\frac{3\\sqrt{3}}{2} a_{\\mathrm{hcp}}^2$.\nThe cell volume is $V_{\\mathrm{hcp}} = A_{\\text{base}} \\cdot c = \\frac{3\\sqrt{3}}{2} a_{\\mathrm{hcp}}^2 \\cdot c$.\nUsing $c = a_{\\mathrm{hcp}}\\sqrt{8/3}$:\n$$V_{\\mathrm{hcp}} = \\frac{3\\sqrt{3}}{2} a_{\\mathrm{hcp}}^2 \\left( a_{\\mathrm{hcp}}\\sqrt{\\frac{8}{3}} \\right) = \\frac{3\\sqrt{3}}{2} a_{\\mathrm{hcp}}^3 \\frac{2\\sqrt{2}}{\\sqrt{3}} = 3\\sqrt{2} a_{\\mathrm{hcp}}^3$$\nNow substitute $a_{\\mathrm{hcp}} = 2r$:\n$$V_{\\mathrm{hcp}} = 3\\sqrt{2} (2r)^3 = 3\\sqrt{2} \\cdot 8r^3 = 24\\sqrt{2}r^3$$\nThe packing fraction $\\eta_{\\mathrm{hcp}}$ is:\n$$\\eta_{\\mathrm{hcp}} = \\frac{N_{\\mathrm{hcp}} V_{\\text{sphere}}}{V_{\\mathrm{hcp}}} = \\frac{6 \\cdot \\frac{4}{3}\\pi r^3}{24\\sqrt{2}r^3} = \\frac{8\\pi r^3}{24\\sqrt{2}r^3} = \\frac{\\pi}{3\\sqrt{2}}$$\nAs demonstrated, the packing fractions are identical: $\\eta_{\\mathrm{fcc}} = \\eta_{\\mathrm{hcp}} = \\frac{\\pi}{3\\sqrt{2}}$. This result is expected, as both fcc and hcp are different stacking sequences of the same close-packed planes, leading to the same maximum possible packing density for identical spheres.\n\nThe final result is the ordered set of expressions for $r/a_{\\mathrm{fcc}}$, $r/a_{\\mathrm{hcp}}$, and the common packing fraction $\\eta$.\n$r/a_{\\mathrm{fcc}} = \\frac{\\sqrt{2}}{4}$\n$r/a_{\\mathrm{hcp}} = \\frac{1}{2}$\n$\\eta = \\frac{\\pi}{3\\sqrt{2}}$\nThese are the required exact analytical values.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\sqrt{2}}{4} & \\frac{1}{2} & \\frac{\\pi}{3\\sqrt{2}} \\end{pmatrix}}$$", "id": "2808480"}, {"introduction": "While ideal FCC and HCP structures provide a vital baseline, many materials exhibit more complex stacking sequences known as polytypes, or contain planar defects called stacking faults. To understand and classify these variations, we need a quantitative language. This practice introduces a powerful method for analyzing any stacking sequence by calculating its \"fault density,\" which measures its deviation from a perfect reference structure [@problem_id:2808526]. This skill is crucial for characterizing real materials and relating their structure to their physical behavior.", "problem": "A close-packed stacking sequence can be represented by a string over three lateral registries $\\{A,B,C\\}$, with successive layers occupying positions such that no two adjacent layers share the same letter. In a perfect face-centered cubic (FCC) polytype the stacking is periodic with three-layer period and constant cyclic sense (one of the two chiralities of $A \\to B \\to C \\to A$), whereas in a perfect hexagonal close-packed (HCP) polytype the stacking is periodic with two-layer period and the cyclic sense alternates at every step.\n\nConsider the infinite polytype whose stacking is the periodic repetition of the $9$-layer block\n$$\n\\mathrm{A\\,B\\,C\\,B\\,C\\,A\\,C\\,A\\,B}\n$$\ni.e., the infinite sequence is $\\cdots A\\,B\\,C\\,B\\,C\\,A\\,C\\,A\\,B\\,A\\,B\\,C\\,B\\,C\\,A\\,C\\,A\\,B \\cdots$.\n\nDefine the fault density as follows: adopt periodic boundary conditions over the $9$-layer block so that there are $9$ layer-to-layer boundaries per period. For a chosen ideal target among FCC or HCP (including both chiralities for FCC and both starting parities for HCP), count the minimal number of layer-to-layer boundaries per period that would have to be altered to convert the given sequence exactly into that ideal target. Then normalize this minimal count by the number of layers per period. Among the FCC and HCP targets, the fault density is the minimum of the two normalized counts.\n\nUsing only the above definition and the standard crystallographic interpretation of cyclic sense along $A \\to B \\to C \\to A$, determine the fault density of this polytype as a single number in units of faults per layer. Express your answer as a reduced fraction. No rounding is required.", "solution": "The problem requires the calculation of the fault density for a given $9$-layer periodic stacking sequence. First, the problem is validated.\n\nThe givens are:\n1.  The stacking sequence is a string over the set $\\{A, B, C\\}$.\n2.  Adjacent layers in the sequence cannot be the same.\n3.  An ideal face-centered cubic (FCC) structure has a three-layer period with constant cyclic sense.\n4.  An ideal hexagonal close-packed (HCP) structure has a two-layer period with alternating cyclic sense.\n5.  The polytype under consideration is the infinite periodic repetition of the $9$-layer block $S = A\\,B\\,C\\,B\\,C\\,A\\,C\\,A\\,B$.\n6.  The fault density calculation uses periodic boundary conditions over the $9$-layer block, resulting in $9$ layer-to-layer boundaries.\n7.  The fault-counting procedure is as follows:\n    a.  Choose an ideal target: FCC (both chiralities) or HCP (all parities).\n    b.  Count the minimal number of layer-to-layer boundaries per period that must be altered to match the target. This is the fault count, $N_{faults}$.\n    c.  Normalize this count by the number of layers per period, $L=9$.\n    d.  The fault density, $\\rho$, is the minimum of these normalized counts over all possible targets.\n\nThe problem is scientifically sound, well-posed, objective, and self-contained. The definitions, while specific to the problem, are unambiguous. The problem is valid.\n\nThe solution proceeds by first characterizing the layer-to-layer boundaries in the given sequence. A boundary between two layers, say $s_i \\to s_{i+1}$, can be classified based on the position of the next layer, $s_{i+2}$. This classification is directly related to the cyclic sense mentioned in the problem.\nIf $s_{i+2} = s_i$, the local stacking is of the form $X Y X$, which is characteristic of an HCP structure. We shall label such a boundary as 'hexagonal' or $h$-type.\nIf $s_{i+2} \\neq s_i$, the local stacking is of the form $X Y Z$, where $X, Y, Z$ are all different. This is characteristic of an FCC structure. We shall label such a boundary as 'cubic' or $c$-type.\n\nThe given $9$-layer block is $s_1s_2s_3s_4s_5s_6s_7s_8s_9 = A\\,B\\,C\\,B\\,C\\,A\\,C\\,A\\,B$. The number of layers in the period is $L=9$. We apply periodic boundary conditions, so $s_{i+9} = s_i$ for any integer $i$. We must analyze the character of the $9$ boundaries, from $s_1 \\to s_2$ up to $s_9 \\to s_1$.\n\n1.  Boundary $s_1 \\to s_2$ ($A \\to B$): The next layer is $s_3 = C$. Since $s_3 \\neq s_1$, this is a cubic ($c$-type) boundary.\n2.  Boundary $s_2 \\to s_3$ ($B \\to C$): The next layer is $s_4 = B$. Since $s_4 = s_2$, this is a hexagonal ($h$-type) boundary.\n3.  Boundary $s_3 \\to s_4$ ($C \\to B$): The next layer is $s_5 = C$. Since $s_5 = s_3$, this is a hexagonal ($h$-type) boundary.\n4.  Boundary $s_4 \\to s_5$ ($B \\to C$): The next layer is $s_6 = A$. Since $s_6 \\neq s_4$, this is a cubic ($c$-type) boundary.\n5.  Boundary $s_5 \\to s_6$ ($C \\to A$): The next layer is $s_7 = C$. Since $s_7 = s_5$, this is a hexagonal ($h$-type) boundary.\n6.  Boundary $s_6 \\to s_7$ ($A \\to C$): The next layer is $s_8 = A$. Since $s_8 = s_6$, this is a hexagonal ($h$-type) boundary.\n7.  Boundary $s_7 \\to s_8$ ($C \\to A$): The next layer is $s_9 = B$. Since $s_9 \\neq s_7$, this is a cubic ($c$-type) boundary.\n8.  Boundary $s_8 \\to s_9$ ($A \\to B$): The next layer is $s_{10} = s_1 = A$. Since $s_1 = s_8$, this is a hexagonal ($h$-type) boundary.\n9.  Boundary $s_9 \\to s_1$ ($B \\to A$): The next layer is $s_{11} = s_2 = B$. Since $s_2 = s_9$, this is a hexagonal ($h$-type) boundary.\n\nSummarizing the character of the $9$ boundaries, we have the sequence: $c, h, h, c, h, h, c, h, h$.\nLet $N_c$ be the number of cubic boundaries and $N_h$ be the number of hexagonal boundaries.\nBy counting, we find:\n$$N_c = 3_$$\n$$N_h = 6_$$\nThe total number of boundaries is $N_c + N_h = 3+6=9=L$, as expected.\n\nNow, we evaluate the number of faults with respect to the ideal targets.\nAn ideal FCC target (e.g., $ABCABCABC...$ or $ACBACBACB...$) consists exclusively of cubic boundaries. To \"convert\" the given sequence of boundaries to this ideal, one must alter every $h$-type boundary to a $c$-type boundary. The number of such alterations is the number of $h$-type boundaries.\nThus, the fault count with respect to an FCC target is:\n$$N_{faults, FCC} = N_h = 6$$\nThe normalized fault count is $\\frac{N_{faults, FCC}}{L} = \\frac{6}{9}$.\n\nAn ideal HCP target (e.g., $ABABAB...$ or $ACACAC...$ or $BCBCBC...$) consists exclusively of hexagonal boundaries. To \"convert\" the given sequence of boundaries to this ideal, one must alter every $c$-type boundary to an $h$-type boundary. The number of such alterations is the number of $c$-type boundaries.\nThus, the fault count with respect to an HCP target is:\n$$N_{faults, HCP} = N_c = 3$$\nThe normalized fault count is $\\frac{N_{faults, HCP}}{L} = \\frac{3}{9}$.\n\nAccording to the problem definition, the fault density $\\rho$ is the minimum of these two normalized counts.\n$$\\rho = \\min\\left(\\frac{6}{9}, \\frac{3}{9}\\right) = \\frac{3}{9}$$\nThe problem requests the answer as a reduced fraction.\n$$\\rho = \\frac{3}{9} = \\frac{1}{3}$$\nThe fault density is determined to be $\\frac{1}{3}$ faults per layer.", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "2808526"}, {"introduction": "The existence of a stacking fault perturbs the crystal's electronic structure, leading to an excess energy known as the intrinsic stacking fault energy ($\\gamma_{\\text{ISF}}$), a critical parameter influencing a material's mechanical properties. This advanced practice puts you in the role of a computational materials scientist, tasked with calculating $\\gamma_{\\text{ISF}}$ from a set of realistic Density Functional Theory (DFT) data [@problem_id:2808552]. You will learn to process raw simulation output and apply a physically-motivated finite-size correction model to extrapolate your results to the bulk limit, a standard and essential technique in the field.", "problem": "You are given three Density Functional Theory (DFT) pseudopotential datasets for face-centered cubic (fcc) close-packed slabs built along the $\\{111\\}$ planes. Each slab contains a single intrinsic stacking fault embedded in vacuum. Your task is to compute the intrinsic stacking fault energy $\\gamma_{\\text{ISF}}$ of each material by extrapolating the excess energy per area to infinite slab thickness using fundamental definitions and finite-size corrections consistent with isotropic linear elasticity.\n\nDefinition and physical base:\n- In a close-packed fcc lattice, the ideal stacking sequence along $\\langle 111 \\rangle$ is $ABCABC\\ldots$. An intrinsic stacking fault is a local disruption of this sequence that can be viewed as the removal of a close-packed plane, e.g., $ABCACABC\\ldots$.\n- The intrinsic stacking fault energy $\\gamma_{\\text{ISF}}$ is defined as the excess energy per unit area of a crystal containing a single intrinsic fault relative to the perfect crystal,\n  $$\n  \\gamma_{\\text{ISF}} \\equiv \\lim_{L \\to \\infty} \\frac{E_{\\text{fault}}(L) - E_{\\text{perfect}}(L)}{m A},\n  $$\n  where $E_{\\text{fault}}(L)$ and $E_{\\text{perfect}}(L)$ are the total energies of a slab of thickness $L$ (measured along the stacking direction), $A$ is the in-plane area of the two-dimensional primitive cell of the $\\{111\\}$ plane, and $m$ is the number of stacking faults contained in the periodic supercell. In the provided datasets, $m=1$ for all cases. Because both structures have the same free surfaces, the difference $E_{\\text{fault}}(L) - E_{\\text{perfect}}(L)$ removes surface energy and surface stress to leading order.\n- For a single-fault slab with traction-free parallel surfaces, the residual finite-size correction to the excess energy density arises from the long-range elastic field reflected by the free surfaces. Mirror symmetry about the slab midplane implies that only odd inverse powers of $L$ enter in the far-field expansion. Thus, the excess energy density admits an asymptotic expansion,\n  $$\n  \\gamma(L) = \\gamma_{\\infty} + \\frac{c_1}{L} + \\frac{c_3}{L^3} + \\mathcal{O}\\!\\left(\\frac{1}{L^5}\\right),\n  $$\n  where $\\gamma_{\\infty} \\equiv \\gamma_{\\text{ISF}}$ is the infinite-thickness limit that you must determine, and $c_1$, $c_3$ are material-dependent coefficients that encode elastic image interactions.\n\nGeometric base:\n- For an fcc lattice with cubic lattice parameter $a$, the interplanar spacing for $\\{111\\}$ planes is $d_{111} = a/\\sqrt{3}$, and the in-plane area of the two-dimensional primitive cell of the $\\{111\\}$ plane is $A = (\\sqrt{3}/2)\\,a^2$.\n- For a slab composed of $n$ close-packed planes, the thickness is $L = n\\,d_{111}$.\n\nComputational task:\n- For each dataset below, use the fundamental definition to compute the raw excess energy densities,\n  $$\n  \\gamma(L_i) = \\frac{E_{\\text{fault}}(L_i) - E_{\\text{perfect}}(L_i)}{m A},\n  $$\n  for the given sequence of thicknesses $L_i$ associated with the listed numbers of layers $n_i$.\n- Then, using the asymptotic expansion above grounded in isotropic linear elasticity and symmetry, determine $\\gamma_{\\infty}$ by performing a least-squares fit of $\\gamma(L)$ versus the basis $\\{1, 1/L, 1/L^3\\}$ across the provided values of $L$.\n- Report $\\gamma_{\\infty}$ in milli–Joules per square meter (mJ/m$^2$), rounded to three decimal places. Use the exact conversion factor $1~\\text{J/m}^2 = 0.06241509~\\text{eV/\\AA}^2$. Angles are not used in this problem.\n- All energies are given in electronvolts (eV), lengths in Angstroms ($\\text{\\AA}$), and areas in square Angstroms ($\\text{\\AA}^2$). Express final answers in mJ/m$^2$, rounded to three decimals.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,x_3]$), where each $x_k$ is the rounded value of $\\gamma_{\\infty}$ for dataset $k$.\n\nTest suite (all datasets have $m=1$):\n\nDataset 1:\n- Cubic lattice parameter: $a = 4.05~\\text{\\AA}$.\n- Numbers of close-packed layers: $n = [8, 10, 14, 18, 24]$.\n- Perfect slab total energies (eV): $E_{\\text{perfect}} = [-25.3908, -32.5908, -46.9908, -61.3908, -82.9908]$.\n- Faulted slab total energies (eV): $E_{\\text{fault}} = [-25.2098, -32.4215, -46.8309, -61.2382, -82.8424]$.\n\nDataset 2:\n- Cubic lattice parameter: $a = 3.60~\\text{\\AA}$.\n- Numbers of close-packed layers: $n = [12, 16, 20, 28, 36]$.\n- Perfect slab total energies (eV): $E_{\\text{perfect}} = [-42.2329, -57.4329, -72.6329, -103.0329, -133.4329]$.\n- Faulted slab total energies (eV): $E_{\\text{fault}} = [-42.2012, -57.4051, -72.6079, -103.0114, -133.4129]$.\n\nDataset 3:\n- Cubic lattice parameter: $a = 3.30~\\text{\\AA}$.\n- Numbers of close-packed layers: $n = [10, 12, 15, 22, 30]$.\n- Perfect slab total energies (eV): $E_{\\text{perfect}} = [-36.6048, -44.6048, -56.6048, -84.6048, -116.6048]$.\n- Faulted slab total energies (eV): $E_{\\text{fault}} = [-36.5937, -44.5957, -56.5972, -84.5994, -116.6007]$.\n\nRequirements to ensure universal applicability:\n- Do not assume any external file input; the data above are embedded in your code.\n- Use only algebra, geometry of the fcc lattice, and least-squares regression to implement the extrapolation.\n- The final output must be a single line containing a Python list with three floating-point numbers representing $\\gamma_{\\infty}$ for the three datasets in mJ/m$^2$, each rounded to three decimals, with no units included in the output line.", "solution": "The problem as stated is subjected to validation. All givens, including the physical definitions, governing equations, geometric relations, material-specific data sets, and computational requirements, have been extracted and analyzed. The problem is scientifically grounded in the principles of solid-state physics and computational materials science, specifically concerning the calculation of planar defect energies. The methodology described, which involves extrapolating finite-size slab calculations to the bulk limit using an asymptotic expansion derived from elasticity theory, is a standard and well-posed procedure. The problem is objective, self-contained, and free of contradictions or ambiguities. Therefore, the problem is deemed valid and a rigorous solution will be presented.\n\nThe objective is to compute the intrinsic stacking fault energy, $\\gamma_{\\text{ISF}}$, for three distinct face-centered cubic (fcc) materials. This quantity represents the energy cost per unit area to create a stacking fault in an infinitely large crystal. We are provided with total energy data from Density Functional Theory (DFT) calculations for finite-thickness slabs, both with and without a fault. The solution requires extrapolating these finite-size results to the limit of infinite thickness.\n\nThe process for each dataset is as follows:\n\n1.  **Calculation of Geometric Parameters**: For an fcc crystal with a given cubic lattice parameter $a$, the geometry of the $\\{111\\}$ planes dictates the slab dimensions. The interplanar spacing along the $\\langle 111 \\rangle$ direction is $d_{111} = a/\\sqrt{3}$. The two-dimensional primitive cell of a $\\{111\\}$ plane has an area $A = (\\sqrt{3}/2)a^2$. For a slab constructed from $n$ such planes, its thickness is $L = n \\cdot d_{111}$. These parameters are computed for each material.\n\n2.  **Calculation of Finite-Size Stacking Fault Energies**: The problem provides total energies for a perfect slab, $E_{\\text{perfect}}(L_i)$, and a slab containing a single intrinsic stacking fault, $E_{\\text{fault}}(L_i)$, for several thicknesses $L_i$. The raw, or finite-size, stacking fault energy density, $\\gamma(L_i)$, is defined as the excess energy per unit area. With a single fault ($m=1$), this is:\n    $$\n    \\gamma(L_i) = \\frac{E_{\\text{fault}}(L_i) - E_{\\text{perfect}}(L_i)}{A}\n    $$\n    This calculation is performed for each available slab thickness for each material. The units of $\\gamma(L_i)$ are electronvolts per square Angstrom ($\\text{eV}/\\text{\\AA}^2$).\n\n3.  **Extrapolation to Infinite Thickness**: The interaction between the stacking fault and the free surfaces of the slab introduces a finite-size error that depends on the slab thickness $L$. Based on linear elasticity theory and the symmetry of the slab, this dependence can be expressed as an asymptotic expansion in odd inverse powers of $L$:\n    $$\n    \\gamma(L) = \\gamma_{\\infty} + \\frac{c_1}{L} + \\frac{c_3}{L^3} + \\mathcal{O}\\!\\left(\\frac{1}{L^5}\\right)\n    $$\n    Here, $\\gamma_{\\infty}$ is the desired intrinsic stacking fault energy $\\gamma_{\\text{ISF}}$, and $c_1$ and $c_3$ are coefficients related to elastic interactions. To determine $\\gamma_{\\infty}$, we fit this model to the computed data points $(\\gamma(L_i), L_i)$. This constitutes a linear least-squares regression problem. We seek the coefficients $\\beta = [\\gamma_{\\infty}, c_1, c_3]^T$ that minimize the sum of squared residuals for the system of linear equations:\n    $$\n    \\begin{pmatrix}\n    1 & 1/L_1 & 1/L_1^3 \\\\\n    1 & 1/L_2 & 1/L_2^3 \\\\\n    \\vdots & \\vdots & \\vdots \\\\\n    1 & 1/L_N & 1/L_N^3\n    \\end{pmatrix}\n    \\begin{pmatrix}\n    \\gamma_{\\infty} \\\\\n    c_1 \\\\\n    c_3\n    \\end{pmatrix}\n    =\n    \\begin{pmatrix}\n    \\gamma(L_1) \\\\\n    \\gamma(L_2) \\\\\n    \\vdots \\\\\n    \\gamma(L_N)\n    \\end{pmatrix}\n    $$\n    This system, denoted as $X\\beta = y$, is solved for the parameter vector $\\beta$. The first component of the solution vector, $\\beta_0$, corresponds to $\\gamma_{\\infty}$.\n\n4.  **Unit Conversion and Final Reporting**: The value of $\\gamma_{\\infty}$ obtained from the fit is in units of $\\text{eV}/\\text{\\AA}^2$. It must be converted to milli-Joules per square meter ($\\text{mJ}/\\text{m}^2$). Using the provided conversion factor $1~\\text{J/m}^2 = 0.06241509~\\text{eV/\\AA}^2$, the conversion is:\n    $$\n    \\gamma_{\\infty} [\\text{mJ/m}^2] = \\gamma_{\\infty} [\\text{eV/\\AA}^2] \\times \\frac{1}{0.06241509~\\text{eV/\\AA}^2 \\cdot \\text{m}^{-2} \\cdot \\text{J}^{-1}} \\times 1000~\\text{mJ/J}\n    $$\n    The final numerical result for each dataset is rounded to three decimal places as specified. This procedure is implemented for all three datasets to obtain the final list of results.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the intrinsic stacking fault energy (ISF) for three materials\n    by extrapolating finite-size slab DFT data to infinite thickness.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"a\": 4.05,  # Cubic lattice parameter in Angstroms\n            \"n\": np.array([8, 10, 14, 18, 24]),  # Number of layers\n            \"E_perfect\": np.array([-25.3908, -32.5908, -46.9908, -61.3908, -82.9908]),  # eV\n            \"E_fault\": np.array([-25.2098, -32.4215, -46.8309, -61.2382, -82.8424]),  # eV\n        },\n        {\n            \"a\": 3.60,\n            \"n\": np.array([12, 16, 20, 28, 36]),\n            \"E_perfect\": np.array([-42.2329, -57.4329, -72.6329, -103.0329, -133.4329]),\n            \"E_fault\": np.array([-42.2012, -57.4051, -72.6079, -103.0114, -133.4129]),\n        },\n        {\n            \"a\": 3.30,\n            \"n\": np.array([10, 12, 15, 22, 30]),\n            \"E_perfect\": np.array([-36.6048, -44.6048, -56.6048, -84.6048, -116.6048]),\n            \"E_fault\": np.array([-36.5937, -44.5957, -56.5972, -84.5994, -116.6007]),\n        },\n    ]\n\n    # Constants\n    m = 1  # Number of stacking faults in the supercell\n    # Conversion factor: 1 J/m^2 = 0.06241509 eV/A^2\n    # This implies 1 eV/A^2 = (1 / 0.06241509) J/m^2\n    eV_A2_to_mJ_m2 = (1.0 / 0.06241509) * 1000.0\n\n    results = []\n\n    for case in test_cases:\n        a = case[\"a\"]\n        n_layers = case[\"n\"]\n        E_perfect = case[\"E_perfect\"]\n        E_fault = case[\"E_fault\"]\n\n        # Step 1: Calculate geometric parameters\n        # Interplanar spacing for {111} planes\n        d_111 = a / np.sqrt(3)\n        # Area of the 2D primitive cell of the {111} plane\n        Area = (np.sqrt(3) / 2.0) * a**2\n        # Slab thickness for each n\n        L = n_layers * d_111\n\n        # Step 2: Calculate finite-size stacking fault energies (gamma(L))\n        # Energy difference between faulted and perfect slabs\n        delta_E = E_fault - E_perfect\n        # Raw SFE in eV/A^2\n        gamma_L = delta_E / (m * Area)\n\n        # Step 3: Perform least-squares fit for extrapolation\n        # Model: gamma(L) = gamma_inf + c1/L + c3/L^3\n        # We need to solve a linear system X * beta = y where beta = [gamma_inf, c1, c3]\n        \n        # Construct the design matrix X\n        # The columns are the basis functions: 1, 1/L, 1/L^3\n        X = np.vstack([np.ones_like(L), 1.0 / L, 1.0 / L**3]).T\n        \n        # The dependent variable vector y is gamma_L\n        y = gamma_L\n        \n        # Solve the least-squares problem\n        coeffs, _, _, _ = np.linalg.lstsq(X, y, rcond=None)\n        \n        # The extrapolated ISF energy is the first coefficient (the intercept)\n        gamma_inf_eV_A2 = coeffs[0]\n\n        # Step 4: Convert units and round\n        gamma_inf_mJ_m2 = gamma_inf_eV_A2 * eV_A2_to_mJ_m2\n        \n        rounded_result = round(gamma_inf_mJ_m2, 3)\n        results.append(rounded_result)\n\n    # Format the final output as a string representing a list\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2808552"}]}