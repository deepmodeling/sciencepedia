{"hands_on_practices": [{"introduction": "While theoretically pristine, homogeneous nucleation is a rarity in practice. Real-world phase transformations are almost always catalyzed by pre-existing surfaces, interfaces, or defects. This exercise explores the fundamental energetics of this ubiquitous scenario, known as heterogeneous nucleation, by analyzing the formation of a nucleus on a flat substrate [@problem_id:2844125]. By deriving the free energy barrier, you will quantify how the nucleus-substrate interaction, captured by the contact angle $\\theta$, dramatically lowers the energetic cost of forming a new phase through a geometric scaling factor $f(\\theta)$. This foundational derivation is essential for understanding and controlling microstructure evolution in materials processing.", "problem": "A new solid phase nucleates as a three-dimensional spherical-cap nucleus of radius $R$ on a flat, rigid substrate that is immersed in its parent phase. Assume isotropic nucleus–parent interfacial free energy $\\gamma$ and a uniform volumetric chemical driving force per unit volume $\\Delta g_v$ that satisfies $\\Delta g_v<0$. The contact angle between the nucleus and the substrate is $\\theta$ (expressed in degrees). Starting from the definition that the total change in Gibbs free energy is the sum of interfacial contributions and the bulk driving contribution, and using Young’s equation to eliminate substrate interfacial energies in favor of $\\theta$ and $\\gamma$, derive the heterogeneous nucleation work $\\Delta G_{\\text{het}}(R,\\theta)$ for a spherical-cap nucleus in terms of $\\gamma$, $\\Delta g_v$, $R$, and $\\theta$. Compare it to the homogeneous spherical nucleus case $\\Delta G_{\\text{hom}}(R)$ and thereby define a purely geometric shape factor $f(\\theta)$ via $\\Delta G_{\\text{het}}(R,\\theta)=f(\\theta)\\,\\Delta G_{\\text{hom}}(R)$ for fixed $\\gamma$ and $\\Delta g_v$. From this relation, deduce whether the critical radius $r^*$ depends on $\\theta$ and how the critical barrier $\\Delta G^*$ scales with $\\theta$.\n\nFinally, for $\\theta=60^\\circ$, compute $f(\\theta)$ and the relative reduction factors in the critical radius and barrier with respect to homogeneous nucleation, defined as $\\rho_r \\equiv r^*_{\\text{het}}/r^*_{\\text{hom}}$ and $\\rho_G \\equiv \\Delta G^*_{\\text{het}}/\\Delta G^*_{\\text{hom}}$. Report your final answer as a row matrix $\\big[f(\\theta),\\ \\rho_r,\\ \\rho_G\\big]$ of three dimensionless numbers with no units. Do not round; give exact values.", "solution": "The problem as stated is a standard exercise in classical nucleation theory and is scientifically grounded, well-posed, and objective. It contains all necessary information for a complete derivation. Therefore, the problem is valid, and a solution will be provided.\n\nThe total change in Gibbs free energy, $\\Delta G_{\\text{het}}$, for the formation of a spherical-cap nucleus of radius $R$ on a flat substrate is the sum of the bulk free energy change and the change in surface free energy. Let the new solid phase be denoted by `s`, the parent phase by `l`, and the substrate by `sub`. The respective interfacial free energies are $\\gamma_{\\text{sl}}$, $\\gamma_{\\text{ssub}}$, and $\\gamma_{\\text{lsub}}$. The problem specifies that the isotropic nucleus-parent interfacial free energy is $\\gamma$, so $\\gamma_{\\text{sl}}=\\gamma$. The volumetric driving force is $\\Delta g_v$.\n\nThe total free energy change is given by:\n$$ \\Delta G_{\\text{het}}(R,\\theta) = V_{\\text{s}} \\Delta g_v + A_{\\text{sl}}\\gamma_{\\text{sl}} + A_{\\text{ssub}}\\gamma_{\\text{ssub}} - A_{\\text{ssub}}\\gamma_{\\text{lsub}} $$\nwhere $V_{\\text{s}}$ is the volume of the spherical-cap nucleus, $A_{\\text{sl}}$ is the area of the solid-liquid interface (the curved surface of the cap), and $A_{\\text{ssub}}$ is the area of the solid-substrate interface (the base of the cap), which replaces an equivalent area of the liquid-substrate interface.\n\nThe geometry of a spherical cap with radius $R$ and contact angle $\\theta$ (where $\\theta$ is the angle inside the solid nucleus, measured from the substrate) is described as follows:\nThe volume of the spherical cap, $V_{\\text{s}}$, is:\n$$ V_{\\text{s}} = \\frac{\\pi R^3}{3}(1-\\cos\\theta)^2(2+\\cos\\theta) = \\frac{\\pi R^3}{3}(2 - 3\\cos\\theta + \\cos^3\\theta) $$\nThe area of the curved solid-liquid interface, $A_{\\text{sl}}$, is:\n$$ A_{\\text{sl}} = 2\\pi R^2(1-\\cos\\theta) $$\nThe area of the circular solid-substrate interface, $A_{\\text{ssub}}$, is:\n$$ A_{\\text{ssub}} = \\pi (R\\sin\\theta)^2 = \\pi R^2 \\sin^2\\theta $$\nSubstituting these into the expression for $\\Delta G_{\\text{het}}$, we have:\n$$ \\Delta G_{\\text{het}}(R,\\theta) = \\frac{\\pi R^3}{3}(2 - 3\\cos\\theta + \\cos^3\\theta)\\Delta g_v + 2\\pi R^2(1-\\cos\\theta)\\gamma + \\pi R^2 \\sin^2\\theta(\\gamma_{\\text{ssub}} - \\gamma_{\\text{lsub}}) $$\nThe problem requires the use of Young's equation to eliminate the substrate-related interfacial free energies. Young's equation describes the mechanical equilibrium at the three-phase contact line:\n$$ \\gamma_{\\text{lsub}} = \\gamma_{\\text{ssub}} + \\gamma_{\\text{sl}}\\cos\\theta $$\nUsing $\\gamma_{\\text{sl}} = \\gamma$, this gives $\\gamma_{\\text{ssub}} - \\gamma_{\\text{lsub}} = -\\gamma\\cos\\theta$.\nSubstituting this result into the $\\Delta G_{\\text{het}}$ expression:\n$$ \\Delta G_{\\text{het}}(R,\\theta) = \\frac{\\pi R^3}{3}(2 - 3\\cos\\theta + \\cos^3\\theta)\\Delta g_v + 2\\pi R^2(1-\\cos\\theta)\\gamma + \\pi R^2 \\sin^2\\theta(-\\gamma\\cos\\theta) $$\nLet us simplify the total surface energy term:\n$$ \\Delta G_S = 2\\pi R^2(1-\\cos\\theta)\\gamma - \\pi R^2 \\sin^2\\theta \\cos\\theta \\gamma $$\n$$ \\Delta G_S = \\pi R^2 \\gamma [2(1-\\cos\\theta) - \\sin^2\\theta \\cos\\theta] $$\nUsing the identity $\\sin^2\\theta = 1 - \\cos^2\\theta$:\n$$ \\Delta G_S = \\pi R^2 \\gamma [2 - 2\\cos\\theta - (1-\\cos^2\\theta)\\cos\\theta] $$\n$$ \\Delta G_S = \\pi R^2 \\gamma [2 - 2\\cos\\theta - \\cos\\theta + \\cos^3\\theta] $$\n$$ \\Delta G_S = \\pi R^2 \\gamma (2 - 3\\cos\\theta + \\cos^3\\theta) $$\nThe full expression for the heterogeneous nucleation work is therefore:\n$$ \\Delta G_{\\text{het}}(R,\\theta) = \\pi R^2 \\gamma (2 - 3\\cos\\theta + \\cos^3\\theta) + \\frac{\\pi R^3}{3}(2 - 3\\cos\\theta + \\cos^3\\theta)\\Delta g_v $$\nNote that the problem defined $\\Delta g_v  0$, which represents an energy decrease per volume. To match the form of $\\Delta G_{hom}$ which uses a positive driving force term, we can define a positive quantity $\\Delta G_v = -\\Delta g_v > 0$. The expression then becomes:\n$$ \\Delta G_{\\text{het}}(R,\\theta) = \\left[ \\pi R^2 \\gamma (2 - 3\\cos\\theta + \\cos^3\\theta) \\right] - \\left[ \\frac{\\pi R^3}{3}(2 - 3\\cos\\theta + \\cos^3\\theta)\\Delta G_v \\right] $$\n\nFor comparison, the free energy change for homogeneous nucleation of a spherical nucleus of radius $R$ is:\n$$ \\Delta G_{\\text{hom}}(R) = 4\\pi R^2 \\gamma + \\frac{4}{3}\\pi R^3 \\Delta g_v $$\n(Using the convention $\\Delta g_v  0$).\nWe can factor the geometric term out of our expression for $\\Delta G_{\\text{het}}$:\n$$ \\Delta G_{\\text{het}}(R,\\theta) = \\frac{1}{4}(2 - 3\\cos\\theta + \\cos^3\\theta) \\left[ 4\\pi R^2 \\gamma + \\frac{4}{3}\\pi R^3 \\Delta g_v \\right] $$\nThe term in brackets is precisely $\\Delta G_{\\text{hom}}(R)$. Thus, the relation holds, and the shape factor is:\n$$ f(\\theta) = \\frac{1}{4}(2 - 3\\cos\\theta + \\cos^3\\theta) = \\frac{(1-\\cos\\theta)^2(2+\\cos\\theta)}{4} $$\n\nTo find the critical radius $r^*$ and the critical energy barrier $\\Delta G^*$, we must find the maximum of the free energy function by taking the derivative with respect to $R$ and setting it to zero.\n$$ \\frac{d\\Delta G_{\\text{het}}(R,\\theta)}{dR} = f(\\theta) \\frac{d\\Delta G_{\\text{hom}}(R)}{dR} = 0 $$\nSince $f(\\theta)$ is a constant for a given $\\theta$ (and $f(\\theta) \\neq 0$ for $\\theta  0$), the condition for the critical radius $r^*_{\\text{het}}$ is the same as for the homogeneous case, $r^*_{\\text{hom}}$.\n$$ \\frac{d\\Delta G_{\\text{hom}}(R)}{dR} = 8\\pi R \\gamma + 4\\pi R^2 \\Delta g_v = 0 $$\nFor non-trivial radius $R \\neq 0$, we solve $8\\pi R \\gamma = -4\\pi R^2 \\Delta g_v$, which yields the critical radius:\n$$ r^* = -\\frac{2\\gamma}{\\Delta g_v} $$\nThis demonstrates that the critical radius $r^*$ does not depend on the contact angle $\\theta$. Thus, $r^*_{\\text{het}} = r^*_{\\text{hom}}$.\n\nThe critical energy barrier, $\\Delta G^*$, is found by substituting $r^*$ back into the $\\Delta G$ expression. For the homogeneous case:\n$$ \\Delta G^*_{\\text{hom}} = \\Delta G_{\\text{hom}}(r^*) = 4\\pi \\left(-\\frac{2\\gamma}{\\Delta g_v}\\right)^2 \\gamma + \\frac{4}{3}\\pi \\left(-\\frac{2\\gamma}{\\Delta g_v}\\right)^3 \\Delta g_v = \\frac{16\\pi\\gamma^3}{3\\Delta g_v^2} $$\nFor the heterogeneous case, the critical barrier is:\n$$ \\Delta G^*_{\\text{het}} = \\Delta G_{\\text{het}}(r^*, \\theta) = f(\\theta) \\Delta G_{\\text{hom}}(r^*) = f(\\theta) \\Delta G^*_{\\text{hom}} $$\nThis shows that the critical barrier $\\Delta G^*$ is scaled by the geometric factor $f(\\theta)$ relative to the homogeneous case.\n\nFinally, we compute the required values for $\\theta = 60^\\circ$.\nFor this angle, $\\cos(60^\\circ) = \\frac{1}{2}$.\nThe shape factor $f(\\theta)$ is:\n$$ f(60^\\circ) = \\frac{1}{4}(2 - 3\\cos(60^\\circ) + \\cos^3(60^\\circ)) = \\frac{1}{4}\\left(2 - 3\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right)^3\\right) $$\n$$ f(60^\\circ) = \\frac{1}{4}\\left(2 - \\frac{3}{2} + \\frac{1}{8}\\right) = \\frac{1}{4}\\left(\\frac{16-12+1}{8}\\right) = \\frac{1}{4}\\left(\\frac{5}{8}\\right) = \\frac{5}{32} $$\nThe relative reduction factor for the critical radius, $\\rho_r$, is:\n$$ \\rho_r = \\frac{r^*_{\\text{het}}}{r^*_{\\text{hom}}} = 1 $$\nas the critical radius is independent of $\\theta$.\nThe relative reduction factor for the critical barrier, $\\rho_G$, is:\n$$ \\rho_G = \\frac{\\Delta G^*_{\\text{het}}}{\\Delta G^*_{\\text{hom}}} = \\frac{f(\\theta)\\Delta G^*_{\\text{hom}}}{\\Delta G^*_{\\text{hom}}} = f(\\theta) $$\nFor $\\theta=60^\\circ$, this is:\n$$ \\rho_G = f(60^\\circ) = \\frac{5}{32} $$\nThe final answer is the row matrix of these three values.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{5}{32}  1  \\frac{5}{32} \\end{pmatrix}}\n$$", "id": "2844125"}, {"introduction": "The theoretical nucleation rate, $J$, represents a macroscopic average, but its experimental measurement relies on observing discrete, stochastic events. This practice bridges the gap between theory and experiment by guiding you through the statistical analysis of time-to-event data. You will derive the maximum likelihood estimator (MLE) for the nucleation rate from first principles, learning to properly handle real-world experimental outcomes, including observations where no nucleation event is detected within the measurement window (right-censored data) [@problem_id:2844127]. This exercise provides a robust framework for quantifying kinetic parameters from experimental observations, a critical skill for materials research.", "problem": "An isothermal nucleation experiment is repeated independently at a fixed temperature in a metastable melt, with all runs having identical thermodynamic driving force but possibly different monitored volumes due to practical constraints. In each run, the sample is monitored until either the first detectable supercritical nucleus appears (the induction time) or an observation cutoff is reached without a detection (right-censoring). Assume that nucleation events in space-time follow a homogeneous Poisson process with constant volumetric nucleation rate $J$ (events per unit volume per unit time), independent across runs. This implies that, for a run monitoring volume $V$, the number of nuclei formed in a time interval of length $t$ is Poisson-distributed with mean $J V t$. Assume detection is immediate upon formation of a supercritical nucleus, and that growth and detection thresholds do not add additional delays.\n\nYou perform $N$ runs indexed by $i=1,\\dots,N$. For run $i$, you record:\n- the monitored volume $V_i$,\n- the monitoring duration $\\tau_i$,\n- an event indicator $\\delta_i$, where $\\delta_i=1$ if a first nucleation event is observed during the run (so the induction time equals $\\tau_i$), and $\\delta_i=0$ if no event is observed up to time $\\tau_i$ (right-censoring at $\\tau_i$).\n\nStarting from first principles appropriate to this context, derive the likelihood for $J$ based on $\\{(V_i,\\tau_i,\\delta_i)\\}_{i=1}^{N}$ and obtain the maximum likelihood estimator for $J$. Your final answer should be a single closed-form analytic expression for the estimator $\\hat{J}$ in terms of $\\{V_i,\\tau_i,\\delta_i\\}$. Assume $J$ is defined as a volumetric nucleation rate with SI base units $\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$. Do not use any shortcut formulas that presume prior knowledge of the estimator; derive it from the stated Poisson model and its consequences. Provide the final expression only; do not include units in the final expression.", "solution": "The problem as stated is valid. It is a well-posed problem in statistical inference applied to the physics of phase transformations. It is scientifically grounded in the classical theory of nucleation, which models nucleation as a stochastic process. The data structure, involving right-censoring, is standard for time-to-event analysis. I will proceed with the derivation of the maximum likelihood estimator for the nucleation rate $J$.\n\nThe problem states that nucleation events follow a homogeneous Poisson process in space-time with a constant volumetric rate $J$. For a given volume $V$ and time interval $t$, the number of nuclei, $k$, that form is a random variable following a Poisson distribution with mean $\\lambda = JVt$. The probability mass function (PMF) is given by:\n$$\nP(k; J, V, t) = \\frac{(JVt)^{k} \\exp(-JVt)}{k!}\n$$\n\nWe are interested in the time of the *first* nucleation event, which we denote by the random variable $T$. The experiment for each run $i$ continues until either this first event is detected at time $\\tau_i$ or the observation is terminated at time $\\tau_i$ without an event. This is a time-to-event problem with right-censoring.\n\nFirst, we must derive the probability distribution for the first event time $T$. The cumulative distribution function (CDF), $F(t) = P(T \\le t)$, is the probability that the first event occurs no later than time $t$. This is equivalent to one minus the probability that no events occur in the time interval $[0, t]$. The probability of observing zero events ($k=0$) in volume $V$ up to time $t$ is given by the Poisson PMF:\n$$\nP(k=0; J, V, t) = \\frac{(JVt)^{0} \\exp(-JVt)}{0!} = \\exp(-JVt)\n$$\nThe probability that the first event has not yet occurred by time $t$ is the survival function, $S(t)$:\n$$\nS(t) = P(T  t) = P(k=0 \\text{ in } [0,t]) = \\exp(-JVt)\n$$\nTherefore, the CDF is:\n$$\nF(t) = P(T \\le t) = 1 - S(t) = 1 - \\exp(-JVt)\n$$\nThis shows that the time to the first event follows an exponential distribution with a rate parameter of $JV$. The probability density function (PDF), $f(t)$, is the derivative of the CDF with respect to time $t$:\n$$\nf(t) = \\frac{dF(t)}{dt} = \\frac{d}{dt} (1 - \\exp(-JVt)) = -(-JV) \\exp(-JVt) = JV \\exp(-JVt)\n$$\n\nNow we construct the likelihood function, $L(J)$, based on the set of $N$ independent observations $\\{(V_i, \\tau_i, \\delta_i)\\}_{i=1}^{N}$. The total likelihood is the product of the likelihood contributions from each individual run, due to their independence.\n\nFor a run $i$ where a nucleation event is observed ($\\delta_i = 1$), the observation is the time of the event, $\\tau_i$. The probability of this observation is given by the PDF evaluated at $\\tau_i$. The likelihood contribution is:\n$$\nL_i(J | \\delta_i=1) = f_i(\\tau_i) = J V_i \\exp(-J V_i \\tau_i)\n$$\nFor a run $i$ where no event is observed up to the cutoff time $\\tau_i$ ($\\delta_i = 0$), the observation is that the first event time $T_i$ is greater than $\\tau_i$. The probability of this is given by the survival function evaluated at $\\tau_i$. The likelihood contribution is:\n$$\nL_i(J | \\delta_i=0) = S_i(\\tau_i) = P(T_i  \\tau_i) = \\exp(-J V_i \\tau_i)\n$$\nWe can write a single elegant expression for the likelihood contribution from run $i$ using the indicator variable $\\delta_i$:\n$$\nL_i(J) = [f_i(\\tau_i)]^{\\delta_i} [S_i(\\tau_i)]^{1-\\delta_i} = [J V_i \\exp(-J V_i \\tau_i)]^{\\delta_i} [\\exp(-J V_i \\tau_i)]^{1-\\delta_i}\n$$\nSimplifying this expression:\n$$\nL_i(J) = (J V_i)^{\\delta_i} (\\exp(-J V_i \\tau_i))^{\\delta_i} (\\exp(-J V_i \\tau_i))^{1-\\delta_i} = (J V_i)^{\\delta_i} \\exp(-J V_i \\tau_i)\n$$\nThe total likelihood function for the $N$ observations is the product:\n$$\nL(J) = \\prod_{i=1}^{N} L_i(J) = \\prod_{i=1}^{N} \\left[ (J V_i)^{\\delta_i} \\exp(-J V_i \\tau_i) \\right]\n$$\nTo find the maximum likelihood estimator (MLE) for $J$, it is mathematically more convenient to work with the natural logarithm of the likelihood function, the log-likelihood $\\mathcal{L}(J) = \\ln(L(J))$.\n$$\n\\mathcal{L}(J) = \\ln \\left( \\prod_{i=1}^{N} (J V_i)^{\\delta_i} \\exp(-J V_i \\tau_i) \\right) = \\sum_{i=1}^{N} \\ln \\left( (J V_i)^{\\delta_i} \\exp(-J V_i \\tau_i) \\right)\n$$\n$$\n\\mathcal{L}(J) = \\sum_{i=1}^{N} \\left[ \\ln((J V_i)^{\\delta_i}) + \\ln(\\exp(-J V_i \\tau_i)) \\right] = \\sum_{i=1}^{N} \\left[ \\delta_i \\ln(J V_i) - J V_i \\tau_i \\right]\n$$\n$$\n\\mathcal{L}(J) = \\sum_{i=1}^{N} \\left[ \\delta_i (\\ln J + \\ln V_i) - J V_i \\tau_i \\right] = \\left(\\sum_{i=1}^{N} \\delta_i\\right) \\ln J + \\sum_{i=1}^{N} \\delta_i \\ln V_i - J \\sum_{i=1}^{N} V_i \\tau_i\n$$\nTo find the value of $J$ that maximizes $\\mathcal{L}(J)$, we differentiate $\\mathcal{L}(J)$ with respect to $J$ and set the result to zero.\n$$\n\\frac{d\\mathcal{L}}{dJ} = \\frac{d}{dJ} \\left[ \\left(\\sum_{i=1}^{N} \\delta_i\\right) \\ln J + \\sum_{i=1}^{N} \\delta_i \\ln V_i - J \\sum_{i=1}^{N} V_i \\tau_i \\right]\n$$\n$$\n\\frac{d\\mathcal{L}}{dJ} = \\frac{1}{J} \\left(\\sum_{i=1}^{N} \\delta_i\\right) - \\sum_{i=1}^{N} V_i \\tau_i\n$$\nSetting the derivative to zero and solving for the estimator $\\hat{J}$:\n$$\n\\frac{1}{\\hat{J}} \\left(\\sum_{i=1}^{N} \\delta_i\\right) - \\sum_{i=1}^{N} V_i \\tau_i = 0\n$$\n$$\n\\frac{1}{\\hat{J}} \\left(\\sum_{i=1}^{N} \\delta_i\\right) = \\sum_{i=1}^{N} V_i \\tau_i\n$$\n$$\n\\hat{J} = \\frac{\\sum_{i=1}^{N} \\delta_i}{\\sum_{i=1}^{N} V_i \\tau_i}\n$$\nTo confirm this is a maximum, we examine the second derivative:\n$$\n\\frac{d^2\\mathcal{L}}{dJ^2} = -\\frac{1}{J^2} \\left(\\sum_{i=1}^{N} \\delta_i\\right)\n$$\nSince $J  0$ and the number of events $\\sum \\delta_i \\ge 0$, the second derivative is always non-positive. If at least one event is observed ($\\sum \\delta_i  0$), the second derivative is strictly negative, confirming a local maximum. If no events are observed, $\\hat{J}=0$, which correctly corresponds to the maximum of the likelihood function $L(J) = \\exp(-J \\sum V_i \\tau_i)$ at the boundary of the parameter space $J \\ge 0$. The interpretation is that the estimated nucleation rate is simply the total number of observed nucleation events divided by the total volume-time product monitored across all experiments. This is the physically intuitive and correct result.", "answer": "$$\n\\boxed{\\frac{\\sum_{i=1}^{N} \\delta_{i}}{\\sum_{i=1}^{N} V_{i} \\tau_{i}}}\n$$", "id": "2844127"}, {"introduction": "Classical Nucleation Theory (CNT) provides a powerful but simplified picture of phase transformations. In many systems, experimental data deviate from its predictions, motivating the development of alternative \"non-classical\" models. This advanced practice moves beyond fitting a single model and introduces you to the rigorous framework of Bayesian model selection for discriminating between competing theories [@problem_id:2844200]. By implementing a computational workflow to calculate the Bayes factor, you will learn how to use experimental data to quantitatively weigh the evidence for one physical model over another, a cornerstone of modern data-driven scientific inquiry.", "problem": "You are given experimental nucleation rate data and asked to perform principled model selection between two competing models of homogeneous nucleation kinetics using Bayes factors. The task is to build the full logic starting from transition state theory and to implement a numerical evaluation of the marginal likelihoods under each model with explicitly stated priors. Then, compute the Bayes factor for each provided dataset. The entire workflow must be encoded in a complete, runnable program as specified.\n\nStart from the following fundamental base. In transition state theory, the steady-state nucleation rate obeys $J \\propto \\exp\\!\\left(-\\Delta G^\\ast/(k_{\\mathrm{B}} T)\\right)$, where $J$ is the nucleation rate, $\\Delta G^\\ast$ is the free energy barrier for nucleation, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $T$ is the absolute temperature. In the capillarity approximation of classical nucleation theory (CNT), the barrier scales with supersaturation $S$ (dimensionless) as $\\Delta G^\\ast \\propto 1/(\\ln S)^2$; a common non-classical alternative adopts a different barrier scaling such as $\\Delta G^\\ast \\propto 1/\\ln S$. Combining these with transition state theory and taking natural logarithms gives a linear-in-parameters relation of the form\n$\\ln J = a - c \\, z(T,S)$\nwith model-dependent regressor $z(T,S)$:\n- For the classical nucleation theory model (CNT): $z_{\\mathrm{CNT}}(T,S) = \\dfrac{1}{k_{\\mathrm{B}}\\, T \\, (\\ln S)^2}$.\n- For a non-classical model (NCM): $z_{\\mathrm{NCM}}(T,S) = \\dfrac{1}{k_{\\mathrm{B}}\\, T \\, \\ln S}$.\n\nAssume an additive Gaussian measurement model in log space. For observations indexed by $i=1,\\dots,n$, let $y_i = \\ln J_i$ be the measured log-rate, with independent noise $y_i \\mid a,c \\sim \\mathcal{N}(a - c\\, z_i, \\sigma_i^2)$. Use a conjugate Gaussian prior on the parameters $\\beta = [a,\\, c]^\\top$ given by $\\beta \\sim \\mathcal{N}(m_0, S_0)$ with the prior mean and covariance specified below. Under this linear-Gaussian model, the parameter-marginalized likelihood (also called the evidence or marginal likelihood) has a closed form:\n$p(y \\mid \\mathcal{M}) = \\mathcal{N}\\!\\left(y; X m_0,\\, \\Sigma + X S_0 X^\\top\\right)$,\nwhere $y \\in \\mathbb{R}^n$ stacks the $y_i$, $X \\in \\mathbb{R}^{n \\times 2}$ has first column all ones and second column $-z_i$, and $\\Sigma = \\mathrm{diag}(\\sigma_1^2,\\dots,\\sigma_n^2)$.\n\nFor each dataset, compute the Bayes factor of CNT relative to NCM,\n$B_{\\mathrm{CNT,NCM}} = \\dfrac{p(y \\mid \\mathcal{M}_{\\mathrm{CNT}})}{p(y \\mid \\mathcal{M}_{\\mathrm{NCM}})}$.\nNumerically, you should compute the log-evidences $\\ln p(y \\mid \\mathcal{M})$ and then exponentiate the difference to obtain the Bayes factor to preserve stability.\n\nConstants, priors, and data are as follows:\n- Boltzmann constant: $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23} \\,\\mathrm{J/K}$.\n- Prior mean: $m_0 = [0,\\, 0]^\\top$.\n- Prior covariance (diagonal): $S_0 = \\mathrm{diag}(\\sigma_a^2, \\sigma_c^2)$ with $\\sigma_a = 50.0$ (dimensionless), $\\sigma_c = 1.0 \\times 10^{-20} \\,\\mathrm{J}$.\n- Observation model: independent Gaussian noise in $\\ln J$ with known standard deviations $\\sigma_i$ listed per dataset.\n\nYou are given four datasets. For each dataset, you are provided arrays of temperatures $T_i$ in $\\mathrm{K}$, supersaturations $S_i$ (dimensionless), measured nucleation rates $J_i$ in $\\mathrm{m^{-3}\\,s^{-1}}$, and log-space uncertainties $\\sigma_i$ (dimensionless, for $\\ln J$). Use the exact numbers below.\n\nDataset A (constructed to be consistent with classical nucleation theory-like scaling):\n- $T$ in $\\mathrm{K}$: $[800.0,\\, 820.0,\\, 780.0,\\, 790.0,\\, 810.0]$.\n- $S$ (dimensionless): $[1.35,\\, 1.30,\\, 1.40,\\, 1.33,\\, 1.31]$.\n- $J$ in $\\mathrm{m^{-3}\\,s^{-1}}$: $[3.23 \\times 10^{12},\\, 2.29 \\times 10^{12},\\, 3.99 \\times 10^{12},\\, 2.77 \\times 10^{12},\\, 2.46 \\times 10^{12}]$.\n- $\\sigma$ for $\\ln J$: $[0.15,\\, 0.15,\\, 0.15,\\, 0.15,\\, 0.15]$.\n\nDataset B (constructed to be consistent with a non-classical scaling):\n- $T$ in $\\mathrm{K}$: $[800.0,\\, 820.0,\\, 780.0,\\, 860.0,\\, 740.0]$.\n- $S$ (dimensionless): $[1.15,\\, 1.20,\\, 1.18,\\, 1.12,\\, 1.22]$.\n- $J$ in $\\mathrm{m^{-3}\\,s^{-1}}$: $[1.04 \\times 10^{12},\\, 1.86 \\times 10^{12},\\, 1.44 \\times 10^{12},\\, 7.37 \\times 10^{11},\\, 1.82 \\times 10^{12}]$.\n- $\\sigma$ for $\\ln J$: $[0.20,\\, 0.20,\\, 0.20,\\, 0.20,\\, 0.20]$.\n\nDataset C (ambiguous regime with nearly constant supersaturation):\n- $T$ in $\\mathrm{K}$: $[790.0,\\, 800.0,\\, 810.0,\\, 820.0]$.\n- $S$ (dimensionless): $[1.284,\\, 1.284,\\, 1.284,\\, 1.284]$.\n- $J$ in $\\mathrm{m^{-3}\\,s^{-1}}$: $[1.81 \\times 10^{12},\\, 1.86 \\times 10^{12},\\, 1.90 \\times 10^{12},\\, 1.94 \\times 10^{12}]$.\n- $\\sigma$ for $\\ln J$: $[0.10,\\, 0.10,\\, 0.10,\\, 0.10]$.\n\nDataset D (edge case with minimal data and large uncertainty):\n- $T$ in $\\mathrm{K}$: $[800.0,\\, 820.0]$.\n- $S$ (dimensionless): $[1.20,\\, 1.20]$.\n- $J$ in $\\mathrm{m^{-3}\\,s^{-1}}$: $[1.65 \\times 10^{12},\\, 1.74 \\times 10^{12}]$.\n- $\\sigma$ for $\\ln J$: $[0.60,\\, 0.60]$.\n\nYour program must:\n- Build, for each dataset and for each model (CNT and NCM), the design matrix $X$ with first column all ones and second column $-z_i$ computed using the model-specific $z(T_i,S_i)$.\n- Compute the log-evidence $\\ln p(y \\mid \\mathcal{M})$ using the closed-form Gaussian marginal with covariance $C = \\Sigma + X S_0 X^\\top$ and mean $X m_0$. Use numerically stable linear algebra.\n- Compute the Bayes factor $B_{\\mathrm{CNT,NCM}} = \\exp\\left[\\ln p(y \\mid \\mathcal{M}_{\\mathrm{CNT}}) - \\ln p(y \\mid \\mathcal{M}_{\\mathrm{NCM}})\\right]$ for each dataset.\n\nRequired final output format:\n- Your program should produce a single line of output containing the four Bayes factors for datasets A, B, C, and D, in that order, as a comma-separated list enclosed in square brackets, with each Bayes factor rounded to six decimal places (for example, $[1.234567,0.987654,1.000000,2.500000]$).\n- No other text should be printed.\n\nThere are no angles in this problem. Physical quantities in the inputs must be treated in their stated International System of Units (SI). The outputs are dimensionless Bayes factors and therefore require no unit specification. The answers for each test case are floats as defined above. The program must be complete and runnable as given, without any external input. The numerical constants and data above are scientifically plausible and self-consistent with the provided modeling assumptions.", "solution": "The problem requires a principled comparison of two competing models for homogeneous nucleation kinetics using the framework of Bayesian model selection. The models are the classical nucleation theory (CNT) and a non-classical model (NCM), which differ in their prediction for the scaling of the nucleation free energy barrier $\\Delta G^\\ast$ with supersaturation $S$. The goal is to compute the Bayes factor $B_{\\mathrm{CNT,NCM}}$ for four distinct experimental datasets.\n\nThe fundamental starting point is the transition state theory expression for the steady-state nucleation rate, $J$, at a given absolute temperature $T$:\n$$\nJ \\propto \\exp\\left(-\\frac{\\Delta G^\\ast}{k_{\\mathrm{B}} T}\\right)\n$$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant. Taking the natural logarithm yields a linear relationship between $\\ln J$ and the barrier $\\Delta G^\\ast$:\n$$\n\\ln J = \\text{const} - \\frac{\\Delta G^\\ast}{k_{\\mathrm{B}} T}\n$$\nThe two models propose different dependencies of $\\Delta G^\\ast$ on the supersaturation $S$.\nFor the classical model, $\\mathcal{M}_{\\mathrm{CNT}}$, the capillarity approximation leads to $\\Delta G^\\ast \\propto 1/(\\ln S)^2$. For the non-classical model, $\\mathcal{M}_{\\mathrm{NCM}}$, an alternative scaling $\\Delta G^\\ast \\propto 1/\\ln S$ is assumed. This leads to two distinct linear regression models of the form:\n$$\n\\ln J = a - c \\cdot z(T,S)\n$$\nwhere $a$ is a temperature-dependent prefactor term (treated here as a constant parameter for simplicity within a narrow temperature range) and $c$ is a positive constant related to interfacial energy and molecular volume. The model-specific regressor $z(T,S)$ is given by:\n-   For $\\mathcal{M}_{\\mathrm{CNT}}$: $z_{\\mathrm{CNT}}(T,S) = \\frac{1}{k_{\\mathrm{B}} T (\\ln S)^2}$\n-   For $\\mathcal{M}_{\\mathrm{NCM}}$: $z_{\\mathrm{NCM}}(T,S) = \\frac{1}{k_{\\mathrm{B}} T \\ln S}$\n\nFor a set of $n$ experimental data points $(T_i, S_i, J_i)$, we define the response variable $y_i = \\ln J_i$. The problem states that the measurement process is corrupted by additive Gaussian noise in this log-space, such that $y_i \\sim \\mathcal{N}(a - c \\cdot z_i, \\sigma_i^2)$. In matrix notation for the entire dataset, this is a Bayesian linear regression problem:\n$$\ny = X\\beta + \\epsilon, \\quad \\epsilon \\sim \\mathcal{N}(0, \\Sigma)\n$$\nHere, $y \\in \\mathbb{R}^n$ is the vector of observed log-rates, $X \\in \\mathbb{R}^{n \\times 2}$ is the design matrix whose $i$-th row is $[1, -z_i]$, $\\beta = [a, c]^\\top$ is the vector of parameters, and $\\Sigma = \\mathrm{diag}(\\sigma_1^2, \\dots, \\sigma_n^2)$ is the covariance matrix of the known, independent measurement errors.\n\nThe Bayesian framework is completed by specifying a prior distribution for the parameters $\\beta$. A conjugate Gaussian prior is provided:\n$$\np(\\beta \\mid \\mathcal{M}) = \\mathcal{N}(\\beta; m_0, S_0)\n$$\nwith prior mean $m_0 = [0, 0]^\\top$ and prior covariance $S_0 = \\mathrm{diag}(\\sigma_a^2, \\sigma_c^2)$, where $\\sigma_a = 50.0$ and $\\sigma_c = 1.0 \\times 10^{-20} \\, \\mathrm{J}$.\n\nThe central quantity for model comparison is the marginal likelihood, or evidence, $p(y \\mid \\mathcal{M})$, obtained by integrating the product of the likelihood and the prior over all possible parameter values:\n$$\np(y \\mid \\mathcal{M}) = \\int p(y \\mid \\beta, \\mathcal{M}) p(\\beta \\mid \\mathcal{M}) \\, d\\beta\n$$\nFor the specified linear-Gaussian model, this integral has a closed-form solution. The marginal distribution of the data $y$ is itself a multivariate Gaussian:\n$$\np(y \\mid \\mathcal{M}) = \\mathcal{N}(y; Xm_0, \\Sigma + XS_0X^\\top)\n$$\nThe computational task is to evaluate the probability density of the observed data vector $y$ under this distribution. For numerical stability, we compute the log-evidence. The log-probability density for a vector $y$ under a multivariate normal distribution $\\mathcal{N}(\\mu, C)$ of dimension $n$ is:\n$$\n\\ln p(y \\mid \\mathcal{M}) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln(\\det(C)) - \\frac{1}{2}(y - \\mu)^\\top C^{-1}(y - \\mu)\n$$\nIn our case, the mean is $\\mu_y = Xm_0$ and the covariance is $C_y = \\Sigma + XS_0X^\\top$. Given the prior mean $m_0 = [0, 0]^\\top$, the marginal mean simplifies to $\\mu_y = 0$.\n\nThe Bayes factor for comparing $\\mathcal{M}_{\\mathrm{CNT}}$ to $\\mathcal{M}_{\\mathrm{NCM}}$ is the ratio of their respective marginal likelihoods:\n$$\nB_{\\mathrm{CNT,NCM}} = \\frac{p(y \\mid \\mathcal{M}_{\\mathrm{CNT}})}{p(y \\mid \\mathcal{M}_{\\mathrm{NCM}})}\n$$\nThis is computed via the log-evidences to maintain numerical precision:\n$$\nB_{\\mathrm{CNT,NCM}} = \\exp\\left[ \\ln p(y \\mid \\mathcal{M}_{\\mathrm{CNT}}) - \\ln p(y \\mid \\mathcal{M}_{\\mathrm{NCM}}) \\right]\n$$\n\nThe computational procedure for each dataset is as follows:\n1.  Define the constants $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23} \\, \\mathrm{J/K}$ and the prior covariance matrix $S_0 = \\mathrm{diag}((50.0)^2, (1.0 \\times 10^{-20})^2)$.\n2.  For each model ($\\mathcal{M}_{\\mathrm{CNT}}$ and $\\mathcal{M}_{\\mathrm{NCM}}$):\n    a.  From the input arrays $T$, $S$, $J$, and $\\sigma$, construct the data vector $y = \\ln(J)$ and the noise covariance $\\Sigma = \\mathrm{diag}(\\sigma^2)$.\n    b.  Calculate the regressor vector $z$ according to the model's definition.\n    c.  Form the design matrix $X$ with columns $[1, \\dots, 1]^\\top$ and $[-z_1, \\dots, -z_n]^\\top$.\n    d.  Compute the marginal covariance matrix $C_y = \\Sigma + X S_0 X^\\top$.\n    e.  Calculate the log-marginal likelihood $\\ln p(y \\mid \\mathcal{M})$ by evaluating the log-PDF of the distribution $\\mathcal{N}(y; 0, C_y)$. This is best performed using a robust linear algebra library function which internally computes the log-determinant and the quadratic form in a numerically stable manner.\n3.  Calculate the Bayes factor by exponentiating the difference of the log-evidences.\nThis entire procedure will be applied to each of the four provided datasets.", "answer": "```python\nimport numpy as np\nfrom scipy.stats import multivariate_normal\n\ndef solve():\n    \"\"\"\n    Solves the Bayesian model selection problem for nucleation kinetics.\n    \"\"\"\n    \n    # Constants and Priors\n    k_B = 1.380649e-23  # Boltzmann constant in J/K\n    \n    # Prior parameter distributions: beta = [a, c]^T ~ N(m0, S0)\n    m0 = np.array([0.0, 0.0])\n    sigma_a = 50.0  # dimensionless\n    sigma_c = 1.0e-20  # in Joules\n    S0 = np.diag([sigma_a**2, sigma_c**2])\n\n    # Datasets\n    datasets = {\n        'A': {\n            'T': np.array([800.0, 820.0, 780.0, 790.0, 810.0]),\n            'S': np.array([1.35, 1.30, 1.40, 1.33, 1.31]),\n            'J': np.array([3.23e12, 2.29e12, 3.99e12, 2.77e12, 2.46e12]),\n            'sigma': np.array([0.15, 0.15, 0.15, 0.15, 0.15])\n        },\n        'B': {\n            'T': np.array([800.0, 820.0, 780.0, 860.0, 740.0]),\n            'S': np.array([1.15, 1.20, 1.18, 1.12, 1.22]),\n            'J': np.array([1.04e12, 1.86e12, 1.44e12, 7.37e11, 1.82e12]),\n            'sigma': np.array([0.20, 0.20, 0.20, 0.20, 0.20])\n        },\n        'C': {\n            'T': np.array([790.0, 800.0, 810.0, 820.0]),\n            'S': np.array([1.284, 1.284, 1.284, 1.284]),\n            'J': np.array([1.81e12, 1.86e12, 1.90e12, 1.94e12]),\n            'sigma': np.array([0.10, 0.10, 0.10, 0.10])\n        },\n        'D': {\n            'T': np.array([800.0, 820.0]),\n            'S': np.array([1.20, 1.20]),\n            'J': np.array([1.65e12, 1.74e12]),\n            'sigma': np.array([0.60, 0.60])\n        }\n    }\n\n    test_cases = [\n        datasets['A'],\n        datasets['B'],\n        datasets['C'],\n        datasets['D']\n    ]\n\n    def compute_log_evidence(data, model_type, k_B_val, m0_val, S0_val):\n        \"\"\"\n        Computes the log marginal likelihood for a given model and dataset.\n        \n        Args:\n            data (dict): Dictionary containing T, S, J, sigma arrays.\n            model_type (str): 'CNT' for classical, 'NCM' for non-classical.\n            k_B_val (float): Boltzmann constant.\n            m0_val (np.ndarray): Prior mean vector.\n            S0_val (np.ndarray): Prior covariance matrix.\n            \n        Returns:\n            float: The log marginal likelihood (log-evidence).\n        \"\"\"\n        T = data['T']\n        S = data['S']\n        J = data['J']\n        sigma = data['sigma']\n        \n        n = len(T)\n        y = np.log(J)\n        \n        # Calculate model-specific regressor z\n        ln_S = np.log(S)\n        if model_type == 'CNT':\n            # Add a small epsilon to avoid division by zero if S is close to 1\n            # Though in the given datasets, S is always > 1\n            z = 1.0 / (k_B_val * T * (ln_S**2))\n        elif model_type == 'NCM':\n            z = 1.0 / (k_B_val * T * ln_S)\n        else:\n            raise ValueError(\"Invalid model type specified.\")\n            \n        # Construct design matrix X\n        X = np.vstack([np.ones(n), -z]).T\n        \n        # Construct noise covariance matrix Sigma\n        Sigma = np.diag(sigma**2)\n        \n        # Marginal likelihood p(y|M) is Gaussian N(y; mu_y, C_y)\n        # Mean mu_y = X @ m0\n        # Covariance C_y = Sigma + X @ S0 @ X.T\n        \n        mu_y = X @ m0_val\n        C_y = Sigma + X @ S0_val @ X.T\n        \n        # Compute log-PDF of y under this marginal distribution\n        log_evidence = multivariate_normal.logpdf(y, mean=mu_y, cov=C_y)\n        \n        return log_evidence\n\n    results = []\n    for case in test_cases:\n        log_ev_cnt = compute_log_evidence(case, 'CNT', k_B, m0, S0)\n        log_ev_ncm = compute_log_evidence(case, 'NCM', k_B, m0, S0)\n        \n        # Bayes Factor B_CNT,NCM = exp(log_ev_CNT - log_ev_NCM)\n        bayes_factor = np.exp(log_ev_cnt - log_ev_ncm)\n        results.append(bayes_factor)\n\n    # Format the final output as specified\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2844200"}]}