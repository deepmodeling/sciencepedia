{"hands_on_practices": [{"introduction": "Understanding the behavior of quasi-particles is central to materials physics. This first practice explores the exciton, a bound state of an electron and a hole, by modeling it as a 'hydrogen atom' embedded within a semiconductor material. By solving the stationary Schrödinger equation in both two and three dimensions, you will gain hands-on experience in how dimensionality dramatically alters quantum confinement and energy spectra, a key concept in designing modern nanostructures [@problem_id:2857747].", "problem": "A hydrogenic exciton in a semiconductor can be modeled by the time-independent Schrödinger equation for the relative coordinate, with the electron and hole interacting via a Coulomb potential screened by a uniform background dielectric. Consider a strictly two-dimensional exciton confined to a plane and a three-dimensional exciton in bulk, both in the same material with electron effective mass $m_{e}^{\\star}$, hole effective mass $m_{h}^{\\star}$, and background relative dielectric constant $\\varepsilon_{r}$. Let the reduced mass be $\\mu = \\frac{m_{e}^{\\star} m_{h}^{\\star}}{m_{e}^{\\star} + m_{h}^{\\star}}$, and the Coulomb interaction be $V(r) = - \\frac{e^{2}}{4 \\pi \\varepsilon_{0} \\varepsilon_{r} r}$, where $r$ is the electron–hole separation.\n\nStarting from the relative-coordinate Schrödinger equation, separate variables in the appropriate spatial dimension, impose bound-state normalizability, and obtain the discrete binding-energy spectra for the two-dimensional and three-dimensional cases in terms of $\\mu$, $\\varepsilon_{r}$, $e$, $\\varepsilon_{0}$, and $\\hbar$. Use these spectra to define the level spacing $\\Delta E_{1 \\to 2}^{(d)} \\equiv E_{2}^{(d)} - E_{1}^{(d)}$ between the first excited state ($n=2$) and the ground state ($n=1$) for spatial dimension $d$.\n\nWhat is the exact ratio\n$$\n\\mathcal{R} \\equiv \\frac{\\Delta E_{1 \\to 2}^{(2\\text{D})}}{\\Delta E_{1 \\to 2}^{(3\\text{D})}} \\, ?\n$$\nProvide your final answer as a single exact number. No units are required. Do not round; give the exact value.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is a standard problem in condensed matter physics. We shall proceed with the derivation.\n\nThe starting point for modeling the exciton is the time-independent Schrödinger equation for the relative motion of the electron-hole pair. The Hamiltonian for the relative coordinate $\\mathbf{r}$ is given by:\n$$\n\\hat{H} = -\\frac{\\hbar^2}{2\\mu} \\nabla^2 + V(r)\n$$\nwhere $\\mu = \\frac{m_{e}^{\\star} m_{h}^{\\star}}{m_{e}^{\\star} + m_{h}^{\\star}}$ is the reduced mass, $\\hbar$ is the reduced Planck constant, and the potential energy is the screened Coulomb interaction $V(r) = - \\frac{e^{2}}{4 \\pi \\varepsilon_{0} \\varepsilon_{r} r}$. Here, $e$ is the elementary charge, $\\varepsilon_{0}$ is the vacuum permittivity, and $\\varepsilon_{r}$ is the relative dielectric constant of the material. The Schrödinger equation is $\\hat{H}\\psi(\\mathbf{r}) = E\\psi(\\mathbf{r})$.\n\nWe must solve this equation for both a three-dimensional ($3$D) and a two-dimensional ($2$D) system to find the discrete energy spectra for bound states ($E < 0$).\n\nFirst, we analyze the three-dimensional exciton. The Schrödinger equation in spherical coordinates is separable. The problem is mathematically identical to that of the hydrogen atom, with the substitutions of the electron mass $m_e$ with the reduced mass $\\mu$ and the vacuum permittivity $\\varepsilon_0$ with the effective permittivity $\\varepsilon_0 \\varepsilon_r$. The well-known quantized energy levels for the hydrogen atom are $E_n^{\\text{H}} = - \\frac{m_e e^4}{2(4\\pi\\varepsilon_0)^2\\hbar^2 n^2}$. Applying the aforementioned substitutions yields the energy spectrum for the $3$D exciton:\n$$\nE_{n}^{(3\\text{D})} = - \\frac{\\mu e^4}{2(4\\pi\\varepsilon_0\\varepsilon_r)^2\\hbar^2} \\frac{1}{n^2}\n$$\nwhere the principal quantum number $n$ can take integer values $n=1, 2, 3, \\dots$.\nLet us define the characteristic energy scale, the exciton Rydberg, as:\n$$\nR_X \\equiv \\frac{\\mu e^4}{2(4\\pi\\varepsilon_0\\varepsilon_r)^2\\hbar^2}\n$$\nThe energy spectrum for the $3$D case is thus concisely written as:\n$$\nE_{n}^{(3\\text{D})} = -\\frac{R_X}{n^2}\n$$\nThe ground state ($n=1$) energy is $E_{1}^{(3\\text{D})} = -R_X$.\nThe first excited state ($n=2$) energy is $E_{2}^{(3\\text{D})} = -\\frac{R_X}{2^2} = -\\frac{R_X}{4}$.\nThe energy spacing between these two levels is:\n$$\n\\Delta E_{1 \\to 2}^{(3\\text{D})} = E_{2}^{(3\\text{D})} - E_{1}^{(3\\text{D})} = \\left(-\\frac{R_X}{4}\\right) - (-R_X) = R_X\\left(1 - \\frac{1}{4}\\right) = \\frac{3}{4}R_X\n$$\n\nNext, we analyze the strictly two-dimensional exciton. The Schrödinger equation is solved in a $2$D plane, and in polar coordinates $(r, \\phi)$, it is also separable. This is the \"2D hydrogen atom\" problem. The solution of the radial equation under the condition of normalizability for bound states yields the energy spectrum:\n$$\nE_{n}^{(2\\text{D})} = - \\frac{\\mu e^4}{2(4\\pi\\varepsilon_0\\varepsilon_r)^2\\hbar^2} \\frac{1}{(n - 1/2)^2}\n$$\nHere, the quantum number $n$ labels the energy levels and takes integer values $n=1, 2, 3, \\dots$. Using the same exciton Rydberg definition, $R_X$, we can write the $2$D energy spectrum as:\n$$\nE_{n}^{(2\\text{D})} = -\\frac{R_X}{(n - 1/2)^2}\n$$\nThe ground state ($n=1$) energy is $E_{1}^{(2\\text{D})} = -\\frac{R_X}{(1 - 1/2)^2} = -\\frac{R_X}{(1/2)^2} = -4R_X$.\nThe first excited state ($n=2$) energy is $E_{2}^{(2\\text{D})} = -\\frac{R_X}{(2 - 1/2)^2} = -\\frac{R_X}{(3/2)^2} = -\\frac{4}{9}R_X$.\nThe energy spacing between these two levels is:\n$$\n\\Delta E_{1 \\to 2}^{(2\\text{D})} = E_{2}^{(2\\text{D})} - E_{1}^{(2\\text{D})} = \\left(-\\frac{4}{9}R_X\\right) - (-4R_X) = R_X\\left(4 - \\frac{4}{9}\\right) = R_X\\left(\\frac{36-4}{9}\\right) = \\frac{32}{9}R_X\n$$\n\nFinally, we compute the required ratio $\\mathcal{R}$.\n$$\n\\mathcal{R} \\equiv \\frac{\\Delta E_{1 \\to 2}^{(2\\text{D})}}{\\Delta E_{1 \\to 2}^{(3\\text{D})}} = \\frac{\\frac{32}{9}R_X}{\\frac{3}{4}R_X}\n$$\nThe exciton Rydberg constant $R_X$ cancels, as it depends on material parameters which are the same for both cases.\n$$\n\\mathcal{R} = \\frac{32/9}{3/4} = \\frac{32}{9} \\times \\frac{4}{3} = \\frac{128}{27}\n$$\nThis is the exact numerical ratio requested.", "answer": "$$\n\\boxed{\\frac{128}{27}}\n$$", "id": "2857747"}, {"introduction": "We now shift from a continuum description to a discrete lattice model, which is essential for describing electrons in a crystal. This exercise utilizes the tight-binding approximation to build a band structure from localized atomic orbitals, moving beyond the simple nearest-neighbor model to include further interactions. You will derive the energy dispersion $E(k)$ and investigate how these interactions create new critical points, known as van Hove singularities, in the electronic density of states [@problem_id:2857754].", "problem": "Consider a one-dimensional periodic crystal with lattice constant $a$ and a single spinless orbital per site, described within the tight-binding approximation. The on-site energy is set to zero, and electrons can hop to both nearest neighbors with amplitude $t_{1}$ and to next-nearest neighbors with amplitude $t_{2}$, where $t_{1}$ and $t_{2}$ are real and $t_{2} \\neq 0$. Use the time-independent Schrödinger equation and Bloch’s theorem as the only foundational starting points.\n\nTasks:\n1. Starting from the lattice tight-binding Hamiltonian and the time-independent Schrödinger equation, derive the crystal-momentum dispersion $E(k)$ for Bloch wave number $k$ in the first Brillouin zone.\n2. Using the general definition of the density of states (DOS) in one dimension, identify the condition under which an additional van Hove singularity (beyond the band-edge singularities) appears due to next-nearest-neighbor hopping. Explain the connection between stationary points of $E(k)$ and van Hove singularities, and determine the crystal momenta $k$ at which these stationary points occur.\n3. Evaluating the energy at the additional stationary point (when it exists), determine the energy location of this additional van Hove singularity in terms of $t_{1}$ and $t_{2}$.\n\nAnswer specification:\n- Provide your final answer as the closed-form symbolic expression for the energy of the additional van Hove singularity in terms of $t_{1}$ and $t_{2}$ only.\n- Measure energy in the same units as the hopping amplitudes, so no explicit physical units are required.\n- Do not provide inequalities or conditions as part of the final answer; only the single analytic expression for the energy is required in the final answer box.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard, solvable problem in solid-state physics using the tight-binding model, which is a cornerstone of the field. All necessary parameters are defined, and the tasks are unambiguous. Therefore, the problem is valid, and we shall proceed with the derivation.\n\nWe begin, as instructed, from the time-independent Schrödinger equation (TISE):\n$$ \\hat{H} |\\psi\\rangle = E |\\psi\\rangle $$\nwhere $|\\psi\\rangle$ is the eigenstate of the Hamiltonian $\\hat{H}$ with eigenvalue $E$. In the tight-binding approximation, the basis states are the local atomic orbitals $|n\\rangle$ centered at lattice sites $R_n = na$, where $n$ is an integer and $a$ is the lattice constant. The electronic state $|\\psi\\rangle$ can be written as a linear combination of these basis states:\n$$ |\\psi\\rangle = \\sum_{n} c_n |n\\rangle $$\nWe assume the basis is orthonormal, $\\langle m | n \\rangle = \\delta_{mn}$. The Hamiltonian includes on-site energy and hopping terms. The on-site energy is given as $\\langle n|\\hat{H}|n \\rangle = 0$. The hopping matrix elements are non-zero only for nearest neighbors (NN) and next-nearest neighbors (NNN):\n$$ \\langle m | \\hat{H} | n \\rangle = \\begin{cases} -t_1 & \\text{if } |m-n|=1 \\\\ -t_2 & \\text{if } |m-n|=2 \\\\ 0 & \\text{otherwise} \\end{cases} $$\nSubstituting the expansion of $|\\psi\\rangle$ into the TISE and projecting onto a basis state $\\langle m |$ yields:\n$$ \\sum_{n} c_n \\langle m | \\hat{H} | n \\rangle = E \\sum_{n} c_n \\langle m | n \\rangle = E c_m $$\nApplying the specific Hamiltonian matrix elements gives the equation for the coefficients $c_m$:\n$$ -t_1(c_{m-1} + c_{m+1}) - t_2(c_{m-2} + c_{m+2}) = E c_m $$\nThis is a system of coupled linear equations. For a periodic potential, Bloch's theorem dictates that the solutions must be of the form of a plane wave modulated by a periodic function. In the discrete basis of tight-binding, this implies the coefficients take the form of a plane wave:\n$$ c_n = C e^{ikna} $$\nwhere $k$ is the crystal momentum. Substituting this ansatz into the equation for the coefficients:\n$$ -t_1(e^{ik(m-1)a} + e^{ik(m+1)a}) - t_2(e^{ik(m-2)a} + e^{ik(m+2)a}) = E e^{ikma} $$\nDividing the entire equation by $e^{ikma}$ isolates the energy dispersion $E(k)$:\n$$ E(k) = -t_1(e^{-ika} + e^{ika}) - t_2(e^{-i2ka} + e^{i2ka}) $$\nUsing Euler's formula, $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, we arrive at the dispersion relation for the crystal momentum $k$:\n$$ E(k) = -2t_1\\cos(ka) - 2t_2\\cos(2ka) $$\nThis completes the first task.\n\nFor the second task, we analyze the van Hove singularities. In one dimension, the density of states (DOS), $g(E)$, is given by:\n$$ g(E) = \\frac{1}{2\\pi} \\int_{-\\pi/a}^{\\pi/a} \\delta(E - E(k)) \\, dk = \\frac{1}{\\pi} \\sum_{k_i} \\frac{1}{|\\frac{dE}{dk}|_{k=k_i}|} $$\nwhere the sum is over all $k_i$ in the first Brillouin zone such that $E(k_i) = E$. Van Hove singularities are divergences in the DOS that occur at critical points in the band structure, which are values of $k$ where the group velocity $v_g = \\frac{1}{\\hbar}\\frac{dE}{dk}$ is zero. Mathematically, this corresponds to stationary points where $\\frac{dE}{dk}=0$.\n\nWe must find the derivative of our dispersion relation $E(k)$:\n$$ \\frac{dE}{dk} = \\frac{d}{dk} \\left( -2t_1\\cos(ka) - 2t_2\\cos(2ka) \\right) $$\n$$ \\frac{dE}{dk} = -2t_1(-a\\sin(ka)) - 2t_2(-2a\\sin(2ka)) = 2a t_1\\sin(ka) + 4a t_2\\sin(2ka) $$\nUsing the double-angle identity $\\sin(2\\theta) = 2\\sin(\\theta)\\cos(\\theta)$, we can factor the expression:\n$$ \\frac{dE}{dk} = 2a t_1\\sin(ka) + 4a t_2(2\\sin(ka)\\cos(ka)) = 2a\\sin(ka) \\left( t_1 + 4t_2\\cos(ka) \\right) $$\nSetting the derivative to zero, $\\frac{dE}{dk}=0$, gives two conditions for stationary points:\n1. $\\sin(ka) = 0$: This occurs at $ka=n\\pi$ for integer $n$. In the first Brillouin zone ($k \\in [-\\pi/a, \\pi/a]$), this gives $k=0$ and $k=\\pm\\pi/a$. These are the standard band-edge singularities that always exist.\n2. $t_1 + 4t_2\\cos(ka) = 0$: This yields $\\cos(ka) = -\\frac{t_1}{4t_2}$.\n\nAn additional van Hove singularity, distinct from the band-edge ones, appears if there is a real solution for $k$ from the second condition. The existence of a real solution for $k$ depends on the value of $\\cos(ka)$, which must be within the range $[-1, 1]$. Therefore, a solution exists if and only if:\n$$ \\left| -\\frac{t_1}{4t_2} \\right| \\le 1 \\implies |t_1| \\le 4|t_2| $$\nA distinct additional singularity arises when the strict inequality $|t_1| < 4|t_2|$ holds. If $|t_1| = 4|t_2|$, this additional singularity merges with one of the band-edge singularities (at $k=0$ if $t_1=-4t_2$, or $k=\\pm \\pi/a$ if $t_1=4t_2$). Thus, the condition for the appearance of an additional, non-band-edge singularity is $|t_1| < 4|t_2|$. The crystal momenta at which these singularities occur are determined by $k = \\pm \\frac{1}{a}\\arccos\\left(-\\frac{t_1}{4t_2}\\right)$.\n\nFor the third task, we evaluate the energy at the crystal momentum $k^*$ that satisfies the condition for the additional singularity, $\\cos(k^*a) = -\\frac{t_1}{4t_2}$. To do this, we substitute this into the dispersion relation $E(k)$. We also need the value of $\\cos(2k^*a)$, which can be found using the identity $\\cos(2\\theta) = 2\\cos^2(\\theta)-1$:\n$$ \\cos(2k^*a) = 2\\cos^2(k^*a) - 1 = 2\\left(-\\frac{t_1}{4t_2}\\right)^2 - 1 = 2\\frac{t_1^2}{16t_2^2} - 1 = \\frac{t_1^2}{8t_2^2} - 1 $$\nNow we substitute both $\\cos(k^*a)$ and $\\cos(2k^*a)$ into the energy expression:\n$$ E(k^*) = -2t_1\\cos(k^*a) - 2t_2\\cos(2k^*a) $$\n$$ E(k^*) = -2t_1\\left(-\\frac{t_1}{4t_2}\\right) - 2t_2\\left(\\frac{t_1^2}{8t_2^2} - 1\\right) $$\n$$ E(k^*) = \\frac{2t_1^2}{4t_2} - \\frac{2t_2 t_1^2}{8t_2^2} + 2t_2 $$\n$$ E(k^*) = \\frac{t_1^2}{2t_2} - \\frac{t_1^2}{4t_2} + 2t_2 $$\nCombining the terms with $t_1^2$:\n$$ E(k^*) = \\left(\\frac{1}{2} - \\frac{1}{4}\\right)\\frac{t_1^2}{t_2} + 2t_2 = \\frac{1}{4}\\frac{t_1^2}{t_2} + 2t_2 $$\nThus, the energy of the additional van Hove singularity is:\n$$ E_{vHs} = \\frac{t_1^2}{4t_2} + 2t_2 $$\nThis expression gives the energy level of the singularity in terms of the hopping parameters $t_1$ and $t_2$, which is the required final result.", "answer": "$$\\boxed{\\frac{t_{1}^{2}}{4t_{2}} + 2t_{2}}$$", "id": "2857754"}, {"introduction": "While stationary states describe a system's energy landscape, a full picture requires understanding its quantum dynamics as governed by the time-dependent Schrödinger equation, $i\\hbar \\frac{\\partial \\psi}{\\partial t} = H\\psi$. This computational practice guides you through implementing the powerful split-operator method to simulate the evolution of a wave packet, a task often intractable with purely analytical methods. By writing the code and analyzing its accuracy, you will develop a practical skill essential for modeling a wide range of dynamic quantum phenomena in materials [@problem_id:2857777].", "problem": "Implement a program that solves the one-dimensional time-dependent Schrödinger equation using the split-operator method based on the second-order Trotter (Strang) factorization, and numerically analyzes the global error scaling with respect to the time step. Begin from the fundamental law $i\\hbar \\frac{\\partial}{\\partial t}\\psi(x,t)=H\\psi(x,t)$, with the Hamiltonian split into $H=H_T+H_V$, where $H_T$ is the kinetic-energy operator and $H_V$ is the potential-energy operator. Use Hartree atomic units, where $\\hbar=1$ and the electron mass $m=1$; all quantities are thus dimensionless in this unit system. Define $H_T = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$ and $H_V=V(x)$, so that $H_T$ is diagonal in momentum space and $H_V$ is diagonal in position space. The second-order Trotter factorization approximates one step of time evolution by\n$$\ne^{-i(H_T+H_V)\\Delta t}\\approx e^{-iH_V\\Delta t/2}\\,e^{-iH_T\\Delta t}\\,e^{-iH_V\\Delta t/2},\n$$\nwhich is unitary and has a local error of order $\\mathcal{O}(\\Delta t^3)$.\n\nYou must implement this approximation using the Fast Fourier Transform (FFT) to apply $e^{-iH_T\\Delta t}$ in momentum space and $e^{-iH_V\\Delta t/2}$ in position space. For the convergence study, restrict to the harmonic oscillator potential $V(x)=\\frac{1}{2}\\omega^2 x^2$ and choose as the initial state the exact normalized ground state of the harmonic oscillator,\n$$\n\\psi_0(x)=\\left(\\frac{\\omega}{\\pi}\\right)^{1/4}\\exp\\!\\left(-\\frac{\\omega x^2}{2}\\right).\n$$\nIn atomic units, the ground-state energy is $E_0=\\frac{\\omega}{2}$, so the exact wave function at time $t$ is $\\psi_{\\text{exact}}(x,t)=\\psi_0(x)\\,e^{-iE_0 t}$.\n\nDiscretize space on a uniform grid of $N$ points over a domain of length $L$ using periodic boundary conditions implied by the FFT. Let the grid spacing be $\\Delta x=L/N$, with coordinates chosen as $x_j=-L/2 + j\\,\\Delta x$ for $j\\in\\{0,1,\\dots,N-1\\}$. Implement the following for each time step $\\Delta t$:\n- Apply the potential half-step in position space: $\\psi(x)\\leftarrow e^{-iV(x)\\Delta t/2}\\psi(x)$.\n- Apply the kinetic full-step in momentum space: $\\tilde{\\psi}(k)=\\mathcal{F}[\\psi(x)]$, then $\\tilde{\\psi}(k)\\leftarrow e^{-ik^2\\Delta t/2}\\tilde{\\psi}(k)$, and then $\\psi(x)=\\mathcal{F}^{-1}[\\tilde{\\psi}(k)]$, where $k$ is the angular wavenumber defined by the FFT frequency convention and $k^2$ appears from $H_T$ in atomic units.\n- Apply the potential half-step again in position space.\n\nFor each specified $\\Delta t$, propagate the initial state for a total time $T$ using $n=T/\\Delta t$ steps (assume $n$ is an integer) and compute the discrete $L^2$-error at time $T$:\n$$\nE(\\Delta t)=\\left(\\sum_{j=0}^{N-1}\\left|\\psi_{\\text{num}}(x_j,T)-\\psi_{\\text{exact}}(x_j,T)\\right|^2\\,\\Delta x\\right)^{1/2}.\n$$\nNormalize the initial state numerically so that $\\sum_j|\\psi_0(x_j)|^2\\,\\Delta x=1$. In all computations, use double-precision complex arithmetic.\n\nAnalyze the global error scaling by fitting a line to $\\log E(\\Delta t)$ versus $\\log \\Delta t$ for a given set of $\\Delta t$ values and reporting the slope $s$, which should reflect second-order accuracy, i.e., $E(\\Delta t)\\propto \\Delta t^2$ implying $s \\approx 2$. For additional quantitative checks, also compute successive error ratios $E(\\Delta t)/E(\\Delta t/2)$.\n\nUse the following three test cases. For each case, all parameters must be implemented exactly as given. All quantities are in atomic units.\n\n- Test Case $1$ (general case):\n  - Harmonic oscillator with angular frequency $\\omega=1.0$.\n  - Spatial domain length $L=20.0$ and number of grid points $N=4096$.\n  - Total propagation time $T=1.0$.\n  - Time steps $\\Delta t\\in\\{0.2,\\,0.1,\\,0.05,\\,0.025\\}$.\n  - Outputs to report for this case:\n    - The fitted slope $s_1$ from linear regression of $\\log E(\\Delta t)$ versus $\\log \\Delta t$.\n    - The three successive error ratios $r_{1a}=E(0.2)/E(0.1)$, $r_{1b}=E(0.1)/E(0.05)$, and $r_{1c}=E(0.05)/E(0.025)$.\n\n- Test Case $2$ (stronger confinement):\n  - Harmonic oscillator with angular frequency $\\omega=2.0$.\n  - Spatial domain length $L=20.0$ and number of grid points $N=4096$.\n  - Total propagation time $T=1.0$.\n  - Time steps $\\Delta t\\in\\{0.2,\\,0.1,\\,0.05,\\,0.025\\}$.\n  - Output to report: the fitted slope $s_2$.\n\n- Test Case $3$ (longer time):\n  - Harmonic oscillator with angular frequency $\\omega=1.0$.\n  - Spatial domain length $L=20.0$ and number of grid points $N=4096$.\n  - Total propagation time $T=2.0$.\n  - Time steps $\\Delta t\\in\\{0.2,\\,0.1,\\,0.05,\\,0.025\\}$.\n  - Output to report: the fitted slope $s_3$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets with the following order and rounding:\n- $[s_1,\\,r_{1a},\\,r_{1b},\\,r_{1c},\\,s_2,\\,s_3]$,\n- where each number is rounded to exactly $6$ decimal places.\n\nAll mathematical quantities are dimensionless in atomic units. No angles are reported, and all final outputs are pure numbers without units. Ensure the spatial discretization is sufficiently accurate so that the observed scaling is dominated by time-discretization error for the specified parameters. Your implementation must be self-contained and must not require any external input files.", "solution": "The problem presented is a standard exercise in computational quantum mechanics and is deemed valid. It is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. We will proceed with the formulation of the solution.\n\nThe fundamental task is to solve the one-dimensional time-dependent Schrödinger equation (TDSE) for a particle in a potential $V(x)$. In Hartree atomic units, where the reduced Planck constant $\\hbar$ and the electron mass $m$ are both unity, the TDSE is given by:\n$$\ni \\frac{\\partial}{\\partial t}\\psi(x,t) = \\hat{H}\\psi(x,t)\n$$\nThe Hamiltonian operator $\\hat{H}$ is the sum of the kinetic energy operator $\\hat{H}_T$ and the potential energy operator $\\hat{H}_V$:\n$$\n\\hat{H} = \\hat{H}_T + \\hat{H}_V = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} + V(x)\n$$\nThe formal solution for the evolution of the wavefunction $\\psi(x,t)$ from time $t$ to $t+\\Delta t$ is expressed via the time evolution operator $\\hat{U}(\\Delta t) = e^{-i\\hat{H}\\Delta t}$:\n$$\n\\psi(x, t+\\Delta t) = e^{-i\\hat{H}\\Delta t} \\psi(x,t)\n$$\nDirect numerical application of this exponential operator is intractable because the kinetic and potential operators, $\\hat{H}_T$ and $\\hat{H}_V$, do not commute, i.e., $[\\hat{H}_T, \\hat{H}_V] \\neq 0$. This non-commutativity prevents the simple factorization $e^{-i(\\hat{H}_T + \\hat{H}_V)\\Delta t} = e^{-i\\hat{H}_T\\Delta t} e^{-i\\hat{H}_V\\Delta t}$.\n\nTo circumvent this, we employ the split-operator method, which is based on a Trotter-Suzuki product formula. The specific variant requested is the second-order symmetric Strang splitting, which approximates the evolution operator for a small time step $\\Delta t$ as:\n$$\n\\hat{U}(\\Delta t) = e^{-i(\\hat{H}_T + \\hat{H}_V)\\Delta t} \\approx e^{-i\\hat{H}_V\\Delta t/2} \\, e^{-i\\hat{H}_T\\Delta t} \\, e^{-i\\hat{H}_V\\Delta t/2}\n$$\nThis approximation is unitary, preserving the norm of the wavefunction, and has a local error of order $\\mathcal{O}(\\Delta t^3)$. Propagating the system for a total time $T$ requires $n = T/\\Delta t$ steps, resulting in a global error of order $\\mathcal{O}(\\Delta t^2)$. This is the scaling behavior we must verify.\n\nThe power of this method lies in its implementation. The operator $\\hat{H}_V$ is diagonal in the position basis (its action is simple multiplication by the function $V(x)$), while the operator $\\hat{H}_T$ is diagonal in the momentum basis. The Fast Fourier Transform (FFT) provides a highly efficient numerical means of transforming the wavefunction between the position basis and the momentum basis.\n\nLet the wavefunction be represented on a discrete spatial grid of $N$ points, $\\{x_j\\}$, with spacing $\\Delta x = L/N$. The corresponding momentum (wavenumber) grid $\\{k_j\\}$ is determined by the properties of the discrete Fourier transform. The algorithm for propagating the wavefunction $\\psi(x)$ over one time step $\\Delta t$ is as follows:\n\n1.  **First Potential Half-Step**: The wavefunction is in the position representation. We apply the first half of the potential propagator, which is a simple multiplication:\n    $$\n    \\psi(x_j, t + \\Delta t/2) = e^{-iV(x_j)\\Delta t/2} \\psi(x_j, t)\n    $$\n    For the specified harmonic oscillator potential, $V(x) = \\frac{1}{2}\\omega^2 x^2$.\n\n2.  **Kinetic Full-Step**: To apply the kinetic propagator, we transform the wavefunction to the momentum representation using the FFT:\n    $$\n    \\tilde{\\psi}(k_j, t + \\Delta t/2) = \\mathcal{F}[\\psi(x_j, t + \\Delta t/2)]\n    $$\n    In momentum space, the operator $\\hat{H}_T = \\hat{p}^2/2$ becomes multiplication by the function $k^2/2$ (since $p=k$ in our units). The kinetic evolution is thus:\n    $$\n    \\tilde{\\psi}(k_j, t + \\Delta t/2)_{\\text{after}} = e^{-ik_j^2\\Delta t/2} \\tilde{\\psi}(k_j, t + \\Delta t/2)\n    $$\n    The wavefunction is then transformed back to the position representation using the inverse FFT (iFFT):\n    $$\n    \\psi'(x_j, t + \\Delta t/2) = \\mathcal{F}^{-1}[\\tilde{\\psi}(k_j, t + \\Delta t/2)_{\\text{after}}]\n    $$\n\n3.  **Second Potential Half-Step**: The final step is to apply the second half of the potential propagator in the position representation:\n    $$\n    \\psi(x_j, t + \\Delta t) = e^{-iV(x_j)\\Delta t/2} \\psi'(x_j, t + \\Delta t/2)\n    $$\n\nThis three-step sequence advances the state from $t$ to $t + \\Delta t$. It is repeated $n = T/\\Delta t$ times to reach the final time $T$.\n\nFor the convergence analysis, we use the exact ground state of the quantum harmonic oscillator as the initial state, $\\psi(x,0) = \\psi_0(x)$. This is an eigenstate of the Hamiltonian with energy $E_0 = \\omega/2$. Therefore, the exact time-evolved state is known analytically:\n$$\n\\psi_{\\text{exact}}(x,t) = \\psi_0(x) \\, e^{-iE_0 t}\n$$\nAfter obtaining the numerical solution $\\psi_{\\text{num}}(x_j, T)$ at the final time $T$, we compute the discrete $L^2$-error:\n$$\nE(\\Delta t) = \\left(\\sum_{j=0}^{N-1} |\\psi_{\\text{num}}(x_j, T) - \\psi_{\\text{exact}}(x_j, T)|^2 \\Delta x\\right)^{1/2}\n$$\nThe order of convergence is determined by analyzing the relationship $E(\\Delta t) \\propto (\\Delta t)^s$. In logarithmic scale, this becomes $\\log E = s \\log \\Delta t + C$, which is a linear relationship. We perform a linear regression on the $(\\log \\Delta t, \\log E)$ data points to find the slope $s$, which should be approximately $2$. Additionally, for a method of order $s$, the ratio of errors for successive step sizes $E(\\Delta t) / E(\\Delta t/2)$ should approach $2^s$. For $s=2$, this ratio is $4$.\n\nThe computational procedure is thus: for each test case, we set up the spatial grid, define and normalize the initial wavefunction, and pre-calculate the exact solution at time $T$. We then iterate through the specified list of time steps $\\Delta t$. For each $\\Delta t$, we run the split-operator simulation and compute the final error $E(\\Delta t)$. Finally, we use the collected error data to compute the required slope and error ratios. This entire process is encapsulated in the provided Python code.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef run_simulation(omega, L, N, T, delta_t_list):\n    \"\"\"\n    Runs a simulation for a given set of parameters and returns the error analysis.\n\n    Args:\n        omega (float): Angular frequency of the harmonic oscillator.\n        L (float): Length of the spatial domain.\n        N (int): Number of grid points.\n        T (float): Total propagation time.\n        delta_t_list (list of float): List of time steps for the convergence study.\n\n    Returns:\n        tuple: A tuple containing the fitted slope (float) and a list of error ratios (list of float).\n    \"\"\"\n\n    # 1. Setup spatial and momentum grids\n    dx = L / N\n    x = -L / 2 + np.arange(N) * dx\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # 2. Define initial and exact final wavefunctions\n    # The initial state is the analytic ground state of the harmonic oscillator.\n    # We ensure it is a complex array for subsequent calculations.\n    psi0_analytic = ((omega / np.pi)**0.25 * np.exp(-omega * x**2 / 2)).astype(np.complex128)\n\n    # Numerically normalize the initial state on the discrete grid.\n    norm_factor = np.sqrt(np.sum(np.abs(psi0_analytic)**2) * dx)\n    psi0 = psi0_analytic / norm_factor\n\n    # The exact state at time T is the initial state multiplied by a phase factor.\n    # We use the numerically normalized psi0 for consistency.\n    E0 = omega / 2\n    psi_exact_T = psi0 * np.exp(-1j * E0 * T)\n\n    errors = []\n    \n    # Define the potential energy operator V(x)\n    V = 0.5 * omega**2 * x**2\n\n    # 3. Time evolution loop for each delta_t\n    for dt in delta_t_list:\n        n_steps = int(round(T / dt))\n        psi_current = psi0.copy()\n        \n        # Pre-compute time-evolution operators for this dt\n        exp_V_half = np.exp(-1j * V * dt / 2)\n        exp_T_full = np.exp(-1j * k**2 * dt / 2)\n        \n        for _ in range(n_steps):\n            # Apply first potential half-step in position space\n            psi_current *= exp_V_half\n            \n            # Apply kinetic full-step in momentum space\n            psi_k = np.fft.fft(psi_current)\n            psi_k *= exp_T_full\n            psi_current = np.fft.ifft(psi_k)\n            \n            # Apply second potential half-step in position space\n            psi_current *= exp_V_half\n            \n        # 4. Compute L2 error\n        error = np.sqrt(np.sum(np.abs(psi_current - psi_exact_T)**2) * dx)\n        errors.append(error)\n\n    # 5. Analyze error scaling\n    log_dt = np.log(delta_t_list)\n    log_E = np.log(errors)\n    \n    # Fit a line to log(E) vs log(dt) to find the slope\n    slope, _, _, _, _ = linregress(log_dt, log_E)\n    \n    # Compute successive error ratios\n    ratios = [errors[i] / errors[i+1] for i in range(len(errors) - 1)]\n    \n    return slope, ratios\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n    \n    # Common Parameters\n    L = 20.0\n    N = 4096\n    delta_t_list = [0.2, 0.1, 0.05, 0.025]\n\n    # Test Case 1: General case\n    omega1 = 1.0\n    T1 = 1.0\n    s1, ratios1 = run_simulation(omega1, L, N, T1, delta_t_list)\n    r1a, r1b, r1c = ratios1[0], ratios1[1], ratios1[2]\n    \n    # Test Case 2: Stronger confinement\n    omega2 = 2.0\n    T2 = 1.0\n    s2, _ = run_simulation(omega2, L, N, T2, delta_t_list)\n\n    # Test Case 3: Longer time\n    omega3 = 1.0\n    T3 = 2.0\n    s3, _ = run_simulation(omega3, L, N, T3, delta_t_list)\n    \n    # Consolidate and format results\n    results = [s1, r1a, r1b, r1c, s2, s3]\n    formatted_results = [f\"{num:.6f}\" for num in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2857777"}]}