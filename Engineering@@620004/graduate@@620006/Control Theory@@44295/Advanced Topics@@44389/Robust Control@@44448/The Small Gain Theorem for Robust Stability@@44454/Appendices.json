{"hands_on_practices": [{"introduction": "We begin with a fundamental exercise to build your intuition for the Small Gain Theorem. This practice involves calculating the $\\mathcal{H}_{\\infty}$ norm for a standard second-order system directly from its definition as the peak of the frequency response magnitude. By determining the maximum gain, you will then apply the small-gain condition to find the precise range of a scaling factor that maintains robust stability, a core skill in robust control analysis [@problem_id:2754153].", "problem": "Consider a stable Single-Input Single-Output (SISO) Linear Time-Invariant (LTI) plant with transfer function $G(s)=\\dfrac{k}{(s+a)(s+b)}$, where $a>0$, $b>0$, and $k \\in \\mathbb{R}$. The plant is interconnected in a standard negative-feedback loop with a stable, causal uncertainty $\\Delta(s)$ satisfying the Hardy space infinity norm ($\\mathcal{H}_{\\infty}$) bound $\\|\\Delta\\|_{\\infty} \\leq 1$. The small gain theorem asserts that the closed loop is robustly stable if the loop gain satisfies $\\|G\\|_{\\infty} \\|\\Delta\\|_{\\infty} < 1$. Using only the fundamental definition of the $\\mathcal{H}_{\\infty}$ norm as the least upper bound of the maximum singular value of the frequency response over all frequencies, compute $\\|G\\|_{\\infty}$ in closed form as a function of $a$, $b$, and $k$. Then determine the supremum value $k_{\\max}$ of the magnitude of $k$ such that for every $|k|<k_{\\max}$, the small-gain robust stability condition is guaranteed for all $\\Delta$ with $\\|\\Delta\\|_{\\infty}\\leq 1$. Provide your final answer as a two-entry row matrix $\\big[\\,\\|G\\|_{\\infty},\\;k_{\\max}\\,\\big]$. No numerical rounding is required. Do not include units.", "solution": "The problem is subjected to validation and is deemed to be valid. It is a well-posed, scientifically grounded problem in the field of robust control theory. All necessary data and definitions are provided, and there are no contradictions or ambiguities. I will proceed with the solution.\n\nThe problem is divided into two parts. First, we must compute the $\\mathcal{H}_{\\infty}$ norm of the given plant transfer function $G(s)$. Second, we must use this result to find the supremum value of the gain magnitude, $k_{\\max}$, that guarantees robust stability via the small gain theorem.\n\n**Part 1: Computation of $\\|G\\|_{\\infty}$**\n\nThe plant is a Single-Input Single-Output (SISO) Linear Time-Invariant (LTI) system with the transfer function:\n$$G(s) = \\frac{k}{(s+a)(s+b)}$$\nwhere $a > 0$, $b > 0$, and $k \\in \\mathbb{R}$. The conditions on $a$ and $b$ ensure that the poles of the system, at $s=-a$ and $s=-b$, are in the open left-half of the complex plane, confirming the stated stability of the plant.\n\nThe $\\mathcal{H}_{\\infty}$ norm of a stable SISO LTI system is defined as the supremum of the magnitude of its frequency response. For a transfer function $G(s)$, this is:\n$$ \\|G\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} |G(j\\omega)| $$\nWe obtain the frequency response function $G(j\\omega)$ by substituting $s=j\\omega$ into $G(s)$:\n$$G(j\\omega) = \\frac{k}{(j\\omega+a)(j\\omega+b)}$$\nThe magnitude of the frequency response is:\n$$|G(j\\omega)| = \\frac{|k|}{|j\\omega+a| |j\\omega+b|}$$\nThe magnitudes of the complex numbers in the denominator are $|j\\omega+a| = \\sqrt{a^2+\\omega^2}$ and $|j\\omega+b| = \\sqrt{b^2+\\omega^2}$. Therefore:\n$$|G(j\\omega)| = \\frac{|k|}{\\sqrt{(a^2+\\omega^2)(b^2+\\omega^2)}}$$\nTo find the supremum of $|G(j\\omega)|$, we must find the minimum of the denominator term, $\\sqrt{(a^2+\\omega^2)(b^2+\\omega^2)}$, with respect to the frequency $\\omega$. Maximizing a positive function is equivalent to maximizing its square, which is often simpler. Let us define a function $M(\\omega)$ as the square of the magnitude:\n$$M(\\omega) = |G(j\\omega)|^2 = \\frac{k^2}{(a^2+\\omega^2)(b^2+\\omega^2)}$$\nMaximizing $M(\\omega)$ is equivalent to minimizing its denominator, which we denote as $D(\\omega)$:\n$$D(\\omega) = (a^2+\\omega^2)(b^2+\\omega^2) = \\omega^4 + (a^2+b^2)\\omega^2 + a^2b^2$$\nTo find the minimum of $D(\\omega)$ for $\\omega \\in \\mathbb{R}$, we compute its derivative with respect to $\\omega$ and set it to zero.\n$$\\frac{dD}{d\\omega} = 4\\omega^3 + 2(a^2+b^2)\\omega = 2\\omega(2\\omega^2 + a^2+b^2)$$\nWe set the derivative to zero to find the critical points:\n$$2\\omega(2\\omega^2 + a^2+b^2) = 0$$\nSince $a > 0$ and $b > 0$, it follows that $a^2 > 0$ and $b^2 > 0$. For any real $\\omega$, $\\omega^2 \\ge 0$. Thus, the term $(2\\omega^2 + a^2+b^2)$ is strictly positive. The only real solution to the equation is therefore $\\omega = 0$.\n\nTo confirm that this critical point corresponds to a minimum of $D(\\omega)$, we examine the second derivative:\n$$\\frac{d^2D}{d\\omega^2} = 12\\omega^2 + 2(a^2+b^2)$$\nAt $\\omega=0$, the second derivative is $\\left.\\frac{d^2D}{d\\omega^2}\\right|_{\\omega=0} = 2(a^2+b^2)$. Since $a^2 > 0$ and $b^2 > 0$, this value is strictly positive, confirming that $D(\\omega)$ has a local minimum at $\\omega=0$. As this is the only critical point for $\\omega \\ge 0$ and $D(\\omega) \\to \\infty$ as $\\omega \\to \\infty$, this is the global minimum.\n\nTherefore, the maximum of $|G(j\\omega)|$ occurs at $\\omega=0$. We evaluate $|G(j\\omega)|$ at this frequency:\n$$ \\|G\\|_{\\infty} = |G(j0)| = \\frac{|k|}{\\sqrt{(a^2+0)(b^2+0)}} = \\frac{|k|}{\\sqrt{a^2b^2}} $$\nSince $a > 0$ and $b > 0$, we have $ab > 0$, and thus $\\sqrt{a^2b^2} = ab$. The $\\mathcal{H}_{\\infty}$ norm of the plant is:\n$$ \\|G\\|_{\\infty} = \\frac{|k|}{ab} $$\n\n**Part 2: Determination of $k_{\\max}$**\n\nThe small gain theorem states that the negative feedback interconnection of $G(s)$ and $\\Delta(s)$ is robustly stable if the loop gain is less than unity:\n$$ \\|G\\|_{\\infty} \\|\\Delta\\|_{\\infty} < 1 $$\nWe are given that the stable, causal uncertainty $\\Delta(s)$ satisfies the bound $\\|\\Delta\\|_{\\infty} \\le 1$. To guarantee stability for all possible uncertainties satisfying this bound, we must satisfy the condition for the worst-case uncertainty, which is the one where $\\|\\Delta\\|_{\\infty}$ is maximal, i.e., $\\|\\Delta\\|_{\\infty} = 1$. The condition for robust stability thus becomes:\n$$ \\|G\\|_{\\infty} \\cdot 1 < 1 \\implies \\|G\\|_{\\infty} < 1 $$\nSubstituting the expression for $\\|G\\|_{\\infty}$ derived in Part 1:\n$$ \\frac{|k|}{ab} < 1 $$\nSolving for $|k|$, we obtain:\n$$ |k| < ab $$\nThe problem asks for the supremum value $k_{\\max}$ of a positive number such that for every $|k| < k_{\\max}$, the robust stability condition $|k| < ab$ is guaranteed. This implies that the interval $(-k_{\\max}, k_{\\max})$ must be a subset of the interval $(-ab, ab)$. The largest such $k_{\\max}$ is therefore $ab$.\nIn other words, the set of values of $|k|$ for which the system is robustly stable is $[0, ab)$. The supremum (least upper bound) of this set is $ab$.\n$$k_{\\max} = ab$$\n\nThe final answer is to be provided as a two-entry row matrix containing $\\|G\\|_{\\infty}$ and $k_{\\max}$.\n\nFirst entry: $\\|G\\|_{\\infty} = \\frac{|k|}{ab}$\nSecond entry: $k_{\\max} = ab$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{|k|}{ab} & ab\n\\end{pmatrix}\n}\n$$", "id": "2754153"}, {"introduction": "Building on the single-input, single-output (SISO) case, we now extend our analysis to a multiple-input, multiple-output (MIMO) system. For MIMO systems, the concept of \"gain\" is captured by singular values, and the $\\mathcal{H}_{\\infty}$ norm is the peak of the maximum singular value over frequency. This exercise [@problem_id:2754159] simplifies the singular value computation by providing the system in a diagonalized form, allowing you to focus on the core principles of applying the Small Gain Theorem in a multidimensional context.", "problem": "Consider the stable multiple-input multiple-output transfer matrix $G(s) \\in \\mathbb{R}^{2 \\times 2}$ defined by\n$$\nG(s) \\;=\\; U \\begin{bmatrix} g_{1}(s) & 0 \\\\ 0 & g_{2}(s) \\end{bmatrix} V^{\\top},\n$$\nwhere\n$$\nU \\;=\\; \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 & 1 \\\\ -1 & 1 \\end{bmatrix}, \n\\qquad\nV \\;=\\; \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 & -1 \\\\ 1 & 1 \\end{bmatrix},\n$$\nand\n$$\ng_{1}(s) \\;=\\; \\frac{3}{s+2},\n\\qquad\ng_{2}(s) \\;=\\; \\frac{s+1}{s^{2}+s+1}.\n$$\nLet $\\Delta(s)$ be an unknown, stable, time-invariant, unstructured operator with induced $L_{2}$-gain (equivalently, Hardy space $\\mathcal{H}_{\\infty}$ norm) bounded by a scalar $\\delta \\ge 0$, i.e., $\\|\\Delta\\|_{\\infty} \\le \\delta$. Consider the standard well-posed feedback interconnection in which $z = G w$ and $w = \\Delta z$ so that the loop gain is $G \\Delta$.\n\nUsing only foundational definitions (induced $L_{2}$-gain, singular values, and the Small Gain Theorem), compute the exact value of the largest bound $\\delta_{\\max}$ such that, for all $\\Delta$ with $\\|\\Delta\\|_{\\infty} \\le \\delta_{\\max}$, the feedback interconnection is guaranteed to be internally stable by the Small Gain Theorem. In your derivation, you must determine the maximum singular value of $G(\\mathrm{j}\\omega)$ over all real frequencies $\\omega \\in \\mathbb{R}$.\n\nReport only the value of $\\delta_{\\max}$ as your final answer in exact form. No rounding is required.", "solution": "The problem will first be subjected to rigorous validation.\n\nStep 1: Extract Givens\nThe problem provides the following information:\n- A stable multiple-input multiple-output (MIMO) transfer matrix $G(s) \\in \\mathbb{R}^{2 \\times 2}$ defined by its singular value decomposition:\n$$\nG(s) \\;=\\; U \\begin{bmatrix} g_{1}(s) & 0 \\\\ 0 & g_{2}(s) \\end{bmatrix} V^{\\top}\n$$\n- The component matrices and functions are:\n$$\nU \\;=\\; \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 & 1 \\\\ -1 & 1 \\end{bmatrix}, \n\\qquad\nV \\;=\\; \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 & -1 \\\\ 1 & 1 \\end{bmatrix}\n$$\n$$\ng_{1}(s) \\;=\\; \\frac{3}{s+2},\n\\qquad\ng_{2}(s) \\;=\\; \\frac{s+1}{s^{2}+s+1}\n$$\n- A feedback configuration with a stable, time-invariant, unstructured operator $\\Delta(s)$ whose induced $L_{2}$-gain ($\\mathcal{H}_{\\infty}$ norm) is bounded by $\\delta \\ge 0$: $\\|\\Delta\\|_{\\infty} \\le \\delta$.\n- The feedback loop is described by $z = G w$ and $w = \\Delta z$.\n- The objective is to find the largest bound $\\delta_{\\max}$ that guarantees internal stability of the feedback interconnection by the Small Gain Theorem.\n\nStep 2: Validate Using Extracted Givens\nThe problem is subjected to validation against the required criteria.\n- **Scientifically Grounded**: The problem is a standard exercise in robust control theory, specifically concerning the application of the Small Gain Theorem to a linear time-invariant (LTI) system with unstructured uncertainty. The concepts of transfer matrices, $\\mathcal{H}_{\\infty}$ norms, and singular value decomposition are fundamental to this field. The systems $g_1(s)$ and $g_2(s)$ have poles with negative real parts ($s=-2$ for $g_1(s)$, and $s = -1/2 \\pm j\\sqrt{3}/2$ for $g_2(s)$), confirming the statement that $G(s)$ is stable. The setup is scientifically and mathematically sound.\n- **Well-Posed**: The problem is well-posed. It asks for a specific, unique quantity ($\\delta_{\\max}$) based on a complete set of definitions and data. The methodology is prescribed (\"Using only foundational definitions...\"), guiding toward a unique solution path.\n- **Objective**: The problem is stated in precise mathematical language, free of ambiguity, subjectivity, or non-scientific claims.\n\nStep 3: Verdict and Action\nThe problem is deemed **valid**. It is a clear and self-contained problem in control theory that requests a specific, calculable result based on established principles. We will now proceed with the complete solution.\n\nThe Small Gain Theorem provides a sufficient condition for the stability of the feedback interconnection. For the loop gain $L(s) = G(s)\\Delta(s)$, the closed-loop system is guaranteed to be internally stable if the $\\mathcal{H}_{\\infty}$ norm of the loop gain is strictly less than $1$, i.e., $\\|G\\Delta\\|_{\\infty} < 1$.\n\nThe $\\mathcal{H}_{\\infty}$ norm is submultiplicative. Therefore, a sufficient condition for stability is $\\|G\\|_{\\infty}\\|\\Delta\\|_{\\infty} < 1$.\nThe problem states that the uncertainty $\\Delta$ satisfies the bound $\\|\\Delta\\|_{\\infty} \\le \\delta$. To guarantee stability for any such $\\Delta$, we must satisfy the condition for the worst case, which corresponds to an operator with $\\|\\Delta\\|_{\\infty} = \\delta$. The condition thus becomes:\n$$\n\\|G\\|_{\\infty} \\delta < 1\n$$\nThe problem asks for the largest possible value of the bound, $\\delta_{\\max}$, such that for any $\\Delta$ with $\\|\\Delta\\|_{\\infty} \\le \\delta_{\\max}$, stability is guaranteed. This implies that we are seeking the supremum of all values $\\delta$ that satisfy $\\|G\\|_{\\infty}\\delta < 1$. This supremum is given by the equality:\n$$\n\\delta_{\\max} = \\frac{1}{\\|G\\|_{\\infty}}\n$$\nOur task reduces to computing the $\\mathcal{H}_{\\infty}$ norm of the transfer matrix $G(s)$. The $\\mathcal{H}_{\\infty}$ norm is defined as the supremum of the maximum singular value of the frequency response matrix over all frequencies $\\omega$:\n$$\n\\|G\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}(G(j\\omega))\n$$\nwhere $\\bar{\\sigma}(\\cdot)$ denotes the maximum singular value. The problem provides $G(s)$ in its singular value decomposition form, $G(s) = U D(s) V^{\\top}$, where $D(s)$ is the diagonal matrix of singular functions. The matrices $U$ and $V$ are constant, real matrices. We check if they are orthogonal:\n$$\nU^{\\top}U = \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 & -1 \\\\ 1 & 1 \\end{bmatrix} \\right) \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 & 1 \\\\ -1 & 1 \\end{bmatrix} \\right) = \\frac{1}{2} \\begin{bmatrix} 2 & 0 \\\\ 0 & 2 \\end{bmatrix} = I\n$$\n$$\nV^{\\top}V = \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 & 1 \\\\ -1 & 1 \\end{bmatrix} \\right) \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 & -1 \\\\ 1 & 1 \\end{bmatrix} \\right) = \\frac{1}{2} \\begin{bmatrix} 2 & 0 \\\\ 0 & 2 \\end{bmatrix} = I\n$$\nSince $U$ and $V$ are orthogonal (and thus unitary), the singular values of $G(j\\omega) = U D(j\\omega) V^{\\top}$ are identical to the singular values of the diagonal matrix $D(j\\omega)$. The singular values of a diagonal matrix are the absolute values of its diagonal entries. Therefore, the singular values of $G(j\\omega)$ are $|g_1(j\\omega)|$ and $|g_2(j\\omega)|$.\n\nThe maximum singular value of $G(j\\omega)$ is:\n$$\n\\bar{\\sigma}(G(j\\omega)) = \\max\\left\\{ |g_1(j\\omega)|, |g_2(j\\omega)| \\right\\}\n$$\nTo find $\\|G\\|_{\\infty}$, we must maximize this expression over all $\\omega$:\n$$\n\\|G\\|_{\\infty} = \\sup_{\\omega \\ge 0} \\max\\left\\{ |g_1(j\\omega)|, |g_2(j\\omega)| \\right\\} = \\max\\left\\{ \\sup_{\\omega \\ge 0} |g_1(j\\omega)|, \\sup_{\\omega \\ge 0} |g_2(j\\omega)| \\right\\} = \\max\\left\\{ \\|g_1\\|_{\\infty}, \\|g_2\\|_{\\infty} \\right\\}\n$$\nWe proceed to compute the $\\mathcal{H}_{\\infty}$ norm of each scalar transfer function.\n\nFor $g_1(s) = \\frac{3}{s+2}$:\nThe magnitude of the frequency response is\n$$\n|g_1(j\\omega)| = \\left| \\frac{3}{j\\omega+2} \\right| = \\frac{3}{\\sqrt{\\omega^2+4}}\n$$\nThis function is monotonically decreasing for $\\omega \\ge 0$. Its maximum value occurs at $\\omega=0$.\n$$\n\\|g_1\\|_{\\infty} = |g_1(j0)| = \\frac{3}{\\sqrt{0^2+4}} = \\frac{3}{2}\n$$\n\nFor $g_2(s) = \\frac{s+1}{s^2+s+1}$:\nThe magnitude of the frequency response is\n$$\n|g_2(j\\omega)| = \\left| \\frac{j\\omega+1}{(j\\omega)^2+j\\omega+1} \\right| = \\left| \\frac{1+j\\omega}{1-\\omega^2+j\\omega} \\right| = \\frac{\\sqrt{1+\\omega^2}}{\\sqrt{(1-\\omega^2)^2+\\omega^2}}\n$$\nTo find the maximum, it is easier to work with the squared magnitude. Let $x = \\omega^2$, where $x \\ge 0$.\n$$\n|g_2(j\\omega)|^2 = \\frac{1+\\omega^2}{(1-\\omega^2)^2+\\omega^2} = \\frac{1+\\omega^2}{1-2\\omega^2+\\omega^4+\\omega^2} = \\frac{1+\\omega^2}{1-\\omega^2+\\omega^4} =: h(x) = \\frac{1+x}{1-x+x^2}\n$$\nWe find the maximum of $h(x)$ for $x \\ge 0$ by finding the critical points from its derivative:\n$$\n\\frac{dh}{dx} = \\frac{(1)(1-x+x^2) - (1+x)(-1+2x)}{(1-x+x^2)^2} = \\frac{1-x+x^2 - (-1+2x-x+2x^2)}{(1-x+x^2)^2} = \\frac{1-x+x^2 - (2x^2+x-1)}{(1-x+x^2)^2} = \\frac{-x^2-2x+2}{(1-x+x^2)^2}\n$$\nSetting the numerator to zero to find the critical points: $-x^2-2x+2 = 0$, or $x^2+2x-2=0$.\nThe solutions for $x$ are $x = \\frac{-2 \\pm \\sqrt{4 - 4(1)(-2)}}{2} = \\frac{-2 \\pm \\sqrt{12}}{2} = -1 \\pm \\sqrt{3}$.\nSince $x = \\omega^2 \\ge 0$, we must take the positive root: $x_0 = \\sqrt{3}-1$.\nThe second derivative test or analysis of the sign of the first derivative shows this point is a maximum.\nThe maximum value of $h(x)$ is $h(x_0)$. We can simplify the evaluation by using the fact that $x_0^2 = 2-2x_0$.\n$$\nh(x_0) = \\frac{1+x_0}{1-x_0+x_0^2} = \\frac{1+x_0}{1-x_0+(2-2x_0)} = \\frac{1+x_0}{3-3x_0} = \\frac{1}{3} \\frac{1+x_0}{1-x_0}\n$$\nSubstituting $x_0 = \\sqrt{3}-1$:\n$$\n\\|g_2\\|_{\\infty}^2 = h(\\sqrt{3}-1) = \\frac{1}{3} \\frac{1+(\\sqrt{3}-1)}{1-(\\sqrt{3}-1)} = \\frac{1}{3} \\frac{\\sqrt{3}}{2-\\sqrt{3}} = \\frac{\\sqrt{3}}{3(2-\\sqrt{3})}\n$$\nRationalizing the denominator:\n$$\n\\|g_2\\|_{\\infty}^2 = \\frac{\\sqrt{3}}{3(2-\\sqrt{3})} \\frac{2+\\sqrt{3}}{2+\\sqrt{3}} = \\frac{\\sqrt{3}(2+\\sqrt{3})}{3(4-3)} = \\frac{2\\sqrt{3}+3}{3}\n$$\nNow we compare $\\|g_1\\|_{\\infty}^2$ and $\\|g_2\\|_{\\infty}^2$:\n$$\n\\|g_1\\|_{\\infty}^2 = \\left(\\frac{3}{2}\\right)^2 = \\frac{9}{4}\n$$\n$$\n\\|g_2\\|_{\\infty}^2 = \\frac{3+2\\sqrt{3}}{3}\n$$\nTo compare $\\frac{9}{4}$ and $\\frac{3+2\\sqrt{3}}{3}$, we can cross-multiply:\nCompare $9 \\times 3 = 27$ with $4 \\times (3+2\\sqrt{3}) = 12+8\\sqrt{3}$.\nThis is equivalent to comparing $27-12=15$ with $8\\sqrt{3}$.\nSquaring both positive numbers, we compare $15^2 = 225$ with $(8\\sqrt{3})^2 = 64 \\times 3 = 192$.\nSince $225 > 192$, it follows that $15 > 8\\sqrt{3}$, and thus $\\frac{9}{4} > \\frac{3+2\\sqrt{3}}{3}$.\nThis proves that $\\|g_1\\|_{\\infty}^2 > \\|g_2\\|_{\\infty}^2$, and therefore $\\|g_1\\|_{\\infty} > \\|g_2\\|_{\\infty}$.\n\nThe $\\mathcal{H}_{\\infty}$ norm of $G(s)$ is thus determined by $g_1(s)$:\n$$\n\\|G\\|_{\\infty} = \\max\\left\\{ \\frac{3}{2}, \\sqrt{\\frac{3+2\\sqrt{3}}{3}} \\right\\} = \\frac{3}{2}\n$$\nFinally, we compute the largest bound $\\delta_{\\max}$:\n$$\n\\delta_{\\max} = \\frac{1}{\\|G\\|_{\\infty}} = \\frac{1}{3/2} = \\frac{2}{3}\n$$\nThis is the exact value required.", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "2754159"}, {"introduction": "The Small Gain Theorem provides a powerful but sometimes conservative test for robust stability. This advanced practice [@problem_id:2754167] explores this conservatism by introducing a more refined tool: the structured singular value, or $\\mu$. By comparing the standard small-gain margin with the margin derived from $\\mu$-analysis for a specific uncertainty structure, this computational exercise reveals how incorporating structural information can lead to a much less conservative and more accurate assessment of robustness.", "problem": "You are given a Linear Time-Invariant (LTI) complex-valued transfer matrix function $M(s)$ and a structured uncertainty $\\Delta$ modeled as a single repeated complex scalar full block of size $n$, that is $\\Delta = \\delta I_n$ with $\\delta \\in \\mathbb{C}$ and $I_n$ the identity matrix of size $n \\times n$. The structured singular value (also called $\\mu$) associated with this structure is defined, for each fixed frequency $\\omega \\in \\mathbb{R}_{\\ge 0}$, by the standard definition\n$$\n\\mu_{\\Delta}\\big(M(j\\omega)\\big) \\triangleq \\left( \\inf \\left\\{ \\|\\Delta\\| : \\det\\big(I - M(j\\omega)\\Delta\\big) = 0 \\right\\} \\right)^{-1}.\n$$\nFor the specified structure $\\Delta = \\delta I_n$, the robust stability margin induced by $\\mu$ is\n$$\n\\gamma_{\\mu} \\triangleq \\left( \\sup_{\\omega \\in [0,\\infty)} \\mu_{\\Delta}\\big(M(j\\omega)\\big) \\right)^{-1}.\n$$\nThe unstructured small-gain margin is\n$$\n\\gamma_{\\mathrm{sg}} \\triangleq \\left\\| M \\right\\|_{\\infty}^{-1} = \\left( \\sup_{\\omega \\in [0,\\infty)} \\overline{\\sigma}\\big(M(j\\omega)\\big) \\right)^{-1},\n$$\nwhere $\\overline{\\sigma}(\\cdot)$ denotes the maximum singular value. Your task is to set up the frequency-by-frequency computation of $\\mu_{\\Delta}\\big(M(j\\omega)\\big)$ specialized to the given block structure, compute $\\gamma_{\\mu}$, and compare it against $\\gamma_{\\mathrm{sg}}$.\n\nFundamental base you may assume: the definition of the structured singular value $\\mu$, properties of eigenvalues and singular values of complex matrices, and the frequency response evaluation of rational transfer functions $G(s) = N(s)/D(s)$ by substitution $s = j\\omega$, where $j^2 = -1$. Do not use any pre-packaged $\\mu$-analysis routines.\n\nUse the following frequency grid for all computations: $\\omega$ logarithmically spaced over $\\omega \\in [10^{-2}, 10^{3}]$ rad/s, with exactly $1000$ points. For each test case, compute\n- $\\gamma_{\\mu} = \\left( \\sup_{\\omega} \\rho\\big(M(j\\omega)\\big) \\right)^{-1}$, where $\\rho(\\cdot)$ denotes the spectral radius (maximum modulus of eigenvalues),\n- $\\gamma_{\\mathrm{sg}} = \\left( \\sup_{\\omega} \\overline{\\sigma}\\big(M(j\\omega)\\big) \\right)^{-1}$.\n\nIf the supremum in the denominator is $0$ for a given case, return $+\\infty$ for the corresponding margin.\n\nImplement a program that evaluates $M(j\\omega)$ entrywise by rational function evaluation using the provided numerator and denominator coefficient arrays for each transfer function entry, where each entry has the form $G_{ij}(s) = \\dfrac{N_{ij}(s)}{D_{ij}(s)}$ with real-coefficient polynomials $N_{ij}(s)$ and $D_{ij}(s)$. Coefficient arrays are ordered from highest to lowest degree. All answers must be expressed as dimensionless quantities (no physical units appear in the output). Angles are in rad/s.\n\nTest Suite:\nFor each case below, $M(s)$ is $2 \\times 2$ and the uncertainty structure is a single repeated scalar full block $\\Delta = \\delta I_2$.\n\n- Case A (coupled, non-normal):\n  - $M_{11}(s) = \\dfrac{1.2}{s + 1}$, numerator $[\\,1.2\\,]$, denominator $[\\,1,\\,1\\,]$.\n  - $M_{12}(s) = \\dfrac{0.4}{s + 0.5}$, numerator $[\\,0.4\\,]$, denominator $[\\,1,\\,0.5\\,]$.\n  - $M_{21}(s) = \\dfrac{-0.6}{s + 2}$, numerator $[\\,{-0.6}\\,]$, denominator $[\\,1,\\,2\\,]$.\n  - $M_{22}(s) = \\dfrac{0.9 s + 0.3}{(s + 1.5)(s + 3)}$, numerator $[\\,0.9,\\,0.3\\,]$, denominator $[\\,1,\\,4.5,\\,4.5\\,]$.\n\n- Case B (diagonal, normal):\n  - $M_{11}(s) = \\dfrac{0.7}{s + 0.7}$, numerator $[\\,0.7\\,]$, denominator $[\\,1,\\,0.7\\,]$.\n  - $M_{12}(s) = 0$, numerator $[\\,0\\,]$, denominator $[\\,1\\,]$.\n  - $M_{21}(s) = 0$, numerator $[\\,0\\,]$, denominator $[\\,1\\,]$.\n  - $M_{22}(s) = \\dfrac{0.5}{s + 2.0}$, numerator $[\\,0.5\\,]$, denominator $[\\,1,\\,2.0\\,]$.\n\n- Case C (weakly coupled):\n  - $M_{11}(s) = \\dfrac{0.2}{s + 0.2}$, numerator $[\\,0.2\\,]$, denominator $[\\,1,\\,0.2\\,]$.\n  - $M_{12}(s) = \\dfrac{0.05}{s + 5}$, numerator $[\\,0.05\\,]$, denominator $[\\,1,\\,5\\,]$.\n  - $M_{21}(s) = \\dfrac{0.1}{s + 5}$, numerator $[\\,0.1\\,]$, denominator $[\\,1,\\,5\\,]$.\n  - $M_{22}(s) = \\dfrac{0.3}{s + 0.3}$, numerator $[\\,0.3\\,]$, denominator $[\\,1,\\,0.3\\,]$.\n\nFinal Output Format:\nYour program should produce a single line of output containing a list of results for the three cases, where each case is represented by a two-element list $[\\,\\gamma_{\\mu},\\,\\gamma_{\\mathrm{sg}}\\,]$, with each floating-point number rounded to six digits after the decimal point. The overall output must be a single list of the three case-results, for example, $[[a_1,b_1],[a_2,b_2],[a_3,b_3]]$, printed exactly on one line with no extra text.", "solution": "The problem statement presented is subjected to validation and is found to be scientifically grounded, well-posed, and self-contained. It describes a standard problem in robust control theory concerning the analysis of stability for a system with structured uncertainty. The definitions of the structured singular value $\\mu$, the structured stability margin $\\gamma_{\\mu}$, and the unstructured small-gain margin $\\gamma_{\\mathrm{sg}}$ are correct. The provided test cases are specified with sufficient detail to permit a unique computational solution. Thus, we proceed with the analysis.\n\nThe central task is to compare the stability margins derived from structured and unstructured uncertainty analyses. The unstructured margin, $\\gamma_{\\mathrm{sg}}$, is based on the small-gain theorem, which considers any stable perturbation $\\Delta$ with a bounded norm. The structured margin, $\\gamma_{\\mu}$, leverages knowledge of the specific structure of the uncertainty, in this case, a repeated complex scalar block $\\Delta = \\delta I_n$ with $\\delta \\in \\mathbb{C}$.\n\nFirst, we must formalize the computation of $\\mu_{\\Delta}(M(j\\omega))$ for the specified structure. By definition,\n$$\n\\mu_{\\Delta}(M) \\triangleq \\left( \\inf \\left\\{ \\|\\Delta\\| : \\det(I - M\\Delta) = 0 \\text{ for some } \\Delta \\text{ with the given structure} \\right\\} \\right)^{-1}.\n$$\nIf no such $\\Delta$ exists, the infimum is $\\infty$ and $\\mu_{\\Delta}(M) = 0$. For the structure $\\Delta = \\delta I_n$, the condition for instability becomes $\\det(I - M(\\delta I_n)) = \\det(I - \\delta M) = 0$. This equation holds if and only if $1$ is an eigenvalue of the matrix $\\delta M$, which is equivalent to stating that $\\frac{1}{\\delta}$ is a non-zero eigenvalue of $M$. Let the set of eigenvalues of $M$ be $\\{\\lambda_i(M)\\}$. Then, we must have $\\frac{1}{\\delta} = \\lambda_i(M)$ for some $i$. This implies $\\delta = \\frac{1}{\\lambda_i(M)}$ for any non-zero eigenvalue $\\lambda_i(M)$. The norm of the perturbation is $\\|\\Delta\\| = \\|\\delta I_n\\|_2 = |\\delta|$. To find the smallest destabilizing perturbation, we seek the infimum of $|\\delta|$:\n$$\n\\inf \\{|\\delta|\\} = \\inf_{i} \\left\\{ \\left| \\frac{1}{\\lambda_i(M)} \\right| \\text{ where } \\lambda_i(M) \\neq 0 \\right\\} = \\frac{1}{\\max_{i} |\\lambda_i(M)|}.\n$$\nThe quantity $\\max_i |\\lambda_i(M)|$ is, by definition, the spectral radius of the matrix $M$, denoted $\\rho(M)$. Therefore, the infimum of the perturbation norm is $(\\rho(M))^{-1}$. Substituting this into the definition of $\\mu$:\n$$\n\\mu_{\\Delta}(M) = \\left( (\\rho(M))^{-1} \\right)^{-1} = \\rho(M).\n$$\nThis fundamental result confirms that for a repeated scalar block uncertainty structure, the structured singular value is precisely the spectral radius of the matrix. The problem's instruction to compute $\\gamma_{\\mu} = \\left( \\sup_{\\omega} \\rho(M(j\\omega)) \\right)^{-1}$ is therefore correct.\n\nThe computational procedure is as follows:\n1.  Establish a frequency grid of $N=1000$ points, $\\omega_k$, logarithmically spaced on the interval $[10^{-2}, 10^{3}]\\,\\mathrm{rad/s}$.\n2.  For each test case, and for each frequency $\\omega_k$ in the grid:\n    a. Evaluate each element $M_{ij}(s)$ of the transfer matrix at $s = j\\omega_k$ to construct the complex matrix $M(j\\omega_k)$. The evaluation of a rational function $G(s) = N(s)/D(s)$ with polynomial coefficients given in descending order of powers of $s$ is performed by computing the ratio of the polynomial values $N(j\\omega_k)/D(j\\omega_k)$.\n    b. Compute the eigenvalues $\\lambda_i(M(j\\omega_k))$ of the resulting complex matrix $M(j\\omega_k)$.\n    c. The spectral radius is then $\\rho(M(j\\omega_k)) = \\max_i |\\lambda_i(M(j\\omega_k))|$.\n    d. Compute the singular values of $M(j\\omega_k)$. The maximum singular value is $\\overline{\\sigma}(M(j\\omega_k)) = \\|M(j\\omega_k)\\|_2$.\n3.  Determine the supremum of the spectral radius and maximum singular value over the frequency grid:\n    $$\n    \\rho_{\\text{sup}} = \\sup_{\\omega \\in [10^{-2}, 10^3]} \\rho(M(j\\omega)) \\approx \\max_{k \\in \\{1, \\dots, N\\}} \\rho(M(j\\omega_k))\n    $$\n    $$\n    \\overline{\\sigma}_{\\text{sup}} = \\sup_{\\omega \\in [10^{-2}, 10^3]} \\overline{\\sigma}(M(j\\omega)) \\approx \\max_{k \\in \\{1, \\dots, N\\}} \\overline{\\sigma}(M(j\\omega_k))\n    $$\n4.  Calculate the stability margins by taking the reciprocal of these suprema. If a supremum is zero, the corresponding margin is infinite.\n    $$\n    \\gamma_{\\mu} = (\\rho_{\\text{sup}})^{-1}\n    $$\n    $$\n    \\gamma_{\\mathrm{sg}} = (\\overline{\\sigma}_{\\text{sup}})^{-1}\n    $$\nIt is a known property of matrix norms that for any matrix $M$, its spectral radius is bounded by its induced $2$-norm (maximum singular value): $\\rho(M) \\le \\overline{\\sigma}(M)$. This implies that $\\rho_{\\text{sup}} \\le \\overline{\\sigma}_{\\text{sup}}$, and consequently, $\\gamma_{\\mu} \\ge \\gamma_{\\mathrm{sg}}$. This inequality shows that the structured analysis provides a stability margin that is generally less conservative (i.e., larger or equal) than the unstructured small-gain analysis. Equality $\\rho(M) = \\overline{\\sigma}(M)$ holds if and only if $M$ is a normal matrix (i.e., $M^*M = MM^*$). We expect to observe this relationship in the results of the test cases. Specifically, for the diagonal matrix in Case B, which is normal, we expect $\\gamma_{\\mu} = \\gamma_{\\mathrm{sg}}$. For the non-normal matrices in Cases A and C, we expect $\\gamma_{\\mu} > \\gamma_{\\mathrm{sg}}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the robust stability margin problem for the given test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: coupled, non-normal\n        {\n            \"M11\": ([1.2], [1.0, 1.0]),\n            \"M12\": ([0.4], [1.0, 0.5]),\n            \"M21\": ([-0.6], [1.0, 2.0]),\n            \"M22\": ([0.9, 0.3], [1.0, 4.5, 4.5]),\n        },\n        # Case B: diagonal, normal\n        {\n            \"M11\": ([0.7], [1.0, 0.7]),\n            \"M12\": ([0.0], [1.0]),\n            \"M21\": ([0.0], [1.0]),\n            \"M22\": ([0.5], [1.0, 2.0]),\n        },\n        # Case C: weakly coupled\n        {\n            \"M11\": ([0.2], [1.0, 0.2]),\n            \"M12\": ([0.05], [1.0, 5.0]),\n            \"M21\": ([0.1], [1.0, 5.0]),\n            \"M22\": ([0.3], [1.0, 0.3]),\n        }\n    ]\n\n    # Frequency grid setup\n    omega_grid = np.logspace(-2, 3, 1000)\n    s_grid = 1j * omega_grid\n\n    results = []\n    \n    for case in test_cases:\n        # Extract numerator and denominator coefficients for each entry\n        M11_coeffs = case[\"M11\"]\n        M12_coeffs = case[\"M12\"]\n        M21_coeffs = case[\"M21\"]\n        M22_coeffs = case[\"M22\"]\n\n        # Evaluate transfer functions over the frequency grid\n        M11_freq = np.polyval(M11_coeffs[0], s_grid) / np.polyval(M11_coeffs[1], s_grid)\n        M12_freq = np.polyval(M12_coeffs[0], s_grid) / np.polyval(M12_coeffs[1], s_grid)\n        M21_freq = np.polyval(M21_coeffs[0], s_grid) / np.polyval(M21_coeffs[1], s_grid)\n        M22_freq = np.polyval(M22_coeffs[0], s_grid) / np.polyval(M22_coeffs[1], s_grid)\n        \n        rhos = []\n        sigmas = []\n\n        # Iterate through each frequency point to compute spectral radius and max singular value\n        for i in range(len(omega_grid)):\n            M_jw = np.array([\n                [M11_freq[i], M12_freq[i]],\n                [M21_freq[i], M22_freq[i]]\n            ])\n            \n            # Compute spectral radius (rho)\n            eigvals = np.linalg.eigvals(M_jw)\n            rho = np.max(np.abs(eigvals))\n            rhos.append(rho)\n            \n            # Compute maximum singular value (sigma_bar)\n            sigma_max = np.linalg.norm(M_jw, ord=2)\n            sigmas.append(sigma_max)\n\n        # Compute suprema over the frequency grid\n        sup_rho = np.max(rhos)\n        sup_sigma = np.max(sigmas)\n        \n        # Calculate margins, handling the case of a zero supremum\n        gamma_mu = np.inf if sup_rho == 0 else 1.0 / sup_rho\n        gamma_sg = np.inf if sup_sigma == 0 else 1.0 / sup_sigma\n        \n        results.append([gamma_mu, gamma_sg])\n\n    # Format the final output string as specified\n    result_strings = [f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2754167"}]}