{"hands_on_practices": [{"introduction": "A cornerstone of robust control is analyzing whether a system remains stable and performs well across a whole set of possible plant variations. This practice explores systems with polytopic uncertainty, where parameters lie within a convex hull of known vertices. By leveraging convexity and a common Lyapunov function, you will see how to guarantee performance for an infinite number of systems by checking only a finite number of Linear Matrix Inequality (LMI) conditions [@problem_id:2740483].", "problem": "Consider a continuous-time, uncertain, Linear Time-Invariant (LTI) system with disturbance input $w$ and performance output $z$ given by\n$$\n\\dot{x}(t) = A(\\alpha) x(t) + B w(t), \\qquad z(t) = C x(t) + D w(t),\n$$\nwhere $x \\in \\mathbb{R}^{n}$, $w \\in \\mathbb{R}^{m}$, and $z \\in \\mathbb{R}^{p}$. The state matrix $A(\\alpha)$ is polytopic:\n$$\nA(\\alpha) \\in \\mathrm{conv}\\{A_{1}, \\ldots, A_{N}\\} = \\left\\{ \\sum_{i=1}^{N} \\alpha_{i} A_{i} \\ \\bigg| \\ \\alpha_{i} \\ge 0, \\ \\sum_{i=1}^{N} \\alpha_{i} = 1 \\right\\},\n$$\nand the matrices $B \\in \\mathbb{R}^{n \\times m}$, $C \\in \\mathbb{R}^{p \\times n}$, and $D \\in \\mathbb{R}^{p \\times m}$ are fixed and known. The Hardy space $H$-infinity (H$\\infty$) norm of the transfer $T_{zw}$ from $w$ to $z$ is defined in the standard way.\n\nTask A (formulation): Starting from the definition of the induced $\\mathcal{L}_{2}$ gain and the dissipation inequality with a common quadratic storage function $V(x) = x^{\\top} P x$ for some symmetric $P \\succ 0$, derive Linear Matrix Inequalities (LMIs) at the vertices $A_{i}$ that are sufficient to guarantee $\\|T_{zw}\\|_{\\infty}  \\gamma$ uniformly for all $A(\\alpha)$ in the polytope. Your derivation must make clear why checking only the $N$ vertex inequalities with a common $P$ suffices for all convex combinations.\n\nTask B (evaluation in a scalar case): Consider the specific scalar polytopic system ($n = m = p = 1$)\n$$\n\\dot{x}(t) = A(\\alpha) x(t) + B w(t), \\qquad z(t) = C x(t),\n$$\nwith vertices $A_{1} = -1.10$, $A_{2} = -0.23$, and fixed $B = 1.7$, $C = 2.9$, $D = 0$. Using your formulation from Task A and fundamental frequency-domain reasoning appropriate to this scalar case, determine the minimal real number $\\gamma_{\\star}$ such that $\\|T_{zw}\\|_{\\infty}  \\gamma_{\\star}$ holds uniformly for all $A(\\alpha)$ in the given polytope. Round your final numerical answer to four significant figures.", "solution": "We begin from the definition of the induced $\\mathcal{L}_{2}$ gain and the dissipation inequality, and then specialize to a common quadratic storage function to obtain Linear Matrix Inequality (LMI) conditions that are affine in the system matrices. We then show why, for a polytopic uncertainty set, these conditions need only be enforced at the vertices when a common storage matrix is used. Finally, we evaluate the bound in a scalar example by direct frequency-domain reasoning.\n\nTask A: multi-vertex LMI formulation ensuring $\\|T_{zw}\\|_{\\infty}  \\gamma$.\n\n1. Induced $\\mathcal{L}_{2}$ gain and dissipation inequality. For a stable realization and for any disturbance input $w \\in \\mathcal{L}_{2}$, the squared $\\mathcal{L}_{2}$ gain from $w$ to $z$ not exceeding $\\gamma^{2}$ is certified by the existence of a continuously differentiable storage function $V(x) \\ge 0$ such that the dissipation inequality\n$$\n\\dot{V}(x) + z^{\\top} z - \\gamma^{2} w^{\\top} w \\le 0\n$$\nholds along trajectories of the system for all $x$ and $w$. Choosing the common quadratic storage function $V(x) = x^{\\top} P x$ with $P = P^{\\top} \\succ 0$, and using $\\dot{V}(x) = x^{\\top}(A^{\\top} P + P A) x + 2 x^{\\top} P B w$, we have\n$$\nx^{\\top}(A^{\\top} P + P A) x + 2 x^{\\top} P B w + (C x + D w)^{\\top} (C x + D w) - \\gamma^{2} w^{\\top} w \\le 0.\n$$\nThis inequality must hold for all $x$ and $w$.\n\n2. Quadratic form representation. Grouping terms in $x$ and $w$, the inequality is equivalent to\n$$\n\\begin{bmatrix} x \\\\ w \\end{bmatrix}^{\\top}\n\\begin{bmatrix}\nA^{\\top} P + P A + C^{\\top} C  P B + C^{\\top} D \\\\\nB^{\\top} P + D^{\\top} C  D^{\\top} D - \\gamma^{2} I\n\\end{bmatrix}\n\\begin{bmatrix} x \\\\ w \\end{bmatrix} \\le 0 \\quad \\text{for all } x, w.\n$$\nA sufficient condition is the strict negativity of the symmetric block matrix:\n$$\n\\begin{bmatrix}\nA^{\\top} P + P A + C^{\\top} C  P B + C^{\\top} D \\\\\nB^{\\top} P + D^{\\top} C  D^{\\top} D - \\gamma^{2} I\n\\end{bmatrix} \\prec 0, \\qquad P \\succ 0.\n$$\nThis is the continuous-time Bounded Real Lemma (BRL) inequality expressed as a Linear Matrix Inequality (LMI) in decision variables $P$ and $\\gamma$, and is a well-tested and widely used characterization of $\\|T_{zw}\\|_{\\infty}  \\gamma$.\n\n3. Multi-vertex condition for a polytopic $A(\\alpha)$. Suppose $A(\\alpha) = \\sum_{i=1}^{N} \\alpha_{i} A_{i}$ with $\\alpha_{i} \\ge 0$, $\\sum_{i} \\alpha_{i} = 1$. The left-hand block matrix\n$$\n\\mathcal{M}(A) \\triangleq\n\\begin{bmatrix}\nA^{\\top} P + P A + C^{\\top} C  P B + C^{\\top} D \\\\\nB^{\\top} P + D^{\\top} C  D^{\\top} D - \\gamma^{2} I\n\\end{bmatrix}\n$$\nis affine in $A$. Therefore, for any fixed $P$ and $\\gamma$, the mapping $A \\mapsto \\mathcal{M}(A)$ preserves convex combinations:\n$$\n\\mathcal{M}\\!\\left(\\sum_{i=1}^{N} \\alpha_{i} A_{i}\\right) = \\sum_{i=1}^{N} \\alpha_{i} \\mathcal{M}(A_{i}).\n$$\nThe set of negative definite matrices is convex, so if $\\mathcal{M}(A_{i}) \\prec 0$ for all $i \\in \\{1, \\ldots, N\\}$ for a common $P \\succ 0$ and $\\gamma  0$, then $\\mathcal{M}(A(\\alpha)) \\prec 0$ for every $A(\\alpha)$ in the convex hull. Hence, the following multi-vertex LMIs are sufficient and uniform over the polytope:\n$$\n\\begin{bmatrix}\nA_{i}^{\\top} P + P A_{i} + C^{\\top} C  P B + C^{\\top} D \\\\\nB^{\\top} P + D^{\\top} C  D^{\\top} D - \\gamma^{2} I\n\\end{bmatrix} \\prec 0, \\quad P \\succ 0, \\quad \\text{for all } i \\in \\{1, \\ldots, N\\}.\n$$\nWhen $D = 0$, these simplify to\n$$\n\\begin{bmatrix}\nA_{i}^{\\top} P + P A_{i} + C^{\\top} C  P B \\\\\nB^{\\top} P  - \\gamma^{2} I\n\\end{bmatrix} \\prec 0, \\quad P \\succ 0, \\quad \\forall i.\n$$\n\nTask B: minimal $\\gamma_{\\star}$ in the scalar case.\n\nWe are given the scalar ($n = m = p = 1$) system\n$$\n\\dot{x}(t) = a x(t) + b w(t), \\qquad z(t) = c x(t),\n$$\nwith $a \\in \\mathrm{conv}\\{-1.10, -0.23\\}$, $b = 1.7$, $c = 2.9$, and $d = 0$. The transfer function from $w$ to $z$ is\n$$\nT_{zw}(s) = c (s I - a)^{-1} b + d = \\frac{c b}{s - a}.\n$$\nFor a stable $a  0$, the $\\mathcal{H}_{\\infty}$ norm equals the peak magnitude of the frequency response on the imaginary axis:\n$$\n\\|T_{zw}\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} \\left| \\frac{c b}{\\mathrm{j} \\omega - a} \\right| = |c b| \\, \\sup_{\\omega \\in \\mathbb{R}} \\frac{1}{\\sqrt{\\omega^{2} + a^{2}}} = \\frac{|c b|}{|a|}.\n$$\nThe supremum is attained at $\\omega = 0$ because the denominator $\\sqrt{\\omega^{2} + a^{2}}$ is minimized at $\\omega = 0$. Uniformly over the polytope, the worst case occurs at the smallest $|a|$ (closest to the imaginary axis), namely $|a|_{\\min} = 0.23$. Therefore, the minimal $\\gamma_{\\star}$ that satisfies $\\|T_{zw}\\|_{\\infty}  \\gamma_{\\star}$ for all $a \\in \\mathrm{conv}\\{-1.10, -0.23\\}$ is\n$$\n\\gamma_{\\star} = \\frac{|c b|}{\\min\\{|a_{1}|, |a_{2}|\\}} = \\frac{(2.9)(1.7)}{0.23} = \\frac{4.93}{0.23} = \\frac{493}{23}.\n$$\nNumerically,\n$$\n\\gamma_{\\star} \\approx 21.4347826\\ldots\n$$\nRounded to four significant figures,\n$$\n\\gamma_{\\star} \\approx 21.43.\n$$", "answer": "$$\\boxed{21.43}$$", "id": "2740483"}, {"introduction": "Beyond analyzing a given system, the ultimate goal is to design controllers that enforce robustness. This exercise tackles the fundamental problem of state-feedback $\\mathcal{H}_{\\infty}$ synthesis, where the objective is to design a control law that ensures the induced $\\mathcal{L}_2$-gain from disturbance to output is below a desired level. You will derive the classic LMI formulation that makes this synthesis problem convex and solvable, providing a powerful tool for robust design [@problem_id:2740566].", "problem": "Consider a continuous-time uncertain exogenous disturbance attenuation setup with the plant described by the state-space data $\\left(A,B_{1},B_{2},C_{1},D_{11},D_{12}\\right)$:\n$$\n\\dot{x}(t) \\;=\\; A\\,x(t)+B_{1}\\,w(t)+B_{2}\\,u(t),\\quad\nz(t) \\;=\\; C_{1}\\,x(t)+D_{11}\\,w(t)+D_{12}\\,u(t),\n$$\nwhere $x(t)\\in\\mathbb{R}^{n}$ is the state, $u(t)\\in\\mathbb{R}^{m}$ is the control input, $w(t)\\in\\mathbb{R}^{p}$ is the external disturbance, and $z(t)\\in\\mathbb{R}^{q}$ is the performance output. You are to design a static state-feedback $u(t)=K\\,x(t)$ such that the closed-loop induced $\\mathcal{L}_{2}$-gain from $w$ to $z$ (i.e., the $\\mathcal{H}_{\\infty}$ norm $\\|T_{zw}\\|_{\\infty}$) is strictly less than a prescribed scalar $\\gamma0$. Assume that $(A,B_{2})$ is stabilizable and that the performance channel has $D_{12}$ of full column rank. The task is to start from foundational results and arrive at a convex synthesis condition.\n\nTask A. Using the continuous-time Bounded Real Lemma as your foundational starting point, formulate the robust performance objective $\\|T_{zw}\\|_{\\infty}\\gamma$ for the closed loop and derive a Linear Matrix Inequality (LMI) condition with decision variables $(X\\succ 0,Y)$ such that, if the LMI is feasible for some $\\gamma0$, then the state-feedback gain $K=Y\\,X^{-1}$ ensures $\\|T_{zw}\\|_{\\infty}\\gamma$. Your derivation must be self-contained and must explicitly connect the Bounded Real Lemma to a convex feasibility condition via an appropriate congruence transformation and change of variables that eliminate bilinearities.\n\nTask B. Now specialize to the scalar plant with $n=m=p=q=1$ given by\n$$\nA \\,=\\, -1,\\quad B_{1}\\,=\\,1,\\quad B_{2}\\,=\\,1,\\quad C_{1}\\,=\\,2,\\quad D_{11}\\,=\\,\\tfrac{1}{3},\\quad D_{12}\\,=\\,4.\n$$\nUsing your derived LMI formulation together with analytical reasoning about the closed-loop transfer $T_{zw}(s)$, determine the minimal achievable $\\gamma$ (i.e., the infimum of all $\\gamma$ for which there exists a static state-feedback gain $K$ satisfying $\\|T_{zw}\\|_{\\infty}\\gamma$). Express your final answer exactly as a single real number without units. Do not round; give the exact value.", "solution": "The task is divided into two parts. First, a general convex synthesis condition for the state-feedback $\\mathcal{H}_{\\infty}$ control problem is to be derived. Second, this result is to be applied to a specific scalar system to determine the optimal performance level $\\gamma_{opt}$.\n\nPart A: Derivation of the LMI Synthesis Condition\n\nThe given system is described by the state-space equations:\n$$\n\\begin{aligned}\n\\dot{x}(t)  = A\\,x(t)+B_{1}\\,w(t)+B_{2}\\,u(t) \\\\\nz(t)  = C_{1}\\,x(t)+D_{11}\\,w(t)+D_{12}\\,u(t)\n\\end{aligned}\n$$\nA static state-feedback control law $u(t) = K x(t)$ is applied. Substituting this into the system equations yields the closed-loop system dynamics from the disturbance $w(t)$ to the performance output $z(t)$:\n$$\n\\begin{aligned}\n\\dot{x}(t)  = (A + B_{2}K)x(t) + B_{1}w(t) \\\\\nz(t)  = (C_{1} + D_{12}K)x(t) + D_{11}w(t)\n\\end{aligned}\n$$\nThis is a linear time-invariant (LTI) system with state-space matrices:\n$$\nA_{cl} = A + B_{2}K, \\quad B_{cl} = B_{1}, \\quad C_{cl} = C_{1} + D_{12}K, \\quad D_{cl} = D_{11}\n$$\nThe objective is to find a gain matrix $K$ such that the closed-loop system is internally stable (i.e., $A_{cl}$ is Hurwitz) and the induced $\\mathcal{L}_{2}$-gain from $w$ to $z$ is less than a given $\\gamma  0$. This gain is equivalent to the $\\mathcal{H}_{\\infty}$ norm of the closed-loop transfer function $T_{zw}(s)$, so the condition is $\\|T_{zw}\\|_{\\infty}  \\gamma$.\n\nThe foundational result for this problem is the continuous-time Bounded Real Lemma (BRL). The BRL states that for a stable LTI system with realization $(A_{cl}, B_{cl}, C_{cl}, D_{cl})$, the condition $\\|T_{zw}\\|_{\\infty}  \\gamma$ holds if and only if there exists a symmetric positive definite matrix $P \\succ 0$ satisfying the matrix inequality:\n$$\n\\begin{pmatrix}\nA_{cl}^T P + P A_{cl}  P B_{cl}  C_{cl}^T \\\\\nB_{cl}^T P  -\\gamma I_p  D_{cl}^T \\\\\nC_{cl}  D_{cl}  -\\gamma I_q\n\\end{pmatrix} \\prec 0\n$$\nwhere $I_p$ and $I_q$ are identity matrices of appropriate dimensions.\n\nSubstituting the expressions for the closed-loop matrices into this inequality gives:\n$$\n\\begin{pmatrix}\n(A + B_{2}K)^T P + P (A + B_{2}K)  P B_{1}  (C_{1} + D_{12}K)^T \\\\\nB_{1}^T P  -\\gamma I_p  D_{11}^T \\\\\n(C_{1} + D_{12}K)  D_{11}  -\\gamma I_q\n\\end{pmatrix} \\prec 0\n$$\nThis is a matrix inequality in the variables $P$ and $K$. Expanding the terms in the (1,1) and (1,3)/(3,1) blocks reveals terms such as $K^T B_2^T P$ and $P B_2 K$, which are bilinear products of the decision variables. Such an inequality is termed a Bilinear Matrix Inequality (BMI), which is non-convex and generally hard to solve.\n\nTo obtain a convex condition, we linearize this inequality. Let $X=P^{-1}$. Since $P \\succ 0$, we have $X \\succ 0$. Pre- and post-multiply the BMI by the block-diagonal matrix $\\text{diag}(X, I_p, I_q)$. This is a congruence transformation that preserves the inequality. The blocks of the new matrix inequality are transformed as follows:\n*   The $(1,1)$ block becomes $X(A_{cl}^T P + P A_{cl})X = XA_{cl}^T + A_{cl}X = X(A+B_2K)^T + (A+B_2K)X = XA^T + XK^TB_2^T + AX + B_2KX$.\n*   The $(1,2)$ block becomes $X P B_1 = B_1$.\n*   The $(1,3)$ block becomes $X(C_1+D_{12}K)^T = XC_1^T + XK^TD_{12}^T$.\n*   The $(3,1)$ block becomes $(C_1+D_{12}K)X = C_1X + D_{12}KX$.\nThe resulting inequality contains bilinear terms such as $B_2KX$ and $XK^TB_2^T$. The final step is a change of variables. Define a new matrix variable $Y = K X$. Substituting this into the transformed inequality linearizes the terms: $B_2KX$ becomes $B_2Y$, and $XK^TB_2^T$ becomes $Y^TB_2^T$. This yields the final LMI:\n$$\n\\begin{pmatrix}\nAX + XA^T + B_2Y + Y^TB_2^T  B_1  XC_1^T + Y^TD_{12}^T \\\\\nB_1^T  -\\gamma I_p  D_{11}^T \\\\\nC_1X + D_{12}Y  D_{11}  -\\gamma I_q\n\\end{pmatrix} \\prec 0\n$$\nThis is a Linear Matrix Inequality (LMI) in the variables $X$ and $Y$. If this LMI is feasible for some symmetric $X \\succ 0$ and matrix $Y$, then a suitable state-feedback gain is given by $K = Y X^{-1}$, which guarantees $\\|T_{zw}\\|_{\\infty}  \\gamma$. The assumption that $(A, B_2)$ is stabilizable ensures that a stabilizing gain exists, and the LMI framework finds one with the desired performance if possible.\n\nPart B: Minimal Achievable $\\gamma$ for a Scalar Plant\n\nThe specific scalar plant has parameters:\n$$\nA = -1, \\quad B_{1}=1, \\quad B_{2}=1, \\quad C_{1}=2, \\quad D_{11}=\\frac{1}{3}, \\quad D_{12}=4\n$$\nHere, $n=m=p=q=1$. The gain $K$ is a scalar, let us denote it by $k$.\nA direct analytical approach using the transfer function is more insightful than solving the LMI for this simple case. The closed-loop transfer function $T_{zw}(s)$ from $w$ to $z$ is:\n$$\nT_{zw}(s) = C_{cl}(sI - A_{cl})^{-1}B_{cl} + D_{cl}\n$$\nThe scalar closed-loop matrices are:\n$A_{cl} = A + B_{2}k = -1+k$\n$B_{cl} = B_1 = 1$\n$C_{cl} = C_1 + D_{12}k = 2+4k$\n$D_{cl} = D_{11} = \\frac{1}{3}$\n\nFor internal stability, the pole of the system, $s = k-1$, must be in the open left-half plane, which requires $k-1  0$, or $k  1$.\n\nThe transfer function is:\n$$\nT_{zw}(s) = \\frac{2+4k}{s - (-1+k)} + \\frac{1}{3} = \\frac{2+4k}{s+1-k} + \\frac{1}{3} = \\frac{3(2+4k) + (s+1-k)}{3(s+1-k)} = \\frac{s + 7+11k}{3(s+1-k)}\n$$\nThe $\\mathcal{H}_{\\infty}$ norm is the supremum of the magnitude of $T_{zw}(j\\omega)$ over all frequencies $\\omega \\in \\mathbb{R}$:\n$$\n\\|T_{zw}\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} |T_{zw}(j\\omega)|\n$$\nLet us evaluate $|T_{zw}(j\\omega)|^2$:\n$$\n|T_{zw}(j\\omega)|^2 = \\left| \\frac{j\\omega + (7+11k)}{3(j\\omega + (1-k))} \\right|^2 = \\frac{1}{9} \\frac{\\omega^2 + (7+11k)^2}{\\omega^2 + (1-k)^2}\n$$\nTo find the infimum of $\\|T_{zw}\\|_{\\infty}$ over all stabilizing gains $k  1$, we analyze the behavior of this function with respect to $\\omega$. Let $f(\\Omega) = \\frac{\\Omega + a}{\\Omega + b}$ where $\\Omega = \\omega^2 \\ge 0$, $a = (7+11k)^2$, and $b = (1-k)^2 \\ge 0$.\nThe derivative with respect to $\\Omega$ is $f'(\\Omega) = \\frac{b-a}{(\\Omega+b)^2}$.\n- If $b  a$, $f'(\\Omega)  0$, so $f(\\Omega)$ is increasing. The maximum is at $\\Omega \\to \\infty$, where $f(\\Omega) \\to 1$.\n- If $b  a$, $f'(\\Omega)  0$, so $f(\\Omega)$ is decreasing. The maximum is at $\\Omega = 0$, where $f(0) = a/b$.\n- If $b=a$, $f(\\Omega)=1$ is constant.\n\nThe condition $a=b$ corresponds to $(7+11k)^2 = (1-k)^2$, which implies $7+11k = \\pm(1-k)$.\n1. $7+11k = 1-k \\implies 12k = -6 \\implies k = -\\frac{1}{2}$.\n2. $7+11k = -(1-k) = k-1 \\implies 10k = -8 \\implies k = -\\frac{4}{5}$.\n\nBoth $k = -1/2$ and $k = -4/5$ are in the stability region $k  1$.\nFor $k \\in [-4/5, -1/2]$, we have $(7+11k)^2 \\le (1-k)^2$, which is $a \\le b$.\nIn this range, the function $f(\\Omega)$ is non-decreasing, so its supremum is $\\lim_{\\Omega\\to\\infty} f(\\Omega) = 1$.\nThus, for $k \\in [-4/5, -1/2]$, $\\|T_{zw}\\|_{\\infty}^2 = \\frac{1}{9}(1) = \\frac{1}{9}$, which means $\\|T_{zw}\\|_{\\infty} = \\frac{1}{3}$.\n\nOutside this interval, for $k  -4/5$ or $k \\in (-1/2, 1)$, we have $a  b$, and the maximum magnitude is achieved at $\\omega=0$:\n$$\n\\|T_{zw}\\|_{\\infty}^2 = \\frac{1}{9} \\frac{a}{b} = \\frac{1}{9} \\left( \\frac{7+11k}{1-k} \\right)^2 \\implies \\|T_{zw}\\|_{\\infty} = \\frac{1}{3} \\left| \\frac{7+11k}{1-k} \\right|\n$$\nThe function $h(k) = \\frac{7+11k}{1-k}$ has $h(-4/5) = -1$ and $h(-1/2) = 1$. It is monotonically increasing for $k1$. Therefore, for $k \\notin [-4/5, -1/2]$, $|h(k)|  1$, which means $\\|T_{zw}\\|_{\\infty}  1/3$.\n\nCombining these results, the minimum possible value of $\\|T_{zw}\\|_{\\infty}$ over all stabilizing gains $k  1$ is $1/3$.\n$$\n\\gamma_{opt} = \\inf_{k1} \\|T_{zw}\\|_{\\infty} = \\frac{1}{3}\n$$\nThe problem asks for the infimum of all $\\gamma$ for which a gain $K$ exists such that $\\|T_{zw}\\|_{\\infty}  \\gamma$. This is precisely $\\gamma_{opt}$.\nThis result is consistent with the fact that the feedthrough term $D_{11}$ imposes a fundamental limitation. The norm of the transfer function at infinite frequency is $|T_{zw}(j\\infty)| = |D_{11}| = 1/3$. Therefore, for any stabilizing controller, $\\|T_{zw}\\|_{\\infty} \\ge |D_{11}| = 1/3$.\n\nOur analysis shows that this lower bound is achievable. The infimum of achievable performance levels $\\gamma$ is thus $1/3$. For any $\\gamma  1/3$, we can select $k=-1/2$, which yields $\\|T_{zw}\\|_{\\infty} = 1/3  \\gamma$. However, for $\\gamma=1/3$, it is impossible to satisfy the strict inequality $\\|T_{zw}\\|_{\\infty}  1/3$. Accordingly, the minimal achievable $\\gamma$ is $1/3$.", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "2740566"}, {"introduction": "Every engineering design faces fundamental limitations, and feedback control is no exception. This practice explores one of the most profound constraints: the \"waterbed effect,\" as quantified by Bode's sensitivity integral. You will derive this integral identity for an unstable plant and use it to understand why improving performance in one frequency range inevitably degrades it in another, creating a critical tradeoff between performance and robust stability [@problem_id:2740504].", "problem": "Consider a single-input single-output linear time-invariant (LTI) plant with transfer function $P(s)$ that is strictly proper, rational, and has exactly one right-half-plane (RHP) pole at $s=+a$ with $a0$, no RHP zeros, and no time delay. Let $K(s)$ be any proper stabilizing controller such that the closed loop is internally stable. Let the loop transfer function be $L(s)=P(s)K(s)$ and the sensitivity function be $S(s)=(1+L(s))^{-1}$. Assume $L(s)\\to 0$ as $|s|\\to \\infty$ along the imaginary axis so that $S(\\infty)=1$.\n\na) Starting from the definition of $S(s)$, the argument principle, and standard complex-analytic factorization of unstable dynamics via Blaschke products, derive an exact expression for the integral\n$$\nI(a)\\;=\\;\\int_{0}^{\\infty}\\ln|S(\\mathrm{j}\\omega)|\\,\\mathrm{d}\\omega\n$$\nin terms of $a$ only. Your derivation must make clear which structural property of the plant enforces the nonzero “waterbed area” in $I(a)$.\n\nb) Now suppose there is multiplicative output uncertainty $\\Delta(s)$ satisfying $|\\Delta(\\mathrm{j}\\omega)|\\leq |W_{\\Delta}(\\mathrm{j}\\omega)|$ for all real $\\omega$, where $W_{\\Delta}(s)$ is a known, stable, minimum-phase weight. For robust performance, a common choice of sensitivity weight is\n$$\nW_{s}(s)\\;=\\;\\frac{\\frac{s}{M}+\\omega_{B}}{s+\\frac{\\omega_{B}}{A}},\\quad A1,\\;M1,\\;\\omega_{B}0,\n$$\nso that $|W_{s}(\\mathrm{j}\\omega)S(\\mathrm{j}\\omega)|$ is sought to be uniformly small. Using your result in part (a) together with first principles (in particular, that pushing $|S(\\mathrm{j}\\omega)|$ below $1$ on any set of nonzero measure must be compensated by values above $1$ elsewhere to satisfy the integral identity), explain how the presence of the RHP pole at $+a$ constrains the simultaneous choice of $(A,M,\\omega_{B})$ when robust performance additionally requires the small-gain condition $|W_{\\Delta}(\\mathrm{j}\\omega)|\\,|T(\\mathrm{j}\\omega)|1$ for all real $\\omega$, where $T(s)=1-S(s)$ is the complementary sensitivity. Your explanation must identify the tradeoff implied by the nonzero value of $I(a)$ and how it impacts the shaping of $W_{s}(s)$ across frequency in the face of $W_{\\Delta}(s)$, but you do not need to produce a numerical value for $(A,M,\\omega_{B})$.\n\nAnswer specification: Report as your final answer only the closed-form expression for $I(a)$ from part (a). No units are required and no rounding is needed.", "solution": "a) Derivation of the integral $I(a)$\n\nThe integral to be evaluated is $I(a) = \\int_{0}^{\\infty}\\ln|S(\\mathrm{j}\\omega)|\\,\\mathrm{d}\\omega$. The sensitivity function is defined as $S(s) = (1+L(s))^{-1}$, where $L(s) = P(s)K(s)$ is the open-loop transfer function.\n\nFirst, we establish the analytic properties of $S(s)$ in the right-half-plane (RHP), defined as $\\text{Re}(s)  0$.\n1.  **Poles of $S(s)$**: The poles of $S(s)$ are the zeros of $1+L(s)$, which correspond to the closed-loop system poles. The problem states that the controller $K(s)$ is stabilizing, which implies that the closed-loop system is internally stable. Therefore, all poles of $S(s)$ lie strictly in the left-half-plane (LHP), and $S(s)$ is analytic throughout the RHP.\n2.  **Zeros of $S(s)$**: The zeros of $S(s)$ are the poles of $1+L(s)$, which are the poles of $L(s)$. The poles of $L(s)=P(s)K(s)$ are the combined poles of the plant $P(s)$ and the controller $K(s)$. For internal stability, the controller cannot cancel any RHP poles of the plant. We assume the proper controller $K(s)$ is stable, as is standard practice for stabilizing an unstable plant. Thus, the RHP poles of $L(s)$ are identical to the RHP poles of $P(s)$. The problem states that $P(s)$ has exactly one RHP pole at $s=+a$, with $a0$. Consequently, $S(s)$ has exactly one RHP zero at $s=a$.\n\nSince $S(s)$ is analytic in the RHP and has a known RHP zero, we can use the Poisson-Jensen formula. This formula relates the value of an analytic function inside a domain to its boundary values and its interior zeros. For a function $f(s)$ analytic in the RHP, the formula for a point $s_0 = x_0 + \\mathrm{j}y_0$ in the RHP is:\n$$ \\ln|f(s_0)| = \\sum_{i} \\ln\\left|\\frac{s_0-z_i}{s_0+\\bar{z_i}}\\right| - \\sum_{k} \\ln\\left|\\frac{s_0-p_k}{s_0+\\bar{p_k}}\\right| + \\frac{1}{\\pi}\\int_{-\\infty}^{\\infty} \\ln|f(\\mathrm{j}\\omega)| \\frac{x_0}{x_0^2+(y_0-\\omega)^2} \\mathrm{d}\\omega $$\nHere, $\\{z_i\\}$ are the RHP zeros and $\\{p_k\\}$ are the RHP poles of $f(s)$.\n\nWe apply this formula to our sensitivity function $S(s)$. We have established that $S(s)$ has no RHP poles and a single real RHP zero at $z_1=a$. We evaluate the formula at a point on the positive real axis, $s_0=x_0$ (so $y_0=0$), where $x_0a$.\nThe formula simplifies to:\n$$ \\ln|S(x_0)| = \\ln\\left|\\frac{x_0-a}{x_0+a}\\right| + \\frac{1}{\\pi}\\int_{-\\infty}^{\\infty} \\ln|S(\\mathrm{j}\\omega)| \\frac{x_0}{x_0^2+\\omega^2} \\mathrm{d}\\omega $$\nSince $S(s)$ is the transfer function of a system with real coefficients, $|S(\\mathrm{j}\\omega)|$ is an even function of $\\omega$. The integral term can be written as:\n$$ \\frac{2}{\\pi}\\int_{0}^{\\infty} \\ln|S(\\mathrm{j}\\omega)| \\frac{x_0}{x_0^2+\\omega^2} \\mathrm{d}\\omega $$\nOur goal is to isolate the integral $I(a)=\\int_{0}^{\\infty} \\ln|S(\\mathrm{j}\\omega)| \\mathrm{d}\\omega$. We can achieve this by multiplying the entire equation by $x_0$ and taking the limit as $x_0 \\to \\infty$.\n$$ \\lim_{x_0 \\to \\infty} x_0 \\ln|S(x_0)| = \\lim_{x_0 \\to \\infty} x_0 \\ln\\left(\\frac{x_0-a}{x_0+a}\\right) + \\lim_{x_0 \\to \\infty} \\frac{2}{\\pi}\\int_{0}^{\\infty} \\ln|S(\\mathrm{j}\\omega)| \\frac{x_0^2}{x_0^2+\\omega^2} \\mathrm{d}\\omega $$\nLet's evaluate each limit:\n\n-   **Left-hand side**: Since $P(s)$ is strictly proper and $K(s)$ is proper, $L(s)$ is strictly proper, meaning its relative degree is at least $1$. Thus, $L(s) \\to 0$ as $|s|\\to\\infty$. Then $S(s) = (1+L(s))^{-1} \\approx 1-L(s)$ for large $s$. So $\\ln|S(x_0)| \\approx \\ln|1-L(x_0)| \\approx -\\text{Re}(L(x_0))$. The limit becomes $\\lim_{x_0 \\to \\infty} -x_0 \\text{Re}(L(x_0))$. This depends on the relative degree of $L(s)$. The problem requires a solution in terms of $a$ only, which forces this limit to be zero. This condition, $\\lim_{s \\to \\infty} sL(s) = 0$, holds if and only if the relative degree of $L(s)$ is at least $2$. We proceed under this standard assumption, which is implicitly demanded by the problem's constraints. Thus, $\\lim_{x_0 \\to \\infty} x_0 \\ln|S(x_0)| = 0$.\n\n-   **First term on RHS**: We use the Taylor expansion for the logarithm, $\\ln(1+u) \\approx u$ for small $u$.\n$$ \\lim_{x_0 \\to \\infty} x_0 \\ln\\left(\\frac{1-a/x_0}{1+a/x_0}\\right) = \\lim_{x_0 \\to \\infty} x_0 \\left[ \\ln(1-a/x_0) - \\ln(1+a/x_0) \\right] $$\n$$ = \\lim_{x_0 \\to \\infty} x_0 \\left[ (-a/x_0) - (a/x_0) + O(1/x_0^2) \\right] = \\lim_{x_0 \\to \\infty} x_0 \\left[ -2a/x_0 \\right] = -2a $$\n\n-   **Second term on RHS**: We analyze the limit of the integral. The kernel $\\frac{x_0^2}{x_0^2+\\omega^2} = \\frac{1}{1+(\\omega/x_0)^2}$ approaches $1$ as $x_0 \\to \\infty$ for any fixed $\\omega$. By applying a suitable convergence theorem (e.g., Dominated Convergence Theorem, assuming the integral of the unweighted log-sensitivity is finite), we can swap the limit and the integral:\n$$ \\lim_{x_0 \\to \\infty} \\frac{2}{\\pi}\\int_{0}^{\\infty} \\ln|S(\\mathrm{j}\\omega)| \\frac{x_0^2}{x_0^2+\\omega^2} \\mathrm{d}\\omega = \\frac{2}{\\pi}\\int_{0}^{\\infty} \\ln|S(\\mathrm{j}\\omega)| \\cdot (1) \\mathrm{d}\\omega = \\frac{2}{\\pi}I(a) $$\n\nCombining the results of the limits, we have the equation:\n$$ 0 = -2a + \\frac{2}{\\pi}I(a) $$\nSolving for $I(a)$ yields the final expression:\n$$ I(a) = \\pi a $$\nThe structural property of the plant enforcing this nonzero \"waterbed area\" is the presence of the RHP pole at $s=+a$. As shown in the derivation, this pole becomes a RHP zero of $S(s)$, which introduces the term $\\ln\\left|\\frac{x_0-a}{x_0+a}\\right|$ in the Poisson-Jensen formula. The non-zero limit of this term's contribution ($x_0$ times it) leads to the non-zero value of the integral. For a stable plant ($a$ would not exist), this term is absent, and the integral evaluates to zero (assuming rel. deg. $\\ge 2$).\n\nb) Explanation of design tradeoffs\n\nThe result from part (a), $\\int_{0}^{\\infty}\\ln|S(\\mathrm{j}\\omega)|\\,\\mathrm{d}\\omega = \\pi a$, is a fundamental constraint on the sensitivity function, known as Bode's sensitivity integral. Since $a0$, the integral is strictly positive. This is the mathematical formulation of the \"waterbed effect\": any attempt to reduce sensitivity in one frequency range (i.e., making $|S(\\mathrm{j}\\omega)|  1$, so $\\ln|S(\\mathrm{j}\\omega)|  0$) must be compensated by an increase in sensitivity in another frequency range (making $|S(\\mathrm{j}\\omega)|  1$, so $\\ln|S(\\mathrm{j}\\omega)|  0$), such that the total area under the curve of $\\ln|S(\\mathrm{j}\\omega)|$ remains equal to the positive constant $\\pi a$.\n\nGood performance, such as tracking and disturbance rejection, requires $|S(\\mathrm{j}\\omega)|$ to be small over a certain bandwidth. The performance weight $W_s(s)$ formalizes this; the condition $|W_{s}(\\mathrm{j}\\omega)S(\\mathrm{j}\\omega)|  1$ implies $|S(\\mathrm{j}\\omega)|  |W_s(\\mathrm{j}\\omega)|^{-1}$. The given $W_s(s)$ has a low-frequency gain of $A1$, so we require $|S(0)|  1/A$. This requires creating a significant \"negative area\" in the integral of $\\ln|S(\\mathrm{j}\\omega)|$ at low frequencies, up to the performance bandwidth $\\omega_B$.\n\nTo satisfy the integral constraint, this negative area must be balanced by a positive area where $|S(\\mathrm{j}\\omega)|  1$. This typically manifests as a peak in the sensitivity function, $M_S = \\max_{\\omega}|S(\\mathrm{j}\\omega)|  1$, at frequencies around and above $\\omega_B$. The larger the unstable pole $a$, and the more aggressive the performance specification (i.e., larger desired bandwidth $\\omega_B$ and/or larger attenuation factor $A$), the larger the required negative area, and consequently, the larger the unavoidable sensitivity peak $M_S$.\n\nThis peak in sensitivity has a direct consequence for robust stability. The robust stability condition for multiplicative output uncertainty is $|W_{\\Delta}(\\mathrm{j}\\omega)T(\\mathrm{j}\\omega)|  1$, where $T(s)=1-S(s)$ is the complementary sensitivity function. A large peak $M_S$ in $|S(\\mathrm{j}\\omega)|$ implies a correspondingly large peak in $|T(\\mathrm{j}\\omega)|$ because $|T| = |1-S|$ is bounded by $|1+|S|| \\le |T| \\le |1+|S||$, and around the peak frequency, $|T|$ is often on the order of $M_S$. Let this peak be $M_T = \\max_\\omega |T(j\\omega)|$.\n\nThe tradeoff becomes critical because the uncertainty weight $W_\\Delta(s)$ typically models unmodeled dynamics at high frequencies, meaning $|W_\\Delta(\\mathrm{j}\\omega)|$ is small at low frequencies but increases with $\\omega$. The robust stability condition $|T(\\mathrm{j}\\omega)|  1/|W_\\Delta(\\mathrm{j}\\omega)|$ thus imposes a stringent upper limit on the magnitude of $T(s)$ precisely in the high-frequency region where the sensitivity peak $M_S$ (and hence a peak $M_T$) is forced to occur.\n\nIn summary, the RHP pole at $s=+a$ enforces the constraint $I(a)=\\pi a  0$. Achieving high performance (large $A$, large $\\omega_B$) necessitates a large sensitivity peak $M_S$. This large $M_S$ creates a large peak $M_T$ in the complementary sensitivity function at frequencies where the uncertainty magnitude $|W_\\Delta|$ is typically large. This may cause the product $|W_\\Delta T|$ to exceed $1$, violating robust stability. Therefore, the presence of the unstable pole at $s=+a$ establishes a fundamental conflict between nominal performance and robust stability, thereby constraining the simultaneous choice of the performance parameters $(A, M, \\omega_B)$. A more unstable plant (larger $a$) exacerbates this tradeoff, severely limiting achievable performance bandwidth and disturbance rejection.", "answer": "$$\\boxed{\\pi a}$$", "id": "2740504"}]}