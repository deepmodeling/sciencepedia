{"hands_on_practices": [{"introduction": "We begin our hands-on exploration by examining a scenario that reveals the limitations of traditional stability analysis. The unstructured small-gain theorem provides a simple test using the matrix norm, $\\bar{\\sigma}(M) \\lt 1$, but is it always a reliable measure of robustness? This exercise [@problem_id:2758632] challenges that assumption with a carefully constructed example, illustrating how stability can be compromised by structured perturbations that are precisely aligned with a system's most vulnerable dynamic modes.", "problem": "Consider a frequency-frozen multivariable loop characterized by a complex matrix $M \\in \\mathbb{C}^{2 \\times 2}$ that arises at some fixed frequency from a Linear Time-Invariant (LTI) plant-controller interconnection. Suppose the parametric uncertainty is modeled by a block-diagonal structure $\\Delta = \\operatorname{diag}(\\delta_{1}, \\delta_{2})$ with $\\delta_{1}, \\delta_{2} \\in \\mathbb{C}$, and the norm on $\\Delta$ is the induced $2$-norm (which coincides with $\\|\\Delta\\| = \\max\\{|\\delta_{1}|, |\\delta_{2}|\\}$ for this structure). Let\n$$\nM = \\gamma \\begin{bmatrix} 0 & 1 \\\\ 1 & 0 \\end{bmatrix}, \\qquad \\gamma = 0.9998.\n$$\nThis $M$ swaps the two block directions, which is a canonical situation where the singular vectors of $M$ are not aligned with the coordinate axes defining the uncertainty blocks.\n\nStarting only from the fundamental definition of the structured singular value (also called the structured singular value (SSV)) with respect to $\\Delta$ and the definition of the induced $2$-norm, do the following:\n\n- Establish the value of $\\|M\\|_{2}$.\n- Determine the minimal $\\|\\Delta\\|$ for which the matrix $I - M \\Delta$ becomes singular.\n- Using these facts, compute the structured singular value $\\mu_{\\Delta}(M)$.\n- Briefly interpret why, in this example, one can have $\\|M\\|_{2} < 1$ but $\\mu_{\\Delta}(M)$ is nevertheless very close to $1$, in terms of the structured alignment (or misalignment) of the left and right singular vectors of $M$ with the block-diagonal directions of $\\Delta$. Relate this interpretation to the statement of the Main Loop Theorem for robust stability of feedback interconnections.\n\nReport your final numerical value of $\\mu_{\\Delta}(M)$ as a dimensionless quantity, rounded to four significant figures.", "solution": "The analysis of this problem begins with a rigorous application of the fundamental definitions of the induced $2$-norm and the structured singular value, $\\mu$.\n\nThe given matrix is $M = \\gamma \\begin{bmatrix} 0 & 1 \\\\ 1 & 0 \\end{bmatrix}$ with $\\gamma = 0.9998$. The uncertainty structure is given by $\\Delta = \\operatorname{diag}(\\delta_1, \\delta_2)$ where $\\delta_1, \\delta_2 \\in \\mathbb{C}$.\n\nFirst, we establish the value of the induced $2$-norm of $M$, denoted $\\|M\\|_{2}$. The induced $2$-norm of a matrix is its maximum singular value, $\\bar{\\sigma}(M)$. The singular values are the square roots of the eigenvalues of the matrix $M^*M$, where $M^*$ is the conjugate transpose of $M$.\nFor the given real matrix $M$, the conjugate transpose $M^*$ is the same as its transpose $M^T$.\n$$ M^* = M^T = \\gamma \\begin{bmatrix} 0 & 1 \\\\ 1 & 0 \\end{bmatrix}^T = \\gamma \\begin{bmatrix} 0 & 1 \\\\ 1 & 0 \\end{bmatrix} = M $$\nNext, we compute $M^*M$:\n$$ M^*M = M^2 = \\left( \\gamma \\begin{bmatrix} 0 & 1 \\\\ 1 & 0 \\end{bmatrix} \\right) \\left( \\gamma \\begin{bmatrix} 0 & 1 \\\\ 1 & 0 \\end{bmatrix} \\right) = \\gamma^2 \\begin{bmatrix} 0 & 1 \\\\ 1 & 0 \\end{bmatrix} \\begin{bmatrix} 0 & 1 \\\\ 1 & 0 \\end{bmatrix} = \\gamma^2 \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} = \\gamma^2 I $$\nThe matrix $M^*M$ is $\\gamma^2$ times the $2 \\times 2$ identity matrix $I$. Its eigenvalues are $\\lambda_1 = \\lambda_2 = \\gamma^2$.\nThe singular values of $M$ are the square roots of these eigenvalues:\n$$ \\sigma_1 = \\sqrt{\\gamma^2} = |\\gamma|, \\quad \\sigma_2 = \\sqrt{\\gamma^2} = |\\gamma| $$\nSince $\\gamma = 0.9998 > 0$, we have $\\sigma_1 = \\sigma_2 = \\gamma$.\nThe induced $2$-norm is the largest of these singular values:\n$$ \\|M\\|_{2} = \\bar{\\sigma}(M) = \\max(\\sigma_1, \\sigma_2) = \\gamma = 0.9998 $$\n\nNext, we determine the minimal norm of a structured perturbation $\\Delta$ that makes the matrix $I - M\\Delta$ singular. The fundamental definition of the structured singular value $\\mu_{\\Delta}(M)$ is based on this quantity.\nThe matrix $I - M\\Delta$ is singular if and only if its determinant is zero, i.e., $\\det(I - M\\Delta) = 0$.\nFirst, we compute the product $M\\Delta$:\n$$ M\\Delta = \\gamma \\begin{bmatrix} 0 & 1 \\\\ 1 & 0 \\end{bmatrix} \\begin{bmatrix} \\delta_1 & 0 \\\\ 0 & \\delta_2 \\end{bmatrix} = \\gamma \\begin{bmatrix} 0 & \\delta_2 \\\\ \\delta_1 & 0 \\end{bmatrix} $$\nNow, we form the matrix $I - M\\Delta$ and compute its determinant:\n$$ I - M\\Delta = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} - \\gamma \\begin{bmatrix} 0 & \\delta_2 \\\\ \\delta_1 & 0 \\end{bmatrix} = \\begin{bmatrix} 1 & -\\gamma \\delta_2 \\\\ -\\gamma \\delta_1 & 1 \\end{bmatrix} $$\n$$ \\det(I - M\\Delta) = (1)(1) - (-\\gamma \\delta_2)(-\\gamma \\delta_1) = 1 - \\gamma^2 \\delta_1 \\delta_2 $$\nFor singularity, we must have $\\det(I - M\\Delta) = 0$, which implies:\n$$ 1 - \\gamma^2 \\delta_1 \\delta_2 = 0 \\implies \\delta_1 \\delta_2 = \\frac{1}{\\gamma^2} $$\nWe need to find the minimum value of $\\|\\Delta\\|$ subject to this condition. The norm on the structured uncertainty $\\Delta$ is given as $\\|\\Delta\\| = \\max\\{|\\delta_1|, |\\delta_2|\\}$. Taking the magnitude of the singularity condition gives $|\\delta_1||\\delta_2| = |1/\\gamma^2| = 1/\\gamma^2$.\nWe must solve the following optimization problem: minimize $\\max\\{|\\delta_1|, |\\delta_2|\\}$ subject to the constraint $|\\delta_1||\\delta_2| = 1/\\gamma^2$. Let $r_1 = |\\delta_1|$ and $r_2 = |\\delta_2|$. We want to minimize $\\max(r_1, r_2)$ subject to $r_1 r_2 = 1/\\gamma^2$ for $r_1, r_2 \\ge 0$.\nBy the AM-GM inequality, or by simple inspection, the maximum of two non-negative numbers with a fixed product is minimized when the two numbers are equal. Thus, the minimum occurs when $r_1 = r_2$.\n$$ r_1 = r_2 \\implies r_1^2 = \\frac{1}{\\gamma^2} \\implies r_1 = \\frac{1}{\\gamma} $$\nSo, the minimal norm is achieved when $|\\delta_1| = |\\delta_2| = 1/\\gamma$.\nThe minimal value of $\\|\\Delta\\|$ is therefore $1/\\gamma$.\n\nNow, we compute the structured singular value $\\mu_{\\Delta}(M)$. By its fundamental definition:\n$$ \\mu_{\\Delta}(M) = \\left( \\min_{\\Delta \\in \\mathcal{D}} \\{ \\|\\Delta\\| \\mid \\det(I - M\\Delta) = 0 \\} \\right)^{-1} $$\nwhere $\\mathcal{D}$ is the set of all matrices with the specified block-diagonal structure.\nFrom our preceding analysis, the minimum norm is $1/\\gamma$.\n$$ \\mu_{\\Delta}(M) = \\left( \\frac{1}{\\gamma} \\right)^{-1} = \\gamma $$\nSubstituting the value of $\\gamma$:\n$$ \\mu_{\\Delta}(M) = 0.9998 $$\n\nFinally, we provide the interpretation. We found that $\\|M\\|_2 = \\gamma = 0.9998$ and $\\mu_{\\Delta}(M) = \\gamma = 0.9998$. Both values are less than $1$ but are very close to $1$. The Main Loop Theorem for robust stability states that the feedback interconnection is stable for all structured perturbations $\\Delta$ satisfying $\\|\\Delta\\| < 1/\\mu_{\\Delta}(M)$.\nIn this case, the stability margin is $1/\\mu_{\\Delta}(M) = 1/\\gamma = 1/0.9998 \\approx 1.0002$. This means a perturbation of size only slightly larger than $1$ can cause instability, which is why $\\mu_{\\Delta}(M)$ is considered high (very close to $1$).\n\nThe reason this occurs relates to the alignment of the perturbation with the system's dynamics. The singular vectors of $M$ (which are also its eigenvectors in this case, e.g., $v_1 = (1/\\sqrt{2})[1, 1]^T$ and $v_2 = (1/\\sqrt{2})[1, -1]^T$) are misaligned with the coordinate axes $e_1=[1, 0]^T$ and $e_2=[0, 1]^T$ that define the directions of the uncertainty blocks $\\delta_1$ and $\\delta_2$. One might naively assume that such a misalignment would make the system less vulnerable to diagonal perturbations. However, a specific \"conspiratorial\" structured perturbation can be formed. The minimal-norm destabilizing perturbation requires $|\\delta_1| = |\\delta_2| = 1/\\gamma$. A possible choice is $\\delta_1 = \\delta_2 = 1/\\gamma$. This creates the perturbation matrix $\\Delta = (1/\\gamma)I$.\nThe condition for instability, $\\det(I-M\\Delta)=0$, is equivalent to finding a vector $x$ such that $M\\Delta x = x$. For this choice of $\\Delta$, the condition becomes $M((1/\\gamma)I)x = x$, which simplifies to $Mx = \\gamma x$. This is an eigenvalue problem for $M$.\nThe matrix $M$ has eigenvalues $\\pm\\gamma$. Thus, the condition $Mx = \\gamma x$ is satisfied by the eigenvector corresponding to the eigenvalue $\\gamma$, which is any multiple of $[1, 1]^T$. This demonstrates that despite the constraint that $\\Delta$ must be diagonal, there exists a choice of $\\delta_1, \\delta_2$ (namely $\\delta_1=\\delta_2$) that creates an effective perturbation that is isotropic and perfectly excites an eigenmode of $M$, leading to instability. The minimal size of such a perturbation is $1/\\gamma$, leading to $\\mu_{\\Delta}(M)=\\gamma$. The high value of $\\mu_{\\Delta}(M)$ is therefore a direct reflection of the fact that an eigenvalue of $M$ is very close to the unit circle, and that a permissible structured perturbation exists that can \"find\" and amplify this specific mode. In this particular case, the worst-case structured perturbation is a multiple of the identity, which is a form also captured by the unstructured norm, leading to the equality $\\mu_{\\Delta}(M) = \\|M\\|_2$.", "answer": "$$\\boxed{0.9998}$$", "id": "2758632"}, {"introduction": "Having established the need for a more refined stability metric, we now turn to the formal definition of the structured singular value, $\\mu$. This practice [@problem_id:2758646] is a foundational exercise, requiring you to apply the definition of $\\mu$ directly to a core analytical problem. By working through a canonical case involving repeated scalar uncertainty, you will uncover the fundamental relationship between $\\mu_{\\Delta}(M)$ and the spectral radius $\\rho(M)$, a crucial insight in robust control.", "problem": "Let $M \\in \\mathbb{C}^{2 \\times 2}$ be given by $M = \\begin{bmatrix} 0 & a \\\\ b & 0 \\end{bmatrix}$ with $a,b \\in \\mathbb{C}$. Consider a feedback interconnection with a single complex scalar uncertainty that is repeated across two channels, so that the admissible uncertainty set is $\\boldsymbol{\\Delta} = \\{ \\delta I_{2} : \\delta \\in \\mathbb{C} \\}$, where $I_{2}$ is the $2 \\times 2$ identity matrix. The structured singular value (also called the $\\mu$-value) with respect to $\\boldsymbol{\\Delta}$, denoted $\\mu_{\\boldsymbol{\\Delta}}(M)$, is defined by\n$$\n\\mu_{\\boldsymbol{\\Delta}}(M) = \\frac{1}{\\inf\\{\\, \\|\\Delta\\| : \\Delta \\in \\boldsymbol{\\Delta},\\ \\det(I - M \\Delta) = 0 \\,\\}} \\,,\n$$\nwhere $\\|\\cdot\\|$ is the operator $2$-norm and $I$ is the identity matrix of dimension $2$. This definition is a central ingredient in the Main Loop Theorem (MLT) of robust control, which certifies robust stability of the feedback interconnection if and only if $\\mu_{\\boldsymbol{\\Delta}}(M(j\\omega)) < 1$ for all real frequencies $\\omega$.\n\nStarting from the above definition only, compute an explicit closed-form expression for $\\mu_{\\boldsymbol{\\Delta}}(M)$ in terms of $a$ and $b$, and explain how it depends on $|ab|$. Your final answer must be a single simplified analytic expression in terms of $a$ and $b$ (no numerical values are needed). Do not include any units.", "solution": "The problem asks for the computation of the structured singular value, $\\mu_{\\boldsymbol{\\Delta}}(M)$, for a specific matrix $M$ and uncertainty structure $\\boldsymbol{\\Delta}$. The definition provided is:\n$$\n\\mu_{\\boldsymbol{\\Delta}}(M) = \\frac{1}{\\inf\\{\\, \\|\\Delta\\| : \\Delta \\in \\boldsymbol{\\Delta},\\ \\det(I - M \\Delta) = 0 \\,\\}}\n$$\nWe must derive the solution exclusively from this definition.\n\nFirst, let us characterize the elements of the set $\\boldsymbol{\\Delta}$ and their norms. The uncertainty structure is given as $\\boldsymbol{\\Delta} = \\{ \\delta I_{2} : \\delta \\in \\mathbb{C} \\}$, where $I_2$ is the $2 \\times 2$ identity matrix. An element $\\Delta \\in \\boldsymbol{\\Delta}$ is of the form $\\Delta = \\delta I_2 = \\begin{bmatrix} \\delta & 0 \\\\ 0 & \\delta \\end{bmatrix}$ for some complex scalar $\\delta$. The norm specified is the operator $2$-norm. The singular values of the matrix $\\delta I_2$ are both equal to $|\\delta|$. The operator $2$-norm is the largest singular value, so we have $\\|\\Delta\\| = |\\delta|$.\n\nSubstituting this into the definition of $\\mu_{\\boldsymbol{\\Delta}}(M)$, we obtain:\n$$\n\\mu_{\\boldsymbol{\\Delta}}(M) = \\frac{1}{\\inf\\{\\, |\\delta| : \\delta \\in \\mathbb{C},\\ \\det(I - M (\\delta I_2)) = 0 \\,\\}}\n$$\nThe condition for the infimum is $\\det(I - \\delta M) = 0$. This equation implies that the matrix $I - \\delta M$ is singular. This is equivalent to stating that there exists a non-zero vector $v$ such that $(I - \\delta M)v = 0$, which can be rewritten as $\\delta M v = v$. If $\\delta \\ne 0$, this is equivalent to $Mv = \\frac{1}{\\delta} v$. This means $\\frac{1}{\\delta}$ is an eigenvalue of the matrix $M$. Conversely, if $\\lambda$ is an eigenvalue of $M$, then setting $\\delta = \\frac{1}{\\lambda}$ (for $\\lambda \\neq 0$) ensures that $\\det(I - \\delta M) = 0$.\n\nTherefore, the set of complex numbers $\\delta$ for which $\\det(I - \\delta M) = 0$ is the set of reciprocals of the non-zero eigenvalues of $M$. We are seeking the infimum of the magnitudes of these values of $\\delta$.\n$$\n\\inf\\{|\\delta|\\} = \\inf\\left\\{ \\left|\\frac{1}{\\lambda}\\right| : \\lambda \\text{ is a non-zero eigenvalue of } M \\right\\}\n$$\nThis infimum can be expressed in terms of the spectral radius of $M$, which is defined as $\\rho(M) = \\max_i |\\lambda_i|$, where $\\lambda_i$ are the eigenvalues of $M$.\n$$\n\\inf\\left\\{ \\frac{1}{|\\lambda|} \\right\\} = \\frac{1}{\\max\\{|\\lambda|\\}} = \\frac{1}{\\rho(M)}\n$$\nThis holds provided $\\rho(M) \\neq 0$. If $\\rho(M)=0$, all eigenvalues are zero. In this case, there is no $\\delta$ such that $\\delta \\cdot 0 = 1$, so the set of destabilizing $\\delta$ values is empty. The infimum over an empty set is defined as $+\\infty$. Thus, if $\\rho(M)=0$, we have $\\inf\\{|\\delta|\\} = \\infty$, which leads to $\\mu_{\\boldsymbol{\\Delta}}(M) = 1/\\infty = 0$. This is consistent with the formula $\\mu_{\\boldsymbol{\\Delta}}(M) = \\rho(M)$.\n\nSo, we have established that for this specific structure of repeated scalar uncertainty, $\\mu_{\\boldsymbol{\\Delta}}(M) = \\rho(M)$.\n\nThe next step is to compute the spectral radius of the given matrix $M = \\begin{bmatrix} 0 & a \\\\ b & 0 \\end{bmatrix}$. The eigenvalues $\\lambda$ are the roots of the characteristic polynomial, $\\det(\\lambda I - M) = 0$.\n$$\n\\det\\left(\\begin{bmatrix} \\lambda & 0 \\\\ 0 & \\lambda \\end{bmatrix} - \\begin{bmatrix} 0 & a \\\\ b & 0 \\end{bmatrix}\\right) = \\det\\begin{bmatrix} \\lambda & -a \\\\ -b & \\lambda \\end{bmatrix} = \\lambda^2 - ab = 0\n$$\nThe solutions for $\\lambda$ are $\\lambda_{1,2} = \\pm\\sqrt{ab}$. The term $\\sqrt{ab}$ denotes one of the two complex square roots of the complex number $ab$.\n\nThe spectral radius $\\rho(M)$ is the maximum of the magnitudes of these eigenvalues:\n$$\n\\rho(M) = \\max\\left( |\\sqrt{ab}|, |-\\sqrt{ab}| \\right)\n$$\nSince $|-1|=1$, we have $|-\\sqrt{ab}| = |\\sqrt{ab}|$. For any complex number $z$, the magnitude of its square root is the square root of its magnitude: $|\\sqrt{z}| = \\sqrt{|z|}$. Applying this property, we get:\n$$\n|\\sqrt{ab}| = \\sqrt{|ab|}\n$$\nTherefore, the spectral radius of $M$ is:\n$$\n\\rho(M) = \\sqrt{|ab|}\n$$\nFinally, we can state the expression for the structured singular value:\n$$\n\\mu_{\\boldsymbol{\\Delta}}(M) = \\rho(M) = \\sqrt{|ab|}\n$$\nThis expression demonstrates that $\\mu_{\\boldsymbol{\\Delta}}(M)$ depends only on the magnitude of the product of the off-diagonal entries, $|ab|$. It is specifically the square root of this magnitude. The phases of the complex numbers $a$ and $b$ affect the eigenvalues $\\lambda_{1,2}$, but their combined effect on the spectral radius, and thus on $\\mu_{\\boldsymbol{\\Delta}}(M)$, is encapsulated entirely by the magnitude of their product.", "answer": "$$\n\\boxed{\\sqrt{|ab|}}\n$$", "id": "2758646"}, {"introduction": "While analytical computation of $\\mu$ is insightful, most engineering problems are too complex for this approach, necessitating numerical methods. This practice [@problem_id:2758619] introduces the standard computational technique used to certify robust stability: the $D$-scaling upper bound. You will learn how to reduce the conservatism inherent in the unstructured norm bound by performing a similarity scaling, transforming the stability analysis into a convex optimization problem that is readily solvable with modern computational tools.", "problem": "At a fixed angular frequency $\\omega_0$, consider the standard feedback interconnection of a Linear Time-Invariant (LTI) system and an uncertainty set represented, at frequency $\\omega_0$, by the complex matrix $M(j\\omega_0)$, denoted here simply as $M\\in\\mathbb{C}^{n\\times n}$. The uncertainty structure consists of two repeated complex scalar blocks, so that the admissible uncertainties are of the form $\\Delta=\\operatorname{diag}(\\delta_1 I_{r_1},\\,\\delta_2 I_{r_2})$ with $\\delta_1,\\delta_2\\in\\mathbb{C}$ and $|\\delta_1|\\le 1$, $|\\delta_2|\\le 1$. The Structured Singular Value (SSV) $\\mu_\\Delta(M)$ at $\\omega_0$ provides a necessary and sufficient frequency-by-frequency condition for robust stability through the Main Loop Theorem. A widely used computable upper bound uses block-diagonal scalings $D$ that commute with $\\Delta$. For two repeated complex scalar blocks, such scalings have the form $D=\\operatorname{diag}(d_1 I_{r_1},\\,d_2 I_{r_2})$ with $d_1>0$ and $d_2>0$.\n\nStarting from first principles, namely the definition of the Structured Singular Value and the submultiplicativity of the induced $2$-norm, derive the block-diagonal scaling upper bound for $\\mu_\\Delta(M)$ at a single frequency $\\omega_0$ as the infimum of the induced $2$-norm of the similarity-scaled interconnection $DMD^{-1}$ over all positive definite $D$ that commute with $\\Delta$. Specialize this construction to the case of two repeated complex scalar blocks to show that, without loss of generality, the bound depends only on the ratio $\\rho=d_1/d_2>0$ and that the scaled interconnection is\n$$\nM_\\rho = \\begin{bmatrix}\nA & \\rho\\,B\\\\\n\\rho^{-1}\\,C & D\n\\end{bmatrix},\n$$\nwhere $M=\\begin{bmatrix}A & B\\\\ C & D\\end{bmatrix}$ is partitioned conformably with the block sizes $r_1$ and $r_2$. Your program must compute, for each test case below, the tightest block-diagonal scaling upper bound at $\\omega_0$, i.e.,\n$$\n\\inf_{\\rho>0}\\, \\overline{\\sigma}\\!\\left(M_\\rho\\right),\n$$\nwhere $\\overline{\\sigma}(\\cdot)$ denotes the largest singular value (the induced $2$-norm). Implement the computation as a one-dimensional search over $\\rho>0$ (equivalently over $t=\\log \\rho\\in\\mathbb{R}$), using numerically sound procedures.\n\nTest Suite. For each case, $M$ is given numerically and the uncertainty structure has two repeated complex scalar blocks of the specified sizes. All matrices are real-valued instances of complex matrices.\n\n- Case $1$ (general coupled case, $r_1=2, r_2=2$):\n$$\nM_1 =\n\\begin{bmatrix}\n0.2 & 0.0 & 5.0 & 0.0\\\\\n0.0 & 0.2 & 0.0 & 4.0\\\\\n0.2 & 0.0 & 0.2 & 0.0\\\\\n0.0 & 0.1 & 0.0 & 0.2\n\\end{bmatrix}.\n$$\n\n- Case $2$ (block-diagonal boundary case, $r_1=1, r_2=3$):\n$$\nM_2 =\n\\begin{bmatrix}\n1.5 & 0.0 & 0.0 & 0.0\\\\\n0.0 & 0.5 & 0.0 & 0.0\\\\\n0.0 & 0.0 & 0.6 & 0.0\\\\\n0.0 & 0.0 & 0.0 & 0.4\n\\end{bmatrix}.\n$$\n\n- Case $3$ (rank-$1$ interconnection symmetry, $r_1=3, r_2=1$):\n$$\nM_3 =\n\\begin{bmatrix}\n0.1 & 0.0 & 0.0 & 2.0\\\\\n0.0 & 0.1 & 0.0 & -1.0\\\\\n0.0 & 0.0 & 0.1 & 0.5\\\\\n2.0 & -1.0 & 0.5 & 0.1\n\\end{bmatrix}.\n$$\n\nRequirements for the program.\n\n- For each case, compute the D-scaling upper bound $\\inf_{\\rho>0}\\overline{\\sigma}(M_\\rho)$ as described above. Use only the induced $2$-norm (largest singular value).\n- Use robust numerical optimization over $t=\\log\\rho\\in\\mathbb{R}$; equivalently, search over $\\rho>0$.\n- Return one floating-point value per case, rounded to exactly $6$ decimal places.\n- Final Output Format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,x_3]$), ordered as $[\\text{Case }1,\\,\\text{Case }2,\\,\\text{Case }3]$.\n\nNo physical units are involved. Angles are not involved. All percentages, if any, must be expressed as decimals; none appear here. The final answer must be a complete, runnable program.", "solution": "The problem requires the derivation of the upper bound for the Structured Singular Value ($\\mu$) based on block-diagonal scaling, followed by a numerical implementation to compute this bound for several test cases. The derivation and solution will adhere to established principles of control theory.\n\nThe derivation begins with the definition of the Structured Singular Value, $\\mu_\\Delta(M)$, for a complex matrix $M \\in \\mathbb{C}^{n \\times n}$ with respect to a given uncertainty structure $\\boldsymbol{\\Delta}$:\n$$ \\mu_\\Delta(M) := \\left( \\min_{\\Delta \\in \\boldsymbol{\\Delta}} \\{ \\overline{\\sigma}(\\Delta) : \\det(I - M\\Delta) = 0 \\} \\right)^{-1} $$\nif a $\\Delta \\in \\boldsymbol{\\Delta}$ exists such that $\\det(I - M\\Delta) = 0$, and $\\mu_\\Delta(M) := 0$ otherwise. Here, $\\overline{\\sigma}(\\cdot)$ is the largest singular value, representing the induced $2$-norm. The condition $\\det(I - M\\Delta) = 0$ corresponds to a pole of the closed-loop system appearing at $s=0$ (in continuous time at a specific frequency), signifying instability.\n\nA key technique in $\\mu$-analysis involves scaling matrices. Let $\\mathcal{D}$ be a set of invertible matrices, denoted here as $D_{scale}$, that commute with every uncertainty matrix $\\Delta \\in \\boldsymbol{\\Delta}$ (i.e., $D_{scale}\\Delta = \\Delta D_{scale}$). For any $D_{scale} \\in \\mathcal{D}$, the instability condition is invariant under a similarity transformation:\n$$ \\det(I - M\\Delta) = 0 \\iff \\det(I - D_{scale}MD_{scale}^{-1} \\Delta) = 0 $$\nThis equivalence follows from $\\det(I - M\\Delta) = \\det(D_{scale}(I-M\\Delta)D_{scale}^{-1}) = \\det(I - D_{scale}M\\Delta D_{scale}^{-1})$. Since $D_{scale}$ and $\\Delta$ commute, $\\Delta D_{scale}^{-1} = D_{scale}^{-1}\\Delta$, which leads to the stated equivalence. This implies that the structured singular value is also invariant under this transformation:\n$$ \\mu_\\Delta(M) = \\mu_\\Delta(D_{scale}MD_{scale}^{-1}) \\quad \\forall D_{scale} \\in \\mathcal{D} $$\n\nA fundamental bound relates $\\mu$ to the matrix norm: $\\mu_\\Delta(A) \\le \\overline{\\sigma}(A)$ for any matrix $A$. This is because if $\\det(I - A\\Delta) = 0$ for some $\\Delta$, there exists a nonzero vector $x$ where $A\\Delta x = x$. Taking norms yields $1 \\le \\overline{\\sigma}(A)\\overline{\\sigma}(\\Delta)$, which means $\\overline{\\sigma}(\\Delta) \\ge 1/\\overline{\\sigma}(A)$. From the definition of $\\mu$, it follows that $\\mu_\\Delta(A) \\le \\overline{\\sigma}(A)$.\n\nCombining these facts gives $\\mu_\\Delta(M) = \\mu_\\Delta(D_{scale}MD_{scale}^{-1}) \\le \\overline{\\sigma}(D_{scale}MD_{scale}^{-1})$. This inequality holds for all valid scaling matrices. To obtain the tightest bound, we take the infimum over all $D_{scale} \\in \\mathcal{D}$:\n$$ \\mu_\\Delta(M) \\le \\inf_{D_{scale} \\in \\mathcal{D}} \\overline{\\sigma}(D_{scale}MD_{scale}^{-1}) $$\n\nFor the problem's specific uncertainty structure of $2$ repeated complex scalar blocks, $\\Delta = \\operatorname{diag}(\\delta_1 I_{r_1}, \\delta_2 I_{r_2})$, the set $\\mathcal{D}$ of commuting, positive-definite scaling matrices is given as:\n$$ D_{scale} = \\operatorname{diag}(d_1 I_{r_1}, d_2 I_{r_2}) \\quad \\text{with } d_1 > 0, d_2 > 0 $$\nLet $M$ be partitioned conformably: $M = \\begin{bmatrix} A & B \\\\ C & D \\end{bmatrix}$, with blocks of sizes corresponding to $r_1$ and $r_2$. The similarity transformation yields:\n$$ D_{scale}MD_{scale}^{-1} = \\begin{bmatrix} d_1 I_{r_1} & 0 \\\\ 0 & d_2 I_{r_2} \\end{bmatrix} \\begin{bmatrix} A & B \\\\ C & D \\end{bmatrix} \\begin{bmatrix} d_1^{-1} I_{r_1} & 0 \\\\ 0 & d_2^{-1} I_{r_2} \\end{bmatrix} = \\begin{bmatrix} A & (d_1/d_2)B \\\\ (d_2/d_1)C & D \\end{bmatrix} $$\nThe scaled matrix depends only on the ratio $\\rho = d_1/d_2 > 0$. Let this scaled matrix be $M_\\rho$:\n$$ M_\\rho = \\begin{bmatrix} A & \\rho B \\\\ \\rho^{-1} C & D \\end{bmatrix} $$\nThe optimization problem simplifies to a $1$-dimensional search for the positive scalar $\\rho$:\n$$ \\inf_{\\rho > 0} \\overline{\\sigma}(M_\\rho) $$\nFor numerical solution, we perform a change of variables $t = \\log \\rho$, transforming the search domain from $\\rho \\in (0, \\infty)$ to an unconstrained search for $t \\in \\mathbb{R}$. The objective function, $f(t) = \\overline{\\sigma}(M_{e^t})$, is convex in $t$ for this problem structure, ensuring that a local minimum is the global minimum. The implementation will utilize a numerical optimizer to find this minimum for each test case.\nFor Case $2$, the off-diagonal blocks $B$ and $C$ are zero matrices, which makes $M_\\rho = M$ for all $\\rho>0$. The optimization becomes trivial; the result is simply $\\overline{\\sigma}(M)$. For the other cases, a numerical search is necessary.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\nimport scipy\n\ndef solve():\n    \"\"\"\n    Main function to solve the given problem for all test cases.\n    It computes the mu-upper bound by optimizing over the scaling parameter rho.\n    \"\"\"\n\n    def compute_mu_upper_bound(M, r1):\n        \"\"\"\n        Computes the infimum of the block-diagonal D-scaling upper bound for mu.\n        This is inf_{rho>0} overline_sigma(M_rho), where M_rho is the scaled matrix.\n        \n        Args:\n            M (np.ndarray): The complex matrix M at frequency omega_0.\n            r1 (int): The size of the first block in the uncertainty structure.\n        \n        Returns:\n            float: The computed upper bound.\n        \"\"\"\n        n = M.shape[0]\n        r2 = n - r1\n\n        # Partition matrix M into A, B, C, D blocks\n        A = M[0:r1, 0:r1]\n        B = M[0:r1, r1:n]\n        C = M[r1:n, 0:r1]\n        D_block = M[r1:n, r1:n]\n\n        # Handle the trivial case where off-diagonal coupling blocks are zero.\n        # This is the case for M2, where M_rho is independent of rho.\n        if np.allclose(B, 0) and np.allclose(C, 0):\n            # The result is simply the largest singular value of the original matrix.\n            s = np.linalg.svd(M, compute_uv=False)\n            return np.max(s)\n\n        def objective_func(t):\n            \"\"\"\n            Objective function for the optimizer.\n            The variable t is log(rho).\n            \"\"\"\n            rho = np.exp(t)\n            \n            # Construct the scaled matrix M_rho\n            M_rho = np.block([\n                [A,           rho * B],\n                [1.0/rho * C, D_block]\n            ])\n            \n            # The value to minimize is the largest singular value (induced 2-norm).\n            # np.linalg.svd returns singular values in descending order.\n            s = np.linalg.svd(M_rho, compute_uv=False)\n            return s[0]\n\n        # Use a robust 1D optimizer. The search space for t is (-inf, inf).\n        # minimize_scalar's default (Brent) method is well-suited for this\n        # convex optimization problem.\n        result = minimize_scalar(objective_func)\n\n        return result.fun\n\n    # Define the test cases from the problem statement.\n    \n    # Case 1: r1=2, r2=2\n    M1 = np.array([\n        [0.2, 0.0, 5.0, 0.0],\n        [0.0, 0.2, 0.0, 4.0],\n        [0.2, 0.0, 0.2, 0.0],\n        [0.0, 0.1, 0.0, 0.2]\n    ])\n    r1_1 = 2\n\n    # Case 2: r1=1, r2=3\n    M2 = np.array([\n        [1.5, 0.0, 0.0, 0.0],\n        [0.0, 0.5, 0.0, 0.0],\n        [0.0, 0.0, 0.6, 0.0],\n        [0.0, 0.0, 0.0, 0.4]\n    ])\n    r1_2 = 1\n\n    # Case 3: r1=3, r2=1\n    M3 = np.array([\n        [0.1, 0.0, 0.0, 2.0],\n        [0.0, 0.1, 0.0, -1.0],\n        [0.0, 0.0, 0.1, 0.5],\n        [2.0, -1.0, 0.5, 0.1]\n    ])\n    r1_3 = 3\n\n    test_cases = [\n        (M1, r1_1),\n        (M2, r1_2),\n        (M3, r1_3)\n    ]\n\n    results = []\n    for M, r1 in test_cases:\n        bound = compute_mu_upper_bound(M, r1)\n        # Format the result to exactly 6 decimal places.\n        results.append(f\"{bound:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2758619"}]}