{"hands_on_practices": [{"introduction": "This practice focuses on a fundamental skill in robust control: translating a block diagram representation of an uncertain system into the standard Linear Fractional Transformation (LFT) framework. By systematically deriving the loop matrix for an input multiplicative uncertainty model, you will solidify your understanding of how to isolate uncertainty and set up the problem for analysis using tools like the small-gain theorem. This algebraic manipulation is a crucial first step in nearly all modern robustness analyses [@problem_id:2757074].", "problem": "Consider a nominal single-input single-output or multi-input multi-output linear time-invariant feedback interconnection with a nominal plant $P(s)$ and a stabilizing controller $K(s)$ in unity negative feedback. Let the sensitivity function be defined by $S(s) = \\left(I + P(s)K(s)\\right)^{-1}$. Model actuator-side uncertainty as input multiplicative uncertainty with a stable, bounded operator $\\Delta_{mi}(s)$ premultiplied by a known, stable weighting $W_{mi}(s)$ acting on the controller output. Specifically, the signal relations are\n- $e(s) = r(s) - y(s)$,\n- $u(s) = K(s)\\,e(s)$,\n- $\\tilde{u}(s) = \\left(I + W_{mi}(s)\\,\\Delta_{mi}(s)\\right) u(s)$,\n- $y(s) = P(s)\\,\\tilde{u}(s)$,\nand robust stability is assessed with $r(s) \\equiv 0$.\n\nUsing only these fundamental definitions, do the following:\n- Rewrite the uncertain interconnection in a form that exposes a lower Linear Fractional Transformation (LFT) with the uncertainty $\\Delta_{mi}(s)$ in feedback with a nominal, stable linear time-invariant system.\n- Identify the pair of port variables $(v,w)$ such that $w(s) = \\Delta_{mi}(s)\\,v(s)$ and express the mapping from $w$ to $v$ through the rest of the closed-loop system (with $\\Delta_{mi}$ opened) as a single operator $M_{mi}(s)$, known as the loop matrix seen by $\\Delta_{mi}$.\n- Compute $M_{mi}(s)$ explicitly in terms of $K(s)$ and $S(s)$, together with $P(s)$ and $W_{mi}(s)$ as needed for dimensional consistency.\n\nYour final answer must be a single closed-form analytic expression for $M_{mi}(s)$, containing only the symbols $K(s)$, $S(s)$, $P(s)$, and $W_{mi}(s)$ as appropriate. No numerical approximation is required.", "solution": "The supplied problem is rigorously defined, self-contained, and scientifically sound. It is a fundamental exercise in robust control theory, specifically in the analysis of unstructured uncertainty using the Linear Fractional Transformation (LFT) framework. All provided definitions and signal relationships are standard in the field. The problem is valid, and a solution will be provided.\n\nThe objective is to derive the loop matrix $M_{mi}(s)$ for an LFT representation of the given feedback system with actuator-side multiplicative uncertainty. The LFT isolates the uncertainty block $\\Delta_{mi}(s)$ from the nominal part of the system. The relationship between the port variables $v(s)$ and $w(s)$ is given by $w(s) = \\Delta_{mi}(s)v(s)$, and $v(s)$ is the output of the nominal system block $M_{mi}(s)$ with input $w(s)$, thus creating a feedback loop.\n\nThe perturbed control signal $\\tilde{u}(s)$ is given by the relation:\n$$ \\tilde{u}(s) = \\left(I + W_{mi}(s)\\,\\Delta_{mi}(s)\\right) u(s) = u(s) + W_{mi}(s)\\,\\Delta_{mi}(s)u(s) $$\nTo establish the LFT structure, we must define the port variables $v(s)$ and $w(s)$ that interface with the uncertainty block $\\Delta_{mi}(s)$. We define the input to the uncertainty block, $v(s)$, and the output from the uncertainty block, $w(s)$, as follows:\n$$ v(s) := u(s) $$\n$$ w(s) := \\Delta_{mi}(s) v(s) = \\Delta_{mi}(s) u(s) $$\nSubstituting these definitions into the expression for $\\tilde{u}(s)$, we obtain:\n$$ \\tilde{u}(s) = u(s) + W_{mi}(s) w(s) $$\nThis expression connects the input $w(s)$ from the uncertainty block to the nominal system dynamics. The task is to find the transfer matrix $M_{mi}(s)$ which maps $w(s)$ to $v(s)$, i.e., $v(s) = M_{mi}(s)w(s)$. As $v(s) = u(s)$, we must find the transfer matrix from $w(s)$ to $u(s)$.\n\nFor robust stability analysis, we analyze the internal stability of the loop, which requires setting all external inputs to zero. Therefore, the reference signal $r(s)$ is set to $r(s) \\equiv 0$. The system equations become:\n1. $e(s) = -y(s)$\n2. $u(s) = K(s)\\,e(s)$\n3. $y(s) = P(s)\\,\\tilde{u}(s)$\n\nWe proceed by algebraic substitution to find $u(s)$ as a function of $w(s)$.\nFirst, combine equations (1) and (2):\n$$ u(s) = -K(s)y(s) $$\nNext, substitute the expression for $\\tilde{u}(s)$ into equation (3):\n$$ y(s) = P(s) \\left( u(s) + W_{mi}(s) w(s) \\right) $$\nNow, substitute this expression for $y(s)$ into the equation for $u(s)$:\n$$ u(s) = -K(s) \\left[ P(s) \\left( u(s) + W_{mi}(s) w(s) \\right) \\right] $$\nExpanding the terms on the right-hand side gives:\n$$ u(s) = -K(s)P(s)u(s) - K(s)P(s)W_{mi}(s)w(s) $$\nTo solve for $u(s)$, we gather all terms involving $u(s)$ on the left-hand side. The identity matrix $I$ is used for proper matrix algebra.\n$$ I u(s) + K(s)P(s)u(s) = -K(s)P(s)W_{mi}(s)w(s) $$\nFactoring out $u(s)$:\n$$ \\left(I + K(s)P(s)\\right)u(s) = -K(s)P(s)W_{mi}(s)w(s) $$\nPre-multiplying by the inverse of $\\left(I + K(s)P(s)\\right)$ isolates $u(s)$:\n$$ u(s) = -\\left(I + K(s)P(s)\\right)^{-1} K(s)P(s)W_{mi}(s)w(s) $$\nSince we defined $v(s) = u(s)$, we have found the mapping from $w(s)$ to $v(s)$. The loop matrix $M_{mi}(s)$ is therefore:\n$$ M_{mi}(s) = -\\left(I + K(s)P(s)\\right)^{-1} K(s)P(s)W_{mi}(s) $$\nThe problem requires the final expression to be in terms of the sensitivity function $S(s) = \\left(I + P(s)K(s)\\right)^{-1}$. We use the well-known push-through matrix identity:\n$$ \\left(I + AB\\right)^{-1}A = A\\left(I + BA\\right)^{-1} $$\nLetting $A = K(s)$ and $B = P(s)$, the identity becomes:\n$$ \\left(I + K(s)P(s)\\right)^{-1}K(s) = K(s)\\left(I + P(s)K(s)\\right)^{-1} = K(s)S(s) $$\nSubstituting this into our expression for $M_{mi}(s)$:\n$$ M_{mi}(s) = - \\left[ \\left(I + K(s)P(s)\\right)^{-1}K(s) \\right] P(s)W_{mi}(s) $$\nThis yields the final expression for the loop matrix:\n$$ M_{mi}(s) = -K(s)S(s)P(s)W_{mi}(s) $$\nThis result is the transfer matrix from the output Port $w(s)$ of the uncertainty block $\\Delta_{mi}(s)$ to its input port $v(s)$, expressed in the required terms.", "answer": "$$ \\boxed{-K(s)S(s)P(s)W_{mi}(s)} $$", "id": "2757074"}, {"introduction": "After learning to structure the uncertainty problem, it's vital to appreciate the implications of your modeling choices. This exercise presents a thought-provoking scenario where additive and multiplicative uncertainty models are used to interpret the same physical modeling error, leading to vastly different robustness conclusions [@problem_id:2757047]. By working through this specific counterexample, you will gain a deeper, more intuitive understanding of why selecting the appropriate uncertainty structure is a critical engineering decision, not just a mathematical formality.", "problem": "Consider the single-input single-output nominal plant $P_{0}(s) = \\dfrac{1}{s^{2} + 0.1\\,s + 1}$, which has lightly damped complex poles, in unity negative feedback with the static controller $K(s) = 2$. Suppose frequency-response testing at the resonance frequency $\\omega_{0} = 1$ rad/s yields a single raw error datum: the additive model error magnitude at this frequency is $|E(\\mathrm{j}\\omega_{0})| = 1$. Using only this datum, define two constant unstructured uncertainty weights that interpolate the same raw error datum at $\\omega_{0}$:\n- The additive weight $W_{a}(s) \\equiv 1$, which satisfies $|W_{a}(\\mathrm{j}\\omega_{0})| = |E(\\mathrm{j}\\omega_{0})|$.\n- The (output) multiplicative weight $W_{m}(s) \\equiv \\rho_{0}$, where $\\rho_{0}$ is the relative error at $\\omega_{0}$ given by $\\rho_{0} = \\dfrac{|E(\\mathrm{j}\\omega_{0})|}{|P_{0}(\\mathrm{j}\\omega_{0})|}$.\n\nUse the small-gain theorem together with the standard sensitivity and complementary sensitivity definitions,\n$$\nS(s) = \\bigl(1 + P_{0}(s)K(s)\\bigr)^{-1}, \n\\qquad\nT(s) = P_{0}(s)K(s)\\,\\bigl(1 + P_{0}(s)K(s)\\bigr)^{-1},\n$$\nto form frequency-by-frequency robust stability certificates:\n- For additive plant uncertainty $P(s) = P_{0}(s) + W_{a}(s)\\Delta_{a}(s)$ with $\\|\\Delta_{a}\\|_{\\infty} \\leq 1$, the sufficient small-gain condition at frequency $\\omega$ is $|W_{a}(\\mathrm{j}\\omega)\\,K(\\mathrm{j}\\omega)\\,S(\\mathrm{j}\\omega)|  1$.\n- For (output) multiplicative plant uncertainty $P(s) = \\bigl(1 + W_{m}(s)\\Delta_{m}(s)\\bigr)P_{0}(s)$ with $\\|\\Delta_{m}\\|_{\\infty} \\leq 1$, the sufficient small-gain condition at frequency $\\omega$ is $|W_{m}(\\mathrm{j}\\omega)\\,T(\\mathrm{j}\\omega)|  1$.\n\nTo obtain a concrete, self-contained counterexample based on the same raw error datum, assess these small-gain inequalities on the frequency set $\\Omega = \\{\\omega_{0}, \\infty\\}$, which captures, for this loop, the peak of $|T|$ at the resonance and the peak of $|K S|$ at high frequency. On this grid, define the largest admissible uniform scaling factors $\\sigma_{a}$ and $\\sigma_{m}$ of the raw error datum such that the respective inequalities hold for all $\\omega \\in \\Omega$:\n- Additive: $\\sigma_{a}\\,|W_{a}(\\mathrm{j}\\omega)\\,K(\\mathrm{j}\\omega)\\,S(\\mathrm{j}\\omega)|  1$ for all $\\omega \\in \\Omega$.\n- Multiplicative: $\\sigma_{m}\\,|W_{m}(\\mathrm{j}\\omega)\\,T(\\mathrm{j}\\omega)|  1$ for all $\\omega \\in \\Omega$.\n\nCompute the exact value of the ratio\n$$\nR \\;=\\; \\frac{\\sigma_{m}}{\\sigma_{a}}.\n$$\nNo rounding is required; provide your answer in exact analytic form without units.", "solution": "The problem as stated is well-posed, internally consistent, and scientifically grounded in the established principles of robust control theory. We may proceed with a direct calculation.\n\nThe nominal plant is given by the transfer function $P_{0}(s) = \\dfrac{1}{s^{2} + 0.1s + 1}$. The controller is a static gain $K(s) = 2$. The analysis is centered on the resonance frequency $\\omega_{0} = 1$ rad/s.\n\nFirst, we evaluate the frequency response of the nominal plant at $s = \\mathrm{j}\\omega_{0} = \\mathrm{j}1$:\n$$\nP_{0}(\\mathrm{j}1) = \\frac{1}{(\\mathrm{j}1)^{2} + 0.1(\\mathrm{j}1) + 1} = \\frac{1}{-1 + 0.1\\mathrm{j} + 1} = \\frac{1}{0.1\\mathrm{j}} = -10\\mathrm{j}\n$$\nThe magnitude is $|P_{0}(\\mathrm{j}1)| = |-10\\mathrm{j}| = 10$.\n\nThe problem states that a single error datum $|E(\\mathrm{j}\\omega_{0})| = 1$ is available at this frequency. This datum is used to define the uncertainty weights.\nThe additive weight is $W_{a}(s) \\equiv 1$, which is consistent with the condition $|W_{a}(\\mathrm{j}\\omega_{0})| = |E(\\mathrm{j}\\omega_{0})|$, as $|1| = 1$.\nThe multiplicative weight is a constant $W_{m}(s) \\equiv \\rho_{0}$, where $\\rho_{0}$ is the relative error at $\\omega_{0}$:\n$$\n\\rho_{0} = \\frac{|E(\\mathrm{j}\\omega_{0})|}{|P_{0}(\\mathrm{j}\\omega_{0})|} = \\frac{1}{10} = 0.1\n$$\nThus, $W_{m}(s) \\equiv 0.1$.\n\nNext, we determine the sensitivity function $S(s)$ and the complementary sensitivity function $T(s)$. The loop transfer function is $L_{0}(s) = P_{0}(s)K(s) = \\dfrac{2}{s^{2} + 0.1s + 1}$.\n$$\nS(s) = \\bigl(1 + L_{0}(s)\\bigr)^{-1} = \\left(1 + \\frac{2}{s^{2} + 0.1s + 1}\\right)^{-1} = \\left(\\frac{s^{2} + 0.1s + 3}{s^{2} + 0.1s + 1}\\right)^{-1} = \\frac{s^{2} + 0.1s + 1}{s^{2} + 0.1s + 3}\n$$\n$$\nT(s) = L_{0}(s)S(s) = \\frac{2}{s^{2} + 0.1s + 1} \\cdot \\frac{s^{2} + 0.1s + 1}{s^{2} + 0.1s + 3} = \\frac{2}{s^{2} + 0.1s + 3}\n$$\nThe robust stability conditions must be assessed on the frequency set $\\Omega = \\{\\omega_{0}, \\infty\\} = \\{1, \\infty\\}$.\n\nFor the additive uncertainty model, the condition is $\\sigma_{a} |W_{a}(\\mathrm{j}\\omega)K(\\mathrm{j}\\omega)S(\\mathrm{j}\\omega)|  1$. With $W_{a}(s) \\equiv 1$ and $K(s) = 2$, this becomes $\\sigma_{a} |2S(\\mathrm{j}\\omega)|  1$. The largest admissible $\\sigma_{a}$ is given by:\n$$\n\\sigma_{a} = \\frac{1}{\\max_{\\omega \\in \\{1, \\infty\\}} |2S(\\mathrm{j}\\omega)|}\n$$\nWe evaluate $|2S(\\mathrm{j}\\omega)|$ at $\\omega=1$ and as $\\omega \\to \\infty$.\nAt $\\omega = 1$:\n$$\n|2S(\\mathrm{j}1)| = \\left|2 \\frac{(\\mathrm{j}1)^{2} + 0.1(\\mathrm{j}1) + 1}{(\\mathrm{j}1)^{2} + 0.1(\\mathrm{j}1) + 3}\\right| = \\left|2 \\frac{-1 + 0.1\\mathrm{j} + 1}{-1 + 0.1\\mathrm{j} + 3}\\right| = \\left|\\frac{0.2\\mathrm{j}}{2 + 0.1\\mathrm{j}}\\right| = \\frac{0.2}{\\sqrt{2^2 + (0.1)^2}} = \\frac{0.2}{\\sqrt{4.01}} = \\frac{2}{\\sqrt{401}}\n$$\nAs $\\omega \\to \\infty$:\n$$\n\\lim_{\\omega \\to \\infty} |2S(\\mathrm{j}\\omega)| = \\lim_{\\omega \\to \\infty} \\left|2 \\frac{-\\omega^2 + 0.1\\mathrm{j}\\omega + 1}{-\\omega^2 + 0.1\\mathrm{j}\\omega + 3}\\right| = \\left|2 \\cdot \\lim_{\\omega \\to \\infty} \\frac{-\\omega^2}{-\\omega^2}\\right| = |2 \\cdot 1| = 2\n$$\nThe maximum value is $\\max\\left\\{\\dfrac{2}{\\sqrt{401}}, 2\\right\\} = 2$. Therefore, $\\sigma_{a} = \\dfrac{1}{2}$.\n\nFor the multiplicative uncertainty model, the condition is $\\sigma_{m} |W_{m}(\\mathrm{j}\\omega)T(\\mathrm{j}\\omega)|  1$. With $W_{m}(s) \\equiv 0.1$, this becomes $\\sigma_{m} |0.1T(\\mathrm{j}\\omega)|  1$. The largest admissible $\\sigma_{m}$ is given by:\n$$\n\\sigma_{m} = \\frac{1}{\\max_{\\omega \\in \\{1, \\infty\\}} |0.1T(\\mathrm{j}\\omega)|}\n$$\nWe evaluate $|0.1T(\\mathrm{j}\\omega)|$ at $\\omega=1$ and as $\\omega \\to \\infty$.\nAt $\\omega = 1$:\n$$\n|0.1T(\\mathrm{j}1)| = \\left|0.1 \\frac{2}{(\\mathrm{j}1)^{2} + 0.1(\\mathrm{j}1) + 3}\\right| = \\left|\\frac{0.2}{-1 + 0.1\\mathrm{j} + 3}\\right| = \\left|\\frac{0.2}{2 + 0.1\\mathrm{j}}\\right| = \\frac{0.2}{\\sqrt{2^2 + (0.1)^2}} = \\frac{0.2}{\\sqrt{4.01}} = \\frac{2}{\\sqrt{401}}\n$$\nAs $\\omega \\to \\infty$:\n$$\n\\lim_{\\omega \\to \\infty} |0.1T(\\mathrm{j}\\omega)| = \\lim_{\\omega \\to \\infty} \\left|0.1 \\frac{2}{-\\omega^2 + 0.1\\mathrm{j}\\omega + 3}\\right| = 0.1 \\cdot \\lim_{\\omega \\to \\infty} \\frac{2}{\\omega^2} = 0\n$$\nThe maximum value is $\\max\\left\\{\\dfrac{2}{\\sqrt{401}}, 0\\right\\} = \\dfrac{2}{\\sqrt{401}}$. Therefore, $\\sigma_{m} = \\dfrac{1}{2/\\sqrt{401}} = \\dfrac{\\sqrt{401}}{2}$.\n\nFinally, we compute the ratio $R$:\n$$\nR = \\frac{\\sigma_{m}}{\\sigma_{a}} = \\frac{\\sqrt{401}/2}{1/2} = \\sqrt{401}\n$$\nThis result demonstrates that, based on the same single raw error measurement, the choice of uncertainty model structure (additive versus multiplicative) leads to substantially different conclusions about the allowable size of uncertainty. Specifically, the multiplicative model suggests a much larger tolerance to an overall scaling of the uncertainty weight.", "answer": "$$\n\\boxed{\\sqrt{401}}\n$$", "id": "2757047"}, {"introduction": "This final practice transitions from analysis to design, which is the ultimate goal of control engineering. You will apply the principles of robust stability by designing a controller using a classical loop-shaping approach to meet both nominal performance and robust stability specifications simultaneously [@problem_id:2757056]. This exercise demonstrates the inherent trade-off between performance, often tracked by the sensitivity function $S$, and robustness, tracked by the weighted complementary sensitivity function $W_m T$, providing hands-on experience in navigating this fundamental challenge.", "problem": "You are given a Single-Input Single-Output (SISO) nominal plant model and an unstructured multiplicative output uncertainty weight, together with performance and robust stability specifications expressed as bounds on the infinity norms of the sensitivity function and the weighted complementary sensitivity function. Your task is to construct a loop-shaping controller of a specified form, compute the closed-loop frequency responses, and verify that the specifications are satisfied. All computations are dimensionless and must be carried out in radians per second. There are no physical units; frequencies are in radians per second, and all magnitudes are dimensionless.\n\nBackground and definitions to be used:\n- Let the nominal plant be denoted by $G(s)$ and the controller by $K(s)$. The open-loop transfer function is $L(s) = G(s)K(s)$.\n- The sensitivity function is $S(s) = \\frac{1}{1 + L(s)}$, and the complementary sensitivity function is $T(s) = \\frac{L(s)}{1 + L(s)}$.\n- The unstructured multiplicative output uncertainty model assumes the actual plant is $G_{\\text{act}}(s) = G(s) \\left(1 + \\Delta_m(s) W_m(s)\\right)$, where $\\Delta_m(s)$ is stable and satisfies $\\|\\Delta_m\\|_\\infty \\leq 1$ and $W_m(s)$ is a stable, known weighting function.\n- The robust stability condition for multiplicative output uncertainty, derived from the Small Gain Theorem (SGT), is $\\|W_m T\\|_\\infty  1$.\n- A nominal performance condition is specified as $\\|S\\|_\\infty \\leq M_S$, where $M_S  0$ is given.\n\nController structure to be used:\n- You must use a loop-shaping controller of the form\n$$\nK(s) = k \\cdot \\frac{1 + s/z_g}{1 + s/p_g} \\cdot \\frac{1}{s} \\cdot \\frac{1}{1 + s/p_f},\n$$\nwith $k  0$, $z_g  0$, $p_g  0$, and $p_f  0$.\n- For a chosen target crossover frequency $\\omega_c  0$, set $z_g = \\omega_c/4$, $p_g = 4 \\omega_c$, and $p_f = 50 \\omega_c$.\n- Choose the gain $k$ to satisfy the unity-gain crossover condition $\\left|L(\\mathrm{j}\\omega_c)\\right| = 1$ exactly, where $L(s) = G(s)K(s)$.\n\nNumerical evaluation requirements:\n- Approximate the infinity norms by computing the maximum magnitude over a logarithmically spaced frequency grid $\\omega \\in [10^{-3}, 10^{3}]$ with at least $N = 2000$ points.\n- For SISO systems, use the absolute value of the complex frequency response to compute magnitudes. That is, for $S(\\mathrm{j}\\omega)$ and $T(\\mathrm{j}\\omega)$, take $|S(\\mathrm{j}\\omega)|$ and $|T(\\mathrm{j}\\omega)|$, and for the weighted complementary sensitivity, compute $|W_m(\\mathrm{j}\\omega) T(\\mathrm{j}\\omega)|$.\n\nPlants, uncertainty weights, and specifications (test suite):\nAll systems are SISO, proper, and stable. Each test case provides a nominal plant, a multiplicative uncertainty weight, a crossover frequency target, and a performance specification $M_S$.\n\n- Test case $1$:\n  - Plant: $G_1(s) = \\dfrac{1}{(0.2 s + 1)(s + 1)}$.\n  - Weight: $W_{m,1}(s) = 0.2 \\cdot \\dfrac{s/3 + 1}{s/30 + 1}$.\n  - Target: $\\omega_{c,1} = 2$.\n  - Performance target: $M_{S,1} = 2.0$.\n\n- Test case $2$:\n  - Plant: $G_2(s) = \\dfrac{3}{(0.5 s + 1)(0.05 s + 1)}$.\n  - Weight: $W_{m,2}(s) = 0.8 \\cdot \\dfrac{s/5 + 1}{s/50 + 1}$.\n  - Target: $\\omega_{c,2} = 5$.\n  - Performance target: $M_{S,2} = 1.5$.\n\n- Test case $3$:\n  - Plant: $G_3(s) = \\dfrac{1}{(0.2 s + 1)(s + 1)}$.\n  - Weight: $W_{m,3}(s) = 1.5 \\cdot \\dfrac{s/3 + 1}{s/30 + 1}$.\n  - Target: $\\omega_{c,3} = 2$.\n  - Performance target: $M_{S,3} = 2.0$.\n\nFor each test case, you must:\n1. Construct $K(s)$ using the specified structure and parameterization, with $z_g = \\omega_c/4$, $p_g = 4\\omega_c$, and $p_f = 50\\omega_c$, and choose $k$ such that $\\left|G(\\mathrm{j}\\omega_c)K(\\mathrm{j}\\omega_c)\\right| = 1$.\n2. Compute $S(\\mathrm{j}\\omega)$, $T(\\mathrm{j}\\omega)$ over the specified frequency grid and evaluate\n   $$\n   \\|S\\|_\\infty \\approx \\max_{\\omega} |S(\\mathrm{j}\\omega)|,\\quad \\|W_m T\\|_\\infty \\approx \\max_{\\omega} |W_m(\\mathrm{j}\\omega) T(\\mathrm{j}\\omega)|.\n   $$\n3. Check the conditions:\n   - Nominal performance: $\\|S\\|_\\infty \\leq M_S$.\n   - Robust stability (multiplicative uncertainty): $\\|W_m T\\|_\\infty  1$.\n\nRequired final output format:\n- For each test case, output a pair of booleans in the order $\\big[\\text{performance\\_ok}, \\text{robust\\_stability\\_ok}\\big]$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no spaces, in the form\n  $$\n  \\big[\\,[b_{1,1},b_{1,2}],[b_{2,1},b_{2,2}],[b_{3,1},b_{3,2}]\\,\\big],\n  $$\n  where each $b_{i,j}$ is either $\\text{True}$ or $\\text{False}$.", "solution": "The problem as stated is valid. It is a well-posed exercise in SISO robust control system design and analysis, grounded in fundamental principles of control theory. All definitions, parameters, and specifications are provided in a clear, consistent, and scientifically sound manner, allowing for a unique and verifiable solution. The methodology will involve designing a controller for each specified case and then numerically verifying its performance against given criteria.\n\nThe core task is to design a controller $K(s)$ for a nominal plant $G(s)$ to satisfy two conditions:\n$1$. Nominal Performance (NP): The infinity norm of the sensitivity function $S(s) = (1+G(s)K(s))^{-1}$ must be bounded. Specifically, $\\|S\\|_\\infty \\le M_S$.\n$2$. Robust Stability (RS): For a plant subject to multiplicative output uncertainty $G_{\\text{act}}(s) = G(s)(1 + \\Delta_m(s)W_m(s))$ with $\\|\\Delta_m\\|_\\infty \\le 1$, the closed-loop system must remain stable for all such uncertainties. The Small Gain Theorem provides the sufficient condition for this: $\\|W_m T\\|_\\infty  1$, where $T(s) = G(s)K(s)(1+G(s)K(s))^{-1}$ is the complementary sensitivity function and $W_m(s)$ is the uncertainty weight.\n\nThe controller has a prescribed structure:\n$$\nK(s) = k \\cdot \\frac{1 + s/z_g}{1 + s/p_g} \\cdot \\frac{1}{s} \\cdot \\frac{1}{1 + s/p_f}\n$$\nThe parameters $z_g$, $p_g$, and $p_f$ are determined by a target crossover frequency $\\omega_c$ as $z_g = \\omega_c/4$, $p_g = 4\\omega_c$, and $p_f = 50\\omega_c$. The gain $k0$ is chosen to enforce the unity-gain crossover condition $|G(\\mathrm{j}\\omega_c)K(\\mathrm{j}\\omega_c)| = 1$.\n\nThe infinity norms are approximated by the maximum magnitude over a discrete frequency grid $\\omega \\in [10^{-3}, 10^3]$ rad/s with $N=2000$ logarithmically spaced points. Let $s = \\mathrm{j}\\omega$.\n\n### Test Case 1\n\n**Givens:**\n- Plant: $G_1(s) = \\dfrac{1}{(0.2 s + 1)(s + 1)}$\n- Weight: $W_{m,1}(s) = 0.2 \\cdot \\dfrac{s/3 + 1}{s/30 + 1}$\n- Target Crossover: $\\omega_{c,1} = 2.0$ rad/s\n- Performance Target: $M_{S,1} = 2.0$\n\n**Controller Design:**\nThe controller parameters are determined from $\\omega_{c,1} = 2.0$:\n- $z_{g,1} = \\omega_{c,1}/4 = 2.0/4 = 0.5$\n- $p_{g,1} = 4\\omega_{c,1} = 4 \\cdot 2.0 = 8.0$\n- $p_{f,1} = 50\\omega_{c,1} = 50 \\cdot 2.0 = 100.0$\n\nThe controller is $K_1(s) = k_1 \\cdot \\frac{1 + s/0.5}{1 + s/8.0} \\cdot \\frac{1}{s} \\cdot \\frac{1}{1 + s/100.0}$.\nThe gain $k_1$ is found from the condition $|G_1(\\mathrm{j}2) K_1(\\mathrm{j}2)| = 1$. Let $K_{1,0}(s) = K_1(s)/k_1$.\nFirst, evaluate the frequency responses of $G_1(s)$ and $K_{1,0}(s)$ at $s = \\mathrm{j}\\omega_{c,1} = 2\\mathrm{j}$.\n$G_1(2\\mathrm{j}) = \\frac{1}{(0.2(2\\mathrm{j}) + 1)(2\\mathrm{j} + 1)} = \\frac{1}{(1 + 0.4\\mathrm{j})(1 + 2\\mathrm{j})} = \\frac{1}{0.2 + 2.4\\mathrm{j}}$.\nThe magnitude is $|G_1(2\\mathrm{j})| = \\frac{1}{\\sqrt{0.2^2 + 2.4^2}} = \\frac{1}{\\sqrt{5.8}} \\approx 0.41499$.\n$K_{1,0}(2\\mathrm{j}) = \\frac{1 + 2\\mathrm{j}/0.5}{1 + 2\\mathrm{j}/8.0} \\cdot \\frac{1}{2\\mathrm{j}} \\cdot \\frac{1}{1 + 2\\mathrm{j}/100.0} = \\frac{1 + 4\\mathrm{j}}{1 + 0.25\\mathrm{j}} \\cdot \\frac{1}{2\\mathrm{j}} \\cdot \\frac{1}{1 + 0.02\\mathrm{j}}$.\nThe magnitude is $|K_{1,0}(2\\mathrm{j})| = \\frac{\\sqrt{1^2+4^2}}{\\sqrt{1^2+0.25^2}} \\cdot \\frac{1}{2} \\cdot \\frac{1}{\\sqrt{1^2+0.02^2}} = \\frac{\\sqrt{17}}{\\sqrt{1.0625}} \\cdot 0.5 \\cdot \\frac{1}{\\sqrt{1.0004}} \\approx 1.99950$.\nThe gain $k_1$ is calculated as $k_1 = \\frac{1}{|G_1(2\\mathrm{j})| |K_{1,0}(2\\mathrm{j})|} = \\frac{1}{0.41499 \\cdot 1.99950} \\approx \\frac{1}{0.82977} \\approx 1.20516$.\n\n**Analysis  Verification:**\nUsing the designed controller $K_1(s)$ with $k_1 \\approx 1.20516$, we form the open-loop transfer function $L_1(s) = G_1(s)K_1(s)$ and numerically evaluate the norms.\n- $\\|S_1\\|_\\infty \\approx \\max_{\\omega}|(1+L_1(\\mathrm{j}\\omega))^{-1}| \\approx 1.488$.\n- $\\|W_{m,1}T_1\\|_\\infty \\approx \\max_{\\omega}|W_{m,1}(\\mathrm{j}\\omega)L_1(\\mathrm{j}\\omega)(1+L_1(\\mathrm{j}\\omega))^{-1}| \\approx 0.584$.\n\n**Conclusion for Test Case 1:**\n- Nominal Performance: Is $\\|S_1\\|_\\infty \\leq M_{S,1}$? $1.488 \\leq 2.0$. This is true.\n- Robust Stability: Is $\\|W_{m,1}T_1\\|_\\infty  1$? $0.584  1$. This is true.\nThe boolean result is $[\\text{True}, \\text{True}]$.\n\n### Test Case 2\n\n**Givens:**\n- Plant: $G_2(s) = \\dfrac{3}{(0.5 s + 1)(0.05 s + 1)}$\n- Weight: $W_{m,2}(s) = 0.8 \\cdot \\dfrac{s/5 + 1}{s/50 + 1}$\n- Target Crossover: $\\omega_{c,2} = 5.0$ rad/s\n- Performance Target: $M_{S,2} = 1.5$\n\n**Controller Design:**\nThe controller parameters are determined from $\\omega_{c,2} = 5.0$:\n- $z_{g,2} = \\omega_{c,2}/4 = 5.0/4 = 1.25$\n- $p_{g,2} = 4\\omega_{c,2} = 4 \\cdot 5.0 = 20.0$\n- $p_{f,2} = 50\\omega_{c,2} = 50 \\cdot 5.0 = 250.0$\nThe controller is $K_2(s) = k_2 \\cdot \\frac{1 + s/1.25}{1 + s/20.0} \\cdot \\frac{1}{s} \\cdot \\frac{1}{1 + s/250.0}$.\nThe gain $k_2$ is found from the condition $|G_2(\\mathrm{j}5) K_2(\\mathrm{j}5)| = 1$. Let $K_{2,0}(s) = K_2(s)/k_2$.\nAt $s = \\mathrm{j}\\omega_{c,2} = 5\\mathrm{j}$:\n$G_2(5\\mathrm{j}) = \\frac{3}{(0.5(5\\mathrm{j}) + 1)(0.05(5\\mathrm{j}) + 1)} = \\frac{3}{(1 + 2.5\\mathrm{j})(1 + 0.25\\mathrm{j})} = \\frac{3}{0.375 + 2.75\\mathrm{j}}$.\nThe magnitude is $|G_2(5\\mathrm{j})| = \\frac{3}{\\sqrt{0.375^2 + 2.75^2}} = \\frac{3}{\\sqrt{7.703125}} \\approx 1.08093$.\nThe structure of $K_0(s)$ at crossover is universal for this design method. At $s = \\mathrm{j}\\omega_c$, $|K_0(\\mathrm{j}\\omega_c)| \\approx 2/\\omega_c$. So, for $\\omega_c = 5$:\n$|K_{2,0}(5\\mathrm{j})| \\approx 2/5 = 0.4$. More precisely: $|K_{2,0}(5\\mathrm{j})| = \\frac{\\sqrt{17}}{\\sqrt{1.0625}} \\cdot \\frac{1}{5} \\cdot \\frac{1}{\\sqrt{1.0004}} \\approx 0.79980$.\nThe gain $k_2$ is calculated as $k_2 = \\frac{1}{|G_2(5\\mathrm{j})| |K_{2,0}(5\\mathrm{j})|} = \\frac{1}{1.08093 \\cdot 0.79980} \\approx \\frac{1}{0.86453} \\approx 1.15671$.\n\n**Analysis  Verification:**\nUsing the designed controller $K_2(s)$ with $k_2 \\approx 1.15671$:\n- $\\|S_2\\|_\\infty \\approx \\max_{\\omega}|(1+L_2(\\mathrm{j}\\omega))^{-1}| \\approx 1.579$.\n- $\\|W_{m,2}T_2\\|_\\infty \\approx \\max_{\\omega}|W_{m,2}(\\mathrm{j}\\omega)L_2(\\mathrm{j}\\omega)(1+L_2(\\mathrm{j}\\omega))^{-1}| \\approx 1.259$.\n\n**Conclusion for Test Case 2:**\n- Nominal Performance: Is $\\|S_2\\|_\\infty \\leq M_{S,2}$? $1.579 \\leq 1.5$. This is false.\n- Robust Stability: Is $\\|W_{m,2}T_2\\|_\\infty  1$? $1.259  1$. This is false.\nThe boolean result is $[\\text{False}, \\text{False}]$.\n\n### Test Case 3\n\n**Givens:**\n- Plant: $G_3(s) = \\dfrac{1}{(0.2 s + 1)(s + 1)}$\n- Weight: $W_{m,3}(s) = 1.5 \\cdot \\dfrac{s/3 + 1}{s/30 + 1}$\n- Target Crossover: $\\omega_{c,3} = 2.0$ rad/s\n- Performance Target: $M_{S,3} = 2.0$\n\n**Controller Design:**\nThe plant $G_3(s)$, crossover frequency $\\omega_{c,3}$, and performance target $M_{S,3}$ are identical to Test Case 1. Therefore, the designed controller $K_3(s)$ is identical to $K_1(s)$, the open-loop $L_3(s)$ is identical to $L_1(s)$, and the sensitivity function $S_3(s)$ is identical to $S_1(s)$.\n$K_3(s) = K_1(s)$ with $k_3 = k_1 \\approx 1.20516$.\n\n**Analysis  Verification:**\n- Since $S_3(s) = S_1(s)$, we have $\\|S_3\\|_\\infty = \\|S_1\\|_\\infty \\approx 1.488$.\n- The uncertainty weight is different: $W_{m,3}(s) = 1.5 \\cdot \\frac{s/3+1}{s/30+1}$. Note that $W_{m,3}(s) = \\frac{1.5}{0.2} W_{m,1}(s) = 7.5 \\cdot W_{m,1}(s)$.\n- The weighted complementary sensitivity check is for $\\|W_{m,3} T_3\\|_\\infty$. Since $T_3(s) = T_1(s)$, the norm is $\\|W_{m,3} T_3\\|_\\infty = \\|7.5 \\cdot W_{m,1} T_1\\|_\\infty = 7.5 \\cdot \\|W_{m,1} T_1\\|_\\infty$.\n- Using the result from Case 1, $\\|W_{m,3}T_3\\|_\\infty \\approx 7.5 \\cdot 0.584 = 4.38$.\n\n**Conclusion for Test Case 3:**\n- Nominal Performance: Is $\\|S_3\\|_\\infty \\leq M_{S,3}$? $1.488 \\leq 2.0$. This is true.\n- Robust Stability: Is $\\|W_{m,3}T_3\\|_\\infty  1$? $4.38  1$. This is false.\nThe boolean result is $[\\text{True}, \\text{False}]$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the control design and verification problem for three test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"G_func\": lambda s: 1.0 / ((0.2 * s + 1.0) * (s + 1.0)),\n            \"Wm_func\": lambda s: 0.2 * (s / 3.0 + 1.0) / (s / 30.0 + 1.0),\n            \"omega_c\": 2.0,\n            \"M_S\": 2.0,\n        },\n        {\n            \"G_func\": lambda s: 3.0 / ((0.5 * s + 1.0) * (0.05 * s + 1.0)),\n            \"Wm_func\": lambda s: 0.8 * (s / 5.0 + 1.0) / (s / 50.0 + 1.0),\n            \"omega_c\": 5.0,\n            \"M_S\": 1.5,\n        },\n        {\n            \"G_func\": lambda s: 1.0 / ((0.2 * s + 1.0) * (s + 1.0)),\n            \"Wm_func\": lambda s: 1.5 * (s / 3.0 + 1.0) / (s / 30.0 + 1.0),\n            \"omega_c\": 2.0,\n            \"M_S\": 2.0,\n        },\n    ]\n\n    # Frequency grid for numerical evaluation of infinity norms\n    omega = np.logspace(-3, 3, 2000)\n    s = 1j * omega\n\n    results = []\n    for case in test_cases:\n        G_func = case[\"G_func\"]\n        Wm_func = case[\"Wm_func\"]\n        omega_c = case[\"omega_c\"]\n        M_S = case[\"M_S\"]\n\n        # 1. Construct the controller K(s)\n        # Controller parameters based on target crossover frequency\n        z_g = omega_c / 4.0\n        p_g = 4.0 * omega_c\n        p_f = 50.0 * omega_c\n\n        # Function for the controller without the gain k\n        K0_func = lambda s_val: ((1.0 + s_val / z_g) / (1.0 + s_val / p_g)) * \\\n                                (1.0 / s_val) * \\\n                                (1.0 / (1.0 + s_val / p_f))\n\n        # Calculate gain k to satisfy |L(j*omega_c)| = 1\n        s_c = 1j * omega_c\n        G_at_omega_c = G_func(s_c)\n        K0_at_omega_c = K0_func(s_c)\n        \n        # Ensure the magnitude is not zero to avoid division by zero\n        L0_mag_at_omega_c = np.abs(G_at_omega_c * K0_at_omega_c)\n        if L0_mag_at_omega_c  1e-9:\n             # This case should not happen for the given problems\n             k = 0.0\n        else:\n             k = 1.0 / L0_mag_at_omega_c\n\n        # Full controller function\n        K_func = lambda s_val: k * K0_func(s_val)\n\n        # 2. Compute frequency responses and evaluate norms\n        # Evaluate transfer functions over the frequency grid\n        G_s = G_func(s)\n        K_s = K_func(s)\n        L_s = G_s * K_s\n        Wm_s = Wm_func(s)\n\n        # Sensitivity and Complementary Sensitivity functions\n        S_s = 1.0 / (1.0 + L_s)\n        T_s = L_s / (1.0 + L_s)\n\n        # Approximate infinity norms\n        S_inf_norm = np.max(np.abs(S_s))\n        WmT_inf_norm = np.max(np.abs(Wm_s * T_s))\n\n        # 3. Check the conditions\n        performance_ok = S_inf_norm = M_S\n        robust_stability_ok = WmT_inf_norm  1.0\n        \n        # Format the result string for the current case as [Bool,Bool]\n        # str() on a bool produces 'True' or 'False'\n        results.append(f\"[{str(performance_ok)},{str(robust_stability_ok)}]\")\n\n    # Final print statement in the exact required format: [[b1,b2],[b3,b4],...]\n    print(f\"[[{','.join(results)}]]\")\n\nsolve()\n```", "id": "2757056"}]}