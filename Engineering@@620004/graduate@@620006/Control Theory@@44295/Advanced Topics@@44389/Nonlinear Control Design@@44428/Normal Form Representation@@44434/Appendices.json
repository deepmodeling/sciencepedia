{"hands_on_practices": [{"introduction": "A transfer function provides an external, input-output description of a system, but it may not tell the whole story. This practice explores the crucial concept of \"hidden modes,\" where internal system dynamics are masked by pole-zero cancellations in the transfer function. By constructing a state-space model in controllable canonical form, you will gain hands-on experience in how an internal representation can reveal fundamental properties like unobservability that are invisible from a purely external perspective [@problem_id:1573658].", "problem": "Consider a linear time-invariant (LTI) system described by the transfer function:\n$$G(s) = \\frac{Y(s)}{U(s)} = \\frac{s + a}{s^2 + (a+b)s + ab}$$\nwhere $Y(s)$ is the Laplace transform of the output signal $y(t)$, $U(s)$ is the Laplace transform of the input signal $u(t)$, and $a$ and $b$ are distinct positive real constants.\n\nFirst, determine the controllable canonical form of the state-space representation for this system. The state-space representation is defined by the equations $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B u(t)$ and $y(t) = C\\mathbf{x}(t) + D u(t)$.\n\nBased on this state-space representation, which of the following statements correctly describes the properties of the system?\n\nA. The system is controllable and observable.\n\nB. The system is controllable but unobservable.\n\nC. The system is uncontrollable but observable.\n\nD. The system is uncontrollable and unobservable.", "solution": "We are given the transfer function\n$$G(s) = \\frac{s + a}{s^{2} + (a + b)s + ab} = \\frac{s + a}{s^{2} + a_{1}s + a_{0}},$$\nwith $a_{1} = a + b$ and $a_{0} = ab$, and $a, b$ distinct positive constants. For the controllable canonical form of order two, choose\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -a_{0} & -a_{1} \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -ab & -(a + b) \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad D = 0,$$\nand let $C = \\begin{pmatrix} c_{1} & c_{2} \\end{pmatrix}$ be determined by matching the transfer function.\n\nCompute\n$$sI - A = \\begin{pmatrix} s & -1 \\\\ a_{0} & s + a_{1} \\end{pmatrix}, \\quad (sI - A)^{-1} = \\frac{1}{s^{2} + a_{1}s + a_{0}} \\begin{pmatrix} s + a_{1} & 1 \\\\ -a_{0} & s \\end{pmatrix}.$$\nThus\n$$(sI - A)^{-1}B = \\frac{1}{s^{2} + a_{1}s + a_{0}} \\begin{pmatrix} 1 \\\\ s \\end{pmatrix},$$\nand the transfer function is\n$$G(s) = C(sI - A)^{-1}B + D = \\frac{c_{2}s + c_{1}}{s^{2} + a_{1}s + a_{0}}.$$\nMatching to $G(s) = \\dfrac{s + a}{s^{2} + a_{1}s + a_{0}}$ yields $c_{2} = 1$ and $c_{1} = a$, so\n$$C = \\begin{pmatrix} a & 1 \\end{pmatrix}, \\quad D = 0.$$\n\nTherefore, a controllable canonical state-space realization is\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -ab & -(a + b) \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} a & 1 \\end{pmatrix}, \\quad D = 0.$$\n\nControllability: The controllability matrix is\n$$\\mathcal{C} = \\begin{pmatrix} B & AB \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 1 & -(a + b) \\end{pmatrix},$$\nwith determinant $\\det(\\mathcal{C}) = -1 \\neq 0$, hence the system is controllable.\n\nObservability: The observability matrix is\n$$\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix} = \\begin{pmatrix} a & 1 \\\\ -ab & -b \\end{pmatrix},$$\nwhose determinant is\n$$\\det(\\mathcal{O}) = a(-b) - 1(-ab) = -ab + ab = 0,$$\nso the system is unobservable. This unobservability is consistent with the pole-zero cancellation $G(s) = \\dfrac{s + a}{(s + a)(s + b)} = \\dfrac{1}{s + b}$, which removes the mode at $s = -a$ from the input-output map.\n\nHence, the correct statement is that the system is controllable but unobservable.", "answer": "$$\\boxed{B}$$", "id": "1573658"}, {"introduction": "While the previous exercise demonstrated why state-space representations are vital, this practice focuses on the constructive procedure of obtaining one from a given transfer function. You will derive a minimal state-space realization in the controllable companion form, a canonical structure that provides a direct and systematic mapping from the coefficients of the transfer function to the state-space matrices ($A$, $B$, $C$). This exercise reinforces the connection between the external model and a corresponding internal model, and provides practice in verifying the essential system properties of minimality and controllability [@problem_id:2728128].", "problem": "Consider the Single-Input Single-Output (SISO) transfer function $G(s)=\\dfrac{s^{2}+2s+3}{s^{3}+4s^{2}+5s+6}$. Use only the definition of a transfer function from a state-space realization, namely $G(s)=C\\,(sI-A)^{-1}B+D$, together with standard properties of companion (canonical) forms, to complete the following:\n\n- Construct a minimal realization of $G(s)$ in controllable companion (controller canonical) form. Your construction must be justified from first principles, starting from the definition of $G(s)$ in terms of $(A,B,C,D)$ and the structure of the controllable companion form.\n- Justify minimality by showing that there are no pole-zero cancellations, starting from the fundamental polynomial greatest common divisor definition (for example, by applying the Euclidean algorithm to the numerator and denominator).\n- Verify controllability using the Kalman rank condition by explicitly forming the controllability matrix and evaluating its rank.\n\nReport as your final answer the rank of the controllability matrix as a single integer. No rounding is required and no physical units apply.", "solution": "The problem requires a three-part analysis of the Single-Input Single-Output (SISO) transfer function $G(s)=\\dfrac{s^{2}+2s+3}{s^{3}+4s^{2}+5s+6}$.\n\nFirst, we construct the controllable companion form (also known as the controller canonical form) from first principles.\n\nLet the numerator polynomial be $N(s) = b_2 s^{2} + b_1 s + b_0 = s^2+2s+3$ and the denominator polynomial be $D(s) = s^3+a_2 s^2+a_1 s+a_0 = s^{3}+4s^{2}+5s+6$. The order of the system is $n=3$.\nThe relationship between the Laplace transforms of the input, $U(s)$, and the output, $Y(s)$, is given by $Y(s)=G(s)U(s)$.\nWe can write this as $D(s)Y(s) = N(s)U(s)$. This form is difficult to work with directly. Instead, we introduce an auxiliary variable $Z(s)$ such that:\n$$U(s) = D(s)Z(s)$$\n$$Y(s) = N(s)Z(s)$$\nSubstituting the polynomials, we have:\n$$(s^3+4s^2+5s+6)Z(s) = U(s)$$\n$$(s^2+2s+3)Z(s) = Y(s)$$\nWe can convert the first equation into a time-domain ordinary differential equation, where $z(t)$ is the inverse Laplace transform of $Z(s)$:\n$$\\frac{d^3z}{dt^3} + 4\\frac{d^2z}{dt^2} + 5\\frac{dz}{dt} + 6z(t) = u(t)$$\nTo establish a state-space model, we define the state variables $x_1$, $x_2$, and $x_3$ as follows, which is characteristic for the controllable companion form:\n$$x_1 = z(t)$$\n$$x_2 = \\dot{x}_1 = \\frac{dz}{dt}$$\n$$x_3 = \\dot{x}_2 = \\frac{d^2z}{dt^2}$$\nFrom these definitions, we obtain the first two state equations:\n$$\\dot{x}_1 = x_2$$\n$$\\dot{x}_2 = x_3$$\nThe third state equation is derived by rearranging the differential equation for $z(t)$:\n$$\\dot{x}_3 = \\frac{d^3z}{dt^3} = -6z - 5\\frac{dz}{dt} - 4\\frac{d^2z}{dt^2} + u(t)$$\nSubstituting the state variables, we get:\n$$\\dot{x}_3 = -6x_1 - 5x_2 - 4x_3 + u(t)$$\nThese three equations can be written in matrix form, $\\dot{\\mathbf{x}} = A\\mathbf{x} + B u$:\n$$ \\begin{pmatrix} \\dot{x}_1 \\\\ \\dot{x}_2 \\\\ \\dot{x}_3 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -6 & -5 & -4 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} u(t) $$\nThis gives the state matrix $A$ and the input matrix $B$:\n$$A = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -6 & -5 & -4 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$$\nNext, we derive the output equation $y = C\\mathbf{x} + Du$. From $Y(s) = (s^2+2s+3)Z(s)$, we find the time-domain output $y(t)$:\n$$y(t) = \\frac{d^2z}{dt^2} + 2\\frac{dz}{dt} + 3z(t)$$\nSubstituting the state variables:\n$$y(t) = x_3 + 2x_2 + 3x_1$$\nThis gives the output matrix $C$ in the equation $y = C\\mathbf{x}$:\n$$C = \\begin{pmatrix} 3 & 2 & 1 \\end{pmatrix}$$\nSince the degree of the numerator $N(s)$ is less than the degree of the denominator $D(s)$ (i.e., the transfer function is strictly proper), the direct feedthrough term $D$ is zero. Thus, the controllable companion form realization is $(A, B, C, D)$ with $A$, $B$, $C$ as derived and $D=0$.\n\nSecond, we must justify that this realization is minimal. A realization is minimal if and only if it is both controllable and observable. This is equivalent to the condition that there are no pole-zero cancellations in the transfer function $G(s)$, which means the polynomials $N(s)$ and $D(s)$ are coprime. We use the Euclidean algorithm to find the greatest common divisor (GCD) of $N(s)=s^2+2s+3$ and $D(s)=s^3+4s^2+5s+6$.\nWe perform polynomial division of $D(s)$ by $N(s)$:\n$$ (s^3+4s^2+5s+6) = (s+2)(s^2+2s+3) + (-2s) $$\nThe remainder is $R_1(s) = -2s$.\nNext, we divide the previous divisor, $N(s)$, by the remainder, $R_1(s)$:\n$$ (s^2+2s+3) = \\left(-\\frac{1}{2}s - 1\\right)(-2s) + 3 $$\nThe remainder is $R_2(s) = 3$.\nSince the last non-zero remainder, $3$, is a constant, the greatest common divisor of $N(s)$ and $D(s)$ is a constant. Therefore, the polynomials are coprime. This lack of common factors implies there are no pole-zero cancellations, and thus any $3$-dimensional realization, including the one we have constructed, must be minimal. A property of the controller canonical form is that it is always controllable. The coprimeness of $N(s)$ and $D(s)$ ensures it is also observable, hence minimal.\n\nThird, we verify the controllability of the constructed realization $(A, B)$ using the Kalman rank condition. The system is controllable if and only if the controllability matrix $\\mathcal{C}$ has full rank, which for a system of order $n=3$ means $\\text{rank}(\\mathcal{C}) = 3$.\nThe controllability matrix is defined as $\\mathcal{C} = \\begin{pmatrix} B & AB & A^2B \\end{pmatrix}$.\nWe have $B$ and $A$:\n$$ B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad A = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -6 & -5 & -4 \\end{pmatrix} $$\nWe compute the necessary matrix products:\n$$ AB = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -6 & -5 & -4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ -4 \\end{pmatrix} $$\n$$ A^2B = A(AB) = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -6 & -5 & -4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ -4 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -4 \\\\ -5 + 16 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -4 \\\\ 11 \\end{pmatrix} $$\nNow we construct the controllability matrix $\\mathcal{C}$:\n$$ \\mathcal{C} = \\begin{pmatrix} 0 & 0 & 1 \\\\ 0 & 1 & -4 \\\\ 1 & -4 & 11 \\end{pmatrix} $$\nTo find the rank, we can compute the determinant of $\\mathcal{C}$. A non-zero determinant implies the matrix has full rank.\n$$ \\det(\\mathcal{C}) = 0 \\cdot \\det\\begin{pmatrix} 1 & -4 \\\\ -4 & 11 \\end{pmatrix} - 0 \\cdot \\det\\begin{pmatrix} 0 & -4 \\\\ 1 & 11 \\end{pmatrix} + 1 \\cdot \\det\\begin{pmatrix} 0 & 1 \\\\ 1 & -4 \\end{pmatrix} $$\n$$ \\det(\\mathcal{C}) = 1 \\cdot (0 \\cdot (-4) - 1 \\cdot 1) = -1 $$\nSince $\\det(\\mathcal{C}) = -1 \\neq 0$, the matrix $\\mathcal{C}$ is nonsingular and thus has full rank.\nThe rank of the controllability matrix is $3$, which is equal to the order of the system. This confirms that the system is controllable, as expected for a canonical form that is correctly constructed. The final answer required is the rank of this matrix.\nThe rank is $3$.", "answer": "$$\\boxed{3}$$", "id": "2728128"}, {"introduction": "Beyond companion forms tied to transfer functions, the Jordan Normal Form reveals the deepest structural properties of a system's dynamics, especially for systems that are not diagonalizable. This exercise shifts the focus to this fundamental modal representation, guiding you to connect the algebraic structure of Jordan blocks and chains of generalized eigenvectors directly to the physical property of state controllability. By analyzing a system already in Jordan form, you will develop a profound intuition for how the system's internal structure dictates its ability to be controlled from a single input [@problem_id:2728068].", "problem": "Consider the linear time-invariant state matrix\n$$\nA=\\begin{bmatrix}\n4 & 1 & 0\\\\\n0 & 4 & 1\\\\\n0 & 0 & 4\n\\end{bmatrix}.\n$$\nStarting from the definitions of eigenvalues, eigenvectors, and generalized eigenvectors, determine the Jordan canonical form (JCF) of $A$ and construct an ordered Jordan chain of generalized eigenvectors for its unique eigenvalue. Explain why, in a single-input setting $\\dot{x}=Ax+bu$, the ability to reach all states depends on the component of the input vector $b$ along the last vector in the Jordan chain in JCF coordinates, and connect this to the rank condition for controllability.\n\nThen, for the specific choice $b=\\begin{bmatrix}0\\\\0\\\\1\\end{bmatrix}$ expressed in the standard basis, compute the determinant of the controllability matrix associated with $(A,b)$ and report this determinant as your final answer. No rounding is required, and no units apply.", "solution": "We begin by analyzing the state matrix $A=\\begin{bmatrix} 4 & 1 & 0\\\\ 0 & 4 & 1\\\\ 0 & 0 & 4 \\end{bmatrix}$.\n\nFirst, we determine the eigenvalues by solving the characteristic equation $\\det(A - \\lambda I) = 0$.\n$$\n\\det\\left(\\begin{bmatrix} 4 & 1 & 0\\\\ 0 & 4 & 1\\\\ 0 & 0 & 4 \\end{bmatrix} - \\begin{bmatrix} \\lambda & 0 & 0\\\\ 0 & \\lambda & 0\\\\ 0 & 0 & \\lambda \\end{bmatrix}\\right) = \\det\\begin{bmatrix} 4 - \\lambda & 1 & 0\\\\ 0 & 4 - \\lambda & 1\\\\ 0 & 0 & 4 - \\lambda \\end{bmatrix} = (4-\\lambda)^3 = 0\n$$\nThis reveals a single eigenvalue, $\\lambda = 4$, with an algebraic multiplicity of $m_a = 3$.\n\nNext, we find the eigenvectors associated with $\\lambda = 4$ by finding the null space of $(A - 4I)$.\n$$ A - 4I = \\begin{bmatrix} 0 & 1 & 0\\\\ 0 & 0 & 1\\\\ 0 & 0 & 0 \\end{bmatrix} $$\nLet an eigenvector be $v = \\begin{bmatrix} x \\\\ y \\\\ z \\end{bmatrix}$. The condition $(A - 4I)v = 0$ implies $y = 0$ and $z = 0$. The eigenvectors are of the form $v = c \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$ for any non-zero scalar $c$. The null space, or eigenspace, is one-dimensional. The geometric multiplicity is $m_g = \\dim(\\ker(A-4I))=1$. Since $m_g = 1 < m_a = 3$, the matrix $A$ is not diagonalizable. It possesses a single Jordan block of size $3$. The Jordan Canonical Form (JCF) must be:\n$$ J = \\begin{bmatrix} 4 & 1 & 0\\\\ 0 & 4 & 1\\\\ 0 & 0 & 4 \\end{bmatrix} $$\nThus, the matrix $A$ is already in its Jordan canonical form, so $J=A$.\n\nTo construct a Jordan chain of generalized eigenvectors $\\{v_1, v_2, v_3\\}$, we seek vectors satisfying:\n$1. \\ (A-4I)v_1 = 0$ ($v_1$ is a standard eigenvector).\n$2. \\ (A-4I)v_2 = v_1$ ($v_2$ is a generalized eigenvector of rank $2$).\n$3. \\ (A-4I)v_3 = v_2$ ($v_3$ is a generalized eigenvector of rank $3$).\nThis chain is typically constructed \"backwards,\" starting from $v_3$. We must find a vector $v_3$ such that $(A-4I)^2 v_3 \\neq 0$ but $(A-4I)^3 v_3 = 0$.\nFirst, we compute the powers of $(A-4I)$:\n$$ (A-4I)^2 = \\begin{bmatrix} 0 & 1 & 0\\\\ 0 & 0 & 1\\\\ 0 & 0 & 0 \\end{bmatrix} \\begin{bmatrix} 0 & 1 & 0\\\\ 0 & 0 & 1\\\\ 0 & 0 & 0 \\end{bmatrix} = \\begin{bmatrix} 0 & 0 & 1\\\\ 0 & 0 & 0\\\\ 0 & 0 & 0 \\end{bmatrix} $$\n$$ (A-4I)^3 = (A-4I)^2 (A-4I) = \\begin{bmatrix} 0 & 0 & 1\\\\ 0 & 0 & 0\\\\ 0 & 0 & 0 \\end{bmatrix} \\begin{bmatrix} 0 & 1 & 0\\\\ 0 & 0 & 1\\\\ 0 & 0 & 0 \\end{bmatrix} = \\begin{bmatrix} 0 & 0 & 0\\\\ 0 & 0 & 0\\\\ 0 & 0 & 0 \\end{bmatrix} $$\nThe condition $(A-4I)^3 v_3 = 0$ holds for any $v_3 \\in \\mathbb{R}^3$. The condition $(A-4I)^2 v_3 \\neq 0$ means that the third component of $v_3$ must be non-zero. Let us choose the simplest such vector, $v_3 = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$. This vector is the \"tail\" of the chain, also called the last generalized eigenvector.\nNow, we generate the rest of the chain:\n$$ v_2 = (A-4I)v_3 = \\begin{bmatrix} 0 & 1 & 0\\\\ 0 & 0 & 1\\\\ 0 & 0 & 0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix} $$\n$$ v_1 = (A-4I)v_2 = \\begin{bmatrix} 0 & 1 & 0\\\\ 0 & 0 & 1\\\\ 0 & 0 & 0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix} $$\nThe vector $v_1$ is the standard eigenvector, the \"head\" of the chain. The ordered Jordan chain is $\\{v_1, v_2, v_3\\} = \\left\\{ \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix}, \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix} \\right\\}$. These are the standard basis vectors.\n\nNow, we explain the connection to controllability. Consider the system $\\dot{x} = Ax+bu$. We perform a change of coordinates $x=Pz$, where the columns of $P$ are the vectors of the Jordan chain, $P=[v_1, v_2, v_3]$. In these new coordinates $z$, the system dynamics are $\\dot{z} = Jz + \\hat{b}$, where $J=P^{-1}AP$ is the JCF and $\\hat{b}=P^{-1}b$ is the input vector in the Jordan basis. The components of $z$, denoted $z_i$, are the coordinates of the state along the generalized eigenvectors $v_i$.\nFor a single Jordan block of size $3$, the equations are:\n$$ \\dot{z}_1 = \\lambda z_1 + z_2 + \\hat{b}_1 u $$\n$$ \\dot{z}_2 = \\lambda z_2 + z_3 + \\hat{b}_2 u $$\n$$ \\dot{z}_3 = \\lambda z_3 + \\hat{b}_3 u $$\nHere, $\\lambda=4$. Observe the cascaded structure. The input $u$ directly influences the dynamics of $z_3$ only if $\\hat{b}_3 \\neq 0$. If $\\hat{b}_3 = 0$, the equation for $z_3$ becomes $\\dot{z}_3 = \\lambda z_3$, whose solution is decoupled from the input $u$. The state $z_3$ is uncontrollable. Because $z_3$ acts as an internal, uncontrollable input to the dynamics of $z_2$, the state $z_2$ also becomes uncontrollable. This effect propagates up the chain to $z_1$. Therefore, to control the entire state vector $z$, and thus $x$, it is necessary that the input can influence the \"end\" of the chain, which requires $\\hat{b}_3 \\neq 0$. The term $\\hat{b}_3$ is the component of the input vector $b$ corresponding to the last vector in the Jordan chain, $v_3$.\n\nThe Kalman rank condition states that the pair $(A,b)$ is controllable if and only if the controllability matrix $\\mathcal{C} = [b \\ | \\ Ab \\ | \\dots \\ | \\ A^{n-1}b]$ has full rank, i.e., $\\text{rank}(\\mathcal{C})=n$. As shown through the coordinate transformation $x=Pz$, we have $\\mathcal{C} = P\\hat{\\mathcal{C}}$, where $\\hat{\\mathcal{C}} = [\\hat{b} \\ | \\ J\\hat{b} \\ | \\dots \\ | \\ J^{n-1}\\hat{b}]$. Since $P$ is invertible, $\\text{rank}(\\mathcal{C})=\\text{rank}(\\hat{\\mathcal{C}})$. If $\\hat{b}_3 = 0$, the last row of $\\hat{\\mathcal{C}}$ can be shown to be entirely zero, making the matrix rank-deficient. Thus, the condition $\\hat{b}_3 \\neq 0$ is equivalent to the Kalman rank condition.\n\nFinally, we compute the determinant of the controllability matrix for the given $A$ and $b=\\begin{bmatrix}0\\\\0\\\\1\\end{bmatrix}$. The controllability matrix is $\\mathcal{C} = [b \\ | \\ Ab \\ | \\ A^2b]$.\nWe calculate the columns:\n$b = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$\n$Ab = \\begin{bmatrix} 4 & 1 & 0\\\\ 0 & 4 & 1\\\\ 0 & 0 & 4 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\\\ 4 \\end{bmatrix}$\n$A^2b = A(Ab) = \\begin{bmatrix} 4 & 1 & 0\\\\ 0 & 4 & 1\\\\ 0 & 0 & 4 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\\\ 4 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 4+4 \\\\ 16 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 8 \\\\ 16 \\end{bmatrix}$\n\nThe controllability matrix is:\n$$ \\mathcal{C} = \\begin{bmatrix} 0 & 0 & 1 \\\\ 0 & 1 & 8 \\\\ 1 & 4 & 16 \\end{bmatrix} $$\nWe compute its determinant by cofactor expansion along the first row:\n$$ \\det(\\mathcal{C}) = 0 \\cdot \\det\\begin{pmatrix} 1 & 8 \\\\ 4 & 16 \\end{pmatrix} - 0 \\cdot \\det\\begin{pmatrix} 0 & 8 \\\\ 1 & 16 \\end{pmatrix} + 1 \\cdot \\det\\begin{pmatrix} 0 & 1 \\\\ 1 & 4 \\end{pmatrix} $$\n$$ \\det(\\mathcal{C}) = 1 \\cdot (0 \\cdot 4 - 1 \\cdot 1) = -1 $$\nThe determinant is non-zero, confirming that the system is controllable, consistent with our earlier reasoning since for this choice of basis ($P=I$), we have $\\hat{b}=b$ and $\\hat{b}_3=1 \\neq 0$.", "answer": "$$\\boxed{-1}$$", "id": "2728068"}]}