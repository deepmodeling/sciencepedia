{"hands_on_practices": [{"introduction": "The cornerstone of the port-Hamiltonian approach is its explicit, physically meaningful structure rooted in energy. This first practice invites you to explore the fundamental power balance in a nonlinear system by deriving how the total energy, represented by the Hamiltonian $H(x)$, evolves based on internal dissipation and external control. By applying these first principles to the familiar model of a pendulum and implementing the result computationally, you will solidify your understanding of energy shaping and dissipation injection, which are central to pH-based control design [@problem_id:2733288].", "problem": "Consider a single-degree-of-freedom rigid pendulum modeled as a nonlinear port-Hamiltonian (pH) system. The state is $x = \\begin{bmatrix} q \\\\ p \\end{bmatrix}$, where $q$ is the angular position and $p$ is the angular momentum. The Hamiltonian (total stored energy) is $H(x) = \\dfrac{p^{2}}{2 m} + m g L \\left(1 - \\cos q\\right)$, where $m$ is the mass, $g$ is the gravitational acceleration, and $L$ is the length. The pH form is defined by the structural interconnection-dissipation-input mapping\n$$\n\\dot{x} = \\left(J(x) - R(x)\\right) \\nabla H(x) + G(x)\\, u, \\quad y = G(x)^{\\top} \\nabla H(x),\n$$\nwith $J(x) = \\begin{bmatrix} 0 & 1 \\\\ -1 & 0 \\end{bmatrix}$ skew-symmetric, dissipation matrix $R(x) = \\mathrm{diag}\\!\\left(0,\\, d(q)\\right)$ where $d(q) = d_{0} + d_{1} \\sin^{2}(q)$ with $d_{0} \\ge 0$ and $d_{1} \\ge 0$, and input matrix $G(x) = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$. The output is the port variable $y$. Angles must be given in radians.\n\nStarting only from the port-Hamiltonian definition above and the basic energy-balance identity implied by skew-symmetry of $J(x)$ and positive semidefiniteness of $R(x)$, perform the following:\n\n1) Derive the expression for the time derivative $\\dot{H}(x)$ under the static output feedback $u = - K\\, y$, where $K$ is a real scalar. Your derivation must be based on the definitions of the Hamiltonian, its gradient, the port variables, and the dissipation and interconnection structure. Do not assume any pre-known closed-form of $\\dot{H}(x)$; derive it using the fundamental pH energy balance.\n\n2) Using your derived expression for $\\dot{H}(x)$, implement a program that evaluates $\\dot{H}(x)$ for the following test suite. For each case, also determine whether the closed-loop instantaneous energy dissipation is nonnegative for all momenta at the given angle, namely whether the condition $d(q) + K \\ge 0$ holds. Report:\n- the scalar value of $\\dot{H}(x)$ in joules per second (J/s), rounded to six decimal places, and\n- a boolean indicating whether $d(q) + K \\ge 0$ at the specified $q$.\n\nUse the parameter sets below, where $m$ is in kilograms, $L$ is in meters, $g$ is in meters per second squared, and $p$ is in kilogram-meter squared per second. All angles are in radians. The damping parameters $d_{0}$ and $d_{1}$ and the feedback gain $K$ are real scalars.\n\nTest suite (each tuple is $(m, L, g, d_{0}, d_{1}, K, q, p)$):\n- Case A (general nonlinear dissipative, positive feedback damping): $(1.0, 1.0, 9.81, 0.2, 0.3, 0.5, 1.0, 0.7)$.\n- Case B (zero momentum edge case): $(1.0, 1.0, 9.81, 0.1, 0.2, -0.05, 0.4, 0.0)$.\n- Case C (net negative damping at the port leading to energy increase): $(1.0, 1.0, 9.81, 0.05, 0.0, -0.2, 1.3, 0.4)$.\n- Case D (near boundary: small net damping): $(1.0, 1.0, 9.81, 0.05, 0.0, -0.04, 0.9, 0.9)$.\n- Case E (different mass and stronger nonlinear dissipation): $(2.0, 1.0, 9.81, 0.2, 0.5, 0.0, 2.0, 0.7)$.\n\nYour program should compute, for each case, the pair $[\\dot{H}(x), \\text{condition}]$, where $\\dot{H}(x)$ is the value rounded to six decimal places in $\\mathrm{J/s}$ and $\\text{condition}$ is the boolean for $d(q) + K \\ge 0$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a two-element list in the form $[\\text{float}, \\text{boolean}]$. For example: $[[\\text{float},\\text{boolean}],[\\text{float},\\text{boolean}],\\ldots]$.", "solution": "We begin from the definition of a port-Hamiltonian (pH) system with state $x \\in \\mathbb{R}^{n}$, Hamiltonian $H(x)$, interconnection matrix $J(x)$ with $J(x) = - J(x)^{\\top}$, dissipation matrix $R(x) = R(x)^{\\top} \\succeq 0$, input matrix $G(x)$, input $u$, and output $y = G(x)^{\\top} \\nabla H(x)$. The dynamics are\n$$\n\\dot{x} = \\left(J(x) - R(x)\\right) \\nabla H(x) + G(x)\\, u.\n$$\nThe energy-balance identity for such systems follows directly from the chain rule and the structure: the time derivative of the Hamiltonian along trajectories is\n$$\n\\dot{H}(x) = \\nabla H(x)^{\\top} \\dot{x} = \\nabla H(x)^{\\top} \\left(J(x) - R(x)\\right) \\nabla H(x) + \\nabla H(x)^{\\top} G(x)\\, u.\n$$\nBecause $J(x)$ is skew-symmetric, we have $\\nabla H(x)^{\\top} J(x) \\nabla H(x) = 0$, which yields\n$$\n\\dot{H}(x) = - \\nabla H(x)^{\\top} R(x) \\nabla H(x) + y^{\\top} u.\n$$\nThis identity encodes power conservation and dissipation: the first term is nonpositive when $R(x) \\succeq 0$, and the second term is the supplied power at the port.\n\nSpecialize to the pendulum with $x = \\begin{bmatrix} q \\\\ p \\end{bmatrix}$, Hamiltonian\n$$\nH(q,p) = \\frac{p^{2}}{2 m} + m g L \\left(1 - \\cos q\\right),\n$$\ninterconnection $J(x) = \\begin{bmatrix} 0 & 1 \\\\ -1 & 0 \\end{bmatrix}$, dissipation $R(x) = \\mathrm{diag}\\!\\left(0, d(q)\\right)$ with $d(q) = d_{0} + d_{1} \\sin^{2}(q)$ and $d_{0} \\ge 0$, $d_{1} \\ge 0$, and input matrix $G(x) = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$. The gradient of $H$ is\n$$\n\\nabla H(x) = \\begin{bmatrix} \\dfrac{\\partial H}{\\partial q} \\\\[6pt] \\dfrac{\\partial H}{\\partial p} \\end{bmatrix}\n= \\begin{bmatrix} m g L \\sin q \\\\[6pt] \\dfrac{p}{m} \\end{bmatrix}.\n$$\nThe output is\n$$\ny = G(x)^{\\top} \\nabla H(x) = \\begin{bmatrix} 0 & 1 \\end{bmatrix} \\begin{bmatrix} m g L \\sin q \\\\[4pt] \\dfrac{p}{m} \\end{bmatrix} = \\frac{p}{m}.\n$$\nThe dissipation term becomes\n$$\n\\nabla H(x)^{\\top} R(x) \\nabla H(x) = \\begin{bmatrix} m g L \\sin q & \\dfrac{p}{m} \\end{bmatrix}\n\\begin{bmatrix} 0 & 0 \\\\ 0 & d(q) \\end{bmatrix}\n\\begin{bmatrix} m g L \\sin q \\\\[4pt] \\dfrac{p}{m} \\end{bmatrix} = d(q)\\, \\left(\\frac{p}{m}\\right)^{2}.\n$$\nSubstitute into the energy balance to obtain\n$$\n\\dot{H}(x) = - d(q)\\, \\left(\\frac{p}{m}\\right)^{2} + y^{\\top} u.\n$$\nUnder static output feedback $u = - K\\, y$ with scalar $K \\in \\mathbb{R}$, we have $y^{\\top} u = - K\\, y^{2} = - K \\left(\\frac{p}{m}\\right)^{2}$. Therefore,\n$$\n\\dot{H}(x) = - \\left(d(q) + K\\right) \\left(\\frac{p}{m}\\right)^{2}.\n$$\nThis expression is derived purely from the pH structure and the feedback law, using the skew-symmetry of $J(x)$ and the definition of the port variables.\n\nFrom this formula, two conclusions follow:\n- For any fixed angle $q$, the closed-loop instantaneous energy rate satisfies $\\dot{H}(x) \\le 0$ for all $p$ if and only if $d(q) + K \\ge 0$. When $d(q) + K > 0$, the energy strictly decreases for all $p \\ne 0$. When $d(q) + K = 0$, the energy is constant for all $p$. When $d(q) + K < 0$, the energy increases for all $p \\ne 0$.\n- Independently of $q$ and $K$, if $p = 0$ then $y = 0$ and $\\dot{H}(x) = 0$.\n\nAlgorithmic design for computation:\n1) For each test case, read $(m, L, g, d_{0}, d_{1}, K, q, p)$.\n2) Compute $d(q) = d_{0} + d_{1} \\sin^{2}(q)$.\n3) Compute $y = p/m$.\n4) Compute $\\dot{H}(x) = - \\left(d(q) + K\\right) y^{2}$.\n5) Determine the boolean $\\mathrm{condition} = \\left(d(q) + K \\ge 0\\right)$ at the given $q$. This condition characterizes whether the closed-loop instantaneous energy dissipation is nonnegative for all $p$ at that angle.\n6) Round $\\dot{H}(x)$ to six decimal places and report the pair $[\\dot{H}(x), \\mathrm{condition}]$.\n\nNumerical output requirements:\n- Angles must be in radians.\n- Report $\\dot{H}(x)$ in joules per second, rounded to six decimal places.\n- The final output must be a single line that is a list of the five per-case results, each result being a two-element list $[\\text{float}, \\text{boolean}]$ formatted as $[[\\cdot,\\cdot],[\\cdot,\\cdot],\\ldots]$.\n\nThe provided program implements exactly this procedure for the specified test suite.", "answer": "```python\nimport numpy as np\n\ndef compute_dHdt_and_condition(m, L, g, d0, d1, K, q, p):\n    # d(q) = d0 + d1 * sin(q)^2\n    dq = d0 + d1 * (np.sin(q) ** 2)\n    # y = p / m\n    y = p / m\n    # dH/dt = - (d(q) + K) * y^2\n    dHdt = - (dq + K) * (y ** 2)\n    # Condition: nonnegative instantaneous dissipation for all p at this q\n    condition = (dq + K) >= 0.0\n    return dHdt, condition\n\ndef solve():\n    # Define the test cases as specified:\n    # Each tuple: (m, L, g, d0, d1, K, q, p)\n    test_cases = [\n        (1.0, 1.0, 9.81, 0.2, 0.3, 0.5, 1.0, 0.7),   # Case A\n        (1.0, 1.0, 9.81, 0.1, 0.2, -0.05, 0.4, 0.0), # Case B\n        (1.0, 1.0, 9.81, 0.05, 0.0, -0.2, 1.3, 0.4), # Case C\n        (1.0, 1.0, 9.81, 0.05, 0.0, -0.04, 0.9, 0.9),# Case D\n        (2.0, 1.0, 9.81, 0.2, 0.5, 0.0, 2.0, 0.7),   # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        m, L, g, d0, d1, K, q, p = case\n        dHdt, cond = compute_dHdt_and_condition(m, L, g, d0, d1, K, q, p)\n        # Round to six decimals for output\n        dHdt_rounded = float(f\"{dHdt:.6f}\")\n        results.append((dHdt_rounded, cond))\n\n    # Format as a single-line list of [float,boolean] pairs\n    formatted_items = []\n    for val, flag in results:\n        # Ensure six decimal places in string representation\n        formatted_items.append(f\"[{val:.6f},{str(flag)}]\")\n    print(f\"[{','.join(formatted_items)}]\")\n\nsolve()\n```", "id": "2733288"}, {"introduction": "Beyond analyzing stability, a crucial aspect of system theory is determining whether a system's internal state can be inferred from its measured outputs. This exercise connects the physical property of energy dissipation with the abstract but essential concepts of observability and detectability within the pH framework. You will discover how the system's dissipative structure directly informs whether unmeasured states correspond to stable dynamics, a property known as detectability, which is a prerequisite for designing state observers [@problem_id:2733257].", "problem": "Consider the linear time-invariant port-Hamiltonian (pH) system in standard form\n$$\\dot{x} = \\left(J - R\\right) Q\\,x + G\\,u,\\quad y = G^{\\top} Q\\,x,$$\nwhere $x \\in \\mathbb{R}^{4}$ is the state, $u \\in \\mathbb{R}^{2}$ is the input, $y \\in \\mathbb{R}^{2}$ is the measured output, $Q \\in \\mathbb{R}^{4 \\times 4}$ is symmetric positive definite, $J \\in \\mathbb{R}^{4 \\times 4}$ is skew-symmetric, and $R \\in \\mathbb{R}^{4 \\times 4}$ is symmetric positive semidefinite. Let the Hamiltonian be $H(x) = \\frac{1}{2} x^{\\top} Q x$. Take\n$$Q = I_{4},\\quad J = \\begin{bmatrix}\n0 & 1 & 0 & 0\\\\\n-1 & 0 & 1 & 0\\\\\n0 & -1 & 0 & 0\\\\\n0 & 0 & 0 & 0\n\\end{bmatrix},\\quad R = \\operatorname{diag}\\!\\left(0,\\,2,\\,0,\\,r_{4}\\right),\\quad r_{4} > 0,$$\nand\n$$G = \\begin{bmatrix}\n1 & 0\\\\\n0 & 1\\\\\n0 & 0\\\\\n0 & 0\n\\end{bmatrix},\\quad \\text{so that}\\; y = \\begin{bmatrix} x_{1}\\\\ x_{2} \\end{bmatrix}.$$\nDefine $A := (J-R)Q$ and $C := G^{\\top} Q$ so that the unforced output is $y = C x$. Use only foundational definitions and properties to reason about observability and detectability: observability of $(A,C)$ via the classical observability matrix, the Hamiltonian energy balance $\\dot{H}(x) = -(\\nabla H(x))^{\\top} R\\, (\\nabla H(x))$ for $u \\equiv 0$, and detectability as the requirement that all unobservable modes are asymptotically stable.\n\nTask: Determine the dimension $d$ of the largest unobservable subspace of the pair $(A,C)$ and the asymptotic decay rate $\\alpha$ of trajectories confined to this unobservable subspace (defined as the positive number such that these trajectories decay proportionally to $\\exp(-\\alpha t)$). Express your final answer as two entries in a row matrix $\\begin{pmatrix} d & \\alpha \\end{pmatrix}$. No rounding is required.", "solution": "The problem statement must first be validated for scientific soundness and logical consistency.\n\n**Step 1: Extract Givens**\nThe system is a linear time-invariant port-Hamiltonian (pH) system described by:\n- State equation: $\\dot{x} = \\left(J - R\\right) Q\\,x + G\\,u$\n- Output equation: $y = G^{\\top} Q\\,x$\n- State, input, output vectors: $x \\in \\mathbb{R}^{4}$, $u \\in \\mathbb{R}^{2}$, $y \\in \\mathbb{R}^{2}$\n- System matrices and their properties:\n  - $Q \\in \\mathbb{R}^{4 \\times 4}$ is symmetric positive definite.\n  - $J \\in \\mathbb{R}^{4 \\times 4}$ is skew-symmetric.\n  - $R \\in \\mathbb{R}^{4 \\times 4}$ is symmetric positive semidefinite.\n- Hamiltonian: $H(x) = \\frac{1}{2} x^{\\top} Q x$.\n- Specific matrix values:\n  - $Q = I_{4}$ (the $4 \\times 4$ identity matrix).\n  - $J = \\begin{bmatrix} 0 & 1 & 0 & 0\\\\ -1 & 0 & 1 & 0\\\\ 0 & -1 & 0 & 0\\\\ 0 & 0 & 0 & 0 \\end{bmatrix}$.\n  - $R = \\operatorname{diag}\\!\\left(0,\\,2,\\,0,\\,r_{4}\\right)$, where $r_{4} > 0$.\n  - $G = \\begin{bmatrix} 1 & 0\\\\ 0 & 1\\\\ 0 & 0\\\\ 0 & 0 \\end{bmatrix}$.\n- Derived matrices and vectors:\n  - $A := (J-R)Q$.\n  - $C := G^{\\top} Q$.\n  - $y = \\begin{bmatrix} x_{1}\\\\ x_{2} \\end{bmatrix}$.\n- Unforced energy dynamics ($u \\equiv 0$): $\\dot{H}(x) = -(\\nabla H(x))^{\\top} R\\, (\\nabla H(x))$.\n- Task: Determine the dimension $d$ of the largest unobservable subspace of $(A,C)$ and the asymptotic decay rate $\\alpha$ for trajectories within this subspace. The final answer must be a row matrix $\\begin{pmatrix} d & \\alpha \\end{pmatrix}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard exercise in linear systems and control theory, specifically concerning observability and detectability for a port-Hamiltonian system. All terms are well-defined, the matrices are specified, and the question is precise. The properties of the matrices ($Q$ positive definite, $J$ skew-symmetric, $R$ positive semidefinite) are consistent with the port-Hamiltonian framework. The problem is self-contained, scientifically grounded in control theory, and well-posed. No flaws listed in the validation criteria are present.\n\n**Verdict**\nThe problem is valid. A solution will be constructed.\n\n**Solution Derivation**\nFirst, we construct the state-space matrices $A$ and $C$ based on the provided data.\nThe matrix $Q$ is the identity matrix $I_{4}$, so the Hamiltonian is $H(x) = \\frac{1}{2} x^{\\top} I_{4} x = \\frac{1}{2} x^{\\top} x$.\nThe system matrix $A$ is given by $A = (J-R)Q = (J-R)I_{4} = J-R$.\nSubstituting the given matrices for $J$ and $R$:\n$$A = \\begin{bmatrix}\n0 & 1 & 0 & 0\\\\\n-1 & 0 & 1 & 0\\\\\n0 & -1 & 0 & 0\\\\\n0 & 0 & 0 & 0\n\\end{bmatrix} - \\begin{bmatrix}\n0 & 0 & 0 & 0\\\\\n0 & 2 & 0 & 0\\\\\n0 & 0 & 0 & 0\\\\\n0 & 0 & 0 & r_{4}\n\\end{bmatrix} = \\begin{bmatrix}\n0 & 1 & 0 & 0\\\\\n-1 & -2 & 1 & 0\\\\\n0 & -1 & 0 & 0\\\\\n0 & 0 & 0 & -r_{4}\n\\end{bmatrix}.$$\nThe output matrix $C$ is given by $C = G^{\\top}Q = G^{\\top}I_{4} = G^{\\top}$.\n$$C = \\begin{bmatrix}\n1 & 0\\\\\n0 & 1\\\\\n0 & 0\\\\\n0 & 0\n\\end{bmatrix}^{\\top} = \\begin{bmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 0\n\\end{bmatrix}.$$\nThe unobservable subspace is the null space of the observability matrix $\\mathcal{O}$, defined as\n$$\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\\\ CA^{2} \\\\ CA^{3} \\end{bmatrix}.$$\nA state vector $x$ belongs to the unobservable subspace if and only if $x \\in \\ker(\\mathcal{O})$, which is equivalent to $CA^{k}x = 0$ for all integers $k \\ge 0$.\nLet $x = \\begin{pmatrix} x_{1} & x_{2} & x_{3} & x_{4} \\end{pmatrix}^{\\top}$ be an unobservable state.\nThe first condition is $Cx = 0$:\n$$Cx = \\begin{bmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 0\n\\end{bmatrix} \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\\\ x_{4} \\end{pmatrix} = \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.$$\nThis implies that any unobservable state must have $x_{1}=0$ and $x_{2}=0$, so it must be of the form $x = \\begin{pmatrix} 0 & 0 & x_{3} & x_{4} \\end{pmatrix}^{\\top}$.\n\nNow we consider the condition $CAx = 0$. First, we compute $Ax$:\n$$Ax = \\begin{bmatrix}\n0 & 1 & 0 & 0\\\\\n-1 & -2 & 1 & 0\\\\\n0 & -1 & 0 & 0\\\\\n0 & 0 & 0 & -r_{4}\n\\end{bmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ x_{3} \\\\ x_{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ x_{3} \\\\ 0 \\\\ -r_{4} x_{4} \\end{pmatrix}.$$\nThen, we apply $C$:\n$$CAx = \\begin{bmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 0\n\\end{bmatrix} \\begin{pmatrix} 0 \\\\ x_{3} \\\\ 0 \\\\ -r_{4} x_{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ x_{3} \\end{pmatrix}.$$\nFor $x$ to be unobservable, we require $CAx = 0$, which implies $x_{3} = 0$.\nThus, an unobservable state must be of the form $x = \\begin{pmatrix} 0 & 0 & 0 & x_{4} \\end{pmatrix}^{\\top}$.\n\nWe must verify that any such state is indeed unobservable by checking that $CA^{k}x = 0$ for all $k \\ge 0$. Let $x = \\begin{pmatrix} 0 & 0 & 0 & x_{4} \\end{pmatrix}^{\\top}$. We have already shown $Cx=0$ and $CAx=0$.\nLet us compute $A^{2}x$:\n$$A^{2}x = A(Ax) = A \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ -r_{4}x_{4} \\end{pmatrix} = \\begin{bmatrix}\n0 & 1 & 0 & 0\\\\\n-1 & -2 & 1 & 0\\\\\n0 & -1 & 0 & 0\\\\\n0 & 0 & 0 & -r_{4}\n\\end{bmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ -r_{4} x_{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ (-r_{4})^{2} x_{4} \\end{pmatrix}.$$\nThen $CA^{2}x = C \\begin{pmatrix} 0 & 0 & 0 & (-r_{4})^{2} x_{4} \\end{pmatrix}^{\\top} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$.\nBy induction, it is clear that for any $k \\ge 1$, $A^{k}x = \\begin{pmatrix} 0 & 0 & 0 & (-r_{4})^{k} x_{4} \\end{pmatrix}^{\\top}$, and thus $CA^{k}x = 0$.\nThe unobservable subspace is therefore the set of all vectors of the form $\\begin{pmatrix} 0 & 0 & 0 & x_{4} \\end{pmatrix}^{\\top}$. This subspace is spanned by the vector $\\begin{pmatrix} 0 & 0 & 0 & 1 \\end{pmatrix}^{\\top}$.\nThe dimension $d$ of this subspace is $1$. So, $d=1$.\n\nNext, we must determine the asymptotic decay rate $\\alpha$ of trajectories confined to this unobservable subspace. A trajectory $x(t)$ is confined to this subspace if its initial state $x(0)$ is in the subspace, i.e., $x(0) = \\begin{pmatrix} 0 & 0 & 0 & x_{4,0} \\end{pmatrix}^{\\top}$ for some constant $x_{4,0}$.\nThe dynamics of the system with zero input ($u=0$) are $\\dot{x} = Ax$. For a state $x$ in the unobservable subspace, i.e., $x(t) = \\begin{pmatrix} 0 & 0 & 0 & x_{4}(t) \\end{pmatrix}^{\\top}$, the dynamics reduce to the fourth component:\n$$\\dot{x}_{4}(t) = [A x(t)]_{4} = -r_{4} x_{4}(t).$$\nThis is a first-order linear ordinary differential equation. Its solution is:\n$$x_{4}(t) = x_{4}(0) \\exp(-r_{4} t).$$\nThe full state trajectory is $x(t) = \\begin{pmatrix} 0 & 0 & 0 & x_{4}(0) \\exp(-r_{4}t) \\end{pmatrix}^{\\top}$.\nThe problem defines $\\alpha$ as the positive number such that these trajectories decay proportionally to $\\exp(-\\alpha t)$. By comparing $x_4(t)$ with this definition, we identify the decay rate.\nSince $r_{4} > 0$, the trajectory indeed decays. The decay rate is $\\alpha = r_{4}$.\nThis confirms that the system is detectable, as the unobservable mode corresponding to the eigenvalue $\\lambda = -r_{4}$ is asymptotically stable.\n\nThe dimension of the unobservable subspace is $d=1$, and the asymptotic decay rate of its trajectories is $\\alpha = r_{4}$. The question asks for these two values in a row matrix.", "answer": "$$\\boxed{\\begin{pmatrix} 1 & r_{4} \\end{pmatrix}}$$", "id": "2733257"}, {"introduction": "Real-world engineering systems, particularly in mechanics and robotics, are often subject to geometric or kinematic constraints. This advanced practice demonstrates how to systematically incorporate such holonomic constraints into a port-Hamiltonian model using the classical method of Lagrange multipliers. By deriving the exact constraint forces required to confine the system's motion to a specific manifold, you will learn a powerful technique that merges principles from classical mechanics with the structured, energy-based approach of modern control theory [@problem_id:2733287].", "problem": "Consider the following finite-dimensional port-Hamiltonian (pH) model of two point masses coupled to ground by linear springs and dampers. The configuration vector is $q \\in \\mathbb{R}^{2}$ with components $q_{1}$ and $q_{2}$, and the conjugate momentum vector is $p \\in \\mathbb{R}^{2}$ with components $p_{1}$ and $p_{2}$. Let the mass matrix be $M = \\mathrm{diag}(m_{1}, m_{2})$ with $m_{1} > 0$ and $m_{2} > 0$, the stiffness matrix be $K = \\mathrm{diag}(k_{1}, k_{2})$ with $k_{1} > 0$ and $k_{2} > 0$, and the viscous damping matrix be $D = \\mathrm{diag}(d_{1}, d_{2})$ with $d_{1} \\ge 0$ and $d_{2} \\ge 0$. An external control effort $u \\in \\mathbb{R}$ acts only on the second mass as a force, so the input distribution is $B = \\begin{bmatrix} 0 \\\\ b \\end{bmatrix}$ with $b \\neq 0$. The Hamiltonian is\n$$\nH(q,p) = \\frac{1}{2} p^{\\top} M^{-1} p \\;+\\; \\frac{1}{2} q^{\\top} K q,\n$$\nand the unconstrained pH evolution with linear dissipation is given by Hamiltonâ€™s equations in pH form:\n$$\n\\dot{q} \\;=\\; \\frac{\\partial H}{\\partial p}, \n\\qquad\n\\dot{p} \\;=\\; -\\,\\frac{\\partial H}{\\partial q} \\;-\\; D\\,\\frac{\\partial H}{\\partial p} \\;+\\; B\\,u.\n$$\nSuppose a holonomic constraint is to be enforced,\n$$\nA\\,q \\;=\\; 0, \\qquad A \\;=\\; \\begin{bmatrix} 1 & 1 \\end{bmatrix},\n$$\nwhich encodes $q_{1} + q_{2} = 0$. Two standard strategies to enforce such constraints in port-Hamiltonian systems are:\n- Projection with a Lagrange multiplier (i.e., augmenting the momentum dynamics by the constraint port $A^{\\top} \\lambda$ and choosing $\\lambda$ to render the constraint manifold invariant).\n- Penalty, by adding the quadratic penalty term $\\frac{k_{p}}{2}\\,|A q|^{2}$ to the Hamiltonian with stiffness $k_{p} > 0$.\n\nStarting only from the definitions above and the fundamental form of the pH equations, derive the projection-based Lagrange multiplier $\\lambda(q,p,u)$ that enforces invariance of the constraint manifold $A q = 0$ for all time. Express your final result as a single closed-form analytic expression in the variables and parameters $m_{1}, m_{2}, k_{1}, k_{2}, d_{1}, d_{2}, b, q_{1}, q_{2}, p_{1}, p_{2}, u$. Do not perform any numerical substitutions and do not round. Your final answer must be a single analytic expression with no units and no inequality signs.", "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information for a rigorous derivation. It is a standard problem in the control of constrained mechanical systems within the port-Hamiltonian framework. Therefore, the problem is deemed valid and a full solution is warranted.\n\nThe objective is to find the Lagrange multiplier $\\lambda(q,p,u)$ that ensures the holonomic constraint $Aq=0$ is invariant under the system dynamics. The system is described by the state vector $x = \\begin{pmatrix} q \\\\ p \\end{pmatrix}$ and the Hamiltonian $H(q,p) = \\frac{1}{2} p^{\\top} M^{-1} p + \\frac{1}{2} q^{\\top} K q$. The augmented dynamics, including the constraint force, are given by:\n$$ \\dot{q} = \\frac{\\partial H}{\\partial p} $$\n$$ \\dot{p} = -\\frac{\\partial H}{\\partial q} - D \\frac{\\partial H}{\\partial p} + B u + A^{\\top} \\lambda $$\nThe holonomic constraint is defined as $c_1(q) = Aq = 0$, where $A = \\begin{bmatrix} 1 & 1 \\end{bmatrix}$. For this constraint to be invariant for all time $t \\ge 0$, any trajectory starting on the constraint manifold must remain on it. This requires that the time derivative of the constraint equation evaluates to zero, under the assumption that the system state is already on the manifold.\nThe first time derivative of the constraint is:\n$$ \\dot{c}_1(q,p) = \\frac{d}{dt}(Aq) = A \\dot{q} $$\nSubstituting the equation for $\\dot{q}$ from the pH dynamics, we obtain:\n$$ \\dot{c}_1(q,p) = A \\frac{\\partial H}{\\partial p} $$\nFor invariance, we must have $\\dot{c}_1(q,p) = 0$. This leads to a second-level, or hidden, constraint on the momentum:\n$$ c_2(q,p) = A \\frac{\\partial H}{\\partial p} = 0 $$\nThe full constraint manifold, which must be rendered invariant, is thus $\\mathcal{M} = \\{ (q,p) \\in \\mathbb{R}^4 \\mid c_1(q)=0 \\text{ and } c_2(q,p)=0 \\}$. For a trajectory to remain in $\\mathcal{M}$, the time derivative of $c_2(q,p)$ must also be zero for any state $(q,p) \\in \\mathcal{M}$.\n$$ \\dot{c}_2(q,p,u) = \\frac{d}{dt}\\left(A \\frac{\\partial H}{\\partial p}\\right) = 0 $$\nThe term $\\frac{\\partial H}{\\partial p}$ is a function of $p$, and $p$ is a function of time. Using the chain rule and the fact that $M$ is constant:\n$$ \\dot{c}_2 = A \\frac{d}{dt}(M^{-1}p) = A M^{-1} \\dot{p} $$\nThe Lagrange multiplier $\\lambda$ is chosen precisely to satisfy this condition. We substitute the augmented dynamics for $\\dot{p}$:\n$$ A M^{-1} \\left( -\\frac{\\partial H}{\\partial q} - D\\frac{\\partial H}{\\partial p} + B u + A^{\\top} \\lambda \\right) = 0 $$\nThis equation is linear in the scalar $\\lambda$ and can be solved directly.\n$$ A M^{-1} A^{\\top} \\lambda = - A M^{-1} \\left( -\\frac{\\partial H}{\\partial q} - D\\frac{\\partial H}{\\partial p} + B u \\right) $$\n$$ A M^{-1} A^{\\top} \\lambda = A M^{-1} \\left( \\frac{\\partial H}{\\partial q} + D\\frac{\\partial H}{\\partial p} - B u \\right) $$\nThis yields the formal solution for $\\lambda$:\n$$ \\lambda = (A M^{-1} A^{\\top})^{-1} A M^{-1} \\left( \\frac{\\partial H}{\\partial q} + D\\frac{\\partial H}{\\partial p} - B u \\right) $$\nWe now compute each term using the given parameters. The matrices are:\n$M^{-1} = \\begin{pmatrix} 1/m_1 & 0 \\\\ 0 & 1/m_2 \\end{pmatrix}$, $K = \\begin{pmatrix} k_1 & 0 \\\\ 0 & k_2 \\end{pmatrix}$, $D = \\begin{pmatrix} d_1 & 0 \\\\ 0 & d_2 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ b \\end{pmatrix}$, $A = \\begin{pmatrix} 1 & 1 \\end{pmatrix}$, $A^{\\top} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$.\n\nThe partial derivatives of the Hamiltonian are:\n$$ \\frac{\\partial H}{\\partial q} = Kq = \\begin{pmatrix} k_1 q_1 \\\\ k_2 q_2 \\end{pmatrix} $$\n$$ \\frac{\\partial H}{\\partial p} = M^{-1}p = \\begin{pmatrix} p_1/m_1 \\\\ p_2/m_2 \\end{pmatrix} $$\n\nFirst, compute the invertible scalar term $(A M^{-1} A^{\\top})$:\n$$ A M^{-1} A^{\\top} = \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\begin{pmatrix} 1/m_1 & 0 \\\\ 0 & 1/m_2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1/m_1 & 1/m_2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{m_1} + \\frac{1}{m_2} = \\frac{m_1+m_2}{m_1 m_2} $$\nSince $m_1 > 0$ and $m_2 > 0$, this term is non-zero, and its inverse is $(A M^{-1} A^{\\top})^{-1} = \\frac{m_1 m_2}{m_1 + m_2}$.\n\nNext, compute the vector term in the parentheses:\n$$ \\frac{\\partial H}{\\partial q} + D\\frac{\\partial H}{\\partial p} - B u = \\begin{pmatrix} k_1 q_1 \\\\ k_2 q_2 \\end{pmatrix} + \\begin{pmatrix} d_1 & 0 \\\\ 0 & d_2 \\end{pmatrix} \\begin{pmatrix} p_1/m_1 \\\\ p_2/m_2 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ b \\end{pmatrix}u $$\n$$ = \\begin{pmatrix} k_1 q_1 + d_1 p_1/m_1 \\\\ k_2 q_2 + d_2 p_2/m_2 - bu \\end{pmatrix} $$\n\nFinally, pre-multiply this vector by $A M^{-1}$:\n$$ A M^{-1} = \\begin{pmatrix} 1/m_1 & 1/m_2 \\end{pmatrix} $$\n$$ A M^{-1} \\left( \\frac{\\partial H}{\\partial q} + D\\frac{\\partial H}{\\partial p} - B u \\right) = \\frac{1}{m_1}(k_1 q_1 + \\frac{d_1 p_1}{m_1}) + \\frac{1}{m_2}(k_2 q_2 + \\frac{d_2 p_2}{m_2} - bu) $$\n$$ = \\frac{k_1 q_1}{m_1} + \\frac{d_1 p_1}{m_1^2} + \\frac{k_2 q_2}{m_2} + \\frac{d_2 p_2}{m_2^2} - \\frac{bu}{m_2} $$\n\nCombining all parts, we arrive at the final expression for $\\lambda$:\n$$ \\lambda = \\left(\\frac{m_1 m_2}{m_1 + m_2}\\right) \\left( \\frac{k_1 q_1}{m_1} + \\frac{d_1 p_1}{m_1^2} + \\frac{k_2 q_2}{m_2} + \\frac{d_2 p_2}{m_2^2} - \\frac{bu}{m_2} \\right) $$\nThis is the closed-form analytical expression for the Lagrange multiplier as a function of the system state $(q,p)$, external input $u$, and system parameters. This multiplier, when applied as a force via the constraint port $A^{\\top}$, ensures that the constraint manifold $\\mathcal{M}$ is an invariant set of the closed-loop system dynamics.", "answer": "$$\n\\boxed{\\frac{m_1 m_2}{m_1 + m_2} \\left( \\frac{k_1 q_1}{m_1} + \\frac{d_1 p_1}{m_1^2} + \\frac{k_2 q_2}{m_2} + \\frac{d_2 p_2}{m_2^2} - \\frac{b u}{m_2} \\right)}\n$$", "id": "2733287"}]}