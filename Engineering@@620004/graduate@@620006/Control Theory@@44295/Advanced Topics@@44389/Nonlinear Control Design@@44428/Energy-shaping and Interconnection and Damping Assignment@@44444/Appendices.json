{"hands_on_practices": [{"introduction": "The heart of Interconnection and Damping Assignment (IDA-PBC) lies in solving the \"matching equations,\" but where do these fundamental constraints originate? This exercise guides you through their derivation from first principles, showing how a system's dynamics are partitioned into parts that can be freely assigned by the control input and parts that impose inviolable constraints on the design. By formalizing this split using a mathematical annihilator, you will gain a deep appreciation for why energy-shaping is fundamentally a problem of solving a specific set of partial differential equations for the desired energy function $H_{d}(x)$ [@problem_id:2704627].", "problem": "Consider a control-affine port-Hamiltonian system with state $x \\in \\mathbb{R}^{n}$, input $u \\in \\mathbb{R}^{m}$, smooth Hamiltonian $H:\\mathbb{R}^{n} \\to \\mathbb{R}$, and interconnection-damping matrix $F(x) = J(x) - R(x)$, where $J(x)^{\\top} = -J(x)$, $R(x) = R(x)^{\\top} \\succeq 0$. The system dynamics are\n$$\n\\dot{x} = F(x)\\nabla H(x) + g(x)u.\n$$\nEnergy-shaping via Interconnection and Damping Assignment Passivity-Based Control (IDA-PBC) seeks a desired closed-loop of the form\n$$\n\\dot{x} = F_{d}(x)\\nabla H_{d}(x),\n$$\nwith $F_{d}(x) = J_{d}(x) - R_{d}(x)$, $J_{d}(x)^{\\top} = -J_{d}(x)$, $R_{d}(x) = R_{d}(x)^{\\top} \\succeq 0$, and a desired Hamiltonian $H_{d}(x)$ that must satisfy a set of matching partial differential equations (PDEs) to be determined.\n\nAssume the state is partitioned as $x = (x_{a}, x_{u})$ with $x_{a} \\in \\mathbb{R}^{n_{a}}$ (actuated coordinates), $x_{u} \\in \\mathbb{R}^{n_{u}}$ (unactuated coordinates), and $n = n_{a} + n_{u}$. Suppose the actuation matrix is\n$$\ng(x) = \\begin{bmatrix} I_{n_{a}} \\\\ 0_{n_{u}\\times n_{a}} \\end{bmatrix}.\n$$\nUsing only the definitions above and the requirement that the control input $u$ can only influence the actuated coordinates, start from the closed-loop equality\n$$\nF_{d}(x)\\nabla H_{d}(x) = F(x)\\nabla H(x) + g(x)u\n$$\nand:\n\n- Derive the matching conditions by separating the actuated and unactuated components explicitly, making clear which equations are true PDE constraints on the desired energy $H_{d}(x)$ and which equations can be enforced via the control input $u$.\n- Identify which part of the separated equations would be overdetermined if imposed as PDEs for $H_{d}(x)$, and explain why.\n\nFinally, express the compact matching condition using a left-annihilator $g^{\\perp}(x)$ of $g(x)$ with full row rank and orthonormal rows, in the form\n$$\ng^{\\perp}(x)\\big(F_{d}(x)\\nabla H_{d}(x) - F(x)\\nabla H(x)\\big) = 0,\n$$\nand provide, as your final answer, the explicit block-matrix expression for $g^{\\perp}(x)$ in terms of $n_{a}$ and $n_{u}$. No numerical evaluation is required. Your final answer must be a single analytic expression. No units are needed and no rounding is required. Express angles in radians if they appear.", "solution": "The problem statement is first subjected to validation.\n\nStep 1: Extract Givens.\nThe system dynamics are given by $\\dot{x} = F(x)\\nabla H(x) + g(x)u$, where $x \\in \\mathbb{R}^{n}$ is the state, $u \\in \\mathbb{R}^{m}$ is the input, and $H:\\mathbb{R}^{n} \\to \\mathbb{R}$ is the Hamiltonian. The matrix $F(x) = J(x) - R(x)$ satisfies $J(x)^{\\top} = -J(x)$ and $R(x) = R(x)^{\\top} \\succeq 0$. The desired closed-loop dynamics are $\\dot{x} = F_{d}(x)\\nabla H_{d}(x)$, with a desired Hamiltonian $H_d(x)$ and a desired structure matrix $F_d(x) = J_d(x) - R_d(x)$ where $J_{d}(x)^{\\top} = -J_{d}(x)$ and $R_{d}(x) = R_{d}(x)^{\\top} \\succeq 0$. The state is partitioned as $x = (x_{a}, x_{u})$ where $x_{a} \\in \\mathbb{R}^{n_{a}}$ and $x_{u} \\in \\mathbb{R}^{n_{u}}$, with $n = n_{a} + n_{u}$. The actuation matrix is $g(x) = \\begin{bmatrix} I_{n_{a}} \\\\ 0_{n_{u}\\times n_{a}} \\end{bmatrix}$. The closed-loop matching must satisfy $F_{d}(x)\\nabla H_{d}(x) = F(x)\\nabla H(x) + g(x)u$. A left-annihilator $g^{\\perp}(x)$ of $g(x)$ is defined with full row rank and orthonormal rows, leading to the compact condition $g^{\\perp}(x)\\big(F_{d}(x)\\nabla H_{d}(x) - F(x)\\nabla H(x)\\big) = 0$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, rooted in the well-established theory of port-Hamiltonian systems and passivity-based control (IDA-PBC). It is objective and phrased using standard, precise terminology of the field. The problem is self-contained, providing all necessary definitions and equations for the required derivation. The structure of $g(x)$ implies $m=n_a$, which is consistent. The problem is well-posed, as it requests a derivation and an explicit expression for a uniquely defined mathematical object under the given constraints. No flaws corresponding to the checklist items are present.\n\nStep 3: Verdict and Action.\nThe problem is valid. A solution will be provided.\n\nThe derivation begins with the closed-loop equality:\n$$\nF_{d}(x)\\nabla H_{d}(x) = F(x)\\nabla H(x) + g(x)u\n$$\nTo analyze this equation under the given state partition $x = (x_a, x_u)$, we partition the vectors and matrices accordingly. The dimension of the input $u$ is $n_a$. The gradient vectors are partitioned as:\n$$\n\\nabla H(x) = \\begin{bmatrix} \\nabla_{x_a} H(x) \\\\ \\nabla_{x_u} H(x) \\end{bmatrix}, \\quad \\nabla H_d(x) = \\begin{bmatrix} \\nabla_{x_a} H_d(x) \\\\ \\nabla_{x_u} H_d(x) \\end{bmatrix}\n$$\nThe structure matrices are partitioned as:\n$$\nF(x) = \\begin{bmatrix} F_{aa}(x)  F_{au}(x) \\\\ F_{ua}(x)  F_{uu}(x) \\end{bmatrix}, \\quad F_d(x) = \\begin{bmatrix} F_{d,aa}(x)  F_{d,au}(x) \\\\ F_{d,ua}(x)  F_{d,uu}(x) \\end{bmatrix}\n$$\nwhere, for example, $F_{au}(x)$ is a matrix of size $n_a \\times n_u$. The input term is:\n$$\ng(x)u = \\begin{bmatrix} I_{n_{a}} \\\\ 0_{n_{u}\\times n_{a}} \\end{bmatrix} u = \\begin{bmatrix} u \\\\ 0_{n_u \\times 1} \\end{bmatrix}\n$$\nSubstituting these partitioned forms into the main equality yields:\n$$\n\\begin{bmatrix} F_{d,aa}(x)  F_{d,au}(x) \\\\ F_{d,ua}(x)  F_{d,uu}(x) \\end{bmatrix} \\begin{bmatrix} \\nabla_{x_a} H_d(x) \\\\ \\nabla_{x_u} H_d(x) \\end{bmatrix} = \\begin{bmatrix} F_{aa}(x)  F_{au}(x) \\\\ F_{ua}(x)  F_{uu}(x) \\end{bmatrix} \\begin{bmatrix} \\nabla_{x_a} H(x) \\\\ \\nabla_{x_u} H(x) \\end{bmatrix} + \\begin{bmatrix} u \\\\ 0 \\end{bmatrix}\n$$\nExpanding the matrix products gives a system of two block equations.\n\nThe first block corresponds to the actuated coordinates $x_a$:\n$$\nF_{d,aa}\\nabla_{x_a}H_d + F_{d,au}\\nabla_{x_u}H_d = F_{aa}\\nabla_{x_a}H + F_{au}\\nabla_{x_u}H + u\n$$\nThe second block corresponds to the unactuated coordinates $x_u$:\n$$\nF_{d,ua}\\nabla_{x_a}H_d + F_{d,uu}\\nabla_{x_u}H_d = F_{ua}\\nabla_{x_a}H + F_{uu}\\nabla_{x_u}H\n$$\nThese two equations represent the separated matching conditions.\n\nThe second equation, governing the unactuated dynamics, does not contain the control input $u$. It therefore imposes a structural constraint on the desired Hamiltonian $H_d(x)$ and the desired interconnection matrix $F_d(x)$. This equation is a system of $n_u$ partial differential equations (PDEs) that must be solved to find a suitable $H_d(x)$. These are the **true PDE constraints** of the IDA-PBC problem.\n\nThe first equation, governing the actuated dynamics, contains the control input $u$. This equation is not a constraint on $H_d(x)$. Instead, once $H_d(x)$ and $F_d(x)$ are chosen to satisfy the unactuated PDE constraints and other design objectives (e.g., ensuring the desired equilibrium is a minimum of $H_d$), this first equation can be rearranged to define the state-feedback control law:\n$$\nu = (F_{d,aa}\\nabla_{x_a}H_d + F_{d,au}\\nabla_{x_u}H_d) - (F_{aa}\\nabla_{x_a}H + F_{au}\\nabla_{x_u}H)\n$$\nThis control law, by construction, enforces the desired dynamics on the actuated coordinates.\n\nIf both the actuated and unactuated block equations were imposed as PDEs for the single scalar function $H_d(x)$, the system would be overdetermined. The actuated block equation would add $n_a$ more PDEs, resulting in a total of $n_a + n_u = n$ PDEs for $H_d(x)$. A single scalar field generally cannot satisfy an arbitrary system of more than one PDE. The system is overdetermined because the control input $u$ provides $n_a$ degrees of freedom, which are precisely intended to satisfy the $n_a$ equations of the actuated block. Imposing these as constraints on $H_d(x)$ ignores the available control authority and is therefore an incorrect formulation.\n\nFinally, we derive the compact matching condition. We seek a left-annihilator $g^{\\perp}(x)$ for $g(x)$, which must satisfy $g^{\\perp}(x)g(x) = 0$. Given $g(x) = \\begin{bmatrix} I_{n_a} \\\\ 0_{n_u \\times n_a} \\end{bmatrix}$, let us represent $g^{\\perp}(x)$ in a compatible block form as $g^{\\perp}(x) = \\begin{bmatrix} A  B \\end{bmatrix}$, where $A$ is a matrix of size $k \\times n_a$ and $B$ is a matrix of size $k \\times n_u$. The annihilation condition is:\n$$\ng^{\\perp}(x)g(x) = \\begin{bmatrix} A  B \\end{bmatrix} \\begin{bmatrix} I_{n_a} \\\\ 0 \\end{bmatrix} = A I_{n_a} + B 0 = A = 0_{k \\times n_a}\n$$\nSo, $g^{\\perp}(x)$ must have the form $\\begin{bmatrix} 0_{k \\times n_a}  B \\end{bmatrix}$. The problem specifies that $g^{\\perp}(x)$ has full row rank, which means $k = \\text{rank}(g^{\\perp}) = \\text{rank}(B)$. It also requires that the rows are orthonormal, which implies $g^{\\perp}(x)(g^{\\perp}(x))^{\\top} = I_k$.\n$$\ng^{\\perp}(x)(g^{\\perp}(x))^{\\top} = \\begin{bmatrix} 0  B \\end{bmatrix} \\begin{bmatrix} 0^{\\top} \\\\ B^{\\top} \\end{bmatrix} = B B^{\\top} = I_k\n$$\nThis means that $B$ is a $k \\times n_u$ matrix with orthonormal rows. The image of $g(x)$ is the subspace spanning the first $n_a$ standard basis vectors. The left-annihilator projects onto the orthogonal complement of the image of $g(x)$, which is the subspace spanning the last $n_u$ standard basis vectors. The dimension of this orthogonal complement is $n_u$. To form a basis for this space, we must have $k = n_u$. A matrix $B$ of size $n_u \\times n_u$ satisfying $BB^\\top = I_{n_u}$ is an orthogonal matrix. The simplest choice for $B$ is the identity matrix, $B = I_{n_u}$.\nThis gives the explicit expression for the annihilator:\n$$\ng^{\\perp}(x) = \\begin{bmatrix} 0_{n_u \\times n_a}  I_{n_u} \\end{bmatrix}\n$$\nThis matrix is constant and satisfies all the required properties. Applying it to the rearranged closed-loop equality $F_{d}\\nabla H_{d} - F\\nabla H = gu$ results in:\n$$\ng^{\\perp}(F_{d}\\nabla H_{d} - F\\nabla H) = g^{\\perp}(gu) = (g^{\\perp}g)u = 0 u = 0\n$$\nwhich yields precisely the unactuated PDE constraint equation derived previously. The specific expression for this annihilator is the required final answer.", "answer": "$$\n\\boxed{\\begin{bmatrix}\n0_{n_{u} \\times n_{a}}  I_{n_{u}}\n\\end{bmatrix}}\n$$", "id": "2704627"}, {"introduction": "Having established the underlying equations, we can now use them for practical controller synthesis. The interconnection matrix $J_{d}(x)$ is used to shape the conservative, energy-preserving dynamics, while the damping matrix $R_{d}(x)$ introduces dissipation. This practice demonstrates how to select these matrices to prescribe tangible behaviors, such as oscillation frequency and decay rate, in the vicinity of a target equilibrium. This exercise bridges theory and application by tasking you to design a controller that forces an equilibrium to behave as a pure oscillator (a center) and then as a stable, decaying spiral (a focus), a core skill in motion control design [@problem_id:2704607].", "problem": "Consider a fully actuated two-dimensional system for which Interconnection and Damping Assignmentâ€“Passivity Based Control (IDA-PBC) has been applied to impose a closed-loop port-Hamiltonian (pH) form. The closed-loop dynamics are\n$$\n\\dot{x} = \\big(J_{d}(x)-R_{d}(x)\\big)\\,\\nabla H_{d}(x),\n$$\nwhere $x \\in \\mathbb{R}^{2}$, $J_{d}(x)$ is a skew-symmetric interconnection matrix, $R_{d}(x)$ is a positive semidefinite damping matrix, and $H_{d}(x)$ is the desired Hamiltonian. Suppose the desired equilibrium is at $x^{\\star}=\\mathbf{0}$ and the desired Hamiltonian is quadratic with Hessian\n$$\n\\nabla^{2} H_{d}(0) = K = \\mathrm{diag}(k_{1},k_{2}), \\quad k_{1}0,\\;k_{2}0.\n$$\nAssume $J_{d}(x)$ is chosen to be constant in a neighborhood of $x^{\\star}$ and initially set $R_{d}(x) \\equiv 0$. You are tasked with shaping the interconnection so that the linearization at $x^{\\star}$ is a center with a prescribed small-amplitude oscillation frequency $\\omega_{0}0$.\n\n1. Using only fundamental properties of Hamiltonian vector fields and linearization, construct an explicit constant skew-symmetric $J_{d}$ that makes the linearization at $x^{\\star}$ a center with purely imaginary eigenvalues $\\pm \\mathrm{j}\\,\\omega_{0}$ when $R_{d}\\equiv 0$.\n\n2. Then, add isotropic damping $R_{d}(x)\\equiv r I_{2}$ with $r0$ and, by computing the linearization, determine the eigenvalues of the damped closed-loop. Explain under what condition on $r$ the equilibrium transitions from a center to an asymptotically stable focus.\n\nProvide your final answer as the explicit analytic expression you constructed for $J_{d}$ in item 1. No numerical substitution is required, and no rounding is needed. Do not include units in your final answer.", "solution": "The problem presented is a standard exercise in control theory, specifically within the framework of Interconnection and Damping Assignment Passivity-Based Control (IDA-PBC) for port-Hamiltonian systems. It is scientifically grounded, well-posed, and contains all necessary information. Therefore, we proceed to the solution.\n\nThe closed-loop dynamics are given by the equation:\n$$\n\\dot{x} = \\big(J_{d}(x)-R_{d}(x)\\big)\\,\\nabla H_{d}(x)\n$$\nThe desired equilibrium is at $x^{\\star}=\\mathbf{0}$. For an equilibrium to exist at this point, it is necessary that $\\dot{x}|_{x=\\mathbf{0}} = \\mathbf{0}$. Since $H_d(x)$ is minimized at the stable equilibrium $x^{\\star}$, we must have $\\nabla H_d(\\mathbf{0}) = \\mathbf{0}$. The Taylor expansion of $H_d(x)$ around $x^{\\star}=\\mathbf{0}$ is thus $H_d(x) = H_d(\\mathbf{0}) + \\frac{1}{2}x^T \\nabla^2 H_d(\\mathbf{0}) x + \\mathcal{O}(\\|x\\|^3)$. Setting the potential energy datum $H_d(\\mathbf{0})=0$ and using the given Hessian $\\nabla^2 H_d(\\mathbf{0}) = K$, we have $H_d(x) = \\frac{1}{2}x^T K x$ for small $x$. The gradient is then $\\nabla H_d(x) = Kx + \\mathcal{O}(\\|x\\|^2)$.\n\nThe problem is divided into two parts.\n\nPart 1: Construction of the interconnection matrix $J_d$.\n\nWe are tasked to find a constant skew-symmetric matrix $J_d$ such that the linearization of the undamped system ($R_d(x) \\equiv 0$) at the origin is a center with oscillation frequency $\\omega_0$. The undamped system is:\n$$\n\\dot{x} = J_d(x) \\nabla H_d(x)\n$$\nTo analyze the local behavior around the equilibrium $x^{\\star} = \\mathbf{0}$, we linearize the system. Let $f(x) = J_d(x) \\nabla H_d(x)$. The matrix of the linearized system $\\dot{\\delta x} = A \\delta x$ is the Jacobian of $f(x)$ evaluated at $x = \\mathbf{0}$:\n$$\nA = \\frac{\\partial f}{\\partial x}\\bigg|_{x=\\mathbf{0}} = \\left. \\frac{\\partial}{\\partial x} \\big(J_d(x) \\nabla H_d(x)\\big) \\right|_{x=\\mathbf{0}}\n$$\nGiven that $J_d(x)$ is chosen to be a constant matrix $J_d$, and $\\nabla H_d(\\mathbf{0}) = \\mathbf{0}$, the product rule for differentiation yields:\n$$\nA = \\left( \\frac{\\partial J_d(x)}{\\partial x} \\nabla H_d(x) \\right)\\bigg|_{x=\\mathbf{0}} + J_d(\\mathbf{0}) \\left( \\frac{\\partial \\nabla H_d(x)}{\\partial x} \\right)\\bigg|_{x=\\mathbf{0}} = \\mathbf{0} + J_d \\nabla^2 H_d(\\mathbf{0})\n$$\nWe are given $\\nabla^2 H_d(\\mathbf{0}) = K = \\mathrm{diag}(k_1, k_2)$. Therefore, the state matrix of the linearized system is:\n$$\nA = J_d K\n$$\nFor a two-dimensional system, a constant skew-symmetric matrix $J_d$ must be of the form:\n$$\nJ_d = \\begin{pmatrix} 0  \\alpha \\\\ -\\alpha  0 \\end{pmatrix}\n$$\nfor some real scalar $\\alpha$. The matrix $K$ is given as:\n$$\nK = \\begin{pmatrix} k_1  0 \\\\ 0  k_2 \\end{pmatrix}\n$$\nwhere $k_1  0$ and $k_2  0$. The product $A = J_d K$ is:\n$$\nA = \\begin{pmatrix} 0  \\alpha \\\\ -\\alpha  0 \\end{pmatrix} \\begin{pmatrix} k_1  0 \\\\ 0  k_2 \\end{pmatrix} = \\begin{pmatrix} 0  \\alpha k_2 \\\\ -\\alpha k_1  0 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of $A$ are found from the characteristic equation $\\det(A - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} -\\lambda  \\alpha k_2 \\\\ -\\alpha k_1  -\\lambda \\end{pmatrix} = (-\\lambda)^2 - (\\alpha k_2)(-\\alpha k_1) = \\lambda^2 + \\alpha^2 k_1 k_2 = 0\n$$\nThis gives $\\lambda^2 = -\\alpha^2 k_1 k_2$, so the eigenvalues are $\\lambda = \\pm i |\\alpha| \\sqrt{k_1 k_2}$, where $i$ is the imaginary unit. The problem requires the linearization to be a center with eigenvalues $\\pm i \\omega_0$, where $\\omega_0  0$. Equating the two expressions for the eigenvalues, we get:\n$$\n|\\alpha| \\sqrt{k_1 k_2} = \\omega_0\n$$\nSince $k_1, k_2, \\omega_0$ are positive, we can solve for $|\\alpha|$:\n$$\n|\\alpha| = \\frac{\\omega_0}{\\sqrt{k_1 k_2}}\n$$\nWe have two choices for $\\alpha$. We select the positive root without loss of generality, $\\alpha = \\frac{\\omega_0}{\\sqrt{k_1 k_2}}$. The desired interconnection matrix $J_d$ is then uniquely specified as:\n$$\nJ_d = \\begin{pmatrix} 0  \\frac{\\omega_0}{\\sqrt{k_1 k_2}} \\\\ -\\frac{\\omega_0}{\\sqrt{k_1 k_2}}  0 \\end{pmatrix}\n$$\n\nPart 2: Analysis of the damped system.\n\nNow, isotropic damping $R_d(x) \\equiv r I_2$ is added, with $r  0$. The dynamics become:\n$$\n\\dot{x} = (J_d - rI_2) \\nabla H_d(x)\n$$\nThe new linearized system matrix, $A_d$, is:\n$$\nA_d = (J_d - rI_2) K = \\left( \\begin{pmatrix} 0  \\alpha \\\\ -\\alpha  0 \\end{pmatrix} - \\begin{pmatrix} r  0 \\\\ 0  r \\end{pmatrix} \\right) \\begin{pmatrix} k_1  0 \\\\ 0  k_2 \\end{pmatrix}\n$$\n$$\nA_d = \\begin{pmatrix} -r  \\alpha \\\\ -\\alpha  -r \\end{pmatrix} \\begin{pmatrix} k_1  0 \\\\ 0  k_2 \\end{pmatrix} = \\begin{pmatrix} -r k_1  \\alpha k_2 \\\\ -\\alpha k_1  -r k_2 \\end{pmatrix}\n$$\nThe characteristic equation for the eigenvalues $\\lambda$ of $A_d$ is $\\det(A_d - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} -r k_1 - \\lambda  \\alpha k_2 \\\\ -\\alpha k_1  -r k_2 - \\lambda \\end{pmatrix} = (-r k_1 - \\lambda)(-r k_2 - \\lambda) + \\alpha^2 k_1 k_2 = 0\n$$\n$$\n\\lambda^2 + (r k_1 + r k_2)\\lambda + r^2 k_1 k_2 + \\alpha^2 k_1 k_2 = 0\n$$\nSubstituting $\\alpha^2 = \\frac{\\omega_0^2}{k_1 k_2}$ from Part 1:\n$$\n\\lambda^2 + r(k_1+k_2)\\lambda + (r^2 k_1 k_2 + \\omega_0^2) = 0\n$$\nThe eigenvalues are given by the quadratic formula:\n$$\n\\lambda_{1,2} = \\frac{-r(k_1+k_2) \\pm \\sqrt{ (r(k_1+k_2))^2 - 4(r^2 k_1 k_2 + \\omega_0^2) }}{2}\n$$\nThe equilibrium is an asymptotically stable focus if the eigenvalues are a complex conjugate pair with a negative real part. The real part of the eigenvalues is $\\mathrm{Re}(\\lambda) = -\\frac{r(k_1+k_2)}{2}$. Since $r  0$, $k_1  0$, and $k_2  0$, the real part is always negative, guaranteeing asymptotic stability.\nThe eigenvalues are complex if the discriminant of the quadratic equation is negative. Let $\\Delta$ be the discriminant:\n$$\n\\Delta = (r(k_1+k_2))^2 - 4(r^2 k_1 k_2 + \\omega_0^2) = r^2(k_1^2 + 2k_1 k_2 + k_2^2) - 4r^2 k_1 k_2 - 4\\omega_0^2\n$$\n$$\n\\Delta = r^2(k_1^2 - 2k_1 k_2 + k_2^2) - 4\\omega_0^2 = r^2(k_1-k_2)^2 - 4\\omega_0^2\n$$\nFor a focus, we require $\\Delta  0$:\n$$\nr^2(k_1-k_2)^2 - 4\\omega_0^2  0 \\implies r^2(k_1-k_2)^2  4\\omega_0^2\n$$\nTaking the square root of both sides gives:\n$$\nr |k_1 - k_2|  2\\omega_0\n$$\nThis is the condition on $r$ for the equilibrium to be an asymptotically stable focus. If $k_1 \\neq k_2$, this is equivalent to $0  r  \\frac{2\\omega_0}{|k_1-k_2|}$. If $k_1=k_2$, the condition becomes $0  2\\omega_0$, which is always true for $\\omega_0  0$, meaning the system is a focus for any $r0$.\nThe problem requires providing the explicit expression for $J_d$ as the final answer.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  \\frac{\\omega_{0}}{\\sqrt{k_{1} k_{2}}} \\\\ -\\frac{\\omega_{0}}{\\sqrt{k_{1} k_{2}}}  0 \\end{pmatrix}}\n$$", "id": "2704607"}, {"introduction": "Achieving local stability at a desired operating point is only half the battle; we must also consider the system's global behavior. This problem explores a critical design pitfall where an improperly shaped potential energy function $V_{d}(q)$ creates unintended \"valleys,\" or spurious equilibria, that can trap the system far from its target. This exercise illustrates an advanced design challenge in underactuated systems, teaching you to analyze the entire energy landscape and impose conditions on your design to ensure robust performance free of undesirable attractors [@problem_id:2704604].", "problem": "Consider a conservative two-degree-of-freedom underactuated mechanical system with generalized coordinates $q \\in \\mathbb{R}^{2}$ and conjugate momenta $p \\in \\mathbb{R}^{2}$. Its Hamiltonian is\n$$\nH(q,p) \\;=\\; \\tfrac{1}{2}\\,p^{\\top} M^{-1}(q)\\,p \\;+\\; V(q),\n$$\nwhere $M(q) \\in \\mathbb{R}^{2 \\times 2}$ is a symmetric positive definite inertia matrix and $V(q)$ is the potential energy. The system is actuated only at the second coordinate by a control input $u \\in \\mathbb{R}$, injected through a full-rank input matrix $G(q) \\in \\mathbb{R}^{2 \\times 1}$ whose second row is nonzero and first row is zero. You are tasked with designing an Interconnection and Damping Assignment Passivity-Based Control (IDA-PBC) to asymptotically stabilize the equilibrium $(q^{\\star},p^{\\star}) = (0,0)$.\n\nAssume you pursue the standard energy-shaping route and specify a desired Hamiltonian of the form\n$$\nH_{d}(q,p) \\;=\\; \\tfrac{1}{2}\\,p^{\\top} M_{d}^{-1}(q)\\,p \\;+\\; V_{d}(q),\n$$\nwhere $M_{d}(q)$ is symmetric positive definite and the shaped potential is chosen as\n$$\nV_{d}(q) \\;=\\; k_{1}\\,\\big(1 - \\cos q_{1}\\big) \\;+\\; k_{2}\\,\\big(1 - \\cos(2 q_{1})\\big) \\;+\\; \\tfrac{1}{2}\\,k_{3}\\,q_{2}^{2},\n$$\nwith $k_{1}  0$, $k_{3}  0$, and $k_{2} \\in \\mathbb{R}$ to be selected. Assume that the interconnection and damping assignment and the associated matching conditions are satisfied in such a way that the zero-dynamics manifold associated with the output $y := \\partial H_{d}/\\partial p_{2}$ is given by\n$$\n\\mathcal{Z} \\;=\\; \\{(q,p)\\in \\mathbb{R}^{4} \\,:\\, q_{2}=0,\\; p_{2}=0\\},\n$$\nand that $\\mathcal{Z}$ is invariant under the closed-loop dynamics. On $\\mathcal{Z}$, the reduced closed-loop dynamics evolve in $q_{1}$ with an effective potential equal to the restriction of $V_{d}(q)$ to $\\{q_{2}=0\\}$.\n\nStarting only from the definitions above and basic calculus, do the following:\n\n1. Derive the set of critical points (equilibria) of the reduced zero-dynamics on $\\mathcal{Z}$ by computing the stationary points of the reduced potential in $q_{1}$ and show explicitly how, when $k_{2} \\neq 0$ is chosen improperly, extra critical points (spurious equilibria) appear in addition to the desired $q_{1}=0$ configuration.\n\n2. From your derivation, infer a quantitative condition on $k_{2}$ that guarantees the absence of any additional critical points of the reduced potential other than the trivial solutions arising from $\\sin q_{1} = 0$. Then, propose a design adjustment on $k_{2}$ that eliminates the spurious equilibria while retaining $k_{1}  0$.\n\nCompute the largest allowable magnitude $c_{\\star}$ of $k_{2}$, expressed as a symbolic function of $k_{1}$, such that for any $k_{2}$ satisfying $\\lvert k_{2} \\rvert  c_{\\star}$ there are no spurious equilibria on the zero-dynamics manifold. Provide your final answer as a closed-form symbolic expression for $c_{\\star}$ in terms of $k_{1}$. No numerical rounding is required. No physical units are required in the final expression.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard task in the field of nonlinear control theory, specifically concerning the analysis of zero-dynamics in an Interconnection and Damping Assignment Passivity-Based Control (IDA-PBC) scheme. All necessary definitions and assumptions are provided to proceed with a rigorous mathematical analysis. Therefore, the problem is deemed valid and a solution will be furnished.\n\nThe primary task is to analyze the equilibria of the reduced closed-loop dynamics on the specified zero-dynamics manifold, $\\mathcal{Z}$. This manifold is given by $\\mathcal{Z} = \\{(q,p)\\in \\mathbb{R}^{4} \\,:\\, q_{2}=0,\\; p_{2}=0\\}$. The problem states that on this manifold, the dynamics in the coordinate $q_{1}$ are governed by an effective potential energy function, $V_{red}(q_{1})$, which is the restriction of the desired potential $V_{d}(q)$ to $\\mathcal{Z}$.\n\nWe find $V_{red}(q_{1})$ by substituting $q_{2}=0$ into the expression for $V_{d}(q)$:\n$$\nV_{red}(q_{1}) = V_{d}(q_{1}, 0) = k_{1}\\,\\big(1 - \\cos q_{1}\\big) \\;+\\; k_{2}\\,\\big(1 - \\cos(2 q_{1})\\big) \\;+\\; \\tfrac{1}{2}\\,k_{3}\\,(0)^{2}\n$$\n$$\nV_{red}(q_{1}) = k_{1}\\,(1 - \\cos q_{1}) + k_{2}\\,(1 - \\cos(2q_{1}))\n$$\nThe critical points (equilibria) of the reduced system correspond to the stationary points of this potential, which are found where the first derivative of $V_{red}(q_{1})$ with respect to $q_{1}$ is zero. We compute this derivative:\n$$\n\\frac{d V_{red}}{d q_{1}} = \\frac{d}{d q_{1}} \\left[ k_{1}\\,(1 - \\cos q_{1}) + k_{2}\\,(1 - \\cos(2q_{1})) \\right] = k_{1} \\sin q_{1} + 2k_{2} \\sin(2q_{1})\n$$\nUsing the trigonometric double-angle identity $\\sin(2q_{1}) = 2 \\sin q_{1} \\cos q_{1}$, we simplify the derivative:\n$$\n\\frac{d V_{red}}{d q_{1}} = k_{1} \\sin q_{1} + 4k_{2} \\sin q_{1} \\cos q_{1} = (\\sin q_{1})(k_{1} + 4k_{2} \\cos q_{1})\n$$\nSetting this derivative to zero, $\\frac{d V_{red}}{d q_{1}} = 0$, gives the equation for the equilibria:\n$$\n(\\sin q_{1})(k_{1} + 4k_{2} \\cos q_{1}) = 0\n$$\nThis equation is satisfied if at least one of its two factors is zero:\n1.  $\\sin q_{1} = 0$: This condition yields the set of intended, or trivial, equilibria at $q_{1} = n\\pi$ for any integer $n \\in \\mathbb{Z}$. This set includes the desired equilibrium configuration $q_{1} = 0$.\n2.  $k_{1} + 4k_{2} \\cos q_{1} = 0$: This condition can be rearranged to solve for $\\cos q_{1}$:\n    $$\n    \\cos q_{1} = -\\frac{k_{1}}{4k_{2}}\n    $$\n    This second equation is the source of the \"spurious\" equilibria. For real solutions for $q_{1}$ to exist from this equation, the value of the right-hand side must be within the valid range of the cosine function, i.e., in the interval $[-1, 1]$. Thus, spurious equilibria appear if and only if:\n    $$\n    \\left| -\\frac{k_{1}}{4k_{2}} \\right| \\leq 1\n    $$\n    Given that the problem specifies $k_{1}  0$, we can simplify this condition:\n    $$\n    \\frac{k_{1}}{4|k_{2}|} \\leq 1 \\quad \\implies \\quad k_{1} \\leq 4|k_{2}| \\quad \\implies \\quad |k_{2}| \\geq \\frac{k_{1}}{4}\n    $$\n    This demonstrates that if the magnitude of the chosen parameter $k_{2}$ is improperly large, specifically $|k_{2}| \\geq \\frac{k_{1}}{4}$, additional critical points will be created on the zero-dynamics manifold. This completes the first part of the problem.\n\nFor the second part of the problem, we must derive a condition on $k_{2}$ that ensures the absence of these spurious equilibria. This is achieved by requiring that the equation $\\cos q_{1} = -k_{1}/(4k_{2})$ has no real solution. This is guaranteed if the magnitude of the right-hand side is strictly greater than $1$:\n$$\n\\left| -\\frac{k_{1}}{4k_{2}} \\right|  1\n$$\nFollowing the same logic as before, this inequality becomes:\n$$\n\\frac{k_{1}}{4|k_{2}|}  1 \\quad \\implies \\quad k_{1}  4|k_{2}| \\quad \\implies \\quad |k_{2}|  \\frac{k_{1}}{4}\n$$\nThe proposed design adjustment is thus to select the parameter $k_{2}$ such that its magnitude respects this strict inequality relative to $k_{1}$. By doing so, the factor $(k_{1} + 4k_{2} \\cos q_{1})$ can never be zero, and the only equilibria of the reduced system are those determined by $\\sin q_{1} = 0$.\n\nFinally, we are asked to find the largest allowable magnitude $c_{\\star}$ of $k_{2}$ such that for any $k_{2}$ satisfying $|k_{2}|  c_{\\star}$, there are no spurious equilibria. The condition we derived for the absence of such equilibria is precisely of this form: $|k_{2}|  k_{1}/4$. By direct comparison, we identify the value of $c_{\\star}$:\n$$\nc_{\\star} = \\frac{k_{1}}{4}\n$$\nThis value represents the critical threshold for the parameter $k_{2}$. For all $|k_{2}|  c_{\\star}$, the desired potential $V_{d}(q)$ has a single family of critical points on the zero-dynamics manifold at $q_1=n\\pi$, preventing bifurcations that would compromise the stability of the desired operating point.", "answer": "$$\\boxed{\\frac{k_{1}}{4}}$$", "id": "2704604"}]}