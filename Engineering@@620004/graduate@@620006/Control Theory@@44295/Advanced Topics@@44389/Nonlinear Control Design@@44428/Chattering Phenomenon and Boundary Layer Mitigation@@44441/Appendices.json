{"hands_on_practices": [{"introduction": "Before tackling the imperfections that lead to chattering, it is crucial to understand the ideal behavior of a system in a sliding mode. This exercise guides you through the process of deriving the \"equivalent control,\" which represents the theoretical continuous input required to keep the system's state perfectly on the sliding manifold. Mastering this calculation for a complex nonlinear system builds a foundational understanding of the underlying dynamics that sliding mode control aims to regulate [@problem_id:2692148].", "problem": "Consider the nonlinear single-input, two-state plant\n$$\n\\dot{x}_{1} \\,=\\, x_{2}, \\qquad \\dot{x}_{2} \\,=\\, -\\kappa\\,x_{1} \\,-\\, \\delta\\,x_{1}^{3} \\,+\\, \\gamma(x)\\,u,\n$$\nwith state $x \\in \\mathbb{R}^{2}$, input $u \\in \\mathbb{R}$, and parameters $\\kappa>0$, $\\delta>0$. The input gain $\\gamma(x)$ is strictly positive and given by\n$$\n\\gamma(x) \\,=\\, \\exp(x_{1}) \\,+\\, x_{2}^{2} \\,+\\, 1.\n$$\nLet the sliding manifold be defined by the scalar function\n$$\ns(x) \\,=\\, \\tanh(x_{2}) \\,+\\, \\lambda\\,x_{1} \\,+\\, \\mu\\,\\sin(x_{1}),\n$$\nwhere $\\lambda>0$ and $\\mu>0$ are design parameters. \n\nA classical sliding-mode control law uses a high-gain discontinuous term to drive $s(x)$ to zero, which may generate high-frequency chattering due to unmodeled dynamics and actuator limitations. A common mitigation is to introduce a boundary layer and replace the discontinuous sign function by a saturation nonlinearity over a thin layer around $s(x)=0$. Under the Filippov convexification assumption for discontinuous right-hand sides, the ideal motion on the sliding manifold $s(x)=0$ is characterized by the equivalent control, defined as the average control that renders $\\dot{s}(x)=0$ along $s(x)=0$.\n\nStarting strictly from the chain rule for $\\dot{s}(x)$ and the plant dynamics, and invoking the Filippov convexification notion of equivalent control on $s(x)=0$, derive a closed-form expression for the equivalent control $u_{eq}(x)$ as a function of $x$, $\\kappa$, $\\delta$, $\\lambda$, $\\mu$. Express your final answer as a single simplified analytic expression that depends only on $x_{1}$, $x_{2}$, $\\kappa$, $\\delta$, $\\lambda$, $\\mu$ and elementary functions. Do not introduce any numerical approximations. The final answer does not require units and must be a single expression.", "solution": "The fundamental principle underlying the concept of equivalent control in a sliding-mode system is the invariance condition. This condition demands that the state trajectory, once on the sliding manifold defined by $s(x) = 0$, remains on this manifold for all subsequent time. Mathematically, this is expressed by requiring that the time derivative of the sliding function, $\\dot{s}(x)$, be zero. The control input $u$ that enforces this condition is defined as the equivalent control, $u_{eq}(x)$.\n\nWe begin by computing the time derivative of the sliding function $s(x)$ using the chain rule:\n$$\n\\dot{s}(x) = \\frac{d}{dt}s(x(t)) = \\frac{\\partial s}{\\partial x} \\dot{x} = \\frac{\\partial s}{\\partial x_{1}}\\dot{x}_{1} + \\frac{\\partial s}{\\partial x_{2}}\\dot{x}_{2}\n$$\nThe sliding function is given as $s(x) = \\tanh(x_{2}) + \\lambda x_{1} + \\mu \\sin(x_{1})$. We compute the partial derivatives with respect to the state variables $x_{1}$ and $x_{2}$:\n$$\n\\frac{\\partial s}{\\partial x_{1}} = \\frac{\\partial}{\\partial x_{1}} \\left( \\tanh(x_{2}) + \\lambda x_{1} + \\mu \\sin(x_{1}) \\right) = \\lambda + \\mu \\cos(x_{1})\n$$\n$$\n\\frac{\\partial s}{\\partial x_{2}} = \\frac{\\partial}{\\partial x_{2}} \\left( \\tanh(x_{2}) + \\lambda x_{1} + \\mu \\sin(x_{1}) \\right) = \\text{sech}^{2}(x_{2})\n$$\nHere, $\\text{sech}(z)$ is the hyperbolic secant function, which is the derivative of $\\tanh(z)$.\n\nNext, we substitute these partial derivatives and the plant dynamics, $\\dot{x}_{1} = x_{2}$ and $\\dot{x}_{2} = -\\kappa x_{1} - \\delta x_{1}^{3} + \\gamma(x) u$, into the expression for $\\dot{s}(x)$:\n$$\n\\dot{s}(x) = (\\lambda + \\mu \\cos(x_{1}))(x_{2}) + (\\text{sech}^{2}(x_{2}))(-\\kappa x_{1} - \\delta x_{1}^{3} + \\gamma(x) u)\n$$\nTo find the equivalent control $u_{eq}(x)$, we enforce the invariance condition $\\dot{s}(x) = 0$ and replace $u$ with $u_{eq}$:\n$$\n0 = (\\lambda + \\mu \\cos(x_{1}))x_{2} + \\text{sech}^{2}(x_{2})(-\\kappa x_{1} - \\delta x_{1}^{3} + \\gamma(x) u_{eq})\n$$\nWe now solve this algebraic equation for $u_{eq}$. It is imperative to note that the input gain $\\gamma(x) = \\exp(x_{1}) + x_{2}^{2} + 1$ is strictly positive for all $x \\in \\mathbb{R}^{2}$, ensuring that the equation is always solvable for $u_{eq}$.\n$$\n\\text{sech}^{2}(x_{2}) \\gamma(x) u_{eq} = -(\\lambda + \\mu \\cos(x_{1}))x_{2} - \\text{sech}^{2}(x_{2})(-\\kappa x_{1} - \\delta x_{1}^{3})\n$$\n$$\n\\text{sech}^{2}(x_{2}) \\gamma(x) u_{eq} = \\text{sech}^{2}(x_{2})(\\kappa x_{1} + \\delta x_{1}^{3}) - (\\lambda + \\mu \\cos(x_{1}))x_{2}\n$$\nIsolating $u_{eq}$ yields:\n$$\nu_{eq} = \\frac{1}{\\gamma(x) \\text{sech}^{2}(x_{2})} \\left[ \\text{sech}^{2}(x_{2})(\\kappa x_{1} + \\delta x_{1}^{3}) - (\\lambda + \\mu \\cos(x_{1}))x_{2} \\right]\n$$\nWe can simplify this expression by distributing the leading term:\n$$\nu_{eq} = \\frac{1}{\\gamma(x)} \\left[ (\\kappa x_{1} + \\delta x_{1}^{3}) - \\frac{(\\lambda + \\mu \\cos(x_{1}))x_{2}}{\\text{sech}^{2}(x_{2})} \\right]\n$$\nUsing the identity $1/\\text{sech}^{2}(z) = \\cosh^{2}(z)$, where $\\cosh(z)$ is the hyperbolic cosine function, we obtain:\n$$\nu_{eq}(x) = \\frac{1}{\\gamma(x)} \\left[ \\kappa x_{1} + \\delta x_{1}^{3} - x_{2}(\\lambda + \\mu \\cos(x_{1}))\\cosh^{2}(x_{2}) \\right]\n$$\nFinally, substituting the given expression for the input gain $\\gamma(x) = \\exp(x_{1}) + x_{2}^{2} + 1$ produces the complete, closed-form expression for the equivalent control:\n$$\nu_{eq}(x) = \\frac{\\kappa x_{1} + \\delta x_{1}^{3} - x_{2}(\\lambda + \\mu \\cos(x_{1}))\\cosh^{2}(x_{2})}{\\exp(x_{1}) + x_{2}^{2} + 1}\n$$\nThis is the final expression, which depends only on the state variables $x_{1}$, $x_{2}$ and the parameters $\\kappa$, $\\delta$, $\\lambda$, $\\mu$, as required.", "answer": "$$\n\\boxed{\\frac{\\kappa x_{1} + \\delta x_{1}^{3} - x_{2}(\\lambda + \\mu \\cos(x_{1}))\\cosh^{2}(x_{2})}{\\exp(x_{1}) + x_{2}^{2} + 1}}\n$$", "id": "2692148"}, {"introduction": "In practice, the ideal equivalent control is an abstraction, as high-frequency switching interacts with unmodeled system dynamics. This practice problem models the very genesis of chattering by examining the interplay between a simple high-gain switching law and a parasitic first-order lag, a common representation of actuator or sensor dynamics. By deriving the resulting limit cycle frequency from first principles, you will gain a concrete, quantitative insight into how chattering emerges from the practical limitations of physical systems [@problem_id:2692124].", "problem": "A sliding-mode control loop is attempting to enforce the sliding variable $s(t)$ to zero using high-gain switching. However, the actuator or sensor introduces an unmodeled high-frequency parasitic first-order lag, which is well approximated by a stable pole at $-p$ with $p>0$. In the fast timescale near the sliding surface, the dominant high-frequency dynamics of the sliding variable $s(t)$ are modeled by the first-order linear time-invariant system\n$$\n\\dot{s}(t) \\;=\\; -p\\,s(t) \\;+\\; p\\,u(t),\n$$\nwhere $u(t)$ is the commanded control that reaches the actuator. To mitigate chattering, a symmetric boundary layer (hysteresis) of half-width $h>0$ is introduced around $s=0$, while retaining a large switching amplitude $k>h$. The switching law is a symmetric relay with hysteresis:\n- if $s(t)$ reaches $+h$, then $u(t)$ switches to $-k$;\n- if $s(t)$ reaches $-h$, then $u(t)$ switches to $+k$;\n- between $-h$ and $+h$, $u(t)$ holds its last value.\n\nAssume the loop settles into a steady, symmetric chattering limit cycle that traverses between $s=-h$ and $s=+h$. Starting from the governing differential equation and fundamental properties of first-order linear systems, derive from first principles the exact closed-form expression for the steady-state chattering angular frequency $\\omega_{\\mathrm{ch}}$ as a function of $p$, $k$, and $h$. Express your final answer for $\\omega_{\\mathrm{ch}}$ in radians per second. No numerical approximation is required; give your result in exact analytic form.", "solution": "The analysis proceeds by considering the steady-state symmetric limit cycle oscillation of the sliding variable $s(t)$. This cycle comprises two symmetric halves. In the first half, $s(t)$ travels from the lower hysteresis boundary $s = -h$ to the upper boundary $s = +h$. In the second half, it returns from $s = +h$ to $s = -h$. Due to the symmetry of both the system dynamics and the control law, the time duration of each half-cycle is identical. Let the total period of the limit cycle be denoted by $T_{\\mathrm{ch}}$. The duration of one half-cycle is thus $T_{\\mathrm{ch}}/2$.\n\nLet us analyze the first half of the cycle. We can reset the time origin to $t=0$ at the beginning of this interval, so the initial condition is $s(0) = -h$. Upon the state reaching this lower boundary, the relay with hysteresis dictates that the control input $u(t)$ must switch to its positive value, $u(t) = +k$. This control value is then held constant throughout this half-cycle.\n\nThe dynamics of the sliding variable $s(t)$ are governed by the given first-order differential equation:\n$$\n\\dot{s}(t) \\;=\\; -p\\,s(t) \\;+\\; p\\,u(t)\n$$\nSubstituting the constant control input $u(t) = k$, we obtain the equation for this phase of motion:\n$$\n\\dot{s}(t) + p s(t) = p k\n$$\nThis is a standard first-order linear non-homogeneous ordinary differential equation. Its general solution is the sum of the homogeneous solution, $s_h(t)$, and a particular solution, $s_p(t)$. The homogeneous equation, $\\dot{s}_h(t) + p s_h(t) = 0$, has the solution $s_h(t) = C \\exp(-pt)$, where $C$ is a constant of integration. Since the forcing term $p k$ is constant, we can find a constant particular solution $s_p(t) = A$. Substituting this into the differential equation gives $0 + p A = p k$, which yields $A = k$. The general solution for $s(t)$ is therefore:\n$$\ns(t) = k + C \\exp(-pt)\n$$\nThe constant of integration $C$ is determined using the initial condition for this phase, $s(0) = -h$:\n$$\n-h = k + C \\exp(-p \\cdot 0) = k + C\n$$\nFrom this, we find $C = -k - h = -(k+h)$. Substituting this value of $C$ back into the general solution gives the explicit trajectory for the first half-cycle:\n$$\ns(t) = k - (k+h) \\exp(-pt)\n$$\nThis phase of the trajectory concludes when the state $s(t)$ reaches the upper hysteresis boundary, $s(t) = +h$. Let us denote the time at which this event occurs as $t_1 = T_{\\mathrm{ch}}/2$. We can find this half-period by setting $s(t_1) = h$:\n$$\nh = k - (k+h) \\exp\\left(-p \\frac{T_{\\mathrm{ch}}}{2}\\right)\n$$\nNow, we must solve for $T_{\\mathrm{ch}}$. Let us first isolate the exponential term:\n$$\n(k+h) \\exp\\left(-p \\frac{T_{\\mathrm{ch}}}{2}\\right) = k - h\n$$\n$$\n\\exp\\left(-p \\frac{T_{\\mathrm{ch}}}{2}\\right) = \\frac{k-h}{k+h}\n$$\nTaking the natural logarithm of both sides of the equation yields:\n$$\n-p \\frac{T_{\\mathrm{ch}}}{2} = \\ln\\left(\\frac{k-h}{k+h}\\right)\n$$\nSolving for the full period $T_{\\mathrm{ch}}$ gives:\n$$\nT_{\\mathrm{ch}} = -\\frac{2}{p} \\ln\\left(\\frac{k-h}{k+h}\\right)\n$$\nUsing the logarithmic identity $-\\ln(x) = \\ln(1/x)$, we can express the period in a form where the argument of the logarithm is greater than $1$:\n$$\nT_{\\mathrm{ch}} = \\frac{2}{p} \\ln\\left(\\frac{k+h}{k-h}\\right)\n$$\nThe problem requires the derivation of the chattering angular frequency, $\\omega_{\\mathrm{ch}}$, which is related to the period $T_{\\mathrm{ch}}$ by the fundamental relation $\\omega_{\\mathrm{ch}} = 2\\pi / T_{\\mathrm{ch}}$. Substituting the derived expression for $T_{\\mathrm{ch}}$:\n$$\n\\omega_{\\mathrm{ch}} = \\frac{2\\pi}{\\frac{2}{p} \\ln\\left(\\frac{k+h}{k-h}\\right)}\n$$\nSimplifying the expression by canceling the factor of $2$ yields the final analytical result for the chattering angular frequency:\n$$\n\\omega_{\\mathrm{ch}} = \\frac{\\pi p}{\\ln\\left(\\frac{k+h}{k-h}\\right)}\n$$\nThis expression provides the angular frequency as a function of the system parameter $p$, the control amplitude $k$, and the hysteresis half-width $h$, as required. The given condition $k>h$ ensures that the argument of the logarithm, $(k+h)/(k-h)$, is greater than $1$, which in turn ensures that the logarithm is positive and the resulting frequency $\\omega_{\\mathrm{ch}}$ is a positive real number, consistent with physical reality.", "answer": "$$\n\\boxed{\\frac{\\pi p}{\\ln\\left(\\frac{k+h}{k-h}\\right)}}\n$$", "id": "2692124"}, {"introduction": "Moving from continuous-time theory to digital implementation introduces new layers of complexity, such as computational and actuation delays. This exercise explores how a one-sample delay, a common artifact in digital control, can profoundly affect the stability of a system even when a boundary layer is used to mitigate chattering. By analyzing the discrete-time dynamics, you will uncover how such a delay can induce oscillations and derive a critical stability constraint on the controller gain, a vital skill for designing robust real-world digital controllers [@problem_id:2692146].", "problem": "Consider the scalar integrator plant with zero-order hold discretization and a sliding-mode controller with a boundary layer designed to mitigate chattering. The discrete-time plant state is $x_k \\in \\mathbb{R}$ and obeys $x_{k+1} = x_k + T_s u_k^{\\mathrm{app}}$, where $T_s > 0$ is the sampling period and $u_k^{\\mathrm{app}}$ is the input applied to the plant over the interval $[kT_s,(k+1)T_s)$. The sliding variable is defined as $s_k = x_k$. The controller computes $u_k$ from the measurement $s_k$ according to the saturated relay law\n$$\nu_k = -k\\,\\mathrm{sat}\\!\\left(\\frac{s_k}{\\phi}\\right),\n$$\nwhere $k > 0$ is the proportional switching gain, $\\phi > 0$ is the boundary-layer half-width, and $\\mathrm{sat}(\\cdot)$ is the standard saturation nonlinearity defined by $\\mathrm{sat}(v) = v$ for $|v| \\leq 1$ and $\\mathrm{sat}(v) = \\operatorname{sgn}(v)$ for $|v| > 1$. Due to actuation latency, there is a one-sample delay in applying the control, so that the plant input is $u_k^{\\mathrm{app}} = u_{k-1}$.\n\nAssume operation predominantly within the boundary layer $|s_k| < \\phi$, so that the nonlinearity is well-approximated by its linear core. Let the normalized sliding variable be $z_k = s_k / \\phi$.\n\nTasks:\n- Starting from the plant update $x_{k+1} = x_k + T_s u_k^{\\mathrm{app}}$, the control law, and the one-sample delay, derive the homogeneous linear difference equation governing $z_k$ in the boundary layer.\n- Use first principles of discrete-time stability (e.g., root location inside the unit disk) to show how the one-sample delay can produce oscillations in $z_k$ even when $z_k$ remains bounded, and derive the precise condition relating $k$ and $T_s$ for Schur stability of the boundary-layer dynamics.\n- Define $k_{\\max}$ as the largest admissible proportional gain that guarantees boundedness of $z_k$ for all initial conditions when operating in the boundary layer. Provide $k_{\\max}$ explicitly as a function of $T_s$ only. Express your final answer as a single closed-form analytic expression for $k_{\\max}$ in terms of $T_s$. Assume normalized, dimensionless units for all variables and parameters.\n\nYour final answer must be a single expression. Do not include inequalities or equations in the final answer.", "solution": "The derivation begins with the plant's state-space representation.\nThe plant dynamics are given by:\n$$x_{k+1} = x_k + T_s u_k^{\\mathrm{app}}$$\nA one-sample delay exists in the actuation, meaning the input applied at time step $k$ is the one computed at time step $k-1$:\n$$u_k^{\\mathrm{app}} = u_{k-1}$$\nSubstituting this into the plant dynamics yields:\n$$x_{k+1} = x_k + T_s u_{k-1}$$\nThe sliding variable is defined as $s_k = x_k$. Therefore, the dynamics of the sliding variable are:\n$$s_{k+1} = s_k + T_s u_{k-1}$$\nThe control law is $u_k = -k\\,\\mathrm{sat}(s_k/\\phi)$. The problem specifies that the system operates within the boundary layer, meaning $|s_k| < \\phi$. For this condition, the saturation function is equivalent to its linear part:\n$$\\mathrm{sat}\\left(\\frac{s_k}{\\phi}\\right) = \\frac{s_k}{\\phi}$$\nThus, the control law simplifies to a linear proportional control:\n$$u_k = -k \\frac{s_k}{\\phi}$$\nTo find the control input $u_{k-1}$ that affects the state at step $k+1$, we shift the time index of the control law by one step:\n$$u_{k-1} = -k \\frac{s_{k-1}}{\\phi}$$\nNow, we substitute this expression for $u_{k-1}$ back into the dynamics of the sliding variable:\n$$s_{k+1} = s_k + T_s \\left(-k \\frac{s_{k-1}}{\\phi}\\right)$$\n$$s_{k+1} = s_k - \\frac{kT_s}{\\phi} s_{k-1}$$\nThis is the second-order homogeneous linear difference equation for the sliding variable $s_k$. To obtain the equation for the normalized sliding variable $z_k = s_k / \\phi$, we substitute $s_k = \\phi z_k$ into the equation:\n$$\\phi z_{k+1} = \\phi z_k - \\frac{kT_s}{\\phi} (\\phi z_{k-1})$$\nSince $\\phi > 0$, we can divide the entire equation by $\\phi$:\n$$z_{k+1} = z_k - kT_s z_{k-1}$$\nRearranging the terms gives the final homogeneous linear difference equation governing $z_k$ in the boundary layer:\n$$z_{k+1} - z_k + kT_s z_{k-1} = 0$$\n\n**Stability and Oscillation Analysis**\n\nTo analyze the stability and oscillatory behavior of this second-order discrete-time system, we examine the roots of its characteristic equation. We seek a solution of the form $z_k = \\lambda^k$. Substituting this into the difference equation gives:\n$$\\lambda^{k+1} - \\lambda^k + kT_s \\lambda^{k-1} = 0$$\nDividing by $\\lambda^{k-1}$ (assuming $\\lambda \\neq 0$) yields the characteristic equation:\n$$\\lambda^2 - \\lambda + kT_s = 0$$\nThe roots of this quadratic equation are given by:\n$$\\lambda_{1,2} = \\frac{-(-1) \\pm \\sqrt{(-1)^2 - 4(1)(kT_s)}}{2} = \\frac{1 \\pm \\sqrt{1 - 4kT_s}}{2}$$\nThe behavior of the system depends on the nature of these roots, which is determined by the discriminant $\\Delta = 1 - 4kT_s$.\n- If $\\Delta \\ge 0$, i.e., $kT_s \\le \\frac{1}{4}$, the roots are real. The system response is a non-oscillatory decay to zero (since $k, T_s > 0$, it can be shown the roots are real and lie in $(0, 1)$).\n- If $\\Delta < 0$, i.e., $kT_s > \\frac{1}{4}$, the roots are a complex conjugate pair. The presence of complex roots causes the system response $z_k$ to be oscillatory, even as it may decay or grow in magnitude. This oscillatory tendency is a direct consequence of the one-sample delay, which increased the order of the closed-loop system characteristic equation to two.\n\nFor a discrete-time linear system to be bounded for all initial conditions, its characteristic roots must lie within or on the unit circle in the complex plane, i.e., $|\\lambda| \\le 1$. If any root has a magnitude greater than $1$, the system is unstable. For the case of complex roots where $kT_s > \\frac{1}{4}$, the magnitude squared of the roots is:\n$$|\\lambda|^2 = \\left(\\frac{1}{2}\\right)^2 + \\left(\\frac{\\sqrt{4kT_s - 1}}{2}\\right)^2 = \\frac{1}{4} + \\frac{4kT_s - 1}{4} = \\frac{1+4kT_s-1}{4} = kT_s$$\nThe condition for boundedness is $|\\lambda| \\leq 1$, which implies $|\\lambda|^2 \\leq 1$. Therefore, we must have:\n$$kT_s \\leq 1$$\nThis condition incorporates both the oscillatory and non-oscillatory regimes. For $kT_s \\le 1/4$, the roots are real and less than $1$, so the condition is satisfied. The critical constraint arises from the complex-root case.\n\n**Derivation of Maximum Gain $k_{\\max}$**\n\nThe problem asks for $k_{\\max}$, the largest admissible proportional gain that guarantees boundedness of $z_k$. This corresponds to the condition of marginal stability, which is the boundary of the stability region. The condition for boundedness is $kT_s \\leq 1$. The largest value of the gain $k$ that satisfies this inequality for any given $T_s > 0$ is the value that makes the expression an equality:\n$$k_{\\max} T_s = 1$$\nSolving for $k_{\\max}$ gives the explicit expression:\n$$k_{\\max} = \\frac{1}{T_s}$$\nAt this gain, the characteristic roots have a magnitude of exactly $1$, and the system will exhibit sustained, undamped oscillations within the boundary layer. Any gain $k > k_{\\max}$ would lead to an unstable system with growing oscillations.", "answer": "$$\\boxed{\\frac{1}{T_s}}$$", "id": "2692146"}]}