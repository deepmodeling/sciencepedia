{"hands_on_practices": [{"introduction": "The stability of a switched system is not guaranteed even if all of its constituent subsystems are stable. This exercise introduces a powerful tool for proving stability under arbitrary switching: the Common Quadratic Lyapunov Function (CQLF). By finding a single symmetric positive-definite matrix $P$ that satisfies the Lyapunov inequality for all modes, you will demonstrate robust stability for the switched system provided in [@problem_id:2712026].", "problem": "Consider the switched linear system in continuous time defined by the differential equation $\\dot{x}(t)=A_{\\sigma(t)}x(t)$, where $x(t)\\in\\mathbb{R}^{2}$ and the switching signal $\\sigma(t)$ takes values in the finite index set $\\{1,2\\}$. The mode matrices are\n$$\nA_{1}=\\begin{bmatrix}-2&0\\\\0&-1\\end{bmatrix},\\qquad A_{2}=\\begin{bmatrix}-1&1\\\\-3&-2\\end{bmatrix}.\n$$\nA common quadratic Lyapunov function (CQLF) is a function of the form $V(x)=x^{\\top}Px$ with $P\\in\\mathbb{R}^{2\\times 2}$ symmetric and $P\\succ 0$ such that, for every mode $i\\in\\{1,2\\}$ and every nonzero state $x\\in\\mathbb{R}^{2}$, the derivative of $V(x)$ along the trajectories of $\\dot{x}=A_{i}x$ satisfies $\\dot{V}(x)<0$. By the standard Lyapunov characterization for linear systems, this is guaranteed if $A_{i}^{\\top}P+PA_{i}\\prec 0$ for $i\\in\\{1,2\\}$, which is a Linear Matrix Inequality (LMI) feasibility condition.\n\nUsing only the foundational definitions of Lyapunov functions and their derivatives along system trajectories, determine one explicit symmetric matrix $P\\succ 0$ that satisfies $A_{i}^{\\top}P+PA_{i}\\prec 0$ for $i=1,2$. Provide your answer as an exact matrix with real entries; no rounding is required. Do not include any units.", "solution": "The problem statement constitutes a standard, well-posed problem in the stability analysis of switched linear systems. It is scientifically grounded, self-contained, and free of any ambiguity or contradiction. We may therefore proceed with the solution.\n\nThe objective is to find a symmetric, positive-definite matrix $P \\in \\mathbb{R}^{2\\times 2}$ that serves as a common quadratic Lyapunov function for the two modes of the given switched system. Such a matrix must satisfy the following three conditions:\n$1.$ $P = P^{\\top}$ and $P \\succ 0$ (symmetric and positive definite).\n$2.$ $A_1^{\\top}P + PA_1 \\prec 0$.\n$3.$ $A_2^{\\top}P + PA_2 \\prec 0$.\n\nLet the symmetric matrix $P$ be represented as\n$$\nP = \\begin{pmatrix} p_1 & p_2 \\\\ p_2 & p_3 \\end{pmatrix}\n$$\nwhere $p_1, p_2, p_3 \\in \\mathbb{R}$.\n\nThe first condition, $P \\succ 0$, is satisfied if and only if its leading principal minors are positive. This yields the inequalities:\n$$p_1 > 0$$\n$$p_1 p_3 - p_2^2 > 0$$\n\nThe second condition is for mode $i=1$, with $A_1 = \\begin{pmatrix} -2 & 0 \\\\ 0 & -1 \\end{pmatrix}$. Let $Q_1 = A_1^{\\top}P + PA_1$.\n$$\nQ_1 = \\begin{pmatrix} -2 & 0 \\\\ 0 & -1 \\end{pmatrix} \\begin{pmatrix} p_1 & p_2 \\\\ p_2 & p_3 \\end{pmatrix} + \\begin{pmatrix} p_1 & p_2 \\\\ p_2 & p_3 \\end{pmatrix} \\begin{pmatrix} -2 & 0 \\\\ 0 & -1 \\end{pmatrix}\n$$\n$$\nQ_1 = \\begin{pmatrix} -2p_1 & -2p_2 \\\\ -p_2 & -p_3 \\end{pmatrix} + \\begin{pmatrix} -2p_1 & -p_2 \\\\ -2p_2 & -p_3 \\end{pmatrix} = \\begin{pmatrix} -4p_1 & -3p_2 \\\\ -3p_2 & -2p_3 \\end{pmatrix}\n$$\nFor $Q_1 \\prec 0$, the matrix $-Q_1$ must be positive definite.\n$$\n-Q_1 = \\begin{pmatrix} 4p_1 & 3p_2 \\\\ 3p_2 & 2p_3 \\end{pmatrix} \\succ 0\n$$\nThis gives the inequalities: $4p_1 > 0$ (which is equivalent to $p_1 > 0$) and $\\det(-Q_1) = 8p_1 p_3 - 9p_2^2 > 0$.\n\nThe third condition is for mode $i=2$, with $A_2 = \\begin{pmatrix} -1 & 1 \\\\ -3 & -2 \\end{pmatrix}$. Let $Q_2 = A_2^{\\top}P + PA_2$.\n$$\nQ_2 = \\begin{pmatrix} -1 & -3 \\\\ 1 & -2 \\end{pmatrix} \\begin{pmatrix} p_1 & p_2 \\\\ p_2 & p_3 \\end{pmatrix} + \\begin{pmatrix} p_1 & p_2 \\\\ p_2 & p_3 \\end{pmatrix} \\begin{pmatrix} -1 & 1 \\\\ -3 & -2 \\end{pmatrix}\n$$\n$$\nQ_2 = \\begin{pmatrix} -p_1 - 3p_2 & -p_2 - 3p_3 \\\\ p_1 - 2p_2 & p_2 - 2p_3 \\end{pmatrix} + \\begin{pmatrix} -p_1 - 3p_2 & p_1 - 2p_2 \\\\ -p_2 - 3p_3 & p_2 - 2p_3 \\end{pmatrix}\n$$\n$$\nQ_2 = \\begin{pmatrix} -2p_1 - 6p_2 & p_1 - 3p_2 - 3p_3 \\\\ p_1 - 3p_2 - 3p_3 & 2p_2 - 4p_3 \\end{pmatrix}\n$$\nFor $Q_2 \\prec 0$, the matrix $-Q_2$ must be positive definite. The conditions are that its leading principal minors are positive:\n$$ -(-2p_1 - 6p_2) = 2p_1 + 6p_2 > 0 $$\n$$ \\det(-Q_2) = (2p_1 + 6p_2)(4p_3 - 2p_2) - (p_1 - 3p_2 - 3p_3)^2 > 0 $$\nNote that the second diagonal element of $-Q_2$, $4p_3 - 2p_2$, must also be positive.\n\nWe must find one set of parameters $(p_1, p_2, p_3)$ satisfying this system of inequalities. To simplify the search for a feasible solution, we can investigate a restricted class of matrices. Let us test for a diagonal matrix $P$, which corresponds to setting $p_2=0$.\nThe system of inequalities simplifies significantly under this assumption:\n$1.$ From $P \\succ 0$: $p_1 > 0$ and $p_1 p_3 > 0$, which implies $p_3 > 0$.\n$2.$ From $A_1^{\\top}P+PA_1 \\prec 0$: $p_1 > 0$ and $8p_1 p_3 > 0$, which is already covered.\n$3.$ From $A_2^{\\top}P+PA_2 \\prec 0$:\n$$ 2p_1 > 0 $$\n$$ (2p_1)(4p_3) - (p_1 - 3p_3)^2 > 0 $$\nThe first part is redundant. The second inequality is:\n$$ 8p_1 p_3 - (p_1^2 - 6p_1 p_3 + 9p_3^2) > 0 $$\n$$ -p_1^2 + 14p_1 p_3 - 9p_3^2 > 0 $$\n$$ p_1^2 - 14p_1 p_3 + 9p_3^2 < 0 $$\nSince $p_3 > 0$, we can divide by $p_3^2$ to obtain an inequality for the ratio $r = p_1/p_3$:\n$$ r^2 - 14r + 9 < 0 $$\nThe roots of the quadratic equation $r^2 - 14r + 9 = 0$ are $r = 7 \\pm 2\\sqrt{10}$. The inequality is satisfied for $r$ between these two roots:\n$$ 7 - 2\\sqrt{10} < \\frac{p_1}{p_3} < 7 + 2\\sqrt{10} $$\nNumerically, this range is approximately $(0.675, 13.325)$. Any ratio in this interval will yield a valid diagonal solution. The simplest choice is $p_1/p_3 = 1$, which suggests setting $p_1 = p_3$. Let us choose $p_1=p_3=1$. This gives the candidate matrix $P=I$, the $2 \\times 2$ identity matrix.\n\nWe now rigorously verify this candidate solution, $P = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$.\n1.  $P = I$ is symmetric. Its eigenvalues are both $1$, so it is positive definite. The first condition is met.\n\n2.  Check $A_1^{\\top}P + PA_1 \\prec 0$:\n$$ A_1^{\\top}I + IA_1 = A_1^{\\top} + A_1 = \\begin{pmatrix} -2 & 0 \\\\ 0 & -1 \\end{pmatrix} + \\begin{pmatrix} -2 & 0 \\\\ 0 & -1 \\end{pmatrix} = \\begin{pmatrix} -4 & 0 \\\\ 0 & -2 \\end{pmatrix} $$\nThis matrix is diagonal with eigenvalues $-4$ and $-2$. Since both are negative, the matrix is negative definite. The second condition is met.\n\n3.  Check $A_2^{\\top}P + PA_2 \\prec 0$:\n$$ A_2^{\\top}I + IA_2 = A_2^{\\top} + A_2 = \\begin{pmatrix} -1 & -3 \\\\ 1 & -2 \\end{pmatrix} + \\begin{pmatrix} -1 & 1 \\\\ -3 & -2 \\end{pmatrix} = \\begin{pmatrix} -2 & -2 \\\\ -2 & -4 \\end{pmatrix} $$\nTo check if this matrix, let's call it $Q$, is negative definite, we check if $-Q$ is positive definite using Sylvester's criterion on its leading principal minors.\n$$ -Q = \\begin{pmatrix} 2 & 2 \\\\ 2 & 4 \\end{pmatrix} $$\nThe first minor is $2 > 0$.\nThe second minor is $\\det(-Q) = (2)(4) - (2)(2) = 8 - 4 = 4 > 0$.\nSince all leading principal minors are positive, $-Q$ is positive definite, meaning $Q$ is negative definite. The third condition is met.\n\nAll required conditions are satisfied. Thus, $P = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$ is a valid common quadratic Lyapunov function matrix.", "answer": "$$\n\\boxed{\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}}\n$$", "id": "2712026"}, {"introduction": "While the existence of a common Lyapunov function ensures stability, its absence does not automatically imply instability. This exercise presents a canonical example where a switching signal can destabilize a system composed of individually stable modes. By computationally analyzing the system's evolution under a specific periodic switching law [@problem_id:2712004], you will observe this destabilizing effect and appreciate why stability analysis for switched systems is a non-trivial challenge.", "problem": "Consider the continuous-time switched linear system defined on $\\mathbb{R}^2$ by the family of modes $\\dot{x}(t) = A_{\\sigma(t)} x(t)$, where $\\sigma(t) \\in \\{1,2\\}$ is a piecewise-constant switching signal. For a parameter $L > 0$, define the two mode matrices\n$$\nA_1(L) = \\begin{bmatrix} -1 & L \\\\ 0 & -1 \\end{bmatrix}, \\qquad\nA_2(L) = \\begin{bmatrix} -1 & 0 \\\\ L & -1 \\end{bmatrix}.\n$$\nEach $A_i(L)$ is upper or lower triangular with diagonal entries $-1$, hence both are Hurwitz (all eigenvalues strictly in the open left-half plane).\n\nYou will analyze the effect of periodic switching that alternates strictly between modes $1$ and $2$ with a fixed dwell time $\\tau > 0$. That is, for $k \\in \\mathbb{N}$, the system uses mode $1$ on $[2k\\tau,(2k+1)\\tau)$ and mode $2$ on $[(2k+1)\\tau,(2k+2)\\tau)$. Let $x(0)=x_0 \\in \\mathbb{R}^2$. Using fundamental definitions only, namely that (i) the solution of $\\dot{x} = A x$ over a time interval of length $t$ is given by $x(t) = \\mathrm{e}^{A t} x(0)$, and (ii) the evolution under successive modes composes by matrix multiplication, the state sampled at the switching instants satisfies\n$$\nx(2k\\tau) \\;=\\; \\left(\\mathrm{e}^{A_2(L)\\,\\tau} \\, \\mathrm{e}^{A_1(L)\\,\\tau}\\right)^k \\, x_0 \\;\\triangleq\\; P(L,\\tau)^k \\, x_0,\n$$\nwhere $P(L,\\tau) \\in \\mathbb{R}^{2\\times 2}$ is the one-cycle state transition matrix. The spectral radius $\\rho(P)$ of a square matrix $P$ is defined as the maximum of the absolute values of its eigenvalues. If $\\rho(P) > 1$, then there exists some initial condition $x_0 \\neq 0$ for which $\\lVert P^k x_0 \\rVert_2$ grows without bound as $k \\to \\infty$; if $\\rho(P) < 1$, then $\\lVert P^k x_0 \\rVert_2 \\to 0$ for all $x_0$.\n\nYour task is to construct and justify an example in which each mode is individually stable (Hurwitz) but periodic switching can destabilize the system. Specifically, you must:\n\n- Implement a program that, for each given parameter set $(L,\\tau,N,x_0)$, does the following:\n  1. Constructs $A_1(L)$ and $A_2(L)$.\n  2. Verifies that both $A_1(L)$ and $A_2(L)$ are Hurwitz by checking that the real parts of all eigenvalues are negative.\n  3. Forms the one-cycle matrix $P(L,\\tau) = \\mathrm{e}^{A_2(L)\\,\\tau} \\, \\mathrm{e}^{A_1(L)\\,\\tau}$ using the matrix exponential.\n  4. Computes the spectral radius $\\rho\\!\\left(P(L,\\tau)\\right)$.\n  5. Computes the growth factor after $N$ cycles,\n     $$\n     g_N(L,\\tau,x_0) \\;=\\; \\frac{\\left\\lVert P(L,\\tau)^N \\, x_0 \\right\\rVert_2}{\\lVert x_0 \\rVert_2}.\n     $$\n- Use these computations to justify instability under switching by exhibiting cases with $\\rho(P)>1$ and large $g_N$, even though both modes are Hurwitz. Explain why this necessarily precludes the existence of a common Lyapunov function that is strictly decreasing for both modes.\n\nTest suite. Your program must evaluate the following four parameter sets, which test a typical unstable case, a clearly stable case, a near-boundary case, and another unstable case with a different initial condition:\n\n- Case $1$: $L = 100.0$, $\\tau = 0.1$, $N = 5$, $x_0 = \\begin{bmatrix} 1.0 \\\\ 0.0 \\end{bmatrix}$.\n- Case $2$: $L = 1.0$, $\\tau = 0.5$, $N = 20$, $x_0 = \\begin{bmatrix} 1.0 \\\\ 0.0 \\end{bmatrix}$.\n- Case $3$: $L = 2.0$, $\\tau = 0.01$, $N = 1000$, $x_0 = \\begin{bmatrix} 1.0 \\\\ 0.0 \\end{bmatrix}$.\n- Case $4$: $L = 50.0$, $\\tau = 0.05$, $N = 10$, $x_0 = \\begin{bmatrix} 0.3 \\\\ -0.7 \\end{bmatrix}$.\n\nNumerical specifications and output format:\n\n- For each case, output a list of three entries in the order: a boolean indicating whether both $A_1(L)$ and $A_2(L)$ are Hurwitz, the spectral radius $\\rho(P)$ as a floating-point number rounded to six decimal places, and the growth factor $g_N$ as a floating-point number rounded to six decimal places.\n- Aggregate the results for all four cases into a single line containing a comma-separated list of the four per-case lists enclosed in square brackets, for example\n$$\n[\\,[\\text{true},\\,1.234000,\\,5.678900],\\,[\\text{true},\\,0.987650,\\,0.123450],\\,[\\text{true},\\,\\dots],\\,[\\text{true},\\,\\dots]\\,].\n$$\nUse the literal lowercase words true/false for booleans.\n- No physical units are involved. All angles, if any, appear in your implementation, should be in radians. Your program must be completely self-contained, require no input, and print exactly one line in the format specified above.", "solution": "The problem statement is parsed and validated. It is scientifically grounded, self-contained, and well-posed. It presents a standard, canonical example from the field of switched systems theory, which demonstrates that a switched system composed of individually stable linear time-invariant modes can be rendered unstable by a particular switching law. The problem is valid, and a solution will be provided.\n\nThe analysis begins with the two modes of the switched linear system, governed by the matrices:\n$$\nA_1(L) = \\begin{bmatrix} -1 & L \\\\ 0 & -1 \\end{bmatrix}, \\qquad\nA_2(L) = \\begin{bmatrix} -1 & 0 \\\\ L & -1 \\end{bmatrix}\n$$\nfor some parameter $L > 0$. Both matrices are triangular, so their eigenvalues are their diagonal entries. The eigenvalues for both $A_1(L)$ and $A_2(L)$ are $\\lambda_1 = -1$ and $\\lambda_2 = -1$. Since the real parts of all eigenvalues are strictly negative ($\\mathrm{Re}(\\lambda_i) = -1 < 0$), both matrices are Hurwitz for any choice of $L > 0$. This means that if the system were to operate continuously in either mode $1$ or mode $2$, any trajectory $x(t)$ would converge to the origin, i.e., $\\lim_{t\\to\\infty} x(t) = 0$.\n\nThe problem specifies a periodic switching signal with a fixed dwell time $\\tau > 0$ for each mode. The system evolves under mode $1$ for a duration $\\tau$, followed by mode $2$ for a duration $\\tau$. This completes one full cycle of period $2\\tau$. To analyze the stability of the switched system, we examine the state evolution over one such cycle. The state transition matrix for a linear system $\\dot{x} = Ax$ over a time interval $t$ is the matrix exponential $\\mathrm{e}^{At}$. The state at the end of the cycle is obtained by composing the state transitions for each segment. For an initial state $x_0$, the state after the first segment (mode $1$ for time $\\tau$) is $x_1 = \\mathrm{e}^{A_1(L)\\tau} x_0$. The state after the second segment (mode $2$ for time $\\tau$) is $x_2 = \\mathrm{e}^{A_2(L)\\tau} x_1$. Combining these, the state transition over one full period is described by the matrix $P(L, \\tau)$:\n$$\nx(2\\tau) = \\left(\\mathrm{e}^{A_2(L)\\tau} \\, \\mathrm{e}^{A_1(L)\\tau}\\right) x(0) \\triangleq P(L,\\tau) x(0)\n$$\nThe stability of the discrete-time system $x((k+1)2\\tau) = P(L,\\tau) x(k2\\tau)$ is determined by the spectral radius $\\rho(P(L,\\tau))$, which is the maximum absolute value of the eigenvalues of $P(L,\\tau)$. The system is stable if $\\rho(P) < 1$ and unstable if $\\rho(P) > 1$.\n\nTo compute $P(L, \\tau)$, we first find the matrix exponentials. The matrices $A_i(L)$ have the form $A = -\\lambda I + N$, where $N$ is a nilpotent matrix. Specifically, $A_1(L) = -I + N_1$ with $N_1 = \\begin{bmatrix} 0 & L \\\\ 0 & 0 \\end{bmatrix}$, and $A_2(L) = -I + N_2$ with $N_2 = \\begin{bmatrix} 0 & 0 \\\\ L & 0 \\end{bmatrix}$. Since $-I$ commutes with any matrix, $\\mathrm{e}^{A\\tau} = \\mathrm{e}^{(-I+N)\\tau} = \\mathrm{e}^{-I\\tau}\\mathrm{e}^{N\\tau} = \\mathrm{e}^{-\\tau}I \\cdot \\mathrm{e}^{N\\tau}$. The matrices $N_1$ and $N_2$ are nilpotent of order $2$, i.e., $N_1^2 = N_2^2 = 0$. The series expansion for the matrix exponential thus truncates: $\\mathrm{e}^{N\\tau} = I + N\\tau + \\frac{(N\\tau)^2}{2!} + \\dots = I + N\\tau$.\nThis gives:\n$$\n\\mathrm{e}^{A_1(L)\\tau} = \\mathrm{e}^{-\\tau}(I + N_1\\tau) = \\mathrm{e}^{-\\tau} \\begin{bmatrix} 1 & L\\tau \\\\ 0 & 1 \\end{bmatrix}\n$$\n$$\n\\mathrm{e}^{A_2(L)\\tau} = \\mathrm{e}^{-\\tau}(I + N_2\\tau) = \\mathrm{e}^{-\\tau} \\begin{bmatrix} 1 & 0 \\\\ L\\tau & 1 \\end{bmatrix}\n$$\nNow, we compute their product to form $P(L,\\tau)$:\n$$\nP(L,\\tau) = \\left(\\mathrm{e}^{-\\tau} \\begin{bmatrix} 1 & 0 \\\\ L\\tau & 1 \\end{bmatrix}\\right) \\left(\\mathrm{e}^{-\\tau} \\begin{bmatrix} 1 & L\\tau \\\\ 0 & 1 \\end{bmatrix}\\right) = \\mathrm{e}^{-2\\tau} \\begin{bmatrix} 1 & L\\tau \\\\ L\\tau & 1 + (L\\tau)^2 \\end{bmatrix}\n$$\nTo find the spectral radius, we compute the eigenvalues of $P(L,\\tau)$. Let $s = L\\tau$. The characteristic equation is $\\det(P - \\lambda I) = 0$. Letting $\\mu = \\lambda \\mathrm{e}^{2\\tau}$, the equation for the eigenvalues of the matrix part is:\n$$\n\\det \\begin{bmatrix} 1 - \\mu & s \\\\ s & 1+s^2 - \\mu \\end{bmatrix} = (1-\\mu)(1+s^2-\\mu) - s^2 = 0\n$$\n$$\n\\mu^2 - (2+s^2)\\mu + 1 = 0\n$$\nThe roots are $\\mu_{\\pm} = \\frac{2+s^2 \\pm \\sqrt{(2+s^2)^2-4}}{2} = \\frac{2+s^2 \\pm s\\sqrt{4+s^2}}{2}$.\nSince $s=L\\tau > 0$, both roots $\\mu_{\\pm}$ are real and positive. The larger root is $\\mu_+$. The eigenvalues of $P(L,\\tau)$ are $\\lambda_{\\pm} = \\mathrm{e}^{-2\\tau}\\mu_{\\pm}$. The spectral radius is $\\rho(P) = \\lambda_+ = \\mathrm{e}^{-2\\tau} \\frac{2+(L\\tau)^2 + L\\tau\\sqrt{4+(L\\tau)^2}}{2}$.\nThe system is unstable if $\\rho(P) > 1$. This condition can be met for sufficiently large values of the product $L\\tau$. For example, if $L$ is large and $\\tau$ is small, the term $\\mathrm{e}^{-2\\tau}$ approaches $1$, while the term involving $L\\tau$ can be large, leading to $\\rho(P) > 1$. This demonstrates that even with individually stable modes, the switched system can be unstable. Physically, the state vector is rapidly \"kicked\" by shearing transformations in alternating directions, causing its norm to grow.\n\nThis result has a profound implication regarding the existence of a common Lyapunov function. A key theorem in switched systems states that if there exists a common quadratic Lyapunov function $V(x) = x^T Q x$ with $Q=Q^T \\succ 0$ such that its time derivative $\\dot{V}(x) = x^T(A_i^T Q + Q A_i)x$ is negative definite for all modes $i$, then the switched system is asymptotically stable under any arbitrary switching signal. The existence of a switching signal (in this case, periodic with specific $L$ and $\\tau$) that destabilizes the system provides a direct proof by contradiction that no such common Lyapunov function can exist for this pair of matrices $A_1(L)$ and $A_2(L)$.\n\nThe provided program will implement the defined calculations for the four test cases. For each case $(L,\\tau,N,x_0)$, it will:\n1. Construct the matrices $A_1(L)$ and $A_2(L)$.\n2. Numerically confirm they are Hurwitz by computing their eigenvalues.\n3. Use a library function for the matrix exponential to form $P(L,\\tau) = \\mathrm{e}^{A_2(L)\\tau} \\mathrm{e}^{A_1(L)\\tau}$.\n4. Compute the eigenvalues of $P(L,\\tau)$ to find its spectral radius $\\rho(P)$.\n5. Calculate the growth factor $g_N = \\lVert P^N x_0 \\rVert_2 / \\lVert x_0 \\rVert_2$.\nThe results will quantitatively demonstrate the scenarios of instability (Cases 1 and 4) and stability (Cases 2 and 3), reinforcing the theoretical analysis.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Analyzes a switched linear system for stability under periodic switching.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (100.0, 0.1, 5, np.array([1.0, 0.0])),\n        (1.0, 0.5, 20, np.array([1.0, 0.0])),\n        (2.0, 0.01, 1000, np.array([1.0, 0.0])),\n        (50.0, 0.05, 10, np.array([0.3, -0.7]))\n    ]\n    \n    results = []\n\n    for L, tau, N, x0 in test_cases:\n        # 1. Construct A1(L) and A2(L).\n        A1 = np.array([[-1.0, L], [0.0, -1.0]])\n        A2 = np.array([[-1.0, 0.0], [L, -1.0]])\n\n        # 2. Verify that both A1 and A2 are Hurwitz.\n        # A matrix is Hurwitz if the real parts of all its eigenvalues are negative.\n        eigvals_A1 = np.linalg.eigvals(A1)\n        eigvals_A2 = np.linalg.eigvals(A2)\n        are_hurwitz = np.all(np.real(eigvals_A1) < 0) and np.all(np.real(eigvals_A2) < 0)\n        \n        # 3. Form the one-cycle matrix P(L,tau).\n        # P = e^(A2*tau) * e^(A1*tau)\n        expm_A1_tau = expm(A1 * tau)\n        expm_A2_tau = expm(A2 * tau)\n        P = expm_A2_tau @ expm_A1_tau\n        \n        # 4. Compute the spectral radius of P.\n        # The spectral radius is the maximum of the absolute values of the eigenvalues.\n        eigvals_P = np.linalg.eigvals(P)\n        spectral_radius = np.max(np.abs(eigvals_P))\n\n        # 5. Compute the growth factor after N cycles.\n        # g_N = || P^N * x0 ||_2 / || x0 ||_2\n        if np.linalg.norm(x0) == 0:\n            growth_factor = 1.0 # By definition or as a special case\n        else:\n            P_N = np.linalg.matrix_power(P, N)\n            x_final = P_N @ x0\n            growth_factor = np.linalg.norm(x_final) / np.linalg.norm(x0)\n\n        # Store the formatted results for this case.\n        # Booleans are output as lowercase 'true'/'false'.\n        # Floats are rounded to six decimal places.\n        case_result = [\n            str(are_hurwitz).lower(),\n            f\"{spectral_radius:.6f}\",\n            f\"{growth_factor:.6f}\"\n        ]\n        results.append(case_result)\n\n    # Format the final output string as a list of lists.\n    # e.g., [[true,1.234000,5.678900],[true,0.987650,0.123450]]\n    output_str = \"[\" + \",\".join([f\"[{','.join(res)}]\" for res in results]) + \"]\"\n    \n    # Print the final output in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "2712004"}, {"introduction": "Hybrid systems can exhibit unique behaviors not found in purely continuous or discrete systems, such as the Zeno phenomenon—an infinite number of discrete events occurring in a finite time interval. In this practice [@problem_id:2712042], you will analyze the classic bouncing ball model. By modeling the ball's continuous flight and discrete impacts, you will derive the sequence of flight times and demonstrate that their sum converges to a finite \"Zeno time.\"", "problem": "Consider the idealized bouncing-ball hybrid system on the state space $\\mathbb{R}^{2}$ with state $x = (x_{1}, x_{2})$, where $x_{1}$ is height and $x_{2}$ is vertical velocity. The continuous flow is governed by the ordinary differential equation (ODE) $\\dot{x}_{1} = x_{2}$ and $\\dot{x}_{2} = -g$ with constant gravitational acceleration $g \\in \\mathbb{R}_{>0}$. Impacts with the ground occur at the guard set $x_{1} = 0$, and the post-impact velocity is determined by the reset map $x_{2}^{+} = -e x_{2}$ with a constant coefficient of restitution $e \\in (0,1)$. Assume the domain constraint $x_{1} \\ge 0$ and consider only physically consistent impacts where the guard is reached with $x_{2} \\le 0$. Initialize the system at $t = 0$ with $x_{1}(0) = 0$ and an upward post-impact velocity $x_{2}(0) = v_{0}$, where $v_{0} \\in \\mathbb{R}_{>0}$. \n\nStarting only from these definitions and the fundamental kinematic relations implied by the ODE, do the following:\n- Derive the sequence of inter-impact flight times and the corresponding pre- and post-impact velocities.\n- Prove that the impact times accumulate in finite time (i.e., that the system exhibits Zeno behavior), by explicitly establishing the convergence of the sum of inter-impact times.\n- Define the Zeno time $T_{Z}$ as the limit of the sequence of impact times and compute $T_{Z}$ as a closed-form analytic expression in terms of $e$, $g$, and $v_{0}$.\n\nExpress the final Zeno time in seconds. Your final answer must be a single closed-form analytic expression and must not contain units.", "solution": "The problem as stated is valid. It is a well-posed, scientifically grounded problem in the analysis of hybrid dynamical systems. We will proceed with a full derivation.\n\nThe system dynamics are described by two components: a continuous flow and a discrete reset.\n\nThe continuous flow is governed by the linear time-invariant system of ordinary differential equations:\n$$\n\\dot{x}_{1} = x_{2} \\\\\n\\dot{x}_{2} = -g\n$$\nwhere $x_1$ is the height, $x_2$ is the vertical velocity, and $g \\in \\mathbb{R}_{>0}$ is the constant gravitational acceleration. Integrating these equations with respect to time $t$ gives the standard kinematic relations for an object under constant acceleration:\n$$\nx_{2}(t) = x_{2}(t_0) - g(t-t_0) \\\\\nx_{1}(t) = x_{1}(t_0) + x_{2}(t_0)(t-t_0) - \\frac{1}{2}g(t-t_0)^2\n$$\nwhere $(x_1(t_0), x_2(t_0))$ is the state at an initial time $t_0$.\n\nThe discrete events (impacts) occur when the state trajectory reaches the guard set defined by $x_1=0$. The system state is then instantaneously changed according to the reset map $x_2^+ = -e x_2^-$, where $x_2^-$ is the pre-impact velocity, $x_2^+$ is the post-impact velocity, and $e \\in (0,1)$ is the coefficient of restitution. The height state $x_1$ is unchanged, remaining at $x_1=0$. The impact is physically consistent only if $x_2^- \\le 0$.\n\nLet $T_k$ be the time of the $k$-th impact, for $k \\in \\{1, 2, 3, \\dots\\}$. We define $T_0 = 0$. Let $v_k^-$ be the velocity immediately before the $k$-th impact, and $v_k^+$ be the velocity immediately after the $k$-th impact. The initial condition is given at $t=0$ as $x_1(0)=0$ with an upward velocity $x_2(0)=v_0 > 0$. We interpret this as the state immediately following a hypothetical impact at $t=0$, so we define $v_0^+ \\equiv v_0$.\n\nWe will analyze the system motion iteratively, from one impact to the next.\n\nConsider the $k$-th flight phase, which occurs in the time interval $(T_{k-1}, T_k)$ for $k \\ge 1$. At the beginning of this phase, at time $t=T_{k-1}$, the state is $(x_1, x_2) = (0, v_{k-1}^+)$. Using the integrated equations of motion with $t_0 = T_{k-1}$, the state for $t \\in [T_{k-1}, T_k]$ is:\n$$\nx_2(t) = v_{k-1}^+ - g(t - T_{k-1}) \\\\\nx_1(t) = 0 + v_{k-1}^+(t - T_{k-1}) - \\frac{1}{2}g(t - T_{k-1})^2\n$$\nThe $k$-th impact occurs at time $t=T_k$ when $x_1(T_k) = 0$ and $T_k > T_{k-1}$. Let $\\Delta_k = T_k - T_{k-1}$ be the duration of the $k$-th flight.\n$$\nv_{k-1}^+\\Delta_k - \\frac{1}{2}g\\Delta_k^2 = 0\n$$\nFactoring out $\\Delta_k$, we have $\\Delta_k \\left( v_{k-1}^+ - \\frac{1}{2}g\\Delta_k \\right) = 0$. Since $\\Delta_k > 0$ for a non-trivial flight, we find the inter-impact time:\n$$\n\\Delta_k = \\frac{2v_{k-1}^+}{g}\n$$\nThe velocity just before the $k$-th impact, $v_k^-$, is the value of $x_2(t)$ at $t=T_k$:\n$$\nv_k^- = x_2(T_k) = v_{k-1}^+ - g(T_k - T_{k-1}) = v_{k-1}^+ - g\\Delta_k = v_{k-1}^+ - g\\left(\\frac{2v_{k-1}^+}{g}\\right) = -v_{k-1}^+\n$$\nSince $v_0^+ = v_0 > 0$ and we will show that all $v_k^+ > 0$, the pre-impact velocity $v_k^-$ is always negative, satisfying the physical consistency condition $x_2 \\le 0$ on the guard set.\n\nThe post-impact velocity $v_k^+$ is determined by the reset map:\n$$\nv_k^+ = -e v_k^- = -e(-v_{k-1}^+) = e v_{k-1}^+\n$$\nThis gives us a recurrence relation for the sequence of post-impact velocities: $v_k^+ = e v_{k-1}^+$ for $k \\ge 1$, with initial value $v_0^+ = v_0$. This is a geometric progression, whose explicit solution is:\n$$\nv_k^+ = e^k v_0^+ = e^k v_0\n$$\nNow we can write explicit expressions for the sequences of pre-impact velocities and inter-impact times for $k \\ge 1$:\n$$\nv_k^- = -v_{k-1}^+ = -e^{k-1}v_0 \\\\\n\\Delta_k = \\frac{2v_{k-1}^+}{g} = \\frac{2e^{k-1}v_0}{g}\n$$\nThis completes the first part of the task.\n\nTo prove that the system exhibits Zeno behavior, we must show that the sequence of impact times $T_N = \\sum_{k=1}^N \\Delta_k$ converges to a finite limit as $N \\to \\infty$. This limit is the Zeno time $T_Z$.\n$$\nT_Z = \\lim_{N \\to \\infty} T_N = \\sum_{k=1}^{\\infty} \\Delta_k = \\sum_{k=1}^{\\infty} \\frac{2e^{k-1}v_0}{g}\n$$\nWe can factor out the constant terms:\n$$\nT_Z = \\frac{2v_0}{g} \\sum_{k=1}^{\\infty} e^{k-1}\n$$\nLet the index of summation be $j = k-1$. As $k$ goes from $1$ to $\\infty$, $j$ goes from $0$ to $\\infty$.\n$$\nT_Z = \\frac{2v_0}{g} \\sum_{j=0}^{\\infty} e^{j}\n$$\nThis is a standard geometric series with ratio $e$. The problem specifies that $e \\in (0,1)$, which means $|e|<1$. A geometric series converges if and only if the absolute value of its ratio is less than $1$. Therefore, the series converges, and its sum is given by the formula $\\sum_{j=0}^{\\infty} r^j = \\frac{1}{1-r}$.\n$$\n\\sum_{j=0}^{\\infty} e^{j} = \\frac{1}{1-e}\n$$\nSince the sum of the inter-impact times converges to a finite value, an infinite number of impacts occur in a finite time span. This proves that the system exhibits Zeno behavior.\n\nFinally, we compute the explicit closed-form expression for the Zeno time $T_Z$ by substituting the sum of the series back into our expression for $T_Z$:\n$$\nT_Z = \\frac{2v_0}{g} \\left( \\frac{1}{1-e} \\right)\n$$\nThis simplifies to the final expression for the Zeno time.", "answer": "$$\\boxed{\\frac{2v_{0}}{g(1-e)}}$$", "id": "2712042"}]}